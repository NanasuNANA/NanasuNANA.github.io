(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7729],{7882:(he,Te,ge)=>{ge(3986),Opal.modules["i18n/backend/fallbacks"]=function(e){var K,s,r,l,a,o,W=e.module,z=e.class_variable_set,_=e.truthy,q=e.class_variable_get,w=e.def,k=e.send,F=e.send2,R=e.find_super,E=e.hash2,A=e.find_block_super,D=e.neqeq,j=e.thrower,H=e.return_val,N=[],I=e.nil,S=e.$$$;return K=N,o=[a=W(N[0],"I18n")].concat(K),z(o[0],"@@fallbacks",I),s=e.get_singleton_class(a),r=[s].concat(o),l=e.$r(r),w(s,"$fallbacks",function(){var L=I;return z(r[1],"@@fallbacks",_(null!=r[1].$$cvars["@@fallbacks"]?"class variable":I)&&_(L=q(r[1],"@@fallbacks",!1))?L:S(S(l("I18n"),"Locale"),"Fallbacks").$new()),_(L=l("Thread").$current()["$[]"]("i18n_fallbacks"))?L:q(r[1],"@@fallbacks",!1)}),w(s,"$fallbacks=",function(C){var L;return z(r[1],"@@fallbacks",_(C["$is_a?"](l("Array")))?S(S(l("I18n"),"Locale"),"Fallbacks").$new(C):C),L=["i18n_fallbacks",q(r[1],"@@fallbacks",!1)],k(l("Thread").$current(),"[]=",L),L[L.length-1]}),function(s,x){var C,L,h,d,l=[W(s,"Backend")].concat(x);return C=l,h=[L=W(l[0],"Fallbacks")].concat(C),d=e.$r(h),w(L,"$translate",function y(b,p,c){try{var g=j("return"),f=y.$$p||I,P=this,B=I,m=I;return y.$$p=null,null==c&&(c=d("EMPTY_HASH")),_(c.$fetch("fallback",!0))?_(c["$[]"]("fallback_in_progress"))?F(P,R(P,"translate",y,!1,!0),"translate",[b,p,c],f):(_(c["$[]"]("default"))&&(B=P["$extract_non_symbol_default!"](c)),m=c.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),k(d("I18n").$fallbacks()["$[]"](b),"each",[],function t(u){var i=null==t.$$s?this:t.$$s;null==u&&(u=I);try{return k(i,"catch",["exception"],function $(){var n=null==$.$$s?this:$.$$s,G=I;if(G=F(n,A(n,"translate",$.$$def||t.$$def||y,!1,!1),"translate",[u,p,m],null),_(G["$nil?"]()))return I;D(b.$to_s(),u.$to_s())&&n.$on_fallback(b,u,p,c),g.$throw(G)},{$$s:i,$$ret:g})}catch($){if(!e.rescue($,[S(d("I18n"),"InvalidLocale")]))throw $;try{return I}finally{e.pop_exception()}}},{$$s:P}),_(c["$key?"]("default"))&&_(c["$[]"]("default")["$nil?"]())?I:_(B)?F(P,R(P,"translate",y,!1,!0),"translate",[b,I,c.$merge(E(["default"],{default:B}))],null):P.$throw("exception",S(d("I18n"),"MissingTranslation").$new(b,p,c))):F(P,R(P,"translate",y,!1,!0),"translate",[b,p,c],f)}catch(t){if(t===g)return t.$v;throw t}},-3),w(L,"$extract_non_symbol_default!",function(b){var c,p=I;return p=[b["$[]"]("default")].$flatten(),c=k(p,"detect",[],function(f){return null==f&&(f=I),f["$is_a?"](d("Symbol"))["$!"]()}),_(c)&&b["$[]="]("default",p["$[]"](0,p.$index(c))),c}),w(L,"$exists?",function y(b,p,c){try{var g=j("return"),f=y.$$p||I,P=this;return y.$$p=null,null==c&&(c=d("EMPTY_HASH")),_(c.$fetch("fallback",!0))?(k(d("I18n").$fallbacks()["$[]"](b),"each",[],function B(m){var t=null==B.$$s?this:B.$$s;null==m&&(m=I);try{if(!_(F(t,A(t,"exists?",B.$$def||y,!1,!1),"exists?",[m,p],null)))return I;g.$throw(!0)}catch(u){if(!e.rescue(u,[S(d("I18n"),"InvalidLocale")]))throw u;try{return I}finally{e.pop_exception()}}},{$$s:P,$$ret:g}),!1):F(P,R(P,"exists?",y,!1,!0),"exists?",[b,p,c],f)}catch(B){if(B===g)return B.$v;throw B}},-3),L.$private(),w(L,"$on_fallback",H(I))}(o[0],o)},Opal.modules["bcdice/randomizer"]=function(e){var a,v,C,L,h,d,s,x,z=e.klass,_=e.const_set,q=e.def,w=e.truthy,k=e.rb_gt,F=e.rb_plus,R=e.rb_le,E=e.send,A=e.rb_minus,D=e.eqeq,j=e.rb_times,H=e.eqeqeq,N=e.rb_ge,I=[],S=e.nil,Y=e.$$$;return a=I,s=[(0,e.module)(I[0],"BCDice")].concat(a),x=e.$r(s),v=s,L=[C=z(s[0],null,"Randomizer")].concat(v),h=e.$r(L),(d=C.$$prototype).rand_results=d.detailed_rand_results=S,_(L[0],"UPPER_LIMIT_DICE_TIMES",200),_(L[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(L[0],"UPPER_LIMIT_RANDS",1e4),q(C,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),C.$attr_reader("rand_results"),C.$attr_reader("detailed_rand_results"),_(L[0],"DetailedRandResult",h("Struct").$new("kind","sides","value")),q(C,"$roll_barabara",function(b,p){var c=this;return w(k(F(c.rand_results.$size(),b),h("UPPER_LIMIT_RANDS")))&&c.$raise(h("TooManyRandsError")),w(R(b,0))||w(k(b,h("UPPER_LIMIT_DICE_TIMES")))?[]:E(h("Array"),"new",[b],function g(){return(null==g.$$s?this:g.$$s).$roll_once(p)},{$$s:c})}),q(C,"$roll_sum",function(b,p){return this.$roll_barabara(b,p).$sum()}),q(C,"$roll_once",function(b){var c=S;return w(R(b,0))||w(k(b,h("UPPER_LIMIT_DICE_SIDES")))?0:(c=this.$rand_inner(b),this.$push_to_detail("normal",b,c),c)}),q(C,"$roll_index",function(b){return A(this.$roll_once(b),1)}),q(C,"$roll_tens_d10",function(){var c,p=S;return p=this.$rand_inner(10),D(p,10)&&(p=0),c=j(p,10),this.$push_to_detail("tens_d10",10,c),c}),q(C,"$roll_d9",function(){var p;return p=A(this.$rand_inner(10),1),this.$push_to_detail("d9",10,p),p}),q(C,"$roll_d66",function(b){var g,c=S;return c=E(h("Array"),"new",[2],function f(){return(null==f.$$s?this:f.$$s).$roll_once(6)},{$$s:this}),H(Y(h("D66SortType"),"ASC"),g=b)?c["$sort!"]():H(Y(h("D66SortType"),"DESC"),g)&&c["$sort!"]()["$reverse!"](),F(j(c["$[]"](0),10),c["$[]"](1))}),C.$private(),q(C,"$rand_inner",function(b){var c,p=this;return w(N(p.rand_results.$size(),h("UPPER_LIMIT_RANDS")))&&p.$raise(h("TooManyRandsError")),c=p.$random(b),p.rand_results["$<<"]([c,b]),c}),q(C,"$random",function(b){return F(h("Kernel").$rand(b),1)}),q(C,"$push_to_detail",function(b,p,c){var f;return f=h("DetailedRandResult").$new(b,p,c),this.detailed_rand_results.$push(f)}),z(s[0],x("StandardError"),"TooManyRandsError"),S},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,H,K,a,o,s,x,I,D,W=e.module,z=e.klass,_=e.def,q=e.truthy,w=e.return_val,k=[],F=e.nil;return E=k,H=D=[W(k[0],"BCDice")].concat(E),K=I=[W(D[0],"DiceTable")].concat(H),o=[a=z(I[0],null,"RollResult")].concat(K),s=e.$r(o),(x=a.$$prototype).table_name=x.value=x.body=F,_(a,"$initialize",function(l,v,C){var L=this;return L.table_name=l,L.value=v,L.body=C}),a.$attr_reader("table_name"),a.$attr_reader("value"),a.$attr_reader("body"),_(a,"$to_s",function(){var l=this;return l.table_name+"("+l.value+") \uff1e "+l.body}),_(a,"$last_body",function(){var l=this;return q(l.body["$is_a?"](s("RollResult")))?l.body.$last_body():l.body}),_(a,"$empty?",w(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,H,K,a,o,s,x,I,D,W=e.module,z=e.klass,_=e.truthy,q=e.def,w=e.rb_minus,k=[],F=e.nil;return E=k,H=D=[W(k[0],"BCDice")].concat(E),K=I=[W(D[0],"DiceTable")].concat(H),o=[a=z(I[0],null,"ChainTable")].concat(K),s=e.$r(o),(x=a.$$prototype).times=x.sides=x.items=x.name=F,q(a,"$initialize",function(l,v,C){var L=this,h=F;return L.name=l,L.items=C.$freeze(),h=/(\d+)D(\d+)/i.$match(v),_(h)||L.$raise(s("ArgumentError"),"Unexpected table type: "+v),L.times=h["$[]"](1).$to_i(),L.sides=h["$[]"](2).$to_i()}),q(a,"$roll",function(l){var C,L,v=this,h=F;return C=l.$roll_sum(v.times,v.sides),L=w(C,v.times),h=v.items["$[]"](L),_(h["$respond_to?"]("roll"))&&(h=h.$roll(l)),s("RollResult").$new(v.name,C,h)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var j,S,s,x,r,l,v,K,N,W=e.module,z=e.klass,_=e.hash2,q=e.defs,w=e.def,k=e.rb_plus,F=e.rb_times,R=e.rb_minus,E=[],A=e.nil;return j=E,S=N=[W(E[0],"BCDice")].concat(j),s=K=[W(N[0],"DiceTable")].concat(S),r=[x=z(K[0],null,"D66GridTable")].concat(s),l=e.$r(r),(v=x.$$prototype).name=v.items=A,q(x,"$from_i18n",function(L,h){var y=A;return y=l("I18n").$t(L,_(["locale","raise"],{locale:h,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items"))}),w(x,"$initialize",function(L,h){return this.name=L,this.items=h.$freeze()}),w(x,"$roll",function(L){var d,y,b,p,c;return d=L.$roll_once(6),y=L.$roll_once(6),b=k(F(d,10),y),p=R(d,1),c=R(y,1),l("RollResult").$new(this.name,b,this.items["$[]"](p)["$[]"](c))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var A,N,o,s,x,r,S,Y,j,W=e.module,z=e.klass,_=e.hash2,q=e.defs,w=e.def,F=[],R=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),A=F,N=j=[W(F[0],"BCDice")].concat(A),S=[W(j[0],"DiceTable")].concat(N),Y=e.$r(S),o=S,x=[s=z(S[0],Y("D66GridTable"),"D66HalfGridTable")].concat(o),r=e.$r(x),q(s,"$from_i18n",function(v,C){var h=R;return h=r("I18n").$t(v,_(["locale","raise"],{locale:C,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("items_1_2_3"),h["$[]"]("items_4_5_6"))}),w(s,"$initialize",function(v,C,L){return this.name=v,this.items=[C,C,C,L,L,L].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var A,N,o,s,x,r,S,Y,j,W=e.module,z=e.klass,_=e.hash2,q=e.defs,w=e.def,F=[],R=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),A=F,N=j=[W(F[0],"BCDice")].concat(A),S=[W(j[0],"DiceTable")].concat(N),Y=e.$r(S),o=S,x=[s=z(S[0],Y("D66GridTable"),"D66OneThirdTable")].concat(o),r=e.$r(x),q(s,"$from_i18n",function(v,C){var h=R;return h=r("I18n").$t(v,_(["locale","raise"],{locale:C,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("items_1_2"),h["$[]"]("items_3_4"),h["$[]"]("items_5_6"))}),w(s,"$initialize",function(v,C,L,h){return this.name=v,this.items=[C,C,L,L,h,h].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var N,K,r,l,v,C,L,o,S,W=e.module,z=e.klass,_=e.hash2,q=e.defs,w=e.def,k=e.eqeqeq,F=e.rb_plus,R=e.rb_times,E=e.truthy,A=[],D=e.nil,j=e.$$$;return N=A,K=S=[W(A[0],"BCDice")].concat(N),r=o=[W(S[0],"DiceTable")].concat(K),v=[l=z(o[0],null,"D66Table")].concat(r),C=e.$r(v),(L=l.$$prototype).sort_type=L.items=L.name=D,q(l,"$from_i18n",function(d,y){var c,p=D;return p=C("I18n").$t(d,_(["locale"],{locale:y})),c=C("D66SortType").$const_get(p["$[]"]("d66_sort_type")),this.$new(p["$[]"]("name"),c,p["$[]"]("items"))}),w(l,"$initialize",function(d,y,b){var p=this;return p.name=d,p.sort_type=y,p.items=b.$freeze()}),w(l,"$roll",function(d){var y=this,b=D,p=D,c=D,g=D;return b=d.$roll_barabara(2,6),k(j(C("D66SortType"),"ASC"),p=y.sort_type)?b["$sort!"]():k(j(C("D66SortType"),"DESC"),p)&&b["$sort!"]()["$reverse!"](),c=F(R(b["$[]"](0),10),b["$[]"](1)),g=E(p=y.items["$[]"](c))?p:y.items["$[]"](c.$to_s()),E(g["$respond_to?"]("roll"))&&(g=g.$roll(d)),C("RollResult").$new(y.name,c,g)}),w(l,"$choice",function(d){return C("RollResult").$new(this.name,d,this.items["$[]"](d))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var I,a,s,x,Y,W=e.module,z=e.klass,_=e.hash2,q=e.send,w=e.to_ary,k=e.rb_plus,F=e.rb_times,R=e.send2,E=e.find_super,A=e.def,j=[],H=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),I=j,a=Y=[W(j[0],"BCDice")].concat(I),s=[W(Y[0],"DiceTable")].concat(a),x=e.$r(s),A(z(s[0],x("D66Table"),"D66LeftRangeTable"),"$initialize",function C(L,h,d){var p;return C.$$p=null,p=_([],{}),q(d,"each",[],function(g){var f,m;return null==g&&(g=H),f=w(g),m=null==f[1]?H:f[1],q(null==f[0]?H:f[0],"each",[],function(u){return null==u&&(u=H),q(m,"each_with_index",[],function($,n){var G,X;return null==$&&($=H),null==n&&(n=H),X=k(F(u,10),k(n,1)),q(p,"[]=",G=[X,$]),G[G.length-1]})})}),R(this,E(this,"initialize",C,!1,!0),"initialize",[L,h,p],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var H,Y,x,r,l,v,C,a,I,W=e.module,z=e.klass,_=e.hash2,q=e.defs,w=e.def,k=e.truthy,F=e.rb_minus,R=e.rb_plus,E=e.rb_times,A=[],D=e.nil;return H=A,Y=I=[W(A[0],"BCDice")].concat(H),x=a=[W(I[0],"DiceTable")].concat(Y),l=[r=z(a[0],null,"D66ParityTable")].concat(x),v=e.$r(l),(C=r.$$prototype).odd=C.even=C.name=D,q(r,"$from_i18n",function(h,d){var b=D;return b=v("I18n").$t(h,_(["locale","raise"],{locale:d,raise:!0})),this.$new(b["$[]"]("name"),b["$[]"]("odd"),b["$[]"]("even"))}),w(r,"$initialize",function(h,d,y){var b=this;return b.name=h,b.odd=d.$freeze(),b.even=y.$freeze()}),w(r,"$roll",function(h){var b,c,g,d=this,y=D;return y=h.$roll_once(6),b=h.$roll_once(6),c=(k(y["$odd?"]())?d.odd:d.even)["$[]"](F(b,1)),g=R(E(y,10),b),v("RollResult").$new(d.name,g,c)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var A,N,a,o,s,x,r,S,j,W=e.module,z=e.klass,_=e.def,q=e.rb_plus,w=e.rb_times,k=e.send,F=[],R=e.nil;return A=F,N=j=[W(F[0],"BCDice")].concat(A),a=S=[W(j[0],"DiceTable")].concat(N),s=[o=z(S[0],null,"D66RangeTable")].concat(a),x=e.$r(s),(r=o.$$prototype).items=r.name=R,_(o,"$initialize",function(v,C){return this.name=v,this.items=C.$freeze()}),_(o,"$roll",function(v){var L,h,d,y=R;return L=v.$roll_once(6),h=v.$roll_once(6),d=q(w(L,10),h),y=k(this.items,"find",[],function(p){return null==p&&(p=R),p["$[]"](0)["$include?"](d)}),x("RollResult").$new(this.name,d,y["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var H,Y,x,r,l,v,C,a,I,W=e.module,z=e.klass,_=e.const_set,q=e.send,w=e.truthy,k=e.def,F=e.eqeqeq,R=e.rb_times,E=e.rb_plus,A=[],D=e.nil;return H=A,Y=I=[W(A[0],"BCDice")].concat(H),x=a=[W(I[0],"DiceTable")].concat(Y),l=[r=z(a[0],null,"RangeTable")].concat(x),v=e.$r(l),(C=r.$$prototype).name=C.items=C.num_of_dice=C.num_of_sides=C.formatter=D,_(l[0],"RollResult",q(v("Struct"),"new",["sum","values","content","formatted"],function L(){return(null==L.$$s?this:L.$$s).$alias_method("to_s","formatted")},{$$s:r})),_(l[0],"Item",v("Struct").$new("range","content")),_(l[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(l[0],"DEFAULT_FORMATTER",q(r,"lambda",[],function(h,d){return null==h&&(h=D),null==d&&(d=D),h.$name()+"("+d.$sum()+") \uff1e "+d.$content()})),r.$attr_reader("name"),r.$attr_reader("num_of_dice"),r.$attr_reader("num_of_sides"),k(r,"$initialize",function L(h,d,y){var c,b=L.$$p||D,p=this,g=D;return L.$$p=null,p.name=h.$freeze(),p.formatter=w(c=b)?c:v("DEFAULT_FORMATTER"),g=v("DICE_ROLL_METHOD_RE").$match(d),w(g)||p.$raise(v("ArgumentError"),p.name+": invalid dice roll method: "+d),p.num_of_dice=g["$[]"](1).$to_i(),p.num_of_sides=g["$[]"](2).$to_i(),p.$store(y)}),k(r,"$fetch",function(h){var y,d=this;return y=q(d.items,"find",[],function(p){return null==p&&(p=D),p.$range()["$include?"](h)}),w(y)||d.$raise(v("RangeError"),d.name+": value is out of range: "+h),y}),k(r,"$roll",function(h){var b,d=this,y=D,p=D;return b=(y=h.$roll_barabara(d.num_of_dice,d.num_of_sides)).$sum(),(p=v("RollResult").$new(b,y,d.$fetch(b).$content()))["$formatted="](d.formatter["$[]"](d,p)),p}),r.$private(),k(r,"$store",function(h){var y,b,d=this;return y=q(h,"map",[],function p(c,g){return null==c&&(c=D),null==g&&(g=D),[(null==p.$$s?this:p.$$s).$coerce_to_int_range(c),g]},{$$s:d}),b=q(y,"sort_by",[],function(c,g){return null==c&&(c=D),null==g&&(g=D),c.$min()}),d.$assert_min_sum_is_covered(b),d.$assert_max_sum_is_covered(b),d.$assert_no_gap_or_overlap_in_ranges(b),d.items=q(b,"map",[],function(c,g){return null==c&&(c=D),null==g&&(g=D),v("Item").$new(c,g.$freeze()).$freeze()}).$freeze(),d}),k(r,"$coerce_to_int_range",function(h){var y;return F(v("Integer"),y=h)?v("Range").$new(h,h):F(v("Range"),y)&&w(h.$begin()["$is_a?"](v("Integer")))&&w(h.$end()["$is_a?"](v("Integer")))?h:this.$raise(v("TypeError"),this.name+": "+h+" ("+h.$class()+") must be an Integer or a Range with Integers ")}),k(r,"$assert_min_sum_is_covered",function(h){var y,d=this,b=D;return y=d.num_of_dice,b=h.$first()["$[]"](0),w(b["$include?"](y))||d.$raise(v("RangeError"),d.name+": min value ("+y+") is not covered: "+b),d}),k(r,"$assert_max_sum_is_covered",function(h){var y,d=this,b=D;return y=R(d.num_of_dice,d.num_of_sides),b=h.$last()["$[]"](0),w(b["$include?"](y))||d.$raise(v("RangeError"),d.name+": max value ("+y+") is not covered: "+b),d}),k(r,"$assert_no_gap_or_overlap_in_ranges",function(h){return q(h,"each_cons",[2],function y(b,p){var P,B,c=null==y.$$s?this:y.$$s,g=D,f=D;return null==c.name&&(c.name=D),null==b&&(b=D),null==p&&(p=D),g=b["$[]"](0),f=p["$[]"](0),P=g.$max(),B=E(P,1),w(f["$include?"](P))&&c.$raise(v("RangeError"),c.name+": Range overlap: "+g+" and "+f),w(f["$include?"](B))?D:c.$raise(v("RangeError"),c.name+": Range gap: "+g+" and "+f)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var D,I,o,v,C,L,h,x,Y,H,W=e.module,z=e.klass,_=e.send,q=e.def,w=e.rb_minus,k=e.return_ivar,F=[],R=e.nil,E=e.$$$;return D=F,I=H=[W(F[0],"BCDice")].concat(D),o=Y=[W(H[0],"DiceTable")].concat(I),v=x=[z(Y[0],null,"SaiFicSkillTable")].concat(o),L=[C=z(x[0],null,"Category")].concat(v),h=e.$r(L),q(C,"$initialize",function(y,b,p,c){var g=this;return g.name=y,g.skills=_(b.$map(),"with_index",[2],function(P,B){return null==P&&(P=R),null==B&&(B=R),E(h("SaiFicSkillTable"),"Skill").$new(y,P,p,B,c)}),g.dice=p}),q(C,"$roll",function(y){return this.$skills()["$[]"](w(y.$roll_sum(2,6),2))}),q(C,"$to_s",k("name")),C.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var R,j,Y,x,r,a,N,A,W=e.module,z=e.klass,_=e.def,q=e.hash2,w=[],k=e.nil;return R=w,j=A=[W(w[0],"BCDice")].concat(R),Y=N=[W(A[0],"DiceTable")].concat(j),a=[z(N[0],null,"SaiFicSkillTable")].concat(Y),(r=(x=z(a[0],null,"Skill")).$$prototype).s_format=r.category_dice=r.row_dice=r.category_name=r.name=k,_(x,"$initialize",function(v,C,L,h,d){var y=this;return y.category_name=v,y.name=C,y.category_dice=L,y.row_dice=h,y.s_format=d}),_(x,"$to_s",function(){var v=this;return v.$format(v.s_format,q(["category_dice","row_dice","category_name","skill_name"],{category_dice:v.category_dice,row_dice:v.row_dice,category_name:v.category_name,skill_name:v.name}))}),x.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var a,r,h,d,y,b,p,v,s,W=e.module,z=e.klass,_=e.ensure_kwargs,q=e.hash2,w=e.send,F=e.defs,R=e.const_set,E=e.to_ary,A=e.def,D=e.truthy,j=e.rb_minus,H=e.rb_plus,N=e.top,I=[],S=e.nil,Y=e.$$$;return N.$require("bcdice/dice_table/sai_fic_skill_table/category"),N.$require("bcdice/dice_table/sai_fic_skill_table/skill"),a=I,r=s=[W(I[0],"BCDice")].concat(a),h=v=[W(s[0],"DiceTable")].concat(r),y=[d=z(v[0],null,"SaiFicSkillTable")].concat(h),b=e.$r(y),(p=d.$$prototype).rtt=p.rtt_format=p.rct=p.rct_format=p.rttn=p.rttn_format=p.categories=S,F(d,"$from_i18n",function(g,f,P){var B,m,t,n,$=S;return null==(B=(P=_(P)).$$smap.rtt)&&(B=S),null==(m=P.$$smap.rct)&&(m=S),null==(t=P.$$smap.rttn)&&(t=S),n=($=b("I18n").$t("RTT",q(["locale","raise","default"],{locale:f,raise:!1,default:q([],{})})).$merge(b("I18n").$t(g,q(["locale","raise"],{locale:f,raise:!0}))))["$[]"]("items"),$=w($,"select",[],function(X,U){return null==X&&(X=S),null==U&&(U=S),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](X)}),this.$new(n,e.to_hash($).$merge(q(["rtt","rct","rttn"],{rtt:B,rct:m,rttn:t})))},-3),R(y[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),R(y[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),R(y[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),R(y[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),A(d,"$initialize",function(g,f){var P,B,m,t,u,i,$,n=this;return null==(P=(f=_(f)).$$smap.rtt)&&(P=S),null==(B=f.$$smap.rct)&&(B=S),null==(m=f.$$smap.rttn)&&(m=S),null==(t=f.$$smap.rtt_format)&&(t=b("DEFAULT_RTT")),null==(u=f.$$smap.rct_format)&&(u=b("DEFAULT_RCT")),null==(i=f.$$smap.rttn_format)&&(i=b("DEFAULT_RTTN")),null==($=f.$$smap.s_format)&&($=b("DEFAULT_S")),n.categories=w(g.$map(),"with_index",[1],function(X,U){var Z,te,ne;return null==X&&(X=S),null==U&&(U=S),te=null==(Z=E(X))[0]?S:Z[0],ne=null==Z[1]?S:Z[1],Y(b("SaiFicSkillTable"),"Category").$new(te,ne,U,$)},{$$has_top_level_mlhs_arg:!0}),n.rtt=P,n.rct=B,n.rttn=m.$to_a(),n.rtt_format=t,n.rct_format=u,n.rttn_format=i},-2),R(y[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),d.$attr_reader("categories"),A(d,"$roll_command",function(g,f){var B,P=this,m=S,t=S;return D(["RTT",P.rtt]["$include?"](B=f))?P.$format_skill(P.rtt_format,P.$roll_skill(g)):D(["RCT",P.rct]["$include?"](B))?(m=P.$roll_category(g),P.$format(P.rct_format,q(["category_dice","category_name"],{category_dice:m.$dice(),category_name:m.$name()}))):D(t=b("RTTN").$index(B))||D(t=P.rttn.$index(B))?P.$format_skill(P.rttn_format,P.categories["$[]"](t).$roll(g)):S}),A(d,"$roll_category",function(g){return this.categories["$[]"](j(g.$roll_once(6),1))}),A(d,"$roll_skill",function(g){return this.$roll_category(g).$roll(g)}),A(d,"$prefixes",function(){var g=this;return H(["RTT[1-6]?","RCT",g.rtt,g.rct],g.rttn).$compact()}),d.$private(),A(d,"$format_skill",function(g,f){return this.$format(g,q(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:f.$category_dice(),row_dice:f.$row_dice(),category_name:f.$category_name(),skill_name:f.$name(),text:f.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var D,I,o,s,x,r,l,Y,H,W=e.module,z=e.klass,_=e.hash2,q=e.defs,w=e.truthy,k=e.def,F=e.rb_minus,R=[],E=e.nil;return D=R,I=H=[W(R[0],"BCDice")].concat(D),o=Y=[W(H[0],"DiceTable")].concat(I),x=[s=z(Y[0],null,"Table")].concat(o),r=e.$r(x),(l=s.$$prototype).times=l.sides=l.name=l.items=E,q(s,"$from_i18n",function(C,L){var d=E;return d=r("I18n").$t(C,_(["locale"],{locale:L})),this.$new(d["$[]"]("name"),d["$[]"]("type"),d["$[]"]("items"))}),k(s,"$initialize",function(C,L,h){var d=this,y=E;return d.name=C,d.items=h.$freeze(),y=/(\d+)D(\d+)/i.$match(L),w(y)||d.$raise(r("ArgumentError"),"Unexpected table type: "+L),d.times=y["$[]"](1).$to_i(),d.sides=y["$[]"](2).$to_i()}),k(s,"$roll",function(C){var h,L=this;return h=C.$roll_sum(L.times,L.sides),L.$choice(h)}),k(s,"$choice",function(C){var h,L=this;return h=F(C,L.times),r("RollResult").$new(L.name,C,L.items["$[]"](h))})},Opal.modules["bcdice/dice_table"]=function(e){var W=e.top;return W.$require("bcdice/dice_table/roll_result"),W.$require("bcdice/dice_table/chain_table"),W.$require("bcdice/dice_table/d66_grid_table"),W.$require("bcdice/dice_table/d66_half_grid_table"),W.$require("bcdice/dice_table/d66_one_third_table"),W.$require("bcdice/dice_table/d66_left_range_table"),W.$require("bcdice/dice_table/d66_parity_table"),W.$require("bcdice/dice_table/d66_range_table"),W.$require("bcdice/dice_table/d66_table"),W.$require("bcdice/dice_table/range_table"),W.$require("bcdice/dice_table/sai_fic_skill_table"),W.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var k,A,j,R,W=e.module,z=e.const_set,_=[];return k=_,A=R=[W(_[0],"BCDice")].concat(k),j=[W(R[0],"D66SortType")].concat(A),z(j[0],"NO_SORT","no_sort"),z(j[0],"ASC","asc"),z(j[0],"DESC","desc"),function(E,A){var j=[W(E,"RoundType")].concat(A);return z(j[0],"CEIL","ceil"),z(j[0],"FLOOR","floor"),z(j[0],"ROUND","round")}(R[0],R)},Opal.modules["bcdice/translate"]=function(e){var A,N,I,S,Y,j,W=e.module,z=e.ensure_kwargs,_=e.kwrestargs,w=e.hash2,k=e.def,F=[],R=e.nil;return A=F,N=j=[W(F[0],"BCDice")].concat(A),S=[I=W(j[0],"Translate")].concat(N),Y=e.$r(S),k(I,"$translate",function(a,o){var s,x=this;return null==x.locale&&(x.locale=R),o=z(o),s=_(o,{}),Y("I18n").$translate(a,w(["locale","raise"],{locale:x.locale,raise:!0}).$merge(e.to_hash(s)))},-2)},Opal.modules["bcdice/result"]=function(e){var I,K,S,A,j,z=e.klass,_=e.send,q=e.def,w=e.return_val,k=e.return_ivar,F=[],R=e.nil;return A=F,I=j=[(0,e.module)(F[0],"BCDice")].concat(A),[S=z(j[0],null,"Result")].concat(I),q(K=e.get_singleton_class(S),"$success",function(s){return _(this.$new(),"tap",[],function(l){var v;return null==l&&(l=R),l["$text="](s),_(l,"success=",v=[!0]),v[v.length-1]})}),q(K,"$failure",function(s){return _(this.$new(),"tap",[],function(l){var v;return null==l&&(l=R),l["$text="](s),_(l,"failure=",v=[!0]),v[v.length-1]})}),q(K,"$critical",function(s){return _(this.$new(),"tap",[],function(l){var v;return null==l&&(l=R),l["$text="](s),l["$critical="](!0),_(l,"success=",v=[!0]),v[v.length-1]})}),q(K,"$fumble",function(s){return _(this.$new(),"tap",[],function(l){var v;return null==l&&(l=R),l["$text="](s),l["$fumble="](!0),_(l,"failure=",v=[!0]),v[v.length-1]})}),q(K,"$nothing",w("nothing")),q(S,"$initialize",function(a){var o=this;return null==a&&(a=R),o.text=a,o.rands=R,o.detailed_rands=R,o.secret=!1,o.success=!1,o.failure=!1,o.critical=!1,o.fumble=!1},-1),S.$attr_accessor("text","rands","detailed_rands"),S.$attr_writer("secret","success","failure","critical","fumble"),q(S,"$secret?",k("secret")),q(S,"$success?",k("success")),q(S,"$failure?",k("failure")),q(S,"$critical?",k("critical")),q(S,"$fumble?",k("fumble")),q(S,"$condition=",function(a){return this.success=a,this.failure=a["$!"]()})},Opal.modules["racc/parser"]=function(e){var C,h,d,W=e.module,z=e.klass,_=e.truthy,q=e.const_set,w=e.defs,k=e.gvars,F=e.rb_lt,R=e.def,E=e.to_ary,A=e.send,D=e.neqeq,j=e.rb_plus,H=e.eqeq,N=e.rb_ge,I=e.rb_gt,S=e.rb_minus,Y=e.rb_le,K=e.rb_times,a=e.assign_ivar_val,s=[],x=e.$r(s),r=e.nil,l=e.$$$;return C=s,h=[W(s[0],"Racc")].concat(C),d=e.$r(h),z(h[0],d("StandardError"),"ParseError"),_(l("::","ParseError","skip_raise")?"constant":r)||q(s[0],"ParseError",l(x("Racc"),"ParseError")),function(v,C){var c,g,f,P,B,d=[W(v,"Racc")].concat(C),y=e.$r(d);return _(y("Racc_No_Extensions","skip_raise")?"constant":r)||q(d[0],"Racc_No_Extensions",!1),c=d,f=[g=z(d[0],null,"Parser")].concat(c),P=e.$r(f),(B=g.$$prototype).yydebug=B.racc_debug_out=B.racc_error_status=B.racc_t=B.racc_vstack=B.racc_val=B.racc_state=B.racc_tstack=r,q(f[0],"Racc_Runtime_Version","1.4.6"),q(f[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),q(f[0],"Racc_Runtime_Core_Version_R","1.4.6"),q(f[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),q(f[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),q(f[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),q(f[0],"Racc_Runtime_Core_Version",P("Racc_Runtime_Core_Version_R")),q(f[0],"Racc_Runtime_Core_Revision",P("Racc_Runtime_Core_Revision_R")),q(f[0],"Racc_Runtime_Type","ruby"),w(P("Parser"),"$racc_runtime_type",function(){return P("Racc_Runtime_Type")}),R(g,"$_racc_setup",function(){var t,u,i=this,$=r,n=r;return null==k.stderr&&(k.stderr=r),_(l(i.$class(),"Racc_debug_parser"))||(i.yydebug=!1),_(null!=(t=i.yydebug)&&t!==r?"instance-variable":r)||(i.yydebug=!1),_(i.yydebug)&&(_(null!=(u=i.racc_debug_out)&&u!==r?"instance-variable":r)||(i.racc_debug_out=k.stderr),i.racc_debug_out=_($=i.racc_debug_out)?$:k.stderr),n=l(i.$class(),"Racc_arg"),_(F(n.$size(),14))&&n["$[]="](13,!0),n}),R(g,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=r,t.racc_val=r,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),R(g,"$do_parse",function(){return this.$__send__(P("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),R(g,"$next_token",function(){return this.$raise(P("NotImplementedError"),this.$class()+"#next_token is not defined")}),R(g,"$_racc_do_parse_rb",function(t,u){var i,n=this,G=r,X=r,U=r,Z=r,te=r,ne=r,se=r,ue=r;return i=E(t),G=null==i[0]?r:i[0],X=null==i[1]?r:i[1],U=null==i[2]?r:i[2],Z=null==i[3]?r:i[3],te=null==i[10]?r:i[10],n.$_racc_init_sysvars(),ne=se=ue=r,A(n,"catch",["racc_end_parse"],function ae(){var ce,V,T=null==ae.$$s?this:ae.$$s,J=r;for(null==T.racc_state&&(T.racc_state=r),null==T.racc_read_next&&(T.racc_read_next=r),null==T.racc_t&&(T.racc_t=r),null==T.yydebug&&(T.yydebug=r),null==T.racc_val&&(T.racc_val=r);_(!0);)for(_(ue=Z["$[]"](T.racc_state["$[]"](-1)))?(_(T.racc_read_next)&&D(T.racc_t,0)&&(V=T.$next_token(),ce=E(V),ne=null==ce[0]?r:ce[0],T.racc_val=null==ce[1]?r:ce[1],T.racc_t=_(ne)?_(J=te["$[]"](ne))?J:1:0,_(T.yydebug)&&T.$racc_read_token(T.racc_t,ne,T.racc_val),T.racc_read_next=!1),ue=j(ue,T.racc_t),_(N(ue,0))&&_(se=G["$[]"](ue))&&H(X["$[]"](ue),T.racc_state["$[]"](-1))||(se=U["$[]"](T.racc_state["$[]"](-1)))):se=U["$[]"](T.racc_state["$[]"](-1));_(se=T.$_racc_evalact(se,t)););},{$$s:n})}),R(g,"$yyparse",function(t,u){return this.$__send__(P("Racc_YY_Parse_Method"),t,u,this.$_racc_setup(),!0)}),R(g,"$_racc_yyparse_rb",function(t,u,i,$){var n,X=this,U=r,Z=r,Q=r,te=r,se=r,ue=r,ae=r;return n=E(i),U=null==n[0]?r:n[0],Z=null==n[1]?r:n[1],Q=null==n[2]?r:n[2],te=null==n[3]?r:n[3],se=null==n[10]?r:n[10],X.$_racc_init_sysvars(),ue=r,ae=r,A(X,"catch",["racc_end_parse"],function ce(){var V=null==ce.$$s?this:ce.$$s;for(null==V.racc_state&&(V.racc_state=r);!_(ae=te["$[]"](V.racc_state["$[]"](-1)));)for(;_(ue=V.$_racc_evalact(Q["$[]"](V.racc_state["$[]"](-1)),i)););return A(t,"__send__",[u],function T(J,O){var M=null==T.$$s?this:T.$$s,re=r,$e=r;for(null==M.racc_t&&(M.racc_t=r),null==M.racc_state&&(M.racc_state=r),null==M.racc_read_next&&(M.racc_read_next=r),null==J&&(J=r),null==O&&(O=r),M.racc_t=_(J)?_(re=se["$[]"](J))?re:1:0,M.racc_val=O,M.racc_read_next=!1,ae=j(ae,M.racc_t),_(N(ae,0))&&_(ue=U["$[]"](ae))&&H(Z["$[]"](ae),M.racc_state["$[]"](-1))||(ue=Q["$[]"](M.racc_state["$[]"](-1)));_(ue=M.$_racc_evalact(ue,i)););for(;_(_(re=_($e=(ae=te["$[]"](M.racc_state["$[]"](-1)))["$!"]())?$e:M.racc_read_next["$!"]())?re:M.racc_t["$=="](0));)for(_(ae)&&_(ae=j(ae,M.racc_t))&&_(N(ae,0))&&_(ue=U["$[]"](ae))&&H(Z["$[]"](ae),M.racc_state["$[]"](-1))||(ue=Q["$[]"](M.racc_state["$[]"](-1)));_(ue=M.$_racc_evalact(ue,i)););},{$$s:V})},{$$s:X})}),R(g,"$_racc_evalact",function(t,u){var i,Q,n=this,G=r,X=r,Z=r,te=r,ne=r,se=r;if(G=null==(i=E(u))[0]?r:i[0],X=null==i[1]?r:i[1],Z=null==i[3]?r:i[3],Q=null==i[11]?r:i[11],te=null==i[12]?r:i[12],_(I(t,0))&&_(F(t,Q)))_(I(n.racc_error_status,0))&&(H(n.racc_t,1)||(n.racc_error_status=S(n.racc_error_status,1))),n.racc_vstack.$push(n.racc_val),n.racc_state.$push(t),n.racc_read_next=!0,_(n.yydebug)&&(n.racc_tstack.$push(n.racc_t),n.$racc_shift(n.racc_t,n.racc_tstack,n.racc_vstack));else if(_(F(t,0))&&_(I(t,te["$-@"]()))){if(ne=A(n,"catch",["racc_jump"],function ue(){var ae=null==ue.$$s?this:ue.$$s;return null==ae.racc_state&&(ae.racc_state=r),ae.racc_state.$push(ae.$_racc_do_reduce(u,t)),!1},{$$s:n}),_(ne))switch(ne.valueOf()){case 1:return n.racc_user_yyerror=!0,te["$-@"]();case 2:return Q;default:n.$raise("[Racc Bug] unknown jump code")}}else if(H(t,Q))_(n.yydebug)&&n.$racc_accept(),n.$throw("racc_end_parse",n.racc_vstack["$[]"](0));else{if(H(t,te["$-@"]())){switch(n.racc_error_status.valueOf()){case 0:_(u["$[]"](21))||n.$on_error(n.racc_t,n.racc_val,n.racc_vstack);break;case 3:H(n.racc_t,0)&&n.$throw("racc_end_parse",r),n.racc_read_next=!0}for(n.racc_user_yyerror=!1,n.racc_error_status=3;_(!0)&&!(_(se=Z["$[]"](n.racc_state["$[]"](-1)))&&(se=j(se,1),_(N(se,0))&&_(t=G["$[]"](se))&&H(X["$[]"](se),n.racc_state["$[]"](-1))));)_(Y(n.racc_state.$size(),1))&&n.$throw("racc_end_parse",r),n.racc_state.$pop(),n.racc_vstack.$pop(),_(n.yydebug)&&(n.racc_tstack.$pop(),n.$racc_e_pop(n.racc_state,n.racc_tstack,n.racc_vstack));return t}n.$raise("[Racc Bug] unknown action "+t.$inspect())}return _(n.yydebug)&&n.$racc_next_state(n.racc_state["$[]"](-1),n.racc_state),r}),R(g,"$_racc_do_reduce",function(t,u){var i,te,se,J,O,M,ie,n=this,X=r,U=r,Z=r,Q=r,ne=r,ue=r,ae=r,ce=r,V=r,T=r,re=r,$e=r,ee=r;return X=null==(i=E(t))[4]?r:i[4],U=null==i[5]?r:i[5],Z=null==i[6]?r:i[6],Q=null==i[7]?r:i[7],te=null==i[8]?r:i[8],ne=null==i[9]?r:i[9],se=null==i[13]?r:i[13],ue=n.racc_state,ae=n.racc_vstack,ce=n.racc_tstack,V=K(u,-3),T=ne["$[]"](V),J=ne["$[]"](j(V,1)),O=ne["$[]"](j(V,2)),M=[],_(n.yydebug)&&(re=ce["$[]"](T["$-@"](),T)),$e=ae["$[]"](T["$-@"](),T),_(n.yydebug)&&ce["$[]="](T["$-@"](),T,M),ae["$[]="](T["$-@"](),T,M),ue["$[]="](T["$-@"](),T,M),_(se)?ae.$push(n.$__send__(O,$e,ae,$e["$[]"](0))):ae.$push(n.$__send__(O,$e,ae)),ce.$push(J),_(n.yydebug)&&n.$racc_reduce(re,J,ce,ae),ie=S(J,te),_(V=Q["$[]"](ie))&&(V=j(V,ue["$[]"](-1)),_(N(V,0))&&_(ee=X["$[]"](V))&&H(U["$[]"](V),ie))?ee:Z["$[]"](ie)}),R(g,"$on_error",function(t,u,i){var n,$=this;return $.$raise(P("ParseError"),$.$sprintf("\nparse error on value %s (%s)",u.$inspect(),_(n=$.$token_to_str(t))?n:"?"))}),R(g,"$yyerror",function(){return this.$throw("racc_jump",1)}),R(g,"$yyaccept",function(){return this.$throw("racc_jump",2)}),R(g,"$yyerrok",a("racc_error_status",0)),R(g,"$racc_read_token",function(t,u,i){var $=this;return $.racc_debug_out.$print("read    "),$.racc_debug_out.$print(u.$inspect(),"(",$.$racc_token2str(t),") "),$.racc_debug_out.$puts(i.$inspect()),$.racc_debug_out.$puts()}),R(g,"$racc_shift",function(t,u,i){var $=this;return $.racc_debug_out.$puts("shift   "+$.$racc_token2str(t)),$.$racc_print_stacks(u,i),$.racc_debug_out.$puts()}),R(g,"$racc_reduce",function(t,u,i,$){var n=this,G=r;return(G=n.racc_debug_out).$print("reduce "),_(t["$empty?"]())?G.$print(" <none>"):A(t,"each",[],function X(U){return null==U&&(U=r),G.$print(" ",(null==X.$$s?this:X.$$s).$racc_token2str(U))},{$$s:n}),G.$puts(" --\x3e "+n.$racc_token2str(u)),n.$racc_print_stacks(i,$),n.racc_debug_out.$puts()}),R(g,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),R(g,"$racc_e_pop",function(t,u,i){var $=this;return $.racc_debug_out.$puts("error recovering mode: pop token"),$.$racc_print_states(t),$.$racc_print_stacks(u,i),$.racc_debug_out.$puts()}),R(g,"$racc_next_state",function(t,u){var i=this;return i.racc_debug_out.$puts("goto    "+t),i.$racc_print_states(u),i.racc_debug_out.$puts()}),R(g,"$racc_print_stacks",function(t,u){var $=r;return($=this.racc_debug_out).$print("        ["),A(t,"each_index",[],function n(G){return null==G&&(G=r),$.$print(" (",(null==n.$$s?this:n.$$s).$racc_token2str(t["$[]"](G))," ",u["$[]"](G).$inspect(),")")},{$$s:this}),$.$puts(" ]")}),R(g,"$racc_print_states",function(t){var i=r;return(i=this.racc_debug_out).$print("        ["),A(t,"each",[],function(n){return null==n&&(n=r),i.$print(" ",n)}),i.$puts(" ]")}),R(g,"$racc_token2str",function(t){var i;return _(i=l(this.$class(),"Racc_token_to_s_table")["$[]"](t))?i:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),R(g,"$token_to_str",function(t){return l(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(s[0],s)},Opal.modules["bcdice/arithmetic/node"]=function(e){var a,r,L,c,g,d,y,v,s,W=e.module,z=e.klass,_=e.def,q=e.thrower,w=e.return_ivar,k=e.send2,F=e.find_super,R=e.eqeq,E=e.const_set,A=e.eqeqeq,D=e.rb_divide,j=e.truthy,H=e.assign_ivar,N=e.alias,I=[],S=e.nil,Y=e.$$$;return a=I,r=s=[W(I[0],"BCDice")].concat(a),L=v=[W(s[0],"Arithmetic")].concat(r),d=[W(v[0],"Node")].concat(L),y=e.$r(d),(g=(c=z(d[0],null,"BinaryOp")).$$prototype).lhs=g.rhs=g.op=S,_(c,"$initialize",function(P,B,m){var t=this;return t.lhs=P,t.op=B,t.rhs=m}),_(c,"$eval",function(P){try{q("eval_return");var u,m=this,t=S;return t=m.lhs.$eval(P),u=m.rhs.$eval(P),t.$send(m.op,u)}catch(i){if(i===e.t_eval_return)return i.$v;throw i}}),_(c,"$output",function(){var P=this;return""+P.lhs.$output()+P.op+P.rhs.$output()}),_(c,"$s_exp",function(){var P=this;return"("+P.$op_for_s_exp()+" "+P.lhs.$s_exp()+" "+P.rhs.$s_exp()+")"}),_(c,"$op_for_s_exp",w("op")),function(b,p,c){var g=z(b,p,"DivideBase"),f=[g].concat(c),P=e.$r(f),B=g.$$prototype;B.lhs=B.rhs=B.op=S,_(g,"$initialize",function m(t,u){return m.$$p=null,k(this,F(this,"initialize",m,!1,!0),"initialize",[t,"/",u],null)}),_(g,"$eval",function(t){try{q("eval_return");var $,n,i=this;return $=i.lhs.$eval(t),n=i.rhs.$eval(t),R(n,0)&&i.$raise(P("ZeroDivisionError")),i.$divide_and_round($,n,t)}catch(G){if(G===e.t_eval_return)return G.$v;throw G}}),_(g,"$output",function m(){var t=m.$$p||S,u=this;return m.$$p=null,""+k(u,F(u,"output",m,!1,!0),"output",[],t)+u.$rounding_method()}),g.$private(),_(g,"$rounding_method",function(){return Y(this.$class(),"ROUNDING_METHOD")}),_(g,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(g,"$divide_and_round",function(t,u,i){return this.$raise(P("NotImplementedError"))})}(d[0],y("BinaryOp"),d),function(b,p,c){var g=z(b,p,"DivideWithGameSystemDefault"),f=[g].concat(c),P=e.$r(f);E(f[0],"ROUNDING_METHOD",""),g.$private(),_(g,"$divide_and_round",function(m,t,u){var i,$=S;return A(Y(P("RoundType"),"CEIL"),i=u)?D(m.$to_f(),t).$ceil():A(Y(P("RoundType"),"ROUND"),i)?($=D(m.$to_f(),t),j($["$negative?"]())?$.$abs().$round()["$-@"]():$.$round()):D(m,t).$floor()})}(d[0],y("DivideBase"),d),function(b,p,c){var g=z(b,p,"DivideWithCeil"),f=[g].concat(c);E(f[0],"ROUNDING_METHOD","C"),g.$private(),_(g,"$divide_and_round",function(B,m,t){return D(B.$to_f(),m).$ceil()})}(d[0],y("DivideBase"),d),function(b,p,c){var g=z(b,p,"DivideWithRound"),f=[g].concat(c);E(f[0],"ROUNDING_METHOD","R"),g.$private(),_(g,"$divide_and_round",function(B,m,t){var u=S;return u=D(B.$to_f(),m),j(u["$negative?"]())?u.$abs().$round()["$-@"]():u.$round()})}(d[0],y("DivideBase"),d),function(b,p,c){var g=z(b,p,"DivideWithFloor"),f=[g].concat(c);E(f[0],"ROUNDING_METHOD","F"),g.$private(),_(g,"$divide_and_round",function(B,m,t){return D(B,m).$floor()})}(d[0],y("DivideBase"),d),function(b,p){var c=z(b,null,"Negative");c.$$prototype.body=S,_(c,"$initialize",H("body")),_(c,"$eval",function(P){try{return q("eval_return"),this.body.$eval(P)["$-@"]()}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),_(c,"$output",function(){return"-"+this.body.$output()}),_(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(d[0]),function(b,p){var c=z(b,null,"Parenthesis");c.$$prototype.expr=S,_(c,"$initialize",H("expr")),_(c,"$eval",function(P){try{return q("eval_return"),this.expr.$eval(P)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),_(c,"$output",function(){return"("+this.expr.$output()+")"}),_(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(d[0]),function(b,p){var c=z(b,null,"Number");return c.$$prototype.value=S,_(c,"$initialize",H("value")),_(c,"$eval",w("value")),_(c,"$output",function(){return this.value.$to_s()}),N(c,"s_exp","output")}(d[0])},Opal.modules.strscan=function(e){var H,N,I,S,Y,z=e.def,_=e.truthy,q=e.eqeqeq,w=e.Opal,k=e.return_ivar,F=e.send,R=e.alias,E=[],A=e.nil;return H=E,I=[N=(0,e.klass)(E[0],null,"StringScanner")].concat(H),S=e.$r(I),(Y=N.$$prototype).pos=Y.string=Y.working=Y.matched=Y.prev_pos=Y.match=A,N.$attr_reader("pos","matched"),z(N,"$initialize",function(a){var o=this;return o.string=a,o.pos=0,o.matched=A,o.working=a,o.match=[]}),N.$attr_reader("string"),z(N,"$beginning_of_line?",function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)}),z(N,"$scan",function(a){var o=this,s=(a=o.$anchor(a)).exec(o.working);return null==s?o.matched=A:(o.prev_pos=o.pos,o.pos+=s[0].length,o.working=o.working.substring(s[0].length),o.matched=s[0],o.match=s,s[0])}),z(N,"$scan_until",function(a){var o=this;a=o.$anchor(a);for(var s=o.working,x=0;s.length!=x;++x){var r=a.exec(s.substr(x));if(null!==r){var l=x+r[0].length,v=s.substr(0,l);return o.matched=r[0],o.match=r,o.prev_pos=o.pos+x,o.pos+=l,o.working=s.substr(l),v}}return o.matched=A}),z(N,"$[]",function(a){var s;if(_(this.match["$empty?"]()))return A;q(S("Symbol"),s=a)?a=a.$to_s():q(S("String"),s)||(a=w["$coerce_to!"](a,S("Integer"),"to_int"));var x=this.match;return a<0&&(a+=x.length),a<0||a>=x.length||null==x[a]?A:x[a]}),z(N,"$check",function(a){var o=this,s=(a=o.$anchor(a)).exec(o.working);return o.matched=null==s?A:s[0]}),z(N,"$check_until",function(a){var o=this,s=o.prev_pos,x=o.pos,r=o.working,l=o.$scan_until(a);return o.prev_pos=s,o.pos=x,o.working=r,l}),z(N,"$peek",function(a){return this.working.substring(0,a)}),z(N,"$eos?",function(){return 0===this.working.length}),z(N,"$exist?",function(a){var s=a.exec(this.working);return null==s?A:0==s.index?0:s.index+1}),z(N,"$skip",function(a){var o=this,s=(a=o.$anchor(a)).exec(o.working);if(null==s)return o.match=[],o.matched=A;var x=s[0],r=x.length;return o.matched=x,o.match=s,o.prev_pos=o.pos,o.pos+=r,o.working=o.working.substring(r),r}),z(N,"$skip_until",function(a){var s=this.$scan_until(a);return s===A?A:(this.matched=s.substr(-1),s.length)}),z(N,"$get_byte",function(){var a=this,o=A;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,o=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=A,o}),z(N,"$match?",function(a){var o=this,s=(a=o.$anchor(a)).exec(o.working);return null==s?A:(o.prev_pos=o.pos,s[0].length)}),z(N,"$pos=",function(a){var o=this;return a<0&&(a+=o.string.$length()),o.pos=a,o.working=o.string.slice(a)}),z(N,"$matched_size",function(){return this.matched===A?A:this.matched.length}),z(N,"$post_match",function(){var a=this;return a.matched===A?A:a.string.substr(a.pos)}),z(N,"$pre_match",function(){var a=this;return a.matched===A?A:a.string.substr(0,a.prev_pos)}),z(N,"$reset",function(){var a=this;return a.working=a.string,a.matched=A,a.pos=0}),z(N,"$rest",k("working")),z(N,"$rest?",function(){return 0!==this.working.length}),z(N,"$rest_size",function(){return this.$rest().$size()}),z(N,"$terminate",function(){var a,o=this;return o.match=A,a=[o.string.$length()],F(o,"pos=",a),a[a.length-1]}),z(N,"$unscan",function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=A,a.match=A,a}),R(N,"bol?","beginning_of_line?"),R(N,"getch","get_byte"),N.$private(),z(N,"$anchor",function(a){var o=a.toString().match(/\/([^\/]+)$/);return o=o?o[1]:void 0,new RegExp("^(?:"+a.source+")",o)})},Opal.modules["bcdice/normalize"]=function(e){var R,j,A,W=e.module,z=e.eqeqeq,_=e.def,q=e.eqeq,w=[],k=e.nil;return R=w,A=[W(w[0],"BCDice")].concat(R),(j=W(A[0],"Normalize")).$module_function(),_(j,"$comparison_operator",function(N){var I;return z(/<=|=</,I=N)?"<=":z(/>=|=>/,I)?">=":z(/<>|!=|=!/,I)?"!=":z(/</,I)?"<":z(/>/,I)?">":z(/=/,I)?"==":k}),_(j,"$target_number",function(N){return q(N,"?")?N:N.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var H,Y,x,r,l,v,C,a,I,W=e.module,z=e.klass,_=e.const_set,q=e.hash2,w=e.truthy,k=e.send,F=e.def,R=e.thrower,E=e.top,A=[],D=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),H=A,Y=I=[W(A[0],"BCDice")].concat(H),x=a=[W(I[0],"Command")].concat(Y),l=[r=z(a[0],null,"Lexer")].concat(x),v=e.$r(l),(C=r.$$prototype).scanner=C.notations=D,_(l[0],"SYMBOLS",q(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),F(r,"$initialize",function(h,d){var y,b,c;return h=w(c=(y=(b=h)===D||null==b?D:b.$split(" ",2))===D||null==y?D:y.$first())?c:"",this.scanner=v("StringScanner").$new(h),this.notations=k(d,"map",[],function(f){return null==f&&(f=D),w(f["$is_a?"](v("String")))?v("Regexp").$new(f):f})}),F(r,"$next_token",function(){try{var h=R("return"),d=this,y=D,b=D,c=D,g=D;return w(d.scanner["$eos?"]())?[!1,"$"]:(k(d.notations,"each",[],function f(P){var m,B=null==f.$$s?this:f.$$s;if(null==B.scanner&&(B.scanner=D),null==P&&(P=D),m=B.scanner.$scan(P),!w(m))return D;h.$throw(["NOTATION",m])},{$$s:d,$$ret:h}),w(y=d.scanner.$scan(/\d+/))?["NUMBER",y.$to_i()]:w(b=d.scanner.$scan(/[<>!=]+/))?(b=v("Normalize").$comparison_operator(b),[w(b)?"CMP_OP":"ILLEGAL",b]):(c=d.scanner.$getch().$upcase(),[w(g=v("SYMBOLS")["$[]"](c))?g:c.$to_sym(),c]))}catch(f){if(f===h)return f.$v;throw f}}),F(r,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,H,K,a,o,s,x,I,D,W=e.module,z=e.klass,_=e.def,q=e.return_ivar,w=e.truthy,k=[],F=e.nil;return E=k,H=D=[W(k[0],"BCDice")].concat(E),K=I=[W(D[0],"Command")].concat(H),o=[a=z(I[0],null,"Parsed")].concat(K),s=e.$r(o),(x=a.$$prototype).critical=x.fumble=x.dollar=x.modify_number=x.question_target=x.target_number=x.prefix_number=x.command=x.suffix_number=x.cmp_op=F,a.$attr_accessor("command"),a.$attr_accessor("prefix_number"),a.$attr_accessor("suffix_number"),a.$attr_accessor("critical"),a.$attr_accessor("fumble"),a.$attr_accessor("dollar"),a.$attr_accessor("modify_number"),a.$attr_accessor("cmp_op"),a.$attr_accessor("target_number"),a.$attr_writer("question_target"),_(a,"$initialize",function(){var l=this;return l.prefix_number=F,l.suffix_number=F,l.critical=F,l.fumble=F,l.dollar=F,l.cmp_op=F,l.target_number=F,l.question_target=!1}),_(a,"$question_target?",q("question_target")),_(a,"$to_s",function(l){var v=this,C=F,L=F,h=F,d=F,y=F;switch(null==l&&(l="after_command"),C=w(v.critical)?"@"+v.critical:F,L=w(v.fumble)?"#"+v.fumble:F,h=w(v.dollar)?"$"+v.dollar:F,d=s("Format").$modifier(v.modify_number),y=w(v.question_target)?"?":v.target_number,l.valueOf()){case"after_command":return[v.prefix_number,v.command,v.suffix_number,C,L,h,d,v.cmp_op,y].$join();case"after_modify_number":return[v.prefix_number,v.command,v.suffix_number,d,C,L,h,v.cmp_op,y].$join();case"after_target_number":return[v.prefix_number,v.command,v.suffix_number,d,v.cmp_op,y,C,L,h].$join();default:return F}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var l,h,g,u,i,$,n,G,X,U,Z,Q,se,f,m,t,ce,y,b,C,W=e.klass,z=e.module,_=e.slice,q=e.extract_kwargs,w=e.ensure_kwargs,k=e.get_kwarg,F=e.send2,R=e.find_super,E=e.def,A=e.send,D=e.eqeq,j=e.thrower,H=e.hash,N=e.const_set,I=e.truthy,S=e.to_ary,Y=e.hash2,K=e.top,a=[],o=e.$r(a),s=e.nil,x=e.$$$;return K.$require("racc/parser.rb"),K.$require("bcdice/arithmetic/node"),K.$require("bcdice/command/lexer"),K.$require("bcdice/command/parsed"),W(x(o("BCDice"),"Command"),x(o("Racc"),"Parser"),"Parser"),l=a,h=C=[z(a[0],"BCDice")].concat(l),y=[z(C[0],"Command")].concat(h),b=e.$r(y),g=y,m=[f=W(y[0],x(b("Racc"),"Parser"),"Parser")].concat(g),t=e.$r(m),(ce=f.$$prototype).notations=ce.lexer=ce.modifier=ce.suffix_number=ce.prefix_number=ce.need_suffix_number=ce.need_prefix_number=ce.critical=ce.fumble=ce.dollar=ce.allowed_cmp_op=ce.question_target=s,E(f,"$initialize",function V(T,J){var O,M,re,$e,ee=this;return V.$$p=null,O=_(arguments),M=q(O),M=w(M),re=O,$e=k(M,"round_type"),F(ee,R(ee,"initialize",V,!1,!0),"initialize",[],null),ee.notations=re,ee.round_type=$e,ee.prefix_number=!1,ee.suffix_number=!1,ee.need_prefix_number=!1,ee.need_suffix_number=!1,ee.modifier=!0,ee.critical=!1,ee.fumble=!1,ee.dollar=!1,ee.allowed_cmp_op=[s,">=",">","<=","<","==","!="],ee.question_target=!1},-2),E(f,"$disable_modifier",function(){return this.modifier=!1,this}),E(f,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(f,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(f,"$has_prefix_number",function(){var T=this;return T.prefix_number=!0,T.need_prefix_number=!0,T}),E(f,"$has_suffix_number",function(){var T=this;return T.suffix_number=!0,T.need_suffix_number=!0,T}),E(f,"$enable_critical",function(){return this.critical=!0,this}),E(f,"$enable_fumble",function(){return this.fumble=!0,this}),E(f,"$enable_dollar",function(){return this.dollar=!0,this}),E(f,"$restrict_cmp_op_to",function(T){var J;return J=_(arguments),this.allowed_cmp_op=J,this},-1),E(f,"$enable_question_target",function(){return this.question_target=!0,this}),E(f,"$parse",function(T){var J=this;try{return J.lexer=t("Lexer").$new(T,J.notations),J.$do_parse()}catch(O){if(!e.rescue(O,[t("ParseError"),t("ZeroDivisionError")]))throw O;try{return s}finally{e.pop_exception()}}}),f.$private(),E(f,"$parsed",function(T,J,O,M){try{return j("eval_return"),A(t("Parsed").$new(),"tap",[],function ie(ee){var le,_e,de,me,ve,fe,be,oe=null==ie.$$s?this:ie.$$s;return null==oe.round_type&&(oe.round_type=s),null==ee&&(ee=s),ee["$command="](T["$[]"]("command")),ee["$prefix_number="]((le=T["$[]"]("prefix"))===s||null==le?s:le.$eval(oe.round_type)),ee["$suffix_number="]((_e=T["$[]"]("suffix"))===s||null==_e?s:_e.$eval(oe.round_type)),ee["$critical="]((de=J["$[]"]("critical"))===s||null==de?s:de.$eval(oe.round_type)),ee["$fumble="]((me=J["$[]"]("fumble"))===s||null==me?s:me.$eval(oe.round_type)),ee["$dollar="]((ve=J["$[]"]("dollar"))===s||null==ve?s:ve.$eval(oe.round_type)),ee["$modify_number="](O.$eval(oe.round_type)),ee["$cmp_op="](M["$[]"]("cmp_op")),D(M["$[]"]("target"),"?")?(ee["$question_target="](!0),A(ee,"target_number=",fe=[0]),fe[fe.length-1]):(ee["$question_target="](!1),fe=[(be=M["$[]"]("target"),be===s||null==be?s:be.$eval(oe.round_type))],A(ee,"target_number=",fe),fe[fe.length-1])},{$$s:this})}catch(ie){if(ie===e.t_eval_return)return ie.$v;throw ie}}),E(f,"$next_token",function(){return this.lexer.$next_token()}),u=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),i=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),$=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),n=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),G=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),X=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),U=[s,6,13,3,9,-1,27,-15,-10,-1,-38],Z=[s,s,s,s,s,s,19,16,15,s,s],Q=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),se=H(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),N(m[0],"Racc_arg",[u,i,n,$,G,X,Z,U,19,Q,se,58,35,!0]),I(t("Ractor","skip_raise")?"constant":s)&&t("Ractor").$make_shareable(t("Racc_arg")),N(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),I(t("Ractor","skip_raise")?"constant":s)&&t("Ractor").$make_shareable(t("Racc_token_to_s_table")),N(m[0],"Racc_debug_parser",!1),E(f,"$_reduce_1",function(T,J,O){var M;return I(this.modifier)||this.$raise(t("ParseError")),M=S(T),this.$parsed(null==M[0]?s:M[0],null==M[1]?s:M[1],null==M[2]?s:M[2],null==M[3]?s:M[3])}),E(f,"$_reduce_2",function(T,J,O){var M;return I(this.modifier)||this.$raise(t("ParseError")),M=S(T),this.$parsed(null==M[0]?s:M[0],null==M[2]?s:M[2],null==M[1]?s:M[1],null==M[3]?s:M[3])}),E(f,"$_reduce_3",function(T,J,O){var M,le;return le=null==(M=S(T))[2]?s:M[2],this.$parsed(null==M[0]?s:M[0],null==M[1]?s:M[1],x(x(t("Arithmetic"),"Node"),"Number").$new(0),le)}),E(f,"$_reduce_4",function(T,J,O){var M=this;return I(M.prefix_number)&&I(M.suffix_number)||M.$raise(t("ParseError")),Y(["command","prefix","suffix"],{command:T["$[]"](1),prefix:T["$[]"](0),suffix:T["$[]"](2)})}),E(f,"$_reduce_5",function(T,J,O){var M=this;return I(M.prefix_number)||M.$raise(t("ParseError")),I(M.need_suffix_number)&&M.$raise(t("ParseError")),Y(["command","prefix"],{command:T["$[]"](1),prefix:T["$[]"](0)})}),E(f,"$_reduce_6",function(T,J,O){var M=this;return I(M.suffix_number)||M.$raise(t("ParseError")),I(M.need_prefix_number)&&M.$raise(t("ParseError")),Y(["command","suffix"],{command:T["$[]"](0),suffix:T["$[]"](1)})}),E(f,"$_reduce_7",function(T,J,O){var M=this;return(I(M.need_prefix_number)||I(M.need_suffix_number))&&M.$raise(t("ParseError")),Y(["command"],{command:T["$[]"](0)})}),E(f,"$_reduce_8",function(T,J,O){return Y([],{})}),E(f,"$_reduce_9",function(T,J,O){var M,le,ie=s;return ie=null==(M=S(T))[0]?s:M[0],le=null==M[2]?s:M[2],I(this.critical)&&I(ie["$[]"]("critical")["$nil?"]())||this.$raise(t("ParseError")),ie["$[]="]("critical",le),ie}),E(f,"$_reduce_10",function(T,J,O){var M,le,ie=s;return ie=null==(M=S(T))[0]?s:M[0],le=null==M[2]?s:M[2],I(this.fumble)&&I(ie["$[]"]("fumble")["$nil?"]())||this.$raise(t("ParseError")),ie["$[]="]("fumble",le),ie}),E(f,"$_reduce_11",function(T,J,O){var M,le,ie=s;return ie=null==(M=S(T))[0]?s:M[0],le=null==M[2]?s:M[2],I(this.dollar)&&I(ie["$[]"]("dollar")["$nil?"]())||this.$raise(t("ParseError")),ie["$[]="]("dollar",le),ie}),E(f,"$_reduce_12",function(T,J,O){return T["$[]"](1)}),E(f,"$_reduce_13",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"Negative").$new(T["$[]"](1))}),E(f,"$_reduce_14",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"+",T["$[]"](2))}),E(f,"$_reduce_15",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"-",T["$[]"](2))}),E(f,"$_reduce_16",function(T,J,O){return I(this.allowed_cmp_op["$include?"](s))||this.$raise(t("ParseError")),Y([],{})}),E(f,"$_reduce_17",function(T,J,O){var M,ie,ee;return ee=null==(M=S(T))[1]?s:M[1],I(this.allowed_cmp_op["$include?"](ie=null==M[0]?s:M[0]))||this.$raise(t("ParseError")),Y(["cmp_op","target"],{cmp_op:ie,target:ee})}),E(f,"$_reduce_18",function(T,J,O){var re,M=this;return re=T["$[]"](0),I(M.question_target)||M.$raise(t("ParseError")),I(M.allowed_cmp_op["$include?"](re))||M.$raise(t("ParseError")),Y(["cmp_op","target"],{cmp_op:re,target:"?"})}),E(f,"$_reduce_19",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"+",T["$[]"](2))}),E(f,"$_reduce_20",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"-",T["$[]"](2))}),E(f,"$_reduce_22",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"BinaryOp").$new(T["$[]"](0),"*",T["$[]"](2))}),E(f,"$_reduce_23",function(T,J,O){return T["$[]"](3).$new(T["$[]"](0),T["$[]"](2))}),E(f,"$_reduce_25",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(f,"$_reduce_26",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"DivideWithCeil")}),E(f,"$_reduce_27",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"DivideWithCeil")}),E(f,"$_reduce_28",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"DivideWithRound")}),E(f,"$_reduce_29",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"DivideWithFloor")}),E(f,"$_reduce_30",function(T,J,O){return T["$[]"](1)}),E(f,"$_reduce_31",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"Negative").$new(T["$[]"](1))}),E(f,"$_reduce_33",function(T,J,O){return T["$[]"](1)}),E(f,"$_reduce_34",function(T,J,O){return x(x(t("Arithmetic"),"Node"),"Number").$new(T["$[]"](0))}),E(f,"$_reduce_none",function(T,J,O){return T["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var A,N,K,a,o,s,S,j,W=e.module,z=e.send,_=e.eqeqeq,q=e.truthy,w=e.def,k=e.return_val,F=[],R=e.nil;return A=F,N=j=[W(F[0],"BCDice")].concat(A),K=S=[W(j[0],"Deprecated")].concat(N),o=[a=W(S[0],"Checker")].concat(K),s=e.$r(o),a.$private(),w(a,"$check_result_legacy",function(r,l,v,C){var y,L=this,h=R,d=R,b=R,p=R;return h=z(l,"map",[],"sides".$to_proc()),y=(d=z(l,"map",[],"value".$to_proc())).$sum(),b=_([100],p=h)?L.$check_1D100(r,y,v,C):_([20],p)?L.$check_1D20(r,y,v,C):_([6,6],p)?L.$check_2D6(r,y,d,v,C):R,(q(b["$nil?"]())||q(b["$empty?"]()))&&(b=_([10],p=h.$uniq())?L.$check_nD10(r,y,d,v,C):_([6],p)?L.$check_nD6(r,y,d,v,C):R,q(b["$nil?"]())||q(b["$empty?"]()))?R:s("Result").$new(b.$delete_prefix(" \uff1e "))}),w(a,"$check_1D100",k(R)),w(a,"$check_1D20",k(R)),w(a,"$check_nD10",k(R)),w(a,"$check_2D6",k(R)),w(a,"$check_nD6",k(R))},Opal.modules["bcdice/base"]=function(e){var o,L,p,B,t,u,c,g,f,P,d,W=e.module,z=e.klass,_=e.slice,q=e.rb_plus,w=e.truthy,k=e.def,F=e.regexp,R=e.send,E=e.thrower,A=e.return_ivar,D=e.assign_ivar_val,j=e.eqeqeq,H=e.eqeq,N=e.return_val,I=e.range,S=e.rb_minus,Y=e.rb_divide,K=e.rb_times,a=e.rb_ge,s=e.top,x=[],r=e.$r(x),l=e.nil,v=e.$$$;return s.$require("i18n"),s.$require("i18n/backend/fallbacks"),s.$require("bcdice/randomizer"),s.$require("bcdice/dice_table"),s.$require("bcdice/enum"),s.$require("bcdice/translate"),s.$require("bcdice/result"),s.$require("bcdice/command/parser"),s.$require("bcdice/deprecated/checker"),L=x,p=d=[W(x[0],"BCDice")].concat(L),g=[c=z(d[0],null,"Base")].concat(p),f=e.$r(g),(P=c.$$prototype).raw_input=P.randomizer=P.enabled_upcase_input=P.debug=l,t=[B=e.get_singleton_class(c)].concat(g),u=e.$r(t),B.$attr_reader("prefixes"),k(B,"$register_prefix",function($){var G,U,X=this;return null==X.prefixes&&(X.prefixes=l),G=_(arguments),X.prefixes=q(w(U=X.prefixes)?U:[],G.$flatten())},-1),k(B,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),k(B,"$prefixes_pattern",function(){var $=this,n=l;return null==$.prefixes_pattern&&($.prefixes_pattern=l),null==$.prefixes&&($.prefixes=l),$.prefixes_pattern=w(n=$.prefixes_pattern)?n:l,w($.prefixes_pattern)?$.prefixes_pattern:($.prefixes=w(n=$.prefixes)?n:[],$.prefixes.$freeze(),$.prefixes_pattern=(w($.prefixes["$empty?"]())?/(?!)/:F(["^(S)?(",$.prefixes.$join("|"),")"],"i")).$freeze())}),k(B,"$command_pattern",function(){var $=this,n=l,G=l;return null==$.command_pattern&&($.command_pattern=l),null==$.prefixes&&($.prefixes=l),$.command_pattern=w(n=$.command_pattern)?n:l,w($.command_pattern)?$.command_pattern:($.prefixes=w(n=$.prefixes)?n:[],$.prefixes.$freeze(),G=q(R(v(u("CommonCommand"),"COMMANDS"),"map",[],function(U){return null==U&&(U=l),v(U,"PREFIX_PATTERN").$source()}),$.prefixes),$.command_pattern=F(["^S?(",G.$join("|"),")"],"i").$freeze())}),k(B,"$eval",function($){try{return E("eval_return"),this.$new($).$eval()}catch(X){if(X===e.t_eval_return)return X.$v;throw X}}),c.$include(f("Translate")),c.$include(v(f("Deprecated"),"Checker")),k(c,"$initialize",function(m){var t=this;return t.raw_input=m,t.sort_add_dice=!1,t.sort_barabara_dice=!1,t.d66_sort_type=v(f("D66SortType"),"NO_SORT"),t.enabled_d9=!1,t.round_type=v(f("RoundType"),"FLOOR"),t.sides_implicit_d=6,t.upper_dice_reroll_threshold=l,t.reroll_dice_reroll_threshold=l,t.default_cmp_op=l,t.default_target_number=l,t.enabled_upcase_input=!0,t.locale="ja_jp",t.randomizer=v(f("BCDice"),"Randomizer").$new(),t.debug=!1}),c.$attr_accessor("randomizer"),c.$attr_reader("d66_sort_type"),c.$attr_reader("round_type"),c.$attr_reader("sides_implicit_d"),c.$attr_reader("upper_dice_reroll_threshold"),c.$attr_reader("reroll_dice_reroll_threshold"),c.$attr_reader("default_cmp_op"),c.$attr_reader("default_target_number"),k(c,"$sort_add_dice?",A("sort_add_dice")),k(c,"$sort_barabara_dice?",A("sort_barabara_dice")),k(c,"$enabled_d9?",A("enabled_d9")),k(c,"$enable_debug",D("debug",!0)),k(c,"$eval",function(){var t,i,m=this,u=l;return t=v(f("BCDice"),"Preprocessor").$process(m.raw_input,m),u=w(i=m.$dice_command(t))?i:m.$eval_common_command(m.raw_input),w(u)?(u["$rands="](m.randomizer.$rand_results()),u["$detailed_rands="](m.randomizer.$detailed_rand_results()),u):l}),k(c,"$change_text",function(m){return m}),k(c,"$check_result",function(m,t,u,i){var $=this,n=l,G=l,X=l,U=l,Z=l;return n=$.$check_result_legacy(m,t,u,i),w(n)?n:(G=R(t,"map",[],"sides".$to_proc()),U=(X=R(t,"map",[],"value".$to_proc())).$sum(),n=j([100],Z=G)?$.$result_1d100(m,U,u,i):j([20],Z)?$.$result_1d20(m,U,u,i):j([6,6],Z)?$.$result_2d6(m,U,X,u,i):l,H(n,f("Result").$nothing())?l:w(n)?n:(n=j([10],Z=G.$uniq())?$.$result_nd10(m,U,X,u,i):j([6],Z)?$.$result_nd6(m,U,X,u,i):l,H(n,f("Result").$nothing())?l:w(n)?n:$.$result_ndx(m,u,i)))}),k(c,"$grich_text",N(l)),c.$private(),k(c,"$eval_common_command",function(m){try{E("eval_return");var u=E("return");return m=this.$change_text(m),R(v(f("CommonCommand"),"COMMANDS"),"each",[],function $(n){var X,G=null==$.$$s?this:$.$$s;if(null==G.randomizer&&(G.randomizer=l),null==n&&(n=l),X=n.$eval(m,G,G.randomizer),!w(X))return l;u.$throw(X)},{$$s:this,$$ret:u}),l}catch($){if($===e.t_eval_return||$===u)return $.$v;throw $}}),k(c,"$dice_command",function(m){var t=this,u=l,i=l,$=l,n=l;return w(t.enabled_upcase_input)&&(m=m.$upcase()),u=t.$class().$prefixes_pattern().$match(m),w(u)?(i=u["$[]"](1)["$nil?"]()["$!"](),w(i)&&(m=m["$[]"](I(1,-1,!1))),$=t.$eval_game_system_specific_command(m),w($["$is_a?"](f("Result")))?($["$secret="](w(n=$["$secret?"]())?n:i),$):w($["$nil?"]())||w($["$empty?"]())||H($,"1")?l:R(f("Result").$new(),"tap",[],function(X){var U;return null==X&&(X=l),X["$text="]($.$to_s()),R(X,"secret=",U=[i]),U[U.length-1]})):l}),k(c,"$eval_game_system_specific_command",N(l)),k(c,"$result_ndx",function(m,t,u){return w(u["$is_a?"](f("String")))?l:w(m.$send(t,u))?f("Result").$success(this.$translate("success")):f("Result").$failure(this.$translate("failure"))}),k(c,"$result_1d100",N(l)),k(c,"$result_1d20",N(l)),k(c,"$result_nd10",N(l)),k(c,"$result_2d6",N(l)),k(c,"$result_nd6",N(l)),k(c,"$get_table_by_2d6",function(m){return this.$get_table_by_nD6(m,2)}),k(c,"$get_table_by_1d6",function(m){return this.$get_table_by_nD6(m,1)}),k(c,"$get_table_by_nD6",function(m,t){return this.$get_table_by_nDx(m,t,6)}),k(c,"$get_table_by_nDx",function(m,t,u){var $,n=l;return $=this.randomizer.$roll_sum(t,u),n=this.$get_table_value(m["$[]"](S($,t))),w(n["$nil?"]())?["1",0]:[n,$]}),k(c,"$get_table_by_1d3",function(m){var i,$,t=this,n=l;return t.$debug("get_table_by_1d3"),i=t.randomizer.$roll_sum(1,6),t.$debug("num",i),$=Y(S(i,1),2).$to_i(),t.$debug("index",$),n=m["$[]"]($),w(n["$nil?"]())?["1",0]:[n,i]}),k(c,"$get_table_by_d66_swap",function(m){var u;return u=this.randomizer.$roll_d66(v(f("D66SortType"),"ASC")),[this.$get_table_by_number(u,m),u]}),k(c,"$get_table_by_d66",function(m){var u,i,$,G,n=l;return u=this.randomizer.$roll_once(6),i=this.randomizer.$roll_once(6),$=q(K(S(u,1),6),S(i,1)),n=m["$[]"]($),G=""+u+i,w(n["$nil?"]())?["1",G]:[n,G]}),k(c,"$get_table_by_number",function(m,t,u){try{var i=E("return");return null==u&&(u="1"),R(t,"each",[],function n(G){var U,X=null==n.$$s?this:n.$$s;if(null==G&&(G=l),U=G["$[]"](0),!w(a(U,m)))return l;i.$throw(X.$get_table_value(G["$[]"](1)))},{$$s:this,$$ret:i}),this.$get_table_value(u)}catch(n){if(n===i)return n.$v;throw n}},-3),k(c,"$get_table_value",function(m){return w(m["$is_a?"](f("Proc")))?m.$call():m}),k(c,"$roll_tables",function(m,t){var i=l;return i=t["$[]"](m),w(i)?i.$roll(this.randomizer).$to_s():l}),k(c,"$debug",function(m,t){var i,$=this,n=l,G=l;return i=_(arguments,1),w($.debug)?(n=w(m["$is_a?"](f("String")))?m:m.$inspect(),w(i["$empty?"]())?$.$warn(n):(G=R(i,"map",[],function(U){return null==U&&(U=l),w(U["$is_a?"](f("String")))?'"'+U+'"':U.$inspect()}),$.$warn(n+": "+G.$join(", ")))):l},-2),v(v(r("I18n"),"Backend"),"Simple").$include(v(v(r("I18n"),"Backend"),"Fallbacks")),r("I18n").$load_path()["$<<"](r("Dir")["$[]"](r("File").$join("bcdice","../../i18n/**/*.yml"))),r("I18n")["$default_locale="]("ja_jp"),o=[["ja_jp"]],R(r("I18n").$fallbacks(),"defaults=",o),o[o.length-1]},Opal.modules["bcdice/game_system/MagicaLogia"]=function(e){var x,C,y,b,p,t,u,i,$,n,c,g,f,h,d,l,W=e.module,z=e.klass,_=e.const_set,q=e.send2,w=e.find_super,k=e.def,F=e.eqeq,R=e.truthy,E=e.rb_le,A=e.rb_ge,D=e.rb_plus,j=e.rb_minus,H=e.hash2,N=e.defs,I=e.send,S=e.to_ary,K=[],a=e.nil,o=e.$$$;return e.top.$require("bcdice/base"),x=K,C=l=[W(K[0],"BCDice")].concat(x),h=[W(l[0],"GameSystem")].concat(C),d=e.$r(h),y=h[0],b=d("Base"),p=h,g=[c=z(y,b,"MagicaLogia")].concat(p),f=e.$r(g),c.$$prototype.randomizer=a,_(g[0],"ID","MagicaLogia"),_(g[0],"NAME","\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"),_(g[0],"SORT_KEY","\u307e\u304d\u304b\u308d\u304d\u3042"),_(g[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\n\u30b9\u30da\u30b7\u30e3\u30eb\uff0f\u30d5\u30a1\u30f3\u30d6\u30eb\uff0f\u6210\u529f\uff0f\u5931\u6557\u3092\u5224\u5b9a\n\u30fb\u5404\u7a2e\u8868\n\u7d4c\u6b74\u8868\u3000BGT/\u521d\u671f\u30a2\u30f3\u30ab\u30fc\u8868\u3000DAT/\u904b\u547d\u5c5e\u6027\u8868\u3000FAT\n\u9858\u3044\u8868\u3000WIT/\u30d7\u30e9\u30a4\u30ba\u8868\u3000PT\n\u6642\u306e\u6d41\u308c\u8868\u3000TPT/\u5927\u5224\u6642\u306e\u6d41\u308c\u8868\u3000TPTB\n\u4e8b\u4ef6\u8868\u3000AT\n\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000FT\uff0f\u5909\u8abf\u8868\u3000WT\n\u904b\u547d\u5909\u8ee2\u8868\u3000FCT\n\u3000\u5178\u578b\u7684\u707d\u5384 TCT\uff0f\u7269\u7406\u7684\u707d\u5384 PCT\uff0f\u7cbe\u795e\u7684\u707d\u5384 MCT\uff0f\u72c2\u6c17\u7684\u707d\u5384 ICT\n\u3000\u793e\u4f1a\u7684\u707d\u5384 SCT\uff0f\u8d85\u5e38\u7684\u707d\u5384 XCT\uff0f\u4e0d\u601d\u8b70\u7cfb\u707d\u5384 WCT\uff0f\u30b3\u30df\u30ab\u30eb\u7cfb\u707d\u5384 CCT\n\u3000\u9b54\u6cd5\u4f7f\u3044\u306e\u707d\u5384 MGCT\n\u30b7\u30fc\u30f3\u8868\u3000ST\uff0f\u5927\u5224\u30b7\u30fc\u30f3\u8868\u3000STB\n\u3000\u6975\u9650\u74b0\u5883 XEST\uff0f\u5185\u9762\u4e16\u754c IWST\uff0f\u9b54\u6cd5\u90fd\u5e02 MCST\n\u3000\u6b7b\u5f8c\u4e16\u754c WDST\uff0f\u8ff7\u5bae\u4e16\u754c LWST\n\u3000\u9b54\u6cd5\u66f8\u67b6 MBST\uff0f\u9b54\u6cd5\u5b66\u9662 MAST\uff0f\u30af\u30ec\u30c9\u306e\u5854 TCST\n\u3000\u4e26\u884c\u4e16\u754c PWST\uff0f\u7d42\u672b\u3000\u3000 PAST\uff0f\u7570\u4e16\u754c\u9152\u5834 GBST\n\u3000\u307b\u3057\u304b\u3052 SLST\uff0f\u65e7\u56f3\u66f8\u9928 OLST\n\u4e16\u754c\u6cd5\u5247\u8ffd\u52a0\u8868 WLAT/\u3055\u307e\u3088\u3046\u602a\u7269\u8868 WMT\n\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868\u3000RCT\n\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868\u3000RTT\n\u3000\u661f\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTS, RTT1\n\u3000\u7363\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTB, RTT2\n\u3000\u529b\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTF, RTT3\n\u3000\u6b4c\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTP, RTT4\n\u3000\u5922\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTD, RTT5\n\u3000\u95c7\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868  RTN, RTT6\n\u30d6\u30e9\u30f3\u30af\u79d8\u5bc6\u8868\u3000BST/\n\u3000\u5bbf\u6575\u8868\u3000MIT/\u8b00\u7565\u8868\u3000MOT/\u56e0\u7e01\u8868\u3000MAT\n\u3000\u5947\u4eba\u8868\u3000MUT/\u529b\u5834\u8868\u3000MFT/\u540c\u76df\u8868\u3000MLT\n\u843d\u82b1\u8868\u3000FFT\n\u305d\u306e\u5f8c\u8868 FLT\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n"),k(c,"$initialize",function B(m){var u=this;return B.$$p=null,q(u,w(u,"initialize",B,!1,!0),"initialize",[m],null),u.sort_add_dice=!0,u.sort_barabara_dice=!0,u.d66_sort_type=o(f("D66SortType"),"ASC")}),k(c,"$result_2d6",function(m,t,u,i,$){var n=this,G=a;return F($,"?")||!F(i,">=")?a:((G=R(E(t,2))?f("Result").$fumble(n.$translate("fumble")):R(A(t,12))?f("Result").$critical(n.$translate("MagicaLogia.special")):R(A(m,$))?f("Result").$success(n.$translate("success")):f("Result").$failure(n.$translate("failure")))["$text="](D(G.$text(),n.$gain_magic_element(u["$[]"](0),u["$[]"](1)))),G)}),k(c,"$eval_game_system_specific_command",function(m){var u,t=this;return R(u=o(t.$class(),"SKILL_TABLE").$roll_command(t.randomizer,m))?u:t.$roll_tables(m,o(t.$class(),"TABLES"))}),c.$private(),k(c,"$gain_magic_element",function(m,t){var u=this,i=a;return F(m,t)?(i=u.$translate("MagicaLogia.elements.items")["$[]"](j(m,1)),D(" \uff1e ",u.$format(u.$translate("MagicaLogia.elements.format"),H(["text"],{text:i})))):""}),t=g,i=[u=z(g[0],null,"SkillExpandTable")].concat(t),$=e.$r(i),(n=u.$$prototype).times=n.sides=n.items=n.name=n.skill_table=a,N(u,"$from_i18n",function(X,U,Z){var te=a;return te=$("I18n").$t(X,H(["locale","raise"],{locale:U,raise:!1})),this.$new(te["$[]"]("name"),te["$[]"]("type"),te["$[]"]("items"),Z)}),k(u,"$initialize",function(X,U,Z,Q){var te=this,ne=a;return te.name=X,te.items=Z.$freeze(),te.skill_table=Q,ne=/(\d+)D(\d+)/i.$match(U),R(ne)||te.$raise($("ArgumentError"),"Unexpected table type: "+U),te.times=ne["$[]"](1).$to_i(),te.sides=ne["$[]"](2).$to_i()}),k(u,"$roll",function(X){var Z,Q,U=this;return Z=X.$roll_sum(U.times,U.sides),Q=U.$expand(U.items["$[]"](j(Z,U.times)),X),o($("DiceTable"),"RollResult").$new(U.name,Z,Q)}),u.$private(),k(u,"$expand",function(X,U){return I(X,"gsub",[/%{([a-z]+)}/],function Q(){var se,te=null==Q.$$s?this:Q.$$s;return se=$("Regexp").$last_match()["$[]"](1).$to_sym(),te.$roll_skill(se,U)},{$$s:this})}),_(i[0],"CATEGORIES",["star","beast","force","poem","dream","night"].$freeze()),k(u,"$roll_skill",function(X,U){var Z=this,Q=a;return F(X,"skill")?Z.skill_table.$roll_skill(U):F(X,"element")?Z.skill_table.$roll_category(U):(Q=$("CATEGORIES").$index(X),R(Q)||Z.$raise($("ArgumentError")),Z.skill_table.$categories()["$[]"](Q).$roll(U).$name())}),function(B,m,t){var u=z(B,null,"FallenAfterTable"),i=[u].concat(t),$=e.$r(i),n=u.$$prototype;n.lower=n.higher=n.name=a,N(u,"$from_i18n",function(X,U){var Q=a;return Q=$("I18n").$t(X,H(["locale","raise"],{locale:U,raise:!0})),this.$new(Q["$[]"]("name"),Q["$[]"]("items_lower"),Q["$[]"]("items_higher"))}),k(u,"$initialize",function(X,U,Z){var Q=this;return Q.name=X,Q.lower=U,Q.higher=Z}),k(u,"$roll",function(X){var U,Z,te,ne,Q=this,se=a;return Z=X.$roll_barabara(2,6),ne=null==(U=S(Z))[1]?a:U[1],se=R(E(te=null==U[0]?a:U[0],3))?Q.lower:Q.higher,Q.name+"("+te+","+ne+") \uff1e "+se["$[]"](j(ne,1))})}(g[0],0,g),function(B,m){var t=[B].concat(m),u=e.$r(t);B.$private(),k(B,"$translate_skill_table",function($){return o(u("DiceTable"),"SaiFicSkillTable").$from_i18n("MagicaLogia.skill_table",$,H(["rttn"],{rttn:["RTS","RTB","RTF","RTP","RTD","RTN"]}))}),k(B,"$translate_tables",function($,n){var G,X,U,Z,Q,te;return G=u("SkillExpandTable").$from_i18n("MagicaLogia.inveterate_enemy_table",$,n),X=o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.conspiracy_table",$),U=o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.fate_table",$),Z=o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.cueball_table",$),Q=o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.force_field_table",$),te=u("SkillExpandTable").$from_i18n("MagicaLogia.alliance_table",$,n),H(["TPT","ST","FT","WT","FCT","AT","BGT","DAT","FAT","WIT","TCT","PCT","MCT","ICT","SCT","XCT","WCT","CCT","MIT","MOT","MAT","MUT","MFT","MLT","BST","PT","XEST","IWST","MCST","WDST","LWST","STB","MGCT","MBST","MAST","TCST","PWST","PAST","GBST","SLST","WLAT","WMT","FFT","OLST","TPTB","FLT"],{TPT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPT",$,n),ST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.ST",$,n),FT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FT",$),WT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WT",$,n),FCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FCT",$),AT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.AT",$,n),BGT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.BGT",$),DAT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.DAT",$),FAT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FAT",$),WIT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WIT",$),TCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.TCT",$),PCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PCT",$),MCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MCT",$),ICT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.ICT",$),SCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.SCT",$),XCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.XCT",$),WCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WCT",$),CCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.CCT",$),MIT:G,MOT:X,MAT:U,MUT:Z,MFT:Q,MLT:te,BST:o(u("DiceTable"),"ChainTable").$new(u("I18n").$translate("MagicaLogia.tables.BST.name",H(["raise","locale"],{raise:!0,locale:$})),"1D6",[G,X,U,Z,Q,te]),PT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.PT",$),XEST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.XEST",$,n),IWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.IWST",$,n),MCST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MCST",$,n),WDST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WDST",$,n),LWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.LWST",$,n),STB:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.STB",$,n),MGCT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.MGCT",$),MBST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MBST",$,n),MAST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.MAST",$,n),TCST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TCST",$,n),PWST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.PWST",$,n),PAST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.PAST",$,n),GBST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.GBST",$,n),SLST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.SLST",$,n),WLAT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.WLAT",$),WMT:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.WMT",$,n),FFT:o(u("DiceTable"),"Table").$from_i18n("MagicaLogia.tables.FFT",$),OLST:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.OLST",$,n),TPTB:u("SkillExpandTable").$from_i18n("MagicaLogia.tables.TPTB",$,n),FLT:u("FallenAfterTable").$from_i18n("MagicaLogia.tables.FLT",$)})})}(e.get_singleton_class(c),g),_(g[0],"SKILL_TABLE",c.$translate_skill_table("ja_jp")),_(g[0],"TABLES",c.$translate_tables("ja_jp",f("SKILL_TABLE"))),c.$register_prefix(f("SKILL_TABLE").$prefixes()),c.$register_prefix(f("TABLES").$keys())},Opal.queue(function(e){var D,I,s,x,r,l,Y,K,H,W=e.module,z=e.klass,_=e.const_set,q=e.send2,w=e.find_super,k=e.def,R=[];return e.top.$require("bcdice/game_system/MagicaLogia"),D=R,I=H=[W(R[0],"BCDice")].concat(D),Y=[W(H[0],"GameSystem")].concat(I),K=e.$r(Y),s=Y,r=[x=z(Y[0],K("MagicaLogia"),"MagicaLogia_Korean")].concat(s),l=e.$r(r),_(r[0],"ID","MagicaLogia:Korean"),_(r[0],"NAME","\ub9c8\uae30\uce74\ub85c\uae30\uc544"),_(r[0],"SORT_KEY","\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544"),_(r[0],"HELP_MESSAGE","\u30fb\ud310\uc815\n\uc2a4\ud398\uc15c\uff0f\ud38c\ube14\uff0f\uc131\uacf5\uff0f\uc2e4\ud328\n\u30fb\uac01\uc885 \ud45c\n\uacbd\ub825 \ud45c BGT/ \ucd08\uae30 \uc575\ucee4 \ud45c DAT/ \uc6b4\uba85 \uc18d\uc131 \ud45c FAT\n\uc18c\uc6d0 \ud45c WIT/ \ud504\ub77c\uc774\uc988 \ud45c PT\n\uc2dc\uac04\uc758 \ud750\ub984 \ud45c(\uad6c\ud310) TPT/ \ub300\ud615\ud310 \uc2dc\uac04\uc758 \ud750\ub984 \ud45c TPTB\n\uc0ac\uac74 \ud45c AT\n\ud38c\ube14 \ud45c FT/ \uc0c1\ud0dc\uc774\uc0c1 \ud45c WT\n\uc6b4\uba85 \ubcc0\uc804 \ud45c FCT\n\u3000\uc804\ud615\uc801 \uc7ac\uc561 TCT\uff0f\ubb3c\ub9ac\uacc4 \uc7ac\uc561 PCT\uff0f\uc815\uc2e0\uacc4 \uc7ac\uc561 MCT\uff0f\uad11\uae30\uacc4 \uc7ac\uc561 ICT\n\u3000\uc0ac\ud68c\uacc4 \uc7ac\uc561 SCT\uff0f\ucd08\uc790\uc5f0\uacc4 \uc7ac\uc561 XCT\uff0f\ubd88\uac00\uc0ac\uc758\uacc4 \uc7ac\uc561 WCT\uff0f\ucf54\ubbf9\uacc4 \uc7ac\uc561 CCT\n\u3000\ub9c8\ubc95\uc0ac \uc7ac\uc561 MGCT\n\uc7a5\uba74\ud45c ST\uff0f\ub300\ud615\ud310 \uc7a5\uba74\ud45c STB\n\u3000\uadf9\ud55c \ud658\uacbd XEST\uff0f\ub0b4\uba74 \uc138\uacc4 IWST\uff0f\ub9c8\ubc95 \ub3c4\uc2dc MCST\n\u3000\uc0ac\ud6c4 \uc138\uacc4 WDST\uff0f\ubbf8\uad81 \uc138\uacc4 LWST\n\u3000\ub9c8\ubc95 \uc11c\uac00 MBST\uff0f\ub9c8\ubc95 \ud559\uc6d0 MAST\uff0f\ud06c\ub808\ub3c4\uc758 \ud0d1 TCST\n\u3000\ubcd1\ud589 \uc138\uacc4 PWST\uff0f\uc885\ub9d0 PAST\uff0f\uc774\uc138\uacc4 \uc220\uc9d1 GBST\n\u3000\ubcc4\ube5b SLST\uff0f\uad6c \ub3c4\uc11c\uad00 OLST\n\uc138\uacc4 \ubc95\uce59 \ucd94\uac00 \ud45c WLAT\uff0f\ub5a0\ub3cc\uc774 \uad34\ubb3c \ud45c WMT\n\ub79c\ub364 \ubd84\uc57c \ud45c RCT\n\ub79c\ub364 \ud2b9\uae30 \ud45c RTT\n\u3000\ubcc4 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTS, RTT1\n\u3000\uc9d0\uc2b9 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTB, RTT2\n\u3000\ud798 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTF, RTT3\n\u3000\ub178\ub798 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTP, RTT4\n\u3000\uafc8 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTD, RTT5\n\u3000\uc5b4\ub460 \ubd84\uc57c \ub79c\ub364 \ud2b9\uae30 \ud45c  RTN, RTT6\n\ubc31\uc9c0 \ube44\ubc00 \ud45c\u3000BST/\n\u3000\uc219\uc801\ud45c\u3000MIT/\ubaa8\ub7b5 \ud45c\u3000MOT/\uc778\uc5f0 \ud45c\u3000MAT\n\u3000\uae30\uc778\ud45c\u3000MUT/\uc5ed\uc7a5 \ud45c\u3000MFT/\ub3d9\ub9f9 \ud45c\u3000MLT\n\ub099\ud654 \ud45c\u3000FFT\n\uadf8 \ud6c4\uc758 \uc804\uac1c \ud45c FLT\n\u30fbD66 \ub2e4\uc774\uc2a4 \uc788\uc74c.\n"),x.$register_prefix_from_super_class(),k(x,"$initialize",function v(C){var h=this;return v.$$p=null,q(h,w(h,"initialize",v,!1,!0),"initialize",[C],null),h.locale="ko_kr"}),_(r[0],"SKILL_TABLE",x.$translate_skill_table("ko_kr")),_(r[0],"TABLES",x.$translate_tables("ko_kr",l("SKILL_TABLE")))})}}]);