(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7285],{87285:function(e,t,n){n(93683),Opal.modules["bcdice/dice_table/table"]=function(e){var t,n,l,a,r,i,$,s,T,o,S,u=[],c=e.nil,b=e.$$,f=e.module,_=e.klass,m=e.hash2,d=e.truthy;return t=u,n=S=[f(u[0],"BCDice")].concat(t),l=o=[f(S[0],"DiceTable")].concat(n),s=_(o[0],null,"Table"),T=[s].concat(l),s.$$prototype.times=s.$$prototype.sides=s.$$prototype.name=s.$$prototype.items=c,e.defs(s,"$from_i18n",a=function(e,t){var n=c;return n=b(T,"I18n").$t(e,m(["locale"],{locale:t})),this.$new(n["$[]"]("name"),n["$[]"]("type"),n["$[]"]("items"))},a.$$arity=2),e.def(s,"$initialize",r=function(e,t,n){var l=this,a=c;return l.name=e,l.items=n.$freeze(),a=/(\d+)D(\d+)/i.$match(t),d(a)||l.$raise(b(T,"ArgumentError"),"Unexpected table type: "+t),l.times=a["$[]"](1).$to_i(),l.sides=a["$[]"](2).$to_i()},r.$$arity=3),e.def(s,"$roll",i=function(e){var t,n=this;return t=e.$roll_sum(n.times,n.sides),n.$choice(t)},i.$$arity=1),void e.def(s,"$choice",$=function(e){var t,n=this;return t=function(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}(e,n.times),b(T,"RollResult").$new(n.name,e,n.items["$[]"](t))},$.$$arity=1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var n,l,a,r,i,$,s,T,o,S,u=[],c=e.nil,b=e.$$,f=e.module,_=e.klass,m=e.hash2;return n=u,l=S=[f(u[0],"BCDice")].concat(n),a=o=[f(S[0],"DiceTable")].concat(l),s=_(o[0],null,"D66GridTable"),T=[s].concat(a),s.$$prototype.name=s.$$prototype.items=c,e.defs(s,"$from_i18n",r=function(e,t){var n=c;return n=b(T,"I18n").$t(e,m(["locale","raise"],{locale:t,raise:!0})),this.$new(n["$[]"]("name"),n["$[]"]("items"))},r.$$arity=2),e.def(s,"$initialize",i=function(e,t){return this.name=e,this.items=t.$freeze()},i.$$arity=2),void e.def(s,"$roll",$=function(e){var n,l,a,r,i,$;return n=e.$roll_once(6),l=e.$roll_once(6),a=function(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}("number"==typeof($=n)?10*$:$["$*"](10),l),r=t(n,1),i=t(l,1),b(T,"RollResult").$new(this.name,a,this.items["$[]"](r)["$[]"](i))},$.$$arity=1)},function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}var l,a,r,i,$,s,T,o,S,u,c,b,f,_,m,d,h,p,y,g=e.top,D=[],B=e.nil,K=e.$$$,Y=e.$$,v=e.module,A=e.klass,E=e.send2,R=e.truthy,L=e.send,G=e.hash2,H=e.range;g.$require("bcdice/dice_table/table"),g.$require("bcdice/dice_table/d66_grid_table"),l=D,a=y=[v(D[0],"BCDice")].concat(l),r=p=[v(y[0],"GameSystem")].concat(a),d=A(p[0],Y(p,"Base"),"StellarKnights"),h=[d].concat(r),d.$$prototype.randomizer=B,e.const_set(h[0],"ID","StellarKnights"),e.const_set(h[0],"NAME","\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4"),e.const_set(h[0],"SORT_KEY","\u304d\u3093\u3051\u3093\u306e\u3059\u3066\u3089\u306a\u3044\u3064"),e.const_set(h[0],"HELP_MESSAGE","\u30fb\u30a2\u30bf\u30c3\u30af\u5224\u5b9a\u3000nSK[d][,k>l,...]\n[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\nn: \u30c0\u30a4\u30b9\u6570\u3001d: \u30a2\u30bf\u30c3\u30af\u5224\u5b9a\u306b\u304a\u3051\u308b\u5bfe\u8c61\u306e\u9632\u5fa1\u529b\u3001k, l: \u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304ck\u306a\u3089\u3070l\u306b\u5909\u66f4\uff08\u30a2\u30de\u30e9\u30f3\u30b5\u30b9\u306e\u30b9\u30ad\u30eb\u300c\u59cb\u307e\u308a\u306e\u90e8\u5c4b\u300d\u7528\uff09\nd\u7701\u7565\u6642\u306f\u30c0\u30a4\u30b9\u3092\u632f\u3063\u305f\u7d50\u679c\u306e\u307f\u8868\u793a\u3002\uff08nSK\u306fnB6\u3068\u540c\u3058\uff09\n\n4SK: \u30c0\u30a4\u30b9\u30924\u500b\u632f\u3063\u3066\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\n4+2SK: \u30c0\u30a4\u30b9\u30924+2 (=6) \u500b\u632f\u3063\u3066\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\n5/2SK: \u30c0\u30a4\u30b9\u30925\u500b\u306e\u534a\u5206 (=2) \u500b\u632f\u3063\u3066\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\n(5+3)/2SK: \u30c0\u30a4\u30b9\u3092(5+3)\u500b\u306e\u534a\u5206 (=4) \u500b\u632f\u3063\u3066\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\n5SK3: \u3010\u30a2\u30bf\u30c3\u30af\u5224\u5b9a\uff1a5\u30c0\u30a4\u30b9\u3011\u3001\u5bfe\u8c61\u306e\u9632\u5fa1\u529b\u30923\u3068\u3057\u3066\u6210\u529f\u6570\u3092\u8868\u793a\n3SK,1>6: \u30c0\u30a4\u30b9\u30923\u500b\u632f\u308a\u3001\u51fa\u76ee\u304c1\u306e\u30c0\u30a4\u30b9\u3092\u5168\u30666\u306b\u5909\u66f4\u3057\u3001\u305d\u306e\u7d50\u679c\u3092\u8868\u793a\n6SK4,1>6,2>6: \u3010\u30a2\u30bf\u30c3\u30af\u5224\u5b9a\uff1a6\u30c0\u30a4\u30b9\u3011\u3001\u51fa\u76ee\u304c1\u30682\u306e\u30c0\u30a4\u30b9\u3092\u5168\u30666\u306b\u5909\u66f4\u3001\u5bfe\u8c61\u306e\u9632\u5fa1\u529b\u30924\u3068\u3057\u3066\u6210\u529f\u6570\u3092\u8868\u793a\n\n\u30fb\u57fa\u672c\nTT\uff1a\u304a\u984c\u8868\nSTA    \uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868A\uff1a\u6642\u9593 (Situation Table A)\nSTB    \uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868B\uff1a\u5834\u6240 (ST B)\nSTB2[n]\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868B \u305d\u306e2\uff1a\u5b66\u5712\u7de8 (ST B 2)\n\u3000n: 1(\u30a2\u30fc\u30bb\u30eb\u30c8\u30ec\u30a4), 2(\u30a4\u30c7\u30a2\u30b0\u30ed\u30ea\u30a2), 3(\u30b7\u30c8\u30e9), 4(\u30d5\u30a3\u30ed\u30bd\u30d5\u30a3\u30a2), 5(\u8056\u30a2\u30fc\u30b8\u30a7\u30c6\u30a3\u30a2), 6(SoA)\nSTC    \uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868C\uff1a\u8a71\u984c (ST C)\nALLS   \uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868\u5168\u3066\u3092\u4e00\u62ec\u3067\uff08\u5b66\u5712\u7de8\u9664\u304f\uff09\nGAT\uff1a\u6240\u5c5e\u7d44\u7e54\u6c7a\u5b9a (Gakuen Table)\nHOT\uff1a\u5e0c\u671b\u8868 (Hope Table)\nDET\uff1a\u7d76\u671b\u8868 (Despair Table)\nWIT\uff1a\u9858\u3044\u4e8b\u8868 (Wish Table)\nYST\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868 (Your Story Table)\nYSTA\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868\uff1a\u7570\u4e16\u754c (YST Another World)\nPET\uff1a\u6027\u683c\u8868 (Personality Table)\n    \u6027\u683c\u8868\u30922\u56de\u632f\u308a\u3001\u6027\u683c\u3092\u6c7a\u5b9a\u3059\u308b\n\n\u30fb\u9727\u3068\u685c\u306e\u30de\u30eb\u30b8\u30ca\u30ea\u30a2\nYSTM\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868\uff1a\u30de\u30eb\u30b8\u30ca\u30ea\u30a2\u4e16\u754c (YST Marginalia)\nSTM\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868\uff1a\u30de\u30eb\u30b8\u30ca\u30ea\u30a2\u4e16\u754c (ST Marginalia)\nYSTL\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868\uff1a\u624b\u7d19\u4e16\u754c (YST Letter)\nYSTR\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868\uff1a\u30ea\u30b3\u30ec\u30af\u30c8\u30fb\u30c9\u30fc\u30eb (YST Recollect-doll)\nSTBR\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868B\uff1a\u5834\u6240\uff08\u30ea\u30b3\u30ec\u30af\u30c8\u30fb\u30c9\u30fc\u30eb\uff09 (ST B Recollect-doll)\nSTCR\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868C\uff1a\u30ea\u30b3\u30ec\u30af\u30c8 (ST C Recollect)\nSTBS\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868B\uff1a\u30b7\u30c8\u30e9\u30bb\u30c3\u30c6\u30a3\u30f3\u30b0 (ST B Sut Tu Real)\nSTE\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868\uff1a\u30a8\u30af\u30ea\u30d7\u30b9\u5c02\u7528 (ST Eclipse)\n\n\u30fb\u7d2b\u5f3e\u306e\u30aa\u30eb\u30c8\u30ea\u30f4\u30fc\u30c8\nFT\uff1a\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u8868 (Fragment Table)\n    \u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u8868\u3092\uff15\u56de\u632f\u308b\nFTx\uff1a\u30d5\u30e9\u30b0\u30e1\u30f3\u30c8\u8868\u3092x\u56de\u632f\u308b\nYSTB\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868\uff1a\u30d6\u30ea\u30f3\u30ac\u30fc (YST Bringer)\nYSTF\uff1a\u3042\u306a\u305f\u306e\u7269\u8a9e\u8868\uff1a\u30d5\u30a9\u30fc\u30b8 (YST Forge)\nSTAL\uff1a\u30b7\u30c1\u30e5\u30a8\u30fc\u30b7\u30e7\u30f3\u8868\uff1a\u30aa\u30eb\u30c8\u30ea\u30f4\u30fc\u30c8 (ST Alt-Levoot)\n"),e.def(d,"$initialize",i=function(t){var n=this;return i.$$p&&(i.$$p=null),E(n,e.find_super_dispatcher(n,"initialize",i,!1,!0),"initialize",[t],null),n.sort_barabara_dice=!0,n.d66_sort_type=K(Y(h,"D66SortType"),"NO_SORT")},i.$$arity=1),e.def(d,"$eval_game_system_specific_command",$=function(e){var t=this,n=B,l=B,a=B,r=B,i=B,$=B;return e=e.$upcase(),R(n=K(t.$class(),"TABLES")["$[]"](e))?n.$roll(t.randomizer):R(l=/([()+\/\d]+)SK(\d)?((,\d>\d)+)?/.$match(e))?(a=Y(h,"Arithmetic").$eval(l["$[]"](1),K(Y(h,"RoundType"),"FLOOR")),R(a["$nil?"]())?B:t.$resolute_action(a,R(r=l["$[]"](2))?l["$[]"](2).$to_i():r,l["$[]"](3))):e["$=="]("STB2")?t.$roll_all_situation_b2_tables():e["$=="]("ALLS")?t.$roll_all_situation_tables():e["$=="]("PET")?t.$roll_personality_table():R(l=/FT(\d+)?/.$match(e))?(i=(R($=l["$[]"](1))?$:5).$to_i(),t.$roll_fragment_table(i)):B},$.$$arity=1),d.$private(),e.def(d,"$resolute_action",s=function(l,a,r){var i,$,s,T,o,S=this,u=B,c=B,b=B,f=B,_=B,m=B;return T=(u=S.randomizer.$roll_barabara(l,6).$sort()).$join(","),c="("+S.$remake_command(l,a,r)+") \uff1e "+T,R(u["$empty?"]())?t(c,S.$translate("StellarKnights.SK.no_dice_error")):(b=S.$parse_dice_change_rules(r),L(b,"each",[],((i=function(e){var t;return null==e&&(e=B),L(u,"map!",[],((t=function(t){return null==t&&(t=B),t["$=="](e["$[]"]("from"))?e["$[]"]("to"):t}).$$s=null==i.$$s?this:i.$$s,t.$$arity=1,t))}).$$s=S,i.$$arity=1,i)),R(b["$empty?"]())||(u["$sort!"](),c=t(c," \uff1e ["+u.$join(",")+"]")),R(a["$nil?"]())?(f=!1,_=!1):(m=L(u,"count",[],(($=function(e){return null==e&&(e=B),function(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}(e,a)}).$$s=S,$.$$arity=1,$)),c=t(c,t(" \uff1e ",S.$translate("StellarKnights.SK.success_num",G(["success_num"],{success_num:m})))),f="number"==typeof(o=m)?o>0:o["$>"](0),_=f["$!"]()),L(Y(h,"Result").$new(c),"tap",[],((s=function(t){var l=B;return null==t&&(t=B),L(t,"success=",e.to_a(l=[f])),n(l.length,1),L(t,"failure=",e.to_a(l=[_])),l[n(l.length,1)]}).$$s=S,s.$$arity=1,s)))},s.$$arity=3),e.def(d,"$remake_command",T=function(e,n,l){var a=B;return a=e+"SK",R(n["$nil?"]())||(a=t(a,n.$to_s())),R(l["$nil?"]())||(a=t(a,l)),a},T.$$arity=3),e.def(d,"$parse_dice_change_rules",o=function(e){var t;return R(e["$nil?"]())?[]:(e=e["$[]"](H(1,-1,!1)),L(e.$split(","),"map",[],((t=function(e){var t=B;return null==e&&(e=B),t=L(e.$split(">"),"map",[],"to_i".$to_proc()),G(["from","to"],{from:t["$[]"](0),to:t["$[]"](1)})}).$$s=this,t.$$arity=1,t)))},o.$$arity=1),e.def(d,"$roll_all_situation_b2_tables",S=function(){var e;return L(H(1,6,!1),"map",[],(e=function(t){var n=null==e.$$s?this:e.$$s;return null==n.randomizer&&(n.randomizer=B),null==t&&(t=B),K(n.$class(),"TABLES")["$[]"]("STB2"+t).$roll(n.randomizer)},e.$$s=this,e.$$arity=1,e)).$join("\n")},S.$$arity=0),e.def(d,"$roll_all_situation_tables",u=function(){var e;return L(["STA","STB","STC"],"map",[],(e=function(t){var n=null==e.$$s?this:e.$$s;return null==n.randomizer&&(n.randomizer=B),null==t&&(t=B),K(n.$class(),"TABLES")["$[]"](t).$roll(n.randomizer)},e.$$s=this,e.$$arity=1,e)).$join("\n")},u.$$arity=0),e.def(d,"$roll_personality_table",c=function(){var t,n,l,a,r,i,$=this;return n=$.$get_table_by_d66($.$translate("StellarKnights.PET.items")),l=null==(t=e.to_ary(n))[0]?B:t[0],a=null==t[1]?B:t[1],n=$.$get_table_by_d66($.$translate("StellarKnights.PET.items")),r=null==(t=e.to_ary(n))[0]?B:t[0],i=null==t[1]?B:t[1],$.$translate("StellarKnights.PET.name")+"("+a+","+i+") \uff1e "+$.$translate("StellarKnights.PET.result",G(["value1","value2"],{value1:l,value2:r}))},c.$$arity=0),e.def(d,"$roll_fragment_table",b=function(e){var t,n,l,a,r=this,i=B,$=B,s=B;return R("number"==typeof(a=e)?a<=0:a["$<="](0))?B:(i=L(Y(h,"Array"),"new",[e],((t=function(){var e=null==t.$$s?this:t.$$s;return e.$get_table_by_d66(e.$translate("StellarKnights.FT.items"))}).$$s=r,t.$$arity=0,t)),$=L(i,"map",[],((n=function(e){return null==e&&(e=B),e["$[]"](0)}).$$s=r,n.$$arity=1,n)),s=L(i,"map",[],((l=function(e){return null==e&&(e=B),e["$[]"](1)}).$$s=r,l.$$arity=1,l)),r.$translate("StellarKnights.FT.name")+"("+s.$join(",")+") \uff1e "+$.$join(r.$translate("StellarKnights.FT.sep")))},b.$$arity=1),f=e.get_singleton_class(d),m=[f].concat(h),f.$private(),e.def(f,"$translate_tables",_=function(e){return G(["TT","STA","STB","STB21","STB22","STB23","STB24","STB25","STB26","STC","GAT","HOT","DET","WIT","YST","YSTA","YSTM","STM","YSTL","YSTR","STBR","STCR","STBS","STE","YSTB","YSTF","STAL"],{TT:K(Y(m,"DiceTable"),"D66GridTable").$from_i18n("StellarKnights.tables.TT",e),STA:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STA",e),STB:K(Y(m,"DiceTable"),"D66OneThirdTable").$from_i18n("StellarKnights.tables.STB",e),STB21:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STB21",e),STB22:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STB22",e),STB23:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STB23",e),STB24:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STB24",e),STB25:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STB25",e),STB26:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.STB26",e),STC:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STC",e),GAT:K(Y(m,"DiceTable"),"Table").$from_i18n("StellarKnights.tables.GAT",e),HOT:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.HOT",e),DET:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.DET",e),WIT:K(Y(m,"DiceTable"),"D66OneThirdTable").$from_i18n("StellarKnights.tables.WIT",e),YST:K(Y(m,"DiceTable"),"D66OneThirdTable").$from_i18n("StellarKnights.tables.YST",e),YSTA:K(Y(m,"DiceTable"),"D66OneThirdTable").$from_i18n("StellarKnights.tables.YSTA",e),YSTM:K(Y(m,"DiceTable"),"D66OneThirdTable").$from_i18n("StellarKnights.tables.YSTM",e),STM:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STM",e),YSTL:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.YSTL",e),YSTR:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.YSTR",e),STBR:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STBR",e),STCR:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STCR",e),STBS:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STBS",e),STE:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STE",e),YSTB:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.YSTB",e),YSTF:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.YSTF",e),STAL:K(Y(m,"DiceTable"),"D66HalfGridTable").$from_i18n("StellarKnights.tables.STAL",e)})},_.$$arity=1),e.const_set(h[0],"TABLES",d.$translate_tables("ja_jp")),d.$register_prefix("[()+\\/\\d]+SK","STB2","ALLS","PET","FT",Y(h,"TABLES").$keys())}(Opal)}}]);