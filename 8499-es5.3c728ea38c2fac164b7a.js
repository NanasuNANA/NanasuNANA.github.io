(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8499],{18499:function(t,e,r){r(93683),Opal.modules["bcdice/game_system/Torg"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var u,$,i,_,a,g,s,c,l,f,d,m,T,b,y,O,h,p,K,v,x,R,E=[],D=t.nil,A=t.$$,M=t.module,k=t.klass,B=t.send,G=t.truthy;return u=E,$=R=[M(E[0],"BCDice")].concat(u),i=x=[M(R[0],"GameSystem")].concat($),K=k(x[0],A(x,"Base"),"Torg"),v=[K].concat(i),K.$$prototype.randomizer=D,t.const_set(v[0],"ID","Torg"),t.const_set(v[0],"NAME","\u30c8\u30fc\u30b0"),t.const_set(v[0],"SORT_KEY","\u3068\u304a\u304f"),t.const_set(v[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u3000(TGm)\n\u3000TORG\u5c02\u7528\u306e\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\n\u3000"TG(\u6280\u80fd\u57fa\u672c\u5024)"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u5404\u7a2e\u8868\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u4e00\u822c\u7d50\u679c\u8868 \u6210\u529f\u5ea6\u51fa\u529b\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u5a01\u5727/\u5a01\u5687 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cITx or INTIMIDATEx or TESTx\u300d\n\u3000\u30fb\u6311\u767a/\u30c8\u30ea\u30c3\u30af \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cTTx or TAUNTx or TRICKx or CTx\u300d\n\u3000\u30fb\u9593\u5408\u3044 \u5bfe\u4eba\u884c\u70ba\u7d50\u679c\u8868\u300cMTx or MANEUVERx\u300d\n\u3000\u30fb\u30aa\u30fc\u30ba\uff08\u4e00\u822c\u4eba\uff09\u30c0\u30e1\u30fc\u30b8\u3000\u300cODTx or ORDSx or ODAMAGEx\u300d\n\u3000\u30fb\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u30fc\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),K.$register_prefix("TG","1R20","RT","Result","IT","Intimidate","Test","TT","Taunt","Trick","CT","MT","Maneuver","ODT","ords","odamage","DT","damage","BT","bonus","total"),t.def(K,"$replace_text",_=function(t){var e;return t=(t=(t=(t=(t=(t=(t=t.$gsub(/Result/i,"RT")).$gsub(/(Intimidate|Test)/i,"IT")).$gsub(/(Taunt|Trick|CT)/i,"TT")).$gsub(/Maneuver/i,"MT")).$gsub(/(ords|odamage)/i,"ODT")).$gsub(/damage/i,"DT")).$gsub(/(bonus|total)/i,"BT"),(t=B(t,"gsub",[/TG(\d+)/i],((e=function(){return"1R20+"+A(v,"Regexp").$last_match(1)}).$$s=this,e.$$arity=0,e))).$gsub(/TG/i,"1R20")},_.$$arity=1),t.def(K,"$torg_check",a=function(n){var o,u,$=this,i=D,_=D,a=D,g=D,s=D,c=D;return G(/(^|\s)S?(1R20([+-]\d+)*)(\s|$)/i["$=~"](n))?(n=A(v,"Regexp").$last_match(2),i=A(v,"Regexp").$last_match(3),$.$debug(i),G(i)&&(i=A(v,"ArithmeticEvaluator").$eval(i)),$.$debug(i),i=i.$to_i(),u=$.$torg_dice(),a=null==(o=t.to_ary(u))[1]?D:o[1],g=null==o[2]?D:o[2],s=$.$get_torg_bonus(_=null==o[0]?D:o[0]),c=r(c=G(i)?G(e(i,0))?s+"["+g+"]+"+i:s+"["+g+"]"+i:s+"["+g+"]",r(" \uff1e ",r(s,i).$to_s())),G(_["$!="](a))&&(c=r(c,r(r("(\u6280\u80fd\u7121",r($.$get_torg_bonus(a),i).$to_s()),")"))),c="("+n+") \uff1e "+c):D},a.$$arity=1),t.def(K,"$torg_dice",g=function(){var t=D,e=D,n=D,o=D,u=D,$=D;for(t=!0,e=!0,n=0,o=0,u="";G(t);)n=r(n,$=this.randomizer.$roll_once(20)),G(e)&&(o=r(o,$)),G(u["$empty?"]())||(u=r(u,",")),u=r(u,$.$to_s()),$["$=="](20)?e=!1:G($["$!="](10))&&(t=!1,e=!1);return[n,o,u]},g.$$arity=0),t.def(K,"$eval_game_system_specific_command",s=function(e){var r,n,o,u=this,$=D,i=D,_=D,a=D,g=D,s=D,c=D;return $=e.$upcase(),$=u.$replace_text($),G(o=u.$torg_check($))?o:(i="1",_="",a=0,G(/([RITMDB]T)(\d+([+\-]\d+)*)/i["$=~"]($))?(g=A(v,"Regexp").$last_match(1),s=A(v,"Regexp").$last_match(2),"RT"["$==="](c=g)?(a=A(v,"ArithmeticEvaluator").$eval(s),i=u.$get_torg_success_level(a),_="\u4e00\u822c\u7d50\u679c"):"IT"["$==="](c)?(a=A(v,"ArithmeticEvaluator").$eval(s),i=u.$get_torg_interaction_result_intimidate_test(a),_="\u5a01\u5727/\u5a01\u5687"):"TT"["$==="](c)?(a=A(v,"ArithmeticEvaluator").$eval(s),i=u.$get_torg_interaction_result_taunt_trick(a),_="\u6311\u767a/\u30c8\u30ea\u30c3\u30af"):"MT"["$==="](c)?(a=A(v,"ArithmeticEvaluator").$eval(s),i=u.$get_torg_interaction_result_maneuver(a),_="\u9593\u5408\u3044"):"DT"["$==="](c)?(a=A(v,"ArithmeticEvaluator").$eval(s),G($["$=~"](/ODT/i))?(i=u.$get_torg_damage_ords(a),_="\u30aa\u30fc\u30ba\u30c0\u30e1\u30fc\u30b8"):(i=u.$get_torg_damage_posibility(a),_="\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u80fd\u529b\u8005\u30c0\u30e1\u30fc\u30b8")):"BT"["$==="](c)&&(n=u.$get_torg_bonus_text(s),i=null==(r=t.to_ary(n))[0]?D:r[0],a=null==r[1]?D:r[1],_="\u30dc\u30fc\u30ca\u30b9"),G(_["$!="](""))&&(i=_+"\u8868["+a+"] \uff1e "+i),i):D)},s.$$arity=1),t.def(K,"$get_torg_success_level",c=function(t){return this.$get_torg_table_result(t,[[0,"\u304e\u308a\u304e\u308a"],[1,"\u3075\u3064\u3046"],[3,"\u307e\u3042\u3088\u3044"],[7,"\u304b\u306a\u308a\u3088\u3044"],[12,"\u3059\u3054\u3044"]])},c.$$arity=1),t.def(K,"$get_torg_interaction_result_intimidate_test",l=function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u30e2\u30e9\u30eb\u5d29\u58ca"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},l.$$arity=1),t.def(K,"$get_torg_interaction_result_taunt_trick",f=function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u840e\u7e2e"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u9ad8\u63da\uff0f\u9006\u8ee2\u8ca0\u3051"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},f.$$arity=1),t.def(K,"$get_torg_interaction_result_maneuver",d=function(t){return this.$get_torg_table_result(t,[[0,"\u6280\u80fd\u306a\u3057"],[5,"\u75b2\u52b4"],[10,"\u840e\u7e2e\uff0f\u75b2\u52b4"],[15,"\u9006\u8ee2\u8ca0\u3051\uff0f\u75b2\u52b4"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},d.$$arity=1),t.def(K,"$get_torg_table_result",m=function(r,n){var o,u=this,$=D;return $="1",function(){var i=t.new_brk();try{B(n,"each",[],((o=function(n){var o;return null==n&&(n=D),o=n["$[]"](0),G(e(o,r))&&t.brk(D,i),$=n["$[]"](1)}).$$s=u,o.$$brk=i,o.$$arity=1,o))}catch(_){if(_===i)return _.$v;throw _}}(),$},m.$$arity=2),t.def(K,"$get_torg_damage_ords",T=function(t){return this.$get_torg_damage(t,4,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15",[[0,"1"],[1,"O1"],[2,"K1"],[3,"O2"],[4,"O3"],[5,"K3"],[6,"\u8ee2\u5012 K\uff0fO4"],[7,"\u8ee2\u5012 K\uff0fO5"],[8,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO7"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO9"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO10"],[11,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO11"],[12,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO12"],[13,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO13"],[14,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO14"],[15,"4\u30ec\u30d9\u30eb\u8ca0\u50b7  KO15"]])},T.$$arity=1),t.def(K,"$get_torg_damage_posibility",b=function(t){return this.$get_torg_damage(t,3,"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5",[[0,"1"],[1,"1"],[2,"O1"],[3,"K2"],[4,"2"],[5,"O2"],[6,"\u8ee2\u5012 O2"],[7,"\u8ee2\u5012 K2"],[8,"\u8ee2\u5012 K2"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K3"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K4"],[11,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[12,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K5"],[13,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  O4"],[14,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"]])},b.$$arity=1),t.def(K,"$get_torg_damage",y=function(t,e,u,$){var i,_=D;return G("number"==typeof(i=t)?i<0:i["$<"](0))?"1":(_=n($.$length(),1),G(function(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}(t,_))?this.$get_torg_table_result(t,$):r(r("",r(o(n(t,_),2).$to_i(),e).$to_s()),u))},y.$$arity=4),t.def(K,"$get_torg_bonus_text",O=function(t){var e=this,r=D,n=D,o=D,u=D,$=D;return n=(r=t.$split(/\+/)).$shift().$to_i(),o=A(v,"ArithmeticEvaluator").$eval(r.$join("+")),u=e.$get_torg_bonus(n),e.$debug("TORG BT resultValue",u),e.$debug("TORG BT mod",o),o["$=="](0)?$=u.$to_s():($=e.$getTorgBonusOutputTextWhenModDefined(n,u,o),n=n+"+"+o),[$,n]},O.$$arity=1),t.def(K,"$getTorgBonusOutputTextWhenModDefined",h=function(t,n,o){var u=this;return u.$debug("getTorgBonusOutputTextWhenModDefined value, mod",t,o),G(e(o,0))?n+"["+t+"]+"+o+" \uff1e "+r(n,o):(u.$debug("resultValue",n),u.$debug("mod",o),n+"["+t+"]"+o+" \uff1e "+r(n,o))},h.$$arity=3),void t.def(K,"$get_torg_bonus",p=function(t){var u=D,$=D;return u=this.$get_torg_table_result(t,[[1,-12],[2,-10],[3,-8],[5,-5],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),G(e(t,20))&&($=r(o(n(t,21),5).$to_i(),1),u=r(u,$)),u},p.$$arity=1)},function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}var o,u,$,i,_,a,g,s,c,l,f,d,m,T,b=[],y=t.nil,O=t.$$,h=t.module,p=t.klass,K=t.truthy;t.top.$require("bcdice/game_system/Torg"),o=b,u=T=[h(b[0],"BCDice")].concat(o),$=m=[h(T[0],"GameSystem")].concat(u),d=[f=p(m[0],O(m,"Torg"),"Torg1_5")].concat($),t.const_set(d[0],"ID","Torg1.5"),t.const_set(d[0],"NAME","\u30c8\u30fc\u30b01.5\u7248"),t.const_set(d[0],"SORT_KEY","\u3068\u304a\u304f1.5"),f.$register_prefix(O(d,"Torg").$prefixes()),t.def(f,"$get_torg_success_level",i=function(t){return this.$get_torg_table_result(t,[[0,"\u304e\u308a\u304e\u308a"],[1,"\u3075\u3064\u3046"],[3,"\u307e\u3042\u3088\u3044"],[7,"\u304b\u306a\u308a\u3088\u3044"],[12,"\u3059\u3054\u3044"]])},i.$$arity=1),t.def(f,"$get_torg_interaction_result_intimidate_test",_=function(t){return this.$get_torg_table_result(t,[[0,"\u840e\u7e2e"],[5,"\u6280\u80fd\u306a\u3057"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u30e2\u30e9\u30eb\u5d29\u58ca"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},_.$$arity=1),t.def(f,"$get_torg_interaction_result_taunt_trick",a=function(t){return this.$get_torg_table_result(t,[[0,"\u840e\u7e2e"],[5,"\u6280\u80fd\u306a\u3057"],[10,"\u9006\u8ee2\u8ca0\u3051"],[15,"\u9ad8\u63da\uff0f\u9006\u8ee2\u8ca0\u3051"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},a.$$arity=1),t.def(f,"$get_torg_interaction_result_maneuver",g=function(t){return this.$get_torg_table_result(t,[[0,"\u75b2\u52b4"],[5,"\u840e\u7e2e"],[10,"\u6280\u80fd\u306a\u3057"],[15,"\u9006\u8ee2\u8ca0\u3051\uff0f\u75b2\u52b4"],[17,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30ba\u30b3\u30fc\u30eb"]])},g.$$arity=1),t.def(f,"$get_torg_damage_ords",s=function(t){return this.$get_torg_damage(t,4,8,[[0,"1"],[1,"O1"],[2,"K1"],[3,"O2"],[4,"K2"],[5,"\u8ee2\u5012 O3"],[6,"\u8ee2\u5012 K3"],[7,"\u8ee2\u5012 K\uff0fO4"],[8,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  KO4"],[9,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO5"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[11,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO6"],[12,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO6"],[13,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO7"],[14,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO7"],[15,"4\u30ec\u30d9\u30eb\u8ca0\u50b7  KO8"]])},s.$$arity=1),t.def(f,"$get_torg_damage_posibility",c=function(t){return this.$get_torg_damage(t,3,5,[[0,"1"],[1,"1"],[2,"O1"],[3,"K1"],[4,"2"],[5,"O2"],[6,"\u8ee2\u5012 K2"],[7,"\u8ee2\u5012 O3"],[8,"\u8ee2\u5012 K3"],[9,"\u8ee2\u5012 K\uff0fO3"],[10,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO4"],[11,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO4"],[12,"1\u30ec\u30d9\u30eb\u8ca0\u50b7  KO4"],[13,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  K\uff0fO5"],[14,"2\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7  KO5"]])},c.$$arity=1),t.def(f,"$get_torg_damage",l=function(t,o,u,$){var i,_=y,a=y;return K("number"==typeof(i=t)?i<0:i["$<"](0))?"1":(_=e($.$length(),1),K(function(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}(t,_))?this.$get_torg_table_result(t,$):r(o,n(a=function(t,e){return"number"==typeof t?t/2:t["$/"](2)}(e(t,_)).$to_i(),1))+"\u30ec\u30d9\u30eb\u8ca0\u50b7  KO"+r(u,n(a,1)))},l.$$arity=4)}(Opal)}}]);