(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[727],{10727:function(t,e,n){n(93683),function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function o(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var i,u,a,l,d,_,s,g,c,m,y,f,b,h,R,T,v,D,p,E,C,S,B,x,P=[],k=t.nil,A=t.$$,G=t.module,O=t.klass,U=t.truthy,M=t.send;i=P,u=x=[G(P[0],"BCDice")].concat(i),a=B=[G(x[0],"GameSystem")].concat(u),C=O(B[0],A(B,"Base"),"TorgEternity"),S=[C].concat(a),C.$$prototype.randomizer=k,t.const_set(S[0],"ID","TorgEternity"),t.const_set(S[0],"NAME","\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3"),t.const_set(S[0],"SORT_KEY","\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044"),t.const_set(S[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\n\u3000\u30fbTG\n\u3000\u3000"TG[m]"\u30671d20\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\n\u3000\u3000m\u306f\u6280\u80fd\u57fa\u672c\u5024\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002R\u30b3\u30de\u30f3\u30c9\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000(TORG\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u3058\u6319\u52d5\u3092\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3067\u3059\u3002\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u306e\u8aad\u307f\u66ff\u3048\u306e\u307f\u3001Eternity\u7248\u3068\u306a\u308a\u307e\u3059)\n\u3000\u30fbTE\n\u3000\u3000"TE"\u30671d20\u3092\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3000\u3000\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000\u51fa\u76ee1\u306e\u6642\u306b\u306f\u300cMishap!\u3000\u81ea\u52d5\u5931\u6557\uff01\u300d\u3068\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\n\u3000\u30fbUP\n\u3000\u3000"UP"\u3067\u9ad8\u63da\u72b6\u614b\u306e\u30ed\u30fc\u30eb(\u901a\u5e38\u306e1d20\u306b\u52a0\u3048\u30011d20\u3092\u8ffd\u52a0\u3067\u632f\u308a\u8db3\u3057)\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u5404\u30ed\u30fc\u30eb\u3067\u306e\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u3000\u3000\u4e00\u6295\u76ee\u3067\u51fa\u76ee1\u306e\u6642\u306b\u306f\u300cMishap!\u3000\u81ea\u52d5\u5931\u6557\uff01\u300d\u3068\u51fa\u529b\u3055\u308c\u3001\u4e8c\u6295\u76ee\u306f\u884c\u308f\u308c\u307e\u305b\u3093\u3002\n\u3000\u30fbPOS\n\u3000\u3000"POSm"\u3067\u3001\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u4f7f\u7528\u306b\u3088\u308b1d20\u306e\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000m\u306f\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\u3092\u4f7f\u7528\u3059\u308b\u524d\u306e\u30ed\u30fc\u30eb\u7d50\u679c\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000\u3000\u51fa\u76ee\u304c10\u672a\u6e80\u306e\u5834\u5408\u306f\u300110\u3078\u306e\u8aad\u307f\u66ff\u3048\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\u3000\u3000\u307e\u305f\u3001\u632f\u308a\u8db3\u3057\u3092\u81ea\u52d5\u3067\u884c\u3044\u300120\u306e\u51fa\u76ee\u304c\u51fa\u305f\u3068\u304d\u306b\u306f\u6280\u80fd\u7121\u3057\u5024\u3082\u4e26\u8a18\u3057\u307e\u3059\u3002\n\u30fb\u30dc\u30fc\u30ca\u30b9\u30c0\u30e1\u30fc\u30b8\u30ed\u30fc\u30eb\n\u3000"xBD[+y]"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002[]\u5185\u306f\u7701\u7565\u53ef\u80fd\u3002\n\u3000x\u306f\u30c0\u30e1\u30fc\u30b8\u30c0\u30a4\u30b9\u6570\u3002y\u306f\u30c0\u30e1\u30fc\u30b8\u57fa\u672c\u5024 or \u5f0f\u3092\u5165\u308c\u3066\u4e0b\u3055\u3044\u3002\n\u3000x\u306f1\u4ee5\u4e0a\u304c\u5fc5\u8981\u3067\u3059\u30020\u3060\u3068\u30a8\u30e9\u30fc\u304c\u51fa\u529b\u3055\u308c\u307e\u3059\u3002\u30de\u30a4\u30ca\u30b9\u5024\u306f\u30b3\u30de\u30f3\u30c9\u3068\u3057\u3066\u8a8d\u8b58\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u632f\u308a\u8db3\u3057\u51e6\u7406\u306f\u81ea\u52d5\u3067\u884c\u308f\u308c\u307e\u3059\u3002(\u632f\u308a\u8db3\u3057\u767a\u751f\u6642\u306e\u76ee\u306f\u3001\u300c5\u221e\u300d\u3068\u51fa\u529b\u3055\u308c\u307e\u3059)\n\u30fb\u5404\u7a2e\u8868\n\u3000"(\u8868\u30b3\u30de\u30f3\u30c9)(\u6570\u5024)"\u3067\u632f\u308a\u307e\u3059\u3002\n\u3000\u30fb\u6210\u529f\u30ec\u30d9\u30eb\u8868\u300cRTx or RESULTx\u300d\n\u3000\u30fb\u30c0\u30e1\u30fc\u30b8\u7d50\u679c\u8868\u300cDTx or DAMAGEx\u300d\n\u3000\u30fb\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868\u300cBTx+y or BONUSx+y or TOTALx+y\u300d x\u306f\u6570\u5024, y\u306f\u6280\u80fd\u57fa\u672c\u5024\n'),C.$register_prefix("TE","UP","POS","\\d+BD","TG","RT","Result","DT","damage","BT","bonus","total","1R20"),t.def(C,"$eval_game_system_specific_command",l=function(t){var e,n,r,o,$,i,u,a=this;return U(e=U(n=U(r=U(o=U($=U(i=U(u=a.$torg_check(t))?u:a.$getRolld20DiceCommandResult(t))?i:a.$getUpRollDiceCommandResult(t))?$:a.$getPossibilityRollDiceCommandResult(t))?o:a.$getBonusDamageDiceCommandResult(t))?r:a.$getSuccessLevelDiceCommandResult(t))?n:a.$getDamageResultDiceCommandResult(t))?e:a.$getRollBonusDiceCommandResult(t)},l.$$arity=1),t.def(C,"$replace_text",d=function(t){var e;return(t=M(t,"gsub",[/TG(\d+)/i],((e=function(){return"1R20+"+A(S,"Regexp").$last_match(1)}).$$s=this,e.$$arity=0,e))).$gsub(/TG/i,"1R20")},d.$$arity=1),t.def(C,"$torg_check",_=function(r){var o,$,i=this,u=k,a=k,l=k,d=k,_=k,s=k,g=k;return r=i.$replace_text(r),u=/(^|\s)S?(1R20(([+-]\d+)*))(\s|$)/i.$match(r),U(u)?(r=u["$[]"](2),a=u["$[]"](3),i.$debug(a),U(a)&&(a=A(S,"ArithmeticEvaluator").$eval(a)),i.$debug(a),a=a.$to_i(),$=i.$torg_eternity_dice(!1,!1),d=null==(o=t.to_ary($))[1]?k:o[1],_=null==o[2]?k:o[2],s=i.$get_torg_eternity_bonus(l=null==o[0]?k:o[0]),g=n(g=U(a)?U(e(a,0))?s+"["+_+"]+"+a:s+"["+_+"]"+a:s+"["+_+"]",n(" \uff1e ",n(s,a).$to_s())),U(l["$!="](d))&&(g=n(g,n(n("(\u6280\u80fd\u7121",n(i.$get_torg_eternity_bonus(d),a).$to_s()),")"))),g="("+r+") \uff1e "+g):k},_.$$arity=1),t.def(C,"$getRolld20DiceCommandResult",s=function(e){var n,r,o,$=this,i=k,u=k,a=k,l=k,d=k;return $.$debug("Torg Eternity Dice Roll Command ? ",e),o=/(^|\s)(S)?(TE)$/i.$match(e),U(o)?(r=$.$torg_eternity_dice(!1,!0),i=null==(n=t.to_ary(r))[0]?k:n[0],u=null==n[1]?k:n[1],a=null==n[2]?k:n[2],(null==n[3]?k:n[3])["$=="](1)?l="d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+a+"] \uff1e Mishap!\u3000\u7d76\u5bfe\u5931\u6557\uff01":(d=$.$format("%+d",$.$get_torg_eternity_bonus(i)),l=U(i["$!="](u))?"d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+a+"] \uff1e "+d+"["+i+"]\uff08\u6280\u80fd\u6709\uff09 / "+$.$format("%+d",$.$get_torg_eternity_bonus(u))+"["+u+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u901a\u5e38\uff09 \uff1e 1d20["+a+"] \uff1e "+d+"["+i+"]"),l):k},s.$$arity=1),t.def(C,"$getUpRollDiceCommandResult",g=function(e){var r,o,$,i=this,u=k,a=k,l=k,d=k,_=k,s=k,g=k,c=k,m=k;return i.$debug("Torg Eternity Dice Roll ( UP ) Command ? ",e),$=/(^|\s)(S)?(UP)$/i.$match(e),U($)?(o=i.$torg_eternity_dice(!1,!0),u=null==(r=t.to_ary(o))[0]?k:r[0],a=null==r[1]?k:r[1],l=null==r[2]?k:r[2],(null==r[3]?k:r[3])["$=="](1)?d="d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09 \uff1e 1d20["+l+"] \uff1e Mishap!\u3000\u7d76\u5bfe\u5931\u6557\uff01":(o=i.$torg_eternity_dice(!1,!1),_=null==(r=t.to_ary(o))[1]?k:r[1],s=null==r[2]?k:r[2],g=n(u,null==r[0]?k:r[0]),c=n(a,_),m=i.$format("%+d",i.$get_torg_eternity_bonus(g)),d=U(g["$!="](c))?"d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09 \uff1e 1d20["+l+"] + 1d20["+s+"] \uff1e "+m+"["+g+"]\uff08\u6280\u80fd\u6709\uff09 / "+i.$format("%+d",i.$get_torg_eternity_bonus(c))+"["+c+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u9ad8\u63da\uff09 \uff1e 1d20["+l+"] + 1d20["+s+"] \uff1e "+m+"["+g+"]"),d):k},g.$$arity=1),t.def(C,"$getPossibilityRollDiceCommandResult",c=function(e){var r,o,$=this,i=k,u=k,a=k,l=k,d=k,_=k,s=k;return $.$debug("Torg Eternity Possibility Roll Command ? ",e),i=/(^|\s)(S)?(POS)((\d+)(\+\d+)?)/i.$match(e),U(i)?(u=A(S,"ArithmeticEvaluator").$eval(i["$[]"](4)),o=$.$torg_eternity_dice(!0,!1),a=null==(r=t.to_ary(o))[1]?k:r[1],l=null==r[2]?k:r[2],d=n(null==r[0]?k:r[0],u),_=n(a,u),s=$.$format("%+d",$.$get_torg_eternity_bonus(d)),U(d["$!="](_))?"d20\u30ed\u30fc\u30eb\uff08\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\uff09 \uff1e "+u+"+1d20["+l+"] \uff1e "+s+"["+d+"]\uff08\u6280\u80fd\u6709\uff09 / "+$.$format("%+d",$.$get_torg_eternity_bonus(_))+"["+_+"]\uff08\u6280\u80fd\u7121\uff09":"d20\u30ed\u30fc\u30eb\uff08\u30dd\u30b7\u30d3\u30ea\u30c6\u30a3\uff09 \uff1e "+u+"+1d20["+l+"] \uff1e "+s+"["+d+"]"):k},c.$$arity=1),t.def(C,"$getBonusDamageDiceCommandResult",m=function(e){var o,$,i=this,u=k,a=k,l=k,d=k,_=k,s=k;return i.$debug("TorgEternity Bonus Damage Roll Command ? ",e),u=/(\d+)(BD)(([+\-]\d+)*)/i.$match(e),U(u)?(a=u["$[]"](1).$to_i(),$=i.$get_torg_eternity_modifier(u["$[]"](3)),l=null==(o=t.to_ary($))[0]?k:o[0],d=null==o[1]?k:o[1],U(r(a,0))?_="\u30a8\u30e9\u30fc\u3067\u3059\u3002xBD (x\u22671) \u3068\u3057\u3066\u4e0b\u3055\u3044":($=i.$get_torg_eternity_damage_bonus_dice(a),_="\u30dc\u30fc\u30ca\u30b9\u30c0\u30e1\u30fc\u30b8\u30ed\u30fc\u30eb("+a+"BD"+d+") \uff1e "+(s=null==(o=t.to_ary($))[0]?k:o[0])+"["+(null==o[1]?k:o[1])+"]"+d+" \uff1e "+n(s,l)+"\u30c0\u30e1\u30fc\u30b8"),_):k},m.$$arity=1),t.def(C,"$getSuccessLevelDiceCommandResult",y=function(t){var e=this,n=k,r=k,$=k;return e.$debug("TorgEternity Success Level Table Command ? ",t),n=/(RT|Result)(-*\d+([+\-]\d+)*)/i.$match(t),U(n)?(r=A(S,"ArithmeticEvaluator").$eval(n["$[]"](2)),e.$debug(r),$=U(o(r,0))?"Failure.":e.$get_torg_eternity_success_level(r),e.$debug($="\u6210\u529f\u30ec\u30d9\u30eb\u8868["+r+"] \uff1e "+$),$):k},y.$$arity=1),t.def(C,"$getDamageResultDiceCommandResult",f=function(t){var e=this,n=k,r=k,o=k;return e.$debug("TorgEternity Damage Result Table Command ? ",t),n=/(DT|Damage)(-*\d+([+\-]\d+)*)/i.$match(t),U(n)?(r=A(S,"ArithmeticEvaluator").$eval(n["$[]"](2)),e.$debug(r),o=e.$get_torg_eternity_damage_result(r),e.$debug(o="\u30c0\u30e1\u30fc\u30b8\u7d50\u679c\u8868["+r+"] \uff1e "+o),o):k},f.$$arity=1),t.def(C,"$getRollBonusDiceCommandResult",b=function(e){var o,$,i=this,u=k,a=k,l=k,d=k,_=k,s=k,g=k;return i.$debug("TorgEternity Roll Bonus Table Command ? ",e),u=/(BT|Bonus|Total)(\d+)(([+\-]\d+)*)/i.$match(e),U(u)?(a=u["$[]"](2).$to_i(),l=i.$get_torg_eternity_bonus(a),i.$debug(l),$=i.$get_torg_eternity_modifier(u["$[]"](3)),d=null==(o=t.to_ary($))[0]?k:o[0],_=null==o[1]?k:o[1],U(r(a,1))?s="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+a+"] \uff1e Mishap!!":U(_["$empty?"]())?s="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+a+"] \uff1e "+l:(g=n(l.$to_i(),d),i.$debug(g),s="\u30ed\u30fc\u30eb\u30dc\u30fc\u30ca\u30b9\u8868["+a+"]"+_+" \uff1e "+l+"["+a+"]"+_+" \uff1e "+g),i.$debug(s),s):k},b.$$arity=1),t.def(C,"$get_torg_eternity_table_result",h=function(n,r){var o,$=this,i=k;return i=k,function(){var u=t.new_brk();try{M(r,"each",[],((o=function(r){var o;return null==r&&(r=k),o=r["$[]"](0),U(e(o,n))&&t.brk(k,u),i=r["$[]"](1)}).$$s=$,o.$$brk=u,o.$$arity=1,o))}catch(a){if(a===u)return a.$v;throw a}}(),i},h.$$arity=2),t.def(C,"$get_torg_eternity_modifier",R=function(t){var e=this,n=k,r=k;return e.$debug("modifier check : "+t),t["$=="]("")?(n=0,r=""):(n=A(S,"ArithmeticEvaluator").$eval(t),r=e.$format("%+d",n)),e.$debug(n),e.$debug(r),[n,r]},R.$$arity=1),t.def(C,"$torg_eternity_dice",T=function(t,e){var r=k,$=k,i=k,u=k,a=k,l=k,d=k,_=k;for(r=!0,$=!0,i=0,u=0,a=0,l="";U(r);)U(l["$empty?"]())||(l=n(l,",")),d=this.randomizer.$roll_once(20),U(t)?(U(o(d,10))?(_=d+"\u219210",d=10,r=!1):_=d.$to_s(),l=n(l,_)):l=n(l,d.$to_s()),i=n(i,d),U($)&&(u=n(u,d)),d["$=="](20)?$=!1:U(d["$!="](10))&&(r=!1,$=!1,U(e["$&"](d["$=="](1)))&&(a=1)),t=!1,e=!1;return[i,u,l,a]},T.$$arity=2),t.def(C,"$get_torg_eternity_damage_bonus_dice",v=function(t){var r=this,o=k,i=k,u=k,a=k;if(r.$debug("bonus dice roll : "+t),o=0,i="",U(e(t,0)))for(o=0,i="";U(e(t,0));)U(i["$empty?"]())||(i+=","),a=(u=r.randomizer.$roll_once(6)).$to_s(),u["$=="](6)&&(u=5,a="5\u221e",t=n(t,1)),o=n(o,u),i=""+i+a,r.$debug(o),r.$debug(i),t=$(t,1);else i="0";return r.$debug(o),r.$debug(i),[o,i]},v.$$arity=1),t.def(C,"$get_torg_eternity_success_level",D=function(t){return this.$get_torg_eternity_table_result(t,[[0,"Success - Standard."],[5,"Success - Good!"],[10,"Success - Outstanding!!"]])},D.$$arity=1),t.def(C,"$get_torg_eternity_damage_result",p=function(t){return this.$get_torg_eternity_table_result(t,[[-50,"\u30ce\u30fc\u30c0\u30e1\u30fc\u30b8"],[-5,"1\u30b7\u30e7\u30c3\u30af"],[0,"2\u30b7\u30e7\u30c3\u30af"],[5,"1\u30ec\u30d9\u30eb\u8ca0\u50b7 + 2\u30b7\u30e7\u30c3\u30af"],[10,"2\u30ec\u30d9\u30eb\u8ca0\u50b7 + 4\u30b7\u30e7\u30c3\u30af"],[15,"3\u30ec\u30d9\u30eb\u8ca0\u50b7 + 6\u30b7\u30e7\u30c3\u30af"],[20,"4\u30ec\u30d9\u30eb\u8ca0\u50b7 + 8\u30b7\u30e7\u30c3\u30af"],[25,"5\u30ec\u30d9\u30eb\u8ca0\u50b7 + 10\u30b7\u30e7\u30c3\u30af"],[30,"6\u30ec\u30d9\u30eb\u8ca0\u50b7 + 12\u30b7\u30e7\u30c3\u30af"],[35,"7\u30ec\u30d9\u30eb\u8ca0\u50b7 + 14\u30b7\u30e7\u30c3\u30af"],[40,"8\u30ec\u30d9\u30eb\u8ca0\u50b7 + 16\u30b7\u30e7\u30c3\u30af"],[45,"9\u30ec\u30d9\u30eb\u8ca0\u50b7 + 18\u30b7\u30e7\u30c3\u30af"],[50,"10\u30ec\u30d9\u30eb\u8ca0\u50b7 + 20\u30b7\u30e7\u30c3\u30af"]])},p.$$arity=1),t.def(C,"$get_torg_eternity_bonus",E=function(t){var r,o=k,i=k;return o=this.$get_torg_eternity_table_result(t,[[1,-10],[2,-8],[3,-6],[5,-4],[7,-2],[9,-1],[11,0],[13,1],[15,2],[16,3],[17,4],[18,5],[19,6],[20,7]]),U(e(t,20))&&(i=n((r=$(t,21),"number"==typeof r?r/5:r["$/"](5)).$to_i(),1),o=n(o,i)),o},E.$$arity=1)}(Opal)}}]);