(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4788],{4324:(ge,ye,he)=>{he(3986),Opal.modules["i18n/backend/fallbacks"]=function(e){var L,i,r,s,a,d,F=e.module,B=e.class_variable_set,c=e.truthy,I=e.class_variable_get,T=e.def,S=e.send,G=e.send2,w=e.find_super,E=e.hash2,A=e.find_block_super,D=e.neqeq,H=e.thrower,Y=e.return_val,M=[],N=e.nil,k=e.$$$;return L=M,d=[a=F(M[0],"I18n")].concat(L),B(d[0],"@@fallbacks",N),i=e.get_singleton_class(a),r=[i].concat(d),s=e.$r(r),T(i,"$fallbacks",function(){var q=N;return B(r[1],"@@fallbacks",c(null!=r[1].$$cvars["@@fallbacks"]?"class variable":N)&&c(q=I(r[1],"@@fallbacks",!1))?q:k(k(s("I18n"),"Locale"),"Fallbacks").$new()),c(q=s("Thread").$current()["$[]"]("i18n_fallbacks"))?q:I(r[1],"@@fallbacks",!1)}),T(i,"$fallbacks=",function(z){var q;return B(r[1],"@@fallbacks",c(z["$is_a?"](s("Array")))?k(k(s("I18n"),"Locale"),"Fallbacks").$new(z):z),q=["i18n_fallbacks",I(r[1],"@@fallbacks",!1)],S(s("Thread").$current(),"[]=",q),q[q.length-1]}),function(i,R){var z,q,y,f,s=[F(i,"Backend")].concat(R);return z=s,y=[q=F(s[0],"Fallbacks")].concat(z),f=e.$r(y),T(q,"$translate",function p(m,h,u){try{var v=H("return"),_=p.$$p||N,P=this,U=N,o=N;return p.$$p=null,null==u&&(u=f("EMPTY_HASH")),c(u.$fetch("fallback",!0))?c(u["$[]"]("fallback_in_progress"))?G(P,w(P,"translate",p,!1,!0),"translate",[m,h,u],_):(c(u["$[]"]("default"))&&(U=P["$extract_non_symbol_default!"](u)),o=u.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),S(f("I18n").$fallbacks()["$[]"](m),"each",[],function t(x){var n=null==t.$$s?this:t.$$s;null==x&&(x=N);try{return S(n,"catch",["exception"],function l(){var $=null==l.$$s?this:l.$$s,j=N;if(j=G($,A($,"translate",l.$$def||t.$$def||p,!1,!1),"translate",[x,h,o],null),c(j["$nil?"]()))return N;D(m.$to_s(),x.$to_s())&&$.$on_fallback(m,x,h,u),v.$throw(j)},{$$s:n,$$ret:v})}catch(l){if(!e.rescue(l,[k(f("I18n"),"InvalidLocale")]))throw l;try{return N}finally{e.pop_exception()}}},{$$s:P}),c(u["$key?"]("default"))&&c(u["$[]"]("default")["$nil?"]())?N:c(U)?G(P,w(P,"translate",p,!1,!0),"translate",[m,N,u.$merge(E(["default"],{default:U}))],null):P.$throw("exception",k(f("I18n"),"MissingTranslation").$new(m,h,u))):G(P,w(P,"translate",p,!1,!0),"translate",[m,h,u],_)}catch(t){if(t===v)return t.$v;throw t}},-3),T(q,"$extract_non_symbol_default!",function(m){var u,h=N;return h=[m["$[]"]("default")].$flatten(),u=S(h,"detect",[],function(_){return null==_&&(_=N),_["$is_a?"](f("Symbol"))["$!"]()}),c(u)&&m["$[]="]("default",h["$[]"](0,h.$index(u))),u}),T(q,"$exists?",function p(m,h,u){try{var v=H("return"),_=p.$$p||N,P=this;return p.$$p=null,null==u&&(u=f("EMPTY_HASH")),c(u.$fetch("fallback",!0))?(S(f("I18n").$fallbacks()["$[]"](m),"each",[],function U(o){var t=null==U.$$s?this:U.$$s;null==o&&(o=N);try{if(!c(G(t,A(t,"exists?",U.$$def||p,!1,!1),"exists?",[o,h],null)))return N;v.$throw(!0)}catch(x){if(!e.rescue(x,[k(f("I18n"),"InvalidLocale")]))throw x;try{return N}finally{e.pop_exception()}}},{$$s:P,$$ret:v}),!1):G(P,w(P,"exists?",p,!1,!0),"exists?",[m,h,u],_)}catch(U){if(U===v)return U.$v;throw U}},-3),q.$private(),T(q,"$on_fallback",Y(N))}(d[0],d)},Opal.modules["bcdice/randomizer"]=function(e){var a,b,z,q,y,f,i,R,B=e.klass,c=e.const_set,I=e.def,T=e.truthy,S=e.rb_gt,G=e.rb_plus,w=e.rb_le,E=e.send,A=e.rb_minus,D=e.eqeq,H=e.rb_times,Y=e.eqeqeq,M=e.rb_ge,N=[],k=e.nil,K=e.$$$;return a=N,i=[(0,e.module)(N[0],"BCDice")].concat(a),R=e.$r(i),b=i,q=[z=B(i[0],null,"Randomizer")].concat(b),y=e.$r(q),(f=z.$$prototype).rand_results=f.detailed_rand_results=k,c(q[0],"UPPER_LIMIT_DICE_TIMES",200),c(q[0],"UPPER_LIMIT_DICE_SIDES",1e4),c(q[0],"UPPER_LIMIT_RANDS",1e4),I(z,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),z.$attr_reader("rand_results"),z.$attr_reader("detailed_rand_results"),c(q[0],"DetailedRandResult",y("Struct").$new("kind","sides","value")),I(z,"$roll_barabara",function(m,h){var u=this;return T(S(G(u.rand_results.$size(),m),y("UPPER_LIMIT_RANDS")))&&u.$raise(y("TooManyRandsError")),T(w(m,0))||T(S(m,y("UPPER_LIMIT_DICE_TIMES")))?[]:E(y("Array"),"new",[m],function v(){return(null==v.$$s?this:v.$$s).$roll_once(h)},{$$s:u})}),I(z,"$roll_sum",function(m,h){return this.$roll_barabara(m,h).$sum()}),I(z,"$roll_once",function(m){var u=k;return T(w(m,0))||T(S(m,y("UPPER_LIMIT_DICE_SIDES")))?0:(u=this.$rand_inner(m),this.$push_to_detail("normal",m,u),u)}),I(z,"$roll_index",function(m){return A(this.$roll_once(m),1)}),I(z,"$roll_tens_d10",function(){var u,h=k;return h=this.$rand_inner(10),D(h,10)&&(h=0),u=H(h,10),this.$push_to_detail("tens_d10",10,u),u}),I(z,"$roll_d9",function(){var h;return h=A(this.$rand_inner(10),1),this.$push_to_detail("d9",10,h),h}),I(z,"$roll_d66",function(m){var v,u=k;return u=E(y("Array"),"new",[2],function _(){return(null==_.$$s?this:_.$$s).$roll_once(6)},{$$s:this}),Y(K(y("D66SortType"),"ASC"),v=m)?u["$sort!"]():Y(K(y("D66SortType"),"DESC"),v)&&u["$sort!"]()["$reverse!"](),G(H(u["$[]"](0),10),u["$[]"](1))}),z.$private(),I(z,"$rand_inner",function(m){var u,h=this;return T(M(h.rand_results.$size(),y("UPPER_LIMIT_RANDS")))&&h.$raise(y("TooManyRandsError")),u=h.$random(m),h.rand_results["$<<"]([u,m]),u}),I(z,"$random",function(m){return G(y("Kernel").$rand(m),1)}),I(z,"$push_to_detail",function(m,h,u){var _;return _=y("DetailedRandResult").$new(m,h,u),this.detailed_rand_results.$push(_)}),B(i[0],R("StandardError"),"TooManyRandsError"),k},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,Y,L,a,d,i,R,N,D,F=e.module,B=e.klass,c=e.def,I=e.truthy,T=e.return_val,S=[],G=e.nil;return E=S,Y=D=[F(S[0],"BCDice")].concat(E),L=N=[F(D[0],"DiceTable")].concat(Y),d=[a=B(N[0],null,"RollResult")].concat(L),i=e.$r(d),(R=a.$$prototype).table_name=R.value=R.body=G,c(a,"$initialize",function(s,b,z){var q=this;return q.table_name=s,q.value=b,q.body=z}),a.$attr_reader("table_name"),a.$attr_reader("value"),a.$attr_reader("body"),c(a,"$to_s",function(){var s=this;return s.table_name+"("+s.value+") \uff1e "+s.body}),c(a,"$last_body",function(){var s=this;return I(s.body["$is_a?"](i("RollResult")))?s.body.$last_body():s.body}),c(a,"$empty?",T(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,Y,L,a,d,i,R,N,D,F=e.module,B=e.klass,c=e.truthy,I=e.def,T=e.rb_minus,S=[],G=e.nil;return E=S,Y=D=[F(S[0],"BCDice")].concat(E),L=N=[F(D[0],"DiceTable")].concat(Y),d=[a=B(N[0],null,"ChainTable")].concat(L),i=e.$r(d),(R=a.$$prototype).times=R.sides=R.items=R.name=G,I(a,"$initialize",function(s,b,z){var q=this,y=G;return q.name=s,q.items=z.$freeze(),y=/(\d+)D(\d+)/i.$match(b),c(y)||q.$raise(i("ArgumentError"),"Unexpected table type: "+b),q.times=y["$[]"](1).$to_i(),q.sides=y["$[]"](2).$to_i()}),I(a,"$roll",function(s){var z,q,b=this,y=G;return z=s.$roll_sum(b.times,b.sides),q=T(z,b.times),y=b.items["$[]"](q),c(y["$respond_to?"]("roll"))&&(y=y.$roll(s)),i("RollResult").$new(b.name,z,y)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var H,k,i,R,r,s,b,L,M,F=e.module,B=e.klass,c=e.hash2,I=e.defs,T=e.def,S=e.rb_plus,G=e.rb_times,w=e.rb_minus,E=[],A=e.nil;return H=E,k=M=[F(E[0],"BCDice")].concat(H),i=L=[F(M[0],"DiceTable")].concat(k),r=[R=B(L[0],null,"D66GridTable")].concat(i),s=e.$r(r),(b=R.$$prototype).name=b.items=A,I(R,"$from_i18n",function(q,y){var p=A;return p=s("I18n").$t(q,c(["locale","raise"],{locale:y,raise:!0})),this.$new(p["$[]"]("name"),p["$[]"]("items"))}),T(R,"$initialize",function(q,y){return this.name=q,this.items=y.$freeze()}),T(R,"$roll",function(q){var f,p,m,h,u;return f=q.$roll_once(6),p=q.$roll_once(6),m=S(G(f,10),p),h=w(f,1),u=w(p,1),s("RollResult").$new(this.name,m,this.items["$[]"](h)["$[]"](u))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var A,M,d,i,R,r,k,K,H,F=e.module,B=e.klass,c=e.hash2,I=e.defs,T=e.def,G=[],w=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),A=G,M=H=[F(G[0],"BCDice")].concat(A),k=[F(H[0],"DiceTable")].concat(M),K=e.$r(k),d=k,R=[i=B(k[0],K("D66GridTable"),"D66HalfGridTable")].concat(d),r=e.$r(R),I(i,"$from_i18n",function(b,z){var y=w;return y=r("I18n").$t(b,c(["locale","raise"],{locale:z,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2_3"),y["$[]"]("items_4_5_6"))}),T(i,"$initialize",function(b,z,q){return this.name=b,this.items=[z,z,z,q,q,q].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var A,M,d,i,R,r,k,K,H,F=e.module,B=e.klass,c=e.hash2,I=e.defs,T=e.def,G=[],w=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),A=G,M=H=[F(G[0],"BCDice")].concat(A),k=[F(H[0],"DiceTable")].concat(M),K=e.$r(k),d=k,R=[i=B(k[0],K("D66GridTable"),"D66OneThirdTable")].concat(d),r=e.$r(R),I(i,"$from_i18n",function(b,z){var y=w;return y=r("I18n").$t(b,c(["locale","raise"],{locale:z,raise:!0})),this.$new(y["$[]"]("name"),y["$[]"]("items_1_2"),y["$[]"]("items_3_4"),y["$[]"]("items_5_6"))}),T(i,"$initialize",function(b,z,q,y){return this.name=b,this.items=[z,z,q,q,y,y].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var M,L,r,s,b,z,q,d,k,F=e.module,B=e.klass,c=e.hash2,I=e.defs,T=e.def,S=e.eqeqeq,G=e.rb_plus,w=e.rb_times,E=e.truthy,A=[],D=e.nil,H=e.$$$;return M=A,L=k=[F(A[0],"BCDice")].concat(M),r=d=[F(k[0],"DiceTable")].concat(L),b=[s=B(d[0],null,"D66Table")].concat(r),z=e.$r(b),(q=s.$$prototype).sort_type=q.items=q.name=D,I(s,"$from_i18n",function(f,p){var u,h=D;return h=z("I18n").$t(f,c(["locale"],{locale:p})),u=z("D66SortType").$const_get(h["$[]"]("d66_sort_type")),this.$new(h["$[]"]("name"),u,h["$[]"]("items"))}),T(s,"$initialize",function(f,p,m){var h=this;return h.name=f,h.sort_type=p,h.items=m.$freeze()}),T(s,"$roll",function(f){var p=this,m=D,h=D,u=D,v=D;return m=f.$roll_barabara(2,6),S(H(z("D66SortType"),"ASC"),h=p.sort_type)?m["$sort!"]():S(H(z("D66SortType"),"DESC"),h)&&m["$sort!"]()["$reverse!"](),u=G(w(m["$[]"](0),10),m["$[]"](1)),v=E(h=p.items["$[]"](u))?h:p.items["$[]"](u.$to_s()),E(v["$respond_to?"]("roll"))&&(v=v.$roll(f)),z("RollResult").$new(p.name,u,v)}),T(s,"$choice",function(f){return z("RollResult").$new(this.name,f,this.items["$[]"](f))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var N,a,i,R,K,F=e.module,B=e.klass,c=e.hash2,I=e.send,T=e.to_ary,S=e.rb_plus,G=e.rb_times,w=e.send2,E=e.find_super,A=e.def,H=[],Y=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),N=H,a=K=[F(H[0],"BCDice")].concat(N),i=[F(K[0],"DiceTable")].concat(a),R=e.$r(i),A(B(i[0],R("D66Table"),"D66LeftRangeTable"),"$initialize",function z(q,y,f){var h;return z.$$p=null,h=c([],{}),I(f,"each",[],function(v){var _,o;return null==v&&(v=Y),_=T(v),o=null==_[1]?Y:_[1],I(null==_[0]?Y:_[0],"each",[],function(x){return null==x&&(x=Y),I(o,"each_with_index",[],function(l,$){var j,Q;return null==l&&(l=Y),null==$&&($=Y),Q=S(G(x,10),S($,1)),I(h,"[]=",j=[Q,l]),j[j.length-1]})})}),w(this,E(this,"initialize",z,!1,!0),"initialize",[q,y,h],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var Y,K,R,r,s,b,z,a,N,F=e.module,B=e.klass,c=e.hash2,I=e.defs,T=e.def,S=e.truthy,G=e.rb_minus,w=e.rb_plus,E=e.rb_times,A=[],D=e.nil;return Y=A,K=N=[F(A[0],"BCDice")].concat(Y),R=a=[F(N[0],"DiceTable")].concat(K),s=[r=B(a[0],null,"D66ParityTable")].concat(R),b=e.$r(s),(z=r.$$prototype).odd=z.even=z.name=D,I(r,"$from_i18n",function(y,f){var m=D;return m=b("I18n").$t(y,c(["locale","raise"],{locale:f,raise:!0})),this.$new(m["$[]"]("name"),m["$[]"]("odd"),m["$[]"]("even"))}),T(r,"$initialize",function(y,f,p){var m=this;return m.name=y,m.odd=f.$freeze(),m.even=p.$freeze()}),T(r,"$roll",function(y){var m,u,v,f=this,p=D;return p=y.$roll_once(6),m=y.$roll_once(6),u=(S(p["$odd?"]())?f.odd:f.even)["$[]"](G(m,1)),v=w(E(p,10),m),b("RollResult").$new(f.name,v,u)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var A,M,a,d,i,R,r,k,H,F=e.module,B=e.klass,c=e.def,I=e.rb_plus,T=e.rb_times,S=e.send,G=[],w=e.nil;return A=G,M=H=[F(G[0],"BCDice")].concat(A),a=k=[F(H[0],"DiceTable")].concat(M),i=[d=B(k[0],null,"D66RangeTable")].concat(a),R=e.$r(i),(r=d.$$prototype).items=r.name=w,c(d,"$initialize",function(b,z){return this.name=b,this.items=z.$freeze()}),c(d,"$roll",function(b){var q,y,f,p=w;return q=b.$roll_once(6),y=b.$roll_once(6),f=I(T(q,10),y),p=S(this.items,"find",[],function(h){return null==h&&(h=w),h["$[]"](0)["$include?"](f)}),R("RollResult").$new(this.name,f,p["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var Y,K,R,r,s,b,z,a,N,F=e.module,B=e.klass,c=e.const_set,I=e.send,T=e.truthy,S=e.def,G=e.eqeqeq,w=e.rb_times,E=e.rb_plus,A=[],D=e.nil;return Y=A,K=N=[F(A[0],"BCDice")].concat(Y),R=a=[F(N[0],"DiceTable")].concat(K),s=[r=B(a[0],null,"RangeTable")].concat(R),b=e.$r(s),(z=r.$$prototype).name=z.items=z.num_of_dice=z.num_of_sides=z.formatter=D,c(s[0],"RollResult",I(b("Struct"),"new",["sum","values","content","formatted"],function q(){return(null==q.$$s?this:q.$$s).$alias_method("to_s","formatted")},{$$s:r})),c(s[0],"Item",b("Struct").$new("range","content")),c(s[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),c(s[0],"DEFAULT_FORMATTER",I(r,"lambda",[],function(y,f){return null==y&&(y=D),null==f&&(f=D),y.$name()+"("+f.$sum()+") \uff1e "+f.$content()})),r.$attr_reader("name"),r.$attr_reader("num_of_dice"),r.$attr_reader("num_of_sides"),S(r,"$initialize",function q(y,f,p){var u,m=q.$$p||D,h=this,v=D;return q.$$p=null,h.name=y.$freeze(),h.formatter=T(u=m)?u:b("DEFAULT_FORMATTER"),v=b("DICE_ROLL_METHOD_RE").$match(f),T(v)||h.$raise(b("ArgumentError"),h.name+": invalid dice roll method: "+f),h.num_of_dice=v["$[]"](1).$to_i(),h.num_of_sides=v["$[]"](2).$to_i(),h.$store(p)}),S(r,"$fetch",function(y){var p,f=this;return p=I(f.items,"find",[],function(h){return null==h&&(h=D),h.$range()["$include?"](y)}),T(p)||f.$raise(b("RangeError"),f.name+": value is out of range: "+y),p}),S(r,"$roll",function(y){var m,f=this,p=D,h=D;return m=(p=y.$roll_barabara(f.num_of_dice,f.num_of_sides)).$sum(),(h=b("RollResult").$new(m,p,f.$fetch(m).$content()))["$formatted="](f.formatter["$[]"](f,h)),h}),r.$private(),S(r,"$store",function(y){var p,m,f=this;return p=I(y,"map",[],function h(u,v){return null==u&&(u=D),null==v&&(v=D),[(null==h.$$s?this:h.$$s).$coerce_to_int_range(u),v]},{$$s:f}),m=I(p,"sort_by",[],function(u,v){return null==u&&(u=D),null==v&&(v=D),u.$min()}),f.$assert_min_sum_is_covered(m),f.$assert_max_sum_is_covered(m),f.$assert_no_gap_or_overlap_in_ranges(m),f.items=I(m,"map",[],function(u,v){return null==u&&(u=D),null==v&&(v=D),b("Item").$new(u,v.$freeze()).$freeze()}).$freeze(),f}),S(r,"$coerce_to_int_range",function(y){var p;return G(b("Integer"),p=y)?b("Range").$new(y,y):G(b("Range"),p)&&T(y.$begin()["$is_a?"](b("Integer")))&&T(y.$end()["$is_a?"](b("Integer")))?y:this.$raise(b("TypeError"),this.name+": "+y+" ("+y.$class()+") must be an Integer or a Range with Integers ")}),S(r,"$assert_min_sum_is_covered",function(y){var p,f=this,m=D;return p=f.num_of_dice,m=y.$first()["$[]"](0),T(m["$include?"](p))||f.$raise(b("RangeError"),f.name+": min value ("+p+") is not covered: "+m),f}),S(r,"$assert_max_sum_is_covered",function(y){var p,f=this,m=D;return p=w(f.num_of_dice,f.num_of_sides),m=y.$last()["$[]"](0),T(m["$include?"](p))||f.$raise(b("RangeError"),f.name+": max value ("+p+") is not covered: "+m),f}),S(r,"$assert_no_gap_or_overlap_in_ranges",function(y){return I(y,"each_cons",[2],function p(m,h){var P,U,u=null==p.$$s?this:p.$$s,v=D,_=D;return null==u.name&&(u.name=D),null==m&&(m=D),null==h&&(h=D),v=m["$[]"](0),_=h["$[]"](0),P=v.$max(),U=E(P,1),T(_["$include?"](P))&&u.$raise(b("RangeError"),u.name+": Range overlap: "+v+" and "+_),T(_["$include?"](U))?D:u.$raise(b("RangeError"),u.name+": Range gap: "+v+" and "+_)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var D,N,d,b,z,q,y,R,K,Y,F=e.module,B=e.klass,c=e.send,I=e.def,T=e.rb_minus,S=e.return_ivar,G=[],w=e.nil,E=e.$$$;return D=G,N=Y=[F(G[0],"BCDice")].concat(D),d=K=[F(Y[0],"DiceTable")].concat(N),b=R=[B(K[0],null,"SaiFicSkillTable")].concat(d),q=[z=B(R[0],null,"Category")].concat(b),y=e.$r(q),I(z,"$initialize",function(p,m,h,u){var v=this;return v.name=p,v.skills=c(m.$map(),"with_index",[2],function(P,U){return null==P&&(P=w),null==U&&(U=w),E(y("SaiFicSkillTable"),"Skill").$new(p,P,h,U,u)}),v.dice=h}),I(z,"$roll",function(p){return this.$skills()["$[]"](T(p.$roll_sum(2,6),2))}),I(z,"$to_s",S("name")),z.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var w,H,K,R,r,a,M,A,F=e.module,B=e.klass,c=e.def,I=e.hash2,T=[],S=e.nil;return w=T,H=A=[F(T[0],"BCDice")].concat(w),K=M=[F(A[0],"DiceTable")].concat(H),a=[B(M[0],null,"SaiFicSkillTable")].concat(K),(r=(R=B(a[0],null,"Skill")).$$prototype).s_format=r.category_dice=r.row_dice=r.category_name=r.name=S,c(R,"$initialize",function(b,z,q,y,f){var p=this;return p.category_name=b,p.name=z,p.category_dice=q,p.row_dice=y,p.s_format=f}),c(R,"$to_s",function(){var b=this;return b.$format(b.s_format,I(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))}),R.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var a,r,y,f,p,m,h,b,i,F=e.module,B=e.klass,c=e.ensure_kwargs,I=e.hash2,T=e.send,G=e.defs,w=e.const_set,E=e.to_ary,A=e.def,D=e.truthy,H=e.rb_minus,Y=e.rb_plus,M=e.top,N=[],k=e.nil,K=e.$$$;return M.$require("bcdice/dice_table/sai_fic_skill_table/category"),M.$require("bcdice/dice_table/sai_fic_skill_table/skill"),a=N,r=i=[F(N[0],"BCDice")].concat(a),y=b=[F(i[0],"DiceTable")].concat(r),p=[f=B(b[0],null,"SaiFicSkillTable")].concat(y),m=e.$r(p),(h=f.$$prototype).rtt=h.rtt_format=h.rct=h.rct_format=h.rttn=h.rttn_format=h.categories=k,G(f,"$from_i18n",function(v,_,P){var U,o,t,$,l=k;return null==(U=(P=c(P)).$$smap.rtt)&&(U=k),null==(o=P.$$smap.rct)&&(o=k),null==(t=P.$$smap.rttn)&&(t=k),$=(l=m("I18n").$t("RTT",I(["locale","raise","default"],{locale:_,raise:!1,default:I([],{})})).$merge(m("I18n").$t(v,I(["locale","raise"],{locale:_,raise:!0}))))["$[]"]("items"),l=T(l,"select",[],function(Q,V){return null==Q&&(Q=k),null==V&&(V=k),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Q)}),this.$new($,e.to_hash(l).$merge(I(["rtt","rct","rttn"],{rtt:U,rct:o,rttn:t})))},-3),w(p[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),w(p[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),w(p[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),w(p[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),A(f,"$initialize",function(v,_){var P,U,o,t,x,n,l,$=this;return null==(P=(_=c(_)).$$smap.rtt)&&(P=k),null==(U=_.$$smap.rct)&&(U=k),null==(o=_.$$smap.rttn)&&(o=k),null==(t=_.$$smap.rtt_format)&&(t=m("DEFAULT_RTT")),null==(x=_.$$smap.rct_format)&&(x=m("DEFAULT_RCT")),null==(n=_.$$smap.rttn_format)&&(n=m("DEFAULT_RTTN")),null==(l=_.$$smap.s_format)&&(l=m("DEFAULT_S")),$.categories=T(v.$map(),"with_index",[1],function(Q,V){var ne,ue,ie;return null==Q&&(Q=k),null==V&&(V=k),ue=null==(ne=E(Q))[0]?k:ne[0],ie=null==ne[1]?k:ne[1],K(m("SaiFicSkillTable"),"Category").$new(ue,ie,V,l)},{$$has_top_level_mlhs_arg:!0}),$.rtt=P,$.rct=U,$.rttn=o.$to_a(),$.rtt_format=t,$.rct_format=x,$.rttn_format=n},-2),w(p[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),f.$attr_reader("categories"),A(f,"$roll_command",function(v,_){var U,P=this,o=k,t=k;return D(["RTT",P.rtt]["$include?"](U=_))?P.$format_skill(P.rtt_format,P.$roll_skill(v)):D(["RCT",P.rct]["$include?"](U))?(o=P.$roll_category(v),P.$format(P.rct_format,I(["category_dice","category_name"],{category_dice:o.$dice(),category_name:o.$name()}))):D(t=m("RTTN").$index(U))||D(t=P.rttn.$index(U))?P.$format_skill(P.rttn_format,P.categories["$[]"](t).$roll(v)):k}),A(f,"$roll_category",function(v){return this.categories["$[]"](H(v.$roll_once(6),1))}),A(f,"$roll_skill",function(v){return this.$roll_category(v).$roll(v)}),A(f,"$prefixes",function(){var v=this;return Y(["RTT[1-6]?","RCT",v.rtt,v.rct],v.rttn).$compact()}),f.$private(),A(f,"$format_skill",function(v,_){return this.$format(v,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:_.$category_dice(),row_dice:_.$row_dice(),category_name:_.$category_name(),skill_name:_.$name(),text:_.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var D,N,d,i,R,r,s,K,Y,F=e.module,B=e.klass,c=e.hash2,I=e.defs,T=e.truthy,S=e.def,G=e.rb_minus,w=[],E=e.nil;return D=w,N=Y=[F(w[0],"BCDice")].concat(D),d=K=[F(Y[0],"DiceTable")].concat(N),R=[i=B(K[0],null,"Table")].concat(d),r=e.$r(R),(s=i.$$prototype).times=s.sides=s.name=s.items=E,I(i,"$from_i18n",function(z,q){var f=E;return f=r("I18n").$t(z,c(["locale"],{locale:q})),this.$new(f["$[]"]("name"),f["$[]"]("type"),f["$[]"]("items"))}),S(i,"$initialize",function(z,q,y){var f=this,p=E;return f.name=z,f.items=y.$freeze(),p=/(\d+)D(\d+)/i.$match(q),T(p)||f.$raise(r("ArgumentError"),"Unexpected table type: "+q),f.times=p["$[]"](1).$to_i(),f.sides=p["$[]"](2).$to_i()}),S(i,"$roll",function(z){var y,q=this;return y=z.$roll_sum(q.times,q.sides),q.$choice(y)}),S(i,"$choice",function(z){var y,q=this;return y=G(z,q.times),r("RollResult").$new(q.name,z,q.items["$[]"](y))})},Opal.modules["bcdice/dice_table"]=function(e){var F=e.top;return F.$require("bcdice/dice_table/roll_result"),F.$require("bcdice/dice_table/chain_table"),F.$require("bcdice/dice_table/d66_grid_table"),F.$require("bcdice/dice_table/d66_half_grid_table"),F.$require("bcdice/dice_table/d66_one_third_table"),F.$require("bcdice/dice_table/d66_left_range_table"),F.$require("bcdice/dice_table/d66_parity_table"),F.$require("bcdice/dice_table/d66_range_table"),F.$require("bcdice/dice_table/d66_table"),F.$require("bcdice/dice_table/range_table"),F.$require("bcdice/dice_table/sai_fic_skill_table"),F.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var S,A,H,w,F=e.module,B=e.const_set,c=[];return S=c,A=w=[F(c[0],"BCDice")].concat(S),H=[F(w[0],"D66SortType")].concat(A),B(H[0],"NO_SORT","no_sort"),B(H[0],"ASC","asc"),B(H[0],"DESC","desc"),function(E,A){var H=[F(E,"RoundType")].concat(A);return B(H[0],"CEIL","ceil"),B(H[0],"FLOOR","floor"),B(H[0],"ROUND","round")}(w[0],w)},Opal.modules["bcdice/translate"]=function(e){var A,M,N,k,K,H,F=e.module,B=e.ensure_kwargs,c=e.kwrestargs,T=e.hash2,S=e.def,G=[],w=e.nil;return A=G,M=H=[F(G[0],"BCDice")].concat(A),k=[N=F(H[0],"Translate")].concat(M),K=e.$r(k),S(N,"$translate",function(a,d){var i,R=this;return null==R.locale&&(R.locale=w),d=B(d),i=c(d,{}),K("I18n").$translate(a,T(["locale","raise"],{locale:R.locale,raise:!0}).$merge(e.to_hash(i)))},-2)},Opal.modules["bcdice/result"]=function(e){var N,L,k,A,H,B=e.klass,c=e.send,I=e.def,T=e.return_val,S=e.return_ivar,G=[],w=e.nil;return A=G,N=H=[(0,e.module)(G[0],"BCDice")].concat(A),[k=B(H[0],null,"Result")].concat(N),I(L=e.get_singleton_class(k),"$success",function(i){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](i),c(s,"success=",b=[!0]),b[b.length-1]})}),I(L,"$failure",function(i){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](i),c(s,"failure=",b=[!0]),b[b.length-1]})}),I(L,"$critical",function(i){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](i),s["$critical="](!0),c(s,"success=",b=[!0]),b[b.length-1]})}),I(L,"$fumble",function(i){return c(this.$new(),"tap",[],function(s){var b;return null==s&&(s=w),s["$text="](i),s["$fumble="](!0),c(s,"failure=",b=[!0]),b[b.length-1]})}),I(L,"$nothing",T("nothing")),I(k,"$initialize",function(a){var d=this;return null==a&&(a=w),d.text=a,d.rands=w,d.detailed_rands=w,d.secret=!1,d.success=!1,d.failure=!1,d.critical=!1,d.fumble=!1},-1),k.$attr_accessor("text","rands","detailed_rands"),k.$attr_writer("secret","success","failure","critical","fumble"),I(k,"$secret?",S("secret")),I(k,"$success?",S("success")),I(k,"$failure?",S("failure")),I(k,"$critical?",S("critical")),I(k,"$fumble?",S("fumble")),I(k,"$condition=",function(a){return this.success=a,this.failure=a["$!"]()})},Opal.modules["racc/parser"]=function(e){var z,y,f,F=e.module,B=e.klass,c=e.truthy,I=e.const_set,T=e.defs,S=e.gvars,G=e.rb_lt,w=e.def,E=e.to_ary,A=e.send,D=e.neqeq,H=e.rb_plus,Y=e.eqeq,M=e.rb_ge,N=e.rb_gt,k=e.rb_minus,K=e.rb_le,L=e.rb_times,a=e.assign_ivar_val,i=[],R=e.$r(i),r=e.nil,s=e.$$$;return z=i,y=[F(i[0],"Racc")].concat(z),f=e.$r(y),B(y[0],f("StandardError"),"ParseError"),c(s("::","ParseError","skip_raise")?"constant":r)||I(i[0],"ParseError",s(R("Racc"),"ParseError")),function(b,z){var u,v,_,P,U,f=[F(b,"Racc")].concat(z),p=e.$r(f);return c(p("Racc_No_Extensions","skip_raise")?"constant":r)||I(f[0],"Racc_No_Extensions",!1),u=f,_=[v=B(f[0],null,"Parser")].concat(u),P=e.$r(_),(U=v.$$prototype).yydebug=U.racc_debug_out=U.racc_error_status=U.racc_t=U.racc_vstack=U.racc_val=U.racc_state=U.racc_tstack=r,I(_[0],"Racc_Runtime_Version","1.4.6"),I(_[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),I(_[0],"Racc_Runtime_Core_Version_R","1.4.6"),I(_[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),I(_[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),I(_[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),I(_[0],"Racc_Runtime_Core_Version",P("Racc_Runtime_Core_Version_R")),I(_[0],"Racc_Runtime_Core_Revision",P("Racc_Runtime_Core_Revision_R")),I(_[0],"Racc_Runtime_Type","ruby"),T(P("Parser"),"$racc_runtime_type",function(){return P("Racc_Runtime_Type")}),w(v,"$_racc_setup",function(){var t,x,n=this,l=r,$=r;return null==S.stderr&&(S.stderr=r),c(s(n.$class(),"Racc_debug_parser"))||(n.yydebug=!1),c(null!=(t=n.yydebug)&&t!==r?"instance-variable":r)||(n.yydebug=!1),c(n.yydebug)&&(c(null!=(x=n.racc_debug_out)&&x!==r?"instance-variable":r)||(n.racc_debug_out=S.stderr),n.racc_debug_out=c(l=n.racc_debug_out)?l:S.stderr),$=s(n.$class(),"Racc_arg"),c(G($.$size(),14))&&$["$[]="](13,!0),$}),w(v,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=r,t.racc_val=r,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),w(v,"$do_parse",function(){return this.$__send__(P("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),w(v,"$next_token",function(){return this.$raise(P("NotImplementedError"),this.$class()+"#next_token is not defined")}),w(v,"$_racc_do_parse_rb",function(t,x){var n,$=this,j=r,Q=r,V=r,ne=r,ue=r,ie=r,ce=r,ae=r;return n=E(t),j=null==n[0]?r:n[0],Q=null==n[1]?r:n[1],V=null==n[2]?r:n[2],ne=null==n[3]?r:n[3],ue=null==n[10]?r:n[10],$.$_racc_init_sysvars(),ie=ce=ae=r,A($,"catch",["racc_end_parse"],function re(){var se,W,g=null==re.$$s?this:re.$$s,J=r;for(null==g.racc_state&&(g.racc_state=r),null==g.racc_read_next&&(g.racc_read_next=r),null==g.racc_t&&(g.racc_t=r),null==g.yydebug&&(g.yydebug=r),null==g.racc_val&&(g.racc_val=r);c(!0);)for(c(ae=ne["$[]"](g.racc_state["$[]"](-1)))?(c(g.racc_read_next)&&D(g.racc_t,0)&&(W=g.$next_token(),se=E(W),ie=null==se[0]?r:se[0],g.racc_val=null==se[1]?r:se[1],g.racc_t=c(ie)?c(J=ue["$[]"](ie))?J:1:0,c(g.yydebug)&&g.$racc_read_token(g.racc_t,ie,g.racc_val),g.racc_read_next=!1),ae=H(ae,g.racc_t),c(M(ae,0))&&c(ce=j["$[]"](ae))&&Y(Q["$[]"](ae),g.racc_state["$[]"](-1))||(ce=V["$[]"](g.racc_state["$[]"](-1)))):ce=V["$[]"](g.racc_state["$[]"](-1));c(ce=g.$_racc_evalact(ce,t)););},{$$s:$})}),w(v,"$yyparse",function(t,x){return this.$__send__(P("Racc_YY_Parse_Method"),t,x,this.$_racc_setup(),!0)}),w(v,"$_racc_yyparse_rb",function(t,x,n,l){var $,Q=this,V=r,ne=r,$e=r,ue=r,ce=r,ae=r,re=r;return $=E(n),V=null==$[0]?r:$[0],ne=null==$[1]?r:$[1],$e=null==$[2]?r:$[2],ue=null==$[3]?r:$[3],ce=null==$[10]?r:$[10],Q.$_racc_init_sysvars(),ae=r,re=r,A(Q,"catch",["racc_end_parse"],function se(){var W=null==se.$$s?this:se.$$s;for(null==W.racc_state&&(W.racc_state=r);!c(re=ue["$[]"](W.racc_state["$[]"](-1)));)for(;c(ae=W.$_racc_evalact($e["$[]"](W.racc_state["$[]"](-1)),n)););return A(t,"__send__",[x],function g(J,Z){var C=null==g.$$s?this:g.$$s,O=r,te=r;for(null==C.racc_t&&(C.racc_t=r),null==C.racc_state&&(C.racc_state=r),null==C.racc_read_next&&(C.racc_read_next=r),null==J&&(J=r),null==Z&&(Z=r),C.racc_t=c(J)?c(O=ce["$[]"](J))?O:1:0,C.racc_val=Z,C.racc_read_next=!1,re=H(re,C.racc_t),c(M(re,0))&&c(ae=V["$[]"](re))&&Y(ne["$[]"](re),C.racc_state["$[]"](-1))||(ae=$e["$[]"](C.racc_state["$[]"](-1)));c(ae=C.$_racc_evalact(ae,n)););for(;c(c(O=c(te=(re=ue["$[]"](C.racc_state["$[]"](-1)))["$!"]())?te:C.racc_read_next["$!"]())?O:C.racc_t["$=="](0));)for(c(re)&&c(re=H(re,C.racc_t))&&c(M(re,0))&&c(ae=V["$[]"](re))&&Y(ne["$[]"](re),C.racc_state["$[]"](-1))||(ae=$e["$[]"](C.racc_state["$[]"](-1)));c(ae=C.$_racc_evalact(ae,n)););},{$$s:W})},{$$s:Q})}),w(v,"$_racc_evalact",function(t,x){var n,$e,$=this,j=r,Q=r,ne=r,ue=r,ie=r,ce=r;if(j=null==(n=E(x))[0]?r:n[0],Q=null==n[1]?r:n[1],ne=null==n[3]?r:n[3],$e=null==n[11]?r:n[11],ue=null==n[12]?r:n[12],c(N(t,0))&&c(G(t,$e)))c(N($.racc_error_status,0))&&(Y($.racc_t,1)||($.racc_error_status=k($.racc_error_status,1))),$.racc_vstack.$push($.racc_val),$.racc_state.$push(t),$.racc_read_next=!0,c($.yydebug)&&($.racc_tstack.$push($.racc_t),$.$racc_shift($.racc_t,$.racc_tstack,$.racc_vstack));else if(c(G(t,0))&&c(N(t,ue["$-@"]()))){if(ie=A($,"catch",["racc_jump"],function ae(){var re=null==ae.$$s?this:ae.$$s;return null==re.racc_state&&(re.racc_state=r),re.racc_state.$push(re.$_racc_do_reduce(x,t)),!1},{$$s:$}),c(ie))switch(ie.valueOf()){case 1:return $.racc_user_yyerror=!0,ue["$-@"]();case 2:return $e;default:$.$raise("[Racc Bug] unknown jump code")}}else if(Y(t,$e))c($.yydebug)&&$.$racc_accept(),$.$throw("racc_end_parse",$.racc_vstack["$[]"](0));else{if(Y(t,ue["$-@"]())){switch($.racc_error_status.valueOf()){case 0:c(x["$[]"](21))||$.$on_error($.racc_t,$.racc_val,$.racc_vstack);break;case 3:Y($.racc_t,0)&&$.$throw("racc_end_parse",r),$.racc_read_next=!0}for($.racc_user_yyerror=!1,$.racc_error_status=3;c(!0)&&!(c(ce=ne["$[]"]($.racc_state["$[]"](-1)))&&(ce=H(ce,1),c(M(ce,0))&&c(t=j["$[]"](ce))&&Y(Q["$[]"](ce),$.racc_state["$[]"](-1))));)c(K($.racc_state.$size(),1))&&$.$throw("racc_end_parse",r),$.racc_state.$pop(),$.racc_vstack.$pop(),c($.yydebug)&&($.racc_tstack.$pop(),$.$racc_e_pop($.racc_state,$.racc_tstack,$.racc_vstack));return t}$.$raise("[Racc Bug] unknown action "+t.$inspect())}return c($.yydebug)&&$.$racc_next_state($.racc_state["$[]"](-1),$.racc_state),r}),w(v,"$_racc_do_reduce",function(t,x){var n,ue,ce,J,Z,C,ee,$=this,Q=r,V=r,ne=r,$e=r,ie=r,ae=r,re=r,se=r,W=r,g=r,O=r,te=r,X=r;return Q=null==(n=E(t))[4]?r:n[4],V=null==n[5]?r:n[5],ne=null==n[6]?r:n[6],$e=null==n[7]?r:n[7],ue=null==n[8]?r:n[8],ie=null==n[9]?r:n[9],ce=null==n[13]?r:n[13],ae=$.racc_state,re=$.racc_vstack,se=$.racc_tstack,W=L(x,-3),g=ie["$[]"](W),J=ie["$[]"](H(W,1)),Z=ie["$[]"](H(W,2)),C=[],c($.yydebug)&&(O=se["$[]"](g["$-@"](),g)),te=re["$[]"](g["$-@"](),g),c($.yydebug)&&se["$[]="](g["$-@"](),g,C),re["$[]="](g["$-@"](),g,C),ae["$[]="](g["$-@"](),g,C),c(ce)?re.$push($.$__send__(Z,te,re,te["$[]"](0))):re.$push($.$__send__(Z,te,re)),se.$push(J),c($.yydebug)&&$.$racc_reduce(O,J,se,re),ee=k(J,ue),c(W=$e["$[]"](ee))&&(W=H(W,ae["$[]"](-1)),c(M(W,0))&&c(X=Q["$[]"](W))&&Y(V["$[]"](W),ee))?X:ne["$[]"](ee)}),w(v,"$on_error",function(t,x,n){var $,l=this;return l.$raise(P("ParseError"),l.$sprintf("\nparse error on value %s (%s)",x.$inspect(),c($=l.$token_to_str(t))?$:"?"))}),w(v,"$yyerror",function(){return this.$throw("racc_jump",1)}),w(v,"$yyaccept",function(){return this.$throw("racc_jump",2)}),w(v,"$yyerrok",a("racc_error_status",0)),w(v,"$racc_read_token",function(t,x,n){var l=this;return l.racc_debug_out.$print("read    "),l.racc_debug_out.$print(x.$inspect(),"(",l.$racc_token2str(t),") "),l.racc_debug_out.$puts(n.$inspect()),l.racc_debug_out.$puts()}),w(v,"$racc_shift",function(t,x,n){var l=this;return l.racc_debug_out.$puts("shift   "+l.$racc_token2str(t)),l.$racc_print_stacks(x,n),l.racc_debug_out.$puts()}),w(v,"$racc_reduce",function(t,x,n,l){var $=this,j=r;return(j=$.racc_debug_out).$print("reduce "),c(t["$empty?"]())?j.$print(" <none>"):A(t,"each",[],function Q(V){return null==V&&(V=r),j.$print(" ",(null==Q.$$s?this:Q.$$s).$racc_token2str(V))},{$$s:$}),j.$puts(" --\x3e "+$.$racc_token2str(x)),$.$racc_print_stacks(n,l),$.racc_debug_out.$puts()}),w(v,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),w(v,"$racc_e_pop",function(t,x,n){var l=this;return l.racc_debug_out.$puts("error recovering mode: pop token"),l.$racc_print_states(t),l.$racc_print_stacks(x,n),l.racc_debug_out.$puts()}),w(v,"$racc_next_state",function(t,x){var n=this;return n.racc_debug_out.$puts("goto    "+t),n.$racc_print_states(x),n.racc_debug_out.$puts()}),w(v,"$racc_print_stacks",function(t,x){var l=r;return(l=this.racc_debug_out).$print("        ["),A(t,"each_index",[],function $(j){return null==j&&(j=r),l.$print(" (",(null==$.$$s?this:$.$$s).$racc_token2str(t["$[]"](j))," ",x["$[]"](j).$inspect(),")")},{$$s:this}),l.$puts(" ]")}),w(v,"$racc_print_states",function(t){var n=r;return(n=this.racc_debug_out).$print("        ["),A(t,"each",[],function($){return null==$&&($=r),n.$print(" ",$)}),n.$puts(" ]")}),w(v,"$racc_token2str",function(t){var n;return c(n=s(this.$class(),"Racc_token_to_s_table")["$[]"](t))?n:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),w(v,"$token_to_str",function(t){return s(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(i[0],i)},Opal.modules["bcdice/arithmetic/node"]=function(e){var a,r,q,u,v,f,p,b,i,F=e.module,B=e.klass,c=e.def,I=e.thrower,T=e.return_ivar,S=e.send2,G=e.find_super,w=e.eqeq,E=e.const_set,A=e.eqeqeq,D=e.rb_divide,H=e.truthy,Y=e.assign_ivar,M=e.alias,N=[],k=e.nil,K=e.$$$;return a=N,r=i=[F(N[0],"BCDice")].concat(a),q=b=[F(i[0],"Arithmetic")].concat(r),f=[F(b[0],"Node")].concat(q),p=e.$r(f),(v=(u=B(f[0],null,"BinaryOp")).$$prototype).lhs=v.rhs=v.op=k,c(u,"$initialize",function(P,U,o){var t=this;return t.lhs=P,t.op=U,t.rhs=o}),c(u,"$eval",function(P){try{I("eval_return");var x,o=this,t=k;return t=o.lhs.$eval(P),x=o.rhs.$eval(P),t.$send(o.op,x)}catch(n){if(n===e.t_eval_return)return n.$v;throw n}}),c(u,"$output",function(){var P=this;return""+P.lhs.$output()+P.op+P.rhs.$output()}),c(u,"$s_exp",function(){var P=this;return"("+P.$op_for_s_exp()+" "+P.lhs.$s_exp()+" "+P.rhs.$s_exp()+")"}),c(u,"$op_for_s_exp",T("op")),function(m,h,u){var v=B(m,h,"DivideBase"),_=[v].concat(u),P=e.$r(_),U=v.$$prototype;U.lhs=U.rhs=U.op=k,c(v,"$initialize",function o(t,x){return o.$$p=null,S(this,G(this,"initialize",o,!1,!0),"initialize",[t,"/",x],null)}),c(v,"$eval",function(t){try{I("eval_return");var l,$,n=this;return l=n.lhs.$eval(t),$=n.rhs.$eval(t),w($,0)&&n.$raise(P("ZeroDivisionError")),n.$divide_and_round(l,$,t)}catch(j){if(j===e.t_eval_return)return j.$v;throw j}}),c(v,"$output",function o(){var t=o.$$p||k,x=this;return o.$$p=null,""+S(x,G(x,"output",o,!1,!0),"output",[],t)+x.$rounding_method()}),v.$private(),c(v,"$rounding_method",function(){return K(this.$class(),"ROUNDING_METHOD")}),c(v,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),c(v,"$divide_and_round",function(t,x,n){return this.$raise(P("NotImplementedError"))})}(f[0],p("BinaryOp"),f),function(m,h,u){var v=B(m,h,"DivideWithGameSystemDefault"),_=[v].concat(u),P=e.$r(_);E(_[0],"ROUNDING_METHOD",""),v.$private(),c(v,"$divide_and_round",function(o,t,x){var n,l=k;return A(K(P("RoundType"),"CEIL"),n=x)?D(o.$to_f(),t).$ceil():A(K(P("RoundType"),"ROUND"),n)?(l=D(o.$to_f(),t),H(l["$negative?"]())?l.$abs().$round()["$-@"]():l.$round()):D(o,t).$floor()})}(f[0],p("DivideBase"),f),function(m,h,u){var v=B(m,h,"DivideWithCeil"),_=[v].concat(u);E(_[0],"ROUNDING_METHOD","C"),v.$private(),c(v,"$divide_and_round",function(U,o,t){return D(U.$to_f(),o).$ceil()})}(f[0],p("DivideBase"),f),function(m,h,u){var v=B(m,h,"DivideWithRound"),_=[v].concat(u);E(_[0],"ROUNDING_METHOD","R"),v.$private(),c(v,"$divide_and_round",function(U,o,t){var x=k;return x=D(U.$to_f(),o),H(x["$negative?"]())?x.$abs().$round()["$-@"]():x.$round()})}(f[0],p("DivideBase"),f),function(m,h,u){var v=B(m,h,"DivideWithFloor"),_=[v].concat(u);E(_[0],"ROUNDING_METHOD","F"),v.$private(),c(v,"$divide_and_round",function(U,o,t){return D(U,o).$floor()})}(f[0],p("DivideBase"),f),function(m,h){var u=B(m,null,"Negative");u.$$prototype.body=k,c(u,"$initialize",Y("body")),c(u,"$eval",function(P){try{return I("eval_return"),this.body.$eval(P)["$-@"]()}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(u,"$output",function(){return"-"+this.body.$output()}),c(u,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(f[0]),function(m,h){var u=B(m,null,"Parenthesis");u.$$prototype.expr=k,c(u,"$initialize",Y("expr")),c(u,"$eval",function(P){try{return I("eval_return"),this.expr.$eval(P)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(u,"$output",function(){return"("+this.expr.$output()+")"}),c(u,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(f[0]),function(m,h){var u=B(m,null,"Number");return u.$$prototype.value=k,c(u,"$initialize",Y("value")),c(u,"$eval",T("value")),c(u,"$output",function(){return this.value.$to_s()}),M(u,"s_exp","output")}(f[0])},Opal.modules.strscan=function(e){var Y,M,N,k,K,B=e.def,c=e.truthy,I=e.eqeqeq,T=e.Opal,S=e.return_ivar,G=e.send,w=e.alias,E=[],A=e.nil;return Y=E,N=[M=(0,e.klass)(E[0],null,"StringScanner")].concat(Y),k=e.$r(N),(K=M.$$prototype).pos=K.string=K.working=K.matched=K.prev_pos=K.match=A,M.$attr_reader("pos","matched"),B(M,"$initialize",function(a){var d=this;return d.string=a,d.pos=0,d.matched=A,d.working=a,d.match=[]}),M.$attr_reader("string"),B(M,"$beginning_of_line?",function(){var a=this;return 0===a.pos||"\n"===a.string.charAt(a.pos-1)}),B(M,"$scan",function(a){var d=this,i=(a=d.$anchor(a)).exec(d.working);return null==i?d.matched=A:(d.prev_pos=d.pos,d.pos+=i[0].length,d.working=d.working.substring(i[0].length),d.matched=i[0],d.match=i,i[0])}),B(M,"$scan_until",function(a){var d=this;a=d.$anchor(a);for(var i=d.working,R=0;i.length!=R;++R){var r=a.exec(i.substr(R));if(null!==r){var s=R+r[0].length,b=i.substr(0,s);return d.matched=r[0],d.match=r,d.prev_pos=d.pos+R,d.pos+=s,d.working=i.substr(s),b}}return d.matched=A}),B(M,"$[]",function(a){var i;if(c(this.match["$empty?"]()))return A;I(k("Symbol"),i=a)?a=a.$to_s():I(k("String"),i)||(a=T["$coerce_to!"](a,k("Integer"),"to_int"));var R=this.match;return a<0&&(a+=R.length),a<0||a>=R.length||null==R[a]?A:R[a]}),B(M,"$check",function(a){var d=this,i=(a=d.$anchor(a)).exec(d.working);return d.matched=null==i?A:i[0]}),B(M,"$check_until",function(a){var d=this,i=d.prev_pos,R=d.pos,r=d.working,s=d.$scan_until(a);return d.prev_pos=i,d.pos=R,d.working=r,s}),B(M,"$peek",function(a){return this.working.substring(0,a)}),B(M,"$eos?",function(){return 0===this.working.length}),B(M,"$exist?",function(a){var i=a.exec(this.working);return null==i?A:0==i.index?0:i.index+1}),B(M,"$skip",function(a){var d=this,i=(a=d.$anchor(a)).exec(d.working);if(null==i)return d.match=[],d.matched=A;var R=i[0],r=R.length;return d.matched=R,d.match=i,d.prev_pos=d.pos,d.pos+=r,d.working=d.working.substring(r),r}),B(M,"$skip_until",function(a){var i=this.$scan_until(a);return i===A?A:(this.matched=i.substr(-1),i.length)}),B(M,"$get_byte",function(){var a=this,d=A;return a.pos<a.string.length?(a.prev_pos=a.pos,a.pos+=1,d=a.matched=a.working.substring(0,1),a.working=a.working.substring(1)):a.matched=A,d}),B(M,"$match?",function(a){var d=this,i=(a=d.$anchor(a)).exec(d.working);return null==i?A:(d.prev_pos=d.pos,i[0].length)}),B(M,"$pos=",function(a){var d=this;return a<0&&(a+=d.string.$length()),d.pos=a,d.working=d.string.slice(a)}),B(M,"$matched_size",function(){return this.matched===A?A:this.matched.length}),B(M,"$post_match",function(){var a=this;return a.matched===A?A:a.string.substr(a.pos)}),B(M,"$pre_match",function(){var a=this;return a.matched===A?A:a.string.substr(0,a.prev_pos)}),B(M,"$reset",function(){var a=this;return a.working=a.string,a.matched=A,a.pos=0}),B(M,"$rest",S("working")),B(M,"$rest?",function(){return 0!==this.working.length}),B(M,"$rest_size",function(){return this.$rest().$size()}),B(M,"$terminate",function(){var a,d=this;return d.match=A,a=[d.string.$length()],G(d,"pos=",a),a[a.length-1]}),B(M,"$unscan",function(){var a=this;return a.pos=a.prev_pos,a.prev_pos=A,a.match=A,a}),w(M,"bol?","beginning_of_line?"),w(M,"getch","get_byte"),M.$private(),B(M,"$anchor",function(a){var d=a.toString().match(/\/([^\/]+)$/);return d=d?d[1]:void 0,new RegExp("^(?:"+a.source+")",d)})},Opal.modules["bcdice/normalize"]=function(e){var w,H,A,F=e.module,B=e.eqeqeq,c=e.def,I=e.eqeq,T=[],S=e.nil;return w=T,A=[F(T[0],"BCDice")].concat(w),(H=F(A[0],"Normalize")).$module_function(),c(H,"$comparison_operator",function(M){var N;return B(/<=|=</,N=M)?"<=":B(/>=|=>/,N)?">=":B(/<>|!=|=!/,N)?"!=":B(/</,N)?"<":B(/>/,N)?">":B(/=/,N)?"==":S}),c(H,"$target_number",function(M){return I(M,"?")?M:M.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var Y,K,R,r,s,b,z,a,N,F=e.module,B=e.klass,c=e.const_set,I=e.hash2,T=e.truthy,S=e.send,G=e.def,w=e.thrower,E=e.top,A=[],D=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),Y=A,K=N=[F(A[0],"BCDice")].concat(Y),R=a=[F(N[0],"Command")].concat(K),s=[r=B(a[0],null,"Lexer")].concat(R),b=e.$r(s),(z=r.$$prototype).scanner=z.notations=D,c(s[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),G(r,"$initialize",function(y,f){var p,m,u;return y=T(u=(p=(m=y)===D||null==m?D:m.$split(" ",2))===D||null==p?D:p.$first())?u:"",this.scanner=b("StringScanner").$new(y),this.notations=S(f,"map",[],function(_){return null==_&&(_=D),T(_["$is_a?"](b("String")))?b("Regexp").$new(_):_})}),G(r,"$next_token",function(){try{var y=w("return"),f=this,p=D,m=D,u=D,v=D;return T(f.scanner["$eos?"]())?[!1,"$"]:(S(f.notations,"each",[],function _(P){var o,U=null==_.$$s?this:_.$$s;if(null==U.scanner&&(U.scanner=D),null==P&&(P=D),o=U.scanner.$scan(P),!T(o))return D;y.$throw(["NOTATION",o])},{$$s:f,$$ret:y}),T(p=f.scanner.$scan(/\d+/))?["NUMBER",p.$to_i()]:T(m=f.scanner.$scan(/[<>!=]+/))?(m=b("Normalize").$comparison_operator(m),[T(m)?"CMP_OP":"ILLEGAL",m]):(u=f.scanner.$getch().$upcase(),[T(v=b("SYMBOLS")["$[]"](u))?v:u.$to_sym(),u]))}catch(_){if(_===y)return _.$v;throw _}}),G(r,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,Y,L,a,d,i,R,N,D,F=e.module,B=e.klass,c=e.def,I=e.return_ivar,T=e.truthy,S=[],G=e.nil;return E=S,Y=D=[F(S[0],"BCDice")].concat(E),L=N=[F(D[0],"Command")].concat(Y),d=[a=B(N[0],null,"Parsed")].concat(L),i=e.$r(d),(R=a.$$prototype).critical=R.fumble=R.dollar=R.modify_number=R.question_target=R.target_number=R.prefix_number=R.command=R.suffix_number=R.cmp_op=G,a.$attr_accessor("command"),a.$attr_accessor("prefix_number"),a.$attr_accessor("suffix_number"),a.$attr_accessor("critical"),a.$attr_accessor("fumble"),a.$attr_accessor("dollar"),a.$attr_accessor("modify_number"),a.$attr_accessor("cmp_op"),a.$attr_accessor("target_number"),a.$attr_writer("question_target"),c(a,"$initialize",function(){var s=this;return s.prefix_number=G,s.suffix_number=G,s.critical=G,s.fumble=G,s.dollar=G,s.cmp_op=G,s.target_number=G,s.question_target=!1}),c(a,"$question_target?",I("question_target")),c(a,"$to_s",function(s){var b=this,z=G,q=G,y=G,f=G,p=G;switch(null==s&&(s="after_command"),z=T(b.critical)?"@"+b.critical:G,q=T(b.fumble)?"#"+b.fumble:G,y=T(b.dollar)?"$"+b.dollar:G,f=i("Format").$modifier(b.modify_number),p=T(b.question_target)?"?":b.target_number,s.valueOf()){case"after_command":return[b.prefix_number,b.command,b.suffix_number,z,q,y,f,b.cmp_op,p].$join();case"after_modify_number":return[b.prefix_number,b.command,b.suffix_number,f,z,q,y,b.cmp_op,p].$join();case"after_target_number":return[b.prefix_number,b.command,b.suffix_number,f,b.cmp_op,p,z,q,y].$join();default:return G}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var s,y,v,x,n,l,$,j,Q,V,ne,$e,ce,_,o,t,se,p,m,z,F=e.klass,B=e.module,c=e.slice,I=e.extract_kwargs,T=e.ensure_kwargs,S=e.get_kwarg,G=e.send2,w=e.find_super,E=e.def,A=e.send,D=e.eqeq,H=e.thrower,Y=e.hash,M=e.const_set,N=e.truthy,k=e.to_ary,K=e.hash2,L=e.top,a=[],d=e.$r(a),i=e.nil,R=e.$$$;return L.$require("racc/parser.rb"),L.$require("bcdice/arithmetic/node"),L.$require("bcdice/command/lexer"),L.$require("bcdice/command/parsed"),F(R(d("BCDice"),"Command"),R(d("Racc"),"Parser"),"Parser"),s=a,y=z=[B(a[0],"BCDice")].concat(s),p=[B(z[0],"Command")].concat(y),m=e.$r(p),v=p,o=[_=F(p[0],R(m("Racc"),"Parser"),"Parser")].concat(v),t=e.$r(o),(se=_.$$prototype).notations=se.lexer=se.modifier=se.suffix_number=se.prefix_number=se.need_suffix_number=se.need_prefix_number=se.critical=se.fumble=se.dollar=se.allowed_cmp_op=se.question_target=i,E(_,"$initialize",function W(g,J){var Z,C,O,te,X=this;return W.$$p=null,Z=c(arguments),C=I(Z),C=T(C),O=Z,te=S(C,"round_type"),G(X,w(X,"initialize",W,!1,!0),"initialize",[],null),X.notations=O,X.round_type=te,X.prefix_number=!1,X.suffix_number=!1,X.need_prefix_number=!1,X.need_suffix_number=!1,X.modifier=!0,X.critical=!1,X.fumble=!1,X.dollar=!1,X.allowed_cmp_op=[i,">=",">","<=","<","==","!="],X.question_target=!1},-2),E(_,"$disable_modifier",function(){return this.modifier=!1,this}),E(_,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(_,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(_,"$has_prefix_number",function(){var g=this;return g.prefix_number=!0,g.need_prefix_number=!0,g}),E(_,"$has_suffix_number",function(){var g=this;return g.suffix_number=!0,g.need_suffix_number=!0,g}),E(_,"$enable_critical",function(){return this.critical=!0,this}),E(_,"$enable_fumble",function(){return this.fumble=!0,this}),E(_,"$enable_dollar",function(){return this.dollar=!0,this}),E(_,"$restrict_cmp_op_to",function(g){var J;return J=c(arguments),this.allowed_cmp_op=J,this},-1),E(_,"$enable_question_target",function(){return this.question_target=!0,this}),E(_,"$parse",function(g){var J=this;try{return J.lexer=t("Lexer").$new(g,J.notations),J.$do_parse()}catch(Z){if(!e.rescue(Z,[t("ParseError"),t("ZeroDivisionError")]))throw Z;try{return i}finally{e.pop_exception()}}}),_.$private(),E(_,"$parsed",function(g,J,Z,C){try{return H("eval_return"),A(t("Parsed").$new(),"tap",[],function ee(X){var _e,le,de,me,ve,fe,be,oe=null==ee.$$s?this:ee.$$s;return null==oe.round_type&&(oe.round_type=i),null==X&&(X=i),X["$command="](g["$[]"]("command")),X["$prefix_number="]((_e=g["$[]"]("prefix"))===i||null==_e?i:_e.$eval(oe.round_type)),X["$suffix_number="]((le=g["$[]"]("suffix"))===i||null==le?i:le.$eval(oe.round_type)),X["$critical="]((de=J["$[]"]("critical"))===i||null==de?i:de.$eval(oe.round_type)),X["$fumble="]((me=J["$[]"]("fumble"))===i||null==me?i:me.$eval(oe.round_type)),X["$dollar="]((ve=J["$[]"]("dollar"))===i||null==ve?i:ve.$eval(oe.round_type)),X["$modify_number="](Z.$eval(oe.round_type)),X["$cmp_op="](C["$[]"]("cmp_op")),D(C["$[]"]("target"),"?")?(X["$question_target="](!0),A(X,"target_number=",fe=[0]),fe[fe.length-1]):(X["$question_target="](!1),fe=[(be=C["$[]"]("target"),be===i||null==be?i:be.$eval(oe.round_type))],A(X,"target_number=",fe),fe[fe.length-1])},{$$s:this})}catch(ee){if(ee===e.t_eval_return)return ee.$v;throw ee}}),E(_,"$next_token",function(){return this.lexer.$next_token()}),x=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),n=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),l=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),$=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),j=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),Q=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),V=[i,6,13,3,9,-1,27,-15,-10,-1,-38],ne=[i,i,i,i,i,i,19,16,15,i,i],$e=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ce=Y(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),M(o[0],"Racc_arg",[x,n,$,l,j,Q,ne,V,19,$e,ce,58,35,!0]),N(t("Ractor","skip_raise")?"constant":i)&&t("Ractor").$make_shareable(t("Racc_arg")),M(o[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),N(t("Ractor","skip_raise")?"constant":i)&&t("Ractor").$make_shareable(t("Racc_token_to_s_table")),M(o[0],"Racc_debug_parser",!1),E(_,"$_reduce_1",function(g,J,Z){var C;return N(this.modifier)||this.$raise(t("ParseError")),C=k(g),this.$parsed(null==C[0]?i:C[0],null==C[1]?i:C[1],null==C[2]?i:C[2],null==C[3]?i:C[3])}),E(_,"$_reduce_2",function(g,J,Z){var C;return N(this.modifier)||this.$raise(t("ParseError")),C=k(g),this.$parsed(null==C[0]?i:C[0],null==C[2]?i:C[2],null==C[1]?i:C[1],null==C[3]?i:C[3])}),E(_,"$_reduce_3",function(g,J,Z){var C,_e;return _e=null==(C=k(g))[2]?i:C[2],this.$parsed(null==C[0]?i:C[0],null==C[1]?i:C[1],R(R(t("Arithmetic"),"Node"),"Number").$new(0),_e)}),E(_,"$_reduce_4",function(g,J,Z){var C=this;return N(C.prefix_number)&&N(C.suffix_number)||C.$raise(t("ParseError")),K(["command","prefix","suffix"],{command:g["$[]"](1),prefix:g["$[]"](0),suffix:g["$[]"](2)})}),E(_,"$_reduce_5",function(g,J,Z){var C=this;return N(C.prefix_number)||C.$raise(t("ParseError")),N(C.need_suffix_number)&&C.$raise(t("ParseError")),K(["command","prefix"],{command:g["$[]"](1),prefix:g["$[]"](0)})}),E(_,"$_reduce_6",function(g,J,Z){var C=this;return N(C.suffix_number)||C.$raise(t("ParseError")),N(C.need_prefix_number)&&C.$raise(t("ParseError")),K(["command","suffix"],{command:g["$[]"](0),suffix:g["$[]"](1)})}),E(_,"$_reduce_7",function(g,J,Z){var C=this;return(N(C.need_prefix_number)||N(C.need_suffix_number))&&C.$raise(t("ParseError")),K(["command"],{command:g["$[]"](0)})}),E(_,"$_reduce_8",function(g,J,Z){return K([],{})}),E(_,"$_reduce_9",function(g,J,Z){var C,_e,ee=i;return ee=null==(C=k(g))[0]?i:C[0],_e=null==C[2]?i:C[2],N(this.critical)&&N(ee["$[]"]("critical")["$nil?"]())||this.$raise(t("ParseError")),ee["$[]="]("critical",_e),ee}),E(_,"$_reduce_10",function(g,J,Z){var C,_e,ee=i;return ee=null==(C=k(g))[0]?i:C[0],_e=null==C[2]?i:C[2],N(this.fumble)&&N(ee["$[]"]("fumble")["$nil?"]())||this.$raise(t("ParseError")),ee["$[]="]("fumble",_e),ee}),E(_,"$_reduce_11",function(g,J,Z){var C,_e,ee=i;return ee=null==(C=k(g))[0]?i:C[0],_e=null==C[2]?i:C[2],N(this.dollar)&&N(ee["$[]"]("dollar")["$nil?"]())||this.$raise(t("ParseError")),ee["$[]="]("dollar",_e),ee}),E(_,"$_reduce_12",function(g,J,Z){return g["$[]"](1)}),E(_,"$_reduce_13",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"Negative").$new(g["$[]"](1))}),E(_,"$_reduce_14",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"BinaryOp").$new(g["$[]"](0),"+",g["$[]"](2))}),E(_,"$_reduce_15",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"BinaryOp").$new(g["$[]"](0),"-",g["$[]"](2))}),E(_,"$_reduce_16",function(g,J,Z){return N(this.allowed_cmp_op["$include?"](i))||this.$raise(t("ParseError")),K([],{})}),E(_,"$_reduce_17",function(g,J,Z){var C,ee,X;return X=null==(C=k(g))[1]?i:C[1],N(this.allowed_cmp_op["$include?"](ee=null==C[0]?i:C[0]))||this.$raise(t("ParseError")),K(["cmp_op","target"],{cmp_op:ee,target:X})}),E(_,"$_reduce_18",function(g,J,Z){var O,C=this;return O=g["$[]"](0),N(C.question_target)||C.$raise(t("ParseError")),N(C.allowed_cmp_op["$include?"](O))||C.$raise(t("ParseError")),K(["cmp_op","target"],{cmp_op:O,target:"?"})}),E(_,"$_reduce_19",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"BinaryOp").$new(g["$[]"](0),"+",g["$[]"](2))}),E(_,"$_reduce_20",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"BinaryOp").$new(g["$[]"](0),"-",g["$[]"](2))}),E(_,"$_reduce_22",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"BinaryOp").$new(g["$[]"](0),"*",g["$[]"](2))}),E(_,"$_reduce_23",function(g,J,Z){return g["$[]"](3).$new(g["$[]"](0),g["$[]"](2))}),E(_,"$_reduce_25",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(_,"$_reduce_26",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_27",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_28",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"DivideWithRound")}),E(_,"$_reduce_29",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"DivideWithFloor")}),E(_,"$_reduce_30",function(g,J,Z){return g["$[]"](1)}),E(_,"$_reduce_31",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"Negative").$new(g["$[]"](1))}),E(_,"$_reduce_33",function(g,J,Z){return g["$[]"](1)}),E(_,"$_reduce_34",function(g,J,Z){return R(R(t("Arithmetic"),"Node"),"Number").$new(g["$[]"](0))}),E(_,"$_reduce_none",function(g,J,Z){return g["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var A,M,L,a,d,i,k,H,F=e.module,B=e.send,c=e.eqeqeq,I=e.truthy,T=e.def,S=e.return_val,G=[],w=e.nil;return A=G,M=H=[F(G[0],"BCDice")].concat(A),L=k=[F(H[0],"Deprecated")].concat(M),d=[a=F(k[0],"Checker")].concat(L),i=e.$r(d),a.$private(),T(a,"$check_result_legacy",function(r,s,b,z){var p,q=this,y=w,f=w,m=w,h=w;return y=B(s,"map",[],"sides".$to_proc()),p=(f=B(s,"map",[],"value".$to_proc())).$sum(),m=c([100],h=y)?q.$check_1D100(r,p,b,z):c([20],h)?q.$check_1D20(r,p,b,z):c([6,6],h)?q.$check_2D6(r,p,f,b,z):w,(I(m["$nil?"]())||I(m["$empty?"]()))&&(m=c([10],h=y.$uniq())?q.$check_nD10(r,p,f,b,z):c([6],h)?q.$check_nD6(r,p,f,b,z):w,I(m["$nil?"]())||I(m["$empty?"]()))?w:i("Result").$new(m.$delete_prefix(" \uff1e "))}),T(a,"$check_1D100",S(w)),T(a,"$check_1D20",S(w)),T(a,"$check_nD10",S(w)),T(a,"$check_2D6",S(w)),T(a,"$check_nD6",S(w))},Opal.modules["bcdice/base"]=function(e){var d,q,h,U,t,x,u,v,_,P,f,F=e.module,B=e.klass,c=e.slice,I=e.rb_plus,T=e.truthy,S=e.def,G=e.regexp,w=e.send,E=e.thrower,A=e.return_ivar,D=e.assign_ivar_val,H=e.eqeqeq,Y=e.eqeq,M=e.return_val,N=e.range,k=e.rb_minus,K=e.rb_divide,L=e.rb_times,a=e.rb_ge,i=e.top,R=[],r=e.$r(R),s=e.nil,b=e.$$$;return i.$require("i18n"),i.$require("i18n/backend/fallbacks"),i.$require("bcdice/randomizer"),i.$require("bcdice/dice_table"),i.$require("bcdice/enum"),i.$require("bcdice/translate"),i.$require("bcdice/result"),i.$require("bcdice/command/parser"),i.$require("bcdice/deprecated/checker"),q=R,h=f=[F(R[0],"BCDice")].concat(q),v=[u=B(f[0],null,"Base")].concat(h),_=e.$r(v),(P=u.$$prototype).raw_input=P.randomizer=P.enabled_upcase_input=P.debug=s,t=[U=e.get_singleton_class(u)].concat(v),x=e.$r(t),U.$attr_reader("prefixes"),S(U,"$register_prefix",function(l){var j,V,Q=this;return null==Q.prefixes&&(Q.prefixes=s),j=c(arguments),Q.prefixes=I(T(V=Q.prefixes)?V:[],j.$flatten())},-1),S(U,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),S(U,"$prefixes_pattern",function(){var l=this,$=s;return null==l.prefixes_pattern&&(l.prefixes_pattern=s),null==l.prefixes&&(l.prefixes=s),l.prefixes_pattern=T($=l.prefixes_pattern)?$:s,T(l.prefixes_pattern)?l.prefixes_pattern:(l.prefixes=T($=l.prefixes)?$:[],l.prefixes.$freeze(),l.prefixes_pattern=(T(l.prefixes["$empty?"]())?/(?!)/:G(["^(S)?(",l.prefixes.$join("|"),")"],"i")).$freeze())}),S(U,"$command_pattern",function(){var l=this,$=s,j=s;return null==l.command_pattern&&(l.command_pattern=s),null==l.prefixes&&(l.prefixes=s),l.command_pattern=T($=l.command_pattern)?$:s,T(l.command_pattern)?l.command_pattern:(l.prefixes=T($=l.prefixes)?$:[],l.prefixes.$freeze(),j=I(w(b(x("CommonCommand"),"COMMANDS"),"map",[],function(V){return null==V&&(V=s),b(V,"PREFIX_PATTERN").$source()}),l.prefixes),l.command_pattern=G(["^S?(",j.$join("|"),")"],"i").$freeze())}),S(U,"$eval",function(l){try{return E("eval_return"),this.$new(l).$eval()}catch(Q){if(Q===e.t_eval_return)return Q.$v;throw Q}}),u.$include(_("Translate")),u.$include(b(_("Deprecated"),"Checker")),S(u,"$initialize",function(o){var t=this;return t.raw_input=o,t.sort_add_dice=!1,t.sort_barabara_dice=!1,t.d66_sort_type=b(_("D66SortType"),"NO_SORT"),t.enabled_d9=!1,t.round_type=b(_("RoundType"),"FLOOR"),t.sides_implicit_d=6,t.upper_dice_reroll_threshold=s,t.reroll_dice_reroll_threshold=s,t.default_cmp_op=s,t.default_target_number=s,t.enabled_upcase_input=!0,t.locale="ja_jp",t.randomizer=b(_("BCDice"),"Randomizer").$new(),t.debug=!1}),u.$attr_accessor("randomizer"),u.$attr_reader("d66_sort_type"),u.$attr_reader("round_type"),u.$attr_reader("sides_implicit_d"),u.$attr_reader("upper_dice_reroll_threshold"),u.$attr_reader("reroll_dice_reroll_threshold"),u.$attr_reader("default_cmp_op"),u.$attr_reader("default_target_number"),S(u,"$sort_add_dice?",A("sort_add_dice")),S(u,"$sort_barabara_dice?",A("sort_barabara_dice")),S(u,"$enabled_d9?",A("enabled_d9")),S(u,"$enable_debug",D("debug",!0)),S(u,"$eval",function(){var t,n,o=this,x=s;return t=b(_("BCDice"),"Preprocessor").$process(o.raw_input,o),x=T(n=o.$dice_command(t))?n:o.$eval_common_command(o.raw_input),T(x)?(x["$rands="](o.randomizer.$rand_results()),x["$detailed_rands="](o.randomizer.$detailed_rand_results()),x):s}),S(u,"$change_text",function(o){return o}),S(u,"$check_result",function(o,t,x,n){var l=this,$=s,j=s,Q=s,V=s,ne=s;return $=l.$check_result_legacy(o,t,x,n),T($)?$:(j=w(t,"map",[],"sides".$to_proc()),V=(Q=w(t,"map",[],"value".$to_proc())).$sum(),$=H([100],ne=j)?l.$result_1d100(o,V,x,n):H([20],ne)?l.$result_1d20(o,V,x,n):H([6,6],ne)?l.$result_2d6(o,V,Q,x,n):s,Y($,_("Result").$nothing())?s:T($)?$:($=H([10],ne=j.$uniq())?l.$result_nd10(o,V,Q,x,n):H([6],ne)?l.$result_nd6(o,V,Q,x,n):s,Y($,_("Result").$nothing())?s:T($)?$:l.$result_ndx(o,x,n)))}),S(u,"$grich_text",M(s)),u.$private(),S(u,"$eval_common_command",function(o){try{E("eval_return");var x=E("return");return o=this.$change_text(o),w(b(_("CommonCommand"),"COMMANDS"),"each",[],function l($){var Q,j=null==l.$$s?this:l.$$s;if(null==j.randomizer&&(j.randomizer=s),null==$&&($=s),Q=$.$eval(o,j,j.randomizer),!T(Q))return s;x.$throw(Q)},{$$s:this,$$ret:x}),s}catch(l){if(l===e.t_eval_return||l===x)return l.$v;throw l}}),S(u,"$dice_command",function(o){var t=this,x=s,n=s,l=s,$=s;return T(t.enabled_upcase_input)&&(o=o.$upcase()),x=t.$class().$prefixes_pattern().$match(o),T(x)?(n=x["$[]"](1)["$nil?"]()["$!"](),T(n)&&(o=o["$[]"](N(1,-1,!1))),l=t.$eval_game_system_specific_command(o),T(l["$is_a?"](_("Result")))?(l["$secret="](T($=l["$secret?"]())?$:n),l):T(l["$nil?"]())||T(l["$empty?"]())||Y(l,"1")?s:w(_("Result").$new(),"tap",[],function(Q){var V;return null==Q&&(Q=s),Q["$text="](l.$to_s()),w(Q,"secret=",V=[n]),V[V.length-1]})):s}),S(u,"$eval_game_system_specific_command",M(s)),S(u,"$result_ndx",function(o,t,x){return T(x["$is_a?"](_("String")))?s:T(o.$send(t,x))?_("Result").$success(this.$translate("success")):_("Result").$failure(this.$translate("failure"))}),S(u,"$result_1d100",M(s)),S(u,"$result_1d20",M(s)),S(u,"$result_nd10",M(s)),S(u,"$result_2d6",M(s)),S(u,"$result_nd6",M(s)),S(u,"$get_table_by_2d6",function(o){return this.$get_table_by_nD6(o,2)}),S(u,"$get_table_by_1d6",function(o){return this.$get_table_by_nD6(o,1)}),S(u,"$get_table_by_nD6",function(o,t){return this.$get_table_by_nDx(o,t,6)}),S(u,"$get_table_by_nDx",function(o,t,x){var l,$=s;return l=this.randomizer.$roll_sum(t,x),$=this.$get_table_value(o["$[]"](k(l,t))),T($["$nil?"]())?["1",0]:[$,l]}),S(u,"$get_table_by_1d3",function(o){var n,l,t=this,$=s;return t.$debug("get_table_by_1d3"),n=t.randomizer.$roll_sum(1,6),t.$debug("num",n),l=K(k(n,1),2).$to_i(),t.$debug("index",l),$=o["$[]"](l),T($["$nil?"]())?["1",0]:[$,n]}),S(u,"$get_table_by_d66_swap",function(o){var x;return x=this.randomizer.$roll_d66(b(_("D66SortType"),"ASC")),[this.$get_table_by_number(x,o),x]}),S(u,"$get_table_by_d66",function(o){var x,n,l,j,$=s;return x=this.randomizer.$roll_once(6),n=this.randomizer.$roll_once(6),l=I(L(k(x,1),6),k(n,1)),$=o["$[]"](l),j=""+x+n,T($["$nil?"]())?["1",j]:[$,j]}),S(u,"$get_table_by_number",function(o,t,x){try{var n=E("return");return null==x&&(x="1"),w(t,"each",[],function $(j){var V,Q=null==$.$$s?this:$.$$s;if(null==j&&(j=s),V=j["$[]"](0),!T(a(V,o)))return s;n.$throw(Q.$get_table_value(j["$[]"](1)))},{$$s:this,$$ret:n}),this.$get_table_value(x)}catch($){if($===n)return $.$v;throw $}},-3),S(u,"$get_table_value",function(o){return T(o["$is_a?"](_("Proc")))?o.$call():o}),S(u,"$roll_tables",function(o,t){var n=s;return n=t["$[]"](o),T(n)?n.$roll(this.randomizer).$to_s():s}),S(u,"$debug",function(o,t){var n,l=this,$=s,j=s;return n=c(arguments,1),T(l.debug)?($=T(o["$is_a?"](_("String")))?o:o.$inspect(),T(n["$empty?"]())?l.$warn($):(j=w(n,"map",[],function(V){return null==V&&(V=s),T(V["$is_a?"](_("String")))?'"'+V+'"':V.$inspect()}),l.$warn($+": "+j.$join(", ")))):s},-2),b(b(r("I18n"),"Backend"),"Simple").$include(b(b(r("I18n"),"Backend"),"Fallbacks")),r("I18n").$load_path()["$<<"](r("Dir")["$[]"](r("File").$join("bcdice","../../i18n/**/*.yml"))),r("I18n")["$default_locale="]("ja_jp"),d=[["ja_jp"]],w(r("I18n").$fallbacks(),"defaults=",d),d[d.length-1]},Opal.modules["bcdice/game_system/DesperateRun"]=function(e){var i,b,m,h,u,v,q,y,r,F=e.module,B=e.klass,c=e.const_set,I=e.hash2,T=e.send2,S=e.find_super,G=e.def,w=e.truthy,E=e.to_ary,A=e.rb_plus,D=e.range,H=e.neqeq,Y=e.eqeq,M=e.rb_ge,N=e.rb_minus,K=[],L=e.nil,a=e.$$$;return e.top.$require("bcdice/base"),i=K,b=r=[F(K[0],"BCDice")].concat(i),q=[F(r[0],"GameSystem")].concat(b),y=e.$r(q),m=q,u=[h=B(q[0],y("Base"),"DesperateRun")].concat(m),v=e.$r(u),h.$$prototype.randomizer=L,c(u[0],"ID","DesperateRun"),c(u[0],"NAME","Desperate Run TRPG"),c(u[0],"SORT_KEY","\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG"),c(u[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868\u3000ACT\n\u30fb\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868\u3000ITEMT\n\u30fb\u52d5\u6a5f\u8868\u3000DOUKIT\n\u30fb\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868\u3000FLAGT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868\u3000ENTRYT\n\u30fb\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3000ROADT\n"),c(u[0],"TABLES",I(["ACT","ITEMT","DOUKIT","FLAGT","ENTRYT","ROADT"],{ACT:a(v("DiceTable"),"Table").$new("\u30a2\u30af\u30b7\u30c7\u30f3\u30c8\u8868","1D6",["PC\u5168\u54e1\u3001\u968a\u5217\u30921D6\u3067\u6c7a\u3081\u308b\uff0812\uff1a\u524d\u5217\u300134\uff1a\u4e2d\u5217\u300156\uff1a\u5f8c\u5217\uff09","1\u30bf\u30fc\u30f3\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u5074\u306e\u307f\u884c\u52d5\u3059\u308b\u3002","\u3053\u306e\u6226\u95d8\u306e\u884c\u52d5\u9806\u304c\u3001PC\u2192\u30e2\u30f3\u30b9\u30bf\u30fc\u3001\u304b\u3089\u3001\u30e2\u30f3\u30b9\u30bf\u30fc\u2192PC\u306b\u5909\u308f\u308b\u3002","PC\u5168\u54e1\u3001\u30a2\u30a4\u30c6\u30e01\u3064\u3092\u9078\u3093\u3067\u5931\u3046\u3002","PC\u5168\u54e11D6\u3092\u632f\u308b\u3002\u3053\u306e\u6226\u95d8\u4e2d\u3001\u305d\u306e\u51fa\u76ee\u306f\u30ce\u30fc\u30d7\u30e9\u30f3\u306b\u306a\u308b\u3002","PC\u5168\u54e1\u3001Flag\u304c1\u5897\u52a0\u3059\u308b\u3002"]),ITEMT:a(v("DiceTable"),"Table").$new("\u521d\u671f\u30a2\u30a4\u30c6\u30e0\u8868","2D6",["\u30ed\u30b1\u30c3\u30c8\u30e9\u30f3\u30c1\u30e3\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30de\u30ab\u30d6\u30ebLv+3\u3000\u56de\u6570\uff1a\u653b\u64831\u56de","\u30ad\u30fc\u30d4\u30c3\u30af\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002\u5224\u5b9a\u306e\u51fa\u76ee\u306e\u5408\u8a08+1\u3000\u56de\u6570\uff1a2\u56de","\u30ec\u30fc\u30c0\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ce\u30fc\u30d7\u30e9\u30f3\u3000\u88c5\u5099\u6642\u3001\u300c\u5371\u967a\u300d\u30921\u6e1b\u3089\u3059\u3053\u3068\u304c\u51fa\u6765\u308b\u3000\u56de\u6570\uff1a\u5371\u967a\u6e1b\u5c112\u56de","\u98df\u6599\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30e0\u30fc\u30d6\u30b7\u30fc\u30f3\u3067\u4f7f\u7528\u53ef\u3002Life3\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u5fdc\u6025\u30ad\u30c3\u30c8\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30e1\u30c7\u30a3\u30ab\u30ebLv+1\u3000\u56de\u6570\uff1a\u56de\u5fa93\u56de","\u5203\u7269\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30a2\u30bf\u30c3\u30afLv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u9283\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30b7\u30e5\u30fc\u30c8Lv+1\u3000\u56de\u6570\uff1a\u653b\u64836\u56de","\u30c9\u30e9\u30c3\u30b0\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u3044\u3064\u3067\u3082\u4f7f\u7528\u53ef\u3002Brave1\u56de\u5fa9\u3000\u56de\u6570\uff1a1\u56de","\u91d1\u5238\u3000\u52b9\u679c\uff1a\uff08\u6d88\u8cbb\uff09\u30a2\u30d5\u30bf\u30fc\u30d7\u30ec\u30a4\u3067\u4f7f\u7528\u53ef\u3002\u7d4c\u9a13\u70b9+2\u3000\u56de\u6570\uff1a1\u56de","\u30d7\u30ed\u30c6\u30af\u30bf\u30fc\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30ac\u30fc\u30c9Lv+1\u3000\u56de\u6570\uff1a\u9632\u5fa15\u56de","\u30c8\u30df\u30fc\u30ac\u30f3\u3000\u52b9\u679c\uff1a\uff08\u88c5\u5099\uff09\u30c1\u30a7\u30fc\u30f3Lv+5\u3000\u56de\u6570\uff1a\u653b\u64831\u56de"]),DOUKIT:a(v("DiceTable"),"Table").$new("\u52d5\u6a5f\u8868","1D6",["\u96b7\u5c5e\u3002\u4f55\u304b\u5f31\u307f\u306b\u4ed8\u3051\u8fbc\u307e\u308c\u3001\u5acc\u3005\u306a\u304c\u3089\u3082\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u308b\u3002\u5f8c\u308d\u3081\u305f\u3044\u4e8b\u3001\u501f\u91d1\u3001\u306a\u3069\u3002","\u732e\u8eab\u3002\u3053\u306e\u756a\u7d44\u306f\u8ab0\u304b\u306e\u305f\u3081\u306b\u51fa\u3066\u3044\u308b\u3002\u75c5\u6c17\u306e\u5bb6\u65cf\u3092\u6551\u3046\u305f\u3081\u3001\u53c2\u52a0\u8005\u306e\u4e00\u4eba\u304c\u604b\u4eba\u3067\u3042\u308b\u3001\u306a\u3069\u3002","\u6210\u884c\u3002\u671b\u3093\u3067\u3044\u306a\u3044\u306e\u306b\u53c2\u52a0\u3059\u308b\u3053\u3068\u3068\u306a\u3063\u3066\u3057\u307e\u3063\u305f\u3002\u8ab0\u304b\u304c\u52dd\u624b\u306b\u7533\u3057\u8fbc\u3093\u3060\u3001\u7d1b\u308c\u8fbc\u3093\u3067\u3057\u307e\u3063\u305f\u3001\u306a\u3069\u3002","\u6e07\u671b\u3002\u3068\u306b\u304b\u304f\u4f55\u304b\u3092\u6b32\u3057\u3066\u53c2\u52a0\u3057\u3066\u3044\u308b\u3002\u91d1\u3001\u30b9\u30ea\u30eb\u3001\u91d1\u3067\u624b\u306b\u5165\u308b\u3082\u306e\u3001\u306a\u3069\u3002","\u5947\u4eba\u3002\u597d\u304d\u597d\u3093\u3067\u3053\u306e\u756a\u7d44\u306b\u51fa\u3066\u3044\u308b\u3002\u6bba\u4eba\u7656\u3001\u30ca\u30eb\u30b7\u30b9\u30c8\u3001\u81ea\u6bba\u9858\u671b\u3001\u5316\u3051\u7269\u30de\u30cb\u30a2\u3001\u306a\u3069\u3002","\u4ed5\u4e8b\u3002\u3053\u306e\u756a\u7d44\u306b\u51fa\u308b\u306e\u306f\u4ed5\u4e8b\u3060\u304b\u3089\u3060\u3002\u8cde\u91d1\u7a3c\u304e\u3001\u82b8\u80fd\u4eba\u3001\u8a18\u8005\u3001\u756a\u7d44\u30b9\u30bf\u30c3\u30d5\u3001\u306a\u3069\u3002"]),FLAGT:a(v("DiceTable"),"Table").$new("\u6b7b\u4ea1\u30d5\u30e9\u30b0\u53f0\u8a5e\u8868","1D6",["\u5e0c\u671b\u3002\u300c\u3053\u308c\u304c\u7d42\u308f\u3063\u305f\u3089\u3001\u4e00\u7dd2\u306b\u9152\u3067\u3082\u98f2\u3082\u3046\u3084\u300d\u300c\u3082\u3046\u4f55\u3082\u6016\u304f\u306a\u3044\u300d\u306a\u3069\u3002","\u671b\u90f7\u3002\u300c\u304f\u305d\u3063\u3001\u3001\u3001\u4ffa\u306b\u306f\u3001\u5e30\u308a\u3092\u5f85\u3064\u4eba\u304c\u3001\u3001\u3001\u3063\uff01\u300d\u300c\u3042\u3042\u3001\u6545\u90f7\u306e\u30de\u30eb\u30b2\u30ea\u30fc\u30bf\u3092\u3082\u3046\u4e00\u5ea6\u98df\u3079\u305f\u304b\u3063\u305f\u3001\u3001\u3001\u300d\u306a\u3069\u3002","\u72c2\u4e71\u3002\u300c\u304a\u524d\u3092\u3001\u6bba\u305b\u3070\u3001\u4ffa\u306f\u3001\u5104\u4e07\u9577\u8005\u306a\u3093\u3060\u3088\u3049\u3049\u3049\u304a\uff01\uff01\u300d\u300c\u30d2\u30cf\u30c3\u3001\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u6b7b\u306d\u3047\u3047\u3047\u3047\u300d\u306a\u3069\u3002","\u7d76\u671b\u3002\u300c\u3082\u3046\u3060\u3081\u3060\u3041\u3001\u3001\u3001\u304a\u3057\u307e\u3044\u3060\u3041\u3001\u3001\u3001\u300d\u300c\u304f\u3001\u304f\u308b\u306a\u3063\u3001\u304f\u308b\u306a\u3041\u3041\u3041\u3041\uff01\uff01\u300d\u306a\u3069\u3002","\u6162\u5fc3\u3002\u300c\u306a\u3093\u3060\u3001\u3053\u3093\u306a\u3084\u3064\u3001\u4ffa\u3060\u3051\u3067\u5341\u5206\u3060\u300d\u300c\u5927\u4e08\u592b\u3060\u3001\u554f\u984c\u306a\u3044\u300d\u306a\u3069\u3002","\u72a0\u7272\u3002\u300c\u3075\u3075\u3001\u4ffa\u306a\u3089\u5927\u4e08\u592b\u3060\u3001\u3001\u3001\u6c17\u306b\u3059\u308b\u306a\u300d\u300c\u304a\u524d\u3089\u4e0b\u304c\u308c\u3063\uff01\u3053\u3053\u306f\u4ffa\u306b\u4efb\u305b\u308d\uff01\u300d\u306a\u3069\u3002"]),ENTRYT:a(v("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u52d5\u6a5f\u8868","1D6",["\u9045\u523b\u3002\u3082\u3068\u3082\u3068\u53c2\u52a0\u3059\u308b\u4e88\u5b9a\u3060\u3063\u305f\u306e\u3060\u304c\u9045\u308c\u3066\u3057\u307e\u3063\u305f\u3002\u4eca\u304b\u3089\u3067\u3082\u8d70\u308c\u3068\u7121\u7406\u77e2\u7406\u53c2\u52a0\u3002","\u73fe\u4f4f\u3002\u3082\u3068\u3082\u3068\u3053\u3053\u306b\u4f4f\u3093\u3067\u3044\u305f\u3002\u4f55\uff1f\u756a\u7d44\uff1f\u3048\uff1f\u3042\u3001\u304a\u91d1\u3082\u3089\u3048\u3093\u306e\uff1f\u30a4\u30a4\u30cd\uff01","\u7a81\u767a\u3002\u3082\u3068\u3082\u3068\u8996\u8074\u8005\u3068\u3057\u3066\u30b9\u30bf\u30b8\u30aa\u306b\u5c45\u305f\u3093\u3060\u3051\u3069\u3001\u53f8\u4f1a\u306b\u3046\u307e\u304f\u4e57\u305b\u3089\u308c\u3066\u30fb\u30fb\u30fb","\u4e71\u5165\u3002\u4f55\u304b\u76ee\u7684\u304c\u3042\u3063\u3066\u4e71\u5165\u3057\u305f\u3002\u4eca\u56de\u306e\u30b9\u30c6\u30fc\u30b8\u304c\u7c21\u5358\u306b\u898b\u3048\u305f\u308a\u3001\u53c2\u52a0\u8005\u306b\u5927\u4e8b\u306a\u4eba\u304c\u3044\u305f\u306e\u304b\u3082\u3057\u308c\u306a\u3044\u3002","\u795e\u96a0\u3002\u4eca\u56de\u3088\u308a\u524d\u306e\u756a\u7d44\u306b\u53c2\u52a0\u3057\u3066\u3044\u305f\u304c\u884c\u65b9\u4e0d\u660e\u30fb\u6b7b\u3093\u3060\u3068\u601d\u308f\u308c\u3066\u3044\u305f\u3002\u304c\u3002\u541b\u306f\u307e\u3060\u3053\u3053\u306b\u3044\u308b\u3002","\u8077\u54e1\u3002\u3042\u308c\u3001\u9003\u3052\u9045\u308c\u307e\u3057\u305f\uff1f\u3042\u3089\u3042\u3089\u3001\u5927\u5909\u3067\u3059\u306d\u3001\u3057\u3087\u3046\u304c\u306a\u3044\u304b\u3089\u53c2\u52a0\u8005\u3055\u3093\u3068\u4e00\u7dd2\u306b\u8d70\u3063\u3066\u304f\u3060\u3055\u3044\u3002"]),ROADT:a(v("DiceTable"),"Table").$new("\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868","1D6",["\u6b7b\u7dda\u3002\u6b7b\u306c\u304b\u3068\u601d\u3063\u305f\u3002Flag+1","\u602a\u6211\u3002\u75db\u3044\u3002Life-1","\u5931\u610f\u3002\u3069\u3046\u3057\u3066\u3053\u3046\u306a\u3063\u305f\u3002Brave-1\u3002\u6e1b\u3089\u305b\u306a\u3044\u5834\u5408\u3001Flag+1","\u7d1b\u5931\u3002\u3069\u3063\u304b\u3044\u3063\u305f\u3002Item\u3092\u3069\u308c\u304b1\u3064\u6368\u3066\u308b\u3002\u6368\u3066\u308c\u306a\u3044\u5834\u5408\u3001Flag+1","\u8ffd\u5c3e\u3002\u5f8c\u308d\uff01\u5f8c\u308d\u30fc\u3063\uff01\u53c2\u52a0\u958b\u59cb\u90e8\u5c4b\u306e\u5371\u967a+1","\u8ff7\u5b50\u3002\u3042\u308c\u3001\u3053\u3053\u3069\u3053\u3060\uff1f\u9014\u4e2d\u53c2\u52a0\u9053\u4e2d\u8868\u3092\u632f\u308b\u56de\u6570+2"])}).$freeze()),h.$register_prefix("RC","DDC",v("TABLES").$keys()),G(h,"$initialize",function P(U){var t=this;return P.$$p=null,T(t,S(t,"initialize",P,!1,!0),"initialize",[U],null),t.sort_add_dice=!0,t.d66_sort_type=a(v("D66SortType"),"ASC")}),h.$private(),G(h,"$eval_game_system_specific_command",function(U){var t,x,o=this;return w(t=w(x=o.$check_roll(U))?x:o.$ddc_table(U))?t:o.$roll_tables(U,a(o.$class(),"TABLES"))}),G(h,"$check_roll",function(U){var o,t,l=L,$=L,j=L,Q=L,V=L,ne=L,$e=L,ue=L,ie=L;return l=a(v("Command"),"Parser").$new(/RC\d+/,I(["round_type"],{round_type:this.$round_type()})).$restrict_cmp_op_to(L).$parse(U),w(l)?(t=this.randomizer.$roll_barabara(2,6),o=E(t),Q=A($=null==o[0]?L:o[0],j=null==o[1]?L:o[1]),V=A(A($,j),l.$modify_number()),ne=l.$command()["$[]"](D(2,-1,!1)).$to_i(),H(l.$modify_number(),0)&&($e="\u3000\u4fee\u6b63\u5024\uff1a"+l.$modify_number()),ie=["\u5224\u5b9a\u3000\u96e3\u6613\u5ea6\uff1a"+ne+$e,"\u51fa\u76ee\uff1a"+$+"\u3001"+j,(ue=Y($,j)?v("Result").$critical("\u30be\u30ed\u76ee\uff01\u3010Critical\u3011"):Y(Q,7)?v("Result").$fumble("\u30c0\u30a4\u30b9\u306e\u51fa\u76ee\u304c\u8868\u88cf\uff01\u3010Fumble\u3011"):w(M(V,ne))?v("Result").$success(V+"\u3001\u96e3\u6613\u5ea6\u4ee5\u4e0a\uff01\u3010Success\u3011"):v("Result").$failure(V+"\u3001\u96e3\u6613\u5ea6\u672a\u6e80\uff01\u3010Miss\u3011")).$text()],ue["$text="](ie.$join(" \uff1e ")),ue):L}),G(h,"$ddc_table",function(U){var o,t,n=L,l=L,$=L,j=L,Q=L;return H(U,"DDC")?L:(t=this.randomizer.$roll_barabara(2,6),t=[n=null==(o=E(t))[0]?L:o[0],l=null==o[1]?L:o[1]].$sort(),"\u96e3\u6613\u5ea6\u6c7a\u5b9a \uff1e \u51fa\u76ee\uff1a"+n+"\u3001"+l+" \uff1e "+(j=null==(o=E(t))[1]?L:o[1])+"-"+($=null==o[0]?L:o[0])+"="+(Q=N(j,$))+" \uff1e \u96e3\u6613\u5ea6"+A(5,Q))})},Opal.queue(function(e){var A,M,d,i,R,r,k,K,H,F=e.module,B=e.klass,c=e.const_set,I=e.hash2,S=[],w=e.$$$;return e.top.$require("bcdice/game_system/DesperateRun"),A=S,M=H=[F(S[0],"BCDice")].concat(A),k=[F(H[0],"GameSystem")].concat(M),K=e.$r(k),d=k,R=[i=B(k[0],K("DesperateRun"),"JekyllAndHyde")].concat(d),r=e.$r(R),c(R[0],"ID","JekyllAndHyde"),c(R[0],"NAME","\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9"),c(R[0],"SORT_KEY","\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089"),c(R[0],"HELP_MESSAGE","\u30fb\u96e3\u6613\u5ea6\u7b97\u51fa\u30b3\u30de\u30f3\u30c9\u3000DDC\n\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\u3000RCx\u3000or\u3000RCx+y\u3000or\u3000RCx-y\uff08x\uff1d\u96e3\u6613\u5ea6\u3001y=\u4fee\u6b63\u5024\uff08\u7701\u7565\u53ef\u80fd\uff09\uff09\n\u30fb\u76ee\u6a19\u6c7a\u5b9a\u8868\u3000GOALT\n"),c(R[0],"TABLES",I(["GOALT"],{GOALT:w(r("DiceTable"),"Table").$new("\u76ee\u6a19\u6c7a\u5b9a\u8868","1D6",["\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d","\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d","\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u9054\u6210\u300d\u300c\u4e3b\u4eba\u683c\u306e\u76ee\u7684\u963b\u5bb3\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30cf\u30c3\u30d4\u30fc\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u306a\u304f\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u4e3b\u4eba\u683c\u306e\u30d0\u30c3\u30c9\u30a8\u30f3\u30c9\uff08\u76ee\u7684\u9054\u6210\u3057\u3066\u3044\u3066\u3082\u3088\u3044\uff09\u300d\u300c\u81ea\u5206\u306e\u4eba\u683c\u304c\u76ee\u7684\u3092\u6c7a\u5b9a\u3067\u304d\u308b\u300d\u306e\u3069\u308c\u304b\u3092\u81ea\u7531\u306b\u9078\u3079\u308b"])}).$freeze()),i.$register_prefix("RC","DDC",r("TABLES").$keys())})}}]);