(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[855],{5826:(ae,oe,Y)=>{Y(5151),Opal.queue(function(s){var ee,ne,_e,i,t,E,N,$,V,F,ie,O,q=s.module,H=s.klass,S=s.const_set,K=s.send2,J=s.find_super,A=s.def,v=s.truthy,Q=s.hash,U=s.rb_le,X=s.rb_ge,x=s.eqeq,g=s.not,G=s.thrower,y=s.eqeqeq,M=s.to_ary,B=s.rb_minus,h=s.rb_plus,z=s.send,w=s.rb_gt,j=s.neqeq,Z=s.rb_divide,p=s.rb_times,W=[],e=s.nil,d=s.$$$;return ee=W,ne=O=[q(W[0],"BCDice")].concat(ee),F=[q(O[0],"GameSystem")].concat(ne),ie=s.$r(F),_e=F,N=[E=H(F[0],ie("Base"),"ArknightsFan")].concat(_e),$=s.$r(N),(V=E.$$prototype).round_type=V.randomizer=e,S(N[0],"ID","ArknightsFan"),S(N[0],"NAME","\u30a2\u30fc\u30af\u30ca\u30a4\u30c4TRPG by daaaper"),S(N[0],"SORT_KEY","\u3042\u3042\u304f\u306a\u3044\u3064TRPG\u306f\u3044\u3066\u3048\u306f\u3042"),S(N[0],"HELP_MESSAGE","\u25a0 \u80fd\u529b\u5024\u5224\u5b9a (nADm<=x)\n  nDm\u306e\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3092\u3057\u3066\u3001\u51fa\u76ee\u304c x \u4ee5\u4e0b\u3067\u3042\u308c\u3070\u6210\u529f\u3002\n  \u51fa\u76ee\u304c91\u4ee5\u4e0a\u3067\u30a8\u30e9\u30fc\u3002\n  \u51fa\u76ee\u304c10\u4ee5\u4e0b\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3002\n\n\u25a0 \u653b\u6483/\u9632\u5fa1\u5224\u5b9a (nABm<=x)\n  nBm\u306e\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3092\u3057\u3066\u3001\n    \u51fa\u76ee\u304c x \u4ee5\u4e0b\u3067\u3042\u308c\u3070\u6210\u529f\u6570+1\u3002\n    \u51fa\u76ee\u304c91\u4ee5\u4e0a\u3067\u30a8\u30e9\u30fc\u3002\u6210\u529f\u6570-1\u3002\n    \u51fa\u76ee\u304c10\u4ee5\u4e0b\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3002\u6210\u529f\u6570+1\u3002\n  \u4e0a\u8a18\u306b\u3088\u308b\u6210\u529f\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3002\n\n\u25a0 \u5f79\u8077\u52b9\u679c\u4ed8\u304d\u653b\u6483\u5224\u5b9a (nABm<=x--\u5f79\u8077\u540dh)\n  h: \u5065\u5eb7\u72b6\u614b(0: \u5065\u5eb7\u30011: \u4e2d\u7b49\u75c7\u30012: \u91cd\u75c7)\n  nBm\u306e\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3092\u3057\u3066\u3001\n    \u51fa\u76ee\u304c x \u4ee5\u4e0b\u3067\u3042\u308c\u3070\u6210\u529f\u6570+1\u3002\n    \u51fa\u76ee\u304c91\u4ee5\u4e0a\u3067\u30a8\u30e9\u30fc\u3002\u6210\u529f\u6570-1\u3002\n    \u51fa\u76ee\u304c10\u4ee5\u4e0b\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3002\u6210\u529f\u6570+1\u3002\n  \u4e0a\u8a18\u306b\u3088\u308b\u6210\u529f\u6570\u3092\u30ab\u30a6\u30f3\u30c8\u3057\u305f\u4e0a\u3067\u3001\u4ee5\u4e0b\u306e\u5f79\u8077\u540d\u306b\u3088\u308b\u6210\u529f\u6570\u5897\u52a0\u52b9\u679c\u3092\u9069\u5fdc\u3002\n    \u72d9\u6483\uff08SNI\uff09: \u5065\u5eb7(h=0)\u304b\u3064\u6210\u529f\u65701\u4ee5\u4e0a\u306e\u3068\u304d\u3001\u6210\u529f\u6570+1\u3002\n  \u5065\u5eb7\u72b6\u614bh\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u3001\u5065\u5eb7(h=0)\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002\n\n\u25a0 \u9271\u77f3\u75c5\u5224\u5b9a (ORPx@y+Dd+Tt)\n  x: \u751f\u7406\u7684\u8010\u6027\u3001y: \u4e0a\u6607\u5f8c\u4fb5\u98df\u5ea6\u3001d: \u30c0\u30a4\u30b9\u88dc\u6b63\u3001t: \u5224\u5b9a\u5024\u88dc\u6b63\n  \u751f\u7406\u7684\u8010\u6027x\u306eOP\u304c\u4fb5\u98df\u5ea6y\u306b\u4e0a\u6607\u3057\u305f\u969b\u306e\u9271\u77f3\u75c5\u5224\u5b9a\u3092\u3001\u30c0\u30a4\u30b9\u6570\u88dc\u6b63d\u3001\u5224\u5b9a\u5024\u88dc\u6b63t\u3067\u884c\u3046\u3002\n  \u30c0\u30a4\u30b9\u6570\u88dc\u6b63\u3068\u5224\u5b9a\u5024\u88dc\u6b63\u306f\u7701\u7565\u53ef\u80fd\u3002\u4f8b\u3048\u3070 ORP60@25 \u306f ORP60@25+D0+T0 \u3068\u540c\u7fa9\u3002\n  \u307e\u305f\u3001\u30c0\u30a4\u30b9\u6570\u88dc\u6b63\u3068\u5224\u5b9a\u5024\u88dc\u6b63\u306f\u9006\u9806\u3067\u3082\u53ef\u3002\u4f8b\u3048\u3070 ORP60@25+T10+D2 \u3082\u53ef\u3002\n\n\u25a0 \u5897\u60aa\u5224\u5b9a\uff08--WORSENING\uff09\n  \u75c7\u72b6\u3092\u300c\u672b\u68a2\u795e\u7d4c\u969c\u5bb3\u300d\u300c\u5185\u81d3\u6a5f\u80fd\u4e0d\u5168\u300d\u300c\u7cbe\u795e\u75c7\u72b6\u300d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u629e\u3002\n  \u7d99\u7d9a\u30e9\u30a6\u30f3\u30c9\u6570\u30921d6+1\u3067\u5224\u5b9a\u3002\n\n\u25a0 \u4e2d\u6bd2\u5224\u5b9a\uff08--ADDICTION\uff09\n  \u75c7\u72b6\u3092\u300c\u8133\u795e\u7d4c\u969c\u5bb3\u300d\u300c\u591a\u81d3\u5668\u4e0d\u5168\u300d\u300c\u6025\u6027\u7cbe\u795e\u53cd\u5fdc\u300d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b\u9078\u629e\u3002\n\n\u25a0 \u5224\u5b9a\u306e\u7701\u7565\u8868\u8a18\n  nADm\u3001nABm\u3001nABm\u306b\u304a\u3044\u3066\u3001\n    n\uff08\u30c0\u30a4\u30b9\u500b\u6570\uff09\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u30011\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002\n    m\uff08\u30c0\u30a4\u30b9\u7a2e\u985e\uff09\u3092\u7701\u7565\u3057\u305f\u5834\u5408\u3001100\u3068\u3057\u3066\u6271\u308f\u308c\u308b\u3002\n  \u4f8b\u3048\u3070\u3001AD<=90\u306f1AD100<=90\u3068\u3057\u3066\u89e3\u91c8\u3055\u308c\u308b\u3002\n"),E.$register_prefix("[-+*/\\d]*AD\\d*","[-+*/\\d]*AB\\d*","ORP","--WORSENING","--ADDICTION"),A(E,"$initialize",function R(i){var t=this;return R.$$p=null,K(t,J(t,"initialize",R,!1,!0),"initialize",[i],null),t.sort_add_dice=!0,t.sort_barabara_dice=!0,t.sides_implicit_d=100}),A(E,"$eval_game_system_specific_command",function(i){var t,r,n,u,c=this;return v(t=v(r=v(n=v(u=c.$eval_ad(i))?u:c.$eval_ab(i))?n:c.$eval_orp(i))?r:c.$eval_worsening(i))?t:c.$eval_addiction(i)}),E.$private(),i=N,S((t=[q(N[0],"Status")].concat(i))[0],"CRITICAL",1),S(t[0],"SUCCESS",2),S(t[0],"FAILURE",3),S(t[0],"ERROR",4),S(N[0],"STATUS_NAME",Q(d($("Status"),"CRITICAL"),"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\uff01",d($("Status"),"SUCCESS"),"\u6210\u529f",d($("Status"),"FAILURE"),"\u5931\u6557",d($("Status"),"ERROR"),"\u30a8\u30e9\u30fc").$freeze()),A(E,"$check_roll",function(i,c){var t,r;return t=U(i,c),r=v(U(i,10))?"Critical":v(X(i,91))?"Error":"Neutral",v(t)&&x(r,"Critical")?d($("Status"),"CRITICAL"):v(t)&&x(r,"Neutral")||v(t)&&x(r,"Error")?d($("Status"),"SUCCESS"):g(t)&&x(r,"Critical")||g(t)&&x(r,"Neutral")?d($("Status"),"FAILURE"):g(t)&&x(r,"Error")?d($("Status"),"ERROR"):e}),A(E,"$eval_ad",function(i){try{G("eval_return");var t=this,r=e,n=e,u=e,a=e;return r=/^([-+*\/\d]*)AD(\d*)<=([-+*\/\d]+)$/.$match(i),v(r)?(n=r["$[]"](1),u=r["$[]"](2),a=$("Arithmetic").$eval(r["$[]"](3),t.round_type),n=g(n["$empty?"]())?$("Arithmetic").$eval(r["$[]"](1),t.round_type):1,u=g(u["$empty?"]())?u.$to_i():100,t.$roll_ad(i,n,u,a)):e}catch(l){if(l===s.t_eval_return)return l.$v;throw l}}),A(E,"$eval_ab",function(i){try{G("eval_return");var t=this,r=e,n=e,u=e,a=e,l=e,o=e;return r=/^([-+*\/\d]*)AB(\d*)<=([-+*\/\d]+)(?:--([^\d\s]+)([0-2])?)?$/.$match(i),v(r)?(n=r["$[]"](1),u=r["$[]"](2),a=$("Arithmetic").$eval(r["$[]"](3),t.round_type),l=r["$[]"](4),o=r["$[]"](5),n=g(n["$empty?"]())?$("Arithmetic").$eval(r["$[]"](1),t.round_type):1,u=g(u["$empty?"]())?u.$to_i():100,o=g(o["$nil?"]())?o.$to_i():x(l,"SNIPER")?1:0,v(l["$nil?"]())?t.$roll_ab(i,n,u,a):t.$roll_ab_withtype(i,n,u,a,l,o)):e}catch(_){if(_===s.t_eval_return)return _.$v;throw _}}),A(E,"$eval_orp",function(i){try{G("eval_return");var n,t=this,r=e,u=e,a=e,l=e,o=e;return r=/^ORP(?<END>[-+*\/\d]+)@(?<ORP>[-+*\/\d]+)(?:\+D(?<DICE>[-+*\/\d]+))?(?:\+T(?<TGT>[-+*\/\d]+))?$/.$match(i),r=v(n=r)?n:/^ORP(?<END>[-+*\/\d]+)@(?<ORP>[-+*\/\d]+)(?:\+T(?<TGT>[-+*\/\d]+))?(?:\+D(?<DICE>[-+*\/\d]+))?$/.$match(i),v(r)?(u=$("Arithmetic").$eval(r["$[]"]("END"),t.round_type),a=$("Arithmetic").$eval(r["$[]"]("ORP"),t.round_type),l=g(r["$[]"](3)["$nil?"]())?$("Arithmetic").$eval(r["$[]"]("DICE"),t.round_type):0,o=g(r["$[]"](4)["$nil?"]())?$("Arithmetic").$eval(r["$[]"]("TGT"),t.round_type):0,t.$roll_orp(i,u,a,l,o)):e}catch(_){if(_===s.t_eval_return)return _.$v;throw _}}),A(E,"$roll_ad",function(i,c,t,r){var a,l,_,o,u=e;return a=(u=this.randomizer.$roll_barabara(c,t).$sort()).$sum(),l=this.$check_roll(a,r),o=x(c,1)?"("+i+") \uff1e "+u.$join(",")+" \uff1e "+$("STATUS_NAME")["$[]"](l):"("+i+") \uff1e "+a+"["+u.$join(",")+"] \uff1e "+$("STATUS_NAME")["$[]"](l),y(d($("Status"),"CRITICAL"),_=l)?$("Result").$critical(o):y(d($("Status"),"SUCCESS"),_)?$("Result").$success(o):y(d($("Status"),"FAILURE"),_)?$("Result").$failure(o):y(d($("Status"),"ERROR"),_)?$("Result").$fumble(o):e}),A(E,"$roll_ab",function(i,c,t,r){var n,u,o,_,b,I,C,l=e;return l=this.randomizer.$roll_barabara(c,t).$sort(),u=this.$process_ab(l,r),n=M(u),b=null==n[2]?e:n[2],I=B(h(o=null==n[0]?e:n[0],_=null==n[1]?e:n[1]),b),C="("+i+") \uff1e ["+l.$join(",")+"] \uff1e "+o+"+"+_+"C-"+b+"E \uff1e \u6210\u529f\u6570"+I,z($("Result").$new(),"tap",[],function(f){var T;return null==f&&(f=e),f["$text="](C),f["$condition="](w(I,0)),f["$critical="](w(_,0)),T=[w(b,0)],z(f,"fumble=",T),T[T.length-1]})}),A(E,"$roll_ab_withtype",function(i,c,t,r,n,u){var a,l,b,I,C,_=e,D=e,f=e,T=e;switch(_=this.randomizer.$roll_barabara(c,t).$sort(),l=this.$process_ab(_,r),a=M(l),C=null==a[2]?e:a[2],D=B(h(b=null==a[0]?e:a[0],I=null==a[1]?e:a[1]),C),n.valueOf()){case"SNI":f=x(u,0)&&v(w(D,0))?1:0;break;case"SNIPER":f=j(u,0)&&v(w(D,0))?1:0}return g(f["$nil?"]())?(D=h(D,f),T="("+i+") \uff1e ["+_.$join(",")+"] \uff1e "+b+"+"+I+"C-"+C+"E+"+f+"("+n+") \uff1e \u6210\u529f\u6570"+D):T="("+i+") \uff1e ["+_.$join(",")+"] \uff1e "+b+"+"+I+"C-"+C+"E \uff1e \u6210\u529f\u6570"+D,z($("Result").$new(),"tap",[],function(P){var L;return null==P&&(P=e),P["$text="](T),P["$condition="](w(D,0)),P["$critical="](w(I,0)),L=[w(C,0)],z(P,"fumble=",L),L[L.length-1]})}),S(N[0],"ENDURANCE_LEVEL_TABLE",[20,40,70,90,d($("Float"),"INFINITY")].$freeze()),S(N[0],"ORP_TIMES_TABLE",[1,2,2,3,4].$freeze()),A(E,"$roll_orp",function(i,c,t,r,n){var l,o,_,b=e,I=e,C=e,f=e,T=e,k=e;return l=z($("ENDURANCE_LEVEL_TABLE"),"find_index",[],function(L){return null==L&&(L=e),U(c,L)}),o=$("ORP_TIMES_TABLE")["$[]"](l),_=h(o,r),v(U(t,20))?$("Result").$new("("+i+") \uff1e \u9271\u77f3\u75c5\u5224\u5b9a\u304c\u767a\u751f\u3057\u306a\u3044\u4fb5\u98df\u5ea6\u3067\u3059\u3002\u4fb5\u98df\u5ea6\u306f21\u4ee5\u4e0a\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"):(b=B(Z(t,20).$ceil(),1),I=B(B(80,p(b,20)),p(B(t,p(b,20)),5)),C=h(I,n),f=["("+i+")",h(h(h("\u30c0\u30a4\u30b9\u6570"+o,v(w(r,0))?"+"+r:""),"\u3001\u5224\u5b9a\u5024"+I),v(w(n,0))?"+"+n:""),_+"B100<="+C],v(U(C,0))?(f=h(f,["\u81ea\u52d5\u5931\u6557\uff01"]),$("Result").$failure(f.$join(" \uff1e "))):(T=this.randomizer.$roll_barabara(_,100).$sort(),k=z(T,"count",[],function(L){return null==L&&(L=e),U(L,C)}),v(w(k,0))?(f=h(f,["["+T.$join(",")+"]","\u6210\u529f\u6570"+k,"\u6210\u529f"]),$("Result").$success(f.$join(" \uff1e "))):(f=h(f,["["+T.$join(",")+"]","\u6210\u529f\u6570"+k,"\u5931\u6557"]),$("Result").$failure(f.$join(" \uff1e ")))))}),A(E,"$process_ab",function(i,c){var r=e,n=e,u=e;return r=0,n=0,u=0,z(i,"each",[],function a(l){var _,o=null==a.$$s?this:a.$$s;return null==l&&(l=e),y(d($("Status"),"CRITICAL"),_=o.$check_roll(l,c))?(n=h(n,1),r=h(r,1)):y(d($("Status"),"SUCCESS"),_)?r=h(r,1):y(d($("Status"),"FAILURE"),_)?e:y(d($("Status"),"ERROR"),_)?u=h(u,1):e},{$$s:this}),[r,n,u]}),S(N[0],"WORSENING_TABLE",["\u672b\u68a2\u795e\u7d4c\u969c\u5bb3","\u5185\u81d3\u6a5f\u80fd\u4e0d\u5168","\u7cbe\u795e\u75c7\u72b6"].$freeze()),A(E,"$eval_worsening",function(i){var t=e;return j(i,"--WORSENING")?e:(t=this.randomizer.$roll_once(3),"--WORSENING \uff1e "+$("WORSENING_TABLE")["$[]"](B(t,1))+": "+h(this.randomizer.$roll_once(6),1)+" rounds")}),S(N[0],"ADDICTION_TABLE",["\u8133\u795e\u7d4c\u969c\u5bb3","\u591a\u81d3\u5668\u4e0d\u5168","\u6025\u6027\u7cbe\u795e\u75c7\u72b6"].$freeze()),A(E,"$eval_addiction",function(i){var t=e;return j(i,"--ADDICTION")?e:(t=this.randomizer.$roll_once(3),"--ADDICTION \uff1e "+$("ADDICTION_TABLE")["$[]"](B(t,1)))})})}}]);