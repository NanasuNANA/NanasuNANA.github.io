(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{afol:function(t,e,r){r("pQ1d"),Opal.modules["bcdice/format"]=function(t){var e=[],r=t.nil,n=t.$$,i=t.module,$=t.truthy;return function(e,a){var s=[i(e,"BCDice")].concat(a);!function(e,a){var s,c,o=i(e,"Format"),u=[o].concat(a);o.$module_function(),t.def(o,"$comparison_operator",s=function(t){var e;return"=="["$==="](e=t)?"=":"!="["$==="](e)?"<>":n(u,"Symbol")["$==="](e)?t.$to_s():r},s.$$arity=1),t.def(o,"$modifier",c=function(t){var e;return $(t["$nil?"]())?r:t["$=="](0)?"":$("number"==typeof(e=t)?e>0:e["$>"](0))?"+"+t:t.$to_s()},c.$$arity=1)}(s[0],s)}(e[0],e)},Opal.modules["racc/parser"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}var a=[],s=t.nil,c=t.$$$,o=t.$$,u=t.module,_=t.klass,l=t.truthy,h=t.gvars,d=t.send;return function(t,e){var r=[u(t,"Racc")].concat(e);!function(t,e,r){[_(t,e,"ParseError")].concat(r)}(r[0],o(r,"StandardError"),r)}(a[0],a),l(c("::","ParseError","skip_raise")?"constant":s)||t.const_set(a[0],"ParseError",c(o(a,"Racc"),"ParseError")),function(a,f){var p=[u(a,"Racc")].concat(f);l(o(p,"Racc_No_Extensions","skip_raise")?"constant":s)||t.const_set(p[0],"Racc_No_Extensions",!1),function(a,u,f){var p,m,y,g,b,R,v,T,w,E,x,L,D,O,k,S,A,M,I,C,N,P,H,B,G=_(a,null,"Parser"),z=[G].concat(f);G.$$prototype.yydebug=G.$$prototype.racc_debug_out=G.$$prototype.racc_error_status=G.$$prototype.racc_t=G.$$prototype.racc_vstack=G.$$prototype.racc_val=G.$$prototype.racc_state=G.$$prototype.racc_tstack=s,t.const_set(z[0],"Racc_Runtime_Version","1.4.6"),t.const_set(z[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),t.const_set(z[0],"Racc_Runtime_Core_Version_R","1.4.6"),t.const_set(z[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),t.const_set(z[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),t.const_set(z[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),t.const_set(z[0],"Racc_Runtime_Core_Version",o(z,"Racc_Runtime_Core_Version_R")),t.const_set(z[0],"Racc_Runtime_Core_Revision",o(z,"Racc_Runtime_Core_Revision_R")),t.const_set(z[0],"Racc_Runtime_Type","ruby"),t.defs(o(z,"Parser"),"$racc_runtime_type",p=function(){return o(z,"Racc_Runtime_Type")},p.$$arity=0),t.def(G,"$_racc_setup",m=function(){var n,i,$=s,a=s,o=s;return null==h.stderr&&(h.stderr=s),l(c(this.$class(),"Racc_debug_parser"))||(this.yydebug=!1),l(null!=(n=this.yydebug)&&n!==s?"instance-variable":s)||(this.yydebug=!1),l(this.yydebug)&&(l(null!=(i=this.racc_debug_out)&&i!==s?"instance-variable":s)||(this.racc_debug_out=h.stderr),this.racc_debug_out=l($=this.racc_debug_out)?$:h.stderr),a=c(this.$class(),"Racc_arg"),l(e(a.$size(),14))&&(d(a,"[]=",t.to_a(o=[13,!0])),r(o.length,1)),a},m.$$arity=0),t.def(G,"$_racc_init_sysvars",y=function(){return this.racc_state=[0],this.racc_tstack=[],this.racc_vstack=[],this.racc_t=s,this.racc_val=s,this.racc_read_next=!0,this.racc_user_yyerror=!1,this.racc_error_status=0},y.$$arity=0),t.def(G,"$do_parse",g=function(){return this.$__send__(o(z,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},g.$$arity=0),t.def(G,"$next_token",b=function(){return this.$raise(o(z,"NotImplementedError"),this.$class()+"#next_token is not defined")},b.$$arity=0),t.def(G,"$_racc_do_parse_rb",R=function(e,r){var $,a,c=s,o=s,u=s,_=s,h=s,f=s,p=s,m=s;return $=t.to_ary(e),c=null==$[0]?s:$[0],o=null==$[1]?s:$[1],u=null==$[2]?s:$[2],_=null==$[3]?s:$[3],h=null==$[10]?s:$[10],this.$_racc_init_sysvars(),f=p=m=s,d(this,"catch",["racc_end_parse"],((a=function(){var r,$,d=null==a.$$s?this:a.$$s,y=s,g=s,b=s;for(null==d.racc_state&&(d.racc_state=s),null==d.racc_read_next&&(d.racc_read_next=s),null==d.racc_t&&(d.racc_t=s),null==d.yydebug&&(d.yydebug=s),null==d.racc_val&&(d.racc_val=s);l(!0);)for(l(m=_["$[]"](d.racc_state["$[]"](-1)))?(l(d.racc_read_next)&&l(d.racc_t["$!="](0))&&($=d.$next_token(),r=t.to_ary($),f=null==r[0]?s:r[0],d.racc_val=null==r[1]?s:r[1],d.racc_t=l(f)?l(y=h["$[]"](f))?y:1:0,l(d.yydebug)&&d.$racc_read_token(d.racc_t,f,d.racc_val),d.racc_read_next=!1),m=n(m,d.racc_t),l(l(g=l(b=i(m,0))?p=c["$[]"](m):b)?o["$[]"](m)["$=="](d.racc_state["$[]"](-1)):g)||(p=u["$[]"](d.racc_state["$[]"](-1)))):p=u["$[]"](d.racc_state["$[]"](-1));l(p=d.$_racc_evalact(p,e)););}).$$s=this,a.$$arity=0,a))},R.$$arity=2),t.def(G,"$yyparse",v=function(t,e){return this.$__send__(o(z,"Racc_YY_Parse_Method"),t,e,this.$_racc_setup(),!0)},v.$$arity=2),t.def(G,"$_racc_yyparse_rb",T=function(e,r,$,a){var c,o,u=s,_=s,h=s,f=s,p=s,m=s,y=s;return c=t.to_ary($),u=null==c[0]?s:c[0],_=null==c[1]?s:c[1],h=null==c[2]?s:c[2],f=null==c[3]?s:c[3],p=null==c[10]?s:c[10],this.$_racc_init_sysvars(),m=s,y=s,d(this,"catch",["racc_end_parse"],((o=function(){var t,a=null==o.$$s?this:o.$$s;for(null==a.racc_state&&(a.racc_state=s);!l(y=f["$[]"](a.racc_state["$[]"](-1)));)for(;l(m=a.$_racc_evalact(h["$[]"](a.racc_state["$[]"](-1)),$)););return d(e,"__send__",[r],((t=function(e,r){var a,c,o=null==t.$$s?this:t.$$s,d=s,g=s,b=s,R=s,v=s,T=s,w=s;for(null==o.racc_t&&(o.racc_t=s),null==o.racc_state&&(o.racc_state=s),null==o.racc_read_next&&(o.racc_read_next=s),null==e&&(e=s),null==r&&(r=s),o.racc_t=l(e)?l(d=p["$[]"](e))?d:1:0,o.racc_val=r,o.racc_read_next=!1,y=n(y,o.racc_t),l(l(a=l(c=i(y,0))?m=u["$[]"](y):c)?_["$[]"](y)["$=="](o.racc_state["$[]"](-1)):a)||(m=h["$[]"](o.racc_state["$[]"](-1)));l(m=o.$_racc_evalact(m,$)););for(;l(l(g=l(b=(y=f["$[]"](o.racc_state["$[]"](-1)))["$!"]())?b:o.racc_read_next["$!"]())?g:o.racc_t["$=="](0));)for(l(l(R=l(v=l(T=l(w=y)?y=n(y,o.racc_t):w)?i(y,0):T)?m=u["$[]"](y):v)?_["$[]"](y)["$=="](o.racc_state["$[]"](-1)):R)||(m=h["$[]"](o.racc_state["$[]"](-1)));l(m=o.$_racc_evalact(m,$)););}).$$s=a,t.$$arity=2,t))}).$$s=this,o.$$arity=0,o))},T.$$arity=4),t.def(G,"$_racc_evalact",w=function(a,c){var o,u,_,h,f,p=s,m=s,y=s,g=s,b=s,R=s,v=s,T=s,w=s,E=s;if(p=null==(o=t.to_ary(c))[0]?s:o[0],m=null==o[1]?s:o[1],y=null==o[3]?s:o[3],_=null==o[11]?s:o[11],g=null==o[12]?s:o[12],l(l(f=$(a,0))?e(a,_):f))l($(this.racc_error_status,0))&&(this.racc_t["$=="](1)||(this.racc_error_status=r(this.racc_error_status,1))),this.racc_vstack.$push(this.racc_val),this.racc_state.$push(a),this.racc_read_next=!0,l(this.yydebug)&&(this.racc_tstack.$push(this.racc_t),this.$racc_shift(this.racc_t,this.racc_tstack,this.racc_vstack));else if(l(l(b=e(a,0))?$(a,g["$-@"]()):b)){if(R=d(this,"catch",["racc_jump"],((u=function(){var t=null==u.$$s?this:u.$$s;return null==t.racc_state&&(t.racc_state=s),t.racc_state.$push(t.$_racc_do_reduce(c,a)),!1}).$$s=this,u.$$arity=0,u)),l(R)){if(1["$==="](v=R))return this.racc_user_yyerror=!0,g["$-@"]();if(2["$==="](v))return _;this.$raise("[Racc Bug] unknown jump code")}}else if(a["$=="](_))l(this.yydebug)&&this.$racc_accept(),this.$throw("racc_end_parse",this.racc_vstack["$[]"](0));else{if(a["$=="](g["$-@"]())){for((0)["$==="](v=this.racc_error_status)?l(c["$[]"](21))||this.$on_error(this.racc_t,this.racc_val,this.racc_vstack):3["$==="](v)&&(this.racc_t["$=="](0)&&this.$throw("racc_end_parse",s),this.racc_read_next=!0),this.racc_user_yyerror=!1,this.racc_error_status=3;l(!0)&&(!l(T=y["$[]"](this.racc_state["$[]"](-1)))||(T=n(T,1),!l(l(w=l(E=i(T,0))?a=p["$[]"](T):E)?m["$[]"](T)["$=="](this.racc_state["$[]"](-1)):w)));)l("number"==typeof(h=this.racc_state.$size())?h<=1:h["$<="](1))&&this.$throw("racc_end_parse",s),this.racc_state.$pop(),this.racc_vstack.$pop(),l(this.yydebug)&&(this.racc_tstack.$pop(),this.$racc_e_pop(this.racc_state,this.racc_tstack,this.racc_vstack));return a}this.$raise("[Racc Bug] unknown action "+a.$inspect())}return l(this.yydebug)&&this.$racc_next_state(this.racc_state["$[]"](-1),this.racc_state),s},w.$$arity=2),t.def(G,"$_racc_do_reduce",E=function(e,$){var a,c,o,u,_,h,f,p,m=s,y=s,g=s,b=s,R=s,v=s,T=s,w=s,E=s,x=s,L=s,D=s,O=s,k=s,S=s,A=s;return m=null==(a=t.to_ary(e))[4]?s:a[4],y=null==a[5]?s:a[5],g=null==a[6]?s:a[6],b=null==a[7]?s:a[7],c=null==a[8]?s:a[8],R=null==a[9]?s:a[9],o=null==a[13]?s:a[13],v=this.racc_state,T=this.racc_vstack,w=this.racc_tstack,E="number"==typeof(p=$)?-3*p:p["$*"](-3),x=R["$[]"](E),u=R["$[]"](n(E,1)),_=R["$[]"](n(E,2)),h=[],l(this.yydebug)&&(L=w["$[]"](x["$-@"](),x)),D=T["$[]"](x["$-@"](),x),l(this.yydebug)&&(O=[x["$-@"](),x,h],d(w,"[]=",t.to_a(O)),r(O.length,1)),O=[x["$-@"](),x,h],d(T,"[]=",t.to_a(O)),r(O.length,1),O=[x["$-@"](),x,h],d(v,"[]=",t.to_a(O)),r(O.length,1),l(o)?T.$push(this.$__send__(_,D,T,D["$[]"](0))):T.$push(this.$__send__(_,D,T)),w.$push(u),l(this.yydebug)&&this.$racc_reduce(L,u,w,T),f=r(u,c),l(E=b["$[]"](f))&&(E=n(E,v["$[]"](-1)),l(l(k=l(S=i(E,0))?A=m["$[]"](E):S)?y["$[]"](E)["$=="](f):k))?A:g["$[]"](f)},E.$$arity=2),t.def(G,"$on_error",x=function(t,e,r){var n;return this.$raise(o(z,"ParseError"),this.$sprintf("\nparse error on value %s (%s)",e.$inspect(),l(n=this.$token_to_str(t))?n:"?"))},x.$$arity=3),t.def(G,"$yyerror",L=function(){return this.$throw("racc_jump",1)},L.$$arity=0),t.def(G,"$yyaccept",D=function(){return this.$throw("racc_jump",2)},D.$$arity=0),t.def(G,"$yyerrok",O=function(){return this.racc_error_status=0},O.$$arity=0),t.def(G,"$racc_read_token",k=function(t,e,r){return this.racc_debug_out.$print("read    "),this.racc_debug_out.$print(e.$inspect(),"(",this.$racc_token2str(t),") "),this.racc_debug_out.$puts(r.$inspect()),this.racc_debug_out.$puts()},k.$$arity=3),t.def(G,"$racc_shift",S=function(t,e,r){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(t)),this.$racc_print_stacks(e,r),this.racc_debug_out.$puts()},S.$$arity=3),t.def(G,"$racc_reduce",A=function(t,e,r,n){var i,$=s;return($=this.racc_debug_out).$print("reduce "),l(t["$empty?"]())?$.$print(" <none>"):d(t,"each",[],((i=function(t){return null==t&&(t=s),$.$print(" ",(null==i.$$s?this:i.$$s).$racc_token2str(t))}).$$s=this,i.$$arity=1,i)),$.$puts(" --\x3e "+this.$racc_token2str(e)),this.$racc_print_stacks(r,n),this.racc_debug_out.$puts()},A.$$arity=4),t.def(G,"$racc_accept",M=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},M.$$arity=0),t.def(G,"$racc_e_pop",I=function(t,e,r){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(t),this.$racc_print_stacks(e,r),this.racc_debug_out.$puts()},I.$$arity=3),t.def(G,"$racc_next_state",C=function(t,e){return this.racc_debug_out.$puts("goto    "+t),this.$racc_print_states(e),this.racc_debug_out.$puts()},C.$$arity=2),t.def(G,"$racc_print_stacks",N=function(t,e){var r,n=s;return(n=this.racc_debug_out).$print("        ["),d(t,"each_index",[],((r=function(i){return null==i&&(i=s),n.$print(" (",(null==r.$$s?this:r.$$s).$racc_token2str(t["$[]"](i))," ",e["$[]"](i).$inspect(),")")}).$$s=this,r.$$arity=1,r)),n.$puts(" ]")},N.$$arity=2),t.def(G,"$racc_print_states",P=function(t){var e,r=s;return(r=this.racc_debug_out).$print("        ["),d(t,"each",[],((e=function(t){return null==t&&(t=s),r.$print(" ",t)}).$$s=this,e.$$arity=1,e)),r.$puts(" ]")},P.$$arity=1),t.def(G,"$racc_token2str",H=function(t){var e;return l(e=c(this.$class(),"Racc_token_to_s_table")["$[]"](t))?e:this.$raise("[Racc Bug] can't convert token "+t+" to string")},H.$$arity=1),t.def(G,"$token_to_str",B=function(t){return c(this.$class(),"Racc_token_to_s_table")["$[]"](t)},B.$$arity=1)}(p[0],0,p)}(a[0],a)},Opal.modules["bcdice/arithmetic/node"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var r=[],n=t.nil,i=t.$$$,$=t.$$,a=t.module,s=t.klass,c=t.send2;return function(r,o){var u=[a(r,"BCDice")].concat(o);!function(r,o){var u=[a(r,"Arithmetic")].concat(o);!function(r,o){var u=[a(r,"Node")].concat(o);!function(e,r,i){var $,a,c,o,u,_=s(e,null,"BinaryOp");[_].concat(i),_.$$prototype.lhs=_.$$prototype.rhs=_.$$prototype.op=n,t.def(_,"$initialize",$=function(t,e,r){return this.lhs=t,this.op=e,this.rhs=r},$.$$arity=3),t.def(_,"$eval",a=function(t){var e,r=n;return r=this.lhs.$eval(t),e=this.rhs.$eval(t),r.$send(this.op,e)},a.$$arity=1),t.def(_,"$output",c=function(){return""+this.lhs.$output()+this.op+this.rhs.$output()},c.$$arity=0),t.def(_,"$s_exp",o=function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"},o.$$arity=0),t.def(_,"$op_for_s_exp",u=function(){return this.op},u.$$arity=0)}(u[0],0,u),function(e,r,a){var o,u,_,l,h,d,f=s(e,r,"DivideBase"),p=[f].concat(a);f.$$prototype.lhs=f.$$prototype.rhs=f.$$prototype.op=n,t.def(f,"$initialize",o=function(e,r){return o.$$p&&(o.$$p=null),c(this,t.find_super_dispatcher(this,"initialize",o,!1,!0),"initialize",[e,"/",r],null)},o.$$arity=2),t.def(f,"$eval",u=function(t){var e,r=n;return e=this.lhs.$eval(t),(r=this.rhs.$eval(t))["$=="](0)&&this.$raise($(p,"ZeroDivisionError")),this.$divide_and_round(e,r,t)},u.$$arity=1),t.def(f,"$output",_=function(){var e=_.$$p,r=this,i=n,$=n,a=n;for(e&&(_.$$p=null),$=0,a=arguments.length,i=new Array(a);$<a;$++)i[$]=arguments[$];return""+c(r,t.find_super_dispatcher(r,"output",_,!1,!0),"output",i,e)+r.$rounding_method()},_.$$arity=0),f.$private(),t.def(f,"$rounding_method",l=function(){return i(this.$class(),"ROUNDING_METHOD")},l.$$arity=0),t.def(f,"$op_for_s_exp",h=function(){return""+this.op+this.$rounding_method()},h.$$arity=0),t.def(f,"$divide_and_round",d=function(t,e,r){return this.$raise($(p,"NotImplementedError"))},d.$$arity=3)}(u[0],$(u,"BinaryOp"),u),function(r,n,a){var c,o=s(r,n,"DivideWithGameSystemDefault"),u=[o].concat(a);t.const_set(u[0],"ROUNDING_METHOD",""),o.$private(),t.def(o,"$divide_and_round",c=function(t,r,n){var a;return a=n,i($(u,"RoundType"),"CEIL")["$==="](a)?e(t.$to_f(),r).$ceil():i($(u,"RoundType"),"ROUND")["$==="](a)?e(t.$to_f(),r).$round():e(t,r).$to_i()},c.$$arity=3)}(u[0],$(u,"DivideBase"),u),function(r,n,i){var $,a=s(r,n,"DivideWithCeil"),c=[a].concat(i);t.const_set(c[0],"ROUNDING_METHOD","C"),a.$private(),t.def(a,"$divide_and_round",$=function(t,r,n){return e(t.$to_f(),r).$ceil()},$.$$arity=3)}(u[0],$(u,"DivideBase"),u),function(r,n,i){var $,a=s(r,n,"DivideWithRound"),c=[a].concat(i);t.const_set(c[0],"ROUNDING_METHOD","R"),a.$private(),t.def(a,"$divide_and_round",$=function(t,r,n){return e(t.$to_f(),r).$round()},$.$$arity=3)}(u[0],$(u,"DivideBase"),u),function(r,n,i){var $,a=s(r,n,"DivideWithFloor"),c=[a].concat(i);t.const_set(c[0],"ROUNDING_METHOD","F"),a.$private(),t.def(a,"$divide_and_round",$=function(t,r,n){return e(t,r).$to_i()},$.$$arity=3)}(u[0],$(u,"DivideBase"),u),function(e,r,i){var $,a,c,o,u=s(e,null,"Negative");[u].concat(i),u.$$prototype.body=n,t.def(u,"$initialize",$=function(t){return this.body=t},$.$$arity=1),t.def(u,"$eval",a=function(t){return this.body.$eval(t)["$-@"]()},a.$$arity=1),t.def(u,"$output",c=function(){return"-"+this.body.$output()},c.$$arity=0),t.def(u,"$s_exp",o=function(){return"(- "+this.body.$s_exp()+")"},o.$$arity=0)}(u[0],0,u),function(e,r,i){var $,a,c,o,u=s(e,null,"Parenthesis");[u].concat(i),u.$$prototype.expr=n,t.def(u,"$initialize",$=function(t){return this.expr=t},$.$$arity=1),t.def(u,"$eval",a=function(t){return this.expr.$eval(t)},a.$$arity=1),t.def(u,"$output",c=function(){return"("+this.expr.$output()+")"},c.$$arity=0),t.def(u,"$s_exp",o=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},o.$$arity=0)}(u[0],0,u),function(e,r,i){var $,a,c,o=s(e,null,"Number");[o].concat(i),o.$$prototype.value=n,t.def(o,"$initialize",$=function(t){return this.value=t},$.$$arity=1),t.def(o,"$eval",a=function(t){return this.value},a.$$arity=1),t.def(o,"$output",c=function(){return this.value.$to_s()},c.$$arity=0),t.alias(o,"s_exp","output")}(u[0],0,u)}(u[0],u)}(u[0],u)}(r[0],r)},Opal.modules.strscan=function(t){var e=[],r=t.nil,n=t.$$,i=t.klass,$=t.truthy,a=t.send;return function(e,s,c){var o,u,_,l,h,d,f,p,m,y,g,b,R,v,T,w,E,x,L,D,O,k,S,A,M,I=i(e,null,"StringScanner"),C=[I].concat(c);return I.$$prototype.pos=I.$$prototype.string=I.$$prototype.working=I.$$prototype.matched=I.$$prototype.prev_pos=I.$$prototype.match=r,I.$attr_reader("pos"),I.$attr_reader("matched"),t.def(I,"$initialize",o=function(t){return this.string=t,this.pos=0,this.matched=r,this.working=t,this.match=[]},o.$$arity=1),I.$attr_reader("string"),t.def(I,"$beginning_of_line?",u=function(){return 0===this.pos||"\n"===this.string.charAt(this.pos-1)},u.$$arity=0),t.alias(I,"bol?","beginning_of_line?"),t.def(I,"$scan",_=function(t){var e=(t=this.$anchor(t)).exec(this.working);return null==e?this.matched=r:"object"==typeof e?(this.prev_pos=this.pos,this.pos+=e[0].length,this.working=this.working.substring(e[0].length),this.matched=e[0],this.match=e,e[0]):"string"==typeof e?(this.pos+=e.length,this.working=this.working.substring(e.length),e):r},_.$$arity=1),t.def(I,"$scan_until",l=function(t){t=this.$anchor(t);for(var e,n=this.pos,i=this.working;;){if(e=t.exec(i),n+=1,i=i.substr(1),null!=e)return this.matched=this.string.substr(this.pos,n-this.pos-1+e[0].length),this.match=e,this.prev_pos=n-1,this.pos=n,this.working=i.substr(e[0].length),this.matched;if(0===i.length)return this.match=[],this.matched=r}},l.$$arity=1),t.def(I,"$[]",h=function(t){var e;if($(this.match["$empty?"]()))return r;e=t,n(C,"Symbol")["$==="](e)?t=t.$to_s():n(C,"String")["$==="](e)||(t=n(C,"Opal")["$coerce_to!"](t,n(C,"Integer"),"to_int"));var i=this.match;return t<0&&(t+=i.length),t<0||t>=i.length||null==i[t]?r:i[t]},h.$$arity=1),t.def(I,"$check",d=function(t){var e=(t=this.$anchor(t)).exec(this.working);return this.matched=null==e?r:e[0]},d.$$arity=1),t.def(I,"$check_until",f=function(t){var e=this.prev_pos,n=this.pos,i=this.$scan_until(t);return i!==r&&(this.matched=i.substr(-1),this.working=this.string.substr(n)),this.prev_pos=e,this.pos=n,i},f.$$arity=1),t.def(I,"$peek",p=function(t){return this.working.substring(0,t)},p.$$arity=1),t.def(I,"$eos?",m=function(){return 0===this.working.length},m.$$arity=0),t.def(I,"$exist?",y=function(t){var e=t.exec(this.working);return null==e?r:0==e.index?0:e.index+1},y.$$arity=1),t.def(I,"$skip",g=function(t){var e=(t=this.$anchor(t)).exec(this.working);if(null==e)return this.match=[],this.matched=r;var n=e[0],i=n.length;return this.matched=n,this.match=e,this.prev_pos=this.pos,this.pos+=i,this.working=this.working.substring(i),i},g.$$arity=1),t.def(I,"$skip_until",b=function(t){var e=this.$scan_until(t);return e===r?r:(this.matched=e.substr(-1),e.length)},b.$$arity=1),t.def(I,"$get_byte",R=function(){var t=r;return this.pos<this.string.length?(this.prev_pos=this.pos,this.pos+=1,t=this.matched=this.working.substring(0,1),this.working=this.working.substring(1)):this.matched=r,t},R.$$arity=0),t.alias(I,"getch","get_byte"),t.def(I,"$match?",v=function(t){var e=(t=this.$anchor(t)).exec(this.working);return null==e?r:(this.prev_pos=this.pos,e[0].length)},v.$$arity=1),t.def(I,"$pos=",T=function(t){return t<0&&(t+=this.string.$length()),this.pos=t,this.working=this.string.slice(t)},T.$$arity=1),t.def(I,"$matched_size",w=function(){return this.matched===r?r:this.matched.length},w.$$arity=0),t.def(I,"$post_match",E=function(){return this.matched===r?r:this.string.substr(this.pos)},E.$$arity=0),t.def(I,"$pre_match",x=function(){return this.matched===r?r:this.string.substr(0,this.prev_pos)},x.$$arity=0),t.def(I,"$reset",L=function(){return this.working=this.string,this.matched=r,this.pos=0},L.$$arity=0),t.def(I,"$rest",D=function(){return this.working},D.$$arity=0),t.def(I,"$rest?",O=function(){return 0!==this.working.length},O.$$arity=0),t.def(I,"$rest_size",k=function(){return this.$rest().$size()},k.$$arity=0),t.def(I,"$terminate",S=function(){var e,n;return this.match=r,e=[this.string.$length()],a(this,"pos=",t.to_a(e)),e[(n=e.length,"number"==typeof n?n-1:n["$-"](1))]},S.$$arity=0),t.def(I,"$unscan",A=function(){return this.pos=this.prev_pos,this.prev_pos=r,this.match=r,this},A.$$arity=0),I.$private(),t.def(I,"$anchor",M=function(t){var e=t.toString().match(/\/([^\/]+)$/);return e=e?e[1]:void 0,new RegExp("^(?:"+t.source+")",e)},M.$$arity=1),r&&"anchor"}(e[0],0,e)},Opal.modules["bcdice/normalize"]=function(t){var e=[],r=t.nil,n=t.module;return function(e,i){var $=[n(e,"BCDice")].concat(i);!function(e,i){var $,a,s=n(e,"Normalize");[s].concat(i),s.$module_function(),t.def(s,"$comparison_operator",$=function(t){var e;return/<=|=</["$==="](e=t)?"<=":/>=|=>/["$==="](e)?">=":/<>|!=|=!/["$==="](e)?"!=":/</["$==="](e)?"<":/>/["$==="](e)?">":/=/["$==="](e)?"==":r},$.$$arity=1),t.def(s,"$target_number",a=function(t){return t["$=="]("?")?t:t.$to_i()},a.$$arity=1)}($[0],$)}(e[0],e)},Opal.modules["bcdice/command/lexer"]=function(t){var e=t.top,r=[],n=t.nil,i=t.$$,$=t.module,a=t.klass,s=t.hash2,c=t.truthy,o=t.send;return e.$require("strscan"),e.$require("bcdice/normalize"),function(e,r){var u=[$(e,"BCDice")].concat(r);!function(e,r){var u=[$(e,"Command")].concat(r);!function(e,r,$){var u,_,l,h=a(e,null,"Lexer"),d=[h].concat($);h.$$prototype.scanner=h.$$prototype.notations=n,t.const_set(d[0],"SYMBOLS",s(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),t.def(h,"$initialize",u=function(t,e){var r,$,a,s;return t=c(s=($=(r=t)===n||null==r?n:o(r,"split",[" ",2]))===n||null==$?n:o($,"first",[]))?s:"",this.scanner=i(d,"StringScanner").$new(t),this.notations=o(e,"map",[],((a=function(t){return null==t&&(t=n),c(t["$is_a?"](i(d,"String")))?i(d,"Regexp").$new(t):t}).$$s=this,a.$$arity=1,a))},u.$$arity=2),t.def(h,"$next_token",_=function(){try{var e,r=n,$=n,a=n,s=n;return c(this.scanner["$eos?"]())?[!1,"$"]:(o(this.notations,"each",[],((e=function(r){var i,$=null==e.$$s?this:e.$$s;if(null==$.scanner&&($.scanner=n),null==r&&(r=n),i=$.scanner.$scan(r),!c(i))return n;t.ret(["NOTATION",i])}).$$s=this,e.$$arity=1,e)),c(r=this.scanner.$scan(/\d+/))?["NUMBER",r.$to_i()]:c($=this.scanner.$scan(/[<>!=]+/))?($=i(d,"Normalize").$comparison_operator($),[c($)?"CMP_OP":"ILLEGAL",$]):(a=this.scanner.$getch().$upcase(),[c(s=i(d,"SYMBOLS")["$[]"](a))?s:a.$to_sym(),a]))}catch(u){if(u===t.returner)return u.$v;throw u}},_.$$arity=0),t.def(h,"$source",l=function(){return this.scanner.$string()},l.$$arity=0)}(u[0],0,u)}(u[0],u)}(r[0],r)},Opal.modules["bcdice/command/parsed"]=function(t){var e=[],r=t.nil,n=t.$$,i=t.module,$=t.klass,a=t.truthy;return function(e,s){var c=[i(e,"BCDice")].concat(s);!function(e,s){var c=[i(e,"Command")].concat(s);!function(e,i,s){var c,o,u,_=$(e,null,"Parsed"),l=[_].concat(s);_.$$prototype.question_target=_.$$prototype.critical=_.$$prototype.fumble=_.$$prototype.dollar=_.$$prototype.modify_number=_.$$prototype.target_number=_.$$prototype.prefix_number=_.$$prototype.command=_.$$prototype.suffix_number=_.$$prototype.cmp_op=r,_.$attr_accessor("command"),_.$attr_accessor("prefix_number"),_.$attr_accessor("suffix_number"),_.$attr_accessor("critical"),_.$attr_accessor("fumble"),_.$attr_accessor("dollar"),_.$attr_accessor("modify_number"),_.$attr_accessor("cmp_op"),_.$attr_accessor("target_number"),_.$attr_writer("question_target"),t.def(_,"$initialize",c=function(){return this.prefix_number=r,this.suffix_number=r,this.critical=r,this.fumble=r,this.dollar=r,this.cmp_op=r,this.target_number=r,this.question_target=!1},c.$$arity=0),t.def(_,"$question_target?",o=function(){return this.question_target},o.$$arity=0),t.def(_,"$to_s",u=function(t){var e,i=r,$=r,s=r,c=r,o=r;return null==t&&(t="after_command"),i=a(this.critical)?"@"+this.critical:r,$=a(this.fumble)?"#"+this.fumble:r,s=a(this.dollar)?"$"+this.dollar:r,c=n(l,"Format").$modifier(this.modify_number),o=a(this.question_target)?"?":this.target_number,"after_command"["$==="](e=t)?[this.prefix_number,this.command,this.suffix_number,i,$,s,c,this.cmp_op,o].$join():"after_modify_number"["$==="](e)?[this.prefix_number,this.command,this.suffix_number,c,i,$,s,this.cmp_op,o].$join():"after_target_number"["$==="](e)?[this.prefix_number,this.command,this.suffix_number,c,this.cmp_op,o,i,$,s].$join():r},u.$$arity=-1)}(c[0],0,c)}(c[0],c)}(e[0],e)},Opal.modules["bcdice/command/parser"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r,n,i,$=t.top,a=[],s=t.nil,c=t.$$$,o=t.$$,u=t.klass,_=t.module,l=t.hash2,h=t.send2,d=t.send,f=t.hash,p=t.truthy;return $.$require("racc/parser.rb"),$.$require("bcdice/arithmetic/node"),$.$require("bcdice/command/lexer"),$.$require("bcdice/command/parsed"),r=c(o(a,"BCDice"),"Command"),n=c(o(a,"Racc"),"Parser"),i=a,[u(r,n,"Parser")].concat(i),function(r,n){var i=[_(r,"BCDice")].concat(n);!function(r,n){var i=[_(r,"Command")].concat(n);!function(r,n,i){var $,a,_,m,y,g,b,R,v,T,w,E,x,L,D,O,k,S,A,M,I,C,N,P,H,B,G,z,U,F,q,j,W,X,Y,V,K,Q,J,Z,tt,et,rt,nt,it,$t,at,st,ct,ot,ut,_t,lt,ht,dt,ft,pt=u(r,n,"Parser"),mt=[pt].concat(i);pt.$$prototype.notations=pt.$$prototype.lexer=pt.$$prototype.modifier=pt.$$prototype.prefix_number=pt.$$prototype.suffix_number=pt.$$prototype.need_suffix_number=pt.$$prototype.need_prefix_number=pt.$$prototype.critical=pt.$$prototype.fumble=pt.$$prototype.dollar=pt.$$prototype.allowed_cmp_op=pt.$$prototype.question_target=s,t.def(pt,"$initialize",$=function(e,r){var n,i,a,c,o=$.$$p,u=this;if(o&&($.$$p=null),n=t.slice.call(arguments,0,arguments.length),null==(i=t.extract_kwargs(n)))i=l([],{});else if(!i.$$is_hash)throw t.ArgumentError.$new("expected kwargs");if(a=n,!t.hasOwnProperty.call(i.$$smap,"round_type"))throw t.ArgumentError.$new("missing keyword: round_type");return c=i.$$smap.round_type,h(u,t.find_super_dispatcher(u,"initialize",$,!1,!0),"initialize",[],null),u.notations=a,u.round_type=c,u.prefix_number=!1,u.suffix_number=!1,u.need_prefix_number=!1,u.need_suffix_number=!1,u.modifier=!0,u.critical=!1,u.fumble=!1,u.dollar=!1,u.allowed_cmp_op=[s,">=",">","<=","<","==","!="],u.question_target=!1},$.$$arity=-2),t.def(pt,"$disable_modifier",a=function(){return this.modifier=!1,this},a.$$arity=0),t.def(pt,"$enable_prefix_number",_=function(){return this.prefix_number=!0,this},_.$$arity=0),t.def(pt,"$enable_suffix_number",m=function(){return this.suffix_number=!0,this},m.$$arity=0),t.def(pt,"$has_prefix_number",y=function(){return this.prefix_number=!0,this.need_prefix_number=!0,this},y.$$arity=0),t.def(pt,"$has_suffix_number",g=function(){return this.suffix_number=!0,this.need_suffix_number=!0,this},g.$$arity=0),t.def(pt,"$enable_critical",b=function(){return this.critical=!0,this},b.$$arity=0),t.def(pt,"$enable_fumble",R=function(){return this.fumble=!0,this},R.$$arity=0),t.def(pt,"$enable_dollar",v=function(){return this.dollar=!0,this},v.$$arity=0),t.def(pt,"$restrict_cmp_op_to",T=function(e){var r,n=this;return r=t.slice.call(arguments,0,arguments.length),n.allowed_cmp_op=r,n},T.$$arity=-1),t.def(pt,"$enable_question_target",w=function(){return this.question_target=!0,this},w.$$arity=0),t.def(pt,"$parse",E=function(e){try{return this.lexer=o(mt,"Lexer").$new(e,this.notations),this.$do_parse()}catch(r){if(!t.rescue(r,[o(mt,"ParseError"),o(mt,"ZeroDivisionError")]))throw r;try{return s}finally{t.pop_exception()}}},E.$$arity=1),pt.$private(),t.def(pt,"$parsed",x=function(r,n,i,$){var a;return d(o(mt,"Parsed").$new(),"tap",[],((a=function(c){var o,u,_,l,h,f,p=null==a.$$s?this:a.$$s,m=s;return null==p.round_type&&(p.round_type=s),null==c&&(c=s),m=[r["$[]"]("command")],d(c,"command=",t.to_a(m)),e(m.length,1),m=[(o=r["$[]"]("prefix"),o===s||null==o?s:d(o,"eval",[p.round_type]))],d(c,"prefix_number=",t.to_a(m)),e(m.length,1),m=[(u=r["$[]"]("suffix"),u===s||null==u?s:d(u,"eval",[p.round_type]))],d(c,"suffix_number=",t.to_a(m)),e(m.length,1),m=[(_=n["$[]"]("critical"),_===s||null==_?s:d(_,"eval",[p.round_type]))],d(c,"critical=",t.to_a(m)),e(m.length,1),m=[(l=n["$[]"]("fumble"),l===s||null==l?s:d(l,"eval",[p.round_type]))],d(c,"fumble=",t.to_a(m)),e(m.length,1),m=[(h=n["$[]"]("dollar"),h===s||null==h?s:d(h,"eval",[p.round_type]))],d(c,"dollar=",t.to_a(m)),e(m.length,1),m=[i.$eval(p.round_type)],d(c,"modify_number=",t.to_a(m)),e(m.length,1),m=[$["$[]"]("cmp_op")],d(c,"cmp_op=",t.to_a(m)),e(m.length,1),$["$[]"]("target")["$=="]("?")?(d(c,"question_target=",t.to_a(m=[!0])),e(m.length,1),d(c,"target_number=",t.to_a(m=[0])),m[e(m.length,1)]):(d(c,"question_target=",t.to_a(m=[!1])),e(m.length,1),m=[(f=$["$[]"]("target"),f===s||null==f?s:d(f,"eval",[p.round_type]))],d(c,"target_number=",t.to_a(m)),m[e(m.length,1)])}).$$s=this,a.$$arity=1,a))},x.$$arity=4),t.def(pt,"$next_token",L=function(){return this.lexer.$next_token()},L.$$arity=0),at=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,s,5,36,37,17,18,6,s,5,36,37,17,18,6,s,5,36,37,17,18,6,s,5,33,34,17,18,6,s,5,36,37,17,18,6,s,5,36,37,17,18,6,s,5,36,37,17,18,6,s,5,36,37,17,18,6,s,5,s,s,17,18,6,s,5,s,s,17,18,s,s,5,23,24,25,26,56,54,55,57],st=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,s,17,15,15,18,18,23,s,18,30,30,23,23,24,s,23,31,31,24,24,25,s,24,44,44,25,25,28,s,25,47,47,28,28,29,s,28,48,48,29,29,33,s,29,49,49,33,33,34,s,33,50,50,34,34,36,s,34,s,s,36,36,37,s,36,s,s,37,37,s,s,37,27,27,27,27,52,52,52,52],ct=[-2,4,16,-3,-1,11,s,33,13,35,23,30,1,s,28,40,s,37,44,s,s,-2,s,51,58,65,0,106,72,79,47,54,s,86,93,s,100,107,s,s,s,s,s,s,63,s,s,68,75,82,89,s,120,s,s,s,s,s],ot=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],ut=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,s,s,21,47,48,40,51,52,49,50,44,46,3,s,s,s,13,s,s,s,s,s,s,s,32],_t=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,s,s,4,8,8,5,7,7,8,8,9,5,6,s,s,s,6,s,s,s,s,s,s,s,6],lt=[s,6,13,3,9,-1,27,-15,-10,-1,-38],ht=[s,s,s,s,s,s,19,16,15,s,s],dt=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ft=f(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),t.const_set(mt[0],"Racc_arg",[at,st,ot,ct,ut,_t,ht,lt,19,dt,ft,58,35,!0]),t.const_set(mt[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),t.const_set(mt[0],"Racc_debug_parser",!1),t.def(pt,"$_reduce_1",D=function(e,r,n){var i;return p(this.modifier)||this.$raise(o(mt,"ParseError")),i=t.to_ary(e),this.$parsed(null==i[0]?s:i[0],null==i[1]?s:i[1],null==i[2]?s:i[2],null==i[3]?s:i[3])},D.$$arity=3),t.def(pt,"$_reduce_2",O=function(e,r,n){var i;return p(this.modifier)||this.$raise(o(mt,"ParseError")),i=t.to_ary(e),this.$parsed(null==i[0]?s:i[0],null==i[2]?s:i[2],null==i[1]?s:i[1],null==i[3]?s:i[3])},O.$$arity=3),t.def(pt,"$_reduce_3",k=function(e,r,n){var i,$;return $=null==(i=t.to_ary(e))[2]?s:i[2],this.$parsed(null==i[0]?s:i[0],null==i[1]?s:i[1],c(c(o(mt,"Arithmetic"),"Node"),"Number").$new(0),$)},k.$$arity=3),t.def(pt,"$_reduce_4",S=function(t,e,r){var n;return p(p(n=this.prefix_number)?this.suffix_number:n)||this.$raise(o(mt,"ParseError")),l(["command","prefix","suffix"],{command:t["$[]"](1),prefix:t["$[]"](0),suffix:t["$[]"](2)})},S.$$arity=3),t.def(pt,"$_reduce_5",A=function(t,e,r){return p(this.prefix_number)||this.$raise(o(mt,"ParseError")),p(this.need_suffix_number)&&this.$raise(o(mt,"ParseError")),l(["command","prefix"],{command:t["$[]"](1),prefix:t["$[]"](0)})},A.$$arity=3),t.def(pt,"$_reduce_6",M=function(t,e,r){return p(this.suffix_number)||this.$raise(o(mt,"ParseError")),p(this.need_prefix_number)&&this.$raise(o(mt,"ParseError")),l(["command","suffix"],{command:t["$[]"](0),suffix:t["$[]"](1)})},M.$$arity=3),t.def(pt,"$_reduce_7",I=function(t,e,r){var n;return p(p(n=this.need_prefix_number)?n:this.need_suffix_number)&&this.$raise(o(mt,"ParseError")),l(["command"],{command:t["$[]"](0)})},I.$$arity=3),t.def(pt,"$_reduce_8",C=function(t,e,r){return l([],{})},C.$$arity=3),t.def(pt,"$_reduce_9",N=function(r,n,i){var $,a,c,u,_=s;return _=null==($=t.to_ary(r))[0]?s:$[0],a=null==$[2]?s:$[2],p(p(u=this.critical)?_["$[]"]("critical")["$nil?"]():u)||this.$raise(o(mt,"ParseError")),d(_,"[]=",t.to_a(c=["critical",a])),e(c.length,1),_},N.$$arity=3),t.def(pt,"$_reduce_10",P=function(r,n,i){var $,a,c,u,_=s;return _=null==($=t.to_ary(r))[0]?s:$[0],a=null==$[2]?s:$[2],p(p(u=this.fumble)?_["$[]"]("fumble")["$nil?"]():u)||this.$raise(o(mt,"ParseError")),d(_,"[]=",t.to_a(c=["fumble",a])),e(c.length,1),_},P.$$arity=3),t.def(pt,"$_reduce_11",H=function(r,n,i){var $,a,c,u,_=s;return _=null==($=t.to_ary(r))[0]?s:$[0],a=null==$[2]?s:$[2],p(p(u=this.dollar)?_["$[]"]("dollar")["$nil?"]():u)||this.$raise(o(mt,"ParseError")),d(_,"[]=",t.to_a(c=["dollar",a])),e(c.length,1),_},H.$$arity=3),t.def(pt,"$_reduce_12",B=function(t,e,r){return t["$[]"](1)},B.$$arity=3),t.def(pt,"$_reduce_13",G=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"Negative").$new(t["$[]"](1))},G.$$arity=3),t.def(pt,"$_reduce_14",z=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"+",t["$[]"](2))},z.$$arity=3),t.def(pt,"$_reduce_15",U=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"-",t["$[]"](2))},U.$$arity=3),t.def(pt,"$_reduce_16",F=function(t,e,r){return p(this.allowed_cmp_op["$include?"](s))||this.$raise(o(mt,"ParseError")),l([],{})},F.$$arity=3),t.def(pt,"$_reduce_17",q=function(e,r,n){var i,$,a;return a=null==(i=t.to_ary(e))[1]?s:i[1],p(this.allowed_cmp_op["$include?"]($=null==i[0]?s:i[0]))||this.$raise(o(mt,"ParseError")),l(["cmp_op","target"],{cmp_op:$,target:a})},q.$$arity=3),t.def(pt,"$_reduce_18",j=function(t,e,r){var n;return n=t["$[]"](0),p(this.question_target)||this.$raise(o(mt,"ParseError")),p(this.allowed_cmp_op["$include?"](n))||this.$raise(o(mt,"ParseError")),l(["cmp_op","target"],{cmp_op:n,target:"?"})},j.$$arity=3),t.def(pt,"$_reduce_19",W=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"+",t["$[]"](2))},W.$$arity=3),t.def(pt,"$_reduce_20",X=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"-",t["$[]"](2))},X.$$arity=3),t.def(pt,"$_reduce_22",Y=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"*",t["$[]"](2))},Y.$$arity=3),t.def(pt,"$_reduce_23",V=function(t,e,r){return t["$[]"](3).$new(t["$[]"](0),t["$[]"](2))},V.$$arity=3),t.def(pt,"$_reduce_25",K=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},K.$$arity=3),t.def(pt,"$_reduce_26",Q=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"DivideWithCeil")},Q.$$arity=3),t.def(pt,"$_reduce_27",J=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"DivideWithCeil")},J.$$arity=3),t.def(pt,"$_reduce_28",Z=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"DivideWithRound")},Z.$$arity=3),t.def(pt,"$_reduce_29",tt=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"DivideWithFloor")},tt.$$arity=3),t.def(pt,"$_reduce_30",et=function(t,e,r){return t["$[]"](1)},et.$$arity=3),t.def(pt,"$_reduce_31",rt=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"Negative").$new(t["$[]"](1))},rt.$$arity=3),t.def(pt,"$_reduce_33",nt=function(t,e,r){return t["$[]"](1)},nt.$$arity=3),t.def(pt,"$_reduce_34",it=function(t,e,r){return c(c(o(mt,"Arithmetic"),"Node"),"Number").$new(t["$[]"](0))},it.$$arity=3),t.def(pt,"$_reduce_none",$t=function(t,e,r){return t["$[]"](0)},$t.$$arity=3)}(i[0],c(o(i,"Racc"),"Parser"),i)}(i[0],i)}(a[0],a)},Opal.modules["bcdice/dice_table/table"]=function(t){var e=[],r=t.nil,n=t.$$,i=t.module,$=t.klass,a=t.hash2,s=t.truthy;return function(e,c){var o=[i(e,"BCDice")].concat(c);!function(e,c){var o=[i(e,"DiceTable")].concat(c);!function(e,i,c){var o,u,_,l,h=$(e,null,"Table"),d=[h].concat(c);h.$$prototype.times=h.$$prototype.sides=h.$$prototype.name=h.$$prototype.items=r,t.defs(h,"$from_i18n",o=function(t,e){var i=r;return i=n(d,"I18n").$t(t,a(["locale"],{locale:e})),this.$new(i["$[]"]("name"),i["$[]"]("type"),i["$[]"]("items"))},o.$$arity=2),t.def(h,"$initialize",u=function(t,e,i){var $=r;return this.name=t,this.items=i.$freeze(),$=/(\d+)D(\d+)/i.$match(e),s($)||this.$raise(n(d,"ArgumentError"),"Unexpected table type: "+e),this.times=$["$[]"](1).$to_i(),this.sides=$["$[]"](2).$to_i()},u.$$arity=3),t.def(h,"$roll",_=function(t){var e;return e=t.$roll_sum(this.times,this.sides),this.$choice(e)},_.$$arity=1),t.def(h,"$choice",l=function(t){var e,r,i;return r=this.times,i="number"==typeof(e=t)&&"number"==typeof r?e-r:e["$-"](r),n(d,"RollResult").$new(this.name,t,this.items["$[]"](i))},l.$$arity=1)}(o[0],0,o)}(o[0],o)}(e[0],e)},Opal.modules["bcdice/dice_table/range_table"]=function(t){var e=[],r=t.nil,n=t.$$,i=t.module,$=t.klass,a=t.send,s=t.truthy;return function(e,c){var o=[i(e,"BCDice")].concat(c);!function(e,c){var o=[i(e,"DiceTable")].concat(c);!function(e,i,c){var o,u,_,l,h,d,f,p,m,y=$(e,null,"RangeTable"),g=[y].concat(c);y.$$prototype.name=y.$$prototype.items=y.$$prototype.num_of_dice=y.$$prototype.num_of_sides=y.$$prototype.formatter=r,t.const_set(g[0],"RollResult",a(n(g,"Struct"),"new",["sum","values","content","formatted"],((o=function(){return(null==o.$$s?this:o.$$s).$alias_method("to_s","formatted")}).$$s=y,o.$$arity=0,o))),t.const_set(g[0],"Item",n(g,"Struct").$new("range","content")),t.const_set(g[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),t.const_set(g[0],"DEFAULT_FORMATTER",a(y,"lambda",[],($$2=function(t,e){return null==$$2.$$s||$$2,null==t&&(t=r),null==e&&(e=r),t.$name()+"("+e.$sum()+") \uff1e "+e.$content()},$$2.$$s=y,$$2.$$arity=2,$$2))),y.$attr_reader("name"),y.$attr_reader("num_of_dice"),y.$attr_reader("num_of_sides"),t.def(y,"$initialize",u=function(t,e,i){var $,a=u.$$p,c=a||r,o=r;return a&&(u.$$p=null),a&&(u.$$p=null),this.name=t.$freeze(),this.formatter=s($=c)?$:n(g,"DEFAULT_FORMATTER"),o=n(g,"DICE_ROLL_METHOD_RE").$match(e),s(o)||this.$raise(n(g,"ArgumentError"),this.name+": invalid dice roll method: "+e),this.num_of_dice=o["$[]"](1).$to_i(),this.num_of_sides=o["$[]"](2).$to_i(),this.$store(i)},u.$$arity=3),t.def(y,"$fetch",_=function(t){var e,i;return i=a(this.items,"find",[],((e=function(e){return null==e&&(e=r),e.$range()["$include?"](t)}).$$s=this,e.$$arity=1,e)),s(i)||this.$raise(n(g,"RangeError"),this.name+": value is out of range: "+t),i},_.$$arity=1),t.def(y,"$roll",l=function(e){var i,$,s,c,o=r;return i=(o=e.$roll_barabara(this.num_of_dice,this.num_of_sides)).$sum(),$=n(g,"RollResult").$new(i,o,this.$fetch(i).$content()),s=[this.formatter["$[]"](this,$)],a($,"formatted=",t.to_a(s)),"number"==typeof(c=s.length)||c["$-"](1),$},l.$$arity=1),y.$private(),t.def(y,"$store",h=function(t){var e,i,$,s,c;return s=a(t,"map",[],((e=function(t,n){return null==t&&(t=r),null==n&&(n=r),[(null==e.$$s?this:e.$$s).$coerce_to_int_range(t),n]}).$$s=this,e.$$arity=2,e)),c=a(s,"sort_by",[],((i=function(t,e){return null==t&&(t=r),null==e&&(e=r),t.$min()}).$$s=this,i.$$arity=2,i)),this.$assert_min_sum_is_covered(c),this.$assert_max_sum_is_covered(c),this.$assert_no_gap_or_overlap_in_ranges(c),this.items=a(c,"map",[],($=function(t,e){return null==t&&(t=r),null==e&&(e=r),n(g,"Item").$new(t,e.$freeze()).$freeze()},$.$$s=this,$.$$arity=2,$)).$freeze(),this},h.$$arity=1),t.def(y,"$coerce_to_int_range",d=function(t){var e,i=r;return e=t,n(g,"Integer")["$==="](e)?n(g,"Range").$new(t,t):n(g,"Range")["$==="](e)&&s(s(i=t.$begin()["$is_a?"](n(g,"Integer")))?t.$end()["$is_a?"](n(g,"Integer")):i)?t:this.$raise(n(g,"TypeError"),this.name+": "+t+" ("+t.$class()+") must be an Integer or a Range with Integers ")},d.$$arity=1),t.def(y,"$assert_min_sum_is_covered",f=function(t){var e,i=r;return e=this.num_of_dice,i=t.$first()["$[]"](0),s(i["$include?"](e))||this.$raise(n(g,"RangeError"),this.name+": min value ("+e+") is not covered: "+i),this},f.$$arity=1),t.def(y,"$assert_max_sum_is_covered",p=function(t){var e,i,$,a=r;return i=this.num_of_sides,$="number"==typeof(e=this.num_of_dice)&&"number"==typeof i?e*i:e["$*"](i),a=t.$last()["$[]"](0),s(a["$include?"]($))||this.$raise(n(g,"RangeError"),this.name+": max value ("+$+") is not covered: "+a),this},p.$$arity=1),t.def(y,"$assert_no_gap_or_overlap_in_ranges",m=function(t){var e;return a(t,"each_cons",[2],((e=function(t,i){var $,a,c,o=null==e.$$s?this:e.$$s,u=r,_=r;return null==o.name&&(o.name=r),null==t&&(t=r),null==i&&(i=r),u=t["$[]"](0),_=i["$[]"](0),c="number"==typeof(a=$=u.$max())?a+1:a["$+"](1),s(_["$include?"]($))&&o.$raise(n(g,"RangeError"),o.name+": Range overlap: "+u+" and "+_),s(_["$include?"](c))?r:o.$raise(n(g,"RangeError"),o.name+": Range gap: "+u+" and "+_)}).$$s=this,e.$$arity=2,e)),this},m.$$arity=1)}(o[0],0,o)}(o[0],o)}(e[0],e)},function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t*e:t["$*"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var a=t.top,s=[],c=t.nil,o=t.$$$,u=t.$$,_=t.module,l=t.klass,h=t.truthy,d=t.hash2,f=t.send,p=t.range,m=t.hash;a.$require("bcdice/format"),a.$require("bcdice/command/parser"),a.$require("bcdice/dice_table/table"),a.$require("bcdice/dice_table/range_table"),function(a,s){var y=[_(a,"BCDice")].concat(s);!function(a,s){var y=[_(a,"GameSystem")].concat(s);!function(a,s,_){var y,g,b,R,v,T,w,E,x,L,D,O,k,S=l(a,s,"BattleTech"),A=[S].concat(_);S.$$prototype.randomizer=c,t.const_set(A[0],"ID","BattleTech"),t.const_set(A[0],"NAME","\u30d0\u30c8\u30eb\u30c6\u30c3\u30af"),t.const_set(A[0],"SORT_KEY","\u306f\u3068\u308b\u3066\u3064\u304f"),t.const_set(A[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u65b9\u6cd5\n\u3000(\u56de\u6570)BT(\u30c0\u30e1\u30fc\u30b8)(\u90e8\u4f4d)+(\u57fa\u672c\u5024)>=(\u76ee\u6a19\u5024)\n\u3000\u56de\u6570\u306f\u7701\u7565\u6642 1\u56fa\u5b9a\u3002\n\u3000\u90e8\u4f4d\u306fC\uff08\u6b63\u9762\uff09R\uff08\u53f3\uff09\u3001L\uff08\u5de6\uff09\u3002\u7701\u7565\u6642\u306fC\uff08\u6b63\u9762\uff09\u56fa\u5b9a\n\u3000U\uff08\u4e0a\u534a\u8eab\uff09\u3001L\uff08\u4e0b\u534a\u8eab\uff09\u3092\u7d44\u307f\u5408\u308f\u305b CU/RU/LU/CL/RL/LL\u3082\u6307\u5b9a\u53ef\u80fd\n\u3000\u4f8b\uff09BT3+2>=4\n\u3000\u3000\u6b63\u9762\u304b\u3089\u30c0\u30e1\u30fc\u30b83\u306e\u653b\u6483\u3092\u6280\u80fd\u30d9\u30fc\u30b92\u76ee\u6a19\u50244\u30671\u56de\u5224\u5b9a\n\u3000\u4f8b\uff092BT3RL+5>=8\n\u3000\u3000\u53f3\u4e0b\u534a\u8eab\u306b\u30c0\u30e1\u30fc\u30b83\u306e\u653b\u6483\u3092\u6280\u80fd\u30d9\u30fc\u30b95\u76ee\u6a19\u50248\u30672\u56de\u5224\u5b9a\n\u3000\u30df\u30b5\u30a4\u30eb\u306b\u3088\u308b\u30c0\u30e1\u30fc\u30b8\u306f BT(\u30c0\u30e1\u30fc\u30b8) \u306e\u4ee3\u308f\u308a\u306b SRM2/4/6, LRM5/10/15/20 \u3092\u6307\u5b9a\n\u3000\u4f8b\uff093SRM6LU+5>=8\n\u3000\u3000\u5de6\u4e0a\u534a\u8eab\u306bSRM6\u9023\u3092\u6280\u80fd\u30d9\u30fc\u30b95\u76ee\u6a19\u50248\u30673\u56de\u5224\u5b9a\n  BT(\u30c0\u30e1\u30fc\u30b8) \u306e\u4ee3\u308f\u308a\u306b PPC \u3092\u6307\u5b9a\u3059\u308b\u3068\u30c0\u30e1\u30fc\u30b810\u3067\u5224\u5b9a\n  \u4f8b\uff092PPCR+3>=10\n  \u3000\u53f3\u5074\u304b\u3089PPC\uff08\u30c0\u30e1\u30fc\u30b810\uff09\u306b\u3088\u308b\u653b\u6483\u3092\u6280\u80fd\u30d9\u30fc\u30b93\u76ee\u6a19\u502410\u30672\u56de\u5224\u5b9a\n\u30fbCT\uff1a\u81f4\u547d\u7684\u547d\u4e2d\u8868\n\u30fbDW\uff1a\u8ee2\u5012\u5f8c\u306e\u5411\u304d\u8868\n\u30fbCDx\uff1a\u30e1\u30c3\u30af\u6226\u58eb\u610f\u8b58\u7dad\u6301\u30ed\u30fc\u30eb\u3002\u30c0\u30e1\u30fc\u30b8\u5024x\uff081\u301c6\uff09\u3067\u5224\u5b9a\u3000\u4f8b\uff09CD3\n"),S.$register_prefix("\\d*SRM","\\d*LRM","\\d*BT","\\d*PPC","CT","DW","CD"),t.const_set(A[0],"NO_CRITICAL_HIT_LIMIT",7),t.defs(S,"$ppc_parser",y=function(){return null==this.ppc_parser&&(this.ppc_parser=c),h(this.ppc_parser)||(this.ppc_parser=o(u(A,"Command"),"Parser").$new(/PPC(?:[LCR][LU]?)?/,d(["round_type"],{round_type:o(u(A,"RoundType"),"FLOOR")})),this.ppc_parser.$enable_prefix_number(),this.ppc_parser.$restrict_cmp_op_to(">=")),this.ppc_parser},y.$$arity=0),t.def(S,"$ppc_parser",g=function(){return this.$class().$ppc_parser()},g.$$arity=0),t.def(S,"$eval_game_system_specific_command",b=function(e){var r=c,n=c,i=c,$=c,a=c,s=c,o=c,_=c,l=c;try{return r=this.$roll_tables(e,u(A,"TABLES")),h(r)?r:h(n=this.$ppc_parser().$parse(e))?this.$execute_ppc(n):(i=1,h(e["$=~"](/^(\d+)(.+)/))&&(i=u(A,"Regexp").$last_match(1).$to_i(),e=u(A,"Regexp").$last_match(2)),this.$debug("executeCommandCatched count",i),this.$debug("executeCommandCatched command",e),/^CD([1-6])$/["$==="]($=e)?(a=u(A,"Regexp").$last_match(1).$to_i(),this.$consciousness_roll(a)):/^((S|L)RM\d+)(.+)/["$==="]($)?(s=u(A,"Regexp").$last_match(3),o=u(A,"Regexp").$last_match(1),_=f(this,"lambda",[],($$4=function(){return(null==$$4.$$s?this:$$4.$$s).$getXrmDamage(o)},$$4.$$s=this,$$4.$$arity=0,$$4)),this.$getHitResult(i,_,s)):/^BT(\d+)(.+)/["$==="]($)?(this.$debug("BT pattern"),s=u(A,"Regexp").$last_match(2),l=u(A,"Regexp").$last_match(1).$to_i(),_=f(this,"lambda",[],($$5=function(){return null==$$5.$$s||$$5,l},$$5.$$s=this,$$5.$$arity=0,$$5)),this.$getHitResult(i,_,s)):c)}catch(d){if(!t.rescue(d,[u(A,"UnknownXRMError")]))throw d;try{return c}finally{t.pop_exception()}}},b.$$arity=1),function(t,e,r){[l(t,e,"UnknownXRMError")].concat(r)}(A[0],u(A,"StandardError"),A),t.def(S,"$getXrmDamage",R=function(t){var r,n,i=c;return h(u(A,"XRM_DAMAGE_TABLES")["$key?"](t))||this.$raise(u(A,"UnknownXRMError"),"unknown XRM: "+t),i=u(A,"XRM_DAMAGE_TABLES")["$[]"](t).$roll(this.randomizer),r=t["$start_with?"]("L"),n=i.$content(),[h(r)?n:e(2,n),i.$sum(),r]},R.$$arity=1),t.const_set(A[0],"LRM_LIMIT",5),t.def(S,"$getHitResult",v=function(e,i,$){var a,s,_,l,p,m,y,g,b,R,v=c,T=c,w=c,E=c,x=c;return v=/^([LCR][LU]?)?(\+\d+)?>=(\d+)/.$match($),h(v)?(s=h(T=v["$[]"](1))?T:"C",_=v["$[]"](2),l=v["$[]"](3).$to_i(),p=this.$getBaseValue(_),this.$debug("side, base, target",s,p,l),m=o(u(A,"HitPart"),"TABLES")["$[]"](s),w=[],E=d([],{}),x=0,f(e,"times",[],((a=function(){var e,n,$=null==a.$$s?this:a.$$s,s=c;return n=$.$getHitText(p,l),s=null==(e=t.to_ary(n))[1]?c:e[1],h(null==e[0]?c:e[0])&&(x=r(x,1),n=$.$getDamages(i,m,E),e=t.to_ary(n),E=null==e[0]?c:e[0],s=r(s,null==e[1]?c:e[1])),w["$<<"](s)}).$$s=this,a.$$arity=0,a)),y=n(x,0),g=" \uff1e "+x+"\u56de\u547d\u4e2d",b=h(y)?g+" \u547d\u4e2d\u7b87\u6240\uff1a"+this.$getTotalDamage(E):g,w.$push(b),R=w.$join("\n"),h(y)?u(A,"Result").$success(R):u(A,"Result").$failure(R)):c},v.$$arity=3),t.def(S,"$getBaseValue",T=function(t){var e=c;return e=0,h(t["$nil?"]())?e:e=u(A,"ArithmeticEvaluator").$eval(t)},T.$$arity=1),t.def(S,"$getHitText",w=function(t,e){var $,a,s,o,u=c;return o=i(s=r(r($=this.randomizer.$roll_once(6),a=this.randomizer.$roll_once(6)),t),e),u=s+"["+$+","+a+(h(n(t,0))?"+"+t:"")+"]>="+e+" \uff1e ",[o,u=h(o)?r(u,"\u547d\u4e2d \uff1e "):r(u,"\u5916\u308c")]},w.$$arity=2),t.def(S,"$getDamages",E=function(n,i,a){var s,o,_,l,p,m,y,g,b=c,R=c;return b="",o=n.$call(),s=t.to_ary(o),l=null==s[0]?c:s[0],p=null==s[1]?c:s[1],R=1,h(m=null==s[2]?c:s[2])&&(R=(y=e(1,l),g=u(A,"LRM_LIMIT"),"number"==typeof y&&"number"==typeof g?y/g:y["$/"](g)).$ceil(),b=r(b,"["+p+"] "+l+"\u70b9")),f(R,"times",[],((_=function(e){var n,s,o,u,y,g=null==_.$$s?this:_.$$s,R=c,v=c;return null==e&&(e=c),s=g.$getDamageInfo(p,l,m,e),o=null==(n=t.to_ary(s))[0]?c:n[0],s=g.$getHitResultOne(null==n[1]?c:n[1],i),u=null==(n=t.to_ary(s))[0]?c:n[0],y=null==n[1]?c:n[1],R=null==n[2]?c:n[2],h(m)&&(b=r(b," ")),b=r(b,u),h(a["$[]"](y)["$nil?"]())&&(v=[y,d(["partDamages","criticals"],{partDamages:[],criticals:[]})],f(a,"[]=",t.to_a(v)),$(v.length,1)),a["$[]"](y)["$[]"]("partDamages")["$<<"](o),h(R["$empty?"]())?c:a["$[]"](y)["$[]"]("criticals")["$<<"](R)}).$$s=this,_.$$arity=1,_)),[a,b]},E.$$arity=3),t.def(S,"$getDamageInfo",x=function(t,r,i,a){var s=c;return h(t["$nil?"]())?[r,r.$to_s()]:h(i)?(s=$(r,e(u(A,"LRM_LIMIT"),a)),h(n(s,u(A,"LRM_LIMIT")))&&(s=u(A,"LRM_LIMIT")),[s,s.$to_s()]):[r,"["+t+"] "+r]},x.$$arity=4),t.def(S,"$getTotalDamage",L=function(t){var e,n=c,i=c;return n=0,i=[],f(["\u982d","\u80f4\u4e2d\u592e","\u53f3\u80f4","\u5de6\u80f4","\u53f3\u811a","\u5de6\u811a","\u53f3\u8155","\u5de6\u8155"],"each",[],((e=function($){var a,s,o,u=null==e.$$s?this:e.$$s,_=c,l=c,d=c;return null==$&&($=c),_=t.$delete($),h(_["$nil?"]())?c:(s=f(_["$[]"]("partDamages"),"inject",[0],((a=function(t,e){return null==t&&(t=c),null==e&&(e=c),r(t,e)}).$$s=u,a.$$arity=2,a)),n=r(n,s),o=_["$[]"]("partDamages").$size(),l=_["$[]"]("criticals"),d=r(d="",$+"("+o+"\u56de) "+s+"\u70b9"),h(l["$empty?"]())||(d=r(d," "+l.$join(" "))),i["$<<"](d))}).$$s=this,e.$$arity=1,e)),h(t["$empty?"]())||this.$raise("damages rest!! "+t.$inspect()),r(i.$join(" \uff0f ")," \uff1e \u5408\u8a08\u30c0\u30e1\u30fc\u30b8 "+n+"\u70b9")},L.$$arity=1),t.def(S,"$getHitResultOne",D=function(t,e){var r,i=c,$=c,a=c,s=c,o=c;return $=(i=e.$roll(this.randomizer)).$content(),r=h($.$critical_hit_may_occur())?"\uff08\u81f4\u547d\u7684\u547d\u4e2d\uff09":"",a=[["["+i.$sum()+"]",""+$.$name()+r,t+"\u70b9"].$join(" ")],s="",h($.$critical_hit_may_occur())&&(o=u(A,"TABLES")["$[]"]("CT").$roll(this.randomizer),h(n(o.$sum(),u(A,"NO_CRITICAL_HIT_LIMIT")))&&(s=o.$content()),a.$push("["+o.$sum()+"] "+o.$content())),[a.$join(" \uff1e "),$.$name(),s]},D.$$arity=2),t.def(S,"$consciousness_roll",O=function(t){var e,r,n,$,a,s,o,_=c;return h(p(1,6,!1)["$include?"](t))?(e="CD"+t,t["$=="](6)?u(A,"Result").$fumble(e+" \uff1e \u6b7b\u4ea1"):(n="(2D6>="+(r=m(1,3,2,5,3,7,4,10,5,11)["$[]"](t))+")",a=($=(_=this.randomizer.$roll_barabara(2,6)).$sum())+"["+_.$join(",")+"]",s=i($,r),o=[e,n,a,$,h(s)?"\u6210\u529f":"\u5931\u6557"].$join(" \uff1e "),h(s)?u(A,"Result").$success(o):u(A,"Result").$failure(o))):c},O.$$arity=1),t.def(S,"$execute_ppc",k=function(t){var e,r,n;return e=h(n=t.$prefix_number())?n:1,r=""+t.$command()["$[]"](p(3,-1,!1))+u(A,"Format").$modifier(t.$modify_number())+">="+t.$target_number(),this.$getHitResult(e,f(this,"lambda",[],($$20=function(){return null==$$20.$$s||$$20,10},$$20.$$s=this,$$20.$$arity=0,$$20)),r)},k.$$arity=1),t.const_set(A[0],"TABLES",d(["CT","DW"],{CT:o(u(A,"DiceTable"),"RangeTable").$new("\u81f4\u547d\u7684\u547d\u4e2d\u8868","2D6",[[t.Range.$new(2,u(A,"NO_CRITICAL_HIT_LIMIT"),!1),"\u81f4\u547d\u7684\u547d\u4e2d\u306f\u306a\u304b\u3063\u305f"],[p(8,9,!1),"1\u7b87\u6240\u306e\u81f4\u547d\u7684\u547d\u4e2d"],[p(10,11,!1),"2\u7b87\u6240\u306e\u81f4\u547d\u7684\u547d\u4e2d"],[12,"\u305d\u306e\u90e8\u4f4d\u304c\u5439\u304d\u98db\u3076\uff08\u8155\u3001\u811a\u3001\u982d\uff09\u307e\u305f\u306f3\u7b87\u6240\u306e\u81f4\u547d\u7684\u547d\u4e2d\uff08\u80f4\uff09"]]),DW:o(u(A,"DiceTable"),"Table").$new("\u8ee2\u5012\u5f8c\u306e\u5411\u304d\u8868","1D6",["\u540c\u3058\uff08\u524d\u9762\u304b\u3089\u8ee2\u5012\uff09 \u6b63\u9762\uff0f\u80cc\u9762","1\u30d8\u30af\u30b9\u30b5\u30a4\u30c9\u53f3\uff08\u5074\u9762\u304b\u3089\u8ee2\u5012\uff09 \u53f3\u5074\u9762","2\u30d8\u30af\u30b9\u30b5\u30a4\u30c9\u53f3\uff08\u5074\u9762\u304b\u3089\u8ee2\u5012\uff09 \u53f3\u5074\u9762","180\u5ea6\u9006\uff08\u80cc\u9762\u304b\u3089\u8ee2\u5012\uff09 \u6b63\u9762\uff0f\u80cc\u9762","2\u30d8\u30af\u30b9\u30b5\u30a4\u30c9\u5de6\uff08\u5074\u9762\u304b\u3089\u8ee2\u5012\uff09 \u5de6\u5074\u9762","1\u30d8\u30af\u30b9\u30b5\u30a4\u30c9\u5de6\uff08\u5074\u9762\u304b\u3089\u8ee2\u5012\uff09 \u5de6\u5074\u9762"])}).$freeze()),t.const_set(A[0],"HitPart",u(A,"Struct").$new("name","critical_hit_may_occur")),function(e,r,n){var i=l(e,null,"HitPart"),$=[i].concat(n);t.const_set($[0],"LEFT_TORSO","\u5de6\u80f4"),t.const_set($[0],"CENTER_TORSO","\u80f4\u4e2d\u592e"),t.const_set($[0],"RIGHT_TORSO","\u53f3\u80f4"),t.const_set($[0],"LEFT_ARM","\u5de6\u8155"),t.const_set($[0],"RIGHT_ARM","\u53f3\u8155"),t.const_set($[0],"LEFT_LEG","\u5de6\u811a"),t.const_set($[0],"RIGHT_LEG","\u53f3\u811a"),t.const_set($[0],"HEAD","\u982d"),t.const_set($[0],"TABLES",d(["L","C","R","LU","CU","RU","LL","CL","RL"],{L:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u5de6\uff09","2D6",[[2,i.$new(u($,"LEFT_TORSO"),!0)],[3,i.$new(u($,"LEFT_LEG"),!1)],[p(4,5,!1),i.$new(u($,"LEFT_ARM"),!1)],[6,i.$new(u($,"LEFT_LEG"),!1)],[7,i.$new(u($,"LEFT_TORSO"),!1)],[8,i.$new(u($,"CENTER_TORSO"),!1)],[9,i.$new(u($,"RIGHT_TORSO"),!1)],[10,i.$new(u($,"RIGHT_ARM"),!1)],[11,i.$new(u($,"RIGHT_LEG"),!1)],[12,i.$new(u($,"HEAD"),!1)]]),C:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u6b63\u9762\uff09","2D6",[[2,i.$new(u($,"CENTER_TORSO"),!0)],[p(3,4,!1),i.$new(u($,"RIGHT_ARM"),!1)],[5,i.$new(u($,"RIGHT_LEG"),!1)],[6,i.$new(u($,"RIGHT_TORSO"),!1)],[7,i.$new(u($,"CENTER_TORSO"),!1)],[8,i.$new(u($,"LEFT_TORSO"),!1)],[9,i.$new(u($,"LEFT_LEG"),!1)],[p(10,11,!1),i.$new(u($,"LEFT_ARM"),!1)],[12,i.$new(u($,"HEAD"),!1)]]),R:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u53f3\uff09","2D6",[[2,i.$new(u($,"RIGHT_TORSO"),!0)],[3,i.$new(u($,"RIGHT_LEG"),!1)],[p(4,5,!1),i.$new(u($,"RIGHT_ARM"),!1)],[6,i.$new(u($,"RIGHT_LEG"),!1)],[7,i.$new(u($,"RIGHT_TORSO"),!1)],[8,i.$new(u($,"CENTER_TORSO"),!1)],[9,i.$new(u($,"LEFT_TORSO"),!1)],[10,i.$new(u($,"LEFT_ARM"),!1)],[11,i.$new(u($,"LEFT_LEG"),!1)],[12,i.$new(u($,"HEAD"),!1)]]),LU:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u5de6\u4e0a\u534a\u8eab\uff09","1D6",[[p(1,2,!1),i.$new(u($,"LEFT_TORSO"),!1)],[3,i.$new(u($,"CENTER_TORSO"),!1)],[p(4,5,!1),i.$new(u($,"LEFT_ARM"),!1)],[6,i.$new(u($,"HEAD"),!1)]]),CU:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u6b63\u9762\u4e0a\u534a\u8eab\uff09","1D6",[[1,i.$new(u($,"LEFT_ARM"),!1)],[2,i.$new(u($,"LEFT_TORSO"),!1)],[3,i.$new(u($,"CENTER_TORSO"),!1)],[4,i.$new(u($,"RIGHT_TORSO"),!1)],[5,i.$new(u($,"RIGHT_ARM"),!1)],[6,i.$new(u($,"HEAD"),!1)]]),RU:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u53f3\u4e0a\u534a\u8eab\uff09","1D6",[[p(1,2,!1),i.$new(u($,"RIGHT_TORSO"),!1)],[3,i.$new(u($,"CENTER_TORSO"),!1)],[p(4,5,!1),i.$new(u($,"RIGHT_ARM"),!1)],[6,i.$new(u($,"HEAD"),!1)]]),LL:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u5de6\u4e0b\u534a\u8eab\uff09","1D6",[[p(1,6,!1),i.$new(u($,"LEFT_LEG"),!1)]]),CL:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u53f3\u4e0b\u534a\u8eab\uff09","1D6",[[p(1,3,!1),i.$new(u($,"RIGHT_LEG"),!1)],[p(4,6,!1),i.$new(u($,"LEFT_LEG"),!1)]]),RL:o(u($,"DiceTable"),"RangeTable").$new("\u547d\u4e2d\u90e8\u4f4d\u8868\uff08\u53f3\u4e0b\u534a\u8eab\uff09","1D6",[[p(1,6,!1),i.$new(u($,"RIGHT_LEG"),!1)]])}).$freeze())}(A[0],0,A),t.const_set(A[0],"XRM_DAMAGE_TABLES",d(["SRM2","SRM4","SRM6","LRM5","LRM10","LRM15","LRM20"],{SRM2:o(u(A,"DiceTable"),"RangeTable").$new("SRM2\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[p(2,7,!1),1],[p(8,12,!1),2]]),SRM4:o(u(A,"DiceTable"),"RangeTable").$new("SRM4\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[2,1],[p(3,6,!1),2],[p(7,10,!1),3],[p(11,12,!1),4]]),SRM6:o(u(A,"DiceTable"),"RangeTable").$new("SRM6\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[p(2,3,!1),2],[p(4,5,!1),3],[p(6,8,!1),4],[p(9,10,!1),5],[p(11,12,!1),6]]),LRM5:o(u(A,"DiceTable"),"RangeTable").$new("LRM5\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[2,1],[p(3,4,!1),2],[p(5,8,!1),3],[p(9,10,!1),4],[p(11,12,!1),5]]),LRM10:o(u(A,"DiceTable"),"RangeTable").$new("LRM10\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[p(2,3,!1),3],[4,4],[p(5,8,!1),6],[p(9,10,!1),8],[p(11,12,!1),10]]),LRM15:o(u(A,"DiceTable"),"RangeTable").$new("LRM15\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[p(2,3,!1),5],[4,6],[p(5,8,!1),9],[p(9,10,!1),12],[p(11,12,!1),15]]),LRM20:o(u(A,"DiceTable"),"RangeTable").$new("LRM20\u30c0\u30e1\u30fc\u30b8\u8868","2D6",[[p(2,3,!1),6],[4,9],[p(5,8,!1),12],[p(9,10,!1),16],[p(11,12,!1),20]])}).$freeze())}(y[0],u(y,"Base"),y)}(y[0],y)}(s[0],s)}(Opal)}}]);