(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[2040],{1245:(X,Z,W)=>{W(9993),Opal.modules["bcdice/arithmetic_evaluator"]=function(r){var v,R,T,e,E,p,y,w,S=r.module,G=r.ensure_kwargs,o=r.truthy,M=r.thrower,g=r.def,n=[],A=r.nil,b=r.$$$;return v=n,R=w=[S(n[0],"BCDice")].concat(v),y=[p=S(w[0],"ArithmeticEvaluator")].concat(R),e=[T=r.get_singleton_class(p)].concat(y),E=r.$r(e),g(T,"$eval",function(C,P){try{M("eval_return");var U,I=A;return null==(U=(P=G(P)).$$smap.round_type)&&(U=b(E("RoundType"),"FLOOR")),o(C)&&o(I=E("Arithmetic").$eval(C,U))?I:0}catch(x){if(x===r.t_eval_return)return x.$v;throw x}},-2)},Opal.modules["bcdice/game_system/SRS"]=function(r){var C,I,Q,s,t,_,a,h,d,l,q,k,K,V,S=r.module,G=r.klass,o=r.const_set,M=r.slice,g=r.send,n=r.def,A=r.return_val,b=r.send2,H=r.find_super,v=r.truthy,L=r.eqeqeq,w=r.hash2,F=r.thrower,R=r.rb_plus,p=r.rb_ge,y=r.rb_le,D=[],e=r.nil,E=r.$$$;return r.top.$require("bcdice/arithmetic_evaluator"),C=D,I=V=[S(D[0],"BCDice")].concat(C),k=[S(V[0],"GameSystem")].concat(I),K=r.$r(k),Q=k,d=[h=G(k[0],K("Base"),"SRS")].concat(Q),l=r.$r(d),(q=h.$$prototype).round_type=q.randomizer=q.sort_add_dice=e,o(d[0],"ID","SRS"),o(d[0],"NAME","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0"),o(d[0],"SORT_KEY","\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080"),o(d[0],"HELP_MESSAGE_1","\u30fb\u5224\u5b9a\n\u3000\u30fb\u901a\u5e38\u5224\u5b9a\uff1a2D6+m>=t[c,f]\n\u3000\u3000\u4fee\u6b63\u5024m\u3001\u76ee\u6a19\u5024t\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024c\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024f\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u4fee\u6b63\u5024\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff08[]\u3054\u3068\u7701\u7565\u53ef\uff09\u3002\n\u3000\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u65e2\u5b9a\u5024\u306f\u3001\u305d\u308c\u305e\u308c12\u30012\u3067\u3059\u3002\n\u3000\u3000\u81ea\u52d5\u6210\u529f\u3001\u81ea\u52d5\u5931\u6557\u3001\u6210\u529f\u3001\u5931\u6557\u3092\u81ea\u52d5\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3000\u3000\u4f8b) 2d6>=10\u3000\u3000\u3000\u3000\u3000\u4fee\u6b63\u50240\u3001\u76ee\u6a19\u502410\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10\u3000\u3000\u3000\u3000\u4fee\u6b63\u5024+2\u3001\u76ee\u6a19\u502410\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[11]\u3000\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2>=10[12,4]\u3000\u2191\u3092\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n"),o(d[0],"HELP_MESSAGE_2","\u3000\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u304a\u3088\u3073\u30d5\u30a1\u30f3\u30d6\u30eb\u306e\u307f\u306e\u5224\u5b9a\uff1a2D6+m[c,f]\n\u3000\u3000\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u305b\u305a\u3001\u4fee\u6b63\u5024m\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024c\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024f\u3067\u5224\u5b9a\u30ed\u30fc\u30eb\u3092\u884c\u3044\u307e\u3059\u3002\n\u3000\u3000\u4fee\u6b63\u5024\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306f\u7701\u7565\u53ef\u80fd\u3067\u3059\uff08[]\u306f\u7701\u7565\u4e0d\u53ef\uff09\u3002\n\u3000\u3000\u81ea\u52d5\u6210\u529f\u3001\u81ea\u52d5\u5931\u6557\u3092\u81ea\u52d5\u8868\u793a\u3057\u307e\u3059\u3002\n\n\u3000\u3000\u4f8b) 2d6[]\u3000\u3000\u3000\u3000\u4fee\u6b63\u50240\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2[11]\u3000\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502411\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50242\u3067\u5224\u5b9a\n\u3000\u3000\u4f8b) 2d6+2[12,4]\u3000\u4fee\u6b63\u5024+2\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502412\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u50244\u3067\u5224\u5b9a\n"),o(d[0],"HELP_MESSAGE_3","\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\uff08\u5165\u308c\u66ff\u3048\u306a\u3057)\n"),o(d[0],"DEFAULT_HELP_MESSAGE",l("HELP_MESSAGE_1")+"\n"+l("HELP_MESSAGE_2")+"\n"+l("HELP_MESSAGE_3")),o(d[0],"HELP_MESSAGE",l("DEFAULT_HELP_MESSAGE")),s=d,_=[t=S(d[0],"ClassMethods")].concat(s),a=r.$r(_),t.$attr_reader("help_message"),t.$attr_reader("aliases_re_for_srs_roll_with_target_value"),t.$attr_reader("aliases_re_for_srs_roll_without_target_value"),n(t,"$set_aliases_for_srs_roll",function(i){var c,u=this,z=e,B=e;return c=M(arguments),z=g(c,"map",[],"upcase".$to_proc()),B=g(z,"map",[],function(N){return null==N&&(N=e),a("Regexp").$escape(N)}).$join("|"),u.aliases_re_for_srs_roll_with_target_value=a("Regexp").$new("^(?:"+B+")((?:[-+][-+\\d]+)?>=\\d+(?:\\[\\d*(?:,\\d+)?\\])?)$"),u.aliases_re_for_srs_roll_without_target_value=a("Regexp").$new("^(?:"+B+")([-+][-+\\d]+)?(\\[\\d*(?:,\\d+)?\\])?$"),u.$prepare_help_msg_for_aliases_for_srs_roll(z),u.help_message=u.$concatenate_help_messages(),u},-1),n(t,"$clear_aliases_for_srs_roll",function(){var i=this;return i.aliases_re_for_srs_roll_with_target_value=e,i.aliases_re_for_srs_roll_without_target_value=e,i.help_message=E(a("SRS"),"DEFAULT_HELP_MESSAGE"),i}),t.$private(),n(t,"$prepare_help_msg_for_aliases_for_srs_roll",function(i){var c=this;return c.help_msg_for_aliases_for_srs_roll_with_target_value=g(i,"map",[],function(u){return null==u&&(u=e),"\u3000\u3000\u4f8b) "+u+"+2>=10\u3000\u3000\u3000\u3000 2d6+2>=10\u3068\u540c\u3058\uff08"+u+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n"}).$join(),c.help_msg_for_aliases_for_srs_roll_without_target_value=g(i,"map",[],function(u){return null==u&&(u=e),"\u3000\u3000\u4f8b) "+u+"\u3000\u3000\u3000\u3000\u3000 2d6[]\u3068\u540c\u3058\uff08"+u+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n\u3000\u3000\u4f8b) "+u+"+2[12,4]\u3000 2d6+2[12,4]\u3068\u540c\u3058\uff08"+u+"\u304c2D6\u306e\u30b7\u30e7\u30fc\u30c8\u30ab\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\uff09\n"}).$join(),c}),n(t,"$concatenate_help_messages",function(){var i=this;return null==i.help_msg_for_aliases_for_srs_roll_with_target_value&&(i.help_msg_for_aliases_for_srs_roll_with_target_value=e),null==i.help_msg_for_aliases_for_srs_roll_without_target_value&&(i.help_msg_for_aliases_for_srs_roll_without_target_value=e),E(a("SRS"),"HELP_MESSAGE_1")+(i.help_msg_for_aliases_for_srs_roll_with_target_value+"\n")+E(a("SRS"),"HELP_MESSAGE_2")+i.help_msg_for_aliases_for_srs_roll_without_target_value+"\n"+E(a("SRS"),"HELP_MESSAGE_3")}),function($,s){var t=[$].concat(s),_=r.$r(t);n($,"$inherited",function(f){return f.$extend(_("ClassMethods")).$clear_aliases_for_srs_roll()}),n($,"$help_message",function(){return _("DEFAULT_HELP_MESSAGE")}),n($,"$aliases_re_for_srs_roll_with_target_value",A(e)),n($,"$aliases_re_for_srs_roll_without_target_value",A(e))}(r.get_singleton_class(h),d),h.$register_prefix("2D6"),n(h,"$initialize",function $(s){var _=this;return $.$$p=null,b(_,H(_,"initialize",$,!1,!0),"initialize",[s],null),_.sort_add_dice=!0,_.d66_sort_type=E(l("D66SortType"),"NO_SORT")}),n(h,"$help_message",function(){return this.$class().$help_message()}),o(d[0],"DEFAULT_CRITICAL_VALUE",12),o(d[0],"DEFAULT_FUMBLE_VALUE",2),o(d[0],"SRS_ROLL_WITH_TARGET_VALUE_RE",/^2D6([-+][-+\d]+)?>=(\d+)(?:\[(\d+)?(?:,(\d+))?\])?$/.$freeze()),o(d[0],"SRS_ROLL_WITHOUT_TARGET_VALUE_RE",/^2D6([-+][-+\d]+)?\[(\d+)?(?:,(\d+))?\]$/.$freeze()),o(d[0],"SRS_ROLL_DEFAULT_THRESHOLDS","["+l("DEFAULT_CRITICAL_VALUE")+","+l("DEFAULT_FUMBLE_VALUE")+"]"),o(d[0],"SRSRollNode",g(l("Struct"),"new",["modifier","critical_value","fumble_value","target_value"],function $(){return n(null==$.$$s?this:$.$$s,"$to_s",function(){var a,_=this;return a="2D6"+l("Format").$modifier(_.$modifier()),(v(_.$target_value())?a+">="+_.$target_value():a)+"["+_.$critical_value()+","+_.$fumble_value()+"]"})},{$$s:h})),n(h,"$eval_game_system_specific_command",function(s){var _,a,t=this;return _=t.$replace_alias_for_srs_roll_with_2d6(s),v(a=t.$parse(_))?t.$execute_srs_roll(a):e}),h.$private(),n(h,"$replace_alias_for_srs_roll_with_2d6",function(s){var _,i=e;return L(this.$class().$aliases_re_for_srs_roll_with_target_value(),_=s)?"2D6"+l("Regexp").$last_match(1):L(this.$class().$aliases_re_for_srs_roll_without_target_value(),_)?"2D6"+l("Regexp").$last_match(1)+(v(i=l("Regexp").$last_match(2))?i:l("SRS_ROLL_DEFAULT_THRESHOLDS")):s}),n(h,"$parse",function(s){var _;return L(l("SRS_ROLL_WITH_TARGET_VALUE_RE"),_=s)?this.$parse_srs_roll_with_target_value(l("Regexp").$last_match()):L(l("SRS_ROLL_WITHOUT_TARGET_VALUE_RE"),_)?this.$parse_srs_roll_without_target_value(l("Regexp").$last_match()):e}),n(h,"$eval_modifier",function(s){try{return F("eval_return"),v(s)?l("ArithmeticEvaluator").$eval(s,w(["round_type"],{round_type:this.round_type})):0}catch(a){if(a===r.t_eval_return)return a.$v;throw a}}),n(h,"$parse_srs_roll_with_target_value",function(s){var t,_,f,i,c,u,m=e;return f=this.$eval_modifier(s["$[]"](1)),i=s["$[]"](2).$to_i(),c=v(m=(t=s["$[]"](3))===e||null==t?e:t.$to_i())?m:l("DEFAULT_CRITICAL_VALUE"),u=v(m=(_=s["$[]"](4))===e||null==_?e:_.$to_i())?m:l("DEFAULT_FUMBLE_VALUE"),l("SRSRollNode").$new(f,c,u,i)}),n(h,"$parse_srs_roll_without_target_value",function(s){var t,_,f,i,m,c=e;return f=this.$eval_modifier(s["$[]"](1)),i=v(c=(t=s["$[]"](2))===e||null==t?e:t.$to_i())?c:l("DEFAULT_CRITICAL_VALUE"),m=v(c=(_=s["$[]"](3))===e||null==_?e:_.$to_i())?c:l("DEFAULT_FUMBLE_VALUE"),l("SRSRollNode").$new(f,i,m,e)}),n(h,"$execute_srs_roll",function(s){var a,f,i,t=this,_=e,c=e,m=e;return _=t.randomizer.$roll_barabara(2,6),v(t.sort_add_dice)&&_["$sort!"](),a=_.$sum(),f=_.$join(","),i=R(a,s.$modifier()),c=t.$compare_result(s,a,i),m=["("+s+")",a+"["+f+"]"+l("Format").$modifier(s.$modifier()),i,c.$text()],c["$text="](m.$compact().$join(" \uff1e ")),c}),n(h,"$compare_result",function(s,t,_){return v(p(t,s.$critical_value()))?l("Result").$critical("\u81ea\u52d5\u6210\u529f"):v(y(t,s.$fumble_value()))?l("Result").$fumble("\u81ea\u52d5\u5931\u6557"):v(s.$target_value()["$nil?"]())?l("Result").$new():v(p(_,s.$target_value()))?l("Result").$success("\u6210\u529f"):l("Result").$failure("\u5931\u6557")})},Opal.queue(function(r){var b,w,D,e,E,R,p,v,S=r.module,G=r.klass,o=r.const_set,g=[];return r.top.$require("bcdice/game_system/SRS"),b=g,w=v=[S(g[0],"BCDice")].concat(b),R=[S(v[0],"GameSystem")].concat(w),p=r.$r(R),D=R,E=[e=G(R[0],p("SRS"),"MetallicGuardian")].concat(D),e.$register_prefix("2D6","MG"),e.$set_aliases_for_srs_roll("MG"),o(E[0],"NAME","\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG"),o(E[0],"SORT_KEY","\u3081\u305f\u308a\u3064\u304f\u304b\u3042\u3066\u3044\u3042\u3093RPG"),o(E[0],"ID","MetallicGuardian"),o(E[0],"HELP_MESSAGE",e.$help_message())})}}]);