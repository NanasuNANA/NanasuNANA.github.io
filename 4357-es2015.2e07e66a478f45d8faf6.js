(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4357],{44357:function(t,e,n){n(93683),function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function u(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}function i(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function l(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var r,o,a,s,c,f,_,g,d,h,m,y,b,p,C,R,x,T,B,v,F,H,A,L,k,D,S,z,E=[],P=t.nil,w=t.$$,I=t.module,M=t.klass,O=t.send2,N=t.range,j=t.truthy,G=t.send,K=t.hash2;r=E,o=z=[I(E[0],"BCDice")].concat(r),a=S=[I(z[0],"GameSystem")].concat(o),k=M(S[0],w(S,"Base"),"Cthulhu7th_ChineseTraditional"),D=[k].concat(a),k.$$prototype.bonus_dice_range=k.$$prototype.randomizer=P,t.const_set(D[0],"ID","Cthulhu7th:ChineseTraditional"),t.const_set(D[0],"NAME","\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248"),t.const_set(D[0],"SORT_KEY","\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248"),t.const_set(D[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u3000CC(x)<=\uff08\u76ee\u6a19\u5024\uff09\n\u3000x\uff1a\u734e\u52f5\u9ab0/\u61f2\u7f70\u9ab0\uff1aBonus/Penalty Dice (2\uff5e\uff0d2)\u3002\u6c92\u6709\u7684\u8a71\u53ef\u4ee5\u7701\u7565\u3002\n\u3000\u81f4\u547d\u7684\u5931\u6557\uff1aFumble\uff0f\u5931\u6557\uff1aFailure\uff0f\u901a\u5e38\u6210\u529f\uff1aRegular success\uff0f\n\u3000\u56f0\u96e3\u6210\u529f\uff1aHard success\uff0f\u6975\u9650\u6210\u529f\uff1aExtreme success\uff0f\n\u3000\u6c7a\u5b9a\u6027\u7684\u6210\u529f\uff1aCritical success\u3000\u81ea\u52d5\u5224\u5b9a\u3002\n\u4f8b\uff09CC<=30\u3000CC(2)<=50\u3000CC(-1)<=75\n\n\u30fb\u7d44\u5408\u5224\u5b9a\u3000(CBR(x,y))\n\u3000\u9032\u884c\u76ee\u6a19\u5024 x \u548c y \u7684\u5224\u5b9a\u3002\n\u3000\u4f8b\uff09CBR(50,20)\n\n\u30fb\u9023\u5c04\uff08Full Auto\uff09\u5224\u5b9a\u3000FAR(w,x,y,z)\n\u3000w\uff1a\u5f48\u6578(1\uff5e100\uff09\u3001x\uff1a\u6280\u80fd\u5024\uff081\uff5e100\uff09\u3001y\uff1a\u6545\u969c\u7387\n\u3000z\uff1a\u734e\u52f5\u3001\u61f2\u7f70\u9ab0(-2\uff5e2)\u3002\u53ef\u7701\u7565\u3002\n\u3000\u53ea\u8a08\u7b97\u547d\u4e2d\u6578\u3001\u8cab\u7a7f\u6578\u53ca\u5269\u9918\u5f48\u85e5\uff0c\u4e0d\u8a08\u7b97\u50b7\u5bb3\u3002\n\u4f8b\uff09FAR(25,70,98)\u3000FAR(50,80,98,-1)\n\n\u30fb\u760b\u72c2\u8868\n\u30fb\u5be6\u6642\u578b\u3000Short\uff0f\u7e3d\u7d50\u578b\u3000Longer\n"),k.$register_prefix("CC","CBR","FAR"),t.def(k,"$initialize",s=function(e){var n=this;return s.$$p&&(s.$$p=null),O(n,t.find_super_dispatcher(n,"initialize",s,!1,!0),"initialize",[e],null),n.bonus_dice_range=N(-2,2,!1)},s.$$arity=1),t.def(k,"$eval_game_system_specific_command",c=function(t){var e,n=this;return/CC/i["$==="](e=t)?n.$getCheckResult(t):/CBR/i["$==="](e)?n.$getCombineRoll(t):/FAR/i["$==="](e)?n.$getFullAutoResult(t):P},c.$$arity=1),t.def(k,"$getCheckResult",f=function(t){var $,u,i=this,l=P,r=P,o=P,a=P,s=P;return j(/^CC([-\d]+)?<=(\d+)/i["$=~"](t)),$=w(D,"Regexp").$last_match(1).$to_i(),u=w(D,"Regexp").$last_match(2).$to_i(),j(e(u,0))?"\u932f\u8aa4\u3002\u76ee\u6a19\u503c\u9700\u70ba1\u4ee5\u4e0a\u3002":j(i.bonus_dice_range["$include?"]($))?(l=n(l="","(1D100<="+u+")"),l=n(l," \u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024["+$+"]"),r=i.$rollPercentD10(),o=i.$getTotalLists($,r),a=i.$getTotal(o,$),s=i.$getCheckResultText(a,u),l=n(l," \uff1e "+o.$join(", ")+" \uff1e "+a+" \uff1e "+s)):"\u932f\u8aa4\u3002\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024\u70ba"+i.bonus_dice_range.$min()+"\uff5e"+i.bonus_dice_range.$max()+"\u3002"},f.$$arity=1),t.def(k,"$rollPercentD10",_=function(){var t=P;return(t=this.randomizer.$roll_once(10))["$=="](10)&&(t=0),t},_.$$arity=0),t.def(k,"$getTotalLists",g=function(t,e){var $,u,i=P;return i=[],u=n(1,t.$abs()),G(u,"times",[],(($=function(){var t,u=P;return(u=n((t=(null==$.$$s?this:$.$$s).$rollPercentD10(),"number"==typeof t?10*t:t["$*"](10)),e))["$=="](0)&&(u=100),i.$push(u)}).$$s=this,$.$$arity=0,$)),i},g.$$arity=2),t.def(k,"$getTotal",d=function(t,e){return j($(e,0))?t.$min():t.$max()},d.$$arity=2),t.def(k,"$getCheckResultText",h=function(t,n,l){var r;if(null==l&&(l=!1),j(e(t,n)))return t["$=="](1)?"\u6c7a\u5b9a\u6027\u7684\u6210\u529f":j(e(t,u(n,5).$to_i()))?"\u6975\u9650\u7684\u6210\u529f":j(e(t,u(n,2).$to_i()))?"\u56f0\u96e3\u7684\u6210\u529f":"\u901a\u5e38\u6210\u529f";if(r="\u81f4\u547d\u7684\u5931\u6557",t["$=="](100))return r;if(j($(t,96))){if(j(i(n,50)))return r;if(j(l))return r}return"\u5931\u6557"},h.$$arity=-3),t.def(k,"$getCombineRoll",m=function(t){var e=this,u=P,i=P,l=P,r=P,o=P,a=P,s=P;return j(/CBR\((\d+),(\d+)\)/i["$=~"](t))?(u=w(D,"Regexp").$last_match(1).$to_i(),i=w(D,"Regexp").$last_match(2).$to_i(),l=e.randomizer.$roll_once(100),r=e.$getCheckResultText(l,u),o=e.$getCheckResultText(l,i),s=0,j((a=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f","\u56f0\u96e3\u7684\u6210\u529f","\u901a\u5e38\u6210\u529f"])["$include?"](r))&&(s=n(s,1)),j(a["$include?"](o))&&(s=n(s,1)),e.$debug("succesCount",s),"(1d100<="+u+","+i+") \uff1e "+l+"["+r+","+o+"] \uff1e "+(j($(s,2))?"\u6210\u529f":s["$=="](1)?"\u90e8\u5206\u7684\u6210\u529f":"\u5931\u6557")):P},m.$$arity=1),t.def(k,"$getFullAutoResult",y=function(t){var $=this,u=P,l=P,r=P,o=P,a=P,s=P,c=P;return j(/^FAR\((-?\d+)(,(-?\d+))(,(-?\d+))(,(-?\d+))?\)/i["$=~"](t))?(u=w(D,"Regexp").$last_match(1).$to_i(),l=w(D,"Regexp").$last_match(3).$to_i(),r=w(D,"Regexp").$last_match(5).$to_i(),o=(j(a=w(D,"Regexp").$last_match(7))?a:0).$to_i(),s="",j(function(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}(u,c=100))&&(s=n(s,"\n\u5f48\u85e5\u592a\u591a\u3002\u8acb\u6539\u88dd\u586b"+c+"\u767c\u3002\n"),u=c),j(e(u,0))?"\u6b63\u78ba\u88dd\u586b\u6578\u3002":j(e(l,0))?"\u6b63\u78ba\u76ee\u6a19\u503c\u3002":(j(i(r,0))&&(s=n(s,"\n\u6b63\u78ba\u6545\u969c\u503c\u3002\u6392\u9664\u734e\u52f5\u8a18\u865f\u3002\n"),r=r.$abs()),j($.bonus_dice_range["$include?"](o))?(s=n(s,"\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024["+o+"]"),s=n(s,$.$rollFullAuto(u,l,r,o))):"\n\u932f\u8aa4\u3002\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024\u70ba"+$.bonus_dice_range.$min()+"\uff5e"+$.bonus_dice_range.$max()+"\u3067\u3059\u3002")):P},y.$$arity=1),t.def(k,"$rollFullAuto",b=function(u,i,r,o){try{var a,s=P,c=P,f=P;return s="",c=0,f=K(["hit_bullet","impale_bullet","bullet"],{hit_bullet:0,impale_bullet:0,bullet:u}),G(N(0,3,!1),"each",[],((a=function(u){var _,g,d=null==a.$$s?this:a.$$s,h=P,m=P,y=P,b=P,p=P,C=P,R=P;for(null==d.bonus_dice_range&&(d.bonus_dice_range=P),null==u&&(u=P),s=n(s,d.$getNextDifficltyMessage(u));j($(o,d.bonus_dice_range.$min()));)c=n(c,1),g=d.$getHitResultInfos(o,i,u),h=null==(_=t.to_ary(g))[0]?P:_[0],m=null==_[1]?P:_[1],s=n(s,"\n"+c+"\u6b21: \uff1e "+(null==_[2]?P:_[2]).$join(", ")+" \uff1e "+h),j($(m,r))&&(s=n(s,"\u5361\u5f48"),t.ret(d.$getHitResultText(s,f))),y=d.$getHitType(u,h),g=d.$getBulletResults(f["$[]"]("bullet"),y,i),b=null==(_=t.to_ary(g))[0]?P:_[0],p=null==_[1]?P:_[1],C=null==_[2]?P:_[2],R=["hit_bullet",n(f["$[]"]("hit_bullet"),b)],G(f,"[]=",t.to_a(R)),l(R.length,1),R=["impale_bullet",n(f["$[]"]("impale_bullet"),p)],G(f,"[]=",t.to_a(R)),l(R.length,1),R=["bullet",l(f["$[]"]("bullet"),C)],G(f,"[]=",t.to_a(R)),l(R.length,1),j(e(f["$[]"]("bullet"),0))&&t.ret(d.$getHitResultText(s,f)),o=l(o,1);return o=n(o,1)}).$$s=this,a.$$arity=1,a)),this.$getHitResultText(s,f)}catch(_){if(_===t.returner)return _.$v;throw _}},b.$$arity=4),t.def(k,"$getHitResultInfos",p=function(t,e,n){var $,u,i,l,r=this;return $=r.$rollPercentD10(),u=r.$getTotalLists(t,$),i=r.$getTotal(u,t),l=r.$getFumbleable(n),[r.$getCheckResultText(i,e,l),i,u]},p.$$arity=3),t.def(k,"$getHitResultText",C=function(t,e){return t+"\n\uff1e "+e["$[]"]("hit_bullet")+"\u767c\u5c04\u64ca\u547d\u4e2d\u3001"+e["$[]"]("impale_bullet")+"\u5c04\u64ca\u8cab\u7a7f\u3001\u5269\u9918\u5f48\u85e5"+e["$[]"]("bullet")+"\u767c"},C.$$arity=2),t.def(k,"$getHitType",R=function(e,n){var $,u,i=P;return u=this.$getSuccessListImpaleBulletList(e),i=null==($=t.to_ary(u))[1]?P:$[1],j((null==$[0]?P:$[0])["$include?"](n))?"hit":j(i["$include?"](n))?"impale":""},R.$$arity=2),t.def(k,"$getBulletResults",x=function(t,e,n){var $,i,l=this,r=P,o=P,a=P,s=P,c=P,f=P;return $=l.$getSetOfBullet(n),i=l.$getHitBulletCountBase(n,$),r=u($,2..$to_f()),o=0,a=0,s=0,j(l.$isLastBulletTurn(t,$)["$!"]())?("hit"["$==="](c=e)?a=i:"impale"["$==="](c)&&(a=r.$floor(),s=r.$ceil()),o=$):("hit"["$==="](c=e)?a=l.$getLastHitBulletCount(t):"impale"["$==="](c)&&(a=(f=u(t,2..$to_f())).$floor(),s=f.$ceil()),o=t),[a,s,o]},x.$$arity=3),t.def(k,"$getSuccessListImpaleBulletList",T=function(t){var e,n=P,$=P;return n=[],$=[],(0)["$==="](e=t)?(n=["\u56f0\u96e3\u7684\u6210\u529f","\u901a\u5e38\u6210\u529f"],$=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f"]):1["$==="](e)?(n=["\u56f0\u96e3\u7684\u6210\u529f"],$=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f"]):2["$==="](e)?(n=[],$=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f","\u6975\u9650\u7684\u6210\u529f"]):3["$==="](e)&&(n=["\u6c7a\u5b9a\u6027\u7684\u6210\u529f"],$=[]),[n,$]},T.$$arity=1),t.def(k,"$getNextDifficltyMessage",B=function(t){var e;return 1["$==="](e=t)?"\n    \u8b8a\u66f4\u96e3\u5ea6\u70ba\u56f0\u96e3\u7684\u6210\u529f":2["$==="](e)?"\n    \u8b8a\u66f4\u96e3\u5ea6\u70ba\u6975\u9650\u7684\u6210\u529f":3["$==="](e)?"\n    \u8b8a\u66f4\u96e3\u5ea6\u70ba\u6c7a\u5b9a\u6027\u7684\u6210\u529f":""},B.$$arity=1),t.def(k,"$getSetOfBullet",v=function(t){var e,n=P;return n=u(t,10).$to_i(),j(j(e=$(t,1))?i(t,10):e)&&(n=1),n},v.$$arity=1),t.def(k,"$getHitBulletCountBase",F=function(t,e){var n,l=P;return l=u(e,2).$to_i(),j(j(n=$(t,1))?i(t,10):n)&&(l=1),l},F.$$arity=2),t.def(k,"$isLastBulletTurn",H=function(t,e){return i(l(t,e),0)},H.$$arity=2),t.def(k,"$getLastHitBulletCount",A=function(t){return t["$=="](1)?1:u(t,2..$to_f()).$floor()},A.$$arity=1),t.def(k,"$getFumbleable",L=function(t){return $(t,1)},L.$$arity=1)}(Opal)}}]);