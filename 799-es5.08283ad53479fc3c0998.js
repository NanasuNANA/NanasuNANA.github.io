(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[799],{799:function(e,t,a){a(93683),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var t,a,n,r,o,l,i,s,$=[],u=e.nil,c=e.$$$,_=e.$$,m=e.module,f=e.hash2,d=e.truthy;return t=$,a=s=[m($[0],"BCDice")].concat(t),i=[l=m(s[0],"ArithmeticEvaluator")].concat(a),n=e.get_singleton_class(l),o=[n].concat(i),void e.def(n,"$eval",r=function(t,a){var n,r=u;if(null==a)a=f([],{});else if(!a.$$is_hash)throw e.ArgumentError.$new("expected kwargs");return null==(n=a.$$smap.round_type)&&(n=c(_(o,"RoundType"),"FLOOR")),d(t)&&d(r=_(o,"Arithmetic").$eval(t,n))?r:0},r.$$arity=-2)},Opal.modules["bcdice/dice_table/range_table"]=function(e){var t,a,n,r,o,l,i,s,$,u,c,_,m,f,d,p,v=[],b=e.nil,y=e.$$,E=e.module,g=e.klass,D=e.send,T=e.truthy;return t=v,a=p=[E(v[0],"BCDice")].concat(t),n=d=[E(p[0],"DiceTable")].concat(a),m=g(d[0],null,"RangeTable"),f=[m].concat(n),m.$$prototype.name=m.$$prototype.items=m.$$prototype.num_of_dice=m.$$prototype.num_of_sides=m.$$prototype.formatter=b,e.const_set(f[0],"RollResult",D(y(f,"Struct"),"new",["sum","values","content","formatted"],((r=function(){return(null==r.$$s?this:r.$$s).$alias_method("to_s","formatted")}).$$s=m,r.$$arity=0,r))),e.const_set(f[0],"Item",y(f,"Struct").$new("range","content")),e.const_set(f[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),e.const_set(f[0],"DEFAULT_FORMATTER",D(m,"lambda",[],($$2=function(e){function t(t,a){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){return null==$$2.$$s||$$2,null==e&&(e=b),null==t&&(t=b),e.$name()+"("+t.$sum()+") \uff1e "+t.$content()}),$$2.$$s=m,$$2.$$arity=2,$$2))),m.$attr_reader("name"),m.$attr_reader("num_of_dice"),m.$attr_reader("num_of_sides"),e.def(m,"$initialize",o=function(e,t,a){var n,r=o.$$p,l=r||b,i=this,s=b;return r&&(o.$$p=null),r&&(o.$$p=null),i.name=e.$freeze(),i.formatter=T(n=l)?n:y(f,"DEFAULT_FORMATTER"),s=y(f,"DICE_ROLL_METHOD_RE").$match(t),T(s)||i.$raise(y(f,"ArgumentError"),i.name+": invalid dice roll method: "+t),i.num_of_dice=s["$[]"](1).$to_i(),i.num_of_sides=s["$[]"](2).$to_i(),i.$store(a)},o.$$arity=3),e.def(m,"$fetch",l=function(e){var t,a,n=this;return a=D(n.items,"find",[],((t=function(t){return null==t&&(t=b),t.$range()["$include?"](e)}).$$s=n,t.$$arity=1,t)),T(a)||n.$raise(y(f,"RangeError"),n.name+": value is out of range: "+e),a},l.$$arity=1),e.def(m,"$roll",i=function(t){var a,n,r,o,l=this,i=b;return a=(i=t.$roll_barabara(l.num_of_dice,l.num_of_sides)).$sum(),n=y(f,"RollResult").$new(a,i,l.$fetch(a).$content()),r=[l.formatter["$[]"](l,n)],D(n,"formatted=",e.to_a(r)),"number"==typeof(o=r.length)||o["$-"](1),n},i.$$arity=1),m.$private(),e.def(m,"$store",s=function(e){var t,a,n,r,o,l=this;return r=D(e,"map",[],((t=function(e,a){return null==e&&(e=b),null==a&&(a=b),[(null==t.$$s?this:t.$$s).$coerce_to_int_range(e),a]}).$$s=l,t.$$arity=2,t)),o=D(r,"sort_by",[],((a=function(e,t){return null==e&&(e=b),null==t&&(t=b),e.$min()}).$$s=l,a.$$arity=2,a)),l.$assert_min_sum_is_covered(o),l.$assert_max_sum_is_covered(o),l.$assert_no_gap_or_overlap_in_ranges(o),l.items=D(o,"map",[],(n=function(e,t){return null==e&&(e=b),null==t&&(t=b),y(f,"Item").$new(e,t.$freeze()).$freeze()},n.$$s=l,n.$$arity=2,n)).$freeze(),l},s.$$arity=1),e.def(m,"$coerce_to_int_range",$=function(e){var t,a=b;return t=e,y(f,"Integer")["$==="](t)?y(f,"Range").$new(e,e):y(f,"Range")["$==="](t)&&T(T(a=e.$begin()["$is_a?"](y(f,"Integer")))?e.$end()["$is_a?"](y(f,"Integer")):a)?e:this.$raise(y(f,"TypeError"),this.name+": "+e+" ("+e.$class()+") must be an Integer or a Range with Integers ")},$.$$arity=1),e.def(m,"$assert_min_sum_is_covered",u=function(e){var t,a=this,n=b;return t=a.num_of_dice,n=e.$first()["$[]"](0),T(n["$include?"](t))||a.$raise(y(f,"RangeError"),a.name+": min value ("+t+") is not covered: "+n),a},u.$$arity=1),e.def(m,"$assert_max_sum_is_covered",c=function(e){var t,a=this,n=b;return t=function(e,t){return"number"==typeof e&&"number"==typeof t?e*t:e["$*"](t)}(a.num_of_dice,a.num_of_sides),n=e.$last()["$[]"](0),T(n["$include?"](t))||a.$raise(y(f,"RangeError"),a.name+": max value ("+t+") is not covered: "+n),a},c.$$arity=1),void e.def(m,"$assert_no_gap_or_overlap_in_ranges",_=function(e){var t;return D(e,"each_cons",[2],((t=function(e,a){var n,r,o,l=null==t.$$s?this:t.$$s,i=b,s=b;return null==l.name&&(l.name=b),null==e&&(e=b),null==a&&(a=b),i=e["$[]"](0),s=a["$[]"](0),r="number"==typeof(o=n=i.$max())?o+1:o["$+"](1),T(s["$include?"](n))&&l.$raise(y(f,"RangeError"),l.name+": Range overlap: "+i+" and "+s),T(s["$include?"](r))?b:l.$raise(y(f,"RangeError"),l.name+": Range gap: "+i+" and "+s)}).$$s=this,t.$$arity=2,t)),this},_.$$arity=1)},function(e){function t(e,t){return"number"==typeof e&&"number"==typeof t?e<t:e["$<"](t)}function a(e,t){return"number"==typeof e&&"number"==typeof t?e>t:e["$>"](t)}function n(e,t){return"number"==typeof e&&"number"==typeof t?e+t:e["$+"](t)}function r(e,t){return"number"==typeof e&&"number"==typeof t?e-t:e["$-"](t)}function o(e,t){return"number"==typeof e&&"number"==typeof t?e>=t:e["$>="](t)}var l,i,s,$,u,c,_,m,f,d,p,v,b,y,E,g,D,T,h,I,C,R,x=e.top,O=[],w=e.nil,z=e.$$$,A=e.$$,L=e.module,X=e.klass,j=e.send2,M=e.truthy,S=e.send,B=e.hash2,k=e.range;x.$require("bcdice/arithmetic_evaluator"),x.$require("bcdice/dice_table/range_table"),l=O,i=R=[L(O[0],"BCDice")].concat(l),s=(C=[L(R[0],"GameSystem")].concat(i))[0],$=A(C,"Base"),u=C,h=X(s,$,"DoubleCross"),I=[h].concat(u),h.$$prototype.randomizer=w,e.const_set(I[0],"ID","DoubleCross"),e.const_set(I[0],"NAME","\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd"),e.const_set(I[0],"SORT_KEY","\u305f\u3075\u308b\u304f\u308d\u30592"),e.const_set(I[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u30b3\u30de\u30f3\u30c9\uff08xDX+y@c or xDXc+y\uff09\n\u3000"(\u500b\u6570)DX(\u4fee\u6b63)@(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)" \u3082\u3057\u304f\u306f "(\u500b\u6570)DX(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)(\u4fee\u6b63)" \u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u4fee\u6b63\u5024\u3082\u4ed8\u3051\u3089\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff0910dx\u3000\u300010dx+5@8\uff08OD tool\u5f0f)\u3000\u30005DX7+7-3\uff08\u75be\u98a8\u6012\u6fe4\u5f0f\uff09\n\n\u30fb\u5404\u7a2e\u8868\n\u3000\u30fb\u611f\u60c5\u8868\uff08ET\uff09\n\u3000\u3000\u30dd\u30b8\u30c6\u30a3\u30d6\u3068\u30cd\u30ac\u30c6\u30a3\u30d6\u306e\u4e21\u65b9\u3092\u632f\u3063\u3066\u3001\u8868\u306b\u306a\u3063\u3066\u3044\u308b\u5074\u306b\u25cb\u3092\u4ed8\u3051\u3066\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u3000\u3082\u3061\u308d\u3093\u4efb\u610f\u3067\u9078\u3076\u90e8\u5206\u306f\u5909\u66f4\u3057\u3066\u69cb\u3044\u307e\u305b\u3093\u3002\n\n\u30fbD66\u30c0\u30a4\u30b9\u3042\u308a\n'),e.def(h,"$initialize",c=function(t){var a=this;return c.$$p&&(c.$$p=null),j(a,e.find_super_dispatcher(a,"initialize",c,!1,!0),"initialize",[t],null),a.sides_implicit_d=10},c.$$arity=1),h.$register_prefix("\\d+DX","ET"),v=I,D=X(I[0],null,"DX"),T=[D].concat(v),D.$$prototype.modifier=D.$$prototype.critical_value=D.$$prototype.expression=D.$$prototype.num=D.$$prototype.modifier_str=D.$$prototype.target_value=w,D.$include(A(T,"Translate")),e.def(D,"$initialize",b=function(e,t,a,n){var r=this;return r.num=e,r.critical_value=t,r.modifier=a,r.target_value=n,r.modifier_str=A(T,"Format").$modifier(r.modifier),r.expression=r.$node_expression(),r.locale="ja_jp"},b.$$arity=4),e.def(D,"$execute",y=function(e){var r=this,o=w,l=w,i=w,s=w,$=w,u=w;if(M(t(r.critical_value,2)))return A(T,"Result").$new("("+r.expression+") \uff1e "+r.$translate("DoubleCross.DX.invalid_critical"));if(M(t(r.num,1)))return A(T,"Result").$failure("("+r.expression+") \uff1e "+r.$translate("DoubleCross.DX.auto_failure"));for(o=[],l=r.num,i=0;M(M(s=a(l,0))?t(i,z(z(A(T,"CommonCommand"),"RerollDice"),"REROLL_LIMIT")):s);)$=e.$roll_barabara(l,10),u=A(T,"ValueGroup").$new($,r.critical_value),o.$push(u),l=u.$num_of_critical_occurrences(),i=n(i,1);return r.$result(o)},y.$$arity=1),D.$private(),e.def(D,"$node_expression",E=function(){var e,t=this;return e=t.num+"DX"+t.critical_value+t.modifier_str,M(t.target_value)?e+">="+t.target_value:e},E.$$arity=0),e.def(D,"$result",g=function(t){var l,i,s=this,$=w,u=w,c=w,_=w,m=w,f=w,d=w;return $=A(T,"Result").$new(),u=[t["$[]"](0).$values()["$all?"](1)],S($,"fumble=",e.to_a(u)),r(u.length,1),l=S(t,"map",[],"max".$to_proc()).$sum(),c=M($["$fumble?"]())?0:n(l,s.modifier),i=M($["$fumble?"]())?c+" ("+s.$translate("fumble")+")":c.$to_s(),u=[a(t.$length(),1)],S($,"critical=",e.to_a(u)),r(u.length,1),_=["("+s.expression+")",""+t.$join("+")+s.modifier_str,i],M(s.target_value)&&(m=M(f=$["$fumble?"]()["$!"]())?o(c,s.target_value):f,M(m)?(S($,"success=",e.to_a(u=[!0])),r(u.length,1)):(S($,"failure=",e.to_a(u=[!0])),r(u.length,1)),d=s.$translate(M(m)?"success":"failure"),_.$push(d)),u=[_.$join(" \uff1e ")],S($,"text=",e.to_a(u)),r(u.length,1),$},g.$$arity=1),function(t,a,n){var r,l,i,s,$,u=X(t,null,"ValueGroup");[u].concat(n),u.$$prototype.values=u.$$prototype.critical_value=w,u.$attr_reader("values"),u.$attr_reader("critical_value"),e.def(u,"$initialize",r=function(e,t){return this.values=e.$sort(),this.critical_value=t},r.$$arity=2),e.def(u,"$to_s",l=function(){return this.$max()+"["+this.values.$join(",")+"]"},l.$$arity=0),e.def(u,"$max",i=function(){var e,t=this;return M(S(t.values,"any?",[],((e=function(t){return null==t&&(t=w),(null==e.$$s?this:e.$$s)["$critical?"](t)}).$$s=t,e.$$arity=1,e)))?10:t.values.$max()},i.$$arity=0),e.def(u,"$num_of_critical_occurrences",s=function(){var e;return S(this.values,"count",[],((e=function(t){return null==t&&(t=w),(null==e.$$s?this:e.$$s)["$critical?"](t)}).$$s=this,e.$$arity=1,e))},s.$$arity=0),u.$private(),e.def(u,"$critical?",$=function(e){return o(e,this.critical_value)},$.$$arity=1)}(I[0],0,I),e.def(h,"$eval_game_system_specific_command",_=function(e){var t=this,a=w;return M(a=t.$parse_dx(e))?a.$execute(t.randomizer):e["$=="]("ET")?t.$roll_emotion_table():w},_.$$arity=1),h.$private(),e.def(h,"$parse_dx",m=function(e){var t;return M(t=this.$parse_dx_od(e))?t:this.$parse_dx_shippu_doto(e)},m.$$arity=1),e.def(h,"$parse_dx_od",f=function(e){var t=w,a=w,n=w,r=w;return t=z(A(I,"Command"),"Parser").$new(/\d+DX/,B(["round_type"],{round_type:this.$round_type()})).$enable_critical().$restrict_cmp_op_to(w,">=").$parse(e),M(t)?(a=t.$command().$to_i(),n=M(r=t.$critical())?r:10,z(this.$class(),"DX").$new(a,n,t.$modify_number(),t.$target_number())):w},f.$$arity=1),e.def(h,"$parse_dx_shippu_doto",d=function(t){var a,n,r,o=this,l=w,i=w,s=w,$=w;return l=z(A(I,"Command"),"Parser").$new(/\d+DX\d*/,B(["round_type"],{round_type:o.$round_type()})).$restrict_cmp_op_to(w,">=").$parse(t),M(l)?(n=S(l.$command().$split("DX",2),"map",[],((r=function(e){var t;return null==e&&(e=w),(t=e)===w||null==t?w:S(t,"to_i",[])}).$$s=o,r.$$arity=1,r)),i=null==(a=e.to_ary(n))[0]?w:a[0],s=M($=s=null==a[1]?w:a[1])?$:10,z(o.$class(),"DX").$new(i,s,l.$modify_number(),l.$target_number())):w},d.$$arity=1),e.def(h,"$roll_emotion_table",p=function(){var e,t=this,a=w,n=w,r=w,o=w;return a=z(t.$class(),"POSITIVE_EMOTION_TABLE").$roll(t.randomizer),n=z(t.$class(),"NEGATIVE_EMOTION_TABLE").$roll(t.randomizer),e=t.randomizer.$roll_once(2)["$=="](1),r=M(e)?["\u25cb"+a.$content(),n.$content()]:[a.$content(),"\u25cb"+n.$content()],o=[t.$translate("DoubleCross.ET.name")+"("+a.$sum()+"-"+n.$sum()+")",r.$join(" - ")],A(I,"Result").$new(o.$join(" \uff1e "))},p.$$arity=0),function(t,a){var n,r,o=[t].concat(a);t.$private(),e.def(t,"$positive_emotion_table",n=function(e){return z(A(o,"DiceTable"),"RangeTable").$new(A(o,"I18n").$translate("DoubleCross.ET.positive.name",B(["locale"],{locale:e})),"1D100",[[k(1,5,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.1_5",B(["locale"],{locale:e}))],[k(6,10,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.6_10",B(["locale"],{locale:e}))],[k(11,15,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.11_15",B(["locale"],{locale:e}))],[k(16,20,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.16_20",B(["locale"],{locale:e}))],[k(21,25,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.21_25",B(["locale"],{locale:e}))],[k(26,30,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.26_30",B(["locale"],{locale:e}))],[k(31,35,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.31_35",B(["locale"],{locale:e}))],[k(36,40,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.36_40",B(["locale"],{locale:e}))],[k(41,45,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.41_45",B(["locale"],{locale:e}))],[k(46,50,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.46_50",B(["locale"],{locale:e}))],[k(51,55,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.51_55",B(["locale"],{locale:e}))],[k(56,60,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.56_60",B(["locale"],{locale:e}))],[k(61,65,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.61_65",B(["locale"],{locale:e}))],[k(66,70,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.66_70",B(["locale"],{locale:e}))],[k(71,75,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.71_75",B(["locale"],{locale:e}))],[k(76,80,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.76_80",B(["locale"],{locale:e}))],[k(81,85,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.81_85",B(["locale"],{locale:e}))],[k(86,90,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.86_90",B(["locale"],{locale:e}))],[k(91,95,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.91_95",B(["locale"],{locale:e}))],[k(96,100,!1),A(o,"I18n").$translate("DoubleCross.ET.positive.items.96_100",B(["locale"],{locale:e}))]])},n.$$arity=1),e.def(t,"$negative_emotion_table",r=function(e){return z(A(o,"DiceTable"),"RangeTable").$new(A(o,"I18n").$translate("DoubleCross.ET.negative.name",B(["locale"],{locale:e})),"1D100",[[k(1,5,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.1_5",B(["locale"],{locale:e}))],[k(6,10,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.6_10",B(["locale"],{locale:e}))],[k(11,15,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.11_15",B(["locale"],{locale:e}))],[k(16,20,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.16_20",B(["locale"],{locale:e}))],[k(21,25,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.21_25",B(["locale"],{locale:e}))],[k(26,30,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.26_30",B(["locale"],{locale:e}))],[k(31,35,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.31_35",B(["locale"],{locale:e}))],[k(36,40,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.36_40",B(["locale"],{locale:e}))],[k(41,45,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.41_45",B(["locale"],{locale:e}))],[k(46,50,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.46_50",B(["locale"],{locale:e}))],[k(51,55,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.51_55",B(["locale"],{locale:e}))],[k(56,60,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.56_60",B(["locale"],{locale:e}))],[k(61,65,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.61_65",B(["locale"],{locale:e}))],[k(66,70,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.66_70",B(["locale"],{locale:e}))],[k(71,75,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.71_75",B(["locale"],{locale:e}))],[k(76,80,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.76_80",B(["locale"],{locale:e}))],[k(81,85,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.81_85",B(["locale"],{locale:e}))],[k(86,90,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.86_90",B(["locale"],{locale:e}))],[k(91,95,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.91_95",B(["locale"],{locale:e}))],[k(96,100,!1),A(o,"I18n").$translate("DoubleCross.ET.negative.items.96_100",B(["locale"],{locale:e}))]]).$freeze()},r.$$arity=1)}(e.get_singleton_class(h),I),e.const_set(I[0],"POSITIVE_EMOTION_TABLE",h.$positive_emotion_table("ja_jp").$freeze()),e.const_set(I[0],"NEGATIVE_EMOTION_TABLE",h.$negative_emotion_table("ja_jp").$freeze())}(Opal)}}]);