(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[6103],{3890:(Re,xe,ke)=>{ke(5151),Opal.modules["bcdice/arithmetic_evaluator"]=function(e){var F,Y,i,l,k,H,z,Q,V=e.module,G=e.ensure_kwargs,c=e.truthy,I=e.thrower,B=e.def,f=[],K=e.nil,m=e.$$$;return F=f,Y=Q=[V(f[0],"BCDice")].concat(F),z=[H=V(Q[0],"ArithmeticEvaluator")].concat(Y),l=[i=e.get_singleton_class(H)].concat(z),k=e.$r(l),B(i,"$eval",function(P,n){try{I("eval_return");var R,M=K;return null==(R=(n=G(n)).$$smap.round_type)&&(R=m(k("RoundType"),"FLOOR")),c(P)&&c(M=k("Arithmetic").$eval(P,R))?M:0}catch(D){if(D===e.t_eval_return)return D.$v;throw D}},-2)},Opal.modules["i18n/backend/fallbacks"]=function(e){var C,_,n,$,l,k,V=e.module,G=e.class_variable_set,c=e.truthy,I=e.class_variable_get,B=e.def,f=e.send,K=e.send2,m=e.find_super,E=e.hash2,F=e.find_block_super,j=e.neqeq,Q=e.thrower,q=e.return_val,Y=[],H=e.nil,z=e.$$$;return C=Y,k=[l=V(Y[0],"I18n")].concat(C),G(k[0],"@@fallbacks",H),_=e.get_singleton_class(l),n=[_].concat(k),$=e.$r(n),B(_,"$fallbacks",function(){var D=H;return G(n[1],"@@fallbacks",c(null!=n[1].$$cvars["@@fallbacks"]?"class variable":H)&&c(D=I(n[1],"@@fallbacks",!1))?D:z(z($("I18n"),"Locale"),"Fallbacks").$new()),c(D=$("Thread").$current()["$[]"]("i18n_fallbacks"))?D:I(n[1],"@@fallbacks",!1)}),B(_,"$fallbacks=",function(M){var D;return G(n[1],"@@fallbacks",c(M["$is_a?"]($("Array")))?z(z($("I18n"),"Locale"),"Fallbacks").$new(M):M),D=["i18n_fallbacks",I(n[1],"@@fallbacks",!1)],f($("Thread").$current(),"[]=",D),D[D.length-1]}),function(_,P){var M,D,N,A,$=[V(_,"Backend")].concat(P);return M=$,N=[D=V($[0],"Fallbacks")].concat(M),A=e.$r(N),B(D,"$translate",function T(h,g,s){try{var o=Q("return"),u=T.$$p||H,y=this,d=H,v=H;return T.$$p=null,null==s&&(s=A("EMPTY_HASH")),c(s.$fetch("fallback",!0))?c(s["$[]"]("fallback_in_progress"))?K(y,m(y,"translate",T,!1,!0),"translate",[h,g,s],u):(c(s["$[]"]("default"))&&(d=y["$extract_non_symbol_default!"](s)),v=s.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),f(A("I18n").$fallbacks()["$[]"](h),"each",[],function t(w){var r=null==t.$$s?this:t.$$s;null==w&&(w=H);try{return f(r,"catch",["exception"],function b(){var a=null==b.$$s?this:b.$$s,O=H;if(O=K(a,F(a,"translate",b.$$def||t.$$def||T,!1,!1),"translate",[w,g,v],null),c(O["$nil?"]()))return H;j(h.$to_s(),w.$to_s())&&a.$on_fallback(h,w,g,s),o.$throw(O)},{$$s:r,$$ret:o})}catch(b){if(!e.rescue(b,[z(A("I18n"),"InvalidLocale")]))throw b;try{return H}finally{e.pop_exception()}}},{$$s:y}),c(s["$key?"]("default"))&&c(s["$[]"]("default")["$nil?"]())?H:c(d)?K(y,m(y,"translate",T,!1,!0),"translate",[h,H,s.$merge(E(["default"],{default:d}))],null):y.$throw("exception",z(A("I18n"),"MissingTranslation").$new(h,g,s))):K(y,m(y,"translate",T,!1,!0),"translate",[h,g,s],u)}catch(t){if(t===o)return t.$v;throw t}},-3),B(D,"$extract_non_symbol_default!",function(h){var s,g=H;return g=[h["$[]"]("default")].$flatten(),s=f(g,"detect",[],function(u){return null==u&&(u=H),u["$is_a?"](A("Symbol"))["$!"]()}),c(s)&&h["$[]="]("default",g["$[]"](0,g.$index(s))),s}),B(D,"$exists?",function T(h,g,s){try{var o=Q("return"),u=T.$$p||H,y=this;return T.$$p=null,null==s&&(s=A("EMPTY_HASH")),c(s.$fetch("fallback",!0))?(f(A("I18n").$fallbacks()["$[]"](h),"each",[],function d(v){var t=null==d.$$s?this:d.$$s;null==v&&(v=H);try{if(!c(K(t,F(t,"exists?",d.$$def||T,!1,!1),"exists?",[v,g],null)))return H;o.$throw(!0)}catch(w){if(!e.rescue(w,[z(A("I18n"),"InvalidLocale")]))throw w;try{return H}finally{e.pop_exception()}}},{$$s:y,$$ret:o}),!1):K(y,m(y,"exists?",T,!1,!0),"exists?",[h,g,s],u)}catch(d){if(d===o)return d.$v;throw d}},-3),D.$private(),B(D,"$on_fallback",q(H))}(k[0],k)},Opal.modules["bcdice/randomizer"]=function(e){var l,R,M,D,N,A,_,P,G=e.klass,c=e.const_set,I=e.def,B=e.truthy,f=e.rb_gt,K=e.rb_plus,m=e.rb_le,E=e.send,F=e.rb_minus,j=e.eqeq,Q=e.rb_times,q=e.eqeqeq,Y=e.rb_ge,H=[],z=e.nil,i=e.$$$;return l=H,_=[(0,e.module)(H[0],"BCDice")].concat(l),P=e.$r(_),R=_,D=[M=G(_[0],null,"Randomizer")].concat(R),N=e.$r(D),(A=M.$$prototype).rand_results=A.detailed_rand_results=z,c(D[0],"UPPER_LIMIT_DICE_TIMES",200),c(D[0],"UPPER_LIMIT_DICE_SIDES",1e4),c(D[0],"UPPER_LIMIT_RANDS",1e4),I(M,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),M.$attr_reader("rand_results"),M.$attr_reader("detailed_rand_results"),c(D[0],"DetailedRandResult",N("Struct").$new("kind","sides","value")),I(M,"$roll_barabara",function(h,g){var s=this;return B(f(K(s.rand_results.$size(),h),N("UPPER_LIMIT_RANDS")))&&s.$raise(N("TooManyRandsError")),B(m(h,0))||B(f(h,N("UPPER_LIMIT_DICE_TIMES")))?[]:E(N("Array"),"new",[h],function o(){return(null==o.$$s?this:o.$$s).$roll_once(g)},{$$s:s})}),I(M,"$roll_sum",function(h,g){return this.$roll_barabara(h,g).$sum()}),I(M,"$roll_once",function(h){var s=z;return B(m(h,0))||B(f(h,N("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(h),this.$push_to_detail("normal",h,s),s)}),I(M,"$roll_index",function(h){return F(this.$roll_once(h),1)}),I(M,"$roll_tens_d10",function(){var s,g=z;return g=this.$rand_inner(10),j(g,10)&&(g=0),s=Q(g,10),this.$push_to_detail("tens_d10",10,s),s}),I(M,"$roll_d9",function(){var g;return g=F(this.$rand_inner(10),1),this.$push_to_detail("d9",10,g),g}),I(M,"$roll_d66",function(h){var o,s=z;return s=E(N("Array"),"new",[2],function u(){return(null==u.$$s?this:u.$$s).$roll_once(6)},{$$s:this}),q(i(N("D66SortType"),"ASC"),o=h)?s["$sort!"]():q(i(N("D66SortType"),"DESC"),o)&&s["$sort!"]()["$reverse!"](),K(Q(s["$[]"](0),10),s["$[]"](1))}),M.$private(),I(M,"$rand_inner",function(h){var s,g=this;return B(Y(g.rand_results.$size(),N("UPPER_LIMIT_RANDS")))&&g.$raise(N("TooManyRandsError")),s=g.$random(h),g.rand_results["$<<"]([s,h]),s}),I(M,"$random",function(h){return K(N("Kernel").$rand(h),1)}),I(M,"$push_to_detail",function(h,g,s){var u;return u=N("DetailedRandResult").$new(h,g,s),this.detailed_rand_results.$push(u)}),G(_[0],P("StandardError"),"TooManyRandsError"),z},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,q,C,l,k,_,P,H,j,V=e.module,G=e.klass,c=e.def,I=e.truthy,B=e.return_val,f=[],K=e.nil;return E=f,q=j=[V(f[0],"BCDice")].concat(E),C=H=[V(j[0],"DiceTable")].concat(q),k=[l=G(H[0],null,"RollResult")].concat(C),_=e.$r(k),(P=l.$$prototype).table_name=P.value=P.body=K,c(l,"$initialize",function($,R,M){var D=this;return D.table_name=$,D.value=R,D.body=M}),l.$attr_reader("table_name"),l.$attr_reader("value"),l.$attr_reader("body"),c(l,"$to_s",function(){var $=this;return $.table_name+"("+$.value+") \uff1e "+$.body}),c(l,"$last_body",function(){var $=this;return I($.body["$is_a?"](_("RollResult")))?$.body.$last_body():$.body}),c(l,"$empty?",B(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,q,C,l,k,_,P,H,j,V=e.module,G=e.klass,c=e.truthy,I=e.def,B=e.rb_minus,f=[],K=e.nil;return E=f,q=j=[V(f[0],"BCDice")].concat(E),C=H=[V(j[0],"DiceTable")].concat(q),k=[l=G(H[0],null,"ChainTable")].concat(C),_=e.$r(k),(P=l.$$prototype).times=P.sides=P.items=P.name=K,I(l,"$initialize",function($,R,M){var D=this,N=K;return D.name=$,D.items=M.$freeze(),N=/(\d+)D(\d+)/i.$match(R),c(N)||D.$raise(_("ArgumentError"),"Unexpected table type: "+R),D.times=N["$[]"](1).$to_i(),D.sides=N["$[]"](2).$to_i()}),I(l,"$roll",function($){var M,D,R=this,N=K;return M=$.$roll_sum(R.times,R.sides),D=B(M,R.times),N=R.items["$[]"](D),c(N["$respond_to?"]("roll"))&&(N=N.$roll($)),_("RollResult").$new(R.name,M,N)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var Q,z,_,P,n,$,R,C,Y,V=e.module,G=e.klass,c=e.hash2,I=e.defs,B=e.def,f=e.rb_plus,K=e.rb_times,m=e.rb_minus,E=[],F=e.nil;return Q=E,z=Y=[V(E[0],"BCDice")].concat(Q),_=C=[V(Y[0],"DiceTable")].concat(z),n=[P=G(C[0],null,"D66GridTable")].concat(_),$=e.$r(n),(R=P.$$prototype).name=R.items=F,I(P,"$from_i18n",function(D,N){var T=F;return T=$("I18n").$t(D,c(["locale","raise"],{locale:N,raise:!0})),this.$new(T["$[]"]("name"),T["$[]"]("items"))}),B(P,"$initialize",function(D,N){return this.name=D,this.items=N.$freeze()}),B(P,"$roll",function(D){var A,T,h,g,s;return A=D.$roll_once(6),T=D.$roll_once(6),h=f(K(A,10),T),g=m(A,1),s=m(T,1),$("RollResult").$new(this.name,h,this.items["$[]"](g)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var F,Y,k,_,P,n,z,i,Q,V=e.module,G=e.klass,c=e.hash2,I=e.defs,B=e.def,K=[],m=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),F=K,Y=Q=[V(K[0],"BCDice")].concat(F),z=[V(Q[0],"DiceTable")].concat(Y),i=e.$r(z),k=z,P=[_=G(z[0],i("D66GridTable"),"D66HalfGridTable")].concat(k),n=e.$r(P),I(_,"$from_i18n",function(R,M){var N=m;return N=n("I18n").$t(R,c(["locale","raise"],{locale:M,raise:!0})),this.$new(N["$[]"]("name"),N["$[]"]("items_1_2_3"),N["$[]"]("items_4_5_6"))}),B(_,"$initialize",function(R,M,D){return this.name=R,this.items=[M,M,M,D,D,D].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var F,Y,k,_,P,n,z,i,Q,V=e.module,G=e.klass,c=e.hash2,I=e.defs,B=e.def,K=[],m=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),F=K,Y=Q=[V(K[0],"BCDice")].concat(F),z=[V(Q[0],"DiceTable")].concat(Y),i=e.$r(z),k=z,P=[_=G(z[0],i("D66GridTable"),"D66OneThirdTable")].concat(k),n=e.$r(P),I(_,"$from_i18n",function(R,M){var N=m;return N=n("I18n").$t(R,c(["locale","raise"],{locale:M,raise:!0})),this.$new(N["$[]"]("name"),N["$[]"]("items_1_2"),N["$[]"]("items_3_4"),N["$[]"]("items_5_6"))}),B(_,"$initialize",function(R,M,D,N){return this.name=R,this.items=[M,M,D,D,N,N].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var Y,C,n,$,R,M,D,k,z,V=e.module,G=e.klass,c=e.hash2,I=e.defs,B=e.def,f=e.eqeqeq,K=e.rb_plus,m=e.rb_times,E=e.truthy,F=[],j=e.nil,Q=e.$$$;return Y=F,C=z=[V(F[0],"BCDice")].concat(Y),n=k=[V(z[0],"DiceTable")].concat(C),R=[$=G(k[0],null,"D66Table")].concat(n),M=e.$r(R),(D=$.$$prototype).sort_type=D.items=D.name=j,I($,"$from_i18n",function(A,T){var s,g=j;return g=M("I18n").$t(A,c(["locale"],{locale:T})),s=M("D66SortType").$const_get(g["$[]"]("d66_sort_type")),this.$new(g["$[]"]("name"),s,g["$[]"]("items"))}),B($,"$initialize",function(A,T,h){var g=this;return g.name=A,g.sort_type=T,g.items=h.$freeze()}),B($,"$roll",function(A){var T=this,h=j,g=j,s=j,o=j;return h=A.$roll_barabara(2,6),f(Q(M("D66SortType"),"ASC"),g=T.sort_type)?h["$sort!"]():f(Q(M("D66SortType"),"DESC"),g)&&h["$sort!"]()["$reverse!"](),s=K(m(h["$[]"](0),10),h["$[]"](1)),o=E(g=T.items["$[]"](s))?g:T.items["$[]"](s.$to_s()),E(o["$respond_to?"]("roll"))&&(o=o.$roll(A)),M("RollResult").$new(T.name,s,o)}),B($,"$choice",function(A){return M("RollResult").$new(this.name,A,this.items["$[]"](A))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var H,l,_,P,i,V=e.module,G=e.klass,c=e.hash2,I=e.send,B=e.to_ary,f=e.rb_plus,K=e.rb_times,m=e.send2,E=e.find_super,F=e.def,Q=[],q=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),H=Q,l=i=[V(Q[0],"BCDice")].concat(H),_=[V(i[0],"DiceTable")].concat(l),P=e.$r(_),F(G(_[0],P("D66Table"),"D66LeftRangeTable"),"$initialize",function M(D,N,A){var g;return M.$$p=null,g=c([],{}),I(A,"each",[],function(o){var u,v;return null==o&&(o=q),u=B(o),v=null==u[1]?q:u[1],I(null==u[0]?q:u[0],"each",[],function(w){return null==w&&(w=q),I(v,"each_with_index",[],function(b,a){var O,re;return null==b&&(b=q),null==a&&(a=q),re=f(K(w,10),f(a,1)),I(g,"[]=",O=[re,b]),O[O.length-1]})})}),m(this,E(this,"initialize",M,!1,!0),"initialize",[D,N,g],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var q,i,P,n,$,R,M,l,H,V=e.module,G=e.klass,c=e.hash2,I=e.defs,B=e.def,f=e.truthy,K=e.rb_minus,m=e.rb_plus,E=e.rb_times,F=[],j=e.nil;return q=F,i=H=[V(F[0],"BCDice")].concat(q),P=l=[V(H[0],"DiceTable")].concat(i),$=[n=G(l[0],null,"D66ParityTable")].concat(P),R=e.$r($),(M=n.$$prototype).odd=M.even=M.name=j,I(n,"$from_i18n",function(N,A){var h=j;return h=R("I18n").$t(N,c(["locale","raise"],{locale:A,raise:!0})),this.$new(h["$[]"]("name"),h["$[]"]("odd"),h["$[]"]("even"))}),B(n,"$initialize",function(N,A,T){var h=this;return h.name=N,h.odd=A.$freeze(),h.even=T.$freeze()}),B(n,"$roll",function(N){var h,s,o,A=this,T=j;return T=N.$roll_once(6),h=N.$roll_once(6),s=(f(T["$odd?"]())?A.odd:A.even)["$[]"](K(h,1)),o=m(E(T,10),h),R("RollResult").$new(A.name,o,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var F,Y,l,k,_,P,n,z,Q,V=e.module,G=e.klass,c=e.def,I=e.rb_plus,B=e.rb_times,f=e.send,K=[],m=e.nil;return F=K,Y=Q=[V(K[0],"BCDice")].concat(F),l=z=[V(Q[0],"DiceTable")].concat(Y),_=[k=G(z[0],null,"D66RangeTable")].concat(l),P=e.$r(_),(n=k.$$prototype).items=n.name=m,c(k,"$initialize",function(R,M){return this.name=R,this.items=M.$freeze()}),c(k,"$roll",function(R){var D,N,A,T=m;return D=R.$roll_once(6),N=R.$roll_once(6),A=I(B(D,10),N),T=f(this.items,"find",[],function(g){return null==g&&(g=m),g["$[]"](0)["$include?"](A)}),P("RollResult").$new(this.name,A,T["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var H,l,$,A,h,g,R,M,D,N,_,i,V=e.module,G=e.klass,c=e.const_set,I=e.send,B=e.hash2,f=e.def,K=e.eqeqeq,m=e.truthy,E=e.to_a,F=e.rb_times,j=e.rb_plus,Q=[],q=e.nil;return H=Q,l=i=[V(Q[0],"BCDice")].concat(H),$=_=[V(i[0],"DiceTable")].concat(l),M=[R=G(_[0],null,"RangeTable")].concat($),D=e.$r(M),(N=R.$$prototype).name=N.items=N.num_of_dice=N.num_of_sides=N.formatter=q,c(M[0],"RollResult",I(D("Struct"),"new",["sum","values","content","formatted"],function A(){return(null==A.$$s?this:A.$$s).$alias_method("to_s","formatted")},{$$s:R})),c(M[0],"Item",D("Struct").$new("range","content")),c(M[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),c(M[0],"DEFAULT_FORMATTER",I(R,"lambda",[],function(T,h){return null==T&&(T=q),null==h&&(h=q),T.$name()+"("+h.$sum()+") \uff1e "+h.$content()})),R.$attr_reader("name"),R.$attr_reader("num_of_dice"),R.$attr_reader("num_of_sides"),h=[A=e.get_singleton_class(R)].concat(M),g=e.$r(h),f(A,"$from_i18n",function(o,u){var v,d=q;return d=g("I18n").$t(o,B(["locale"],{locale:u})),v=I(d["$[]"]("items"),"map",[],function t(w){return null==w&&(w=q),[(null==t.$$s?this:t.$$s).$conv_string_range(w["$[]"](0)),w["$[]"](1)]},{$$s:this}),this.$new(d["$[]"]("name"),d["$[]"]("type"),v)}),f(A,"$conv_string_range",function(o){var y,u=this;return null==u.name&&(u.name=q),K(g("Integer"),y=o)?o:K(g("String"),y)?m(o["$include?"](".."))?I(g("Range"),"new",E(I(o.$split("..",2),"map",[],function d(v){return null==v&&(v=q),(null==d.$$s?this:d.$$s).$Integer(v)},{$$s:u}))):u.$Integer(o):u.$raise(g("TypeError"),u.name+": "+o+" ("+o.$class()+") must be a String or an Integer")}),f(R,"$initialize",function A(T,h,g){var u,s=A.$$p||q,o=this,y=q;return A.$$p=null,o.name=T.$freeze(),o.formatter=m(u=s)?u:D("DEFAULT_FORMATTER"),y=D("DICE_ROLL_METHOD_RE").$match(h),m(y)||o.$raise(D("ArgumentError"),o.name+": invalid dice roll method: "+h),o.num_of_dice=y["$[]"](1).$to_i(),o.num_of_sides=y["$[]"](2).$to_i(),o.$store(g)}),f(R,"$fetch",function(T){var g,h=this;return g=I(h.items,"find",[],function(o){return null==o&&(o=q),o.$range()["$include?"](T)}),m(g)||h.$raise(D("RangeError"),h.name+": value is out of range: "+T),g}),f(R,"$roll",function(T){var s,h=this,g=q,o=q;return s=(g=T.$roll_barabara(h.num_of_dice,h.num_of_sides)).$sum(),(o=D("RollResult").$new(s,g,h.$fetch(s).$content()))["$formatted="](h.formatter["$[]"](h,o)),o}),R.$private(),f(R,"$store",function(T){var g,s,h=this;return g=I(T,"map",[],function o(u,y){return null==u&&(u=q),null==y&&(y=q),[(null==o.$$s?this:o.$$s).$coerce_to_int_range(u),y]},{$$s:h}),s=I(g,"sort_by",[],function(u,y){return null==u&&(u=q),null==y&&(y=q),u.$min()}),h.$assert_min_sum_is_covered(s),h.$assert_max_sum_is_covered(s),h.$assert_no_gap_or_overlap_in_ranges(s),h.items=I(s,"map",[],function(u,y){return null==u&&(u=q),null==y&&(y=q),D("Item").$new(u,y.$freeze()).$freeze()}).$freeze(),h}),f(R,"$coerce_to_int_range",function(T){var g;return K(D("Integer"),g=T)?D("Range").$new(T,T):K(D("Range"),g)&&m(T.$begin()["$is_a?"](D("Integer")))&&m(T.$end()["$is_a?"](D("Integer")))?T:this.$raise(D("TypeError"),this.name+": "+T+" ("+T.$class()+") must be an Integer or a Range with Integers ")}),f(R,"$assert_min_sum_is_covered",function(T){var g,h=this,s=q;return g=h.num_of_dice,s=T.$first()["$[]"](0),m(s["$include?"](g))||h.$raise(D("RangeError"),h.name+": min value ("+g+") is not covered: "+s),h}),f(R,"$assert_max_sum_is_covered",function(T){var g,h=this,s=q;return g=F(h.num_of_dice,h.num_of_sides),s=T.$last()["$[]"](0),m(s["$include?"](g))||h.$raise(D("RangeError"),h.name+": max value ("+g+") is not covered: "+s),h}),f(R,"$assert_no_gap_or_overlap_in_ranges",function(T){return I(T,"each_cons",[2],function g(s,o){var v,t,u=null==g.$$s?this:g.$$s,y=q,d=q;return null==u.name&&(u.name=q),null==s&&(s=q),null==o&&(o=q),y=s["$[]"](0),d=o["$[]"](0),v=y.$max(),t=j(v,1),m(d["$include?"](v))&&u.$raise(D("RangeError"),u.name+": Range overlap: "+y+" and "+d),m(d["$include?"](t))?q:u.$raise(D("RangeError"),u.name+": Range gap: "+y+" and "+d)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var j,H,k,R,M,D,N,P,i,q,V=e.module,G=e.klass,c=e.send,I=e.def,B=e.rb_minus,f=e.return_ivar,K=[],m=e.nil,E=e.$$$;return j=K,H=q=[V(K[0],"BCDice")].concat(j),k=i=[V(q[0],"DiceTable")].concat(H),R=P=[G(i[0],null,"SaiFicSkillTable")].concat(k),D=[M=G(P[0],null,"Category")].concat(R),N=e.$r(D),I(M,"$initialize",function(T,h,g,s){var o=this;return o.name=T,o.skills=c(h.$map(),"with_index",[2],function(y,d){return null==y&&(y=m),null==d&&(d=m),E(N("SaiFicSkillTable"),"Skill").$new(T,y,g,d,s)}),o.dice=g}),I(M,"$roll",function(T){return this.$skills()["$[]"](B(T.$roll_sum(2,6),2))}),I(M,"$to_s",f("name")),M.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var m,Q,i,P,n,l,Y,F,V=e.module,G=e.klass,c=e.def,I=e.hash2,B=[],f=e.nil;return m=B,Q=F=[V(B[0],"BCDice")].concat(m),i=Y=[V(F[0],"DiceTable")].concat(Q),l=[G(Y[0],null,"SaiFicSkillTable")].concat(i),(n=(P=G(l[0],null,"Skill")).$$prototype).s_format=n.category_dice=n.row_dice=n.category_name=n.name=f,c(P,"$initialize",function(R,M,D,N,A){var T=this;return T.category_name=R,T.name=M,T.category_dice=D,T.row_dice=N,T.s_format=A}),c(P,"$to_s",function(){var R=this;return R.$format(R.s_format,I(["category_dice","row_dice","category_name","skill_name"],{category_dice:R.category_dice,row_dice:R.row_dice,category_name:R.category_name,skill_name:R.name}))}),P.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var l,n,N,A,T,h,g,R,_,V=e.module,G=e.klass,c=e.ensure_kwargs,I=e.hash2,B=e.send,K=e.defs,m=e.const_set,E=e.to_ary,F=e.def,j=e.truthy,Q=e.rb_minus,q=e.rb_plus,Y=e.top,H=[],z=e.nil,i=e.$$$;return Y.$require("bcdice/dice_table/sai_fic_skill_table/category"),Y.$require("bcdice/dice_table/sai_fic_skill_table/skill"),l=H,n=_=[V(H[0],"BCDice")].concat(l),N=R=[V(_[0],"DiceTable")].concat(n),T=[A=G(R[0],null,"SaiFicSkillTable")].concat(N),h=e.$r(T),(g=A.$$prototype).rtt=g.rtt_format=g.rct=g.rct_format=g.rttn=g.rttn_format=g.categories=z,K(A,"$from_i18n",function(o,u,y){var d,v,t,a,b=z;return null==(d=(y=c(y)).$$smap.rtt)&&(d=z),null==(v=y.$$smap.rct)&&(v=z),null==(t=y.$$smap.rttn)&&(t=z),a=(b=h("I18n").$t("RTT",I(["locale","raise","default"],{locale:u,raise:!1,default:I([],{})})).$merge(h("I18n").$t(o,I(["locale","raise"],{locale:u,raise:!0}))))["$[]"]("items"),b=B(b,"select",[],function(re,ee){return null==re&&(re=z),null==ee&&(ee=z),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](re)}),this.$new(a,e.to_hash(b).$merge(I(["rtt","rct","rttn"],{rtt:d,rct:v,rttn:t})))},-3),m(T[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),m(T[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),m(T[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),m(T[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),F(A,"$initialize",function(o,u){var y,d,v,t,w,r,b,a=this;return null==(y=(u=c(u)).$$smap.rtt)&&(y=z),null==(d=u.$$smap.rct)&&(d=z),null==(v=u.$$smap.rttn)&&(v=z),null==(t=u.$$smap.rtt_format)&&(t=h("DEFAULT_RTT")),null==(w=u.$$smap.rct_format)&&(w=h("DEFAULT_RCT")),null==(r=u.$$smap.rttn_format)&&(r=h("DEFAULT_RTTN")),null==(b=u.$$smap.s_format)&&(b=h("DEFAULT_S")),a.categories=B(o.$map(),"with_index",[1],function(re,ee){var $e,oe,ue;return null==re&&(re=z),null==ee&&(ee=z),oe=null==($e=E(re))[0]?z:$e[0],ue=null==$e[1]?z:$e[1],i(h("SaiFicSkillTable"),"Category").$new(oe,ue,ee,b)},{$$has_top_level_mlhs_arg:!0}),a.rtt=y,a.rct=d,a.rttn=v.$to_a(),a.rtt_format=t,a.rct_format=w,a.rttn_format=r},-2),m(T[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),A.$attr_reader("categories"),F(A,"$roll_command",function(o,u){var d,y=this,v=z,t=z;return j(["RTT",y.rtt]["$include?"](d=u))?y.$format_skill(y.rtt_format,y.$roll_skill(o)):j(["RCT",y.rct]["$include?"](d))?(v=y.$roll_category(o),y.$format(y.rct_format,I(["category_dice","category_name"],{category_dice:v.$dice(),category_name:v.$name()}))):j(t=h("RTTN").$index(d))||j(t=y.rttn.$index(d))?y.$format_skill(y.rttn_format,y.categories["$[]"](t).$roll(o)):z}),F(A,"$roll_category",function(o){return this.categories["$[]"](Q(o.$roll_once(6),1))}),F(A,"$roll_skill",function(o){return this.$roll_category(o).$roll(o)}),F(A,"$prefixes",function(){var o=this;return q(["RTT[1-6]?","RCT",o.rtt,o.rct],o.rttn).$compact()}),A.$private(),F(A,"$format_skill",function(o,u){return this.$format(o,I(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:u.$category_dice(),row_dice:u.$row_dice(),category_name:u.$category_name(),skill_name:u.$name(),text:u.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var j,H,k,_,P,n,$,i,q,V=e.module,G=e.klass,c=e.hash2,I=e.defs,B=e.truthy,f=e.def,K=e.rb_minus,m=[],E=e.nil;return j=m,H=q=[V(m[0],"BCDice")].concat(j),k=i=[V(q[0],"DiceTable")].concat(H),P=[_=G(i[0],null,"Table")].concat(k),n=e.$r(P),($=_.$$prototype).times=$.sides=$.name=$.items=E,I(_,"$from_i18n",function(M,D){var A=E;return A=n("I18n").$t(M,c(["locale"],{locale:D})),this.$new(A["$[]"]("name"),A["$[]"]("type"),A["$[]"]("items"))}),f(_,"$initialize",function(M,D,N){var A=this,T=E;return A.name=M,A.items=N.$freeze(),T=/(\d+)D(\d+)/i.$match(D),B(T)||A.$raise(n("ArgumentError"),"Unexpected table type: "+D),A.times=T["$[]"](1).$to_i(),A.sides=T["$[]"](2).$to_i()}),f(_,"$roll",function(M){var N,D=this;return N=M.$roll_sum(D.times,D.sides),D.$choice(N)}),f(_,"$choice",function(M){var N,D=this;return N=K(M,D.times),n("RollResult").$new(D.name,M,D.items["$[]"](N))})},Opal.modules["bcdice/dice_table"]=function(e){var V=e.top;return V.$require("bcdice/dice_table/roll_result"),V.$require("bcdice/dice_table/chain_table"),V.$require("bcdice/dice_table/d66_grid_table"),V.$require("bcdice/dice_table/d66_half_grid_table"),V.$require("bcdice/dice_table/d66_one_third_table"),V.$require("bcdice/dice_table/d66_left_range_table"),V.$require("bcdice/dice_table/d66_parity_table"),V.$require("bcdice/dice_table/d66_range_table"),V.$require("bcdice/dice_table/d66_table"),V.$require("bcdice/dice_table/range_table"),V.$require("bcdice/dice_table/sai_fic_skill_table"),V.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var f,F,Q,m,V=e.module,G=e.const_set,c=[];return f=c,F=m=[V(c[0],"BCDice")].concat(f),Q=[V(m[0],"D66SortType")].concat(F),G(Q[0],"NO_SORT","no_sort"),G(Q[0],"ASC","asc"),G(Q[0],"DESC","desc"),function(E,F){var Q=[V(E,"RoundType")].concat(F);return G(Q[0],"CEIL","ceil"),G(Q[0],"FLOOR","floor"),G(Q[0],"ROUND","round")}(m[0],m)},Opal.modules["bcdice/translate"]=function(e){var F,Y,H,z,i,Q,V=e.module,G=e.ensure_kwargs,c=e.kwrestargs,B=e.hash2,f=e.def,K=[],m=e.nil;return F=K,Y=Q=[V(K[0],"BCDice")].concat(F),z=[H=V(Q[0],"Translate")].concat(Y),i=e.$r(z),f(H,"$translate",function(l,k){var _,P=this;return null==P.locale&&(P.locale=m),k=G(k),_=c(k,{}),i("I18n").$translate(l,B(["locale","raise"],{locale:P.locale,raise:!0}).$merge(e.to_hash(_)))},-2)},Opal.modules["bcdice/result"]=function(e){var H,C,z,F,Q,G=e.klass,c=e.send,I=e.def,B=e.return_val,f=e.return_ivar,K=[],m=e.nil;return F=K,H=Q=[(0,e.module)(K[0],"BCDice")].concat(F),[z=G(Q[0],null,"Result")].concat(H),I(C=e.get_singleton_class(z),"$success",function(_){return c(this.$new(),"tap",[],function($){var R;return null==$&&($=m),$["$text="](_),c($,"success=",R=[!0]),R[R.length-1]})}),I(C,"$failure",function(_){return c(this.$new(),"tap",[],function($){var R;return null==$&&($=m),$["$text="](_),c($,"failure=",R=[!0]),R[R.length-1]})}),I(C,"$critical",function(_){return c(this.$new(),"tap",[],function($){var R;return null==$&&($=m),$["$text="](_),$["$critical="](!0),c($,"success=",R=[!0]),R[R.length-1]})}),I(C,"$fumble",function(_){return c(this.$new(),"tap",[],function($){var R;return null==$&&($=m),$["$text="](_),$["$fumble="](!0),c($,"failure=",R=[!0]),R[R.length-1]})}),I(C,"$nothing",B("nothing")),I(z,"$initialize",function(l){var k=this;return null==l&&(l=m),k.text=l,k.rands=m,k.detailed_rands=m,k.secret=!1,k.success=!1,k.failure=!1,k.critical=!1,k.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),I(z,"$secret?",f("secret")),I(z,"$success?",f("success")),I(z,"$failure?",f("failure")),I(z,"$critical?",f("critical")),I(z,"$fumble?",f("fumble")),I(z,"$condition=",function(l){return this.success=l,this.failure=l["$!"]()})},Opal.modules["racc/parser"]=function(e){var M,N,A,V=e.module,G=e.klass,c=e.truthy,I=e.const_set,B=e.defs,f=e.gvars,K=e.rb_lt,m=e.def,E=e.to_ary,F=e.send,j=e.neqeq,Q=e.rb_plus,q=e.eqeq,Y=e.rb_ge,H=e.rb_gt,z=e.rb_minus,i=e.rb_le,C=e.rb_times,l=e.assign_ivar_val,_=[],P=e.$r(_),n=e.nil,$=e.$$$;return M=_,N=[V(_[0],"Racc")].concat(M),A=e.$r(N),G(N[0],A("StandardError"),"ParseError"),c($("::","ParseError","skip_raise")?"constant":n)||I(_[0],"ParseError",$(P("Racc"),"ParseError")),function(R,M){var s,o,u,y,d,A=[V(R,"Racc")].concat(M),T=e.$r(A);return c(T("Racc_No_Extensions","skip_raise")?"constant":n)||I(A[0],"Racc_No_Extensions",!1),s=A,u=[o=G(A[0],null,"Parser")].concat(s),y=e.$r(u),(d=o.$$prototype).yydebug=d.racc_debug_out=d.racc_error_status=d.racc_t=d.racc_vstack=d.racc_val=d.racc_state=d.racc_tstack=n,I(u[0],"Racc_Runtime_Version","1.4.6"),I(u[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),I(u[0],"Racc_Runtime_Core_Version_R","1.4.6"),I(u[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),I(u[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),I(u[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),I(u[0],"Racc_Runtime_Core_Version",y("Racc_Runtime_Core_Version_R")),I(u[0],"Racc_Runtime_Core_Revision",y("Racc_Runtime_Core_Revision_R")),I(u[0],"Racc_Runtime_Type","ruby"),B(y("Parser"),"$racc_runtime_type",function(){return y("Racc_Runtime_Type")}),m(o,"$_racc_setup",function(){var t,w,r=this,b=n,a=n;return null==f.stderr&&(f.stderr=n),c($(r.$class(),"Racc_debug_parser"))||(r.yydebug=!1),c(null!=(t=r.yydebug)&&t!==n?"instance-variable":n)||(r.yydebug=!1),c(r.yydebug)&&(c(null!=(w=r.racc_debug_out)&&w!==n?"instance-variable":n)||(r.racc_debug_out=f.stderr),r.racc_debug_out=c(b=r.racc_debug_out)?b:f.stderr),a=$(r.$class(),"Racc_arg"),c(K(a.$size(),14))&&a["$[]="](13,!0),a}),m(o,"$_racc_init_sysvars",function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=n,t.racc_val=n,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0}),m(o,"$do_parse",function(){return this.$__send__(y("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),m(o,"$next_token",function(){return this.$raise(y("NotImplementedError"),this.$class()+"#next_token is not defined")}),m(o,"$_racc_do_parse_rb",function(t,w){var r,a=this,O=n,re=n,ee=n,$e=n,oe=n,ue=n,_e=n,le=n;return r=E(t),O=null==r[0]?n:r[0],re=null==r[1]?n:r[1],ee=null==r[2]?n:r[2],$e=null==r[3]?n:r[3],oe=null==r[10]?n:r[10],a.$_racc_init_sysvars(),ue=_e=le=n,F(a,"catch",["racc_end_parse"],function ae(){var se,te,S=null==ae.$$s?this:ae.$$s,X=n;for(null==S.racc_state&&(S.racc_state=n),null==S.racc_read_next&&(S.racc_read_next=n),null==S.racc_t&&(S.racc_t=n),null==S.yydebug&&(S.yydebug=n),null==S.racc_val&&(S.racc_val=n);c(!0);)for(c(le=$e["$[]"](S.racc_state["$[]"](-1)))?(c(S.racc_read_next)&&j(S.racc_t,0)&&(te=S.$next_token(),se=E(te),ue=null==se[0]?n:se[0],S.racc_val=null==se[1]?n:se[1],S.racc_t=c(ue)?c(X=oe["$[]"](ue))?X:1:0,c(S.yydebug)&&S.$racc_read_token(S.racc_t,ue,S.racc_val),S.racc_read_next=!1),le=Q(le,S.racc_t),c(Y(le,0))&&c(_e=O["$[]"](le))&&q(re["$[]"](le),S.racc_state["$[]"](-1))||(_e=ee["$[]"](S.racc_state["$[]"](-1)))):_e=ee["$[]"](S.racc_state["$[]"](-1));c(_e=S.$_racc_evalact(_e,t)););},{$$s:a})}),m(o,"$yyparse",function(t,w){return this.$__send__(y("Racc_YY_Parse_Method"),t,w,this.$_racc_setup(),!0)}),m(o,"$_racc_yyparse_rb",function(t,w,r,b){var a,ee=n,$e=n,ce=n,oe=n,_e=n,le=n,ae=n;return a=E(r),ee=null==a[0]?n:a[0],$e=null==a[1]?n:a[1],ce=null==a[2]?n:a[2],oe=null==a[3]?n:a[3],_e=null==a[10]?n:a[10],this.$_racc_init_sysvars(),le=n,ae=n,F(this,"catch",["racc_end_parse"],function se(){var te=null==se.$$s?this:se.$$s;for(null==te.racc_state&&(te.racc_state=n);!c(ae=oe["$[]"](te.racc_state["$[]"](-1)));)for(;c(le=te.$_racc_evalact(ce["$[]"](te.racc_state["$[]"](-1)),r)););return F(t,"__send__",[w],function S(X,L){var x=null==S.$$s?this:S.$$s,Z=n,p=n;for(null==x.racc_t&&(x.racc_t=n),null==x.racc_state&&(x.racc_state=n),null==x.racc_read_next&&(x.racc_read_next=n),null==X&&(X=n),null==L&&(L=n),x.racc_t=c(X)?c(Z=_e["$[]"](X))?Z:1:0,x.racc_val=L,x.racc_read_next=!1,ae=Q(ae,x.racc_t),c(Y(ae,0))&&c(le=ee["$[]"](ae))&&q($e["$[]"](ae),x.racc_state["$[]"](-1))||(le=ce["$[]"](x.racc_state["$[]"](-1)));c(le=x.$_racc_evalact(le,r)););for(;c(c(Z=c(p=(ae=oe["$[]"](x.racc_state["$[]"](-1)))["$!"]())?p:x.racc_read_next["$!"]())?Z:x.racc_t["$=="](0));)for(c(ae)&&c(ae=Q(ae,x.racc_t))&&c(Y(ae,0))&&c(le=ee["$[]"](ae))&&q($e["$[]"](ae),x.racc_state["$[]"](-1))||(le=ce["$[]"](x.racc_state["$[]"](-1)));c(le=x.$_racc_evalact(le,r)););},{$$s:te})},{$$s:this})}),m(o,"$_racc_evalact",function(t,w){var r,ce,a=this,O=n,re=n,$e=n,oe=n,ue=n,_e=n;if(O=null==(r=E(w))[0]?n:r[0],re=null==r[1]?n:r[1],$e=null==r[3]?n:r[3],ce=null==r[11]?n:r[11],oe=null==r[12]?n:r[12],c(H(t,0))&&c(K(t,ce)))c(H(a.racc_error_status,0))&&(q(a.racc_t,1)||(a.racc_error_status=z(a.racc_error_status,1))),a.racc_vstack.$push(a.racc_val),a.racc_state.$push(t),a.racc_read_next=!0,c(a.yydebug)&&(a.racc_tstack.$push(a.racc_t),a.$racc_shift(a.racc_t,a.racc_tstack,a.racc_vstack));else if(c(K(t,0))&&c(H(t,oe["$-@"]()))){if(ue=F(a,"catch",["racc_jump"],function le(){var ae=null==le.$$s?this:le.$$s;return null==ae.racc_state&&(ae.racc_state=n),ae.racc_state.$push(ae.$_racc_do_reduce(w,t)),!1},{$$s:a}),c(ue))switch(ue.valueOf()){case 1:return a.racc_user_yyerror=!0,oe["$-@"]();case 2:return ce;default:a.$raise("[Racc Bug] unknown jump code")}}else if(q(t,ce))c(a.yydebug)&&a.$racc_accept(),a.$throw("racc_end_parse",a.racc_vstack["$[]"](0));else{if(q(t,oe["$-@"]())){switch(a.racc_error_status.valueOf()){case 0:c(w["$[]"](21))||a.$on_error(a.racc_t,a.racc_val,a.racc_vstack);break;case 3:q(a.racc_t,0)&&a.$throw("racc_end_parse",n),a.racc_read_next=!0}for(a.racc_user_yyerror=!1,a.racc_error_status=3;c(!0)&&!(c(_e=$e["$[]"](a.racc_state["$[]"](-1)))&&(_e=Q(_e,1),c(Y(_e,0))&&c(t=O["$[]"](_e))&&q(re["$[]"](_e),a.racc_state["$[]"](-1))));)c(i(a.racc_state.$size(),1))&&a.$throw("racc_end_parse",n),a.racc_state.$pop(),a.racc_vstack.$pop(),c(a.yydebug)&&(a.racc_tstack.$pop(),a.$racc_e_pop(a.racc_state,a.racc_tstack,a.racc_vstack));return t}a.$raise("[Racc Bug] unknown action "+t.$inspect())}return c(a.yydebug)&&a.$racc_next_state(a.racc_state["$[]"](-1),a.racc_state),n}),m(o,"$_racc_do_reduce",function(t,w){var r,oe,_e,X,L,x,U,a=this,re=n,ee=n,$e=n,ce=n,ue=n,le=n,ae=n,se=n,te=n,S=n,Z=n,p=n,J=n;return re=null==(r=E(t))[4]?n:r[4],ee=null==r[5]?n:r[5],$e=null==r[6]?n:r[6],ce=null==r[7]?n:r[7],oe=null==r[8]?n:r[8],ue=null==r[9]?n:r[9],_e=null==r[13]?n:r[13],le=a.racc_state,ae=a.racc_vstack,se=a.racc_tstack,te=C(w,-3),S=ue["$[]"](te),X=ue["$[]"](Q(te,1)),L=ue["$[]"](Q(te,2)),x=[],c(a.yydebug)&&(Z=se["$[]"](S["$-@"](),S)),p=ae["$[]"](S["$-@"](),S),c(a.yydebug)&&se["$[]="](S["$-@"](),S,x),ae["$[]="](S["$-@"](),S,x),le["$[]="](S["$-@"](),S,x),c(_e)?ae.$push(a.$__send__(L,p,ae,p["$[]"](0))):ae.$push(a.$__send__(L,p,ae)),se.$push(X),c(a.yydebug)&&a.$racc_reduce(Z,X,se,ae),U=z(X,oe),c(te=ce["$[]"](U))&&(te=Q(te,le["$[]"](-1)),c(Y(te,0))&&c(J=re["$[]"](te))&&q(ee["$[]"](te),U))?J:$e["$[]"](U)}),m(o,"$on_error",function(t,w,r){var a,b=this;return b.$raise(y("ParseError"),b.$sprintf("\nparse error on value %s (%s)",w.$inspect(),c(a=b.$token_to_str(t))?a:"?"))}),m(o,"$yyerror",function(){return this.$throw("racc_jump",1)}),m(o,"$yyaccept",function(){return this.$throw("racc_jump",2)}),m(o,"$yyerrok",l("racc_error_status",0)),m(o,"$racc_read_token",function(t,w,r){var b=this;return b.racc_debug_out.$print("read    "),b.racc_debug_out.$print(w.$inspect(),"(",b.$racc_token2str(t),") "),b.racc_debug_out.$puts(r.$inspect()),b.racc_debug_out.$puts()}),m(o,"$racc_shift",function(t,w,r){var b=this;return b.racc_debug_out.$puts("shift   "+b.$racc_token2str(t)),b.$racc_print_stacks(w,r),b.racc_debug_out.$puts()}),m(o,"$racc_reduce",function(t,w,r,b){var a=this,O=n;return(O=a.racc_debug_out).$print("reduce "),c(t["$empty?"]())?O.$print(" <none>"):F(t,"each",[],function re(ee){return null==ee&&(ee=n),O.$print(" ",(null==re.$$s?this:re.$$s).$racc_token2str(ee))},{$$s:a}),O.$puts(" --\x3e "+a.$racc_token2str(w)),a.$racc_print_stacks(r,b),a.racc_debug_out.$puts()}),m(o,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),m(o,"$racc_e_pop",function(t,w,r){var b=this;return b.racc_debug_out.$puts("error recovering mode: pop token"),b.$racc_print_states(t),b.$racc_print_stacks(w,r),b.racc_debug_out.$puts()}),m(o,"$racc_next_state",function(t,w){var r=this;return r.racc_debug_out.$puts("goto    "+t),r.$racc_print_states(w),r.racc_debug_out.$puts()}),m(o,"$racc_print_stacks",function(t,w){var b=n;return(b=this.racc_debug_out).$print("        ["),F(t,"each_index",[],function a(O){return null==O&&(O=n),b.$print(" (",(null==a.$$s?this:a.$$s).$racc_token2str(t["$[]"](O))," ",w["$[]"](O).$inspect(),")")},{$$s:this}),b.$puts(" ]")}),m(o,"$racc_print_states",function(t){var r=n;return(r=this.racc_debug_out).$print("        ["),F(t,"each",[],function(a){return null==a&&(a=n),r.$print(" ",a)}),r.$puts(" ]")}),m(o,"$racc_token2str",function(t){var r;return c(r=$(this.$class(),"Racc_token_to_s_table")["$[]"](t))?r:this.$raise("[Racc Bug] can't convert token "+t+" to string")}),m(o,"$token_to_str",function(t){return $(this.$class(),"Racc_token_to_s_table")["$[]"](t)})}(_[0],_)},Opal.modules["bcdice/arithmetic/node"]=function(e){var l,n,D,s,o,A,T,R,_,V=e.module,G=e.klass,c=e.def,I=e.thrower,B=e.return_ivar,f=e.send2,K=e.find_super,m=e.eqeq,E=e.const_set,F=e.eqeqeq,j=e.rb_divide,Q=e.truthy,q=e.assign_ivar,Y=e.alias,H=[],z=e.nil,i=e.$$$;return l=H,n=_=[V(H[0],"BCDice")].concat(l),D=R=[V(_[0],"Arithmetic")].concat(n),A=[V(R[0],"Node")].concat(D),T=e.$r(A),(o=(s=G(A[0],null,"BinaryOp")).$$prototype).lhs=o.rhs=o.op=z,c(s,"$initialize",function(y,d,v){var t=this;return t.lhs=y,t.op=d,t.rhs=v}),c(s,"$eval",function(y){try{I("eval_return");var w,v=this,t=z;return t=v.lhs.$eval(y),w=v.rhs.$eval(y),t.$send(v.op,w)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),c(s,"$output",function(){var y=this;return""+y.lhs.$output()+y.op+y.rhs.$output()}),c(s,"$s_exp",function(){var y=this;return"("+y.$op_for_s_exp()+" "+y.lhs.$s_exp()+" "+y.rhs.$s_exp()+")"}),c(s,"$op_for_s_exp",B("op")),function(h,g,s){var o=G(h,g,"DivideBase"),u=[o].concat(s),y=e.$r(u),d=o.$$prototype;d.lhs=d.rhs=d.op=z,c(o,"$initialize",function v(t,w){return v.$$p=null,f(this,K(this,"initialize",v,!1,!0),"initialize",[t,"/",w],null)}),c(o,"$eval",function(t){try{I("eval_return");var b,a,r=this;return b=r.lhs.$eval(t),a=r.rhs.$eval(t),m(a,0)&&r.$raise(y("ZeroDivisionError")),r.$divide_and_round(b,a,t)}catch(O){if(O===e.t_eval_return)return O.$v;throw O}}),c(o,"$output",function v(){var t=v.$$p||z,w=this;return v.$$p=null,""+f(w,K(w,"output",v,!1,!0),"output",[],t)+w.$rounding_method()}),o.$private(),c(o,"$rounding_method",function(){return i(this.$class(),"ROUNDING_METHOD")}),c(o,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),c(o,"$divide_and_round",function(t,w,r){return this.$raise(y("NotImplementedError"))})}(A[0],T("BinaryOp"),A),function(h,g,s){var o=G(h,g,"DivideWithGameSystemDefault"),u=[o].concat(s),y=e.$r(u);E(u[0],"ROUNDING_METHOD",""),o.$private(),c(o,"$divide_and_round",function(v,t,w){var r,b=z;return F(i(y("RoundType"),"CEIL"),r=w)?j(v.$to_f(),t).$ceil():F(i(y("RoundType"),"ROUND"),r)?(b=j(v.$to_f(),t),Q(b["$negative?"]())?b.$abs().$round()["$-@"]():b.$round()):j(v,t).$floor()})}(A[0],T("DivideBase"),A),function(h,g,s){var o=G(h,g,"DivideWithCeil"),u=[o].concat(s);E(u[0],"ROUNDING_METHOD","C"),o.$private(),c(o,"$divide_and_round",function(d,v,t){return j(d.$to_f(),v).$ceil()})}(A[0],T("DivideBase"),A),function(h,g,s){var o=G(h,g,"DivideWithRound"),u=[o].concat(s);E(u[0],"ROUNDING_METHOD","R"),o.$private(),c(o,"$divide_and_round",function(d,v,t){var w=z;return w=j(d.$to_f(),v),Q(w["$negative?"]())?w.$abs().$round()["$-@"]():w.$round()})}(A[0],T("DivideBase"),A),function(h,g,s){var o=G(h,g,"DivideWithFloor"),u=[o].concat(s);E(u[0],"ROUNDING_METHOD","F"),o.$private(),c(o,"$divide_and_round",function(d,v,t){return j(d,v).$floor()})}(A[0],T("DivideBase"),A),function(h,g){var s=G(h,null,"Negative");s.$$prototype.body=z,c(s,"$initialize",q("body")),c(s,"$eval",function(y){try{return I("eval_return"),this.body.$eval(y)["$-@"]()}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(s,"$output",function(){return"-"+this.body.$output()}),c(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(A[0]),function(h,g){var s=G(h,null,"Parenthesis");s.$$prototype.expr=z,c(s,"$initialize",q("expr")),c(s,"$eval",function(y){try{return I("eval_return"),this.expr.$eval(y)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),c(s,"$output",function(){return"("+this.expr.$output()+")"}),c(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(A[0]),function(h,g){var s=G(h,null,"Number");return s.$$prototype.value=z,c(s,"$initialize",q("value")),c(s,"$eval",B("value")),c(s,"$output",function(){return this.value.$to_s()}),Y(s,"s_exp","output")}(A[0])},Opal.modules.strscan=function(e){var q,Y,H,z,i,G=e.def,c=e.truthy,I=e.eqeqeq,B=e.Opal,f=e.return_ivar,K=e.send,m=e.alias,E=[],F=e.nil;return q=E,H=[Y=(0,e.klass)(E[0],null,"StringScanner")].concat(q),z=e.$r(H),(i=Y.$$prototype).pos=i.string=i.working=i.matched=i.prev_pos=i.match=F,Y.$attr_reader("pos","matched"),G(Y,"$initialize",function(l){var k=this;return k.string=l,k.pos=0,k.matched=F,k.working=l,k.match=[]}),Y.$attr_reader("string"),G(Y,"$beginning_of_line?",function(){var l=this;return 0===l.pos||"\n"===l.string.charAt(l.pos-1)}),G(Y,"$scan",function(l){var k=this,_=(l=k.$anchor(l)).exec(k.working);return null==_?k.matched=F:(k.prev_pos=k.pos,k.pos+=_[0].length,k.working=k.working.substring(_[0].length),k.matched=_[0],k.match=_,_[0])}),G(Y,"$scan_until",function(l){var k=this;l=k.$anchor(l);for(var _=k.working,P=0;_.length!=P;++P){var n=l.exec(_.substr(P));if(null!==n){var $=P+n[0].length,R=_.substr(0,$);return k.matched=n[0],k.match=n,k.prev_pos=k.pos+P,k.pos+=$,k.working=_.substr($),R}}return k.matched=F}),G(Y,"$[]",function(l){var _;if(c(this.match["$empty?"]()))return F;I(z("Symbol"),_=l)?l=l.$to_s():I(z("String"),_)||(l=B["$coerce_to!"](l,z("Integer"),"to_int"));var P=this.match;return l<0&&(l+=P.length),l<0||l>=P.length||null==P[l]?F:P[l]}),G(Y,"$check",function(l){var k=this,_=(l=k.$anchor(l)).exec(k.working);return k.matched=null==_?F:_[0]}),G(Y,"$check_until",function(l){var k=this,_=k.prev_pos,P=k.pos,n=k.working,$=k.$scan_until(l);return k.prev_pos=_,k.pos=P,k.working=n,$}),G(Y,"$peek",function(l){return this.working.substring(0,l)}),G(Y,"$eos?",function(){return 0===this.working.length}),G(Y,"$exist?",function(l){var _=l.exec(this.working);return null==_?F:0==_.index?0:_.index+1}),G(Y,"$skip",function(l){var k=this,_=(l=k.$anchor(l)).exec(k.working);if(null==_)return k.match=[],k.matched=F;var P=_[0],n=P.length;return k.matched=P,k.match=_,k.prev_pos=k.pos,k.pos+=n,k.working=k.working.substring(n),n}),G(Y,"$skip_until",function(l){var _=this.$scan_until(l);return _===F?F:(this.matched=_.substr(-1),_.length)}),G(Y,"$get_byte",function(){var l=this,k=F;return l.pos<l.string.length?(l.prev_pos=l.pos,l.pos+=1,k=l.matched=l.working.substring(0,1),l.working=l.working.substring(1)):l.matched=F,k}),G(Y,"$match?",function(l){var k=this,_=(l=k.$anchor(l)).exec(k.working);return null==_?F:(k.prev_pos=k.pos,_[0].length)}),G(Y,"$pos=",function(l){var k=this;return l<0&&(l+=k.string.$length()),k.pos=l,k.working=k.string.slice(l)}),G(Y,"$matched_size",function(){return this.matched===F?F:this.matched.length}),G(Y,"$post_match",function(){var l=this;return l.matched===F?F:l.string.substr(l.pos)}),G(Y,"$pre_match",function(){var l=this;return l.matched===F?F:l.string.substr(0,l.prev_pos)}),G(Y,"$reset",function(){var l=this;return l.working=l.string,l.matched=F,l.pos=0}),G(Y,"$rest",f("working")),G(Y,"$rest?",function(){return 0!==this.working.length}),G(Y,"$rest_size",function(){return this.$rest().$size()}),G(Y,"$terminate",function(){var l,k=this;return k.match=F,l=[k.string.$length()],K(k,"pos=",l),l[l.length-1]}),G(Y,"$unscan",function(){var l=this;return l.pos=l.prev_pos,l.prev_pos=F,l.match=F,l}),m(Y,"bol?","beginning_of_line?"),m(Y,"getch","get_byte"),Y.$private(),G(Y,"$anchor",function(l){var k=l.toString().match(/\/([^\/]+)$/);return k=k?k[1]:void 0,new RegExp("^(?:"+l.source+")",k)})},Opal.modules["bcdice/normalize"]=function(e){var m,Q,F,V=e.module,G=e.eqeqeq,c=e.def,I=e.eqeq,B=[],f=e.nil;return m=B,F=[V(B[0],"BCDice")].concat(m),(Q=V(F[0],"Normalize")).$module_function(),c(Q,"$comparison_operator",function(Y){var H;return G(/<=|=</,H=Y)?"<=":G(/>=|=>/,H)?">=":G(/<>|!=|=!/,H)?"!=":G(/</,H)?"<":G(/>/,H)?">":G(/=/,H)?"==":f}),c(Q,"$target_number",function(Y){return I(Y,"?")?Y:Y.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var q,i,P,n,$,R,M,l,H,V=e.module,G=e.klass,c=e.const_set,I=e.hash2,B=e.truthy,f=e.send,K=e.def,m=e.thrower,E=e.top,F=[],j=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),q=F,i=H=[V(F[0],"BCDice")].concat(q),P=l=[V(H[0],"Command")].concat(i),$=[n=G(l[0],null,"Lexer")].concat(P),R=e.$r($),(M=n.$$prototype).scanner=M.notations=j,c($[0],"SYMBOLS",I(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),K(n,"$initialize",function(N,A){var T,h,s;return N=B(s=(T=(h=N)===j||null==h?j:h.$split(" ",2))===j||null==T?j:T.$first())?s:"",this.scanner=R("StringScanner").$new(N),this.notations=f(A,"map",[],function(u){return null==u&&(u=j),B(u["$is_a?"](R("String")))?R("Regexp").$new(u):u})}),K(n,"$next_token",function(){try{var N=m("return"),A=this,T=j,h=j,s=j,o=j;return B(A.scanner["$eos?"]())?[!1,"$"]:(f(A.notations,"each",[],function u(y){var v,d=null==u.$$s?this:u.$$s;if(null==d.scanner&&(d.scanner=j),null==y&&(y=j),v=d.scanner.$scan(y),!B(v))return j;N.$throw(["NOTATION",v])},{$$s:A,$$ret:N}),B(T=A.scanner.$scan(/\d+/))?["NUMBER",T.$to_i()]:B(h=A.scanner.$scan(/[<>!=]+/))?(h=R("Normalize").$comparison_operator(h),[B(h)?"CMP_OP":"ILLEGAL",h]):(s=A.scanner.$getch().$upcase(),[B(o=R("SYMBOLS")["$[]"](s))?o:s.$to_sym(),s]))}catch(u){if(u===N)return u.$v;throw u}}),K(n,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,q,C,l,k,_,P,H,j,V=e.module,G=e.klass,c=e.def,I=e.return_ivar,B=e.truthy,f=[],K=e.nil;return E=f,q=j=[V(f[0],"BCDice")].concat(E),C=H=[V(j[0],"Command")].concat(q),k=[l=G(H[0],null,"Parsed")].concat(C),_=e.$r(k),(P=l.$$prototype).critical=P.fumble=P.dollar=P.modify_number=P.question_target=P.target_number=P.prefix_number=P.command=P.suffix_number=P.cmp_op=K,l.$attr_accessor("command"),l.$attr_accessor("prefix_number"),l.$attr_accessor("suffix_number"),l.$attr_accessor("critical"),l.$attr_accessor("fumble"),l.$attr_accessor("dollar"),l.$attr_accessor("modify_number"),l.$attr_accessor("cmp_op"),l.$attr_accessor("target_number"),l.$attr_writer("question_target"),c(l,"$initialize",function(){var $=this;return $.prefix_number=K,$.suffix_number=K,$.critical=K,$.fumble=K,$.dollar=K,$.cmp_op=K,$.target_number=K,$.question_target=!1}),c(l,"$question_target?",I("question_target")),c(l,"$to_s",function($){var R=this,M=K,D=K,N=K,A=K,T=K;switch(null==$&&($="after_command"),M=B(R.critical)?"@"+R.critical:K,D=B(R.fumble)?"#"+R.fumble:K,N=B(R.dollar)?"$"+R.dollar:K,A=_("Format").$modifier(R.modify_number),T=B(R.question_target)?"?":R.target_number,$.valueOf()){case"after_command":return[R.prefix_number,R.command,R.suffix_number,M,D,N,A,R.cmp_op,T].$join();case"after_modify_number":return[R.prefix_number,R.command,R.suffix_number,A,M,D,N,R.cmp_op,T].$join();case"after_target_number":return[R.prefix_number,R.command,R.suffix_number,A,R.cmp_op,T,M,D,N].$join();default:return K}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var $,N,o,w,r,b,a,O,re,ee,$e,ce,_e,u,v,t,se,T,h,M,V=e.klass,G=e.module,c=e.slice,I=e.extract_kwargs,B=e.ensure_kwargs,f=e.get_kwarg,K=e.send2,m=e.find_super,E=e.def,F=e.send,j=e.eqeq,Q=e.thrower,q=e.hash,Y=e.const_set,H=e.truthy,z=e.to_ary,i=e.hash2,C=e.top,l=[],k=e.$r(l),_=e.nil,P=e.$$$;return C.$require("racc/parser.rb"),C.$require("bcdice/arithmetic/node"),C.$require("bcdice/command/lexer"),C.$require("bcdice/command/parsed"),V(P(k("BCDice"),"Command"),P(k("Racc"),"Parser"),"Parser"),$=l,N=M=[G(l[0],"BCDice")].concat($),T=[G(M[0],"Command")].concat(N),h=e.$r(T),o=T,v=[u=V(T[0],P(h("Racc"),"Parser"),"Parser")].concat(o),t=e.$r(v),(se=u.$$prototype).notations=se.lexer=se.modifier=se.suffix_number=se.prefix_number=se.need_suffix_number=se.need_prefix_number=se.critical=se.fumble=se.dollar=se.allowed_cmp_op=se.question_target=_,E(u,"$initialize",function te(S,X){var L,x,Z,p,J=this;return te.$$p=null,L=c(arguments),x=I(L),x=B(x),Z=L,p=f(x,"round_type"),K(J,m(J,"initialize",te,!1,!0),"initialize",[],null),J.notations=Z,J.round_type=p,J.prefix_number=!1,J.suffix_number=!1,J.need_prefix_number=!1,J.need_suffix_number=!1,J.modifier=!0,J.critical=!1,J.fumble=!1,J.dollar=!1,J.allowed_cmp_op=[_,">=",">","<=","<","==","!="],J.question_target=!1},-2),E(u,"$disable_modifier",function(){return this.modifier=!1,this}),E(u,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(u,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(u,"$has_prefix_number",function(){var S=this;return S.prefix_number=!0,S.need_prefix_number=!0,S}),E(u,"$has_suffix_number",function(){var S=this;return S.suffix_number=!0,S.need_suffix_number=!0,S}),E(u,"$enable_critical",function(){return this.critical=!0,this}),E(u,"$enable_fumble",function(){return this.fumble=!0,this}),E(u,"$enable_dollar",function(){return this.dollar=!0,this}),E(u,"$restrict_cmp_op_to",function(S){var X;return X=c(arguments),this.allowed_cmp_op=X,this},-1),E(u,"$enable_question_target",function(){return this.question_target=!0,this}),E(u,"$parse",function(S){var X=this;try{return X.lexer=t("Lexer").$new(S,X.notations),X.$do_parse()}catch(L){if(!e.rescue(L,[t("ParseError"),t("ZeroDivisionError")]))throw L;try{return _}finally{e.pop_exception()}}}),u.$private(),E(u,"$parsed",function(S,X,L,x){try{return Q("eval_return"),F(t("Parsed").$new(),"tap",[],function U(J){var W,ne,ie,fe,me,de,ve,he=null==U.$$s?this:U.$$s;return null==he.round_type&&(he.round_type=_),null==J&&(J=_),J["$command="](S["$[]"]("command")),J["$prefix_number="]((W=S["$[]"]("prefix"))===_||null==W?_:W.$eval(he.round_type)),J["$suffix_number="]((ne=S["$[]"]("suffix"))===_||null==ne?_:ne.$eval(he.round_type)),J["$critical="]((ie=X["$[]"]("critical"))===_||null==ie?_:ie.$eval(he.round_type)),J["$fumble="]((fe=X["$[]"]("fumble"))===_||null==fe?_:fe.$eval(he.round_type)),J["$dollar="]((me=X["$[]"]("dollar"))===_||null==me?_:me.$eval(he.round_type)),J["$modify_number="](L.$eval(he.round_type)),J["$cmp_op="](x["$[]"]("cmp_op")),j(x["$[]"]("target"),"?")?(J["$question_target="](!0),F(J,"target_number=",de=[0]),de[de.length-1]):(J["$question_target="](!1),de=[(ve=x["$[]"]("target"),ve===_||null==ve?_:ve.$eval(he.round_type))],F(J,"target_number=",de),de[de.length-1])},{$$s:this})}catch(U){if(U===e.t_eval_return)return U.$v;throw U}}),E(u,"$next_token",function(){return this.lexer.$next_token()}),w=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),r=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),b=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),a=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),O=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),re=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),ee=[_,6,13,3,9,-1,27,-15,-10,-1,-38],$e=[_,_,_,_,_,_,19,16,15,_,_],ce=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),_e=q(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),Y(v[0],"Racc_arg",[w,r,a,b,O,re,$e,ee,19,ce,_e,58,35,!0]),H(t("Ractor","skip_raise")?"constant":_)&&t("Ractor").$make_shareable(t("Racc_arg")),Y(v[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),H(t("Ractor","skip_raise")?"constant":_)&&t("Ractor").$make_shareable(t("Racc_token_to_s_table")),Y(v[0],"Racc_debug_parser",!1),E(u,"$_reduce_1",function(S,X,L){var x,p=this;return H(p.modifier)||p.$raise(t("ParseError")),x=z(S),p.$parsed(null==x[0]?_:x[0],null==x[1]?_:x[1],null==x[2]?_:x[2],null==x[3]?_:x[3])}),E(u,"$_reduce_2",function(S,X,L){var x,p=this;return H(p.modifier)||p.$raise(t("ParseError")),x=z(S),p.$parsed(null==x[0]?_:x[0],null==x[2]?_:x[2],null==x[1]?_:x[1],null==x[3]?_:x[3])}),E(u,"$_reduce_3",function(S,X,L){var x,W;return W=null==(x=z(S))[2]?_:x[2],this.$parsed(null==x[0]?_:x[0],null==x[1]?_:x[1],P(P(t("Arithmetic"),"Node"),"Number").$new(0),W)}),E(u,"$_reduce_4",function(S,X,L){var x=this;return H(x.prefix_number)&&H(x.suffix_number)||x.$raise(t("ParseError")),i(["command","prefix","suffix"],{command:S["$[]"](1),prefix:S["$[]"](0),suffix:S["$[]"](2)})}),E(u,"$_reduce_5",function(S,X,L){var x=this;return H(x.prefix_number)||x.$raise(t("ParseError")),H(x.need_suffix_number)&&x.$raise(t("ParseError")),i(["command","prefix"],{command:S["$[]"](1),prefix:S["$[]"](0)})}),E(u,"$_reduce_6",function(S,X,L){var x=this;return H(x.suffix_number)||x.$raise(t("ParseError")),H(x.need_prefix_number)&&x.$raise(t("ParseError")),i(["command","suffix"],{command:S["$[]"](0),suffix:S["$[]"](1)})}),E(u,"$_reduce_7",function(S,X,L){var x=this;return(H(x.need_prefix_number)||H(x.need_suffix_number))&&x.$raise(t("ParseError")),i(["command"],{command:S["$[]"](0)})}),E(u,"$_reduce_8",function(S,X,L){return i([],{})}),E(u,"$_reduce_9",function(S,X,L){var x,W,U=_;return U=null==(x=z(S))[0]?_:x[0],W=null==x[2]?_:x[2],H(this.critical)&&H(U["$[]"]("critical")["$nil?"]())||this.$raise(t("ParseError")),U["$[]="]("critical",W),U}),E(u,"$_reduce_10",function(S,X,L){var x,W,U=_;return U=null==(x=z(S))[0]?_:x[0],W=null==x[2]?_:x[2],H(this.fumble)&&H(U["$[]"]("fumble")["$nil?"]())||this.$raise(t("ParseError")),U["$[]="]("fumble",W),U}),E(u,"$_reduce_11",function(S,X,L){var x,W,U=_;return U=null==(x=z(S))[0]?_:x[0],W=null==x[2]?_:x[2],H(this.dollar)&&H(U["$[]"]("dollar")["$nil?"]())||this.$raise(t("ParseError")),U["$[]="]("dollar",W),U}),E(u,"$_reduce_12",function(S,X,L){return S["$[]"](1)}),E(u,"$_reduce_13",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"Negative").$new(S["$[]"](1))}),E(u,"$_reduce_14",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"+",S["$[]"](2))}),E(u,"$_reduce_15",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"-",S["$[]"](2))}),E(u,"$_reduce_16",function(S,X,L){return H(this.allowed_cmp_op["$include?"](_))||this.$raise(t("ParseError")),i([],{})}),E(u,"$_reduce_17",function(S,X,L){var x,U,J;return J=null==(x=z(S))[1]?_:x[1],H(this.allowed_cmp_op["$include?"](U=null==x[0]?_:x[0]))||this.$raise(t("ParseError")),i(["cmp_op","target"],{cmp_op:U,target:J})}),E(u,"$_reduce_18",function(S,X,L){var Z,x=this;return Z=S["$[]"](0),H(x.question_target)||x.$raise(t("ParseError")),H(x.allowed_cmp_op["$include?"](Z))||x.$raise(t("ParseError")),i(["cmp_op","target"],{cmp_op:Z,target:"?"})}),E(u,"$_reduce_19",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"+",S["$[]"](2))}),E(u,"$_reduce_20",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"-",S["$[]"](2))}),E(u,"$_reduce_22",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"BinaryOp").$new(S["$[]"](0),"*",S["$[]"](2))}),E(u,"$_reduce_23",function(S,X,L){return S["$[]"](3).$new(S["$[]"](0),S["$[]"](2))}),E(u,"$_reduce_25",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(u,"$_reduce_26",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"DivideWithCeil")}),E(u,"$_reduce_27",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"DivideWithCeil")}),E(u,"$_reduce_28",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"DivideWithRound")}),E(u,"$_reduce_29",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"DivideWithFloor")}),E(u,"$_reduce_30",function(S,X,L){return S["$[]"](1)}),E(u,"$_reduce_31",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"Negative").$new(S["$[]"](1))}),E(u,"$_reduce_33",function(S,X,L){return S["$[]"](1)}),E(u,"$_reduce_34",function(S,X,L){return P(P(t("Arithmetic"),"Node"),"Number").$new(S["$[]"](0))}),E(u,"$_reduce_none",function(S,X,L){return S["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var F,Y,C,l,k,_,z,Q,V=e.module,G=e.send,c=e.eqeqeq,I=e.truthy,B=e.def,f=e.return_val,K=[],m=e.nil;return F=K,Y=Q=[V(K[0],"BCDice")].concat(F),C=z=[V(Q[0],"Deprecated")].concat(Y),k=[l=V(z[0],"Checker")].concat(C),_=e.$r(k),l.$private(),B(l,"$check_result_legacy",function(n,$,R,M){var T,D=this,N=m,A=m,h=m,g=m;return N=G($,"map",[],"sides".$to_proc()),T=(A=G($,"map",[],"value".$to_proc())).$sum(),h=c([100],g=N)?D.$check_1D100(n,T,R,M):c([20],g)?D.$check_1D20(n,T,R,M):c([6,6],g)?D.$check_2D6(n,T,A,R,M):m,(I(h["$nil?"]())||I(h["$empty?"]()))&&(h=c([10],g=N.$uniq())?D.$check_nD10(n,T,A,R,M):c([6],g)?D.$check_nD6(n,T,A,R,M):m,I(h["$nil?"]())||I(h["$empty?"]()))?m:_("Result").$new(h.$delete_prefix(" \uff1e "))}),B(l,"$check_1D100",f(m)),B(l,"$check_1D20",f(m)),B(l,"$check_nD10",f(m)),B(l,"$check_2D6",f(m)),B(l,"$check_nD6",f(m))},Opal.modules["bcdice/base"]=function(e){var k,D,g,d,t,w,s,o,u,y,A,V=e.module,G=e.klass,c=e.slice,I=e.rb_plus,B=e.truthy,f=e.def,K=e.regexp,m=e.send,E=e.thrower,F=e.return_ivar,j=e.assign_ivar_val,Q=e.eqeqeq,q=e.eqeq,Y=e.return_val,H=e.range,z=e.rb_minus,i=e.rb_divide,C=e.rb_times,l=e.rb_ge,_=e.top,P=[],n=e.$r(P),$=e.nil,R=e.$$$;return _.$require("i18n"),_.$require("i18n/backend/fallbacks"),_.$require("bcdice/randomizer"),_.$require("bcdice/dice_table"),_.$require("bcdice/enum"),_.$require("bcdice/translate"),_.$require("bcdice/result"),_.$require("bcdice/command/parser"),_.$require("bcdice/deprecated/checker"),D=P,g=A=[V(P[0],"BCDice")].concat(D),o=[s=G(A[0],null,"Base")].concat(g),u=e.$r(o),(y=s.$$prototype).raw_input=y.randomizer=y.enabled_upcase_input=y.debug=$,t=[d=e.get_singleton_class(s)].concat(o),w=e.$r(t),d.$attr_reader("prefixes"),f(d,"$register_prefix",function(b){var O,ee;return null==this.prefixes&&(this.prefixes=$),O=c(arguments),this.prefixes=I(B(ee=this.prefixes)?ee:[],O.$flatten())},-1),f(d,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),f(d,"$prefixes_pattern",function(){var b=this,a=$;return null==b.prefixes_pattern&&(b.prefixes_pattern=$),null==b.prefixes&&(b.prefixes=$),b.prefixes_pattern=B(a=b.prefixes_pattern)?a:$,B(b.prefixes_pattern)?b.prefixes_pattern:(b.prefixes=B(a=b.prefixes)?a:[],b.prefixes.$freeze(),b.prefixes_pattern=(B(b.prefixes["$empty?"]())?/(?!)/:K(["^(S)?(",b.prefixes.$join("|"),")"],"i")).$freeze())}),f(d,"$command_pattern",function(){var b=this,a=$,O=$;return null==b.command_pattern&&(b.command_pattern=$),null==b.prefixes&&(b.prefixes=$),b.command_pattern=B(a=b.command_pattern)?a:$,B(b.command_pattern)?b.command_pattern:(b.prefixes=B(a=b.prefixes)?a:[],b.prefixes.$freeze(),O=I(m(R(w("CommonCommand"),"COMMANDS"),"map",[],function(ee){return null==ee&&(ee=$),R(ee,"PREFIX_PATTERN").$source()}),b.prefixes),b.command_pattern=K(["^S?(",O.$join("|"),")"],"i").$freeze())}),f(d,"$eval",function(b){try{return E("eval_return"),this.$new(b).$eval()}catch(re){if(re===e.t_eval_return)return re.$v;throw re}}),s.$include(u("Translate")),s.$include(R(u("Deprecated"),"Checker")),f(s,"$initialize",function(v){var t=this;return t.raw_input=v,t.sort_add_dice=!1,t.sort_barabara_dice=!1,t.d66_sort_type=R(u("D66SortType"),"NO_SORT"),t.enabled_d9=!1,t.round_type=R(u("RoundType"),"FLOOR"),t.sides_implicit_d=6,t.upper_dice_reroll_threshold=$,t.reroll_dice_reroll_threshold=$,t.default_cmp_op=$,t.default_target_number=$,t.enabled_upcase_input=!0,t.locale="ja_jp",t.randomizer=R(u("BCDice"),"Randomizer").$new(),t.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),f(s,"$sort_add_dice?",F("sort_add_dice")),f(s,"$sort_barabara_dice?",F("sort_barabara_dice")),f(s,"$enabled_d9?",F("enabled_d9")),f(s,"$enable_debug",j("debug",!0)),f(s,"$eval",function(){var t,r,v=this,w=$;return t=R(u("BCDice"),"Preprocessor").$process(v.raw_input,v),w=B(r=v.$dice_command(t))?r:v.$eval_common_command(v.raw_input),B(w)?(w["$rands="](v.randomizer.$rand_results()),w["$detailed_rands="](v.randomizer.$detailed_rand_results()),w):$}),f(s,"$change_text",function(v){return v}),f(s,"$check_result",function(v,t,w,r){var b=this,a=$,O=$,re=$,ee=$,$e=$;return a=b.$check_result_legacy(v,t,w,r),B(a)?a:(O=m(t,"map",[],"sides".$to_proc()),ee=(re=m(t,"map",[],"value".$to_proc())).$sum(),a=Q([100],$e=O)?b.$result_1d100(v,ee,w,r):Q([20],$e)?b.$result_1d20(v,ee,w,r):Q([6,6],$e)?b.$result_2d6(v,ee,re,w,r):$,q(a,u("Result").$nothing())?$:B(a)?a:(a=Q([10],$e=O.$uniq())?b.$result_nd10(v,ee,re,w,r):Q([6],$e)?b.$result_nd6(v,ee,re,w,r):$,q(a,u("Result").$nothing())?$:B(a)?a:b.$result_ndx(v,w,r)))}),f(s,"$grich_text",Y($)),s.$private(),f(s,"$eval_common_command",function(v){try{E("eval_return");var w=E("return");return v=this.$change_text(v),m(R(u("CommonCommand"),"COMMANDS"),"each",[],function b(a){var re,O=null==b.$$s?this:b.$$s;if(null==O.randomizer&&(O.randomizer=$),null==a&&(a=$),re=a.$eval(v,O,O.randomizer),!B(re))return $;w.$throw(re)},{$$s:this,$$ret:w}),$}catch(b){if(b===e.t_eval_return||b===w)return b.$v;throw b}}),f(s,"$dice_command",function(v){var t=this,w=$,r=$,b=$,a=$;return B(t.enabled_upcase_input)&&(v=v.$upcase()),w=t.$class().$prefixes_pattern().$match(v),B(w)?(r=w["$[]"](1)["$nil?"]()["$!"](),B(r)&&(v=v["$[]"](H(1,-1,!1))),b=t.$eval_game_system_specific_command(v),B(b["$is_a?"](u("Result")))?(b["$secret="](B(a=b["$secret?"]())?a:r),b):B(b["$nil?"]())||B(b["$empty?"]())||q(b,"1")?$:m(u("Result").$new(),"tap",[],function(re){var ee;return null==re&&(re=$),re["$text="](b.$to_s()),m(re,"secret=",ee=[r]),ee[ee.length-1]})):$}),f(s,"$eval_game_system_specific_command",Y($)),f(s,"$result_ndx",function(v,t,w){return B(w["$is_a?"](u("String")))?$:B(v.$send(t,w))?u("Result").$success(this.$translate("success")):u("Result").$failure(this.$translate("failure"))}),f(s,"$result_1d100",Y($)),f(s,"$result_1d20",Y($)),f(s,"$result_nd10",Y($)),f(s,"$result_2d6",Y($)),f(s,"$result_nd6",Y($)),f(s,"$get_table_by_2d6",function(v){return this.$get_table_by_nD6(v,2)}),f(s,"$get_table_by_1d6",function(v){return this.$get_table_by_nD6(v,1)}),f(s,"$get_table_by_nD6",function(v,t){return this.$get_table_by_nDx(v,t,6)}),f(s,"$get_table_by_nDx",function(v,t,w){var b,a=$;return b=this.randomizer.$roll_sum(t,w),a=this.$get_table_value(v["$[]"](z(b,t))),B(a["$nil?"]())?["1",0]:[a,b]}),f(s,"$get_table_by_1d3",function(v){var r,b,t=this,a=$;return t.$debug("get_table_by_1d3"),r=t.randomizer.$roll_sum(1,6),t.$debug("num",r),b=i(z(r,1),2).$to_i(),t.$debug("index",b),a=v["$[]"](b),B(a["$nil?"]())?["1",0]:[a,r]}),f(s,"$get_table_by_d66_swap",function(v){var w;return w=this.randomizer.$roll_d66(R(u("D66SortType"),"ASC")),[this.$get_table_by_number(w,v),w]}),f(s,"$get_table_by_d66",function(v){var w,r,b,O,a=$;return w=this.randomizer.$roll_once(6),r=this.randomizer.$roll_once(6),b=I(C(z(w,1),6),z(r,1)),a=v["$[]"](b),O=""+w+r,B(a["$nil?"]())?["1",O]:[a,O]}),f(s,"$get_table_by_number",function(v,t,w){try{var r=E("return");return null==w&&(w="1"),m(t,"each",[],function a(O){var ee,re=null==a.$$s?this:a.$$s;if(null==O&&(O=$),ee=O["$[]"](0),!B(l(ee,v)))return $;r.$throw(re.$get_table_value(O["$[]"](1)))},{$$s:this,$$ret:r}),this.$get_table_value(w)}catch(a){if(a===r)return a.$v;throw a}},-3),f(s,"$get_table_value",function(v){return B(v["$is_a?"](u("Proc")))?v.$call():v}),f(s,"$roll_tables",function(v,t){var r=$;return r=t["$[]"](v),B(r)?r.$roll(this.randomizer).$to_s():$}),f(s,"$debug",function(v,t){var r,b=this,a=$,O=$;return r=c(arguments,1),B(b.debug)?(a=B(v["$is_a?"](u("String")))?v:v.$inspect(),B(r["$empty?"]())?b.$warn(a):(O=m(r,"map",[],function(ee){return null==ee&&(ee=$),B(ee["$is_a?"](u("String")))?'"'+ee+'"':ee.$inspect()}),b.$warn(a+": "+O.$join(", ")))):$},-2),R(R(n("I18n"),"Backend"),"Simple").$include(R(R(n("I18n"),"Backend"),"Fallbacks")),n("I18n").$load_path()["$<<"](n("Dir")["$[]"](n("File").$join("bcdice","../../i18n/**/*.yml"))),n("I18n")["$default_locale="]("ja_jp"),k=[["ja_jp"]],m(n("I18n").$fallbacks(),"defaults=",k),k[k.length-1]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var j,H,_,M,D,N,A,n,i,C,q,V=e.module,G=e.klass,c=e.const_set,I=e.hash2,B=e.truthy,f=e.def,m=[],E=e.nil;return e.top.$require("strscan"),j=m,H=q=[V(m[0],"BCDice")].concat(j),i=[V(q[0],"GameSystem")].concat(H),C=e.$r(i),_=i,M=n=[G(i[0],C("Base"),"SwordWorld")].concat(_),N=[D=G(n[0],null,"RatingLexer")].concat(M),A=e.$r(N),D.$$prototype.scanner=E,c(N[0],"SYMBOLS",I(["+","-","*","/","(",")","[","]","@","#","$","~"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR","~":"TILDE"}).$freeze()),f(D,"$initialize",function(g){var s,o,y;return g=B(y=(s=(o=g)===E||null==o?E:o.$split(" ",2))===E||null==s?E:s.$first())?y:"",this.scanner=A("StringScanner").$new(g)}),f(D,"$next_token",function(){var g=this,s=E,o=E,y=E;return B(g.scanner["$eos?"]())?[!1,"$"]:B(s=g.scanner.$scan(/\d+/))?["NUMBER",s.$to_i()]:(o=g.scanner.$getch().$upcase(),[B(y=A("SYMBOLS")["$[]"](o))?y:o.$to_sym(),o])}),f(D,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var Q,z,P,D,N,A,T,h,$,C,l,Y,V=e.module,G=e.klass,c=e.def,I=e.truthy,B=e.rb_le,f=e.rb_plus,K=e.rb_lt,m=e.neqeq,E=[],F=e.nil;return Q=E,z=Y=[V(E[0],"BCDice")].concat(Q),C=[V(Y[0],"GameSystem")].concat(z),l=e.$r(C),P=C,D=$=[G(C[0],l("Base"),"SwordWorld")].concat(P),A=[N=G($[0],null,"RatingParsed")].concat(D),T=e.$r(A),(h=N.$$prototype).modifier_after_half=h.modifier_after_one_and_a_half=h.semi_fixed_val=h.kept_modify=h.rate=h.greatest_fortune=h.modifier=F,N.$attr_accessor("rate"),N.$attr_accessor("critical"),N.$attr_accessor("kept_modify"),N.$attr_accessor("first_to"),N.$attr_accessor("first_modify"),N.$attr_accessor("first_modify_ssp"),N.$attr_accessor("rateup"),N.$attr_accessor("greatest_fortune"),N.$attr_accessor("semi_fixed_val"),N.$attr_accessor("tmp_fixed_val"),N.$attr_accessor("modifier"),N.$attr_accessor("modifier_after_half"),N.$attr_accessor("modifier_after_one_and_a_half"),c(N,"$initialize",function(s,o){var u=this;return u.rate=s,u.modifier=o,u.critical=13,u.kept_modify=0,u.first_to=0,u.first_modify=0,u.first_modify_ssp=0,u.greatest_fortune=!1,u.rateup=0,u.semi_fixed_val=0,u.tmp_fixed_val=0,u.modifier_after_half=F,u.modifier_after_one_and_a_half=F}),c(N,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()}),c(N,"$one_and_a_half",function(){return this.modifier_after_one_and_a_half["$nil?"]()["$!"]()}),c(N,"$min_critical",function(){var s=this;return I(B(s.semi_fixed_val,1))?3:f(f(s.semi_fixed_val,s.kept_modify),2).$clamp(3,13)}),c(N,"$infinite_roll?",function(){return K(this.$critical(),this.$min_critical())}),c(N,"$to_s",function(){var s=this,o=F;return o="KeyNo."+s.rate,I(K(s.$critical(),13))&&(o=f(o,"c["+s.$critical()+"]")),m(s.$first_modify(),0)&&(o=f(o,"m["+T("Format").$modifier(s.$first_modify())+"]")),m(s.$first_modify_ssp(),0)&&(o=f(o,"m[~"+T("Format").$modifier(s.$first_modify_ssp())+"]")),m(s.$first_to(),0)&&(o=f(o,"m["+s.$first_to()+"]")),m(s.$rateup(),0)&&(o=f(o,"r["+s.$rateup()+"]")),I(s.greatest_fortune)&&(o=f(o,"gf")),m(s.$semi_fixed_val(),0)&&(o=f(o,"sf["+s.$semi_fixed_val()+"]")),m(s.$tmp_fixed_val(),0)&&(o=f(o,"tf["+s.$tmp_fixed_val()+"]")),m(s.$kept_modify(),0)&&(o=f(o,"a["+T("Format").$modifier(s.$kept_modify())+"]")),m(s.modifier,0)&&(o=f(o,T("Format").$modifier(s.modifier))),o})},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var m,Q,C,n,k,Y,H,F,V=e.module,G=e.klass,c=e.truthy,I=e.def,B=[];return m=B,Q=F=[V(B[0],"BCDice")].concat(m),Y=[V(F[0],"GameSystem")].concat(Q),H=e.$r(Y),C=Y,k=[G(Y[0],H("Base"),"SwordWorld")].concat(C),(n=G(k[0],null,"RatingOptions")).$attr_accessor("critical"),n.$attr_accessor("kept_modify"),n.$attr_accessor("first_to"),n.$attr_accessor("first_modify"),n.$attr_accessor("first_modify_ssp"),n.$attr_accessor("rateup"),n.$attr_accessor("greatest_fortune"),n.$attr_accessor("semi_fixed_val"),n.$attr_accessor("tmp_fixed_val"),n.$attr_accessor("modifier"),n.$attr_accessor("modifier_after_half"),n.$attr_accessor("modifier_after_one_and_a_half"),I(n,"$settable_first_roll_adjust_option?",function(){var M,D,R=this;return c(M=c(D=R.$first_modify()["$nil?"]())?R.$first_to()["$nil?"]():D)?R.$first_modify_ssp()["$nil?"]():M}),I(n,"$settable_non_2d_roll_option?",function(){var M,D,R=this;return c(M=c(D=R.$greatest_fortune()["$nil?"]())?R.$semi_fixed_val()["$nil?"]():D)?R.$tmp_fixed_val()["$nil?"]():M})},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var k,$,T,y,b,a,O,re,ee,$e,ce,oe,ue,ae,d,w,r,S,g,s,M,D,P,V=e.module,G=e.klass,c=e.ensure_kwargs,I=e.send2,B=e.find_super,f=e.def,K=e.send,m=e.truthy,E=e.not,F=e.thrower,j=e.hash,Q=e.const_set,q=e.to_ary,Y=e.eqeq,H=e.top,z=[],i=e.nil,C=e.$$$;return H.$require("racc/parser.rb"),H.$require("bcdice/arithmetic/node"),H.$require("bcdice/enum"),H.$require("bcdice/game_system/sword_world/rating_lexer"),H.$require("bcdice/game_system/sword_world/rating_parsed"),H.$require("bcdice/game_system/sword_world/rating_options"),k=z,$=P=[V(z[0],"BCDice")].concat(k),M=[V(P[0],"GameSystem")].concat($),D=e.$r(M),T=M,g=[G(M[0],D("Base"),"SwordWorld")].concat(T),s=e.$r(g),y=g,w=[d=G(g[0],C(s("Racc"),"Parser"),"RatingParser")].concat(y),r=e.$r(w),(S=d.$$prototype).lexer=S.round_type=S.version=i,f(d,"$initialize",function X(L){var x,Z,U=this;return X.$$p=null,null==(x=(L=c(L)).$$smap.version)&&(x="v1_0"),null==(Z=L.$$smap.round_type)&&(Z=C(r("RoundType"),"CEIL")),I(U,B(U,"initialize",X,!1,!0),"initialize",[],null),U.version=x,U.round_type=Z},-1),f(d,"$set_debug",function(){return this.yydebug=!0,this}),f(d,"$parse",function(L){try{return this.lexer=r("RatingLexer").$new(L),this.$do_parse()}catch(Z){if(!e.rescue(Z,[r("ParseError"),r("ZeroDivisionError")]))throw Z;try{return i}finally{e.pop_exception()}}}),d.$private(),f(d,"$parsed",function(L,x,Z){try{return F("eval_return"),K(r("RatingParsed").$new(L,x),"tap",[],function J(W){var ne,ie,fe,me,de,ve,he,ge,pe,ye=null==J.$$s?this:J.$$s,be=i;return null==ye.round_type&&(ye.round_type=i),null==W&&(W=i),W["$kept_modify="](m(be=(ne=Z.$kept_modify())===i||null==ne?i:ne.$eval(ye.round_type))?be:0),W["$first_to="](m(be=Z.$first_to())?be:0),W["$first_modify="](m(be=Z.$first_modify())?be:0),W["$first_modify_ssp="](m(be=Z.$first_modify_ssp())?be:0),W["$rateup="](m(be=(ie=Z.$rateup())===i||null==ie?i:ie.$eval(ye.round_type))?be:0),E(Z.$greatest_fortune()["$nil?"]())&&W["$greatest_fortune="](Z.$greatest_fortune()),W["$semi_fixed_val="](m(be=(fe=Z.$semi_fixed_val())===i||null==fe?i:fe.$clamp(1,6))?be:0),W["$tmp_fixed_val="](m(be=(me=Z.$tmp_fixed_val())===i||null==me?i:me.$clamp(1,6))?be:0),W["$modifier_after_half="]((de=Z.$modifier_after_half())===i||null==de?i:de.$eval(ye.round_type)),W["$modifier_after_one_and_a_half="]((ve=Z.$modifier_after_one_and_a_half())===i||null==ve?i:ve.$eval(ye.round_type)),he=[m((pe=Z.$critical(),ge=pe===i||null==pe?i:pe.$eval(ye.round_type),be=ge===i||null==ge?i:ge.$clamp(0,13)))?be:m(W.$half())||m(W.$one_and_a_half())?13:10],K(W,"critical=",he),he[he.length-1]},{$$s:this})}catch(J){if(J===e.t_eval_return)return J.$v;throw J}}),f(d,"$next_token",function(){return this.lexer.$next_token()}),b=e.large_array_unpack("36,66,67,27,28,5,68,3,4,37,38,18,16,17,19,6,20,21,23,24,39,64,65,5,13,9,14,22,15,18,16,17,19,10,20,21,23,24,64,65,64,65,13,11,14,22,15,18,16,17,19,5,20,21,23,24,34,41,34,43,13,44,14,22,15,30,31,30,31,33,34,33,34,64,65,64,65,34,45,30,31,30,31,33,34,33,30,31,53,34,33,34,58,30,31,59,34,33,30,31,30,31,33,34,33,30,31,60,34,33,34,62,30,31,63,34,33,30,31,30,31,33,34,33,30,31,69,34,33,34,,30,31,,34,33,30,31,30,31,33,,33,30,31,64,65,33,64,65"),a=e.large_array_unpack("15,56,56,12,12,0,56,0,0,15,15,7,7,7,7,1,7,7,7,7,15,47,47,3,7,4,7,7,7,25,25,25,25,5,25,25,25,25,49,49,51,51,25,6,25,25,25,50,50,50,50,9,50,50,50,50,13,17,14,19,50,20,50,50,50,13,13,14,14,13,16,14,18,52,52,57,57,22,21,16,16,18,18,16,23,18,22,22,29,24,22,27,37,23,23,38,28,23,24,24,27,27,24,30,27,28,28,39,31,28,33,44,30,30,45,41,30,31,31,33,33,31,64,33,41,41,60,65,41,66,,64,64,,67,64,65,65,66,66,65,,66,67,67,72,72,67,73,73"),O=e.large_array_unpack("2,15,,20,20,31,43,7,,48,,,-8,54,56,-2,68,52,70,51,53,70,75,82,87,25,,89,94,70,101,106,,108,,,,90,93,96,,113,,,109,112,,8,,25,43,27,60,,,,-10,62,,,124,,,,120,125,127,132,,,,,132,135"),re=e.large_array_unpack("-37,-37,-5,-37,-37,-37,-37,-1,-5,-37,-4,74,-6,-37,-37,-37,-13,-37,-37,-37,-37,-37,-37,-37,-37,-2,-5,-37,-37,-37,-37,-37,-34,-37,-36,-8,-9,-37,-37,-37,-14,-15,-17,-18,-37,-37,-21,-22,-31,-23,-3,-24,-25,-7,-32,-33,-37,-28,-10,-11,-37,-16,-19,-20,-37,-37,-37,-37,-35,-12,-29,-30,-26,-27"),ee=e.large_array_unpack("29,35,7,40,1,42,47,49,25,46,51,52,2,56,,8,57,54,55,,,26,,,,,50,,61,,,,,,,,,,,,,,,,,,,,,72,73,70,71"),$e=e.large_array_unpack("5,5,3,5,1,5,6,6,3,5,6,6,2,7,,2,6,5,5,,,2,,,,,3,,5,,,,,,,,,,,,,,,,,,,,,6,6,5,5"),ce=[i,4,12,0,i,-13,-17,-20,i],oe=[i,i,i,i,12,48,i,i,32],ue=e.large_array_unpack("0,0,racc_error,2,24,_reduce_1,3,24,_reduce_2,4,24,_reduce_3,2,25,_reduce_4,0,26,_reduce_5,2,26,_reduce_6,4,26,_reduce_7,3,26,_reduce_8,3,26,_reduce_9,4,26,_reduce_10,4,26,_reduce_11,5,26,_reduce_12,2,26,_reduce_13,3,26,_reduce_14,3,26,_reduce_15,4,26,_reduce_16,3,26,_reduce_17,3,26,_reduce_18,4,26,_reduce_19,4,26,_reduce_20,3,26,_reduce_21,2,27,_reduce_22,2,27,_reduce_23,3,27,_reduce_24,3,27,_reduce_25,3,30,_reduce_26,3,30,_reduce_27,1,30,_reduce_none,3,29,_reduce_29,3,29,_reduce_30,1,29,_reduce_none,2,28,_reduce_32,2,28,_reduce_33,1,28,_reduce_none,3,31,_reduce_35,1,31,_reduce_36"),ae=j(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"O",6,"G",7,"F",8,"S",9,"T",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16,"BRACKETL",17,"BRACKETR",18,"AT",19,"SHARP",20,"DOLLAR",21,"TILDE",22),Q(w[0],"Racc_arg",[b,a,re,O,ee,$e,oe,ce,23,ue,ae,74,37,!0]),m(r("Ractor","skip_raise")?"constant":i)&&r("Ractor").$make_shareable(r("Racc_arg")),Q(w[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","O","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","TILDE","$start","expr","rate","option","modifier","unary","mul","add","term"]),m(r("Ractor","skip_raise")?"constant":i)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),Q(w[0],"Racc_debug_parser",!1),f(d,"$_reduce_1",function(L,x,Z){try{F("eval_return");var U,ne,me,ie=i,fe=i;return ne=null==(U=q(L))[0]?i:U[0],fe=m(me=(ie=null==U[1]?i:U[1]).$modifier())?me:C(C(r("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ne,fe.$eval(this.round_type),ie)}catch(de){if(de===e.t_eval_return)return de.$v;throw de}}),f(d,"$_reduce_2",function(L,x,Z){try{F("eval_return");var U,ie,me,W=this,fe=i,de=i;return ie=null==(U=q(L))[1]?i:U[1],m((fe=null==U[2]?i:U[2]).$modifier_after_one_and_a_half())&&W.$raise(r("ParseError")),m(fe.$modifier_after_half())||fe["$modifier_after_half="](C(C(r("Arithmetic"),"Node"),"Number").$new(0)),de=m(me=fe.$modifier())?me:C(C(r("Arithmetic"),"Node"),"Number").$new(0),W.$parsed(ie,de.$eval(W.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),f(d,"$_reduce_3",function(L,x,Z){try{F("eval_return");var U,ie,me,W=this,fe=i,de=i;return ie=null==(U=q(L))[2]?i:U[2],m((fe=null==U[3]?i:U[3]).$modifier_after_half())&&W.$raise(r("ParseError")),m(fe.$modifier_after_one_and_a_half())||fe["$modifier_after_one_and_a_half="](C(C(r("Arithmetic"),"Node"),"Number").$new(0)),de=m(me=fe.$modifier())?me:C(C(r("Arithmetic"),"Node"),"Number").$new(0),W.$parsed(ie,de.$eval(W.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),f(d,"$_reduce_4",function(L,x,Z){return L["$[]"](1).$to_i()}),f(d,"$_reduce_5",function(L,x,Z){return r("RatingOptions").$new()}),f(d,"$_reduce_6",function(L,x,Z){var p,ne,W=i;return ne=null==(p=q(L))[1]?i:p[1],m((W=null==p[0]?i:p[0]).$modifier()["$nil?"]())||this.$raise(r("ParseError")),W["$modifier="](ne),W}),f(d,"$_reduce_7",function(L,x,Z){var p,ie,W=i;return ie=null==(p=q(L))[2]?i:p[2],m((W=null==p[0]?i:p[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),W["$critical="](ie),W}),f(d,"$_reduce_8",function(L,x,Z){var p,ie,W=i;return ie=null==(p=q(L))[2]?i:p[2],m((W=null==p[0]?i:p[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),W["$critical="](ie),W}),f(d,"$_reduce_9",function(L,x,Z){var p,W=i,ie=i;return ie=null==(p=q(L))[2]?i:p[2],m((W=null==p[0]?i:p[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),W["$first_to="](ie.$to_i()),W}),f(d,"$_reduce_10",function(L,x,Z){var p,W=i,ie=i;return ie=null==(p=q(L))[3]?i:p[3],m((W=null==p[0]?i:p[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),W["$first_modify="](ie.$to_i()),W}),f(d,"$_reduce_11",function(L,x,Z){var p,W=i,ie=i;return ie=null==(p=q(L))[3]?i:p[3],m((W=null==p[0]?i:p[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),W["$first_modify="](ie.$to_i()["$-@"]()),W}),f(d,"$_reduce_12",function(L,x,Z){var p,W=i,ie=i;return W=null==(p=q(L))[0]?i:p[0],ie=null==p[4]?i:p[4],Y(this.version,"v2_5")&&m(W["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),W["$first_modify_ssp="](ie.$to_i()),W}),f(d,"$_reduce_13",function(L,x,Z){var p,W=i;return p=q(L),m((W=null==p[0]?i:p[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),W["$modifier_after_half="](C(C(r("Arithmetic"),"Node"),"Number").$new(0)),W}),f(d,"$_reduce_14",function(L,x,Z){var p,ie,W=i;return ie=null==(p=q(L))[2]?i:p[2],m((W=null==p[0]?i:p[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),W["$modifier_after_half="](ie),W}),f(d,"$_reduce_15",function(L,x,Z){var p,W=i;return p=q(L),m((W=null==p[0]?i:p[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),W["$modifier_after_one_and_a_half="](C(C(r("Arithmetic"),"Node"),"Number").$new(0)),W}),f(d,"$_reduce_16",function(L,x,Z){var p,ie,W=i;return ie=null==(p=q(L))[3]?i:p[3],m((W=null==p[0]?i:p[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),W["$modifier_after_one_and_a_half="](ie),W}),f(d,"$_reduce_17",function(L,x,Z){var p,ie,W=i;return W=null==(p=q(L))[0]?i:p[0],ie=null==p[2]?i:p[2],m(["v2_5","v2_0"]["$include?"](this.version))&&m(W.$rateup()["$nil?"]())||this.$raise(r("ParseError")),W["$rateup="](ie),W}),f(d,"$_reduce_18",function(L,x,Z){var p,W=i;return W=null==(p=q(L))[0]?i:p[0],m(["v2_5","v2_0"]["$include?"](this.version))&&m(W["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),W["$greatest_fortune="](!0),W}),f(d,"$_reduce_19",function(L,x,Z){var p,W=i,ie=i;return W=null==(p=q(L))[0]?i:p[0],ie=null==p[3]?i:p[3],m(["v2_5","v2_0"]["$include?"](this.version))&&m(W["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),W["$semi_fixed_val="](ie.$to_i()),W}),f(d,"$_reduce_20",function(L,x,Z){var p,W=i,ie=i;return W=null==(p=q(L))[0]?i:p[0],ie=null==p[3]?i:p[3],m(["v2_5","v2_0"]["$include?"](this.version))&&m(W["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),W["$tmp_fixed_val="](ie.$to_i()),W}),f(d,"$_reduce_21",function(L,x,Z){var p,ie,W=i;return W=null==(p=q(L))[0]?i:p[0],ie=null==p[2]?i:p[2],Y(this.version,"v2_5")&&m(W.$kept_modify()["$nil?"]())||this.$raise(r("ParseError")),W["$kept_modify="](ie),W}),f(d,"$_reduce_22",function(L,x,Z){return L["$[]"](1)}),f(d,"$_reduce_23",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"Negative").$new(L["$[]"](1))}),f(d,"$_reduce_24",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"BinaryOp").$new(L["$[]"](0),"+",L["$[]"](2))}),f(d,"$_reduce_25",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"BinaryOp").$new(L["$[]"](0),"-",L["$[]"](2))}),f(d,"$_reduce_26",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"BinaryOp").$new(L["$[]"](0),"+",L["$[]"](2))}),f(d,"$_reduce_27",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"BinaryOp").$new(L["$[]"](0),"-",L["$[]"](2))}),f(d,"$_reduce_29",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"BinaryOp").$new(L["$[]"](0),"*",L["$[]"](2))}),f(d,"$_reduce_30",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(L["$[]"](0),L["$[]"](2))}),f(d,"$_reduce_32",function(L,x,Z){return L["$[]"](1)}),f(d,"$_reduce_33",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"Negative").$new(L["$[]"](1))}),f(d,"$_reduce_35",function(L,x,Z){return L["$[]"](1)}),f(d,"$_reduce_36",function(L,x,Z){return C(C(r("Arithmetic"),"Node"),"Number").$new(L["$[]"](0))}),f(d,"$_reduce_none",function(L,x,Z){return L["$[]"](0)})},Opal.modules["bcdice/game_system/SwordWorld"]=function(e){var M,T,y,d,v,t,w,g,s,N,V=e.module,G=e.klass,c=e.const_set,I=e.send2,B=e.find_super,f=e.def,K=e.truthy,m=e.rb_ge,E=e.rb_le,F=e.eqeq,j=e.neqeq,Q=e.rb_minus,q=e.rb_gt,Y=e.hash2,H=e.send,z=e.to_ary,i=e.rb_plus,C=e.rb_lt,l=e.rb_times,k=e.thrower,_=e.rb_divide,P=e.top,n=[],$=e.nil;return P.$require("bcdice/base"),P.$require("bcdice/game_system/sword_world/rating_parser"),M=n,T=N=[V(n[0],"BCDice")].concat(M),g=[V(N[0],"GameSystem")].concat(T),s=e.$r(g),y=g,v=[d=G(g[0],s("Base"),"SwordWorld")].concat(y),t=e.$r(v),(w=d.$$prototype).rating_table=w.randomizer=$,c(v[0],"ID","SwordWorld"),c(v[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),c(v[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),c(v[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),d.$register_prefix("H?K"),f(d,"$initialize",function r(b){var O=this;return r.$$p=null,I(O,B(O,"initialize",r,!1,!0),"initialize",[b],null),O.rating_table=0}),f(d,"$result_2d6",function(b,a,O,re,ee){return K(m(a,12))?t("Result").$critical(this.$translate("SwordWorld.critical")):K(E(a,2))?t("Result").$fumble(this.$translate("SwordWorld.fumble")):j(re,">=")||F(ee,"?")?$:K(m(b,ee))?t("Result").$success(this.$translate("success")):t("Result").$failure(this.$translate("failure"))}),f(d,"$eval_game_system_specific_command",function(b){return this.$rating(b)}),d.$private(),f(d,"$rating_parser",function(){return t("RatingParser").$new()}),f(d,"$rating",function(b){var a,O,re=this,ee=$,$e=$,ce=$,oe=$,ue=$,_e=$,le=$,ae=$,se=$,te=$,S=$,X=$,L=$,x=$,Z=$,U=$,J=$;return re.$debug("rating string",b),ee=re.$rating_parser().$parse(b),K(ee)?($e=re.$getSW2_0_RatingTable(),ce=Q($e.$length(),1),re.$debug("keyMax",ce),K(q(ee.$rate(),ce))?t("Result").$new(re.$translate("SwordWorld.keynumber_exceeds",Y(["keyMax"],{keyMax:ce}))):K(ee["$infinite_roll?"]())?t("Result").$new(re.$translate("SwordWorld.infinite_critical",Y(["min_critical"],{min_critical:ee.$min_critical()}))):(oe=re.$getNewRates($e),ue=ee+" \uff1e ",_e=[],le=[],ae=[],se=0,te=0,S=0,X=0,L=ee.$first_to(),x=ee.$first_modify(),Z=ee.$first_modify_ssp(),function(){try{var W=k("break");return H(re,"loop",[],function ne(){var ie,fe,he,ge,me=null==ne.$$s?this:ne.$$s,de=$,ve=$;if(fe=me.$rollDice(ee,X),ve=null==(ie=z(fe))[1]?$:ie[1],se=de=null==ie[0]?$:ie[0],j(L,0)?(se=de=L,L=0):j(x,0)?(se=i(se,x),x=0):j(Z,0)&&(K(E(de,10))&&(se=i(se,Z)),Z=0),K(E(de,2))&&(_e["$<<"](de.$to_s()),le["$<<"](ve.$to_s()),ae["$<<"]("**"),X=i(X,1),W.$throw()),j(ee.$kept_modify(),0)&&j(se,2)&&(se=i(se,ee.$kept_modify())),K(C(se,2))&&(se=2),K(q(se,12))&&(se=12),he=i(ee.$rate(),l(X,ee.$rateup())).$clamp(0,ce),me.$debug("currentKey",he),ge=oe["$[]"](se)["$[]"](he),me.$debug("rateValue",ge),S=i(S,ge),te=i(te,se),_e["$<<"](se.$to_s()),le["$<<"](ve.$to_s()),ae["$<<"](K(q(se,2))?ge:"**"),X=i(X,1),K(m(se,ee.$critical())))return $;W.$throw()},{$$s:re})}catch(ne){if(ne===W)return ne.$v;throw ne}}(),O=re.$getResultText(S,ee,le,_e,ae,te,X),a=z(O),U=null==a[1]?$:a[1],J=null==a[2]?$:a[2],ue=i(ue,null==a[0]?$:a[0]),H(t("Result").$new(),"tap",[],function(ne){var ie;return null==ne&&(ne=$),ne["$text="](ue),ne["$critical="](U),H(ne,"fumble=",ie=[J]),ie[ie.length-1]}))):(re.$debug("not matched"),"1")}),f(d,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]}),f(d,"$getNewRates",function(b){var a,O,ee=$,$e=$,ce=$,oe=$,ue=$,_e=$,le=$,ae=$,se=$,te=$,S=$;return ee=[],$e=[],ce=[],oe=[],ue=[],_e=[],le=[],ae=[],se=[],te=[],S=[],H(b,"each",[],function(x){var Z=$;return null==x&&(x=$),Z=x.$split(/,/),S.$push(0),ee.$push(Z["$[]"](1).$to_i()),$e.$push(Z["$[]"](2).$to_i()),ce.$push(Z["$[]"](3).$to_i()),oe.$push(Z["$[]"](4).$to_i()),ue.$push(Z["$[]"](5).$to_i()),_e.$push(Z["$[]"](6).$to_i()),le.$push(Z["$[]"](7).$to_i()),ae.$push(Z["$[]"](8).$to_i()),se.$push(Z["$[]"](9).$to_i()),te.$push(Z["$[]"](10).$to_i())}),F(this.rating_table,1)&&te["$[]="](31,(a=[32,(O=[33,10],H(te,"[]=",O),O[O.length-1])],H(te,"[]=",a),a[a.length-1])),[S,S,S,ee,$e,ce,oe,ue,_e,le,ae,se,te]}),f(d,"$rollDice",function(b,a){var re=$;return[(re=this.randomizer.$roll_barabara(2,6)).$sum(),re.$join(",")]}),f(d,"$getResultText",function(b,a,O,re,ee,$e,ce){var ue=$,_e=$,le=$,ae=$,se=$;return(ue=[]).$push("2D:["+O.$join(" ")+"]="+re.$join(",")),K(E($e,2))?(ue.$push(ee.$join(",")),ue.$push(this.$translate("SwordWorld.fumble")),[ue.$join(" \uff1e "),!1,!0]):(K(q(ee.$size(),1))||j(a.$modifier(),0)?(_e=i(ee.$join(","),t("Format").$modifier(a.$modifier())),K(a.$half())?(_e="("+_e+")/2",j(a.$modifier_after_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_half())))):K(a.$one_and_a_half())&&(_e="("+_e+")*1.5",j(a.$modifier_after_one_and_a_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_one_and_a_half())))),ue.$push(_e)):K(a.$half())?(_e=ee.$first()+"/2",j(a.$modifier_after_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_half()))),ue.$push(_e)):K(a.$one_and_a_half())&&(_e=ee.$first()+"*1.5",j(a.$modifier_after_one_and_a_half(),0)&&(_e=i(_e,t("Format").$modifier(a.$modifier_after_one_and_a_half()))),ue.$push(_e)),K(q(ce,1))&&(le=this.$translate("SwordWorld.round_text",Y(["reroll_count"],{reroll_count:Q(ce,1)})),ue.$push(le)),ae=i(b,a.$modifier()),K(a.$half())?(ae=_(ae,2).$ceil(),j(a.$modifier_after_half(),0)&&(ae=i(ae,a.$modifier_after_half()))):K(a.$one_and_a_half())&&(ae=l(ae,1.5).$ceil(),j(a.$modifier_after_one_and_a_half(),0)&&(ae=i(ae,a.$modifier_after_one_and_a_half()))),se=ae.$to_s(),ue.$push(se),[ue.$join(" \uff1e "),q(ce,1),!1])})},Opal.modules["bcdice/game_system/sword_world/transcendent_test"]=function(e){var Y,C,$,A,T,h,g,s,M,k,_,z,V=e.module,G=e.klass,c=e.def,I=e.truthy,B=e.rb_lt,f=e.hash2,K=e.rb_ge,m=e.rb_plus,E=e.send,F=e.top,j=[],Q=e.nil;return F.$require("bcdice/result"),F.$require("bcdice/translate"),Y=j,C=z=[V(j[0],"BCDice")].concat(Y),k=[V(z[0],"GameSystem")].concat(C),_=e.$r(k),$=k,A=M=[G(k[0],_("SwordWorld"),"SwordWorld2_0")].concat($),h=[T=G(M[0],null,"TranscendentTest")].concat(A),g=e.$r(h),(s=T.$$prototype).modifier=s.critical_value=s.expression=s.modifier_str=s.target=s.cmp_op=Q,T.$include(g("Translate")),c(T,"$initialize",function(u,y,d,v,t){var w=this;return w.critical_value=u,w.modifier=y,w.cmp_op=d,w.target=v,w.locale=t,w.modifier_str=g("Format").$modifier(w.modifier),w.expression=w.$node_expression()}),c(T,"$execute",function(u){var t,w,r,y=this,d=Q,v=Q,b=Q,a=Q,O=Q,re=Q;if(I(B(y.critical_value,3)))return y.$translate("SwordWorld2_0.transcendent_critical_too_small",f(["expression"],{expression:y.expression}));if(v=[d=u.$roll_barabara(2,6)],t=d["$=="]([1,1]),w=d["$=="]([6,6]),!I(t))for(;I(K(y.$sum_of_dice(v.$last()),y.critical_value));)v.$push(u.$roll_barabara(2,6));return r=y.$sum_of_dice(v),b=m(r,y.modifier),a=y.$result_status(b,v.$length(),t,w),O=f(["success","failure","super_success","critical","fumble"],{success:y.$translate("success"),failure:y.$translate("failure"),super_success:y.$translate("SwordWorld2_0.super_success"),critical:y.$translate("SwordWorld.critical"),fumble:y.$translate("SwordWorld.fumble")}).$freeze()["$[]"](a),re=["("+y.expression+")",""+y.$dice_str(v,r)+y.modifier_str,b,O].$compact(),E(g("Result").$new(),"tap",[],function($e){var ce;return null==$e&&($e=Q),$e["$text="](re.$join(" \uff1e ")),$e["$fumble="](a["$=="]("fumble")),$e["$critical="](a["$=="]("critical")),$e["$success="](["success","super_success","critical"]["$include?"](a)),ce=[["failure","fumble"]["$include?"](a)],E($e,"failure=",ce),ce[ce.length-1]})}),T.$private(),c(T,"$node_expression",function(){var y,u=this;return y="2D6@"+u.critical_value+u.modifier_str,I(u.target)?""+y+u.cmp_op+u.target:y}),c(T,"$sum_of_dice",function(u){return u.$flatten().$sum()}),c(T,"$dice_str",function(u,y){return""+y+E(u,"map",[],function(t){return null==t&&(t=Q),"["+t.$join(",")+"]"}).$join()}),c(T,"$result_status",function(u,y,d,v){var t=this;return I(t.target)?I(d)?"fumble":I(v)?"critical":I(u.$send(t.cmp_op,t.target))?I(K(y,2))&&I(K(u,41))?"super_success":"success":"failure":"no_target"})},Opal.modules["bcdice/game_system/SwordWorld2_0"]=function(e){var _,R,h,g,s,o,u,D,N,n,V=e.module,G=e.klass,c=e.const_set,I=e.send2,B=e.find_super,f=e.def,K=e.eqeqeq,m=e.truthy,E=e.hash2,F=e.rb_gt,j=e.rb_plus,Q=e.eqeq,q=e.rb_times,Y=e.send,H=e.neqeq,z=e.top,i=[],C=e.nil,l=e.$$$;return z.$require("bcdice/arithmetic_evaluator"),z.$require("bcdice/game_system/SwordWorld"),z.$require("bcdice/game_system/sword_world/transcendent_test"),_=i,R=n=[V(i[0],"BCDice")].concat(_),D=[V(n[0],"GameSystem")].concat(R),N=e.$r(D),h=D,s=[g=G(D[0],N("SwordWorld"),"SwordWorld2_0")].concat(h),o=e.$r(s),(u=g.$$prototype).locale=u.randomizer=C,c(s[0],"ID","SwordWorld2.0"),c(s[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"),c(s[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0"),c(s[0],"HELP_MESSAGE",'\u81ea\u52d5\u7684\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u6557\u3001\u81ea\u52d5\u7684\u5931\u6557\u306e\u81ea\u52d5\u5224\u5b9a\u3092\u884c\u3044\u307e\u3059\u3002\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx)\n\u3000"K\u30ad\u30fc\u30ca\u30f3\u30d0\u30fc+\u30dc\u30fc\u30ca\u30b9"\u306e\u5f62\u3067\u8a18\u5165\u3057\u307e\u3059\u3002\n\u3000\u30dc\u30fc\u30ca\u30b9\u306e\u90e8\u5206\u306b\u300cK20+K30\u300d\u306e\u3088\u3046\u306b\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u3092\u53d6\u308b\u3053\u3068\u306f\u51fa\u6765\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001\u30dc\u30fc\u30ca\u30b9\u306f\u8907\u6570\u53d6\u308b\u3053\u3068\u304c\u51fa\u6765\u307e\u3059\u3002\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3082\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3068\u540c\u69d8\u306b\u3001\u4ed6\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\u306b\u96a0\u308c\u3066\u30ed\u30fc\u30eb\u3059\u308b\u3053\u3068\u3082\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n\u30fb\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u8a2d\u5b9a\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306f"[\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024]"\u3067\u6307\u5b9a\u3057\u307e\u3059\u3002\n\u3000\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u306f\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u502410\u3068\u3057\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u51e6\u7406\u304c\u5fc5\u8981\u306a\u3044\u3068\u304d\u306f13\u306a\u3069\u3068\u3057\u3066\u304f\u3060\u3055\u3044\u3002(\u9632\u5fa1\u6642\u306a\u3069\u306e\u5bfe\u5fdc)\n\u3000\u307e\u305f\u30bf\u30a4\u30d7\u306e\u8efd\u6e1b\u5316\u306e\u305f\u3081\u306b\u672b\u5c3e\u306b\u300c@\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u300d\u3067\u3082\u51e6\u7406\u3059\u308b\u3088\u3046\u306b\u3057\u307e\u3057\u305f\u3002\n\u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n\u30fb\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u534a\u6e1b (HKx, KxH+N)\n\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u306e\u5148\u982d\u307e\u305f\u306f\u672b\u5c3e\u306b"H"\u3092\u3064\u3051\u308b\u3068\u3001\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3092\u632f\u3063\u3066\u6700\u7d42\u7d50\u679c\u3092\u534a\u6e1b\u3055\u305b\u307e\u3059\u3002\n\u3000\u672b\u5c3e\u306b\u3064\u3051\u305f\u5834\u5408\u3001\u76f4\u5f8c\u306b\u4fee\u6b63\u3092\u3092\u3064\u3051\u308b\u3053\u3068\u3067\u3001\u534a\u6e1b\u5f8c\u306e\u52a0\u6e1b\u7b97\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\u3000\u3053\u306e\u969b\u3001\u8907\u6570\u306e\u9805\u306b\u3088\u308b\u4fee\u6b63\u306b\u306f\u30ab\u30c3\u30b3\u3067\u56f2\u3046\u3053\u3068\u304c\u5fc5\u8981\u3067\u3059\uff08\u30ab\u30c3\u30b3\u304c\u306a\u3044\u3068\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3059\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3092\u6307\u5b9a\u3057\u306a\u3044\u5834\u5408\u3001\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u306a\u3057\u3068\u6271\u308f\u308c\u307e\u3059\u3002\n\u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H(1+1)\n\n\u30fb\u30c0\u30a4\u30b9\u76ee\u306e\u4fee\u6b63\uff08\u904b\u547d\u5909\u8ee2\u3084\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u30ec\u30a4\u7528\uff09\n\u3000\u672b\u5c3e\u306b\u300c$\u4fee\u6b63\u5024\u300d\u3067\u30c0\u30a4\u30b9\u76ee\u306b\u4fee\u6b63\u304c\u304b\u304b\u308a\u307e\u3059\u3002\n\u3000$\uff0b\uff11\u3068\u4fee\u6b63\u8868\u8a18\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u306b\uff0b\u4fee\u6b63\u3001\uff04\uff19\u306e\u3088\u3046\u306b\u56fa\u5b9a\u5024\u306a\u3089\u30c0\u30a4\u30b9\u76ee\u3092\u305d\u306e\u51fa\u76ee\u306b\u5dee\u3057\u66ff\u3048\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u3057\u305f\u5834\u5408\u3067\u3082\u56fa\u5b9a\u5024\u3084\u4fee\u6b63\u5024\u306e\u9069\u7528\u306f\u6700\u521d\u306e\u4e00\u56de\u3060\u3051\u3067\u3059\u3002\n\u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n\u30fb\u9996\u5207\u308a\u5200\u7528\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u4e0a\u6607 r10\n\u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n\u30fb\u30b0\u30ec\u30a4\u30c6\u30b9\u30c8\u30d5\u30a9\u30fc\u30c1\u30e5\u30f3\u306f\u672b\u5c3e\u306b gf\n\u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r10gf\n\n\u30fb\u5a01\u529b\u8868\u30921d+sf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u3082\u7d99\u7d9a sf4\n\u3000\u4f8b\uff09k10sf4\u3000k0+5SF4@13\u3000k70+26sf3@9\n\n\u30fb\u5a01\u529b\u8868\u30921d+tf\u3067\u53c2\u7167 \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5f8c\u306f2d\u3067\u53c2\u7167 tf3\n\u3000\u4f8b\uff09k10tf3\u3000k0+5TF4@13\u3000k70+26tf3@9\n\n\u30fb\u8d85\u8d8a\u5224\u5b9a\u7528\u306b2d6\u30ed\u30fc\u30eb\u306b 2D6@10 \u66f8\u5f0f\u3067\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u4ed8\u4e0e\u304c\u53ef\u80fd\u306b\u3002\n\u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n\u30fb\u6210\u9577\u3000(Gr)\n\u3000\u672b\u5c3e\u306b\u6570\u5b57\u3092\u4ed8\u52a0\u3059\u308b\u3053\u3068\u3067\u3001\u8907\u6570\u56de\u306e\u6210\u9577\u3092\u307e\u3068\u3081\u3066\u884c\u3048\u307e\u3059\u3002\n\u3000\u4f8b\uff09Gr3\n\n\u30fb\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3000(FT)\n\u3000\u9632\u5fa1\u30d5\u30a1\u30f3\u30d6\u30eb\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u7d61\u307f\u52b9\u679c\u8868\u3000(TT)\n\u3000\u7d61\u307f\u52b9\u679c\u8868\u3092\u51fa\u3059\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n'),g.$register_prefix("H?K","Gr","2D6?@\\d+","FT","TT"),f(g,"$initialize",function y(d){var t=this;return y.$$p=null,I(t,B(t,"initialize",y,!1,!0),"initialize",[d],null),t.rating_table=2}),f(g,"$eval_game_system_specific_command",function y(d){var w,t=this,b=C;return y.$$p=null,K(/^Gr(\d+)?/i,w=d)?m(d["$=~"](/^Gr(\d+)/i))?t.$growth(o("Regexp").$last_match(1).$to_i()):t.$growth():K(/^2D6?@\d+/i,w)?(b=l(o("Command"),"Parser").$new(/2D6?/i,E(["round_type"],{round_type:l(l(o("BCDice"),"RoundType"),"CEIL")})).$enable_critical().$restrict_cmp_op_to(C,">=",">").$parse(d),m(b)?o("TranscendentTest").$new(b.$critical(),b.$modify_number(),b.$cmp_op(),b.$target_number(),t.locale).$execute(t.randomizer):C):K("FT",w)?t.$get_fumble_table():K("TT",w)?t.$get_tangle_table():I(t,B(t,"eval_game_system_specific_command",y,!1,!0),"eval_game_system_specific_command",[d],null)}),f(g,"$rating_parser",function(){return o("RatingParser").$new(E(["version"],{version:"v2_0"}))}),f(g,"$rollDice",function y(d,v){var w=this,r=C;return y.$$p=null,m(F(d.$semi_fixed_val(),0))?(r=w.randomizer.$roll_once(6),[j(r,d.$semi_fixed_val()),r+","+d.$semi_fixed_val()]):Q(v,0)&&m(F(d.$tmp_fixed_val(),0))?(r=w.randomizer.$roll_once(6),[j(r,d.$tmp_fixed_val()),r+","+d.$tmp_fixed_val()]):m(d.$greatest_fortune())?(r=w.randomizer.$roll_once(6),[q(r,2),r+","+r]):I(w,B(w,"rollDice",y,!1,!0),"rollDice",[d,v],null)}),f(g,"$growth",function(d){return null==d&&(d=1),Y(e.Range.$new(1,d,!1),"map",[],function t(){return(null==t.$$s?this:t.$$s).$growth_step()},{$$s:this}).$join(" | ")},-1),f(g,"$growth_step",function(){var d=this,v=C,t=C,w=C;return t=(v=l(o("DiceTable"),"Table").$from_i18n("SwordWorld2_0.GrowthTable",d.locale)).$roll(d.randomizer),w=v.$roll(d.randomizer),H(t.$value(),w.$value())?"["+t.$value()+","+w.$value()+"]->("+t.$body()+" or "+w.$body()+")":"["+t.$value()+","+w.$value()+"]->("+t.$body()+")"}),f(g,"$get_fumble_table",function(){return l(o("DiceTable"),"Table").$from_i18n("SwordWorld2_0.FumbleTable",this.locale).$roll(this.randomizer)}),f(g,"$get_tangle_table",function(){return l(o("DiceTable"),"Table").$from_i18n("SwordWorld2_0.TangleTable",this.locale).$roll(this.randomizer)})},Opal.queue(function(e){var j,H,_,P,n,i,C,q,V=e.module,G=e.klass,c=e.const_set,I=e.send2,B=e.find_super,f=e.def,m=[];return e.top.$require("bcdice/game_system/SwordWorld2_0"),j=m,H=q=[V(m[0],"BCDice")].concat(j),i=[V(q[0],"GameSystem")].concat(H),C=e.$r(i),_=i,c((n=[P=G(i[0],C("SwordWorld2_0"),"SwordWorld2_0_SimplifiedChinese")].concat(_))[0],"ID","SwordWorld2.0:SimplifiedChinese"),c(n[0],"NAME","\u5251\u4e16\u754c2.0"),c(n[0],"SORT_KEY","\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.0"),c(n[0],"HELP_MESSAGE","\u81ea\u52a8\u6210\u529f\u3001\u6210\u529f\u3001\u5931\u8d25\u3001\u81ea\u52a8\u5931\u8d25\u4f1a\u81ea\u52a8\u5224\u5b9a\u3002\n\n  \u30fb\u5a01\u529b\u8868\u3000(Kx)\n  \u3000\u6307\u4ee4\u4e3a\u201cK\u5a01\u529b\u503c+\u52a0\u503c\u201d\u7684\u683c\u5f0f\u3002\n  \u3000\u52a0\u503c\u7684\u90e8\u5206\u4e0d\u80fd\u662f\u50cf\u201cK20+K30\u201d\u8fd9\u6837\u7684\u5a01\u529b\u7684\u5199\u6cd5\u3002\n  \u3000\u53e6\u5916\uff0c\u52a0\u503c\u53ef\u4ee5\u6709\u591a\u4e2a\u3002\n  \u3000\u5a01\u529b\u8868\u548c\u9ab0\u70b9\u4e00\u6837\uff0c\u53ef\u4ee5\u5bf9\u5176\u4ed6\u73a9\u5bb6\u9690\u85cf\u3002\n  \u3000\u4f8b\uff09K20\u3000\u3000\u3000K10+5\u3000\u3000\u3000k30\u3000\u3000\u3000k10+10\u3000\u3000\u3000Sk10-1\u3000\u3000\u3000k10+5+2\n\n  \u30fb\u66b4\u51fb\u503c\u7684\u8bbe\u5b9a\n  \u3000\u66b4\u51fb\u503c\u901a\u8fc7\u201c[\u66b4\u51fb\u503c]\u201d\u6307\u5b9a\u3002\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u65f6\u9ed8\u8ba4\u4e3a10\u3002\n  \u3000\u5982\u679c\u4e0d\u9700\u8981\u53d1\u751f\u66b4\u51fb\uff0c\u8bf7\u8bbe\u5b9a\u4e3a13\u3002\uff08\u4f8b\u5982\u9632\u5fa1\u65f6\uff09\n  \u3000\u53e6\u5916\u4e5f\u53ef\u5199\u6210\u7ed3\u5c3e\u7684\u201c@\u66b4\u51fb\u503c\u201d\u7684\u5f62\u5f0f\u3002\n  \u3000\u4f8b\uff09K20[10]\u3000\u3000\u3000K10+5[9]\u3000\u3000\u3000k30[10]\u3000\u3000\u3000k10[9]+10\u3000\u3000\u3000k10-5@9\n\n  \u30fb\u5a01\u529b\u8868\u7684\u51cf\u534a (HKx, KxH+N)\n  \u3000\u5728\u5a01\u529b\u8868\u5f00\u5934\u6216\u672b\u5c3e\u52a0\u4e0a\u201cH\u201d\uff0c\u9ab0\u5a01\u529b\u8868\u7684\u6700\u7ec8\u7ed3\u679c\u5c31\u4f1a\u51cf\u534a\u3002\n  \u3000H\u5199\u5728\u5a01\u529b\u8868\u672b\u5c3e\u7684\u60c5\u51b5\u4e0b\u53ef\u4ee5\u5728\u540e\u9762\u76f4\u63a5\u8ddf\u7740\u4fee\u6b63\uff0c\u4f1a\u5728\u51cf\u534a\u540e\u8fdb\u884c\u52a0\u51cf\u8fd0\u7b97\u3002\n  \u3000\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u591a\u4e2a\u4fee\u6b63\u9700\u8981\u7528\u62ec\u53f7\u62ec\u8d77\u6765\uff08\u5426\u5219\u4f1a\u89e3\u6790\u5931\u8d25\uff09\n  \u3000\u6ca1\u6709\u6307\u5b9a\u66b4\u51fb\u503c\u7684\u60c5\u51b5\u4e0b\uff0c\u5219\u89c6\u4e3a\u6ca1\u6709\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff09HK20\u3000\u3000K20h\u3000\u3000HK10-5@9\u3000\u3000K10-5@9H\u3000\u3000K20gfH\u3000\u3000K20+8H+2\u3000\u3000K20+8H+(1+1)\n\n  \u30fb\u9ab0\u5b50\u51fa\u76ee\u4fee\u6b63\uff08\u547d\u8fd0\u53d8\u8f6c\u6216\u91cd\u51fb\u5149\u8f89\u7528\uff09\n  \u3000\u5728\u6307\u4ee4\u672b\u5c3e\u6dfb\u52a0\u201c$\u4fee\u6b63\u503c\u201d\u6765\u6539\u53d8\u9ab0\u5b50\u51fa\u76ee\u3002\n  \u3000\u53ef\u4ee5\u4f7f\u7528$+1\u7684\u683c\u5f0f\u5728\u9ab0\u5b50\u51fa\u76ee\u4e0a+\u4fee\u6b63\uff0c\u6216\u4f7f\u7528$9\u7684\u683c\u5f0f\u628a\u9ab0\u5b50\u51fa\u76ee\u66ff\u6362\u4e3a\u56fa\u5b9a\u503c\u3002\n  \u3000\u66b4\u51fb\u65f6\u53ea\u6709\u7b2c\u4e00\u6b21\u51fa\u76ee\u5e94\u7528\u8fd9\u4e2a\u4fee\u6b63\u3002\n  \u3000\u4f8b\uff09K20$+1\u3000\u3000\u3000K10+5$9\u3000\u3000\u3000k10-5@9$+2\u3000\u3000\u3000k10[9]+10$9\n\n  \u30fb\u5a01\u529b\u4e0a\u5347\uff08\u65a9\u9996\u5200\u7528\uff09 r10\n  \u3000r\u540e\u8ddf\u4e0a\u5347\u503c\uff0c\u66b4\u51fb\u540e\u5a01\u529b\u4e0a\u5347r\u540e\u6240\u586b\u5199\u7684\u4e0a\u5347\u503c\u70b9\n  \u3000\u4f8b\uff09K20r10\u3000K30+24@8R10\u3000K40+24@8$12r10\n\n  \u30fb\u6781\u9650\u547d\u8fd0\u5728\u672b\u5c3e\u52a0\u4e0a gf\n  \u3000\u4f8b\uff09K20gf\u3000K30+24@8GF\u3000K40+24@8$12r5gf\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u4ecd\u7ee7\u7eed sf4\n  \u3000\u4f8b\uff09k10sf4\u3000k0+5sf4@13\u3000k70+26sf3@9\n\n  \u30fb\u5a01\u529b\u8868\u4f7f\u75281d+\u56fa\u5b9a\u503c\u5bf9\u5e94 \u66b4\u51fb\u540e\u53d8\u56de\u4f7f\u75282d\u5bf9\u5e94 tf3\n  \u3000\u4f8b\uff09k10tf3\u3000k0+5tf4@13\u3000k70+26tf3@9\n\n  \u30fb\u8d85\u8d8a\u5224\u5b9a\u75282d6\u53ef\u5199\u6210 2d6@10 \u7684\u683c\u5f0f\u52a0\u4e0a\u66b4\u51fb\u503c\u3002\n  \u3000\u4f8b\uff092D6@10\u30002D6@10+11>=30\n\n  \u30fb\u6210\u957f\u3000(Gr)\n  \u3000\u5728Gr\u540e\u9762\u52a0\u4e0a\u6570\u5b57\u53ef\u4ee5\u8fdb\u884c\u591a\u6b21\u6210\u957f\u3002\n  \u3000\u4f8b\uff09Gr3\n\n  \u30fb\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3000(FT)\n  \u3000\u62bd\u53d6\u9632\u5fa1\u5927\u5931\u8d25\u8868\u3002\n\n  \u30fb\u7f20\u7ed5\u6548\u679c\u8868\u3000(TT)\n  \u3000\u62bd\u53d6\u7f20\u7ed5\u6548\u679c\u8868\u3002\n"),P.$register_prefix_from_super_class(),f(P,"$initialize",function $(R){var D=this;return $.$$p=null,I(D,B(D,"initialize",$,!1,!0),"initialize",[R],null),D.locale="zh_hans"})})}}]);