(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[7646],{37646:function(t,e,r){var n,i,o,a,$,m,_,c,u,s,l,p,d,f;r(93683),Opal.modules["bcdice/normalize"]=function(t){var e,r,n,i,o,a,$=[],m=t.nil,_=t.module;return o=$,e=a=[_($[0],"BCDice")].concat(o),[i=_(a[0],"Normalize")].concat(e),i.$module_function(),t.def(i,"$comparison_operator",r=function(t){var e;return/<=|=</["$==="](e=t)?"<=":/>=|=>/["$==="](e)?">=":/<>|!=|=!/["$==="](e)?"!=":/</["$==="](e)?"<":/>/["$==="](e)?">":/=/["$==="](e)?"==":m},r.$$arity=1),void t.def(i,"$target_number",n=function(t){return t["$=="]("?")?t:t.$to_i()},n.$$arity=1)},Opal.modules["bcdice/format"]=function(t){var e,r,n,i,o,a,$,m=[],_=t.nil,c=t.$$,u=t.module,s=t.truthy;return e=m,r=$=[u(m[0],"BCDice")].concat(e),o=u($[0],"Format"),a=[o].concat(r),o.$module_function(),t.def(o,"$comparison_operator",n=function(t){var e;return"=="["$==="](e=t)?"=":"!="["$==="](e)?"<>":c(a,"Symbol")["$==="](e)?t.$to_s():_},n.$$arity=1),void t.def(o,"$modifier",i=function(t){return s(t["$nil?"]())?_:t["$=="](0)?"":s("number"==typeof(e=t)?e>0:e["$>"](0))?"+"+t:t.$to_s();var e},i.$$arity=1)},Opal.modules["bcdice/game_system/NightWizard"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var n,i,o,a,$,m,_,c,u,s,l,p,d,f,b,y,v,h,g,z,x,S,N,w,E,M=t.top,F=[],W=t.nil,R=t.$$,P=t.module,A=t.klass,j=t.send2,C=t.truthy,k=t.send;return M.$require("bcdice/normalize"),M.$require("bcdice/format"),n=F,i=E=[P(F[0],"BCDice")].concat(n),o=(w=[P(E[0],"GameSystem")].concat(i))[0],a=R(w,"Base"),$=w,S=A(o,a,"NightWizard"),N=[S].concat($),S.$$prototype.nw_command=S.$$prototype.randomizer=S.$$prototype.total=S.$$prototype.interim_expr=S.$$prototype.status=S.$$prototype.fumble_numbers=S.$$prototype.critical_numbers=W,t.const_set(N[0],"ID","NightWizard"),t.const_set(N[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),t.const_set(N[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),t.const_set(N[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),S.$register_prefix("([-+]?\\d+)?NW","2R6"),t.def(S,"$initialize",m=function(e){var r=this;return m.$$p&&(m.$$p=null),j(r,t.find_super_dispatcher(r,"initialize",m,!1,!0),"initialize",[e],null),r.nw_command="NW"},m.$$arity=1),t.def(S,"$eval_game_system_specific_command",_=function(e){var r,n,i,o=this,a=W,$=W,m=W,_=W,c=W;return a=C(i=o.$parse_nw(e))?i:o.$parse_2r6(e),C(a)?(n=o.$roll_nw(a),$=null==(r=t.to_ary(n))[0]?W:r[0],m=null==r[1]?W:r[1],_=null==r[2]?W:r[2],c=C(a.$cmp_op())?C($.$send(a.$cmp_op(),a.$target_number()))?"\u6210\u529f":"\u5931\u6557":W,["("+a+")",m,_,$.$to_s(),c].$compact().$join(" \uff1e ")):W},_.$$arity=1),S.$private(),function(t,e,r){var n=A(t,null,"Parsed");[n].concat(r),n.$attr_accessor("critical_numbers"),n.$attr_accessor("fumble_numbers"),n.$attr_accessor("prana"),n.$attr_accessor("active_modify_number"),n.$attr_accessor("cmp_op"),n.$attr_accessor("target_number")}(N[0],0,N),f=N[0],b=R(N,"Parsed"),y=N,z=A(f,b,"ParsedNW"),x=[z].concat(y),z.$$prototype.base=z.$$prototype.modify_number=z.$$prototype.active_modify_number=z.$$prototype.prana=z.$$prototype.command=z.$$prototype.critical_numbers=z.$$prototype.fumble_numbers=z.$$prototype.cmp_op=z.$$prototype.target_number=W,z.$attr_accessor("base"),z.$attr_accessor("modify_number"),t.def(z,"$initialize",v=function(e){var r=this;return v.$$p&&(v.$$p=null),j(r,t.find_super_dispatcher(r,"initialize",v,!1,!0),"initialize",[],null),r.command=e},v.$$arity=1),t.def(z,"$passive_modify_number",h=function(){return e(this.base,this.modify_number)},h.$$arity=0),t.def(z,"$to_s",g=function(){var t,e,r,n,i,o=this;return t=C(o.base["$zero?"]())?W:o.base,e=R(x,"Format").$modifier(o.modify_number),r=R(x,"Format").$modifier(o.active_modify_number),n=C(i=o.prana)?"$"+o.prana:i,""+t+o.command+e+"@"+o.critical_numbers.$join(",")+"#"+o.fumble_numbers.$join(",")+n+r+o.cmp_op+o.target_number},g.$$arity=0),function(e,r,n){var i,o=A(e,r,"Parsed2R6");[o].concat(n),o.$$prototype.passive_modify_number=o.$$prototype.active_modify_number=o.$$prototype.critical_numbers=o.$$prototype.fumble_numbers=o.$$prototype.cmp_op=o.$$prototype.target_number=W,o.$attr_accessor("passive_modify_number"),t.def(o,"$to_s",i=function(){var t=this;return"2R6M["+t.passive_modify_number+","+t.active_modify_number+"]C["+t.critical_numbers.$join(",")+"]F["+t.fumble_numbers.$join(",")+"]"+t.cmp_op+t.target_number},i.$$arity=0)}(N[0],R(N,"Parsed"),N),t.def(S,"$parse_nw",c=function(e){var n,i,o=W,a=W,$=W;return o=t.regexp(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(e),C(o)?(a=R(N,"ParsedNW").$new(this.nw_command),$=[o["$[]"](1).$to_i()],k(a,"base=",t.to_a($)),r($.length,1),$=[R(N,"ArithmeticEvaluator").$eval(o["$[]"](2))],k(a,"modify_number=",t.to_a($)),r($.length,1),$=[C(o["$[]"](3))?k(o["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],k(a,"critical_numbers=",t.to_a($)),r($.length,1),$=[C(o["$[]"](4))?k(o["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],k(a,"fumble_numbers=",t.to_a($)),r($.length,1),$=[(n=o["$[]"](5),n===W||null==n?W:k(n,"to_i",[]))],k(a,"prana=",t.to_a($)),r($.length,1),$=[R(N,"ArithmeticEvaluator").$eval(o["$[]"](6))],k(a,"active_modify_number=",t.to_a($)),r($.length,1),$=[R(N,"Normalize").$comparison_operator(o["$[]"](7))],k(a,"cmp_op=",t.to_a($)),r($.length,1),$=[(i=o["$[]"](8),i===W||null==i?W:k(i,"to_i",[]))],k(a,"target_number=",t.to_a($)),r($.length,1),a):W},c.$$arity=1),t.def(S,"$parse_2r6",u=function(e){var n,i=W,o=W,a=W;return i=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(e),C(i)?(o=R(N,"Parsed2R6").$new(),a=[R(N,"ArithmeticEvaluator").$eval(i["$[]"](1))],k(o,"passive_modify_number=",t.to_a(a)),r(a.length,1),a=[R(N,"ArithmeticEvaluator").$eval(i["$[]"](2))],k(o,"active_modify_number=",t.to_a(a)),r(a.length,1),a=[C(i["$[]"](3))?k(i["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],k(o,"critical_numbers=",t.to_a(a)),r(a.length,1),a=[C(i["$[]"](4))?k(i["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],k(o,"fumble_numbers=",t.to_a(a)),r(a.length,1),a=[R(N,"Normalize").$comparison_operator(i["$[]"](5))],k(o,"cmp_op=",t.to_a(a)),r(a.length,1),a=[(n=i["$[]"](6),n===W||null==n?W:k(n,"to_i",[]))],k(o,"target_number=",t.to_a(a)),r(a.length,1),o):W},u.$$arity=1),t.def(S,"$roll_nw",s=function(t){var r,n=this,i=W,o=W,a=W,$=W,m=W;for(n.critical_numbers=t.$critical_numbers(),n.fumble_numbers=t.$fumble_numbers(),n.total=0,n.interim_expr="",n.status=W,i=n.$roll_once_first();i["$=="]("critical");)i=n.$roll_once();return C(C(r=i["$!="]("fumble"))?t.$prana():r)&&(a=(o=n.randomizer.$roll_barabara(t.$prana(),6)).$sum(),$=o.$join(","),n.total=e(n.total,a),n.interim_expr=e(n.interim_expr,"+"+a+"["+$+"]")),m=i["$=="]("fumble")?n.$fumble_base_number(t):e(t.$passive_modify_number(),t.$active_modify_number()),n.total=e(n.total,m),n.interim_expr=e(m.$to_s(),n.interim_expr),[n.total,n.interim_expr,n.status]},s.$$arity=1),t.def(S,"$roll_once",l=function(t){var n,i,o,a=this,$=W;return null==t&&(t=!1),n=($=a.randomizer.$roll_barabara(2,6)).$sum(),i=$.$join(","),C(C(o=t)?a.fumble_numbers["$include?"](n):o)?(a.total=r(a.total,10),a.interim_expr=e(a.interim_expr,"-10["+i+"]"),a.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):C(a.critical_numbers["$include?"](n))?(a.total=e(a.total,10),a.interim_expr=e(a.interim_expr,"+10["+i+"]"),a.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(a.total=e(a.total,n),a.interim_expr=e(a.interim_expr,"+"+n+"["+i+"]"),W)},l.$$arity=-1),t.def(S,"$roll_once_first",p=function(){return this.$roll_once(!0)},p.$$arity=0),void t.def(S,"$fumble_base_number",d=function(t){return t.$passive_modify_number()},d.$$arity=1)},s=[],l=(n=Opal).$$,p=n.module,d=n.klass,f=n.send2,n.top.$require("bcdice/game_system/NightWizard"),i=s,o=u=[p(s[0],"BCDice")].concat(i),a=c=[p(u[0],"GameSystem")].concat(o),_=[m=d(c[0],l(c,"NightWizard"),"SevenFortressMobius")].concat(a),n.const_set(_[0],"ID","SevenFortressMobius"),n.const_set(_[0],"NAME","\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9"),n.const_set(_[0],"SORT_KEY","\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059"),n.const_set(_[0],"HELP_MESSAGE",'\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(nSFM+m@x#y)\n\u3000"(\u57fa\u672c\u5024)SFM(\u5e38\u6642\u304a\u3088\u3073\u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u7b49\u53ca\u3073\u72b6\u614b\u7570\u5e38\uff08\u7701\u7565\u53ef\uff09)@(\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024)#(\u30d5\u30a1\u30f3\u30d6\u30eb\u5024)\uff08\u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u7b49\u53ca\u3073\u5473\u65b9\u306e\u652f\u63f4\u52b9\u679c\u7b49\u306e\u5f71\u97ff\uff08\u7701\u7565\u53ef\uff09\uff09"\u3067\u30ed\u30fc\u30eb\u3057\u307e\u3059\u3002\n\u3000R\u30b3\u30de\u30f3\u30c9(2R6m[n,m]c[x]f[y]>=t t\u306f\u76ee\u6a19\u5024)\u306b\u8aad\u66ff\u3055\u308c\u307e\u3059\u3002\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912SFM-5@7#2\u3000\u30001SFM\u3000\u300050SFM+5@7,10#2,5\u300050SFM-5+10@7,10#2,5+15+25\n'),m.$register_prefix("([-+]?\\d+)?SFM","2R6"),n.def(m,"$initialize",$=function(t){var e=this;return $.$$p&&($.$$p=null),f(e,n.find_super_dispatcher(e,"initialize",$,!1,!0),"initialize",[t],null),e.nw_command="SFM"},$.$$arity=1)}}]);