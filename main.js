(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{383:(E,le,me)=>{"use strict";me.r(le),me.d(le,{default:()=>_});var d=me(5861),H=me(3604),J=me.n(H);class _ extends(J()){dynamicImportI18n(O,w){return(0,d.Z)(function*(){return(yield me(6507)(`./${O}.${w}.json`)).default})()}dynamicImport(O){return(0,d.Z)(function*(){yield me(85)(`./${O}`)})()}}},113:(E,le,me)=>{"use strict";function d(t){return"function"==typeof t}function H(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const J=H(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function _(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class x{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(d(i))try{i()}catch(o){n=o instanceof J?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{K(o)}catch(s){n=n??[],s instanceof J?n=[...n,...s.errors]:n.push(s)}}if(n)throw new J(n)}}add(n){var e;if(n&&n!==this)if(this.closed)K(n);else{if(n instanceof x){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&_(e,n)}remove(n){const{_finalizers:e}=this;e&&_(e,n),n instanceof x&&n._removeParent(this)}}x.EMPTY=(()=>{const t=new x;return t.closed=!0,t})();const O=x.EMPTY;function w(t){return t instanceof x||t&&"closed"in t&&d(t.remove)&&d(t.add)&&d(t.unsubscribe)}function K(t){d(t)?t():t.unsubscribe()}const G={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},A={setTimeout(t,n,...e){const{delegate:i}=A;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=A;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function U(t){A.setTimeout(()=>{const{onUnhandledError:n}=G;if(!n)throw t;n(t)})}function N(){}const Y=oe("C",void 0,void 0);function oe(t,n,e){return{kind:t,value:n,error:e}}let z=null;function q(t){if(G.useDeprecatedSynchronousErrorHandling){const n=!z;if(n&&(z={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=z;if(z=null,e)throw i}}else t()}class M extends x{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,w(n)&&n.add(this)):this.destination=B}static create(n,e,i){return new S(n,e,i)}next(n){this.isStopped?P(function j(t){return oe("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?P(function T(t){return oe("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?P(Y,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const I=Function.prototype.bind;function Q(t,n){return I.call(t,n)}class L{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){k(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){k(i)}else k(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){k(e)}}}class S extends M{constructor(n,e,i){let r;if(super(),d(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&G.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&Q(n.next,o),error:n.error&&Q(n.error,o),complete:n.complete&&Q(n.complete,o)}):r=n}this.destination=new L(r)}}function k(t){G.useDeprecatedSynchronousErrorHandling?function X(t){G.useDeprecatedSynchronousErrorHandling&&z&&(z.errorThrown=!0,z.error=t)}(t):U(t)}function P(t,n){const{onStoppedNotification:e}=G;e&&A.setTimeout(()=>e(t,n))}const B={closed:!0,next:N,error:function v(t){throw t},complete:N},te="function"==typeof Symbol&&Symbol.observable||"@@observable";function D(t){return t}function fe(...t){return R(t)}function R(t){return 0===t.length?D:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}let F=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function c(t){return t&&t instanceof M||function l(t){return t&&d(t.next)&&d(t.error)&&d(t.complete)}(t)&&w(t)}(e)?e:new S(e,i,r);return q(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=g(i))((r,o)=>{const s=new S({next:a=>{try{e(a)}catch(h){o(h),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[te](){return this}pipe(...e){return R(e)(this)}toPromise(e){return new(e=g(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function g(t){var n;return null!==(n=t??G.Promise)&&void 0!==n?n:Promise}const f=H(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let u=(()=>{class t extends F{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new p(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new f}next(e){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){q(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?O:(this.currentObservers=null,o.push(e),new x(()=>{this.currentObservers=null,_(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new F;return e.source=this,e}}return t.create=(n,e)=>new p(n,e),t})();class p extends u{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:O}}function m(t){return d(t?.lift)}function C(t){return n=>{if(m(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function $(t,n,e,i,r){return new re(t,n,e,i,r)}class re extends M{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(h){n.error(h)}}:super._next,this._error=r?function(a){try{r(a)}catch(h){n.error(h)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function se(t,n){return C((e,i)=>{let r=0;e.subscribe($(i,o=>{i.next(t.call(n,o,r++))}))})}var Ee=function(t,n){return(Ee=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(t,n)};function Me(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}Ee(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var ce=function(){return ce=Object.assign||function(n){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},ce.apply(this,arguments)};function ve(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function Dt(t){return this instanceof Dt?(this.v=t,this):new Dt(t)}function Ot(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(_e){i[_e]&&(r[_e]=function(Ce){return new Promise(function(Se,Pe){o.push([_e,Ce,Se,Pe])>1||a(_e,Ce)})})}function a(_e,Ce){try{!function h(_e){_e.value instanceof Dt?Promise.resolve(_e.value.v).then(b,ee):de(o[0][2],_e)}(i[_e](Ce))}catch(Se){de(o[0][3],Se)}}function b(_e){a("next",_e)}function ee(_e){a("throw",_e)}function de(_e,Ce){_e(Ce),o.shift(),o.length&&a(o[0][0],o[0][1])}}function tn(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function we(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,h){!function r(o,s,a,h){Promise.resolve(h).then(function(b){o({value:b,done:a})},s)}(a,h,(s=t[o](s)).done,s.value)})}}}const sr=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function kc(t){return d(t?.then)}function kl(t){return d(t[te])}function Ha(t){return Symbol.asyncIterator&&d(t?.[Symbol.asyncIterator])}function Va(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Dc=function ed(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Ac(t){return d(t?.[Dc])}function Dl(t){return Ot(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Dt(e.read());if(r)return yield Dt(void 0);yield yield Dt(i)}}finally{e.releaseLock()}})}function Pc(t){return d(t?.getReader)}function Cr(t){if(t instanceof F)return t;if(null!=t){if(kl(t))return function td(t){return new F(n=>{const e=t[te]();if(d(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(sr(t))return function Ga(t){return new F(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(kc(t))return function nd(t){return new F(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,U)})}(t);if(Ha(t))return Al(t);if(Ac(t))return function Nc(t){return new F(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(Pc(t))return function Pl(t){return Al(Dl(t))}(t)}throw Va(t)}function Al(t){return new F(n=>{(function id(t,n){var e,i,r,o;return function xe(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(ee){try{b(i.next(ee))}catch(de){s(de)}}function h(ee){try{b(i.throw(ee))}catch(de){s(de)}}function b(ee){ee.done?o(ee.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(ee.value).then(a,h)}b((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=tn(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function fo(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function Ls(t,n,e=1/0){return d(n)?Ls((i,r)=>se((o,s)=>n(i,o,r,s))(Cr(t(i,r))),e):("number"==typeof n&&(e=n),C((i,r)=>function rd(t,n,e,i,r,o,s,a){const h=[];let b=0,ee=0,de=!1;const _e=()=>{de&&!h.length&&!b&&n.complete()},Ce=Pe=>b<i?Se(Pe):h.push(Pe),Se=Pe=>{o&&n.next(Pe),b++;let Ne=!1;Cr(e(Pe,ee++)).subscribe($(n,je=>{r?.(je),o?Ce(je):n.next(je)},()=>{Ne=!0},void 0,()=>{if(Ne)try{for(b--;h.length&&b<i;){const je=h.shift();s?fo(n,s,()=>Se(je)):Se(je)}_e()}catch(je){n.error(je)}}))};return t.subscribe($(n,Ce,()=>{de=!0,_e()})),()=>{a?.()}}(i,r,t,e)))}function Nl(t=1/0){return Ls(D,t)}const qa=new F(t=>t.complete());function qo(t){return t&&d(t.schedule)}function ms(t){return t[t.length-1]}function Wo(t){return d(ms(t))?t.pop():void 0}function Ko(t){return qo(ms(t))?t.pop():void 0}function Rl(t,n=0){return C((e,i)=>{e.subscribe($(i,r=>fo(i,t,()=>i.next(r),n),()=>fo(i,t,()=>i.complete(),n),r=>fo(i,t,()=>i.error(r),n)))})}function Bs(t,n=0){return C((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function Nr(t,n){if(!t)throw new Error("Iterable cannot be null");return new F(e=>{fo(e,n,()=>{const i=t[Symbol.asyncIterator]();fo(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Ji(t,n){return n?function ho(t,n){if(null!=t){if(kl(t))return function ha(t,n){return Cr(t).pipe(Bs(n),Rl(n))}(t,n);if(sr(t))return function zs(t,n){return new F(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(kc(t))return function Wi(t,n){return Cr(t).pipe(Bs(n),Rl(n))}(t,n);if(Ha(t))return Nr(t,n);if(Ac(t))return function Zr(t,n){return new F(e=>{let i;return fo(e,n,()=>{i=t[Dc](),fo(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>d(i?.return)&&i.return()})}(t,n);if(Pc(t))return function pa(t,n){return Nr(Dl(t),n)}(t,n)}throw Va(t)}(t,n):Cr(t)}function ga(...t){const n=Ko(t),e=function Fl(t,n){return"number"==typeof ms(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?Cr(i[0]):Nl(e)(Ji(i,n)):qa}function Be(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new S({next:()=>{i.unsubscribe(),t()}});return n(...e).subscribe(i)}function Ke(t){for(let n in t)if(t[n]===Ke)return n;throw Error("Could not find renamed property on target object.")}function qe(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Qe(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Qe).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function lt(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const et=Ke({__forward_ref__:Ke});function bt(t){return t.__forward_ref__=bt,t.toString=function(){return Qe(this())},t}function $t(t){return Rt(t)?t():t}function Rt(t){return"function"==typeof t&&t.hasOwnProperty(et)&&t.__forward_ref__===bt}class nt extends Error{constructor(n,e){super(function Xt(t,n){return`NG0${Math.abs(t)}${n?": "+n.trim():""}`}(n,e)),this.code=n}}function Vt(t){return"string"==typeof t?t:null==t?"":String(t)}function Ze(t,n){throw new nt(-201,!1)}function Eo(t,n){null==t&&function ui(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function xn(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function To(t){return{providers:t.providers||[],imports:t.imports||[]}}function Xf(t){return Xv(t,Qf)||Xv(t,Jv)}function Xv(t,n){return t.hasOwnProperty(n)?t[n]:null}function Qv(t){return t&&(t.hasOwnProperty(Vg)||t.hasOwnProperty($M))?t[Vg]:null}const Qf=Ke({\u0275prov:Ke}),Vg=Ke({\u0275inj:Ke}),Jv=Ke({ngInjectableDef:Ke}),$M=Ke({ngInjectorDef:Ke});var wn=(()=>((wn=wn||{})[wn.Default=0]="Default",wn[wn.Host=1]="Host",wn[wn.Self=2]="Self",wn[wn.SkipSelf=4]="SkipSelf",wn[wn.Optional=8]="Optional",wn))();let Gg;function Yo(t){const n=Gg;return Gg=t,n}function e1(t,n,e){const i=Xf(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&wn.Optional?null:void 0!==n?n:void Ze(Qe(t))}function Wa(t){return{toString:t}.toString()}var _s=(()=>((_s=_s||{})[_s.OnPush=0]="OnPush",_s[_s.Default=1]="Default",_s))(),$s=(()=>{return(t=$s||($s={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",$s;var t})();const xi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),Fc={},li=[],Jf=Ke({\u0275cmp:Ke}),qg=Ke({\u0275dir:Ke}),Wg=Ke({\u0275pipe:Ke}),t1=Ke({\u0275mod:Ke}),ma=Ke({\u0275fac:Ke}),sd=Ke({__NG_ELEMENT_ID__:Ke});let bM=0;function mn(t){return Wa(()=>{const e=!0===t.standalone,i={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===_s.OnPush,directiveDefs:null,pipeDefs:null,standalone:e,dependencies:e&&t.dependencies||null,getStandaloneInjector:null,selectors:t.selectors||li,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||$s.Emulated,id:"c"+bM++,styles:t.styles||li,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.dependencies,s=t.features;return r.inputs=r1(t.inputs,i),r.outputs=r1(t.outputs),s&&s.forEach(a=>a(r)),r.directiveDefs=o?()=>("function"==typeof o?o():o).map(n1).filter(i1):null,r.pipeDefs=o?()=>("function"==typeof o?o():o).map(Qr).filter(i1):null,r})}function Rc(t,n,e){const i=t.\u0275cmp;i.directiveDefs=()=>("function"==typeof n?n():n).map(n1),i.pipeDefs=()=>("function"==typeof e?e():e).map(Qr)}function n1(t){return hi(t)||Xr(t)}function i1(t){return null!==t}function Zo(t){return Wa(()=>({type:t.type,bootstrap:t.bootstrap||li,declarations:t.declarations||li,imports:t.imports||li,exports:t.exports||li,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function r1(t,n){if(null==t)return Fc;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],o=r;Array.isArray(r)&&(o=r[1],r=r[0]),e[r]=i,n&&(n[r]=o)}return e}const _n=mn;function Or(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function hi(t){return t[Jf]||null}function Xr(t){return t[qg]||null}function Qr(t){return t[Wg]||null}function go(t){return Array.isArray(t)&&"object"==typeof t[1]}function bs(t){return Array.isArray(t)&&!0===t[1]}function Zg(t){return 0!=(8&t.flags)}function ih(t){return 2==(2&t.flags)}function rh(t){return 1==(1&t.flags)}function ys(t){return null!==t.template}function EM(t){return 0!=(256&t[2])}function Ul(t,n){return t.hasOwnProperty(ma)?t[ma]:null}class IM{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Cs(){return a1}function a1(t){return t.type.prototype.ngOnChanges&&(t.setInput=kM),MM}function MM(){const t=c1(this),n=t?.current;if(n){const e=t.previous;if(e===Fc)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function kM(t,n,e,i){const r=c1(t)||function DM(t,n){return t[l1]=n}(t,{previous:Fc,current:null}),o=r.current||(r.current={}),s=r.previous,a=this.declaredInputs[e],h=s[a];o[a]=new IM(h&&h.currentValue,n,s===Fc),t[i]=n}Cs.ngInherit=!0;const l1="__ngSimpleChanges__";function c1(t){return t[l1]||null}function tr(t){for(;Array.isArray(t);)t=t[0];return t}function oh(t,n){return tr(n[t])}function Mo(t,n){return tr(n[t.index])}function tm(t,n){return t.data[n]}function jc(t,n){return t[n]}function ko(t,n){const e=n[t];return go(e)?e:e[0]}function sh(t){return 64==(64&t[2])}function Ka(t,n){return null==n?null:t[n]}function u1(t){t[18]=0}function nm(t,n){t[5]+=n;let e=t,i=t[3];for(;null!==i&&(1===n&&1===e[5]||-1===n&&0===e[5]);)i[5]+=n,e=i,i=i[3]}const kn={lFrame:b1(null),bindingsEnabled:!0};function f1(){return kn.bindingsEnabled}function At(){return kn.lFrame.lView}function ni(){return kn.lFrame.tView}function Fe(t){return kn.lFrame.contextLView=t,t[8]}function Re(t){return kn.lFrame.contextLView=null,t}function ar(){let t=h1();for(;null!==t&&64===t.type;)t=t.parent;return t}function h1(){return kn.lFrame.currentTNode}function js(t,n){const e=kn.lFrame;e.currentTNode=t,e.isParent=n}function im(){return kn.lFrame.isParent}function rm(){kn.lFrame.isParent=!1}function Jr(){const t=kn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Uc(){return kn.lFrame.bindingIndex++}function $a(t){const n=kn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function qM(t,n){const e=kn.lFrame;e.bindingIndex=e.bindingRootIndex=t,om(n)}function om(t){kn.lFrame.currentDirectiveIndex=t}function _1(){return kn.lFrame.currentQueryIndex}function am(t){kn.lFrame.currentQueryIndex=t}function KM(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function $1(t,n,e){if(e&wn.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&wn.Host||(r=KM(o),null===r||(o=o[15],10&r.type))););if(null===r)return!1;n=r,t=o}const i=kn.lFrame=v1();return i.currentTNode=n,i.lView=t,!0}function lm(t){const n=v1(),e=t[1];kn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function v1(){const t=kn.lFrame,n=null===t?null:t.child;return null===n?b1(t):n}function b1(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function y1(){const t=kn.lFrame;return kn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const C1=y1;function cm(){const t=y1();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function eo(){return kn.lFrame.selectedIndex}function Ya(t){kn.lFrame.selectedIndex=t}function ji(){const t=kn.lFrame;return tm(t.tView,t.selectedIndex)}function ah(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:h,ngAfterViewChecked:b,ngOnDestroy:ee}=o;s&&(t.contentHooks||(t.contentHooks=[])).push(-e,s),a&&((t.contentHooks||(t.contentHooks=[])).push(e,a),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,a)),h&&(t.viewHooks||(t.viewHooks=[])).push(-e,h),b&&((t.viewHooks||(t.viewHooks=[])).push(e,b),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,b)),null!=ee&&(t.destroyHooks||(t.destroyHooks=[])).push(e,ee)}}function lh(t,n,e){x1(t,n,3,e)}function ch(t,n,e,i){(3&t[2])===e&&x1(t,n,e,i)}function um(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function x1(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let h=void 0!==i?65535&t[18]:0;h<s;h++)if("number"==typeof n[h+1]){if(a=n[h],null!=i&&a>=i)break}else n[h]<0&&(t[18]+=65536),(a<o||-1==o)&&(ik(t,e,n,h),t[18]=(4294901760&t[18])+h+2),h++}function ik(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{o.call(a)}finally{}}}else try{o.call(a)}finally{}}class hd{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function uh(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];E1(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function w1(t){return 3===t||4===t||6===t}function E1(t){return 64===t.charCodeAt(0)}function dh(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||T1(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function T1(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}function S1(t){return-1!==t}function Hc(t){return 32767&t}function Vc(t,n){let e=function lk(t){return t>>16}(t),i=n;for(;e>0;)i=i[15],e--;return i}let fm=!0;function fh(t){const n=fm;return fm=t,n}let ck=0;const Us={};function gd(t,n){const e=pm(t,n);if(-1!==e)return e;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,hm(i.data,t),hm(n,null),hm(i.blueprint,null));const r=hh(t,n),o=t.injectorIndex;if(S1(r)){const s=Hc(r),a=Vc(r,n),h=a[1].data;for(let b=0;b<8;b++)n[o+b]=a[s+b]|h[s+b]}return n[o+8]=r,o}function hm(t,n){t.push(0,0,0,0,0,0,0,0,n)}function pm(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function hh(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=F1(r),null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function ph(t,n,e){!function uk(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(sd)&&(i=e[sd]),null==i&&(i=e[sd]=ck++);const r=255&i;n.data[t+(r>>5)]|=1<<r}(t,n,e)}function k1(t,n,e){if(e&wn.Optional||void 0!==t)return t;Ze()}function D1(t,n,e,i){if(e&wn.Optional&&void 0===i&&(i=null),0==(e&(wn.Self|wn.Host))){const r=t[9],o=Yo(void 0);try{return r?r.get(n,i,e&wn.Optional):e1(n,i,e&wn.Optional)}finally{Yo(o)}}return k1(i,0,e)}function A1(t,n,e,i=wn.Default,r){if(null!==t){if(1024&n[2]){const s=function gk(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&1024&s[2]&&!(256&s[2]);){const a=P1(o,s,e,i|wn.Self,Us);if(a!==Us)return a;let h=o.parent;if(!h){const b=s[21];if(b){const ee=b.get(e,Us,i);if(ee!==Us)return ee}h=F1(s),s=s[15]}o=h}return r}(t,n,e,i,Us);if(s!==Us)return s}const o=P1(t,n,e,i,Us);if(o!==Us)return o}return D1(n,e,i,r)}function P1(t,n,e,i,r){const o=function hk(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(sd)?t[sd]:void 0;return"number"==typeof n?n>=0?255&n:pk:n}(e);if("function"==typeof o){if(!$1(n,t,i))return i&wn.Host?k1(r,0,i):D1(n,e,i,r);try{const s=o(i);if(null!=s||i&wn.Optional)return s;Ze()}finally{C1()}}else if("number"==typeof o){let s=null,a=pm(t,n),h=-1,b=i&wn.Host?n[16][6]:null;for((-1===a||i&wn.SkipSelf)&&(h=-1===a?hh(t,n):n[a+8],-1!==h&&O1(i,!1)?(s=n[1],a=Hc(h),n=Vc(h,n)):a=-1);-1!==a;){const ee=n[1];if(N1(o,a,ee.data)){const de=fk(a,n,e,s,i,b);if(de!==Us)return de}h=n[a+8],-1!==h&&O1(i,n[1].data[a+8]===b)&&N1(o,a,n)?(s=ee,a=Hc(h),n=Vc(h,n)):a=-1}}return r}function fk(t,n,e,i,r,o){const s=n[1],a=s.data[t+8],ee=gh(a,s,e,null==i?ih(a)&&fm:i!=s&&0!=(3&a.type),r&wn.Host&&o===a);return null!==ee?md(n,s,ee,a):Us}function gh(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,h=t.directiveStart,ee=o>>20,_e=r?a+ee:t.directiveEnd;for(let Ce=i?a:a+ee;Ce<_e;Ce++){const Se=s[Ce];if(Ce<h&&e===Se||Ce>=h&&Se.type===e)return Ce}if(r){const Ce=s[h];if(Ce&&ys(Ce)&&Ce.type===e)return h}return null}function md(t,n,e,i){let r=t[e];const o=n.data;if(function rk(t){return t instanceof hd}(r)){const s=r;s.resolving&&function ri(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new nt(-200,`Circular dependency in DI detected for ${t}${e}`)}(function nn(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Vt(t)}(o[e]));const a=fh(s.canSeeViewProviders);s.resolving=!0;const h=s.injectImpl?Yo(s.injectImpl):null;$1(t,i,wn.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function nk(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=a1(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),o&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,o))}(e,o[e],n)}finally{null!==h&&Yo(h),fh(a),s.resolving=!1,C1()}}return r}function N1(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function O1(t,n){return!(t&wn.Self||t&wn.Host&&n)}class Gc{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return A1(this._tNode,this._lView,n,i,e)}}function pk(){return new Gc(ar(),At())}function Lr(t){return Wa(()=>{const n=t.prototype.constructor,e=n[ma]||gm(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[ma]||gm(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function gm(t){return Rt(t)?()=>{const n=gm($t(t));return n&&n()}:Ul(t)}function F1(t){const n=t[1],e=n.type;return 2===e?n.declTNode:1===e?t[6]:null}const Wc="__parameters__";function Yc(t,n,e){return Wa(()=>{const i=function _m(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(h,b,ee){const de=h.hasOwnProperty(Wc)?h[Wc]:Object.defineProperty(h,Wc,{value:[]})[Wc];for(;de.length<=ee;)de.push(null);return(de[ee]=de[ee]||[]).push(s),h}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class Dn{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=xn({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Do(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let i=t[e];Array.isArray(i)?(n===t&&(n=t.slice(0,e)),Do(i,n)):n!==t&&n.push(i)}return n}function va(t,n){t.forEach(e=>Array.isArray(e)?va(e,n):n(e))}function L1(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function mh(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function vd(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function Ao(t,n,e){let i=Zc(t,n);return i>=0?t[1|i]=e:(i=~i,function vk(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function vm(t,n){const e=Zc(t,n);if(e>=0)return t[1|e]}function Zc(t,n){return function j1(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const bd={},ym="__NG_DI_FLAG__",$h="ngTempTokenPath",Sk=/\n/gm,U1="__source";let yd;function Xc(t){const n=yd;return yd=t,n}function Mk(t,n=wn.Default){if(void 0===yd)throw new nt(-203,!1);return null===yd?e1(t,void 0,n):yd.get(t,n&wn.Optional?null:void 0,n)}function $n(t,n=wn.Default){return(function vM(){return Gg}()||Mk)($t(t),n)}function Cm(t){const n=[];for(let e=0;e<t.length;e++){const i=$t(t[e]);if(Array.isArray(i)){if(0===i.length)throw new nt(900,!1);let r,o=wn.Default;for(let s=0;s<i.length;s++){const a=i[s],h=Dk(a);"number"==typeof h?-1===h?r=a.token:o|=h:r=a}n.push($n(r,o))}else n.push($n(i))}return n}function Cd(t,n){return t[ym]=n,t.prototype[ym]=n,t}function Dk(t){return t[ym]}const vh=Cd(Yc("Optional"),8),bh=Cd(Yc("SkipSelf"),4);var mo=(()=>((mo=mo||{})[mo.Important=1]="Important",mo[mo.DashCase=2]="DashCase",mo))();const Sm=new Map;let Yk=0;const Mm="__ngContext__";function Br(t,n){go(n)?(t[Mm]=n[20],function Xk(t){Sm.set(t[20],t)}(n)):t[Mm]=n}function Dm(t,n){return undefined(t,n)}function Td(t){const n=t[3];return bs(n)?n[3]:n}function Am(t){return cb(t[13])}function Pm(t){return cb(t[4])}function cb(t){for(;null!==t&&!bs(t);)t=t[4];return t}function Jc(t,n,e,i,r){if(null!=i){let o,s=!1;bs(i)?o=i:go(i)&&(s=!0,i=i[0]);const a=tr(i);0===t&&null!==e?null==r?gb(n,e,a):Hl(n,e,a,r||null,!0):1===t&&null!==e?Hl(n,e,a,r||null,!0):2===t?function zm(t,n,e){const i=xh(t,n);i&&function vD(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function CD(t,n,e,i,r){const o=e[7];o!==tr(e)&&Jc(n,t,i,o,r);for(let a=10;a<e.length;a++){const h=e[a];Sd(h[1],h,t,n,i,o)}}(n,t,o,e,r)}}function Om(t,n,e){return t.createElement(n,e)}function db(t,n){const e=t[9],i=e.indexOf(n),r=n[3];512&n[2]&&(n[2]&=-513,nm(r,-1)),e.splice(i,1)}function Fm(t,n){if(t.length<=10)return;const e=10+n,i=t[e];if(i){const r=i[17];null!==r&&r!==t&&db(r,i),n>0&&(t[e-1][4]=i[4]);const o=mh(t,10+n);!function dD(t,n){Sd(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const s=o[19];null!==s&&s.detachView(o[1]),i[3]=null,i[4]=null,i[2]&=-65}return i}function fb(t,n){if(!(128&n[2])){const e=n[11];e.destroyNode&&Sd(t,n,e,3,null,null),function pD(t){let n=t[13];if(!n)return Rm(t[1],t);for(;n;){let e=null;if(go(n))e=n[13];else{const i=n[10];i&&(e=i)}if(!e){for(;n&&!n[4]&&n!==t;)go(n)&&Rm(n[1],n),n=n[3];null===n&&(n=t),go(n)&&Rm(n[1],n),e=n&&n[4]}n=e}}(n)}}function Rm(t,n){if(!(128&n[2])){n[2]&=-65,n[2]|=128,function $D(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof hd)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],h=o[s+1];try{h.call(a)}finally{}}else try{o.call(r)}finally{}}}}(t,n),function _D(t,n){const e=t.cleanup,i=n[7];let r=-1;if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+1],a="function"==typeof s?s(n):tr(n[s]),h=i[r=e[o+2]],b=e[o+3];"boolean"==typeof b?a.removeEventListener(e[o],h,b):b>=0?i[r=b]():i[r=-b].unsubscribe(),o+=2}else{const s=i[r=e[o+1]];e[o].call(s)}if(null!==i){for(let o=r+1;o<i.length;o++)(0,i[o])();n[7]=null}}(t,n),1===n[1].type&&n[11].destroy();const e=n[17];if(null!==e&&bs(n[3])){e!==n[3]&&db(e,n);const i=n[19];null!==i&&i.detachView(t)}!function Qk(t){Sm.delete(t[20])}(n)}}function hb(t,n,e){return function pb(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===$s.None||r===$s.Emulated)return null}return Mo(i,e)}(t,n.parent,e)}function Hl(t,n,e,i,r){t.insertBefore(n,e,i,r)}function gb(t,n,e){t.appendChild(n,e)}function mb(t,n,e,i,r){null!==i?Hl(t,n,e,i,r):gb(t,n,e)}function xh(t,n){return t.parentNode(n)}function _b(t,n,e){return vb(t,n,e)}let Th,Vm,Sh,vb=function $b(t,n,e){return 40&t.type?Mo(t,e):null};function wh(t,n,e,i){const r=hb(t,i,n),o=n[11],a=_b(i.parent||n[6],i,n);if(null!=r)if(Array.isArray(e))for(let h=0;h<e.length;h++)mb(o,r,e[h],a,!1);else mb(o,r,e,a,!1)}function Eh(t,n){if(null!==n){const e=n.type;if(3&e)return Mo(n,t);if(4&e)return Bm(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Eh(t,i);{const r=t[n.index];return bs(r)?Bm(-1,r):tr(r)}}if(32&e)return Dm(n,t)()||tr(t[n.index]);{const i=yb(t,n);return null!==i?Array.isArray(i)?i[0]:Eh(Td(t[16]),i):Eh(t,n.next)}}return null}function yb(t,n){return null!==n?t[16][6].projection[n.projection]:null}function Bm(t,n){const e=10+t+1;if(e<n.length){const i=n[e],r=i[1].firstChild;if(null!==r)return Eh(i,r)}return n[7]}function jm(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],h=e.type;if(s&&0===n&&(a&&Br(tr(a),i),e.flags|=4),64!=(64&e.flags))if(8&h)jm(t,n,e.child,i,r,o,!1),Jc(n,t,r,a,o);else if(32&h){const b=Dm(e,i);let ee;for(;ee=b();)Jc(n,t,r,ee,o);Jc(n,t,r,a,o)}else 16&h?Cb(t,n,i,e,r,o):Jc(n,t,r,a,o);e=s?e.projectionNext:e.next}}function Sd(t,n,e,i,r,o){jm(e,i,t.firstChild,n,r,o,!1)}function Cb(t,n,e,i,r,o){const s=e[16],h=s[6].projection[i.projection];if(Array.isArray(h))for(let b=0;b<h.length;b++)Jc(n,t,r,h[b],o);else jm(t,n,h,s[3],r,o,!0)}function xb(t,n,e){t.setAttribute(n,"style",e)}function Um(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function Vl(t){return function Hm(){if(void 0===Th&&(Th=null,xi.trustedTypes))try{Th=xi.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Th}()?.createHTML(t)||t}function Eb(t){return function Gm(){if(void 0===Sh&&(Sh=null,xi.trustedTypes))try{Sh=xi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Sh}()?.createHTML(t)||t}class Gl{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class ID extends Gl{getTypeName(){return"HTML"}}class MD extends Gl{getTypeName(){return"Style"}}class kD extends Gl{getTypeName(){return"Script"}}class DD extends Gl{getTypeName(){return"URL"}}class AD extends Gl{getTypeName(){return"ResourceURL"}}function Po(t){return t instanceof Gl?t.changingThisBreaksApplicationSecurity:t}function Hs(t,n){const e=function PD(t){return t instanceof Gl&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===n}class BD{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(Vl(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class zD{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(n){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=Vl(n),e;const i=this.inertDocument.createElement("body");return i.innerHTML=Vl(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(n){const e=n.attributes;for(let r=e.length-1;0<r;r--){const s=e.item(r).name;("xmlns:ns1"===s||0===s.indexOf("ns1:"))&&n.removeAttribute(s)}let i=n.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const UD=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;function Ih(t){return(t=String(t)).match(UD)?t:"unsafe:"+t}function ba(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Id(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const Mb=ba("area,br,col,hr,img,wbr"),kb=ba("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Db=ba("rp,rt"),qm=Id(Mb,Id(kb,ba("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Id(Db,ba("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Id(Db,kb)),Wm=ba("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ab=Id(Wm,ba("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),ba("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),HD=ba("script,style,template");class VD{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!qm.hasOwnProperty(e))return this.sanitizedSomething=!0,!HD.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!Ab.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let h=o.value;Wm[a]&&(h=Ih(h)),this.buf.push(" ",s,'="',Pb(h),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();qm.hasOwnProperty(e)&&!Mb.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(Pb(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const GD=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,qD=/([^\#-~ |!])/g;function Pb(t){return t.replace(/&/g,"&amp;").replace(GD,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(qD,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Mh;function Nb(t,n){let e=null;try{Mh=Mh||function Ib(t){const n=new zD(t);return function jD(){try{return!!(new window.DOMParser).parseFromString(Vl(""),"text/html")}catch{return!1}}()?new BD(n):n}(t);let i=n?String(n):"";e=Mh.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Mh.getInertBodyElement(i)}while(i!==o);return Vl((new VD).sanitizeChildren(Km(e)||e))}finally{if(e){const i=Km(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function Km(t){return"content"in t&&function WD(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Ei=(()=>((Ei=Ei||{})[Ei.NONE=0]="NONE",Ei[Ei.HTML=1]="HTML",Ei[Ei.STYLE=2]="STYLE",Ei[Ei.SCRIPT=3]="SCRIPT",Ei[Ei.URL=4]="URL",Ei[Ei.RESOURCE_URL=5]="RESOURCE_URL",Ei))();function cr(t){const n=Md();return n?Eb(n.sanitize(Ei.HTML,t)||""):Hs(t,"HTML")?Eb(Po(t)):Nb(function wb(){return void 0!==Vm?Vm:typeof document<"u"?document:void 0}(),Vt(t))}function vn(t){const n=Md();return n?n.sanitize(Ei.URL,t)||"":Hs(t,"URL")?Po(t):Ih(Vt(t))}function Md(){const t=At();return t&&t[12]}const Fb=new Dn("ENVIRONMENT_INITIALIZER"),Rb=new Dn("INJECTOR",-1),Lb=new Dn("INJECTOR_DEF_TYPES");class Bb{get(n,e=bd){if(e===bd){const i=new Error(`NullInjectorError: No provider for ${Qe(n)}!`);throw i.name="NullInjectorError",i}return e}}function eA(...t){return{\u0275providers:zb(0,t)}}function zb(t,...n){const e=[],i=new Set;let r;return va(n,o=>{const s=o;Ym(s,e,[],i)&&(r||(r=[]),r.push(s))}),void 0!==r&&jb(r,e),e}function jb(t,n){for(let e=0;e<t.length;e++){const{providers:r}=t[e];va(r,o=>{n.push(o)})}}function Ym(t,n,e,i){if(!(t=$t(t)))return!1;let r=null,o=Qv(t);const s=!o&&hi(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const h=t.ngModule;if(o=Qv(h),!o)return!1;r=h}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const h="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const b of h)Ym(b,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let b;i.add(r);try{va(o.imports,ee=>{Ym(ee,n,e,i)&&(b||(b=[]),b.push(ee))})}finally{}void 0!==b&&jb(b,n)}if(!a){const b=Ul(r)||(()=>new r);n.push({provide:r,useFactory:b,deps:li},{provide:Lb,useValue:r,multi:!0},{provide:Fb,useValue:()=>$n(r),multi:!0})}const h=o.providers;null==h||a||va(h,ee=>{n.push(ee)})}}return r!==t&&void 0!==t.providers}const tA=Ke({provide:String,useValue:Ke});function Zm(t){return null!==t&&"object"==typeof t&&tA in t}function ql(t){return"function"==typeof t}const Xm=new Dn("Set Injector scope."),kh={},iA={};let Qm;function Dh(){return void 0===Qm&&(Qm=new Bb),Qm}class eu{}class Vb extends eu{constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,e_(n,s=>this.processProvider(s)),this.records.set(Rb,tu(void 0,this)),r.has("environment")&&this.records.set(eu,tu(void 0,this));const o=this.records.get(Xm);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(Lb.multi,li,wn.Self))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const n of this._ngOnDestroyHooks)n.ngOnDestroy();for(const n of this._onDestroyHooks)n()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(n){this._onDestroyHooks.push(n)}runInContext(n){this.assertNotDestroyed();const e=Xc(this),i=Yo(void 0);try{return n()}finally{Xc(e),Yo(i)}}get(n,e=bd,i=wn.Default){this.assertNotDestroyed();const r=Xc(this),o=Yo(void 0);try{if(!(i&wn.SkipSelf)){let a=this.records.get(n);if(void 0===a){const h=function lA(t){return"function"==typeof t||"object"==typeof t&&t instanceof Dn}(n)&&Xf(n);a=h&&this.injectableDefInScope(h)?tu(Jm(n),kh):null,this.records.set(n,a)}if(null!=a)return this.hydrate(n,a)}return(i&wn.Self?Dh():this.parent).get(n,e=i&wn.Optional&&e===bd?null:e)}catch(s){if("NullInjectorError"===s.name){if((s[$h]=s[$h]||[]).unshift(Qe(n)),r)throw s;return function Ak(t,n,e,i){const r=t[$h];throw n[U1]&&r.unshift(n[U1]),t.message=function Pk(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let r=Qe(n);if(Array.isArray(n))r=n.map(Qe).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Qe(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(Sk,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[$h]=null,t}(s,n,"R3InjectorError",this.source)}throw s}finally{Yo(o),Xc(r)}}resolveInjectorInitializers(){const n=Xc(this),e=Yo(void 0);try{const i=this.get(Fb.multi,li,wn.Self);for(const r of i)r()}finally{Xc(n),Yo(e)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(Qe(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new nt(205,!1)}processProvider(n){let e=ql(n=$t(n))?n:$t(n&&n.provide);const i=function oA(t){return Zm(t)?tu(void 0,t.useValue):tu(Gb(t),kh)}(n);if(ql(n)||!0!==n.multi)this.records.get(e);else{let r=this.records.get(e);r||(r=tu(void 0,kh,!0),r.factory=()=>Cm(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){return e.value===kh&&(e.value=iA,e.value=e.factory()),"object"==typeof e.value&&e.value&&function aA(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=$t(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}}function Jm(t){const n=Xf(t),e=null!==n?n.factory:Ul(t);if(null!==e)return e;if(t instanceof Dn)throw new nt(204,!1);if(t instanceof Function)return function rA(t){const n=t.length;if(n>0)throw vd(n,"?"),new nt(204,!1);const e=function mM(t){const n=t&&(t[Qf]||t[Jv]);if(n){const e=function _M(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new nt(204,!1)}function Gb(t,n,e){let i;if(ql(t)){const r=$t(t);return Ul(r)||Jm(r)}if(Zm(t))i=()=>$t(t.useValue);else if(function Hb(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...Cm(t.deps||[]));else if(function Ub(t){return!(!t||!t.useExisting)}(t))i=()=>$n($t(t.useExisting));else{const r=$t(t&&(t.useClass||t.provide));if(!function sA(t){return!!t.deps}(t))return Ul(r)||Jm(r);i=()=>new r(...Cm(t.deps))}return i}function tu(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function cA(t){return!!t.\u0275providers}function e_(t,n){for(const e of t)Array.isArray(e)?e_(e,n):cA(e)?e_(e.\u0275providers,n):n(e)}class qb{}class fA{resolveComponentFactory(n){throw function dA(t){const n=Error(`No component factory found for ${Qe(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let Ah=(()=>{class t{}return t.NULL=new fA,t})();function hA(){return nu(ar(),At())}function nu(t,n){return new Ai(Mo(t,n))}let Ai=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=hA,t})();function pA(t){return t instanceof Ai?t.nativeElement:t}class kd{}let Wl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function gA(){const t=At(),e=ko(ar().index,t);return(go(e)?e:t)[11]}(),t})(),mA=(()=>{class t{}return t.\u0275prov=xn({token:t,providedIn:"root",factory:()=>null}),t})();class Ph{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const _A=new Ph("14.3.0"),t_={};function i_(t){return t.ngOriginalError}class iu{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&i_(n);for(;e&&i_(e);)e=i_(e);return e||null}}function Nh(t){return t.ownerDocument}function Yb(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}const Zb="ng-template";function SA(t,n,e){let i=0;for(;i<t.length;){let r=t[i++];if(e&&"class"===r){if(r=t[i],-1!==Yb(r.toLowerCase(),n,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function Xb(t){return 4===t.type&&t.value!==Zb}function IA(t,n,e){return n===(4!==t.type||e?t.value:Zb)}function MA(t,n,e){let i=4;const r=t.attrs||[],o=function AA(t){for(let n=0;n<t.length;n++)if(w1(t[n]))return n;return t.length}(r);let s=!1;for(let a=0;a<n.length;a++){const h=n[a];if("number"!=typeof h){if(!s)if(4&i){if(i=2|1&i,""!==h&&!IA(t,h,e)||""===h&&1===n.length){if(xs(i))return!1;s=!0}}else{const b=8&i?h:n[++a];if(8&i&&null!==t.attrs){if(!SA(t.attrs,b,e)){if(xs(i))return!1;s=!0}continue}const de=kA(8&i?"class":h,r,Xb(t),e);if(-1===de){if(xs(i))return!1;s=!0;continue}if(""!==b){let _e;_e=de>o?"":r[de+1].toLowerCase();const Ce=8&i?_e:null;if(Ce&&-1!==Yb(Ce,b,0)||2&i&&b!==_e){if(xs(i))return!1;s=!0}}}}else{if(!s&&!xs(i)&&!xs(h))return!1;if(s&&xs(h))continue;s=!1,i=h|1&i}}return xs(i)||s}function xs(t){return 0==(1&t)}function kA(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function PA(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function Qb(t,n,e=!1){for(let i=0;i<n.length;i++)if(MA(t,n[i],e))return!0;return!1}function NA(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function Jb(t,n){return t?":not("+n.trim()+")":n}function OA(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!xs(s)&&(n+=Jb(o,r),r=""),i=s,o=o||!xs(i);e++}return""!==r&&(n+=Jb(o,r)),n}const Pn={};function V(t){ey(ni(),At(),eo()+t,!1)}function ey(t,n,e,i){if(!i)if(3==(3&n[2])){const o=t.preOrderCheckHooks;null!==o&&lh(n,o,e)}else{const o=t.preOrderHooks;null!==o&&ch(n,o,0,e)}Ya(e)}function ry(t,n=null,e=null,i){const r=oy(t,n,e,i);return r.resolveInjectorInitializers(),r}function oy(t,n=null,e=null,i,r=new Set){const o=[e||li,eA(t)];return i=i||("object"==typeof t?void 0:Qe(t)),new Vb(o,n||Dh(),i||null,r)}let ws=(()=>{class t{static create(e,i){if(Array.isArray(e))return ry({name:""},i,e,"");{const r=e.name??"";return ry({name:r},e.parent,e.providers,r)}}}return t.THROW_IF_NOT_FOUND=bd,t.NULL=new Bb,t.\u0275prov=xn({token:t,providedIn:"any",factory:()=>$n(Rb)}),t.__NG_ELEMENT_ID__=-1,t})();function Ge(t,n=wn.Default){const e=At();return null===e?$n(t,n):A1(ar(),e,$t(t),n)}function Fh(t,n){return t<<17|n<<2}function Es(t){return t>>17&32767}function l_(t){return 2|t}function Ca(t){return(131068&t)>>2}function c_(t,n){return-131069&t|n<<2}function u_(t){return 1|t}function Cy(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],o=e[i+1];if(-1!==o){const s=t.data[o];am(r),s.contentQueries(2,n[o],o)}}}function Bh(t,n,e,i,r,o,s,a,h,b,ee){const de=n.blueprint.slice();return de[0]=r,de[2]=76|i,(null!==ee||t&&1024&t[2])&&(de[2]|=1024),u1(de),de[3]=de[15]=t,de[8]=e,de[10]=s||t&&t[10],de[11]=a||t&&t[11],de[12]=h||t&&t[12]||null,de[9]=b||t&&t[9]||null,de[6]=o,de[20]=function Zk(){return Yk++}(),de[21]=ee,de[16]=2==n.type?t[16]:de,de}function su(t,n,e,i,r){let o=t.data[n];if(null===o)o=function $_(t,n,e,i,r){const o=h1(),s=im(),h=t.data[n]=function $P(t,n,e,i,r,o){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=h),null!==o&&(s?null==o.child&&null!==h.parent&&(o.child=h):null===o.next&&(o.next=h)),h}(t,n,e,i,r),function GM(){return kn.lFrame.inI18n}()&&(o.flags|=64);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function fd(){const t=kn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return js(o,!0),o}function au(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function v_(t,n,e){lm(n);try{const i=t.viewQuery;null!==i&&S_(1,i,e);const r=t.template;null!==r&&xy(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Cy(t,n),t.staticViewQueries&&S_(2,t.viewQuery,e);const o=t.components;null!==o&&function gP(t,n){for(let e=0;e<n.length;e++)NP(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,cm()}}function zh(t,n,e,i){const r=n[2];if(128!=(128&r)){lm(n);try{u1(n),function g1(t){return kn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&xy(t,n,e,2,i);const s=3==(3&r);if(s){const b=t.preOrderCheckHooks;null!==b&&lh(n,b,null)}else{const b=t.preOrderHooks;null!==b&&ch(n,b,0,null),um(n,0)}if(function AP(t){for(let n=Am(t);null!==n;n=Pm(n)){if(!n[2])continue;const e=n[9];for(let i=0;i<e.length;i++){const r=e[i],o=r[3];0==(512&r[2])&&nm(o,1),r[2]|=512}}}(n),function DP(t){for(let n=Am(t);null!==n;n=Pm(n))for(let e=10;e<n.length;e++){const i=n[e],r=i[1];sh(i)&&zh(r,i,r.template,i[8])}}(n),null!==t.contentQueries&&Cy(t,n),s){const b=t.contentCheckHooks;null!==b&&lh(n,b)}else{const b=t.contentHooks;null!==b&&ch(n,b,1),um(n,1)}!function hP(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)Ya(~r);else{const o=r,s=e[++i],a=e[++i];qM(s,o),a(2,n[o])}}}finally{Ya(-1)}}(t,n);const a=t.components;null!==a&&function pP(t,n){for(let e=0;e<n.length;e++)PP(t,n[e])}(n,a);const h=t.viewQuery;if(null!==h&&S_(2,h,i),s){const b=t.viewCheckHooks;null!==b&&lh(n,b)}else{const b=t.viewHooks;null!==b&&ch(n,b,2),um(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[2]&=-41,512&n[2]&&(n[2]&=-513,nm(n[3],-1))}finally{cm()}}}function xy(t,n,e,i,r){const o=eo(),s=2&i;try{Ya(-1),s&&n.length>22&&ey(t,n,22,!1),e(i,r)}finally{Ya(o)}}function wy(t,n,e){if(Zg(n)){const r=n.directiveEnd;for(let o=n.directiveStart;o<r;o++){const s=t.data[o];s.contentQueries&&s.contentQueries(1,e[o],o)}}}function b_(t,n,e){!f1()||(function xP(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;t.firstCreatePass||gd(e,n),Br(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const h=t.data[a],b=ys(h);b&&IP(n,e,h);const ee=md(n,t,a,e);Br(ee,n),null!==s&&MP(0,a-r,ee,h,0,s),b&&(ko(e.index,n)[8]=ee)}}(t,n,e,Mo(e,n)),128==(128&e.flags)&&function wP(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function WM(){return kn.lFrame.currentDirectiveIndex}();try{Ya(o);for(let a=i;a<r;a++){const h=t.data[a],b=n[a];om(a),(null!==h.hostBindings||0!==h.hostVars||null!==h.hostAttrs)&&Dy(h,b)}}finally{Ya(-1),om(s)}}(t,n,e))}function y_(t,n,e=Mo){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function Ey(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=C_(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function C_(t,n,e,i,r,o,s,a,h,b){const ee=22+i,de=ee+r,_e=function mP(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:Pn);return e}(ee,de),Ce="function"==typeof b?b():b;return _e[1]={type:t,blueprint:_e,template:e,queries:null,viewQuery:a,declTNode:n,data:_e.slice().fill(null,ee),bindingStartIndex:ee,expandoStartIndex:de,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:h,consts:Ce,incompleteFirstPass:!1}}function Ty(t,n,e,i){const r=Fy(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&Ry(t).push(i,r.length-1))}function Sy(t,n,e){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(n,r):e[i]=[n,r]}return e}function Iy(t,n){const i=n.directiveEnd,r=t.data,o=n.attrs,s=[];let a=null,h=null;for(let b=n.directiveStart;b<i;b++){const ee=r[b],de=ee.inputs,_e=null===o||Xb(n)?null:kP(de,o);s.push(_e),a=Sy(de,b,a),h=Sy(ee.outputs,b,h)}null!==a&&(a.hasOwnProperty("class")&&(n.flags|=16),a.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=s,n.inputs=a,n.outputs=h}function No(t,n,e,i,r,o,s,a){const h=Mo(n,e);let ee,b=n.inputs;!a&&null!=b&&(ee=b[i])?(I_(t,e,ee,i,r),ih(n)&&My(e,n.index)):3&n.type&&(i=function vP(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(h,i,r))}function My(t,n){const e=ko(n,t);16&e[2]||(e[2]|=32)}function x_(t,n,e,i){let r=!1;if(f1()){const o=function EP(t,n,e){const i=t.directiveRegistry;let r=null;if(i)for(let o=0;o<i.length;o++){const s=i[o];Qb(e,s.selectors,!1)&&(r||(r=[]),ph(gd(e,n),t,s.type),ys(s)?(Ay(t,e),r.unshift(s)):r.push(s))}return r}(t,n,e),s=null===i?null:{"":-1};if(null!==o){r=!0,Py(e,t.data.length,o.length);for(let ee=0;ee<o.length;ee++){const de=o[ee];de.providersResolver&&de.providersResolver(de)}let a=!1,h=!1,b=au(t,n,o.length,null);for(let ee=0;ee<o.length;ee++){const de=o[ee];e.mergedAttrs=dh(e.mergedAttrs,de.hostAttrs),Ny(t,e,n,b,de),SP(b,de,s),null!==de.contentQueries&&(e.flags|=8),(null!==de.hostBindings||null!==de.hostAttrs||0!==de.hostVars)&&(e.flags|=128);const _e=de.type.prototype;!a&&(_e.ngOnChanges||_e.ngOnInit||_e.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),a=!0),!h&&(_e.ngOnChanges||_e.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),h=!0),b++}Iy(t,e)}s&&function TP(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new nt(-301,!1);i.push(n[r],o)}}}(e,i,s)}return e.mergedAttrs=dh(e.mergedAttrs,e.attrs),r}function ky(t,n,e,i,r,o){const s=o.hostBindings;if(s){let a=t.hostBindingOpCodes;null===a&&(a=t.hostBindingOpCodes=[]);const h=~n.index;(function CP(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(a)!=h&&a.push(h),a.push(i,r,s)}}function Dy(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function Ay(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function SP(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;ys(n)&&(e[""]=t)}}function Py(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function Ny(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=Ul(r.type)),s=new hd(o,ys(r),Ge);t.blueprint[i]=s,e[i]=s,ky(t,n,0,i,au(t,e,r.hostVars,Pn),r)}function IP(t,n,e){const i=Mo(n,t),r=Ey(e),o=t[10],s=jh(t,Bh(t,r,null,e.onPush?32:16,i,n,o,o.createRenderer(i,e),null,null,null));t[n.index]=s}function Vs(t,n,e,i,r,o){const s=Mo(t,n);!function w_(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?Vt(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[11],s,o,t.value,e,i,r)}function MP(t,n,e,i,r,o){const s=o[n];if(null!==s){const a=i.setInput;for(let h=0;h<s.length;){const b=s[h++],ee=s[h++],de=s[h++];null!==a?i.setInput(e,de,b,ee):e[ee]=de}}}function kP(t,n){let e=null,i=0;for(;i<n.length;){const r=n[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,t[r],n[i+1])),i+=2}else i+=2;else i+=4}return e}function Oy(t,n,e,i){return new Array(t,!0,!1,n,null,0,i,e,null,null)}function PP(t,n){const e=ko(n,t);if(sh(e)){const i=e[1];48&e[2]?zh(i,e,i.template,e[8]):e[5]>0&&E_(e)}}function E_(t){for(let i=Am(t);null!==i;i=Pm(i))for(let r=10;r<i.length;r++){const o=i[r];if(sh(o))if(512&o[2]){const s=o[1];zh(s,o,s.template,o[8])}else o[5]>0&&E_(o)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=ko(e[i],t);sh(r)&&r[5]>0&&E_(r)}}function NP(t,n){const e=ko(n,t),i=e[1];(function OP(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),v_(i,e,e[8])}function jh(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function T_(t){for(;t;){t[2]|=32;const n=Td(t);if(EM(t)&&!n)return t;t=n}return null}function Uh(t,n,e,i=!0){const r=n[10];r.begin&&r.begin();try{zh(t,n,t.template,e)}catch(s){throw i&&By(n,s),s}finally{r.end&&r.end()}}function S_(t,n,e){am(0),n(t,e)}function Fy(t){return t[7]||(t[7]=[])}function Ry(t){return t.cleanup||(t.cleanup=[])}function By(t,n){const e=t[9],i=e?e.get(iu,null):null;i&&i.handleError(n)}function I_(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],h=n[s],b=t.data[s];null!==b.setInput?b.setInput(h,r,i,a):h[a]=r}}function xa(t,n,e){const i=oh(n,t);!function ub(t,n,e){t.setValue(n,e)}(t[11],i,e)}function Hh(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=lt(r,a):2==o&&(i=lt(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}function Vh(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];if(null!==o&&i.push(tr(o)),bs(o))for(let a=10;a<o.length;a++){const h=o[a],b=h[1].firstChild;null!==b&&Vh(h[1],h,b,i)}const s=e.type;if(8&s)Vh(t,n,e.child,i);else if(32&s){const a=Dm(e,n);let h;for(;h=a();)i.push(h)}else if(16&s){const a=yb(n,e);if(Array.isArray(a))i.push(...a);else{const h=Td(n[16]);Vh(h[1],h,a,i,!0)}}e=r?e.projectionNext:e.next}return i}class Dd{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return Vh(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 128==(128&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(bs(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(Fm(n,i),mh(e,i))}this._attachedToViewContainer=!1}fb(this._lView[1],this._lView)}onDestroy(n){Ty(this._lView[1],this._lView,null,n)}markForCheck(){T_(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-65}reattach(){this._lView[2]|=64}detectChanges(){Uh(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new nt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function hD(t,n){Sd(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new nt(902,!1);this._appRef=n}}class FP extends Dd{constructor(n){super(n),this._view=n}detectChanges(){const n=this._view;Uh(n[1],n,n[8],!1)}checkNoChanges(){}get context(){return null}}class M_ extends Ah{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=hi(n);return new Ad(e,this.ngModule)}}function zy(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class LP{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){const r=this.injector.get(n,t_,i);return r!==t_||e===t_?r:this.parentInjector.get(n,e,i)}}class Ad extends qb{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function FA(t){return t.map(OA).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return zy(this.componentDef.inputs)}get outputs(){return zy(this.componentDef.outputs)}create(n,e,i,r){let o=(r=r||this.ngModule)instanceof eu?r:r?.injector;o&&null!==this.componentDef.getStandaloneInjector&&(o=this.componentDef.getStandaloneInjector(o)||o);const s=o?new LP(n,o):n,a=s.get(kd,null);if(null===a)throw new nt(407,!1);const h=s.get(mA,null),b=a.createRenderer(null,this.componentDef),ee=this.componentDef.selectors[0][0]||"div",de=i?function _P(t,n,e){return t.selectRootElement(n,e===$s.ShadowDom)}(b,i,this.componentDef.encapsulation):Om(b,ee,function RP(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(ee)),_e=this.componentDef.onPush?288:272,Ce=C_(0,null,null,1,0,null,null,null,null,null),Se=Bh(null,Ce,null,_e,null,null,a,b,h,s,null);let Pe,Ne;lm(Se);try{const je=function jP(t,n,e,i,r,o){const s=e[1];e[22]=t;const h=su(s,22,2,"#host",null),b=h.mergedAttrs=n.hostAttrs;null!==b&&(Hh(h,b,!0),null!==t&&(uh(r,t,b),null!==h.classes&&Um(r,t,h.classes),null!==h.styles&&xb(r,t,h.styles)));const ee=i.createRenderer(t,n),de=Bh(e,Ey(n),null,n.onPush?32:16,e[22],h,i,ee,o||null,null,null);return s.firstCreatePass&&(ph(gd(h,e),s,n.type),Ay(s,h),Py(h,e.length,1)),jh(e,de),e[22]=de}(de,this.componentDef,Se,a,b);if(de)if(i)uh(b,de,["ng-version",_A.full]);else{const{attrs:He,classes:Ue}=function RA(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!xs(r))break;r=o}i++}return{attrs:n,classes:e}}(this.componentDef.selectors[0]);He&&uh(b,de,He),Ue&&Ue.length>0&&Um(b,de,Ue.join(" "))}if(Ne=tm(Ce,22),void 0!==e){const He=Ne.projection=[];for(let Ue=0;Ue<this.ngContentSelectors.length;Ue++){const We=e[Ue];He.push(null!=We?Array.from(We):null)}}Pe=function UP(t,n,e,i){const r=e[1],o=function yP(t,n,e){const i=ar();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Ny(t,i,n,au(t,n,1,null),e),Iy(t,i));const r=md(n,t,i.directiveStart,i);Br(r,n);const o=Mo(i,n);return o&&Br(o,n),r}(r,e,n);if(t[8]=e[8]=o,null!==i)for(const a of i)a(o,n);if(n.contentQueries){const a=ar();n.contentQueries(1,o,a.directiveStart)}const s=ar();return!r.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Ya(s.index),ky(e[1],s,0,s.directiveStart,s.directiveEnd,n),Dy(n,o)),o}(je,this.componentDef,Se,[HP]),v_(Ce,Se,null)}finally{cm()}return new zP(this.componentType,Pe,nu(Ne,Se),Se,Ne)}}class zP extends class uA{}{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.instance=e,this.hostView=this.changeDetectorRef=new FP(r),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){const o=this._rootLView;I_(o[1],o,r,n,e),My(o,this._tNode.index)}}get injector(){return new Gc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function HP(){const t=ar();ah(At()[1],t)}function pi(t){let n=function jy(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(ys(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new nt(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=k_(t.inputs),s.declaredInputs=k_(t.declaredInputs),s.outputs=k_(t.outputs);const a=r.hostBindings;a&&WP(t,a);const h=r.viewQuery,b=r.contentQueries;if(h&&GP(t,h),b&&qP(t,b),qe(t.inputs,r.inputs),qe(t.declaredInputs,r.declaredInputs),qe(t.outputs,r.outputs),ys(r)&&r.data.animation){const ee=t.data;ee.animation=(ee.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===pi&&(e=!1)}}n=Object.getPrototypeOf(n)}!function VP(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=dh(r.hostAttrs,e=dh(e,r.hostAttrs))}}(i)}function k_(t){return t===Fc?{}:t===li?[]:t}function GP(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function qP(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function WP(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}let Gh=null;function Kl(){if(!Gh){const t=xi.Symbol;if(t&&t.iterator)Gh=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const i=n[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Gh=i)}}}return Gh}function Pd(t){return!!D_(t)&&(Array.isArray(t)||!(t instanceof Map)&&Kl()in t)}function D_(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function Gs(t,n,e){return t[n]=e}function Nd(t,n){return t[n]}function zr(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function Yl(t,n,e,i){const r=zr(t,n,e);return zr(t,n+1,i)||r}function qh(t,n,e,i,r){const o=Yl(t,n,e,i);return zr(t,n+2,r)||o}function Jo(t,n,e,i,r,o){const s=Yl(t,n,e,i);return Yl(t,n+2,r,o)||s}function rn(t,n,e,i){const r=At();return zr(r,Uc(),n)&&(ni(),Vs(ji(),r,t,n,e,i)),rn}function cu(t,n,e,i){return zr(t,Uc(),e)?n+Vt(e)+i:Pn}function uu(t,n,e,i,r,o){const a=Yl(t,function _a(){return kn.lFrame.bindingIndex}(),e,r);return $a(2),a?n+Vt(e)+i+Vt(r)+o:Pn}function A_(t,n,e,i,r,o){const s=At(),a=cu(s,n,e,i);return a!==Pn&&Vs(ji(),s,t,a,r,o),A_}function Te(t,n,e,i,r,o,s,a){const h=At(),b=ni(),ee=t+22,de=b.firstCreatePass?function t4(t,n,e,i,r,o,s,a,h){const b=n.consts,ee=su(n,t,4,s||null,Ka(b,a));x_(n,e,ee,Ka(b,h)),ah(n,ee);const de=ee.tViews=C_(2,ee,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,b);return null!==n.queries&&(n.queries.template(n,ee),de.queries=n.queries.embeddedTView(ee)),ee}(ee,b,h,n,e,i,r,o,s):b.data[ee];js(de,!1);const _e=h[11].createComment("");wh(b,h,_e,de),Br(_e,h),jh(h,h[ee]=Oy(_e,h,_e,de)),rh(de)&&b_(b,h,de),null!=s&&y_(h,de,a)}function dn(t){return jc(function VM(){return kn.lFrame.contextLView}(),22+t)}function ie(t,n,e){const i=At();return zr(i,Uc(),n)&&No(ni(),ji(),i,t,n,i[11],e,!1),ie}function P_(t,n,e,i,r){const s=r?"class":"style";I_(t,e,n.inputs[s],s,i)}function Z(t,n,e,i){const r=At(),o=ni(),s=22+t,a=r[11],h=r[s]=Om(a,n,function tk(){return kn.lFrame.currentNamespace}()),b=o.firstCreatePass?function i4(t,n,e,i,r,o,s){const a=n.consts,b=su(n,t,2,r,Ka(a,o));return x_(n,e,b,Ka(a,s)),null!==b.attrs&&Hh(b,b.attrs,!1),null!==b.mergedAttrs&&Hh(b,b.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,b),b}(s,o,r,0,n,e,i):o.data[s];js(b,!0);const ee=b.mergedAttrs;null!==ee&&uh(a,h,ee);const de=b.classes;null!==de&&Um(a,h,de);const _e=b.styles;return null!==_e&&xb(a,h,_e),64!=(64&b.flags)&&wh(o,r,h,b),0===function BM(){return kn.lFrame.elementDepthCount}()&&Br(h,r),function zM(){kn.lFrame.elementDepthCount++}(),rh(b)&&(b_(o,r,b),wy(o,b,r)),null!==i&&y_(r,b),Z}function ne(){let t=ar();im()?rm():(t=t.parent,js(t,!1));const n=t;!function jM(){kn.lFrame.elementDepthCount--}();const e=ni();return e.firstCreatePass&&(ah(e,t),Zg(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function sk(t){return 0!=(16&t.flags)}(n)&&P_(e,n,At(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function ak(t){return 0!=(32&t.flags)}(n)&&P_(e,n,At(),n.stylesWithoutHost,!1),ne}function vt(t,n,e,i){return Z(t,n,e,i),ne(),vt}function it(t,n,e){const i=At(),r=ni(),o=t+22,s=r.firstCreatePass?function r4(t,n,e,i,r){const o=n.consts,s=Ka(o,i),a=su(n,t,8,"ng-container",s);return null!==s&&Hh(a,s,!0),x_(n,e,a,Ka(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];js(s,!0);const a=i[o]=i[11].createComment("");return wh(r,i,a,s),Br(a,i),rh(s)&&(b_(r,i,s),wy(r,s,i)),null!=e&&y_(i,s),it}function rt(){let t=ar();const n=ni();return im()?rm():(t=t.parent,js(t,!1)),n.firstCreatePass&&(ah(n,t),Zg(t)&&n.queries.elementEnd(t)),rt}function An(t,n,e){return it(t,n,e),rt(),An}function gt(){return At()}function Wh(t){return!!t&&"function"==typeof t.then}const Xy=function Zy(t){return!!t&&"function"==typeof t.subscribe};function Ae(t,n,e,i){const r=At(),o=ni(),s=ar();return function Jy(t,n,e,i,r,o,s,a){const h=rh(i),ee=t.firstCreatePass&&Ry(t),de=n[8],_e=Fy(n);let Ce=!0;if(3&i.type||a){const Ne=Mo(i,n),je=a?a(Ne):Ne,He=_e.length,Ue=a?mt=>a(tr(mt[i.index])):i.index;let We=null;if(!a&&h&&(We=function o4(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[7],h=r[o+2];return a.length>h?a[h]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==We)(We.__ngLastListenerFn__||We).__ngNextListenerFn__=o,We.__ngLastListenerFn__=o,Ce=!1;else{o=tC(i,n,de,o,!1);const mt=e.listen(je,r,o);_e.push(o,mt),ee&&ee.push(r,Ue,He,He+1)}}else o=tC(i,n,de,o,!1);const Se=i.outputs;let Pe;if(Ce&&null!==Se&&(Pe=Se[r])){const Ne=Pe.length;if(Ne)for(let je=0;je<Ne;je+=2){const Xe=n[Pe[je]][Pe[je+1]].subscribe(o),ct=_e.length;_e.push(o,Xe),ee&&ee.push(r,i.index,ct,-(ct+1))}}}(o,r,r[11],s,t,n,0,i),Ae}function eC(t,n,e,i){try{return!1!==e(i)}catch(r){return By(t,r),!1}}function tC(t,n,e,i,r){return function o(s){if(s===Function)return i;T_(2&t.flags?ko(t.index,n):n);let h=eC(n,0,i,s),b=o.__ngNextListenerFn__;for(;b;)h=eC(n,0,b,s)&&h,b=b.__ngNextListenerFn__;return r&&!1===h&&(s.preventDefault(),s.returnValue=!1),h}}function ge(t=1){return function YM(t){return(kn.lFrame.contextLView=function ZM(t,n){for(;t>0;)n=n[15],t--;return n}(t,kn.lFrame.contextLView))[8]}(t)}function s4(t,n){let e=null;const i=function DA(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(0==(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?Qb(t,o,!0):NA(i,o))return r}else e=r}return e}function N_(t){const n=At()[16][6];if(!n.projection){const i=n.projection=vd(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?s4(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function O_(t,n=0,e){const i=At(),r=ni(),o=su(r,22+t,16,null,e||null);null===o.projection&&(o.projection=n),rm(),64!=(64&o.flags)&&function yD(t,n,e){Cb(n[11],0,n,e,hb(t,e,n),_b(e.parent||n[6],e,n))}(r,i,o)}function Mt(t,n,e){return ur(t,"",n,"",e),Mt}function ur(t,n,e,i,r){const o=At(),s=cu(o,n,e,i);return s!==Pn&&No(ni(),ji(),o,t,s,o[11],r,!1),ur}function uC(t,n,e,i,r){const o=t[e+1],s=null===n;let a=i?Es(o):Ca(o),h=!1;for(;0!==a&&(!1===h||s);){const ee=t[a+1];c4(t[a],n)&&(h=!0,t[a+1]=i?u_(ee):l_(ee)),a=i?Es(ee):Ca(ee)}h&&(t[e+1]=i?l_(o):u_(o))}function c4(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Zc(t,n)>=0}const dr={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function dC(t){return t.substring(dr.key,dr.keyEnd)}function u4(t){return t.substring(dr.value,dr.valueEnd)}function fC(t,n){const e=dr.textEnd;return e===n?-1:(n=dr.keyEnd=function h4(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,dr.key=n,e),_u(t,n,e))}function hC(t,n){const e=dr.textEnd;let i=dr.key=_u(t,n,e);return e===i?-1:(i=dr.keyEnd=function p4(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=gC(t,i,e),i=dr.value=_u(t,i,e),i=dr.valueEnd=function g4(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const h=t.charCodeAt(s++);if(59===h)return a;34===h||39===h?a=s=mC(t,h,s,e):n===s-4&&85===o&&82===r&&76===i&&40===h?a=s=mC(t,41,s,e):h>32&&(a=s),o=r,r=i,i=-33&h}return a}(t,i,e),gC(t,i,e))}function pC(t){dr.key=0,dr.keyEnd=0,dr.value=0,dr.valueEnd=0,dr.textEnd=t.length}function _u(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function gC(t,n,e,i){return(n=_u(t,n,e))<e&&n++,n}function mC(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function pt(t,n,e){return Ts(t,n,e,!1),pt}function Kh(t,n){return Ts(t,n,null,!0),Kh}function Mr(t){Ss(vC,m4,t,!1)}function m4(t,n){for(let e=function f4(t){return pC(t),hC(t,_u(t,0,dr.textEnd))}(n);e>=0;e=hC(n,e))vC(t,dC(n),u4(n))}function Od(t){Ss(Ao,qs,t,!0)}function qs(t,n){for(let e=function d4(t){return pC(t),fC(t,_u(t,0,dr.textEnd))}(n);e>=0;e=fC(n,e))Ao(t,dC(n),!0)}function Ts(t,n,e,i){const r=At(),o=ni(),s=$a(2);o.firstUpdatePass&&$C(o,t,s,i),n!==Pn&&zr(r,s,n)&&bC(o,o.data[eo()],r,r[11],t,r[s+1]=function x4(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Qe(Po(t)))),t}(n,e),i,s)}function Ss(t,n,e,i){const r=ni(),o=$a(2);r.firstUpdatePass&&$C(r,null,o,i);const s=At();if(e!==Pn&&zr(s,o,e)){const a=r.data[eo()];if(CC(a,i)&&!_C(r,o)){let h=i?a.classesWithoutHost:a.stylesWithoutHost;null!==h&&(e=lt(h,e||"")),P_(r,a,s,e,i)}else!function C4(t,n,e,i,r,o,s,a){r===Pn&&(r=li);let h=0,b=0,ee=0<r.length?r[0]:null,de=0<o.length?o[0]:null;for(;null!==ee||null!==de;){const _e=h<r.length?r[h+1]:void 0,Ce=b<o.length?o[b+1]:void 0;let Pe,Se=null;ee===de?(h+=2,b+=2,_e!==Ce&&(Se=de,Pe=Ce)):null===de||null!==ee&&ee<de?(h+=2,Se=ee):(b+=2,Se=de,Pe=Ce),null!==Se&&bC(t,n,e,i,Se,Pe,s,a),ee=h<r.length?r[h]:null,de=b<o.length?o[b]:null}}(r,a,s,s[11],s[o+1],s[o+1]=function y4(t,n,e){if(null==e||""===e)return li;const i=[],r=Po(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}function _C(t,n){return n>=t.expandoStartIndex}function $C(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[eo()],s=_C(t,e);CC(o,i)&&null===n&&!s&&(n=!1),n=function _4(t,n,e,i){const r=function sm(t){const n=kn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=Fd(e=F_(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=F_(r,t,n,e,i),null===o){let h=function $4(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==Ca(i))return t[Es(i)]}(t,n,i);void 0!==h&&Array.isArray(h)&&(h=F_(null,t,n,h[1],i),h=Fd(h,n.attrs,i),function v4(t,n,e,i){t[Es(e?n.classBindings:n.styleBindings)]=i}(t,n,i,h))}else o=function b4(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=Fd(i,t[o].hostAttrs,e);return Fd(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function a4(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=Es(s),h=Ca(s);t[i]=e;let ee,b=!1;if(Array.isArray(e)){const de=e;ee=de[1],(null===ee||Zc(de,ee)>0)&&(b=!0)}else ee=e;if(r)if(0!==h){const _e=Es(t[a+1]);t[i+1]=Fh(_e,a),0!==_e&&(t[_e+1]=c_(t[_e+1],i)),t[a+1]=function iP(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Fh(a,0),0!==a&&(t[a+1]=c_(t[a+1],i)),a=i;else t[i+1]=Fh(h,0),0===a?a=i:t[h+1]=c_(t[h+1],i),h=i;b&&(t[i+1]=l_(t[i+1])),uC(t,ee,i,!0),uC(t,ee,i,!1),function l4(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&Zc(o,n)>=0&&(e[i+1]=u_(e[i+1]))}(n,ee,t,i,o),s=Fh(a,h),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function F_(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=Fd(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function Fd(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Ao(t,s,!!e||n[++o]))}return void 0===t?null:t}function vC(t,n,e){Ao(t,n,Po(e))}function bC(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const h=t.data,b=h[a+1];Yh(function py(t){return 1==(1&t)}(b)?yC(h,n,e,r,Ca(b),s):void 0)||(Yh(o)||function hy(t){return 2==(2&t)}(b)&&(o=yC(h,null,e,r,a,s)),function xD(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:mo.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=mo.Important),t.setStyle(e,i,r,o))}}(i,s,oh(eo(),e),r,o))}function yC(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const h=t[r],b=Array.isArray(h),ee=b?h[1]:h,de=null===ee;let _e=e[r+1];_e===Pn&&(_e=de?li:void 0);let Ce=de?vm(_e,i):ee===i?_e:void 0;if(b&&!Yh(Ce)&&(Ce=vm(h,i)),Yh(Ce)&&(a=Ce,s))return a;const Se=t[r+1];r=s?Es(Se):Ca(Se)}if(null!==n){let h=o?n.residualClasses:n.residualStyles;null!=h&&(a=vm(h,i))}return a}function Yh(t){return void 0!==t}function CC(t,n){return 0!=(t.flags&(n?16:32))}function $e(t,n=""){const e=At(),i=ni(),r=t+22,o=i.firstCreatePass?su(i,r,1,n,null):i.data[r],s=e[r]=function Nm(t,n){return t.createText(n)}(e[11],n);wh(i,e,s,o),js(o,!1)}function dt(t){return Zn("",t,""),dt}function Zn(t,n,e){const i=At(),r=cu(i,t,n,e);return r!==Pn&&xa(i,eo(),r),Zn}function Ja(t,n,e,i,r){const o=At(),s=uu(o,t,n,e,i,r);return s!==Pn&&xa(o,eo(),s),Ja}const Zl=void 0;var H4=["en",[["a","p"],["AM","PM"],Zl],[["AM","PM"],Zl,Zl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Zl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Zl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Zl,"{1} 'at' {0}",Zl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function U4(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let $u={};function no(t){const n=function V4(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=UC(n);if(e)return e;const i=n.split("-")[0];if(e=UC(i),e)return e;if("en"===i)return H4;throw new nt(701,!1)}function UC(t){return t in $u||($u[t]=xi.ng&&xi.ng.common&&xi.ng.common.locales&&xi.ng.common.locales[t]),$u[t]}var Zt=(()=>((Zt=Zt||{})[Zt.LocaleId=0]="LocaleId",Zt[Zt.DayPeriodsFormat=1]="DayPeriodsFormat",Zt[Zt.DayPeriodsStandalone=2]="DayPeriodsStandalone",Zt[Zt.DaysFormat=3]="DaysFormat",Zt[Zt.DaysStandalone=4]="DaysStandalone",Zt[Zt.MonthsFormat=5]="MonthsFormat",Zt[Zt.MonthsStandalone=6]="MonthsStandalone",Zt[Zt.Eras=7]="Eras",Zt[Zt.FirstDayOfWeek=8]="FirstDayOfWeek",Zt[Zt.WeekendRange=9]="WeekendRange",Zt[Zt.DateFormat=10]="DateFormat",Zt[Zt.TimeFormat=11]="TimeFormat",Zt[Zt.DateTimeFormat=12]="DateTimeFormat",Zt[Zt.NumberSymbols=13]="NumberSymbols",Zt[Zt.NumberFormats=14]="NumberFormats",Zt[Zt.CurrencyCode=15]="CurrencyCode",Zt[Zt.CurrencySymbol=16]="CurrencySymbol",Zt[Zt.CurrencyName=17]="CurrencyName",Zt[Zt.Currencies=18]="Currencies",Zt[Zt.Directionality=19]="Directionality",Zt[Zt.PluralCase=20]="PluralCase",Zt[Zt.ExtraData=21]="ExtraData",Zt))();const vu="en-US";let HC=vu;function B_(t,n,e,i,r){if(t=$t(t),Array.isArray(t))for(let o=0;o<t.length;o++)B_(t[o],n,e,i,r);else{const o=ni(),s=At();let a=ql(t)?t:$t(t.provide),h=Gb(t);const b=ar(),ee=1048575&b.providerIndexes,de=b.directiveStart,_e=b.providerIndexes>>20;if(ql(t)||!t.multi){const Ce=new hd(h,r,Ge),Se=j_(a,n,r?ee:ee+_e,de);-1===Se?(ph(gd(b,s),o,a),z_(o,t,n.length),n.push(a),b.directiveStart++,b.directiveEnd++,r&&(b.providerIndexes+=1048576),e.push(Ce),s.push(Ce)):(e[Se]=Ce,s[Se]=Ce)}else{const Ce=j_(a,n,ee+_e,de),Se=j_(a,n,ee,ee+_e),Pe=Ce>=0&&e[Ce],Ne=Se>=0&&e[Se];if(r&&!Ne||!r&&!Pe){ph(gd(b,s),o,a);const je=function jN(t,n,e,i,r){const o=new hd(t,e,Ge);return o.multi=[],o.index=n,o.componentProviders=0,px(o,r,i&&!e),o}(r?zN:BN,e.length,r,i,h);!r&&Ne&&(e[Se].providerFactory=je),z_(o,t,n.length,0),n.push(a),b.directiveStart++,b.directiveEnd++,r&&(b.providerIndexes+=1048576),e.push(je),s.push(je)}else z_(o,t,Ce>-1?Ce:Se,px(e[r?Se:Ce],h,!r&&i));!r&&i&&Ne&&e[Se].componentProviders++}}}function z_(t,n,e,i){const r=ql(n),o=function nA(t){return!!t.useClass}(n);if(r||o){const h=(o?$t(n.useClass):n).prototype.ngOnDestroy;if(h){const b=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const ee=b.indexOf(e);-1===ee?b.push(e,[i,h]):b[ee+1].push(i,h)}else b.push(e,h)}}}function px(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function j_(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function BN(t,n,e,i){return U_(this.multi,[])}function zN(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=md(e,e[1],this.providerFactory.index,i);o=a.slice(0,s),U_(r,o);for(let h=s;h<a.length;h++)o.push(a[h])}else o=[],U_(r,o);return o}function U_(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function Ti(t,n=[]){return e=>{e.providersResolver=(i,r)=>function LN(t,n,e){const i=ni();if(i.firstCreatePass){const r=ys(t);B_(e,i.data,i.blueprint,r,!0),B_(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class bu{}class gx extends bu{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new M_(this);const i=function So(t,n){const e=t[t1]||null;if(!e&&!0===n)throw new Error(`Type ${Qe(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function ya(t){return t instanceof Function?t():t}(i.bootstrap),this._r3Injector=oy(n,e,[{provide:bu,useValue:this},{provide:Ah,useValue:this.componentFactoryResolver}],Qe(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class H_ extends class UN{}{constructor(n){super(),this.moduleType=n}create(n){return new gx(this.moduleType,n)}}function wa(t,n,e){const i=Jr()+t,r=At();return r[i]===Pn?Gs(r,i,e?n.call(e):n()):Nd(r,i)}function wt(t,n,e,i){return function xx(t,n,e,i,r,o){const s=n+e;return zr(t,s,r)?Gs(t,s+1,o?i.call(o,r):i(r)):Ud(t,s+1)}(At(),Jr(),t,n,e,i)}function fn(t,n,e,i,r){return wx(At(),Jr(),t,n,e,i,r)}function _o(t,n,e,i,r,o){return function Ex(t,n,e,i,r,o,s,a){const h=n+e;return qh(t,h,r,o,s)?Gs(t,h+3,a?i.call(a,r,o,s):i(r,o,s)):Ud(t,h+3)}(At(),Jr(),t,n,e,i,r,o)}function Is(t,n,e,i,r,o,s){return function Tx(t,n,e,i,r,o,s,a,h){const b=n+e;return Jo(t,b,r,o,s,a)?Gs(t,b+4,h?i.call(h,r,o,s,a):i(r,o,s,a)):Ud(t,b+4)}(At(),Jr(),t,n,e,i,r,o,s)}function G_(t,n,e,i,r,o,s,a,h){const b=Jr()+t,ee=At(),de=Jo(ee,b,e,i,r,o);return Yl(ee,b+4,s,a)||de?Gs(ee,b+6,h?n.call(h,e,i,r,o,s,a):n(e,i,r,o,s,a)):Nd(ee,b+6)}function yu(t,n,e,i,r,o,s,a,h,b){const ee=Jr()+t,de=At();let _e=Jo(de,ee,e,i,r,o);return qh(de,ee+4,s,a,h)||_e?Gs(de,ee+7,b?n.call(b,e,i,r,o,s,a,h):n(e,i,r,o,s,a,h)):Nd(de,ee+7)}function Ms(t,n,e,i,r,o,s,a,h,b,ee){const de=Jr()+t,_e=At(),Ce=Jo(_e,de,e,i,r,o);return Jo(_e,de+4,s,a,h,b)||Ce?Gs(_e,de+8,ee?n.call(ee,e,i,r,o,s,a,h,b):n(e,i,r,o,s,a,h,b)):Nd(_e,de+8)}function Ud(t,n){const e=t[n];return e===Pn?void 0:e}function wx(t,n,e,i,r,o,s){const a=n+e;return Yl(t,a,r,o)?Gs(t,a+2,s?i.call(s,r,o):i(r,o)):Ud(t,a+2)}function zt(t,n){const e=ni();let i;const r=t+22;e.firstCreatePass?(i=function i5(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=Ul(i.type)),s=Yo(Ge);try{const a=fh(!1),h=o();return fh(a),function n4(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,At(),r,h),h}finally{Yo(s)}}function jt(t,n,e,i){const r=t+22,o=At(),s=jc(o,r);return function Hd(t,n){return t[1].data[n].pure}(o,r)?wx(o,Jr(),n,s.transform,e,i,s):s.transform(e,i)}function q_(t){return n=>{setTimeout(t,void 0,n)}}const Gn=class l5 extends u{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const h=n;r=h.next?.bind(h),o=h.error?.bind(h),s=h.complete?.bind(h)}this.__isAsync&&(o=q_(o),r&&(r=q_(r)),s&&(s=q_(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof x&&n.add(a),a}};function c5(){return this._results[Kl()]()}class W_{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=Kl(),i=W_.prototype;i[e]||(i[e]=c5)}get changes(){return this._changes||(this._changes=new Gn)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=Do(n);(this._changesDetected=!function _k(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Ea=(()=>{class t{}return t.__NG_ELEMENT_ID__=f5,t})();const u5=Ea,d5=class extends u5{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n,e){const i=this._declarationTContainer.tViews,r=Bh(this._declarationLView,i,n,16,null,i.declTNode,null,null,null,null,e||null);r[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(r[19]=s.createEmbeddedView(i)),v_(i,r,n),new Dd(r)}};function f5(){return ep(ar(),At())}function ep(t,n){return 4&t.type?new d5(n,t,nu(t,n)):null}let io=(()=>{class t{}return t.__NG_ELEMENT_ID__=h5,t})();function h5(){return kx(ar(),At())}const p5=io,Ix=class extends p5{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return nu(this._hostTNode,this._hostLView)}get injector(){return new Gc(this._hostTNode,this._hostLView)}get parentInjector(){const n=hh(this._hostTNode,this._hostLView);if(S1(n)){const e=Vc(n,this._hostLView),i=Hc(n);return new Gc(e[1].data[i+8],e)}return new Gc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=Mx(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=n.createEmbeddedView(e||{},o);return this.insert(s,r),s}createComponent(n,e,i,r,o){const s=n&&!function $d(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const de=e||{};a=de.index,i=de.injector,r=de.projectableNodes,o=de.environmentInjector||de.ngModuleRef}const h=s?n:new Ad(hi(n)),b=i||this.parentInjector;if(!o&&null==h.ngModule){const _e=(s?b:this.parentInjector).get(eu,null);_e&&(o=_e)}const ee=h.create(b,r,void 0,o);return this.insert(ee.hostView,a),ee}insert(n,e){const i=n._lView,r=i[1];if(function LM(t){return bs(t[3])}(i)){const ee=this.indexOf(n);if(-1!==ee)this.detach(ee);else{const de=i[3],_e=new Ix(de,de[6],de[3]);_e.detach(_e.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;!function gD(t,n,e,i){const r=10+i,o=e.length;i>0&&(e[r-1][4]=n),i<o-10?(n[4]=e[r],L1(e,10+i,n)):(e.push(n),n[4]=null),n[3]=e;const s=n[17];null!==s&&e!==s&&function mD(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(s,n);const a=n[19];null!==a&&a.insertView(t),n[2]|=64}(r,i,s,o);const a=Bm(o,s),h=i[11],b=xh(h,s[7]);return null!==b&&function fD(t,n,e,i,r,o){i[0]=r,i[6]=n,Sd(t,i,e,1,r,o)}(r,s[6],h,i,b,a),n.attachToViewContainerRef(),L1(K_(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=Mx(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=Fm(this._lContainer,e);i&&(mh(K_(this._lContainer),e),fb(i[1],i))}detach(n){const e=this._adjustIndex(n,-1),i=Fm(this._lContainer,e);return i&&null!=mh(K_(this._lContainer),e)?new Dd(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function Mx(t){return t[8]}function K_(t){return t[8]||(t[8]=[])}function kx(t,n){let e;const i=n[t.index];if(bs(i))e=i;else{let r;if(8&t.type)r=tr(i);else{const o=n[11];r=o.createComment("");const s=Mo(t,n);Hl(o,xh(o,s),r,function bD(t,n){return t.nextSibling(n)}(o,s),!1)}n[t.index]=e=Oy(i,n,r,t),jh(n,e)}return new Ix(e,t,n)}class Y_{constructor(n){this.queryList=n,this.matches=null}clone(){return new Y_(this.queryList)}setDirty(){this.queryList.setDirty()}}class Z_{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new Z_(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==Ox(n,e).matches&&this.queries[e].setDirty()}}class Dx{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class X_{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new X_(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class Q_{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new Q_(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,_5(e,o)),this.matchTNodeWithReadOption(n,e,gh(e,n,o,!1,!1))}else i===Ea?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,gh(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===Ai||r===io||r===Ea&&4&e.type)this.addMatch(e.index,-2);else{const o=gh(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function _5(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function v5(t,n,e,i){return-1===e?function $5(t,n){return 11&t.type?nu(t,n):4&t.type?ep(t,n):null}(n,t):-2===e?function b5(t,n,e){return e===Ai?nu(n,t):e===Ea?ep(n,t):e===io?kx(n,t):void 0}(t,n,i):md(t,t[1],e,n)}function Ax(t,n,e,i){const r=n[19].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let h=0;h<s.length;h+=2){const b=s[h];a.push(b<0?null:v5(n,o[b],s[h+1],e.metadata.read))}r.matches=a}return r.matches}function J_(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=Ax(t,n,r,e);for(let a=0;a<o.length;a+=2){const h=o[a];if(h>0)i.push(s[a/2]);else{const b=o[a+1],ee=n[-h];for(let de=10;de<ee.length;de++){const _e=ee[de];_e[17]===_e[3]&&J_(_e[1],_e,b,i)}if(null!==ee[9]){const de=ee[9];for(let _e=0;_e<de.length;_e++){const Ce=de[_e];J_(Ce[1],Ce,b,i)}}}}}return i}function En(t){const n=At(),e=ni(),i=_1();am(i+1);const r=Ox(e,i);if(t.dirty&&function RM(t){return 4==(4&t[2])}(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const o=r.crossesNgTemplate?J_(e,n,i,[]):Ax(e,n,r,i);t.reset(o,pA),t.notifyOnChanges()}return!0}return!1}function Tn(t,n,e){const i=ni();i.firstCreatePass&&(function Nx(t,n,e){null===t.queries&&(t.queries=new X_),t.queries.track(new Q_(n,e))}(i,new Dx(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function Px(t,n,e){const i=new W_(4==(4&e));Ty(t,n,i,i.destroy),null===n[19]&&(n[19]=new Z_),n[19].queries.push(new Y_(i))}(i,At(),n)}function Sn(){return function C5(t,n){return t[19].queries[n].queryList}(At(),_1())}function Ox(t,n){return t.queries.getByIndex(n)}function Qn(t,n){return ep(t,n)}function np(...t){}const r$=new Dn("Application Initializer");let ip=(()=>{class t{constructor(e){this.appInits=e,this.resolve=np,this.reject=np,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const o=this.appInits[r]();if(Wh(o))e.push(o);else if(Xy(o)){const s=new Promise((a,h)=>{o.subscribe({complete:a,error:h})});e.push(s)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)($n(r$,8))},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Gd=new Dn("AppId",{providedIn:"root",factory:function e2(){return`${o$()}${o$()}${o$()}`}});function o$(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const t2=new Dn("Platform Initializer"),qd=new Dn("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),H5=new Dn("appBootstrapListener"),n2=new Dn("AnimationModuleType"),Ta=new Dn("LocaleId",{providedIn:"root",factory:()=>function kk(t,n=wn.Default){return"number"!=typeof n&&(n=0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)),$n(t,n)}(Ta,wn.Optional|wn.SkipSelf)||function V5(){return typeof $localize<"u"&&$localize.locale||vu}()}),Y5=(()=>Promise.resolve(0))();function s$(t){typeof Zone>"u"?Y5.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Fn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Gn(!1),this.onMicrotaskEmpty=new Gn(!1),this.onStable=new Gn(!1),this.onError=new Gn(!1),typeof Zone>"u")throw new nt(908,!1);Zone.assertZonePatched();const r=this;if(r._nesting=0,r._outer=r._inner=Zone.current,Zone.AsyncStackTaggingZoneSpec){const o=Zone.AsyncStackTaggingZoneSpec;r._inner=r._inner.fork(new o("Angular"))}Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function Z5(){let t=xi.requestAnimationFrame,n=xi.cancelAnimationFrame;if(typeof Zone<"u"&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function J5(t){const n=()=>{!function Q5(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(xi,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,l$(t),t.isCheckStableRunning=!0,a$(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),l$(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{try{return o2(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),s2(t)}},onInvoke:(e,i,r,o,s,a,h)=>{try{return o2(t),e.invoke(r,o,s,a,h)}finally{t.shouldCoalesceRunChangeDetection&&n(),s2(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,l$(t),a$(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Fn.isInAngularZone())throw new nt(909,!1)}static assertNotInAngularZone(){if(Fn.isInAngularZone())throw new nt(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,X5,np,np);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const X5={};function a$(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function l$(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function o2(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function s2(t){t._nesting--,a$(t)}class eO{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Gn,this.onMicrotaskEmpty=new Gn,this.onStable=new Gn,this.onError=new Gn}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}const a2=new Dn(""),rp=new Dn("");let d$,c$=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,d$||(function tO(t){d$=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Fn.assertNotInAngularZone(),s$(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())s$(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)($n(Fn),$n(u$),$n(rp))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})(),u$=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return d$?.findTestabilityInTree(this,e,i)??null}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})(),el=null;const l2=new Dn("AllowMultipleToken"),f$=new Dn("PlatformDestroyListeners");function u2(t,n,e=[]){const i=`Platform: ${n}`,r=new Dn(i);return(o=[])=>{let s=h$();if(!s||s.injector.get(l2,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function rO(t){if(el&&!el.get(l2,!1))throw new nt(400,!1);el=t;const n=t.get(f2);(function c2(t){const n=t.get(t2,null);n&&n.forEach(e=>e())})(t)}(function d2(t=[],n){return ws.create({name:n,providers:[{provide:Xm,useValue:"platform"},{provide:f$,useValue:new Set([()=>el=null])},...t]})}(a,i))}return function sO(t){const n=h$();if(!n)throw new nt(401,!1);return n}()}}function h$(){return el?.get(f2)??null}let f2=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function p2(t,n){let e;return e="noop"===t?new eO:("zone.js"===t?void 0:t)||new Fn(n),e}(i?.ngZone,function h2(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!t||!t.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!t||!t.ngZoneRunCoalescing)||!1}}(i)),o=[{provide:Fn,useValue:r}];return r.run(()=>{const s=ws.create({providers:o,parent:this.injector,name:e.moduleType.name}),a=e.create(s),h=a.injector.get(iu,null);if(!h)throw new nt(402,!1);return r.runOutsideAngular(()=>{const b=r.onError.subscribe({next:ee=>{h.handleError(ee)}});a.onDestroy(()=>{op(this._modules,a),b.unsubscribe()})}),function g2(t,n,e){try{const i=e();return Wh(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(h,r,()=>{const b=a.injector.get(ip);return b.runInitializers(),b.donePromise.then(()=>(function VC(t){Eo(t,"Expected localeId to be defined"),"string"==typeof t&&(HC=t.toLowerCase().replace(/_/g,"-"))}(a.injector.get(Ta,vu)||vu),this._moduleDoBootstrap(a),a))})})}bootstrapModule(e,i=[]){const r=m2({},i);return function nO(t,n,e){const i=new H_(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Wd);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new nt(403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new nt(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(f$,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)($n(ws))},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function m2(t,n){return Array.isArray(n)?n.reduce(m2,t):{...t,...n}}let Wd=(()=>{class t{constructor(e,i,r){this._zone=e,this._injector=i,this._exceptionHandler=r,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new F(a=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{a.next(this._stable),a.complete()})}),s=new F(a=>{let h;this._zone.runOutsideAngular(()=>{h=this._zone.onStable.subscribe(()=>{Fn.assertNotInAngularZone(),s$(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,a.next(!0))})})});const b=this._zone.onUnstable.subscribe(()=>{Fn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{a.next(!1)}))});return()=>{h.unsubscribe(),b.unsubscribe()}});this.isStable=ga(o,s.pipe(function Oc(t={}){const{connector:n=(()=>new u),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return o=>{let s,a,h,b=0,ee=!1,de=!1;const _e=()=>{a?.unsubscribe(),a=void 0},Ce=()=>{_e(),s=h=void 0,ee=de=!1},Se=()=>{const Pe=s;Ce(),Pe?.unsubscribe()};return C((Pe,Ne)=>{b++,!de&&!ee&&_e();const je=h=h??n();Ne.add(()=>{b--,0===b&&!de&&!ee&&(a=Be(Se,r))}),je.subscribe(Ne),!s&&b>0&&(s=new S({next:He=>je.next(He),error:He=>{de=!0,_e(),a=Be(Ce,e,He),je.error(He)},complete:()=>{ee=!0,_e(),a=Be(Ce,i),je.complete()}}),Cr(Pe).subscribe(s))})(o)}}()))}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof qb;if(!this._injector.get(ip).done)throw!r&&function ad(t){const n=hi(t)||Xr(t)||Qr(t);return null!==n&&n.standalone}(e),new nt(405,false);let s;s=r?e:this._injector.get(Ah).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function iO(t){return t.isBoundToModule}(s)?void 0:this._injector.get(bu),b=s.create(ws.NULL,[],i||s.selector,a),ee=b.location.nativeElement,de=b.injector.get(a2,null);return de?.registerApplication(ee),b.onDestroy(()=>{this.detachView(b.hostView),op(this.components,b),de?.unregisterApplication(ee)}),this._loadComponent(b),b}tick(){if(this._runningTick)throw new nt(101,!1);try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;op(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(H5,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>op(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new nt(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return t.\u0275fac=function(e){return new(e||t)($n(Fn),$n(eu),$n(iu))},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function op(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let $2=!0,Ki=(()=>{class t{}return t.__NG_ELEMENT_ID__=cO,t})();function cO(t){return function uO(t,n,e){if(ih(t)&&!e){const i=ko(t.index,n);return new Dd(i,i)}return 47&t.type?new Dd(n[16],n):null}(ar(),At(),16==(16&t))}class x2{constructor(){}supports(n){return Pd(n)}create(n){return new mO(n)}}const gO=(t,n)=>n;class mO{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||gO}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<E2(i,r,o)?e:i,a=E2(s,r,o),h=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const b=a-r,ee=h-r;if(b!=ee){for(let _e=0;_e<b;_e++){const Ce=_e<o.length?o[_e]:o[_e]=0,Se=Ce+_e;ee<=Se&&Se<b&&(o[_e]=Ce+1)}o[s.previousIndex]=ee-b}}a!==h&&n(s,a,h)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Pd(n))throw new nt(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function QP(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Kl()]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new _O(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new w2),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new w2),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class _O{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class $O{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class w2{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new $O,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function E2(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class T2{constructor(){}supports(n){return n instanceof Map||D_(n)}create(){return new vO}}class vO{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||D_(n)))throw new nt(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new bO(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class bO{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function S2(){return new lp([new x2])}let lp=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||S2()),deps:[[t,new bh,new vh]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new nt(901,!1)}}return t.\u0275prov=xn({token:t,providedIn:"root",factory:S2}),t})();function I2(){return new Kd([new T2])}let Kd=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||I2()),deps:[[t,new bh,new vh]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new nt(901,!1)}}return t.\u0275prov=xn({token:t,providedIn:"root",factory:I2}),t})();const xO=u2(null,"core",[]);let wO=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)($n(Wd))},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({}),t})();function $$(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}let cp=null;function Ql(){return cp}const Oo=new Dn("DocumentToken");var Yi=(()=>((Yi=Yi||{})[Yi.Format=0]="Format",Yi[Yi.Standalone=1]="Standalone",Yi))(),Kn=(()=>((Kn=Kn||{})[Kn.Narrow=0]="Narrow",Kn[Kn.Abbreviated=1]="Abbreviated",Kn[Kn.Wide=2]="Wide",Kn[Kn.Short=3]="Short",Kn))(),Ui=(()=>((Ui=Ui||{})[Ui.Short=0]="Short",Ui[Ui.Medium=1]="Medium",Ui[Ui.Long=2]="Long",Ui[Ui.Full=3]="Full",Ui))(),pn=(()=>((pn=pn||{})[pn.Decimal=0]="Decimal",pn[pn.Group=1]="Group",pn[pn.List=2]="List",pn[pn.PercentSign=3]="PercentSign",pn[pn.PlusSign=4]="PlusSign",pn[pn.MinusSign=5]="MinusSign",pn[pn.Exponential=6]="Exponential",pn[pn.SuperscriptingExponent=7]="SuperscriptingExponent",pn[pn.PerMille=8]="PerMille",pn[pn.Infinity=9]="Infinity",pn[pn.NaN=10]="NaN",pn[pn.TimeSeparator=11]="TimeSeparator",pn[pn.CurrencyDecimal=12]="CurrencyDecimal",pn[pn.CurrencyGroup=13]="CurrencyGroup",pn))();function up(t,n){return ts(no(t)[Zt.DateFormat],n)}function dp(t,n){return ts(no(t)[Zt.TimeFormat],n)}function fp(t,n){return ts(no(t)[Zt.DateTimeFormat],n)}function es(t,n){const e=no(t),i=e[Zt.NumberSymbols][n];if(typeof i>"u"){if(n===pn.CurrencyDecimal)return e[Zt.NumberSymbols][pn.Decimal];if(n===pn.CurrencyGroup)return e[Zt.NumberSymbols][pn.Group]}return i}function D2(t){if(!t[Zt.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Zt.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ts(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function b$(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const UO=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Yd={},HO=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var fr=(()=>((fr=fr||{})[fr.Short=0]="Short",fr[fr.ShortGMT=1]="ShortGMT",fr[fr.Long=2]="Long",fr[fr.Extended=3]="Extended",fr))(),yn=(()=>((yn=yn||{})[yn.FullYear=0]="FullYear",yn[yn.Month=1]="Month",yn[yn.Date=2]="Date",yn[yn.Hours=3]="Hours",yn[yn.Minutes=4]="Minutes",yn[yn.Seconds=5]="Seconds",yn[yn.FractionalSeconds=6]="FractionalSeconds",yn[yn.Day=7]="Day",yn))(),Un=(()=>((Un=Un||{})[Un.DayPeriods=0]="DayPeriods",Un[Un.Days=1]="Days",Un[Un.Months=2]="Months",Un[Un.Eras=3]="Eras",Un))();function Zd(t,n,e,i){let r=function QO(t){if(N2(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return hp(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(UO))return function JO(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,h=Number(t[6]||0),b=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,h,b),n}(i)}const n=new Date(t);if(!N2(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=Ia(e,n)||n;let a,s=[];for(;n;){if(a=HO.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const ee=s.pop();if(!ee)break;n=ee}}let h=r.getTimezoneOffset();i&&(h=P2(i,h),r=function XO(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function ZO(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(P2(n,r)-r))}(r,i,!0));let b="";return s.forEach(ee=>{const de=function YO(t){if(C$[t])return C$[t];let n;switch(t){case"G":case"GG":case"GGG":n=Si(Un.Eras,Kn.Abbreviated);break;case"GGGG":n=Si(Un.Eras,Kn.Wide);break;case"GGGGG":n=Si(Un.Eras,Kn.Narrow);break;case"y":n=ir(yn.FullYear,1,0,!1,!0);break;case"yy":n=ir(yn.FullYear,2,0,!0,!0);break;case"yyy":n=ir(yn.FullYear,3,0,!1,!0);break;case"yyyy":n=ir(yn.FullYear,4,0,!1,!0);break;case"Y":n=_p(1);break;case"YY":n=_p(2,!0);break;case"YYY":n=_p(3);break;case"YYYY":n=_p(4);break;case"M":case"L":n=ir(yn.Month,1,1);break;case"MM":case"LL":n=ir(yn.Month,2,1);break;case"MMM":n=Si(Un.Months,Kn.Abbreviated);break;case"MMMM":n=Si(Un.Months,Kn.Wide);break;case"MMMMM":n=Si(Un.Months,Kn.Narrow);break;case"LLL":n=Si(Un.Months,Kn.Abbreviated,Yi.Standalone);break;case"LLLL":n=Si(Un.Months,Kn.Wide,Yi.Standalone);break;case"LLLLL":n=Si(Un.Months,Kn.Narrow,Yi.Standalone);break;case"w":n=y$(1);break;case"ww":n=y$(2);break;case"W":n=y$(1,!0);break;case"d":n=ir(yn.Date,1);break;case"dd":n=ir(yn.Date,2);break;case"c":case"cc":n=ir(yn.Day,1);break;case"ccc":n=Si(Un.Days,Kn.Abbreviated,Yi.Standalone);break;case"cccc":n=Si(Un.Days,Kn.Wide,Yi.Standalone);break;case"ccccc":n=Si(Un.Days,Kn.Narrow,Yi.Standalone);break;case"cccccc":n=Si(Un.Days,Kn.Short,Yi.Standalone);break;case"E":case"EE":case"EEE":n=Si(Un.Days,Kn.Abbreviated);break;case"EEEE":n=Si(Un.Days,Kn.Wide);break;case"EEEEE":n=Si(Un.Days,Kn.Narrow);break;case"EEEEEE":n=Si(Un.Days,Kn.Short);break;case"a":case"aa":case"aaa":n=Si(Un.DayPeriods,Kn.Abbreviated);break;case"aaaa":n=Si(Un.DayPeriods,Kn.Wide);break;case"aaaaa":n=Si(Un.DayPeriods,Kn.Narrow);break;case"b":case"bb":case"bbb":n=Si(Un.DayPeriods,Kn.Abbreviated,Yi.Standalone,!0);break;case"bbbb":n=Si(Un.DayPeriods,Kn.Wide,Yi.Standalone,!0);break;case"bbbbb":n=Si(Un.DayPeriods,Kn.Narrow,Yi.Standalone,!0);break;case"B":case"BB":case"BBB":n=Si(Un.DayPeriods,Kn.Abbreviated,Yi.Format,!0);break;case"BBBB":n=Si(Un.DayPeriods,Kn.Wide,Yi.Format,!0);break;case"BBBBB":n=Si(Un.DayPeriods,Kn.Narrow,Yi.Format,!0);break;case"h":n=ir(yn.Hours,1,-12);break;case"hh":n=ir(yn.Hours,2,-12);break;case"H":n=ir(yn.Hours,1);break;case"HH":n=ir(yn.Hours,2);break;case"m":n=ir(yn.Minutes,1);break;case"mm":n=ir(yn.Minutes,2);break;case"s":n=ir(yn.Seconds,1);break;case"ss":n=ir(yn.Seconds,2);break;case"S":n=ir(yn.FractionalSeconds,1);break;case"SS":n=ir(yn.FractionalSeconds,2);break;case"SSS":n=ir(yn.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=gp(fr.Short);break;case"ZZZZZ":n=gp(fr.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=gp(fr.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=gp(fr.Long);break;default:return null}return C$[t]=n,n}(ee);b+=de?de(r,e,h):"''"===ee?"'":ee.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),b}function hp(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function Ia(t,n){const e=function kO(t){return no(t)[Zt.LocaleId]}(t);if(Yd[e]=Yd[e]||{},Yd[e][n])return Yd[e][n];let i="";switch(n){case"shortDate":i=up(t,Ui.Short);break;case"mediumDate":i=up(t,Ui.Medium);break;case"longDate":i=up(t,Ui.Long);break;case"fullDate":i=up(t,Ui.Full);break;case"shortTime":i=dp(t,Ui.Short);break;case"mediumTime":i=dp(t,Ui.Medium);break;case"longTime":i=dp(t,Ui.Long);break;case"fullTime":i=dp(t,Ui.Full);break;case"short":const r=Ia(t,"shortTime"),o=Ia(t,"shortDate");i=pp(fp(t,Ui.Short),[r,o]);break;case"medium":const s=Ia(t,"mediumTime"),a=Ia(t,"mediumDate");i=pp(fp(t,Ui.Medium),[s,a]);break;case"long":const h=Ia(t,"longTime"),b=Ia(t,"longDate");i=pp(fp(t,Ui.Long),[h,b]);break;case"full":const ee=Ia(t,"fullTime"),de=Ia(t,"fullDate");i=pp(fp(t,Ui.Full),[ee,de])}return i&&(Yd[e][n]=i),i}function pp(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function Ds(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function ir(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function GO(t,n){switch(t){case yn.FullYear:return n.getFullYear();case yn.Month:return n.getMonth();case yn.Date:return n.getDate();case yn.Hours:return n.getHours();case yn.Minutes:return n.getMinutes();case yn.Seconds:return n.getSeconds();case yn.FractionalSeconds:return n.getMilliseconds();case yn.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===yn.Hours)0===a&&-12===e&&(a=12);else if(t===yn.FractionalSeconds)return function VO(t,n){return Ds(t,3).substring(0,n)}(a,n);const h=es(s,pn.MinusSign);return Ds(a,n,h,i,r)}}function Si(t,n,e=Yi.Format,i=!1){return function(r,o){return function qO(t,n,e,i,r,o){switch(e){case Un.Months:return function PO(t,n,e){const i=no(t),o=ts([i[Zt.MonthsFormat],i[Zt.MonthsStandalone]],n);return ts(o,e)}(n,r,i)[t.getMonth()];case Un.Days:return function AO(t,n,e){const i=no(t),o=ts([i[Zt.DaysFormat],i[Zt.DaysStandalone]],n);return ts(o,e)}(n,r,i)[t.getDay()];case Un.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const b=function RO(t){const n=no(t);return D2(n),(n[Zt.ExtraData][2]||[]).map(i=>"string"==typeof i?b$(i):[b$(i[0]),b$(i[1])])}(n),ee=function LO(t,n,e){const i=no(t);D2(i);const o=ts([i[Zt.ExtraData][0],i[Zt.ExtraData][1]],n)||[];return ts(o,e)||[]}(n,r,i),de=b.findIndex(_e=>{if(Array.isArray(_e)){const[Ce,Se]=_e,Pe=s>=Ce.hours&&a>=Ce.minutes,Ne=s<Se.hours||s===Se.hours&&a<Se.minutes;if(Ce.hours<Se.hours){if(Pe&&Ne)return!0}else if(Pe||Ne)return!0}else if(_e.hours===s&&_e.minutes===a)return!0;return!1});if(-1!==de)return ee[de]}return function DO(t,n,e){const i=no(t),o=ts([i[Zt.DayPeriodsFormat],i[Zt.DayPeriodsStandalone]],n);return ts(o,e)}(n,r,i)[s<12?0:1];case Un.Eras:return function NO(t,n){return ts(no(t)[Zt.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function gp(t){return function(n,e,i){const r=-1*i,o=es(e,pn.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case fr.Short:return(r>=0?"+":"")+Ds(s,2,o)+Ds(Math.abs(r%60),2,o);case fr.ShortGMT:return"GMT"+(r>=0?"+":"")+Ds(s,1,o);case fr.Long:return"GMT"+(r>=0?"+":"")+Ds(s,2,o)+":"+Ds(Math.abs(r%60),2,o);case fr.Extended:return 0===i?"Z":(r>=0?"+":"")+Ds(s,2,o)+":"+Ds(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}function A2(t){return hp(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function y$(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=A2(e),s=function KO(t){const n=hp(t,0,1).getDay();return hp(t,0,1+(n<=4?4:11)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Ds(r,t,es(i,pn.MinusSign))}}function _p(t,n=!1){return function(e,i){return Ds(A2(e).getFullYear(),t,es(i,pn.MinusSign),n)}}const C$={};function P2(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function N2(t){return t instanceof Date&&!isNaN(t.valueOf())}let oi=(()=>{class t{constructor(e,i,r,o){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=o,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Pd(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Qe(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(Ge(lp),Ge(Kd),Ge(Ai),Ge(Wl))},t.\u0275dir=_n({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"},standalone:!0}),t})();class hF{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let $i=(()=>{class t{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new hF(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),z2(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{z2(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ge(io),Ge(Ea),Ge(lp))},t.\u0275dir=_n({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),t})();function z2(t,n){t.context.$implicit=n.item}let Rn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new gF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){j2("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){j2("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(Ge(io),Ge(Ea))},t.\u0275dir=_n({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),t})();class gF{constructor(){this.$implicit=null,this.ngIf=null}}function j2(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Qe(n)}'.`)}class I${constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Jl=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=_n({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0}),t})(),Qd=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new I$(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(Ge(io),Ge(Ea),Ge(Jl,9))},t.\u0275dir=_n({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0}),t})(),Jd=(()=>{class t{constructor(e,i,r){r._addDefault(new I$(e,i))}}return t.\u0275fac=function(e){return new(e||t)(Ge(io),Ge(Ea),Ge(Jl,9))},t.\u0275dir=_n({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0}),t})(),hr=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:mo.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ai),Ge(Kd),Ge(Wl))},t.\u0275dir=_n({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0}),t})(),tl=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(e.ngTemplateOutlet||e.ngTemplateOutletInjector){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:r,ngTemplateOutletContext:o,ngTemplateOutletInjector:s}=this;this._viewRef=i.createEmbeddedView(r,o,s?{injector:s}:void 0)}else this._viewRef=null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(Ge(io))},t.\u0275dir=_n({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[Cs]}),t})();const TF=new Dn("DATE_PIPE_DEFAULT_TIMEZONE");let H2=(()=>{class t{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,o){if(null==e||""===e||e!=e)return null;try{return Zd(e,i,o||this.locale,r??this.defaultTimezone??void 0)}catch(s){throw function As(t,n){return new nt(2100,!1)}()}}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ta,16),Ge(TF,24))},t.\u0275pipe=Or({name:"date",type:t,pure:!0,standalone:!0}),t})(),G2=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({}),t})();const q2="browser";function D$(t){return t===q2}class N$ extends class pR extends class SO{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function TO(t){cp||(cp=t)}(new N$)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function gR(){return tf=tf||document.querySelector("base"),tf?tf.getAttribute("href"):null}();return null==e?null:function mR(t){yp=yp||document.createElement("a"),yp.setAttribute("href",t);const n=yp.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){tf=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function dF(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let yp,tf=null;const Q2=new Dn("TRANSITION_ID"),$R=[{provide:r$,useFactory:function _R(t,n,e){return()=>{e.get(ip).donePromise.then(()=>{const i=Ql(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let o=0;o<r.length;o++)i.remove(r[o])})}},deps:[Q2,Oo,ws],multi:!0}];let bR=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();const Cp=new Dn("EventManagerPlugins");let xp=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let o=0;o<r.length;o++){const s=r[o];if(s.supports(e))return this._eventNameToPlugin.set(e,s),s}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)($n(Cp),$n(Fn))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class J2{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=Ql().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let ew=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})(),nf=(()=>{class t extends ew{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(o=>{const s=this._doc.createElement("style");s.textContent=o,r.push(i.appendChild(s))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(tw),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(tw))}}return t.\u0275fac=function(e){return new(e||t)($n(Oo))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();function tw(t){Ql().remove(t)}const O$={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},F$=/%COMP%/g;function wp(t,n,e){for(let i=0;i<n.length;i++){let r=n[i];Array.isArray(r)?wp(t,r,e):(r=r.replace(F$,t),e.push(r))}return e}function rw(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let Ep=(()=>{class t{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new R$(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case $s.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new TR(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case $s.ShadowDom:return new SR(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=wp(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)($n(xp),$n(nf),$n(Gd))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class R${constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(O$[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){(sw(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(sw(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=O$[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=O$[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(mo.DashCase|mo.Important)?n.style.setProperty(e,i,r&mo.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&mo.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,rw(i)):this.eventManager.addEventListener(n,e,rw(i))}}function sw(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class TR extends R${constructor(n,e,i,r){super(n),this.component=i;const o=wp(r+"-"+i.id,i.styles,[]);e.addStyles(o),this.contentAttr=function xR(t){return"_ngcontent-%COMP%".replace(F$,t)}(r+"-"+i.id),this.hostAttr=function wR(t){return"_nghost-%COMP%".replace(F$,t)}(r+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}class SR extends R${constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const o=wp(r.id,r.styles,[]);for(let s=0;s<o.length;s++){const a=document.createElement("style");a.textContent=o[s],this.shadowRoot.appendChild(a)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let IR=(()=>{class t extends J2{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)($n(Oo))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();const aw=["alt","control","meta","shift"],MR={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},kR={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let DR=(()=>{class t extends J2{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Ql().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),aw.forEach(b=>{const ee=i.indexOf(b);ee>-1&&(i.splice(ee,1),s+=b+".")}),s+=o,0!=i.length||0===o.length)return null;const h={};return h.domEventName=r,h.fullKey=s,h}static matchEventFullKeyCode(e,i){let r=MR[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),aw.forEach(s=>{s!==r&&(0,kR[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)($n(Oo))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();const cw=[{provide:qd,useValue:q2},{provide:t2,useValue:function AR(){N$.makeCurrent()},multi:!0},{provide:Oo,useFactory:function NR(){return function SD(t){Vm=t}(document),document},deps:[]}],OR=u2(xO,"browser",cw),uw=new Dn(""),dw=[{provide:rp,useClass:class vR{addToWindow(n){xi.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new Error("Could not find testability for element.");return o},xi.getAllAngularTestabilities=()=>n.getAllTestabilities(),xi.getAllAngularRootElements=()=>n.getAllRootElements(),xi.frameworkStabilizers||(xi.frameworkStabilizers=[]),xi.frameworkStabilizers.push(i=>{const r=xi.getAllAngularTestabilities();let o=r.length,s=!1;const a=function(h){s=s||h,o--,0==o&&i(s)};r.forEach(function(h){h.whenStable(a)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?Ql().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:a2,useClass:c$,deps:[Fn,u$,rp]},{provide:c$,useClass:c$,deps:[Fn,u$,rp]}],fw=[{provide:Xm,useValue:"root"},{provide:iu,useFactory:function PR(){return new iu},deps:[]},{provide:Cp,useClass:IR,multi:!0,deps:[Oo,Fn,qd]},{provide:Cp,useClass:DR,multi:!0,deps:[Oo]},{provide:Ep,useClass:Ep,deps:[xp,nf,Gd]},{provide:kd,useExisting:Ep},{provide:ew,useExisting:nf},{provide:nf,useClass:nf,deps:[Oo]},{provide:xp,useClass:xp,deps:[Cp,Fn]},{provide:class jF{},useClass:bR,deps:[]},[]];let hw=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Gd,useValue:e.appId},{provide:Q2,useExisting:Gd},$R]}}}return t.\u0275fac=function(e){return new(e||t)($n(uw,12))},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({providers:[...fw,...dw],imports:[G2,wO]}),t})();typeof window<"u"&&window;let mw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:function(e){let i=null;return i=e?new(e||t):$n(_w),i},providedIn:"root"}),t})(),_w=(()=>{class t extends mw{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case Ei.NONE:return i;case Ei.HTML:return Hs(i,"HTML")?Po(i):Nb(this._doc,String(i)).toString();case Ei.STYLE:return Hs(i,"Style")?Po(i):i;case Ei.SCRIPT:if(Hs(i,"Script"))return Po(i);throw new Error("unsafe value used in a script context");case Ei.URL:return Hs(i,"URL")?Po(i):Ih(String(i));case Ei.RESOURCE_URL:if(Hs(i,"ResourceURL"))return Po(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function ND(t){return new ID(t)}(e)}bypassSecurityTrustStyle(e){return function OD(t){return new MD(t)}(e)}bypassSecurityTrustScript(e){return function FD(t){return new kD(t)}(e)}bypassSecurityTrustUrl(e){return function RD(t){return new DD(t)}(e)}bypassSecurityTrustResourceUrl(e){return function LD(t){return new AD(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)($n(Oo))},t.\u0275prov=xn({token:t,factory:function(e){let i=null;return i=e?new e:function VR(t){return new _w(t.get(Oo))}($n(ws)),i},providedIn:"root"}),t})();me(5386);const{isArray:GR}=Array,{getPrototypeOf:qR,prototype:WR,keys:KR}=Object;function $w(t){if(1===t.length){const n=t[0];if(GR(n))return{args:n,keys:null};if(function YR(t){return t&&"object"==typeof t&&qR(t)===WR}(n)){const e=KR(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}const{isArray:ZR}=Array;function rf(t){return se(n=>function XR(t,n){return ZR(n)?t(...n):t(n)}(t,n))}function vw(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}let bw=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wl),Ge(Ai))},t.\u0275dir=_n({type:t}),t})(),ec=(()=>{class t extends bw{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,features:[pi]}),t})();const Ws=new Dn("NgValueAccessor"),JR={provide:Ws,useExisting:bt(()=>Fo),multi:!0};let Fo=(()=>{class t extends ec{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target.checked)})("blur",function(){return i.onTouched()})},features:[Ti([JR]),pi]}),t})();const e6={provide:Ws,useExisting:bt(()=>Ii),multi:!0},yw=new Dn("CompositionEventMode");let Ii=(()=>{class t extends bw{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function t6(){const t=Ql()?Ql().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wl),Ge(Ai),Ge(yw,8))},t.\u0275dir=_n({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Ae("input",function(o){return i._handleInput(o.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(o){return i._compositionEnd(o.target.value)})},features:[Ti([e6]),pi]}),t})();function il(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function Cw(t){return null!=t&&"number"==typeof t.length}const jr=new Dn("NgValidators"),rl=new Dn("NgAsyncValidators");function Ew(t){return il(t.value)?{required:!0}:null}function Tp(t){return null}function Dw(t){return null!=t}function Aw(t){return Wh(t)?Ji(t):t}function Pw(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function Nw(t,n){return n.map(e=>e(t))}function Ow(t){return t.map(n=>function r6(t){return!t.validate}(n)?n:e=>n.validate(e))}function z$(t){return null!=t?function Fw(t){if(!t)return null;const n=t.filter(Dw);return 0==n.length?null:function(e){return Pw(Nw(e,n))}}(Ow(t)):null}function j$(t){return null!=t?function Rw(t){if(!t)return null;const n=t.filter(Dw);return 0==n.length?null:function(e){return function QR(...t){const n=Wo(t),{args:e,keys:i}=$w(t),r=new F(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let h=s,b=s;for(let ee=0;ee<s;ee++){let de=!1;Cr(e[ee]).subscribe($(o,_e=>{de||(de=!0,b--),a[ee]=_e},()=>h--,void 0,()=>{(!h||!de)&&(b||o.next(i?vw(i,a):a),o.complete())}))}});return n?r.pipe(rf(n)):r}(Nw(e,n).map(Aw)).pipe(se(Pw))}}(Ow(t)):null}function Lw(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function U$(t){return t?Array.isArray(t)?t:[t]:[]}function Sp(t,n){return Array.isArray(t)?t.includes(n):t===n}function jw(t,n){const e=U$(n);return U$(t).forEach(r=>{Sp(e,r)||e.push(r)}),e}function Uw(t,n){return U$(n).filter(e=>!Sp(t,e))}class Hw{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=z$(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=j$(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class oo extends Hw{get formDirective(){return null}get path(){return null}}class ol extends Hw{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Vw{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Mi=(()=>{class t extends Vw{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(Ge(ol,2))},t.\u0275dir=_n({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&Kh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)},features:[pi]}),t})(),tc=(()=>{class t extends Vw{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(Ge(oo,10))},t.\u0275dir=_n({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&Kh("ng-untouched",i.isUntouched)("ng-touched",i.isTouched)("ng-pristine",i.isPristine)("ng-dirty",i.isDirty)("ng-valid",i.isValid)("ng-invalid",i.isInvalid)("ng-pending",i.isPending)("ng-submitted",i.isSubmitted)},features:[pi]}),t})();const of="VALID",Mp="INVALID",wu="PENDING",sf="DISABLED";function q$(t){return(kp(t)?t.validators:t)||null}function qw(t){return Array.isArray(t)?z$(t):t||null}function W$(t,n){return(kp(n)?n.asyncValidators:t)||null}function Ww(t){return Array.isArray(t)?j$(t):t||null}function kp(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class Zw{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=e,this._composedValidatorFn=qw(this._rawValidators),this._composedAsyncValidatorFn=Ww(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===of}get invalid(){return this.status===Mp}get pending(){return this.status==wu}get disabled(){return this.status===sf}get enabled(){return this.status!==sf}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=qw(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=Ww(n)}addValidators(n){this.setValidators(jw(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(jw(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(Uw(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(Uw(n,this._rawAsyncValidators))}hasValidator(n){return Sp(this._rawValidators,n)}hasAsyncValidator(n){return Sp(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=wu,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=sf,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=of,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===of||this.status===wu)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?sf:of}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=wu,this._hasOwnPendingAsyncValidator=!0;const e=Aw(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Gn,this.statusChanges=new Gn}_calculateStatus(){return this._allControlsDisabled()?sf:this.errors?Mp:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(wu)?wu:this._anyControlsHaveStatus(Mp)?Mp:of}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){kp(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}}class K$ extends Zw{constructor(n,e,i){super(q$(e),W$(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function Yw(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new nt(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function Kw(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new nt(1e3,"");if(!i[e])throw new nt(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}function af(t,n){Y$(t,n),n.valueAccessor.writeValue(t.value),t.disabled&&n.valueAccessor.setDisabledState?.(!0),function h6(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Xw(t,n)})}(t,n),function g6(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function p6(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Xw(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function f6(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function Pp(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function Y$(t,n){const e=function Bw(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(Lw(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function zw(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(Lw(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();Pp(n._rawValidators,r),Pp(n._rawAsyncValidators,r)}function Xw(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const b6={provide:oo,useExisting:bt(()=>Ma)},lf=(()=>Promise.resolve())();let Ma=(()=>{class t extends oo{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new Gn,this.form=new K$({},z$(e),j$(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){lf.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),af(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){lf.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){lf.then(()=>{const i=this._findContainer(e.path),r=new K$({});(function Qw(t,n){Y$(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){lf.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){lf.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function eE(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(Ge(jr,10),Ge(rl,10))},t.\u0275dir=_n({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Ae("submit",function(o){return i.onSubmit(o)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[Ti([b6]),pi]}),t})();function tE(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function nE(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const iE=class extends Zw{constructor(n=null,e,i){super(q$(e),W$(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),kp(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=nE(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){tE(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){tE(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){nE(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},x6={provide:ol,useExisting:bt(()=>Ci)},sE=(()=>Promise.resolve())();let Ci=(()=>{class t extends ol{constructor(e,i,r,o,s){super(),this._changeDetectorRef=s,this.control=new iE,this._registered=!1,this.update=new Gn,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function X$(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===Ii?e=o:function $6(t){return Object.getPrototypeOf(t.constructor)===ec}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function Z$(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){af(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){sE.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&$$(i);sE.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function Dp(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(Ge(oo,9),Ge(jr,10),Ge(rl,10),Ge(Ws,10),Ge(Ki,8))},t.\u0275dir=_n({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[Ti([x6]),pi,Cs]}),t})(),nc=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=_n({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const w6={provide:Ws,useExisting:bt(()=>Ro),multi:!0};let Ro=(()=>{class t extends ec{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Ti([w6]),pi]}),t})();const E6={provide:Ws,useExisting:bt(()=>sl),multi:!0};let aE=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({}),t})(),T6=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:aE}),t})(),sl=(()=>{class t extends ec{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(ol),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wl),Ge(Ai),Ge(T6),Ge(ws))},t.\u0275dir=_n({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[Ti([E6]),pi]}),t})();const S6={provide:Ws,useExisting:bt(()=>Lo),multi:!0};let Lo=(()=>{class t extends ec{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target.value)})("input",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},features:[Ti([S6]),pi]}),t})();const P6={provide:Ws,useExisting:bt(()=>vo),multi:!0};function fE(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let vo=(()=>{class t extends ec{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=fE(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function N6(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ti([P6]),pi]}),t})(),so=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(fE(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ai),Ge(Wl),Ge(vo,9))},t.\u0275dir=_n({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const O6={provide:Ws,useExisting:bt(()=>t0),multi:!0};function hE(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let t0=(()=>{class t extends ec{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const b=this._getOptionValue(s[a].value);r.push(b)}}else{const s=i.options;for(let a=0;a<s.length;a++){const h=s[a];if(h.selected){const b=this._getOptionValue(h.value);r.push(b)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function F6(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Ae("change",function(o){return i.onChange(o.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[Ti([O6]),pi]}),t})(),ao=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(hE(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(hE(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ai),Ge(Wl),Ge(t0,9))},t.\u0275dir=_n({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function pE(t){return"number"==typeof t?t:parseInt(t,10)}function gE(t){return"number"==typeof t?t:parseFloat(t)}let ic=(()=>{class t{constructor(){this._validator=Tp}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Tp,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=_n({type:t,features:[Cs]}),t})();const R6={provide:jr,useExisting:bt(()=>Ks),multi:!0};let Ks=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>gE(e),this.createValidator=e=>function ww(t){return n=>{if(il(n.value)||il(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&rn("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[Ti([R6]),pi]}),t})();const L6={provide:jr,useExisting:bt(()=>Ys),multi:!0};let Ys=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>gE(e),this.createValidator=e=>function xw(t){return n=>{if(il(n.value)||il(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&rn("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[Ti([L6]),pi]}),t})();const B6={provide:jr,useExisting:bt(()=>Op),multi:!0};let Op=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=$$,this.createValidator=e=>Ew}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&rn("required",i._enabled?"":null)},inputs:{required:"required"},features:[Ti([B6]),pi]}),t})();const U6={provide:jr,useExisting:bt(()=>n0),multi:!0};let n0=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>pE(e),this.createValidator=e=>function Iw(t){return n=>il(n.value)||!Cw(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&rn("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[Ti([U6]),pi]}),t})();const H6={provide:jr,useExisting:bt(()=>r0),multi:!0};let r0=(()=>{class t extends ic{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>pE(e),this.createValidator=e=>function Mw(t){return n=>Cw(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=Lr(t)))(i||t)}}(),t.\u0275dir=_n({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&rn("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[Ti([H6]),pi]}),t})(),G6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({imports:[aE]}),t})(),q6=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({imports:[G6]}),t})();class vE{}const ka="*";function Hn(t,n){return{type:7,name:t,definitions:n,options:{}}}function Qt(t,n=null){return{type:4,styles:n,timings:t}}function bE(t,n=null){return{type:2,steps:t,options:n}}function ht(t){return{type:6,styles:t,offset:null}}function Fp(t,n,e){return{type:0,name:t,styles:n,options:e}}function Cn(t){return{type:5,steps:t}}function en(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function yE(t){Promise.resolve().then(t)}class cf{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){yE(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class CE{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?yE(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function xE(t){return new nt(3e3,!1)}function M8(){return typeof window<"u"&&typeof window.document<"u"}function s0(){return typeof process<"u"&&"[object process]"==={}.toString.call(process)}function al(t){switch(t.length){case 0:return new cf;case 1:return t[0];default:return new CE(t)}}function wE(t,n,e,i,r=new Map,o=new Map){const s=[],a=[];let h=-1,b=null;if(i.forEach(ee=>{const de=ee.get("offset"),_e=de==h,Ce=_e&&b||new Map;ee.forEach((Se,Pe)=>{let Ne=Pe,je=Se;if("offset"!==Pe)switch(Ne=n.normalizePropertyName(Ne,s),je){case"!":je=r.get(Pe);break;case ka:je=o.get(Pe);break;default:je=n.normalizeStyleValue(Pe,Ne,je,s)}Ce.set(Ne,je)}),_e||a.push(Ce),b=Ce,h=de}),s.length)throw function _8(t){return new nt(3502,!1)}();return a}function a0(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&l0(e,"start",t)));break;case"done":t.onDone(()=>i(e&&l0(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&l0(e,"destroy",t)))}}function l0(t,n,e){const o=c0(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function c0(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function Bo(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function EE(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}let u0=(t,n)=>!1,TE=(t,n,e)=>[],SE=null;function d0(t){const n=t.parentNode||t.host;return n===SE?null:n}(s0()||typeof Element<"u")&&(M8()?(SE=(()=>document.documentElement)(),u0=(t,n)=>{for(;n;){if(n===t)return!0;n=d0(n)}return!1}):u0=(t,n)=>t.contains(n),TE=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let rc=null,IE=!1;const ME=u0,kE=TE;let DE=(()=>{class t{validateStyleProperty(e){return function D8(t){rc||(rc=function A8(){return typeof document<"u"?document.body:null}()||{},IE=!!rc.style&&"WebkitAppearance"in rc.style);let n=!0;return rc.style&&!function k8(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in rc.style,!n&&IE&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in rc.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return ME(e,i)}getParentElement(e){return d0(e)}query(e,i,r){return kE(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],h){return new cf(r,o)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})(),f0=(()=>{class t{}return t.NOOP=new DE,t})();const h0="ng-enter",Rp="ng-leave",Lp="ng-trigger",Bp=".ng-trigger",PE="ng-animating",p0=".ng-animating";function Da(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:g0(parseFloat(n[1]),n[2])}function g0(t,n){return"s"===n?1e3*t:t}function zp(t,n,e){return t.hasOwnProperty("duration")?t:function O8(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(xE()),{duration:0,delay:0,easing:""};r=g0(parseFloat(a[1]),a[2]);const h=a[3];null!=h&&(o=g0(parseFloat(h),a[4]));const b=a[5];b&&(s=b)}else r=t;if(!e){let a=!1,h=n.length;r<0&&(n.push(function Y6(){return new nt(3100,!1)}()),a=!0),o<0&&(n.push(function Z6(){return new nt(3101,!1)}()),a=!0),a&&n.splice(h,0,xE())}return{duration:r,delay:o,easing:s}}(t,n,e)}function uf(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function NE(t){const n=new Map;return Object.keys(t).forEach(e=>{n.set(e,t[e])}),n}function ll(t,n=new Map,e){if(e)for(let[i,r]of e)n.set(i,r);for(let[i,r]of t)n.set(i,r);return n}function FE(t,n,e){return e?n+":"+e+";":""}function RE(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=FE(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=FE(0,B8(e),t.style[e]));t.setAttribute("style",n)}function Zs(t,n,e){t.style&&(n.forEach((i,r)=>{const o=_0(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i}),s0()&&RE(t))}function oc(t,n){t.style&&(n.forEach((e,i)=>{const r=_0(i);t.style[r]=""}),s0()&&RE(t))}function df(t){return Array.isArray(t)?1==t.length?t[0]:bE(t):t}const m0=new RegExp("{{\\s*(.+?)\\s*}}","g");function LE(t){let n=[];if("string"==typeof t){let e;for(;e=m0.exec(t);)n.push(e[1]);m0.lastIndex=0}return n}function ff(t,n,e){const i=t.toString(),r=i.replace(m0,(o,s)=>{let a=n[s];return null==a&&(e.push(function Q6(t){return new nt(3003,!1)}()),a=""),a.toString()});return r==i?t:r}function jp(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const L8=/-+([a-z0-9])/g;function _0(t){return t.replace(L8,(...n)=>n[1].toUpperCase())}function B8(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function zo(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function J6(t){return new nt(3004,!1)}()}}function BE(t,n){return window.getComputedStyle(t)[n]}function G8(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function q8(t,n,e){if(":"==t[0]){const h=function W8(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function h8(t){return new nt(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof h)return void n.push(h);t=h}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function f8(t){return new nt(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(zE(r,s));"<"==o[0]&&!("*"==r&&"*"==s)&&n.push(zE(s,r))}(i,e,n)):e.push(t),e}const Gp=new Set(["true","1"]),qp=new Set(["false","0"]);function zE(t,n){const e=Gp.has(t)||qp.has(t),i=Gp.has(n)||qp.has(n);return(r,o)=>{let s="*"==t||t==r,a="*"==n||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?Gp.has(t):qp.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?Gp.has(n):qp.has(n)),s&&a}}const K8=new RegExp("s*:selfs*,?","g");function $0(t,n,e,i){return new Y8(t).build(n,e,i)}class Y8{constructor(n){this._driver=n}build(n,e,i){const r=new Q8(e);return this._resetContextStyleTimingState(r),zo(this,df(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function t8(){return new nt(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),0==a.type){const h=a,b=h.name;b.toString().split(/\s*,\s*/).forEach(ee=>{h.name=ee,o.push(this.visitState(h,e))}),h.name=b}else if(1==a.type){const h=this.visitTransition(a,e);i+=h.queryCount,r+=h.depCount,s.push(h)}else e.errors.push(function n8(){return new nt(3007,!1)}())}),{type:7,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(h=>{LE(h).forEach(b=>{s.hasOwnProperty(b)||o.add(b)})})}),o.size&&(jp(o.values()),e.errors.push(function i8(t,n){return new nt(3008,!1)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=zo(this,df(n.animation),e);return{type:1,matchers:G8(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:sc(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>zo(this,i,e)),options:sc(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=zo(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:3,steps:o,options:sc(n.options)}}visitAnimate(n,e){const i=function eL(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return v0(zp(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=v0(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=zp(e,n);return v0(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:ht({});if(5==o.type)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const b={};i.easing&&(b.easing=i.easing),s=ht(b)}e.currentTime+=i.duration+i.delay;const h=this.visitStyle(s,e);h.isEmptyStep=a,r=h}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===ka?i.push(a):e.errors.push(new nt(3002,!1)):i.push(NE(a));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let h of a.values())if(h.toString().indexOf("{{")>=0){o=!0;break}}),{type:6,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,h)=>{const b=e.collectedStyles.get(e.currentQuerySelector),ee=b.get(h);let de=!0;ee&&(o!=r&&o>=ee.startTime&&r<=ee.endTime&&(e.errors.push(function o8(t,n,e,i,r){return new nt(3010,!1)}()),de=!1),o=ee.startTime),de&&b.set(h,{startTime:o,endTime:r}),e.options&&function R8(t,n,e){const i=n.params||{},r=LE(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function X6(t){return new nt(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function s8(){return new nt(3011,!1)}()),i;let o=0;const s=[];let a=!1,h=!1,b=0;const ee=n.steps.map(je=>{const He=this._makeStyleAst(je,e);let Ue=null!=He.offset?He.offset:function J8(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(He.styles),We=0;return null!=Ue&&(o++,We=He.offset=Ue),h=h||We<0||We>1,a=a||We<b,b=We,s.push(We),He});h&&e.errors.push(function a8(){return new nt(3012,!1)}()),a&&e.errors.push(function l8(){return new nt(3200,!1)}());const de=n.steps.length;let _e=0;o>0&&o<de?e.errors.push(function c8(){return new nt(3202,!1)}()):0==o&&(_e=1/(de-1));const Ce=de-1,Se=e.currentTime,Pe=e.currentAnimateTimings,Ne=Pe.duration;return ee.forEach((je,He)=>{const Ue=_e>0?He==Ce?1:_e*He:s[He],We=Ue*Ne;e.currentTime=Se+Pe.delay+We,Pe.duration=We,this._validateStyleAst(je,e),je.offset=Ue,i.styles.push(je)}),i}visitReference(n,e){return{type:8,animation:zo(this,df(n.animation),e),options:sc(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:sc(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:sc(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function Z8(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(K8,"")),t=t.replace(/@\*/g,Bp).replace(/@\w+/g,e=>Bp+"-"+e.slice(1)).replace(/:animating/g,p0),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,Bo(e.collectedStyles,e.currentQuerySelector,new Map);const a=zo(this,df(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:sc(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function u8(){return new nt(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:zp(n.timings,e.errors,!0);return{type:12,animation:zo(this,df(n.animation),e),timings:i,options:null}}}class Q8{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function sc(t){return t?(t=uf(t)).params&&(t.params=function X8(t){return t?uf(t):null}(t.params)):t={},t}function v0(t,n,e){return{duration:t,delay:n,easing:e}}function b0(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class Wp{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const iL=new RegExp(":enter","g"),oL=new RegExp(":leave","g");function y0(t,n,e,i,r,o=new Map,s=new Map,a,h,b=[]){return(new sL).buildKeyframes(t,n,e,i,r,o,s,a,h,b)}class sL{buildKeyframes(n,e,i,r,o,s,a,h,b,ee=[]){b=b||new Wp;const de=new C0(n,e,b,r,o,ee,[]);de.options=h;const _e=h.delay?Da(h.delay):0;de.currentTimeline.delayNextStep(_e),de.currentTimeline.setStyles([s],null,de.errors,h),zo(this,i,de);const Ce=de.timelines.filter(Se=>Se.containsAnimation());if(Ce.length&&a.size){let Se;for(let Pe=Ce.length-1;Pe>=0;Pe--){const Ne=Ce[Pe];if(Ne.element===e){Se=Ne;break}}Se&&!Se.allowOnlyTimelineStyles()&&Se.setStyles([a],null,de.errors,h)}return Ce.length?Ce.map(Se=>Se.buildKeyframes()):[b0(e,[],[],[],0,_e,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:Da(ff(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?Da(i.duration):null,a=null!=i.delay?Da(i.delay):null;return 0!==s&&n.forEach(h=>{const b=e.appendInstructionToTimeline(h,s,a);o=Math.max(o,b.duration+b.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),zo(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=Kp);const s=Da(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>zo(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?Da(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),zo(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return zp(e.params?ff(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;5==o.type?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(h=>{a.forwardTime((h.offset||0)*o),a.setStyles(h.styles,h.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?Da(r.delay):0;o&&(6===e.previousNode.type||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=Kp);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let h=null;a.forEach((b,ee)=>{e.currentQueryIndex=ee;const de=e.createSubContext(n.options,b);o&&de.delayNextStep(o),b===e.element&&(h=de.currentTimeline),zo(this,n.animation,de),de.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,de.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),h&&(e.currentTimeline.mergeTimelineCollectedStyles(h),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let h=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":h=a-h;break;case"full":h=i.currentStaggerTime}const ee=e.currentTimeline;h&&ee.delayNextStep(h);const de=ee.currentTime;zo(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-de+(r.startTime-i.currentTimeline.startTime)}}const Kp={};class C0{constructor(n,e,i,r,o,s,a,h){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=Kp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=h||new Yp(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=Da(i.duration)),null!=i.delay&&(r.delay=Da(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=ff(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new C0(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=Kp,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new aL(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(iL,"."+this._enterClassName)).replace(oL,"."+this._leaveClassName);let b=this._driver.query(this.element,n,1!=i);0!==i&&(b=i<0?b.slice(b.length+i,b.length):b.slice(0,i)),a.push(...b)}return!o&&0==a.length&&s.push(function d8(t){return new nt(3014,!1)}()),a}}class Yp{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new Yp(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||ka),this._currentKeyframe.set(e,ka);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function lL(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i=i||n.keys();for(let o of i)e.set(o,ka)}else ll(r,e)}),e}(n,this._globalTimelineStyles);for(let[a,h]of s){const b=ff(h,o,i);this._pendingStyles.set(a,b),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??ka),this._updateStyle(a,b)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,h)=>{const b=ll(a,new Map,this._backFill);b.forEach((ee,de)=>{"!"===ee?n.add(de):ee===ka&&e.add(de)}),i||b.set("offset",h/this.duration),r.push(b)});const o=n.size?jp(n.values()):[],s=e.size?jp(e.values()):[];if(i){const a=r[0],h=new Map(a);a.set("offset",0),h.set("offset",1),r=[a,h]}return b0(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class aL extends Yp{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,h=ll(n[0]);h.set("offset",0),o.push(h);const b=ll(n[0]);b.set("offset",HE(a)),o.push(b);const ee=n.length-1;for(let de=1;de<=ee;de++){let _e=ll(n[de]);const Ce=_e.get("offset");_e.set("offset",HE((e+Ce*i)/s)),o.push(_e)}i=s,e=0,r="",n=o}return b0(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function HE(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class x0{}const cL=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class uL extends x0{normalizePropertyName(n,e){return _0(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(cL.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function e8(t,n){return new nt(3005,!1)}())}return s+o}}function VE(t,n,e,i,r,o,s,a,h,b,ee,de,_e){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:h,preStyleProps:b,postStyleProps:ee,totalTime:de,errors:_e}}const w0={};class GE{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function dL(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,h,b,ee){const de=[],_e=this.ast.options&&this.ast.options.params||w0,Se=this.buildStyles(i,a&&a.params||w0,de),Pe=h&&h.params||w0,Ne=this.buildStyles(r,Pe,de),je=new Set,He=new Map,Ue=new Map,We="void"===r,mt={params:fL(Pe,_e),delay:this.ast.options?.delay},Xe=ee?[]:y0(n,e,this.ast.animation,o,s,Se,Ne,mt,b,de);let ct=0;if(Xe.forEach(ot=>{ct=Math.max(ot.duration+ot.delay,ct)}),de.length)return VE(e,this._triggerName,i,r,We,Se,Ne,[],[],He,Ue,ct,de);Xe.forEach(ot=>{const _t=ot.element,Ct=Bo(He,_t,new Set);ot.preStyleProps.forEach(Gt=>Ct.add(Gt));const xt=Bo(Ue,_t,new Set);ot.postStyleProps.forEach(Gt=>xt.add(Gt)),_t!==e&&je.add(_t)});const It=jp(je.values());return VE(e,this._triggerName,i,r,We,Se,Ne,Xe,It,He,Ue,ct)}}function fL(t,n){const e=uf(n);for(const i in t)t.hasOwnProperty(i)&&null!=t[i]&&(e[i]=t[i]);return e}class hL{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=uf(this.defaultParams);return Object.keys(n).forEach(o=>{const s=n[o];null!==s&&(r[o]=s)}),this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=ff(s,r,e));const h=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,h,s,e),i.set(h,s)})}),i}}class gL{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new hL(r.style,r.options&&r.options.params||{},i))}),qE(this.states,"true","1"),qE(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new GE(n,r,this.states))}),this.fallbackTransition=function mL(t,n,e){return new GE(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function qE(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const _L=new Wp;class $L{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],o=$0(this._driver,e,i,[]);if(i.length)throw function $8(t){return new nt(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=wE(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=y0(this._driver,e,o,h0,Rp,new Map,new Map,i,_L,r),s.forEach(ee=>{const de=Bo(a,ee.element,new Map);ee.postStyleProps.forEach(_e=>de.set(_e,null))})):(r.push(function v8(){return new nt(3300,!1)}()),s=[]),r.length)throw function b8(t){return new nt(3504,!1)}();a.forEach((ee,de)=>{ee.forEach((_e,Ce)=>{ee.set(Ce,this._driver.computeStyle(de,Ce,ka))})});const b=al(s.map(ee=>{const de=a.get(ee.element);return this._buildPlayer(ee,new Map,de)}));return this._playersById.set(n,b),b.onDestroy(()=>this.destroy(n)),this.players.push(b),b}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function y8(t){return new nt(3301,!1)}();return e}listen(n,e,i,r){const o=c0(e,"","","");return a0(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const WE="ng-animate-queued",E0="ng-animate-disabled",xL=[],KE={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},wL={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},ns="__ng_removed";class T0{constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function IL(t){return t??null}(i?n.value:n),i){const o=uf(n);delete o.value,this.options=o}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const hf="void",S0=new T0(hf);class EL{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,is(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function C8(t,n){return new nt(3302,!1)}();if(null==i||0==i.length)throw function x8(t){return new nt(3303,!1)}();if(!function ML(t){return"start"==t||"done"==t}(i))throw function w8(t,n){return new nt(3400,!1)}();const o=Bo(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=Bo(this._engine.statesByElement,n,new Map);return a.has(e)||(is(n,Lp),is(n,Lp+"-"+e),a.set(e,S0)),()=>{this._engine.afterFlush(()=>{const h=o.indexOf(s);h>=0&&o.splice(h,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function E8(t){return new nt(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new I0(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(is(n,Lp),is(n,Lp+"-"+e),this._engine.statesByElement.set(n,a=new Map));let h=a.get(e);const b=new T0(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&h&&b.absorbOptions(h.options),a.set(e,b),h||(h=S0),b.value!==hf&&h.value===b.value){if(!function AL(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(h.params,b.params)){const Pe=[],Ne=o.matchStyles(h.value,h.params,Pe),je=o.matchStyles(b.value,b.params,Pe);Pe.length?this._engine.reportError(Pe):this._engine.afterFlush(()=>{oc(n,Ne),Zs(n,je)})}return}const _e=Bo(this._engine.playersByElement,n,[]);_e.forEach(Pe=>{Pe.namespaceId==this.id&&Pe.triggerName==e&&Pe.queued&&Pe.destroy()});let Ce=o.matchTransition(h.value,b.value,n,b.params),Se=!1;if(!Ce){if(!r)return;Ce=o.fallbackTransition,Se=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:Ce,fromState:h,toState:b,player:s,isFallbackTransition:Se}),Se||(is(n,WE),s.onStart(()=>{Eu(n,WE)})),s.onDone(()=>{let Pe=this.players.indexOf(s);Pe>=0&&this.players.splice(Pe,1);const Ne=this._engine.playersByElement.get(n);if(Ne){let je=Ne.indexOf(s);je>=0&&Ne.splice(je,1)}}),this.players.push(s),_e.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,Bp,!0);i.forEach(r=>{if(r[ns])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((h,b)=>{if(s.set(b,h.value),this._triggers.has(b)){const ee=this.trigger(n,b,hf,r);ee&&a.push(ee)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&al(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const h=this._triggers.get(s).fallbackTransition,b=i.get(s)||S0,ee=new T0(hf),de=new I0(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:h,fromState:b,toState:ee,player:de,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[ns];(!o||o===KE)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){is(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const h=c0(o,i.triggerName,i.fromState.value,i.toState.value);h._data=n,a0(i.player,a.phase,h,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class TL{constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,o)=>{}}_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new EL(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const h=r.get(a);if(h){const b=i.indexOf(h);i.splice(b+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(Zp(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!Zp(e))return;const o=e[ns];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),is(n,E0)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Eu(n,E0))}removeNode(n,e,i,r){if(Zp(e)){const o=n?this._fetchNamespace(n):null;if(o?o.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const s=this.namespacesByHostElement.get(e);s&&s.id!==n&&s.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[ns]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return Zp(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,Bp,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,p0,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return al(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[ns];if(e&&e.setForRemoval){if(n[ns]=KE,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(E0)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)is(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?al(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function T8(t){return new nt(3402,!1)}()}_flushAnimations(n,e){const i=new Wp,r=[],o=new Map,s=[],a=new Map,h=new Map,b=new Map,ee=new Set;this.disabledNodes.forEach(Tt=>{ee.add(Tt);const Pt=this.driver.query(Tt,".ng-animate-queued",!0);for(let Ut=0;Ut<Pt.length;Ut++)ee.add(Pt[Ut])});const de=this.bodyNode,_e=Array.from(this.statesByElement.keys()),Ce=XE(_e,this.collectedEnterElements),Se=new Map;let Pe=0;Ce.forEach((Tt,Pt)=>{const Ut=h0+Pe++;Se.set(Pt,Ut),Tt.forEach(Ht=>is(Ht,Ut))});const Ne=[],je=new Set,He=new Set;for(let Tt=0;Tt<this.collectedLeaveElements.length;Tt++){const Pt=this.collectedLeaveElements[Tt],Ut=Pt[ns];Ut&&Ut.setForRemoval&&(Ne.push(Pt),je.add(Pt),Ut.hasAnimation?this.driver.query(Pt,".ng-star-inserted",!0).forEach(Ht=>je.add(Ht)):He.add(Pt))}const Ue=new Map,We=XE(_e,Array.from(je));We.forEach((Tt,Pt)=>{const Ut=Rp+Pe++;Ue.set(Pt,Ut),Tt.forEach(Ht=>is(Ht,Ut))}),n.push(()=>{Ce.forEach((Tt,Pt)=>{const Ut=Se.get(Pt);Tt.forEach(Ht=>Eu(Ht,Ut))}),We.forEach((Tt,Pt)=>{const Ut=Ue.get(Pt);Tt.forEach(Ht=>Eu(Ht,Ut))}),Ne.forEach(Tt=>{this.processLeaveNode(Tt)})});const mt=[],Xe=[];for(let Tt=this._namespaceList.length-1;Tt>=0;Tt--)this._namespaceList[Tt].drainQueuedTransitions(e).forEach(Ut=>{const Ht=Ut.player,ln=Ut.element;if(mt.push(Ht),this.collectedEnterElements.length){const zi=ln[ns];if(zi&&zi.setForMove){if(zi.previousTriggersValues&&zi.previousTriggersValues.has(Ut.triggerName)){const Rs=zi.previousTriggersValues.get(Ut.triggerName),Pr=this.statesByElement.get(Ut.element);if(Pr&&Pr.has(Ut.triggerName)){const za=Pr.get(Ut.triggerName);za.value=Rs,Pr.set(Ut.triggerName,za)}}return void Ht.destroy()}}const ti=!de||!this.driver.containsElement(de,ln),si=Ue.get(ln),Di=Se.get(ln),qn=this._buildInstruction(Ut,i,Di,si,ti);if(qn.errors&&qn.errors.length)return void Xe.push(qn);if(ti)return Ht.onStart(()=>oc(ln,qn.fromStyles)),Ht.onDestroy(()=>Zs(ln,qn.toStyles)),void r.push(Ht);if(Ut.isFallbackTransition)return Ht.onStart(()=>oc(ln,qn.fromStyles)),Ht.onDestroy(()=>Zs(ln,qn.toStyles)),void r.push(Ht);const Nt=[];qn.timelines.forEach(zi=>{zi.stretchStartingKeyframe=!0,this.disabledNodes.has(zi.element)||Nt.push(zi)}),qn.timelines=Nt,i.append(ln,qn.timelines),s.push({instruction:qn,player:Ht,element:ln}),qn.queriedElements.forEach(zi=>Bo(a,zi,[]).push(Ht)),qn.preStyleProps.forEach((zi,Rs)=>{if(zi.size){let Pr=h.get(Rs);Pr||h.set(Rs,Pr=new Set),zi.forEach((za,Ml)=>Pr.add(Ml))}}),qn.postStyleProps.forEach((zi,Rs)=>{let Pr=b.get(Rs);Pr||b.set(Rs,Pr=new Set),zi.forEach((za,Ml)=>Pr.add(Ml))})});if(Xe.length){const Tt=[];Xe.forEach(Pt=>{Tt.push(function S8(t,n){return new nt(3505,!1)}())}),mt.forEach(Pt=>Pt.destroy()),this.reportError(Tt)}const ct=new Map,It=new Map;s.forEach(Tt=>{const Pt=Tt.element;i.has(Pt)&&(It.set(Pt,Pt),this._beforeAnimationBuild(Tt.player.namespaceId,Tt.instruction,ct))}),r.forEach(Tt=>{const Pt=Tt.element;this._getPreviousPlayers(Pt,!1,Tt.namespaceId,Tt.triggerName,null).forEach(Ht=>{Bo(ct,Pt,[]).push(Ht),Ht.destroy()})});const ot=Ne.filter(Tt=>JE(Tt,h,b)),_t=new Map;ZE(_t,this.driver,He,b,ka).forEach(Tt=>{JE(Tt,h,b)&&ot.push(Tt)});const xt=new Map;Ce.forEach((Tt,Pt)=>{ZE(xt,this.driver,new Set(Tt),h,"!")}),ot.forEach(Tt=>{const Pt=_t.get(Tt),Ut=xt.get(Tt);_t.set(Tt,new Map([...Array.from(Pt?.entries()??[]),...Array.from(Ut?.entries()??[])]))});const Gt=[],on=[],gn={};s.forEach(Tt=>{const{element:Pt,player:Ut,instruction:Ht}=Tt;if(i.has(Pt)){if(ee.has(Pt))return Ut.onDestroy(()=>Zs(Pt,Ht.toStyles)),Ut.disabled=!0,Ut.overrideTotalTime(Ht.totalTime),void r.push(Ut);let ln=gn;if(It.size>1){let si=Pt;const Di=[];for(;si=si.parentNode;){const qn=It.get(si);if(qn){ln=qn;break}Di.push(si)}Di.forEach(qn=>It.set(qn,ln))}const ti=this._buildAnimation(Ut.namespaceId,Ht,ct,o,xt,_t);if(Ut.setRealPlayer(ti),ln===gn)Gt.push(Ut);else{const si=this.playersByElement.get(ln);si&&si.length&&(Ut.parentPlayer=al(si)),r.push(Ut)}}else oc(Pt,Ht.fromStyles),Ut.onDestroy(()=>Zs(Pt,Ht.toStyles)),on.push(Ut),ee.has(Pt)&&r.push(Ut)}),on.forEach(Tt=>{const Pt=o.get(Tt.element);if(Pt&&Pt.length){const Ut=al(Pt);Tt.setRealPlayer(Ut)}}),r.forEach(Tt=>{Tt.parentPlayer?Tt.syncPlayerEvents(Tt.parentPlayer):Tt.destroy()});for(let Tt=0;Tt<Ne.length;Tt++){const Pt=Ne[Tt],Ut=Pt[ns];if(Eu(Pt,Rp),Ut&&Ut.hasAnimation)continue;let Ht=[];if(a.size){let ti=a.get(Pt);ti&&ti.length&&Ht.push(...ti);let si=this.driver.query(Pt,p0,!0);for(let Di=0;Di<si.length;Di++){let qn=a.get(si[Di]);qn&&qn.length&&Ht.push(...qn)}}const ln=Ht.filter(ti=>!ti.destroyed);ln.length?kL(this,Pt,ln):this.processLeaveNode(Pt)}return Ne.length=0,Gt.forEach(Tt=>{this.players.push(Tt),Tt.onDone(()=>{Tt.destroy();const Pt=this.players.indexOf(Tt);this.players.splice(Pt,1)}),Tt.play()}),Gt}elementContainsData(n,e){let i=!1;const r=e[ns];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const h=!o||o==hf;a.forEach(b=>{b.queued||!h&&b.triggerName!=r||s.push(b)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const h of e.timelines){const b=h.element,ee=b!==o,de=Bo(i,b,[]);this._getPreviousPlayers(b,ee,s,a,e.toState).forEach(Ce=>{const Se=Ce.getRealPlayer();Se.beforeDestroy&&Se.beforeDestroy(),Ce.destroy(),de.push(Ce)})}oc(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,h=e.element,b=[],ee=new Set,de=new Set,_e=e.timelines.map(Se=>{const Pe=Se.element;ee.add(Pe);const Ne=Pe[ns];if(Ne&&Ne.removedBeforeQueried)return new cf(Se.duration,Se.delay);const je=Pe!==h,He=function DL(t){const n=[];return QE(t,n),n}((i.get(Pe)||xL).map(ct=>ct.getRealPlayer())).filter(ct=>!!ct.element&&ct.element===Pe),Ue=o.get(Pe),We=s.get(Pe),mt=wE(0,this._normalizer,0,Se.keyframes,Ue,We),Xe=this._buildPlayer(Se,mt,He);if(Se.subTimeline&&r&&de.add(Pe),je){const ct=new I0(n,a,Pe);ct.setRealPlayer(Xe),b.push(ct)}return Xe});b.forEach(Se=>{Bo(this.playersByQueriedElement,Se.element,[]).push(Se),Se.onDone(()=>function SL(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,Se.element,Se))}),ee.forEach(Se=>is(Se,PE));const Ce=al(_e);return Ce.onDestroy(()=>{ee.forEach(Se=>Eu(Se,PE)),Zs(h,e.toStyles)}),de.forEach(Se=>{Bo(r,Se,[]).push(Ce)}),Ce}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new cf(n.duration,n.delay)}}class I0{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new cf,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>a0(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){Bo(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function Zp(t){return t&&1===t.nodeType}function YE(t,n){const e=t.style.display;return t.style.display=n??"none",e}function ZE(t,n,e,i,r){const o=[];e.forEach(h=>o.push(YE(h)));const s=[];i.forEach((h,b)=>{const ee=new Map;h.forEach(de=>{const _e=n.computeStyle(b,de,r);ee.set(de,_e),(!_e||0==_e.length)&&(b[ns]=wL,s.push(b))}),t.set(b,ee)});let a=0;return e.forEach(h=>YE(h,o[a++])),s}function XE(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),o=new Map;function s(a){if(!a)return 1;let h=o.get(a);if(h)return h;const b=a.parentNode;return h=e.has(b)?b:r.has(b)?1:s(b),o.set(a,h),h}return n.forEach(a=>{const h=s(a);1!==h&&e.get(h).push(a)}),e}function is(t,n){t.classList?.add(n)}function Eu(t,n){t.classList?.remove(n)}function kL(t,n,e){al(e).onDone(()=>t.processLeaveNode(n))}function QE(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof CE?QE(i.players,n):n.push(i)}}function JE(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class Xp{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,o)=>{},this._transitionEngine=new TL(n,e,i),this._timelineEngine=new $L(n,e,i),this._transitionEngine.onRemovalComplete=(r,o)=>this.onRemovalComplete(r,o)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const h=[],ee=$0(this._driver,o,h,[]);if(h.length)throw function m8(t,n){return new nt(3404,!1)}();a=function pL(t,n,e){return new gL(t,n,e)}(r,ee,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=EE(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=EE(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let NL=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let o=t.initialStylesByElement.get(e);o||t.initialStylesByElement.set(e,o=new Map),this._initialStyles=o}start(){this._state<1&&(this._startStyles&&Zs(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Zs(this._element,this._initialStyles),this._endStyles&&(Zs(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(oc(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(oc(this._element,this._endStyles),this._endStyles=null),Zs(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function M0(t){let n=null;return t.forEach((e,i)=>{(function OL(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class e3{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map,this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:BE(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class FL{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return ME(n,e)}getParentElement(n){return d0(n)}query(n,e,i){return kE(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,o,s=[]){const h={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(h.easing=o);const b=new Map,ee=s.filter(Ce=>Ce instanceof e3);(function z8(t,n){return 0===t||0===n})(i,r)&&ee.forEach(Ce=>{Ce.currentSnapshot.forEach((Se,Pe)=>b.set(Pe,Se))});let de=function F8(t){return t.length?t[0]instanceof Map?t:t.map(n=>NE(n)):[]}(e).map(Ce=>ll(Ce));de=function j8(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,BE(t,a)))}}return n}(n,de,b);const _e=function PL(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=M0(n[0]),n.length>1&&(i=M0(n[n.length-1]))):n instanceof Map&&(e=M0(n)),e||i?new NL(t,e,i):null}(n,de);return new e3(n,de,h,_e)}}let RL=(()=>{class t extends vE{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:$s.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?bE(e):e;return t3(this._renderer,null,i,"register",[r]),new LL(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)($n(kd),$n(Oo))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class LL extends class K6{}{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new BL(this._id,n,e||{},this._renderer)}}class BL{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return t3(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){return this._renderer.engine.players[+this.id]?.getPosition()??0}}function t3(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const n3="@.disabled";let zL=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(o,s)=>{const a=s?.parentNode(o);a&&s.removeChild(a,o)}}createRenderer(e,i){const o=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let ee=this._rendererCache.get(o);return ee||(ee=new i3("",o,this.engine,()=>this._rendererCache.delete(o)),this._rendererCache.set(o,ee)),ee}const s=i.id,a=i.id+"-"+this._currentId;this._currentId++,this.engine.register(a,e);const h=ee=>{Array.isArray(ee)?ee.forEach(h):this.engine.registerTrigger(s,a,e,ee.name,ee)};return i.data.animation.forEach(h),new jL(this,a,o,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)($n(kd),$n(Xp),$n(Fn))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class i3{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.destroyNode=this.delegate.destroyNode?o=>e.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy(),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==n3?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class jL extends i3{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==n3?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function UL(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function HL(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}let VL=(()=>{class t extends Xp{constructor(e,i,r,o){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)($n(Oo),$n(f0),$n(x0),$n(Wd))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();const r3=[{provide:vE,useClass:RL},{provide:x0,useFactory:function GL(){return new uL}},{provide:Xp,useClass:VL},{provide:kd,useFactory:function qL(t,n,e){return new zL(t,n,e)},deps:[Ep,Xp,Fn]}],k0=[{provide:f0,useFactory:()=>new FL},{provide:n2,useValue:"BrowserAnimations"},...r3],o3=[{provide:f0,useClass:DE},{provide:n2,useValue:"NoopAnimations"},...r3];let WL=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?o3:k0}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({providers:k0,imports:[hw]}),t})(),pf=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=mn({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[Cs],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(Z(0,"div",0),$e(1),ne()),2&e&&(ie("@bounce",i.animeState),V(1),dt(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Hn("bounce",[Fp("active",ht({transform:""})),en("* => active",[Qt("600ms ease",Cn([ht({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),ht({transform:"scale3d(2, 2, 2)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})();var D0,hn=me(5861);(D0||(D0={})).resize=function n(e,i,r,o){let s=e.width,a=e.height,h=s/(i=Math.round(i)),b=a/(r=Math.round(r)),ee=Math.ceil(h/2),de=Math.ceil(b/2),_e=e.getContext("2d"),Ce=_e.getImageData(0,0,s,a),Se=_e.createImageData(i,r),Pe=Ce.data,Ne=Se.data;for(let je=0;je<r;je++)for(let He=0;He<i;He++){let Ue=4*(He+je*i),We=0,mt=0,Xe=0,ct=0,It=0,ot=0,_t=0,Ct=(je+.5)*b,xt=Math.floor(je*b),Gt=Math.ceil((je+1)*b);for(let on=xt;on<Gt;on++){let gn=Math.abs(Ct-(on+.5))/de,Tt=(He+.5)*h,Pt=gn*gn,Ut=Math.floor(He*h),Ht=Math.ceil((He+1)*h);for(let ln=Ut;ln<Ht;ln++){let ti=Math.abs(Tt-(ln+.5))/ee,si=Math.sqrt(Pt+ti*ti);if(si>=1)continue;We=2*si*si*si-3*si*si+1;let Di=4*(ln+on*s);_t+=We*Pe[Di+3],Xe+=We,Pe[Di+3]<255&&(We=We*Pe[Di+3]/250),ct+=We*Pe[Di],It+=We*Pe[Di+1],ot+=We*Pe[Di+2],mt+=We}}Ne[Ue]=ct/mt,Ne[Ue+1]=It/mt,Ne[Ue+2]=ot/mt,Ne[Ue+3]=_t/Xe}!0===o?(e.width=i,e.height=r):_e.clearRect(0,0,s,a),_e.putImageData(Se,0,0)};var Ps,KL=me(7412),s3=me(1817);!function(t){function r(){return(r=(0,hn.Z)(function*(h){return h instanceof Blob?o(h):a(h)})).apply(this,arguments)}function o(h){return s.apply(this,arguments)}function s(){return(s=(0,hn.Z)(function*(h){return a(yield t.readAsArrayBufferAsync(h))})).apply(this,arguments)}function a(h){let b=KL.create(h);return s3(b).toString()}t.readAsArrayBufferAsync=function n(h){return new Promise((b,ee)=>{let de=new FileReader;de.onload=_e=>{b(de.result)},de.onabort=de.onerror=_e=>{ee(_e)},de.readAsArrayBuffer(h)})},t.readAsTextAsync=function e(h){return new Promise((b,ee)=>{let de=new FileReader;de.onload=_e=>{b(de.result)},de.onabort=de.onerror=_e=>{ee(_e)},de.readAsText(h)})},t.calcSHA256Async=function i(h){return r.apply(this,arguments)}}(Ps||(Ps={}));var Pi=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Pi||(Pi={})),Pi))();class sn{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Pi.URL:this.blob===this.thumbnail.blob?Pi.THUMBNAIL:Pi.COMPLETE:Pi.NULL}get isEmpty(){return this.state<=Pi.NULL}static createEmpty(n){let e=new sn;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new sn;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new sn;return e.apply(n),e}}static createAsync(n){return(0,hn.Z)(function*(){return n instanceof File?yield sn._createAsync(n,n.name):n instanceof Blob?yield sn._createAsync(n):void 0})()}static _createAsync(n,e){return(0,hn.Z)(function*(){let i=yield Ps.readAsArrayBufferAsync(n),r=new sn;r.context.identifier=yield Ps.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield sn.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Pi.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.state!==Pi.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Pi.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Pi.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,h=r.height*s,b=document.createElement("canvas"),ee=b.getContext("2d");b.width=r.width,b.height=r.height,ee.drawImage(r,0,0),D0.resize(b,a,h,!0),b.toBlob(de=>{let _e={type:de.type,blob:de,url:window.URL.createObjectURL(de)};e(_e)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}sn.Empty=sn.createEmpty("null");let Tu=0;const gf=new Map,Jp=new MessageChannel;function Ur(t){if(4294967296===Tu&&(Tu=0),++Tu in gf)throw new Error("setZeroTimeout queue overflow.");return gf.set(Tu,t),Jp.port2.postMessage(Tu),Tu}Jp.port1.onmessage=function(t){const n=gf.get(t.data);gf.delete(t.data),n&&n()},Jp.port1.start(),Jp.port2.start();class a3{}var l3=me(8497),cl=(()=>(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH"}(cl||(cl={})),cl))();const XL=function ZL(t){if(t.length>=255)throw new TypeError("Alphabet too long");const n=new Uint8Array(256);for(let b=0;b<n.length;b++)n[b]=255;for(let b=0;b<t.length;b++){const ee=t.charAt(b),de=ee.charCodeAt(0);if(255!==n[de])throw new TypeError(ee+" is ambiguous");n[de]=b}const e=t.length,i=t.charAt(0),r=Math.log(e)/Math.log(256),o=Math.log(256)/Math.log(e);function a(b){if("string"!=typeof b)throw new TypeError("Expected String");if(0===b.length)return new Uint8Array;let ee=0;if(" "===b[ee])return;let de=0,_e=0;for(;b[ee]===i;)de++,ee++;const Ce=(b.length-ee)*r+1>>>0,Se=new Uint8Array(Ce);for(;b[ee];){let He=n[b.charCodeAt(ee)];if(255===He)return;let Ue=0;for(let We=Ce-1;(0!==He||Ue<_e)&&-1!==We;We--,Ue++)He+=e*Se[We]>>>0,Se[We]=He%256>>>0,He=He/256>>>0;if(0!==He)throw new Error("Non-zero carry");_e=Ue,ee++}if(" "===b[ee])return;let Pe=Ce-_e;for(;Pe!==Ce&&0===Se[Pe];)Pe++;const Ne=new Uint8Array(de+(Ce-Pe));let je=de;for(;Pe!==Ce;)Ne[je++]=Se[Pe++];return Ne}return{encode:function s(b){if(b instanceof Uint8Array||(ArrayBuffer.isView(b)?b=new Uint8Array(b.buffer,b.byteOffset,b.byteLength):Array.isArray(b)&&(b=Uint8Array.from(b))),!(b instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===b.length)return"";let ee=0,de=0,_e=0;const Ce=b.length;for(;_e!==Ce&&0===b[_e];)_e++,ee++;const Se=(Ce-_e)*o+1>>>0,Pe=new Uint8Array(Se);for(;_e!==Ce;){let He=b[_e],Ue=0;for(let We=Se-1;(0!==He||Ue<de)&&-1!==We;We--,Ue++)He+=256*Pe[We]>>>0,Pe[We]=He%e>>>0,He=He/e>>>0;if(0!==He)throw new Error("Non-zero carry");de=Ue,_e++}let Ne=Se-de;for(;Ne!==Se&&0===Pe[Ne];)Ne++;let je=i.repeat(ee);for(;Ne<Se;++Ne)je+=t.charAt(Pe[Ne]);return je},decodeUnsafe:a,decode:function h(b){const ee=a(b);if(ee)return ee;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),QL=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class ki{constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:cl.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(n){try{this.peerId=n;let e=QL.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=l3.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return c3(this.roomId,n)===this.digestPassword}static parse(n){return new ki(n)}static create(...n){return n.length<=1?ki._create.apply(this,n):ki._createRoom.apply(this,n)}static _create(n=""){let e=function JL(t){return null==t?"":u3(t)}(n),i=new ki(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let o=this.generateId("******"),s=c3(e,r),a=`${o}${e}${l3.n(i)}-${s}`,h=new ki(a);return h.userId=n,h.password=r,h}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function c3(t,n){return null==t||null==n?"":0<n.length?u3(t+n,7):""}function u3(t,n=-1){if(null==t)return"";let e=s3(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=XL.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}function Su(t){let n=t.length;for(;--n>=0;)t[n]=0}const F0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),eg=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),aB=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),$3=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Aa=new Array(576);Su(Aa);const $f=new Array(60);Su($f);const vf=new Array(512);Su(vf);const bf=new Array(256);Su(bf);const R0=new Array(29);Su(R0);const tg=new Array(30);function L0(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let v3,b3,y3;function B0(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}Su(tg);const C3=t=>t<256?vf[t]:vf[256+(t>>>7)],yf=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},bo=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,yf(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},Xs=(t,n,e)=>{bo(t,e[2*n],e[2*n+1])},x3=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},w3=(t,n,e)=>{const i=new Array(16);let o,s,r=0;for(o=1;o<=15;o++)r=r+e[o-1]<<1,i[o]=r;for(s=0;s<=n;s++){let a=t[2*s+1];0!==a&&(t[2*s]=x3(i[a]++,a))}},E3=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},T3=t=>{t.bi_valid>8?yf(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},S3=(t,n,e,i)=>{const r=2*n,o=2*e;return t[r]<t[o]||t[r]===t[o]&&i[n]<=i[e]},z0=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&S3(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!S3(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},I3=(t,n,e)=>{let i,r,s,a,o=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+o++],i+=(255&t.pending_buf[t.sym_buf+o++])<<8,r=t.pending_buf[t.sym_buf+o++],0===i?Xs(t,r,n):(s=bf[r],Xs(t,s+256+1,n),a=F0[s],0!==a&&(r-=R0[s],bo(t,r,a)),i--,s=C3(i),Xs(t,s,e),a=eg[s],0!==a&&(i-=tg[s],bo(t,i,a)))}while(o<t.sym_next);Xs(t,256,n)},j0=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,o=n.stat_desc.elems;let s,a,b,h=-1;for(t.heap_len=0,t.heap_max=573,s=0;s<o;s++)0!==e[2*s]?(t.heap[++t.heap_len]=h=s,t.depth[s]=0):e[2*s+1]=0;for(;t.heap_len<2;)b=t.heap[++t.heap_len]=h<2?++h:0,e[2*b]=1,t.depth[b]=0,t.opt_len--,r&&(t.static_len-=i[2*b+1]);for(n.max_code=h,s=t.heap_len>>1;s>=1;s--)z0(t,e,s);b=o;do{s=t.heap[1],t.heap[1]=t.heap[t.heap_len--],z0(t,e,1),a=t.heap[1],t.heap[--t.heap_max]=s,t.heap[--t.heap_max]=a,e[2*b]=e[2*s]+e[2*a],t.depth[b]=(t.depth[s]>=t.depth[a]?t.depth[s]:t.depth[a])+1,e[2*s+1]=e[2*a+1]=b,t.heap[1]=b++,z0(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,o=n.stat_desc.has_stree,s=n.stat_desc.extra_bits,a=n.stat_desc.extra_base,h=n.stat_desc.max_length;let b,ee,de,_e,Ce,Se,Pe=0;for(_e=0;_e<=15;_e++)t.bl_count[_e]=0;for(e[2*t.heap[t.heap_max]+1]=0,b=t.heap_max+1;b<573;b++)ee=t.heap[b],_e=e[2*e[2*ee+1]+1]+1,_e>h&&(_e=h,Pe++),e[2*ee+1]=_e,!(ee>i)&&(t.bl_count[_e]++,Ce=0,ee>=a&&(Ce=s[ee-a]),Se=e[2*ee],t.opt_len+=Se*(_e+Ce),o&&(t.static_len+=Se*(r[2*ee+1]+Ce)));if(0!==Pe){do{for(_e=h-1;0===t.bl_count[_e];)_e--;t.bl_count[_e]--,t.bl_count[_e+1]+=2,t.bl_count[h]--,Pe-=2}while(Pe>0);for(_e=h;0!==_e;_e--)for(ee=t.bl_count[_e];0!==ee;)de=t.heap[--b],!(de>i)&&(e[2*de+1]!==_e&&(t.opt_len+=(_e-e[2*de+1])*e[2*de],e[2*de+1]=_e),ee--)}})(t,n),w3(e,h,t.bl_count)},M3=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,h=7,b=4;for(0===s&&(h=138,b=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)o=s,s=n[2*(i+1)+1],!(++a<h&&o===s)&&(a<b?t.bl_tree[2*o]+=a:0!==o?(o!==r&&t.bl_tree[2*o]++,t.bl_tree[32]++):a<=10?t.bl_tree[34]++:t.bl_tree[36]++,a=0,r=o,0===s?(h=138,b=3):o===s?(h=6,b=3):(h=7,b=4))},k3=(t,n,e)=>{let i,o,r=-1,s=n[1],a=0,h=7,b=4;for(0===s&&(h=138,b=3),i=0;i<=e;i++)if(o=s,s=n[2*(i+1)+1],!(++a<h&&o===s)){if(a<b)do{Xs(t,o,t.bl_tree)}while(0!=--a);else 0!==o?(o!==r&&(Xs(t,o,t.bl_tree),a--),Xs(t,16,t.bl_tree),bo(t,a-3,2)):a<=10?(Xs(t,17,t.bl_tree),bo(t,a-3,3)):(Xs(t,18,t.bl_tree),bo(t,a-11,7));a=0,r=o,0===s?(h=138,b=3):o===s?(h=6,b=3):(h=7,b=4)}};let D3=!1;const A3=(t,n,e,i)=>{bo(t,0+(i?1:0),3),T3(t),yf(t,e),yf(t,~e),e&&t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e};var wB={_tr_init:t=>{D3||((()=>{let t,n,e,i,r;const o=new Array(16);for(e=0,i=0;i<28;i++)for(R0[i]=e,t=0;t<1<<F0[i];t++)bf[e++]=i;for(bf[e-1]=i,r=0,i=0;i<16;i++)for(tg[i]=r,t=0;t<1<<eg[i];t++)vf[r++]=i;for(r>>=7;i<30;i++)for(tg[i]=r<<7,t=0;t<1<<eg[i]-7;t++)vf[256+r++]=i;for(n=0;n<=15;n++)o[n]=0;for(t=0;t<=143;)Aa[2*t+1]=8,t++,o[8]++;for(;t<=255;)Aa[2*t+1]=9,t++,o[9]++;for(;t<=279;)Aa[2*t+1]=7,t++,o[7]++;for(;t<=287;)Aa[2*t+1]=8,t++,o[8]++;for(w3(Aa,287,o),t=0;t<30;t++)$f[2*t+1]=5,$f[2*t]=x3(t,5);v3=new L0(Aa,F0,257,286,15),b3=new L0($f,eg,0,30,15),y3=new L0(new Array(0),aB,0,19,7)})(),D3=!0),t.l_desc=new B0(t.dyn_ltree,v3),t.d_desc=new B0(t.dyn_dtree,b3),t.bl_desc=new B0(t.bl_tree,y3),t.bi_buf=0,t.bi_valid=0,E3(t)},_tr_stored_block:A3,_tr_flush_block:(t,n,e,i)=>{let r,o,s=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),j0(t,t.l_desc),j0(t,t.d_desc),s=(t=>{let n;for(M3(t,t.dyn_ltree,t.l_desc.max_code),M3(t,t.dyn_dtree,t.d_desc.max_code),j0(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*$3[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,o=t.static_len+3+7>>>3,o<=r&&(r=o)):r=o=e+5,e+4<=r&&-1!==n?A3(t,n,e,i):4===t.strategy||o===r?(bo(t,2+(i?1:0),3),I3(t,Aa,$f)):(bo(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(bo(t,n-257,5),bo(t,e-1,5),bo(t,i-4,4),r=0;r<i;r++)bo(t,t.bl_tree[2*$3[r]+1],3);k3(t,t.dyn_ltree,n-1),k3(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,s+1),I3(t,t.dyn_ltree,t.dyn_dtree)),E3(t),i&&T3(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.sym_buf+t.sym_next++]=n,t.pending_buf[t.sym_buf+t.sym_next++]=n>>8,t.pending_buf[t.sym_buf+t.sym_next++]=e,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(bf[e]+256+1)]++,t.dyn_dtree[2*C3(n)]++),t.sym_next===t.sym_end),_tr_align:t=>{bo(t,2,3),Xs(t,256,Aa),(t=>{16===t.bi_valid?(yf(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Cf=(t,n,e,i)=>{let r=65535&t|0,o=t>>>16&65535|0,s=0;for(;0!==e;){s=e>2e3?2e3:e,e-=s;do{r=r+n[i++]|0,o=o+r|0}while(--s);r%=65521,o%=65521}return r|o<<16|0};const TB=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var Er=(t,n,e,i)=>{const r=TB,o=i+e;t^=-1;for(let s=i;s<o;s++)t=t>>>8^r[255&(t^n[s])];return-1^t},lc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},cc={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:SB,_tr_stored_block:U0,_tr_flush_block:IB,_tr_tally:ul,_tr_align:MB}=wB,{Z_NO_FLUSH:dl,Z_PARTIAL_FLUSH:kB,Z_FULL_FLUSH:DB,Z_FINISH:rs,Z_BLOCK:P3,Z_OK:kr,Z_STREAM_END:N3,Z_STREAM_ERROR:Qs,Z_DATA_ERROR:AB,Z_BUF_ERROR:H0,Z_DEFAULT_COMPRESSION:PB,Z_FILTERED:NB,Z_HUFFMAN_ONLY:ng,Z_RLE:OB,Z_FIXED:FB,Z_DEFAULT_STRATEGY:RB,Z_UNKNOWN:LB,Z_DEFLATED:ig}=cc,Js=262,fc=(t,n)=>(t.msg=lc[n],n),O3=t=>2*t-(t>4?9:0),hl=t=>{let n=t.length;for(;--n>=0;)t[n]=0},YB=t=>{let n,e,i,r=t.w_size;n=t.hash_size,i=n;do{e=t.head[--i],t.head[i]=e>=r?e-r:0}while(--n);n=r,i=n;do{e=t.prev[--i],t.prev[i]=e>=r?e-r:0}while(--n)};let pl=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const jo=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},Uo=(t,n)=>{IB(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,jo(t.strm)},ci=(t,n)=>{t.pending_buf[t.pending++]=n},wf=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},Z0=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=Cf(t.adler,n,r,e):2===t.state.wrap&&(t.adler=Er(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},F3=(t,n)=>{let r,o,e=t.max_chain_length,i=t.strstart,s=t.prev_length,a=t.nice_match;const h=t.strstart>t.w_size-Js?t.strstart-(t.w_size-Js):0,b=t.window,ee=t.w_mask,de=t.prev,_e=t.strstart+258;let Ce=b[i+s-1],Se=b[i+s];t.prev_length>=t.good_match&&(e>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=n,b[r+s]===Se&&b[r+s-1]===Ce&&b[r]===b[i]&&b[++r]===b[i+1]){i+=2,r++;do{}while(b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&b[++i]===b[++r]&&i<_e);if(o=258-(_e-i),i=_e-258,o>s){if(t.match_start=n,s=o,o>=a)break;Ce=b[i+s-1],Se=b[i+s]}}}while((n=de[n&ee])>h&&0!=--e);return s<=t.lookahead?s:t.lookahead},Au=t=>{const n=t.w_size;let e,i,r;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-Js)&&(t.window.set(t.window.subarray(n,n+n-i),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,t.insert>t.strstart&&(t.insert=t.strstart),YB(t),i+=n),0===t.strm.avail_in)break;if(e=Z0(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=e,t.lookahead+t.insert>=3)for(r=t.strstart-t.insert,t.ins_h=t.window[r],t.ins_h=pl(t,t.ins_h,t.window[r+1]);t.insert&&(t.ins_h=pl(t,t.ins_h,t.window[r+3-1]),t.prev[r&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=r,r++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<Js&&0!==t.strm.avail_in)},R3=(t,n)=>{let i,r,o,e=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,s=0,a=t.strm.avail_in;do{if(i=65535,o=t.bi_valid+42>>3,t.strm.avail_out<o||(o=t.strm.avail_out-o,r=t.strstart-t.block_start,i>r+t.strm.avail_in&&(i=r+t.strm.avail_in),i>o&&(i=o),i<e&&(0===i&&n!==rs||n===dl||i!==r+t.strm.avail_in)))break;s=n===rs&&i===r+t.strm.avail_in?1:0,U0(t,0,0,s),t.pending_buf[t.pending-4]=i,t.pending_buf[t.pending-3]=i>>8,t.pending_buf[t.pending-2]=~i,t.pending_buf[t.pending-1]=~i>>8,jo(t.strm),r&&(r>i&&(r=i),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+r),t.strm.next_out),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r,t.block_start+=r,i-=r),i&&(Z0(t.strm,t.strm.output,t.strm.next_out,i),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i)}while(0===s);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),s?4:n!==dl&&n!==rs&&0===t.strm.avail_in&&t.strstart===t.block_start?2:(o=t.window_size-t.strstart,t.strm.avail_in>o&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,o+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),o>t.strm.avail_in&&(o=t.strm.avail_in),o&&(Z0(t.strm,t.window,t.strstart,o),t.strstart+=o,t.insert+=o>t.w_size-t.insert?t.w_size-t.insert:o),t.high_water<t.strstart&&(t.high_water=t.strstart),o=t.bi_valid+42>>3,o=t.pending_buf_size-o>65535?65535:t.pending_buf_size-o,e=o>t.w_size?t.w_size:o,r=t.strstart-t.block_start,(r>=e||(r||n===rs)&&n!==dl&&0===t.strm.avail_in&&r<=o)&&(i=r>o?o:r,s=n===rs&&0===t.strm.avail_in&&i===r?1:0,U0(t,t.block_start,i,s),t.block_start+=i,jo(t.strm)),s?3:1)},X0=(t,n)=>{let e,i;for(;;){if(t.lookahead<Js){if(Au(t),t.lookahead<Js&&n===dl)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=pl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-Js&&(t.match_length=F3(t,e)),t.match_length>=3)if(i=ul(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=pl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=pl(t,t.ins_h,t.window[t.strstart+1]);else i=ul(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(Uo(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===rs?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2},Pu=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<Js){if(Au(t),t.lookahead<Js&&n===dl)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=pl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-Js&&(t.match_length=F3(t,e),t.match_length<=5&&(t.strategy===NB||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=ul(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=pl(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(Uo(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=ul(t,0,t.window[t.strstart-1]),i&&Uo(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=ul(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===rs?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2};function ea(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const Ef=[new ea(0,0,0,0,R3),new ea(4,4,8,4,X0),new ea(4,5,16,8,X0),new ea(4,6,32,32,X0),new ea(4,4,16,16,Pu),new ea(8,16,32,32,Pu),new ea(8,16,128,128,Pu),new ea(8,32,128,256,Pu),new ea(32,128,258,1024,Pu),new ea(32,258,258,4096,Pu)];function JB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ig,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),hl(this.dyn_ltree),hl(this.dyn_dtree),hl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),hl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),hl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Tf=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||42!==n.status&&57!==n.status&&69!==n.status&&73!==n.status&&91!==n.status&&103!==n.status&&113!==n.status&&666!==n.status?1:0},L3=t=>{if(Tf(t))return fc(t,Qs);t.total_in=t.total_out=0,t.data_type=LB;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=2===n.wrap?57:n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=-2,SB(n),kr},B3=t=>{const n=L3(t);return n===kr&&(t=>{t.window_size=2*t.w_size,hl(t.head),t.max_lazy_match=Ef[t.level].max_lazy,t.good_match=Ef[t.level].good_length,t.nice_match=Ef[t.level].nice_length,t.max_chain_length=Ef[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},z3=(t,n,e,i,r,o)=>{if(!t)return Qs;let s=1;if(n===PB&&(n=6),i<0?(s=0,i=-i):i>15&&(s=2,i-=16),r<1||r>9||e!==ig||i<8||i>15||n<0||n>9||o<0||o>FB||8===i&&1!==s)return fc(t,Qs);8===i&&(i=9);const a=new JB;return t.state=a,a.strm=t,a.status=42,a.wrap=s,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=r+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+3-1)/3),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<r+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=n,a.strategy=o,a.method=e,B3(t)};var Sf_deflateInit2=z3,Sf_deflateSetHeader=(t,n)=>Tf(t)||2!==t.state.wrap?Qs:(t.state.gzhead=n,kr),Sf_deflate=(t,n)=>{if(Tf(t)||n>P3||n<0)return t?fc(t,Qs):Qs;const e=t.state;if(!t.output||0!==t.avail_in&&!t.input||666===e.status&&n!==rs)return fc(t,0===t.avail_out?H0:Qs);const i=e.last_flush;if(e.last_flush=n,0!==e.pending){if(jo(t),0===t.avail_out)return e.last_flush=-1,kr}else if(0===t.avail_in&&O3(n)<=O3(i)&&n!==rs)return fc(t,H0);if(666===e.status&&0!==t.avail_in)return fc(t,H0);if(42===e.status&&0===e.wrap&&(e.status=113),42===e.status){let r=ig+(e.w_bits-8<<4)<<8,o=-1;if(o=e.strategy>=ng||e.level<2?0:e.level<6?1:6===e.level?2:3,r|=o<<6,0!==e.strstart&&(r|=32),r+=31-r%31,wf(e,r),0!==e.strstart&&(wf(e,t.adler>>>16),wf(e,65535&t.adler)),t.adler=1,e.status=113,jo(t),0!==e.pending)return e.last_flush=-1,kr}if(57===e.status)if(t.adler=0,ci(e,31),ci(e,139),ci(e,8),e.gzhead)ci(e,(e.gzhead.text?1:0)+(e.gzhead.hcrc?2:0)+(e.gzhead.extra?4:0)+(e.gzhead.name?8:0)+(e.gzhead.comment?16:0)),ci(e,255&e.gzhead.time),ci(e,e.gzhead.time>>8&255),ci(e,e.gzhead.time>>16&255),ci(e,e.gzhead.time>>24&255),ci(e,9===e.level?2:e.strategy>=ng||e.level<2?4:0),ci(e,255&e.gzhead.os),e.gzhead.extra&&e.gzhead.extra.length&&(ci(e,255&e.gzhead.extra.length),ci(e,e.gzhead.extra.length>>8&255)),e.gzhead.hcrc&&(t.adler=Er(t.adler,e.pending_buf,e.pending,0)),e.gzindex=0,e.status=69;else if(ci(e,0),ci(e,0),ci(e,0),ci(e,0),ci(e,0),ci(e,9===e.level?2:e.strategy>=ng||e.level<2?4:0),ci(e,3),e.status=113,jo(t),0!==e.pending)return e.last_flush=-1,kr;if(69===e.status){if(e.gzhead.extra){let r=e.pending,o=(65535&e.gzhead.extra.length)-e.gzindex;for(;e.pending+o>e.pending_buf_size;){let a=e.pending_buf_size-e.pending;if(e.pending_buf.set(e.gzhead.extra.subarray(e.gzindex,e.gzindex+a),e.pending),e.pending=e.pending_buf_size,e.gzhead.hcrc&&e.pending>r&&(t.adler=Er(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex+=a,jo(t),0!==e.pending)return e.last_flush=-1,kr;r=0,o-=a}let s=new Uint8Array(e.gzhead.extra);e.pending_buf.set(s.subarray(e.gzindex,e.gzindex+o),e.pending),e.pending+=o,e.gzhead.hcrc&&e.pending>r&&(t.adler=Er(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=73}if(73===e.status){if(e.gzhead.name){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=Er(t.adler,e.pending_buf,e.pending-r,r)),jo(t),0!==e.pending)return e.last_flush=-1,kr;r=0}o=e.gzindex<e.gzhead.name.length?255&e.gzhead.name.charCodeAt(e.gzindex++):0,ci(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=Er(t.adler,e.pending_buf,e.pending-r,r)),e.gzindex=0}e.status=91}if(91===e.status){if(e.gzhead.comment){let o,r=e.pending;do{if(e.pending===e.pending_buf_size){if(e.gzhead.hcrc&&e.pending>r&&(t.adler=Er(t.adler,e.pending_buf,e.pending-r,r)),jo(t),0!==e.pending)return e.last_flush=-1,kr;r=0}o=e.gzindex<e.gzhead.comment.length?255&e.gzhead.comment.charCodeAt(e.gzindex++):0,ci(e,o)}while(0!==o);e.gzhead.hcrc&&e.pending>r&&(t.adler=Er(t.adler,e.pending_buf,e.pending-r,r))}e.status=103}if(103===e.status){if(e.gzhead.hcrc){if(e.pending+2>e.pending_buf_size&&(jo(t),0!==e.pending))return e.last_flush=-1,kr;ci(e,255&t.adler),ci(e,t.adler>>8&255),t.adler=0}if(e.status=113,jo(t),0!==e.pending)return e.last_flush=-1,kr}if(0!==t.avail_in||0!==e.lookahead||n!==dl&&666!==e.status){let r=0===e.level?R3(e,n):e.strategy===ng?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(Au(t),0===t.lookahead)){if(n===dl)return 1;break}if(t.match_length=0,e=ul(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(Uo(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===rs?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2})(e,n):e.strategy===OB?((t,n)=>{let e,i,r,o;const s=t.window;for(;;){if(t.lookahead<=258){if(Au(t),t.lookahead<=258&&n===dl)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=s[r],i===s[++r]&&i===s[++r]&&i===s[++r])){o=t.strstart+258;do{}while(i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&i===s[++r]&&r<o);t.match_length=258-(o-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=ul(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=ul(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(Uo(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===rs?(Uo(t,!0),0===t.strm.avail_out?3:4):t.sym_next&&(Uo(t,!1),0===t.strm.avail_out)?1:2})(e,n):Ef[e.level].func(e,n);if((3===r||4===r)&&(e.status=666),1===r||3===r)return 0===t.avail_out&&(e.last_flush=-1),kr;if(2===r&&(n===kB?MB(e):n!==P3&&(U0(e,0,0,!1),n===DB&&(hl(e.head),0===e.lookahead&&(e.strstart=0,e.block_start=0,e.insert=0))),jo(t),0===t.avail_out))return e.last_flush=-1,kr}return n!==rs?kr:e.wrap<=0?N3:(2===e.wrap?(ci(e,255&t.adler),ci(e,t.adler>>8&255),ci(e,t.adler>>16&255),ci(e,t.adler>>24&255),ci(e,255&t.total_in),ci(e,t.total_in>>8&255),ci(e,t.total_in>>16&255),ci(e,t.total_in>>24&255)):(wf(e,t.adler>>>16),wf(e,65535&t.adler)),jo(t),e.wrap>0&&(e.wrap=-e.wrap),0!==e.pending?kr:N3)},Sf_deflateEnd=t=>{if(Tf(t))return Qs;const n=t.state.status;return t.state=null,113===n?fc(t,AB):kr},Sf_deflateSetDictionary=(t,n)=>{let e=n.length;if(Tf(t))return Qs;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return Qs;if(1===r&&(t.adler=Cf(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(hl(i.head),i.strstart=0,i.block_start=0,i.insert=0);let h=new Uint8Array(i.w_size);h.set(n.subarray(e-i.w_size,e),0),n=h,e=i.w_size}const o=t.avail_in,s=t.next_in,a=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,Au(i);i.lookahead>=3;){let h=i.strstart,b=i.lookahead-2;do{i.ins_h=pl(i,i.ins_h,i.window[h+3-1]),i.prev[h&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=h,h++}while(--b);i.strstart=h,i.lookahead=2,Au(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=s,t.input=a,t.avail_in=o,i.wrap=r,kr};const pz=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var rg_assign=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)pz(e,i)&&(t[i]=e[i])}}return t},rg_flattenChunks=t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,o=t.length;i<o;i++){let s=t[i];e.set(s,r),r+=s.length}return e};let j3=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{j3=!1}const If=new Uint8Array(256);for(let t=0;t<256;t++)If[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;If[254]=If[254]=1;var Mf_string2buf=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,o,s=t.length,a=0;for(r=0;r<s;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(a),o=0,r=0;o<a;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<s&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[o++]=e:e<2048?(n[o++]=192|e>>>6,n[o++]=128|63&e):e<65536?(n[o++]=224|e>>>12,n[o++]=128|e>>>6&63,n[o++]=128|63&e):(n[o++]=240|e>>>18,n[o++]=128|e>>>12&63,n[o++]=128|e>>>6&63,n[o++]=128|63&e);return n},Mf_buf2string=(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const o=new Array(2*e);for(r=0,i=0;i<e;){let s=t[i++];if(s<128){o[r++]=s;continue}let a=If[s];if(a>4)o[r++]=65533,i+=a-1;else{for(s&=2===a?31:3===a?15:7;a>1&&i<e;)s=s<<6|63&t[i++],a--;a>1?o[r++]=65533:s<65536?o[r++]=s:(s-=65536,o[r++]=55296|s>>10&1023,o[r++]=56320|1023&s)}}return((t,n)=>{if(n<65534&&t.subarray&&j3)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(o,r)},Mf_utf8border=(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+If[t[e]]>n?e:n},U3=function yz(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const H3=Object.prototype.toString,{Z_NO_FLUSH:Cz,Z_SYNC_FLUSH:xz,Z_FULL_FLUSH:wz,Z_FINISH:Ez,Z_OK:og,Z_STREAM_END:Tz,Z_DEFAULT_COMPRESSION:Sz,Z_DEFAULT_STRATEGY:Iz,Z_DEFLATED:Mz}=cc;function kf(t){this.options=rg_assign({level:Sz,method:Mz,chunkSize:16384,windowBits:15,memLevel:8,strategy:Iz},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new U3,this.strm.avail_out=0;let e=Sf_deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==og)throw new Error(lc[e]);if(n.header&&Sf_deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?Mf_string2buf(n.dictionary):"[object ArrayBuffer]"===H3.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Sf_deflateSetDictionary(this.strm,i),e!==og)throw new Error(lc[e]);this._dict_set=!0}}function Q0(t,n){const e=new kf(n);if(e.push(t,!0),e.err)throw e.msg||lc[e.err];return e.result}kf.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,o;if(this.ended)return!1;for(o=n===~~n?n:!0===n?Ez:Cz,e.input="string"==typeof t?Mf_string2buf(t):"[object ArrayBuffer]"===H3.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(o===xz||o===wz)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Sf_deflate(e,o),r===Tz)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Sf_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===og;if(0!==e.avail_out){if(o>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},kf.prototype.onData=function(t){this.chunks.push(t)},kf.prototype.onEnd=function(t){t===og&&(this.result=rg_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Rz={Deflate:kf,deflate:Q0,deflateRaw:function kz(t,n){return(n=n||{}).raw=!0,Q0(t,n)},gzip:function Dz(t,n){return(n=n||{}).gzip=!0,Q0(t,n)},constants:cc};const sg=16209;var Bz=function(n,e){let i,r,o,s,a,h,b,ee,de,_e,Ce,Se,Pe,Ne,je,He,Ue,We,mt,Xe,ct,It,ot,_t;const Ct=n.state;i=n.next_in,ot=n.input,r=i+(n.avail_in-5),o=n.next_out,_t=n.output,s=o-(e-n.avail_out),a=o+(n.avail_out-257),h=Ct.dmax,b=Ct.wsize,ee=Ct.whave,de=Ct.wnext,_e=Ct.window,Ce=Ct.hold,Se=Ct.bits,Pe=Ct.lencode,Ne=Ct.distcode,je=(1<<Ct.lenbits)-1,He=(1<<Ct.distbits)-1;e:do{Se<15&&(Ce+=ot[i++]<<Se,Se+=8,Ce+=ot[i++]<<Se,Se+=8),Ue=Pe[Ce&je];t:for(;;){if(We=Ue>>>24,Ce>>>=We,Se-=We,We=Ue>>>16&255,0===We)_t[o++]=65535&Ue;else{if(!(16&We)){if(0==(64&We)){Ue=Pe[(65535&Ue)+(Ce&(1<<We)-1)];continue t}if(32&We){Ct.mode=16191;break e}n.msg="invalid literal/length code",Ct.mode=sg;break e}mt=65535&Ue,We&=15,We&&(Se<We&&(Ce+=ot[i++]<<Se,Se+=8),mt+=Ce&(1<<We)-1,Ce>>>=We,Se-=We),Se<15&&(Ce+=ot[i++]<<Se,Se+=8,Ce+=ot[i++]<<Se,Se+=8),Ue=Ne[Ce&He];n:for(;;){if(We=Ue>>>24,Ce>>>=We,Se-=We,We=Ue>>>16&255,!(16&We)){if(0==(64&We)){Ue=Ne[(65535&Ue)+(Ce&(1<<We)-1)];continue n}n.msg="invalid distance code",Ct.mode=sg;break e}if(Xe=65535&Ue,We&=15,Se<We&&(Ce+=ot[i++]<<Se,Se+=8,Se<We&&(Ce+=ot[i++]<<Se,Se+=8)),Xe+=Ce&(1<<We)-1,Xe>h){n.msg="invalid distance too far back",Ct.mode=sg;break e}if(Ce>>>=We,Se-=We,We=o-s,Xe>We){if(We=Xe-We,We>ee&&Ct.sane){n.msg="invalid distance too far back",Ct.mode=sg;break e}if(ct=0,It=_e,0===de){if(ct+=b-We,We<mt){mt-=We;do{_t[o++]=_e[ct++]}while(--We);ct=o-Xe,It=_t}}else if(de<We){if(ct+=b+de-We,We-=de,We<mt){mt-=We;do{_t[o++]=_e[ct++]}while(--We);if(ct=0,de<mt){We=de,mt-=We;do{_t[o++]=_e[ct++]}while(--We);ct=o-Xe,It=_t}}}else if(ct+=de-We,We<mt){mt-=We;do{_t[o++]=_e[ct++]}while(--We);ct=o-Xe,It=_t}for(;mt>2;)_t[o++]=It[ct++],_t[o++]=It[ct++],_t[o++]=It[ct++],mt-=3;mt&&(_t[o++]=It[ct++],mt>1&&(_t[o++]=It[ct++]))}else{ct=o-Xe;do{_t[o++]=_t[ct++],_t[o++]=_t[ct++],_t[o++]=_t[ct++],mt-=3}while(mt>2);mt&&(_t[o++]=_t[ct++],mt>1&&(_t[o++]=_t[ct++]))}break}}break}}while(i<r&&o<a);mt=Se>>3,i-=mt,Se-=mt<<3,Ce&=(1<<Se)-1,n.next_in=i,n.next_out=o,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=o<a?a-o+257:257-(o-a),Ct.hold=Ce,Ct.bits=Se};const zz=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),jz=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Uz=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Hz=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var Df=(t,n,e,i,r,o,s,a)=>{const h=a.bits;let Ue,We,mt,Xe,ct,ot,b=0,ee=0,de=0,_e=0,Ce=0,Se=0,Pe=0,Ne=0,je=0,He=0,It=null;const _t=new Uint16Array(16),Ct=new Uint16Array(16);let Gt,on,gn,xt=null;for(b=0;b<=15;b++)_t[b]=0;for(ee=0;ee<i;ee++)_t[n[e+ee]]++;for(Ce=h,_e=15;_e>=1&&0===_t[_e];_e--);if(Ce>_e&&(Ce=_e),0===_e)return r[o++]=20971520,r[o++]=20971520,a.bits=1,0;for(de=1;de<_e&&0===_t[de];de++);for(Ce<de&&(Ce=de),Ne=1,b=1;b<=15;b++)if(Ne<<=1,Ne-=_t[b],Ne<0)return-1;if(Ne>0&&(0===t||1!==_e))return-1;for(Ct[1]=0,b=1;b<15;b++)Ct[b+1]=Ct[b]+_t[b];for(ee=0;ee<i;ee++)0!==n[e+ee]&&(s[Ct[n[e+ee]]++]=ee);if(0===t?(It=xt=s,ot=20):1===t?(It=zz,xt=jz,ot=257):(It=Uz,xt=Hz,ot=0),He=0,ee=0,b=de,ct=o,Se=Ce,Pe=0,mt=-1,je=1<<Ce,Xe=je-1,1===t&&je>852||2===t&&je>592)return 1;for(;;){Gt=b-Pe,s[ee]+1<ot?(on=0,gn=s[ee]):s[ee]>=ot?(on=xt[s[ee]-ot],gn=It[s[ee]-ot]):(on=96,gn=0),Ue=1<<b-Pe,We=1<<Se,de=We;do{We-=Ue,r[ct+(He>>Pe)+We]=Gt<<24|on<<16|gn|0}while(0!==We);for(Ue=1<<b-1;He&Ue;)Ue>>=1;if(0!==Ue?(He&=Ue-1,He+=Ue):He=0,ee++,0==--_t[b]){if(b===_e)break;b=n[e+s[ee]]}if(b>Ce&&(He&Xe)!==mt){for(0===Pe&&(Pe=Ce),ct+=de,Se=b-Pe,Ne=1<<Se;Se+Pe<_e&&(Ne-=_t[Se+Pe],!(Ne<=0));)Se++,Ne<<=1;if(je+=1<<Se,1===t&&je>852||2===t&&je>592)return 1;mt=He&Xe,r[mt]=Ce<<24|Se<<16|ct-o|0}}return 0!==He&&(r[ct+He]=b-Pe<<24|64<<16|0),a.bits=Ce,0};const{Z_FINISH:Z3,Z_BLOCK:Gz,Z_TREES:ag,Z_OK:hc,Z_STREAM_END:qz,Z_NEED_DICT:Wz,Z_STREAM_ERROR:os,Z_DATA_ERROR:X3,Z_MEM_ERROR:Q3,Z_BUF_ERROR:Kz,Z_DEFLATED:J3}=cc,lg=16180,cg=16190,Pa=16191,ug=16199,dg=16200,Ri=16209,xT=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Qz(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const pc=t=>{if(!t)return 1;const n=t.state;return!n||n.strm!==t||n.mode<lg||n.mode>16211?1:0},wT=t=>{if(pc(t))return os;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=lg,n.last=0,n.havedict=0,n.flags=-1,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,hc},ET=t=>{if(pc(t))return os;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,wT(t)},TT=(t,n)=>{let e;if(pc(t))return os;const i=t.state;return n<0?(e=0,n=-n):(e=5+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?os:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,ET(t))},ST=(t,n)=>{if(!t)return os;const e=new Qz;t.state=e,e.strm=t,e.window=null,e.mode=lg;const i=TT(t,n);return i!==hc&&(t.state=null),i};let iv,rv,IT=!0;const e9=t=>{if(IT){iv=new Int32Array(512),rv=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(Df(1,t.lens,0,288,iv,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;Df(2,t.lens,0,32,rv,0,t.work,{bits:5}),IT=!1}t.lencode=iv,t.lenbits=9,t.distcode=rv,t.distbits=5},MT=(t,n,e,i)=>{let r;const o=t.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new Uint8Array(o.wsize)),i>=o.wsize?(o.window.set(n.subarray(e-o.wsize,e),0),o.wnext=0,o.whave=o.wsize):(r=o.wsize-o.wnext,r>i&&(r=i),o.window.set(n.subarray(e-i,e-i+r),o.wnext),(i-=r)?(o.window.set(n.subarray(e-i,e),0),o.wnext=i,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0};var Na_inflateReset=ET,Na_inflateInit2=ST,Na_inflate=(t,n)=>{let e,i,r,o,s,a,h,b,ee,de,_e,Ce,Se,Pe,je,He,Ue,We,mt,Xe,ct,It,Ne=0;const ot=new Uint8Array(4);let _t,Ct;const xt=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(pc(t)||!t.output||!t.input&&0!==t.avail_in)return os;e=t.state,e.mode===Pa&&(e.mode=16192),s=t.next_out,r=t.output,h=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,b=e.hold,ee=e.bits,de=a,_e=h,It=hc;e:for(;;)switch(e.mode){case lg:if(0===e.wrap){e.mode=16192;break}for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(2&e.wrap&&35615===b){0===e.wbits&&(e.wbits=15),e.check=0,ot[0]=255&b,ot[1]=b>>>8&255,e.check=Er(e.check,ot,2,0),b=0,ee=0,e.mode=16181;break}if(e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&b)<<8)+(b>>8))%31){t.msg="incorrect header check",e.mode=Ri;break}if((15&b)!==J3){t.msg="unknown compression method",e.mode=Ri;break}if(b>>>=4,ee-=4,ct=8+(15&b),0===e.wbits&&(e.wbits=ct),ct>15||ct>e.wbits){t.msg="invalid window size",e.mode=Ri;break}e.dmax=1<<e.wbits,e.flags=0,t.adler=e.check=1,e.mode=512&b?16189:Pa,b=0,ee=0;break;case 16181:for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(e.flags=b,(255&e.flags)!==J3){t.msg="unknown compression method",e.mode=Ri;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=Ri;break}e.head&&(e.head.text=b>>8&1),512&e.flags&&4&e.wrap&&(ot[0]=255&b,ot[1]=b>>>8&255,e.check=Er(e.check,ot,2,0)),b=0,ee=0,e.mode=16182;case 16182:for(;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.head&&(e.head.time=b),512&e.flags&&4&e.wrap&&(ot[0]=255&b,ot[1]=b>>>8&255,ot[2]=b>>>16&255,ot[3]=b>>>24&255,e.check=Er(e.check,ot,4,0)),b=0,ee=0,e.mode=16183;case 16183:for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.head&&(e.head.xflags=255&b,e.head.os=b>>8),512&e.flags&&4&e.wrap&&(ot[0]=255&b,ot[1]=b>>>8&255,e.check=Er(e.check,ot,2,0)),b=0,ee=0,e.mode=16184;case 16184:if(1024&e.flags){for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.length=b,e.head&&(e.head.extra_len=b),512&e.flags&&4&e.wrap&&(ot[0]=255&b,ot[1]=b>>>8&255,e.check=Er(e.check,ot,2,0)),b=0,ee=0}else e.head&&(e.head.extra=null);e.mode=16185;case 16185:if(1024&e.flags&&(Ce=e.length,Ce>a&&(Ce=a),Ce&&(e.head&&(ct=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(o,o+Ce),ct)),512&e.flags&&4&e.wrap&&(e.check=Er(e.check,i,Ce,o)),a-=Ce,o+=Ce,e.length-=Ce),e.length))break e;e.length=0,e.mode=16186;case 16186:if(2048&e.flags){if(0===a)break e;Ce=0;do{ct=i[o+Ce++],e.head&&ct&&e.length<65536&&(e.head.name+=String.fromCharCode(ct))}while(ct&&Ce<a);if(512&e.flags&&4&e.wrap&&(e.check=Er(e.check,i,Ce,o)),a-=Ce,o+=Ce,ct)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=16187;case 16187:if(4096&e.flags){if(0===a)break e;Ce=0;do{ct=i[o+Ce++],e.head&&ct&&e.length<65536&&(e.head.comment+=String.fromCharCode(ct))}while(ct&&Ce<a);if(512&e.flags&&4&e.wrap&&(e.check=Er(e.check,i,Ce,o)),a-=Ce,o+=Ce,ct)break e}else e.head&&(e.head.comment=null);e.mode=16188;case 16188:if(512&e.flags){for(;ee<16;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(4&e.wrap&&b!==(65535&e.check)){t.msg="header crc mismatch",e.mode=Ri;break}b=0,ee=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=Pa;break;case 16189:for(;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}t.adler=e.check=xT(b),b=0,ee=0,e.mode=cg;case cg:if(0===e.havedict)return t.next_out=s,t.avail_out=h,t.next_in=o,t.avail_in=a,e.hold=b,e.bits=ee,Wz;t.adler=e.check=1,e.mode=Pa;case Pa:if(n===Gz||n===ag)break e;case 16192:if(e.last){b>>>=7&ee,ee-=7&ee,e.mode=16206;break}for(;ee<3;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}switch(e.last=1&b,b>>>=1,ee-=1,3&b){case 0:e.mode=16193;break;case 1:if(e9(e),e.mode=ug,n===ag){b>>>=2,ee-=2;break e}break;case 2:e.mode=16196;break;case 3:t.msg="invalid block type",e.mode=Ri}b>>>=2,ee-=2;break;case 16193:for(b>>>=7&ee,ee-=7&ee;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if((65535&b)!=(b>>>16^65535)){t.msg="invalid stored block lengths",e.mode=Ri;break}if(e.length=65535&b,b=0,ee=0,e.mode=16194,n===ag)break e;case 16194:e.mode=16195;case 16195:if(Ce=e.length,Ce){if(Ce>a&&(Ce=a),Ce>h&&(Ce=h),0===Ce)break e;r.set(i.subarray(o,o+Ce),s),a-=Ce,o+=Ce,h-=Ce,s+=Ce,e.length-=Ce;break}e.mode=Pa;break;case 16196:for(;ee<14;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(e.nlen=257+(31&b),b>>>=5,ee-=5,e.ndist=1+(31&b),b>>>=5,ee-=5,e.ncode=4+(15&b),b>>>=4,ee-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=Ri;break}e.have=0,e.mode=16197;case 16197:for(;e.have<e.ncode;){for(;ee<3;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.lens[xt[e.have++]]=7&b,b>>>=3,ee-=3}for(;e.have<19;)e.lens[xt[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,_t={bits:e.lenbits},It=Df(0,e.lens,0,19,e.lencode,0,e.work,_t),e.lenbits=_t.bits,It){t.msg="invalid code lengths set",e.mode=Ri;break}e.have=0,e.mode=16198;case 16198:for(;e.have<e.nlen+e.ndist;){for(;Ne=e.lencode[b&(1<<e.lenbits)-1],je=Ne>>>24,He=Ne>>>16&255,Ue=65535&Ne,!(je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(Ue<16)b>>>=je,ee-=je,e.lens[e.have++]=Ue;else{if(16===Ue){for(Ct=je+2;ee<Ct;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(b>>>=je,ee-=je,0===e.have){t.msg="invalid bit length repeat",e.mode=Ri;break}ct=e.lens[e.have-1],Ce=3+(3&b),b>>>=2,ee-=2}else if(17===Ue){for(Ct=je+3;ee<Ct;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=je,ee-=je,ct=0,Ce=3+(7&b),b>>>=3,ee-=3}else{for(Ct=je+7;ee<Ct;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=je,ee-=je,ct=0,Ce=11+(127&b),b>>>=7,ee-=7}if(e.have+Ce>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=Ri;break}for(;Ce--;)e.lens[e.have++]=ct}}if(e.mode===Ri)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=Ri;break}if(e.lenbits=9,_t={bits:e.lenbits},It=Df(1,e.lens,0,e.nlen,e.lencode,0,e.work,_t),e.lenbits=_t.bits,It){t.msg="invalid literal/lengths set",e.mode=Ri;break}if(e.distbits=6,e.distcode=e.distdyn,_t={bits:e.distbits},It=Df(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,_t),e.distbits=_t.bits,It){t.msg="invalid distances set",e.mode=Ri;break}if(e.mode=ug,n===ag)break e;case ug:e.mode=dg;case dg:if(a>=6&&h>=258){t.next_out=s,t.avail_out=h,t.next_in=o,t.avail_in=a,e.hold=b,e.bits=ee,Bz(t,_e),s=t.next_out,r=t.output,h=t.avail_out,o=t.next_in,i=t.input,a=t.avail_in,b=e.hold,ee=e.bits,e.mode===Pa&&(e.back=-1);break}for(e.back=0;Ne=e.lencode[b&(1<<e.lenbits)-1],je=Ne>>>24,He=Ne>>>16&255,Ue=65535&Ne,!(je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(He&&0==(240&He)){for(We=je,mt=He,Xe=Ue;Ne=e.lencode[Xe+((b&(1<<We+mt)-1)>>We)],je=Ne>>>24,He=Ne>>>16&255,Ue=65535&Ne,!(We+je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=We,ee-=We,e.back+=We}if(b>>>=je,ee-=je,e.back+=je,e.length=Ue,0===He){e.mode=16205;break}if(32&He){e.back=-1,e.mode=Pa;break}if(64&He){t.msg="invalid literal/length code",e.mode=Ri;break}e.extra=15&He,e.mode=16201;case 16201:if(e.extra){for(Ct=e.extra;ee<Ct;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.length+=b&(1<<e.extra)-1,b>>>=e.extra,ee-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=16202;case 16202:for(;Ne=e.distcode[b&(1<<e.distbits)-1],je=Ne>>>24,He=Ne>>>16&255,Ue=65535&Ne,!(je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(0==(240&He)){for(We=je,mt=He,Xe=Ue;Ne=e.distcode[Xe+((b&(1<<We+mt)-1)>>We)],je=Ne>>>24,He=Ne>>>16&255,Ue=65535&Ne,!(We+je<=ee);){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}b>>>=We,ee-=We,e.back+=We}if(b>>>=je,ee-=je,e.back+=je,64&He){t.msg="invalid distance code",e.mode=Ri;break}e.offset=Ue,e.extra=15&He,e.mode=16203;case 16203:if(e.extra){for(Ct=e.extra;ee<Ct;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}e.offset+=b&(1<<e.extra)-1,b>>>=e.extra,ee-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=Ri;break}e.mode=16204;case 16204:if(0===h)break e;if(Ce=_e-h,e.offset>Ce){if(Ce=e.offset-Ce,Ce>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=Ri;break}Ce>e.wnext?(Ce-=e.wnext,Se=e.wsize-Ce):Se=e.wnext-Ce,Ce>e.length&&(Ce=e.length),Pe=e.window}else Pe=r,Se=s-e.offset,Ce=e.length;Ce>h&&(Ce=h),h-=Ce,e.length-=Ce;do{r[s++]=Pe[Se++]}while(--Ce);0===e.length&&(e.mode=dg);break;case 16205:if(0===h)break e;r[s++]=e.length,h--,e.mode=dg;break;case 16206:if(e.wrap){for(;ee<32;){if(0===a)break e;a--,b|=i[o++]<<ee,ee+=8}if(_e-=h,t.total_out+=_e,e.total+=_e,4&e.wrap&&_e&&(t.adler=e.check=e.flags?Er(e.check,r,_e,s-_e):Cf(e.check,r,_e,s-_e)),_e=h,4&e.wrap&&(e.flags?b:xT(b))!==e.check){t.msg="incorrect data check",e.mode=Ri;break}b=0,ee=0}e.mode=16207;case 16207:if(e.wrap&&e.flags){for(;ee<32;){if(0===a)break e;a--,b+=i[o++]<<ee,ee+=8}if(4&e.wrap&&b!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=Ri;break}b=0,ee=0}e.mode=16208;case 16208:It=qz;break e;case Ri:It=X3;break e;case 16210:return Q3;default:return os}return t.next_out=s,t.avail_out=h,t.next_in=o,t.avail_in=a,e.hold=b,e.bits=ee,(e.wsize||_e!==t.avail_out&&e.mode<Ri&&(e.mode<16206||n!==Z3))&&MT(t,t.output,t.next_out,_e-t.avail_out),de-=t.avail_in,_e-=t.avail_out,t.total_in+=de,t.total_out+=_e,e.total+=_e,4&e.wrap&&_e&&(t.adler=e.check=e.flags?Er(e.check,r,_e,t.next_out-_e):Cf(e.check,r,_e,t.next_out-_e)),t.data_type=e.bits+(e.last?64:0)+(e.mode===Pa?128:0)+(e.mode===ug||16194===e.mode?256:0),(0===de&&0===_e||n===Z3)&&It===hc&&(It=Kz),It},Na_inflateEnd=t=>{if(pc(t))return os;let n=t.state;return n.window&&(n.window=null),t.state=null,hc},Na_inflateGetHeader=(t,n)=>{if(pc(t))return os;const e=t.state;return 0==(2&e.wrap)?os:(e.head=n,n.done=!1,hc)},Na_inflateSetDictionary=(t,n)=>{const e=n.length;let i,r,o;return pc(t)||(i=t.state,0!==i.wrap&&i.mode!==cg)?os:i.mode===cg&&(r=1,r=Cf(r,n,e,0),r!==i.check)?X3:(o=MT(t,n,e,e),o?(i.mode=16210,Q3):(i.havedict=1,hc))},m9=function g9(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const kT=Object.prototype.toString,{Z_NO_FLUSH:_9,Z_FINISH:$9,Z_OK:Af,Z_STREAM_END:ov,Z_NEED_DICT:sv,Z_STREAM_ERROR:v9,Z_DATA_ERROR:DT,Z_MEM_ERROR:b9}=cc;function Pf(t){this.options=rg_assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new U3,this.strm.avail_out=0;let e=Na_inflateInit2(this.strm,n.windowBits);if(e!==Af)throw new Error(lc[e]);if(this.header=new m9,Na_inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Mf_string2buf(n.dictionary):"[object ArrayBuffer]"===kT.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=Na_inflateSetDictionary(this.strm,n.dictionary),e!==Af)))throw new Error(lc[e])}function av(t,n){const e=new Pf(n);if(e.push(t),e.err)throw e.msg||lc[e.err];return e.result}Pf.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let o,s,a;if(this.ended)return!1;for(s=n===~~n?n:!0===n?$9:_9,e.input="[object ArrayBuffer]"===kT.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),o=Na_inflate(e,s),o===sv&&r&&(o=Na_inflateSetDictionary(e,r),o===Af?o=Na_inflate(e,s):o===DT&&(o=sv));e.avail_in>0&&o===ov&&e.state.wrap>0&&0!==t[e.next_in];)Na_inflateReset(e),o=Na_inflate(e,s);switch(o){case v9:case DT:case sv:case b9:return this.onEnd(o),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(0===e.avail_out||o===ov))if("string"===this.options.to){let h=Mf_utf8border(e.output,e.next_out),b=e.next_out-h,ee=Mf_buf2string(e.output,h);e.next_out=b,e.avail_out=i-b,b&&e.output.set(e.output.subarray(h,h+b),0),this.onData(ee)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(o!==Af||0!==a){if(o===ov)return o=Na_inflateEnd(this.strm),this.onEnd(o),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Pf.prototype.onData=function(t){this.chunks.push(t)},Pf.prototype.onEnd=function(t){t===Af&&(this.result="string"===this.options.to?this.chunks.join(""):rg_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var S9={Inflate:Pf,inflate:av,inflateRaw:function y9(t,n){return(n=n||{}).raw=!0,av(t,n)},ungzip:av,constants:cc};const{Deflate:I9}=Rz,{Inflate:A9}=S9;var AT=I9,PT=A9;function lv(){return lv=(0,hn.Z)(function*(t,n){const e=new AT({level:2,gzip:!0});try{return yield NT(e,t,n),e.result}catch(i){console.error(i)}return null}),lv.apply(this,arguments)}function cv(){return cv=(0,hn.Z)(function*(t,n){const e=new PT;try{return yield NT(e,t,n),e.result}catch(i){console.error(i)}return null}),cv.apply(this,arguments)}function NT(t,n){return uv.apply(this,arguments)}function uv(){return uv=(0,hn.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let o=0;o<i;o++)yield G9(),r=n.slice(o*e,(o+1)*e),t.push(r,i<=o+1);if(t.err)throw new Error(`error: ${t.err}`);return t}),uv.apply(this,arguments)}function G9(){return new Promise(t=>Ur(t))}var Ho,OT=me(2391);!function(t){t.encode=function n(i){try{return OT.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return OT.decode(i)}catch(r){console.error(r,i)}return null}}(Ho||(Ho={}));var yo,q9=me(9069);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],o=i[1],s=i[2],a=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&o]+n[o>>8&255]+"-"+n[o>>16&15|64]+n[o>>24&255]+"-"+n[63&s|128]+n[s>>8&255]+"-"+n[s>>16&255]+n[s>>24&255]+n[255&a]+n[a>>8&255]+n[a>>16&255]+n[a>>24&255]}}(yo||(yo={}));class Oa{constructor(n,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class fg{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new Oa(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var n=this;return(0,hn.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}fg.updateWebRTCStatsTimer=null,fg.monitoringConnections=new Set;var ss=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}(ss||(ss={})),ss))();class W9{constructor(n){this.peerConnection=n,this.candidateType=ss.UNKNOWN}updateAsync(){var n=this;return(0,hn.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(_e){console.warn(_e)}if(null==e)return void(n.candidateType=ss.UNKNOWN);let i=[],r=[],o=[],s=[],a=[],h=[],b=[];e.forEach(_e=>{0<=_e.type.indexOf("candidate-pair")&&i.push(_e),0<=_e.type.indexOf("local-candidate")&&r.push(_e),0<=_e.type.indexOf("remote-candidate")&&o.push(_e)}),i.forEach(_e=>{"succeeded"===_e.state&&(s.push(_e.localCandidateId),a.push(_e.remoteCandidateId))}),r.forEach(_e=>{s.includes(_e.id)&&h.push(_e)}),o.forEach(_e=>{a.includes(_e.id)&&b.push(_e)});let ee=ss.UNKNOWN,de=Object.values(ss);h.concat(b).forEach(_e=>{let Ce=de.indexOf(_e.candidateType);de.indexOf(ee)<Ce&&(ee=de[Ce])}),n.candidateType=ee})()}}class FT extends q9.EventEmitter{constructor(n){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=ss.UNKNOWN,n.on("data",e=>this.onData(e)),n.on("open",()=>{this.stats=new W9(this.getPeerConnection()),this.clearTimeoutTimer(),function K9(t){t._dc&&t._sendBuffer&&(t._startSendLoop=Y9)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),n.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){return this.conn._dc?.bufferedAmount??0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=Ho.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=yo.generateUuid(),o=null,s=null;for(let a=0;a<i;a++)o=e.slice(a*this.chunkSize,(a+1)*this.chunkSize),s={id:r,data:o,index:a,total:i},this.conn.send(Ho.encode(s))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){fg.add(this)}stopMonitoring(){fg.remove(this)}updateStatsAsync(){var n=this;return(0,hn.Z)(function*(){null!=n.stats&&(n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType,n.emit("stats",n.stats))})()}sendPing(){let n=Ho.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=Ho.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=Ho.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let o=this.receivedMap.get(r.id);if(null==o&&(o={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,o)),null!=o.chanks[r.index]||(o.length++,o.byteLength+=r.data.byteLength,o.chanks[r.index]=r.data,o.length<r.total))return;this.receivedMap.delete(r.id);let s=new Uint8Array(o.byteLength),a=0;for(let b of o.chanks)s.set(b,a),a+=b.byteLength;let h=Ho.decode(s);this.emit("data",h)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function Y9(){this.sendInterval||(this.sendInterval=Ur(RT.bind(this)))}function RT(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch{this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:Ur(RT.bind(this))}class Z9{constructor(){this._peerIds=[],this.peerContext=ki.parse("???"),this.peerContexts=[],this.callback=new a3,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...n){console.log("open",n),this.peerContext=0===n.length?ki.create(ki.generateId()):1===n.length?ki.create(n[0]):ki.create(n[0],n[1],n[2],n[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=ki.parse("???")}connect(n){if(!this.shouldConnect(n))return!1;let e=new FT(this.peer.connect(n,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(n){return this.peerContext&&this.peer&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.findDataConnection(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.findDataConnection(n);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections.concat())this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:Ho.encode(n),ttl:1},o=r.data.byteLength;this.bandwidthUsage+=o,this.outboundQueue=this.outboundQueue.then(()=>new Promise((s,a)=>{Ur((0,hn.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let h=yield function H9(t,n){return lv.apply(this,arguments)}(r.data);h.byteLength<r.data.byteLength&&(r.data=h,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=o,s()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.peer)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peerContext.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=ki.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),n.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),n.on("connection",e=>{this.openDataConnection(new FT(e))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=n}openDataConnection(n){if(!1===this.addDataConnection(n))return;let e=this.connections.indexOf(n),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",r=>{this.onData(n,r)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(n.remoteId)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{let r=performance.now()-n.timestamp,o=r<=1e4?1:5e3/(r-1e4+5e3),s=o<1?r:n.ping,a=500/(s+500);switch(i.session.health=o,i.session.ping=s,i.session.speed=a*o,n.candidateType){case ss.HOST:i.session.grade=cl.HIGH;break;case ss.SRFLX:case ss.PRFLX:i.session.grade=cl.MIDDLE;break;case ss.RELAY:i.session.grade=cl.LOW;break;default:i.session.grade=cl.UNSPECIFIED}i.session.description=n.candidateType,i.session.health<.2&&this.closeDataConnection(n)})}closeDataConnection(n){n.close();let e=this.connections.indexOf(n);0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.remoteId)}addDataConnection(n){let e=this.findDataConnection(n.remoteId);if(null!==e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting."),e!==n){if(!(e.metadata.sendFrom<n.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(n),!0;this.closeDataConnection(n)}return!1}return this.connections.push(n),this.peerContexts.push(ki.parse(n.remoteId)),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),!0}findDataConnection(n){for(let e of this.connections)if(e.remoteId===n)return e;return null}onData(n,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(n,e),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((o,s)=>{Ur((0,hn.Z)(function*(){let a=e.isCompressed?yield function V9(t,n){return cv.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.remoteId,Ho.decode(a)),i.bandwidthUsage-=r,o()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i)for(let r of i){let o=this.findDataConnection(r);o&&o.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),o.send(e))}}onUpdatePeerList(n,e){let i=[],r=[],o=function X9(t,n){let e=[],i=[],r=!1,o=!1;for(let s of t.concat(n))r=t.includes(s),o=n.includes(s),r&&!o?e.push(s):!r&&o&&i.push(s);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=o.diff1,r=o.diff2,this.relayingPeerIds.set(n.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let s of r)!this.maybeUnavailablePeerIds.has(s)&&this.connect(s)&&console.log("auto connect to unknown Peer <"+s+">")}updatePeerList(){let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);return n.push(this.peerId),n.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=n,console.log("<update()>",n),this.notifyPeerList(),n}notifyPeerList(){if(this.connections.length<1)return;let n={data:Ho.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const LT=ki.parse("???");class ta{constructor(){this.callback=new a3,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}static get instance(){return ta._instance||(ta._instance=new ta),ta._instance}get peerId(){return this.connection?this.connection.peerId:LT.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:LT}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...n){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){!this.connection||this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=Ur(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?Ur(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let n=new Z9;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=Ur(this.sendCallback)),n}}class hg{constructor(n,e,i=ta.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===ta.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class dv{constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new dv(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class gc{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return gc._instance||(gc._instance=new gc,gc._instance.initializeNetworkEvent()),gc._instance}register(n){return new dv(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=this.listenerMap.values();for(let o of r)for(let s of o.concat())s.isEqual(n,e,i)&&s.unregister()}registerListener(n){let e=this.getListeners(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),n}unregisterListener(n){let e=this.getListeners(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),n.unregister(),e.length<1&&this.listenerMap.delete(n.eventName),n)}call(...n){"string"==typeof n[0]?this._call(new hg(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();ta.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof hg?n[0]:new hg(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new hg(n[0],n[1]))}_trigger(n){let e=this.getListeners(n.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(n);return n}getListeners(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}initializeNetworkEvent(){let n=ta.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},n.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const Ve=gc.instance,Lt=ta.instance;class Et{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return Et._instance||(Et._instance=new Et),Et._instance}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&Ve.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Ve.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=Ur(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;let s=o.value[0];o.value[1]+n<e||this.garbageMap.delete(s)}}}var Fa,Q9=me(383);class na{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return na._instance||(na._instance=new na),na._instance}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}function BT(t){return n=>{na.instance.register(n,t)}}function Ou(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.context.syncData[n]},set:function i(r){this.context.syncData[n]=r,this.update()},enumerable:!0,configurable:!0})}}!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function ee(_e){return e[_e]}function de(_e){return r[_e]}t.xml2element=function s(_e){let Ce=new DOMParser,Se=null;try{_e=function b(_e){return _e.replace(o,"").trim()}(_e),Se=Ce.parseFromString(_e,"application/xml"),Se.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",Se.documentElement),Se=null)}catch(Pe){console.error(Pe)}return Se?Se.documentElement:null},t.encodeEntityReference=function a(_e){return _e.replace(n,ee)},t.decodeEntityReference=function h(_e){return _e.replace(i,de)}}(Fa||(Fa={}));const e7=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class gi{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return gi._instance||(gi._instance=new gi),gi._instance}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():gi.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i){let a=Fa.encodeEntityReference(i[s]+"");null!=a&&(o+=" "+s+'="'+a+'"')}return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=gi.make2Attributes(n[i],i);for(let a in s)e[a]=s[a]}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=gi.array2attributes(n,e);for(let o in r)i[o]=r[o]}else if("object"==typeof n){let r=gi.object2attributes(n,e);for(let o in r)i[o]=r[o]}else i[e]=n;return i}static object2attributes(n,e){let i={};for(let r in n){let a=gi.make2Attributes(n[r],e+"."+r);for(let h in a)i[h]=a[h]}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let h=gi.make2Attributes(n[o],e+"."+o);for(let b in h)i[b]=h[b]}return i}parseXml(n){let e=null;if(e="string"==typeof n?Fa.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=na.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();gi.parseAttributes(r.syncData,e.attributes),i.apply(r)}i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e);try{i.complement()}catch(r){console.log(r)}return i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=Fa.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],h=n,b=s.find(de=>e7.includes(de));null==b?1<s.length&&(({obj:h,key:a}=gi.attributes2object(s,h,a)),null==a)||("string"!=typeof h[a]&&null!=h[a]&&(o=JSON.parse(o)),h[a]=o):console.log(`skip invalid key (${b})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class gl{constructor(n=yo.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}static get aliasName(){return na.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){Et.instance.add(this)}destroy(){Et.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),Et.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){const n=this.toXml();return gi.instance.parseXml(n)}complement(){}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:zT(this.context.syncData)}}toXml(){return gi.instance.toXml(this)}}function zT(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=zT(t[i]):"function"!==r&&(n[i]=t[i])}return n}var ia;let ii=ia=class extends gl{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return Et.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==Et.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&Et.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==ia.unknownNodes[this.identifier])return;let n=ia.unknownNodes[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);ia.unknownNodes[this.identifier]&&delete ia.unknownNodes[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,o=e.index-r,s=r+o*(.45+.1*Math.random());return n.majorIndex=0|s,n.minorIndex=s-n.majorIndex,this.updateChildren(n),o<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return this.attributes[n]??""}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return gi.toAttributes(this.attributes)}parseAttributes(n){gi.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=Fa.encodeEntityReference(this.value+"");for(let e of this.children)n+=gi.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=gi.instance.parseXml(e[r]);o instanceof ia&&this.appendChild(o)}else this.value=Fa.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in ia.unknownNodes||(ia.unknownNodes[this.parentIdentifier]=[]),ia.unknownNodes[this.parentIdentifier].push(this))}};function mi(t){return n=>{BT(t)(n)}}function yt(){return(t,n)=>{t instanceof ii?function J9(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.getAttribute(n)},set:function i(r){this.setAttribute(n,r)},enumerable:!0,configurable:!0})}}()(t,n):Ou()(t,n)}}ii.unknownNodes={},ve([Ou()],ii.prototype,"value",void 0),ve([Ou()],ii.prototype,"attributes",void 0),ve([Ou()],ii.prototype,"parentIdentifier",void 0),ve([Ou()],ii.prototype,"majorIndex",void 0),ve([Ou()],ii.prototype,"minorIndex",void 0),ii=ia=ve([BT("node")],ii);class jT{constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var tt;!function(t){const n=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));t.toHalfWidth=function e(Ce){return null==Ce||""==Ce?"":Ce.replace(/[\uff01-\uff5e]/g,Se=>String.fromCharCode(Se.charCodeAt(0)-65248))},t.isEmote=function i(Ce){return!!Ce&&(Ce=this.cr(Ce).replace(/[\s\r\n]/g,""),Array.from(Ce).length<=3&&!/[\u300c\u300d]/.test(Ce)&&(n.test(Ce)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(Ce)))},t.cr=function r(Ce){if(null==Ce||""==Ce)return"";let Se="",Pe="";return[...Ce].forEach(Ne=>{if(Pe){switch(Ne){case"n":case"\uff4e":Se+="\n";break;case"s":case"\uff53":Se+="s"===Ne?" ":"\u3000";break;case"\\":case"\uffe5":Se+=Ne;break;default:Se+=Pe+Ne}Pe=""}else"\\"==Ne||"\uffe5"==Ne?Pe=Ne:Se+=Ne}),Se+Pe},t.parseCommands=function o(Ce,Se=!1){const Pe=/[:\uff1a]/,Ne=/[\uff0b\uff1d+\-=\u2015\u30fc\u2014\u2010\uff0d>\uff1e]/,je=/[\s\u3000]/,Ue=[Pe,Ne],We=[Ne,/[:\uff1a\s\u3000]/],mt=[Ne,Pe],Xe=[...Ce],ct=[];let It="",ot=0,_t=0,Ct={},xt="",Gt="",on="",gn="";for(;ot<Xe.length;ot++){const Pt=Xe[ot];if((!Se||!Gt)&&je.test(Pt))break;if(on)Pe.test(Pt)||Ne.test(Pt)||Se&&Pt===Gt||(xt+=on),xt+=Pt,gn+=Pt,on="";else if("\\"!==Pt&&"\uffe5"!==Pt)if(Se&&Gt)Pt!==Gt||null!=Xe[ot-1]&&!We[_t].test(Xe[ot+1])?xt+=Pt:Gt="",gn+=Pt;else if(!Se||'"'!==Pt&&"'"!==Pt||null!=Xe[ot-1]&&!Ue[_t].test(Xe[ot-1]))if(mt[_t].test(Pt)){switch(gn+=Pt,_t){case 0:Ct.targetName=Gt+xt,Ct.operator=this.toHalfWidth(Pt.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),_t=1;break;case 1:Ct.value=Gt+xt,ct.push(Ct),Ct={},_t=0}It+=gn,gn="",xt="",Gt=""}else xt+=Pt,gn+=Pt;else Gt=Pt,gn+=Pt;else on=Pt,gn+=Pt}const Tt=Gt+xt+on;switch(_t){case 0:if(""==Tt)break;Ct.targetName=Tt,It+=Tt,Ct.isIncomplete=!0,ct.push(Ct);break;case 1:Ct.value=Tt,It+=Tt,ct.push(Ct)}return{commands:ct,commandString:It,endString:(ot<Xe.length?Xe.slice(ot).join(""):"").replace(/^[\s\u3000]/,"")}},t.validUrl=function s(Ce){if(!Ce)return!1;try{new URL(Ce.trim())}catch{return!1}return/^https?\:\/\//.test(Ce.trim())},t.sameOrigin=function a(Ce){if(!Ce)return!1;try{return new URL(Ce).origin===window.location.origin}catch{return!1}},t.escapeHtml=function h(Ce){return"string"!=typeof Ce&&(Ce=Ce.toString()),Ce.replace(/[&'`"<>]/g,function(Se){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[Se]})},t.rubyToHtml=function b(Ce){return"string"!=typeof Ce&&(Ce=Ce.toString()),Ce.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},t.rubyToText=function ee(Ce){return"string"!=typeof Ce&&(Ce=Ce.toString()),Ce.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},t.aliasNameToClassName=function de(Ce){switch(Ce){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";case"range":return"\u5c04\u7a0b\u30fb\u7bc4\u56f2";default:return Ce}},t.textShadowColor=function _e(Ce,Se="#ffffff",Pe="#333333"){return Ce&&/^\#[0-9a-f]{6}$/i.test(Ce)&&Ce.substring(1,7).match(/.{2}/g).reduce((Ne,je)=>Ne+parseInt(je,16),0)>510?Pe:Se}}(tt||(tt={}));class Kt{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return Kt._instance||(Kt._instance=new Kt),Kt._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,hn.Z)(function*(){let i=yield sn.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=sn.create(n);else if(n instanceof sn)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=sn.create(n)}return this._add(e)}_add(n){return Pi.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof sn?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Ve.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Oa(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Pi.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var bn,Nn=me(4424);let Je=bn=class extends gl{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=bn.CHAT_DEFAULT_COLOR,this.isGMMode=!1}get isMine(){return bn.myCursor&&bn.myCursor===this}get image(){return Kt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Ve.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{Lt.peerIds.includes(this.peerId)||(bn.userIdMap.delete(this.userId),bn.peerIdMap.delete(this.peerId),Et.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Ve.unregister(this),bn.userIdMap.delete(this.userId),bn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(bn.userIdMap,n,!0)}static findByPeerId(n){return this.find(bn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&Et.instance.get(r))return Et.instance.get(r);let o=Et.instance.getObjects(bn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return(0,hn.Z)(function*(){if(bn.myCursor)return console.warn("It is already created."),bn.myCursor;bn.myCursor=new bn,bn.myCursor.peerId=Lt.peerId,bn.myCursor.initialize();try{try{window.localStorage&&localStorage.getItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(bn.myCursor.name=localStorage.getItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY),yield Nn.setItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY,bn.myCursor.name,()=>{localStorage.removeItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}try{window.localStorage&&localStorage.getItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(bn.myCursor.color=localStorage.getItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY),yield Nn.setItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,bn.myCursor.color,()=>{localStorage.removeItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}yield Nn.getItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n?bn.myCursor.name=n:void 0!==n&&Nn.removeItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}),yield Nn.getItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n&&/^\#[0-9a-f]{6}$/.test(n.trim().toLowerCase())?bn.myCursor.color=n.trim().toLowerCase():void 0!==n&&Nn.removeItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)});try{yield Nn.getItem(bn.CHAT_MY_ICON_LOCAL_STORAGE_KEY).then(n=>{let e=null;if("string"==typeof n)if(n.startsWith("data:image/")){const i=n.substring(5,n.indexOf(";")),r=atob(n.replace(/^.*,/,""));let o=new Uint8Array(r.length);for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);e=new Blob([o.buffer],{type:i})}else Kt.instance.images.find(r=>r.identifier===n)?bn.myCursor.imageIdentifier=n:Nn.removeItem(bn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);else n instanceof Blob?e=n:Nn.removeItem(bn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);e&&sn.createAsync(e).then(i=>{i.state===Pi.COMPLETE?(Kt.instance.add(i),bn.myCursor.imageIdentifier=i.identifier):Nn.removeItem(bn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)})}).catch(n=>{throw n})}catch(n){console.log(n),Nn.removeItem(bn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)}}catch(n){console.log(n),yield Nn.removeItem(bn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(e=>console.log(e)),yield Nn.removeItem(bn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(e=>console.log(e))}return bn.myCursor})()}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(bn.userIdMap.set(e,this.identifier),bn.userIdMap.delete(this.userId)),i!==this.peerId&&(bn.peerIdMap.set(i,this.identifier),bn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};Je.isGMHold=!1,Je.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",Je.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",Je.CHAT_MY_ICON_LOCAL_STORAGE_KEY="udonanaumu-chat-my-icon-local-storage",Je.CHAT_DEFAULT_COLOR="#444444",Je.CHAT_DEFAULT_NAME="\u30d7\u30ec\u30a4\u30e4\u30fc",Je.CHAT_TRANSPARENT_COLOR="#ffffff",Je.myCursor=null,Je.userIdMap=new Map,Je.peerIdMap=new Map,ve([yt()],Je.prototype,"userId",void 0),ve([yt()],Je.prototype,"peerId",void 0),ve([yt()],Je.prototype,"name",void 0),ve([yt()],Je.prototype,"imageIdentifier",void 0),ve([yt()],Je.prototype,"color",void 0),ve([yt()],Je.prototype,"isGMMode",void 0),Je=bn=ve([mi("PeerCursor")],Je);let Fu=class extends ii{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&this.paletteColor!=Je.CHAT_TRANSPARENT_COLOR?this.paletteColor:Je.myCursor&&Je.myCursor.color!=Je.CHAT_TRANSPARENT_COLOR?Je.myCursor.color:Je.CHAT_DEFAULT_COLOR}set color(n){this.paletteColor=n}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e,i){let r="";r="string"==typeof n?n:n.palette;const o=[];let a=0,h=!0;for(;h;)a++,h=!1,r=r.replace(/[{\uff5b][\s\u3000]*([^{}\uff5b\uff5d]+)[\s\u3000]*[}\uff5d]/g,(b,ee)=>{if(o.includes(ee))return b;h=!0;let de="";for(let _e of this.paletteVariables)tt.cr(tt.toHalfWidth(_e.name.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim()===tt.cr(tt.toHalfWidth(ee.replace(/[\u2015\u30fc\u2014\u2010]/g,"-"))).toLowerCase().replace(/[\s\r\n]+/," ").trim()&&(de=_e.value);if(e){let _e=e.getFirstElementByNameUnsensitive(ee);if(_e?(de=_e.isNumberResource?_e.currentValue:_e.isCheckProperty?_e.checkValue():_e.isAbilityScore?_e.calcAbilityScore():_e.value,null==de&&(de="")):(_e=e.getFirstElementByNameUnsensitive(ee,/^\u6700\u5927/)||e.getFirstElementByNameUnsensitive(ee,/^Max[\:\_\-\s]*/i)||e.getFirstElementByNameUnsensitive(ee,/^\u521d\u671f/)||e.getFirstElementByNameUnsensitive(ee,/\u521d\u671f\u5024$/)||e.getFirstElementByNameUnsensitive(ee,/\u6700\u5927\u5024$/))&&(_e.isNumberResource||_e.isAbilityScore)||(_e=e.getFirstElementByNameUnsensitive(ee,/^\u57fa\u672c/)||e.getFirstElementByNameUnsensitive(ee,/^\u539f/)||e.getFirstElementByNameUnsensitive(ee,/\^$/)||e.getFirstElementByNameUnsensitive(ee,/\u57fa\u672c\u5024$/)||e.getFirstElementByNameUnsensitive(ee,/\u539f\u70b9$/))&&(_e.isNumberResource||_e.isAbilityScore)?de=_e.value:(_e=e.getFirstElementByNameUnsensitive(ee,/\u4fee\u6b63\u5024?$/)||e.getFirstElementByNameUnsensitive(ee,/\s*Mod(ifier|\.)?$/i)||e.getFirstElementByNameUnsensitive(ee,/\u30dc\u30fc\u30ca\u30b9$/))&&_e.isAbilityScore&&(de=_e.calcAbilityScore()),""==de){let Ce;if(Ce=/^\$(.+)$/.exec(tt.toHalfWidth(ee.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")))){if(i){if(/^\d+$/.test(tt.toHalfWidth(Ce[1]))){const Se=parseInt(tt.toHalfWidth(Ce[1]));return null!=i[Se-1]?i[Se-1]:""}return b.replace(ee,Ce[1])}return o.push(ee),b}}return de+""}return""}),128<a&&(h=!1);return r}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^[\s\u3000]*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s\u3000]+)[\s\u3000]*[=\uff1d][\s\u3000]*(.+)[\s\u3000]*/gi.exec(n);return e?{name:tt.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var ml;ve([yt()],Fu.prototype,"dicebot",void 0),ve([yt()],Fu.prototype,"paletteColor",void 0),Fu=ve([mi("chat-palette")],Fu);let kt=ml=class extends ii{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new ml(r):new ml,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}get loggingValue(){let n;if(this.isSimpleNumber)n=`${this.value}`;else if(this.isNumberResource)n=`${this.currentValue}/${this.value&&0!=this.value?this.value:"???"}`;else if(this.isCheckProperty)n=this.value?" \u2192 \u2714ON":" \u2192 OFF";else if(this.isAbilityScore){const e=this.calcAbilityScore();n=`${this.value}`,this.currentValue&&(n+=`(${e>=0?"+":""}${e})`)}else n=this.value?this.value.toString():"";return n}getElementsByName(n){let e=[];for(let i of this.children)i instanceof ml&&(i.getAttribute("name")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(n)));return e}getElementsByType(n){let e=[];for(let i of this.children)i instanceof ml&&(i.getAttribute("type")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(n)));return e}getFirstElementByName(n){for(let e of this.children)if(e instanceof ml){if(e.getAttribute("name")===n)return e;let i=e.getFirstElementByName(n);if(i)return i}return null}getFirstElementByNameUnsensitive(n,e=null,i=""){for(let r of this.children)if(r instanceof ml){let o=tt.cr(tt.toHalfWidth(n.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim();if(null!=e&&(o=o.replace(e,i)),tt.cr(tt.toHalfWidth(r.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim()===o)return r;let s=r.getFirstElementByNameUnsensitive(n,e,i);if(s)return s}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let n;return(n=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+n[1]):(n=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}checkValue(){if(!this.isCheckProperty)return"0";let n=(this.currentValue+"").trim().split(/[|\uff5c]/g,2);return null==n[1]&&(n[1]="0",(null==n[0]||""===n[0].trim()&&!/[|\uff5c]/.test(this.currentValue+""))&&(n[0]="1")),n[this.value?0:1].trim()}};ve([yt()],kt.prototype,"name",void 0),ve([yt()],kt.prototype,"type",void 0),ve([yt()],kt.prototype,"currentValue",void 0),kt=ml=ve([mi("data")],kt);let Ni=class extends ii{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=sn.Empty,this._shadowImageFile=sn.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("imageIdentifier");return n[this.currntImageIndex<0?0:this.currntImageIndex>=n.length?n.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageElement;if(n&&this._imageFile.identifier!==n.value){let e=Kt.instance.get(n.value);this._imageFile=e||sn.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>Kt.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("faceIcon");if(n){let e=n[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?Kt.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>Kt.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let n=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(n&&this._shadowImageFile.identifier!==n.value){let e=Kt.instance.get(n.value);this._shadowImageFile=e||sn.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=Kt.instance.get(e.currentValue);this._shadowImageFile=i||sn.Empty}}return this._shadowImageFile}get altitude(){let n=this.getElement("altitude",this.commonDataElement),e=n?+n.value:0;return Number.isNaN(e)?0:e}set altitude(n){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=n)}get isHaveAltitude(){return!!this.getElement("altitude",this.commonDataElement)}get isGMMode(){return!!Je.myCursor&&Je.myCursor.isGMMode}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=kt.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(kt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(kt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(kt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(kt.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?Et.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);!i||(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?Kt.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};ve([yt()],Ni.prototype,"location",void 0),ve([yt()],Ni.prototype,"posZ",void 0),ve([yt()],Ni.prototype,"currntImageIndex",void 0),ve([yt()],Ni.prototype,"isUseIconToOverviewImage",void 0),ve([yt()],Ni.prototype,"currntIconIndex",void 0),ve([yt()],Ni.prototype,"isAltitudeIndicate",void 0),ve([yt()],Ni.prototype,"isInverse",void 0),ve([yt()],Ni.prototype,"isHollow",void 0),ve([yt()],Ni.prototype,"isBlackPaint",void 0),ve([yt()],Ni.prototype,"aura",void 0),ve([yt()],Ni.prototype,"isNotRide",void 0),ve([yt()],Ni.prototype,"isInventoryIndicate",void 0),Ni=ve([mi("TabletopObject")],Ni);var Hi=(()=>(function(t){t[t.Default=1]="Default",t[t.Image=2]="Image",t[t.Postfix=3]="Postfix",t[t.PostfixOrImage=4]="PostfixOrImage",t[t.PostfixAndImage=5]="PostfixAndImage",t[t.NotConditionStandUp=6]="NotConditionStandUp"}(Hi||(Hi={})),Hi))();let _l=class extends kt{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1}get standElements(){return this.getElementsByName("stand")}add(n){let e=this.getFirstElementByName("stand")?Hi.NotConditionStandUp:Hi.Default,i=kt.create("stand");i.appendChild(kt.create("name","",{},"name_"+i.identifier)),i.appendChild(kt.create("imageIdentifier",n&&n!=sn.Empty.identifier?n:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(kt.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(kt.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(kt.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(kt.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(kt.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(kt.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(kt.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(kt.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(kt.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(n){this.removeChild(n)}matchStandInfo(n,e,i=null){const r=e instanceof sn?e.identifier:e;let o="",s=!1,a=[];["\uff20\u9000\u53bb","@farewell"].forEach(Ce=>{tt.toHalfWidth(n).trimRight().toUpperCase().endsWith(tt.toHalfWidth(Ce).toUpperCase())&&(("@"==Ce.slice(0,1)||"\uff20"==Ce.slice(0,1))&&o.length<Ce.length&&(o=Ce),s=!0)});for(const Ce of this.standElements){const Se=Ce.getFirstElementByName("name");Se&&Se.value.toString()==i&&a.push(Ce)}let h=1,b=!0,ee=[],de=[];for(const Ce of this.standElements){if(!Ce.getFirstElementByName("imageIdentifier")||!Ce.getFirstElementByName("conditionType"))continue;const Se=Ce.getFirstElementByName("conditionType").value;if(Se!=Hi.NotConditionStandUp)if(Se==Hi.Default)ee.push(Ce);else{const Pe=Ce.getFirstElementByName("postfix")?Ce.getFirstElementByName("postfix").value.toString():null,Ne=Ce.getFirstElementByName("targetImageIdentifier")?Ce.getElementsByName("targetImageIdentifier").map(Ue=>Ue.value):[];let je=!1,He=!1;if(Pe&&(Se==Hi.Postfix||Se==Hi.PostfixOrImage||Se==Hi.PostfixAndImage))for(let Ue of Pe.split(/[\r\n]+/g))null==Ue||0==Ue.trim().length||tt.toHalfWidth(n).toUpperCase().trimRight().endsWith(tt.toHalfWidth(Ue).trimRight().toUpperCase())&&(("@"==Ue.slice(0,1)||"\uff20"==Ue.slice(0,1))&&o.length<Ue.length&&(o=Ue),je=!0);Ne.length>0&&(Se==Hi.Image||Se==Hi.PostfixOrImage||Se==Hi.PostfixAndImage)&&(He=r&&Ne.indexOf(r)>=0),(je&&(Se==Hi.Postfix||Se==Hi.PostfixOrImage)||He&&(Se==Hi.Image||Se==Hi.PostfixOrImage)||je&&He&&Se==Hi.PostfixAndImage)&&(b=!1,de.push(Ce),h<+Se&&(h=+Se))}}i||(a=b?ee:de.filter(Ce=>+Ce.getFirstElementByName("conditionType").value==h));let _e={standElementIdentifier:null,matchMostLongText:o,farewell:s};return a&&a.length>0&&(_e.standElementIdentifier=a[Math.floor(Math.random()*a.length)].identifier),_e}};var pg;ve([yt()],_l.prototype,"position",void 0),ve([yt()],_l.prototype,"height",void 0),ve([yt()],_l.prototype,"overviewIndex",void 0),_l=ve([mi("stand-list")],_l);let an=pg=class extends Ni{constructor(n=yo.generateUuid()){super(n),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.text="",this.isEmote=!1,this.isLoaded=!1,this.chatBubbleAltitude=0,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}get height(){let n=this.getElement("height",this.commonDataElement),e=n?+n.value:0;return n&&n.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let n of this.children)if(n instanceof Fu)return n;return null}get ownerName(){let n=Je.findByUserId(this.owner);return n?n.name:null}get ownerColor(){let n=Je.findByUserId(this.owner);return n?n.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof _l)return e;let n=new _l("StandList_"+this.identifier);return n.initialize(),this.appendChild(n),n}static create(n,e,i){let r=new pg;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||Lt.peerContext.userId===this.owner}static get isStealthMode(){for(const n of Et.instance.getObjects(pg))if(n.isHideIn&&n.isVisible&&"table"===n.location.name)return!0;return!1}complement(){let n=this.getElement("altitude",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+this.identifier)),n=this.getElement("height",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.insertBefore(kt.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement))}createTestGameDataElement(n,e,i){this.createDataElements();let r=kt.create("name",n,{},"name_"+this.identifier),o=kt.create("size",e,{},"size_"+this.identifier),s=kt.create("height",0,{currentValue:""},"height_"+this.identifier),a=kt.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let h=kt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),b=kt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),ee=kt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(a),this.detailDataElement.appendChild(h),h.appendChild(b),h.appendChild(ee);let de=kt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(de),de.appendChild(kt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),de.appendChild(kt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),de.appendChild(kt.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),de=kt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(de),de.appendChild(kt.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),de.appendChild(kt.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),de.appendChild(kt.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),de.appendChild(kt.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),de.appendChild(kt.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),de.appendChild(kt.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),de=kt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(de),de.appendChild(kt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),de.appendChild(kt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),de.appendChild(kt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),de.appendChild(kt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),de.appendChild(kt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),de.appendChild(kt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Se=new Fu("ChatPalette_"+this.identifier);Se.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n:\uff48\uff50-3d6 2d20KH1+{\u5668\u7528\u5ea6}+2>=15 \u300a{Lv1}\u300b\u3092\u4f7f\u7528\u3000HP\uff5b\uff041\uff5d\n:HP={\u6700\u5927HP}:MP-10 HP\u5168\u56de\u5fa9\uff01 MP{$2}\u3001HP{HP} \u2192 {$HP}\uff08{$1}\u70b9\u56de\u5fa9\uff09\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Se.initialize(),this.appendChild(Se);let Pe=new _l("StandList_"+this.identifier);Pe.initialize(),this.appendChild(Pe)}};ve([yt()],an.prototype,"rotate",void 0),ve([yt()],an.prototype,"roll",void 0),ve([yt()],an.prototype,"isDropShadow",void 0),ve([yt()],an.prototype,"isShowChatBubble",void 0),ve([yt()],an.prototype,"owner",void 0),an=pg=ve([mi("character")],an);let Ra=class extends ii{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(n=>{let e=null;if(e=(n=n.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+tt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+tt.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+tt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+tt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+tt.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=n.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(n=>n):[]}};var as;ve([yt()],Ra.prototype,"name",void 0),ve([yt()],Ra.prototype,"command",void 0),ve([yt()],Ra.prototype,"dice",void 0),Ra=ve([mi("dice-roll-table")],Ra);let Ns=as=class extends ii{static get instance(){return as._instance||(as._instance=new as("DiceRollTableList"),as._instance.initialize()),as._instance}get diceRollTables(){return this.children}addDiceRollTable(...n){let e=null;if(n[0]instanceof Ra)e=n[0];else{let i=n[0];e=new Ra(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of as.instance.children)i.destroy();let e=as.instance.toContext();e.syncData=this.toContext().syncData,as.instance.apply(e),as.instance.update(),super.parseInnerXml.apply(as.instance,[n]),this.destroy()}};Ns=as=ve([mi("dice-roll-table-list")],Ns);var Dr=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Dr||(Dr={})),Dr))();class Vo{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return Dr.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?Dr.URL:Dr.COMPLETE:Dr.NULL}static createEmpty(n){let e=new Vo;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Vo;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Vo;return e.apply(n),e}}static createAsync(n){return(0,hn.Z)(function*(){return n instanceof File?yield Vo._createAsync(n,n.name):n instanceof Blob?yield Vo._createAsync(n):void 0})()}static _createAsync(n,e){return(0,hn.Z)(function*(){let i=yield Ps.readAsArrayBufferAsync(n),r=new Vo;return r.context.identifier=yield Ps.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Dr.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),this.createURLs()}createURLs(){this.state!==Dr.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==Dr.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Go=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION",t[t.SOUND_EFFECT=2]="SOUND_EFFECT",t[t.NOTICE=3]="NOTICE"}(Go||(Go={})),Go))();class st{constructor(n){this.volumeType=Go.MASTER,this.audio=n}static get audioContext(){return st._audioContext||(st._audioContext=new(window.AudioContext||window.webkitAudioContext)),st._audioContext}static get isMute(){return st._isMute}static set isMute(n){st._isMute=n,st.volume=st._volume}static get volume(){return st._volume}static set volume(n){st._volume=n,st.masterGainNode.gain.setTargetAtTime(st.isMute?0:st._volume,st.audioContext.currentTime,.01)}static get isAuditionMute(){return st._isAuditionMute}static set isAuditionMute(n){st._isAuditionMute=n,st.auditionVolume=st._auditionVolume}static get auditionVolume(){return st._auditionVolume}static set auditionVolume(n){st._auditionVolume=n,st.auditionGainNode.gain.setTargetAtTime(st.isAuditionMute?0:st._auditionVolume,st.audioContext.currentTime,.01)}static get isSoundEffectMute(){return st._isSoundEffectMute}static set isSoundEffectMute(n){st._isSoundEffectMute=n,st.soundEffectVolume=st._soundEffectVolume}static get soundEffectVolume(){return st._soundEffectVolume}static set soundEffectVolume(n){st._soundEffectVolume=n,st.soundEffectGainNode.gain.setTargetAtTime(st.isSoundEffectMute?0:st._soundEffectVolume,st.audioContext.currentTime,.01)}static get isNoticeMute(){return st._isNoticeMute}static set isNoticeMute(n){st._isNoticeMute=n,st.noticeVolume=st._noticeVolume}static get noticeVolume(){return st._noticeVolume}static set noticeVolume(n){st._noticeVolume=n,st.noticeGainNode.gain.setTargetAtTime(st.isNoticeMute?0:st._noticeVolume,st.audioContext.currentTime,.01)}static get masterGainNode(){if(!st._masterGainNode){let n=st.audioContext.createGain();n.gain.setValueAtTime(st._volume,st.audioContext.currentTime),n.connect(st.audioContext.destination),st._masterGainNode=n}return st._masterGainNode}static get auditionGainNode(){if(!st._auditionGainNode){let n=st.audioContext.createGain();n.gain.setValueAtTime(st._auditionVolume,st.audioContext.currentTime),n.connect(st.audioContext.destination),st._auditionGainNode=n}return st._auditionGainNode}static get soundEffectGainNode(){if(!st._soundEffectGainNode){let n=st.audioContext.createGain();n.gain.setValueAtTime(st._soundEffectVolume,st.audioContext.currentTime),n.connect(st.audioContext.destination),st._soundEffectGainNode=n}return st._soundEffectGainNode}static get noticeGainNode(){if(!st._noticeGainNode){let n=st.audioContext.createGain();n.gain.setValueAtTime(st._noticeVolume,st.audioContext.currentTime),n.connect(st.audioContext.destination),st._noticeGainNode=n}return st._noticeGainNode}static get rootNode(){return st.masterGainNode}static get auditionNode(){return st.auditionGainNode}static get soundEffectNode(){return st.soundEffectGainNode}static get noticeNode(){return st.noticeGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=st.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static play(n,e=1){this.playBufferAsync(n,e)}static playSoundEffect(n,e=1){this.playBufferAsyncBase(st.soundEffectNode,n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===Dr.URL&&(st.cacheMap.has(n.identifier)?e=st.cacheMap.get(n.identifier).url:st.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){switch(this.volumeType){case Go.AUDITION:return st.auditionNode;case Go.SOUND_EFFECT:return st.soundEffectNode;case Go.NOTICE:return st.noticeNode;default:return st.rootNode}}static playBufferAsync(n,e=1){return(0,hn.Z)(function*(){st.playBufferAsyncBase(st.rootNode,n,e)})()}static playBufferAsyncBase(n,e,i=1){return(0,hn.Z)(function*(){let r=yield st.createBufferSourceAsync(e);if(!r)return;let o=st.audioContext.createGain();o.gain.setValueAtTime(i,st.audioContext.currentTime),o.connect(n),r.connect(o),r.onended=()=>{r.stop(),r.disconnect(),o.disconnect(),r.buffer=null},r.start()})()}static createBufferSourceAsync(n){var e=this;return(0,hn.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===Dr.URL)if(st.cacheMap.has(n.identifier))i=st.cacheMap.get(n.identifier).blob;else{let s=yield st.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=st.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,hn.Z)(function*(i,r){st.audioContext.decodeAudioData(yield Ps.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,hn.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,hn.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield st.getBlobAsync(n)}catch(i){return console.error(i),e}return st.cacheMap.has(n.identifier)?st.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),st.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){st.audioContext.resume();let n=()=>{st.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}st.AUDITION_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-volume-local-storage",st.MAIN_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-volume-local-storage",st.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-volume-local-storage",st.NOTICE_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-volume-local-storage",st.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-is-mute-local-storage",st.MAIN_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-is-mute-local-storage",st.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-is-mute-local-storage",st.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-is-mute-local-storage",st._isMute=!1,st._volume=.5,st._isAuditionMute=!1,st._auditionVolume=.5,st._isSoundEffectMute=!1,st._soundEffectVolume=.5,st._isNoticeMute=!1,st._noticeVolume=.5,st.cacheMap=new Map;class Jt{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return Jt._instance||(Jt._instance=new Jt),Jt._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,hn.Z)(function*(){let i=yield Vo.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Vo.create(n);else if(n instanceof Vo)e=n;else{if(this.update(n))return this.hash[n.identifier];e=Vo.create(n)}return this._add(e)}_add(n){return Dr.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof Vo?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Ve.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new Oa(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of Jt.instance.audios)Dr.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var gg=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(gg||(gg={})),gg))();const qt={name:"",disabled:!0,type:gg.SEPARATOR};let pr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=Je.CHAT_DEFAULT_COLOR,this.titleBold=!1}get isShow(){return!!this.panelComponentRef}open(e,i,r,o,s,a){let h;this.close(),o||(o=t.defaultParentViewContainerRef,console.log("Context Open")),h=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const b=h.injector.get(t);b.panelComponentRef=h,i&&(b.actions=i),e&&(b.position.x=e.x,b.position.y=e.y),b.titleColor=s||Je.CHAT_DEFAULT_COLOR,b.titleBold=a,b.title=r??"",h.onDestroy(()=>{b.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})(),vi=(()=>{class t{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)($n(Fn))},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class $l extends u{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function vl(...t){return Ji(t,Ko(t))}function UT(t,n,e){return e?UT(t,n).pipe(rf(e)):new F(i=>{const r=(...s)=>i.next(1===s.length?s[0]:s),o=t(r);return d(n)?()=>n(r,o):void 0})}function bl(...t){const n=Ko(t),e=Wo(t),{args:i,keys:r}=$w(t);if(0===i.length)return Ji([],n);const o=new F(HT(i,n,r?s=>vw(r,s):D));return e?o.pipe(rf(e)):o}function HT(t,n,e=D){return i=>{VT(n,()=>{const{length:r}=t,o=new Array(r);let s=r,a=r;for(let h=0;h<r;h++)VT(n,()=>{const b=Ji(t[h],n);let ee=!1;b.subscribe($(i,de=>{o[h]=de,ee||(ee=!0,a--),a||i.next(e(o.slice()))},()=>{--s||i.complete()}))},i)},i)}}function VT(t,n,e){t?fo(e,t,n):n()}function ra(t){return t<=0?()=>qa:C((n,e)=>{let i=0;n.subscribe($(e,r=>{++i<=t&&(e.next(r),t<=i&&e.complete())}))})}function mg(...t){return function n7(){return Nl(1)}()(Ji(t,Ko(t)))}function GT(...t){const n=Ko(t);return C((e,i)=>{(n?mg(t,e,n):mg(t,e)).subscribe(i)})}function qT(t,n,e){const i=d(t)||n||e?{next:t,error:n,complete:e}:t;return i?C((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe($(o,h=>{var b;null===(b=i.next)||void 0===b||b.call(i,h),o.next(h)},()=>{var h;a=!1,null===(h=i.complete)||void 0===h||h.call(i),o.complete()},h=>{var b;a=!1,null===(b=i.error)||void 0===b||b.call(i,h),o.error(h)},()=>{var h,b;a&&(null===(h=i.unsubscribe)||void 0===h||h.call(i)),null===(b=i.finalize)||void 0===b||b.call(i)}))}):D}function fv(t){return C((n,e)=>{Cr(t).subscribe($(e,()=>e.complete(),N)),!e.closed&&n.subscribe(e)})}class r7 extends F{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,m(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new x;const e=this.getSubject();n.add(this.source.subscribe($(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=x.EMPTY)}return n}refCount(){return function i7(){return C((t,n)=>{let e=null;t._refCount++;const i=$(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}()(this)}}const s7={connector:()=>new u};function WT(t,n=s7){const{connector:e}=n;return C((i,r)=>{const o=e();Cr(t(function o7(t){return new F(n=>t.subscribe(n))}(o))).subscribe(r),r.add(i.subscribe(o))})}function KT(t){return t?n=>WT(t)(n):n=>function a7(t,n){const e=d(t)?t:()=>t;return d(n)?WT(n,{connector:e}):i=>new r7(i,e)}(new u)(n)}function Nf(t,n){return C((e,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();e.subscribe($(i,h=>{r?.unsubscribe();let b=0;const ee=o++;Cr(t(h,ee)).subscribe(r=$(i,de=>i.next(n?n(h,de,ee,b++):de),()=>{r=null,a()}))},()=>{s=!0,a()}))})}function hv(...t){const n=Wo(t);return C((e,i)=>{const r=t.length,o=new Array(r);let s=t.map(()=>!1),a=!1;for(let h=0;h<r;h++)Cr(t[h]).subscribe($(i,b=>{o[h]=b,!a&&!s[h]&&(s[h]=!0,(a=s.every(D))&&(s=null))},N));e.subscribe($(i,h=>{if(a){const b=[h,...o];i.next(n?n(...b):b)}}))})}function l7(t,n,e,i,r){return(o,s)=>{let a=e,h=n,b=0;o.subscribe($(s,ee=>{const de=b++;h=a?t(h,ee,de):(a=!0,ee),i&&s.next(h)},r&&(()=>{a&&s.next(h),s.complete()})))}}function d7(t,n){return t===n}const{isArray:f7}=Array;function h7(t){return 1===t.length&&f7(t[0])?t[0]:t}function ZT(...t){const n=Wo(t);return n?fe(ZT(...t),rf(n)):C((e,i)=>{HT([e,...h7(t)])(i)})}function mc(t,n){return C((e,i)=>{let r=0;e.subscribe($(i,o=>t.call(n,o,r++)&&i.next(o)))})}const g7=["youtubeContainer"];let JT=(()=>{class t{constructor(e,i){this._ngZone=e,this._youtubeContainer=new u,this._destroyed=new u,this._playerChanges=new $l(void 0),this._videoId=new $l(void 0),this._height=new $l(390),this._width=new $l(640),this._startSeconds=new $l(void 0),this._endSeconds=new $l(void 0),this._suggestedQuality=new $l(void 0),this._playerVars=new $l(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=D$(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=vl(!0);if(!window.YT||!window.YT.Player){const r=new u;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(ra(1),GT(!1))}const i=function v7(t,n,e,i,r,o,s){const a=bl([n,o]).pipe(hv(bl([i,r])),se(([h,b])=>{const[ee,de]=h,[_e,Ce]=b;return ee?{videoId:ee,playerVars:de,width:_e,height:Ce}:void 0}));return bl([t,a,vl(s)]).pipe(function b7(t){return fe(ZT(t),function p7(t){return C((n,e)=>{let i=!1,r=0;n.subscribe($(e,o=>(i||(i=!t(o,r++)))&&e.next(o)))})}(([n,e])=>!e),se(([n])=>n))}(e),function c7(t,n){return C(l7(t,n,arguments.length>=2,!0))}(y7,void 0),function u7(t,n=D){return t=t??d7,C((e,i)=>{let r,o=!0;e.subscribe($(i,s=>{const a=n(s);(o||!t(r,a))&&(o=!1,r=a,i.next(s))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(qT(r=>{this._playerChanges.next(r)}),function $7(t){return Ls(n=>n?eS(n)?vl(n):new F(e=>{let i=!1,r=!1;const o=s=>{r=!0,i||(s.target.removeEventListener("onReady",o),e.next(s.target))};return n.addEventListener("onReady",o),()=>{i=!0,r||t(n)}}).pipe(ra(1),GT(void 0)):vl(void 0))}(r=>{eS(r)||r.destroy()}),fv(this._destroyed),KT());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function m7(t,n,e){bl([t,n,e]).subscribe(([i,r,o])=>i&&i.setSize(r,o))}(i,this._width,this._height),function _7(t,n){bl([t,n]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function C7(t,n,e,i,r,o){const s=bl([e,i]).pipe(se(([ee,de])=>({startSeconds:ee,endSeconds:de}))),a=s.pipe(pv(t,ee=>!!ee&&!function x7(t){const n=t.getPlayerState();return n!==YT.PlayerState.UNSTARTED&&n!==YT.PlayerState.CUED}(ee))),h=n.pipe(pv(t,(ee,de)=>!!ee&&ee.videoId!==de));ga(t.pipe(pv(bl([n,s]),([ee,de],_e)=>!(!_e||ee==_e.videoId&&!de.startSeconds&&!de.endSeconds))),h,a).pipe(hv(bl([t,n,s,r])),se(([ee,de])=>de),fv(o)).subscribe(([ee,de,_e,Ce])=>{!de||!ee||(ee.videoId=de,ee.cueVideoById({videoId:de,suggestedQuality:Ce,..._e}))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:o,volume:s,muted:a,seek:h}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=o&&e.setPlaybackRate(o),null!=s&&e.setVolume(s),null!=a&&(a?e.mute():e.unMute()),null!=h&&e.seekTo(h.seconds,h.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(Nf(i=>i?UT(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch{}}):vl()),i=>new F(r=>i.subscribe({next:o=>this._ngZone.run(()=>r.next(o)),error:o=>r.error(o),complete:()=>r.complete()})),fv(this._destroyed))}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(qd))},t.\u0275cmp=mn({type:t,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&Tn(g7,5),2&e){let r;En(r=Sn())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&vt(0,"div",null,0)},encapsulation:2,changeDetection:0}),t})();function y7(t,[n,e,i]){if(t&&e&&t.playerVars!==e.playerVars)t.destroy();else{if(!e)return void(t&&t.destroy());if(t)return t}const r=i.runOutsideAngular(()=>new YT.Player(n,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function eS(t){return"getPlayerStatus"in t}function pv(t,n){return fe(hv(t),mc(([e,i])=>n(i,e)),se(([e])=>e))}let w7=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({}),t})();var Xi;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(Xi||(Xi={}));class ls{constructor(n,e={capture:!1,passive:!1,always:!1}){this.target=n,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(n))}onTouch(n){let e=n.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=n.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===n.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){for(let i of this.lastPointers)if(i.identifier!==n.identifier&&(n.x-i.x)**2+(n.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let gv=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Gn,this.onmove=new Gn,this.onend=new Gn,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let a=h=>{h.cancelable&&h.preventDefault(),h.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",a,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const s=r.right-r.left,a=r.bottom-r.top;o.right+s/2<r.right+e.x&&(i.x+=o.right+s/2-(r.right+e.x)),r.left+e.x<o.left-s/2&&(i.x+=o.left-s/2-(r.left+e.x)),o.bottom+a/2<r.bottom+e.y&&(i.y+=o.bottom+a/2-(r.bottom+e.y)),r.top+e.y<o.top-a/2&&(i.y+=o.top-a/2-(r.top+e.y))}else o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Xi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Xi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Ai))},t.\u0275dir=_n({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})(),_i=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(Ge(mw,16))},t.\u0275pipe=Or({name:"safe",type:t,pure:!0}),t})();const E7=["cutInImageElement"],T7=["videoPlayerComponent"];function S7(t,n){1&t&&An(0)}const Of=function(t,n,e,i,r,o,s){return{video:t,test:n,secret:e,minimaize:i,"is-bordered":r,"is-grab":o,"is-grabbing":s}};function I7(t,n){if(1&t){const e=gt();Z(0,"div",2,3),Ae("@cutInNone.done",function(){Fe(e);const r=ge();return Re(r.isVisible?null:r.end())})("dblclick",function(){return Fe(e),Re(ge().stop())})("mousedown",function(){return Fe(e),Re(ge().draggstart())})("mouseup",function(){return Fe(e),Re(ge().draggend())})("mouseleave",function(){return Fe(e),Re(ge().draggend())})("mouseout",function(){return Fe(e),Re(ge().draggend())})("mousemove",function(){Fe(e);const r=ge();return Re(!!r.isPointerDragging&&r.draggstart())}),Te(2,S7,1,0,"ng-container",4),ne()}if(2&t){const e=ge(),i=dn(6);pt("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),ie("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",yu(17,Of,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),V(2),ie("ngTemplateOutlet",i)}}function M7(t,n){1&t&&An(0)}function k7(t,n){if(1&t){const e=gt();Z(0,"div",2,3),Ae("@cutInFadeInOut.done",function(){Fe(e);const r=ge();return Re(r.isVisible?null:r.end())})("dblclick",function(){return Fe(e),Re(ge().stop())})("mousedown",function(){return Fe(e),Re(ge().draggstart())})("mouseup",function(){return Fe(e),Re(ge().draggend())})("mouseleave",function(){return Fe(e),Re(ge().draggend())})("mouseout",function(){return Fe(e),Re(ge().draggend())})("mousemove",function(){Fe(e);const r=ge();return Re(!!r.isPointerDragging&&r.draggstart())}),Te(2,M7,1,0,"ng-container",4),ne()}if(2&t){const e=ge(),i=dn(6);pt("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),ie("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",yu(17,Of,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),V(2),ie("ngTemplateOutlet",i)}}function D7(t,n){1&t&&An(0)}function A7(t,n){if(1&t){const e=gt();Z(0,"div",2,3),Ae("@cutInBounceInOut.done",function(){Fe(e);const r=ge();return Re(r.isVisible?null:r.end())})("dblclick",function(){return Fe(e),Re(ge().stop())})("mousedown",function(){return Fe(e),Re(ge().draggstart())})("mouseup",function(){return Fe(e),Re(ge().draggend())})("mouseleave",function(){return Fe(e),Re(ge().draggend())})("mouseout",function(){return Fe(e),Re(ge().draggend())})("mousemove",function(){Fe(e);const r=ge();return Re(!!r.isPointerDragging&&r.draggstart())}),Te(2,D7,1,0,"ng-container",4),ne()}if(2&t){const e=ge(),i=dn(6);pt("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),ie("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",yu(17,Of,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),V(2),ie("ngTemplateOutlet",i)}}function P7(t,n){1&t&&An(0)}function N7(t,n){if(1&t){const e=gt();Z(0,"div",2,3),Ae("@cutInOpenInOut.done",function(){Fe(e);const r=ge();return Re(r.isVisible?null:r.end())})("dblclick",function(){return Fe(e),Re(ge().stop())})("mousedown",function(){return Fe(e),Re(ge().draggstart())})("mouseup",function(){return Fe(e),Re(ge().draggend())})("mouseleave",function(){return Fe(e),Re(ge().draggend())})("mouseout",function(){return Fe(e),Re(ge().draggend())})("mousemove",function(){Fe(e);const r=ge();return Re(!!r.isPointerDragging&&r.draggstart())}),Te(2,P7,1,0,"ng-container",4),ne()}if(2&t){const e=ge(),i=dn(6);pt("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),ie("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",yu(17,Of,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),V(2),ie("ngTemplateOutlet",i)}}function O7(t,n){1&t&&An(0)}function F7(t,n){if(1&t){const e=gt();Z(0,"div",2,3),Ae("@cutInOpenInOut2.done",function(){Fe(e);const r=ge();return Re(r.isVisible?null:r.end())})("dblclick",function(){return Fe(e),Re(ge().stop())})("mousedown",function(){return Fe(e),Re(ge().draggstart())})("mouseup",function(){return Fe(e),Re(ge().draggend())})("mouseleave",function(){return Fe(e),Re(ge().draggend())})("mouseout",function(){return Fe(e),Re(ge().draggend())})("mousemove",function(){Fe(e);const r=ge();return Re(!!r.isPointerDragging&&r.draggstart())}),Te(2,O7,1,0,"ng-container",4),ne()}if(2&t){const e=ge(),i=dn(6);pt("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),ie("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",yu(17,Of,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),V(2),ie("ngTemplateOutlet",i)}}function R7(t,n){1&t&&(Z(0,"div",21),$e(1,"TEST"),ne())}function L7(t,n){1&t&&(Z(0,"div",22),$e(1,"TEST"),ne())}function B7(t,n){1&t&&(Z(0,"div",23),$e(1,"TEST"),ne())}function z7(t,n){1&t&&(Z(0,"div",24),$e(1,"TEST"),ne())}function j7(t,n){1&t&&(Z(0,"div",25)(1,"i",26),$e(2,"visibility"),ne(),$e(3," For Your Eyes Only"),ne())}function U7(t,n){1&t&&(Z(0,"div",27),$e(1,"For Your Eyes Only "),Z(2,"i",26),$e(3,"visibility"),ne()())}function H7(t,n){if(1&t&&(Z(0,"div",28)(1,"span")(2,"span",29),$e(3),ne()()()),2&t){const e=ge(2);V(1),pt("color",e.senderColor),V(1),pt("width",e.pixcelWidth-(e.isBordered?6:0),"px"),V(1),Ja("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function V7(t,n){if(1&t&&(Z(0,"div",30)(1,"span")(2,"span",29),$e(3),ne()()()),2&t){const e=ge(2);V(1),pt("color",e.senderColor),V(1),pt("width",e.pixcelWidth-(e.isBordered?6:0),"px"),V(1),Ja("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function G7(t,n){if(1&t){const e=gt();Z(0,"div",31),Ae("contextmenu",function(r){return Fe(e),Re(ge(2).onContextMenu(r))}),ne()}if(2&t){const e=ge(2);pt("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}const q7=function(t,n,e,i){return{autoplay:1,controls:0,start:t,loop:n,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function W7(t,n){if(1&t){const e=gt();Z(0,"youtube-player",32,33),Ae("ready",function(r){return Fe(e),Re(ge(2).onPlayerReady(r))})("stateChange",function(r){return Fe(e),Re(ge(2).onPlayerStateChange(r))}),ne()}if(2&t){const e=ge(2);pt("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),ie("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",Is(6,q7,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function K7(t,n){if(1&t){const e=gt();Z(0,"img",34,35),Ae("error",function(){return Fe(e),Re(ge(2).onErrorFallback())}),ne()}if(2&t){const e=ge(2);pt("object-fit",e.objectFit),ie("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",vn)}}function Y7(t,n){if(1&t){const e=gt();Z(0,"img",36,35),Ae("load",function(){return Fe(e),Re(ge(2).onImageLoad())})("contextmenu",function(r){return Fe(e),Re(ge(2).onContextMenu(r))}),zt(2,"safe"),ne()}if(2&t){const e=ge(2);pt("object-fit",e.objectFit),ie("src",jt(2,3,e.cutInImgageUrl,"resourceUrl"),vn)}}const _g=function(t){return{transform:t}};function Z7(t,n){if(1&t){const e=gt();Te(0,R7,2,0,"div",5),Te(1,L7,2,0,"div",6),Te(2,B7,2,0,"div",7),Te(3,z7,2,0,"div",8),Te(4,j7,4,0,"div",9),Te(5,U7,4,0,"div",10),Te(6,H7,4,6,"div",11),Te(7,V7,4,6,"div",12),Z(8,"div",13),Ae("contextmenu",function(r){return Fe(e),Re(ge().onContextMenu(r))}),ne(),Z(9,"div",14),Ae("contextmenu",function(r){return Fe(e),Re(ge().onContextMenu(r))}),ne(),Z(10,"div",15),Ae("contextmenu",function(r){return Fe(e),Re(ge().onContextMenu(r))}),ne(),Z(11,"div",16),Ae("contextmenu",function(r){return Fe(e),Re(ge().onContextMenu(r))}),ne(),Te(12,G7,1,4,"div",17),Te(13,W7,2,11,"youtube-player",18),Te(14,K7,2,3,"img",19),Te(15,Y7,3,6,"img",20)}if(2&t){const e=ge();ie("ngIf",e.isTest),V(1),ie("ngIf",e.isTest),V(1),ie("ngIf",e.isTest),V(1),ie("ngIf",e.isTest),V(1),ie("ngIf",e.isSecret),V(1),ie("ngIf",e.isSecret),V(1),ie("ngIf",e.isIndicateSender),V(1),ie("ngIf",e.isIndicateSender),V(1),pt("width",e.pixcelWidth+3,"px")("height",19,"px"),ie("ngStyle",wt(32,_g,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),V(1),pt("width",e.pixcelWidth+3,"px")("height",19,"px"),ie("ngStyle",wt(34,_g,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),V(1),pt("width",19,"px")("height",e.pixcelHeight+3,"px"),ie("ngStyle",wt(36,_g,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),V(1),pt("width",19,"px")("height",e.pixcelHeight+3,"px"),ie("ngStyle",wt(38,_g,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),V(1),ie("ngIf",!e.videoId),V(1),ie("ngIf",e.videoId),V(1),ie("ngIf",e.videoId&&!e.isSoundOnly),V(1),ie("ngIf",!e.videoId||e.isSoundOnly)}}let nS=(()=>{class t{constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=sn.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new st,this._cutInImgageUrl=null}get naturalWidth(){return this.videoId&&!this.isSoundOnly?480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?270:this._naturalHeight}ngOnInit(){Ve.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()}),this._cutInImgageUrl=this.cutInImage.state!==Pi.COMPLETE||this._cutInImgageUrl?this.cutInImage.url:URL.createObjectURL(this.cutInImage.blob)}ngOnDestroy(){Ve.unregister(this,"UPDATE_AUDIO_RESOURE"),Ve.unregister(this,"CHANGE_JUKEBOX_VOLUME"),Ve.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo),URL.revokeObjectURL(this._cutInImgageUrl)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=Kt.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||sn.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=t.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=t.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return this.isTest?st.isAuditionMute?0:100*st.auditionVolume:st.isMute?0:100*st.volume}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=Je.findByPeerId(this.sender);return i instanceof Je&&(e=i.name),e}get isMine(){return this.sender===Je.myCursor.peerId}get senderColor(){let e=Je.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=Je.findByPeerId(this.sender);return i instanceof Je&&(e=i.color),e}get cutInImgageUrl(){return this._cutInImgageUrl}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.videoId?12:this.cutIn.duration)))))}_play(){if(this.isEnd)return;const e=Jt.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?Go.AUDITION:Go.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):Ve.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){Ve.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){e.target.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;if(1==i){if(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn.duration>0){clearTimeout(this._timeoutId);const r=this.cutIn.duration-this.videoPlayer.getCurrentTime()+(this.cutIn.videoStart?parseInt(this.cutIn.videoStart):0);r<=0?this.stop():this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.duration>r?r:this.cutIn.duration))}this.cutIn&&Ve.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})}2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},qt,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0}],this.cutIn.name)}}return t.MIN_SIZE=250,t.\u0275fac=function(e){return new(e||t)(Ge(vi),Ge(pr),Ge(Fn))},t.\u0275cmp=mn({type:t,selectors:[["cut-in"]],viewQuery:function(e,i){if(1&e&&(Tn(E7,5),Tn(T7,5)),2&e){let r;En(r=Sn())&&(i.cutInImageElement=r.first),En(r=Sn())&&(i.videoPlayer=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["image",""],["appDraggable","",1,"container",2,"position","absolute",3,"draggable.allowOverHalf","draggable.unhandle","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove"],["cutInContainerElement",""],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"ngStyle","contextmenu"],[1,"handler","bottom",3,"ngStyle","contextmenu"],[1,"handler","left",3,"ngStyle","contextmenu"],[1,"handler","right",3,"ngStyle","contextmenu"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],["draggable","false",2,"pointer-events","auto",3,"src","error"],["cutInImageElement",""],["draggable","false",2,"pointer-events","none",3,"src","load","contextmenu"]],template:function(e,i){1&e&&(Te(0,I7,3,25,"div",0),Te(1,k7,3,25,"div",0),Te(2,A7,3,25,"div",0),Te(3,N7,3,25,"div",0),Te(4,F7,3,25,"div",0),Te(5,Z7,16,40,"ng-template",null,1,Qn)),2&e&&(ie("ngIf",i.isVisible&&-1==i.animationType),V(1),ie("ngIf",i.isVisible&&0==i.animationType),V(1),ie("ngIf",i.isVisible&&1==i.animationType),V(1),ie("ngIf",i.isVisible&&2==i.animationType),V(1),ie("ngIf",i.isVisible&&3==i.animationType))},dependencies:[oi,Rn,tl,hr,JT,gv,_i],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0;top:0}.left-bottom[_ngcontent-%COMP%]{left:0;bottom:0}.right-top[_ngcontent-%COMP%]{right:0;top:0}.right-bottom[_ngcontent-%COMP%]{right:0;bottom:0}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0;left:0}.handler.bottom[_ngcontent-%COMP%]{bottom:0;right:0}.handler.left[_ngcontent-%COMP%]{top:0;left:0}.handler.right[_ngcontent-%COMP%]{right:0;bottom:0}"],data:{animation:[Hn("cutInNone",[en("void => *",[Qt("10ms ease-in",Cn([ht({opacity:0,offset:0}),ht({opacity:1,offset:1})]))]),en("* => void",[Qt("10ms ease-in",Cn([ht({opacity:0,offset:1})]))])]),Hn("cutInFadeInOut",[en("void => *",[Qt("330ms ease-in",Cn([ht({opacity:0,offset:0}),ht({opacity:1,offset:1})]))]),en("* => void",[Qt("330ms ease-in",Cn([ht({opacity:1,offset:0}),ht({opacity:0,offset:1})]))])]),Hn("cutInBounceInOut",[en("void => *",[Qt("600ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale3d(0, 0, 0)"}))])]),Hn("cutInOpenInOut",[en("void => *",[Qt("262ms ease",Cn([ht({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),ht({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),ht({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),Hn("cutInOpenInOut2",[en("void => *",[Qt("262ms ease",Cn([ht({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),ht({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),ht({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}}),t})(),$g=(()=>{class t{constructor(){}static nowShowingIdentifiers(){return this.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,o=null){if(!e)return;for(const a of t.cutInComponentRefQueue)if(a&&a.instance){const h=a.instance;if(h.isEnd)a.destroy();else{const b=h.cutIn;(e.identifier===b.identifier||e.videoId&&b.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=b.tag&&""!=b.tag.trim()&&tt.toHalfWidth(e.tag).toUpperCase().trim()==tt.toHalfWidth(b.tag).toUpperCase().trim())&&h.stop()}}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(a=>a&&a.instance);const s=t.defaultParentViewContainerRef.createComponent(nS);s.instance.cutIn=e,s.instance.animationType=e.animationType,s.instance.videoId=e.videoId,s.instance.playListId=e.playListId,s.instance.isSecret=i,s.instance.isTest=r,s.instance.sender=o,s.instance.play(),t.cutInComponentRefQueue.push(s)}stop(e){if(e){e instanceof Oi&&(e=e.identifier);for(const i of t.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(i=>i&&i.instance)}}}return t.cutInComponentRefQueue=[],t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Oi=class extends ii{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=sn.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let n="";if(!tt.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const n=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return n&&n[1]?this._sec(n[1]):null}_sec(n){if(!n)return null;let e=null;if(e=/^(\d+)$/.exec(n))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(n)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let n="";if(!tt.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(n=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!Jt.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(n=>null!=n?n.trimRight():""))).filter(n=>""!=n)}get isPlayingNow(){return $g.nowShowingIdentifiers().includes(this.identifier)}};var cs;ve([yt()],Oi.prototype,"name",void 0),ve([yt()],Oi.prototype,"tag",void 0),ve([yt()],Oi.prototype,"duration",void 0),ve([yt()],Oi.prototype,"width",void 0),ve([yt()],Oi.prototype,"height",void 0),ve([yt()],Oi.prototype,"posX",void 0),ve([yt()],Oi.prototype,"posY",void 0),ve([yt()],Oi.prototype,"zIndex",void 0),ve([yt()],Oi.prototype,"objectFitType",void 0),ve([yt()],Oi.prototype,"animationType",void 0),ve([yt()],Oi.prototype,"borderStyle",void 0),ve([yt()],Oi.prototype,"isFrontOfStand",void 0),ve([yt()],Oi.prototype,"isPreventOutBounds",void 0),ve([yt()],Oi.prototype,"imageIdentifier",void 0),ve([yt()],Oi.prototype,"isVideoCutIn",void 0),ve([yt()],Oi.prototype,"videoUrl",void 0),ve([yt()],Oi.prototype,"audioFileName",void 0),ve([yt()],Oi.prototype,"audioIdentifier",void 0),ve([yt()],Oi.prototype,"isLoop",void 0),Oi=ve([mi("cut-in")],Oi);let Os=cs=class extends ii{static get instance(){return cs._instance||(cs._instance=new cs("CutInList"),cs._instance.initialize()),cs._instance}get cutIns(){return this.children}addCutIn(...n){let e=null;if(n[0]instanceof Oi)e=n[0];else{let i=n[0];e=new Oi(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of cs.instance.children)i.destroy();let e=cs.instance.toContext();e.syncData=this.toContext().syncData,cs.instance.apply(e),cs.instance.update(),super.parseInnerXml.apply(cs.instance,[n]),this.destroy()}matchCutInInfo(n){n=tt.toHalfWidth(n).toUpperCase().trimRight();let e="",i=new Map;const r=[];for(const a of this.cutIns.map(h=>[Math.random(),h]).sort((h,b)=>h[0]-b[0]).map(h=>h[1])){if(!a)continue;let h=!1;for(const b of a.postfixes)n.endsWith(tt.toHalfWidth(b).toUpperCase().trimRight())&&(h=!0,("@"==b.slice(0,1)||"\uff20"==b.slice(0,1))&&e.length<b.length&&(e=b));if(h){const b=a.tag;null!=b&&b.trim().length>0?i.set(tt.toHalfWidth(b).toUpperCase().trim(),a):r.push(a)}}r.push(...i.values());const s=r.map(a=>[Math.random(),a]).sort((a,h)=>a[0]-h[0]);return{names:s.map(a=>a[1].name),identifiers:s.map(a=>a[1].identifier),matchMostLongText:e}}};var In;Os=cs=ve([mi("cut-in-list")],Os);let Xn=In=class extends gl{constructor(n,e=null){super(n),this.chatMessageService=e}static rollCommandAsync(n,e="DiceBot",i=!1){var r=this;return(0,hn.Z)(function*(){const o=n.replace("\u200b",""),s=/^(([s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[s\uff33\uff53][x\uff38\uff58]|[x\uff38\uff58])?([\d\uff10-\uff19]+)?[ \u3000]+)?([^\n]*)?/gi.exec(o),a=tt.toHalfWidth(s[2]),h=a&&0===tt.toHalfWidth(a).toUpperCase().indexOf("S"),b=null!=s[3]?Number(tt.toHalfWidth(s[3])):1;let ee=null!=s[4]?s[4]:o,de={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1};if(!ee||b<=0)return de;let _e=!1;for(const Ce of Ns.instance.diceRollTables){if(null==Ce.command)continue;let Se=!1,Pe=0,Ne="",je=!1;const He=tt.toHalfWidth(Ce.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim().toUpperCase(),Ue=tt.toHalfWidth(ee.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim().toUpperCase();if(!Ue.startsWith("S"+He)||Ue[("S"+He).length]&&!/[ \=\+\-]/.test(Ue.charAt(("S"+He).length))?Ue.startsWith(He)&&(!Ue[He.length]||/[ \=\+\-]/.test(Ue.charAt(He.length)))&&(_e=!0,Ue[He.length]&&" "!=Ue[He.length]&&(Ne=Ue.substring(He.length))):(_e=!0,Se=!0,Ue[("S"+He).length]&&" "!=Ue[("S"+He).length]&&(Ne=Ue.substring(("S"+He).length))),Ne)if(Ne=Ne.split(" ")[0],/^[\+\-]\d+$/.test(Ne))Pe=+Ne,Ne=` (\u4fee\u6b63${Ne})`;else{if(!/^\=\-?\d+$/.test(Ne)){_e=!1;continue}je=!0}if(_e){de.isFailure=!1,de.isDiceRollTable=!0,de.tableName=Ce.name&&Ce.name.length>0?Ce.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",de.isSecret=Se||h;const We=Ce.parseText();for(let mt=0;mt<b&&mt<32;mt++){let Xe=null,ct=yield In.diceRollAsync(je?`C(${Ne.substring(1)})`:tt.toHalfWidth(Ce.dice).trim().replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);de.isEmptyDice=de.isEmptyDice&&ct.isEmptyDice;let It=null;ct.result.length>0&&(It=ct.result.match(/\s\uff1e\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(Xe=+It[1]),ct.result&&i&&(ct.result=r.formatRollResult(ct.result));let ot=!1;if(null!=Xe)for(const _t of We)if((null===_t.range.start||_t.range.start<=Xe+Pe)&&(null===_t.range.end||Xe+Pe<=_t.range.end)){i?de.result+=je?"\u6307\u5b9a="+Xe+"\n"+tt.cr(_t.result):ct.result+Ne+(Ne?` \u2192 ${Xe+Pe}`:"")+"\n"+tt.cr(_t.result):de.result=(je?"\u6307\u5b9a=":"")+Xe+(je?"":Ne)+" \uff1e "+_t.result,ot=!0;break}ot||(null==Xe?(de.isFailure=!0,de.result+="\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)"):de.result+=je?"\u6307\u5b9a="+Xe+"\n(\u7d50\u679c\u306a\u3057)":ct.result+Ne+(Ne?` \u2192 ${Xe+Pe}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<b&&(de.result+=` #${mt+1}`),mt<b-1&&(de.result+="\n")}break}}if(!_e){let Se,Ce=!1;if((Se=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*)([ \u3000]+|[\\\uffe5][s\uff53])([^\n]*)/gi.exec(ee.trim()))&&(ee=tt.toHalfWidth(Se[1]+tt.cr(Se[2])),null!=Se[2]&&(ee+=(""===tt.toHalfWidth(Se[3]).trim()?Se[3]:tt.cr(Se[3])).trim().replace(/[\u3000\s]+/g," ")),Ce=!0),Ce||((Se=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\[\uff3b])([^\]\uff3d]+)([\]\uff3d])/gi.exec(ee.trim()))||(Se=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\(\uff08])([^\)\uff09]+)([\)\uff09])/gi.exec(ee.trim())))&&(console.log(Se),ee=tt.toHalfWidth(Se[1])+(null!=Se[2]?Se[2].replace(/\uff0c/g,","):"")+tt.toHalfWidth(Se[3]),Ce=!0),Ce||(ee=tt.toHalfWidth(ee).trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),In.apiUrl){if(!Ce&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(ee))return;de=yield In.diceRollAsync(ee,e,b),de.isSecret=de.isSecret||h}else{if(!(yield In.loadGameSystemAsync(e)).COMMAND_PATTERN.test(ee))return;for(let Ne=0;Ne<b&&Ne<32;Ne++){let je=yield In.diceRollAsync(ee,e,b);if(je.result.length<1)break;de.id=je.id,de.result+=je.result,de.isSecret=de.isSecret||je.isSecret||h,de.isEmptyDice=de.isEmptyDice&&je.isEmptyDice,de.isSuccess=de.isSuccess||je.isSuccess,de.isFailure=de.isFailure&&je.isFailure,de.isCritical=de.isCritical||je.isCritical,de.isFumble=de.isFumble||je.isFumble,1<b&&(de.result+=` #${Ne+1}\n`)}}}return de.result&&(de.result=de.result.trimRight()),de})()}onStoreAdded(){var n=this;super.onStoreAdded(),Ve.register(this).on("SEND_MESSAGE",function(){var e=(0,hn.Z)(function*(i){const r=Et.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;let o=r.tag.replace("noface","").trim();o=o||"DiceBot";try{const s=yield In.rollCommandAsync(r.text,o,!0);if(!s||!s.result)return;n.sendResultMessage(s,r)}catch(s){console.error(s)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),Ve.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result;const o=n.isSecret,s=n.isEmptyDice,a=n.isSuccess,h=n.isFailure,b=n.isCritical,ee=n.isFumble;if(r.length<1)return;n.isDiceRollTable||(r=In.formatRollResult(r,i));let de="system";o&&(de+=" secret"),s&&(de+=" empty"),a&&(de+=" success"),h&&(de+=" failure"),b&&(de+=" critical"),ee&&(de+=" fumble");let _e={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:n.isDiceRollTable?"Dice-Roll Table":In.apiUrl?`BCDice-API(${In.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:de,name:`${n.isDiceRollTable?n.tableName:i} : ${e.name}${o?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},Ce="";const Se=Et.instance.get(e.characterIdentifier);if(Se instanceof an){const je=Se.standList.matchStandInfo(r,e.imageIdentifier);if(!o&&!e.standName&&e.isUseStandImage)if(je.farewell){const He={characterIdentifier:Se.identifier};if(e.to){const Ue=Je.findByUserId(e.to);Ue&&(Ue.peerId!=Je.myCursor.peerId&&Ve.call("FAREWELL_STAND_IMAGE",He,Ue.peerId),Ve.call("FAREWELL_STAND_IMAGE",He,Je.myCursor.peerId))}else Ve.call("FAREWELL_STAND_IMAGE",He)}else if(je&&je.standElementIdentifier){const He=Et.instance.get(je.standElementIdentifier);if(He&&He.getFirstElementByName("conditionType")){const Ue=+He.getFirstElementByName("conditionType").value;if(Ue==Hi.Postfix||Ue==Hi.PostfixOrImage||Ue==Hi.PostfixAndImage){const We={characterIdentifier:Se.identifier,standIdentifier:je.standElementIdentifier,color:e.color,secret:!!e.to};if(We.secret){const mt=Je.findByUserId(e.to);mt&&(mt.peerId!=Je.myCursor.peerId&&Ve.call("POPUP_STAND_IMAGE",We,mt.peerId),Ve.call("POPUP_STAND_IMAGE",We,Je.myCursor.peerId))}else Ve.call("POPUP_STAND_IMAGE",We)}}}Ce=je.matchMostLongText}const Pe=Et.instance.get(e.tabIdentifier),Ne=Os.instance.matchCutInInfo(r);if(!o&&Pe.isUseStandImage&&Ne){for(const je of Ne.identifiers){const He={identifier:je,secret:!!e.to,sender:Je.myCursor.peerId};if(He.secret){const Ue=Je.findByUserId(e.to);Ue&&(Ue.peerId!=Je.myCursor.peerId&&Ve.call("PLAY_CUT_IN",He,Ue.peerId),Ve.call("PLAY_CUT_IN",He,Je.myCursor.peerId))}else Ve.call("PLAY_CUT_IN",He)}if(Ne.names&&Ne.names.length&&!e.to&&this.chatMessageService){const je=new Map;for(const Ue of Ne.names){let We=je.get(Ue)||0;We+=1,je.set(""==Ue?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":Ue,We)}const He=`${[...je.keys()].map(Ue=>je.get(Ue)>1?`${Ue}\xd7${je.get(Ue)}`:Ue).join("\u3001")}`;this.chatMessageService.sendOperationLog(He+" \u304c\u8d77\u52d5\u3057\u305f")}}Ce.length<Ne.matchMostLongText.length&&(Ce=Ne.matchMostLongText),Ce&&_e.text&&(_e.text=_e.text.slice(0,_e.text.length-Ce.length)),null!=e.to&&0<e.to.length&&(_e.to=e.to,e.to.indexOf(e.from)<0&&(_e.to+=" "+e.from)),Pe&&Pe.addMessage(_e)}static diceRollAsync(n,e,i=1){return(0,hn.Z)(function*(){if(e=e||"DiceBot",In.apiUrl){const r=1==In.apiVersion?In.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(n):`${In.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(n)}`,o=[];for(let s=1;s<=i;s++)o.push(fetch(r,{mode:"cors"}).then(a=>{if(a.ok)return a.json();throw new Error(a.statusText)}).then(a=>({id:e,result:(1==In.apiVersion?a.result:a.text)+(i>1?` #${s}\n`:""),isSecret:a.secret,isEmptyDice:1==In.apiVersion?a.dices&&0==a.dices.length:a.rands&&0==a.rands.length,isSuccess:a.success,isFailure:a.failure,isCritical:a.critical,isFumble:a.fumble})).catch(a=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(o).then(s=>s.reduce((a,h)=>({id:e,result:a.result+h.result,isSecret:a.isSecret||h.isSecret,isEmptyDice:a.isEmptyDice&&h.isEmptyDice,isSuccess:a.isSuccess||h.isSuccess,isFailure:a.isFailure&&h.isFailure,isCritical:a.isCritical||h.isCritical,isFumble:a.isFumble||h.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield In.loadGameSystemAsync(e);const o=r.eval(n);return o?(console.log("diceRoll!!!",o),console.log("isSecret!!!",o.secret),console.log("isEmptyDice!!!",!o.rands||0==o.rands.length),{id:r.ID,result:o.text,isSecret:o.secret,isEmptyDice:!o.rands||0==o.rands.length,isSuccess:o.success,isFailure:o.failure,isCritical:o.critical,isFumble:o.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(n){return(0,hn.Z)(function*(){if(n=n||"DiceBot",In.apiUrl){const e=[fetch(1==In.apiVersion?In.apiUrl+"/v1/systeminfo?system=DiceBot":`${In.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return n&&"DiceBot"!=n&&e.push(fetch(1==In.apiVersion?In.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(n):`${In.apiUrl}/v2/game_system/${encodeURIComponent(n)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==In.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield In.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],n&&""!=n&&"DiceBot"!=n){let i=yield In.loadGameSystemAsync(n);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(n){var e=this;return(0,hn.Z)(function*(){return yield In.queue.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return In.loader.getGameSystemClass(i)}catch{return In.loader.dynamicLoad(i)}})})()}static initializeDiceBotQueue(){let n=new jT("DiceBotQueue");return n.add((0,hn.Z)(function*(){In.loader=new((yield Promise.resolve().then(me.bind(me,383))).default),In.diceBotInfos=In.loader.listAvailableGameSystems().filter(e=>"DiceBot"!=e.id).sort((e,i)=>{const r=e.sortKey,o=i.sortKey;return r<o?-1:r>o?1:0}).map(e=>{const i=/.+\:(.+)/.exec(e.id);let r;return i&&i[1]&&(r="ChineseTraditional"==i[1]?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==i[1]?"\ud55c\uad6d\uc5b4":"English"==i[1]?"English":"SimplifiedChinese"==i[1]?"\u7b80\u4f53\u4e2d\u6587":"Other"),{id:e.id,game:e.name,lang:r,sort_key:e.sortKey}})})),n}static formatRollResult(n,e="DiceBot"){return null==n?"":n.split("\n").map(i=>{let r=[],o=[],s=[],a=[];return i.split(" \uff1e ").map((h,b,ee)=>{if(1===ee.length)return h;if(0==b){const _e=In.apiUrl&&1==In.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,Ce=h.match(In.apiUrl&&1==In.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i)||h.match(_e);return Ce&&!Ce[1].toUpperCase().startsWith("CHOICE")&&(r=[...h.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],r.length||(o=[...h.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],o.length||(s=[...h.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],s.length||(a=[...h.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),Ce?"\u{1f3b2}"+Ce[1]:h}if(b==ee.length-1)return h;if(1==b&&(r.length||o.length||s.length||a.length))try{let de=h;const Ce=[...h.matchAll(r.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:a.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(Ce.length){let Pe,Se=0;Ce.forEach((Ne,je)=>{if(Pe=Ne[0],r.length){const{diceCount:Ue,keepDrop:We,keepDropCount:mt}=r[je].groups,{total:Xe,diceArrayString:ct}=Ne.groups;if(We){const It=null!=ct?ct.split(",").sort((Ct,xt)=>+Ct-+xt):[],ot=We.startsWith("K")?mt:Ue-mt;("KH"===We||"DL"===We)&&It.reverse();const _t=It.map((Ct,xt)=>xt+1<=ot?`${Ct}`:`~~~${Ct}~~~`);("DH"===We||"DL"===We)&&_t.reverse(),Pe=`${Xe}[${_t.join(",")}]`}}else if(o.length){const{sign:Ue,criteria:We}=o[0].groups,{diceArrayString:mt}=Ne.groups;Pe=mt.split(",").map(Xe=>In.isPass(Xe,Ue,We)?`${Xe}`:`~~~${Xe}~~~`).join(",")}else if(s.length){let{rerollSign:Ue,rerollCriteria:We,sign:mt,criteria:Xe}=s[0].groups;Ue||(Ue=mt),We||(We=Xe);const{diceArrayString:ct}=Ne.groups;Pe=ct.split(",").map(It=>In.isPass(It,Ue,We)?`###${It}###`:It).map(It=>In.isPass(It,mt,Xe,!1)?It:`~~~${It}~~~`).join(",")}else if(a.length){const{rerollCriteria:Ue,modifier:We,sign:mt,criteria:Xe}=a[0].groups,{total:ct,diceArrayString:It,modifier2:ot,dieString:_t}=Ne.groups;if(console.log(a[0],Ne),ot)Pe=` (${ot})`;else if(ct)Pe=ct+"["+It.split(",").map(Ct=>In.isPass(Ct,">=",Ue)?`###${Ct}###`:Ct).join(",")+"]",In.isPass(+ct+(We?+We:0),mt,Xe)||(Pe=`~~~${Pe}~~~`);else{let Ct=Pe;Pe=In.isPass(_t,">=",Ue)?`###${_t}###`:_t,In.isPass(+Ct+(We?+We:0),mt,Xe)||(Pe=`~~~${Pe}~~~`)}}const He=de.indexOf(Ne[0],Se);Pe!=Ne[0]&&(de=de.substring(0,He)+Pe+de.substring(He+Ne[0].length)),Se=He+Pe.length})}h=de}catch(de){console.error(de)}else if(1==b&&"DungeonsAndDragons5"==e&&(ee[0].startsWith("(AT")||ee[0].startsWith("(AR"))){const de=ee[0].startsWith("(AT"),_e=ee[0].endsWith("A)"),Ce=ee[0].endsWith("D)");if(_e||Ce){const Se=h.match(/\[(?<diceArrayString>\d+(?:,\d+)*)?\](?<modifier>[\-+]\d+)?/i);if(!Se)return h;const{diceArrayString:Pe,modifier:Ne}=Se.groups,je=Pe.split(",").map(We=>parseInt(We)),He=_e?Math.max(...je):Math.min(...je);let Ue=!1;h="["+je.map(We=>{let mt=!de||20!==We&&1!==We?We.toString():`###${We}###`;return Ue||We!==He?mt=`~~~${mt}~~~`:Ue=!0,mt}).join(",")+"]"+(Ne||"")}else if(de){const Se=h.match(/(?<diceString>\d+)?(?<modifier>[\-+]\d+)?/i);if(Se){const{diceString:Pe,modifier:Ne}=Se.groups;Pe&&(20===parseInt(Pe)||1===parseInt(Pe))&&(h=`###${Pe}###${Ne||""}`)}}}return h}).join(" \u2192 ")}).join("\n")}static isPass(n,e,i,r=!0){if(null==n)return r;let o=n.toString().match(/(\d+)/);o&&(n=o[1]);let s=r;switch(e){case"==":case"=":s=+n==+i;break;case"!=":case"<>":s=+n!=+i;break;case">=":s=+n>=+i;break;case"<=":s=+n<=+i;break;case"<":s=+n<+i;break;case">":s=+n>+i}return s}};function iS(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function _c(t,n){for(var e=t.length-1;e>=0;e--)!0===n(t[e])&&t.splice(e,1)}function mv(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}Xn.queue=In.initializeDiceBotQueue(),Xn.loader=new Q9.default,Xn.apiUrl=null,Xn.apiVersion=1,Xn.adminUrl=null,Xn.diceBotInfos=[],Xn.diceBotInfosIndexed=[],Xn.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","\ub354\ube14\ud06c\ub85c\uc2a4 The 2nd Edition/The 3rd Edtion","\ub354\ube14\ud06c\ub85c\uc2a4 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],Xn=In=ve([mi("dice-bot")],Xn);var e,_v=function(){function t(n){void 0===n&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,e){return this.getAttrs()[n]=e,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);s=o.shift();)-1===iS(r,s)&&r.push(s);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);r.length&&(s=o.shift());){var a=iS(r,s);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return-1!==(" "+this.getClass()+" ").indexOf(" "+n+" ")},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),e=this.buildAttrsStr();return["<",n,e=e?" "+e:"",">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),e=[];for(var i in n)n.hasOwnProperty(i)&&e.push(i+'="'+n[i]+'"');return e.join(" ")},t}(),rS=function(){function t(n){void 0===n&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new _v({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var e={href:n.getAnchorHref()},i=this.createCssClass(n);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(e.title=n.getAnchorHref()),e},t.prototype.createCssClass=function(n){var e=this.className;if(e){for(var i=[e],r=n.getCssClassSuffixes(),o=0,s=r.length;o<s;o++)i.push(e+"-"+r[o]);return i.join(" ")}return""},t.prototype.processAnchorText=function(n){return this.doTruncate(n)},t.prototype.doTruncate=function(n){var e=this.truncate;if(!e||!e.length)return n;var i=e.length,r=e.location;return"smart"===r?function tj(t,n,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var s=function(He){var Ue="";return He.scheme&&He.host&&(Ue+=He.scheme+"://"),He.host&&(Ue+=He.host),He.path&&(Ue+="/"+He.path),He.query&&(Ue+="?"+He.query),He.fragment&&(Ue+="#"+He.fragment),Ue},a=function(He,Ue){var We=Ue/2,mt=Math.ceil(We),Xe=-1*Math.floor(We),ct="";return Xe<0&&(ct=He.substr(Xe)),He.substr(0,mt)+e+ct};if(t.length<=n)return t;var Ue,We,mt,h=n-r,b=(Ue={},(mt=(We=t).match(/^([a-z]+):\/\//i))&&(Ue.scheme=mt[1],We=We.substr(mt[0].length)),(mt=We.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(Ue.host=mt[1],We=We.substr(mt[0].length)),(mt=We.match(/^\/(.*?)(?=(\?|#|$))/i))&&(Ue.path=mt[1],We=We.substr(mt[0].length)),(mt=We.match(/^\?(.*?)(?=(#|$))/i))&&(Ue.query=mt[1],We=We.substr(mt[0].length)),(mt=We.match(/^#(.*?)$/i))&&(Ue.fragment=mt[1]),Ue);if(b.query){var ee=b.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);ee&&(b.query=b.query.substr(0,ee[1].length),t=s(b))}if(t.length<=n||(b.host&&(b.host=b.host.replace(/^www\./,""),t=s(b)),t.length<=n))return t;var de="";if(b.host&&(de+=b.host),de.length>=h)return b.host.length==n?(b.host.substr(0,n-r)+e).substr(0,h+i):a(de,h).substr(0,h+i);var _e="";if(b.path&&(_e+="/"+b.path),b.query&&(_e+="?"+b.query),_e){if((de+_e).length>=h)return(de+_e).length==n?(de+_e).substr(0,n):(de+a(_e,h-de.length)).substr(0,h+i);de+=_e}if(b.fragment){var Se="#"+b.fragment;if((de+Se).length>=h)return(de+Se).length==n?(de+Se).substr(0,n):(de+a(Se,h-de.length)).substr(0,h+i);de+=Se}if(b.scheme&&b.host){var Ne=b.scheme+"://";if((de+Ne).length<h)return(Ne+de).substr(0,n)}if(de.length<=n)return de;var je="";return h>0&&(je=de.substr(-1*Math.floor(h/2))),(de.substr(0,Math.ceil(h/2))+e+je).substr(0,h+i)}(n,i):"middle"===r?function nj(t,n,e){if(t.length<=n)return t;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var o=n-r,s="";return o>0&&(s=t.substr(-1*Math.floor(o/2))),(t.substr(0,Math.ceil(o/2))+e+s).substr(0,o+i)}(n,i):function ij(t,n,e){return function J7(t,n,e){var i;return t.length>n&&(null==e?(e="&hellip;",i=3):i=e.length,t=t.substring(0,n-i)+e),t}(t,n,e)}(n,i)},t}(),Ru=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}(),oS=function(t){function n(e){var i=t.call(this,e)||this;return i.email="",i.email=e.email,i}return Me(n,t),n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(Ru),sS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return Me(n,t),n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(Ru),aS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return Me(n,t),n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var e=t.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},n}(Ru),lS=function(t){function n(e){var i=t.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return Me(n,t),n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(Ru),cS=function(t){function n(e){var i=t.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Me(n,t),n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},n.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},n.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},n.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch{return i}},n}(Ru),Lu=function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder},$v=/[A-Za-z]/,rj=/[\d]/,oj=/[\D]/,$c=/\s/,vv=/['"]/,sj=/[\x00-\x1F\x7F]/,uS=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,dS=uS+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,vg=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,cj=dS+vg,Li=dS+vg,Ff=new RegExp("[".concat(Li,"]")),uj="(?:["+vg+"]{1,3}\\.){3}["+vg+"]{1,3}",dj="["+Li+"](?:["+Li+"\\-_]{0,61}["+Li+"])?",fS=function(t){return"(?=("+dj+"))\\"+t},bv=function(t){return"(?:"+fS(t)+"(?:\\."+fS(t+1)+"){0,126}|"+uj+")"},bg=(new RegExp("["+Li+".\\-]*["+Li+"\\-]"),Ff),hS=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,fj=new RegExp("[".concat(Li,"!#$%&'*+/=?^_`{|}~-]")),hj=new RegExp("^".concat(hS.source,"$")),pS=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.localPartCharRegex=fj,e.strictTldRegex=hj,e}return Me(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,o=this.strictTldRegex,s=[],a=e.length,h=new yg,b={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},ee=0,de=0,_e=h;ee<a;){var Ce=e.charAt(ee);switch(de){case 0:"m"===(ot=Ce)?Xe(1):r.test(ot)&&Xe();break;case 1:Pe(e.charAt(ee-1),Ce);break;case 2:Ne(Ce);break;case 3:je(Ce);break;case 4:He(Ce);break;case 5:Ue(Ce);break;case 6:We(Ce);break;case 7:mt(Ce);break;default:mv(de)}ee++}var ot;return It(),s;function Pe(ot,_t){":"===ot?r.test(_t)?(de=2,_e=new yg(ce(ce({},_e),{hasMailtoPrefix:!0}))):ct():b[ot]===_t||(r.test(_t)?de=2:"."===_t?de=3:"@"===_t?de=4:ct())}function Ne(ot){"."===ot?de=3:"@"===ot?de=4:r.test(ot)||ct()}function je(ot){"."===ot||"@"===ot?ct():r.test(ot)?de=2:ct()}function He(ot){bg.test(ot)?de=5:ct()}function Ue(ot){"."===ot?de=7:"-"===ot?de=6:bg.test(ot)||It()}function We(ot){"-"===ot||"."===ot?It():bg.test(ot)?de=5:It()}function mt(ot){"."===ot||"-"===ot?It():bg.test(ot)?(de=5,_e=new yg(ce(ce({},_e),{hasDomainDot:!0}))):It()}function Xe(ot){void 0===ot&&(ot=2),de=ot,_e=new yg({idx:ee})}function ct(){de=0,_e=h}function It(){if(_e.hasDomainDot){var ot=e.slice(_e.idx,ee);/[-.]$/.test(ot)&&(ot=ot.slice(0,-1));var _t=_e.hasMailtoPrefix?ot.slice(7):ot;(function Ct(xt){var on=(xt.split(".").pop()||"").toLowerCase();return o.test(on)})(_t)&&s.push(new oS({tagBuilder:i,matchedText:ot,offset:_e.idx,email:_t}))}ct()}},n}(Lu),yg=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot},pj=function(){function t(){}return t.isValid=function(n,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(n,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,e)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==n.match(e)},t.containsMultipleDots=function(n){var e=n;return this.hasFullProtocolRegex.test(n)&&(e=n.split("://")[1]),e.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var e=n.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},t.urlMatchDoesNotHaveProtocolOrDot=function(n,e){return!(!n||e&&this.hasFullProtocolRegex.test(e)||-1!==n.indexOf("."))},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,e){return!(!n||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(n))},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+uS+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}(),gj=(e=new RegExp("[/?#](?:["+Li+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Li+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,bv(2),")","|","(","(//)?",/(?:www\.)/.source,bv(6),")","|","(","(//)?",bv(10)+"\\.",hS.source,"(?![-"+cj+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),mj=new RegExp("["+Li+"]"),gS=function(t){function n(e){var i=t.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=gj,i.wordCharRegExp=mj,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return Me(n,t),n.prototype.parseMatches=function(e){for(var b,i=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,s=this.decodePercentEncoding,a=this.tagBuilder,h=[],ee=function(){var _e=b[0],Ce=b[1],Se=b[4],je=b.index,He=b[5]||b[9],Ue=e.charAt(je-1);if(!pj.isValid(_e,Ce)||je>0&&"@"===Ue||je>0&&He&&de.wordCharRegExp.test(Ue))return"continue";if(/\?$/.test(_e)&&(_e=_e.substr(0,_e.length-1)),de.matchHasUnbalancedClosingParen(_e))_e=_e.substr(0,_e.length-1);else{var We=de.matchHasInvalidCharAfterTld(_e,Ce);We>-1&&(_e=_e.substr(0,We))}var mt=["http://","https://"].find(function(ot){return!!Ce&&-1!==Ce.indexOf(ot)});if(mt){var Xe=_e.indexOf(mt);_e=_e.substr(Xe),Ce=Ce.substr(Xe),je+=Xe}h.push(new cS({tagBuilder:a,matchedText:_e,offset:je,urlMatchType:Ce?"scheme":Se?"www":"tld",url:_e,protocolUrlMatch:!!Ce,protocolRelativeMatch:!!He,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:s}))},de=this;null!==(b=i.exec(e));)ee();return h},n.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var o=0,s=0,a=e.length-1;s<a;s++){var h=e.charAt(s);h===r?o++:h===i&&(o=Math.max(o-1,0))}return 0===o},n.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var s=new RegExp("^((.?//)?[-."+Li+"]*[-"+Li+"]\\.[-"+Li+"]+)").exec(e);return null===s?-1:(r+=s[1].length,e=e.slice(s[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},n}(Lu),mS=new RegExp("[_".concat(Li,"]")),_S=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.serviceName=e.serviceName,i}return Me(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.serviceName,o=[],s=e.length,a=0,h=-1,b=0;a<s;){var ee=e.charAt(a);switch(b){case 0:"#"===(Ne=ee)?(b=2,h=a):Ff.test(Ne)&&(b=1);break;case 1:_e(ee);break;case 2:Ce(ee);break;case 3:Se(ee);break;default:mv(b)}a++}var Ne;return Pe(),o;function _e(Ne){Ff.test(Ne)||(b=0)}function Ce(Ne){b=mS.test(Ne)?3:Ff.test(Ne)?1:0}function Se(Ne){mS.test(Ne)||(Pe(),h=-1,b=Ff.test(Ne)?1:0)}function Pe(){if(h>-1&&a-h<=140){var Ne=e.slice(h,a),je=new sS({tagBuilder:i,matchedText:Ne,offset:h,serviceName:r,hashtag:Ne.slice(1)});o.push(je)}}},n}(Lu),_j=["twitter","facebook","instagram","tiktok"],bj=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),$S=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.matcherRegex=bj,e}return Me(n,t),n.prototype.parseMatches=function(e){for(var s,i=this.matcherRegex,r=this.tagBuilder,o=[];null!==(s=i.exec(e));){var a=s[0],h=a.replace(/[^0-9,;#]/g,""),b=!(!s[1]&&!s[2]),ee=0==s.index?"":e.substr(s.index-1,1),de=e.substr(s.index+a.length,1),_e=!ee.match(/\d/)&&!de.match(/\d/);this.testMatch(s[3])&&this.testMatch(a)&&_e&&o.push(new lS({tagBuilder:r,matchedText:a,offset:s.index,number:h,plusSign:b}))}return o},n.prototype.testMatch=function(e){return oj.test(e)},n}(Lu),yj=new RegExp("@[_".concat(Li,"]{1,50}(?![_").concat(Li,"])"),"g"),Cj=new RegExp("@[_.".concat(Li,"]{1,30}(?![_").concat(Li,"])"),"g"),xj=new RegExp("@[-_.".concat(Li,"]{1,50}(?![-_").concat(Li,"])"),"g"),wj=new RegExp("@[_.".concat(Li,"]{1,23}[_").concat(Li,"](?![_").concat(Li,"])"),"g"),Ej=new RegExp("[^"+Li+"]"),vS=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:yj,instagram:Cj,soundcloud:xj,tiktok:wj},i.nonWordCharRegex=Ej,i.serviceName=e.serviceName,i}return Me(n,t),n.prototype.parseMatches=function(e){var h,i=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,s=this.tagBuilder,a=[];if(!r)return a;for(;null!==(h=r.exec(e));){var b=h.index,ee=e.charAt(b-1);if(0===b||o.test(ee)){var de=h[0].replace(/\.+$/g,""),_e=de.slice(1);a.push(new aS({tagBuilder:s,matchedText:de,offset:b,serviceName:i,mention:_e}))}}return a},n}(Lu);var oa=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing},Sj=function(){function t(n){void 0===n&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email="boolean"==typeof n.email?n.email:this.email,this.phone="boolean"==typeof n.phone?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow="boolean"==typeof n.newWindow?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash="boolean"==typeof n.stripTrailingSlash?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof n.decodePercentEncoding?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===_j.indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,e){return new t(e).link(n)},t.parse=function(n,e){return new t(e).parse(n)},t.prototype.normalizeUrlsCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:"boolean"!=typeof n.schemeMatches||n.schemeMatches,wwwMatches:"boolean"!=typeof n.wwwMatches||n.wwwMatches,tldMatches:"boolean"!=typeof n.tldMatches||n.tldMatches}},t.prototype.normalizeStripPrefixCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{scheme:n,www:n}:{scheme:"boolean"!=typeof n.scheme||n.scheme,www:"boolean"!=typeof n.www||n.www}},t.prototype.normalizeTruncateCfg=function(n){return"number"==typeof n?{length:n,location:"end"}:function Q7(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0===t[e]&&(t[e]=n[e]);return t}(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var e=this,i=["a","style","script"],r=0,o=[];return function Tj(t,n){for(var e=n.onOpenTag,i=n.onCloseTag,r=n.onText,o=n.onComment,s=n.onDoctype,a=new oa,h=0,b=t.length,ee=0,de=0,_e=a;h<b;){var Ce=t.charAt(h);switch(ee){case 0:"<"===Ce&&ln();break;case 1:"!"===(Nt=Ce)?ee=13:"/"===Nt?(ee=2,_e=new oa(ce(ce({},_e),{isClosing:!0}))):"<"===Nt?ln():$v.test(Nt)?(ee=3,_e=new oa(ce(ce({},_e),{isOpening:!0}))):(ee=0,_e=a);break;case 2:je(Ce);break;case 3:Ne(Ce);break;case 4:He(Ce);break;case 5:Ue(Ce);break;case 6:We(Ce);break;case 7:mt(Ce);break;case 8:Xe(Ce);break;case 9:ct(Ce);break;case 10:It(Ce);break;case 11:ot(Ce);break;case 12:_t(Ce);break;case 13:"--"===t.substr(h,2)?(h+=2,_e=new oa(ce(ce({},_e),{type:"comment"})),ee=14):"DOCTYPE"===t.substr(h,7).toUpperCase()?(h+=7,_e=new oa(ce(ce({},_e),{type:"doctype"})),ee=20):Ht();break;case 14:xt(Ce);break;case 15:Gt(Ce);break;case 16:on(Ce);break;case 17:gn(Ce);break;case 18:Tt(Ce);break;case 19:Pt(Ce);break;case 20:Ut(Ce);break;default:mv(ee)}h++}var Nt;function Ne(Nt){$c.test(Nt)?(_e=new oa(ce(ce({},_e),{name:Di()})),ee=4):"<"===Nt?ln():"/"===Nt?(_e=new oa(ce(ce({},_e),{name:Di()})),ee=12):">"===Nt?(_e=new oa(ce(ce({},_e),{name:Di()})),ti()):!$v.test(Nt)&&!rj.test(Nt)&&":"!==Nt&&Ht()}function je(Nt){">"===Nt?Ht():$v.test(Nt)?ee=3:Ht()}function He(Nt){$c.test(Nt)||("/"===Nt?ee=12:">"===Nt?ti():"<"===Nt?ln():"="===Nt||vv.test(Nt)||sj.test(Nt)?Ht():ee=5)}function Ue(Nt){$c.test(Nt)?ee=6:"/"===Nt?ee=12:"="===Nt?ee=7:">"===Nt?ti():"<"===Nt?ln():vv.test(Nt)&&Ht()}function We(Nt){$c.test(Nt)||("/"===Nt?ee=12:"="===Nt?ee=7:">"===Nt?ti():"<"===Nt?ln():vv.test(Nt)?Ht():ee=5)}function mt(Nt){$c.test(Nt)||('"'===Nt?ee=8:"'"===Nt?ee=9:/[>=`]/.test(Nt)?Ht():"<"===Nt?ln():ee=10)}function Xe(Nt){'"'===Nt&&(ee=11)}function ct(Nt){"'"===Nt&&(ee=11)}function It(Nt){$c.test(Nt)?ee=4:">"===Nt?ti():"<"===Nt&&ln()}function ot(Nt){$c.test(Nt)?ee=4:"/"===Nt?ee=12:">"===Nt?ti():"<"===Nt?ln():(ee=4,function qn(){h--}())}function _t(Nt){">"===Nt?(_e=new oa(ce(ce({},_e),{isClosing:!0})),ti()):ee=4}function xt(Nt){"-"===Nt?ee=15:">"===Nt?Ht():ee=16}function Gt(Nt){"-"===Nt?ee=18:">"===Nt?Ht():ee=16}function on(Nt){"-"===Nt&&(ee=17)}function gn(Nt){ee="-"===Nt?18:16}function Tt(Nt){">"===Nt?ti():"!"===Nt?ee=19:"-"===Nt||(ee=16)}function Pt(Nt){"-"===Nt?ee=17:">"===Nt?ti():ee=16}function Ut(Nt){">"===Nt?ti():"<"===Nt&&ln()}function Ht(){ee=0,_e=a}function ln(){ee=1,_e=new oa({idx:h})}function ti(){var Nt=t.slice(de,_e.idx);Nt&&r(Nt,de),"comment"===_e.type?o(_e.idx):"doctype"===_e.type?s(_e.idx):(_e.isOpening&&e(_e.name,_e.idx),_e.isClosing&&i(_e.name,_e.idx)),Ht(),de=h+1}function Di(){return t.slice(_e.idx+(_e.isClosing?2:1),h).toLowerCase()}de<h&&function si(){var Nt=t.slice(de,h);r(Nt,de),de=h+1}()}(n,{onOpenTag:function(s){i.indexOf(s)>=0&&r++},onText:function(s,a){if(0===r){var b=function ej(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=n.exec(t);)e.push(t.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(t.substring(i)),e}(s,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),ee=a;b.forEach(function(de,_e){if(_e%2==0){var Ce=e.parseText(de,ee);o.push.apply(o,Ce)}ee+=de.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(r=Math.max(r-1,0))},onComment:function(s){},onDoctype:function(s){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},t.prototype.compactMatches=function(n){n.sort(function(h,b){return h.getOffset()-b.getOffset()});for(var e=0;e<n.length-1;){var i=n[e],r=i.getOffset(),o=i.getMatchedText().length,s=r+o;if(e+1<n.length){if(n[e+1].getOffset()===r){var a=n[e+1].getMatchedText().length>o?e:e+1;n.splice(a,1);continue}if(n[e+1].getOffset()<s){n.splice(e+1,1);continue}}e++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||_c(n,function(e){return"hashtag"===e.getType()}),this.email||_c(n,function(e){return"email"===e.getType()}),this.phone||_c(n,function(e){return"phone"===e.getType()}),this.mention||_c(n,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||_c(n,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||_c(n,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||_c(n,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),n},t.prototype.parseText=function(n,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],o=0,s=i.length;o<s;o++){for(var a=i[o].parseMatches(n),h=0,b=a.length;h<b;h++)a[h].setOffset(e+a[h].getOffset());r.push.apply(r,a)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(n),i=[],r=0,o=0,s=e.length;o<s;o++){var a=e[o];i.push(n.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(n.substring(r)),i.join("")},t.prototype.createMatchReturnVal=function(n){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,n)),"string"==typeof e?e:!1===e?n.getMatchedText():e instanceof _v?e.toAnchorString():n.buildTag().toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),e=[new _S({tagBuilder:n,serviceName:this.hashtag}),new pS({tagBuilder:n}),new $S({tagBuilder:n}),new vS({tagBuilder:n,serviceName:this.mention}),new gS({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new rS({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version="3.16.2",t.AnchorTagBuilder=rS,t.HtmlTag=_v,t.matcher={Email:pS,Hashtag:_S,Matcher:Lu,Mention:vS,Phone:$S,Url:gS},t.match={Email:oS,Hashtag:sS,Match:Ru,Mention:aS,Phone:lS,Url:cS},t}();const bS=Sj,yv=bS;let Wn=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let o;r||(r=t.defaultParentViewContainerRef),o=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector});let s=o.instance.content.createComponent(e);const a=o.injector.get(t);return a.panelComponentRef=o,i&&(i.title&&(a.title=i.title),i.top&&(a.top=i.top),i.left&&(a.left=i.left),i.width&&(a.width=i.width),i.height&&(a.height=i.height)),o.onDestroy(()=>{a.panelComponentRef=null}),s.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class Ij{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Yn=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let o;return r||(r=t.defaultParentViewContainerRef),new Promise((s,a)=>{const ee=new t;ee.modalContext=new Ij(_e=>{o&&(o.destroy(),s(_e),this.count--)},_e=>{o&&(o.destroy(),a(_e),this.count--)},i);const de=ws.create({providers:[{provide:t,useValue:ee}],parent:r.injector});o=r.createComponent(t.ModalComponentClass,{index:r.length,injector:de}),o.instance.content.createComponent(e),o.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();const Mj=function(t){return{outer:t}};function kj(t,n){if(1&t&&(Z(0,"div",5),$e(1),Z(2,"span",6),$e(3),ne(),$e(4),Z(5,"span",7),$e(6),ne()()),2&t){const e=ge();V(1),Zn("",e.urlObj.protocol,"//"),V(1),ie("ngClass",wt(6,Mj,e.isOuter)),V(1),dt(e.urlObj.host),V(1),dt(e.urlObj.pathname),V(2),Ja("",e.urlObj.search,"",e.urlObj.hash,"")}}function Dj(t,n){if(1&t&&(Z(0,"div",5),$e(1),ne()),2&t){const e=ge();V(1),dt(e.url)}}function Aj(t,n){1&t&&(Z(0,"div"),$e(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),ne())}function Pj(t,n){1&t&&(Z(0,"div"),$e(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),ne())}let co=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return tt.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Ve.register(this)}ngOnDestroy(){Ve.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(Z(0,"div"),Te(1,kj,7,8,"div",0),Te(2,Dj,2,1,"div",0),vt(3,"hr"),Z(4,"div",1),Te(5,Aj,2,0,"div",2),Te(6,Pj,2,0,"div",2),ne()(),Z(7,"button",3),Ae("click",function(){return i.openUrl()}),$e(8,"\u958b\u304f"),ne(),Z(9,"button",4),Ae("click",function(){return i.cancel()}),$e(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ne()),2&e&&(V(1),ie("ngIf",i.isValid),V(1),ie("ngIf",!i.isValid),V(3),ie("ngIf",i.isValid),V(1),ie("ngIf",!i.isValid),V(1),ie("disabled",!i.isValid))},dependencies:[oi,Rn],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),t})();const Nj=["message"];function Oj(t,n){if(1&t&&(Z(0,"span")(1,"pre",1),$e(2),ne()()),2&t){const e=ge();V(2),dt(e.text)}}function Fj(t,n){1&t&&vt(0,"hr")}function Rj(t,n){if(1&t){const e=gt();Z(0,"pre",1)(1,"span",3,4),Ae("click",function(r){return Fe(e),Re(ge(2).onLinkClick(r))}),zt(3,"safe"),ne(),Te(4,Fj,1,0,"hr",0),ne()}if(2&t){const e=n.$implicit,i=n.last,r=ge(2);V(1),ie("innerHTML",jt(3,2,r.htmlEscapeLinking(e),"html"),cr),V(3),ie("ngIf",!i)}}function Lj(t,n){if(1&t&&(Z(0,"span"),Te(1,Rj,5,5,"pre",2),ne()),2&t){const e=ge();V(1),ie("ngForOf",e.text)}}let vc=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.stringUtil=tt}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return yv.link(tt.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&tt.validUrl(r.getAnchorHref())){if(tt.sameOrigin(r.getAnchorHref()))return!0;{const o=r.buildTag();return o.setAttr("rel","nofollow"),o.addClass("outer-link"),o}}return!1}})}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!tt.sameOrigin(i))return e.preventDefault(),this.modalService.open(co,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["text-view"]],viewQuery:function(e,i){if(1&e&&Tn(Nj,5),2&e){let r;En(r=Sn())&&(i.messageElm=r.first)}},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML","click"],["message",""]],template:function(e,i){1&e&&(Te(0,Oj,3,1,"span",0),Te(1,Lj,2,1,"span",0)),2&e&&(ie("ngIf",!i.isObj(i.text)),V(1),ie("ngIf",i.isObj(i.text)))},dependencies:[$i,Rn,_i],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})();var Bu;let at=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t.puyon="",t.surprise="",t.coinToss="",t})(),St=Bu=class extends gl{onStoreAdded(){super.onStoreAdded(),Ve.register(this).on("SOUND_EFFECT",n=>{st.playSoundEffect(Jt.instance.get(n.data))}).on("SEND_MESSAGE",n=>{let e=Et.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?Bu.play(at.diceRoll1):Bu.play(at.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Ve.unregister(this)}play(n){Bu.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,Bu._play(e)}static _play(n){Ve.call("SOUND_EFFECT",n)}};var Rf;St=Bu=ve([mi("sound-effect")],St);let Vn=Rf=class extends ii{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=tt.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(n,e=!0){if("string"==typeof n&&(n=n.trim().split(/\s+/)),0==n.length)return!1;if(n=n.concat(),e){for(const i of n)if(` ${this.tag} `.indexOf(` ${tt.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of n)if(` ${this.tag} `.indexOf(` ${tt.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>tt.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),Ve.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>tt.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(tt.toHalfWidth(i).toLowerCase())).sort().join(" "),Ve.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(n){return Et.instance.get(`imagetag_${n}`)}static create(n){const e=new Rf(`imagetag_${n}`);return e.imageIdentifier=n,e.initialize(),e}parseInnerXml(n){let e=Rf.get(this.imageIdentifier);e||(e=Rf.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var bc;ve([yt()],Vn.prototype,"imageIdentifier",void 0),ve([yt()],Vn.prototype,"tag",void 0),ve([yt()],Vn.prototype,"hide",void 0),Vn=Rf=ve([mi("image-tag")],Vn);let Hr=bc=class extends ii{constructor(){super(...arguments),this.identifiers=[]}static searchImages(n,e,i,r){"string"==typeof n&&(n=n.trim().split(/\s+/));const o=bc.allImagesOwnWords(r);return n=n.filter(a=>o.includes(a)),this.allImages(r).filter(a=>{const h=Vn.get(a.identifier);return e&&(i||0===n.length)&&(!h||null==h.tag||""===h.tag.trim())||(!e||i)&&h&&h.containsWords(n,i)})}static allImages(n){return Kt.instance.images.filter(i=>{if(n)return!0;const r=Vn.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(n){return bc.imagesOwnWords(this.allImages(n))}static imagesOwnWords(n,e=!1){if(e){if(0===n.length)return[];const i=n.map(o=>Vn.get(o.identifier));if(!i[0])return[];let r=i[0].words;for(let o=1;o<i.length;o++){if(!i[o])return[];if(r=r.filter(s=>i[o].words.includes(s)),0===r.length)return r}return r.sort()}{const i=[];for(const r of n){const o=Vn.get(r.identifier);o&&i.push(...o.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(n,e){let i=0;if(null!=n&&""===n.trim())return i;for(const r of bc.allImages(e)){const o=Vn.get(r.identifier);null==n?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(n.trim(),!1)&&i++}return i}static imagesIsHidden(n){for(const e of n){const i=Vn.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(n,e){const i=n.map(r=>{const o=Vn.get(r.identifier);return{image:r,tag:o&&null!=o.tag?o.tag:""}});return i.sort((r,o)=>{let s=0;return e.some(a=>(s=bc._sortByWordCriteria(r,o,a),!!s)),s}),i.map(r=>r.image)}static _sortByWordCriteria(n,e,i){if(null==i)return""==n.tag&&""==e.tag?0:""==n.tag?-1:""==e.tag?1:0;const r=` ${n.tag} `.indexOf(` ${i} `),o=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==o?0:r>=0&&-1==o?-1:-1==r&&o>=0?1:0}onStoreAdded(){super.onStoreAdded(),Et.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(n=>Vn.get(n)).filter(n=>n).map(n=>n.toXml()).join("")}static create(n){const e=new bc;return e.identifiers=n.map(i=>i.identifier),e}};Hr=bc=ve([mi("image-tag-list")],Hr);var yc,yS=me(4327),CS=me(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(yc||(yc={}));class sa{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return sa._instance||(sa._instance=new sa),sa._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,hn.Z)(function*(){if(!n)return;let i=n instanceof FileList?wS(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Ve.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,hn.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Kt.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,hn.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Jt.instance.addAsync(n)}})()}handleText(n){return(0,hn.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=Fa.xml2element(yield Ps.readAsTextAsync(n));e&&Ve.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,hn.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new CS;try{i=yield i.loadAsync(n)}catch(o){return void console.warn(o)}let r=[];i.forEach((o,s)=>r.push(s));for(let o of r)try{let s=yield o.async("arraybuffer");console.log(o.name+" \u89e3\u51cd..."),yield e.load([new File([s],o.name,{type:yc.type(o.name)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i){return(0,hn.Z)(function*(){if(!n)return;let r=n instanceof FileList?wS(n):n,o=new CS;for(let a of r)o.file(a.name,a);let s=yield o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,yS.saveAs)(s,e+".zip")})()}}function wS(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}function Bj(t,n){if(1&t&&(Z(0,"i",6),$e(1),ne()),2&t){const e=ge();V(1),dt(e.materialIcon)}}function zj(t,n){if(1&t&&(Z(0,"div",7),$e(1),ne()),2&t){const e=ge();V(1),dt(e.help)}}function jj(t,n){1&t&&(vt(0,"div",8),zt(1,"safe")),2&t&&ie("innerHTML",jt(1,1,ge().helpHtml,"html"),cr)}function Uj(t,n){if(1&t){const e=gt();Z(0,"button",9),Ae("click",function(){return Fe(e),Re(ge().cancel())}),$e(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),ne()}}let gr=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=Bi.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:Bi.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Ve.register(this)}ngOnDestroy(){Ve.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(e,i){1&e&&(Z(0,"div",0),Te(1,Bj,2,1,"i",1),$e(2),ne(),vt(3,"hr"),Te(4,zj,2,1,"div",2),Te(5,jj,2,4,"div",3),Z(6,"button",4),Ae("click",function(){return i.ok()}),$e(7,"\uff2f\uff2b"),ne(),Te(8,Uj,2,0,"button",5)),2&e&&(V(1),ie("ngIf",i.materialIcon),V(1),dt(i.text),V(2),ie("ngIf",i.help&&!i.helpHtml),V(1),ie("ngIf",i.helpHtml),V(3),ie("ngIf",i.type>1))},dependencies:[Rn,_i],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]}),t})();var Cv,Bi=(()=>(function(t){t[t.OK=1]="OK",t[t.OK_CANCEL=2]="OK_CANCEL"}(Bi||(Bi={})),Bi))();let di=Cv=class extends ii{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this.isAnimated=!1,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(n){this.value=n??""}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return Kt.instance.get(this.imageIdentifier)}get toImage(){return Kt.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===Lt.peerContext.userId||this.originFrom===Lt.peerContext.userId||-1<this.tags.indexOf("mine")}get isRelatedToMe(){return-1<this.sendTo.indexOf(Lt.peerContext.userId)||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===Lt.peerContext.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!Je.myCursor&&Je.myCursor.isGMMode}plainText(){if(this.isSecret&&!this.isSendFromSelf)return"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let n=tt.rubyToText(this.text);return this.isDicebot&&(n=n.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),n}logFragment(n,e=null,i="HH:mm",r=!0){return 0==n?this.logFragmentText(e,i):this.logFragmentHtml(e,i,2!=n)}logFragmentText(n=null,e="HH:mm"){n=n&&""!=n.trim()?`[${n}] `:"";const i=""==e?"":Zd(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${Zd(new Date(this.lastUpdate),e,this.locale)})`:"";let o=tt.rubyToText(this.text);return this.isDicebot&&(o=o.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),o.lastIndexOf("\n")==o.length-1&&!r&&(o+="\n"),`${n}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":o+r}`}logFragmentHtml(n=null,e="HH:mm",i=!0){const r=tt.escapeHtml(this.color?this.color:Je.CHAT_DEFAULT_COLOR),o=` style="color: ${r}"`,s=this.toColor?tt.escapeHtml(this.toColor):"",a=this.toColor?` style="color: ${s}"`:"",h=this.isDirect||this.isSecret?' class="grow"':"",b=n&&""!=n.trim()?`<span class="tab-name">${tt.escapeHtml(n)}</span> `:"",ee=new Date(this.timestamp),de=""==e?"":`<time datetime="${ee.toISOString()}">${tt.escapeHtml(Zd(ee,e,this.locale))}</time>\uff1a`,_e=`<span${h}${o}>${tt.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 <span${h}${a}>${tt.escapeHtml(this.toName)}</span>`:"");let Ce=["message"];(this.isDirect||this.isSecret)&&Ce.push("direct-message"),this.isSystem&&Ce.push("system-message"),(this.isDicebot||this.isCalculate)&&Ce.push("dicebot-message"),this.isOperationLog&&Ce.push("operation-log");let Se=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&Se.push("is-success"),this.isFailure&&Se.push("is-failure"),this.isCritical&&Se.push("is-critical"),this.isFumble&&Se.push("is-fumble"));let Pe=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":bS.link(this.isOperationLog?tt.escapeHtml(this.text):tt.rubyToHtml(tt.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(je){return"url"==je.getType()&&tt.validUrl(je.getAnchorHref())}});this.isDicebot&&(Pe=Cv.decorationDiceResult(Pe));let Ne="";if(this.isEdited)if(""==e)Ne='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const je=new Date(this.lastUpdate);Ne=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${je.toISOString()}">${tt.escapeHtml(Zd(je,e,this.locale))}</time></span>`}return Pe.lastIndexOf("\n")==Pe.length-1&&!Ne&&(Pe+="\n"),`<div class="${Ce.join(" ")}" style="border-left-color: ${r}">\n  <div class="msg-header">${b}${de}<span class="msg-name">${_e}</span>\uff1a</div>\n  <div class="${Se.join(" ")}"><span${this.isSpecialColor?"":o}>${Pe}</span>${Ne}</div>\n</div>`}static logCss(n=!0){return"body {\n  color: #444;\n  background-color: #FFF;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #ffffff,\n       0px  1px 1px #ffffff,\n      -1px  0px 1px #ffffff,\n       0px -1px 1px #ffffff; \n}"}static decorationDiceResult(n){return n.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};ve([yt()],di.prototype,"originFrom",void 0),ve([yt()],di.prototype,"from",void 0),ve([yt()],di.prototype,"to",void 0),ve([yt()],di.prototype,"name",void 0),ve([yt()],di.prototype,"toName",void 0),ve([yt()],di.prototype,"tag",void 0),ve([yt()],di.prototype,"dicebot",void 0),ve([yt()],di.prototype,"imageIdentifier",void 0),ve([yt()],di.prototype,"toImageIdentifier",void 0),ve([yt()],di.prototype,"color",void 0),ve([yt()],di.prototype,"toColor",void 0),ve([yt()],di.prototype,"isInverseIcon",void 0),ve([yt()],di.prototype,"isHollowIcon",void 0),ve([yt()],di.prototype,"isBlackPaint",void 0),ve([yt()],di.prototype,"aura",void 0),ve([yt()],di.prototype,"characterIdentifier",void 0),ve([yt()],di.prototype,"standIdentifier",void 0),ve([yt()],di.prototype,"standName",void 0),ve([yt()],di.prototype,"isUseStandImage",void 0),ve([yt()],di.prototype,"lastUpdate",void 0),di=Cv=ve([mi("chat")],di);let yl=class extends ii{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof di&&n.isDisplayable&&(this._unreadLength++,Ve.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}),!n.isSendFromSelf&&!n.isOperationLog&&!n.isSystem&&Ve.trigger("MESSAGE_NORTIFICATION",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new di;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),Ve.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof di&&!e.isDisplayable||(n+=gi.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}log(n,e,i=!0){const r=this.chatMessages.filter(o=>o.isDisplayable&&(i||!o.isOperationLog)).sort((o,s)=>o.index-s.index).map(o=>o.logFragment(n,null,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${tt.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${di.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};var us;ve([yt()],yl.prototype,"name",void 0),ve([yt()],yl.prototype,"isUseStandImage",void 0),ve([yt()],yl.prototype,"recieveOperationLogLevel",void 0),yl=ve([mi("chat-tab")],yl);let Fs=us=class extends ii{static get instance(){return us._instance||(us._instance=new us("ChatTabList"),us._instance.initialize()),us._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof yl)e=n[0];else{let i=n[0];e=new yl(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of us.instance.children)i.destroy();let e=us.instance.toContext();e.syncData=this.toContext().syncData,us.instance.apply(e),us.instance.update(),super.parseInnerXml.apply(us.instance,[n]),this.destroy()}log(n,e,i=!0){if(!this.chatTabs)return"";const r=this.chatTabs.reduce((o,s)=>(s&&o.push(...s.chatMessages.filter(a=>a.isDisplayable&&(i||!a.isOperationLog)).map(a=>({index:a.index,tabName:s.name,chatMessage:a}))),o),[]).sort((o,s)=>o.index-s.index).map(o=>o.chatMessage.logFragment(n,o.tabName,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u3066\u306e\u30bf\u30d6</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${di.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};Fs=us=ve([mi("chat-tab-list")],Fs);class Cc{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Cc(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Cc(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Ve.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Ve.unregister(this),this.sendChankTimer&&function YL(t){gf.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=Ho.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Ve.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),Ur(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);Ve.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),Ur(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=Ur(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Ve.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Ve.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=Ho.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Oa(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class zu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return zu._instance||(zu._instance=new zu),zu._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Ve.register(this).on("CONNECT_PEER",-1,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),Jt.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=Jt.instance.get(o.identifier);null===s&&(s=Vo.createEmpty(o.identifier),Jt.instance.add(s)),s.state<Dr.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<Jt.instance.getCatalog().length&&Jt.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=Jt.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=Jt.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(Lt.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void Ve.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),Jt.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=Jt.instance.get(e);this.receiveTaskMap.has(e)||i&&Dr.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Ve.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){Ve.unregister(this)}startSendTask(n,e){var i=this;return(0,hn.Z)(function*(){let r=Cc.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),Ve.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===Dr.URL?o.url=n.url:(o.blob=yield Ps.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),Jt.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=Jt.instance.get(n),i=Cc.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&Ve.trigger("UPDATE_AUDIO_RESOURE",[o]),Jt.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=Lt.peerIds;i.splice(i.indexOf(Lt.peerId),1),Ve.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:Lt.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class ju{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return ju._instance||(ju._instance=new ju),ju._instance}initialize(){var n=this;Ve.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Kt.instance.synchronize())}).on("XML_LOADED",e=>{!function Hj(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!Kt.instance.get(r)&&0<yc.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!Kt.instance.get(r)&&0<yc.type(r).length&&n.push(r)}for(let i of n)Kt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=Kt.instance.get(o.identifier);null===s&&(s=sn.createEmpty(o.identifier),Kt.instance.add(s)),s.state<Pi.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<Kt.instance.getCatalog().length&&Kt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,hn.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=Kt.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(Lt.peerId);-1<a&&s.splice(a,1);for(let h of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+h+" -> "+i.data.identifiers),void Ve.call(i,h);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Kt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=Kt.instance.get(i);this.receiveTaskMap.has(i)||r&&Pi.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Ve.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Ve.unregister(this)}startSendTask(n,e){var i=this;return(0,hn.Z)(function*(){let r=1===n.length?n[0].identifier:yo.generateUuid(),o=Cc.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),Ve.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield Ps.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield Ps.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),Kt.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=Cc.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Ve.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),Kt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=Lt.peerIds;i.splice(i.indexOf(Lt.peerId),1),Ve.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:Lt.peerId,candidatePeers:i},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=Kt.instance.get(s.identifier),h={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Pi.URL?h.url=a.url:s.state===Pi.NULL?(h.thumbnail.blob=a.thumbnail.blob,h.thumbnail.type=a.thumbnail.type):(h.blob=a.blob,h.type=a.blob.type);let b=h.blob?h.blob.size:h.thumbnail.blob?h.thumbnail.blob.size:100;if(i.push(h),r+=b,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Qi{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Qi.tasksMap.size<1&&Ve.register(Qi.key).on("DISCONNECT_PEER",r=>{Qi.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Qi.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Qi.onUpdate(r.data.identifier)});let i=new Qi(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Qi.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Qi.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Ve.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Qi.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Qi.tasksMap.size<1&&Ve.unregister(Qi.key)}static onUpdate(n){if(!Qi.tasksMap.has(n))return;let e=Qi.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Qi.tasksMap.size<1&&Ve.unregister(Qi.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Qi.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Qi.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new Oa(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}Qi.key={},Qi.tasksMap=new Map;class Uu{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return Uu._instance||(Uu._instance=new Uu),Uu._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Ve.register(this).on("CONNECT_PEER",2,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)Et.instance.isDeleted(i.identifier)?Ve.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(Et.instance.isDeleted(n.data))Ve.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=Et.instance.get(n.data);e&&Ve.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=Et.instance.get(e.identifier);i?n.isSendFromSelf||this.updateObject(i,e):Et.instance.isDeleted(e.identifier)?Ve.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):this.createObject(e)}).on("DELETE_GAME_OBJECT",1e3,n=>{Et.instance.delete(n.data.identifier,!1)})}destroy(){Ve.unregister(this)}updateObject(n,e){e.majorVersion+e.minorVersion>n.version&&n.apply(e)}createObject(n){let e=na.instance.create(n.aliasName,n.identifier);e?(Et.instance.add(e,!1),e.apply(n)):console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=Et.instance.getCatalog(),i=setInterval(()=>{Ve.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=Qi.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))}}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=Et.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=Lt.peerContexts;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}var aa,Lf=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(Lf||(Lf={})),Lf))();let la=aa=class extends gl{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=Lf.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return aa._instance||(aa._instance=new aa("DataSummarySetting"),aa._instance.initialize()),aa._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/[\u3000\s]+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=aa.instance.toContext();e.syncData=this.toContext().syncData,aa.instance.apply(e),aa.instance.update(),this.destroy()}};ve([yt()],la.prototype,"sortTag",void 0),ve([yt()],la.prototype,"sortOrder",void 0),ve([yt()],la.prototype,"dataTag",void 0),la=aa=ve([mi("summary-setting")],la);let xc=class extends gl{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new st}get audio(){return Jt.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=Jt.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Ve.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){Ve.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};var Cg;ve([yt()],xc.prototype,"audioIdentifier",void 0),ve([yt()],xc.prototype,"startTime",void 0),ve([yt()],xc.prototype,"isLoop",void 0),ve([yt()],xc.prototype,"isPlaying",void 0),xc=ve([mi("jukebox")],xc);let Co=Cg=class extends Ni{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#555555"}set color(n){this.setCommonValue("color",n)}get bgcolor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#0a0a0a"}set bgcolor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o){let s=null;return s=o?new Cg(o):new Cg,s.createDataElements(),s.commonDataElement.appendChild(kt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(kt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(kt.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(kt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(kt.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(kt.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(kt.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};ve([yt()],Co.prototype,"isLock",void 0),ve([yt()],Co.prototype,"blendType",void 0),ve([yt()],Co.prototype,"isTransparentOnGMMode",void 0),Co=Cg=ve([mi("table-mask")],Co);var xg,La=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(La||(La={})),La))(),bi=(()=>(function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(bi||(bi={})),bi))();let Tr=xg=class extends Ni{constructor(){super(...arguments),this.isLocked=!1,this.mode=La.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=bi.NONE}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&La.WALL)}get hasFloor(){return!!(this.mode&La.FLOOR)}complement(){!this.getElement("altitude",this.commonDataElement)&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o,s,a){let h=null;return h=a?new xg(a):new xg,h.createDataElements(),h.commonDataElement.appendChild(kt.create("name",n,{},"name_"+h.identifier)),h.commonDataElement.appendChild(kt.create("width",e,{},"width_"+h.identifier)),h.commonDataElement.appendChild(kt.create("height",r,{},"height_"+h.identifier)),h.commonDataElement.appendChild(kt.create("depth",i,{},"depth_"+h.identifier)),h.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+h.identifier)),h.imageDataElement.appendChild(kt.create("wall",o,{type:"image"},"wall_"+h.identifier)),h.imageDataElement.appendChild(kt.create("floor",s,{type:"image"},"floor_"+h.identifier)),h.initialize(),h}};ve([yt()],Tr.prototype,"isLocked",void 0),ve([yt()],Tr.prototype,"mode",void 0),ve([yt()],Tr.prototype,"rotate",void 0),ve([yt()],Tr.prototype,"isDropShadow",void 0),ve([yt()],Tr.prototype,"isSurfaceShading",void 0),ve([yt()],Tr.prototype,"isInteract",void 0),ve([yt()],Tr.prototype,"isSlope",void 0),ve([yt()],Tr.prototype,"slopeDirection",void 0),Tr=xg=ve([mi("terrain")],Tr);var ds=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(ds||(ds={})),ds))(),wg=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(wg||(wg={})),wg))();let rr=class extends ii{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=wg.NONE,this.selected=!1,this.gridType=ds.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof Tr&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof Co&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&Ve.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var wc;ve([yt()],rr.prototype,"name",void 0),ve([yt()],rr.prototype,"width",void 0),ve([yt()],rr.prototype,"height",void 0),ve([yt()],rr.prototype,"gridSize",void 0),ve([yt()],rr.prototype,"imageIdentifier",void 0),ve([yt()],rr.prototype,"backgroundImageIdentifier",void 0),ve([yt()],rr.prototype,"backgroundFilterType",void 0),ve([yt()],rr.prototype,"selected",void 0),ve([yt()],rr.prototype,"gridType",void 0),ve([yt()],rr.prototype,"gridColor",void 0),ve([yt()],rr.prototype,"isShowNumber",void 0),rr=ve([mi("game-table")],rr);let Sr=wc=class extends gl{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return wc._instance||(wc._instance=new wc("TableSelecter"),wc._instance.initialize()),wc._instance}onStoreAdded(){super.onStoreAdded(),Ve.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Ve.unregister(this)}get viewTable(){let n=Et.instance.get(this.viewTableIdentifier);return n||(n=Et.instance.getObjects(rr)[0],n&&(this.viewTableIdentifier.length<1||Et.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,Ve.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};ve([yt()],Sr.prototype,"viewTableIdentifier",void 0),Sr=wc=ve([mi("TableSelecter")],Sr);let Vr=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return Fs.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,b=new Date(o.utc_datetime).getTime();this.timeOffset=b+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+b),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s,a,h,b,ee,de,_e,Ce,Se,Pe,Ne){let je=!(_e&&this.findFaceIconIdentifier(o)),He={from:Lt.peerContext.userId,to:t.findId(s),name:this.findObjectName(o),toName:s?this.findObjectName(s):"",imageIdentifier:this.findImageIdentifier(o,_e),toImageIdentifier:s?this.findImageIdentifier(s):"",timestamp:this.calcTimeStamp(e),tag:je?`${r} noface`:r,text:tt.cr(i),color:a,toColor:s?this.findObjectColor(s):"",isInverseIcon:je&&h?1:0,isHollowIcon:je&&b?1:0,isBlackPaint:je&&ee?1:0,aura:je?de:-1,characterIdentifier:Ce,standIdentifier:Se,standName:Pe,isUseStandImage:Ne};return e.addMessage(He)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let o={from:Lt.peerContext.userId,name:Je.myCursor.name,imageIdentifier:Je.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:e,color:Je.myCursor.color};r.addMessage(o)}}static findId(e){let i=Et.instance.get(e);return i instanceof an?i.identifier:i instanceof Je?i.userId:null}findObjectName(e){let i=Et.instance.get(e);return i instanceof an?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof Je?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=Et.instance.get(e);return i instanceof an?i.chatPalette.color:i instanceof Je?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=Et.instance.get(e);return r instanceof an?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof Je?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=Et.instance.get(e);return i instanceof an&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();function xv(t,n=[]){let e=Et.instance.getObjects(t.aliasName);n.forEach(o=>e=e.concat(Et.instance.getObjects(o))),e=e.filter(o=>o.isVisibleOnTable);let i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}var Eg,mr=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}(mr||(mr={})),mr))();let ei=Eg=class extends Ni{constructor(){super(...arguments),this.state=mr.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#555555")}set color(n){this.setCommonValue("color",n)}get ownerName(){let n=Je.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Je.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(Lt.peerContext.userId===this.owner&&Lt.peerContext.isOpen||Lt.peerContexts.some(n=>{const e=Je.findByPeerId(n.peerId);return e&&e.userId===this.owner&&n.isOpen}))}get isHand(){return Lt.peerContext.userId===this.owner}get isFront(){return this.state===mr.FRONT}get isVisible(){return this.isHand||this.isFront}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("color","#555555",{type:"color"},"color_"+this.identifier))}faceUp(){this.state=mr.FRONT,this.owner=""}faceDown(){this.state=mr.BACK,this.owner=""}toTopmost(){xv(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new Eg(o):new Eg,s.createDataElements(),s.commonDataElement.appendChild(kt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(kt.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(kt.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(kt.create("back",i,{type:"image"},"back_"+s.identifier)),s.commonDataElement.appendChild(kt.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(kt.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(kt.create("color","#555555",{type:"color"},"ccolor_"+s.identifier)),s.initialize(),s}};var Tg;ve([yt()],ei.prototype,"state",void 0),ve([yt()],ei.prototype,"rotate",void 0),ve([yt()],ei.prototype,"owner",void 0),ve([yt()],ei.prototype,"zindex",void 0),ve([yt()],ei.prototype,"isLocked",void 0),ei=Eg=ve([mi("card")],ei);let ai=Tg=class extends Ni{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Je.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Je.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return!!this.hasOwner&&(Lt.peerContext.userId===this.owner&&Lt.peerContext.isOpen||Lt.peerContexts.some(n=>{const e=Je.findByPeerId(n.peerId);return e&&e.userId===this.owner&&n.isOpen}))}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}complement(){this.cards.forEach(n=>n.complement())}onChildRemoved(n){super.onChildRemoved(n),n instanceof ei&&Ve.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}inverse(){const n=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;n.unshift(e),e.state=e.state==mr.FRONT?mr.BACK:mr.FRONT}for(let e of n)this.putOnBottom(e)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){xv(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new Tg(e):new Tg,i.createDataElements(),i.commonDataElement.appendChild(kt.create("name",n,{},"name_"+i.identifier));let r=new ii("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};ve([yt()],ai.prototype,"rotate",void 0),ve([yt()],ai.prototype,"zindex",void 0),ve([yt()],ai.prototype,"owner",void 0),ve([yt()],ai.prototype,"isShowTotal",void 0),ve([yt()],ai.prototype,"isLocked",void 0),ai=Tg=ve([mi("card-stack")],ai);var Sg,qi=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(qi||(qi={})),qi))();let Ir=Sg=class extends Ni{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?this.imageDataElement.children.filter(n=>"nothing"!=n.currentValue).map(n=>n.name):[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(n=>"nothing"==n.currentValue).map(n=>n.name)}get ownerName(){let n=Je.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Je.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&Lt.peerContexts.some(n=>n.userId===this.owner&&n.isOpen)}get isMine(){return Lt.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case qi.D2:i=2,o=a=>0===a?"\u8868":"\u88cf";break;case qi.D4:i=4;break;case qi.D6:i=6,r.push(kt.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case qi.D8:i=8;break;case qi.D10_10TIMES:o=a=>a+1+"0";case qi.D10:i=10;break;case qi.D12:i=12;break;case qi.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(kt.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=this.faces[0],r}static create(n,e,i,r){let o=r?new Sg(r):new Sg;return o.createDataElements(),o.commonDataElement.appendChild(kt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(kt.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var Ig;ve([yt()],Ir.prototype,"face",void 0),ve([yt()],Ir.prototype,"owner",void 0),ve([yt()],Ir.prototype,"rotate",void 0),ve([yt()],Ir.prototype,"isDropShadow",void 0),ve([yt()],Ir.prototype,"isLock",void 0),Ir=Sg=ve([mi("dice-symbol")],Ir);let yi=Ig=class extends Ni{constructor(n=yo.generateUuid()){super(n),this.isLocked=!1,this.rotate=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.type="CORN",this.subDivisionSnapPolygonal=!0,this.fillType=1,this.isExpandByFollowing=!1,this.isFollowAltitude=!1,this.followingCharactorCache=null,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get rangeColor(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#ff0000"}set rangeColor(n){this.setCommonValue("color",n)}get gridColor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#ffff00"}set gridColor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get isApplyWidth(){return"LINE"===this.type||"CORN"===this.type}get followingCharactor(){if(this.followingCharctorIdentifier){if(!this.followingCharactorCache||this.followingCharactorCache.identifier!==this.followingCharctorIdentifier){let n=Et.instance.get(this.followingCharctorIdentifier);n&&n instanceof an?this.followingCharactorCache=n:(this.followingCharctorIdentifier=null,this.followingCharactorCache=null)}}else this.followingCharactorCache=null;return this.followingCharactorCache}set followingCharactor(n){n?(this.followingCharactorCache=n,this.followingCharctorIdentifier=n.identifier):(this.followingCharactorCache=null,this.followingCharctorIdentifier=null)}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0)}following(){this.followingCharactor&&!this.followingCharactor.isHideIn?(this.location.x=this.followingCharactor.location.x+this.gridSize*this.followingCharactor.size/2,this.location.y=this.followingCharactor.location.y+this.gridSize*this.followingCharactor.size/2,this.isFollowAltitude&&(this.altitude=this.followingCharactor.altitude,this.posZ=this.followingCharactor.posZ),this.followingCounterDummyCount()):this.followingCharactor=null}static create(n,e,i,r,o){let s=null;return s=o?new Ig(o):new Ig,s.createDataElements(),s.commonDataElement.appendChild(kt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(kt.create("length",i,{},"length_"+s.identifier)),s.commonDataElement.appendChild(kt.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(kt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(kt.create("color","#ff0000",{type:"colors",currentValue:"#ffff00"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};var Mg;ve([yt()],yi.prototype,"isLocked",void 0),ve([yt()],yi.prototype,"rotate",void 0),ve([yt()],yi.prototype,"followingCharctorIdentifier",void 0),ve([yt()],yi.prototype,"followingCounterDummy",void 0),ve([yt()],yi.prototype,"offSetX",void 0),ve([yt()],yi.prototype,"offSetY",void 0),ve([yt()],yi.prototype,"type",void 0),ve([yt()],yi.prototype,"subDivisionSnapPolygonal",void 0),ve([yt()],yi.prototype,"fillType",void 0),ve([yt()],yi.prototype,"isExpandByFollowing",void 0),ve([yt()],yi.prototype,"isFollowAltitude",void 0),yi=Ig=ve([mi("range")],yi);let Gr=Mg=class extends Ni{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1,this.isWhiteOut=!1}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#444444")}set color(n){this.setCommonValue("color",n)}complement(){let n=this.getElement("color",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("color","#555555",{type:"color"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+this.identifier))}toTopmost(){xv(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new Mg(s):new Mg;return a.createDataElements(),a.commonDataElement.appendChild(kt.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(kt.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(kt.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(kt.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(kt.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.commonDataElement.appendChild(kt.create("color","#444444",{type:"color"},"ccolor_"+a.identifier)),a.commonDataElement.appendChild(kt.create("altitude",0,{},"altitude_"+a.identifier)),a.initialize(),a}};ve([yt()],Gr.prototype,"rotate",void 0),ve([yt()],Gr.prototype,"zindex",void 0),ve([yt()],Gr.prototype,"password",void 0),ve([yt()],Gr.prototype,"isUpright",void 0),ve([yt()],Gr.prototype,"isLocked",void 0),ve([yt()],Gr.prototype,"isWhiteOut",void 0),Gr=Mg=ve([mi("text-note")],Gr);let wv=class extends gl{onStoreAdded(){super.onStoreAdded(),Et.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(Et.instance.getObjects(rr)),e=e.concat(Et.instance.getObjects(an)),e=e.concat(Et.instance.getObjects(yi)),e=e.concat(Et.instance.getObjects(Gr)),e=e.concat(Et.instance.getObjects(ai)),e=e.concat(Et.instance.getObjects(ei).filter(i=>null===i.parent)),e=e.concat(Et.instance.getObjects(Ir));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(Et.instance.getObjects(rr)),e=e.concat(Et.instance.getObjects(Co)),e=e.concat(Et.instance.getObjects(Tr)),e=e.concat(Et.instance.getObjects(an)),e=e.concat(Et.instance.getObjects(yi)),e=e.concat(Et.instance.getObjects(Gr)),e=e.concat(Et.instance.getObjects(ai)),e=e.concat(Et.instance.getObjects(ei)),e=e.concat(Et.instance.getObjects(Ir));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)gi.instance.parseXml(n.children[i])}};wv=ve([mi("room")],wv);var Gj=me(1203);class qr{constructor(n,e){this.ngZone=n,this.chatMessageService=e}saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${n}.zip \u3092\u4fdd\u5b58`),qr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new wv),o=this.convertToXml(Fs.instance),s=this.convertToXml(Ns.instance),a=this.convertToXml(Os.instance),h=this.convertToXml(la.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([o],"fly_chat.xml",{type:"text/plain"})),i.push(new File([s],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([a],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([h],"summary.xml",{type:"text/plain"}));let b=[];b=b.concat(this.searchImageFiles(r)),b=b.concat(this.searchImageFiles(o)),b=b.concat(this.searchImageFiles(a));for(const de of b)de.state===Pi.COMPLETE&&i.push(new File([de.blob],de.identifier+"."+yc.extension(de.blob.type),{type:de.blob.type}));let ee=this.convertToXml(Hr.create(b));return i.push(new File([ee],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${tt.aliasNameToClassName(n.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),qr.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="fly_xml_data",i){let r=[],o=this.convertToXml(n);r.push(new File([o],"fly_data.xml",{type:"text/plain"}));let s=[];s=s.concat(this.searchImageFiles(o));for(const h of s)h.state===Pi.COMPLETE&&r.push(new File([h.blob],h.identifier+"."+yc.extension(h.blob.type),{type:h.blob.type}));let a=this.convertToXml(Hr.create(s));return r.push(new File([a],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return sa.instance.saveAsync(n,e,o=>{let s=0|o.percent;s<=r||(r=s,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+Gj.xml(n.toXml(),2)}searchImageFiles(n){let e=Fa.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=Kt.instance.get(a);let h=o[s].getAttribute("currentValue");h&&(r[h]=Kt.instance.get(h))}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=Kt.instance.get(a));let h=o[s].getAttribute("toImageIdentifier");h&&(r[a]=Kt.instance.get(h));let b=o[s].getAttribute("backgroundImageIdentifier");b&&(r[b]=Kt.instance.get(b))}for(let s in r){let a=r[s];a&&i.push(a)}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(n,e,i=null,r="HH:mm",o=!0){const s=0==n?"text/plain":"text/html",a=0==n?".txt":".html",h="fly_"+this.appendTimestamp(e)+a;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${h} \u3092\u4fdd\u5b58`),yS(new Blob([i?i.log(n,r,o):Fs.instance.log(n,r,o)],{type:`${s};charset=utf-8`}),h)}}function qj(t,n){if(1&t&&(Z(0,"option",6),$e(1),ne()),2&t){const e=n.$implicit;Mt("value",e.identifier),V(1),dt(e.name)}}function Wj(t,n){if(1&t){const e=gt();it(0),Z(1,"div",7)(2,"div"),$e(3," \u30bf\u30d6"),Z(4,"sup",8),$e(5,"*"),ne(),$e(6,"\uff1a "),Z(7,"label")(8,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().isAllTabs=r)}),ne(),$e(9,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),ne(),Z(10,"label")(11,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().isAllTabs=r)}),ne(),$e(12,"\u5168\u3066\u306e\u30bf\u30d6"),ne()(),Z(13,"div"),$e(14," \u5f62\u5f0f"),Z(15,"sup",8),$e(16,"*"),ne(),$e(17,"\uff1a "),Z(18,"label")(19,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().logFormat=r)}),ne(),$e(20,"\u30c6\u30ad\u30b9\u30c8"),ne(),Z(21,"label")(22,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().logFormat=r)}),ne(),$e(23,"HTML"),ne()(),Z(24,"div"),$e(25," \u6642\u523b"),Z(26,"sup",8),$e(27,"*"),ne(),$e(28,"\uff1a "),Z(29,"label")(30,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().dateFormat=r)}),ne(),$e(31,"\u306a\u3057"),ne(),Z(32,"label")(33,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().dateFormat=r)}),ne(),$e(34,"\u6642\uff1a\u5206"),ne(),Z(35,"label")(36,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().dateFormat=r)}),ne(),$e(37,"\u65e5\u4ed8\u6642\u523b"),ne()()(),vt(38,"hr"),Z(39,"div",10)(40,"div")(41,"label",11)(42,"input",12),Ae("ngModelChange",function(r){return Fe(e),Re(ge().isWriteOerationLog=r)}),ne(),$e(43,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b"),Z(44,"sup",8),$e(45,"*"),ne()()(),Z(46,"div",13)(47,"button",14),Ae("click",function(){return Fe(e),Re(ge().saveLog())}),$e(48,"\u30ed\u30b0\u51fa\u529b"),ne()()(),rt()}if(2&t){const e=ge();V(8),ur("name","",e.panelId,"-log-output-tab"),ie("ngModel",e.isAllTabs)("checked",!e.isAllTabs)("value",!1),V(3),ur("name","",e.panelId,"-log-output-tab"),ie("ngModel",e.isAllTabs)("checked",e.isAllTabs)("value",!0),V(8),ur("name","",e.panelId,"-log-output-format"),ie("ngModel",e.logFormat)("checked",0==e.logFormat)("value",0),V(3),ur("name","",e.panelId,"-log-output-format"),ie("ngModel",e.logFormat)("checked",1==e.logFormat)("value",1),V(8),ur("name","",e.panelId,"-log-output-timestamp-type"),ie("ngModel",e.dateFormat)("checked",""==e.dateFormat)("value",""),V(3),ur("name","",e.panelId,"-log-output-timestamp-type"),ie("ngModel",e.dateFormat)("checked","HH:mm"==e.dateFormat)("value","HH:mm"),V(3),ur("name","",e.panelId,"-log-output-timestamp-type"),ie("ngModel",e.dateFormat)("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),V(6),Mt("checked",e.isWriteOerationLog?"checked":""),ie("ngModel",e.isWriteOerationLog),V(5),ie("disabled",e.isDiable)}}function Kj(t,n){1&t&&(it(0),Z(1,"div",15),$e(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),ne(),rt())}qr.queue=new jT("SaveDataServiceQueue"),qr.\u0275fac=function(n){return new(n||qr)($n(Fn),$n(Vr))},qr.\u0275prov=xn({token:qr,factory:qr.\u0275fac,providedIn:"root"});let ES=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTab=null}get isAllTabs(){return t.isAllTabs}set isAllTabs(e){t.isAllTabs=e}get logFormat(){return t.logFormat}set logFormat(e){t.logFormat=e}get dateFormat(){return t.dateFormat}set dateFormat(e){t.dateFormat=e}get isWriteOerationLog(){return t.isWriteOerationLog}set isWriteOerationLog(e){t.isWriteOerationLog=e}get tabName(){return this.selectedTab.name}set tabName(e){this.selectedTab.name=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Et.instance.get(this.selectedTab.identifier)}get isDiable(){return this.isEmpty||!this.isAllTabs&&(!this.selectedTab||this.isDeleted)}get roomName(){return Lt.peerContext&&0<Lt.peerContext.roomName.length?Lt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),Ve.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{this.selectedTab&&e.data.identifier===this.selectedTab.identifier&&Et.instance.get(e.data.identifier)}),this.panelId=yo.generateUuid()}ngOnDestroy(){Ve.unregister(this)}onChangeSelectTab(e){this.selectedTab=Et.instance.get(e)}saveLog(){this.isDiable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTab.name),this.isAllTabs?null:this.selectedTab,this.dateFormat,this.isWriteOerationLog)}}return t.isAllTabs=!1,t.logFormat=1,t.dateFormat="HH:mm",t.isWriteOerationLog=!0,t.\u0275fac=function(e){return new(e||t)(Ge(Yn),Ge(Wn),Ge(Vr),Ge(qr))},t.\u0275cmp=mn({type:t,selectors:[["app-chat-log-output"]],decls:7,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],["size","10",2,"width","140px",3,"ngModel","disabled","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],[1,"self-only"],["type","radio",3,"name","ngModel","checked","value","ngModelChange"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"select",2),Ae("change",function(o){return i.onChangeSelectTab(o.target.value)}),Te(3,qj,2,2,"option",3),ne()(),Z(4,"div",4),Te(5,Wj,49,31,"ng-container",5),ne()(),Te(6,Kj,3,0,"ng-container",5)),2&e&&(V(2),ie("ngModel",null==i.selectedTab?null:i.selectedTab.identifier)("disabled",i.isAllTabs),V(1),ie("ngForOf",i.chatTabs),V(2),ie("ngIf",!i.isEmpty),V(1),ie("ngIf",i.isEmpty))},dependencies:[$i,Rn,so,ao,Ii,Fo,vo,sl,Mi,Ci],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]}),t})();function Yj(t,n){if(1&t&&(Z(0,"option",7),$e(1),ne()),2&t){const e=n.$implicit;pt("color",""==e.name?"gray":""),Mt("value",e.identifier),Mt("title",e.name),V(1),dt(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function Zj(t,n){if(1&t&&(Z(0,"div",20),$e(1),ne()),2&t){const e=ge(3);V(1),Zn("",e.progresPercent,"%")}}const Xj=function(t){return{"is-hidden":t}};function Qj(t,n){if(1&t){const e=gt();it(0),Z(1,"button",12),Ae("click",function(){return Fe(e),Re(ge(2).upTabIndex())}),$e(2,"\u2191"),ne(),Z(3,"button",12),Ae("click",function(){return Fe(e),Re(ge(2).downTabIndex())}),$e(4,"\u2193"),ne(),Z(5,"div",13)(6,"button",12),Ae("click",function(){return Fe(e),Re(ge(2).showLogOutput())}),Z(7,"i",14),$e(8,"history_edu"),ne(),$e(9,"\u30ed\u30b0"),ne(),Z(10,"button",15),Ae("click",function(){return Fe(e),Re(ge(2).save())}),Z(11,"div",16)(12,"div",17),$e(13,"\u4fdd\u5b58"),ne(),Te(14,Zj,2,1,"div",18),ne()(),Z(15,"button",19),Ae("click",function(){return Fe(e),Re(ge(2).delete())}),$e(16,"\u524a\u9664"),ne()(),rt()}if(2&t){const e=ge(2);V(10),ie("disabled",e.isSaveing),V(2),ie("ngClass",wt(4,Xj,e.isSaveing)),V(2),ie("ngIf",e.isSaveing),V(1),rn("disabled",e.chatTabs.length<=1?"":null)}}function Jj(t,n){if(1&t){const e=gt();it(0),Z(1,"button",12),Ae("click",function(){return Fe(e),Re(ge(2).restore())}),$e(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function eU(t,n){if(1&t){const e=gt();it(0),Z(1,"div")(2,"label")(3,"b",8),$e(4,"\u30bf\u30d6\u540d: "),ne(),Z(5,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tabName=r)}),ne()()(),Z(6,"div",10)(7,"label")(8,"input",11),Ae("ngModelChange",function(r){return Fe(e),Re(ge().isUseStandImage=r)})("change",function(){Fe(e);const r=ge();return Re(r.isUseStandImage=!!r.isUseStandImage)}),ne(),$e(9," \u{1f4ad}\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),ne()(),Z(10,"div",10)(11,"label")(12,"input",11),Ae("ngModelChange",function(r){return Fe(e),Re(ge().recieveOperationLogLevel=r)})("change",function(){Fe(e);const r=ge();return Re(r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0)}),ne(),$e(13," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),ne()(),vt(14,"hr"),Z(15,"div"),Te(16,Qj,17,6,"ng-container",6),Te(17,Jj,3,0,"ng-container",6),ne(),rt()}if(2&t){const e=ge();V(5),ie("ngModel",e.tabName),rn("disabled",e.isEditable?null:""),V(3),Mt("checked",e.isUseStandImage?"checked":""),ie("ngModel",e.isUseStandImage),rn("disabled",e.isEditable?null:""),V(4),Mt("checked",e.recieveOperationLogLevel>0?"checked":""),ie("ngModel",e.recieveOperationLogLevel),rn("disabled",e.isEditable?null:""),V(4),ie("ngIf",!e.isDeleted),V(1),ie("ngIf",e.isDeleted)}}function tU(t,n){1&t&&(it(0),Z(1,"div",21),$e(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ne(),rt())}let nU=(()=>{class t{constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.pointerDeviceService=s,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==Et.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return Lt.peerContext&&0<Lt.peerContext.roomName.length?Lt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),Ve.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=Et.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Ve.unregister(this)}onChangeSelectTab(e){this.selectedTab=Et.instance.get(e),this.selectedTabXml=""}create(){Fs.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,hn.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=gi.instance.parseXml(this.selectedTabXml);Fs.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(ES,{left:e.x-250,top:e.y-175,width:450,height:300}).selectedTab=this.selectedTab}}return t.\u0275fac=function(e){return new(e||t)(Ge(Yn),Ge(Wn),Ge(Vr),Ge(qr),Ge(vi))},t.\u0275cmp=mn({type:t,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","2px",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.create()}),$e(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),ne()(),Z(5,"select",3),Ae("change",function(o){return i.onChangeSelectTab(o.target.value)}),Te(6,Yj,2,5,"option",4),ne()(),Z(7,"div",5),Te(8,eU,18,10,"ng-container",6),ne()(),Te(9,tU,3,0,"ng-container",6)),2&e&&(V(5),ie("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),V(1),ie("ngForOf",i.chatTabs),V(2),ie("ngIf",!i.isEmpty&&i.selectedTab),V(1),ie("ngIf",i.isEmpty))},dependencies:[oi,$i,Rn,so,ao,Ii,Fo,vo,Mi,Ci],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]}),t})();const iU=["chatTabComponemt"];function rU(t,n){if(1&t){const e=gt();Z(0,"chat-tab",15,16),Ae("onAddMessage",function(){return Fe(e),Re(ge().scrollToBottom())}),ne()}if(2&t){const e=ge();ie("chatTab",e.chatTab)("compact",e.isCompact)}}function oU(t,n){1&t&&(Z(0,"div"),$e(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ne())}function sU(t,n){1&t&&(Z(0,"i",8),$e(1,"how_to_reg"),ne())}function aU(t,n){1&t&&(Z(0,"i",8),$e(1,"history_edu"),ne())}function lU(t,n){1&t&&vt(0,"badge",21),2&t&&ie("count",ge().$implicit.unreadLength)}function cU(t,n){if(1&t){const e=gt();Z(0,"label",17)(1,"input",18),Ae("ngModelChange",function(r){return Fe(e),Re(ge().chatTabidentifier=r)}),ne(),Z(2,"div")(3,"span"),$e(4),ne(),Te(5,sU,2,0,"i",19),Te(6,aU,2,0,"i",19),Te(7,lU,1,1,"badge",20),ne()()}if(2&t){const e=n.$implicit,i=ge();V(1),Mt("value",e.identifier),ie("ngModel",i.chatTabidentifier),V(2),pt("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),V(1),dt(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),V(1),ie("ngIf",e.isUseStandImage),V(1),ie("ngIf",e.recieveOperationLogLevel>0),V(1),ie("ngIf",e.hasUnread)}}const TS=function(t){return{"is-active":t}};let Ec=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get isNoticeOn(){return t.isNoticeOn}set isNoticeOn(e){t.isNoticeOn=e}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return Et.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=Je.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Ve.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=Et.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Ve.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(nU,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(ES,{left:e.x-250,top:e.y-175,width:460,height:300}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}}return t.isNoticeOn=!1,t.\u0275fac=function(e){return new(e||t)(Ge(Vr),Ge(Wn),Ge(vi))},t.\u0275cmp=mn({type:t,selectors:[["chat-window"]],viewQuery:function(e,i){if(1&e&&Tn(iU,5),2&e){let r;En(r=Sn())&&(i.chatTabComponemt=r.first)}},decls:28,vars:15,consts:[[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["title","\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"ngClass","click"],[1,"material-icons",2,"font-size","1em"],[2,"color","red"],["title","\u7c21\u6613\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"ngClass","click"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","compact","onAddMessage"],["chatTabComponemt",""],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1),Te(2,rU,2,2,"chat-tab",2),Te(3,oU,2,0,"div",3),ne(),Z(4,"div",4)(5,"form")(6,"div",5),Te(7,cU,8,10,"label",6),Z(8,"button",7),Ae("click",function(){return i.showTabSetting()}),Z(9,"i",8),$e(10,"settings"),ne(),$e(11,"\u30bf\u30d6"),ne(),Z(12,"button",7),Ae("click",function(){return i.showLogOutput()}),Z(13,"i",8),$e(14,"history_edu"),ne(),$e(15,"\u30ed\u30b0"),ne(),Z(16,"div",9)(17,"button",10),Ae("click",function(){return i.isNoticeOn=!i.isNoticeOn}),Z(18,"i",11),$e(19),ne(),Z(20,"sup",12),$e(21,"*"),ne()(),Z(22,"button",13),Ae("click",function(){return i.isCompact=!i.isCompact}),Z(23,"i",11),$e(24),ne(),Z(25,"sup",12),$e(26,"*"),ne()()()()(),Z(27,"chat-input",14),Ae("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("chat",function(o){return i.sendChat(o)}),ne()()()),2&e&&(V(2),ie("ngIf",i.chatTab),V(1),ie("ngIf",!i.chatTab),V(4),ie("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),V(10),ie("ngClass",wt(11,TS,i.isNoticeOn)),V(2),dt(i.isNoticeOn?"notifications_active":"notifications_off"),V(3),ie("ngClass",wt(13,TS,i.isCompact)),V(2),dt(i.isCompact?"list":"forum"),V(3),ie("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}button.indicate[_ngcontent-%COMP%]{margin:0 0 0 1px}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.indicate.is-active[_ngcontent-%COMP%]{background-color:#fff}button.indicate.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.indicate[_ngcontent-%COMP%]   sup[_ngcontent-%COMP%]{display:inline-block;top:2px;position:relative}"]}),t})();const uU=["root"],dU=["altitudeSlider"];function fU(t,n){if(1&t){const e=gt();Z(0,"span",12),$e(1," (\u9ad8\u5ea6 "),Z(2,"input",13),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).altitudeHande.altitude=r)}),ne(),$e(3,")"),ne()}if(2&t){const e=ge(2);V(2),ie("ngModel",e.altitudeHande.altitude)("disabled",!e.altitudeHande.isHaveAltitude)}}function hU(t,n){if(1&t&&(Z(0,"div")(1,"div",10),$e(2),Te(3,fU,4,2,"span",11),ne()()),2&t){const e=ge();V(1),pt("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),V(1),dt(e.title),V(1),ie("ngIf",e.altitudeHande)}}function pU(t,n){1&t&&(Z(0,"div",14)(1,"div",15),$e(2,"\u9ad8"),ne(),Z(3,"div",16),$e(4,"0"),ne(),Z(5,"div",17),$e(6,"\u4f4e"),ne()())}function gU(t,n){if(1&t){const e=gt();Z(0,"div",18)(1,"input",19,20),Ae("ngModelChange",function(r){return Fe(e),Re(ge().altitudeHande.altitude=r)}),ne()()}if(2&t){const e=ge();V(1),Mt("title",e.altitudeHande.altitude),ie("ngModel",e.altitudeHande.altitude)("disabled",!e.altitudeHande.isHaveAltitude)}}function mU(t,n){1&t&&An(0)}const _U=function(t){return{action:t}};function $U(t,n){if(1&t&&(it(0),Te(1,mU,1,0,"ng-container",21),rt()),2&t){const e=ge().$implicit;ge();const i=dn(12),r=dn(10);V(1),ie("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",wt(2,_U,e))}}function vU(t,n){if(1&t&&(it(0),Te(1,$U,2,4,"ng-container",2),rt()),2&t){const e=n.$implicit;V(1),ie("ngIf",e)}}function bU(t,n){1&t&&(Z(0,"span",43),$e(1,"\u26a0\ufe0f"),ne()),2&t&&Mt("title",ge().action.error)}function yU(t,n){1&t&&vt(0,"input",44),2&t&&ie("disabled",ge().action.disabled)}function CU(t,n){1&t&&vt(0,"input",45),2&t&&ie("disabled",ge().action.disabled)}function xU(t,n){1&t&&vt(0,"input",46),2&t&&ie("disabled",ge().action.disabled)}function wU(t,n){1&t&&vt(0,"input",47),2&t&&ie("disabled",ge().action.disabled)}function EU(t,n){1&t&&(Z(0,"span",48),$e(1,"\u25a0"),ne())}function TU(t,n){1&t&&(Z(0,"span",49),$e(1,"\u25a0"),ne())}function SU(t,n){1&t&&(Z(0,"span",50),$e(1,"\u25a0"),ne())}function IU(t,n){1&t&&(Z(0,"span",51),$e(1,"\u25a0"),ne())}function MU(t,n){1&t&&(Z(0,"span",52),$e(1,"\u25a0"),ne())}function kU(t,n){1&t&&(Z(0,"span",53),$e(1,"\u25a0"),ne())}function DU(t,n){1&t&&(Z(0,"span",54),$e(1,"\u25a0"),ne())}function AU(t,n){1&t&&(Z(0,"span",55),$e(1,"\u25a0"),ne())}function PU(t,n){if(1&t&&(Z(0,"span",56)(1,"i",57),$e(2),ne()()),2&t){const e=ge().action;V(2),dt(e.materialIcon)}}function NU(t,n){1&t&&(Z(0,"sup",58),$e(1,"*"),ne())}function OU(t,n){if(1&t&&(Z(0,"span",59),vt(1,"img",60),zt(2,"safe"),ne()),2&t){const e=ge().action;V(1),ie("src",jt(2,1,e.icon.url,"resourceUrl"),vn)}}function FU(t,n){1&t&&(Z(0,"i",61),$e(1,"open_in_new"),ne())}function RU(t,n){1&t&&(Z(0,"div",62)(1,"i",63),$e(2,"arrow_forward_ios"),ne()())}function LU(t,n){if(1&t&&vt(0,"context-menu",64),2&t){const e=ge().action,i=ge();ie("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}const BU=function(t,n){return{hasHighlight:t,disabled:n}},zU=function(t,n){return{"icon-menu":t,default:n}};function jU(t,n){if(1&t){const e=gt();Z(0,"li",22),Ae("click",function(){const o=Fe(e).action,s=ge();return Re(!(o.disabled||o.altitudeHande&&0==o.altitudeHande.altitude)&&s.doAction(o))})("mouseenter",function(){const o=Fe(e).action,s=ge();return Re(!(o.disabled||o.altitudeHande&&0==o.altitudeHande.altitude)&&s.showSubMenu(o))}),Z(1,"div",23),Te(2,bU,2,1,"span",24),Te(3,yU,1,1,"input",25),Te(4,CU,1,1,"input",26),Te(5,xU,1,1,"input",27),Te(6,wU,1,1,"input",28),Te(7,EU,2,0,"span",29),Te(8,TU,2,0,"span",30),Te(9,SU,2,0,"span",31),Te(10,IU,2,0,"span",32),Te(11,MU,2,0,"span",33),Te(12,kU,2,0,"span",34),Te(13,DU,2,0,"span",35),Te(14,AU,2,0,"span",36),Te(15,PU,3,1,"span",37),$e(16),Te(17,NU,2,0,"sup",38),Te(18,OU,3,4,"span",39),Te(19,FU,2,0,"i",40),ne(),Te(20,RU,3,0,"div",41),Te(21,LU,1,3,"context-menu",42),ne()}if(2&t){const e=n.action,i=ge();pt("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),ie("ngClass",fn(28,BU,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),V(1),ie("ngClass",fn(31,zU,e.icon,e.default)),V(1),ie("ngIf",e.error),V(1),ie("ngIf",e.name&&0==e.name.indexOf("\u2611")),V(1),ie("ngIf",e.name&&0==e.name.indexOf("\u2610")),V(1),ie("ngIf",e.name&&0==e.name.indexOf("\u25c9")),V(1),ie("ngIf",e.name&&0==e.name.indexOf("\u25cb")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),V(1),ie("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),V(1),ie("ngIf",e.materialIcon),V(1),Zn(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb",""),""),V(1),ie("ngIf",e.selfOnly),V(1),ie("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),V(1),ie("ngIf",e.isOuterLink),V(1),ie("ngIf",e.subActions&&!e.disabled),V(1),ie("ngIf",i.subMenu&&i.parentMenu===e)}}function UU(t,n){1&t&&(Z(0,"li"),vt(1,"hr",65),ne())}const HU=function(t,n,e,i){return{"icons-panel":t,"submenu-panel":n,"is-max-limit":e,"pointer-events-none":i}};let VU=(()=>{class t{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=Je.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ai),Ge(pr),Ge(vi))},t.\u0275cmp=mn({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&(Tn(uU,7),Tn(dU,5)),2&e){let r;En(r=Sn())&&(i.rootElementRef=r.first),En(r=Sn())&&(i.altitudeSlider=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","disabled","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","disabled","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","self-only",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(Z(0,"div",0,1),Ae("mouseleave",function(){return i.hideSubMenu()}),Te(2,hU,4,6,"div",2),Z(3,"div",3),Te(4,pU,7,0,"div",4),Te(5,gU,3,3,"div",5),Z(6,"div",6)(7,"ul"),Te(8,vU,2,1,"ng-container",7),ne()()()(),Te(9,jU,22,34,"ng-template",null,8,Qn),Te(11,UU,2,0,"ng-template",null,9,Qn)),2&e&&(ie("ngClass",Is(5,HU,i.isIconsMenu,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),V(2),ie("ngIf",!i.isIconsMenu&&0<i.title.length||i.altitudeHande),V(2),ie("ngIf",i.altitudeHande),V(1),ie("ngIf",i.altitudeHande),V(3),ie("ngForOf",i.actions))},dependencies:[oi,$i,Rn,tl,Ii,Ro,Lo,Mi,Ci,t,_i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})(),GU=(()=>{class t{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=sn.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Ve.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=Kt.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){Ve.unregister(this)}createGameCharacter(){an.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=Sr.instance.viewTable;if(!e)return;let i=Co.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){gi.instance.parseXml(e)}openModal(){this.modalService.open(da)}}return t.\u0275fac=function(e){return new(e||t)(Ge(io),Ge(Yn),Ge(Wn))},t.\u0275cmp=mn({type:t,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(Z(0,"button",0),Ae("click",function(){return i.openModal()}),$e(1,"\u753b\u50cf\u3092\u9078\u3076"),ne(),Z(2,"div"),vt(3,"img",1),zt(4,"safe"),ne(),Z(5,"input",2),Ae("ngModelChange",function(o){return i.name=o}),ne(),Z(6,"div")(7,"div")(8,"input",3),Ae("ngModelChange",function(o){return i.size=o}),ne(),$e(9," Size : "),Z(10,"input",4),Ae("ngModelChange",function(o){return i.size=o}),ne()(),Z(11,"button",0),Ae("click",function(){return i.createGameCharacter()}),$e(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),ne(),Z(13,"button",0),Ae("click",function(){return i.createGameTableMask()}),$e(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),ne()()),2&e&&(V(3),ie("src",jt(4,9,i.tableBackgroundImage.url,"resourceUrl"),vn),V(2),ie("ngModel",i.name),V(3),Mt("title",i.size),Mt("min",i.minSize),Mt("max",i.maxSize),ie("ngModel",i.size),V(2),Mt("min",i.minSize),Mt("max",i.maxSize),ie("ngModel",i.size))},dependencies:[Ii,Ro,Lo,Mi,Ys,Ks,Ci,_i]}),t})();const qU=["chatInput"],WU=["chatPlette"];function KU(t,n){1&t&&(Z(0,"i",14),$e(1,"how_to_reg"),ne())}function YU(t,n){1&t&&(Z(0,"i",14),$e(1,"history_edu"),ne())}function ZU(t,n){1&t&&vt(0,"badge",15),2&t&&ie("count",ge().$implicit.unreadLength)}function XU(t,n){if(1&t){const e=gt();Z(0,"label")(1,"input",11),Ae("ngModelChange",function(r){return Fe(e),Re(ge().chatTabidentifier=r)}),ne(),Z(2,"div")(3,"span"),$e(4),ne(),Te(5,KU,2,0,"i",12),Te(6,YU,2,0,"i",12),Te(7,ZU,1,1,"badge",13),ne()()}if(2&t){const e=n.$implicit,i=ge();V(1),Mt("value",e.identifier),ie("ngModel",i.chatTabidentifier),V(2),pt("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),V(1),dt(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),V(1),ie("ngIf",e.isUseStandImage),V(1),ie("ngIf",e.recieveOperationLogLevel>0),V(1),ie("ngIf",e.hasUnread)}}function QU(t,n){if(1&t){const e=gt();Z(0,"div",16)(1,"div",17)(2,"i",18),$e(3,"info_outline"),ne(),$e(4," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d"),ne(),Z(5,"div",19)(6,"button",20),Ae("click",function(){return Fe(e),Re(ge().helpChatPallet())}),$e(7,"?"),ne()()()}}function JU(t,n){if(1&t&&(Z(0,"option",25),$e(1),ne()),2&t){const e=ge().$implicit;pt("color",ge(3).color),Mt("value",e),V(1),dt(e)}}function eH(t,n){if(1&t&&(it(0),Te(1,JU,2,4,"option",24),rt()),2&t){const e=n.$implicit,i=ge(3);V(1),ie("ngIf",i.filter(e))}}function tH(t,n){if(1&t&&(it(0),Te(1,eH,2,1,"ng-container",3),rt()),2&t){const e=ge(2);V(1),ie("ngForOf",e.palette.getPalette())}}function nH(t,n){if(1&t){const e=gt();Z(0,"div",21)(1,"select",22,23),Ae("input",function(r){return Fe(e),Re(ge().selectPalette(r.target.value))})("click",function(r){return Fe(e),Re(ge().clickPalette(r.target.value))}),Te(3,tH,2,1,"ng-container",10),ne()()}if(2&t){const e=ge();V(3),ie("ngIf",e.palette)}}function iH(t,n){if(1&t){const e=gt();Z(0,"div",21)(1,"textarea",26),Ae("ngModelChange",function(r){return Fe(e),Re(ge().editPalette=r)}),ne()()}if(2&t){const e=ge();V(1),ie("ngModel",e.editPalette)}}function rH(t,n){1&t&&(Z(0,"span"),$e(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6"),ne())}function oH(t,n){1&t&&(Z(0,"span"),$e(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u78ba\u5b9a"),ne())}let Hu=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}get palette(){return this.character.chatPalette}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return Xn.diceBotInfos}get chatTab(){return Et.instance.get(this.chatTabidentifier)}get myPeer(){return Je.myCursor}get otherPeers(){return Et.instance.getObjects(Je)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Ve.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){Ve.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=Et.instance.get(e);if(i instanceof an){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){!this.chatPletteElementRef.nativeElement||(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}helpChatPallet(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(vc,{left:e.x,top:e.y,width:560,height:620});r.title="\u30c1\u30e3\u30c3\u30c8\u8a18\u6cd5\u3068\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u4f7f\u3044\u65b9",r.text="\u3000\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u306f\u5168\u89d2\u3068\u534a\u89d2\u3092\u533a\u5225\u3057\u307e\u305b\u3093\u3001\u307e\u305f\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3084\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u540d\u524d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u307e\u305b\u3093\u3002\u4e0b\u8a18\u3092\u4f75\u7528\u3059\u308b\u5834\u5408\u3001\u30b9\u30da\u30fc\u30b9\u3067\u533a\u5207\u3063\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3001\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9806\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3001\u305d\u308c\u305e\u308c\u7701\u7565\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u5185\u5bb9\u3092\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306b\u6e96\u5099\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5404\u884c\u306b\u4e00\u3064\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u3001\u884c\u3092\u30b7\u30f3\u30b0\u30eb\u30af\u30ea\u30c3\u30af\u3067\u30c1\u30e3\u30c3\u30c8\u6b04\u306b\u547c\u3073\u51fa\u3057\u3001\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\u30fb\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\n\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u306e\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u3001\u5148\u982d\u306b : \u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u3001\u30aa\u30da\u30ec\u30fc\u30bf\u30fc\uff08\u5897\u52a0 + \u3001\u6e1b\u5c11 -\u3001\u4ee3\u5165 =\uff09\u3001\u64cd\u4f5c\u5185\u5bb9\u306e\u9806\u306b\u8a18\u8ff0\u3057\u3066\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u64cd\u4f5c\u5185\u5bb9\u306b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u8a18\u8f09\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3067\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff08\u30ea\u30bd\u30fc\u30b9\u3084\u6570\u5024\u3001\u80fd\u529b\u5024\u3092\u64cd\u4f5c\u3059\u308b\u5834\u5408\u3001\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff09\u3002\n\u3000\u307e\u305f\u3001\u30aa\u30da\u30ec\u30fc\u30bf\u30fc\u3068\u3057\u3066 > \u3092\u4f7f\u7528\u3059\u308c\u3070\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\uff08\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3092\u884c\u308f\u305a\uff09\u76f4\u63a5\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u4ee3\u5165\u3067\u304d\u307e\u3059\uff08\u73fe\u72b6 name\u3001size\u3001height\u3001altitude \u306f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\uff09\u3002\u3055\u3089\u306b : \u3067\u533a\u5207\u3063\u3066\u8907\u6570\u306e\u64cd\u4f5c\u3092\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306f\u30c1\u30e3\u30c3\u30c8\u306b\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000:HP+2d6:MP-4\u3000 HP\u30922d6\u56de\u5fa9\u3057\u3001MP\u30924\u70b9\u6d88\u8cbb\u3057\u307e\u3059\u3002\n\u3000:\u6d78\u98df\u7387+1D10\u3000 \u767b\u5834\uff01\n\n\u30ea\u30bd\u30fc\u30b9\u306e\u64cd\u4f5c\u306f\u6700\u5927\u5024\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3001\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u64cd\u4f5c\u3067\u306f\u6700\u5927\u5024\u3092\u8d85\u3048\u305a\u3001\u3059\u3067\u306b\u6700\u5927\u5024\u3092\u8d85\u3048\u3066\u3044\u308c\u3070\u305d\u308c\u4ee5\u4e0a\u5897\u52a0\u3057\u307e\u305b\u3093\u3002\n\n\u30fb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3084\u8868\u306e\u53c2\u7167\u304c\u53ef\u80fd\u3067\u3059\u3002\u5b9f\u969b\u306e\u30b3\u30de\u30f3\u30c9\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u3054\u3068\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306e\u30d8\u30eb\u30d7\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u307e\u305f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u6a5f\u80fd\u306b\u3088\u308a\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u62e1\u5f35\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30d1\u30e9\u30e1\u30fc\u30bf\u53c2\u7167\n\u3000{ \u3068 } \u3067\u56f2\u3093\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u3092\u8a18\u8f09\u3059\u308b\u3068\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u304b\u3089\u9078\u629e\u3057\u305f\u969b\u3068\u30c1\u30e3\u30c3\u30c8\u3092\u9001\u4fe1\u3057\u305f\u969b\u306b\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5185\u5bb9\u306b\u7f6e\u304d\u63db\u3048\u3089\u308c\u307e\u3059\u3002\u307e\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u306e\u5148\u982d\u306b $ \u3092\u4ed8\u8a18\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u524d\u8ff0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3092\u9069\u7528\u5f8c\u306e\u5024\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\u3000\u3055\u3089\u306b $\u6570\u5024 \u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u306b\u3088\u308b\u5b9f\u969b\u306e\u5909\u5316\u91cf\uff08\u30ea\u30bd\u30fc\u30b9\u3001\u6570\u5024\u3001\u80fd\u529b\u5024\u306e\u307f\u3001\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3084\u6700\u5927\u5024\u306b\u3088\u308b\u5207\u308a\u6368\u3066\u3092\u8003\u616e\uff09\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u6570\u5024\u306f1\u304b\u3089\u958b\u59cb\u30671\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306e\u6700\u521d\u306e\u64cd\u4f5c\u7d50\u679c\u30012\u30672\u756a\u76ee\u306e\u7d50\u679c\u2026\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u53c2\u7167\u306e\u4f8b\uff09\n\u3000:HP-2d6\u30002d6+{\u7b4b\u529b}+2\u3000 HP{$1}\u3001\u7b4b\u529b\u306b+2\u3057\u3066\u5224\u5b9a\uff08\u73fe\u5728HP {$HP}\uff09\n\n\u30fb\u8ffd\u52a0\u306e\u5024\n\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u884c\u306b //\u540d\u524d=\u5024 \u306e\u5f62\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u540c\u69d8\u306b\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u304b\u3089\u53c2\u7167\u3067\u304d\u308b\u5024\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\uff08\u30b3\u30de\u30f3\u30c9\u3067\u64cd\u4f5c\u306f\u3067\u304d\u307e\u305b\u3093\uff09\u3002\n\n\u8ffd\u52a0\u306e\u5024\u306e\u4f8b\uff09\n\u3000//\u4eca\u306e\u5929\u6c17=\u96e8\n\n\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u3044\u305a\u308c\u304b\u306e\u884c\u306b\u4e0a\u8a18\u306e\u4f8b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u9001\u4fe1\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3084\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u4e2d\u306e {\u4eca\u306e\u5929\u6c17} \u304c \u96e8 \u306b\u7f6e\u304d\u63db\u308f\u308a\u307e\u3059\u3002\n\n\u30fb\u6539\u884c\u3001\u7a7a\u767d\n\u3000\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u4e2d\u306b \\n \u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u305d\u3053\u3067\u6539\u884c\u3055\u308c\u307e\u3059\uff08n\u306f\u5c0f\u6587\u5b57\u3001\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306f1\u884c\u306b\u4e00\u3064\u306e\u9001\u4fe1\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u3001\u6539\u884c\u3092\u76f4\u63a5\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u6539\u884c\u3057\u307e\u3059\u3002\n\u3000\\s \uff08s\u304c\u534a\u89d2\uff09\u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u534a\u89d2\u30b9\u30da\u30fc\u30b9\u3001\\\uff53 \uff08\uff53\u304c\u5168\u89d2\uff09\u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u5168\u89d2\u30b9\u30da\u30fc\u30b9\u3068\u306a\u308a\u307e\u3059\uff08\u5168\u89d2\u534a\u89d2\u3092\u533a\u5225\u3059\u308b\u4f8b\u5916\u3067\u3059\uff09\u3001\u30b3\u30de\u30f3\u30c9\u4e2d\u306b\u30b9\u30da\u30fc\u30b9\u306f\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u3053\u3061\u3089\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u4f8b\u5916\u3068\u3057\u3066\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9 CHOICE \u306e\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u306e\u8a18\u8ff0\u3067\u306f\u3001\u30b9\u30da\u30fc\u30b9\u3092\u8a18\u8ff0\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u306e\u5834\u5408\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\uff08\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u306e\u6700\u5f8c\u3082CHOICE\u30b3\u30de\u30f3\u30c9\u306e\u4e00\u90e8\u3068\u307f\u306a\u3055\u308c\u307e\u3059\uff09\u3002\n\n\u30fb\u30eb\u30d3\uff08\u30d5\u30ea\u30ac\u30ca\uff09\n\u3000\u30c1\u30e3\u30c3\u30c8\u5185\u5bb9\u306e\u30d5\u30ea\u30ac\u30ca\u3092\u632f\u308a\u305f\u3044\u90e8\u5206\u306e\u958b\u59cb\u306b | \uff08\u30d1\u30a4\u30d7\uff09\u3001\u7d42\u4e86\u306b \u300a \u3068 \u300b \u3067\u56f2\u3093\u3067\u30d5\u30ea\u30ac\u30ca\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u30eb\u30d3\u306e\u4f8b\uff09\n\u3000\u53d7\u3051\u308b\u304c\u826f\u3044\uff01\uff5c\u7d04\u675f\u3055\u308c\u305f\u52dd\u5229\u306e\u5263\u300a\u30a8\u30af\u30b9\u30ab\u30ea\u30d0\u30fc\u300b\uff01\n\n\u30fb\u{1f4ad}\n\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u306e\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u3001 \u300c \u3068 \u300d \u3067\u56f2\u3093\u3060\u5185\u5bb9\u3092\u{1f4ad}\u3067\u8868\u793a\u3057\u307e\u3059\u3002"}}return t.\u0275fac=function(e){return new(e||t)(Ge(Vr),Ge(Wn),Ge(vi))},t.\u0275cmp=mn({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(Tn(qU,7),Tn(WU,5)),2&e){let r;En(r=Sn())&&(i.chatInputComponent=r.first),En(r=Sn())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info","style","display: flex",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],[2,"flex-grow","0","padding-left","0px","padding-top","1px"],["type","submit",2,"margin","0px",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info",2,"display","flex"],[2,"width","calc(100% - 1.6em)","text-align","center"],[1,"material-icons",2,"vertical-align","middle","font-size","1.05rem"],[2,"width","1.6em","text-align","right"],[2,"padding","2px 6px","vertical-align","baseline","font-size","x-small","height","1.24rem",3,"click"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),Te(4,XU,8,10,"label",3),ne()(),Z(5,"chat-input",4,5),Ae("gameTypeChange",function(o){return i.gameType=o})("sendFromChange",function(o){return i.sendFrom=o})("textChange",function(o){return i.text=o})("chat",function(o){return i.sendChat(o)}),ne(),Te(7,QU,8,0,"div",6),ne(),Te(8,nH,4,1,"div",7),Te(9,iH,2,1,"div",7),Z(10,"div",8)(11,"button",9),Ae("click",function(){return i.toggleEditMode()}),Te(12,rH,2,0,"span",10),Te(13,oH,2,0,"span",10),ne()()()),2&e&&(V(4),ie("ngForOf",i.chatMessageService.chatTabs),V(1),ie("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),V(2),ie("ngIf",i.isEdit),V(1),ie("ngIf",!i.isEdit),V(1),ie("ngIf",i.isEdit),V(3),ie("ngIf",!i.isEdit),V(1),ie("ngIf",i.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]}),t})();function sH(t,n){if(1&t&&(Z(0,"div",11),$e(1),ne()),2&t){const e=ge(2);V(1),dt(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}const aH=function(t){return{transform:t}},lH=function(t){return{inverse:t}},cH=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},uH=function(t,n){return{"black-paint":t,hollow:n}};function dH(t,n){if(1&t){const e=gt();it(0),Z(1,"div")(2,"div",5)(3,"div",6)(4,"span",7)(5,"img",8),Ae("dblclick",function(){return Fe(e),Re(ge().openModal())}),zt(6,"safe"),ne()()()(),Z(7,"button",9),Ae("click",function(){return Fe(e),Re(ge().openModal())}),Z(8,"b"),$e(9),ne()(),Te(10,sH,2,1,"div",10),ne(),rt()}if(2&t){const e=ge();V(2),ie("ngStyle",wt(10,aH,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),V(1),ie("ngClass",wt(12,lH,e.isApplyImageEffect&&e.gameCharacter.isInverse)),V(1),ie("ngClass",Ms(14,cH,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),V(1),ie("src",jt(6,7,e.standImage.url,"resourceUrl"),vn)("ngClass",fn(23,uH,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),V(4),Zn("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),V(1),ie("ngIf",e.isSpeakable)}}function fH(t,n){if(1&t){const e=gt();it(0),Z(1,"span",12)(2,"input",13),Ae("ngModelChange",function(r){return Fe(e),Re(ge().nameElement.value=r)}),ne()(),rt()}if(2&t){const e=ge();V(2),ie("ngModel",e.nameElement.value)}}function hH(t,n){if(1&t){const e=gt();it(0),Z(1,"b",12),$e(2,"\u3000Cond: "),ne(),Z(3,"select",14),Ae("ngModelChange",function(r){return Fe(e),Re(ge().conditionTypeElement.value=r)}),Z(4,"option",15),$e(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),ne(),Z(6,"option",15),$e(7,"\u6307\u5b9a\u753b\u50cf"),ne(),Z(8,"option",15),$e(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),ne(),Z(10,"option",15),$e(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),ne(),Z(12,"option",15),$e(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),ne(),Z(14,"option",15),$e(15,"\u9078\u629e\u6642\u306e\u307f"),ne()(),rt()}if(2&t){const e=ge();V(3),ie("ngModel",e.conditionTypeElement.value),V(1),Mt("value",e.standConditionType.Default),V(2),Mt("value",e.standConditionType.Image),V(2),Mt("value",e.standConditionType.Postfix),V(2),Mt("value",e.standConditionType.PostfixOrImage),V(2),Mt("value",e.standConditionType.PostfixAndImage),V(2),Mt("value",e.standConditionType.NotConditionStandUp)}}function pH(t,n){if(1&t){const e=gt();it(0),Z(1,"span",12)(2,"b",16),$e(3,"Tag: "),ne(),Z(4,"input",17),Ae("ngModelChange",function(r){return Fe(e),Re(ge().nameElement.currentValue=r)}),ne()(),rt()}if(2&t){const e=ge();V(4),ie("ngModel",e.nameElement.currentValue)}}function gH(t,n){if(1&t){const e=gt();it(0),Z(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Fe(e),Re(ge().showNameElement.value=r)})("change",function(){Fe(e);const r=ge();return Re(r.showNameElement.value=r.showNameElement.value?"showName":"")}),ne(),Z(3,"b",12),$e(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),ne()(),rt()}if(2&t){const e=ge();V(2),Mt("checked",e.showNameElement.value?"checked":""),ie("ngModel",e.showNameElement.value)}}function mH(t,n){if(1&t){const e=gt();it(0),Z(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Fe(e),Re(ge().applyImageEffectElement.value=r)})("change",function(){Fe(e);const r=ge();return Re(r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":"")}),ne(),Z(3,"b",12),$e(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),ne()(),rt()}if(2&t){const e=ge();V(2),Mt("checked",e.applyImageEffectElement.value?"checked":""),ie("ngModel",e.applyImageEffectElement.value)}}function _H(t,n){if(1&t){const e=gt();it(0),Z(1,"label",18)(2,"input",19),Ae("ngModelChange",function(r){return Fe(e),Re(ge().applyRollElement.value=r)})("change",function(){Fe(e);const r=ge();return Re(r.applyRollElement.value=r.applyRollElement.value?"applyRoll":"")}),ne(),Z(3,"b",12),$e(4,"\u56de\u8ee2\u53cd\u6620"),ne()(),rt()}if(2&t){const e=ge();V(2),Mt("checked",e.applyRollElement.value?"checked":""),ie("ngModel",e.applyRollElement.value)}}function $H(t,n){if(1&t){const e=gt();it(0),Z(1,"label",20)(2,"input",19),Ae("ngModelChange",function(r){return Fe(e),Re(ge().applyDialogElement.value=r)})("change",function(){Fe(e);const r=ge();return Re(r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":"")}),ne(),Z(3,"b",12),$e(4,"\u{1f4ad}"),ne()(),rt()}if(2&t){const e=ge();V(2),Mt("checked",e.applyDialogElement.value?"checked":""),ie("ngModel",e.applyDialogElement.value)}}const vH=function(t){return{"disabled-text":t}};function bH(t,n){if(1&t){const e=gt();it(0),vt(1,"br"),Z(2,"button",21),Ae("click",function(){return Fe(e),Re(ge().testStandUp())}),Z(3,"b"),$e(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Z(5,"sup",22),$e(6,"*"),ne()()(),Z(7,"label",23)(8,"input",19),Ae("ngModelChange",function(r){return Fe(e),Re(ge().positionElement.currentValue=r)})("change",function(){Fe(e);const r=ge();return Re(r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":"")}),ne(),Z(9,"b",12),$e(10,"Pos\u500b\u5225\u6307\u5b9a: "),ne()(),Z(11,"span",24)(12,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge().positionElement.value=r)}),ne(),Z(13,"input",26),Ae("ngModelChange",function(r){return Fe(e),Re(ge().positionElement.value=r)}),ne(),Z(14,"b",27),$e(15,"%"),ne()(),rt()}if(2&t){const e=ge();V(8),Mt("checked",e.positionElement.currentValue?"checked":""),ie("ngModel",e.positionElement.currentValue),V(4),ie("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),V(1),ie("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),V(1),ie("ngClass",wt(7,vH,!e.positionElement.currentValue))}}function yH(t,n){if(1&t){const e=gt();it(0),vt(1,"br"),Z(2,"span",24)(3,"b",28),$e(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),ne(),Z(5,"input",29),Ae("ngModelChange",function(r){return Fe(e),Re(ge().heightElement.value=r)}),ne(),Z(6,"input",30),Ae("ngModelChange",function(r){return Fe(e),Re(ge().heightElement.value=r)}),ne(),Z(7,"b",31),$e(8,"%"),ne()(),Z(9,"span",32)(10,"b",28),$e(11,"AdjY: "),ne(),Z(12,"input",33),Ae("ngModelChange",function(r){return Fe(e),Re(ge().heightElement.currentValue=r)}),ne(),Z(13,"b",31),$e(14,"%"),ne()(),rt()}if(2&t){const e=ge();V(5),ie("ngModel",e.heightElement.value),V(1),ie("ngModel",e.heightElement.value),V(6),ie("ngModel",e.heightElement.currentValue)}}function CH(t,n){if(1&t){const e=gt();Z(0,"div")(1,"textarea",34),Ae("ngModelChange",function(r){return Fe(e),Re(ge().postfixElement.value=r)}),ne()()}if(2&t){const e=ge();V(1),ie("ngModel",e.postfixElement.value)}}const xH=function(t){return{"current-icon":t}};function wH(t,n){if(1&t){const e=gt();Z(0,"div",39)(1,"img",40),Ae("click",function(){Fe(e);const r=ge().$implicit;return Re(ge(3).selectImage(r.identifier))}),zt(2,"safe"),ne()()}if(2&t){const e=ge().$implicit,i=ge(3);ie("ngClass",wt(6,xH,i.isSelectedImage(e.identifier))),V(1),ie("src",jt(2,3,e.url,"resourceUrl"),vn)("alt",e.name)}}function EH(t,n){if(1&t&&(it(0),Te(1,wH,3,8,"div",38),rt()),2&t){const e=n.$implicit;V(1),ie("ngIf",0<e.url.length)}}function TH(t,n){if(1&t&&(Z(0,"div",36),Te(1,EH,2,1,"ng-container",37),ne()),2&t){const e=ge(2);V(1),ie("ngForOf",e.imageList)}}function SH(t,n){1&t&&(Z(0,"div"),$e(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),ne())}function IH(t,n){if(1&t&&(Z(0,"div"),Te(1,TH,2,1,"div",35),Te(2,SH,2,0,"div",2),ne()),2&t){const e=ge();V(1),ie("ngIf",e.imageList&&e.imageList.length>0),V(1),ie("ngIf",!e.imageList||0==e.imageList.length)}}let SS=(()=>{class t{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=sn.Empty,this.standConditionType=Hi}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(kt.create("speakingImageIdentifier",sn.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==sn.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=Kt.instance.get(e.value);this._imageFile=i||sn.Empty}}else{let i=sn.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=Kt.instance.add(i),this.standElement.appendChild(kt.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(kt.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(kt.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(kt.create("conditionType",Hi.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(kt.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(kt.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(kt.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(kt.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(kt.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(kt.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==sn.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],o=this.standElement.getFirstElementByName(e);o?r=[o.value+""]:o=this.standElement.appendChild(kt.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(da,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{!s||(o.value=s)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){!this.standElement||this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let o=!0;for(let s of this.imageList)if(s.identifier==r.value){o=!1;break}o?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(kt.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+yo.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){Ve.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),Ve.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}return t.\u0275fac=function(e){return new(e||t)(Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.2em"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,i){1&e&&(Z(0,"div")(1,"div",0)(2,"div",1),Te(3,dH,11,26,"ng-container",2),ne(),Z(4,"div",3)(5,"div"),Te(6,fH,3,1,"ng-container",2),Te(7,hH,16,7,"ng-container",2),Te(8,pH,5,1,"ng-container",2),ne(),Z(9,"div"),Te(10,gH,5,2,"ng-container",2),Te(11,mH,5,2,"ng-container",2),Te(12,_H,5,2,"ng-container",2),Te(13,$H,5,2,"ng-container",2),Z(14,"button",4),Ae("click",function(){return i.openSpeakingModal()}),$e(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),ne(),Te(16,bH,16,9,"ng-container",2),Te(17,yH,15,3,"ng-container",2),ne(),Te(18,CH,2,1,"div",2),Te(19,IH,3,2,"div",2),ne()()()),2&e&&(V(3),ie("ngIf",i.standImage),V(3),ie("ngIf",i.nameElement),V(1),ie("ngIf",i.conditionTypeElement),V(1),ie("ngIf",i.nameElement),V(2),ie("ngIf",i.showNameElement),V(1),ie("ngIf",i.applyImageEffectElement),V(1),ie("ngIf",i.applyRollElement),V(1),ie("ngIf",i.applyDialogElement),V(1),pt("font-weight",i.isSpeakable?"bolder":"normal"),V(2),ie("ngIf",i.positionElement),V(1),ie("ngIf",i.heightElement),V(1),ie("ngIf",i.postfixElement&&(i.conditionTypeElement.value==i.standConditionType.Postfix||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage)),V(1),ie("ngIf",i.conditionTypeElement.value==i.standConditionType.Image||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage))},dependencies:[oi,$i,Rn,hr,so,ao,Ii,Ro,Lo,Fo,vo,Mi,Ys,Ks,Ci,_i],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})();function MH(t,n){if(1&t){const e=gt();Z(0,"div",14)(1,"div",15)(2,"div",16)(3,"input",17),Ae("click",function(){const o=Fe(e).index;return Re(ge().overviewIndex=o)}),ne()(),Z(4,"div",18),vt(5,"stand-element",19,20),ne(),Z(7,"div",21)(8,"button",22),Ae("click",function(){const r=Fe(e),o=r.$implicit,s=r.index;return Re(ge().delele(o,s))}),$e(9,"\xd7"),ne(),Z(10,"button",23),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().upStandIndex(o))}),$e(11,"\u2191"),ne(),Z(12,"button",24),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().downStandIndex(o))}),$e(13,"\u2193"),ne()()(),vt(14,"hr"),ne()}if(2&t){const e=n.$implicit,i=n.index,r=ge();V(1),pt("border-color",r.overviewIndex==i?"red":"transparent"),V(2),ur("name","",r.panelId,"_overviewIndex"),Mt("value",i),ie("checked",r.overviewIndex==i),V(2),ie("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function kH(t,n){if(1&t){const e=gt();Z(0,"button",12),Ae("click",function(){return Fe(e),Re(ge().restore())}),$e(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),ne()}}let Bf=(()=>{class t{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const o=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let s of o){if(i[s.value])continue;let a=this.imageElementToFile(s);a&&(i[s.value]=!0,e.push(a))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),Ve.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=yo.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),Ve.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){Ve.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(gr,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:Bi.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=gi.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(vc,{left:e.x,top:e.y,width:600,height:590});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?Kt.instance.get(e.value):null}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(vi),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["app-stand-setting"]],viewQuery:function(e,i){if(1&e&&Tn(SS,5),2&e){let r;En(r=Sn())&&(i.standElementComponents=r)}},inputs:{character:"character"},decls:27,vars:10,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"button",1),Ae("click",function(){return i.helpStandSeteing()}),$e(2,"?"),ne(),Z(3,"div",2)(4,"b"),$e(5,"Pos: "),ne(),Z(6,"input",3),Ae("ngModelChange",function(o){return i.position=o}),ne(),Z(7,"input",4),Ae("ngModelChange",function(o){return i.position=o}),ne(),Z(8,"b",5),$e(9,"\uff05\u3000"),ne()(),Z(10,"div",2)(11,"b"),$e(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),ne(),Z(13,"input",3),Ae("ngModelChange",function(o){return i.height=o}),ne(),Z(14,"input",6),Ae("ngModelChange",function(o){return i.height=o}),ne(),Z(15,"b",5),$e(16,"\uff05"),ne()()(),Z(17,"div",7)(18,"label",8)(19,"input",9),Ae("click",function(){return i.overviewIndex=-1}),ne(),$e(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),ne()(),vt(21,"hr"),Z(22,"div",10),Te(23,MH,15,8,"div",11),ne(),Z(24,"button",12),Ae("click",function(){return i.add()}),$e(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),ne(),Te(26,kH,2,0,"button",13)),2&e&&(V(6),ie("ngModel",i.position),V(1),ie("ngModel",i.position),V(6),ie("ngModel",i.height),V(1),ie("ngModel",i.height),V(3),pt("border-color",-1==i.overviewIndex?"red":"transparent"),V(2),ur("name","",i.panelId,"_overviewIndex"),ie("checked",-1==i.overviewIndex),V(4),ie("ngForOf",i.standElements),V(3),ie("ngIf",i.standSettingXML))},styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),t})(),Ev=(()=>{class t{constructor(){this.tableInventory=new kg(e=>"table"===e.location.name),this.commonInventory=new kg(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new kg(e=>e.location.name===Lt.peerId),this.graveyardInventory=new kg(e=>"graveyard"===e.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineStrings="/\uff0f",this.newLineDataElement=kt.create(this.newLineStrings),this.initialize()}get summarySetting(){return la.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this._sortStop}set sortStop(e){const i=this._sortStop;this._sortStop=e,i&&!this._sortStop&&this.refresh()}initialize(){Ve.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);if(i)if(i instanceof an){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof kt){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),0<i.children.length&&this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}else i instanceof la&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=an.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){Ve.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===Lt.peerId||"graveyard"===e)return!0;for(let i of Lt.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class kg{constructor(n){this.classifier=n,this.newLineStrings="/\uff0f",this.newLineDataElement=kt.create(this.newLineStrings),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return la.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.detailDataElement)continue;let i=this.dataTags.map(r=>this.newLineStrings.includes(r)?this.newLineDataElement:e.detailDataElement.getFirstElementByNameUnsensitive(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=Et.instance.getObjects(an),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByNameUnsensitive(e),a=o.rootDataElement?.getFirstElementByNameUnsensitive(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let h=this.convertToSortableValue(s,r),b=this.convertToSortableValue(a,o);return h<b?i:h>b?-1*i:0}),n}convertToSortableValue(n,e=null){let i=this.evaluate(n,e),r=tt.toHalfWidth((i+"").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase().trim(),o=+r;return Number.isNaN(o)?r:o}evaluate(n,e=null){let i;if(n.isCheckProperty){let r=n.currentValue.toString().split(/[|\uff5c]/,2);if(r.length<=1)return null==n.value||""==n.value?"":n.currentValue.toString();i=null==n.value||""==n.value?r[1]:r[0]}else i=n.isAbilityScore?n.calcAbilityScore:n.isNumberResource?n.currentValue:n.value;return null!=i&&e instanceof an&&e.chatPalette&&(i=e.chatPalette.evaluate(i+"",e.rootDataElement)),i}}class fs{constructor(n,e){this.elementRef=n,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}ngAfterViewInit(){let n=this.dataElement;for(;(n=n.parent)&&(n instanceof ei&&(this.type="\u30ab\u30fc\u30c9"),n instanceof ai&&(this.type="\u5c71\u672d"),n instanceof Ir&&(this.type=n.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),n instanceof an&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),n instanceof Co&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),n instanceof Tr&&(this.type="\u5730\u5f62"),n instanceof Gr&&(this.type="\u5171\u6709\u30e1\u30e2"),n instanceof yi&&(this.type="\u5c04\u7a0b\u30fb\u7bc4\u56f2"),n.parentIsAssigned&&!n.parentIsUnknown););const e=fs.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.dataElement.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)})}ngOnDestroy(){const n=fs.LoggingValueMap,e=this.dataElement.identifier;n.get(e)&&n.get(e).timerId&&this.doLogging()}doLogging(){const n=fs.LoggingValueMap,e=this.dataElement.identifier;n.get(e).timerId&&(clearTimeout(n.get(e).timerId),n.get(e).timerId=null);const i=n.get(e).oldValue,r=this.dataElement.loggingValue,o=this.dataElement;if(!this.isDisable&&r!=i){let s=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==o.name?"(\u7121\u540d\u306e\u5909\u6570)":o.name} \u3092\u5909\u66f4`;this.showValue&&(o.isSimpleNumber||o.isNumberResource||o.isAbilityScore)?s+=` ${i} \u2192 ${r}`:o.isCheckProperty&&(s+=` ${r}`),this.chatMessageService.sendOperationLog(s)}n.get(e).oldValue=r}}function DH(t,n){1&t&&An(0)}function AH(t,n){1&t&&An(0)}function PH(t,n){if(1&t&&(Z(0,"div"),$e(1),ne()),2&t){const e=ge();V(1),Zn("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function NH(t,n){if(1&t&&(Z(0,"div",12),$e(1),ne()),2&t){const e=ge().$implicit;pt("background-color",e.ownerColor),V(1),dt(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function OH(t,n){1&t&&An(0)}fs.LoggingValueMap=new Map,fs.\u0275fac=function(n){return new(n||fs)(Ge(Ai),Ge(Vr))},fs.\u0275dir=_n({type:fs,selectors:[["","appLogging",""]],inputs:{isDisable:["logging.disable","isDisable"],timeout:["logging.timeout","timeout"],name:["logging.name","name"],dataElement:["logging.dataElement","dataElement"],showValue:["logging.loggingValue","showValue"]}});const FH=function(t,n,e){return{box:!0,selected:t,"is-hide-in":n,"is-inventory-no-indicate":e}},RH=function(t){return{gameObject:t}};function LH(t,n){if(1&t){const e=gt();Z(0,"div",9),Ae("contextmenu",function(r){const s=Fe(e).$implicit;return Re(ge().onContextMenu(r,s))})("click",function(){const o=Fe(e).$implicit;return Re(ge().selectGameObject(o))})("dblclick",function(r){const s=Fe(e).$implicit;return Re(ge().focusGameObject(s,r))}),Te(1,NH,2,3,"div",10),Te(2,OH,1,0,"ng-container",11),ne()}if(2&t){const e=n.$implicit,i=ge(),r=dn(11);ie("ngClass",_o(4,FH,i.selectedIdentifier===e.identifier,e.isHideIn,!e.isInventoryIndicate)),V(1),ie("ngIf",e.isHideIn&&null!=e.ownerName),V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",wt(8,RH,e))}}function BH(t,n){if(1&t){const e=gt();Z(0,"div",13)(1,"button",14),Ae("click",function(){return Fe(e),Re(ge().cleanInventory())}),$e(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),ne()()}if(2&t){const e=ge();V(1),rn("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function zH(t,n){if(1&t){const e=gt();Z(0,"label")(1,"input",18),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).selectTab=r)}),ne(),Z(2,"div"),$e(3),ne()()}if(2&t){const e=n.$implicit,i=ge(2);V(1),Mt("value",e),ie("ngModel",i.selectTab),V(2),Ja("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function jH(t,n){if(1&t&&(Z(0,"form",15)(1,"div",16),Te(2,zH,4,4,"label",17),ne()()),2&t){const e=ge();V(2),ie("ngForOf",e.inventoryTypes)}}function UH(t,n){if(1&t){const e=gt();it(0),Z(1,"div")(2,"div",19)(3,"b"),$e(4,"\u4e26\u3073\u9806: "),ne()(),Z(5,"input",20),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).sortTag=r)}),ne(),Z(6,"select",21),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).sortOrder=r)}),Z(7,"option",22),$e(8,"\u6607\u9806"),ne(),Z(9,"option",23),$e(10,"\u964d\u9806"),ne()()(),Z(11,"div",24)(12,"b"),$e(13,"\u8868\u793a\u9805\u76ee: "),ne()(),Z(14,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataTag=r)}),ne(),Z(15,"div",13)(16,"button",26),Ae("click",function(){return Fe(e),Re(ge(2).toggleEdit())}),Z(17,"i",27),$e(18,"settings"),ne(),$e(19,"\u5b8c\u4e86"),ne()(),rt()}if(2&t){const e=ge(2);V(5),ie("ngModel",e.sortTag),V(1),ie("ngModel",e.sortOrder),V(8),ie("ngModel",e.dataTag)}}function HH(t,n){if(1&t&&(it(0),Z(1,"span"),$e(2),ne(),rt()),2&t){const e=ge(3);V(2),Ja("",e.sortTag," (",e.sortOrderName,")")}}function VH(t,n){1&t&&(it(0),$e(1,"-"),rt())}function GH(t,n){if(1&t){const e=gt();Z(0,"label",32)(1,"input",33),Ae("ngModelChange",function(r){return Fe(e),Re(ge(3).indicateAll=r)}),ne(),Z(2,"b"),$e(3,"\u3059\u3079\u3066\u8868\u793a"),Z(4,"sup",34),$e(5,"*"),ne()()()}if(2&t){const e=ge(3);V(1),ie("ngModel",e.indicateAll)}}function qH(t,n){if(1&t){const e=gt();it(0),Z(1,"table",28)(2,"tr")(3,"th",29),$e(4,"\u4e26\u3073\u9806:"),ne(),Z(5,"td",29),Te(6,HH,3,2,"ng-container",2),Te(7,VH,2,0,"ng-container",2),ne(),Z(8,"td",30)(9,"button",26),Ae("click",function(){return Fe(e),Re(ge(2).toggleEdit())}),Z(10,"i",27),$e(11,"settings"),ne(),$e(12,"\u8a2d\u5b9a"),ne(),Te(13,GH,6,1,"label",31),ne()()(),rt()}if(2&t){const e=ge(2);V(6),ie("ngIf",0<e.sortTag.length),V(1),ie("ngIf",e.sortTag.length<1),V(6),ie("ngIf","table"===e.selectTab)}}function WH(t,n){if(1&t&&(Te(0,UH,20,3,"ng-container",2),Te(1,qH,14,3,"ng-container",2)),2&t){const e=ge();ie("ngIf",e.isEdit),V(1),ie("ngIf",!e.isEdit)}}function KH(t,n){if(1&t&&(Z(0,"i",56),vt(1,"img",57),zt(2,"safe"),ne()),2&t){const e=ge().gameObject;V(1),ie("src",jt(2,1,e.faceIcon.url,"resourceUrl"),vn)}}function YH(t,n){1&t&&(Z(0,"i",42),$e(1,"emoji_emotions"),ne())}const ZH=function(t){return{opacity:t}};function XH(t,n){if(1&t&&(Z(0,"i",56),vt(1,"img",58),zt(2,"safe"),ne()),2&t){const e=ge().gameObject;V(1),ie("ngStyle",wt(5,ZH,e.isDropShadow?.7:.3))("src",jt(2,2,e.shadowImageFile.url,"resourceUrl"),vn)}}function QH(t,n){if(1&t&&(Z(0,"i",42),$e(1),ne()),2&t){const e=ge().gameObject;V(1),dt(e.isDropShadow?"star_half":"star_border")}}function JH(t,n){if(1&t){const e=gt();Z(0,"button",59),Ae("click",function(r){Fe(e);const o=ge().gameObject;return Re(ge().onContextMenu(r,o))}),Z(1,"i",60),$e(2,"settings"),ne()()}}const eV=function(t,n,e,i){return{inverse:t,hollow:n,"is-hide-in":e,"black-paint":i}};function tV(t,n){if(1&t&&(vt(0,"img",61),zt(1,"safe")),2&t){const e=ge().gameObject;ie("src",jt(1,2,e.imageFile.url,"resourceUrl"),vn)("ngClass",Is(5,eV,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function nV(t,n){1&t&&An(0)}const iV=function(t,n){return{dataElm:t,name:n}};function rV(t,n){if(1&t&&(it(0),Te(1,nV,1,0,"ng-container",11),rt()),2&t){const e=n.$implicit,i=ge(2).gameObject;ge();const r=dn(13);V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,iV,e,i.name))}}function oV(t,n){if(1&t&&(Z(0,"div"),Te(1,rV,2,5,"ng-container",62),ne()),2&t){const e=ge().gameObject,i=ge();V(1),ie("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}const Vu=function(t){return{"is-active":t}},IS=function(t){return{"is-hide-in":t}},sV=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}};function aV(t,n){if(1&t){const e=gt();Z(0,"div",35)(1,"div",36)(2,"button",37),Ae("click",function(){const o=Fe(e).gameObject;return Re(o.isUseIconToOverviewImage=!o.isUseIconToOverviewImage)}),Te(3,KH,3,4,"i",38),Te(4,YH,2,0,"ng-template",null,39,Qn),ne(),Z(6,"span",40),$e(7),ne(),Z(8,"button",41),Ae("click",function(){const o=Fe(e).gameObject;return Re(o.isShowChatBubble=!o.isShowChatBubble)}),Z(9,"i",42),$e(10),ne()(),Z(11,"button",43),Ae("click",function(){const o=Fe(e).gameObject;return Re(o.isDropShadow=!o.isDropShadow)}),Te(12,XH,3,7,"i",38),Te(13,QH,2,1,"ng-template",null,44,Qn),ne(),Z(15,"button",45),Ae("click",function(){const o=Fe(e).gameObject;return Re(o.isNotRide=!o.isNotRide)}),Z(16,"i",42),$e(17),ne()(),Z(18,"button",46),Ae("click",function(){const o=Fe(e).gameObject;return Re(o.isAltitudeIndicate=!o.isAltitudeIndicate)}),Z(19,"i",47),$e(20,"straighten"),ne(),Z(21,"span",48),$e(22),ne()(),Z(23,"button",49),Ae("click",function(){const o=Fe(e).gameObject;return Re(o.isInventoryIndicate=!o.isInventoryIndicate)}),Z(24,"i",42),$e(25,"all_inbox"),ne()(),Te(26,JH,3,0,"button",50),ne(),Z(27,"div",51)(28,"div",52)(29,"span",53),Te(30,tV,2,10,"img",54),ne()(),Z(31,"div",55),Te(32,oV,2,2,"div",2),ne()()()}if(2&t){const e=n.gameObject,i=dn(5),r=dn(14),o=ge();V(2),ie("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(26,Vu,e.isUseIconToOverviewImage)),V(1),ie("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),V(4),dt(e.name),V(1),ie("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(28,Vu,e.isShowChatBubble)),V(2),dt(e.isShowChatBubble?"textsms":"speaker_notes_off"),V(1),ie("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(30,Vu,e.isDropShadow)),V(1),ie("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),V(3),ie("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(32,Vu,!e.isNotRide)),V(2),dt(e.isNotRide?"directions_run":"directions_bike"),V(1),ie("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(34,Vu,e.isAltitudeIndicate)),V(4),dt(e.altitude),V(1),ie("disabled",o.selectedIdentifier!==e.identifier)("ngClass",wt(36,Vu,e.isInventoryIndicate)),V(3),ie("ngIf",o.selectedIdentifier===e.identifier),V(1),ie("ngClass",wt(38,IS,e.isHideIn)),V(1),ie("ngClass",wt(40,IS,e.isHideIn)),V(1),ie("ngClass",Ms(42,sV,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),V(1),ie("ngIf",e.imageFile.url),V(2),ie("ngIf",e.rootDataElement)}}function lV(t,n){1&t&&(it(0),vt(1,"br"),rt())}function cV(t,n){if(1&t){const e=gt();it(0),Z(1,"div",68)(2,"span"),$e(3),ne()(),Z(4,"div",69)(5,"div",70)(6,"div",71)(7,"div",72),$e(8),ne(),Z(9,"input",73),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)}),ne()()()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;V(3),dt(i.name),V(5),dt(i.value),V(1),Mt("type",i.value&&i.value==+i.value?"number":"text"),ie("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}const uV=function(){return{"background-color":"green"}};function dV(t,n){if(1&t){const e=gt();it(0),Z(1,"div",74)(2,"div",75)(3,"span"),$e(4),ne()(),Z(5,"input",76),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.currentValue=r)}),ne()(),Z(6,"div",74)(7,"input",77),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.currentValue=r)}),zt(8,"safe"),ne()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;V(4),dt(i.name),V(1),ie("logging.name",r)("logging.dataElement",i)("ngModel",i.currentValue),rn("data-init-value",i.currentValue),V(2),Mr(jt(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),Mt("title",i.currentValue),Mt("max",+i.value?i.value:1e3),ie("logging.name",r)("logging.dataElement",i)("ngStyle",wa(17,uV))("ngModel",i.currentValue),rn("data-init-value",i.currentValue)}}function fV(t,n){if(1&t){const e=gt();it(0),Z(1,"div",68)(2,"span"),$e(3),ne()(),Z(4,"div",69)(5,"div",70)(6,"div",71)(7,"input",78),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)})("change",function(){Fe(e);const r=ge(2).dataElm;return Re(r.value=r.value?r.name:"")}),ne()()()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;V(1),pt("text-decoration",i.value?"none":"line-through"),V(2),dt(i.name),V(4),Mt("checked",i.value?"checked":""),ie("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}function hV(t,n){if(1&t&&(Z(0,"span",80),$e(1),ne()),2&t){const e=ge(3).dataElm;V(1),Zn("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function pV(t,n){if(1&t){const e=gt();it(0),Z(1,"div",68)(2,"span"),$e(3),ne()(),Z(4,"div",69)(5,"div",70)(6,"div",71)(7,"div",72),$e(8),ne(),Z(9,"input",73),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)}),ne(),Te(10,hV,2,1,"span",79),ne()()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;V(3),dt(i.name),V(5),dt(i.value),V(1),Mt("type",i.value&&i.value==+i.value?"number":"text"),ie("logging.name",r)("logging.dataElement",i)("ngModel",i.value),V(1),ie("ngIf",i.currentValue)}}function gV(t,n){1&t&&(Z(0,"span",84),$e(1,"\u26a0\ufe0f"),ne())}const mV=function(t,n){return{"outer-link":t,invalid:n}};function _V(t,n){if(1&t){const e=gt();it(0),Z(1,"div",68),Te(2,gV,2,0,"span",81),Z(3,"a",82),Ae("click",function(){Fe(e);const r=ge(2),o=r.dataElm,s=r.name,a=ge();return Re(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),zt(4,"safe"),Z(5,"span",83),$e(6),ne()()(),rt()}if(2&t){const e=ge(2).dataElm,i=ge();V(2),ie("ngIf",!i.stringUtil.validUrl(e.value)),V(1),ie("ngClass",fn(9,mV,!i.stringUtil.sameOrigin(e.value)&&i.stringUtil.validUrl(e.value),!i.stringUtil.validUrl(e.value))),rn("title",e.value)("href",jt(4,6,i.stringUtil.validUrl(e.value)?e.value:"","url"),vn)("disabled",i.stringUtil.validUrl(e.value)?null:""),V(3),dt(e.name)}}function $V(t,n){1&t&&An(0)}function vV(t,n){1&t&&An(0)}function bV(t,n){1&t&&An(0)}function yV(t,n){if(1&t){const e=gt();it(0),Z(1,"div",68)(2,"span"),$e(3),ne()(),Z(4,"div",69)(5,"div",70)(6,"div",71)(7,"div",72),$e(8),ne(),Z(9,"input",85),Ae("ngModelChange",function(r){return Fe(e),Re(ge(3).dataElm.value=r)}),ne()()()(),rt()}if(2&t){const e=ge(3).dataElm;V(3),dt(e.name),V(5),dt(e.value),V(1),Mt("type","size"===e.name||"altitude"===e.name?"number":"text"),Mt("min","size"===e.name?"0":""),ie("ngModel",e.value)}}function CV(t,n){if(1&t&&(it(0),Te(1,yV,10,5,"ng-container",2),rt()),2&t){const e=ge(2).dataElm;V(1),ie("ngIf",0==e.children.length)}}function xV(t,n){if(1&t&&(Z(0,"div",64),it(1,65),Te(2,cV,10,6,"ng-container",66),Te(3,dV,9,18,"ng-container",66),Te(4,fV,8,7,"ng-container",66),Te(5,pV,11,7,"ng-container",66),Te(6,_V,7,12,"ng-container",66),Te(7,$V,1,0,"ng-container",66),Te(8,vV,1,0,"ng-container",66),Te(9,bV,1,0,"ng-container",66),Te(10,CV,2,1,"ng-container",67),rt(),ne()),2&t){const e=ge().dataElm;V(1),ie("ngSwitch",e.attributes.type),V(1),ie("ngSwitchCase","simpleNumber"),V(1),ie("ngSwitchCase","numberResource"),V(1),ie("ngSwitchCase","checkProperty"),V(1),ie("ngSwitchCase","abilityScore"),V(1),ie("ngSwitchCase","url"),V(1),ie("ngSwitchCase","colors"),V(1),ie("ngSwitchCase","color"),V(1),ie("ngSwitchCase","note")}}function wV(t,n){if(1&t&&(Te(0,lV,2,0,"ng-container",2),Te(1,xV,11,9,"div",63)),2&t){const e=n.dataElm,i=ge();ie("ngIf",e&&i.newLineStrings.includes(e.name)),V(1),ie("ngIf",e&&!i.newLineStrings.includes(e.name))}}let EV=(()=>{class t{constructor(e,i,r,o,s,a){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.modalService=a,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=tt,this.sortStopTimerId=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===Lf.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineStrings(){return this.inventoryService.newLineStrings}get isGMMode(){return!!Je.myCursor&&Je.myCursor.isGMMode}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Ve.register(this).on("SELECT_TABLETOP_OBJECT",e=>{Et.instance.get(e.data.identifier)instanceof Ni&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",Lt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=Lt.peerId)}),this.inventoryTypes=["table","common",Lt.peerId,"graveyard"]}ngOnDestroy(){Ve.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case Lt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case Lt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);const r=e.target;let o;if(r&&"BUTTON"===r.tagName){const h=r.getBoundingClientRect();o={x:window.pageXOffset+h.left+r.clientWidth,y:window.pageYOffset+h.top}}else o=this.pointerDeviceService.pointers[0];let s=[];"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&Ve.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",St.play(at.piecePut),Ve.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!an.isStealthMode&&!Je.myCursor.isGMMode&&this.modalService.open(gr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Bi.OK,materialIcon:"disabled_visible"}),i.owner=Lt.peerContext.userId,St.play(at.sweep),Ve.call("UPDATE_INVENTORY",!0)}}),s.push(qt),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((h,b)=>({name:i.currntImageIndex==b?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=b,St.play(at.surprise),Ve.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==b,icon:h}))}),s.push(qt)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,Ve.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,Ve.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,Ve.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,Ve.trigger("UPDATE_INVENTORY",null)}},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,Ve.trigger("UPDATE_INVENTORY",null)}},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,Ve.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,Ve.trigger("UPDATE_INVENTORY",null)}},qt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((h,b)=>({name:`${i.aura==b?"\u25c9":"\u25cb"} ${h}`,action:()=>{i.aura=b,Ve.trigger("UPDATE_INVENTORY",null)}})))},qt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,Ve.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(qt),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,Ve.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,Ve.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&St.play(at.sweep))},altitudeHande:i}),s.push(qt),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(i)}}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(i)},disabled:"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(i)}}),s.push(qt),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(h=>{const b=h.value.toString();return{name:h.name?h.name:b,action:()=>{tt.sameOrigin(b)?window.open(b.trim(),"_blank","noopener"):this.modalService.open(co,{url:b,title:i.name,subTitle:h.name})},disabled:!tt.validUrl(b),error:tt.validUrl(b)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(b)&&!tt.sameOrigin(b)}}),disabled:i.getUrls().length<=0}),s.push(qt),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,Ve.trigger("UPDATE_INVENTORY",null)}});let a=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:Lt.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(a.find(h=>h.name==i.location.name)||a[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:a.filter((h,b)=>!(i.location.name==h.name||1==b&&!a.map(ee=>ee.name).includes(i.location.name))).map(h=>({name:`${h.alias}`,action:()=>{let b=an.isStealthMode;Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(h.name),"table"===h.name&&i.isHideIn&&i.isVisible&&!b&&!Je.myCursor.isGMMode&&this.modalService.open(gr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Bi.OK,materialIcon:"disabled_visible"}),St.play("graveyard"==h.name?at.sweep:at.piecePut),Ve.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(qt),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),St.play(at.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const h=i.clone(),b=h.name.split("_");let ee;ee=b.length>1&&/\d+/.test(b[b.length-1])?b.slice(0,b.length-1).join("_"):b.join("_");let de=0;for(const _e of Et.instance.getObjects(an)){if(!_e.name.startsWith(ee))continue;let Ce=_e.name.match(/_(\d+)$/)?+RegExp.$1:0;Ce>de&&(de=Ce)}h.name=ee+"_"+(de+1),h.update(),St.play(at.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(qt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.deleteGameObject(i),St.play(at.sweep)}})):(s.push(qt),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("graveyard"),St.play(at.sweep)}})),this.contextMenuService.open(o,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(gr,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${tt.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:Bi.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);St.play(at.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Hu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0})}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||Ve.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x,y:e.location.y,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Bf,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return tt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(co,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ki),Ge(Wn),Ge(Ev),Ge(pr),Ge(vi),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[1,"object-container",3,"ngClass","contextmenu","click","dblclick"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModel","ngModelChange"],[1,"order-control",3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap",""],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em","pointer-events","none"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"logging.name","logging.dataElement","type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"logging.name","logging.dataElement","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","title","max","ngStyle","ngModel","ngModelChange"],["appLogging","","type","checkbox",3,"logging.name","logging.dataElement","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059",4,"ngIf"],["draggable","false","target","_blank",3,"ngClass","click"],[1,"url-link"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"type","min","ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(Z(0,"div",0),Ae("input",function(){return i.onInput()}),Te(1,DH,1,0,"ng-container",1),Te(2,AH,1,0,"ng-container",1),Te(3,PH,2,1,"div",2),Te(4,LH,3,10,"div",3),Te(5,BH,3,1,"div",4),ne(),Te(6,jH,3,1,"ng-template",null,5,Qn),Te(8,WH,2,2,"ng-template",null,6,Qn),Te(10,aV,33,51,"ng-template",null,7,Qn),Te(12,wV,2,2,"ng-template",null,8,Qn)),2&e){const r=dn(7),o=dn(9);V(1),ie("ngTemplateOutlet",r),V(1),ie("ngTemplateOutlet",o),V(1),ie("ngIf",i.getGameObjects(i.selectTab).length<1),V(1),ie("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),V(1),ie("ngIf","graveyard"===i.selectTab)}},dependencies:[oi,$i,Rn,tl,hr,Jl,Qd,Jd,nc,so,ao,Ii,Ro,Lo,Fo,vo,sl,Mi,tc,Ci,Ma,fs,_i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:-moz-min-content;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:inherit}"],changeDetection:0}),t})();const TV=sn.create("./assets/images/skeleton.png");let Gu=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof sn?e:Kt.instance.get(e);return i&&!i.isEmpty?i:TV}getEmptyOr(e){let i=e instanceof sn?e:Kt.instance.get(e);return i&&!i.isEmpty?i:sn.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function SV(t,n){if(1&t&&(Z(0,"option",11),$e(1),ne()),2&t){const e=n.$implicit;pt("color",""==e.name?"gray":""),Mt("value",e.identifier),Mt("title",e.name),V(1),dt(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function IV(t,n){if(1&t&&(Z(0,"div",41)(1,"i",42),$e(2),ne()()),2&t){const e=ge(2);V(1),Od(e.isShowHideImages?"red-eye":"grow"),V(1),dt(e.isShowHideImages?"visibility":"visibility_off")}}function MV(t,n){if(1&t){const e=gt();Z(0,"div")(1,"button",43),Ae("click",function(){return Fe(e),Re(ge(2).openDistanceViewImageModal())}),$e(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),ne()()}if(2&t){const e=ge(2);V(1),ie("disabled",!e.isEditable)}}function kV(t,n){if(1&t&&(Z(0,"div",41)(1,"i",42),$e(2),ne()()),2&t){const e=ge(3);V(1),Od(e.isShowHideImages?"red-eye":"grow"),V(1),dt(e.isShowHideImages?"visibility":"visibility_off")}}const MS=function(t){return{blackout:t}};function DV(t,n){if(1&t){const e=gt();Z(0,"div",13),Ae("click",function(){return Fe(e),Re(ge(2).openDistanceViewImageModal())}),Te(1,kV,3,3,"div",14),vt(2,"img",15),zt(3,"safe"),ne()}if(2&t){const e=ge(2);V(1),ie("ngIf",e.getHidden(e.tableDistanceviewImage)),V(1),ie("ngClass",wt(6,MS,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",jt(3,3,e.tableDistanceviewImage.url,"resourceUrl"),vn)}}function AV(t,n){if(1&t&&(Z(0,"div",48),$e(1),ne()),2&t){const e=ge(3);V(1),Zn("",e.progresPercent,"%")}}const PV=function(t){return{"is-hidden":t}};function NV(t,n){if(1&t){const e=gt();it(0),Z(1,"button",44),Ae("click",function(){return Fe(e),Re(ge(2).save())}),Z(2,"div",45)(3,"div",32),$e(4,"\u4fdd\u5b58"),ne(),Te(5,AV,2,1,"div",46),ne()(),Z(6,"button",47),Ae("click",function(){return Fe(e),Re(ge(2).delete())}),$e(7,"\u524a\u9664"),ne(),rt()}if(2&t){const e=ge(2);V(1),ie("disabled",e.isSaveing),V(2),ie("ngClass",wt(4,PV,e.isSaveing)),V(2),ie("ngIf",e.isSaveing),V(1),ie("disabled",e.getGameTables().length<=1)}}function OV(t,n){if(1&t){const e=gt();it(0),Z(1,"button",49),Ae("click",function(){return Fe(e),Re(ge(2).restore())}),$e(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}const FV=function(t){return{disabled:t}};function RV(t,n){if(1&t){const e=gt();it(0),Z(1,"div",12)(2,"div")(3,"b"),$e(4,"\u753b\u50cf"),ne(),Z(5,"div",13),Ae("click",function(){return Fe(e),Re(ge().openBgImageModal())}),Te(6,IV,3,3,"div",14),vt(7,"img",15),zt(8,"safe"),ne()(),Z(9,"div")(10,"b"),$e(11,"\u80cc\u666f"),ne(),Te(12,MV,3,1,"div",10),Te(13,DV,4,8,"div",16),ne()(),Z(14,"div")(15,"label",17),$e(16,"Name\uff1a"),Z(17,"input",18),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableName=r)}),ne()()(),Z(18,"div")(19,"label",17),$e(20,"Width\uff1a"),Z(21,"input",19),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableWidth=r)}),ne()(),Z(22,"input",20),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableWidth=r)}),ne()(),Z(23,"div")(24,"label",17),$e(25,"Height\uff1a"),Z(26,"input",21),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableHeight=r)}),ne()(),Z(27,"input",20),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableHeight=r)}),ne()(),Z(28,"div")(29,"label",17),$e(30,"\u30b0\u30ea\u30c3\u30c9\uff1a "),Z(31,"select",22),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableGridType=r)}),Z(32,"option",23),$e(33,"\u306a\u3057"),ne(),Z(34,"option",24),$e(35,"\u30b9\u30af\u30a8\u30a2"),ne(),Z(36,"option",25),$e(37,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),ne(),Z(38,"option",26),$e(39,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),ne()()(),Z(40,"label",27),$e(41,"\u8272\uff1a "),Z(42,"select",28),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableGridColor=r)}),Z(43,"option",29),$e(44,"\u9ed2"),ne(),Z(45,"option",30),$e(46,"\u767d"),ne()()()(),Z(47,"div")(48,"label",17)(49,"input",31),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableGridNumberShow=r)}),ne(),Z(50,"span",32),$e(51,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),ne()()(),Z(52,"div")(53,"label",17),$e(54,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),Z(55,"select",33),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableDistanceviewFilter=r)}),Z(56,"option",34),$e(57,"\u306a\u3057"),ne(),Z(58,"option",35),$e(59,"\u30db\u30ef\u30a4\u30c8"),ne(),Z(60,"option",36),$e(61,"\u30d6\u30e9\u30c3\u30af"),ne()()()(),vt(62,"hr"),Z(63,"div")(64,"label",17)(65,"input",37),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableGridShow=r)}),ne(),$e(66," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),Z(67,"sup",38),$e(68,"*"),ne()(),Z(69,"label",39)(70,"input",40),Ae("ngModelChange",function(r){return Fe(e),Re(ge().tableGridSnap=r)}),ne(),$e(71," \u30b9\u30ca\u30c3\u30d7"),Z(72,"sup",38),$e(73,"*"),ne()(),Te(74,NV,8,6,"ng-container",10),Te(75,OV,3,0,"ng-container",10),ne(),rt()}if(2&t){const e=ge();V(6),ie("ngIf",e.getHidden(e.tableBackgroundImage)),V(1),ie("ngClass",wt(41,MS,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",jt(8,38,e.tableBackgroundImage.url,"resourceUrl"),vn),V(5),ie("ngIf",!e.tableDistanceviewImage.url),V(1),ie("ngIf",e.tableDistanceviewImage.url),V(4),ie("ngModel",e.tableName)("disabled",!e.isEditable),V(4),Mt("title",e.tableWidth),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.tableWidth)("disabled",!e.isEditable),V(1),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.tableWidth)("disabled",!e.isEditable),V(4),Mt("title",e.tableHeight),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.tableHeight)("disabled",!e.isEditable),V(1),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.tableHeight)("disabled",!e.isEditable),V(4),ie("ngModel",e.tableGridType)("disabled",!e.isEditable),V(11),ie("ngModel",e.tableGridColor)("disabled",!e.isEditable||-1==e.tableGridType),V(7),ie("ngModel",e.tableGridNumberShow)("disabled",!e.isEditable||-1==e.tableGridType),V(1),ie("ngClass",wt(43,FV,!e.isEditable||-1==e.tableGridType)),V(5),ie("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),V(10),ie("ngModel",e.tableGridShow),V(5),ie("ngModel",e.tableGridSnap),V(4),ie("ngIf",!e.isDeleted),V(1),ie("ngIf",e.isDeleted)}}function LV(t,n){1&t&&(it(0),Z(1,"div",50),$e(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),ne(),rt())}const BV=function(t){return{"red-eye":t}};let kS=(()=>{class t{constructor(e,i,r,o,s){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=o,this.panelService=s,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,Ve.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,Ve.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Sr.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==Et.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,Ve.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=Et.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Ve.unregister(this)}selectGameTable(e){Ve.call("SELECT_GAME_TABLE",{identifier:e},Lt.peerId),this.selectedTable=Et.instance.get(e),this.selectedTableXml=""}getGameTables(){return Et.instance.getObjects(rr)}createGameTable(){let e=new rr;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,hn.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=gi.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=Vn.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(da,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(da,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(gr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Bi.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ki),Ge(Yn),Ge(qr),Ge(Gu),Ge(Wn))},t.\u0275cmp=mn({type:t,selectors:[["game-table-setting"]],decls:15,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin-bottom","2px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","155px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"position","relative","overflow","hidden","cursor","pointer",3,"click"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"ngClass","src"],["style","position: relative; overflow: hidden; cursor: pointer",3,"click",4,"ngIf"],[1,"self-setting"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"margin-left","3px"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["type","checkbox","name","tableGridNumberShow",3,"ngModel","disabled","ngModelChange"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px",3,"disabled","click"],[2,"margin-left","2em",3,"disabled","click"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.createGameTable()}),$e(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),ne()(),Z(5,"select",3),Ae("change",function(o){return i.selectGameTable(o.target.value)}),Te(6,SV,2,5,"option",4),ne()(),Z(7,"div",5)(8,"div",6)(9,"label",7)(10,"input",8),Ae("click",function(o){return i.onShowHiddenImages(o)}),ne(),Z(11,"i",9),$e(12),ne()()(),Te(13,RV,76,45,"ng-container",10),ne()(),Te(14,LV,3,0,"ng-container",10)),2&e&&(V(5),ie("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),V(1),ie("ngForOf",i.getGameTables()),V(4),Mt("checked",i.isShowHideImages?"checked":""),V(1),ie("ngClass",wt(7,BV,i.isShowHideImages)),V(1),dt(i.isShowHideImages?"visibility":"visibility_off"),V(1),ie("ngIf",!i.isEmpty||i.selectedTable),V(1),ie("ngIf",i.isEmpty))},dependencies:[oi,$i,Rn,so,ao,Ii,Ro,Lo,Fo,vo,Mi,Ys,Ks,Ci,_i],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]}),t})();function zV(t,n){if(1&t){const e=gt();Z(0,"button",33),Ae("click",function(){Fe(e);const r=ge().$implicit;return Re(ge().play(r))}),Z(1,"i",34),$e(2,"play_arrow"),ne(),$e(3,"\u8a66\u8074"),Z(4,"sup",27),$e(5,"*"),ne()()}2&t&&ie("disabled",!ge().$implicit.isReady)}function jV(t,n){if(1&t){const e=gt();Z(0,"button",33),Ae("click",function(){return Fe(e),Re(ge(2).stop())}),Z(1,"i",34),$e(2,"stop"),ne(),$e(3,"\u8a66\u8074"),Z(4,"sup",27),$e(5,"*"),ne()()}2&t&&ie("disabled",!ge().$implicit.isReady)}function UV(t,n){if(1&t){const e=gt();Z(0,"button",33),Ae("click",function(){Fe(e);const r=ge().$implicit;return Re(ge().playBGM(r))}),Z(1,"i",34),$e(2,"loop"),ne(),$e(3,"\uff22\uff27\uff2d"),ne()}2&t&&ie("disabled",!ge().$implicit.isReady)}function HV(t,n){if(1&t){const e=gt();Z(0,"button",33),Ae("click",function(){Fe(e);const r=ge().$implicit;return Re(ge().stopBGM(r))}),Z(1,"i",34),$e(2,"stop"),ne(),$e(3,"\uff22\uff27\uff2d"),ne()}2&t&&ie("disabled",!ge().$implicit.isReady)}function VV(t,n){1&t&&(Z(0,"span",32)(1,"b"),$e(2,"\u3010\u8a66\u8074\u4e2d\u3011"),ne()())}function GV(t,n){1&t&&(Z(0,"span",32)(1,"i",35),$e(2,"volume_up"),ne()())}function qV(t,n){1&t&&(Z(0,"span",32)(1,"i",35),$e(2,"volume_up"),ne(),Z(3,"b"),$e(4,"\u3010\u8a66\u8074\u4e2d\u3011"),ne()())}function WV(t,n){if(1&t&&(it(0),Te(1,GV,3,0,"span",30),Te(2,qV,5,0,"span",30),rt()),2&t){const e=ge().$implicit,i=ge();V(1),ie("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),V(1),ie("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}const KV=function(t){return{last:t}};function YV(t,n){if(1&t&&(Z(0,"div",28),Te(1,zV,6,1,"button",29),Te(2,jV,6,1,"button",29),Te(3,UV,4,1,"button",29),Te(4,HV,4,1,"button",29),Te(5,VV,3,0,"span",30),Te(6,WV,3,2,"ng-container",31),Z(7,"span",32),$e(8),ne()()),2&t){const e=n.$implicit,i=n.last,r=ge();ie("ngClass",wt(10,KV,i)),V(1),ie("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),V(1),ie("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),V(1),ie("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),V(1),ie("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),V(1),ie("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),V(1),ie("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),V(1),pt("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),V(1),dt(e.name)}}function ZV(t,n){1&t&&(Z(0,"div",36)(1,"small")(2,"b"),$e(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),ne()()())}let XV=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.ngZone=r,this.contextMenuService=o,this.auditionPlayer=new st,this.lazyUpdateTimer=null,this.soundTestPlayer=new st,this.noticeTestPlayer=new st,this.soundTestPlayer.volumeType=Go.SOUND_EFFECT,this.noticeTestPlayer.volumeType=Go.NOTICE}get isMute(){return st.isMute}set isMute(e){st.isMute=e,Ve.trigger("CHANGE_JUKEBOX_VOLUME",null),e?Nn.setItem(st.MAIN_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Nn.removeItem(st.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get volume(){return st.volume}set volume(e){this.isMute=0==e,st.volume=e,Ve.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==st.volume?Nn.removeItem(st.MAIN_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Nn.setItem(st.MAIN_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isAuditionMute(){return st.isAuditionMute}set isAuditionMute(e){st.isAuditionMute=e,Ve.trigger("CHANGE_JUKEBOX_VOLUME",null),e?Nn.setItem(st.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Nn.removeItem(st.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get auditionVolume(){return st.auditionVolume}set auditionVolume(e){this.isAuditionMute=0==e,st.auditionVolume=e,Ve.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==st.auditionVolume?Nn.removeItem(st.AUDITION_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Nn.setItem(st.AUDITION_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isSoundEffectMute(){return st.isSoundEffectMute}set isSoundEffectMute(e){st.isSoundEffectMute=e,e?Nn.setItem(st.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Nn.removeItem(st.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get soundEffectVolume(){return st.soundEffectVolume}set soundEffectVolume(e){this.isSoundEffectMute=0==e,st.soundEffectVolume=e,.5==st.soundEffectVolume?Nn.removeItem(st.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Nn.setItem(st.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isNoticeMute(){return st.isNoticeMute}set isNoticeMute(e){st.isNoticeMute=e,e?Nn.setItem(st.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Nn.removeItem(st.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get noticeVolume(){return st.noticeVolume}set noticeVolume(e){this.isNoticeMute=0==e,st.noticeVolume=e,.5==st.noticeVolume?Nn.removeItem(st.NOTICE_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Nn.setItem(st.NOTICE_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return Et.instance.get("Jukebox")}get percentVolume(){return Math.floor(100*this.volume)}set percentVolume(e){this.volume=e/100}get percentAuditionVolume(){return Math.floor(100*this.auditionVolume)}set percentAuditionVolume(e){this.auditionVolume=e/100}get percentSoundEffectVolume(){return Math.floor(100*this.soundEffectVolume)}set percentSoundEffectVolume(e){this.soundEffectVolume=e/100}get percentNoticeVolume(){return Math.floor(100*this.noticeVolume)}set percentNoticeVolume(e){this.noticeVolume=e/100}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Go.AUDITION,Ve.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Ve.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&sa.instance.load(r),i.value=""}noticeTest(e=at.puyon){const i=Jt.instance.get(e);i&&i.isReady&&this.noticeTestPlayer.play(i)}soundTest(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+i.clientWidth,y:window.pageYOffset+r.top};this.contextMenuService.open(o,[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30fb\u5730\u5f62",subActions:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u79fb\u52d5\u958b\u59cb",action:()=>{this.playSETest(at.piecePick)}},{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u7f6e\u304f",action:()=>{this.playSETest(at.piecePut)}},{name:"\u5730\u5f62\u306e\u79fb\u52d5\u958b\u59cb\uff0f\u7d42\u4e86",action:()=>{this.playSETest(at.blockPick)}}]},{name:"\u30c0\u30a4\u30b9\u30fb\u30b3\u30a4\u30f3",subActions:[{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u53d6\u308b",action:()=>{this.playSETest(at.dicePick)}},{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u7f6e\u304f",action:()=>{this.playSETest(at.dicePut)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff11",action:()=>{this.playSETest(at.diceRoll1)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff12",action:()=>{this.playSETest(at.diceRoll2)}},{name:"\u30b3\u30a4\u30f3\u30c8\u30b9",action:()=>{this.playSETest(at.coinToss)}}]},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d",subActions:[{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f\uff0f\u88cf\u8fd4\u3059",action:()=>{this.playSETest(at.cardDraw)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u53d6\u308b",action:()=>{this.playSETest(at.cardPick)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u7f6e\u304f",action:()=>{this.playSETest(at.cardPut)}},{name:"\u5c71\u672d\u3092\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.playSETest(at.cardShuffle)}}]},{name:"\u305d\u306e\u4ed6",subActions:[{name:"\u56fa\u5b9a\u30fb\u30ed\u30c3\u30af\uff0f\u89e3\u9664",action:()=>{this.playSETest(at.lock)}},{name:"\u843d\u4e0b\uff0f\u53d6\u308a\u9664\u304f\uff0f\u524a\u9664",action:()=>{this.playSETest(at.sweep)}},{name:"\u5909\u8eab\uff01",action:()=>{this.playSETest(at.surprise)}}]}],"SE\u30c6\u30b9\u30c8")}playSETest(e){const i=Jt.instance.get(e);i&&i.isReady?(Ve.unregister(this,"UPDATE_AUDIO_RESOURE"),this.isSoundEffectMute||this.soundTestPlayer.play(i)):Ve.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.playSETest(e)})}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(Ge(Yn),Ge(Wn),Ge(Fn),Ge(pr))},t.\u0275cmp=mn({type:t,selectors:[["app-jukebox"]],decls:118,vars:22,consts:[[2,"margin-bottom","2px","min-height","4em"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[1,"self-only"],[2,"font-size","12px"],[2,"font-size","12px","margin-bottom","8px"],[1,"footer",2,"position","sticky","bottom","0px","padding","2px 0px 0px 3px"],[2,"display","flex"],[2,"flex-basis","auto"],[2,"white-space","nowrap"],[1,"button-mute",3,"title","click"],[1,"material-icons",2,"font-size","22px"],[2,"flex-basis","100%","max-width","250px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModel","title","ngModelChange"],[2,"flex-basis","auto","padding-right","1em"],[2,"white-space","nowrap","padding-left","4px"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","3px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModel","title","ngModelChange","change"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"ngModel","change","ngModelChange"],[2,"display","flex","justify-content","space-between","padding-bottom","2px"],[2,"font-size","xx-small","font-weight","bolder","margin-right","2em","white-space","nowrap",3,"click"],[1,"self-only",2,"font-size","larger"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"disabled","click"],[1,"material-icons"],[1,"material-icons",2,"font-size","16px","vertical-align","middle"],[2,"padding","1em 0px","text-align","center"]],template:function(e,i){1&e&&(Z(0,"div",0),Te(1,YV,9,12,"div",1),Te(2,ZV,4,0,"div",2),ne(),Z(3,"label")(4,"div",3)(5,"div")(6,"i",4),$e(7,"playlist_add"),ne()(),Z(8,"div"),$e(9,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),ne(),Z(10,"div",5),$e(11,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ne(),Z(12,"input",6),Ae("change",function(o){return i.handleFileSelect(o)}),ne(),Z(13,"div",5),vt(14,"br"),$e(15,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),ne()()(),Z(16,"div",7),$e(17,"\u203b "),Z(18,"b"),$e(19,"\u8a66\u8074"),Z(20,"sup",8),$e(21,"*"),ne()(),$e(22,"\u3001"),Z(23,"b"),$e(24,"SE\u30c6\u30b9\u30c8"),Z(25,"sup",8),$e(26,"*"),ne()(),$e(27," \u306f\u81ea\u5206\u306e\u74b0\u5883\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),ne(),Z(28,"div",9),$e(29,"\u203b "),Z(30,"b"),$e(31,"BGM"),ne(),$e(32," \u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),ne(),Z(33,"div",10),$e(34,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),ne(),Z(35,"div",11)(36,"div",12)(37,"div",13)(38,"b",14),$e(39,"\u8a66\u8074\u97f3\u91cf"),Z(40,"sup",8),$e(41,"*"),ne(),$e(42,"\uff1a"),ne()(),Z(43,"div",13)(44,"button",15),Ae("click",function(){return i.isAuditionMute=!i.isAuditionMute}),Z(45,"i",16),$e(46),ne()()(),Z(47,"div",17)(48,"input",18),Ae("ngModelChange",function(o){return i.auditionVolume=o}),ne()(),Z(49,"div",19)(50,"span",20)(51,"input",21),Ae("ngModelChange",function(o){return i.percentAuditionVolume=o}),ne(),Z(52,"b",22),$e(53,"%"),ne()()()(),Z(54,"div",12)(55,"div",13)(56,"b",14),$e(57,"\u518d\u751f\u97f3\u91cf"),Z(58,"sup",8),$e(59,"*"),ne(),$e(60,"\uff1a"),ne()(),Z(61,"div",13)(62,"button",15),Ae("click",function(){return i.isMute=!i.isMute}),Z(63,"i",16),$e(64),ne()()(),Z(65,"div",17)(66,"input",18),Ae("ngModelChange",function(o){return i.volume=o}),ne()(),Z(67,"div",19)(68,"span",20)(69,"input",21),Ae("ngModelChange",function(o){return i.percentVolume=o}),ne(),Z(70,"b",22),$e(71,"%"),ne()()()(),vt(72,"hr"),Z(73,"div",12)(74,"div",13)(75,"b",14),$e(76,"\u901a\u77e5\u97f3\u91cf"),Z(77,"sup",8),$e(78,"*"),ne(),$e(79,"\uff1a"),ne()(),Z(80,"div",13)(81,"button",15),Ae("click",function(){return i.isNoticeMute=!i.isNoticeMute}),Z(82,"i",16),$e(83),ne()()(),Z(84,"div",17)(85,"input",23),Ae("ngModelChange",function(o){return i.noticeVolume=o})("change",function(){return i.noticeTest()}),ne()(),Z(86,"div",19)(87,"span",20)(88,"input",24),Ae("change",function(){return i.noticeTest()})("ngModelChange",function(o){return i.percentNoticeVolume=o}),ne(),Z(89,"b",22),$e(90,"%"),ne()()()(),Z(91,"div",12)(92,"div",13)(93,"b",14),$e(94,"\uff33\uff25\u97f3\u91cf"),Z(95,"sup",8),$e(96,"*"),ne(),$e(97,"\uff1a"),ne()(),Z(98,"div",13)(99,"button",15),Ae("click",function(){return i.isSoundEffectMute=!i.isSoundEffectMute}),Z(100,"i",16),$e(101),ne()()(),Z(102,"div",17)(103,"input",18),Ae("ngModelChange",function(o){return i.soundEffectVolume=o}),ne()(),Z(104,"div",19)(105,"span",20)(106,"input",21),Ae("ngModelChange",function(o){return i.percentSoundEffectVolume=o}),ne(),Z(107,"b",22),$e(108,"%"),ne()()()(),Z(109,"div",25)(110,"div")(111,"small"),$e(112,"\u203b\u8a2d\u5b9a\u3057\u305f\u97f3\u91cf\u306f\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),ne()(),Z(113,"div")(114,"button",26),Ae("click",function(o){return i.soundTest(o)}),$e(115,"\uff33\uff25\u30c6\u30b9\u30c8"),Z(116,"sup",27),$e(117,"*"),ne()()()()()),2&e&&(V(1),ie("ngForOf",i.audios),V(1),ie("ngIf",i.audios.length<1),V(42),ie("title",i.isAuditionMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),V(2),dt(i.isAuditionMute?"volume_off":0==i.auditionVolume?"volume_mute":i.auditionVolume<=.5?"volume_down":"volume_up"),V(2),ie("ngModel",i.auditionVolume)("title",i.isAuditionMute?"":i.percentAuditionVolume+"%"),V(3),ie("ngModel",i.percentAuditionVolume),V(11),ie("title",i.isMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),V(2),dt(i.isMute?"volume_off":0==i.volume?"volume_mute":i.volume<=.5?"volume_down":"volume_up"),V(2),ie("ngModel",i.volume)("title",i.isMute?"":i.percentVolume+"%"),V(3),ie("ngModel",i.percentVolume),V(12),ie("title",i.isNoticeMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),V(2),dt(i.isNoticeMute?"volume_off":0==i.noticeVolume?"volume_mute":i.noticeVolume<=.5?"volume_down":"volume_up"),V(2),ie("ngModel",i.noticeVolume)("title",i.isNoticeMute?"":i.percentNoticeVolume+"%"),V(3),ie("ngModel",i.percentNoticeVolume),V(11),ie("title",i.isSoundEffectMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),V(2),dt(i.isSoundEffectMute?"volume_off":0==i.soundEffectVolume?"volume_mute":i.soundEffectVolume<=.5?"volume_down":"volume_up"),V(2),ie("ngModel",i.soundEffectVolume)("title",i.isSoundEffectMute?"":i.percentSoundEffectVolume+"%"),V(3),ie("ngModel",i.percentSoundEffectVolume))},dependencies:[oi,$i,Rn,Ii,Ro,Lo,Mi,Ys,Ks,Ci],styles:['[_nghost-%COMP%]{display:block;height:100%}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.footer[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-top:dotted 1px #888}.button-mute[_ngcontent-%COMP%]{box-sizing:border-box;width:25px;height:25px;padding:1px;display:inline-block;background-color:transparent;border-color:transparent}.button-mute[_ngcontent-%COMP%]::-moz-selection{background-color:#666;border-color:#ccc;color:snow}.button-mute[_ngcontent-%COMP%]:hover, .button-mute[_ngcontent-%COMP%]:active, .button-mute[_ngcontent-%COMP%]::selection{background-color:#666;border-color:#ccc;color:snow}']}),t})();const QV=["content"],JV=["*"];let eG=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&Tn(QV,7,io),2&e){let r;En(r=Sn())&&(i.content=r.first)}},ngContentSelectors:JV,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(N_(),Z(0,"div",0)(1,"div",1),Ae("click",function(o){return i.clickBackground(o)}),ne(),Z(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Ae("click",function(){return i.resolve()}),Z(6,"i",6),$e(7,"close"),ne()()(),$e(8),ne(),Z(9,"div",7),O_(10),vt(11,"div",null,8),ne()()()),2&e&&(V(1),ie("@bgInOut","in"),V(1),ie("@flyInOut","in"),V(6),Zn(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[Hn("flyInOut",[en("void => *",[Qt("100ms ease-out",Cn([ht({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),ht({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale(0, 0)"}))])]),Hn("bgInOut",[Fp("in",ht({"background-color":"rgba(30, 30, 30, 0.4)"})),en("void => *",[ht({"background-color":"rgba(30, 30, 30, 0.0)"}),Qt(200)]),en("* => void",[Qt(200,ht({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();const tG=["passwordInput"],nG=function(){return{standalone:!0}};let iG=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=ki.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return Lt.peerId}get isConnected(){return!(Lt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),Ve.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Ve.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&Tn(tG,7),2&e){let r;En(r=Sn())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Z(0,"form",null,0)(2,"div"),$e(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Z(4,"input",1,2),Ae("ngModelChange",function(o){return i.password=o})("input",function(o){return i.onInputChange(o.target.value)}),ne()(),Z(6,"button",3),Ae("click",function(){return i.submit()}),$e(7,"\u5165\u5ba4"),ne()(),Z(8,"div")(9,"span",4),$e(10),ne()()),2&e&&(V(4),ie("ngModel",i.password)("ngModelOptions",wa(3,nG)),V(6),dt(i.help))},dependencies:[nc,Ii,Mi,tc,Ci,Ma],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function rG(t,n){if(1&t&&(Z(0,"div")(1,"div",9),$e(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ne(),Z(3,"div",9),$e(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),ne(),Z(5,"div",9),$e(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ne()()),2&t){ge();const e=dn(4);V(1),ie("hidden",!e.errors.required),V(2),ie("hidden",!e.errors.minlength),V(2),ie("hidden",!e.errors.maxlength)}}function oG(t,n){if(1&t&&(Z(0,"div")(1,"div",9),$e(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),ne()()),2&t){ge();const e=dn(8);V(1),ie("hidden",!e.errors.maxlength)}}function sG(t,n){1&t&&(Z(0,"div"),$e(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),ne())}function aG(t,n){if(1&t){const e=gt();Z(0,"div")(1,"div"),$e(2,"\u30eb\u30fc\u30e0\u540d : "),Z(3,"input",3,4),Ae("input",function(r){Fe(e);const o=ge();return Re(o.calcPeerId(r.target.value,o.password))})("ngModelChange",function(r){return Fe(e),Re(ge().roomName=r)}),ne()(),Z(5,"div"),$e(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Z(7,"input",5,6),Ae("input",function(r){Fe(e);const o=ge();return Re(o.calcPeerId(o.roomName,r.target.value))})("ngModelChange",function(r){return Fe(e),Re(ge().password=r)}),ne()(),vt(9,"hr"),Te(10,rG,7,3,"div",7),Te(11,oG,3,1,"div",7),Te(12,sG,2,0,"div",7),Z(13,"div")(14,"button",8),Ae("click",function(){return Fe(e),Re(ge().createRoom())}),$e(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),ne()()()}if(2&t){const e=dn(4),i=dn(8),r=ge();V(3),ie("ngModel",r.roomName),V(4),ie("ngModel",r.password),V(3),ie("ngIf",e.errors&&(e.dirty||e.touched)),V(1),ie("ngIf",i.errors&&(i.dirty||i.touched)),V(1),ie("ngIf",!r.validateLength),V(2),ie("disabled",!e.valid||!i.valid||!r.validateLength)}}function lG(t,n){1&t&&(Z(0,"span",1),$e(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),vt(2,"br"),$e(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),vt(4,"br"),$e(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ne())}let cG=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return Lt.peerId}get isConnected(){return!(Lt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Ve.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Ve.unregister(this)}calcPeerId(e,i){let r=Lt.peerContext?Lt.peerContext.userId:ki.generateId(),o=ki.create(r,ki.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){let e=Lt.peerContext?Lt.peerContext.userId:ki.generateId();Lt.open(e,ki.generateId("***"),this.roomName,this.password),Je.myCursor.peerId=Lt.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(Te(0,aG,16,6,"div",0),Z(1,"div")(2,"span",1),$e(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ne()(),Te(4,lG,6,0,"ng-template",null,2,Qn)),2&e){const r=dn(5);ie("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[Rn,Ii,Mi,Op,n0,r0,Ci],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function uG(t,n){1&t&&(Z(0,"td")(1,"i",11),$e(2,"lock"),ne()())}function dG(t,n){1&t&&(Z(0,"td"),$e(1,"-"),ne())}function fG(t,n){if(1&t){const e=gt();Z(0,"button",12),Ae("click",function(){Fe(e);const r=ge().$implicit;return Re(ge(3).connect(r.peerContexts))}),$e(1,"\u63a5\u7d9a"),ne()}if(2&t){const e=ge().$implicit,i=ge(3);ie("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function hG(t,n){if(1&t&&(it(0),Z(1,"tr")(2,"td",9),$e(3),ne(),Z(4,"td",7),$e(5),ne(),Te(6,uG,3,0,"td",4),Te(7,dG,2,0,"td",4),Z(8,"td"),$e(9),ne(),Z(10,"td"),Te(11,fG,2,1,"button",10),ne()(),rt()),2&t){const e=n.$implicit;V(3),dt(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),V(2),dt(e.roomName),V(1),ie("ngIf",e.peerContexts[0].hasPassword),V(1),ie("ngIf",!e.peerContexts[0].hasPassword),V(2),Zn("",e.peerContexts.length,"\u4eba"),V(2),ie("ngIf",0<e.alias.length)}}function pG(t,n){if(1&t&&(it(0),Z(1,"table",6)(2,"tr")(3,"th"),$e(4,"\u30eb\u30fc\u30e0ID"),ne(),Z(5,"th",7),$e(6,"\u30eb\u30fc\u30e0\u540d"),ne(),Z(7,"th"),$e(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),ne(),Z(9,"th"),$e(10,"\u53c2\u52a0\u8005"),ne(),vt(11,"th"),ne(),Te(12,hG,12,6,"ng-container",8),ne(),rt()),2&t){const e=ge(2);V(12),ie("ngForOf",e.rooms)}}function gG(t,n){if(1&t&&(Z(0,"span",13),$e(1),ne()),2&t){const e=ge(2);V(1),dt(e.help)}}function mG(t,n){if(1&t){const e=gt();Z(0,"div")(1,"button",2),Ae("click",function(){return Fe(e),Re(ge().reload())}),$e(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),ne(),Z(3,"button",3),Ae("click",function(){return Fe(e),Re(ge().showRoomSetting())}),$e(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),ne(),vt(5,"hr"),Te(6,pG,13,1,"ng-container",4),Te(7,gG,2,1,"span",5),ne()}if(2&t){const e=ge();V(1),ie("disabled",e.isReloading),V(5),ie("ngIf",e.rooms.length),V(1),ie("ngIf",e.rooms.length<1)}}function _G(t,n){1&t&&(Z(0,"span",13),$e(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),vt(2,"br"),$e(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),ne())}let $G=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return Lt.peerContext.roomId}get peerId(){return Lt.peerId}get isConnected(){return!(Lt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Ve.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",Lt.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+Lt.peerContext.roomName+"/"+Lt.peerContext.roomId+"\u3009")}ngOnDestroy(){Ve.unregister(this)}reload(){var e=this;return(0,hn.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield Lt.listAllPeers();for(let o of r){let s=ki.parse(o);if(s.isRoom){let a=s.roomId+s.roomName;a in i||(i[a]=[]),i[a].push(s)}}for(let o in i)e.rooms.push({alias:o,roomName:i[o][0].roomName,peerContexts:i[o]});e.rooms.sort((o,s)=>o.alias<s.alias?-1:o.alias>s.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,hn.Z)(function*(){let r=e[0],o="";if(r.hasPassword&&(o=yield i.modalService.open(iG,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==o&&(o="")),!r.verifyPassword(o))return;let s=Lt.peerContext?Lt.peerContext.userId:ki.generateId();Lt.open(s,r.roomId,r.roomName,o),Je.myCursor.peerId=Lt.peerId;let a=[];Ve.register(a).on("OPEN_NETWORK",h=>{console.log("LobbyComponent OPEN_PEER",h.data.peerId),Ve.unregister(a),Et.instance.clearDeleteHistory();for(let b of e)Lt.connect(b.peerId);Ve.register(a).on("CONNECT_PEER",b=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",b.data.peerId),a.push(b.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Ve.unregister(a),i.closeIfConnected())}).on("DISCONNECT_PEER",b=>{console.warn("\u63a5\u7d9a\u5931\u6557",b.data.peerId),a.push(b.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+e.length),e.length<=a.length&&(i.resetNetwork(),Ve.unregister(a),i.closeIfConnected())})})})()}resetNetwork(){Lt.peerContexts.length<1&&(Lt.open(),Je.myCursor.peerId=Lt.peerId)}closeIfConnected(){0<Lt.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,hn.Z)(function*(){yield e.modalService.open(cG,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(Te(0,mG,8,3,"div",0),Te(1,_G,4,0,"ng-template",null,1,Qn)),2&e){const r=dn(2);ie("ngIf",!i.isConnected)("ngIfElse",r)}},dependencies:[$i,Rn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();var _r_isObject=function vG(t){return"object"==typeof t&&null!==t},_r_repeat=function CG(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},_r_isNegativeZero=function xG(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t};function AS(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function zf(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=AS(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(zf.prototype=Object.create(Error.prototype)).constructor=zf,zf.prototype.toString=function(n){return this.name+": "+AS(this,n)};var uo=zf;function Tv(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function Sv(t,n){return _r_repeat(" ",n-t.length)+t}var AG=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],PG=["scalar","sequence","mapping"],Ar=function OG(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===AG.indexOf(e))throw new uo('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function NG(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===PG.indexOf(this.kind))throw new uo('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function PS(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function Iv(t){return this.extend(t)}Iv.prototype.extend=function(n){var e=[],i=[];if(n instanceof Ar)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new uo("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof Ar))throw new uo("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new uo("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new uo("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof Ar))throw new uo("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(Iv.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=PS(r,"implicit"),r.compiledExplicit=PS(r,"explicit"),r.compiledTypeMap=function FG(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var NS=Iv,OS=new Ar("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),FS=new Ar("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),RS=new Ar("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),LS=new NS({explicit:[OS,FS,RS]}),BS=new Ar("tag:yaml.org,2002:null",{kind:"scalar",resolve:function RG(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function LG(){return null},predicate:function BG(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),zS=new Ar("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function zG(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function jG(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function UG(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function HG(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function VG(t){return 48<=t&&t<=55}function GG(t){return 48<=t&&t<=57}var jS=new Ar("tag:yaml.org,2002:int",{kind:"scalar",resolve:function qG(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!HG(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!VG(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!GG(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function WG(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function KG(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!_r_isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),YG=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),QG=/^[-+]?[0-9]+e/,US=new Ar("tag:yaml.org,2002:float",{kind:"scalar",resolve:function ZG(t){return!(null===t||!YG.test(t)||"_"===t[t.length-1])},construct:function XG(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function eq(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||_r_isNegativeZero(t))},represent:function JG(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(_r_isNegativeZero(t))return"-0.0";return e=t.toString(10),QG.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),VS=LS.extend({implicit:[BS,zS,jS,US]}),GS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),qS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),WS=new Ar("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function tq(t){return null!==t&&(null!==GS.exec(t)||null!==qS.exec(t))},construct:function nq(t){var n,e,i,r,o,s,a,_e,h=0,b=null;if(null===(n=GS.exec(t))&&(n=qS.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(h=n[7].slice(0,3);h.length<3;)h+="0";h=+h}return n[9]&&(b=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(b=-b)),_e=new Date(Date.UTC(e,i,r,o,s,a,h)),b&&_e.setTime(_e.getTime()-b),_e},instanceOf:Date,represent:function iq(t){return t.toISOString()}}),KS=new Ar("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function rq(t){return"<<"===t||null===t}}),Mv="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",YS=new Ar("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function oq(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=Mv;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function sq(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=Mv,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function lq(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function aq(t){var i,r,n="",e=0,o=t.length,s=Mv;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),cq=Object.prototype.hasOwnProperty,uq=Object.prototype.toString,ZS=new Ar("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function dq(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==uq.call(r=a[e]))return!1;for(o in r)if(cq.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function fq(t){return null!==t?t:[]}}),hq=Object.prototype.toString,XS=new Ar("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function pq(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==hq.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function gq(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),mq=Object.prototype.hasOwnProperty,QS=new Ar("tag:yaml.org,2002:set",{kind:"mapping",resolve:function _q(t){if(null===t)return!0;var n,e=t;for(n in e)if(mq.call(e,n)&&null!==e[n])return!1;return!0},construct:function $q(t){return null!==t?t:{}}}),kv=VS.extend({implicit:[WS,KS],explicit:[YS,ZS,XS,QS]}),Cl=Object.prototype.hasOwnProperty,bq=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,yq=/[\x85\u2028\u2029]/,Cq=/[,\[\]\{\}]/,nI=/^(?:!|!!|![a-z\-]+!)$/i,iI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function rI(t){return Object.prototype.toString.call(t)}function ca(t){return 10===t||13===t}function Tc(t){return 9===t||32===t}function xo(t){return 9===t||32===t||10===t||13===t}function qu(t){return 44===t||91===t||93===t||123===t||125===t}function xq(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function wq(t){return 120===t?2:117===t?4:85===t?8:0}function Eq(t){return 48<=t&&t<=57?t-48:-1}function oI(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function Tq(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var sI=new Array(256),aI=new Array(256),Wu=0;Wu<256;Wu++)sI[Wu]=oI(Wu)?1:0,aI[Wu]=oI(Wu);function Sq(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||kv,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function lI(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=function kG(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var h,b,a="",ee=Math.min(t.line+n.linesAfter,r.length).toString().length,de=n.maxLength-(n.indent+ee+3);for(h=1;h<=n.linesBefore&&!(s-h<0);h++)b=Tv(t.buffer,i[s-h],r[s-h],t.position-(i[s]-i[s-h]),de),a=_r_repeat(" ",n.indent)+Sv((t.line-h+1).toString(),ee)+" | "+b.str+"\n"+a;for(b=Tv(t.buffer,i[s],r[s],t.position,de),a+=_r_repeat(" ",n.indent)+Sv((t.line+1).toString(),ee)+" | "+b.str+"\n",a+=_r_repeat("-",n.indent+ee+3+b.pos)+"^\n",h=1;h<=n.linesAfter&&!(s+h>=r.length);h++)b=Tv(t.buffer,i[s+h],r[s+h],t.position-(i[s]-i[s+h]),de),a+=_r_repeat(" ",n.indent)+Sv((t.line+h+1).toString(),ee)+" | "+b.str+"\n";return a.replace(/\n$/,"")}(e),new uo(n,e)}function cn(t,n){throw lI(t,n)}function Pg(t,n){t.onWarning&&t.onWarning.call(null,lI(t,n))}var cI={YAML:function(n,e,i){var r,o,s;null!==n.version&&cn(n,"duplication of %YAML directive"),1!==i.length&&cn(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&cn(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&cn(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&Pg(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&cn(n,"TAG directive accepts exactly two arguments"),o=i[1],nI.test(r=i[0])||cn(n,"ill-formed tag handle (first argument) of the TAG directive"),Cl.call(n.tagMap,r)&&cn(n,'there is a previously declared suffix for "'+r+'" tag handle'),iI.test(o)||cn(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{cn(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function xl(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||cn(t,"expected valid JSON character");else bq.test(a)&&cn(t,"the stream contains non-printable characters");t.result+=a}}function uI(t,n,e,i){var r,o,s,a;for(_r_isObject(e)||cn(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)Cl.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function Ku(t,n,e,i,r,o,s,a,h){var b,ee;if(Array.isArray(r))for(b=0,ee=(r=Array.prototype.slice.call(r)).length;b<ee;b+=1)Array.isArray(r[b])&&cn(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===rI(r[b])&&(r[b]="[object Object]");if("object"==typeof r&&"[object Object]"===rI(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(b=0,ee=o.length;b<ee;b+=1)uI(t,n,o[b],e);else uI(t,n,o,e);else!t.json&&!Cl.call(e,r)&&Cl.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=h||t.position,cn(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function Av(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):cn(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function or(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;Tc(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!ca(r))break;for(Av(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&Pg(t,"deficient indentation"),i}function Ng(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!xo(e)))}function Pv(t,n){1===n?t.result+=" ":n>1&&(t.result+=_r_repeat("\n",n-1))}function dI(t,n){var e,h,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),h=t.input.charCodeAt(t.position);0!==h&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,cn(t,"tab characters must not be used in indentation")),45===h&&xo(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,or(t,!0,-1)&&t.lineIndent<=n)o.push(null),h=t.input.charCodeAt(t.position);else if(e=t.line,Yu(t,n,3,!1,!0),o.push(t.result),or(t,!0,-1),h=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==h)cn(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function Nq(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&cn(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):cn(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!xo(s);)33===s&&(i?cn(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),nI.test(r)||cn(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),Cq.test(o)&&cn(t,"tag suffix cannot contain flow indicator characters")}o&&!iI.test(o)&&cn(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{cn(t,"tag name is malformed: "+o)}return e?t.tag=o:Cl.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:cn(t,'undeclared tag handle "'+r+'"'),!0}function Oq(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&cn(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!xo(e)&&!qu(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&cn(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function Yu(t,n,e,i,r){var o,s,a,de,_e,Ce,Se,Pe,Ne,h=1,b=!1,ee=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=4===e||3===e,i&&or(t,!0,-1)&&(b=!0,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)),1===h)for(;Nq(t)||Oq(t);)or(t,!0,-1)?(b=!0,a=o,t.lineIndent>n?h=1:t.lineIndent===n?h=0:t.lineIndent<n&&(h=-1)):a=!1;if(a&&(a=b||r),(1===h||4===e)&&(Pe=1===e||2===e?n:n+1,Ne=t.position-t.lineStart,1===h?a&&(dI(t,Ne)||function Pq(t,n,e){var i,r,o,s,a,h,He,b=t.tag,ee=t.anchor,de={},_e=Object.create(null),Ce=null,Se=null,Pe=null,Ne=!1,je=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=de),He=t.input.charCodeAt(t.position);0!==He;){if(!Ne&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,cn(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==He&&58!==He||!xo(i)){if(s=t.line,a=t.lineStart,h=t.position,!Yu(t,e,2,!1,!0))break;if(t.line===o){for(He=t.input.charCodeAt(t.position);Tc(He);)He=t.input.charCodeAt(++t.position);if(58===He)xo(He=t.input.charCodeAt(++t.position))||cn(t,"a whitespace character is expected after the key-value separator within a block mapping"),Ne&&(Ku(t,de,_e,Ce,Se,null,s,a,h),Ce=Se=Pe=null),je=!0,Ne=!1,r=!1,Ce=t.tag,Se=t.result;else{if(!je)return t.tag=b,t.anchor=ee,!0;cn(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!je)return t.tag=b,t.anchor=ee,!0;cn(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===He?(Ne&&(Ku(t,de,_e,Ce,Se,null,s,a,h),Ce=Se=Pe=null),je=!0,Ne=!0,r=!0):Ne?(Ne=!1,r=!0):cn(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,He=i;if((t.line===o||t.lineIndent>n)&&(Ne&&(s=t.line,a=t.lineStart,h=t.position),Yu(t,n,4,!0,r)&&(Ne?Se=t.result:Pe=t.result),Ne||(Ku(t,de,_e,Ce,Se,Pe,s,a,h),Ce=Se=Pe=null),or(t,!0,-1),He=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==He)cn(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return Ne&&Ku(t,de,_e,Ce,Se,null,s,a,h),je&&(t.tag=b,t.anchor=ee,t.kind="mapping",t.result=de),je}(t,Ne,Pe))||function Dq(t,n){var i,r,o,a,ee,de,_e,Ce,Pe,Ne,je,He,e=!0,s=t.tag,h=t.anchor,Se=Object.create(null);if(91===(He=t.input.charCodeAt(t.position)))ee=93,Ce=!1,a=[];else{if(123!==He)return!1;ee=125,Ce=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),He=t.input.charCodeAt(++t.position);0!==He;){if(or(t,!0,n),(He=t.input.charCodeAt(t.position))===ee)return t.position++,t.tag=s,t.anchor=h,t.kind=Ce?"mapping":"sequence",t.result=a,!0;e?44===He&&cn(t,"expected the node content, but found ','"):cn(t,"missed comma between flow collection entries"),je=null,de=_e=!1,63===He&&xo(t.input.charCodeAt(t.position+1))&&(de=_e=!0,t.position++,or(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,Yu(t,n,1,!1,!0),Ne=t.tag,Pe=t.result,or(t,!0,n),He=t.input.charCodeAt(t.position),(_e||t.line===i)&&58===He&&(de=!0,He=t.input.charCodeAt(++t.position),or(t,!0,n),Yu(t,n,1,!1,!0),je=t.result),Ce?Ku(t,a,Se,Ne,Pe,je,i,r,o):a.push(de?Ku(t,null,Se,Ne,Pe,je,i,r,o):Pe),or(t,!0,n),44===(He=t.input.charCodeAt(t.position))?(e=!0,He=t.input.charCodeAt(++t.position)):e=!1}cn(t,"unexpected end of the stream within a flow collection")}(t,Pe)?ee=!0:(s&&function Aq(t,n){var e,i,ee,de,r=1,o=!1,s=!1,a=n,h=0,b=!1;if(124===(de=t.input.charCodeAt(t.position)))i=!1;else{if(62!==de)return!1;i=!0}for(t.kind="scalar",t.result="";0!==de;)if(43===(de=t.input.charCodeAt(++t.position))||45===de)1===r?r=43===de?3:2:cn(t,"repeat of a chomping mode identifier");else{if(!((ee=Eq(de))>=0))break;0===ee?cn(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?cn(t,"repeat of an indentation width identifier"):(a=n+ee-1,s=!0)}if(Tc(de)){do{de=t.input.charCodeAt(++t.position)}while(Tc(de));if(35===de)do{de=t.input.charCodeAt(++t.position)}while(!ca(de)&&0!==de)}for(;0!==de;){for(Av(t),t.lineIndent=0,de=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===de;)t.lineIndent++,de=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),ca(de))h++;else{if(t.lineIndent<a){3===r?t.result+=_r_repeat("\n",o?1+h:h):1===r&&o&&(t.result+="\n");break}for(i?Tc(de)?(b=!0,t.result+=_r_repeat("\n",o?1+h:h)):b?(b=!1,t.result+=_r_repeat("\n",h+1)):0===h?o&&(t.result+=" "):t.result+=_r_repeat("\n",h):t.result+=_r_repeat("\n",o?1+h:h),o=!0,s=!0,h=0,e=t.position;!ca(de)&&0!==de;)de=t.input.charCodeAt(++t.position);xl(t,e,t.position,!1)}}return!0}(t,Pe)||function Mq(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(xl(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else ca(e)?(xl(t,i,r,!0),Pv(t,or(t,!1,n)),i=r=t.position):t.position===t.lineStart&&Ng(t)?cn(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);cn(t,"unexpected end of the stream within a single quoted scalar")}(t,Pe)||function kq(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return xl(t,e,t.position,!0),t.position++,!0;if(92===a){if(xl(t,e,t.position,!0),ca(a=t.input.charCodeAt(++t.position)))or(t,!1,n);else if(a<256&&sI[a])t.result+=aI[a],t.position++;else if((s=wq(a))>0){for(r=s,o=0;r>0;r--)(s=xq(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:cn(t,"expected hexadecimal character");t.result+=Tq(o),t.position++}else cn(t,"unknown escape sequence");e=i=t.position}else ca(a)?(xl(t,e,i,!0),Pv(t,or(t,!1,n)),e=i=t.position):t.position===t.lineStart&&Ng(t)?cn(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}cn(t,"unexpected end of the stream within a double quoted scalar")}(t,Pe)?ee=!0:function Fq(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!xo(i)&&!qu(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&cn(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Cl.call(t.anchorMap,e)||cn(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],or(t,!0,-1),!0}(t)?(ee=!0,(null!==t.tag||null!==t.anchor)&&cn(t,"alias node should not have any properties")):function Iq(t,n,e){var r,o,s,a,h,b,ee,Ce,de=t.kind,_e=t.result;if(xo(Ce=t.input.charCodeAt(t.position))||qu(Ce)||35===Ce||38===Ce||42===Ce||33===Ce||124===Ce||62===Ce||39===Ce||34===Ce||37===Ce||64===Ce||96===Ce||(63===Ce||45===Ce)&&(xo(r=t.input.charCodeAt(t.position+1))||e&&qu(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==Ce;){if(58===Ce){if(xo(r=t.input.charCodeAt(t.position+1))||e&&qu(r))break}else if(35===Ce){if(xo(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Ng(t)||e&&qu(Ce))break;if(ca(Ce)){if(h=t.line,b=t.lineStart,ee=t.lineIndent,or(t,!1,-1),t.lineIndent>=n){a=!0,Ce=t.input.charCodeAt(t.position);continue}t.position=s,t.line=h,t.lineStart=b,t.lineIndent=ee;break}}a&&(xl(t,o,s,!1),Pv(t,t.line-h),o=s=t.position,a=!1),Tc(Ce)||(s=t.position+1),Ce=t.input.charCodeAt(++t.position)}return xl(t,o,s,!1),!!t.result||(t.kind=de,t.result=_e,!1)}(t,Pe,1===e)&&(ee=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===h&&(ee=a&&dI(t,Ne))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&cn(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),de=0,_e=t.implicitTypes.length;de<_e;de+=1)if((Se=t.implicitTypes[de]).resolve(t.result)){t.result=Se.construct(t.result),t.tag=Se.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Cl.call(t.typeMap[t.kind||"fallback"],t.tag))Se=t.typeMap[t.kind||"fallback"][t.tag];else for(Se=null,de=0,_e=(Ce=t.typeMap.multi[t.kind||"fallback"]).length;de<_e;de+=1)if(t.tag.slice(0,Ce[de].tag.length)===Ce[de].tag){Se=Ce[de];break}Se||cn(t,"unknown tag !<"+t.tag+">"),null!==t.result&&Se.kind!==t.kind&&cn(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+Se.kind+'", not "'+t.kind+'"'),Se.resolve(t.result,t.tag)?(t.result=Se.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):cn(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||ee}function Rq(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(or(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!xo(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&cn(t,"directive name must not be less than one character in length");0!==s;){for(;Tc(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!ca(s));break}if(ca(s))break;for(e=t.position;0!==s&&!xo(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&Av(t),Cl.call(cI,i)?cI[i](t,i,r):Pg(t,'unknown document directive "'+i+'"')}or(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,or(t,!0,-1)):o&&cn(t,"directives end mark is expected"),Yu(t,t.lineIndent-1,4,!1,!0),or(t,!0,-1),t.checkLineBreaks&&yq.test(t.input.slice(n,t.position))&&Pg(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Ng(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,or(t,!0,-1)):t.position<t.length-1&&cn(t,"end of the stream or a document separator is expected")}function fI(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new Sq(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,cn(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)Rq(e);return e.documents}var hI_load=function Bq(t,n){var e=fI(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new uo("expected a single document in the stream, but found more")}};function Bv(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var PI=hI_load;Bv("safeLoad","load"),Bv("safeLoadAll","loadAll"),Bv("safeDump","dump");const NI=Object.getOwnPropertyNames(Object.prototype),RW=Object.getOwnPropertyNames(Array.prototype);let zv=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,hn.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=PI(i);t.applyConfig(r)}catch(i){console.warn(i)}Ve.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,hn.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?NI.concat(RW):NI).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:"",api:1}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();function LW(t,n){if(1&t){const e=gt();Z(0,"div",12),Ae("click",function(){return Fe(e),Re(ge(2).changeIcon())}),zt(1,"safe"),ne()}2&t&&pt("background-image",jt(1,2,"url("+ge(2).myPeer.image.url+")","style"))}const BW=function(t){return{"i-am-gm":t}};function zW(t,n){if(1&t){const e=gt();Z(0,"div")(1,"div",3),Te(2,LW,2,5,"div",4),Z(3,"div")(4,"label",5)(5,"b",6)(6,"input",7),Ae("click",function(r){return Fe(e),Re(ge().onGMMode(r))}),ne(),$e(7),ne()(),vt(8,"br"),Z(9,"button",8),Ae("click",function(){return Fe(e),Re(ge().changeIcon())}),$e(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),ne()()(),Z(11,"div"),$e(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),Z(13,"input",9),Ae("ngModelChange",function(r){return Fe(e),Re(ge().myPeerColor=r)}),ne(),Z(14,"input",10),Ae("ngModelChange",function(r){return Fe(e),Re(ge().myPeerName=r)}),ne(),vt(15,"br"),Z(16,"small"),$e(17,"\u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f"),Z(18,"b"),$e(19,"\u30a2\u30a4\u30b3\u30f3"),ne(),$e(20,"\u3001"),Z(21,"b"),$e(22,"\u8272"),ne(),$e(23,"\u3001"),Z(24,"b"),$e(25,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),ne(),$e(26,"\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002"),ne(),vt(27,"br"),Z(28,"span",11),$e(29,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),ne()()()}if(2&t){const e=ge();V(2),ie("ngIf",e.myPeer.image),V(2),ie("ngClass",wt(8,BW,e.isGMMode||e.isGMHold)),V(2),Mt("checked",e.isGMMode||e.isGMHold?"checked":""),V(1),dt(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),V(6),ie("ngModel",e.myPeerColor),V(1),pt("color",e.myPeerColor),ie("ngModel",e.myPeerName)}}function jW(t,n){if(1&t){const e=gt();Z(0,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).copyPeerId())}),Z(1,"b",19),$e(2,"content_copy"),ne()()}2&t&&ie("disabled",ge(2).isCopied)}function UW(t,n){if(1&t&&(it(0),Z(1,"span",13)(2,"span",14),$e(3),ne(),vt(4,"input",15),ne(),Te(5,jW,3,1,"button",16),Z(6,"span",17),$e(7),ne(),rt()),2&t){const e=ge();V(3),dt(e.networkService.peerContext.userId),V(1),Mt("value",e.networkService.peerContext.userId),V(1),ie("ngIf",e.isAbleClipboardCopy),V(1),pt("color",e.myPeerColor),ie("@fadeInOut",e.isCopied),V(1),Zn(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function HW(t,n){1&t&&(Z(0,"span",20),$e(1,"???"),ne())}function VW(t,n){if(1&t){const e=gt();Z(0,"button",18),Ae("click",function(){return Fe(e),Re(ge(3).copyRoomName())}),Z(1,"b",19),$e(2,"content_copy"),ne()()}2&t&&ie("disabled",ge(3).isRoomNameCopied)}function GW(t,n){if(1&t&&(it(0),Z(1,"span",13)(2,"span",21),$e(3),ne(),vt(4,"input",22),ne(),Te(5,VW,3,1,"button",16),Z(6,"span",17),$e(7),ne(),rt()),2&t){const e=ge(2);V(3),Ja("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,""),V(1),Mt("value",e.networkService.peerContext.roomName+"/"+e.networkService.peerContext.roomId),V(1),ie("ngIf",e.isAbleClipboardCopy),V(1),pt("color",e.myPeerColor),ie("@fadeInOut",e.isRoomNameCopied),V(1),Zn(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function qW(t,n){if(1&t&&(Z(0,"span",13)(1,"span",21),$e(2),ne(),vt(3,"input",22),ne()),2&t){const e=ge(3);V(2),dt(e.networkService.peerContext.password),V(1),Mt("value",e.networkService.peerContext.password)}}function WW(t,n){if(1&t&&(Z(0,"div",29),$e(1),ne()),2&t){const e=ge(3);V(1),dt(e.maskedPassword)}}function KW(t,n){if(1&t){const e=gt();Z(0,"button",18),Ae("click",function(){return Fe(e),Re(ge(3).copyPassword())}),Z(1,"b",19),$e(2,"content_copy"),ne()()}2&t&&ie("disabled",ge(3).isPasswordCopied)}const YW=function(t){return{"red-eye":t}};function ZW(t,n){if(1&t){const e=gt();it(0),Z(1,"div"),$e(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),Z(3,"label",23)(4,"input",24),Ae("click",function(r){return Fe(e),Re(ge(2).onPasswordOpen(r))}),ne(),Z(5,"b",25),$e(6),ne(),$e(7,"\uff1a "),ne(),Z(8,"div",26),Te(9,qW,4,2,"span",27),Te(10,WW,2,1,"div",28),Te(11,KW,3,1,"button",16),Z(12,"span",17),$e(13),ne()()(),rt()}if(2&t){const e=ge(2);V(4),Mt("checked",e.isPasswordOpen?"checked":""),V(1),ie("ngClass",wt(10,YW,e.isPasswordOpen)),V(1),dt(e.isPasswordOpen?"visibility":"visibility_off"),V(3),ie("ngIf",e.isPasswordOpen),V(1),ie("ngIf",!e.isPasswordOpen),V(1),ie("ngIf",e.isAbleClipboardCopy&&e.isPasswordOpen),V(1),pt("color",e.myPeerColor),ie("@fadeInOut",e.isPasswordCopied),V(1),Zn(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function XW(t,n){if(1&t&&(it(0),vt(1,"hr"),Z(2,"div"),$e(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),Z(4,"span"),Te(5,GW,8,8,"ng-container",0),ne()(),Te(6,ZW,14,12,"ng-container",0),rt()),2&t){const e=ge();V(5),ie("ngIf",e.networkService.isOpen),V(1),ie("ngIf",e.networkService.peerContext.password)}}function QW(t,n){1&t&&(Z(0,"div",20),$e(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),Z(2,"span",35),$e(3,"\uff08\u826f\u597d "),ne(),Z(4,"i",36),$e(5,"sentiment_very_satisfied"),ne(),Z(6,"span",35),$e(7," \uff1e "),ne(),Z(8,"i",37),$e(9,"sentiment_dissatisfied"),ne(),Z(10,"span",35),$e(11," \uff1e "),ne(),Z(12,"i",38),$e(13,"mood_bad"),ne(),Z(14,"span",35),$e(15," \uff1e "),ne(),Z(16,"i",39),$e(17,"sentiment_very_dissatisfied"),ne(),Z(18,"span",35),$e(19," \u4e0d\u826f\uff09"),ne(),$e(20,"\uff1a"),ne())}function JW(t,n){1&t&&(Z(0,"div"),$e(1,"[\u63a5\u7d9a\u4e2d]"),ne())}function eK(t,n){if(1&t&&(Z(0,"div",40),zt(1,"safe"),ne()),2&t){const e=ge().$implicit;pt("background-image",jt(1,2,"url("+ge().findPeerImageUrl(e.peerId)+")","style"))}}const tK=function(t){return{"is-gm-mode":t}};function nK(t,n){if(1&t&&(Z(0,"div"),Te(1,QW,21,0,"div",30),Z(2,"div"),Te(3,JW,2,0,"div",0),Z(4,"div",31)(5,"i",32),$e(6),ne(),Z(7,"span",33),$e(8),ne(),$e(9,"["),Te(10,eK,2,5,"div",34),Z(11,"span")(12,"b"),$e(13),ne()(),$e(14,"]"),ne()()()),2&t){const e=n.$implicit,i=n.index,r=ge();V(1),ie("ngIf",0==i),V(2),ie("ngIf",!e.isOpen),V(1),ie("ngClass",wt(12,tK,r.findPeerIsGMMode(e.peerId))),V(1),Od("material-icons health "+r.healthClass(e.session.health)),V(1),dt(r.healthIcon(e.session.health)),V(2),dt(r.findUserId(e.peerId)),V(2),ie("ngIf",r.findPeerImageUrl(e.peerId)),V(2),pt("color",r.findPeerColor(e.peerId)),V(1),dt(r.findPeerName(e.peerId))}}function iK(t,n){if(1&t){const e=gt();it(0),Z(1,"input",41),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).targetUserId=r)}),ne(),Z(2,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).connectPeer())}),$e(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),ne(),vt(4,"br"),rt()}if(2&t){const e=ge(2);V(1),ie("ngModel",e.targetUserId)("disabled",e.isDisableConnect),V(1),ie("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function rK(t,n){if(1&t){const e=gt();Z(0,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).showLobby())}),$e(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),ne()}if(2&t){const e=ge(2);ie("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function oK(t,n){if(1&t&&(Z(0,"div"),Te(1,iK,5,3,"ng-container",0),Te(2,rK,2,1,"button",16),ne()),2&t){const e=ge();V(1),ie("ngIf",!e.networkService.peerContext.isRoom),V(1),ie("ngIf",e.networkService.peerIds.length<=1)}}function sK(t,n){1&t&&(Z(0,"div",43),$e(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),ne())}function aK(t,n){1&t&&(Z(0,"div",43),$e(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),ne())}function lK(t,n){if(1&t&&(it(0),Te(1,sK,2,0,"div",42),Te(2,aK,2,0,"div",42),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.networkService.peerContexts.length<1),V(1),ie("ngIf",e.networkService.peerContexts.length<1)}}function cK(t,n){1&t&&(it(0),Z(1,"div",43),$e(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),ne(),rt())}function uK(t,n){if(1&t&&(it(0),Te(1,lK,3,2,"ng-container",0),Te(2,cK,3,0,"ng-container",0),rt()),2&t){const e=ge();V(1),ie("ngIf",!e.networkService.peerContext.isRoom),V(1),ie("ngIf",e.networkService.peerContext.isRoom)}}function dK(t,n){1&t&&(it(0),Z(1,"div",43),$e(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),ne(),rt())}let jv=(()=>{class t{constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.appConfigService=o,this.targetUserId="",this.networkService=Lt,this.gameRoomService=Et.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.help=""}get myPeer(){return Je.myCursor}get myPeerName(){return Je.myCursor?Je.myCursor.name:null}set myPeerName(e){Je.myCursor&&(Je.myCursor.name=e,Je.myCursor.name===Je.CHAT_DEFAULT_NAME?Nn.removeItem(Je.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Nn.setItem(Je.CHAT_MY_NAME_LOCAL_STORAGE_KEY,Je.myCursor.name).catch(i=>console.log(i)))}get myPeerColor(){return Je.myCursor?Je.myCursor.color:Je.CHAT_DEFAULT_COLOR}set myPeerColor(e){if(e&&Je.myCursor){if(e=e.trim().toLowerCase(),!/^\#[0-9a-f]{6}$/.test(e))return;Je.myCursor.color=e==Je.CHAT_TRANSPARENT_COLOR?Je.CHAT_DEFAULT_COLOR:e,Je.myCursor.color===Je.CHAT_DEFAULT_COLOR?Nn.removeItem(Je.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Nn.setItem(Je.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Je.myCursor.color).catch(i=>console.log(i))}}get isGMMode(){return!!Je.myCursor&&Je.myCursor.isGMMode}set isGMMode(e){Je.myCursor&&(Je.myCursor.isGMMode=e)}get isGMHold(){return Je.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),Ve.unregister(this)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(da,{currentImageIdentifires:e}).then(i=>{if(!this.myPeer||!i)return;this.myPeer.imageIdentifier=i;let r=Kt.instance.get(i);r&&(r.state===Pi.COMPLETE?Nn.setItem(Je.CHAT_MY_ICON_LOCAL_STORAGE_KEY,r.blob).catch(o=>console.log(o)):"none_icon"===i?Nn.removeItem(Je.CHAT_MY_ICON_LOCAL_STORAGE_KEY).catch(o=>console.log(o)):Nn.setItem(Je.CHAT_MY_ICON_LOCAL_STORAGE_KEY,i).catch(o=>console.log(o)))})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;let i=ki.create(e);i.isRoom||(Et.instance.clearDeleteHistory(),Lt.connect(i.peerId),(Je.isGMHold||this.isGMMode)&&(Je.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Ve.trigger("CHANGE_GM_MODE",null))))}showLobby(){(Je.isGMHold||this.isGMMode)&&(Je.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Ve.trigger("CHANGE_GM_MODE",null))),this.modalService.open($G,{width:700,height:400,left:0,top:400})}findUserId(e){const i=Je.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Je.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=Je.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=Je.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=Je.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.roomName+"/"+this.networkService.peerContext.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId2=setTimeout(()=>{this.isPasswordCopied=!1},1e3),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(gr,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",type:Bi.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){Je.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(gr,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:Bi.OK_CANCEL,materialIcon:"person_remove",action:()=>{Je.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Ve.trigger("CHANGE_GM_MODE",null),an.isStealthMode&&this.modalService.open(gr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Bi.OK,materialIcon:"disabled_visible"})}})):(Je.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(gr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:Bi.OK_CANCEL,materialIcon:"person_add",action:()=>{Je.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(gr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:Bi.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}}return t.\u0275fac=function(e){return new(e||t)(Ge(Yn),Ge(Wn),Ge(Vr),Ge(zv))},t.\u0275cmp=mn({type:t,selectors:[["peer-menu"]],decls:13,vars:8,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"checked","click"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],[3,"disabled","click",4,"ngIf"],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],["style","font-weight: bold",4,"ngIf"],[3,"ngClass"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","disabled","ngModelChange"],["style","font-size: 12px",4,"ngIf"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Te(0,zW,30,10,"div",0),Z(1,"div")(2,"div"),$e(3,"\u3042\u306a\u305f\u306eID\uff1a "),Z(4,"span"),Te(5,UW,8,7,"ng-container",0),ne(),Te(6,HW,2,0,"span",1),ne()(),Te(7,XW,7,2,"ng-container",0),vt(8,"hr"),Te(9,nK,15,14,"div",2),Te(10,oK,3,2,"div",0),Te(11,uK,3,2,"ng-container",0),Te(12,dK,3,0,"ng-container",0)),2&e&&(ie("ngIf",i.myPeer),V(5),ie("ngIf",i.networkService.isOpen),V(1),ie("ngIf",!i.networkService.isOpen),V(1),ie("ngIf",i.networkService.peerContext.isRoom),V(2),ie("ngForOf",i.networkService.peerContexts),V(1),ie("ngIf",!i.isGMMode&&!i.isGMHold),V(1),ie("ngIf",!i.isGMMode&&!i.isGMHold),V(1),ie("ngIf",i.isGMMode||i.isGMHold))},dependencies:[oi,$i,Rn,Ii,Mi,Ci,_i],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}'],data:{animation:[Hn("fadeInOut",[en("false => true",[Qt("50ms ease-in-out",ht({opacity:1})),Qt("900ms ease-in-out",ht({opacity:0}))])])]}}),t})();var Ln=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(Ln||(Ln={})),Ln))();class fK{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new ls(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case Ln.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case Ln.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`;break;case Ln.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`;break;case Ln.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case Ln.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case Ln.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case Ln.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case Ln.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(n){let e=this.handle.style;if(n)switch(this.type){case Ln.N:e.cursor="ns-resize";break;case Ln.E:case Ln.W:e.cursor="ew-resize";break;case Ln.S:e.cursor="ns-resize";break;case Ln.NE:e.cursor="nesw-resize";break;case Ln.NW:case Ln.SE:e.cursor="nwse-resize";break;case Ln.SW:e.cursor="nesw-resize"}else e.cursor="default"}}let hK=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Gn,this.onmove=new Gn,this.onend=new Gn,this.handleMap=new Map,this._isDisable=!1,this._align="normal",this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}set isDisable(e){this._isDisable=e,this.initialize()}set align(e){this._align=e,this.initialize()}get handleTypes(){return this._isDisable||"none"===this._align?[]:"horizontal"===this._align?[Ln.E,Ln.W]:"vertical"===this._align?[Ln.N,Ln.S]:[Ln.N,Ln.E,Ln.W,Ln.S,Ln.NE,Ln.NW,Ln.SE,Ln.SW]}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear(),this.handleTypes.forEach(e=>{let i=new fK(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear()}onResizeStart(e,i){if(this._isDisable||1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case Ln.N:case Ln.S:r.width=0;break;case Ln.E:case Ln.W:r.height=0}switch(i.type){case Ln.SW:r.left=r.width,r.width*=-1;break;case Ln.NE:r.top=r.height,r.height*=-1;break;case Ln.E:case Ln.S:case Ln.SE:break;case Ln.N:case Ln.W:case Ln.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Xi.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Xi.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Xi.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Xi.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Ai))},t.\u0275dir=_n({type:t,selectors:[["","appResizable",""]],inputs:{boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"],isDisable:["resizable.disable","isDisable"],align:["resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const pK=["draggablePanel"],gK=["scrollablePanel"],mK=["content"],_K=["titleBar"];function $K(t,n){if(1&t){const e=gt();Z(0,"button",11),Ae("click",function(){return Fe(e),Re(ge().toggleRotate())}),Z(1,"i",12),$e(2,"pivot_table_chart"),ne()()}}function vK(t,n){if(1&t){const e=gt();Z(0,"button",13),Ae("click",function(){return Fe(e),Re(ge().toggleMinimize())}),Z(1,"i",14),$e(2),ne()()}if(2&t){const e=ge();V(1),pt("font-size",e.isMinimized?12:14,"px"),V(1),dt(e.isMinimized?"crop_din":"minimize")}}function bK(t,n){if(1&t){const e=gt();Z(0,"button",13),Ae("click",function(){return Fe(e),Re(ge().toggleFullScreen())}),Z(1,"i",14),$e(2),ne()()}if(2&t){const e=ge();V(1),pt("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),V(1),dt(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function yK(t,n){if(1&t){const e=gt();Z(0,"button",13),Ae("click",function(){return Fe(e),Re(ge().close())}),Z(1,"i",12),$e(2,"close"),ne()()}}const CK=function(t,n,e,i){return{"pointer-events-none":t,"is-full-screen":n,"is-minimized":e,"i-am-gm":i}},xK=function(t){return{rotateble:t}},wK=function(t,n){return{overlay:t,horizontal:n}},EK=["*"];let OI=(()=>{class t{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new Gn,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1032,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!Je.myCursor&&Je.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,o=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=o):(this.verticalWidth=r,this.verticalHeight=o)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,o=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=o):(this.verticalWidth=r,this.verticalHeight=o)}this.isFullScreen=!this.isFullScreen}toggleRotate(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100);const r=e.offsetWidth,o=e.offsetHeight;this.isHorizontal?(this.isHorizontal=!1,e.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",e.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=r,this.horizontalHeight=o)):(this.isHorizontal=!0,e.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",e.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=r,this.verticalHeight=o)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(vi))},t.\u0275cmp=mn({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(Tn(pK,7),Tn(gK,7),Tn(mK,7,io),Tn(_K,7)),2&e){let r;En(r=Sn())&&(i.draggablePanel=r.first),En(r=Sn())&&(i.scrollablePanel=r.first),En(r=Sn())&&(i.content=r.first),En(r=Sn())&&(i.titleBar=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[Ti([Wn])],ngContentSelectors:EK,decls:16,vars:34,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["titleBar",""],["style","padding: 0px; height: 14px; margin-top: 3px; margin-left: 1px",3,"click",4,"ngIf"],[3,"ngClass"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],["scrollablePanel",""],["content",""],[2,"padding","0px","height","14px","margin-top","3px","margin-left","1px",3,"click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(N_(),Z(0,"div",0,1)(2,"div",2,3),Te(4,$K,3,0,"button",4),Z(5,"div",5),$e(6),ne(),Z(7,"div",6),Te(8,vK,3,3,"button",7),Te(9,bK,3,3,"button",7),Te(10,yK,3,0,"button",7),ne()(),Z(11,"div",8,9),O_(13),vt(14,"div",null,10),ne()()),2&e&&(pt("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),ie("@flyInOut","in")("ngClass",Is(24,CK,i.isPointerDragging,i.isFullScreen,i.isMinimized&&!i.isFullScreen,i.isGMMode))("resizable.disable",i.isMinimized||i.isFullScreen)("resizable.align",i.isAbleRotateButton?i.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",i.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),V(4),ie("ngIf",i.isAbleRotateButton),V(1),ie("ngClass",wt(29,xK,i.isAbleRotateButton)),V(1),dt(i.panelService.title),V(2),ie("ngIf",i.isAbleMinimizeButton),V(1),ie("ngIf",i.isAbleFullScreenButton),V(1),ie("ngIf",i.isAbleCloseButton),V(1),pt("display",i.isMinimized&&!i.isFullScreen?"none":null),ie("ngClass",fn(31,wK,i.isAbleRotateButton,i.isHorizontal)))},dependencies:[oi,Rn,gv,hK],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0!important;top:0!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,208,208,.9),rgba(255,236,236,.9))}"],data:{animation:[Hn("flyInOut",[en("void => *",[Qt("100ms ease-out",Cn([ht({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),ht({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale(0, 0)"}))])])]}}),t})();const TK=["standImageElement"],SK=["dialogElement"],IK=function(t){return{"emote-secret":t}};function MK(t,n){if(1&t&&(Z(0,"div",12),$e(1),ne()),2&t){const e=ge(3);pt("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),ie("@fadeAndScaleInOut",void 0)("ngClass",wt(13,IK,e.isSecret)),V(1),dt(e.gameCharacter.text)}}const kK=function(t,n){return{"transform-origin":t,transform:n}},DK=function(t){return{inverse:t}},AK=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},PK=function(t,n){return{"black-paint":t,hollow:n}};function NK(t,n){if(1&t){const e=gt();it(0),Te(1,MK,2,15,"div",5),Z(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"img",10,11),Ae("load",function(){return Fe(e),Re(ge(2).onImageLoad())}),zt(8,"safe"),ne()()()()(),rt()}if(2&t){const e=ge(2);V(1),ie("ngIf",!e.isBackyard&&e.gameCharacter.isEmote),V(1),ie("ngStyle",fn(11,kK,e.standImageTransformOrigin,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),V(1),ie("ngClass",wt(14,DK,e.isApplyImageEffect&&e.gameCharacter.isInverse)),V(1),ie("ngClass",Ms(16,AK,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),V(2),pt("height",e.height>0?e.height+"vh":"auto"),ie("src",jt(8,8,e.standImage.url,"resourceUrl"),vn)("ngClass",fn(25,PK,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}const OK=function(t,n,e,i){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,secret:i}};function FK(t,n){if(1&t){const e=gt();Z(0,"div",3),Ae("click",function(){Fe(e);const r=ge();return r.toGhostly(),Re(r.toBackyard())}),Te(1,NK,9,28,"ng-container",4),ne()}if(2&t){const e=ge();pt("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),ie("@standInOut",e.groupValue)("ngClass",Is(11,OK,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),V(1),ie("ngIf",e.gameCharacter&&e.standImage.url&&e.standImage.url.length>0)}}const RK=function(t,n,e){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e}};function LK(t,n){if(1&t&&(Z(0,"span",13)(1,"b"),$e(2),ne()()),2&t){const e=ge();pt("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),ie("ngClass",_o(12,RK,e.isCanBeGone,e.isGhostly,e.isBackyard)),V(2),dt(e.gameCharacter.name)}}const BK=function(t,n,e){return{left:t,right:n,"transform-origin":e}},zK=function(t,n,e,i,r,o){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":o}};function jK(t,n){if(1&t){const e=gt();Z(0,"div",14,15),Ae("click",function(){Fe(e);const r=ge();return r.toGhostly(),Re(r.toBackyard())}),Z(2,"p",16),Ae("@dialogShake.start",function(r){return Fe(e),Re(ge().onSpeaking(r))}),zt(3,"safe"),ne()()}if(2&t){const e=ge();pt("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),ie("@fadeAndScaleInOut",void 0)("ngStyle",_o(20,BK,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",G_(24,zK,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),V(2),ie("@dialogShake",e.math.floor(e.dialogText.length/2))("innerHTML",jt(3,17,e.dialogText,"html"),cr)}}let ua=(()=>{class t{constructor(e){this.ngZone=e,this._imageFile=sn.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get isShowStand(){return t.isShowStand}get isShowNameTag(){return t.isShowNameTag&&this.isShowName}get isCanBeGone(){return t.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=tt.cr(e.text);const r=tt.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,h=0,b=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let je=a.index-3*h;o.push({base:a[1],ruby:a[2],start:je-b,end:je+a[1].length-b-1}),h++,b+=a[2].length}let ee=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;ee>200&&(ee=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*ee+6e3),this.gameCharacter.isEmote=r,h=0;let de=0,_e=0,Ce="",Se=o.shift(),Pe="",Ne=!1;if(r)this.gameCharacter.text=i;else{const je=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let He=je[h],Ue=He.length>1;if(He){if(!Ne&&Se&&de>=Se.start&&(Ce+="<ruby>",Ne=!0,_e=0),Ce+=tt.escapeHtml(He),Ne){_e+=1;let We=Se.ruby;Pe="<rt>"+tt.escapeHtml(Array.from(We).slice(0,Math.ceil(Array.from(We).length*(_e/Array.from(Se.base).length))).join(""))+"</rt>"}Ne&&Se&&de>=Se.end-(Ue?1:0)&&(Ce+=Pe+"</ruby>",Ne=!1,Se=o.shift()),de+=He.length}h+=1,this.gameCharacter.text=Ce+(Ne?Pe+"</ruby>":""),h>=je.length&&clearInterval(this._chatIntervalId)},ee)}}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),(!e||!e.value||e.value==sn.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){let i=Kt.instance.get(e.value);this._imageFile=i||sn.Empty}return this._imageFile}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==sn.Empty.identifier}ngOnInit(){Ve.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))})}ngOnDestroy(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}calcStandImageTransformOrigin(){return"center 66%"}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1})}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}return t.isShowStand=!0,t.isShowNameTag=!0,t.isCanBeGone=!0,t.\u0275fac=function(e){return new(e||t)(Ge(Fn))},t.\u0275cmp=mn({type:t,selectors:[["stand-image"]],viewQuery:function(e,i){if(1&e&&(Tn(TK,5),Tn(SK,5)),2&e){let r;En(r=Sn())&&(i.standImageElement=r.first),En(r=Sn())&&(i.dialogElement=r.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],["draggable","false",1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],["dialogElement",""],[2,"width","100%",3,"innerHTML"]],template:function(e,i){1&e&&(Z(0,"div"),Te(1,FK,2,16,"div",0),Te(2,LK,3,16,"span",1),Te(3,jK,4,31,"div",2),ne()),2&e&&(pt("visibility",i.isShowStand?"visible":"hidden")("pointer-events",i.isShowStand?"auto":"none"),V(1),ie("ngIf",!i.isFarewell&&(i.isVisible||!i.isCanBeGone)),V(1),ie("ngIf",i.isShowStand&&!i.isFarewell&&(i.isVisible||!i.isCanBeGone)&&i.isShowNameTag&&i.gameCharacter&&i.gameCharacter.name),V(1),ie("ngIf",!i.isFarewell&&i.isVisible&&!i.isBackyard&&i.gameCharacter&&i.gameCharacter.text&&!i.gameCharacter.isEmote))},dependencies:[oi,Rn,hr,_i],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s;transform-origin:center bottom}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[Hn("standInOut",[en("void => *,:increment,:decrement",[Qt("132ms cubic-bezier(.21,.97,.75,1.25)",Cn([ht({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),ht({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),en("* => void,:increment,:decrement",[Qt("132ms ease-out",Cn([ht({transform:"translateY(0px) scale(1.0)",offset:0}),ht({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),Hn("dialogShake",[en(":increment",[Qt("19ms ease",Cn([ht({transform:"translateX(1px)"})])),Qt("19ms ease",Cn([ht({transform:"translateX(-1px)"})]))])]),Hn("fadeAndScaleInOut",[en("void => *, true => false",[Qt("200ms ease-in-out",Cn([ht({transform:"scale3d(0, 0, 0)",opacity:0}),ht({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),en("* => void, true => false",[Qt("100ms ease-in-out",ht({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),t})();class $r{constructor(){}show(n,e,i=null,r=!1){let o=!0;for(const s of $r.currentStandImageShowing){const a=s[0],h=s[1];if(!h)continue;const b=h.instance;b.isVisible&&n.identifier!=a?b.toGhostly():n.identifier==a&&"graveyard"!=n.location.name?(b.standElement=e,b.color=i||n.chatPalette.color,b.isSecret=r,b.toFront(),o=!1):(b.isFarewell||ua.isCanBeGone)&&(h.destroy(),$r.currentStandImageShowing.delete(a))}if(o&&"graveyard"!=n.location.name){const s=$r.defaultParentViewContainerRef.createComponent(ua);s.instance.gameCharacter=n,s.instance.standElement=e,s.instance.color=i||n.chatPalette.color,s.instance.isSecret=r,s.instance.toFront(),$r.currentStandImageShowing.set(n.identifier,s)}}farewell(n){n instanceof an&&(n=n.identifier);const e=$r.currentStandImageShowing.get(n);e&&e.instance&&e.instance.toFarewell()}destroy(n,e){n instanceof an&&(n=n.identifier),e instanceof kt&&(e=e.identifier);for(const i of $r.currentStandImageShowing){const r=i[1];!r||(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),$r.currentStandImageShowing.delete(n))}}destroyAll(){for(const n of $r.currentStandImageShowing){const e=n[0],i=n[1];!i||(i.destroy(),$r.currentStandImageShowing.delete(e))}}}$r.currentStandImageShowing=new Map,$r.\u0275fac=function(n){return new(n||$r)},$r.\u0275prov=xn({token:$r,factory:$r.\u0275fac,providedIn:"root"});const UK=["diceRollTableSelecter"];function HK(t,n){if(1&t&&(Z(0,"option",9),$e(1),ne()),2&t){const e=n.$implicit;pt("color",""==e.name?"gray":""),Mt("value",e.identifier),Mt("title",e.name),V(1),dt(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function VK(t,n){if(1&t&&(Z(0,"div",25),$e(1),ne()),2&t){const e=ge(3);V(1),Zn("",e.progresPercent,"%")}}const GK=function(t){return{"is-hidden":t}};function qK(t,n){if(1&t){const e=gt();it(0),Z(1,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).upTabIndex())}),$e(2,"\u2191"),ne(),Z(3,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).downTabIndex())}),$e(4,"\u2193"),ne(),Z(5,"div",19)(6,"button",20),Ae("click",function(){return Fe(e),Re(ge(2).save())}),Z(7,"div",21)(8,"div",22),$e(9,"\u4fdd\u5b58"),ne(),Te(10,VK,2,1,"div",23),ne()(),Z(11,"button",24),Ae("click",function(){return Fe(e),Re(ge(2).delete())}),$e(12,"\u524a\u9664"),ne()(),rt()}if(2&t){const e=ge(2);V(6),ie("disabled",e.isSaveing),V(2),ie("ngClass",wt(3,GK,e.isSaveing)),V(2),ie("ngIf",e.isSaveing)}}function WK(t,n){if(1&t){const e=gt();it(0),Z(1,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).restore())}),$e(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function KK(t,n){if(1&t){const e=gt();it(0),Z(1,"div",10)(2,"div",11)(3,"b"),$e(4,"name: "),ne(),Z(5,"input",12),Ae("ngModelChange",function(r){return Fe(e),Re(ge().diceRollTableName=r)}),ne()(),Z(6,"div")(7,"span",13)(8,"b"),$e(9,"command: "),ne(),Z(10,"input",14),Ae("ngModelChange",function(r){return Fe(e),Re(ge().diceRollTableCommand=r)}),ne()(),Z(11,"span",15)(12,"b"),$e(13,"dice: "),ne(),Z(14,"input",16),Ae("ngModelChange",function(r){return Fe(e),Re(ge().diceRollTableDice=r)}),ne()()()(),Z(15,"div")(16,"textarea",17),Ae("ngModelChange",function(r){return Fe(e),Re(ge().diceRollTableText=r)}),ne()(),vt(17,"hr"),Z(18,"div"),Te(19,qK,13,5,"ng-container",8),Te(20,WK,3,0,"ng-container",8),ne(),rt()}if(2&t){const e=ge();V(5),ie("ngModel",e.diceRollTableName),rn("disabled",e.isEditable?null:""),V(5),ie("ngModel",e.diceRollTableCommand),rn("disabled",e.isEditable?null:""),V(4),ie("ngModel",e.diceRollTableDice),rn("disabled",e.isEditable?null:""),V(2),ie("ngModel",e.diceRollTableText),rn("disabled",e.isEditable?null:""),V(3),ie("ngIf",!e.isDeleted),V(1),ie("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function YK(t,n){if(1&t){const e=gt();it(0),Z(1,"button",18),Ae("click",function(){return Fe(e),Re(ge(2).restore())}),$e(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function ZK(t,n){if(1&t&&(it(0),Z(1,"div",26),$e(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),Te(3,YK,3,0,"ng-container",8),ne(),rt()),2&t){const e=ge();V(3),ie("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let XK=(()=>{class t{constructor(e,i,r,o){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=o,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return Ns.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==Et.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),Ve.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=Et.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Ve.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=Et.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return Ns.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,hn.Z)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,hn.Z)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(Ns.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=gi.instance.parseXml(this.selectedDiceRollTableXml);Ns.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(vc,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}}return t.\u0275fac=function(e){return new(e||t)(Ge(vi),Ge(Yn),Ge(Wn),Ge(qr))},t.\u0275cmp=mn({type:t,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,i){if(1&e&&Tn(UK,5),2&e){let r;En(r=Sn())&&(i.diceRollTableSelecter=r.first)}},decls:13,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.add()}),$e(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),ne()(),Z(5,"select",3,4),Ae("change",function(o){return i.onChangeDiceRollTable(o.target.value)}),Te(7,HK,2,5,"option",5),ne()(),Z(8,"div",6)(9,"button",7),Ae("click",function(){return i.helpDiceRollTable()}),$e(10,"?"),ne(),Te(11,KK,21,10,"ng-container",8),ne()(),Te(12,ZK,4,1,"ng-container",8)),2&e&&(V(7),ie("ngForOf",i.diceRollTables),V(4),ie("ngIf",!i.isEmpty&&i.selectedDiceRollTable),V(1),ie("ngIf",i.isEmpty))},dependencies:[oi,$i,Rn,so,ao,Ii,Mi,Ci],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]}),t})();const QK=["cutInSelecter"];function JK(t,n){if(1&t&&(Z(0,"option",10),$e(1),ne()),2&t){const e=n.$implicit;pt("color",e.isValidAudio?""==e.name?"gray":"":"red"),Mt("value",e.identifier),Mt("title",e.name),V(1),dt((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function eY(t,n){if(1&t&&(Z(0,"div",66)(1,"i",67),$e(2),ne()()),2&t){const e=ge(2);V(1),Od(e.isShowHideImages?"red-eye":"grow"),V(1),dt(e.isShowHideImages?"visibility":"visibility_off")}}function tY(t,n){if(1&t){const e=gt();Z(0,"button",8),Ae("click",function(){return Fe(e),Re(ge(3).openModal())}),Z(1,"b"),$e(2,"\u753b\u50cf\u5909\u66f4"),ne()()}}function nY(t,n){if(1&t&&(Z(0,"div",68),Te(1,tY,3,0,"button",69),ne()),2&t){const e=ge(2);V(1),ie("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function iY(t,n){if(1&t&&(Z(0,"div",70)(1,"i",71),$e(2),ne()()),2&t){const e=ge(2);V(2),dt(e.cutInPlayListId?"featured_play_list":"movie")}}function rY(t,n){1&t&&(it(0),$e(1,"\uff08\u3042\u306a\u305f\uff09"),rt())}function oY(t,n){if(1&t&&(Z(0,"option",72),$e(1),Te(2,rY,2,0,"ng-container",9),ne()),2&t){const e=n.$implicit,i=ge(2);pt("color",e.color),Mt("value",e.identifier),V(1),Zn("",e.name," "),V(1),ie("ngIf",e===i.myPeer)}}function sY(t,n){if(1&t&&(Z(0,"option",73),$e(1),ne()),2&t){const e=n.$implicit;Mt("value",e.identifier),V(1),dt(e.name)}}function aY(t,n){1&t&&(Z(0,"span",48)(1,"i",76),$e(2,"check"),ne(),Z(3,"span",77),$e(4,"Link OK"),ne()())}function lY(t,n){if(1&t&&(Z(0,"span",78),vt(1,"i",79),Z(2,"span",80),$e(3,"\u26a0\ufe0fLink NG:"),ne(),$e(4),ne()),2&t){const e=ge(3);V(4),Zn(" ",e.cutInAudioFileName,"")}}function cY(t,n){if(1&t&&(it(0),Te(1,aY,5,0,"span",74),Te(2,lY,5,1,"span",75),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isValidAudio),V(1),ie("ngIf",!e.isValidAudio)}}function uY(t,n){if(1&t&&(Z(0,"div",86),$e(1),ne()),2&t){const e=ge(3);V(1),Zn("",e.progresPercent,"%")}}const dY=function(t){return{"is-hidden":t}};function fY(t,n){if(1&t){const e=gt();it(0),Z(1,"button",8),Ae("click",function(){return Fe(e),Re(ge(2).upTabIndex())}),$e(2,"\u2191"),ne(),Z(3,"button",8),Ae("click",function(){return Fe(e),Re(ge(2).downTabIndex())}),$e(4,"\u2193"),ne(),Z(5,"div",19)(6,"button",81),Ae("click",function(){return Fe(e),Re(ge(2).save())}),Z(7,"div",82)(8,"div",83),$e(9,"\u4fdd\u5b58"),ne(),Te(10,uY,2,1,"div",84),ne()(),Z(11,"button",85),Ae("click",function(){return Fe(e),Re(ge(2).delete())}),$e(12,"\u524a\u9664"),ne()(),rt()}if(2&t){const e=ge(2);V(6),ie("disabled",e.isSaveing),V(2),ie("ngClass",wt(3,dY,e.isSaveing)),V(2),ie("ngIf",e.isSaveing)}}function hY(t,n){if(1&t){const e=gt();it(0),Z(1,"button",8),Ae("click",function(){return Fe(e),Re(ge(2).restore())}),$e(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}const pY=function(t){return{blackout:t}},gY=function(t){return{"red-eye":t}},FI=function(t){return{"not-specified":t}},mY=function(t,n){return{color:t,"font-weight":n}};function _Y(t,n){if(1&t){const e=gt();it(0),Z(1,"div",11)(2,"div")(3,"div",12),Ae("dblclick",function(){Fe(e);const r=ge();return Re(!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal())}),Te(4,eY,3,3,"div",13),Te(5,nY,2,1,"div",14),Te(6,iY,3,1,"div",15),vt(7,"img",16),zt(8,"safe"),ne()(),Z(9,"div",17)(10,"div",18)(11,"div",19)(12,"label",20)(13,"input",21),Ae("click",function(r){return Fe(e),Re(ge().onShowHiddenImages(r))}),ne(),Z(14,"i",22),$e(15),ne()()()(),Z(16,"div",23)(17,"b",24),$e(18,"Name: "),ne(),Z(19,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInName=r)}),ne(),Z(20,"b",26),$e(21,"Tag: "),ne(),Z(22,"input",27),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInTag=r)}),ne()(),Z(23,"div",28)(24,"b",24),$e(25,"Duration (0=\u7121\u5236\u9650): "),ne(),Z(26,"input",29),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInDuration=r)}),ne(),Z(27,"b",30),$e(28,"sec."),ne()(),Z(29,"div",23)(30,"b",24),$e(31,"Cut In: "),ne(),Z(32,"select",31),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInType=r)}),Z(33,"option",32),$e(34,"\u5373\u6642\u51fa\u73fe"),ne(),Z(35,"option",32),$e(36,"\u6d6e\u304d\u51fa\u308b"),ne(),Z(37,"option",32),$e(38,"\u98db\u3073\u51fa\u3059"),ne(),Z(39,"option",32),$e(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),ne(),Z(41,"option",32),$e(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),ne()(),Z(43,"label",33)(44,"input",34),Ae("click",function(){Fe(e);const r=ge();return Re(r.borderStyle=0==r.borderStyle?1:0)}),ne(),Z(45,"b"),$e(46,"\u67a0\u3042\u308a"),ne()()(),Z(47,"div",23)(48,"b",24),$e(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),ne(),vt(50,"br"),Z(51,"textarea",35),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInCond=r)}),ne()()()(),Z(52,"div",36)(53,"div")(54,"button",8),Ae("click",function(){return Fe(e),Re(ge().testCutIn())}),Z(55,"b"),$e(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Z(57,"sup",37),$e(58,"*"),ne()()(),Z(59,"span",38)(60,"button",39),Ae("click",function(){return Fe(e),Re(ge().playCutIn())}),Z(61,"b")(62,"i",40),$e(63,"play_arrow"),ne(),$e(64,"\u518d\u751f"),ne()(),Z(65,"button",41),Ae("click",function(){return Fe(e),Re(ge().stopCutIn())}),Z(66,"b")(67,"i",40),$e(68,"stop"),ne(),$e(69,"\u505c\u6b62"),ne()(),Z(70,"span",42),$e(71," \u27a1 "),Z(72,"select",43),Ae("ngModelChange",function(r){return Fe(e),Re(ge().sendTo=r)}),Z(73,"option",44),$e(74,"\u5168\u54e1"),ne(),Te(75,oY,3,5,"option",45),ne()()()(),Z(76,"div",46)(77,"div")(78,"b",47),$e(79,"\u4f4d\u7f6e"),ne(),Z(80,"label",48)(81,"input",49),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInIsPreventOutBounds=r)}),ne(),Z(82,"b"),$e(83,"\u898b\u5207\u308c\u9632\u6b62"),ne()()(),Z(84,"div",50)(85,"b"),$e(86,"PosX: "),ne(),Z(87,"input",51),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInPosX=r)}),ne(),Z(88,"input",52),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInPosX=r)}),ne(),Z(89,"b",23),$e(90,"%"),ne()(),Z(91,"div",50)(92,"b"),$e(93,"PosY: "),ne(),Z(94,"input",53),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInPosY=r)}),ne(),Z(95,"input",52),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInPosY=r)}),ne(),Z(96,"b",23),$e(97,"%"),ne()(),Z(98,"div",50)(99,"b"),$e(100,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),ne(),Z(101,"input",52),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInZIndex=r)}),ne(),Z(102,"label",48)(103,"input",54),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInIsFrontOfStand=r)}),ne(),Z(104,"b"),$e(105,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),ne()()()(),Z(106,"div",46)(107,"div")(108,"b",47),$e(109,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),ne()(),Z(110,"div",50)(111,"b"),$e(112,"Width (0=\u6307\u5b9a\u306a\u3057): "),ne(),Z(113,"input",55),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInWidth=r)}),ne(),Z(114,"input",52),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInWidth=r)}),ne(),Z(115,"b",23),$e(116,"%"),ne()(),Z(117,"div",50)(118,"b"),$e(119,"Height (0=\u6307\u5b9a\u306a\u3057): "),ne(),Z(120,"input",56),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInHeight=r)}),ne(),Z(121,"input",52),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInHeight=r)}),ne(),Z(122,"b",23),$e(123,"%"),ne()(),Z(124,"div",50)(125,"b"),$e(126,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),ne(),Z(127,"select",57),Ae("ngModelChange",function(r){return Fe(e),Re(ge().objectFitType=r)}),Z(128,"option",32),$e(129,"\u4f38\u7e2e\u3059\u308b"),ne(),Z(130,"option",32),$e(131,"\u5207\u308a\u53d6\u308b"),ne()()()(),Z(132,"div",46)(133,"div")(134,"b",47),$e(135,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),ne(),Z(136,"label",48)(137,"input",58),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInSEIsLoop=r)}),ne(),Z(138,"b"),$e(139,"\u7e70\u308a\u8fd4\u3057"),ne()()(),Z(140,"div",50)(141,"input",59),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInIsVideo=r)}),ne(),Z(142,"label",60)(143,"b"),$e(144,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),ne()(),Z(145,"select",61),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInAudioIdentifier=r)})("change",function(r){return Fe(e),Re(ge().onAudioFileChange(r.target.value))}),Z(146,"option",44),$e(147,"\u52b9\u679c\u97f3\u306a\u3057"),ne(),Te(148,sY,2,2,"option",62),ne(),Te(149,cY,3,2,"ng-container",9),ne(),Z(150,"div",50)(151,"input",59),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInIsVideo=r)}),ne(),Z(152,"label",60)(153,"b"),$e(154,"\u52d5\u753bURL: "),ne()(),Z(155,"input",63),Ae("ngModelChange",function(r){return Fe(e),Re(ge().cutInVideoURL=r)}),ne()(),Z(156,"div",64)(157,"a",65),Ae("click",function(){return Fe(e),Re(ge().openYouTubeTerms())}),$e(158,"YouTube \u5229\u7528\u898f\u7d04"),ne()()()(),vt(159,"hr"),Z(160,"div"),Te(161,fY,13,5,"ng-container",9),Te(162,hY,3,0,"ng-container",9),ne(),rt()}if(2&t){const e=ge();V(4),ie("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),V(1),ie("ngIf",e.isEditable),V(1),ie("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),V(1),ie("ngClass",wt(125,pY,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",jt(8,122,e.cutInImageUrl,"resourceUrl"),vn),V(6),Mt("checked",e.isShowHideImages?"checked":""),V(1),ie("ngClass",wt(127,gY,e.isShowHideImages)),V(1),dt(e.isShowHideImages?"visibility":"visibility_off"),V(4),ie("ngModel",e.cutInName),rn("disabled",e.isEditable?null:""),V(3),ie("ngModel",e.cutInTag),rn("disabled",e.isEditable?null:""),V(4),ie("ngModel",e.cutInDuration),rn("disabled",!e.isEditable||e.isPlaying?"":null),V(6),ie("ngModel",e.cutInType),rn("disabled",e.isEditable?null:""),V(1),ie("value",-1)("selected",-1==e.cutInType),V(2),ie("value",0)("selected",0==e.cutInType),V(2),ie("value",1)("selected",1==e.cutInType),V(2),ie("value",2)("selected",2==e.cutInType),V(2),ie("value",3)("selected",3==e.cutInType),V(3),ie("checked",1==e.borderStyle),rn("disabled",e.isEditable?null:""),V(7),ie("ngModel",e.cutInCond),rn("disabled",e.isEditable?null:""),V(3),rn("disabled",e.isEditable?null:""),V(6),rn("disabled",e.isEditable?null:""),V(5),rn("disabled",e.isEditable?null:""),V(7),ie("ngModel",e.sendTo)("ngClass",wt(129,FI,""==e.sendTo))("ngStyle",fn(131,mY,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),V(3),ie("ngForOf",e.otherPeers),V(6),ie("ngModel",e.cutInIsPreventOutBounds)("checked",e.cutInIsPreventOutBounds)("value",!0),rn("disabled",!e.isEditable||e.cutInVideoId?"":null),V(6),Mt("title",e.cutInPosX),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.cutInPosX),rn("disabled",e.isEditable?null:""),V(1),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.cutInPosX),rn("disabled",e.isEditable?null:""),V(6),Mt("title",e.cutInPosY),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.cutInPosY),rn("disabled",e.isEditable?null:""),V(1),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.cutInPosY),rn("disabled",e.isEditable?null:""),V(6),Mt("min",-e.maxSize),Mt("max",e.maxSize),ie("ngModel",e.cutInZIndex),rn("disabled",!e.isEditable||e.cutInVideoId?"":null),V(2),ie("ngModel",e.cutInIsFrontOfStand)("checked",e.cutInIsFrontOfStand)("value",!0),rn("disabled",!e.isEditable||e.cutInVideoId?"":null),V(10),Mt("title",e.cutInWidth),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.cutInWidth),rn("disabled",e.isEditable?null:""),V(1),Mt("min",e.minSize),Mt("max",2*e.maxSize),ie("ngModel",e.cutInWidth),rn("disabled",e.isEditable?null:""),V(6),Mt("title",e.cutInHeight),Mt("min",e.minSize),Mt("max",e.maxSize),ie("ngModel",e.cutInHeight),rn("disabled",e.isEditable?null:""),V(1),Mt("min",e.minSize),Mt("max",2*e.maxSize),ie("ngModel",e.cutInHeight),rn("disabled",e.isEditable?null:""),V(6),ie("ngModel",e.objectFitType),rn("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),V(1),ie("value",0)("selected",0==e.objectFitType),V(2),ie("value",1)("selected",1==e.objectFitType),V(7),ie("ngModel",e.cutInSEIsLoop)("checked",e.cutInSEIsLoop)("value",!0),rn("disabled",!e.isEditable||e.isPlaying?"":null),V(4),ur("name","",e.panelId,"-media")("id","",e.panelId,"-media-sound"),ie("ngModel",e.cutInIsVideo)("checked",!e.cutInIsVideo)("value",!1),rn("disabled",!e.isEditable||e.isPlaying?"":null),V(1),ur("for","",e.panelId,"-media-sound"),V(3),pt("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),ie("ngModel",e.cutInAudioIdentifier)("ngClass",wt(134,FI,""==e.cutInAudioIdentifier)),rn("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),V(3),ie("ngForOf",e.audios),V(1),ie("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),V(2),ur("name","",e.panelId,"-media")("id","",e.panelId,"-media-video"),ie("ngModel",e.cutInIsVideo)("checked",e.cutInIsVideo)("value",!0),rn("disabled",!e.isEditable||e.isPlaying?"":null),V(1),ur("for","",e.panelId,"-media-video"),V(3),ie("ngModel",e.cutInVideoURL),rn("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),V(6),ie("ngIf",!e.isDeleted),V(1),ie("ngIf",e.isDeleted&&e.selectedCutInXml)}}function $Y(t,n){if(1&t){const e=gt();it(0),Z(1,"button",8),Ae("click",function(){return Fe(e),Re(ge(2).restore())}),$e(2,"\u5143\u306b\u623b\u3059"),ne(),rt()}}function vY(t,n){if(1&t&&(it(0),Z(1,"div",87),$e(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),Te(3,$Y,3,0,"ng-container",9),ne(),rt()),2&t){const e=ge();V(3),ie("ngIf",e.isDeleted&&e.selectedCutInXml)}}let bY=(()=>{class t{constructor(e,i,r,o,s,a){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=o,this.saveDataService=s,this.chatMessageService=a,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}get cutIns(){return Os.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==Et.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&Kt.instance.get(this.selectedCutIn.imageIdentifier)||sn.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:sn.Empty.url}get isPlaying(){return!!this.selectedCutIn&&$g.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return Je.myCursor}get otherPeers(){return Et.instance.getObjects(Je)}get myColor(){return Je.myCursor&&Je.myCursor.color&&Je.myCursor.color!=Je.CHAT_TRANSPARENT_COLOR?Je.myCursor.color:Je.CHAT_DEFAULT_COLOR}get sendToColor(){let e=Et.instance.get(this.sendTo);return e instanceof Je?e.color:Je.CHAT_DEFAULT_COLOR}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),Ve.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=yo.generateUuid()}ngAfterViewInit(){this.cutIns.length>0&&queueMicrotask(()=>{this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Ve.unregister(this)}onChangeCutIn(e){this.selectedCutIn=Et.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return Os.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,hn.Z)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.selectedCutIn||(Ve.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=gi.instance.parseXml(this.selectedCutInXml);Os.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=Vn.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(da,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(gr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Bi.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:Je.myCursor.peerId};if(i.secret){const r=Et.instance.get(this.sendTo);r&&(r.peerId!=Je.myCursor.peerId&&Ve.call("PLAY_CUT_IN",i,r.peerId),Ve.call("PLAY_CUT_IN",i,Je.myCursor.peerId))}else Ve.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:Je.myCursor.peerId};if(e.secret){const i=Et.instance.get(this.sendTo);i&&(i.peerId!=Je.myCursor.peerId&&Ve.call("STOP_CUT_IN",e,i.peerId),Ve.call("STOP_CUT_IN",e,Je.myCursor.peerId))}else Ve.call("STOP_CUT_IN",e)}testCutIn(){!this.selectedCutIn||queueMicrotask(()=>{Ve.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=Jt.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(co,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(vc,{left:e.x,top:e.y,width:600,height:620});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${nS.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ki),Ge(vi),Ge(Yn),Ge(Wn),Ge(qr),Ge(Vr))},t.\u0275cmp=mn({type:t,selectors:[["app-cut-in-setting"]],viewQuery:function(e,i){if(1&e&&Tn(QK,5),2&e){let r;En(r=Sn())&&(i.cutInSelecter=r.first)}},decls:14,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","12em",3,"change"],["cutInSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],[2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModel","ngModelChange"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"checked","click"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModel","checked","value","ngModelChange"],[2,"padding-left","1em"],["type","range","name","cutInPosX",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","3.5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","cutInPosY",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","range","name","cutInWidth",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","range","name","cutIHeight",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],[3,"ngModel","ngModelChange"],["name","cutInSEIsLoop","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","radio",3,"name","id","ngModel","checked","value","ngModelChange"],[3,"for"],[3,"ngModel","ngClass","ngModelChange","change"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","text",2,"width","24em",3,"ngModel","ngModelChange"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ae("click",function(){return i.add()}),$e(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),ne()(),Z(5,"select",3,4),Ae("change",function(o){return i.onChangeCutIn(o.target.value)}),Te(7,JK,2,5,"option",5),ne()(),Z(8,"div",6)(9,"div",7)(10,"button",8),Ae("click",function(){return i.helpCutIn()}),$e(11,"?"),ne()(),Te(12,_Y,163,136,"ng-container",9),ne()(),Te(13,vY,4,1,"ng-container",9)),2&e&&(V(7),ie("ngForOf",i.cutIns),V(5),ie("ngIf",!i.isEmpty&&i.selectedCutIn),V(1),ie("ngIf",i.isEmpty))},dependencies:[oi,$i,Rn,hr,so,ao,Ii,Ro,Lo,Fo,vo,sl,Mi,Ys,Ks,Ci,_i],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]}),t})();function RI(t){return new F(n=>{Cr(t()).subscribe(n)})}const CY=["addListener","removeListener"],xY=["addEventListener","removeEventListener"],wY=["on","off"];function Rg(t,n,e,i){if(d(e)&&(i=e,e=void 0),i)return Rg(t,n,e).pipe(rf(i));const[r,o]=function SY(t){return d(t.addEventListener)&&d(t.removeEventListener)}(t)?xY.map(s=>a=>t[s](n,a,e)):function EY(t){return d(t.addListener)&&d(t.removeListener)}(t)?CY.map(LI(t,n)):function TY(t){return d(t.on)&&d(t.off)}(t)?wY.map(LI(t,n)):[];if(!r&&sr(t))return Ls(s=>Rg(s,n,e))(Cr(t));if(!r)throw new TypeError("Invalid event target");return new F(s=>{const a=(...h)=>s.next(1<h.length?h:h[0]);return r(a),()=>o(a)})}function LI(t,n){return e=>i=>t[e](n,i)}const wl=new F(N);class IY extends x{constructor(n,e){super()}schedule(n,e=0){return this}}const Lg={setInterval(t,n,...e){const{delegate:i}=Lg;return i?.setInterval?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=Lg;return(n?.clearInterval||clearInterval)(t)},delegate:void 0},BI={now:()=>(BI.delegate||Date).now(),delegate:void 0};class Gf{constructor(n,e=Gf.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}Gf.now=BI.now;const zI=new class kY extends Gf{constructor(n,e=Gf.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}(class MY extends IY{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,e),this}requestAsyncId(n,e,i=0){return Lg.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&Lg.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,i=!1;try{this.work(n)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,_(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),DY=zI;function jI(t,n){return n?e=>mg(n.pipe(ra(1),function AY(){return C((t,n)=>{t.subscribe($(n,N))})}()),e.pipe(jI(t))):Ls((e,i)=>t(e,i).pipe(ra(1),function PY(t){return se(()=>t)}(e)))}const qf="Service workers are disabled or not supported by this browser";class Bg{constructor(n){if(this.serviceWorker=n,n){const i=Rg(n,"controllerchange").pipe(se(()=>n.controller)),o=mg(RI(()=>vl(n.controller)),i);this.worker=o.pipe(mc(ee=>!!ee)),this.registration=this.worker.pipe(Nf(()=>n.getRegistration()));const b=Rg(n,"message").pipe(se(ee=>ee.data)).pipe(mc(ee=>ee&&ee.type)).pipe(KT());b.connect(),this.events=b}else this.worker=this.events=this.registration=function RY(t){return RI(()=>function yY(t,n){const e=d(t)?t:()=>t,i=r=>r.error(e());return new F(n?r=>n.schedule(i,0,r):i)}(new Error(t)))}(qf)}postMessage(n,e){return this.worker.pipe(ra(1),qT(i=>{i.postMessage({action:n,...e})})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const r=this.waitForOperationCompleted(i),o=this.postMessage(n,e);return Promise.all([o,r]).then(([,s])=>s)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(mc(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(ra(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(mc(e=>e.nonce===n),ra(1),se(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let LY=(()=>{class t{constructor(e){if(this.sw=e,this.subscriptionChanges=new u,!e.isEnabled)return this.messages=wl,this.notificationClicks=wl,void(this.subscription=wl);this.messages=this.sw.eventsOfType("PUSH").pipe(se(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(se(r=>r.data)),this.pushManager=this.sw.registration.pipe(se(r=>r.pushManager));const i=this.pushManager.pipe(Nf(r=>r.getSubscription()));this.subscription=ga(i,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(qf));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);return i.applicationServerKey=o,this.pushManager.pipe(Nf(s=>s.subscribe(i)),ra(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(ra(1),Nf(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(qf))}decodeBase64(e){return atob(e)}}return t.\u0275fac=function(e){return new(e||t)($n(Bg))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})(),UI=(()=>{class t{constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=wl,this.available=wl,this.activated=wl,void(this.unrecoverable=wl);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.available=this.versionUpdates.pipe(mc(i=>"VERSION_READY"===i.type),se(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(qf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(qf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return t.\u0275fac=function(e){return new(e||t)($n(Bg))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class Uv{}const HI=new Dn("NGSW_REGISTER_SCRIPT");function BY(t,n,e,i){return()=>{if(!D$(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)r=e.registrationStrategy();else{const[s,...a]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":r=vl(null);break;case"registerWithDelay":r=VI(+a[0]||0);break;case"registerWhenStable":r=a[0]?ga(GI(t),VI(+a[0])):GI(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(Fn).runOutsideAngular(()=>r.pipe(ra(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(s=>console.error("Service worker registration failed with:",s))))}}function VI(t){return vl(null).pipe(function FY(t,n=zI){const e=function OY(t=0,n,e=DY){let i=-1;return null!=n&&(qo(n)?e=n:i=n),new F(r=>{let o=function NY(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let s=0;return e.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(t,n);return jI(()=>e)}(t))}function GI(t){return t.get(Wd).isStable.pipe(mc(e=>e))}function zY(t,n){return new Bg(D$(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}let jY=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[{provide:HI,useValue:e},{provide:Uv,useValue:i},{provide:Bg,useFactory:zY,deps:[Uv,qd]},{provide:r$,useFactory:BY,deps:[ws,HI,Uv,qd],multi:!0}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({providers:[LY,UI]}),t})();const UY=["modalLayer"];function HY(t,n){if(1&t){const e=gt();Z(0,"li",3),Ae("click",function(){return Fe(e),Re(ge().save())}),Z(1,"a",4)(2,"div")(3,"i",6),$e(4,"sd_storage"),ne()(),Z(5,"div"),$e(6,"\u4fdd\u5b58"),ne()()()}}function VY(t,n){if(1&t&&(Z(0,"li",16)(1,"a")(2,"div")(3,"i",17),$e(4,"sd_storage"),ne()(),Z(5,"div"),$e(6),ne()()()),2&t){const e=ge();V(6),Zn("",e.progresPercent,"%")}}function GY(t,n){if(1&t){const e=gt();Z(0,"div",18),Ae("click",function(){return Fe(e),Re(ge().closeImagePreview())}),Z(1,"div",19)(2,"i",6),$e(3,"close"),ne()(),vt(4,"img",20),zt(5,"safe"),ne()}if(2&t){const e=ge();ie("@fadeInOut","in"),V(4),ie("src",jt(5,2,e.imageUrl,"resourceUrl"),vn)}}const qY=function(t){return{horizontal:t}};let Xu=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de,_e){var Ce=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=o,this.chatMessageService=s,this.appConfigService=a,this.saveDataService=h,this.ngZone=b,this.contextMenuService=ee,this.standImageService=de,this.cutInService=_e,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.noticeIntervalTimer=null,this.ngZone.runOutsideAngular(()=>{sa.instance.initialize(),ju.instance.initialize(),zu.instance.initialize(),Uu.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Sr.instance.initialize(),Fs.instance.initialize(),la.instance.initialize(),new Xn("DiceBot",this.chatMessageService).initialize(),Xn.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new xc("Jukebox").initialize(),new St("SoundEffect").initialize(),Fs.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Fs.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,Os.instance.initialize();let He=new Ra("SampleDiceRollTable");He.initialize(),He.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",He.command="SAMPLE",He.dice="1d6",He.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",Ns.instance.addDiceRollTable(He);let Ue=sn.createEmpty("none_icon").toContext();Ue.url="./assets/images/ic_account_circle_black_24dp_2x.png";let We=Kt.instance.add(Ue);Vn.create(We.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",Ue=sn.createEmpty("stand_no_image").toContext(),Ue.url="./assets/images/nc96424.png";let mt=Kt.instance.add(Ue);Vn.create(mt.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9";try{Nn.getItem(st.MAIN_VOLUME_LOCAL_STORAGE_KEY).then(Xe=>{"number"==typeof Xe&&0<=Xe&&Xe<=1&&(st.volume=Xe)}),Nn.getItem(st.AUDITION_VOLUME_LOCAL_STORAGE_KEY).then(Xe=>{"number"==typeof Xe&&0<=Xe&&Xe<=1&&(st.auditionVolume=Xe)}),Nn.getItem(st.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).then(Xe=>{"number"==typeof Xe&&0<=Xe&&Xe<=1&&(st.soundEffectVolume=Xe)}),Nn.getItem(st.NOTICE_VOLUME_LOCAL_STORAGE_KEY).then(Xe=>{"number"==typeof Xe&&0<=Xe&&Xe<=1&&(st.noticeVolume=Xe)}),Nn.getItem(st.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).then(Xe=>st.isMute=!!Xe),Nn.getItem(st.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).then(Xe=>st.isAuditionMute=!!Xe),Nn.getItem(st.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).then(Xe=>st.isSoundEffectMute=!!Xe),Nn.getItem(st.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).then(Xe=>st.isNoticeMute=!!Xe)}catch(Xe){console.log(Xe)}st.resumeAudioContext(),at.dicePick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,at.dicePut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,at.diceRoll1=Jt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,at.diceRoll2=Jt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,at.cardDraw=Jt.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,at.cardPick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,at.cardPut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,at.cardShuffle=Jt.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,at.piecePick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,at.piecePut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,at.blockPick=Jt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,at.blockPut=Jt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,at.lock=Jt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,at.unlock=Jt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,at.sweep=Jt.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,at.puyon=Jt.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,at.surprise=Jt.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,at.coinToss=Jt.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,Jt.instance.get(at.dicePick).isHidden=!0,Jt.instance.get(at.dicePut).isHidden=!0,Jt.instance.get(at.diceRoll1).isHidden=!0,Jt.instance.get(at.diceRoll2).isHidden=!0,Jt.instance.get(at.cardDraw).isHidden=!0,Jt.instance.get(at.cardPick).isHidden=!0,Jt.instance.get(at.cardPut).isHidden=!0,Jt.instance.get(at.cardShuffle).isHidden=!0,Jt.instance.get(at.piecePick).isHidden=!0,Jt.instance.get(at.piecePut).isHidden=!0,Jt.instance.get(at.blockPick).isHidden=!0,Jt.instance.get(at.blockPut).isHidden=!0,Jt.instance.get(at.lock).isHidden=!0,Jt.instance.get(at.unlock).isHidden=!0,Jt.instance.get(at.sweep).isHidden=!0,Jt.instance.get(at.puyon).isHidden=!0,Jt.instance.get(at.surprise).isHidden=!0,Jt.instance.get(at.coinToss).isHidden=!0,Je.createMyCursor().then(()=>{(null==Je.myCursor.name||""===Je.myCursor.name)&&(Je.myCursor.name=Je.CHAT_DEFAULT_NAME),Je.myCursor.imageIdentifier||(Je.myCursor.imageIdentifier=We.identifier)}),Ve.register(this).on("UPDATE_GAME_OBJECT",Xe=>{this.lazyNgZoneUpdate(Xe.isSendFromSelf)}).on("DELETE_GAME_OBJECT",Xe=>{this.lazyNgZoneUpdate(Xe.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",Xe=>{Xe.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",Xe=>{Xe.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",Xe=>{if(console.log("LOAD_CONFIG !!!",Xe.data),Xe.data.dice&&Xe.data.dice.url){const ct=Xe.data.dice.api;fetch(Xe.data.dice.url+(1==ct?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(It=>It.json()).then(It=>{let ot=Xe.data.dice.url;Xn.apiUrl=ot.endsWith("/")?ot.substring(0,ot.length-1):ot,Xn.apiVersion=ct,Xn.diceBotInfos=[];let _t=(1==ct?It.names:It.game_system).filter(Ct=>"DiceBot"!=(1==ct?Ct.system:Ct.id)).map(Ct=>{let xt=Ct.sort_key&&Ct.sort_key.indexOf("\u56fd\u969b\u5316")<0?Ct.sort_key:Ct.name.normalize("NFKD");for(let Gt of Xn.replaceData)Gt[2]&&Ct.name===Gt[0]&&(xt=Gt[1],Ct.name=Gt[2]),xt=xt.split(Gt[0].normalize("NFKD")).join(Gt[1].normalize("NFKD"));return Ct.normalize=xt.replace(/[\u3041-\u3096]/g,Gt=>String.fromCharCode(Gt.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),Ct}).map(Ct=>{const xt=/.+\:(.+)/.exec(1==ct?Ct.system:Ct.id);return Ct.lang=xt?xt[1]:"A",Ct}).sort((Ct,xt)=>Ct.lang<xt.lang?-1:Ct.lang>xt.lang?1:Ct.normalize==xt.normalize?0:Ct.normalize<xt.normalize?-1:1);if(Xn.diceBotInfos.push(..._t.map(Ct=>({script:1==ct?Ct.system:Ct.id,game:Ct.name}))),_t.length>0){let Ct=_t[0].normalize.substring(0,1),xt={index:_t[0].normalize.substring(0,1),infos:[]};for(let Gt of _t){let on="Other"==Gt.lang?"\u305d\u306e\u4ed6":"ChineseTraditional"==Gt.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==Gt.lang?"\ud55c\uad6d\uc5b4":"English"==Gt.lang?"English":"SimplifiedChinese"==Gt.lang?"\u7b80\u4f53\u4e2d\u6587":Gt.normalize.substring(0,1);on!==Ct&&(Ct=on,Xn.diceBotInfosIndexed.push(xt),xt={index:on,infos:[]}),xt.infos.push({script:1==ct?Gt.system:Gt.id,game:Gt.name})}Xn.diceBotInfosIndexed.push(xt),Xn.diceBotInfosIndexed.sort((Gt,on)=>Gt.index==on.index?0:Gt.index<on.index?-1:1)}})}else{Xn.diceBotInfos.forEach(ot=>{let _t=ot.sort_key.normalize("NFKD");for(let Ct of Xn.replaceData)Ct[2]&&ot.game===Ct[0]&&(_t=Ct[1],ot.game=Ct[2]),_t=_t.split(Ct[0].normalize("NFKD")).join(Ct[1].normalize("NFKD"));_t=_t.replace(/[\u3041-\u3096]/g,Ct=>String.fromCharCode(Ct.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),ot.sort_key=ot.lang?ot.lang:_t.normalize("NFKD")}),Xn.diceBotInfos.sort((ot,_t)=>"Other"==ot.sort_key&&"Other"==_t.sort_key?0:"Other"==ot.sort_key?1:"Other"==_t.sort_key?-1:ot.sort_key==_t.sort_key?0:ot.sort_key<_t.sort_key?-1:1);let ct=Xn.diceBotInfos[0].sort_key[0],It={index:ct,infos:[]};for(let ot of Xn.diceBotInfos)"Other"==ot.lang&&(ot.lang="\u7b80\u4f53\u4e2d\u6587"),(ot.lang?ot.lang:ot.sort_key[0])!==ct&&(ct=ot.lang?ot.lang:ot.sort_key[0],Xn.diceBotInfosIndexed.push(It),It={index:ct,infos:[]}),It.infos.push({script:ot.id,game:ot.game});Xn.diceBotInfosIndexed.push(It)}Xn.diceBotInfosIndexed.sort((ct,It)=>ct.index==It.index?0:ct.index<It.index?-1:1),Lt.setApiKey(Xe.data.webrtc.key),Lt.open()}).on("FILE_LOADED",Xe=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",Xe=>{console.log("OPEN_NETWORK",Xe.data.peerId),Je.myCursor.peerId=Lt.peerContext.peerId,Je.myCursor.userId=Lt.peerContext.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",Xe=>{console.log("NETWORK_ERROR",Xe.data.peerId);let ct=Xe.data.errorType,It=Xe.data.errorMessage;this.ngZone.run((0,hn.Z)(function*(){["peer-unavailable"].includes(ct)||(yield Ce.modalService.open(vc,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:It}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(ct)&&(yield Ce.modalService.open(vc,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),Lt.open(),Ce.isLoggedin=!1))}))}).on("CONNECT_PEER",Xe=>{Xe.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,s.sendOperationLog((Lt.peerContext.isRoom?Lt.peerContext.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(Xe.isSendFromSelf)}).on("DISCONNECT_PEER",Xe=>{this.lazyNgZoneUpdate(Xe.isSendFromSelf),Xe.isSendFromSelf&&(this.isLoggedin=!1)}).on("MESSAGE_NORTIFICATION",Xe=>{Ec.isNoticeOn?this.noticeIntervalTimer||(this.noticeIntervalTimer=setTimeout(()=>{clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null},100),this.notice()):this.noticeIntervalTimer&&(clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null)}).on("PLAY_CUT_IN",-1e3,Xe=>{let ct=Et.instance.get(Xe.data.identifier);this.cutInService.play(ct,!!Xe.data.secret&&Xe.data.secret,!!Xe.data.test&&Xe.data.test,Xe.data.sender)}).on("STOP_CUT_IN",-1e3,Xe=>{this.cutInService.stop(Xe.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,Xe=>{let ct=Et.instance.get(Xe.data.standIdentifier),It=Et.instance.get(Xe.data.characterIdentifier);this.standImageService.show(It,ct,Xe.data.color?Xe.data.color:null,Xe.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,Xe=>{this.standImageService.farewell(Xe.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,Xe=>{this.standImageService.destroy(Xe.data.characterIdentifier,Xe.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,Xe=>{this.standImageService.destroyAll()})}get imageUrl(){return t.imageUrl}get otherPeers(){return Et.instance.getObjects(Je)}static get noticePlayer(){return t._noticePlayer||(t._noticePlayer=new st,t._noticePlayer.volumeType=Go.NOTICE),t._noticePlayer}notice(e=at.puyon){const i=Jt.instance.get(e);i&&i.isReady?(Ve.unregister(this,"UPDATE_AUDIO_RESOURE"),t.noticePlayer.play(i)):Ve.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.notice(e)})}ngOnInit(){window.addEventListener("beforeunload",t.beforeUnloadProc)}ngAfterViewInit(){let e;Wn.defaultParentViewContainerRef=Yn.defaultParentViewContainerRef=pr.defaultParentViewContainerRef=$r.defaultParentViewContainerRef=$g.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(jv,{width:520,height:450,left:100}),this.panelService.open(Ec,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(i=>{switch(i.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${i.version.hash}`),Notification.requestPermission().then(r=>{"granted"===r&&(e=new Notification("Udonarium with Fly",{body:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u4e2d\u3067\u3059\u3002",icon:"card.png"}),e.addEventListener("click",function(){return e&&(e.close(),e=null),!1}))});break;case"VERSION_READY":console.log(`Current app version: ${i.currentVersion.hash}`),console.log(`New app version ready for use: ${i.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(gr,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",helpHtml:'<b style="color: red">\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002</b>\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002',type:Bi.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${i.version.hash}': ${i.error}`)}})}ngOnDestroy(){Ve.unregister(this),this.noticeIntervalTimer&&clearTimeout(this.noticeIntervalTimer)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=jv;break;case"ChatWindowComponent":i=Ec,r.width=700;break;case"GameTableSettingComponent":i=kS,r={width:610,height:400,left:100};break;case"FileStorageComponent":i=hs,r.width=700;break;case"GameCharacterSheetComponent":i=ps;break;case"JukeboxComponent":i=XV,r.height=540;break;case"GameCharacterGeneratorComponent":i=GU,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=EV;break;case"DiceRollTableSettingComponent":i=XK,r={width:645,height:475};break;case"CutInSettingComponent":i=bY,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,hn.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=Lt.peerContext&&0<Lt.peerContext.roomName.length?Lt.peerContext.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&sa.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=[],a=Os.instance.cutIns;s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===a.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:a.map(h=>({name:`${h.isValidAudio?"":"\u26a0\ufe0f"}${""==h.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":h.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{Ve.call("PLAY_CUT_IN",{identifier:h.identifier,secret:!1,sender:Je.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==h.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":h.name)+" \u3092\u518d\u751f\u3057\u305f")}},qt,...this.otherPeers.map(b=>({name:b.name+(b===Je.myCursor?" (\u3042\u306a\u305f)":""),color:b.color,default:!0,action:()=>{b!==Je.myCursor&&Ve.call("PLAY_CUT_IN",{identifier:h.identifier,secret:!0,sender:Je.myCursor.peerId},b.peerId),Ve.call("PLAY_CUT_IN",{identifier:h.identifier,secret:!0,sender:Je.myCursor.peerId},Je.myCursor.peerId)}}))]}))}),s.push(qt),s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a...",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),s.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a...",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(o,s,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)};this.contextMenuService.open(o,[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>Ve.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>Ve.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=ua.isShowStand,a=ua.isShowNameTag,h=ua.isCanBeGone;this.contextMenuService.open(o,[{name:(Sr.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{Sr.instance.gridShow=!Sr.instance.gridShow,Ve.trigger("UPDATE_GAME_OBJECT",Sr.instance.toContext())}},{name:(Sr.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{Sr.instance.gridSnap=!Sr.instance.gridSnap}},qt,{name:(Ec.isNoticeOn?"\u2611":"\u2610")+"\u30c1\u30e3\u30c3\u30c8\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",action:()=>{Ec.isNoticeOn=!Ec.isNoticeOn}},qt,{name:(s?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{ua.isShowStand=!s}},{name:(a?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{ua.isShowNameTag=!a},level:1,disabled:!ua.isShowStand},{name:(h?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{ua.isCanBeGone=!h},level:1,disabled:!ua.isShowStand},qt,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>Ve.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(gr,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:Bi.OK_CANCEL,materialIcon:"all_out",action:()=>{Ve.trigger("DICE_ALL_OPEN",null)}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}closeImagePreview(){URL.revokeObjectURL(t.imageUrl),t.imageUrl=""}}return t.imageUrl="",t.beforeUnloadProc=n=>{n.preventDefault(),n.returnValue=""},t.\u0275fac=function(e){return new(e||t)(Ge(UI),Ge(Yn),Ge(Wn),Ge(vi),Ge(Vr),Ge(zv),Ge(qr),Ge(Fn),Ge(pr),Ge($r),Ge($g))},t.\u0275cmp=mn({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&Tn(UY,7,io),2&e){let r;En(r=Sn())&&(i.modalLayerViewContainerRef=r.first)}},decls:99,vars:14,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton","rotateEvent"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["routerLink","/","routerLinkActive","active",2,"pointer-events","none"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],["class","image-view-background is-fill",3,"click",4,"ngIf"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"]],template:function(e,i){1&e&&(Z(0,"div",0),vt(1,"game-table"),ne(),Z(2,"ui-panel",1),Ae("rotateEvent",function(o){return i.rotateChange(o)}),Z(3,"nav",2)(4,"ul")(5,"li",3),Ae("click",function(){return i.open("PeerMenuComponent")}),Z(6,"a",4)(7,"div")(8,"i",5),$e(9,"people"),ne()(),Z(10,"div"),$e(11,"\u63a5\u7d9a"),ne()()(),Z(12,"li",3),Ae("click",function(){return i.open("ChatWindowComponent")}),Z(13,"a",4)(14,"div")(15,"i",5),$e(16,"speaker_notes"),ne()(),Z(17,"div"),$e(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),ne()()(),Z(19,"li",3),Ae("click",function(){return i.open("GameTableSettingComponent")}),Z(20,"a",4)(21,"div")(22,"i",5),$e(23,"layers"),ne()(),Z(24,"div"),$e(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),ne()()(),Z(26,"li",3),Ae("click",function(){return i.open("FileStorageComponent")}),Z(27,"a",4)(28,"div")(29,"i",5),$e(30,"photo_library"),ne()(),Z(31,"div"),$e(32,"\u753b\u50cf"),ne()()(),Z(33,"li",3),Ae("click",function(){return i.open("JukeboxComponent")}),Z(34,"a",4)(35,"div")(36,"i",6),$e(37,"queue_music"),ne()(),Z(38,"div"),$e(39,"\u97f3\u697d"),ne()()(),Z(40,"li",3),Ae("click",function(o){return i.toolBox(o)}),Z(41,"a",7)(42,"div")(43,"i",6),$e(44,"build"),ne()(),Z(45,"div"),$e(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),ne()()(),Z(47,"li",3),Ae("click",function(){return i.open("GameObjectInventoryComponent")}),Z(48,"a",4)(49,"div")(50,"i",5),$e(51,"folder_shared"),ne()(),Z(52,"div"),$e(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne()()(),Z(54,"li",3),Ae("click",function(){return i.diceAllOpne()}),Z(55,"a",4)(56,"div")(57,"i",5),$e(58,"all_out"),ne()(),Z(59,"div"),$e(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),ne()()(),Z(61,"li",3),Ae("click",function(o){return i.standSetteings(o)}),Z(62,"a",7)(63,"div")(64,"i",5),$e(65,"how_to_reg"),ne()(),Z(66,"div"),$e(67,"\u500b\u4eba\u8a2d\u5b9a"),Z(68,"sup",8),$e(69,"*"),ne()()()(),Z(70,"li",3),Ae("click",function(o){return i.resetPointOfView(o)}),Z(71,"a",7)(72,"div")(73,"i",5),$e(74,"remove_red_eye"),ne()(),Z(75,"div"),$e(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),Z(77,"sup",8),$e(78,"*"),ne()()()(),Z(79,"li")(80,"a",4)(81,"label")(82,"div")(83,"i",6),$e(84,"open_in_browser"),ne()(),Z(85,"div"),$e(86,"ZIP\u8aad\u8fbc"),ne(),Z(87,"input",9),Ae("change",function(o){return i.handleFileSelect(o)}),ne()()()(),Te(88,HY,7,0,"li",10),Te(89,VY,7,1,"li",11),ne(),Z(90,"div",12)(91,"b")(92,"sup",8),$e(93,"*"),ne(),$e(94,"\u306f\u81ea\u5206\u306e\u307f"),ne()()()(),vt(95,"div",null,13)(97,"network-indicator",14),Te(98,GY,6,5,"div",15)),2&e&&(V(2),ie("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),V(1),ie("ngClass",wt(12,qY,i.isHorizontal)),V(85),ie("ngIf",!i.isSaveing),V(1),ie("ngIf",i.isSaveing),V(9),ie("ngIf",i.imageUrl))},styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:vibration .2s infinite}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:100000000000;position:absolute;inset:0;width:100%;height:100%;box-sizing:border-box;overflow:visible;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;display:flex;justify-content:center;align-items:center}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{display:block;max-width:calc(100% - 32px);max-height:calc(100% - 32px);min-width:100px;min-height:120px;box-sizing:border-box;-o-object-fit:contain;object-fit:contain}"],data:{animation:[Hn("fadeInOut",[en("void => *",[Qt("100ms ease-out",Cn([ht({opacity:0,offset:0}),ht({opacity:1,offset:1})]))]),en("* => void",[Qt("100ms ease-in",Cn([ht({opacity:1,offset:0}),ht({opacity:0,offset:1})]))])])]}}),t})();function WY(t,n){1&t&&vt(0,"badge",12),2&t&&ie("count",ge(2).countImagesHasWord(null))("@.disabled",!0)}function KY(t,n){if(1&t){const e=gt();Z(0,"label")(1,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge().searchNoTagImage=r)})("change",function(){Fe(e);const r=ge();return Re(r.searchNoTagImage=!!r.searchNoTagImage)}),ne(),Z(2,"div",26)(3,"s"),$e(4,"No Tag"),ne(),Te(5,WY,1,2,"badge",27),ne()()}if(2&t){const e=ge();V(1),Mt("checked",e.searchNoTagImage?"checked":""),ie("ngModel",e.searchNoTagImage),V(4),ie("ngIf",e.countImagesHasWord(null)>0)}}function YY(t,n){if(1&t&&vt(0,"badge",12),2&t){const e=ge().$implicit;ie("count",ge().countImagesHasWord(e))("@.disabled",!0)}}function ZY(t,n){if(1&t){const e=gt();Z(0,"label")(1,"input",28),Ae("change",function(){const o=Fe(e).$implicit;return Re(ge().onSelectedWord(o))}),ne(),Z(2,"div"),$e(3),Te(4,YY,1,2,"badge",27),ne()()}if(2&t){const e=n.$implicit,i=ge();V(1),Mt("value",e),ie("checked",i.searchWords.includes(e)),V(2),dt(e),V(1),ie("ngIf",i.countImagesHasWord(e)>0)}}function XY(t,n){1&t&&An(0)}function QY(t,n){if(1&t&&(Z(0,"label",43),$e(1),ne()),2&t){const e=ge().$implicit;V(1),dt(e)}}function JY(t,n){1&t&&(Z(0,"span",44),$e(1,"\u2026"),ne())}function eZ(t,n){if(1&t&&(it(0),Te(1,QY,2,1,"label",41),Te(2,JY,2,0,"span",42),rt()),2&t){const e=n.index;V(1),ie("ngIf",e<6),V(1),ie("ngIf",6==e)}}function tZ(t,n){if(1&t&&(Z(0,"div",40),Te(1,eZ,3,2,"ng-container",14),ne()),2&t){const e=ge().$implicit,i=ge();V(1),ie("ngForOf",i.getTagWords(e))}}function nZ(t,n){1&t&&(Z(0,"div",40)(1,"s",45),$e(2,"No Tag"),ne()())}function iZ(t,n){1&t&&(Z(0,"div",46)(1,"i",47),$e(2,"visibility"),ne()())}function rZ(t,n){if(1&t){const e=gt();Z(0,"img",48),Ae("click",function(){Fe(e);const r=ge().$implicit;return Re(ge().onSelectedFile(r))}),zt(1,"safe"),ne()}if(2&t){const e=ge().$implicit;ie("src",jt(1,2,e.url,"resourceUrl"),vn)("alt",e.name)}}function oZ(t,n){1&t&&vt(0,"img",49),2&t&&Mt("alt",ge().$implicit.name)}Wn.UIPanelComponentClass=OI,pr.ContextMenuComponentClass=VU,Yn.ModalComponentClass=eG;const sZ=function(t){return{selected:t}};function aZ(t,n){if(1&t){const e=gt();Z(0,"div",29)(1,"div",30),Te(2,XY,1,0,"ng-container",31),Te(3,tZ,2,1,"ng-template",null,32,Qn),Te(5,nZ,3,0,"ng-template",null,33,Qn),Z(7,"div",34)(8,"button",35),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().chanageImageView(o))}),Z(9,"i",36),$e(10,"zoom_in"),ne()()()(),Te(11,iZ,3,0,"div",37),Te(12,rZ,2,5,"img",38),Te(13,oZ,1,1,"img",39),ne()}if(2&t){const e=n.$implicit,i=dn(4),r=dn(6),o=ge();ie("@scaleInOut",void 0)("ngClass",wt(8,sZ,o.selected(e))),V(2),ie("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),V(9),ie("ngIf",o.getHidden(e)),V(1),ie("ngIf",0<e.url.length),V(1),ie("ngIf",e.url.length<=0)}}function lZ(t,n){if(1&t){const e=gt();Z(0,"label",59),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge(3).removeTagWord(o))}),$e(1),Z(2,"sup",60),$e(3,"\xd7"),ne()()}if(2&t){const e=n.$implicit;V(1),dt(e)}}function cZ(t,n){if(1&t&&(it(0),Te(1,lZ,4,1,"label",58),rt()),2&t){const e=ge(2);V(1),ie("ngForOf",e.selectedImagesOwnWords())}}function uZ(t,n){1&t&&(it(0),Z(1,"span",61)(2,"s"),$e(3,"No Tag"),ne()(),rt())}function dZ(t,n){if(1&t&&(Z(0,"option",62),$e(1),ne()),2&t){const e=n.$implicit;Mt("value",e),V(1),dt(e)}}const qI=function(t){return{"red-eye":t}};function fZ(t,n){if(1&t){const e=gt();Z(0,"div",50)(1,"div")(2,"div",51)(3,"button",52),Ae("click",function(){Fe(e);const r=ge();return Re(r.setectedImagesToHidden(!r.selectedImagesIsHidden))}),Z(4,"i",8),$e(5),ne()()(),Z(6,"button",53),Ae("click",function(){return Fe(e),Re(ge().onUnselect())}),$e(7),ne(),Z(8,"input",54),Ae("ngModelChange",function(r){return Fe(e),Re(ge().addingTagWord=r)}),ne(),Z(9,"button",55),Ae("click",function(){return Fe(e),Re(ge().addTagWord())}),$e(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),ne(),Te(11,cZ,2,1,"ng-container",13),Te(12,uZ,4,0,"ng-container",13),ne(),Z(13,"datalist",56),Te(14,dZ,2,2,"option",57),ne()()}if(2&t){const e=ge();ie("@fadeAndUpInOut",void 0),V(3),rn("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),V(1),ie("ngClass",wt(12,qI,e.selectedImagesIsHidden)),V(1),dt(e.selectedImagesIsHidden?"visibility":"visibility_off"),V(2),Zn("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),V(1),A_("list","",e.panelId,"_suggest"),ie("ngModel",e.addingTagWord),V(1),ie("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),V(2),ie("ngIf",e.selectedImagesOwnWords().length>0),V(1),ie("ngIf",0==e.selectedImagesOwnWords().length),V(1),ur("id","",e.panelId,"_suggest"),V(1),ie("ngForOf",e.suggestWords())}}const hZ=function(t){return{selecter:t}};let hs=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}get images(){const e=Hr.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?Hr.sortImagesByWords(e,t.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?t.sortOrder.unshift(null):t.sortOrder=t.sortOrder.filter(i=>null!=i),t.sortOrder=Array.from(new Set(t.sortOrder)),this._searchNoTagImage=e,Ve.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return Hr.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return Hr.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=yo.generateUuid()}ngAfterViewInit(){Ve.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Ve.unregister(this)}allImages(){return Hr.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Hr.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=Vn.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&sa.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return Hr.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),t.sortOrder=t.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),t.sortOrder.unshift(e)),t.sortOrder=Array.from(new Set(t.sortOrder)),Ve.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=Vn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=Vn.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(gr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Bi.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(gr,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:Bi.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=Vn.get(i.identifier)||Vn.create(i.identifier);r.hide=e,Ve.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(gr,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${tt.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:Bi.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(Vn.get(r.identifier)||Vn.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),t.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),t.sortOrder=Array.from(new Set(t.sortOrder)),Ve.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(gr,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${tt.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:Bi.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let o=Vn.get(r.identifier);o&&o.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),Ve.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}chanageImageView(e){Xu.imageUrl=e.state===Pi.COMPLETE?URL.createObjectURL(e.blob):e.url}}return t.sortOrder=[],t.\u0275fac=function(e){return new(e||t)(Ge(Ki),Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["file-storage"]],decls:41,vars:19,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],[1,"zoom-in",2,"z-index","10","position","absolute","right","0px","top","1px"],[1,"zoom-button",3,"click"],[1,"material-icons"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModel","ngModelChange"],[2,"font-size","x-small",3,"disabled","click"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(e,i){1&e&&(Z(0,"label")(1,"div",0)(2,"div")(3,"i",1),$e(4,"add_photo_alternate"),ne()(),Z(5,"div"),$e(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),ne(),Z(7,"div",2),$e(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),ne(),Z(9,"input",3),Ae("change",function(o){return i.handleFileSelect(o)}),ne(),Z(10,"div",2),vt(11,"br"),$e(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),ne()()(),Z(13,"div",4)(14,"div",5)(15,"label",6)(16,"input",7),Ae("click",function(o){return i.onShowHiddenImages(o)}),ne(),Z(17,"i",8),$e(18),ne()()(),Z(19,"span",9)(20,"label")(21,"input",10),Ae("click",function(){return i.onSearchAllImage()}),ne(),Z(22,"div",11)(23,"b"),$e(24,"ALL"),ne(),vt(25,"badge",12),ne()(),Te(26,KY,6,3,"label",13),Te(27,ZY,5,4,"label",14),ne(),Z(28,"span",15)(29,"select",16),Ae("ngModelChange",function(o){return i.serchCondIsOr=o}),Z(30,"option",17),$e(31,"\u3044\u305a\u308c\u304b (OR)"),ne(),Z(32,"option",18),$e(33,"\u3059\u3079\u3066 (AND)"),ne()(),Z(34,"label",19)(35,"input",20),Ae("ngModelChange",function(o){return i.isSort=o})("change",function(){return i.isSort=!!i.isSort}),ne(),Z(36,"b",21),$e(37,"\u30bd\u30fc\u30c8"),ne()()()(),Z(38,"div",22),Te(39,aZ,14,10,"div",23),ne(),Te(40,fZ,15,14,"div",24)),2&e&&(V(16),Mt("checked",i.isShowHideImages?"checked":""),V(1),ie("ngClass",wt(15,qI,i.isShowHideImages)),V(1),dt(i.isShowHideImages?"visibility":"visibility_off"),V(3),Mt("checked",i.searchAllImage?"checked":""),V(4),ie("count",i.images.length)("@.disabled",!0),V(1),ie("ngIf",i.countAllImagesHasWord(null)>0),V(1),ie("ngForOf",i.allImagesOwnWords),V(2),ie("ngModel",i.serchCondIsOr),V(6),Mt("checked",i.isSort?"checked":""),ie("ngModel",i.isSort),V(3),ie("ngClass",wt(17,hZ,i.isSelected)),V(1),ie("ngForOf",i.images)("ngForTrackBy",i.identify),V(1),ie("ngIf",i.isSelected))},dependencies:[oi,$i,Rn,so,ao,Ii,Fo,vo,Mi,Ci,pf,_i],styles:['[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.zoom-button[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:100px;padding:1px;pointer-events:auto}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{display:inline-block;font-size:16px;vertical-align:bottom}'],data:{animation:[Hn("scaleInOut",[en("void => *",[Qt("200ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt("180ms ease",ht({transform:"scale3d(0, 0, 0)"}))])]),Hn("fadeAndUpInOut",[en("void => *",[Qt("100ms ease-in-out",Cn([ht({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),ht({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),en("* => void",[Qt("100ms ease-in-out",ht({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),Qt("100ms ease-in-out",ht({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0}),t})();function pZ(t,n){1&t&&vt(0,"badge",8),2&t&&ie("count",ge(2).countImagesHasWord(null))("@.disabled",!0)}function gZ(t,n){if(1&t){const e=gt();Z(0,"label")(1,"input",21),Ae("ngModelChange",function(r){return Fe(e),Re(ge().searchNoTagImage=r)})("change",function(){Fe(e);const r=ge();return Re(r.searchNoTagImage=!!r.searchNoTagImage)}),ne(),Z(2,"div",22)(3,"s"),$e(4,"No Tag"),ne(),Te(5,pZ,1,2,"badge",23),ne()()}if(2&t){const e=ge();V(1),Mt("checked",e.searchNoTagImage?"checked":""),ie("ngModel",e.searchNoTagImage),V(4),ie("ngIf",e.countImagesHasWord(null)>0)}}function mZ(t,n){if(1&t&&vt(0,"badge",8),2&t){const e=ge().$implicit;ie("count",ge().countImagesHasWord(e))("@.disabled",!0)}}function _Z(t,n){if(1&t){const e=gt();Z(0,"label")(1,"input",24),Ae("change",function(){const o=Fe(e).$implicit;return Re(ge().onSelectedWord(o))}),ne(),Z(2,"div"),$e(3),Te(4,mZ,1,2,"badge",23),ne()()}if(2&t){const e=n.$implicit,i=ge();V(1),Mt("value",e),ie("checked",i.searchWords.includes(e)),V(2),dt(e),V(1),ie("ngIf",i.countImagesHasWord(e)>0)}}function $Z(t,n){if(1&t){const e=gt();Z(0,"span",25)(1,"button",26),Ae("click",function(){Fe(e);const r=ge();return Re(r.onSelectedFile(r.empty))}),$e(2,"\u753b\u50cf\u306a\u3057"),vt(3,"br"),$e(4,"/\u8a2d\u5b9a\u89e3\u9664"),ne()()}}function vZ(t,n){1&t&&An(0)}function bZ(t,n){if(1&t&&(Z(0,"label",42),$e(1),ne()),2&t){const e=ge().$implicit;V(1),dt(e)}}function yZ(t,n){1&t&&(Z(0,"span",43),$e(1,"\u2026"),ne())}function CZ(t,n){if(1&t&&(it(0),Te(1,bZ,2,1,"label",40),Te(2,yZ,2,0,"span",41),rt()),2&t){const e=n.index;V(1),ie("ngIf",e<6),V(1),ie("ngIf",6==e)}}function xZ(t,n){if(1&t&&(Z(0,"div",39),Te(1,CZ,3,2,"ng-container",10),ne()),2&t){const e=ge().$implicit,i=ge();V(1),ie("ngForOf",i.getTagWords(e))}}function wZ(t,n){1&t&&(Z(0,"div",39)(1,"s",44),$e(2,"No Tag"),ne()())}function EZ(t,n){1&t&&(Z(0,"div",45)(1,"i",46),$e(2,"visibility"),ne()())}function TZ(t,n){1&t&&(Z(0,"div",47)(1,"b",48),$e(2,"\u8a2d\u5b9a\u4e2d"),ne()())}function SZ(t,n){if(1&t){const e=gt();Z(0,"img",49),Ae("click",function(){Fe(e);const r=ge().$implicit,o=ge();return Re(!o.getCurrent(r)&&o.onSelectedFile(r))}),zt(1,"safe"),ne()}if(2&t){const e=ge().$implicit;ie("src",jt(1,2,e.url,"resourceUrl"),vn)("alt",e.name)}}function IZ(t,n){1&t&&vt(0,"img",50),2&t&&Mt("alt",ge().$implicit.name)}const MZ=function(t){return{"current-images":t}};function kZ(t,n){if(1&t){const e=gt();Z(0,"div",27)(1,"div",28),Te(2,vZ,1,0,"ng-container",29),Te(3,xZ,2,1,"ng-template",null,30,Qn),Te(5,wZ,3,0,"ng-template",null,31,Qn),Z(7,"div",32)(8,"button",33),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().chanageImageView(o))}),Z(9,"i",34),$e(10,"zoom_in"),ne()()()(),Te(11,EZ,3,0,"div",35),Te(12,TZ,3,0,"div",36),Te(13,SZ,2,5,"img",37),Te(14,IZ,1,1,"img",38),ne()}if(2&t){const e=n.$implicit,i=dn(4),r=dn(6),o=ge();ie("@scaleInOut",void 0)("ngClass",wt(9,MZ,o.getCurrent(e))),V(2),ie("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),V(9),ie("ngIf",o.getHidden(e)),V(1),ie("ngIf",o.getCurrent(e)),V(1),ie("ngIf",0<e.url.length),V(1),ie("ngIf",e.url.length<=0)}}const DZ=function(t){return{"red-eye":t}};let da=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}get images(){const e=Hr.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?Hr.sortImagesByWords(e,hs.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return sn.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?hs.sortOrder.unshift(null):hs.sortOrder=hs.sortOrder.filter(i=>null!=i),hs.sortOrder=Array.from(new Set(hs.sortOrder)),this._searchNoTagImage=e,Ve.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return Hr.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){Ve.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Ve.unregister(this)}allImages(){return Hr.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Hr.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=Vn.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=Vn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=Vn.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(gr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:Bi.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),hs.sortOrder=hs.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),hs.sortOrder.unshift(e)),hs.sortOrder=Array.from(new Set(hs.sortOrder)),Ve.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}chanageImageView(e){Xu.imageUrl=e.state===Pi.COMPLETE?URL.createObjectURL(e.blob):e.url}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ki),Ge(Wn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],[1,"zoom-in",2,"z-index","10","position","absolute","right","0px","top","1px"],[1,"zoom-button",3,"click"],[1,"material-icons"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(Z(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),Ae("click",function(o){return i.onShowHiddenImages(o)}),ne(),Z(4,"i",4),$e(5),ne()()(),Z(6,"span",5)(7,"label")(8,"input",6),Ae("click",function(){return i.onSearchAllImage()}),ne(),Z(9,"div",7)(10,"b"),$e(11,"ALL"),ne(),vt(12,"badge",8),ne()(),Te(13,gZ,6,3,"label",9),Te(14,_Z,5,4,"label",10),ne(),Z(15,"span",11)(16,"select",12),Ae("ngModelChange",function(o){return i.serchCondIsOr=o}),Z(17,"option",13),$e(18,"\u3044\u305a\u308c\u304b (OR)"),ne(),Z(19,"option",14),$e(20,"\u3059\u3079\u3066 (AND)"),ne()(),Z(21,"label",15)(22,"input",16),Ae("ngModelChange",function(o){return i.isSort=o})("change",function(){return i.isSort=!!i.isSort}),ne(),Z(23,"b",17),$e(24,"\u30bd\u30fc\u30c8"),ne()()()(),Z(25,"div",18),Te(26,$Z,5,0,"span",19),Te(27,kZ,15,11,"div",20),ne()),2&e&&(V(3),Mt("checked",i.isShowHideImages?"checked":""),V(1),ie("ngClass",wt(14,DZ,i.isShowHideImages)),V(1),dt(i.isShowHideImages?"visibility":"visibility_off"),V(3),Mt("checked",i.searchAllImage?"checked":""),V(4),ie("count",i.images.length)("@.disabled",!0),V(1),ie("ngIf",i.countAllImagesHasWord(null)>0),V(1),ie("ngForOf",i.allImagesOwnWords),V(2),ie("ngModel",i.serchCondIsOr),V(6),Mt("checked",i.isSort?"checked":""),ie("ngModel",i.isSort),V(4),ie("ngIf",i.isAllowedEmpty),V(1),ie("ngForOf",i.images)("ngForTrackBy",i.identify))},dependencies:[oi,$i,Rn,so,ao,Fo,vo,Mi,Ci,pf,_i],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.zoom-button[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:100px;padding:1px;pointer-events:auto}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{display:inline-block;font-size:16px;vertical-align:bottom}"],data:{animation:[Hn("scaleInOut",[en("void => *",[Qt("200ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt("180ms ease",ht({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function AZ(t,n){1&t&&An(0)}function PZ(t,n){if(1&t){const e=gt();Z(0,"div",3),Te(1,AZ,1,0,"ng-container",5),Z(2,"select",6),Ae("change",function(r){return Fe(e),Re(ge(3).setElementType(r.target.value))}),Z(3,"option",7),$e(4,"\u901a\u5e38"),ne(),Z(5,"option",8),$e(6,"\u6570\u5024"),ne(),Z(7,"option",9),$e(8,"\u30ea\u30bd\u30fc\u30b9"),ne(),Z(9,"option",10),$e(10,"\u80fd\u529b\u5024"),ne(),Z(11,"option",11),$e(12,"\u30c1\u30a7\u30c3\u30af"),ne(),Z(13,"option",12),$e(14,"\u30ce\u30fc\u30c8"),ne(),Z(15,"option",13),$e(16,"\u53c2\u7167URL"),ne()()()}if(2&t){const e=ge(3),i=dn(2);V(1),ie("ngTemplateOutlet",i),V(1),ie("ngModel",e.gameDataElement.type)}}function NZ(t,n){1&t&&(it(0),vt(1,"br"),Z(2,"span",15),$e(3,"0=\u753b\u50cf\u4f9d\u5b58"),ne(),rt())}function OZ(t,n){if(1&t&&(it(0),Z(1,"span",14),$e(2),ne(),Te(3,NZ,4,0,"ng-container",0),rt()),2&t){const e=ge(3);V(2),dt(e.name),V(1),ie("ngIf","character"===e.descriptionType&&"height"===e.name)}}function FZ(t,n){if(1&t){const e=gt();it(0),Z(1,"div",16),$e(2),ne(),Z(3,"input",17),Ae("ngModelChange",function(r){return Fe(e),Re(ge(3).name=r)}),ne(),rt()}if(2&t){const e=ge(3);V(2),dt(e.name),V(1),ie("ngModel",e.name)}}function RZ(t,n){if(1&t){const e=gt();it(0),Z(1,"input",21),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).currentValue=r)}),zt(2,"safe"),ne(),vt(3,"br"),Z(4,"input",22),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).currentValue=r)}),ne(),Z(5,"b",23),$e(6,"%"),ne(),rt()}if(2&t){const e=ge(4);V(1),Mr(jt(2,5,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ur("title","",e.currentValue,"%"),ie("ngModel",e.currentValue),V(3),ie("ngModel",e.currentValue)}}function LZ(t,n){if(1&t){const e=gt();it(0),Z(1,"label",24)(2,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).value=r)}),ne(),Z(3,"div",26),$e(4),ne()(),Z(5,"label",27)(6,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).currentValue=r)}),ne(),Z(7,"div",26),$e(8),ne()(),rt()}if(2&t){const e=ge(5);V(1),pt("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),V(1),ie("ngModel",e.value),V(2),dt(e.value),V(1),pt("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),V(1),ie("ngModel",e.currentValue),V(2),Zn("(",e.currentValue,")")}}function BZ(t,n){if(1&t){const e=gt();it(0),Z(1,"label",24)(2,"input",25),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).value=r)}),ne(),$e(3),ne(),rt()}if(2&t){const e=ge(5);V(1),pt("color",e.value)("text-shadow",e.colorSampleTextShadowCss),V(1),ie("ngModel",e.value),V(1),Zn(" ",e.value,"")}}function zZ(t,n){if(1&t&&(it(0),Te(1,LZ,9,16,"ng-container",0),Te(2,BZ,4,6,"ng-container",0),rt()),2&t){const e=ge(4);V(1),ie("ngIf","colors"===e.gameDataElement.type),V(1),ie("ngIf","color"===e.gameDataElement.type)}}function jZ(t,n){if(1&t){const e=gt();Z(0,"dev",31)(1,"label")(2,"input",32),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).currentValue=r)})("change",function(){Fe(e);const r=ge(5);return Re(r.currentValue=r.currentValue?r.name:"")}),ne(),$e(3,"\xd7 size"),ne()()}if(2&t){const e=ge(5);V(2),Mt("checked",e.currentValue?"checked":""),ie("ngModel",e.currentValue)}}function UZ(t,n){if(1&t){const e=gt();it(0),Z(1,"input",28),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),zt(2,"safe"),ne(),vt(3,"br"),Z(4,"input",29),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),ne(),Te(5,jZ,4,2,"dev",30),rt()}if(2&t){const e=ge(4);V(1),Mr(jt(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Mt("title",e.value),Mt("min","altitude"===e.name?-12:"fontsize"===e.name||"length"===e.name?1:0),Mt("max","fontsize"===e.name?128:12),Mt("step","fontsize"===e.name?1:.5),ie("ngModel",e.value),V(3),Mt("min","altitude"===e.name?-24:"fontsize"===e.name||"length"===e.name?1:0),Mt("step","fontsize"===e.name?1:.1),ie("ngModel",e.value),V(1),ie("ngIf","character"===e.descriptionType&&"height"===e.name)}}function HZ(t,n){if(1&t&&(it(0)(1,18),Te(2,RZ,7,8,"ng-container",19),Te(3,zZ,3,2,"ng-container",19),Te(4,UZ,6,14,"ng-container",20),rt()()),2&t){const e=ge(3);V(1),ie("ngSwitch",e.gameDataElement.name),V(1),ie("ngSwitchCase","opacity"),V(1),ie("ngSwitchCase","color")}}function VZ(t,n){if(1&t){const e=gt();it(0),Z(1,"div",33),$e(2),ne(),Z(3,"input",34),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),ne(),rt()}if(2&t){const e=ge(4);V(2),dt(e.value),V(1),Mt("type",e.isNum(e.value)?"number":"text"),ie("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function GZ(t,n){if(1&t){const e=gt();it(0),Z(1,"input",35),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).currentValue=r)}),zt(2,"safe"),ne(),vt(3,"br"),Z(4,"input",36),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).currentValue=r)}),ne(),$e(5," / "),Z(6,"input",37),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),ne(),rt()}if(2&t){const e=ge(4);V(1),Mr(jt(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),Mt("title",e.currentValue),Mt("max",e.isNum(e.value)?e.value:1e3),ie("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),V(3),ie("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),V(2),ie("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function qZ(t,n){if(1&t){const e=gt();it(0),Z(1,"select",39),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).currentValue=r)}),Z(2,"option",7),$e(3,"\u306a\u3057"),ne(),Z(4,"option",40),$e(5,"\xf72"),ne(),Z(6,"option",41),$e(7,"\xf73 SRS,LHZ"),ne(),Z(8,"option",42),$e(9,"\xf74"),ne(),Z(10,"option",43),$e(11,"\xf75"),ne(),Z(12,"option",44),$e(13,"\xf76 SW"),ne(),Z(14,"option",45),$e(15,"\xf710"),ne(),Z(16,"option",46),$e(17,"D&D 3e\uff5e"),ne()(),rt()}if(2&t){const e=ge(5);V(1),ie("ngModel",e.currentValue)}}function WZ(t,n){if(1&t&&(it(0),Z(1,"span",47),$e(2),ne(),rt()),2&t){const e=ge(5);V(2),dt("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function KZ(t,n){if(1&t){const e=gt();it(0),Z(1,"input",38),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),ne(),Te(2,qZ,18,1,"ng-container",0),Te(3,WZ,3,1,"ng-container",0),rt()}if(2&t){const e=ge(4);V(1),Mt("type",e.isNum(e.value)?"number":"text"),ie("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),V(1),ie("ngIf",e.isEdit),V(1),ie("ngIf",!e.isEdit&&e.currentValue)}}function YZ(t,n){if(1&t){const e=gt();Z(0,"input",51),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).currentValue=r)}),ne()}2&t&&ie("ngModel",ge(5).currentValue)}function ZZ(t,n){if(1&t&&(Z(0,"span",52),$e(1),ne()),2&t){const e=ge(5);V(1),dt(e.checkValue)}}function XZ(t,n){if(1&t){const e=gt();it(0),Z(1,"input",48),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)})("change",function(){Fe(e);const r=ge(4);return Re(r.value=r.value?r.name:"")}),ne(),Te(2,YZ,1,1,"input",49),Te(3,ZZ,2,1,"span",50),rt()}if(2&t){const e=ge(4);V(1),Mt("checked",e.value?"checked":""),ie("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),V(1),ie("ngIf",e.isEdit),V(1),ie("ngIf",!e.isEdit)}}function QZ(t,n){if(1&t){const e=gt();it(0),Z(1,"textarea",53),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),ne(),rt()}if(2&t){const e=ge(4);V(1),ie("ngModel",e.value)}}function JZ(t,n){if(1&t){const e=gt();it(0),Z(1,"div",33),$e(2),ne(),Z(3,"span",54)(4,"input",55),Ae("ngModelChange",function(r){return Fe(e),Re(ge(4).value=r)}),ne(),Z(5,"button",56),Ae("click",function(){Fe(e);const r=ge(4);return Re(!!r.stringUtil.validUrl(r.value)&&r.openUrl(r.value))}),Z(6,"i",57),$e(7),ne()()(),rt()}if(2&t){const e=ge(4);V(2),dt(e.value),V(2),ie("ngModel",e.value),V(1),rn("disabled",e.stringUtil.validUrl(e.value)?null:""),V(2),dt(e.stringUtil.validUrl(e.value)?e.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function eX(t,n){if(1&t){const e=gt();Z(0,"input",60),Ae("ngModelChange",function(r){return Fe(e),Re(ge(5).value=r)}),ne()}2&t&&ie("ngModel",ge(5).value)}function tX(t,n){1&t&&(Z(0,"span",61),$e(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),ne())}function nX(t,n){if(1&t&&(it(0),Z(1,"div",33),$e(2),ne(),Te(3,eX,1,1,"input",58),Te(4,tX,2,0,"span",59),rt()),2&t){const e=ge(4);V(2),dt(e.value),V(1),ie("ngIf",!(e.isHideText&&e.isTabletopObjectName)),V(1),ie("ngIf",e.isHideText&&e.isTabletopObjectName)}}function iX(t,n){if(1&t&&(it(0)(1,18),Te(2,VZ,4,6,"ng-container",19),Te(3,GZ,7,19,"ng-container",19),Te(4,KZ,4,7,"ng-container",19),Te(5,XZ,4,7,"ng-container",19),Te(6,QZ,2,1,"ng-container",19),Te(7,JZ,8,4,"ng-container",19),Te(8,nX,5,3,"ng-container",20),rt()()),2&t){const e=ge(3);V(1),ie("ngSwitch",e.gameDataElement.type),V(1),ie("ngSwitchCase","simpleNumber"),V(1),ie("ngSwitchCase","numberResource"),V(1),ie("ngSwitchCase","abilityScore"),V(1),ie("ngSwitchCase","checkProperty"),V(1),ie("ngSwitchCase","note"),V(1),ie("ngSwitchCase","url")}}function rX(t,n){if(1&t&&(it(0),Te(1,PZ,17,2,"div",2),Z(2,"div",3),Te(3,OZ,4,2,"ng-container",0),Te(4,FZ,4,2,"ng-container",0),ne(),Z(5,"div",4),Te(6,HZ,5,3,"ng-container",0),Te(7,iX,9,7,"ng-container",0),ne(),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isEdit),V(2),ie("ngIf",e.isTagLocked),V(1),ie("ngIf",!e.isTagLocked),V(2),ie("ngIf",e.isCommonValue),V(1),ie("ngIf",!e.isCommonValue)}}function oX(t,n){1&t&&An(0)}function sX(t,n){if(1&t&&(Z(0,"div",67),Te(1,oX,1,0,"ng-container",5),ne()),2&t){ge(3);const e=dn(2);V(1),ie("ngTemplateOutlet",e)}}function aX(t,n){if(1&t&&(it(0),Z(1,"div",68),$e(2),ne(),rt()),2&t){const e=ge(3);V(2),dt(e.name)}}function lX(t,n){if(1&t){const e=gt();it(0),Z(1,"input",69),Ae("ngModelChange",function(r){return Fe(e),Re(ge(3).name=r)}),ne(),rt()}if(2&t){const e=ge(3);V(1),ie("ngModel",e.name)}}function cX(t,n){if(1&t&&vt(0,"div",72),2&t){const e=n.$implicit,i=ge(4);ie("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function uX(t,n){if(1&t&&(Z(0,"div",70),Te(1,cX,1,7,"div",71),ne()),2&t){const e=ge(3);V(1),ie("ngForOf",e.gameDataElement.children)}}function dX(t,n){if(1&t&&(it(0),Te(1,sX,2,1,"div",62),vt(2,"div",63),Z(3,"div",64)(4,"div",65),Te(5,aX,3,1,"ng-container",0),Te(6,lX,2,1,"ng-container",0),ne(),Te(7,uX,2,1,"div",66),ne(),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isEdit),V(3),pt("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),V(1),ie("ngIf",e.isTagLocked&&"common"!=e.name),V(1),ie("ngIf",!e.isTagLocked),V(1),ie("ngIf",0<e.gameDataElement.children.length)}}function fX(t,n){if(1&t&&(it(0),Te(1,rX,8,5,"ng-container",0),Te(2,dX,8,6,"ng-container",0),rt()),2&t){const e=ge();V(1),ie("ngIf",e.gameDataElement.children.length<1),V(1),ie("ngIf",0<e.gameDataElement.children.length)}}function hX(t,n){if(1&t){const e=gt();Z(0,"button",73),Ae("click",function(){return Fe(e),Re(ge().addElement())}),Z(1,"i",74),$e(2,"add_circle"),ne()(),Z(3,"button",73),Ae("click",function(){return Fe(e),Re(ge().upElement())}),Z(4,"i",74),$e(5,"arrow_upward"),ne()(),vt(6,"br"),Z(7,"button",73),Ae("click",function(){return Fe(e),Re(ge().deleteElement())}),Z(8,"i",74),$e(9,"remove_circle_outline"),ne()(),Z(10,"button",73),Ae("click",function(){return Fe(e),Re(ge().downElement())}),Z(11,"i",74),$e(12,"arrow_downward"),ne()()}}let pX=(()=>{class t{constructor(e,i){this.changeDetector=e,this.modalService=i,this.tabletopObject=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=tt,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTabletopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get checkValue(){if(null==this.currentValue)return"";let e=this.currentValue.toString().split(/[|\uff5c]/,2);if(e.length<=1)return null==this.value||""==this.value?"":this.currentValue.toString();let i=null==this.value||""==this.value?e[1]:e[0];return this.tabletopObject instanceof an&&this.tabletopObject.chatPalette&&(i=this.tabletopObject.chatPalette.evaluate(i,this.tabletopObject.rootDataElement)),i}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"length"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name||"color"===this.gameDataElement.name)}get isNotApplicable(){return this.isCommonValue&&"range-not-width"===this.descriptionType&&"width"===this.gameDataElement.name}get colorSampleTextShadowCss(){const e=tt.textShadowColor(this.value.toString());return`${e} -1px -1px 0px, \n      ${e} 0px -1px 0px, \n      ${e} 1px -1px 0px, \n      ${e} -1px 0px 0px, \n      ${e} 1px 0px 0px,\n      ${e} -1px 1px 0px,\n      ${e} 0px 1px 0px,\n      ${e} 1px 1px 0px`}get identifier(){return this.gameDataElement.identifier}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=!1;this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier?(this.setValues(this.gameDataElement),i=!0):this.tabletopObject&&this.tabletopObject.contains(this.gameDataElement)&&(i=!0),i&&this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Ve.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(kt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){tt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(co,{url:e,title:this.tabletopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ki),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tabletopObject:"tabletopObject",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModel","title","ngModelChange"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModel","ngModelChange"],[2,"display","inline-block","box-sizing","border-box","width","calc(100% - 1em)","text-align","center"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"min","step","ngModel","ngModelChange"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","ngModel","title","max","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",2,"width","30%","max-width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModel","ngModelChange"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(Te(0,fX,3,2,"ng-container",0),Te(1,hX,13,0,"ng-template",null,1,Qn)),2&e&&ie("ngIf",i.gameDataElement&&!i.isNotApplicable&&!(i.isHideText&&("text"==i.name||"fontsize"==i.name||"color"==i.name)))},dependencies:[$i,Rn,tl,Jl,Qd,Jd,so,ao,Ii,Ro,Lo,Fo,vo,Mi,Ys,Ks,Ci,t,fs,_i],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#eee -1px -1px 0px,#eee 0px -1px 0px,#eee 1px -1px 0px,#eee -1px 0px 0px,#eee 1px 0px 0px,#eee -1px 1px 0px,#eee 0px 1px 0px,#eee 1px 1px 0px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0}),t})();const gX=["mainImage"];function mX(t,n){1&t&&An(0)}function _X(t,n){if(1&t){const e=gt();it(0),Z(1,"button",4),Ae("click",function(){return Fe(e),Re(ge().openModal("front"))}),$e(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),Z(3,"button",0),Ae("click",function(){return Fe(e),Re(ge().openModal("back"))}),$e(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}if(2&t){const e=ge();V(1),ie("disabled",!e.isVisible)}}function $X(t,n){if(1&t){const e=gt();it(0),Z(1,"button",0),Ae("click",function(){return Fe(e),Re(ge().openModalChangeAllCardImages())}),$e(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}}function vX(t,n){if(1&t){const e=gt();it(0),Z(1,"button",0),Ae("click",function(){return Fe(e),Re(ge().openModal("floor"))}),$e(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),Z(3,"button",0),Ae("click",function(){return Fe(e),Re(ge().openModal("wall"))}),$e(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}}function bX(t,n){if(1&t){const e=gt();it(0),Z(1,"button",4),Ae("click",function(){Fe(e);const r=ge();return Re(r.openModal(r.tabletopObject.face))}),$e(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),ne(),rt()}if(2&t){const e=ge();V(1),ie("disabled",!e.isVisible)}}function yX(t,n){if(1&t){const e=gt();it(0),Z(1,"button",0),Ae("click",function(){Fe(e);const r=ge();return Re(r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length)))}),$e(2),ne(),Z(3,"button",4),Ae("click",function(){return Fe(e),Re(ge().openModal("faceIcon"))}),$e(4),ne(),rt()}if(2&t){const e=ge();V(2),Zn("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),V(1),ie("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),V(1),Zn("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function CX(t,n){if(1&t){const e=gt();it(0),Z(1,"button",0),Ae("click",function(){Fe(e);const r=ge(2);return Re(r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0))}),$e(2,"\u753b\u50cf\u5909\u66f4"),ne(),rt()}}function xX(t,n){if(1&t&&(it(0),Te(1,CX,3,0,"ng-container",8),rt()),2&t){const e=ge();V(1),ie("ngIf","range"!==e.tabletopObject.aliasName)}}function wX(t,n){if(1&t&&(Z(0,"div",10),$e(1),ne()),2&t){const e=ge();V(1),Zn("",e.progresPercent,"%")}}function EX(t,n){if(1&t){const e=gt();Z(0,"select",12),Ae("change",function(r){return Fe(e),Re(ge(2).setLocation(r.target.value))}),Z(1,"option",13),$e(2,"\u30c6\u30fc\u30d6\u30eb"),ne(),Z(3,"option",14),$e(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne(),Z(5,"option",15),$e(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),ne(),Z(7,"option",16),$e(8,"\u5893\u5730"),ne()()}if(2&t){const e=ge(2);ie("ngModel",e.tabletopObject.location.name),V(5),Mt("value",e.networkService.peerId)}}function TX(t,n){if(1&t){const e=gt();it(0),Te(1,EX,9,2,"select",11),Z(2,"button",4),Ae("click",function(){Fe(e);const r=ge();return Re(r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0))}),$e(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),ne(),rt()}if(2&t){const e=ge();V(1),ie("ngIf",e.tabletopObject),V(1),ie("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function SX(t,n){if(1&t){const e=gt();Z(0,"button",35),Ae("click",function(){Fe(e);const r=ge(2),o=r.index,s=r.$implicit;return Re(ge(3).deleteIcon(o,s.identifier))}),Z(1,"b",36),$e(2,"close"),ne()()}}const IX=function(t){return{"current-icon":t}};function MX(t,n){if(1&t){const e=gt();Z(0,"div",32)(1,"img",33),Ae("click",function(){Fe(e);const r=ge().index;return Re(ge(3).selectIcon(r))}),zt(2,"safe"),ne(),Te(3,SX,3,0,"button",34),ne()}if(2&t){const e=ge(),i=e.index,r=e.$implicit,o=ge(3);ie("@bounceInOut",void 0)("ngClass",wt(8,IX,o.tabletopObject.currntIconIndex==i)),V(1),ie("src",jt(2,5,r.url,"resourceUrl"),vn)("alt",r.name),V(2),ie("ngIf",o.tabletopObject.currntIconIndex==i)}}function kX(t,n){if(1&t&&(Z(0,"div",5),Te(1,MX,4,10,"div",31),ne()),2&t){const e=n.$implicit,i=n.index;pt("top",-ge(3).showIconOffset(i),"px"),V(1),ie("ngIf",0<e.url.length)}}const DX=function(t){return{hide:t}};function AX(t,n){if(1&t){const e=gt();Z(0,"span",37)(1,"img",33),Ae("click",function(){const o=Fe(e).index;return Re(ge(3).selectImage(o))}),zt(2,"safe"),ne()()}if(2&t){const e=n.$implicit,i=n.index,r=ge(3);pt("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),ie("ngClass",wt(9,DX,r.tabletopObject.currntImageIndex==i)),V(1),ie("@bounceInOut",void 0)("src",jt(2,6,e.url,"resourceUrl"),vn)("alt",e.name)}}function PX(t,n){if(1&t){const e=gt();Z(0,"button",38),Ae("click",function(){return Fe(e),Re(ge(3).openModalAddImage())}),$e(1),ne()}if(2&t){const e=ge(3);pt("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),V(1),dt(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}const NX=function(t){return{transform:t}};function OX(t,n){if(1&t&&(Z(0,"div",39),vt(1,"div",40),zt(2,"safe"),ne()),2&t){const e=ge(3);pt("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),ie("ngStyle",wt(15,NX,"scale("+e.imageAreaRreact.scale+")")),V(1),pt("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),ie("innerHTML",jt(2,12,e.cardText,"html"),cr)}}const FX=function(t){return{inverse:t}},RX=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},LX=function(t,n,e){return{"black-paint":t,hollow:n,small:e}};function BX(t,n){if(1&t){const e=gt();Z(0,"div",20)(1,"div",21),Te(2,kX,2,3,"div",22),ne(),Z(3,"div",23),Te(4,AX,3,11,"span",24),Te(5,PX,2,3,"button",25),ne(),Te(6,OX,3,17,"div",26),Z(7,"span",27)(8,"span",28)(9,"img",29,30),Ae("dblclick",function(){return Fe(e),Re(ge(2).openMainImageModal())})("load",function(){return Fe(e),Re(ge(2).onMainImageLoad())}),zt(11,"safe"),ne()()()()}if(2&t){const e=ge(2);V(2),ie("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),V(2),ie("ngForOf",e.tabletopObject.imageFiles),V(1),ie("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),V(1),ie("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),V(1),ie("ngClass",wt(14,FX,e.tabletopObject.isInverse)),V(1),ie("ngClass",Ms(16,RX,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),V(1),ie("src",jt(11,11,e.imageFile.url,"resourceUrl"),vn)("alt",e.imageFile.name)("ngClass",_o(25,LX,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function zX(t,n){if(1&t){const e=gt();Z(0,"div",45)(1,"button",46),Ae("click",function(){return Fe(e),Re(ge(3).showChatPalette())}),$e(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),ne(),Z(3,"button",46),Ae("click",function(){return Fe(e),Re(ge(3).showStandSetting())}),$e(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),ne()()}}function jX(t,n){if(1&t&&(it(0),Z(1,"div",41)(2,"div",42),vt(3,"div",43),ne(),Te(4,zX,5,0,"div",44),ne(),rt()),2&t){const e=ge(2);V(3),ie("gameDataElement",e.tabletopObject.commonDataElement)("tabletopObject",e.tabletopObject)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.descriptionType),V(1),ie("ngIf","character"===e.tabletopObject.aliasName)}}function UX(t,n){if(1&t&&(Z(0,"div",41)(1,"div",42),vt(2,"div",48),ne()()),2&t){const e=n.$implicit,i=ge(3);V(2),ie("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function HX(t,n){if(1&t&&(it(0),Te(1,UX,3,4,"div",47),rt()),2&t){const e=ge(2);V(1),ie("ngForOf",e.tabletopObject.detailDataElement.children)}}function VX(t,n){if(1&t){const e=gt();it(0),Z(1,"div",41)(2,"button",49),Ae("click",function(){return Fe(e),Re(ge(2).addDataElement())}),$e(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),ne()(),rt()}}function GX(t,n){if(1&t){const e=gt();Z(0,"div",17)(1,"img",18),Ae("click",function(){return Fe(e),Re(ge().openModal("shadowImageIdentifier",!0))}),zt(2,"safe"),ne(),Te(3,BX,12,29,"div",19),Te(4,jX,5,7,"ng-container",8),Te(5,HX,2,1,"ng-container",8),Te(6,VX,4,0,"ng-container",8),ne()}if(2&t){const e=ge();V(1),ie("src",jt(2,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),vn)("alt",e.tabletopObject.shadowImageFile.name),V(2),ie("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),V(1),ie("ngIf",e.tabletopObject.commonDataElement),V(1),ie("ngIf",e.tabletopObject.detailDataElement),V(1),ie("ngIf",e.isEdit)}}const qX=function(t){return{"is-hidden":t}};let ps=(()=>{class t{constructor(e,i,r,o){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=o,this.tabletopObject=null,this.isEdit=!1,this.networkService=Lt,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){Ve.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof ei&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tabletopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tabletopObjectName}`;break;case"range":this.panelService.title=`\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a - ${this.tabletopObjectName}`}})}ngAfterViewInit(){}ngOnDestroy(){Ve.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=kt.create("\u898b\u51fa\u3057","",{}),i=kt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":St.play(at.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,St.play(at.cardPut);break;case"text-note":e.toTopmost(),St.play(at.cardPut);break;case"dice-symbol":St.play(at.dicePut);default:St.play(at.piecePut)}}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof ei&&this.isVisible?e.frontImage:e.imageFile:sn.Empty}get descriptionType(){return this.tabletopObject instanceof yi&&!this.tabletopObject.isApplyWidth?"range-not-width":this.tabletopObject.aliasName}saveToXML(){var e=this;return(0,hn.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tabletopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),St.play("graveyard"==e?at.sweep:at.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;o&&"null"!=o.value&&o.currentValue&&(r=[o.currentValue+""])}else{const o=this.tabletopObject.imageDataElement.getElementsByName(e);o&&o.length>0&&(r=o.map(s=>s.value+""))}this.modalService.open(da,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&o)if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;if(s){"null"!=s.value&&(s.currentValue=o);const a=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const h of a)this.tabletopObject.imageDataElement.removeChild(h)}}else if("faceIcon"===e){let s=this.tabletopObject.imageDataElement.getElementsByName(e);if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let a=this.MAX_IMAGE_ICON_COUNT;a<s.length;a++)this.deleteIcon(a);s[this.MAX_IMAGE_ICON_COUNT-1].value=o}else this.tabletopObject.imageDataElement.appendChild(kt.create(e,o,{type:"image"},e+yo.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let s=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!s)return;s.value=o}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(da,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let s=this.MAX_IMAGE_ICON_COUNT;s<o.length;s++)this.deleteImage(s);o[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(kt.create("imageIdentifier",r,{type:"image"},name+yo.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(o=>o.value+"")),this.modalService.open(da,{isAllowedEmpty:e,currentImageIdentifires:i}).then(o=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!o||("null"==o?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=o,this.tabletopObject.imageElement.currentValue=o):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=o))})}openModalChangeAllCardImages(){this.modalService.open(da,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof ai)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,St.play(at.surprise),Ve.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){this.tabletopObject instanceof ai||(this.tabletopObject instanceof ei?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof Ir?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof an?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<this.tabletopObject.imageFile?.url.length):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof an))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Hu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof an))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Bf,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){!this.mainImageElement||(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let h=null;return this.tabletopObject instanceof ai?h=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(h=this.tabletopObject),h&&(o.scale=o.width/(h.size*this.gridSize),o.width=h.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(e=this.tabletopObject),e?tt.rubyToHtml(tt.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=tt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isVisible(){return!!this.tabletopObject&&(!(!Je.myCursor||!Je.myCursor.isGMMode)||(this.tabletopObject instanceof ei?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof Ir)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof an?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof Ir&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof ei?!this.tabletopObject.isFront:this.tabletopObject instanceof Ir&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}}return t.\u0275fac=function(e){return new(e||t)(Ge(qr),Ge(Wn),Ge(Yn),Ge(vi))},t.\u0275cmp=mn({type:t,selectors:[["game-character-sheet"]],viewQuery:function(e,i){if(1&e&&Tn(gX,5),2&e){let r;En(r=Sn())&&(i.mainImageElement=r.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick","load"],["mainImage",""],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(Z(0,"button",0),Ae("click",function(){return i.toggleEditMode()}),$e(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),ne(),it(2,1),Te(3,mX,1,0,"ng-container",2),Te(4,_X,5,1,"ng-container",2),Te(5,$X,3,0,"ng-container",2),Te(6,vX,5,0,"ng-container",2),Te(7,bX,3,1,"ng-container",2),Te(8,yX,5,3,"ng-container",2),Te(9,xX,2,1,"ng-container",3),rt(),Z(10,"button",0),Ae("click",function(){return i.clone()}),$e(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),ne(),Z(12,"button",4),Ae("click",function(){return i.saveToXML()}),Z(13,"div",5)(14,"div",6),$e(15,"\u4fdd\u5b58"),ne(),Te(16,wX,2,1,"div",7),ne()(),Te(17,TX,4,2,"ng-container",8),Te(18,GX,7,9,"div",9)),2&e&&(V(2),ie("ngSwitch",i.tabletopObject.aliasName),V(1),ie("ngSwitchCase","numberResource"),V(1),ie("ngSwitchCase","card"),V(1),ie("ngSwitchCase","card-stack"),V(1),ie("ngSwitchCase","terrain"),V(1),ie("ngSwitchCase","dice-symbol"),V(1),ie("ngSwitchCase","character"),V(4),ie("disabled",i.isSaveing),V(2),ie("ngClass",wt(12,qX,i.isSaveing)),V(2),ie("ngIf",i.isSaveing),V(1),ie("ngIf","character"===i.tabletopObject.aliasName),V(1),ie("ngIf",i.tabletopObject))},dependencies:[oi,$i,Rn,hr,Jl,Qd,Jd,so,ao,vo,Mi,Ci,pX,_i],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Hn("switchImage",[en(":increment, :decrement",[Qt("200ms ease",Cn([ht({transform:"scale3d(0, 0, 0)"}),ht({transform:"scale3d(0, 1.2, 1.2)"}),ht({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Hn("showcase",[en(":increment, :decrement",[Qt("200ms 200ms ease-in",Cn([ht({transform:"scale3d(0, 1.0, 1.0)"}),ht({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Hn("showcaseItem",[en(":enter",[Qt("200ms ease",Cn([ht({transform:"scale3d(0, 0, 0)"}),ht({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),en(":leave",[Qt("200ms ease",Cn([ht({transform:"scale3d(1.0, 1.0, 1.0)"}),ht({transform:"scale3d(0, 0, 0)"})]))])]),Hn("bounceInOut",[en("void => *",[Qt("600ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale3d(0, 0, 0)"}))])])]}}),t})(),zg=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{Ur(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)($n(Fn))},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const WX=["textArea"];function KX(t,n){1&t&&(vt(0,"img",27),zt(1,"safe")),2&t&&ie("src",jt(1,1,ge(2).imageFile.url,"resourceUrl"),vn)}function YX(t,n){if(1&t&&(Z(0,"div",25),Te(1,KX,2,4,"img",26),ne()),2&t){const e=ge();V(1),ie("ngIf",0<e.imageFile.url.length)}}function ZX(t,n){if(1&t&&(Z(0,"div",25),vt(1,"img",27),zt(2,"safe"),ne()),2&t){const e=ge(2);V(1),ie("src",jt(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),vn)}}const XX=function(t,n){return{inverse:t,hollow:n}},QX=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},JX=function(t){return{"black-paint":t}};function eQ(t,n){if(1&t&&(Z(0,"div",30)(1,"span",31),vt(2,"img",32),zt(3,"safe"),ne()()),2&t){const e=ge(3);ie("ngClass",fn(7,XX,e.character.isInverse,e.character.isHollow)),V(1),ie("ngClass",Ms(10,QX,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),V(1),ie("src",jt(3,4,e.character.imageFile.url,"resourceUrl"),vn)("ngClass",wt(19,JX,e.character.isBlackPaint))}}function tQ(t,n){if(1&t&&Te(0,eQ,4,21,"div",29),2&t){const e=ge(2);ie("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function nQ(t,n){if(1&t&&(Te(0,ZX,3,4,"div",2),Te(1,tQ,1,1,"ng-template",null,28,Qn)),2&t){const e=dn(2),i=ge();ie("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function iQ(t,n){if(1&t){const e=gt();Z(0,"input",33),Ae("ngModelChange",function(r){return Fe(e),Re(ge().isUseFaceIcon=r)})("change",function(){Fe(e);const r=ge();return Re(r.isUseFaceIcon=!!r.isUseFaceIcon)}),ne()}if(2&t){const e=ge();Mt("checked",e.isUseFaceIcon?"checked":""),ie("ngModel",e.isUseFaceIcon)}}function rQ(t,n){1&t&&(Z(0,"b",34),$e(1,"\u9854IC"),ne())}function oQ(t,n){if(1&t&&(Z(0,"option",35),$e(1),ne()),2&t){const e=ge();pt("color",e.myColor),Mt("value",null==e.myPeer?null:e.myPeer.identifier),V(1),Zn("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function sQ(t,n){if(1&t&&(Z(0,"option",36),$e(1),ne()),2&t){const e=n.$implicit;pt("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),Mt("value",e.identifier),V(1),dt(e.name)}}function aQ(t,n){1&t&&(it(0),$e(1,"\uff08\u3042\u306a\u305f\uff09"),rt())}function lQ(t,n){if(1&t&&(Z(0,"option",35),$e(1),Te(2,aQ,2,0,"ng-container",24),ne()),2&t){const e=n.$implicit,i=ge();pt("color",e.color),Mt("value",e.identifier),V(1),Zn("",e.name," "),V(1),ie("ngIf",e===i.myPeer)}}function cQ(t,n){if(1&t&&(Z(0,"option",42),$e(1),ne()),2&t){const e=n.$implicit;Mt("value",e.script),V(1),dt(e.game)}}function uQ(t,n){if(1&t&&(Z(0,"optgroup",40),Te(1,cQ,2,2,"option",41),ne()),2&t){const e=n.$implicit;Mt("label",e.index),V(1),ie("ngForOf",e.infos)}}const Wf=function(){return{standalone:!0}},jg=function(t){return{"not-specified":t}};function dQ(t,n){if(1&t){const e=gt();Z(0,"select",37),Ae("change",function(r){return Fe(e),Re(ge().loadDiceBot(r.target.value))})("ngModelChange",function(r){return Fe(e),Re(ge().gameType=r)}),Z(1,"option",38),$e(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),ne(),Te(3,uQ,2,2,"optgroup",39),ne()}if(2&t){const e=ge();ie("ngModel",e.gameType)("ngModelOptions",wa(4,Wf))("ngClass",wt(5,jg,"DiceBot"==e.gameType||""==e.gameType)),V(3),ie("ngForOf",e.diceBotInfosIndexed)}}function fQ(t,n){if(1&t){const e=gt();Z(0,"select",43),Ae("change",function(r){return Fe(e),Re(ge().loadDiceBot(r.target.value))})("ngModelChange",function(r){return Fe(e),Re(ge().gameType=r)}),Z(1,"option",38),$e(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),ne()()}if(2&t){const e=ge();ie("ngModel",e.gameType)("ngModelOptions",wa(3,Wf))("ngClass",wt(4,jg,"DiceBot"==e.gameType||""==e.gameType))}}function hQ(t,n){if(1&t&&(Z(0,"option",42),$e(1),ne()),2&t){const e=n.$implicit;Mt("value",e),V(1),dt(e)}}const pQ=function(t){return{"disabled-stand":t}};function gQ(t,n){if(1&t){const e=gt();Z(0,"div",44)(1,"label",45)(2,"input",33),Ae("ngModelChange",function(r){return Fe(e),Re(ge().isUseStandImage=r)})("change",function(){Fe(e);const r=ge();return Re(r.isUseStandImage=!!r.isUseStandImage)}),ne(),Z(3,"b",34),$e(4,"Stand: "),ne()(),Z(5,"select",46),Ae("change",function(){return Fe(e),Re(ge().isUseStandImage=!0)})("ngModelChange",function(r){return Fe(e),Re(ge().standName=r)}),Z(6,"option",13),$e(7,"\u672a\u9078\u629e"),ne(),Te(8,hQ,2,2,"option",41),ne(),Z(9,"span",47)(10,"b",34),$e(11,"Pos: "),ne(),Z(12,"input",48),Ae("change",function(){return Fe(e),Re(ge().isUseStandImage=!0)})("ngModelChange",function(r){return Fe(e),Re(ge().character.standList.position=r)}),ne(),Z(13,"input",49),Ae("change",function(){return Fe(e),Re(ge().isUseStandImage=!0)})("ngModelChange",function(r){return Fe(e),Re(ge().character.standList.position=r)}),ne(),Z(14,"b",34),$e(15,"\uff05"),ne()(),Z(16,"button",50),Ae("click",function(){return Fe(e),Re(ge().farewellStand())}),$e(17,"\u9000\u53bb"),ne()()}if(2&t){const e=ge();ie("ngClass",wt(14,pQ,!e.isUseStandImageOnChatTab)),V(2),Mt("checked",e.isUseStandImage?"checked":""),ie("ngModel",e.isUseStandImage),rn("disabled",e.isUseStandImageOnChatTab?null:""),V(3),ie("ngModel",e.standName)("ngModelOptions",wa(16,Wf))("ngClass",wt(17,jg,""==e.standName)),rn("disabled",e.isUseStandImageOnChatTab?null:""),V(3),ie("ngForOf",e.standNameList),V(4),ie("ngModel",e.character.standList.position),rn("disabled",e.isUseStandImageOnChatTab?null:""),V(1),ie("ngModel",e.character.standList.position),rn("disabled",e.isUseStandImageOnChatTab?null:""),V(3),rn("disabled",e.isUseStandImageOnChatTab?null:"")}}function mQ(t,n){if(1&t){const e=gt();Z(0,"input",51),Ae("ngModelChange",function(r){return Fe(e),Re(ge().paletteColor=r)}),ne()}2&t&&ie("ngModel",ge().paletteColor)("ngModelOptions",wa(2,Wf))}function _Q(t,n){1&t&&(Z(0,"div",58),zt(1,"safe"),ne()),2&t&&pt("background-image",jt(1,2,"url("+ge().$implicit.imageUrl+")","style"))}function $Q(t,n){1&t&&(Z(0,"span",59),$e(1,", "),ne())}function vQ(t,n){if(1&t&&(Z(0,"div",53),Te(1,_Q,2,5,"div",54),Z(2,"div",55)(3,"span",56),zt(4,"safe"),$e(5),ne(),Te(6,$Q,2,0,"span",57),ne()()),2&t){const e=n.$implicit,i=n.index,r=ge(2);V(1),ie("ngIf",e.imageUrl),V(2),pt("color",jt(4,5,e.color,"style")),V(2),dt(e.name),V(1),ie("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function bQ(t,n){if(1&t&&(it(0),Te(1,vQ,7,8,"div",52),$e(2," \u304c\u5165\u529b\u4e2d... "),rt()),2&t){const e=ge();V(1),ie("ngForOf",e.writingPeerNameAndColors)}}const yQ=function(t){return{"direct-message":t}},WI=function(t,n){return{color:t,"font-weight":n}};class vr{constructor(n,e,i,r,o,s){this.ngZone=n,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=o,this.contextMenuService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Gn,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Gn,this._sendTo="",this.sendToChange=new Gn,this._text="",this.textChange=new Gn,this.chat=new Gn,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}get isUseStandImageOnChatTab(){const n=Et.instance.get(this.chatTabidentifier);return n&&n.isUseStandImage}get gameType(){return this._gameType}set gameType(n){this._gameType=n,this.gameTypeChange.emit(n)}get sendFrom(){return this._sendFrom}set sendFrom(n){this._sendFrom=n,this.sendFromChange.emit(n)}get sendTo(){return this._sendTo}set sendTo(n){this._sendTo=n,this.sendToChange.emit(n)}get text(){return this._text}set text(n){this._text=n,this.textChange.emit(n)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get character(){let n=Et.instance.get(this.sendFrom);return n instanceof an?n:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let n=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&i.value&&n.indexOf(i.value.toString())<0&&n.push(i.value.toString())}return n.sort()}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let n={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(n[r]||(n[r]=[]),n[r].indexOf(i.value.toString())<0&&n[r].push(i.value.toString()))}return Object.keys(n).sort().map(i=>({name:i,stands:n[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let n=Et.instance.get(this.sendFrom),e=null;return n instanceof an?e=n.imageFile:n instanceof Je&&(e=n.image),e||sn.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:Je.CHAT_TRANSPARENT_COLOR}set paletteColor(n){this.character.chatPalette.color=n||Je.CHAT_TRANSPARENT_COLOR}get myColor(){return Je.myCursor&&Je.myCursor.color&&Je.myCursor.color!=Je.CHAT_TRANSPARENT_COLOR?Je.myCursor.color:Je.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=Je.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let n=Et.instance.get(this.sendTo);return n instanceof Je?n.color:Je.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=Et.instance.getObjects(an).filter(n=>this.allowsChat(n))),this._gameCharacters}get diceBotInfos(){return Xn.diceBotInfos}get myPeer(){return Je.myCursor}get otherPeers(){return Et.instance.getObjects(Je)}get diceBotInfosIndexed(){return Xn.diceBotInfosIndexed}ngOnInit(){Ve.register(this).on("MESSAGE_ADDED",n=>{if(n.data.tabIdentifier!==this.chatTabidentifier)return;let e=Et.instance.get(n.data.messageIdentifier),i=Et.instance.getObjects(Je).find(o=>o.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on("UPDATE_GAME_OBJECT",n=>{if(n.data.aliasName!==an.aliasName||(this.shouldUpdateCharacterList=!0,n.data.identifier!==this.sendFrom))return;let e=Et.instance.get(n.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",n=>{let e=Et.instance.get(this.sendTo);e instanceof Je&&e.peerId===n.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",n=>{n.isSendFromSelf||n.data!==this.chatTabidentifier||(this.writingPeers.has(n.sendFrom)||this.writingPeers.set(n.sendFrom,new Oa(()=>{this.writingPeers.delete(n.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(n.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Ve.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(n=>{let e=Je.findByPeerId(n);return{name:e?e.name:"",color:e?e.color:Je.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let n=null;if(this.isDirect){let e=Et.instance.get(this.sendTo);if(e instanceof Je){let i=ki.parse(e.peerId);i&&(n=i.peerId)}}Ve.call("WRITING_A_MESSAGE",this.chatTabidentifier,n),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(n,e){if(n&&n.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=vr.history.length-1)return void(this.currentHistoryIndex=vr.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=vr.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}sendChat(n){var e=this;if(n&&n.preventDefault(),n&&13!==n.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let i=this.text,r=this.character;const o=this.gameType,s=this.sendFrom,a=this.sendTo,h=this.color,b=this.isUseFaceIcon,ee=this.standName,de=this.isUseStandImage,_e=this.isUseStandImageOnChatTab;""!=this.text&&(vr.history=vr.history.filter(Se=>Se!==this.text),vr.history.unshift(this.text),vr.history.length>=vr.MAX_HISTORY_NUM&&vr.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null),this.text="",this.previousWritingLength=this.text.length;const Ce=this.textAreaElementRef.nativeElement;Ce&&(Ce.value=""),this.calcFitHeight(),Ve.trigger("MESSAGE_EDITING_START",null),(0,hn.Z)(function*(){let Se="",Pe=null;const Ne=[];if(""!=i&&/^[\\\uffe5]+[:\uff1a]/.test(i))i=i.replace(/[\\\uffe5]([:\uff1a])/,"$1");else if(""!=i&&tt.toHalfWidth(i).startsWith(":"))if(r){const He=tt.parseCommands(r.chatPalette.evaluate(i.substring(1),r.rootDataElement));if(i=He.endString,He.commands.length){const Ue=[`${""==r.name?"(\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc)":r.name} \u3078\u306e\u30b3\u30de\u30f3\u30c9\uff1a${He.commandString}`];let We=!1;for(let mt=0;mt<He.commands.length;mt++){let Xe=null;try{const ct=He.commands[mt];if(ct.isIncomplete)throw"\u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a\u30b3\u30de\u30f3\u30c9\u4e0d\u5b8c\u5168\uff1a"+ct.targetName;const It=r.chatPalette.evaluate(ct.targetName,r.rootDataElement,Ne),ot=tt.toHalfWidth(ct.operator),_t=r.chatPalette.evaluate(ct.value,r.rootDataElement,Ne);let Ct,xt,Gt,on=!1,gn=!1;if((xt=r.detailDataElement.getFirstElementByNameUnsensitive(It))?(xt.isNumberResource||xt.isSimpleNumber||xt.isAbilityScore)&&(on=!0):(xt=r.detailDataElement.getFirstElementByNameUnsensitive(It,/^\u6700\u5927/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/^Max[\:\_\-\s]*/i)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/^\u521d\u671f/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/\u521d\u671f\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/\u6700\u5927\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/^\u57fa\u672c/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/^\u539f/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/\^$/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/\u57fa\u672c\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(It,/\u539f\u70b9$/))&&(xt.isNumberResource||xt.isAbilityScore?(on=!0,gn=!0):xt=null),!xt)throw`\u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a${""==tt.cr(It).trim()?"(\u7121\u540d\u306e\u5909\u6570)":tt.cr(It).trim()} \u306f\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f`;Ct=xt.loggingValue;let Tt=null;if(ct.isEscapeRoll||">"===ot)Tt=_t;else{const Ht=tt.toHalfWidth(_t.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim();if(""==tt.cr(Ht))Tt="";else if(/^[\+\-]?\d+$/.test(Ht)?Tt=parseInt(Ht):/^[\d\+\-\*\/\(\)]+$/.test(Ht.replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/"))?Xe=yield Xn.rollCommandAsync(`C(${Ht.replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/")})`,o||"DiceBot"):/^[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45]/i.test(_t)||/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(Ht.replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/"))||Ns.instance.diceRollTables.some(ln=>null!=ln.command&&new RegExp("^"+tt.toHalfWidth(ln.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toUpperCase().trim()+"([=+\\-]\\d*)?$").test(Ht.toUpperCase()))?Xe=yield Xn.rollCommandAsync(_t,o||"DiceBot"):Tt=_t,Xe){let ln=null;on&&Xe.result.length>0&&(ln=Xe.result.match(/\s\uff1e\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))?Tt=ln[1]:xt.isCheckProperty?Tt=Xe.isSuccess?"1":"0":Xe.result.length>0&&(Tt=Xe.isDiceRollTable?Xe.result.split(/\s\uff1e\s/).slice(1).join(""):Xe.result.split(/\s\uff1e\s/).slice(-1)[0])}}if(null==Tt||Xe&&Xe.isDiceRollTable&&Xe.isFailure||on&&""!==Tt&&isNaN(Tt))throw`\u2192 ${""==xt.name?"(\u7121\u540d\u306e\u5909\u6570)":xt.name} \u3092\u64cd\u4f5c \u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a`+ct.operator+ct.value;if(xt.isUrl&&!tt.validUrl(tt.cr(Tt)))throw`\u2192 ${""==xt.name?"(\u7121\u540d\u306e\u5909\u6570)":xt.name} \u3092\u64cd\u4f5c \u2192 URL\u4e0d\u6b63\uff1a`+ct.value;if(">"===ot)if(on)if(""!=Tt)if(xt.isNumberResource&&!gn){const Ht=parseInt(xt.currentValue+"");xt.currentValue=parseInt(Tt),Gt=(parseInt(Tt)-Ht).toString()}else{const Ht=null==xt.value?0:parseInt(xt.value+"");xt.value=parseInt(Tt),Gt=(parseInt(Tt)-Ht).toString()}else Gt="0";else xt.value=xt.isCheckProperty?""==Tt||0==parseInt(Tt)||"off"===tt.toHalfWidth(Tt).toLowerCase()?"":xt.name:xt.isNote||xt.isUrl?tt.cr(Tt):tt.cr(Tt).replace(/(:?\r\n|\r|\n)/," ");else if(xt.isNumberResource&&!gn)if(""!=Tt){const Ht=parseInt(xt.currentValue+""),ln=parseInt(xt.currentValue&&"="!==ot?xt.currentValue.toString():"0")+parseInt(Tt)*("-"===ot?-1:1);ln<=parseInt(xt.currentValue+"")?xt.currentValue=ln:ln>parseInt(xt.value+"")&&parseInt(xt.currentValue+"")<parseInt(xt.value+"")&&0!=parseInt(xt.value+"")?xt.currentValue=xt.value:(ln<=parseInt(xt.value+"")||0==parseInt(xt.value+""))&&(xt.currentValue=ln),Gt=(parseInt(xt.currentValue+"")-Ht).toString()}else Gt="0";else if(on){const Ht=null==xt.currentValue?0:parseInt(xt.value.toString());""!=Tt&&(xt.value=parseInt(xt.value&&"="!==ot?xt.value+"":"0")+parseInt(Tt)*("-"===ot?-1:1)),Gt=(parseInt(xt.value+"")-Ht).toString()}else if(xt.isCheckProperty&&"="==ot)xt.value=""==Tt||0==parseInt(Tt)||"off"===tt.toHalfWidth(Tt).toLowerCase()?"":xt.name;else{if("="!==ot)throw`\u2192 ${""==xt.name?"(\u7121\u540d\u306e\u5909\u6570)":xt.name} \u3092\u64cd\u4f5c \u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a`+ct.operator+ct.value;xt.value=xt.isNote||xt.isUrl?isNaN(Tt)||xt.isUrl?tt.cr(Tt):parseInt(Tt):isNaN(Tt)?tt.cr(Tt).replace(/(:?\r\n|\r|\n)/," "):parseInt(Tt)}const Pt=xt.loggingValue;let Ut=`\u2192 ${""==xt.name?"(\u7121\u540d\u306e\u5909\u6570)":xt.name} \u3092\u64cd\u4f5c`;Ut+=on?` ${Ct} \u2192 ${Ct===Pt?"\u5909\u66f4\u306a\u3057":Pt}`:xt.isCheckProperty?`${Ct===Pt?" \u5909\u66f4\u306a\u3057":Pt}`:` "${Ct}" \u2192 ${Ct===Pt?"\u5909\u66f4\u306a\u3057":'"'+Pt+'"'}`,Xe&&(Ut+=Xe.isDiceRollTable?` (${Xe.tableName}\uff1a${Xe.isEmptyDice?"":"\u{1f3b2}"}${Xe.result.split(/\s\uff1e\s/)[0]})`:` (${Xe.result.split(/\s\uff1e\s/g).map((Ht,ln)=>0==ln?Xe.isEmptyDice?"":"\u{1f3b2}"+o+"\uff1a"+Ht.replace(/^c?\(/i,"").replace(/\)$/,""):Ht).join(" \u2192 ")})`,Xe.isEmptyDice||(We=!0)),console.log(Gt),Ue.push(Ut),Ne.push(Gt??""),console.log(Ne)}catch(ct){if(ct instanceof Error)throw ct;Ue.push(ct),Ne.push("");continue}}Ue.length&&e.chatMessageService.sendOperationLog(Ue.join("\n")),We&&(Math.random()<.5?St.play(at.diceRoll1):St.play(at.diceRoll2))}}else e.chatMessageService.sendOperationLog("\u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a\u5bfe\u8c61\u304c\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306f\u306a\u3044");if(r&&(i=r.chatPalette.evaluate(i,r.rootDataElement,Ne),(tt.cr(i).trim()||ee)&&r.standList)){let He=null;He=b&&r.faceIcon?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:null;const Ue=r.standList.matchStandInfo(i,He,ee);if(de&&_e)if(Ue.farewell)e.farewellStand(r);else if(Ue.standElementIdentifier){Pe=Ue.standElementIdentifier;const We={characterIdentifier:r.identifier,standIdentifier:Ue.standElementIdentifier,color:r.chatPalette?r.chatPalette.color:Je.CHAT_DEFAULT_COLOR,secret:!!a};if(We.secret){const mt=Et.instance.get(a);mt&&(mt.peerId!=Je.myCursor.peerId&&Ve.call("POPUP_STAND_IMAGE",We,mt.peerId),Ve.call("POPUP_STAND_IMAGE",We,Je.myCursor.peerId))}else Ve.call("POPUP_STAND_IMAGE",We)}Se=Ue.matchMostLongText}const je=Os.instance.matchCutInInfo(i);if(_e&&je){for(const He of je.identifiers){const Ue={identifier:He,secret:!!a,sender:Je.myCursor.peerId};if(Ue.secret){const We=Et.instance.get(a);We&&(We.peerId!=Je.myCursor.peerId&&Ve.call("PLAY_CUT_IN",Ue,We.peerId),Ve.call("PLAY_CUT_IN",Ue,Je.myCursor.peerId))}else Ve.call("PLAY_CUT_IN",Ue)}if(je.names&&je.names.length&&!a){const He=new Map;for(const We of je.names){let mt=He.get(We)||0;mt+=1,He.set(""==We?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":We,mt)}const Ue=`${[...He.keys()].map(We=>He.get(We)>1?`${We}\xd7${He.get(We)}`:We).join("\u3001")}`;e.chatMessageService.sendOperationLog(Ue+" \u304c\u8d77\u52d5\u3057\u305f")}}if(Se.length<je.matchMostLongText.length&&(Se=je.matchMostLongText),i=i.slice(0,i.length-Se.length),_e&&r&&tt.cr(i).trim()){const He=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(i);let We,Ue=null!=He[4]?He[4].trim():i.trim();/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.test(Ue)?Ue="":((We=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(Ue))||(We=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(Ue)))&&(Ue=Ue.slice(We[1].length));const mt=/\u300c+([\s\S]+?)\u300d/gm;let Xe,ct=[];for(;null!==(Xe=mt.exec(Ue));)ct.push(Xe[1]);if(0===ct.length){const It=Ue.split(/[\s\u3000]/).slice(-1)[0];tt.isEmote(It)&&ct.push(It)}if(ct.length>0){const It={characterIdentifier:r.identifier,text:ct.join("\n\n"),faceIconIdentifier:b&&r.faceIcon?r.faceIcon.identifier:null,color:h,secret:!!a};if(It.secret){const ot=Et.instance.get(a);ot&&(ot.peerId!=Je.myCursor.peerId&&Ve.call("POPUP_CHAT_BALLOON",It,ot.peerId),Ve.call("POPUP_CHAT_BALLOON",It,Je.myCursor.peerId))}else Ve.call("POPUP_CHAT_BALLOON",It)}else tt.cr(i).trim()&&r.text&&Ve.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:r.identifier})}Je.isGMHold&&!a&&!Je.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(tt.toHalfWidth(i))&&(Je.myCursor.isGMMode=!0,e.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),Ve.trigger("CHANGE_GM_MODE",null)),tt.cr(i).trim()&&e.chat.emit({text:i,gameType:o,sendFrom:s,sendTo:a,color:h,isInverse:!!r&&r.isInverse,isHollow:!!r&&r.isHollow,isBlackPaint:!!r&&r.isBlackPaint,aura:r?r.aura:-1,isUseFaceIcon:b,characterIdentifier:r?r.identifier:null,standIdentifier:Pe,standName:ee,isUseStandImage:de&&_e})})()}calcFitHeight(){let n=this.textAreaElementRef.nativeElement;n.style.height="",n.scrollHeight>=n.offsetHeight&&(n.style.height=n.scrollHeight+"px")}loadDiceBot(n){console.log("onChangeGameType ready"),Xn.getHelpMessage(n).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){Xn.getHelpMessage(this.gameType).then(n=>{this.gameHelp=n;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let s of Xn.diceBotInfos)s.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+s.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],o=this.panelService.open(vc,{left:i.x,top:i.y,width:600,height:500});o.title=e,o.text=this.gameHelp})}onContextMenu(n){if(n.stopPropagation(),n.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831...",action:()=>{this.panelService.open(jv,{width:520,height:600,top:e.y-100,left:e.x-100})}}],Je.myCursor.name,null,Je.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,o=this.text.trim();"\u300c"!=o.slice(0,1)&&(o="\u300c"+o),"\u300d"!=o.slice(-1)&&(o+="\u300d"),this.text=o,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(qt),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,o)=>({name:this.character.currntIconIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=o&&(this.character.currntIconIndex=o)},default:this.character.currntIconIndex==o,icon:r})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(qt),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,o)=>({name:this.character.currntImageIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=o,St.play(at.surprise),Ve.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==o,icon:r}))})),i.push(qt),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,Ve.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,Ve.trigger("UPDATE_INVENTORY",null)}},qt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,o)=>({name:`${this.character.aura==o?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=o,Ve.trigger("UPDATE_INVENTORY",null)}})))},qt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,Ve.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(qt),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(n=null){if(n||(n=this.character),this.character){const e={characterIdentifier:this.character.identifier};if(this.sendTo){const i=Et.instance.get(this.sendTo);i&&(i.peerId!=Je.myCursor.peerId&&Ve.call("FAREWELL_STAND_IMAGE",e,i.peerId),Ve.call("FAREWELL_STAND_IMAGE",e,Je.myCursor.peerId))}else Ve.call("FAREWELL_STAND_IMAGE",e)}}showDetail(n){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";n.name.length&&(i+=" - "+n.name),this.panelService.open(ps,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=n}showChatPalette(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Hu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=n}showStandSetting(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Bf,{left:e.x-400,top:e.y-175,width:730,height:572}).character=n}allowsChat(n){switch(n.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of Lt.peerContexts)if(e.isOpen&&n.location.name===e.peerId)return!1;return!0}}}vr.history=new Array,vr.MAX_HISTORY_NUM=1e3,vr.\u0275fac=function(n){return new(n||vr)(Ge(Fn),Ge(Vr),Ge(zg),Ge(Wn),Ge(vi),Ge(pr))},vr.\u0275cmp=mn({type:vr,selectors:[["chat-input"]],viewQuery:function(n,e){if(1&n&&Tn(WX,7),2&n){let i;En(i=Sn())&&(e.textAreaElementRef=i.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:35,vars:34,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","5px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller;",4,"ngIf"],[3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","9.5em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"font-size","smaller",3,"ngClass"],[2,"margin-right","2px"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"display","inline"],[1,"peer-name",2,"font-weight","bold"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(n,e){if(1&n&&(Z(0,"div",0)(1,"div",1),Ae("contextmenu",function(r){return e.onContextMenu(r)}),Te(2,YX,2,1,"div",2),Te(3,nQ,3,2,"ng-template",null,3,Qn),ne(),Z(5,"div",4)(6,"div")(7,"label",5),Te(8,iQ,1,2,"input",6),Te(9,rQ,2,0,"b",7),ne(),Z(10,"select",8),Ae("ngModelChange",function(r){return e.sendFrom=r})("change",function(){return e.standName=""}),Te(11,oQ,2,4,"option",9),Te(12,sQ,2,4,"option",10),ne(),Z(13,"span",11),$e(14," \u27a1 "),Z(15,"select",12),Ae("ngModelChange",function(r){return e.sendTo=r}),Z(16,"option",13),$e(17,"\u5168\u54e1"),ne(),Te(18,lQ,3,5,"option",14),ne()(),Z(19,"span",11),Te(20,dQ,4,7,"select",15),Te(21,fQ,3,6,"select",16),Z(22,"button",17),Ae("click",function(){return e.showDicebotHelp()}),$e(23,"?"),ne()()(),Te(24,gQ,18,19,"div",18),Z(25,"div")(26,"form"),Te(27,mQ,1,3,"input",19),Z(28,"textarea",20,21),Ae("ngModelChange",function(r){return e.text=r})("input",function(){return e.onInput()})("keydown.enter",function(r){return e.sendChat(r)})("keydown.control.arrowup",function(r){return e.moveHistory(r,1)})("keydown.control.arrowdown",function(r){return e.moveHistory(r,-1)}),ne(),Z(30,"button",22),Ae("click",function(){return e.sendChat(null)}),Z(31,"b"),$e(32,"SEND"),ne()()()(),Z(33,"div",23),Te(34,bQ,3,1,"ng-container",24),ne()()()),2&n){const i=dn(4);ie("ngClass",wt(23,yQ,e.isDirect)),V(2),ie("ngIf",!e.character)("ngIfElse",i),V(6),ie("ngIf",e.character),V(1),ie("ngIf",e.character),V(1),pt("max-width",e.character?"9.5em":"13em"),ie("ngModel",e.sendFrom)("ngStyle",fn(25,WI,e.color,e.sendFrom!=(null==e.myPeer?null:e.myPeer.identifier)?"normal":"bolder")),V(1),ie("ngIf",!e.onlyCharacters),V(1),ie("ngForOf",e.gameCharacters),V(3),ie("ngModel",e.sendTo)("ngClass",wt(28,jg,""==e.sendTo))("ngStyle",fn(30,WI,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),V(3),ie("ngForOf",e.otherPeers),V(2),ie("ngIf",e.diceBotInfosIndexed.length>0),V(1),ie("ngIf",e.diceBotInfosIndexed.length<1),V(3),ie("ngIf",e.hasStand),V(3),ie("ngIf",e.onlyCharacters),V(1),ie("placeholder",e.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",e.text)("ngModelOptions",wa(33,Wf)),V(6),ie("ngIf",0<e.writingPeerNameAndColors.length)}},dependencies:[oi,$i,Rn,hr,nc,so,ao,Ii,Ro,Lo,Fo,vo,Mi,tc,Ys,Ks,Ci,Ma,_i],styles:['[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em;margin-bottom:1px}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;-o-object-fit:cover;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}']});const CQ=["edit"];function xQ(t,n){1&t&&An(0)}function wQ(t,n){if(1&t&&(it(0),Te(1,xQ,1,0,"ng-container",11),rt()),2&t){ge();const e=dn(11);V(1),ie("ngTemplateOutlet",e)}}function EQ(t,n){1&t&&An(0)}function TQ(t,n){if(1&t&&(it(0),Te(1,EQ,1,0,"ng-container",11),rt()),2&t){ge();const e=dn(13);V(1),ie("ngTemplateOutlet",e)}}function SQ(t,n){1&t&&An(0)}function IQ(t,n){1&t&&An(0)}function MQ(t,n){if(1&t&&(Z(0,"div"),Te(1,IQ,1,0,"ng-container",11),ne()),2&t){ge();const e=dn(19);V(1),ie("ngTemplateOutlet",e)}}function kQ(t,n){1&t&&An(0)}function DQ(t,n){if(1&t&&(it(0),Te(1,kQ,1,0,"ng-container",11),rt()),2&t){ge();const e=dn(13);V(1),ie("ngTemplateOutlet",e)}}function AQ(t,n){1&t&&An(0)}function PQ(t,n){if(1&t&&(it(0),Te(1,AQ,1,0,"ng-container",11),rt()),2&t){ge();const e=dn(11);V(1),ie("ngTemplateOutlet",e)}}const NQ=function(t,n){return{"black-paint":t,"face-icon":n}};function OQ(t,n){if(1&t&&(vt(0,"img",15),zt(1,"safe")),2&t){const e=ge(2);ie("src",jt(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),vn)("ngClass",fn(5,NQ,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}const FQ=function(t,n){return{inverse:t,hollow:n}},RQ=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}};function LQ(t,n){if(1&t&&(Z(0,"div",12)(1,"span",13),Te(2,OQ,2,8,"img",14),ne()()),2&t){const e=ge();ie("ngClass",fn(3,FQ,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),V(1),ie("ngClass",Ms(6,RQ,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),V(1),ie("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function BQ(t,n){if(1&t&&(it(0),Z(1,"span",19),$e(2),zt(3,"date"),ne(),rt()),2&t){const e=ge(2);V(2),dt(jt(3,1,e.chatMessage.timestamp,"H:mm"))}}function zQ(t,n){if(1&t&&(vt(0,"img",22),zt(1,"safe")),2&t){const e=ge(3);ie("src",jt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),vn)}}const Hv=function(t){return{grow:t}};function jQ(t,n){if(1&t&&(it(0),Te(1,zQ,2,4,"img",20),Z(2,"span",18),$e(3),ne(),Z(4,"span",21),$e(5,"\u27a1"),ne(),rt()),2&t){const e=ge(2);V(1),ie("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),V(1),pt("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),ie("ngClass",wt(5,Hv,e.chatMessage.isDirect||e.chatMessage.isSecret)),V(1),dt(e.chatMessage.toName)}}function UQ(t,n){if(1&t&&(vt(0,"img",22),zt(1,"safe")),2&t){const e=ge(3);ie("src",jt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),vn)}}function HQ(t,n){if(1&t&&(it(0),Z(1,"span",23),$e(2,"\u27a1"),ne(),Te(3,UQ,2,4,"img",20),Z(4,"span",18),$e(5),ne(),rt()),2&t){const e=ge(2);V(3),ie("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),V(1),pt("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),ie("ngClass",wt(5,Hv,e.chatMessage.isDirect||e.chatMessage.isSecret)),V(1),dt(e.chatMessage.toName)}}function VQ(t,n){if(1&t){const e=gt();Z(0,"span",27),Ae("click",function(r){return Fe(e),Re(ge(3).onLinkClick(r))}),zt(1,"safe"),ne()}2&t&&ie("innerHTML",jt(1,1,ge(3).htmlEscapedFrom,"html"),cr)}function GQ(t,n){if(1&t&&(Z(0,"span",19),$e(1),zt(2,"date"),ne()),2&t){const e=ge(3);V(1),dt(jt(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function qQ(t,n){if(1&t&&(Z(0,"span",19),$e(1),zt(2,"date"),ne()),2&t){const e=ge(3);V(1),dt(jt(2,1,e.chatMessage.timestamp,"H:mm"))}}function WQ(t,n){1&t&&An(0)}function KQ(t,n){if(1&t&&(it(0),Te(1,VQ,2,4,"span",24),Te(2,GQ,3,4,"span",25),Te(3,qQ,3,4,"span",25),Te(4,WQ,1,0,"ng-container",26),rt()),2&t){const e=ge(2),i=dn(19);V(1),ie("ngIf",!e.isCompact),V(1),ie("ngIf",!e.isCompact&&e.chatMessage.timestamp),V(1),ie("ngIf",e.isCompact&&e.chatMessage.timestamp),V(1),ie("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function YQ(t,n){if(1&t&&(Z(0,"div",16),Te(1,BQ,4,4,"ng-container",2),Z(2,"span",17),Te(3,jQ,6,7,"ng-container",2),Z(4,"span",18),$e(5),ne(),Te(6,HQ,6,7,"ng-container",2),ne(),Te(7,KQ,5,5,"ng-container",2),ne()),2&t){const e=ge();V(1),ie("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),V(2),ie("ngIf",!e.isMine&&e.chatMessage.toColor),V(1),pt("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),ie("ngClass",wt(8,Hv,e.chatMessage.isDirect||e.chatMessage.isSecret)),V(1),dt(e.chatMessage.name),V(1),ie("ngIf",e.isMine&&e.chatMessage.toColor),V(1),ie("ngIf",!e.isCompact||e.isMine)}}function ZQ(t,n){if(1&t){const e=gt();Z(0,"div",33)(1,"span",34),$e(2),ne(),Z(3,"textarea",35,36),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).editingText=r)})("keydown.enter",function(r){return Fe(e),Re(ge(2).editEnd(r))})("keydown.escape",function(){return Fe(e),Re(ge(2).editCancel())}),ne()()}if(2&t){const e=ge(2);V(2),dt(e.lastNewLineAdjust(e.editingText)),V(1),ie("ngModel",e.editingText)}}function XQ(t,n){if(1&t&&(Z(0,"span",37)(1,"b",38),$e(2,"\u7de8\u96c6\u6e08"),ne(),$e(3),zt(4,"date"),ne()),2&t){const e=ge(2);V(3),Zn(" ",jt(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function QQ(t,n){if(1&t){const e=gt();Z(0,"button",39),Ae("click",function(){return Fe(e),Re(ge(2).discloseMessage())}),$e(1,"\u7d50\u679c\u3092\u516c\u958b"),ne()}}function JQ(t,n){if(1&t){const e=gt();Te(0,ZQ,5,2,"div",28),Z(1,"div")(2,"span",29)(3,"span",30),Ae("click",function(r){return Fe(e),Re(ge().onLinkClick(r))}),zt(4,"safe"),ne(),Te(5,XQ,5,4,"span",31),Te(6,QQ,2,0,"button",32),ne()()}if(2&t){const e=ge();ie("ngIf",e.isEditing),V(1),pt("display",e.isEditing?"none":"block"),V(2),pt("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),ie("innerHTML",jt(4,8,e.htmlEscapedText,"html"),cr),V(2),ie("ngIf",!e.isEditing&&e.chatMessage.isEdited),V(1),ie("ngIf",e.chatMessage.isSecret)}}function eJ(t,n){1&t&&(Z(0,"span")(1,"s"),$e(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),ne()())}function tJ(t,n){if(1&t){const e=gt();Z(0,"button",45),Ae("click",function(){return Fe(e),Re(ge(2).editStart())}),Z(1,"i",46),$e(2,"edit"),ne()()}}function nJ(t,n){1&t&&(Z(0,"button",47)(1,"i",46),$e(2,"clear"),ne()())}function iJ(t,n){if(1&t){const e=gt();Z(0,"button",48),Ae("click",function(){return Fe(e),Re(ge(2).editEnd())}),Z(1,"i",46),$e(2,"done"),ne()()}2&t&&ie("disabled",0==ge(2).editingText.trim().length)}function rJ(t,n){if(1&t){const e=gt();Z(0,"button",49),Ae("click",function(){return Fe(e),Re(ge(2).editCancel())}),Z(1,"i",46),$e(2,"clear"),ne()()}}function oJ(t,n){if(1&t&&(Z(0,"span",40),Te(1,tJ,3,0,"button",41),Te(2,nJ,3,0,"button",42),Te(3,iJ,3,1,"button",43),Te(4,rJ,3,0,"button",44),ne()),2&t){const e=ge();pt("visibility",e.isEditing?"visible":""),V(1),ie("ngIf",!e.isEditing),V(1),ie("ngIf",!e.isEditing),V(1),ie("ngIf",e.isEditing),V(1),ie("ngIf",e.isEditing)}}const sJ=function(t,n){return{compact:t,editing:n}},aJ=function(t,n,e,i,r,o){return{"is-mine":t,"is-others":n,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":o}},lJ=function(t,n,e,i){return{"is-success":t,"is-failure":n,"is-critical":e,"is-fumble":i}};let cJ=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.modalService=i,this.changeDetector=r,this.compact=!1,this.imageFile=sn.Empty,this.animeState="inactive",this.isEditing=!1,this.editingText="",this.stringUtil=tt}ngOnInit(){Ve.register(this).on("MESSAGE_EDITING_START",-1e3,r=>{r.isSendFromSelf&&(!r.data||r.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",r=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){this.chatMessage.isAnimated=!0}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=di.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=tt.escapeHtml(e),r&&(e=tt.rubyToHtml(e)),yv.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(o){if("url"==o.getType()&&tt.validUrl(o.getAnchorHref())){if(tt.sameOrigin(o.getAnchorHref()))return!0;{const s=o.buildTag();return s.setAttr("rel","nofollow"),s.addClass("outer-link"),s}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){Ve.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!tt.sameOrigin(i))return e.preventDefault(),this.modalService.open(co,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(Ge(Vr),Ge(Yn),Ge(Ki))},t.\u0275cmp=mn({type:t,selectors:[["chat-message"]],viewQuery:function(e,i){if(1&e&&Tn(CQ,5),2&e){let r;En(r=Sn())&&(i.editElm=r.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[Ti([{provide:yw,useValue:!1}])],decls:20,vars:36,consts:[[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["image",""],["title",""],["visible",""],["secret",""],["editor",""],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"innerHTML","click"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"innerHTML","click"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModel","ngModelChange","keydown.enter","keydown.escape"],["edit",""],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"disabled","click"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(e,i){if(1&e&&(Z(0,"div",0)(1,"div",1),Te(2,wQ,2,1,"ng-container",2),Z(3,"div",3),Te(4,TQ,2,1,"ng-container",2),Z(5,"div",4),Te(6,SQ,1,0,"ng-container",5),ne(),Te(7,MQ,2,1,"div",2),Te(8,DQ,2,1,"ng-container",2),ne(),Te(9,PQ,2,1,"ng-container",2),ne()(),Te(10,LQ,3,15,"ng-template",null,6,Qn),Te(12,YQ,8,10,"ng-template",null,7,Qn),Te(14,JQ,7,11,"ng-template",null,8,Qn),Te(16,eJ,3,0,"ng-template",null,9,Qn),Te(18,oJ,5,6,"ng-template",null,10,Qn)),2&e){const r=dn(15),o=dn(17);ie("ngClass",fn(21,sJ,i.isCompact,i.isEditing)),V(1),pt("border-left-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444")("border-right-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444"),ie("ngClass",G_(24,aJ,i.isMine,!i.isMine,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot||i.chatMessage.isCalculate,i.chatMessage.isOperationLog))("@flyInOut",i.isMine?null:"active")("@flyInOutMe",i.isMine?"active":null),V(1),ie("ngIf",i.isMine&&!i.isCompact),V(1),pt("justify-content",i.isCompact&&!i.isMine?"flex-end":"flex-start"),V(1),ie("ngIf",!i.isCompact||i.isMine),V(1),pt("flex-grow",i.isCompact&&!i.isEditing?0:1),ie("ngClass",Is(31,lJ,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isSuccess,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFailure,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isCritical,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFumble)),V(1),ie("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf||i.chatMessage.isGMMode)("ngIfThen",r)("ngIfElse",o),V(1),ie("ngIf",i.isEditable&&i.isCompact),V(1),ie("ngIf",i.isCompact&&!i.isMine),V(1),ie("ngIf",!i.isMine&&!i.isCompact)}},dependencies:[oi,Rn,tl,Ii,Mi,Ci,H2,_i],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%]{visibility:visible}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;-o-object-fit:cover;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[Hn("flyInOut",[en("* => active",[Qt("200ms ease-out",Cn([ht({transform:"translateX(100px)",opacity:"0",offset:0}),ht({transform:"translateX(0)",opacity:"1",offset:1})]))]),en("void => *",[Qt("200ms ease-out",Cn([ht({opacity:"0",offset:0}),ht({opacity:"1",offset:1})]))])]),Hn("flyInOutMe",[en("* => active",[Qt("200ms ease-out",Cn([ht({transform:"translateX(-100px)",opacity:"0",offset:0}),ht({transform:"translateX(0)",opacity:"1",offset:1})]))]),en("void => *",[Qt("200ms ease-out",Cn([ht({opacity:"0",offset:0}),ht({opacity:"1",offset:1})]))])])]}}),t})();const uJ=["logContainer"],dJ=["messageContainer"];function fJ(t,n){if(1&t&&vt(0,"chat-message",7),2&t){const e=ge().$implicit,i=ge(2);ie("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function hJ(t,n){if(1&t&&(it(0),Te(1,fJ,1,3,"chat-message",6),rt()),2&t){const e=n.$implicit;V(1),ie("ngIf",e.isDisplayable)}}function pJ(t,n){if(1&t&&(it(0),Te(1,hJ,2,1,"ng-container",5),rt()),2&t){const e=ge();V(1),ie("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function gJ(t,n){if(1&t&&vt(0,"chat-message",7),2&t){const e=n.$implicit,i=ge(2);ie("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function mJ(t,n){if(1&t&&(it(0),Te(1,gJ,1,3,"chat-message",8),rt()),2&t){const e=ge();V(1),ie("ngForOf",e.sampleMessages)}}const Vv=window.navigator.userAgent.toLowerCase(),KI=Vv.indexOf("iphone")>-1||Vv.indexOf("ipad")>-1||Vv.indexOf("macintosh")>-1&&"ontouchend"in document;let _J=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.compact=!1,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Gn}get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((i,r)=>i+(r.isDisplayable?this.compact||r.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new di;for(let o in i)if("identifier"!==o&&"tabIdentifier"!==o){if("text"===o){r.value=i[o];continue}null==i[o]||""===i[o]||r.setAttribute(o,i[o])}e.push(r)}this.sampleMessages=e,Ve.register(this).on("MESSAGE_ADDED",i=>{let r=Et.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=Et.instance.get(i.data.identifier);r&&r instanceof di&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new Oa(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new Oa(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Ve.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&Ur(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,h=null,b=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),h=s.getBoundingClientRect(),b=a.top-h.top-this.scrollSpeed,(!r||!o)&&.25<b**2&&(this.panelService.scrollablePanel.scrollTop-=b);let ee=this.logContainerRef.nativeElement.getBoundingClientRect(),de=this.messageContainerRef.nativeElement.getBoundingClientRect(),_e=de.top-ee.top,Ce=_e+de.height,Se=this.getScrollPosition();return r=Se.top<_e,o=Ce<Se.bottom&&Se.bottom<Se.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&Ur(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,h=this.getScrollPosition();this.scrollSpeed=h.top-this.preScrollTop,this.preScrollTop=h.top;let b=h.top<r,ee=o<h.bottom&&h.bottom<h.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!b&&!ee)return;let de=h.top-(!e&&b?100:1200),_e=h.bottom+(!e&&ee?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,de,_e,h,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),Ur(()=>{let Se=this.getScrollPosition();this.scrollSpeed=Se.top-this.preScrollTop,this.preScrollTop=Se.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let h=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/h)+1:r>e&&(KI||(this.topIndex+=Math.floor((r-e)/h))),i>o?KI||(this.bottomIndex-=Math.floor((i-o)/h)):i<o&&(this.bottomIndex+=Math.floor((o-i)/h)+1)}this.adjustIndex()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Ki),Ge(Wn))},t.\u0275cmp=mn({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(Tn(uJ,7),Tn(dJ,7)),2&e){let r;En(r=Sn())&&(i.logContainerRef=r.first),En(r=Sn())&&(i.messageContainerRef=r.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[Cs],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(Z(0,"div",0,1)(2,"div",2,3),Te(4,pJ,2,2,"ng-container",4),Te(5,mJ,2,1,"ng-container",4),ne()()),2&e&&(pt("min-height",i.minScrollHeight,"px"),V(2),pt("margin-bottom",i.bottomSpace,"px"),V(2),ie("ngIf",!i.isEmpty),V(1),ie("ngIf",i.isEmpty))},dependencies:[$i,Rn,cJ],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})();class $J{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=ds.SQUARE,o="#000000e6",s=!0){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let a=this.canvasElement.getContext("2d");if(r<0)return;let h=this.generateCalcGridPositionFunc(r);this.makeBrush(a,i,o);for(let b=0;b<=e;b++)for(let ee=0;ee<=n;ee++){let{gx:de,gy:_e}=h(ee,b,i);this.strokeSquare(a,de,_e,i),s&&a.fillText((ee+1).toString()+"-"+(b+1).toString(),de+i/2,_e+i/2)}}generateCalcGridPositionFunc(n){switch(n){case ds.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case ds.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===ds.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),h=e+r/2,b=i+r/2;n.beginPath();for(let ee=0;ee<6;ee++){s+=60;let de=Math.PI/180*s,_e=Math.cos(de)*a+h,Ce=Math.sin(de)*a+b;n.lineTo(_e,Ce)}n.closePath(),n.stroke()}}var Sc=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(Sc||(Sc={})),Sc))(),gs=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(gs||(gs={})),gs))();class vJ{constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new ls(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,b=0,de=0,_e=Sc.DRAG;2===this.buttonCode?(_e=Sc.ROTATE,de=-r/5,b=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,b,0,de,_e,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,Sc.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,h=this.getKeyName(n);switch(h){case gs.ArrowLeft:n.shiftKey?a=-2:e=10;break;case gs.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case gs.ArrowRight:n.shiftKey?a=2:e=-10;break;case gs.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=gs[h]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,Sc.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return gs.ArrowLeft;case 38:return gs.ArrowUp;case 39:return gs.ArrowRight;case 40:return gs.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var El=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(El||(El={})),El))();class bJ{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",h=>{let b=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:h.center.x,clientY:h.center.y});this.ngZone.run(()=>h.srcEvent.target.dispatchEvent(b))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-n.center.x)**2+(this.tappedPanCenter.y-n.center.y)**2&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,El.PAN,n.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,El.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,El.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,El.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,El.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}class br{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new br){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,h=r+this.m32,b=o+this.m33,ee=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==ee&&(ee=1e-4),a/=ee,h/=ee,b/=ee;let de=b-o;if(0==de)return e.x=i,e.y=r,e.z=o,e.w=o,e;let _e=-o/de;return i+=_e*(a-i),r+=_e*(h-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return br.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new br){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(br.makePosition(e,br.MATRIX3D))}static makePerspective(n,e=new br){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(br.makePerspective(n,br.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,h=this.m22,b=this.m23,ee=this.m24,de=this.m31,_e=this.m32,Ce=this.m33,Se=this.m34,Pe=this.m41,Ne=this.m42,je=this.m43,He=this.m44;e[0]=b*Se*Ne-ee*Ce*Ne+ee*_e*je-h*Se*je-b*_e*He+h*Ce*He,e[1]=s*Ce*Ne-o*Se*Ne-s*_e*je+r*Se*je+o*_e*He-r*Ce*He,e[2]=o*ee*Ne-s*b*Ne+s*h*je-r*ee*je-o*h*He+r*b*He,e[3]=s*b*_e-o*ee*_e-s*h*Ce+r*ee*Ce+o*h*Se-r*b*Se;let Ue=i*e[0]+a*e[1]+de*e[2]+Pe*e[3];return 0==Ue?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=ee*Ce*Pe-b*Se*Pe-ee*de*je+a*Se*je+b*de*He-a*Ce*He,e[5]=o*Se*Pe-s*Ce*Pe+s*de*je-i*Se*je-o*de*He+i*Ce*He,e[6]=s*b*Pe-o*ee*Pe-s*a*je+i*ee*je+o*a*He-i*b*He,e[7]=o*ee*de-s*b*de+s*a*Ce-i*ee*Ce-o*a*Se+i*b*Se,e[8]=h*Se*Pe-ee*_e*Pe+ee*de*Ne-a*Se*Ne-h*de*He+a*_e*He,e[9]=s*_e*Pe-r*Se*Pe-s*de*Ne+i*Se*Ne+r*de*He-i*_e*He,e[10]=r*ee*Pe-s*h*Pe+s*a*Ne-i*ee*Ne-r*a*He+i*h*He,e[11]=s*h*de-r*ee*de-s*a*_e+i*ee*_e+r*a*Se-i*h*Se,e[12]=b*_e*Pe-h*Ce*Pe-b*de*Ne+a*Ce*Ne+h*de*je-a*_e*je,e[13]=r*Ce*Pe-o*_e*Pe+o*de*Ne-i*Ce*Ne-r*de*je+i*_e*je,e[14]=o*h*Pe-r*b*Pe-o*a*Ne+i*b*Ne+r*a*je-i*h*je,e[15]=r*b*de-o*h*de+o*a*_e-i*b*_e-r*a*Ce+i*h*Ce,n.setData(e),n.scalar(1/Ue),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Xi.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(br.MATRIX3D.setCSS(n).flatten()):this.append(br.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new br){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,h=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,b=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,ee=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,de=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,_e=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,Ce=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,Se=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Pe=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,Ne=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,je=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,He=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,Ue=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=h,i.m22=b,i.m23=ee,i.m24=de,i.m31=_e,i.m32=Ce,i.m33=Se,i.m34=Pe,i.m41=Ne,i.m42=je,i.m43=He,i.m44=Ue,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}br.MATRIX3D=new br;class Kf{constructor(n){this.matrix=new br,this.sceneTransform=new br,this.inverseSceneTransform=new br,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Xi.relation(e.paddingTop,i),this.paddingTop=Xi.relation(e.paddingTop,r),this.marginLeft=Xi.relation(e.marginLeft,i),this.marginTop=Xi.relation(e.marginTop,r),this.borderLeft=Xi.relation(e.borderLeft,i),this.borderTop=Xi.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new Kf(r),a=br.multiply(this.sceneTransform,s.inverseSceneTransform),h={x:0,y:0,z:0,w:1};return h.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,h.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,h.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,h.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(h),h}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new br),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],h=Xi.relation(a[0],i.offsetWidth,.5*i.offsetWidth),b=Xi.relation(a[1],i.offsetHeight,.5*i.offsetHeight),ee=Xi.relation(a[2],0,0);e.appendPosition(-h,-b,-ee),e.appendCSS(r.transform),e.appendPosition(h,b,ee)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=Xi.parse(a.perspective)}if(n.parentElement&&s){let h=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),b=Xi.relation(h[0],i.parentElement.offsetWidth),ee=Xi.relation(h[1],i.parentElement.offsetHeight);e.appendPosition(-b,-ee,0),e.appendPerspective(s),e.appendPosition(b,ee,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let Tl=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new Kf(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new Kf(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new Kf(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)($n(vi))},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Qu=(()=>{class t{constructor(e){this.coordinateService=e,this._emptyTable=new rr(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Sl(()=>Et.instance.getObjects(an).filter(i=>i.isVisibleOnTable)),this.cardCache=new Sl(()=>Et.instance.getObjects(ei).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Sl(()=>Et.instance.getObjects(ai).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Sl(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.rangeCache=new Sl(()=>Et.instance.getObjects(yi).filter(i=>i.isVisibleOnTable)),this.terrainCache=new Sl(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Sl(()=>Et.instance.getObjects(Gr)),this.diceSymbolCache=new Sl(()=>Et.instance.getObjects(Ir)),this.initialize()}get tableSelecter(){return Sr.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return Et.instance.getObjects(Je)}initialize(){this.refreshCacheAll(),Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(Co.aliasName),void this.refreshCache(Tr.aliasName);let i=Et.instance.get(e.data.identifier);i&&i instanceof Ni?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=gi.instance.parseXml(e.data.xmlElement);if(r instanceof Ni){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),St.play(at.piecePut)}else r instanceof yl?Fs.instance.addChatTab(r):r instanceof Ra?Ns.instance.addDiceRollTable(r):r instanceof Oi&&Os.instance.addCutIn(r)})}findCache(e){switch(e){case an.aliasName:return this.characterCache;case ei.aliasName:return this.cardCache;case ai.aliasName:return this.cardStackCache;case Co.aliasName:return this.tableMaskCache;case Tr.aliasName:return this.terrainCache;case Gr.aliasName:return this.textNoteCache;case Ir.aliasName:return this.diceSymbolCache;case yi.aliasName:return this.rangeCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.rangeCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case Co.aliasName:e instanceof Co&&(e.isLock=!1);case Tr.aliasName:if(e instanceof Tr&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;case ei.aliasName:case ai.aliasName:case yi.aliasName:case Gr.aliasName:(e instanceof ei||e instanceof ai||e instanceof yi||e instanceof Gr)&&(e.isLocked=!1),e instanceof yi&&(e.followingCharctorIdentifier=null);default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)($n(Tl))},t.\u0275prov=xn({token:t,factory:t.\u0275fac}),t})();class Sl{constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}let Ug=(()=>{class t{constructor(){}createGameCharacter(e){let i=an.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=Co.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=Kt.instance.get(i);r||(r=Kt.instance.add(i),Vn.create(r.identifier).tag="*default \u5730\u5f62");let o=this.getViewTable();if(!o)return;let s=Tr.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Gr.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=Ir.create(i,r,1),a=null;return s.nothingFaces.forEach(h=>{let b=`./assets/images/dice/${o}/${o}[0].png`;a=Kt.instance.get(b),a||(a=Kt.instance.add(b),Vn.create(a.identifier).tag="*default "+(r===qi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(h).value=a.identifier}),s.faces.forEach(h=>{let b=`./assets/images/dice/${o}/${o}[${h}].png`;a=Kt.instance.get(b),a||(a=Kt.instance.add(b),Vn.create(a.identifier).tag="*default "+(r===qi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(h).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let o,s;o=Kt.instance.get(i),o||(o=Kt.instance.add(i),Vn.create(o.identifier).tag="*default \u30ab\u30fc\u30c9"),s=Kt.instance.get(r),s||(s=Kt.instance.add(r),Vn.create(s.identifier).tag="*default \u30ab\u30fc\u30c9");let a=ei.create("\u30ab\u30fc\u30c9",o.identifier,s.identifier);return a.location.x=e.x-25,a.location.y=e.y-25,a.posZ=e.z,a}cardName(e){let i="";const r=e.slice(0,1),o=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==o?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==o?"\u30a8\u30fc\u30b9":o>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][o-11]:o}`,i}createTrump(e){let i=ai.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!Kt.instance.get(r)){const a=Kt.instance.add(r);Vn.create(a.identifier).tag="*default \u30ab\u30fc\u30c9"}let o=["c","d","h","s"],s=[];for(let a of o)for(let h=1;h<=13;h++)s.push(a+("00"+h).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let h="./assets/images/trump/"+a+".gif";if(!Kt.instance.get(h)){const ee=Kt.instance.add(h);Vn.create(ee.identifier).tag="*default \u30ab\u30fc\u30c9"}let b=ei.create(this.cardName(a),h,r);i.putOnBottom(b)}return i}createRangeArea(e,i){let r;switch(i){case"LINE":r=yi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u76f4\u7dda)",1,6,100);break;case"CIRCLE":r=yi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u5186)",3,3,100);break;case"SQUARE":r=yi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u6b63\u65b9\u5f62)",3,3,100);break;case"DIAMOND":r=yi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u30c0\u30a4\u30e4)",3,3,100);break;default:r=yi.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u9310\u5f62)",6,6,100)}return r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i,r.commonDataElement.getFirstElementByName("opacity").currentValue=60,r}makeDefaultTable(){let e=new rr("gameTable"),i=null,r=sn.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=Kt.instance.add(r),Vn.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),Sr.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new an("testCharacter_1"),r=sn.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=Kt.instance.add(r),Vn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new an("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new an("testCharacter_3"),r=sn.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=Kt.instance.add(r),Vn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new an("testCharacter_4"),r=sn.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=Kt.instance.add(r),Vn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new an("testCharacter_5"),r=sn.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=Kt.instance.add(r),Vn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new an("testCharacter_6"),r=sn.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=Kt.instance.add(r),Vn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),St.play(at.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),St.play(at.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),St.play(at.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),St.play(at.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),St.play(at.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),St.play(at.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:qi.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:qi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:qi.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:qi.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:qi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:qi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:qi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:qi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:qi.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),St.play(at.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u9310\u5f62",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4\u30e2\u30f3\u30c9",typeName:"DIAMOND"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createRangeArea(e,o.typeName),St.play(at.dicePut)}})}),{name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return Sr.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=xn({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Il=(()=>{class t{constructor(e,i,r,o,s,a){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=o,this.coordinateService=s,this.tabletopService=a,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new Gn,this.ondragstart=new Gn,this.ondrag=new Gn,this.ondragend=new Gn,this.onend=new Gn,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){return Sr.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Ve.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new ls(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let o=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(o.x-=this.width/2,o.y-=this.height/2,this.posX===o.x&&this.posY===o.y&&this.posZ===o.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let a=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;a<this.ratio&&(this.ratio+=.1*(a-this.ratio)),this.posX=o.x,this.posY=o.y,this.posZ=o.z,Sr.instance.viewTable.gridHeight=this.posZ+.5}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&"none"!==getComputedStyle(o).pointerEvents&&this.collidableElements.push(o)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let o=i[r];o instanceof HTMLElement&&this.findNestedCollidableElements(o)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=e}setCollidableLayer(e){let i=e;for(let r in t.layerHash)i=-1<this.colideLayers.indexOf(r)?"character"==r?!this.input.isGrabbing||e&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||e:!e,t.layerHash[r].forEach(o=>{o===this||o.input.isGrabbing||o.setPointerEvents(i)})}register(){this.layerName in t.layerHash||(t.layerHash[this.layerName]=[]),t.layerHash[this.layerName].indexOf(this)<0&&t.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in t.layerHash))return;let e=t.layerHash[this.layerName].indexOf(this);-1<e&&t.layerHash[this.layerName].splice(e,1)}}return t.layerHash={},t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Ai),Ge(zg),Ge(vi),Ge(Tl),Ge(Qu))},t.\u0275dir=_n({type:t,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),t})(),Ic=(()=>{class t{constructor(e,i,r,o,s){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.tabletopService=s,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.polygonal=24,this.onstart=new Gn,this.ondragstart=new Gn,this.ondrag=new Gn,this.ondragend=new Gn,this.onend=new Gn,this._rotate=0,this.valueChange=new Gn,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Ve.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new ls(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(this.polygonal),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal(this.polygonal)}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ai),Ge(zg),Ge(vi),Ge(Tl),Ge(Qu))},t.\u0275dir=_n({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],polygonal:["rotable.polygonal","polygonal"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),t})();function yJ(t,n){if(1&t&&(Z(0,"div",8),vt(1,"div",9),zt(2,"safe"),ne()),2&t){const e=ge();pt("opacity",e.isFront?1:.8)("transform",e.isFront?"":"scale(0.9)"),ie("@flipOpen",void 0),V(1),pt("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),ie("@inverse",e.state)("innerHTML",jt(2,13,e.rubiedText,"html"),cr)}}function CJ(t,n){if(1&t&&(vt(0,"img",10),zt(1,"safe")),2&t){const e=ge();ie("@inverse",e.state)("src",jt(1,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),vn)}}const xJ=function(t,n){return{"background-color":t,transform:n}};function wJ(t,n){if(1&t&&(Z(0,"div",11)(1,"span",12)(2,"b"),$e(3),ne()()()),2&t){const e=ge();ie("ngStyle",fn(2,xJ,e.ownerColor,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),V(3),dt(e.ownerName)}}function EJ(t,n){1&t&&(vt(0,"img",13),zt(1,"safe")),2&t&&ie("src",jt(1,1,ge().frontImage.url,"resourceUrl"),vn)}function TJ(t,n){if(1&t&&(it(0),Z(1,"div",14)(2,"i",15),$e(3),ne()(),Z(4,"div",16)(5,"i",15),$e(6),ne()(),Z(7,"div",17)(8,"i",15),$e(9),ne()(),Z(10,"div",18)(11,"i",15),$e(12),ne()(),vt(13,"div",19),rt()),2&t){const e=ge();V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew")}}const SJ=function(t){return{"is-grab":t}};let IJ=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.imageService=h,this.pointerDeviceService=b,this.modalService=ee,this.chatMessageService=de,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get textShadowCss(){const e=tt.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return tt.rubyToHtml(tt.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof ii&&this.card.contains(i)||i instanceof Je&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Je.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Ve.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof ei||e.detail instanceof ai)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof ai)){if(this.isLocked)return;let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(!this.isLocked&&(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100)){if(console.log("onDoubleClick !!!!"),this.ownerIsOnline&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?mr.BACK:mr.FRONT,this.owner="",this.state===mr.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),St.play(at.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Ve.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,St.play(at.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,St.play(at.lock)}},qt,!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.ownerIsOnline?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),St.play(at.cardDraw)},default:!this.isLocked&&(!this.ownerIsOnline||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),St.play(at.cardDraw)},default:!this.card.isLocked&&(!this.ownerIsOnline||this.isHand)},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),St.play(at.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{St.play(at.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=Lt.peerContext.userId}},qt,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),St.play(at.cardPut)},disabled:this.isLocked},qt,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{tt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(co,{url:o,title:this.card.name,subTitle:r.name})},disabled:!tt.validUrl(o),error:tt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(o)&&!tt.sameOrigin(o)}})}:null,this.isVisible&&this.card.getUrls().length>0?qt:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),r.isLocked=!1,St.play(at.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),St.play(at.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),St.play(at.cardPick)}onMoved(){St.play(at.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4&&!r.isLocked);if(0==e.length)return;let i=ai.create("\u5c71\u672d");i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.location.name=this.card.location.name,i.rotate=this.rotate,i.zindex=this.card.zindex,e.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of e)i.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(ps,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(pr),Ge(Wn),Ge(Ai),Ge(Ki),Ge(Qu),Ge(Gu),Ge(vi),Ge(Yn),Ge(Vr))},t.\u0275cmp=mn({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&Ae("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:15,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none","is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","text is-3d","style","width: 100%; height: 100%",3,"opacity","transform",4,"ngIf"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],[1,"text","is-3d",2,"width","100%","height","100%"],[1,"is-3d",3,"innerHTML"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(3,yJ,3,16,"div",3),Te(4,CJ,2,5,"img",4),Te(5,wJ,4,5,"div",5),Te(6,EJ,2,4,"img",6),Te(7,TJ,14,4,"ng-container",7),ne()()()),2&e&&(pt("width",i.size*i.gridSize,"px"),ie("ngClass",wt(13,SJ,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),V(1),ie("@slidInOut",void 0),V(1),ie("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),V(1),ie("ngIf",i.isFront||i.isHand||i.isGMMode),V(1),ie("ngIf",i.imageFile),V(1),ie("ngIf",!i.isFront&&i.ownerIsOnline&&0<i.ownerName.length),V(1),ie("ngIf",!i.isFront&&(i.isHand||i.isGMMode)&&i.frontImage),V(1),ie("ngIf",!i.isIconHidden))},dependencies:[oi,Rn,hr,Il,Ic,_i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[Hn("inverse",[Fp("inverse",ht({transform:""})),en(":increment, :decrement",[Qt("200ms ease",Cn([ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),ht({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),ht({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Hn("flipOpen",[en(":enter",[Qt("200ms ease",Cn([ht({transform:"scale3d(0, 1.0, 1.0)",offset:0}),ht({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),ht({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Hn("slidInOut",[en("void => *",[Qt("200ms ease",Cn([ht({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),ht({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),t})();const MJ=["draggablePanel"],kJ=["cardImage"],DJ=["fullCardImage"],AJ=["textArea"];function PJ(t,n){1&t&&An(0)}function NJ(t,n){1&t&&An(0)}const YI=function(t){return{card:t}};function OJ(t,n){if(1&t&&(it(0),Te(1,NJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(13);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,YI,e.tabletopObject))}}function FJ(t,n){1&t&&An(0)}function RJ(t,n){if(1&t&&(it(0),Te(1,FJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(13);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,YI,e.tabletopObject))}}function LJ(t,n){1&t&&An(0)}const BJ=function(t){return{note:t}};function zJ(t,n){if(1&t&&(it(0),Te(1,LJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(15);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,BJ,e.tabletopObject))}}function jJ(t,n){1&t&&An(0)}const UJ=function(t){return{character:t}};function HJ(t,n){if(1&t&&(it(0),Te(1,jJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(17);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,UJ,e.tabletopObject))}}function VJ(t,n){1&t&&An(0)}const GJ=function(t){return{dice:t}};function qJ(t,n){if(1&t&&(it(0),Te(1,VJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(19);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,GJ,e.tabletopObject))}}function WJ(t,n){1&t&&An(0)}const KJ=function(t){return{range:t}};function YJ(t,n){if(1&t&&(it(0),Te(1,WJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(21);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,KJ,e.tabletopObject))}}function ZJ(t,n){1&t&&An(0)}const XJ=function(t){return{object:t}};function QJ(t,n){if(1&t&&(it(0),Te(1,ZJ,1,0,"ng-container",14),rt()),2&t){const e=ge(),i=dn(23);V(1),ie("ngTemplateOutlet",i)("ngTemplateOutletContext",wt(2,XJ,e.tabletopObject))}}function JJ(t,n){1&t&&An(0)}function eee(t,n){if(1&t&&(it(0),Te(1,JJ,1,0,"ng-container",15),rt()),2&t){ge();const e=dn(27);V(1),ie("ngTemplateOutlet",e)}}const ZI=function(t){return{transform:t}};function tee(t,n){if(1&t&&(Z(0,"div",28),vt(1,"div",29),zt(2,"safe"),ne()),2&t){const e=ge(3);pt("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),ie("ngStyle",wt(17,ZI,"scale("+e.imageAreaRect.scale+")")),V(1),pt("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),ie("innerHTML",jt(2,14,e.cardText,"html"),cr)}}const XI=function(t){return{"with-button-marign":t}};function nee(t,n){if(1&t&&(Z(0,"div",30)(1,"div",31),$e(2),ne()()),2&t){const e=ge(2).card,i=ge();ie("ngClass",wt(4,XI,i.hasImage)),V(1),pt("background-color",e.ownerColor),V(1),dt(e.ownerName)}}function iee(t,n){if(1&t){const e=gt();Z(0,"div",21),Te(1,tee,3,19,"div",22),Z(2,"img",23,24),Ae("load",function(){return Fe(e),Re(ge(2).onCardImageLoad())}),zt(4,"safe"),ne(),Z(5,"button",25),Ae("click",function(){return Fe(e),Re(ge(2).chanageImageView(!0))}),Z(6,"i",26),$e(7,"zoom_in"),ne()(),Te(8,nee,3,6,"div",27),ne()}if(2&t){const e=ge().card,i=ge();V(1),ie("ngIf","card"==e.aliasName&&i.cardState!==i.CardStateBack&&(i.cardState==i.CardStateFront||e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),V(1),ie("src",jt(4,3,i.imageUrl,"resourceUrl"),vn),V(6),ie("ngIf",e.ownerIsOnline&&0<e.ownerName.length)}}function ree(t,n){if(1&t&&(it(0),$e(1),rt()),2&t){const e=ge().card;V(1),dt(e.name)}}function oee(t,n){1&t&&(it(0),$e(1," \u306e\u30c8\u30c3\u30d7"),rt())}function see(t,n){1&t&&(it(0),$e(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),rt())}function aee(t,n){1&t&&An(0)}const Ju=function(t,n){return{dataElm:t,name:n}};function lee(t,n){if(1&t&&(it(0),Te(1,aee,1,0,"ng-container",14),rt()),2&t){const e=n.$implicit,i=ge(2).card;ge();const r=dn(25);V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,Ju,e,i.name))}}function cee(t,n){if(1&t&&(Z(0,"div",32)(1,"div",33),Te(2,lee,2,5,"ng-container",34),ne()()),2&t){const e=ge(2);V(2),ie("ngForOf",e.dataElms)}}const Kr=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function uee(t,n){if(1&t&&(Z(0,"div",16),Te(1,iee,9,6,"div",17),Z(2,"div",18),Te(3,ree,2,1,"ng-container",5),Te(4,oee,2,0,"ng-container",5),Te(5,see,2,0,"ng-container",5),ne(),Z(6,"div",19),Te(7,cee,3,1,"div",20),ne()()),2&t){const e=n.card,i=ge();ie("ngClass",fn(7,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngIf",i.hasImage),V(1),ie("ngClass",wt(10,XI,i.hasImage)),V(1),ie("ngIf",i.cardState!==i.CardStateBack&&(i.cardState===i.CardStateFront||null==e.isVisible||e.isVisible||e.isGMMode)),V(1),ie("ngIf","card-stack"==e.aliasName&&!e.isEmpty),V(1),ie("ngIf",i.cardState!==i.CardStateFront&&(i.cardState===i.CardStateBack||null!=e.isVisible&&!e.isVisible&&!e.isGMMode)),V(2),ie("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}const dee=function(t){return{"hide-text-area":t}},fee=function(t){return{"hide-area":t}};function hee(t,n){if(1&t){const e=gt();Z(0,"div",35)(1,"div",36),$e(2),ne(),Z(3,"div",37)(4,"div",38),Ae("mousedown",function(){return Fe(e),Re(ge().textAreaActivate())}),Z(5,"div",39)(6,"textarea",40,41),Ae("ngModelChange",function(r){return Re(Fe(e).note.text=r)}),ne()(),vt(8,"div",42),zt(9,"safe"),vt(10,"div",43),zt(11,"safe"),ne()()()}if(2&t){const e=n.note,i=ge();ie("ngClass",fn(13,Kr,!i.isPointerDragging,i.isPointerDragging)),V(2),dt(e.title),V(4),ie("ngModel",e.text)("ngClass",wt(16,dee,!i.isSelected)),V(2),ie("innerHTML",jt(9,7,i.adjustedRubiedNote(e.text),"html"),cr)("ngClass",wt(18,fee,i.isSelected)),V(2),ie("innerHTML",jt(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),cr)}}const pee=function(t){return{transform:t}},QI=function(t,n){return{inverse:t,hollow:n}},JI=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},eM=function(t){return{"black-paint":t}};function gee(t,n){if(1&t&&(it(0),Z(1,"div",51)(2,"div",52)(3,"span",53),vt(4,"img",54),zt(5,"safe"),ne()()(),rt()),2&t){const e=ge(3);V(1),ie("ngStyle",wt(8,pee,"rotate("+e.roll+"deg)")),V(1),ie("ngClass",fn(10,QI,e.isInverse,e.isHollow)),V(1),ie("ngClass",Ms(13,JI,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),V(1),ie("ngClass",wt(22,eM,e.isBlackPaint))("src",jt(5,5,e.imageUrl,"resourceUrl"),vn)}}function mee(t,n){if(1&t&&(it(0),vt(1,"img",55),zt(2,"safe"),rt()),2&t){const e=ge(3);V(1),ie("src",jt(2,1,e.imageUrl,"resourceUrl"),vn)}}const _ee=function(t,n,e){return{"has-icon":t,"is-pointer-events-auto":n,"pointer-events-none":e}};function $ee(t,n){if(1&t&&(Z(0,"div",50),Te(1,gee,6,24,"ng-container",5),Te(2,mee,3,4,"ng-container",5),ne()),2&t){const e=ge(2);ie("ngClass",_o(3,_ee,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),V(1),ie("ngIf",!e.isUseIcon),V(1),ie("ngIf",e.isUseIcon)}}function vee(t,n){1&t&&An(0)}function bee(t,n){if(1&t&&(it(0),Z(1,"div",33),Te(2,vee,1,0,"ng-container",14),ne(),rt()),2&t){const e=ge().$implicit,i=ge(2).character;ge();const r=dn(25);V(2),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,Ju,e,i.name))}}function yee(t,n){if(1&t&&(it(0),Te(1,bee,3,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=ge(3);V(1),ie("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Cee(t,n){if(1&t&&(Z(0,"div",32),Te(1,yee,2,1,"ng-container",34),ne()),2&t){const e=ge(2);V(1),ie("ngForOf",e.inventoryDataElms)}}function xee(t,n){if(1&t&&(Z(0,"div",44),vt(1,"div",45),Te(2,$ee,3,7,"div",46),Z(3,"div",47),$e(4),ne(),vt(5,"div",48),Z(6,"div",49),Te(7,Cee,2,1,"div",20),ne()()),2&t){const e=n.character,i=ge();V(1),ie("ngClass",fn(6,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngIf",i.hasImage),V(1),ie("ngClass",fn(9,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),dt(e.name),V(2),ie("ngClass",fn(12,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngIf",i.hasDataElms)}}function wee(t,n){if(1&t&&(it(0),$e(1),rt()),2&t){const e=ge().dice;V(1),Zn("",e.name,":")}}function Eee(t,n){if(1&t&&(it(0),$e(1),rt()),2&t){const e=ge().dice;V(1),dt(e.face)}}function Tee(t,n){1&t&&(it(0),$e(1,"???"),rt())}function See(t,n){if(1&t&&(Z(0,"div",57)(1,"div",31),$e(2),ne()()),2&t){const e=ge().dice,i=ge();ie("ngClass",fn(4,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),pt("background-color",e.ownerColor),V(1),Zn("",e.ownerName," ")}}const Iee=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function Mee(t,n){if(1&t&&(Z(0,"div",50),vt(1,"img",58),zt(2,"safe"),ne()),2&t){const e=ge().dice,i=ge();ie("ngClass",fn(6,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngClass",fn(9,Iee,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",jt(2,3,i.imageUrl,"resourceUrl"),vn)}}function kee(t,n){1&t&&An(0)}function Dee(t,n){if(1&t&&(it(0),Te(1,kee,1,0,"ng-container",14),rt()),2&t){const e=ge().$implicit,i=ge(2).dice;ge();const r=dn(25);V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,Ju,e,i.name))}}function Aee(t,n){if(1&t&&(it(0),Te(1,Dee,2,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=ge(3);V(1),ie("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Pee(t,n){if(1&t&&(Z(0,"div",32)(1,"div",33),Te(2,Aee,2,1,"ng-container",34),ne()()),2&t){const e=ge(2);V(2),ie("ngForOf",e.dataElms)}}function Nee(t,n){if(1&t&&(Z(0,"div",44),vt(1,"div",45),Z(2,"div",47),Te(3,wee,2,1,"ng-container",5),Te(4,Eee,2,1,"ng-container",5),Te(5,Tee,2,0,"ng-container",5),ne(),Te(6,See,3,7,"div",56),Te(7,Mee,3,12,"div",46),vt(8,"div",48),Z(9,"div",49),Te(10,Pee,3,1,"div",20),ne()()),2&t){const e=n.dice,i=ge();V(1),ie("ngClass",fn(9,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngClass",fn(12,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngIf",0<(null==e||null==e.name?null:e.name.length)),V(1),ie("ngIf",e.isVisible),V(1),ie("ngIf",!e.isVisible),V(1),ie("ngIf",e.hasOwner&&0<e.ownerName.length),V(1),ie("ngIf",i.hasImage),V(2),ie("ngClass",fn(15,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngIf",i.hasDataElms&&e.isVisible)}}function Oee(t,n){if(1&t){const e=gt();it(0),Z(1,"div",60),$e(2),ne(),Z(3,"div",61)(4,"div",62)(5,"div",63),$e(6),ne(),Z(7,"input",64),Ae("ngModelChange",function(r){return Fe(e),Re(ge().$implicit.value=r)}),ne()()(),Z(8,"div",65)(9,"input",66),Ae("ngModelChange",function(r){return Fe(e),Re(ge().$implicit.value=r)}),zt(10,"safe"),ne()(),rt()}if(2&t){const e=ge().$implicit;V(1),rn("title",e.name),V(1),dt(e.name),V(4),dt(e.value),V(1),ie("ngModel",e.value),V(2),Mr(jt(10,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),Mt("title",e.value),ie("min","length"==e.name?1:0)("ngModel",e.value)}}function Fee(t,n){if(1&t){const e=gt();it(0),Z(1,"div",60),$e(2),ne(),Z(3,"div",61)(4,"div",62)(5,"div",63),$e(6),ne(),Z(7,"input",67),Ae("ngModelChange",function(r){return Fe(e),Re(ge().$implicit.currentValue=r)}),ne(),Z(8,"b",68),$e(9,"%"),ne()()(),Z(10,"div",65)(11,"input",69),Ae("ngModelChange",function(r){return Fe(e),Re(ge().$implicit.currentValue=r)}),zt(12,"safe"),ne()(),rt()}if(2&t){const e=ge().$implicit;V(1),rn("title",e.name),V(1),dt(e.name),V(4),dt(e.currentValue),V(1),ie("ngModel",e.currentValue),V(4),Mr(jt(12,8,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),ur("title","",e.currentValue,"%"),ie("ngModel",e.currentValue)}}function Ree(t,n){if(1&t&&(it(0),Te(1,Oee,11,12,"ng-container",5),Te(2,Fee,13,11,"ng-container",5),rt()),2&t){const e=n.$implicit;V(1),ie("ngIf","length"==e.name||"width"==e.name),V(1),ie("ngIf","opacity"==e.name)}}function Lee(t,n){if(1&t&&(it(0),Z(1,"div",70),$e(2),ne(),Z(3,"div",71)(4,"div",72)(5,"span",73),vt(6,"img",74),zt(7,"safe"),ne()()(),rt()),2&t){const e=ge(2).range;V(2),Zn("\u27a1 ",e.followingCharactor.name,""),V(2),ie("ngClass",fn(8,QI,e.followingCharactor.isInverse,e.followingCharactor.isHollow)),V(1),ie("ngClass",Ms(11,JI,0==e.followingCharactor.aura,1==e.followingCharactor.aura,2==e.followingCharactor.aura,3==e.followingCharactor.aura,4==e.followingCharactor.aura,5==e.followingCharactor.aura,6==e.followingCharactor.aura,7==e.followingCharactor.aura)),V(1),ie("ngClass",wt(20,eM,e.followingCharactor.isBlackPaint))("src",jt(7,5,e.followingCharactor.imageFile.url,"resourceUrl"),vn)}}function Bee(t,n){1&t&&vt(0,"div",75)}function zee(t,n){1&t&&An(0)}function jee(t,n){if(1&t&&(it(0),Te(1,zee,1,0,"ng-container",14),rt()),2&t){const e=ge().$implicit,i=ge(2).range;ge();const r=dn(25);V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,Ju,e,i.name))}}function Uee(t,n){if(1&t&&(it(0),Te(1,jee,2,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=ge(3);V(1),ie("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Hee(t,n){if(1&t&&(Z(0,"div",32)(1,"div",33),Te(2,Ree,3,2,"ng-container",34),Te(3,Lee,8,22,"ng-container",5),Te(4,Bee,1,0,"div",59),Te(5,Uee,2,1,"ng-container",34),ne()()),2&t){const e=ge().range,i=ge();V(2),ie("ngForOf",i.rangeElms),V(1),ie("ngIf",e.followingCharactor),V(1),ie("ngIf",i.dataElms.length>0),V(1),ie("ngForOf",i.dataElms)}}function Vee(t,n){if(1&t&&(Z(0,"div",44),vt(1,"div",45),Z(2,"div",47),$e(3),ne(),vt(4,"div",48),Z(5,"div",49),Te(6,Hee,6,4,"div",20),ne()()),2&t){const e=n.range,i=ge();V(1),ie("ngClass",fn(5,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngClass",fn(8,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),dt(e.name),V(2),ie("ngClass",fn(11,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngIf",i.rangeElms.length>0)}}function Gee(t,n){1&t&&An(0)}function qee(t,n){if(1&t&&(it(0),Te(1,Gee,1,0,"ng-container",14),rt()),2&t){const e=ge().$implicit,i=ge().object;ge();const r=dn(25);V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,Ju,e,i.name))}}function Wee(t,n){if(1&t&&(it(0),Te(1,qee,2,5,"ng-container",5),rt()),2&t){const e=n.$implicit,i=ge(2);V(1),ie("ngIf",e&&!i.newLineStrings.includes(e.name))}}function Kee(t,n){if(1&t&&(Z(0,"div",44),vt(1,"div",45),Z(2,"div",47),$e(3),ne(),vt(4,"div",48),Z(5,"div",49)(6,"div",32)(7,"div",33),Te(8,Wee,2,1,"ng-container",34),ne()()()()),2&t){const e=n.object,i=ge();V(1),ie("ngClass",fn(5,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),ie("ngClass",fn(8,Kr,!i.isPointerDragging,i.isPointerDragging)),V(1),dt(e.name),V(2),ie("ngClass",fn(11,Kr,!i.isPointerDragging,i.isPointerDragging)),V(3),ie("ngForOf",i.dataElms)}}function Yee(t,n){1&t&&An(0)}function Zee(t,n){if(1&t&&(Z(0,"div",82),$e(1),ne()),2&t){const e=ge(2).dataElm;rn("title",e.name),V(1),dt(e.name)}}function Xee(t,n){1&t&&An(0)}function Qee(t,n){if(1&t&&(it(0),Te(1,Xee,1,0,"ng-container",14),rt()),2&t){const e=n.$implicit,i=ge(2).name;ge();const r=dn(25);V(1),ie("ngTemplateOutlet",r)("ngTemplateOutletContext",fn(2,Ju,e,i))}}function Jee(t,n){if(1&t&&(Z(0,"div",79),Te(1,Zee,2,2,"div",80),Z(2,"div",81),Te(3,Qee,2,5,"ng-container",34),ne()()),2&t){const e=ge().dataElm;V(1),ie("ngIf",0<e.name.trim().length),V(2),ie("ngForOf",e.children)}}function ete(t,n){if(1&t){const e=gt();it(0),Z(1,"div",84)(2,"div"),$e(3),ne(),Z(4,"div",85)(5,"div",39)(6,"textarea",86),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)}),ne()(),Z(7,"div",87),$e(8),ne()()(),rt()}if(2&t){const e=ge(2).dataElm;V(2),rn("title",e.name),V(1),dt(e.name),V(3),ie("ngModel",e.value),V(2),dt(e.value)}}function tte(t,n){if(1&t){const e=gt();it(0),Z(1,"div",70),$e(2),ne(),Z(3,"div",61)(4,"div",88),$e(5),ne(),Z(6,"input",89),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)}),ne()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,o=ge();V(1),rn("title",i.name),V(1),dt(i.name),V(3),dt(i.value),V(1),Mt("type",i.value&&i.value==+i.value?"number":"text"),ie("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.value)}}function nte(t,n){if(1&t){const e=gt();it(0),Z(1,"div",60),$e(2),ne(),Z(3,"div",61)(4,"div",62)(5,"div",63),$e(6),ne(),Z(7,"input",90),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.currentValue=r)}),ne()(),Z(8,"div",91),$e(9),ne()(),Z(10,"div",65)(11,"input",92),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.currentValue=r)}),zt(12,"safe"),ne()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,o=ge();V(1),rn("title",i.name),V(1),dt(i.name),V(4),dt(i.currentValue),V(1),ie("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.currentValue),V(2),Zn(" / ",+i.value?i.value:"???",""),V(2),Mr(jt(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),Mt("title",i.currentValue),Mt("max",+i.value?i.value:1e3),ie("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.currentValue)}}function ite(t,n){if(1&t){const e=gt();it(0),Z(1,"div",70)(2,"span"),$e(3),ne(),$e(4),ne(),Z(5,"div",61)(6,"input",93),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)})("change",function(){Fe(e);const r=ge(2).dataElm;return Re(r.value=r.value?r.name:"")}),ne()(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,o=ge();V(1),rn("title",i.name),V(1),pt("text-decoration",i.value?"none":"line-through"),V(1),dt(i.name),V(1),Zn(" ",o.checkValue(i),""),V(2),Mt("checked",i.value?"checked":""),ie("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.value)}}function rte(t,n){if(1&t&&(Z(0,"span",95),$e(1),ne()),2&t){const e=ge(3).dataElm;V(1),Zn("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function ote(t,n){if(1&t){const e=gt();it(0),Z(1,"div",70),$e(2),ne(),Z(3,"div",61)(4,"div",88),$e(5),ne(),Z(6,"input",89),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)}),ne(),Te(7,rte,2,1,"span",94),ne(),rt()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,o=ge();V(1),rn("title",i.name),V(1),dt(i.name),V(3),dt(i.value),V(1),Mt("type",i.value&&i.value==+i.value?"number":"text"),ie("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging)("ngModel",i.value),V(1),ie("ngIf",i.currentValue)}}function ste(t,n){1&t&&(Z(0,"span",99),$e(1,"\u26a0\ufe0f"),ne())}const ate=function(t,n){return{"outer-link":t,invalid:n}};function lte(t,n){if(1&t){const e=gt();it(0),Z(1,"div",70),Te(2,ste,2,0,"span",96),Z(3,"a",97),Ae("click",function(){Fe(e);const r=ge(2),o=r.dataElm,s=r.name,a=ge();return Re(a.return(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name)))}),zt(4,"safe"),Z(5,"span",98),$e(6),ne()()(),rt()}if(2&t){const e=ge(2).dataElm,i=ge();V(2),ie("ngIf",!i.stringUtil.validUrl(e.value)),V(1),ie("ngClass",fn(9,ate,!i.stringUtil.sameOrigin(e.value)&&i.stringUtil.validUrl(e.value),!i.stringUtil.validUrl(e.value))),rn("title",e.value)("href",jt(4,6,i.stringUtil.validUrl(e.value)?e.value:"","url"),vn)("disabled",i.stringUtil.validUrl(e.value)?null:""),V(3),dt(e.name)}}function cte(t,n){if(1&t&&(Z(0,"div",70),$e(1),ne()),2&t){const e=ge(3).dataElm;rn("title",e.name),V(1),dt(e.name)}}function ute(t,n){if(1&t&&(Z(0,"div",88),$e(1),ne()),2&t){const e=ge(3).dataElm;V(1),dt(e.value)}}const dte=function(t){return{"min-width":t}};function fte(t,n){if(1&t){const e=gt();it(0),Te(1,cte,2,2,"div",100),Z(2,"div",61),Te(3,ute,2,1,"div",101),Z(4,"input",102),Ae("ngModelChange",function(r){return Fe(e),Re(ge(2).dataElm.value=r)}),ne()(),rt()}if(2&t){const e=ge(2).dataElm;V(1),ie("ngIf",e.name),V(2),ie("ngIf",e.name),V(1),Mt("type","size"===e.name||"altitude"===e.name?"number":"text"),Mt("min","size"===e.name?"0":""),ie("ngStyle",wt(6,dte,e.name?"8em":"100%"))("ngModel",e.value)}}function hte(t,n){1&t&&(it(0,2),Te(1,ete,9,4,"ng-container",3),Te(2,tte,7,8,"ng-container",3),Te(3,nte,13,19,"ng-container",3),Te(4,ite,7,10,"ng-container",3),Te(5,ote,8,9,"ng-container",3),Te(6,lte,7,12,"ng-container",3),Te(7,fte,5,8,"ng-container",4),rt(),vt(8,"div",83)),2&t&&(ie("ngSwitch",ge().dataElm.type),V(1),ie("ngSwitchCase","note"),V(1),ie("ngSwitchCase","simpleNumber"),V(1),ie("ngSwitchCase","numberResource"),V(1),ie("ngSwitchCase","checkProperty"),V(1),ie("ngSwitchCase","abilityScore"),V(1),ie("ngSwitchCase","url"))}function pte(t,n){if(1&t&&(Te(0,Yee,1,0,"ng-container",76),Te(1,Jee,4,2,"ng-template",null,77,Qn),Te(3,hte,9,7,"ng-template",null,78,Qn)),2&t){const e=n.dataElm,i=dn(2),r=dn(4);ie("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function gte(t,n){if(1&t&&(Z(0,"div",108),vt(1,"div",29),zt(2,"safe"),ne()),2&t){const e=ge(2);pt("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),ie("ngStyle",wt(19,ZI,"scale("+e.fullImageAreaRect.scale+")")),V(1),pt("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),ie("innerHTML",jt(2,16,e.cardText,"html"),cr)}}function mte(t,n){if(1&t){const e=gt();Z(0,"div",103),Ae("click",function(){return Fe(e),Re(ge().chanageImageView(!1))}),Te(1,gte,3,21,"div",104),Z(2,"div",105)(3,"i",26),$e(4,"close"),ne()(),vt(5,"img",106,107),zt(7,"safe"),ne()}if(2&t){const e=ge();ie("@fadeInOut","in"),V(1),ie("ngIf","card"==e.tabletopObject.aliasName&&e.cardState!==e.CardStateBack&&(e.cardState==e.CardStateFront||e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),V(4),ie("src",jt(7,3,e.imageUrl,"resourceUrl"),vn)}}let _te=(()=>{class t{constructor(e,i,r,o){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=o,this.tabletopObject=null,this.left=0,this.top=0,this.cardState=null,this.CardStateFront=mr.FRONT,this.CardStateBack=mr.BACK,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=tt,this._imageFile=sn.Empty,this.isOpenImageView=!1}get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof an&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=Kt.instance.get(i.value);this._imageFile=r||sn.Empty}}catch(i){console.log(i)}return this._imageFile.url}if(this.tabletopObject instanceof ei){if(null!==this.cardState){if(this.cardState===this.CardStateFront)return this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"";if(this.cardState===this.CardStateBack)return this.tabletopObject.backImage?this.tabletopObject.backImage.url:""}if(this.tabletopObject.isGMMode)return this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:""}return this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof an&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof an){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof an){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof an&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof an&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof an&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof an&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineStrings(){return this.inventoryService.newLineStrings}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}checkValue(e){if(!e||null==e.currentValue)return"";let i=e.currentValue.toString().split(/[|\uff5c]/,2);if(i.length<=1)return null==e.value||""==e.value?"":e.currentValue.toString();let r=null==e.value||""==e.value?i[1]:i[0];return this.tabletopObject instanceof an&&this.tabletopObject.chatPalette&&(r=this.tabletopObject.chatPalette.evaluate(r,this.tabletopObject.rootDataElement)),r}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof ii)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Ve.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){tt.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(co,{url:e,title:i,subTitle:r})}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let h=null;return this.tabletopObject instanceof ai?h=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(h=this.tabletopObject),h&&(o.scale=o.width/(h.size*this.gridSize),o.width=h.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof ai?e=this.tabletopObject.topCard:this.tabletopObject instanceof ei&&(e=this.tabletopObject),e?tt.rubyToHtml(tt.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=tt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get rangeElms(){let e=[];return!this.tabletopObject||!(this.tabletopObject instanceof yi)||!this.tabletopObject.commonDataElement||(this.tabletopObject.commonDataElement.getFirstElementByName("length")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("length")),("CORN"===this.tabletopObject.type||"LINE"===this.tabletopObject.type)&&this.tabletopObject.commonDataElement.getFirstElementByName("width")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("width")),this.tabletopObject.commonDataElement.getFirstElementByName("opacity")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("opacity"))),e}get isNoLogging(){return this.tabletopObject instanceof ei?!this.tabletopObject.isFront:this.tabletopObject instanceof Ir&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=tt.escapeHtml(e);return i&&(r=tt.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ev),Ge(Ki),Ge(vi),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&(Tn(MJ,7),Tn(kJ,5),Tn(DJ,5),Tn(AJ,5)),2&e){let r;En(r=Sn())&&(i.draggablePanel=r.first),En(r=Sn())&&(i.cardImageElement=r.first),En(r=Sn())&&(i.fullCardImageElement=r.first),En(r=Sn())&&(i.textAreaElementRef=r.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top",cardState:"cardState"},decls:28,vars:10,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["overviewTabletop",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"src","load"],["cardImage",""],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModel","ngClass","ngModelChange"],["textArea",""],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],["class","section border","style","padding-top: 2px",4,"ngIf"],[1,"tag",2,"min-width","100px"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","step","0.1","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"section",2,"line-height","1em"],["type","range","max","12","step","0.5",3,"title","min","ngModel","ngModelChange"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],["type","range","min","0","max","100",3,"title","ngModel","ngModelChange"],[1,"tag"],[1,"value",2,"margin-top","3px","pointer-events","none"],[1,"inverser",2,"min-width","32px","min-height","32px","max-width","32px","max-height","32px","margin-left","auto","margin-right","0px",3,"ngClass"],[1,"aura-following",3,"ngClass"],["draggable","false",1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"section","border",2,"padding-top","2px"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],[2,"display","inline"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","title","max","ngModel","ngModelChange"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","font-size: smaller",4,"ngIf"],[2,"font-size","smaller"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059",4,"ngIf"],["draggable","false","target","_blank",3,"ngClass","click"],[1,"url-link"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],["fullCardImage",""],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(e,i){1&e&&(Z(0,"div",0,1),it(2,2),Te(3,PJ,1,0,"ng-container",3),Te(4,OJ,2,4,"ng-container",3),Te(5,RJ,2,4,"ng-container",3),Te(6,zJ,2,4,"ng-container",3),Te(7,HJ,2,4,"ng-container",3),Te(8,qJ,2,4,"ng-container",3),Te(9,YJ,2,4,"ng-container",3),Te(10,QJ,2,4,"ng-container",4),rt(),ne(),Te(11,eee,2,1,"ng-container",5),Te(12,uee,8,12,"ng-template",null,6,Qn),Te(14,hee,12,20,"ng-template",null,7,Qn),Te(16,xee,8,15,"ng-template",null,8,Qn),Te(18,Nee,11,18,"ng-template",null,9,Qn),Te(20,Vee,7,14,"ng-template",null,10,Qn),Te(22,Kee,9,14,"ng-template",null,11,Qn),Te(24,pte,5,3,"ng-template",null,12,Qn),Te(26,mte,8,6,"ng-template",null,13,Qn)),2&e&&(ie("@fadeInOut","in"),V(2),ie("ngSwitch",i.tabletopObject.aliasName),V(1),ie("ngSwitchCase","numberResource"),V(1),ie("ngSwitchCase","card"),V(1),ie("ngSwitchCase","card-stack"),V(1),ie("ngSwitchCase","text-note"),V(1),ie("ngSwitchCase","character"),V(1),ie("ngSwitchCase","dice-symbol"),V(1),ie("ngSwitchCase","range"),V(2),ie("ngIf",i.isOpenImageView))},dependencies:[oi,$i,Rn,tl,hr,Jl,Qd,Jd,Ii,Ro,Lo,Fo,Mi,Ci,gv,fs,_i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-moz-min-content;width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:150px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom center;object-position:bottom center}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.aura-following.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura-following.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #33f)}.aura-following.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura-following.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura-following.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura-following.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura-following.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura-following.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}.url-link[_ngcontent-%COMP%]{cursor:inherit}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],data:{animation:[Hn("fadeInOut",[en("void => *",[Qt("100ms ease-out",Cn([ht({opacity:0,offset:0}),ht({opacity:1,offset:1})]))]),en("* => void",[Qt("100ms ease-in",Cn([ht({opacity:1,offset:0}),ht({opacity:0,offset:1})]))])])]},changeDetection:0}),t})(),tM=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=pr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(_te,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.tooltipComponentRef.instance.cardState=this.cardState,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Ve.register(this).on("DELETE_GAME_OBJECT",i=>{this.tabletopObject&&this.tabletopObject.identifier===i.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Ve.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(io),Ge(vi))},t.\u0275dir=_n({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"],cardState:"cardState"}}),t})();const $te=["cardImage"];function vte(t,n){1&t&&An(0)}function bte(t,n){if(1&t&&(it(0),Te(1,vte,1,0,"ng-container",8),rt()),2&t){ge();const e=dn(11);V(1),ie("ngTemplateOutlet",e)}}function yte(t,n){1&t&&An(0)}function Cte(t,n){if(1&t&&(it(0),Te(1,yte,1,0,"ng-container",8),rt()),2&t){ge();const e=dn(11);V(1),ie("ngTemplateOutlet",e)}}const nM=function(t){return{reverse:t}};function xte(t,n){if(1&t&&(Z(0,"div",9),vt(1,"img",10),zt(2,"safe"),Z(3,"i",11),$e(4,"Back"),ne()()),2&t){const e=ge();V(1),ie("src",jt(2,2,null==e.card||null==e.card.backImage?null:e.card.backImage.url,"resourceUrl"),vn)("ngClass",wt(5,nM,e.card&&180==e.card.rotate))}}const wte=function(t){return{transform:t}};let Ete=(()=>{class t{constructor(){this.card=null,this.CardStateFront=mr.FRONT,this.CardStateBack=mr.BACK,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?tt.rubyToHtml(tt.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;return this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2),this.card&&(o.scale=o.width/(this.card.size*this.gridSize),o.width=this.card.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}get textShadowCss(){const e=tt.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=mn({type:t,selectors:[["card-list-image"]],viewQuery:function(e,i){if(1&e&&Tn($te,7),2&e){let r;En(r=Sn())&&(i.cardImageElement=r.first)}},inputs:{card:"card"},decls:12,vars:32,consts:[[1,"image-box",2,"position","relative",3,"appTooltip","cardState"],[4,"ngIf"],[1,"image","contain","front",2,"position","relative",3,"ngClass"],[2,"position","absolute",3,"src","load"],["cardImage",""],[1,"text",2,"z-index","5","position","absolute",3,"ngStyle"],[3,"innerHTML"],["backFace",""],[4,"ngTemplateOutlet"],[1,"image","contain","back",2,"position","relative"],[2,"position","absolute",3,"src","ngClass"],[1,"indicate-text"]],template:function(e,i){1&e&&(Z(0,"div",0),Te(1,bte,2,1,"ng-container",1),Z(2,"div",2)(3,"img",3,4),Ae("load",function(){return i.onCardImageLoad()}),zt(5,"safe"),ne(),Z(6,"div",5),vt(7,"div",6),zt(8,"safe"),ne()(),Te(9,Cte,2,1,"ng-container",1),ne(),Te(10,xte,5,7,"ng-template",null,7,Qn)),2&e&&(ie("appTooltip",i.card)("cardState",i.CardStateFront),V(1),ie("ngIf",!(null!=i.card&&i.card.isFront)),V(1),ie("ngClass",wt(28,nM,i.card&&180==i.card.rotate)),V(1),ie("src",jt(5,22,null==i.card||null==i.card.frontImage?null:i.card.frontImage.url,"resourceUrl"),vn),V(3),pt("width",i.imageAreaRect.width,"px")("height",i.imageAreaRect.height,"px")("left",i.imageAreaRect.left,"px")("top",i.imageAreaRect.top,"px"),ie("ngStyle",wt(30,wte,"scale("+i.imageAreaRect.scale+")")),V(1),pt("font-size",i.cardFontSize,"px")("color",i.cardColor)("text-shadow",i.textShadowCss),ie("innerHTML",jt(8,25,i.rubiedText,"html"),cr),V(2),ie("ngIf",null==i.card?null:i.card.isFront))},dependencies:[oi,Rn,tl,hr,tM,_i],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;-o-object-fit:contain;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.back[_ngcontent-%COMP%]{background-color:#555}.indicate-text[_ngcontent-%COMP%]{font-size:xx-small;display:inline-block;position:absolute;opacity:80%;bottom:1px;left:1px;color:#000;text-shadow:#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px}.indicate-text[_ngcontent-%COMP%]:first-letter{font-weight:700;color:#fff;text-shadow:#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px}.reverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"]}),t})();function Tte(t,n){if(1&t){const e=gt();Z(0,"div",2),vt(1,"card-list-image",3),Z(2,"div",4)(3,"button",5),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().drawCard(o))}),$e(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),ne(),Z(5,"button",0),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().showDetail(o))}),Z(6,"i",6),$e(7,"settings"),ne(),$e(8," \u7de8\u96c6"),ne(),vt(9,"br"),Z(10,"button",0),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().up(o))}),$e(11,"\u2191"),ne(),Z(12,"button",0),Ae("click",function(){const o=Fe(e).$implicit;return Re(ge().down(o))}),$e(13,"\u2193"),ne(),Z(14,"button",7),Ae("click",function(){const o=Fe(e).$implicit;return Re(o.rotate=180==o.rotate?0:180)}),$e(15,"\u56de\u8ee2\u3059\u308b"),ne(),Z(16,"button",0),Ae("click",function(){const o=Fe(e).$implicit,s=ge();return Re(o.state=o.state==s.CardStateFront?s.CardStateBack:s.CardStateFront)}),$e(17,"\u88cf\u8fd4\u3059"),ne(),vt(18,"br"),ne()()}if(2&t){const e=n.$implicit;V(1),ie("card",e)}}let Ste=(()=>{class t{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=Lt.peerContext.userId,this.CardStateFront=mr.FRONT,this.CardStateBack=mr.BACK}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof ii&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Ve.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),St.play(at.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Ve.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),St.play(at.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(Ge(Wn),Ge(Ki),Ge(Vr))},t.\u0275cmp=mn({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block","margin-left","2px"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"],[2,"margin-left","5px",3,"click"]],template:function(e,i){1&e&&(Z(0,"div")(1,"button",0),Ae("click",function(){return i.close(!0)}),$e(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),ne(),vt(3,"hr"),Te(4,Tte,19,1,"div",1),ne()),2&e&&(V(4),ie("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},dependencies:[$i,Ete],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}button[_ngcontent-%COMP%]{font-size:smaller;height:2.2em;padding:0 8px;min-width:2.2em;margin:1px;vertical-align:baseline}"],changeDetection:0}),t})();const Gv=function(t){return{transform:t}};function Ite(t,n){if(1&t&&(Z(0,"div",9),vt(1,"div",10),zt(2,"safe"),ne()),2&t){const e=ge(2);ie("ngStyle",wt(11,Gv,"rotateZ("+e.topCard.rotate+"deg)")),V(1),pt("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color)("text-shadow",e.textShadowCss(e.topCard.color)),ie("innerHTML",jt(2,8,e.rubiedText,"html"),cr)}}function Mte(t,n){if(1&t){const e=gt();Z(0,"div",6),Ae("@shuffle.start",function(r){return Fe(e),Re(ge().animationShuffleStarted(r))})("@shuffle.done",function(r){return Fe(e),Re(ge().animationShuffleDone(r))}),Te(1,Ite,3,13,"div",7),vt(2,"img",8),zt(3,"safe"),ne()}if(2&t){const e=ge();ie("@bounceInOut",void 0)("@shuffle",e.animeState),V(1),ie("ngIf",e.topCard.isFront),V(1),ie("ngStyle",wt(8,Gv,"rotateZ("+e.topCard.rotate+"deg)"))("src",jt(3,5,e.imageFile.url,"resourceUrl"),vn)}}function kte(t,n){if(1&t&&(it(0),Z(1,"div",11)(2,"i",12),$e(3),ne()(),Z(4,"div",13)(5,"i",12),$e(6),ne()(),Z(7,"div",14)(8,"i",12),$e(9),ne()(),Z(10,"div",15)(11,"i",12),$e(12),ne()(),rt()),2&t){const e=ge();V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew")}}const iM=function(t){return{"is-inverse":t}};function Dte(t,n){if(1&t&&(Z(0,"div",16)(1,"span",17),$e(2),ne()()),2&t){const e=ge();ie("ngStyle",wt(3,Gv,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),V(1),ie("ngClass",wt(5,iM,e.isInverse)),V(1),Zn("",e.cards.length,"\u679a")}}const Ate=function(t,n){return{"background-color":t,transform:n}};function Pte(t,n){if(1&t&&(Z(0,"div",18)(1,"span",17)(2,"b"),$e(3),ne(),$e(4," \u304c\u78ba\u8a8d\u4e2d"),ne()()),2&t){const e=ge();ie("ngStyle",fn(3,Ate,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),V(1),ie("ngClass",wt(6,iM,e.isInverse)),V(2),dt(e.ownerName)}}const Nte=function(t){return{"is-empty":t}},Ote=function(t){return{"is-grab":t}};let Fte=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.imageService=a,this.pointerDeviceService=h,this.modalService=b,this.chatMessageService=ee,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerIsOnline(){return this.cardStack.ownerIsOnline}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return tt.rubyToHtml(tt.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnInit(){Ve.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof ii&&this.cardStack.contains(i)||i instanceof Je&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Je.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Ve.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof ei||e.detail instanceof ai))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof ei){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof ai){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){console.log("onDoubleClick !!!!");const i=this.drawCard();if(i){let r;St.play(at.cardDraw),r=i.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Ve.trigger("DRAG_LOCKED_OBJECT",{}),Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,St.play(at.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,St.play(at.lock)}},qt,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const r=this.drawCard();if(r){let o;St.play(at.cardDraw),o=r.isFront?`${this.cardStack.name} \u304b\u3089 ${""==r.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":r.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(o)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(r=>({name:`${r}\u679a`,action:()=>{const o=[];for(let s=0;s<r;s++){const a=this.drawCard();a&&(o.push(a),(0==s||3==s||9==s)&&St.play(at.cardDraw))}if(o.length>0){const s=o.filter(a=>a.isFront);if(0==s.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${o.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const a=new Map;for(const b of s){let ee=a.get(b.name)||0;ee+=1,a.set(""==b.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":b.name,ee)}let h=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...a.keys()].map(b=>`${b} \u3092 ${a.get(b)}\u679a`).join("\u3001")}`;h+=s.length===o.length?"\u5f15\u3044\u305f":`\u5f15\u304d\u3001${o.length-s.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(h)}}}})),disabled:0==this.cards.length},qt,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),St.play(at.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{!this.cardStack.topCard||(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),St.play(at.cardDraw))},disabled:0==this.cards.length},qt,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),St.play(at.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),St.play(at.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),St.play(at.cardDraw)},disabled:0==this.cards.length},qt,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),St.play(at.cardShuffle),Ve.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b...",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},qt,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},qt,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(Lt.peerIds.length),St.play(at.cardDraw)}},qt,...[2,3,4,5,6].map(r=>({name:`${r}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(r),St.play(at.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),St.play(at.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),St.play(at.cardDraw),St.play(at.cardDraw),Ve.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},qt,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{tt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(co,{url:o,title:this.cardStack.name,subTitle:r.name})},disabled:!tt.validUrl(o),error:tt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(o)&&!tt.sameOrigin(o)}})},this.cardStack.getUrls().length<=0?null:qt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.isLocked=!1,r.toTopmost(),St.play(at.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),St.play(at.sweep)}}],this.name)}onMove(){St.play(at.cardPick)}onMoved(){St.play(at.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}textShadowCss(e){const i=tt.textShadowColor(e);return`${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px`}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let h=ai.create(`${this.cardStack.name}_${("0"+(a+1).toString()).slice(-2)}`);h.location.x=this.cardStack.location.x+50-100*Math.random(),h.location.y=this.cardStack.location.y+50-100*Math.random(),h.posZ=this.cardStack.posZ,h.location.name=this.cardStack.location.name,h.rotate=this.rotate,h.toTopmost(),i.push(h)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=ai.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}showDetail(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=Lt.peerContext.userId,this.panelService.open(Ste,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(pr),Ge(Wn),Ge(Ai),Ge(Ki),Ge(Gu),Ge(vi),Ge(Yn),Ge(Vr))},t.\u0275cmp=mn({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Ae("carddrop",function(o){return i.onCardDrop(o)})("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(2,Mte,4,10,"div",2),Te(3,kte,13,4,"ng-container",3),Te(4,Dte,3,7,"div",4),Te(5,Pte,5,8,"div",5),ne()()),2&e&&(pt("width",i.size*i.gridSize,"px"),ie("ngClass",wt(12,Nte,i.isEmpty))("movable.option",i.movableOption)("movable.disable",i.isLocked),V(1),ie("ngClass",wt(14,Ote,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),V(1),ie("ngIf",i.topCard&&i.imageFile),V(1),ie("ngIf",!i.isIconHidden),V(1),ie("ngIf",i.isShowTotal),V(1),ie("ngIf",i.ownerIsOnline))},dependencies:[oi,Rn,hr,Il,Ic,_i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Hn("shuffle",[Fp("active",ht({transform:""})),en("* => active",[Qt("800ms ease",Cn([ht({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),ht({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),en("* => inverse",[Qt("200ms ease",Cn([ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),ht({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),ht({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Hn("bounceInOut",[en("void => *",[Qt("600ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const Rte=["characterImage"],Lte=["chatBubble"],Bte=function(t){return{opacity:t}};function zte(t,n){if(1&t&&(vt(0,"img",31),zt(1,"safe")),2&t){const e=ge();pt("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),ie("src",jt(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),vn)("ngStyle",wt(10,Bte,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}const jte=function(t,n){return{"background-color":t,transform:n}};function Ute(t,n){if(1&t&&(Z(0,"div",32)(1,"div",33)(2,"b"),$e(3),ne()(),Z(4,"div",34)(5,"b"),$e(6),ne()()()),2&t){const e=ge();ie("ngStyle",fn(3,jte,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),V(3),dt(e.ownerName),V(3),dt(e.ownerName)}}const Hte=function(t){return{"is-hide-in-tag":t}},Yf=function(t){return{transform:t}};function Vte(t,n){if(1&t&&(Z(0,"div",35)(1,"div",36),$e(2),ne(),Z(3,"div",37),$e(4),ne()()),2&t){const e=ge();ie("ngClass",wt(4,Hte,e.isHideIn))("ngStyle",wt(6,Yf,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),V(2),dt(e.name),V(2),dt(e.name)}}const Gte=function(t){return{"is-hide-in":t}};function qte(t,n){if(1&t){const e=gt();Z(0,"img",38,39),Ae("load",function(){return Fe(e),Re(ge().onImageLoad())}),zt(2,"safe"),ne()}if(2&t){const e=ge();pt("height",e.characterImageHeight,"px"),ie("src",jt(2,4,e.imageFile.url,"resourceUrl"),vn)("ngClass",wt(7,Gte,e.isHideIn))}}function Wte(t,n){if(1&t&&(Z(0,"span",46),vt(1,"img",47),zt(2,"safe"),ne()),2&t){const e=ge(2);V(1),pt("border-color",e.dialogColor),ie("src",jt(2,3,e.dialogFaceIcon.url,"resourceUrl"),vn)}}function Kte(t,n){if(1&t&&(Z(0,"span",46),vt(1,"img",47),zt(2,"safe"),ne()),2&t){const e=ge(2);V(1),pt("border-color",e.dialogColor),ie("src",jt(2,3,e.dialogFaceIcon.url,"resourceUrl"),vn)}}const rM=function(t,n,e){return{emote:t,rubied:n,"is-whisper":e}};function Yte(t,n){if(1&t&&(Z(0,"div",40)(1,"div",41)(2,"p",42),Te(3,Wte,3,6,"span",43),vt(4,"span",44),zt(5,"safe"),ne(),Z(6,"p",45),Te(7,Kte,3,6,"span",43),vt(8,"span",44),zt(9,"safe"),ne()()()),2&t){const e=ge();pt("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),ie("@fadeAndScaleInOut",e.isEmote),V(2),pt("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),ie("ngClass",_o(23,rM,e.isEmote,e.isRubied,e.isWhisper)),V(1),ie("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),V(1),ie("innerHTML",jt(5,17,e.dialogText,"html"),cr),V(2),pt("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),ie("ngClass",_o(27,rM,e.isEmote,e.isRubied,e.isWhisper)),V(1),ie("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),V(1),ie("innerHTML",jt(9,20,e.dialogText,"html"),cr)}}const oM=function(t){return{transform:t}};function Zte(t,n){if(1&t&&(Z(0,"div",48)(1,"div",41)(2,"span",49)(3,"i"),$e(4),ne()(),Z(5,"span",50)(6,"i"),$e(7),ne()()(),Z(8,"div",41)(9,"span",51),$e(10),ne(),Z(11,"span",52),$e(12),ne()(),Z(13,"div",53)(14,"span",49)(15,"i"),$e(16),ne()(),Z(17,"span",50)(18,"i"),$e(19),ne()()()()),2&t){const e=ge();pt("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),ie("ngStyle",wt(14,oM,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),V(1),pt("visibility",e.altitude>0?"visible":"hidden"),V(3),dt(e.elevation),V(3),dt(e.elevation),V(3),dt(e.math.abs(e.altitude)),V(2),dt(e.math.abs(e.altitude)),V(1),pt("visibility",e.altitude<0?"visible":"hidden"),ie("ngStyle",wt(16,oM,"translateY("+(e.chatBubbleAltitude+4)+"px)")),V(3),dt(e.elevation),V(3),dt(e.elevation)}}const Xte=function(t,n,e){return{selected:t,"not-inventory":n,"is-hide-in-pedestal":e}},sM=function(t,n,e,i,r,o,s,a){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}},Qte=function(t){return{fall:t}},Jte=function(t,n,e){return{inverse:t,"black-paint":n,hollow:e}},ene=function(t,n,e){return{bottom:t,transform:n,visibility:e}};let tne=(()=>{class t{constructor(e,i,r,o,s,a){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=o,this.ngZone=s,this.modalService=a,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=tt,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return this.adjustMinBounds(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!Je.myCursor&&Je.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?Kt.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=tt.cr(e.text);const r=tt.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,h=0,b=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let je=a.index-3*h;o.push({base:a[1],ruby:a[2],start:je-b,end:je+a[1].length-b-1}),h++,b+=a[2].length}let ee=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;ee>200&&(ee=200),this.dialogTimeOutId=setTimeout(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*ee+6e3),this._dialog=e,this.gameCharacter.isEmote=r,h=0;let de=0,_e=0,Ce="",Se=o.shift(),Pe="",Ne=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const je=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let He=je[h],Ue=He.length>1;if(He){if(!Ne&&Se&&de>=Se.start&&(Ce+="<ruby>",Ne=!0,_e=0),Ce+=tt.escapeHtml(He),Ne){_e+=1;let We=Se.ruby;Pe="<rt>"+tt.escapeHtml(Array.from(We).slice(0,Math.ceil(Array.from(We).length*(_e/Array.from(Se.base).length))).join(""))+"</rt>"}Ne&&Se&&de>=Se.end-(Ue?1:0)&&(Ce+=Pe+"</ruby>",Ne=!1,Se=o.shift()),de+=He.length}h+=1,this.gameCharacter.text=Ce+(Ne?Pe+"</ruby>":""),this.changeDetector.markForCheck(),h>=je.length&&clearInterval(this.chatIntervalId)},ee)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this._dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(""!=this.name?24:0))*e+4,o=this.characterImageWidth/2*i+4+this.characterImageWidth/2;let s=r>o?r:o;return this.gameCharacter.chatBubbleAltitude=s,s}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:Je.CHAT_DEFAULT_COLOR}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof ii&&this.gameCharacter.contains(i))&&(this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),Ve.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",St.play(at.piecePut)):(!an.isStealthMode&&!Je.myCursor.isGMMode&&this.modalService.open(gr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:Bi.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=Lt.peerContext.userId,St.play(at.sweep),Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),Ve.call("UPDATE_INVENTORY",!0)}},qt,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((r,o)=>({name:this.gameCharacter.currntImageIndex==o?"\u25c9":"\u25cb",action:()=>{this.changeImage(o)},default:this.gameCharacter.currntImageIndex==o,icon:r}))},this.gameCharacter.imageFiles.length<=1?null:qt,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,Ve.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,Ve.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,Ve.trigger("UPDATE_INVENTORY",null)}},qt].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,o)=>({name:`${this.aura==o?"\u25c9":"\u25cb"} ${r}`,colorSample:!0,action:()=>{this.aura=o,Ve.trigger("UPDATE_INVENTORY",null)}})))},qt,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,Ve.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},qt,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,Ve.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,Ve.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||St.play(at.sweep))},altitudeHande:this.gameCharacter},qt,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.gameCharacter)}},qt,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{tt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(co,{url:o,title:this.gameCharacter.name,subTitle:r.name})},disabled:!tt.validUrl(o),error:tt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(o)&&!tt.sameOrigin(o)}}),disabled:this.gameCharacter.getUrls().length<=0},qt,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,Ve.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,Ve.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),St.play(at.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(Lt.peerId),St.play(at.piecePut)}},{name:"\u5893\u5834",action:()=>{Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),St.play(at.sweep)}}]},qt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),St.play(at.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const r=this.gameCharacter.clone(),o=r.name.split("_");let s;s=o.length>1&&/\d+/.test(o[o.length-1])?o.slice(0,o.length-1).join("_"):o.join("_");let a=0;for(const h of Et.instance.getObjects(an)){if(!h.name.startsWith(s))continue;let b=h.name.match(/_(\d+)$/)?+RegExp.$1:0;b>a&&(a=b)}r.name=s+"_"+(a+1),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),St.play(at.piecePut)}},qt,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),St.play(at.sweep)}}],this.name)}onMove(){this.isHideIn||St.play(at.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&Ve.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||St.play(at.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Hu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Bf,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||St.play(at.surprise),Ve.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),Ve.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(Ge(pr),Ge(Wn),Ge(Ki),Ge(vi),Ge(Fn),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&(Tn(Rte,5),Tn(Lte,5)),2&e){let r;En(r=Sn())&&(i.characterImage=r.first),En(r=Sn())&&(i.chatBubble=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:85,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d  chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"src","ngClass","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),vt(3,"div",3)(4,"div",4),Z(5,"div",5)(6,"div",6)(7,"div",7),$e(8,"autorenew"),ne(),Z(9,"div",8),$e(10,"autorenew"),ne()()(),Z(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12),Te(15,zte,2,12,"img",13),ne()()()(),Z(16,"div",14),Ae("dblclick",function(){return i.nextImage()}),Z(17,"div",15),Ae("rotable.valueChange",function(o){return i.roll=o})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Z(18,"div",16),Te(19,Ute,7,6,"div",17),Te(20,Vte,5,8,"div",18),Z(21,"div",19)(22,"div",20)(23,"span",21),Te(24,qte,3,9,"img",22),ne()()(),Z(25,"div",23)(26,"div",24)(27,"i",25),$e(28,"autorenew"),ne()(),Z(29,"div",26)(30,"i",25),$e(31,"autorenew"),ne()()()()(),Z(32,"div",27,28),Te(34,Yte,10,31,"div",29),ne()()(),Te(35,Zte,20,18,"div",30),ne()()),2&e&&(pt("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),ie("movable.option",i.movableOption),V(1),ie("@bounceInOut","in"),V(1),ie("rotable.option",i.rotableOption),V(1),ie("@switchImagePedestal",i.gameCharacter.currntImageIndex)("ngClass",_o(45,Xte,i.selected,!i.gameCharacter.isInventoryIndicate,i.isHideIn)),V(1),ie("@switchImagePedestal",i.gameCharacter.currntImageIndex),V(7),pt("transform","translateX("+(i.size*i.gridSize-i.characterShadowImageWidth)/2+"px) translateY("+i.characterShadowOffset+"px) scale(1.0, 0.66)"),V(1),pt("width",i.characterShadowImageWidth,"px")("height",i.characterShadowImageHeight,"px")("transform","rotateZ("+i.roll+"deg)"),V(1),ie("ngClass",Ms(49,sM,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),V(1),ie("ngStyle",wt(58,Yf,"scaleX("+(i.isInverse?"-1":"1")+")")),V(1),ie("ngIf",i.isDropShadow&&(0<i.imageFile.url.length||0<i.shadowImageFile.url.length)),V(1),ie("ngClass",wt(60,Qte,0==i.altitude))("ngStyle",wt(62,Yf,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),V(1),pt("transform-origin","center "+.333*-i.characterImageHeight+"px"),ie("rotable.value",i.roll),V(1),pt("transform","translateZ("+-i.size*i.gridSize/2+"px)"),V(1),ie("ngIf",i.isGMMode&&i.isHideIn&&0<i.ownerName.length),V(1),ie("ngIf",0<i.name.length),V(1),ie("@switchImage",i.gameCharacter.currntImageIndex)("ngClass",Ms(64,sM,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),V(1),ie("ngClass",_o(73,Jte,i.isInverse,i.isBlackPaint,i.isHollow)),V(1),pt("width",i.characterImageWidth,"px")("height",i.characterImageHeight,"px")("transform","translateX("+(i.size*i.gridSize-i.characterImageWidth)/2+"px)"),V(1),ie("ngIf",0<i.imageFile.url.length),V(2),ie("ngStyle",wt(77,Yf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) translateY("+(-i.characterImageHeight-(i.isGMMode&&i.isHideIn?20:0))+"px)")),V(3),ie("ngStyle",wt(79,Yf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")),V(3),ie("ngStyle",_o(81,ene,i.chatBubbleAltitude-(i.isEmote?i.gridSize/2:0)-4+"px","translateZ("+-i.size*i.gridSize/2+"px) translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+(i.rotate+i.viewRotateZ)+"deg) rotateX("+i.chatBubbleXDeg+"deg)",i.gameCharacter.isShowChatBubble?"visible":"hidden")),V(2),ie("ngIf",i.isListen),V(1),ie("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},dependencies:[oi,Rn,hr,Il,Ic,_i],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:rgba(85,85,85,.8);box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleZ(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;-webkit-backface-visibility:hidden;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[Hn("switchImage",[en(":increment, :decrement",[Qt("400ms ease",Cn([ht({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),ht({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),ht({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),Hn("switchImageShadow",[en(":increment, :decrement",[Qt("400ms ease",Cn([ht({transform:"scale3d(0.8, 0.8, 0.8)"}),ht({transform:"scale3d(0, 1.2, 1.2)"}),ht({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Hn("switchImagePedestal",[en(":increment, :decrement",[Qt("400ms ease",Cn([ht({transform:"scale3d(0, 0, 0)"}),ht({transform:"scale3d(1.2, 1.2, 1.2)"}),ht({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Hn("bounceInOut",[en("void => *",[Qt("600ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale3d(0, 0, 0)"}))])]),Hn("fadeAndScaleInOut",[en("void => *, true => false",[Qt("200ms ease-in-out",Cn([ht({transform:"scale3d(0, 0, 0)",opacity:0}),ht({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),en("* => void, true => false",[Qt("100ms ease-in-out",ht({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),t})();function nne(t,n){if(1&t&&(vt(0,"img",9),zt(1,"safe")),2&t){const e=ge();pt("mix-blend-mode",1==e.blendType?null:"hard-light"),ie("src",jt(1,3,e.imageFile.url,"resourceUrl"),vn)}}const ine=function(t){return{transform:t}};function rne(t,n){if(1&t&&(Z(0,"div",10)(1,"div",11)(2,"span",12),$e(3),ne(),Z(4,"span",13),$e(5),ne()()()),2&t){const e=ge();pt("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),ie("ngStyle",wt(5,ine,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),V(3),dt(e.math.abs(e.gameTableMaskAltitude)),V(2),dt(e.gameTableMaskAltitude)}}const one=function(t){return{"is-grab":t}},qv=function(t){return{fall:t}},Wv=function(t){return{transform:t}},sne=function(t){return{"is-inverse":t}},ane=function(t,n){return{image:t,border:n}};let lne=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=h,this.modalService=b,this.coordinateService=ee,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get textShadowCss(){const e=tt.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return tt.rubyToHtml(tt.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.gameTableMask||!i||(this.gameTableMask===i||i instanceof ii&&this.gameTableMask.contains(i))&&this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Ve.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1,St.play(at.lock)}}:{name:"\u2610 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0,St.play(at.unlock)}}:null,this.isGMMode?qt:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,St.play(at.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,St.play(at.lock)}},{name:"\u753b\u50cf\u3068\u8272",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,St.play(at.cardDraw)}},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,St.play(at.cardDraw)}},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,St.play(at.cardDraw)}},qt,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",St.play(at.cardDraw)}}]},qt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,St.play(at.sweep))},altitudeHande:this.gameTableMask},qt,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(o=>{const s=o.value.toString();return{name:o.name?o.name:s,action:()=>{tt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(co,{url:s,title:this.gameTableMask.name,subTitle:o.name})},disabled:!tt.validUrl(s),error:tt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(s)&&!tt.sameOrigin(s)}})},this.gameTableMask.getUrls().length<=0?null:qt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",o),o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(o),St.play(at.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),St.play(at.sweep)}},qt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){St.play(at.cardPick)}onMoved(){St.play(at.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Ug),Ge(pr),Ge(Ai),Ge(Wn),Ge(Ki),Ge(vi),Ge(Yn),Ge(Tl))},t.\u0275cmp=mn({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:10,vars:52,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"is-fit-full","border",2,"backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto","position","relative",3,"ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick border","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10",3,"ngClass","ngStyle"],[1,"material-icons","is-3d",2,"pointer-events","none","backface-visibility","hidden"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick","border",2,"pointer-events","none","position","absolute",3,"src"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1),vt(2,"div",2),ne(),Z(3,"div",3)(4,"div",4),Te(5,nne,2,6,"img",5),ne()(),Z(6,"div",6)(7,"i",7),$e(8),ne()(),Te(9,rne,6,7,"div",8),ne()),2&e&&(pt("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),ie("ngClass",wt(33,one,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),V(1),pt("width",i.width*i.gridSize-4,"px")("height",i.height*i.gridSize-4,"px"),ie("ngClass",wt(35,qv,0==i.altitude))("ngStyle",wt(37,Wv,"translateZ("+i.altitude*i.gridSize+"px)")),V(1),pt("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),ie("ngClass",wt(39,sne,i.isInverse))("innerHtml",i.rubiedText,cr),V(1),ie("ngClass",wt(41,qv,0==i.altitude))("ngStyle",wt(43,Wv,"translateZ("+i.altitude*i.gridSize+"px)")),V(1),pt("opacity",i.opacity*(i.isGMMode&&i.gameTableMask.isTransparentOnGMMode?.6:1))("background-color",i.imageFile.url.length<1||i.blendType>0?i.bgcolor:null),ie("ngClass",fn(45,ane,i.imageFile.url.length>=1,i.imageFile.url.length<=0)),V(1),ie("ngIf",i.imageFile.url.length>=1),V(1),ie("ngClass",wt(48,qv,0==i.altitude))("ngStyle",wt(50,Wv,"translateZ("+i.altitude*i.gridSize+"px)")),V(2),dt(i.isLock?"lock":"open_with"),V(1),ie("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},dependencies:[oi,Rn,hr,Il,_i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{outline:2px solid #CCC!important;outline-offset:-2px}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),t})();const aM=function(t){return{"blinking-animation":t}};function cne(t,n){if(1&t&&(Z(0,"div",6),zt(1,"safe"),ne()),2&t){const e=ge(2);pt("background-image",jt(1,3,"url("+e.floorImage.url+")","style")),ie("ngClass",wt(6,aM,!e.isLocked))}}function une(t,n){if(1&t&&(it(0),Te(1,cne,2,8,"div",5),rt()),2&t){const e=ge();V(1),ie("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const dne=function(t,n,e){return{"backface-visibility":t,transform:n,filter:e}};function fne(t,n){if(1&t&&(it(0),Z(1,"div",7),zt(2,"safe"),ne(),rt()),2&t){const e=ge();V(1),pt("background-image",jt(2,4,"url("+e.floorImage.url+")","style")),ie("ngClass",wt(7,aM,!e.isLocked))("ngStyle",_o(9,dne,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const Hg=function(t,n,e,i){return{"blinking-animation":t,"no-shadow":n,"is-slope":e,"is-inverse-slope":i}};function hne(t,n){if(1&t&&(Z(0,"div",9),zt(1,"safe"),ne()),2&t){const e=ge(3);pt("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Is(10,Hg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function pne(t,n){if(1&t&&(it(0),Te(1,hne,2,15,"div",8),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isVisibleWallTopBottom)}}function gne(t,n){if(1&t&&(Z(0,"div",11),zt(1,"safe"),ne()),2&t){const e=ge(3);pt("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Is(10,Hg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function mne(t,n){if(1&t&&(it(0),Te(1,gne,2,15,"div",10),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isVisibleWallTopBottom)}}function _ne(t,n){if(1&t&&(Z(0,"div",13),zt(1,"safe"),ne()),2&t){const e=ge(3);pt("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Is(10,Hg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function $ne(t,n){if(1&t&&(it(0),Te(1,_ne,2,15,"div",12),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isVisibleWallLeftRight)}}function vne(t,n){if(1&t&&(Z(0,"div",15),zt(1,"safe"),ne()),2&t){const e=ge(3);pt("background-image",jt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),ie("ngClass",Is(10,Hg,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function bne(t,n){if(1&t&&(it(0),Te(1,vne,2,15,"div",14),rt()),2&t){const e=ge(2);V(1),ie("ngIf",e.isVisibleWallLeftRight)}}function yne(t,n){if(1&t&&(it(0),Te(1,pne,2,1,"ng-container",2),Te(2,mne,2,1,"ng-container",2),Te(3,$ne,2,1,"ng-container",2),Te(4,bne,2,1,"ng-container",2),rt()),2&t){const e=ge();V(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),V(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),V(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),V(1),ie("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function Cne(t,n){if(1&t&&(it(0),Z(1,"div",16),vt(2,"div",17),Z(3,"div",18)(4,"i",19),$e(5,"autorenew"),ne()(),Z(6,"div",20)(7,"i",19),$e(8,"autorenew"),ne()(),Z(9,"div",21)(10,"i",19),$e(11,"autorenew"),ne()(),Z(12,"div",22)(13,"i",19),$e(14,"autorenew"),ne()()(),rt()),2&t){const e=ge();V(1),pt("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}const lM=function(t){return{transform:t}};function xne(t,n){if(1&t&&(Z(0,"div",23)(1,"div",24),$e(2),ne(),Z(3,"div",25),$e(4),ne()()),2&t){const e=ge();pt("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),ie("ngStyle",wt(5,lM,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),V(2),dt(e.math.abs(e.terreinAltitude)),V(2),dt(e.math.abs(e.terreinAltitude))}}const wne=function(t){return{"is-grab":t}},Ene=function(t,n){return{"upright-transform":t,fall:n}};let Tne=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=h,this.pointerDeviceService=b,this.modalService=ee,this.coordinateService=de,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=bi,this.input=null,this.viewRotateZ=10}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=bi.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===bi.NONE?bi.BOTTOM:this.terrain.slopeDirection:bi.NONE}set slopeDirection(e){this.terrain.isSlope=e!=bi.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.terrain||!i||(this.terrain===i||i instanceof ii&&this.terrain.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Ve.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,St.play(at.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,St.play(at.lock)}},qt,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==bi.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=bi.NONE}},qt,{name:(this.slopeDirection==bi.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=bi.TOP}},{name:(this.slopeDirection==bi.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=bi.BOTTOM}},{name:(this.slopeDirection==bi.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=bi.LEFT}},{name:(this.slopeDirection==bi.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=bi.RIGHT}}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=La.ALL,this.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=La.ALL,this.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=La.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}]},qt,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,St.play(at.sweep))},altitudeHande:this.terrain},qt,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(o=>{const s=o.value.toString();return{name:o.name?o.name:s,action:()=>{tt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(co,{url:s,title:this.terrain.name,subTitle:o.name})},disabled:!tt.validUrl(s),error:tt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(s)&&!tt.sameOrigin(s)}})},this.terrain.getUrls().length<=0?null:qt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.terrain.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(o),St.play(at.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),St.play(at.sweep)}},qt,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){St.play(at.blockPick)}onMoved(){St.play(at.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case bi.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case bi.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case bi.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case bi.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case bi.TOP:e=.4;break;case bi.BOTTOM:e=1;break;case bi.LEFT:e=.6;break;case bi.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Gu),Ge(Ug),Ge(pr),Ge(Ai),Ge(Wn),Ge(Ki),Ge(vi),Ge(Yn),Ge(Tl))},t.\u0275cmp=mn({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(2,une,2,1,"ng-container",2),Z(3,"div",3),Te(4,fne,3,13,"ng-container",2),Te(5,yne,5,4,"ng-container",2),ne(),Te(6,Cne,15,4,"ng-container",2),ne(),Te(7,xne,5,7,"div",4),ne()),2&e&&(pt("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),ie("movable.option",i.movableOption)("movable.disable",i.isLocked)("movable.interact",i.isInteract),V(1),ie("ngClass",wt(17,wne,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),V(1),ie("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),V(1),ie("ngClass",fn(19,Ene,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",wt(22,lM,"translateZ("+i.altitude*i.gridSize+"px)")),V(1),ie("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),V(1),ie("ngIf",i.isWallExist),V(1),ie("ngIf",!i.isLocked),V(1),ie("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},dependencies:[oi,Rn,hr,Il,Ic,_i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0%,0% 100%,100% 100%);clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(0% 0%,100% 100%,0% 100%);clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:blink 1s linear infinite alternate}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),t})();const Sne=["cursor"],Ine=["rotate"],Mne=["opacity"];function kne(t,n){if(1&t&&(Z(0,"div",7,8)(2,"div",9),zt(3,"safe"),Z(4,"div",10)(5,"span",11),$e(6),ne()()()()),2&t){const e=n.$implicit,i=ge(2);pt("background-image","radial-gradient(circle, transparent 17px, "+i.color+" 18px), radial-gradient(circle, transparent 16px, rgba(240, 218, 189) 17px)"),ie("ngClass",e),V(2),pt("background-image",jt(3,8,"url("+i.iconUrl+")","style")),V(2),pt("background-color",i.color),V(2),dt(i.name)}}const Dne=function(){return["is-front","is-back"]};function Ane(t,n){1&t&&(it(0),Z(1,"div",1,2)(3,"div",3,4)(5,"div",5),Te(6,kne,7,11,"div",6),ne()()(),rt()),2&t&&(V(6),ie("ngForOf",wa(1,Dne)))}class Yr{constructor(n,e,i,r){this.changeDetector=n,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Je.myCursor,this.cursorElement=null,this.opacityElements=[],this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}get rotateZ(){return Yr.viewRotateZ}get nameTagRotate(){let n=Yr.viewRotateX%360-90;return-(n>0?n:360+n)}get delayMs(){let n=16.6*Lt.peerIds.length;return n<100?100:n}ngOnInit(){this.isMine||Ve.register(this).on("CURSOR_MOVE",n=>{n.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(n.data[0],n.data[1],n.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,n=>{this.ngZone.run(()=>{Yr.viewRotateX=n.data.x,Yr.viewRotateZ=n.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElements=this.opacityElementRefs.map(n=>n.nativeElement),this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.rotateElement&&this.setRotate(),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Ve.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(n){let e=n.touches?n.changedTouches[0].pageX:n.pageX,i=n.touches?n.changedTouches[0].pageY:n.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=n.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(n,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:n,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),Ve.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElements.forEach(n=>{n.style.opacity="0.8"}),null==this.fadeOutTimer&&(this.fadeOutTimer=new Oa(()=>{this.opacityElements.forEach(n=>{n.style.opacity="0.0"})},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(n,e,i){this.cursorElement.style.transform=`translateX(${n.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}}Yr.viewRotateX=50,Yr.viewRotateZ=10,Yr.ctor=void Ve.register(Yr).on("TABLE_VIEW_ROTATE",-1e3,t=>{Yr.viewRotateX=t.data.x,Yr.viewRotateZ=t.data.z}),Yr.\u0275fac=function(n){return new(n||Yr)(Ge(Ki),Ge(zg),Ge(Tl),Ge(Fn))},Yr.\u0275cmp=mn({type:Yr,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(n,e){if(1&n&&(Tn(Sne,5),Tn(Ine,5),Tn(Mne,5)),2&n){let i;En(i=Sn())&&(e.cursorElementRef=i.first),En(i=Sn())&&(e.rotateElementRef=i.first),En(i=Sn())&&(e.opacityElementRefs=i)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d"],["rotate",""],[1,"upright-transform","is-3d"],["class","peer-cursor is-3d is-opacity-transition",3,"ngClass","background-image",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d","is-opacity-transition",3,"ngClass"],["opacity",""],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(n,e){1&n&&Te(0,Ane,7,2,"ng-container",0),2&n&&ie("ngIf",!e.isMine)},dependencies:[oi,$i,Rn,_i],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear}.is-opacity-transition[_ngcontent-%COMP%]{transition:opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:transparent;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]});const Pne=["textArea"];function Nne(t,n){if(1&t&&(Z(0,"div",20),$e(1),ne()),2&t){const e=ge();V(1),dt(e.title)}}function One(t,n){if(1&t&&(Z(0,"div",20),$e(1),ne()),2&t){const e=ge();V(1),dt(e.title)}}const Fne=function(t){return{"is-grab":t}},Kv=function(t){return{transform:t}};function Rne(t,n){if(1&t&&vt(0,"div",21),2&t){const e=ge();pt("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),ie("ngClass",wt(6,Fne,!e.isLocked))("ngStyle",wt(8,Kv,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function Lne(t,n){1&t&&(Z(0,"div")(1,"div",15)(2,"i",16),$e(3,"autorenew"),ne()(),Z(4,"div",17)(5,"i",16),$e(6,"autorenew"),ne()()())}const Bne=function(t){return{transform:t}};function zne(t,n){if(1&t&&(Z(0,"div",22)(1,"div",23)(2,"span",24),$e(3),ne(),Z(4,"span",25),$e(5),ne()()()),2&t){const e=ge();pt("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),ie("ngStyle",wt(5,Bne,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),V(3),dt(e.math.abs(e.textNoteAltitude)),V(2),dt(e.textNoteAltitude)}}const jne=function(t,n){return{"is-transition":t,fall:n}},cM=function(t){return{"is-bg-filter":t}},Une=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"hide-area":e}},Hne=function(t){return{"hide-area":t}};let Vne=(()=>{class t{constructor(e,i,r,o,s,a,h){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.modalService=h,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=b=>this.onMouseUp(b),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get color(){return this.textNote.color}set color(e){this.textNote.color=e}get textShadowCss(){const e=tt.textShadowColor(this.color,"#f2f2f2","#000000");return`${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px`}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isWhiteOut(){return this.textNote.isWhiteOut}set isWhiteOut(e){this.textNote.isWhiteOut=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get rubiedText(){return tt.rubyToHtml(tt.escapeHtml(this.text))}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof ii&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),Ve.unregister(this)}onInputStart(e){this.input.cancel(),this.textNote.isLocked&&Ve.trigger("DRAG_LOCKED_OBJECT",{})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Ve.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,St.play(at.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,St.play(at.lock)}},qt,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!0}},this.isWhiteOut?{name:"\u2611 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!1}}:{name:"\u2610 \u753b\u50cf\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!0}},qt,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.isUpright?this.fall=!0:this.transition=!0,this.altitude=0,St.play(at.sweep))},altitudeHande:this.textNote},qt,{name:"\u30e1\u30e2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{tt.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(co,{url:o,title:this.textNote.title,subTitle:r.name})},disabled:!tt.validUrl(o),error:tt.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(o)&&!tt.sameOrigin(o)}})},this.textNote.getUrls().length<=0?null:qt,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();r.isLocked=!1,console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),St.play(at.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),St.play(at.sweep)}}],this.title)}onMove(){St.play(at.cardPick)}onMoved(){St.play(at.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(ps,{title:r,left:i.x-350,top:i.y-200,width:560,height:470}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(pr),Ge(Ai),Ge(Wn),Ge(Ki),Ge(vi),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&Tn(Pne,7),2&e){let r;En(r=Sn())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("mousedown",function(o){return i.onMouseDown(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:28,vars:77,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"ngClass","innerHTML"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModel","ngModelChange"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Z(2,"div",2)(3,"div",3)(4,"div",4),zt(5,"safe"),Te(6,Nne,2,1,"div",5),Z(7,"textarea",6,7),Ae("input",function(){return i.calcFitHeight()})("ngModelChange",function(o){return i.text=o}),ne(),vt(9,"div",8),zt(10,"safe"),ne(),Z(11,"div",9),zt(12,"safe"),Z(13,"div",10),Te(14,One,2,1,"div",5),Z(15,"textarea",11),Ae("ngModelChange",function(o){return i.text=o}),ne(),vt(16,"div",12),zt(17,"safe"),ne()()(),Te(18,Rne,1,10,"div",13),Z(19,"div",14)(20,"div",15)(21,"i",16),$e(22),ne()(),Z(23,"div",17)(24,"i",16),$e(25),ne()()(),Te(26,Lne,7,0,"div",18),ne()(),Te(27,zne,6,7,"div",19),ne()),2&e&&(ie("movable.option",i.movableOption)("movable.disable",i.isSelected||i.isLocked),V(1),ie("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),V(1),pt("width",i.width*i.gridSize,"px"),V(1),ie("ngClass",fn(60,jne,i.transition,i.fall))("ngStyle",wt(63,Kv,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),V(1),pt("background-image",jt(5,48,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),ie("ngClass",wt(65,cM,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),V(2),ie("ngIf",i.title.length),V(1),pt("font-size",i.fontSize+9,"px"),ie("ngClass",_o(67,Une,!i.isSelected,i.isSelected,!i.isSelected))("ngModel",i.text),V(2),pt("font-size",i.fontSize+9,"px")("color",i.color)("text-shadow",i.textShadowCss),ie("ngClass",wt(71,Hne,i.isSelected))("innerHTML",jt(10,51,i.lastNewLineAdjust(i.rubiedText),"html"),cr),V(2),pt("background-image",jt(12,54,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),ie("ngClass",wt(73,cM,i.isWhiteOut&&(null==i.imageFile?null:i.imageFile.url.length)>0)),V(3),ie("ngIf",i.title.length),V(1),pt("font-size",i.fontSize+9,"px"),ie("ngModel",i.text),V(1),pt("font-size",i.fontSize+9,"px"),ie("innerHTML",jt(17,57,i.lastNewLineAdjust(i.rubiedText),"html"),cr),V(2),ie("ngIf",!i.isLocked),V(1),ie("ngStyle",wt(75,Kv,"translateZ("+i.altitude*i.gridSize+"px)")),V(3),dt(i.isLocked?"lock":"autorenew"),V(3),dt(i.isLocked?"lock":"autorenew"),V(1),ie("ngIf",!i.isLocked),V(1),ie("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},dependencies:[oi,Rn,hr,Ii,Mi,Ci,Il,Ic,_i],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-filter[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:rgba(255,255,255,.7);transition:background-color .2s}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;-webkit-backface-visibility:hidden;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}'],changeDetection:0}),t})();function Gne(t,n){1&t&&(it(0),Z(1,"div",20)(2,"div",21)(3,"div",22),$e(4,"autorenew"),ne(),Z(5,"div",23),$e(6,"autorenew"),ne()()(),rt())}function qne(t,n){1&t&&(Z(0,"i",24),$e(1,"lock"),ne())}function Wne(t,n){1&t&&(Z(0,"span"),$e(1,"\uff1a"),ne())}function Kne(t,n){if(1&t&&(Z(0,"span"),$e(1),ne()),2&t){const e=ge();V(1),dt(e.face)}}function Yne(t,n){1&t&&(Z(0,"span"),$e(1,"???"),ne())}function Zne(t,n){1&t&&(Z(0,"i",24),$e(1,"lock"),ne())}function Xne(t,n){1&t&&(Z(0,"span"),$e(1,"\uff1a"),ne())}function Qne(t,n){if(1&t&&(Z(0,"span"),$e(1),ne()),2&t){const e=ge();V(1),dt(e.face)}}function Jne(t,n){1&t&&(Z(0,"span"),$e(1,"???"),ne())}const eie=function(t,n){return{"background-color":t,transform:n}};function tie(t,n){if(1&t&&(Z(0,"div",25)(1,"div",26)(2,"b"),$e(3),ne()(),Z(4,"div",27)(5,"b"),$e(6),ne()()()),2&t){const e=ge();ie("ngStyle",fn(3,eie,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),V(3),dt(e.ownerName),V(3),dt(e.ownerName)}}const uM=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function nie(t,n){if(1&t&&(vt(0,"img",28),zt(1,"safe")),2&t){const e=ge();ie("src",jt(1,2,e.imageFile.url,"resourceUrl"),vn)("ngClass",fn(5,uM,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function iie(t,n){if(1&t&&(vt(0,"img",29),zt(1,"safe")),2&t){const e=ge();ie("src",jt(1,2,e.backFaceImageFile.url,"resourceUrl"),vn)("ngClass",fn(5,uM,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function rie(t,n){1&t&&(vt(0,"img",30),zt(1,"safe")),2&t&&ie("src",jt(1,1,ge().imageFile.url,"resourceUrl"),vn)}function oie(t,n){if(1&t&&(vt(0,"img",30),zt(1,"safe")),2&t){const e=ge();pt("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),ie("src",jt(1,3,e.backFaceImageFile.url,"resourceUrl"),vn)}}const sie=function(t){return{"is-gray-border":t}},aie=function(t){return{transform:t}};let lie=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.pointerDeviceService=a,this.imageService=h,this.modalService=b,this.chatMessageService=ee,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}ngOnInit(){Ve.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=Et.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof ii&&this.diceSymbol.contains(i)||i instanceof Je&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",St.play(at.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Je.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(r.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),r.push(qt),(this.isMine||this.hasOwner)&&r.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",St.play(at.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=Lt.peerContext.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),St.play(at.lock)}}),r.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,St.play(at.unlock)},disabled:this.hasOwner&&!this.isVisible}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,St.play(at.lock)},disabled:this.hasOwner&&!this.isVisible}),this.isVisible){let o=[],s=this.nothingFaces;s.length>0&&(s.forEach(a=>{o.push({name:`${this.face==a?"\u25c9":"\u25cb"} ${a}\u3000`,action:()=>{St.play(at.dicePut),this.face=a}})}),o.push(qt)),this.faces.forEach(a=>{o.push({name:`${this.face==a?"\u25c9":"\u25cb"} ${a}\u3000`,action:()=>{""===this.owner&&St.play(at.dicePut),""===this.owner&&this.face!=a&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${a}`),this.face=a}})}),r.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:o})}r.push(qt),r.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0}}),r.push(qt),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(r.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(o=>{const s=o.value.toString();return{name:o.name?o.name:s,action:()=>{tt.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(co,{url:s,title:this.diceSymbol.name,subTitle:o.name})},disabled:!tt.validUrl(s),error:tt.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(s)&&!tt.sameOrigin(s)}})}),r.push(qt)),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let o=this.diceSymbol.clone();o.location.x+=this.gridSize,o.location.y+=this.gridSize,o.update(),St.play(at.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),St.play(at.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){St.play(at.dicePick)}onMoved(){St.play(at.dicePut)}diceRoll(){Ve.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),St.play(this.isCoin?at.coinToss:at.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){Ve.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Wn),Ge(pr),Ge(Ai),Ge(Ki),Ge(vi),Ge(Gu),Ge(Yn),Ge(Vr))},t.\u0275cmp=mn({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:31,vars:48,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1)(2,"div",2),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),vt(3,"div",3)(4,"div",4),Te(5,Gne,7,0,"ng-container",5),Z(6,"div",1)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),Ae("@diceRollNameTag.done",function(o){return i.animationShuffleDone(o)}),Z(12,"div",11),Te(13,qne,2,0,"i",12),$e(14),Te(15,Wne,2,0,"span",5),Te(16,Kne,2,1,"span",5),Te(17,Yne,2,0,"span",5),ne(),Z(18,"div",13),Te(19,Zne,2,0,"i",12),$e(20),Te(21,Xne,2,0,"span",5),Te(22,Qne,2,1,"span",5),Te(23,Jne,2,0,"span",5),ne()()(),Te(24,tie,7,6,"div",14),Z(25,"div",1),Ae("@diceRoll.done",function(o){return i.animationShuffleDone(o)})("@coinFlip.done",function(o){return i.animationShuffleDone(o)}),Te(26,nie,2,8,"img",15),Te(27,iie,2,8,"img",16),ne()()()(),Z(28,"div",17),Ae("@diceRoll.done",function(o){return i.animationShuffleDone(o)}),Te(29,rie,2,4,"img",18),Te(30,oie,2,6,"img",19),ne()()()()()),2&e&&(pt("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),ie("movable.option",i.movableOption),V(1),ie("@bounceInOut","in"),V(1),ie("rotable.option",i.rotableOption),V(1),ie("ngClass",wt(44,sie,i.hasOwner)),V(2),ie("ngIf",!i.isIconHidden),V(3),pt("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),V(2),ie("ngStyle",wt(46,aie,"translateX("+i.size*i.gridSize/2+"px) rotateX("+i.nameTagRotate+"deg)")),V(1),ie("@changeFaceNameTag",i.isVisible?i.face:null)("@diceRollNameTag",i.animeState),V(2),ie("ngIf",i.isLock&&i.hasOwner),V(1),dt(i.name),V(1),ie("ngIf",0<i.name.length),V(1),ie("ngIf",i.isVisible),V(1),ie("ngIf",!i.isVisible),V(2),ie("ngIf",i.isLock&&i.hasOwner),V(1),dt(i.name),V(1),ie("ngIf",0<i.name.length),V(1),ie("ngIf",i.isVisible),V(1),ie("ngIf",!i.isVisible),V(1),ie("ngIf",i.hasOwner&&0<i.ownerName.length),V(1),pt("transform",i.isCoin?"rotateX(30deg)":""),ie("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u88cf"==i.face?0:1:null)("@diceRoll",!i.isCoin&&i.animeState)("@coinFlip",i.isCoin&&i.animeState),V(1),ie("ngIf",0<i.imageFile.url.length),V(1),ie("ngIf",0<i.backFaceImageFile.url.length),V(1),pt("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),ie("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u8868"==i.face?1:2:null)("@diceRoll",i.animeState),V(1),ie("ngIf",!i.isFlip&&i.isDropShadow&&0<i.imageFile.url.length),V(1),ie("ngIf",i.isFlip&&i.isDropShadow&&0<i.backFaceImageFile.url.length))},dependencies:[oi,Rn,hr,Il,Ic,_i],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[Hn("diceRoll",[en("* => active",[Qt("800ms ease",Cn([ht({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),ht({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),Hn("coinFlip",[en("* => active",[Qt("800ms ease-out",Cn([ht({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),ht({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),Hn("diceRollNameTag",[en("* => active",[Qt("800ms ease",Cn([ht({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),ht({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),ht({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),ht({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),ht({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),Hn("changeFace",[en(":increment,:decrement",[Qt("200ms ease",Cn([ht({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),ht({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),Hn("changeFaceCoin",[en(":increment,:decrement",[Qt("200ms ease",Cn([ht({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),ht({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),Hn("changeFaceNameTag",[en(":increment,:decrement",[Qt("200ms ease",Cn([ht({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),ht({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),Hn("bounceInOut",[en("void => *",[Qt("600ms ease",Cn([ht({transform:"scale3d(0, 0, 0)",offset:0}),ht({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),ht({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),ht({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),ht({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),en("* => void",[Qt(100,ht({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();class Zf{constructor(n,e,i){this.canvasElement=n,this.canvasElementRange=e,this.canvasElementCenter=i}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}chkOuterProduct(n,e,i,r,o,s){return(i-n)*(s-e)-(r-e)*(o-n)>=-.01}chkInCircle(n,e,i){return n*n>=e*e+i*i}renderCircle(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),b=0,ee=0,de=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.arc(i,r,n.range*e,0,2*Math.PI,!0),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let _e=0;_e<=n.areaHeight+1;_e++)for(let Ce=0;Ce<=n.areaWidth+1;Ce++){let{gx:Se,gy:Pe}=de(Ce,_e,e);if(1==n.fillType)b=Se+s+e/2-i,ee=Pe+a+e/2-r,this.chkInCircle(n.range*e,b,ee)&&this.fillSquare(h,Se+s,Pe+a,e);else{let Ne=0;for(let je=0;je<e;je++)for(let He=0;He<e;He++)b=Se+s+je-i+.5,ee=Pe+a+He-r+.5,this.chkInCircle(n.range*e,b,ee)&&Ne++;(2==n.fillType&&Ne>=1||3==n.fillType&&Ne>=e*e/2||4==n.fillType&&Ne>=e*e)&&this.fillSquare(h,Se+s,Pe+a,e)}}}this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.arc(i,r,n.range*e,0,2*Math.PI,!0),h.stroke(),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill())}renderLine(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),ee=.5*n.width*e,_e=-.5*n.width*e,Ce=n.range*e,Se=-.5*n.width*e,Pe=n.range*e,Ne=.5*n.width*e,je=0-e*Math.sqrt(2),He=ee+e*Math.sqrt(2),Ue=0-e*Math.sqrt(2),We=_e-e*Math.sqrt(2),mt=Ce+e*Math.sqrt(2),Xe=Se-e*Math.sqrt(2),ct=Pe+e*Math.sqrt(2),It=Ne+e*Math.sqrt(2),ot=0*Math.cos(o)-ee*Math.sin(o),_t=0*Math.sin(o)+ee*Math.cos(o),Ct=0*Math.cos(o)-_e*Math.sin(o),xt=0*Math.sin(o)+_e*Math.cos(o),Gt=Ce*Math.cos(o)-Se*Math.sin(o),on=Ce*Math.sin(o)+Se*Math.cos(o),gn=Pe*Math.cos(o)-Ne*Math.sin(o),Tt=Pe*Math.sin(o)+Ne*Math.cos(o),Pt={clip01x:je*Math.cos(o)-He*Math.sin(o),clip01y:je*Math.sin(o)+He*Math.cos(o),clip02x:Ue*Math.cos(o)-We*Math.sin(o),clip02y:Ue*Math.sin(o)+We*Math.cos(o),clip03x:mt*Math.cos(o)-Xe*Math.sin(o),clip03y:mt*Math.sin(o)+Xe*Math.cos(o),clip04x:ct*Math.cos(o)-It*Math.sin(o),clip04y:ct*Math.sin(o)+It*Math.cos(o)},Ut=0,Ht=0,ln=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(h,e,n.gridColor),0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(ot+i,_t+r),h.lineTo(Ct+i,xt+r),h.lineTo(Gt+i,on+r),h.lineTo(gn+i,Tt+r),h.lineTo(ot+i,_t+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let ti=0;ti<=n.areaHeight+1;ti++)for(let si=0;si<=n.areaWidth+1;si++){let{gx:Di,gy:qn}=ln(si,ti,e);if(1==n.fillType)Ut=Di+s+e/2-i,Ht=qn+a+e/2-r,this.chkOuterProduct(ot,_t,Ct,xt,Ut,Ht)&&this.chkOuterProduct(Ct,xt,Gt,on,Ut,Ht)&&this.chkOuterProduct(Gt,on,gn,Tt,Ut,Ht)&&this.chkOuterProduct(gn,Tt,ot,_t,Ut,Ht)&&this.fillSquare(h,Di+s,qn+a,e);else{let Nt=0;for(let Mc=0;Mc<e;Mc++)for(let zi=0;zi<e;zi++)Ut=Di+s+Mc-i+.5,Ht=qn+a+zi-r+.5,this.chkOuterProduct(ot,_t,Ct,xt,Ut,Ht)&&this.chkOuterProduct(Ct,xt,Gt,on,Ut,Ht)&&this.chkOuterProduct(Gt,on,gn,Tt,Ut,Ht)&&this.chkOuterProduct(gn,Tt,ot,_t,Ut,Ht)&&Nt++;(2==n.fillType&&Nt>=1||3==n.fillType&&Nt>=e*e/2||4==n.fillType&&Nt>=e*e)&&this.fillSquare(h,Di+s,qn+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(ot+i,_t+r),h.lineTo(Ct+i,xt+r),h.lineTo(Gt+i,on+r),h.lineTo(gn+i,Tt+r),h.lineTo(ot+i,_t+r),h.stroke(),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),Pt}static gripAreaPathLine(n){let e=n.gridSize,i=Math.PI/180*n.degree,Ce=.5*n.width*e,Pe=-.5*n.width*e,Ne=n.range*e,je=-.5*n.width*e,He=n.range*e,Ue=.5*n.width*e;return{clip01x:0*Math.cos(i)-Ce*Math.sin(i),clip01y:0*Math.sin(i)+Ce*Math.cos(i),clip02x:0*Math.cos(i)-Pe*Math.sin(i),clip02y:0*Math.sin(i)+Pe*Math.cos(i),clip03x:Ne*Math.cos(i)-je*Math.sin(i),clip03y:Ne*Math.sin(i)+je*Math.cos(i),clip04x:He*Math.cos(i)-Ue*Math.sin(i),clip04y:He*Math.sin(i)+Ue*Math.cos(i)}}renderSquare(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),b=-n.range*e,ee=n.range*e,de=-n.range*e,_e=-n.range*e,Ce=n.range*e,Se=-n.range*e,Pe=n.range*e,Ne=n.range*e,ot={clip01x:b-1*e,clip01y:ee+1*e,clip02x:de-1*e,clip02y:_e-1*e,clip03x:Ce+1*e,clip03y:Se-1*e,clip04x:Pe+1*e,clip04y:Ne+1*e},_t=0,Ct=0,xt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(h,e,n.gridColor),0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(b+i,ee+r),h.lineTo(de+i,_e+r),h.lineTo(Ce+i,Se+r),h.lineTo(Pe+i,Ne+r),h.lineTo(b+i,ee+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let Gt=0;Gt<=n.areaHeight+1;Gt++)for(let on=0;on<=n.areaWidth+1;on++){let{gx:gn,gy:Tt}=xt(on,Gt,e);if(1==n.fillType)_t=gn+s+e/2-i,Ct=Tt+a+e/2-r,this.chkOuterProduct(b,ee,de,_e,_t,Ct)&&this.chkOuterProduct(de,_e,Ce,Se,_t,Ct)&&this.chkOuterProduct(Ce,Se,Pe,Ne,_t,Ct)&&this.chkOuterProduct(Pe,Ne,b,ee,_t,Ct)&&this.fillSquare(h,gn+s,Tt+a,e);else{let Pt=0;for(let Ut=0;Ut<e;Ut++)for(let Ht=0;Ht<e;Ht++)_t=gn+s+Ut-i+.5,Ct=Tt+a+Ht-r+.5,this.chkOuterProduct(b,ee,de,_e,_t,Ct)&&this.chkOuterProduct(de,_e,Ce,Se,_t,Ct)&&this.chkOuterProduct(Ce,Se,Pe,Ne,_t,Ct)&&this.chkOuterProduct(Pe,Ne,b,ee,_t,Ct)&&Pt++;(2==n.fillType&&Pt>=1||3==n.fillType&&Pt>=e*e/2||4==n.fillType&&Pt>=e*e)&&this.fillSquare(h,gn+s,Tt+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(b+i,ee+r),h.lineTo(de+i,_e+r),h.lineTo(Ce+i,Se+r),h.lineTo(Pe+i,Ne+r),h.lineTo(b+i,ee+r),h.stroke(),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),n.isDocking?(h.beginPath(),h.strokeRect(i-6,r-6,12,12)):(h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill()),ot}static gripAreaPathSquare(n){let e=n.gridSize;return Math,{clip01x:-n.range*e,clip01y:n.range*e,clip02x:-n.range*e,clip02y:-n.range*e,clip03x:n.range*e,clip03y:-n.range*e,clip04x:n.range*e,clip04y:n.range*e}}renderDiamond(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=-n.centerX%e,s=-n.centerY%e;o>0&&(o-=e),s>0&&(s-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(s<-.5?s+=e/2:s-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let a=this.canvasElement.getContext("2d"),h=-n.range*e,de=-n.range*e,_e=n.range*e,Pe=n.range*e,It={clip01x:h-2*e,clip01y:0,clip02x:0,clip02y:de-2*e,clip03x:_e+2*e,clip03y:0,clip04x:0,clip04y:Pe+2*e},ot=0,_t=0,Ct=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(a,e,n.gridColor),0==n.fillType)this.makeBrush(a,e,n.gridColor),a.beginPath(),a.moveTo(h+i,0+r),a.lineTo(0+i,de+r),a.lineTo(_e+i,0+r),a.lineTo(0+i,Pe+r),a.lineTo(h+i,0+r),a.fill();else{this.makeBrush(a,e,n.gridColor);for(let xt=0;xt<=n.areaHeight+1;xt++)for(let Gt=0;Gt<=n.areaWidth+1;Gt++){let{gx:on,gy:gn}=Ct(Gt,xt,e);if(1==n.fillType)ot=on+o+e/2-i,_t=gn+s+e/2-r,this.chkOuterProduct(h,0,0,de,ot,_t)&&this.chkOuterProduct(0,de,_e,0,ot,_t)&&this.chkOuterProduct(_e,0,0,Pe,ot,_t)&&this.chkOuterProduct(0,Pe,h,0,ot,_t)&&this.fillSquare(a,on+o,gn+s,e);else{let Tt=0;for(let Pt=0;Pt<e;Pt++)for(let Ut=0;Ut<e;Ut++)ot=on+o+Pt-i+.5,_t=gn+s+Ut-r+.5,this.chkOuterProduct(h,0,0,de,ot,_t)&&this.chkOuterProduct(0,de,_e,0,ot,_t)&&this.chkOuterProduct(_e,0,0,Pe,ot,_t)&&this.chkOuterProduct(0,Pe,h,0,ot,_t)&&Tt++;(2==n.fillType&&Tt>=1||3==n.fillType&&Tt>=e*e/2||4==n.fillType&&Tt>=e*e)&&this.fillSquare(a,on+o,gn+s,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,a=this.canvasElementRange.getContext("2d"),this.makeBrush(a,e,n.rangeColor),a.beginPath(),a.lineWidth=2,a.moveTo(h+i,0+r),a.lineTo(0+i,de+r),a.lineTo(_e+i,0+r),a.lineTo(0+i,Pe+r),a.lineTo(h+i,0+r),a.stroke(),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,a=this.canvasElementCenter.getContext("2d"),this.makeBrush(a,e,n.rangeColor),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),It}static gripAreaPathDiamond(n){let e=n.gridSize;return{clip01x:-n.range*e,clip01y:0,clip02x:0,clip02y:-n.range*e,clip03x:n.range*e,clip03y:0,clip04x:0,clip04y:n.range*e}}renderCorn(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let h=this.canvasElement.getContext("2d"),de=n.range*e,_e=-.5*n.width*e,Ce=n.range*e,Se=.5*n.width*e,Pe=0-e*Math.sqrt(2),je=0-e*Math.sqrt(2),He=0-e*Math.sqrt(2),Ue=de-e*Math.sqrt(2),We=_e-e*Math.sqrt(2),mt=de,Xe=_e-e*Math.sqrt(2),ct=de+e*Math.sqrt(2),It=_e-e*Math.sqrt(2),ot=ct,_t=-It,Ct=mt,xt=-Xe,Gt=Ue,on=-We,gn=je,Tt=-He,Ht=de*Math.cos(o)-_e*Math.sin(o),ln=de*Math.sin(o)+_e*Math.cos(o),ti=Ce*Math.cos(o)-Se*Math.sin(o),si=Ce*Math.sin(o)+Se*Math.cos(o),Di={clip01x:Pe*Math.cos(o)-0*Math.sin(o),clip01y:Pe*Math.sin(o)+0*Math.cos(o),clip02x:je*Math.cos(o)-He*Math.sin(o),clip02y:je*Math.sin(o)+He*Math.cos(o),clip03x:Ue*Math.cos(o)-We*Math.sin(o),clip03y:Ue*Math.sin(o)+We*Math.cos(o),clip04x:mt*Math.cos(o)-Xe*Math.sin(o),clip04y:mt*Math.sin(o)+Xe*Math.cos(o),clip05x:ct*Math.cos(o)-It*Math.sin(o),clip05y:ct*Math.sin(o)+It*Math.cos(o),clip06x:ot*Math.cos(o)-_t*Math.sin(o),clip06y:ot*Math.sin(o)+_t*Math.cos(o),clip07x:Ct*Math.cos(o)-xt*Math.sin(o),clip07y:Ct*Math.sin(o)+xt*Math.cos(o),clip08x:Gt*Math.cos(o)-on*Math.sin(o),clip08y:Gt*Math.sin(o)+on*Math.cos(o),clip09x:gn*Math.cos(o)-Tt*Math.sin(o),clip09y:gn*Math.sin(o)+Tt*Math.cos(o)},qn=0,Nt=0,Mc=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(h,e,n.gridColor),h.beginPath(),h.moveTo(0+i,0+r),h.lineTo(Ht+i,ln+r),h.lineTo(ti+i,si+r),h.lineTo(0+i,0+r),h.fill();else{this.makeBrush(h,e,n.gridColor);for(let zi=0;zi<=n.areaHeight+1;zi++)for(let Rs=0;Rs<=n.areaWidth+1;Rs++){let{gx:Pr,gy:za}=Mc(Rs,zi,e);if(1==n.fillType)qn=Pr+s+e/2-i,Nt=za+a+e/2-r,this.chkOuterProduct(0,0,Ht,ln,qn,Nt)&&this.chkOuterProduct(Ht,ln,ti,si,qn,Nt)&&this.chkOuterProduct(ti,si,0,0,qn,Nt)&&this.fillSquare(h,Pr+s,za+a,e);else{let Ml=0;for(let Yv=0;Yv<e;Yv++)for(let Zv=0;Zv<e;Zv++)qn=Pr+s+Yv-i+.5,Nt=za+a+Zv-r+.5,this.chkOuterProduct(0,0,Ht,ln,qn,Nt)&&this.chkOuterProduct(Ht,ln,ti,si,qn,Nt)&&this.chkOuterProduct(ti,si,0,0,qn,Nt)&&Ml++;(2==n.fillType&&Ml>=1||3==n.fillType&&Ml>=e*e/2||4==n.fillType&&Ml>=e*e)&&this.fillSquare(h,Pr+s,za+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,h=this.canvasElementRange.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.lineWidth=2,h.moveTo(0+i,0+r),h.lineTo(Ht+i,ln+r),h.lineTo(ti+i,si+r),h.lineTo(0+i,0+r),h.stroke(),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,h=this.canvasElementCenter.getContext("2d"),this.makeBrush(h,e,n.rangeColor),h.beginPath(),h.arc(i,i,5,0,2*Math.PI,!0),h.fill(),Di}static gripAreaPathCorn(n){let e=n.gridSize,i=Math.PI/180*n.degree,s=n.range*e,a=-.5*n.width*e,_e=s,Ce=a,Se=s,Pe=a,Ne=s,je=a,He=Ne,Ue=-je,We=Se,mt=-Pe,Xe=_e,ct=-Ce;return{clip01x:0*Math.cos(i)-0*Math.sin(i),clip01y:0*Math.sin(i)+0*Math.cos(i),clip02x:0*Math.cos(i)-0*Math.sin(i),clip02y:0*Math.sin(i)+0*Math.cos(i),clip03x:_e*Math.cos(i)-Ce*Math.sin(i),clip03y:_e*Math.sin(i)+Ce*Math.cos(i),clip04x:Se*Math.cos(i)-Pe*Math.sin(i),clip04y:Se*Math.sin(i)+Pe*Math.cos(i),clip05x:Ne*Math.cos(i)-je*Math.sin(i),clip05y:Ne*Math.sin(i)+je*Math.cos(i),clip06x:He*Math.cos(i)-Ue*Math.sin(i),clip06y:He*Math.sin(i)+Ue*Math.cos(i),clip07x:We*Math.cos(i)-mt*Math.sin(i),clip07y:We*Math.sin(i)+mt*Math.cos(i),clip08x:Xe*Math.cos(i)-ct*Math.sin(i),clip08y:Xe*Math.sin(i)+ct*Math.cos(i),clip09x:0*Math.cos(i)- -0*Math.sin(i),clip09y:0*Math.sin(i)+-0*Math.cos(i)}}generateCalcGridPositionFunc(n,e,i,r,o){switch(n){case ds.HEX_VERTICAL:return(s,a,h)=>(s+(e%(2*h)<h?1:0)+(r%4==0?1:0))%2==1?{gx:s*h,gy:a*h}:{gx:s*h,gy:a*h+h/2};case ds.HEX_HORIZONTAL:return(s,a,h)=>(a+(i%(2*h)<h?1:0)+(o%4==0?1:0))%2==1?{gx:s*h,gy:a*h}:{gx:s*h+h/2,gy:a*h};default:return(s,a,h)=>({gx:s*h,gy:a*h})}}fillSquare(n,e,i,r){n.beginPath(),n.fillRect(e,i,r,r)}strokeSquare(n,e,i,r){n.beginPath(),n.strokeStyle="#55555533",n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===ds.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),h=e+r/2,b=i+r/2;n.beginPath();for(let ee=0;ee<6;ee++){s+=60;let de=Math.PI/180*s,_e=Math.cos(de)*a+h,Ce=Math.sin(de)*a+b;n.lineTo(_e,Ce)}n.closePath(),n.stroke()}}const cie=["gridCanvas"],uie=["rangeCanvas"],die=["centerPunch"],fie=["rotate"];function hie(t,n){if(1&t&&(Z(0,"div",15)(1,"i",16),$e(2),ne()()),2&t){const e=ge();V(2),dt(e.isLocked?"lock":"open_with")}}function pie(t,n){if(1&t&&(it(0),Z(1,"div",21)(2,"i",16),$e(3),ne()(),rt()),2&t){const e=n.$implicit,i=ge(2);V(1),pt("left",i.math.ceil((e-.3)*i.gridSize),"px"),V(2),dt(i.isLocked?"lock":"autorenew")}}function gie(t,n){if(1&t&&(it(0),Z(1,"div",17),Te(2,pie,4,3,"ng-container",18),Z(3,"div",19)(4,"i",16),$e(5),ne()(),Z(6,"div",20)(7,"i",16),$e(8),ne()()(),rt()),2&t){const e=ge();V(2),ie("ngForOf",e.rotateHandlesLeftPos),V(3),dt(e.isLocked?"lock":"autorenew"),V(3),dt(e.isLocked?"lock":"autorenew")}}const dM=function(t){return{transform:t}};function mie(t,n){if(1&t&&(Z(0,"div",22)(1,"div",23)(2,"span",24)(3,"i"),$e(4),ne()(),Z(5,"span",25)(6,"i"),$e(7),ne()()(),Z(8,"div",23)(9,"span",26),$e(10),ne(),Z(11,"span",27),$e(12),ne()(),Z(13,"div",28)(14,"span",24)(15,"i"),$e(16),ne()(),Z(17,"span",25)(18,"i"),$e(19),ne()()()()),2&t){const e=ge();pt("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0||!e.isFollowed?0:e.followingCharactor.chatBubbleAltitude+4),"px"),ie("ngStyle",wt(40,dM,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),V(1),pt("visibility",e.altitude>0?"visible":"hidden"),V(1),pt("color",e.range.rangeColor)("text-shadow",e.textShadowCss),V(2),dt(e.elevation),V(1),pt("color",e.range.rangeColor)("text-shadow",e.textShadowCss),V(2),dt(e.elevation),V(2),pt("color",e.range.rangeColor)("text-shadow",e.textShadowCss),V(1),dt(e.math.abs(e.altitude)),V(1),pt("color",e.range.rangeColor)("text-shadow",e.textShadowCss),V(1),dt(e.math.abs(e.altitude)),V(1),pt("visibility",e.altitude<0?"visible":"hidden"),ie("ngStyle",wt(42,dM,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),V(1),pt("color",e.range.rangeColor)("text-shadow",e.textShadowCss),V(2),dt(e.elevation),V(1),pt("color",e.range.rangeColor)("text-shadow",e.textShadowCss),V(2),dt(e.elevation)}}const _ie=function(t){return{"is-grab":t}},$ie=function(t){return{fall:t}};let vie=(()=>{class t{constructor(e,i,r,o,s,a,h,b,ee,de){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=h,this.coordinateService=b,this.tabletopService=ee,this.modalService=de,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.gripAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.isMoving=!1,this.math=Math,this.input=null}get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get gripPathText(){let e="";switch(this.range.type){case"LINE":e=this.gripLine;break;case"CIRCLE":e=this.gripCircle;break;case"SQUARE":e=this.gripSquare;break;case"DIAMOND":e=this.gripDiamond;break;default:e=this.gripCorn}return e}get clipCircle(){return"circle("+(this.rangeLength+1.5)*this.gridSize+"px)"}get gripCircle(){return"circle("+(this.rangeLength>1?this.rangeLength:1)*this.gridSize+"px)"}get clipCorn(){return this.clipCornPath(this.clipAreaCorn)}get gripCorn(){return this.clipCornPath(this.gripAreaCorn)}clipCornPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px, ",i+=e.clip05x+"px "+e.clip05y+"px, ",i+=e.clip06x+"px "+e.clip06y+"px, ",i+=e.clip07x+"px "+e.clip07y+"px, ",i+=e.clip08x+"px "+e.clip08y+"px, ",i+=e.clip09x+"px "+e.clip09y+"px)",i}get clipLine(){return this.clipLinePath(this.clipAreaLine)}get gripLine(){return this.clipLinePath(this.gripAreaLine)}clipLinePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipSquare(){return this.clipSquarePath(this.clipAreaSquare)}get gripSquare(){return this.clipSquarePath(this.gripAreaSquare)}clipSquarePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipDiamond(){return this.clipDiamondPath(this.clipAreaDiamond)}get gripDiamond(){return this.clipDiamondPath(this.gripAreaDiamond)}clipDiamondPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get gripLength(){return this.rangeLength>1?this.rangeLength:1}get gripWidth(){return"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type?this.gripLength:this.range.width>this.gripLength?this.range.width:this.gripLength}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLocked(){return this.range.isLocked}set isLocked(e){this.range.isLocked=e}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.rangeLength<1?1:this.rangeLength;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get elevation(){return+((this.range.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}get textShadowCss(){return`${tt.textShadowColor(this.range.rangeColor,"#f5f5f5")} 0px 0px 3px`}get followingCharactor(){return this.range.followingCharactor}set followingCharactor(e){this.range.followingCharactor=e}get isFollowed(){return this.followingCharactor&&this.followingCharactor.location.x<=this.range.location.x&&this.range.location.x<=this.followingCharactor.location.x+this.followingCharactor.size*this.gridSize&&this.followingCharactor.location.y<=this.range.location.y&&this.range.location.y<=this.followingCharactor.location.y+this.followingCharactor.size*this.gridSize&&this.followingCharactor.altitude+this.followingCharactor.posZ-.5<=this.range.altitude+this.range.posZ&&this.range.altitude+this.range.posZ<=this.followingCharactor.altitude+this.followingCharactor.posZ+.5}get dockableCharacters(){let e=this.tabletopService.characters.filter(i=>"table"===i.location.name&&!i.isHideIn&&[{x:0,y:0},{x:i.size*this.gridSize,y:0},{x:0,y:i.size*this.gridSize},{x:i.size*this.gridSize,y:i.size*this.gridSize}].some(r=>this.range.location.x-this.rangeLength*this.gridSize<=i.location.x+r.x&&i.location.x+r.x<=this.range.location.x+this.rangeLength*this.gridSize&&this.range.location.y-this.rangeLength*this.gridSize<=i.location.y+r.y&&i.location.y+r.y<=this.range.location.y+this.rangeLength*this.gridSize));return this.followingCharactor&&!e.some(i=>i===this.followingCharactor)&&e.push(this.followingCharactor),e.sort((i,r)=>i.name.localeCompare(r.name,"ja"))}get rangeLength(){let e=this.length<1?1:this.length;return this.followingCharactor&&this.range.isExpandByFollowing&&(e+=this.followingCharactor.size/2),e}get rotateHandlesLeftPos(){let e=[];for(let i=1;i<Math.ceil(this.rangeLength/6);i++)e.push(this.rangeLength*i/Math.ceil(this.rangeLength/6));return e.push(this.rangeLength),e}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=Et.instance.get(e.data.identifier);if(!this.range||!i)return;let r=!1;(this.range===i||i instanceof ii&&this.range.contains(i))&&(this.ngZone.run(()=>{this.setRange()}),r=!0),this.followingCharactor&&(i.identifier===this.followingCharactor.identifier||i instanceof ii&&this.followingCharactor.contains(i))&&(this.ngZone.run(()=>{this.range.following(),this.setRange()}),r=!0),r&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new ls(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange(),queueMicrotask(()=>{this.changeDetector.markForCheck()})}ngOnDestroy(){this.input.destroy(),Ve.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Ve.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];if(o.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,St.play(at.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,St.play(at.lock)}}),o.push({name:"\u5f71\u97ff\u30b0\u30ea\u30c3\u30c9\u306e\u5224\u5b9a\u65b9\u6cd5",action:null,subActions:[{name:(0==this.range.fillType?"\u25c9":"\u25cb")+" \u5224\u5b9a\u306a\u3057 (\u8f2a\u90ed\u5185\u3092\u5857\u308a\u3064\u3076\u3059)",action:()=>{this.range.fillType=0}},qt,{name:(1==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e2d\u5fc3\u3092\u8986\u3046",action:()=>{this.range.fillType=1}},{name:(2==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e00\u90e8\u3067\u3082\u8986\u3046",action:()=>{this.range.fillType=2}},{name:(3==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u8986\u3046",action:()=>{this.range.fillType=3}},{name:(4==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u5168\u4f53\u3092\u8986\u3046",action:()=>{this.range.fillType=4}}]}),o.push(qt),"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type){let s=this.dockableCharacters.length<=0?this.followingCharactor?[]:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u3044\u307e\u305b\u3093",action:null,disabled:!0,center:!0}]:this.dockableCharacters.map(a=>({name:`${this.followingCharactor&&this.followingCharactor.identifier===a.identifier?"\u25c9":"\u25cb"} ${a.name}`,action:()=>{this.followingCharactor=a,this.ngZone.run(()=>{this.range.following()}),St.play(at.lock)}}));0!=s.length&&s.push(qt),s.push({name:"\u8ffd\u5f93\u3092\u89e3\u9664\u3059\u308b",action:()=>{St.play(at.unlock),this.followingCharactor=null},disabled:!this.followingCharactor}),o.push({name:"\u4ed8\u8fd1\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:null,subActions:s}),o.push(this.range.isExpandByFollowing?{name:"\u2611 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!1}}:{name:"\u2610 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!0}}),o.push(this.range.isFollowAltitude?{name:"\u2611 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!1}}:{name:"\u2610 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!0,this.followingCharactor&&this.range.following()}})}else o.push(this.range.subDivisionSnapPolygonal?{name:"\u2611 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!1}}:{name:"\u2610 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!0}});o.push(qt),o.push(this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}}),o.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,St.play(at.sweep))},altitudeHande:this.range}),o.push(qt),o.push({name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.range)}}),this.range.getUrls().length>0&&(o.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.range.getUrls().map(s=>{const a=s.value.toString();return{name:s.name?s.name:a,action:()=>{tt.sameOrigin(a)?window.open(a.trim(),"_blank","noopener"):this.modalService.open(co,{url:a,title:this.range.name,subTitle:s.name})},disabled:!tt.validUrl(a),error:tt.validUrl(a)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:tt.validUrl(a)&&!tt.sameOrigin(a)}})}),o.push(qt)),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.range.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,s.followingCharctorIdentifier=null,this.range.parent&&this.range.parent.appendChild(s),St.play(at.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),St.play(at.sweep)}}),o.push(qt),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}onMove(){this.isMoving=!0,St.play(at.cardPick)}onMoved(){this.isMoving=!1,St.play(at.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(ps,{title:r,left:i.x-200,top:i.y-150,width:400,height:390}).tabletopObject=e}setRange(){let e=new Zf(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement,this.centerPunch.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.rangeLength,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,gridType:this.currentTable.gridType,isDocking:!!this.followingCharactor,fillType:this.range.fillType};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i),this.gripAreaLine=Zf.gripAreaPathLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i),this.gripAreaSquare=Zf.gripAreaPathSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i),this.gripAreaDiamond=Zf.gripAreaPathDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i),this.gripAreaCorn=Zf.gripAreaPathCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(Ug),Ge(pr),Ge(Ai),Ge(Wn),Ge(Ki),Ge(vi),Ge(Tl),Ge(Qu),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["range"]],viewQuery:function(e,i){if(1&e&&(Tn(cie,7),Tn(uie,7),Tn(die,7),Tn(fie,5)),2&e){let r;En(r=Sn())&&(i.gridCanvas=r.first),En(r=Sn())&&(i.rangeCanvas=r.first),En(r=Sn())&&(i.centerPunch=r.first),En(r=Sn())&&(i.rotate=r.first)}},hostBindings:function(e,i){1&e&&Ae("dragstart",function(o){return i.onDragstart(o)})("contextmenu",function(o){return i.onContextMenu(o)})},inputs:{range:"range",is3D:"is3D"},decls:19,vars:48,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute"],[1,"is-fill",2,"position","absolute","pointer-events","auto","top","-100%"],[1,"is-3d",2,"position","absolute","pointer-events","none"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["gridCanvas",""],["rangeCanvas",""],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.option","rotable.polygonal","rotable.disable","rotable.ondragstart","rotable.ondragend"],["rotate",""],["class","is-3d","class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],["centerPunch",""],[1,"lock-icon","is-center"],[1,"material-icons"],[1,"is-3d",2,"position","absolute","width","28px","pointer-events","auto"],[4,"ngFor","ngForOf"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(e,i){1&e&&(Z(0,"div",0),Ae("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),Z(1,"div",1)(2,"div",2),vt(3,"div",3),ne(),Z(4,"div",4)(5,"div",5),vt(6,"canvas",6,7),ne(),Z(8,"div",2),vt(9,"canvas",6,8),ne(),Z(11,"div",9,10),Ae("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),Te(13,hie,3,1,"div",11),Te(14,gie,9,3,"ng-container",12),ne()()(),Te(15,mie,20,44,"div",13),Z(16,"div",5),vt(17,"canvas",6,14),ne()()),2&e&&(ie("ngClass",wt(44,_ie,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),V(1),pt("transform","translateZ("+i.altitude*i.gridSize+"px)"),ie("ngClass",wt(46,$ie,0==i.altitude)),V(1),pt("clip-path",i.gripPathText),V(1),pt("left",1.5*-i.gripLength*i.gridSize,"px")("width",3*i.gripLength*i.gridSize,"px")("height",3*i.gripWidth*i.gridSize,"px"),V(1),pt("width",0,"px")("height",0,"px")("clip-path",i.clipPathText),V(1),pt("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),V(3),pt("z-index",i.isMoving?5:0)("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"),V(3),pt("opacity",i.isMoving?.7:1),ie("rotable.option",i.rotableOption)("rotable.polygonal",i.range.subDivisionSnapPolygonal?360:24)("rotable.disable",i.isLocked),V(2),ie("ngIf","CIRCLE"==i.range.type||"SQUARE"==i.range.type||"DIAMOND"==i.range.type),V(1),ie("ngIf","CIRCLE"!=i.range.type&&"SQUARE"!=i.range.type&&"DIAMOND"!=i.range.type),V(1),ie("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)),V(1),pt("visibility",0!=i.altitude?"visible":"hidden")("top",0,"px")("left",-1*i.areaQuadrantSize*i.gridSize,"px"))},dependencies:[oi,$i,Rn,hr,Il,Ic],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:-12.5px;left:-12.5px;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px 14px -14px -14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}"],changeDetection:0}),t})();const bie=["root"],yie=["gameTable"],Cie=["gameObjects"],xie=["gridCanvas"];function wie(t,n){if(1&t&&(it(0),vt(1,"terrain",18),rt()),2&t){const e=ge().$implicit;V(1),pt("z-index",e.height>0?0:1),ie("terrain",e)("appTooltip",e)}}function Eie(t,n){if(1&t&&(it(0),vt(1,"terrain",19),rt()),2&t){const e=ge().$implicit;V(1),pt("z-index",e.height>0?0:1),ie("terrain",e)}}function Tie(t,n){if(1&t&&(it(0),Te(1,wie,2,4,"ng-container",17),Te(2,Eie,2,3,"ng-container",17),rt()),2&t){const e=n.$implicit;V(1),ie("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),V(1),ie("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function Sie(t,n){if(1&t&&(it(0),vt(1,"game-table-mask",20),rt()),2&t){const e=ge().$implicit;V(1),ie("gameTableMask",e)("appTooltip",e)}}function Iie(t,n){if(1&t&&(it(0),vt(1,"game-table-mask",21),rt()),2&t){const e=ge().$implicit;V(1),ie("gameTableMask",e)}}function Mie(t,n){if(1&t&&(it(0),Te(1,Sie,2,2,"ng-container",17),Te(2,Iie,2,1,"ng-container",17),rt()),2&t){const e=n.$implicit;V(1),ie("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),V(1),ie("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}const kie=function(t){return{"z-index":t}};function Die(t,n){if(1&t&&vt(0,"text-note",22),2&t){const e=n.$implicit;ie("textNote",e)("appTooltip",e)("ngStyle",wt(3,kie,e.zindex))}}const fM=function(t,n){return{"z-index":t,transform:n}};function Aie(t,n){if(1&t&&vt(0,"card-stack",23),2&t){const e=n.$implicit;ie("cardStack",e)("appTooltip",e)("ngStyle",fn(3,fM,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function Pie(t,n){if(1&t&&vt(0,"card",24),2&t){const e=n.$implicit;ie("card",e)("appTooltip",e)("ngStyle",fn(3,fM,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function Nie(t,n){if(1&t&&vt(0,"range",25),2&t){const e=n.$implicit;ie("range",e)("appTooltip",e)}}function Oie(t,n){if(1&t&&vt(0,"dice-symbol",26),2&t){const e=n.$implicit;ie("diceSymbol",e)("appTooltip",e)}}function Fie(t,n){if(1&t&&(it(0),vt(1,"game-character",27),rt()),2&t){const e=ge().$implicit;V(1),pt("display",e.isLoaded?"":"none"),ie("gameCharacter",e)("appTooltip",e)}}function Rie(t,n){if(1&t&&(it(0),Te(1,Fie,2,4,"ng-container",17),rt()),2&t){const e=n.$implicit,i=ge();V(1),ie("ngIf",e&&(e.isVisible||i.isGMMode))}}function Lie(t,n){if(1&t&&vt(0,"peer-cursor",28),2&t){const e=n.$implicit,i=ge();pt("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),ie("cursor",e)}}const Bie=function(t,n,e){return[t,n,e]},zie=function(t){return{"is-grabbing":t}},jie=function(t){return{transform:t}};let Uie=(()=>{class t{constructor(e,i,r,o,s,a,h,b){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=h,this.modalService=b,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return an.isStealthMode}get isGMMode(){return Je.myCursor&&Je.myCursor.isGMMode}ngOnInit(){Ve.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let o=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,s=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=e.data.z,h=this.viewRotateZ/180*Math.PI,b=o*Math.cos(h)-s*Math.sin(h),ee=o*Math.sin(h)+s*Math.cos(h),de=this.viewRotateX/180*Math.PI,_e=ee*Math.cos(de),Ce=ee*Math.sin(de)+a;this.setTransform(100-b-this.viewPotisonX,-_e-this.viewPotisonY,-Ce-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Ve.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new bJ(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new vJ(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,h,b){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),b.cancelable&&b.preventDefault();let ee=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=ee,i*=ee,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,h,b){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),b.cancelable&&b.preventDefault();let ee=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=ee,i*=ee,r,o,s,a),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(qt),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a...",action:()=>{this.modalService.open(kS)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a,h=!1){h?(this.viewRotateX=o,this.viewRotateY=s,this.viewRotateZ=a,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),(h||0!=o||0!=s||0!=o)&&this.ngZone.run(()=>{Ve.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=ds.SQUARE,s="#000000e6",a=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new $J(this.gridCanvas.nativeElement).render(e,i,r,o,s,a),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(Ge(Fn),Ge(pr),Ge(vi),Ge(Tl),Ge(Gu),Ge(Qu),Ge(Ug),Ge(Yn))},t.\u0275cmp=mn({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(Tn(bie,7),Tn(yie,7),Tn(Cie,7),Tn(xie,7)),2&e){let r;En(r=Sn())&&(i.rootElementRef=r.first),En(r=Sn())&&(i.gameTable=r.first),En(r=Sn())&&(i.gameObjects=r.first),En(r=Sn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Ae("contextmenu",function(o){return i.onContextMenu(o)})("mousedown",function(o){return i.onDocumentMouseDown(o)},!1,Nh)("touchstart",function(o){return i.onDocumentTouchStart(o)},!1,Nh)("contextmenu",function(o){return i.onDocumentContextMenu(o)},!1,Nh)},decls:21,vars:39,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],[1,"is-fill","is-3d","is-pointer-events-none"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"range","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngIf"],[1,"is-3d",3,"terrain","appTooltip"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask","appTooltip"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"range","appTooltip"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(Z(0,"div",0),zt(1,"safe"),ne(),Z(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),zt(8,"safe"),vt(9,"canvas",7,8),Z(11,"div",9),Te(12,Tie,3,2,"ng-container",10),ne(),Te(13,Mie,3,2,"ng-container",10),Te(14,Die,1,5,"text-note",11),Te(15,Aie,1,6,"card-stack",12),Te(16,Pie,1,6,"card",13),Te(17,Nie,1,2,"range",14),Te(18,Oie,1,2,"dice-symbol",15),Te(19,Rie,2,1,"ng-container",10),Te(20,Lie,1,3,"peer-cursor",16),ne()()()),2&e&&(pt("background-image",jt(1,25,"url("+i.backgroundImage.url+")","style")),ie("ngClass",_o(31,Bie,i.backgroundFilterType?"is-filter":"",i.isStealthMode&&!i.isGMMode?"is-hide-in":"",i.backgroundFilterType)),V(2),ie("ngClass",wt(35,zie,i.isPointerDragging)),V(4),pt("background-image",jt(8,28,"url("+i.tableImage.url+")","style")),V(3),ie("ngStyle",wt(37,jie,"translateZ("+(i.gridHeight+.1)+"px)")),V(3),ie("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.ranges)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),V(1),ie("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},dependencies:[oi,$i,Rn,hr,IJ,Fte,tne,lne,Tne,Yr,Vne,lie,tM,vie,_i],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}']}),t})(),Hie=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Ve.register(this).on("*",i=>{this.needRepeat||Lt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Ve.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(Ge(Ai))},t.\u0275cmp=mn({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(Z(0,"div",0),vt(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),Z(10,"div",10),$e(11,"sync"),ne()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();let Vie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t}),t.\u0275inj=To({}),t})(),Gie=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Zo({type:t,bootstrap:[Xu]}),t.\u0275inj=To({providers:[zv,Vr,pr,Yn,Ev,Wn,vi,Qu,$r],imports:[hw,WL,G2,q6,Vie,w7,jY.register("ngsw-worker.js",{enabled:true})]}),t})();Rc(Xu,function(){return[oi,Rn,Uie,OI,Hie]},function(){return[_i]}),Rc(Hu,function(){return[$i,Rn,nc,so,ao,Ii,sl,Mi,tc,Ci,Ma,pf,vr]},[]),Rc(Ec,function(){return[oi,$i,Rn,nc,Ii,sl,Mi,tc,Ci,Ma,pf,_J,vr]},[]),Rc(Hu,function(){return[$i,Rn,nc,so,ao,Ii,sl,Mi,tc,Ci,Ma,pf,vr]},[]),Rc(Bf,function(){return[$i,Rn,Ii,Ro,Lo,Mi,Ys,Ks,Ci,SS]},[]),function lO(){$2=!1}(),OR().bootstrapModule(Gie).catch(t=>console.error(t))},5904:(E,le,me)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0}),me(8827),me(4748),me(9202),me(8465);var d=me(3583),H=me(3693),J=function(){function _(x,O){this.internal=O??d.BCDice.Base.$new(x)}return _.eval=function(x){var O=d.BCDice.Base.$eval(x);return H.parseResult(O)},Object.defineProperty(_.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),_.prototype.eval=function(){var x=this.internal.$eval();return H.parseResult(x)},_}();le.default=J},8827:(E,le,me)=>{me(9993),Opal.queue(function(d){var U,j,q,M,I,oe,z,Y,H=d.module,J=d.ensure_kwargs,_=d.truthy,x=d.thrower,O=d.def,w=[],K=d.nil,G=d.$$$;return U=w,j=Y=[H(w[0],"BCDice")].concat(U),z=[oe=H(Y[0],"ArithmeticEvaluator")].concat(j),M=[q=d.get_singleton_class(oe)].concat(z),I=d.$r(M),O(q,"$eval",function(L,S){try{x("eval_return");var v,P=K;return null==(v=(S=J(S)).$$smap.round_type)&&(v=G(I("RoundType"),"FLOOR")),_(L)&&_(P=I("Arithmetic").$eval(L,v))?P:0}catch(B){if(B===d.t_eval_return)return B.$v;throw B}},-2)})},9202:(E,le,me)=>{me(9993),Opal.modules.json=function(d){var z,oe,H=d.module,J=d.klass,_=d.send,x=d.Object,O=d.hash2,w=d.eqeqeq,K=d.defs,G=d.truthy,A=d.def,U=d.return_val,N=[],Y=d.nil,T=d.$$$;return function(j,oe){var q,z=H(j,"JSON"),X=[z].concat(oe),M=d.$r(X);J(X[0],M("StandardError"),"JSONError"),J(X[0],M("JSONError"),"ParserError");var I=d.hasOwnProperty;function Q(S){try{return JSON.parse(S)}catch(k){z.$raise(T(M("JSON"),"ParserError"),k.message)}}function L(S,k){var v,P,B,te,D,fe;switch(typeof S){case"string":case"number":return S;case"boolean":return!!S;case"undefined":return Y;case"object":if(!S)return Y;if(S.$$is_array){for(P=k.array_class.$new(),te=0,D=S.length;te<D;te++)P.$push(L(S[te],k));return P}for(fe in B=k.object_class.$new(),S)I.call(S,fe)&&(q=[fe,L(S[fe],k)],_(B,"[]=",q));return k.parse||(v=B["$[]"](M("JSON").$create_id()))==Y?B:x.$const_get(v).$json_create(B)}}d.get_singleton_class(z).$attr_accessor("create_id"),z["$create_id="]("json_class"),K(z,"$[]",function(k,v){return null==v&&(v=O([],{})),w(M("String"),k)?this.$parse(k,v):this.$generate(k,v)},-2),K(z,"$parse",function(k,v){return null==v&&(v=O([],{})),this.$from_object(Q(k),v.$merge(O(["parse"],{parse:!0})))},-2),K(z,"$parse!",function(k,v){return null==v&&(v=O([],{})),this.$parse(k,v)},-2),K(z,"$load",function(k,v){return null==v&&(v=O([],{})),this.$from_object(Q(k),v)},-2),K(z,"$from_object",function(k,v){return null==v&&(v=O([],{})),G(v["$[]"]("object_class"))||v["$[]="]("object_class",M("Hash")),G(v["$[]"]("array_class"))||v["$[]="]("array_class",M("Array")),L(k,v.$$smap)},-2),K(z,"$generate",function(k,v){return null==v&&(v=O([],{})),k.$to_json(v)},-2),K(z,"$dump",function(k,v,P){var te;return null==v&&(v=Y),null==P&&(P=Y),te=this.$generate(k),G(v)?(G(v["$responds_to?"]("to_io"))&&(v=v.$to_io()),v.$write(te),v):te},-2)}(N[0],N),z=J(N[0],null,"Object"),A(z,"$to_json",function(){return this.$to_s().$to_json()}),oe=H(N[0],"Enumerable"),A(oe,"$to_json",function(){return this.$to_a().$to_json()}),function(j,oe){var z=J(j,null,"Array");A(z,"$to_json",function(){for(var M=[],I=0,Q=this.length;I<Q;I++)M.push(this[I].$to_json());return"["+M.join(",")+"]"})}(N[0]),function(j,oe){var z=J(j,null,"Boolean");A(z,"$to_json",function(){return 1==this?"true":"false"})}(N[0]),function(j,oe){var z=J(j,null,"Hash");A(z,"$to_json",function(){for(var S,k,M=[],I=0,Q=this.$$keys,L=Q.length;I<L;I++)(S=Q[I]).$$is_string?k=this.$$smap[S]:(k=S.value,S=S.key),M.push(S.$to_s().$to_json()+":"+k.$to_json());return"{"+M.join(",")+"}"})}(N[0]),function(j,oe){var z=J(j,null,"NilClass");A(z,"$to_json",U("null"))}(N[0]),function(j,oe){var z=J(j,null,"Numeric");A(z,"$to_json",function(){return this.toString()})}(N[0]),function(j,oe){var z=J(j,null,"String");A(z,"$to_json",function(){return JSON.stringify(this)})}(N[0]),function(j,oe){var z=J(j,null,"Time");A(z,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()})}(N[0]),function(j,oe){var z=J(j,null,"Date");return A(z,"$to_json",function(){return this.$to_s().$to_json()}),A(z,"$as_json",function(){return this.$to_s()})}(N[0])},Opal.modules.i18n=function(d){var I,S,v,P,Q,L,H=d.module,J=d.class_variable_set,_=d.class_variable_get,x=d.def,O=d.truthy,w=d.hash2,K=d.send,G=d.ensure_kwargs,A=d.kwrestargs,U=d.to_a,Y=d.alias,T=d.klass,j=d.return_val,z=[],q=d.nil,X=d.$$$;return d.top.$require("json"),I=z,L=[Q=H(z[0],"I18n")].concat(I),S=d.get_singleton_class(Q),v=[S].concat(L),P=d.$r(v),J(v[1],"@@load_path",[]),J(v[1],"@@table",q),x(S,"$load_path",function(){return _(v[1],"@@load_path",!1)}),x(S,"$default_locale",function(){return _(v[1],"@@default_locale",!1)}),x(S,"$default_locale=",function(te){return J(v[1],"@@default_locale",te)}),x(S,"$fallbacks",function(){return X(X(P("I18n"),"Locale"),"Fallbacks").$new()}),x(S,"$load_default_translation",function(){return O(_(v[1],"@@table",!1)["$nil?"]())?(J(v[1],"@@table",w([],{})),this.$load_translation(JSON.stringify(me(6884)))):q}),x(S,"$load_translation",function(te){var fe;return this.$load_default_translation(),fe=P("JSON").$parse(te,w(["symbolize_names"],{symbolize_names:!0})),J(v[1],"@@table",K(_(v[1],"@@table",!1),"merge",[fe],function(F,g,l){return null==F&&(F=q),null==g&&(g=q),null==l&&(l=q),g.$merge(l)}))}),x(S,"$clear_translate_table",function(){return J(v[1],"@@table",q)}),x(S,"$translate",function(te,D){var fe,R,g,l,c=q,f=q,u=q;null==(fe=(D=G(D)).$$smap.locale)&&(fe=q),R=A(D,{locale:!0}),this.$load_default_translation(),g=K(te.$split("."),"map",[],"to_sym".$to_proc()),l=_(v[1],"@@table",!1),c=_(v[1],"@@default_locale",!1),f=O(u=K(l,"dig",[fe].concat(U(g))))?u:K(l,"dig",[c].concat(U(g)));try{O(f["$is_a?"](P("String")))&&(f=this.$format(f,d.to_hash(R)))}catch(p){if(!d.rescue(p,[P("ArgumentError"),P("KeyError")]))throw p;d.pop_exception()}return O(u=f)?u:R["$[]"]("default")},-2),Y(S,"t","translate"),function(S,k){var te,D,fe,P=[H(S,"Locale")].concat(k),B=d.$r(P);te=P[0],D=B("Hash"),fe=T(te,D,"Fallbacks"),x(fe,"$defaults=",j(q))}(L[0],L),function(S,k){var P=[H(S,"Backend")].concat(k);H(P[0],"Simple")}(L[0],L),function(S,k){var B,v=H(S,"Thread");return[v].concat(k),B=d.get_singleton_class(v),x(B,"$current",function(){return w(["i18n_fallbacks"],{i18n_fallbacks:q})})}(L[0],L)},Opal.modules["i18n/backend/fallbacks"]=function(d){var X,Q,S,k,M,I,H=d.module,J=d.class_variable_set,_=d.truthy,x=d.class_variable_get,O=d.def,w=d.send,K=d.send2,G=d.find_super,A=d.hash2,U=d.find_block_super,N=d.neqeq,Y=d.thrower,T=d.return_val,j=[],oe=d.nil,z=d.$$$;return X=j,I=[M=H(j[0],"I18n")].concat(X),J(I[0],"@@fallbacks",oe),Q=d.get_singleton_class(M),S=[Q].concat(I),k=d.$r(S),O(Q,"$fallbacks",function(){var B=oe;return J(S[1],"@@fallbacks",_(null!=S[1].$$cvars["@@fallbacks"]?"class variable":oe)&&_(B=x(S[1],"@@fallbacks",!1))?B:z(z(k("I18n"),"Locale"),"Fallbacks").$new()),_(B=k("Thread").$current()["$[]"]("i18n_fallbacks"))?B:x(S[1],"@@fallbacks",!1)}),O(Q,"$fallbacks=",function(P){var B;return J(S[1],"@@fallbacks",_(P["$is_a?"](k("Array")))?z(z(k("I18n"),"Locale"),"Fallbacks").$new(P):P),B=["i18n_fallbacks",x(S[1],"@@fallbacks",!1)],w(k("Thread").$current(),"[]=",B),B[B.length-1]}),function(Q,L){var P,B,te,D,k=[H(Q,"Backend")].concat(L);return P=k,te=[B=H(k[0],"Fallbacks")].concat(P),D=d.$r(te),O(B,"$translate",function fe(R,F,g){try{var l=Y("return"),c=fe.$$p||oe,f=this,u=oe,p=oe;return fe.$$p=null,null==g&&(g=D("EMPTY_HASH")),_(g.$fetch("fallback",!0))?_(g["$[]"]("fallback_in_progress"))?K(f,G(f,"translate",fe,!1,!0),"translate",[R,F,g],c):(_(g["$[]"]("default"))&&(u=f["$extract_non_symbol_default!"](g)),p=g.$merge(A(["fallback_in_progress"],{fallback_in_progress:!0})),w(D("I18n").$fallbacks()["$[]"](R),"each",[],function m(C){var $=m.$$s??this;null==C&&(C=oe);try{return w($,"catch",["exception"],function re(){var se=re.$$s??this,Ee=oe;if(Ee=K(se,U(se,"translate",re.$$def||m.$$def||fe,!1,!1),"translate",[C,F,p],null),_(Ee["$nil?"]()))return oe;N(R.$to_s(),C.$to_s())&&se.$on_fallback(R,C,F,g),l.$throw(Ee)},{$$s:$,$$ret:l})}catch(re){if(!d.rescue(re,[z(D("I18n"),"InvalidLocale")]))throw re;try{return oe}finally{d.pop_exception()}}},{$$s:f}),_(g["$key?"]("default"))&&_(g["$[]"]("default")["$nil?"]())?oe:_(u)?K(f,G(f,"translate",fe,!1,!0),"translate",[R,oe,g.$merge(A(["default"],{default:u}))],null):f.$throw("exception",z(D("I18n"),"MissingTranslation").$new(R,F,g))):K(f,G(f,"translate",fe,!1,!0),"translate",[R,F,g],c)}catch(m){if(m===l)return m.$v;throw m}},-3),O(B,"$extract_non_symbol_default!",function(R){var g,F=oe;return F=[R["$[]"]("default")].$flatten(),g=w(F,"detect",[],function(c){return null==c&&(c=oe),c["$is_a?"](D("Symbol"))["$!"]()}),_(g)&&R["$[]="]("default",F["$[]"](0,F.$index(g))),g}),O(B,"$exists?",function fe(R,F,g){try{var l=Y("return"),c=fe.$$p||oe,f=this;return fe.$$p=null,null==g&&(g=D("EMPTY_HASH")),_(g.$fetch("fallback",!0))?(w(D("I18n").$fallbacks()["$[]"](R),"each",[],function u(p){var m=u.$$s??this;null==p&&(p=oe);try{if(!_(K(m,U(m,"exists?",u.$$def||fe,!1,!1),"exists?",[p,F],null)))return oe;l.$throw(!0)}catch(C){if(!d.rescue(C,[z(D("I18n"),"InvalidLocale")]))throw C;try{return oe}finally{d.pop_exception()}}},{$$s:f,$$ret:l}),!1):K(f,G(f,"exists?",fe,!1,!0),"exists?",[R,F,g],c)}catch(u){if(u===l)return u.$v;throw u}},-3),B.$private(),O(B,"$on_fallback",T(oe))}(I[0],I)},Opal.modules["bcdice/randomizer"]=function(d){var M,v,P,B,te,D,Q,L,J=d.klass,_=d.const_set,x=d.def,O=d.truthy,w=d.rb_gt,K=d.rb_plus,G=d.rb_le,A=d.send,U=d.rb_minus,N=d.eqeq,Y=d.rb_times,T=d.eqeqeq,j=d.rb_ge,oe=[],z=d.nil,q=d.$$$;return M=oe,Q=[(0,d.module)(oe[0],"BCDice")].concat(M),L=d.$r(Q),v=Q,B=[P=J(Q[0],null,"Randomizer")].concat(v),te=d.$r(B),(D=P.$$prototype).rand_results=D.detailed_rand_results=z,_(B[0],"UPPER_LIMIT_DICE_TIMES",200),_(B[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(B[0],"UPPER_LIMIT_RANDS",1e4),x(P,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),P.$attr_reader("rand_results"),P.$attr_reader("detailed_rand_results"),_(B[0],"DetailedRandResult",te("Struct").$new("kind","sides","value")),x(P,"$roll_barabara",function(R,F){var g=this;return O(w(K(g.rand_results.$size(),R),te("UPPER_LIMIT_RANDS")))&&g.$raise(te("TooManyRandsError")),O(G(R,0))||O(w(R,te("UPPER_LIMIT_DICE_TIMES")))?[]:A(te("Array"),"new",[R],function l(){return(l.$$s??this).$roll_once(F)},{$$s:g})}),x(P,"$roll_sum",function(R,F){return this.$roll_barabara(R,F).$sum()}),x(P,"$roll_once",function(R){var g=z;return O(G(R,0))||O(w(R,te("UPPER_LIMIT_DICE_SIDES")))?0:(g=this.$rand_inner(R),this.$push_to_detail("normal",R,g),g)}),x(P,"$roll_index",function(R){return U(this.$roll_once(R),1)}),x(P,"$roll_tens_d10",function(){var g,F=z;return F=this.$rand_inner(10),N(F,10)&&(F=0),g=Y(F,10),this.$push_to_detail("tens_d10",10,g),g}),x(P,"$roll_d9",function(){var F;return F=U(this.$rand_inner(10),1),this.$push_to_detail("d9",10,F),F}),x(P,"$roll_d66",function(R){var l,g=z;return g=A(te("Array"),"new",[2],function c(){return(c.$$s??this).$roll_once(6)},{$$s:this}),T(q(te("D66SortType"),"ASC"),l=R)?g["$sort!"]():T(q(te("D66SortType"),"DESC"),l)&&g["$sort!"]()["$reverse!"](),K(Y(g["$[]"](0),10),g["$[]"](1))}),P.$private(),x(P,"$rand_inner",function(R){var g,F=this;return O(j(F.rand_results.$size(),te("UPPER_LIMIT_RANDS")))&&F.$raise(te("TooManyRandsError")),g=F.$random(R),F.rand_results["$<<"]([g,R]),g}),x(P,"$random",function(R){return K(te("Kernel").$rand(R),1)}),x(P,"$push_to_detail",function(R,F,g){var c;return c=te("DetailedRandResult").$new(R,F,g),this.detailed_rand_results.$push(c)}),J(Q[0],L("StandardError"),"TooManyRandsError"),z},Opal.modules["bcdice/dice_table/roll_result"]=function(d){var A,T,X,M,I,Q,L,oe,N,H=d.module,J=d.klass,_=d.def,x=d.truthy,O=d.return_val,w=[],K=d.nil;return A=w,T=N=[H(w[0],"BCDice")].concat(A),X=oe=[H(N[0],"DiceTable")].concat(T),I=[M=J(oe[0],null,"RollResult")].concat(X),Q=d.$r(I),(L=M.$$prototype).table_name=L.value=L.body=K,_(M,"$initialize",function(k,v,P){var B=this;return B.table_name=k,B.value=v,B.body=P}),M.$attr_reader("table_name"),M.$attr_reader("value"),M.$attr_reader("body"),_(M,"$to_s",function(){var k=this;return k.table_name+"("+k.value+") \uff1e "+k.body}),_(M,"$last_body",function(){var k=this;return x(k.body["$is_a?"](Q("RollResult")))?k.body.$last_body():k.body}),_(M,"$empty?",O(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(d){var A,T,X,M,I,Q,L,oe,N,H=d.module,J=d.klass,_=d.truthy,x=d.def,O=d.rb_minus,w=[],K=d.nil;return A=w,T=N=[H(w[0],"BCDice")].concat(A),X=oe=[H(N[0],"DiceTable")].concat(T),I=[M=J(oe[0],null,"ChainTable")].concat(X),Q=d.$r(I),(L=M.$$prototype).times=L.sides=L.items=L.name=K,x(M,"$initialize",function(k,v,P){var B=this,te=K;return B.name=k,B.items=P.$freeze(),te=/(\d+)D(\d+)/i.$match(v),_(te)||B.$raise(Q("ArgumentError"),"Unexpected table type: "+v),B.times=te["$[]"](1).$to_i(),B.sides=te["$[]"](2).$to_i()}),x(M,"$roll",function(k){var P,B,v=this,te=K;return P=k.$roll_sum(v.times,v.sides),B=O(P,v.times),te=v.items["$[]"](B),_(te["$respond_to?"]("roll"))&&(te=te.$roll(k)),Q("RollResult").$new(v.name,P,te)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(d){var Y,z,Q,L,S,k,v,X,j,H=d.module,J=d.klass,_=d.hash2,x=d.defs,O=d.def,w=d.rb_plus,K=d.rb_times,G=d.rb_minus,A=[],U=d.nil;return Y=A,z=j=[H(A[0],"BCDice")].concat(Y),Q=X=[H(j[0],"DiceTable")].concat(z),S=[L=J(X[0],null,"D66GridTable")].concat(Q),k=d.$r(S),(v=L.$$prototype).name=v.items=U,x(L,"$from_i18n",function(B,te){var fe=U;return fe=k("I18n").$t(B,_(["locale","raise"],{locale:te,raise:!0})),this.$new(fe["$[]"]("name"),fe["$[]"]("items"))}),O(L,"$initialize",function(B,te){return this.name=B,this.items=te.$freeze()}),O(L,"$roll",function(B){var D,fe,R,F,g;return D=B.$roll_once(6),fe=B.$roll_once(6),R=w(K(D,10),fe),F=G(D,1),g=G(fe,1),k("RollResult").$new(this.name,R,this.items["$[]"](F)["$[]"](g))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(d){var U,j,I,Q,L,S,z,q,Y,H=d.module,J=d.klass,_=d.hash2,x=d.defs,O=d.def,K=[],G=d.nil;return d.top.$require("bcdice/dice_table/d66_grid_table"),U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[H(Y[0],"DiceTable")].concat(j),q=d.$r(z),I=z,L=[Q=J(z[0],q("D66GridTable"),"D66HalfGridTable")].concat(I),S=d.$r(L),x(Q,"$from_i18n",function(v,P){var te=G;return te=S("I18n").$t(v,_(["locale","raise"],{locale:P,raise:!0})),this.$new(te["$[]"]("name"),te["$[]"]("items_1_2_3"),te["$[]"]("items_4_5_6"))}),O(Q,"$initialize",function(v,P,B){return this.name=v,this.items=[P,P,P,B,B,B].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(d){var U,j,I,Q,L,S,z,q,Y,H=d.module,J=d.klass,_=d.hash2,x=d.defs,O=d.def,K=[],G=d.nil;return d.top.$require("bcdice/dice_table/d66_grid_table"),U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[H(Y[0],"DiceTable")].concat(j),q=d.$r(z),I=z,L=[Q=J(z[0],q("D66GridTable"),"D66OneThirdTable")].concat(I),S=d.$r(L),x(Q,"$from_i18n",function(v,P){var te=G;return te=S("I18n").$t(v,_(["locale","raise"],{locale:P,raise:!0})),this.$new(te["$[]"]("name"),te["$[]"]("items_1_2"),te["$[]"]("items_3_4"),te["$[]"]("items_5_6"))}),O(Q,"$initialize",function(v,P,B,te){return this.name=v,this.items=[P,P,B,B,te,te].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(d){var j,X,S,k,v,P,B,I,z,H=d.module,J=d.klass,_=d.hash2,x=d.defs,O=d.def,w=d.eqeqeq,K=d.rb_plus,G=d.rb_times,A=d.truthy,U=[],N=d.nil,Y=d.$$$;return j=U,X=z=[H(U[0],"BCDice")].concat(j),S=I=[H(z[0],"DiceTable")].concat(X),v=[k=J(I[0],null,"D66Table")].concat(S),P=d.$r(v),(B=k.$$prototype).sort_type=B.items=B.name=N,x(k,"$from_i18n",function(D,fe){var g,F=N;return F=P("I18n").$t(D,_(["locale"],{locale:fe})),g=P("D66SortType").$const_get(F["$[]"]("d66_sort_type")),this.$new(F["$[]"]("name"),g,F["$[]"]("items"))}),O(k,"$initialize",function(D,fe,R){var F=this;return F.name=D,F.sort_type=fe,F.items=R.$freeze()}),O(k,"$roll",function(D){var R=N,F=N,g=N,l=N;return R=D.$roll_barabara(2,6),w(Y(P("D66SortType"),"ASC"),F=this.sort_type)?R["$sort!"]():w(Y(P("D66SortType"),"DESC"),F)&&R["$sort!"]()["$reverse!"](),g=K(G(R["$[]"](0),10),R["$[]"](1)),l=A(F=this.items["$[]"](g))?F:this.items["$[]"](g.$to_s()),A(l["$respond_to?"]("roll"))&&(l=l.$roll(D)),P("RollResult").$new(this.name,g,l)}),O(k,"$choice",function(D){return P("RollResult").$new(this.name,D,this.items["$[]"](D))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(d){var oe,M,Q,L,q,H=d.module,J=d.klass,_=d.hash2,x=d.send,O=d.to_ary,w=d.rb_plus,K=d.rb_times,G=d.send2,A=d.find_super,U=d.def,Y=[],T=d.nil;return d.top.$require("bcdice/dice_table/d66_table"),oe=Y,M=q=[H(Y[0],"BCDice")].concat(oe),Q=[H(q[0],"DiceTable")].concat(M),L=d.$r(Q),U(J(Q[0],L("D66Table"),"D66LeftRangeTable"),"$initialize",function P(B,te,D){var F;return P.$$p=null,F=_([],{}),x(D,"each",[],function(l){var c,p;return null==l&&(l=T),c=O(l),p=c[1]??T,x(c[0]??T,"each",[],function(C){return null==C&&(C=T),x(p,"each_with_index",[],function(re,se){var Ee,Me;return null==re&&(re=T),null==se&&(se=T),Me=w(K(C,10),w(se,1)),x(F,"[]=",Ee=[Me,re]),Ee[Ee.length-1]})})}),G(this,A(this,"initialize",P,!1,!0),"initialize",[B,te,F],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(d){var T,q,L,S,k,v,P,M,oe,H=d.module,J=d.klass,_=d.hash2,x=d.defs,O=d.def,w=d.truthy,K=d.rb_minus,G=d.rb_plus,A=d.rb_times,U=[],N=d.nil;return T=U,q=oe=[H(U[0],"BCDice")].concat(T),L=M=[H(oe[0],"DiceTable")].concat(q),k=[S=J(M[0],null,"D66ParityTable")].concat(L),v=d.$r(k),(P=S.$$prototype).odd=P.even=P.name=N,x(S,"$from_i18n",function(te,D){var R=N;return R=v("I18n").$t(te,_(["locale","raise"],{locale:D,raise:!0})),this.$new(R["$[]"]("name"),R["$[]"]("odd"),R["$[]"]("even"))}),O(S,"$initialize",function(te,D,fe){var R=this;return R.name=te,R.odd=D.$freeze(),R.even=fe.$freeze()}),O(S,"$roll",function(te){var R,g,l,D=this,fe=N;return fe=te.$roll_once(6),R=te.$roll_once(6),g=(w(fe["$odd?"]())?D.odd:D.even)["$[]"](K(R,1)),l=G(A(fe,10),R),v("RollResult").$new(D.name,l,g)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(d){var U,j,M,I,Q,L,S,z,Y,H=d.module,J=d.klass,_=d.def,x=d.rb_plus,O=d.rb_times,w=d.send,K=[],G=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),M=z=[H(Y[0],"DiceTable")].concat(j),Q=[I=J(z[0],null,"D66RangeTable")].concat(M),L=d.$r(Q),(S=I.$$prototype).items=S.name=G,_(I,"$initialize",function(v,P){return this.name=v,this.items=P.$freeze()}),_(I,"$roll",function(v){var B,te,D,fe=G;return B=v.$roll_once(6),te=v.$roll_once(6),D=x(O(B,10),te),fe=w(this.items,"find",[],function(F){return null==F&&(F=G),F["$[]"](0)["$include?"](D)}),L("RollResult").$new(this.name,D,fe["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(d){var T,q,L,S,k,v,P,M,oe,H=d.module,J=d.klass,_=d.const_set,x=d.send,O=d.truthy,w=d.def,K=d.eqeqeq,G=d.rb_times,A=d.rb_plus,U=[],N=d.nil;return T=U,q=oe=[H(U[0],"BCDice")].concat(T),L=M=[H(oe[0],"DiceTable")].concat(q),k=[S=J(M[0],null,"RangeTable")].concat(L),v=d.$r(k),(P=S.$$prototype).name=P.items=P.num_of_dice=P.num_of_sides=P.formatter=N,_(k[0],"RollResult",x(v("Struct"),"new",["sum","values","content","formatted"],function B(){return(B.$$s??this).$alias_method("to_s","formatted")},{$$s:S})),_(k[0],"Item",v("Struct").$new("range","content")),_(k[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(k[0],"DEFAULT_FORMATTER",x(S,"lambda",[],function(te,D){return null==te&&(te=N),null==D&&(D=N),te.$name()+"("+D.$sum()+") \uff1e "+D.$content()})),S.$attr_reader("name"),S.$attr_reader("num_of_dice"),S.$attr_reader("num_of_sides"),w(S,"$initialize",function B(te,D,fe){var g,R=B.$$p||N,F=this,l=N;return B.$$p=null,F.name=te.$freeze(),F.formatter=O(g=R)?g:v("DEFAULT_FORMATTER"),l=v("DICE_ROLL_METHOD_RE").$match(D),O(l)||F.$raise(v("ArgumentError"),F.name+": invalid dice roll method: "+D),F.num_of_dice=l["$[]"](1).$to_i(),F.num_of_sides=l["$[]"](2).$to_i(),F.$store(fe)}),w(S,"$fetch",function(te){var fe,D=this;return fe=x(D.items,"find",[],function(F){return null==F&&(F=N),F.$range()["$include?"](te)}),O(fe)||D.$raise(v("RangeError"),D.name+": value is out of range: "+te),fe}),w(S,"$roll",function(te){var R,D=this,fe=N,F=N;return R=(fe=te.$roll_barabara(D.num_of_dice,D.num_of_sides)).$sum(),(F=v("RollResult").$new(R,fe,D.$fetch(R).$content()))["$formatted="](D.formatter["$[]"](D,F)),F}),S.$private(),w(S,"$store",function(te){var fe,R,D=this;return fe=x(te,"map",[],function F(g,l){return null==g&&(g=N),null==l&&(l=N),[(F.$$s??this).$coerce_to_int_range(g),l]},{$$s:D}),R=x(fe,"sort_by",[],function(g,l){return null==g&&(g=N),null==l&&(l=N),g.$min()}),D.$assert_min_sum_is_covered(R),D.$assert_max_sum_is_covered(R),D.$assert_no_gap_or_overlap_in_ranges(R),D.items=x(R,"map",[],function(g,l){return null==g&&(g=N),null==l&&(l=N),v("Item").$new(g,l.$freeze()).$freeze()}).$freeze(),D}),w(S,"$coerce_to_int_range",function(te){var fe;return K(v("Integer"),fe=te)?v("Range").$new(te,te):K(v("Range"),fe)&&O(te.$begin()["$is_a?"](v("Integer")))&&O(te.$end()["$is_a?"](v("Integer")))?te:this.$raise(v("TypeError"),this.name+": "+te+" ("+te.$class()+") must be an Integer or a Range with Integers ")}),w(S,"$assert_min_sum_is_covered",function(te){var fe,D=this,R=N;return fe=D.num_of_dice,R=te.$first()["$[]"](0),O(R["$include?"](fe))||D.$raise(v("RangeError"),D.name+": min value ("+fe+") is not covered: "+R),D}),w(S,"$assert_max_sum_is_covered",function(te){var fe,D=this,R=N;return fe=G(D.num_of_dice,D.num_of_sides),R=te.$last()["$[]"](0),O(R["$include?"](fe))||D.$raise(v("RangeError"),D.name+": max value ("+fe+") is not covered: "+R),D}),w(S,"$assert_no_gap_or_overlap_in_ranges",function(te){return x(te,"each_cons",[2],function fe(R,F){var f,u,g=fe.$$s??this,l=N,c=N;return null==g.name&&(g.name=N),null==R&&(R=N),null==F&&(F=N),l=R["$[]"](0),c=F["$[]"](0),f=l.$max(),u=A(f,1),O(c["$include?"](f))&&g.$raise(v("RangeError"),g.name+": Range overlap: "+l+" and "+c),O(c["$include?"](u))?N:g.$raise(v("RangeError"),g.name+": Range gap: "+l+" and "+c)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(d){var N,oe,I,v,P,B,te,L,q,T,H=d.module,J=d.klass,_=d.send,x=d.def,O=d.rb_minus,w=d.return_ivar,K=[],G=d.nil,A=d.$$$;return N=K,oe=T=[H(K[0],"BCDice")].concat(N),I=q=[H(T[0],"DiceTable")].concat(oe),v=L=[J(q[0],null,"SaiFicSkillTable")].concat(I),B=[P=J(L[0],null,"Category")].concat(v),te=d.$r(B),x(P,"$initialize",function(fe,R,F,g){var l=this;return l.name=fe,l.skills=_(R.$map(),"with_index",[2],function(f,u){return null==f&&(f=G),null==u&&(u=G),A(te("SaiFicSkillTable"),"Skill").$new(fe,f,F,u,g)}),l.dice=F}),x(P,"$roll",function(fe){return this.$skills()["$[]"](O(fe.$roll_sum(2,6),2))}),x(P,"$to_s",w("name")),P.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(d){var G,Y,q,L,S,M,j,U,H=d.module,J=d.klass,_=d.def,x=d.hash2,O=[],w=d.nil;return G=O,Y=U=[H(O[0],"BCDice")].concat(G),q=j=[H(U[0],"DiceTable")].concat(Y),M=[J(j[0],null,"SaiFicSkillTable")].concat(q),(S=(L=J(M[0],null,"Skill")).$$prototype).s_format=S.category_dice=S.row_dice=S.category_name=S.name=w,_(L,"$initialize",function(v,P,B,te,D){var fe=this;return fe.category_name=v,fe.name=P,fe.category_dice=B,fe.row_dice=te,fe.s_format=D}),_(L,"$to_s",function(){var v=this;return v.$format(v.s_format,x(["category_dice","row_dice","category_name","skill_name"],{category_dice:v.category_dice,row_dice:v.row_dice,category_name:v.category_name,skill_name:v.name}))}),L.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(d){var M,S,te,D,fe,R,F,v,Q,H=d.module,J=d.klass,_=d.ensure_kwargs,x=d.hash2,O=d.send,K=d.defs,G=d.const_set,A=d.to_ary,U=d.def,N=d.truthy,Y=d.rb_minus,T=d.rb_plus,j=d.top,oe=[],z=d.nil,q=d.$$$;return j.$require("bcdice/dice_table/sai_fic_skill_table/category"),j.$require("bcdice/dice_table/sai_fic_skill_table/skill"),M=oe,S=Q=[H(oe[0],"BCDice")].concat(M),te=v=[H(Q[0],"DiceTable")].concat(S),fe=[D=J(v[0],null,"SaiFicSkillTable")].concat(te),R=d.$r(fe),(F=D.$$prototype).rtt=F.rtt_format=F.rct=F.rct_format=F.rttn=F.rttn_format=F.categories=z,K(D,"$from_i18n",function(l,c,f){var u,p,m,se,re=z;return null==(u=(f=_(f)).$$smap.rtt)&&(u=z),null==(p=f.$$smap.rct)&&(p=z),null==(m=f.$$smap.rttn)&&(m=z),se=(re=R("I18n").$t("RTT",x(["locale","raise","default"],{locale:c,raise:!1,default:x([],{})})).$merge(R("I18n").$t(l,x(["locale","raise"],{locale:c,raise:!0}))))["$[]"]("items"),re=O(re,"select",[],function(Me,ce){return null==Me&&(Me=z),null==ce&&(ce=z),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Me)}),this.$new(se,d.to_hash(re).$merge(x(["rtt","rct","rttn"],{rtt:u,rct:p,rttn:m})))},-3),G(fe[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),G(fe[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),G(fe[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),G(fe[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),U(D,"$initialize",function(l,c){var f,u,p,m,C,$,re,se=this;return null==(f=(c=_(c)).$$smap.rtt)&&(f=z),null==(u=c.$$smap.rct)&&(u=z),null==(p=c.$$smap.rttn)&&(p=z),null==(m=c.$$smap.rtt_format)&&(m=R("DEFAULT_RTT")),null==(C=c.$$smap.rct_format)&&(C=R("DEFAULT_RCT")),null==($=c.$$smap.rttn_format)&&($=R("DEFAULT_RTTN")),null==(re=c.$$smap.s_format)&&(re=R("DEFAULT_S")),se.categories=O(l.$map(),"with_index",[1],function(Me,ce){var ke,ye,he;return null==Me&&(Me=z),null==ce&&(ce=z),ye=(ke=A(Me))[0]??z,he=ke[1]??z,q(R("SaiFicSkillTable"),"Category").$new(ye,he,ce,re)},{$$has_top_level_mlhs_arg:!0}),se.rtt=f,se.rct=u,se.rttn=p.$to_a(),se.rtt_format=m,se.rct_format=C,se.rttn_format=$},-2),G(fe[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),D.$attr_reader("categories"),U(D,"$roll_command",function(l,c){var u,f=this,p=z,m=z;return N(["RTT",f.rtt]["$include?"](u=c))?f.$format_skill(f.rtt_format,f.$roll_skill(l)):N(["RCT",f.rct]["$include?"](u))?(p=f.$roll_category(l),f.$format(f.rct_format,x(["category_dice","category_name"],{category_dice:p.$dice(),category_name:p.$name()}))):N(m=R("RTTN").$index(u))||N(m=f.rttn.$index(u))?f.$format_skill(f.rttn_format,f.categories["$[]"](m).$roll(l)):z}),U(D,"$roll_category",function(l){return this.categories["$[]"](Y(l.$roll_once(6),1))}),U(D,"$roll_skill",function(l){return this.$roll_category(l).$roll(l)}),U(D,"$prefixes",function(){var l=this;return T(["RTT[1-6]?","RCT",l.rtt,l.rct],l.rttn).$compact()}),D.$private(),U(D,"$format_skill",function(l,c){return this.$format(l,x(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:c.$category_dice(),row_dice:c.$row_dice(),category_name:c.$category_name(),skill_name:c.$name(),text:c.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(d){var N,oe,I,Q,L,S,k,q,T,H=d.module,J=d.klass,_=d.hash2,x=d.defs,O=d.truthy,w=d.def,K=d.rb_minus,G=[],A=d.nil;return N=G,oe=T=[H(G[0],"BCDice")].concat(N),I=q=[H(T[0],"DiceTable")].concat(oe),L=[Q=J(q[0],null,"Table")].concat(I),S=d.$r(L),(k=Q.$$prototype).times=k.sides=k.name=k.items=A,x(Q,"$from_i18n",function(P,B){var D=A;return D=S("I18n").$t(P,_(["locale"],{locale:B})),this.$new(D["$[]"]("name"),D["$[]"]("type"),D["$[]"]("items"))}),w(Q,"$initialize",function(P,B,te){var D=this,fe=A;return D.name=P,D.items=te.$freeze(),fe=/(\d+)D(\d+)/i.$match(B),O(fe)||D.$raise(S("ArgumentError"),"Unexpected table type: "+B),D.times=fe["$[]"](1).$to_i(),D.sides=fe["$[]"](2).$to_i()}),w(Q,"$roll",function(P){var te,B=this;return te=P.$roll_sum(B.times,B.sides),B.$choice(te)}),w(Q,"$choice",function(P){var te,B=this;return te=K(P,B.times),S("RollResult").$new(B.name,P,B.items["$[]"](te))})},Opal.modules["bcdice/dice_table"]=function(d){var H=d.top;return H.$require("bcdice/dice_table/roll_result"),H.$require("bcdice/dice_table/chain_table"),H.$require("bcdice/dice_table/d66_grid_table"),H.$require("bcdice/dice_table/d66_half_grid_table"),H.$require("bcdice/dice_table/d66_one_third_table"),H.$require("bcdice/dice_table/d66_left_range_table"),H.$require("bcdice/dice_table/d66_parity_table"),H.$require("bcdice/dice_table/d66_range_table"),H.$require("bcdice/dice_table/d66_table"),H.$require("bcdice/dice_table/range_table"),H.$require("bcdice/dice_table/sai_fic_skill_table"),H.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(d){var w,U,Y,G,H=d.module,J=d.const_set,_=[];return w=_,U=G=[H(_[0],"BCDice")].concat(w),Y=[H(G[0],"D66SortType")].concat(U),J(Y[0],"NO_SORT","no_sort"),J(Y[0],"ASC","asc"),J(Y[0],"DESC","desc"),function(A,U){var Y=[H(A,"RoundType")].concat(U);return J(Y[0],"CEIL","ceil"),J(Y[0],"FLOOR","floor"),J(Y[0],"ROUND","round")}(G[0],G)},Opal.modules["bcdice/translate"]=function(d){var U,j,oe,z,q,Y,H=d.module,J=d.ensure_kwargs,_=d.kwrestargs,O=d.hash2,w=d.def,K=[],G=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[oe=H(Y[0],"Translate")].concat(j),q=d.$r(z),w(oe,"$translate",function(M,I){var Q,L=this;return null==L.locale&&(L.locale=G),I=J(I),Q=_(I,{}),q("I18n").$translate(M,O(["locale","raise"],{locale:L.locale,raise:!0}).$merge(d.to_hash(Q)))},-2)},Opal.modules["bcdice/result"]=function(d){var oe,X,z,U,Y,J=d.klass,_=d.send,x=d.def,O=d.return_val,w=d.return_ivar,K=[],G=d.nil;return U=K,oe=Y=[(0,d.module)(K[0],"BCDice")].concat(U),[z=J(Y[0],null,"Result")].concat(oe),x(X=d.get_singleton_class(z),"$success",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),_(k,"success=",v=[!0]),v[v.length-1]})}),x(X,"$failure",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),_(k,"failure=",v=[!0]),v[v.length-1]})}),x(X,"$critical",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),k["$critical="](!0),_(k,"success=",v=[!0]),v[v.length-1]})}),x(X,"$fumble",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),k["$fumble="](!0),_(k,"failure=",v=[!0]),v[v.length-1]})}),x(X,"$nothing",O("nothing")),x(z,"$initialize",function(M){var I=this;return null==M&&(M=G),I.text=M,I.rands=G,I.detailed_rands=G,I.secret=!1,I.success=!1,I.failure=!1,I.critical=!1,I.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),x(z,"$secret?",w("secret")),x(z,"$success?",w("success")),x(z,"$failure?",w("failure")),x(z,"$critical?",w("critical")),x(z,"$fumble?",w("fumble")),x(z,"$condition=",function(M){return this.success=M,this.failure=M["$!"]()})},Opal.modules["racc/parser"]=function(d){var P,te,D,H=d.module,J=d.klass,_=d.truthy,x=d.const_set,O=d.defs,w=d.gvars,K=d.rb_lt,G=d.def,A=d.to_ary,U=d.send,N=d.neqeq,Y=d.rb_plus,T=d.eqeq,j=d.rb_ge,oe=d.rb_gt,z=d.rb_minus,q=d.rb_le,X=d.rb_times,M=d.assign_ivar_val,Q=[],L=d.$r(Q),S=d.nil,k=d.$$$;return P=Q,te=[H(Q[0],"Racc")].concat(P),D=d.$r(te),J(te[0],D("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":S)||x(Q[0],"ParseError",k(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,D=[H(v,"Racc")].concat(P),fe=d.$r(D);return _(fe("Racc_No_Extensions","skip_raise")?"constant":S)||x(D[0],"Racc_No_Extensions",!1),g=D,c=[l=J(D[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,x(c[0],"Racc_Runtime_Version","1.4.6"),x(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),x(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),x(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),x(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),x(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),x(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),G(l,"$_racc_setup",function(){var m,C,$=this,re=S,se=S;return null==w.stderr&&(w.stderr=S),_(k($.$class(),"Racc_debug_parser"))||($.yydebug=!1),_(null!=(m=$.yydebug)&&m!==S?"instance-variable":S)||($.yydebug=!1),_($.yydebug)&&(_(null!=(C=$.racc_debug_out)&&C!==S?"instance-variable":S)||($.racc_debug_out=w.stderr),$.racc_debug_out=_(re=$.racc_debug_out)?re:w.stderr),se=k($.$class(),"Racc_arg"),_(K(se.$size(),14))&&se["$[]="](13,!0),se}),G(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=S,m.racc_val=S,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),G(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),G(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),G(l,"$_racc_do_parse_rb",function(m,C){var $,Ee=S,Me=S,ce=S,ke=S,ye=S,he=S,Ie=S,be=S;return $=A(m),Ee=$[0]??S,Me=$[1]??S,ce=$[2]??S,ke=$[3]??S,ye=$[10]??S,this.$_racc_init_sysvars(),he=Ie=be=S,U(this,"catch",["racc_end_parse"],function ae(){var ue,xe,y=ae.$$s??this,W=S;for(null==y.racc_state&&(y.racc_state=S),null==y.racc_read_next&&(y.racc_read_next=S),null==y.racc_t&&(y.racc_t=S),null==y.yydebug&&(y.yydebug=S),null==y.racc_val&&(y.racc_val=S);_(!0);)for(_(be=ke["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&N(y.racc_t,0)&&(xe=y.$next_token(),ue=A(xe),he=ue[0]??S,y.racc_val=ue[1]??S,y.racc_t=_(he)?_(W=ye["$[]"](he))?W:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,he,y.racc_val),y.racc_read_next=!1),be=Y(be,y.racc_t),_(j(be,0))&&_(Ie=Ee["$[]"](be))&&T(Me["$[]"](be),y.racc_state["$[]"](-1))||(Ie=ce["$[]"](y.racc_state["$[]"](-1)))):Ie=ce["$[]"](y.racc_state["$[]"](-1));_(Ie=y.$_racc_evalact(Ie,m)););},{$$s:this})}),G(l,"$yyparse",function(m,C){return this.$__send__(f("Racc_YY_Parse_Method"),m,C,this.$_racc_setup(),!0)}),G(l,"$_racc_yyparse_rb",function(m,C,$,re){var se,ce=S,ke=S,ve=S,ye=S,Ie=S,be=S,ae=S;return se=A($),ce=se[0]??S,ke=se[1]??S,ve=se[2]??S,ye=se[3]??S,Ie=se[10]??S,this.$_racc_init_sysvars(),be=S,ae=S,U(this,"catch",["racc_end_parse"],function ue(){var xe=ue.$$s??this;for(null==xe.racc_state&&(xe.racc_state=S);!_(ae=ye["$[]"](xe.racc_state["$[]"](-1)));)for(;_(be=xe.$_racc_evalact(ve["$[]"](xe.racc_state["$[]"](-1)),$)););return U(m,"__send__",[C],function y(W,pe){var we=y.$$s??this,De=S,Le=S;for(null==we.racc_t&&(we.racc_t=S),null==we.racc_state&&(we.racc_state=S),null==we.racc_read_next&&(we.racc_read_next=S),null==W&&(W=S),null==pe&&(pe=S),we.racc_t=_(W)?_(De=Ie["$[]"](W))?De:1:0,we.racc_val=pe,we.racc_read_next=!1,ae=Y(ae,we.racc_t),_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(ke["$[]"](ae),we.racc_state["$[]"](-1))||(be=ve["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););for(;_(_(De=_(Le=(ae=ye["$[]"](we.racc_state["$[]"](-1)))["$!"]())?Le:we.racc_read_next["$!"]())?De:we.racc_t["$=="](0));)for(_(ae)&&_(ae=Y(ae,we.racc_t))&&_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(ke["$[]"](ae),we.racc_state["$[]"](-1))||(be=ve["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););},{$$s:xe})},{$$s:this})}),G(l,"$_racc_evalact",function(m,C){var $,ve,se=this,Ee=S,Me=S,ke=S,ye=S,he=S,Ie=S;if(Ee=($=A(C))[0]??S,Me=$[1]??S,ke=$[3]??S,ve=$[11]??S,ye=$[12]??S,_(oe(m,0))&&_(K(m,ve)))_(oe(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,_(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(_(K(m,0))&&_(oe(m,ye["$-@"]()))){if(he=U(se,"catch",["racc_jump"],function be(){var ae=be.$$s??this;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(C,m)),!1},{$$s:se}),_(he))switch(he){case 1:return se.racc_user_yyerror=!0,ye["$-@"]();case 2:return ve;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(m,ve))_(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(m,ye["$-@"]())){switch(se.racc_error_status){case 0:_(C["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;_(!0)&&!(_(Ie=ke["$[]"](se.racc_state["$[]"](-1)))&&(Ie=Y(Ie,1),_(j(Ie,0))&&_(m=Ee["$[]"](Ie))&&T(Me["$[]"](Ie),se.racc_state["$[]"](-1))));)_(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),_(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return _(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),G(l,"$_racc_do_reduce",function(m,C){var $,ye,Ie,W,pe,we,Ye,se=this,Me=S,ce=S,ke=S,ve=S,he=S,be=S,ae=S,ue=S,xe=S,y=S,De=S,Le=S,ut=S;return Me=($=A(m))[4]??S,ce=$[5]??S,ke=$[6]??S,ve=$[7]??S,ye=$[8]??S,he=$[9]??S,Ie=$[13]??S,be=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,xe=X(C,-3),y=he["$[]"](xe),W=he["$[]"](Y(xe,1)),pe=he["$[]"](Y(xe,2)),we=[],_(se.yydebug)&&(De=ue["$[]"](y["$-@"](),y)),Le=ae["$[]"](y["$-@"](),y),_(se.yydebug)&&ue["$[]="](y["$-@"](),y,we),ae["$[]="](y["$-@"](),y,we),be["$[]="](y["$-@"](),y,we),_(Ie)?ae.$push(se.$__send__(pe,Le,ae,Le["$[]"](0))):ae.$push(se.$__send__(pe,Le,ae)),ue.$push(W),_(se.yydebug)&&se.$racc_reduce(De,W,ue,ae),Ye=z(W,ye),_(xe=ve["$[]"](Ye))&&(xe=Y(xe,be["$[]"](-1)),_(j(xe,0))&&_(ut=Me["$[]"](xe))&&T(ce["$[]"](xe),Ye))?ut:ke["$[]"](Ye)}),G(l,"$on_error",function(m,C,$){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",C.$inspect(),_(se=this.$token_to_str(m))?se:"?"))}),G(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),G(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),G(l,"$yyerrok",M("racc_error_status",0)),G(l,"$racc_read_token",function(m,C,$){var re=this;return re.racc_debug_out.$print("read    "),re.racc_debug_out.$print(C.$inspect(),"(",re.$racc_token2str(m),") "),re.racc_debug_out.$puts($.$inspect()),re.racc_debug_out.$puts()}),G(l,"$racc_shift",function(m,C,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),G(l,"$racc_reduce",function(m,C,$,re){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),_(m["$empty?"]())?Ee.$print(" <none>"):U(m,"each",[],function Me(ce){return null==ce&&(ce=S),Ee.$print(" ",(Me.$$s??this).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(C)),se.$racc_print_stacks($,re),se.racc_debug_out.$puts()}),G(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),G(l,"$racc_e_pop",function(m,C,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),G(l,"$racc_next_state",function(m,C){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(C),$.racc_debug_out.$puts()}),G(l,"$racc_print_stacks",function(m,C){var re=S;return(re=this.racc_debug_out).$print("        ["),U(m,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),re.$print(" (",(se.$$s??this).$racc_token2str(m["$[]"](Ee))," ",C["$[]"](Ee).$inspect(),")")},{$$s:this}),re.$puts(" ]")}),G(l,"$racc_print_states",function(m){var $=S;return($=this.racc_debug_out).$print("        ["),U(m,"each",[],function(se){return null==se&&(se=S),$.$print(" ",se)}),$.$puts(" ]")}),G(l,"$racc_token2str",function(m){var $;return _($=k(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),G(l,"$token_to_str",function(m){return k(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(Q[0],Q)},Opal.modules["bcdice/arithmetic/node"]=function(d){var M,S,B,g,l,D,fe,v,Q,H=d.module,J=d.klass,_=d.def,x=d.thrower,O=d.return_ivar,w=d.send2,K=d.find_super,G=d.eqeq,A=d.const_set,U=d.eqeqeq,N=d.rb_divide,Y=d.truthy,T=d.assign_ivar,j=d.alias,oe=[],z=d.nil,q=d.$$$;return M=oe,S=Q=[H(oe[0],"BCDice")].concat(M),B=v=[H(Q[0],"Arithmetic")].concat(S),D=[H(v[0],"Node")].concat(B),fe=d.$r(D),(l=(g=J(D[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,_(g,"$initialize",function(f,u,p){var m=this;return m.lhs=f,m.op=u,m.rhs=p}),_(g,"$eval",function(f){try{x("eval_return");var C,p=this,m=z;return m=p.lhs.$eval(f),C=p.rhs.$eval(f),m.$send(p.op,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}}),_(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),_(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),_(g,"$op_for_s_exp",O("op")),function(R,F,g){var l=J(R,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,_(l,"$initialize",function p(m,C){return p.$$p=null,w(this,K(this,"initialize",p,!1,!0),"initialize",[m,"/",C],null)}),_(l,"$eval",function(m){try{x("eval_return");var re,se,$=this;return re=$.lhs.$eval(m),se=$.rhs.$eval(m),G(se,0)&&$.$raise(f("ZeroDivisionError")),$.$divide_and_round(re,se,m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),_(l,"$output",function p(){var m=p.$$p||z,C=this;return p.$$p=null,""+w(C,K(C,"output",p,!1,!0),"output",[],m)+C.$rounding_method()}),l.$private(),_(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),_(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(l,"$divide_and_round",function(m,C,$){return this.$raise(f("NotImplementedError"))})}(D[0],fe("BinaryOp"),D),function(R,F,g){var l=J(R,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);A(c[0],"ROUNDING_METHOD",""),l.$private(),_(l,"$divide_and_round",function(p,m,C){var $,re=z;return U(q(f("RoundType"),"CEIL"),$=C)?N(p.$to_f(),m).$ceil():U(q(f("RoundType"),"ROUND"),$)?(re=N(p.$to_f(),m),Y(re["$negative?"]())?re.$abs().$round()["$-@"]():re.$round()):N(p,m).$floor()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithCeil"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","C"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u.$to_f(),p).$ceil()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithRound"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","R"),l.$private(),_(l,"$divide_and_round",function(u,p,m){var C=z;return C=N(u.$to_f(),p),Y(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithFloor"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","F"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u,p).$floor()})}(D[0],fe("DivideBase"),D),function(R,F){var g=J(R,null,"Negative");g.$$prototype.body=z,_(g,"$initialize",T("body")),_(g,"$eval",function(f){try{return x("eval_return"),this.body.$eval(f)["$-@"]()}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"-"+this.body.$output()}),_(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Parenthesis");g.$$prototype.expr=z,_(g,"$initialize",T("expr")),_(g,"$eval",function(f){try{return x("eval_return"),this.expr.$eval(f)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"("+this.expr.$output()+")"}),_(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Number");return g.$$prototype.value=z,_(g,"$initialize",T("value")),_(g,"$eval",O("value")),_(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(D[0])},Opal.modules.strscan=function(d){var T,j,oe,z,q,J=d.def,_=d.truthy,x=d.eqeqeq,O=d.Opal,w=d.return_ivar,K=d.send,G=d.alias,A=[],U=d.nil;return T=A,oe=[j=(0,d.klass)(A[0],null,"StringScanner")].concat(T),z=d.$r(oe),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=U,j.$attr_reader("pos","matched"),J(j,"$initialize",function(M){var I=this;return I.string=M,I.pos=0,I.matched=U,I.working=M,I.match=[]}),j.$attr_reader("string"),J(j,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)}),J(j,"$scan",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return null==Q?I.matched=U:(I.prev_pos=I.pos,I.pos+=Q[0].length,I.working=I.working.substring(Q[0].length),I.matched=Q[0],I.match=Q,Q[0])}),J(j,"$scan_until",function(M){var I=this;M=I.$anchor(M);for(var Q=I.working,L=0;Q.length!=L;++L){var S=M.exec(Q.substr(L));if(null!==S){var k=L+S[0].length,v=Q.substr(0,k);return I.matched=S[0],I.match=S,I.prev_pos=I.pos+L,I.pos+=k,I.working=Q.substr(k),v}}return I.matched=U}),J(j,"$[]",function(M){var Q;if(_(this.match["$empty?"]()))return U;x(z("Symbol"),Q=M)?M=M.$to_s():x(z("String"),Q)||(M=O["$coerce_to!"](M,z("Integer"),"to_int"));var L=this.match;return M<0&&(M+=L.length),M<0||M>=L.length||null==L[M]?U:L[M]}),J(j,"$check",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return I.matched=null==Q?U:Q[0]}),J(j,"$check_until",function(M){var I=this,Q=I.prev_pos,L=I.pos,S=I.working,k=I.$scan_until(M);return I.prev_pos=Q,I.pos=L,I.working=S,k}),J(j,"$peek",function(M){return this.working.substring(0,M)}),J(j,"$eos?",function(){return 0===this.working.length}),J(j,"$exist?",function(M){var Q=M.exec(this.working);return null==Q?U:0==Q.index?0:Q.index+1}),J(j,"$skip",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);if(null==Q)return I.match=[],I.matched=U;var L=Q[0],S=L.length;return I.matched=L,I.match=Q,I.prev_pos=I.pos,I.pos+=S,I.working=I.working.substring(S),S}),J(j,"$skip_until",function(M){var Q=this.$scan_until(M);return Q===U?U:(this.matched=Q.substr(-1),Q.length)}),J(j,"$get_byte",function(){var M=this,I=U;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,I=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=U,I}),J(j,"$match?",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return null==Q?U:(I.prev_pos=I.pos,Q[0].length)}),J(j,"$pos=",function(M){var I=this;return M<0&&(M+=I.string.$length()),I.pos=M,I.working=I.string.slice(M)}),J(j,"$matched_size",function(){return this.matched===U?U:this.matched.length}),J(j,"$post_match",function(){var M=this;return M.matched===U?U:M.string.substr(M.pos)}),J(j,"$pre_match",function(){var M=this;return M.matched===U?U:M.string.substr(0,M.prev_pos)}),J(j,"$reset",function(){var M=this;return M.working=M.string,M.matched=U,M.pos=0}),J(j,"$rest",w("working")),J(j,"$rest?",function(){return 0!==this.working.length}),J(j,"$rest_size",function(){return this.$rest().$size()}),J(j,"$terminate",function(){var M,I=this;return I.match=U,M=[I.string.$length()],K(I,"pos=",M),M[M.length-1]}),J(j,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=U,M.match=U,M}),G(j,"bol?","beginning_of_line?"),G(j,"getch","get_byte"),j.$private(),J(j,"$anchor",function(M){var I=M.toString().match(/\/([^\/]+)$/);return I=I?I[1]:void 0,new RegExp("^(?:"+M.source+")",I)})},Opal.modules["bcdice/normalize"]=function(d){var G,Y,U,H=d.module,J=d.eqeqeq,_=d.def,x=d.eqeq,O=[],w=d.nil;return G=O,U=[H(O[0],"BCDice")].concat(G),(Y=H(U[0],"Normalize")).$module_function(),_(Y,"$comparison_operator",function(j){var oe;return J(/<=|=</,oe=j)?"<=":J(/>=|=>/,oe)?">=":J(/<>|!=|=!/,oe)?"!=":J(/</,oe)?"<":J(/>/,oe)?">":J(/=/,oe)?"==":w}),_(Y,"$target_number",function(j){return x(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(d){var T,q,L,S,k,v,P,M,oe,H=d.module,J=d.klass,_=d.const_set,x=d.hash2,O=d.truthy,w=d.send,K=d.def,G=d.thrower,A=d.top,U=[],N=d.nil;return A.$require("strscan"),A.$require("bcdice/normalize"),T=U,q=oe=[H(U[0],"BCDice")].concat(T),L=M=[H(oe[0],"Command")].concat(q),k=[S=J(M[0],null,"Lexer")].concat(L),v=d.$r(k),(P=S.$$prototype).scanner=P.notations=N,_(k[0],"SYMBOLS",x(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),K(S,"$initialize",function(te,D){var fe,R,g;return te=O(g=(fe=(R=te)===N||null==R?N:R.$split(" ",2))===N||null==fe?N:fe.$first())?g:"",this.scanner=v("StringScanner").$new(te),this.notations=w(D,"map",[],function(c){return null==c&&(c=N),O(c["$is_a?"](v("String")))?v("Regexp").$new(c):c})}),K(S,"$next_token",function(){try{var te=G("return"),D=this,fe=N,R=N,g=N,l=N;return O(D.scanner["$eos?"]())?[!1,"$"]:(w(D.notations,"each",[],function c(f){var p,u=c.$$s??this;if(null==u.scanner&&(u.scanner=N),null==f&&(f=N),p=u.scanner.$scan(f),!O(p))return N;te.$throw(["NOTATION",p])},{$$s:D,$$ret:te}),O(fe=D.scanner.$scan(/\d+/))?["NUMBER",fe.$to_i()]:O(R=D.scanner.$scan(/[<>!=]+/))?(R=v("Normalize").$comparison_operator(R),[O(R)?"CMP_OP":"ILLEGAL",R]):(g=D.scanner.$getch().$upcase(),[O(l=v("SYMBOLS")["$[]"](g))?l:g.$to_sym(),g]))}catch(c){if(c===te)return c.$v;throw c}}),K(S,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(d){var A,T,X,M,I,Q,L,oe,N,H=d.module,J=d.klass,_=d.def,x=d.return_ivar,O=d.truthy,w=[],K=d.nil;return A=w,T=N=[H(w[0],"BCDice")].concat(A),X=oe=[H(N[0],"Command")].concat(T),I=[M=J(oe[0],null,"Parsed")].concat(X),Q=d.$r(I),(L=M.$$prototype).critical=L.fumble=L.dollar=L.modify_number=L.question_target=L.target_number=L.prefix_number=L.command=L.suffix_number=L.cmp_op=K,M.$attr_accessor("command"),M.$attr_accessor("prefix_number"),M.$attr_accessor("suffix_number"),M.$attr_accessor("critical"),M.$attr_accessor("fumble"),M.$attr_accessor("dollar"),M.$attr_accessor("modify_number"),M.$attr_accessor("cmp_op"),M.$attr_accessor("target_number"),M.$attr_writer("question_target"),_(M,"$initialize",function(){var k=this;return k.prefix_number=K,k.suffix_number=K,k.critical=K,k.fumble=K,k.dollar=K,k.cmp_op=K,k.target_number=K,k.question_target=!1}),_(M,"$question_target?",x("question_target")),_(M,"$to_s",function(k){var v=this,P=K,B=K,te=K,D=K,fe=K;switch(null==k&&(k="after_command"),P=O(v.critical)?"@"+v.critical:K,B=O(v.fumble)?"#"+v.fumble:K,te=O(v.dollar)?"$"+v.dollar:K,D=Q("Format").$modifier(v.modify_number),fe=O(v.question_target)?"?":v.target_number,k){case"after_command":return[v.prefix_number,v.command,v.suffix_number,P,B,te,D,v.cmp_op,fe].$join();case"after_modify_number":return[v.prefix_number,v.command,v.suffix_number,D,P,B,te,v.cmp_op,fe].$join();case"after_target_number":return[v.prefix_number,v.command,v.suffix_number,D,v.cmp_op,fe,P,B,te].$join();default:return K}},-1)},Opal.modules["bcdice/command/parser"]=function(d){var k,te,l,p,m,C,$,re,se,Ee,Me,ce,ye,c,f,u,be,fe,R,P,H=d.klass,J=d.module,_=d.slice,x=d.extract_kwargs,O=d.ensure_kwargs,w=d.get_kwarg,K=d.send2,G=d.find_super,A=d.def,U=d.send,N=d.eqeq,Y=d.thrower,T=d.hash,j=d.const_set,oe=d.truthy,z=d.to_ary,q=d.hash2,X=d.top,M=[],I=d.$r(M),Q=d.nil,L=d.$$$;return X.$require("racc/parser.rb"),X.$require("bcdice/arithmetic/node"),X.$require("bcdice/command/lexer"),X.$require("bcdice/command/parsed"),H(L(I("BCDice"),"Command"),L(I("Racc"),"Parser"),"Parser"),k=M,te=P=[J(M[0],"BCDice")].concat(k),fe=[J(P[0],"Command")].concat(te),R=d.$r(fe),l=fe,f=[c=H(fe[0],L(R("Racc"),"Parser"),"Parser")].concat(l),u=d.$r(f),(be=c.$$prototype).notations=be.lexer=be.modifier=be.suffix_number=be.prefix_number=be.need_suffix_number=be.need_prefix_number=be.critical=be.fumble=be.dollar=be.allowed_cmp_op=be.question_target=Q,A(c,"$initialize",function ae(ue,xe){var y,W,pe,we,Le=this;return ae.$$p=null,y=_(arguments),W=x(y),W=O(W),pe=y,we=w(W,"round_type"),K(Le,G(Le,"initialize",ae,!1,!0),"initialize",[],null),Le.notations=pe,Le.round_type=we,Le.prefix_number=!1,Le.suffix_number=!1,Le.need_prefix_number=!1,Le.need_suffix_number=!1,Le.modifier=!0,Le.critical=!1,Le.fumble=!1,Le.dollar=!1,Le.allowed_cmp_op=[Q,">=",">","<=","<","==","!="],Le.question_target=!1},-2),A(c,"$disable_modifier",function(){return this.modifier=!1,this}),A(c,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),A(c,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),A(c,"$has_prefix_number",function(){return this.prefix_number=!0,this.need_prefix_number=!0,this}),A(c,"$has_suffix_number",function(){return this.suffix_number=!0,this.need_suffix_number=!0,this}),A(c,"$enable_critical",function(){return this.critical=!0,this}),A(c,"$enable_fumble",function(){return this.fumble=!0,this}),A(c,"$enable_dollar",function(){return this.dollar=!0,this}),A(c,"$restrict_cmp_op_to",function(ue){var xe,W=this;return xe=_(arguments),W.allowed_cmp_op=xe,W},-1),A(c,"$enable_question_target",function(){return this.question_target=!0,this}),A(c,"$parse",function(ue){try{return this.lexer=u("Lexer").$new(ue,this.notations),this.$do_parse()}catch(y){if(!d.rescue(y,[u("ParseError"),u("ZeroDivisionError")]))throw y;try{return Q}finally{d.pop_exception()}}}),c.$private(),A(c,"$parsed",function(ue,xe,y,W){try{return Y("eval_return"),U(u("Parsed").$new(),"tap",[],function De(Le){var Ye,ut,Dt,Ot,un,tn,On,Mn=De.$$s??this;return null==Mn.round_type&&(Mn.round_type=Q),null==Le&&(Le=Q),Le["$command="](ue["$[]"]("command")),Le["$prefix_number="]((Ye=ue["$[]"]("prefix"))===Q||null==Ye?Q:Ye.$eval(Mn.round_type)),Le["$suffix_number="]((ut=ue["$[]"]("suffix"))===Q||null==ut?Q:ut.$eval(Mn.round_type)),Le["$critical="]((Dt=xe["$[]"]("critical"))===Q||null==Dt?Q:Dt.$eval(Mn.round_type)),Le["$fumble="]((Ot=xe["$[]"]("fumble"))===Q||null==Ot?Q:Ot.$eval(Mn.round_type)),Le["$dollar="]((un=xe["$[]"]("dollar"))===Q||null==un?Q:un.$eval(Mn.round_type)),Le["$modify_number="](y.$eval(Mn.round_type)),Le["$cmp_op="](W["$[]"]("cmp_op")),N(W["$[]"]("target"),"?")?(Le["$question_target="](!0),U(Le,"target_number=",tn=[0]),tn[tn.length-1]):(Le["$question_target="](!1),tn=[(On=W["$[]"]("target"),On===Q||null==On?Q:On.$eval(Mn.round_type))],U(Le,"target_number=",tn),tn[tn.length-1])},{$$s:this})}catch(De){if(De===d.t_eval_return)return De.$v;throw De}}),A(c,"$next_token",function(){return this.lexer.$next_token()}),p=d.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),m=d.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),C=d.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),$=d.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),re=d.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),se=d.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),Ee=[Q,6,13,3,9,-1,27,-15,-10,-1,-38],Me=[Q,Q,Q,Q,Q,Q,19,16,15,Q,Q],ce=d.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ye=T(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),j(f[0],"Racc_arg",[p,m,$,C,re,se,Me,Ee,19,ce,ye,58,35,!0]),j(f[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),j(f[0],"Racc_debug_parser",!1),A(c,"$_reduce_1",function(ue,xe,y){var W;return oe(this.modifier)||this.$raise(u("ParseError")),W=z(ue),this.$parsed(W[0]??Q,W[1]??Q,W[2]??Q,W[3]??Q)}),A(c,"$_reduce_2",function(ue,xe,y){var W;return oe(this.modifier)||this.$raise(u("ParseError")),W=z(ue),this.$parsed(W[0]??Q,W[2]??Q,W[1]??Q,W[3]??Q)}),A(c,"$_reduce_3",function(ue,xe,y){var W,Ye;return Ye=(W=z(ue))[2]??Q,this.$parsed(W[0]??Q,W[1]??Q,L(L(u("Arithmetic"),"Node"),"Number").$new(0),Ye)}),A(c,"$_reduce_4",function(ue,xe,y){var W=this;return oe(W.prefix_number)&&oe(W.suffix_number)||W.$raise(u("ParseError")),q(["command","prefix","suffix"],{command:ue["$[]"](1),prefix:ue["$[]"](0),suffix:ue["$[]"](2)})}),A(c,"$_reduce_5",function(ue,xe,y){var W=this;return oe(W.prefix_number)||W.$raise(u("ParseError")),oe(W.need_suffix_number)&&W.$raise(u("ParseError")),q(["command","prefix"],{command:ue["$[]"](1),prefix:ue["$[]"](0)})}),A(c,"$_reduce_6",function(ue,xe,y){var W=this;return oe(W.suffix_number)||W.$raise(u("ParseError")),oe(W.need_prefix_number)&&W.$raise(u("ParseError")),q(["command","suffix"],{command:ue["$[]"](0),suffix:ue["$[]"](1)})}),A(c,"$_reduce_7",function(ue,xe,y){var W=this;return(oe(W.need_prefix_number)||oe(W.need_suffix_number))&&W.$raise(u("ParseError")),q(["command"],{command:ue["$[]"](0)})}),A(c,"$_reduce_8",function(ue,xe,y){return q([],{})}),A(c,"$_reduce_9",function(ue,xe,y){var W,Ye,De=Q;return De=(W=z(ue))[0]??Q,Ye=W[2]??Q,oe(this.critical)&&oe(De["$[]"]("critical")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("critical",Ye),De}),A(c,"$_reduce_10",function(ue,xe,y){var W,Ye,De=Q;return De=(W=z(ue))[0]??Q,Ye=W[2]??Q,oe(this.fumble)&&oe(De["$[]"]("fumble")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("fumble",Ye),De}),A(c,"$_reduce_11",function(ue,xe,y){var W,Ye,De=Q;return De=(W=z(ue))[0]??Q,Ye=W[2]??Q,oe(this.dollar)&&oe(De["$[]"]("dollar")["$nil?"]())||this.$raise(u("ParseError")),De["$[]="]("dollar",Ye),De}),A(c,"$_reduce_12",function(ue,xe,y){return ue["$[]"](1)}),A(c,"$_reduce_13",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))}),A(c,"$_reduce_14",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))}),A(c,"$_reduce_15",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))}),A(c,"$_reduce_16",function(ue,xe,y){return oe(this.allowed_cmp_op["$include?"](Q))||this.$raise(u("ParseError")),q([],{})}),A(c,"$_reduce_17",function(ue,xe,y){var W,De,Le;return Le=(W=z(ue))[1]??Q,oe(this.allowed_cmp_op["$include?"](De=W[0]??Q))||this.$raise(u("ParseError")),q(["cmp_op","target"],{cmp_op:De,target:Le})}),A(c,"$_reduce_18",function(ue,xe,y){var pe,W=this;return pe=ue["$[]"](0),oe(W.question_target)||W.$raise(u("ParseError")),oe(W.allowed_cmp_op["$include?"](pe))||W.$raise(u("ParseError")),q(["cmp_op","target"],{cmp_op:pe,target:"?"})}),A(c,"$_reduce_19",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"+",ue["$[]"](2))}),A(c,"$_reduce_20",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"-",ue["$[]"](2))}),A(c,"$_reduce_22",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"BinaryOp").$new(ue["$[]"](0),"*",ue["$[]"](2))}),A(c,"$_reduce_23",function(ue,xe,y){return ue["$[]"](3).$new(ue["$[]"](0),ue["$[]"](2))}),A(c,"$_reduce_25",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),A(c,"$_reduce_26",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"DivideWithCeil")}),A(c,"$_reduce_27",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"DivideWithCeil")}),A(c,"$_reduce_28",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"DivideWithRound")}),A(c,"$_reduce_29",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"DivideWithFloor")}),A(c,"$_reduce_30",function(ue,xe,y){return ue["$[]"](1)}),A(c,"$_reduce_31",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"Negative").$new(ue["$[]"](1))}),A(c,"$_reduce_33",function(ue,xe,y){return ue["$[]"](1)}),A(c,"$_reduce_34",function(ue,xe,y){return L(L(u("Arithmetic"),"Node"),"Number").$new(ue["$[]"](0))}),A(c,"$_reduce_none",function(ue,xe,y){return ue["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(d){var U,j,X,M,I,Q,z,Y,H=d.module,J=d.send,_=d.eqeqeq,x=d.truthy,O=d.def,w=d.return_val,K=[],G=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),X=z=[H(Y[0],"Deprecated")].concat(j),I=[M=H(z[0],"Checker")].concat(X),Q=d.$r(I),M.$private(),O(M,"$check_result_legacy",function(S,k,v,P){var fe,B=this,te=G,D=G,R=G,F=G;return te=J(k,"map",[],"sides".$to_proc()),fe=(D=J(k,"map",[],"value".$to_proc())).$sum(),R=_([100],F=te)?B.$check_1D100(S,fe,v,P):_([20],F)?B.$check_1D20(S,fe,v,P):_([6,6],F)?B.$check_2D6(S,fe,D,v,P):G,(x(R["$nil?"]())||x(R["$empty?"]()))&&(R=_([10],F=te.$uniq())?B.$check_nD10(S,fe,D,v,P):_([6],F)?B.$check_nD6(S,fe,D,v,P):G,x(R["$nil?"]())||x(R["$empty?"]()))?G:Q("Result").$new(R.$delete_prefix(" \uff1e "))}),O(M,"$check_1D100",w(G)),O(M,"$check_1D20",w(G)),O(M,"$check_nD10",w(G)),O(M,"$check_2D6",w(G)),O(M,"$check_nD6",w(G))},Opal.queue(function(d){var I,B,F,u,m,C,g,l,c,f,D,H=d.module,J=d.klass,_=d.slice,x=d.rb_plus,O=d.truthy,w=d.def,K=d.regexp,G=d.send,A=d.thrower,U=d.return_ivar,N=d.assign_ivar_val,Y=d.eqeqeq,T=d.eqeq,j=d.return_val,oe=d.range,z=d.rb_minus,q=d.rb_divide,X=d.rb_times,M=d.rb_ge,Q=d.top,L=[],S=d.$r(L),k=d.nil,v=d.$$$;return Q.$require("i18n"),Q.$require("i18n/backend/fallbacks"),Q.$require("bcdice/randomizer"),Q.$require("bcdice/dice_table"),Q.$require("bcdice/enum"),Q.$require("bcdice/translate"),Q.$require("bcdice/result"),Q.$require("bcdice/command/parser"),Q.$require("bcdice/deprecated/checker"),B=L,F=D=[H(L[0],"BCDice")].concat(B),l=[g=J(D[0],null,"Base")].concat(F),c=d.$r(l),(f=g.$$prototype).raw_input=f.randomizer=f.enabled_upcase_input=f.debug=k,m=[u=d.get_singleton_class(g)].concat(l),C=d.$r(m),u.$attr_reader("prefixes"),w(u,"$register_prefix",function(re){var Ee,Me=this,ce=k;return null==Me.prefixes&&(Me.prefixes=k),Ee=_(arguments),Me.prefixes=x(O(ce=Me.prefixes)?ce:[],Ee.$flatten())},-1),w(u,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),w(u,"$prefixes_pattern",function(){var re=this,se=k;return null==re.prefixes_pattern&&(re.prefixes_pattern=k),null==re.prefixes&&(re.prefixes=k),re.prefixes_pattern=O(se=re.prefixes_pattern)?se:k,O(re.prefixes_pattern)?re.prefixes_pattern:(re.prefixes=O(se=re.prefixes)?se:[],re.prefixes.$freeze(),re.prefixes_pattern=(O(re.prefixes["$empty?"]())?/(?!)/:K(["^(S)?(",re.prefixes.$join("|"),")"],"i")).$freeze())}),w(u,"$command_pattern",function(){var re=this,se=k,Ee=k;return null==re.command_pattern&&(re.command_pattern=k),null==re.prefixes&&(re.prefixes=k),re.command_pattern=O(se=re.command_pattern)?se:k,O(re.command_pattern)?re.command_pattern:(re.prefixes=O(se=re.prefixes)?se:[],re.prefixes.$freeze(),Ee=x(G(v(C("CommonCommand"),"COMMANDS"),"map",[],function(ce){return null==ce&&(ce=k),v(ce,"PREFIX_PATTERN").$source()}),re.prefixes),re.command_pattern=K(["^S?(",Ee.$join("|"),")"],"i").$freeze())}),w(u,"$eval",function(re){try{return A("eval_return"),this.$new(re).$eval()}catch(Me){if(Me===d.t_eval_return)return Me.$v;throw Me}}),g.$include(c("Translate")),g.$include(v(c("Deprecated"),"Checker")),w(g,"$initialize",function(p){var m=this;return m.raw_input=p,m.sort_add_dice=!1,m.sort_barabara_dice=!1,m.d66_sort_type=v(c("D66SortType"),"NO_SORT"),m.enabled_d9=!1,m.round_type=v(c("RoundType"),"FLOOR"),m.sides_implicit_d=6,m.upper_dice_reroll_threshold=k,m.reroll_dice_reroll_threshold=k,m.default_cmp_op=k,m.default_target_number=k,m.enabled_upcase_input=!0,m.locale="ja_jp",m.randomizer=v(c("BCDice"),"Randomizer").$new(),m.debug=!1}),g.$attr_accessor("randomizer"),g.$attr_reader("d66_sort_type"),g.$attr_reader("round_type"),g.$attr_reader("sides_implicit_d"),g.$attr_reader("upper_dice_reroll_threshold"),g.$attr_reader("reroll_dice_reroll_threshold"),g.$attr_reader("default_cmp_op"),g.$attr_reader("default_target_number"),w(g,"$sort_add_dice?",U("sort_add_dice")),w(g,"$sort_barabara_dice?",U("sort_barabara_dice")),w(g,"$enabled_d9?",U("enabled_d9")),w(g,"$enable_debug",N("debug",!0)),w(g,"$eval",function(){var m,$,p=this,C=k;return m=v(c("BCDice"),"Preprocessor").$process(p.raw_input,p),C=O($=p.$dice_command(m))?$:p.$eval_common_command(p.raw_input),O(C)?(C["$rands="](p.randomizer.$rand_results()),C["$detailed_rands="](p.randomizer.$detailed_rand_results()),C):k}),w(g,"$change_text",function(p){return p}),w(g,"$check_result",function(p,m,C,$){var re=this,se=k,Ee=k,Me=k,ce=k,ke=k;return se=re.$check_result_legacy(p,m,C,$),O(se)?se:(Ee=G(m,"map",[],"sides".$to_proc()),ce=(Me=G(m,"map",[],"value".$to_proc())).$sum(),se=Y([100],ke=Ee)?re.$result_1d100(p,ce,C,$):Y([20],ke)?re.$result_1d20(p,ce,C,$):Y([6,6],ke)?re.$result_2d6(p,ce,Me,C,$):k,T(se,c("Result").$nothing())?k:O(se)?se:(se=Y([10],ke=Ee.$uniq())?re.$result_nd10(p,ce,Me,C,$):Y([6],ke)?re.$result_nd6(p,ce,Me,C,$):k,T(se,c("Result").$nothing())?k:O(se)?se:re.$result_ndx(p,C,$)))}),w(g,"$grich_text",j(k)),g.$private(),w(g,"$eval_common_command",function(p){try{A("eval_return");var C=A("return");return p=this.$change_text(p),G(v(c("CommonCommand"),"COMMANDS"),"each",[],function re(se){var Me,Ee=re.$$s??this;if(null==Ee.randomizer&&(Ee.randomizer=k),null==se&&(se=k),Me=se.$eval(p,Ee,Ee.randomizer),!O(Me))return k;C.$throw(Me)},{$$s:this,$$ret:C}),k}catch(re){if(re===d.t_eval_return||re===C)return re.$v;throw re}}),w(g,"$dice_command",function(p){var m=this,C=k,$=k,re=k,se=k;return O(m.enabled_upcase_input)&&(p=p.$upcase()),C=m.$class().$prefixes_pattern().$match(p),O(C)?($=C["$[]"](1)["$nil?"]()["$!"](),O($)&&(p=p["$[]"](oe(1,-1,!1))),re=m.$eval_game_system_specific_command(p),O(re["$is_a?"](c("Result")))?(re["$secret="](O(se=re["$secret?"]())?se:$),re):O(re["$nil?"]())||O(re["$empty?"]())||T(re,"1")?k:G(c("Result").$new(),"tap",[],function(Me){var ce;return null==Me&&(Me=k),Me["$text="](re.$to_s()),G(Me,"secret=",ce=[$]),ce[ce.length-1]})):k}),w(g,"$eval_game_system_specific_command",j(k)),w(g,"$result_ndx",function(p,m,C){return O(C["$is_a?"](c("String")))?k:O(p.$send(m,C))?c("Result").$success(this.$translate("success")):c("Result").$failure(this.$translate("failure"))}),w(g,"$result_1d100",j(k)),w(g,"$result_1d20",j(k)),w(g,"$result_nd10",j(k)),w(g,"$result_2d6",j(k)),w(g,"$result_nd6",j(k)),w(g,"$get_table_by_2d6",function(p){return this.$get_table_by_nD6(p,2)}),w(g,"$get_table_by_1d6",function(p){return this.$get_table_by_nD6(p,1)}),w(g,"$get_table_by_nD6",function(p,m){return this.$get_table_by_nDx(p,m,6)}),w(g,"$get_table_by_nDx",function(p,m,C){var re,se=k;return re=this.randomizer.$roll_sum(m,C),se=this.$get_table_value(p["$[]"](z(re,m))),O(se["$nil?"]())?["1",0]:[se,re]}),w(g,"$get_table_by_1d3",function(p){var $,re,m=this,se=k;return m.$debug("get_table_by_1d3"),$=m.randomizer.$roll_sum(1,6),m.$debug("num",$),re=q(z($,1),2).$to_i(),m.$debug("index",re),se=p["$[]"](re),O(se["$nil?"]())?["1",0]:[se,$]}),w(g,"$get_table_by_d66_swap",function(p){var C;return C=this.randomizer.$roll_d66(v(c("D66SortType"),"ASC")),[this.$get_table_by_number(C,p),C]}),w(g,"$get_table_by_d66",function(p){var C,$,re,Ee,se=k;return C=this.randomizer.$roll_once(6),$=this.randomizer.$roll_once(6),re=x(X(z(C,1),6),z($,1)),se=p["$[]"](re),Ee=""+C+$,O(se["$nil?"]())?["1",Ee]:[se,Ee]}),w(g,"$get_table_by_number",function(p,m,C){try{var $=A("return");return null==C&&(C="1"),G(m,"each",[],function se(Ee){var ce,Me=se.$$s??this;if(null==Ee&&(Ee=k),ce=Ee["$[]"](0),!O(M(ce,p)))return k;$.$throw(Me.$get_table_value(Ee["$[]"](1)))},{$$s:this,$$ret:$}),this.$get_table_value(C)}catch(se){if(se===$)return se.$v;throw se}},-3),w(g,"$get_table_value",function(p){return O(p["$is_a?"](c("Proc")))?p.$call():p}),w(g,"$roll_tables",function(p,m){var $=k;return $=m["$[]"](p),O($)?$.$roll(this.randomizer).$to_s():k}),w(g,"$debug",function(p,m){var $,re=this,se=k,Ee=k;return $=_(arguments,1),O(re.debug)?(se=O(p["$is_a?"](c("String")))?p:p.$inspect(),O($["$empty?"]())?re.$warn(se):(Ee=G($,"map",[],function(ce){return null==ce&&(ce=k),O(ce["$is_a?"](c("String")))?'"'+ce+'"':ce.$inspect()}),re.$warn(se+": "+Ee.$join(", ")))):k},-2),v(v(S("I18n"),"Backend"),"Simple").$include(v(v(S("I18n"),"Backend"),"Fallbacks")),S("I18n").$load_path()["$<<"](S("Dir")["$[]"](S("File").$join("bcdice","../../i18n/**/*.yml"))),S("I18n")["$default_locale="]("ja_jp"),I=[["ja_jp"]],G(S("I18n").$fallbacks(),"defaults=",I),I[I.length-1]})},4748:(E,le,me)=>{me(9993),Opal.modules["bcdice/normalize"]=function(d){var G,Y,U,H=d.module,J=d.eqeqeq,_=d.def,x=d.eqeq,O=[],w=d.nil;return G=O,U=[H(O[0],"BCDice")].concat(G),(Y=H(U[0],"Normalize")).$module_function(),_(Y,"$comparison_operator",function(j){var oe;return J(/<=|=</,oe=j)?"<=":J(/>=|=>/,oe)?">=":J(/<>|!=|=!/,oe)?"!=":J(/</,oe)?"<":J(/>/,oe)?">":J(/=/,oe)?"==":w}),_(Y,"$target_number",function(j){return x(j,"?")?j:j.$to_i()})},Opal.modules["racc/parser"]=function(d){var P,te,D,H=d.module,J=d.klass,_=d.truthy,x=d.const_set,O=d.defs,w=d.gvars,K=d.rb_lt,G=d.def,A=d.to_ary,U=d.send,N=d.neqeq,Y=d.rb_plus,T=d.eqeq,j=d.rb_ge,oe=d.rb_gt,z=d.rb_minus,q=d.rb_le,X=d.rb_times,M=d.assign_ivar_val,Q=[],L=d.$r(Q),S=d.nil,k=d.$$$;return P=Q,te=[H(Q[0],"Racc")].concat(P),D=d.$r(te),J(te[0],D("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":S)||x(Q[0],"ParseError",k(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,D=[H(v,"Racc")].concat(P),fe=d.$r(D);return _(fe("Racc_No_Extensions","skip_raise")?"constant":S)||x(D[0],"Racc_No_Extensions",!1),g=D,c=[l=J(D[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,x(c[0],"Racc_Runtime_Version","1.4.6"),x(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),x(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),x(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),x(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),x(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),x(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),G(l,"$_racc_setup",function(){var m,C,$=this,re=S,se=S;return null==w.stderr&&(w.stderr=S),_(k($.$class(),"Racc_debug_parser"))||($.yydebug=!1),_(null!=(m=$.yydebug)&&m!==S?"instance-variable":S)||($.yydebug=!1),_($.yydebug)&&(_(null!=(C=$.racc_debug_out)&&C!==S?"instance-variable":S)||($.racc_debug_out=w.stderr),$.racc_debug_out=_(re=$.racc_debug_out)?re:w.stderr),se=k($.$class(),"Racc_arg"),_(K(se.$size(),14))&&se["$[]="](13,!0),se}),G(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=S,m.racc_val=S,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),G(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),G(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),G(l,"$_racc_do_parse_rb",function(m,C){var $,Ee=S,Me=S,ce=S,ke=S,ye=S,he=S,Ie=S,be=S;return $=A(m),Ee=$[0]??S,Me=$[1]??S,ce=$[2]??S,ke=$[3]??S,ye=$[10]??S,this.$_racc_init_sysvars(),he=Ie=be=S,U(this,"catch",["racc_end_parse"],function ae(){var ue,xe,y=ae.$$s??this,W=S;for(null==y.racc_state&&(y.racc_state=S),null==y.racc_read_next&&(y.racc_read_next=S),null==y.racc_t&&(y.racc_t=S),null==y.yydebug&&(y.yydebug=S),null==y.racc_val&&(y.racc_val=S);_(!0);)for(_(be=ke["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&N(y.racc_t,0)&&(xe=y.$next_token(),ue=A(xe),he=ue[0]??S,y.racc_val=ue[1]??S,y.racc_t=_(he)?_(W=ye["$[]"](he))?W:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,he,y.racc_val),y.racc_read_next=!1),be=Y(be,y.racc_t),_(j(be,0))&&_(Ie=Ee["$[]"](be))&&T(Me["$[]"](be),y.racc_state["$[]"](-1))||(Ie=ce["$[]"](y.racc_state["$[]"](-1)))):Ie=ce["$[]"](y.racc_state["$[]"](-1));_(Ie=y.$_racc_evalact(Ie,m)););},{$$s:this})}),G(l,"$yyparse",function(m,C){return this.$__send__(f("Racc_YY_Parse_Method"),m,C,this.$_racc_setup(),!0)}),G(l,"$_racc_yyparse_rb",function(m,C,$,re){var se,ce=S,ke=S,ve=S,ye=S,Ie=S,be=S,ae=S;return se=A($),ce=se[0]??S,ke=se[1]??S,ve=se[2]??S,ye=se[3]??S,Ie=se[10]??S,this.$_racc_init_sysvars(),be=S,ae=S,U(this,"catch",["racc_end_parse"],function ue(){var xe=ue.$$s??this;for(null==xe.racc_state&&(xe.racc_state=S);!_(ae=ye["$[]"](xe.racc_state["$[]"](-1)));)for(;_(be=xe.$_racc_evalact(ve["$[]"](xe.racc_state["$[]"](-1)),$)););return U(m,"__send__",[C],function y(W,pe){var we=y.$$s??this,De=S,Le=S;for(null==we.racc_t&&(we.racc_t=S),null==we.racc_state&&(we.racc_state=S),null==we.racc_read_next&&(we.racc_read_next=S),null==W&&(W=S),null==pe&&(pe=S),we.racc_t=_(W)?_(De=Ie["$[]"](W))?De:1:0,we.racc_val=pe,we.racc_read_next=!1,ae=Y(ae,we.racc_t),_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(ke["$[]"](ae),we.racc_state["$[]"](-1))||(be=ve["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););for(;_(_(De=_(Le=(ae=ye["$[]"](we.racc_state["$[]"](-1)))["$!"]())?Le:we.racc_read_next["$!"]())?De:we.racc_t["$=="](0));)for(_(ae)&&_(ae=Y(ae,we.racc_t))&&_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(ke["$[]"](ae),we.racc_state["$[]"](-1))||(be=ve["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););},{$$s:xe})},{$$s:this})}),G(l,"$_racc_evalact",function(m,C){var $,ve,se=this,Ee=S,Me=S,ke=S,ye=S,he=S,Ie=S;if(Ee=($=A(C))[0]??S,Me=$[1]??S,ke=$[3]??S,ve=$[11]??S,ye=$[12]??S,_(oe(m,0))&&_(K(m,ve)))_(oe(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,_(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(_(K(m,0))&&_(oe(m,ye["$-@"]()))){if(he=U(se,"catch",["racc_jump"],function be(){var ae=be.$$s??this;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(C,m)),!1},{$$s:se}),_(he))switch(he){case 1:return se.racc_user_yyerror=!0,ye["$-@"]();case 2:return ve;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(m,ve))_(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(m,ye["$-@"]())){switch(se.racc_error_status){case 0:_(C["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;_(!0)&&!(_(Ie=ke["$[]"](se.racc_state["$[]"](-1)))&&(Ie=Y(Ie,1),_(j(Ie,0))&&_(m=Ee["$[]"](Ie))&&T(Me["$[]"](Ie),se.racc_state["$[]"](-1))));)_(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),_(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return _(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),G(l,"$_racc_do_reduce",function(m,C){var $,ye,Ie,W,pe,we,Ye,se=this,Me=S,ce=S,ke=S,ve=S,he=S,be=S,ae=S,ue=S,xe=S,y=S,De=S,Le=S,ut=S;return Me=($=A(m))[4]??S,ce=$[5]??S,ke=$[6]??S,ve=$[7]??S,ye=$[8]??S,he=$[9]??S,Ie=$[13]??S,be=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,xe=X(C,-3),y=he["$[]"](xe),W=he["$[]"](Y(xe,1)),pe=he["$[]"](Y(xe,2)),we=[],_(se.yydebug)&&(De=ue["$[]"](y["$-@"](),y)),Le=ae["$[]"](y["$-@"](),y),_(se.yydebug)&&ue["$[]="](y["$-@"](),y,we),ae["$[]="](y["$-@"](),y,we),be["$[]="](y["$-@"](),y,we),_(Ie)?ae.$push(se.$__send__(pe,Le,ae,Le["$[]"](0))):ae.$push(se.$__send__(pe,Le,ae)),ue.$push(W),_(se.yydebug)&&se.$racc_reduce(De,W,ue,ae),Ye=z(W,ye),_(xe=ve["$[]"](Ye))&&(xe=Y(xe,be["$[]"](-1)),_(j(xe,0))&&_(ut=Me["$[]"](xe))&&T(ce["$[]"](xe),Ye))?ut:ke["$[]"](Ye)}),G(l,"$on_error",function(m,C,$){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",C.$inspect(),_(se=this.$token_to_str(m))?se:"?"))}),G(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),G(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),G(l,"$yyerrok",M("racc_error_status",0)),G(l,"$racc_read_token",function(m,C,$){var re=this;return re.racc_debug_out.$print("read    "),re.racc_debug_out.$print(C.$inspect(),"(",re.$racc_token2str(m),") "),re.racc_debug_out.$puts($.$inspect()),re.racc_debug_out.$puts()}),G(l,"$racc_shift",function(m,C,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),G(l,"$racc_reduce",function(m,C,$,re){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),_(m["$empty?"]())?Ee.$print(" <none>"):U(m,"each",[],function Me(ce){return null==ce&&(ce=S),Ee.$print(" ",(Me.$$s??this).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(C)),se.$racc_print_stacks($,re),se.racc_debug_out.$puts()}),G(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),G(l,"$racc_e_pop",function(m,C,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),G(l,"$racc_next_state",function(m,C){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(C),$.racc_debug_out.$puts()}),G(l,"$racc_print_stacks",function(m,C){var re=S;return(re=this.racc_debug_out).$print("        ["),U(m,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),re.$print(" (",(se.$$s??this).$racc_token2str(m["$[]"](Ee))," ",C["$[]"](Ee).$inspect(),")")},{$$s:this}),re.$puts(" ]")}),G(l,"$racc_print_states",function(m){var $=S;return($=this.racc_debug_out).$print("        ["),U(m,"each",[],function(se){return null==se&&(se=S),$.$print(" ",se)}),$.$puts(" ]")}),G(l,"$racc_token2str",function(m){var $;return _($=k(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),G(l,"$token_to_str",function(m){return k(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(Q[0],Q)},Opal.modules.strscan=function(d){var T,j,oe,z,q,J=d.def,_=d.truthy,x=d.eqeqeq,O=d.Opal,w=d.return_ivar,K=d.send,G=d.alias,A=[],U=d.nil;return T=A,oe=[j=(0,d.klass)(A[0],null,"StringScanner")].concat(T),z=d.$r(oe),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=U,j.$attr_reader("pos","matched"),J(j,"$initialize",function(M){var I=this;return I.string=M,I.pos=0,I.matched=U,I.working=M,I.match=[]}),j.$attr_reader("string"),J(j,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)}),J(j,"$scan",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return null==Q?I.matched=U:(I.prev_pos=I.pos,I.pos+=Q[0].length,I.working=I.working.substring(Q[0].length),I.matched=Q[0],I.match=Q,Q[0])}),J(j,"$scan_until",function(M){var I=this;M=I.$anchor(M);for(var Q=I.working,L=0;Q.length!=L;++L){var S=M.exec(Q.substr(L));if(null!==S){var k=L+S[0].length,v=Q.substr(0,k);return I.matched=S[0],I.match=S,I.prev_pos=I.pos+L,I.pos+=k,I.working=Q.substr(k),v}}return I.matched=U}),J(j,"$[]",function(M){var Q;if(_(this.match["$empty?"]()))return U;x(z("Symbol"),Q=M)?M=M.$to_s():x(z("String"),Q)||(M=O["$coerce_to!"](M,z("Integer"),"to_int"));var L=this.match;return M<0&&(M+=L.length),M<0||M>=L.length||null==L[M]?U:L[M]}),J(j,"$check",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return I.matched=null==Q?U:Q[0]}),J(j,"$check_until",function(M){var I=this,Q=I.prev_pos,L=I.pos,S=I.working,k=I.$scan_until(M);return I.prev_pos=Q,I.pos=L,I.working=S,k}),J(j,"$peek",function(M){return this.working.substring(0,M)}),J(j,"$eos?",function(){return 0===this.working.length}),J(j,"$exist?",function(M){var Q=M.exec(this.working);return null==Q?U:0==Q.index?0:Q.index+1}),J(j,"$skip",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);if(null==Q)return I.match=[],I.matched=U;var L=Q[0],S=L.length;return I.matched=L,I.match=Q,I.prev_pos=I.pos,I.pos+=S,I.working=I.working.substring(S),S}),J(j,"$skip_until",function(M){var Q=this.$scan_until(M);return Q===U?U:(this.matched=Q.substr(-1),Q.length)}),J(j,"$get_byte",function(){var M=this,I=U;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,I=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=U,I}),J(j,"$match?",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return null==Q?U:(I.prev_pos=I.pos,Q[0].length)}),J(j,"$pos=",function(M){var I=this;return M<0&&(M+=I.string.$length()),I.pos=M,I.working=I.string.slice(M)}),J(j,"$matched_size",function(){return this.matched===U?U:this.matched.length}),J(j,"$post_match",function(){var M=this;return M.matched===U?U:M.string.substr(M.pos)}),J(j,"$pre_match",function(){var M=this;return M.matched===U?U:M.string.substr(0,M.prev_pos)}),J(j,"$reset",function(){var M=this;return M.working=M.string,M.matched=U,M.pos=0}),J(j,"$rest",w("working")),J(j,"$rest?",function(){return 0!==this.working.length}),J(j,"$rest_size",function(){return this.$rest().$size()}),J(j,"$terminate",function(){var M,I=this;return I.match=U,M=[I.string.$length()],K(I,"pos=",M),M[M.length-1]}),J(j,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=U,M.match=U,M}),G(j,"bol?","beginning_of_line?"),G(j,"getch","get_byte"),j.$private(),J(j,"$anchor",function(M){var I=M.toString().match(/\/([^\/]+)$/);return I=I?I[1]:void 0,new RegExp("^(?:"+M.source+")",I)})},Opal.modules["bcdice/common_command/lexer"]=function(d){var N,oe,I,Q,L,S,q,T,H=d.module,J=d.klass,_=d.const_set,x=d.hash2,O=d.truthy,w=d.def,K=d.top,G=[],A=d.nil;return K.$require("strscan"),K.$require("bcdice/normalize"),N=G,oe=T=[H(G[0],"BCDice")].concat(N),I=q=[H(T[0],"CommonCommand")].concat(oe),L=[Q=J(q[0],null,"Lexer")].concat(I),S=d.$r(L),Q.$$prototype.scanner=A,_(L[0],"SYMBOLS",x(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),w(Q,"$initialize",function(P){var te;return P=O(te=P.$split(" ",2).$first())?te:"",this.scanner=S("StringScanner").$new(P)}),w(Q,"$next_token",function(){var P=this,B=A,te=A,D=A,R=A;return O(P.scanner["$eos?"]())?[!1,"$"]:O(B=P.scanner.$scan(/\d+/))?["NUMBER",B.$to_i()]:O(te=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",S("Normalize").$comparison_operator(te)]:(D=P.scanner.$getch().$upcase(),[O(R=S("SYMBOLS")["$[]"](D))?R:D.$to_sym(),D])}),w(Q,"$source",function(){return this.scanner.$string()})},Opal.modules.singleton=function(d){var N,z,q,X,M,Y,T,j,H=d.module,J=d.def,_=d.send2,x=d.find_super,O=d.send,w=d.truthy,K=d.defs,G=[],A=d.nil;return N=G,T=[Y=H(G[0],"Singleton")].concat(N),j=d.$r(T),J(Y,"$clone",function(){return this.$raise(j("TypeError"),"can't clone instance of singleton "+this.$class())}),J(Y,"$dup",function(){return this.$raise(j("TypeError"),"can't dup instance of singleton "+this.$class())}),z=T,X=[q=H(T[0],"SingletonClassMethods")].concat(z),M=d.$r(X),J(q,"$clone",function I(){var Q=I.$$p||A;return I.$$p=null,M("Singleton").$__init__(_(this,x(this,"clone",I,!1,!0),"clone",[],Q))}),J(q,"$inherited",function I(Q){var L=I.$$p||A;return I.$$p=null,_(this,x(this,"inherited",I,!1,!0),"inherited",[Q],L),M("Singleton").$__init__(Q)}),function(oe,z){var q=[oe].concat(z),X=d.$r(q);return J(oe,"$__init__",function(I){return O(I,"instance_eval",[],function L(){return(L.$$s??this).singleton__instance__=A},{$$s:this}),K(I,"$instance",function(){var S=this;return null==S.singleton__instance__&&(S.singleton__instance__=A),w(S.singleton__instance__)?S.singleton__instance__:S.singleton__instance__=S.$new()}),I}),J(oe,"$included",function M(I){var Q=M.$$p||A;return M.$$p=null,_(this,x(this,"included",M,!1,!0),"included",[I],Q),I.$extend(X("SingletonClassMethods")),X("Singleton").$__init__(I)})}(d.get_singleton_class(j("Singleton")),T)},Opal.modules["bcdice/common_command/add_dice/node"]=function(d){var v,D,g,u,se,Ee,Me,ce,ke,m,C,c,R,B,H=d.module,J=d.klass,_=d.def,x=d.rb_plus,O=d.thrower,w=d.truthy,K=d.rb_le,G=d.send,A=d.return_val,U=d.alias,N=d.return_ivar,Y=d.send2,T=d.find_super,j=d.const_set,oe=d.eqeqeq,z=d.rb_divide,q=d.assign_ivar,X=d.not,M=d.neqeq,Q=[],L=d.nil,S=d.$$$;return d.top.$require("singleton"),v=Q,D=B=[H(Q[0],"BCDice")].concat(v),g=R=[H(B[0],"CommonCommand")].concat(D),u=c=[H(R[0],"AddDice")].concat(g),m=[H(c[0],"Node")].concat(u),C=d.$r(m),se=m,Me=[Ee=J(m[0],null,"Command")].concat(se),ce=d.$r(Me),(ke=Ee.$$prototype).lhs=ke.rhs=ke.cmp_op=L,Ee.$attr_reader("lhs"),Ee.$attr_reader("cmp_op"),Ee.$attr_reader("rhs"),_(Ee,"$initialize",function(ye,he,Ie,be){return null==Ie&&(Ie=L),null==be&&(be=L),this.secret=ye,this.lhs=he,this.cmp_op=Ie,this.rhs=be},-3),_(Ee,"$expr",function(ye){try{var Ie;return O("eval_return"),x(x(this.lhs.$expr(ye),this.$cmp_op_text()),(Ie=this.rhs,Ie===L||null==Ie?L:Ie.$eval(ye,L)).$to_s())}catch(ae){if(ae===d.t_eval_return)return ae.$v;throw ae}}),_(Ee,"$s_exp",function(){var ye=this;return w(ye.cmp_op)?"(Command ("+ye.cmp_op+" "+ye.lhs.$s_exp()+" "+ye.rhs.$s_exp()+"))":"(Command "+ye.lhs.$s_exp()+")"}),_(Ee,"$eval",function(ye,he){try{O("eval_return");var be,pe,ae=this,ue=L,xe=L,y=L,W=L,we=L;return he=ce("Randomizer").$new(he,ye),ue=ae.lhs.$eval(ye,he),xe=w(K(he.$rand_results().$size(),1))&&w(ae.lhs["$is_a?"](S(ce("Node"),"DiceRoll")))?L:ae.lhs.$output(),y=w(ae.cmp_op)?(W=ae.rhs.$eval(ye,L),ye.$check_result(ue,he.$rand_results(),ae.cmp_op,W)):L,y=w(pe=y)?pe:ce("Result").$new(),we=["("+ae.$expr(ye)+")",xe,ue,(be=y,be===L||null==be?L:be.$text())].$compact(),G(y,"tap",[],function De(Le){var Ye,ut=De.$$s??this;return null==ut.secret&&(ut.secret=L),null==Le&&(Le=L),Le["$secret="](ut.secret),Ye=[we.$join(" \uff1e ")],G(Le,"text=",Ye),Ye[Ye.length-1]},{$$s:ae})}catch(De){if(De===d.t_eval_return)return De.$v;throw De}}),Ee.$private(),_(Ee,"$cmp_op_text",function(){switch(this.cmp_op){case"!=":return"<>";case"==":return"=";default:return this.cmp_op.$to_s()}}),function($,re,se){var Ee=J($,null,"UndecidedTarget"),Me=[Ee].concat(se),ce=d.$r(Me);Ee.$include(ce("Singleton")),_(Ee,"$eval",A("?")),_(Ee,"$include_dice?",A(!1)),_(Ee,"$expr",A("?")),_(Ee,"$output",A("?")),U(Ee,"s_exp","output")}(m[0],0,m),function($,re){var se=J($,null,"BinaryOp"),Ee=se.$$prototype;Ee.lhs=Ee.rhs=Ee.op=L,_(se,"$initialize",function(ce,ke,ve){return this.lhs=ce,this.op=ke,this.rhs=ve}),_(se,"$eval",function(ce,ke){try{var he,Ie;return O("eval_return"),he=this.lhs.$eval(ce,ke),Ie=this.rhs.$eval(ce,ke),this.$calc(he,Ie,ce.$round_type()).$to_i()}catch(be){if(be===d.t_eval_return)return be.$v;throw be}}),_(se,"$include_dice?",function(){var ke;return w(ke=this.lhs["$include_dice?"]())?ke:this.rhs["$include_dice?"]()}),_(se,"$expr",function(ce){var ve,ye;return ve=this.lhs.$expr(ce),ye=this.rhs.$expr(ce),""+ve+this.op+ye}),_(se,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()}),_(se,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"}),se.$private(),_(se,"$calc",function(ce,ke,ve){return ce.$send(this.op,ke).$to_i()}),_(se,"$op_for_s_exp",N("op"))}(m[0]),function($,re,se){var Ee=J($,re,"DivideBase"),Me=[Ee].concat(se),ce=d.$r(Me);Ee.$$prototype.op=L,_(Ee,"$initialize",function ve(ye,he){return ve.$$p=null,Y(this,T(this,"initialize",ve,!1,!0),"initialize",[ye,"/",he],null)}),_(Ee,"$expr",function ve(ye){return ve.$$p=null,""+Y(this,T(this,"expr",ve,!1,!0),"expr",[ye],null)+this.$rounding_method()}),_(Ee,"$output",function ve(){var ye=ve.$$p||L;return ve.$$p=null,""+Y(this,T(this,"output",ve,!1,!0),"output",[],ye)+this.$rounding_method()}),Ee.$private(),_(Ee,"$rounding_method",function(){return S(this.$class(),"ROUNDING_METHOD")}),_(Ee,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(Ee,"$calc",function(ye,he,Ie){return w(he["$zero?"]())?1:this.$divide_and_round(ye,he,Ie).$to_i()}),_(Ee,"$divide_and_round",function(ye,he,Ie){return this.$raise(ce("NotImplementedError"))})}(m[0],C("BinaryOp"),m),function($,re,se){var Ee=J($,re,"DivideWithGameSystemDefault"),Me=[Ee].concat(se),ce=d.$r(Me);j(Me[0],"ROUNDING_METHOD",""),Ee.$private(),_(Ee,"$divide_and_round",function(ve,ye,he){var Ie,be=L;return oe(S(ce("RoundType"),"CEIL"),Ie=he)?z(ve.$to_f(),ye).$ceil():oe(S(ce("RoundType"),"ROUND"),Ie)?(be=z(ve.$to_f(),ye),w(be["$negative?"]())?be.$abs().$round()["$-@"]():be.$round()):z(ve,ye).$floor()})}(m[0],C("DivideBase"),m),function($,re,se){var Ee=J($,re,"DivideWithRoundingUp"),Me=[Ee].concat(se);j(Me[0],"ROUNDING_METHOD","U"),Ee.$private(),_(Ee,"$divide_and_round",function(ke,ve,ye){return z(ke.$to_f(),ve).$ceil()})}(m[0],C("DivideBase"),m),function($,re,se){var Ee=J($,re,"DivideWithRoundingOff"),Me=[Ee].concat(se);j(Me[0],"ROUNDING_METHOD","R"),Ee.$private(),_(Ee,"$divide_and_round",function(ke,ve,ye){var he=L;return he=z(ke.$to_f(),ve),w(he["$negative?"]())?he.$abs().$round()["$-@"]():he.$round()})}(m[0],C("DivideBase"),m),function($,re,se){var Ee=J($,re,"DivideWithRoundingDown"),Me=[Ee].concat(se);j(Me[0],"ROUNDING_METHOD","F"),Ee.$private(),_(Ee,"$divide_and_round",function(ke,ve,ye){return z(ke,ve).$floor()})}(m[0],C("DivideBase"),m),function($,re){var se=J($,null,"Negate");se.$$prototype.body=L,se.$attr_reader("body"),_(se,"$initialize",q("body")),_(se,"$eval",function(ce,ke){try{return O("eval_return"),this.body.$eval(ce,ke).$to_i()["$-@"]()}catch(he){if(he===d.t_eval_return)return he.$v;throw he}}),_(se,"$include_dice?",function(){return this.body["$include_dice?"]()}),_(se,"$expr",function(ce){return"-"+this.body.$expr(ce)}),_(se,"$output",function(){return"-"+this.body.$output()}),_(se,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(m[0]),function($,re){var se=J($,null,"DiceRoll"),Ee=se.$$prototype;Ee.times=Ee.sides=L,_(se,"$initialize",function(ce,ke){return this.times=ce,this.sides=ke,this.text=L}),_(se,"$eval",function(ce,ke){try{O("eval_return");var he,Ie,be=L,ae=L;return he=this.times.$eval(ce,L),Ie=this.$eval_sides(ce),ae=(be=ke.$roll(he,Ie)).$sum(),this.text=ae+"["+be.$join(",")+"]",ae.$to_i()}catch(ue){if(ue===d.t_eval_return)return ue.$v;throw ue}}),_(se,"$include_dice?",A(!0)),_(se,"$expr",function(ce){try{return O("eval_return"),this.times.$eval(ce,L)+"D"+this.$eval_sides(ce)}catch(Ie){if(Ie===d.t_eval_return)return Ie.$v;throw Ie}}),_(se,"$output",N("text")),_(se,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"}),se.$private(),_(se,"$eval_sides",function(ce){try{return O("eval_return"),this.sides.$eval(ce,L)}catch(ye){if(ye===d.t_eval_return)return ye.$v;throw ye}})}(m[0]),function($,re){var se=J($,re,"ImplicitSidesDiceRoll");se.$$prototype.times=L,_(se,"$initialize",function(ce){return this.times=ce,this.text=L}),_(se,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"}),se.$private(),_(se,"$eval_sides",function(ce){return ce.$sides_implicit_d()})}(m[0],C("DiceRoll")),function($,re,se){var Ee=J($,null,"DiceRollWithFilter"),Me=[Ee].concat(se),ce=d.$r(Me),ke=Ee.$$prototype;ke.times=ke.n_filtering=ke.filter=ke.sides=L,j(Me[0],"Filter",ce("Struct").$new("abbr","apply")),j(Me[0],"KEEP_HIGHEST",ce("Filter").$new("KH",G(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$reverse().$take(he)})).$freeze()),j(Me[0],"KEEP_LOWEST",ce("Filter").$new("KL",G(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$take(he)})).$freeze()),j(Me[0],"DROP_HIGHEST",ce("Filter").$new("DH",G(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$reverse().$drop(he)})).$freeze()),j(Me[0],"DROP_LOWEST",ce("Filter").$new("DL",G(Ee,"lambda",[],function(ye,he){return null==ye&&(ye=L),null==he&&(he=L),ye.$drop(he)})).$freeze()),_(Ee,"$initialize",function(ye,he,Ie,be){var ae=this;return M(he,"implicit")&&X(he["$respond_to?"]("eval"))&&ae.$raise(ce("TypeError"),"sides must be a Node or :implicit ("+he.$inspect()+")"),ae.times=ye,ae.sides=he,ae.n_filtering=Ie,ae.filter=be,ae.text=L}),_(Ee,"$eval",function(ye,he){try{O("eval_return");var ae,ue,xe,be=this,y=L,W=L;return ae=be.times.$eval(ye,L),ue=be.$eval_sides(ye),xe=be.n_filtering.$eval(ye,L),y=he.$roll(ae,ue).$sort(),W=be.filter.$apply()["$[]"](y,xe).$sum(),be.text=W+"["+y.$join(",")+"]",W.$to_i()}catch(pe){if(pe===d.t_eval_return)return pe.$v;throw pe}}),_(Ee,"$include_dice?",A(!0)),_(Ee,"$implicit_sides?",function(){return this.sides["$=="]("implicit")}),_(Ee,"$expr",function(ye){try{var be,ae,ue;return O("eval_return"),be=this.times.$eval(ye,L),ae=this.$eval_sides(ye),ue=this.n_filtering.$eval(ye,L),be+"D"+ae+this.filter.$abbr()+ue}catch(xe){if(xe===d.t_eval_return)return xe.$v;throw xe}}),_(Ee,"$output",N("text")),_(Ee,"$s_exp",function(){var he,ye=this;return he=w(ye["$implicit_sides?"]())?ye.sides.$inspect():ye.sides.$s_exp(),"(DiceRollWithFilter "+ye.times.$s_exp()+" "+he+" "+ye.filter.$abbr().$inspect()+" "+ye.n_filtering.$s_exp()+")"}),Ee.$private(),_(Ee,"$eval_sides",function(ye){try{return O("eval_return"),w(this["$implicit_sides?"]())?ye.$sides_implicit_d():this.sides.$eval(ye,L)}catch(be){if(be===d.t_eval_return)return be.$v;throw be}})}(m[0],0,m),function($,re){var se=J($,null,"Parenthesis");se.$$prototype.expr=L,_(se,"$initialize",q("expr")),_(se,"$eval",function(ce,ke){try{return O("eval_return"),this.expr.$eval(ce,ke).$to_i()}catch(he){if(he===d.t_eval_return)return he.$v;throw he}}),_(se,"$include_dice?",function(){return this.expr["$include_dice?"]()}),_(se,"$expr",function(ce){return"("+this.expr.$expr(ce)+")"}),_(se,"$output",function(){return"("+this.expr.$output()+")"}),_(se,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(m[0]),function($,re,se){var Ee=J($,null,"Number"),Me=[Ee].concat(se),ce=d.$r(Me);return Ee.$$prototype.literal=L,Ee.$attr_reader("literal"),_(Ee,"$initialize",function(ye){return this.literal=ye.$to_i()}),_(Ee,"$negate",function(){return ce("Number").$new(this.literal["$-@"]())}),_(Ee,"$eval",function(ye,he){return this.literal.$to_i()}),_(Ee,"$include_dice?",A(!1)),_(Ee,"$expr",function(ye){return this.literal.$to_s()}),_(Ee,"$output",function(){return this.literal.$to_s()}),U(Ee,"s_exp","output")}(m[0],0,m)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(d){var M,S,B,g,u,p,m,C,$,re,se,Ee,Me,ve,l,c,f,D,fe,v,Q,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.truthy,w=d.eqeq,K=d.hash,G=d.const_set,A=d.to_ary,U=d.not,N=d.return_val,Y=d.neqeq,T=d.hash2,j=d.top,oe=[],z=d.nil,q=d.$$$;return j.$require("racc/parser.rb"),j.$require("bcdice/common_command/lexer"),j.$require("bcdice/common_command/add_dice/node"),M=oe,S=Q=[H(oe[0],"BCDice")].concat(M),B=v=[H(Q[0],"CommonCommand")].concat(S),D=[H(v[0],"AddDice")].concat(B),fe=d.$r(D),g=D,c=[l=J(D[0],q(fe("Racc"),"Parser"),"Parser")].concat(g),f=d.$r(c),l.$$prototype.lexer=z,_(l,"$parse",function(ae){return this.$new().$parse(ae)}),x(l,"$parse",function(ae){try{return this.lexer=f("Lexer").$new(ae),this.$do_parse()}catch(xe){if(!d.rescue(xe,[f("ParseError")]))throw xe;try{return z}finally{d.pop_exception()}}}),l.$private(),x(l,"$next_token",function(){return this.lexer.$next_token()}),x(l,"$expand_negate",function(ae,ue){if(O(ue["$is_a?"](q(f("Node"),"Negate")))){if(w(ae,"+"))return["-",ue.$body()];if(w(ae,"-"))return["+",ue.$body()]}return[ae,ue]}),u=d.large_array_unpack("14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,,13,,8,9,8,9,13,14,13,,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,,42,13,,17,18,40,39,13,,38,-28,-28,40,39,-28,,38,45,47,44,46,52,53,54,55"),p=d.large_array_unpack("16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,,13,,17,17,18,18,17,20,18,,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,,25,20,,5,5,24,24,23,,24,33,33,34,34,33,,34,32,32,32,32,39,39,40,40"),m=d.large_array_unpack("7,19,5,,34,61,-15,,7,13,,32,-1,28,,,-2,34,36,43,55,,,61,76,53,,-5,,22,48,,79,81,83,,6,,-8,90,92,,,,,,,,,,29,31,,,,,,"),C=d.large_array_unpack("-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32"),$=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,z,z,z,z,z,z,49],re=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,z,z,z,z,z,z,9],se=[z,7,8,-1,-7,-13,-6,-22,z,-12,-6,-18,z,z,z],Ee=[z,z,z,z,z,6,7,z,10,11,z,z,36,37,41],Me=d.large_array_unpack("0,0,racc_error,2,26,_reduce_1,4,26,_reduce_2,0,27,_reduce_3,1,27,_reduce_4,1,29,_reduce_none,1,29,_reduce_6,3,28,_reduce_7,3,28,_reduce_8,1,28,_reduce_none,3,30,_reduce_10,4,30,_reduce_11,1,30,_reduce_none,0,32,_reduce_13,1,32,_reduce_14,1,32,_reduce_15,1,32,_reduce_16,1,32,_reduce_17,2,31,_reduce_18,2,31,_reduce_19,1,31,_reduce_none,3,33,_reduce_21,2,33,_reduce_22,4,33,_reduce_23,2,33,_reduce_24,3,33,_reduce_25,1,33,_reduce_none,0,35,_reduce_27,1,35,_reduce_28,2,36,_reduce_29,1,36,_reduce_30,3,39,_reduce_31,3,39,_reduce_32,2,37,_reduce_33,2,37,_reduce_34,2,37,_reduce_35,2,37,_reduce_36,1,38,_reduce_none,1,38,_reduce_none,3,34,_reduce_39,1,34,_reduce_40"),ve=K(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),G(c[0],"Racc_arg",[u,p,C,m,$,re,Ee,se,25,Me,ve,58,41,!0]),G(c[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,CMP_OP,S,D,K,H,L,M,A,X,I,N,U,R,F,C,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,QUESTION,$start,command,secret,add,target,mul,unary,round_type,dice,term,explicit_or_implicit_sides,filter,filter_type,filter_type_with_shorthand,filter_shorthand")),G(c[0],"Racc_debug_parser",!1),x(l,"$_reduce_1",function(ae,ue,xe){var y,we,De=z;return we=(y=A(ae))[0]??z,O((De=y[1]??z)["$include_dice?"]())||this.$raise(f("ParseError")),q(f("Node"),"Command").$new(we,De)}),x(l,"$_reduce_2",function(ae,ue,xe){var y,we,De=z,Le=z,Ye=z;return we=(y=A(ae))[0]??z,Le=y[2]??z,Ye=y[3]??z,(U((De=y[1]??z)["$include_dice?"]())||O(Ye["$include_dice?"]())||O(Le["$nil?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"Command").$new(we,De,Le,Ye)}),x(l,"$_reduce_3",N(!1)),x(l,"$_reduce_4",N(!0)),x(l,"$_reduce_6",function(ae,ue,xe){return q(f("Node"),"UndecidedTarget").$instance()}),x(l,"$_reduce_7",function(ae,ue,xe){var y,W,we,De,Le;return we=ae["$[]"](0),W=this.$expand_negate("+",ae["$[]"](2)),De=(y=A(W))[0]??z,Le=y[1]??z,q(f("Node"),"BinaryOp").$new(we,De,Le)}),x(l,"$_reduce_8",function(ae,ue,xe){var y,W,we,De,Le;return we=ae["$[]"](0),W=this.$expand_negate("-",ae["$[]"](2)),De=(y=A(W))[0]??z,Le=y[1]??z,q(f("Node"),"BinaryOp").$new(we,De,Le)}),x(l,"$_reduce_10",function(ae,ue,xe){var y,W;return y=ae["$[]"](0),W=ae["$[]"](2),q(f("Node"),"BinaryOp").$new(y,"*",W)}),x(l,"$_reduce_11",function(ae,ue,xe){var y,W;return y=ae["$[]"](0),W=ae["$[]"](2),ae["$[]"](3).$new(y,W)}),x(l,"$_reduce_13",function(ae,ue,xe){return q(f("Node"),"DivideWithGameSystemDefault")}),x(l,"$_reduce_14",function(ae,ue,xe){return q(f("Node"),"DivideWithRoundingDown")}),x(l,"$_reduce_15",function(ae,ue,xe){return q(f("Node"),"DivideWithRoundingUp")}),x(l,"$_reduce_16",function(ae,ue,xe){return q(f("Node"),"DivideWithRoundingUp")}),x(l,"$_reduce_17",function(ae,ue,xe){return q(f("Node"),"DivideWithRoundingOff")}),x(l,"$_reduce_18",function(ae,ue,xe){return ae["$[]"](1)}),x(l,"$_reduce_19",function(ae,ue,xe){var y=z;return y=ae["$[]"](1),O(y["$is_a?"](q(f("Node"),"Negate")))?y.$body():q(f("Node"),"Negate").$new(y)}),x(l,"$_reduce_21",function(ae,ue,xe){var W=z,pe=z;return W=ae["$[]"](0),pe=ae["$[]"](2),(O(W["$include_dice?"]())||O(pe["$include_dice?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"DiceRoll").$new(W,pe)}),x(l,"$_reduce_22",function(ae,ue,xe){var W=z;return W=ae["$[]"](0),O(W["$include_dice?"]())&&this.$raise(f("ParseError")),q(f("Node"),"ImplicitSidesDiceRoll").$new(W)}),x(l,"$_reduce_23",function(ae,ue,xe){var we,W=z,pe=z,De=z;return W=ae["$[]"](0),pe=ae["$[]"](2),we=ae["$[]"](3)["$[]"]("filter"),De=ae["$[]"](3)["$[]"]("n_filtering"),Y(pe,"implicit")&&O(pe["$include_dice?"]())&&this.$raise(f("ParseError")),(O(W["$include_dice?"]())||O(De["$include_dice?"]()))&&this.$raise(f("ParseError")),q(f("Node"),"DiceRollWithFilter").$new(W,pe,De,we)}),x(l,"$_reduce_24",function(ae,ue,xe){var W,pe=z;return W=q(f("Node"),"Number").$new(1),pe=ae["$[]"](1),O(pe["$include_dice?"]())&&this.$raise(f("ParseError")),O(pe["$instance_of?"](q(f("Node"),"Number")))&&w(pe.$literal(),66)&&this.$raise(f("ParseError")),q(f("Node"),"DiceRoll").$new(W,pe)}),x(l,"$_reduce_25",function(ae,ue,xe){var W,we,y=this,pe=z,De=z;return W=q(f("Node"),"Number").$new(1),pe=ae["$[]"](1),we=ae["$[]"](2)["$[]"]("filter"),De=ae["$[]"](2)["$[]"]("n_filtering"),Y(pe,"implicit")&&O(pe["$include_dice?"]())&&y.$raise(f("ParseError")),O(De["$include_dice?"]())&&y.$raise(f("ParseError")),O(pe["$instance_of?"](q(f("Node"),"Number")))&&w(pe.$literal(),66)&&y.$raise(f("ParseError")),q(f("Node"),"DiceRollWithFilter").$new(W,pe,De,we)}),x(l,"$_reduce_27",N("implicit")),x(l,"$_reduce_28",function(ae,ue,xe){return ae["$[]"](0)}),x(l,"$_reduce_29",function(ae,ue,xe){return T(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:ae["$[]"](1)})}),x(l,"$_reduce_30",function(ae,ue,xe){return T(["filter","n_filtering"],{filter:ae["$[]"](0),n_filtering:q(f("Node"),"Number").$new(1)})}),x(l,"$_reduce_31",function(ae,ue,xe){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),x(l,"$_reduce_32",function(ae,ue,xe){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),x(l,"$_reduce_33",function(ae,ue,xe){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")}),x(l,"$_reduce_34",function(ae,ue,xe){return q(q(f("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")}),x(l,"$_reduce_35",function(ae,ue,xe){return q(q(f("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")}),x(l,"$_reduce_36",function(ae,ue,xe){return q(q(f("Node"),"DiceRollWithFilter"),"DROP_LOWEST")}),x(l,"$_reduce_39",function(ae,ue,xe){return q(f("Node"),"Parenthesis").$new(ae["$[]"](1))}),x(l,"$_reduce_40",function(ae,ue,xe){return q(f("Node"),"Number").$new(ae["$[]"](0))}),x(l,"$_reduce_none",function(ae,ue,xe){return ae["$[]"](0)})},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(d){var N,oe,M,k,v,P,B,te,Q,q,T,H=d.module,J=d.klass,_=d.const_set,x=d.def,O=d.eqeq,w=d.send,K=d.truthy,G=[],A=d.nil;return N=G,oe=T=[H(G[0],"BCDice")].concat(N),M=q=[H(T[0],"CommonCommand")].concat(oe),k=Q=[H(q[0],"AddDice")].concat(M),P=[v=J(Q[0],null,"Randomizer")].concat(k),B=d.$r(P),(te=v.$$prototype).game_system=te.rand_source=te.rand_results=A,v.$attr_reader("rand_results"),_(P[0],"RandResult",B("Struct").$new("sides","value")),x(v,"$initialize",function(fe,R){var F=this;return F.rand_source=fe,F.game_system=R,F.rand_results=[]}),x(v,"$roll",function(fe,R){var l,F=this,g=A;return g=O(R,66)?w(B("Array"),"new",[fe],function c(){var f=c.$$s??this;return null==f.rand_source&&(f.rand_source=A),null==f.game_system&&(f.game_system=A),f.rand_source.$roll_d66(f.game_system.$d66_sort_type())},{$$s:F}):O(R,9)&&K(F.game_system["$enabled_d9?"]())?w(B("Array"),"new",[fe],function c(){var f=c.$$s??this;return null==f.rand_source&&(f.rand_source=A),f.rand_source.$roll_d9()},{$$s:F}):F.rand_source.$roll_barabara(fe,R),K(F.game_system["$sort_add_dice?"]())&&g["$sort!"](),l=w(g,"map",[],function(f){return null==f&&(f=A),B("RandResult").$new(R,f)}),F.rand_results.$concat(l),g})},Opal.modules["bcdice/common_command/add_dice"]=function(d){var A,T,q,I,L,S,X,M,oe,N,H=d.module,J=d.const_set,_=d.thrower,x=d.def,O=d.top,w=[],K=d.nil;return O.$require("bcdice/normalize"),O.$require("bcdice/common_command/add_dice/parser"),O.$require("bcdice/common_command/add_dice/randomizer"),A=w,T=N=[H(w[0],"BCDice")].concat(A),q=oe=[H(N[0],"CommonCommand")].concat(T),J((M=[X=H(oe[0],"AddDice")].concat(q))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),L=[I=d.get_singleton_class(X)].concat(M),S=d.$r(L),x(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(d){var X,L,P,fe,c,f,u,p,m,F,te,k,I,H=d.module,J=d.klass,_=d.ensure_kwargs,x=d.get_kwarg,O=d.def,w=d.truthy,K=d.send,G=d.thrower,A=d.rb_lt,U=d.rb_plus,N=d.rb_gt,Y=d.eqeq,T=d.rb_le,j=d.rb_ge,oe=[],z=d.nil;return X=oe,L=I=[H(oe[0],"BCDice")].concat(X),P=k=[H(I[0],"CommonCommand")].concat(L),fe=te=[H(k[0],"RerollDice")].concat(P),c=F=[H(te[0],"Node")].concat(fe),u=[f=J(F[0],null,"Command")].concat(c),p=d.$r(u),(m=f.$$prototype).cmp_op=m.reroll_cmp_op=m.target_number_node=m.reroll_threshold_node=m.notations=m.source=z,O(f,"$initialize",function($){var re,se,Ee,Me,ce,ke,ve,ye=this;return $=_($),re=x($,"secret"),se=x($,"notations"),Ee=x($,"source"),null==(Me=$.$$smap.cmp_op)&&(Me=z),null==(ce=$.$$smap.target_number)&&(ce=z),null==(ke=$.$$smap.reroll_cmp_op)&&(ke=z),null==(ve=$.$$smap.reroll_threshold)&&(ve=z),ye.secret=re,ye.notations=se,ye.cmp_op=Me,ye.target_number_node=ce,ye.reroll_cmp_op=ke,ye.reroll_threshold_node=ve,ye.source=Ee}),O(f,"$eval",function($,re){try{G("eval_return");var Ee,Me,ke,ve,he,be,ae,xe,ce=this,ye=z,Ie=z,ue=z,y=z,W=z,pe=z,we=z,De=z;return ke=$.$round_type(),ve=w(ye=ce.cmp_op)?ye:$.$default_cmp_op(),he=w(ye=w(Ie=ce.reroll_cmp_op)?Ie:ve)?ye:">=",be=w(ye=(Ee=ce.target_number_node)===z||null==Ee?z:Ee.$eval(ke))?ye:$.$default_target_number(),ae=w(ye=w(Ie=(Me=ce.reroll_threshold_node)===z||null==Me?z:Me.$eval(ke))?Ie:$.$reroll_dice_reroll_threshold())?ye:be,ue=p("RerollCondition").$new(he,ae),xe=K(ce.notations,"map",[],function(Ye){return null==Ye&&(Ye=z),Ye.$to_dice(ke)}),w(K(xe,"all?",[],function(Ye){return null==Ye&&(Ye=z),ue["$valid?"](Ye.$sides())}))?(W=(y=ce.$roll(xe,re,ue,$["$sort_barabara_dice?"]())).$flatten(),pe=y.$take(ce.notations.$size()).$flatten().$count(1),we=w(ve)?K(W,"count",[],function(Ye){return null==Ye&&(Ye=z),Ye.$send(ve,be)}):0,De=[ce.$expr(ke,ue,ve,be),K(y,"map",[],function(Ye){return null==Ye&&(Ye=z),Ye.$join(",")}).$join(" + "),"\u6210\u529f\u6570"+we,$.$grich_text(pe,W.$size(),we)].$compact(),ce.$result_with_text(De.$join(" \uff1e "))):ce.$result_with_text(ce.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")}catch(Le){if(Le===d.t_eval_return)return Le.$v;throw Le}}),f.$private(),O(f,"$roll",function($,re,se,Ee){var Me=z,ce=z,ke=z,ve=z,ye=z,he=z;for(Me=[],ce=0;w(w(ke=$["$empty?"]()["$!"]())?A(ce,p("REROLL_LIMIT")):ke);)ve=$.$shift(),ce=U(ce,1),ye=ve.$roll(re),w(Ee)&&ye["$sort!"](),Me.$push(ye),he=K(ye,"count",[],function(be){return null==be&&(be=z),se["$reroll?"](be)}),w(N(he,0))&&$.$push(p("Dice").$new(he,ve.$sides()));return Me}),O(f,"$expr",function($,re,se,Ee){var ce,ke,ve;return ce=K(this.notations,"map",[],function(he){return null==he&&(he=z),he.$to_dice($)}).$join("+"),ke=Y(re.$cmp_op(),se)?"":p("Format").$comparison_operator(re.$cmp_op()),ve=p("Format").$comparison_operator(se),"("+ce+"["+ke+re.$threshold()+"]"+ve+Ee+")"}),O(f,"$result_with_text",function($){return K(p("Result").$new(),"tap",[],function se(Ee){var Me,ce=se.$$s??this;return null==ce.secret&&(ce.secret=z),null==Ee&&(Ee=z),Ee["$secret="](ce.secret),K(Ee,"text=",Me=[$]),Me[Me.length-1]},{$$s:this})}),function(g,l){var c=J(g,null,"RerollCondition"),f=c.$$prototype;f.threshold=f.cmp_op=z,c.$attr_reader("cmp_op"),c.$attr_reader("threshold"),O(c,"$initialize",function(p,m){return this.cmp_op=p,this.threshold=m}),O(c,"$valid?",function(p){var m=this;if(!w(m.threshold))return!1;switch(m.cmp_op){case"<=":return A(m.threshold,p);case"<":return T(m.threshold,p);case">=":return N(m.threshold,1);case">":return j(m.threshold,1);case"!=":return d.Range.$new(1,p,!1)["$include?"](m.threshold);default:return!0}}),O(c,"$reroll?",function(p){return p.$send(this.cmp_op,this.threshold)})}(F[0]),function(g,l,c){var f=J(g,null,"Notation"),u=[f].concat(c),p=d.$r(u),m=f.$$prototype;m.times=m.sides=z,O(f,"$initialize",function($,re){return this.times=$,this.sides=re}),O(f,"$to_dice",function($){try{var Ee,Me;return G("eval_return"),Ee=this.times.$eval($),Me=this.sides.$eval($),p("Dice").$new(Ee,Me)}catch(ce){if(ce===d.t_eval_return)return ce.$v;throw ce}})}(F[0],0,F),function(g,l){var c=J(g,null,"Dice");return c.$attr_reader("times","sides"),O(c,"$initialize",function(u,p){return this.times=u,this.sides=p}),O(c,"$roll",function(u){return u.$roll_barabara(this.$times(),this.$sides())}),O(c,"$to_s",function(){return this.$times()+"R"+this.$sides()})}(F[0])},Opal.modules["bcdice/arithmetic/node"]=function(d){var M,S,B,g,l,D,fe,v,Q,H=d.module,J=d.klass,_=d.def,x=d.thrower,O=d.return_ivar,w=d.send2,K=d.find_super,G=d.eqeq,A=d.const_set,U=d.eqeqeq,N=d.rb_divide,Y=d.truthy,T=d.assign_ivar,j=d.alias,oe=[],z=d.nil,q=d.$$$;return M=oe,S=Q=[H(oe[0],"BCDice")].concat(M),B=v=[H(Q[0],"Arithmetic")].concat(S),D=[H(v[0],"Node")].concat(B),fe=d.$r(D),(l=(g=J(D[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,_(g,"$initialize",function(f,u,p){var m=this;return m.lhs=f,m.op=u,m.rhs=p}),_(g,"$eval",function(f){try{x("eval_return");var C,p=this,m=z;return m=p.lhs.$eval(f),C=p.rhs.$eval(f),m.$send(p.op,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}}),_(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),_(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),_(g,"$op_for_s_exp",O("op")),function(R,F,g){var l=J(R,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,_(l,"$initialize",function p(m,C){return p.$$p=null,w(this,K(this,"initialize",p,!1,!0),"initialize",[m,"/",C],null)}),_(l,"$eval",function(m){try{x("eval_return");var re,se,$=this;return re=$.lhs.$eval(m),se=$.rhs.$eval(m),G(se,0)&&$.$raise(f("ZeroDivisionError")),$.$divide_and_round(re,se,m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),_(l,"$output",function p(){var m=p.$$p||z,C=this;return p.$$p=null,""+w(C,K(C,"output",p,!1,!0),"output",[],m)+C.$rounding_method()}),l.$private(),_(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),_(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(l,"$divide_and_round",function(m,C,$){return this.$raise(f("NotImplementedError"))})}(D[0],fe("BinaryOp"),D),function(R,F,g){var l=J(R,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);A(c[0],"ROUNDING_METHOD",""),l.$private(),_(l,"$divide_and_round",function(p,m,C){var $,re=z;return U(q(f("RoundType"),"CEIL"),$=C)?N(p.$to_f(),m).$ceil():U(q(f("RoundType"),"ROUND"),$)?(re=N(p.$to_f(),m),Y(re["$negative?"]())?re.$abs().$round()["$-@"]():re.$round()):N(p,m).$floor()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithCeil"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","C"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u.$to_f(),p).$ceil()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithRound"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","R"),l.$private(),_(l,"$divide_and_round",function(u,p,m){var C=z;return C=N(u.$to_f(),p),Y(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithFloor"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","F"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u,p).$floor()})}(D[0],fe("DivideBase"),D),function(R,F){var g=J(R,null,"Negative");g.$$prototype.body=z,_(g,"$initialize",T("body")),_(g,"$eval",function(f){try{return x("eval_return"),this.body.$eval(f)["$-@"]()}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"-"+this.body.$output()}),_(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Parenthesis");g.$$prototype.expr=z,_(g,"$initialize",T("expr")),_(g,"$eval",function(f){try{return x("eval_return"),this.expr.$eval(f)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"("+this.expr.$output()+")"}),_(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Number");return g.$$prototype.value=z,_(g,"$initialize",T("value")),_(g,"$eval",O("value")),_(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(D[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(d){var z,I,k,fe,l,c,f,u,p,m,C,$,re,Me,R,F,g,P,B,L,X,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.hash,w=d.const_set,K=d.hash2,G=d.return_val,A=d.to_ary,U=d.truthy,N=d.top,Y=[],T=d.nil,j=d.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/common_command/lexer"),N.$require("bcdice/common_command/reroll_dice/node"),N.$require("bcdice/arithmetic/node"),z=Y,I=X=[H(Y[0],"BCDice")].concat(z),k=L=[H(X[0],"CommonCommand")].concat(I),P=[H(L[0],"BarabaraDice")].concat(k),B=d.$r(P),fe=P,F=[R=J(P[0],j(B("Racc"),"Parser"),"Parser")].concat(fe),g=d.$r(F),R.$$prototype.lexer=T,_(R,"$parse",function(he){return this.$new().$parse(he)}),x(R,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(be){if(!d.rescue(be,[g("ParseError")]))throw be;try{return T}finally{d.pop_exception()}}}),R.$private(),x(R,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14"),c=d.large_array_unpack("5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7"),f=d.large_array_unpack("-6,21,-1,,56,-9,,55,1,,,,6,4,5,-5,24,,18,20,,28,,,30,32,,42,44,,,36,38,,19,,,,,"),u=d.large_array_unpack("-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19"),p=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],m=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],C=[T,1,4,8,11,-5,0,-2,-16,-13,-17],$=[T,T,T,T,T,T,T,20,16,17,T],re=d.large_array_unpack("0,0,racc_error,3,24,_reduce_1,0,25,_reduce_2,1,25,_reduce_3,0,27,_reduce_4,2,27,_reduce_5,3,26,_reduce_6,1,26,_reduce_7,3,29,_reduce_8,3,28,_reduce_9,3,28,_reduce_10,1,28,_reduce_none,3,31,_reduce_12,4,31,_reduce_13,1,31,_reduce_none,0,33,_reduce_15,1,33,_reduce_16,1,33,_reduce_17,1,33,_reduce_18,1,33,_reduce_19,2,32,_reduce_20,2,32,_reduce_21,1,32,_reduce_none,3,30,_reduce_23,1,30,_reduce_24"),Me=O(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),w(F[0],"Racc_arg",[l,c,u,f,p,m,$,C,23,re,Me,40,25,!0]),w(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,B,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,add,dice,term,mul,unary,round_type")),w(F[0],"Racc_debug_parser",!1),x(R,"$_reduce_1",function(he,Ie,be){return j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:he["$[]"](2)["$[]"]("cmp_op"),target_number:he["$[]"](2)["$[]"]("target")}))}),x(R,"$_reduce_2",G(!1)),x(R,"$_reduce_3",G(!0)),x(R,"$_reduce_4",function(he,Ie,be){return K([],{})}),x(R,"$_reduce_5",function(he,Ie,be){var ae,y,W;return W=(ae=A(he))[1]??T,U(y=ae[0]??T)||this.$raise(g("ParseError")),K(["cmp_op","target"],{cmp_op:y,target:W})}),x(R,"$_reduce_6",function(he,Ie,be){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),x(R,"$_reduce_7",function(he,Ie,be){return[he["$[]"](0)]}),x(R,"$_reduce_8",function(he,Ie,be){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(g("Node"),"Notation").$new(ae,ue)}),x(R,"$_reduce_9",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(R,"$_reduce_10",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(R,"$_reduce_12",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),x(R,"$_reduce_13",function(he,Ie,be){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),x(R,"$_reduce_15",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(R,"$_reduce_16",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(R,"$_reduce_17",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(R,"$_reduce_18",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),x(R,"$_reduce_19",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),x(R,"$_reduce_20",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_21",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(R,"$_reduce_23",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_24",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),x(R,"$_reduce_none",function(he,Ie,be){return he["$[]"](0)})},Opal.modules["bcdice/common_command/barabara_dice"]=function(d){var A,T,q,I,L,S,X,M,oe,N,H=d.module,J=d.const_set,_=d.thrower,x=d.def,w=[],K=d.nil;return d.top.$require("bcdice/common_command/barabara_dice/parser"),A=w,T=N=[H(w[0],"BCDice")].concat(A),q=oe=[H(N[0],"CommonCommand")].concat(T),J((M=[X=H(oe[0],"BarabaraDice")].concat(q))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),L=[I=d.get_singleton_class(X)].concat(M),S=d.$r(L),x(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/result"]=function(d){var oe,X,z,U,Y,J=d.klass,_=d.send,x=d.def,O=d.return_val,w=d.return_ivar,K=[],G=d.nil;return U=K,oe=Y=[(0,d.module)(K[0],"BCDice")].concat(U),[z=J(Y[0],null,"Result")].concat(oe),x(X=d.get_singleton_class(z),"$success",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),_(k,"success=",v=[!0]),v[v.length-1]})}),x(X,"$failure",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),_(k,"failure=",v=[!0]),v[v.length-1]})}),x(X,"$critical",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),k["$critical="](!0),_(k,"success=",v=[!0]),v[v.length-1]})}),x(X,"$fumble",function(Q){return _(this.$new(),"tap",[],function(k){var v;return null==k&&(k=G),k["$text="](Q),k["$fumble="](!0),_(k,"failure=",v=[!0]),v[v.length-1]})}),x(X,"$nothing",O("nothing")),x(z,"$initialize",function(M){var I=this;return null==M&&(M=G),I.text=M,I.rands=G,I.detailed_rands=G,I.secret=!1,I.success=!1,I.failure=!1,I.critical=!1,I.fumble=!1},-1),z.$attr_accessor("text","rands","detailed_rands"),z.$attr_writer("secret","success","failure","critical","fumble"),x(z,"$secret?",w("secret")),x(z,"$success?",w("success")),x(z,"$failure?",w("failure")),x(z,"$critical?",w("critical")),x(z,"$fumble?",w("fumble")),x(z,"$condition=",function(M){return this.success=M,this.failure=M["$!"]()})},Opal.modules["bcdice/common_command/tally_dice/node"]=function(d){var M,S,B,R,f,u,p,m,g,D,v,Q,H=d.module,J=d.klass,_=d.const_set,x=d.ensure_kwargs,O=d.get_kwarg,w=d.def,K=d.truthy,G=d.rb_gt,A=d.send,U=d.not,N=d.eqeq,Y=d.hash2,T=d.thrower,j=d.alias,z=[],q=d.nil;return d.top.$require("bcdice/result"),M=z,S=Q=[H(z[0],"BCDice")].concat(M),B=v=[H(Q[0],"CommonCommand")].concat(S),R=D=[H(v[0],"TallyDice")].concat(B),f=g=[H(D[0],"Node")].concat(R),p=[u=J(g[0],null,"Command")].concat(f),m=d.$r(p),u.$$prototype.notation=q,_(p[0],"MAX_SIDES",20),w(u,"$initialize",function(re){var se,Ee;return re=x(re),se=O(re,"secret"),Ee=O(re,"notation"),this.secret=se,this.notation=Ee}),w(u,"$eval",function(re,se){var Me=q,ce=q,ke=q,ve=q,ye=q,he=q;return Me=this.notation.$to_dice(re.$round_type()),K(Me["$valid?"]())?K(G(Me.$sides(),m("MAX_SIDES")))?m("Result").$new("("+Me+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+m("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(ce=Me.$roll(se),ke=(K(re["$sort_barabara_dice?"]())?ce.$sort():ce).$join(","),ve=A(A(ce,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),ye=A(d.Range.$new(1,Me.$sides(),!1),"map",[],function(be){var ae;return null==be&&(be=q),ae=ve.$fetch(be,0),N(ae,0)&&U(Me["$show_zeros?"]())?q:"["+be+"]\xd7"+ve.$fetch(be,0)}),he=["("+Me+")",ke,ye.$compact().$join(", ")].$compact(),A(m("Result").$new(),"tap",[],function Ie(be){var ae,ue=Ie.$$s??this;return null==ue.secret&&(ue.secret=q),null==be&&(be=q),be["$secret="](ue.secret),ae=[he.$join(" \uff1e ")],A(be,"text=",ae),ae[ae.length-1]},{$$s:this})):q}),function(l,c,f){var u=J(l,null,"Notation"),p=[u].concat(f),m=d.$r(p),C=u.$$prototype;C.times=C.sides=C.show_zeros=q,u.$attr_reader("times"),u.$attr_reader("sides"),u.$attr_reader("show_zeros"),w(u,"$initialize",function(re){var se,Ee,Me;return re=x(re),se=O(re,"times"),Ee=O(re,"sides"),Me=O(re,"show_zeros"),this.times=se,this.sides=Ee,this.show_zeros=Me}),w(u,"$to_dice",function(re){try{var Me,ce;return T("eval_return"),Me=this.times.$eval(re),ce=this.sides.$eval(re),m("Dice").$new(Y(["times","sides","show_zeros"],{times:Me,sides:ce,show_zeros:this.show_zeros}))}catch(ke){if(ke===d.t_eval_return)return ke.$v;throw ke}})}(g[0],0,g),function(l,c){var f=J(l,null,"Dice"),u=f.$$prototype;return u.times=u.sides=u.show_zeros=q,f.$attr_reader("times"),f.$attr_reader("sides"),f.$attr_reader("show_zeros"),j(f,"show_zeros?","show_zeros"),w(f,"$initialize",function(m){var C,$,re;return m=x(m),C=O(m,"times"),$=O(m,"sides"),re=O(m,"show_zeros"),this.times=C,this.sides=$,this.show_zeros=re}),w(f,"$valid?",function(){var C;return K(C=G(this.times,0))?G(this.sides,0):C}),w(f,"$roll",function(m){return m.$roll_barabara(this.times,this.sides)}),w(f,"$to_s",function(){var C,m=this;return C=K(m.show_zeros)?"Z":"Y",m.times+"T"+C+m.sides})}(g[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(d){var j,X,L,te,F,g,l,c,f,u,p,m,C,se,D,fe,R,k,v,I,z,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.hash,w=d.const_set,K=d.hash2,G=d.return_val,A=d.top,U=[],N=d.nil,Y=d.$$$;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/tally_dice/node"),A.$require("bcdice/arithmetic/node"),j=U,X=z=[H(U[0],"BCDice")].concat(j),L=I=[H(z[0],"CommonCommand")].concat(X),k=[H(I[0],"TallyDice")].concat(L),v=d.$r(k),te=k,fe=[D=J(k[0],Y(v("Racc"),"Parser"),"Parser")].concat(te),R=d.$r(fe),D.$$prototype.lexer=N,_(D,"$parse",function(ve){return this.$new().$parse(ve)}),x(D,"$parse",function(ve){try{return this.lexer=R("Lexer").$new(ve),this.$do_parse()}catch(he){if(!d.rescue(he,[R("ParseError")]))throw he;try{return N}finally{d.pop_exception()}}}),D.$private(),x(D,"$next_token",function(){return this.lexer.$next_token()}),F=d.large_array_unpack("8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10"),g=d.large_array_unpack("2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6"),l=d.large_array_unpack("2,23,-2,,30,,47,-1,,,-2,-7,27,,4,6,,5,,,20,22,,27,34,,,,30,34,,19,,,,,"),c=d.large_array_unpack("-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17"),f=[6,25,26,12,1,2,5,17,11,32,30,31,N,N,N,27,28,29],u=[4,8,8,7,1,2,3,5,6,9,8,8,N,N,N,4,7,7],p=[N,4,5,4,-2,-3,1,-4,-13,-22],m=[N,N,N,N,16,N,N,N,13,N],C=d.large_array_unpack("0,0,racc_error,2,18,_reduce_1,0,19,_reduce_2,1,19,_reduce_3,4,20,_reduce_4,1,22,_reduce_5,1,22,_reduce_6,3,23,_reduce_7,3,23,_reduce_8,1,23,_reduce_none,3,24,_reduce_10,4,24,_reduce_11,1,24,_reduce_none,0,26,_reduce_13,1,26,_reduce_14,1,26,_reduce_15,1,26,_reduce_16,1,26,_reduce_17,2,25,_reduce_18,2,25,_reduce_19,1,25,_reduce_none,3,21,_reduce_21,1,21,_reduce_22"),se=O(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),w(fe[0],"Racc_arg",[F,g,c,l,f,u,m,p,17,C,se,37,23,!0]),w(fe[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),w(fe[0],"Racc_debug_parser",!1),x(D,"$_reduce_1",function(ve,ye,he){return Y(R("Node"),"Command").$new(K(["secret","notation"],{secret:ve["$[]"](0),notation:ve["$[]"](1)}))}),x(D,"$_reduce_2",G(!1)),x(D,"$_reduce_3",G(!0)),x(D,"$_reduce_4",function(ve,ye,he){return Y(R("Node"),"Notation").$new(K(["times","sides","show_zeros"],{times:ve["$[]"](0),sides:ve["$[]"](3),show_zeros:ve["$[]"](2)}))}),x(D,"$_reduce_5",G(!1)),x(D,"$_reduce_6",G(!0)),x(D,"$_reduce_7",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new(ve["$[]"](0),"+",ve["$[]"](2))}),x(D,"$_reduce_8",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new(ve["$[]"](0),"-",ve["$[]"](2))}),x(D,"$_reduce_10",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new(ve["$[]"](0),"*",ve["$[]"](2))}),x(D,"$_reduce_11",function(ve,ye,he){return ve["$[]"](3).$new(ve["$[]"](0),ve["$[]"](2))}),x(D,"$_reduce_13",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(D,"$_reduce_14",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),x(D,"$_reduce_15",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),x(D,"$_reduce_16",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithRound")}),x(D,"$_reduce_17",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithFloor")}),x(D,"$_reduce_18",function(ve,ye,he){return ve["$[]"](1)}),x(D,"$_reduce_19",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Negative").$new(ve["$[]"](1))}),x(D,"$_reduce_21",function(ve,ye,he){return ve["$[]"](1)}),x(D,"$_reduce_22",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Number").$new(ve["$[]"](0))}),x(D,"$_reduce_none",function(ve,ye,he){return ve["$[]"](0)})},Opal.modules["bcdice/common_command/tally_dice"]=function(d){var A,T,q,I,L,S,X,M,oe,N,H=d.module,J=d.const_set,_=d.thrower,x=d.def,w=[],K=d.nil;return d.top.$require("bcdice/common_command/tally_dice/parser"),A=w,T=N=[H(w[0],"BCDice")].concat(A),q=oe=[H(N[0],"CommonCommand")].concat(T),J((M=[X=H(oe[0],"TallyDice")].concat(q))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),L=[I=d.get_singleton_class(X)].concat(M),S=d.$r(L),x(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/calc/node"]=function(d){var j,X,L,P,R,F,g,l,te,k,I,z,H=d.module,J=d.klass,_=d.ensure_kwargs,x=d.get_kwarg,O=d.def,w=d.truthy,K=d.send,G=d.thrower,U=[],N=d.nil,Y=d.$$$;return d.top.$require("bcdice/arithmetic/node"),j=U,X=z=[H(U[0],"BCDice")].concat(j),L=I=[H(z[0],"CommonCommand")].concat(X),P=k=[H(I[0],"Calc")].concat(L),R=te=[H(k[0],"Node")].concat(P),g=[F=J(te[0],null,"Command")].concat(R),l=d.$r(g),F.$$prototype.expr=N,O(F,"$initialize",function(u){var p,m;return u=_(u),p=x(u,"secret"),m=x(u,"expr"),this.secret=p,this.expr=m}),O(F,"$eval",function(u){try{G("eval_return");var C,$,m=this;return C=function(){try{return m.expr.$eval(u).$to_i()}catch(re){if(!d.rescue(re,[l("ZeroDivisionError")]))throw re;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{d.pop_exception()}}}(),$=w(m.expr["$is_a?"](Y(Y(l("Arithmetic"),"Node"),"Parenthesis")))?m.expr.$output():"("+m.expr.$output()+")",K(l("Result").$new(),"tap",[],function re(se){var Ee,Me=re.$$s??this;return null==Me.secret&&(Me.secret=N),null==se&&(se=N),se["$secret="](Me.secret),K(se,"text=",Ee=["c"+$+" \uff1e "+C]),Ee[Ee.length-1]},{$$s:m})}catch(re){if(re===d.t_eval_return)return re.$v;throw re}})},Opal.modules["bcdice/common_command/calc/parser"]=function(d){var j,X,L,te,F,g,l,c,f,u,p,m,C,se,D,fe,R,k,v,I,z,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.hash,w=d.const_set,K=d.hash2,G=d.return_val,A=d.top,U=[],N=d.nil,Y=d.$$$;return A.$require("racc/parser.rb"),A.$require("bcdice/common_command/lexer"),A.$require("bcdice/common_command/calc/node"),A.$require("bcdice/arithmetic/node"),j=U,X=z=[H(U[0],"BCDice")].concat(j),L=I=[H(z[0],"CommonCommand")].concat(X),k=[H(I[0],"Calc")].concat(L),v=d.$r(k),te=k,fe=[D=J(k[0],Y(v("Racc"),"Parser"),"Parser")].concat(te),R=d.$r(fe),D.$$prototype.lexer=N,_(D,"$parse",function(ve){return this.$new().$parse(ve)}),x(D,"$parse",function(ve){try{return this.lexer=R("Lexer").$new(ve),this.$do_parse()}catch(he){if(!d.rescue(he,[R("ParseError")]))throw he;try{return N}finally{d.pop_exception()}}}),D.$private(),x(D,"$next_token",function(){return this.lexer.$next_token()}),F=d.large_array_unpack("14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,,10,11,10,11,13,,13,15,16,,,,26,30,28,29,31"),g=d.large_array_unpack("5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,,17,17,18,18,17,,18,21,21,,,,21,25,25,25,25"),l=[-6,5,11,N,27,-2,N,-5,4,N,0,9,N,11,N,20,22,31,33,N,N,38,15,26,N,49,N,N,N,N,N,N],c=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],f=[7,1,19,20,22,23,2,27,21,24,25],u=[3,1,5,5,4,4,2,6,3,5,5],p=[N,1,6,-5,-11,-8,-18,N],m=[N,N,N,N,8,9,N,12],C=d.large_array_unpack("0,0,racc_error,3,15,_reduce_1,0,16,_reduce_2,1,16,_reduce_3,3,17,_reduce_4,3,17,_reduce_5,1,17,_reduce_none,3,18,_reduce_7,4,18,_reduce_8,1,18,_reduce_none,0,20,_reduce_10,1,20,_reduce_11,1,20,_reduce_12,1,20,_reduce_13,1,20,_reduce_14,2,19,_reduce_15,2,19,_reduce_16,1,19,_reduce_none,3,21,_reduce_18,1,21,_reduce_19"),se=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),w(fe[0],"Racc_arg",[F,g,c,l,f,u,m,p,14,C,se,32,20,!0]),w(fe[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),w(fe[0],"Racc_debug_parser",!1),x(D,"$_reduce_1",function(ve,ye,he){return Y(R("Node"),"Command").$new(K(["secret","expr"],{secret:ve["$[]"](0),expr:ve["$[]"](2)}))}),x(D,"$_reduce_2",G(!1)),x(D,"$_reduce_3",G(!0)),x(D,"$_reduce_4",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new(ve["$[]"](0),"+",ve["$[]"](2))}),x(D,"$_reduce_5",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new(ve["$[]"](0),"-",ve["$[]"](2))}),x(D,"$_reduce_7",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"BinaryOp").$new(ve["$[]"](0),"*",ve["$[]"](2))}),x(D,"$_reduce_8",function(ve,ye,he){return ve["$[]"](3).$new(ve["$[]"](0),ve["$[]"](2))}),x(D,"$_reduce_10",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(D,"$_reduce_11",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),x(D,"$_reduce_12",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithCeil")}),x(D,"$_reduce_13",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithRound")}),x(D,"$_reduce_14",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"DivideWithFloor")}),x(D,"$_reduce_15",function(ve,ye,he){return ve["$[]"](1)}),x(D,"$_reduce_16",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Negative").$new(ve["$[]"](1))}),x(D,"$_reduce_18",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Parenthesis").$new(ve["$[]"](1))}),x(D,"$_reduce_19",function(ve,ye,he){return Y(Y(R("Arithmetic"),"Node"),"Number").$new(ve["$[]"](0))}),x(D,"$_reduce_none",function(ve,ye,he){return ve["$[]"](0)})},Opal.modules["bcdice/common_command/calc"]=function(d){var A,T,q,I,L,S,X,M,oe,N,H=d.module,J=d.const_set,_=d.thrower,x=d.def,w=[],K=d.nil;return d.top.$require("bcdice/common_command/calc/parser"),A=w,T=N=[H(w[0],"BCDice")].concat(A),q=oe=[H(N[0],"CommonCommand")].concat(T),J((M=[X=H(oe[0],"Calc")].concat(q))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),L=[I=d.get_singleton_class(X)].concat(M),S=d.$r(L),x(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P.$round_type())}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/choice"]=function(d){var I,k,D,c,u,fe,R,F,g,P,L,H=d.module,J=d.klass,_=d.const_set,x=d.hash2,O=d.def,w=d.truthy,K=d.eqeq,G=d.eqeqeq,A=d.send,U=d.rb_lt,N=d.thrower,Y=d.rb_gt,T=d.ensure_kwargs,j=d.get_kwarg,z=[],q=d.nil,X=d.$$$;return d.top.$require("strscan"),I=z,k=L=[H(z[0],"BCDice")].concat(I),D=P=[H(L[0],"CommonCommand")].concat(k),R=[fe=J(P[0],null,"Choice")].concat(D),F=d.$r(R),(g=fe.$$prototype).items=g.takes=g.block_delimiter=q,_(R[0],"PREFIX_PATTERN",/choice/.$freeze()),c=R,_((u=[H(R[0],"BlockDelimiter")].concat(c))[0],"BRACKET","bracket"),_(u[0],"PAREN","paren"),_(u[0],"SPACE","space"),_(R[0],"DELIMITER",x(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),_(R[0],"DELIMITER_CHAR",x(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),_(R[0],"TERMINATION",x(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),_(R[0],"SUFFIX",x(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(l,c){var f=[l].concat(c),u=d.$r(f);O(l,"$eval",function(m,C,$){var re;return(re=this.$parse(m))===q||null==re?q:re.$roll($)}),l.$private(),O(l,"$parse",function(m){try{var $,Ee,ke,ve,ye,C=N("return"),se=q,Me=q,ce=q,he=q,Ie=q,be=q;if((se=u("StringScanner").$new(m)).$skip(/\s+/),Ee=se.$scan(/S/i)["$nil?"]()["$!"](),!w(se.$scan(/choice/i))||(Me=w(ce=($=se.$scan(/\d+/))===q||null==$?q:$.$to_i())?ce:1,K(Me,0)))return q;for(ke=G("[",ce=se.$scan(/\(|\[|\s+/))?X(u("BlockDelimiter"),"BRACKET"):G("(",ce)?X(u("BlockDelimiter"),"PAREN"):G(u("String"),ce)?X(u("BlockDelimiter"),"SPACE"):void C.$throw(),ve=u("DELIMITER")["$[]"](ke),ye=u("TERMINATION")["$[]"](ke),he=[];w(Ie=se.$scan_until(ve));)he.$push(Ie.$delete_suffix(","));return be=se.$scan_until(ye),!w(be)||(he.$push(be.$delete_suffix(u("SUFFIX")["$[]"](ke))),he=A(A(he,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),K(he.$size(),1)&&(he=this.$parse_multi_item_shorthand(he.$first())),w(he["$empty?"]())||w(U(he.$size(),Me)))?q:this.$new(x(["secret","block_delimiter","takes","items"],{secret:Ee,block_delimiter:ke,takes:Me,items:he}))}catch(ae){if(ae===C)return ae.$v;throw ae}}),O(l,"$parse_multi_item_shorthand",function(m){var $,re;return w($=w(re=this.$parse_multi_nums_shorthand(m))?re:this.$parse_multi_chars_shorthand(m))?$:[]}),O(l,"$parse_multi_nums_shorthand",function(m){var C=q,$=q,re=q;return C=/^(\d+)-(\d+)$/.$match(m),!w(C)||($=C["$[]"](1).$to_i(),re=C["$[]"](2).$to_i(),w(Y($,re)))?q:$.$upto(re).$to_a()}),O(l,"$parse_multi_chars_shorthand",function(m){var $,C=q,re=q,se=q;return C=w($=/^([a-z])-([a-z])$/.$match(m))?$:/^([A-Z])-([A-Z])$/.$match(m),!w(C)||(re=C["$[]"](1),se=C["$[]"](2),w(Y(re,se)))?q:re.$upto(se).$to_a()})}(d.get_singleton_class(fe),R),O(fe,"$initialize",function(c){var f,u,p,m,C=this;return c=T(c),f=j(c,"secret"),u=j(c,"block_delimiter"),p=j(c,"takes"),m=j(c,"items"),C.secret=f,C.block_delimiter=u,C.takes=p,C.items=m}),O(fe,"$roll",function(c){var f=this,u=q,p=q;return w(Y(f.items.$size(),100))?F("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(u=f.items.$dup(),p=[],A(f.takes,"times",[],function(){var C;return C=c.$roll_index(u.$size()),p["$<<"](u.$delete_at(C))}),A(F("Result").$new(),"tap",[],function m(C){var $,se,re=m.$$s??this;return null==re.block_delimiter&&(re.block_delimiter=q),null==re.secret&&(re.secret=q),null==C&&(C=q),se=p.$join(F("DELIMITER_CHAR")["$[]"](re.block_delimiter)),C["$secret="](re.secret),$=["("+re.$expr()+") \uff1e "+se],A(C,"text=",$),$[$.length-1]},{$$s:f}))}),O(fe,"$expr",function(){var f,u,c=this;return f=K(c.takes,1)?q:c.takes,G(X(F("BlockDelimiter"),"SPACE"),u=c.block_delimiter)?"choice"+f+" "+c.items.$join(" "):G(X(F("BlockDelimiter"),"BRACKET"),u)?"choice"+f+"["+c.items.$join(",")+"]":G(X(F("BlockDelimiter"),"PAREN"),u)?"choice"+f+"("+c.items.$join(",")+")":q})},Opal.modules["bcdice/common_command/d66_dice"]=function(d){var X,L,B,F,l,c,te,D,fe,k,I,H=d.module,J=d.klass,_=d.const_set,x=d.thrower,O=d.def,w=d.truthy,K=d.hash2,G=d.ensure_kwargs,A=d.get_kwarg,U=d.send,N=d.eqeqeq,Y=d.rb_plus,T=d.rb_times,j=[],oe=d.nil,z=d.$$$;return X=j,L=I=[H(j[0],"BCDice")].concat(X),B=k=[H(I[0],"CommonCommand")].concat(L),D=[te=J(k[0],null,"D66Dice")].concat(B),fe=d.$r(D),te.$$prototype.sort_type=oe,_(D[0],"PREFIX_PATTERN",/D66/.$freeze()),l=[F=d.get_singleton_class(te)].concat(D),c=d.$r(l),O(F,"$eval",function(u,p,m){try{var $;return x("eval_return"),($=this.$parse(u,p))===oe||null==$?oe:$.$eval(m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),F.$private(),O(F,"$parse",function(u,p){var C=oe,$=oe;return u=u.$split(" ",2).$first(),C=/^(S)?D66([ANSD])?$/i.$match(u.$upcase()),w(C)?this.$new(K(["secret","sort_type","suffix"],{secret:C["$[]"](1)["$nil?"]()["$!"](),sort_type:w($=this.$sort_type_from_suffix(C["$[]"](2)))?$:p.$d66_sort_type(),suffix:C["$[]"](2)})):oe}),O(F,"$sort_type_from_suffix",function(u){switch(u){case"A":case"S":return z(c("D66SortType"),"ASC");case"D":return z(c("D66SortType"),"DESC");case"N":return z(c("D66SortType"),"NO_SORT");default:return oe}}),O(te,"$initialize",function(g){var l,c,f,u=this;return g=G(g),l=A(g,"secret"),c=A(g,"sort_type"),f=A(g,"suffix"),u.secret=l,u.sort_type=c,u.suffix=f}),O(te,"$eval",function(g){var c;return c=this.$roll(g),U(fe("Result").$new(),"tap",[],function f(u){var p,m=f.$$s??this;return null==m.secret&&(m.secret=oe),null==m.suffix&&(m.suffix=oe),null==u&&(u=oe),u["$secret="](m.secret),U(u,"text=",p=["(D66"+m.suffix+") \uff1e "+c]),p[p.length-1]},{$$s:this})}),te.$private(),O(te,"$roll",function(g){var f,c=oe;return c=U(fe("Array"),"new",[2],function(){return g.$roll_once(6)}),N(z(fe("D66SortType"),"ASC"),f=this.sort_type)?c["$sort!"]():N(z(fe("D66SortType"),"DESC"),f)&&c["$sort!"]()["$reverse!"](),Y(T(c["$[]"](0),10),c["$[]"](1))})},Opal.modules["bcdice/common_command/repeat"]=function(d){var q,Q,P,R,g,l,B,te,D,fe,S,M,H=d.module,J=d.klass,_=d.const_set,x=d.def,O=d.truthy,w=d.hash2,K=d.ensure_kwargs,G=d.get_kwarg,A=d.send,U=d.eqeq,N=d.thrower,Y=d.rb_lt,j=[],oe=d.nil;return d.top.$require("strscan"),q=j,Q=M=[H(j[0],"BCDice")].concat(q),P=S=[H(M[0],"CommonCommand")].concat(Q),te=[B=J(S[0],null,"Repeat")].concat(P),D=d.$r(te),(fe=B.$$prototype).times=fe.trailer=fe.secret=oe,_(te[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),_(te[0],"REPEAT_LIMIT",100),g=[R=d.get_singleton_class(B)].concat(te),l=d.$r(g),x(R,"$eval",function(f,u,p){var m;return(m=this.$parse(f))===oe||null==m?oe:m.$roll(u,p)}),R.$private(),x(R,"$parse",function(f){var u,C,m=oe,$=oe,re=oe,se=oe,Ee=oe;return C=(m=l("StringScanner").$new(f)).$scan(/s/i)["$nil?"]()["$!"](),$=m.$scan(/repeat|rep|x/i),re=(u=m.$scan(/\d+/))===oe||null==u?oe:u.$to_i(),se=m.$scan(/\s+/),O($["$nil?"]())||O(re["$nil?"]())||O(se["$nil?"]())||(Ee=m.$post_match(),O(Ee["$nil?"]())||O(Ee["$empty?"]()))?oe:this.$new(w(["secret","times","trailer"],{secret:C,times:re,trailer:Ee}))}),x(B,"$initialize",function(F){var g,l,c,f=this;return F=K(F),g=G(F,"secret"),l=G(F,"times"),c=G(F,"trailer"),f.secret=g,f.times=l,f.trailer=c}),x(B,"$roll",function(F,g){try{N("eval_return");var f,c=this,u=oe,p=oe,m=oe,C=oe;return f=c.$validate(),O(f)?f:(u=A(D("Array"),"new",[c.times],function $(){var re=$.$$s??this,se=oe;return null==re.trailer&&(re.trailer=oe),(se=F.$class().$new(re.trailer))["$randomizer="](g),se.$eval()},{$$s:c}),U(A(u,"count",[],function(re){return null==re&&(re=oe),re["$=="](oe)}),c.times)?c.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+c.trailer+")"):(p=A(u.$map(),"with_index",[1],function(re,se){return null==re&&(re=oe),null==se&&(se=oe),"#"+se+"\n"+re.$text()}).$join("\n\n"),m=O(C=c.secret)?C:A(u,"any?",[],"secret?".$to_proc()),A(D("Result").$new(),"tap",[],function(re){var se;return null==re&&(re=oe),re["$secret="](m),A(re,"text=",se=[p]),se[se.length-1]})))}catch($){if($===d.t_eval_return)return $.$v;throw $}}),B.$private(),x(B,"$validate",function(){var F=this;return O(/^(repeat|rep|x)\d+/["$match?"](F.trailer))?F.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):O(Y(F.times,1))||O(Y(D("REPEAT_LIMIT"),F.times))?F.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+D("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):oe}),x(B,"$result_with_text",function(F){return A(D("Result").$new(),"tap",[],function l(c){var f,u=l.$$s??this;return null==u.secret&&(u.secret=oe),null==c&&(c=oe),c["$secret="](u.secret),A(c,"text=",f=[F]),f[f.length-1]},{$$s:this})})},Opal.modules["bcdice/format"]=function(d){var U,j,oe,z,q,Y,H=d.module,J=d.eqeqeq,_=d.def,x=d.truthy,O=d.eqeq,w=d.rb_gt,K=[],G=d.nil;return U=K,j=Y=[H(K[0],"BCDice")].concat(U),z=[oe=H(Y[0],"Format")].concat(j),q=d.$r(z),oe.$module_function(),_(oe,"$comparison_operator",function(M){var I;return J("==",I=M)?"=":J("!=",I)?"<>":J(q("Symbol"),I)?M.$to_s():G}),_(oe,"$modifier",function(M){return x(M["$nil?"]())?G:O(M,0)?"":x(w(M,0))?"+"+M:M.$to_s()})},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(d){var N,oe,M,k,q,T,H=d.module,J=d.klass,_=d.send2,x=d.find_super,O=d.def,K=[],G=d.nil,A=d.$$$;return d.top.$require("bcdice/result"),N=K,oe=T=[H(K[0],"BCDice")].concat(N),M=q=[H(T[0],"CommonCommand")].concat(oe),(k=J([H(q[0],"BarabaraDice")].concat(M)[0],A(A("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),k.$attr_accessor("last_dice_list"),k.$attr_accessor("success_num"),O(k,"$initialize",function v(P){var te=this;return v.$$p=null,null==P&&(P=G),_(te,x(te,"initialize",v,!1,!0),"initialize",[P],null),te.last_dice_list_list=[],te.last_dice_list=[],te.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(d){var T,q,Q,v,fe,R,F,g,l,B,S,M,oe,H=d.module,J=d.klass,_=d.ensure_kwargs,x=d.get_kwarg,O=d.def,w=d.send,K=d.truthy,G=d.thrower,A=d.top,U=[],N=d.nil;return A.$require("bcdice/format"),A.$require("bcdice/common_command/barabara_dice/result"),T=U,q=oe=[H(U[0],"BCDice")].concat(T),Q=M=[H(oe[0],"CommonCommand")].concat(q),v=S=[H(M[0],"BarabaraDice")].concat(Q),fe=B=[H(S[0],"Node")].concat(v),F=[R=J(B[0],null,"Command")].concat(fe),g=d.$r(F),(l=R.$$prototype).notations=l.cmp_op=l.target_number=N,O(R,"$initialize",function(f){var u,p,m,C,$=this;return f=_(f),u=x(f,"secret"),p=x(f,"notations"),m=x(f,"cmp_op"),C=x(f,"target_number"),$.secret=u,$.notations=p,$.cmp_op=m,$.target_number=C}),O(R,"$eval",function(f,u){try{G("eval_return");var m,$,se,Me,ve,ye,C=this,re=N,Ee=N,ce=N,ke=N,he=N,Ie=N;return $=f.$round_type(),re=w(C.notations,"map",[],function(ae){return null==ae&&(ae=N),ae.$to_dice($)}),se=K(Ee=C.cmp_op)?Ee:f.$default_cmp_op(),Me=K(Ee=(m=C.target_number)===N||null==m?N:m.$eval($))?Ee:f.$default_target_number(),ce=w(re,"map",[],function(ae){return null==ae&&(ae=N),ae.$roll(u)}),K(f["$sort_barabara_dice?"]())&&w(ce,"map!",[],"sort".$to_proc()),ve=(ke=ce.$flatten()).$count(1),ye=K(se)?w(ke,"count",[],function(ae){return null==ae&&(ae=N),ae.$send(se,Me)}):0,K(se)&&(he="\u6210\u529f\u6570"+ye),Ie=["("+re.$join("+")+g("Format").$comparison_operator(se)+Me+")",ke.$join(","),he,f.$grich_text(ve,ke.$size(),ye)].$compact(),w(g("Result").$new(),"tap",[],function be(ae){var ue,xe=be.$$s??this;return null==xe.secret&&(xe.secret=N),null==ae&&(ae=N),ae["$secret="](xe.secret),ae["$text="](Ie.$join(" \uff1e ")),ae["$last_dice_list_list="](ce),ae["$last_dice_list="](ke),w(ae,"success_num=",ue=[ye]),ue[ue.length-1]},{$$s:C})}catch(be){if(be===d.t_eval_return)return be.$v;throw be}}),function(te,D,fe){var R=J(te,null,"Notation"),F=[R].concat(fe),g=d.$r(F),l=R.$$prototype;l.times=l.sides=N,O(R,"$initialize",function(f,u){return this.times=f,this.sides=u}),O(R,"$to_dice",function(f){try{var m,C;return G("eval_return"),m=this.times.$eval(f),C=this.sides.$eval(f),g("Dice").$new(m,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}})}(B[0],0,B),function(te,D){var fe=J(te,null,"Dice"),R=fe.$$prototype;return R.times=R.sides=N,O(fe,"$initialize",function(g,l){return this.times=g,this.sides=l}),O(fe,"$roll",function(g){return g.$roll_barabara(this.times,this.sides)}),O(fe,"$to_s",function(){return this.times+"B"+this.sides})}(B[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(d){var z,I,k,fe,l,c,f,u,p,m,C,$,re,Me,R,F,g,P,B,L,X,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.hash,w=d.const_set,K=d.hash2,G=d.return_val,A=d.to_ary,U=d.truthy,N=d.top,Y=[],T=d.nil,j=d.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/common_command/lexer"),N.$require("bcdice/common_command/barabara_dice/node"),N.$require("bcdice/arithmetic/node"),z=Y,I=X=[H(Y[0],"BCDice")].concat(z),k=L=[H(X[0],"CommonCommand")].concat(I),P=[H(L[0],"RerollDice")].concat(k),B=d.$r(P),fe=P,F=[R=J(P[0],j(B("Racc"),"Parser"),"Parser")].concat(fe),g=d.$r(F),R.$$prototype.lexer=T,_(R,"$parse",function(he){return this.$new().$parse(he)}),x(R,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(be){if(!d.rescue(be,[g("ParseError")]))throw be;try{return T}finally{d.pop_exception()}}}),R.$private(),x(R,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,,8,34,35,9,20,21,31,32,8,20,21,9,,8,,31,32,20,21,31,32,8,40,,,,47,51,49,50,52"),c=d.large_array_unpack("14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,,32,43,43,35,34,34,46,46,34,35,35,39,,35,,27,27,39,39,41,41,39,27,,,,41,45,45,45,45"),f=d.large_array_unpack("-6,17,1,,20,-3,,30,14,,,18,30,22,-2,2,13,19,30,,27,35,,,0,,37,72,40,,,48,53,,61,66,,,45,74,,76,48,56,,89,63,,,,,,"),u=d.large_array_unpack("-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25"),p=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,T,T,T,T,T,T,T,46],m=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,T,T,T,T,T,T,T,7],C=[T,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],$=[T,T,T,T,T,T,T,T,T,22,18,19,T],re=d.large_array_unpack("0,0,racc_error,3,23,_reduce_1,4,23,_reduce_2,4,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,2,26,_reduce_7,3,27,_reduce_8,4,27,_reduce_9,2,28,_reduce_10,3,28,_reduce_11,3,25,_reduce_12,1,25,_reduce_13,3,30,_reduce_14,3,29,_reduce_15,3,29,_reduce_16,1,29,_reduce_none,3,32,_reduce_18,4,32,_reduce_19,1,32,_reduce_none,0,34,_reduce_21,1,34,_reduce_22,1,34,_reduce_23,1,34,_reduce_24,1,34,_reduce_25,2,33,_reduce_26,2,33,_reduce_27,1,33,_reduce_none,3,31,_reduce_29,1,31,_reduce_30"),Me=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),w(F[0],"Racc_arg",[l,c,u,f,p,m,$,C,22,re,Me,53,31,!0]),w(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,target,bracket,at,add,dice,term,mul,unary,round_type")),w(F[0],"Racc_debug_parser",!1),x(R,"$_reduce_1",function(he,Ie,be){return j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:he["$[]"](2)["$[]"]("cmp_op"),target_number:he["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))}),x(R,"$_reduce_2",function(he,Ie,be){var ue=T,xe=T;return ue=he["$[]"](3),xe=he["$[]"](2),j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:ue["$[]"]("cmp_op"),target_number:ue["$[]"]("target"),reroll_cmp_op:xe["$[]"]("cmp_op"),reroll_threshold:xe["$[]"]("threshold"),source:this.lexer.$source()}))}),x(R,"$_reduce_3",function(he,Ie,be){var ue=T,xe=T;return ue=he["$[]"](2),xe=he["$[]"](3),j(g("Node"),"Command").$new(K(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:he["$[]"](0),notations:he["$[]"](1),cmp_op:ue["$[]"]("cmp_op"),target_number:ue["$[]"]("target"),reroll_cmp_op:xe["$[]"]("cmp_op"),reroll_threshold:xe["$[]"]("threshold"),source:this.lexer.$source()}))}),x(R,"$_reduce_4",G(!1)),x(R,"$_reduce_5",G(!0)),x(R,"$_reduce_6",function(he,Ie,be){return K([],{})}),x(R,"$_reduce_7",function(he,Ie,be){var ae,y,W;return W=(ae=A(he))[1]??T,U(y=ae[0]??T)||this.$raise(g("ParseError")),K(["cmp_op","target"],{cmp_op:y,target:W})}),x(R,"$_reduce_8",function(he,Ie,be){return K(["threshold"],{threshold:he["$[]"](1)})}),x(R,"$_reduce_9",function(he,Ie,be){var ue,xe;return ue=he["$[]"](1),xe=he["$[]"](2),U(ue)||this.$raise(g("ParseError")),K(["cmp_op","threshold"],{cmp_op:ue,threshold:xe})}),x(R,"$_reduce_10",function(he,Ie,be){return K(["threshold"],{threshold:he["$[]"](1)})}),x(R,"$_reduce_11",function(he,Ie,be){var ue,xe;return ue=he["$[]"](1),xe=he["$[]"](2),U(ue)||this.$raise(g("ParseError")),K(["cmp_op","threshold"],{cmp_op:ue,threshold:xe})}),x(R,"$_reduce_12",function(he,Ie,be){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),x(R,"$_reduce_13",function(he,Ie,be){return[he["$[]"](0)]}),x(R,"$_reduce_14",function(he,Ie,be){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(g("Node"),"Notation").$new(ae,ue)}),x(R,"$_reduce_15",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(R,"$_reduce_16",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(R,"$_reduce_18",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),x(R,"$_reduce_19",function(he,Ie,be){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),x(R,"$_reduce_21",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(R,"$_reduce_22",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(R,"$_reduce_23",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(R,"$_reduce_24",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),x(R,"$_reduce_25",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),x(R,"$_reduce_26",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_27",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(R,"$_reduce_29",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_30",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),x(R,"$_reduce_none",function(he,Ie,be){return he["$[]"](0)})},Opal.modules["bcdice/common_command/reroll_dice"]=function(d){var A,T,q,I,L,S,X,M,oe,N,H=d.module,J=d.const_set,_=d.thrower,x=d.def,O=d.top,w=[],K=d.nil;return O.$require("bcdice/normalize"),O.$require("bcdice/format"),O.$require("bcdice/common_command/reroll_dice/parser"),A=w,T=N=[H(w[0],"BCDice")].concat(A),q=oe=[H(N[0],"CommonCommand")].concat(T),J((M=[X=H(oe[0],"RerollDice")].concat(q))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),J(M[0],"REROLL_LIMIT",1e4),L=[I=d.get_singleton_class(X)].concat(M),S=d.$r(L),x(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/upper_dice/node"]=function(d){var q,Q,v,D,l,c,f,u,p,R,B,S,M,H=d.module,J=d.klass,_=d.ensure_kwargs,x=d.get_kwarg,O=d.def,w=d.send,K=d.truthy,G=d.rb_le,A=d.thrower,U=d.rb_plus,N=d.eqeq,Y=d.hash2,T=d.rb_lt,j=[],oe=d.nil;return q=j,Q=M=[H(j[0],"BCDice")].concat(q),v=S=[H(M[0],"CommonCommand")].concat(Q),D=B=[H(S[0],"UpperDice")].concat(v),l=R=[H(B[0],"Node")].concat(D),f=[c=J(R[0],null,"Command")].concat(l),u=d.$r(f),(p=c.$$prototype).notations=p.reroll_threshold=p.modifier=p.target_number=p.cmp_op=oe,O(c,"$initialize",function(C){var $,re,se,Ee,Me,ce,ke=this;return C=_(C),$=x(C,"secret"),re=x(C,"notations"),se=x(C,"modifier"),Ee=x(C,"cmp_op"),Me=x(C,"target_number"),null==(ce=C.$$smap.reroll_threshold)&&(ce=oe),ke.secret=$,ke.notations=re,ke.modifier=se,ke.cmp_op=Ee,ke.target_number=Me,ke.reroll_threshold=ce}),O(c,"$eval",function(C,$){try{A("eval_return");var se,Ee,Me,ke,ve,ye,be,ue,Ie,ae,ce=this,he=oe,xe=oe,y=oe,W=oe;return ke=C.$round_type(),ve=w(ce.notations,"map",[],function(we){return null==we&&(we=oe),we.$to_dice(ke)}),ye=K(he=K(Ie=(se=ce.reroll_threshold)===oe||null==se?oe:se.$eval(ke))?Ie:C.$upper_dice_reroll_threshold())?he:0,be=K(he=(Ee=ce.modifier)===oe||null==Ee?oe:Ee.$eval(ke))?he:0,ae=(Me=ce.target_number)===oe||null==Me?oe:Me.$eval(ke),ue=ce.$expr(ve,ye,be,ae),K(G(ye,1))?ce.$result_with_text("("+ue+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):(xe=w(ve,"map",[],function(we){return null==we&&(we=oe),we.$roll($,ye,C["$sort_barabara_dice?"]())}).$reduce([],"concat"),y=K(ce.cmp_op)?ce.$result_success_count(xe,be,ae):ce.$result_max_sum(xe,be),W=["("+ue+")",ce.$interlim_expr(xe,be),y],ce.$result_with_text(W.$join(" \uff1e ")))}catch(pe){if(pe===d.t_eval_return)return pe.$v;throw pe}}),c.$private(),O(c,"$result_success_count",function(C,$,re){return"\u6210\u529f\u6570"+w(C,"count",[],function Me(ce){var ke=Me.$$s??this;return null==ke.cmp_op&&(ke.cmp_op=oe),null==ce&&(ce=oe),U(ce["$[]"]("sum"),$).$send(ke.cmp_op,re)},{$$s:this})}),O(c,"$result_max_sum",function(C,$){var se,re=oe;return re=w(C,"map",[],function(ce){return null==ce&&(ce=oe),ce["$[]"]("sum")}),se=U(re.$sum(),$),w(re,"map",[],function(ce){return null==ce&&(ce=oe),U(ce,$)}).$max()+"/"+se+"(\u6700\u5927/\u5408\u8a08)"}),O(c,"$interlim_expr",function(C,$){var re;return re=w(C,"map",[],function(Ee){return null==Ee&&(Ee=oe),N(Ee["$[]"]("list").$size(),1)?Ee["$[]"]("sum"):Ee["$[]"]("sum")+"["+Ee["$[]"]("list").$join(",")+"]"}).$join(","),U(re,u("Format").$modifier($))}),O(c,"$expr",function(C,$,re,se){var Me,ce;return Me=u("Format").$comparison_operator(this.cmp_op),ce=u("Format").$modifier(re),C.$join("+")+"["+$+"]"+ce+Me+se}),O(c,"$result_with_text",function(C){return w(u("Result").$new(),"tap",[],function re(se){var Ee,Me=re.$$s??this;return null==Me.secret&&(Me.secret=oe),null==se&&(se=oe),se["$secret="](Me.secret),w(se,"text=",Ee=[C]),Ee[Ee.length-1]},{$$s:this})}),function(F,g,l){var c=J(F,null,"Notation"),f=[c].concat(l),u=d.$r(f),p=c.$$prototype;p.roll_times=p.sides=oe,O(c,"$initialize",function(C,$){return this.roll_times=C,this.sides=$}),O(c,"$to_dice",function(C){try{var se,Ee;return A("eval_return"),se=this.roll_times.$eval(C),Ee=this.sides.$eval(C),u("Dice").$new(se,Ee)}catch(Me){if(Me===d.t_eval_return)return Me.$v;throw Me}})}(R[0],0,R),function(F,g,l){var c=J(F,null,"Dice"),f=[c].concat(l),u=d.$r(f),p=c.$$prototype;return p.roll_times=p.sides=oe,O(c,"$initialize",function(C,$){return this.roll_times=C,this.sides=$}),O(c,"$roll",function(C,$,re){var Ee=oe;return Ee=w(u("Array"),"new",[this.roll_times],function Me(){var ke=oe;return ke=(Me.$$s??this).$roll_ones(C,$),Y(["sum","list"],{sum:ke.$sum(),list:ke})},{$$s:this}),K(re)&&(Ee=w(Ee,"sort_by",[],function(ce){return null==ce&&(ce=oe),ce["$[]"]("sum")})),Ee}),O(c,"$to_s",function(){return this.roll_times+"U"+this.sides}),c.$private(),O(c,"$roll_ones",function(C,$){var re=this,se=oe;return se=[],function(){try{var Ee=A("break");w(re,"loop",[],function Me(){var ke,ce=Me.$$s??this;if(null==ce.sides&&(ce.sides=oe),ke=C.$roll_once(ce.sides),se.$push(ke),!K(T(ke,$)))return oe;Ee.$throw()},{$$s:re})}catch(Me){if(Me===Ee)return Me.$v;throw Me}}(),se})}(R[0],0,R)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(d){var z,I,k,fe,l,c,f,u,p,m,C,$,re,Me,R,F,g,P,B,L,X,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.hash,w=d.const_set,K=d.hash2,G=d.return_val,A=d.to_ary,U=d.truthy,N=d.top,Y=[],T=d.nil,j=d.$$$;return N.$require("racc/parser.rb"),N.$require("bcdice/common_command/lexer"),N.$require("bcdice/common_command/upper_dice/node"),N.$require("bcdice/arithmetic/node"),z=Y,I=X=[H(Y[0],"BCDice")].concat(z),k=L=[H(X[0],"CommonCommand")].concat(I),P=[H(L[0],"UpperDice")].concat(k),B=d.$r(P),fe=P,F=[R=J(P[0],j(B("Racc"),"Parser"),"Parser")].concat(fe),g=d.$r(F),R.$$prototype.lexer=T,_(R,"$parse",function(he){return this.$new().$parse(he)}),x(R,"$parse",function(he){try{return this.lexer=g("Lexer").$new(he),this.$do_parse()}catch(be){if(!d.rescue(be,[g("ParseError")]))throw be;try{return T}finally{d.pop_exception()}}}),R.$private(),x(R,"$next_token",function(){return this.lexer.$next_token()}),l=d.large_array_unpack("9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,,8,39,40,,21,22,39,40,8,58,56,57,59,36,37"),c=d.large_array_unpack("2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,,40,50,50,,44,44,51,51,44,53,53,53,53,54,54"),f=d.large_array_unpack("-3,22,-2,,28,9,,32,-1,,,20,35,40,4,12,17,3,22,46,,25,30,,34,38,46,43,51,56,51,,76,59,-6,,64,69,,77,82,,,,90,66,,72,77,,85,90,,100,99,,,,,"),u=d.large_array_unpack("-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29"),p=d.large_array_unpack("18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,,,,,,,,54"),m=d.large_array_unpack("10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,,,,,,,,10"),C=[T,7,9,8,7,-6,6,2,T,-13,-8,4,11,-18,-26],$=[T,T,T,T,T,T,T,T,13,19,T,T,23,20,T],re=d.large_array_unpack("0,0,racc_error,4,23,_reduce_1,5,23,_reduce_2,5,23,_reduce_3,0,24,_reduce_4,1,24,_reduce_5,0,26,_reduce_6,1,26,_reduce_7,2,30,_reduce_8,2,30,_reduce_9,3,30,_reduce_10,3,30,_reduce_11,0,27,_reduce_12,2,27,_reduce_13,3,28,_reduce_14,2,29,_reduce_15,3,25,_reduce_16,1,25,_reduce_17,3,33,_reduce_18,3,32,_reduce_19,3,32,_reduce_20,1,32,_reduce_none,3,31,_reduce_22,4,31,_reduce_23,1,31,_reduce_none,0,36,_reduce_25,1,36,_reduce_26,1,36,_reduce_27,1,36,_reduce_28,1,36,_reduce_29,2,35,_reduce_30,2,35,_reduce_31,1,35,_reduce_none,3,34,_reduce_33,1,34,_reduce_34"),Me=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),w(F[0],"Racc_arg",[l,c,u,f,p,m,$,C,22,re,Me,60,35,!0]),w(F[0],"Racc_token_to_s_table",d.large_array_unpack("$end,error,NUMBER,R,U,C,F,S,PLUS,MINUS,ASTERISK,SLASH,PARENL,PARENR,BRACKETL,BRACKETR,LESS,GREATER,EQUAL,NOT,AT,CMP_OP,$start,expr,secret,notations,modifier,target,bracket,at,modifier_expr,mul,add,dice,term,unary,round_type")),w(F[0],"Racc_debug_parser",!1),x(R,"$_reduce_1",function(he,Ie,be){return j(j(g("UpperDice"),"Node"),"Command").$new(K(["secret","notations","modifier","cmp_op","target_number"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](2),cmp_op:he["$[]"](3)["$[]"]("cmp_op"),target_number:he["$[]"](3)["$[]"]("target")}))}),x(R,"$_reduce_2",function(he,Ie,be){return j(j(g("UpperDice"),"Node"),"Command").$new(K(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](3),cmp_op:he["$[]"](4)["$[]"]("cmp_op"),target_number:he["$[]"](4)["$[]"]("target"),reroll_threshold:he["$[]"](2)}))}),x(R,"$_reduce_3",function(he,Ie,be){return j(j(g("UpperDice"),"Node"),"Command").$new(K(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:he["$[]"](0),notations:he["$[]"](1),modifier:he["$[]"](2),cmp_op:he["$[]"](3)["$[]"]("cmp_op"),target_number:he["$[]"](3)["$[]"]("target"),reroll_threshold:he["$[]"](4)}))}),x(R,"$_reduce_4",G(!1)),x(R,"$_reduce_5",G(!0)),x(R,"$_reduce_6",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(0)}),x(R,"$_reduce_7",function(he,Ie,be){return he["$[]"](0)}),x(R,"$_reduce_8",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_9",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(R,"$_reduce_10",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(R,"$_reduce_11",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(R,"$_reduce_12",function(he,Ie,be){return K([],{})}),x(R,"$_reduce_13",function(he,Ie,be){var ae,y,W;return W=(ae=A(he))[1]??T,U(y=ae[0]??T)||this.$raise(g("ParseError")),K(["cmp_op","target"],{cmp_op:y,target:W})}),x(R,"$_reduce_14",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_15",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_16",function(he,Ie,be){var ae=T;return(ae=he["$[]"](0)).$push(he["$[]"](2)),ae}),x(R,"$_reduce_17",function(he,Ie,be){return[he["$[]"](0)]}),x(R,"$_reduce_18",function(he,Ie,be){var ae,ue;return ae=he["$[]"](0),ue=he["$[]"](2),j(j(g("UpperDice"),"Node"),"Notation").$new(ae,ue)}),x(R,"$_reduce_19",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))}),x(R,"$_reduce_20",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))}),x(R,"$_reduce_22",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))}),x(R,"$_reduce_23",function(he,Ie,be){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))}),x(R,"$_reduce_25",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(R,"$_reduce_26",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(R,"$_reduce_27",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithCeil")}),x(R,"$_reduce_28",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithRound")}),x(R,"$_reduce_29",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"DivideWithFloor")}),x(R,"$_reduce_30",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_31",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))}),x(R,"$_reduce_33",function(he,Ie,be){return he["$[]"](1)}),x(R,"$_reduce_34",function(he,Ie,be){return j(j(g("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))}),x(R,"$_reduce_none",function(he,Ie,be){return he["$[]"](0)})},Opal.modules["bcdice/common_command/upper_dice"]=function(d){var A,T,q,I,L,S,X,M,oe,N,H=d.module,J=d.const_set,_=d.thrower,x=d.def,w=[],K=d.nil;return d.top.$require("bcdice/common_command/upper_dice/parser"),A=w,T=N=[H(w[0],"BCDice")].concat(A),q=oe=[H(N[0],"CommonCommand")].concat(T),J((M=[X=H(oe[0],"UpperDice")].concat(q))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),L=[I=d.get_singleton_class(X)].concat(M),S=d.$r(L),x(I,"$eval",function(v,P,B){try{var D;return _("eval_return"),(D=S("Parser").$parse(v))===K||null==D?K:D.$eval(P,B)}catch(R){if(R===d.t_eval_return)return R.$v;throw R}})},Opal.modules["bcdice/common_command/version"]=function(d){var U,j,X,Q,S,k,M,I,z,Y,H=d.module,J=d.const_set,_=d.truthy,x=d.send,O=d.def,w=[],K=d.nil,G=d.$$$;return U=w,j=Y=[H(w[0],"BCDice")].concat(U),X=z=[H(Y[0],"CommonCommand")].concat(j),J((I=[M=H(z[0],"Version")].concat(X))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),S=[Q=d.get_singleton_class(M)].concat(I),k=d.$r(S),O(Q,"$eval",function(P,B,te){return P=P.$split(" ",2).$first(),_(P["$match?"](/^BCDiceVersion$/i))?x(k("Result").$new(),"tap",[],function(fe){var R;return null==fe&&(fe=K),R=["BCDice "+G(k("BCDice"),"VERSION")],x(fe,"text=",R),R[R.length-1]}):K})},Opal.queue(function(d){var K,N,T,j,A,H=d.module,J=d.const_set,_=d.top,x=[];return _.$require("bcdice/common_command/add_dice"),_.$require("bcdice/common_command/barabara_dice"),_.$require("bcdice/common_command/tally_dice"),_.$require("bcdice/common_command/calc"),_.$require("bcdice/common_command/choice"),_.$require("bcdice/common_command/d66_dice"),_.$require("bcdice/common_command/repeat"),_.$require("bcdice/common_command/reroll_dice"),_.$require("bcdice/common_command/upper_dice"),_.$require("bcdice/common_command/version"),K=x,N=A=[H(x[0],"BCDice")].concat(K),T=[H(A[0],"CommonCommand")].concat(N),j=d.$r(T),J(T[0],"COMMANDS",[j("AddDice"),j("BarabaraDice"),j("TallyDice"),j("Calc"),j("Choice"),j("D66Dice"),j("Repeat"),j("RerollDice"),j("UpperDice"),j("Version")].$freeze())})},9993:function(){(function(E){"use strict";var le;if(typeof globalThis<"u"?E=globalThis:typeof global<"u"?E=global:typeof window<"u"&&(E=window),null==E.console&&(E.console={}),"log"in(le="object"==typeof E.console?E.console:{})||(le.log=function(){}),"warn"in le||(le.warn=le.log),typeof E.Opal<"u")return le.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),E.Opal;var me,d,H,J,_,x,O,w=E.Opal={};w.global=E,w.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var K=Function.prototype.call,G=Function.prototype.bind,A=Object.hasOwn||K.bind(Object.prototype.hasOwnProperty),U=Object.setPrototypeOf,N=K.bind(Array.prototype.slice),Y=K.bind(Array.prototype.splice),j=4;function oe(){return j+=2}w.uid=oe,w.id=function(y){return y.$$is_number?2*y+1:(null==y.$$id&&X(y,"$$id",oe()),y.$$id)};var z=w.gvars={};function q(y,W){if(y||(y=w.Exception||Error),!O||!O.$raise)throw y.$new?y.$new(W):new y(W);arguments.length>2?O.$raise(y.$new.apply(y,N(arguments,1))):O.$raise(y,W)}function X(y,W,pe){"string"==typeof y?y[W]=pe:Object.defineProperty(y,W,{value:pe,enumerable:!1,configurable:!0,writable:!0})}w.exit=function(y){z.DEBUG&&le.log("Exited with status "+y)},w.exceptions=[],w.pop_exception=function(){var y=w.exceptions.pop();y?(z["!"]=y,z["@"]=y.$backtrace()):z["!"]=z["@"]=me},w.prop=X,w.defineProperty=w.prop,w.slice=N;var M=w.truthy=function(y){return!(!1===y||me===y||null==y||y instanceof Boolean&&!0!==y.valueOf())};function I(y){var W,pe,we;for(W=0,pe=w.tracers_for_class.length;W<pe;W++)(we=w.tracers_for_class[W]).trace_object=y,we.block.$call(we)}function Q(y,W){if(y.$$autoload[W].loaded){if(y.$$autoload[W].loaded&&!y.$$autoload[W].required&&y.$$autoload[W].exception)throw y.$$autoload[W].exception}else{y.$$autoload[W].loaded=!0;try{w.Kernel.$require(y.$$autoload[W].path)}catch(pe){throw y.$$autoload[W].exception=pe,pe}if(y.$$autoload[W].required=!0,null!=y.$$const[W])return y.$$autoload[W].success=!0,y.$$const[W]}}function L(y,W){if(y){if(null!=y.$$const[W])return y.$$const[W];if(y.$$autoload&&y.$$autoload[W])return Q(y,W)}}function k(y,W){var pe,we,De;if(null!=y)for(pe=0,we=(De=se(y)).length;pe<we;pe++){if(De[pe].$$const&&A(De[pe].$$const,W))return De[pe].$$const[W];if(De[pe].$$autoload&&De[pe].$$autoload[W])return Q(De[pe],W)}}function P(y,W){return(y||H).$const_missing(W)}function B(y,W,pe){var we=!0;return(null==y||"::"===y)&&(y=H),pe.$$is_a_module&&((null==pe.$$name||pe.$$name===me)&&(pe.$$name=W),null==pe.$$base_module&&(pe.$$base_module=y)),y.$$const=y.$$const||Object.create(null),(W in y.$$const||"$$autoload"in y&&W in y.$$autoload)&&(we=!1),y.$$const[W]=pe,y.$$=y.$$const,w.const_cache_version++,y===H&&(w[W]=pe),X(y,W,pe),we&&y.$const_added&&!y.$const_added.$$pristine&&y.$const_added(W),pe}function te(y,W,pe){var we;if(we=null!=W&&W.$$bridge?function(){var ut=N(arguments),Dt=new(G.apply(W.$$constructor,[null].concat(ut)));return U(Dt,we.$$prototype),Dt}:function(){},y&&y!==me&&X(we,"displayName","::"+y),X(we,"$$name",y),X(we,"$$constructor",we),X(we,"$$prototype",we.prototype),X(we,"$$const",{}),X(we,"$$is_class",!0),X(we,"$$is_a_module",!0),X(we,"$$super",W),X(we,"$$cvars",{}),X(we,"$$own_included_modules",[]),X(we,"$$own_prepended_modules",[]),X(we,"$$ancestors",[]),X(we,"$$ancestors_cache_version",null),X(we,"$$subclasses",[]),X(we.$$prototype,"$$class",we),w.Class&&U(we,w.Class.prototype),null!=W){if(U(we.$$prototype,W.$$prototype),!0!==pe)if(typeof WeakRef<"u"){var De,Le,Ye=[];for(De=0;De<W.$$subclasses.length;De++)void 0!==(Le=W.$$subclasses[De]).deref()&&Ye.push(Le);Ye.push(new WeakRef(we)),W.$$subclasses=Ye}else W.$$subclasses.push(we);W.$$meta&&w.build_class_singleton_class(we)}return we}function R(y){var W=function(){},pe=W;return y&&X(W,"displayName",y+".constructor"),X(pe,"$$name",y),X(pe,"$$prototype",W.prototype),X(pe,"$$const",{}),X(pe,"$$is_module",!0),X(pe,"$$is_a_module",!0),X(pe,"$$cvars",{}),X(pe,"$$iclasses",[]),X(pe,"$$own_included_modules",[]),X(pe,"$$own_prepended_modules",[]),X(pe,"$$ancestors",[pe]),X(pe,"$$ancestors_cache_version",null),U(pe,w.Module.prototype),pe}function g(y,W){y.hasOwnProperty("$$meta")?y.$$meta=W:X(y,"$$meta",W),y.$$frozen?y.$$meta.$freeze():U(y,W.$$prototype)}function l(y){return y.hasOwnProperty("$$iclass")&&y.hasOwnProperty("$$root")}function p(y){var W=m(y);return y.$$is_module&&y.$$iclasses.push(W),W}function m(y){var W={},pe=y.$$prototype;pe.hasOwnProperty("$$dummy")&&(pe=pe.$$define_methods_on);var Le,we=Object.getOwnPropertyNames(pe),De=we.length;for(Le=0;Le<De;Le++){var Ye=we[Le];X(W,Ye,pe[Ye])}return X(W,"$$iclass",!0),X(W,"$$module",y),W}function C(y){var W=y.length,pe=y[0];if(X(pe,"$$root",!0),1===W)return{first:pe,last:pe};for(var we=pe,De=1;De<W;De++){var Le=y[De];U(we,Le),we=Le}return{first:y[0],last:y[W-1]}}function $(y){if(!y.hasOwnProperty("$$dummy")){if(y.hasOwnProperty("$$iclass"))return y.$$module;if(y.hasOwnProperty("$$class"))return y.$$class}}function se(y){if(!y)return[];if(y.$$ancestors_cache_version===w.const_cache_version)return y.$$ancestors;var pe,we,De,W=[];for(pe=0,we=function re(y){return y.$$own_prepended_modules.concat([y]).concat(y.$$own_included_modules)}(y),De=we.length;pe<De;pe++)W.push(we[pe]);if(y.$$super)for(pe=0,De=(we=se(y.$$super)).length;pe<De;pe++)W.push(we[pe]);return y.$$ancestors_cache_version=w.const_cache_version,y.$$ancestors=W,W}function Ee(y){return y.hasOwnProperty("$$meta")&&null!==y.$$meta?se(y.$$meta):se(y.$$class)}function Me(y,W){"number"==typeof W?y.$$arity=W:"object"==typeof W&&Object.assign(y,W)}w.falsy=function(y){return!M(y)},w.type_error=function(y,W,pe,we){y=y.$$class,q(w.TypeError,we&&pe?"can't convert "+y+" into "+W+" ("+y+"#"+pe+" gives "+(we=we.$$class)+")":"no implicit conversion of "+y+" into "+W)},w.coerce_to=function(y,W,pe,we){var De;return"to_int"===pe&&W===w.Integer&&y.$$is_number?y<0?Math.ceil(y):Math.floor(y):"to_str"===pe&&W===w.String&&y.$$is_string||w.is_a(y,W)?y:y["$respond_to?"].$$pristine&&y.$method_missing.$$pristine?((null==(De=y[ke(pe)])||De.$$stub)&&w.type_error(y,W),De.apply(y,we)):(y["$respond_to?"](pe)||w.type_error(y,W),null==we&&(we=[]),w.send(y,pe,we))},w.respond_to=function(y,W,pe){if(null==y||!y.$$class)return!1;pe=!!pe;var we=y[W];return y["$respond_to?"].$$pristine?"function"==typeof we&&!we.$$stub||(y["$respond_to_missing?"].$$pristine?void 0:w.send(y,y["$respond_to_missing?"],[W.substr(1),pe])):w.send(y,y["$respond_to?"],[W.substr(1),pe])},w.trace_class=!1,w.tracers_for_class=[],w.const_get_local=function(y,W,pe){var we;if(null!=y)return"::"===y&&(y=H),!y.$$is_module&&!y.$$is_class&&q(w.TypeError,y.toString()+" is not a class/module"),null!=(we=L(y,W))||pe?we:P(y,W)},w.const_get_qualified=function(y,W,pe){var we,De,Le,Ye=w.const_cache_version;return null==W?(we=L(H,y))??w.const_get_qualified(H,y,pe):null!=y?("::"===y&&(y=H),!y.$$is_module&&!y.$$is_class&&q(w.TypeError,y.toString()+" is not a class/module"),null==(De=y.$$const_cache)&&(X(y,"$$const_cache",Object.create(null)),De=y.$$const_cache),null==(Le=De[W])||Le[0]!==Ye?(null!=(we=L(y,W))||(we=k(y,W)),De[W]=[Ye,we]):we=Le[1],null!=we||pe?we:P(y,W)):void 0},w.const_cache_version=1,w.const_get_relative=function(y,W,pe){var De,Ye,ut,we=y[0],Le=w.const_cache_version;return null==(Ye=y.$$const_cache)&&(X(y,"$$const_cache",Object.create(null)),Ye=y.$$const_cache),null==(ut=Ye[W])||ut[0]!==Le?(null!=(De=L(we,W))||null!=(De=function S(y,W){var pe,we,De;if(0!==y.length)for(pe=0,we=y.length;pe<we;pe++){if(null!=(De=y[pe].$$const[W]))return De;if(y[pe].$$autoload&&y[pe].$$autoload[W])return Q(y[pe],W)}}(y,W))||null!=(De=k(we,W))||(De=function v(y,W){if(null==y||y.$$is_module)return k(H,W)}(we,W)),Ye[W]=[Le,De]):De=ut[1],null!=De||pe?De:P(we,W)},w.const_set=B,w.constants=function(y,W){null==W&&(W=!0);var pe,De,Le,ut,we=[y],Ye={};for(W&&(we=we.concat(se(y))),W&&y.$$is_module&&(we=we.concat([w.Object]).concat(se(w.Object))),De=0,Le=we.length;De<Le&&(pe=we[De],y===H||pe!=H);De++){for(ut in pe.$$const)Ye[ut]=!0;if(pe.$$autoload)for(ut in pe.$$autoload)Ye[ut]=!0}return Object.keys(Ye)},w.const_remove=function(y,W){if(w.const_cache_version++,null!=y.$$const[W]){var pe=y.$$const[W];return delete y.$$const[W],pe}if(y.$$autoload&&y.$$autoload[W])return delete y.$$autoload[W],me;q(w.NameError,"constant "+y+"::"+y.$name()+" not defined")},w.const_get_relative_factory=function(y){return function(W,pe){return w.$$(y,W,pe)}},w.$$=w.const_get_relative,w.$$$=w.const_get_qualified,w.$r=w.const_get_relative_factory,w.allocate_class=te,w.klass=function(y,W,pe){var we;null==y||"::"==y?y=H:!y.$$is_class&&!y.$$is_module&&(y=y.$$class),null!=W&&(!W.hasOwnProperty||W.hasOwnProperty&&!W.hasOwnProperty("$$is_class"))&&(W.constructor&&"Function"==W.constructor.name?(we=W,W=H):q(w.TypeError,"superclass must be a Class ("+(W.constructor&&(W.constructor.name||W.constructor.$$name)||typeof W)+" given)"));var De=function D(y,W){var pe=L(y,W);if(pe)return pe.$$is_class||q(w.TypeError,W+" is not a class"),pe}(y,pe);return null!=De?W&&function fe(y,W){y.$$super!==W&&q(w.TypeError,"superclass mismatch for class "+y.$$name)}(De,W):(null==W&&(W=H),B(y,pe,De=te(pe,W)),W.$inherited&&W.$inherited(De),we&&w.bridge(we,De)),w.trace_class&&I(De),De},w.allocate_module=R,w.module=function(y,W){var pe;return null==y||"::"==y?y=H:!y.$$is_class&&!y.$$is_module&&(y=y.$$class),pe=function F(y,W){var pe=L(y,W);return null==pe&&y===H&&(pe=k(H,W)),pe&&!pe.$$is_module&&pe!==H&&q(w.TypeError,W+" is not a module"),pe}(y,W),null==pe&&B(y,W,pe=R(W)),w.trace_class&&I(pe),pe},w.get_singleton_class=function(y){return y.$$meta?y.$$meta:y.hasOwnProperty("$$is_class")?w.build_class_singleton_class(y):y.hasOwnProperty("$$is_module")?w.build_module_singleton_class(y):w.build_object_singleton_class(y)},w.build_class_singleton_class=function(y){if(y.$$meta)return y.$$meta;var pe=te(null,y===d?_:w.get_singleton_class(y.$$super),!0);return X(pe,"$$is_singleton",!0),X(pe,"$$singleton_of",y),g(y,pe),X(y,"$$class",w.Class),pe},w.build_module_singleton_class=function(y){if(y.$$meta)return y.$$meta;var W=te(null,w.Module,!0);return X(W,"$$is_singleton",!0),X(W,"$$singleton_of",y),g(y,W),X(y,"$$class",w.Module),W},w.build_object_singleton_class=function(y){var pe=te(me,y.$$class,!0);return X(pe,"$$is_singleton",!0),X(pe,"$$singleton_of",y),delete pe.$$prototype.$$class,g(y,pe),pe},w.is_method=function(y){return"$"===y[0]&&"$"!==y[1]},w.instance_methods=function(y){for(var W=[],pe=[],we=se(y),De=0,Le=we.length;De<Le;De++){var ut=we[De].$$prototype;ut.hasOwnProperty("$$dummy")&&(ut=ut.$$define_methods_on);for(var Dt=Object.getOwnPropertyNames(ut),Ot=0,un=Dt.length;Ot<un;Ot++){var tn=Dt[Ot];if(w.is_method(tn)){var On=tn.slice(1),Mn=ut[tn];Mn.$$stub&&-1===W.indexOf(On)&&W.push(On),!Mn.$$stub&&-1===pe.indexOf(On)&&-1===W.indexOf(On)&&pe.push(On)}}}return pe},w.own_instance_methods=function(y){var W=[],pe=y.$$prototype;pe.hasOwnProperty("$$dummy")&&(pe=pe.$$define_methods_on);for(var we=Object.getOwnPropertyNames(pe),De=0,Le=we.length;De<Le;De++){var Ye=we[De];if(w.is_method(Ye)&&!pe[Ye].$$stub){var Dt=Ye.slice(1);W.push(Dt)}}return W},w.methods=function(y){return w.instance_methods(y.$$meta||y.$$class)},w.own_methods=function(y){return y.$$meta?w.own_instance_methods(y.$$meta):[]},w.receiver_methods=function(y){var W=w.get_singleton_class(y),pe=w.own_instance_methods(W),we=w.own_instance_methods(W.$$super);return pe.concat(we)},w.class_variables=function(y){var pe,W=se(y),De={};for(pe=W.length-1;pe>=0;pe--){var Le=W[pe];for(var Ye in Le.$$cvars)De[Ye]=Le.$$cvars[Ye]}return De},w.class_variable_set=function(y,W,pe){var De,we=se(y);for(De=we.length-2;De>=0;De--){var Ye=we[De];if(A(Ye.$$cvars,W))return Ye.$$cvars[W]=pe,pe}return y.$$cvars[W]=pe,pe},w.class_variable_get=function(y,W,pe){if(A(y.$$cvars,W))return y.$$cvars[W];var De,we=se(y),Le=we.length;for(De=0;De<Le;De++){var Ye=we[De];if(A(Ye.$$cvars,W))return Ye.$$cvars[W]}return pe||q(w.NameError,"uninitialized class variable "+W+" in "+y.$name()),me},w.append_features=function(y,W){var pe=se(y),we=[];-1!==pe.indexOf(W)&&q(w.ArgumentError,"cyclic include detected");for(var De=0,Le=pe.length;De<Le;De++){var ut=p(pe[De]);X(ut,"$$included",!0),we.push(ut)}var un,tn,Dt=se(W),Ot=C(we);if(-1===Dt.indexOf(y))un=W.$$prototype,tn=Object.getPrototypeOf(W.$$prototype);else{for(var On=W.$$prototype,Mn=Object.getPrototypeOf(On);null!=Mn&&(Mn.$$module!==y||!l(Mn));)On=Mn,Mn=Object.getPrototypeOf(Mn);if(Mn){for(var yr=Object.getPrototypeOf(Mn);yr.hasOwnProperty("$$iclass")&&!l(yr);)yr=Object.getPrototypeOf(yr);un=On,tn=yr}else un=W.$$prototype,tn=Object.getPrototypeOf(W.$$prototype)}U(un,Ot.first),U(Ot.last,tn),W.$$own_included_modules=function c(y){for(var pe,W=[],we=Object.getPrototypeOf(y.$$prototype);we&&!we.hasOwnProperty("$$class");)(pe=$(we))&&W.push(pe),we=Object.getPrototypeOf(we);return W}(W),w.const_cache_version++},w.prepend_features=function(y,W){var pe=se(y),we=[];-1!==pe.indexOf(W)&&q(w.ArgumentError,"cyclic prepend detected");for(var De=0,Le=pe.length;De<Le;De++){var ut=p(pe[De]);X(ut,"$$prepended",!0),we.push(ut)}var tn,On,Mn,Dt=C(we),Ot=W.$$prototype,un=Object.getPrototypeOf(Ot);if(Ot.hasOwnProperty("$$dummy")?tn=Ot.$$define_methods_on:(tn=m(W),function u(y){for(var W=y.$$prototype,pe=Object.getOwnPropertyNames(W),we=0;we<pe.length;we++){var De=pe[we];w.is_method(De)&&delete W[De]}}(W),X(Ot,"$$dummy",!0),X(Ot,"$$define_methods_on",tn),U(Ot,tn),U(tn,un)),-1===se(W).indexOf(y))for(On=Ot,Mn=Object.getPrototypeOf(Ot);null!=Mn&&!Mn.hasOwnProperty("$$root")&&Mn!==tn&&Mn.hasOwnProperty("$$iclass");)Mn=Object.getPrototypeOf(Mn);else q(w.RuntimeError,"Prepending a module multiple times is not supported");U(On,Dt.first),U(Dt.last,Mn),W.$$own_prepended_modules=function f(y){var pe,W=[],we=Object.getPrototypeOf(y.$$prototype);if(y.$$prototype.hasOwnProperty("$$dummy"))for(;we&&we!==y.$$prototype.$$define_methods_on;)(pe=$(we))&&W.push(pe),we=Object.getPrototypeOf(we);return W}(W),w.const_cache_version++},w.bridge=function(y,W){y.hasOwnProperty("$$bridge")&&q(w.ArgumentError,"already bridged"),X(y,"$$bridge",W),U(y.prototype,(W.$$super||w.Object).$$prototype),X(W,"$$prototype",y.prototype),X(W.$$prototype,"$$class",W),X(W,"$$constructor",y),X(W,"$$bridge",!0)},w.ancestors=se,w.included_modules=function(y){for(var W=[],pe=null,we=Object.getPrototypeOf(y.$$prototype);we&&Object.getPrototypeOf(we);we=Object.getPrototypeOf(we))(pe=$(we))&&pe.$$is_module&&we.$$iclass&&we.$$included&&W.push(pe);return W},w.add_stubs=function(y){for(var pe,we,W=w.BasicObject.$$prototype,De=0,Le=(y=y.split(",")).length;De<Le;De++)(null==(we=W[pe=ke(y[De])])||we.$$stub)&&w.add_stub_for(W,pe)},w.add_stub_for=function(y,W){X(y,W,w.stub_for(W))},w.stub_for=function(y){function W(){this.$method_missing.$$p=W.$$p,W.$$p=null;for(var pe=new Array(arguments.length),we=0,De=pe.length;we<De;we++)pe[we]=arguments[we];return this.$method_missing.apply(this,[y.slice(1)].concat(pe))}return W.$$stub=!0,W},w.ac=function(y,W,pe,we){var De="";De+=pe.$$is_a_module?pe.$$name+".":pe.$$class.$$name+"#",q(w.ArgumentError,"["+(De+=we)+"] wrong number of arguments (given "+y+", expected "+W+")")},w.block_ac=function(y,W,pe){q(w.ArgumentError,"`block in "+pe+"': wrong number of arguments (given "+y+", expected "+W+")")},w.find_super=function(y,W,pe,we,De){for(var Ye,ut,Le=ke(W),Ot=(Ye=Ee(y)).indexOf(pe.$$owner)+1;Ot<Ye.length;Ot++){var tn=Ye[Ot].$$prototype;if(tn.hasOwnProperty("$$dummy")&&(tn=tn.$$define_methods_on),tn.hasOwnProperty(Le)){ut=tn[Le];break}}return!we&&ut&&ut.$$stub&&y.$method_missing.$$pristine&&q(w.NoMethodError,"super: no superclass method `"+W+"' for "+y,W),ut.$$stub&&!De?null:ut},w.find_block_super=function(y,W,pe,we,De){var Le=W;return pe||q(w.RuntimeError,"super called outside of method"),De&&pe.$$define_meth&&q(w.RuntimeError,"implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly"),pe.$$def&&(Le=pe.$$jsid),w.find_super(y,Le,pe,we)},w.find_super_dispatcher=w.find_super,w.find_iter_super_dispatcher=w.find_block_super,w.yield1=function(y,W){"function"!=typeof y&&q(w.LocalJumpError,"no block given");var we=y.$$has_trailing_comma_in_args;return(y.length>1||(y.$$has_top_level_mlhs_arg||we)&&1===y.length)&&(W=w.to_ary(W)),(y.length>1||we&&1===y.length)&&W.$$is_array?y.apply(null,W):y(W)},w.yieldX=function(y,W){if("function"!=typeof y&&q(w.LocalJumpError,"no block given"),y.length>1&&1===W.length&&W[0].$$is_array)return y.apply(null,W[0]);if(!W.$$is_array){for(var pe=new Array(W.length),we=0,De=pe.length;we<De;we++)pe[we]=W[we];return y.apply(null,pe)}return y.apply(null,W)},w.rescue=function(y,W){for(var pe=0;pe<W.length;pe++){var we=W[pe];if(we.$$is_array){var De=w.rescue(y,we);if(De)return De}else if(we===w.JS.Error||we["$==="](y))return we}return null},w.is_a=function(y,W){return null!=W&&y.$$meta===W||y.$$class===W||(y.$$is_number&&W.$$is_number_class?!W.$$is_integer_class||y%1==0:-1!==se(y.$$is_class?w.get_singleton_class(y):y.$$meta||y.$$class).indexOf(W))},w.to_hash=function(y){if(y.$$is_hash)return y;if(y["$respond_to?"]("to_hash",!0)){var W=y.$to_hash();if(W.$$is_hash)return W;q(w.TypeError,"Can't convert "+y.$$class+" to Hash ("+y.$$class+"#to_hash gives "+W.$$class+")")}else q(w.TypeError,"no implicit conversion of "+y.$$class+" into Hash")},w.to_ary=function(y){if(y.$$is_array)return y;if(!y["$respond_to?"]("to_ary",!0))return[y];var W=y.$to_ary();return W===me?[y]:W.$$is_array?W:void q(w.TypeError,"Can't convert "+y.$$class+" to Array ("+y.$$class+"#to_ary gives "+W.$$class+")")},w.to_a=function(y){if(y.$$is_array)return y.slice();if(!y["$respond_to?"]("to_a",!0))return[y];var W=y.$to_a();return W===me?[y]:W.$$is_array?W:void q(w.TypeError,"Can't convert "+y.$$class+" to Array ("+y.$$class+"#to_a gives "+W.$$class+")")},w.extract_kwargs=function(y){var W=y[y.length-1];if(null!=W&&w.respond_to(W,"$to_hash",!0))return Y(y,y.length-1),W},w.kwrestargs=function(y,W){var De,pe=[],we={},Le=y.$$smap;for(De in Le)W[De]||(pe.push(De),we[De]=Le[De]);return w.hash2(pe,we)};var ce={};function ke(y){return ce[y]||(ce[y]="$"+y)}function ve(y){return"function"==typeof y&&!y.$$stub}w.jsid=ke,w.send=function(y,W,pe,we,De){var Le;return"function"==typeof W?(Le=W,W=null):"string"==typeof W?Le=y[ke(W)]:q(w.NameError,"Passed method should be a string or a function"),w.send2(y,Le,W,pe,we,De)},w.send2=function(y,W,pe,we,De,Le){return null==W&&null!=pe&&y.$method_missing&&(W=y.$method_missing,we=[pe].concat(we)),Me(De,Le),"function"==typeof De&&(W.$$p=De),W.apply(y,we)},w.refined_send=function(y,W,pe,we,De,Le){var Ye,ut,Dt,Ot,un,tn,On,Mn,yr,fa;for(Ot=Ee(W),Ye=0;Ye<Ot.length;Ye++)for(un=w.id(Ot[Ye]),ut=0;ut<y.length;ut++)for(Dt=(tn=y[ut]).length-1;Dt>=0;Dt--)if(!(typeof(On=tn[Dt]).$$refine_modules>"u")&&!(typeof(Mn=On.$$refine_modules)[un]>"u")&&typeof(yr=Mn[un]).$$prototype[ke(pe)]<"u")return fa=yr.$$prototype[ke(pe)],w.send2(W,fa,pe,we,De,Le);return w.send(W,pe,we,De,Le)},w.lambda=function(y,W){return y.$$is_lambda=!0,Me(y,W),y},w.def=function(y,W,pe,we){return Me(pe,we),y===w.top?w.defn(w.Object,W,pe):!y.$$eval&&y.$$is_a_module?w.defn(y,W,pe):w.defs(y,W,pe)},w.defn=function(y,W,pe){he(y),pe.displayName=W,pe.$$owner=y;var we=W.substr(1),De=y.$$prototype;if(De.hasOwnProperty("$$dummy")&&(De=De.$$define_methods_on),X(De,W,pe),y.$$is_module){y.$$module_function&&w.defs(y,W,pe);for(var Le=0,Ye=y.$$iclasses,ut=Ye.length;Le<ut;Le++)X(Ye[Le],W,pe)}var Ot=y.$$singleton_of;return!y.$method_added||y.$method_added.$$stub||Ot?Ot&&Ot.$singleton_method_added&&!Ot.$singleton_method_added.$$stub&&Ot.$singleton_method_added(we):y.$method_added(we),we},w.defs=function(y,W,pe,we){return Me(pe,we),(y.$$is_string||y.$$is_number)&&q(w.TypeError,"can't define singleton"),w.defn(w.get_singleton_class(y),W,pe)},w.rdef=function(y,W){A(y.$$prototype,W)||q(w.NameError,"method '"+W.substr(1)+"' not defined in "+y.$name()),delete y.$$prototype[W],y.$$is_singleton?y.$$prototype.$singleton_method_removed&&!y.$$prototype.$singleton_method_removed.$$stub&&y.$$prototype.$singleton_method_removed(W.substr(1)):y.$method_removed&&!y.$method_removed.$$stub&&y.$method_removed(W.substr(1))},w.udef=function(y,W){(!y.$$prototype[W]||y.$$prototype[W].$$stub)&&q(w.NameError,"method '"+W.substr(1)+"' not defined in "+y.$name()),w.add_stub_for(y.$$prototype,W),y.$$is_singleton?y.$$prototype.$singleton_method_undefined&&!y.$$prototype.$singleton_method_undefined.$$stub&&y.$$prototype.$singleton_method_undefined(W.substr(1)):y.$method_undefined&&!y.$method_undefined.$$stub&&y.$method_undefined(W.substr(1))},w.alias=function(y,W,pe){var Le,Ye,we=ke(W),De=ke(pe);if(typeof y.$$prototype>"u"&&(y=w.Object),Le=y.$$prototype[De],y.$$eval)return w.alias(w.get_singleton_class(y),W,pe);if(!ve(Le)){for(var ut=y.$$super;"function"!=typeof Le&&ut;)Le=ut[De],ut=ut.$$super;!ve(Le)&&y.$$is_module&&(Le=w.Object.$$prototype[De]),ve(Le)||q(w.NameError,"undefined method `"+pe+"' for class `"+y.$name()+"'")}Le.$$alias_of&&(Le=Le.$$alias_of),Ye=function(){var Ot,un,tn,Dt=Ye.$$p;for(Ot=new Array(arguments.length),un=0,tn=arguments.length;un<tn;un++)Ot[un]=arguments[un];return Ye.$$p=null,w.send(this,Le,Ot,Dt)};try{Object.defineProperty(Ye,"length",{value:Le.length})}catch{}return Ye.displayName=W,Ye.$$arity=Le.$$arity??Le.length,Ye.$$parameters=Le.$$parameters,Ye.$$source_location=Le.$$source_location,Ye.$$alias_of=Le,Ye.$$alias_name=W,w.defn(y,we,Ye),y},w.alias_gvar=function(y,W){return Object.defineProperty(z,y,{configurable:!0,enumerable:!0,get:function(){return z[W]},set:function(pe){z[W]=pe}}),me},w.alias_native=function(y,W,pe){var we=ke(W),De=y.$$prototype[pe];return("function"!=typeof De||De.$$stub)&&q(w.NameError,"undefined native method `"+pe+"' for class `"+y.$name()+"'"),w.defn(y,we,De),y},w.hash_init=function(y){y.$$smap=Object.create(null),y.$$map=Object.create(null),y.$$keys=[]},w.hash_clone=function(y,W){W.$$none=y.$$none,W.$$proc=y.$$proc;for(var Ye,ut,pe=0,we=y.$$keys,De=y.$$smap,Le=we.length;pe<Le;pe++)(Ye=we[pe]).$$is_string?ut=De[Ye]:(ut=Ye.value,Ye=Ye.key),w.hash_put(W,Ye,ut)},w.hash_put=function(y,W,pe){if(W.$$is_string)return A(y.$$smap,W)||y.$$keys.push(W),void(y.$$smap[W]=pe);var we,De,Le;if(we=y.$$by_identity?w.id(W):W.$hash(),!A(y.$$map,we))return y.$$keys.push(De={key:W,key_hash:we,value:pe}),void(y.$$map[we]=De);for(De=y.$$map[we];De;){if(W===De.key||W["$eql?"](De.key)){Le=void 0,De.value=pe;break}Le=De,De=De.next}Le&&(y.$$keys.push(De={key:W,key_hash:we,value:pe}),Le.next=De)},w.hash_get=function(y,W){if(W.$$is_string)return A(y.$$smap,W)?y.$$smap[W]:void 0;var pe,we;if(pe=y.$$by_identity?w.id(W):W.$hash(),A(y.$$map,pe))for(we=y.$$map[pe];we;){if(W===we.key||W["$eql?"](we.key))return we.value;we=we.next}},w.hash_delete=function(y,W){var pe,Le,Ye,we=y.$$keys,De=we.length;if(W.$$is_string){if("string"!=typeof W&&(W=W.valueOf()),!A(y.$$smap,W))return;for(pe=0;pe<De;pe++)if((Ye=we[pe]).$$is_string&&"string"!=typeof Ye&&(Ye=Ye.valueOf()),Ye===W){we.splice(pe,1);break}return Le=y.$$smap[W],delete y.$$smap[W],Le}var ut=W.$hash();if(A(y.$$map,ut))for(var Ot,Dt=y.$$map[ut];Dt;){if(W===Dt.key||W["$eql?"](Dt.key)){for(Le=Dt.value,pe=0;pe<De;pe++)if(we[pe]===Dt){we.splice(pe,1);break}return Ot&&Dt.next?Ot.next=Dt.next:Ot?delete Ot.next:Dt.next?y.$$map[ut]=Dt.next:delete y.$$map[ut],Le}Ot=Dt,Dt=Dt.next}},w.hash_rehash=function(y){for(var we,De,Le,W=0,pe=y.$$keys.length;W<pe;W++)if(!y.$$keys[W].$$is_string&&(we=y.$$keys[W].key.$hash())!==y.$$keys[W].key_hash){for(De=y.$$map[y.$$keys[W].key_hash],Le=void 0;De;){if(De===y.$$keys[W]){Le&&De.next?Le.next=De.next:Le?delete Le.next:De.next?y.$$map[y.$$keys[W].key_hash]=De.next:delete y.$$map[y.$$keys[W].key_hash];break}Le=De,De=De.next}if(y.$$keys[W].key_hash=we,!A(y.$$map,we)){y.$$map[we]=y.$$keys[W];continue}for(De=y.$$map[we],Le=void 0;De;){if(De===y.$$keys[W]){Le=void 0;break}Le=De,De=De.next}Le&&(Le.next=y.$$keys[W])}},w.hash=function(){var W,pe,we,De,Le,y=arguments.length;if(1===y&&arguments[0].$$is_hash)return arguments[0];if(pe=new w.Hash,w.hash_init(pe),1===y){if(W=arguments[0],arguments[0].$$is_array){for(De=W.length,we=0;we<De;we++)2!==W[we].length&&q(w.ArgumentError,"value not of length 2: "+W[we].$inspect()),w.hash_put(pe,Le=W[we][0],W[we][1]);return pe}for(Le in W=arguments[0])A(W,Le)&&w.hash_put(pe,Le,W[Le]);return pe}for(y%2!=0&&q(w.ArgumentError,"odd number of arguments for Hash"),we=0;we<y;we+=2)w.hash_put(pe,Le=arguments[we],arguments[we+1]);return pe},w.hash2=function(y,W){var pe=new w.Hash;return pe.$$smap=W,pe.$$map=Object.create(null),pe.$$keys=y,pe},w.range=function(y,W,pe){var we=new w.Range;return we.begin=y,we.end=W,we.excl=pe,we};var ye=["constructor","displayName","__count__","__noSuchMethod__","__parent__","__proto__","hasOwnProperty","valueOf"];function he(y){y.$$frozen&&q(w.FrozenError,"can't modify frozen "+y.$class()+": "+y,w.hash2(["receiver"],{receiver:y}))}function Ie(y,W){return"number"==typeof y&&"number"==typeof W}function be(y,W){return"number"==typeof y&&"number"==typeof W||"string"==typeof y&&"string"==typeof W}function ue(y){return function(){return y}}w.ivar=function(y){return-1!==ye.indexOf(y)&&(y+="$"),y},w.deny_frozen_access=he,w.freeze=function(y){return X(y,"$$frozen",!0),y.hasOwnProperty("$$id")||X(y,"$$id",oe()),y.hasOwnProperty("$$meta")?y.$$meta.$freeze():X(y,"$$meta",null),y.hasOwnProperty("$$comparable")||X(y,"$$comparable",null),Object.seal(y),y},w.freeze_props=function(y){var W,pe,we;for(W in y)("string"!=(pe=typeof W)&&"object"!==pe||"$"!==W[0])&&(we=Object.getOwnPropertyDescriptor(y,W))&&we.enumerable&&we.writable&&function(){var De=y[W];Object.defineProperty(y,W,{get:function(){return De},set:function(Le){he(y)},enumerable:!0})}()},w.escape_regexp=function(y){return y.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},w.global_regexp=function(y){return y.global?y:(null==y.$$g?y.$$g=new RegExp(y.source,(y.multiline?"gm":"g")+(y.ignoreCase?"i":"")):y.$$g.lastIndex=null,y.$$g)},w.global_multiline_regexp=function(y){var W,pe;return y.global&&y.multiline?y:(pe="gm"+(y.ignoreCase?"i":""),y.multiline?(null==y.$$g&&(y.$$g=new RegExp(y.source,pe)),W=y.$$g):(null==y.$$gm&&(y.$$gm=new RegExp(y.source,pe)),W=y.$$gm),W.lastIndex=null,W)},w.regexp=function(y,W){for(var pe,we=typeof W<"u"&&W&&W.indexOf("i")>=0,De=0,Le=y.length;De<Le;De++)(pe=y[De])instanceof RegExp&&(pe.ignoreCase!==we&&w.Kernel.$warn("ignore case doesn't match for "+pe.source.$inspect(),w.hash({uplevel:1})),pe=pe.source),""===pe&&(pe="(?:"+pe+")"),y[De]=pe;return W?new RegExp(y.join(""),W):new RegExp(y.join(""))},w.modules={},w.loaded_features=["corelib/runtime"],w.current_dir=".",w.require_table={"corelib/runtime":!0},w.normalize=function(y){var W,pe,we=[];"."!==w.current_dir&&(y=w.current_dir.replace(/\/*$/,"/")+y);for(var Le=0,Ye=(W=(y=(y=y.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;Le<Ye;Le++)""!==(pe=W[Le])&&(".."===pe?we.pop():we.push(pe));return we.join("/")},w.loaded=function(y){var W,pe,we;for(W=0,pe=y.length;W<pe;W++)we=w.normalize(y[W]),!w.require_table[we]&&(w.loaded_features.push(we),w.require_table[we]=!0)},w.load_normalized=function(y){w.loaded([y]);var W=w.modules[y];if(W){var pe=W(w);if(typeof Promise<"u"&&pe instanceof Promise)return pe.then(ue(!0))}else{var we=w.config.missing_require_severity,De="cannot load such file -- "+y;"error"===we?q(w.LoadError,De):"warning"===we&&le.warn("WARNING: LoadError: "+De)}return!0},w.load=function(y){return y=w.normalize(y),w.load_normalized(y)},w.require=function(y){return y=w.normalize(y),!w.require_table[y]&&w.load_normalized(y)},w.encodings=Object.create(null),w.set_encoding=function(y,W,pe){typeof pe>"u"&&(pe="encoding"),("string"==typeof y||!0===y.$$frozen)&&q(w.FrozenError,"can't modify frozen String");var we=w.find_encoding(W);return we===y[pe]||(y[pe]=we),y},w.find_encoding=function(y){var W=w.encodings,pe=W[y]||W[y.toUpperCase()];return pe||q(w.ArgumentError,"unknown encoding name - "+y),pe},w.enc=function(y,W){var pe=new String(y);return(pe=w.set_encoding(pe,W)).internal_encoding=pe.encoding,pe},w.binary=function(y){var W=new String(y);return w.set_encoding(W,"binary","internal_encoding")},w.last_promise=null,w.promise_unhandled_exception=!1,w.queue=function(y){if(w.last_promise)return w.last_promise=w.last_promise.then(function(){if(!w.promise_unhandled_exception)return y(w)}).catch(function(pe){w.respond_to(pe,"$full_message")&&(pe=pe.$full_message()),le.error(pe),w.promise_unhandled_exception=!0,w.exit(1)}),w.last_promise;var W=y(w);return"function"==typeof Promise&&"object"==typeof W&&W instanceof Promise&&(w.last_promise=W),W},w.rb_plus=function(y,W){return Ie(y,W)?y+W:y["$+"](W)},w.rb_minus=function(y,W){return Ie(y,W)?y-W:y["$-"](W)},w.rb_times=function(y,W){return Ie(y,W)?y*W:y["$*"](W)},w.rb_divide=function(y,W){return Ie(y,W)?y/W:y["$/"](W)},w.rb_lt=function(y,W){return Ie(y,W)?y<W:y["$<"](W)},w.rb_gt=function(y,W){return Ie(y,W)?y>W:y["$>"](W)},w.rb_le=function(y,W){return Ie(y,W)?y<=W:y["$<="](W)},w.rb_ge=function(y,W){return Ie(y,W)?y>=W:y["$>="](W)},w.eqeq=function ae(y,W){return be(y,W)?y===W:M(y["$=="](W))},w.eqeqeq=function(y,W){return be(y,W)?y===W:M(y["$==="](W))},w.neqeq=function(y,W){return be(y,W)?y!==W:M(y["$!="](W))},w.not=function(y){return null==y||!1===y||me===y||!0!==y&&!y["$!"].$$pristine&&M(y["$!"]())},w.return_val=ue,w.return_self=function(){return this},w.return_ivar=function(y){return function(){return this[y]??me}},w.assign_ivar=function(y){return function(W){return he(this),this[y]=W}},w.assign_ivar_val=function(y,W){return function(){return he(this),this[y]=W}},w.ensure_kwargs=function(y){return null==y?w.hash2([],{}):y.$$is_hash?y:void q(w.ArgumentError,"expected kwargs")},w.get_kwarg=function(y,W){return A(y.$$smap,W)||q(w.ArgumentError,"missing keyword: "+W),y.$$smap[W]},w.large_array_unpack=function(y){var we,W=y.split(","),pe=W.length;for(we=0;we<pe;we++)switch(W[we][0]){case void 0:W[we]=me;break;case"-":case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":W[we]=+W[we]}return W},w.BasicObject=d=te("BasicObject",null),w.Object=H=te("Object",w.BasicObject),w.Module=J=te("Module",w.Object),w.Class=_=te("Class",w.Module),w.Opal=x=R("Opal"),w.Kernel=O=R("Kernel"),U(w.BasicObject,w.Class.$$prototype),U(w.Object,w.Class.$$prototype),U(w.Module,w.Class.$$prototype),U(w.Class,w.Class.$$prototype),d.$$const.BasicObject=d,B(H,"BasicObject",d),B(H,"Object",H),B(H,"Module",J),B(H,"Class",_),B(H,"Opal",x),B(H,"Kernel",O),d.$$class=_,H.$$class=_,J.$$class=_,_.$$class=_,x.$$class=J,O.$$class=J,X(H.$$prototype,"toString",function(){var y=this.$to_s();return y.$$is_string&&"object"==typeof y?y.valueOf():y}),X(H.$$prototype,"$require",w.require),w.top=new H,w.top.$to_s=w.top.$inspect=ue("main"),w.top.$define_method=function xe(){var y=N(arguments),W=xe.$$p;return xe.$$p=null,w.send(H,"define_method",y,W)},w.NilClass=te("NilClass",w.Object),B(H,"NilClass",w.NilClass),(me=w.nil=new w.NilClass).$$id=4,me.call=me.apply=function(){q(w.LocalJumpError,"no block given")},me.$$frozen=!0,me.$$comparable=!1,Object.seal(me),w.thrower=function(y){var W=new Error("unexpected "+y);return W.$thrower_type=y,W.$throw=function(pe){throw null==pe&&(pe=me),W.$v=pe,W},W},w.t_eval_return=w.thrower("return"),TypeError.$$super=Error,w.file_sources={}}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(E){var le=E.type_error,me=E.coerce_to,d=E.module,H=E.defs,J=E.slice,_=E.eqeqeq,x=E.Kernel,O=E.truthy,w=E.Opal,K=E.nil,G=E.$$$;return function(A){var U=d("::","Opal");H(U,"$bridge",function(T,j){return E.bridge(T,j)}),H(U,"$coerce_to!",function(T,j,oe,z){var q,M=K;return q=J(arguments,3),M=me(T,j,oe,q),_(j,M)||x.$raise(le(T,j,oe,M)),M},-4),H(U,"$coerce_to?",function(T,j,oe,z){var X,M=K;return X=J(arguments,3),!O(T["$respond_to?"](oe))||(M=me(T,j,oe,X),O(M["$nil?"]()))?K:(_(j,M)||x.$raise(le(T,j,oe,M)),M)},-4),H(U,"$try_convert",function(T,j,oe){return _(j,T)?T:O(T["$respond_to?"](oe))?T.$__send__(oe):K}),H(U,"$compare",function(T,j){var oe;return oe=T["$<=>"](j),O(oe===K)&&x.$raise(G("ArgumentError"),"comparison of "+T.$class()+" with "+j.$class()+" failed"),oe}),H(U,"$destructure",function(T){if(1==T.length)return T[0];if(T.$$is_array)return T;for(var j=new Array(T.length),oe=0,z=j.length;oe<z;oe++)j[oe]=T[oe];return j}),H(U,"$respond_to?",function(T,j,oe){return null==oe&&(oe=!1),!(null==T||!T.$$class)&&T["$respond_to?"](j,oe)},-3),H(U,"$instance_variable_name!",function(T){return T=w["$coerce_to!"](T,G("String"),"to_str"),O(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(T))||x.$raise(G("NameError").$new("'"+T+"' is not allowed as an instance variable name",T)),T}),H(U,"$class_variable_name!",function(T){return T=w["$coerce_to!"](T,G("String"),"to_str"),O(T.length<3||"@@"!==T.slice(0,2))&&x.$raise(G("NameError").$new("`"+T+"' is not allowed as a class variable name",T)),T}),H(U,"$const_name?",function(T){return"string"!=typeof T&&(T=w["$coerce_to!"](T,G("String"),"to_str")),T[0]===T[0].toUpperCase()}),H(U,"$const_name!",function(T){return O(G("::","String","skip_raise")?"constant":K)&&(T=w["$coerce_to!"](T,G("String"),"to_str")),(!T||T[0]!=T[0].toUpperCase())&&this.$raise(G("NameError"),"wrong constant name "+T),T}),H(U,"$pristine",function(T,j){for(var z,X,M=(z=J(arguments,1)).length-1;M>=0;M--)(X=T.$$prototype[E.jsid(z[M])])&&!X.$$stub&&(X.$$pristine=!0);return K},-2);var N=[];return H(U,"$inspect",function(T){var oe=!1;return function(){try{try{return null===T?"null":void 0===T?"undefined":typeof T.$$class>"u"?Object.prototype.toString.apply(T):"function"!=typeof T.$inspect||T.$inspect.$$stub||-1!==N.indexOf(T.$__id__())?"#<"+T.$$class+":0x"+T.$__id__().$to_s(16)+">":(N.push(T.$__id__()),oe=!0,T.$inspect())}catch(z){if(!E.rescue(z,[G("Exception")]))throw z;try{return"#<"+T.$$class+":0x"+T.$__id__().$to_s(16)+">"}finally{E.pop_exception()}}}finally{oe&&N.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(E){var l,c,f,u,le=E.truthy,me=E.coerce_to,d=E.const_set,H=E.Object,J=E.return_ivar,_=E.assign_ivar,x=E.ivar,O=E.deny_frozen_access,w=E.freeze,K=E.prop,G=E.jsid,A=E.klass,U=E.defs,N=E.send,Y=E.def,T=E.eqeqeq,j=E.Module,oe=E.Kernel,z=E.rb_lt,q=E.rb_gt,X=E.slice,M=E.to_a,I=E.hash2,Q=E.Opal,L=E.return_val,S=E.eqeq,k=E.lambda,v=E.range,P=E.send2,B=E.find_super,te=E.alias,fe=E.nil,R=E.$$$;return l=[],c=A("::",null,"Module"),f=[c].concat(l),u=E.$r(f),U(c,"$allocate",function(){var C=E.allocate_module(fe,function(){});return this!==E.Module&&Object.setPrototypeOf(C,this.$$prototype),C}),Y(c,"$initialize",function p(){var m=p.$$p||fe;return p.$$p=null,m!==fe?N(this,"module_eval",[],m.$to_proc()):fe}),Y(c,"$===",function(m){return!le(null==m)&&E.is_a(m,this)}),Y(c,"$<",function(m){var re,se,Ee,C=this;if(T(j,m)||oe.$raise(R("TypeError"),"compared with non class/module"),C===m)return!1;for(se=0,Ee=(re=E.ancestors(C)).length;se<Ee;se++)if(re[se]===m)return!0;for(se=0,Ee=(re=E.ancestors(m)).length;se<Ee;se++)if(re[se]===C)return!1;return fe}),Y(c,"$<=",function(m){var $;return le($=this["$equal?"](m))?$:z(this,m)}),Y(c,"$>",function(m){return T(j,m)||oe.$raise(R("TypeError"),"compared with non class/module"),z(m,this)}),Y(c,"$>=",function(m){var $;return le($=this["$equal?"](m))?$:q(this,m)}),Y(c,"$<=>",function(m){var $=fe;return this===m?0:!T(j,m)||($=z(this,m),le($["$nil?"]()))?fe:le($)?-1:1}),Y(c,"$alias_method",function(m,C){var $=this;return O($),m=me(m,R("String"),"to_str"),C=me(C,R("String"),"to_str"),E.alias($,m,C),$}),Y(c,"$alias_native",function(m,C){var $=this;return null==C&&(C=m),O($),E.alias_native($,m,C),$},-2),Y(c,"$ancestors",function(){return E.ancestors(this)}),Y(c,"$append_features",function(m){return O(m),E.append_features(this,m),this}),Y(c,"$attr_accessor",function(m){var C,$,re=this;return C=X(arguments),N(re,"attr_reader",M($=C)),N(re,"attr_writer",M($))},-1),Y(c,"$attr",function(m){var $,re=this;return 2!=($=X(arguments)).length||!0!==$[1]&&!1!==$[1]?N(re,"attr_reader",M($)):(re.$warn("optional boolean argument is obsoleted",I(["uplevel"],{uplevel:1})),$[1]?re.$attr_accessor($[0]):re.$attr_reader($[0]),fe)},-1),Y(c,"$attr_reader",function(m){var $,re=this;$=X(arguments),O(re);for(var se=re.$$prototype,Ee=$.length-1;Ee>=0;Ee--){var Me=$[Ee],ce=G(Me),ke=x(Me),ve=J(ke);E.prop(se,ke,fe),ve.$$parameters=[],ve.$$arity=0,E.defn(re,ce,ve)}return fe},-1),Y(c,"$attr_writer",function(m){var $,re=this;$=X(arguments),O(re);for(var se=re.$$prototype,Ee=$.length-1;Ee>=0;Ee--){var Me=$[Ee],ce=G(Me+"="),ke=x(Me),ve=_(ke);ve.$$parameters=[["req"]],ve.$$arity=1,E.prop(se,ke,fe),E.defn(re,ce,ve)}return fe},-1),Y(c,"$autoload",function(m,C){var $=this;return O($),u("Opal")["$const_name?"](m)||oe.$raise(R("NameError"),"autoload must be constant name: "+m),""==C&&oe.$raise(R("ArgumentError"),"empty file name"),$.$$const.hasOwnProperty(m)||($.$$autoload||($.$$autoload={}),E.const_cache_version++,$.$$autoload[m]={path:C,loaded:!1,required:!1,success:!1,exception:!1},$.$const_added&&!$.$const_added.$$pristine&&$.$const_added(m)),fe}),Y(c,"$autoload?",function(m){var C=this;if(C.$$autoload&&C.$$autoload[m]&&!C.$$autoload[m].required&&!C.$$autoload[m].success)return C.$$autoload[m].path;for(var $=C.$ancestors(),re=0,se=$.length;re<se;re++)if($[re].$$autoload&&$[re].$$autoload[m]&&!$[re].$$autoload[m].required&&!$[re].$$autoload[m].success)return $[re].$$autoload[m].path;return fe}),Y(c,"$class_variables",function(){return Object.keys(E.class_variables(this))}),Y(c,"$class_variable_get",function(m){return m=Q["$class_variable_name!"](m),E.class_variable_get(this,m,!1)}),Y(c,"$class_variable_set",function(m,C){return O(this),m=Q["$class_variable_name!"](m),E.class_variable_set(this,m,C)}),Y(c,"$class_variable_defined?",function(m){return m=Q["$class_variable_name!"](m),E.class_variables(this).hasOwnProperty(m)}),Y(c,"$const_added",L(fe)),Q.$pristine(c,"const_added"),Y(c,"$remove_class_variable",function(m){var C=this;if(O(C),m=Q["$class_variable_name!"](m),E.hasOwnProperty.call(C.$$cvars,m)){var $=C.$$cvars[m];return delete C.$$cvars[m],$}oe.$raise(R("NameError"),"cannot remove "+m+" for "+C)}),Y(c,"$constants",function(m){return null==m&&(m=!0),E.constants(this,m)},-1),U(c,"$constants",function(m){if(null==m){var re,Ee,Me,$=(this.$$nesting||[]).concat(H),se={};for(Ee=0,Me=$.length;Ee<Me;Ee++)for(re in $[Ee].$$const)se[re]=!0;return Object.keys(se)}return E.constants(this,m)},-1),U(c,"$nesting",function(){return this.$$nesting||[]}),Y(c,"$const_defined?",function(m,C){var $=this;null==C&&(C=!0),m=u("Opal")["$const_name!"](m),le(m["$=~"](R(Q,"CONST_NAME_REGEXP")))||oe.$raise(R("NameError").$new("wrong constant name "+m,m));var re,Me,ce,se=[$];for(C&&(se=se.concat(E.ancestors($)),$.$$is_module&&(se=se.concat([H]).concat(E.ancestors(H)))),Me=0,ce=se.length;Me<ce;Me++)if(null!=(re=se[Me]).$$const[m]||re.$$autoload&&re.$$autoload[m]&&!re.$$autoload[m].required&&!re.$$autoload[m].success)return!0;return!1},-2),Y(c,"$const_get",function(m,C){var $=this;return null==C&&(C=!0),0===(m=u("Opal")["$const_name!"](m)).indexOf("::")&&"::"!==m&&(m=m.slice(2)),le(-1!=m.indexOf("::")&&"::"!=m)?N(m.$split("::"),"inject",[$],function(se,Ee){return null==se&&(se=fe),null==Ee&&(Ee=fe),se.$const_get(Ee)}):(le(m["$=~"](R(Q,"CONST_NAME_REGEXP")))||oe.$raise(R("NameError").$new("wrong constant name "+m,m)),C?E.$$([$],m):E.const_get_local($,m))},-2),Y(c,"$const_missing",function(m){var $;return $=S(this,H)?m:this+"::"+m,oe.$raise(R("NameError").$new("uninitialized constant "+$,m))}),Y(c,"$const_set",function(m,C){return O(this),m=Q["$const_name!"](m),(le(m["$!~"](R(Q,"CONST_NAME_REGEXP")))||le(m["$start_with?"]("::")))&&oe.$raise(R("NameError").$new("wrong constant name "+m,m)),d(this,m,C),C}),Y(c,"$public_constant",L(fe)),Y(c,"$define_method",function p(m,C){var se,$=p.$$p||fe,Ee=fe;return p.$$p=null,O(this),void 0===C&&$===fe&&oe.$raise(R("ArgumentError"),"tried to create a Proc object without a block"),$=le(se=$)?se:T(R("Proc"),Ee=C)?C:T(R("Method"),Ee)?C.$to_proc().$$unbound:T(R("UnboundMethod"),Ee)?k(function ce(ke){var ye,he=ce.$$s??this,Ie=fe;return ye=X(arguments),Ie=C.$bind(he),N(Ie,"call",M(ye))},{$$arity:-1,$$s:this}):oe.$raise(R("TypeError"),"wrong argument type "+$.$class()+" (expected Proc/Method)"),typeof Proxy<"u"&&($.$$proxy_target=$,$=new Proxy($,{apply:function(ce,ke,ve){var ye=ce.$$jsid;ce.$$jsid=m;try{return ce.apply(ke,ve)}catch(he){if(he===ce.$$brk||he===ce.$$ret)return he.$v;throw he}finally{ce.$$jsid=ye}}})),$.$$jsid=m,$.$$s=null,$.$$def=$,$.$$define_meth=!0,E.defn(this,G(m),$)},-2),Y(c,"$freeze",function(){var m=this;return le(m["$frozen?"]())?m:(m.hasOwnProperty("$$base_module")||K(m,"$$base_module",null),w(m))}),Y(c,"$remove_method",function(m){var $,re=this;$=X(arguments);for(var se=0;se<$.length;se++){var Ee=$[se];"string"==typeof Ee||Ee.$$is_string||re.$raise(R("TypeError"),re.$name()+" is not a symbol nor a string"),O(re),E.rdef(re,"$"+Ee)}return re},-1),Y(c,"$singleton_class?",function(){return!!this.$$is_singleton}),Y(c,"$include",function(m){for(var $,re=this,se=($=X(arguments)).length-1;se>=0;se--){var Ee=$[se];Ee.$$is_module||oe.$raise(R("TypeError"),"wrong argument type "+Ee.$class()+" (expected Module)"),Ee.$append_features(re),Ee.$included(re)}return re},-1),Y(c,"$included_modules",function(){return E.included_modules(this)}),Y(c,"$include?",function(m){m.$$is_module||oe.$raise(R("TypeError"),"wrong argument type "+m.$class()+" (expected Module)");var $,re,se,Ee=E.ancestors(this);for($=0,re=Ee.length;$<re;$++)if((se=Ee[$])===m&&se!==this)return!0;return!1}),Y(c,"$instance_method",function(m){var C=this,$=C.$$prototype[G(m)];return(!$||$.$$stub)&&oe.$raise(R("NameError").$new("undefined method `"+m+"' for class `"+C.$name()+"'",m)),R("UnboundMethod").$new(C,$.$$owner||C,$,m)}),Y(c,"$instance_methods",function(m){return null==m&&(m=!0),le(m)?E.instance_methods(this):E.own_instance_methods(this)},-1),Y(c,"$included",L(fe)),Y(c,"$extended",L(fe)),Y(c,"$extend_object",function(m){return O(m),fe}),Y(c,"$method_added",function(m){return X(arguments),fe},-1),Y(c,"$method_removed",function(m){return X(arguments),fe},-1),Y(c,"$method_undefined",function(m){return X(arguments),fe},-1),Y(c,"$module_eval",function p(m){var re,se,C=p.$$p||fe,Ee=this,Me=fe,ve=fe,ye=fe,he=fe,Ie=fe;p.$$p=null,re=X(arguments),le(C["$nil?"]())&&le(!!E.compile)?(le(v(1,3,!1)["$cover?"](re.$size()))||oe.$raise(R("ArgumentError"),"wrong number of arguments (0 for 1..3)"),Me=(se=[].concat(M(re)))[0]??fe,ve=I(["file","eval"],{file:le(ye=se[1]??fe)?ye:"(eval)",eval:!0}),he=E.hash({arity_check:!1}).$merge(ve),Ie=Q.$compile(Me,he),C=N(oe,"proc",[],function ue(){var xe=ue.$$s??this;return new Function("Opal,self","return "+Ie)(E,xe)},{$$s:Ee})):le(re["$any?"]())&&oe.$raise(R("ArgumentError"),"wrong number of arguments ("+re.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var ae,be=C.$$s;return C.$$s=null,ae=C.apply(Ee,[Ee]),C.$$s=be,ae},-1),Y(c,"$module_exec",function p(m){var re,C=p.$$p||fe,se=this;p.$$p=null,re=X(arguments),C===fe&&oe.$raise(R("LocalJumpError"),"no block given");var Me,Ee=C.$$s;return C.$$s=null,Me=C.apply(se,re),C.$$s=Ee,Me},-1),Y(c,"$method_defined?",function(m){var $=this.$$prototype[G(m)];return!!$&&!$.$$stub}),Y(c,"$module_function",function(m){var $,re=this;if($=X(arguments),O(re),0===$.length)return re.$$module_function=!0,fe;for(var se=0,Ee=$.length;se<Ee;se++){var Me=$[se],ce=G(Me),ke=re.$$prototype[ce];E.defs(re,ce,ke)}return 1===$.length?$[0]:$},-1),Y(c,"$name",function(){var m=this;if(m.$$full_name)return m.$$full_name;for(var C=[],$=m;$;){if($.$$name===fe||null==$.$$name)return fe;if(C.unshift($.$$name),($=$.$$base_module)===H)break}return 0===C.length?fe:m.$$full_name=C.join("::")}),Y(c,"$prepend",function(m){var $,re=this;0===($=X(arguments)).length&&oe.$raise(R("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var se=$.length-1;se>=0;se--){var Ee=$[se];Ee.$$is_module||oe.$raise(R("TypeError"),"wrong argument type "+Ee.$class()+" (expected Module)"),Ee.$prepend_features(re),Ee.$prepended(re)}return re},-1),Y(c,"$prepend_features",function(m){var C=this;return O(m),C.$$is_module||oe.$raise(R("TypeError"),"wrong argument type "+C.$class()+" (expected Module)"),E.prepend_features(C,m),C}),Y(c,"$prepended",L(fe)),Y(c,"$remove_const",function(m){return O(this),E.const_remove(this,m)}),Y(c,"$to_s",function(){var C,m=this;return le(C=E.Module.$name.call(m))?C:"#<"+(m.$$is_module?"Module":"Class")+":0x"+m.$__id__().$to_s(16)+">"}),Y(c,"$undef_method",function(m){var $,re=this;$=X(arguments);for(var se=0;se<$.length;se++){var Ee=$[se];"string"==typeof Ee||Ee.$$is_string||re.$raise(R("TypeError"),re.$name()+" is not a symbol nor a string"),O(re),E.udef(re,"$"+$[se])}return re},-1),Y(c,"$instance_variables",function(){var m=this,C=fe;E.Module.$$nesting=f,C=m.$constants();var $=[];for(var re in m)m.hasOwnProperty(re)&&"$"!==re.charAt(0)&&"constructor"!==re&&!C["$include?"](re)&&$.push("@"+re);return $}),Y(c,"$dup",function p(){var m=p.$$p||fe,C=this,$=fe;return p.$$p=null,($=P(C,B(C,"dup",p,!1,!0),"dup",[],m)).$copy_class_variables(C),$.$copy_constants(C),$}),Y(c,"$copy_class_variables",function(m){for(var $ in m.$$cvars)this.$$cvars[$]=m.$$cvars[$]}),Y(c,"$copy_constants",function(m){var $,re=m.$$const;for($ in re)d(this,$,re[$])}),Y(c,"$refine",function p(m){var $,se,Me,C=p.$$p||fe,re=this,Ee=fe;return p.$$p=null,se=($=[re,fe,fe])[0],Ee=$[1],Me=E.id(m),typeof re.$$refine_modules>"u"&&(re.$$refine_modules=Object.create(null)),(Ee=typeof re.$$refine_modules[Me]>"u"?re.$$refine_modules[Me]=R("Refinement").$new():re.$$refine_modules[Me]).refinement_module=se,Ee.refined_class=m,N(Ee,"class_exec",[],C.$to_proc()),Ee}),Y(c,"$refinements",function(){var C=this.$$refine_modules,$=I([],{});if(typeof C>"u")return $;for(var re in C)$["$[]="](C[re].refined_class,C[re]);return $}),Y(c,"$using",function(m){return oe.$raise("Module#using is not permitted in methods")}),te(c,"class_eval","module_eval"),te(c,"class_exec","module_exec"),te(c,"inspect","to_s"),function(F,g){var l=A("::",g,"Refinement"),c=l.$$prototype;return c.refinement_module=c.refined_class=fe,l.$attr_reader("refined_class"),Y(l,"$inspect",function f(){var u=f.$$p||fe,p=this;return f.$$p=null,le(p.refinement_module)?"#<refinement:"+p.refined_class.$inspect()+"@"+p.refinement_module.$inspect()+">":P(p,B(p,"inspect",f,!1,!0),"inspect",[],u)})}(0,j)},Opal.modules["corelib/class"]=function(E){var oe,z,q,X,le=E.klass,me=E.send,d=E.defs,H=E.def,J=E.rb_plus,_=E.return_val,x=E.slice,O=E.send2,w=E.find_super,K=E.Kernel,G=E.alias,N=E.nil,Y=E.$$$;return E.top.$require("corelib/module"),oe=[],q=[z=le("::",null,"Class")].concat(oe),X=E.$r(q),d(z,"$new",function M(I){var Q=M.$$p||N;if(M.$$p=null,null==I&&(I=X("Object")),!I.$$is_class)throw E.TypeError.$new("superclass must be a Class");var L=E.allocate_class(N,I);return I.$inherited(L),Q!==N&&me(L,"class_eval",[],Q.$to_proc()),L},-1),H(z,"$allocate",function(){var Q=new this.$$constructor;return Q.$$id=E.uid(),Q}),H(z,"$descendants",function(){return J(this.$subclasses(),me(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())}),H(z,"$inherited",_(N)),H(z,"$initialize_dup",function(I){var Q=this;Q.$initialize_copy(I),Q.$$name=null,Q.$$full_name=null}),H(z,"$new",function M(I){var S,Q=M.$$p||N,k=this;M.$$p=null,S=x(arguments);var v=k.$allocate();return E.send(v,v.$initialize,S,Q),v},-1),H(z,"$subclasses",function(){var I=this;if(typeof WeakRef<"u"){var Q,L,S=[];for(Q=0;Q<I.$$subclasses.length;Q++)void 0!==(L=I.$$subclasses[Q].deref())&&S.push(L);return S}return I.$$subclasses}),H(z,"$superclass",function(){return this.$$super||N}),H(z,"$to_s",function M(){var Q=this;M.$$p=null;var L=Q.$$singleton_of;return L&&L.$$is_a_module?"#<Class:"+L.$name()+">":L?"#<Class:#<"+L.$$class.$name()+":0x"+E.id(L).$to_s(16)+">>":O(Q,w(Q,"to_s",M,!1,!0),"to_s",[],null)}),H(z,"$attached_object",function(){var I=this;if(null!=I.$$singleton_of)return I.$$singleton_of;K.$raise(Y("TypeError"),"`"+I+"' is not a singleton class")}),G(z,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(E){"use strict";var z,me=E.slice,d=E.def,H=E.alias,J=E.return_val,_=E.Opal,x=E.truthy,O=E.range,w=E.Kernel,K=E.to_a,G=E.hash2,A=E.send,U=E.eqeq,N=E.rb_ge,Y=E.nil,T=E.$$$;return d(z=(0,E.klass)("::",null,"BasicObject"),"$initialize",function(X){return me(arguments),Y},-1),d(z,"$==",function(X){return this===X}),d(z,"$eql?",function(X){return this["$=="](X)}),H(z,"equal?","=="),d(z,"$__id__",function(){var X=this;return null!=X.$$id||E.prop(X,"$$id",E.uid()),X.$$id}),d(z,"$__send__",function q(X,M){var L,I=q.$$p||Y,S=this;q.$$p=null,L=me(arguments,1),X.$$is_string||S.$raise(T("TypeError"),S.$inspect()+" is not a symbol nor a string");var k=S[E.jsid(X)];return k?(I!==Y&&(k.$$p=I),k.apply(S,L)):(I!==Y&&(S.$method_missing.$$p=I),S.$method_missing.apply(S,[X].concat(L)))},-2),d(z,"$!",J(!1)),_.$pristine("!"),d(z,"$!=",function(X){return this["$=="](X)["$!"]()}),d(z,"$instance_eval",function q(X){var Q,L,M=q.$$p||Y,S=this,k=Y,B=Y,te=Y,D=Y,fe=Y;if(q.$$p=null,Q=me(arguments),x(M["$nil?"]())&&x(!!E.compile))x(O(1,3,!1)["$cover?"](Q.$size()))||w.$raise(T("ArgumentError"),"wrong number of arguments (0 for 1..3)"),k=(L=[].concat(K(Q)))[0]??Y,B=G(["file","eval"],{file:x(te=L[1]??Y)?te:"(eval)",eval:!0}),D=E.hash({arity_check:!1}).$merge(B),fe=_.$compile(k,D),M=A(w,"proc",[],function g(){var l=g.$$s??this;return new Function("Opal,self","return "+fe)(E,l)},{$$s:S});else{if(x(M["$nil?"]())&&x(N(Q.$length(),1))&&U(Q.$first()["$[]"](0),"@"))return S.$instance_variable_get(Q.$first());x(Q["$any?"]())&&w.$raise(T("ArgumentError"),"wrong number of arguments ("+Q.$size()+" for 0)")}var F,R=M.$$s;if(M.$$s=null,S.$$is_a_module){S.$$eval=!0;try{F=M.call(S,S)}finally{S.$$eval=!1}}else F=M.call(S,S);return M.$$s=R,F},-1),d(z,"$instance_exec",function q(X){var Q,M=q.$$p||Y,L=this;q.$$p=null,Q=me(arguments),x(M)||w.$raise(T("ArgumentError"),"no block given");var k,S=M.$$s;if(M.$$s=null,L.$$is_a_module){L.$$eval=!0;try{k=M.apply(L,Q)}finally{L.$$eval=!1}}else k=M.apply(L,Q);return M.$$s=S,k},-1),d(z,"$singleton_method_added",function(X){return me(arguments),Y},-1),d(z,"$singleton_method_removed",function(X){return me(arguments),Y},-1),d(z,"$singleton_method_undefined",function(X){return me(arguments),Y},-1),d(z,"$method_missing",function q(X,M){var L,S=this,k=Y;return q.$$p=null,L=me(arguments,1),k=_.$inspect(S),w.$raise(T("NoMethodError").$new("undefined method `"+X+"' for "+k,X,L),Y,w.$caller(1))},-2),_.$pristine(z,"method_missing"),d(z,"$respond_to_missing?",function(X,M){return null==M&&(M=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(E){"use strict";var R,le=E.truthy,me=E.coerce_to,d=E.respond_to,H=E.Opal,J=E.deny_frozen_access,_=E.freeze,x=E.freeze_props,O=E.jsid,w=E.module,K=E.return_val,G=E.def,A=E.Kernel,U=E.gvars,N=E.slice,Y=E.send,T=E.to_a,j=E.ensure_kwargs,oe=E.eqeq,z=E.hash2,q=E.rb_plus,X=E.eqeqeq,M=E.return_self,I=E.rb_le,Q=E.extract_kwargs,L=E.rb_lt,S=E.Object,k=E.alias,v=E.klass,B=E.nil,te=E.$$$;return function(D,fe){var R=w("::","Kernel"),F=[R].concat([]),g=E.$r(F);G(R,"$=~",K(!1)),G(R,"$!~",function(f){return this["$=~"](f)["$!"]()}),G(R,"$===",function(f){var p;return le(p=this.$object_id()["$=="](f.$object_id()))?p:this["$=="](f)}),G(R,"$<=>",function(f){this.$$comparable=!0;var p=this["$=="](f);return p&&p!==B?0:B}),G(R,"$method",function(f){var u=this,p=u[O(f)];return(!p||p.$$stub)&&A.$raise(te("NameError").$new("undefined method `"+f+"' for class `"+u.$class()+"'",f)),te("Method").$new(u,p.$$owner||u.$class(),p,f)}),G(R,"$methods",function(f){return null==f&&(f=!0),le(f)?E.methods(this):E.own_methods(this)},-1),G(R,"$public_methods",function(f){return null==f&&(f=!0),le(f)?E.methods(this):E.receiver_methods(this)},-1),G(R,"$Array",function(f){var u;return f===B?[]:f.$$is_array?f:(u=H["$coerce_to?"](f,te("Array"),"to_ary"))!==B||(u=H["$coerce_to?"](f,te("Array"),"to_a"))!==B?u:[f]}),G(R,"$at_exit",function c(){var u,f=c.$$p||B;return null==U.__at_exit__&&(U.__at_exit__=B),c.$$p=null,U.__at_exit__=le(u=U.__at_exit__)?u:[],U.__at_exit__["$<<"](f),f}),G(R,"$caller",function(f,u){var p,m;null==f&&(f=1),null==u&&(u=B),m=[];for(var C=f+1,$=(p=(new Error).$backtrace()).length;C<$;C++)p[C].match(/runtime\.js/)||m.push(p[C]);return u!=B&&(m=m.slice(0,u)),m},-1),G(R,"$caller_locations",function(f){var u,m=this;return u=N(arguments),Y(Y(m,"caller",T(u)),"map",[],function($){return null==$&&($=B),te(te(te("Thread"),"Backtrace"),"Location").$new($)})},-1),G(R,"$class",function(){return this.$$class}),G(R,"$copy_instance_variables",function(f){var m,C,$,p=Object.keys(f);for(m=0,C=p.length;m<C;m++)"$"!==($=p[m]).charAt(0)&&f.hasOwnProperty($)&&(this[$]=f[$])}),G(R,"$copy_singleton_methods",function(f){var p,m,C,$;if(f.hasOwnProperty("$$meta")&&null!==f.$$meta){var re=E.get_singleton_class(f),se=E.get_singleton_class(this);for(p=0,$=(C=Object.getOwnPropertyNames(re.$$prototype)).length;p<$;p++)E.is_method(m=C[p])&&(se.$$prototype[m]=re.$$prototype[m]);se.$$const=Object.assign({},re.$$const),Object.setPrototypeOf(se.$$prototype,Object.getPrototypeOf(re.$$prototype))}for(p=0,$=(C=Object.getOwnPropertyNames(f)).length;p<$;p++)"$"===(m=C[p]).charAt(0)&&"$"!==m.charAt(1)&&f.hasOwnProperty(m)&&(this[m]=f[m])}),G(R,"$clone",function(f){var u,p=this,m=B;return null==(u=(f=j(f)).$$smap.freeze)&&(u=B),le(u["$nil?"]())||oe(u,!0)||oe(u,!1)||p.$raise(g("ArgumentError"),"unexpected value for freeze: "+u.$class()),(m=p.$class().$allocate()).$copy_instance_variables(p),m.$copy_singleton_methods(p),m.$initialize_clone(p,z(["freeze"],{freeze:u})),(oe(u,!0)||le(u["$nil?"]())&&le(p["$frozen?"]()))&&m.$freeze(),m},-1),G(R,"$initialize_clone",function(f,u){return u=j(u),this.$initialize_copy(f),this},-2),G(R,"$define_singleton_method",function c(f,u){var p=c.$$p||B;return c.$$p=null,Y(this.$singleton_class(),"define_method",[f,u],p.$to_proc())},-2),G(R,"$dup",function(){var f=this,u=B;return(u=f.$class().$allocate()).$copy_instance_variables(f),u.$initialize_dup(f),u}),G(R,"$initialize_dup",function(f){return this.$initialize_copy(f)}),G(R,"$enum_for",function c(f,u){var m,C,$,p=c.$$p||B,re=this;return c.$$p=null,(m=N(arguments)).length>0&&(C=m.shift()),null==C&&(C="each"),$=m,Y(te("Enumerator"),"for",[re,C].concat(T($)),p.$to_proc())},-1),G(R,"$equal?",function(f){return this===f}),G(R,"$exit",function(f){var u;for(null==U.__at_exit__&&(U.__at_exit__=B),null==f&&(f=!0),U.__at_exit__=le(u=U.__at_exit__)?u:[];!le(U.__at_exit__["$empty?"]());)U.__at_exit__.$pop().$call();return f=f.$$is_boolean?f?0:1:me(f,te("Integer"),"to_int"),E.exit(f),B},-1),G(R,"$extend",function(f){var p,m=this;0==(p=N(arguments)).length&&m.$raise(te("ArgumentError"),"wrong number of arguments (given 0, expected 1+)"),J(m);for(var C=m.$singleton_class(),$=p.length-1;$>=0;$--){var re=p[$];re.$$is_module||A.$raise(te("TypeError"),"wrong argument type "+re.$class()+" (expected Module)"),re.$append_features(C),re.$extend_object(m),re.$extended(m)}return m},-1),G(R,"$freeze",function(){var f=this;return le(f["$frozen?"]())?f:"object"==typeof f?(x(f),_(f)):f}),G(R,"$frozen?",function(){switch(typeof this){case"string":case"symbol":case"number":case"boolean":return!0;case"object":return this.$$frozen||!1;default:return!1}}),G(R,"$gets",function(f){var u;return null==U.stdin&&(U.stdin=B),u=N(arguments),Y(U.stdin,"gets",T(u))},-1),G(R,"$hash",function(){return this.$__id__()}),G(R,"$initialize_copy",K(B));var l=[];G(R,"$inspect",function(){var f=this,u=B,p=B,m=B;return function(){try{try{return u="",p=f.$__id__(),le(l["$include?"](p))?u=" ...":(l["$<<"](p),m=!0,Y(f.$instance_variables(),"each",[],function $(re){var Ee,Me;return null==re&&(re=B),Ee=($.$$s??this).$instance_variable_get(re),Me=g("Opal").$inspect(Ee),u=q(u," "+re+"="+Me)},{$$s:f})),"#<"+f.$class()+":0x"+p.$to_s(16)+u+">"}catch($){if(!E.rescue($,[g("StandardError")]))throw $;try{return"#<"+f.$class()+":0x"+p.$to_s(16)+">"}finally{E.pop_exception()}}}finally{le(m)&&l.$pop()}}()}),G(R,"$instance_of?",function(f){return!f.$$is_class&&!f.$$is_module&&A.$raise(te("TypeError"),"class or module required"),this.$$class===f}),G(R,"$instance_variable_defined?",function(f){return f=H["$instance_variable_name!"](f),E.hasOwnProperty.call(this,f.substr(1))}),G(R,"$instance_variable_get",function(f){return f=H["$instance_variable_name!"](f),this[E.ivar(f.substr(1))]??B}),G(R,"$instance_variable_set",function(f,u){return J(this),f=H["$instance_variable_name!"](f),this[E.ivar(f.substr(1))]=u}),G(R,"$remove_instance_variable",function(f){var u=this;f=H["$instance_variable_name!"](f);var m,p=E.ivar(f.substr(1));return u.hasOwnProperty(p)?(m=u[p],delete u[p],m):A.$raise(te("NameError"),"instance variable "+f+" not defined")}),G(R,"$instance_variables",function(){var p,u=[];for(var m in this)this.hasOwnProperty(m)&&"$"!==m.charAt(0)&&(p="$"===m.substr(-1)?m.slice(0,m.length-1):m,u.push("@"+p));return u}),G(R,"$Integer",function(f,u){var p,m,C;return f.$$is_string?"0"===f?0:(void 0===u?u=0:(1===(u=me(u,te("Integer"),"to_int"))||u<0||u>36)&&A.$raise(te("ArgumentError"),"invalid radix "+u),m=(m=(m=f.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function($,re,se){switch(se){case"0b":if(0===u||2===u)return u=2,re;case"0":case"0o":if(0===u||8===u)return u=8,re;case"0d":if(0===u||10===u)return u=10,re;case"0x":if(0===u||16===u)return u=16,re}A.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"')}),C="0-"+((u=0===u?10:u)<=10?u-1:"9a-"+String.fromCharCode(u-11+97)),new RegExp("^\\s*[+-]?["+C+"]+\\s*$").test(m)||A.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"'),p=parseInt(m,u),isNaN(p)&&A.$raise(te("ArgumentError"),'invalid value for Integer(): "'+f+'"'),p):(void 0!==u&&A.$raise(te("ArgumentError"),"base specified for non string value"),f===B&&A.$raise(te("TypeError"),"can't convert nil into Integer"),f.$$is_number?((f===1/0||f===-1/0||isNaN(f))&&A.$raise(te("FloatDomainError"),f),Math.floor(f)):f["$respond_to?"]("to_int")&&(p=f.$to_int())!==B?p:H["$coerce_to!"](f,te("Integer"),"to_i"))},-2),G(R,"$Float",function(f){var u;return f===B&&A.$raise(te("TypeError"),"can't convert nil into Float"),f.$$is_string?(u=(u=f.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(u)?A.$Integer(u):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(u)||A.$raise(te("ArgumentError"),'invalid value for Float(): "'+f+'"'),parseFloat(u))):H["$coerce_to!"](f,te("Float"),"to_f")}),G(R,"$Hash",function(f){return le(f["$nil?"]())||oe(f,[])?z([],{}):X(te("Hash"),f)?f:H["$coerce_to!"](f,te("Hash"),"to_hash")}),G(R,"$is_a?",function(f){return!f.$$is_class&&!f.$$is_module&&A.$raise(te("TypeError"),"class or module required"),E.is_a(this,f)}),G(R,"$itself",M),G(R,"$lambda",function c(){var f=c.$$p||B;return c.$$p=null,E.lambda(f)}),G(R,"$load",function(f){return f=H["$coerce_to!"](f,te("String"),"to_str"),E.load(f)}),G(R,"$loop",function c(){var f=c.$$p||B,p=B;if(c.$$p=null,f===B)return Y(this,"enum_for",["loop"],function(){return te(te("Float"),"INFINITY")});for(;le(!0);)try{E.yieldX(f,[])}catch(m){if(!E.rescue(m,[te("StopIteration")]))throw m;p=m;try{return p.$result()}finally{E.pop_exception()}}return this}),G(R,"$nil?",K(!1)),G(R,"$printf",function(f){var u,p,m=this;return u=N(arguments),le((p=u)["$any?"]())&&m.$print(Y(m,"format",T(p))),B},-1),G(R,"$proc",function c(){var f=c.$$p||B;return c.$$p=null,le(f)||A.$raise(te("ArgumentError"),"tried to create Proc object without a block"),f.$$is_lambda=!1,f}),G(R,"$puts",function(f){var u;return null==U.stdout&&(U.stdout=B),u=N(arguments),Y(U.stdout,"puts",T(u))},-1),G(R,"$p",function(f){var u,p;return u=N(arguments),Y(p=u,"each",[],function(C){return null==U.stdout&&(U.stdout=B),null==C&&(C=B),U.stdout.$puts(C.$inspect())}),le(I(p.$length(),1))?p["$[]"](0):p},-1),G(R,"$print",function(f){var u;return null==U.stdout&&(U.stdout=B),u=N(arguments),Y(U.stdout,"print",T(u))},-1),G(R,"$readline",function(f){var u;return null==U.stdin&&(U.stdin=B),u=N(arguments),Y(U.stdin,"readline",T(u))},-1),G(R,"$warn",function(f,u){var p,m,C,$,re,se,Ee=this,Me=B;return null==U.VERBOSE&&(U.VERBOSE=B),null==U.stderr&&(U.stderr=B),p=N(arguments),m=Q(p),C=p,null==($=(m=j(m)).$$smap.uplevel)&&($=B),le($)&&($=H["$coerce_to!"]($,te("Integer"),"to_str"),le(L($,0))&&A.$raise(te("ArgumentError"),"negative level ("+$+")"),re=(se=Ee.$caller(q($,1),1).$first())===B||null==se?B:se.$split(":in `"),Me=re===B||null==re?B:re.$first(),le(Me)&&(Me+=": "),C=Y(C,"map",[],function(ke){return null==ke&&(ke=B),Me+"warning: "+ke})),le(U.VERBOSE["$nil?"]())||le(C["$empty?"]())?B:Y(U.stderr,"puts",T(C))},-1),G(R,"$raise",function(f,u,p){throw null==U["!"]&&(U["!"]=B),null==U["@"]&&(U["@"]=B),null==u&&(u=B),null==p&&(p=B),null==f&&U["!"]!==B?U["!"]:(null==f?f=te("RuntimeError").$new(""):d(f,"$to_str")?f=te("RuntimeError").$new(f.$to_str()):f.$$is_class&&d(f,"$exception")?f=f.$exception(u):f.$$is_exception||(f=te("TypeError").$new("exception class/object expected")),p!==B&&f.$set_backtrace(p),U["!"]!==B&&E.exceptions.push(U["!"]),U["!"]=f,U["@"]=f.$backtrace(),f)},-1),G(R,"$rand",function(f){return void 0===f?te(te("Random"),"DEFAULT").$rand():(f.$$is_number&&(f<0&&(f=Math.abs(f)),f%1!=0&&(f=f.$to_i()),0===f&&(f=void 0)),te(te("Random"),"DEFAULT").$rand(f))},-1),G(R,"$respond_to?",function(f,u){var p=this;null==u&&(u=!1);var m=p[O(f)];return"function"==typeof m&&!m.$$stub||!0!==p["$respond_to_missing?"].$$pristine&&p["$respond_to_missing?"](f,u)},-2),G(R,"$respond_to_missing?",function(f,u){return null==u&&(u=!1),!1},-2),H.$pristine(R,"respond_to?","respond_to_missing?"),G(R,"$require",function(f){return"string"!=typeof f&&E.String&&E.Array&&(f=H["$coerce_to!"](f,te("String"),"to_str")),E.require(f)}),G(R,"$require_relative",function(f){return H["$try_convert!"](f,te("String"),"to_str"),f=te("File").$expand_path(te("File").$join(E.current_file,"..",f)),E.require(f)}),G(R,"$require_tree",function(f,u){var p;null==(p=(u=j(u)).$$smap.autoload)&&(p=!1);var m=[];for(var C in f=te("File").$expand_path(f),"."===(f=E.normalize(f))&&(f=""),E.modules)C["$start_with?"](f)&&m.push(p?[C,!0]:[C,E.require(C)]);return m},-2),G(R,"$singleton_class",function(){return E.get_singleton_class(this)}),G(R,"$sleep",function(f){null==f&&(f=B),f===B&&A.$raise(te("TypeError"),"can't convert NilClass into time interval"),f.$$is_number||A.$raise(te("TypeError"),"can't convert "+f.$class()+" into time interval"),f<0&&A.$raise(te("ArgumentError"),"time interval must be positive");for(var u=E.global.performance?function(){return performance.now()}:function(){return new Date},p=u();u()-p<=1e3*f;);return Math.round(f)},-1),G(R,"$srand",function(f){return null==f&&(f=g("Random").$new_seed()),te("Random").$srand(f)},-1),G(R,"$String",function(f){var u;return le(u=H["$coerce_to?"](f,te("String"),"to_str"))?u:H["$coerce_to!"](f,te("String"),"to_s")}),G(R,"$tap",function c(){var f=c.$$p||B;return c.$$p=null,E.yield1(f,this),this}),G(R,"$to_proc",M),G(R,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"}),G(R,"$catch",function c(f){var u=c.$$p||B,p=B,m=B;c.$$p=null,null==f&&(f=B);try{return f=le(p=f)?p:S.$new(),E.yield1(u,f)}catch(C){if(!E.rescue(C,[te("UncaughtThrowError")]))throw C;m=C;try{return oe(m.$tag(),f)?m.$value():A.$raise()}finally{E.pop_exception()}}},-1),G(R,"$throw",function(f,u){return null==u&&(u=B),A.$raise(te("UncaughtThrowError").$new(f,u))},-2),G(R,"$open",function c(f){var m,u=c.$$p||B;return c.$$p=null,m=N(arguments),Y(te("File"),"open",T(m),u.$to_proc())},-1),G(R,"$yield_self",function c(){var f=c.$$p||B;return c.$$p=null,f===B?Y(this,"enum_for",["yield_self"],K(1)):E.yield1(f,this)}),k(R,"fail","raise"),k(R,"kind_of?","is_a?"),k(R,"object_id","__id__"),k(R,"public_send","__send__"),k(R,"send","__send__"),k(R,"then","yield_self"),k(R,"to_enum","enum_for")}(),R=v("::",null,"Object"),delete S.$$prototype.$require,R.$include(A)},Opal.modules["corelib/main"]=function(E){var w,le=E.return_val,me=E.def,d=E.Object,H=E.slice,J=E.Kernel;return me(w=E.get_singleton_class(E.top),"$to_s",le("main")),me(w,"$include",function(A){return d.$include(A)}),me(w,"$autoload",function(A){var U;return U=H(arguments),E.Object.$autoload.apply(E.Object,U)},-1),me(w,"$using",function(A){return J.$raise("main.using is permitted only at toplevel")})},Opal.modules["corelib/error/errno"]=function(E){var A,U,N,le=E.module,me=E.truthy,d=E.rb_plus,H=E.send2,J=E.find_super,_=E.def,x=E.klass,O=[],w=E.nil,K=E.$$$;return function(G,A){var Y,j,U=le("::","Errno"),T=([U].concat(A),w);for(Y=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["ESPIPE","Illegal seek",29],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2],["ENAMETOOLONG","File name too long",36]],T=w,j=0;j<Y.length;j++)!function(){var X,z=Y[j][1],q=Y[j][2];(T=E.klass(U,E.SystemCallError,Y[j][0])).errno=q,X=E.get_singleton_class(T),_(X,"$new",function I(Q){var k=w;return I.$$p=null,null==Q&&(Q=w),k=z,me(Q)&&(k=d(k," - "+Q)),H(this,J(this,"new",I,!1,!0),"new",[k],null)},-1)}()}(0,O),A=K("StandardError"),U=O,[N=x("::",A,"SystemCallError")].concat(U),_(N,"$errno",function(){return this.$class().$errno()}),E.get_singleton_class(N).$attr_reader("errno")},Opal.modules["corelib/error"]=function(E){var I,Q,le=E.klass,me=E.slice,d=E.gvars,H=E.defs,J=E.send,_=E.to_a,x=E.def,O=E.truthy,w=E.hash2,K=E.Kernel,G=E.not,A=E.rb_plus,U=E.eqeq,N=E.Object,Y=E.ensure_kwargs,T=E.send2,j=E.find_super,oe=E.module,z=[],q=E.nil,X=E.$$$;return function(M,I,Q){var P,L=le("::",I,"Exception"),S=[L].concat(Q),k=E.$r(S);function B(te){for(var fe,D=[],R=0;R<te.length;R++){var F=te[R];!F||!F.$$is_string||((fe=F.match(/^    at (.*?) \((.*?)\)$/))?D.push(fe[2]+":in `"+fe[1]+"'"):(fe=F.match(/^    at (.*?)$/))?D.push(fe[1]+":in `undefined'"):(fe=F.match(/^  from (.*?)$/))?D.push(fe[1]):(fe=F.match(/^(.*?)@(.*?)$/))&&D.push(fe[2]+":in `"+fe[1]+"'"))}return D}L.$$prototype.message=q,E.prop(L.$$prototype,"$$is_exception",!0),Error.stackTraceLimit=100,H(L,"$new",function(D){var R,F=this;null==d["!"]&&(d["!"]=q);var g=(R=me(arguments)).length>0?R[0]:q,l=new F.$$constructor(g);return l.name=F.$$name,l.message=g,l.cause=d["!"],E.send(l,l.$initialize,R),E.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(l,P),l},-1),P=L.$new,H(L,"$exception",function(D){var fe,F=this;return fe=me(arguments),J(F,"new",_(fe))},-1),x(L,"$initialize",function(D){var fe,R,F=this;return fe=me(arguments),F.message=(R=fe).length>0?R[0]:q},-1),x(L,"$backtrace",function(){var D=this;if(D.backtrace)return D.backtrace;var fe=D.stack;return typeof fe<"u"&&fe.$$is_string?D.backtrace=B(fe.split("\n")):fe?D.backtrace=B(fe):[]}),x(L,"$backtrace_locations",function(){var D;return this.backtrace_locations||(this.backtrace_locations=(D=this.$backtrace())===q||null==D?q:J(D,"map",[],function(F){return null==F&&(F=q),X(X(X("Thread"),"Backtrace"),"Location").$new(F)})),this.backtrace_locations}),x(L,"$cause",function(){return this.cause||q}),x(L,"$exception",function(D){var fe=this;if(null==D&&(D=q),D===q||fe===D)return fe;var R=fe.$clone();return R.message=D,fe.backtrace&&(R.backtrace=fe.backtrace.$dup()),R.stack=fe.stack,R.cause=fe.cause,R},-1),x(L,"$message",function(){return this.$to_s()}),x(L,"$full_message",function(D){var R,F=this,g=q,l=q,c=q,f=q,u=q,p=q,m=q,C=q,$=q;return null==d.stderr&&(d.stderr=q),null==D&&(D=q),O(k("Hash","skip_raise")?"constant":q)?(c=(R=[(D=w(["highlight","order"],{highlight:d.stderr["$tty?"](),order:"top"}).$merge(O(g=D)?g:w([],{})))["$[]"]("highlight"),D["$[]"]("order")])[1],O([!0,!1]["$include?"](l=R[0]))||K.$raise(X("ArgumentError"),"expected true or false as highlight: "+l),O(["top","bottom"]["$include?"](c))||K.$raise(X("ArgumentError"),"expected :top or :bottom as order: "+c),O(l)?(f="\x1b[1;4m",u="\x1b[1m",p="\x1b[m"):f=u=p="",m=F.$backtrace().$dup(),(G(m)||O(m["$empty?"]()))&&(m=F.$caller()),C=m.$shift(),$=A($=C+": ",""+u+F.$to_s()+" ("+f+F.$class()+p+u+")"+p+"\n"),$=A($,J(m,"map",[],function(se){return null==se&&(se=q),"\tfrom "+se+"\n"}).$join()),O(F.$cause())&&($=A($,F.$cause().$full_message(w(["highlight"],{highlight:l})))),U(c,"bottom")&&($=$.$split("\n").$reverse().$join("\n"),$=A(u+"Traceback"+p+" (most recent call last):\n",$)),$):F.message+"\n"+F.stack},-1),x(L,"$inspect",function(){var D=this,fe=q;return fe=D.$to_s(),O(fe["$empty?"]())?D.$class().$to_s():"#<"+D.$class().$to_s()+": "+D.$to_s()+">"}),x(L,"$set_backtrace",function(D){var F,g,fe=this,R=!0;if(D===q)fe.backtrace=q,fe.stack="";else if(D.$$is_string)fe.backtrace=[D],fe.stack="  from "+D;else{if(D.$$is_array){for(F=0,g=D.length;F<g;F++)if(!D[F].$$is_string){R=!1;break}}else R=!1;!1===R&&K.$raise(X("TypeError"),"backtrace must be Array of String"),fe.backtrace=D,fe.stack=J(D,"map",[],function(c){return null==c&&(c=q),A("  from ",c)}).join("\n")}return D}),x(L,"$to_s",function(){var fe,R,D=this;return O(fe=O(R=D.message)?D.message.$to_s():R)?fe:D.$class().$to_s()})}(0,Error,z),le("::",X("Exception"),"ScriptError"),le("::",X("ScriptError"),"SyntaxError"),le("::",X("ScriptError"),"LoadError"),le("::",X("ScriptError"),"NotImplementedError"),le("::",X("Exception"),"SystemExit"),le("::",X("Exception"),"NoMemoryError"),le("::",X("Exception"),"SignalException"),le("::",X("SignalException"),"Interrupt"),le("::",X("Exception"),"SecurityError"),le("::",X("Exception"),"SystemStackError"),le("::",X("Exception"),"StandardError"),le("::",X("StandardError"),"EncodingError"),le("::",X("StandardError"),"ZeroDivisionError"),le("::",X("StandardError"),"NameError"),le("::",X("NameError"),"NoMethodError"),le("::",X("StandardError"),"RuntimeError"),le("::",X("RuntimeError"),"FrozenError"),le("::",X("StandardError"),"LocalJumpError"),le("::",X("StandardError"),"TypeError"),le("::",X("StandardError"),"ArgumentError"),le("::",X("ArgumentError"),"UncaughtThrowError"),le("::",X("StandardError"),"IndexError"),le("::",X("IndexError"),"StopIteration"),le("::",X("StopIteration"),"ClosedQueueError"),le("::",X("IndexError"),"KeyError"),le("::",X("StandardError"),"RangeError"),le("::",X("RangeError"),"FloatDomainError"),le("::",X("StandardError"),"IOError"),le("::",X("IOError"),"EOFError"),le("::",X("StandardError"),"SystemCallError"),le("::",X("StandardError"),"RegexpError"),le("::",X("StandardError"),"ThreadError"),le("::",X("StandardError"),"FiberError"),N.$autoload("Errno","corelib/error/errno"),I=X("RuntimeError"),(Q=le("::",I,"FrozenError")).$attr_reader("receiver"),x(Q,"$initialize",function L(S,k){var v,B=this;return L.$$p=null,null==(v=(k=Y(k)).$$smap.receiver)&&(v=q),T(B,j(B,"initialize",L,!1,!0),"initialize",[S],null),B.receiver=v},-2),function(M,I){var Q=le("::",I,"UncaughtThrowError");Q.$$prototype.tag=q,Q.$attr_reader("tag","value"),x(Q,"$initialize",function S(k,v){var B=this;return S.$$p=null,null==v&&(v=q),B.tag=k,B.value=v,T(B,j(B,"initialize",S,!1,!0),"initialize",["uncaught throw "+B.tag.$inspect()],null)},-2)}(0,X("ArgumentError")),function(M,I){var Q=le("::",null,"NameError");Q.$attr_reader("name"),x(Q,"$initialize",function L(S,k){var P=this;return L.$$p=null,null==k&&(k=q),T(P,j(P,"initialize",L,!1,!0),"initialize",[S],null),P.name=k},-2)}(),function(M,I){var Q=le("::",null,"NoMethodError");Q.$attr_reader("args"),x(Q,"$initialize",function L(S,k,v){var B=this;return L.$$p=null,null==k&&(k=q),null==v&&(v=[]),T(B,j(B,"initialize",L,!1,!0),"initialize",[S,k],null),B.args=v},-2)}(),le("::",null,"StopIteration").$attr_reader("result"),function(M,I){var Q=le("::",null,"KeyError"),L=Q.$$prototype;L.receiver=L.key=q,x(Q,"$initialize",function S(k,v){var P,B,D=this;return S.$$p=null,null==(P=(v=Y(v)).$$smap.receiver)&&(P=q),null==(B=v.$$smap.key)&&(B=q),T(D,j(D,"initialize",S,!1,!0),"initialize",[k],null),D.receiver=P,D.key=B},-2),x(Q,"$receiver",function(){var v;return O(v=this.receiver)?v:K.$raise(X("ArgumentError"),"no receiver is available")}),x(Q,"$key",function(){var v;return O(v=this.key)?v:K.$raise(X("ArgumentError"),"no key is available")})}(),function(M,I){var L=[oe("::","JS")].concat(I);return le(L[0],null,"Error"),q}(0,z)},Opal.modules["corelib/constants"]=function(E){var le=E.const_set,d=E.$$$;return le("::","RUBY_PLATFORM","opal"),le("::","RUBY_ENGINE","opal"),le("::","RUBY_VERSION","3.2.0"),le("::","RUBY_ENGINE_VERSION","1.7.1"),le("::","RUBY_RELEASE_DATE","2023-01-06"),le("::","RUBY_PATCHLEVEL",0),le("::","RUBY_REVISION","0"),le("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2022 Adam Beynon and the Opal contributors"),le("::","RUBY_DESCRIPTION","opal "+d("RUBY_ENGINE_VERSION")+" ("+d("RUBY_RELEASE_DATE")+" revision "+d("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(E){var le=E.Object;return le.$require("corelib/runtime"),le.$require("corelib/helpers"),le.$require("corelib/module"),le.$require("corelib/class"),le.$require("corelib/basic_object"),le.$require("corelib/kernel"),le.$require("corelib/main"),le.$require("corelib/error"),le.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(E){var z,j,me=E.Kernel,d=E.def,H=E.return_val,J=E.ensure_kwargs,_=E.NilClass,x=E.slice,O=E.truthy,w=E.rb_gt,K=E.alias,A=E.nil,U=E.$$$;return[j=(0,E.klass)("::",null,"NilClass")].concat([]),j.$$prototype.$$meta=j,z=E.get_singleton_class(j),d(z,"$allocate",function(){return me.$raise(U("TypeError"),"allocator undefined for "+this.$name())}),E.udef(z,"$new"),d(j,"$!",H(!0)),d(j,"$&",H(!1)),d(j,"$|",function(q){return!1!==q&&q!==A}),d(j,"$^",function(q){return!1!==q&&q!==A}),d(j,"$==",function(q){return q===A}),d(j,"$dup",H(A)),d(j,"$clone",function(q){return q=J(q),A},-1),d(j,"$inspect",H("nil")),d(j,"$nil?",H(!0)),d(j,"$singleton_class",function(){return _}),d(j,"$to_a",function(){return[]}),d(j,"$to_h",function(){return E.hash()}),d(j,"$to_i",H(0)),d(j,"$to_s",H("")),d(j,"$to_c",function(){return U("Complex").$new(0,0)}),d(j,"$rationalize",function(q){var X;return X=x(arguments),O(w(X.$length(),1))&&me.$raise(U("ArgumentError")),me.$Rational(0,1)},-1),d(j,"$to_r",function(){return me.$Rational(0,1)}),d(j,"$instance_variables",function(){return[]}),K(j,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(E){"use strict";var le=E.klass,me=E.Kernel,d=E.def,H=E.return_self,J=E.ensure_kwargs,_=E.slice,x=E.truthy,O=E.send2,w=E.find_super,K=E.to_a,G=E.alias,U=E.nil,N=E.$$$;return function(Y,T,j){var M,oe=le("::",T,"Boolean");[oe].concat([]),E.prop(oe.$$prototype,"$$is_boolean",!0);for(var q=["$$class","$$meta"],X=0;X<q.length;X++)Object.defineProperty(oe.$$prototype,q[X],{configurable:!0,enumerable:!1,get:function(){return 1==this?E.TrueClass:0==this?E.FalseClass:E.Boolean}});Object.defineProperty(oe.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:U}}),M=E.get_singleton_class(oe),d(M,"$allocate",function(){return me.$raise(N("TypeError"),"allocator undefined for "+this.$name())}),E.udef(M,"$new"),d(oe,"$__id__",function(){return this.valueOf()?2:0}),d(oe,"$!",function(){return 1!=this}),d(oe,"$&",function(I){return 1==this&&!1!==I&&I!==U}),d(oe,"$|",function(I){return 1==this||!1!==I&&I!==U}),d(oe,"$^",function(I){return 1==this?!1===I||I===U:!1!==I&&I!==U}),d(oe,"$==",function(I){return 1==this===I.valueOf()}),d(oe,"$singleton_class",function(){return this.$$meta}),d(oe,"$to_s",function(){return 1==this?"true":"false"}),d(oe,"$dup",H),d(oe,"$clone",function(I){return I=J(I),this},-1),d(oe,"$method_missing",function M(I,Q){var k,L=M.$$p||U,v=this;M.$$p=null,k=_(arguments,1);var P=v.$$class.$$prototype[E.jsid(I)];return x(typeof P<"u"&&!P.$$stub)||O(v,w(v,"method_missing",M,!1,!0),"method_missing",[I].concat(K(k)),L),E.send(v,P,k,L)},-2),d(oe,"$respond_to_missing?",function(I,Q){null==Q&&(Q=!1);var S=this.$$class.$$prototype[E.jsid(I)];return typeof S<"u"&&!S.$$stub},-2),G(oe,"eql?","=="),G(oe,"equal?","=="),G(oe,"inspect","to_s"),G(oe,"object_id","__id__")}(0,Boolean),le("::",N("Boolean"),"TrueClass"),le("::",N("Boolean"),"FalseClass"),U},Opal.modules["corelib/comparable"]=function(E){var le=E.truthy,me=E.module,d=E.rb_gt,H=E.rb_lt,J=E.eqeqeq,_=E.Kernel,x=E.def,O=E.nil,w=E.$$$;return function(K){var G=me("::","Comparable"),A=O;function U(T){return E.is_a(T,E.Integer)?T:d(T,0)?1:H(T,0)?-1:0}function Y(T,j){var oe=T["$<=>"](j);return le(oe)||function N(T,j){var oe;oe=J(O,A=j)||J(!0,A)||J(!1,A)||J(w("Integer"),A)||J(w("Float"),A)?j.$inspect():j.$$class,_.$raise(w("ArgumentError"),"comparison of "+T.$class()+" with "+oe+" failed")}(T,j),U(oe)}return x(G,"$==",function(j){var oe=this,z=O;return!!le(oe["$equal?"](j))||oe["$<=>"]!=E.Kernel["$<=>"]&&(oe.$$comparable?(oe.$$comparable=!1,!1):!!le(z=oe["$<=>"](j))&&0==U(z))}),x(G,"$>",function(j){return Y(this,j)>0}),x(G,"$>=",function(j){return Y(this,j)>=0}),x(G,"$<",function(j){return Y(this,j)<0}),x(G,"$<=",function(j){return Y(this,j)<=0}),x(G,"$between?",function(j,oe){return!(H(this,j)||d(this,oe))}),x(G,"$clamp",function(j,oe){var q,X,z=this;if(null==oe&&(oe=O),oe===O&&(E.is_a(j,E.Range)||_.$raise(w("TypeError"),"wrong argument type "+j.$class()+" (expected Range)"),X=j.excl,oe=j.end,j=j.begin,oe!==O&&X&&_.$raise(w("ArgumentError"),"cannot clamp with an exclusive range")),j!==O&&oe!==O&&Y(j,oe)>0&&_.$raise(w("ArgumentError"),"min argument must be smaller than max argument"),j!==O){if(0==(q=Y(z,j)))return z;if(q<0)return j}return oe!==O&&(q=Y(z,oe))>0?oe:z},-2)}()},Opal.modules["corelib/regexp"]=function(E){var v,P,fe,F,g,B,te,D,le=E.coerce_to,me=E.prop,d=E.freeze,H=E.klass,J=E.const_set,_=E.send2,x=E.find_super,O=E.def,w=E.truthy,K=E.gvars,G=E.slice,A=E.Kernel,U=E.Opal,N=E.alias,Y=E.send,T=E.hash2,j=E.rb_plus,oe=E.ensure_kwargs,z=E.rb_ge,q=E.to_a,X=E.eqeqeq,M=E.rb_minus,I=E.return_ivar,Q=[],L=E.nil,S=E.$$$;return H("::",S("StandardError"),"RegexpError"),v=RegExp,P=Q,te=[B=H("::",v,"Regexp")].concat(P),D=E.$r(te),J(B,"IGNORECASE",1),J(B,"EXTENDED",2),J(B,"MULTILINE",4),E.prop(B.$$prototype,"$$is_regexp",!0),F=[fe=E.get_singleton_class(B)].concat(te),g=E.$r(F),O(fe,"$allocate",function l(){var c=l.$$p||L,u=L;return l.$$p=null,(u=_(this,x(this,"allocate",l,!1,!0),"allocate",[],c)).uninitialized=!0,u}),O(fe,"$escape",function(c){return E.escape_regexp(c)}),O(fe,"$last_match",function(c){return null==K["~"]&&(K["~"]=L),null==c&&(c=L),w(c["$nil?"]())?K["~"]:w(K["~"])?K["~"]["$[]"](c):L},-1),O(fe,"$union",function(c){var u,m,C,$,re,se,p=this;if(0==(u=G(arguments)).length)return/(?!)/;if(1==u.length&&u[0].$$is_regexp)return u[0];m=u[0].$$is_array,u.length>1&&m&&A.$raise(S("TypeError"),"no implicit conversion of Array into String"),m&&(u=u[0]),re=void 0,C=[];for(var Ee=0;Ee<u.length;Ee++)($=u[Ee]).$$is_string?C.push(p.$escape($)):$.$$is_regexp?(se=$.$options(),null!=re&&re!=se&&A.$raise(S("TypeError"),"All expressions must use the same options"),re=se,C.push("("+$.source+")")):C.push(p.$escape($.$to_str()));return p.$new(C.$join("|"),re)},-1),O(fe,"$new",function(c,f){if(c.$$is_regexp)return new RegExp(c);if("\\"===(c=U["$coerce_to!"](c,S("String"),"to_str")).charAt(c.length-1)&&"\\"!==c.charAt(c.length-2)&&A.$raise(S("RegexpError"),"too short escape sequence: /"+c+"/"),c=c.replace("\\A","^").replace("\\z","$"),void 0===f||f["$!"]())return new RegExp(c);if(f.$$is_number){var u="";g("IGNORECASE")&f&&(u+="i"),g("MULTILINE")&f&&(u+="m"),f=u}else f="i";return new RegExp(c,f)},-2),N(fe,"compile","new"),N(fe,"quote","escape"),O(B,"$==",function(R){return R instanceof RegExp&&this.toString()===R.toString()}),O(B,"$===",function(R){return this.$match(U["$coerce_to?"](R,S("String"),"to_str"))!==L}),O(B,"$=~",function(R){var g;return null==K["~"]&&(K["~"]=L),w(g=this.$match(R))?K["~"].$begin(0):g}),O(B,"$freeze",function(){var R=this;return w(R["$frozen?"]())?R:(R.hasOwnProperty("$$g")||me(R,"$$g",null),R.hasOwnProperty("$$gm")||me(R,"$$gm",null),d(R))}),O(B,"$inspect",function(){var g=this.toString(),l=/^\/(.*)\/([^\/]*)$/.exec(g);if(l){for(var f=l[2],u=l[1].split(""),p=u.length,m=!1,C="",$=0;$<p;$++){var re=u[$];!m&&"/"==re&&(C=C.concat("\\")),C=C.concat(re),m="\\"==re&&!m}return"/"+C+"/"+f}return g}),O(B,"$match",function fe(R,F){var g=fe.$$p||L,l=this;if(null==K["~"]&&(K["~"]=L),fe.$$p=null,l.uninitialized&&A.$raise(S("TypeError"),"uninitialized Regexp"),void 0===F){if(R===L)return K["~"]=L;var c=l.exec(le(R,S("String"),"to_str"));return c?(K["~"]=S("MatchData").$new(l,c),g===L?K["~"]:E.yield1(g,K["~"])):K["~"]=L}if(F=le(F,S("Integer"),"to_int"),R===L||(R=le(R,S("String"),"to_str"),F<0&&(F+=R.length)<0))return K["~"]=L;for(var f,u=E.global_regexp(l);;){if(null===(f=u.exec(R)))return K["~"]=L;if(f.index>=F)return K["~"]=S("MatchData").$new(u,f),g===L?K["~"]:E.yield1(g,K["~"]);u.lastIndex=f.index+1}},-2),O(B,"$match?",function(R,F){var l,g=this;return g.uninitialized&&A.$raise(S("TypeError"),"uninitialized Regexp"),void 0===F?R!==L&&g.test(le(R,S("String"),"to_str")):(F=le(F,S("Integer"),"to_int"),!(R===L||(R=le(R,S("String"),"to_str"),F<0&&(F+=R.length)<0)||null===(l=E.global_regexp(g).exec(R))||l.index<F))},-2),O(B,"$names",function(){return Y(this.$source().$scan(/\(?<(\w+)>/,T(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()}),O(B,"$named_captures",function(){return Y(Y(Y(this.$source().$scan(/\(?<(\w+)>/,T(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(g){return null==g&&(g=L),Y(g,"map",[],function(c){return null==c&&(c=L),j(c.$last(),1)})})}),O(B,"$~",function(){return null==K._&&(K._=L),this["$=~"](K._)}),O(B,"$source",function(){return this.source}),O(B,"$options",function(){var R=this;R.uninitialized&&A.$raise(S("TypeError"),"uninitialized Regexp");var F=0;return R.multiline&&(F|=D("MULTILINE")),R.ignoreCase&&(F|=D("IGNORECASE")),F}),O(B,"$casefold?",function(){return this.ignoreCase}),N(B,"eql?","=="),N(B,"to_s","source"),function(k,v,P){var B=H(k,null,"MatchData"),te=[B].concat(P),D=E.$r(te);return B.$$prototype.matches=L,B.$attr_reader("post_match","pre_match","regexp","string"),O(B,"$initialize",function(F,g,l){var c,f=this;null==(c=(l=oe(l)).$$smap.no_matchdata)&&(c=!1),w(c)||(K["~"]=f),f.regexp=F,f.begin=g.index,f.string=g.input,f.pre_match=g.input.slice(0,g.index),f.post_match=g.input.slice(g.index+g[0].length),f.matches=[];for(var u=0,p=g.length;u<p;u++){f.matches.push(g[u]??L)}},-3),O(B,"$match",function(F){var l;return w(l=this["$[]"](F))?l:w(F["$is_a?"](D("Integer")))&&w(z(F,this.$length()))?A.$raise(S("IndexError"),"index "+F+" out of matches"):L}),O(B,"$match_length",function(F){var g;return(g=this.$match(F))===L||null==g?L:g.$length()}),O(B,"$[]",function(F){var l,c=this;return(l=G(arguments))[0].$$is_string?(c.$regexp().$names()["$include?"](l["$[]"](0))["$!"]()&&A.$raise(S("IndexError"),"undefined group name reference: "+l["$[]"](0)),c.$named_captures()["$[]"](l["$[]"](0))):Y(c.matches,"[]",q(l))},-1),O(B,"$offset",function(F){var g=this;return 0!==F&&A.$raise(S("ArgumentError"),"MatchData#offset only supports 0th element"),[g.begin,g.begin+g.matches[F].length]}),O(B,"$==",function(F){var g=this,l=L,c=L,f=L,u=L;return!!X(S("MatchData"),F)&&(w(l=w(c=w(f=w(u=g.string==F.string)?g.regexp.toString()==F.regexp.toString():u)?g.pre_match==F.pre_match:f)?g.post_match==F.post_match:c)?g.begin==F.begin:l)}),O(B,"$begin",function(F){return 0!==F&&A.$raise(S("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin}),O(B,"$end",function(F){return 0!==F&&A.$raise(S("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[F].length}),O(B,"$captures",function(){return this.matches.slice(1)}),O(B,"$named_captures",function(){var g=L;return g=this.$captures(),Y(this.$regexp().$named_captures(),"transform_values",[],function(c){return null==c&&(c=L),g["$[]"](M(c.$last(),1))})}),O(B,"$names",function(){return this.$regexp().$names()}),O(B,"$inspect",function(){var F=this,g="#<MatchData "+F.matches[0].$inspect();if(F.$regexp().$names()["$empty?"]())for(var l=1,c=F.matches.length;l<c;l++)g+=" "+l+":"+F.matches[l].$inspect();else Y(F.$named_captures(),"each",[],function(u,p){return null==u&&(u=L),null==p&&(p=L),g+=" "+u+":"+p.$inspect()});return g+">"}),O(B,"$length",function(){return this.matches.length}),O(B,"$to_a",I("matches")),O(B,"$to_s",function(){return this.matches[0]}),O(B,"$values_at",function(F){var l,c=this;l=G(arguments);var f,u,p,m=[];for(f=0;f<l.length;f++)l[f].$$is_range&&((u=l[f].$to_a()).unshift(f,1),Array.prototype.splice.apply(l,u)),(p=U["$coerce_to!"](l[f],S("Integer"),"to_int"))<0&&(p+=c.matches.length)<0?m.push(L):m.push(c.matches[p]);return m},-1),N(B,"eql?","=="),N(B,"size","length")}(Q[0],0,Q)},Opal.modules["corelib/string"]=function(E){var le=E.coerce_to,me=E.respond_to,d=E.global_multiline_regexp,H=E.prop,J=E.klass,_=E.def,x=E.Opal,O=E.defs,w=E.slice,K=E.send,G=E.to_a,A=E.extract_kwargs,U=E.ensure_kwargs,N=E.eqeqeq,Y=E.Kernel,T=E.truthy,j=E.gvars,oe=E.rb_divide,z=E.rb_plus,q=E.eqeq,X=E.hash2,M=E.alias,I=E.const_set,Q=E.top,L=[],S=E.$r(L),k=E.nil,v=E.$$$;return Q.$require("corelib/comparable"),Q.$require("corelib/regexp"),function(P,B,te){var D=J("::",String,"String"),fe=[D].concat(te),R=E.$r(fe);function F(g){function l(Ee){var ce,ve,ye,he,Ie,be,Me="",ke=Ee.length;for(ce=0;ce<ke;ce++)if("-"===(ve=Ee.charAt(ce))&&ce>0&&ce<ke-1&&!ye){for((he=Ee.charCodeAt(ce-1))>(Ie=Ee.charCodeAt(ce+1))&&Y.$raise(v("ArgumentError"),'invalid range "'+he+"-"+Ie+'" in string transliteration'),be=he+1;be<Ie+1;be++)Me+=String.fromCharCode(be);ye=!0,ce++}else ye="\\"===ve,Me+=ve;return Me}function c(Ee,Me){if(0===Ee.length)return Me;var ke,ye,ce="",ve=Ee.length;for(ke=0;ke<ve;ke++)ye=Ee.charAt(ke),-1!==Me.indexOf(ye)&&(ce+=ye);return ce}var f,u,p,m,C,$,re="",se="";for(f=0,u=g.length;f<u;f++)m="^"===(p=le(g[f],v("String"),"to_str")).charAt(0)&&p.length>1,p=l(m?p.slice(1):p),m?se=c(se,p):re=c(re,p);if(re.length>0&&se.length>0){for($="",f=0,u=re.length;f<u;f++)C=re.charAt(f),-1===se.indexOf(C)&&($+=C);re=$,se=""}return re.length>0?"["+v("Regexp").$escape(re)+"]":se.length>0?"[^"+v("Regexp").$escape(se)+"]":null}D.$include(v("Comparable")),E.prop(D.$$prototype,"$$is_string",!0),_(D,"$__id__",function(){return this.toString()}),O(D,"$try_convert",function(l){return x["$coerce_to?"](l,v("String"),"to_str")}),O(D,"$new",function(l){var f,u=this,p=(f=w(arguments))[0]||"",m=f[f.length-1];return p=le(p,v("String"),"to_str"),m&&m.$$is_hash&&m.$$smap.encoding&&(p=p.$force_encoding(m.$$smap.encoding)),(p=new u.$$constructor(p)).$initialize.$$pristine||K(p,"initialize",G(f)),p},-1),_(D,"$initialize",function(l,c){var f,u;return f=w(arguments),u=A(f),u=U(u),f.length>0&&f.shift(),k},-1),_(D,"$%",function(l){var c=this;return N(v("Array"),l)?K(c,"format",[c].concat(G(l))):c.$format(c,l)}),_(D,"$*",function(l){if((l=le(l,v("Integer"),"to_int"))<0&&Y.$raise(v("ArgumentError"),"negative argument"),0===l)return"";var f="",u=this.toString();for(u.length*l>=1<<28&&Y.$raise(v("RangeError"),"multiply count must not overflow maximum string size");1==(1&l)&&(f+=u),0!=(l>>>=1);)u+=u;return f}),_(D,"$+",function(l){var c=this;if(""==(l=le(l,v("String"),"to_str"))&&c.$$class===E.String)return c;if(""==c&&l.$$class===E.String)return l;var f=c+l;return c.encoding===f.encoding&&l.encoding===f.encoding||"UTF-8"===c.encoding.name||"UTF-8"===l.encoding.name?f:E.enc(f,c.encoding)}),_(D,"$<=>",function(l){var c=this;if(T(l["$respond_to?"]("to_str")))return c>(l=l.$to_str().$to_s())?1:c<l?-1:0;var f=l["$<=>"](c);return f===k?k:f>0?-1:f<0?1:0}),_(D,"$==",function(l){return l.$$is_string?this.toString()===l.toString():!!me(l,"$to_str")&&l["$=="](this)}),_(D,"$=~",function(l){return l.$$is_string&&Y.$raise(v("TypeError"),"type mismatch: String given"),l["$=~"](this)}),_(D,"$[]",function(l,c){var p,m,f=this,u=f.length;if(l.$$is_range)return p=l.excl,m=l,c=l.end===k?-1:le(l.end,v("Integer"),"to_int"),l=l.begin===k?0:le(l.begin,v("Integer"),"to_int"),Math.abs(l)>u?k:(l<0&&(l+=u),c<0&&(c+=u),(!p||m.end===k)&&(c+=1),(c-=l)<0&&(c=0),f.substr(l,c));if(l.$$is_string)return null!=c&&Y.$raise(v("TypeError")),-1!==f.indexOf(l)?l:k;if(l.$$is_regexp){var C=f.match(l);return null===C?(j["~"]=k,k):(j["~"]=v("MatchData").$new(l,C),null==c?C[0]:(c=le(c,v("Integer"),"to_int"))<0&&-c<C.length?C[c+=C.length]:c>=0&&c<C.length?C[c]:k)}return(l=le(l,v("Integer"),"to_int"))<0&&(l+=u),null==c?l>=u||l<0?k:f.substr(l,1):(c=le(c,v("Integer"),"to_int"))<0||l>u||l<0?k:f.substr(l,c)},-2),_(D,"$b",function(){return new String(this).$force_encoding("binary")}),_(D,"$capitalize",function(){return this.charAt(0).toUpperCase()+this.substr(1).toLowerCase()}),_(D,"$casecmp",function(l){var c=this;if(!T(l["$respond_to?"]("to_str")))return k;l=le(l,v("String"),"to_str").$to_s();var f=/^[\x00-\x7F]*$/;return f.test(c)&&f.test(l)&&(c=c.toLowerCase(),l=l.toLowerCase()),c["$<=>"](l)}),_(D,"$casecmp?",function(l){var f=this.$casecmp(l);return f===k?k:0===f}),_(D,"$center",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Y.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=f.$ljust(oe(z(l,f.length),2).$ceil(),c);return f.$rjust(oe(z(l,f.length),2).$floor(),c)+u.slice(f.length)},-2),_(D,"$chomp",function(l){var f,c=this;return null==j["/"]&&(j["/"]=k),null==l&&(l=j["/"]),T(l===k||0===c.length)?c:("\n"===(l=x["$coerce_to!"](l,v("String"),"to_str").$to_s())?f=c.replace(/\r?\n?$/,""):""===l?f=c.replace(/(\r?\n)+$/,""):c.length>=l.length&&c.substr(c.length-l.length,l.length)===l&&(f=c.substr(0,c.length-l.length)),f??c)},-1),_(D,"$chop",function(){var l=this,c=l.length;return c<=1?"":"\n"===l.charAt(c-1)&&"\r"===l.charAt(c-2)?l.substr(0,c-2):l.substr(0,c-1)}),_(D,"$chr",function(){return this.charAt(0)}),_(D,"$clone",function(l){var c,f=this,u=k;return null==(c=(l=U(l)).$$smap.freeze)&&(c=k),T(c["$nil?"]())||q(c,!0)||q(c,!1)||f.$raise(R("ArgumentError"),"unexpected value for freeze: "+c.$class()),(u=new String(f)).$copy_singleton_methods(f),u.$initialize_clone(f,X(["freeze"],{freeze:c})),q(c,!0)?u.$$frozen||(u.$$frozen=!0):T(c["$nil?"]())&&f.$$frozen&&(u.$$frozen=!0),u},-1),_(D,"$dup",function(){var c=k;return(c=new String(this)).$initialize_dup(this),c}),_(D,"$count",function(l){var f,u=this;0===(f=w(arguments)).length&&Y.$raise(v("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=F(f);return null===p?0:u.length-u.replace(new RegExp(p,"g"),"").length},-1),_(D,"$delete",function(l){var f,u=this;0===(f=w(arguments)).length&&Y.$raise(v("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var p=F(f);return null===p?u:u.replace(new RegExp(p,"g"),"")},-1),_(D,"$delete_prefix",function(l){var c=this;return l.$$is_string||(l=le(l,v("String"),"to_str")),c.slice(0,l.length)===l?c.slice(l.length):c}),_(D,"$delete_suffix",function(l){var c=this;return l.$$is_string||(l=le(l,v("String"),"to_str")),c.slice(c.length-l.length)===l?c.slice(0,c.length-l.length):c}),_(D,"$downcase",function(){return this.toLowerCase()}),_(D,"$each_line",function g(l,c){var u,p,m,C,re,se,Ee,Me,ce,ke,ve,ye,f=g.$$p||k,$=this;if(null==j["/"]&&(j["/"]=k),g.$$p=null,u=w(arguments),p=A(u),p=U(p),u.length>0&&(m=u.shift()),null==m&&(m=j["/"]),null==(C=p.$$smap.chomp)&&(C=!1),f===k)return $.$enum_for("each_line",m,X(["chomp"],{chomp:C}));if(m===k)return E.yield1(f,$),$;if(0===(m=le(m,v("String"),"to_str")).length){for(se=0,Ee=(re=$.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;se<Ee;se+=2)(re[se]||re[se+1])&&(ye=(re[se]||"")+(re[se+1]||""),C&&(ye=ye.$chomp("\n")),E.yield1(f,ye));return $}for(ce=$.$chomp(m),ke=$.length!=ce.length,se=0,Me=(ve=ce.split(m)).length;se<Me;se++)ye=ve[se],(se<Me-1||ke)&&(ye+=m),C&&(ye=ye.$chomp(m)),E.yield1(f,ye);return $},-1),_(D,"$empty?",function(){return 0===this.length}),_(D,"$end_with?",function(l){for(var f,u=this,p=0,m=(f=w(arguments)).length;p<m;p++){var C=le(f[p],v("String"),"to_str").$to_s();if(u.length>=C.length&&u.substr(u.length-C.length,C.length)==C)return!0}return!1},-1),_(D,"$gsub",function g(l,c){var f=g.$$p||k,u=this;if(g.$$p=null,void 0===c&&f===k)return u.$enum_for("gsub",l);var $,re,se,p="",m=k,C=0;for(l.$$is_regexp?l=d(l):(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===($=l.exec(u))){j["~"]=k,p+=u.slice(C);break}m=v("MatchData").$new(l,$),void 0===c?(se=l.lastIndex,re=f($[0]),l.lastIndex=se):c.$$is_hash?re=c["$[]"]($[0]).$to_s():(c.$$is_string||(c=le(c,v("String"),"to_str")),re=c.replace(/([\\]+)([0-9+&`'])/g,function(Ee,Me,ce){if(Me.length%2==0)return Ee;switch(ce){case"+":for(var ke=$.length-1;ke>0;ke--)if(void 0!==$[ke])return Me.slice(1)+$[ke];return"";case"&":return Me.slice(1)+$[0];case"`":return Me.slice(1)+u.slice(0,$.index);case"'":return Me.slice(1)+u.slice($.index+$[0].length);default:return Me.slice(1)+($[ce]||"")}}).replace(/\\\\/g,"\\")),l.lastIndex===$.index?(p+=u.slice(C,$.index)+re+(u[$.index]||""),l.lastIndex+=1):p+=u.slice(C,$.index)+re,C=l.lastIndex}return j["~"]=m,p},-2),_(D,"$hash",function(){return this.toString()}),_(D,"$hex",function(){return this.$to_i(16)}),_(D,"$include?",function(l){return l.$$is_string||(l=le(l,v("String"),"to_str")),-1!==this.indexOf(l)}),_(D,"$index",function(l,c){var u,p,m,f=this;if(void 0===c)c=0;else if((c=le(c,v("Integer"),"to_int"))<0&&(c+=f.length)<0)return k;if(l.$$is_regexp)for(m=d(l);;){if(null===(p=m.exec(f))){j["~"]=k,u=-1;break}if(p.index>=c){j["~"]=v("MatchData").$new(m,p),u=p.index;break}m.lastIndex=p.index+1}else u=0===(l=le(l,v("String"),"to_str")).length&&c>f.length?-1:f.indexOf(l,c);return-1===u?k:u},-2),_(D,"$inspect",function(){var l=this,f={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+l.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(p){return f[p]?f[p]:(p=p.charCodeAt(0))<=255&&(l.encoding["$binary?"]()||l.internal_encoding["$binary?"]())?"\\x"+("00"+p.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+p.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'}),_(D,"$intern",function(){return this.toString()}),_(D,"$length",function(){return this.length}),M(D,"size","length"),_(D,"$lines",function g(l,c){var u,p,m,C,f=g.$$p||k,$=this,re=k;return null==j["/"]&&(j["/"]=k),g.$$p=null,u=w(arguments),p=A(u),p=U(p),u.length>0&&(m=u.shift()),null==m&&(m=j["/"]),null==(C=p.$$smap.chomp)&&(C=!1),re=K($,"each_line",[m,X(["chomp"],{chomp:C})],f.$to_proc()),T(f)?$:re.$to_a()},-1),_(D,"$ljust",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Y.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=-1,p="";for(l-=f.length;++u<l;)p+=c;return f+p.slice(0,l)},-2),_(D,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")}),_(D,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)}),_(D,"$match",function g(l,c){var f=g.$$p||k;return g.$$p=null,(N(R("String"),l)||T(l["$respond_to?"]("to_str")))&&(l=v("Regexp").$new(l.$to_str())),N(v("Regexp"),l)||Y.$raise(v("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),K(l,"match",[this,c],f.$to_proc())},-2),_(D,"$match?",function(l,c){return(N(R("String"),l)||T(l["$respond_to?"]("to_str")))&&(l=v("Regexp").$new(l.$to_str())),N(v("Regexp"),l)||Y.$raise(v("TypeError"),"wrong argument type "+l.$class()+" (expected Regexp)"),l["$match?"](this,c)},-2),_(D,"$next",function(){var l=this,c=l.length;if(0===c)return"";for(var m,f=l,u=l.search(/[a-zA-Z0-9]/),p=!1;c--;){if((m=l.charCodeAt(c))>=48&&m<=57||m>=65&&m<=90||m>=97&&m<=122)switch(m){case 57:p=!0,m=48;break;case 90:p=!0,m=65;break;case 122:p=!0,m=97;break;default:p=!1,m+=1}else-1===u?255===m?(p=!0,m=0):(p=!1,m+=1):p=!0;if(f=f.slice(0,c)+String.fromCharCode(m)+f.slice(c+1),p&&(0===c||c===u)){switch(m){case 65:case 97:break;default:m+=1}f=0===c?String.fromCharCode(m)+f:f.slice(0,c)+String.fromCharCode(m)+f.slice(c),p=!1}if(!p)break}return f}),_(D,"$oct",function(){var c,f=this,u=8;return/^\s*_/.test(f)?0:(f=f.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(p,m,C,$){switch($.charAt(0)){case"+":case"-":return p;case"0":if("x"===$.charAt(1)&&"0x"===C)return p}switch(C){case"0b":u=2;break;case"0":case"0o":u=8;break;case"0d":u=10;break;case"0x":u=16}return m+$}),c=parseInt(f.replace(/_(?!_)/g,""),u),isNaN(c)?0:c)}),_(D,"$ord",function(){var l=this;return"function"==typeof l.codePointAt?l.codePointAt(0):l.charCodeAt(0)}),_(D,"$partition",function(l){var f,u,c=this;return l.$$is_regexp?null===(u=l.exec(c))?f=-1:(v("MatchData").$new(l,u),l=u[0],f=u.index):(l=le(l,v("String"),"to_str"),f=c.indexOf(l)),-1===f?[c,"",""]:[c.slice(0,f),c.slice(f,f+l.length),c.slice(f+l.length)]}),_(D,"$reverse",function(){return this.split("").reverse().join("")}),_(D,"$rindex",function(l,c){var u,p,m,C,f=this;if(void 0===c)c=f.length;else if((c=le(c,v("Integer"),"to_int"))<0&&(c+=f.length)<0)return k;if(l.$$is_regexp){for(p=null,m=d(l);!(null===(C=m.exec(f))||C.index>c);)m.lastIndex=(p=C).index+1;null===p?(j["~"]=k,u=-1):(v("MatchData").$new(m,p),u=p.index)}else l=le(l,v("String"),"to_str"),u=f.lastIndexOf(l,c);return-1===u?k:u},-2),_(D,"$rjust",function(l,c){var f=this;if(null==c&&(c=" "),l=le(l,v("Integer"),"to_int"),c=le(c,v("String"),"to_str").$to_s(),T(c["$empty?"]())&&Y.$raise(v("ArgumentError"),"zero width padding"),T(l<=f.length))return f;var u=Math.floor(l-f.length),p=Math.floor(u/c.length),m=Array(p+1).join(c);return m+c.slice(0,u-m.length)+f},-2),_(D,"$rpartition",function(l){var f,u,p,m,c=this;if(l.$$is_regexp){for(u=null,p=d(l);null!==(m=p.exec(c));)p.lastIndex=(u=m).index+1;null===u?f=-1:(v("MatchData").$new(p,u),l=u[0],f=u.index)}else l=le(l,v("String"),"to_str"),f=c.lastIndexOf(l);return-1===f?["","",c]:[c.slice(0,f),c.slice(f,f+l.length),c.slice(f+l.length)]}),_(D,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")}),_(D,"$scan",function g(l,c){var u,f=g.$$p||k;g.$$p=null,null==(u=(c=U(c)).$$smap.no_matchdata)&&(u=!1);var $,m=[],C=k;for(l.$$is_regexp?l=d(l):(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=($=l.exec(this));)C=v("MatchData").$new(l,$,X(["no_matchdata"],{no_matchdata:u})),f===k?m.push(1==$.length?$[0]:C.$captures()):E.yield1(f,1==$.length?$[0]:C.$captures()),l.lastIndex===$.index&&(l.lastIndex+=1);return u||(j["~"]=C),f!==k?this:m},-2),_(D,"$singleton_class",function(){return E.get_singleton_class(this)}),_(D,"$split",function(l,c){var f=this,u=k;if(null==j[";"]&&(j[";"]=k),0===f.length)return[];if(void 0===c)c=0;else if(1===(c=x["$coerce_to!"](c,v("Integer"),"to_int")))return[f];(void 0===l||l===k)&&(l=T(u=j[";"])?u:" ");var $,re,se,p=[],m=f.toString(),C=0;if(l.$$is_regexp?l=d(l):" "===(l=le(l,v("String"),"to_str").$to_s())?(l=/\s+/gm,m=m.replace(/^\s+/,"")):l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(p=m.split(l)).length&&p[0]===m)return[p[0]];for(;-1!==(re=p.indexOf(void 0));)p.splice(re,1);if(0===c){for(;""===p[p.length-1];)p.length-=1;return p}if($=l.exec(m),c<0){if(null!==$&&""===$[0]&&-1===l.source.indexOf("(?="))for(re=0,se=$.length;re<se;re++)p.push("");return p}if(null!==$&&""===$[0])return p.splice(c-1,p.length-1,p.slice(c-1).join("")),p;if(c>=p.length)return p;for(re=0;null!==$&&(re++,C=l.lastIndex,re+1!==c);)$=l.exec(m);return p.splice(c-1,p.length-1,m.slice(C)),p},-1),_(D,"$squeeze",function(l){var f,u=this;if(0===(f=w(arguments)).length)return u.replace(/(.)\1+/g,"$1");var p=F(f);return null===p?u:u.replace(new RegExp("("+p+")\\1+","g"),"$1")},-1),_(D,"$start_with?",function(l){for(var f,u=this,p=0,m=(f=w(arguments)).length;p<m;p++)if(f[p].$$is_regexp){var C=f[p],$=C.exec(u);if(null!=$&&0===$.index)return j["~"]=v("MatchData").$new(C,$),!0;j["~"]=k}else{var re=le(f[p],v("String"),"to_str").$to_s();if(0===u.indexOf(re))return!0}return!1},-1),_(D,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")}),_(D,"$sub",function g(l,c){var f=g.$$p||k,u=this;g.$$p=null,l.$$is_regexp||(l=le(l,v("String"),"to_str"),l=new RegExp(l.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var p,m=l.exec(u);return null===m?(j["~"]=k,p=u.toString()):(v("MatchData").$new(l,m),void 0===c?(f===k&&Y.$raise(v("ArgumentError"),"wrong number of arguments (1 for 2)"),p=u.slice(0,m.index)+f(m[0])+u.slice(m.index+m[0].length)):c.$$is_hash?p=u.slice(0,m.index)+c["$[]"](m[0]).$to_s()+u.slice(m.index+m[0].length):(c=(c=le(c,v("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(C,$,re){if($.length%2==0)return C;switch(re){case"+":for(var se=m.length-1;se>0;se--)if(void 0!==m[se])return $.slice(1)+m[se];return"";case"&":return $.slice(1)+m[0];case"`":return $.slice(1)+u.slice(0,m.index);case"'":return $.slice(1)+u.slice(m.index+m[0].length);default:return $.slice(1)+(m[re]||"")}}).replace(/\\\\/g,"\\"),p=u.slice(0,m.index)+c+u.slice(m.index+m[0].length))),p},-2),_(D,"$sum",function(l){null==l&&(l=16),l=le(l,v("Integer"),"to_int");for(var f=0,u=this.length,p=0;p<u;p++)f+=this.charCodeAt(p);return l<=0?f:f&Math.pow(2,l)-1},-1),_(D,"$swapcase",function(){return this.replace(/([a-z]+)|([A-Z]+)/g,function(f,u,p){return u?f.toUpperCase():f.toLowerCase()})}),_(D,"$to_f",function(){if("_"===this.charAt(0))return 0;var c=parseFloat(this.replace(/_/g,""));return isNaN(c)||c==1/0||c==-1/0?0:c}),_(D,"$to_i",function(l){null==l&&(l=10);var f,u=this.toLowerCase(),p=le(l,v("Integer"),"to_int");return(1===p||p<0||p>36)&&Y.$raise(v("ArgumentError"),"invalid radix "+p),/^\s*_/.test(u)?0:(u=u.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(m,C,$,re){switch(re.charAt(0)){case"+":case"-":return m;case"0":if("x"===re.charAt(1)&&"0x"===$&&(0===p||16===p))return m}switch($){case"0b":if(0===p||2===p)return p=2,C+re;break;case"0":case"0o":if(0===p||8===p)return p=8,C+re;break;case"0d":if(0===p||10===p)return p=10,C+re;break;case"0x":if(0===p||16===p)return p=16,C+re}return m}),f=parseInt(u.replace(/_(?!_)/g,""),p),isNaN(f)?0:f)},-1),_(D,"$to_proc",function g(){var f,u,p=k;return g.$$p=null,f=this.valueOf(),u=E.jsid(f),p=K(Y,"proc",[],function m(C){var se,$=m.$$p||k;m.$$p=null,0===(se=w(arguments)).length&&Y.$raise(v("ArgumentError"),"no receiver given");var Ee=se[0];null==Ee&&(Ee=k);var Me=Ee[u];return Me?se=se.slice(1):(Me=Ee.$method_missing,se[0]=f),"function"==typeof $&&(Me.$$p=$),0===se.length?Me.call(Ee):Me.apply(Ee,se)},-1),p.$$source_location=k,p}),_(D,"$to_s",function(){return this.toString()}),_(D,"$tr",function(l,c){var f=this;if(l=le(l,v("String"),"to_str").$to_s(),c=le(c,v("String"),"to_str").$to_s(),0==l.length||l===c)return f;var u,p,m,C,$,re,se,Ee={},Me=l.split(""),ce=Me.length,ke=c.split(""),ve=ke.length,ye=!1,he=null;"^"===Me[0]&&Me.length>1&&(ye=!0,Me.shift(),he=ke[ve-1],ce-=1);var Ie=[],be=null;for(p=!1,u=0;u<ce;u++)if(C=Me[u],null==be)be=C,Ie.push(C);else if("-"===C)"-"===be?(Ie.push("-"),Ie.push("-")):u==ce-1?Ie.push("-"):p=!0;else if(p){for(($=be.charCodeAt(0))>(re=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)Ie.push(String.fromCharCode(m));Ie.push(C),p=null,be=null}else Ie.push(C);if(ce=(Me=Ie).length,ye)for(u=0;u<ce;u++)Ee[Me[u]]=!0;else{if(ve>0){var ae=[],ue=null;for(p=!1,u=0;u<ve;u++)if(C=ke[u],null==ue)ue=C,ae.push(C);else if("-"===C)"-"===ue?(ae.push("-"),ae.push("-")):u==ve-1?ae.push("-"):p=!0;else if(p){for(($=ue.charCodeAt(0))>(re=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)ae.push(String.fromCharCode(m));ae.push(C),p=null,ue=null}else ae.push(C);ve=(ke=ae).length}var xe=ce-ve;if(xe>0){var y=ve>0?ke[ve-1]:"";for(u=0;u<xe;u++)ke.push(y)}for(u=0;u<ce;u++)Ee[Me[u]]=ke[u]}var W="";for(u=0,se=f.length;u<se;u++){var pe=Ee[C=f.charAt(u)];W+=ye?null==pe?he:C:pe??C}return W}),_(D,"$tr_s",function(l,c){var f=this;if(l=le(l,v("String"),"to_str").$to_s(),c=le(c,v("String"),"to_str").$to_s(),0==l.length)return f;var u,p,m,C,$,re,se,Ee={},Me=l.split(""),ce=Me.length,ke=c.split(""),ve=ke.length,ye=!1,he=null;"^"===Me[0]&&Me.length>1&&(ye=!0,Me.shift(),he=ke[ve-1],ce-=1);var Ie=[],be=null;for(p=!1,u=0;u<ce;u++)if(C=Me[u],null==be)be=C,Ie.push(C);else if("-"===C)"-"===be?(Ie.push("-"),Ie.push("-")):u==ce-1?Ie.push("-"):p=!0;else if(p){for(($=be.charCodeAt(0))>(re=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)Ie.push(String.fromCharCode(m));Ie.push(C),p=null,be=null}else Ie.push(C);if(ce=(Me=Ie).length,ye)for(u=0;u<ce;u++)Ee[Me[u]]=!0;else{if(ve>0){var ae=[];for(p=!1,u=0;u<ve;u++)if(C=ke[u],null==be)be=C,ae.push(C);else if("-"===C)u==ve-1?ae.push("-"):p=!0;else if(p){for(($=be.charCodeAt(0))>(re=C.charCodeAt(0))&&Y.$raise(v("ArgumentError"),'invalid range "'+String.fromCharCode($)+"-"+String.fromCharCode(re)+'" in string transliteration'),m=$+1;m<re;m++)ae.push(String.fromCharCode(m));ae.push(C),p=null,be=null}else ae.push(C);ve=(ke=ae).length}var xe=ce-ve;if(xe>0){var y=ve>0?ke[ve-1]:"";for(u=0;u<xe;u++)ke.push(y)}for(u=0;u<ce;u++)Ee[Me[u]]=ke[u]}var W="",pe=null;for(u=0,se=f.length;u<se;u++){var we=Ee[C=f.charAt(u)];ye?null==we?null==pe&&(W+=he,pe=!0):(W+=C,pe=null):null!=we?(null==pe||pe!==we)&&(W+=we,pe=we):(W+=C,pe=null)}return W}),_(D,"$upcase",function(){return this.toUpperCase()}),_(D,"$upto",function g(l,c){var f=g.$$p||k,u=this;if(g.$$p=null,null==c&&(c=!1),f===k)return u.$enum_for("upto",l,c);var p,m,C=u.toString();if(l=le(l,v("String"),"to_str"),1===C.length&&1===l.length)for(p=C.charCodeAt(0),m=l.charCodeAt(0);p<=m&&(!c||p!==m);)f(String.fromCharCode(p)),p+=1;else if(parseInt(C,10).toString()===C&&parseInt(l,10).toString()===l)for(p=parseInt(C,10),m=parseInt(l,10);p<=m&&(!c||p!==m);)f(p.toString()),p+=1;else for(;C.length<=l.length&&C<=l&&(!c||C!==l);)f(C),C=C.$succ();return u},-2),_(D,"$instance_variables",function(){return[]}),O(D,"$_load",function(l){var c,u=this;return c=w(arguments),K(u,"new",G(c))},-1),_(D,"$unicode_normalize",function(l){return null==l&&(l="nfc"),T(["nfc","nfd","nfkc","nfkd"]["$include?"](l))||Y.$raise(v("ArgumentError"),"Invalid normalization form "+l),this.normalize(l.$upcase())},-1),_(D,"$unicode_normalized?",function(l){return null==l&&(l="nfc"),this.$unicode_normalize(l)["$=="](this)},-1),_(D,"$unpack",function(l){return Y.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")}),_(D,"$unpack1",function(l){return Y.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")}),_(D,"$freeze",function(){var l=this;return"string"==typeof l||H(l,"$$frozen",!0),l}),_(D,"$-@",function(){var l=this;return"string"==typeof l||l.$$frozen?l:"UTF-8"==l.encoding.name&&"UTF-8"==l.internal_encoding.name?l.toString():l.$dup().$freeze()}),_(D,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen}),M(D,"+@","dup"),M(D,"===","=="),M(D,"byteslice","[]"),M(D,"eql?","=="),M(D,"equal?","==="),M(D,"object_id","__id__"),M(D,"slice","[]"),M(D,"succ","next"),M(D,"to_str","to_s"),M(D,"to_sym","intern"),x.$pristine(D,"initialize")}(0,0,L),I(L[0],"Symbol",S("String"))},Opal.modules["corelib/enumerable"]=function(E){var le=E.truthy,me=E.coerce_to,d=E.yield1,H=E.yieldX,J=E.deny_frozen_access,_=E.module,x=E.send,O=E.slice,w=E.to_a,K=E.Opal,G=E.thrower,A=E.def,U=E.Kernel,N=E.return_val,Y=E.rb_gt,T=E.rb_times,j=E.rb_lt,oe=E.eqeq,z=E.rb_plus,q=E.rb_minus,X=E.rb_divide,M=E.rb_le,I=E.hash2,Q=E.lambda,L=E.not,S=E.alias,v=E.nil,P=E.$$$;return function(B,te){var D=_("::","Enumerable"),fe=[D].concat([]),R=E.$r(fe);function F(g){return 0===g.length&&(g=[v]),g.length>1&&(g=[g]),g}return A(D,"$all?",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?x(this,"each",[],function(m){var re=v;if(re=F(O(arguments)),le(x(l,"public_send",["==="].concat(w(re)))))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(m){var C;if(C=O(arguments),le(E.yieldX(f,w(C))))return v;c.$throw(!1)}:function(m){var C;if(C=O(arguments),le(K.$destructure(C)))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$any?",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?x(this,"each",[],function(m){var re=v;if(re=F(O(arguments)),!le(x(l,"public_send",["==="].concat(w(re)))))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(m){var C;if(C=O(arguments),!le(E.yieldX(f,w(C))))return v;c.$throw(!0)}:function(m){var C;if(C=O(arguments),!le(K.$destructure(C)))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$chunk",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?x(c,"to_enum",["chunk"],function f(){return(f.$$s??this).$enumerator_size()},{$$s:c}):x(P("Enumerator"),"new",[],function f(u){var p=f.$$s??this;null==u&&(u=v);var m=v,C=[];function $(){C.length>0&&u.$yield(m,C)}p.$each.$$p=function(re){var se=d(l,re);se===v?($(),C=[],m=v):(m===v||m===se?C.push(re):($(),C=[re]),m=se)},p.$each(),$()},{$$s:c})}),A(D,"$chunk_while",function g(){var l=g.$$p||v;return g.$$p=null,l===v&&U.$raise(P("ArgumentError"),"no block given"),x(this,"slice_when",[],function(u,p){return null==u&&(u=v),null==p&&(p=v),E.yieldX(l,[u,p])["$!"]()})}),A(D,"$collect",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["collect"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=H(l,arguments);f.push(u)},c.$each(),f}),A(D,"$collect_concat",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?x(c,"enum_for",["collect_concat"],function f(){return(f.$$s??this).$enumerator_size()},{$$s:c}):x(c,"map",[],l.$to_proc()).$flatten(1)}),A(D,"$compact",function(){return this.$to_a().$compact()}),A(D,"$count",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=0,null!=l&&c!==v&&this.$warn("warning: given block not used"),le(null!=l)?c=x(U,"proc",[],function(m){var C;return C=O(arguments),K.$destructure(C)["$=="](l)},-1):le(c["$nil?"]())&&(c=x(U,"proc",[],N(!0))),x(this,"each",[],function(m){var C;return C=O(arguments),le(H(c,C))?u++:v},-1),u},-1),A(D,"$cycle",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,null==l&&(l=v),c===v)return x(f,"enum_for",["cycle",l],function $(){var re=$.$$s??this;return le(l["$nil?"]())?le(re["$respond_to?"]("size"))?P(P("Float"),"INFINITY"):v:(l=K["$coerce_to!"](l,P("Integer"),"to_int"),le(Y(l,0))?T(re.$enumerator_size(),l):0)},{$$s:f});if(!le(l["$nil?"]())&&(l=K["$coerce_to!"](l,P("Integer"),"to_int"),le(l<=0)))return v;var p,m,u=[];if(f.$each.$$p=function(){var $=K.$destructure(arguments);d(c,$),u.push($)},f.$each(),0===u.length)return v;if(l===v)for(;;)for(p=0,m=u.length;p<m;p++)d(c,u[p]);else for(;l>1;){for(p=0,m=u.length;p<m;p++)d(c,u[p]);l--}},-1),A(D,"$detect",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,f===v?this.$enum_for("detect",l):(x(this,"each",[],function(m){var C,re=v;if(C=O(arguments),re=K.$destructure(C),!le(E.yield1(f,re)))return v;c.$throw(re)},{$$arity:-1,$$ret:c}),void 0!==l?"function"==typeof l?l():l:v)}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$drop",function(l){l=me(l,P("Integer"),"to_int"),le(l<0)&&U.$raise(P("ArgumentError"),"attempt to drop negative size");var f=[],u=0;return this.$each.$$p=function(){l<=u&&f.push(K.$destructure(arguments)),u++},this.$each(),f}),A(D,"$drop_while",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return c.$enum_for("drop_while");var f=[],u=!0;return c.$each.$$p=function(){var p=K.$destructure(arguments);if(u){var m=d(l,p);le(m)||(u=!1,f.push(p))}else f.push(p)},c.$each(),f}),A(D,"$each_cons",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,le(1!=arguments.length)&&U.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),l=K.$try_convert(l,P("Integer"),"to_int"),le(l<=0)&&U.$raise(P("ArgumentError"),"invalid size"),c===v)return x(f,"enum_for",["each_cons",l],function p(){var C=v;return C=(p.$$s??this).$enumerator_size(),le(C["$nil?"]())?v:oe(C,0)||le(j(C,l))?0:z(q(C,l),1)},{$$s:f});var u=[];return f.$each.$$p=function(){var p=K.$destructure(arguments);u.push(p),u.length>l&&u.shift(),u.length==l&&d(c,u.slice(0,l))},f.$each(),f}),A(D,"$each_entry",function g(l){var u,c=g.$$p||v,p=this;return g.$$p=null,u=O(arguments),c===v?x(p,"to_enum",["each_entry"].concat(w(u)),function m(){return(m.$$s??this).$enumerator_size()},{$$s:p}):(p.$each.$$p=function(){var m=K.$destructure(arguments);d(c,m)},p.$each.apply(p,u),p)},-1),A(D,"$each_slice",function g(l){var c=g.$$p||v,f=this;if(g.$$p=null,l=me(l,P("Integer"),"to_int"),le(l<=0)&&U.$raise(P("ArgumentError"),"invalid slice size"),c===v)return x(f,"enum_for",["each_slice",l],function p(){var m=p.$$s??this;return le(m["$respond_to?"]("size"))?X(m.$size(),l).$ceil():v},{$$s:f});var u=[];return f.$each.$$p=function(){var p=K.$destructure(arguments);u.push(p),u.length===l&&(d(c,u),u=[])},f.$each(),u.length>0&&d(c,u),f}),A(D,"$each_with_index",function g(l){var u,c=g.$$p||v,p=this;if(g.$$p=null,u=O(arguments),c===v)return x(p,"enum_for",["each_with_index"].concat(w(u)),function C(){return(C.$$s??this).$enumerator_size()},{$$s:p});var m=0;return p.$each.$$p=function(){var C=K.$destructure(arguments);c(C,m),m++},p.$each.apply(p,u),p},-1),A(D,"$each_with_object",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,c===v?x(f,"enum_for",["each_with_object",l],function u(){return(u.$$s??this).$enumerator_size()},{$$s:f}):(f.$each.$$p=function(){var u=K.$destructure(arguments);c(u,l)},f.$each(),l)}),A(D,"$entries",function(l){var f,u=this;f=O(arguments);var p=[];return u.$each.$$p=function(){p.push(K.$destructure(arguments))},u.$each.apply(u,f),p},-1),A(D,"$filter_map",function g(){var l=g.$$p||v,c=this;return g.$$p=null,l===v?x(c,"enum_for",["filter_map"],function f(){return(f.$$s??this).$enumerator_size()},{$$s:c}):x(x(c,"map",[],l.$to_proc()),"select",[],"itself".$to_proc())}),A(D,"$find_all",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["find_all"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=K.$destructure(arguments),p=d(l,u);le(p)&&f.push(u)},c.$each(),f}),A(D,"$find_index",function g(l){try{var c=G("return"),f=g.$$p||v,u=this,p=v;return g.$$p=null,le(void 0===l&&f===v)?u.$enum_for("find_index"):(null!=l&&f!==v&&u.$warn("warning: given block not used"),p=0,le(null!=l)?x(u,"each",[],function(C){var $;return $=O(arguments),oe(K.$destructure($),l)&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}):x(u,"each",[],function(C){var $;return $=O(arguments),le(E.yieldX(f,w($)))&&c.$throw(p),p+=1},{$$arity:-1,$$ret:c}),v)}catch(m){if(m===c)return m.$v;throw m}},-1),A(D,"$first",function(l){try{var c=G("return"),u=v,p=v;return le(void 0===l)?x(this,"each",[],function(C){null==C&&(C=v),c.$throw(C)},{$$ret:c}):(u=[],l=me(l,P("Integer"),"to_int"),le(l<0)&&U.$raise(P("ArgumentError"),"attempt to take negative size"),le(0==l)?[]:(p=0,x(this,"each",[],function(C){var $;if($=O(arguments),u.push(K.$destructure($)),!le(l<=++p))return v;c.$throw(u)},{$$arity:-1,$$ret:c}),u))}catch(m){if(m===c)return m.$v;throw m}},-1),A(D,"$grep",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=[],x(this,"each",[],function(m){var $,re=v;return re=F($=O(arguments)),le(x(l,"__send__",["==="].concat(w(re))))?(c!==v?(le(Y($.$length(),1))&&($=[$]),$=E.yieldX(c,w($))):le(M($.$length(),1))&&($=$["$[]"](0)),u.$push($)):v},-1),u}),A(D,"$grep_v",function g(l){var c=g.$$p||v,u=v;return g.$$p=null,u=[],x(this,"each",[],function(m){var $,re=v;return re=F($=O(arguments)),le(x(l,"__send__",["==="].concat(w(re))))?v:(c!==v?(le(Y($.$length(),1))&&($=[$]),$=E.yieldX(c,w($))):le(M($.$length(),1))&&($=$["$[]"](0)),u.$push($))},-1),u}),A(D,"$group_by",function g(){var c,l=g.$$p||v,f=this,u=v,p=v;return g.$$p=null,l===v?x(f,"enum_for",["group_by"],function C(){return(C.$$s??this).$enumerator_size()},{$$s:f}):(u=I([],{}),f.$each.$$p=function(){var C=K.$destructure(arguments),$=d(l,C);(le(p=u["$[]"]($))?p:(c=[$,[]],x(u,"[]=",c),c[c.length-1]))["$<<"](C)},f.$each(),u)}),A(D,"$include?",function(l){try{var c=G("return");return x(this,"each",[],function(p){var m;if(m=O(arguments),!oe(K.$destructure(m),l))return v;c.$throw(!0)},{$$arity:-1,$$ret:c}),!1}catch(u){if(u===c)return u.$v;throw u}}),A(D,"$inject",function g(l,c){var f=g.$$p||v,u=this;g.$$p=null;var p=l;return f!==v&&void 0===c?u.$each.$$p=function(){var m=K.$destructure(arguments);void 0!==p?(m=H(f,[p,m]),p=m):p=m}:(void 0===c&&(P("Symbol")["$==="](l)||U.$raise(P("TypeError"),l.$inspect()+" is not a Symbol"),c=l,p=void 0),u.$each.$$p=function(){var m=K.$destructure(arguments);p=void 0!==p?p.$__send__(c,m):m}),u.$each(),p??v},-1),A(D,"$lazy",function(){return x(P(P("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(f,u){var p;return null==f&&(f=v),p=O(arguments,1),x(f,"yield",w(p))},-2)}),A(D,"$enumerator_size",function(){return le(this["$respond_to?"]("size"))?this.$size():v}),A(D,"$max",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,void 0===l||l===v?(f.$each.$$p=function(){var m=K.$destructure(arguments);void 0!==u?((p=c!==v?H(c,[m,u]):m["$<=>"](u))===v&&U.$raise(P("ArgumentError"),"comparison failed"),p>0&&(u=m)):u=m},f.$each(),void 0===u?v:u):(l=me(l,P("Integer"),"to_int"),x(f,"sort",[],c.$to_proc()).$reverse().$first(l))},-1),A(D,"$max_by",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(c)?le(l["$nil?"]())?(f.$each.$$p=function(){var m=K.$destructure(arguments),C=d(c,m);if(void 0===u)return u=m,void(p=C);C["$<=>"](p)>0&&(u=m,p=C)},f.$each(),void 0===u?v:u):x(f,"sort_by",[],c.$to_proc()).$reverse().$take(l):x(f,"enum_for",["max_by",l],function m(){return(m.$$s??this).$enumerator_size()},{$$s:f})},-1),A(D,"$min",function g(l){var u,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(l["$nil?"]())?(f.$each.$$p=c!==v?function(){var p=K.$destructure(arguments);if(void 0!==u){var m=c(p,u);m===v&&U.$raise(P("ArgumentError"),"comparison failed"),m<0&&(u=p)}else u=p}:function(){var p=K.$destructure(arguments);void 0!==u?K.$compare(p,u)<0&&(u=p):u=p},f.$each(),void 0===u?v:u):c!==v?x(f,"sort",[],function(m,C){return null==m&&(m=v),null==C&&(C=v),E.yieldX(c,[m,C])}).$take(l):f.$sort().$take(l)},-1),A(D,"$min_by",function g(l){var u,p,c=g.$$p||v,f=this;return g.$$p=null,null==l&&(l=v),le(c)?le(l["$nil?"]())?(f.$each.$$p=function(){var m=K.$destructure(arguments),C=d(c,m);if(void 0===u)return u=m,void(p=C);C["$<=>"](p)<0&&(u=m,p=C)},f.$each(),void 0===u?v:u):x(f,"sort_by",[],c.$to_proc()).$take(l):x(f,"enum_for",["min_by",l],function m(){return(m.$$s??this).$enumerator_size()},{$$s:f})},-1),A(D,"$minmax",function g(){var f,l=g.$$p||v;g.$$p=null,l=le(f=l)?f:x(U,"proc",[],function($,re){return null==$&&($=v),null==re&&(re=v),$["$<=>"](re)});var u=v,p=v,m=!0;return this.$each.$$p=function(){var C=K.$destructure(arguments);if(m)u=p=C,m=!1;else{var $=l.$call(u,C);$===v?U.$raise(P("ArgumentError"),"comparison failed"):$>0&&(u=C);var re=l.$call(p,C);re===v?U.$raise(P("ArgumentError"),"comparison failed"):re<0&&(p=C)}},this.$each(),[u,p]}),A(D,"$minmax_by",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,!le(l))return x(c,"enum_for",["minmax_by"],function C(){return(C.$$s??this).$enumerator_size()},{$$s:c});var p,m,f=v,u=v;return c.$each.$$p=function(){var C=K.$destructure(arguments),$=d(l,C);(void 0===p||$["$<=>"](p)<0)&&(f=C,p=$),(void 0===m||$["$<=>"](m)>0)&&(u=C,m=$)},c.$each(),[f,u]}),A(D,"$none?",function g(l){try{var c=G("return"),f=g.$$p||v;return g.$$p=null,le(void 0!==l)?x(this,"each",[],function(m){var re=v;if(re=F(O(arguments)),!le(x(l,"public_send",["==="].concat(w(re)))))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(m){var C;if(C=O(arguments),!le(E.yieldX(f,w(C))))return v;c.$throw(!1)}:function(m){var C,re=v;if(C=O(arguments),re=K.$destructure(C),!le(re))return v;c.$throw(!1)},{$$arity:-1,$$ret:c}),!0}catch(p){if(p===c)return p.$v;throw p}},-1),A(D,"$one?",function g(l){try{var c=G("return"),f=g.$$p||v,p=v;return g.$$p=null,p=0,le(void 0!==l)?x(this,"each",[],function(C){var se=v;return se=F(O(arguments)),le(x(l,"public_send",["==="].concat(w(se))))?(p=z(p,1),le(Y(p,1))?void c.$throw(!1):v):v},{$$arity:-1,$$ret:c}):x(this,"each",[],f!==v?function(C){var $;return $=O(arguments),le(E.yieldX(f,w($)))?(p=z(p,1),le(Y(p,1))?void c.$throw(!1):v):v}:function(C){var $;return $=O(arguments),le(K.$destructure($))?(p=z(p,1),le(Y(p,1))?void c.$throw(!1):v):v},{$$arity:-1,$$ret:c}),p["$=="](1)}catch(m){if(m===c)return m.$v;throw m}},-1),A(D,"$partition",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["partition"],function m(){return(m.$$s??this).$enumerator_size()},{$$s:c});var f=[],u=[];return c.$each.$$p=function(){var m=K.$destructure(arguments),C=d(l,m);le(C)?f.push(m):u.push(m)},c.$each(),[f,u]}),A(D,"$reject",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["reject"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c});var f=[];return c.$each.$$p=function(){var u=K.$destructure(arguments),p=d(l,u);le(p)||f.push(u)},c.$each(),f}),A(D,"$reverse_each",function g(){var l=g.$$p||v,c=this;if(g.$$p=null,l===v)return x(c,"enum_for",["reverse_each"],function p(){return(p.$$s??this).$enumerator_size()},{$$s:c});var f=[];c.$each.$$p=function(){f.push(arguments)},c.$each();for(var u=f.length-1;u>=0;u--)H(l,f[u]);return f}),A(D,"$slice_before",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,le(void 0===l&&c===v)&&U.$raise(P("ArgumentError"),"both pattern and block are given"),le(void 0!==l&&c!==v||arguments.length>1)&&U.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),x(P("Enumerator"),"new",[],function u(p){var m=u.$$s??this;null==p&&(p=v);var C=[];m.$each.$$p=c!==v?void 0===l?function(){var $=K.$destructure(arguments),re=d(c,$);le(re)&&C.length>0&&(p["$<<"](C),C=[]),C.push($)}:function(){var $=K.$destructure(arguments),re=c($,l.$dup());le(re)&&C.length>0&&(p["$<<"](C),C=[]),C.push($)}:function(){var $=K.$destructure(arguments),re=l["$==="]($);le(re)&&C.length>0&&(p["$<<"](C),C=[]),C.push($)},m.$each(),C.length>0&&p["$<<"](C)},{$$s:f})},-1),A(D,"$slice_after",function g(l){var c=g.$$p||v,f=this;return g.$$p=null,le(void 0===l&&c===v)&&U.$raise(P("ArgumentError"),"both pattern and block are given"),le(void 0!==l&&c!==v||arguments.length>1)&&U.$raise(P("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),le(void 0!==l)&&(c=x(U,"proc",[],function(p){return null==p&&(p=v),l["$==="](p)})),x(P("Enumerator"),"new",[],function u(p){var C,m=u.$$s??this;null==p&&(p=v),m.$each.$$p=function(){var $=K.$destructure(arguments),re=d(c,$);null==C&&(C=[]),le(re)?(C.push($),p.$yield(C),C=null):C.push($)},m.$each(),null!=C&&p.$yield(C)},{$$s:f})},-1),A(D,"$slice_when",function g(){var l=g.$$p||v;return g.$$p=null,l===v&&U.$raise(P("ArgumentError"),"wrong number of arguments (0 for 1)"),x(P("Enumerator"),"new",[],function f(u){var p=f.$$s??this;null==u&&(u=v);var m=v,C=v;p.$each_cons.$$p=function(){var $=K.$destructure(arguments),re=$[0],se=$[1],Ee=H(l,[re,se]);C=se,m===v&&(m=[]),le(Ee)?(m.push(re),u.$yield(m),m=[]):m.push(re)},p.$each_cons(2),m!==v&&(m.push(C),u.$yield(m))},{$$s:this})}),A(D,"$sort",function g(){var f,l=g.$$p||v;return g.$$p=null,f=this.$to_a(),l===v&&(l=Q(function(p,m){return null==p&&(p=v),null==m&&(m=v),p["$<=>"](m)})),x(f,"sort",[],l.$to_proc())}),A(D,"$sort_by",function g(){var l=g.$$p||v,c=this,f=v;return g.$$p=null,l===v?x(c,"enum_for",["sort_by"],function u(){return(u.$$s??this).$enumerator_size()},{$$s:c}):(f=x(c,"map",[],function(){var p=v;return p=K.$destructure(arguments),[E.yield1(l,p),p]}),x(f,"sort!",[],function(p,m){return null==p&&(p=v),null==m&&(m=v),p[0]["$<=>"](m[0])}),x(f,"map!",[],function(p){return null==p&&(p=v),p[1]}))}),A(D,"$sum",function g(l){var c=g.$$p||v,u=v,p=v;return g.$$p=null,null==l&&(l=0),u=l,p=0,x(this,"each",[],function(C){var re,se=v,Ee=v,Me=v;return re=O(arguments),se=c!==v?E.yieldX(c,w(re)):K.$destructure(re),L([P(P("Float"),"INFINITY"),P(P("Float"),"INFINITY")["$-@"]()]["$include?"](se))&&le(se["$respond_to?"]("-"))?(Ee=q(se,p),Me=z(u,Ee),p=q(q(Me,u),Ee),u=Me):u=z(u,se)},-1),u},-1),A(D,"$take",function(l){return this.$first(l)}),A(D,"$take_while",function g(){try{var l=G("return"),c=g.$$p||v,u=v;return g.$$p=null,le(c)?(u=[],x(this,"each",[],function(m){var C,re=v;return C=O(arguments),re=K.$destructure(C),le(E.yield1(c,re))||l.$throw(u),u.push(re)},{$$arity:-1,$$ret:l})):this.$enum_for("take_while")}catch(p){if(p===l)return p.$v;throw p}}),A(D,"$uniq",function g(){var l=g.$$p||v,f=v;return g.$$p=null,f=I([],{}),x(this,"each",[],function(p){var m,$,re=v,se=v;return m=O(arguments),re=K.$destructure(m),se=l!==v?E.yield1(l,re):re,le(f["$key?"](se))?v:(x(f,"[]=",$=[se,re]),$[$.length-1])},-1),f.$values()}),A(D,"$tally",function(l){var f;return l&&l!==v&&J(l),f=x(x(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),le(l)?(x(f,"each",[],function(p,m){var C;return null==p&&(p=v),null==m&&(m=v),C=[p,z(l.$fetch(p,0),m)],x(l,"[]=",C),C[C.length-1]}),l):f},-1),A(D,"$to_h",function g(l){var u,c=g.$$p||v,p=this;if(g.$$p=null,u=O(arguments),c!==v)return x(x(p,"map",[],c.$to_proc()),"to_h",w(u));var m=I([],{});return p.$each.$$p=function(){var C=K.$destructure(arguments),$=K["$coerce_to?"](C,P("Array"),"to_ary");$.$$is_array||U.$raise(P("TypeError"),"wrong element type "+$.$class()+" (expected array)"),2!==$.length&&U.$raise(P("ArgumentError"),"wrong array length (expected 2, was "+$.$length()+")"),E.hash_put(m,$[0],$[1])},p.$each.apply(p,u),m},-1),A(D,"$to_set",function g(l,c){var u,p,f=g.$$p||v,C=this;return g.$$p=null,(u=O(arguments)).length>0&&(p=u.shift()),null==p&&(p=R("Set")),x(p,"new",[C].concat(w(u)),f.$to_proc())},-1),A(D,"$zip",function g(l){var u,p=this;return g.$$p=null,u=O(arguments),x(p.$to_a(),"zip",w(u))},-1),S(D,"find","detect"),S(D,"filter","find_all"),S(D,"flat_map","collect_concat"),S(D,"map","collect"),S(D,"member?","include?"),S(D,"reduce","inject"),S(D,"select","find_all"),S(D,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(E){var I,Q,L,le=E.klass,me=E.truthy,d=E.to_a,H=E.eqeq,J=E.Kernel,_=E.def,x=E.rb_gt,O=E.rb_lt,w=E.rb_le,K=E.rb_ge,G=E.rb_plus,A=E.rb_minus,U=E.eqeqeq,N=E.not,Y=E.rb_times,T=E.rb_divide,j=E.alias,z=E.nil,q=E.$$$;return I=[],L=[Q=le("::",null,"Enumerator")].concat(I),function(S,k,v){var P=le(S,k,"ArithmeticSequence"),B=[P].concat(v),te=E.$r(B),D=P.$$prototype;D.step_arg2=D.receiver_num=D.step_arg1=D.step=D.range=D.topfx=D.bypfx=D.creation_method=D.skipped_arg=z,E.prop(P.$$prototype,"$$is_arithmetic_seq",!0);var fe=1/0;return _(P,"$initialize",function(F,g,l){var c,f=this,u=z;return null==l&&(l="step"),f.creation_method=l,me(F["$is_a?"](q("Array")))?(c=[].concat(d(F)),f.step_arg1=c[0]??z,f.step_arg2=c[1]??z,f.topfx=c[2]??z,f.bypfx=c[3]??z,f.receiver_num=g,f.step=1,f.range=me(f.step_arg2)?(f.step=f.step_arg2,E.Range.$new(f.receiver_num,f.step_arg1,!1)):me(f.step_arg1)?E.Range.$new(f.receiver_num,f.step_arg1,!1):E.Range.$new(f.receiver_num,z,!1)):(me(g)||(f.skipped_arg=!0),c=[F,me(u=g)?u:1],f.range=c[0],f.step=c[1]),f.object=f,H(f.step,0)&&J.$raise(te("ArgumentError"),"step can't be 0"),me(f.step["$respond_to?"]("to_int"))?z:J.$raise(te("ArgumentError"),"no implicit conversion of "+f.step.$class()+" into Integer")},-2),P.$attr_reader("step"),_(P,"$begin",function(){return this.range.$begin()}),_(P,"$end",function(){return this.range.$end()}),_(P,"$exclude_end?",function(){return this.range["$exclude_end?"]()}),_(P,"$_lesser_than_end?",function(F){var l,c,g=this;return l=me(c=g.$end())?c:fe,me(x(g.$step(),0))?me(g["$exclude_end?"]())?O(F,l):w(F,l):me(g["$exclude_end?"]())?x(F,l):K(F,l)}),_(P,"$_greater_than_begin?",function(F){var l,c;return l=me(c=this.$begin())?c:fe["$-@"](),me(x(this.$step(),0))?x(F,l):O(F,l)}),_(P,"$first",function(F){var g=this,l=z,c=z,f=z;if(l=me(c=g.$begin())?c:fe["$-@"](),!me(F))return me(g["$_lesser_than_end?"](l))?l:z;for(f=[];me(me(c=g["$_lesser_than_end?"](l))?x(F,0):c);)f["$<<"](l),l=G(l,g.$step()),F=A(F,1);return f},-1),_(P,"$each",function R(){var l,F=R.$$p||z,g=this,c=z;if(R.$$p=null,F===z)return g;for(U(z,g.$begin())&&J.$raise(te("TypeError"),"nil can't be coerced into Integer"),c=me(l=g.$begin())?l:fe["$-@"]();me(g["$_lesser_than_end?"](c));)E.yield1(F,c),c=G(c,g.$step());return g}),_(P,"$last",function(F){var g=this,l=z,c=z,f=z;if(U(fe,l=g.$end())||U(fe["$-@"](),l)?J.$raise(q("FloatDomainError"),g.$end()):U(z,l)&&J.$raise(q("RangeError"),"cannot get the last element of endless arithmetic sequence"),c=A(g.$end(),A(g.$end(),g.$begin())["$%"](g.$step())),me(g["$_lesser_than_end?"](c))||(c=A(c,g.$step())),!me(F))return me(g["$_greater_than_begin?"](c))?c:z;for(f=[];me(me(l=g["$_greater_than_begin?"](c))?x(F,0):l);)f["$<<"](c),c=A(c,g.$step()),F=A(F,1);return f.$reverse()},-1),_(P,"$size",function(){var g,F=this,l=z;return g=me(x(F.$step(),0))?1:-1,N(F["$_lesser_than_end?"](F.$begin()))?0:me([fe["$-@"](),fe]["$include?"](F.$step()))?1:me([Y(fe["$-@"](),g),z]["$include?"](F.$begin()))||me([Y(fe,g),z]["$include?"](F.$end()))?fe:(l=A(F.$end(),A(F.$end(),F.$begin())["$%"](F.$step())),me(F["$_lesser_than_end?"](l))||(l=A(l,F.$step())),G(T(A(l,F.$begin()),F.$step()).$abs().$to_i(),1))}),_(P,"$==",function(F){var l,c,f,u,g=this;return me(l=me(c=me(f=me(u=g.$class()["$=="](F.$class()))?g.$begin()["$=="](F.$begin()):u)?g.$end()["$=="](F.$end()):f)?g.$step()["$=="](F.$step()):c)?g["$exclude_end?"]()["$=="](F["$exclude_end?"]()):l}),_(P,"$hash",function(){var F=this;return[F.$begin(),F.$end(),F.$step(),F["$exclude_end?"]()].$hash()}),_(P,"$inspect",function(){var F=this,g=z;return me(F.receiver_num)?(g=me(F.step_arg2)?"("+F.topfx+F.step_arg1.$inspect()+", "+F.bypfx+F.step_arg2.$inspect()+")":me(F.step_arg1)?"("+F.topfx+F.step_arg1.$inspect()+")":z,"("+F.receiver_num.$inspect()+"."+F.creation_method+g+")"):(g=me(F.skipped_arg)?z:"("+F.step+")","(("+F.range.$inspect()+")."+F.creation_method+g+")")}),j(P,"===","=="),j(P,"eql?","==")}(Q,Q,L)},Opal.modules["corelib/enumerator/chain"]=function(E){var j,oe,N,le=E.deny_frozen_access,me=E.klass,d=E.slice,H=E.def,J=E.send,_=E.to_a,x=E.truthy,O=E.rb_plus,w=E.thrower,K=E.nil,G=E.$$$;return N=me("::",null,"Enumerator"),(oe=(j=me(N,N,"Chain")).$$prototype).enums=oe.iterated=K,H(j,"$initialize",function(q){var M,I=this;return M=d(arguments),le(I),I.enums=M,I.iterated=[],I.object=I},-1),H(j,"$each",function z(q){var M,I,X=z.$$p||K,Q=this;return z.$$p=null,M=d(arguments),I=M,X===K?J(Q,"to_enum",["each"].concat(_(I)),function L(){return(L.$$s??this).$size()},{$$s:Q}):(J(Q.enums,"each",[],function L(S){var k=L.$$s??this;return null==k.iterated&&(k.iterated=K),null==S&&(S=K),k.iterated["$<<"](S),J(S,"each",_(I),X.$to_proc())},{$$s:Q}),Q)},-1),H(j,"$size",function(q){try{var M,I,X=w("return"),Q=this,L=K;return M=d(arguments),I=M,L=0,J(Q.enums,"each",[],function(k){var v;return null==k&&(k=K),v=J(k,"size",_(I)),x([K,G(G("Float"),"INFINITY")]["$include?"](v))&&X.$throw(v),L=O(L,v)},{$$ret:X}),L}catch(S){if(S===X)return S.$v;throw S}},-1),H(j,"$rewind",function(){var q=this;return J(q.iterated,"reverse_each",[],function(M){return null==M&&(M=K),x(M["$respond_to?"]("rewind"))?M.$rewind():K}),q.iterated=[],q}),H(j,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"})},Opal.modules["corelib/enumerator/generator"]=function(E){var U,oe,z,q,X,Y,le=E.deny_frozen_access,me=E.klass,d=E.truthy,H=E.Kernel,J=E.def,_=E.slice,x=E.send,O=[],w=E.nil,K=E.$$$;return U=O,oe=Y=[me(O[0],null,"Enumerator")].concat(U),q=[z=me(Y[0],null,"Generator")].concat(oe),X=E.$r(q),z.$$prototype.block=w,z.$include(K("Enumerable")),J(z,"$initialize",function I(){var Q=I.$$p||w;return I.$$p=null,le(this),d(Q)||H.$raise(K("LocalJumpError"),"no block given"),this.block=Q}),J(z,"$each",function I(Q){var k,L=I.$$p||w,v=this,P=w;I.$$p=null,k=_(arguments),P=x(X("Yielder"),"new",[],L.$to_proc());try{k.unshift(P),E.yieldX(v.block,k)}catch(B){if(B&&"breaker"==B.$thrower_type)return B.$v;throw B}return v},-1)},Opal.modules["corelib/enumerator/lazy"]=function(E){var S,te,D,fe,R,k,le=E.truthy,me=E.coerce_to,d=E.yield1,H=E.yieldX,J=E.deny_frozen_access,_=E.klass,x=E.slice,O=E.send2,w=E.find_super,K=E.to_a,G=E.defs,A=E.Kernel,U=E.send,N=E.def,Y=E.return_self,T=E.Opal,j=E.rb_lt,oe=E.eqeqeq,z=E.rb_plus,q=E.alias,M=E.nil,I=E.$$$;return S=[],te=[k=_("::",null,"Enumerator")].concat(S),fe=[D=_(k,k,"Lazy")].concat(te),R=E.$r(fe),D.$$prototype.enumerator=M,_(D,I("Exception"),"StopLazyError"),G(D,"$for",function g(l,c){var u,p=g.$$p||M,m=this,C=M;return g.$$p=null,u=x(arguments,1),(C=O(m,w(m,"for",g,!1,!0),"for",[l].concat(K(u)),p)).enumerator=l,C},-2),N(D,"$initialize",function g(l,c){var f=g.$$p||M,u=this;return g.$$p=null,null==c&&(c=M),J(u),f===M&&A.$raise(I("ArgumentError"),"tried to call lazy new without a block"),u.enumerator=l,O(u,w(u,"initialize",g,!1,!0),"initialize",[c],function(m,C){var re;null==m&&(m=M),re=x(arguments,1);try{return U(l,"each",K(re),function(Ee){var ce;(ce=x(arguments)).unshift(m),H(f,ce)},-1)}catch(se){if(!E.rescue(se,[R("StopLazyError")]))throw se;try{return M}finally{E.pop_exception()}}},-2)},-2),N(D,"$lazy",Y),N(D,"$collect",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy map without a block"),U(R("Lazy"),"new",[this,this.$enumerator_size()],function(u,p){var m;null==u&&(u=M),m=x(arguments,1);var $=H(l,m);u.$yield($)},-2)}),N(D,"$collect_concat",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy map without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m;null==u&&(u=M),m=x(arguments,1);var $=H(l,m);if($["$respond_to?"]("force")&&$["$respond_to?"]("each"))U($,"each",[],function(Ee){return null==Ee&&(Ee=M),u.$yield(Ee)});else{var re=T.$try_convert($,I("Array"),"to_ary");re===M?u.$yield($):U($,"each",[],function(Ee){return null==Ee&&(Ee=M),u.$yield(Ee)})}},-2)}),N(D,"$drop",function(l){var f,u,p=M;return l=me(l,I("Integer"),"to_int"),le(j(l,0))&&A.$raise(I("ArgumentError"),"attempt to drop negative size"),f=this.$enumerator_size(),u=oe(I("Integer"),f)&&le(j(l,f))?l:f,p=0,U(R("Lazy"),"new",[this,u],function(C,$){var se;return null==C&&(C=M),se=x(arguments,1),le(j(p,l))?p=z(p,1):U(C,"yield",K(se))},-2)}),N(D,"$drop_while",function g(){var l=g.$$p||M,f=M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy drop_while without a block"),f=!0,U(R("Lazy"),"new",[this,M],function(p,m){var $;if(null==p&&(p=M),$=x(arguments,1),!le(f))return U(p,"yield",K($));var re=H(l,$);le(re)||(f=!1,U(p,"yield",K($)))},-2)}),N(D,"$enum_for",function g(l,c){var u,p,m,f=g.$$p||M,C=this;return g.$$p=null,(u=x(arguments)).length>0&&(p=u.shift()),null==p&&(p="each"),m=u,U(C.$class(),"for",[C,p].concat(K(m)),f.$to_proc())},-1),N(D,"$find_all",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy select without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m,C;null==u&&(u=M),m=x(arguments,1);var $=H(l,C=m);le($)&&U(u,"yield",K(C))},-2)}),N(D,"$grep",function g(l){var c=g.$$p||M;return g.$$p=null,le(c)?U(R("Lazy"),"new",[this,M],function(p,m){var C;null==p&&(p=M),C=x(arguments,1);var re=T.$destructure(C),se=l["$==="](re);le(se)&&(se=d(c,re),p.$yield(d(c,re)))},-2):U(R("Lazy"),"new",[this,M],function(p,m){var C;null==p&&(p=M),C=x(arguments,1);var re=T.$destructure(C),se=l["$==="](re);le(se)&&p.$yield(re)},-2)}),N(D,"$reject",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy reject without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m,C;null==u&&(u=M),m=x(arguments,1);var $=H(l,C=m);le($)||U(u,"yield",K(C))},-2)}),N(D,"$take",function(l){var f,u,p=M;return l=me(l,I("Integer"),"to_int"),le(j(l,0))&&A.$raise(I("ArgumentError"),"attempt to take negative size"),f=this.$enumerator_size(),u=oe(I("Integer"),f)&&le(j(l,f))?l:f,p=0,U(R("Lazy"),"new",[this,u],function(C,$){var se;return null==C&&(C=M),se=x(arguments,1),le(j(p,l))?(U(C,"yield",K(se)),p=z(p,1)):A.$raise(R("StopLazyError"))},-2)}),N(D,"$take_while",function g(){var l=g.$$p||M;return g.$$p=null,le(l)||A.$raise(I("ArgumentError"),"tried to call lazy take_while without a block"),U(R("Lazy"),"new",[this,M],function(u,p){var m,C;null==u&&(u=M),m=x(arguments,1);var $=H(l,C=m);le($)?U(u,"yield",K(C)):A.$raise(R("StopLazyError"))},-2)}),N(D,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"}),q(D,"force","to_a"),q(D,"filter","find_all"),q(D,"flat_map","collect_concat"),q(D,"map","collect"),q(D,"select","find_all"),q(D,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(E){var K,Y,A,le=E.klass,me=E.def,d=E.slice,H=E.send,J=E.to_a,_=[],x=E.nil;return K=_,A=[le(_[0],null,"Enumerator")].concat(K),(Y=le(A[0],null,"Yielder")).$$prototype.block=x,me(Y,"$initialize",function j(){var oe=j.$$p||x;return j.$$p=null,this.block=oe,this}),me(Y,"$yield",function(oe){var z,X=this;z=d(arguments);var M=E.yieldX(X.block,z);if(M&&"break"==M.$thrower_type)throw M;return M},-1),me(Y,"$<<",function(oe){return this.$yield(oe),this}),me(Y,"$to_proc",function(){return H(this,"proc",[],function z(q){var X,I=z.$$s??this;return X=d(arguments),H(I,"yield",J(X))},{$$arity:-1,$$s:this})})},Opal.modules["corelib/enumerator"]=function(E){var L,S,k,v,P,le=E.slice,me=E.coerce_to,d=E.deny_frozen_access,H=E.klass,J=E.defs,_=E.truthy,x=E.send,O=E.not,w=E.def,K=E.rb_plus,G=E.to_a,A=E.Opal,U=E.send2,N=E.find_super,Y=E.rb_ge,T=E.Kernel,j=E.rb_le,oe=E.alias,X=E.nil,M=E.$$$;return E.top.$require("corelib/enumerable"),L=[],k=[S=H("::",null,"Enumerator")].concat(L),v=E.$r(k),(P=S.$$prototype).size=P.args=P.object=P.method=P.values=P.cursor=X,S.$include(M("Enumerable")),S.$$prototype.$$is_enumerator=!0,J(S,"$for",function B(te,D,fe){var F,g,l,R=B.$$p||X,c=this;B.$$p=null,(F=le(arguments,1)).length>0&&(g=F.shift()),null==g&&(g="each"),l=F;var f=c.$allocate();return f.object=te,f.size=R,f.method=g,f.args=l,f.cursor=0,f},-2),w(S,"$initialize",function B(te){var D=B.$$p||X,F=this;return B.$$p=null,le(arguments),d(F),F.cursor=0,_(D)?(F.object=x(v("Generator"),"new",[],D.$to_proc()),F.method="each",F.args=[],F.size=arguments[0]||X,_(F.size)&&O(F.size["$respond_to?"]("call"))?F.size=me(F.size,M("Integer"),"to_int"):X):(F.object=arguments[0],F.method=arguments[1]||"each",F.args=le(arguments,2),F.size=X)},-1),w(S,"$each",function B(te){var R,D=B.$$p||X,F=this;return B.$$p=null,R=le(arguments),_(D["$nil?"]())&&_(R["$empty?"]())?F:(R=K(F.args,R),_(D["$nil?"]())?x(F.$class(),"new",[F.object,F.method].concat(G(R))):x(F.object,"__send__",[F.method].concat(G(R)),D.$to_proc()))},-1),w(S,"$size",function(){return _(this.size["$respond_to?"]("call"))?x(this.size,"call",G(this.args)):this.size}),w(S,"$with_index",function B(te){var D=B.$$p||X;if(B.$$p=null,null==te&&(te=0),te=_(te)?me(te,M("Integer"),"to_int"):0,!_(D))return x(this,"enum_for",["with_index",te],function g(){return(g.$$s??this).$size()},{$$s:this});var F=te;return this.$each.$$p=function(){var g=A.$destructure(arguments),l=D(g,F);return F++,l},this.$each()},-1),w(S,"$each_with_index",function B(){var te=B.$$p||X,D=this;return B.$$p=null,te===X?x(D,"enum_for",["each_with_index"],function fe(){return(fe.$$s??this).$size()},{$$s:D}):(U(D,N(D,"each_with_index",B,!1,!0),"each_with_index",[],te),D.object)}),w(S,"$rewind",function(){return this.cursor=0,this}),w(S,"$peek_values",function(){var D,te=this;return te.values=_(D=te.values)?D:x(te,"map",[],function(R){return le(arguments)},-1),_(Y(te.cursor,te.values.$length()))&&T.$raise(M("StopIteration"),"iteration reached an end"),te.values["$[]"](te.cursor)}),w(S,"$peek",function(){var D=X;return D=this.$peek_values(),_(j(D.$length(),1))?D["$[]"](0):D}),w(S,"$next_values",function(){var D;return D=this.$peek_values(),this.cursor=K(this.cursor,1),D}),w(S,"$next",function(){var D=X;return D=this.$next_values(),_(j(D.$length(),1))?D["$[]"](0):D}),w(S,"$feed",function(te){return this.$raise(v("NotImplementedError"),"Opal doesn't support Enumerator#feed")}),w(S,"$+",function(te){return M(M("Enumerator"),"Chain").$new(this,te)}),w(S,"$inspect",function(){var te=this,D=X;return D="#<"+te.$class()+": "+te.object.$inspect()+":"+te.method,_(te.args["$any?"]())&&(D=K(D,"("+te.args.$inspect()["$[]"](M("Range").$new(1,-2))+")")),K(D,">")}),oe(S,"with_object","each_with_object"),S.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),S.$autoload("Chain","corelib/enumerator/chain"),S.$autoload("Generator","corelib/enumerator/generator"),S.$autoload("Lazy","corelib/enumerator/lazy"),S.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(E){var P,le=E.klass,me=E.truthy,d=E.Kernel,H=E.def,J=E.to_ary,_=E.return_self,x=E.rb_minus,O=E.rb_times,w=E.rb_lt,K=E.eqeq,G=E.rb_divide,A=E.return_val,U=E.Opal,N=E.slice,Y=E.extract_kwargs,T=E.ensure_kwargs,j=E.not,oe=E.send,z=E.rb_ge,q=E.rb_le,X=E.rb_plus,M=E.rb_gt,I=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/comparable"),(P=le("::",null,"Numeric")).$include(S("Comparable")),H(P,"$coerce",function(te){var D=this;return me(te["$instance_of?"](D.$class()))?[te,D]:[d.$Float(te),d.$Float(D)]}),H(P,"$__coerced__",function(te,D){var fe,R;if(me(D["$respond_to?"]("coerce")))return R=D.$coerce(this),((fe=J(R))[0]??L).$__send__(te,fe[1]??L);switch(te){case"+":case"-":case"*":case"/":case"%":case"&":case"|":case"^":case"**":return d.$raise(S("TypeError"),D.$class()+" can't be coerced into Numeric");case">":case">=":case"<":case"<=":case"<=>":return d.$raise(S("ArgumentError"),"comparison of "+this.$class()+" with "+D.$class()+" failed");default:return L}}),H(P,"$<=>",function(te){return me(this["$equal?"](te))?0:L}),H(P,"$+@",_),H(P,"$-@",function(){return x(0,this)}),H(P,"$%",function(te){return x(this,O(te,this.$div(te)))}),H(P,"$abs",function(){return w(this,0)?this["$-@"]():this}),H(P,"$abs2",function(){return O(this,this)}),H(P,"$angle",function(){return w(this,0)?S(S("Math"),"PI"):0}),H(P,"$ceil",function(te){return null==te&&(te=0),this.$to_f().$ceil(te)},-1),H(P,"$conj",_),H(P,"$denominator",function(){return this.$to_r().$denominator()}),H(P,"$div",function(te){return K(te,0)&&d.$raise(S("ZeroDivisionError"),"divided by o"),G(this,te).$floor()}),H(P,"$divmod",function(te){return[this.$div(te),this["$%"](te)]}),H(P,"$fdiv",function(te){return G(this.$to_f(),te)}),H(P,"$floor",function(te){return null==te&&(te=0),this.$to_f().$floor(te)},-1),H(P,"$i",function(){return d.$Complex(0,this)}),H(P,"$imag",A(0)),H(P,"$integer?",A(!1)),H(P,"$nonzero?",function(){return me(this["$zero?"]())?L:this}),H(P,"$numerator",function(){return this.$to_r().$numerator()}),H(P,"$polar",function(){return[this.$abs(),this.$arg()]}),H(P,"$quo",function(te){return G(U["$coerce_to!"](this,S("Rational"),"to_r"),te)}),H(P,"$real",_),H(P,"$real?",A(!0)),H(P,"$rect",function(){return[this,0]}),H(P,"$round",function(te){return this.$to_f().$round(te)},-1),H(P,"$step",function B(te,D,fe){var F,g,l,c,f,u,R=B.$$p||L,p=this,m=L;function C(){c===L&&d.$raise(S("TypeError"),"step must be numeric"),null!=c&&c["$=="](0)&&d.$raise(S("ArgumentError"),"step can't be 0"),(c===L||null==c)&&(c=1);var he=c["$<=>"](0);he===L&&d.$raise(S("ArgumentError"),"0 can't be coerced into "+c.$class()),(l===L||null==l)&&(l=he>0?S(S("Float"),"INFINITY"):S(S("Float"),"INFINITY")["$-@"]()),U.$compare(p,l)}function $(){if(c>0&&p>l||c<0&&p<l)return 0;if(c===1/0||c===-1/0)return 1;var he=Math.abs,Ie=Math.floor,be=(he(p)+he(l)+he(l-p))/he(c)*S(S("Float"),"EPSILON");return be===1/0||be===-1/0?0:(be>.5&&(be=.5),Ie((l-p)/c+be)+1)}function re(){if(C(),0===c)return 1/0;if(c%1!=0)return $();if(c>0&&p>l||c<0&&p<l)return 0;var he=Math.ceil,Ie=Math.abs;return he((Ie(p-l)+1)/Ie(c))}if(B.$$p=null,F=N(arguments),g=Y(F),g=T(g),F.length>0&&(l=F.shift()),F.length>0&&(c=F.shift()),f=g.$$smap.to,u=g.$$smap.by,void 0!==l&&void 0!==f&&d.$raise(S("ArgumentError"),"to is given twice"),void 0!==c&&void 0!==u&&d.$raise(S("ArgumentError"),"step is given twice"),void 0!==f&&(l=f),void 0!==u&&(c=u),void 0===l&&(l=L),R===L)return(j(l)||me(l["$is_a?"](S("Numeric"))))&&(j(c)||me(c["$is_a?"](S("Numeric"))))?S(S("Enumerator"),"ArithmeticSequence").$new([l,c,me(f)?"to: ":L,me(u)?"by: ":L],p):oe(p,"enum_for",["step",l,c],re.$to_proc());C();var se=c["$negative?"](),Ee=c["$=="](0)||l===1/0&&!se||l===-1/0&&se;if(p.$$is_number&&c.$$is_number&&l.$$is_number){if(p%1!=0||!Ee&&l%1!=0||c%1!=0){var ce=p.$to_f().valueOf();c=c.$to_f().valueOf(),l=l.$to_f().valueOf();var ke=$();if(isFinite(c))if(0===c)for(;;)R(ce);else for(var ve=0;ve<ke;ve++){var ye=ve*c+p;(c>=0?l<ye:l>ye)&&(ye=l),R(ye)}else 0!==ke&&R(ce);return p}var Me=p;if(Ee)for(;;Me+=c)R(Me);else if(se)for(;Me>=l;Me+=c)R(Me);else for(;Me<=l;Me+=c)R(Me);return p}for(m=p;me(se?z(m,l):q(m,l));)E.yield1(R,m),m=X(m,c)},-1),H(P,"$to_c",function(){return d.$Complex(this,0)}),H(P,"$to_int",function(){return this.$to_i()}),H(P,"$truncate",function(te){return null==te&&(te=0),this.$to_f().$truncate(te)},-1),H(P,"$zero?",function(){return this["$=="](0)}),H(P,"$positive?",function(){return M(this,0)}),H(P,"$negative?",function(){return w(this,0)}),H(P,"$dup",_),H(P,"$clone",function(te){return te=T(te),this},-1),H(P,"$finite?",A(!0)),H(P,"$infinite?",A(L)),I(P,"arg","angle"),I(P,"conjugate","conj"),I(P,"imaginary","imag"),I(P,"magnitude","abs"),I(P,"modulo","%"),I(P,"phase","arg"),I(P,"rectangular","rect")},Opal.modules["corelib/array"]=function(E){var le=E.truthy,me=E.falsy,d=E.hash_ids,H=E.yield1,J=E.hash_get,_=E.hash_put,x=E.hash_delete,O=E.coerce_to,w=E.respond_to,K=E.deny_frozen_access,G=E.freeze,A=E.klass,U=E.slice,N=E.defs,Y=E.Kernel,T=E.def,j=E.Opal,oe=E.eqeqeq,z=E.hash2,q=E.send2,X=E.find_super,M=E.send,I=E.rb_gt,Q=E.rb_times,L=E.eqeq,S=E.rb_minus,k=E.to_a,v=E.to_ary,P=E.gvars,B=E.rb_ge,te=E.assign_ivar,D=E.rb_lt,fe=E.return_self,R=E.neqeq,F=E.alias,g=E.top,c=E.nil,f=E.$$$;return g.$require("corelib/enumerable"),g.$require("corelib/numeric"),function(u,p,m){var C=A("::",Array,"Array"),$=[C].concat([]),re=E.$r($);function Ee(be,ae){return ae.$$name===E.Array?be:ae.$allocate().$replace(be.$to_a())}function Me(be,ae,ue){for(var xe,y=null,W=new Array(be.length),pe=0,we=0,De=be.length;pe<De;pe++){if(!y)try{xe=H(ue,be[pe])}catch(Le){y=Le}(y||ae(xe))&&(W[we]=be[pe],we+=1)}if(we!==pe&&(be.splice.apply(be,[0,W.length].concat(W)),be.splice(we,W.length)),y)throw y}function ce(be,ae){var xe,y,W,ue=be.length;return xe=ae.excl,y=ae.begin===c?0:O(ae.begin,E.Integer,"to_int"),W=ae.end===c?-1:O(ae.end,E.Integer,"to_int"),y<0&&(y+=ue)<0||(ae.excl_rev&&ae.begin!==c&&(y+=1),y>ue)?c:W<0&&(W+=ue)<0?[]:((!xe||ae.end===c)&&(W+=1),be.slice(y,W))}function ye(be,ae){return be===ae||0===ae?1:ae>0&&be>ae?ye(be-1,ae-1)+ye(be-1,ae):0}C.$include(f("Enumerable")),E.prop(C.$$prototype,"$$is_array",!0),N(C,"$[]",function(ae){var y=this;return Ee(U(arguments),y)},-1),T(C,"$initialize",function be(ae,ue){var W,pe,xe=be.$$p||c,y=this;if(be.$$p=null,null==ae&&(ae=c),null==ue&&(ue=c),K(y),ue!==c&&xe!==c&&Y.$warn("warning: block supersedes default value argument"),ae>f(f("Integer"),"MAX")&&Y.$raise(f("ArgumentError"),"array size too big"),arguments.length>2&&Y.$raise(f("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return y.splice(0,y.length),y;if(1===arguments.length){if(ae.$$is_array)return y.$replace(ae.$to_a()),y;if(ae["$respond_to?"]("to_ary"))return y.$replace(ae.$to_ary()),y}if((ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError"),"negative array size"),y.splice(0,y.length),xe===c)for(W=0;W<ae;W++)y.push(ue);else for(W=0;W<ae;W++)pe=xe(W),y[W]=pe;return y},-1),N(C,"$try_convert",function(ae){return j["$coerce_to?"](ae,f("Array"),"to_ary")}),T(C,"$&",function(ae){ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a();var W,pe,we,xe=[],y=z([],{});for(W=0,pe=ae.length;W<pe;W++)_(y,ae[W],!0);for(W=0,pe=this.length;W<pe;W++)void 0!==x(y,we=this[W])&&xe.push(we);return xe}),T(C,"$|",function(ae){ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a();var y,W,xe=z([],{});for(y=0,W=this.length;y<W;y++)_(xe,this[y],!0);for(y=0,W=ae.length;y<W;y++)_(xe,ae[y],!0);return xe.$keys()}),T(C,"$*",function(ae){if(le(ae["$respond_to?"]("to_str")))return this.$join(ae.$to_str());ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Y.$raise(f("ArgumentError"),"negative argument");for(var xe=[],y=this.$to_a(),W=0;W<ae;W++)xe=xe.concat(y);return xe}),T(C,"$+",function(ae){return ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),this.concat(ae)}),T(C,"$-",function(ae){if(ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),le(0===this.length))return[];if(le(0===ae.length))return this.slice();var W,pe,we,xe=[],y=z([],{});for(W=0,pe=ae.length;W<pe;W++)_(y,ae[W],!0);for(W=0,pe=this.length;W<pe;W++)void 0===J(y,we=this[W])&&xe.push(we);return xe}),T(C,"$<<",function(ae){return K(this),this.push(ae),this}),T(C,"$<=>",function(ae){if(oe(f("Array"),ae))ae=ae.$to_a();else{if(!le(ae["$respond_to?"]("to_ary")))return c;ae=ae.$to_ary().$to_a()}if(this.$hash()===ae.$hash())return 0;for(var xe=Math.min(this.length,ae.length),y=0;y<xe;y++){var W=this[y]["$<=>"](ae[y]);if(0!==W)return W}return this.length["$<=>"](ae.length)}),T(C,"$==",function(ae){var xe={};return function y(W,pe){var we,De,Le,Ye;if(W===pe)return!0;if(!pe.$$is_array)return!!w(pe,"$to_ary")&&pe["$=="](W);if(W.$$constructor!==Array&&(W=W.$to_a()),pe.$$constructor!==Array&&(pe=pe.$to_a()),W.length!==pe.length)return!1;for(xe[W.$object_id()]=!0,we=0,De=W.length;we<De;we++)if(Ye=pe[we],(Le=W[we]).$$is_array){if(Ye.$$is_array&&Ye.length!==Le.length||!xe.hasOwnProperty(Le.$object_id())&&!y(Le,Ye))return!1}else if(!Le["$=="](Ye))return!1;return!0}(this,ae)}),T(C,"$[]",function(ae,ue){return ae.$$is_range?ce(this,ae):ae.$$is_arithmetic_seq?function ke(be,ae){var ue,xe=[],y=0;for(ue=ae.step<0?ce(be,{begin:ae.range.end,end:ae.range.begin,excl:!1,excl_rev:ae.range.excl}).$reverse():ce(be,ae.range);y<ue.length;)xe.push(ue[y]),y+=Math.abs(ae.step);return xe}(this,ae):function ve(be,ae,ue){var xe=be.length;return(ae=O(ae,E.Integer,"to_int"))<0&&(ae+=xe)<0?c:void 0===ue?ae>=xe||ae<0?c:be[ae]:(ue=O(ue,E.Integer,"to_int"))<0||ae>xe||ae<0?c:be.slice(ae,ae+ue)}(this,ae,ue)},-2),T(C,"$[]=",function(ae,ue,xe){var y=this,W=c,pe=c;K(y),W=c;var we,Dt,De=y.length;if(ae.$$is_range){W=ue.$$is_array?ue.$to_a():ue["$respond_to?"]("to_ary")?ue.$to_ary().$to_a():[ue];var Le=ae.excl,Ye=ae.begin===c?0:O(ae.begin,E.Integer,"to_int"),ut=ae.end===c?-1:O(ae.end,E.Integer,"to_int");if(Ye<0&&(Ye+=De)<0&&Y.$raise(f("RangeError"),ae.$inspect()+" out of range"),ut<0&&(ut+=De),(!Le||ae.end===c)&&(ut+=1),Ye>De)for(we=De;we<Ye;we++)y[we]=c;return y.splice.apply(y,ut<0?[Ye,0].concat(W):[Ye,ut-Ye].concat(W)),ue}if(void 0===xe?pe=1:(pe=ue,W=(ue=xe).$$is_array?ue.$to_a():ue["$respond_to?"]("to_ary")?ue.$to_ary().$to_a():[ue]),ae=O(ae,f("Integer"),"to_int"),pe=O(pe,f("Integer"),"to_int"),ae<0&&(Dt=ae,(ae+=De)<0&&Y.$raise(f("IndexError"),"index "+Dt+" too small for array; minimum "+-y.length)),pe<0&&Y.$raise(f("IndexError"),"negative length ("+pe+")"),ae>De)for(we=De;we<ae;we++)y[we]=c;return void 0===xe?y[ae]=ue:y.splice.apply(y,[ae,pe].concat(W)),ue},-3),T(C,"$any?",function be(ae){var ue=be.$$p||c;return be.$$p=null,0!==this.length&&q(this,X(this,"any?",be,!1,!0),"any?",[ae],ue)},-1),T(C,"$assoc",function(ae){for(var W,xe=0,y=this.length;xe<y;xe++)if((W=this[xe]).length&&W[0]["$=="](ae))return W;return c}),T(C,"$at",function(ae){return(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=this.length),ae<0||ae>=this.length?c:this[ae]}),T(C,"$bsearch_index",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return this.$enum_for("bsearch_index");for(var W,we,xe=0,y=this.length,De=!1,Le=c;xe<y;){if(W=xe+Math.floor((y-xe)/2),!0===(we=H(ae,this[W])))Le=W,De=!0;else if(!1===we||we===c)De=!1;else if(we.$$is_number){if(0===we)return W;De=we<0}else Y.$raise(f("TypeError"),"wrong argument type "+we.$class()+" (must be numeric, true, false or nil)");De?y=W:xe=W+1}return Le}),T(C,"$bsearch",function be(){var ae=be.$$p||c,xe=c;return be.$$p=null,ae===c?this.$enum_for("bsearch"):null!=(xe=M(this,"bsearch_index",[],ae.$to_proc()))&&xe.$$is_number?this[xe]:xe}),T(C,"$cycle",function be(ae){var y,W,ue=be.$$p||c,xe=this;if(be.$$p=null,null==ae&&(ae=c),ue===c)return M(xe,"enum_for",["cycle",ae],function we(){var De=we.$$s??this;return le(ae["$nil?"]())?f(f("Float"),"INFINITY"):(ae=j["$coerce_to!"](ae,f("Integer"),"to_int"),le(I(ae,0))?Q(De.$enumerator_size(),ae):0)},{$$s:xe});if(le(xe["$empty?"]())||L(ae,0))return c;if(ae===c)for(;;)for(y=0,W=xe.length;y<W;y++)H(ue,xe[y]);else{if((ae=j["$coerce_to!"](ae,f("Integer"),"to_int"))<=0)return xe;for(;ae>0;){for(y=0,W=xe.length;y<W;y++)H(ue,xe[y]);ae--}}return xe},-1),T(C,"$clear",function(){return K(this),this.splice(0,this.length),this}),T(C,"$count",function be(ae){var ue=be.$$p||c;return be.$$p=null,le(void 0!==ae)||le(ue)?q(this,X(this,"count",be,!1,!0),"count",[ae],ue):this.$size()},-1),T(C,"$initialize_copy",function(ae){return this.$replace(ae)}),T(C,"$collect",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return M(this,"enum_for",["collect"],function we(){return(we.$$s??this).$size()},{$$s:this});for(var xe=[],y=0,W=this.length;y<W;y++){var pe=H(ae,this[y]);xe.push(pe)}return xe}),T(C,"$collect!",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["collect!"],function pe(){return(pe.$$s??this).$size()},{$$s:ue});K(ue);for(var xe=0,y=ue.length;xe<y;xe++){var W=H(ae,ue[xe]);ue[xe]=W}return ue}),T(C,"$combination",function be(ae){var y,W,pe,we,De,Le,Ye,ut,ue=be.$$p||c,xe=this;if(be.$$p=null,y=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c)return M(xe,"enum_for",["combination",y],function Dt(){return ye((Dt.$$s??this).length,y)},{$$s:xe});if(0===y)E.yield1(ue,[]);else if(1===y)for(W=0,pe=xe.length;W<pe;W++)E.yield1(ue,[xe[W]]);else if(y===xe.length)E.yield1(ue,xe.slice());else if(y>=0&&y<xe.length){for(we=[],W=0;W<=y+1;W++)we.push(0);for(De=[],Le=0,Ye=!1,we[0]=-1;!Ye;){for(De[Le]=xe[we[Le+1]];Le<y-1;)ut=we[1+ ++Le]=we[Le]+1,De[Le]=xe[ut];E.yield1(ue,De.slice()),Le++;do{Ye=0===Le,we[Le]++,Le--}while(we[Le+1]+y===xe.length+Le+1)}}return xe}),T(C,"$repeated_combination",function be(ae){var y,ue=be.$$p||c;return be.$$p=null,y=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c?M(this,"enum_for",["repeated_combination",y],function pe(){return ye((pe.$$s??this).length+y-1,y)},{$$s:this}):(y>=0&&function W(pe,we,De,Le){if(De.length!=pe)for(var ut=we;ut<Le.length;ut++)De.push(Le[ut]),W(pe,ut,De,Le),De.pop();else{var Ye=De.slice();E.yield1(ue,Ye)}}(y,0,[],this),this)}),T(C,"$compact",function(){for(var W,ue=[],xe=0,y=this.length;xe<y;xe++)(W=this[xe])!==c&&ue.push(W);return ue}),T(C,"$compact!",function(){var ae=this;K(ae);for(var ue=ae.length,xe=0,y=ae.length;xe<y;xe++)ae[xe]===c&&(ae.splice(xe,1),y--,xe--);return ae.length===ue?c:ae}),T(C,"$concat",function(ae){var xe,y=this;return xe=U(arguments),K(y),xe=M(xe,"map",[],function W(pe){var we=W.$$s??this;return null==pe&&(pe=c),pe=oe(f("Array"),pe)?pe.$to_a():O(pe,f("Array"),"to_ary").$to_a(),le(pe["$equal?"](we))&&(pe=pe.$dup()),pe},{$$s:y}),M(xe,"each",[],function W(pe){var we=W.$$s??this;null==pe&&(pe=c);for(var De=0,Le=pe.length;De<Le;De++)we.push(pe[De])},{$$s:y}),y},-1),T(C,"$delete",function be(ae){var ue=be.$$p||c,xe=this;be.$$p=null;for(var y=xe.length,W=0,pe=y;W<pe;W++)xe[W]["$=="](ae)&&(K(xe),xe.splice(W,1),pe--,W--);return xe.length===y?ue!==c?E.yieldX(ue,[]):c:ae}),T(C,"$delete_at",function(ae){var ue=this;if(K(ue),(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=ue.length),ae<0||ae>=ue.length)return c;var xe=ue[ae];return ue.splice(ae,1),xe}),T(C,"$delete_if",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ae===c?M(ue,"enum_for",["delete_if"],function xe(){return(xe.$$s??this).$size()},{$$s:ue}):(K(ue),Me(ue,me,ae),ue)}),T(C,"$difference",function(ae){var ue,y=this;return ue=U(arguments),M(ue,"reduce",[y.$to_a().$dup()],function(pe,we){return null==pe&&(pe=c),null==we&&(we=c),S(pe,we)})},-1),T(C,"$dig",function(ae,ue){var y,W=this,pe=c;return y=U(arguments,1),(pe=W["$[]"](ae))===c||0===y.length?pe:(le(pe["$respond_to?"]("dig"))||Y.$raise(f("TypeError"),pe.$class()+" does not have #dig method"),M(pe,"dig",k(y)))},-2),T(C,"$drop",function(ae){return(ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError")),this.slice(ae)}),T(C,"$dup",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ue.$$class===E.Array&&ue.$$class.$allocate.$$pristine&&ue.$copy_instance_variables.$$pristine&&ue.$initialize_dup.$$pristine?ue.slice(0):q(ue,X(ue,"dup",be,!1,!0),"dup",[],ae)}),T(C,"$each",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["each"],function pe(){return(pe.$$s??this).$size()},{$$s:ue});for(var xe=0,y=ue.length;xe<y;xe++)H(ae,ue[xe]);return ue}),T(C,"$each_index",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return M(this,"enum_for",["each_index"],function pe(){return(pe.$$s??this).$size()},{$$s:this});for(var xe=0,y=this.length;xe<y;xe++)H(ae,xe);return this}),T(C,"$empty?",function(){return 0===this.length}),T(C,"$eql?",function(ae){var xe={};return function y(W,pe){var we,De,Le,Ye;if(!pe.$$is_array||(pe=pe.$to_a(),W.length!==pe.length))return!1;for(xe[W.$object_id()]=!0,we=0,De=W.length;we<De;we++)if(Ye=pe[we],(Le=W[we]).$$is_array){if(Ye.$$is_array&&Ye.length!==Le.length||!xe.hasOwnProperty(Le.$object_id())&&!y(Le,Ye))return!1}else if(!Le["$eql?"](Ye))return!1;return!0}(this,ae)}),T(C,"$fetch",function be(ae,ue){var xe=be.$$p||c,y=this;be.$$p=null;var W=ae;return(ae=O(ae,f("Integer"),"to_int"))<0&&(ae+=y.length),ae>=0&&ae<y.length?y[ae]:(xe!==c&&null!=ue&&y.$warn("warning: block supersedes default value argument"),xe!==c?xe(W):null!=ue?ue:void Y.$raise(f("IndexError"),0===y.length?"index "+W+" outside of array bounds: 0...0":"index "+W+" outside of array bounds: -"+y.length+"..."+y.length))},-2),T(C,"$fill",function be(ae){var y,W,Ot,tn,ue=be.$$p||c,we=this,De=c,Le=c,Ye=c,ut=c,Dt=c;if(be.$$p=null,y=U(arguments),K(we),le(ue)?(le(y.length>2)&&Y.$raise(f("ArgumentError"),"wrong number of arguments ("+y.$length()+" for 0..2)"),De=(W=v(y))[0]??c,Le=W[1]??c):(le(0==y.length)?Y.$raise(f("ArgumentError"),"wrong number of arguments (0 for 1..3)"):le(y.length>3)&&Y.$raise(f("ArgumentError"),"wrong number of arguments ("+y.$length()+" for 1..3)"),Ye=(W=v(y))[0]??c,De=W[1]??c,Le=W[2]??c),oe(f("Range"),De)){if(le(Le)&&Y.$raise(f("TypeError"),"length invalid with range"),ut=De.begin===c?0:O(De.begin,f("Integer"),"to_int"),le(ut<0)&&(ut+=this.length),le(ut<0)&&Y.$raise(f("RangeError"),De.$inspect()+" out of range"),Dt=De.end===c?-1:O(De.end,f("Integer"),"to_int"),le(Dt<0)&&(Dt+=this.length),le(De["$exclude_end?"]())||(Dt+=1),le(Dt<=ut))return we}else if(le(De))if(ut=O(De,f("Integer"),"to_int"),le(ut<0)&&(ut+=this.length),le(ut<0)&&(ut=0),le(Le)){if(Dt=O(Le,f("Integer"),"to_int"),le(0==Dt))return we;Dt+=ut}else Dt=this.length;else ut=0,Dt=this.length;if(le(ut>this.length))for(Ot=this.length;Ot<Dt;Ot++)we[Ot]=c;if(le(Dt>this.length)&&(this.length=Dt),le(ue))for(;ut<Dt;ut++)tn=ue(ut),we[ut]=tn;else for(;ut<Dt;ut++)we[ut]=Ye;return we},-1),T(C,"$first",function(ae){return null==ae?0===this.length?c:this[0]:((ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError"),"negative array size"),this.slice(0,ae))},-1),T(C,"$flatten",function(ae){var ue=this;return void 0!==ae&&(ae=O(ae,f("Integer"),"to_int")),function xe(y,W){var we,De,Le,Ye,pe=[];for(we=0,De=(y=y.$to_a()).length;we<De;we++)if(w(Le=y[we],"$to_ary",!0))if((Ye=Le.$to_ary())!==c)switch(Ye.$$is_array||Y.$raise(f("TypeError")),Ye===ue&&Y.$raise(f("ArgumentError")),W){case void 0:pe=pe.concat(xe(Ye));break;case 0:pe.push(Ye);break;default:pe.push.apply(pe,xe(Ye,W-1))}else pe.push(Le);else pe.push(Le);return pe}(ue,ae)},-1),T(C,"$flatten!",function(ae){var ue=this;K(ue);var xe=ue.$flatten(ae);if(ue.length==xe.length){for(var y=0,W=ue.length;y<W&&ue[y]===xe[y];y++);if(y==W)return c}return ue.$replace(xe),ue},-1),T(C,"$freeze",function(){return le(this["$frozen?"]())?this:G(this)}),T(C,"$hash",function(){var pe,we,ae=this,ue=void 0===d,xe=["A"],y=ae.$object_id();try{if(ue&&(d=Object.create(null)),d[y])return"self";for(we in d)if(ae["$eql?"](d[we]))return"self";for(d[y]=ae,pe=0;pe<ae.length;pe++)xe.push(ae[pe].$hash());return xe.join(",")}finally{ue&&(d=void 0)}}),T(C,"$include?",function(ae){for(var xe=0,y=this.length;xe<y;xe++)if(this[xe]["$=="](ae))return!0;return!1}),T(C,"$index",function be(ae){var y,W,pe,ue=be.$$p||c,xe=this;if(be.$$p=null,null!=ae&&ue!==c&&xe.$warn("warning: given block not used"),null!=ae){for(y=0,W=xe.length;y<W;y++)if(xe[y]["$=="](ae))return y}else{if(ue===c)return xe.$enum_for("index");for(y=0,W=xe.length;y<W;y++)if(!1!==(pe=ue(xe[y]))&&pe!==c)return y}return c},-1),T(C,"$insert",function(ae,ue){var y,W=this;if(y=U(arguments,1),K(W),ae=O(ae,f("Integer"),"to_int"),y.length>0){if(ae<0&&(ae+=W.length+1)<0&&Y.$raise(f("IndexError"),ae+" is out of bounds"),ae>W.length)for(var pe=W.length;pe<ae;pe++)W.push(c);W.splice.apply(W,[ae,0].concat(y))}return W},-2);var ue,he=[];return T(C,"$inspect",function(){var ae=this,ue=[],xe=ae.$__id__(),y=!0;return function(){try{if(-1!==he.indexOf(xe))return y=!1,"[...]";he.push(xe);for(var W=0,pe=ae.length;W<pe;W++){var we=ae["$[]"](W);ue.push(re("Opal").$inspect(we))}return"["+ue.join(", ")+"]"}finally{y&&he.pop()}}()}),T(C,"$intersection",function(ae){var ue,y=this;return ue=U(arguments),M(ue,"reduce",[y.$to_a().$dup()],function(pe,we){return null==pe&&(pe=c),null==we&&(we=c),pe["$&"](we)})},-1),T(C,"$intersect?",function(ae){return this.$intersection(ae)["$empty?"]()["$!"]()}),T(C,"$join",function(ae){var ue=this;if(null==P[","]&&(P[","]=c),null==ae&&(ae=c),le(0===ue.length))return"";le(ae===c)&&(ae=P[","]);var y,W,pe,we,xe=[];for(y=0,W=ue.length;y<W;y++)w(pe=ue[y],"$to_str")&&(we=pe.$to_str())!==c?xe.push(we.$to_s()):w(pe,"$to_ary")&&((we=pe.$to_ary())===ue&&Y.$raise(f("ArgumentError")),we!==c)?xe.push(we.$join(ae)):w(pe,"$to_s")&&(we=pe.$to_s())!==c?xe.push(we):Y.$raise(f("NoMethodError").$new(re("Opal").$inspect(ue.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return xe.join(ae===c?"":j["$coerce_to!"](ae,f("String"),"to_str").$to_s())},-1),T(C,"$keep_if",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ae===c?M(ue,"enum_for",["keep_if"],function xe(){return(xe.$$s??this).$size()},{$$s:ue}):(K(ue),Me(ue,le,ae),ue)}),T(C,"$last",function(ae){var ue=this;return null==ae?0===ue.length?c:ue[ue.length-1]:((ae=O(ae,f("Integer"),"to_int"))<0&&Y.$raise(f("ArgumentError"),"negative array size"),ae>ue.length&&(ae=ue.length),ue.slice(ue.length-ae,ue.length))},-1),T(C,"$length",function(){return this.length}),T(C,"$max",function be(ae){var ue=be.$$p||c;return be.$$p=null,M(this.$each(),"max",[ae],ue.$to_proc())},-1),T(C,"$min",function be(){var ae=be.$$p||c;return be.$$p=null,M(this.$each(),"min",[],ae.$to_proc())}),T(C,"$permutation",function be(ae){var pe,we,De,ue=be.$$p||c,xe=this,y=c,W=c;if(be.$$p=null,ue===c)return M(xe,"enum_for",["permutation",ae],function Ye(){var ut=Ye.$$s??this;return function Ie(be,ae){for(var ue=ae>=0?1:0;ae;)ue*=be,be--,ae--;return ue}(ut.length,void 0===ae?ut.length:ae)},{$$s:xe});if(!((ae=void 0===ae?xe.length:O(ae,f("Integer"),"to_int"))<0||xe.length<ae))if(0===ae)E.yield1(ue,[]);else if(1===ae)for(var Le=0;Le<xe.length;Le++)E.yield1(ue,[xe[Le]]);else y=re("Array").$new(ae),W=re("Array").$new(xe.length,!1),pe=function(Ye,ut,Dt,Ot,un){xe=this;for(var tn=0;tn<xe.length;tn++)if(Ot["$[]"](tn)["$!"]())if(ut[Dt]=tn,Dt<Ye-1)Ot[tn]=!0,pe.call(xe,Ye,ut,Dt+1,Ot,un),Ot[tn]=!1;else{De=[];for(var On=0;On<ut.length;On++)De.push(xe[ut[On]]);H(un,De)}},ue!==c?(we=xe.slice(),pe.call(we,ae,y,0,W,ue)):pe.call(xe,ae,y,0,W,ue);return xe},-1),T(C,"$repeated_permutation",function be(ae){var y,ue=be.$$p||c;return be.$$p=null,y=j["$coerce_to!"](ae,f("Integer"),"to_int"),ue===c?M(this,"enum_for",["repeated_permutation",y],function pe(){var we=pe.$$s??this;return le(B(y,0))?we.$size()["$**"](y):0},{$$s:this}):(function W(pe,we,De){if(we.length!=pe)for(var Ye=0;Ye<De.length;Ye++)we.push(De[Ye]),W(pe,we,De),we.pop();else{var Le=we.slice();E.yield1(ue,Le)}}(y,[],this.slice()),this)}),T(C,"$pop",function(ae){var ue=this;return K(ue),le(void 0===ae)?le(0===ue.length)?c:ue.pop():(ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Y.$raise(f("ArgumentError"),"negative array size"),le(0===ue.length)?[]:le(1===ae)?[ue.pop()]:le(ae>ue.length)?ue.splice(0,ue.length):ue.splice(ue.length-ae,ue.length))},-1),T(C,"$product",function be(ae){var xe,y,ue=be.$$p||c,W=this;be.$$p=null,xe=U(arguments);var ut,Dt,Ot,un,pe=ue!==c?null:[],we=(y=xe).length+1,De=new Array(we),Le=new Array(we),Ye=new Array(we),tn=1;for(Ye[0]=W,ut=1;ut<we;ut++)Ye[ut]=O(y[ut-1],f("Array"),"to_ary");for(ut=0;ut<we;ut++){if(0===(un=Ye[ut].length))return pe||W;(tn*=un)>2147483647&&Y.$raise(f("RangeError"),"too big to product"),Le[ut]=un,De[ut]=0}e:for(;;){for(Ot=[],ut=0;ut<we;ut++)Ot.push(Ye[ut][De[ut]]);for(pe?pe.push(Ot):E.yield1(ue,Ot),De[Dt=we-1]++;De[Dt]===Le[Dt];){if(De[Dt]=0,--Dt<0)break e;De[Dt]++}}return pe||W},-1),T(C,"$push",function(ae){var xe,y=this;xe=U(arguments),K(y);for(var W=0,pe=xe.length;W<pe;W++)y.push(xe[W]);return y},-1),T(C,"$rassoc",function(ae){for(var W,xe=0,y=this.length;xe<y;xe++)if((W=this[xe]).length&&void 0!==W[1]&&W[1]["$=="](ae))return W;return c}),T(C,"$reject",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["reject"],function we(){return(we.$$s??this).$size()},{$$s:ue});for(var pe,xe=[],y=0,W=ue.length;y<W;y++)(!1===(pe=ae(ue[y]))||pe===c)&&xe.push(ue[y]);return xe}),T(C,"$reject!",function be(){var ae=be.$$p||c,ue=this,xe=c;return be.$$p=null,ae===c?M(ue,"enum_for",["reject!"],function y(){return(y.$$s??this).$size()},{$$s:ue}):(K(ue),xe=ue.$length(),M(ue,"delete_if",[],ae.$to_proc()),L(ue.$length(),xe)?c:ue)}),T(C,"$replace",function(ae){var ue=this;return K(ue),ae=oe(f("Array"),ae)?ae.$to_a():O(ae,f("Array"),"to_ary").$to_a(),ue.splice(0,ue.length),ue.push.apply(ue,ae),ue}),T(C,"$reverse",function(){return this.slice(0).reverse()}),T(C,"$reverse!",function(){return K(this),this.reverse()}),T(C,"$reverse_each",function be(){var ae=be.$$p||c;return be.$$p=null,ae===c?M(this,"enum_for",["reverse_each"],function xe(){return(xe.$$s??this).$size()},{$$s:this}):(M(this.$reverse(),"each",[],ae.$to_proc()),this)}),T(C,"$rindex",function be(ae){var y,W,ue=be.$$p||c,xe=this;if(be.$$p=null,null!=ae&&ue!==c&&xe.$warn("warning: given block not used"),null!=ae){for(y=xe.length-1;y>=0&&!(y>=xe.length);y--)if(xe[y]["$=="](ae))return y}else if(ue!==c){for(y=xe.length-1;y>=0&&!(y>=xe.length);y--)if(!1!==(W=ue(xe[y]))&&W!==c)return y}else if(null==ae)return xe.$enum_for("rindex");return c},-1),T(C,"$rotate",function(ae){var xe,y,W,pe;return null==ae&&(ae=1),ae=O(ae,f("Integer"),"to_int"),1===this.length?this.slice():0===this.length?[]:(W=(xe=this.slice()).slice(y=ae%xe.length),pe=xe.slice(0,y),W.concat(pe))},-1),T(C,"$rotate!",function(ae){var ue=this,xe=c;return null==ae&&(ae=1),K(ue),0===ue.length||1===ue.length?ue:(ae=O(ae,f("Integer"),"to_int"),xe=ue.$rotate(ae),ue.$replace(xe))},-1),(ue=A(C,null,"SampleRandom")).$$prototype.rng=c,T(ue,"$initialize",te("rng")),T(ue,"$rand",function(W){var we;return we=O(this.rng.$rand(W),f("Integer"),"to_int"),le(we<0)&&Y.$raise(f("RangeError"),"random value must be >= 0"),le(we<W)||Y.$raise(f("RangeError"),"random value must be less than Array size"),we}),T(C,"$sample",function(ae,ue){var pe,we,De,Le,Ye,ut,Dt,Ot,xe=this,y=c,W=c;if(le(void 0===ae))return xe.$at(Y.$rand(xe.length));if(le(void 0===ue)?le(y=j["$coerce_to?"](ae,f("Hash"),"to_hash"))?(ue=y,ae=c):(ue=c,ae=O(ae,f("Integer"),"to_int")):(ae=O(ae,f("Integer"),"to_int"),ue=O(ue,f("Hash"),"to_hash")),le(ae)&&le(ae<0)&&Y.$raise(f("ArgumentError"),"count must be greater than 0"),le(ue)&&(W=ue["$[]"]("random")),W=le(W)&&le(W["$respond_to?"]("rand"))?re("SampleRandom").$new(W):Y,!le(ae))return xe[W.$rand(xe.length)];switch(ae>xe.length&&(ae=xe.length),ae){case 0:return[];case 1:return[xe[W.$rand(xe.length)]];case 2:return(Le=W.$rand(xe.length))===(Ye=W.$rand(xe.length))&&(Ye=0===Le?Le+1:Le-1),[xe[Le],xe[Ye]];default:if(xe.length/ae>3){for(pe=!1,we=0,Le=1,(De=re("Array").$new(ae))[0]=W.$rand(xe.length);Le<ae;){for(ut=W.$rand(xe.length),Ye=0;Ye<Le;){for(;ut===De[Ye];){if(++we>100){pe=!0;break}ut=W.$rand(xe.length)}if(pe)break;Ye++}if(pe)break;De[Le]=ut,Le++}if(!pe){for(Le=0;Le<ae;)De[Le]=xe[De[Le]],Le++;return De}}De=xe.slice();for(var un=0;un<ae;un++)Dt=W.$rand(xe.length),Ot=De[un],De[un]=De[Dt],De[Dt]=Ot;return ae===xe.length?De:De["$[]"](0,ae)}},-1),T(C,"$select",function be(){var ae=be.$$p||c;if(be.$$p=null,ae===c)return M(this,"enum_for",["select"],function De(){return(De.$$s??this).$size()},{$$s:this});for(var pe,we,xe=[],y=0,W=this.length;y<W;y++)we=H(ae,pe=this[y]),le(we)&&xe.push(pe);return xe}),T(C,"$select!",function be(){var ae=be.$$p||c,ue=this;if(be.$$p=null,ae===c)return M(ue,"enum_for",["select!"],function y(){return(y.$$s??this).$size()},{$$s:ue});K(ue);var xe=ue.length;return M(ue,"keep_if",[],ae.$to_proc()),ue.length===xe?c:ue}),T(C,"$shift",function(ae){var ue=this;return K(ue),le(void 0===ae)?le(0===ue.length)?c:function se(be){for(var ae=be[0],ue=1,xe=be.length;ue<xe;ue++)be[ue-1]=be[ue];return be.pop(),ae}(ue):(ae=O(ae,f("Integer"),"to_int"),le(ae<0)&&Y.$raise(f("ArgumentError"),"negative array size"),le(0===ue.length)?[]:ue.splice(0,ae))},-1),T(C,"$shuffle",function(ae){return this.$dup().$to_a()["$shuffle!"](ae)},-1),T(C,"$shuffle!",function(ae){var ue=this;K(ue);var xe,W,pe,y=ue.length;for(void 0!==ae&&(ae=j["$coerce_to?"](ae,f("Hash"),"to_hash"))!==c&&(ae=ae["$[]"]("random"))!==c&&ae["$respond_to?"]("rand")&&(xe=ae);y;)xe?((W=xe.$rand(y).$to_int())<0&&Y.$raise(f("RangeError"),"random number too small "+W),W>=y&&Y.$raise(f("RangeError"),"random number too big "+W)):W=ue.$rand(y),pe=ue[--y],ue[y]=ue[W],ue[W]=pe;return ue},-1),T(C,"$slice!",function(ae,ue){var xe=this,y=c,W=c,pe=c,we=c,De=c;if(K(xe),y=c,le(void 0===ue))if(oe(f("Range"),ae)){y=xe["$[]"](W=ae),pe=W.begin===c?0:O(W.begin,f("Integer"),"to_int"),we=W.end===c?-1:O(W.end,f("Integer"),"to_int"),pe<0&&(pe+=xe.length),we<0?we+=xe.length:we>=xe.length&&(we=xe.length-1,W.excl&&(we+=1));var Le=we-pe;W.excl&&W.end!==c?we-=1:Le+=1,pe<xe.length&&pe>=0&&we<xe.length&&we>=0&&Le>0&&xe.splice(pe,Le)}else{if((De=O(ae,f("Integer"),"to_int"))<0&&(De+=xe.length),De<0||De>=xe.length)return c;y=xe[De],0===De?xe.shift():xe.splice(De,1)}else{if(De=O(ae,f("Integer"),"to_int"),(ue=O(ue,f("Integer"),"to_int"))<0)return c;y=xe["$[]"](De,ue),De<0&&(De+=xe.length),De+ue>xe.length&&(ue=xe.length-De),De<xe.length&&De>=0&&xe.splice(De,ue)}return y},-2),T(C,"$sort",function be(){var ae=be.$$p||c;return be.$$p=null,le(this.length>1)?(ae===c&&(ae=function(xe,y){return xe["$<=>"](y)}),this.slice().sort(function(xe,y){var W=ae(xe,y);return W===c&&Y.$raise(f("ArgumentError"),"comparison of "+xe.$inspect()+" with "+y.$inspect()+" failed"),I(W,0)?1:D(W,0)?-1:0})):this}),T(C,"$sort!",function be(){var xe,ae=be.$$p||c,ue=this;be.$$p=null,K(ue),xe=ae!==c?M(ue.slice(),"sort",[],ae.$to_proc()):ue.slice().$sort(),ue.length=0;for(var y=0,W=xe.length;y<W;y++)ue.push(xe[y]);return ue}),T(C,"$sort_by!",function be(){var ae=be.$$p||c,ue=this;return be.$$p=null,ae===c?M(ue,"enum_for",["sort_by!"],function xe(){return(xe.$$s??this).$size()},{$$s:ue}):(K(ue),ue.$replace(M(ue,"sort_by",[],ae.$to_proc())))}),T(C,"$take",function(ae){return ae<0&&Y.$raise(f("ArgumentError")),this.slice(0,ae)}),T(C,"$take_while",function be(){var ae=be.$$p||c;be.$$p=null;for(var pe,we,xe=[],y=0,W=this.length;y<W;y++){if(!1===(we=ae(pe=this[y]))||we===c)return xe;xe.push(pe)}return xe}),T(C,"$to_a",function(){return this.$$class===E.Array?this:E.Array.$new(this)}),T(C,"$to_ary",fe),T(C,"$to_h",function be(){var ae=be.$$p||c,xe=c;be.$$p=null,xe=this,ae!==c&&(xe=M(xe,"map",[],ae.$to_proc()));var y,pe,W=xe.length,Le=z([],{});for(y=0;y<W;y++)(pe=j["$coerce_to?"](xe[y],f("Array"),"to_ary")).$$is_array||Y.$raise(f("TypeError"),"wrong element type "+pe.$class()+" at "+y+" (expected array)"),2!==pe.length&&Y.$raise(f("ArgumentError"),"wrong array length at "+y+" (expected 2, was "+pe.$length()+")"),_(Le,pe[0],pe[1]);return Le}),T(C,"$transpose",function(){var ue=c,xe=c;return le(this["$empty?"]())?[]:(ue=[],xe=c,M(this,"each",[],function(W){var pe=c;return null==W&&(W=c),W=oe(f("Array"),W)?W.$to_a():O(W,f("Array"),"to_ary").$to_a(),xe=le(pe=xe)?pe:W.length,R(W.length,xe)&&Y.$raise(f("IndexError"),"element size differs ("+W.length+" should be "+xe+")"),M(W.length,"times",[],function(De){var Le;return null==De&&(De=c),(le(pe=ue["$[]"](De))?pe:(M(ue,"[]=",Le=[De,[]]),Le[Le.length-1]))["$<<"](W.$at(De))})}),ue)}),T(C,"$union",function(ae){var ue,y=this;return ue=U(arguments),M(ue,"reduce",[y.$uniq()],function(pe,we){return null==pe&&(pe=c),null==we&&(we=c),pe["$|"](we)})},-1),T(C,"$uniq",function be(){var ae=be.$$p||c;be.$$p=null;var y,W,pe,we,xe=z([],{});if(ae===c)for(y=0,W=this.length;y<W;y++)void 0===J(xe,pe=this[y])&&_(xe,pe,pe);else for(y=0,W=this.length;y<W;y++)we=H(ae,pe=this[y]),void 0===J(xe,we)&&_(xe,we,pe);return xe.$values()}),T(C,"$uniq!",function be(){var ae=be.$$p||c,ue=this;be.$$p=null,K(ue);var W,pe,we,De,xe=ue.length,y=z([],{});for(W=0,pe=xe;W<pe;W++)we=ue[W],De=ae===c?we:H(ae,we),void 0!==J(y,De)?(ue.splice(W,1),pe--,W--):_(y,De,we);return ue.length===xe?c:ue}),T(C,"$unshift",function(ae){var xe,y=this;xe=U(arguments),K(y);var W=y.length,pe=xe.length;if(0==pe)return y;for(var we=W-pe,De=0;De<pe;De++)y.push(y[we+De]);for(var Le=W-1;Le-pe>=0;)y[Le]=y[Le-pe],Le--;for(var Ye=0;Ye<pe;Ye++)y[Ye]=xe[Ye];return y},-1),T(C,"$values_at",function(ae){var ue,y=this,W=c;return ue=U(arguments),W=[],M(ue,"each",[],function pe(we){var De=pe.$$s??this,Le=c,Ye=c,ut=c;return null==we&&(we=c),le(we["$is_a?"](f("Range")))?(Le=we.$end()===c?-1:O(we.$end(),f("Integer"),"to_int"),(Ye=we.$begin()===c?0:O(we.$begin(),f("Integer"),"to_int"))<0?(Ye+=De.length,c):(Le<0&&(Le+=De.length),we["$exclude_end?"]()&&we.$end()!==c&&Le--,Le<Ye?c:M(Ye,"upto",[Le],function Dt(Ot){return null==Ot&&(Ot=c),W["$<<"]((Dt.$$s??this).$at(Ot))},{$$s:De}))):(ut=O(we,f("Integer"),"to_int"),W["$<<"](De.$at(ut)))},{$$s:y}),W},-1),T(C,"$zip",function be(ae){var xe,y,ue=be.$$p||c,W=this,pe=c;be.$$p=null,xe=U(arguments);var Le,Ye,ut,Dt,Ot,we=[],De=W.length;for(Dt=0,Ot=(y=xe).length;Dt<Ot;Dt++)if(!(Ye=y[Dt]).$$is_array){if(Ye.$$is_range||Ye.$$is_enumerator){y[Dt]=Ye.$take(De);continue}y[Dt]=(le(pe=j["$coerce_to?"](Ye,f("Array"),"to_ary"))?pe:j["$coerce_to!"](Ye,f("Enumerator"),"to_enum","each")).$to_a()}for(ut=0;ut<De;ut++){for(Le=[W[ut]],Dt=0,Ot=y.length;Dt<Ot;Dt++)null==(Ye=y[Dt][ut])&&(Ye=c),Le[Dt+1]=Ye;we[ut]=Le}if(ue!==c){for(ut=0;ut<De;ut++)E.yield1(ue,we[ut]);return c}return we},-1),N(C,"$inherited",function(ae){ae.$$prototype.$to_a=function(){return this.slice(0,this.length)}}),T(C,"$instance_variables",function be(){var ae=be.$$p||c;return be.$$p=null,M(q(this,X(this,"instance_variables",be,!1,!0),"instance_variables",[],ae),"reject",[],function(y){var W;return null==y&&(y=c),le(W=/^@\d+$/.test(y))?W:y["$=="]("@length")})}),T(C,"$pack",function(ae){return U(arguments),Y.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),F(C,"append","push"),F(C,"filter","select"),F(C,"filter!","select!"),F(C,"map","collect"),F(C,"map!","collect!"),F(C,"prepend","unshift"),F(C,"size","length"),F(C,"slice","[]"),F(C,"to_s","inspect"),j.$pristine(C.$singleton_class(),"allocate"),j.$pristine(C,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(E){var P,fe,B,te,D,le=E.yield1,me=E.hash,d=E.hash_init,H=E.hash_get,J=E.hash_put,_=E.hash_delete,x=E.deny_frozen_access,O=E.freeze,w=E.klass,K=E.slice,G=E.Opal,A=E.Kernel,U=E.defs,N=E.def,Y=E.send,T=E.rb_ge,j=E.rb_gt,oe=E.hash2,z=E.truthy,q=E.to_a,X=E.return_self,M=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/enumerable"),P=[],te=[B=w("::",null,"Hash")].concat(P),D=E.$r(te),B.$include(S("Enumerable")),B.$$prototype.$$is_hash=!0,U(B,"$[]",function(F){var l,f,p,c=this,u=(l=K(arguments)).length;if(1===u){if((f=G["$coerce_to?"](l["$[]"](0),S("Hash"),"to_hash"))!==L)return c.$allocate()["$merge!"](f);for((l=G["$coerce_to?"](l["$[]"](0),S("Array"),"to_ary"))===L&&A.$raise(S("ArgumentError"),"odd number of arguments for Hash"),u=l.length,f=c.$allocate(),p=0;p<u;p++)if(l[p].$$is_array)switch(l[p].length){case 1:f.$store(l[p][0],L);break;case 2:f.$store(l[p][0],l[p][1]);break;default:A.$raise(S("ArgumentError"),"invalid number of elements ("+l[p].length+" for 1..2)")}return f}for(u%2!=0&&A.$raise(S("ArgumentError"),"odd number of arguments for Hash"),f=c.$allocate(),p=0;p<u;p+=2)f.$store(l[p],l[p+1]);return f},-1),U(B,"$allocate",function(){var g=new this.$$constructor;return d(g),g.$$none=L,g.$$proc=L,g}),U(B,"$try_convert",function(F){return G["$coerce_to?"](F,S("Hash"),"to_hash")}),N(B,"$initialize",function R(F){var g=R.$$p||L,l=this;return R.$$p=null,x(l),void 0!==F&&g!==L&&A.$raise(S("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===F?L:F,l.$$proc=g,l},-1),N(B,"$==",function(F){var g=this;if(g===F)return!0;if(!F.$$is_hash||g.$$keys.length!==F.$$keys.length)return!1;for(var u,p,m,l=0,c=g.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?(p=g.$$smap[u],m=F.$$smap[u]):(p=u.value,m=H(F,u.key)),void 0===m||!p["$eql?"](m))return!1;return!0}),N(B,"$>=",function(F){var l=L;return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),!(this.$$keys.length<F.$$keys.length)&&(l=!0,Y(F,"each",[],function c(f,u){var m;null==f&&(f=L),null==u&&(u=L),null!=(m=(c.$$s??this).$fetch(f,null))&&m===u||(l=!1)},{$$s:this}),l)}),N(B,"$>",function(F){return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),!(this.$$keys.length<=F.$$keys.length)&&T(this,F)}),N(B,"$<",function(F){return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),j(F,this)}),N(B,"$<=",function(F){return F=G["$coerce_to!"](F,S("Hash"),"to_hash"),T(F,this)}),N(B,"$[]",function(F){var l=H(this,F);return void 0!==l?l:this.$default(F)}),N(B,"$[]=",function(F,g){return x(this),J(this,F,g),g}),N(B,"$assoc",function(F){for(var u,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string){if(u["$=="](F))return[u,this.$$smap[u]]}else if(u.key["$=="](F))return[u.key,u.value];return L}),N(B,"$clear",function(){var F=this;return x(F),d(F),F}),N(B,"$clone",function(){var g=new this.$$class;return d(g),E.hash_clone(this,g),g}),N(B,"$compact",function(){for(var u,p,g=me(),l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p!==L&&J(g,u,p);return g}),N(B,"$compact!",function(){var F=this;x(F);for(var u,p,g=!1,l=0,c=F.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=F.$$smap[u]:(p=u.value,u=u.key),p===L&&void 0!==_(F,u)&&(g=!0,f--,l--);return g?F:L}),N(B,"$compare_by_identity",function(){var F=this;x(F);var g,l,c,u,f=F.$$keys;if(F.$$by_identity)return F;if(0===F.$$keys.length)return F.$$by_identity=!0,F;for(u=oe([],{}).$compare_by_identity(),g=0,l=f.length;g<l;g++)(c=f[g]).$$is_string||(c=c.key),J(u,c,H(F,c));return F.$$by_identity=!0,F.$$map=u.$$map,F.$$smap=u.$$smap,F}),N(B,"$compare_by_identity?",function(){return!0===this.$$by_identity}),N(B,"$default",function(F){var g=this;return void 0!==F&&g.$$proc!==L&&void 0!==g.$$proc?g.$$proc.$call(g,F):void 0===g.$$none?L:g.$$none},-1),N(B,"$default=",function(F){var g=this;return x(g),g.$$proc=L,g.$$none=F,F}),N(B,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:L}),N(B,"$default_proc=",function(F){var g=this;x(g);var l=F;return l!==L&&(l=G["$coerce_to!"](l,S("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&A.$raise(S("TypeError"),"default_proc takes two arguments"),g.$$none=L,g.$$proc=l,F}),N(B,"$delete",function R(F){var g=R.$$p||L;R.$$p=null,x(this);var c=_(this,F);return void 0!==c?c:g!==L?E.yield1(g,F):L}),N(B,"$delete_if",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["delete_if"],function C(){return(C.$$s??this).$size()},{$$s:g});x(g);for(var u,p,m,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),!1!==(m=F(u,p))&&m!==L&&void 0!==_(g,u)&&(f--,l--);return g}),N(B,"$dig",function(F,g){var c,f=this,u=L;return c=K(arguments,1),(u=f["$[]"](F))===L||0===c.length?u:(z(u["$respond_to?"]("dig"))||A.$raise(S("TypeError"),u.$class()+" does not have #dig method"),Y(u,"dig",q(c)))},-2),N(B,"$each",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["each"],function m(){return(m.$$s??this).$size()},{$$s:g});for(var u,p,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),le(F,[u,p]);return g}),N(B,"$each_key",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["each_key"],function p(){return(p.$$s??this).$size()},{$$s:g});for(var u,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)F((u=c[l]).$$is_string?u:u.key);return g}),N(B,"$each_value",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["each_value"],function p(){return(p.$$s??this).$size()},{$$s:g});for(var u,l=0,c=g.$$keys.slice(),f=c.length;l<f;l++)F((u=c[l]).$$is_string?g.$$smap[u]:u.value);return g}),N(B,"$empty?",function(){return 0===this.$$keys.length}),N(B,"$except",function(F){var l,c=this;return l=K(arguments),Y(c.$dup(),"except!",q(l))},-1),N(B,"$except!",function(F){var g,c=this;return g=K(arguments),Y(g,"each",[],function f(u){return null==u&&(u=L),(f.$$s??this).$delete(u)},{$$s:c}),c},-1),N(B,"$fetch",function R(F,g){var l=R.$$p||L;R.$$p=null;var f=H(this,F);return void 0!==f?f:l!==L?l(F):void 0!==g?g:A.$raise(S("KeyError").$new("key not found: "+F.$inspect(),oe(["key","receiver"],{key:F,receiver:this})))},-2),N(B,"$fetch_values",function R(F){var l,g=R.$$p||L,f=this;return R.$$p=null,l=K(arguments),Y(l,"map",[],function u(p){return null==p&&(p=L),Y(u.$$s??this,"fetch",[p],g.$to_proc())},{$$s:f})},-1),N(B,"$flatten",function(F){null==F&&(F=1),F=G["$coerce_to!"](F,S("Integer"),"to_int");for(var p,m,l=[],c=0,f=this.$$keys,u=f.length;c<u;c++)if((p=f[c]).$$is_string?m=this.$$smap[p]:(m=p.value,p=p.key),l.push(p),m.$$is_array){if(1===F){l.push(m);continue}l=l.concat(m.$flatten(F-2))}else l.push(m);return l},-1),N(B,"$freeze",function(){var F=this;return z(F["$frozen?"]())?F:O(F)}),N(B,"$has_key?",function(F){return void 0!==H(this,F)}),N(B,"$has_value?",function(F){for(var u,l=0,c=this.$$keys,f=c.length;l<f;l++)if(((u=c[l]).$$is_string?this.$$smap[u]:u.value)["$=="](F))return!0;return!1}),N(B,"$hash",function(){var f,F=this,g=void 0===E.hash_ids,l=F.$object_id(),c=["Hash"];try{if(g&&(E.hash_ids=Object.create(null)),E[l])return"self";for(f in E.hash_ids)if(F["$eql?"](E.hash_ids[f]))return"self";E.hash_ids[l]=F;for(var p=0,m=F.$$keys,C=m.length;p<C;p++)c.push((f=m[p]).$$is_string?[f,F.$$smap[f].$hash()]:[f.key_hash,f.value.$hash()]);return c.sort().join()}finally{g&&(E.hash_ids=void 0)}}),N(B,"$index",function(F){for(var u,p,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p["$=="](F))return u;return L}),N(B,"$indexes",function(F){for(var l,C,c=this,f=[],u=0,p=(l=K(arguments)).length;u<p;u++)void 0!==(C=H(c,l[u]))?f.push(C):f.push(c.$default());return f},-1),N(B,"$inspect",function(){var F=this,g=void 0===fe,l=F.$object_id(),c=[];return function(){try{if(g&&(fe={}),fe.hasOwnProperty(l))return"{...}";fe[l]=!0;for(var m,C,f=0,u=F.$$keys,p=u.length;f<p;f++)(m=u[f]).$$is_string?C=F.$$smap[m]:(C=m.value,m=m.key),m=D("Opal").$inspect(m),C=D("Opal").$inspect(C),c.push(m+"=>"+C);return"{"+c.join(", ")+"}"}finally{g&&(fe=void 0)}}()}),N(B,"$invert",function(){for(var u,p,g=me(),l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),J(g,p,u);return g}),N(B,"$keep_if",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["keep_if"],function C(){return(C.$$s??this).$size()},{$$s:g});x(g);for(var u,p,m,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),(!1===(m=F(u,p))||m===L)&&void 0!==_(g,u)&&(f--,l--);return g}),N(B,"$keys",function(){for(var u,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)g.push((u=c[l]).$$is_string?u:u.key);return g}),N(B,"$length",function(){return this.$$keys.length}),N(B,"$merge",function R(F){var c,g=R.$$p||L,f=this;return R.$$p=null,c=K(arguments),Y(f.$dup(),"merge!",q(c),g.$to_proc())},-1),N(B,"$merge!",function R(F){var c,u,p,m,C,$,re,se,Ee,g=R.$$p||L,f=this;for(R.$$p=null,c=K(arguments),x(f),u=0;u<c.length;++u)if($=(C=(m=G["$coerce_to!"](c[u],S("Hash"),"to_hash")).$$keys).length,g===L)for(p=0;p<$;p++)(re=C[p]).$$is_string?Ee=m.$$smap[re]:(Ee=re.value,re=re.key),J(f,re,Ee);else for(p=0;p<$;p++)(re=C[p]).$$is_string?Ee=m.$$smap[re]:(Ee=re.value,re=re.key),void 0!==(se=H(f,re))?J(f,re,g(re,se,Ee)):J(f,re,Ee);return f},-1),N(B,"$rassoc",function(F){for(var u,p,l=0,c=this.$$keys,f=c.length;l<f;l++)if((u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),p["$=="](F))return[u,p];return L}),N(B,"$rehash",function(){var F=this;return x(F),E.hash_rehash(F),F}),N(B,"$reject",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["reject"],function $(){return($.$$s??this).$size()},{$$s:g});for(var p,m,C,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),(!1===(C=F(p,m))||C===L)&&J(l,p,m);return l}),N(B,"$reject!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["reject!"],function $(){return($.$$s??this).$size()},{$$s:g});x(g);for(var p,m,C,l=!1,c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),!1!==(C=F(p,m))&&C!==L&&void 0!==_(g,p)&&(l=!0,u--,c--);return l?g:L}),N(B,"$replace",function(F){var g=this;x(g),F=G["$coerce_to!"](F,S("Hash"),"to_hash"),d(g);for(var u,m,l=0,c=F.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?m=F.$$smap[u]:(m=u.value,u=u.key),J(g,u,m);return z(F.$default_proc())?g["$default_proc="](F.$default_proc()):g["$default="](F.$default()),g}),N(B,"$select",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["select"],function $(){return($.$$s??this).$size()},{$$s:g});for(var p,m,C,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),!1!==(C=F(p,m))&&C!==L&&J(l,p,m);return l}),N(B,"$select!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["select!"],function $(){return($.$$s??this).$size()},{$$s:g});x(g);for(var p,m,C,l=L,c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),(!1===(C=F(p,m))||C===L)&&(void 0!==_(g,p)&&(u--,c--),l=g);return l}),N(B,"$shift",function(){var F=this;x(F);var l,g=F.$$keys;return g.length>0?[l=(l=g[0]).$$is_string?l:l.key,_(F,l)]:L}),N(B,"$slice",function(F){var l,c=this;l=K(arguments);for(var f=me(),u=0,p=l.length;u<p;u++){var m=l[u],C=H(c,m);void 0!==C&&J(f,m,C)}return f},-1),N(B,"$to_a",function(){for(var u,p,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=this.$$smap[u]:(p=u.value,u=u.key),g.push([u,p]);return g}),N(B,"$to_h",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,F!==L)return Y(g,"map",[],F.$to_proc()).$to_h();if(g.$$class===E.Hash)return g;var l=new E.Hash;return d(l),E.hash_clone(g,l),l}),N(B,"$to_hash",X),N(B,"$to_proc",function(){return Y(this,"proc",[],function g(l){var c=g.$$s??this;return null==l&&A.$raise(S("ArgumentError"),"no key given"),c["$[]"](l)},{$$arity:-1,$$s:this})}),N(B,"$transform_keys",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_keys"],function C(){return(C.$$s??this).$size()},{$$s:g});for(var p,m,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),p=le(F,p),J(l,p,m);return l}),N(B,"$transform_keys!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_keys!"],function C(){return(C.$$s??this).$size()},{$$s:g});x(g);var c,u,p,m,l=E.slice(g.$$keys),f=l.length;for(c=0;c<f;c++)(u=l[c]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),m=le(F,u),_(g,u),J(g,m,p);return g}),N(B,"$transform_values",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_values"],function C(){return(C.$$s??this).$size()},{$$s:g});for(var p,m,l=me(),c=0,f=g.$$keys,u=f.length;c<u;c++)(p=f[c]).$$is_string?m=g.$$smap[p]:(m=p.value,p=p.key),m=le(F,m),J(l,p,m);return l}),N(B,"$transform_values!",function R(){var F=R.$$p||L,g=this;if(R.$$p=null,!z(F))return Y(g,"enum_for",["transform_values!"],function m(){return(m.$$s??this).$size()},{$$s:g});x(g);for(var u,p,l=0,c=g.$$keys,f=c.length;l<f;l++)(u=c[l]).$$is_string?p=g.$$smap[u]:(p=u.value,u=u.key),p=le(F,p),J(g,u,p);return g}),N(B,"$values",function(){for(var u,g=[],l=0,c=this.$$keys,f=c.length;l<f;l++)g.push((u=c[l]).$$is_string?this.$$smap[u]:u.value);return g}),M(B,"dup","clone"),M(B,"each_pair","each"),M(B,"eql?","=="),M(B,"filter","select"),M(B,"filter!","select!"),M(B,"include?","has_key?"),M(B,"indices","indexes"),M(B,"key","index"),M(B,"key?","has_key?"),M(B,"member?","has_key?"),M(B,"size","length"),M(B,"store","[]="),M(B,"to_s","inspect"),M(B,"update","merge!"),M(B,"value?","has_value?"),M(B,"values_at","indexes")},Opal.modules["corelib/number"]=function(E){var B,te,R,g,l,D,fe,le=E.klass,me=E.Opal,d=E.Kernel,H=E.def,J=E.eqeqeq,_=E.truthy,x=E.rb_gt,O=E.not,w=E.rb_lt,K=E.alias,G=E.send2,A=E.find_super,U=E.send,N=E.rb_plus,Y=E.rb_minus,T=E.eqeq,j=E.return_self,oe=E.rb_divide,z=E.to_ary,q=E.rb_times,X=E.rb_le,M=E.rb_ge,I=E.return_val,Q=E.const_set,S=[],k=E.nil,v=E.$$$;return E.top.$require("corelib/numeric"),function(P,B,te){var f,D=le("::",B,"Number");function F(f){var u=new Uint8Array(8);return new DataView(u.buffer).setFloat64(0,f,!0),u}function g(f){return new DataView(f.buffer).getFloat64(0,!0)}function l(f){for(var u=F(f),p=0;p<u.length;p++){if(255!==u[p]){u[p]++;break}u[p]=0}return g(u)}function c(f){for(var u=F(f),p=0;p<u.length;p++){if(0!==u[p]){u[p]--;break}u[p]=255}return g(u)}[D].concat(te),me.$bridge(Number,D),E.prop(D.$$prototype,"$$is_number",!0),D.$$is_number_class=!0,f=E.get_singleton_class(D),H(f,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),E.udef(f,"$new"),H(D,"$coerce",function(u){var p=this;if(u===k)d.$raise(v("TypeError"),"can't convert "+u.$class()+" into Float");else{if(u.$$is_string)return[d.$Float(u),p];if(u["$respond_to?"]("to_f"))return[me["$coerce_to!"](u,v("Float"),"to_f"),p];if(u.$$is_number)return[u,p];d.$raise(v("TypeError"),"can't convert "+u.$class()+" into Float")}}),H(D,"$__id__",function(){return 2*this+1}),H(D,"$+",function(u){return u.$$is_number?this+u:this.$__coerced__("+",u)}),H(D,"$-",function(u){return u.$$is_number?this-u:this.$__coerced__("-",u)}),H(D,"$*",function(u){return u.$$is_number?this*u:this.$__coerced__("*",u)}),H(D,"$/",function(u){return u.$$is_number?this/u:this.$__coerced__("/",u)}),H(D,"$%",function(u){var p=this;return u.$$is_number?u==-1/0?u:0!=u?u<0||p<0?(p%u+u)%u:p%u:void d.$raise(v("ZeroDivisionError"),"divided by 0"):p.$__coerced__("%",u)}),H(D,"$&",function(u){return u.$$is_number?this&u:this.$__coerced__("&",u)}),H(D,"$|",function(u){return u.$$is_number?this|u:this.$__coerced__("|",u)}),H(D,"$^",function(u){return u.$$is_number?this^u:this.$__coerced__("^",u)}),H(D,"$<",function(u){return u.$$is_number?this<u:this.$__coerced__("<",u)}),H(D,"$<=",function(u){return u.$$is_number?this<=u:this.$__coerced__("<=",u)}),H(D,"$>",function(u){return u.$$is_number?this>u:this.$__coerced__(">",u)}),H(D,"$>=",function(u){return u.$$is_number?this>=u:this.$__coerced__(">=",u)}),H(D,"$<=>",function(u){try{return function(f,u){return u.$$is_number?isNaN(f)||isNaN(u)?k:f>u?1:f<u?-1:0:f.$__coerced__("<=>",u)}(this,u)}catch(m){if(!E.rescue(m,[v("ArgumentError")]))throw m;try{return k}finally{E.pop_exception()}}}),H(D,"$<<",function(u){return(u=me["$coerce_to!"](u,v("Integer"),"to_int"))>0?this<<u:this>>-u}),H(D,"$>>",function(u){return(u=me["$coerce_to!"](u,v("Integer"),"to_int"))>0?this>>u:this<<-u}),H(D,"$[]",function(u){return(u=me["$coerce_to!"](u,v("Integer"),"to_int"))<0?0:u>=32?this<0?1:0:this>>u&1}),H(D,"$+@",function(){return+this}),H(D,"$-@",function(){return-this}),H(D,"$~",function(){return~this}),H(D,"$**",function(u){var p=this;return J(v("Integer"),u)?O(v("Integer")["$==="](p))||_(x(u,0))?Math.pow(p,u):v("Rational").$new(p,1)["$**"](u):w(p,0)&&(J(v("Float"),u)||J(v("Rational"),u))?v("Complex").$new(p,0)["$**"](u.$to_f()):_(null!=u.$$is_number)?Math.pow(p,u):p.$__coerced__("**",u)}),H(D,"$==",function(u){return u.$$is_number?this.valueOf()===u.valueOf():!!u["$respond_to?"]("==")&&u["$=="](this)}),K(D,"===","=="),H(D,"$abs",function(){return Math.abs(this)}),H(D,"$abs2",function(){return Math.abs(this*this)}),H(D,"$allbits?",function(u){return(this&(u=me["$coerce_to!"](u,v("Integer"),"to_int")))==u}),H(D,"$anybits?",function(u){return 0!=(this&me["$coerce_to!"](u,v("Integer"),"to_int"))}),H(D,"$angle",function(){var u=this;return _(u["$nan?"]())?u:0==u?1/u>0?0:Math.PI:u<0?Math.PI:0}),H(D,"$bit_length",function(){var u=this;if(J(v("Integer"),u)||d.$raise(v("NoMethodError").$new("undefined method `bit_length` for "+u+":Float","bit_length")),0===u||-1===u)return 0;for(var p=0,m=u<0?~u:u;0!=m;)p+=1,m>>>=1;return p}),H(D,"$ceil",function(u){null==u&&(u=0);var m=this.$to_f();if(m%1==0&&u>=0)return m;var C=Math.pow(10,u),$=Math.ceil(m*C)/C;return m%1==0&&($=Math.round($)),$},-1),H(D,"$chr",function(u){return E.enc(String.fromCharCode(this),u||"BINARY")},-1),H(D,"$denominator",function f(){var u=f.$$p||k,p=this;return f.$$p=null,_(p["$nan?"]())||_(p["$infinite?"]())?1:G(p,A(p,"denominator",f,!1,!0),"denominator",[],u)}),H(D,"$downto",function f(u){var p=f.$$p||k,m=this;if(f.$$p=null,p===k)return U(m,"enum_for",["downto",u],function $(){var re=$.$$s??this;return J(v("Numeric"),u)||d.$raise(v("ArgumentError"),"comparison of "+re.$class()+" with "+u.$class()+" failed"),_(x(u,re))?0:N(Y(re,u),1)},{$$s:m});u.$$is_number||d.$raise(v("ArgumentError"),"comparison of "+m.$class()+" with "+u.$class()+" failed");for(var C=m;C>=u;C--)p(C);return m}),H(D,"$equal?",function(u){var m;return _(m=this["$=="](u))?m:isNaN(this)&&isNaN(u)}),H(D,"$even?",function(){return this%2==0}),H(D,"$floor",function(u){null==u&&(u=0);var m=this.$to_f();if(m%1==0&&u>=0)return m;var C=Math.pow(10,u),$=Math.floor(m*C)/C;return m%1==0&&($=Math.round($)),$},-1),H(D,"$gcd",function(u){J(v("Integer"),u)||d.$raise(v("TypeError"),"not an integer");for(var m=Math.abs(this),C=Math.abs(u);m>0;){var $=m;m=C%m,C=$}return C}),H(D,"$gcdlcm",function(u){return[this.$gcd(u),this.$lcm(u)]}),H(D,"$integer?",function(){return this%1==0}),H(D,"$is_a?",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,!!(T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Float"))&&J(v("Float"),m))||G(m,A(m,"is_a?",f,!1,!0),"is_a?",[u],p)}),H(D,"$instance_of?",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,!!(T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Integer"))&&J(v("Integer"),m)||T(u,v("Float"))&&J(v("Float"),m))||G(m,A(m,"instance_of?",f,!1,!0),"instance_of?",[u],p)}),H(D,"$lcm",function(u){var p=this;return J(v("Integer"),u)||d.$raise(v("TypeError"),"not an integer"),0==p||0==u?0:Math.abs(p*u/p.$gcd(u))}),H(D,"$next",function(){return this+1}),H(D,"$nobits?",function(u){return 0==(this&me["$coerce_to!"](u,v("Integer"),"to_int"))}),H(D,"$nonzero?",function(){return 0==this?k:this}),H(D,"$numerator",function f(){var u=f.$$p||k,p=this;return f.$$p=null,_(p["$nan?"]())||_(p["$infinite?"]())?p:G(p,A(p,"numerator",f,!1,!0),"numerator",[],u)}),H(D,"$odd?",function(){return this%2!=0}),H(D,"$ord",j),H(D,"$pow",function(u,p){var m=this;return 0==m&&d.$raise(v("ZeroDivisionError"),"divided by 0"),void 0===p?m["$**"](u):(v("Integer")["$==="](u)||d.$raise(v("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),u<0&&d.$raise(v("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),v("Integer")["$==="](p)||d.$raise(v("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===p&&d.$raise(v("ZeroDivisionError"),"divided by 0"),m["$**"](u)["$%"](p))},-2),H(D,"$pred",function(){return this-1}),H(D,"$quo",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,J(v("Integer"),m)?G(m,A(m,"quo",f,!1,!0),"quo",[u],p):oe(m,u)}),H(D,"$rationalize",function(u){var p,m,C=this,$=k,re=k;return arguments.length>1&&d.$raise(v("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),J(v("Integer"),C)?v("Rational").$new(C,1):_(C["$infinite?"]())?d.$raise(v("FloatDomainError"),"Infinity"):_(C["$nan?"]())?d.$raise(v("FloatDomainError"),"NaN"):_(null==u)?(m=v("Math").$frexp(C),$=(p=z(m))[0]??k,re=p[1]??k,$=v("Math").$ldexp($,v(v("Float"),"MANT_DIG")).$to_i(),re=Y(re,v(v("Float"),"MANT_DIG")),v("Rational").$new(q(2,$),1["$<<"](Y(1,re))).$rationalize(v("Rational").$new(1,1["$<<"](Y(1,re))))):C.$to_r().$rationalize(u)},-1),H(D,"$remainder",function(u){return Y(this,q(u,oe(this,u).$truncate()))}),H(D,"$round",function(u){var m,re,C=this;if(J(v("Integer"),C)){if(_(null==u)||(J(v("Float"),u)&&_(u["$infinite?"]())&&d.$raise(v("RangeError"),"Infinity"),u=me["$coerce_to!"](u,v("Integer"),"to_int"),_(w(u,v(v("Integer"),"MIN")))&&d.$raise(v("RangeError"),"out of bounds"),_(u>=0)))return C;if(.415241*(u=u["$-@"]())-.125>C.$size())return 0;var se=Math.pow(10,u),Ee=Math.floor((Math.abs(C)+se/2)/se)*se;return C<0?-Ee:Ee}if(_(C["$nan?"]())&&_(null==u)&&d.$raise(v("FloatDomainError"),"NaN"),u=me["$coerce_to!"](u||0,v("Integer"),"to_int"),_(X(u,0)))_(C["$nan?"]())?d.$raise(v("RangeError"),"NaN"):_(C["$infinite?"]())&&d.$raise(v("FloatDomainError"),"Infinity");else{if(T(u,0))return Math.round(C);if(_(C["$nan?"]())||_(C["$infinite?"]()))return C}return m=v("Math").$frexp(C),re=z(m)[1]??k,_(M(u,Y(N(v(v("Float"),"DIG"),2),_(x(re,0))?oe(re,4):Y(oe(re,3),1))))?C:_(w(u,(_(x(re,0))?N(oe(re,3),1):oe(re,4))["$-@"]()))?0:Math.round(C*Math.pow(10,u))/Math.pow(10,u)},-1),H(D,"$times",function f(){var u=f.$$p||k,p=this;if(f.$$p=null,!_(u))return U(p,"enum_for",["times"],function C(){return C.$$s??this},{$$s:p});for(var m=0;m<p;m++)u(m);return p}),H(D,"$to_f",j),H(D,"$to_i",function(){var u=this;return u<0?Math.ceil(u):Math.floor(u)}),H(D,"$to_r",function(){var u,p,m=this,C=k,$=k;return J(v("Integer"),m)?v("Rational").$new(m,1):(p=v("Math").$frexp(m),C=(u=z(p))[0]??k,$=u[1]??k,C=v("Math").$ldexp(C,v(v("Float"),"MANT_DIG")).$to_i(),$=Y($,v(v("Float"),"MANT_DIG")),q(C,v(v("Float"),"RADIX")["$**"]($)).$to_r())}),H(D,"$to_s",function(u){var p=this;return null==u&&(u=10),u=me["$coerce_to!"](u,v("Integer"),"to_int"),(_(w(u,2))||_(x(u,36)))&&d.$raise(v("ArgumentError"),"invalid radix "+u),T(p,0)&&_(1/p==-1/0)?"-0.0":p.toString(u)},-1),H(D,"$truncate",function(u){null==u&&(u=0);var m=this.$to_f();if(m%1==0&&u>=0)return m;var C=Math.pow(10,u),$=parseInt(m*C,10)/C;return m%1==0&&($=Math.round($)),$},-1),H(D,"$digits",function(u){var p=this;null==u&&(u=10),w(p,0)&&d.$raise(v(v("Math"),"DomainError"),"out of domain"),u=me["$coerce_to!"](u,v("Integer"),"to_int"),_(w(u,2))&&d.$raise(v("ArgumentError"),"invalid radix "+u),p!=parseInt(p)&&d.$raise(v("NoMethodError"),"undefined method `digits' for "+p.$inspect());var m=p,C=[];if(0==p)return[0];for(;0!=m;)C.push(m%u),m=parseInt(m/u,10);return C},-1),H(D,"$divmod",function f(u){var p=f.$$p||k,m=this;return f.$$p=null,_(m["$nan?"]())||_(u["$nan?"]())?d.$raise(v("FloatDomainError"),"NaN"):_(m["$infinite?"]())?d.$raise(v("FloatDomainError"),"Infinity"):G(m,A(m,"divmod",f,!1,!0),"divmod",[u],p)}),H(D,"$upto",function f(u){var p=f.$$p||k,m=this;if(f.$$p=null,p===k)return U(m,"enum_for",["upto",u],function $(){var re=$.$$s??this;return J(v("Numeric"),u)||d.$raise(v("ArgumentError"),"comparison of "+re.$class()+" with "+u.$class()+" failed"),_(w(u,re))?0:N(Y(u,re),1)},{$$s:m});u.$$is_number||d.$raise(v("ArgumentError"),"comparison of "+m.$class()+" with "+u.$class()+" failed");for(var C=m;C<=u;C++)p(C);return m}),H(D,"$zero?",function(){return 0==this}),H(D,"$size",I(4)),H(D,"$nan?",function(){return isNaN(this)}),H(D,"$finite?",function(){var u=this;return u!=1/0&&u!=-1/0&&!isNaN(u)}),H(D,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:k}),H(D,"$positive?",function(){var u=this;return 0!=u&&(u==1/0||1/u>0)}),H(D,"$negative?",function(){return this==-1/0||1/this<0}),H(D,"$next_float",function(){var u=this;return T(u,v(v("Float"),"INFINITY"))?v(v("Float"),"INFINITY"):_(u["$nan?"]())?v(v("Float"),"NAN"):M(u,0)?l(Math.abs(u)):c(u)}),H(D,"$prev_float",function(){var u=this;return T(u,v(v("Float"),"INFINITY")["$-@"]())?v(v("Float"),"INFINITY")["$-@"]():_(u["$nan?"]())?v(v("Float"),"NAN"):x(u,0)?c(u):-l(Math.abs(u))}),K(D,"arg","angle"),K(D,"eql?","=="),K(D,"fdiv","/"),K(D,"inspect","to_s"),K(D,"kind_of?","is_a?"),K(D,"magnitude","abs"),K(D,"modulo","%"),K(D,"object_id","__id__"),K(D,"phase","angle"),K(D,"succ","next"),K(D,"to_int","to_i")}(0,v("Numeric"),S),Q("::","Fixnum",v("Number")),B=v("Numeric"),te=S,fe=[D=le("::",B,"Integer")].concat(te),D.$$is_number_class=!0,D.$$is_integer_class=!0,g=[R=E.get_singleton_class(D)].concat(fe),l=E.$r(g),H(R,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),E.udef(R,"$new"),H(R,"$sqrt",function(f){return(f=me["$coerce_to!"](f,v("Integer"),"to_int"))<0&&d.$raise(v(v("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(f),10)}),H(R,"$try_convert",function(f){return l("Opal")["$coerce_to?"](f,this,"to_int")}),Q(D,"MAX",Math.pow(2,30)-1),Q(D,"MIN",-Math.pow(2,30)),function(P,B,te){var D=le("::",B,"Float");return[D].concat(te),D.$$is_number_class=!0,function(R,F){H(R,"$allocate",function(){return d.$raise(v("TypeError"),"allocator undefined for "+this.$name())}),E.udef(R,"$new"),H(R,"$===",function(l){return!!l.$$is_number})}(E.get_singleton_class(D)),Q(D,"INFINITY",1/0),Q(D,"MAX",Number.MAX_VALUE),Q(D,"MIN",Number.MIN_VALUE),Q(D,"NAN",NaN),Q(D,"DIG",15),Q(D,"MANT_DIG",53),Q(D,"RADIX",2),Q(D,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,v("Numeric"),S)},Opal.modules["corelib/range"]=function(E){var le=E.klass,me=E.truthy,d=E.Kernel,H=E.def,J=E.not,_=E.send2,x=E.find_super,O=E.rb_lt,w=E.rb_le,K=E.send,G=E.eqeq,A=E.eqeqeq,U=E.return_ivar,N=E.rb_gt,Y=E.rb_minus,T=E.Opal,j=E.rb_divide,oe=E.rb_plus,z=E.rb_times,q=E.rb_ge,X=E.thrower,M=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/enumerable"),function(k,v,P){var B=le("::",null,"Range"),te=[B].concat([]),D=E.$r(te),fe=B.$$prototype;function R(F){return F.begin===L||F.end===L||F.begin===-1/0||F.end===1/0||F.begin===1/0||F.end===-1/0}return fe.begin=fe.end=fe.excl=L,B.$include(S("Enumerable")),B.$$prototype.$$is_range=!0,B.$attr_reader("begin","end"),H(B,"$initialize",function(g,l,c){var f=this;return null==c&&(c=!1),me(f.begin)&&d.$raise(S("NameError"),"'initialize' called twice"),me(g["$<=>"](l))||me(g["$nil?"]())||me(l["$nil?"]())||d.$raise(S("ArgumentError"),"bad value for range"),f.begin=g,f.end=l,f.excl=c},-3),H(B,"$===",function(g){return this["$include?"](g)}),H(B,"$count",function F(){var g=F.$$p||L,l=this;return F.$$p=null,J(g!==L)&&me(R(l))?S(S("Float"),"INFINITY"):_(l,x(l,"count",F,!1,!0),"count",[],g)}),H(B,"$to_a",function F(){var g=F.$$p||L,l=this;return F.$$p=null,me(R(l))&&d.$raise(S("TypeError"),"cannot convert endless range to an array"),_(l,x(l,"to_a",F,!1,!0),"to_a",[],g)}),H(B,"$cover?",function(g){var c,m,l=this,f=L,u=L,p=L;return c=me(f=me(u=me(p=l.begin["$nil?"]())?-1:p)?u:l.begin["$<=>"](g))&&f,m=me(f=me(u=me(p=l.end["$nil?"]())?-1:p)?u:g["$<=>"](l.end))&&f,me(f=me(u=me(l.excl)?me(p=m)?O(m,0):p:me(p=m)?w(m,0):p)?c:u)?w(c,0):f}),H(B,"$each",function F(){var f,p,m,g=F.$$p||L,l=this,c=L,u=L;if(F.$$p=null,g===L)return K(l,"enum_for",["each"],function C(){return(C.$$s??this).$size()},{$$s:l});if(l.begin.$$is_number&&l.end.$$is_number){for((l.begin%1!=0||l.end%1!=0)&&d.$raise(S("TypeError"),"can't iterate from Float"),p=l.begin,m=l.end+(me(l.excl)?0:1);p<m;p++)g(p);return l}if(l.begin.$$is_string&&l.end.$$is_string)return K(l.begin,"upto",[l.end,l.excl],g.$to_proc()),l;for(f=l.end,me((c=l.begin)["$respond_to?"]("succ"))||d.$raise(S("TypeError"),"can't iterate from "+c.$class());me(me(u=l.end["$nil?"]())?u:O(c["$<=>"](f),0));)E.yield1(g,c),c=c.$succ();return J(l.excl)&&G(c,f)&&E.yield1(g,c),l}),H(B,"$eql?",function(g){var l=this,c=L,f=L;return!!A(S("Range"),g)&&(me(c=me(f=l.excl["$==="](g["$exclude_end?"]()))?l.begin["$eql?"](g.$begin()):f)?l.end["$eql?"](g.$end()):c)}),H(B,"$exclude_end?",U("excl")),H(B,"$first",function F(g){var l=F.$$p||L,c=this;return F.$$p=null,me(c.begin["$nil?"]())&&d.$raise(S("RangeError"),"cannot get the minimum of beginless range"),me(null==g)?c.begin:_(c,x(c,"first",F,!1,!0),"first",[g],l)},-1),H(B,"$last",function(g){var l=this;return me(l.end["$nil?"]())&&d.$raise(S("RangeError"),"cannot get the maximum of endless range"),me(null==g)?l.end:l.$to_a().$last(g)},-1),H(B,"$max",function F(){var g=F.$$p||L,l=this;return F.$$p=null,me(l.end["$nil?"]())?d.$raise(S("RangeError"),"cannot get the maximum of endless range"):g!==L?_(l,x(l,"max",F,!1,!0),"max",[],g):J(l.begin["$nil?"]())&&(me(N(l.begin,l.end))||me(l.excl)&&G(l.begin,l.end))?L:l.excl?l.end-1:l.end}),H(B,"$min",function F(){var g=F.$$p||L,l=this;return F.$$p=null,me(l.begin["$nil?"]())?d.$raise(S("RangeError"),"cannot get the minimum of beginless range"):g!==L?_(l,x(l,"min",F,!1,!0),"min",[],g):J(l.end["$nil?"]())&&(me(N(l.begin,l.end))||me(l.excl)&&G(l.begin,l.end))?L:l.begin}),H(B,"$size",function(){var g=this,l=L,c=L,f=L;return l=S(S("Float"),"INFINITY"),G(g.begin,l)&&J(g.end["$nil?"]())||G(g.end,l["$-@"]())&&J(g.begin["$nil?"]())?0:me(R(g))?l:A(S("Numeric"),g.begin)&&A(S("Numeric"),g.end)?(c=g.begin,f=g.end,me(g.excl)&&(f=Y(f,1)),me(O(f,c))?0:(Math.abs(f-c)+1).$to_i()):L}),H(B,"$step",function F(g){var l=F.$$p||L,c=this,f=L,u=L;function p(){null==g?g=1:g.$$is_number||(g=T["$coerce_to!"](g,S("Integer"),"to_int")),g<0?d.$raise(S("ArgumentError"),"step can't be negative"):0===g&&d.$raise(S("ArgumentError"),"step can't be 0")}return F.$$p=null,l===L?(me(c.begin["$is_a?"](D("Numeric")))||me(c.begin["$nil?"]()))&&(me(c.end["$is_a?"](D("Numeric")))||me(c.end["$nil?"]()))&&J(me(f=c.begin["$nil?"]())?c.end["$nil?"]():f)?S(S("Enumerator"),"ArithmeticSequence").$new(c,g,"step"):K(c,"enum_for",["step",g],function(){return p(),function m(){if(!c.begin["$respond_to?"]("succ")||c.begin.$$is_string&&c.end.$$is_string)return L;if(g%1==0)return j(c.$size(),g).$ceil();var Me,C=c.begin,$=c.end,re=Math.abs,se=Math.floor,Ee=(re(C)+re($)+re($-C))/re(g)*S(S("Float"),"EPSILON");return Ee>.5&&(Ee=.5),c.excl?(Me=se(($-C)/g-Ee))*g+C<$&&Me++:Me=se(($-C)/g+Ee)+1,Me}()}):(p(),me(c.begin.$$is_number&&c.end.$$is_number)?(u=0,function(){try{var C=X("break");K(c,"loop",[],function $(){var se,re=$.$$s??this;return null==re.begin&&(re.begin=L),null==re.excl&&(re.excl=L),null==re.end&&(re.end=L),se=oe(re.begin,z(u,g)),me(re.excl)?me(q(se,re.end))&&C.$throw():me(N(se,re.end))&&C.$throw(),E.yield1(l,se),u=oe(u,1)},{$$s:c})}catch($){if($===C)return $.$v;throw $}}()):(c.begin.$$is_string&&c.end.$$is_string&&g%1!=0&&d.$raise(S("TypeError"),"no implicit conversion to float from string"),K(c,"each_with_index",[],function($,re){return null==$&&($=L),null==re&&(re=L),G(re["$%"](g),0)?E.yield1(l,$):L})),c)},-1),H(B,"$%",function(g){var l=this;return me(l.begin["$is_a?"](D("Numeric")))&&me(l.end["$is_a?"](D("Numeric")))?S(S("Enumerator"),"ArithmeticSequence").$new(l,g,"%"):l.$step(g)}),H(B,"$bsearch",function F(){var g=F.$$p||L,l=this;return F.$$p=null,g===L?l.$enum_for("bsearch"):(me(R(l)&&(l.begin.$$is_number||l.end.$$is_number))&&d.$raise(S("NotImplementedError"),"Can't #bsearch an infinite range"),me(l.begin.$$is_number&&l.end.$$is_number)||d.$raise(S("TypeError"),"can't do binary search for "+l.begin.$class()),K(l.$to_a(),"bsearch",[],g.$to_proc()))}),H(B,"$to_s",function(){var g=this,l=L;return(me(l=g.begin)?l:"")+(me(g.excl)?"...":"..")+(me(l=g.end)?l:"")}),H(B,"$inspect",function(){var g=this,l=L;return(me(l=g.begin)?g.begin.$inspect():l)+(me(g.excl)?"...":"..")+(me(l=g.end)?g.end.$inspect():l)}),H(B,"$marshal_load",function(g){var l=this;return l.begin=g["$[]"]("begin"),l.end=g["$[]"]("end"),l.excl=g["$[]"]("excl")}),H(B,"$hash",function(){var g=this;return[g.begin,g.end,g.excl].$hash()}),M(B,"==","eql?"),M(B,"include?","cover?"),M(B,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(E){var j,le=E.slice,d=E.truthy,H=E.Kernel,J=E.defs,_=E.def,x=E.send,O=E.to_a,w=E.return_self,K=E.ensure_kwargs,G=E.Opal,A=E.alias,U=E.nil,N=E.$$$;return j=(0,E.klass)("::",Function,"Proc"),E.prop(j.$$prototype,"$$is_proc",!0),E.prop(j.$$prototype,"$$is_lambda",!1),J(j,"$new",function oe(){var z=oe.$$p||U;return oe.$$p=null,d(z)||H.$raise(N("ArgumentError"),"tried to create a Proc object without a block"),z}),_(j,"$call",function oe(z){var M,q=oe.$$p||U,I=this;oe.$$p=null,M=le(arguments),q!==U&&(I.$$p=q);var Q,L=I.$$brk,S=I.$$ret;if(L||S&&I.$$is_lambda)try{Q=I.$$is_lambda?I.apply(null,M):E.yieldX(I,M)}catch(k){if(k===L)return k.$v;if(I.$$is_lambda&&k===S)return k.$v;throw k}else Q=I.$$is_lambda?I.apply(null,M):E.yieldX(I,M);return Q},-1),_(j,"$>>",function oe(z){return oe.$$p=null,x(H,"proc",[],function M(I){var L,Q=M.$$p||U,k=M.$$s??this,v=U;return M.$$p=null,L=le(arguments),v=x(k,"call",O(L),Q.$to_proc()),z.$call(v)},{$$arity:-1,$$s:this})}),_(j,"$<<",function oe(z){return oe.$$p=null,x(H,"proc",[],function M(I){var L,Q=M.$$p||U,k=M.$$s??this,v=U;return M.$$p=null,L=le(arguments),v=x(z,"call",O(L),Q.$to_proc()),k.$call(v)},{$$arity:-1,$$s:this})}),_(j,"$to_proc",w),_(j,"$lambda?",function(){return!!this.$$is_lambda}),_(j,"$arity",function(){var z=this;return z.$$is_curried?-1:null!=z.$$arity?z.$$arity:z.length}),_(j,"$source_location",function(){var q=U;return this.$$is_curried?U:d(q=this.$$source_location)?q:U}),_(j,"$binding",function(){var q=this;return q.$$is_curried&&H.$raise(N("ArgumentError"),"Can't create Binding"),d(N("::","Binding","skip_raise")?"constant":U)?N("Binding").$new(U,[],q.$$s,q.$source_location()):U}),_(j,"$parameters",function(z){var X=this;if(z=K(z),X.$$is_curried)return[["rest"]];if(X.$$parameters){if(z.$$smap.lambda??X.$$is_lambda)return X.$$parameters;var I,Q,M=[];for(I=0,Q=X.$$parameters.length;I<Q;I++){var L=X.$$parameters[I];"req"===L[0]&&(L=["opt",L[1]]),M.push(L)}return M}return[]},-1),_(j,"$curry",function(z){var q=this;function X(){var Q,M=le(arguments),I=M.length;return I>z&&q.$$is_lambda&&!q.$$is_curried&&H.$raise(N("ArgumentError"),"wrong number of arguments ("+I+" for "+z+")"),I>=z?q.$call.apply(q,M):(Q=function(){return X.apply(null,M.concat(le(arguments)))},Q.$$is_lambda=q.$$is_lambda,Q.$$is_curried=!0,Q)}return void 0===z?z=q.length:(z=G["$coerce_to!"](z,N("Integer"),"to_int"),q.$$is_lambda&&z!==q.length&&H.$raise(N("ArgumentError"),"wrong number of arguments ("+z+" for "+q.length+")")),X.$$is_lambda=q.$$is_lambda,X.$$is_curried=!0,X},-1),_(j,"$dup",function(){var z=this,q=z.$$original_proc||z,X=function(){return q.apply(this,arguments)};for(var M in z)z.hasOwnProperty(M)&&(X[M]=z[M]);return X}),A(j,"===","call"),A(j,"clone","dup"),A(j,"yield","call"),A(j,"[]","call")},Opal.modules["corelib/method"]=function(E){var U,N,le=E.klass,me=E.def,d=E.truthy,H=E.slice,J=E.alias,_=E.Kernel,x=E.send,O=E.to_a,w=E.nil,K=E.$$$;return(N=(U=le("::",null,"Method")).$$prototype).method=N.receiver=N.owner=N.name=w,U.$attr_reader("owner","receiver","name"),me(U,"$initialize",function(T,j,oe,z){var q=this;return q.receiver=T,q.owner=j,q.name=z,q.method=oe}),me(U,"$arity",function(){return this.method.$arity()}),me(U,"$parameters",function(){return this.method.$$parameters}),me(U,"$source_location",function(){var j;return d(j=this.method.$$source_location)?j:["(eval)",0]}),me(U,"$comments",function(){var j;return d(j=this.method.$$comments)?j:[]}),me(U,"$call",function Y(T){var z,j=Y.$$p||w,q=this;return Y.$$p=null,z=H(arguments),q.method.$$p=j,q.method.apply(q.receiver,z)},-1),me(U,"$curry",function(T){return this.method.$curry(T)},-1),me(U,"$>>",function(T){return this.method["$>>"](T)}),me(U,"$<<",function(T){return this.method["$<<"](T)}),me(U,"$unbind",function(){var T=this;return K("UnboundMethod").$new(T.receiver.$class(),T.owner,T.method,T.name)}),me(U,"$to_proc",function(){var T=this,j=T.$call.bind(T);return j.$$unbound=T.method,j.$$is_lambda=!0,j.$$arity=T.method.$$arity??T.method.length,j.$$parameters=T.method.$$parameters,j}),me(U,"$inspect",function(){var T=this;return"#<"+T.$class()+": "+T.receiver.$class()+"#"+T.name+" (defined in "+T.owner+" in "+T.$source_location().$join(":")+")>"}),J(U,"[]","call"),J(U,"===","call"),function(G,A){var U=le("::",null,"UnboundMethod"),N=U.$$prototype;return N.method=N.owner=N.name=N.source=w,U.$attr_reader("source","owner","name"),me(U,"$initialize",function(T,j,oe,z){var q=this;return q.source=T,q.owner=j,q.method=oe,q.name=z}),me(U,"$arity",function(){return this.method.$arity()}),me(U,"$parameters",function(){return this.method.$$parameters}),me(U,"$source_location",function(){var j;return d(j=this.method.$$source_location)?j:["(eval)",0]}),me(U,"$comments",function(){var j;return d(j=this.method.$$comments)?j:[]}),me(U,"$bind",function(T){var j=this;if(j.owner.$$is_module||E.is_a(T,j.owner))return K("Method").$new(T,j.owner,j.method,j.name);_.$raise(K("TypeError"),"can't bind singleton method to a different class (expected "+T+".kind_of?("+j.owner+" to be true)")}),me(U,"$bind_call",function Y(T,j){var q,oe=Y.$$p||w,X=this;return Y.$$p=null,q=H(arguments,1),x(X.$bind(T),"call",O(q),oe.$to_proc())},-2),me(U,"$inspect",function(){var T=this;return"#<"+T.$class()+": "+T.source+"#"+T.name+" (defined in "+T.owner+" in "+T.$source_location().$join(":")+")>"})}()},Opal.modules["corelib/variables"]=function(E){var le=E.gvars,me=E.const_set,d=E.Object,H=E.hash2,J=E.nil;return le["&"]=le["~"]=le["`"]=le["'"]=J,le.LOADED_FEATURES=le['"']=E.loaded_features,le.LOAD_PATH=le[":"]=[],le["/"]="\n",le[","]=J,me("::","ARGV",[]),me("::","ARGF",d.$new()),me("::","ENV",H([],{})),le.VERBOSE=!1,le.DEBUG=!1,le.SAFE=0},Opal.modules["corelib/io"]=function(E){var M,v,P,me=E.const_set,d=E.not,H=E.truthy,J=E.def,_=E.return_ivar,x=E.return_val,O=E.slice,w=E.Kernel,K=E.gvars,G=E.send,A=E.to_a,U=E.rb_plus,N=E.neqeq,Y=E.range,T=E.hash2,j=E.eqeq,oe=E.to_ary,z=E.rb_gt,q=E.assign_ivar_val,X=E.alias,I=E.nil,Q=E.$$$;(P=(v=(0,E.klass)("::",null,"IO")).$$prototype).read_buffer=P.closed=I,me(v,"SEEK_SET",0),me(v,"SEEK_CUR",1),me(v,"SEEK_END",2),me(v,"SEEK_DATA",3),me(v,"SEEK_HOLE",4),me(v,"READABLE",1),me(v,"WRITABLE",4),v.$attr_reader("eof"),v.$attr_accessor("read_proc","sync","tty","write_proc"),J(v,"$initialize",function(te,D){var fe=this;return null==D&&(D="r"),fe.fd=te,fe.flags=D,fe.eof=!1,H(D["$include?"]("r"))&&d(D["$match?"](/[wa+]/))?fe.closed="write":H(D["$match?"](/[wa]/))&&d(D["$match?"](/[r+]/))?fe.closed="read":I},-2),J(v,"$fileno",_("fd")),J(v,"$tty?",function(){return 1==this.tty}),J(v,"$write",function(te){return this.write_proc(te),te.$size()}),J(v,"$flush",x(I)),J(v,"$<<",function(te){return this.$write(te),this}),J(v,"$print",function(te){var fe,R=this;null==K[","]&&(K[","]=I);for(var F=0,g=(fe=O(arguments)).length;F<g;F++)fe[F]=w.$String(fe[F]);return R.$write(fe.join(K[","])),I},-1),J(v,"$puts",function(te){var fe,F,R=this;if(0===(fe=O(arguments)).length)return R.$write("\n"),I;for(var g=0,l=fe.length;g<l;g++)if(fe[g].$$is_array){var c=fe[g].$flatten();c.length>0&&G(R,"puts",A(c))}else(F=fe[g].$$is_string?fe[g].valueOf():w.$String(fe[g])).endsWith("\n")||(F+="\n"),R.$write(F);return I},-1),J(v,"$getc",function(){var D,te=this,fe=I,R=I;te.read_buffer=H(D=te.read_buffer)?D:"",fe="";do{if(te.read_buffer=U(te.read_buffer,fe),N(te.read_buffer,""))return R=te.read_buffer["$[]"](0),te.read_buffer=te.read_buffer["$[]"](Y(1,-1,!1)),R}while(H(fe=te.$sysread_noraise(1)));return I}),J(v,"$getbyte",function(){var te;return(te=this.$getc())===I||null==te?I:te.$ord()}),J(v,"$readbyte",function(){return this.$readchar().$ord()}),J(v,"$readchar",function(){var D;return H(D=this.$getc())?D:w.$raise(Q("EOFError"),"end of file reached")}),J(v,"$readline",function(te){var D,R=this,F=I;return D=O(arguments),H(F=G(R,"gets",A(D)))?F:w.$raise(Q("EOFError"),"end of file reached")},-1),J(v,"$gets",function(te,D,fe){var R,F,l,f,g=this,c=I,u=I,p=I,m=I;null==K["/"]&&(K["/"]=I),null==te&&(te=!1),null==D&&(D=I),null==fe&&(fe=T([],{})),H(te.$$is_number)&&d(D)&&(te=(R=[!1,te,D])[0],D=R[1],fe=R[2]),H(te.$$is_hash)&&d(D)&&j(fe,T([],{}))?(te=(R=[!1,I,te])[0],D=R[1],fe=R[2]):H(D.$$is_hash)&&j(fe,T([],{}))&&(te=(R=[te,I,D])[0],D=R[1],fe=R[2]),l=te,j(te,!1)&&(te=K["/"]),j(te,"")&&(te=/\r?\n\r?\n/),te=H(c=te)?c:"",j(l,"")||(te=te.$to_str()),f=j(l,"")?2:te.$length(),j(te," ")&&(te=/ /),g.read_buffer=H(c=g.read_buffer)?c:"",u="",p=I;do{if(g.read_buffer=U(g.read_buffer,u),N(te,"")&&H(H(te.$$is_regexp)?g.read_buffer["$match?"](te):g.read_buffer["$include?"](te))){m=g.read_buffer,F=g.read_buffer.$split(te,2),p=(R=oe(F))[0]??I,g.read_buffer=R[1]??I,N(p,m)&&(p=U(p,m["$[]"](p.$length(),f)));break}}while(H(u=g.$sysread_noraise(j(te,"")?65536:1)));return H(p)||(p=(R=[H(c=g.read_buffer)?c:"",""])[0],g.read_buffer=R[1],j(p,"")&&(p=I)),H(p)&&(H(D)&&(p=p["$[]"](E.Range.$new(0,D,!0)),g.read_buffer=U(p["$[]"](E.Range.$new(D,-1,!1)),g.read_buffer)),H(fe["$[]"]("chomp"))&&(p=p.$sub(/\r?\n$/,"")),j(l,"")&&(p=p.$sub(/^[\r\n]+/,""))),j(l,!1)&&(K._=p),p},-1),J(v,"$sysread",function(te){var fe;return H(fe=this.read_proc(te))?fe:(this.eof=!0,w.$raise(Q("EOFError"),"end of file reached"))}),J(v,"$sysread_noraise",function(te){try{return this.$sysread(te)}catch(fe){if(!E.rescue(fe,[Q("EOFError")]))throw fe;try{return I}finally{E.pop_exception()}}}),J(v,"$readpartial",function(te){var D,F,fe=this,R=I,g=I;return fe.read_buffer=H(R=fe.read_buffer)?R:"",F=fe.$sysread(te),g=(D=[U(fe.read_buffer,H(R=F)?R:""),""])[0],fe.read_buffer=D[1],j(g,"")&&(g=I),g}),J(v,"$read",function(te){var D,fe=this,R=I,F=I,g=I;null==te&&(te=I),fe.read_buffer=H(R=fe.read_buffer)?R:"",F="",g=I;do{if(fe.read_buffer=U(fe.read_buffer,F),H(te)&&H(z(fe.read_buffer.$length(),te)))return g=(D=[fe.read_buffer["$[]"](E.Range.$new(0,te,!0)),fe.read_buffer["$[]"](E.Range.$new(te,-1,!1))])[0],fe.read_buffer=D[1],g}while(H(F=fe.$sysread_noraise(H(R=te)?R:65536)));return g=(D=[fe.read_buffer,""])[0],fe.read_buffer=D[1],g},-1),J(v,"$readlines",function(te){return null==K["/"]&&(K["/"]=I),null==te&&(te=K["/"]),this.$each_line(te).$to_a()},-1),J(v,"$each",function B(te,D){var R,F,g,fe=B.$$p||I,l=this,c=I;if(null==K["/"]&&(K["/"]=I),B.$$p=null,(R=O(arguments)).length>0&&(F=R.shift()),null==F&&(F=K["/"]),g=R,fe===I)return G(l,"enum_for",["each",F].concat(A(g)));for(;H(c=G(l,"gets",[F].concat(A(g))));)E.yield1(fe,c);return l},-1),J(v,"$each_byte",function B(){var te=B.$$p||I,D=this,fe=I;if(B.$$p=null,te===I)return D.$enum_for("each_byte");for(;H(fe=D.$getbyte());)E.yield1(te,fe);return D}),J(v,"$each_char",function B(){var te=B.$$p||I,D=this,fe=I;if(B.$$p=null,te===I)return D.$enum_for("each_char");for(;H(fe=D.$getc());)E.yield1(te,fe);return D}),J(v,"$close",q("closed","both")),J(v,"$close_read",function(){return this.closed=j(this.closed,"write")?"both":"read"}),J(v,"$close_write",function(){return this.closed=j(this.closed,"read")?"both":"write"}),J(v,"$closed?",function(){return this.closed["$=="]("both")}),J(v,"$closed_read?",function(){var D;return H(D=this.closed["$=="]("read"))?D:this.closed["$=="]("both")}),J(v,"$closed_write?",function(){var D;return H(D=this.closed["$=="]("write"))?D:this.closed["$=="]("both")}),J(v,"$check_writable",function(){return H(this["$closed_write?"]())?w.$raise(Q("IOError"),"not opened for writing"):I}),J(v,"$check_readable",function(){return H(this["$closed_read?"]())?w.$raise(Q("IOError"),"not opened for reading"):I}),X(v,"each_line","each"),X(v,"eof?","eof"),me("::","STDIN",K.stdin=Q("IO").$new(0,"r")),me("::","STDOUT",K.stdout=Q("IO").$new(1,"w")),me("::","STDERR",K.stderr=Q("IO").$new(2,"w"));var L=E.global.console;return Q("STDOUT")["$write_proc="]("object"==typeof process&&"object"==typeof process.stdout?function(S){process.stdout.write(S)}:function(S){L.log(S)}),Q("STDERR")["$write_proc="]("object"==typeof process&&"object"==typeof process.stderr?function(S){process.stderr.write(S)}:function(S){L.warn(S)}),M=[function(S){var k=prompt();return null!==k?k+"\n":I}],G(Q("STDIN"),"read_proc=",M),M[M.length-1]},Opal.modules["opal/regexp_anchors"]=function(E){var x,O,w,K,me=E.const_set,d=[],J=E.$$$;return x=d,w=[O=(0,E.module)(d[0],"Opal")].concat(x),K=E.$r(w),me(O,"REGEXP_START","^"),me(O,"REGEXP_END","$"),me(O,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),me(O,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),me(O,"INLINE_IDENTIFIER_REGEXP",K("Regexp").$new("[^"+J(O,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+J(O,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),me(O,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),me(O,"CONST_NAME_REGEXP",K("Regexp").$new(J(O,"REGEXP_START")+"(::)?[A-Z][^"+J(O,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+J(O,"REGEXP_END")))},Opal.modules["opal/mini"]=function(E){var le=E.Object;return le.$require("opal/base"),le.$require("corelib/nil"),le.$require("corelib/boolean"),le.$require("corelib/string"),le.$require("corelib/comparable"),le.$require("corelib/enumerable"),le.$require("corelib/enumerator"),le.$require("corelib/array"),le.$require("corelib/hash"),le.$require("corelib/number"),le.$require("corelib/range"),le.$require("corelib/proc"),le.$require("corelib/method"),le.$require("corelib/regexp"),le.$require("corelib/variables"),le.$require("corelib/io"),le.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(E){var N,le=E.coerce_to,d=E.slice,H=E.truthy,J=E.eqeq,_=E.Opal,x=E.Kernel,O=E.gvars,K=E.alias,G=E.nil,A=E.$$$;return(0,E.def)(N=(0,E.module)("::","Kernel"),"$format",function(T,j){var oe,z,q=G;null==O.DEBUG&&(O.DEBUG=G),oe=d(arguments,1),J((z=oe).$length(),1)&&H(z["$[]"](0)["$respond_to?"]("to_ary"))&&(q=_["$coerce_to?"](z["$[]"](0),A("Array"),"to_ary"),H(q["$nil?"]())||(z=q.$to_a()));var I,Q,S,k,v,P,B,te,D,fe,R,F,g,l,c,p,X="",M=0,L=T.length,f=1,u=0,m=0,C=1,$=2,re=4,se=8,Ee=16,Me=32,ce=64,ke=128;function ve(){p&Me&&x.$raise(A("ArgumentError"),"flag after width"),p&ke&&x.$raise(A("ArgumentError"),"flag after precision")}function ye(){p&Me&&x.$raise(A("ArgumentError"),"width given twice"),p&ke&&x.$raise(A("ArgumentError"),"width after precision")}function he(y){return y>=z.length&&x.$raise(A("ArgumentError"),"too few arguments"),z[y]}function Ie(){switch(u){case-1:x.$raise(A("ArgumentError"),"unnumbered("+f+") mixed with numbered");case-2:x.$raise(A("ArgumentError"),"unnumbered("+f+") mixed with named")}return he((u=f++)-1)}function be(y){return u>0&&x.$raise(A("ArgumentError"),"numbered("+y+") after unnumbered("+u+")"),-2===u&&x.$raise(A("ArgumentError"),"numbered("+y+") after named"),y<1&&x.$raise(A("ArgumentError"),"invalid index - "+y+"$"),u=-1,he(y-1)}function ae(){return void 0===c?Ie():c}function ue(y){for(var W,pe="";;Q++){if(Q===L&&x.$raise(A("ArgumentError"),"malformed format string - %*[0-9]"),T.charCodeAt(Q)<48||T.charCodeAt(Q)>57)return Q--,(W=parseInt(pe,10)||0)>2147483647&&x.$raise(A("ArgumentError"),y+" too big"),W;pe+=T.charAt(Q)}}function xe(y){var W,pe=ue(y);return"$"===T.charAt(Q+1)?(Q++,W=be(pe)):W=Ie(),W.$to_int()}for(Q=T.indexOf("%");-1!==Q;Q=T.indexOf("%",Q)){switch(k=void 0,p=m,P=-1,B=-1,c=void 0,I=Q,Q++,T.charAt(Q)){case"%":M=Q;case"":case"\n":case"\0":Q++;continue}e:for(;Q<L;Q++)switch(T.charAt(Q)){case" ":ve(),p|=Ee;continue e;case"#":ve(),p|=C;continue e;case"+":ve(),p|=re;continue e;case"-":ve(),p|=$;continue e;case"0":ve(),p|=se;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(te=ue("width"),"$"===T.charAt(Q+1)){if(Q+2===L){k="%",Q++;break e}void 0!==c&&x.$raise(A("ArgumentError"),"value given twice - %"+te+"$"),c=be(te),Q++}else ye(),p|=Me,P=te;continue e;case"<":case"{":for(fe="<"===T.charAt(Q)?">":"}",D="",Q++;;Q++){if(Q===L&&x.$raise(A("ArgumentError"),"malformed name - unmatched parenthesis"),T.charAt(Q)===fe){if(u>0&&x.$raise(A("ArgumentError"),"named "+D+" after unnumbered("+u+")"),-1===u&&x.$raise(A("ArgumentError"),"named "+D+" after numbered"),u=-2,(void 0===z[0]||!z[0].$$is_hash)&&x.$raise(A("ArgumentError"),"one hash required"),c=z[0].$fetch(D),">"===fe)continue e;if(k=c.toString(),-1!==B&&(k=k.slice(0,B)),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e}D+=T.charAt(Q)}case"*":Q++,ye(),p|=Me,(P=xe("width"))<0&&(p|=$,P=-P);continue e;case".":if(p&ke&&x.$raise(A("ArgumentError"),"precision given twice"),p|=ce|ke,B=0,Q++,"*"===T.charAt(Q)){Q++,(B=xe("precision"))<0&&(p&=~ce);continue e}B=ue("precision");continue e;case"d":case"i":case"u":if((S=x.$Integer(ae()))>=0){for(k=S.toString();k.length<B;)k="0"+k;if(p&$)for((p&re||p&Ee)&&(k=(p&re?"+":" ")+k);k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-(p&re||p&Ee?1:0);)k="0"+k;(p&re||p&Ee)&&(k=(p&re?"+":" ")+k)}else for((p&re||p&Ee)&&(k=(p&re?"+":" ")+k);k.length<P;)k=" "+k}else{for(k=(-S).toString();k.length<B;)k="0"+k;if(p&$)for(k="-"+k;k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-1;)k="0"+k;k="-"+k}else for(k="-"+k;k.length<P;)k=" "+k}break e;case"b":case"B":case"o":case"x":case"X":switch(T.charAt(Q)){case"b":case"B":R=2,F="0b",g=/^1+/,l="1";break;case"o":R=8,F="0",g=/^3?7+/,l="7";break;case"x":case"X":R=16,F="0x",g=/^f+/,l="f"}if((S=x.$Integer(ae()))>=0){for(k=S.toString(R);k.length<B;)k="0"+k;if(p&$)for((p&re||p&Ee)&&(k=(p&re?"+":" ")+k),p&C&&0!==S&&(k=F+k);k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-(p&re||p&Ee?1:0)-(p&C&&0!==S?F.length:0);)k="0"+k;p&C&&0!==S&&(k=F+k),(p&re||p&Ee)&&(k=(p&re?"+":" ")+k)}else for(p&C&&0!==S&&(k=F+k),(p&re||p&Ee)&&(k=(p&re?"+":" ")+k);k.length<P;)k=" "+k}else if(p&re||p&Ee){for(k=(-S).toString(R);k.length<B;)k="0"+k;if(p&$)for(p&C&&(k=F+k),k="-"+k;k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-1-(p&C?2:0);)k="0"+k;p&C&&(k=F+k),k="-"+k}else for(p&C&&(k=F+k),k="-"+k;k.length<P;)k=" "+k}else{for(k=(S>>>0).toString(R).replace(g,l);k.length<B-2;)k=l+k;if(p&$)for(k=".."+k,p&C&&(k=F+k);k.length<P;)k+=" ";else if(p&se&&-1===B){for(;k.length<P-2-(p&C?F.length:0);)k=l+k;k=".."+k,p&C&&(k=F+k)}else for(k=".."+k,p&C&&(k=F+k);k.length<P;)k=" "+k}T.charAt(Q)===T.charAt(Q).toUpperCase()&&(k=k.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((S=x.$Float(ae()))>=0||isNaN(S)){if(S===1/0)k="Inf";else switch(T.charAt(Q)){case"f":k=S.toFixed(-1===B?6:B);break;case"e":case"E":k=S.toExponential(-1===B?6:B);break;case"g":case"G":k=S.toExponential(),(v=parseInt(k.split("e")[1],10))<-4||v>=(-1===B?6:B)||(k=S.toPrecision(-1===B?p&C?6:void 0:B))}if(p&$)for((p&re||p&Ee)&&(k=(p&re?"+":" ")+k);k.length<P;)k+=" ";else if(p&se&&S!==1/0&&!isNaN(S)){for(;k.length<P-(p&re||p&Ee?1:0);)k="0"+k;(p&re||p&Ee)&&(k=(p&re?"+":" ")+k)}else for((p&re||p&Ee)&&(k=(p&re?"+":" ")+k);k.length<P;)k=" "+k}else{if(S===-1/0)k="Inf";else switch(T.charAt(Q)){case"f":k=(-S).toFixed(-1===B?6:B);break;case"e":case"E":k=(-S).toExponential(-1===B?6:B);break;case"g":case"G":k=(-S).toExponential(),(v=parseInt(k.split("e")[1],10))<-4||v>=(-1===B?6:B)||(k=(-S).toPrecision(-1===B?p&C?6:void 0:B))}if(p&$)for(k="-"+k;k.length<P;)k+=" ";else if(p&se&&S!==-1/0){for(;k.length<P-1;)k="0"+k;k="-"+k}else for(k="-"+k;k.length<P;)k=" "+k}T.charAt(Q)===T.charAt(Q).toUpperCase()&&S!==1/0&&S!==-1/0&&!isNaN(S)&&(k=k.toUpperCase()),k=k.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":x.$raise(A("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((S=ae())["$respond_to?"]("to_ary")&&(S=S.$to_ary()[0]),1!==(k=S["$respond_to?"]("to_str")?S.$to_str():String.fromCharCode(le(S,A("Integer"),"to_int"))).length&&x.$raise(A("ArgumentError"),"%c requires a character"),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e;case"p":if(k=ae().$inspect(),-1!==B&&(k=k.slice(0,B)),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e;case"s":if(k=ae().$to_s(),-1!==B&&(k=k.slice(0,B)),p&$)for(;k.length<P;)k+=" ";else for(;k.length<P;)k=" "+k;break e;default:x.$raise(A("ArgumentError"),"malformed format string - %"+T.charAt(Q))}void 0===k&&x.$raise(A("ArgumentError"),"malformed format string - %"),X+=T.slice(M,I)+k,M=Q+1}return O.DEBUG&&u>=0&&f<z.length&&x.$raise(A("ArgumentError"),"too many arguments for format string"),X+T.slice(M)},-2),K(N,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(E){var Y,I,Q,le=E.klass,me=E.hash2,d=E.rb_plus,H=E.truthy,J=E.send,_=E.defs,x=E.eqeq,O=E.def,w=E.return_ivar,K=E.return_val,G=E.slice,A=E.Kernel,U=E.Opal,N=E.rb_lt,T=E.top,oe=E.$r([]),z=E.nil,q=E.$$$;return T.$require("corelib/string"),(Q=(I=le("::",null,"Encoding")).$$prototype).name=Q.dummy=z,_(I,"$register",function L(S,k){var B,D,fe,v=L.$$p||z,te=z,R=z,F=z;return L.$$p=null,null==k&&(k=me([],{})),B=d([S],H(te=k["$[]"]("aliases"))?te:[]),D=H(te=k["$[]"]("ascii"))&&te,fe=H(te=k["$[]"]("dummy"))&&te,H(k["$[]"]("inherits"))?(R=k["$[]"]("inherits").$clone()).$initialize(S,B,D,fe):R=this.$new(S,B,D,fe),v!==z&&J(R,"instance_eval",[],v.$to_proc()),F=E.encodings,J(B,"each",[],function g(l){return null==l&&(l=z),(g.$$s??this).$const_set(l.$tr("-","_"),R),F[l]=R},{$$s:this})},-2),_(I,"$find",function(S){return x(S,"default_external")?this.$default_external():E.find_encoding(S)}),I.$singleton_class().$attr_accessor("default_external"),I.$attr_reader("name","names"),O(I,"$initialize",function(S,k,v,P){var B=this;return B.name=S,B.names=k,B.ascii=v,B.dummy=P}),O(I,"$ascii_compatible?",w("ascii")),O(I,"$dummy?",w("dummy")),O(I,"$binary?",K(!1)),O(I,"$to_s",w("name")),O(I,"$inspect",function(){return"#<Encoding:"+this.name+(H(this.dummy)?" (dummy)":z)+">"}),O(I,"$charsize",function(S){for(var k=0,v=0,P=S.length;v<P;v++){var B=S.charCodeAt(v);B>=55296&&B<=56319||k++}return k}),O(I,"$each_char",function L(S){var k=L.$$p||z;L.$$p=null;for(var v="",P=0,B=S.length;P<B;P++){var te=S.charCodeAt(P),D=S.charAt(P);te>=56320&&te<=57343?v=D:(te>=55296&&te<=56319&&(D=v+D),"UTF-8"!=S.encoding.name&&((D=new String(D)).encoding=S.encoding),E.yield1(k,D))}}),O(I,"$each_byte",function(S){return G(arguments),A.$raise(q("NotImplementedError"))},-1),O(I,"$bytesize",function(S){return G(arguments),A.$raise(q("NotImplementedError"))},-1),le("::",q("StandardError"),"EncodingError"),le("::",q("EncodingError"),"CompatibilityError"),J(q("Encoding"),"register",["UTF-8",me(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function X(){var M=X.$$s??this;return O(M,"$each_byte",function I(Q){var L=I.$$p||z;I.$$p=null;for(var k,S=1/0,v=Q.length,P=null,B=0;B<v;++B){if((k=Q.charCodeAt(B))>55295&&k<57344){if(!P){if(k>56319){(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189));continue}if(B+1===v){(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189));continue}P=k;continue}if(k<56320){(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189)),P=k;continue}k=65536+(P-55296<<10|k-56320)}else P&&(S-=3)>-1&&(E.yield1(L,239),E.yield1(L,191),E.yield1(L,189));if(P=null,k<128){if((S-=1)<0)break;E.yield1(L,k)}else if(k<2048){if((S-=2)<0)break;E.yield1(L,k>>6|192),E.yield1(L,63&k|128)}else if(k<65536){if((S-=3)<0)break;E.yield1(L,k>>12|224),E.yield1(L,k>>6&63|128),E.yield1(L,63&k|128)}else if(k<1114112){if((S-=4)<0)break;E.yield1(L,k>>18|240),E.yield1(L,k>>12&63|128),E.yield1(L,k>>6&63|128),E.yield1(L,63&k|128)}}}),O(M,"$bytesize",function(Q){return Q.$bytes().$length()})},{$$s:T}),J(q("Encoding"),"register",["UTF-16LE"],function X(){var M=X.$$s??this;return O(M,"$each_byte",function I(Q){var L=I.$$p||z;I.$$p=null;for(var S=0,k=Q.length;S<k;S++){var v=Q.charCodeAt(S);E.yield1(L,255&v),E.yield1(L,v>>8)}}),O(M,"$bytesize",function(Q){return 2*Q.length})},{$$s:T}),J(q("Encoding"),"register",["UTF-16BE",me(["inherits"],{inherits:q(q("Encoding"),"UTF_16LE")})],function X(){return O(X.$$s??this,"$each_byte",function I(Q){var L=I.$$p||z;I.$$p=null;for(var S=0,k=Q.length;S<k;S++){var v=Q.charCodeAt(S);E.yield1(L,v>>8),E.yield1(L,255&v)}})},{$$s:T}),J(q("Encoding"),"register",["UTF-32LE"],function X(){var M=X.$$s??this;return O(M,"$each_byte",function I(Q){var L=I.$$p||z;I.$$p=null;for(var S=0,k=Q.length;S<k;S++){var v=Q.charCodeAt(S);E.yield1(L,255&v),E.yield1(L,v>>8),E.yield1(L,0),E.yield1(L,0)}}),O(M,"$bytesize",function(Q){return 4*Q.length})},{$$s:T}),J(q("Encoding"),"register",["UTF-32BE",me(["inherits"],{inherits:q(q("Encoding"),"UTF_32LE")})],function X(){return O(X.$$s??this,"$each_byte",function I(Q){var L=I.$$p||z;I.$$p=null;for(var S=0,k=Q.length;S<k;S++){var v=Q.charCodeAt(S);E.yield1(L,0),E.yield1(L,0),E.yield1(L,v>>8),E.yield1(L,255&v)}})},{$$s:T}),J(q("Encoding"),"register",["ASCII-8BIT",me(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function X(){var M=X.$$s??this;return O(M,"$each_char",function I(Q){var L=I.$$p||z;I.$$p=null;for(var S=0,k=Q.length;S<k;S++){var v=new String(Q.charAt(S));v.encoding=Q.encoding,E.yield1(L,v)}}),O(M,"$charsize",function(Q){return Q.length}),O(M,"$each_byte",function I(Q){var L=I.$$p||z;I.$$p=null;for(var S=0,k=Q.length;S<k;S++){var v=Q.charCodeAt(S);E.yield1(L,255&v)}}),O(M,"$bytesize",function(Q){return Q.length}),O(M,"$binary?",K(!0))},{$$s:T}),q("Encoding").$register("ISO-8859-1",me(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),q("Encoding").$register("US-ASCII",me(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:q(q("Encoding"),"ASCII_8BIT")})),function(X,M){var I=le("::",null,"String"),Q=I.$$prototype;Q.internal_encoding=Q.bytes=Q.encoding=z,I.$attr_reader("encoding"),I.$attr_reader("internal_encoding"),E.prop(String.prototype,"bytes",z),E.prop(String.prototype,"encoding",q(q("Encoding"),"UTF_8")),E.prop(String.prototype,"internal_encoding",q(q("Encoding"),"UTF_8")),O(I,"$b",function(){return this.$dup().$force_encoding("binary")}),O(I,"$bytesize",function(){return this.internal_encoding.$bytesize(this)}),O(I,"$each_byte",function L(){var S=L.$$p||z,k=this;return L.$$p=null,S===z?J(k,"enum_for",["each_byte"],function v(){return(v.$$s??this).$bytesize()},{$$s:k}):(J(k.internal_encoding,"each_byte",[k],S.$to_proc()),k)}),O(I,"$bytes",function(){var S=this,k=z;return"string"==typeof S?new String(S).$each_byte().$to_a():(S.bytes=H(k=S.bytes)?k:S.$each_byte().$to_a(),S.bytes.$dup())}),O(I,"$each_char",function L(){var S=L.$$p||z,k=this;return L.$$p=null,S===z?J(k,"enum_for",["each_char"],function v(){return(v.$$s??this).$length()},{$$s:k}):(J(k.encoding,"each_char",[k],S.$to_proc()),k)}),O(I,"$chars",function L(){var S=L.$$p||z;return L.$$p=null,H(S)?J(this,"each_char",[],S.$to_proc()):this.$each_char().$to_a()}),O(I,"$each_codepoint",function L(){var S=L.$$p||z,k=this;if(L.$$p=null,S===z)return k.$enum_for("each_codepoint");for(var v=0,P=k.length;v<P;v++)E.yield1(S,k.codePointAt(v));return k}),O(I,"$codepoints",function L(){var S=L.$$p||z;return L.$$p=null,S!==z?J(this,"each_codepoint",[],S.$to_proc()):this.$each_codepoint().$to_a()}),O(I,"$encode",function(S){return E.enc(this,S)}),O(I,"$force_encoding",function(S){var v=this;return S===v.encoding||(S=U["$coerce_to!"](S,q("String"),"to_s"),(S=q("Encoding").$find(S))===v.encoding)||(v=E.set_encoding(v,S)),v}),O(I,"$getbyte",function(S){var v=z;return v=this.$bytes(),S=U["$coerce_to!"](S,q("Integer"),"to_int"),H(N(v.$length(),S))?z:v["$[]"](S)}),O(I,"$initialize_copy",function(S){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "}),O(I,"$valid_encoding?",K(!0))}(),Y=[q(oe("Encoding"),"UTF_8")],J(q("Encoding"),"default_external=",Y),Y[Y.length-1]},Opal.modules["corelib/math"]=function(E){var oe,z,q,X,le=E.type_error,d=E.const_set,H=E.Class,J=E.slice,_=E.Kernel,x=E.defs,O=E.truthy,w=E.send,K=E.def,G=E.rb_minus,A=E.eqeqeq,U=E.rb_divide,Y=E.nil,T=E.$$$;return oe=[],q=[z=(0,E.module)("::","Math")].concat(oe),X=E.$r(q),d(z,"E",Math.E),d(z,"PI",Math.PI),d(z,"DomainError",H.$new(T("StandardError"))),x(z,"$checked",function(I,Q){var S;if(S=J(arguments,1),isNaN(S[0])||2==S.length&&isNaN(S[1]))return NaN;var k=Math[I].apply(null,S);return isNaN(k)&&_.$raise(X("DomainError"),'Numerical argument is out of domain - "'+I+'"'),k},-2),x(z,"$float!",function(I){try{return _.$Float(I)}catch(Q){if(!E.rescue(Q,[T("ArgumentError")]))throw Q;try{return _.$raise(le(I,T("Float")))}finally{E.pop_exception()}}}),x(z,"$integer!",function(I){try{return _.$Integer(I)}catch(Q){if(!E.rescue(Q,[T("ArgumentError")]))throw Q;try{return _.$raise(le(I,T("Integer")))}finally{E.pop_exception()}}}),z.$module_function(),O(typeof Math.erf<"u")||E.prop(Math,"erf",function(M){var P=1;M<0&&(P=-1);var B=1/(1+.3275911*(M=Math.abs(M)));return P*(1-((((1.061405429*B-1.453152027)*B+1.421413741)*B-.284496736)*B+.254829592)*B*Math.exp(-M*M))}),O(typeof Math.erfc<"u")||E.prop(Math,"erfc",function(M){var I=Math.abs(M),Q=1/(.5*I+1),F=Q*Math.exp(-I*I-1.26551223+Q*(Q*(Q*(Q*(Q*(Q*(Q*(Q*(.17087277*Q-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return M<0?2-F:F}),w(["acos","acosh","asin","asinh","atan","atanh","cbrt","cos","cosh","erf","erfc","exp","sin","sinh","sqrt","tanh"],"each",[],function M(I){return null==I&&(I=Y),w(M.$$s??this,"define_method",[I],function(S){return null==S&&(S=Y),T("Math").$checked(I,T("Math")["$float!"](S))})},{$$s:z}),K(z,"$atan2",function(I,Q){return T("Math").$checked("atan2",T("Math")["$float!"](I),T("Math")["$float!"](Q))}),K(z,"$hypot",function(I,Q){return T("Math").$checked("hypot",T("Math")["$float!"](I),T("Math")["$float!"](Q))}),K(z,"$frexp",function(I){if(I=X("Math")["$float!"](I),isNaN(I))return[NaN,0];var Q=Math.floor(Math.log(Math.abs(I))/Math.log(2))+1;return[I/Math.pow(2,Q),Q]}),K(z,"$gamma",function(I){I=X("Math")["$float!"](I);var Q,L,S,k,v,P,B,te,D,R=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(I))return NaN;if(0===I&&1/I<0)return-1/0;if((-1===I||I===-1/0)&&_.$raise(X("DomainError"),'Numerical argument is out of domain - "gamma"'),X("Integer")["$==="](I)){if(I<=0)return isFinite(I)?1/0:NaN;if(I>171)return 1/0;for(k=I-2,v=I-1;k>1;)v*=k,k--;return 0==v&&(v=1),v}if(I<.5)return Math.PI/(Math.sin(Math.PI*I)*T("Math").$gamma(G(1,I)));if(I>=171.35)return 1/0;if(I>85)return D=(te=(B=(P=I*I)*I)*I)*I,Math.sqrt(2*Math.PI/I)*Math.pow(I/Math.E,I)*(1+1/(12*I)+1/(288*P)-139/(51840*B)-571/(2488320*te)+163879/(209018880*D)+5246819/(75246796800*D*I));for(I-=1,S=R[0],Q=1;Q<R.length;++Q)S+=R[Q]/(I+Q);return L=I+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(L,I+.5)*Math.exp(-L)*S}),K(z,"$ldexp",function(I,Q){return I=X("Math")["$float!"](I),Q=X("Math")["$integer!"](Q),isNaN(Q)&&_.$raise(T("RangeError"),"float NaN out of range of integer"),I*Math.pow(2,Q)}),K(z,"$lgamma",function(I){return-1==I?[1/0,1]:[Math.log(Math.abs(T("Math").$gamma(I))),T("Math").$gamma(I)<0?-1:1]}),K(z,"$log",function(I,Q){return A(T("String"),I)&&_.$raise(le(I,T("Float"))),O(null==Q)?T("Math").$checked("log",T("Math")["$float!"](I)):(A(T("String"),Q)&&_.$raise(le(Q,T("Float"))),U(T("Math").$checked("log",T("Math")["$float!"](I)),T("Math").$checked("log",T("Math")["$float!"](Q))))},-2),K(z,"$log10",function(I){return A(T("String"),I)&&_.$raise(le(I,T("Float"))),T("Math").$checked("log10",T("Math")["$float!"](I))}),K(z,"$log2",function(I){return A(T("String"),I)&&_.$raise(le(I,T("Float"))),T("Math").$checked("log2",T("Math")["$float!"](I))}),K(z,"$tan",function(I){return I=T("Math")["$float!"](I),O(I["$infinite?"]())?T(T("Float"),"NAN"):T("Math").$checked("tan",T("Math")["$float!"](I))})},Opal.modules["corelib/complex/base"]=function(E){var O,w,K,G,me=E.truthy,d=E.def,H=E.klass,J=[],_=E.nil;return O=J,K=[w=(0,E.module)("::","Kernel")].concat(O),G=E.$r(K),d(w,"$Complex",function(U,N){return null==N&&(N=_),me(N)?G("Complex").$new(U,N):G("Complex").$new(U,0)},-2),function(x,O,w){var K=H("::",null,"String"),G=[K].concat(w),A=E.$r(G);return d(K,"$to_c",function(){return A("Complex").$from_string(this)})}(0,0,J)},Opal.modules["corelib/complex"]=function(E){var Q,L,S,k,v,le=E.klass,me=E.truthy,d=E.eqeqeq,H=E.Kernel,J=E.defs,_=E.rb_times,x=E.def,O=E.rb_plus,w=E.rb_minus,K=E.rb_divide,G=E.eqeq,A=E.to_ary,U=E.rb_gt,N=E.neqeq,Y=E.return_val,T=E.const_set,j=E.alias,oe=E.top,q=E.nil,X=E.$$$;return oe.$require("corelib/numeric"),oe.$require("corelib/complex/base"),Q=[],S=[L=le("::",X("Numeric"),"Complex")].concat(Q),k=E.$r(S),(v=L.$$prototype).real=v.imag=q,J(L,"$rect",function(B,te){return null==te&&(te=0),d(X("Numeric"),B)&&me(B["$real?"]())&&d(X("Numeric"),te)&&me(te["$real?"]())||H.$raise(X("TypeError"),"not a real"),this.$new(B,te)},-2),J(L,"$polar",function(B,te){return null==te&&(te=0),d(X("Numeric"),B)&&me(B["$real?"]())&&d(X("Numeric"),te)&&me(te["$real?"]())||H.$raise(X("TypeError"),"not a real"),this.$new(_(B,X("Math").$cos(te)),_(B,X("Math").$sin(te)))},-2),L.$attr_reader("real","imag"),x(L,"$initialize",function(B,te){var D=this;return null==te&&(te=0),D.real=B,D.imag=te,D.$freeze()},-2),x(L,"$coerce",function(B){return d(X("Complex"),B)?[B,this]:d(X("Numeric"),B)&&me(B["$real?"]())?[X("Complex").$new(B,0),this]:H.$raise(X("TypeError"),B.$class()+" can't be coerced into Complex")}),x(L,"$==",function(B){var te=this,D=q;return d(X("Complex"),B)?me(D=te.real["$=="](B.$real()))?te.imag["$=="](B.$imag()):D:d(X("Numeric"),B)&&me(B["$real?"]())?me(D=te.real["$=="](B))?te.imag["$=="](0):D:B["$=="](te)}),x(L,"$-@",function(){return H.$Complex(this.real["$-@"](),this.imag["$-@"]())}),x(L,"$+",function(B){var te=this;return d(X("Complex"),B)?H.$Complex(O(te.real,B.$real()),O(te.imag,B.$imag())):d(X("Numeric"),B)&&me(B["$real?"]())?H.$Complex(O(te.real,B),te.imag):te.$__coerced__("+",B)}),x(L,"$-",function(B){var te=this;return d(X("Complex"),B)?H.$Complex(w(te.real,B.$real()),w(te.imag,B.$imag())):d(X("Numeric"),B)&&me(B["$real?"]())?H.$Complex(w(te.real,B),te.imag):te.$__coerced__("-",B)}),x(L,"$*",function(B){var te=this;return d(X("Complex"),B)?H.$Complex(w(_(te.real,B.$real()),_(te.imag,B.$imag())),O(_(te.real,B.$imag()),_(te.imag,B.$real()))):d(X("Numeric"),B)&&me(B["$real?"]())?H.$Complex(_(te.real,B),_(te.imag,B)):te.$__coerced__("*",B)}),x(L,"$/",function(B){var te=this;return d(X("Complex"),B)?d(X("Number"),te.real)&&me(te.real["$nan?"]())||d(X("Number"),te.imag)&&me(te.imag["$nan?"]())||d(X("Number"),B.$real())&&me(B.$real()["$nan?"]())||d(X("Number"),B.$imag())&&me(B.$imag()["$nan?"]())?X("Complex").$new(X(X("Float"),"NAN"),X(X("Float"),"NAN")):K(_(te,B.$conj()),B.$abs2()):d(X("Numeric"),B)&&me(B["$real?"]())?H.$Complex(te.real.$quo(B),te.imag.$quo(B)):te.$__coerced__("/",B)}),x(L,"$**",function(B){var te,D,fe=this,R=q,F=q,g=q,l=q,c=q,f=q,u=q,p=q,m=q,C=q,$=q;if(G(B,0))return X("Complex").$new(1,0);if(d(X("Complex"),B))return D=fe.$polar(),R=(te=A(D))[0]??q,F=te[1]??q,g=B.$real(),l=B.$imag(),c=X("Math").$exp(w(_(g,X("Math").$log(R)),_(l,F))),f=O(_(F,g),_(l,X("Math").$log(R))),X("Complex").$polar(c,f);if(d(X("Integer"),B)){if(me(U(B,0))){for(p=u=fe,m=w(B,1);N(m,0);){for(D=m.$divmod(2),C=(te=A(D))[0]??q,$=te[1]??q;G($,0);)u=H.$Complex(w(_(u.$real(),u.$real()),_(u.$imag(),u.$imag())),_(_(2,u.$real()),u.$imag())),D=(m=C).$divmod(2),C=(te=A(D))[0]??q,$=te[1]??q;p=_(p,u),m=w(m,1)}return p}return K(X("Rational").$new(1,1),fe)["$**"](B["$-@"]())}return d(X("Float"),B)||d(X("Rational"),B)?(D=fe.$polar(),R=(te=A(D))[0]??q,F=te[1]??q,X("Complex").$polar(R["$**"](B),_(F,B))):fe.$__coerced__("**",B)}),x(L,"$abs",function(){return X("Math").$hypot(this.real,this.imag)}),x(L,"$abs2",function(){var B=this;return O(_(B.real,B.real),_(B.imag,B.imag))}),x(L,"$angle",function(){return X("Math").$atan2(this.imag,this.real)}),x(L,"$conj",function(){return H.$Complex(this.real,this.imag["$-@"]())}),x(L,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())}),x(L,"$eql?",function(B){var D,fe;return me(D=me(fe=k("Complex")["$==="](B))?this.real.$class()["$=="](this.imag.$class()):fe)?this["$=="](B):D}),x(L,"$fdiv",function(B){return d(X("Numeric"),B)||H.$raise(X("TypeError"),B.$class()+" can't be coerced into Complex"),K(this,B)}),x(L,"$finite?",function(){var te;return me(te=this.real["$finite?"]())?this.imag["$finite?"]():te}),x(L,"$hash",function(){return"Complex:"+this.real+":"+this.imag}),x(L,"$infinite?",function(){var te;return me(te=this.real["$infinite?"]())?te:this.imag["$infinite?"]()}),x(L,"$inspect",function(){return"("+this+")"}),x(L,"$numerator",function(){var te,B=this;return te=B.$denominator(),H.$Complex(_(B.real.$numerator(),K(te,B.real.$denominator())),_(B.imag.$numerator(),K(te,B.imag.$denominator())))}),x(L,"$polar",function(){return[this.$abs(),this.$arg()]}),x(L,"$rationalize",function(B){var te=this;return arguments.length>1&&H.$raise(X("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),N(te.imag,0)&&H.$raise(X("RangeError"),"can't convert "+te+" into Rational"),te.$real().$rationalize(B)},-1),x(L,"$real?",Y(!1)),x(L,"$rect",function(){return[this.real,this.imag]}),x(L,"$to_f",function(){var B=this;return G(B.imag,0)||H.$raise(X("RangeError"),"can't convert "+B+" into Float"),B.real.$to_f()}),x(L,"$to_i",function(){var B=this;return G(B.imag,0)||H.$raise(X("RangeError"),"can't convert "+B+" into Integer"),B.real.$to_i()}),x(L,"$to_r",function(){var B=this;return G(B.imag,0)||H.$raise(X("RangeError"),"can't convert "+B+" into Rational"),B.real.$to_r()}),x(L,"$to_s",function(){var B=this,te=q;return te=B.real.$inspect(),te=O(te,d(X("Number"),B.imag)&&me(B.imag["$nan?"]())||me(B.imag["$positive?"]())||me(B.imag["$zero?"]())?"+":"-"),te=O(te,B.imag.$abs().$inspect()),d(X("Number"),B.imag)&&(me(B.imag["$nan?"]())||me(B.imag["$infinite?"]()))&&(te=O(te,"*")),O(te,"i")}),T(S[0],"I",L.$new(0,1)),J(L,"$from_string",function(B){var fe,R,te=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function g(){return te.test(B)}function l(){var u=B.match(te)[0];return B=B.slice(u.length),u.replace(/_/g,"")}function c(){if(g()){var f=parseFloat(l());if("/"===B[0]){if(B=B.slice(1),g()){var u=parseFloat(l());return H.$Rational(f,u)}return B="/"+B,f}return f}return null}return B.match(te),(fe=c())?(R=c())?H.$Complex(fe,R):"i"===B[0]?H.$Complex(0,fe):H.$Complex(fe,0):H.$Complex(0,"i"===B[0]?1:"-"===B[0]&&"i"===B[1]?-1:"+"===B[0]&&"i"===B[1]?1:0)}),j(E.get_singleton_class(L),"rectangular","rect"),j(L,"arg","angle"),j(L,"conjugate","conj"),j(L,"divide","/"),j(L,"imaginary","imag"),j(L,"magnitude","abs"),j(L,"phase","arg"),j(L,"quo","/"),j(L,"rectangular","rect"),E.udef(L,"$negative?"),E.udef(L,"$positive?"),E.udef(L,"$step"),q},Opal.modules["corelib/rational/base"]=function(E){var me=E.def,d=E.klass,J=E.$$$;return me((0,E.module)("::","Kernel"),"$Rational",function(w,K){return null==K&&(K=1),J("Rational").$convert(w,K)},-2),me(d("::",null,"String"),"$to_r",function(){return J("Rational").$from_string(this)})},Opal.modules["corelib/rational"]=function(E){var L,S,le=E.klass,me=E.eqeq,d=E.Kernel,H=E.truthy,J=E.rb_lt,_=E.rb_divide,x=E.defs,O=E.eqeqeq,w=E.not,K=E.Opal,G=E.def,A=E.return_ivar,U=E.rb_minus,N=E.rb_times,Y=E.rb_plus,T=E.rb_gt,j=E.rb_le,oe=E.return_self,z=E.alias,q=E.top,X=E.nil,M=E.$$$;return q.$require("corelib/numeric"),q.$require("corelib/rational/base"),(S=(L=le("::",M("Numeric"),"Rational")).$$prototype).num=S.den=X,x(L,"$reduce",function(v,P){var te;if(v=v.$to_i(),P=P.$to_i(),me(P,0))d.$raise(M("ZeroDivisionError"),"divided by 0");else if(H(J(P,0)))v=v["$-@"](),P=P["$-@"]();else if(me(P,1))return this.$new(v,P);return te=v.$gcd(P),this.$new(_(v,te),_(P,te))}),x(L,"$convert",function(v,P){return(H(v["$nil?"]())||H(P["$nil?"]()))&&d.$raise(M("TypeError"),"cannot convert nil into Rational"),O(M("Integer"),v)&&O(M("Integer"),P)?this.$reduce(v,P):((O(M("Float"),v)||O(M("String"),v)||O(M("Complex"),v))&&(v=v.$to_r()),(O(M("Float"),P)||O(M("String"),P)||O(M("Complex"),P))&&(P=P.$to_r()),H(P["$equal?"](1))&&w(M("Integer")["$==="](v))?K["$coerce_to!"](v,M("Rational"),"to_r"):O(M("Numeric"),v)&&O(M("Numeric"),P)?_(v,P):this.$reduce(v,P))}),G(L,"$initialize",function(v,P){var B=this;return B.num=v,B.den=P,B.$freeze()}),G(L,"$numerator",A("num")),G(L,"$denominator",A("den")),G(L,"$coerce",function(v){var B,P=this;return O(M("Rational"),B=v)?[v,P]:O(M("Integer"),B)?[v.$to_r(),P]:O(M("Float"),B)?[v,P.$to_f()]:X}),G(L,"$==",function(v){var B,P=this,te=X;return O(M("Rational"),B=v)?H(te=P.num["$=="](v.$numerator()))?P.den["$=="](v.$denominator()):te:O(M("Integer"),B)?H(te=P.num["$=="](v))?P.den["$=="](1):te:O(M("Float"),B)?P.$to_f()["$=="](v):v["$=="](P)}),G(L,"$<=>",function(v){var B,P=this;return O(M("Rational"),B=v)?U(N(P.num,v.$denominator()),N(P.den,v.$numerator()))["$<=>"](0):O(M("Integer"),B)?U(P.num,N(P.den,v))["$<=>"](0):O(M("Float"),B)?P.$to_f()["$<=>"](v):P.$__coerced__("<=>",v)}),G(L,"$+",function(v){var B,P=this,te=X,D=X;return O(M("Rational"),B=v)?(te=Y(N(P.num,v.$denominator()),N(P.den,v.$numerator())),D=N(P.den,v.$denominator()),d.$Rational(te,D)):O(M("Integer"),B)?d.$Rational(Y(P.num,N(v,P.den)),P.den):O(M("Float"),B)?Y(P.$to_f(),v):P.$__coerced__("+",v)}),G(L,"$-",function(v){var B,P=this,te=X,D=X;return O(M("Rational"),B=v)?(te=U(N(P.num,v.$denominator()),N(P.den,v.$numerator())),D=N(P.den,v.$denominator()),d.$Rational(te,D)):O(M("Integer"),B)?d.$Rational(U(P.num,N(v,P.den)),P.den):O(M("Float"),B)?U(P.$to_f(),v):P.$__coerced__("-",v)}),G(L,"$*",function(v){var B,P=this,te=X,D=X;return O(M("Rational"),B=v)?(te=N(P.num,v.$numerator()),D=N(P.den,v.$denominator()),d.$Rational(te,D)):O(M("Integer"),B)?d.$Rational(N(P.num,v),P.den):O(M("Float"),B)?N(P.$to_f(),v):P.$__coerced__("*",v)}),G(L,"$/",function(v){var B,P=this,te=X,D=X;return O(M("Rational"),B=v)?(te=N(P.num,v.$denominator()),D=N(P.den,v.$numerator()),d.$Rational(te,D)):O(M("Integer"),B)?me(v,0)?_(P.$to_f(),0):d.$Rational(P.num,N(P.den,v)):O(M("Float"),B)?_(P.$to_f(),v):P.$__coerced__("/",v)}),G(L,"$**",function(v){var B,P=this;return O(M("Integer"),B=v)?me(P,0)&&H(J(v,0))?M(M("Float"),"INFINITY"):H(T(v,0))?d.$Rational(P.num["$**"](v),P.den["$**"](v)):H(J(v,0))?d.$Rational(P.den["$**"](v["$-@"]()),P.num["$**"](v["$-@"]())):d.$Rational(1,1):O(M("Float"),B)?P.$to_f()["$**"](v):O(M("Rational"),B)?me(v,0)?d.$Rational(1,1):me(v.$denominator(),1)?H(J(v,0))?d.$Rational(P.den["$**"](v.$numerator().$abs()),P.num["$**"](v.$numerator().$abs())):d.$Rational(P.num["$**"](v.$numerator()),P.den["$**"](v.$numerator())):me(P,0)&&H(J(v,0))?d.$raise(M("ZeroDivisionError"),"divided by 0"):P.$to_f()["$**"](v):P.$__coerced__("**",v)}),G(L,"$abs",function(){return d.$Rational(this.num.$abs(),this.den.$abs())}),G(L,"$ceil",function(v){var P=this;return null==v&&(v=0),me(v,0)?_(P.num["$-@"](),P.den)["$-@"]().$ceil():P.$with_precision("ceil",v)},-1),G(L,"$floor",function(v){var P=this;return null==v&&(v=0),me(v,0)?_(P.num["$-@"](),P.den)["$-@"]().$floor():P.$with_precision("floor",v)},-1),G(L,"$hash",function(){return"Rational:"+this.num+":"+this.den}),G(L,"$inspect",function(){return"("+this+")"}),G(L,"$rationalize",function(v){var P=this;if(arguments.length>1&&d.$raise(M("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==v)return P;for(var l,c,f,u,p,B=v.$abs(),te=U(P,B),D=Y(P,B),fe=0,R=1,F=1,g=0;f=te.$ceil(),!j(f,D);)l=(u=f-1)*R+fe,c=u*g+F,p=_(1,U(D,u)),D=_(1,U(te,u)),te=p,fe=R,F=g,R=l,g=c;return d.$Rational(f*R+fe,f*g+F)},-1),G(L,"$round",function(v){var P=this,B=X,te=X,D=X;return null==v&&(v=0),me(v,0)?me(P.num,0)?0:me(P.den,1)?P.num:(B=Y(N(P.num.$abs(),2),P.den),te=N(P.den,2),D=_(B,te).$truncate(),H(J(P.num,0))?D["$-@"]():D):P.$with_precision("round",v)},-1),G(L,"$to_f",function(){return _(this.num,this.den)}),G(L,"$to_i",function(){return this.$truncate()}),G(L,"$to_r",oe),G(L,"$to_s",function(){return this.num+"/"+this.den}),G(L,"$truncate",function(v){var P=this;return null==v&&(v=0),me(v,0)?H(J(P.num,0))?P.$ceil():P.$floor():P.$with_precision("truncate",v)},-1),G(L,"$with_precision",function(v,P){var te,D=X;return O(M("Integer"),P)||d.$raise(M("TypeError"),"not an Integer"),te=10["$**"](P),D=N(this,te),H(J(P,1))?_(D.$send(v),te).$to_i():d.$Rational(D.$send(v),te)}),x(L,"$from_string",function(v){var D,fe,P=v.trimLeft(),B=/^[+-]?[\d_]+(\.[\d_]+)?/;function R(){return B.test(P)}function F(){var l=P.match(B)[0];return P=P.slice(l.length),l.replace(/_/g,"")}return P.match(B),R()?(D=parseFloat(F()),"/"===P[0]?(P=P.slice(1),R()?(fe=parseFloat(F()),d.$Rational(D,fe)):d.$Rational(D,1)):d.$Rational(D,1)):d.$Rational(0,1)}),z(L,"divide","/"),z(L,"quo","/")},Opal.modules["corelib/time"]=function(E){var le=E.slice,me=E.deny_frozen_access,d=E.klass,H=E.Kernel,J=E.Opal,_=E.defs,x=E.eqeqeq,O=E.def,w=E.truthy,K=E.rb_gt,G=E.rb_lt,A=E.send,U=E.rb_plus,N=E.rb_divide,Y=E.rb_minus,T=E.range,j=E.neqeq,oe=E.rb_le,z=E.eqeq,q=E.alias,I=E.nil,Q=E.$$$;return E.top.$require("corelib/comparable"),function(L,S,k){var v=d("::",S,"Time"),P=[v].concat([]),B=E.$r(P);v.$include(Q("Comparable"));var g,te=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],D=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],fe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],R=["January","February","March","April","May","June","July","August","September","October","November","December"];function F(g,l,c,f,u,p){if(g=g.$$is_string?parseInt(g,10):J["$coerce_to!"](g,Q("Integer"),"to_int"),l===I)l=1;else if(!l.$$is_number)if(l["$respond_to?"]("to_str"))switch(l=l.$to_str(),l.toLowerCase()){case"jan":l=1;break;case"feb":l=2;break;case"mar":l=3;break;case"apr":l=4;break;case"may":l=5;break;case"jun":l=6;break;case"jul":l=7;break;case"aug":l=8;break;case"sep":l=9;break;case"oct":l=10;break;case"nov":l=11;break;case"dec":l=12;break;default:l=l.$to_i()}else l=J["$coerce_to!"](l,Q("Integer"),"to_int");return(l<1||l>12)&&H.$raise(Q("ArgumentError"),"month out of range: "+l),l-=1,((c=c===I?1:c.$$is_string?parseInt(c,10):J["$coerce_to!"](c,Q("Integer"),"to_int"))<1||c>31)&&H.$raise(Q("ArgumentError"),"day out of range: "+c),((f=f===I?0:f.$$is_string?parseInt(f,10):J["$coerce_to!"](f,Q("Integer"),"to_int"))<0||f>24)&&H.$raise(Q("ArgumentError"),"hour out of range: "+f),((u=u===I?0:u.$$is_string?parseInt(u,10):J["$coerce_to!"](u,Q("Integer"),"to_int"))<0||u>59)&&H.$raise(Q("ArgumentError"),"min out of range: "+u),p===I?p=0:p.$$is_number||(p=p.$$is_string?parseInt(p,10):J["$coerce_to!"](p,Q("Integer"),"to_int")),(p<0||p>60)&&H.$raise(Q("ArgumentError"),"sec out of range: "+p),[g,l,c,f,u,p]}return _(v,"$at",function(l,c){var f;return Q("Time")["$==="](l)?(void 0!==c&&H.$raise(Q("TypeError"),"can't convert Time into an exact number"),(f=new Date(l.getTime())).timezone=l.timezone,f):(l.$$is_number||(l=J["$coerce_to!"](l,Q("Integer"),"to_int")),void 0===c?new Date(1e3*l):(c.$$is_number||(c=J["$coerce_to!"](c,Q("Integer"),"to_int")),new Date(1e3*l+c/1e3)))},-2),_(v,"$new",function(l,c,f,u,p,m,C){var re,se,Ee,Me;return null==c&&(c=I),null==f&&(f=I),null==u&&(u=I),null==p&&(p=I),null==m&&(m=I),null==C&&(C=I),void 0===l?new Date:(l=(re=F(l,c,f,u,p,m))[0],c=re[1],f=re[2],u=re[3],p=re[4],m=re[5],C===I?(se=new Date(l,c,f,u,p,0,1e3*m),l<100&&se.setFullYear(l),se):(Ee=this.$_parse_offset(C),Me=new Date(Date.UTC(l,c,f,u,p,0,1e3*m)),l<100&&Me.setUTCFullYear(l),(se=new Date(Me.getTime()-36e5*Ee)).timezone=Ee,se))},-1),_(v,"$_parse_offset",function(l){var c;return l.$$is_string?"UTC"==l?c=0:/^[+-]\d\d:[0-5]\d$/.test(l)?c=("-"==l[0]?-1:1)*(+(l[1]+l[2])+ +(l[4]+l[5])/60):H.$raise(Q("ArgumentError"),'"+HH:MM", "-HH:MM", "UTC" expected for utc_offset: '+l):l.$$is_number?c=l/3600:H.$raise(Q("ArgumentError"),"Opal doesn't support other types for a timezone argument than Integer and String"),c}),_(v,"$local",function(l,c,f,u,p,m,C,$,re,se){var Ee,Me;return null==c&&(c=I),null==f&&(f=I),null==u&&(u=I),null==p&&(p=I),null==m&&(m=I),null==C&&(C=I),null==$&&($=I),null==re&&(re=I),null==se&&(se=I),10===arguments.length&&(l=(Ee=le(arguments))[5],c=Ee[4],f=Ee[3],u=Ee[2],p=Ee[1],m=Ee[0]),l=(Ee=F(l,c,f,u,p,m))[0],c=Ee[1],f=Ee[2],u=Ee[3],p=Ee[4],m=Ee[5],Me=new Date(l,c,f,u,p,0,1e3*m),l<100&&Me.setFullYear(l),Me},-2),_(v,"$gm",function(l,c,f,u,p,m,C,$,re,se){var Ee,Me;return null==c&&(c=I),null==f&&(f=I),null==u&&(u=I),null==p&&(p=I),null==m&&(m=I),null==C&&(C=I),null==$&&($=I),null==re&&(re=I),null==se&&(se=I),10===arguments.length&&(l=(Ee=le(arguments))[5],c=Ee[4],f=Ee[3],u=Ee[2],p=Ee[1],m=Ee[0]),l=(Ee=F(l,c,f,u,p,m))[0],c=Ee[1],f=Ee[2],u=Ee[3],p=Ee[4],m=Ee[5],Me=new Date(Date.UTC(l,c,f,u,p,0,1e3*m)),l<100&&Me.setUTCFullYear(l),Me.timezone=0,Me},-2),_(v,"$now",function(){return this.$new()}),O(v,"$+",function(l){x(Q("Time"),l)&&H.$raise(Q("TypeError"),"time + time?"),l.$$is_number||(l=J["$coerce_to!"](l,Q("Integer"),"to_int"));var f=new Date(this.getTime()+1e3*l);return f.timezone=this.timezone,f}),O(v,"$-",function(l){var c=this;if(x(Q("Time"),l))return(c.getTime()-l.getTime())/1e3;l.$$is_number||(l=J["$coerce_to!"](l,Q("Integer"),"to_int"));var f=new Date(c.getTime()-1e3*l);return f.timezone=c.timezone,f}),O(v,"$<=>",function(l){var f=I;return x(Q("Time"),l)?this.$to_f()["$<=>"](l.$to_f()):(f=l["$<=>"](this),w(f["$nil?"]())?I:w(K(f,0))?-1:w(G(f,0))?1:0)}),O(v,"$==",function(l){var f;return w(f=Q("Time")["$==="](l))?this.$to_f()===l.$to_f():f}),O(v,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")}),A([["year","getFullYear","getUTCFullYear"],["mon","getMonth","getUTCMonth",1],["wday","getDay","getUTCDay"],["day","getDate","getUTCDate"],["hour","getHours","getUTCHours"],["min","getMinutes","getUTCMinutes"],["sec","getSeconds","getUTCSeconds"]],"each",[],function g(l,c,f,u){var p=g.$$s??this;return null==l&&(l=I),null==c&&(c=I),null==f&&(f=I),null==u&&(u=0),A(p,"define_method",[l],function m(){var C=m.$$s??this;return u+(null!=C.timezone?new Date(C.getTime()+36e5*C.timezone)[f]():C[c]())},{$$s:p})},{$$arity:-4,$$s:v}),O(v,"$yday",function(){var c,f,l=this;return c=B("Time").$new(l.$year()).$to_i(),f=B("Time").$new(l.$year(),l.$month(),l.$day()).$to_i(),U(N(Y(f,c),86400).$round(),1)}),O(v,"$isdst",function(){var l=this,c=new Date(l.getFullYear(),0,1),f=new Date(l.getFullYear(),6,1);return l.getTimezoneOffset()<Math.max(c.getTimezoneOffset(),f.getTimezoneOffset())}),O(v,"$dup",function(){var l=this,c=I;return(c=new Date(l.getTime())).$copy_instance_variables(l),c.$initialize_dup(l),c}),O(v,"$eql?",function(l){var f;return w(f=l["$is_a?"](Q("Time")))?this["$<=>"](l)["$zero?"]():f}),A([["sunday?",0],["monday?",1],["tuesday?",2],["wednesday?",3],["thursday?",4],["friday?",5],["saturday?",6]],"each",[],function g(l,c){var f=g.$$s??this;return null==l&&(l=I),null==c&&(c=I),A(f,"define_method",[l],function u(){return(u.$$s??this).$wday()===c},{$$s:f})},{$$s:v}),O(v,"$hash",function(){return"Time:"+this.getTime()}),O(v,"$inspect",function(){var l=this;return w(l["$utc?"]())?l.$strftime("%Y-%m-%d %H:%M:%S UTC"):l.$strftime("%Y-%m-%d %H:%M:%S %z")}),O(v,"$succ",function(){var c=new Date(this.getTime()+1e3);return c.timezone=this.timezone,c}),O(v,"$usec",function(){return 1e3*this.getMilliseconds()}),O(v,"$zone",function(){var l=this;if(0===l.timezone)return"UTC";if(null!=l.timezone)return I;var f,c=l.toString();return"GMT"==(f=-1==c.indexOf("(")?c.match(/[A-Z]{3,4}/)[0]:c.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(c)?RegExp.$1:f}),O(v,"$getgm",function(){var c=new Date(this.getTime());return c.timezone=0,c}),O(v,"$gmtime",function(){var l=this;return 0!==l.timezone&&(me(l),l.timezone=0),l}),O(v,"$gmt?",function(){return 0===this.timezone}),O(v,"$gmt_offset",function(){var l=this;return null!=l.timezone?60*l.timezone:60*-l.getTimezoneOffset()}),O(v,"$strftime",function(l){var c=this;return l.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(f,u,p,m,C){var re,se,Ee,$="",Me=-1!==u.indexOf("0"),ce=-1===u.indexOf("-"),ke=-1!==u.indexOf("_"),ve=-1!==u.indexOf("^"),ye=-1!==u.indexOf("#"),he=(u.match(":")||[]).length;switch(p=parseInt(p,10),Me&&ke&&(u.indexOf("0")<u.indexOf("_")?Me=!1:ke=!1),C){case"Y":$+=c.$year();break;case"C":Me=!ke,$+=Math.round(c.$year()/100);break;case"y":Me=!ke,$+=c.$year()%100;break;case"m":Me=!ke,$+=c.$mon();break;case"B":$+=R[c.$mon()-1];break;case"b":case"h":ke=!Me,$+=fe[c.$mon()-1];break;case"d":Me=!ke,$+=c.$day();break;case"e":ke=!Me,$+=c.$day();break;case"j":Me=!ke,p=isNaN(p)?3:p,$+=c.$yday();break;case"H":Me=!ke,$+=c.$hour();break;case"k":ke=!Me,$+=c.$hour();break;case"I":Me=!ke,$+=c.$hour()%12||12;break;case"l":ke=!Me,$+=c.$hour()%12||12;break;case"P":$+=c.$hour()>=12?"pm":"am";break;case"p":$+=c.$hour()>=12?"PM":"AM";break;case"M":Me=!ke,$+=c.$min();break;case"S":Me=!ke,$+=c.$sec();break;case"L":Me=!ke,p=isNaN(p)?3:p,$+=c.getMilliseconds();break;case"N":p=isNaN(p)?9:p,$=($+=c.getMilliseconds().toString().$rjust(3,"0")).$ljust(p,"0");break;case"z":var Ie=null==c.timezone?c.getTimezoneOffset():60*-c.timezone,be=Math.floor(Math.abs(Ie)/60),ae=Math.abs(Ie)%60;$+=Ie<0?"+":"-",$+=be<10?"0":"",$+=be,he>0&&($+=":"),$+=ae<10?"0":"",$+=ae,he>1&&($+=":00");break;case"Z":$+=c.$zone();break;case"A":$+=te[c.$wday()];break;case"a":$+=D[c.$wday()];break;case"u":$+=c.$wday()+1;break;case"w":$+=c.$wday();break;case"V":$+=c.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":$+=c.$cweek_cyear()["$[]"](1);break;case"g":$+=c.$cweek_cyear()["$[]"](1)["$[]"](T(-2,-1,!1));break;case"s":$+=c.$to_i();break;case"n":$+="\n";break;case"t":$+="\t";break;case"%":$+="%";break;case"c":$+=c.$strftime("%a %b %e %T %Y");break;case"D":case"x":$+=c.$strftime("%m/%d/%y");break;case"F":$+=c.$strftime("%Y-%m-%d");break;case"v":$+=c.$strftime("%e-%^b-%4Y");break;case"r":$+=c.$strftime("%I:%M:%S %p");break;case"R":$+=c.$strftime("%H:%M");break;case"T":case"X":$+=c.$strftime("%H:%M:%S");break;case"J":if((re=c.$to_date().$jd())<2405160){$+=c.$strftime("%Y-%m-%d");break}re<2419614?(se="M",Ee=1867):re<2424875?(se="T",Ee=1911):re<2447535?(se="S",Ee=1925):re<2458605?(se="H",Ee=1988):(se="R",Ee=2018),$+=c.$format("%c%02d",se,Y(c.$year(),Ee)),$+=c.$strftime("-%m-%d");break;default:return f}return ve&&($=$.toUpperCase()),ye&&($=$.replace(/[A-Z]/,function(ue){ue.toLowerCase()}).replace(/[a-z]/,function(ue){ue.toUpperCase()})),ce&&(Me||ke)&&($=$.$rjust(isNaN(p)?2:p,ke?" ":"0")),$})}),O(v,"$to_a",function(){var l=this;return[l.$sec(),l.$min(),l.$hour(),l.$day(),l.$month(),l.$year(),l.$wday(),l.$yday(),l.$isdst(),l.$zone()]}),O(v,"$to_f",function(){return this.getTime()/1e3}),O(v,"$to_i",function(){return parseInt(this.getTime()/1e3,10)}),O(v,"$cweek_cyear",function(){var f,l=this,p=I,m=I,C=I,re=I;return f=Q("Time").$new(l.$year(),1,1).$wday(),p=l.$year(),w(oe(f,4))&&j(f,0)?m=Y(f,1):(m=Y(Y(f,7),1),z(m,-8)&&(m=-1)),C=N(U(l.$yday(),m),7).$ceil(),w(oe(C,0))?Q("Time").$new(Y(l.$year(),1),12,31).$cweek_cyear():(z(C,53)&&(re=Q("Time").$new(l.$year(),12,31).$wday(),w(oe(re,3))&&j(re,0)&&(C=1,p=U(p,1))),[C,p])}),g=E.get_singleton_class(v),q(g,"mktime","local"),q(g,"utc","gm"),q(v,"ctime","asctime"),q(v,"dst?","isdst"),q(v,"getutc","getgm"),q(v,"gmtoff","gmt_offset"),q(v,"mday","day"),q(v,"month","mon"),q(v,"to_s","inspect"),q(v,"tv_sec","to_i"),q(v,"tv_usec","usec"),q(v,"utc","gmtime"),q(v,"utc?","gmt?"),q(v,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(E){var le=E.klass,me=E.slice,d=E.extract_kwargs,H=E.ensure_kwargs,J=E.truthy,_=E.neqeq,x=E.eqeq,O=E.Opal,w=E.send,K=E.Class,G=E.to_a,A=E.def,U=E.defs,N=E.Kernel,Y=E.hash2,T=E.rb_gt,j=E.rb_minus,oe=E.eqeqeq,z=E.rb_lt,q=E.rb_ge,X=E.rb_plus,M=E.alias,L=E.nil,S=E.$$$;return E.top.$require("corelib/enumerable"),function(k,v,P){var B=le("::",null,"Struct"),te=[B].concat([]),D=E.$r(te);B.$include(S("Enumerable")),U(B,"$new",function R(F,g,l){var f,u,p,m,c=R.$$p||L,C=this,$=L;if(R.$$p=null,f=me(arguments,1),u=d(f),u=H(u),p=f,null==(m=u.$$smap.keyword_init)&&(m=!1),J(F))if(x(F.$class(),S("String"))&&_(F["$[]"](0).$upcase(),F["$[]"](0)))p.$unshift(F),F=L;else try{F=O["$const_name!"](F)}catch(re){if(!E.rescue(re,[S("TypeError"),S("NameError")]))throw re;try{p.$unshift(F),F=L}finally{E.pop_exception()}}return w(p,"map",[],function(se){return null==se&&(se=L),O["$coerce_to!"](se,S("String"),"to_str")}),$=w(K,"new",[C],function re(){var Ee,se=re.$$s??this;return w(p,"each",[],function Ee(Me){return null==Me&&(Me=L),(Ee.$$s??this).$define_struct_attribute(Me)},{$$s:se}),Ee=E.get_singleton_class(se),A(Ee,"$new",function(ke){var ye,he=this,Ie=L;return ye=me(arguments),(Ie=he.$allocate()).$$data={},w(Ie,"initialize",G(ye)),Ie},-1),Ee.$alias_method("[]","new")},{$$s:C}),J(c)&&w($,"module_eval",[],c.$to_proc()),$.$$keyword_init=m,J(F)&&S("Struct").$const_set(F,$),$},-2),U(B,"$define_struct_attribute",function(F){var g=this;return x(g,S("Struct"))&&N.$raise(S("ArgumentError"),"you cannot define attributes to the Struct class"),g.$members()["$<<"](F),w(g,"define_method",[F],function l(){return(l.$$s??this).$$data[F]},{$$s:g}),w(g,"define_method",[F+"="],function l(c){return null==c&&(c=L),(l.$$s??this).$$data[F]=c},{$$s:g})}),U(B,"$members",function(){var g,F=this;return null==F.members&&(F.members=L),x(F,S("Struct"))&&N.$raise(S("ArgumentError"),"the Struct class has no members"),F.members=J(g=F.members)?g:[]}),U(B,"$inherited",function(F){var l,g=this;return null==g.members&&(g.members=L),l=g.members,w(F,"instance_eval",[],function c(){return(c.$$s??this).members=l},{$$s:g})}),A(B,"$initialize",function(F){var g,l,c=this,f=L,u=L,p=L;return g=me(arguments),l=g,J(c.$class().$$keyword_init)?(f=J(u=l.$last())?u:Y([],{}),(J(T(l.$length(),1))||J(1===l.length&&!f.$$is_hash))&&N.$raise(S("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),p=j(f.$keys(),c.$class().$members()),J(p["$any?"]())&&N.$raise(S("ArgumentError"),"unknown keywords: "+p.$join(", ")),w(c.$class().$members(),"each",[],function m(C){var $,re=m.$$s??this;return null==C&&(C=L),$=[C,f["$[]"](C)],w(re,"[]=",$),$[$.length-1]},{$$s:c})):(J(T(l.$length(),c.$class().$members().$length()))&&N.$raise(S("ArgumentError"),"struct size differs"),w(c.$class().$members(),"each_with_index",[],function m(C,$){var re,se=m.$$s??this;return null==C&&(C=L),null==$&&($=L),re=[C,l["$[]"]($)],w(se,"[]=",re),re[re.length-1]},{$$s:c}))},-1),A(B,"$initialize_copy",function(F){this.$$data={};var c,f,u,l=Object.keys(F.$$data);for(c=0,f=l.length;c<f;c++)this.$$data[u=l[c]]=F.$$data[u]}),U(B,"$keyword_init?",function(){return this.$$keyword_init}),A(B,"$members",function(){return this.$class().$members()}),A(B,"$hash",function(){return D("Hash").$new(this.$$data).$hash()}),A(B,"$[]",function(F){var g=this;return oe(S("Integer"),F)?(J(z(F,g.$class().$members().$size()["$-@"]()))&&N.$raise(S("IndexError"),"offset "+F+" too small for struct(size:"+g.$class().$members().$size()+")"),J(q(F,g.$class().$members().$size()))&&N.$raise(S("IndexError"),"offset "+F+" too large for struct(size:"+g.$class().$members().$size()+")"),F=g.$class().$members()["$[]"](F)):oe(S("String"),F)?g.$$data.hasOwnProperty(F)||N.$raise(S("NameError").$new("no member '"+F+"' in struct",F)):N.$raise(S("TypeError"),"no implicit conversion of "+F.$class()+" into Integer"),F=O["$coerce_to!"](F,S("String"),"to_str"),g.$$data[F]}),A(B,"$[]=",function(F,g){var l=this;return oe(S("Integer"),F)?(J(z(F,l.$class().$members().$size()["$-@"]()))&&N.$raise(S("IndexError"),"offset "+F+" too small for struct(size:"+l.$class().$members().$size()+")"),J(q(F,l.$class().$members().$size()))&&N.$raise(S("IndexError"),"offset "+F+" too large for struct(size:"+l.$class().$members().$size()+")"),F=l.$class().$members()["$[]"](F)):oe(S("String"),F)?J(l.$class().$members()["$include?"](F.$to_sym()))||N.$raise(S("NameError").$new("no member '"+F+"' in struct",F)):N.$raise(S("TypeError"),"no implicit conversion of "+F.$class()+" into Integer"),F=O["$coerce_to!"](F,S("String"),"to_str"),l.$$data[F]=g}),A(B,"$==",function(F){if(!J(F["$instance_of?"](this.$class())))return!1;var l={},c={};return function f(u,p){var m,C,$;for(m in l[u.$__id__()]=!0,c[p.$__id__()]=!0,u.$$data)if(C=u.$$data[m],$=p.$$data[m],S("Struct")["$==="](C)){if(!(l.hasOwnProperty(C.$__id__())&&c.hasOwnProperty($.$__id__())||f(C,$)))return!1}else if(!C["$=="]($))return!1;return!0}(this,F)}),A(B,"$eql?",function(F){if(!J(F["$instance_of?"](this.$class())))return!1;var l={},c={};return function f(u,p){var m,C,$;for(m in l[u.$__id__()]=!0,c[p.$__id__()]=!0,u.$$data)if(C=u.$$data[m],$=p.$$data[m],S("Struct")["$==="](C)){if(!(l.hasOwnProperty(C.$__id__())&&c.hasOwnProperty($.$__id__())||f(C,$)))return!1}else if(!C["$eql?"]($))return!1;return!0}(this,F)}),A(B,"$each",function R(){var F=R.$$p||L,g=this;return R.$$p=null,F===L?w(g,"enum_for",["each"],function l(){return(l.$$s??this).$size()},{$$s:g}):(w(g.$class().$members(),"each",[],function l(c){return null==c&&(c=L),E.yield1(F,(l.$$s??this)["$[]"](c))},{$$s:g}),g)}),A(B,"$each_pair",function R(){var F=R.$$p||L,g=this;return R.$$p=null,F===L?w(g,"enum_for",["each_pair"],function l(){return(l.$$s??this).$size()},{$$s:g}):(w(g.$class().$members(),"each",[],function l(c){return null==c&&(c=L),E.yield1(F,[c,(l.$$s??this)["$[]"](c)])},{$$s:g}),g)}),A(B,"$length",function(){return this.$class().$members().$length()}),A(B,"$to_a",function(){return w(this.$class().$members(),"map",[],function g(l){return null==l&&(l=L),(g.$$s??this)["$[]"](l)},{$$s:this})});var fe=[];return A(B,"$inspect",function(){var F=this,g=L,l=L;return function(){try{return g="#<struct ",J(fe["$include?"](F.$__id__()))?X(g,":...>"):(fe["$<<"](F.$__id__()),l=!0,oe(S("Struct"),F)&&J(F.$class().$name())&&(g=X(g,F.$class()+" ")),g=X(g,w(F.$each_pair(),"map",[],function(f,u){return null==f&&(f=L),null==u&&(u=L),f+"="+D("Opal").$inspect(u)}).$join(", ")),g=X(g,">"))}finally{J(l)&&fe.pop()}}()}),A(B,"$to_h",function R(){var F=R.$$p||L,g=this;return R.$$p=null,F!==L?w(w(g,"map",[],F.$to_proc()),"to_h",G(g.$args())):w(g.$class().$members(),"each_with_object",[Y([],{})],function l(c,f){var u;return null==c&&(c=L),null==f&&(f=L),u=[c,(l.$$s??this)["$[]"](c)],w(f,"[]=",u),u[u.length-1]},{$$s:g})}),A(B,"$values_at",function(F){var g,l,c=this;g=me(arguments);for(var f=[],u=0,p=(l=w(l=g,"map",[],function(C){return null==C&&(C=L),C.$$is_range?C.$to_a():C}).$flatten()).length;u<p;u++)l[u].$$is_number||N.$raise(S("TypeError"),"no implicit conversion of "+l[u].$class()+" into Integer"),f.push(c["$[]"](l[u]));return f},-1),A(B,"$dig",function(F,g){var c,f=this,u=L;return c=me(arguments,1),(u=J(F.$$is_string&&f.$$data.hasOwnProperty(F))&&f.$$data[F]||L)===L||0===c.length?u:(J(u["$respond_to?"]("dig"))||N.$raise(S("TypeError"),u.$class()+" does not have #dig method"),w(u,"dig",G(c)))},-2),M(B,"size","length"),M(B,"to_s","inspect"),M(B,"values","to_a")}()},Opal.modules["corelib/set"]=function(E){var le=E.freeze,me=E.klass,d=E.slice,H=E.defs,J=E.hash2,_=E.truthy,x=E.eqeqeq,O=E.Kernel,w=E.send,K=E.def,G=E.eqeq,A=E.rb_lt,U=E.rb_le,N=E.alias,T=E.nil,j=E.$$$;return function(oe,z,q){var X=me("::",null,"Set"),M=[X].concat([]),I=E.$r(M);function S(k){_(k["$is_a?"](j("Set")))||O.$raise(j("ArgumentError"),"value must be a set")}return X.$$prototype.hash=T,X.$include(j("Enumerable")),H(X,"$[]",function(v){var P,te=this;return P=d(arguments),te.$new(P)},-1),K(X,"$initialize",function k(v){var P=k.$$p||T,B=this;return k.$$p=null,null==v&&(v=T),B.hash=J([],{}),_(v["$nil?"]())?T:(x(j("Enumerable"),v)||O.$raise(j("ArgumentError"),"value must be enumerable"),_(P)?w(v,"each",[],function te(D){return null==D&&(D=T),(te.$$s??this).$add(E.yield1(P,D))},{$$s:B}):B.$merge(v))},-1),K(X,"$dup",function(){return this.$class().$new().$merge(this)}),K(X,"$-",function(v){return _(v["$respond_to?"]("each"))||O.$raise(j("ArgumentError"),"value must be enumerable"),this.$dup().$subtract(v)}),K(X,"$inspect",function(){return"#<Set: {"+this.$to_a().$join(",")+"}>"}),K(X,"$==",function(v){var P=this;return!!_(P["$equal?"](v))||(_(v["$instance_of?"](P.$class()))?P.hash["$=="](v.$instance_variable_get("@hash")):!(!_(v["$is_a?"](j("Set")))||!G(P.$size(),v.$size()))&&w(v,"all?",[],function B(te){var D=B.$$s??this;return null==D.hash&&(D.hash=T),null==te&&(te=T),D.hash["$include?"](te)},{$$s:P}))}),K(X,"$add",function(v){return this.hash["$[]="](v,!0),this}),K(X,"$classify",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("classify"):(B=w(j("Hash"),"new",[],function te(D,fe){var R;return null==D&&(D=T),null==fe&&(fe=T),R=[fe,(te.$$s??this).$class().$new()],w(D,"[]=",R),R[R.length-1]},{$$s:P}),w(P,"each",[],function(D){return null==D&&(D=T),B["$[]"](E.yield1(v,D)).$add(D)}),B)}),K(X,"$collect!",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("collect!"):(B=P.$class().$new(),w(P,"each",[],function(D){return null==D&&(D=T),B["$<<"](E.yield1(v,D))}),P.$replace(B))}),K(X,"$compare_by_identity",function(){var v=this;return _(v.hash["$respond_to?"]("compare_by_identity"))?(v.hash.$compare_by_identity(),v):v.$raise(I("NotImplementedError"),v.$class().$name()+"#compare_by_identity is not implemented")}),K(X,"$compare_by_identity?",function(){var P;return _(P=this.hash["$respond_to?"]("compare_by_identity?"))?this.hash["$compare_by_identity?"]():P}),K(X,"$delete",function(v){return this.hash.$delete(v),this}),K(X,"$delete?",function(v){var P=this;return _(P["$include?"](v))?(P.$delete(v),P):T}),K(X,"$delete_if",function k(){var v=k.$$p||T,P=this;return k.$$p=null,v===T?P.$enum_for("delete_if"):(w(w(P,"select",[],function(te){return null==te&&(te=T),E.yield1(v,te)}),"each",[],function B(te){var D=B.$$s??this;return null==D.hash&&(D.hash=T),null==te&&(te=T),D.hash.$delete(te)},{$$s:P}),P)}),K(X,"$freeze",function(){var v=this;return _(v["$frozen?"]())?v:(v.hash.$freeze(),le(v))}),K(X,"$keep_if",function k(){var v=k.$$p||T,P=this;return k.$$p=null,v===T?P.$enum_for("keep_if"):(w(w(P,"reject",[],function(te){return null==te&&(te=T),E.yield1(v,te)}),"each",[],function B(te){var D=B.$$s??this;return null==D.hash&&(D.hash=T),null==te&&(te=T),D.hash.$delete(te)},{$$s:P}),P)}),K(X,"$reject!",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("reject!"):(B=P.$size(),w(P,"delete_if",[],v.$to_proc()),G(P.$size(),B)?T:P)}),K(X,"$select!",function k(){var v=k.$$p||T,P=this,B=T;return k.$$p=null,v===T?P.$enum_for("select!"):(B=P.$size(),w(P,"keep_if",[],v.$to_proc()),G(P.$size(),B)?T:P)}),K(X,"$add?",function(v){return _(this["$include?"](v))?T:this.$add(v)}),K(X,"$each",function k(){var v=k.$$p||T,P=this;return k.$$p=null,v===T?P.$enum_for("each"):(w(P.hash,"each_key",[],v.$to_proc()),P)}),K(X,"$empty?",function(){return this.hash["$empty?"]()}),K(X,"$eql?",function(v){return this.hash["$eql?"](w(v,"instance_eval",[],function B(){var te=B.$$s??this;return null==te.hash&&(te.hash=T),te.hash},{$$s:this}))}),K(X,"$clear",function(){return this.hash.$clear(),this}),K(X,"$include?",function(v){return this.hash["$include?"](v)}),K(X,"$merge",function(v){return w(v,"each",[],function B(te){return null==te&&(te=T),(B.$$s??this).$add(te)},{$$s:this}),this}),K(X,"$replace",function(v){var P=this;return P.$clear(),P.$merge(v),P}),K(X,"$size",function(){return this.hash.$size()}),K(X,"$subtract",function(v){return w(v,"each",[],function B(te){return null==te&&(te=T),(B.$$s??this).$delete(te)},{$$s:this}),this}),K(X,"$|",function(v){return _(v["$respond_to?"]("each"))||O.$raise(j("ArgumentError"),"value must be enumerable"),this.$dup().$merge(v)}),K(X,"$superset?",function(v){return S(v),!_(A(this.$size(),v.$size()))&&w(v,"all?",[],function B(te){return null==te&&(te=T),(B.$$s??this)["$include?"](te)},{$$s:this})}),K(X,"$proper_superset?",function(v){return S(v),!_(U(this.$size(),v.$size()))&&w(v,"all?",[],function B(te){return null==te&&(te=T),(B.$$s??this)["$include?"](te)},{$$s:this})}),K(X,"$subset?",function(v){return S(v),!_(A(v.$size(),this.$size()))&&w(this,"all?",[],function(te){return null==te&&(te=T),v["$include?"](te)})}),K(X,"$proper_subset?",function(v){return S(v),!_(U(v.$size(),this.$size()))&&w(this,"all?",[],function(te){return null==te&&(te=T),v["$include?"](te)})}),K(X,"$intersect?",function(v){var P=this;return S(v),_(A(P.$size(),v.$size()))?w(P,"any?",[],function(te){return null==te&&(te=T),v["$include?"](te)}):w(v,"any?",[],function B(te){return null==te&&(te=T),(B.$$s??this)["$include?"](te)},{$$s:P})}),K(X,"$disjoint?",function(v){return this["$intersect?"](v)["$!"]()}),K(X,"$to_a",function(){return this.hash.$keys()}),N(X,"+","|"),N(X,"<","proper_subset?"),N(X,"<<","add"),N(X,"<=","subset?"),N(X,">","proper_superset?"),N(X,">=","superset?"),N(X,"difference","-"),N(X,"filter!","select!"),N(X,"length","size"),N(X,"map!","collect!"),N(X,"member?","include?"),N(X,"union","|")}()},Opal.modules["corelib/dir"]=function(E){var U,G,me=E.def,d=E.truthy,H=E.alias,_=E.nil,x=E.$$$;return[G=(0,E.klass)("::",null,"Dir")].concat([]),U=E.get_singleton_class(G),me(U,"$chdir",function Y(T){var j=Y.$$p||_,oe=_;return Y.$$p=null,function(){try{return oe=E.current_dir,E.current_dir=T,E.yieldX(j,[])}finally{E.current_dir=oe}}()}),me(U,"$pwd",function(){return E.current_dir||"."}),me(U,"$home",function(){var T;return d(T=x("ENV")["$[]"]("HOME"))?T:"."}),H(U,"getwd","pwd")},Opal.modules["corelib/file"]=function(E){var X,M,I,Q,le=E.truthy,d=E.const_set,H=E.Opal,J=E.regexp,_=E.rb_plus,x=E.def,O=E.Kernel,w=E.eqeq,K=E.rb_lt,G=E.rb_minus,A=E.range,U=E.send,N=E.slice,Y=E.alias,j=E.nil,oe=E.$$$;return X=[],I=[M=(0,E.klass)("::",oe("IO"),"File")].concat(X),Q=j,d(I[0],"Separator",d(I[0],"SEPARATOR","/")),d(I[0],"ALT_SEPARATOR",j),d(I[0],"PATH_SEPARATOR",":"),d(I[0],"FNM_SYSCASE",0),Q=/^[a-zA-Z]:(?:\\|\/)/,function(L,S){var k=[L].concat(S),v=E.$r(k);function P(te){return le(te["$respond_to?"]("to_path"))&&(te=te.$to_path()),H["$coerce_to!"](te,oe("String"),"to_str")}function B(){return v("ALT_SEPARATOR")===j?E.escape_regexp(v("SEPARATOR")):E.escape_regexp(_(v("SEPARATOR"),v("ALT_SEPARATOR")))}return x(L,"$absolute_path",function(D,fe){var R,F,l,c,f,g=j,u=j,p=j,m=j,C=j;null==fe&&(fe=j),R=v("SEPARATOR"),F=B(),g=[],D=le(D["$respond_to?"]("to_path"))?D.$to_path():D,D=H["$coerce_to!"](D,oe("String"),"to_str"),fe=le(l=fe)?l:oe("Dir").$pwd(),c=D.substr(0,R.length)===R||Q.test(D),f=fe.substr(0,R.length)===R||Q.test(fe),le(c)?(u=D.$split(J(["[",F,"]"])),p=Q.test(D)?"":D.$sub(J(["^([",F,"]+).*$"]),"\\1"),m=!0):(u=_(fe.$split(J(["[",F,"]"])),D.$split(J(["[",F,"]"]))),p=Q.test(fe)?"":fe.$sub(J(["^([",F,"]+).*$"]),"\\1"),m=f);for(var $,re=0,se=u.length;re<se;re++)($=u[re])!==j&&(""!==$||0!==g.length&&!m)&&("."!==$||0!==g.length&&!m)&&(".."===$?g.pop():g.push($));return!m&&"."!==u[0]&&g.$unshift("."),C=g.$join(R),le(m)&&(C=_(p,C)),C},-2),x(L,"$expand_path",function(D,fe){var F,g,l=j,c=j,f=j;return null==fe&&(fe=j),F=v("SEPARATOR"),g=B(),le("~"===D[0]||fe&&"~"===fe[0])&&(l=v("Dir").$home(),le(l)||O.$raise(oe("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),c=Q.test(l)?"":l.$sub(J(["^([",g,"]+).*$"]),"\\1"),le(l["$start_with?"](c))||O.$raise(oe("ArgumentError"),"non-absolute home"),l=_(l,F),f=J(["^\\~(?:",F,"|$)"]),D=D.$sub(f,l),le(fe)&&(fe=fe.$sub(f,l))),this.$absolute_path(D,fe)},-2),x(L,"$dirname",function(D,fe){var F;if(null==fe&&(fe=1),w(fe,0))return D;le(K(fe,0))&&O.$raise(oe("ArgumentError"),"level can't be negative"),F=B();var l,g=(D=P(D)).match(new RegExp("^["+F+"]"));return l=""===(D=(D=(D=D.replace(new RegExp("["+F+"]+$"),"")).replace(new RegExp("[^"+F+"]+$"),"")).replace(new RegExp("["+F+"]+$"),""))?g?"/":".":D,1==fe?l:this.$dirname(l,G(fe,1))},-2),x(L,"$basename",function(D,fe){var R;return null==fe&&(fe=j),R=B(),0==(D=P(D)).length||(fe=fe!==j?H["$coerce_to!"](fe,oe("String"),"to_str"):null,D=(D=D.replace(new RegExp("(.)["+R+"]*$"),"$1")).replace(new RegExp("^(?:.*["+R+"])?([^"+R+"]+)$"),"$1"),".*"===fe?D=D.replace(/\.[^\.]+$/,""):null!==fe&&(fe=E.escape_regexp(fe),D=D.replace(new RegExp(fe+"$"),""))),D},-2),x(L,"$extname",function(D){var R=j,F=j;return D=P(D),R=this.$basename(D),le(R["$empty?"]())||(F=R["$[]"](A(1,-1,!1)).$rindex("."),le(F["$nil?"]())||w(_(F,1),G(R.$length(),1)))?"":R["$[]"](E.Range.$new(_(F,1),-1,!1))}),x(L,"$exist?",function(D){return null!=E.modules[D]}),x(L,"$directory?",function(D){var fe=j;for(var R in fe=[],E.modules)fe.push(R);return D=D.$gsub(J(["(^.",v("SEPARATOR"),"+|",v("SEPARATOR"),"+$)"])),U(fe,"find",[],function(g){return null==g&&(g=j),g["$=~"](J(["^",D]))})}),x(L,"$join",function(D){var fe,R,F=j;return fe=N(arguments),le((R=fe)["$empty?"]())?"":(F="",R=U(R.$flatten().$each_with_index(),"map",[],function(l,c){return null==l&&(l=j),null==c&&(c=j),w(c,0)&&le(l["$empty?"]())||w(R.$length(),_(c,1))&&le(l["$empty?"]())?v("SEPARATOR"):l}),R=U(R,"reject",[],"empty?".$to_proc()),U(R,"each_with_index",[],function(l,c){var f=j;return null==l&&(l=j),null==c&&(c=j),f=R["$[]"](_(c,1)),le(f["$nil?"]())?F=""+F+l:(le(l["$end_with?"](v("SEPARATOR")))&&le(f["$start_with?"](v("SEPARATOR")))&&(l=l.$sub(J([v("SEPARATOR"),"+$"]),"")),F=le(l["$end_with?"](v("SEPARATOR")))||le(f["$start_with?"](v("SEPARATOR")))?""+F+l:""+F+l+v("SEPARATOR"))}),F)},-1),x(L,"$split",function(D){return D.$split(v("SEPARATOR"))}),Y(L,"realpath","expand_path"),Y(L,"exists?","exist?")}(E.get_singleton_class(M),I)},Opal.modules["corelib/process/base"]=function(E){var O,le=E.klass,me=E.slice,d=E.defs,H=E.return_val,J=E.nil;return O=le("::",null,"Signal"),d(O,"$trap",function(K){return me(arguments),J},-1),function(_,x){var O=le("::",null,"GC");return d(O,"$start",H(J))}()},Opal.modules["corelib/process"]=function(E){var le=E.module,me=E.defs,d=E.truthy,H=E.return_val,J=E.Kernel,_=E.nil,x=E.$$$;return function(O){var w=le("::","Process"),K=_;if(w.__clocks__=[],me(w,"$__register_clock__",function(U,N){var Y=this;return null==Y.__clocks__&&(Y.__clocks__=_),Y.$const_set(U,Y.__clocks__.$size()),Y.__clocks__["$<<"](N)}),w.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),K=!1,E.global.performance)K=function(){return performance.now()};else if(E.global.process&&process.hrtime){var G=process.hrtime();K=function(){var A=process.hrtime(G);return 1e3*A[0]+(A[1]/1e3|0)/1e3}}return d(K)&&w.$__register_clock__("CLOCK_MONOTONIC",K),me(w,"$pid",H(0)),me(w,"$times",function(){var U;return U=x("Time").$now().$to_f(),x(x("Benchmark"),"Tms").$new(U,U,U,U,U)}),me(w,"$clock_gettime",function(U,N){var Y=this,j=_;null==Y.__clocks__&&(Y.__clocks__=_),null==N&&(N="float_second"),d(j=Y.__clocks__["$[]"](U))||J.$raise(x(x("Errno"),"EINVAL"),"clock_gettime("+U+") "+Y.__clocks__["$[]"](U));var oe=j();switch(N){case"float_second":return oe/1e3;case"float_millisecond":return oe/1;case"float_microsecond":return 1e3*oe;case"second":return oe/1e3|0;case"millisecond":return oe/1|0;case"microsecond":return 1e3*oe|0;case"nanosecond":return 1e6*oe|0;default:J.$raise(x("ArgumentError"),"unexpected unit: "+N)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(E){var N,oe,z,q,X,Y,me=E.module,d=E.def,H=E.range,J=E.send,_=E.rb_divide,x=E.Kernel,O=E.Opal,K=E.nil,G=E.$$$;return N=[],oe=[Y=(0,E.klass)("::",null,"Random")].concat(N),q=[z=me(Y,"Formatter")].concat(oe),X=E.$r(q),d(z,"$hex",function(I){null==I&&(I=K),I=G("Random").$_verify_count(I);for(var L=this.$bytes(I),S="",k=0;k<I;k++)S+=L.charCodeAt(k).toString(16).padStart(2,"0");return S.$encode("US-ASCII")},-1),d(z,"$random_bytes",function(I){return null==I&&(I=K),this.$bytes(I)},-1),d(z,"$base64",function(I){return null==I&&(I=K),G("Base64").$strict_encode64(this.$random_bytes(I)).$encode("US-ASCII")},-1),d(z,"$urlsafe_base64",function(I,Q){return null==I&&(I=K),null==Q&&(Q=!1),G("Base64").$urlsafe_encode64(this.$random_bytes(I),Q).$encode("US-ASCII")},-1),d(z,"$uuid",function(){var Q=K;return(Q=this.$hex(16).$split(""))["$[]="](12,"4"),Q["$[]="](16,(3&parseInt(Q["$[]"](16),16)|8).toString(16)),Q=[Q["$[]"](H(0,8,!0)),Q["$[]"](H(8,12,!0)),Q["$[]"](H(12,16,!0)),Q["$[]"](H(16,20,!0)),Q["$[]"](H(20,32,!0))],(Q=J(Q,"map",[],"join".$to_proc())).$join("-")}),d(z,"$random_float",function(){var Q=K,L=K;return Q=this.$bytes(4),L=0,J(4,"times",[],function(k){return null==k&&(k=K),L=(L=L["$<<"](8))["$|"](Q["$[]"](k).$ord())}),_(L.$abs(),2147483647)}),d(z,"$random_number",function(I){var Q=this;function L(){return Q.$random_float()}function S(v){return Math.floor(L()*v)}return null==I?L():I.$$is_range?function k(){var v=I.begin,P=I.end;if(v===K||P===K)return K;var B=P-v;return B<0?K:0===B?v:(P%1==0&&v%1==0&&!I.excl&&B++,S(B)+v)}():I.$$is_number?(I<=0&&x.$raise(G("ArgumentError"),"invalid argument - "+I),I%1==0?S(I):L()*I):((I=O["$coerce_to!"](I,G("Integer"),"to_int"))<=0&&x.$raise(G("ArgumentError"),"invalid argument - "+I),S(I))},-1),d(z,"$alphanumeric",function(I){var L=K;return null==I&&(I=K),I=X("Random").$_verify_count(I),L=J([H("0","9",!1),H("a","z",!1),H("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),J(G("Array"),"new",[I],function S(k){return null==k&&(k=K),L["$[]"]((S.$$s??this).$random_number(L.$length()))},{$$s:this}).$join()},-1),Y.$include(G(G("Random"),"Formatter")),Y.$extend(G(G("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(E){var K,w,G,le=E.klass,me=E.const_set,d=E.send,J=E.$$$,_=E.nil;return _=function(){var x=624,O=397,U=function(q,X){return function(q,X){return 2147483648&q|2147483647&X}(q,X)>>>1^(1&X?2567483615:0)};function j(q){var X;return--q.left<=0&&function T(q){var I,X=0,M=q.state;for(q.left=x,q.next=0,I=228;--I;X++)M[X]=M[X+O]^U(M[X+0],M[X+1]);for(I=O;--I;X++)M[X]=M[X+(O-x)]^U(M[X+0],M[X+1]);M[X]=M[X+(O-x)]^U(M[X+0],M[0])}(q),X=q.state[q.next++],X^=X>>>11,X^=X<<7&2636928640,X^=X<<15&4022730752,(X^=X>>>18)>>>0}return{genrand_real:function z(q){return function oe(q,X){return(67108864*(q>>>=5)+(X>>>=6))*(1/9007199254740992)}(j(q),j(q))},init:function N(q){var X={left:0,next:x,state:new Array(x)};return function Y(q,X){var M;for(q.state[0]=X>>>0,M=1;M<x;M++)q.state[M]=1812433253*(q.state[M-1]^q.state[M-1]>>30>>>0)+M,q.state[M]&=4294967295;q.left=1,q.next=x}(X,q),X}}}(),w=le("::",null,"Random"),G=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,me(w,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*G)},reseed:function(A){return _.init(A)},rand:function(A){return _.genrand_real(A)}}),d(w,"generator=",K=[J(w,"MERSENNE_TWISTER_GENERATOR")]),K[K.length-1]},Opal.modules["corelib/random"]=function(E){var N,le=E.truthy,me=E.klass,d=E.Kernel,H=E.defs,J=E.Opal,_=E.def,x=E.eqeqeq,O=E.send,w=E.top,K=E.nil,G=E.$$$;return w.$require("corelib/random/formatter"),(N=me("::",null,"Random")).$attr_reader("seed","state"),H(N,"$_verify_count",function(T){return le(T)||(T=16),"number"!=typeof T&&(T=T.$to_int()),T<0&&d.$raise(G("ArgumentError"),"negative string size (or size too big)"),Math.floor(T)}),_(N,"$initialize",function(T){return null==T&&(T=G("Random").$new_seed()),T=J["$coerce_to!"](T,G("Integer"),"to_int"),this.state=T,this.$reseed(T)},-1),_(N,"$reseed",function(T){return this.seed=T,this.$rng=E.$$rand.reseed(T)}),H(N,"$new_seed",function(){return E.$$rand.new_seed()}),H(N,"$rand",function(T){return G(this,"DEFAULT").$rand(T)},-1),H(N,"$srand",function(T){var oe;return null==T&&(T=G("Random").$new_seed()),T=J["$coerce_to!"](T,G("Integer"),"to_int"),oe=G(this,"DEFAULT").$seed(),G(this,"DEFAULT").$reseed(T),oe},-1),H(N,"$urandom",function(T){return G("SecureRandom").$bytes(T)}),_(N,"$==",function(T){var oe=K;return!!x(G("Random"),T)&&(le(oe=this.$seed()["$=="](T.$seed()))?this.$state()["$=="](T.$state()):oe)}),_(N,"$bytes",function(T){return T=G("Random").$_verify_count(T),O(G("Array"),"new",[T],function oe(){return(oe.$$s??this).$rand(255).$chr()},{$$s:this}).$join().$encode("ASCII-8BIT")}),H(N,"$bytes",function(T){return G(this,"DEFAULT").$bytes(T)}),_(N,"$rand",function(T){return this.$random_number(T)},-1),_(N,"$random_float",function(){return this.state++,E.$$rand.rand(this.$rng)}),H(N,"$random_float",function(){return G(this,"DEFAULT").$random_float()}),H(N,"$generator=",function(T){var j=this;return E.$$rand=T,le(j["$const_defined?"]("DEFAULT"))?G(j,"DEFAULT").$reseed():j.$const_set("DEFAULT",j.$new(j.$new_seed()))}),w.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(E){var oe,z,q,le=E.Kernel,me=E.klass,d=E.send,H=E.slice,J=E.module,_=E.def,x=E.return_val,O=E.alias,w=E.defs,K=E.top,A=E.nil,U=E.$$$,N={};function Y(j){switch(E.config.unsupported_features_severity){case"error":le.$raise(U("NotImplementedError"),j);break;case"warning":!function T(j){N[j]||(N[j]=!0,K.$warn(j))}(j)}}return z=me("::",null,"String"),q="String#%s not supported. Mutable String methods are not supported in Opal.",d(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function X(M){return null==M&&(M=A),d(X.$$s??this,"define_method",[M],function(L){return H(arguments),le.$raise(U("NotImplementedError"),q["$%"](M))},-1)},{$$s:z}),function(j){var oe=J("::","Kernel"),z="Object tainting is not supported by Opal";_(oe,"$taint",function(){return Y(z),this}),_(oe,"$untaint",function(){return Y(z),this}),_(oe,"$tainted?",function(){return Y(z),!1})}(),function(j,oe){var z=me("::",null,"Module");_(z,"$public",function(X){var I,Q=this;return 0===(I=H(arguments)).length?(Q.$$module_function=!1,A):1===I.length?I[0]:I},-1),_(z,"$private_class_method",function(X){var I;return 1===(I=H(arguments)).length?I[0]:I},-1),_(z,"$private_method_defined?",x(!1)),_(z,"$private_constant",function(X){return H(arguments),A},-1),O(z,"nesting","public"),O(z,"private","public"),O(z,"protected","public"),O(z,"protected_method_defined?","private_method_defined?"),O(z,"public_class_method","private_class_method"),O(z,"public_instance_method","instance_method"),O(z,"public_instance_methods","instance_methods"),O(z,"public_method_defined?","method_defined?")}(),oe=J("::","Kernel"),_(oe,"$private_methods",function(q){return H(arguments),[]},-1),O(oe,"protected_methods","private_methods"),O(oe,"private_instance_methods","private_methods"),O(oe,"protected_instance_methods","private_methods"),function(j,oe){var z=J("::","Kernel"),q=[z].concat([]),X=E.$r(q);_(z,"$eval",function(I){return H(arguments),le.$raise(U("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+X("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),w(K,"$public",function(oe){var q;return 1===(q=H(arguments)).length?q[0]:q},-1),w(K,"$private",function(oe){var q;return 1===(q=H(arguments)).length?q[0]:q},-1)},Opal.modules["corelib/binding"]=function(E){var z,q,me=E.truthy,d=E.def,H=E.slice,J=E.send,_=E.to_a,x=E.Kernel,O=E.return_ivar,w=E.eqeq,K=E.thrower,G=E.module,A=E.const_set,U=E.top,Y=E.nil,T=E.$$$;return(q=(z=(0,E.klass)("::",null,"Binding")).$$prototype).jseval=q.scope_variables=Y,d(z,"$initialize",function(M,I,Q,L){var S,k=this;return null==I&&(I=[]),null==L&&(L=Y),k.jseval=(S=[M,I,Q,L])[0],k.scope_variables=S[1],k.receiver=S[2],k.source_location=S[3],me(void 0!==typeof Q)?Y:Q=k.$js_eval("self")},-2),d(z,"$js_eval",function(M){var Q,L=this;return Q=H(arguments),me(L.jseval)?J(L.jseval,"call",_(Q)):x.$raise("Evaluation on a Proc#binding is not supported")},-1),d(z,"$local_variable_get",function(M){try{return this.$js_eval(M)}catch(Q){if(!E.rescue(Q,[T("Exception")]))throw Q;try{return x.$raise(T("NameError"),"local variable `"+M+"' is not defined for "+this.$inspect())}finally{E.pop_exception()}}}),d(z,"$local_variable_set",function(M,I){return E.Binding.tmp_value=I,this.$js_eval(M+" = Opal.Binding.tmp_value"),delete E.Binding.tmp_value,I}),d(z,"$local_variables",O("scope_variables")),d(z,"$local_variable_defined?",function(M){return this.scope_variables["$include?"](M)}),d(z,"$eval",function(M,I,Q){try{return K("eval_return"),null==I&&(I=Y),null==Q&&(Q=Y),w(M,"self")?this.$receiver():x.$eval(M,this,I,Q)}catch(k){if(k===E.t_eval_return)return k.$v;throw k}},-2),z.$attr_reader("receiver","source_location"),d(G("::","Kernel"),"$binding",function(){return x.$raise("Opal doesn't support dynamic calls to binding")}),A([][0],"TOPLEVEL_BINDING",T("Binding").$new(function(j){return new Function("self","return "+j)(U)},[],U,["<main>",0]))},Opal.modules["corelib/irb"]=function(E){var X,L,te,D,S,k,v,I,le=E.module,me=E.truthy,d=E.Kernel,H=E.defs,J=E.hash,_=E.gvars,x=E.lambda,O=E.send,w=E.rb_plus,K=E.const_set,G=E.klass,A=E.def,U=E.Opal,N=E.range,Y=E.eqeq,T=E.thrower,j=[],oe=E.nil,z=E.$$$;X=j,L=I=[le(j[0],"Opal")].concat(X),k=[S=le(I[0],"IRB")].concat(L),v=E.$r(k),H(S,"$ensure_loaded",function(B){var D,fe;if(me(E.loaded_features["$include?"](B)))return oe;if(D="https://cdn.opalrb.com/opal/"+(me(v("RUBY_ENGINE_VERSION")["$include?"]("dev"))?"master":v("RUBY_ENGINE_VERSION"))+"/"+B+".js",typeof XMLHttpRequest<"u"){var R=new XMLHttpRequest;R.open("GET",D,!1),R.send(""),fe=R.responseText}else d.$raise("You need to provision "+B+" yourself in this environment");return new Function("Opal",fe)(E),E.require(B),me(E.loaded_features["$include?"](B))?oe:d.$raise("Could not load "+B+" for some reason")}),S.$singleton_class().$attr_accessor("output"),H(S,"$prepare_console",function P(){var B=P.$$p||oe,D=this,fe=oe,R=oe;return null==_.stdout&&(_.stdout=oe),null==_.stderr&&(_.stderr=oe),null==_.stdin&&(_.stdin=oe),P.$$p=null,function(){try{return D["$output="](""),fe=J(_.stdout,x(function(g){return null==g&&(g=oe),_.stdout=g}),_.stderr,x(function(g){return null==g&&(g=oe),_.stderr=g})),me(D["$browser?"]())&&(O(fe,"each",[],function F(g,l){var c=F.$$s??this,f=oe;return null==g&&(g=oe),null==l&&(l=oe),(f=g.$dup())["$write_proc="](O(c,"proc",[],function u(p){var m=u.$$s??this;return null==p&&(p=oe),m["$output="](w(m.$output(),p)),m["$output="](m.$output().$split("\n").$last(30).$join("\n")),me(p["$end_with?"]("\n"))&&m["$output="](w(m.$output(),"\n")),g.$write_proc().$call(p)},{$$s:c})),f["$tty="](!1),l.$call(f)},{$$s:D}),R=_.stdin.$read_proc(),_.stdin["$read_proc="](function(F){var g=prompt(D.$output());return null!==g?g+"\n":oe})),E.yieldX(B,[])}finally{O(fe,"each",[],function(g,l){return null==g&&(g=oe),null==l&&(l=oe),l.$call(g)}),O(_.stdin,"read_proc=",[R]),O(D,"output=",[""])}}()}),H(S,"$browser?",function(){return typeof document<"u"&&typeof prompt<"u"}),K(k[0],"LINEBREAKS",["unexpected token $end","unterminated string meets end of file"].$freeze()),(D=(te=G(k[0],null,"Silencer")).$$prototype).collector=D.stderr=oe,A(te,"$initialize",function(){return null==_.stderr&&(_.stderr=oe),this.stderr=_.stderr}),A(te,"$silence",function fe(){var R=fe.$$p||oe,F=this;return fe.$$p=null,function(){try{return F.collector=z("StringIO").$new(),_.stderr=F.collector,E.yieldX(R,[])}finally{_.stderr=F.stderr}}()}),A(te,"$warnings",function(){return this.collector.$string()}),function(q,X,M){var I=G("::",null,"Binding"),Q=[I].concat(M),L=E.$r(Q);A(I,"$irb",function(){try{var k=T("return"),P=oe;return z(U,"IRB").$ensure_loaded("opal-replutils"),P=z(z(U,"IRB"),"Silencer").$new(),O(z(U,"IRB"),"prepare_console",[],function B(){var te=B.$$s??this;return function(){try{var D=T("break");return O(te,"loop",[],function fe(){var R=fe.$$s??this,F=oe,g=oe,l=oe,c=oe,f=oe;for(R.$print(">> "),F=R.$gets(),me(F)||D.$throw(),g="",me(z(U,"IRB")["$browser?"]())&&R.$puts(F),me(F["$start_with?"]("ls "))?(g=F["$[]"](N(3,-1,!1)),l="ls"):Y(F,"ls\n")?(g="self",l="ls"):me(F["$start_with?"]("show "))?(g=F["$[]"](N(5,-1,!1)),l="show"):(g=F,l="inspect"),c=oe;;){try{O(P,"silence",[],function(){return c=E.compile(g,{irb:!0})})}catch(u){if(!E.rescue(u,[L("SyntaxError")]))throw u;f=u;try{if(me(z(z(U,"IRB"),"LINEBREAKS")["$include?"](f.$message()))){R.$print(".. "),F=R.$gets(),me(F)||k.$throw(),me(z(U,"IRB")["$browser?"]())&&R.$puts(F),g=w(g,F);continue}me(P.$warnings()["$empty?"]())?R.$warn(f.$full_message()):R.$warn(P.$warnings())}finally{E.pop_exception()}}break}return Y(l,"show")&&(R.$puts(c),k.$throw()),R.$puts(z("REPLUtils").$eval_and_print(c,l,!1,R))},{$$s:te,$$ret:k})}catch(fe){if(fe===D)return fe.$v;throw fe}}()},{$$s:this})}catch(B){if(B===k)return B.$v;throw B}})}(0,0,j),E.irb=function(q){z("Binding").$new(q).$irb()},E.load_parser=function(){E.Opal.IRB.$ensure_loaded("opal-parser")},typeof E.eval>"u"&&(E.eval=function(q){return E.load_parser(),E.eval(q)}),typeof E.compile>"u"&&(E.compile=function(q,X){return E.load_parser(),E.compile(q,X)})},Opal.queue(function(E){var le=E.Object;return le.$require("opal/base"),le.$require("opal/mini"),le.$require("corelib/kernel/format"),le.$require("corelib/string/encoding"),le.$autoload("Math","corelib/math"),le.$require("corelib/complex/base"),le.$autoload("Complex","corelib/complex"),le.$require("corelib/rational/base"),le.$autoload("Rational","corelib/rational"),le.$require("corelib/time"),le.$autoload("Struct","corelib/struct"),le.$autoload("Set","corelib/set"),le.$autoload("Dir","corelib/dir"),le.$autoload("File","corelib/file"),le.$require("corelib/process/base"),le.$autoload("Process","corelib/process"),le.$autoload("Random","corelib/random"),le.$require("corelib/unsupported"),le.$require("corelib/binding"),le.$require("corelib/irb")}),Opal.queue(function(E){var B,F,g,l,c,te,D,fe,le=E.module,me=E.defs,d=E.slice,H=E.truthy,J=E.send,_=E.Kernel,x=E.extract_kwargs,O=E.ensure_kwargs,w=E.range,K=E.to_a,G=E.def,A=E.return_ivar,U=E.alias,N=E.klass,Y=E.rb_minus,T=E.return_val,j=E.hash2,oe=E.send2,z=E.find_super,q=E.eqeqeq,X=E.rb_ge,M=E.return_self,I=E.gvars,Q=E.top,L=[],S=E.$r(L),k=E.nil,v=E.$$$;return B=L,D=[te=le(L[0],"Native")].concat(B),fe=E.$r(D),me(te,"$is_a?",function(F,g){try{return F instanceof this.$try_convert(g)}catch{return!1}}),me(te,"$try_convert",function(F,g){return null==g&&(g=k),this["$native?"](F)?F:F["$respond_to?"]("to_n")?F.$to_n():g},-2),me(te,"$convert",function(F){return this["$native?"](F)?F:F["$respond_to?"]("to_n")?F.$to_n():void this.$raise(fe("ArgumentError"),F.$inspect()+" isn't native")}),me(te,"$call",function R(F,g,l){var u,c=R.$$p||k,p=this;R.$$p=null,u=d(arguments,2);var m=F[g];if(m instanceof Function){for(var C=new Array(u.length),$=0,re=u.length;$<re;$++){var se=u[$],Ee=p.$try_convert(se);C[$]=Ee===k?se:Ee}return c!==k&&C.push(c),p.$Native(m.apply(F,C))}return p.$Native(m)},-3),me(te,"$proc",function R(){var F=R.$$p||k;return R.$$p=null,H(F)||this.$raise(fe("LocalJumpError"),"no block given"),J(_,"proc",[],function l(c){var f,u,p=l.$$s??this,m=k;if(f=d(arguments),J(u=f,"map!",[],function $(re){return null==re&&(re=k),($.$$s??this).$Native(re)},{$$s:p}),m=p.$Native(this),this===E.global)return F.apply(p,u);var C=F.$$s;F.$$s=null;try{return F.apply(m,u)}finally{F.$$s=C}},{$$arity:-1,$$s:this})}),F=D,l=[g=le(D[0],"Helpers")].concat(F),c=E.$r(l),G(g,"$alias_native",function f(u,p,m){var C,$,re,se,Me=this;return f.$$p=null,C=d(arguments,1),$=x(C),$=O($),C.length>0&&(re=C.shift()),null==re&&(re=u),null==(se=$.$$smap.as)&&(se=k),H(re["$end_with?"]("="))?J(Me,"define_method",[u],function ce(ke){var ve=ce.$$s??this;return null==ve.native&&(ve.native=k),null==ke&&(ke=k),ve.native[re["$[]"](w(0,-2,!1))]=c("Native").$convert(ke),ke},{$$s:Me}):H(se)?J(Me,"define_method",[u],function ce(ke){var he,ve=ce.$$p||k,Ie=ce.$$s??this,be=k;return null==Ie.native&&(Ie.native=k),ce.$$p=null,he=d(arguments),be=J(c("Native"),"call",[Ie.native,re].concat(K(he)),ve.$to_proc()),H(be)?se.$new(be.$to_n()):k},{$$arity:-1,$$s:Me}):J(Me,"define_method",[u],function ce(ke){var he,ve=ce.$$p||k,Ie=ce.$$s??this;return null==Ie.native&&(Ie.native=k),ce.$$p=null,he=d(arguments),J(c("Native"),"call",[Ie.native,re].concat(K(he)),ve.$to_proc())},{$$arity:-1,$$s:Me})},-2),G(g,"$native_reader",function(u){var p,C=this;return p=d(arguments),J(p,"each",[],function $(re){var se=$.$$s??this;return null==re&&(re=k),J(se,"define_method",[re],function Ee(){var Me=Ee.$$s??this;return null==Me.native&&(Me.native=k),Me.$Native(Me.native[re])},{$$s:se})},{$$s:C})},-1),G(g,"$native_writer",function(u){var p,C=this;return p=d(arguments),J(p,"each",[],function $(re){var se=$.$$s??this;return null==re&&(re=k),J(se,"define_method",[re+"="],function Ee(Me){var ce=Ee.$$s??this;return null==ce.native&&(ce.native=k),null==Me&&(Me=k),ce.$Native(ce.native[re]=Me)},{$$s:se})},{$$s:C})},-1),G(g,"$native_accessor",function(u){var p,m,C=this;return p=d(arguments),J(C,"native_reader",K(m=p)),J(C,"native_writer",K(m))},-1),function(R,F){var g=le(R,"Wrapper"),l=[g].concat(F),c=E.$r(l);G(g,"$initialize",function(u){return H(_["$native?"](u))||_.$raise(c("ArgumentError"),u.$inspect()+" isn't native"),this.native=u}),G(g,"$to_n",A("native")),me(g,"$included",function(u){return u.$extend(c("Helpers"))})}(D[0],D),me(te,"$included",function(F){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),F.$include(fe("Wrapper"))}),function(P,B){var te=le(P,"Kernel"),D=[te].concat(B),fe=E.$r(D);G(te,"$native?",function(F){return null==F||!F.$$class}),G(te,"$Native",function R(F){var l=this;return R.$$p=null,H(null==F)?k:H(l["$native?"](F))?v(fe("Native"),"Object").$new(F):H(F["$is_a?"](fe("Array")))?J(F,"map",[],function c(f){return null==f&&(f=k),(c.$$s??this).$Native(f)},{$$s:l}):H(F["$is_a?"](fe("Proc")))?J(l,"proc",[],function c(f){var p,u=c.$$p||k,C=c.$$s??this;return c.$$p=null,p=d(arguments),C.$Native(J(F,"call",K(p),u.$to_proc()))},{$$arity:-1,$$s:l}):F}),U(te,"_Array","Array"),G(te,"$Array",function R(F,g){var f,l=R.$$p||k,u=this;return R.$$p=null,f=d(arguments,1),H(u["$native?"](F))?J(v(fe("Native"),"Array"),"new",[F].concat(K(f)),l.$to_proc()).$to_a():u.$_Array(F)},-2)}(L[0],L),function(P,B){var te=N(P,B,"Object");te.$$prototype.native=k,te.$include(v(v("Native"),"Wrapper")),G(te,"$==",function(R){return this.native===v("Native").$try_convert(R)}),G(te,"$has_key?",function(R){return E.hasOwnProperty.call(this.native,R)}),G(te,"$each",function fe(R){var g,l=fe.$$p||k,c=this;if(fe.$$p=null,g=d(arguments),l!==k){for(var f in c.native)E.yieldX(l,[f,c.native[f]]);return c}return J(c,"method_missing",["each"].concat(K(g)))},-1),G(te,"$[]",function(R){var g=this.native[R];return g instanceof Function?g:v("Native").$call(this.native,R)}),G(te,"$[]=",function(R,F){var l;return l=v("Native").$try_convert(F),this.native[R]=H(l===k)?F:l}),G(te,"$merge!",function(R){for(var g in R=v("Native").$convert(R))this.native[g]=R[g];return this}),G(te,"$respond_to?",function(R,F){return null==F&&(F=!1),_.$instance_method("respond_to?").$bind(this).$call(R,F)},-2),G(te,"$respond_to_missing?",function(R,F){return null==F&&(F=!1),E.hasOwnProperty.call(this.native,R)},-2),G(te,"$method_missing",function fe(R,F){var c,f,g=fe.$$p||k,u=this;return fe.$$p=null,c=d(arguments,1),"="===R.charAt(R.length-1)?(f=[R.$slice(0,Y(R.$length(),1)),c["$[]"](0)],J(u,"[]=",f),f[f.length-1]):J(v("Native"),"call",[u.native,R].concat(K(c)),g.$to_proc())},-2),G(te,"$nil?",T(!1)),G(te,"$is_a?",function(R){return E.is_a(this,R)}),G(te,"$instance_of?",function(R){return this.$$class===R}),G(te,"$class",function(){return this.$$class}),G(te,"$to_a",function fe(R){var F=fe.$$p||k;return fe.$$p=null,null==R&&(R=j([],{})),J(v(v("Native"),"Array"),"new",[this.native,R],F.$to_proc()).$to_a()},-1),G(te,"$inspect",function(){return"#<Native:"+String(this.native)+">"}),U(te,"include?","has_key?"),U(te,"key?","has_key?"),U(te,"kind_of?","is_a?"),U(te,"member?","has_key?")}(S("Native"),S("BasicObject")),function(P,B,te){var D=N(P,null,"Array"),fe=[D].concat(te),R=E.$r(fe),F=D.$$prototype;F.named=F.native=F.get=F.block=F.set=F.length=k,D.$include(v(R("Native"),"Wrapper")),D.$include(R("Enumerable")),G(D,"$initialize",function g(l,c){var f=g.$$p||k,u=this,p=k;return g.$$p=null,null==c&&(c=j([],{})),oe(u,z(u,"initialize",g,!1,!0),"initialize",[l],null),u.get=H(p=c["$[]"]("get"))?p:c["$[]"]("access"),u.named=c["$[]"]("named"),u.set=H(p=c["$[]"]("set"))?p:c["$[]"]("access"),u.length=H(p=c["$[]"]("length"))?p:"length",u.block=f,H(null==u.$length())?u.$raise(R("ArgumentError"),"no length found on the array-like object"):k},-2),G(D,"$each",function g(){var l=g.$$p||k,c=this;if(g.$$p=null,!H(l))return c.$enum_for("each");for(var f=0,u=c.$length();f<u;f++)E.yield1(l,c["$[]"](f));return c}),G(D,"$[]",function(l){var f,u,c=this;return f=q(R("String"),u=l)||q(R("Symbol"),u)?H(c.named)?c.native[c.named](l):c.native[l]:q(R("Integer"),u)?H(c.get)?c.native[c.get](l):c.native[l]:k,H(f)?H(c.block)?c.block.$call(f):c.$Native(f):k}),G(D,"$[]=",function(l,c){var f=this;return H(f.set)?f.native[f.set](l,R("Native").$convert(c)):f.native[l]=R("Native").$convert(c)}),G(D,"$last",function(l){var c=this,f=k,u=k;if(null==l&&(l=k),H(l)){for(f=Y(c.$length(),1),u=[];H(X(f,0));)u["$<<"](c["$[]"](f)),f=Y(f,1);return u}return c["$[]"](Y(c.$length(),1))},-1),G(D,"$length",function(){return this.native[this.length]}),G(D,"$inspect",function(){return this.$to_a().$inspect()}),U(D,"to_ary","to_a")}(S("Native"),0,L),function(P,B){var te=N(P,null,"Numeric");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"Proc");G(te,"$to_n",M)}(L[0]),function(P,B){var te=N(P,null,"String");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"Regexp");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"MatchData");G(te,"$to_n",A("matches"))}(L[0]),function(P,B,te){var D=N(P,null,"Struct"),fe=[D].concat(te),R=E.$r(fe);G(D,"$to_n",function(){var l=k;return l={},J(this,"each_pair",[],function(f,u){return null==f&&(f=k),null==u&&(u=k),l[f]=R("Native").$try_convert(u,u)}),l})}(L[0],0,L),function(P,B,te){var D=N(P,null,"Array"),fe=[D].concat(te),R=E.$r(fe);G(D,"$to_n",function(){for(var l=[],c=0,f=this.length;c<f;c++){var u=this[c];l.push(R("Native").$try_convert(u,u))}return l})}(L[0],0,L),function(P,B){var te=N(P,null,"Boolean");G(te,"$to_n",function(){return this.valueOf()})}(L[0]),function(P,B){var te=N(P,null,"Time");G(te,"$to_n",M)}(L[0]),function(P,B){var te=N(P,null,"NilClass");G(te,"$to_n",function(){return null})}(L[0]),H(S("Hash")["$method_defined?"]("_initialize"))||function(P,B,te){var D=N(P,null,"Hash"),fe=[D].concat(te),R=E.$r(fe);U(D,"_initialize","initialize"),G(D,"$initialize",function F(g){var l=F.$$p||k,c=this;if(F.$$p=null,null!=g&&(void 0===g.constructor||g.constructor===Object)){var p,m,f=c.$$smap,u=c.$$keys;for(p in g)!(m=g[p])||void 0!==m.constructor&&m.constructor!==Object?m&&m.$$is_array?(m=m.map(function(C){return!C||void 0!==C.constructor&&C.constructor!==Object?c.$Native(C):R("Hash").$new(C)}),f[p]=m):f[p]=c.$Native(m):f[p]=R("Hash").$new(m),u.push(p);return c}return J(c,"_initialize",[g],l.$to_proc())},-1),G(D,"$to_n",function(){for(var u,p,l={},c=this.$$keys,f=this.$$smap,m=0,C=c.length;m<C;m++)p=(u=c[m]).$$is_string?f[u]:(u=u.key).value,l[u]=R("Native").$try_convert(p,p);return l})}(L[0],0,L),function(P,B){var te=N(P,null,"Module");G(te,"$native_module",function(){return E.global[this.$name()]=this})}(L[0]),function(P,B,te){var D=N(P,null,"Class"),fe=[D].concat(te),R=E.$r(fe);G(D,"$native_alias",function(g,l){var c=this,f=c.prototype[E.jsid(l)];f||c.$raise(R("NameError").$new("undefined method `"+l+"' for class `"+c.$inspect()+"'",l)),c.prototype[g]=f}),G(D,"$native_class",function(){var g=this;return g.$native_module(),g.new=g.$new})}(L[0],0,L),I.$=I.global=Q.$Native(E.global)}),Opal.modules.strscan=function(E){var U,N,Y,T,j,me=E.def,d=E.truthy,H=E.eqeqeq,J=E.Opal,_=E.return_ivar,x=E.send,O=E.alias,w=[],K=E.nil;return U=w,Y=[N=(0,E.klass)(w[0],null,"StringScanner")].concat(U),T=E.$r(Y),(j=N.$$prototype).pos=j.string=j.working=j.matched=j.prev_pos=j.match=K,N.$attr_reader("pos","matched"),me(N,"$initialize",function(z){var q=this;return q.string=z,q.pos=0,q.matched=K,q.working=z,q.match=[]}),N.$attr_reader("string"),me(N,"$beginning_of_line?",function(){var z=this;return 0===z.pos||"\n"===z.string.charAt(z.pos-1)}),me(N,"$scan",function(z){var q=this,X=(z=q.$anchor(z)).exec(q.working);return null==X?q.matched=K:(q.prev_pos=q.pos,q.pos+=X[0].length,q.working=q.working.substring(X[0].length),q.matched=X[0],q.match=X,X[0])}),me(N,"$scan_until",function(z){var q=this;z=q.$anchor(z);for(var X=q.working,M=0;X.length!=M;++M){var I=z.exec(X.substr(M));if(null!==I){var Q=M+I[0].length,L=X.substr(0,Q);return q.matched=I[0],q.match=I,q.prev_pos=q.pos+M,q.pos+=Q,q.working=X.substr(Q),L}}return q.matched=K}),me(N,"$[]",function(z){var X;if(d(this.match["$empty?"]()))return K;H(T("Symbol"),X=z)?z=z.$to_s():H(T("String"),X)||(z=J["$coerce_to!"](z,T("Integer"),"to_int"));var M=this.match;return z<0&&(z+=M.length),z<0||z>=M.length||null==M[z]?K:M[z]}),me(N,"$check",function(z){var q=this,X=(z=q.$anchor(z)).exec(q.working);return q.matched=null==X?K:X[0]}),me(N,"$check_until",function(z){var q=this,X=q.prev_pos,M=q.pos,I=q.working,Q=q.$scan_until(z);return q.prev_pos=X,q.pos=M,q.working=I,Q}),me(N,"$peek",function(z){return this.working.substring(0,z)}),me(N,"$eos?",function(){return 0===this.working.length}),me(N,"$exist?",function(z){var X=z.exec(this.working);return null==X?K:0==X.index?0:X.index+1}),me(N,"$skip",function(z){var q=this,X=(z=q.$anchor(z)).exec(q.working);if(null==X)return q.match=[],q.matched=K;var M=X[0],I=M.length;return q.matched=M,q.match=X,q.prev_pos=q.pos,q.pos+=I,q.working=q.working.substring(I),I}),me(N,"$skip_until",function(z){var X=this.$scan_until(z);return X===K?K:(this.matched=X.substr(-1),X.length)}),me(N,"$get_byte",function(){var z=this,q=K;return z.pos<z.string.length?(z.prev_pos=z.pos,z.pos+=1,q=z.matched=z.working.substring(0,1),z.working=z.working.substring(1)):z.matched=K,q}),me(N,"$match?",function(z){var q=this,X=(z=q.$anchor(z)).exec(q.working);return null==X?K:(q.prev_pos=q.pos,X[0].length)}),me(N,"$pos=",function(z){var q=this;return z<0&&(z+=q.string.$length()),q.pos=z,q.working=q.string.slice(z)}),me(N,"$matched_size",function(){return this.matched===K?K:this.matched.length}),me(N,"$post_match",function(){var z=this;return z.matched===K?K:z.string.substr(z.pos)}),me(N,"$pre_match",function(){var z=this;return z.matched===K?K:z.string.substr(0,z.prev_pos)}),me(N,"$reset",function(){var z=this;return z.working=z.string,z.matched=K,z.pos=0}),me(N,"$rest",_("working")),me(N,"$rest?",function(){return 0!==this.working.length}),me(N,"$rest_size",function(){return this.$rest().$size()}),me(N,"$terminate",function(){var z,q=this;return q.match=K,z=[q.string.$length()],x(q,"pos=",z),z[z.length-1]}),me(N,"$unscan",function(){var z=this;return z.pos=z.prev_pos,z.prev_pos=K,z.match=K,z}),O(N,"bol?","beginning_of_line?"),O(N,"getch","get_byte"),N.$private(),me(N,"$anchor",function(z){var q=z.toString().match(/\/([^\/]+)$/);return q=q?q[1]:void 0,new RegExp("^(?:"+z.source+")",q)})},Opal.queue(function(E){var w,K,U,G,le=E.klass,me=E.def,d=E.module,H=E.top,J=[],_=E.$r(J),x=E.nil;return H.$require("strscan"),K=J,[G=le(J[0],null,"Dir")].concat(K),U=E.get_singleton_class(G),me(U,"$[]",function(){return[]}),w=d(J[0],"StringScannerPatch"),me(w,"$scan_until",function(G){var A=this;G=(A=this).$anchor(G);for(var Y,U=A.pos,N=A.working;;){var T=0===N.length;if(Y=G.exec(N),U+=1,N=N.substr(1),null!=Y)return A.matched=A.string.substr(A.pos,U-A.pos-1+Y[0].length),A.prev_pos=U-1,A.pos=U,A.working=N.substr(Y[0].length-1),A.matched;if(T)return A.matched=x}}),_("StringScanner").$prepend(_("StringScannerPatch")),E.top.$__dir__=()=>"/",x})},8465:(E,le,me)=>{me(9993),Opal.modules["bcdice/arithmetic/node"]=function(d){var M,S,B,g,l,D,fe,v,Q,H=d.module,J=d.klass,_=d.def,x=d.thrower,O=d.return_ivar,w=d.send2,K=d.find_super,G=d.eqeq,A=d.const_set,U=d.eqeqeq,N=d.rb_divide,Y=d.truthy,T=d.assign_ivar,j=d.alias,oe=[],z=d.nil,q=d.$$$;return M=oe,S=Q=[H(oe[0],"BCDice")].concat(M),B=v=[H(Q[0],"Arithmetic")].concat(S),D=[H(v[0],"Node")].concat(B),fe=d.$r(D),(l=(g=J(D[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=z,_(g,"$initialize",function(f,u,p){var m=this;return m.lhs=f,m.op=u,m.rhs=p}),_(g,"$eval",function(f){try{x("eval_return");var C,p=this,m=z;return m=p.lhs.$eval(f),C=p.rhs.$eval(f),m.$send(p.op,C)}catch($){if($===d.t_eval_return)return $.$v;throw $}}),_(g,"$output",function(){var f=this;return""+f.lhs.$output()+f.op+f.rhs.$output()}),_(g,"$s_exp",function(){var f=this;return"("+f.$op_for_s_exp()+" "+f.lhs.$s_exp()+" "+f.rhs.$s_exp()+")"}),_(g,"$op_for_s_exp",O("op")),function(R,F,g){var l=J(R,F,"DivideBase"),c=[l].concat(g),f=d.$r(c),u=l.$$prototype;u.lhs=u.rhs=u.op=z,_(l,"$initialize",function p(m,C){return p.$$p=null,w(this,K(this,"initialize",p,!1,!0),"initialize",[m,"/",C],null)}),_(l,"$eval",function(m){try{x("eval_return");var re,se,$=this;return re=$.lhs.$eval(m),se=$.rhs.$eval(m),G(se,0)&&$.$raise(f("ZeroDivisionError")),$.$divide_and_round(re,se,m)}catch(Ee){if(Ee===d.t_eval_return)return Ee.$v;throw Ee}}),_(l,"$output",function p(){var m=p.$$p||z,C=this;return p.$$p=null,""+w(C,K(C,"output",p,!1,!0),"output",[],m)+C.$rounding_method()}),l.$private(),_(l,"$rounding_method",function(){return q(this.$class(),"ROUNDING_METHOD")}),_(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(l,"$divide_and_round",function(m,C,$){return this.$raise(f("NotImplementedError"))})}(D[0],fe("BinaryOp"),D),function(R,F,g){var l=J(R,F,"DivideWithGameSystemDefault"),c=[l].concat(g),f=d.$r(c);A(c[0],"ROUNDING_METHOD",""),l.$private(),_(l,"$divide_and_round",function(p,m,C){var $,re=z;return U(q(f("RoundType"),"CEIL"),$=C)?N(p.$to_f(),m).$ceil():U(q(f("RoundType"),"ROUND"),$)?(re=N(p.$to_f(),m),Y(re["$negative?"]())?re.$abs().$round()["$-@"]():re.$round()):N(p,m).$floor()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithCeil"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","C"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u.$to_f(),p).$ceil()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithRound"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","R"),l.$private(),_(l,"$divide_and_round",function(u,p,m){var C=z;return C=N(u.$to_f(),p),Y(C["$negative?"]())?C.$abs().$round()["$-@"]():C.$round()})}(D[0],fe("DivideBase"),D),function(R,F,g){var l=J(R,F,"DivideWithFloor"),c=[l].concat(g);A(c[0],"ROUNDING_METHOD","F"),l.$private(),_(l,"$divide_and_round",function(u,p,m){return N(u,p).$floor()})}(D[0],fe("DivideBase"),D),function(R,F){var g=J(R,null,"Negative");g.$$prototype.body=z,_(g,"$initialize",T("body")),_(g,"$eval",function(f){try{return x("eval_return"),this.body.$eval(f)["$-@"]()}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"-"+this.body.$output()}),_(g,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Parenthesis");g.$$prototype.expr=z,_(g,"$initialize",T("expr")),_(g,"$eval",function(f){try{return x("eval_return"),this.expr.$eval(f)}catch(m){if(m===d.t_eval_return)return m.$v;throw m}}),_(g,"$output",function(){return"("+this.expr.$output()+")"}),_(g,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(D[0]),function(R,F){var g=J(R,null,"Number");return g.$$prototype.value=z,_(g,"$initialize",T("value")),_(g,"$eval",O("value")),_(g,"$output",function(){return this.value.$to_s()}),j(g,"s_exp","output")}(D[0])},Opal.modules["racc/parser"]=function(d){var P,te,D,H=d.module,J=d.klass,_=d.truthy,x=d.const_set,O=d.defs,w=d.gvars,K=d.rb_lt,G=d.def,A=d.to_ary,U=d.send,N=d.neqeq,Y=d.rb_plus,T=d.eqeq,j=d.rb_ge,oe=d.rb_gt,z=d.rb_minus,q=d.rb_le,X=d.rb_times,M=d.assign_ivar_val,Q=[],L=d.$r(Q),S=d.nil,k=d.$$$;return P=Q,te=[H(Q[0],"Racc")].concat(P),D=d.$r(te),J(te[0],D("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":S)||x(Q[0],"ParseError",k(L("Racc"),"ParseError")),function(v,P){var g,l,c,f,u,D=[H(v,"Racc")].concat(P),fe=d.$r(D);return _(fe("Racc_No_Extensions","skip_raise")?"constant":S)||x(D[0],"Racc_No_Extensions",!1),g=D,c=[l=J(D[0],null,"Parser")].concat(g),f=d.$r(c),(u=l.$$prototype).yydebug=u.racc_debug_out=u.racc_error_status=u.racc_t=u.racc_vstack=u.racc_val=u.racc_state=u.racc_tstack=S,x(c[0],"Racc_Runtime_Version","1.4.6"),x(c[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Runtime_Core_Version_R","1.4.6"),x(c[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),x(c[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),x(c[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),x(c[0],"Racc_Runtime_Core_Version",f("Racc_Runtime_Core_Version_R")),x(c[0],"Racc_Runtime_Core_Revision",f("Racc_Runtime_Core_Revision_R")),x(c[0],"Racc_Runtime_Type","ruby"),O(f("Parser"),"$racc_runtime_type",function(){return f("Racc_Runtime_Type")}),G(l,"$_racc_setup",function(){var m,C,$=this,re=S,se=S;return null==w.stderr&&(w.stderr=S),_(k($.$class(),"Racc_debug_parser"))||($.yydebug=!1),_(null!=(m=$.yydebug)&&m!==S?"instance-variable":S)||($.yydebug=!1),_($.yydebug)&&(_(null!=(C=$.racc_debug_out)&&C!==S?"instance-variable":S)||($.racc_debug_out=w.stderr),$.racc_debug_out=_(re=$.racc_debug_out)?re:w.stderr),se=k($.$class(),"Racc_arg"),_(K(se.$size(),14))&&se["$[]="](13,!0),se}),G(l,"$_racc_init_sysvars",function(){var m=this;return m.racc_state=[0],m.racc_tstack=[],m.racc_vstack=[],m.racc_t=S,m.racc_val=S,m.racc_read_next=!0,m.racc_user_yyerror=!1,m.racc_error_status=0}),G(l,"$do_parse",function(){return this.$__send__(f("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),G(l,"$next_token",function(){return this.$raise(f("NotImplementedError"),this.$class()+"#next_token is not defined")}),G(l,"$_racc_do_parse_rb",function(m,C){var $,Ee=S,Me=S,ce=S,ke=S,ye=S,he=S,Ie=S,be=S;return $=A(m),Ee=$[0]??S,Me=$[1]??S,ce=$[2]??S,ke=$[3]??S,ye=$[10]??S,this.$_racc_init_sysvars(),he=Ie=be=S,U(this,"catch",["racc_end_parse"],function ae(){var ue,xe,y=ae.$$s??this,W=S;for(null==y.racc_state&&(y.racc_state=S),null==y.racc_read_next&&(y.racc_read_next=S),null==y.racc_t&&(y.racc_t=S),null==y.yydebug&&(y.yydebug=S),null==y.racc_val&&(y.racc_val=S);_(!0);)for(_(be=ke["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&N(y.racc_t,0)&&(xe=y.$next_token(),ue=A(xe),he=ue[0]??S,y.racc_val=ue[1]??S,y.racc_t=_(he)?_(W=ye["$[]"](he))?W:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,he,y.racc_val),y.racc_read_next=!1),be=Y(be,y.racc_t),_(j(be,0))&&_(Ie=Ee["$[]"](be))&&T(Me["$[]"](be),y.racc_state["$[]"](-1))||(Ie=ce["$[]"](y.racc_state["$[]"](-1)))):Ie=ce["$[]"](y.racc_state["$[]"](-1));_(Ie=y.$_racc_evalact(Ie,m)););},{$$s:this})}),G(l,"$yyparse",function(m,C){return this.$__send__(f("Racc_YY_Parse_Method"),m,C,this.$_racc_setup(),!0)}),G(l,"$_racc_yyparse_rb",function(m,C,$,re){var se,ce=S,ke=S,ve=S,ye=S,Ie=S,be=S,ae=S;return se=A($),ce=se[0]??S,ke=se[1]??S,ve=se[2]??S,ye=se[3]??S,Ie=se[10]??S,this.$_racc_init_sysvars(),be=S,ae=S,U(this,"catch",["racc_end_parse"],function ue(){var xe=ue.$$s??this;for(null==xe.racc_state&&(xe.racc_state=S);!_(ae=ye["$[]"](xe.racc_state["$[]"](-1)));)for(;_(be=xe.$_racc_evalact(ve["$[]"](xe.racc_state["$[]"](-1)),$)););return U(m,"__send__",[C],function y(W,pe){var we=y.$$s??this,De=S,Le=S;for(null==we.racc_t&&(we.racc_t=S),null==we.racc_state&&(we.racc_state=S),null==we.racc_read_next&&(we.racc_read_next=S),null==W&&(W=S),null==pe&&(pe=S),we.racc_t=_(W)?_(De=Ie["$[]"](W))?De:1:0,we.racc_val=pe,we.racc_read_next=!1,ae=Y(ae,we.racc_t),_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(ke["$[]"](ae),we.racc_state["$[]"](-1))||(be=ve["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););for(;_(_(De=_(Le=(ae=ye["$[]"](we.racc_state["$[]"](-1)))["$!"]())?Le:we.racc_read_next["$!"]())?De:we.racc_t["$=="](0));)for(_(ae)&&_(ae=Y(ae,we.racc_t))&&_(j(ae,0))&&_(be=ce["$[]"](ae))&&T(ke["$[]"](ae),we.racc_state["$[]"](-1))||(be=ve["$[]"](we.racc_state["$[]"](-1)));_(be=we.$_racc_evalact(be,$)););},{$$s:xe})},{$$s:this})}),G(l,"$_racc_evalact",function(m,C){var $,ve,se=this,Ee=S,Me=S,ke=S,ye=S,he=S,Ie=S;if(Ee=($=A(C))[0]??S,Me=$[1]??S,ke=$[3]??S,ve=$[11]??S,ye=$[12]??S,_(oe(m,0))&&_(K(m,ve)))_(oe(se.racc_error_status,0))&&(T(se.racc_t,1)||(se.racc_error_status=z(se.racc_error_status,1))),se.racc_vstack.$push(se.racc_val),se.racc_state.$push(m),se.racc_read_next=!0,_(se.yydebug)&&(se.racc_tstack.$push(se.racc_t),se.$racc_shift(se.racc_t,se.racc_tstack,se.racc_vstack));else if(_(K(m,0))&&_(oe(m,ye["$-@"]()))){if(he=U(se,"catch",["racc_jump"],function be(){var ae=be.$$s??this;return null==ae.racc_state&&(ae.racc_state=S),ae.racc_state.$push(ae.$_racc_do_reduce(C,m)),!1},{$$s:se}),_(he))switch(he){case 1:return se.racc_user_yyerror=!0,ye["$-@"]();case 2:return ve;default:se.$raise("[Racc Bug] unknown jump code")}}else if(T(m,ve))_(se.yydebug)&&se.$racc_accept(),se.$throw("racc_end_parse",se.racc_vstack["$[]"](0));else{if(T(m,ye["$-@"]())){switch(se.racc_error_status){case 0:_(C["$[]"](21))||se.$on_error(se.racc_t,se.racc_val,se.racc_vstack);break;case 3:T(se.racc_t,0)&&se.$throw("racc_end_parse",S),se.racc_read_next=!0}for(se.racc_user_yyerror=!1,se.racc_error_status=3;_(!0)&&!(_(Ie=ke["$[]"](se.racc_state["$[]"](-1)))&&(Ie=Y(Ie,1),_(j(Ie,0))&&_(m=Ee["$[]"](Ie))&&T(Me["$[]"](Ie),se.racc_state["$[]"](-1))));)_(q(se.racc_state.$size(),1))&&se.$throw("racc_end_parse",S),se.racc_state.$pop(),se.racc_vstack.$pop(),_(se.yydebug)&&(se.racc_tstack.$pop(),se.$racc_e_pop(se.racc_state,se.racc_tstack,se.racc_vstack));return m}se.$raise("[Racc Bug] unknown action "+m.$inspect())}return _(se.yydebug)&&se.$racc_next_state(se.racc_state["$[]"](-1),se.racc_state),S}),G(l,"$_racc_do_reduce",function(m,C){var $,ye,Ie,W,pe,we,Ye,se=this,Me=S,ce=S,ke=S,ve=S,he=S,be=S,ae=S,ue=S,xe=S,y=S,De=S,Le=S,ut=S;return Me=($=A(m))[4]??S,ce=$[5]??S,ke=$[6]??S,ve=$[7]??S,ye=$[8]??S,he=$[9]??S,Ie=$[13]??S,be=se.racc_state,ae=se.racc_vstack,ue=se.racc_tstack,xe=X(C,-3),y=he["$[]"](xe),W=he["$[]"](Y(xe,1)),pe=he["$[]"](Y(xe,2)),we=[],_(se.yydebug)&&(De=ue["$[]"](y["$-@"](),y)),Le=ae["$[]"](y["$-@"](),y),_(se.yydebug)&&ue["$[]="](y["$-@"](),y,we),ae["$[]="](y["$-@"](),y,we),be["$[]="](y["$-@"](),y,we),_(Ie)?ae.$push(se.$__send__(pe,Le,ae,Le["$[]"](0))):ae.$push(se.$__send__(pe,Le,ae)),ue.$push(W),_(se.yydebug)&&se.$racc_reduce(De,W,ue,ae),Ye=z(W,ye),_(xe=ve["$[]"](Ye))&&(xe=Y(xe,be["$[]"](-1)),_(j(xe,0))&&_(ut=Me["$[]"](xe))&&T(ce["$[]"](xe),Ye))?ut:ke["$[]"](Ye)}),G(l,"$on_error",function(m,C,$){var se;return this.$raise(f("ParseError"),this.$sprintf("\nparse error on value %s (%s)",C.$inspect(),_(se=this.$token_to_str(m))?se:"?"))}),G(l,"$yyerror",function(){return this.$throw("racc_jump",1)}),G(l,"$yyaccept",function(){return this.$throw("racc_jump",2)}),G(l,"$yyerrok",M("racc_error_status",0)),G(l,"$racc_read_token",function(m,C,$){var re=this;return re.racc_debug_out.$print("read    "),re.racc_debug_out.$print(C.$inspect(),"(",re.$racc_token2str(m),") "),re.racc_debug_out.$puts($.$inspect()),re.racc_debug_out.$puts()}),G(l,"$racc_shift",function(m,C,$){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(m)),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),G(l,"$racc_reduce",function(m,C,$,re){var se=this,Ee=S;return(Ee=se.racc_debug_out).$print("reduce "),_(m["$empty?"]())?Ee.$print(" <none>"):U(m,"each",[],function Me(ce){return null==ce&&(ce=S),Ee.$print(" ",(Me.$$s??this).$racc_token2str(ce))},{$$s:se}),Ee.$puts(" --\x3e "+se.$racc_token2str(C)),se.$racc_print_stacks($,re),se.racc_debug_out.$puts()}),G(l,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),G(l,"$racc_e_pop",function(m,C,$){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(m),this.$racc_print_stacks(C,$),this.racc_debug_out.$puts()}),G(l,"$racc_next_state",function(m,C){var $=this;return $.racc_debug_out.$puts("goto    "+m),$.$racc_print_states(C),$.racc_debug_out.$puts()}),G(l,"$racc_print_stacks",function(m,C){var re=S;return(re=this.racc_debug_out).$print("        ["),U(m,"each_index",[],function se(Ee){return null==Ee&&(Ee=S),re.$print(" (",(se.$$s??this).$racc_token2str(m["$[]"](Ee))," ",C["$[]"](Ee).$inspect(),")")},{$$s:this}),re.$puts(" ]")}),G(l,"$racc_print_states",function(m){var $=S;return($=this.racc_debug_out).$print("        ["),U(m,"each",[],function(se){return null==se&&(se=S),$.$print(" ",se)}),$.$puts(" ]")}),G(l,"$racc_token2str",function(m){var $;return _($=k(this.$class(),"Racc_token_to_s_table")["$[]"](m))?$:this.$raise("[Racc Bug] can't convert token "+m+" to string")}),G(l,"$token_to_str",function(m){return k(this.$class(),"Racc_token_to_s_table")["$[]"](m)})}(Q[0],Q)},Opal.modules.strscan=function(d){var T,j,oe,z,q,J=d.def,_=d.truthy,x=d.eqeqeq,O=d.Opal,w=d.return_ivar,K=d.send,G=d.alias,A=[],U=d.nil;return T=A,oe=[j=(0,d.klass)(A[0],null,"StringScanner")].concat(T),z=d.$r(oe),(q=j.$$prototype).pos=q.string=q.working=q.matched=q.prev_pos=q.match=U,j.$attr_reader("pos","matched"),J(j,"$initialize",function(M){var I=this;return I.string=M,I.pos=0,I.matched=U,I.working=M,I.match=[]}),j.$attr_reader("string"),J(j,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)}),J(j,"$scan",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return null==Q?I.matched=U:(I.prev_pos=I.pos,I.pos+=Q[0].length,I.working=I.working.substring(Q[0].length),I.matched=Q[0],I.match=Q,Q[0])}),J(j,"$scan_until",function(M){var I=this;M=I.$anchor(M);for(var Q=I.working,L=0;Q.length!=L;++L){var S=M.exec(Q.substr(L));if(null!==S){var k=L+S[0].length,v=Q.substr(0,k);return I.matched=S[0],I.match=S,I.prev_pos=I.pos+L,I.pos+=k,I.working=Q.substr(k),v}}return I.matched=U}),J(j,"$[]",function(M){var Q;if(_(this.match["$empty?"]()))return U;x(z("Symbol"),Q=M)?M=M.$to_s():x(z("String"),Q)||(M=O["$coerce_to!"](M,z("Integer"),"to_int"));var L=this.match;return M<0&&(M+=L.length),M<0||M>=L.length||null==L[M]?U:L[M]}),J(j,"$check",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return I.matched=null==Q?U:Q[0]}),J(j,"$check_until",function(M){var I=this,Q=I.prev_pos,L=I.pos,S=I.working,k=I.$scan_until(M);return I.prev_pos=Q,I.pos=L,I.working=S,k}),J(j,"$peek",function(M){return this.working.substring(0,M)}),J(j,"$eos?",function(){return 0===this.working.length}),J(j,"$exist?",function(M){var Q=M.exec(this.working);return null==Q?U:0==Q.index?0:Q.index+1}),J(j,"$skip",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);if(null==Q)return I.match=[],I.matched=U;var L=Q[0],S=L.length;return I.matched=L,I.match=Q,I.prev_pos=I.pos,I.pos+=S,I.working=I.working.substring(S),S}),J(j,"$skip_until",function(M){var Q=this.$scan_until(M);return Q===U?U:(this.matched=Q.substr(-1),Q.length)}),J(j,"$get_byte",function(){var M=this,I=U;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,I=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=U,I}),J(j,"$match?",function(M){var I=this,Q=(M=I.$anchor(M)).exec(I.working);return null==Q?U:(I.prev_pos=I.pos,Q[0].length)}),J(j,"$pos=",function(M){var I=this;return M<0&&(M+=I.string.$length()),I.pos=M,I.working=I.string.slice(M)}),J(j,"$matched_size",function(){return this.matched===U?U:this.matched.length}),J(j,"$post_match",function(){var M=this;return M.matched===U?U:M.string.substr(M.pos)}),J(j,"$pre_match",function(){var M=this;return M.matched===U?U:M.string.substr(0,M.prev_pos)}),J(j,"$reset",function(){var M=this;return M.working=M.string,M.matched=U,M.pos=0}),J(j,"$rest",w("working")),J(j,"$rest?",function(){return 0!==this.working.length}),J(j,"$rest_size",function(){return this.$rest().$size()}),J(j,"$terminate",function(){var M,I=this;return I.match=U,M=[I.string.$length()],K(I,"pos=",M),M[M.length-1]}),J(j,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=U,M.match=U,M}),G(j,"bol?","beginning_of_line?"),G(j,"getch","get_byte"),j.$private(),J(j,"$anchor",function(M){var I=M.toString().match(/\/([^\/]+)$/);return I=I?I[1]:void 0,new RegExp("^(?:"+M.source+")",I)})},Opal.modules["bcdice/normalize"]=function(d){var G,Y,U,H=d.module,J=d.eqeqeq,_=d.def,x=d.eqeq,O=[],w=d.nil;return G=O,U=[H(O[0],"BCDice")].concat(G),(Y=H(U[0],"Normalize")).$module_function(),_(Y,"$comparison_operator",function(j){var oe;return J(/<=|=</,oe=j)?"<=":J(/>=|=>/,oe)?">=":J(/<>|!=|=!/,oe)?"!=":J(/</,oe)?"<":J(/>/,oe)?">":J(/=/,oe)?"==":w}),_(Y,"$target_number",function(j){return x(j,"?")?j:j.$to_i()})},Opal.modules["bcdice/common_command/lexer"]=function(d){var N,oe,I,Q,L,S,q,T,H=d.module,J=d.klass,_=d.const_set,x=d.hash2,O=d.truthy,w=d.def,K=d.top,G=[],A=d.nil;return K.$require("strscan"),K.$require("bcdice/normalize"),N=G,oe=T=[H(G[0],"BCDice")].concat(N),I=q=[H(T[0],"CommonCommand")].concat(oe),L=[Q=J(q[0],null,"Lexer")].concat(I),S=d.$r(L),Q.$$prototype.scanner=A,_(L[0],"SYMBOLS",x(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),w(Q,"$initialize",function(P){var te;return P=O(te=P.$split(" ",2).$first())?te:"",this.scanner=S("StringScanner").$new(P)}),w(Q,"$next_token",function(){var P=this,B=A,te=A,D=A,R=A;return O(P.scanner["$eos?"]())?[!1,"$"]:O(B=P.scanner.$scan(/\d+/))?["NUMBER",B.$to_i()]:O(te=P.scanner.$scan(/[<>!=]+/))?["CMP_OP",S("Normalize").$comparison_operator(te)]:(D=P.scanner.$getch().$upcase(),[O(R=S("SYMBOLS")["$[]"](D))?R:D.$to_sym(),D])}),w(Q,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/arithmetic/parser"]=function(d){var Y,z,L,P,B,te,D,fe,R,F,g,l,u,S,k,v,X,M,j,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.hash,w=d.const_set,K=d.top,G=[],A=d.nil,U=d.$$$;return K.$require("racc/parser.rb"),K.$require("bcdice/common_command/lexer"),K.$require("bcdice/arithmetic/node"),Y=G,z=j=[H(G[0],"BCDice")].concat(Y),X=[H(j[0],"Arithmetic")].concat(z),M=d.$r(X),L=X,k=[S=J(X[0],U(M("Racc"),"Parser"),"Parser")].concat(L),v=d.$r(k),S.$$prototype.lexer=A,_(S,"$parse",function(re){return this.$new().$parse(re)}),x(S,"$parse",function(re){try{return this.lexer=U(U(v("BCDice"),"CommonCommand"),"Lexer").$new(re),this.$do_parse()}catch(Ee){if(!d.rescue(Ee,[v("ParseError")]))throw Ee;try{return A}finally{d.pop_exception()}}}),S.$private(),x(S,"$next_token",function(){return this.lexer.$next_token()}),P=d.large_array_unpack("8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,,,4,5,4,5,7,9,7,,,10,11,,10,11,22,26,24,25,27"),B=d.large_array_unpack("0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,,,12,12,13,13,12,1,13,,,16,16,,1,1,16,21,21,21,21"),te=[-2,40,-6,A,0,8,A,10,A,1,18,20,28,30,A,A,37,A,4,14,A,47,A,A,A,A,A,A],D=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],fe=[14,15,23,1,18,19,A,A,20,21,16],R=[3,3,4,1,2,2,A,A,3,3,1],F=[A,3,-6,-4,-19,A],g=[A,A,2,3,A,6],l=d.large_array_unpack("0,0,racc_error,3,14,_reduce_1,3,14,_reduce_2,1,14,_reduce_none,3,15,_reduce_4,4,15,_reduce_5,1,15,_reduce_none,0,17,_reduce_7,1,17,_reduce_8,1,17,_reduce_9,1,17,_reduce_10,1,17,_reduce_11,2,16,_reduce_12,2,16,_reduce_13,1,16,_reduce_none,3,18,_reduce_15,1,18,_reduce_16"),u=O(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),w(k[0],"Racc_arg",[P,B,D,te,fe,R,g,F,13,l,u,28,17,!0]),w(k[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),w(k[0],"Racc_debug_parser",!1),x(S,"$_reduce_1",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"BinaryOp").$new(re["$[]"](0),"+",re["$[]"](2))}),x(S,"$_reduce_2",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"BinaryOp").$new(re["$[]"](0),"-",re["$[]"](2))}),x(S,"$_reduce_4",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"BinaryOp").$new(re["$[]"](0),"*",re["$[]"](2))}),x(S,"$_reduce_5",function(re,se,Ee){return re["$[]"](3).$new(re["$[]"](0),re["$[]"](2))}),x(S,"$_reduce_7",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),x(S,"$_reduce_8",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithCeil")}),x(S,"$_reduce_9",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithCeil")}),x(S,"$_reduce_10",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithRound")}),x(S,"$_reduce_11",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"DivideWithFloor")}),x(S,"$_reduce_12",function(re,se,Ee){return re["$[]"](1)}),x(S,"$_reduce_13",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"Negative").$new(re["$[]"](1))}),x(S,"$_reduce_15",function(re,se,Ee){return re["$[]"](1)}),x(S,"$_reduce_16",function(re,se,Ee){return U(U(v("Arithmetic"),"Node"),"Number").$new(re["$[]"](0))}),x(S,"$_reduce_none",function(re,se,Ee){return re["$[]"](0)})},Opal.modules["bcdice/arithmetic"]=function(d){var G,Y,oe,q,X,T,j,U,H=d.module,J=d.thrower,_=d.def,x=d.top,O=[],w=d.nil;return x.$require("bcdice/arithmetic/node"),x.$require("bcdice/arithmetic/parser"),G=O,Y=U=[H(O[0],"BCDice")].concat(G),j=[T=H(U[0],"Arithmetic")].concat(Y),q=[oe=d.get_singleton_class(T)].concat(j),X=d.$r(q),_(oe,"$eval",function(I,Q){try{var S;J("eval_return");try{return(S=X("Parser").$parse(I))===w||null==S?w:S.$eval(Q)}catch(v){if(!d.rescue(v,[X("ZeroDivisionError")]))throw v;try{return w}finally{d.pop_exception()}}}catch(v){if(v===d.t_eval_return)return v.$v;throw v}})},Opal.queue(function(d){var T,X,M,I,Q,L,oe,H=d.module,J=d.klass,_=d.defs,x=d.def,O=d.send,w=d.truthy,K=d.eqeq,G=d.thrower,U=[],N=d.nil;return d.top.$require("bcdice/arithmetic"),T=U,X=oe=[H(U[0],"BCDice")].concat(T),I=[M=J(oe[0],null,"Preprocessor")].concat(X),Q=d.$r(I),(L=M.$$prototype).game_system=L.text=N,_(M,"$process",function(k,v){return Q("Preprocessor").$new(k,v).$process()}),x(M,"$initialize",function(k,v){return this.text=k,this.game_system=v}),x(M,"$process",function(){var k=this;return k.$trim_after_whitespace(),k.$replace_parentheses(),k.text=k.game_system.$change_text(k.text),k.$replace_implicit_d(),k.text}),M.$private(),x(M,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()}),x(M,"$replace_parentheses",function(){try{G("eval_return");var v=this;return function(){try{var P=G("break");return O(v,"loop",[],function B(){var D,te=B.$$s??this;if(null==te.text&&(te.text=N),D=te.text,te.text=O(te.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function fe(R){var g,F=fe.$$s??this;return null==F.game_system&&(F.game_system=N),null==R&&(R=N),w(g=Q("Arithmetic").$eval(R,F.game_system.$round_type()))?g:R},{$$s:te}),!K(D,te.text))return N;P.$throw()},{$$s:v})}catch(B){if(B===P)return B.$v;throw B}}()}catch(P){if(P===d.t_eval_return)return P.$v;throw P}}),x(M,"$replace_implicit_d",function(){var k=this;return k.text=O(k.text,"gsub",[/(\d+)D([^\w]|$)/i],function v(){var P=v.$$s??this;return null==P.game_system&&(P.game_system=N),Q("Regexp").$last_match(1)+"D"+P.game_system.$sides_implicit_d()+Q("Regexp").$last_match(2)},{$$s:k})})})},6956:(E,le,me)=>{me(9993),Opal.queue(function(d){var w,_=[];return w=_,(0,d.const_set)([(0,d.module)(_[0],"BCDice")].concat(w)[0],"VERSION","3.9.0")})},3583:function(E,le,me){"use strict";var d=this&&this.__importDefault||function(_){return _&&_.__esModule?_:{default:_}};Object.defineProperty(le,"__esModule",{value:!0}),le.Opal=le.I18n=le.BCDice=void 0,me(6956);var H=d(me(8459));le.BCDice=H.default.module(null,"BCDice"),le.I18n=H.default.module(null,"I18n");var J=me(8459);Object.defineProperty(le,"Opal",{enumerable:!0,get:function(){return d(J).default}})},8459:(E,le,me)=>{"use strict";Object.defineProperty(le,"__esModule",{value:!0}),le.nilToNull=void 0,me(9993),Opal.config.unsupported_features_severity="ignore",le.default=Opal,le.nilToNull=function d(H){return H===Opal.nil?null:H}},3604:function(E,le,me){"use strict";var N,d=this&&this.__extends||(N=function(Y,T){return(N=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,oe){j.__proto__=oe}||function(j,oe){for(var z in oe)Object.prototype.hasOwnProperty.call(oe,z)&&(j[z]=oe[z])})(Y,T)},function(Y,T){function j(){this.constructor=Y}N(Y,T),Y.prototype=null===T?Object.create(T):(j.prototype=T.prototype,new j)}),H=this&&this.__awaiter||function(N,Y,T,j){return new(T||(T=Promise))(function(z,q){function X(Q){try{I(j.next(Q))}catch(L){q(L)}}function M(Q){try{I(j.throw(Q))}catch(L){q(L)}}function I(Q){Q.done?z(Q.value):function oe(z){return z instanceof T?z:new T(function(q){q(z)})}(Q.value).then(X,M)}I((j=j.apply(N,Y||[])).next())})},J=this&&this.__generator||function(N,Y){var j,oe,z,q,T={label:0,sent:function(){if(1&z[0])throw z[1];return z[1]},trys:[],ops:[]};return q={next:X(0),throw:X(1),return:X(2)},"function"==typeof Symbol&&(q[Symbol.iterator]=function(){return this}),q;function X(I){return function(Q){return function M(I){if(j)throw new TypeError("Generator is already executing.");for(;T;)try{if(j=1,oe&&(z=2&I[0]?oe.return:I[0]?oe.throw||((z=oe.return)&&z.call(oe),0):oe.next)&&!(z=z.call(oe,I[1])).done)return z;switch(oe=0,z&&(I=[2&I[0],z.value]),I[0]){case 0:case 1:z=I;break;case 4:return T.label++,{value:I[1],done:!1};case 5:T.label++,oe=I[1],I=[0];continue;case 7:I=T.ops.pop(),T.trys.pop();continue;default:if(!(z=(z=T.trys).length>0&&z[z.length-1])&&(6===I[0]||2===I[0])){T=0;continue}if(3===I[0]&&(!z||I[1]>z[0]&&I[1]<z[3])){T.label=I[1];break}if(6===I[0]&&T.label<z[1]){T.label=z[1],z=I;break}if(z&&T.label<z[2]){T.label=z[2],T.ops.push(I);break}z[2]&&T.ops.pop(),T.trys.pop();continue}I=Y.call(N,T)}catch(Q){I=[6,Q],oe=0}finally{j=z=0}if(5&I[0])throw I[1];return{value:I[0]?I[1]:void 0,done:!0}}([I,Q])}}},_=this&&this.__importDefault||function(N){return N&&N.__esModule?N:{default:N}};Object.defineProperty(le,"__esModule",{value:!0}),le.getGameSystemClass=void 0;var x=_(me(5904)),O=me(3583),w=me(3693),K=_(me(4682)),G=_(me(3034));function A(N){var Y;return(Y=function(T){function j(oe,z){return T.call(this,oe,z??N.$new(oe))||this}return d(j,T),j.eval=function(oe){return w.parseResult(N.$eval(oe))},j}(x.default)).ID=N.$const_get("ID"),Y.NAME=N.$const_get("NAME"),Y.SORT_KEY=N.$const_get("SORT_KEY"),Y.HELP_MESSAGE=N.$const_get("HELP_MESSAGE"),Y.COMMAND_PATTERN=N.$command_pattern(),Y}le.getGameSystemClass=A;var U=function(){function N(){}return N.prototype.getGameSystemIdByName=function(Y){var T,j=null===(T=this.listAvailableGameSystems().find(function(oe){return oe.name===Y}))||void 0===T?void 0:T.id;if(!j)throw new Error("GameSystem named "+Y+" does not exists");return j},N.prototype.getGameSystemInfo=function(Y){var T=this.listAvailableGameSystems().find(function(j){return j.id===Y});if(!T)throw new Error("GameSystem is not found");return T},N.prototype.getGameSystemClass=function(Y){var T=this.listLoadedGameSystems().find(function(j){return j.ID===Y});if(!T)throw new Error("GameSystem "+Y+" is not loaded");return T},N.prototype.getI18nInfos=function(Y){var T=Y.replace(/_[^0-9].*$/g,""),j=this.listAvailabletI18nInfoList().find(function(q){return q.baseClassName===T||q.baseClassName===Y}),oe=j?[j]:[],z=this.listAvailableGameSystems().find(function(q){return q.className===Y});return z?Array.from(new Set(this.getI18nInfos(z.superClassName).concat(oe))):oe},N.prototype.listLoadedGameSystems=function(){var Y,T,j;return null!==(j=null===(T=null===(Y=O.BCDice.GameSystem)||void 0===Y?void 0:Y.$constants())||void 0===T?void 0:T.map(function(oe){return A(O.BCDice.GameSystem[oe])}))&&void 0!==j?j:[]},N.prototype.listAvailableGameSystems=function(){return K.default.gameSystems},N.prototype.listAvailabletI18nInfoList=function(){return G.default.i18nList},N.prototype.dynamicLoad=function(Y){var T;return H(this,void 0,void 0,function(){var j,oe,z,q,X,M,I,Q,L,k,v,P,B;return J(this,function(te){switch(te.label){case 0:if(j=this.getGameSystemInfo(Y),!(oe=null!==(T=j?.className)&&void 0!==T?T:Y).match(/^[A-Z]\w*$/))throw new Error("Invalid id");z=this.getI18nInfos(oe),q=0,X=z,te.label=1;case 1:if(!(q<X.length))return[3,6];I=(M=X[q]).locales.filter(function(D){return D===j.locale||D===O.I18n.$default_locale()}),Q=0,L=I,te.label=2;case 2:return Q<L.length?(P=(v=JSON).stringify,[4,this.dynamicImportI18n(M.baseClassName,L[Q])]):[3,5];case 3:k=P.apply(v,[te.sent()]),O.I18n.$load_translation(k),te.label=4;case 4:return Q++,[3,2];case 5:return q++,[3,1];case 6:return[4,this.dynamicImport(oe)];case 7:if(te.sent(),!(B=O.BCDice.GameSystem.$const_get(oe)))throw new Error("Failed to load game system");return[2,A(B)]}})})},N.prototype.dynamicImportI18n=function(Y,T){throw new Error("Not implemented")},N.prototype.dynamicImport=function(Y){throw new Error("Not implemented")},N}();le.default=U},3693:function(E,le,me){"use strict";var d=this&&this.__assign||function(){return d=Object.assign||function(x){for(var O,w=1,K=arguments.length;w<K;w++)for(var G in O=arguments[w])Object.prototype.hasOwnProperty.call(O,G)&&(x[G]=O[G]);return x},d.apply(this,arguments)},H=this&&this.__rest||function(x,O){var w={};for(var K in x)Object.prototype.hasOwnProperty.call(x,K)&&O.indexOf(K)<0&&(w[K]=x[K]);if(null!=x&&"function"==typeof Object.getOwnPropertySymbols){var G=0;for(K=Object.getOwnPropertySymbols(x);G<K.length;G++)O.indexOf(K[G])<0&&Object.prototype.propertyIsEnumerable.call(x,K[G])&&(w[K[G]]=x[K[G]])}return w};Object.defineProperty(le,"__esModule",{value:!0}),le.parseResult=void 0;var J=me(3583);le.parseResult=function _(x){if(x===J.Opal.nil)return null;var O=x.detailed_rands,w=H(x,["detailed_rands"]);return d(d({},w),{detailedRands:O.map(function(K){return K.$to_n()})})}},7585:function(E,le,me){var d;E.exports=(d=d||function(H,J){var _;if(typeof window<"u"&&window.crypto&&(_=window.crypto),typeof self<"u"&&self.crypto&&(_=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(_=globalThis.crypto),!_&&typeof window<"u"&&window.msCrypto&&(_=window.msCrypto),!_&&typeof global<"u"&&global.crypto&&(_=global.crypto),!_)try{_=me(2480)}catch{}var x=function(){if(_){if("function"==typeof _.getRandomValues)try{return _.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof _.randomBytes)try{return _.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},O=Object.create||function(){function q(){}return function(X){var M;return q.prototype=X,M=new q,q.prototype=null,M}}(),w={},K=w.lib={},G=K.Base={extend:function(q){var X=O(this);return q&&X.mixIn(q),(!X.hasOwnProperty("init")||this.init===X.init)&&(X.init=function(){X.$super.init.apply(this,arguments)}),X.init.prototype=X,X.$super=this,X},create:function(){var q=this.extend();return q.init.apply(q,arguments),q},init:function(){},mixIn:function(q){for(var X in q)q.hasOwnProperty(X)&&(this[X]=q[X]);q.hasOwnProperty("toString")&&(this.toString=q.toString)},clone:function(){return this.init.prototype.extend(this)}},A=K.WordArray=G.extend({init:function(q,X){q=this.words=q||[],this.sigBytes=null!=X?X:4*q.length},toString:function(q){return(q||N).stringify(this)},concat:function(q){var X=this.words,M=q.words,I=this.sigBytes,Q=q.sigBytes;if(this.clamp(),I%4)for(var L=0;L<Q;L++)X[I+L>>>2]|=(M[L>>>2]>>>24-L%4*8&255)<<24-(I+L)%4*8;else for(var k=0;k<Q;k+=4)X[I+k>>>2]=M[k>>>2];return this.sigBytes+=Q,this},clamp:function(){var q=this.words,X=this.sigBytes;q[X>>>2]&=4294967295<<32-X%4*8,q.length=H.ceil(X/4)},clone:function(){var q=G.clone.call(this);return q.words=this.words.slice(0),q},random:function(q){for(var X=[],M=0;M<q;M+=4)X.push(x());return new A.init(X,q)}}),U=w.enc={},N=U.Hex={stringify:function(q){for(var X=q.words,M=q.sigBytes,I=[],Q=0;Q<M;Q++){var L=X[Q>>>2]>>>24-Q%4*8&255;I.push((L>>>4).toString(16)),I.push((15&L).toString(16))}return I.join("")},parse:function(q){for(var X=q.length,M=[],I=0;I<X;I+=2)M[I>>>3]|=parseInt(q.substr(I,2),16)<<24-I%8*4;return new A.init(M,X/2)}},Y=U.Latin1={stringify:function(q){for(var X=q.words,M=q.sigBytes,I=[],Q=0;Q<M;Q++)I.push(String.fromCharCode(X[Q>>>2]>>>24-Q%4*8&255));return I.join("")},parse:function(q){for(var X=q.length,M=[],I=0;I<X;I++)M[I>>>2]|=(255&q.charCodeAt(I))<<24-I%4*8;return new A.init(M,X)}},T=U.Utf8={stringify:function(q){try{return decodeURIComponent(escape(Y.stringify(q)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(q){return Y.parse(unescape(encodeURIComponent(q)))}},j=K.BufferedBlockAlgorithm=G.extend({reset:function(){this._data=new A.init,this._nDataBytes=0},_append:function(q){"string"==typeof q&&(q=T.parse(q)),this._data.concat(q),this._nDataBytes+=q.sigBytes},_process:function(q){var X,M=this._data,I=M.words,Q=M.sigBytes,L=this.blockSize,k=Q/(4*L),v=(k=q?H.ceil(k):H.max((0|k)-this._minBufferSize,0))*L,P=H.min(4*v,Q);if(v){for(var B=0;B<v;B+=L)this._doProcessBlock(I,B);X=I.splice(0,v),M.sigBytes-=P}return new A.init(X,P)},clone:function(){var q=G.clone.call(this);return q._data=this._data.clone(),q},_minBufferSize:0}),z=(K.Hasher=j.extend({cfg:G.extend(),init:function(q){this.cfg=this.cfg.extend(q),this.reset()},reset:function(){j.reset.call(this),this._doReset()},update:function(q){return this._append(q),this._process(),this},finalize:function(q){return q&&this._append(q),this._doFinalize()},blockSize:16,_createHelper:function(q){return function(X,M){return new q.init(M).finalize(X)}},_createHmacHelper:function(q){return function(X,M){return new z.HMAC.init(q,M).finalize(X)}}}),w.algo={});return w}(Math),d)},7412:function(E,le,me){var d;E.exports=(d=me(7585),function(){if("function"==typeof ArrayBuffer){var _=d.lib.WordArray,x=_.init,O=_.init=function(w){if(w instanceof ArrayBuffer&&(w=new Uint8Array(w)),(w instanceof Int8Array||typeof Uint8ClampedArray<"u"&&w instanceof Uint8ClampedArray||w instanceof Int16Array||w instanceof Uint16Array||w instanceof Int32Array||w instanceof Uint32Array||w instanceof Float32Array||w instanceof Float64Array)&&(w=new Uint8Array(w.buffer,w.byteOffset,w.byteLength)),w instanceof Uint8Array){for(var K=w.byteLength,G=[],A=0;A<K;A++)G[A>>>2]|=w[A]<<24-A%4*8;x.call(this,G,K)}else x.apply(this,arguments)};O.prototype=_}}(),d.lib.WordArray)},1817:function(E,le,me){var d;E.exports=(d=me(7585),function(H){var J=d,_=J.lib,x=_.WordArray,O=_.Hasher,w=J.algo,K=[],G=[];!function(){function N(oe){for(var z=H.sqrt(oe),q=2;q<=z;q++)if(!(oe%q))return!1;return!0}function Y(oe){return 4294967296*(oe-(0|oe))|0}for(var T=2,j=0;j<64;)N(T)&&(j<8&&(K[j]=Y(H.pow(T,.5))),G[j]=Y(H.pow(T,1/3)),j++),T++}();var A=[],U=w.SHA256=O.extend({_doReset:function(){this._hash=new x.init(K.slice(0))},_doProcessBlock:function(N,Y){for(var T=this._hash.words,j=T[0],oe=T[1],z=T[2],q=T[3],X=T[4],M=T[5],I=T[6],Q=T[7],L=0;L<64;L++){if(L<16)A[L]=0|N[Y+L];else{var S=A[L-15],v=A[L-2];A[L]=((S<<25|S>>>7)^(S<<14|S>>>18)^S>>>3)+A[L-7]+((v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10)+A[L-16]}var te=j&oe^j&z^oe&z,R=Q+((X<<26|X>>>6)^(X<<21|X>>>11)^(X<<7|X>>>25))+(X&M^~X&I)+G[L]+A[L];Q=I,I=M,M=X,X=q+R|0,q=z,z=oe,oe=j,j=R+(((j<<30|j>>>2)^(j<<19|j>>>13)^(j<<10|j>>>22))+te)|0}T[0]=T[0]+j|0,T[1]=T[1]+oe|0,T[2]=T[2]+z|0,T[3]=T[3]+q|0,T[4]=T[4]+X|0,T[5]=T[5]+M|0,T[6]=T[6]+I|0,T[7]=T[7]+Q|0},_doFinalize:function(){var N=this._data,Y=N.words,T=8*this._nDataBytes,j=8*N.sigBytes;return Y[j>>>5]|=128<<24-j%32,Y[14+(j+64>>>9<<4)]=H.floor(T/4294967296),Y[15+(j+64>>>9<<4)]=T,N.sigBytes=4*Y.length,this._process(),this._hash},clone:function(){var N=O.clone.call(this);return N._hash=this._hash.clone(),N}});J.SHA256=O._createHelper(U),J.HmacSHA256=O._createHmacHelper(U)}(Math),d.SHA256)},6654:E=>{!function(me){E.exports=me;var d="listeners",H={on:function _(G,A){return K(this,G).push(A),this},once:function x(G,A){var U=this;return N.originalListener=A,K(U,G).push(N),U;function N(){O.call(U,G,N),A.apply(this,arguments)}},off:O,emit:function w(G,A){var U=this,N=K(U,G,!0);if(!N)return!1;var Y=arguments.length;if(1===Y)N.forEach(j);else if(2===Y)N.forEach(oe);else{var T=Array.prototype.slice.call(arguments,1);N.forEach(z)}return!!N.length;function j(q){q.call(U)}function oe(q){q.call(U,A)}function z(q){q.apply(U,T)}}};function J(G){for(var A in H)G[A]=H[A];return G}function O(G,A){var N,U=this;if(arguments.length){if(A){if(N=K(U,G,!0)){if(!(N=N.filter(Y)).length)return O.call(U,G);U[d][G]=N}}else if((N=U[d])&&(delete N[G],!Object.keys(N).length))return O.call(U)}else delete U[d];return U;function Y(T){return T!==A&&T.originalListener!==A}}function K(G,A,U){if(!U||G[d]){var N=G[d]||(G[d]={});return N[A]||(N[A]=[])}}J(me.prototype),me.mixin=J}(function le(){if(!(this instanceof le))return new le})},9069:E=>{"use strict";var d,le="object"==typeof Reflect?Reflect:null,me=le&&"function"==typeof le.apply?le.apply:function(M,I,Q){return Function.prototype.apply.call(M,I,Q)};d=le&&"function"==typeof le.ownKeys?le.ownKeys:Object.getOwnPropertySymbols?function(M){return Object.getOwnPropertyNames(M).concat(Object.getOwnPropertySymbols(M))}:function(M){return Object.getOwnPropertyNames(M)};var J=Number.isNaN||function(M){return M!=M};function _(){_.init.call(this)}E.exports=_,E.exports.once=function oe(X,M){return new Promise(function(I,Q){function L(k){X.removeListener(M,S),Q(k)}function S(){"function"==typeof X.removeListener&&X.removeListener("error",L),I([].slice.call(arguments))}q(X,M,S,{once:!0}),"error"!==M&&function z(X,M,I){"function"==typeof X.on&&q(X,"error",M,I)}(X,L,{once:!0})})},_.EventEmitter=_,_.prototype._events=void 0,_.prototype._eventsCount=0,_.prototype._maxListeners=void 0;var x=10;function O(X){if("function"!=typeof X)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof X)}function w(X){return void 0===X._maxListeners?_.defaultMaxListeners:X._maxListeners}function K(X,M,I,Q){var L,S,k;if(O(I),void 0===(S=X._events)?(S=X._events=Object.create(null),X._eventsCount=0):(void 0!==S.newListener&&(X.emit("newListener",M,I.listener?I.listener:I),S=X._events),k=S[M]),void 0===k)k=S[M]=I,++X._eventsCount;else if("function"==typeof k?k=S[M]=Q?[I,k]:[k,I]:Q?k.unshift(I):k.push(I),(L=w(X))>0&&k.length>L&&!k.warned){k.warned=!0;var v=new Error("Possible EventEmitter memory leak detected. "+k.length+" "+String(M)+" listeners added. Use emitter.setMaxListeners() to increase limit");v.name="MaxListenersExceededWarning",v.emitter=X,v.type=M,v.count=k.length,function H(X){console&&console.warn&&console.warn(X)}(v)}return X}function G(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function A(X,M,I){var Q={fired:!1,wrapFn:void 0,target:X,type:M,listener:I},L=G.bind(Q);return L.listener=I,Q.wrapFn=L,L}function U(X,M,I){var Q=X._events;if(void 0===Q)return[];var L=Q[M];return void 0===L?[]:"function"==typeof L?I?[L.listener||L]:[L]:I?function j(X){for(var M=new Array(X.length),I=0;I<M.length;++I)M[I]=X[I].listener||X[I];return M}(L):Y(L,L.length)}function N(X){var M=this._events;if(void 0!==M){var I=M[X];if("function"==typeof I)return 1;if(void 0!==I)return I.length}return 0}function Y(X,M){for(var I=new Array(M),Q=0;Q<M;++Q)I[Q]=X[Q];return I}function q(X,M,I,Q){if("function"==typeof X.on)Q.once?X.once(M,I):X.on(M,I);else{if("function"!=typeof X.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof X);X.addEventListener(M,function L(S){Q.once&&X.removeEventListener(M,L),I(S)})}}Object.defineProperty(_,"defaultMaxListeners",{enumerable:!0,get:function(){return x},set:function(X){if("number"!=typeof X||X<0||J(X))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+X+".");x=X}}),_.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},_.prototype.setMaxListeners=function(M){if("number"!=typeof M||M<0||J(M))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+M+".");return this._maxListeners=M,this},_.prototype.getMaxListeners=function(){return w(this)},_.prototype.emit=function(M){for(var I=[],Q=1;Q<arguments.length;Q++)I.push(arguments[Q]);var L="error"===M,S=this._events;if(void 0!==S)L=L&&void 0===S.error;else if(!L)return!1;if(L){var k;if(I.length>0&&(k=I[0]),k instanceof Error)throw k;var v=new Error("Unhandled error."+(k?" ("+k.message+")":""));throw v.context=k,v}var P=S[M];if(void 0===P)return!1;if("function"==typeof P)me(P,this,I);else{var B=P.length,te=Y(P,B);for(Q=0;Q<B;++Q)me(te[Q],this,I)}return!0},_.prototype.on=_.prototype.addListener=function(M,I){return K(this,M,I,!1)},_.prototype.prependListener=function(M,I){return K(this,M,I,!0)},_.prototype.once=function(M,I){return O(I),this.on(M,A(this,M,I)),this},_.prototype.prependOnceListener=function(M,I){return O(I),this.prependListener(M,A(this,M,I)),this},_.prototype.off=_.prototype.removeListener=function(M,I){var Q,L,S,k,v;if(O(I),void 0===(L=this._events))return this;if(void 0===(Q=L[M]))return this;if(Q===I||Q.listener===I)0==--this._eventsCount?this._events=Object.create(null):(delete L[M],L.removeListener&&this.emit("removeListener",M,Q.listener||I));else if("function"!=typeof Q){for(S=-1,k=Q.length-1;k>=0;k--)if(Q[k]===I||Q[k].listener===I){v=Q[k].listener,S=k;break}if(S<0)return this;0===S?Q.shift():function T(X,M){for(;M+1<X.length;M++)X[M]=X[M+1];X.pop()}(Q,S),1===Q.length&&(L[M]=Q[0]),void 0!==L.removeListener&&this.emit("removeListener",M,v||I)}return this},_.prototype.removeAllListeners=function(M){var I,Q,L;if(void 0===(Q=this._events))return this;if(void 0===Q.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==Q[M]&&(0==--this._eventsCount?this._events=Object.create(null):delete Q[M]),this;if(0===arguments.length){var k,S=Object.keys(Q);for(L=0;L<S.length;++L)"removeListener"!==(k=S[L])&&this.removeAllListeners(k);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(I=Q[M]))this.removeListener(M,I);else if(void 0!==I)for(L=I.length-1;L>=0;L--)this.removeListener(M,I[L]);return this},_.prototype.listeners=function(M){return U(this,M,!0)},_.prototype.rawListeners=function(M){return U(this,M,!1)},_.listenerCount=function(X,M){return"function"==typeof X.listenerCount?X.listenerCount(M):N.call(X,M)},_.prototype.listenerCount=N,_.prototype.eventNames=function(){return this._eventsCount>0?d(this._events):[]}},4327:function(E,le){var H;void 0!==(H=function(){"use strict";function _(A,U,N){var Y=new XMLHttpRequest;Y.open("GET",A),Y.responseType="blob",Y.onload=function(){G(Y.response,U,N)},Y.onerror=function(){console.error("could not download file")},Y.send()}function x(A){var U=new XMLHttpRequest;U.open("HEAD",A,!1);try{U.send()}catch{}return 200<=U.status&&299>=U.status}function O(A){try{A.dispatchEvent(new MouseEvent("click"))}catch{var U=document.createEvent("MouseEvents");U.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),A.dispatchEvent(U)}}var w="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,K=w.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),G=w.saveAs||("object"!=typeof window||window!==w?function(){}:"download"in HTMLAnchorElement.prototype&&!K?function(A,U,N){var Y=w.URL||w.webkitURL,T=document.createElement("a");T.download=U=U||A.name||"download",T.rel="noopener","string"==typeof A?(T.href=A,T.origin===location.origin?O(T):x(T.href)?_(A,U,N):O(T,T.target="_blank")):(T.href=Y.createObjectURL(A),setTimeout(function(){Y.revokeObjectURL(T.href)},4e4),setTimeout(function(){O(T)},0))}:"msSaveOrOpenBlob"in navigator?function(A,U,N){if(U=U||A.name||"download","string"!=typeof A)navigator.msSaveOrOpenBlob(function J(A,U){return typeof U>"u"?U={autoBom:!1}:"object"!=typeof U&&(console.warn("Deprecated: Expected third argument to be a object"),U={autoBom:!U}),U.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(A.type)?new Blob(["\ufeff",A],{type:A.type}):A}(A,N),U);else if(x(A))_(A,U,N);else{var Y=document.createElement("a");Y.href=A,Y.target="_blank",setTimeout(function(){O(Y)})}}:function(A,U,N,Y){if((Y=Y||open("","_blank"))&&(Y.document.title=Y.document.body.innerText="downloading..."),"string"==typeof A)return _(A,U,N);var T="application/octet-stream"===A.type,j=/constructor/i.test(w.HTMLElement)||w.safari,oe=/CriOS\/[\d]+/.test(navigator.userAgent);if((oe||T&&j||K)&&typeof FileReader<"u"){var z=new FileReader;z.onloadend=function(){var M=z.result;M=oe?M:M.replace(/^data:[^;]*;/,"data:attachment/file;"),Y?Y.location.href=M:location=M,Y=null},z.readAsDataURL(A)}else{var q=w.URL||w.webkitURL,X=q.createObjectURL(A);Y?Y.location=X:location.href=X,Y=null,setTimeout(function(){q.revokeObjectURL(X)},4e4)}});w.saveAs=G.saveAs=G,E.exports=G}.apply(le,[]))&&(E.exports=H)},5386:(E,le,me)=>{var d;!function(H,J,_,x){"use strict";var oe,O=["","webkit","Moz","MS","ms","o"],w=J.createElement("div"),G=Math.round,A=Math.abs,U=Date.now;function N(Oe,ze,Ze){return setTimeout(M(Oe,Ze),ze)}function Y(Oe,ze,Ze){return!!Array.isArray(Oe)&&(T(Oe,Ze[ze],Ze),!0)}function T(Oe,ze,Ze){var ft;if(Oe)if(Oe.forEach)Oe.forEach(ze,Ze);else if(Oe.length!==x)for(ft=0;ft<Oe.length;)ze.call(Ze,Oe[ft],ft,Oe),ft++;else for(ft in Oe)Oe.hasOwnProperty(ft)&&ze.call(Ze,Oe[ft],ft,Oe)}function j(Oe,ze,Ze){var ft="DEPRECATED METHOD: "+ze+"\n"+Ze+" AT \n";return function(){var Ft=new Error("get-stack-trace"),Yt=Ft&&Ft.stack?Ft.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Bn=H.console&&(H.console.warn||H.console.log);return Bn&&Bn.call(H.console,ft,Yt),Oe.apply(this,arguments)}}oe="function"!=typeof Object.assign?function(ze){if(ze===x||null===ze)throw new TypeError("Cannot convert undefined or null to object");for(var Ze=Object(ze),ft=1;ft<arguments.length;ft++){var Ft=arguments[ft];if(Ft!==x&&null!==Ft)for(var Yt in Ft)Ft.hasOwnProperty(Yt)&&(Ze[Yt]=Ft[Yt])}return Ze}:Object.assign;var z=j(function(ze,Ze,ft){for(var Ft=Object.keys(Ze),Yt=0;Yt<Ft.length;)(!ft||ft&&ze[Ft[Yt]]===x)&&(ze[Ft[Yt]]=Ze[Ft[Yt]]),Yt++;return ze},"extend","Use `assign`."),q=j(function(ze,Ze){return z(ze,Ze,!0)},"merge","Use `assign`.");function X(Oe,ze,Ze){var Ft,ft=ze.prototype;(Ft=Oe.prototype=Object.create(ft)).constructor=Oe,Ft._super=ft,Ze&&oe(Ft,Ze)}function M(Oe,ze){return function(){return Oe.apply(ze,arguments)}}function I(Oe,ze){return"function"==typeof Oe?Oe.apply(ze&&ze[0]||x,ze):Oe}function Q(Oe,ze){return Oe===x?ze:Oe}function L(Oe,ze,Ze){T(P(ze),function(ft){Oe.addEventListener(ft,Ze,!1)})}function S(Oe,ze,Ze){T(P(ze),function(ft){Oe.removeEventListener(ft,Ze,!1)})}function k(Oe,ze){for(;Oe;){if(Oe==ze)return!0;Oe=Oe.parentNode}return!1}function v(Oe,ze){return Oe.indexOf(ze)>-1}function P(Oe){return Oe.trim().split(/\s+/g)}function B(Oe,ze,Ze){if(Oe.indexOf&&!Ze)return Oe.indexOf(ze);for(var ft=0;ft<Oe.length;){if(Ze&&Oe[ft][Ze]==ze||!Ze&&Oe[ft]===ze)return ft;ft++}return-1}function te(Oe){return Array.prototype.slice.call(Oe,0)}function D(Oe,ze,Ze){for(var ft=[],Ft=[],Yt=0;Yt<Oe.length;){var Bn=ze?Oe[Yt][ze]:Oe[Yt];B(Ft,Bn)<0&&ft.push(Oe[Yt]),Ft[Yt]=Bn,Yt++}return Ze&&(ft=ze?ft.sort(function(er,xr){return er[ze]>xr[ze]}):ft.sort()),ft}function fe(Oe,ze){for(var Ze,ft,Ft=ze[0].toUpperCase()+ze.slice(1),Yt=0;Yt<O.length;){if((ft=(Ze=O[Yt])?Ze+Ft:ze)in Oe)return ft;Yt++}return x}var R=1;function g(Oe){var ze=Oe.ownerDocument||Oe;return ze.defaultView||ze.parentWindow||H}var c="ontouchstart"in H,f=fe(H,"PointerEvent")!==x,u=c&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),p="touch",C="mouse",xe=["x","y"],y=["clientX","clientY"];function W(Oe,ze){var Ze=this;this.manager=Oe,this.callback=ze,this.element=Oe.element,this.target=Oe.options.inputTarget,this.domHandler=function(ft){I(Oe.options.enable,[Oe])&&Ze.handler(ft)},this.init()}function we(Oe,ze,Ze){var ft=Ze.pointers.length,Ft=Ze.changedPointers.length,Yt=1&ze&&ft-Ft==0,Bn=12&ze&&ft-Ft==0;Ze.isFirst=!!Yt,Ze.isFinal=!!Bn,Yt&&(Oe.session={}),Ze.eventType=ze,function De(Oe,ze){var Ze=Oe.session,ft=ze.pointers,Ft=ft.length;Ze.firstInput||(Ze.firstInput=ut(ze)),Ft>1&&!Ze.firstMultiple?Ze.firstMultiple=ut(ze):1===Ft&&(Ze.firstMultiple=!1);var Yt=Ze.firstInput,Bn=Ze.firstMultiple,fi=Bn?Bn.center:Yt.center,er=ze.center=Dt(ft);ze.timeStamp=U(),ze.deltaTime=ze.timeStamp-Yt.timeStamp,ze.angle=On(fi,er),ze.distance=tn(fi,er),function Le(Oe,ze){var Ze=ze.center,ft=Oe.offsetDelta||{},Ft=Oe.prevDelta||{},Yt=Oe.prevInput||{};(1===ze.eventType||4===Yt.eventType)&&(Ft=Oe.prevDelta={x:Yt.deltaX||0,y:Yt.deltaY||0},ft=Oe.offsetDelta={x:Ze.x,y:Ze.y}),ze.deltaX=Ft.x+(Ze.x-ft.x),ze.deltaY=Ft.y+(Ze.y-ft.y)}(Ze,ze),ze.offsetDirection=un(ze.deltaX,ze.deltaY);var xr=Ot(ze.deltaTime,ze.deltaX,ze.deltaY);ze.overallVelocityX=xr.x,ze.overallVelocityY=xr.y,ze.overallVelocity=A(xr.x)>A(xr.y)?xr.x:xr.y,ze.scale=Bn?function yr(Oe,ze){return tn(ze[0],ze[1],y)/tn(Oe[0],Oe[1],y)}(Bn.pointers,ft):1,ze.rotation=Bn?function Mn(Oe,ze){return On(ze[1],ze[0],y)+On(Oe[1],Oe[0],y)}(Bn.pointers,ft):0,ze.maxPointers=Ze.prevInput?ze.pointers.length>Ze.prevInput.maxPointers?ze.pointers.length:Ze.prevInput.maxPointers:ze.pointers.length,function Ye(Oe,ze){var Ft,Yt,Bn,fi,Ze=Oe.lastInterval||ze,ft=ze.timeStamp-Ze.timeStamp;if(8!=ze.eventType&&(ft>25||Ze.velocity===x)){var er=ze.deltaX-Ze.deltaX,xr=ze.deltaY-Ze.deltaY,po=Ot(ft,er,xr);Yt=po.x,Bn=po.y,Ft=A(po.x)>A(po.y)?po.x:po.y,fi=un(er,xr),Oe.lastInterval=ze}else Ft=Ze.velocity,Yt=Ze.velocityX,Bn=Ze.velocityY,fi=Ze.direction;ze.velocity=Ft,ze.velocityX=Yt,ze.velocityY=Bn,ze.direction=fi}(Ze,ze);var po=Oe.element;k(ze.srcEvent.target,po)&&(po=ze.srcEvent.target),ze.target=po}(Oe,Ze),Oe.emit("hammer.input",Ze),Oe.recognize(Ze),Oe.session.prevInput=Ze}function ut(Oe){for(var ze=[],Ze=0;Ze<Oe.pointers.length;)ze[Ze]={clientX:G(Oe.pointers[Ze].clientX),clientY:G(Oe.pointers[Ze].clientY)},Ze++;return{timeStamp:U(),pointers:ze,center:Dt(ze),deltaX:Oe.deltaX,deltaY:Oe.deltaY}}function Dt(Oe){var ze=Oe.length;if(1===ze)return{x:G(Oe[0].clientX),y:G(Oe[0].clientY)};for(var Ze=0,ft=0,Ft=0;Ft<ze;)Ze+=Oe[Ft].clientX,ft+=Oe[Ft].clientY,Ft++;return{x:G(Ze/ze),y:G(ft/ze)}}function Ot(Oe,ze,Ze){return{x:ze/Oe||0,y:Ze/Oe||0}}function un(Oe,ze){return Oe===ze?1:A(Oe)>=A(ze)?Oe<0?2:4:ze<0?8:16}function tn(Oe,ze,Ze){Ze||(Ze=xe);var ft=ze[Ze[0]]-Oe[Ze[0]],Ft=ze[Ze[1]]-Oe[Ze[1]];return Math.sqrt(ft*ft+Ft*Ft)}function On(Oe,ze,Ze){return Ze||(Ze=xe),180*Math.atan2(ze[Ze[1]]-Oe[Ze[1]],ze[Ze[0]]-Oe[Ze[0]])/Math.PI}W.prototype={handler:function(){},init:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(g(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(g(this.element),this.evWin,this.domHandler)}};var fa={mousedown:1,mousemove:2,mouseup:4},ja="mousedown",Ua="mousemove mouseup";function wo(){this.evEl=ja,this.evWin=Ua,this.pressed=!1,W.apply(this,arguments)}X(wo,W,{handler:function(ze){var Ze=fa[ze.type];1&Ze&&0===ze.button&&(this.pressed=!0),2&Ze&&1!==ze.which&&(Ze=4),this.pressed&&(4&Ze&&(this.pressed=!1),this.callback(this.manager,Ze,{pointers:[ze],changedPointers:[ze],pointerType:C,srcEvent:ze}))}});var sr={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},kc={2:p,3:"pen",4:C,5:"kinect"},kl="pointerdown",Ha="pointermove pointerup pointercancel";function Va(){this.evEl=kl,this.evWin=Ha,W.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}H.MSPointerEvent&&!H.PointerEvent&&(kl="MSPointerDown",Ha="MSPointerMove MSPointerUp MSPointerCancel"),X(Va,W,{handler:function(ze){var Ze=this.store,ft=!1,Ft=ze.type.toLowerCase().replace("ms",""),Yt=sr[Ft],Bn=kc[ze.pointerType]||ze.pointerType,fi=Bn==p,er=B(Ze,ze.pointerId,"pointerId");1&Yt&&(0===ze.button||fi)?er<0&&(Ze.push(ze),er=Ze.length-1):12&Yt&&(ft=!0),!(er<0)&&(Ze[er]=ze,this.callback(this.manager,Yt,{pointers:Ze,changedPointers:[ze],pointerType:Bn,srcEvent:ze}),ft&&Ze.splice(er,1))}});var ed={touchstart:1,touchmove:2,touchend:4,touchcancel:8},Dc="touchstart",Ac="touchstart touchmove touchend touchcancel";function Dl(){this.evTarget=Dc,this.evWin=Ac,this.started=!1,W.apply(this,arguments)}function Pc(Oe,ze){var Ze=te(Oe.touches),ft=te(Oe.changedTouches);return 12&ze&&(Ze=D(Ze.concat(ft),"identifier",!0)),[Ze,ft]}X(Dl,W,{handler:function(ze){var Ze=ed[ze.type];if(1===Ze&&(this.started=!0),this.started){var ft=Pc.call(this,ze,Ze);12&Ze&&ft[0].length-ft[1].length==0&&(this.started=!1),this.callback(this.manager,Ze,{pointers:ft[0],changedPointers:ft[1],pointerType:p,srcEvent:ze})}}});var Cr={touchstart:1,touchmove:2,touchend:4,touchcancel:8},td="touchstart touchmove touchend touchcancel";function Ga(){this.evTarget=td,this.targetIds={},W.apply(this,arguments)}function nd(Oe,ze){var Ze=te(Oe.touches),ft=this.targetIds;if(3&ze&&1===Ze.length)return ft[Ze[0].identifier]=!0,[Ze,Ze];var Ft,Yt,Bn=te(Oe.changedTouches),fi=[],er=this.target;if(Yt=Ze.filter(function(xr){return k(xr.target,er)}),1===ze)for(Ft=0;Ft<Yt.length;)ft[Yt[Ft].identifier]=!0,Ft++;for(Ft=0;Ft<Bn.length;)ft[Bn[Ft].identifier]&&fi.push(Bn[Ft]),12&ze&&delete ft[Bn[Ft].identifier],Ft++;return fi.length?[D(Yt.concat(fi),"identifier",!0),fi]:void 0}function Pl(){W.apply(this,arguments);var Oe=M(this.handler,this);this.touch=new Ga(this.manager,Oe),this.mouse=new wo(this.manager,Oe),this.primaryTouch=null,this.lastTouches=[]}function id(Oe,ze){1&Oe?(this.primaryTouch=ze.changedPointers[0].identifier,fo.call(this,ze)):12&Oe&&fo.call(this,ze)}function fo(Oe){var ze=Oe.changedPointers[0];if(ze.identifier===this.primaryTouch){var Ze={x:ze.clientX,y:ze.clientY};this.lastTouches.push(Ze);var ft=this.lastTouches;setTimeout(function(){var Yt=ft.indexOf(Ze);Yt>-1&&ft.splice(Yt,1)},2500)}}function rd(Oe){for(var ze=Oe.srcEvent.clientX,Ze=Oe.srcEvent.clientY,ft=0;ft<this.lastTouches.length;ft++){var Ft=this.lastTouches[ft],Yt=Math.abs(ze-Ft.x),Bn=Math.abs(Ze-Ft.y);if(Yt<=25&&Bn<=25)return!0}return!1}X(Ga,W,{handler:function(ze){var Ze=Cr[ze.type],ft=nd.call(this,ze,Ze);!ft||this.callback(this.manager,Ze,{pointers:ft[0],changedPointers:ft[1],pointerType:p,srcEvent:ze})}}),X(Pl,W,{handler:function(ze,Ze,ft){var Yt=ft.pointerType==C;if(!(Yt&&ft.sourceCapabilities&&ft.sourceCapabilities.firesTouchEvents)){if(ft.pointerType==p)id.call(this,Ze,ft);else if(Yt&&rd.call(this,ft))return;this.callback(ze,Ze,ft)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ls=fe(w.style,"touchAction"),Nl=Ls!==x,qa="compute",Ol="manipulation",qo="none",ms="pan-x",Wo="pan-y",Ko=function Bs(){if(!Nl)return!1;var Oe={},ze=H.CSS&&H.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(Ze){Oe[Ze]=!ze||H.CSS.supports("touch-action",Ze)}),Oe}();function Fl(Oe,ze){this.manager=Oe,this.set(ze)}function Ji(Oe){this.options=oe({},this.defaults,Oe||{}),this.id=function F(){return R++}(),this.manager=null,this.options.enable=Q(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function ga(Oe){return 16&Oe?"cancel":8&Oe?"end":4&Oe?"move":2&Oe?"start":""}function Oc(Oe){return 16==Oe?"down":8==Oe?"up":2==Oe?"left":4==Oe?"right":""}function Be(Oe,ze){var Ze=ze.manager;return Ze?Ze.get(Oe):Oe}function Ke(){Ji.apply(this,arguments)}function qe(){Ke.apply(this,arguments),this.pX=null,this.pY=null}function Qe(){Ke.apply(this,arguments)}function lt(){Ji.apply(this,arguments),this._timer=null,this._input=null}function et(){Ke.apply(this,arguments)}function bt(){Ke.apply(this,arguments)}function $t(){Ji.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Rt(Oe,ze){return(ze=ze||{}).recognizers=Q(ze.recognizers,Rt.defaults.preset),new Xt(Oe,ze)}function Xt(Oe,ze){this.options=oe({},Rt.defaults,ze||{}),this.options.inputTarget=this.options.inputTarget||Oe,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Oe,this.input=function pe(Oe){return new(Oe.options.inputClass||(f?Va:u?Ga:c?Pl:wo))(Oe,we)}(this),this.touchAction=new Fl(this,this.options.touchAction),Vt(this,!0),T(this.options.recognizers,function(Ze){var ft=this.add(new Ze[0](Ze[1]));Ze[2]&&ft.recognizeWith(Ze[2]),Ze[3]&&ft.requireFailure(Ze[3])},this)}function Vt(Oe,ze){var ft,Ze=Oe.element;Ze.style&&(T(Oe.options.cssProps,function(Ft,Yt){ft=fe(Ze.style,Yt),ze?(Oe.oldCssProps[ft]=Ze.style[ft],Ze.style[ft]=Ft):Ze.style[ft]=Oe.oldCssProps[ft]||""}),ze||(Oe.oldCssProps={}))}Fl.prototype={set:function(Oe){Oe==qa&&(Oe=this.compute()),Nl&&this.manager.element.style&&Ko[Oe]&&(this.manager.element.style[Ls]=Oe),this.actions=Oe.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Oe=[];return T(this.manager.recognizers,function(ze){I(ze.options.enable,[ze])&&(Oe=Oe.concat(ze.getTouchAction()))}),function Rl(Oe){if(v(Oe,qo))return qo;var ze=v(Oe,ms),Ze=v(Oe,Wo);return ze&&Ze?qo:ze||Ze?ze?ms:Wo:v(Oe,Ol)?Ol:"auto"}(Oe.join(" "))},preventDefaults:function(Oe){var ze=Oe.srcEvent,Ze=Oe.offsetDirection;if(!this.manager.session.prevented){var ft=this.actions,Ft=v(ft,qo)&&!Ko[qo],Yt=v(ft,Wo)&&!Ko[Wo],Bn=v(ft,ms)&&!Ko[ms];if(Ft&&1===Oe.pointers.length&&Oe.distance<2&&Oe.deltaTime<250)return;return Bn&&Yt||!(Ft||Yt&&6&Ze||Bn&&24&Ze)?void 0:this.preventSrc(ze)}ze.preventDefault()},preventSrc:function(Oe){this.manager.session.prevented=!0,Oe.preventDefault()}},Ji.prototype={defaults:{},set:function(Oe){return oe(this.options,Oe),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Oe){if(Y(Oe,"recognizeWith",this))return this;var ze=this.simultaneous;return ze[(Oe=Be(Oe,this)).id]||(ze[Oe.id]=Oe,Oe.recognizeWith(this)),this},dropRecognizeWith:function(Oe){return Y(Oe,"dropRecognizeWith",this)||(Oe=Be(Oe,this),delete this.simultaneous[Oe.id]),this},requireFailure:function(Oe){if(Y(Oe,"requireFailure",this))return this;var ze=this.requireFail;return-1===B(ze,Oe=Be(Oe,this))&&(ze.push(Oe),Oe.requireFailure(this)),this},dropRequireFailure:function(Oe){if(Y(Oe,"dropRequireFailure",this))return this;Oe=Be(Oe,this);var ze=B(this.requireFail,Oe);return ze>-1&&this.requireFail.splice(ze,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Oe){return!!this.simultaneous[Oe.id]},emit:function(Oe){var ze=this,Ze=this.state;function ft(Ft){ze.manager.emit(Ft,Oe)}Ze<8&&ft(ze.options.event+ga(Ze)),ft(ze.options.event),Oe.additionalEvent&&ft(Oe.additionalEvent),Ze>=8&&ft(ze.options.event+ga(Ze))},tryEmit:function(Oe){if(this.canEmit())return this.emit(Oe);this.state=32},canEmit:function(){for(var Oe=0;Oe<this.requireFail.length;){if(!(33&this.requireFail[Oe].state))return!1;Oe++}return!0},recognize:function(Oe){var ze=oe({},Oe);if(!I(this.options.enable,[this,ze]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(ze),30&this.state&&this.tryEmit(ze)},process:function(Oe){},getTouchAction:function(){},reset:function(){}},X(Ke,Ji,{defaults:{pointers:1},attrTest:function(Oe){var ze=this.options.pointers;return 0===ze||Oe.pointers.length===ze},process:function(Oe){var ze=this.state,Ze=Oe.eventType,ft=6&ze,Ft=this.attrTest(Oe);return ft&&(8&Ze||!Ft)?16|ze:ft||Ft?4&Ze?8|ze:2&ze?4|ze:2:32}}),X(qe,Ke,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Oe=this.options.direction,ze=[];return 6&Oe&&ze.push(Wo),24&Oe&&ze.push(ms),ze},directionTest:function(Oe){var ze=this.options,Ze=!0,ft=Oe.distance,Ft=Oe.direction,Yt=Oe.deltaX,Bn=Oe.deltaY;return Ft&ze.direction||(6&ze.direction?(Ft=0===Yt?1:Yt<0?2:4,Ze=Yt!=this.pX,ft=Math.abs(Oe.deltaX)):(Ft=0===Bn?1:Bn<0?8:16,Ze=Bn!=this.pY,ft=Math.abs(Oe.deltaY))),Oe.direction=Ft,Ze&&ft>ze.threshold&&Ft&ze.direction},attrTest:function(Oe){return Ke.prototype.attrTest.call(this,Oe)&&(2&this.state||!(2&this.state)&&this.directionTest(Oe))},emit:function(Oe){this.pX=Oe.deltaX,this.pY=Oe.deltaY;var ze=Oc(Oe.direction);ze&&(Oe.additionalEvent=this.options.event+ze),this._super.emit.call(this,Oe)}}),X(Qe,Ke,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[qo]},attrTest:function(Oe){return this._super.attrTest.call(this,Oe)&&(Math.abs(Oe.scale-1)>this.options.threshold||2&this.state)},emit:function(Oe){1!==Oe.scale&&(Oe.additionalEvent=this.options.event+(Oe.scale<1?"in":"out")),this._super.emit.call(this,Oe)}}),X(lt,Ji,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Oe){var ze=this.options,Ze=Oe.pointers.length===ze.pointers,ft=Oe.distance<ze.threshold,Ft=Oe.deltaTime>ze.time;if(this._input=Oe,!ft||!Ze||12&Oe.eventType&&!Ft)this.reset();else if(1&Oe.eventType)this.reset(),this._timer=N(function(){this.state=8,this.tryEmit()},ze.time,this);else if(4&Oe.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Oe){8===this.state&&(Oe&&4&Oe.eventType?this.manager.emit(this.options.event+"up",Oe):(this._input.timeStamp=U(),this.manager.emit(this.options.event,this._input)))}}),X(et,Ke,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[qo]},attrTest:function(Oe){return this._super.attrTest.call(this,Oe)&&(Math.abs(Oe.rotation)>this.options.threshold||2&this.state)}}),X(bt,Ke,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return qe.prototype.getTouchAction.call(this)},attrTest:function(Oe){var Ze,ze=this.options.direction;return 30&ze?Ze=Oe.overallVelocity:6&ze?Ze=Oe.overallVelocityX:24&ze&&(Ze=Oe.overallVelocityY),this._super.attrTest.call(this,Oe)&&ze&Oe.offsetDirection&&Oe.distance>this.options.threshold&&Oe.maxPointers==this.options.pointers&&A(Ze)>this.options.velocity&&4&Oe.eventType},emit:function(Oe){var ze=Oc(Oe.offsetDirection);ze&&this.manager.emit(this.options.event+ze,Oe),this.manager.emit(this.options.event,Oe)}}),X($t,Ji,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ol]},process:function(Oe){var ze=this.options,Ze=Oe.pointers.length===ze.pointers,ft=Oe.distance<ze.threshold,Ft=Oe.deltaTime<ze.time;if(this.reset(),1&Oe.eventType&&0===this.count)return this.failTimeout();if(ft&&Ft&&Ze){if(4!=Oe.eventType)return this.failTimeout();var Yt=!this.pTime||Oe.timeStamp-this.pTime<ze.interval,Bn=!this.pCenter||tn(this.pCenter,Oe.center)<ze.posThreshold;if(this.pTime=Oe.timeStamp,this.pCenter=Oe.center,Bn&&Yt?this.count+=1:this.count=1,this._input=Oe,0==this.count%ze.taps)return this.hasRequireFailures()?(this._timer=N(function(){this.state=8,this.tryEmit()},ze.interval,this),2):8}return 32},failTimeout:function(){return this._timer=N(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Rt.VERSION="2.0.7",Rt.defaults={domEvents:!1,touchAction:qa,enable:!0,inputTarget:null,inputClass:null,preset:[[et,{enable:!1}],[Qe,{enable:!1},["rotate"]],[bt,{direction:6}],[qe,{direction:6},["swipe"]],[$t],[$t,{event:"doubletap",taps:2},["tap"]],[lt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Xt.prototype={set:function(Oe){return oe(this.options,Oe),Oe.touchAction&&this.touchAction.update(),Oe.inputTarget&&(this.input.destroy(),this.input.target=Oe.inputTarget,this.input.init()),this},stop:function(Oe){this.session.stopped=Oe?2:1},recognize:function(Oe){var ze=this.session;if(!ze.stopped){this.touchAction.preventDefaults(Oe);var Ze,ft=this.recognizers,Ft=ze.curRecognizer;(!Ft||Ft&&8&Ft.state)&&(Ft=ze.curRecognizer=null);for(var Yt=0;Yt<ft.length;)Ze=ft[Yt],2===ze.stopped||Ft&&Ze!=Ft&&!Ze.canRecognizeWith(Ft)?Ze.reset():Ze.recognize(Oe),!Ft&&14&Ze.state&&(Ft=ze.curRecognizer=Ze),Yt++}},get:function(Oe){if(Oe instanceof Ji)return Oe;for(var ze=this.recognizers,Ze=0;Ze<ze.length;Ze++)if(ze[Ze].options.event==Oe)return ze[Ze];return null},add:function(Oe){if(Y(Oe,"add",this))return this;var ze=this.get(Oe.options.event);return ze&&this.remove(ze),this.recognizers.push(Oe),Oe.manager=this,this.touchAction.update(),Oe},remove:function(Oe){if(Y(Oe,"remove",this))return this;if(Oe=this.get(Oe)){var ze=this.recognizers,Ze=B(ze,Oe);-1!==Ze&&(ze.splice(Ze,1),this.touchAction.update())}return this},on:function(Oe,ze){if(Oe!==x&&ze!==x){var Ze=this.handlers;return T(P(Oe),function(ft){Ze[ft]=Ze[ft]||[],Ze[ft].push(ze)}),this}},off:function(Oe,ze){if(Oe!==x){var Ze=this.handlers;return T(P(Oe),function(ft){ze?Ze[ft]&&Ze[ft].splice(B(Ze[ft],ze),1):delete Ze[ft]}),this}},emit:function(Oe,ze){this.options.domEvents&&function nn(Oe,ze){var Ze=J.createEvent("Event");Ze.initEvent(Oe,!0,!0),Ze.gesture=ze,ze.target.dispatchEvent(Ze)}(Oe,ze);var Ze=this.handlers[Oe]&&this.handlers[Oe].slice();if(Ze&&Ze.length){ze.type=Oe,ze.preventDefault=function(){ze.srcEvent.preventDefault()};for(var ft=0;ft<Ze.length;)Ze[ft](ze),ft++}},destroy:function(){this.element&&Vt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},oe(Rt,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Xt,Input:W,TouchAction:Fl,TouchInput:Ga,MouseInput:wo,PointerEventInput:Va,TouchMouseInput:Pl,SingleTouchInput:Dl,Recognizer:Ji,AttrRecognizer:Ke,Tap:$t,Pan:qe,Swipe:bt,Pinch:Qe,Rotate:et,Press:lt,on:L,off:S,each:T,merge:q,extend:z,assign:oe,inherit:X,bindFn:M,prefixed:fe}),(typeof H<"u"?H:typeof self<"u"?self:{}).Hammer=Rt,(d=function(){return Rt}.call(le,me,le,E))!==x&&(E.exports=d)}(window,document)},8461:(E,le)=>{le.read=function(me,d,H,J,_){var x,O,w=8*_-J-1,K=(1<<w)-1,G=K>>1,A=-7,U=H?_-1:0,N=H?-1:1,Y=me[d+U];for(U+=N,x=Y&(1<<-A)-1,Y>>=-A,A+=w;A>0;x=256*x+me[d+U],U+=N,A-=8);for(O=x&(1<<-A)-1,x>>=-A,A+=J;A>0;O=256*O+me[d+U],U+=N,A-=8);if(0===x)x=1-G;else{if(x===K)return O?NaN:1/0*(Y?-1:1);O+=Math.pow(2,J),x-=G}return(Y?-1:1)*O*Math.pow(2,x-J)},le.write=function(me,d,H,J,_,x){var O,w,K,G=8*x-_-1,A=(1<<G)-1,U=A>>1,N=23===_?Math.pow(2,-24)-Math.pow(2,-77):0,Y=J?0:x-1,T=J?1:-1,j=d<0||0===d&&1/d<0?1:0;for(d=Math.abs(d),isNaN(d)||d===1/0?(w=isNaN(d)?1:0,O=A):(O=Math.floor(Math.log(d)/Math.LN2),d*(K=Math.pow(2,-O))<1&&(O--,K*=2),(d+=O+U>=1?N/K:N*Math.pow(2,1-U))*K>=2&&(O++,K/=2),O+U>=A?(w=0,O=A):O+U>=1?(w=(d*K-1)*Math.pow(2,_),O+=U):(w=d*Math.pow(2,U-1)*Math.pow(2,_),O=0));_>=8;me[H+Y]=255&w,Y+=T,w/=256,_-=8);for(O=O<<_|w,G+=_;G>0;me[H+Y]=255&O,Y+=T,O/=256,G-=8);me[H+Y-T]|=128*j}},6256:function(E,le){!function(_){var Y,x="undefined",O=x!==typeof Buffer&&Buffer,w=x!==typeof Uint8Array&&Uint8Array,K=x!==typeof ArrayBuffer&&ArrayBuffer,G=[0,0,0,0,0,0,0,0],A=Array.isArray||function k(v){return!!v&&"[object Array]"==Object.prototype.toString.call(v)},U=4294967296;function T(v,P,B){var te=P?0:4,D=P?4:0,fe=P?0:3,R=P?1:2,F=P?2:1,g=P?3:0,l=P?I:L,c=P?Q:S,f=m.prototype,u="is"+v,p="_"+u;return f.buffer=void 0,f.offset=0,f[p]=!0,f.toNumber=se,f.toString=function Ee(ke){var ve=this.buffer,ye=this.offset,he=ce(ve,ye+te),Ie=ce(ve,ye+D),be="",ae=!B&&2147483648&he;for(ae&&(he=~he,Ie=U-Ie),ke=ke||10;;){var ue=he%ke*U+Ie;if(he=Math.floor(he/ke),Ie=Math.floor(ue/ke),be=(ue%ke).toString(ke)+be,!he&&!Ie)break}return ae&&(be="-"+be),be},f.toJSON=se,f.toArray=j,O&&(f.toBuffer=oe),w&&(f.toArrayBuffer=z),m[u]=function C(ke){return!(!ke||!ke[p])},_[v]=m,m;function m(ke,ve,ye,he){return this instanceof m?function $(ke,ve,ye,he,Ie){w&&K&&(ve instanceof K&&(ve=new w(ve)),he instanceof K&&(he=new w(he))),ve||ye||he||Y?(q(ve,ye)||(Ie=ye,he=ve,ye=0,ve=new(Y||Array)(8)),ke.buffer=ve,ke.offset=ye|=0,x!==typeof he&&("string"==typeof he?function re(ke,ve,ye,he){var Ie=0,be=ye.length,ae=0,ue=0;"-"===ye[0]&&Ie++;for(var xe=Ie;Ie<be;){var y=parseInt(ye[Ie++],he);if(!(y>=0))break;ue=ue*he+y,ae=ae*he+Math.floor(ue/U),ue%=U}xe&&(ae=~ae,ue?ue=U-ue:ae++),Me(ke,ve+te,ae),Me(ke,ve+D,ue)}(ve,ye,he,Ie||10):q(he,Ie)?X(ve,ye,he,Ie):"number"==typeof Ie?(Me(ve,ye+te,he),Me(ve,ye+D,Ie)):he>0?l(ve,ye,he):he<0?c(ve,ye,he):X(ve,ye,G,0))):ke.buffer=M(G,0)}(this,ke,ve,ye,he):new m(ke,ve,ye,he)}function se(){var ke=this.buffer,ve=this.offset,ye=ce(ke,ve+te),he=ce(ke,ve+D);return B||(ye|=0),ye?ye*U+he:he}function Me(ke,ve,ye){ke[ve+g]=255&ye,ke[ve+F]=255&(ye>>=8),ke[ve+R]=255&(ye>>=8),ke[ve+fe]=255&(ye>>=8)}function ce(ke,ve){return 16777216*ke[ve+fe]+(ke[ve+R]<<16)+(ke[ve+F]<<8)+ke[ve+g]}}function j(v){var P=this.buffer,B=this.offset;return Y=null,!1!==v&&0===B&&8===P.length&&A(P)?P:M(P,B)}function oe(v){var P=this.buffer,B=this.offset;if(Y=O,!1!==v&&0===B&&8===P.length&&Buffer.isBuffer(P))return P;var te=new O(8);return X(te,0,P,B),te}function z(v){var P=this.buffer,B=this.offset,te=P.buffer;if(Y=w,!1!==v&&0===B&&te instanceof K&&8===te.byteLength)return te;var D=new w(8);return X(D,0,P,B),D.buffer}function q(v,P){var B=v&&v.length;return P|=0,B&&P+8<=B&&"string"!=typeof v[P]}function X(v,P,B,te){P|=0,te|=0;for(var D=0;D<8;D++)v[P++]=255&B[te++]}function M(v,P){return Array.prototype.slice.call(v,P,P+8)}function I(v,P,B){for(var te=P+8;te>P;)v[--te]=255&B,B/=256}function Q(v,P,B){var te=P+8;for(B++;te>P;)v[--te]=255&-B^255,B/=256}function L(v,P,B){for(var te=P+8;P<te;)v[P++]=255&B,B/=256}function S(v,P,B){var te=P+8;for(B++;P<te;)v[P++]=255&-B^255,B/=256}T("Uint64BE",!0,!0),T("Int64BE",!0,!1),T("Uint64LE",!1,!0),T("Int64LE",!1,!1)}("string"!=typeof le.nodeName?le:this||{})},6425:E=>{var le={}.toString;E.exports=Array.isArray||function(me){return"[object Array]"==le.call(me)}},5650:E=>{E.exports=function le(me,d,H){function J(O,w){if(!d[O]){if(!me[O]){if(_)return _(O,!0);var G=new Error("Cannot find module '"+O+"'");throw G.code="MODULE_NOT_FOUND",G}var A=d[O]={exports:{}};me[O][0].call(A.exports,function(U){return J(me[O][1][U]||U)},A,A.exports,le,me,d,H)}return d[O].exports}for(var _=void 0,x=0;x<H.length;x++)J(H[x]);return J}({1:[function(le,me,d){"use strict";var H=le("./utils"),J=le("./support"),_="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(x){for(var O,w,K,A,U,N,Y=[],T=0,j=x.length,oe=j,z="string"!==H.getTypeOf(x);T<x.length;)oe=j-T,K=z?(O=x[T++],w=T<j?x[T++]:0,T<j?x[T++]:0):(O=x.charCodeAt(T++),w=T<j?x.charCodeAt(T++):0,T<j?x.charCodeAt(T++):0),A=(3&O)<<4|w>>4,U=1<oe?(15&w)<<2|K>>6:64,N=2<oe?63&K:64,Y.push(_.charAt(O>>2)+_.charAt(A)+_.charAt(U)+_.charAt(N));return Y.join("")},d.decode=function(x){var O,w,K,G,A,U,N=0,Y=0,T="data:";if(x.substr(0,T.length)===T)throw new Error("Invalid base64 input, it looks like a data url.");var j,oe=3*(x=x.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(x.charAt(x.length-1)===_.charAt(64)&&oe--,x.charAt(x.length-2)===_.charAt(64)&&oe--,oe%1!=0)throw new Error("Invalid base64 input, bad content length.");for(j=J.uint8array?new Uint8Array(0|oe):new Array(0|oe);N<x.length;)O=_.indexOf(x.charAt(N++))<<2|(G=_.indexOf(x.charAt(N++)))>>4,w=(15&G)<<4|(A=_.indexOf(x.charAt(N++)))>>2,K=(3&A)<<6|(U=_.indexOf(x.charAt(N++))),j[Y++]=O,64!==A&&(j[Y++]=w),64!==U&&(j[Y++]=K);return j}},{"./support":30,"./utils":32}],2:[function(le,me,d){"use strict";var H=le("./external"),J=le("./stream/DataWorker"),_=le("./stream/Crc32Probe"),x=le("./stream/DataLengthProbe");function O(w,K,G,A,U){this.compressedSize=w,this.uncompressedSize=K,this.crc32=G,this.compression=A,this.compressedContent=U}O.prototype={getContentWorker:function(){var w=new J(H.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new x("data_length")),K=this;return w.on("end",function(){if(this.streamInfo.data_length!==K.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),w},getCompressedWorker:function(){return new J(H.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},O.createWorkerFrom=function(w,K,G){return w.pipe(new _).pipe(new x("uncompressedSize")).pipe(K.compressWorker(G)).pipe(new x("compressedSize")).withStreamInfo("compression",K)},me.exports=O},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(le,me,d){"use strict";var H=le("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new H("STORE compression")},uncompressWorker:function(){return new H("STORE decompression")}},d.DEFLATE=le("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(le,me,d){"use strict";var H=le("./utils"),J=function(){for(var _,x=[],O=0;O<256;O++){_=O;for(var w=0;w<8;w++)_=1&_?3988292384^_>>>1:_>>>1;x[O]=_}return x}();me.exports=function(_,x){return void 0!==_&&_.length?"string"!==H.getTypeOf(_)?function(O,w,K,G){var A=J,U=0+K;O^=-1;for(var N=0;N<U;N++)O=O>>>8^A[255&(O^w[N])];return-1^O}(0|x,_,_.length):function(O,w,K,G){var A=J,U=0+K;O^=-1;for(var N=0;N<U;N++)O=O>>>8^A[255&(O^w.charCodeAt(N))];return-1^O}(0|x,_,_.length):0}},{"./utils":32}],5:[function(le,me,d){"use strict";d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(le,me,d){"use strict";var H;H=typeof Promise<"u"?Promise:le("lie"),me.exports={Promise:H}},{lie:37}],7:[function(le,me,d){"use strict";var H=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",J=le("pako"),_=le("./utils"),x=le("./stream/GenericWorker"),O=H?"uint8array":"array";function w(K,G){x.call(this,"FlateWorker/"+K),this._pako=null,this._pakoAction=K,this._pakoOptions=G,this.meta={}}d.magic="\b\0",_.inherits(w,x),w.prototype.processChunk=function(K){this.meta=K.meta,null===this._pako&&this._createPako(),this._pako.push(_.transformTo(O,K.data),!1)},w.prototype.flush=function(){x.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},w.prototype.cleanUp=function(){x.prototype.cleanUp.call(this),this._pako=null},w.prototype._createPako=function(){this._pako=new J[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var K=this;this._pako.onData=function(G){K.push({data:G,meta:K.meta})}},d.compressWorker=function(K){return new w("Deflate",K)},d.uncompressWorker=function(){return new w("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(le,me,d){"use strict";function H(A,U){var N,Y="";for(N=0;N<U;N++)Y+=String.fromCharCode(255&A),A>>>=8;return Y}function J(A,U,N,Y,T,j){var oe,z,q=A.file,X=A.compression,M=j!==O.utf8encode,I=_.transformTo("string",j(q.name)),Q=_.transformTo("string",O.utf8encode(q.name)),L=q.comment,S=_.transformTo("string",j(L)),k=_.transformTo("string",O.utf8encode(L)),v=Q.length!==q.name.length,P=k.length!==L.length,B="",te="",D="",fe=q.dir,R=q.date,F={crc32:0,compressedSize:0,uncompressedSize:0};U&&!N||(F.crc32=A.crc32,F.compressedSize=A.compressedSize,F.uncompressedSize=A.uncompressedSize);var g=0;U&&(g|=8),M||!v&&!P||(g|=2048);var u,m,l=0,c=0;fe&&(l|=16),"UNIX"===T?(c=798,l|=(m=u=q.unixPermissions,u||(m=fe?16893:33204),(65535&m)<<16)):(c=20,l|=function(u){return 63&(u||0)}(q.dosPermissions)),oe=R.getUTCHours(),oe<<=6,oe|=R.getUTCMinutes(),oe<<=5,oe|=R.getUTCSeconds()/2,z=R.getUTCFullYear()-1980,z<<=4,z|=R.getUTCMonth()+1,z<<=5,z|=R.getUTCDate(),v&&(te=H(1,1)+H(w(I),4)+Q,B+="up"+H(te.length,2)+te),P&&(D=H(1,1)+H(w(S),4)+k,B+="uc"+H(D.length,2)+D);var f="";return f+="\n\0",f+=H(g,2),f+=X.magic,f+=H(oe,2),f+=H(z,2),f+=H(F.crc32,4),f+=H(F.compressedSize,4),f+=H(F.uncompressedSize,4),f+=H(I.length,2),f+=H(B.length,2),{fileRecord:K.LOCAL_FILE_HEADER+f+I+B,dirRecord:K.CENTRAL_FILE_HEADER+H(c,2)+f+H(S.length,2)+"\0\0\0\0"+H(l,4)+H(Y,4)+I+B+S}}var _=le("../utils"),x=le("../stream/GenericWorker"),O=le("../utf8"),w=le("../crc32"),K=le("../signature");function G(A,U,N,Y){x.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=U,this.zipPlatform=N,this.encodeFileName=Y,this.streamFiles=A,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}_.inherits(G,x),G.prototype.push=function(A){var U=A.meta.percent||0,N=this.entriesCount,Y=this._sources.length;this.accumulate?this.contentBuffer.push(A):(this.bytesWritten+=A.data.length,x.prototype.push.call(this,{data:A.data,meta:{currentFile:this.currentFile,percent:N?(U+100*(N-Y-1))/N:100}}))},G.prototype.openedSource=function(A){this.currentSourceOffset=this.bytesWritten,this.currentFile=A.file.name;var U=this.streamFiles&&!A.file.dir;if(U){var N=J(A,U,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:N.fileRecord,meta:{percent:0}})}else this.accumulate=!0},G.prototype.closedSource=function(A){this.accumulate=!1;var Y,U=this.streamFiles&&!A.file.dir,N=J(A,U,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(N.dirRecord),U)this.push({data:(Y=A,K.DATA_DESCRIPTOR+H(Y.crc32,4)+H(Y.compressedSize,4)+H(Y.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:N.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},G.prototype.flush=function(){for(var A=this.bytesWritten,U=0;U<this.dirRecords.length;U++)this.push({data:this.dirRecords[U],meta:{percent:100}});var T,j,oe,X,Y=(T=this.dirRecords.length,j=this.bytesWritten-A,oe=A,X=_.transformTo("string",(0,this.encodeFileName)(this.zipComment)),K.CENTRAL_DIRECTORY_END+"\0\0\0\0"+H(T,2)+H(T,2)+H(j,4)+H(oe,4)+H(X.length,2)+X);this.push({data:Y,meta:{percent:100}})},G.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},G.prototype.registerPrevious=function(A){this._sources.push(A);var U=this;return A.on("data",function(N){U.processChunk(N)}),A.on("end",function(){U.closedSource(U.previous.streamInfo),U._sources.length?U.prepareNextSource():U.end()}),A.on("error",function(N){U.error(N)}),this},G.prototype.resume=function(){return!!x.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},G.prototype.error=function(A){var U=this._sources;if(!x.prototype.error.call(this,A))return!1;for(var N=0;N<U.length;N++)try{U[N].error(A)}catch{}return!0},G.prototype.lock=function(){x.prototype.lock.call(this);for(var A=this._sources,U=0;U<A.length;U++)A[U].lock()},me.exports=G},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(le,me,d){"use strict";var H=le("../compressions"),J=le("./ZipFileWorker");d.generateWorker=function(_,x,O){var w=new J(x.streamFiles,O,x.platform,x.encodeFileName),K=0;try{_.forEach(function(G,A){K++;var U=function(j,oe){var z=j||oe,q=H[z];if(!q)throw new Error(z+" is not a valid compression method !");return q}(A.options.compression,x.compression),Y=A.dir,T=A.date;A._compressWorker(U,A.options.compressionOptions||x.compressionOptions||{}).withStreamInfo("file",{name:G,dir:Y,date:T,comment:A.comment||"",unixPermissions:A.unixPermissions,dosPermissions:A.dosPermissions}).pipe(w)}),w.entriesCount=K}catch(G){w.error(G)}return w}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(le,me,d){"use strict";function H(){if(!(this instanceof H))return new H;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var J=new H;for(var _ in this)"function"!=typeof this[_]&&(J[_]=this[_]);return J}}(H.prototype=le("./object")).loadAsync=le("./load"),H.support=le("./support"),H.defaults=le("./defaults"),H.version="3.10.1",H.loadAsync=function(J,_){return(new H).loadAsync(J,_)},H.external=le("./external"),me.exports=H},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(le,me,d){"use strict";var H=le("./utils"),J=le("./external"),_=le("./utf8"),x=le("./zipEntries"),O=le("./stream/Crc32Probe"),w=le("./nodejsUtils");function K(G){return new J.Promise(function(A,U){var N=G.decompressed.getContentWorker().pipe(new O);N.on("error",function(Y){U(Y)}).on("end",function(){N.streamInfo.crc32!==G.decompressed.crc32?U(new Error("Corrupted zip : CRC32 mismatch")):A()}).resume()})}me.exports=function(G,A){var U=this;return A=H.extend(A||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:_.utf8decode}),w.isNode&&w.isStream(G)?J.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):H.prepareContent("the loaded zip file",G,!0,A.optimizedBinaryString,A.base64).then(function(N){var Y=new x(A);return Y.load(N),Y}).then(function(N){var Y=[J.Promise.resolve(N)],T=N.files;if(A.checkCRC32)for(var j=0;j<T.length;j++)Y.push(K(T[j]));return J.Promise.all(Y)}).then(function(N){for(var Y=N.shift(),T=Y.files,j=0;j<T.length;j++){var oe=T[j],z=oe.fileNameStr,q=H.resolve(oe.fileNameStr);U.file(q,oe.decompressed,{binary:!0,optimizedBinaryString:!0,date:oe.date,dir:oe.dir,comment:oe.fileCommentStr.length?oe.fileCommentStr:null,unixPermissions:oe.unixPermissions,dosPermissions:oe.dosPermissions,createFolders:A.createFolders}),oe.dir||(U.file(q).unsafeOriginalName=z)}return Y.zipComment.length&&(U.comment=Y.zipComment),U})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(le,me,d){"use strict";var H=le("../utils"),J=le("../stream/GenericWorker");function _(x,O){J.call(this,"Nodejs stream input adapter for "+x),this._upstreamEnded=!1,this._bindStream(O)}H.inherits(_,J),_.prototype._bindStream=function(x){var O=this;(this._stream=x).pause(),x.on("data",function(w){O.push({data:w,meta:{percent:0}})}).on("error",function(w){O.isPaused?this.generatedError=w:O.error(w)}).on("end",function(){O.isPaused?O._upstreamEnded=!0:O.end()})},_.prototype.pause=function(){return!!J.prototype.pause.call(this)&&(this._stream.pause(),!0)},_.prototype.resume=function(){return!!J.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},me.exports=_},{"../stream/GenericWorker":28,"../utils":32}],13:[function(le,me,d){"use strict";var H=le("readable-stream").Readable;function J(_,x,O){H.call(this,x),this._helper=_;var w=this;_.on("data",function(K,G){w.push(K)||w._helper.pause(),O&&O(G)}).on("error",function(K){w.emit("error",K)}).on("end",function(){w.push(null)})}le("../utils").inherits(J,H),J.prototype._read=function(){this._helper.resume()},me.exports=J},{"../utils":32,"readable-stream":16}],14:[function(le,me,d){"use strict";me.exports={isNode:typeof Buffer<"u",newBufferFrom:function(H,J){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(H,J);if("number"==typeof H)throw new Error('The "data" argument must not be a number');return new Buffer(H,J)},allocBuffer:function(H){if(Buffer.alloc)return Buffer.alloc(H);var J=new Buffer(H);return J.fill(0),J},isBuffer:function(H){return Buffer.isBuffer(H)},isStream:function(H){return H&&"function"==typeof H.on&&"function"==typeof H.pause&&"function"==typeof H.resume}}},{}],15:[function(le,me,d){"use strict";function H(q,X,M){var I,Q=_.getTypeOf(X),L=_.extend(M||{},w);L.date=L.date||new Date,null!==L.compression&&(L.compression=L.compression.toUpperCase()),"string"==typeof L.unixPermissions&&(L.unixPermissions=parseInt(L.unixPermissions,8)),L.unixPermissions&&16384&L.unixPermissions&&(L.dir=!0),L.dosPermissions&&16&L.dosPermissions&&(L.dir=!0),L.dir&&(q=T(q)),L.createFolders&&(I=Y(q))&&j.call(this,I,!0),M&&void 0!==M.binary||(L.binary=!("string"===Q&&!1===L.binary&&!1===L.base64)),(X instanceof K&&0===X.uncompressedSize||L.dir||!X||0===X.length)&&(L.base64=!1,L.binary=!0,X="",L.compression="STORE",Q="string");var k;k=X instanceof K||X instanceof x?X:U.isNode&&U.isStream(X)?new N(q,X):_.prepareContent(q,X,L.binary,L.optimizedBinaryString,L.base64);var v=new G(q,k,L);this.files[q]=v}var J=le("./utf8"),_=le("./utils"),x=le("./stream/GenericWorker"),O=le("./stream/StreamHelper"),w=le("./defaults"),K=le("./compressedObject"),G=le("./zipObject"),A=le("./generate"),U=le("./nodejsUtils"),N=le("./nodejs/NodejsStreamInputAdapter"),Y=function(q){"/"===q.slice(-1)&&(q=q.substring(0,q.length-1));var X=q.lastIndexOf("/");return 0<X?q.substring(0,X):""},T=function(q){return"/"!==q.slice(-1)&&(q+="/"),q},j=function(q,X){return X=void 0!==X?X:w.createFolders,q=T(q),this.files[q]||H.call(this,q,null,{dir:!0,createFolders:X}),this.files[q]};function oe(q){return"[object RegExp]"===Object.prototype.toString.call(q)}var z={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(q){var X,M,I;for(X in this.files)I=this.files[X],(M=X.slice(this.root.length,X.length))&&X.slice(0,this.root.length)===this.root&&q(M,I)},filter:function(q){var X=[];return this.forEach(function(M,I){q(M,I)&&X.push(I)}),X},file:function(q,X,M){if(1!==arguments.length)return H.call(this,q=this.root+q,X,M),this;if(oe(q)){var I=q;return this.filter(function(L,S){return!S.dir&&I.test(L)})}var Q=this.files[this.root+q];return Q&&!Q.dir?Q:null},folder:function(q){if(!q)return this;if(oe(q))return this.filter(function(Q,L){return L.dir&&q.test(Q)});var M=j.call(this,this.root+q),I=this.clone();return I.root=M.name,I},remove:function(q){var X=this.files[q=this.root+q];if(X||("/"!==q.slice(-1)&&(q+="/"),X=this.files[q]),X&&!X.dir)delete this.files[q];else for(var M=this.filter(function(Q,L){return L.name.slice(0,q.length)===q}),I=0;I<M.length;I++)delete this.files[M[I].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(q){var X,M={};try{if((M=_.extend(q||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:J.utf8encode})).type=M.type.toLowerCase(),M.compression=M.compression.toUpperCase(),"binarystring"===M.type&&(M.type="string"),!M.type)throw new Error("No output type specified.");_.checkSupport(M.type),"darwin"!==M.platform&&"freebsd"!==M.platform&&"linux"!==M.platform&&"sunos"!==M.platform||(M.platform="UNIX"),"win32"===M.platform&&(M.platform="DOS"),X=A.generateWorker(this,M,M.comment||this.comment||"")}catch(Q){(X=new x("error")).error(Q)}return new O(X,M.type||"string",M.mimeType)},generateAsync:function(q,X){return this.generateInternalStream(q).accumulate(X)},generateNodeStream:function(q,X){return(q=q||{}).type||(q.type="nodebuffer"),this.generateInternalStream(q).toNodejsStream(X)}};me.exports=z},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(le,me,d){"use strict";me.exports=le("stream")},{stream:void 0}],17:[function(le,me,d){"use strict";var H=le("./DataReader");function J(_){H.call(this,_);for(var x=0;x<this.data.length;x++)_[x]=255&_[x]}le("../utils").inherits(J,H),J.prototype.byteAt=function(_){return this.data[this.zero+_]},J.prototype.lastIndexOfSignature=function(_){for(var x=_.charCodeAt(0),O=_.charCodeAt(1),w=_.charCodeAt(2),K=_.charCodeAt(3),G=this.length-4;0<=G;--G)if(this.data[G]===x&&this.data[G+1]===O&&this.data[G+2]===w&&this.data[G+3]===K)return G-this.zero;return-1},J.prototype.readAndCheckSignature=function(_){var x=_.charCodeAt(0),O=_.charCodeAt(1),w=_.charCodeAt(2),K=_.charCodeAt(3),G=this.readData(4);return x===G[0]&&O===G[1]&&w===G[2]&&K===G[3]},J.prototype.readData=function(_){if(this.checkOffset(_),0===_)return[];var x=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,x},me.exports=J},{"../utils":32,"./DataReader":18}],18:[function(le,me,d){"use strict";var H=le("../utils");function J(_){this.data=_,this.length=_.length,this.index=0,this.zero=0}J.prototype={checkOffset:function(_){this.checkIndex(this.index+_)},checkIndex:function(_){if(this.length<this.zero+_||_<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+_+"). Corrupted zip ?")},setIndex:function(_){this.checkIndex(_),this.index=_},skip:function(_){this.setIndex(this.index+_)},byteAt:function(){},readInt:function(_){var x,O=0;for(this.checkOffset(_),x=this.index+_-1;x>=this.index;x--)O=(O<<8)+this.byteAt(x);return this.index+=_,O},readString:function(_){return H.transformTo("string",this.readData(_))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var _=this.readInt(4);return new Date(Date.UTC(1980+(_>>25&127),(_>>21&15)-1,_>>16&31,_>>11&31,_>>5&63,(31&_)<<1))}},me.exports=J},{"../utils":32}],19:[function(le,me,d){"use strict";var H=le("./Uint8ArrayReader");function J(_){H.call(this,_)}le("../utils").inherits(J,H),J.prototype.readData=function(_){this.checkOffset(_);var x=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,x},me.exports=J},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(le,me,d){"use strict";var H=le("./DataReader");function J(_){H.call(this,_)}le("../utils").inherits(J,H),J.prototype.byteAt=function(_){return this.data.charCodeAt(this.zero+_)},J.prototype.lastIndexOfSignature=function(_){return this.data.lastIndexOf(_)-this.zero},J.prototype.readAndCheckSignature=function(_){return _===this.readData(4)},J.prototype.readData=function(_){this.checkOffset(_);var x=this.data.slice(this.zero+this.index,this.zero+this.index+_);return this.index+=_,x},me.exports=J},{"../utils":32,"./DataReader":18}],21:[function(le,me,d){"use strict";var H=le("./ArrayReader");function J(_){H.call(this,_)}le("../utils").inherits(J,H),J.prototype.readData=function(_){if(this.checkOffset(_),0===_)return new Uint8Array(0);var x=this.data.subarray(this.zero+this.index,this.zero+this.index+_);return this.index+=_,x},me.exports=J},{"../utils":32,"./ArrayReader":17}],22:[function(le,me,d){"use strict";var H=le("../utils"),J=le("../support"),_=le("./ArrayReader"),x=le("./StringReader"),O=le("./NodeBufferReader"),w=le("./Uint8ArrayReader");me.exports=function(K){var G=H.getTypeOf(K);return H.checkSupport(G),"string"!==G||J.uint8array?"nodebuffer"===G?new O(K):J.uint8array?new w(H.transformTo("uint8array",K)):new _(H.transformTo("array",K)):new x(K)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(le,me,d){"use strict";d.LOCAL_FILE_HEADER="PK\x03\x04",d.CENTRAL_FILE_HEADER="PK\x01\x02",d.CENTRAL_DIRECTORY_END="PK\x05\x06",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(le,me,d){"use strict";var H=le("./GenericWorker"),J=le("../utils");function _(x){H.call(this,"ConvertWorker to "+x),this.destType=x}J.inherits(_,H),_.prototype.processChunk=function(x){this.push({data:J.transformTo(this.destType,x.data),meta:x.meta})},me.exports=_},{"../utils":32,"./GenericWorker":28}],25:[function(le,me,d){"use strict";var H=le("./GenericWorker"),J=le("../crc32");function _(){H.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}le("../utils").inherits(_,H),_.prototype.processChunk=function(x){this.streamInfo.crc32=J(x.data,this.streamInfo.crc32||0),this.push(x)},me.exports=_},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(le,me,d){"use strict";var H=le("../utils"),J=le("./GenericWorker");function _(x){J.call(this,"DataLengthProbe for "+x),this.propName=x,this.withStreamInfo(x,0)}H.inherits(_,J),_.prototype.processChunk=function(x){x&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+x.data.length),J.prototype.processChunk.call(this,x)},me.exports=_},{"../utils":32,"./GenericWorker":28}],27:[function(le,me,d){"use strict";var H=le("../utils"),J=le("./GenericWorker");function _(x){J.call(this,"DataWorker");var O=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,x.then(function(w){O.dataIsReady=!0,O.data=w,O.max=w&&w.length||0,O.type=H.getTypeOf(w),O.isPaused||O._tickAndRepeat()},function(w){O.error(w)})}H.inherits(_,J),_.prototype.cleanUp=function(){J.prototype.cleanUp.call(this),this.data=null},_.prototype.resume=function(){return!!J.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,H.delay(this._tickAndRepeat,[],this)),!0)},_.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(H.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},_.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var x=null,O=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":x=this.data.substring(this.index,O);break;case"uint8array":x=this.data.subarray(this.index,O);break;case"array":case"nodebuffer":x=this.data.slice(this.index,O)}return this.index=O,this.push({data:x,meta:{percent:this.max?this.index/this.max*100:0}})},me.exports=_},{"../utils":32,"./GenericWorker":28}],28:[function(le,me,d){"use strict";function H(J){this.name=J||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}H.prototype={push:function(J){this.emit("data",J)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(J){this.emit("error",J)}return!0},error:function(J){return!this.isFinished&&(this.isPaused?this.generatedError=J:(this.isFinished=!0,this.emit("error",J),this.previous&&this.previous.error(J),this.cleanUp()),!0)},on:function(J,_){return this._listeners[J].push(_),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(J,_){if(this._listeners[J])for(var x=0;x<this._listeners[J].length;x++)this._listeners[J][x].call(this,_)},pipe:function(J){return J.registerPrevious(this)},registerPrevious:function(J){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=J.streamInfo,this.mergeStreamInfo(),this.previous=J;var _=this;return J.on("data",function(x){_.processChunk(x)}),J.on("end",function(){_.end()}),J.on("error",function(x){_.error(x)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var J=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),J=!0),this.previous&&this.previous.resume(),!J},flush:function(){},processChunk:function(J){this.push(J)},withStreamInfo:function(J,_){return this.extraStreamInfo[J]=_,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var J in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,J)&&(this.streamInfo[J]=this.extraStreamInfo[J])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var J="Worker "+this.name;return this.previous?this.previous+" -> "+J:J}},me.exports=H},{}],29:[function(le,me,d){"use strict";var H=le("../utils"),J=le("./ConvertWorker"),_=le("./GenericWorker"),x=le("../base64"),O=le("../support"),w=le("../external"),K=null;if(O.nodestream)try{K=le("../nodejs/NodejsStreamOutputAdapter")}catch{}function A(U,N,Y){var T=N;switch(N){case"blob":case"arraybuffer":T="uint8array";break;case"base64":T="string"}try{this._internalType=T,this._outputType=N,this._mimeType=Y,H.checkSupport(T),this._worker=U.pipe(new J(T)),U.lock()}catch(j){this._worker=new _("error"),this._worker.error(j)}}A.prototype={accumulate:function(U){return function G(U,N){return new w.Promise(function(Y,T){var j=[],oe=U._internalType,z=U._outputType,q=U._mimeType;U.on("data",function(X,M){j.push(X),N&&N(M)}).on("error",function(X){j=[],T(X)}).on("end",function(){try{var X=function(M,I,Q){switch(M){case"blob":return H.newBlob(H.transformTo("arraybuffer",I),Q);case"base64":return x.encode(I);default:return H.transformTo(M,I)}}(z,function(M,I){var Q,L=0,S=null,k=0;for(Q=0;Q<I.length;Q++)k+=I[Q].length;switch(M){case"string":return I.join("");case"array":return Array.prototype.concat.apply([],I);case"uint8array":for(S=new Uint8Array(k),Q=0;Q<I.length;Q++)S.set(I[Q],L),L+=I[Q].length;return S;case"nodebuffer":return Buffer.concat(I);default:throw new Error("concat : unsupported type '"+M+"'")}}(oe,j),q);Y(X)}catch(M){T(M)}j=[]}).resume()})}(this,U)},on:function(U,N){var Y=this;return this._worker.on(U,"data"===U?function(T){N.call(Y,T.data,T.meta)}:function(){H.delay(N,arguments,Y)}),this},resume:function(){return H.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(U){if(H.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new K(this,{objectMode:"nodebuffer"!==this._outputType},U)}},me.exports=A},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(le,me,d){"use strict";if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",d.nodebuffer=typeof Buffer<"u",d.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")d.blob=!1;else{var H=new ArrayBuffer(0);try{d.blob=0===new Blob([H],{type:"application/zip"}).size}catch{try{var J=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);J.append(H),d.blob=0===J.getBlob("application/zip").size}catch{d.blob=!1}}}try{d.nodestream=!!le("readable-stream").Readable}catch{d.nodestream=!1}},{"readable-stream":16}],31:[function(le,me,d){"use strict";for(var H=le("./utils"),J=le("./support"),_=le("./nodejsUtils"),x=le("./stream/GenericWorker"),O=new Array(256),w=0;w<256;w++)O[w]=252<=w?6:248<=w?5:240<=w?4:224<=w?3:192<=w?2:1;function K(){x.call(this,"utf-8 decode"),this.leftOver=null}function G(){x.call(this,"utf-8 encode")}O[254]=O[254]=1,d.utf8encode=function(A){return J.nodebuffer?_.newBufferFrom(A,"utf-8"):function(U){var N,Y,T,j,oe,z=U.length,q=0;for(j=0;j<z;j++)55296==(64512&(Y=U.charCodeAt(j)))&&j+1<z&&56320==(64512&(T=U.charCodeAt(j+1)))&&(Y=65536+(Y-55296<<10)+(T-56320),j++),q+=Y<128?1:Y<2048?2:Y<65536?3:4;for(N=J.uint8array?new Uint8Array(q):new Array(q),j=oe=0;oe<q;j++)55296==(64512&(Y=U.charCodeAt(j)))&&j+1<z&&56320==(64512&(T=U.charCodeAt(j+1)))&&(Y=65536+(Y-55296<<10)+(T-56320),j++),Y<128?N[oe++]=Y:(Y<2048?N[oe++]=192|Y>>>6:(Y<65536?N[oe++]=224|Y>>>12:(N[oe++]=240|Y>>>18,N[oe++]=128|Y>>>12&63),N[oe++]=128|Y>>>6&63),N[oe++]=128|63&Y);return N}(A)},d.utf8decode=function(A){return J.nodebuffer?H.transformTo("nodebuffer",A).toString("utf-8"):function(U){var N,Y,T,j,oe=U.length,z=new Array(2*oe);for(N=Y=0;N<oe;)if((T=U[N++])<128)z[Y++]=T;else if(4<(j=O[T]))z[Y++]=65533,N+=j-1;else{for(T&=2===j?31:3===j?15:7;1<j&&N<oe;)T=T<<6|63&U[N++],j--;1<j?z[Y++]=65533:T<65536?z[Y++]=T:(z[Y++]=55296|(T-=65536)>>10&1023,z[Y++]=56320|1023&T)}return z.length!==Y&&(z.subarray?z=z.subarray(0,Y):z.length=Y),H.applyFromCharCode(z)}(A=H.transformTo(J.uint8array?"uint8array":"array",A))},H.inherits(K,x),K.prototype.processChunk=function(A){var U=H.transformTo(J.uint8array?"uint8array":"array",A.data);if(this.leftOver&&this.leftOver.length){if(J.uint8array){var N=U;(U=new Uint8Array(N.length+this.leftOver.length)).set(this.leftOver,0),U.set(N,this.leftOver.length)}else U=this.leftOver.concat(U);this.leftOver=null}var Y=function(j,oe){var z;for((oe=oe||j.length)>j.length&&(oe=j.length),z=oe-1;0<=z&&128==(192&j[z]);)z--;return z<0||0===z?oe:z+O[j[z]]>oe?z:oe}(U),T=U;Y!==U.length&&(J.uint8array?(T=U.subarray(0,Y),this.leftOver=U.subarray(Y,U.length)):(T=U.slice(0,Y),this.leftOver=U.slice(Y,U.length))),this.push({data:d.utf8decode(T),meta:A.meta})},K.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=K,H.inherits(G,x),G.prototype.processChunk=function(A){this.push({data:d.utf8encode(A.data),meta:A.meta})},d.Utf8EncodeWorker=G},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(le,me,d){"use strict";var H=le("./support"),J=le("./base64"),_=le("./nodejsUtils"),x=le("./external");function O(N){return N}function w(N,Y){for(var T=0;T<N.length;++T)Y[T]=255&N.charCodeAt(T);return Y}le("setimmediate"),d.newBlob=function(N,Y){d.checkSupport("blob");try{return new Blob([N],{type:Y})}catch{try{var T=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return T.append(N),T.getBlob(Y)}catch{throw new Error("Bug : can't construct the Blob.")}}};var K={stringifyByChunk:function(N,Y,T){var j=[],oe=0,z=N.length;if(z<=T)return String.fromCharCode.apply(null,N);for(;oe<z;)j.push(String.fromCharCode.apply(null,"array"===Y||"nodebuffer"===Y?N.slice(oe,Math.min(oe+T,z)):N.subarray(oe,Math.min(oe+T,z)))),oe+=T;return j.join("")},stringifyByChar:function(N){for(var Y="",T=0;T<N.length;T++)Y+=String.fromCharCode(N[T]);return Y},applyCanBeUsed:{uint8array:function(){try{return H.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return H.nodebuffer&&1===String.fromCharCode.apply(null,_.allocBuffer(1)).length}catch{return!1}}()}};function G(N){var Y=65536,T=d.getTypeOf(N),j=!0;if("uint8array"===T?j=K.applyCanBeUsed.uint8array:"nodebuffer"===T&&(j=K.applyCanBeUsed.nodebuffer),j)for(;1<Y;)try{return K.stringifyByChunk(N,T,Y)}catch{Y=Math.floor(Y/2)}return K.stringifyByChar(N)}function A(N,Y){for(var T=0;T<N.length;T++)Y[T]=N[T];return Y}d.applyFromCharCode=G;var U={};U.string={string:O,array:function(N){return w(N,new Array(N.length))},arraybuffer:function(N){return U.string.uint8array(N).buffer},uint8array:function(N){return w(N,new Uint8Array(N.length))},nodebuffer:function(N){return w(N,_.allocBuffer(N.length))}},U.array={string:G,array:O,arraybuffer:function(N){return new Uint8Array(N).buffer},uint8array:function(N){return new Uint8Array(N)},nodebuffer:function(N){return _.newBufferFrom(N)}},U.arraybuffer={string:function(N){return G(new Uint8Array(N))},array:function(N){return A(new Uint8Array(N),new Array(N.byteLength))},arraybuffer:O,uint8array:function(N){return new Uint8Array(N)},nodebuffer:function(N){return _.newBufferFrom(new Uint8Array(N))}},U.uint8array={string:G,array:function(N){return A(N,new Array(N.length))},arraybuffer:function(N){return N.buffer},uint8array:O,nodebuffer:function(N){return _.newBufferFrom(N)}},U.nodebuffer={string:G,array:function(N){return A(N,new Array(N.length))},arraybuffer:function(N){return U.nodebuffer.uint8array(N).buffer},uint8array:function(N){return A(N,new Uint8Array(N.length))},nodebuffer:O},d.transformTo=function(N,Y){if(Y=Y||"",!N)return Y;d.checkSupport(N);var T=d.getTypeOf(Y);return U[T][N](Y)},d.resolve=function(N){for(var Y=N.split("/"),T=[],j=0;j<Y.length;j++){var oe=Y[j];"."===oe||""===oe&&0!==j&&j!==Y.length-1||(".."===oe?T.pop():T.push(oe))}return T.join("/")},d.getTypeOf=function(N){return"string"==typeof N?"string":"[object Array]"===Object.prototype.toString.call(N)?"array":H.nodebuffer&&_.isBuffer(N)?"nodebuffer":H.uint8array&&N instanceof Uint8Array?"uint8array":H.arraybuffer&&N instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(N){if(!H[N.toLowerCase()])throw new Error(N+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(N){var Y,T,j="";for(T=0;T<(N||"").length;T++)j+="\\x"+((Y=N.charCodeAt(T))<16?"0":"")+Y.toString(16).toUpperCase();return j},d.delay=function(N,Y,T){setImmediate(function(){N.apply(T||null,Y||[])})},d.inherits=function(N,Y){function T(){}T.prototype=Y.prototype,N.prototype=new T},d.extend=function(){var N,Y,T={};for(N=0;N<arguments.length;N++)for(Y in arguments[N])Object.prototype.hasOwnProperty.call(arguments[N],Y)&&void 0===T[Y]&&(T[Y]=arguments[N][Y]);return T},d.prepareContent=function(N,Y,T,j,oe){return x.Promise.resolve(Y).then(function(z){return H.blob&&(z instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(z)))&&typeof FileReader<"u"?new x.Promise(function(q,X){var M=new FileReader;M.onload=function(I){q(I.target.result)},M.onerror=function(I){X(I.target.error)},M.readAsArrayBuffer(z)}):z}).then(function(z){var X,q=d.getTypeOf(z);return q?("arraybuffer"===q?z=d.transformTo("uint8array",z):"string"===q&&(oe?z=J.decode(z):T&&!0!==j&&(z=w(X=z,H.uint8array?new Uint8Array(X.length):new Array(X.length)))),z):x.Promise.reject(new Error("Can't read the data of '"+N+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(le,me,d){"use strict";var H=le("./reader/readerFor"),J=le("./utils"),_=le("./signature"),x=le("./zipEntry"),O=le("./support");function w(K){this.files=[],this.loadOptions=K}w.prototype={checkSignature:function(K){if(!this.reader.readAndCheckSignature(K)){this.reader.index-=4;var G=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+J.pretty(G)+", expected "+J.pretty(K)+")")}},isSignature:function(K,G){var A=this.reader.index;this.reader.setIndex(K);var U=this.reader.readString(4)===G;return this.reader.setIndex(A),U},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var K=this.reader.readData(this.zipCommentLength),A=J.transformTo(O.uint8array?"uint8array":"array",K);this.zipComment=this.loadOptions.decodeFileName(A)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var K,G,A,U=this.zip64EndOfCentralSize-44;0<U;)K=this.reader.readInt(2),G=this.reader.readInt(4),A=this.reader.readData(G),this.zip64ExtensibleData[K]={id:K,length:G,value:A}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var K,G;for(K=0;K<this.files.length;K++)this.reader.setIndex((G=this.files[K]).localHeaderOffset),this.checkSignature(_.LOCAL_FILE_HEADER),G.readLocalPart(this.reader),G.handleUTF8(),G.processAttributes()},readCentralDir:function(){var K;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(_.CENTRAL_FILE_HEADER);)(K=new x({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(K);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var K=this.reader.lastIndexOfSignature(_.CENTRAL_DIRECTORY_END);if(K<0)throw this.isSignature(0,_.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(K);var G=K;if(this.checkSignature(_.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===J.MAX_VALUE_16BITS||this.diskWithCentralDirStart===J.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===J.MAX_VALUE_16BITS||this.centralDirRecords===J.MAX_VALUE_16BITS||this.centralDirSize===J.MAX_VALUE_32BITS||this.centralDirOffset===J.MAX_VALUE_32BITS){if(this.zip64=!0,(K=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(K),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,_.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(_.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var A=this.centralDirOffset+this.centralDirSize;this.zip64&&(A+=20,A+=12+this.zip64EndOfCentralSize);var U=G-A;if(0<U)this.isSignature(G,_.CENTRAL_FILE_HEADER)||(this.reader.zero=U);else if(U<0)throw new Error("Corrupted zip: missing "+Math.abs(U)+" bytes.")},prepareReader:function(K){this.reader=H(K)},load:function(K){this.prepareReader(K),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},me.exports=w},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(le,me,d){"use strict";var H=le("./reader/readerFor"),J=le("./utils"),_=le("./compressedObject"),x=le("./crc32"),O=le("./utf8"),w=le("./compressions"),K=le("./support");function G(A,U){this.options=A,this.loadOptions=U}G.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(A){var U,N;if(A.skip(22),this.fileNameLength=A.readInt(2),N=A.readInt(2),this.fileName=A.readData(this.fileNameLength),A.skip(N),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(U=function(Y){for(var T in w)if(Object.prototype.hasOwnProperty.call(w,T)&&w[T].magic===Y)return w[T];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+J.pretty(this.compressionMethod)+" unknown (inner file : "+J.transformTo("string",this.fileName)+")");this.decompressed=new _(this.compressedSize,this.uncompressedSize,this.crc32,U,A.readData(this.compressedSize))},readCentralPart:function(A){this.versionMadeBy=A.readInt(2),A.skip(2),this.bitFlag=A.readInt(2),this.compressionMethod=A.readString(2),this.date=A.readDate(),this.crc32=A.readInt(4),this.compressedSize=A.readInt(4),this.uncompressedSize=A.readInt(4);var U=A.readInt(2);if(this.extraFieldsLength=A.readInt(2),this.fileCommentLength=A.readInt(2),this.diskNumberStart=A.readInt(2),this.internalFileAttributes=A.readInt(2),this.externalFileAttributes=A.readInt(4),this.localHeaderOffset=A.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");A.skip(U),this.readExtraFields(A),this.parseZIP64ExtraField(A),this.fileComment=A.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var A=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==A&&(this.dosPermissions=63&this.externalFileAttributes),3==A&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var A=H(this.extraFields[1].value);this.uncompressedSize===J.MAX_VALUE_32BITS&&(this.uncompressedSize=A.readInt(8)),this.compressedSize===J.MAX_VALUE_32BITS&&(this.compressedSize=A.readInt(8)),this.localHeaderOffset===J.MAX_VALUE_32BITS&&(this.localHeaderOffset=A.readInt(8)),this.diskNumberStart===J.MAX_VALUE_32BITS&&(this.diskNumberStart=A.readInt(4))}},readExtraFields:function(A){var U,N,Y,T=A.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});A.index+4<T;)U=A.readInt(2),N=A.readInt(2),Y=A.readData(N),this.extraFields[U]={id:U,length:N,value:Y};A.setIndex(T)},handleUTF8:function(){var A=K.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=O.utf8decode(this.fileName),this.fileCommentStr=O.utf8decode(this.fileComment);else{var U=this.findExtraFieldUnicodePath();if(null!==U)this.fileNameStr=U;else{var N=J.transformTo(A,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(N)}var Y=this.findExtraFieldUnicodeComment();if(null!==Y)this.fileCommentStr=Y;else{var T=J.transformTo(A,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(T)}}},findExtraFieldUnicodePath:function(){var A=this.extraFields[28789];if(A){var U=H(A.value);return 1!==U.readInt(1)||x(this.fileName)!==U.readInt(4)?null:O.utf8decode(U.readData(A.length-5))}return null},findExtraFieldUnicodeComment:function(){var A=this.extraFields[25461];if(A){var U=H(A.value);return 1!==U.readInt(1)||x(this.fileComment)!==U.readInt(4)?null:O.utf8decode(U.readData(A.length-5))}return null}},me.exports=G},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(le,me,d){"use strict";function H(U,N,Y){this.name=U,this.dir=Y.dir,this.date=Y.date,this.comment=Y.comment,this.unixPermissions=Y.unixPermissions,this.dosPermissions=Y.dosPermissions,this._data=N,this._dataBinary=Y.binary,this.options={compression:Y.compression,compressionOptions:Y.compressionOptions}}var J=le("./stream/StreamHelper"),_=le("./stream/DataWorker"),x=le("./utf8"),O=le("./compressedObject"),w=le("./stream/GenericWorker");H.prototype={internalStream:function(U){var N=null,Y="string";try{if(!U)throw new Error("No output type specified.");var T="string"===(Y=U.toLowerCase())||"text"===Y;"binarystring"!==Y&&"text"!==Y||(Y="string"),N=this._decompressWorker();var j=!this._dataBinary;j&&!T&&(N=N.pipe(new x.Utf8EncodeWorker)),!j&&T&&(N=N.pipe(new x.Utf8DecodeWorker))}catch(oe){(N=new w("error")).error(oe)}return new J(N,Y,"")},async:function(U,N){return this.internalStream(U).accumulate(N)},nodeStream:function(U,N){return this.internalStream(U||"nodebuffer").toNodejsStream(N)},_compressWorker:function(U,N){if(this._data instanceof O&&this._data.compression.magic===U.magic)return this._data.getCompressedWorker();var Y=this._decompressWorker();return this._dataBinary||(Y=Y.pipe(new x.Utf8EncodeWorker)),O.createWorkerFrom(Y,U,N)},_decompressWorker:function(){return this._data instanceof O?this._data.getContentWorker():this._data instanceof w?this._data:new _(this._data)}};for(var K=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],G=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},A=0;A<K.length;A++)H.prototype[K[A]]=G;me.exports=H},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(le,me,d){(function(H){"use strict";var J,_,x=H.MutationObserver||H.WebKitMutationObserver;if(x){var O=0,w=new x(U),K=H.document.createTextNode("");w.observe(K,{characterData:!0}),J=function(){K.data=O=++O%2}}else if(H.setImmediate||void 0===H.MessageChannel)J="document"in H&&"onreadystatechange"in H.document.createElement("script")?function(){var N=H.document.createElement("script");N.onreadystatechange=function(){U(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},H.document.documentElement.appendChild(N)}:function(){setTimeout(U,0)};else{var G=new H.MessageChannel;G.port1.onmessage=U,J=function(){G.port2.postMessage(0)}}var A=[];function U(){var N,Y;_=!0;for(var T=A.length;T;){for(Y=A,A=[],N=-1;++N<T;)Y[N]();T=A.length}_=!1}me.exports=function(N){1!==A.push(N)||_||J()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(le,me,d){"use strict";var H=le("immediate");function J(){}var _={},x=["REJECTED"],O=["FULFILLED"],w=["PENDING"];function K(T){if("function"!=typeof T)throw new TypeError("resolver must be a function");this.state=w,this.queue=[],this.outcome=void 0,T!==J&&N(this,T)}function G(T,j,oe){this.promise=T,"function"==typeof j&&(this.onFulfilled=j,this.callFulfilled=this.otherCallFulfilled),"function"==typeof oe&&(this.onRejected=oe,this.callRejected=this.otherCallRejected)}function A(T,j,oe){H(function(){var z;try{z=j(oe)}catch(q){return _.reject(T,q)}z===T?_.reject(T,new TypeError("Cannot resolve promise with itself")):_.resolve(T,z)})}function U(T){var j=T&&T.then;if(T&&("object"==typeof T||"function"==typeof T)&&"function"==typeof j)return function(){j.apply(T,arguments)}}function N(T,j){var oe=!1;function z(M){oe||(oe=!0,_.reject(T,M))}function q(M){oe||(oe=!0,_.resolve(T,M))}var X=Y(function(){j(q,z)});"error"===X.status&&z(X.value)}function Y(T,j){var oe={};try{oe.value=T(j),oe.status="success"}catch(z){oe.status="error",oe.value=z}return oe}(me.exports=K).prototype.finally=function(T){if("function"!=typeof T)return this;var j=this.constructor;return this.then(function(oe){return j.resolve(T()).then(function(){return oe})},function(oe){return j.resolve(T()).then(function(){throw oe})})},K.prototype.catch=function(T){return this.then(null,T)},K.prototype.then=function(T,j){if("function"!=typeof T&&this.state===O||"function"!=typeof j&&this.state===x)return this;var oe=new this.constructor(J);return this.state!==w?A(oe,this.state===O?T:j,this.outcome):this.queue.push(new G(oe,T,j)),oe},G.prototype.callFulfilled=function(T){_.resolve(this.promise,T)},G.prototype.otherCallFulfilled=function(T){A(this.promise,this.onFulfilled,T)},G.prototype.callRejected=function(T){_.reject(this.promise,T)},G.prototype.otherCallRejected=function(T){A(this.promise,this.onRejected,T)},_.resolve=function(T,j){var oe=Y(U,j);if("error"===oe.status)return _.reject(T,oe.value);var z=oe.value;if(z)N(T,z);else{T.state=O,T.outcome=j;for(var q=-1,X=T.queue.length;++q<X;)T.queue[q].callFulfilled(j)}return T},_.reject=function(T,j){T.state=x,T.outcome=j;for(var oe=-1,z=T.queue.length;++oe<z;)T.queue[oe].callRejected(j);return T},K.resolve=function(T){return T instanceof this?T:_.resolve(new this(J),T)},K.reject=function(T){var j=new this(J);return _.reject(j,T)},K.all=function(T){var j=this;if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var oe=T.length,z=!1;if(!oe)return this.resolve([]);for(var q=new Array(oe),X=0,M=-1,I=new this(J);++M<oe;)Q(T[M],M);return I;function Q(L,S){j.resolve(L).then(function(k){q[S]=k,++X!==oe||z||(z=!0,_.resolve(I,q))},function(k){z||(z=!0,_.reject(I,k))})}},K.race=function(T){if("[object Array]"!==Object.prototype.toString.call(T))return this.reject(new TypeError("must be an array"));var oe=T.length,z=!1;if(!oe)return this.resolve([]);for(var q=-1,X=new this(J);++q<oe;)this.resolve(T[q]).then(function(I){z||(z=!0,_.resolve(X,I))},function(I){z||(z=!0,_.reject(X,I))});return X}},{immediate:36}],38:[function(le,me,d){"use strict";var H={};(0,le("./lib/utils/common").assign)(H,le("./lib/deflate"),le("./lib/inflate"),le("./lib/zlib/constants")),me.exports=H},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(le,me,d){"use strict";var H=le("./zlib/deflate"),J=le("./utils/common"),_=le("./utils/strings"),x=le("./zlib/messages"),O=le("./zlib/zstream"),w=Object.prototype.toString;function N(T){if(!(this instanceof N))return new N(T);this.options=J.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},T||{});var j=this.options;j.raw&&0<j.windowBits?j.windowBits=-j.windowBits:j.gzip&&0<j.windowBits&&j.windowBits<16&&(j.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new O,this.strm.avail_out=0;var oe=H.deflateInit2(this.strm,j.level,j.method,j.windowBits,j.memLevel,j.strategy);if(0!==oe)throw new Error(x[oe]);if(j.header&&H.deflateSetHeader(this.strm,j.header),j.dictionary){var z;if(z="string"==typeof j.dictionary?_.string2buf(j.dictionary):"[object ArrayBuffer]"===w.call(j.dictionary)?new Uint8Array(j.dictionary):j.dictionary,0!==(oe=H.deflateSetDictionary(this.strm,z)))throw new Error(x[oe]);this._dict_set=!0}}function Y(T,j){var oe=new N(j);if(oe.push(T,!0),oe.err)throw oe.msg||x[oe.err];return oe.result}N.prototype.push=function(T,j){var oe,z,q=this.strm,X=this.options.chunkSize;if(this.ended)return!1;z=j===~~j?j:!0===j?4:0,q.input="string"==typeof T?_.string2buf(T):"[object ArrayBuffer]"===w.call(T)?new Uint8Array(T):T,q.next_in=0,q.avail_in=q.input.length;do{if(0===q.avail_out&&(q.output=new J.Buf8(X),q.next_out=0,q.avail_out=X),1!==(oe=H.deflate(q,z))&&0!==oe)return this.onEnd(oe),!(this.ended=!0);0!==q.avail_out&&(0!==q.avail_in||4!==z&&2!==z)||this.onData("string"===this.options.to?_.buf2binstring(J.shrinkBuf(q.output,q.next_out)):J.shrinkBuf(q.output,q.next_out))}while((0<q.avail_in||0===q.avail_out)&&1!==oe);return 4===z?(oe=H.deflateEnd(this.strm),this.onEnd(oe),this.ended=!0,0===oe):2!==z||(this.onEnd(0),!(q.avail_out=0))},N.prototype.onData=function(T){this.chunks.push(T)},N.prototype.onEnd=function(T){0===T&&(this.result="string"===this.options.to?this.chunks.join(""):J.flattenChunks(this.chunks)),this.chunks=[],this.err=T,this.msg=this.strm.msg},d.Deflate=N,d.deflate=Y,d.deflateRaw=function(T,j){return(j=j||{}).raw=!0,Y(T,j)},d.gzip=function(T,j){return(j=j||{}).gzip=!0,Y(T,j)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(le,me,d){"use strict";var H=le("./zlib/inflate"),J=le("./utils/common"),_=le("./utils/strings"),x=le("./zlib/constants"),O=le("./zlib/messages"),w=le("./zlib/zstream"),K=le("./zlib/gzheader"),G=Object.prototype.toString;function A(N){if(!(this instanceof A))return new A(N);this.options=J.assign({chunkSize:16384,windowBits:0,to:""},N||{});var Y=this.options;Y.raw&&0<=Y.windowBits&&Y.windowBits<16&&(Y.windowBits=-Y.windowBits,0===Y.windowBits&&(Y.windowBits=-15)),!(0<=Y.windowBits&&Y.windowBits<16)||N&&N.windowBits||(Y.windowBits+=32),15<Y.windowBits&&Y.windowBits<48&&0==(15&Y.windowBits)&&(Y.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new w,this.strm.avail_out=0;var T=H.inflateInit2(this.strm,Y.windowBits);if(T!==x.Z_OK)throw new Error(O[T]);this.header=new K,H.inflateGetHeader(this.strm,this.header)}function U(N,Y){var T=new A(Y);if(T.push(N,!0),T.err)throw T.msg||O[T.err];return T.result}A.prototype.push=function(N,Y){var T,j,oe,z,q,X,M=this.strm,I=this.options.chunkSize,Q=this.options.dictionary,L=!1;if(this.ended)return!1;j=Y===~~Y?Y:!0===Y?x.Z_FINISH:x.Z_NO_FLUSH,M.input="string"==typeof N?_.binstring2buf(N):"[object ArrayBuffer]"===G.call(N)?new Uint8Array(N):N,M.next_in=0,M.avail_in=M.input.length;do{if(0===M.avail_out&&(M.output=new J.Buf8(I),M.next_out=0,M.avail_out=I),(T=H.inflate(M,x.Z_NO_FLUSH))===x.Z_NEED_DICT&&Q&&(X="string"==typeof Q?_.string2buf(Q):"[object ArrayBuffer]"===G.call(Q)?new Uint8Array(Q):Q,T=H.inflateSetDictionary(this.strm,X)),T===x.Z_BUF_ERROR&&!0===L&&(T=x.Z_OK,L=!1),T!==x.Z_STREAM_END&&T!==x.Z_OK)return this.onEnd(T),!(this.ended=!0);M.next_out&&(0!==M.avail_out&&T!==x.Z_STREAM_END&&(0!==M.avail_in||j!==x.Z_FINISH&&j!==x.Z_SYNC_FLUSH)||("string"===this.options.to?(oe=_.utf8border(M.output,M.next_out),z=M.next_out-oe,q=_.buf2string(M.output,oe),M.next_out=z,M.avail_out=I-z,z&&J.arraySet(M.output,M.output,oe,z,0),this.onData(q)):this.onData(J.shrinkBuf(M.output,M.next_out)))),0===M.avail_in&&0===M.avail_out&&(L=!0)}while((0<M.avail_in||0===M.avail_out)&&T!==x.Z_STREAM_END);return T===x.Z_STREAM_END&&(j=x.Z_FINISH),j===x.Z_FINISH?(T=H.inflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===x.Z_OK):j!==x.Z_SYNC_FLUSH||(this.onEnd(x.Z_OK),!(M.avail_out=0))},A.prototype.onData=function(N){this.chunks.push(N)},A.prototype.onEnd=function(N){N===x.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):J.flattenChunks(this.chunks)),this.chunks=[],this.err=N,this.msg=this.strm.msg},d.Inflate=A,d.inflate=U,d.inflateRaw=function(N,Y){return(Y=Y||{}).raw=!0,U(N,Y)},d.ungzip=U},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(le,me,d){"use strict";var H=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(x){for(var O=Array.prototype.slice.call(arguments,1);O.length;){var w=O.shift();if(w){if("object"!=typeof w)throw new TypeError(w+"must be non-object");for(var K in w)w.hasOwnProperty(K)&&(x[K]=w[K])}}return x},d.shrinkBuf=function(x,O){return x.length===O?x:x.subarray?x.subarray(0,O):(x.length=O,x)};var J={arraySet:function(x,O,w,K,G){if(O.subarray&&x.subarray)x.set(O.subarray(w,w+K),G);else for(var A=0;A<K;A++)x[G+A]=O[w+A]},flattenChunks:function(x){var O,w,K,G,A,U;for(O=K=0,w=x.length;O<w;O++)K+=x[O].length;for(U=new Uint8Array(K),O=G=0,w=x.length;O<w;O++)U.set(A=x[O],G),G+=A.length;return U}},_={arraySet:function(x,O,w,K,G){for(var A=0;A<K;A++)x[G+A]=O[w+A]},flattenChunks:function(x){return[].concat.apply([],x)}};d.setTyped=function(x){x?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,J)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,_))},d.setTyped(H)},{}],42:[function(le,me,d){"use strict";var H=le("./common"),J=!0,_=!0;try{String.fromCharCode.apply(null,[0])}catch{J=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{_=!1}for(var x=new H.Buf8(256),O=0;O<256;O++)x[O]=252<=O?6:248<=O?5:240<=O?4:224<=O?3:192<=O?2:1;function w(K,G){if(G<65537&&(K.subarray&&_||!K.subarray&&J))return String.fromCharCode.apply(null,H.shrinkBuf(K,G));for(var A="",U=0;U<G;U++)A+=String.fromCharCode(K[U]);return A}x[254]=x[254]=1,d.string2buf=function(K){var G,A,U,N,Y,T=K.length,j=0;for(N=0;N<T;N++)55296==(64512&(A=K.charCodeAt(N)))&&N+1<T&&56320==(64512&(U=K.charCodeAt(N+1)))&&(A=65536+(A-55296<<10)+(U-56320),N++),j+=A<128?1:A<2048?2:A<65536?3:4;for(G=new H.Buf8(j),N=Y=0;Y<j;N++)55296==(64512&(A=K.charCodeAt(N)))&&N+1<T&&56320==(64512&(U=K.charCodeAt(N+1)))&&(A=65536+(A-55296<<10)+(U-56320),N++),A<128?G[Y++]=A:(A<2048?G[Y++]=192|A>>>6:(A<65536?G[Y++]=224|A>>>12:(G[Y++]=240|A>>>18,G[Y++]=128|A>>>12&63),G[Y++]=128|A>>>6&63),G[Y++]=128|63&A);return G},d.buf2binstring=function(K){return w(K,K.length)},d.binstring2buf=function(K){for(var G=new H.Buf8(K.length),A=0,U=G.length;A<U;A++)G[A]=K.charCodeAt(A);return G},d.buf2string=function(K,G){var A,U,N,Y,T=G||K.length,j=new Array(2*T);for(A=U=0;A<T;)if((N=K[A++])<128)j[U++]=N;else if(4<(Y=x[N]))j[U++]=65533,A+=Y-1;else{for(N&=2===Y?31:3===Y?15:7;1<Y&&A<T;)N=N<<6|63&K[A++],Y--;1<Y?j[U++]=65533:N<65536?j[U++]=N:(j[U++]=55296|(N-=65536)>>10&1023,j[U++]=56320|1023&N)}return w(j,U)},d.utf8border=function(K,G){var A;for((G=G||K.length)>K.length&&(G=K.length),A=G-1;0<=A&&128==(192&K[A]);)A--;return A<0||0===A?G:A+x[K[A]]>G?A:G}},{"./common":41}],43:[function(le,me,d){"use strict";me.exports=function(H,J,_,x){for(var O=65535&H|0,w=H>>>16&65535|0,K=0;0!==_;){for(_-=K=2e3<_?2e3:_;w=w+(O=O+J[x++]|0)|0,--K;);O%=65521,w%=65521}return O|w<<16|0}},{}],44:[function(le,me,d){"use strict";me.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(le,me,d){"use strict";var H=function(){for(var J,_=[],x=0;x<256;x++){J=x;for(var O=0;O<8;O++)J=1&J?3988292384^J>>>1:J>>>1;_[x]=J}return _}();me.exports=function(J,_,x,O){var w=H,K=O+x;J^=-1;for(var G=O;G<K;G++)J=J>>>8^w[255&(J^_[G])];return-1^J}},{}],46:[function(le,me,d){"use strict";var H,J=le("../utils/common"),_=le("./trees"),x=le("./adler32"),O=le("./crc32"),w=le("./messages"),U=-2,L=258,S=262,v=113;function fe(ce,ke){return ce.msg=w[ke],ke}function R(ce){return(ce<<1)-(4<ce?9:0)}function F(ce){for(var ke=ce.length;0<=--ke;)ce[ke]=0}function g(ce){var ke=ce.state,ve=ke.pending;ve>ce.avail_out&&(ve=ce.avail_out),0!==ve&&(J.arraySet(ce.output,ke.pending_buf,ke.pending_out,ve,ce.next_out),ce.next_out+=ve,ke.pending_out+=ve,ce.total_out+=ve,ce.avail_out-=ve,ke.pending-=ve,0===ke.pending&&(ke.pending_out=0))}function l(ce,ke){_._tr_flush_block(ce,0<=ce.block_start?ce.block_start:-1,ce.strstart-ce.block_start,ke),ce.block_start=ce.strstart,g(ce.strm)}function c(ce,ke){ce.pending_buf[ce.pending++]=ke}function f(ce,ke){ce.pending_buf[ce.pending++]=ke>>>8&255,ce.pending_buf[ce.pending++]=255&ke}function u(ce,ke){var ve,ye,he=ce.max_chain_length,Ie=ce.strstart,be=ce.prev_length,ae=ce.nice_match,ue=ce.strstart>ce.w_size-S?ce.strstart-(ce.w_size-S):0,xe=ce.window,y=ce.w_mask,W=ce.prev,pe=ce.strstart+L,we=xe[Ie+be-1],De=xe[Ie+be];ce.prev_length>=ce.good_match&&(he>>=2),ae>ce.lookahead&&(ae=ce.lookahead);do{if(xe[(ve=ke)+be]===De&&xe[ve+be-1]===we&&xe[ve]===xe[Ie]&&xe[++ve]===xe[Ie+1]){Ie+=2,ve++;do{}while(xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&xe[++Ie]===xe[++ve]&&Ie<pe);if(ye=L-(pe-Ie),Ie=pe-L,be<ye){if(ce.match_start=ke,ae<=(be=ye))break;we=xe[Ie+be-1],De=xe[Ie+be]}}}while((ke=W[ke&y])>ue&&0!=--he);return be<=ce.lookahead?be:ce.lookahead}function p(ce){var ke,ve,ye,he,Ie,be,ae,ue,xe,y,W=ce.w_size;do{if(he=ce.window_size-ce.lookahead-ce.strstart,ce.strstart>=W+(W-S)){for(J.arraySet(ce.window,ce.window,W,W,0),ce.match_start-=W,ce.strstart-=W,ce.block_start-=W,ke=ve=ce.hash_size;ye=ce.head[--ke],ce.head[ke]=W<=ye?ye-W:0,--ve;);for(ke=ve=W;ye=ce.prev[--ke],ce.prev[ke]=W<=ye?ye-W:0,--ve;);he+=W}if(0===ce.strm.avail_in)break;if(ae=ce.window,ue=ce.strstart+ce.lookahead,y=void 0,(xe=he)<(y=(be=ce.strm).avail_in)&&(y=xe),ve=0===y?0:(be.avail_in-=y,J.arraySet(ae,be.input,be.next_in,y,ue),1===be.state.wrap?be.adler=x(be.adler,ae,y,ue):2===be.state.wrap&&(be.adler=O(be.adler,ae,y,ue)),be.next_in+=y,be.total_in+=y,y),ce.lookahead+=ve,ce.lookahead+ce.insert>=3)for(ce.ins_h=ce.window[Ie=ce.strstart-ce.insert],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Ie+1])&ce.hash_mask;ce.insert&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[Ie+3-1])&ce.hash_mask,ce.prev[Ie&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=Ie,Ie++,ce.insert--,!(ce.lookahead+ce.insert<3)););}while(ce.lookahead<S&&0!==ce.strm.avail_in)}function m(ce,ke){for(var ve,ye;;){if(ce.lookahead<S){if(p(ce),ce.lookahead<S&&0===ke)return 1;if(0===ce.lookahead)break}if(ve=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,ve=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!==ve&&ce.strstart-ve<=ce.w_size-S&&(ce.match_length=u(ce,ve)),ce.match_length>=3)if(ye=_._tr_tally(ce,ce.strstart-ce.match_start,ce.match_length-3),ce.lookahead-=ce.match_length,ce.match_length<=ce.max_lazy_match&&ce.lookahead>=3){for(ce.match_length--;ce.strstart++,ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,ve=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart,0!=--ce.match_length;);ce.strstart++}else ce.strstart+=ce.match_length,ce.match_length=0,ce.ins_h=ce.window[ce.strstart],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+1])&ce.hash_mask;else ye=_._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++;if(ye&&(l(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=ce.strstart<2?ce.strstart:2,4===ke?(l(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(l(ce,!1),0===ce.strm.avail_out)?1:2}function C(ce,ke){for(var ve,ye,he;;){if(ce.lookahead<S){if(p(ce),ce.lookahead<S&&0===ke)return 1;if(0===ce.lookahead)break}if(ve=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,ve=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),ce.prev_length=ce.match_length,ce.prev_match=ce.match_start,ce.match_length=2,0!==ve&&ce.prev_length<ce.max_lazy_match&&ce.strstart-ve<=ce.w_size-S&&(ce.match_length=u(ce,ve),ce.match_length<=5&&(1===ce.strategy||3===ce.match_length&&4096<ce.strstart-ce.match_start)&&(ce.match_length=2)),ce.prev_length>=3&&ce.match_length<=ce.prev_length){for(he=ce.strstart+ce.lookahead-3,ye=_._tr_tally(ce,ce.strstart-1-ce.prev_match,ce.prev_length-3),ce.lookahead-=ce.prev_length-1,ce.prev_length-=2;++ce.strstart<=he&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,ve=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!=--ce.prev_length;);if(ce.match_available=0,ce.match_length=2,ce.strstart++,ye&&(l(ce,!1),0===ce.strm.avail_out))return 1}else if(ce.match_available){if((ye=_._tr_tally(ce,0,ce.window[ce.strstart-1]))&&l(ce,!1),ce.strstart++,ce.lookahead--,0===ce.strm.avail_out)return 1}else ce.match_available=1,ce.strstart++,ce.lookahead--}return ce.match_available&&(ye=_._tr_tally(ce,0,ce.window[ce.strstart-1]),ce.match_available=0),ce.insert=ce.strstart<2?ce.strstart:2,4===ke?(l(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(l(ce,!1),0===ce.strm.avail_out)?1:2}function $(ce,ke,ve,ye,he){this.good_length=ce,this.max_lazy=ke,this.nice_length=ve,this.max_chain=ye,this.func=he}function re(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new J.Buf16(1146),this.dyn_dtree=new J.Buf16(122),this.bl_tree=new J.Buf16(78),F(this.dyn_ltree),F(this.dyn_dtree),F(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new J.Buf16(16),this.heap=new J.Buf16(573),F(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new J.Buf16(573),F(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function se(ce){var ke;return ce&&ce.state?(ce.total_in=ce.total_out=0,ce.data_type=2,(ke=ce.state).pending=0,ke.pending_out=0,ke.wrap<0&&(ke.wrap=-ke.wrap),ke.status=ke.wrap?42:v,ce.adler=2===ke.wrap?0:1,ke.last_flush=0,_._tr_init(ke),0):fe(ce,U)}function Ee(ce){var ve,ke=se(ce);return 0===ke&&((ve=ce.state).window_size=2*ve.w_size,F(ve.head),ve.max_lazy_match=H[ve.level].max_lazy,ve.good_match=H[ve.level].good_length,ve.nice_match=H[ve.level].nice_length,ve.max_chain_length=H[ve.level].max_chain,ve.strstart=0,ve.block_start=0,ve.lookahead=0,ve.insert=0,ve.match_length=ve.prev_length=2,ve.match_available=0,ve.ins_h=0),ke}function Me(ce,ke,ve,ye,he,Ie){if(!ce)return U;var be=1;if(-1===ke&&(ke=6),ye<0?(be=0,ye=-ye):15<ye&&(be=2,ye-=16),he<1||9<he||8!==ve||ye<8||15<ye||ke<0||9<ke||Ie<0||4<Ie)return fe(ce,U);8===ye&&(ye=9);var ae=new re;return(ce.state=ae).strm=ce,ae.wrap=be,ae.gzhead=null,ae.w_bits=ye,ae.w_size=1<<ae.w_bits,ae.w_mask=ae.w_size-1,ae.hash_bits=he+7,ae.hash_size=1<<ae.hash_bits,ae.hash_mask=ae.hash_size-1,ae.hash_shift=~~((ae.hash_bits+3-1)/3),ae.window=new J.Buf8(2*ae.w_size),ae.head=new J.Buf16(ae.hash_size),ae.prev=new J.Buf16(ae.w_size),ae.lit_bufsize=1<<he+6,ae.pending_buf_size=4*ae.lit_bufsize,ae.pending_buf=new J.Buf8(ae.pending_buf_size),ae.d_buf=1*ae.lit_bufsize,ae.l_buf=3*ae.lit_bufsize,ae.level=ke,ae.strategy=Ie,ae.method=ve,Ee(ce)}H=[new $(0,0,0,0,function(ce,ke){var ve=65535;for(ve>ce.pending_buf_size-5&&(ve=ce.pending_buf_size-5);;){if(ce.lookahead<=1){if(p(ce),0===ce.lookahead&&0===ke)return 1;if(0===ce.lookahead)break}ce.strstart+=ce.lookahead,ce.lookahead=0;var ye=ce.block_start+ve;if((0===ce.strstart||ce.strstart>=ye)&&(ce.lookahead=ce.strstart-ye,ce.strstart=ye,l(ce,!1),0===ce.strm.avail_out)||ce.strstart-ce.block_start>=ce.w_size-S&&(l(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=0,4===ke?(l(ce,!0),0===ce.strm.avail_out?3:4):(ce.strstart>ce.block_start&&l(ce,!1),1)}),new $(4,4,8,4,m),new $(4,5,16,8,m),new $(4,6,32,32,m),new $(4,4,16,16,C),new $(8,16,32,32,C),new $(8,16,128,128,C),new $(8,32,128,256,C),new $(32,128,258,1024,C),new $(32,258,258,4096,C)],d.deflateInit=function(ce,ke){return Me(ce,ke,8,15,8,0)},d.deflateInit2=Me,d.deflateReset=Ee,d.deflateResetKeep=se,d.deflateSetHeader=function(ce,ke){return ce&&ce.state?2!==ce.state.wrap?U:(ce.state.gzhead=ke,0):U},d.deflate=function(ce,ke){var ve,ye,he,Ie;if(!ce||!ce.state||5<ke||ke<0)return ce?fe(ce,U):U;if(ye=ce.state,!ce.output||!ce.input&&0!==ce.avail_in||666===ye.status&&4!==ke)return fe(ce,0===ce.avail_out?-5:U);if(ye.strm=ce,ve=ye.last_flush,ye.last_flush=ke,42===ye.status)if(2===ye.wrap)ce.adler=0,c(ye,31),c(ye,139),c(ye,8),ye.gzhead?(c(ye,(ye.gzhead.text?1:0)+(ye.gzhead.hcrc?2:0)+(ye.gzhead.extra?4:0)+(ye.gzhead.name?8:0)+(ye.gzhead.comment?16:0)),c(ye,255&ye.gzhead.time),c(ye,ye.gzhead.time>>8&255),c(ye,ye.gzhead.time>>16&255),c(ye,ye.gzhead.time>>24&255),c(ye,9===ye.level?2:2<=ye.strategy||ye.level<2?4:0),c(ye,255&ye.gzhead.os),ye.gzhead.extra&&ye.gzhead.extra.length&&(c(ye,255&ye.gzhead.extra.length),c(ye,ye.gzhead.extra.length>>8&255)),ye.gzhead.hcrc&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending,0)),ye.gzindex=0,ye.status=69):(c(ye,0),c(ye,0),c(ye,0),c(ye,0),c(ye,0),c(ye,9===ye.level?2:2<=ye.strategy||ye.level<2?4:0),c(ye,3),ye.status=v);else{var be=8+(ye.w_bits-8<<4)<<8;be|=(2<=ye.strategy||ye.level<2?0:ye.level<6?1:6===ye.level?2:3)<<6,0!==ye.strstart&&(be|=32),be+=31-be%31,ye.status=v,f(ye,be),0!==ye.strstart&&(f(ye,ce.adler>>>16),f(ye,65535&ce.adler)),ce.adler=1}if(69===ye.status)if(ye.gzhead.extra){for(he=ye.pending;ye.gzindex<(65535&ye.gzhead.extra.length)&&(ye.pending!==ye.pending_buf_size||(ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),g(ce),he=ye.pending,ye.pending!==ye.pending_buf_size));)c(ye,255&ye.gzhead.extra[ye.gzindex]),ye.gzindex++;ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),ye.gzindex===ye.gzhead.extra.length&&(ye.gzindex=0,ye.status=73)}else ye.status=73;if(73===ye.status)if(ye.gzhead.name){he=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),g(ce),he=ye.pending,ye.pending===ye.pending_buf_size)){Ie=1;break}Ie=ye.gzindex<ye.gzhead.name.length?255&ye.gzhead.name.charCodeAt(ye.gzindex++):0,c(ye,Ie)}while(0!==Ie);ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),0===Ie&&(ye.gzindex=0,ye.status=91)}else ye.status=91;if(91===ye.status)if(ye.gzhead.comment){he=ye.pending;do{if(ye.pending===ye.pending_buf_size&&(ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),g(ce),he=ye.pending,ye.pending===ye.pending_buf_size)){Ie=1;break}Ie=ye.gzindex<ye.gzhead.comment.length?255&ye.gzhead.comment.charCodeAt(ye.gzindex++):0,c(ye,Ie)}while(0!==Ie);ye.gzhead.hcrc&&ye.pending>he&&(ce.adler=O(ce.adler,ye.pending_buf,ye.pending-he,he)),0===Ie&&(ye.status=103)}else ye.status=103;if(103===ye.status&&(ye.gzhead.hcrc?(ye.pending+2>ye.pending_buf_size&&g(ce),ye.pending+2<=ye.pending_buf_size&&(c(ye,255&ce.adler),c(ye,ce.adler>>8&255),ce.adler=0,ye.status=v)):ye.status=v),0!==ye.pending){if(g(ce),0===ce.avail_out)return ye.last_flush=-1,0}else if(0===ce.avail_in&&R(ke)<=R(ve)&&4!==ke)return fe(ce,-5);if(666===ye.status&&0!==ce.avail_in)return fe(ce,-5);if(0!==ce.avail_in||0!==ye.lookahead||0!==ke&&666!==ye.status){var ae=2===ye.strategy?function(ue,xe){for(var y;;){if(0===ue.lookahead&&(p(ue),0===ue.lookahead)){if(0===xe)return 1;break}if(ue.match_length=0,y=_._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++,y&&(l(ue,!1),0===ue.strm.avail_out))return 1}return ue.insert=0,4===xe?(l(ue,!0),0===ue.strm.avail_out?3:4):ue.last_lit&&(l(ue,!1),0===ue.strm.avail_out)?1:2}(ye,ke):3===ye.strategy?function(ue,xe){for(var y,W,pe,we,De=ue.window;;){if(ue.lookahead<=L){if(p(ue),ue.lookahead<=L&&0===xe)return 1;if(0===ue.lookahead)break}if(ue.match_length=0,ue.lookahead>=3&&0<ue.strstart&&(W=De[pe=ue.strstart-1])===De[++pe]&&W===De[++pe]&&W===De[++pe]){we=ue.strstart+L;do{}while(W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&W===De[++pe]&&pe<we);ue.match_length=L-(we-pe),ue.match_length>ue.lookahead&&(ue.match_length=ue.lookahead)}if(ue.match_length>=3?(y=_._tr_tally(ue,1,ue.match_length-3),ue.lookahead-=ue.match_length,ue.strstart+=ue.match_length,ue.match_length=0):(y=_._tr_tally(ue,0,ue.window[ue.strstart]),ue.lookahead--,ue.strstart++),y&&(l(ue,!1),0===ue.strm.avail_out))return 1}return ue.insert=0,4===xe?(l(ue,!0),0===ue.strm.avail_out?3:4):ue.last_lit&&(l(ue,!1),0===ue.strm.avail_out)?1:2}(ye,ke):H[ye.level].func(ye,ke);if(3!==ae&&4!==ae||(ye.status=666),1===ae||3===ae)return 0===ce.avail_out&&(ye.last_flush=-1),0;if(2===ae&&(1===ke?_._tr_align(ye):5!==ke&&(_._tr_stored_block(ye,0,0,!1),3===ke&&(F(ye.head),0===ye.lookahead&&(ye.strstart=0,ye.block_start=0,ye.insert=0))),g(ce),0===ce.avail_out))return ye.last_flush=-1,0}return 4!==ke?0:ye.wrap<=0?1:(2===ye.wrap?(c(ye,255&ce.adler),c(ye,ce.adler>>8&255),c(ye,ce.adler>>16&255),c(ye,ce.adler>>24&255),c(ye,255&ce.total_in),c(ye,ce.total_in>>8&255),c(ye,ce.total_in>>16&255),c(ye,ce.total_in>>24&255)):(f(ye,ce.adler>>>16),f(ye,65535&ce.adler)),g(ce),0<ye.wrap&&(ye.wrap=-ye.wrap),0!==ye.pending?0:1)},d.deflateEnd=function(ce){var ke;return ce&&ce.state?42!==(ke=ce.state.status)&&69!==ke&&73!==ke&&91!==ke&&103!==ke&&ke!==v&&666!==ke?fe(ce,U):(ce.state=null,ke===v?fe(ce,-3):0):U},d.deflateSetDictionary=function(ce,ke){var ve,ye,he,Ie,be,ae,ue,xe,y=ke.length;if(!ce||!ce.state||2===(Ie=(ve=ce.state).wrap)||1===Ie&&42!==ve.status||ve.lookahead)return U;for(1===Ie&&(ce.adler=x(ce.adler,ke,y,0)),ve.wrap=0,y>=ve.w_size&&(0===Ie&&(F(ve.head),ve.strstart=0,ve.block_start=0,ve.insert=0),xe=new J.Buf8(ve.w_size),J.arraySet(xe,ke,y-ve.w_size,ve.w_size,0),ke=xe,y=ve.w_size),be=ce.avail_in,ae=ce.next_in,ue=ce.input,ce.avail_in=y,ce.next_in=0,ce.input=ke,p(ve);ve.lookahead>=3;){for(ye=ve.strstart,he=ve.lookahead-2;ve.ins_h=(ve.ins_h<<ve.hash_shift^ve.window[ye+3-1])&ve.hash_mask,ve.prev[ye&ve.w_mask]=ve.head[ve.ins_h],ve.head[ve.ins_h]=ye,ye++,--he;);ve.strstart=ye,ve.lookahead=2,p(ve)}return ve.strstart+=ve.lookahead,ve.block_start=ve.strstart,ve.insert=ve.lookahead,ve.lookahead=0,ve.match_length=ve.prev_length=2,ve.match_available=0,ce.next_in=ae,ce.input=ue,ce.avail_in=be,ve.wrap=Ie,0},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(le,me,d){"use strict";me.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(le,me,d){"use strict";me.exports=function(H,J){var _,x,O,w,K,G,A,U,N,Y,T,j,oe,z,q,X,M,I,Q,L,S,k,v,P,B;P=H.input,O=(x=H.next_in)+(H.avail_in-5),B=H.output,K=(w=H.next_out)-(J-H.avail_out),G=w+(H.avail_out-257),A=(_=H.state).dmax,U=_.wsize,N=_.whave,Y=_.wnext,T=_.window,j=_.hold,oe=_.bits,z=_.lencode,q=_.distcode,X=(1<<_.lenbits)-1,M=(1<<_.distbits)-1;e:do{oe<15&&(j+=P[x++]<<oe,j+=P[x++]<<(oe+=8),oe+=8),I=z[j&X];t:for(;;){if(j>>>=Q=I>>>24,oe-=Q,0==(Q=I>>>16&255))B[w++]=65535&I;else{if(!(16&Q)){if(0==(64&Q)){I=z[(65535&I)+(j&(1<<Q)-1)];continue t}if(32&Q){_.mode=12;break e}H.msg="invalid literal/length code",_.mode=30;break e}L=65535&I,(Q&=15)&&(oe<Q&&(j+=P[x++]<<oe,oe+=8),L+=j&(1<<Q)-1,j>>>=Q,oe-=Q),oe<15&&(j+=P[x++]<<oe,j+=P[x++]<<(oe+=8),oe+=8),I=q[j&M];n:for(;;){if(j>>>=Q=I>>>24,oe-=Q,!(16&(Q=I>>>16&255))){if(0==(64&Q)){I=q[(65535&I)+(j&(1<<Q)-1)];continue n}H.msg="invalid distance code",_.mode=30;break e}if(S=65535&I,oe<(Q&=15)&&(j+=P[x++]<<oe,(oe+=8)<Q&&(j+=P[x++]<<oe,oe+=8)),A<(S+=j&(1<<Q)-1)){H.msg="invalid distance too far back",_.mode=30;break e}if(j>>>=Q,oe-=Q,(Q=w-K)<S){if(N<(Q=S-Q)&&_.sane){H.msg="invalid distance too far back",_.mode=30;break e}if(v=T,(k=0)===Y){if(k+=U-Q,Q<L){for(L-=Q;B[w++]=T[k++],--Q;);k=w-S,v=B}}else if(Y<Q){if(k+=U+Y-Q,(Q-=Y)<L){for(L-=Q;B[w++]=T[k++],--Q;);if(k=0,Y<L){for(L-=Q=Y;B[w++]=T[k++],--Q;);k=w-S,v=B}}}else if(k+=Y-Q,Q<L){for(L-=Q;B[w++]=T[k++],--Q;);k=w-S,v=B}for(;2<L;)B[w++]=v[k++],B[w++]=v[k++],B[w++]=v[k++],L-=3;L&&(B[w++]=v[k++],1<L&&(B[w++]=v[k++]))}else{for(k=w-S;B[w++]=B[k++],B[w++]=B[k++],B[w++]=B[k++],2<(L-=3););L&&(B[w++]=B[k++],1<L&&(B[w++]=B[k++]))}break}}break}}while(x<O&&w<G);x-=L=oe>>3,j&=(1<<(oe-=L<<3))-1,H.next_in=x,H.next_out=w,H.avail_in=x<O?O-x+5:5-(x-O),H.avail_out=w<G?G-w+257:257-(w-G),_.hold=j,_.bits=oe}},{}],49:[function(le,me,d){"use strict";var H=le("../utils/common"),J=le("./adler32"),_=le("./crc32"),x=le("./inffast"),O=le("./inftrees"),A=-2;function T(k){return(k>>>24&255)+(k>>>8&65280)+((65280&k)<<8)+((255&k)<<24)}function j(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new H.Buf16(320),this.work=new H.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function oe(k){var v;return k&&k.state?(k.total_in=k.total_out=(v=k.state).total=0,k.msg="",v.wrap&&(k.adler=1&v.wrap),v.mode=1,v.last=0,v.havedict=0,v.dmax=32768,v.head=null,v.hold=0,v.bits=0,v.lencode=v.lendyn=new H.Buf32(852),v.distcode=v.distdyn=new H.Buf32(592),v.sane=1,v.back=-1,0):A}function z(k){var v;return k&&k.state?((v=k.state).wsize=0,v.whave=0,v.wnext=0,oe(k)):A}function q(k,v){var P,B;return k&&k.state?(B=k.state,v<0?(P=0,v=-v):(P=1+(v>>4),v<48&&(v&=15)),v&&(v<8||15<v)?A:(null!==B.window&&B.wbits!==v&&(B.window=null),B.wrap=P,B.wbits=v,z(k))):A}function X(k,v){var P,B;return k?(B=new j,(k.state=B).window=null,0!==(P=q(k,v))&&(k.state=null),P):A}var M,I,Q=!0;function L(k){if(Q){var v;for(M=new H.Buf32(512),I=new H.Buf32(32),v=0;v<144;)k.lens[v++]=8;for(;v<256;)k.lens[v++]=9;for(;v<280;)k.lens[v++]=7;for(;v<288;)k.lens[v++]=8;for(O(1,k.lens,0,288,M,0,k.work,{bits:9}),v=0;v<32;)k.lens[v++]=5;O(2,k.lens,0,32,I,0,k.work,{bits:5}),Q=!1}k.lencode=M,k.lenbits=9,k.distcode=I,k.distbits=5}function S(k,v,P,B){var te,D=k.state;return null===D.window&&(D.wsize=1<<D.wbits,D.wnext=0,D.whave=0,D.window=new H.Buf8(D.wsize)),B>=D.wsize?(H.arraySet(D.window,v,P-D.wsize,D.wsize,0),D.wnext=0,D.whave=D.wsize):(B<(te=D.wsize-D.wnext)&&(te=B),H.arraySet(D.window,v,P-B,te,D.wnext),(B-=te)?(H.arraySet(D.window,v,P-B,B,0),D.wnext=B,D.whave=D.wsize):(D.wnext+=te,D.wnext===D.wsize&&(D.wnext=0),D.whave<D.wsize&&(D.whave+=te))),0}d.inflateReset=z,d.inflateReset2=q,d.inflateResetKeep=oe,d.inflateInit=function(k){return X(k,15)},d.inflateInit2=X,d.inflate=function(k,v){var P,B,te,D,fe,R,F,g,l,c,f,u,p,m,C,$,re,se,Ee,Me,ce,ke,ve,ye,he=0,Ie=new H.Buf8(4),be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!k||!k.state||!k.output||!k.input&&0!==k.avail_in)return A;12===(P=k.state).mode&&(P.mode=13),fe=k.next_out,te=k.output,D=k.next_in,B=k.input,g=P.hold,l=P.bits,c=R=k.avail_in,f=F=k.avail_out,ke=0;e:for(;;)switch(P.mode){case 1:if(0===P.wrap){P.mode=13;break}for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(2&P.wrap&&35615===g){Ie[P.check=0]=255&g,Ie[1]=g>>>8&255,P.check=_(P.check,Ie,2,0),l=g=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&g)<<8)+(g>>8))%31){k.msg="incorrect header check",P.mode=30;break}if(8!=(15&g)){k.msg="unknown compression method",P.mode=30;break}if(l-=4,ce=8+(15&(g>>>=4)),0===P.wbits)P.wbits=ce;else if(ce>P.wbits){k.msg="invalid window size",P.mode=30;break}P.dmax=1<<ce,k.adler=P.check=1,P.mode=512&g?10:12,l=g=0;break;case 2:for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(P.flags=g,8!=(255&P.flags)){k.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){k.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=g>>8&1),512&P.flags&&(Ie[0]=255&g,Ie[1]=g>>>8&255,P.check=_(P.check,Ie,2,0)),l=g=0,P.mode=3;case 3:for(;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.head&&(P.head.time=g),512&P.flags&&(Ie[0]=255&g,Ie[1]=g>>>8&255,Ie[2]=g>>>16&255,Ie[3]=g>>>24&255,P.check=_(P.check,Ie,4,0)),l=g=0,P.mode=4;case 4:for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.head&&(P.head.xflags=255&g,P.head.os=g>>8),512&P.flags&&(Ie[0]=255&g,Ie[1]=g>>>8&255,P.check=_(P.check,Ie,2,0)),l=g=0,P.mode=5;case 5:if(1024&P.flags){for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.length=g,P.head&&(P.head.extra_len=g),512&P.flags&&(Ie[0]=255&g,Ie[1]=g>>>8&255,P.check=_(P.check,Ie,2,0)),l=g=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(R<(u=P.length)&&(u=R),u&&(P.head&&(ce=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),H.arraySet(P.head.extra,B,D,u,ce)),512&P.flags&&(P.check=_(P.check,B,u,D)),R-=u,D+=u,P.length-=u),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(0===R)break e;for(u=0;ce=B[D+u++],P.head&&ce&&P.length<65536&&(P.head.name+=String.fromCharCode(ce)),ce&&u<R;);if(512&P.flags&&(P.check=_(P.check,B,u,D)),R-=u,D+=u,ce)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(0===R)break e;for(u=0;ce=B[D+u++],P.head&&ce&&P.length<65536&&(P.head.comment+=String.fromCharCode(ce)),ce&&u<R;);if(512&P.flags&&(P.check=_(P.check,B,u,D)),R-=u,D+=u,ce)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;l<16;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(g!==(65535&P.check)){k.msg="header crc mismatch",P.mode=30;break}l=g=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),k.adler=P.check=0,P.mode=12;break;case 10:for(;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}k.adler=P.check=T(g),l=g=0,P.mode=11;case 11:if(0===P.havedict)return k.next_out=fe,k.avail_out=F,k.next_in=D,k.avail_in=R,P.hold=g,P.bits=l,2;k.adler=P.check=1,P.mode=12;case 12:if(5===v||6===v)break e;case 13:if(P.last){g>>>=7&l,l-=7&l,P.mode=27;break}for(;l<3;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}switch(P.last=1&g,l-=1,3&(g>>>=1)){case 0:P.mode=14;break;case 1:if(L(P),P.mode=20,6!==v)break;g>>>=2,l-=2;break e;case 2:P.mode=17;break;case 3:k.msg="invalid block type",P.mode=30}g>>>=2,l-=2;break;case 14:for(g>>>=7&l,l-=7&l;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if((65535&g)!=(g>>>16^65535)){k.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&g,l=g=0,P.mode=15,6===v)break e;case 15:P.mode=16;case 16:if(u=P.length){if(R<u&&(u=R),F<u&&(u=F),0===u)break e;H.arraySet(te,B,D,u,fe),R-=u,D+=u,F-=u,fe+=u,P.length-=u;break}P.mode=12;break;case 17:for(;l<14;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(P.nlen=257+(31&g),l-=5,P.ndist=1+(31&(g>>>=5)),l-=5,P.ncode=4+(15&(g>>>=5)),g>>>=4,l-=4,286<P.nlen||30<P.ndist){k.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;l<3;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.lens[be[P.have++]]=7&g,g>>>=3,l-=3}for(;P.have<19;)P.lens[be[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,ke=O(0,P.lens,0,19,P.lencode,0,P.work,ve={bits:P.lenbits}),P.lenbits=ve.bits,ke){k.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;$=(he=P.lencode[g&(1<<P.lenbits)-1])>>>16&255,re=65535&he,!((C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(re<16)g>>>=C,l-=C,P.lens[P.have++]=re;else{if(16===re){for(ye=C+2;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(g>>>=C,l-=C,0===P.have){k.msg="invalid bit length repeat",P.mode=30;break}ce=P.lens[P.have-1],u=3+(3&g),g>>>=2,l-=2}else if(17===re){for(ye=C+3;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}l-=C,ce=0,u=3+(7&(g>>>=C)),g>>>=3,l-=3}else{for(ye=C+7;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}l-=C,ce=0,u=11+(127&(g>>>=C)),g>>>=7,l-=7}if(P.have+u>P.nlen+P.ndist){k.msg="invalid bit length repeat",P.mode=30;break}for(;u--;)P.lens[P.have++]=ce}}if(30===P.mode)break;if(0===P.lens[256]){k.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,ke=O(1,P.lens,0,P.nlen,P.lencode,0,P.work,ve={bits:P.lenbits}),P.lenbits=ve.bits,ke){k.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,ke=O(2,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,ve={bits:P.distbits}),P.distbits=ve.bits,ke){k.msg="invalid distances set",P.mode=30;break}if(P.mode=20,6===v)break e;case 20:P.mode=21;case 21:if(6<=R&&258<=F){k.next_out=fe,k.avail_out=F,k.next_in=D,k.avail_in=R,P.hold=g,P.bits=l,x(k,f),fe=k.next_out,te=k.output,F=k.avail_out,D=k.next_in,B=k.input,R=k.avail_in,g=P.hold,l=P.bits,12===P.mode&&(P.back=-1);break}for(P.back=0;$=(he=P.lencode[g&(1<<P.lenbits)-1])>>>16&255,re=65535&he,!((C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if($&&0==(240&$)){for(se=C,Ee=$,Me=re;$=(he=P.lencode[Me+((g&(1<<se+Ee)-1)>>se)])>>>16&255,re=65535&he,!(se+(C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}g>>>=se,l-=se,P.back+=se}if(g>>>=C,l-=C,P.back+=C,P.length=re,0===$){P.mode=26;break}if(32&$){P.back=-1,P.mode=12;break}if(64&$){k.msg="invalid literal/length code",P.mode=30;break}P.extra=15&$,P.mode=22;case 22:if(P.extra){for(ye=P.extra;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.length+=g&(1<<P.extra)-1,g>>>=P.extra,l-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;$=(he=P.distcode[g&(1<<P.distbits)-1])>>>16&255,re=65535&he,!((C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(0==(240&$)){for(se=C,Ee=$,Me=re;$=(he=P.distcode[Me+((g&(1<<se+Ee)-1)>>se)])>>>16&255,re=65535&he,!(se+(C=he>>>24)<=l);){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}g>>>=se,l-=se,P.back+=se}if(g>>>=C,l-=C,P.back+=C,64&$){k.msg="invalid distance code",P.mode=30;break}P.offset=re,P.extra=15&$,P.mode=24;case 24:if(P.extra){for(ye=P.extra;l<ye;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}P.offset+=g&(1<<P.extra)-1,g>>>=P.extra,l-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){k.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(0===F)break e;if(P.offset>(u=f-F)){if((u=P.offset-u)>P.whave&&P.sane){k.msg="invalid distance too far back",P.mode=30;break}p=u>P.wnext?P.wsize-(u-=P.wnext):P.wnext-u,u>P.length&&(u=P.length),m=P.window}else m=te,p=fe-P.offset,u=P.length;for(F<u&&(u=F),F-=u,P.length-=u;te[fe++]=m[p++],--u;);0===P.length&&(P.mode=21);break;case 26:if(0===F)break e;te[fe++]=P.length,F--,P.mode=21;break;case 27:if(P.wrap){for(;l<32;){if(0===R)break e;R--,g|=B[D++]<<l,l+=8}if(k.total_out+=f-=F,P.total+=f,f&&(k.adler=P.check=P.flags?_(P.check,te,f,fe-f):J(P.check,te,f,fe-f)),f=F,(P.flags?g:T(g))!==P.check){k.msg="incorrect data check",P.mode=30;break}l=g=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;l<32;){if(0===R)break e;R--,g+=B[D++]<<l,l+=8}if(g!==(4294967295&P.total)){k.msg="incorrect length check",P.mode=30;break}l=g=0}P.mode=29;case 29:ke=1;break e;case 30:ke=-3;break e;case 31:return-4;default:return A}return k.next_out=fe,k.avail_out=F,k.next_in=D,k.avail_in=R,P.hold=g,P.bits=l,(P.wsize||f!==k.avail_out&&P.mode<30&&(P.mode<27||4!==v))&&S(k,k.output,k.next_out,f-k.avail_out)?(P.mode=31,-4):(f-=k.avail_out,k.total_in+=c-=k.avail_in,k.total_out+=f,P.total+=f,P.wrap&&f&&(k.adler=P.check=P.flags?_(P.check,te,f,k.next_out-f):J(P.check,te,f,k.next_out-f)),k.data_type=P.bits+(P.last?64:0)+(12===P.mode?128:0)+(20===P.mode||15===P.mode?256:0),(0==c&&0===f||4===v)&&0===ke&&(ke=-5),ke)},d.inflateEnd=function(k){if(!k||!k.state)return A;var v=k.state;return v.window&&(v.window=null),k.state=null,0},d.inflateGetHeader=function(k,v){var P;return k&&k.state?0==(2&(P=k.state).wrap)?A:((P.head=v).done=!1,0):A},d.inflateSetDictionary=function(k,v){var P,B=v.length;return k&&k.state?0!==(P=k.state).wrap&&11!==P.mode?A:11===P.mode&&J(1,v,B,0)!==P.check?-3:S(k,v,B,B)?(P.mode=31,-4):(P.havedict=1,0):A},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(le,me,d){"use strict";var H=le("../utils/common"),J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],_=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],x=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],O=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];me.exports=function(w,K,G,A,U,N,Y,T){var j,oe,z,q,X,M,I,Q,L,S=T.bits,k=0,v=0,P=0,B=0,te=0,D=0,fe=0,R=0,F=0,g=0,l=null,c=0,f=new H.Buf16(16),u=new H.Buf16(16),p=null,m=0;for(k=0;k<=15;k++)f[k]=0;for(v=0;v<A;v++)f[K[G+v]]++;for(te=S,B=15;1<=B&&0===f[B];B--);if(B<te&&(te=B),0===B)return U[N++]=20971520,U[N++]=20971520,T.bits=1,0;for(P=1;P<B&&0===f[P];P++);for(te<P&&(te=P),k=R=1;k<=15;k++)if(R<<=1,(R-=f[k])<0)return-1;if(0<R&&(0===w||1!==B))return-1;for(u[1]=0,k=1;k<15;k++)u[k+1]=u[k]+f[k];for(v=0;v<A;v++)0!==K[G+v]&&(Y[u[K[G+v]]++]=v);if(M=0===w?(l=p=Y,19):1===w?(l=J,c-=257,p=_,m-=257,256):(l=x,p=O,-1),k=P,X=N,fe=v=g=0,z=-1,q=(F=1<<(D=te))-1,1===w&&852<F||2===w&&592<F)return 1;for(;;){for(I=k-fe,L=Y[v]<M?(Q=0,Y[v]):Y[v]>M?(Q=p[m+Y[v]],l[c+Y[v]]):(Q=96,0),j=1<<k-fe,P=oe=1<<D;U[X+(g>>fe)+(oe-=j)]=I<<24|Q<<16|L|0,0!==oe;);for(j=1<<k-1;g&j;)j>>=1;if(0!==j?(g&=j-1,g+=j):g=0,v++,0==--f[k]){if(k===B)break;k=K[G+Y[v]]}if(te<k&&(g&q)!==z){for(0===fe&&(fe=te),X+=P,R=1<<(D=k-fe);D+fe<B&&!((R-=f[D+fe])<=0);)D++,R<<=1;if(F+=1<<D,1===w&&852<F||2===w&&592<F)return 1;U[z=g&q]=te<<24|D<<16|X-N|0}}return 0!==g&&(U[X+g]=k-fe<<24|64<<16|0),T.bits=te,0}},{"../utils/common":41}],51:[function(le,me,d){"use strict";me.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(le,me,d){"use strict";var H=le("../utils/common");function x(he){for(var Ie=he.length;0<=--Ie;)he[Ie]=0}var K=256,G=286,A=30,Y=15,M=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Q=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],L=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S=new Array(576);x(S);var k=new Array(60);x(k);var v=new Array(512);x(v);var P=new Array(256);x(P);var B=new Array(29);x(B);var te,D,fe,R=new Array(A);function F(he,Ie,be,ae,ue){this.static_tree=he,this.extra_bits=Ie,this.extra_base=be,this.elems=ae,this.max_length=ue,this.has_stree=he&&he.length}function g(he,Ie){this.dyn_tree=he,this.max_code=0,this.stat_desc=Ie}function l(he){return he<256?v[he]:v[256+(he>>>7)]}function c(he,Ie){he.pending_buf[he.pending++]=255&Ie,he.pending_buf[he.pending++]=Ie>>>8&255}function f(he,Ie,be){he.bi_valid>16-be?(he.bi_buf|=Ie<<he.bi_valid&65535,c(he,he.bi_buf),he.bi_buf=Ie>>16-he.bi_valid,he.bi_valid+=be-16):(he.bi_buf|=Ie<<he.bi_valid&65535,he.bi_valid+=be)}function u(he,Ie,be){f(he,be[2*Ie],be[2*Ie+1])}function p(he,Ie){for(var be=0;be|=1&he,he>>>=1,be<<=1,0<--Ie;);return be>>>1}function m(he,Ie,be){var ae,ue,xe=new Array(16),y=0;for(ae=1;ae<=Y;ae++)xe[ae]=y=y+be[ae-1]<<1;for(ue=0;ue<=Ie;ue++){var W=he[2*ue+1];0!==W&&(he[2*ue]=p(xe[W]++,W))}}function C(he){var Ie;for(Ie=0;Ie<G;Ie++)he.dyn_ltree[2*Ie]=0;for(Ie=0;Ie<A;Ie++)he.dyn_dtree[2*Ie]=0;for(Ie=0;Ie<19;Ie++)he.bl_tree[2*Ie]=0;he.dyn_ltree[512]=1,he.opt_len=he.static_len=0,he.last_lit=he.matches=0}function $(he){8<he.bi_valid?c(he,he.bi_buf):0<he.bi_valid&&(he.pending_buf[he.pending++]=he.bi_buf),he.bi_buf=0,he.bi_valid=0}function re(he,Ie,be,ae){var ue=2*Ie,xe=2*be;return he[ue]<he[xe]||he[ue]===he[xe]&&ae[Ie]<=ae[be]}function se(he,Ie,be){for(var ae=he.heap[be],ue=be<<1;ue<=he.heap_len&&(ue<he.heap_len&&re(Ie,he.heap[ue+1],he.heap[ue],he.depth)&&ue++,!re(Ie,ae,he.heap[ue],he.depth));)he.heap[be]=he.heap[ue],be=ue,ue<<=1;he.heap[be]=ae}function Ee(he,Ie,be){var ae,ue,xe,y,W=0;if(0!==he.last_lit)for(;ae=he.pending_buf[he.d_buf+2*W]<<8|he.pending_buf[he.d_buf+2*W+1],ue=he.pending_buf[he.l_buf+W],W++,0===ae?u(he,ue,Ie):(u(he,(xe=P[ue])+K+1,Ie),0!==(y=M[xe])&&f(he,ue-=B[xe],y),u(he,xe=l(--ae),be),0!==(y=I[xe])&&f(he,ae-=R[xe],y)),W<he.last_lit;);u(he,256,Ie)}function Me(he,Ie){var be,ae,ue,xe=Ie.dyn_tree,y=Ie.stat_desc.static_tree,W=Ie.stat_desc.has_stree,pe=Ie.stat_desc.elems,we=-1;for(he.heap_len=0,he.heap_max=573,be=0;be<pe;be++)0!==xe[2*be]?(he.heap[++he.heap_len]=we=be,he.depth[be]=0):xe[2*be+1]=0;for(;he.heap_len<2;)xe[2*(ue=he.heap[++he.heap_len]=we<2?++we:0)]=1,he.depth[ue]=0,he.opt_len--,W&&(he.static_len-=y[2*ue+1]);for(Ie.max_code=we,be=he.heap_len>>1;1<=be;be--)se(he,xe,be);for(ue=pe;be=he.heap[1],he.heap[1]=he.heap[he.heap_len--],se(he,xe,1),ae=he.heap[1],he.heap[--he.heap_max]=be,he.heap[--he.heap_max]=ae,xe[2*ue]=xe[2*be]+xe[2*ae],he.depth[ue]=(he.depth[be]>=he.depth[ae]?he.depth[be]:he.depth[ae])+1,xe[2*be+1]=xe[2*ae+1]=ue,he.heap[1]=ue++,se(he,xe,1),2<=he.heap_len;);he.heap[--he.heap_max]=he.heap[1],function(De,Le){var Ye,ut,Dt,Ot,un,tn,On=Le.dyn_tree,Mn=Le.max_code,yr=Le.stat_desc.static_tree,fa=Le.stat_desc.has_stree,ja=Le.stat_desc.extra_bits,Ua=Le.stat_desc.extra_base,wo=Le.stat_desc.max_length,sr=0;for(Ot=0;Ot<=Y;Ot++)De.bl_count[Ot]=0;for(On[2*De.heap[De.heap_max]+1]=0,Ye=De.heap_max+1;Ye<573;Ye++)wo<(Ot=On[2*On[2*(ut=De.heap[Ye])+1]+1]+1)&&(Ot=wo,sr++),On[2*ut+1]=Ot,Mn<ut||(De.bl_count[Ot]++,un=0,Ua<=ut&&(un=ja[ut-Ua]),De.opt_len+=(tn=On[2*ut])*(Ot+un),fa&&(De.static_len+=tn*(yr[2*ut+1]+un)));if(0!==sr){do{for(Ot=wo-1;0===De.bl_count[Ot];)Ot--;De.bl_count[Ot]--,De.bl_count[Ot+1]+=2,De.bl_count[wo]--,sr-=2}while(0<sr);for(Ot=wo;0!==Ot;Ot--)for(ut=De.bl_count[Ot];0!==ut;)Mn<(Dt=De.heap[--Ye])||(On[2*Dt+1]!==Ot&&(De.opt_len+=(Ot-On[2*Dt+1])*On[2*Dt],On[2*Dt+1]=Ot),ut--)}}(he,Ie),m(xe,we,he.bl_count)}function ce(he,Ie,be){var ae,ue,xe=-1,y=Ie[1],W=0,pe=7,we=4;for(0===y&&(pe=138,we=3),Ie[2*(be+1)+1]=65535,ae=0;ae<=be;ae++)ue=y,y=Ie[2*(ae+1)+1],++W<pe&&ue===y||(W<we?he.bl_tree[2*ue]+=W:0!==ue?(ue!==xe&&he.bl_tree[2*ue]++,he.bl_tree[32]++):W<=10?he.bl_tree[34]++:he.bl_tree[36]++,xe=ue,we=(W=0)===y?(pe=138,3):ue===y?(pe=6,3):(pe=7,4))}function ke(he,Ie,be){var ae,ue,xe=-1,y=Ie[1],W=0,pe=7,we=4;for(0===y&&(pe=138,we=3),ae=0;ae<=be;ae++)if(ue=y,y=Ie[2*(ae+1)+1],!(++W<pe&&ue===y)){if(W<we)for(;u(he,ue,he.bl_tree),0!=--W;);else 0!==ue?(ue!==xe&&(u(he,ue,he.bl_tree),W--),u(he,16,he.bl_tree),f(he,W-3,2)):W<=10?(u(he,17,he.bl_tree),f(he,W-3,3)):(u(he,18,he.bl_tree),f(he,W-11,7));xe=ue,we=(W=0)===y?(pe=138,3):ue===y?(pe=6,3):(pe=7,4)}}x(R);var ve=!1;function ye(he,Ie,be,ae){var ue,xe,y;f(he,0+(ae?1:0),3),xe=Ie,y=be,$(ue=he),c(ue,y),c(ue,~y),H.arraySet(ue.pending_buf,ue.window,xe,y,ue.pending),ue.pending+=y}d._tr_init=function(he){ve||(function(){var Ie,be,ae,ue,xe,y=new Array(16);for(ue=ae=0;ue<28;ue++)for(B[ue]=ae,Ie=0;Ie<1<<M[ue];Ie++)P[ae++]=ue;for(P[ae-1]=ue,ue=xe=0;ue<16;ue++)for(R[ue]=xe,Ie=0;Ie<1<<I[ue];Ie++)v[xe++]=ue;for(xe>>=7;ue<A;ue++)for(R[ue]=xe<<7,Ie=0;Ie<1<<I[ue]-7;Ie++)v[256+xe++]=ue;for(be=0;be<=Y;be++)y[be]=0;for(Ie=0;Ie<=143;)S[2*Ie+1]=8,Ie++,y[8]++;for(;Ie<=255;)S[2*Ie+1]=9,Ie++,y[9]++;for(;Ie<=279;)S[2*Ie+1]=7,Ie++,y[7]++;for(;Ie<=287;)S[2*Ie+1]=8,Ie++,y[8]++;for(m(S,287,y),Ie=0;Ie<A;Ie++)k[2*Ie+1]=5,k[2*Ie]=p(Ie,5);te=new F(S,M,257,G,Y),D=new F(k,I,0,A,Y),fe=new F(new Array(0),Q,0,19,7)}(),ve=!0),he.l_desc=new g(he.dyn_ltree,te),he.d_desc=new g(he.dyn_dtree,D),he.bl_desc=new g(he.bl_tree,fe),he.bi_buf=0,he.bi_valid=0,C(he)},d._tr_stored_block=ye,d._tr_flush_block=function(he,Ie,be,ae){var ue,xe,y=0;0<he.level?(2===he.strm.data_type&&(he.strm.data_type=function(W){var pe,we=4093624447;for(pe=0;pe<=31;pe++,we>>>=1)if(1&we&&0!==W.dyn_ltree[2*pe])return 0;if(0!==W.dyn_ltree[18]||0!==W.dyn_ltree[20]||0!==W.dyn_ltree[26])return 1;for(pe=32;pe<K;pe++)if(0!==W.dyn_ltree[2*pe])return 1;return 0}(he)),Me(he,he.l_desc),Me(he,he.d_desc),y=function(W){var pe;for(ce(W,W.dyn_ltree,W.l_desc.max_code),ce(W,W.dyn_dtree,W.d_desc.max_code),Me(W,W.bl_desc),pe=18;3<=pe&&0===W.bl_tree[2*L[pe]+1];pe--);return W.opt_len+=3*(pe+1)+5+5+4,pe}(he),(xe=he.static_len+3+7>>>3)<=(ue=he.opt_len+3+7>>>3)&&(ue=xe)):ue=xe=be+5,be+4<=ue&&-1!==Ie?ye(he,Ie,be,ae):4===he.strategy||xe===ue?(f(he,2+(ae?1:0),3),Ee(he,S,k)):(f(he,4+(ae?1:0),3),function(W,pe,we,De){var Le;for(f(W,pe-257,5),f(W,we-1,5),f(W,De-4,4),Le=0;Le<De;Le++)f(W,W.bl_tree[2*L[Le]+1],3);ke(W,W.dyn_ltree,pe-1),ke(W,W.dyn_dtree,we-1)}(he,he.l_desc.max_code+1,he.d_desc.max_code+1,y+1),Ee(he,he.dyn_ltree,he.dyn_dtree)),C(he),ae&&$(he)},d._tr_tally=function(he,Ie,be){return he.pending_buf[he.d_buf+2*he.last_lit]=Ie>>>8&255,he.pending_buf[he.d_buf+2*he.last_lit+1]=255&Ie,he.pending_buf[he.l_buf+he.last_lit]=255&be,he.last_lit++,0===Ie?he.dyn_ltree[2*be]++:(he.matches++,Ie--,he.dyn_ltree[2*(P[be]+K+1)]++,he.dyn_dtree[2*l(Ie)]++),he.last_lit===he.lit_bufsize-1},d._tr_align=function(he){var Ie;f(he,2,3),u(he,256,S),16===(Ie=he).bi_valid?(c(Ie,Ie.bi_buf),Ie.bi_buf=0,Ie.bi_valid=0):8<=Ie.bi_valid&&(Ie.pending_buf[Ie.pending++]=255&Ie.bi_buf,Ie.bi_buf>>=8,Ie.bi_valid-=8)}},{"../utils/common":41}],53:[function(le,me,d){"use strict";me.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(le,me,d){(function(H){!function(J,_){"use strict";if(!J.setImmediate){var x,O,w,K,G=1,A={},U=!1,N=J.document,Y=Object.getPrototypeOf&&Object.getPrototypeOf(J);Y=Y&&Y.setTimeout?Y:J,x="[object process]"==={}.toString.call(J.process)?function(z){process.nextTick(function(){j(z)})}:function(){if(J.postMessage&&!J.importScripts){var z=!0,q=J.onmessage;return J.onmessage=function(){z=!1},J.postMessage("","*"),J.onmessage=q,z}}()?(K="setImmediate$"+Math.random()+"$",J.addEventListener?J.addEventListener("message",oe,!1):J.attachEvent("onmessage",oe),function(z){J.postMessage(K+z,"*")}):J.MessageChannel?((w=new MessageChannel).port1.onmessage=function(z){j(z.data)},function(z){w.port2.postMessage(z)}):N&&"onreadystatechange"in N.createElement("script")?(O=N.documentElement,function(z){var q=N.createElement("script");q.onreadystatechange=function(){j(z),q.onreadystatechange=null,O.removeChild(q),q=null},O.appendChild(q)}):function(z){setTimeout(j,0,z)},Y.setImmediate=function(z){"function"!=typeof z&&(z=new Function(""+z));for(var q=new Array(arguments.length-1),X=0;X<q.length;X++)q[X]=arguments[X+1];return A[G]={callback:z,args:q},x(G),G++},Y.clearImmediate=T}function T(z){delete A[z]}function j(z){if(U)setTimeout(j,0,z);else{var q=A[z];if(q){U=!0;try{!function(X){var M=X.callback,I=X.args;switch(I.length){case 0:M();break;case 1:M(I[0]);break;case 2:M(I[0],I[1]);break;case 3:M(I[0],I[1],I[2]);break;default:M.apply(undefined,I)}}(q)}finally{T(z),U=!1}}}}function oe(z){z.source===J&&"string"==typeof z.data&&0===z.data.indexOf(K)&&j(+z.data.slice(K.length))}}(typeof self>"u"?void 0===H?this:H:self)}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)},4424:E=>{E.exports=function H(J,_,x){function O(G,A){if(!_[G]){if(!J[G]){if(w)return w(G,!0);var N=new Error("Cannot find module '"+G+"'");throw N.code="MODULE_NOT_FOUND",N}var Y=_[G]={exports:{}};J[G][0].call(Y.exports,function(T){return O(J[G][1][T]||T)},Y,Y.exports,H,J,_,x)}return _[G].exports}for(var w=void 0,K=0;K<x.length;K++)O(x[K]);return O}({1:[function(H,J,_){(function(x){"use strict";var w,O=x.MutationObserver||x.WebKitMutationObserver;if(O){var K=0,G=new O(T),A=x.document.createTextNode("");G.observe(A,{characterData:!0}),w=function(){A.data=K=++K%2}}else if(!x.setImmediate&&typeof x.MessageChannel<"u"){var U=new x.MessageChannel;U.port1.onmessage=T,w=function(){U.port2.postMessage(0)}}else w="document"in x&&"onreadystatechange"in x.document.createElement("script")?function(){var oe=x.document.createElement("script");oe.onreadystatechange=function(){T(),oe.onreadystatechange=null,oe.parentNode.removeChild(oe),oe=null},x.document.documentElement.appendChild(oe)}:function(){setTimeout(T,0)};var N,Y=[];function T(){N=!0;for(var oe,z,q=Y.length;q;){for(z=Y,Y=[],oe=-1;++oe<q;)z[oe]();q=Y.length}N=!1}J.exports=function j(oe){1===Y.push(oe)&&!N&&w()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(H,J,_){"use strict";var x=H(1);function O(){}var w={},K=["REJECTED"],G=["FULFILLED"],A=["PENDING"];function U(I){if("function"!=typeof I)throw new TypeError("resolver must be a function");this.state=A,this.queue=[],this.outcome=void 0,I!==O&&j(this,I)}function N(I,Q,L){this.promise=I,"function"==typeof Q&&(this.onFulfilled=Q,this.callFulfilled=this.otherCallFulfilled),"function"==typeof L&&(this.onRejected=L,this.callRejected=this.otherCallRejected)}function Y(I,Q,L){x(function(){var S;try{S=Q(L)}catch(k){return w.reject(I,k)}S===I?w.reject(I,new TypeError("Cannot resolve promise with itself")):w.resolve(I,S)})}function T(I){var Q=I&&I.then;if(I&&("object"==typeof I||"function"==typeof I)&&"function"==typeof Q)return function(){Q.apply(I,arguments)}}function j(I,Q){var L=!1;function S(B){L||(L=!0,w.reject(I,B))}function k(B){L||(L=!0,w.resolve(I,B))}var P=oe(function v(){Q(k,S)});"error"===P.status&&S(P.value)}function oe(I,Q){var L={};try{L.value=I(Q),L.status="success"}catch(S){L.status="error",L.value=S}return L}J.exports=U,U.prototype.catch=function(I){return this.then(null,I)},U.prototype.then=function(I,Q){if("function"!=typeof I&&this.state===G||"function"!=typeof Q&&this.state===K)return this;var L=new this.constructor(O);return this.state!==A?Y(L,this.state===G?I:Q,this.outcome):this.queue.push(new N(L,I,Q)),L},N.prototype.callFulfilled=function(I){w.resolve(this.promise,I)},N.prototype.otherCallFulfilled=function(I){Y(this.promise,this.onFulfilled,I)},N.prototype.callRejected=function(I){w.reject(this.promise,I)},N.prototype.otherCallRejected=function(I){Y(this.promise,this.onRejected,I)},w.resolve=function(I,Q){var L=oe(T,Q);if("error"===L.status)return w.reject(I,L.value);var S=L.value;if(S)j(I,S);else{I.state=G,I.outcome=Q;for(var k=-1,v=I.queue.length;++k<v;)I.queue[k].callFulfilled(Q)}return I},w.reject=function(I,Q){I.state=K,I.outcome=Q;for(var L=-1,S=I.queue.length;++L<S;)I.queue[L].callRejected(Q);return I},U.resolve=function z(I){return I instanceof this?I:w.resolve(new this(O),I)},U.reject=function q(I){var Q=new this(O);return w.reject(Q,I)},U.all=function X(I){var Q=this;if("[object Array]"!==Object.prototype.toString.call(I))return this.reject(new TypeError("must be an array"));var L=I.length,S=!1;if(!L)return this.resolve([]);for(var k=new Array(L),v=0,P=-1,B=new this(O);++P<L;)te(I[P],P);return B;function te(D,fe){Q.resolve(D).then(function R(F){k[fe]=F,++v===L&&!S&&(S=!0,w.resolve(B,k))},function(F){S||(S=!0,w.reject(B,F))})}},U.race=function M(I){var Q=this;if("[object Array]"!==Object.prototype.toString.call(I))return this.reject(new TypeError("must be an array"));var L=I.length,S=!1;if(!L)return this.resolve([]);for(var k=-1,v=new this(O);++k<L;)Q.resolve(I[k]).then(function(te){S||(S=!0,w.resolve(v,te))},function(te){S||(S=!0,w.reject(v,te))});return v}},{1:1}],3:[function(H,J,_){(function(x){"use strict";"function"!=typeof x.Promise&&(x.Promise=H(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(H,J,_){"use strict";var x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(Be){return typeof Be}:function(Be){return Be&&"function"==typeof Symbol&&Be.constructor===Symbol&&Be!==Symbol.prototype?"symbol":typeof Be};var K=function w(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function A(Be,Ke){Be=Be||[],Ke=Ke||{};try{return new Blob(Be,Ke)}catch(et){if("TypeError"!==et.name)throw et;for(var Qe=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),lt=0;lt<Be.length;lt+=1)Qe.append(Be[lt]);return Qe.getBlob(Ke.type)}}typeof Promise>"u"&&H(3);var U=Promise;function N(Be,Ke){Ke&&Be.then(function(qe){Ke(null,qe)},function(qe){Ke(qe)})}function Y(Be,Ke,qe){"function"==typeof Ke&&Be.then(Ke),"function"==typeof qe&&Be.catch(qe)}function T(Be){return"string"!=typeof Be&&(console.warn(Be+" used as a key, but it is not a string."),Be=String(Be)),Be}function j(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var oe="local-forage-detect-blob-support",z=void 0,q={},X=Object.prototype.toString,M="readonly",I="readwrite";function Q(Be){for(var Ke=Be.length,qe=new ArrayBuffer(Ke),Qe=new Uint8Array(qe),lt=0;lt<Ke;lt++)Qe[lt]=Be.charCodeAt(lt);return qe}function S(Be){return"boolean"==typeof z?U.resolve(z):function L(Be){return new U(function(Ke){var qe=Be.transaction(oe,I),Qe=A([""]);qe.objectStore(oe).put(Qe,"key"),qe.onabort=function(lt){lt.preventDefault(),lt.stopPropagation(),Ke(!1)},qe.oncomplete=function(){var lt=navigator.userAgent.match(/Chrome\/(\d+)/),et=navigator.userAgent.match(/Edge\//);Ke(et||!lt||parseInt(lt[1],10)>=43)}}).catch(function(){return!1})}(Be).then(function(Ke){return z=Ke})}function k(Be){var Ke=q[Be.name],qe={};qe.promise=new U(function(Qe,lt){qe.resolve=Qe,qe.reject=lt}),Ke.deferredOperations.push(qe),Ke.dbReady=Ke.dbReady?Ke.dbReady.then(function(){return qe.promise}):qe.promise}function v(Be){var qe=q[Be.name].deferredOperations.pop();if(qe)return qe.resolve(),qe.promise}function P(Be,Ke){var Qe=q[Be.name].deferredOperations.pop();if(Qe)return Qe.reject(Ke),Qe.promise}function B(Be,Ke){return new U(function(qe,Qe){if(q[Be.name]=q[Be.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},Be.db){if(!Ke)return qe(Be.db);k(Be),Be.db.close()}var lt=[Be.name];Ke&&lt.push(Be.version);var et=K.open.apply(K,lt);Ke&&(et.onupgradeneeded=function(bt){var $t=et.result;try{$t.createObjectStore(Be.storeName),bt.oldVersion<=1&&$t.createObjectStore(oe)}catch(Rt){if("ConstraintError"!==Rt.name)throw Rt;console.warn('The database "'+Be.name+'" has been upgraded from version '+bt.oldVersion+" to version "+bt.newVersion+', but the storage "'+Be.storeName+'" already exists.')}}),et.onerror=function(bt){bt.preventDefault(),Qe(et.error)},et.onsuccess=function(){var bt=et.result;bt.onversionchange=function($t){$t.target.close()},qe(bt),v(Be)}})}function te(Be){return B(Be,!1)}function D(Be){return B(Be,!0)}function fe(Be,Ke){if(!Be.db)return!0;var qe=!Be.db.objectStoreNames.contains(Be.storeName),lt=Be.version>Be.db.version;if(Be.version<Be.db.version&&(Be.version!==Ke&&console.warn('The database "'+Be.name+"\" can't be downgraded from version "+Be.db.version+" to version "+Be.version+"."),Be.version=Be.db.version),lt||qe){if(qe){var et=Be.db.version+1;et>Be.version&&(Be.version=et)}return!0}return!1}function F(Be){return A([Q(atob(Be.data))],{type:Be.type})}function g(Be){return Be&&Be.__local_forage_encoded_blob}function l(Be){var Ke=this,qe=Ke._initReady().then(function(){var Qe=q[Ke._dbInfo.name];if(Qe&&Qe.dbReady)return Qe.dbReady});return Y(qe,Be,Be),qe}function f(Be,Ke,qe,Qe){void 0===Qe&&(Qe=1);try{var lt=Be.db.transaction(Be.storeName,Ke);qe(null,lt)}catch(et){if(Qe>0&&(!Be.db||"InvalidStateError"===et.name||"NotFoundError"===et.name))return U.resolve().then(function(){if(!Be.db||"NotFoundError"===et.name&&!Be.db.objectStoreNames.contains(Be.storeName)&&Be.version<=Be.db.version)return Be.db&&(Be.version=Be.db.version+1),D(Be)}).then(function(){return function c(Be){k(Be);for(var Ke=q[Be.name],qe=Ke.forages,Qe=0;Qe<qe.length;Qe++){var lt=qe[Qe];lt._dbInfo.db&&(lt._dbInfo.db.close(),lt._dbInfo.db=null)}return Be.db=null,te(Be).then(function(et){return Be.db=et,fe(Be)?D(Be):et}).then(function(et){Be.db=Ke.db=et;for(var bt=0;bt<qe.length;bt++)qe[bt]._dbInfo.db=et}).catch(function(et){throw P(Be,et),et})}(Be).then(function(){f(Be,Ke,qe,Qe-1)})}).catch(qe);qe(et)}}var ve={_driver:"asyncStorage",_initStorage:function p(Be){var Ke=this,qe={db:null};if(Be)for(var Qe in Be)qe[Qe]=Be[Qe];var lt=q[qe.name];lt||(q[qe.name]=lt={forages:[],db:null,dbReady:null,deferredOperations:[]}),lt.forages.push(Ke),Ke._initReady||(Ke._initReady=Ke.ready,Ke.ready=l);var et=[];function bt(){return U.resolve()}for(var $t=0;$t<lt.forages.length;$t++){var Rt=lt.forages[$t];Rt!==Ke&&et.push(Rt._initReady().catch(bt))}var Bt=lt.forages.slice(0);return U.all(et).then(function(){return qe.db=lt.db,te(qe)}).then(function(nt){return qe.db=nt,fe(qe,Ke._defaultConfig.version)?D(qe):nt}).then(function(nt){qe.db=lt.db=nt,Ke._dbInfo=qe;for(var Xt=0;Xt<Bt.length;Xt++){var Vt=Bt[Xt];Vt!==Ke&&(Vt._dbInfo.db=qe.db,Vt._dbInfo.version=qe.version)}})},_support:function G(){try{if(!K||!K.open)return!1;var Be=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),Ke="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!Be||Ke)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function C(Be,Ke){var qe=this,Qe=new U(function(lt,et){qe.ready().then(function(){f(qe._dbInfo,M,function(bt,$t){if(bt)return et(bt);try{var Bt=$t.objectStore(qe._dbInfo.storeName).openCursor(),nt=1;Bt.onsuccess=function(){var Xt=Bt.result;if(Xt){var Vt=Xt.value;g(Vt)&&(Vt=F(Vt));var nn=Be(Vt,Xt.key,nt++);void 0!==nn?lt(nn):Xt.continue()}else lt()},Bt.onerror=function(){et(Bt.error)}}catch(Xt){et(Xt)}})}).catch(et)});return N(Qe,Ke),Qe},getItem:function m(Be,Ke){var qe=this;Be=T(Be);var Qe=new U(function(lt,et){qe.ready().then(function(){f(qe._dbInfo,M,function(bt,$t){if(bt)return et(bt);try{var Bt=$t.objectStore(qe._dbInfo.storeName).get(Be);Bt.onsuccess=function(){var nt=Bt.result;void 0===nt&&(nt=null),g(nt)&&(nt=F(nt)),lt(nt)},Bt.onerror=function(){et(Bt.error)}}catch(nt){et(nt)}})}).catch(et)});return N(Qe,Ke),Qe},setItem:function $(Be,Ke,qe){var Qe=this;Be=T(Be);var lt=new U(function(et,bt){var $t;Qe.ready().then(function(){return $t=Qe._dbInfo,"[object Blob]"===X.call(Ke)?S($t.db).then(function(Rt){return Rt?Ke:function R(Be){return new U(function(Ke,qe){var Qe=new FileReader;Qe.onerror=qe,Qe.onloadend=function(lt){var et=btoa(lt.target.result||"");Ke({__local_forage_encoded_blob:!0,data:et,type:Be.type})},Qe.readAsBinaryString(Be)})}(Ke)}):Ke}).then(function(Rt){f(Qe._dbInfo,I,function(Bt,nt){if(Bt)return bt(Bt);try{var Xt=nt.objectStore(Qe._dbInfo.storeName);null===Rt&&(Rt=void 0);var Vt=Xt.put(Rt,Be);nt.oncomplete=function(){void 0===Rt&&(Rt=null),et(Rt)},nt.onabort=nt.onerror=function(){bt(Vt.error?Vt.error:Vt.transaction.error)}}catch(nn){bt(nn)}})}).catch(bt)});return N(lt,qe),lt},removeItem:function re(Be,Ke){var qe=this;Be=T(Be);var Qe=new U(function(lt,et){qe.ready().then(function(){f(qe._dbInfo,I,function(bt,$t){if(bt)return et(bt);try{var Bt=$t.objectStore(qe._dbInfo.storeName).delete(Be);$t.oncomplete=function(){lt()},$t.onerror=function(){et(Bt.error)},$t.onabort=function(){et(Bt.error?Bt.error:Bt.transaction.error)}}catch(nt){et(nt)}})}).catch(et)});return N(Qe,Ke),Qe},clear:function se(Be){var Ke=this,qe=new U(function(Qe,lt){Ke.ready().then(function(){f(Ke._dbInfo,I,function(et,bt){if(et)return lt(et);try{var Rt=bt.objectStore(Ke._dbInfo.storeName).clear();bt.oncomplete=function(){Qe()},bt.onabort=bt.onerror=function(){lt(Rt.error?Rt.error:Rt.transaction.error)}}catch(Bt){lt(Bt)}})}).catch(lt)});return N(qe,Be),qe},length:function Ee(Be){var Ke=this,qe=new U(function(Qe,lt){Ke.ready().then(function(){f(Ke._dbInfo,M,function(et,bt){if(et)return lt(et);try{var Rt=bt.objectStore(Ke._dbInfo.storeName).count();Rt.onsuccess=function(){Qe(Rt.result)},Rt.onerror=function(){lt(Rt.error)}}catch(Bt){lt(Bt)}})}).catch(lt)});return N(qe,Be),qe},key:function Me(Be,Ke){var qe=this,Qe=new U(function(lt,et){Be<0?lt(null):qe.ready().then(function(){f(qe._dbInfo,M,function(bt,$t){if(bt)return et(bt);try{var Rt=$t.objectStore(qe._dbInfo.storeName),Bt=!1,nt=Rt.openKeyCursor();nt.onsuccess=function(){var Xt=nt.result;Xt?0===Be||Bt?lt(Xt.key):(Bt=!0,Xt.advance(Be)):lt(null)},nt.onerror=function(){et(nt.error)}}catch(Xt){et(Xt)}})}).catch(et)});return N(Qe,Ke),Qe},keys:function ce(Be){var Ke=this,qe=new U(function(Qe,lt){Ke.ready().then(function(){f(Ke._dbInfo,M,function(et,bt){if(et)return lt(et);try{var Rt=bt.objectStore(Ke._dbInfo.storeName).openKeyCursor(),Bt=[];Rt.onsuccess=function(){var nt=Rt.result;nt?(Bt.push(nt.key),nt.continue()):Qe(Bt)},Rt.onerror=function(){lt(Rt.error)}}catch(nt){lt(nt)}})}).catch(lt)});return N(qe,Be),qe},dropInstance:function ke(Be,Ke){Ke=j.apply(this,arguments);var qe=this.config();(Be="function"!=typeof Be&&Be||{}).name||(Be.name=Be.name||qe.name,Be.storeName=Be.storeName||qe.storeName);var lt,Qe=this;if(Be.name){var bt=Be.name===qe.name&&Qe._dbInfo.db?U.resolve(Qe._dbInfo.db):te(Be).then(function($t){var Rt=q[Be.name],Bt=Rt.forages;Rt.db=$t;for(var nt=0;nt<Bt.length;nt++)Bt[nt]._dbInfo.db=$t;return $t});lt=bt.then(Be.storeName?function($t){if($t.objectStoreNames.contains(Be.storeName)){var Rt=$t.version+1;k(Be);var Bt=q[Be.name],nt=Bt.forages;$t.close();for(var Xt=0;Xt<nt.length;Xt++){var Vt=nt[Xt];Vt._dbInfo.db=null,Vt._dbInfo.version=Rt}return new U(function(ri,Oe){var ze=K.open(Be.name,Rt);ze.onerror=function(Ze){ze.result.close(),Oe(Ze)},ze.onupgradeneeded=function(){ze.result.deleteObjectStore(Be.storeName)},ze.onsuccess=function(){var Ze=ze.result;Ze.close(),ri(Ze)}}).then(function(ri){Bt.db=ri;for(var Oe=0;Oe<nt.length;Oe++){var ze=nt[Oe];ze._dbInfo.db=ri,v(ze._dbInfo)}}).catch(function(ri){throw(P(Be,ri)||U.resolve()).catch(function(){}),ri})}}:function($t){k(Be);var Rt=q[Be.name],Bt=Rt.forages;$t.close();for(var nt=0;nt<Bt.length;nt++)Bt[nt]._dbInfo.db=null;return new U(function(nn,ri){var Oe=K.deleteDatabase(Be.name);Oe.onerror=function(){var ze=Oe.result;ze&&ze.close(),ri(Oe.error)},Oe.onblocked=function(){console.warn('dropInstance blocked for database "'+Be.name+'" until all open connections are closed')},Oe.onsuccess=function(){var ze=Oe.result;ze&&ze.close(),nn(ze)}}).then(function(nn){Rt.db=nn;for(var ri=0;ri<Bt.length;ri++)v(Bt[ri]._dbInfo)}).catch(function(nn){throw(P(Be,nn)||U.resolve()).catch(function(){}),nn})})}else lt=U.reject("Invalid arguments");return N(lt,Ke),lt}};var he="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",be=/^~~local_forage_type~([^~]+)~/,ae="__lfsc__:",ue=ae.length,xe="arbf",y="blob",W="si08",un=ue+xe.length,tn=Object.prototype.toString;function On(Be){var Qe,et,bt,$t,Rt,Ke=.75*Be.length,qe=Be.length,lt=0;"="===Be[Be.length-1]&&(Ke--,"="===Be[Be.length-2]&&Ke--);var Bt=new ArrayBuffer(Ke),nt=new Uint8Array(Bt);for(Qe=0;Qe<qe;Qe+=4)et=he.indexOf(Be[Qe]),bt=he.indexOf(Be[Qe+1]),$t=he.indexOf(Be[Qe+2]),Rt=he.indexOf(Be[Qe+3]),nt[lt++]=et<<2|bt>>4,nt[lt++]=(15&bt)<<4|$t>>2,nt[lt++]=(3&$t)<<6|63&Rt;return Bt}function Mn(Be){var Qe,Ke=new Uint8Array(Be),qe="";for(Qe=0;Qe<Ke.length;Qe+=3)qe+=he[Ke[Qe]>>2],qe+=he[(3&Ke[Qe])<<4|Ke[Qe+1]>>4],qe+=he[(15&Ke[Qe+1])<<2|Ke[Qe+2]>>6],qe+=he[63&Ke[Qe+2]];return Ke.length%3==2?qe=qe.substring(0,qe.length-1)+"=":Ke.length%3==1&&(qe=qe.substring(0,qe.length-2)+"=="),qe}var ja={serialize:function yr(Be,Ke){var qe="";if(Be&&(qe=tn.call(Be)),Be&&("[object ArrayBuffer]"===qe||Be.buffer&&"[object ArrayBuffer]"===tn.call(Be.buffer))){var Qe,lt=ae;Be instanceof ArrayBuffer?(Qe=Be,lt+=xe):(Qe=Be.buffer,"[object Int8Array]"===qe?lt+=W:"[object Uint8Array]"===qe?lt+="ui08":"[object Uint8ClampedArray]"===qe?lt+="uic8":"[object Int16Array]"===qe?lt+="si16":"[object Uint16Array]"===qe?lt+="ur16":"[object Int32Array]"===qe?lt+="si32":"[object Uint32Array]"===qe?lt+="ui32":"[object Float32Array]"===qe?lt+="fl32":"[object Float64Array]"===qe?lt+="fl64":Ke(new Error("Failed to get type for BinaryArray"))),Ke(lt+Mn(Qe))}else if("[object Blob]"===qe){var et=new FileReader;et.onload=function(){var bt="~~local_forage_type~"+Be.type+"~"+Mn(this.result);Ke(ae+y+bt)},et.readAsArrayBuffer(Be)}else try{Ke(JSON.stringify(Be))}catch(bt){console.error("Couldn't convert value into a JSON string: ",Be),Ke(null,bt)}},deserialize:function fa(Be){if(Be.substring(0,ue)!==ae)return JSON.parse(Be);var Qe,Ke=Be.substring(un),qe=Be.substring(ue,un);if(qe===y&&be.test(Ke)){var lt=Ke.match(be);Qe=lt[1],Ke=Ke.substring(lt[0].length)}var et=On(Ke);switch(qe){case xe:return et;case y:return A([et],{type:Qe});case W:return new Int8Array(et);case"ui08":return new Uint8Array(et);case"uic8":return new Uint8ClampedArray(et);case"si16":return new Int16Array(et);case"ur16":return new Uint16Array(et);case"si32":return new Int32Array(et);case"ui32":return new Uint32Array(et);case"fl32":return new Float32Array(et);case"fl64":return new Float64Array(et);default:throw new Error("Unkown type: "+qe)}},stringToBuffer:On,bufferToString:Mn};function Ua(Be,Ke,qe,Qe){Be.executeSql("CREATE TABLE IF NOT EXISTS "+Ke.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],qe,Qe)}function sr(Be,Ke,qe,Qe,lt,et){Be.executeSql(qe,Qe,lt,function(bt,$t){$t.code===$t.SYNTAX_ERR?bt.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[Ke.storeName],function(Rt,Bt){Bt.rows.length?et(Rt,$t):Ua(Rt,Ke,function(){Rt.executeSql(qe,Qe,lt,et)},et)},et):et(bt,$t)},et)}function Ha(Be,Ke,qe,Qe){var lt=this;Be=T(Be);var et=new U(function(bt,$t){lt.ready().then(function(){void 0===Ke&&(Ke=null);var Rt=Ke,Bt=lt._dbInfo;Bt.serializer.serialize(Ke,function(nt,Xt){Xt?$t(Xt):Bt.db.transaction(function(Vt){sr(Vt,Bt,"INSERT OR REPLACE INTO "+Bt.storeName+" (key, value) VALUES (?, ?)",[Be,nt],function(){bt(Rt)},function(nn,ri){$t(ri)})},function(Vt){if(Vt.code===Vt.QUOTA_ERR){if(Qe>0)return void bt(Ha.apply(lt,[Be,Rt,qe,Qe-1]));$t(Vt)}})})}).catch($t)});return N(et,qe),et}function Cr(Be){return new U(function(Ke,qe){Be.transaction(function(Qe){Qe.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(lt,et){for(var bt=[],$t=0;$t<et.rows.length;$t++)bt.push(et.rows.item($t).name);Ke({db:Be,storeNames:bt})},function(lt,et){qe(et)})},function(Qe){qe(Qe)})})}var Ga={_driver:"webSQLStorage",_initStorage:function wo(Be){var Ke=this,qe={db:null};if(Be)for(var Qe in Be)qe[Qe]="string"!=typeof Be[Qe]?Be[Qe].toString():Be[Qe];var lt=new U(function(et,bt){try{qe.db=openDatabase(qe.name,String(qe.version),qe.description,qe.size)}catch($t){return bt($t)}qe.db.transaction(function($t){Ua($t,qe,function(){Ke._dbInfo=qe,et()},function(Rt,Bt){bt(Bt)})},bt)});return qe.serializer=ja,lt},_support:function ye(){return"function"==typeof openDatabase}(),iterate:function kl(Be,Ke){var qe=this,Qe=new U(function(lt,et){qe.ready().then(function(){var bt=qe._dbInfo;bt.db.transaction(function($t){sr($t,bt,"SELECT * FROM "+bt.storeName,[],function(Rt,Bt){for(var nt=Bt.rows,Xt=nt.length,Vt=0;Vt<Xt;Vt++){var nn=nt.item(Vt),ri=nn.value;if(ri&&(ri=bt.serializer.deserialize(ri)),void 0!==(ri=Be(ri,nn.key,Vt+1)))return void lt(ri)}lt()},function(Rt,Bt){et(Bt)})})}).catch(et)});return N(Qe,Ke),Qe},getItem:function kc(Be,Ke){var qe=this;Be=T(Be);var Qe=new U(function(lt,et){qe.ready().then(function(){var bt=qe._dbInfo;bt.db.transaction(function($t){sr($t,bt,"SELECT * FROM "+bt.storeName+" WHERE key = ? LIMIT 1",[Be],function(Rt,Bt){var nt=Bt.rows.length?Bt.rows.item(0).value:null;nt&&(nt=bt.serializer.deserialize(nt)),lt(nt)},function(Rt,Bt){et(Bt)})})}).catch(et)});return N(Qe,Ke),Qe},setItem:function Va(Be,Ke,qe){return Ha.apply(this,[Be,Ke,qe,1])},removeItem:function ed(Be,Ke){var qe=this;Be=T(Be);var Qe=new U(function(lt,et){qe.ready().then(function(){var bt=qe._dbInfo;bt.db.transaction(function($t){sr($t,bt,"DELETE FROM "+bt.storeName+" WHERE key = ?",[Be],function(){lt()},function(Rt,Bt){et(Bt)})})}).catch(et)});return N(Qe,Ke),Qe},clear:function Dc(Be){var Ke=this,qe=new U(function(Qe,lt){Ke.ready().then(function(){var et=Ke._dbInfo;et.db.transaction(function(bt){sr(bt,et,"DELETE FROM "+et.storeName,[],function(){Qe()},function($t,Rt){lt(Rt)})})}).catch(lt)});return N(qe,Be),qe},length:function Ac(Be){var Ke=this,qe=new U(function(Qe,lt){Ke.ready().then(function(){var et=Ke._dbInfo;et.db.transaction(function(bt){sr(bt,et,"SELECT COUNT(key) as c FROM "+et.storeName,[],function($t,Rt){var Bt=Rt.rows.item(0).c;Qe(Bt)},function($t,Rt){lt(Rt)})})}).catch(lt)});return N(qe,Be),qe},key:function Dl(Be,Ke){var qe=this,Qe=new U(function(lt,et){qe.ready().then(function(){var bt=qe._dbInfo;bt.db.transaction(function($t){sr($t,bt,"SELECT key FROM "+bt.storeName+" WHERE id = ? LIMIT 1",[Be+1],function(Rt,Bt){var nt=Bt.rows.length?Bt.rows.item(0).key:null;lt(nt)},function(Rt,Bt){et(Bt)})})}).catch(et)});return N(Qe,Ke),Qe},keys:function Pc(Be){var Ke=this,qe=new U(function(Qe,lt){Ke.ready().then(function(){var et=Ke._dbInfo;et.db.transaction(function(bt){sr(bt,et,"SELECT key FROM "+et.storeName,[],function($t,Rt){for(var Bt=[],nt=0;nt<Rt.rows.length;nt++)Bt.push(Rt.rows.item(nt).key);Qe(Bt)},function($t,Rt){lt(Rt)})})}).catch(lt)});return N(qe,Be),qe},dropInstance:function td(Be,Ke){Ke=j.apply(this,arguments);var qe=this.config();(Be="function"!=typeof Be&&Be||{}).name||(Be.name=Be.name||qe.name,Be.storeName=Be.storeName||qe.storeName);var lt,Qe=this;return N(lt=Be.name?new U(function(et){var bt;bt=Be.name===qe.name?Qe._dbInfo.db:openDatabase(Be.name,"","",0),et(Be.storeName?{db:bt,storeNames:[Be.storeName]}:Cr(bt))}).then(function(et){return new U(function(bt,$t){et.db.transaction(function(Rt){function Bt(nn){return new U(function(ri,Oe){Rt.executeSql("DROP TABLE IF EXISTS "+nn,[],function(){ri()},function(ze,Ze){Oe(Ze)})})}for(var nt=[],Xt=0,Vt=et.storeNames.length;Xt<Vt;Xt++)nt.push(Bt(et.storeNames[Xt]));U.all(nt).then(function(){bt()}).catch(function(nn){$t(nn)})},function(Rt){$t(Rt)})})}):U.reject("Invalid arguments"),Ke),lt}};function Nc(Be,Ke){var qe=Be.name+"/";return Be.storeName!==Ke.storeName&&(qe+=Be.storeName+"/"),qe}function Pl(){return!function Al(){var Be="_localforage_support_test";try{return localStorage.setItem(Be,!0),localStorage.removeItem(Be),!1}catch{return!0}}()||localStorage.length>0}var Wo={_driver:"localStorageWrapper",_initStorage:function id(Be){var qe={};if(Be)for(var Qe in Be)qe[Qe]=Be[Qe];return qe.keyPrefix=Nc(Be,this._defaultConfig),Pl()?(this._dbInfo=qe,qe.serializer=ja,U.resolve()):U.reject()},_support:function nd(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function Ls(Be,Ke){var qe=this,Qe=qe.ready().then(function(){for(var lt=qe._dbInfo,et=lt.keyPrefix,bt=et.length,$t=localStorage.length,Rt=1,Bt=0;Bt<$t;Bt++){var nt=localStorage.key(Bt);if(0===nt.indexOf(et)){var Xt=localStorage.getItem(nt);if(Xt&&(Xt=lt.serializer.deserialize(Xt)),void 0!==(Xt=Be(Xt,nt.substring(bt),Rt++)))return Xt}}});return N(Qe,Ke),Qe},getItem:function rd(Be,Ke){var qe=this;Be=T(Be);var Qe=qe.ready().then(function(){var lt=qe._dbInfo,et=localStorage.getItem(lt.keyPrefix+Be);return et&&(et=lt.serializer.deserialize(et)),et});return N(Qe,Ke),Qe},setItem:function qo(Be,Ke,qe){var Qe=this;Be=T(Be);var lt=Qe.ready().then(function(){void 0===Ke&&(Ke=null);var et=Ke;return new U(function(bt,$t){var Rt=Qe._dbInfo;Rt.serializer.serialize(Ke,function(Bt,nt){if(nt)$t(nt);else try{localStorage.setItem(Rt.keyPrefix+Be,Bt),bt(et)}catch(Xt){("QuotaExceededError"===Xt.name||"NS_ERROR_DOM_QUOTA_REACHED"===Xt.name)&&$t(Xt),$t(Xt)}})})});return N(lt,qe),lt},removeItem:function Ol(Be,Ke){var qe=this;Be=T(Be);var Qe=qe.ready().then(function(){localStorage.removeItem(qe._dbInfo.keyPrefix+Be)});return N(Qe,Ke),Qe},clear:function fo(Be){var Ke=this,qe=Ke.ready().then(function(){for(var Qe=Ke._dbInfo.keyPrefix,lt=localStorage.length-1;lt>=0;lt--){var et=localStorage.key(lt);0===et.indexOf(Qe)&&localStorage.removeItem(et)}});return N(qe,Be),qe},length:function od(Be){var qe=this.keys().then(function(Qe){return Qe.length});return N(qe,Be),qe},key:function Nl(Be,Ke){var qe=this,Qe=qe.ready().then(function(){var et,lt=qe._dbInfo;try{et=localStorage.key(Be)}catch{et=null}return et&&(et=et.substring(lt.keyPrefix.length)),et});return N(Qe,Ke),Qe},keys:function qa(Be){var Ke=this,qe=Ke.ready().then(function(){for(var Qe=Ke._dbInfo,lt=localStorage.length,et=[],bt=0;bt<lt;bt++){var $t=localStorage.key(bt);0===$t.indexOf(Qe.keyPrefix)&&et.push($t.substring(Qe.keyPrefix.length))}return et});return N(qe,Be),qe},dropInstance:function ms(Be,Ke){if(Ke=j.apply(this,arguments),!(Be="function"!=typeof Be&&Be||{}).name){var qe=this.config();Be.name=Be.name||qe.name,Be.storeName=Be.storeName||qe.storeName}var lt,Qe=this;return N(lt=Be.name?new U(function(et){et(Be.storeName?Nc(Be,Qe._defaultConfig):Be.name+"/")}).then(function(et){for(var bt=localStorage.length-1;bt>=0;bt--){var $t=localStorage.key(bt);0===$t.indexOf(et)&&localStorage.removeItem($t)}}):U.reject("Invalid arguments"),Ke),lt}},Ko=function(Ke,qe){return Ke===qe||"number"==typeof Ke&&"number"==typeof qe&&isNaN(Ke)&&isNaN(qe)},Fl=function(Ke,qe){for(var Qe=Ke.length,lt=0;lt<Qe;){if(Ko(Ke[lt],qe))return!0;lt++}return!1},Rl=Array.isArray||function(Be){return"[object Array]"===Object.prototype.toString.call(Be)},Bs={},ha={},Wi={INDEXEDDB:ve,WEBSQL:Ga,LOCALSTORAGE:Wo},zs=[Wi.INDEXEDDB._driver,Wi.WEBSQL._driver,Wi.LOCALSTORAGE._driver],Zr=["dropInstance"],Nr=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Zr),pa={description:"",driver:zs.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function ho(Be,Ke){Be[Ke]=function(){var qe=arguments;return Be.ready().then(function(){return Be[Ke].apply(Be,qe)})}}function Ji(){for(var Be=1;Be<arguments.length;Be++){var Ke=arguments[Be];if(Ke)for(var qe in Ke)Ke.hasOwnProperty(qe)&&(arguments[0][qe]=Rl(Ke[qe])?Ke[qe].slice():Ke[qe])}return arguments[0]}var ga=function(){function Be(Ke){for(var qe in function O(Be,Ke){if(!(Be instanceof Ke))throw new TypeError("Cannot call a class as a function")}(this,Be),Wi)if(Wi.hasOwnProperty(qe)){var Qe=Wi[qe],lt=Qe._driver;this[qe]=lt,Bs[lt]||this.defineDriver(Qe)}this._defaultConfig=Ji({},pa),this._config=Ji({},this._defaultConfig,Ke),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return Be.prototype.config=function(qe){if("object"===(typeof qe>"u"?"undefined":x(qe))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var Qe in qe){if("storeName"===Qe&&(qe[Qe]=qe[Qe].replace(/\W/g,"_")),"version"===Qe&&"number"!=typeof qe[Qe])return new Error("Database version must be a number.");this._config[Qe]=qe[Qe]}return!("driver"in qe)||!qe.driver||this.setDriver(this._config.driver)}return"string"==typeof qe?this._config[qe]:this._config},Be.prototype.defineDriver=function(qe,Qe,lt){var et=new U(function(bt,$t){try{var Rt=qe._driver,Bt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!qe._driver)return void $t(Bt);for(var nt=Nr.concat("_initStorage"),Xt=0,Vt=nt.length;Xt<Vt;Xt++){var nn=nt[Xt];if((!Fl(Zr,nn)||qe[nn])&&"function"!=typeof qe[nn])return void $t(Bt)}!function(){for(var ft=function(er){return function(){var xr=new Error("Method "+er+" is not implemented by the current driver"),po=U.reject(xr);return N(po,arguments[arguments.length-1]),po}},Ft=0,Yt=Zr.length;Ft<Yt;Ft++){var Bn=Zr[Ft];qe[Bn]||(qe[Bn]=ft(Bn))}}();var ze=function(ft){Bs[Rt]&&console.info("Redefining LocalForage driver: "+Rt),Bs[Rt]=qe,ha[Rt]=ft,bt()};"_support"in qe?qe._support&&"function"==typeof qe._support?qe._support().then(ze,$t):ze(!!qe._support):ze(!0)}catch(Ze){$t(Ze)}});return Y(et,Qe,lt),et},Be.prototype.driver=function(){return this._driver||null},Be.prototype.getDriver=function(qe,Qe,lt){var et=Bs[qe]?U.resolve(Bs[qe]):U.reject(new Error("Driver not found."));return Y(et,Qe,lt),et},Be.prototype.getSerializer=function(qe){var Qe=U.resolve(ja);return Y(Qe,qe),Qe},Be.prototype.ready=function(qe){var Qe=this,lt=Qe._driverSet.then(function(){return null===Qe._ready&&(Qe._ready=Qe._initDriver()),Qe._ready});return Y(lt,qe,qe),lt},Be.prototype.setDriver=function(qe,Qe,lt){var et=this;Rl(qe)||(qe=[qe]);var bt=this._getSupportedDrivers(qe);function $t(){et._config.driver=et.driver()}function Rt(Xt){return et._extend(Xt),$t(),et._ready=et._initStorage(et._config),et._ready}var nt=null!==this._driverSet?this._driverSet.catch(function(){return U.resolve()}):U.resolve();return this._driverSet=nt.then(function(){var Xt=bt[0];return et._dbInfo=null,et._ready=null,et.getDriver(Xt).then(function(Vt){et._driver=Vt._driver,$t(),et._wrapLibraryMethodsWithReady(),et._initDriver=function Bt(Xt){return function(){var Vt=0;return function nn(){for(;Vt<Xt.length;){var ri=Xt[Vt];return Vt++,et._dbInfo=null,et._ready=null,et.getDriver(ri).then(Rt).catch(nn)}$t();var Oe=new Error("No available storage method found.");return et._driverSet=U.reject(Oe),et._driverSet}()}}(bt)})}).catch(function(){$t();var Xt=new Error("No available storage method found.");return et._driverSet=U.reject(Xt),et._driverSet}),Y(this._driverSet,Qe,lt),this._driverSet},Be.prototype.supports=function(qe){return!!ha[qe]},Be.prototype._extend=function(qe){Ji(this,qe)},Be.prototype._getSupportedDrivers=function(qe){for(var Qe=[],lt=0,et=qe.length;lt<et;lt++){var bt=qe[lt];this.supports(bt)&&Qe.push(bt)}return Qe},Be.prototype._wrapLibraryMethodsWithReady=function(){for(var qe=0,Qe=Nr.length;qe<Qe;qe++)ho(this,Nr[qe])},Be.prototype.createInstance=function(qe){return new Be(qe)},Be}(),Oc=new ga;J.exports=Oc},{3:3}]},{},[4])(4)},9263:(E,le,me)=>{var d=me(9209),H=me(966);function J(_){this._init(_)}J.prototype={_init:function(_){_=_||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=_.onData,this._onEndCallback=_.onEnd},_createTable:function(){for(var _=H.createBuffer(8,d.TABLE_LENGTH),x=0;x<d.TABLE_LENGTH;x++)_[x]=d.BASE62TABLE.charCodeAt(x);return _},_onData:function(_,x){var O=H.bufferToString_fast(_,x);this._onDataCallback?this._onDataCallback(O):this._result+=O},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var _=2,x=this._data,O=this._offset,w=d.BUFFER_MAX;if(this._dataLen-O<w&&(w=this._dataLen-O),_>w)return!1;var U,N,Y,T,j,K=O-d.WINDOW_BUFFER_MAX,G=x.substring(K,O+w),A=O+_-3-K;do{if(2===_){if(N=x.charAt(O)+x.charAt(O+1),!~(Y=G.indexOf(N))||Y>A)break}else 3===_?N+=x.charAt(O+2):N=x.substr(O,_);if(!~(T=d.STRING_LASTINDEXOF_BUG?x.substring(K,O+_-1).lastIndexOf(N):G.lastIndexOf(N,A)))break;j=T,U=K+T;do{if(x.charCodeAt(O+_)!==x.charCodeAt(U+_))break}while(++_<w);if(Y===T){_++;break}}while(++_<w);return 2!==_&&(this._index=d.WINDOW_BUFFER_MAX-j,this._length=_-1,!0)},compress:function(_){if(null==_||0===_.length)return"";var x,O=this._createTable(),w=H.createWindow(),K=H.createBuffer(8,d.COMPRESS_CHUNK_SIZE),G=0;this._result="",this._offset=w.length,this._data=w+_,this._dataLen=this._data.length,w=_=null;for(var N,Y,T,j,oe,A=-1,U=-1;this._offset<this._dataLen;)this._search()?(this._index<d.BUFFER_MAX?(Y=this._index,T=0):T=(this._index-(Y=this._index%d.BUFFER_MAX))/d.BUFFER_MAX,2===this._length?(K[G++]=O[T+d.COMPRESS_FIXED_START],K[G++]=O[Y]):(K[G++]=O[T+d.COMPRESS_START],K[G++]=O[Y],K[G++]=O[this._length]),this._offset+=this._length,~U&&(U=-1)):(N=this._data.charCodeAt(this._offset++))<d.LATIN_BUFFER_MAX?(N<d.UNICODE_CHAR_MAX?(Y=N,T=0,A=d.LATIN_INDEX):A=(T=(N-(Y=N%d.UNICODE_CHAR_MAX))/d.UNICODE_CHAR_MAX)+d.LATIN_INDEX,U===A?K[G++]=O[Y]:(K[G++]=O[A-d.LATIN_INDEX_START],K[G++]=O[Y],U=A)):(N<d.UNICODE_BUFFER_MAX?(Y=N,T=0,A=d.UNICODE_INDEX):A=(T=(N-(Y=N%d.UNICODE_BUFFER_MAX))/d.UNICODE_BUFFER_MAX)+d.UNICODE_INDEX,Y<d.UNICODE_CHAR_MAX?(j=Y,oe=0):oe=(Y-(j=Y%d.UNICODE_CHAR_MAX))/d.UNICODE_CHAR_MAX,U===A?(K[G++]=O[j],K[G++]=O[oe]):(K[G++]=O[d.CHAR_START],K[G++]=O[A-d.TABLE_LENGTH],K[G++]=O[j],K[G++]=O[oe],U=A)),G>=d.COMPRESS_CHUNK_MAX&&(this._onData(K,G),G=0);return G>0&&this._onData(K,G),this._onEnd(),x=this._result,this._result=null,null===x?"":x}},E.exports=J},9209:(E,le)=>{var me=le.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",d=!1,H=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(d=!0)}catch{}if(me)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(H=!0)}catch{}le.CAN_CHARCODE_APPLY=d,le.CAN_CHARCODE_APPLY_TYPED=H;var J=le.APPLY_BUFFER_SIZE=65533;le.APPLY_BUFFER_SIZE_OK=null;var _=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(_=!0),le.STRING_LASTINDEXOF_BUG=_;var x=le.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",O=le.TABLE_LENGTH=x.length,w=Math.max(O,62)-Math.min(O,62);le.BUFFER_MAX=O-1;var K=le.WINDOW_MAX=1024;le.WINDOW_BUFFER_MAX=304;var G=le.COMPRESS_CHUNK_SIZE=J;le.COMPRESS_CHUNK_MAX=G-O;var A=le.DECOMPRESS_CHUNK_SIZE=J;le.DECOMPRESS_CHUNK_MAX=A+2*K,le.LATIN_BUFFER_MAX=132;var N=le.UNICODE_CHAR_MAX=40;le.UNICODE_BUFFER_MAX=N*(N+1),le.LATIN_INDEX=O+1,le.LATIN_INDEX_START=w+20,le.UNICODE_INDEX=O+5,le.DECODE_MAX=O-w-19;var Y=le.LATIN_DECODE_MAX=N+7,T=le.CHAR_START=Y+1,j=le.COMPRESS_START=T+1,oe=le.COMPRESS_FIXED_START=j+5;le.COMPRESS_INDEX=oe+5},9727:(E,le,me)=>{var d=me(9209),H=me(966);function J(_){this._init(_)}J.prototype={_init:function(_){_=_||{},this._result=null,this._onDataCallback=_.onData,this._onEndCallback=_.onEnd},_createTable:function(){for(var _={},x=0;x<d.TABLE_LENGTH;x++)_[d.BASE62TABLE.charAt(x)]=x;return _},_onData:function(_){var x;if(this._onDataCallback){if(_)x=this._result,this._result=[];else{var O=d.DECOMPRESS_CHUNK_SIZE-d.WINDOW_MAX;x=this._result.slice(d.WINDOW_MAX,d.WINDOW_MAX+O),this._result=this._result.slice(0,d.WINDOW_MAX).concat(this._result.slice(d.WINDOW_MAX+O))}x.length>0&&this._onDataCallback(H.bufferToString_fast(x))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(_){if(null==_||0===_.length)return"";this._result=H.stringToArray(H.createWindow());for(var x,U,N,Y,j,oe,z,q,X,M,O=this._createTable(),w=!1,K=null,G=_.length,A=0;A<G;A++)if(void 0!==(N=O[_.charAt(A)])){if(N<d.DECODE_MAX)j=w?O[_.charAt(++A)]*d.UNICODE_CHAR_MAX+N+d.UNICODE_BUFFER_MAX*K:K*d.UNICODE_CHAR_MAX+N,this._result[this._result.length]=j;else if(N<d.LATIN_DECODE_MAX)K=N-d.DECODE_MAX,w=!1;else if(N===d.CHAR_START)K=(Y=O[_.charAt(++A)])-5,w=!0;else if(N<d.COMPRESS_INDEX){if(Y=O[_.charAt(++A)],N<d.COMPRESS_FIXED_START?(oe=(N-d.COMPRESS_START)*d.BUFFER_MAX+Y,z=O[_.charAt(++A)]):(oe=(N-d.COMPRESS_FIXED_START)*d.BUFFER_MAX+Y,z=2),(q=this._result.slice(-oe)).length>z&&(q.length=z),X=q.length,q.length>0)for(M=0;M<z;)for(U=0;U<X&&(this._result[this._result.length]=q[U],!(++M>=z));U++);K=null}this._result.length>=d.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(d.WINDOW_MAX),this._onData(!0),this._onEnd(),x=H.bufferToString_fast(this._result),this._result=null,x}},E.exports=J},8497:(E,le,me)=>{var d=me(9263),H=me(9727);me(1014),le.n=function(J,_){return new d(_).compress(J)},le.L=function(J,_){return new H(_).decompress(J)}},966:(E,le,me)=>{var d=me(9209),H=String.fromCharCode;le.createBuffer=function(O,w){if(!d.HAS_TYPED)return new Array(w);switch(O){case 8:return new Uint8Array(w);case 16:return new Uint16Array(w)}};var J=le.truncateBuffer=function(O,w){return O.length===w?O:O.subarray?O.subarray(0,w):(O.length=w,O)};le.bufferToString_fast=function(O,w){if(null==w?w=O.length:O=J(O,w),d.CAN_CHARCODE_APPLY&&d.CAN_CHARCODE_APPLY_TYPED){var K=O.length;if(K<d.APPLY_BUFFER_SIZE&&d.APPLY_BUFFER_SIZE_OK)return H.apply(null,O);if(null===d.APPLY_BUFFER_SIZE_OK)try{var G=H.apply(null,O);return K>d.APPLY_BUFFER_SIZE&&(d.APPLY_BUFFER_SIZE_OK=!0),G}catch{d.APPLY_BUFFER_SIZE_OK=!1}}return _(O)};var _=le.bufferToString_chunked=function(O){for(var A,w="",K=O.length,G=0;G<K;){if(A=O.subarray?O.subarray(G,G+d.APPLY_BUFFER_SIZE):O.slice(G,G+d.APPLY_BUFFER_SIZE),G+=d.APPLY_BUFFER_SIZE,!d.APPLY_BUFFER_SIZE_OK){if(null===d.APPLY_BUFFER_SIZE_OK)try{w+=H.apply(null,A),A.length>d.APPLY_BUFFER_SIZE&&(d.APPLY_BUFFER_SIZE_OK=!0);continue}catch{d.APPLY_BUFFER_SIZE_OK=!1}return x(O)}w+=H.apply(null,A)}return w},x=le.bufferToString_slow=function(O){for(var w="",K=O.length,G=0;G<K;G++)w+=H(O[G]);return w};le.stringToArray=function(O){for(var w=[],K=O&&O.length,G=0;G<K;G++)w[G]=O.charCodeAt(G);return w},le.createWindow=function(){for(var O=d.WINDOW_MAX>>7,w="        ";!(O&d.WINDOW_MAX);)w+=w,O<<=1;return w}},2391:(E,le,me)=>{le.encode=me(8048).encode,le.decode=me(9175).decode,me(7704),me(8131),me(1490),me(9234)},2295:function(E){function le(me){return me&&me.isBuffer&&me}E.exports=le(typeof Buffer<"u"&&Buffer)||le(this.Buffer)||le(typeof window<"u"&&window.Buffer)||this.Buffer},7625:(E,le)=>{le.copy=function J(_,x,O,w){var K;O||(O=0),!w&&0!==w&&(w=this.length),x||(x=0);var G=w-O;if(_===this&&O<x&&x<w)for(K=G-1;K>=0;K--)_[K+x]=this[K+O];else for(K=0;K<G;K++)_[K+x]=this[K+O];return G},le.toString=function H(_,x,O){var w=this,K=0|x;O||(O=w.length);for(var G="",A=0;K<O;)(A=w[K++])<128?G+=String.fromCharCode(A):(192==(224&A)?A=(31&A)<<6|63&w[K++]:224==(240&A)?A=(15&A)<<12|(63&w[K++])<<6|63&w[K++]:240==(248&A)&&(A=(7&A)<<18|(63&w[K++])<<12|(63&w[K++])<<6|63&w[K++]),A>=65536?(A-=65536,G+=String.fromCharCode(55296+(A>>>10),56320+(1023&A))):G+=String.fromCharCode(A));return G},le.write=function d(_,x){for(var O=this,w=x||(x|=0),K=_.length,G=0,A=0;A<K;)(G=_.charCodeAt(A++))<128?O[w++]=G:G<2048?(O[w++]=192|G>>>6,O[w++]=128|63&G):G<55296||G>57343?(O[w++]=224|G>>>12,O[w++]=128|G>>>6&63,O[w++]=128|63&G):(G=65536+(G-55296<<10|_.charCodeAt(A++)-56320),O[w++]=240|G>>>18,O[w++]=128|G>>>12&63,O[w++]=128|G>>>6&63,O[w++]=128|63&G);return w-x}},1864:(E,le,me)=>{var d=me(6093),H=E.exports=J(0);function J(x){return new Array(x)}H.alloc=J,H.concat=d.concat,H.from=function _(x){if(!d.isBuffer(x)&&d.isView(x))x=d.Uint8Array.from(x);else if(d.isArrayBuffer(x))x=new Uint8Array(x);else{if("string"==typeof x)return d.from.call(H,x);if("number"==typeof x)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(x)}},1884:(E,le,me)=>{var d=me(6093),H=d.global,J=E.exports=d.hasBuffer?_(0):[];function _(O){return new H(O)}J.alloc=d.hasBuffer&&H.alloc||_,J.concat=d.concat,J.from=function x(O){if(!d.isBuffer(O)&&d.isView(O))O=d.Uint8Array.from(O);else if(d.isArrayBuffer(O))O=new Uint8Array(O);else{if("string"==typeof O)return d.from.call(J,O);if("number"==typeof O)throw new TypeError('"value" argument must not be a number')}return H.from&&1!==H.from.length?H.from(O):new H(O)}},5364:(E,le,me)=>{var d=me(7625);le.copy=O,le.slice=w,le.toString=function K(A,U,N){var Y=!_&&H.isBuffer(this)?this.toString:d.toString;return Y.apply(this,arguments)},le.write=function G(A){return function U(){return(this[A]||d[A]).apply(this,arguments)}}("write");var H=me(6093),J=H.global,_=H.hasBuffer&&"TYPED_ARRAY_SUPPORT"in J,x=_&&!J.TYPED_ARRAY_SUPPORT;function O(A,U,N,Y){var T=H.isBuffer(this),j=H.isBuffer(A);if(T&&j)return this.copy(A,U,N,Y);if(x||T||j||!H.isView(this)||!H.isView(A))return d.copy.call(this,A,U,N,Y);var oe=N||null!=Y?w.call(this,N,Y):this;return A.set(oe,U),oe.length}function w(A,U){var N=this.slice||!x&&this.subarray;if(N)return N.call(this,A,U);var Y=H.alloc.call(this,U-A);return O.call(this,Y,0,A,U),Y}},5321:(E,le,me)=>{var d=me(6093),H=E.exports=d.hasArrayBuffer?J(0):[];function J(x){return new Uint8Array(x)}H.alloc=J,H.concat=d.concat,H.from=function _(x){if(d.isView(x)){var O=x.byteOffset,w=x.byteLength;(x=x.buffer).byteLength!==w&&(x.slice?x=x.slice(O,O+w):(x=new Uint8Array(x)).byteLength!==w&&(x=Array.prototype.slice.call(x,O,O+w)))}else{if("string"==typeof x)return d.from.call(H,x);if("number"==typeof x)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(x)}},6093:(E,le,me)=>{var d=le.global=me(2295),H=le.hasBuffer=d&&!!d.isBuffer,J=le.hasArrayBuffer=typeof ArrayBuffer<"u",_=le.isArray=me(6425);le.isArrayBuffer=J?function j(M){return M instanceof ArrayBuffer||T(M)}:q;var x=le.isBuffer=H?d.isBuffer:q,O=le.isView=J?ArrayBuffer.isView||X("ArrayBuffer","buffer"):q;le.alloc=N,le.concat=function Y(M,I){I||(I=0,Array.prototype.forEach.call(M,function k(P){I+=P.length}));var L=N.call(this!==le&&this||M[0],I),S=0;return Array.prototype.forEach.call(M,function v(P){S+=A.copy.call(P,L,S)}),L},le.from=function U(M){return"string"==typeof M?oe.call(this,M):z(this).from(M)};var w=le.Array=me(1864),K=le.Buffer=me(1884),G=le.Uint8Array=me(5321),A=le.prototype=me(5364);function N(M){return z(this).alloc(M)}var T=X("ArrayBuffer");function oe(M){var I=3*M.length,Q=N.call(this,I),L=A.write.call(Q,M);return I!==L&&(Q=A.slice.call(Q,0,L)),Q}function z(M){return x(M)?K:O(M)?G:_(M)?w:H?K:J?G:w}function q(){return!1}function X(M,I){return M="[object "+M+"]",function(Q){return null!=Q&&{}.toString.call(I?Q[I]:Q)===M}}},5166:(E,le,me)=>{var d=me(6425);le.createCodec=K,le.install=function _(G){for(var A in G)J.prototype[A]=x(J.prototype[A],G[A])},le.filter=function w(G){return d(G)?function O(G){return G=G.slice(),function(U){return G.reduce(A,U)};function A(U,N){return N(U)}}(G):G};var H=me(6093);function J(G){if(!(this instanceof J))return new J(G);this.options=G,this.init()}function x(G,A){return G&&A?function U(){return G.apply(this,arguments),A.apply(this,arguments)}:G||A}function K(G){return new J(G)}J.prototype.init=function(){var G=this.options;return G&&G.uint8array&&(this.bufferish=H.Uint8Array),this},le.preset=K({preset:!0})},9234:(E,le,me)=>{me(8334),me(2732),me(5166)},5333:(E,le,me)=>{le.T=J;var d=me(8334).preset;function J(_){if(!(this instanceof J))return new J(_);if(_&&(this.options=_,_.codec)){var x=this.codec=_.codec;x.bufferish&&(this.bufferish=x.bufferish)}}me(6473).k.mixin(J.prototype),J.prototype.codec=d,J.prototype.fetch=function(){return this.codec.decode(this)}},9175:(E,le,me)=>{le.decode=function H(J,_){var x=new d(_);return x.write(J),x.read()};var d=me(5333).T},8131:(E,le,me)=>{var H=me(6654),J=me(5333).T;function _(x){if(!(this instanceof _))return new _(x);J.call(this,x)}_.prototype=new J,H.mixin(_.prototype),_.prototype.decode=function(x){arguments.length&&this.write(x),this.flush()},_.prototype.push=function(x){this.emit("data",x)},_.prototype.end=function(x){this.decode(x),this.emit("end")}},8400:(E,le,me)=>{le.F=J;var d=me(2732).preset;function J(_){if(!(this instanceof J))return new J(_);if(_&&(this.options=_,_.codec)){var x=this.codec=_.codec;x.bufferish&&(this.bufferish=x.bufferish)}}me(6473).I.mixin(J.prototype),J.prototype.codec=d,J.prototype.write=function(_){this.codec.encode(this,_)}},8048:(E,le,me)=>{le.encode=function H(J,_){var x=new d(_);return x.write(J),x.read()};var d=me(8400).F},7704:(E,le,me)=>{var H=me(6654),J=me(8400).F;function _(x){if(!(this instanceof _))return new _(x);J.call(this,x)}_.prototype=new J,H.mixin(_.prototype),_.prototype.encode=function(x){this.write(x),this.emit("data",this.read())},_.prototype.end=function(x){arguments.length&&this.encode(x),this.flush(),this.emit("end")}},7846:(E,le,me)=>{le.S=function H(J,_){if(!(this instanceof H))return new H(J,_);this.buffer=d.from(J),this.type=_};var d=me(6093)},4106:(E,le,me)=>{le.setExtPackers=function O(U){U.addExtPacker(14,Error,[A,w]),U.addExtPacker(1,EvalError,[A,w]),U.addExtPacker(2,RangeError,[A,w]),U.addExtPacker(3,ReferenceError,[A,w]),U.addExtPacker(4,SyntaxError,[A,w]),U.addExtPacker(5,TypeError,[A,w]),U.addExtPacker(6,URIError,[A,w]),U.addExtPacker(10,RegExp,[G,w]),U.addExtPacker(11,Boolean,[K,w]),U.addExtPacker(12,String,[K,w]),U.addExtPacker(13,Date,[Number,w]),U.addExtPacker(15,Number,[K,w]),typeof Uint8Array<"u"&&(U.addExtPacker(17,Int8Array,J),U.addExtPacker(18,Uint8Array,J),U.addExtPacker(19,Int16Array,J),U.addExtPacker(20,Uint16Array,J),U.addExtPacker(21,Int32Array,J),U.addExtPacker(22,Uint32Array,J),U.addExtPacker(23,Float32Array,J),typeof Float64Array<"u"&&U.addExtPacker(24,Float64Array,J),typeof Uint8ClampedArray<"u"&&U.addExtPacker(25,Uint8ClampedArray,J),U.addExtPacker(26,ArrayBuffer,J),U.addExtPacker(29,DataView,J)),d.hasBuffer&&U.addExtPacker(27,H,d.from)};var _,d=me(6093),H=d.global,J=d.Uint8Array.from,x={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function w(U){return _||(_=me(8048).encode),_(U)}function K(U){return U.valueOf()}function G(U){(U=RegExp.prototype.toString.call(U).split("/")).shift();var N=[U.pop()];return N.unshift(U.join("/")),N}function A(U){var N={};for(var Y in x)N[Y]=U[Y];return N}},9146:(E,le,me)=>{le.setExtUnpackers=function x(U){U.addExtUnpacker(14,[O,K(Error)]),U.addExtUnpacker(1,[O,K(EvalError)]),U.addExtUnpacker(2,[O,K(RangeError)]),U.addExtUnpacker(3,[O,K(ReferenceError)]),U.addExtUnpacker(4,[O,K(SyntaxError)]),U.addExtUnpacker(5,[O,K(TypeError)]),U.addExtUnpacker(6,[O,K(URIError)]),U.addExtUnpacker(10,[O,w]),U.addExtUnpacker(11,[O,G(Boolean)]),U.addExtUnpacker(12,[O,G(String)]),U.addExtUnpacker(13,[O,G(Date)]),U.addExtUnpacker(15,[O,G(Number)]),typeof Uint8Array<"u"&&(U.addExtUnpacker(17,G(Int8Array)),U.addExtUnpacker(18,G(Uint8Array)),U.addExtUnpacker(19,[A,G(Int16Array)]),U.addExtUnpacker(20,[A,G(Uint16Array)]),U.addExtUnpacker(21,[A,G(Int32Array)]),U.addExtUnpacker(22,[A,G(Uint32Array)]),U.addExtUnpacker(23,[A,G(Float32Array)]),typeof Float64Array<"u"&&U.addExtUnpacker(24,[A,G(Float64Array)]),typeof Uint8ClampedArray<"u"&&U.addExtUnpacker(25,G(Uint8ClampedArray)),U.addExtUnpacker(26,A),U.addExtUnpacker(29,[A,G(DataView)])),d.hasBuffer&&U.addExtUnpacker(27,G(H))};var J,d=me(6093),H=d.global,_={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function O(U){return J||(J=me(9175).decode),J(U)}function w(U){return RegExp.apply(null,U)}function K(U){return function(N){var Y=new U;for(var T in _)Y[T]=N[T];return Y}}function G(U){return function(N){return new U(N)}}function A(U){return new Uint8Array(U).buffer}},1490:(E,le,me)=>{me(8334),me(2732),me(5166)},6473:(E,le,me)=>{le.k=x,le.I=O;var d=me(6093),_="BUFFER_SHORTAGE";function x(){if(!(this instanceof x))return new x}function O(){if(!(this instanceof O))return new O}function G(){throw new Error("method not implemented: write()")}function A(){throw new Error("method not implemented: fetch()")}function U(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function N(j){(this.buffers||(this.buffers=[])).push(j)}function Y(){return(this.buffers||(this.buffers=[])).shift()}function T(j){return function oe(z){for(var q in j)z[q]=j[q];return z}}x.mixin=T(function w(){return{bufferish:d,write:function j(q){var X=this.offset?d.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=X?q?this.bufferish.concat([X,q]):X:q,this.offset=0},fetch:A,flush:function oe(){for(;this.offset<this.buffer.length;){var X,q=this.offset;try{X=this.fetch()}catch(M){if(M&&M.message!=_)throw M;this.offset=q;break}this.push(X)}},push:N,pull:Y,read:U,reserve:function z(q){var X=this.offset,M=X+q;if(M>this.buffer.length)throw new Error(_);return this.offset=M,X},offset:0}}()),x.mixin(x.prototype),O.mixin=T(function K(){return{bufferish:d,write:G,fetch:function j(){var M=this.start;if(M<this.offset){var I=this.start=this.offset;return d.prototype.slice.call(this.buffer,M,I)}},flush:function oe(){for(;this.start<this.offset;){var M=this.fetch();M&&this.push(M)}},push:N,pull:function z(){var M=this.buffers||(this.buffers=[]),I=M.length>1?this.bufferish.concat(M):M[0];return M.length=0,I},read:U,reserve:function q(M){var I=0|M;if(this.buffer){var Q=this.buffer.length,L=0|this.offset,S=L+I;if(S<Q)return this.offset=S,L;this.flush(),M=Math.max(M,Math.min(2*Q,this.maxBufferSize))}return M=Math.max(M,this.minBufferSize),this.buffer=this.bufferish.alloc(M),this.start=0,this.offset=I,0},send:function X(M){var I=M.length;if(I>this.minBufferSize)this.flush(),this.push(M);else{var Q=this.reserve(I);d.prototype.copy.call(M,this.buffer,Q)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),O.mixin(O.prototype)},8334:(E,le,me)=>{var d=me(7846).S,H=me(9146),J=me(4613).readUint8,_=me(1788),x=me(5166);function w(){var A=this.options;return this.decode=function O(A){var U=_.getReadToken(A);return function N(Y){var T=J(Y),j=U[T];if(!j)throw new Error("Invalid type: "+(T&&"0x"+T.toString(16)));return j(Y)}}(A),A&&A.preset&&H.setExtUnpackers(this),this}x.install({addExtUnpacker:function K(A,U){(this.extUnpackers||(this.extUnpackers=[]))[A]=x.filter(U)},getExtUnpacker:function G(A){return(this.extUnpackers||(this.extUnpackers=[]))[A]||function N(Y){return new d(Y,A)}},init:w}),le.preset=w.call(x.preset)},4613:(E,le,me)=>{var d=me(8461),H=me(6256),J=H.Uint64BE,_=H.Int64BE;le.getReadFormat=function G(D){var R=D&&D.int64;return{map:w&&D&&D.usemap?U:A,array:N,str:Y,bin:x.hasArrayBuffer&&D&&D.binarraybuffer?j:T,ext:oe,uint8:z,uint16:X,uint32:I,uint64:L(8,R?v:S),int8:q,int16:M,int32:Q,int64:L(8,R?P:k),float32:L(4,B),float64:L(8,te)}},le.readUint8=z;var x=me(6093),O=me(5364),w=typeof Map<"u";function A(D,fe){var F,R={},g=new Array(fe),l=new Array(fe),c=D.codec.decode;for(F=0;F<fe;F++)g[F]=c(D),l[F]=c(D);for(F=0;F<fe;F++)R[g[F]]=l[F];return R}function U(D,fe){var F,R=new Map,g=new Array(fe),l=new Array(fe),c=D.codec.decode;for(F=0;F<fe;F++)g[F]=c(D),l[F]=c(D);for(F=0;F<fe;F++)R.set(g[F],l[F]);return R}function N(D,fe){for(var R=new Array(fe),F=D.codec.decode,g=0;g<fe;g++)R[g]=F(D);return R}function Y(D,fe){var R=D.reserve(fe);return O.toString.call(D.buffer,"utf-8",R,R+fe)}function T(D,fe){var R=D.reserve(fe),g=O.slice.call(D.buffer,R,R+fe);return x.from(g)}function j(D,fe){var R=D.reserve(fe),g=O.slice.call(D.buffer,R,R+fe);return x.Uint8Array.from(g).buffer}function oe(D,fe){var R=D.reserve(fe+1),F=D.buffer[R++],g=R+fe,l=D.codec.getExtUnpacker(F);if(!l)throw new Error("Invalid ext type: "+(F&&"0x"+F.toString(16)));return l(O.slice.call(D.buffer,R,g))}function z(D){var fe=D.reserve(1);return D.buffer[fe]}function q(D){var fe=D.reserve(1),R=D.buffer[fe];return 128&R?R-256:R}function X(D){var fe=D.reserve(2),R=D.buffer;return R[fe++]<<8|R[fe]}function M(D){var fe=D.reserve(2),R=D.buffer,F=R[fe++]<<8|R[fe];return 32768&F?F-65536:F}function I(D){var fe=D.reserve(4),R=D.buffer;return 16777216*R[fe++]+(R[fe++]<<16)+(R[fe++]<<8)+R[fe]}function Q(D){var fe=D.reserve(4),R=D.buffer;return R[fe++]<<24|R[fe++]<<16|R[fe++]<<8|R[fe]}function L(D,fe){return function(R){var F=R.reserve(D);return fe.call(R.buffer,F,!0)}}function S(D){return new J(this,D).toNumber()}function k(D){return new _(this,D).toNumber()}function v(D){return new J(this,D)}function P(D){return new _(this,D)}function B(D){return d.read(this,D,!1,23,4)}function te(D){return d.read(this,D,!1,52,8)}},1788:(E,le,me)=>{var d=me(4613);function J(K){var G,A=new Array(256);for(G=0;G<=127;G++)A[G]=x(G);for(G=128;G<=143;G++)A[G]=w(G-128,K.map);for(G=144;G<=159;G++)A[G]=w(G-144,K.array);for(G=160;G<=191;G++)A[G]=w(G-160,K.str);for(A[192]=x(null),A[193]=null,A[194]=x(!1),A[195]=x(!0),A[196]=O(K.uint8,K.bin),A[197]=O(K.uint16,K.bin),A[198]=O(K.uint32,K.bin),A[199]=O(K.uint8,K.ext),A[200]=O(K.uint16,K.ext),A[201]=O(K.uint32,K.ext),A[202]=K.float32,A[203]=K.float64,A[204]=K.uint8,A[205]=K.uint16,A[206]=K.uint32,A[207]=K.uint64,A[208]=K.int8,A[209]=K.int16,A[210]=K.int32,A[211]=K.int64,A[212]=w(1,K.ext),A[213]=w(2,K.ext),A[214]=w(4,K.ext),A[215]=w(8,K.ext),A[216]=w(16,K.ext),A[217]=O(K.uint8,K.str),A[218]=O(K.uint16,K.str),A[219]=O(K.uint32,K.str),A[220]=O(K.uint16,K.array),A[221]=O(K.uint32,K.array),A[222]=O(K.uint16,K.map),A[223]=O(K.uint32,K.map),G=224;G<=255;G++)A[G]=x(G-256);return A}function x(K){return function(){return K}}function O(K,G){return function(A){var U=K(A);return G(A,U)}}function w(K,G){return function(A){return G(A,K)}}le.getReadToken=function H(K){var G=d.getReadFormat(K);return K&&K.useraw?function _(K){var G,A=J(K).slice();for(A[217]=A[196],A[218]=A[197],A[219]=A[198],G=160;G<=191;G++)A[G]=w(G-160,K.bin);return A}(G):J(G)}},2732:(E,le,me)=>{var d=me(7846).S,H=me(4106),J=me(9118),_=me(5166);function O(){var G=this.options;return this.encode=function x(G){var A=J.getWriteType(G);return function U(N,Y){var T=A[typeof Y];if(!T)throw new Error('Unsupported type "'+typeof Y+'": '+Y);T(N,Y)}}(G),G&&G.preset&&H.setExtPackers(this),this}_.install({addExtPacker:function w(G,A,U){U=_.filter(U);var N=A.name;function j(oe){return U&&(oe=U(oe)),new d(oe,G)}N&&"Object"!==N?(this.extPackers||(this.extPackers={}))[N]=j:(this.extEncoderList||(this.extEncoderList=[])).unshift([A,j])},getExtPacker:function K(G){var A=this.extPackers||(this.extPackers={}),U=G.constructor,N=U&&U.name&&A[U.name];if(N)return N;for(var Y=this.extEncoderList||(this.extEncoderList=[]),T=Y.length,j=0;j<T;j++){var oe=Y[j];if(U===oe[0])return oe[1]}},init:O}),le.preset=O.call(_.preset)},3041:(E,le,me)=>{var d=me(8461),H=me(6256),J=H.Uint64BE,_=H.Int64BE,x=me(8323).w,O=me(6093),w=O.global,G=O.hasBuffer&&"TYPED_ARRAY_SUPPORT"in w&&!w.TYPED_ARRAY_SUPPORT,A=O.hasBuffer&&w.prototype||{};function Y(){var L=x.slice();return L[196]=j(196),L[197]=oe(197),L[198]=z(198),L[199]=j(199),L[200]=oe(200),L[201]=z(201),L[202]=q(202,4,A.writeFloatBE||I,!0),L[203]=q(203,8,A.writeDoubleBE||Q,!0),L[204]=j(204),L[205]=oe(205),L[206]=z(206),L[207]=q(207,8,X),L[208]=j(208),L[209]=oe(209),L[210]=z(210),L[211]=q(211,8,M),L[217]=j(217),L[218]=oe(218),L[219]=z(219),L[220]=oe(220),L[221]=z(221),L[222]=oe(222),L[223]=z(223),L}function j(L){return function(S,k){var v=S.reserve(2),P=S.buffer;P[v++]=L,P[v]=k}}function oe(L){return function(S,k){var v=S.reserve(3),P=S.buffer;P[v++]=L,P[v++]=k>>>8,P[v]=k}}function z(L){return function(S,k){var v=S.reserve(5),P=S.buffer;P[v++]=L,P[v++]=k>>>24,P[v++]=k>>>16,P[v++]=k>>>8,P[v]=k}}function q(L,S,k,v){return function(P,B){var te=P.reserve(S+1);P.buffer[te++]=L,k.call(P.buffer,B,te,v)}}function X(L,S){new J(this,S,L)}function M(L,S){new _(this,S,L)}function I(L,S){d.write(this,L,S,!1,23,4)}function Q(L,S){d.write(this,L,S,!1,52,8)}le.getWriteToken=function U(L){return L&&L.uint8array?function N(){var L=Y();return L[202]=q(202,4,I),L[203]=q(203,8,Q),L}():G||O.hasBuffer&&L&&L.safe?function T(){var L=x.slice();return L[196]=q(196,1,w.prototype.writeUInt8),L[197]=q(197,2,w.prototype.writeUInt16BE),L[198]=q(198,4,w.prototype.writeUInt32BE),L[199]=q(199,1,w.prototype.writeUInt8),L[200]=q(200,2,w.prototype.writeUInt16BE),L[201]=q(201,4,w.prototype.writeUInt32BE),L[202]=q(202,4,w.prototype.writeFloatBE),L[203]=q(203,8,w.prototype.writeDoubleBE),L[204]=q(204,1,w.prototype.writeUInt8),L[205]=q(205,2,w.prototype.writeUInt16BE),L[206]=q(206,4,w.prototype.writeUInt32BE),L[207]=q(207,8,X),L[208]=q(208,1,w.prototype.writeInt8),L[209]=q(209,2,w.prototype.writeInt16BE),L[210]=q(210,4,w.prototype.writeInt32BE),L[211]=q(211,8,M),L[217]=q(217,1,w.prototype.writeUInt8),L[218]=q(218,2,w.prototype.writeUInt16BE),L[219]=q(219,4,w.prototype.writeUInt32BE),L[220]=q(220,2,w.prototype.writeUInt16BE),L[221]=q(221,4,w.prototype.writeUInt32BE),L[222]=q(222,2,w.prototype.writeUInt16BE),L[223]=q(223,4,w.prototype.writeUInt32BE),L}():Y()}},9118:(E,le,me)=>{var d=me(6425),H=me(6256),J=H.Uint64BE,_=H.Int64BE,x=me(6093),O=me(5364),w=me(3041),K=me(8323).w,G=me(7846).S,A=typeof Uint8Array<"u",U=typeof Map<"u",N=[];N[1]=212,N[2]=213,N[4]=214,N[8]=215,N[16]=216,le.getWriteType=function Y(T){var j=w.getWriteToken(T),oe=T&&T.useraw,z=A&&T&&T.binarraybuffer,q=z?x.isArrayBuffer:x.isBuffer,X=z?function l(m,C){g(m,new Uint8Array(C))}:g,I=U&&T&&T.usemap?function u(m,C){if(!(C instanceof Map))return f(m,C);var $=C.size;j[$<16?128+$:$<=65535?222:223](m,$);var se=m.codec.encode;C.forEach(function(Ee,Me,ce){se(m,Me),se(m,Ee)})}:f;return{boolean:function L(m,C){j[C?195:194](m,C)},function:R,number:function S(m,C){var $=0|C;C===$?j[-32<=$&&$<=127?255&$:0<=$?$<=255?204:$<=65535?205:206:-128<=$?208:-32768<=$?209:210](m,$):j[203](m,C)},object:oe?function fe(m,C){if(q(C))return function p(m,C){var $=C.length;j[$<32?160+$:$<=65535?218:219](m,$),m.send(C)}(m,C);D(m,C)}:D,string:function te(m){return function C($,re){var se=re.length;$.offset=$.reserve(5+3*se);var Me=$.buffer,ce=m(se),ke=$.offset+ce;se=O.write.call(Me,re,ke);var ve=m(se);ce!==ve&&O.copy.call(Me,Me,ke+ve-ce,ke,ke+se),j[1===ve?160+se:ve<=3?215+ve:219]($,se),$.offset+=se}}(oe?function B(m){return m<32?1:m<=65535?3:5}:function P(m){return m<32?1:m<=255?2:m<=65535?3:5}),symbol:R,undefined:R};function D(m,C){if(null===C)return R(m,C);if(q(C))return X(m,C);if(d(C))return function F(m,C){var $=C.length;j[$<16?144+$:$<=65535?220:221](m,$);for(var se=m.codec.encode,Ee=0;Ee<$;Ee++)se(m,C[Ee])}(m,C);if(J.isUint64BE(C))return function k(m,C){j[207](m,C.toArray())}(m,C);if(_.isInt64BE(C))return function v(m,C){j[211](m,C.toArray())}(m,C);var $=m.codec.getExtPacker(C);if($&&(C=$(C)),C instanceof G)return function c(m,C){var $=C.buffer,re=$.length;j[N[re]||(re<255?199:re<=65535?200:201)](m,re),K[C.type](m),m.send($)}(m,C);I(m,C)}function R(m,C){j[192](m,C)}function g(m,C){var $=C.length;j[$<255?196:$<=65535?197:198](m,$),m.send(C)}function f(m,C){var $=Object.keys(C),re=$.length;j[re<16?128+re:re<=65535?222:223](m,re);var Ee=m.codec.encode;$.forEach(function(Me){Ee(m,Me),Ee(m,C[Me])})}}},8323:(E,le)=>{for(var me=le.w=new Array(256),d=0;d<=255;d++)me[d]=H(d);function H(J){return function(_){var x=_.reserve(1);_.buffer[x]=J}}},1203:E=>{function le(J){var _="    ";if(isNaN(parseInt(J)))_=J;else switch(J){case 1:_=" ";break;case 2:_="  ";break;case 3:_="   ";break;case 4:_="    ";break;case 5:_="     ";break;case 6:_="      ";break;case 7:_="       ";break;case 8:_="        ";break;case 9:_="         ";break;case 10:_="          ";break;case 11:_="           ";break;case 12:_="            "}for(var x=["\n"],O=0;O<100;O++)x.push(x[O]+_);return x}function me(){this.step="    ",this.shift=le(this.step)}function d(J,_){return _-(J.replace(/\(/g,"").length-J.replace(/\)/g,"").length)}function H(J,_){return J.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+_+_+"AND ").replace(/ BETWEEN /gi,"~::~"+_+"BETWEEN ").replace(/ CASE /gi,"~::~"+_+"CASE ").replace(/ ELSE /gi,"~::~"+_+"ELSE ").replace(/ END /gi,"~::~"+_+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+_+"ON ").replace(/ OR /gi,"~::~"+_+_+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+_+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+_).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+_+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}me.prototype.xml=function(J,_){var x=J.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),O=x.length,w=!1,K=0,G="",A=0,U=_?le(_):this.shift;for(A=0;A<O;A++)x[A].search(/<!/)>-1?(G+=U[K]+x[A],w=!0,(x[A].search(/-->/)>-1||x[A].search(/\]>/)>-1||x[A].search(/!DOCTYPE/)>-1)&&(w=!1)):x[A].search(/-->/)>-1||x[A].search(/\]>/)>-1?(G+=x[A],w=!1):/^<\w/.exec(x[A-1])&&/^<\/\w/.exec(x[A])&&/^<[\w:\-\.\,]+/.exec(x[A-1])==/^<\/[\w:\-\.\,]+/.exec(x[A])[0].replace("/","")?(G+=x[A],w||K--):x[A].search(/<\w/)>-1&&-1==x[A].search(/<\//)&&-1==x[A].search(/\/>/)?G=G+=w?x[A]:U[K++]+x[A]:x[A].search(/<\w/)>-1&&x[A].search(/<\//)>-1?G=G+=w?x[A]:U[K]+x[A]:x[A].search(/<\//)>-1?G=G+=w?x[A]:U[--K]+x[A]:x[A].search(/\/>/)>-1?G=G+=w?x[A]:U[K]+x[A]:x[A].search(/<\?/)>-1||x[A].search(/xmlns\:/)>-1||x[A].search(/xmlns\=/)>-1?G+=U[K]+x[A]:G+=x[A];return"\n"==G[0]?G.slice(1):G},me.prototype.json=function(J,x){return x=x||this.step,typeof JSON>"u"?J:"string"==typeof J?JSON.stringify(JSON.parse(J),null,x):"object"==typeof J?JSON.stringify(J,null,x):J},me.prototype.css=function(J,_){var x=J.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),O=x.length,w=0,K="",G=0,A=_?le(_):this.shift;for(G=0;G<O;G++)/\{/.exec(x[G])?K+=A[w++]+x[G]:/\}/.exec(x[G])?K+=A[--w]+x[G]:(/\*\\/.exec(x[G]),K+=A[w]+x[G]);return K.replace(/^\n{1,}/,"")},me.prototype.sql=function(J,_){var x=J.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),O=x.length,w=[],K=0,G=this.step,N=0,Y="",T=0,j=_?le(_):this.shift;for(T=0;T<O;T++)w=w.concat(T%2?x[T]:H(x[T],G));for(O=w.length,T=0;T<O;T++)N=d(w[T],N),/\s{0,}\s{0,}SELECT\s{0,}/.exec(w[T])&&(w[T]=w[T].replace(/\,/g,",\n"+G+G)),/\s{0,}\s{0,}SET\s{0,}/.exec(w[T])&&(w[T]=w[T].replace(/\,/g,",\n"+G+G)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(w[T])?Y+=j[++K]+w[T]:/\'/.exec(w[T])?(N<1&&K&&K--,Y+=w[T]):(Y+=j[K]+w[T],N<1&&K&&K--);return Y.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},me.prototype.xmlmin=function(J,_){return(_?J:J.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},me.prototype.jsonmin=function(J){return typeof JSON>"u"?J:JSON.stringify(JSON.parse(J),null,0)},me.prototype.cssmin=function(J,_){return(_?J:J.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},me.prototype.sqlmin=function(J){return J.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},E.exports=new me},85:(E,le,me)=>{var d={"./AFF2e":[7676,7327],"./AFF2e.js":[7676,7327],"./AceKillerGene":[1439,7217],"./AceKillerGene.js":[1439,7217],"./Ainecadette":[2160,8150],"./Ainecadette.js":[2160,8150],"./Airgetlamh":[6408,5247],"./Airgetlamh.js":[6408,5247],"./AlchemiaStruggle":[6510,5225],"./AlchemiaStruggle.js":[6510,5225],"./Alsetto":[905,2948],"./Alsetto.js":[905,2948],"./Alshard":[7058,6420],"./Alshard.js":[7058,6420],"./AlterRaise":[1105,3385],"./AlterRaise.js":[1105,3385],"./Amadeus":[5752,1582],"./Amadeus.js":[5752,1582],"./Amadeus_Korean":[6602,5512],"./Amadeus_Korean.js":[6602,5512],"./AngelGear":[4200,9437],"./AngelGear.js":[4200,9437],"./AnimaAnimus":[7164,2919],"./AnimaAnimus.js":[7164,2919],"./Aoharubaan":[5757,6968],"./Aoharubaan.js":[5757,6968],"./Arianrhod":[4005,5283],"./Arianrhod.js":[4005,5283],"./ArsMagica":[3655,5734],"./ArsMagica.js":[3655,5734],"./AssaultEngine":[3898,4339],"./AssaultEngine.js":[3898,4339],"./Avandner":[8206,3084],"./Avandner.js":[8206,3084],"./Ayabito":[5853,1253],"./Ayabito.js":[5853,1253],"./BBN":[8554,2522],"./BBN.js":[8554,2522],"./BadLife":[9538,4872],"./BadLife.js":[9538,4872],"./Bakenokawa":[6103,2135],"./Bakenokawa.js":[6103,2135],"./BarnaKronika":[5396,7073],"./BarnaKronika.js":[5396,7073],"./BattleTech":[2890,6344],"./BattleTech.js":[2890,6344],"./BeastBindTrinity":[1063,4572],"./BeastBindTrinity.js":[1063,4572],"./BeginningIdol":[8857,66],"./BeginningIdol.js":[8857,66],"./BeginningIdol2022":[8381,6466],"./BeginningIdol2022.js":[8381,6466],"./BeginningIdol_Korean":[7816,7117],"./BeginningIdol_Korean.js":[7816,7117],"./BladeOfArcana":[3449,1087],"./BladeOfArcana.js":[3449,1087],"./BlindMythos":[2639,5539],"./BlindMythos.js":[2639,5539],"./BloodCrusade":[2906,2013],"./BloodCrusade.js":[2906,2013],"./BloodMoon":[7994,593],"./BloodMoon.js":[7994,593],"./Bloodorium":[3498,3312],"./Bloodorium.js":[3498,3312],"./CardRanker":[6006,873],"./CardRanker.js":[6006,873],"./CastleInGray":[2519,1820],"./CastleInGray.js":[2519,1820],"./ChaosFlare":[229,1114],"./ChaosFlare.js":[229,1114],"./Chill":[9894,1919],"./Chill.js":[9894,1919],"./Chill3":[3294,8585],"./Chill3.js":[3294,8585],"./CodeLayerd":[6106,9606],"./CodeLayerd.js":[6106,9606],"./ColossalHunter":[519,2461],"./ColossalHunter.js":[519,2461],"./Comes":[1712,2793],"./Comes.js":[1712,2793],"./ConvictorDrive":[1011,8138],"./ConvictorDrive.js":[1011,8138],"./CrashWorld":[6506,2519],"./CrashWorld.js":[6506,2519],"./Cthulhu":[2605,3364],"./Cthulhu.js":[2605,3364],"./Cthulhu7th":[5149,8376],"./Cthulhu7th.js":[5149,8376],"./Cthulhu7th_ChineseTraditional":[9464,6447],"./Cthulhu7th_ChineseTraditional.js":[9464,6447],"./Cthulhu7th_Korean":[329,7170],"./Cthulhu7th_Korean.js":[329,7170],"./CthulhuTech":[9818,2555],"./CthulhuTech.js":[9818,2555],"./Cthulhu_ChineseTraditional":[3109,9285],"./Cthulhu_ChineseTraditional.js":[3109,9285],"./Cthulhu_Korean":[9585,7008],"./Cthulhu_Korean.js":[9585,7008],"./Cthulhu_SimplifiedChinese":[4916,1448],"./Cthulhu_SimplifiedChinese.js":[4916,1448],"./CyberpunkRed":[1933,347],"./CyberpunkRed.js":[1933,347],"./DarkBlaze":[7810,3005],"./DarkBlaze.js":[7810,3005],"./DarkDaysDrive":[3543,5736],"./DarkDaysDrive.js":[3543,5736],"./DarkSouls":[5581,3958],"./DarkSouls.js":[5581,3958],"./DeadlineHeroes":[2270,6143],"./DeadlineHeroes.js":[2270,6143],"./DemonParasite":[7605,5670],"./DemonParasite.js":[7605,5670],"./DesperateRun":[8999,148],"./DesperateRun.js":[8999,148],"./DetatokoSaga":[3264,5413],"./DetatokoSaga.js":[3264,5413],"./DetatokoSaga_Korean":[4236,7553],"./DetatokoSaga_Korean.js":[4236,7553],"./DiceBot":[8618,8159],"./DiceBot.js":[8618,8159],"./DiceOfTheDead":[2533,5651],"./DiceOfTheDead.js":[2533,5651],"./DoubleCross":[1316,8436],"./DoubleCross.js":[1316,8436],"./DoubleCross_Korean":[9761,6708],"./DoubleCross_Korean.js":[9761,6708],"./Dracurouge":[2204,2697],"./Dracurouge.js":[2204,2697],"./Dracurouge_Korean":[759,9678],"./Dracurouge_Korean.js":[759,9678],"./DungeonsAndDragons":[8454,8358],"./DungeonsAndDragons.js":[8454,8358],"./DungeonsAndDragons5":[9781,1125],"./DungeonsAndDragons5.js":[9781,1125],"./EarthDawn":[1329,517],"./EarthDawn.js":[1329,517],"./EarthDawn3":[4021,9730],"./EarthDawn3.js":[4021,9730],"./EarthDawn4":[9918,809],"./EarthDawn4.js":[9918,809],"./EclipsePhase":[410,9735],"./EclipsePhase.js":[410,9735],"./Elric":[8326,7309],"./Elric.js":[8326,7309],"./Elysion":[9626,7372],"./Elysion.js":[9626,7372],"./EmbryoMachine":[2035,9755],"./EmbryoMachine.js":[2035,9755],"./Emoklore":[8686,5620],"./Emoklore.js":[8686,5620],"./EndBreaker":[4869,3515],"./EndBreaker.js":[4869,3515],"./EtrianOdysseySRS":[3460,1851],"./EtrianOdysseySRS.js":[3460,1851],"./FateCoreSystem":[5925,5899],"./FateCoreSystem.js":[5925,5899],"./Fiasco":[6587,6739],"./Fiasco.js":[6587,6739],"./Fiasco_Korean":[3734,7036],"./Fiasco_Korean.js":[3734,7036],"./FilledWith":[4239,6705],"./FilledWith.js":[4239,6705],"./FullMetalPanic":[1959,8725],"./FullMetalPanic.js":[1959,8725],"./FutariSousa":[2729,4564],"./FutariSousa.js":[2729,4564],"./FutariSousa_Korean":[6326,8175],"./FutariSousa_Korean.js":[6326,8175],"./GURPS":[7782,6908],"./GURPS.js":[7782,6908],"./Garako":[1948,8165],"./Garako.js":[1948,8165],"./GardenOrder":[2017,172],"./GardenOrder.js":[2017,172],"./GehennaAn":[1647,5105],"./GehennaAn.js":[1647,5105],"./GeishaGirlwithKatana":[5593,8780],"./GeishaGirlwithKatana.js":[5593,8780],"./GhostLive":[4656,9626],"./GhostLive.js":[4656,9626],"./GoblinSlayer":[3983,2006],"./GoblinSlayer.js":[3983,2006],"./GoldenSkyStories":[3437,9940],"./GoldenSkyStories.js":[3437,9940],"./Gorilla":[6362,7576],"./Gorilla.js":[6362,7576],"./GranCrest":[7150,6613],"./GranCrest.js":[7150,6613],"./Gundog":[8166,6501],"./Gundog.js":[8166,6501],"./GundogRevised":[4196,427],"./GundogRevised.js":[4196,427],"./GundogZero":[5273,493],"./GundogZero.js":[5273,493],"./GurpsFW":[882,6949],"./GurpsFW.js":[882,6949],"./HarnMaster":[6765,4075],"./HarnMaster.js":[6765,4075],"./HatsuneMiku":[3124,6589],"./HatsuneMiku.js":[3124,6589],"./Hieizan":[7418,8171],"./Hieizan.js":[7418,8171],"./HouraiGakuen":[7945,7155],"./HouraiGakuen.js":[7945,7155],"./HunterTheReckoning5th":[7434,3191],"./HunterTheReckoning5th.js":[7434,3191],"./HuntersMoon":[4873,1909],"./HuntersMoon.js":[4873,1909],"./IfIfIf":[7043,4507],"./IfIfIf.js":[7043,4507],"./Illusio":[3843,4796],"./Illusio.js":[3843,4796],"./InfiniteBabeL":[7878,7641],"./InfiniteBabeL.js":[7878,7641],"./InfiniteFantasia":[6391,391],"./InfiniteFantasia.js":[6391,391],"./Insane":[5844,9001],"./Insane.js":[5844,9001],"./Insane_Korean":[9199,1918],"./Insane_Korean.js":[9199,1918],"./Irisbane":[4167,6957],"./Irisbane.js":[4167,6957],"./IthaWenUa":[2726,9872],"./IthaWenUa.js":[2726,9872],"./JamesBond":[4866,7097],"./JamesBond.js":[4866,7097],"./JekyllAndHyde":[817,4788],"./JekyllAndHyde.js":[817,4788],"./JuinKansen":[9673,9327],"./JuinKansen.js":[9673,9327],"./Kamigakari":[2920,8602],"./Kamigakari.js":[2920,8602],"./Kamigakari_Korean":[6250,5309],"./Kamigakari_Korean.js":[6250,5309],"./KanColle":[4670,2098],"./KanColle.js":[4670,2098],"./Karukami":[2838,1616],"./Karukami.js":[2838,1616],"./KemonoNoMori":[1151,3962],"./KemonoNoMori.js":[1151,3962],"./KillDeathBusiness":[744,6750],"./KillDeathBusiness.js":[744,6750],"./KillDeathBusiness_Korean":[346,4401],"./KillDeathBusiness_Korean.js":[346,4401],"./KurayamiCrying":[5627,164],"./KurayamiCrying.js":[5627,164],"./Kutulu":[76,8790],"./Kutulu.js":[76,8790],"./LiveraDoll":[6459,8440],"./LiveraDoll.js":[6459,8440],"./LogHorizon":[8991,4810],"./LogHorizon.js":[8991,4810],"./LogHorizon_Korean":[8959,348],"./LogHorizon_Korean.js":[8959,348],"./LostRecord":[6543,7171],"./LostRecord.js":[6543,7171],"./LostRoyal":[9348,9625],"./LostRoyal.js":[9348,9625],"./MagicaLogia":[5563,2399],"./MagicaLogia.js":[5563,2399],"./MagicaLogia_Korean":[2586,7729],"./MagicaLogia_Korean.js":[2586,7729],"./MagicaLogia_SimplifiedChinese":[3677,6875],"./MagicaLogia_SimplifiedChinese.js":[3677,6875],"./MeikyuDays":[3433,1493],"./MeikyuDays.js":[3433,1493],"./MeikyuKingdom":[9889,8326],"./MeikyuKingdom.js":[9889,8326],"./MeikyuKingdomBasic":[668,7016],"./MeikyuKingdomBasic.js":[668,7016],"./MetalHead":[1175,7276],"./MetalHead.js":[1175,7276],"./MetalHeadExtream":[1587,3062],"./MetalHeadExtream.js":[1587,3062],"./MetallicGuardian":[1245,2040],"./MetallicGuardian.js":[1245,2040],"./MonotoneMuseum":[4351,735],"./MonotoneMuseum.js":[4351,735],"./MonotoneMuseum_Korean":[3989,5249],"./MonotoneMuseum_Korean.js":[3989,5249],"./NSSQ":[6681,4238],"./NSSQ.js":[6681,4238],"./Nechronica":[8885,3532],"./Nechronica.js":[8885,3532],"./Nechronica_Korean":[4361,4116],"./Nechronica_Korean.js":[4361,4116],"./NeverCloud":[9447,3096],"./NeverCloud.js":[9447,3096],"./NightWizard":[7740,5811],"./NightWizard.js":[7740,5811],"./NightWizard3rd":[4933,3535],"./NightWizard3rd.js":[4933,3535],"./NightmareHunterDeep":[1387,298],"./NightmareHunterDeep.js":[1387,298],"./NinjaSlayer":[517,7381],"./NinjaSlayer.js":[517,7381],"./NjslyrBattle":[596,3443],"./NjslyrBattle.js":[596,3443],"./NobunagasBlackCastle":[1067,6652],"./NobunagasBlackCastle.js":[1067,6652],"./Nuekagami":[1848,3293],"./Nuekagami.js":[1848,3293],"./OneWayHeroics":[1989,3852],"./OneWayHeroics.js":[1989,3852],"./OracleEngine":[978,2989],"./OracleEngine.js":[978,2989],"./OrgaRain":[8614,644],"./OrgaRain.js":[8614,644],"./Oukahoushin3rd":[7133,3407],"./Oukahoushin3rd.js":[7133,3407],"./Paradiso":[2313,4246],"./Paradiso.js":[2313,4246],"./Paranoia":[6634,1031],"./Paranoia.js":[6634,1031],"./ParanoiaRebooted":[9628,5289],"./ParanoiaRebooted.js":[9628,5289],"./ParasiteBlood":[8073,1410],"./ParasiteBlood.js":[8073,1410],"./Pathfinder":[5017,1599],"./Pathfinder.js":[5017,1599],"./Peekaboo":[9309,844],"./Peekaboo.js":[9309,844],"./Pendragon":[9113,2311],"./Pendragon.js":[9113,2311],"./PersonaO":[6706,481],"./PersonaO.js":[6706,481],"./PhantasmAdventure":[926,8614],"./PhantasmAdventure.js":[926,8614],"./Postman":[3021,5124],"./Postman.js":[3021,5124],"./PulpCthulhu":[4292,9449],"./PulpCthulhu.js":[4292,9449],"./Raisondetre":[2909,293],"./Raisondetre.js":[2909,293],"./RecordOfLodossWar":[1925,281],"./RecordOfLodossWar.js":[1925,281],"./RecordOfSteam":[1293,2213],"./RecordOfSteam.js":[1293,2213],"./Revulture":[573,9886],"./Revulture.js":[573,9886],"./RokumonSekai2":[3592,9495],"./RokumonSekai2.js":[3592,9495],"./RoleMaster":[7612,2625],"./RoleMaster.js":[7612,2625],"./RuinBreakers":[1349,7696],"./RuinBreakers.js":[1349,7696],"./RuneQuest":[7543,7480],"./RuneQuest.js":[7543,7480],"./RyuTuber":[1287,1766],"./RyuTuber.js":[1287,1766],"./Ryutama":[8123,585],"./Ryutama.js":[8123,585],"./SRS":[5762,1377],"./SRS.js":[5762,1377],"./SajinsenkiAGuS":[4969,5034],"./SajinsenkiAGuS.js":[4969,5034],"./SamsaraBallad":[2255,2250],"./SamsaraBallad.js":[2255,2250],"./Satasupe":[8236,3314],"./Satasupe.js":[8236,3314],"./ScreamHighSchool":[7728,512],"./ScreamHighSchool.js":[7728,512],"./Sengensyou":[1369,3109],"./Sengensyou.js":[1369,3109],"./SevenFortressMobius":[2004,1091],"./SevenFortressMobius.js":[2004,1091],"./ShadowRun":[7633,8975],"./ShadowRun.js":[7633,8975],"./ShadowRun4":[8489,5925],"./ShadowRun4.js":[8489,5925],"./ShadowRun5":[3265,3665],"./ShadowRun5.js":[3265,3665],"./SharedFantasia":[554,2025],"./SharedFantasia.js":[554,2025],"./ShinMegamiTenseiKakuseihen":[6821,8657],"./ShinMegamiTenseiKakuseihen.js":[6821,8657],"./ShinkuuGakuen":[708,1763],"./ShinkuuGakuen.js":[708,1763],"./ShinobiGami":[1946,132],"./ShinobiGami.js":[1946,132],"./Shiranui":[9776,2709],"./Shiranui.js":[9776,2709],"./ShoujoTenrankai":[8491,8565],"./ShoujoTenrankai.js":[8491,8565],"./ShuumatsuKikou":[918,533],"./ShuumatsuKikou.js":[918,533],"./Skynauts":[8327,5150],"./Skynauts.js":[8327,5150],"./SkynautsBouken":[5444,303],"./SkynautsBouken.js":[5444,303],"./StarryDolls":[783,9354],"./StarryDolls.js":[783,9354],"./SteamPunkers":[6339,7103],"./SteamPunkers.js":[6339,7103],"./StellarKnights":[5849,628],"./StellarKnights.js":[5849,628],"./StellarKnights_Korean":[2795,6768],"./StellarKnights_Korean.js":[2795,6768],"./StellarLife":[8594,3740],"./StellarLife.js":[8594,3740],"./StrangerOfSwordCity":[5214,1593],"./StrangerOfSwordCity.js":[5214,1593],"./StratoShout":[203,8470],"./StratoShout.js":[203,8470],"./StratoShout_Korean":[2030,6114],"./StratoShout_Korean.js":[2030,6114],"./Strave":[1758,8233],"./Strave.js":[1758,8233],"./SwordWorld":[8250,3210],"./SwordWorld.js":[8250,3210],"./SwordWorld2_0":[3840,7043],"./SwordWorld2_0.js":[3840,7043],"./SwordWorld2_0_SimplifiedChinese":[206,8196],"./SwordWorld2_0_SimplifiedChinese.js":[206,8196],"./SwordWorld2_5":[9527,9753],"./SwordWorld2_5.js":[9527,9753],"./SwordWorld2_5_SimplifiedChinese":[8463,6152],"./SwordWorld2_5_SimplifiedChinese.js":[8463,6152],"./SwordWorld_SimplifiedChinese":[7184,9640],"./SwordWorld_SimplifiedChinese.js":[7184,9640],"./TalesFromTheLoop":[4331,1982],"./TalesFromTheLoop.js":[4331,1982],"./TenkaRyouran":[8650,7812],"./TenkaRyouran.js":[8650,7812],"./TherapieSein":[4028,5405],"./TherapieSein.js":[4028,5405],"./TokumeiTenkousei":[4905,5101],"./TokumeiTenkousei.js":[4905,5101],"./TokyoGhostResearch":[3874,2686],"./TokyoGhostResearch.js":[3874,2686],"./TokyoNova":[7459,7455],"./TokyoNova.js":[7459,7455],"./Torg":[3042,6604],"./Torg.js":[3042,6604],"./Torg1_5":[3257,8177],"./Torg1_5.js":[3257,8177],"./TorgEternity":[9543,9931],"./TorgEternity.js":[9543,9931],"./ToshiakiHolyGrailWar":[1641,4957],"./ToshiakiHolyGrailWar.js":[1641,4957],"./TrinitySeven":[8262,589],"./TrinitySeven.js":[8262,589],"./TunnelsAndTrolls":[6450,5188],"./TunnelsAndTrolls.js":[6450,5188],"./TwilightGunsmoke":[4547,6331],"./TwilightGunsmoke.js":[4547,6331],"./UnsungDuet":[6694,1209],"./UnsungDuet.js":[6694,1209],"./Utakaze":[5520,357],"./Utakaze.js":[5520,357],"./VampireTheMasquerade5th":[6409,7115],"./VampireTheMasquerade5th.js":[6409,7115],"./Villaciel":[6633,4906],"./Villaciel.js":[6633,4906],"./VisionConnect":[2527,35],"./VisionConnect.js":[2527,35],"./WARPS":[8581,1380],"./WARPS.js":[8581,1380],"./WaresBlade":[9840,4213],"./WaresBlade.js":[9840,4213],"./Warhammer":[9883,7339],"./Warhammer.js":[9883,7339],"./Warhammer4":[2135,4837],"./Warhammer4.js":[2135,4837],"./WitchQuest":[3617,6088],"./WitchQuest.js":[3617,6088],"./WorldOfDarkness":[3350,3726],"./WorldOfDarkness.js":[3350,3726],"./WorldsEndFrontline":[2118,1795],"./WorldsEndFrontline.js":[2118,1795],"./YankeeYogSothoth":[1930,7906],"./YankeeYogSothoth.js":[1930,7906],"./YearZeroEngine":[929,6632],"./YearZeroEngine.js":[929,6632],"./Yggdrasill":[7157,6467],"./Yggdrasill.js":[7157,6467],"./ZettaiReido":[6698,4999],"./ZettaiReido.js":[6698,4999]};function H(J){if(!me.o(d,J))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+J+"'");throw O.code="MODULE_NOT_FOUND",O});var _=d[J],x=_[0];return me.e(_[1]).then(()=>me.t(x,23))}H.keys=()=>Object.keys(d),H.id=85,E.exports=H},6507:(E,le,me)=>{var d={"./Amadeus.ja_jp.json":[6070,9299],"./Amadeus.ko_kr.json":[765,4092],"./Arianrhod.ja_jp.json":[7267,8206],"./BeginningIdol.ja_jp.json":[5355,8635],"./BeginningIdol.ko_kr.json":[2590,6961],"./Cthulhu.ja_jp.json":[8128,652],"./Cthulhu.ko_kr.json":[7002,2617],"./Cthulhu.zh_hans.json":[4209,4922],"./Cthulhu.zh_hant.json":[8021,3147],"./DetatokoSaga.ja_jp.json":[4608,5777],"./DetatokoSaga.ko_kr.json":[408,4502],"./DoubleCross.ja_jp.json":[9221,8706],"./DoubleCross.ko_kr.json":[9734,8517],"./Dracurouge.ja_jp.json":[2286,2847],"./Dracurouge.ko_kr.json":[3597,155],"./Emoklore.ja_jp.json":[8985,6488],"./Fiasco.ja_jp.json":[9873,1800],"./Fiasco.ko_kr.json":[5244,783],"./FutariSousa.ja_jp.json":[9491,8078],"./FutariSousa.ko_kr.json":[8721,9567],"./Insane.ja_jp.json":[5040,6446],"./Insane.ko_kr.json":[5488,3978],"./Kamigakari.ja_jp.json":[2742,3922],"./Kamigakari.ko_kr.json":[7708,1197],"./KillDeathBusiness.ja_jp.json":[2288,3760],"./KillDeathBusiness.ko_kr.json":[1847,287],"./LogHorizon.ja_jp.json":[6438,3811],"./LogHorizon.ko_kr.json":[8319,5106],"./MagicaLogia.ja_jp.json":[4786,9120],"./MagicaLogia.ko_kr.json":[339,2107],"./MagicaLogia.zh_hans.json":[9116,3229],"./MonotoneMuseum.ja_jp.json":[5628,7848],"./MonotoneMuseum.ko_kr.json":[1302,8157],"./Nechronica.ja_jp.json":[9437,667],"./Nechronica.ko_kr.json":[4241,7743],"./StellarKnights.ja_jp.json":[7251,9206],"./StellarKnights.ko_kr.json":[6697,5717],"./StratoShout.ja_jp.json":[7313,7015],"./StratoShout.ko_kr.json":[424,4113],"./SwordWorld.ja_jp.json":[1243,7348],"./SwordWorld.zh_hans.json":[715,654],"./SwordWorld2_0.ja_jp.json":[7547,5351],"./SwordWorld2_0.zh_hans.json":[7912,5642],"./SwordWorld2_5.ja_jp.json":[8368,669],"./SwordWorld2_5.zh_hans.json":[9860,2597]};function H(J){if(!me.o(d,J))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+J+"'");throw O.code="MODULE_NOT_FOUND",O});var _=d[J],x=_[0];return me.e(_[1]).then(()=>me.t(x,19))}H.keys=()=>Object.keys(d),H.id=6507,E.exports=H},2480:()=>{},5861:(E,le,me)=>{"use strict";function d(J,_,x,O,w,K,G){try{var A=J[K](G),U=A.value}catch(N){return void x(N)}A.done?_(U):Promise.resolve(U).then(O,w)}function H(J){return function(){var _=this,x=arguments;return new Promise(function(O,w){var K=J.apply(_,x);function G(U){d(K,O,w,G,A,"next",U)}function A(U){d(K,O,w,G,A,"throw",U)}G(void 0)})}}me.d(le,{Z:()=>H})},4682:E=>{"use strict";E.exports=JSON.parse('{"gameSystems":[{"id":"MeikyuKingdom","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0","className":"MeikyuKingdom","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080","locale":"ja_jp"},{"id":"AceKillerGene","name":"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3","className":"AceKillerGene","superClassName":"GardenOrder","sortKey":"\u3048\u3048\u3059\u304d\u3089\u3042\u3057\u3044\u3093","locale":"ja_jp"},{"id":"GardenOrder","name":"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc","className":"GardenOrder","superClassName":"Base","sortKey":"\u304b\u3042\u3066\u3093\u304a\u304a\u305f\u3042","locale":"ja_jp"},{"id":"SajinsenkiAGuS","name":"\u7802\u5875\u6226\u6a5f\u30a2\u30fc\u30ac\u30b9","className":"SajinsenkiAGuS","superClassName":"Base","sortKey":"\u3055\u3057\u3093\u305b\u3093\u304d\u3042\u3042\u304b\u3059","locale":"ja_jp"},{"id":"Chill3","name":"Chill 3rd Edition","className":"Chill3","superClassName":"Base","sortKey":"\u3061\u308b3","locale":"ja_jp"},{"id":"SamsaraBallad","name":"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9","className":"SamsaraBallad","superClassName":"Base","sortKey":"\u3055\u3093\u3055\u3042\u3089\u306f\u3089\u3064\u3068","locale":"ja_jp"},{"id":"CodeLayerd","name":"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9","className":"CodeLayerd","superClassName":"Base","sortKey":"\u3053\u304a\u3068\u308c\u3044\u3084\u3042\u3068","locale":"ja_jp"},{"id":"EmbryoMachine","name":"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG","className":"EmbryoMachine","superClassName":"Base","sortKey":"\u3048\u3080\u3075\u308a\u304a\u307e\u3057\u3093RPG","locale":"ja_jp"},{"id":"Satasupe","name":"\u30b5\u30bf\u30b9\u30da","className":"Satasupe","superClassName":"Base","sortKey":"\u3055\u305f\u3059\u3078","locale":"ja_jp"},{"id":"Ainecadette","name":"\u30a8\u30cd\u30ab\u30c7\u30c3\u30c8","className":"Ainecadette","superClassName":"Base","sortKey":"\u3048\u306d\u304b\u3066\u3064\u3068","locale":"ja_jp"},{"id":"ColossalHunter","name":"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc","className":"ColossalHunter","superClassName":"Base","sortKey":"\u3053\u308d\u3064\u3055\u308b\u306f\u3093\u305f\u3042","locale":"ja_jp"},{"id":"Emoklore","name":"\u30a8\u30e2\u30af\u30ed\u30a2TRPG","className":"Emoklore","superClassName":"Base","sortKey":"\u3048\u3082\u304f\u308d\u3042TRPG","locale":"ja_jp"},{"id":"Airgetlamh","name":"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0","className":"Airgetlamh","superClassName":"Base","sortKey":"\u3042\u3051\u306e\u3053\u3068\u3046\u306e\u3048\u3042\u3051\u3068\u3089\u3080","locale":"ja_jp"},{"id":"EndBreaker","name":"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01","className":"EndBreaker","superClassName":"Base","sortKey":"\u3048\u3093\u3068\u3075\u308c\u3044\u304b\u3042","locale":"ja_jp"},{"id":"EtrianOdysseySRS","name":"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS","className":"EtrianOdysseySRS","superClassName":"SRS","sortKey":"\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046SRS","locale":"ja_jp"},{"id":"FateCoreSystem","name":"Fate Core System","className":"FateCoreSystem","superClassName":"Base","sortKey":"\u3075\u3048\u3044\u3068\u3053\u3042\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"Comes","name":"\u30ab\u30e0\u30ba","className":"Comes","superClassName":"Base","sortKey":"\u304b\u3080\u3059","locale":"ja_jp"},{"id":"AlchemiaStruggle","name":"\u30a2\u30eb\u30b1\u30df\u30a2\u30fb\u30b9\u30c8\u30e9\u30b0\u30eb","className":"AlchemiaStruggle","superClassName":"Base","sortKey":"\u3042\u308b\u3051\u307f\u3042\u3059\u3068\u3089\u304f\u308b","locale":"ja_jp"},{"id":"ConvictorDrive","name":"\u30b3\u30f3\u30f4\u30a3\u30af\u30bf\u30fc\u30fb\u30c9\u30e9\u30a4\u30d6","className":"ConvictorDrive","superClassName":"Base","sortKey":"\u3053\u3093\u3046\u3044\u304f\u305f\u3042\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"CrashWorld","name":"\u589c\u843d\u4e16\u754c","className":"CrashWorld","superClassName":"Base","sortKey":"\u3064\u3044\u3089\u304f\u305b\u304b\u3044","locale":"ja_jp"},{"id":"Fiasco","name":"\u30d5\u30a3\u30a2\u30b9\u30b3","className":"Fiasco","superClassName":"Base","sortKey":"\u3075\u3044\u3042\u3059\u3053","locale":"ja_jp"},{"id":"Cthulhu","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"Fiasco:Korean","name":"\ud53c\uc544\uc2a4\ucf54","className":"Fiasco_Korean","superClassName":"Fiasco","sortKey":"\u56fd\u969b\u5316:Korean:\ud53c\uc544\uc2a4\ucf54","locale":"ko_kr"},{"id":"FilledWith","name":"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"FilledWith","superClassName":"Base","sortKey":"\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"VisionConnect","name":"\u30f4\u30a3\u30b8\u30e7\u30f3\u30b3\u30cd\u30af\u30c8","className":"VisionConnect","superClassName":"Base","sortKey":"\u3046\u3044\u3057\u3088\u3093\u3053\u306d\u304f\u3068","locale":"ja_jp"},{"id":"ScreamHighSchool","name":"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb","className":"ScreamHighSchool","superClassName":"GardenOrder","sortKey":"\u3059\u304f\u308a\u3044\u3080\u306f\u3044\u3059\u304f\u3046\u308b","locale":"ja_jp"},{"id":"Alsetto","name":"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","className":"Alsetto","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305f\u306e\u3042\u308b\u305b\u3064\u3068","locale":"ja_jp"},{"id":"WaresBlade","name":"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9","className":"WaresBlade","superClassName":"Base","sortKey":"\u308f\u3042\u3059\u3075\u308c\u3044\u3068","locale":"ja_jp"},{"id":"WARPS","name":"\u30ef\u30fc\u30d7\u30b9","className":"WARPS","superClassName":"Base","sortKey":"\u308f\u3042\u3075\u3059","locale":"ja_jp"},{"id":"Alshard","name":"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9","className":"Alshard","superClassName":"SRS","sortKey":"\u3042\u308b\u3057\u3084\u3042\u3068","locale":"ja_jp"},{"id":"SRS","name":"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","className":"SRS","superClassName":"Base","sortKey":"\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"Sengensyou","name":"\u5343\u5e7b\u6284","className":"Sengensyou","superClassName":"Base","sortKey":"\u305b\u3093\u3051\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"Cthulhu7th","name":"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu7th","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"SevenFortressMobius","name":"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9","className":"SevenFortressMobius","superClassName":"NightWizard","sortKey":"\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059","locale":"ja_jp"},{"id":"ShadowRun","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3","className":"ShadowRun","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u3093","locale":"ja_jp"},{"id":"ShadowRun4","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition","className":"ShadowRun4","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30934","locale":"ja_jp"},{"id":"Warhammer","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc","className":"Warhammer","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u3042","locale":"ja_jp"},{"id":"ShadowRun5","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition","className":"ShadowRun5","superClassName":"ShadowRun4","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30935","locale":"ja_jp"},{"id":"SharedFantasia","name":"Shared\u2020Fantasia","className":"SharedFantasia","superClassName":"Base","sortKey":"\u3057\u3048\u3042\u3042\u3068\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"ShinMegamiTenseiKakuseihen","name":"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7","className":"ShinMegamiTenseiKakuseihen","superClassName":"Base","sortKey":"\u3057\u3093\u3081\u304b\u307f\u3066\u3093\u305b\u3044TRPG\u304b\u304f\u305b\u3044\u3078\u3093","locale":"ja_jp"},{"id":"ShinkuuGakuen","name":"\u771f\u7a7a\u5b66\u5712","className":"ShinkuuGakuen","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3046\u304b\u304f\u3048\u3093","locale":"ja_jp"},{"id":"Warhammer4","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fcRPG\u7b2c4\u7248","className":"Warhammer4","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u30424","locale":"ja_jp"},{"id":"FullMetalPanic","name":"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG","className":"FullMetalPanic","superClassName":"SRS","sortKey":"\u3075\u308b\u3081\u305f\u308b\u306f\u306b\u3064\u304fRPG","locale":"ja_jp"},{"id":"FutariSousa","name":"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5","className":"FutariSousa","superClassName":"Base","sortKey":"\u3075\u305f\u308a\u305d\u3046\u3055","locale":"ja_jp"},{"id":"AlterRaise","name":"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","className":"AlterRaise","superClassName":"Base","sortKey":"\u3042\u308b\u3068\u308c\u3044\u3059","locale":"ja_jp"},{"id":"FutariSousa:Korean","name":"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)","className":"FutariSousa_Korean","superClassName":"FutariSousa","sortKey":"\u56fd\u969b\u5316:Korean:\ub458\uc774\uc11c \uc218\uc0ac","locale":"ko_kr"},{"id":"Garako","name":"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854","className":"Garako","superClassName":"Base","sortKey":"\u304b\u3089\u3053\u3068\u306f\u304b\u3044\u306e\u3068\u3046","locale":"ja_jp"},{"id":"MeikyuKingdomBasic","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af","className":"MeikyuKingdomBasic","superClassName":"MeikyuKingdom","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080\u304d\u307b\u3093\u308b\u3046\u308b\u3075\u3064\u304f","locale":"ja_jp"},{"id":"WitchQuest","name":"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8","className":"WitchQuest","superClassName":"Base","sortKey":"\u3046\u3044\u3064\u3061\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"Amadeus","name":"\u30a2\u30de\u30c7\u30a6\u30b9","className":"Amadeus","superClassName":"Base","sortKey":"\u3042\u307e\u3066\u3046\u3059","locale":"ja_jp"},{"id":"GehennaAn","name":"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9","className":"GehennaAn","superClassName":"Base","sortKey":"\u3051\u3078\u306a\u3042\u306a\u3059\u305f\u3057\u3059","locale":"ja_jp"},{"id":"WorldOfDarkness","name":"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9","className":"WorldOfDarkness","superClassName":"Base","sortKey":"\u308f\u3042\u308b\u3068\u304a\u3075\u305f\u3042\u304f\u306d\u3059","locale":"ja_jp"},{"id":"GeishaGirlwithKatana","name":"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca","className":"GeishaGirlwithKatana","superClassName":"Base","sortKey":"\u3051\u3044\u3057\u3084\u304b\u3042\u308b\u3046\u3044\u3059\u304b\u305f\u306a","locale":"ja_jp"},{"id":"WorldsEndFrontline","name":"\u30ef\u30fc\u30eb\u30c9\u30a8\u30f3\u30c9\u30d5\u30ed\u30f3\u30c8\u30e9\u30a4\u30f3","className":"WorldsEndFrontline","superClassName":"Bloodorium","sortKey":"\u308f\u3042\u308b\u3068\u3048\u3093\u3068\u3075\u308d\u3093\u3068\u3089\u3044\u3093","locale":"ja_jp"},{"id":"Amadeus:Korean","name":"\uc544\ub9c8\ub370\uc6b0\uc2a4","className":"Amadeus_Korean","superClassName":"Amadeus","sortKey":"\u56fd\u969b\u5316:Korean:\uc544\ub9c8\ub370\uc6b0\uc2a4","locale":"ko_kr"},{"id":"YankeeYogSothoth","name":"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9","className":"YankeeYogSothoth","superClassName":"Base","sortKey":"\u3084\u3093\u304d\u3044\u3042\u3093\u3068\u3088\u304f\u305d\u3068\u304a\u3059","locale":"ja_jp"},{"id":"AngelGear","name":"\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon","className":"AngelGear","superClassName":"Base","sortKey":"\u3048\u3093\u305b\u308b\u304d\u30422","locale":"ja_jp"},{"id":"YearZeroEngine","name":"YearZeroEngine","className":"YearZeroEngine","superClassName":"Base","sortKey":"\u3044\u3084\u3042\u305b\u308d\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"ShinobiGami","name":"\u30b7\u30ce\u30d3\u30ac\u30df","className":"ShinobiGami","superClassName":"Base","sortKey":"\u3057\u306e\u3072\u304b\u307f","locale":"ja_jp"},{"id":"AnimaAnimus","name":"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9","className":"AnimaAnimus","superClassName":"Base","sortKey":"\u3042\u306b\u307e\u3042\u306b\u3080\u3059","locale":"ja_jp"},{"id":"GhostLive","name":"\u5b9f\u6cc1\u30b4\u30fc\u30b9\u30c8\u30e9\u30a4\u30f4","className":"GhostLive","superClassName":"Base","sortKey":"\u3057\u3064\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"GoblinSlayer","name":"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"GoblinSlayer","superClassName":"Base","sortKey":"\u3053\u3075\u308a\u3093\u3059\u308c\u3044\u3084\u3042TRPG","locale":"ja_jp"},{"id":"Aoharubaan","name":"\u3042\u304a\u306f\u308b\u3070\u30fc\u3093\u3063","className":"Aoharubaan","superClassName":"Base","sortKey":"\u3042\u304a\u306f\u308b\u306f\u3042\u3093\u3064","locale":"ja_jp"},{"id":"Cthulhu7th:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","className":"Cthulhu7th_ChineseTraditional","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","locale":"ja_jp"},{"id":"Shiranui","name":"\u4e0d\u77e5\u706b","className":"Shiranui","superClassName":"Base","sortKey":"\u3057\u3089\u306c\u3044","locale":"ja_jp"},{"id":"Yggdrasill","name":"\u92fc\u9244\u306e\u30e6\u30b0\u30c9\u30e9\u30b7\u30eb","className":"Yggdrasill","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3064\u306e\u3086\u304f\u3068\u3089\u3057\u308b","locale":"ja_jp"},{"id":"ShuumatsuKikou","name":"\u7d42\u672b\u7d00\u884c\uff32\uff30\uff27","className":"ShuumatsuKikou","superClassName":"Base","sortKey":"\u3057\u3086\u3046\u307e\u3064\u304d\u3053\u3046","locale":"ja_jp"},{"id":"Arianrhod","name":"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG","className":"Arianrhod","superClassName":"Base","sortKey":"\u3042\u308a\u3042\u3093\u308d\u3064\u3068RPG","locale":"ja_jp"},{"id":"Cthulhu7th:Korean","name":"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","className":"Cthulhu7th_Korean","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","locale":"ja_jp"},{"id":"CthulhuTech","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af","className":"CthulhuTech","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f","locale":"ja_jp"},{"id":"ArsMagica","name":"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab","className":"ArsMagica","superClassName":"Base","sortKey":"\u3042\u308b\u3059\u307e\u304d\u304b","locale":"ja_jp"},{"id":"GoldenSkyStories","name":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","className":"GoldenSkyStories","superClassName":"Base","sortKey":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","locale":"ja_jp"},{"id":"Gorilla","name":"\u30b4\u30ea\u30e9TRPG","className":"Gorilla","superClassName":"Base","sortKey":"\u3053\u308a\u3089TRPG","locale":"ja_jp"},{"id":"GranCrest","name":"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG","className":"GranCrest","superClassName":"Base","sortKey":"\u304f\u3089\u3093\u304f\u308c\u3059\u3068RPG","locale":"ja_jp"},{"id":"Gundog","name":"\u30ac\u30f3\u30c9\u30c3\u30b0","className":"Gundog","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f","locale":"ja_jp"},{"id":"GundogRevised","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9","className":"GundogRevised","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f\u308a\u3046\u3042\u3044\u3059\u3068","locale":"ja_jp"},{"id":"Skynauts","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09","className":"Skynauts","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064","locale":"ja_jp"},{"id":"GundogZero","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed","className":"GundogZero","superClassName":"Gundog","sortKey":"\u304b\u3093\u3068\u3064\u304f\u305b\u308d","locale":"ja_jp"},{"id":"AssaultEngine","name":"\u30a2\u30b5\u30eb\u30c8\u30a8\u30f3\u30b8\u30f3","className":"AssaultEngine","superClassName":"Base","sortKey":"\u3042\u3055\u308b\u3068\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"GURPS","name":"\u30ac\u30fc\u30d7\u30b9","className":"GURPS","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059","locale":"ja_jp"},{"id":"MetalHead","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9","className":"MetalHead","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068","locale":"ja_jp"},{"id":"Cthulhu:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71","className":"Cthulhu_ChineseTraditional","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71","locale":"zh_hant"},{"id":"Avandner","name":"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc","className":"Avandner","superClassName":"Base","sortKey":"\u3053\u3064\u3051\u3093\u306e\u3042\u3046\u3042\u3093\u3068\u306a\u3042","locale":"ja_jp"},{"id":"Ayabito","name":"\u3042\u3084\u3073\u3068","className":"Ayabito","superClassName":"Base","sortKey":"\u3042\u3084\u3072\u3068","locale":"ja_jp"},{"id":"Cthulhu:Korean","name":"\ud06c\ud234\ub8e8","className":"Cthulhu_Korean","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8","locale":"ko_kr"},{"id":"Cthulhu:SimplifiedChinese","name":"\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","className":"Cthulhu_SimplifiedChinese","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","locale":"zh_hans"},{"id":"CyberpunkRed","name":"\u30b5\u30a4\u30d0\u30fc\u30d1\u30f3\u30afRED","className":"CyberpunkRed","superClassName":"Base","sortKey":"\u3055\u3044\u306f\u3042\u306f\u3093\u304f\u308c\u3064\u3068","locale":"ja_jp"},{"id":"GurpsFW","name":"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"GurpsFW","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"MetalHeadExtream","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0","className":"MetalHeadExtream","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068\u3048\u304f\u3059\u3068\u308a\u3044\u3080","locale":"ja_jp"},{"id":"Bakenokawa","name":"\u30d0\u30b1\u30ce\u30ab\u30ef","className":"Bakenokawa","superClassName":"Base","sortKey":"\u306f\u3051\u306e\u304b\u308f","locale":"ja_jp"},{"id":"SkynautsBouken","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09","className":"SkynautsBouken","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642","locale":"ja_jp"},{"id":"BBN","name":"BBNTRPG","className":"BBN","superClassName":"Base","sortKey":"\u3072\u3044\u3072\u3044\u3048\u306cTRPG","locale":"ja_jp"},{"id":"ZettaiReido","name":"\u7d76\u5bfe\u96b7\u5974","className":"ZettaiReido","superClassName":"Base","sortKey":"\u305b\u3064\u305f\u3044\u308c\u3044\u3068","locale":"ja_jp"},{"id":"BadLife","name":"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","className":"BadLife","superClassName":"Base","sortKey":"\u306f\u3064\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"HarnMaster","name":"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc","className":"HarnMaster","superClassName":"Base","sortKey":"\u306f\u3042\u3093\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"StarryDolls","name":"\u30b9\u30bf\u30ea\u30a3\u30c9\u30fc\u30eb","className":"StarryDolls","superClassName":"Base","sortKey":"\u3059\u305f\u308a\u3044\u3068\u304a\u308b","locale":"ja_jp"},{"id":"SteamPunkers","name":"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba","className":"SteamPunkers","superClassName":"Base","sortKey":"\u3059\u3061\u3044\u3080\u306f\u3093\u304b\u3042\u3059","locale":"ja_jp"},{"id":"HatsuneMiku","name":"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3","className":"HatsuneMiku","superClassName":"Base","sortKey":"\u306f\u3064\u306d\u307f\u304fTRPG\u3053\u3053\u308d\u305f\u3093\u3057\u3088\u3093","locale":"ja_jp"},{"id":"BarnaKronika","name":"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab","className":"BarnaKronika","superClassName":"Base","sortKey":"\u306f\u308b\u306a\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"StellarKnights","name":"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4","className":"StellarKnights","superClassName":"Base","sortKey":"\u304d\u3093\u3051\u3093\u306e\u3059\u3066\u3089\u306a\u3044\u3064","locale":"ja_jp"},{"id":"DarkBlaze","name":"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba","className":"DarkBlaze","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3075\u308c\u3044\u3059","locale":"ja_jp"},{"id":"Hieizan","name":"\u6bd4\u53e1\u5c71\u708e\u4e0a","className":"Hieizan","superClassName":"Base","sortKey":"\u3072\u3048\u3044\u3055\u3093\u3048\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"HouraiGakuen","name":"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!","className":"HouraiGakuen","superClassName":"Base","sortKey":"\u307b\u3046\u3089\u3044\u304b\u304f\u3048\u3093\u306e\u307b\u3046\u3051\u3093","locale":"ja_jp"},{"id":"MonotoneMuseum","name":"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG","className":"MonotoneMuseum","superClassName":"Base","sortKey":"\u3082\u306e\u3068\u304a\u3093\u307f\u3086\u3046\u3057\u3042\u3080RPG","locale":"ja_jp"},{"id":"MetallicGuardian","name":"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG","className":"MetallicGuardian","superClassName":"SRS","sortKey":"\u3081\u305f\u308a\u3064\u304f\u304b\u3042\u3066\u3044\u3042\u3093RPG","locale":"ja_jp"},{"id":"MonotoneMuseum:Korean","name":"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","className":"MonotoneMuseum_Korean","superClassName":"MonotoneMuseum","sortKey":"\u56fd\u969b\u5316:Korean:\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","locale":"ko_kr"},{"id":"Nechronica","name":"\u30cd\u30af\u30ed\u30cb\u30ab","className":"Nechronica","superClassName":"Base","sortKey":"\u306d\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"StellarKnights:Korean","name":"\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","className":"StellarKnights_Korean","superClassName":"StellarKnights","sortKey":"\u56fd\u969b\u5316:Korean:\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","locale":"ko_kr"},{"id":"BattleTech","name":"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af","className":"BattleTech","superClassName":"Base","sortKey":"\u306f\u3068\u308b\u3066\u3064\u304f","locale":"ja_jp"},{"id":"DarkDaysDrive","name":"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6","className":"DarkDaysDrive","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3066\u3044\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"StellarLife","name":"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG","className":"StellarLife","superClassName":"Base","sortKey":"\u3059\u3066\u3089\u3042\u3089\u3044\u3075TRPG","locale":"ja_jp"},{"id":"DarkSouls","name":"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG","className":"DarkSouls","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u305d\u3046\u308bTRPG","locale":"ja_jp"},{"id":"Nechronica:Korean","name":"\ub124\ud06c\ub85c\ub2c8\uce74","className":"Nechronica_Korean","superClassName":"Nechronica","sortKey":"\u56fd\u969b\u5316:Korean:\ub124\ud06c\ub85c\ub2c8\uce74","locale":"ko_kr"},{"id":"NeverCloud","name":"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG","className":"NeverCloud","superClassName":"Base","sortKey":"\u306d\u306f\u3042\u304f\u3089\u3046\u3068TRPG","locale":"ja_jp"},{"id":"StrangerOfSwordCity","name":"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","className":"StrangerOfSwordCity","superClassName":"Base","sortKey":"\u3064\u308b\u304d\u306e\u307e\u3061\u306e\u3044\u307b\u3046\u3057\u3093TRPG","locale":"ja_jp"},{"id":"StratoShout","name":"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8","className":"StratoShout","superClassName":"Base","sortKey":"\u3059\u3068\u3089\u3068\u3057\u3084\u3046\u3068","locale":"ja_jp"},{"id":"StratoShout:Korean","name":"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","className":"StratoShout_Korean","superClassName":"StratoShout","sortKey":"\u56fd\u969b\u5316:Korean:\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","locale":"ko_kr"},{"id":"Strave","name":"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4","className":"Strave","superClassName":"Base","sortKey":"\u3078\u304d\u304f\u3046\u306e\u3059\u3068\u308c\u3044\u3075","locale":"ja_jp"},{"id":"NightWizard","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition","className":"NightWizard","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682","locale":"ja_jp"},{"id":"DeadlineHeroes","name":"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG","className":"DeadlineHeroes","superClassName":"Base","sortKey":"\u3066\u3064\u3068\u3089\u3044\u3093\u3072\u3044\u308d\u304a\u3059RPG","locale":"ja_jp"},{"id":"SwordWorld","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG","className":"SwordWorld","superClassName":"Base","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u3068","locale":"ja_jp"},{"id":"HuntersMoon","name":"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3","className":"HuntersMoon","superClassName":"Base","sortKey":"\u306f\u3093\u305f\u3042\u3059\u3080\u3046\u3093","locale":"ja_jp"},{"id":"HunterTheReckoning5th","name":"Hunter: The Reckoning 5th Edition","className":"HunterTheReckoning5th","superClassName":"Base","sortKey":"\u306f\u3093\u3042\u305f\u3055\u308c\u3053\u306b\u3093\u304f5","locale":"ja_jp"},{"id":"NightWizard3rd","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition","className":"NightWizard3rd","superClassName":"NightWizard","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683","locale":"ja_jp"},{"id":"NightmareHunterDeep","name":"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc=\u30c7\u30a3\u30fc\u30d7","className":"NightmareHunterDeep","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3081\u3042\u306f\u3093\u305f\u3042\u3066\u3044\u3044\u3075","locale":"ja_jp"},{"id":"DemonParasite","name":"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8","className":"DemonParasite","superClassName":"Base","sortKey":"\u3066\u3082\u3093\u306f\u3089\u3055\u3044\u3068","locale":"ja_jp"},{"id":"NinjaSlayer","name":"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"NinjaSlayer","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG","locale":"ja_jp"},{"id":"IfIfIf","name":"\u30a4\u30d5\u30fb\u30a4\u30d5\u30fb\u30a4\u30d5","className":"IfIfIf","superClassName":"Base","sortKey":"\u3044\u3075\u3044\u3075\u3044\u3075","locale":"ja_jp"},{"id":"DesperateRun","name":"Desperate Run TRPG","className":"DesperateRun","superClassName":"Base","sortKey":"\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG","locale":"ja_jp"},{"id":"BeastBindTrinity","name":"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3","className":"BeastBindTrinity","superClassName":"Base","sortKey":"\u3072\u3044\u3059\u3068\u306f\u3044\u3093\u3068\u3068\u308a\u306b\u3066\u3044","locale":"ja_jp"},{"id":"DetatokoSaga","name":"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac","className":"DetatokoSaga","superClassName":"Base","sortKey":"\u3066\u305f\u3068\u3053\u3055\u3042\u304b","locale":"ja_jp"},{"id":"NjslyrBattle","name":"NJSLYRBATTLE","className":"NjslyrBattle","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042\u306f\u3068\u308b","locale":"ja_jp"},{"id":"NobunagasBlackCastle","name":"\u4fe1\u9577\u306e\u9ed2\u3044\u57ce","className":"NobunagasBlackCastle","superClassName":"Base","sortKey":"\u306e\u3075\u306a\u304b\u306e\u304f\u308d\u3044\u3057\u308d","locale":"ja_jp"},{"id":"DetatokoSaga:Korean","name":"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","className":"DetatokoSaga_Korean","superClassName":"DetatokoSaga","sortKey":"\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","locale":"ko_kr"},{"id":"DiceOfTheDead","name":"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9","className":"DiceOfTheDead","superClassName":"Base","sortKey":"\u305f\u3044\u3059\u304a\u3075\u3055\u3066\u3064\u3068","locale":"ja_jp"},{"id":"Illusio","name":"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","className":"Illusio","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3093\u306e\u3044\u308b\u3046\u3057\u304a","locale":"ja_jp"},{"id":"DoubleCross","name":"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","className":"DoubleCross","superClassName":"Base","sortKey":"\u305f\u3075\u308b\u304f\u308d\u30592","locale":"ja_jp"},{"id":"NSSQ","name":"SRS\u3058\u3083\u306a\u3044\u4e16\u754c\u6a39\u306e\u8ff7\u5baeTRPG","className":"NSSQ","superClassName":"Base","sortKey":"\u3048\u3059\u3042\u3042\u308b\u3048\u3059\u3057\u3084\u306a\u3044\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046TRPG","locale":"ja_jp"},{"id":"SwordWorld2.0","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0","className":"SwordWorld2_0","superClassName":"SwordWorld","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0","locale":"ja_jp"},{"id":"InfiniteBabeL","name":"\u5c11\u5e74\u306e\u305f\u3081\u306e\u5c11\u5973\u5c55\u721b\u4f1a\u7570\u805e Infinite BabeL","className":"InfiniteBabeL","superClassName":"ShoujoTenrankai","sortKey":"\u3057\u3088\u3046\u306d\u3093\u306e\u305f\u3081\u306e\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044\u3044\u3075\u3093\u3044\u3093\u3075\u3044\u306b\u3064\u3068\u306f\u3078\u308b","locale":"ja_jp"},{"id":"BeginningIdol","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb","className":"BeginningIdol","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b","locale":"ja_jp"},{"id":"ShoujoTenrankai","name":"\u5c11\u5973\u5c55\u721b\u4f1aTRPG","className":"ShoujoTenrankai","superClassName":"Base","sortKey":"\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044TRPG","locale":"ja_jp"},{"id":"InfiniteFantasia","name":"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2","className":"InfiniteFantasia","superClassName":"Base","sortKey":"\u3080\u3051\u3093\u306e\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"Insane","name":"\u30a4\u30f3\u30bb\u30a4\u30f3","className":"Insane","superClassName":"Base","sortKey":"\u3044\u3093\u305b\u3044\u3093","locale":"ja_jp"},{"id":"OneWayHeroics","name":"\u7247\u9053\u52c7\u8005TRPG","className":"OneWayHeroics","superClassName":"Base","sortKey":"\u304b\u305f\u307f\u3061\u3086\u3046\u3057\u3084TRPG","locale":"ja_jp"},{"id":"Nuekagami","name":"\u9d7a\u93e1","className":"Nuekagami","superClassName":"Base","sortKey":"\u306c\u3048\u304b\u304b\u307f","locale":"ja_jp"},{"id":"Insane:Korean","name":"\uc778\uc138\uc778","className":"Insane_Korean","superClassName":"Insane","sortKey":"\u56fd\u969b\u5316:Korean:\uc778\uc138\uc778","locale":"ko_kr"},{"id":"Irisbane","name":"\u77b3\u9038\u3089\u3055\u306c\u30a4\u30ea\u30b9\u30d9\u30a4\u30f3","className":"Irisbane","superClassName":"Base","sortKey":"\u3072\u3068\u307f\u305d\u3089\u3055\u306c\u3044\u308a\u3059\u3078\u3044\u3093","locale":"ja_jp"},{"id":"SwordWorld2.5","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5","className":"SwordWorld2_5","superClassName":"SwordWorld2_0","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5","locale":"ja_jp"},{"id":"SwordWorld:SimplifiedChinese","name":"\u5251\u4e16\u754c","className":"SwordWorld_SimplifiedChinese","superClassName":"SwordWorld","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c","locale":"zh_hans"},{"id":"SwordWorld2.0:SimplifiedChinese","name":"\u5251\u4e16\u754c2.0","className":"SwordWorld2_0_SimplifiedChinese","superClassName":"SwordWorld2_0","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.0","locale":"zh_hans"},{"id":"SwordWorld2.5:SimplifiedChinese","name":"\u5251\u4e16\u754c2.5","className":"SwordWorld2_5_SimplifiedChinese","superClassName":"SwordWorld2_5","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u5251\u4e16\u754c2.5","locale":"zh_hans"},{"id":"DoubleCross:Korean","name":"\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","className":"DoubleCross_Korean","superClassName":"DoubleCross","sortKey":"\u56fd\u969b\u5316:Korean:\ub354\ube14\ud06c\ub85c\uc2a4","locale":"ko_kr"},{"id":"Dracurouge","name":"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5","className":"Dracurouge","superClassName":"Base","sortKey":"\u3068\u3089\u304f\u308b\u3046\u3057\u3086","locale":"ja_jp"},{"id":"TalesFromTheLoop","name":"\u30b6\u30fb\u30eb\u30fc\u30d7TRPG","className":"TalesFromTheLoop","superClassName":"Base","sortKey":"\u3055\u308b\u3046\u3075TRPG","locale":"ja_jp"},{"id":"IthaWenUa","name":"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc","className":"IthaWenUa","superClassName":"Base","sortKey":"\u3044\u3055\u3042\u3046\u3048\u3093\u3042\u3042","locale":"ja_jp"},{"id":"JamesBond","name":"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007","className":"JamesBond","superClassName":"Base","sortKey":"\u3057\u3048\u3048\u3080\u3059\u307b\u3093\u3068007","locale":"ja_jp"},{"id":"DiceBot","name":"DiceBot","className":"DiceBot","superClassName":"Base","sortKey":"*\u305f\u3044\u3059\u307b\u3064\u3068","locale":"ja_jp"},{"id":"JekyllAndHyde","name":"\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9","className":"JekyllAndHyde","superClassName":"DesperateRun","sortKey":"\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089","locale":"ja_jp"},{"id":"JuinKansen","name":"\u546a\u5370\u611f\u67d3","className":"JuinKansen","superClassName":"Base","sortKey":"\u3057\u3086\u3044\u3093\u304b\u3093\u305b\u3093","locale":"ja_jp"},{"id":"Kamigakari","name":"\u795e\u6211\u72e9","className":"Kamigakari","superClassName":"Base","sortKey":"\u304b\u307f\u304b\u304b\u308a","locale":"ja_jp"},{"id":"TherapieSein","name":"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","className":"TherapieSein","superClassName":"Base","sortKey":"\u305b\u3089\u3075\u3044\u3055\u3044\u3093","locale":"ja_jp"},{"id":"TenkaRyouran","name":"\u5929\u4e0b\u7e5a\u4e71","className":"TenkaRyouran","superClassName":"SRS","sortKey":"\u3066\u3093\u304b\u308a\u3088\u3046\u3089\u3093","locale":"ja_jp"},{"id":"TokyoGhostResearch","name":"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1","className":"TokyoGhostResearch","superClassName":"Base","sortKey":"\u3068\u3046\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u308a\u3055\u3042\u3061","locale":"ja_jp"},{"id":"TokumeiTenkousei","name":"\u7279\u547d\u8ee2\u653b\u751f","className":"TokumeiTenkousei","superClassName":"Base","sortKey":"\u3068\u304f\u3081\u3044\u3066\u3093\u3053\u3046\u305b\u3044","locale":"ja_jp"},{"id":"OracleEngine","name":"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3","className":"OracleEngine","superClassName":"Base","sortKey":"\u304a\u3089\u304f\u308b\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Kamigakari:Korean","name":"\uce74\ubbf8\uac00\uce74\ub9ac","className":"Kamigakari_Korean","superClassName":"Kamigakari","sortKey":"\u56fd\u969b\u5316:Korean:\uce74\ubbf8\uac00\uce74\ub9ac","locale":"ko_kr"},{"id":"KanColle","name":"\u8266\u3053\u308cRPG","className":"KanColle","superClassName":"Base","sortKey":"\u304b\u3093\u3053\u308cRPG","locale":"ja_jp"},{"id":"Torg","name":"\u30c8\u30fc\u30b0","className":"Torg","superClassName":"Base","sortKey":"\u3068\u304a\u304f","locale":"ja_jp"},{"id":"TokyoNova","name":"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA","className":"TokyoNova","superClassName":"Base","sortKey":"\u3068\u304a\u304d\u3088\u304a\u306e\u306f","locale":"ja_jp"},{"id":"Karukami","name":"\u30ab\u30eb\u30ab\u30df","className":"Karukami","superClassName":"Base","sortKey":"\u304b\u308b\u304b\u307f","locale":"ja_jp"},{"id":"KemonoNoMori","name":"\u7378\u30ce\u68ee","className":"KemonoNoMori","superClassName":"Base","sortKey":"\u3051\u3082\u306e\u306e\u3082\u308a","locale":"ja_jp"},{"id":"Dracurouge:Korean","name":"\ub4dc\ub77c\ud06c\ub8e8\uc8fc","className":"Dracurouge_Korean","superClassName":"Dracurouge","sortKey":"\u56fd\u969b\u5316:Korean:\ub4dc\ub77c\ud06c\ub8e8\uc8fc","locale":"ko_kr"},{"id":"DungeonsAndDragons","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba","className":"DungeonsAndDragons","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u3059","locale":"ja_jp"},{"id":"DungeonsAndDragons5","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba\u7b2c5\u7248","className":"DungeonsAndDragons5","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u30595","locale":"ja_jp"},{"id":"OrgaRain","name":"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","className":"OrgaRain","superClassName":"Base","sortKey":"\u3042\u308a\u3066\u3042\u307e\u306d\u304f\u304a\u308b\u304b\u308c\u3044\u3093","locale":"ja_jp"},{"id":"Oukahoushin3rd","name":"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248","className":"Oukahoushin3rd","superClassName":"Base","sortKey":"\u304a\u3046\u304b\u307b\u3046\u3057\u3093RPG3","locale":"ja_jp"},{"id":"Paradiso","name":"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be","className":"Paradiso","superClassName":"Base","sortKey":"\u3061\u3048\u308c\u3059\u3066\u3044\u308d\u306e\u306f\u3089\u3066\u3044\u3044\u305d","locale":"ja_jp"},{"id":"KillDeathBusiness","name":"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9","className":"KillDeathBusiness","superClassName":"Base","sortKey":"\u304d\u308b\u3066\u3059\u3072\u3057\u306d\u3059","locale":"ja_jp"},{"id":"Torg1.5","name":"\u30c8\u30fc\u30b01.5\u7248","className":"Torg1_5","superClassName":"Torg","sortKey":"\u3068\u304a\u304f1.5","locale":"ja_jp"},{"id":"EarthDawn","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3","className":"EarthDawn","superClassName":"Base","sortKey":"\u3042\u3042\u3059\u3068\u304a\u3093","locale":"ja_jp"},{"id":"TorgEternity","name":"\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","className":"TorgEternity","superClassName":"Base","sortKey":"\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044","locale":"ja_jp"},{"id":"Paranoia","name":"\u30d1\u30e9\u30ce\u30a4\u30a2","className":"Paranoia","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042","locale":"ja_jp"},{"id":"ParanoiaRebooted","name":"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9","className":"ParanoiaRebooted","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042\u308a\u3075\u3046\u3066\u3064\u3068","locale":"ja_jp"},{"id":"ParasiteBlood","name":"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","className":"ParasiteBlood","superClassName":"DemonParasite","sortKey":"\u306f\u3089\u3055\u3044\u3068\u3075\u3089\u3064\u3068RPG","locale":"ja_jp"},{"id":"KillDeathBusiness:Korean","name":"Kill Death Business (\ud55c\uad6d\uc5b4)","className":"KillDeathBusiness_Korean","superClassName":"KillDeathBusiness","sortKey":"\u56fd\u969b\u5316:Korean:Kill Death Business","locale":"ko_kr"},{"id":"KurayamiCrying","name":"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3","className":"KurayamiCrying","superClassName":"Base","sortKey":"\u304f\u3089\u3084\u307f\u304f\u3089\u3044\u3093","locale":"ja_jp"},{"id":"Pathfinder","name":"Pathfinder","className":"Pathfinder","superClassName":"DungeonsAndDragons","sortKey":"\u306f\u3059\u3075\u3042\u3044\u3093\u305f\u3042","locale":"ja_jp"},{"id":"Kutulu","name":"Kutulu","className":"Kutulu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3046","locale":"ja_jp"},{"id":"Pendragon","name":"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3","className":"Pendragon","superClassName":"Base","sortKey":"\u3078\u3093\u3068\u3089\u3053\u3093","locale":"ja_jp"},{"id":"PersonaO","name":"\u30da\u30eb\u30bd\u30caTRPG-O","className":"PersonaO","superClassName":"Base","sortKey":"\u3078\u308b\u305d\u306aTRPGO","locale":"ja_jp"},{"id":"Peekaboo","name":"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc","className":"Peekaboo","superClassName":"Base","sortKey":"\u3072\u3044\u304b\u3042\u3075\u3046","locale":"ja_jp"},{"id":"LiveraDoll","name":"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","className":"LiveraDoll","superClassName":"Base","sortKey":"\u3057\u3057\u307e\u306e\u308a\u3046\u3089\u3068\u304a\u308b","locale":"ja_jp"},{"id":"BeginningIdol:Korean","name":"\ube44\uae30\ub2dd \uc544\uc774\ub3cc","className":"BeginningIdol_Korean","superClassName":"BeginningIdol","sortKey":"\u56fd\u969b\u5316:Korean:\ube44\uae30\ub2dd \uc544\uc774\ub3cc","locale":"ko_kr"},{"id":"BeginningIdol2022","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb\uff082022\u5e74\u6539\u8a02\u7248\uff09","className":"BeginningIdol2022","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b2022","locale":"ja_jp"},{"id":"PhantasmAdventure","name":"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc","className":"PhantasmAdventure","superClassName":"Base","sortKey":"\u3075\u3042\u3093\u305f\u3059\u3080\u3042\u3068\u3078\u3093\u3061\u3084\u3042","locale":"ja_jp"},{"id":"LogHorizon","name":"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG","className":"LogHorizon","superClassName":"Base","sortKey":"\u308d\u304f\u307b\u3089\u3044\u3059\u3093TRPG","locale":"ja_jp"},{"id":"Postman","name":"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","className":"Postman","superClassName":"Base","sortKey":"\u3053\u308f\u308c\u305f\u305b\u304b\u3044\u306e\u307b\u3059\u3068\u307e\u3093","locale":"ja_jp"},{"id":"EarthDawn3","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248","className":"EarthDawn3","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30933","locale":"ja_jp"},{"id":"PulpCthulhu","name":"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5","className":"PulpCthulhu","superClassName":"Cthulhu7th","sortKey":"\u306f\u308b\u3075\u304f\u3068\u3046\u308b\u3075","locale":"ja_jp"},{"id":"ToshiakiHolyGrailWar","name":"\u3068\u3057\u3042\u304d\u306e\u8056\u676f\u6226\u4e89TRPG","className":"ToshiakiHolyGrailWar","superClassName":"Base","sortKey":"\u3068\u3057\u3042\u304d\u306e\u305b\u3044\u306f\u3044\u305b\u3093\u305d\u3046TRPG","locale":"ja_jp"},{"id":"BladeOfArcana","name":"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca","className":"BladeOfArcana","superClassName":"Base","sortKey":"\u3075\u308c\u3044\u3068\u304a\u3075\u3042\u308b\u304b\u306a","locale":"ja_jp"},{"id":"Raisondetre","name":"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb","className":"Raisondetre","superClassName":"Base","sortKey":"\u306f\u3093\u304d\u3084\u304f\u308c\u305d\u3093\u3066\u3068\u304a\u308b","locale":"ja_jp"},{"id":"TrinitySeven","name":"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG","className":"TrinitySeven","superClassName":"Base","sortKey":"\u3068\u308a\u306b\u3066\u3044\u305b\u3075\u3093RPG","locale":"ja_jp"},{"id":"BlindMythos","name":"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG","className":"BlindMythos","superClassName":"Base","sortKey":"\u3075\u3089\u3044\u3093\u3068\u307f\u3068\u3059RPG","locale":"ja_jp"},{"id":"RecordOfLodossWar","name":"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG","className":"RecordOfLodossWar","superClassName":"Base","sortKey":"\u308d\u304a\u3068\u3059\u3068\u3046\u305b\u3093\u304dRPG","locale":"ja_jp"},{"id":"RecordOfSteam","name":"Record of Steam","className":"RecordOfSteam","superClassName":"Base","sortKey":"\u308c\u3053\u304a\u3068\u304a\u3075\u3059\u3061\u3044\u3080","locale":"ja_jp"},{"id":"EarthDawn4","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248","className":"EarthDawn4","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30934","locale":"ja_jp"},{"id":"TunnelsAndTrolls","name":"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba","className":"TunnelsAndTrolls","superClassName":"Base","sortKey":"\u3068\u3093\u306d\u308b\u3059\u3042\u3093\u3068\u3068\u308d\u304a\u308b\u3059","locale":"ja_jp"},{"id":"LogHorizon:Korean","name":"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","className":"LogHorizon_Korean","superClassName":"LogHorizon","sortKey":"\u56fd\u969b\u5316:Korean:\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","locale":"ko_kr"},{"id":"LostRecord","name":"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9","className":"LostRecord","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308c\u3053\u304a\u3068","locale":"ja_jp"},{"id":"LostRoyal","name":"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb","className":"LostRoyal","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308d\u3044\u3084\u308b","locale":"ja_jp"},{"id":"EclipsePhase","name":"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba","className":"EclipsePhase","superClassName":"Base","sortKey":"\u3048\u304f\u308a\u3075\u3059\u3075\u3048\u3044\u3059","locale":"ja_jp"},{"id":"Revulture","name":"\u5149\u7815\u306e\u30ea\u30f4\u30a1\u30eb\u30c1\u30e3\u30fc","className":"Revulture","superClassName":"Base","sortKey":"\u3053\u3046\u3055\u3044\u306e\u308a\u3046\u3042\u308b\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Elric","name":"\u30a8\u30eb\u30ea\u30c3\u30af\uff01","className":"Elric","superClassName":"Base","sortKey":"\u3048\u308b\u308a\u3064\u304f","locale":"ja_jp"},{"id":"Elysion","name":"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3","className":"Elysion","superClassName":"Base","sortKey":"\u3048\u308a\u3086\u3057\u304a\u3093","locale":"ja_jp"},{"id":"TwilightGunsmoke","name":"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af","className":"TwilightGunsmoke","superClassName":"Base","sortKey":"\u3068\u308f\u3044\u3089\u3044\u3068\u304b\u3093\u3059\u3082\u304a\u304f","locale":"ja_jp"},{"id":"UnsungDuet","name":"\u30a2\u30f3\u30b5\u30f3\u30b0\u30fb\u30c7\u30e5\u30a8\u30c3\u30c8","className":"UnsungDuet","superClassName":"Base","sortKey":"\u3042\u3093\u3055\u3093\u304f\u3066\u3086\u3048\u3064\u3068","locale":"ja_jp"},{"id":"RokumonSekai2","name":"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3","className":"RokumonSekai2","superClassName":"Base","sortKey":"\u308d\u304f\u3082\u3093\u305b\u304b\u3044RPG2","locale":"ja_jp"},{"id":"BloodCrusade","name":"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9","className":"BloodCrusade","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u304f\u308b\u305b\u3044\u3068","locale":"ja_jp"},{"id":"MagicaLogia","name":"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2","className":"MagicaLogia","superClassName":"Base","sortKey":"\u307e\u304d\u304b\u308d\u304d\u3042","locale":"ja_jp"},{"id":"Utakaze","name":"\u30a6\u30bf\u30ab\u30bc","className":"Utakaze","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305b","locale":"ja_jp"},{"id":"BloodMoon","name":"\u30d6\u30e9\u30c3\u30c9\u30e0\u30fc\u30f3","className":"BloodMoon","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u3080\u3046\u3093","locale":"ja_jp"},{"id":"Bloodorium","name":"\u30d6\u30e9\u30c9\u30ea\u30a6\u30e0","className":"Bloodorium","superClassName":"Base","sortKey":"\u3075\u3089\u3068\u308a\u3046\u3080","locale":"ja_jp"},{"id":"RoleMaster","name":"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc","className":"RoleMaster","superClassName":"Base","sortKey":"\u308d\u304a\u308b\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"RuinBreakers","name":"\u30eb\u30fc\u30a4\u30f3\u30d6\u30ec\u30a4\u30ab\u30fc\u30ba","className":"RuinBreakers","superClassName":"Base","sortKey":"\u308b\u3046\u3044\u3093\u3075\u308c\u3044\u304b\u3042\u3059","locale":"ja_jp"},{"id":"CardRanker","name":"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc","className":"CardRanker","superClassName":"Base","sortKey":"\u304b\u3042\u3068\u3089\u3093\u304b\u3042","locale":"ja_jp"},{"id":"CastleInGray","name":"\u7070\u8272\u57ce\u7dba\u8b5a","className":"CastleInGray","superClassName":"Base","sortKey":"\u306f\u3044\u3044\u308d\u3057\u3088\u3046\u304d\u305f\u3093","locale":"ja_jp"},{"id":"RuneQuest","name":"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8","className":"RuneQuest","superClassName":"Base","sortKey":"\u308b\u3046\u3093\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"RyuTuber","name":"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1","className":"RyuTuber","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u3061\u3086\u3046\u306f\u3042\u3068\u3061\u3044\u3055\u306a\u304d\u305b\u304d","locale":"ja_jp"},{"id":"AFF2e","name":"ADVANCED FIGHTING FANTASY 2nd Edition","className":"AFF2e","superClassName":"Base","sortKey":"\u3042\u3068\u306f\u3093\u3059\u3068\u3075\u3042\u3044\u3066\u3044\u3093\u304f\u3075\u3042\u3093\u305f\u3057\u30442","locale":"ja_jp"},{"id":"Ryutama","name":"\u308a\u3085\u3046\u305f\u307e","className":"Ryutama","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u305f\u307e","locale":"ja_jp"},{"id":"VampireTheMasquerade5th","name":"Vampire: The Masquerade 5th Edition","className":"VampireTheMasquerade5th","superClassName":"Base","sortKey":"\u3046\u3042\u3093\u306f\u3044\u3042\u3055\u307e\u3059\u304b\u308c\u3048\u30685","locale":"ja_jp"},{"id":"ChaosFlare","name":"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2","className":"ChaosFlare","superClassName":"Base","sortKey":"\u304b\u304a\u3059\u3075\u308c\u3042","locale":"ja_jp"},{"id":"Villaciel","name":"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb","className":"Villaciel","superClassName":"Base","sortKey":"\u305d\u3046\u3066\u3093\u306e\u3046\u3044\u3089\u3057\u3048\u308b","locale":"ja_jp"},{"id":"MagicaLogia:Korean","name":"\ub9c8\uae30\uce74\ub85c\uae30\uc544","className":"MagicaLogia_Korean","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544","locale":"ko_kr"},{"id":"Chill","name":"Chill","className":"Chill","superClassName":"Base","sortKey":"\u3061\u308b","locale":"ja_jp"},{"id":"MagicaLogia:SimplifiedChinese","name":"\u9b54\u5bfc\u4e66\u5927\u6218","className":"MagicaLogia_SimplifiedChinese","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u9b54\u5bfc\u4e66\u5927\u6218","locale":"zh_hans"},{"id":"MeikyuDays","name":"\u8ff7\u5bae\u30c7\u30a4\u30ba","className":"MeikyuDays","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u3066\u3044\u3059","locale":"ja_jp"}]}')},6884:E=>{"use strict";E.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}}}')},3034:E=>{"use strict";E.exports=JSON.parse('{"i18nList":[{"baseClassName":"SwordWorld2_0","locales":["ja_jp","zh_hans"]},{"baseClassName":"Cthulhu","locales":["ja_jp","zh_hans","zh_hant","ko_kr"]},{"baseClassName":"Kamigakari","locales":["ja_jp","ko_kr"]},{"baseClassName":"DoubleCross","locales":["ja_jp","ko_kr"]},{"baseClassName":"StellarKnights","locales":["ja_jp","ko_kr"]},{"baseClassName":"MonotoneMuseum","locales":["ja_jp","ko_kr"]},{"baseClassName":"Dracurouge","locales":["ja_jp","ko_kr"]},{"baseClassName":"Emoklore","locales":["ja_jp"]},{"baseClassName":"MagicaLogia","locales":["ja_jp","zh_hans","ko_kr"]},{"baseClassName":"FutariSousa","locales":["ja_jp","ko_kr"]},{"baseClassName":"DetatokoSaga","locales":["ja_jp","ko_kr"]},{"baseClassName":"Insane","locales":["ja_jp","ko_kr"]},{"baseClassName":"LogHorizon","locales":["ja_jp","ko_kr"]},{"baseClassName":"Nechronica","locales":["ja_jp","ko_kr"]},{"baseClassName":"Arianrhod","locales":["ja_jp"]},{"baseClassName":"KillDeathBusiness","locales":["ja_jp","ko_kr"]},{"baseClassName":"StratoShout","locales":["ja_jp","ko_kr"]},{"baseClassName":"BeginningIdol","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld2_5","locales":["ja_jp","zh_hans"]},{"baseClassName":"SwordWorld","locales":["ja_jp","zh_hans"]},{"baseClassName":"Amadeus","locales":["ja_jp","ko_kr"]},{"baseClassName":"Fiasco","locales":["ja_jp","ko_kr"]}]}')},1014:E=>{"use strict";E.exports={}}},E=>{E(E.s=113)}]);