(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[4535],{94535:function(t,e,r){var n,o,i,a,$,m,_,c,u,s,l,p,d;r(93683),Opal.modules["bcdice/normalize"]=function(t){var e,r,n,o,i,a,$=[],m=t.nil,_=t.module;return i=$,e=a=[_($[0],"BCDice")].concat(i),[o=_(a[0],"Normalize")].concat(e),o.$module_function(),t.def(o,"$comparison_operator",r=function(t){var e;return/<=|=</["$==="](e=t)?"<=":/>=|=>/["$==="](e)?">=":/<>|!=|=!/["$==="](e)?"!=":/</["$==="](e)?"<":/>/["$==="](e)?">":/=/["$==="](e)?"==":m},r.$$arity=1),void t.def(o,"$target_number",n=function(t){return t["$=="]("?")?t:t.$to_i()},n.$$arity=1)},Opal.modules["bcdice/format"]=function(t){var e,r,n,o,i,a,$,m=[],_=t.nil,c=t.$$,u=t.module,s=t.truthy;return e=m,r=$=[u(m[0],"BCDice")].concat(e),i=u($[0],"Format"),a=[i].concat(r),i.$module_function(),t.def(i,"$comparison_operator",n=function(t){var e;return"=="["$==="](e=t)?"=":"!="["$==="](e)?"<>":c(a,"Symbol")["$==="](e)?t.$to_s():_},n.$$arity=1),void t.def(i,"$modifier",o=function(t){return s(t["$nil?"]())?_:t["$=="](0)?"":s("number"==typeof(e=t)?e>0:e["$>"](0))?"+"+t:t.$to_s();var e},o.$$arity=1)},Opal.modules["bcdice/game_system/NightWizard"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var n,o,i,a,$,m,_,c,u,s,l,p,d,f,b,y,h,v,g,z,N,x,W,w,E,P=t.top,R=[],j=t.nil,A=t.$$,C=t.module,S=t.klass,k=t.send2,D=t.truthy,O=t.send;return P.$require("bcdice/normalize"),P.$require("bcdice/format"),n=R,o=E=[C(R[0],"BCDice")].concat(n),i=(w=[C(E[0],"GameSystem")].concat(o))[0],a=A(w,"Base"),$=w,x=S(i,a,"NightWizard"),W=[x].concat($),x.$$prototype.nw_command=x.$$prototype.randomizer=x.$$prototype.total=x.$$prototype.interim_expr=x.$$prototype.status=x.$$prototype.fumble_numbers=x.$$prototype.critical_numbers=j,t.const_set(W[0],"ID","NightWizard"),t.const_set(W[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),t.const_set(W[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),t.const_set(W[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),x.$register_prefix("([-+]?\\d+)?NW","2R6"),t.def(x,"$initialize",m=function(e){var r=this;return m.$$p&&(m.$$p=null),k(r,t.find_super_dispatcher(r,"initialize",m,!1,!0),"initialize",[e],null),r.nw_command="NW"},m.$$arity=1),t.def(x,"$eval_game_system_specific_command",_=function(e){var r,n,o,i=this,a=j,$=j,m=j,_=j,c=j;return a=D(o=i.$parse_nw(e))?o:i.$parse_2r6(e),D(a)?(n=i.$roll_nw(a),$=null==(r=t.to_ary(n))[0]?j:r[0],m=null==r[1]?j:r[1],_=null==r[2]?j:r[2],c=D(a.$cmp_op())?D($.$send(a.$cmp_op(),a.$target_number()))?"\u6210\u529f":"\u5931\u6557":j,["("+a+")",m,_,$.$to_s(),c].$compact().$join(" \uff1e ")):j},_.$$arity=1),x.$private(),function(t,e,r){var n=S(t,null,"Parsed");[n].concat(r),n.$attr_accessor("critical_numbers"),n.$attr_accessor("fumble_numbers"),n.$attr_accessor("prana"),n.$attr_accessor("active_modify_number"),n.$attr_accessor("cmp_op"),n.$attr_accessor("target_number")}(W[0],0,W),f=W[0],b=A(W,"Parsed"),y=W,z=S(f,b,"ParsedNW"),N=[z].concat(y),z.$$prototype.base=z.$$prototype.modify_number=z.$$prototype.active_modify_number=z.$$prototype.prana=z.$$prototype.command=z.$$prototype.critical_numbers=z.$$prototype.fumble_numbers=z.$$prototype.cmp_op=z.$$prototype.target_number=j,z.$attr_accessor("base"),z.$attr_accessor("modify_number"),t.def(z,"$initialize",h=function(e){var r=this;return h.$$p&&(h.$$p=null),k(r,t.find_super_dispatcher(r,"initialize",h,!1,!0),"initialize",[],null),r.command=e},h.$$arity=1),t.def(z,"$passive_modify_number",v=function(){return e(this.base,this.modify_number)},v.$$arity=0),t.def(z,"$to_s",g=function(){var t,e,r,n,o,i=this;return t=D(i.base["$zero?"]())?j:i.base,e=A(N,"Format").$modifier(i.modify_number),r=A(N,"Format").$modifier(i.active_modify_number),n=D(o=i.prana)?"$"+i.prana:o,""+t+i.command+e+"@"+i.critical_numbers.$join(",")+"#"+i.fumble_numbers.$join(",")+n+r+i.cmp_op+i.target_number},g.$$arity=0),function(e,r,n){var o,i=S(e,r,"Parsed2R6");[i].concat(n),i.$$prototype.passive_modify_number=i.$$prototype.active_modify_number=i.$$prototype.critical_numbers=i.$$prototype.fumble_numbers=i.$$prototype.cmp_op=i.$$prototype.target_number=j,i.$attr_accessor("passive_modify_number"),t.def(i,"$to_s",o=function(){var t=this;return"2R6M["+t.passive_modify_number+","+t.active_modify_number+"]C["+t.critical_numbers.$join(",")+"]F["+t.fumble_numbers.$join(",")+"]"+t.cmp_op+t.target_number},o.$$arity=0)}(W[0],A(W,"Parsed"),W),t.def(x,"$parse_nw",c=function(e){var n,o,i=j,a=j,$=j;return i=t.regexp(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(e),D(i)?(a=A(W,"ParsedNW").$new(this.nw_command),$=[i["$[]"](1).$to_i()],O(a,"base=",t.to_a($)),r($.length,1),$=[A(W,"ArithmeticEvaluator").$eval(i["$[]"](2))],O(a,"modify_number=",t.to_a($)),r($.length,1),$=[D(i["$[]"](3))?O(i["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],O(a,"critical_numbers=",t.to_a($)),r($.length,1),$=[D(i["$[]"](4))?O(i["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],O(a,"fumble_numbers=",t.to_a($)),r($.length,1),$=[(n=i["$[]"](5),n===j||null==n?j:O(n,"to_i",[]))],O(a,"prana=",t.to_a($)),r($.length,1),$=[A(W,"ArithmeticEvaluator").$eval(i["$[]"](6))],O(a,"active_modify_number=",t.to_a($)),r($.length,1),$=[A(W,"Normalize").$comparison_operator(i["$[]"](7))],O(a,"cmp_op=",t.to_a($)),r($.length,1),$=[(o=i["$[]"](8),o===j||null==o?j:O(o,"to_i",[]))],O(a,"target_number=",t.to_a($)),r($.length,1),a):j},c.$$arity=1),t.def(x,"$parse_2r6",u=function(e){var n,o=j,i=j,a=j;return o=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(e),D(o)?(i=A(W,"Parsed2R6").$new(),a=[A(W,"ArithmeticEvaluator").$eval(o["$[]"](1))],O(i,"passive_modify_number=",t.to_a(a)),r(a.length,1),a=[A(W,"ArithmeticEvaluator").$eval(o["$[]"](2))],O(i,"active_modify_number=",t.to_a(a)),r(a.length,1),a=[D(o["$[]"](3))?O(o["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],O(i,"critical_numbers=",t.to_a(a)),r(a.length,1),a=[D(o["$[]"](4))?O(o["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],O(i,"fumble_numbers=",t.to_a(a)),r(a.length,1),a=[A(W,"Normalize").$comparison_operator(o["$[]"](5))],O(i,"cmp_op=",t.to_a(a)),r(a.length,1),a=[(n=o["$[]"](6),n===j||null==n?j:O(n,"to_i",[]))],O(i,"target_number=",t.to_a(a)),r(a.length,1),i):j},u.$$arity=1),t.def(x,"$roll_nw",s=function(t){var r,n=this,o=j,i=j,a=j,$=j,m=j;for(n.critical_numbers=t.$critical_numbers(),n.fumble_numbers=t.$fumble_numbers(),n.total=0,n.interim_expr="",n.status=j,o=n.$roll_once_first();o["$=="]("critical");)o=n.$roll_once();return D(D(r=o["$!="]("fumble"))?t.$prana():r)&&(a=(i=n.randomizer.$roll_barabara(t.$prana(),6)).$sum(),$=i.$join(","),n.total=e(n.total,a),n.interim_expr=e(n.interim_expr,"+"+a+"["+$+"]")),m=o["$=="]("fumble")?n.$fumble_base_number(t):e(t.$passive_modify_number(),t.$active_modify_number()),n.total=e(n.total,m),n.interim_expr=e(m.$to_s(),n.interim_expr),[n.total,n.interim_expr,n.status]},s.$$arity=1),t.def(x,"$roll_once",l=function(t){var n,o,i,a=this,$=j;return null==t&&(t=!1),n=($=a.randomizer.$roll_barabara(2,6)).$sum(),o=$.$join(","),D(D(i=t)?a.fumble_numbers["$include?"](n):i)?(a.total=r(a.total,10),a.interim_expr=e(a.interim_expr,"-10["+o+"]"),a.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):D(a.critical_numbers["$include?"](n))?(a.total=e(a.total,10),a.interim_expr=e(a.interim_expr,"+10["+o+"]"),a.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(a.total=e(a.total,n),a.interim_expr=e(a.interim_expr,"+"+n+"["+o+"]"),j)},l.$$arity=-1),t.def(x,"$roll_once_first",p=function(){return this.$roll_once(!0)},p.$$arity=0),void t.def(x,"$fumble_base_number",d=function(t){return t.$passive_modify_number()},d.$$arity=1)},s=[],l=(n=Opal).$$,p=n.module,d=n.klass,n.top.$require("bcdice/game_system/NightWizard"),o=s,i=u=[p(s[0],"BCDice")].concat(o),a=c=[p(u[0],"GameSystem")].concat(i),_=[m=d(c[0],l(c,"NightWizard"),"NightWizard3rd")].concat(a),n.const_set(_[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition"),n.const_set(_[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683"),n.const_set(_[0],"ID","NightWizard3rd"),m.$register_prefix("([-+]?\\d+)?NW","2R6"),n.def(m,"$fumble_base_number",$=function(t){return function(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}(t.$passive_modify_number(),t.$active_modify_number())},$.$$arity=1)}}]);