(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[256],{1171:(ge,ye,he)=>{he(5151),Opal.modules["i18n/backend/fallbacks"]=function(e){var K,a,n,l,c,$,V=e.module,L=e.class_variable_set,_=e.truthy,A=e.class_variable_get,S=e.def,D=e.send,j=e.send2,T=e.find_super,k=e.hash2,B=e.find_block_super,U=e.neqeq,G=e.thrower,q=e.return_val,M=[],P=e.nil,g=e.$$$;return K=M,$=[c=V(M[0],"I18n")].concat(K),L($[0],"@@fallbacks",P),a=e.get_singleton_class(c),n=[a].concat($),l=e.$r(n),S(a,"$fallbacks",function(){var E=P;return L(n[1],"@@fallbacks",_(null!=n[1].$$cvars["@@fallbacks"]?"class variable":P)&&_(E=A(n[1],"@@fallbacks",!1))?E:g(g(l("I18n"),"Locale"),"Fallbacks").$new()),_(E=l("Thread").$current()["$[]"]("i18n_fallbacks"))?E:A(n[1],"@@fallbacks",!1)}),S(a,"$fallbacks=",function(z){var E;return L(n[1],"@@fallbacks",_(z["$is_a?"](l("Array")))?g(g(l("I18n"),"Locale"),"Fallbacks").$new(z):z),E=["i18n_fallbacks",A(n[1],"@@fallbacks",!1)],D(l("Thread").$current(),"[]=",E),E[E.length-1]}),function(a,w){var z,E,I,x,l=[V(a,"Backend")].concat(w);return z=l,I=[E=V(l[0],"Fallbacks")].concat(z),x=e.$r(I),S(E,"$translate",function p(m,h,o){try{var f=G("return"),u=p.$$p||P,R=this,F=P,v=P;return p.$$p=null,null==o&&(o=x("EMPTY_HASH")),_(o.$fetch("fallback",!0))?_(o["$[]"]("fallback_in_progress"))?j(R,T(R,"translate",p,!1,!0),"translate",[m,h,o],u):(_(o["$[]"]("default"))&&(F=R["$extract_non_symbol_default!"](o)),v=o.$merge(k(["fallback_in_progress"],{fallback_in_progress:!0})),D(x("I18n").$fallbacks()["$[]"](m),"each",[],function r(d){var t=null==r.$$s?this:r.$$s;null==d&&(d=P);try{return D(t,"catch",["exception"],function s(){var i=null==s.$$s?this:s.$$s,C=P;if(C=j(i,B(i,"translate",s.$$def||r.$$def||p,!1,!1),"translate",[d,h,v],null),_(C["$nil?"]()))return P;U(m.$to_s(),d.$to_s())&&i.$on_fallback(m,d,h,o),f.$throw(C)},{$$s:t,$$ret:f})}catch(s){if(!e.rescue(s,[g(x("I18n"),"InvalidLocale")]))throw s;try{return P}finally{e.pop_exception()}}},{$$s:R}),_(o["$key?"]("default"))&&_(o["$[]"]("default")["$nil?"]())?P:_(F)?j(R,T(R,"translate",p,!1,!0),"translate",[m,P,o.$merge(k(["default"],{default:F}))],null):R.$throw("exception",g(x("I18n"),"MissingTranslation").$new(m,h,o))):j(R,T(R,"translate",p,!1,!0),"translate",[m,h,o],u)}catch(r){if(r===f)return r.$v;throw r}},-3),S(E,"$extract_non_symbol_default!",function(m){var o,h=P;return h=[m["$[]"]("default")].$flatten(),o=D(h,"detect",[],function(u){return null==u&&(u=P),u["$is_a?"](x("Symbol"))["$!"]()}),_(o)&&m["$[]="]("default",h["$[]"](0,h.$index(o))),o}),S(E,"$exists?",function p(m,h,o){try{var f=G("return"),u=p.$$p||P,R=this;return p.$$p=null,null==o&&(o=x("EMPTY_HASH")),_(o.$fetch("fallback",!0))?(D(x("I18n").$fallbacks()["$[]"](m),"each",[],function F(v){var r=null==F.$$s?this:F.$$s;null==v&&(v=P);try{if(!_(j(r,B(r,"exists?",F.$$def||p,!1,!1),"exists?",[v,h],null)))return P;f.$throw(!0)}catch(d){if(!e.rescue(d,[g(x("I18n"),"InvalidLocale")]))throw d;try{return P}finally{e.pop_exception()}}},{$$s:R,$$ret:f}),!1):j(R,T(R,"exists?",p,!1,!0),"exists?",[m,h,o],u)}catch(F){if(F===f)return F.$v;throw F}},-3),E.$private(),S(E,"$on_fallback",q(P))}($[0],$)},Opal.modules["bcdice/randomizer"]=function(e){var c,b,z,E,I,x,a,w,L=e.klass,_=e.const_set,A=e.def,S=e.truthy,D=e.rb_gt,j=e.rb_plus,T=e.rb_le,k=e.send,B=e.rb_minus,U=e.eqeq,G=e.rb_times,q=e.eqeqeq,M=e.rb_ge,P=[],g=e.nil,W=e.$$$;return c=P,a=[(0,e.module)(P[0],"BCDice")].concat(c),w=e.$r(a),b=a,E=[z=L(a[0],null,"Randomizer")].concat(b),I=e.$r(E),(x=z.$$prototype).rand_results=x.detailed_rand_results=g,_(E[0],"UPPER_LIMIT_DICE_TIMES",200),_(E[0],"UPPER_LIMIT_DICE_SIDES",1e4),_(E[0],"UPPER_LIMIT_RANDS",1e4),A(z,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),z.$attr_reader("rand_results"),z.$attr_reader("detailed_rand_results"),_(E[0],"DetailedRandResult",I("Struct").$new("kind","sides","value")),A(z,"$roll_barabara",function(m,h){var o=this;return S(D(j(o.rand_results.$size(),m),I("UPPER_LIMIT_RANDS")))&&o.$raise(I("TooManyRandsError")),S(T(m,0))||S(D(m,I("UPPER_LIMIT_DICE_TIMES")))?[]:k(I("Array"),"new",[m],function f(){return(null==f.$$s?this:f.$$s).$roll_once(h)},{$$s:o})}),A(z,"$roll_sum",function(m,h){return this.$roll_barabara(m,h).$sum()}),A(z,"$roll_once",function(m){var o=g;return S(T(m,0))||S(D(m,I("UPPER_LIMIT_DICE_SIDES")))?0:(o=this.$rand_inner(m),this.$push_to_detail("normal",m,o),o)}),A(z,"$roll_index",function(m){return B(this.$roll_once(m),1)}),A(z,"$roll_tens_d10",function(){var o,h=g;return h=this.$rand_inner(10),U(h,10)&&(h=0),o=G(h,10),this.$push_to_detail("tens_d10",10,o),o}),A(z,"$roll_d9",function(){var h;return h=B(this.$rand_inner(10),1),this.$push_to_detail("d9",10,h),h}),A(z,"$roll_d66",function(m){var f,o=g;return o=k(I("Array"),"new",[2],function u(){return(null==u.$$s?this:u.$$s).$roll_once(6)},{$$s:this}),q(W(I("D66SortType"),"ASC"),f=m)?o["$sort!"]():q(W(I("D66SortType"),"DESC"),f)&&o["$sort!"]()["$reverse!"](),j(G(o["$[]"](0),10),o["$[]"](1))}),z.$private(),A(z,"$rand_inner",function(m){var o,h=this;return S(M(h.rand_results.$size(),I("UPPER_LIMIT_RANDS")))&&h.$raise(I("TooManyRandsError")),o=h.$random(m),h.rand_results["$<<"]([o,m]),o}),A(z,"$random",function(m){return j(I("Kernel").$rand(m),1)}),A(z,"$push_to_detail",function(m,h,o){var u;return u=I("DetailedRandResult").$new(m,h,o),this.detailed_rand_results.$push(u)}),L(a[0],w("StandardError"),"TooManyRandsError"),g},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var k,q,K,c,$,a,w,P,U,V=e.module,L=e.klass,_=e.def,A=e.truthy,S=e.return_val,D=[],j=e.nil;return k=D,q=U=[V(D[0],"BCDice")].concat(k),K=P=[V(U[0],"DiceTable")].concat(q),$=[c=L(P[0],null,"RollResult")].concat(K),a=e.$r($),(w=c.$$prototype).table_name=w.value=w.body=j,_(c,"$initialize",function(l,b,z){var E=this;return E.table_name=l,E.value=b,E.body=z}),c.$attr_reader("table_name"),c.$attr_reader("value"),c.$attr_reader("body"),_(c,"$to_s",function(){var l=this;return l.table_name+"("+l.value+") \uff1e "+l.body}),_(c,"$last_body",function(){var l=this;return A(l.body["$is_a?"](a("RollResult")))?l.body.$last_body():l.body}),_(c,"$empty?",S(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var k,q,K,c,$,a,w,P,U,V=e.module,L=e.klass,_=e.truthy,A=e.def,S=e.rb_minus,D=[],j=e.nil;return k=D,q=U=[V(D[0],"BCDice")].concat(k),K=P=[V(U[0],"DiceTable")].concat(q),$=[c=L(P[0],null,"ChainTable")].concat(K),a=e.$r($),(w=c.$$prototype).times=w.sides=w.items=w.name=j,A(c,"$initialize",function(l,b,z){var E=this,I=j;return E.name=l,E.items=z.$freeze(),I=/(\d+)D(\d+)/i.$match(b),_(I)||E.$raise(a("ArgumentError"),"Unexpected table type: "+b),E.times=I["$[]"](1).$to_i(),E.sides=I["$[]"](2).$to_i()}),A(c,"$roll",function(l){var z,E,b=this,I=j;return z=l.$roll_sum(b.times,b.sides),E=S(z,b.times),I=b.items["$[]"](E),_(I["$respond_to?"]("roll"))&&(I=I.$roll(l)),a("RollResult").$new(b.name,z,I)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var G,g,a,w,n,l,b,K,M,V=e.module,L=e.klass,_=e.hash2,A=e.defs,S=e.def,D=e.rb_plus,j=e.rb_times,T=e.rb_minus,k=[],B=e.nil;return G=k,g=M=[V(k[0],"BCDice")].concat(G),a=K=[V(M[0],"DiceTable")].concat(g),n=[w=L(K[0],null,"D66GridTable")].concat(a),l=e.$r(n),(b=w.$$prototype).name=b.items=B,A(w,"$from_i18n",function(E,I){var p=B;return p=l("I18n").$t(E,_(["locale","raise"],{locale:I,raise:!0})),this.$new(p["$[]"]("name"),p["$[]"]("items"))}),S(w,"$initialize",function(E,I){return this.name=E,this.items=I.$freeze()}),S(w,"$roll",function(E){var x,p,m,h,o;return x=E.$roll_once(6),p=E.$roll_once(6),m=D(j(x,10),p),h=T(x,1),o=T(p,1),l("RollResult").$new(this.name,m,this.items["$[]"](h)["$[]"](o))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var B,M,$,a,w,n,g,W,G,V=e.module,L=e.klass,_=e.hash2,A=e.defs,S=e.def,j=[],T=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),B=j,M=G=[V(j[0],"BCDice")].concat(B),g=[V(G[0],"DiceTable")].concat(M),W=e.$r(g),$=g,w=[a=L(g[0],W("D66GridTable"),"D66HalfGridTable")].concat($),n=e.$r(w),A(a,"$from_i18n",function(b,z){var I=T;return I=n("I18n").$t(b,_(["locale","raise"],{locale:z,raise:!0})),this.$new(I["$[]"]("name"),I["$[]"]("items_1_2_3"),I["$[]"]("items_4_5_6"))}),S(a,"$initialize",function(b,z,E){return this.name=b,this.items=[z,z,z,E,E,E].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var B,M,$,a,w,n,g,W,G,V=e.module,L=e.klass,_=e.hash2,A=e.defs,S=e.def,j=[],T=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),B=j,M=G=[V(j[0],"BCDice")].concat(B),g=[V(G[0],"DiceTable")].concat(M),W=e.$r(g),$=g,w=[a=L(g[0],W("D66GridTable"),"D66OneThirdTable")].concat($),n=e.$r(w),A(a,"$from_i18n",function(b,z){var I=T;return I=n("I18n").$t(b,_(["locale","raise"],{locale:z,raise:!0})),this.$new(I["$[]"]("name"),I["$[]"]("items_1_2"),I["$[]"]("items_3_4"),I["$[]"]("items_5_6"))}),S(a,"$initialize",function(b,z,E,I){return this.name=b,this.items=[z,z,E,E,I,I].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var M,K,n,l,b,z,E,$,g,V=e.module,L=e.klass,_=e.hash2,A=e.defs,S=e.def,D=e.eqeqeq,j=e.rb_plus,T=e.rb_times,k=e.truthy,B=[],U=e.nil,G=e.$$$;return M=B,K=g=[V(B[0],"BCDice")].concat(M),n=$=[V(g[0],"DiceTable")].concat(K),b=[l=L($[0],null,"D66Table")].concat(n),z=e.$r(b),(E=l.$$prototype).sort_type=E.items=E.name=U,A(l,"$from_i18n",function(x,p){var o,h=U;return h=z("I18n").$t(x,_(["locale"],{locale:p})),o=z("D66SortType").$const_get(h["$[]"]("d66_sort_type")),this.$new(h["$[]"]("name"),o,h["$[]"]("items"))}),S(l,"$initialize",function(x,p,m){var h=this;return h.name=x,h.sort_type=p,h.items=m.$freeze()}),S(l,"$roll",function(x){var p=this,m=U,h=U,o=U,f=U;return m=x.$roll_barabara(2,6),D(G(z("D66SortType"),"ASC"),h=p.sort_type)?m["$sort!"]():D(G(z("D66SortType"),"DESC"),h)&&m["$sort!"]()["$reverse!"](),o=j(T(m["$[]"](0),10),m["$[]"](1)),f=k(h=p.items["$[]"](o))?h:p.items["$[]"](o.$to_s()),k(f["$respond_to?"]("roll"))&&(f=f.$roll(x)),z("RollResult").$new(p.name,o,f)}),S(l,"$choice",function(x){return z("RollResult").$new(this.name,x,this.items["$[]"](x))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var P,c,a,w,W,V=e.module,L=e.klass,_=e.hash2,A=e.send,S=e.to_ary,D=e.rb_plus,j=e.rb_times,T=e.send2,k=e.find_super,B=e.def,G=[],q=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),P=G,c=W=[V(G[0],"BCDice")].concat(P),a=[V(W[0],"DiceTable")].concat(c),w=e.$r(a),B(L(a[0],w("D66Table"),"D66LeftRangeTable"),"$initialize",function z(E,I,x){var h;return z.$$p=null,h=_([],{}),A(x,"each",[],function(f){var u,v;return null==f&&(f=q),u=S(f),v=null==u[1]?q:u[1],A(null==u[0]?q:u[0],"each",[],function(d){return null==d&&(d=q),A(v,"each_with_index",[],function(s,i){var C,Y;return null==s&&(s=q),null==i&&(i=q),Y=D(j(d,10),D(i,1)),A(h,"[]=",C=[Y,s]),C[C.length-1]})})}),T(this,k(this,"initialize",z,!1,!0),"initialize",[E,I,h],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var q,W,w,n,l,b,z,c,P,V=e.module,L=e.klass,_=e.hash2,A=e.defs,S=e.def,D=e.truthy,j=e.rb_minus,T=e.rb_plus,k=e.rb_times,B=[],U=e.nil;return q=B,W=P=[V(B[0],"BCDice")].concat(q),w=c=[V(P[0],"DiceTable")].concat(W),l=[n=L(c[0],null,"D66ParityTable")].concat(w),b=e.$r(l),(z=n.$$prototype).odd=z.even=z.name=U,A(n,"$from_i18n",function(I,x){var m=U;return m=b("I18n").$t(I,_(["locale","raise"],{locale:x,raise:!0})),this.$new(m["$[]"]("name"),m["$[]"]("odd"),m["$[]"]("even"))}),S(n,"$initialize",function(I,x,p){var m=this;return m.name=I,m.odd=x.$freeze(),m.even=p.$freeze()}),S(n,"$roll",function(I){var m,o,f,x=this,p=U;return p=I.$roll_once(6),m=I.$roll_once(6),o=(D(p["$odd?"]())?x.odd:x.even)["$[]"](j(m,1)),f=T(k(p,10),m),b("RollResult").$new(x.name,f,o)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var B,M,c,$,a,w,n,g,G,V=e.module,L=e.klass,_=e.def,A=e.rb_plus,S=e.rb_times,D=e.send,j=[],T=e.nil;return B=j,M=G=[V(j[0],"BCDice")].concat(B),c=g=[V(G[0],"DiceTable")].concat(M),a=[$=L(g[0],null,"D66RangeTable")].concat(c),w=e.$r(a),(n=$.$$prototype).items=n.name=T,_($,"$initialize",function(b,z){return this.name=b,this.items=z.$freeze()}),_($,"$roll",function(b){var E,I,x,p=T;return E=b.$roll_once(6),I=b.$roll_once(6),x=A(S(E,10),I),p=D(this.items,"find",[],function(h){return null==h&&(h=T),h["$[]"](0)["$include?"](x)}),w("RollResult").$new(this.name,x,p["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var P,c,l,x,m,h,b,z,E,I,a,W,V=e.module,L=e.klass,_=e.const_set,A=e.send,S=e.hash2,D=e.def,j=e.eqeqeq,T=e.truthy,k=e.to_a,B=e.rb_times,U=e.rb_plus,G=[],q=e.nil;return P=G,c=W=[V(G[0],"BCDice")].concat(P),l=a=[V(W[0],"DiceTable")].concat(c),z=[b=L(a[0],null,"RangeTable")].concat(l),E=e.$r(z),(I=b.$$prototype).name=I.items=I.num_of_dice=I.num_of_sides=I.formatter=q,_(z[0],"RollResult",A(E("Struct"),"new",["sum","values","content","formatted"],function x(){return(null==x.$$s?this:x.$$s).$alias_method("to_s","formatted")},{$$s:b})),_(z[0],"Item",E("Struct").$new("range","content")),_(z[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),_(z[0],"DEFAULT_FORMATTER",A(b,"lambda",[],function(p,m){return null==p&&(p=q),null==m&&(m=q),p.$name()+"("+m.$sum()+") \uff1e "+m.$content()})),b.$attr_reader("name"),b.$attr_reader("num_of_dice"),b.$attr_reader("num_of_sides"),m=[x=e.get_singleton_class(b)].concat(z),h=e.$r(m),D(x,"$from_i18n",function(f,u){var v,F=q;return F=h("I18n").$t(f,S(["locale"],{locale:u})),v=A(F["$[]"]("items"),"map",[],function r(d){return null==d&&(d=q),[(null==r.$$s?this:r.$$s).$conv_string_range(d["$[]"](0)),d["$[]"](1)]},{$$s:this}),this.$new(F["$[]"]("name"),F["$[]"]("type"),v)}),D(x,"$conv_string_range",function(f){var R,u=this;return null==u.name&&(u.name=q),j(h("Integer"),R=f)?f:j(h("String"),R)?T(f["$include?"](".."))?A(h("Range"),"new",k(A(f.$split("..",2),"map",[],function F(v){return null==v&&(v=q),(null==F.$$s?this:F.$$s).$Integer(v)},{$$s:u}))):u.$Integer(f):u.$raise(h("TypeError"),u.name+": "+f+" ("+f.$class()+") must be a String or an Integer")}),D(b,"$initialize",function x(p,m,h){var u,o=x.$$p||q,f=this,R=q;return x.$$p=null,f.name=p.$freeze(),f.formatter=T(u=o)?u:E("DEFAULT_FORMATTER"),R=E("DICE_ROLL_METHOD_RE").$match(m),T(R)||f.$raise(E("ArgumentError"),f.name+": invalid dice roll method: "+m),f.num_of_dice=R["$[]"](1).$to_i(),f.num_of_sides=R["$[]"](2).$to_i(),f.$store(h)}),D(b,"$fetch",function(p){var h,m=this;return h=A(m.items,"find",[],function(f){return null==f&&(f=q),f.$range()["$include?"](p)}),T(h)||m.$raise(E("RangeError"),m.name+": value is out of range: "+p),h}),D(b,"$roll",function(p){var o,m=this,h=q,f=q;return o=(h=p.$roll_barabara(m.num_of_dice,m.num_of_sides)).$sum(),(f=E("RollResult").$new(o,h,m.$fetch(o).$content()))["$formatted="](m.formatter["$[]"](m,f)),f}),b.$private(),D(b,"$store",function(p){var h,o,m=this;return h=A(p,"map",[],function f(u,R){return null==u&&(u=q),null==R&&(R=q),[(null==f.$$s?this:f.$$s).$coerce_to_int_range(u),R]},{$$s:m}),o=A(h,"sort_by",[],function(u,R){return null==u&&(u=q),null==R&&(R=q),u.$min()}),m.$assert_min_sum_is_covered(o),m.$assert_max_sum_is_covered(o),m.$assert_no_gap_or_overlap_in_ranges(o),m.items=A(o,"map",[],function(u,R){return null==u&&(u=q),null==R&&(R=q),E("Item").$new(u,R.$freeze()).$freeze()}).$freeze(),m}),D(b,"$coerce_to_int_range",function(p){var h;return j(E("Integer"),h=p)?E("Range").$new(p,p):j(E("Range"),h)&&T(p.$begin()["$is_a?"](E("Integer")))&&T(p.$end()["$is_a?"](E("Integer")))?p:this.$raise(E("TypeError"),this.name+": "+p+" ("+p.$class()+") must be an Integer or a Range with Integers ")}),D(b,"$assert_min_sum_is_covered",function(p){var h,m=this,o=q;return h=m.num_of_dice,o=p.$first()["$[]"](0),T(o["$include?"](h))||m.$raise(E("RangeError"),m.name+": min value ("+h+") is not covered: "+o),m}),D(b,"$assert_max_sum_is_covered",function(p){var h,m=this,o=q;return h=B(m.num_of_dice,m.num_of_sides),o=p.$last()["$[]"](0),T(o["$include?"](h))||m.$raise(E("RangeError"),m.name+": max value ("+h+") is not covered: "+o),m}),D(b,"$assert_no_gap_or_overlap_in_ranges",function(p){return A(p,"each_cons",[2],function h(o,f){var v,r,u=null==h.$$s?this:h.$$s,R=q,F=q;return null==u.name&&(u.name=q),null==o&&(o=q),null==f&&(f=q),R=o["$[]"](0),F=f["$[]"](0),v=R.$max(),r=U(v,1),T(F["$include?"](v))&&u.$raise(E("RangeError"),u.name+": Range overlap: "+R+" and "+F),T(F["$include?"](r))?q:u.$raise(E("RangeError"),u.name+": Range gap: "+R+" and "+F)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var U,P,$,b,z,E,I,w,W,q,V=e.module,L=e.klass,_=e.send,A=e.def,S=e.rb_minus,D=e.return_ivar,j=[],T=e.nil,k=e.$$$;return U=j,P=q=[V(j[0],"BCDice")].concat(U),$=W=[V(q[0],"DiceTable")].concat(P),b=w=[L(W[0],null,"SaiFicSkillTable")].concat($),E=[z=L(w[0],null,"Category")].concat(b),I=e.$r(E),A(z,"$initialize",function(p,m,h,o){var f=this;return f.name=p,f.skills=_(m.$map(),"with_index",[2],function(R,F){return null==R&&(R=T),null==F&&(F=T),k(I("SaiFicSkillTable"),"Skill").$new(p,R,h,F,o)}),f.dice=h}),A(z,"$roll",function(p){return this.$skills()["$[]"](S(p.$roll_sum(2,6),2))}),A(z,"$to_s",D("name")),z.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var T,G,W,w,n,c,M,B,V=e.module,L=e.klass,_=e.def,A=e.hash2,S=[],D=e.nil;return T=S,G=B=[V(S[0],"BCDice")].concat(T),W=M=[V(B[0],"DiceTable")].concat(G),c=[L(M[0],null,"SaiFicSkillTable")].concat(W),(n=(w=L(c[0],null,"Skill")).$$prototype).s_format=n.category_dice=n.row_dice=n.category_name=n.name=D,_(w,"$initialize",function(b,z,E,I,x){var p=this;return p.category_name=b,p.name=z,p.category_dice=E,p.row_dice=I,p.s_format=x}),_(w,"$to_s",function(){var b=this;return b.$format(b.s_format,A(["category_dice","row_dice","category_name","skill_name"],{category_dice:b.category_dice,row_dice:b.row_dice,category_name:b.category_name,skill_name:b.name}))}),w.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var c,n,I,x,p,m,h,b,a,V=e.module,L=e.klass,_=e.ensure_kwargs,A=e.hash2,S=e.send,j=e.defs,T=e.const_set,k=e.to_ary,B=e.def,U=e.truthy,G=e.rb_minus,q=e.rb_plus,M=e.top,P=[],g=e.nil,W=e.$$$;return M.$require("bcdice/dice_table/sai_fic_skill_table/category"),M.$require("bcdice/dice_table/sai_fic_skill_table/skill"),c=P,n=a=[V(P[0],"BCDice")].concat(c),I=b=[V(a[0],"DiceTable")].concat(n),p=[x=L(b[0],null,"SaiFicSkillTable")].concat(I),m=e.$r(p),(h=x.$$prototype).rtt=h.rtt_format=h.rct=h.rct_format=h.rttn=h.rttn_format=h.categories=g,j(x,"$from_i18n",function(f,u,R){var F,v,r,i,s=g;return null==(F=(R=_(R)).$$smap.rtt)&&(F=g),null==(v=R.$$smap.rct)&&(v=g),null==(r=R.$$smap.rttn)&&(r=g),i=(s=m("I18n").$t("RTT",A(["locale","raise","default"],{locale:u,raise:!1,default:A([],{})})).$merge(m("I18n").$t(f,A(["locale","raise"],{locale:u,raise:!0}))))["$[]"]("items"),s=S(s,"select",[],function(Y,H){return null==Y&&(Y=g),null==H&&(H=g),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](Y)}),this.$new(i,e.to_hash(s).$merge(A(["rtt","rct","rttn"],{rtt:F,rct:v,rttn:r})))},-3),T(p[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),T(p[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),T(p[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),T(p[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),B(x,"$initialize",function(f,u){var R,F,v,r,d,t,s,i=this;return null==(R=(u=_(u)).$$smap.rtt)&&(R=g),null==(F=u.$$smap.rct)&&(F=g),null==(v=u.$$smap.rttn)&&(v=g),null==(r=u.$$smap.rtt_format)&&(r=m("DEFAULT_RTT")),null==(d=u.$$smap.rct_format)&&(d=m("DEFAULT_RCT")),null==(t=u.$$smap.rttn_format)&&(t=m("DEFAULT_RTTN")),null==(s=u.$$smap.s_format)&&(s=m("DEFAULT_S")),i.categories=S(f.$map(),"with_index",[1],function(Y,H){var ee,te,ne;return null==Y&&(Y=g),null==H&&(H=g),te=null==(ee=k(Y))[0]?g:ee[0],ne=null==ee[1]?g:ee[1],W(m("SaiFicSkillTable"),"Category").$new(te,ne,H,s)},{$$has_top_level_mlhs_arg:!0}),i.rtt=R,i.rct=F,i.rttn=v.$to_a(),i.rtt_format=r,i.rct_format=d,i.rttn_format=t},-2),T(p[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),x.$attr_reader("categories"),B(x,"$roll_command",function(f,u){var F,R=this,v=g,r=g;return U(["RTT",R.rtt]["$include?"](F=u))?R.$format_skill(R.rtt_format,R.$roll_skill(f)):U(["RCT",R.rct]["$include?"](F))?(v=R.$roll_category(f),R.$format(R.rct_format,A(["category_dice","category_name"],{category_dice:v.$dice(),category_name:v.$name()}))):U(r=m("RTTN").$index(F))||U(r=R.rttn.$index(F))?R.$format_skill(R.rttn_format,R.categories["$[]"](r).$roll(f)):g}),B(x,"$roll_category",function(f){return this.categories["$[]"](G(f.$roll_once(6),1))}),B(x,"$roll_skill",function(f){return this.$roll_category(f).$roll(f)}),B(x,"$prefixes",function(){var f=this;return q(["RTT[1-6]?","RCT",f.rtt,f.rct],f.rttn).$compact()}),x.$private(),B(x,"$format_skill",function(f,u){return this.$format(f,A(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:u.$category_dice(),row_dice:u.$row_dice(),category_name:u.$category_name(),skill_name:u.$name(),text:u.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var U,P,$,a,w,n,l,W,q,V=e.module,L=e.klass,_=e.hash2,A=e.defs,S=e.truthy,D=e.def,j=e.rb_minus,T=[],k=e.nil;return U=T,P=q=[V(T[0],"BCDice")].concat(U),$=W=[V(q[0],"DiceTable")].concat(P),w=[a=L(W[0],null,"Table")].concat($),n=e.$r(w),(l=a.$$prototype).times=l.sides=l.name=l.items=k,A(a,"$from_i18n",function(z,E){var x=k;return x=n("I18n").$t(z,_(["locale"],{locale:E})),this.$new(x["$[]"]("name"),x["$[]"]("type"),x["$[]"]("items"))}),D(a,"$initialize",function(z,E,I){var x=this,p=k;return x.name=z,x.items=I.$freeze(),p=/(\d+)D(\d+)/i.$match(E),S(p)||x.$raise(n("ArgumentError"),"Unexpected table type: "+E),x.times=p["$[]"](1).$to_i(),x.sides=p["$[]"](2).$to_i()}),D(a,"$roll",function(z){var I,E=this;return I=z.$roll_sum(E.times,E.sides),E.$choice(I)}),D(a,"$choice",function(z){var I,E=this;return I=j(z,E.times),n("RollResult").$new(E.name,z,E.items["$[]"](I))})},Opal.modules["bcdice/dice_table"]=function(e){var V=e.top;return V.$require("bcdice/dice_table/roll_result"),V.$require("bcdice/dice_table/chain_table"),V.$require("bcdice/dice_table/d66_grid_table"),V.$require("bcdice/dice_table/d66_half_grid_table"),V.$require("bcdice/dice_table/d66_one_third_table"),V.$require("bcdice/dice_table/d66_left_range_table"),V.$require("bcdice/dice_table/d66_parity_table"),V.$require("bcdice/dice_table/d66_range_table"),V.$require("bcdice/dice_table/d66_table"),V.$require("bcdice/dice_table/range_table"),V.$require("bcdice/dice_table/sai_fic_skill_table"),V.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var D,B,G,T,V=e.module,L=e.const_set,_=[];return D=_,B=T=[V(_[0],"BCDice")].concat(D),G=[V(T[0],"D66SortType")].concat(B),L(G[0],"NO_SORT","no_sort"),L(G[0],"ASC","asc"),L(G[0],"DESC","desc"),function(k,B){var G=[V(k,"RoundType")].concat(B);return L(G[0],"CEIL","ceil"),L(G[0],"FLOOR","floor"),L(G[0],"ROUND","round")}(T[0],T)},Opal.modules["bcdice/translate"]=function(e){var B,M,P,g,W,G,V=e.module,L=e.ensure_kwargs,_=e.kwrestargs,S=e.hash2,D=e.def,j=[],T=e.nil;return B=j,M=G=[V(j[0],"BCDice")].concat(B),g=[P=V(G[0],"Translate")].concat(M),W=e.$r(g),D(P,"$translate",function(c,$){var a,w=this;return null==w.locale&&(w.locale=T),$=L($),a=_($,{}),W("I18n").$translate(c,S(["locale","raise"],{locale:w.locale,raise:!0}).$merge(e.to_hash(a)))},-2)},Opal.modules["bcdice/result"]=function(e){var P,K,g,B,G,L=e.klass,_=e.send,A=e.def,S=e.return_val,D=e.return_ivar,j=[],T=e.nil;return B=j,P=G=[(0,e.module)(j[0],"BCDice")].concat(B),[g=L(G[0],null,"Result")].concat(P),A(K=e.get_singleton_class(g),"$success",function(a){return _(this.$new(),"tap",[],function(l){var b;return null==l&&(l=T),l["$text="](a),_(l,"success=",b=[!0]),b[b.length-1]})}),A(K,"$failure",function(a){return _(this.$new(),"tap",[],function(l){var b;return null==l&&(l=T),l["$text="](a),_(l,"failure=",b=[!0]),b[b.length-1]})}),A(K,"$critical",function(a){return _(this.$new(),"tap",[],function(l){var b;return null==l&&(l=T),l["$text="](a),l["$critical="](!0),_(l,"success=",b=[!0]),b[b.length-1]})}),A(K,"$fumble",function(a){return _(this.$new(),"tap",[],function(l){var b;return null==l&&(l=T),l["$text="](a),l["$fumble="](!0),_(l,"failure=",b=[!0]),b[b.length-1]})}),A(K,"$nothing",S("nothing")),A(g,"$initialize",function(c){var $=this;return null==c&&(c=T),$.text=c,$.rands=T,$.detailed_rands=T,$.secret=!1,$.success=!1,$.failure=!1,$.critical=!1,$.fumble=!1},-1),g.$attr_accessor("text","rands","detailed_rands"),g.$attr_writer("secret","success","failure","critical","fumble"),A(g,"$secret?",D("secret")),A(g,"$success?",D("success")),A(g,"$failure?",D("failure")),A(g,"$critical?",D("critical")),A(g,"$fumble?",D("fumble")),A(g,"$condition=",function(c){return this.success=c,this.failure=c["$!"]()})},Opal.modules["racc/parser"]=function(e){var z,I,x,V=e.module,L=e.klass,_=e.truthy,A=e.const_set,S=e.defs,D=e.gvars,j=e.rb_lt,T=e.def,k=e.to_ary,B=e.send,U=e.neqeq,G=e.rb_plus,q=e.eqeq,M=e.rb_ge,P=e.rb_gt,g=e.rb_minus,W=e.rb_le,K=e.rb_times,c=e.assign_ivar_val,a=[],w=e.$r(a),n=e.nil,l=e.$$$;return z=a,I=[V(a[0],"Racc")].concat(z),x=e.$r(I),L(I[0],x("StandardError"),"ParseError"),_(l("::","ParseError","skip_raise")?"constant":n)||A(a[0],"ParseError",l(w("Racc"),"ParseError")),function(b,z){var o,f,u,R,F,x=[V(b,"Racc")].concat(z),p=e.$r(x);return _(p("Racc_No_Extensions","skip_raise")?"constant":n)||A(x[0],"Racc_No_Extensions",!1),o=x,u=[f=L(x[0],null,"Parser")].concat(o),R=e.$r(u),(F=f.$$prototype).yydebug=F.racc_debug_out=F.racc_error_status=F.racc_t=F.racc_vstack=F.racc_val=F.racc_state=F.racc_tstack=n,A(u[0],"Racc_Runtime_Version","1.4.6"),A(u[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),A(u[0],"Racc_Runtime_Core_Version_R","1.4.6"),A(u[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),A(u[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),A(u[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),A(u[0],"Racc_Runtime_Core_Version",R("Racc_Runtime_Core_Version_R")),A(u[0],"Racc_Runtime_Core_Revision",R("Racc_Runtime_Core_Revision_R")),A(u[0],"Racc_Runtime_Type","ruby"),S(R("Parser"),"$racc_runtime_type",function(){return R("Racc_Runtime_Type")}),T(f,"$_racc_setup",function(){var r,d,t=this,s=n,i=n;return null==D.stderr&&(D.stderr=n),_(l(t.$class(),"Racc_debug_parser"))||(t.yydebug=!1),_(null!=(r=t.yydebug)&&r!==n?"instance-variable":n)||(t.yydebug=!1),_(t.yydebug)&&(_(null!=(d=t.racc_debug_out)&&d!==n?"instance-variable":n)||(t.racc_debug_out=D.stderr),t.racc_debug_out=_(s=t.racc_debug_out)?s:D.stderr),i=l(t.$class(),"Racc_arg"),_(j(i.$size(),14))&&i["$[]="](13,!0),i}),T(f,"$_racc_init_sysvars",function(){var r=this;return r.racc_state=[0],r.racc_tstack=[],r.racc_vstack=[],r.racc_t=n,r.racc_val=n,r.racc_read_next=!0,r.racc_user_yyerror=!1,r.racc_error_status=0}),T(f,"$do_parse",function(){return this.$__send__(R("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),T(f,"$next_token",function(){return this.$raise(R("NotImplementedError"),this.$class()+"#next_token is not defined")}),T(f,"$_racc_do_parse_rb",function(r,d){var t,i=this,C=n,Y=n,H=n,ee=n,te=n,ne=n,ue=n,se=n;return t=k(r),C=null==t[0]?n:t[0],Y=null==t[1]?n:t[1],H=null==t[2]?n:t[2],ee=null==t[3]?n:t[3],te=null==t[10]?n:t[10],i.$_racc_init_sysvars(),ne=ue=se=n,B(i,"catch",["racc_end_parse"],function $e(){var ce,X,y=null==$e.$$s?this:$e.$$s,Q=n;for(null==y.racc_state&&(y.racc_state=n),null==y.racc_read_next&&(y.racc_read_next=n),null==y.racc_t&&(y.racc_t=n),null==y.yydebug&&(y.yydebug=n),null==y.racc_val&&(y.racc_val=n);_(!0);)for(_(se=ee["$[]"](y.racc_state["$[]"](-1)))?(_(y.racc_read_next)&&U(y.racc_t,0)&&(X=y.$next_token(),ce=k(X),ne=null==ce[0]?n:ce[0],y.racc_val=null==ce[1]?n:ce[1],y.racc_t=_(ne)?_(Q=te["$[]"](ne))?Q:1:0,_(y.yydebug)&&y.$racc_read_token(y.racc_t,ne,y.racc_val),y.racc_read_next=!1),se=G(se,y.racc_t),_(M(se,0))&&_(ue=C["$[]"](se))&&q(Y["$[]"](se),y.racc_state["$[]"](-1))||(ue=H["$[]"](y.racc_state["$[]"](-1)))):ue=H["$[]"](y.racc_state["$[]"](-1));_(ue=y.$_racc_evalact(ue,r)););},{$$s:i})}),T(f,"$yyparse",function(r,d){return this.$__send__(R("Racc_YY_Parse_Method"),r,d,this.$_racc_setup(),!0)}),T(f,"$_racc_yyparse_rb",function(r,d,t,s){var i,Y=this,H=n,ee=n,Z=n,te=n,ue=n,se=n,$e=n;return i=k(t),H=null==i[0]?n:i[0],ee=null==i[1]?n:i[1],Z=null==i[2]?n:i[2],te=null==i[3]?n:i[3],ue=null==i[10]?n:i[10],Y.$_racc_init_sysvars(),se=n,$e=n,B(Y,"catch",["racc_end_parse"],function ce(){var X=null==ce.$$s?this:ce.$$s;for(null==X.racc_state&&(X.racc_state=n);!_($e=te["$[]"](X.racc_state["$[]"](-1)));)for(;_(se=X.$_racc_evalact(Z["$[]"](X.racc_state["$[]"](-1)),t)););return B(r,"__send__",[d],function y(Q,J){var N=null==y.$$s?this:y.$$s,re=n,ae=n;for(null==N.racc_t&&(N.racc_t=n),null==N.racc_state&&(N.racc_state=n),null==N.racc_read_next&&(N.racc_read_next=n),null==Q&&(Q=n),null==J&&(J=n),N.racc_t=_(Q)?_(re=ue["$[]"](Q))?re:1:0,N.racc_val=J,N.racc_read_next=!1,$e=G($e,N.racc_t),_(M($e,0))&&_(se=H["$[]"]($e))&&q(ee["$[]"]($e),N.racc_state["$[]"](-1))||(se=Z["$[]"](N.racc_state["$[]"](-1)));_(se=N.$_racc_evalact(se,t)););for(;_(_(re=_(ae=($e=te["$[]"](N.racc_state["$[]"](-1)))["$!"]())?ae:N.racc_read_next["$!"]())?re:N.racc_t["$=="](0));)for(_($e)&&_($e=G($e,N.racc_t))&&_(M($e,0))&&_(se=H["$[]"]($e))&&q(ee["$[]"]($e),N.racc_state["$[]"](-1))||(se=Z["$[]"](N.racc_state["$[]"](-1)));_(se=N.$_racc_evalact(se,t)););},{$$s:X})},{$$s:Y})}),T(f,"$_racc_evalact",function(r,d){var t,Z,i=this,C=n,Y=n,ee=n,te=n,ne=n,ue=n;if(C=null==(t=k(d))[0]?n:t[0],Y=null==t[1]?n:t[1],ee=null==t[3]?n:t[3],Z=null==t[11]?n:t[11],te=null==t[12]?n:t[12],_(P(r,0))&&_(j(r,Z)))_(P(i.racc_error_status,0))&&(q(i.racc_t,1)||(i.racc_error_status=g(i.racc_error_status,1))),i.racc_vstack.$push(i.racc_val),i.racc_state.$push(r),i.racc_read_next=!0,_(i.yydebug)&&(i.racc_tstack.$push(i.racc_t),i.$racc_shift(i.racc_t,i.racc_tstack,i.racc_vstack));else if(_(j(r,0))&&_(P(r,te["$-@"]()))){if(ne=B(i,"catch",["racc_jump"],function se(){var $e=null==se.$$s?this:se.$$s;return null==$e.racc_state&&($e.racc_state=n),$e.racc_state.$push($e.$_racc_do_reduce(d,r)),!1},{$$s:i}),_(ne))switch(ne.valueOf()){case 1:return i.racc_user_yyerror=!0,te["$-@"]();case 2:return Z;default:i.$raise("[Racc Bug] unknown jump code")}}else if(q(r,Z))_(i.yydebug)&&i.$racc_accept(),i.$throw("racc_end_parse",i.racc_vstack["$[]"](0));else{if(q(r,te["$-@"]())){switch(i.racc_error_status.valueOf()){case 0:_(d["$[]"](21))||i.$on_error(i.racc_t,i.racc_val,i.racc_vstack);break;case 3:q(i.racc_t,0)&&i.$throw("racc_end_parse",n),i.racc_read_next=!0}for(i.racc_user_yyerror=!1,i.racc_error_status=3;_(!0)&&!(_(ue=ee["$[]"](i.racc_state["$[]"](-1)))&&(ue=G(ue,1),_(M(ue,0))&&_(r=C["$[]"](ue))&&q(Y["$[]"](ue),i.racc_state["$[]"](-1))));)_(W(i.racc_state.$size(),1))&&i.$throw("racc_end_parse",n),i.racc_state.$pop(),i.racc_vstack.$pop(),_(i.yydebug)&&(i.racc_tstack.$pop(),i.$racc_e_pop(i.racc_state,i.racc_tstack,i.racc_vstack));return r}i.$raise("[Racc Bug] unknown action "+r.$inspect())}return _(i.yydebug)&&i.$racc_next_state(i.racc_state["$[]"](-1),i.racc_state),n}),T(f,"$_racc_do_reduce",function(r,d){var t,te,ue,Q,J,N,ie,i=this,Y=n,H=n,ee=n,Z=n,ne=n,se=n,$e=n,ce=n,X=n,y=n,re=n,ae=n,O=n;return Y=null==(t=k(r))[4]?n:t[4],H=null==t[5]?n:t[5],ee=null==t[6]?n:t[6],Z=null==t[7]?n:t[7],te=null==t[8]?n:t[8],ne=null==t[9]?n:t[9],ue=null==t[13]?n:t[13],se=i.racc_state,$e=i.racc_vstack,ce=i.racc_tstack,X=K(d,-3),y=ne["$[]"](X),Q=ne["$[]"](G(X,1)),J=ne["$[]"](G(X,2)),N=[],_(i.yydebug)&&(re=ce["$[]"](y["$-@"](),y)),ae=$e["$[]"](y["$-@"](),y),_(i.yydebug)&&ce["$[]="](y["$-@"](),y,N),$e["$[]="](y["$-@"](),y,N),se["$[]="](y["$-@"](),y,N),_(ue)?$e.$push(i.$__send__(J,ae,$e,ae["$[]"](0))):$e.$push(i.$__send__(J,ae,$e)),ce.$push(Q),_(i.yydebug)&&i.$racc_reduce(re,Q,ce,$e),ie=g(Q,te),_(X=Z["$[]"](ie))&&(X=G(X,se["$[]"](-1)),_(M(X,0))&&_(O=Y["$[]"](X))&&q(H["$[]"](X),ie))?O:ee["$[]"](ie)}),T(f,"$on_error",function(r,d,t){var i,s=this;return s.$raise(R("ParseError"),s.$sprintf("\nparse error on value %s (%s)",d.$inspect(),_(i=s.$token_to_str(r))?i:"?"))}),T(f,"$yyerror",function(){return this.$throw("racc_jump",1)}),T(f,"$yyaccept",function(){return this.$throw("racc_jump",2)}),T(f,"$yyerrok",c("racc_error_status",0)),T(f,"$racc_read_token",function(r,d,t){var s=this;return s.racc_debug_out.$print("read    "),s.racc_debug_out.$print(d.$inspect(),"(",s.$racc_token2str(r),") "),s.racc_debug_out.$puts(t.$inspect()),s.racc_debug_out.$puts()}),T(f,"$racc_shift",function(r,d,t){var s=this;return s.racc_debug_out.$puts("shift   "+s.$racc_token2str(r)),s.$racc_print_stacks(d,t),s.racc_debug_out.$puts()}),T(f,"$racc_reduce",function(r,d,t,s){var i=this,C=n;return(C=i.racc_debug_out).$print("reduce "),_(r["$empty?"]())?C.$print(" <none>"):B(r,"each",[],function Y(H){return null==H&&(H=n),C.$print(" ",(null==Y.$$s?this:Y.$$s).$racc_token2str(H))},{$$s:i}),C.$puts(" --\x3e "+i.$racc_token2str(d)),i.$racc_print_stacks(t,s),i.racc_debug_out.$puts()}),T(f,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),T(f,"$racc_e_pop",function(r,d,t){var s=this;return s.racc_debug_out.$puts("error recovering mode: pop token"),s.$racc_print_states(r),s.$racc_print_stacks(d,t),s.racc_debug_out.$puts()}),T(f,"$racc_next_state",function(r,d){var t=this;return t.racc_debug_out.$puts("goto    "+r),t.$racc_print_states(d),t.racc_debug_out.$puts()}),T(f,"$racc_print_stacks",function(r,d){var s=n;return(s=this.racc_debug_out).$print("        ["),B(r,"each_index",[],function i(C){return null==C&&(C=n),s.$print(" (",(null==i.$$s?this:i.$$s).$racc_token2str(r["$[]"](C))," ",d["$[]"](C).$inspect(),")")},{$$s:this}),s.$puts(" ]")}),T(f,"$racc_print_states",function(r){var t=n;return(t=this.racc_debug_out).$print("        ["),B(r,"each",[],function(i){return null==i&&(i=n),t.$print(" ",i)}),t.$puts(" ]")}),T(f,"$racc_token2str",function(r){var t;return _(t=l(this.$class(),"Racc_token_to_s_table")["$[]"](r))?t:this.$raise("[Racc Bug] can't convert token "+r+" to string")}),T(f,"$token_to_str",function(r){return l(this.$class(),"Racc_token_to_s_table")["$[]"](r)})}(a[0],a)},Opal.modules["bcdice/arithmetic/node"]=function(e){var c,n,E,o,f,x,p,b,a,V=e.module,L=e.klass,_=e.def,A=e.thrower,S=e.return_ivar,D=e.send2,j=e.find_super,T=e.eqeq,k=e.const_set,B=e.eqeqeq,U=e.rb_divide,G=e.truthy,q=e.assign_ivar,M=e.alias,P=[],g=e.nil,W=e.$$$;return c=P,n=a=[V(P[0],"BCDice")].concat(c),E=b=[V(a[0],"Arithmetic")].concat(n),x=[V(b[0],"Node")].concat(E),p=e.$r(x),(f=(o=L(x[0],null,"BinaryOp")).$$prototype).lhs=f.rhs=f.op=g,_(o,"$initialize",function(R,F,v){var r=this;return r.lhs=R,r.op=F,r.rhs=v}),_(o,"$eval",function(R){try{A("eval_return");var d,v=this,r=g;return r=v.lhs.$eval(R),d=v.rhs.$eval(R),r.$send(v.op,d)}catch(t){if(t===e.t_eval_return)return t.$v;throw t}}),_(o,"$output",function(){var R=this;return""+R.lhs.$output()+R.op+R.rhs.$output()}),_(o,"$s_exp",function(){var R=this;return"("+R.$op_for_s_exp()+" "+R.lhs.$s_exp()+" "+R.rhs.$s_exp()+")"}),_(o,"$op_for_s_exp",S("op")),function(m,h,o){var f=L(m,h,"DivideBase"),u=[f].concat(o),R=e.$r(u),F=f.$$prototype;F.lhs=F.rhs=F.op=g,_(f,"$initialize",function v(r,d){return v.$$p=null,D(this,j(this,"initialize",v,!1,!0),"initialize",[r,"/",d],null)}),_(f,"$eval",function(r){try{A("eval_return");var s,i,t=this;return s=t.lhs.$eval(r),i=t.rhs.$eval(r),T(i,0)&&t.$raise(R("ZeroDivisionError")),t.$divide_and_round(s,i,r)}catch(C){if(C===e.t_eval_return)return C.$v;throw C}}),_(f,"$output",function v(){var r=v.$$p||g,d=this;return v.$$p=null,""+D(d,j(d,"output",v,!1,!0),"output",[],r)+d.$rounding_method()}),f.$private(),_(f,"$rounding_method",function(){return W(this.$class(),"ROUNDING_METHOD")}),_(f,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),_(f,"$divide_and_round",function(r,d,t){return this.$raise(R("NotImplementedError"))})}(x[0],p("BinaryOp"),x),function(m,h,o){var f=L(m,h,"DivideWithGameSystemDefault"),u=[f].concat(o),R=e.$r(u);k(u[0],"ROUNDING_METHOD",""),f.$private(),_(f,"$divide_and_round",function(v,r,d){var t,s=g;return B(W(R("RoundType"),"CEIL"),t=d)?U(v.$to_f(),r).$ceil():B(W(R("RoundType"),"ROUND"),t)?(s=U(v.$to_f(),r),G(s["$negative?"]())?s.$abs().$round()["$-@"]():s.$round()):U(v,r).$floor()})}(x[0],p("DivideBase"),x),function(m,h,o){var f=L(m,h,"DivideWithCeil"),u=[f].concat(o);k(u[0],"ROUNDING_METHOD","C"),f.$private(),_(f,"$divide_and_round",function(F,v,r){return U(F.$to_f(),v).$ceil()})}(x[0],p("DivideBase"),x),function(m,h,o){var f=L(m,h,"DivideWithRound"),u=[f].concat(o);k(u[0],"ROUNDING_METHOD","R"),f.$private(),_(f,"$divide_and_round",function(F,v,r){var d=g;return d=U(F.$to_f(),v),G(d["$negative?"]())?d.$abs().$round()["$-@"]():d.$round()})}(x[0],p("DivideBase"),x),function(m,h,o){var f=L(m,h,"DivideWithFloor"),u=[f].concat(o);k(u[0],"ROUNDING_METHOD","F"),f.$private(),_(f,"$divide_and_round",function(F,v,r){return U(F,v).$floor()})}(x[0],p("DivideBase"),x),function(m,h){var o=L(m,null,"Negative");o.$$prototype.body=g,_(o,"$initialize",q("body")),_(o,"$eval",function(R){try{return A("eval_return"),this.body.$eval(R)["$-@"]()}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(o,"$output",function(){return"-"+this.body.$output()}),_(o,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(x[0]),function(m,h){var o=L(m,null,"Parenthesis");o.$$prototype.expr=g,_(o,"$initialize",q("expr")),_(o,"$eval",function(R){try{return A("eval_return"),this.expr.$eval(R)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),_(o,"$output",function(){return"("+this.expr.$output()+")"}),_(o,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(x[0]),function(m,h){var o=L(m,null,"Number");return o.$$prototype.value=g,_(o,"$initialize",q("value")),_(o,"$eval",S("value")),_(o,"$output",function(){return this.value.$to_s()}),M(o,"s_exp","output")}(x[0])},Opal.modules.strscan=function(e){var q,M,P,g,W,L=e.def,_=e.truthy,A=e.eqeqeq,S=e.Opal,D=e.return_ivar,j=e.send,T=e.alias,k=[],B=e.nil;return q=k,P=[M=(0,e.klass)(k[0],null,"StringScanner")].concat(q),g=e.$r(P),(W=M.$$prototype).pos=W.string=W.working=W.matched=W.prev_pos=W.match=B,M.$attr_reader("pos","matched"),L(M,"$initialize",function(c){var $=this;return $.string=c,$.pos=0,$.matched=B,$.working=c,$.match=[]}),M.$attr_reader("string"),L(M,"$beginning_of_line?",function(){var c=this;return 0===c.pos||"\n"===c.string.charAt(c.pos-1)}),L(M,"$scan",function(c){var $=this,a=(c=$.$anchor(c)).exec($.working);return null==a?$.matched=B:($.prev_pos=$.pos,$.pos+=a[0].length,$.working=$.working.substring(a[0].length),$.matched=a[0],$.match=a,a[0])}),L(M,"$scan_until",function(c){var $=this;c=$.$anchor(c);for(var a=$.working,w=0;a.length!=w;++w){var n=c.exec(a.substr(w));if(null!==n){var l=w+n[0].length,b=a.substr(0,l);return $.matched=n[0],$.match=n,$.prev_pos=$.pos+w,$.pos+=l,$.working=a.substr(l),b}}return $.matched=B}),L(M,"$[]",function(c){var a;if(_(this.match["$empty?"]()))return B;A(g("Symbol"),a=c)?c=c.$to_s():A(g("String"),a)||(c=S["$coerce_to!"](c,g("Integer"),"to_int"));var w=this.match;return c<0&&(c+=w.length),c<0||c>=w.length||null==w[c]?B:w[c]}),L(M,"$check",function(c){var $=this,a=(c=$.$anchor(c)).exec($.working);return $.matched=null==a?B:a[0]}),L(M,"$check_until",function(c){var $=this,a=$.prev_pos,w=$.pos,n=$.working,l=$.$scan_until(c);return $.prev_pos=a,$.pos=w,$.working=n,l}),L(M,"$peek",function(c){return this.working.substring(0,c)}),L(M,"$eos?",function(){return 0===this.working.length}),L(M,"$exist?",function(c){var a=c.exec(this.working);return null==a?B:0==a.index?0:a.index+1}),L(M,"$skip",function(c){var $=this,a=(c=$.$anchor(c)).exec($.working);if(null==a)return $.match=[],$.matched=B;var w=a[0],n=w.length;return $.matched=w,$.match=a,$.prev_pos=$.pos,$.pos+=n,$.working=$.working.substring(n),n}),L(M,"$skip_until",function(c){var a=this.$scan_until(c);return a===B?B:(this.matched=a.substr(-1),a.length)}),L(M,"$get_byte",function(){var c=this,$=B;return c.pos<c.string.length?(c.prev_pos=c.pos,c.pos+=1,$=c.matched=c.working.substring(0,1),c.working=c.working.substring(1)):c.matched=B,$}),L(M,"$match?",function(c){var $=this,a=(c=$.$anchor(c)).exec($.working);return null==a?B:($.prev_pos=$.pos,a[0].length)}),L(M,"$pos=",function(c){var $=this;return c<0&&(c+=$.string.$length()),$.pos=c,$.working=$.string.slice(c)}),L(M,"$matched_size",function(){return this.matched===B?B:this.matched.length}),L(M,"$post_match",function(){var c=this;return c.matched===B?B:c.string.substr(c.pos)}),L(M,"$pre_match",function(){var c=this;return c.matched===B?B:c.string.substr(0,c.prev_pos)}),L(M,"$reset",function(){var c=this;return c.working=c.string,c.matched=B,c.pos=0}),L(M,"$rest",D("working")),L(M,"$rest?",function(){return 0!==this.working.length}),L(M,"$rest_size",function(){return this.$rest().$size()}),L(M,"$terminate",function(){var c,$=this;return $.match=B,c=[$.string.$length()],j($,"pos=",c),c[c.length-1]}),L(M,"$unscan",function(){var c=this;return c.pos=c.prev_pos,c.prev_pos=B,c.match=B,c}),T(M,"bol?","beginning_of_line?"),T(M,"getch","get_byte"),M.$private(),L(M,"$anchor",function(c){var $=c.toString().match(/\/([^\/]+)$/);return $=$?$[1]:void 0,new RegExp("^(?:"+c.source+")",$)})},Opal.modules["bcdice/normalize"]=function(e){var T,G,B,V=e.module,L=e.eqeqeq,_=e.def,A=e.eqeq,S=[],D=e.nil;return T=S,B=[V(S[0],"BCDice")].concat(T),(G=V(B[0],"Normalize")).$module_function(),_(G,"$comparison_operator",function(M){var P;return L(/<=|=</,P=M)?"<=":L(/>=|=>/,P)?">=":L(/<>|!=|=!/,P)?"!=":L(/</,P)?"<":L(/>/,P)?">":L(/=/,P)?"==":D}),_(G,"$target_number",function(M){return A(M,"?")?M:M.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var q,W,w,n,l,b,z,c,P,V=e.module,L=e.klass,_=e.const_set,A=e.hash2,S=e.truthy,D=e.send,j=e.def,T=e.thrower,k=e.top,B=[],U=e.nil;return k.$require("strscan"),k.$require("bcdice/normalize"),q=B,W=P=[V(B[0],"BCDice")].concat(q),w=c=[V(P[0],"Command")].concat(W),l=[n=L(c[0],null,"Lexer")].concat(w),b=e.$r(l),(z=n.$$prototype).scanner=z.notations=U,_(l[0],"SYMBOLS",A(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),j(n,"$initialize",function(I,x){var p,m,o;return I=S(o=(p=(m=I)===U||null==m?U:m.$split(" ",2))===U||null==p?U:p.$first())?o:"",this.scanner=b("StringScanner").$new(I),this.notations=D(x,"map",[],function(u){return null==u&&(u=U),S(u["$is_a?"](b("String")))?b("Regexp").$new(u):u})}),j(n,"$next_token",function(){try{var I=T("return"),x=this,p=U,m=U,o=U,f=U;return S(x.scanner["$eos?"]())?[!1,"$"]:(D(x.notations,"each",[],function u(R){var v,F=null==u.$$s?this:u.$$s;if(null==F.scanner&&(F.scanner=U),null==R&&(R=U),v=F.scanner.$scan(R),!S(v))return U;I.$throw(["NOTATION",v])},{$$s:x,$$ret:I}),S(p=x.scanner.$scan(/\d+/))?["NUMBER",p.$to_i()]:S(m=x.scanner.$scan(/[<>!=]+/))?(m=b("Normalize").$comparison_operator(m),[S(m)?"CMP_OP":"ILLEGAL",m]):(o=x.scanner.$getch().$upcase(),[S(f=b("SYMBOLS")["$[]"](o))?f:o.$to_sym(),o]))}catch(u){if(u===I)return u.$v;throw u}}),j(n,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var k,q,K,c,$,a,w,P,U,V=e.module,L=e.klass,_=e.def,A=e.return_ivar,S=e.truthy,D=[],j=e.nil;return k=D,q=U=[V(D[0],"BCDice")].concat(k),K=P=[V(U[0],"Command")].concat(q),$=[c=L(P[0],null,"Parsed")].concat(K),a=e.$r($),(w=c.$$prototype).critical=w.fumble=w.dollar=w.modify_number=w.question_target=w.target_number=w.prefix_number=w.command=w.suffix_number=w.cmp_op=j,c.$attr_accessor("command"),c.$attr_accessor("prefix_number"),c.$attr_accessor("suffix_number"),c.$attr_accessor("critical"),c.$attr_accessor("fumble"),c.$attr_accessor("dollar"),c.$attr_accessor("modify_number"),c.$attr_accessor("cmp_op"),c.$attr_accessor("target_number"),c.$attr_writer("question_target"),_(c,"$initialize",function(){var l=this;return l.prefix_number=j,l.suffix_number=j,l.critical=j,l.fumble=j,l.dollar=j,l.cmp_op=j,l.target_number=j,l.question_target=!1}),_(c,"$question_target?",A("question_target")),_(c,"$to_s",function(l){var b=this,z=j,E=j,I=j,x=j,p=j;switch(null==l&&(l="after_command"),z=S(b.critical)?"@"+b.critical:j,E=S(b.fumble)?"#"+b.fumble:j,I=S(b.dollar)?"$"+b.dollar:j,x=a("Format").$modifier(b.modify_number),p=S(b.question_target)?"?":b.target_number,l.valueOf()){case"after_command":return[b.prefix_number,b.command,b.suffix_number,z,E,I,x,b.cmp_op,p].$join();case"after_modify_number":return[b.prefix_number,b.command,b.suffix_number,x,z,E,I,b.cmp_op,p].$join();case"after_target_number":return[b.prefix_number,b.command,b.suffix_number,x,b.cmp_op,p,z,E,I].$join();default:return j}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var l,I,f,d,t,s,i,C,Y,H,ee,Z,ue,u,v,r,ce,p,m,z,V=e.klass,L=e.module,_=e.slice,A=e.extract_kwargs,S=e.ensure_kwargs,D=e.get_kwarg,j=e.send2,T=e.find_super,k=e.def,B=e.send,U=e.eqeq,G=e.thrower,q=e.hash,M=e.const_set,P=e.truthy,g=e.to_ary,W=e.hash2,K=e.top,c=[],$=e.$r(c),a=e.nil,w=e.$$$;return K.$require("racc/parser.rb"),K.$require("bcdice/arithmetic/node"),K.$require("bcdice/command/lexer"),K.$require("bcdice/command/parsed"),V(w($("BCDice"),"Command"),w($("Racc"),"Parser"),"Parser"),l=c,I=z=[L(c[0],"BCDice")].concat(l),p=[L(z[0],"Command")].concat(I),m=e.$r(p),f=p,v=[u=V(p[0],w(m("Racc"),"Parser"),"Parser")].concat(f),r=e.$r(v),(ce=u.$$prototype).notations=ce.lexer=ce.modifier=ce.suffix_number=ce.prefix_number=ce.need_suffix_number=ce.need_prefix_number=ce.critical=ce.fumble=ce.dollar=ce.allowed_cmp_op=ce.question_target=a,k(u,"$initialize",function X(y,Q){var J,N,re,ae,O=this;return X.$$p=null,J=_(arguments),N=A(J),N=S(N),re=J,ae=D(N,"round_type"),j(O,T(O,"initialize",X,!1,!0),"initialize",[],null),O.notations=re,O.round_type=ae,O.prefix_number=!1,O.suffix_number=!1,O.need_prefix_number=!1,O.need_suffix_number=!1,O.modifier=!0,O.critical=!1,O.fumble=!1,O.dollar=!1,O.allowed_cmp_op=[a,">=",">","<=","<","==","!="],O.question_target=!1},-2),k(u,"$disable_modifier",function(){return this.modifier=!1,this}),k(u,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),k(u,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),k(u,"$has_prefix_number",function(){var y=this;return y.prefix_number=!0,y.need_prefix_number=!0,y}),k(u,"$has_suffix_number",function(){var y=this;return y.suffix_number=!0,y.need_suffix_number=!0,y}),k(u,"$enable_critical",function(){return this.critical=!0,this}),k(u,"$enable_fumble",function(){return this.fumble=!0,this}),k(u,"$enable_dollar",function(){return this.dollar=!0,this}),k(u,"$restrict_cmp_op_to",function(y){var Q;return Q=_(arguments),this.allowed_cmp_op=Q,this},-1),k(u,"$enable_question_target",function(){return this.question_target=!0,this}),k(u,"$parse",function(y){var Q=this;try{return Q.lexer=r("Lexer").$new(y,Q.notations),Q.$do_parse()}catch(J){if(!e.rescue(J,[r("ParseError"),r("ZeroDivisionError")]))throw J;try{return a}finally{e.pop_exception()}}}),u.$private(),k(u,"$parsed",function(y,Q,J,N){try{return G("eval_return"),B(r("Parsed").$new(),"tap",[],function ie(O){var _e,le,de,me,ve,fe,be,oe=null==ie.$$s?this:ie.$$s;return null==oe.round_type&&(oe.round_type=a),null==O&&(O=a),O["$command="](y["$[]"]("command")),O["$prefix_number="]((_e=y["$[]"]("prefix"))===a||null==_e?a:_e.$eval(oe.round_type)),O["$suffix_number="]((le=y["$[]"]("suffix"))===a||null==le?a:le.$eval(oe.round_type)),O["$critical="]((de=Q["$[]"]("critical"))===a||null==de?a:de.$eval(oe.round_type)),O["$fumble="]((me=Q["$[]"]("fumble"))===a||null==me?a:me.$eval(oe.round_type)),O["$dollar="]((ve=Q["$[]"]("dollar"))===a||null==ve?a:ve.$eval(oe.round_type)),O["$modify_number="](J.$eval(oe.round_type)),O["$cmp_op="](N["$[]"]("cmp_op")),U(N["$[]"]("target"),"?")?(O["$question_target="](!0),B(O,"target_number=",fe=[0]),fe[fe.length-1]):(O["$question_target="](!1),fe=[(be=N["$[]"]("target"),be===a||null==be?a:be.$eval(oe.round_type))],B(O,"target_number=",fe),fe[fe.length-1])},{$$s:this})}catch(ie){if(ie===e.t_eval_return)return ie.$v;throw ie}}),k(u,"$next_token",function(){return this.lexer.$next_token()}),d=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),t=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),s=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),i=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),C=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),Y=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),H=[a,6,13,3,9,-1,27,-15,-10,-1,-38],ee=[a,a,a,a,a,a,19,16,15,a,a],Z=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ue=q(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),M(v[0],"Racc_arg",[d,t,i,s,C,Y,ee,H,19,Z,ue,58,35,!0]),P(r("Ractor","skip_raise")?"constant":a)&&r("Ractor").$make_shareable(r("Racc_arg")),M(v[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),P(r("Ractor","skip_raise")?"constant":a)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),M(v[0],"Racc_debug_parser",!1),k(u,"$_reduce_1",function(y,Q,J){var N;return P(this.modifier)||this.$raise(r("ParseError")),N=g(y),this.$parsed(null==N[0]?a:N[0],null==N[1]?a:N[1],null==N[2]?a:N[2],null==N[3]?a:N[3])}),k(u,"$_reduce_2",function(y,Q,J){var N;return P(this.modifier)||this.$raise(r("ParseError")),N=g(y),this.$parsed(null==N[0]?a:N[0],null==N[2]?a:N[2],null==N[1]?a:N[1],null==N[3]?a:N[3])}),k(u,"$_reduce_3",function(y,Q,J){var N,_e;return _e=null==(N=g(y))[2]?a:N[2],this.$parsed(null==N[0]?a:N[0],null==N[1]?a:N[1],w(w(r("Arithmetic"),"Node"),"Number").$new(0),_e)}),k(u,"$_reduce_4",function(y,Q,J){var N=this;return P(N.prefix_number)&&P(N.suffix_number)||N.$raise(r("ParseError")),W(["command","prefix","suffix"],{command:y["$[]"](1),prefix:y["$[]"](0),suffix:y["$[]"](2)})}),k(u,"$_reduce_5",function(y,Q,J){var N=this;return P(N.prefix_number)||N.$raise(r("ParseError")),P(N.need_suffix_number)&&N.$raise(r("ParseError")),W(["command","prefix"],{command:y["$[]"](1),prefix:y["$[]"](0)})}),k(u,"$_reduce_6",function(y,Q,J){var N=this;return P(N.suffix_number)||N.$raise(r("ParseError")),P(N.need_prefix_number)&&N.$raise(r("ParseError")),W(["command","suffix"],{command:y["$[]"](0),suffix:y["$[]"](1)})}),k(u,"$_reduce_7",function(y,Q,J){var N=this;return(P(N.need_prefix_number)||P(N.need_suffix_number))&&N.$raise(r("ParseError")),W(["command"],{command:y["$[]"](0)})}),k(u,"$_reduce_8",function(y,Q,J){return W([],{})}),k(u,"$_reduce_9",function(y,Q,J){var N,_e,ie=a;return ie=null==(N=g(y))[0]?a:N[0],_e=null==N[2]?a:N[2],P(this.critical)&&P(ie["$[]"]("critical")["$nil?"]())||this.$raise(r("ParseError")),ie["$[]="]("critical",_e),ie}),k(u,"$_reduce_10",function(y,Q,J){var N,_e,ie=a;return ie=null==(N=g(y))[0]?a:N[0],_e=null==N[2]?a:N[2],P(this.fumble)&&P(ie["$[]"]("fumble")["$nil?"]())||this.$raise(r("ParseError")),ie["$[]="]("fumble",_e),ie}),k(u,"$_reduce_11",function(y,Q,J){var N,_e,ie=a;return ie=null==(N=g(y))[0]?a:N[0],_e=null==N[2]?a:N[2],P(this.dollar)&&P(ie["$[]"]("dollar")["$nil?"]())||this.$raise(r("ParseError")),ie["$[]="]("dollar",_e),ie}),k(u,"$_reduce_12",function(y,Q,J){return y["$[]"](1)}),k(u,"$_reduce_13",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1))}),k(u,"$_reduce_14",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2))}),k(u,"$_reduce_15",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2))}),k(u,"$_reduce_16",function(y,Q,J){return P(this.allowed_cmp_op["$include?"](a))||this.$raise(r("ParseError")),W([],{})}),k(u,"$_reduce_17",function(y,Q,J){var N,ie,O;return O=null==(N=g(y))[1]?a:N[1],P(this.allowed_cmp_op["$include?"](ie=null==N[0]?a:N[0]))||this.$raise(r("ParseError")),W(["cmp_op","target"],{cmp_op:ie,target:O})}),k(u,"$_reduce_18",function(y,Q,J){var re,N=this;return re=y["$[]"](0),P(N.question_target)||N.$raise(r("ParseError")),P(N.allowed_cmp_op["$include?"](re))||N.$raise(r("ParseError")),W(["cmp_op","target"],{cmp_op:re,target:"?"})}),k(u,"$_reduce_19",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"+",y["$[]"](2))}),k(u,"$_reduce_20",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"-",y["$[]"](2))}),k(u,"$_reduce_22",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"BinaryOp").$new(y["$[]"](0),"*",y["$[]"](2))}),k(u,"$_reduce_23",function(y,Q,J){return y["$[]"](3).$new(y["$[]"](0),y["$[]"](2))}),k(u,"$_reduce_25",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),k(u,"$_reduce_26",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"DivideWithCeil")}),k(u,"$_reduce_27",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"DivideWithCeil")}),k(u,"$_reduce_28",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"DivideWithRound")}),k(u,"$_reduce_29",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"DivideWithFloor")}),k(u,"$_reduce_30",function(y,Q,J){return y["$[]"](1)}),k(u,"$_reduce_31",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"Negative").$new(y["$[]"](1))}),k(u,"$_reduce_33",function(y,Q,J){return y["$[]"](1)}),k(u,"$_reduce_34",function(y,Q,J){return w(w(r("Arithmetic"),"Node"),"Number").$new(y["$[]"](0))}),k(u,"$_reduce_none",function(y,Q,J){return y["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var B,M,K,c,$,a,g,G,V=e.module,L=e.send,_=e.eqeqeq,A=e.truthy,S=e.def,D=e.return_val,j=[],T=e.nil;return B=j,M=G=[V(j[0],"BCDice")].concat(B),K=g=[V(G[0],"Deprecated")].concat(M),$=[c=V(g[0],"Checker")].concat(K),a=e.$r($),c.$private(),S(c,"$check_result_legacy",function(n,l,b,z){var p,E=this,I=T,x=T,m=T,h=T;return I=L(l,"map",[],"sides".$to_proc()),p=(x=L(l,"map",[],"value".$to_proc())).$sum(),m=_([100],h=I)?E.$check_1D100(n,p,b,z):_([20],h)?E.$check_1D20(n,p,b,z):_([6,6],h)?E.$check_2D6(n,p,x,b,z):T,(A(m["$nil?"]())||A(m["$empty?"]()))&&(m=_([10],h=I.$uniq())?E.$check_nD10(n,p,x,b,z):_([6],h)?E.$check_nD6(n,p,x,b,z):T,A(m["$nil?"]())||A(m["$empty?"]()))?T:a("Result").$new(m.$delete_prefix(" \uff1e "))}),S(c,"$check_1D100",D(T)),S(c,"$check_1D20",D(T)),S(c,"$check_nD10",D(T)),S(c,"$check_2D6",D(T)),S(c,"$check_nD6",D(T))},Opal.modules["bcdice/base"]=function(e){var $,E,h,F,r,d,o,f,u,R,x,V=e.module,L=e.klass,_=e.slice,A=e.rb_plus,S=e.truthy,D=e.def,j=e.regexp,T=e.send,k=e.thrower,B=e.return_ivar,U=e.assign_ivar_val,G=e.eqeqeq,q=e.eqeq,M=e.return_val,P=e.range,g=e.rb_minus,W=e.rb_divide,K=e.rb_times,c=e.rb_ge,a=e.top,w=[],n=e.$r(w),l=e.nil,b=e.$$$;return a.$require("i18n"),a.$require("i18n/backend/fallbacks"),a.$require("bcdice/randomizer"),a.$require("bcdice/dice_table"),a.$require("bcdice/enum"),a.$require("bcdice/translate"),a.$require("bcdice/result"),a.$require("bcdice/command/parser"),a.$require("bcdice/deprecated/checker"),E=w,h=x=[V(w[0],"BCDice")].concat(E),f=[o=L(x[0],null,"Base")].concat(h),u=e.$r(f),(R=o.$$prototype).raw_input=R.randomizer=R.enabled_upcase_input=R.debug=l,r=[F=e.get_singleton_class(o)].concat(f),d=e.$r(r),F.$attr_reader("prefixes"),D(F,"$register_prefix",function(s){var C,H,Y=this;return null==Y.prefixes&&(Y.prefixes=l),C=_(arguments),Y.prefixes=A(S(H=Y.prefixes)?H:[],C.$flatten())},-1),D(F,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),D(F,"$prefixes_pattern",function(){var s=this,i=l;return null==s.prefixes_pattern&&(s.prefixes_pattern=l),null==s.prefixes&&(s.prefixes=l),s.prefixes_pattern=S(i=s.prefixes_pattern)?i:l,S(s.prefixes_pattern)?s.prefixes_pattern:(s.prefixes=S(i=s.prefixes)?i:[],s.prefixes.$freeze(),s.prefixes_pattern=(S(s.prefixes["$empty?"]())?/(?!)/:j(["^(S)?(",s.prefixes.$join("|"),")"],"i")).$freeze())}),D(F,"$command_pattern",function(){var s=this,i=l,C=l;return null==s.command_pattern&&(s.command_pattern=l),null==s.prefixes&&(s.prefixes=l),s.command_pattern=S(i=s.command_pattern)?i:l,S(s.command_pattern)?s.command_pattern:(s.prefixes=S(i=s.prefixes)?i:[],s.prefixes.$freeze(),C=A(T(b(d("CommonCommand"),"COMMANDS"),"map",[],function(H){return null==H&&(H=l),b(H,"PREFIX_PATTERN").$source()}),s.prefixes),s.command_pattern=j(["^S?(",C.$join("|"),")"],"i").$freeze())}),D(F,"$eval",function(s){try{return k("eval_return"),this.$new(s).$eval()}catch(Y){if(Y===e.t_eval_return)return Y.$v;throw Y}}),o.$include(u("Translate")),o.$include(b(u("Deprecated"),"Checker")),D(o,"$initialize",function(v){var r=this;return r.raw_input=v,r.sort_add_dice=!1,r.sort_barabara_dice=!1,r.d66_sort_type=b(u("D66SortType"),"NO_SORT"),r.enabled_d9=!1,r.round_type=b(u("RoundType"),"FLOOR"),r.sides_implicit_d=6,r.upper_dice_reroll_threshold=l,r.reroll_dice_reroll_threshold=l,r.default_cmp_op=l,r.default_target_number=l,r.enabled_upcase_input=!0,r.locale="ja_jp",r.randomizer=b(u("BCDice"),"Randomizer").$new(),r.debug=!1}),o.$attr_accessor("randomizer"),o.$attr_reader("d66_sort_type"),o.$attr_reader("round_type"),o.$attr_reader("sides_implicit_d"),o.$attr_reader("upper_dice_reroll_threshold"),o.$attr_reader("reroll_dice_reroll_threshold"),o.$attr_reader("default_cmp_op"),o.$attr_reader("default_target_number"),D(o,"$sort_add_dice?",B("sort_add_dice")),D(o,"$sort_barabara_dice?",B("sort_barabara_dice")),D(o,"$enabled_d9?",B("enabled_d9")),D(o,"$enable_debug",U("debug",!0)),D(o,"$eval",function(){var r,t,v=this,d=l;return r=b(u("BCDice"),"Preprocessor").$process(v.raw_input,v),d=S(t=v.$dice_command(r))?t:v.$eval_common_command(v.raw_input),S(d)?(d["$rands="](v.randomizer.$rand_results()),d["$detailed_rands="](v.randomizer.$detailed_rand_results()),d):l}),D(o,"$change_text",function(v){return v}),D(o,"$check_result",function(v,r,d,t){var s=this,i=l,C=l,Y=l,H=l,ee=l;return i=s.$check_result_legacy(v,r,d,t),S(i)?i:(C=T(r,"map",[],"sides".$to_proc()),H=(Y=T(r,"map",[],"value".$to_proc())).$sum(),i=G([100],ee=C)?s.$result_1d100(v,H,d,t):G([20],ee)?s.$result_1d20(v,H,d,t):G([6,6],ee)?s.$result_2d6(v,H,Y,d,t):l,q(i,u("Result").$nothing())?l:S(i)?i:(i=G([10],ee=C.$uniq())?s.$result_nd10(v,H,Y,d,t):G([6],ee)?s.$result_nd6(v,H,Y,d,t):l,q(i,u("Result").$nothing())?l:S(i)?i:s.$result_ndx(v,d,t)))}),D(o,"$grich_text",M(l)),o.$private(),D(o,"$eval_common_command",function(v){try{k("eval_return");var d=k("return");return v=this.$change_text(v),T(b(u("CommonCommand"),"COMMANDS"),"each",[],function s(i){var Y,C=null==s.$$s?this:s.$$s;if(null==C.randomizer&&(C.randomizer=l),null==i&&(i=l),Y=i.$eval(v,C,C.randomizer),!S(Y))return l;d.$throw(Y)},{$$s:this,$$ret:d}),l}catch(s){if(s===e.t_eval_return||s===d)return s.$v;throw s}}),D(o,"$dice_command",function(v){var r=this,d=l,t=l,s=l,i=l;return S(r.enabled_upcase_input)&&(v=v.$upcase()),d=r.$class().$prefixes_pattern().$match(v),S(d)?(t=d["$[]"](1)["$nil?"]()["$!"](),S(t)&&(v=v["$[]"](P(1,-1,!1))),s=r.$eval_game_system_specific_command(v),S(s["$is_a?"](u("Result")))?(s["$secret="](S(i=s["$secret?"]())?i:t),s):S(s["$nil?"]())||S(s["$empty?"]())||q(s,"1")?l:T(u("Result").$new(),"tap",[],function(Y){var H;return null==Y&&(Y=l),Y["$text="](s.$to_s()),T(Y,"secret=",H=[t]),H[H.length-1]})):l}),D(o,"$eval_game_system_specific_command",M(l)),D(o,"$result_ndx",function(v,r,d){return S(d["$is_a?"](u("String")))?l:S(v.$send(r,d))?u("Result").$success(this.$translate("success")):u("Result").$failure(this.$translate("failure"))}),D(o,"$result_1d100",M(l)),D(o,"$result_1d20",M(l)),D(o,"$result_nd10",M(l)),D(o,"$result_2d6",M(l)),D(o,"$result_nd6",M(l)),D(o,"$get_table_by_2d6",function(v){return this.$get_table_by_nD6(v,2)}),D(o,"$get_table_by_1d6",function(v){return this.$get_table_by_nD6(v,1)}),D(o,"$get_table_by_nD6",function(v,r){return this.$get_table_by_nDx(v,r,6)}),D(o,"$get_table_by_nDx",function(v,r,d){var s,i=l;return s=this.randomizer.$roll_sum(r,d),i=this.$get_table_value(v["$[]"](g(s,r))),S(i["$nil?"]())?["1",0]:[i,s]}),D(o,"$get_table_by_1d3",function(v){var t,s,r=this,i=l;return r.$debug("get_table_by_1d3"),t=r.randomizer.$roll_sum(1,6),r.$debug("num",t),s=W(g(t,1),2).$to_i(),r.$debug("index",s),i=v["$[]"](s),S(i["$nil?"]())?["1",0]:[i,t]}),D(o,"$get_table_by_d66_swap",function(v){var d;return d=this.randomizer.$roll_d66(b(u("D66SortType"),"ASC")),[this.$get_table_by_number(d,v),d]}),D(o,"$get_table_by_d66",function(v){var d,t,s,C,i=l;return d=this.randomizer.$roll_once(6),t=this.randomizer.$roll_once(6),s=A(K(g(d,1),6),g(t,1)),i=v["$[]"](s),C=""+d+t,S(i["$nil?"]())?["1",C]:[i,C]}),D(o,"$get_table_by_number",function(v,r,d){try{var t=k("return");return null==d&&(d="1"),T(r,"each",[],function i(C){var H,Y=null==i.$$s?this:i.$$s;if(null==C&&(C=l),H=C["$[]"](0),!S(c(H,v)))return l;t.$throw(Y.$get_table_value(C["$[]"](1)))},{$$s:this,$$ret:t}),this.$get_table_value(d)}catch(i){if(i===t)return i.$v;throw i}},-3),D(o,"$get_table_value",function(v){return S(v["$is_a?"](u("Proc")))?v.$call():v}),D(o,"$roll_tables",function(v,r){var t=l;return t=r["$[]"](v),S(t)?t.$roll(this.randomizer).$to_s():l}),D(o,"$debug",function(v,r){var t,s=this,i=l,C=l;return t=_(arguments,1),S(s.debug)?(i=S(v["$is_a?"](u("String")))?v:v.$inspect(),S(t["$empty?"]())?s.$warn(i):(C=T(t,"map",[],function(H){return null==H&&(H=l),S(H["$is_a?"](u("String")))?'"'+H+'"':H.$inspect()}),s.$warn(i+": "+C.$join(", ")))):l},-2),b(b(n("I18n"),"Backend"),"Simple").$include(b(b(n("I18n"),"Backend"),"Fallbacks")),n("I18n").$load_path()["$<<"](n("Dir")["$[]"](n("File").$join("bcdice","../../i18n/**/*.yml"))),n("I18n")["$default_locale="]("ja_jp"),$=[["ja_jp"]],T(n("I18n").$fallbacks(),"defaults=",$),$[$.length-1]},Opal.modules["bcdice/game_system/SkynautsBouken"]=function(e){var n,E,o,v,d,t,f,u,R,F,x,p,b,V=e.module,L=e.klass,_=e.const_set,A=e.hash,S=e.hash2,D=e.def,j=e.send2,T=e.find_super,k=e.truthy,B=e.to_ary,U=e.send,G=e.eqeq,q=e.range,M=e.rb_le,P=e.rb_ge,g=e.rb_plus,W=e.neqeq,c=[],$=e.nil,a=e.$$$;return e.top.$require("bcdice/base"),n=c,E=b=[V(c[0],"BCDice")].concat(n),x=[V(b[0],"GameSystem")].concat(E),p=e.$r(x),o=x,u=[f=L(x[0],p("Base"),"SkynautsBouken")].concat(o),R=e.$r(u),F=f.$$prototype,null==f.locale&&(f.locale=$),F.randomizer=$,_(u[0],"ID","SkynautsBouken"),_(u[0],"NAME","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09"),_(u[0],"SORT_KEY","\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642"),_(u[0],"HELP_MESSAGE","\u30fb\u884c\u70ba\u5224\u5b9a\uff08nSNt#f\uff09 n:\u30c0\u30a4\u30b9\u6570(\u7701\u7565\u66422)\u3001t:\u76ee\u6a19\u5024(\u7701\u7565\u66427)\u3001f:\u30d5\u30a1\u30f3\u30d6\u30eb\u5024(\u7701\u7565\u66421)\n    \u4f8b\uff09SN6#2\u30003SN\n\u30fb\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af (Dx/y@m) x:\u30c0\u30e1\u30fc\u30b8\u7bc4\u56f2\u3001y:\u653b\u6483\u56de\u6570\n\u3000\u3000m:\u300a\u5f3e\u9053\u5b66\u300b\uff08\u7701\u7565\u53ef\uff09\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\n\u3000\u3000\u4f8b\uff09 D/4\u3000D19/2\u3000D/3@8\u3000D[\u5927\u63fa\u308c]/2\n\u30fb\u56de\u907f(AVO@m\u30c0\u30e1\u30fc\u30b8)\n\u3000\u3000m:\u56de\u907f\u65b9\u5411\uff08\u4e0a:8\u3001\u4e0b:2\u3001\u5de6:4\u3001\u53f3:6\uff09\u3001\u30c0\u30e1\u30fc\u30b8\uff1a\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u7d50\u679c\n\u3000\u3000\u4f8b\uff09AVO@8[1,4],[2,6],[3,8]\u3000AVO@2[6,4],[2,6]\n\u30fbFT \u30d5\u30a1\u30f3\u30d6\u30eb\u8868(p76)\n\u30fbNV \u822a\u884c\u8868\n\u30fb\u822a\u884c\u30a4\u30d9\u30f3\u30c8\u8868\n\u3000\u30fbNEN \u822a\u884c\u7cfb\n\u3000\u30fbNEE \u906d\u9047\u7cfb\n\u3000\u30fbNEO \u8239\u5185\u7cfb\n\u3000\u30fbNEH \u56f0\u96e3\u7cfb\n\u3000\u30fbNEL \u9577\u65c5\u7cfb\n\n\u25a0 \u5224\u5b9a\u30bb\u30c3\u30c8\n\u30fb\u300a\u56de\u907f\u904b\u52d5\u300b\u5224\u5b9a+\u56de\u907f\uff08nSNt#f/AVO@\u30c0\u30e1\u30fc\u30b8\uff09\n\u3000\u3000nSNt#f \u2192 \u6210\u529f\u306a\u3089 AVO@m\n\u3000\u3000\u4f8b\uff09SN/AVO@8[1,4],[2,6],[3,8]\u30003SN#2/AVO@2[6,4],[2,6]\n\u30fb\u7832\u6483\u5224\u5b9a+\u30c0\u30e1\u30fc\u30b8\u30c1\u30a7\u30c3\u30af\u3000(nSNt#f/Dx/y@m)\n\u3000\u3000\u884c\u70ba\u5224\u5b9a\u306e\u51fa\u76ee\u5909\u66f4\u30bf\u30a4\u30df\u30f3\u30b0\u3092\u9003\u3059\u306e\u3067\u8981GM\u306e\u8a31\u53ef\n\u3000\u3000nSNt#f \u2192 \u6210\u529f\u306a\u3089 Dx/y@m\n\u3000\u3000\u4f8b\uff09SN/D/4\u30003SN#2/D[\u5927\u63fa\u308c]/2\n"),d=[v=e.get_singleton_class(f)].concat(u),t=e.$r(d),v.$private(),D(v,"$translate_direction_infos",function(i){return A(0,S(["name","position_diff"],{name:"",position_diff:[0,0]}),1,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.lower_left",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[-1,1]}),2,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.lower",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[0,1]}),3,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.lower_right",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[1,1]}),4,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.left",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[-1,0]}),5,S(["name","position_diff"],{name:"",position_diff:[0,0]}),6,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.right",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[1,0]}),7,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.upper_left",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[-1,-1]}),8,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.upper",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[0,-1]}),9,S(["name","position_diff"],{name:t("I18n").$translate("SkynautsBouken.directions.upper_right",S(["locale","raise"],{locale:i,raise:!0})),position_diff:[1,-1]})).$freeze()}),D(v,"$translate_tables",function(i){return S(["FT","NV","NEN","NEE","NEO","NEH","NEL"],{FT:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.FumbleTable",i),NV:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.VoyageTable",i),NEN:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.NavigationEventNavigationTable",i),NEE:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.NavigationEventEncounterTable",i),NEO:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.NavigationEventOnBoardTable",i),NEH:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.NavigationEventHardTable",i),NEL:a(t("DiceTable"),"Table").$from_i18n("SkynautsBouken.NavigationEventLongJourneyTable",i)}).$freeze()}),_(u[0],"TABLES",f.$translate_tables(f.locale)),f.$register_prefix("D","\\d?SN","AVO",R("TABLES").$keys()),D(f,"$initialize",function v(r){var t=this;return v.$$p=null,j(t,T(t,"initialize",v,!1,!0),"initialize",[r],null),t.round_type=a(R("RoundType"),"FLOOR")}),D(f,"$eval_game_system_specific_command",function(r){var t,s,i,C,Y,d=this;return k(t=k(s=k(i=k(C=k(Y=d.$command_sn(r))?Y:d.$command_d(r))?C:d.$command_avo(r))?i:d.$command_snavo(r))?s:d.$command_snd(r))?t:d.$roll_tables(r,a(d.$class(),"TABLES"))}),f.$private(),_(u[0],"DIRECTION_INFOS",f.$translate_direction_infos(f.locale)),_(u[0],"D_REGEXP",/^D([1-46-9]{0,8})(\[.+\]|S|F|SF|FS)?\/(\d{1,2})(@([2468]))?$/.$freeze()),D(f,"$command_sn",function(r){var d,t,s=this,i=$,C=$,Y=$,H=$,ee=$,Z=$,te=$;return s.$debug("SN",r),i=a(R("Command"),"Parser").$new(/[1-9]?SN(\d{0,2})/,S(["round_type"],{round_type:s.$round_type()})).$restrict_cmp_op_to($).$enable_fumble().$parse(r),k(i)?(t=U(i.$command().$split("SN",2),"map",[],"to_i".$to_proc()),Y=null==(d=B(t))[1]?$:d[1],G(C=null==d[0]?$:d[0],0)&&(C=2),G(Y,0)&&(Y=7),H=k(i.$fumble()["$nil?"]())?1:i.$fumble(),s.$debug("SN Parsed",C,Y,H),Z=(ee=s.randomizer.$roll_barabara(C,6)).$sort()["$[]"](q(-2,-1,!1)),te=G(Z,[6,6])?R("Result").$critical(s.$translate("SkynautsBouken.special")):k(M(ee.$max(),H))?R("Result").$fumble(s.$translate("SkynautsBouken.fumble")):k(P(Z.$sum(),Y))?R("Result").$success(s.$translate("success")):R("Result").$failure(s.$translate("failure")),G(C,2)?te["$text="](["("+C+"SN"+Y+"#"+H+")",Z.$sum()+"["+ee.$join(",")+"]",te.$text()].$compact().$join(" \uff1e ")):te["$text="](["("+C+"SN"+Y+"#"+H+")",g(g("[",ee.$join(",")),"]"),Z.$sum()+"["+Z.$join(",")+"]",te.$text()].$compact().$join(" \uff1e ")),te):$}),D(f,"$command_d",function(r){var d,t,s=this,i=$,C=$,Y=$,H=$,ee=$,Z=$,te=$,ne=$,ue=$;return i=R("D_REGEXP").$match(r),k(i)?(C=i["$[]"](3).$to_i(),Y=i["$[]"](1).$to_s(),H=i["$[]"](5).$to_i(),ee=s.$get_fire_points(C,Y),Z=["("+(r=r.$sub("SF/","["+s.$translate("SkynautsBouken.big_shake")+","+s.$translate("SkynautsBouken.fire")+"]/").$sub("FS/","["+s.$translate("SkynautsBouken.fire")+","+s.$translate("SkynautsBouken.big_shake")+"]/").$sub("F/","["+s.$translate("SkynautsBouken.fire")+"]/").$sub("S/","["+s.$translate("SkynautsBouken.big_shake")+"]/"))+")",s.$get_points_text(ee,0,0)],W(H,0)&&(t=(te=a(s.$class(),"DIRECTION_INFOS")["$[]"](H))["$[]"]("position_diff"),ne=null==(d=B(t))[0]?$:d[0],ue=null==d[1]?$:d[1],Z["$[]="](-1,g(Z["$[]"](-1),"\n")),Z["$<<"]("\u300a"+s.$translate("SkynautsBouken.ballistics")+"\u300b"+te["$[]"]("name")),Z["$<<"](s.$get_points_text(ee,ne,ue))),Z.$compact().$join(" \uff1e ")):$}),D(f,"$command_avo",function(r){var d,t,s=this,i=$,C=$,Y=$,H=$;return s.$debug("AVO",r),i=r.$match(/^AVO@([2468])(.*?)$/),k(i)?(t=(C=a(s.$class(),"DIRECTION_INFOS")["$[]"](i["$[]"](1).$to_i()))["$[]"]("position_diff"),d=B(t),Y=null==d[0]?$:d[0],H=null==d[1]?$:d[1],g("\u300a"+s.$translate("SkynautsBouken.avoidance")+"\u300b"+C["$[]"]("name")+" \uff1e ",U(i["$[]"](2),"gsub",[/\(?\[(\d),(\d{1,2})\]\)?/],function ee(){var te,ne,Z=null==ee.$$s?this:ee.$$s;return te=g(R("Regexp").$last_match(1).$to_i(),H),ne=g(R("Regexp").$last_match(2).$to_i(),Y),Z.$get_xy_text(ne,te)},{$$s:s}))):$}),D(f,"$command_snavo",function(r){var d,t,i,C,Y,s=this,H=$;return t=r.$split(/\/?AVO/,2),d=B(t),s.$debug("SNAVO",i=null==d[0]?$:d[0],C=null==d[1]?$:d[1]),Y=/^@([2468])(.*?)$/.$match(C),k(Y)&&(H=s.$command_sn(i),k(H))?(k(H["$success?"]())&&H["$text="](g(H.$text(),g("\n \uff1e ",s.$command_avo(g("AVO",C))))),H):$}),D(f,"$command_snd",function(r){var d,t,i,C,Y,s=this,H=$;return t=r.$split(/\/?D/,2),d=B(t),s.$debug("SND",i=null==d[0]?$:d[0],C=null==d[1]?$:d[1]),Y=R("D_REGEXP").$match("D"+C),k(Y)&&(H=s.$command_sn(i),k(H))?(k(H["$success?"]())&&H["$text="](g(H.$text(),"\n \uff1e "+s.$command_d(g("D",C)))),H):$}),D(f,"$get_points_text",function(r,d,t){var s=this;return g("["+s.$translate("SkynautsBouken.y")+","+s.$translate("SkynautsBouken.x")+"]=",U(r,"map",[],function i(C){return null==C&&(C=$),U(C,"map",[],function H(ee,Z){return null==ee&&(ee=$),null==Z&&(Z=$),(null==H.$$s?this:H.$$s).$get_xy_text(g(ee,d),g(Z,t))},{$$s:null==i.$$s?this:i.$$s}).$join()},{$$s:s}).$join(","))}),D(f,"$get_xy_text",function(r,d){return k(q(2,12,!1)["$include?"](r))&&k(q(1,6,!1)["$include?"](d))?"["+d+","+r+"]":"(["+d+","+r+"])"}),D(f,"$get_fire_points",function(r,d){var s;return s=U(d.$chars(),"map",[],"to_i".$to_proc()),U(r.$times(),"map",[],function i(){var Y,H,C=null==i.$$s?this:i.$$s;return null==C.randomizer&&(C.randomizer=$),Y=C.randomizer.$roll_once(6),H=C.randomizer.$roll_sum(2,6),g([[H,Y]],U(s,"map",[],function ee(Z){var te,ne,$e;return null==Z&&(Z=$),ne=a((null==ee.$$s?this:ee.$$s).$class(),"DIRECTION_INFOS")["$[]"](Z)["$[]"]("position_diff"),$e=null==(te=B(ne))[1]?$:te[1],[g(H,null==te[0]?$:te[0]),g(Y,$e)]},{$$s:C}))},{$$s:this})})},Opal.queue(function(e){var U,P,a,w,n,W,K,q,V=e.module,L=e.klass,_=e.const_set,A=e.send2,S=e.find_super,D=e.def,T=[];return e.top.$require("bcdice/game_system/SkynautsBouken"),U=T,P=q=[V(T[0],"BCDice")].concat(U),W=[V(q[0],"GameSystem")].concat(P),K=e.$r(W),a=W,_((n=[w=L(W[0],K("SkynautsBouken"),"SkynautsBouken_Korean")].concat(a))[0],"ID","SkynautsBouken:Korean"),_(n[0],"NAME","\ud1b1\ub2c8\ubc14\ud034 \ud0d1\uc758 \ud0d0\uacf5\uc0ac"),_(n[0],"SORT_KEY","\u56fd\u969b\u5316:Korean:\ud1b1\ub2c8\ubc14\ud034 \ud0d1\uc758 \ud0d0\uacf5\uc0ac"),_(n[0],"HELP_MESSAGE","\u30fb\ud589\uc704\ud310\uc815\uff08nSNt#f\uff09 n:\ub2e4\uc774\uc2a4 \uc218(\uc0dd\ub7b5\uc2dc 2), t:\ubaa9\ud45c\uce58(\uc0dd\ub7b5\uc2dc 7), f:\ud38c\ube14\uce58(\uc0dd\ub7b5\uc2dc 1)\n    \uc608\uff09SN6#2\u30003SN\n\u30fb\ub300\ubbf8\uc9c0 \uccb4\ud06c (Dx/y@m) x:\ub300\ubbf8\uc9c0 \ubc94\uc704\u3001y:\uacf5\uaca9\ud69f\uc218\n\u3000\u3000m:\u300a\ud0c4\ub3c4\ud559\u300b\uff08\uc0dd\ub7b5 \uac00\ub2a5\uff09\uc0c1:8, \ud558:2, \uc88c:4, \uc6b0:6\n\u3000\u3000\uc608\uff09 D/4\u3000D19/2\u3000D/3@8\u3000D[\uc9c4\ub3d9]/2\n\u30fb\ud68c\ud53c(AVO@m\ub300\ubbf8\uc9c0)\n\u3000\u3000m:\ud68c\ud53c \ubc29\ud5a5(\uc0c1:8, \ud558:2, \uc88c:4, \uc6b0:6), \ub300\ubbf8\uc9c0: \ub300\ubbf8\uc9c0 \uccb4\ud06c \uacb0\uacfc\n\u3000\u3000\uc608\uff09AVO@8[1,4],[2,6],[3,8]\u3000AVO@2[6,4],[2,6]\n\u30fbFT \ud38c\ube14\ud45c(p76)\n\u30fbNV \ud56d\ud589\ud45c\n\u30fb\ud56d\ud589\uc774\ubca4\ud2b8\ud45c\n\u3000\u30fbNEN \ud56d\ud589\uacc4\n\u3000\u30fbNEE \uc870\uc6b0\uacc4\n\u3000\u30fbNEO \uc120\ub0b4\uacc4\n\u3000\u30fbNEH \uace4\ub780\uacc4\n\u3000\u30fbNEL \uc7a5\uac70\ub9ac \uc5ec\ud589\uacc4\n\n\u25a0 \ud310\uc815 \uc138\ud2b8\n\u30fb\u300a\ud68c\ud53c\uc6b4\ub3d9\u300b\ud310\uc815+\ud68c\ud53c\uff08nSNt#f/AVO@\ub300\ubbf8\uc9c0\uff09\n\u3000\u3000nSNt#f \u2192 \uc131\uacf5\ud558\uba74 AVO@m\n\u3000\u3000\uc608\uff09SN/AVO@8[1,4],[2,6],[3,8]\u30003SN#2/AVO@2[6,4],[2,6]\n\u30fb\ud3ec\uaca9 \ud310\uc815+\ub300\ubbf8\uc9c0 \uccb4\ud06c\u3000(nSNt#f/Dx/y@m)\n\u3000\u3000\ud589\uc704 \ud310\uc815\uc758 \ucd9c\ubc1c(\u51fa\u76ee) \ubcc0\uacbd \ud0c0\uc774\ubc0d\uc744 \ub193\uce58\ubbc0\ub85c GM\uc758 \ud5c8\uac00 \ud544\uc694\n\u3000\u3000nSNt#f \u2192 \uc131\uacf5\ud558\uba74 Dx/y@m\n\u3000\u3000\uc608\uff09SN/D/4\u30003SN#2/D[\uc9c4\ub3d9]/2\n"),D(w,"$initialize",function l(b){var E=this;return l.$$p=null,A(E,S(E,"initialize",l,!1,!0),"initialize",[b],null),E.locale="ko_kr"}),w.$register_prefix_from_super_class(),_(n[0],"TABLES",w.$translate_tables("ko_kr").$freeze()),_(n[0],"DIRECTION_INFOS",w.$translate_direction_infos("ko_kr").$freeze())})}}]);