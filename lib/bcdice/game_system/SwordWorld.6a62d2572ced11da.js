(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[494],{6849:(Re,xe,ke)=>{ke(5151),Opal.modules["i18n/backend/fallbacks"]=function(e){var W,u,n,i,c,y,Q=e.module,G=e.class_variable_set,l=e.truthy,j=e.class_variable_get,B=e.def,f=e.send,U=e.send2,m=e.find_super,E=e.hash2,H=e.find_block_super,Y=e.neqeq,O=e.thrower,T=e.return_val,K=[],F=e.nil,A=e.$$$;return W=K,y=[c=Q(K[0],"I18n")].concat(W),G(y[0],"@@fallbacks",F),u=e.get_singleton_class(c),n=[u].concat(y),i=e.$r(n),B(u,"$fallbacks",function(){var D=F;return G(n[1],"@@fallbacks",l(null!=n[1].$$cvars["@@fallbacks"]?"class variable":F)&&l(D=j(n[1],"@@fallbacks",!1))?D:A(A(i("I18n"),"Locale"),"Fallbacks").$new()),l(D=i("Thread").$current()["$[]"]("i18n_fallbacks"))?D:j(n[1],"@@fallbacks",!1)}),B(u,"$fallbacks=",function(L){var D;return G(n[1],"@@fallbacks",l(L["$is_a?"](i("Array")))?A(A(i("I18n"),"Locale"),"Fallbacks").$new(L):L),D=["i18n_fallbacks",j(n[1],"@@fallbacks",!1)],f(i("Thread").$current(),"[]=",D),D[D.length-1]}),function(u,z){var L,D,S,q,i=[Q(u,"Backend")].concat(z);return L=i,S=[D=Q(i[0],"Fallbacks")].concat(L),q=e.$r(S),B(D,"$translate",function w(d,g,s){try{var o=O("return"),_=w.$$p||F,P=this,R=F,k=F;return w.$$p=null,null==s&&(s=q("EMPTY_HASH")),l(s.$fetch("fallback",!0))?l(s["$[]"]("fallback_in_progress"))?U(P,m(P,"translate",w,!1,!0),"translate",[d,g,s],_):(l(s["$[]"]("default"))&&(R=P["$extract_non_symbol_default!"](s)),k=s.$merge(E(["fallback_in_progress"],{fallback_in_progress:!0})),f(q("I18n").$fallbacks()["$[]"](d),"each",[],function $(I){var r=null==$.$$s?this:$.$$s;null==I&&(I=F);try{return f(r,"catch",["exception"],function h(){var a=null==h.$$s?this:h.$$s,ee=F;if(ee=U(a,H(a,"translate",h.$$def||$.$$def||w,!1,!1),"translate",[I,g,k],null),l(ee["$nil?"]()))return F;Y(d.$to_s(),I.$to_s())&&a.$on_fallback(d,I,g,s),o.$throw(ee)},{$$s:r,$$ret:o})}catch(h){if(!e.rescue(h,[A(q("I18n"),"InvalidLocale")]))throw h;try{return F}finally{e.pop_exception()}}},{$$s:P}),l(s["$key?"]("default"))&&l(s["$[]"]("default")["$nil?"]())?F:l(R)?U(P,m(P,"translate",w,!1,!0),"translate",[d,F,s.$merge(E(["default"],{default:R}))],null):P.$throw("exception",A(q("I18n"),"MissingTranslation").$new(d,g,s))):U(P,m(P,"translate",w,!1,!0),"translate",[d,g,s],_)}catch($){if($===o)return $.$v;throw $}},-3),B(D,"$extract_non_symbol_default!",function(d){var s,g=F;return g=[d["$[]"]("default")].$flatten(),s=f(g,"detect",[],function(_){return null==_&&(_=F),_["$is_a?"](q("Symbol"))["$!"]()}),l(s)&&d["$[]="]("default",g["$[]"](0,g.$index(s))),s}),B(D,"$exists?",function w(d,g,s){try{var o=O("return"),_=w.$$p||F,P=this;return w.$$p=null,null==s&&(s=q("EMPTY_HASH")),l(s.$fetch("fallback",!0))?(f(q("I18n").$fallbacks()["$[]"](d),"each",[],function R(k){var $=null==R.$$s?this:R.$$s;null==k&&(k=F);try{if(!l(U($,H($,"exists?",R.$$def||w,!1,!1),"exists?",[k,g],null)))return F;o.$throw(!0)}catch(I){if(!e.rescue(I,[A(q("I18n"),"InvalidLocale")]))throw I;try{return F}finally{e.pop_exception()}}},{$$s:P,$$ret:o}),!1):U(P,m(P,"exists?",w,!1,!0),"exists?",[d,g,s],_)}catch(R){if(R===o)return R.$v;throw R}},-3),D.$private(),B(D,"$on_fallback",T(F))}(y[0],y)},Opal.modules["bcdice/randomizer"]=function(e){var c,p,L,D,S,q,u,z,G=e.klass,l=e.const_set,j=e.def,B=e.truthy,f=e.rb_gt,U=e.rb_plus,m=e.rb_le,E=e.send,H=e.rb_minus,Y=e.eqeq,O=e.rb_times,T=e.eqeqeq,K=e.rb_ge,F=[],A=e.nil,t=e.$$$;return c=F,u=[(0,e.module)(F[0],"BCDice")].concat(c),z=e.$r(u),p=u,D=[L=G(u[0],null,"Randomizer")].concat(p),S=e.$r(D),(q=L.$$prototype).rand_results=q.detailed_rand_results=A,l(D[0],"UPPER_LIMIT_DICE_TIMES",200),l(D[0],"UPPER_LIMIT_DICE_SIDES",1e4),l(D[0],"UPPER_LIMIT_RANDS",1e4),j(L,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]}),L.$attr_reader("rand_results"),L.$attr_reader("detailed_rand_results"),l(D[0],"DetailedRandResult",S("Struct").$new("kind","sides","value")),j(L,"$roll_barabara",function(d,g){var s=this;return B(f(U(s.rand_results.$size(),d),S("UPPER_LIMIT_RANDS")))&&s.$raise(S("TooManyRandsError")),B(m(d,0))||B(f(d,S("UPPER_LIMIT_DICE_TIMES")))?[]:E(S("Array"),"new",[d],function o(){return(null==o.$$s?this:o.$$s).$roll_once(g)},{$$s:s})}),j(L,"$roll_sum",function(d,g){return this.$roll_barabara(d,g).$sum()}),j(L,"$roll_once",function(d){var s=A;return B(m(d,0))||B(f(d,S("UPPER_LIMIT_DICE_SIDES")))?0:(s=this.$rand_inner(d),this.$push_to_detail("normal",d,s),s)}),j(L,"$roll_index",function(d){return H(this.$roll_once(d),1)}),j(L,"$roll_tens_d10",function(){var s,g=A;return g=this.$rand_inner(10),Y(g,10)&&(g=0),s=O(g,10),this.$push_to_detail("tens_d10",10,s),s}),j(L,"$roll_d9",function(){var g;return g=H(this.$rand_inner(10),1),this.$push_to_detail("d9",10,g),g}),j(L,"$roll_d66",function(d){var o,s=A;return s=E(S("Array"),"new",[2],function _(){return(null==_.$$s?this:_.$$s).$roll_once(6)},{$$s:this}),T(t(S("D66SortType"),"ASC"),o=d)?s["$sort!"]():T(t(S("D66SortType"),"DESC"),o)&&s["$sort!"]()["$reverse!"](),U(O(s["$[]"](0),10),s["$[]"](1))}),L.$private(),j(L,"$rand_inner",function(d){var s,g=this;return B(K(g.rand_results.$size(),S("UPPER_LIMIT_RANDS")))&&g.$raise(S("TooManyRandsError")),s=g.$random(d),g.rand_results["$<<"]([s,d]),s}),j(L,"$random",function(d){return U(S("Kernel").$rand(d),1)}),j(L,"$push_to_detail",function(d,g,s){var _;return _=S("DetailedRandResult").$new(d,g,s),this.detailed_rand_results.$push(_)}),G(u[0],z("StandardError"),"TooManyRandsError"),A},Opal.modules["bcdice/dice_table/roll_result"]=function(e){var E,T,W,c,y,u,z,F,Y,Q=e.module,G=e.klass,l=e.def,j=e.truthy,B=e.return_val,f=[],U=e.nil;return E=f,T=Y=[Q(f[0],"BCDice")].concat(E),W=F=[Q(Y[0],"DiceTable")].concat(T),y=[c=G(F[0],null,"RollResult")].concat(W),u=e.$r(y),(z=c.$$prototype).table_name=z.value=z.body=U,l(c,"$initialize",function(i,p,L){var D=this;return D.table_name=i,D.value=p,D.body=L}),c.$attr_reader("table_name"),c.$attr_reader("value"),c.$attr_reader("body"),l(c,"$to_s",function(){var i=this;return i.table_name+"("+i.value+") \uff1e "+i.body}),l(c,"$last_body",function(){var i=this;return j(i.body["$is_a?"](u("RollResult")))?i.body.$last_body():i.body}),l(c,"$empty?",B(!1))},Opal.modules["bcdice/dice_table/chain_table"]=function(e){var E,T,W,c,y,u,z,F,Y,Q=e.module,G=e.klass,l=e.truthy,j=e.def,B=e.rb_minus,f=[],U=e.nil;return E=f,T=Y=[Q(f[0],"BCDice")].concat(E),W=F=[Q(Y[0],"DiceTable")].concat(T),y=[c=G(F[0],null,"ChainTable")].concat(W),u=e.$r(y),(z=c.$$prototype).times=z.sides=z.items=z.name=U,j(c,"$initialize",function(i,p,L){var D=this,S=U;return D.name=i,D.items=L.$freeze(),S=/(\d+)D(\d+)/i.$match(p),l(S)||D.$raise(u("ArgumentError"),"Unexpected table type: "+p),D.times=S["$[]"](1).$to_i(),D.sides=S["$[]"](2).$to_i()}),j(c,"$roll",function(i){var L,D,p=this,S=U;return L=i.$roll_sum(p.times,p.sides),D=B(L,p.times),S=p.items["$[]"](D),l(S["$respond_to?"]("roll"))&&(S=S.$roll(i)),u("RollResult").$new(p.name,L,S)})},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(e){var O,A,u,z,n,i,p,W,K,Q=e.module,G=e.klass,l=e.hash2,j=e.defs,B=e.def,f=e.rb_plus,U=e.rb_times,m=e.rb_minus,E=[],H=e.nil;return O=E,A=K=[Q(E[0],"BCDice")].concat(O),u=W=[Q(K[0],"DiceTable")].concat(A),n=[z=G(W[0],null,"D66GridTable")].concat(u),i=e.$r(n),(p=z.$$prototype).name=p.items=H,j(z,"$from_i18n",function(D,S){var w=H;return w=i("I18n").$t(D,l(["locale","raise"],{locale:S,raise:!0})),this.$new(w["$[]"]("name"),w["$[]"]("items"))}),B(z,"$initialize",function(D,S){return this.name=D,this.items=S.$freeze()}),B(z,"$roll",function(D){var q,w,d,g,s;return q=D.$roll_once(6),w=D.$roll_once(6),d=f(U(q,10),w),g=m(q,1),s=m(w,1),i("RollResult").$new(this.name,d,this.items["$[]"](g)["$[]"](s))})},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(e){var H,K,y,u,z,n,A,t,O,Q=e.module,G=e.klass,l=e.hash2,j=e.defs,B=e.def,U=[],m=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=U,K=O=[Q(U[0],"BCDice")].concat(H),A=[Q(O[0],"DiceTable")].concat(K),t=e.$r(A),y=A,z=[u=G(A[0],t("D66GridTable"),"D66HalfGridTable")].concat(y),n=e.$r(z),j(u,"$from_i18n",function(p,L){var S=m;return S=n("I18n").$t(p,l(["locale","raise"],{locale:L,raise:!0})),this.$new(S["$[]"]("name"),S["$[]"]("items_1_2_3"),S["$[]"]("items_4_5_6"))}),B(u,"$initialize",function(p,L,D){return this.name=p,this.items=[L,L,L,D,D,D].$freeze()})},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(e){var H,K,y,u,z,n,A,t,O,Q=e.module,G=e.klass,l=e.hash2,j=e.defs,B=e.def,U=[],m=e.nil;return e.top.$require("bcdice/dice_table/d66_grid_table"),H=U,K=O=[Q(U[0],"BCDice")].concat(H),A=[Q(O[0],"DiceTable")].concat(K),t=e.$r(A),y=A,z=[u=G(A[0],t("D66GridTable"),"D66OneThirdTable")].concat(y),n=e.$r(z),j(u,"$from_i18n",function(p,L){var S=m;return S=n("I18n").$t(p,l(["locale","raise"],{locale:L,raise:!0})),this.$new(S["$[]"]("name"),S["$[]"]("items_1_2"),S["$[]"]("items_3_4"),S["$[]"]("items_5_6"))}),B(u,"$initialize",function(p,L,D,S){return this.name=p,this.items=[L,L,D,D,S,S].$freeze()})},Opal.modules["bcdice/dice_table/d66_table"]=function(e){var K,W,n,i,p,L,D,y,A,Q=e.module,G=e.klass,l=e.hash2,j=e.defs,B=e.def,f=e.eqeqeq,U=e.rb_plus,m=e.rb_times,E=e.truthy,H=[],Y=e.nil,O=e.$$$;return K=H,W=A=[Q(H[0],"BCDice")].concat(K),n=y=[Q(A[0],"DiceTable")].concat(W),p=[i=G(y[0],null,"D66Table")].concat(n),L=e.$r(p),(D=i.$$prototype).sort_type=D.items=D.name=Y,j(i,"$from_i18n",function(q,w){var s,g=Y;return g=L("I18n").$t(q,l(["locale"],{locale:w})),s=L("D66SortType").$const_get(g["$[]"]("d66_sort_type")),this.$new(g["$[]"]("name"),s,g["$[]"]("items"))}),B(i,"$initialize",function(q,w,d){var g=this;return g.name=q,g.sort_type=w,g.items=d.$freeze()}),B(i,"$roll",function(q){var w=this,d=Y,g=Y,s=Y,o=Y;return d=q.$roll_barabara(2,6),f(O(L("D66SortType"),"ASC"),g=w.sort_type)?d["$sort!"]():f(O(L("D66SortType"),"DESC"),g)&&d["$sort!"]()["$reverse!"](),s=U(m(d["$[]"](0),10),d["$[]"](1)),o=E(g=w.items["$[]"](s))?g:w.items["$[]"](s.$to_s()),E(o["$respond_to?"]("roll"))&&(o=o.$roll(q)),L("RollResult").$new(w.name,s,o)}),B(i,"$choice",function(q){return L("RollResult").$new(this.name,q,this.items["$[]"](q))})},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(e){var F,c,u,z,t,Q=e.module,G=e.klass,l=e.hash2,j=e.send,B=e.to_ary,f=e.rb_plus,U=e.rb_times,m=e.send2,E=e.find_super,H=e.def,O=[],T=e.nil;return e.top.$require("bcdice/dice_table/d66_table"),F=O,c=t=[Q(O[0],"BCDice")].concat(F),u=[Q(t[0],"DiceTable")].concat(c),z=e.$r(u),H(G(u[0],z("D66Table"),"D66LeftRangeTable"),"$initialize",function L(D,S,q){var g;return L.$$p=null,g=l([],{}),j(q,"each",[],function(o){var _,k;return null==o&&(o=T),_=B(o),k=null==_[1]?T:_[1],j(null==_[0]?T:_[0],"each",[],function(I){return null==I&&(I=T),j(k,"each_with_index",[],function(h,a){var ee,te;return null==h&&(h=T),null==a&&(a=T),te=f(U(I,10),f(a,1)),j(g,"[]=",ee=[te,h]),ee[ee.length-1]})})}),m(this,E(this,"initialize",L,!1,!0),"initialize",[D,S,g],null)})},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(e){var T,t,z,n,i,p,L,c,F,Q=e.module,G=e.klass,l=e.hash2,j=e.defs,B=e.def,f=e.truthy,U=e.rb_minus,m=e.rb_plus,E=e.rb_times,H=[],Y=e.nil;return T=H,t=F=[Q(H[0],"BCDice")].concat(T),z=c=[Q(F[0],"DiceTable")].concat(t),i=[n=G(c[0],null,"D66ParityTable")].concat(z),p=e.$r(i),(L=n.$$prototype).odd=L.even=L.name=Y,j(n,"$from_i18n",function(S,q){var d=Y;return d=p("I18n").$t(S,l(["locale","raise"],{locale:q,raise:!0})),this.$new(d["$[]"]("name"),d["$[]"]("odd"),d["$[]"]("even"))}),B(n,"$initialize",function(S,q,w){var d=this;return d.name=S,d.odd=q.$freeze(),d.even=w.$freeze()}),B(n,"$roll",function(S){var d,s,o,q=this,w=Y;return w=S.$roll_once(6),d=S.$roll_once(6),s=(f(w["$odd?"]())?q.odd:q.even)["$[]"](U(d,1)),o=m(E(w,10),d),p("RollResult").$new(q.name,o,s)})},Opal.modules["bcdice/dice_table/d66_range_table"]=function(e){var H,K,c,y,u,z,n,A,O,Q=e.module,G=e.klass,l=e.def,j=e.rb_plus,B=e.rb_times,f=e.send,U=[],m=e.nil;return H=U,K=O=[Q(U[0],"BCDice")].concat(H),c=A=[Q(O[0],"DiceTable")].concat(K),u=[y=G(A[0],null,"D66RangeTable")].concat(c),z=e.$r(u),(n=y.$$prototype).items=n.name=m,l(y,"$initialize",function(p,L){return this.name=p,this.items=L.$freeze()}),l(y,"$roll",function(p){var D,S,q,w=m;return D=p.$roll_once(6),S=p.$roll_once(6),q=j(B(D,10),S),w=f(this.items,"find",[],function(g){return null==g&&(g=m),g["$[]"](0)["$include?"](q)}),z("RollResult").$new(this.name,q,w["$[]"](1))})},Opal.modules["bcdice/dice_table/range_table"]=function(e){var F,c,i,q,d,g,p,L,D,S,u,t,Q=e.module,G=e.klass,l=e.const_set,j=e.send,B=e.hash2,f=e.def,U=e.eqeqeq,m=e.truthy,E=e.to_a,H=e.rb_times,Y=e.rb_plus,O=[],T=e.nil;return F=O,c=t=[Q(O[0],"BCDice")].concat(F),i=u=[Q(t[0],"DiceTable")].concat(c),L=[p=G(u[0],null,"RangeTable")].concat(i),D=e.$r(L),(S=p.$$prototype).name=S.items=S.num_of_dice=S.num_of_sides=S.formatter=T,l(L[0],"RollResult",j(D("Struct"),"new",["sum","values","content","formatted"],function q(){return(null==q.$$s?this:q.$$s).$alias_method("to_s","formatted")},{$$s:p})),l(L[0],"Item",D("Struct").$new("range","content")),l(L[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),l(L[0],"DEFAULT_FORMATTER",j(p,"lambda",[],function(w,d){return null==w&&(w=T),null==d&&(d=T),w.$name()+"("+d.$sum()+") \uff1e "+d.$content()})),p.$attr_reader("name"),p.$attr_reader("num_of_dice"),p.$attr_reader("num_of_sides"),d=[q=e.get_singleton_class(p)].concat(L),g=e.$r(d),f(q,"$from_i18n",function(o,_){var k,R=T;return R=g("I18n").$t(o,B(["locale"],{locale:_})),k=j(R["$[]"]("items"),"map",[],function $(I){return null==I&&(I=T),[(null==$.$$s?this:$.$$s).$conv_string_range(I["$[]"](0)),I["$[]"](1)]},{$$s:this}),this.$new(R["$[]"]("name"),R["$[]"]("type"),k)}),f(q,"$conv_string_range",function(o){var P,_=this;return null==_.name&&(_.name=T),U(g("Integer"),P=o)?o:U(g("String"),P)?m(o["$include?"](".."))?j(g("Range"),"new",E(j(o.$split("..",2),"map",[],function R(k){return null==k&&(k=T),(null==R.$$s?this:R.$$s).$Integer(k)},{$$s:_}))):_.$Integer(o):_.$raise(g("TypeError"),_.name+": "+o+" ("+o.$class()+") must be a String or an Integer")}),f(p,"$initialize",function q(w,d,g){var _,s=q.$$p||T,o=this,P=T;return q.$$p=null,o.name=w.$freeze(),o.formatter=m(_=s)?_:D("DEFAULT_FORMATTER"),P=D("DICE_ROLL_METHOD_RE").$match(d),m(P)||o.$raise(D("ArgumentError"),o.name+": invalid dice roll method: "+d),o.num_of_dice=P["$[]"](1).$to_i(),o.num_of_sides=P["$[]"](2).$to_i(),o.$store(g)}),f(p,"$fetch",function(w){var g,d=this;return g=j(d.items,"find",[],function(o){return null==o&&(o=T),o.$range()["$include?"](w)}),m(g)||d.$raise(D("RangeError"),d.name+": value is out of range: "+w),g}),f(p,"$roll",function(w){var s,d=this,g=T,o=T;return s=(g=w.$roll_barabara(d.num_of_dice,d.num_of_sides)).$sum(),(o=D("RollResult").$new(s,g,d.$fetch(s).$content()))["$formatted="](d.formatter["$[]"](d,o)),o}),p.$private(),f(p,"$store",function(w){var g,s,d=this;return g=j(w,"map",[],function o(_,P){return null==_&&(_=T),null==P&&(P=T),[(null==o.$$s?this:o.$$s).$coerce_to_int_range(_),P]},{$$s:d}),s=j(g,"sort_by",[],function(_,P){return null==_&&(_=T),null==P&&(P=T),_.$min()}),d.$assert_min_sum_is_covered(s),d.$assert_max_sum_is_covered(s),d.$assert_no_gap_or_overlap_in_ranges(s),d.items=j(s,"map",[],function(_,P){return null==_&&(_=T),null==P&&(P=T),D("Item").$new(_,P.$freeze()).$freeze()}).$freeze(),d}),f(p,"$coerce_to_int_range",function(w){var g;return U(D("Integer"),g=w)?D("Range").$new(w,w):U(D("Range"),g)&&m(w.$begin()["$is_a?"](D("Integer")))&&m(w.$end()["$is_a?"](D("Integer")))?w:this.$raise(D("TypeError"),this.name+": "+w+" ("+w.$class()+") must be an Integer or a Range with Integers ")}),f(p,"$assert_min_sum_is_covered",function(w){var g,d=this,s=T;return g=d.num_of_dice,s=w.$first()["$[]"](0),m(s["$include?"](g))||d.$raise(D("RangeError"),d.name+": min value ("+g+") is not covered: "+s),d}),f(p,"$assert_max_sum_is_covered",function(w){var g,d=this,s=T;return g=H(d.num_of_dice,d.num_of_sides),s=w.$last()["$[]"](0),m(s["$include?"](g))||d.$raise(D("RangeError"),d.name+": max value ("+g+") is not covered: "+s),d}),f(p,"$assert_no_gap_or_overlap_in_ranges",function(w){return j(w,"each_cons",[2],function g(s,o){var k,$,_=null==g.$$s?this:g.$$s,P=T,R=T;return null==_.name&&(_.name=T),null==s&&(s=T),null==o&&(o=T),P=s["$[]"](0),R=o["$[]"](0),k=P.$max(),$=Y(k,1),m(R["$include?"](k))&&_.$raise(D("RangeError"),_.name+": Range overlap: "+P+" and "+R),m(R["$include?"]($))?T:_.$raise(D("RangeError"),_.name+": Range gap: "+P+" and "+R)},{$$s:this}),this})},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(e){var Y,F,y,p,L,D,S,z,t,T,Q=e.module,G=e.klass,l=e.send,j=e.def,B=e.rb_minus,f=e.return_ivar,U=[],m=e.nil,E=e.$$$;return Y=U,F=T=[Q(U[0],"BCDice")].concat(Y),y=t=[Q(T[0],"DiceTable")].concat(F),p=z=[G(t[0],null,"SaiFicSkillTable")].concat(y),D=[L=G(z[0],null,"Category")].concat(p),S=e.$r(D),j(L,"$initialize",function(w,d,g,s){var o=this;return o.name=w,o.skills=l(d.$map(),"with_index",[2],function(P,R){return null==P&&(P=m),null==R&&(R=m),E(S("SaiFicSkillTable"),"Skill").$new(w,P,g,R,s)}),o.dice=g}),j(L,"$roll",function(w){return this.$skills()["$[]"](B(w.$roll_sum(2,6),2))}),j(L,"$to_s",f("name")),L.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(e){var m,O,t,z,n,c,K,H,Q=e.module,G=e.klass,l=e.def,j=e.hash2,B=[],f=e.nil;return m=B,O=H=[Q(B[0],"BCDice")].concat(m),t=K=[Q(H[0],"DiceTable")].concat(O),c=[G(K[0],null,"SaiFicSkillTable")].concat(t),(n=(z=G(c[0],null,"Skill")).$$prototype).s_format=n.category_dice=n.row_dice=n.category_name=n.name=f,l(z,"$initialize",function(p,L,D,S,q){var w=this;return w.category_name=p,w.name=L,w.category_dice=D,w.row_dice=S,w.s_format=q}),l(z,"$to_s",function(){var p=this;return p.$format(p.s_format,j(["category_dice","row_dice","category_name","skill_name"],{category_dice:p.category_dice,row_dice:p.row_dice,category_name:p.category_name,skill_name:p.name}))}),z.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(e){var c,n,S,q,w,d,g,p,u,Q=e.module,G=e.klass,l=e.ensure_kwargs,j=e.hash2,B=e.send,U=e.defs,m=e.const_set,E=e.to_ary,H=e.def,Y=e.truthy,O=e.rb_minus,T=e.rb_plus,K=e.top,F=[],A=e.nil,t=e.$$$;return K.$require("bcdice/dice_table/sai_fic_skill_table/category"),K.$require("bcdice/dice_table/sai_fic_skill_table/skill"),c=F,n=u=[Q(F[0],"BCDice")].concat(c),S=p=[Q(u[0],"DiceTable")].concat(n),w=[q=G(p[0],null,"SaiFicSkillTable")].concat(S),d=e.$r(w),(g=q.$$prototype).rtt=g.rtt_format=g.rct=g.rct_format=g.rttn=g.rttn_format=g.categories=A,U(q,"$from_i18n",function(o,_,P){var R,k,$,a,h=A;return null==(R=(P=l(P)).$$smap.rtt)&&(R=A),null==(k=P.$$smap.rct)&&(k=A),null==($=P.$$smap.rttn)&&($=A),a=(h=d("I18n").$t("RTT",j(["locale","raise","default"],{locale:_,raise:!1,default:j([],{})})).$merge(d("I18n").$t(o,j(["locale","raise"],{locale:_,raise:!0}))))["$[]"]("items"),h=B(h,"select",[],function(te,J){return null==te&&(te=A),null==J&&(J=A),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](te)}),this.$new(a,e.to_hash(h).$merge(j(["rtt","rct","rttn"],{rtt:R,rct:k,rttn:$})))},-3),m(w[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),m(w[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),m(w[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),m(w[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),H(q,"$initialize",function(o,_){var P,R,k,$,I,r,h,a=this;return null==(P=(_=l(_)).$$smap.rtt)&&(P=A),null==(R=_.$$smap.rct)&&(R=A),null==(k=_.$$smap.rttn)&&(k=A),null==($=_.$$smap.rtt_format)&&($=d("DEFAULT_RTT")),null==(I=_.$$smap.rct_format)&&(I=d("DEFAULT_RCT")),null==(r=_.$$smap.rttn_format)&&(r=d("DEFAULT_RTTN")),null==(h=_.$$smap.s_format)&&(h=d("DEFAULT_S")),a.categories=B(o.$map(),"with_index",[1],function(te,J){var _e,oe,se;return null==te&&(te=A),null==J&&(J=A),oe=null==(_e=E(te))[0]?A:_e[0],se=null==_e[1]?A:_e[1],t(d("SaiFicSkillTable"),"Category").$new(oe,se,J,h)},{$$has_top_level_mlhs_arg:!0}),a.rtt=P,a.rct=R,a.rttn=k.$to_a(),a.rtt_format=$,a.rct_format=I,a.rttn_format=r},-2),m(w[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),q.$attr_reader("categories"),H(q,"$roll_command",function(o,_){var R,P=this,k=A,$=A;return Y(["RTT",P.rtt]["$include?"](R=_))?P.$format_skill(P.rtt_format,P.$roll_skill(o)):Y(["RCT",P.rct]["$include?"](R))?(k=P.$roll_category(o),P.$format(P.rct_format,j(["category_dice","category_name"],{category_dice:k.$dice(),category_name:k.$name()}))):Y($=d("RTTN").$index(R))||Y($=P.rttn.$index(R))?P.$format_skill(P.rttn_format,P.categories["$[]"]($).$roll(o)):A}),H(q,"$roll_category",function(o){return this.categories["$[]"](O(o.$roll_once(6),1))}),H(q,"$roll_skill",function(o){return this.$roll_category(o).$roll(o)}),H(q,"$prefixes",function(){var o=this;return T(["RTT[1-6]?","RCT",o.rtt,o.rct],o.rttn).$compact()}),q.$private(),H(q,"$format_skill",function(o,_){return this.$format(o,j(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:_.$category_dice(),row_dice:_.$row_dice(),category_name:_.$category_name(),skill_name:_.$name(),text:_.$to_s()}))})},Opal.modules["bcdice/dice_table/table"]=function(e){var Y,F,y,u,z,n,i,t,T,Q=e.module,G=e.klass,l=e.hash2,j=e.defs,B=e.truthy,f=e.def,U=e.rb_minus,m=[],E=e.nil;return Y=m,F=T=[Q(m[0],"BCDice")].concat(Y),y=t=[Q(T[0],"DiceTable")].concat(F),z=[u=G(t[0],null,"Table")].concat(y),n=e.$r(z),(i=u.$$prototype).times=i.sides=i.name=i.items=E,j(u,"$from_i18n",function(L,D){var q=E;return q=n("I18n").$t(L,l(["locale"],{locale:D})),this.$new(q["$[]"]("name"),q["$[]"]("type"),q["$[]"]("items"))}),f(u,"$initialize",function(L,D,S){var q=this,w=E;return q.name=L,q.items=S.$freeze(),w=/(\d+)D(\d+)/i.$match(D),B(w)||q.$raise(n("ArgumentError"),"Unexpected table type: "+D),q.times=w["$[]"](1).$to_i(),q.sides=w["$[]"](2).$to_i()}),f(u,"$roll",function(L){var S,D=this;return S=L.$roll_sum(D.times,D.sides),D.$choice(S)}),f(u,"$choice",function(L){var S,D=this;return S=U(L,D.times),n("RollResult").$new(D.name,L,D.items["$[]"](S))})},Opal.modules["bcdice/dice_table"]=function(e){var Q=e.top;return Q.$require("bcdice/dice_table/roll_result"),Q.$require("bcdice/dice_table/chain_table"),Q.$require("bcdice/dice_table/d66_grid_table"),Q.$require("bcdice/dice_table/d66_half_grid_table"),Q.$require("bcdice/dice_table/d66_one_third_table"),Q.$require("bcdice/dice_table/d66_left_range_table"),Q.$require("bcdice/dice_table/d66_parity_table"),Q.$require("bcdice/dice_table/d66_range_table"),Q.$require("bcdice/dice_table/d66_table"),Q.$require("bcdice/dice_table/range_table"),Q.$require("bcdice/dice_table/sai_fic_skill_table"),Q.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(e){var f,H,O,m,Q=e.module,G=e.const_set,l=[];return f=l,H=m=[Q(l[0],"BCDice")].concat(f),O=[Q(m[0],"D66SortType")].concat(H),G(O[0],"NO_SORT","no_sort"),G(O[0],"ASC","asc"),G(O[0],"DESC","desc"),function(E,H){var O=[Q(E,"RoundType")].concat(H);return G(O[0],"CEIL","ceil"),G(O[0],"FLOOR","floor"),G(O[0],"ROUND","round")}(m[0],m)},Opal.modules["bcdice/translate"]=function(e){var H,K,F,A,t,O,Q=e.module,G=e.ensure_kwargs,l=e.kwrestargs,B=e.hash2,f=e.def,U=[],m=e.nil;return H=U,K=O=[Q(U[0],"BCDice")].concat(H),A=[F=Q(O[0],"Translate")].concat(K),t=e.$r(A),f(F,"$translate",function(c,y){var u,z=this;return null==z.locale&&(z.locale=m),y=G(y),u=l(y,{}),t("I18n").$translate(c,B(["locale","raise"],{locale:z.locale,raise:!0}).$merge(e.to_hash(u)))},-2)},Opal.modules["bcdice/result"]=function(e){var F,W,A,H,O,G=e.klass,l=e.send,j=e.def,B=e.return_val,f=e.return_ivar,U=[],m=e.nil;return H=U,F=O=[(0,e.module)(U[0],"BCDice")].concat(H),[A=G(O[0],null,"Result")].concat(F),j(W=e.get_singleton_class(A),"$success",function(u){return l(this.$new(),"tap",[],function(i){var p;return null==i&&(i=m),i["$text="](u),l(i,"success=",p=[!0]),p[p.length-1]})}),j(W,"$failure",function(u){return l(this.$new(),"tap",[],function(i){var p;return null==i&&(i=m),i["$text="](u),l(i,"failure=",p=[!0]),p[p.length-1]})}),j(W,"$critical",function(u){return l(this.$new(),"tap",[],function(i){var p;return null==i&&(i=m),i["$text="](u),i["$critical="](!0),l(i,"success=",p=[!0]),p[p.length-1]})}),j(W,"$fumble",function(u){return l(this.$new(),"tap",[],function(i){var p;return null==i&&(i=m),i["$text="](u),i["$fumble="](!0),l(i,"failure=",p=[!0]),p[p.length-1]})}),j(W,"$nothing",B("nothing")),j(A,"$initialize",function(c){var y=this;return null==c&&(c=m),y.text=c,y.rands=m,y.detailed_rands=m,y.secret=!1,y.success=!1,y.failure=!1,y.critical=!1,y.fumble=!1},-1),A.$attr_accessor("text","rands","detailed_rands"),A.$attr_writer("secret","success","failure","critical","fumble"),j(A,"$secret?",f("secret")),j(A,"$success?",f("success")),j(A,"$failure?",f("failure")),j(A,"$critical?",f("critical")),j(A,"$fumble?",f("fumble")),j(A,"$condition=",function(c){return this.success=c,this.failure=c["$!"]()})},Opal.modules["racc/parser"]=function(e){var L,S,q,Q=e.module,G=e.klass,l=e.truthy,j=e.const_set,B=e.defs,f=e.gvars,U=e.rb_lt,m=e.def,E=e.to_ary,H=e.send,Y=e.neqeq,O=e.rb_plus,T=e.eqeq,K=e.rb_ge,F=e.rb_gt,A=e.rb_minus,t=e.rb_le,W=e.rb_times,c=e.assign_ivar_val,u=[],z=e.$r(u),n=e.nil,i=e.$$$;return L=u,S=[Q(u[0],"Racc")].concat(L),q=e.$r(S),G(S[0],q("StandardError"),"ParseError"),l(i("::","ParseError","skip_raise")?"constant":n)||j(u[0],"ParseError",i(z("Racc"),"ParseError")),function(p,L){var s,o,_,P,R,q=[Q(p,"Racc")].concat(L),w=e.$r(q);return l(w("Racc_No_Extensions","skip_raise")?"constant":n)||j(q[0],"Racc_No_Extensions",!1),s=q,_=[o=G(q[0],null,"Parser")].concat(s),P=e.$r(_),(R=o.$$prototype).yydebug=R.racc_debug_out=R.racc_error_status=R.racc_t=R.racc_vstack=R.racc_val=R.racc_state=R.racc_tstack=n,j(_[0],"Racc_Runtime_Version","1.4.6"),j(_[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),j(_[0],"Racc_Runtime_Core_Version_R","1.4.6"),j(_[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),j(_[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),j(_[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),j(_[0],"Racc_Runtime_Core_Version",P("Racc_Runtime_Core_Version_R")),j(_[0],"Racc_Runtime_Core_Revision",P("Racc_Runtime_Core_Revision_R")),j(_[0],"Racc_Runtime_Type","ruby"),B(P("Parser"),"$racc_runtime_type",function(){return P("Racc_Runtime_Type")}),m(o,"$_racc_setup",function(){var $,I,r=this,h=n,a=n;return null==f.stderr&&(f.stderr=n),l(i(r.$class(),"Racc_debug_parser"))||(r.yydebug=!1),l(null!=($=r.yydebug)&&$!==n?"instance-variable":n)||(r.yydebug=!1),l(r.yydebug)&&(l(null!=(I=r.racc_debug_out)&&I!==n?"instance-variable":n)||(r.racc_debug_out=f.stderr),r.racc_debug_out=l(h=r.racc_debug_out)?h:f.stderr),a=i(r.$class(),"Racc_arg"),l(U(a.$size(),14))&&a["$[]="](13,!0),a}),m(o,"$_racc_init_sysvars",function(){var $=this;return $.racc_state=[0],$.racc_tstack=[],$.racc_vstack=[],$.racc_t=n,$.racc_val=n,$.racc_read_next=!0,$.racc_user_yyerror=!1,$.racc_error_status=0}),m(o,"$do_parse",function(){return this.$__send__(P("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)}),m(o,"$next_token",function(){return this.$raise(P("NotImplementedError"),this.$class()+"#next_token is not defined")}),m(o,"$_racc_do_parse_rb",function($,I){var r,a=this,ee=n,te=n,J=n,_e=n,oe=n,se=n,ue=n,le=n;return r=E($),ee=null==r[0]?n:r[0],te=null==r[1]?n:r[1],J=null==r[2]?n:r[2],_e=null==r[3]?n:r[3],oe=null==r[10]?n:r[10],a.$_racc_init_sysvars(),se=ue=le=n,H(a,"catch",["racc_end_parse"],function $e(){var ae,re,x=null==$e.$$s?this:$e.$$s,Z=n;for(null==x.racc_state&&(x.racc_state=n),null==x.racc_read_next&&(x.racc_read_next=n),null==x.racc_t&&(x.racc_t=n),null==x.yydebug&&(x.yydebug=n),null==x.racc_val&&(x.racc_val=n);l(!0);)for(l(le=_e["$[]"](x.racc_state["$[]"](-1)))?(l(x.racc_read_next)&&Y(x.racc_t,0)&&(re=x.$next_token(),ae=E(re),se=null==ae[0]?n:ae[0],x.racc_val=null==ae[1]?n:ae[1],x.racc_t=l(se)?l(Z=oe["$[]"](se))?Z:1:0,l(x.yydebug)&&x.$racc_read_token(x.racc_t,se,x.racc_val),x.racc_read_next=!1),le=O(le,x.racc_t),l(K(le,0))&&l(ue=ee["$[]"](le))&&T(te["$[]"](le),x.racc_state["$[]"](-1))||(ue=J["$[]"](x.racc_state["$[]"](-1)))):ue=J["$[]"](x.racc_state["$[]"](-1));l(ue=x.$_racc_evalact(ue,$)););},{$$s:a})}),m(o,"$yyparse",function($,I){return this.$__send__(P("Racc_YY_Parse_Method"),$,I,this.$_racc_setup(),!0)}),m(o,"$_racc_yyparse_rb",function($,I,r,h){var a,J=n,_e=n,ce=n,oe=n,ue=n,le=n,$e=n;return a=E(r),J=null==a[0]?n:a[0],_e=null==a[1]?n:a[1],ce=null==a[2]?n:a[2],oe=null==a[3]?n:a[3],ue=null==a[10]?n:a[10],this.$_racc_init_sysvars(),le=n,$e=n,H(this,"catch",["racc_end_parse"],function ae(){var re=null==ae.$$s?this:ae.$$s;for(null==re.racc_state&&(re.racc_state=n);!l($e=oe["$[]"](re.racc_state["$[]"](-1)));)for(;l(le=re.$_racc_evalact(ce["$[]"](re.racc_state["$[]"](-1)),r)););return H($,"__send__",[I],function x(Z,N){var b=null==x.$$s?this:x.$$s,V=n,v=n;for(null==b.racc_t&&(b.racc_t=n),null==b.racc_state&&(b.racc_state=n),null==b.racc_read_next&&(b.racc_read_next=n),null==Z&&(Z=n),null==N&&(N=n),b.racc_t=l(Z)?l(V=ue["$[]"](Z))?V:1:0,b.racc_val=N,b.racc_read_next=!1,$e=O($e,b.racc_t),l(K($e,0))&&l(le=J["$[]"]($e))&&T(_e["$[]"]($e),b.racc_state["$[]"](-1))||(le=ce["$[]"](b.racc_state["$[]"](-1)));l(le=b.$_racc_evalact(le,r)););for(;l(l(V=l(v=($e=oe["$[]"](b.racc_state["$[]"](-1)))["$!"]())?v:b.racc_read_next["$!"]())?V:b.racc_t["$=="](0));)for(l($e)&&l($e=O($e,b.racc_t))&&l(K($e,0))&&l(le=J["$[]"]($e))&&T(_e["$[]"]($e),b.racc_state["$[]"](-1))||(le=ce["$[]"](b.racc_state["$[]"](-1)));l(le=b.$_racc_evalact(le,r)););},{$$s:re})},{$$s:this})}),m(o,"$_racc_evalact",function($,I){var r,ce,a=this,ee=n,te=n,_e=n,oe=n,se=n,ue=n;if(ee=null==(r=E(I))[0]?n:r[0],te=null==r[1]?n:r[1],_e=null==r[3]?n:r[3],ce=null==r[11]?n:r[11],oe=null==r[12]?n:r[12],l(F($,0))&&l(U($,ce)))l(F(a.racc_error_status,0))&&(T(a.racc_t,1)||(a.racc_error_status=A(a.racc_error_status,1))),a.racc_vstack.$push(a.racc_val),a.racc_state.$push($),a.racc_read_next=!0,l(a.yydebug)&&(a.racc_tstack.$push(a.racc_t),a.$racc_shift(a.racc_t,a.racc_tstack,a.racc_vstack));else if(l(U($,0))&&l(F($,oe["$-@"]()))){if(se=H(a,"catch",["racc_jump"],function le(){var $e=null==le.$$s?this:le.$$s;return null==$e.racc_state&&($e.racc_state=n),$e.racc_state.$push($e.$_racc_do_reduce(I,$)),!1},{$$s:a}),l(se))switch(se.valueOf()){case 1:return a.racc_user_yyerror=!0,oe["$-@"]();case 2:return ce;default:a.$raise("[Racc Bug] unknown jump code")}}else if(T($,ce))l(a.yydebug)&&a.$racc_accept(),a.$throw("racc_end_parse",a.racc_vstack["$[]"](0));else{if(T($,oe["$-@"]())){switch(a.racc_error_status.valueOf()){case 0:l(I["$[]"](21))||a.$on_error(a.racc_t,a.racc_val,a.racc_vstack);break;case 3:T(a.racc_t,0)&&a.$throw("racc_end_parse",n),a.racc_read_next=!0}for(a.racc_user_yyerror=!1,a.racc_error_status=3;l(!0)&&!(l(ue=_e["$[]"](a.racc_state["$[]"](-1)))&&(ue=O(ue,1),l(K(ue,0))&&l($=ee["$[]"](ue))&&T(te["$[]"](ue),a.racc_state["$[]"](-1))));)l(t(a.racc_state.$size(),1))&&a.$throw("racc_end_parse",n),a.racc_state.$pop(),a.racc_vstack.$pop(),l(a.yydebug)&&(a.racc_tstack.$pop(),a.$racc_e_pop(a.racc_state,a.racc_tstack,a.racc_vstack));return $}a.$raise("[Racc Bug] unknown action "+$.$inspect())}return l(a.yydebug)&&a.$racc_next_state(a.racc_state["$[]"](-1),a.racc_state),n}),m(o,"$_racc_do_reduce",function($,I){var r,oe,ue,Z,N,b,C,a=this,te=n,J=n,_e=n,ce=n,se=n,le=n,$e=n,ae=n,re=n,x=n,V=n,v=n,X=n;return te=null==(r=E($))[4]?n:r[4],J=null==r[5]?n:r[5],_e=null==r[6]?n:r[6],ce=null==r[7]?n:r[7],oe=null==r[8]?n:r[8],se=null==r[9]?n:r[9],ue=null==r[13]?n:r[13],le=a.racc_state,$e=a.racc_vstack,ae=a.racc_tstack,re=W(I,-3),x=se["$[]"](re),Z=se["$[]"](O(re,1)),N=se["$[]"](O(re,2)),b=[],l(a.yydebug)&&(V=ae["$[]"](x["$-@"](),x)),v=$e["$[]"](x["$-@"](),x),l(a.yydebug)&&ae["$[]="](x["$-@"](),x,b),$e["$[]="](x["$-@"](),x,b),le["$[]="](x["$-@"](),x,b),l(ue)?$e.$push(a.$__send__(N,v,$e,v["$[]"](0))):$e.$push(a.$__send__(N,v,$e)),ae.$push(Z),l(a.yydebug)&&a.$racc_reduce(V,Z,ae,$e),C=A(Z,oe),l(re=ce["$[]"](C))&&(re=O(re,le["$[]"](-1)),l(K(re,0))&&l(X=te["$[]"](re))&&T(J["$[]"](re),C))?X:_e["$[]"](C)}),m(o,"$on_error",function($,I,r){var a,h=this;return h.$raise(P("ParseError"),h.$sprintf("\nparse error on value %s (%s)",I.$inspect(),l(a=h.$token_to_str($))?a:"?"))}),m(o,"$yyerror",function(){return this.$throw("racc_jump",1)}),m(o,"$yyaccept",function(){return this.$throw("racc_jump",2)}),m(o,"$yyerrok",c("racc_error_status",0)),m(o,"$racc_read_token",function($,I,r){var h=this;return h.racc_debug_out.$print("read    "),h.racc_debug_out.$print(I.$inspect(),"(",h.$racc_token2str($),") "),h.racc_debug_out.$puts(r.$inspect()),h.racc_debug_out.$puts()}),m(o,"$racc_shift",function($,I,r){var h=this;return h.racc_debug_out.$puts("shift   "+h.$racc_token2str($)),h.$racc_print_stacks(I,r),h.racc_debug_out.$puts()}),m(o,"$racc_reduce",function($,I,r,h){var a=this,ee=n;return(ee=a.racc_debug_out).$print("reduce "),l($["$empty?"]())?ee.$print(" <none>"):H($,"each",[],function te(J){return null==J&&(J=n),ee.$print(" ",(null==te.$$s?this:te.$$s).$racc_token2str(J))},{$$s:a}),ee.$puts(" --\x3e "+a.$racc_token2str(I)),a.$racc_print_stacks(r,h),a.racc_debug_out.$puts()}),m(o,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()}),m(o,"$racc_e_pop",function($,I,r){var h=this;return h.racc_debug_out.$puts("error recovering mode: pop token"),h.$racc_print_states($),h.$racc_print_stacks(I,r),h.racc_debug_out.$puts()}),m(o,"$racc_next_state",function($,I){var r=this;return r.racc_debug_out.$puts("goto    "+$),r.$racc_print_states(I),r.racc_debug_out.$puts()}),m(o,"$racc_print_stacks",function($,I){var h=n;return(h=this.racc_debug_out).$print("        ["),H($,"each_index",[],function a(ee){return null==ee&&(ee=n),h.$print(" (",(null==a.$$s?this:a.$$s).$racc_token2str($["$[]"](ee))," ",I["$[]"](ee).$inspect(),")")},{$$s:this}),h.$puts(" ]")}),m(o,"$racc_print_states",function($){var r=n;return(r=this.racc_debug_out).$print("        ["),H($,"each",[],function(a){return null==a&&(a=n),r.$print(" ",a)}),r.$puts(" ]")}),m(o,"$racc_token2str",function($){var r;return l(r=i(this.$class(),"Racc_token_to_s_table")["$[]"]($))?r:this.$raise("[Racc Bug] can't convert token "+$+" to string")}),m(o,"$token_to_str",function($){return i(this.$class(),"Racc_token_to_s_table")["$[]"]($)})}(u[0],u)},Opal.modules["bcdice/arithmetic/node"]=function(e){var c,n,D,s,o,q,w,p,u,Q=e.module,G=e.klass,l=e.def,j=e.thrower,B=e.return_ivar,f=e.send2,U=e.find_super,m=e.eqeq,E=e.const_set,H=e.eqeqeq,Y=e.rb_divide,O=e.truthy,T=e.assign_ivar,K=e.alias,F=[],A=e.nil,t=e.$$$;return c=F,n=u=[Q(F[0],"BCDice")].concat(c),D=p=[Q(u[0],"Arithmetic")].concat(n),q=[Q(p[0],"Node")].concat(D),w=e.$r(q),(o=(s=G(q[0],null,"BinaryOp")).$$prototype).lhs=o.rhs=o.op=A,l(s,"$initialize",function(P,R,k){var $=this;return $.lhs=P,$.op=R,$.rhs=k}),l(s,"$eval",function(P){try{j("eval_return");var I,k=this,$=A;return $=k.lhs.$eval(P),I=k.rhs.$eval(P),$.$send(k.op,I)}catch(r){if(r===e.t_eval_return)return r.$v;throw r}}),l(s,"$output",function(){var P=this;return""+P.lhs.$output()+P.op+P.rhs.$output()}),l(s,"$s_exp",function(){var P=this;return"("+P.$op_for_s_exp()+" "+P.lhs.$s_exp()+" "+P.rhs.$s_exp()+")"}),l(s,"$op_for_s_exp",B("op")),function(d,g,s){var o=G(d,g,"DivideBase"),_=[o].concat(s),P=e.$r(_),R=o.$$prototype;R.lhs=R.rhs=R.op=A,l(o,"$initialize",function k($,I){return k.$$p=null,f(this,U(this,"initialize",k,!1,!0),"initialize",[$,"/",I],null)}),l(o,"$eval",function($){try{j("eval_return");var h,a,r=this;return h=r.lhs.$eval($),a=r.rhs.$eval($),m(a,0)&&r.$raise(P("ZeroDivisionError")),r.$divide_and_round(h,a,$)}catch(ee){if(ee===e.t_eval_return)return ee.$v;throw ee}}),l(o,"$output",function k(){var $=k.$$p||A,I=this;return k.$$p=null,""+f(I,U(I,"output",k,!1,!0),"output",[],$)+I.$rounding_method()}),o.$private(),l(o,"$rounding_method",function(){return t(this.$class(),"ROUNDING_METHOD")}),l(o,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()}),l(o,"$divide_and_round",function($,I,r){return this.$raise(P("NotImplementedError"))})}(q[0],w("BinaryOp"),q),function(d,g,s){var o=G(d,g,"DivideWithGameSystemDefault"),_=[o].concat(s),P=e.$r(_);E(_[0],"ROUNDING_METHOD",""),o.$private(),l(o,"$divide_and_round",function(k,$,I){var r,h=A;return H(t(P("RoundType"),"CEIL"),r=I)?Y(k.$to_f(),$).$ceil():H(t(P("RoundType"),"ROUND"),r)?(h=Y(k.$to_f(),$),O(h["$negative?"]())?h.$abs().$round()["$-@"]():h.$round()):Y(k,$).$floor()})}(q[0],w("DivideBase"),q),function(d,g,s){var o=G(d,g,"DivideWithCeil"),_=[o].concat(s);E(_[0],"ROUNDING_METHOD","C"),o.$private(),l(o,"$divide_and_round",function(R,k,$){return Y(R.$to_f(),k).$ceil()})}(q[0],w("DivideBase"),q),function(d,g,s){var o=G(d,g,"DivideWithRound"),_=[o].concat(s);E(_[0],"ROUNDING_METHOD","R"),o.$private(),l(o,"$divide_and_round",function(R,k,$){var I=A;return I=Y(R.$to_f(),k),O(I["$negative?"]())?I.$abs().$round()["$-@"]():I.$round()})}(q[0],w("DivideBase"),q),function(d,g,s){var o=G(d,g,"DivideWithFloor"),_=[o].concat(s);E(_[0],"ROUNDING_METHOD","F"),o.$private(),l(o,"$divide_and_round",function(R,k,$){return Y(R,k).$floor()})}(q[0],w("DivideBase"),q),function(d,g){var s=G(d,null,"Negative");s.$$prototype.body=A,l(s,"$initialize",T("body")),l(s,"$eval",function(P){try{return j("eval_return"),this.body.$eval(P)["$-@"]()}catch($){if($===e.t_eval_return)return $.$v;throw $}}),l(s,"$output",function(){return"-"+this.body.$output()}),l(s,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"})}(q[0]),function(d,g){var s=G(d,null,"Parenthesis");s.$$prototype.expr=A,l(s,"$initialize",T("expr")),l(s,"$eval",function(P){try{return j("eval_return"),this.expr.$eval(P)}catch($){if($===e.t_eval_return)return $.$v;throw $}}),l(s,"$output",function(){return"("+this.expr.$output()+")"}),l(s,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"})}(q[0]),function(d,g){var s=G(d,null,"Number");return s.$$prototype.value=A,l(s,"$initialize",T("value")),l(s,"$eval",B("value")),l(s,"$output",function(){return this.value.$to_s()}),K(s,"s_exp","output")}(q[0])},Opal.modules.strscan=function(e){var T,K,F,A,t,G=e.def,l=e.truthy,j=e.eqeqeq,B=e.Opal,f=e.return_ivar,U=e.send,m=e.alias,E=[],H=e.nil;return T=E,F=[K=(0,e.klass)(E[0],null,"StringScanner")].concat(T),A=e.$r(F),(t=K.$$prototype).pos=t.string=t.working=t.matched=t.prev_pos=t.match=H,K.$attr_reader("pos","matched"),G(K,"$initialize",function(c){var y=this;return y.string=c,y.pos=0,y.matched=H,y.working=c,y.match=[]}),K.$attr_reader("string"),G(K,"$beginning_of_line?",function(){var c=this;return 0===c.pos||"\n"===c.string.charAt(c.pos-1)}),G(K,"$scan",function(c){var y=this,u=(c=y.$anchor(c)).exec(y.working);return null==u?y.matched=H:(y.prev_pos=y.pos,y.pos+=u[0].length,y.working=y.working.substring(u[0].length),y.matched=u[0],y.match=u,u[0])}),G(K,"$scan_until",function(c){var y=this;c=y.$anchor(c);for(var u=y.working,z=0;u.length!=z;++z){var n=c.exec(u.substr(z));if(null!==n){var i=z+n[0].length,p=u.substr(0,i);return y.matched=n[0],y.match=n,y.prev_pos=y.pos+z,y.pos+=i,y.working=u.substr(i),p}}return y.matched=H}),G(K,"$[]",function(c){var u;if(l(this.match["$empty?"]()))return H;j(A("Symbol"),u=c)?c=c.$to_s():j(A("String"),u)||(c=B["$coerce_to!"](c,A("Integer"),"to_int"));var z=this.match;return c<0&&(c+=z.length),c<0||c>=z.length||null==z[c]?H:z[c]}),G(K,"$check",function(c){var y=this,u=(c=y.$anchor(c)).exec(y.working);return y.matched=null==u?H:u[0]}),G(K,"$check_until",function(c){var y=this,u=y.prev_pos,z=y.pos,n=y.working,i=y.$scan_until(c);return y.prev_pos=u,y.pos=z,y.working=n,i}),G(K,"$peek",function(c){return this.working.substring(0,c)}),G(K,"$eos?",function(){return 0===this.working.length}),G(K,"$exist?",function(c){var u=c.exec(this.working);return null==u?H:0==u.index?0:u.index+1}),G(K,"$skip",function(c){var y=this,u=(c=y.$anchor(c)).exec(y.working);if(null==u)return y.match=[],y.matched=H;var z=u[0],n=z.length;return y.matched=z,y.match=u,y.prev_pos=y.pos,y.pos+=n,y.working=y.working.substring(n),n}),G(K,"$skip_until",function(c){var u=this.$scan_until(c);return u===H?H:(this.matched=u.substr(-1),u.length)}),G(K,"$get_byte",function(){var c=this,y=H;return c.pos<c.string.length?(c.prev_pos=c.pos,c.pos+=1,y=c.matched=c.working.substring(0,1),c.working=c.working.substring(1)):c.matched=H,y}),G(K,"$match?",function(c){var y=this,u=(c=y.$anchor(c)).exec(y.working);return null==u?H:(y.prev_pos=y.pos,u[0].length)}),G(K,"$pos=",function(c){var y=this;return c<0&&(c+=y.string.$length()),y.pos=c,y.working=y.string.slice(c)}),G(K,"$matched_size",function(){return this.matched===H?H:this.matched.length}),G(K,"$post_match",function(){var c=this;return c.matched===H?H:c.string.substr(c.pos)}),G(K,"$pre_match",function(){var c=this;return c.matched===H?H:c.string.substr(0,c.prev_pos)}),G(K,"$reset",function(){var c=this;return c.working=c.string,c.matched=H,c.pos=0}),G(K,"$rest",f("working")),G(K,"$rest?",function(){return 0!==this.working.length}),G(K,"$rest_size",function(){return this.$rest().$size()}),G(K,"$terminate",function(){var c,y=this;return y.match=H,c=[y.string.$length()],U(y,"pos=",c),c[c.length-1]}),G(K,"$unscan",function(){var c=this;return c.pos=c.prev_pos,c.prev_pos=H,c.match=H,c}),m(K,"bol?","beginning_of_line?"),m(K,"getch","get_byte"),K.$private(),G(K,"$anchor",function(c){var y=c.toString().match(/\/([^\/]+)$/);return y=y?y[1]:void 0,new RegExp("^(?:"+c.source+")",y)})},Opal.modules["bcdice/normalize"]=function(e){var m,O,H,Q=e.module,G=e.eqeqeq,l=e.def,j=e.eqeq,B=[],f=e.nil;return m=B,H=[Q(B[0],"BCDice")].concat(m),(O=Q(H[0],"Normalize")).$module_function(),l(O,"$comparison_operator",function(K){var F;return G(/<=|=</,F=K)?"<=":G(/>=|=>/,F)?">=":G(/<>|!=|=!/,F)?"!=":G(/</,F)?"<":G(/>/,F)?">":G(/=/,F)?"==":f}),l(O,"$target_number",function(K){return j(K,"?")?K:K.$to_i()})},Opal.modules["bcdice/command/lexer"]=function(e){var T,t,z,n,i,p,L,c,F,Q=e.module,G=e.klass,l=e.const_set,j=e.hash2,B=e.truthy,f=e.send,U=e.def,m=e.thrower,E=e.top,H=[],Y=e.nil;return E.$require("strscan"),E.$require("bcdice/normalize"),T=H,t=F=[Q(H[0],"BCDice")].concat(T),z=c=[Q(F[0],"Command")].concat(t),i=[n=G(c[0],null,"Lexer")].concat(z),p=e.$r(i),(L=n.$$prototype).scanner=L.notations=Y,l(i[0],"SYMBOLS",j(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),U(n,"$initialize",function(S,q){var w,d,s;return S=B(s=(w=(d=S)===Y||null==d?Y:d.$split(" ",2))===Y||null==w?Y:w.$first())?s:"",this.scanner=p("StringScanner").$new(S),this.notations=f(q,"map",[],function(_){return null==_&&(_=Y),B(_["$is_a?"](p("String")))?p("Regexp").$new(_):_})}),U(n,"$next_token",function(){try{var S=m("return"),q=this,w=Y,d=Y,s=Y,o=Y;return B(q.scanner["$eos?"]())?[!1,"$"]:(f(q.notations,"each",[],function _(P){var k,R=null==_.$$s?this:_.$$s;if(null==R.scanner&&(R.scanner=Y),null==P&&(P=Y),k=R.scanner.$scan(P),!B(k))return Y;S.$throw(["NOTATION",k])},{$$s:q,$$ret:S}),B(w=q.scanner.$scan(/\d+/))?["NUMBER",w.$to_i()]:B(d=q.scanner.$scan(/[<>!=]+/))?(d=p("Normalize").$comparison_operator(d),[B(d)?"CMP_OP":"ILLEGAL",d]):(s=q.scanner.$getch().$upcase(),[B(o=p("SYMBOLS")["$[]"](s))?o:s.$to_sym(),s]))}catch(_){if(_===S)return _.$v;throw _}}),U(n,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/command/parsed"]=function(e){var E,T,W,c,y,u,z,F,Y,Q=e.module,G=e.klass,l=e.def,j=e.return_ivar,B=e.truthy,f=[],U=e.nil;return E=f,T=Y=[Q(f[0],"BCDice")].concat(E),W=F=[Q(Y[0],"Command")].concat(T),y=[c=G(F[0],null,"Parsed")].concat(W),u=e.$r(y),(z=c.$$prototype).critical=z.fumble=z.dollar=z.modify_number=z.question_target=z.target_number=z.prefix_number=z.command=z.suffix_number=z.cmp_op=U,c.$attr_accessor("command"),c.$attr_accessor("prefix_number"),c.$attr_accessor("suffix_number"),c.$attr_accessor("critical"),c.$attr_accessor("fumble"),c.$attr_accessor("dollar"),c.$attr_accessor("modify_number"),c.$attr_accessor("cmp_op"),c.$attr_accessor("target_number"),c.$attr_writer("question_target"),l(c,"$initialize",function(){var i=this;return i.prefix_number=U,i.suffix_number=U,i.critical=U,i.fumble=U,i.dollar=U,i.cmp_op=U,i.target_number=U,i.question_target=!1}),l(c,"$question_target?",j("question_target")),l(c,"$to_s",function(i){var p=this,L=U,D=U,S=U,q=U,w=U;switch(null==i&&(i="after_command"),L=B(p.critical)?"@"+p.critical:U,D=B(p.fumble)?"#"+p.fumble:U,S=B(p.dollar)?"$"+p.dollar:U,q=u("Format").$modifier(p.modify_number),w=B(p.question_target)?"?":p.target_number,i.valueOf()){case"after_command":return[p.prefix_number,p.command,p.suffix_number,L,D,S,q,p.cmp_op,w].$join();case"after_modify_number":return[p.prefix_number,p.command,p.suffix_number,q,L,D,S,p.cmp_op,w].$join();case"after_target_number":return[p.prefix_number,p.command,p.suffix_number,q,p.cmp_op,w,L,D,S].$join();default:return U}},-1)},Opal.modules["bcdice/command/parser"]=function(e){var i,S,o,I,r,h,a,ee,te,J,_e,ce,ue,_,k,$,ae,w,d,L,Q=e.klass,G=e.module,l=e.slice,j=e.extract_kwargs,B=e.ensure_kwargs,f=e.get_kwarg,U=e.send2,m=e.find_super,E=e.def,H=e.send,Y=e.eqeq,O=e.thrower,T=e.hash,K=e.const_set,F=e.truthy,A=e.to_ary,t=e.hash2,W=e.top,c=[],y=e.$r(c),u=e.nil,z=e.$$$;return W.$require("racc/parser.rb"),W.$require("bcdice/arithmetic/node"),W.$require("bcdice/command/lexer"),W.$require("bcdice/command/parsed"),Q(z(y("BCDice"),"Command"),z(y("Racc"),"Parser"),"Parser"),i=c,S=L=[G(c[0],"BCDice")].concat(i),w=[G(L[0],"Command")].concat(S),d=e.$r(w),o=w,k=[_=Q(w[0],z(d("Racc"),"Parser"),"Parser")].concat(o),$=e.$r(k),(ae=_.$$prototype).notations=ae.lexer=ae.modifier=ae.suffix_number=ae.prefix_number=ae.need_suffix_number=ae.need_prefix_number=ae.critical=ae.fumble=ae.dollar=ae.allowed_cmp_op=ae.question_target=u,E(_,"$initialize",function re(x,Z){var N,b,V,v,X=this;return re.$$p=null,N=l(arguments),b=j(N),b=B(b),V=N,v=f(b,"round_type"),U(X,m(X,"initialize",re,!1,!0),"initialize",[],null),X.notations=V,X.round_type=v,X.prefix_number=!1,X.suffix_number=!1,X.need_prefix_number=!1,X.need_suffix_number=!1,X.modifier=!0,X.critical=!1,X.fumble=!1,X.dollar=!1,X.allowed_cmp_op=[u,">=",">","<=","<","==","!="],X.question_target=!1},-2),E(_,"$disable_modifier",function(){return this.modifier=!1,this}),E(_,"$enable_prefix_number",function(){return this.prefix_number=!0,this}),E(_,"$enable_suffix_number",function(){return this.suffix_number=!0,this}),E(_,"$has_prefix_number",function(){var x=this;return x.prefix_number=!0,x.need_prefix_number=!0,x}),E(_,"$has_suffix_number",function(){var x=this;return x.suffix_number=!0,x.need_suffix_number=!0,x}),E(_,"$enable_critical",function(){return this.critical=!0,this}),E(_,"$enable_fumble",function(){return this.fumble=!0,this}),E(_,"$enable_dollar",function(){return this.dollar=!0,this}),E(_,"$restrict_cmp_op_to",function(x){var Z;return Z=l(arguments),this.allowed_cmp_op=Z,this},-1),E(_,"$enable_question_target",function(){return this.question_target=!0,this}),E(_,"$parse",function(x){var Z=this;try{return Z.lexer=$("Lexer").$new(x,Z.notations),Z.$do_parse()}catch(N){if(!e.rescue(N,[$("ParseError"),$("ZeroDivisionError")]))throw N;try{return u}finally{e.pop_exception()}}}),_.$private(),E(_,"$parsed",function(x,Z,N,b){try{return O("eval_return"),H($("Parsed").$new(),"tap",[],function C(X){var M,ne,ie,fe,me,de,ve,he=null==C.$$s?this:C.$$s;return null==he.round_type&&(he.round_type=u),null==X&&(X=u),X["$command="](x["$[]"]("command")),X["$prefix_number="]((M=x["$[]"]("prefix"))===u||null==M?u:M.$eval(he.round_type)),X["$suffix_number="]((ne=x["$[]"]("suffix"))===u||null==ne?u:ne.$eval(he.round_type)),X["$critical="]((ie=Z["$[]"]("critical"))===u||null==ie?u:ie.$eval(he.round_type)),X["$fumble="]((fe=Z["$[]"]("fumble"))===u||null==fe?u:fe.$eval(he.round_type)),X["$dollar="]((me=Z["$[]"]("dollar"))===u||null==me?u:me.$eval(he.round_type)),X["$modify_number="](N.$eval(he.round_type)),X["$cmp_op="](b["$[]"]("cmp_op")),Y(b["$[]"]("target"),"?")?(X["$question_target="](!0),H(X,"target_number=",de=[0]),de[de.length-1]):(X["$question_target="](!1),de=[(ve=b["$[]"]("target"),ve===u||null==ve?u:ve.$eval(he.round_type))],H(X,"target_number=",de),de[de.length-1])},{$$s:this})}catch(C){if(C===e.t_eval_return)return C.$v;throw C}}),E(_,"$next_token",function(){return this.lexer.$next_token()}),I=e.large_array_unpack("6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,33,34,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,36,37,17,18,6,,5,,,17,18,6,,5,,,17,18,,,5,23,24,25,26,56,54,55,57"),r=e.large_array_unpack("0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,,17,15,15,18,18,23,,18,30,30,23,23,24,,23,31,31,24,24,25,,24,44,44,25,25,28,,25,47,47,28,28,29,,28,48,48,29,29,33,,29,49,49,33,33,34,,33,50,50,34,34,36,,34,,,36,36,37,,36,,,37,37,,,37,27,27,27,27,52,52,52,52"),h=e.large_array_unpack("-2,4,16,-3,-1,11,,33,13,35,23,30,1,,28,40,,37,44,,,-2,,51,58,65,0,106,72,79,47,54,,86,93,,100,107,,,,,,,63,,,68,75,82,89,,120,,,,,"),a=e.large_array_unpack("-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29"),ee=e.large_array_unpack("30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,,,21,47,48,40,51,52,49,50,44,46,3,,,,13,,,,,,,,32"),te=e.large_array_unpack("8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,,,4,8,8,5,7,7,8,8,9,5,6,,,,6,,,,,,,,6"),J=[u,6,13,3,9,-1,27,-15,-10,-1,-38],_e=[u,u,u,u,u,u,19,16,15,u,u],ce=e.large_array_unpack("0,0,racc_error,4,20,_reduce_1,4,20,_reduce_2,3,20,_reduce_3,3,21,_reduce_4,2,21,_reduce_5,2,21,_reduce_6,1,21,_reduce_7,0,22,_reduce_8,3,22,_reduce_9,3,22,_reduce_10,3,22,_reduce_11,2,23,_reduce_12,2,23,_reduce_13,3,23,_reduce_14,3,23,_reduce_15,0,24,_reduce_16,2,24,_reduce_17,2,24,_reduce_18,3,28,_reduce_19,3,28,_reduce_20,1,28,_reduce_none,3,27,_reduce_22,4,27,_reduce_23,1,27,_reduce_none,0,29,_reduce_25,1,29,_reduce_26,1,29,_reduce_27,1,29,_reduce_28,1,29,_reduce_29,2,26,_reduce_30,2,26,_reduce_31,1,26,_reduce_none,3,25,_reduce_33,1,25,_reduce_34"),ue=T(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),K(k[0],"Racc_arg",[I,r,a,h,ee,te,_e,J,19,ce,ue,58,35,!0]),F($("Ractor","skip_raise")?"constant":u)&&$("Ractor").$make_shareable($("Racc_arg")),K(k[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),F($("Ractor","skip_raise")?"constant":u)&&$("Ractor").$make_shareable($("Racc_token_to_s_table")),K(k[0],"Racc_debug_parser",!1),E(_,"$_reduce_1",function(x,Z,N){var b,v=this;return F(v.modifier)||v.$raise($("ParseError")),b=A(x),v.$parsed(null==b[0]?u:b[0],null==b[1]?u:b[1],null==b[2]?u:b[2],null==b[3]?u:b[3])}),E(_,"$_reduce_2",function(x,Z,N){var b,v=this;return F(v.modifier)||v.$raise($("ParseError")),b=A(x),v.$parsed(null==b[0]?u:b[0],null==b[2]?u:b[2],null==b[1]?u:b[1],null==b[3]?u:b[3])}),E(_,"$_reduce_3",function(x,Z,N){var b,M;return M=null==(b=A(x))[2]?u:b[2],this.$parsed(null==b[0]?u:b[0],null==b[1]?u:b[1],z(z($("Arithmetic"),"Node"),"Number").$new(0),M)}),E(_,"$_reduce_4",function(x,Z,N){var b=this;return F(b.prefix_number)&&F(b.suffix_number)||b.$raise($("ParseError")),t(["command","prefix","suffix"],{command:x["$[]"](1),prefix:x["$[]"](0),suffix:x["$[]"](2)})}),E(_,"$_reduce_5",function(x,Z,N){var b=this;return F(b.prefix_number)||b.$raise($("ParseError")),F(b.need_suffix_number)&&b.$raise($("ParseError")),t(["command","prefix"],{command:x["$[]"](1),prefix:x["$[]"](0)})}),E(_,"$_reduce_6",function(x,Z,N){var b=this;return F(b.suffix_number)||b.$raise($("ParseError")),F(b.need_prefix_number)&&b.$raise($("ParseError")),t(["command","suffix"],{command:x["$[]"](0),suffix:x["$[]"](1)})}),E(_,"$_reduce_7",function(x,Z,N){var b=this;return(F(b.need_prefix_number)||F(b.need_suffix_number))&&b.$raise($("ParseError")),t(["command"],{command:x["$[]"](0)})}),E(_,"$_reduce_8",function(x,Z,N){return t([],{})}),E(_,"$_reduce_9",function(x,Z,N){var b,M,C=u;return C=null==(b=A(x))[0]?u:b[0],M=null==b[2]?u:b[2],F(this.critical)&&F(C["$[]"]("critical")["$nil?"]())||this.$raise($("ParseError")),C["$[]="]("critical",M),C}),E(_,"$_reduce_10",function(x,Z,N){var b,M,C=u;return C=null==(b=A(x))[0]?u:b[0],M=null==b[2]?u:b[2],F(this.fumble)&&F(C["$[]"]("fumble")["$nil?"]())||this.$raise($("ParseError")),C["$[]="]("fumble",M),C}),E(_,"$_reduce_11",function(x,Z,N){var b,M,C=u;return C=null==(b=A(x))[0]?u:b[0],M=null==b[2]?u:b[2],F(this.dollar)&&F(C["$[]"]("dollar")["$nil?"]())||this.$raise($("ParseError")),C["$[]="]("dollar",M),C}),E(_,"$_reduce_12",function(x,Z,N){return x["$[]"](1)}),E(_,"$_reduce_13",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"Negative").$new(x["$[]"](1))}),E(_,"$_reduce_14",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"+",x["$[]"](2))}),E(_,"$_reduce_15",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"-",x["$[]"](2))}),E(_,"$_reduce_16",function(x,Z,N){return F(this.allowed_cmp_op["$include?"](u))||this.$raise($("ParseError")),t([],{})}),E(_,"$_reduce_17",function(x,Z,N){var b,C,X;return X=null==(b=A(x))[1]?u:b[1],F(this.allowed_cmp_op["$include?"](C=null==b[0]?u:b[0]))||this.$raise($("ParseError")),t(["cmp_op","target"],{cmp_op:C,target:X})}),E(_,"$_reduce_18",function(x,Z,N){var V,b=this;return V=x["$[]"](0),F(b.question_target)||b.$raise($("ParseError")),F(b.allowed_cmp_op["$include?"](V))||b.$raise($("ParseError")),t(["cmp_op","target"],{cmp_op:V,target:"?"})}),E(_,"$_reduce_19",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"+",x["$[]"](2))}),E(_,"$_reduce_20",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"-",x["$[]"](2))}),E(_,"$_reduce_22",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"BinaryOp").$new(x["$[]"](0),"*",x["$[]"](2))}),E(_,"$_reduce_23",function(x,Z,N){return x["$[]"](3).$new(x["$[]"](0),x["$[]"](2))}),E(_,"$_reduce_25",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"DivideWithGameSystemDefault")}),E(_,"$_reduce_26",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_27",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"DivideWithCeil")}),E(_,"$_reduce_28",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"DivideWithRound")}),E(_,"$_reduce_29",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"DivideWithFloor")}),E(_,"$_reduce_30",function(x,Z,N){return x["$[]"](1)}),E(_,"$_reduce_31",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"Negative").$new(x["$[]"](1))}),E(_,"$_reduce_33",function(x,Z,N){return x["$[]"](1)}),E(_,"$_reduce_34",function(x,Z,N){return z(z($("Arithmetic"),"Node"),"Number").$new(x["$[]"](0))}),E(_,"$_reduce_none",function(x,Z,N){return x["$[]"](0)})},Opal.modules["bcdice/deprecated/checker"]=function(e){var H,K,W,c,y,u,A,O,Q=e.module,G=e.send,l=e.eqeqeq,j=e.truthy,B=e.def,f=e.return_val,U=[],m=e.nil;return H=U,K=O=[Q(U[0],"BCDice")].concat(H),W=A=[Q(O[0],"Deprecated")].concat(K),y=[c=Q(A[0],"Checker")].concat(W),u=e.$r(y),c.$private(),B(c,"$check_result_legacy",function(n,i,p,L){var w,D=this,S=m,q=m,d=m,g=m;return S=G(i,"map",[],"sides".$to_proc()),w=(q=G(i,"map",[],"value".$to_proc())).$sum(),d=l([100],g=S)?D.$check_1D100(n,w,p,L):l([20],g)?D.$check_1D20(n,w,p,L):l([6,6],g)?D.$check_2D6(n,w,q,p,L):m,(j(d["$nil?"]())||j(d["$empty?"]()))&&(d=l([10],g=S.$uniq())?D.$check_nD10(n,w,q,p,L):l([6],g)?D.$check_nD6(n,w,q,p,L):m,j(d["$nil?"]())||j(d["$empty?"]()))?m:u("Result").$new(d.$delete_prefix(" \uff1e "))}),B(c,"$check_1D100",f(m)),B(c,"$check_1D20",f(m)),B(c,"$check_nD10",f(m)),B(c,"$check_2D6",f(m)),B(c,"$check_nD6",f(m))},Opal.modules["bcdice/base"]=function(e){var y,D,g,R,$,I,s,o,_,P,q,Q=e.module,G=e.klass,l=e.slice,j=e.rb_plus,B=e.truthy,f=e.def,U=e.regexp,m=e.send,E=e.thrower,H=e.return_ivar,Y=e.assign_ivar_val,O=e.eqeqeq,T=e.eqeq,K=e.return_val,F=e.range,A=e.rb_minus,t=e.rb_divide,W=e.rb_times,c=e.rb_ge,u=e.top,z=[],n=e.$r(z),i=e.nil,p=e.$$$;return u.$require("i18n"),u.$require("i18n/backend/fallbacks"),u.$require("bcdice/randomizer"),u.$require("bcdice/dice_table"),u.$require("bcdice/enum"),u.$require("bcdice/translate"),u.$require("bcdice/result"),u.$require("bcdice/command/parser"),u.$require("bcdice/deprecated/checker"),D=z,g=q=[Q(z[0],"BCDice")].concat(D),o=[s=G(q[0],null,"Base")].concat(g),_=e.$r(o),(P=s.$$prototype).raw_input=P.randomizer=P.enabled_upcase_input=P.debug=i,$=[R=e.get_singleton_class(s)].concat(o),I=e.$r($),R.$attr_reader("prefixes"),f(R,"$register_prefix",function(h){var ee,J;return null==this.prefixes&&(this.prefixes=i),ee=l(arguments),this.prefixes=j(B(J=this.prefixes)?J:[],ee.$flatten())},-1),f(R,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())}),f(R,"$prefixes_pattern",function(){var h=this,a=i;return null==h.prefixes_pattern&&(h.prefixes_pattern=i),null==h.prefixes&&(h.prefixes=i),h.prefixes_pattern=B(a=h.prefixes_pattern)?a:i,B(h.prefixes_pattern)?h.prefixes_pattern:(h.prefixes=B(a=h.prefixes)?a:[],h.prefixes.$freeze(),h.prefixes_pattern=(B(h.prefixes["$empty?"]())?/(?!)/:U(["^(S)?(",h.prefixes.$join("|"),")"],"i")).$freeze())}),f(R,"$command_pattern",function(){var h=this,a=i,ee=i;return null==h.command_pattern&&(h.command_pattern=i),null==h.prefixes&&(h.prefixes=i),h.command_pattern=B(a=h.command_pattern)?a:i,B(h.command_pattern)?h.command_pattern:(h.prefixes=B(a=h.prefixes)?a:[],h.prefixes.$freeze(),ee=j(m(p(I("CommonCommand"),"COMMANDS"),"map",[],function(J){return null==J&&(J=i),p(J,"PREFIX_PATTERN").$source()}),h.prefixes),h.command_pattern=U(["^S?(",ee.$join("|"),")"],"i").$freeze())}),f(R,"$eval",function(h){try{return E("eval_return"),this.$new(h).$eval()}catch(te){if(te===e.t_eval_return)return te.$v;throw te}}),s.$include(_("Translate")),s.$include(p(_("Deprecated"),"Checker")),f(s,"$initialize",function(k){var $=this;return $.raw_input=k,$.sort_add_dice=!1,$.sort_barabara_dice=!1,$.d66_sort_type=p(_("D66SortType"),"NO_SORT"),$.enabled_d9=!1,$.round_type=p(_("RoundType"),"FLOOR"),$.sides_implicit_d=6,$.upper_dice_reroll_threshold=i,$.reroll_dice_reroll_threshold=i,$.default_cmp_op=i,$.default_target_number=i,$.enabled_upcase_input=!0,$.locale="ja_jp",$.randomizer=p(_("BCDice"),"Randomizer").$new(),$.debug=!1}),s.$attr_accessor("randomizer"),s.$attr_reader("d66_sort_type"),s.$attr_reader("round_type"),s.$attr_reader("sides_implicit_d"),s.$attr_reader("upper_dice_reroll_threshold"),s.$attr_reader("reroll_dice_reroll_threshold"),s.$attr_reader("default_cmp_op"),s.$attr_reader("default_target_number"),f(s,"$sort_add_dice?",H("sort_add_dice")),f(s,"$sort_barabara_dice?",H("sort_barabara_dice")),f(s,"$enabled_d9?",H("enabled_d9")),f(s,"$enable_debug",Y("debug",!0)),f(s,"$eval",function(){var $,r,k=this,I=i;return $=p(_("BCDice"),"Preprocessor").$process(k.raw_input,k),I=B(r=k.$dice_command($))?r:k.$eval_common_command(k.raw_input),B(I)?(I["$rands="](k.randomizer.$rand_results()),I["$detailed_rands="](k.randomizer.$detailed_rand_results()),I):i}),f(s,"$change_text",function(k){return k}),f(s,"$check_result",function(k,$,I,r){var h=this,a=i,ee=i,te=i,J=i,_e=i;return a=h.$check_result_legacy(k,$,I,r),B(a)?a:(ee=m($,"map",[],"sides".$to_proc()),J=(te=m($,"map",[],"value".$to_proc())).$sum(),a=O([100],_e=ee)?h.$result_1d100(k,J,I,r):O([20],_e)?h.$result_1d20(k,J,I,r):O([6,6],_e)?h.$result_2d6(k,J,te,I,r):i,T(a,_("Result").$nothing())?i:B(a)?a:(a=O([10],_e=ee.$uniq())?h.$result_nd10(k,J,te,I,r):O([6],_e)?h.$result_nd6(k,J,te,I,r):i,T(a,_("Result").$nothing())?i:B(a)?a:h.$result_ndx(k,I,r)))}),f(s,"$grich_text",K(i)),s.$private(),f(s,"$eval_common_command",function(k){try{E("eval_return");var I=E("return");return k=this.$change_text(k),m(p(_("CommonCommand"),"COMMANDS"),"each",[],function h(a){var te,ee=null==h.$$s?this:h.$$s;if(null==ee.randomizer&&(ee.randomizer=i),null==a&&(a=i),te=a.$eval(k,ee,ee.randomizer),!B(te))return i;I.$throw(te)},{$$s:this,$$ret:I}),i}catch(h){if(h===e.t_eval_return||h===I)return h.$v;throw h}}),f(s,"$dice_command",function(k){var $=this,I=i,r=i,h=i,a=i;return B($.enabled_upcase_input)&&(k=k.$upcase()),I=$.$class().$prefixes_pattern().$match(k),B(I)?(r=I["$[]"](1)["$nil?"]()["$!"](),B(r)&&(k=k["$[]"](F(1,-1,!1))),h=$.$eval_game_system_specific_command(k),B(h["$is_a?"](_("Result")))?(h["$secret="](B(a=h["$secret?"]())?a:r),h):B(h["$nil?"]())||B(h["$empty?"]())||T(h,"1")?i:m(_("Result").$new(),"tap",[],function(te){var J;return null==te&&(te=i),te["$text="](h.$to_s()),m(te,"secret=",J=[r]),J[J.length-1]})):i}),f(s,"$eval_game_system_specific_command",K(i)),f(s,"$result_ndx",function(k,$,I){return B(I["$is_a?"](_("String")))?i:B(k.$send($,I))?_("Result").$success(this.$translate("success")):_("Result").$failure(this.$translate("failure"))}),f(s,"$result_1d100",K(i)),f(s,"$result_1d20",K(i)),f(s,"$result_nd10",K(i)),f(s,"$result_2d6",K(i)),f(s,"$result_nd6",K(i)),f(s,"$get_table_by_2d6",function(k){return this.$get_table_by_nD6(k,2)}),f(s,"$get_table_by_1d6",function(k){return this.$get_table_by_nD6(k,1)}),f(s,"$get_table_by_nD6",function(k,$){return this.$get_table_by_nDx(k,$,6)}),f(s,"$get_table_by_nDx",function(k,$,I){var h,a=i;return h=this.randomizer.$roll_sum($,I),a=this.$get_table_value(k["$[]"](A(h,$))),B(a["$nil?"]())?["1",0]:[a,h]}),f(s,"$get_table_by_1d3",function(k){var r,h,$=this,a=i;return $.$debug("get_table_by_1d3"),r=$.randomizer.$roll_sum(1,6),$.$debug("num",r),h=t(A(r,1),2).$to_i(),$.$debug("index",h),a=k["$[]"](h),B(a["$nil?"]())?["1",0]:[a,r]}),f(s,"$get_table_by_d66_swap",function(k){var I;return I=this.randomizer.$roll_d66(p(_("D66SortType"),"ASC")),[this.$get_table_by_number(I,k),I]}),f(s,"$get_table_by_d66",function(k){var I,r,h,ee,a=i;return I=this.randomizer.$roll_once(6),r=this.randomizer.$roll_once(6),h=j(W(A(I,1),6),A(r,1)),a=k["$[]"](h),ee=""+I+r,B(a["$nil?"]())?["1",ee]:[a,ee]}),f(s,"$get_table_by_number",function(k,$,I){try{var r=E("return");return null==I&&(I="1"),m($,"each",[],function a(ee){var J,te=null==a.$$s?this:a.$$s;if(null==ee&&(ee=i),J=ee["$[]"](0),!B(c(J,k)))return i;r.$throw(te.$get_table_value(ee["$[]"](1)))},{$$s:this,$$ret:r}),this.$get_table_value(I)}catch(a){if(a===r)return a.$v;throw a}},-3),f(s,"$get_table_value",function(k){return B(k["$is_a?"](_("Proc")))?k.$call():k}),f(s,"$roll_tables",function(k,$){var r=i;return r=$["$[]"](k),B(r)?r.$roll(this.randomizer).$to_s():i}),f(s,"$debug",function(k,$){var r,h=this,a=i,ee=i;return r=l(arguments,1),B(h.debug)?(a=B(k["$is_a?"](_("String")))?k:k.$inspect(),B(r["$empty?"]())?h.$warn(a):(ee=m(r,"map",[],function(J){return null==J&&(J=i),B(J["$is_a?"](_("String")))?'"'+J+'"':J.$inspect()}),h.$warn(a+": "+ee.$join(", ")))):i},-2),p(p(n("I18n"),"Backend"),"Simple").$include(p(p(n("I18n"),"Backend"),"Fallbacks")),n("I18n").$load_path()["$<<"](n("Dir")["$[]"](n("File").$join("bcdice","../../i18n/**/*.yml"))),n("I18n")["$default_locale="]("ja_jp"),y=[["ja_jp"]],m(n("I18n").$fallbacks(),"defaults=",y),y[y.length-1]},Opal.modules["bcdice/game_system/sword_world/rating_lexer"]=function(e){var Y,F,u,L,D,S,q,n,t,W,T,Q=e.module,G=e.klass,l=e.const_set,j=e.hash2,B=e.truthy,f=e.def,m=[],E=e.nil;return e.top.$require("strscan"),Y=m,F=T=[Q(m[0],"BCDice")].concat(Y),t=[Q(T[0],"GameSystem")].concat(F),W=e.$r(t),u=t,L=n=[G(t[0],W("Base"),"SwordWorld")].concat(u),S=[D=G(n[0],null,"RatingLexer")].concat(L),q=e.$r(S),D.$$prototype.scanner=E,l(S[0],"SYMBOLS",j(["+","-","*","/","(",")","[","]","@","#","$","~"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","@":"AT","#":"SHARP",$:"DOLLAR","~":"TILDE"}).$freeze()),f(D,"$initialize",function(g){var s,o,P;return g=B(P=(s=(o=g)===E||null==o?E:o.$split(" ",2))===E||null==s?E:s.$first())?P:"",this.scanner=q("StringScanner").$new(g)}),f(D,"$next_token",function(){var g=this,s=E,o=E,P=E;return B(g.scanner["$eos?"]())?[!1,"$"]:B(s=g.scanner.$scan(/\d+/))?["NUMBER",s.$to_i()]:(o=g.scanner.$getch().$upcase(),[B(P=q("SYMBOLS")["$[]"](o))?P:o.$to_sym(),o])}),f(D,"$source",function(){return this.scanner.$string()})},Opal.modules["bcdice/game_system/sword_world/rating_parsed"]=function(e){var O,A,z,D,S,q,w,d,i,W,c,K,Q=e.module,G=e.klass,l=e.def,j=e.truthy,B=e.rb_le,f=e.rb_plus,U=e.rb_lt,m=e.neqeq,E=[],H=e.nil;return O=E,A=K=[Q(E[0],"BCDice")].concat(O),W=[Q(K[0],"GameSystem")].concat(A),c=e.$r(W),z=W,D=i=[G(W[0],c("Base"),"SwordWorld")].concat(z),q=[S=G(i[0],null,"RatingParsed")].concat(D),w=e.$r(q),(d=S.$$prototype).modifier_after_half=d.modifier_after_one_and_a_half=d.semi_fixed_val=d.kept_modify=d.rate=d.greatest_fortune=d.modifier=H,S.$attr_accessor("rate"),S.$attr_accessor("critical"),S.$attr_accessor("kept_modify"),S.$attr_accessor("first_to"),S.$attr_accessor("first_modify"),S.$attr_accessor("first_modify_ssp"),S.$attr_accessor("rateup"),S.$attr_accessor("greatest_fortune"),S.$attr_accessor("semi_fixed_val"),S.$attr_accessor("tmp_fixed_val"),S.$attr_accessor("modifier"),S.$attr_accessor("modifier_after_half"),S.$attr_accessor("modifier_after_one_and_a_half"),l(S,"$initialize",function(s,o){var _=this;return _.rate=s,_.modifier=o,_.critical=13,_.kept_modify=0,_.first_to=0,_.first_modify=0,_.first_modify_ssp=0,_.greatest_fortune=!1,_.rateup=0,_.semi_fixed_val=0,_.tmp_fixed_val=0,_.modifier_after_half=H,_.modifier_after_one_and_a_half=H}),l(S,"$half",function(){return this.modifier_after_half["$nil?"]()["$!"]()}),l(S,"$one_and_a_half",function(){return this.modifier_after_one_and_a_half["$nil?"]()["$!"]()}),l(S,"$min_critical",function(){var s=this;return j(B(s.semi_fixed_val,1))?3:f(f(s.semi_fixed_val,s.kept_modify),2).$clamp(3,13)}),l(S,"$infinite_roll?",function(){return U(this.$critical(),this.$min_critical())}),l(S,"$to_s",function(){var s=this,o=H;return o="KeyNo."+s.rate,j(U(s.$critical(),13))&&(o=f(o,"c["+s.$critical()+"]")),m(s.$first_modify(),0)&&(o=f(o,"m["+w("Format").$modifier(s.$first_modify())+"]")),m(s.$first_modify_ssp(),0)&&(o=f(o,"m[~"+w("Format").$modifier(s.$first_modify_ssp())+"]")),m(s.$first_to(),0)&&(o=f(o,"m["+s.$first_to()+"]")),m(s.$rateup(),0)&&(o=f(o,"r["+s.$rateup()+"]")),j(s.greatest_fortune)&&(o=f(o,"gf")),m(s.$semi_fixed_val(),0)&&(o=f(o,"sf["+s.$semi_fixed_val()+"]")),m(s.$tmp_fixed_val(),0)&&(o=f(o,"tf["+s.$tmp_fixed_val()+"]")),m(s.$kept_modify(),0)&&(o=f(o,"a["+w("Format").$modifier(s.$kept_modify())+"]")),m(s.modifier,0)&&(o=f(o,w("Format").$modifier(s.modifier))),o})},Opal.modules["bcdice/game_system/sword_world/rating_options"]=function(e){var m,O,W,n,y,K,F,H,Q=e.module,G=e.klass,l=e.truthy,j=e.def,B=[];return m=B,O=H=[Q(B[0],"BCDice")].concat(m),K=[Q(H[0],"GameSystem")].concat(O),F=e.$r(K),W=K,y=[G(K[0],F("Base"),"SwordWorld")].concat(W),(n=G(y[0],null,"RatingOptions")).$attr_accessor("critical"),n.$attr_accessor("kept_modify"),n.$attr_accessor("first_to"),n.$attr_accessor("first_modify"),n.$attr_accessor("first_modify_ssp"),n.$attr_accessor("rateup"),n.$attr_accessor("greatest_fortune"),n.$attr_accessor("semi_fixed_val"),n.$attr_accessor("tmp_fixed_val"),n.$attr_accessor("modifier"),n.$attr_accessor("modifier_after_half"),n.$attr_accessor("modifier_after_one_and_a_half"),j(n,"$settable_first_roll_adjust_option?",function(){var L,D,p=this;return l(L=l(D=p.$first_modify()["$nil?"]())?p.$first_to()["$nil?"]():D)?p.$first_modify_ssp()["$nil?"]():L}),j(n,"$settable_non_2d_roll_option?",function(){var L,D,p=this;return l(L=l(D=p.$greatest_fortune()["$nil?"]())?p.$semi_fixed_val()["$nil?"]():D)?p.$tmp_fixed_val()["$nil?"]():L})},Opal.modules["bcdice/game_system/sword_world/rating_parser"]=function(e){var y,i,w,P,h,a,ee,te,J,_e,ce,oe,se,$e,R,I,r,x,g,s,L,D,z,Q=e.module,G=e.klass,l=e.ensure_kwargs,j=e.send2,B=e.find_super,f=e.def,U=e.send,m=e.truthy,E=e.not,H=e.thrower,Y=e.hash,O=e.const_set,T=e.to_ary,K=e.eqeq,F=e.top,A=[],t=e.nil,W=e.$$$;return F.$require("racc/parser.rb"),F.$require("bcdice/arithmetic/node"),F.$require("bcdice/enum"),F.$require("bcdice/game_system/sword_world/rating_lexer"),F.$require("bcdice/game_system/sword_world/rating_parsed"),F.$require("bcdice/game_system/sword_world/rating_options"),y=A,i=z=[Q(A[0],"BCDice")].concat(y),L=[Q(z[0],"GameSystem")].concat(i),D=e.$r(L),w=L,g=[G(L[0],D("Base"),"SwordWorld")].concat(w),s=e.$r(g),P=g,I=[R=G(g[0],W(s("Racc"),"Parser"),"RatingParser")].concat(P),r=e.$r(I),(x=R.$$prototype).lexer=x.round_type=x.version=t,f(R,"$initialize",function Z(N){var b,V,C=this;return Z.$$p=null,null==(b=(N=l(N)).$$smap.version)&&(b="v1_0"),null==(V=N.$$smap.round_type)&&(V=W(r("RoundType"),"CEIL")),j(C,B(C,"initialize",Z,!1,!0),"initialize",[],null),C.version=b,C.round_type=V},-1),f(R,"$set_debug",function(){return this.yydebug=!0,this}),f(R,"$parse",function(N){try{return this.lexer=r("RatingLexer").$new(N),this.$do_parse()}catch(V){if(!e.rescue(V,[r("ParseError"),r("ZeroDivisionError")]))throw V;try{return t}finally{e.pop_exception()}}}),R.$private(),f(R,"$parsed",function(N,b,V){try{return H("eval_return"),U(r("RatingParsed").$new(N,b),"tap",[],function X(M){var ne,ie,fe,me,de,ve,he,ge,pe,ye=null==X.$$s?this:X.$$s,be=t;return null==ye.round_type&&(ye.round_type=t),null==M&&(M=t),M["$kept_modify="](m(be=(ne=V.$kept_modify())===t||null==ne?t:ne.$eval(ye.round_type))?be:0),M["$first_to="](m(be=V.$first_to())?be:0),M["$first_modify="](m(be=V.$first_modify())?be:0),M["$first_modify_ssp="](m(be=V.$first_modify_ssp())?be:0),M["$rateup="](m(be=(ie=V.$rateup())===t||null==ie?t:ie.$eval(ye.round_type))?be:0),E(V.$greatest_fortune()["$nil?"]())&&M["$greatest_fortune="](V.$greatest_fortune()),M["$semi_fixed_val="](m(be=(fe=V.$semi_fixed_val())===t||null==fe?t:fe.$clamp(1,6))?be:0),M["$tmp_fixed_val="](m(be=(me=V.$tmp_fixed_val())===t||null==me?t:me.$clamp(1,6))?be:0),M["$modifier_after_half="]((de=V.$modifier_after_half())===t||null==de?t:de.$eval(ye.round_type)),M["$modifier_after_one_and_a_half="]((ve=V.$modifier_after_one_and_a_half())===t||null==ve?t:ve.$eval(ye.round_type)),he=[m((pe=V.$critical(),ge=pe===t||null==pe?t:pe.$eval(ye.round_type),be=ge===t||null==ge?t:ge.$clamp(0,13)))?be:m(M.$half())||m(M.$one_and_a_half())?13:10],U(M,"critical=",he),he[he.length-1]},{$$s:this})}catch(X){if(X===e.t_eval_return)return X.$v;throw X}}),f(R,"$next_token",function(){return this.lexer.$next_token()}),h=e.large_array_unpack("36,66,67,27,28,5,68,3,4,37,38,18,16,17,19,6,20,21,23,24,39,64,65,5,13,9,14,22,15,18,16,17,19,10,20,21,23,24,64,65,64,65,13,11,14,22,15,18,16,17,19,5,20,21,23,24,34,41,34,43,13,44,14,22,15,30,31,30,31,33,34,33,34,64,65,64,65,34,45,30,31,30,31,33,34,33,30,31,53,34,33,34,58,30,31,59,34,33,30,31,30,31,33,34,33,30,31,60,34,33,34,62,30,31,63,34,33,30,31,30,31,33,34,33,30,31,69,34,33,34,,30,31,,34,33,30,31,30,31,33,,33,30,31,64,65,33,64,65"),a=e.large_array_unpack("15,56,56,12,12,0,56,0,0,15,15,7,7,7,7,1,7,7,7,7,15,47,47,3,7,4,7,7,7,25,25,25,25,5,25,25,25,25,49,49,51,51,25,6,25,25,25,50,50,50,50,9,50,50,50,50,13,17,14,19,50,20,50,50,50,13,13,14,14,13,16,14,18,52,52,57,57,22,21,16,16,18,18,16,23,18,22,22,29,24,22,27,37,23,23,38,28,23,24,24,27,27,24,30,27,28,28,39,31,28,33,44,30,30,45,41,30,31,31,33,33,31,64,33,41,41,60,65,41,66,,64,64,,67,64,65,65,66,66,65,,66,67,67,72,72,67,73,73"),ee=e.large_array_unpack("2,15,,20,20,31,43,7,,48,,,-8,54,56,-2,68,52,70,51,53,70,75,82,87,25,,89,94,70,101,106,,108,,,,90,93,96,,113,,,109,112,,8,,25,43,27,60,,,,-10,62,,,124,,,,120,125,127,132,,,,,132,135"),te=e.large_array_unpack("-37,-37,-5,-37,-37,-37,-37,-1,-5,-37,-4,74,-6,-37,-37,-37,-13,-37,-37,-37,-37,-37,-37,-37,-37,-2,-5,-37,-37,-37,-37,-37,-34,-37,-36,-8,-9,-37,-37,-37,-14,-15,-17,-18,-37,-37,-21,-22,-31,-23,-3,-24,-25,-7,-32,-33,-37,-28,-10,-11,-37,-16,-19,-20,-37,-37,-37,-37,-35,-12,-29,-30,-26,-27"),J=e.large_array_unpack("29,35,7,40,1,42,47,49,25,46,51,52,2,56,,8,57,54,55,,,26,,,,,50,,61,,,,,,,,,,,,,,,,,,,,,72,73,70,71"),_e=e.large_array_unpack("5,5,3,5,1,5,6,6,3,5,6,6,2,7,,2,6,5,5,,,2,,,,,3,,5,,,,,,,,,,,,,,,,,,,,,6,6,5,5"),ce=[t,4,12,0,t,-13,-17,-20,t],oe=[t,t,t,t,12,48,t,t,32],se=e.large_array_unpack("0,0,racc_error,2,24,_reduce_1,3,24,_reduce_2,4,24,_reduce_3,2,25,_reduce_4,0,26,_reduce_5,2,26,_reduce_6,4,26,_reduce_7,3,26,_reduce_8,3,26,_reduce_9,4,26,_reduce_10,4,26,_reduce_11,5,26,_reduce_12,2,26,_reduce_13,3,26,_reduce_14,3,26,_reduce_15,4,26,_reduce_16,3,26,_reduce_17,3,26,_reduce_18,4,26,_reduce_19,4,26,_reduce_20,3,26,_reduce_21,2,27,_reduce_22,2,27,_reduce_23,3,27,_reduce_24,3,27,_reduce_25,3,30,_reduce_26,3,30,_reduce_27,1,30,_reduce_none,3,29,_reduce_29,3,29,_reduce_30,1,29,_reduce_none,2,28,_reduce_32,2,28,_reduce_33,1,28,_reduce_none,3,31,_reduce_35,1,31,_reduce_36"),$e=Y(!1,0,"error",1,"NUMBER",2,"K",3,"R",4,"H",5,"O",6,"G",7,"F",8,"S",9,"T",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16,"BRACKETL",17,"BRACKETR",18,"AT",19,"SHARP",20,"DOLLAR",21,"TILDE",22),O(I[0],"Racc_arg",[h,a,te,ee,J,_e,oe,ce,23,se,$e,74,37,!0]),m(r("Ractor","skip_raise")?"constant":t)&&r("Ractor").$make_shareable(r("Racc_arg")),O(I[0],"Racc_token_to_s_table",["$end","error","NUMBER","K","R","H","O","G","F","S","T","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","AT","SHARP","DOLLAR","TILDE","$start","expr","rate","option","modifier","unary","mul","add","term"]),m(r("Ractor","skip_raise")?"constant":t)&&r("Ractor").$make_shareable(r("Racc_token_to_s_table")),O(I[0],"Racc_debug_parser",!1),f(R,"$_reduce_1",function(N,b,V){try{H("eval_return");var C,ne,me,ie=t,fe=t;return ne=null==(C=T(N))[0]?t:C[0],fe=m(me=(ie=null==C[1]?t:C[1]).$modifier())?me:W(W(r("Arithmetic"),"Node"),"Number").$new(0),this.$parsed(ne,fe.$eval(this.round_type),ie)}catch(de){if(de===e.t_eval_return)return de.$v;throw de}}),f(R,"$_reduce_2",function(N,b,V){try{H("eval_return");var C,ie,me,M=this,fe=t,de=t;return ie=null==(C=T(N))[1]?t:C[1],m((fe=null==C[2]?t:C[2]).$modifier_after_one_and_a_half())&&M.$raise(r("ParseError")),m(fe.$modifier_after_half())||fe["$modifier_after_half="](W(W(r("Arithmetic"),"Node"),"Number").$new(0)),de=m(me=fe.$modifier())?me:W(W(r("Arithmetic"),"Node"),"Number").$new(0),M.$parsed(ie,de.$eval(M.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),f(R,"$_reduce_3",function(N,b,V){try{H("eval_return");var C,ie,me,M=this,fe=t,de=t;return ie=null==(C=T(N))[2]?t:C[2],m((fe=null==C[3]?t:C[3]).$modifier_after_half())&&M.$raise(r("ParseError")),m(fe.$modifier_after_one_and_a_half())||fe["$modifier_after_one_and_a_half="](W(W(r("Arithmetic"),"Node"),"Number").$new(0)),de=m(me=fe.$modifier())?me:W(W(r("Arithmetic"),"Node"),"Number").$new(0),M.$parsed(ie,de.$eval(M.round_type),fe)}catch(ve){if(ve===e.t_eval_return)return ve.$v;throw ve}}),f(R,"$_reduce_4",function(N,b,V){return N["$[]"](1).$to_i()}),f(R,"$_reduce_5",function(N,b,V){return r("RatingOptions").$new()}),f(R,"$_reduce_6",function(N,b,V){var v,ne,M=t;return ne=null==(v=T(N))[1]?t:v[1],m((M=null==v[0]?t:v[0]).$modifier()["$nil?"]())||this.$raise(r("ParseError")),M["$modifier="](ne),M}),f(R,"$_reduce_7",function(N,b,V){var v,ie,M=t;return ie=null==(v=T(N))[2]?t:v[2],m((M=null==v[0]?t:v[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),M["$critical="](ie),M}),f(R,"$_reduce_8",function(N,b,V){var v,ie,M=t;return ie=null==(v=T(N))[2]?t:v[2],m((M=null==v[0]?t:v[0]).$critical()["$nil?"]())||this.$raise(r("ParseError")),M["$critical="](ie),M}),f(R,"$_reduce_9",function(N,b,V){var v,M=t,ie=t;return ie=null==(v=T(N))[2]?t:v[2],m((M=null==v[0]?t:v[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),M["$first_to="](ie.$to_i()),M}),f(R,"$_reduce_10",function(N,b,V){var v,M=t,ie=t;return ie=null==(v=T(N))[3]?t:v[3],m((M=null==v[0]?t:v[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),M["$first_modify="](ie.$to_i()),M}),f(R,"$_reduce_11",function(N,b,V){var v,M=t,ie=t;return ie=null==(v=T(N))[3]?t:v[3],m((M=null==v[0]?t:v[0])["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),M["$first_modify="](ie.$to_i()["$-@"]()),M}),f(R,"$_reduce_12",function(N,b,V){var v,M=t,ie=t;return M=null==(v=T(N))[0]?t:v[0],ie=null==v[4]?t:v[4],K(this.version,"v2_5")&&m(M["$settable_first_roll_adjust_option?"]())||this.$raise(r("ParseError")),M["$first_modify_ssp="](ie.$to_i()),M}),f(R,"$_reduce_13",function(N,b,V){var v,M=t;return v=T(N),m((M=null==v[0]?t:v[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),M["$modifier_after_half="](W(W(r("Arithmetic"),"Node"),"Number").$new(0)),M}),f(R,"$_reduce_14",function(N,b,V){var v,ie,M=t;return ie=null==(v=T(N))[2]?t:v[2],m((M=null==v[0]?t:v[0]).$modifier_after_half()["$nil?"]())||this.$raise(r("ParseError")),M["$modifier_after_half="](ie),M}),f(R,"$_reduce_15",function(N,b,V){var v,M=t;return v=T(N),m((M=null==v[0]?t:v[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),M["$modifier_after_one_and_a_half="](W(W(r("Arithmetic"),"Node"),"Number").$new(0)),M}),f(R,"$_reduce_16",function(N,b,V){var v,ie,M=t;return ie=null==(v=T(N))[3]?t:v[3],m((M=null==v[0]?t:v[0]).$modifier_after_one_and_a_half())&&this.$raise(r("ParseError")),M["$modifier_after_one_and_a_half="](ie),M}),f(R,"$_reduce_17",function(N,b,V){var v,ie,M=t;return M=null==(v=T(N))[0]?t:v[0],ie=null==v[2]?t:v[2],m(["v2_5","v2_0"]["$include?"](this.version))&&m(M.$rateup()["$nil?"]())||this.$raise(r("ParseError")),M["$rateup="](ie),M}),f(R,"$_reduce_18",function(N,b,V){var v,M=t;return M=null==(v=T(N))[0]?t:v[0],m(["v2_5","v2_0"]["$include?"](this.version))&&m(M["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),M["$greatest_fortune="](!0),M}),f(R,"$_reduce_19",function(N,b,V){var v,M=t,ie=t;return M=null==(v=T(N))[0]?t:v[0],ie=null==v[3]?t:v[3],m(["v2_5","v2_0"]["$include?"](this.version))&&m(M["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),M["$semi_fixed_val="](ie.$to_i()),M}),f(R,"$_reduce_20",function(N,b,V){var v,M=t,ie=t;return M=null==(v=T(N))[0]?t:v[0],ie=null==v[3]?t:v[3],m(["v2_5","v2_0"]["$include?"](this.version))&&m(M["$settable_non_2d_roll_option?"]())||this.$raise(r("ParseError")),M["$tmp_fixed_val="](ie.$to_i()),M}),f(R,"$_reduce_21",function(N,b,V){var v,ie,M=t;return M=null==(v=T(N))[0]?t:v[0],ie=null==v[2]?t:v[2],K(this.version,"v2_5")&&m(M.$kept_modify()["$nil?"]())||this.$raise(r("ParseError")),M["$kept_modify="](ie),M}),f(R,"$_reduce_22",function(N,b,V){return N["$[]"](1)}),f(R,"$_reduce_23",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"Negative").$new(N["$[]"](1))}),f(R,"$_reduce_24",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"BinaryOp").$new(N["$[]"](0),"+",N["$[]"](2))}),f(R,"$_reduce_25",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"BinaryOp").$new(N["$[]"](0),"-",N["$[]"](2))}),f(R,"$_reduce_26",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"BinaryOp").$new(N["$[]"](0),"+",N["$[]"](2))}),f(R,"$_reduce_27",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"BinaryOp").$new(N["$[]"](0),"-",N["$[]"](2))}),f(R,"$_reduce_29",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"BinaryOp").$new(N["$[]"](0),"*",N["$[]"](2))}),f(R,"$_reduce_30",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"DivideWithGameSystemDefault").$new(N["$[]"](0),N["$[]"](2))}),f(R,"$_reduce_32",function(N,b,V){return N["$[]"](1)}),f(R,"$_reduce_33",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"Negative").$new(N["$[]"](1))}),f(R,"$_reduce_35",function(N,b,V){return N["$[]"](1)}),f(R,"$_reduce_36",function(N,b,V){return W(W(r("Arithmetic"),"Node"),"Number").$new(N["$[]"](0))}),f(R,"$_reduce_none",function(N,b,V){return N["$[]"](0)})},Opal.queue(function(e){var L,w,P,R,k,$,I,g,s,S,Q=e.module,G=e.klass,l=e.const_set,j=e.send2,B=e.find_super,f=e.def,U=e.truthy,m=e.rb_ge,E=e.rb_le,H=e.eqeq,Y=e.neqeq,O=e.rb_minus,T=e.rb_gt,K=e.hash2,F=e.send,A=e.to_ary,t=e.rb_plus,W=e.rb_lt,c=e.rb_times,y=e.thrower,u=e.rb_divide,z=e.top,n=[],i=e.nil;return z.$require("bcdice/base"),z.$require("bcdice/game_system/sword_world/rating_parser"),L=n,w=S=[Q(n[0],"BCDice")].concat(L),g=[Q(S[0],"GameSystem")].concat(w),s=e.$r(g),P=g,k=[R=G(g[0],s("Base"),"SwordWorld")].concat(P),$=e.$r(k),(I=R.$$prototype).rating_table=I.randomizer=i,l(k[0],"ID","SwordWorld"),l(k[0],"NAME","\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"),l(k[0],"SORT_KEY","\u305d\u304a\u3068\u308f\u3042\u308b\u3068"),l(k[0],"HELP_MESSAGE","\u30fbSW\u3000\u30ec\u30fc\u30c6\u30a3\u30f3\u30b0\u8868\u3000(Kx[c]+m$f) (x:\u30ad\u30fc, c:\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024, m:\u30dc\u30fc\u30ca\u30b9, f:\u51fa\u76ee\u4fee\u6b63)\n"),R.$register_prefix("H?K"),f(R,"$initialize",function r(h){return r.$$p=null,j(this,B(this,"initialize",r,!1,!0),"initialize",[h],null),this.rating_table=0}),f(R,"$result_2d6",function(h,a,ee,te,J){return U(m(a,12))?$("Result").$critical(this.$translate("SwordWorld.critical")):U(E(a,2))?$("Result").$fumble(this.$translate("SwordWorld.fumble")):Y(te,">=")||H(J,"?")?i:U(m(h,J))?$("Result").$success(this.$translate("success")):$("Result").$failure(this.$translate("failure"))}),f(R,"$eval_game_system_specific_command",function(h){return this.$rating(h)}),R.$private(),f(R,"$rating_parser",function(){return $("RatingParser").$new()}),f(R,"$rating",function(h){var a,ee,te=this,J=i,_e=i,ce=i,oe=i,se=i,ue=i,le=i,$e=i,ae=i,re=i,x=i,Z=i,N=i,b=i,V=i,C=i,X=i;return te.$debug("rating string",h),J=te.$rating_parser().$parse(h),U(J)?(_e=te.$getSW2_0_RatingTable(),ce=O(_e.$length(),1),te.$debug("keyMax",ce),U(T(J.$rate(),ce))?$("Result").$new(te.$translate("SwordWorld.keynumber_exceeds",K(["keyMax"],{keyMax:ce}))):U(J["$infinite_roll?"]())?$("Result").$new(te.$translate("SwordWorld.infinite_critical",K(["min_critical"],{min_critical:J.$min_critical()}))):(oe=te.$getNewRates(_e),se=J+" \uff1e ",ue=[],le=[],$e=[],ae=0,re=0,x=0,Z=0,N=J.$first_to(),b=J.$first_modify(),V=J.$first_modify_ssp(),function(){try{var M=y("break");return F(te,"loop",[],function ne(){var ie,fe,he,ge,me=null==ne.$$s?this:ne.$$s,de=i,ve=i;if(fe=me.$rollDice(J,Z),ve=null==(ie=A(fe))[1]?i:ie[1],ae=de=null==ie[0]?i:ie[0],Y(N,0)?(ae=de=N,N=0):Y(b,0)?(ae=t(ae,b),b=0):Y(V,0)&&(U(E(de,10))&&(ae=t(ae,V)),V=0),U(E(de,2))&&(ue["$<<"](de.$to_s()),le["$<<"](ve.$to_s()),$e["$<<"]("**"),Z=t(Z,1),M.$throw()),Y(J.$kept_modify(),0)&&Y(ae,2)&&(ae=t(ae,J.$kept_modify())),U(W(ae,2))&&(ae=2),U(T(ae,12))&&(ae=12),he=t(J.$rate(),c(Z,J.$rateup())).$clamp(0,ce),me.$debug("currentKey",he),ge=oe["$[]"](ae)["$[]"](he),me.$debug("rateValue",ge),x=t(x,ge),re=t(re,ae),ue["$<<"](ae.$to_s()),le["$<<"](ve.$to_s()),$e["$<<"](U(T(ae,2))?ge:"**"),Z=t(Z,1),U(m(ae,J.$critical())))return i;M.$throw()},{$$s:te})}catch(ne){if(ne===M)return ne.$v;throw ne}}(),ee=te.$getResultText(x,J,le,ue,$e,re,Z),a=A(ee),C=null==a[1]?i:a[1],X=null==a[2]?i:a[2],se=t(se,null==a[0]?i:a[0]),F($("Result").$new(),"tap",[],function(ne){var ie;return null==ne&&(ne=i),ne["$text="](se),ne["$critical="](C),F(ne,"fumble=",ie=[X]),ie[ie.length-1]}))):(te.$debug("not matched"),"1")}),f(R,"$getSW2_0_RatingTable",function(){return["*,0,0,0,1,2,2,3,3,4,4","*,0,0,0,1,2,3,3,3,4,4","*,0,0,0,1,2,3,4,4,4,4","*,0,0,1,1,2,3,4,4,4,5","*,0,0,1,2,2,3,4,4,5,5","*,0,1,1,2,2,3,4,5,5,5","*,0,1,1,2,3,3,4,5,5,5","*,0,1,1,2,3,4,4,5,5,6","*,0,1,2,2,3,4,4,5,6,6","*,0,1,2,3,3,4,4,5,6,7","*,1,1,2,3,3,4,5,5,6,7","*,1,2,2,3,3,4,5,6,6,7","*,1,2,2,3,4,4,5,6,6,7","*,1,2,3,3,4,4,5,6,7,7","*,1,2,3,4,4,4,5,6,7,8","*,1,2,3,4,4,5,5,6,7,8","*,1,2,3,4,4,5,6,7,7,8","*,1,2,3,4,5,5,6,7,7,8","*,1,2,3,4,5,6,6,7,7,8","*,1,2,3,4,5,6,7,7,8,9","*,1,2,3,4,5,6,7,8,9,10","*,1,2,3,4,6,6,7,8,9,10","*,1,2,3,5,6,6,7,8,9,10","*,2,2,3,5,6,7,7,8,9,10","*,2,3,4,5,6,7,7,8,9,10","*,2,3,4,5,6,7,8,8,9,10","*,2,3,4,5,6,8,8,9,9,10","*,2,3,4,6,6,8,8,9,9,10","*,2,3,4,6,6,8,9,9,10,10","*,2,3,4,6,7,8,9,9,10,10","*,2,4,4,6,7,8,9,10,10,10","*,2,4,5,6,7,8,9,10,10,11","*,3,4,5,6,7,8,10,10,10,11","*,3,4,5,6,8,8,10,10,10,11","*,3,4,5,6,8,9,10,10,11,11","*,3,4,5,7,8,9,10,10,11,12","*,3,5,5,7,8,9,10,11,11,12","*,3,5,6,7,8,9,10,11,12,12","*,3,5,6,7,8,10,10,11,12,13","*,4,5,6,7,8,10,11,11,12,13","*,4,5,6,7,9,10,11,11,12,13","*,4,6,6,7,9,10,11,12,12,13","*,4,6,7,7,9,10,11,12,13,13","*,4,6,7,8,9,10,11,12,13,14","*,4,6,7,8,10,10,11,12,13,14","*,4,6,7,9,10,10,11,12,13,14","*,4,6,7,9,10,10,12,13,13,14","*,4,6,7,9,10,11,12,13,13,15","*,4,6,7,9,10,12,12,13,13,15","*,4,6,7,10,10,12,12,13,14,15","*,4,6,8,10,10,12,12,13,15,15","*,5,7,8,10,10,12,12,13,15,15","*,5,7,8,10,11,12,12,13,15,15","*,5,7,9,10,11,12,12,14,15,15","*,5,7,9,10,11,12,13,14,15,16","*,5,7,10,10,11,12,13,14,16,16","*,5,8,10,10,11,12,13,15,16,16","*,5,8,10,11,11,12,13,15,16,17","*,5,8,10,11,12,12,13,15,16,17","*,5,9,10,11,12,12,14,15,16,17","*,5,9,10,11,12,13,14,15,16,18","*,5,9,10,11,12,13,14,16,17,18","*,5,9,10,11,13,13,14,16,17,18","*,5,9,10,11,13,13,15,17,17,18","*,5,9,10,11,13,14,15,17,17,18","*,5,9,10,12,13,14,15,17,18,18","*,5,9,10,12,13,15,15,17,18,19","*,5,9,10,12,13,15,16,17,19,19","*,5,9,10,12,14,15,16,17,19,19","*,5,9,10,12,14,16,16,17,19,19","*,5,9,10,12,14,16,17,18,19,19","*,5,9,10,13,14,16,17,18,19,20","*,5,9,10,13,15,16,17,18,19,20","*,5,9,10,13,15,16,17,19,20,21","*,6,9,10,13,15,16,18,19,20,21","*,6,9,10,13,16,16,18,19,20,21","*,6,9,10,13,16,17,18,19,20,21","*,6,9,10,13,16,17,18,20,21,22","*,6,9,10,13,16,17,19,20,22,23","*,6,9,10,13,16,18,19,20,22,23","*,6,9,10,13,16,18,20,21,22,23","*,6,9,10,13,17,18,20,21,22,23","*,6,9,10,14,17,18,20,21,22,24","*,6,9,11,14,17,18,20,21,23,24","*,6,9,11,14,17,19,20,21,23,24","*,6,9,11,14,17,19,21,22,23,24","*,7,10,11,14,17,19,21,22,23,25","*,7,10,12,14,17,19,21,22,24,25","*,7,10,12,14,18,19,21,22,24,25","*,7,10,12,15,18,19,21,22,24,26","*,7,10,12,15,18,19,21,23,25,26","*,7,11,13,15,18,19,21,23,25,26","*,7,11,13,15,18,20,21,23,25,27","*,8,11,13,15,18,20,22,23,25,27","*,8,11,13,16,18,20,22,23,25,28","*,8,11,14,16,18,20,22,23,26,28","*,8,11,14,16,19,20,22,23,26,28","*,8,12,14,16,19,20,22,24,26,28","*,8,12,15,16,19,20,22,24,27,28","*,8,12,15,17,19,20,22,24,27,29","*,8,12,15,18,19,20,22,24,27,30"]}),f(R,"$getNewRates",function(h){var a,ee,J=i,_e=i,ce=i,oe=i,se=i,ue=i,le=i,$e=i,ae=i,re=i,x=i;return J=[],_e=[],ce=[],oe=[],se=[],ue=[],le=[],$e=[],ae=[],re=[],x=[],F(h,"each",[],function(b){var V=i;return null==b&&(b=i),V=b.$split(/,/),x.$push(0),J.$push(V["$[]"](1).$to_i()),_e.$push(V["$[]"](2).$to_i()),ce.$push(V["$[]"](3).$to_i()),oe.$push(V["$[]"](4).$to_i()),se.$push(V["$[]"](5).$to_i()),ue.$push(V["$[]"](6).$to_i()),le.$push(V["$[]"](7).$to_i()),$e.$push(V["$[]"](8).$to_i()),ae.$push(V["$[]"](9).$to_i()),re.$push(V["$[]"](10).$to_i())}),H(this.rating_table,1)&&re["$[]="](31,(a=[32,(ee=[33,10],F(re,"[]=",ee),ee[ee.length-1])],F(re,"[]=",a),a[a.length-1])),[x,x,x,J,_e,ce,oe,se,ue,le,$e,ae,re]}),f(R,"$rollDice",function(h,a){var te=i;return[(te=this.randomizer.$roll_barabara(2,6)).$sum(),te.$join(",")]}),f(R,"$getResultText",function(h,a,ee,te,J,_e,ce){var se=i,ue=i,le=i,$e=i,ae=i;return(se=[]).$push("2D:["+ee.$join(" ")+"]="+te.$join(",")),U(E(_e,2))?(se.$push(J.$join(",")),se.$push(this.$translate("SwordWorld.fumble")),[se.$join(" \uff1e "),!1,!0]):(U(T(J.$size(),1))||Y(a.$modifier(),0)?(ue=t(J.$join(","),$("Format").$modifier(a.$modifier())),U(a.$half())?(ue="("+ue+")/2",Y(a.$modifier_after_half(),0)&&(ue=t(ue,$("Format").$modifier(a.$modifier_after_half())))):U(a.$one_and_a_half())&&(ue="("+ue+")*1.5",Y(a.$modifier_after_one_and_a_half(),0)&&(ue=t(ue,$("Format").$modifier(a.$modifier_after_one_and_a_half())))),se.$push(ue)):U(a.$half())?(ue=J.$first()+"/2",Y(a.$modifier_after_half(),0)&&(ue=t(ue,$("Format").$modifier(a.$modifier_after_half()))),se.$push(ue)):U(a.$one_and_a_half())&&(ue=J.$first()+"*1.5",Y(a.$modifier_after_one_and_a_half(),0)&&(ue=t(ue,$("Format").$modifier(a.$modifier_after_one_and_a_half()))),se.$push(ue)),U(T(ce,1))&&(le=this.$translate("SwordWorld.round_text",K(["reroll_count"],{reroll_count:O(ce,1)})),se.$push(le)),$e=t(h,a.$modifier()),U(a.$half())?($e=u($e,2).$ceil(),Y(a.$modifier_after_half(),0)&&($e=t($e,a.$modifier_after_half()))):U(a.$one_and_a_half())&&($e=c($e,1.5).$ceil(),Y(a.$modifier_after_one_and_a_half(),0)&&($e=t($e,a.$modifier_after_one_and_a_half()))),ae=$e.$to_s(),se.$push(ae),[se.$join(" \uff1e "),T(ce,1),!1])})})}}]);