!function(){function e(e,i){return n(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=e[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);i=!0);}catch(l){r=!0,a=l}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(e,i)||o(e,i)||t()}function t(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(e){if(Array.isArray(e))return e}function i(e){return function(e){if(Array.isArray(e))return s(e)}(e)||r(e)||o(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function r(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function a(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=o(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,l=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw a}}}}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function l(e){var t="function"==typeof Map?new Map:void 0;return(l=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return c(e,arguments,v(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),d(i,e)})(e)}function c(e,t,n){return(c=m()?Reflect.construct:function(e,t,n){var i=[null];i.push.apply(i,t);var r=new(Function.bind.apply(e,i));return n&&d(r,n.prototype),r}).apply(null,arguments)}function u(e,t,n){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var i=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(i){var r=Object.getOwnPropertyDescriptor(i,t);return r.get?r.get.call(n):r.value}})(e,t,n||e)}function h(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function f(e){var t=m();return function(){var n,i=v(e);if(t){var r=v(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return p(this,n)}}function p(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?g(e):t}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function b(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function k(e,t,n){return t&&b(e.prototype,t),n&&b(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{"+qE3":function(e,t,n){"use strict";var i,r="object"==typeof Reflect?Reflect:null,a=r&&"function"==typeof r.apply?r.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};i=r&&"function"==typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function s(){s.init.call(this)}e.exports=s,e.exports.once=function(e,t){return new Promise(function(n,i){function r(n){e.removeListener(t,a),i(n)}function a(){"function"==typeof e.removeListener&&e.removeListener("error",r),n([].slice.call(arguments))}v(e,t,a,{once:!0}),"error"!==t&&function(e,t,n){"function"==typeof e.on&&v(e,"error",t,{once:!0})}(e,r)})},s.EventEmitter=s,s.prototype._events=void 0,s.prototype._eventsCount=0,s.prototype._maxListeners=void 0;var l=10;function c(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function u(e){return void 0===e._maxListeners?s.defaultMaxListeners:e._maxListeners}function h(e,t,n,i){var r,a,o;if(c(n),void 0===(a=e._events)?(a=e._events=Object.create(null),e._eventsCount=0):(void 0!==a.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),a=e._events),o=a[t]),void 0===o)o=a[t]=n,++e._eventsCount;else if("function"==typeof o?o=a[t]=i?[n,o]:[o,n]:i?o.unshift(n):o.push(n),(r=u(e))>0&&o.length>r&&!o.warned){o.warned=!0;var s=new Error("Possible EventEmitter memory leak detected. "+o.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");s.name="MaxListenersExceededWarning",s.emitter=e,s.type=t,s.count=o.length,console&&console.warn&&console.warn(s)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(e,t,n){var i={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},r=d.bind(i);return r.listener=n,i.wrapFn=r,r}function p(e,t,n){var i=e._events;if(void 0===i)return[];var r=i[t];return void 0===r?[]:"function"==typeof r?n?[r.listener||r]:[r]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(r):m(r,r.length)}function g(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function m(e,t){for(var n=new Array(t),i=0;i<t;++i)n[i]=e[i];return n}function v(e,t,n,i){if("function"==typeof e.on)i.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function r(a){i.once&&e.removeEventListener(t,r),n(a)})}}Object.defineProperty(s,"defaultMaxListeners",{enumerable:!0,get:function(){return l},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");l=e}}),s.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},s.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},s.prototype.getMaxListeners=function(){return u(this)},s.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i="error"===e,r=this._events;if(void 0!==r)i=i&&void 0===r.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var s=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw s.context=o,s}var l=r[e];if(void 0===l)return!1;if("function"==typeof l)a(l,this,t);else{var c=l.length,u=m(l,c);for(n=0;n<c;++n)a(u[n],this,t)}return!0},s.prototype.on=s.prototype.addListener=function(e,t){return h(this,e,t,!1)},s.prototype.prependListener=function(e,t){return h(this,e,t,!0)},s.prototype.once=function(e,t){return c(t),this.on(e,f(this,e,t)),this},s.prototype.prependOnceListener=function(e,t){return c(t),this.prependListener(e,f(this,e,t)),this},s.prototype.off=s.prototype.removeListener=function(e,t){var n,i,r,a,o;if(c(t),void 0===(i=this._events))return this;if(void 0===(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(r=-1,a=n.length-1;a>=0;a--)if(n[a]===t||n[a].listener===t){o=n[a].listener,r=a;break}if(r<0)return this;0===r?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,r),1===n.length&&(i[e]=n[0]),void 0!==i.removeListener&&this.emit("removeListener",e,o||t)}return this},s.prototype.removeAllListeners=function(e){var t,n,i;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var r,a=Object.keys(n);for(i=0;i<a.length;++i)"removeListener"!==(r=a[i])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this},s.prototype.listeners=function(e){return p(this,e,!0)},s.prototype.rawListeners=function(e){return p(this,e,!1)},s.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):g.call(e,t)},s.prototype.listenerCount=g,s.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]}},0:function(e,t,n){e.exports=n("zUnb")},"19AM":function(e,t,n){t.ExtBuffer=function e(t,n){if(!(this instanceof e))return new e(t,n);this.buffer=i.from(t),this.type=n};var i=n("5ukv")},"1mG5":function(e,t,n){var i=n("19AM").ExtBuffer,r=n("FEcD"),a=n("NDgz").readUint8,o=n("sZbO"),s=n("eHTg");function l(){var e=this.options;return this.decode=function(e){var t=o.getReadToken(e);return function(e){var n=a(e),i=t[n];if(!i)throw new Error("Invalid type: "+(n?"0x"+n.toString(16):n));return i(e)}}(e),e&&e.preset&&r.setExtUnpackers(this),this}s.install({addExtUnpacker:function(e,t){(this.extUnpackers||(this.extUnpackers=[]))[e]=s.filter(t)},getExtUnpacker:function(e){return(this.extUnpackers||(this.extUnpackers=[]))[e]||function(t){return new i(t,e)}},init:l}),t.preset=l.call(s.preset)},"26FE":function(e,t,n){t.encode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n("Lcv9").EncodeBuffer},"2f56":function(e,t,n){var i=n("iSaS"),r=String.fromCharCode;t.createBuffer=function(e,t){if(!i.HAS_TYPED)return new Array(t);switch(e){case 8:return new Uint8Array(t);case 16:return new Uint16Array(t)}};var a=t.truncateBuffer=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};t.bufferToString_fast=function(e,t){if(null==t?t=e.length:e=a(e,t),i.CAN_CHARCODE_APPLY&&i.CAN_CHARCODE_APPLY_TYPED){var n=e.length;if(n<i.APPLY_BUFFER_SIZE&&i.APPLY_BUFFER_SIZE_OK)return r.apply(null,e);if(null===i.APPLY_BUFFER_SIZE_OK)try{var s=r.apply(null,e);return n>i.APPLY_BUFFER_SIZE&&(i.APPLY_BUFFER_SIZE_OK=!0),s}catch(l){i.APPLY_BUFFER_SIZE_OK=!1}}return o(e)};var o=t.bufferToString_chunked=function(e){for(var t,n="",a=e.length,o=0;o<a;){if(t=e.subarray?e.subarray(o,o+i.APPLY_BUFFER_SIZE):e.slice(o,o+i.APPLY_BUFFER_SIZE),o+=i.APPLY_BUFFER_SIZE,!i.APPLY_BUFFER_SIZE_OK){if(null===i.APPLY_BUFFER_SIZE_OK)try{n+=r.apply(null,t),t.length>i.APPLY_BUFFER_SIZE&&(i.APPLY_BUFFER_SIZE_OK=!0);continue}catch(l){i.APPLY_BUFFER_SIZE_OK=!1}return s(e)}n+=r.apply(null,t)}return n},s=t.bufferToString_slow=function(e){for(var t="",n=e.length,i=0;i<n;i++)t+=r(e[i]);return t};t.stringToArray=function(e){for(var t=[],n=e&&e.length,i=0;i<n;i++)t[i]=e.charCodeAt(i);return t},t.createWindow=function(){for(var e=i.WINDOW_MAX>>7,t="        ";!(e&i.WINDOW_MAX);)t+=t,e<<=1;return t}},"49sm":function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},"5ukv":function(e,t,n){var i=t.global=n("zTos"),r=t.hasBuffer=i&&!!i.isBuffer,a=t.hasArrayBuffer="undefined"!=typeof ArrayBuffer,o=t.isArray=n("49sm");t.isArrayBuffer=a?function(e){return e instanceof ArrayBuffer||p(e)}:v;var s=t.isBuffer=r?i.isBuffer:v,l=t.isView=a?ArrayBuffer.isView||y("ArrayBuffer","buffer"):v;t.alloc=f,t.concat=function(e,n){n||(n=0,Array.prototype.forEach.call(e,function(e){n+=e.length}));var i=f.call(this!==t&&this||e[0],n),r=0;return Array.prototype.forEach.call(e,function(e){r+=d.copy.call(e,i,r)}),i},t.from=function(e){return"string"==typeof e?g.call(this,e):m(this).from(e)};var c=t.Array=n("t2S5"),u=t.Buffer=n("T4b0"),h=t.Uint8Array=n("BTrk"),d=t.prototype=n("W3Yc");function f(e){return m(this).alloc(e)}var p=y("ArrayBuffer");function g(e){var t=3*e.length,n=f.call(this,t),i=d.write.call(n,e);return t!==i&&(n=d.slice.call(n,0,i)),n}function m(e){return s(e)?u:l(e)?h:o(e)?c:r?u:a?h:c}function v(){return!1}function y(e,t){return e="[object "+e+"]",function(n){return null!=n&&{}.toString.call(t?n[t]:n)===e}}},"7ice":function(e){e.exports=JSON.parse('{"_from":"lzbase62@^2.0.0","_id":"lzbase62@2.0.0","_inBundle":false,"_integrity":"sha512-hq7ZI8T42YVgSxCFHzg/Gt3GUKGZdQXKejvubdLjzxjiF5Tn9xKoWvZLZSY1u0+Orct+bxQMmb8XIcbXzR+2tg==","_location":"/lzbase62","_phantomChildren":{},"_requested":{"type":"range","registry":true,"raw":"lzbase62@^2.0.0","name":"lzbase62","escapedName":"lzbase62","rawSpec":"^2.0.0","saveSpec":null,"fetchSpec":"^2.0.0"},"_requiredBy":["/"],"_resolved":"https://registry.npmjs.org/lzbase62/-/lzbase62-2.0.0.tgz","_shasum":"84f2003c4dbe1505c2679d96d72e9c4365e45980","_spec":"lzbase62@^2.0.0","_where":"C:\\\\Users\\\\keyra\\\\OneDrive\\\\Documents\\\\Prog\\\\UdonariumWithFly","author":{"name":"polygon planet","email":"polygon.planet.aqua@gmail.com"},"browserify":{"transform":["package-json-versionify"]},"bugs":{"url":"https://github.com/polygonplanet/lzbase62/issues"},"bundleDependencies":false,"deprecated":false,"description":"LZ77(LZSS) based compression algorithm in base62 for JavaScript","devDependencies":{"bannerify":"^1.0.1","browserify":"^16.5.0","es6-shim":"^0.35.5","eslint":"^6.8.0","karma":"^4.4.1","karma-browserify":"^6.1.0","karma-chrome-launcher":"^3.1.0","karma-detect-browsers":"^2.3.3","karma-es6-shim":"^1.0.0","karma-firefox-launcher":"^1.3.0","karma-ie-launcher":"^1.0.0","karma-mocha":"^1.3.0","karma-mocha-reporter":"^2.2.5","karma-safari-launcher":"^1.0.0","mocha":"^7.0.0","package-json-versionify":"^1.0.4","power-assert":"^1.6.1","uglify-js":"^3.7.5","uglifyify":"^5.0.2","watchify":"^3.11.1"},"engines":{"node":">=8.10.0"},"files":["dist/*","src/*"],"homepage":"https://github.com/polygonplanet/lzbase62","keywords":["compression","decompression","algorithm","compress","decompress","extract","zip","lz77","lzss","lzw","base64","base62","zip","gzip","zlib","inflate","deflate","string"],"license":"MIT","main":"src/index.js","name":"lzbase62","repository":{"type":"git","url":"git+ssh://git@github.com/polygonplanet/lzbase62.git"},"scripts":{"build":"npm run compile && npm run minify","compile":"browserify src/index.js -o dist/lzbase62.js -s lzbase62 -p [ bannerify --file src/banner.js ] --no-bundle-external --bare","minify":"uglifyjs dist/lzbase62.js -o dist/lzbase62.min.js --comments -c -m -b ascii_only=true,beautify=false","test":"eslint src && npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js","travis":"npm run build && mocha test/**/*.spec.js --timeout 10000 && karma start karma.conf.js --single-run","watch":"watchify src/index.js -o dist/lzbase62.js -s lzbase62 -p [ bannerify --file src/banner.js ] --no-bundle-external --bare --poll=200 -v"},"version":"2.0.0"}')},BTrk:function(e,t,n){var i=n("5ukv");function r(e){return new Uint8Array(e)}(t=e.exports=i.hasArrayBuffer?r(0):[]).alloc=r,t.concat=i.concat,t.from=function(e){if(i.isView(e)){var n=e.byteOffset,r=e.byteLength;(e=e.buffer).byteLength!==r&&(e.slice?e=e.slice(n,n+r):(e=new Uint8Array(e)).byteLength!==r&&(e=Array.prototype.slice.call(e,n,n+r)))}else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(e)}},"BoP+":function(e,t){t.copy=function(e,t,n,i){var r;n||(n=0),i||0===i||(i=this.length),t||(t=0);var a=i-n;if(e===this&&n<t&&t<i)for(r=a-1;r>=0;r--)e[r+t]=this[r+n];else for(r=0;r<a;r++)e[r+t]=this[r+n];return a},t.toString=function(e,t,n){var i=0|t;n||(n=this.length);for(var r="",a=0;i<n;)(a=this[i++])<128?r+=String.fromCharCode(a):(192==(224&a)?a=(31&a)<<6|63&this[i++]:224==(240&a)?a=(15&a)<<12|(63&this[i++])<<6|63&this[i++]:240==(248&a)&&(a=(7&a)<<18|(63&this[i++])<<12|(63&this[i++])<<6|63&this[i++]),a>=65536?(a-=65536,r+=String.fromCharCode(55296+(a>>>10),56320+(1023&a))):r+=String.fromCharCode(a));return r},t.write=function(e,t){for(var n=t||(t|=0),i=e.length,r=0,a=0;a<i;)(r=e.charCodeAt(a++))<128?this[n++]=r:r<2048?(this[n++]=192|r>>>6,this[n++]=128|63&r):r<55296||r>57343?(this[n++]=224|r>>>12,this[n++]=128|r>>>6&63,this[n++]=128|63&r):(r=65536+(r-55296<<10|e.charCodeAt(a++)-56320),this[n++]=240|r>>>18,this[n++]=128|r>>>12&63,this[n++]=128|r>>>6&63,this[n++]=128|63&r);return n-t}},"F+F2":function(e,t,n){var i;e.exports=(i=n("Ib8C"),function(){if("function"==typeof ArrayBuffer){var e=i.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,i=[],r=0;r<n;r++)i[r>>>2]|=e[r]<<24-r%4*8;t.call(this,i,n)}else t.apply(this,arguments)}).prototype=e}}(),i.lib.WordArray)},FEcD:function(e,t,n){t.setExtUnpackers=function(e){e.addExtUnpacker(14,[s,c(Error)]),e.addExtUnpacker(1,[s,c(EvalError)]),e.addExtUnpacker(2,[s,c(RangeError)]),e.addExtUnpacker(3,[s,c(ReferenceError)]),e.addExtUnpacker(4,[s,c(SyntaxError)]),e.addExtUnpacker(5,[s,c(TypeError)]),e.addExtUnpacker(6,[s,c(URIError)]),e.addExtUnpacker(10,[s,l]),e.addExtUnpacker(11,[s,u(Boolean)]),e.addExtUnpacker(12,[s,u(String)]),e.addExtUnpacker(13,[s,u(Date)]),e.addExtUnpacker(15,[s,u(Number)]),"undefined"!=typeof Uint8Array&&(e.addExtUnpacker(17,u(Int8Array)),e.addExtUnpacker(18,u(Uint8Array)),e.addExtUnpacker(19,[h,u(Int16Array)]),e.addExtUnpacker(20,[h,u(Uint16Array)]),e.addExtUnpacker(21,[h,u(Int32Array)]),e.addExtUnpacker(22,[h,u(Uint32Array)]),e.addExtUnpacker(23,[h,u(Float32Array)]),"undefined"!=typeof Float64Array&&e.addExtUnpacker(24,[h,u(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&e.addExtUnpacker(25,u(Uint8ClampedArray)),e.addExtUnpacker(26,h),e.addExtUnpacker(29,[h,u(DataView)])),r.hasBuffer&&e.addExtUnpacker(27,u(a))};var i,r=n("5ukv"),a=r.global,o={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function s(e){return i||(i=n("htI/").decode),i(e)}function l(e){return RegExp.apply(null,e)}function c(e){return function(t){var n=new e;for(var i in o)n[i]=t[i];return n}}function u(e){return function(t){return new e(t)}}function h(e){return new Uint8Array(e).buffer}},HlZf:function(e,t,n){t.encode=n("26FE").encode,t.decode=n("htI/").decode,t.Encoder=n("nZiH").Encoder,t.Decoder=n("NMIm").Decoder,t.createCodec=n("RiOb").createCodec,t.codec=n("nZuW").codec},IKIk:function(e,t,n){!function(e){var t,n="undefined"!=typeof Buffer&&Buffer,i="undefined"!=typeof Uint8Array&&Uint8Array,r="undefined"!=typeof ArrayBuffer&&ArrayBuffer,a=[0,0,0,0,0,0,0,0],o=Array.isArray||function(e){return!!e&&"[object Array]"==Object.prototype.toString.call(e)},s=4294967296;function l(o,l,b){var k=l?0:4,_=l?4:0,w=l?0:3,x=l?1:2,C=l?2:1,E=l?3:0,S=l?g:v,T=l?m:y,O=A.prototype,I="is"+o,M="_"+I;return O.buffer=void 0,O.offset=0,O[M]=!0,O.toNumber=P,O.toString=function(e){var t=this.buffer,n=this.offset,i=R(t,n+k),r=R(t,n+_),a="",o=!b&&2147483648&i;for(o&&(i=~i,r=s-r),e=e||10;;){var l=i%e*s+r;if(i=Math.floor(i/e),r=Math.floor(l/e),a=(l%e).toString(e)+a,!i&&!r)break}return o&&(a="-"+a),a},O.toJSON=P,O.toArray=c,n&&(O.toBuffer=u),i&&(O.toArrayBuffer=h),A[I]=function(e){return!(!e||!e[M])},e[o]=A,A;function A(e,n,o,l){return this instanceof A?function(e,n,o,l,c){i&&r&&(n instanceof r&&(n=new i(n)),l instanceof r&&(l=new i(l))),n||o||l||t?(d(n,o)||(c=o,l=n,o=0,n=new(t||Array)(8)),e.buffer=n,e.offset=o|=0,void 0!==l&&("string"==typeof l?function(e,t,n,i){var r=0,a=n.length,o=0,l=0;"-"===n[0]&&r++;for(var c=r;r<a;){var u=parseInt(n[r++],i);if(!(u>=0))break;l=l*i+u,o=o*i+Math.floor(l/s),l%=s}c&&(o=~o,l?l=s-l:o++),D(e,t+k,o),D(e,t+_,l)}(n,o,l,c||10):d(l,c)?f(n,o,l,c):"number"==typeof c?(D(n,o+k,l),D(n,o+_,c)):l>0?S(n,o,l):l<0?T(n,o,l):f(n,o,a,0))):e.buffer=p(a,0)}(this,e,n,o,l):new A(e,n,o,l)}function P(){var e=this.buffer,t=this.offset,n=R(e,t+k),i=R(e,t+_);return b||(n|=0),n?n*s+i:i}function D(e,t,n){e[t+E]=255&n,e[t+C]=255&(n>>=8),e[t+x]=255&(n>>=8),e[t+w]=255&(n>>=8)}function R(e,t){return 16777216*e[t+w]+(e[t+x]<<16)+(e[t+C]<<8)+e[t+E]}}function c(e){var n=this.buffer,i=this.offset;return t=null,!1!==e&&0===i&&8===n.length&&o(n)?n:p(n,i)}function u(e){var i=this.buffer,r=this.offset;if(t=n,!1!==e&&0===r&&8===i.length&&Buffer.isBuffer(i))return i;var a=new n(8);return f(a,0,i,r),a}function h(e){var n=this.buffer,a=this.offset,o=n.buffer;if(t=i,!1!==e&&0===a&&o instanceof r&&8===o.byteLength)return o;var s=new i(8);return f(s,0,n,a),s.buffer}function d(e,t){var n=e&&e.length;return t|=0,n&&t+8<=n&&"string"!=typeof e[t]}function f(e,t,n,i){t|=0,i|=0;for(var r=0;r<8;r++)e[t++]=255&n[i++]}function p(e,t){return Array.prototype.slice.call(e,t,t+8)}function g(e,t,n){for(var i=t+8;i>t;)e[--i]=255&n,n/=256}function m(e,t,n){var i=t+8;for(n++;i>t;)e[--i]=255&-n^255,n/=256}function v(e,t,n){for(var i=t+8;t<i;)e[t++]=255&n,n/=256}function y(e,t,n){var i=t+8;for(n++;t<i;)e[t++]=255&-n^255,n/=256}l("Uint64BE",!0,!0),l("Int64BE",!0,!1),l("Uint64LE",!1,!0),l("Int64LE",!1,!1)}("string"!=typeof t.nodeName?t:this||{})},Iab2:function(e,t,n){var i,r;void 0===(r="function"==typeof(i=function(){"use strict";function t(e,t,n){var i=new XMLHttpRequest;i.open("GET",e),i.responseType="blob",i.onload=function(){o(i.response,t,n)},i.onerror=function(){console.error("could not download file")},i.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(t){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(n)}}var r="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,a=r.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),o=r.saveAs||("object"!=typeof window||window!==r?function(){}:"download"in HTMLAnchorElement.prototype&&!a?function(e,a,o){var s=r.URL||r.webkitURL,l=document.createElement("a");l.download=a=a||e.name||"download",l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,a,o):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,a){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),r);else if(n(e))t(e,r,a);else{var o=document.createElement("a");o.href=e,o.target="_blank",setTimeout(function(){i(o)})}}:function(e,n,i,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,i);var s="application/octet-stream"===e.type,l=/constructor/i.test(r.HTMLElement)||r.safari,c=/CriOS\/[\d]+/.test(navigator.userAgent);if((c||s&&l||a)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var e=u.result;e=c?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},u.readAsDataURL(e)}else{var h=r.URL||r.webkitURL,d=h.createObjectURL(e);o?o.location=d:location.href=d,o=null,setTimeout(function(){h.revokeObjectURL(d)},4e4)}});r.saveAs=o.saveAs=o,e.exports=o})?i.apply(t,[]):i)||(e.exports=r)},Ib8C:function(e,t,n){var i;e.exports=i=i||function(e,t){var n=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),i={},r=i.lib={},a=r.Base={extend:function(e){var t=n(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},o=r.WordArray=a.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||l).stringify(this)},concat:function(e){var t=this.words,n=e.words,i=this.sigBytes,r=e.sigBytes;if(this.clamp(),i%4)for(var a=0;a<r;a++)t[i+a>>>2]|=(n[a>>>2]>>>24-a%4*8&255)<<24-(i+a)%4*8;else for(a=0;a<r;a+=4)t[i+a>>>2]=n[a>>>2];return this.sigBytes+=r,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=a.clone.call(this);return e.words=this.words.slice(0),e},random:function(t){for(var n,i=[],r=function(t){t=t;var n=987654321,i=4294967295;return function(){var r=((n=36969*(65535&n)+(n>>16)&i)<<16)+(t=18e3*(65535&t)+(t>>16)&i)&i;return r/=4294967296,(r+=.5)*(e.random()>.5?1:-1)}},a=0;a<t;a+=4){var s=r(4294967296*(n||e.random()));n=987654071*s(),i.push(4294967296*s()|0)}return new o.init(i,t)}}),s=i.enc={},l=s.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++){var a=t[r>>>2]>>>24-r%4*8&255;i.push((a>>>4).toString(16)),i.push((15&a).toString(16))}return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i+=2)n[i>>>3]|=parseInt(e.substr(i,2),16)<<24-i%8*4;return new o.init(n,t/2)}},c=s.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,i=[],r=0;r<n;r++)i.push(String.fromCharCode(t[r>>>2]>>>24-r%4*8&255));return i.join("")},parse:function(e){for(var t=e.length,n=[],i=0;i<t;i++)n[i>>>2]|=(255&e.charCodeAt(i))<<24-i%4*8;return new o.init(n,t)}},u=s.Utf8={stringify:function(e){try{return decodeURIComponent(escape(c.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return c.parse(unescape(encodeURIComponent(e)))}},h=r.BufferedBlockAlgorithm=a.extend({reset:function(){this._data=new o.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=u.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n=this._data,i=n.words,r=n.sigBytes,a=this.blockSize,s=r/(4*a),l=(s=t?e.ceil(s):e.max((0|s)-this._minBufferSize,0))*a,c=e.min(4*l,r);if(l){for(var u=0;u<l;u+=a)this._doProcessBlock(i,u);var h=i.splice(0,l);n.sigBytes-=c}return new o.init(h,c)},clone:function(){var e=a.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),d=(r.Hasher=h.extend({cfg:a.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new d.HMAC.init(e,n).finalize(t)}}}),i.algo={});return i}(Math)},Lcv9:function(e,t,n){t.EncodeBuffer=r;var i=n("l5sx").preset;function r(e){if(!(this instanceof r))return new r(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n("jZ1Y").FlexEncoder.mixin(r.prototype),r.prototype.codec=i,r.prototype.write=function(e){this.codec.encode(this,e)}},McxJ:function(e,t,n){var i=n("iSaS"),r=n("2f56");function a(e){this._init(e)}a.prototype={_init:function(e){e=e||{},this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd},_createTable:function(){for(var e={},t=0;t<i.TABLE_LENGTH;t++)e[i.BASE62TABLE.charAt(t)]=t;return e},_onData:function(e){var t;if(this._onDataCallback){if(e)t=this._result,this._result=[];else{var n=i.DECOMPRESS_CHUNK_SIZE-i.WINDOW_MAX;t=this._result.slice(i.WINDOW_MAX,i.WINDOW_MAX+n),this._result=this._result.slice(0,i.WINDOW_MAX).concat(this._result.slice(i.WINDOW_MAX+n))}t.length>0&&this._onDataCallback(r.bufferToString_fast(t))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(e){if(null==e||0===e.length)return"";this._result=r.stringToArray(r.createWindow());for(var t,n,a,o,s,l,c,u,h,d,f=this._createTable(),p=!1,g=null,m=e.length,v=0;v<m;v++)if(void 0!==(a=f[e.charAt(v)])){if(a<i.DECODE_MAX)s=p?f[e.charAt(++v)]*i.UNICODE_CHAR_MAX+a+i.UNICODE_BUFFER_MAX*g:g*i.UNICODE_CHAR_MAX+a,this._result[this._result.length]=s;else if(a<i.LATIN_DECODE_MAX)g=a-i.DECODE_MAX,p=!1;else if(a===i.CHAR_START)g=(o=f[e.charAt(++v)])-5,p=!0;else if(a<i.COMPRESS_INDEX){if(o=f[e.charAt(++v)],a<i.COMPRESS_FIXED_START?(l=(a-i.COMPRESS_START)*i.BUFFER_MAX+o,c=f[e.charAt(++v)]):(l=(a-i.COMPRESS_FIXED_START)*i.BUFFER_MAX+o,c=2),(u=this._result.slice(-l)).length>c&&(u.length=c),h=u.length,u.length>0)for(d=0;d<c;)for(n=0;n<h&&(this._result[this._result.length]=u[n],!(++d>=c));n++);g=null}this._result.length>=i.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(i.WINDOW_MAX),this._onData(!0),this._onEnd(),t=r.bufferToString_fast(this._result),this._result=null,t}},e.exports=a},NDgz:function(e,t,n){var i=n("kVK+"),r=n("IKIk"),a=r.Uint64BE,o=r.Int64BE;t.getReadFormat=function(e){var t=e&&e.int64;return{map:c&&e&&e.usemap?h:u,array:d,str:f,bin:s.hasArrayBuffer&&e&&e.binarraybuffer?g:p,ext:m,uint8:v,uint16:b,uint32:_,uint64:x(8,t?S:C),int8:y,int16:k,int32:w,int64:x(8,t?T:E),float32:x(4,O),float64:x(8,I)}},t.readUint8=v;var s=n("5ukv"),l=n("W3Yc"),c="undefined"!=typeof Map;function u(e,t){var n,i={},r=new Array(t),a=new Array(t),o=e.codec.decode;for(n=0;n<t;n++)r[n]=o(e),a[n]=o(e);for(n=0;n<t;n++)i[r[n]]=a[n];return i}function h(e,t){var n,i=new Map,r=new Array(t),a=new Array(t),o=e.codec.decode;for(n=0;n<t;n++)r[n]=o(e),a[n]=o(e);for(n=0;n<t;n++)i.set(r[n],a[n]);return i}function d(e,t){for(var n=new Array(t),i=e.codec.decode,r=0;r<t;r++)n[r]=i(e);return n}function f(e,t){var n=e.reserve(t);return l.toString.call(e.buffer,"utf-8",n,n+t)}function p(e,t){var n=e.reserve(t),i=l.slice.call(e.buffer,n,n+t);return s.from(i)}function g(e,t){var n=e.reserve(t),i=l.slice.call(e.buffer,n,n+t);return s.Uint8Array.from(i).buffer}function m(e,t){var n=e.reserve(t+1),i=e.buffer[n++],r=n+t,a=e.codec.getExtUnpacker(i);if(!a)throw new Error("Invalid ext type: "+(i?"0x"+i.toString(16):i));return a(l.slice.call(e.buffer,n,r))}function v(e){var t=e.reserve(1);return e.buffer[t]}function y(e){var t=e.reserve(1),n=e.buffer[t];return 128&n?n-256:n}function b(e){var t=e.reserve(2),n=e.buffer;return n[t++]<<8|n[t]}function k(e){var t=e.reserve(2),n=e.buffer,i=n[t++]<<8|n[t];return 32768&i?i-65536:i}function _(e){var t=e.reserve(4),n=e.buffer;return 16777216*n[t++]+(n[t++]<<16)+(n[t++]<<8)+n[t]}function w(e){var t=e.reserve(4),n=e.buffer;return n[t++]<<24|n[t++]<<16|n[t++]<<8|n[t]}function x(e,t){return function(n){var i=n.reserve(e);return t.call(n.buffer,i,!0)}}function C(e){return new a(this,e).toNumber()}function E(e){return new o(this,e).toNumber()}function S(e){return new a(this,e)}function T(e){return new o(this,e)}function O(e){return i.read(this,e,!1,23,4)}function I(e){return i.read(this,e,!1,52,8)}},NH6c:function(e,t){function n(e){var t="    ";if(isNaN(parseInt(e)))t=e;else switch(e){case 1:t=" ";break;case 2:t="  ";break;case 3:t="   ";break;case 4:t="    ";break;case 5:t="     ";break;case 6:t="      ";break;case 7:t="       ";break;case 8:t="        ";break;case 9:t="         ";break;case 10:t="          ";break;case 11:t="           ";break;case 12:t="            "}for(var n=["\n"],i=0;i<100;i++)n.push(n[i]+t);return n}function i(){this.step="    ",this.shift=n(this.step)}function r(e,t){return t-(e.replace(/\(/g,"").length-e.replace(/\)/g,"").length)}function a(e,t){return e.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+t+t+"AND ").replace(/ BETWEEN /gi,"~::~"+t+"BETWEEN ").replace(/ CASE /gi,"~::~"+t+"CASE ").replace(/ ELSE /gi,"~::~"+t+"ELSE ").replace(/ END /gi,"~::~"+t+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+t+"ON ").replace(/ OR /gi,"~::~"+t+t+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+t+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+t).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+t+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}i.prototype.xml=function(e,t){var i=e.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),r=i.length,a=!1,o=0,s="",l=0,c=t?n(t):this.shift;for(l=0;l<r;l++)i[l].search(/<!/)>-1?(s+=c[o]+i[l],a=!0,(i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1||i[l].search(/!DOCTYPE/)>-1)&&(a=!1)):i[l].search(/-->/)>-1||i[l].search(/\]>/)>-1?(s+=i[l],a=!1):/^<\w/.exec(i[l-1])&&/^<\/\w/.exec(i[l])&&/^<[\w:\-\.\,]+/.exec(i[l-1])==/^<\/[\w:\-\.\,]+/.exec(i[l])[0].replace("/","")?(s+=i[l],a||o--):i[l].search(/<\w/)>-1&&-1==i[l].search(/<\//)&&-1==i[l].search(/\/>/)?s=s+=a?i[l]:c[o++]+i[l]:i[l].search(/<\w/)>-1&&i[l].search(/<\//)>-1?s=s+=a?i[l]:c[o]+i[l]:i[l].search(/<\//)>-1?s=s+=a?i[l]:c[--o]+i[l]:i[l].search(/\/>/)>-1?s=s+=a?i[l]:c[o]+i[l]:i[l].search(/<\?/)>-1||i[l].search(/xmlns\:/)>-1||i[l].search(/xmlns\=/)>-1?s+=c[o]+i[l]:s+=i[l];return"\n"==s[0]?s.slice(1):s},i.prototype.json=function(e,t){return t=t||this.step,"undefined"==typeof JSON?e:"string"==typeof e?JSON.stringify(JSON.parse(e),null,t):"object"==typeof e?JSON.stringify(e,null,t):e},i.prototype.css=function(e,t){var i=e.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),r=i.length,a=0,o="",s=0,l=t?n(t):this.shift;for(s=0;s<r;s++)/\{/.exec(i[s])?o+=l[a++]+i[s]:/\}/.exec(i[s])?o+=l[--a]+i[s]:(/\*\\/.exec(i[s]),o+=l[a]+i[s]);return o.replace(/^\n{1,}/,"")},i.prototype.sql=function(e,t){var i=e.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),o=i.length,s=[],l=0,c=this.step,u=0,h="",d=0,f=t?n(t):this.shift;for(d=0;d<o;d++)s=s.concat(d%2?i[d]:a(i[d],c));for(o=s.length,d=0;d<o;d++)u=r(s[d],u),/\s{0,}\s{0,}SELECT\s{0,}/.exec(s[d])&&(s[d]=s[d].replace(/\,/g,",\n"+c+c)),/\s{0,}\s{0,}SET\s{0,}/.exec(s[d])&&(s[d]=s[d].replace(/\,/g,",\n"+c+c)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(s[d])?h+=f[++l]+s[d]:/\'/.exec(s[d])?(u<1&&l&&l--,h+=s[d]):(h+=f[l]+s[d],u<1&&l&&l--);return h.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},i.prototype.xmlmin=function(e,t){return(t?e:e.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},i.prototype.jsonmin=function(e){return"undefined"==typeof JSON?e:JSON.stringify(JSON.parse(e),null,0)},i.prototype.cssmin=function(e,t){return(t?e:e.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},i.prototype.sqlmin=function(e){return e.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},e.exports=new i},NMIm:function(e,t,n){t.Decoder=a;var i=n("VOSt"),r=n("NdQB").DecodeBuffer;function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}a.prototype=new r,i.mixin(a.prototype),a.prototype.decode=function(e){arguments.length&&this.write(e),this.flush()},a.prototype.push=function(e){this.emit("data",e)},a.prototype.end=function(e){this.decode(e),this.emit("end")}},NdQB:function(e,t,n){t.DecodeBuffer=r;var i=n("1mG5").preset;function r(e){if(!(this instanceof r))return new r(e);if(e&&(this.options=e,e.codec)){var t=this.codec=e.codec;t.bufferish&&(this.bufferish=t.bufferish)}}n("jZ1Y").FlexDecoder.mixin(r.prototype),r.prototype.codec=i,r.prototype.fetch=function(){return this.codec.decode(this)}},RiOb:function(e,t,n){n("1mG5"),n("l5sx"),t.createCodec=n("eHTg").createCodec},T4b0:function(e,t,n){var i=n("5ukv"),r=i.global;function a(e){return new r(e)}(t=e.exports=i.hasBuffer?a(0):[]).alloc=i.hasBuffer&&r.alloc||a,t.concat=i.concat,t.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return r.from&&1!==r.from.length?r.from(e):new r(e)}},VOSt:function(e,t,n){!function(t){e.exports=t;var n={on:function(e,t){return a(this,e).push(t),this},once:function(e,t){var n=this;return i.originalListener=t,a(n,e).push(i),n;function i(){r.call(n,e,i),t.apply(this,arguments)}},off:r,emit:function(e,t){var n=this,i=a(n,e,!0);if(!i)return!1;var r=arguments.length;if(1===r)i.forEach(s);else if(2===r)i.forEach(l);else{var o=Array.prototype.slice.call(arguments,1);i.forEach(c)}return!!i.length;function s(e){e.call(n)}function l(e){e.call(n,t)}function c(e){e.apply(n,o)}}};function i(e){for(var t in n)e[t]=n[t];return e}function r(e,t){var n,i=this;if(arguments.length){if(t){if(n=a(i,e,!0)){if(!(n=n.filter(o)).length)return r.call(i,e);i.listeners[e]=n}}else if((n=i.listeners)&&(delete n[e],!Object.keys(n).length))return r.call(i)}else delete i.listeners;return i;function o(e){return e!==t&&e.originalListener!==t}}function a(e,t,n){if(!n||e.listeners){var i=e.listeners||(e.listeners={});return i[t]||(i[t]=[])}}i(t.prototype),t.mixin=i}(function e(){if(!(this instanceof e))return new e})},W3Yc:function(e,t,n){var i=n("BoP+");t.copy=l,t.slice=c,t.toString=function(e,t,n){var a=!o&&r.isBuffer(this)?this.toString:i.toString;return a.apply(this,arguments)},t.write=function(){return(this.write||i.write).apply(this,arguments)};var r=n("5ukv"),a=r.global,o=r.hasBuffer&&"TYPED_ARRAY_SUPPORT"in a,s=o&&!a.TYPED_ARRAY_SUPPORT;function l(e,t,n,a){var o=r.isBuffer(this),l=r.isBuffer(e);if(o&&l)return this.copy(e,t,n,a);if(s||o||l||!r.isView(this)||!r.isView(e))return i.copy.call(this,e,t,n,a);var u=n||null!=a?c.call(this,n,a):this;return e.set(u,t),u.length}function c(e,t){var n=this.slice||!s&&this.subarray;if(n)return n.call(this,e,t);var i=r.alloc.call(this,t-e);return l.call(this,i,0,e,t),i}},aKC4:function(e,t,n){var i=n("iSaS"),r=n("2f56");function a(e){this._init(e)}a.prototype={_init:function(e){e=e||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=e.onData,this._onEndCallback=e.onEnd},_createTable:function(){for(var e=r.createBuffer(8,i.TABLE_LENGTH),t=0;t<i.TABLE_LENGTH;t++)e[t]=i.BASE62TABLE.charCodeAt(t);return e},_onData:function(e,t){var n=r.bufferToString_fast(e,t);this._onDataCallback?this._onDataCallback(n):this._result+=n},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var e=2,t=this._data,n=this._offset,r=i.BUFFER_MAX;if(this._dataLen-n<r&&(r=this._dataLen-n),e>r)return!1;var a,o,s,l,c,u=n-i.WINDOW_BUFFER_MAX,h=t.substring(u,n+r),d=n+e-3-u;do{if(2===e){if(o=t.charAt(n)+t.charAt(n+1),!~(s=h.indexOf(o))||s>d)break}else 3===e?o+=t.charAt(n+2):o=t.substr(n,e);if(!~(l=i.STRING_LASTINDEXOF_BUG?t.substring(u,n+e-1).lastIndexOf(o):h.lastIndexOf(o,d)))break;c=l,a=u+l;do{if(t.charCodeAt(n+e)!==t.charCodeAt(a+e))break}while(++e<r);if(s===l){e++;break}}while(++e<r);return 2!==e&&(this._index=i.WINDOW_BUFFER_MAX-c,this._length=e-1,!0)},compress:function(e){if(null==e||0===e.length)return"";var t,n=this._createTable(),a=r.createWindow(),o=r.createBuffer(8,i.COMPRESS_CHUNK_SIZE),s=0;this._result="",this._offset=a.length,this._data=a+e,this._dataLen=this._data.length,a=e=null;for(var l,c,u,h,d,f=-1,p=-1;this._offset<this._dataLen;)this._search()?(this._index<i.BUFFER_MAX?(c=this._index,u=0):u=(this._index-(c=this._index%i.BUFFER_MAX))/i.BUFFER_MAX,2===this._length?(o[s++]=n[u+i.COMPRESS_FIXED_START],o[s++]=n[c]):(o[s++]=n[u+i.COMPRESS_START],o[s++]=n[c],o[s++]=n[this._length]),this._offset+=this._length,~p&&(p=-1)):(l=this._data.charCodeAt(this._offset++))<i.LATIN_BUFFER_MAX?(l<i.UNICODE_CHAR_MAX?(c=l,u=0,f=i.LATIN_INDEX):f=(u=(l-(c=l%i.UNICODE_CHAR_MAX))/i.UNICODE_CHAR_MAX)+i.LATIN_INDEX,p===f?o[s++]=n[c]:(o[s++]=n[f-i.LATIN_INDEX_START],o[s++]=n[c],p=f)):(l<i.UNICODE_BUFFER_MAX?(c=l,u=0,f=i.UNICODE_INDEX):f=(u=(l-(c=l%i.UNICODE_BUFFER_MAX))/i.UNICODE_BUFFER_MAX)+i.UNICODE_INDEX,c<i.UNICODE_CHAR_MAX?(h=c,d=0):d=(c-(h=c%i.UNICODE_CHAR_MAX))/i.UNICODE_CHAR_MAX,p===f?(o[s++]=n[h],o[s++]=n[d]):(o[s++]=n[i.CHAR_START],o[s++]=n[f-i.TABLE_LENGTH],o[s++]=n[h],o[s++]=n[d],p=f)),s>=i.COMPRESS_CHUNK_MAX&&(this._onData(o,s),s=0);return s>0&&this._onData(o,s),this._onEnd(),t=this._result,this._result=null,null===t?"":t}},e.exports=a},bEZV:function(e,t,n){t.setExtPackers=function(e){e.addExtPacker(14,Error,[h,l]),e.addExtPacker(1,EvalError,[h,l]),e.addExtPacker(2,RangeError,[h,l]),e.addExtPacker(3,ReferenceError,[h,l]),e.addExtPacker(4,SyntaxError,[h,l]),e.addExtPacker(5,TypeError,[h,l]),e.addExtPacker(6,URIError,[h,l]),e.addExtPacker(10,RegExp,[u,l]),e.addExtPacker(11,Boolean,[c,l]),e.addExtPacker(12,String,[c,l]),e.addExtPacker(13,Date,[Number,l]),e.addExtPacker(15,Number,[c,l]),"undefined"!=typeof Uint8Array&&(e.addExtPacker(17,Int8Array,o),e.addExtPacker(18,Uint8Array,o),e.addExtPacker(19,Int16Array,o),e.addExtPacker(20,Uint16Array,o),e.addExtPacker(21,Int32Array,o),e.addExtPacker(22,Uint32Array,o),e.addExtPacker(23,Float32Array,o),"undefined"!=typeof Float64Array&&e.addExtPacker(24,Float64Array,o),"undefined"!=typeof Uint8ClampedArray&&e.addExtPacker(25,Uint8ClampedArray,o),e.addExtPacker(26,ArrayBuffer,o),e.addExtPacker(29,DataView,o)),r.hasBuffer&&e.addExtPacker(27,a,r.from)};var i,r=n("5ukv"),a=r.global,o=r.Uint8Array.from,s={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function l(e){return i||(i=n("26FE").encode),i(e)}function c(e){return e.valueOf()}function u(e){(e=RegExp.prototype.toString.call(e).split("/")).shift();var t=[e.pop()];return t.unshift(e.join("/")),t}function h(e){var t={};for(var n in s)t[n]=e[n];return t}},eHTg:function(e,t,n){var i=n("49sm");t.createCodec=s,t.install=function(e){for(var t in e)a.prototype[t]=o(a.prototype[t],e[t])},t.filter=function(e){return i(e)?function(e){return e=e.slice(),function(n){return e.reduce(t,n)};function t(e,t){return t(e)}}(e):e};var r=n("5ukv");function a(e){if(!(this instanceof a))return new a(e);this.options=e,this.init()}function o(e,t){return e&&t?function(){return e.apply(this,arguments),t.apply(this,arguments)}:e||t}function s(e){return new a(e)}a.prototype.init=function(){var e=this.options;return e&&e.uint8array&&(this.bufferish=r.Uint8Array),this},t.preset=s({preset:!0})},"htI/":function(e,t,n){t.decode=function(e,t){var n=new i(t);return n.write(e),n.read()};var i=n("NdQB").DecodeBuffer},iSaS:function(e,t){var n=t.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,i=!1,r=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(i=!0)}catch(y){}if(n)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(r=!0)}catch(y){}t.CAN_CHARCODE_APPLY=i,t.CAN_CHARCODE_APPLY_TYPED=r;var a=t.APPLY_BUFFER_SIZE=65533;t.APPLY_BUFFER_SIZE_OK=null;var o=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(o=!0),t.STRING_LASTINDEXOF_BUG=o;var s=t.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",l=t.TABLE_LENGTH=s.length,c=Math.max(l,62)-Math.min(l,62);t.BUFFER_MAX=l-1;var u=t.WINDOW_MAX=1024;t.WINDOW_BUFFER_MAX=304;var h=t.COMPRESS_CHUNK_SIZE=a;t.COMPRESS_CHUNK_MAX=h-l;var d=t.DECOMPRESS_CHUNK_SIZE=a;t.DECOMPRESS_CHUNK_MAX=d+2*u,t.LATIN_BUFFER_MAX=132;var f=t.UNICODE_CHAR_MAX=40;t.UNICODE_BUFFER_MAX=f*(f+1),t.LATIN_INDEX=l+1,t.LATIN_INDEX_START=c+20,t.UNICODE_INDEX=l+5,t.DECODE_MAX=l-c-19;var p=t.LATIN_DECODE_MAX=f+7,g=t.CHAR_START=p+1,m=t.COMPRESS_START=g+1,v=t.COMPRESS_FIXED_START=m+5;t.COMPRESS_INDEX=v+5},jZ1Y:function(e,t,n){t.FlexDecoder=r,t.FlexEncoder=a;var i=n("5ukv");function r(){if(!(this instanceof r))return new r}function a(){if(!(this instanceof a))return new a}function o(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function s(e){(this.buffers||(this.buffers=[])).push(e)}function l(e){return function(t){for(var n in e)t[n]=e[n];return t}}r.mixin=l({bufferish:i,write:function(e){var t=this.offset?i.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=t?e?this.bufferish.concat([t,e]):t:e,this.offset=0},fetch:function(){throw new Error("method not implemented: fetch()")},flush:function(){for(;this.offset<this.buffer.length;){var e,t=this.offset;try{e=this.fetch()}catch(n){if(n&&"BUFFER_SHORTAGE"!=n.message)throw n;this.offset=t;break}this.push(e)}},push:s,pull:function(){return(this.buffers||(this.buffers=[])).shift()},read:o,reserve:function(e){var t=this.offset,n=t+e;if(n>this.buffer.length)throw new Error("BUFFER_SHORTAGE");return this.offset=n,t},offset:0}),r.mixin(r.prototype),a.mixin=l({bufferish:i,write:function(){throw new Error("method not implemented: write()")},fetch:function(){var e=this.start;if(e<this.offset){var t=this.start=this.offset;return i.prototype.slice.call(this.buffer,e,t)}},flush:function(){for(;this.start<this.offset;){var e=this.fetch();e&&this.push(e)}},push:s,pull:function(){var e=this.buffers||(this.buffers=[]),t=e.length>1?this.bufferish.concat(e):e[0];return e.length=0,t},read:o,reserve:function(e){var t=0|e;if(this.buffer){var n=this.buffer.length,i=0|this.offset,r=i+t;if(r<n)return this.offset=r,i;this.flush(),e=Math.max(e,Math.min(2*n,this.maxBufferSize))}return e=Math.max(e,this.minBufferSize),this.buffer=this.bufferish.alloc(e),this.start=0,this.offset=t,0},send:function(e){var t=e.length;if(t>this.minBufferSize)this.flush(),this.push(e);else{var n=this.reserve(t);i.prototype.copy.call(e,this.buffer,n)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}),a.mixin(a.prototype)},k5sU:function(e,t,n){var i=n("kVK+"),r=n("IKIk"),a=r.Uint64BE,o=r.Int64BE,s=n("ngnX").uint8,l=n("5ukv"),c=l.global,u=l.hasBuffer&&"TYPED_ARRAY_SUPPORT"in c&&!c.TYPED_ARRAY_SUPPORT,h=l.hasBuffer&&c.prototype||{};function d(){var e=s.slice();return e[196]=f(196),e[197]=p(197),e[198]=g(198),e[199]=f(199),e[200]=p(200),e[201]=g(201),e[202]=m(202,4,h.writeFloatBE||b,!0),e[203]=m(203,8,h.writeDoubleBE||k,!0),e[204]=f(204),e[205]=p(205),e[206]=g(206),e[207]=m(207,8,v),e[208]=f(208),e[209]=p(209),e[210]=g(210),e[211]=m(211,8,y),e[217]=f(217),e[218]=p(218),e[219]=g(219),e[220]=p(220),e[221]=g(221),e[222]=p(222),e[223]=g(223),e}function f(e){return function(t,n){var i=t.reserve(2),r=t.buffer;r[i++]=e,r[i]=n}}function p(e){return function(t,n){var i=t.reserve(3),r=t.buffer;r[i++]=e,r[i++]=n>>>8,r[i]=n}}function g(e){return function(t,n){var i=t.reserve(5),r=t.buffer;r[i++]=e,r[i++]=n>>>24,r[i++]=n>>>16,r[i++]=n>>>8,r[i]=n}}function m(e,t,n,i){return function(r,a){var o=r.reserve(t+1);r.buffer[o++]=e,n.call(r.buffer,a,o,i)}}function v(e,t){new a(this,t,e)}function y(e,t){new o(this,t,e)}function b(e,t){i.write(this,e,t,!1,23,4)}function k(e,t){i.write(this,e,t,!1,52,8)}t.getWriteToken=function(e){return e&&e.uint8array?((t=d())[202]=m(202,4,b),t[203]=m(203,8,k),t):u||l.hasBuffer&&e&&e.safe?function(){var e=s.slice();return e[196]=m(196,1,c.prototype.writeUInt8),e[197]=m(197,2,c.prototype.writeUInt16BE),e[198]=m(198,4,c.prototype.writeUInt32BE),e[199]=m(199,1,c.prototype.writeUInt8),e[200]=m(200,2,c.prototype.writeUInt16BE),e[201]=m(201,4,c.prototype.writeUInt32BE),e[202]=m(202,4,c.prototype.writeFloatBE),e[203]=m(203,8,c.prototype.writeDoubleBE),e[204]=m(204,1,c.prototype.writeUInt8),e[205]=m(205,2,c.prototype.writeUInt16BE),e[206]=m(206,4,c.prototype.writeUInt32BE),e[207]=m(207,8,v),e[208]=m(208,1,c.prototype.writeInt8),e[209]=m(209,2,c.prototype.writeInt16BE),e[210]=m(210,4,c.prototype.writeInt32BE),e[211]=m(211,8,y),e[217]=m(217,1,c.prototype.writeUInt8),e[218]=m(218,2,c.prototype.writeUInt16BE),e[219]=m(219,4,c.prototype.writeUInt32BE),e[220]=m(220,2,c.prototype.writeUInt16BE),e[221]=m(221,4,c.prototype.writeUInt32BE),e[222]=m(222,2,c.prototype.writeUInt16BE),e[223]=m(223,4,c.prototype.writeUInt32BE),e}():d();var t}},"kVK+":function(e,t){t.read=function(e,t,n,i,r){var a,o,s=8*r-i-1,l=(1<<s)-1,c=l>>1,u=-7,h=n?r-1:0,d=n?-1:1,f=e[t+h];for(h+=d,a=f&(1<<-u)-1,f>>=-u,u+=s;u>0;a=256*a+e[t+h],h+=d,u-=8);for(o=a&(1<<-u)-1,a>>=-u,u+=i;u>0;o=256*o+e[t+h],h+=d,u-=8);if(0===a)a=1-c;else{if(a===l)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,i),a-=c}return(f?-1:1)*o*Math.pow(2,a-i)},t.write=function(e,t,n,i,r,a){var o,s,l,c=8*a-r-1,u=(1<<c)-1,h=u>>1,d=23===r?Math.pow(2,-24)-Math.pow(2,-77):0,f=i?0:a-1,p=i?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+h>=1?d/l:d*Math.pow(2,1-h))*l>=2&&(o++,l/=2),o+h>=u?(s=0,o=u):o+h>=1?(s=(t*l-1)*Math.pow(2,r),o+=h):(s=t*Math.pow(2,h-1)*Math.pow(2,r),o=0));r>=8;e[n+f]=255&s,f+=p,s/=256,r-=8);for(o=o<<r|s,c+=r;c>0;e[n+f]=255&o,f+=p,o/=256,c-=8);e[n+f-p]|=128*g}},l5sx:function(e,t,n){var i=n("19AM").ExtBuffer,r=n("bEZV"),a=n("yeV+"),o=n("eHTg");function s(){var e=this.options;return this.encode=function(e){var t=a.getWriteType(e);return function(e,n){var i=t[typeof n];if(!i)throw new Error('Unsupported type "'+typeof n+'": '+n);i(e,n)}}(e),e&&e.preset&&r.setExtPackers(this),this}o.install({addExtPacker:function(e,t,n){n=o.filter(n);var r=t.name;function a(t){return n&&(t=n(t)),new i(t,e)}r&&"Object"!==r?(this.extPackers||(this.extPackers={}))[r]=a:(this.extEncoderList||(this.extEncoderList=[])).unshift([t,a])},getExtPacker:function(e){var t=this.extPackers||(this.extPackers={}),n=e.constructor,i=n&&n.name&&t[n.name];if(i)return i;for(var r=this.extEncoderList||(this.extEncoderList=[]),a=r.length,o=0;o<a;o++){var s=r[o];if(n===s[0])return s[1]}},init:s}),t.preset=s.call(o.preset)},lPiR:function(e,t,n){var i;e.exports=(i=n("Ib8C"),function(e){var t=i,n=t.lib,r=n.WordArray,a=n.Hasher,o=t.algo,s=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),i=2;i<=n;i++)if(!(t%i))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var i=2,r=0;r<64;)t(i)&&(r<8&&(s[r]=n(e.pow(i,.5))),l[r]=n(e.pow(i,1/3)),r++),i++}();var c=[],u=o.SHA256=a.extend({_doReset:function(){this._hash=new r.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,i=n[0],r=n[1],a=n[2],o=n[3],s=n[4],u=n[5],h=n[6],d=n[7],f=0;f<64;f++){if(f<16)c[f]=0|e[t+f];else{var p=c[f-15],g=c[f-2];c[f]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+c[f-7]+((g<<15|g>>>17)^(g<<13|g>>>19)^g>>>10)+c[f-16]}var m=i&r^i&a^r&a,v=d+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&h)+l[f]+c[f];d=h,h=u,u=s,s=o+v|0,o=a,a=r,r=i,i=v+(((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+m)|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+a|0,n[3]=n[3]+o|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+h|0,n[7]=n[7]+d|0},_doFinalize:function(){var t=this._data,n=t.words,i=8*this._nDataBytes,r=8*t.sigBytes;return n[r>>>5]|=128<<24-r%32,n[14+(r+64>>>9<<4)]=e.floor(i/4294967296),n[15+(r+64>>>9<<4)]=i,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=a._createHelper(u),t.HmacSHA256=a._createHmacHelper(u)}(Math),i.SHA256)},nZiH:function(e,t,n){t.Encoder=a;var i=n("VOSt"),r=n("Lcv9").EncodeBuffer;function a(e){if(!(this instanceof a))return new a(e);r.call(this,e)}a.prototype=new r,i.mixin(a.prototype),a.prototype.encode=function(e){this.write(e),this.emit("data",this.read())},a.prototype.end=function(e){arguments.length&&this.encode(e),this.flush(),this.emit("end")}},nZuW:function(e,t,n){n("1mG5"),n("l5sx"),t.codec={preset:n("eHTg").preset}},ngnX:function(e,t){for(var n=t.uint8=new Array(256),i=0;i<=255;i++)n[i]=r(i);function r(e){return function(t){var n=t.reserve(1);t.buffer[n]=e}}},sZbO:function(e,t,n){var i=n("NDgz");function r(e){var t,n=new Array(256);for(t=0;t<=127;t++)n[t]=a(t);for(t=128;t<=143;t++)n[t]=s(t-128,e.map);for(t=144;t<=159;t++)n[t]=s(t-144,e.array);for(t=160;t<=191;t++)n[t]=s(t-160,e.str);for(n[192]=a(null),n[193]=null,n[194]=a(!1),n[195]=a(!0),n[196]=o(e.uint8,e.bin),n[197]=o(e.uint16,e.bin),n[198]=o(e.uint32,e.bin),n[199]=o(e.uint8,e.ext),n[200]=o(e.uint16,e.ext),n[201]=o(e.uint32,e.ext),n[202]=e.float32,n[203]=e.float64,n[204]=e.uint8,n[205]=e.uint16,n[206]=e.uint32,n[207]=e.uint64,n[208]=e.int8,n[209]=e.int16,n[210]=e.int32,n[211]=e.int64,n[212]=s(1,e.ext),n[213]=s(2,e.ext),n[214]=s(4,e.ext),n[215]=s(8,e.ext),n[216]=s(16,e.ext),n[217]=o(e.uint8,e.str),n[218]=o(e.uint16,e.str),n[219]=o(e.uint32,e.str),n[220]=o(e.uint16,e.array),n[221]=o(e.uint32,e.array),n[222]=o(e.uint16,e.map),n[223]=o(e.uint32,e.map),t=224;t<=255;t++)n[t]=a(t-256);return n}function a(e){return function(){return e}}function o(e,t){return function(n){var i=e(n);return t(n,i)}}function s(e,t){return function(n){return t(n,e)}}t.getReadToken=function(e){var t=i.getReadFormat(e);return e&&e.useraw?function(e){var t,n=r(e).slice();for(n[217]=n[196],n[218]=n[197],n[219]=n[198],t=160;t<=191;t++)n[t]=s(t-160,e.bin);return n}(t):r(t)}},t2S5:function(e,t,n){var i=n("5ukv");function r(e){return new Array(e)}(t=e.exports=r(0)).alloc=r,t.concat=i.concat,t.from=function(e){if(!i.isBuffer(e)&&i.isView(e))e=i.Uint8Array.from(e);else if(i.isArrayBuffer(e))e=new Uint8Array(e);else{if("string"==typeof e)return i.from.call(t,e);if("number"==typeof e)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(e)}},xOOu:function(e,t,n){e.exports=function e(t,n,i){function r(o,s){if(!n[o]){if(!t[o]){if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=n[o]={exports:{}};t[o][0].call(c.exports,function(e){return r(t[o][1][e]||e)},c,c.exports,e,t,n,i)}return n[o].exports}for(var a=!1,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){"use strict";var i=e("./utils"),r=e("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.encode=function(e){for(var t,n,r,o,s,l,c=[],u=0,h=e.length,d=h,f="string"!==i.getTypeOf(e);u<e.length;)d=h-u,f?(t=e[u++],n=u<h?e[u++]:0,r=u<h?e[u++]:0):(t=e.charCodeAt(u++),n=u<h?e.charCodeAt(u++):0,r=u<h?e.charCodeAt(u++):0),o=(3&t)<<4|n>>4,s=d>1?(15&n)<<2|r>>6:64,l=d>2?63&r:64,c.push(a.charAt(t>>2)+a.charAt(o)+a.charAt(s)+a.charAt(l));return c.join("")},n.decode=function(e){var t,n,i,o,s,l,c=0,u=0,h="data:";if(e.substr(0,h.length)===h)throw new Error("Invalid base64 input, it looks like a data url.");var d,f=3*(e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"")).length/4;if(e.charAt(e.length-1)===a.charAt(64)&&f--,e.charAt(e.length-2)===a.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(d=r.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)i=a.indexOf(e.charAt(c++)),t=(15&(o=a.indexOf(e.charAt(c++))))<<4|(s=a.indexOf(e.charAt(c++)))>>2,n=(3&s)<<6|(l=a.indexOf(e.charAt(c++))),d[u++]=i<<2|o>>4,64!==s&&(d[u++]=t),64!==l&&(d[u++]=n);return d}},{"./support":30,"./utils":32}],2:[function(e,t,n){"use strict";function i(e,t,n,i,r){this.compressedSize=e,this.uncompressedSize=t,this.crc32=n,this.compression=i,this.compressedContent=r}var r=e("./external"),a=e("./stream/DataWorker"),o=e("./stream/DataLengthProbe"),s=e("./stream/Crc32Probe");o=e("./stream/DataLengthProbe"),i.prototype={getContentWorker:function(){var e=new a(r.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new a(r.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},i.createWorkerFrom=function(e,t,n){return e.pipe(new s).pipe(new o("uncompressedSize")).pipe(t.compressWorker(n)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=i},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,n){"use strict";var i=e("./stream/GenericWorker");n.STORE={magic:"\0\0",compressWorker:function(e){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},n.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,n){"use strict";var i=e("./utils"),r=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==i.getTypeOf(e)?function(e,t,n,i){var a=r,o=0+n;e^=-1;for(var s=0;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}(0|t,e,e.length):function(e,t,n,i){var a=r,o=0+n;e^=-1;for(var s=0;s<o;s++)e=e>>>8^a[255&(e^t.charCodeAt(s))];return-1^e}(0|t,e,e.length):0}},{"./utils":32}],5:[function(e,t,n){"use strict";n.base64=!1,n.binary=!1,n.dir=!1,n.createFolders=!0,n.date=null,n.compression=null,n.compressionOptions=null,n.comment=null,n.unixPermissions=null,n.dosPermissions=null},{}],6:[function(e,t,n){"use strict";var i;i="undefined"!=typeof Promise?Promise:e("lie"),t.exports={Promise:i}},{lie:58}],7:[function(e,t,n){"use strict";function i(e,t){s.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}var r="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,a=e("pako"),o=e("./utils"),s=e("./stream/GenericWorker"),l=r?"uint8array":"array";n.magic="\b\0",o.inherits(i,s),i.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(o.transformTo(l,e.data),!1)},i.prototype.flush=function(){s.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},i.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this._pako=null},i.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},n.compressWorker=function(e){return new i("Deflate",e)},n.uncompressWorker=function(){return new i("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:59}],8:[function(e,t,n){"use strict";function i(e,t,n,i){a.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=n,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}var r=e("../utils"),a=e("../stream/GenericWorker"),o=e("../utf8"),s=e("../crc32"),l=e("../signature"),c=function(e,t){var n,i="";for(n=0;n<t;n++)i+=String.fromCharCode(255&e),e>>>=8;return i},u=function(e,t,n,i,a,u){var h,d,f=e.file,p=e.compression,g=u!==o.utf8encode,m=r.transformTo("string",u(f.name)),v=r.transformTo("string",o.utf8encode(f.name)),y=f.comment,b=r.transformTo("string",u(y)),k=r.transformTo("string",o.utf8encode(y)),_=v.length!==f.name.length,w=k.length!==y.length,x="",C="",E="",S=f.dir,T=f.date,O={crc32:0,compressedSize:0,uncompressedSize:0};t&&!n||(O.crc32=e.crc32,O.compressedSize=e.compressedSize,O.uncompressedSize=e.uncompressedSize);var I=0;t&&(I|=8),g||!_&&!w||(I|=2048);var M=0,A=0;S&&(M|=16),"UNIX"===a?(A=798,M|=function(e,t){var n=e;return e||(n=t?16893:33204),(65535&n)<<16}(f.unixPermissions,S)):(A=20,M|=function(e,t){return 63&(e||0)}(f.dosPermissions)),h=T.getUTCHours(),h<<=6,h|=T.getUTCMinutes(),h<<=5,h|=T.getUTCSeconds()/2,d=T.getUTCFullYear()-1980,d<<=4,d|=T.getUTCMonth()+1,d<<=5,d|=T.getUTCDate(),_&&(C=c(1,1)+c(s(m),4)+v,x+="up"+c(C.length,2)+C),w&&(E=c(1,1)+c(s(b),4)+k,x+="uc"+c(E.length,2)+E);var P="";return P+="\n\0",P+=c(I,2),P+=p.magic,P+=c(h,2),P+=c(d,2),P+=c(O.crc32,4),P+=c(O.compressedSize,4),P+=c(O.uncompressedSize,4),P+=c(m.length,2),P+=c(x.length,2),{fileRecord:l.LOCAL_FILE_HEADER+P+m+x,dirRecord:l.CENTRAL_FILE_HEADER+c(A,2)+P+c(b.length,2)+"\0\0\0\0"+c(M,4)+c(i,4)+m+x+b}},h=function(e){return l.DATA_DESCRIPTOR+c(e.crc32,4)+c(e.compressedSize,4)+c(e.uncompressedSize,4)};r.inherits(i,a),i.prototype.push=function(e){var t=e.meta.percent||0,n=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,a.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:n?(t+100*(n-i-1))/n:100}}))},i.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var n=u(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:n.fileRecord,meta:{percent:0}})}else this.accumulate=!0},i.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,n=u(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(n.dirRecord),t)this.push({data:h(e),meta:{percent:100}});else for(this.push({data:n.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},i.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var n=function(e,t,n,i,a){var o=r.transformTo("string",a(i));return l.CENTRAL_DIRECTORY_END+"\0\0\0\0"+c(e,2)+c(e,2)+c(t,4)+c(n,4)+c(o.length,2)+o}(this.dirRecords.length,this.bytesWritten-e,e,this.zipComment,this.encodeFileName);this.push({data:n,meta:{percent:100}})},i.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},i.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(e){t.error(e)}),this},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},i.prototype.error=function(e){var t=this._sources;if(!a.prototype.error.call(this,e))return!1;for(var n=0;n<t.length;n++)try{t[n].error(e)}catch(e){}return!0},i.prototype.lock=function(){a.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=i},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,n){"use strict";var i=e("../compressions"),r=e("./ZipFileWorker"),a=function(e,t){var n=e||t,r=i[n];if(!r)throw new Error(n+" is not a valid compression method !");return r};n.generateWorker=function(e,t,n){var i=new r(t.streamFiles,n,t.platform,t.encodeFileName),o=0;try{e.forEach(function(e,n){o++;var r=a(n.options.compression,t.compression),s=n.dir,l=n.date;n._compressWorker(r,n.options.compressionOptions||t.compressionOptions||{}).withStreamInfo("file",{name:e,dir:s,date:l,comment:n.comment||"",unixPermissions:n.unixPermissions,dosPermissions:n.dosPermissions}).pipe(i)}),i.entriesCount=o}catch(s){i.error(s)}return i}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,n){"use strict";function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new i;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(i.prototype=e("./object")).loadAsync=e("./load"),i.support=e("./support"),i.defaults=e("./defaults"),i.version="3.1.5",i.loadAsync=function(e,t){return(new i).loadAsync(e,t)},i.external=e("./external"),t.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,n){"use strict";function i(e){return new a.Promise(function(t,n){var i=e.decompressed.getContentWorker().pipe(new l);i.on("error",function(e){n(e)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?n(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}var r=e("./utils"),a=e("./external"),o=e("./utf8"),s=(r=e("./utils"),e("./zipEntries")),l=e("./stream/Crc32Probe"),c=e("./nodejsUtils");t.exports=function(e,t){var n=this;return t=r.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),c.isNode&&c.isStream(e)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):r.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(e){var n=new s(t);return n.load(e),n}).then(function(e){var n=[a.Promise.resolve(e)],r=e.files;if(t.checkCRC32)for(var o=0;o<r.length;o++)n.push(i(r[o]));return a.Promise.all(n)}).then(function(e){for(var i=e.shift(),r=i.files,a=0;a<r.length;a++){var o=r[a];n.file(o.fileNameStr,o.decompressed,{binary:!0,optimizedBinaryString:!0,date:o.date,dir:o.dir,comment:o.fileCommentStr.length?o.fileCommentStr:null,unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions,createFolders:t.createFolders})}return i.zipComment.length&&(n.comment=i.zipComment),n})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,n){"use strict";function i(e,t){a.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}var r=e("../utils"),a=e("../stream/GenericWorker");r.inherits(i,a),i.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(e){t.push({data:e,meta:{percent:0}})}).on("error",function(e){t.isPaused?this.generatedError=e:t.error(e)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})},i.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=i},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,n){"use strict";function i(e,t,n){r.call(this,t),this._helper=e;var i=this;e.on("data",function(e,t){i.push(e)||i._helper.pause(),n&&n(t)}).on("error",function(e){i.emit("error",e)}).on("end",function(){i.push(null)})}var r=e("readable-stream").Readable;e("../utils").inherits(i,r),i.prototype._read=function(){this._helper.resume()},t.exports=i},{"../utils":32,"readable-stream":16}],14:[function(e,t,n){"use strict";t.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(e,t){return new Buffer(e,t)},allocBuffer:function(e){return Buffer.alloc?Buffer.alloc(e):new Buffer(e)},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,n){"use strict";function i(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var r=e("./utf8"),a=e("./utils"),o=e("./stream/GenericWorker"),s=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),u=e("./zipObject"),h=e("./generate"),d=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e,t,n){var i,r,s=a.getTypeOf(t),h=a.extend(n||{},l);h.date=h.date||new Date,null!==h.compression&&(h.compression=h.compression.toUpperCase()),"string"==typeof h.unixPermissions&&(h.unixPermissions=parseInt(h.unixPermissions,8)),h.unixPermissions&&16384&h.unixPermissions&&(h.dir=!0),h.dosPermissions&&16&h.dosPermissions&&(h.dir=!0),h.dir&&(e=m(e)),h.createFolders&&(i=g(e))&&v.call(this,i,!0),n&&void 0!==n.binary||(h.binary=!("string"===s&&!1===h.binary&&!1===h.base64)),(t instanceof c&&0===t.uncompressedSize||h.dir||!t||0===t.length)&&(h.base64=!1,h.binary=!0,t="",h.compression="STORE",s="string"),r=t instanceof c||t instanceof o?t:d.isNode&&d.isStream(t)?new f(e,t):a.prepareContent(e,t,h.binary,h.optimizedBinaryString,h.base64);var p=new u(e,r,h);this.files[e]=p},g=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},v=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||p.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]},y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,n,i;for(t in this.files)this.files.hasOwnProperty(t)&&(i=this.files[t],(n=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(n,i))},filter:function(e){var t=[];return this.forEach(function(n,i){e(n,i)&&t.push(i)}),t},file:function(e,t,n){if(1===arguments.length){if(i(e)){var r=e;return this.filter(function(e,t){return!t.dir&&r.test(e)})}var a=this.files[this.root+e];return a&&!a.dir?a:null}return p.call(this,e=this.root+e,t,n),this},folder:function(e){if(!e)return this;if(i(e))return this.filter(function(t,n){return n.dir&&e.test(t)});var t=v.call(this,this.root+e),n=this.clone();return n.root=t.name,n},remove:function(e){var t=this.files[e=this.root+e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var n=this.filter(function(t,n){return n.name.slice(0,e.length)===e}),i=0;i<n.length;i++)delete this.files[n[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,n={};try{if((n=a.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:r.utf8encode})).type=n.type.toLowerCase(),n.compression=n.compression.toUpperCase(),"binarystring"===n.type&&(n.type="string"),!n.type)throw new Error("No output type specified.");a.checkSupport(n.type),"darwin"!==n.platform&&"freebsd"!==n.platform&&"linux"!==n.platform&&"sunos"!==n.platform||(n.platform="UNIX"),"win32"===n.platform&&(n.platform="DOS"),t=h.generateWorker(this,n,n.comment||this.comment||"")}catch(l){(t=new o("error")).error(l)}return new s(t,n.type||"string",n.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,n){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,n){"use strict";function i(e){r.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}var r=e("./DataReader");e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data[this.zero+e]},i.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.length-4;a>=0;--a)if(this.data[a]===t&&this.data[a+1]===n&&this.data[a+2]===i&&this.data[a+3]===r)return a-this.zero;return-1},i.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1),i=e.charCodeAt(2),r=e.charCodeAt(3),a=this.readData(4);return t===a[0]&&n===a[1]&&i===a[2]&&r===a[3]},i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],18:[function(e,t,n){"use strict";function i(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}var r=e("../utils");i.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t,n=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)n=(n<<8)+this.byteAt(t);return this.index+=e,n},readString:function(e){return r.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=i},{"../utils":32}],19:[function(e,t,n){"use strict";function i(e){r.call(this,e)}var r=e("./Uint8ArrayReader");e("../utils").inherits(i,r),i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,n){"use strict";function i(e){r.call(this,e)}var r=e("./DataReader");e("../utils").inherits(i,r),i.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},i.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},i.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},i.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./DataReader":18}],21:[function(e,t,n){"use strict";function i(e){r.call(this,e)}var r=e("./ArrayReader");e("../utils").inherits(i,r),i.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=i},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,n){"use strict";var i=e("../utils"),r=e("../support"),a=e("./ArrayReader"),o=e("./StringReader"),s=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=i.getTypeOf(e);return i.checkSupport(t),"string"!==t||r.uint8array?"nodebuffer"===t?new s(e):r.uint8array?new l(i.transformTo("uint8array",e)):new a(i.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,n){"use strict";n.LOCAL_FILE_HEADER="PK\x03\x04",n.CENTRAL_FILE_HEADER="PK\x01\x02",n.CENTRAL_DIRECTORY_END="PK\x05\x06",n.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",n.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",n.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(e,t,n){"use strict";function i(e){r.call(this,"ConvertWorker to "+e),this.destType=e}var r=e("./GenericWorker"),a=e("../utils");a.inherits(i,r),i.prototype.processChunk=function(e){this.push({data:a.transformTo(this.destType,e.data),meta:e.meta})},t.exports=i},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,n){"use strict";function i(){r.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}var r=e("./GenericWorker"),a=e("../crc32");e("../utils").inherits(i,r),i.prototype.processChunk=function(e){this.streamInfo.crc32=a(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=i},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,n){"use strict";function i(e){a.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}var r=e("../utils"),a=e("./GenericWorker");r.inherits(i,a),i.prototype.processChunk=function(e){e&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+e.data.length),a.prototype.processChunk.call(this,e)},t.exports=i},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,n){"use strict";function i(e){a.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=r.getTypeOf(e),t.isPaused||t._tickAndRepeat()},function(e){t.error(e)})}var r=e("../utils"),a=e("./GenericWorker");r.inherits(i,a),i.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},i.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,r.delay(this._tickAndRepeat,[],this)),!0)},i.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(r.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},i.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=i},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,n){"use strict";function i(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var n=0;n<this._listeners[e].length;n++)this._listeners[e][n].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(e){t.processChunk(e)}),e.on("end",function(){t.end()}),e.on("error",function(e){t.error(e)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)this.extraStreamInfo.hasOwnProperty(e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=i},{}],29:[function(e,t,n){"use strict";function i(e,t,n){switch(e){case"blob":return a.newBlob(a.transformTo("arraybuffer",t),n);case"base64":return l.encode(t);default:return a.transformTo(e,t)}}function r(e,t,n){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string"}try{this._internalType=i,this._outputType=t,this._mimeType=n,a.checkSupport(i),this._worker=e.pipe(new o(i)),e.lock()}catch(r){this._worker=new s("error"),this._worker.error(r)}}var a=e("../utils"),o=e("./ConvertWorker"),s=e("./GenericWorker"),l=e("../base64"),c=e("../support"),u=e("../external"),h=null;if(c.nodestream)try{h=e("../nodejs/NodejsStreamOutputAdapter")}catch(d){}r.prototype={accumulate:function(e){return function(e,t){return new u.Promise(function(n,r){var a=[],o=e._internalType,s=e._outputType,l=e._mimeType;e.on("data",function(e,n){a.push(e),t&&t(n)}).on("error",function(e){a=[],r(e)}).on("end",function(){try{var e=i(s,function(e,t){var n,i=0,r=null,a=0;for(n=0;n<t.length;n++)a+=t[n].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(r=new Uint8Array(a),n=0;n<t.length;n++)r.set(t[n],i),i+=t[n].length;return r;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(o,a),l);n(e)}catch(t){r(t)}a=[]}).resume()})}(this,e)},on:function(e,t){var n=this;return this._worker.on(e,"data"===e?function(e){t.call(n,e.data,e.meta)}:function(){a.delay(t,arguments,n)}),this},resume:function(){return a.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(a.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=r},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,n){"use strict";if(n.base64=!0,n.array=!0,n.string=!0,n.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,n.nodebuffer="undefined"!=typeof Buffer,n.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)n.blob=!1;else{var i=new ArrayBuffer(0);try{n.blob=0===new Blob([i],{type:"application/zip"}).size}catch(a){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);r.append(i),n.blob=0===r.getBlob("application/zip").size}catch(a){n.blob=!1}}}try{n.nodestream=!!e("readable-stream").Readable}catch(a){n.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,n){"use strict";function i(){l.call(this,"utf-8 decode"),this.leftOver=null}function r(){l.call(this,"utf-8 encode")}for(var a=e("./utils"),o=e("./support"),s=e("./nodejsUtils"),l=e("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;c[254]=c[254]=1,n.utf8encode=function(e){return o.nodebuffer?s.newBufferFrom(e,"utf-8"):function(e){var t,n,i,r,a,s=e.length,l=0;for(r=0;r<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=o.uint8array?new Uint8Array(l):new Array(l),a=0,r=0;a<l;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<s&&56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t}(e)},n.utf8decode=function(e){return o.nodebuffer?a.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,n,i,r,o=e.length,s=new Array(2*o);for(n=0,t=0;t<o;)if((i=e[t++])<128)s[n++]=i;else if((r=c[i])>4)s[n++]=65533,t+=r-1;else{for(i&=2===r?31:3===r?15:7;r>1&&t<o;)i=i<<6|63&e[t++],r--;r>1?s[n++]=65533:i<65536?s[n++]=i:(s[n++]=55296|(i-=65536)>>10&1023,s[n++]=56320|1023&i)}return s.length!==n&&(s.subarray?s=s.subarray(0,n):s.length=n),a.applyFromCharCode(s)}(e=a.transformTo(o.uint8array?"uint8array":"array",e))},a.inherits(i,l),i.prototype.processChunk=function(e){var t=a.transformTo(o.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var i=t;(t=new Uint8Array(i.length+this.leftOver.length)).set(this.leftOver,0),t.set(i,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var r=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+c[e[n]]>t?n:t}(t),s=t;r!==t.length&&(o.uint8array?(s=t.subarray(0,r),this.leftOver=t.subarray(r,t.length)):(s=t.slice(0,r),this.leftOver=t.slice(r,t.length))),this.push({data:n.utf8decode(s),meta:e.meta})},i.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:n.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},n.Utf8DecodeWorker=i,a.inherits(r,l),r.prototype.processChunk=function(e){this.push({data:n.utf8encode(e.data),meta:e.meta})},n.Utf8EncodeWorker=r},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,n){"use strict";function i(e){return a(e,l.uint8array?new Uint8Array(e.length):new Array(e.length))}function r(e){return e}function a(e,t){for(var n=0;n<e.length;++n)t[n]=255&e.charCodeAt(n);return t}function o(e){var t=65536,i=n.getTypeOf(e),r=!0;if("uint8array"===i?r=f.applyCanBeUsed.uint8array:"nodebuffer"===i&&(r=f.applyCanBeUsed.nodebuffer),r)for(;t>1;)try{return f.stringifyByChunk(e,i,t)}catch(a){t=Math.floor(t/2)}return f.stringifyByChar(e)}function s(e,t){for(var n=0;n<e.length;n++)t[n]=e[n];return t}var l=e("./support"),c=e("./base64"),u=e("./nodejsUtils"),h=e("core-js/library/fn/set-immediate"),d=e("./external");n.newBlob=function(e,t){n.checkSupport("blob");try{return new Blob([e],{type:t})}catch(i){try{var r=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return r.append(e),r.getBlob(t)}catch(i){throw new Error("Bug : can't construct the Blob.")}}};var f={stringifyByChunk:function(e,t,n){var i=[],r=0,a=e.length;if(a<=n)return String.fromCharCode.apply(null,e);for(;r<a;)i.push(String.fromCharCode.apply(null,"array"===t||"nodebuffer"===t?e.slice(r,Math.min(r+n,a)):e.subarray(r,Math.min(r+n,a)))),r+=n;return i.join("")},stringifyByChar:function(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return t},applyCanBeUsed:{uint8array:function(){try{return l.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(e){return!1}}(),nodebuffer:function(){try{return l.nodebuffer&&1===String.fromCharCode.apply(null,u.allocBuffer(1)).length}catch(e){return!1}}()}};n.applyFromCharCode=o;var p={};p.string={string:r,array:function(e){return a(e,new Array(e.length))},arraybuffer:function(e){return p.string.uint8array(e).buffer},uint8array:function(e){return a(e,new Uint8Array(e.length))},nodebuffer:function(e){return a(e,u.allocBuffer(e.length))}},p.array={string:o,array:r,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return u.newBufferFrom(e)}},p.arraybuffer={string:function(e){return o(new Uint8Array(e))},array:function(e){return s(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:r,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return u.newBufferFrom(new Uint8Array(e))}},p.uint8array={string:o,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:r,nodebuffer:function(e){return u.newBufferFrom(e)}},p.nodebuffer={string:o,array:function(e){return s(e,new Array(e.length))},arraybuffer:function(e){return p.nodebuffer.uint8array(e).buffer},uint8array:function(e){return s(e,new Uint8Array(e.length))},nodebuffer:r},n.transformTo=function(e,t){if(t||(t=""),!e)return t;n.checkSupport(e);var i=n.getTypeOf(t);return p[i][e](t)},n.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":l.nodebuffer&&u.isBuffer(e)?"nodebuffer":l.uint8array&&e instanceof Uint8Array?"uint8array":l.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},n.checkSupport=function(e){if(!l[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},n.MAX_VALUE_16BITS=65535,n.MAX_VALUE_32BITS=-1,n.pretty=function(e){var t,n,i="";for(n=0;n<(e||"").length;n++)i+="\\x"+((t=e.charCodeAt(n))<16?"0":"")+t.toString(16).toUpperCase();return i},n.delay=function(e,t,n){h(function(){e.apply(n||null,t||[])})},n.inherits=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n},n.extend=function(){var e,t,n={};for(e=0;e<arguments.length;e++)for(t in arguments[e])arguments[e].hasOwnProperty(t)&&void 0===n[t]&&(n[t]=arguments[e][t]);return n},n.prepareContent=function(e,t,r,a,o){return d.Promise.resolve(t).then(function(e){return l.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&"undefined"!=typeof FileReader?new d.Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=function(e){n(e.target.error)},i.readAsArrayBuffer(e)}):e}).then(function(t){var s=n.getTypeOf(t);return s?("arraybuffer"===s?t=n.transformTo("uint8array",t):"string"===s&&(o?t=c.decode(t):r&&!0!==a&&(t=i(t))),t):d.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,"core-js/library/fn/set-immediate":36}],33:[function(e,t,n){"use strict";function i(e){this.files=[],this.loadOptions=e}var r=e("./reader/readerFor"),a=e("./utils"),o=e("./signature"),s=e("./zipEntry"),l=(e("./utf8"),e("./support"));i.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(t)+", expected "+a.pretty(e)+")")}},isSignature:function(e,t){var n=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4)===t;return this.reader.setIndex(n),i},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.transformTo(l.uint8array?"uint8array":"array",e);this.zipComment=this.loadOptions.decodeFileName(t)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,n,i=this.zip64EndOfCentralSize-44;0<i;)e=this.reader.readInt(2),t=this.reader.readInt(4),n=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:n}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)this.reader.setIndex((t=this.files[e]).localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(e=new s({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var n=this.centralDirOffset+this.centralDirSize;this.zip64&&(n+=20,n+=12+this.zip64EndOfCentralSize);var i=t-n;if(i>0)this.isSignature(t,o.CENTRAL_FILE_HEADER)||(this.reader.zero=i);else if(i<0)throw new Error("Corrupted zip: missing "+Math.abs(i)+" bytes.")},prepareReader:function(e){this.reader=r(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=i},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utf8":31,"./utils":32,"./zipEntry":34}],34:[function(e,t,n){"use strict";function i(e,t){this.options=e,this.loadOptions=t}var r=e("./reader/readerFor"),a=e("./utils"),o=e("./compressedObject"),s=e("./crc32"),l=e("./utf8"),c=e("./compressions"),u=e("./support");i.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(e){var t,n;if(e.skip(22),this.fileNameLength=e.readInt(2),n=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(n),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough informations from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in c)if(c.hasOwnProperty(t)&&c[t].magic===e)return c[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0===e&&(this.dosPermissions=63&this.externalFileAttributes),3===e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(e){if(this.extraFields[1]){var t=r(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))}},readExtraFields:function(e){var t,n,i,r=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index<r;)t=e.readInt(2),n=e.readInt(2),i=e.readData(n),this.extraFields[t]={id:t,length:n,value:i}},handleUTF8:function(){var e=u.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=l.utf8decode(this.fileName),this.fileCommentStr=l.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var n=a.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(n)}var i=this.findExtraFieldUnicodeComment();if(null!==i)this.fileCommentStr=i;else{var r=a.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=r(e.value);return 1!==t.readInt(1)||s(this.fileName)!==t.readInt(4)?null:l.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=r(e.value);return 1!==t.readInt(1)||s(this.fileComment)!==t.readInt(4)?null:l.utf8decode(t.readData(e.length-5))}return null}},t.exports=i},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,n){"use strict";var i=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),a=e("./utf8"),o=e("./compressedObject"),s=e("./stream/GenericWorker"),l=function(e,t,n){this.name=e,this.dir=n.dir,this.date=n.date,this.comment=n.comment,this.unixPermissions=n.unixPermissions,this.dosPermissions=n.dosPermissions,this._data=t,this._dataBinary=n.binary,this.options={compression:n.compression,compressionOptions:n.compressionOptions}};l.prototype={internalStream:function(e){var t=null,n="string";try{if(!e)throw new Error("No output type specified.");var r="string"===(n=e.toLowerCase())||"text"===n;"binarystring"!==n&&"text"!==n||(n="string"),t=this._decompressWorker();var o=!this._dataBinary;o&&!r&&(t=t.pipe(new a.Utf8EncodeWorker)),!o&&r&&(t=t.pipe(new a.Utf8DecodeWorker))}catch(l){(t=new s("error")).error(l)}return new i(t,n,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof o&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var n=this._decompressWorker();return this._dataBinary||(n=n.pipe(new a.Utf8EncodeWorker)),o.createWorkerFrom(n,e,t)},_decompressWorker:function(){return this._data instanceof o?this._data.getContentWorker():this._data instanceof s?this._data:new r(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],u=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},h=0;h<c.length;h++)l.prototype[c[h]]=u;t.exports=l},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,n){e("../modules/web.immediate"),t.exports=e("../modules/_core").setImmediate},{"../modules/_core":40,"../modules/web.immediate":56}],37:[function(e,t,n){t.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},{}],38:[function(e,t,n){var i=e("./_is-object");t.exports=function(e){if(!i(e))throw TypeError(e+" is not an object!");return e}},{"./_is-object":51}],39:[function(e,t,n){var i={}.toString;t.exports=function(e){return i.call(e).slice(8,-1)}},{}],40:[function(e,t,n){var i=t.exports={version:"2.3.0"};"number"==typeof __e&&(__e=i)},{}],41:[function(e,t,n){var i=e("./_a-function");t.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},{"./_a-function":37}],42:[function(e,t,n){t.exports=!e("./_fails")(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},{"./_fails":45}],43:[function(e,t,n){var i=e("./_is-object"),r=e("./_global").document,a=i(r)&&i(r.createElement);t.exports=function(e){return a?r.createElement(e):{}}},{"./_global":46,"./_is-object":51}],44:[function(e,t,n){var i=e("./_global"),r=e("./_core"),a=e("./_ctx"),o=e("./_hide"),s="prototype",l=function e(t,n,l){var c,u,h,d=t&e.F,f=t&e.G,p=t&e.S,g=t&e.P,m=t&e.B,v=t&e.W,y=f?r:r[n]||(r[n]={}),b=y[s],k=f?i:p?i[n]:(i[n]||{})[s];for(c in f&&(l=n),l)(u=!d&&k&&void 0!==k[c])&&c in y||(h=u?k[c]:l[c],y[c]=f&&"function"!=typeof k[c]?l[c]:m&&u?a(h,i):v&&k[c]==h?function(e){var t=function(t,n,i){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,i)}return e.apply(this,arguments)};return t[s]=e[s],t}(h):g&&"function"==typeof h?a(Function.call,h):h,g&&((y.virtual||(y.virtual={}))[c]=h,t&e.R&&b&&!b[c]&&o(b,c,h)))};l.F=1,l.G=2,l.S=4,l.P=8,l.B=16,l.W=32,l.U=64,l.R=128,t.exports=l},{"./_core":40,"./_ctx":41,"./_global":46,"./_hide":47}],45:[function(e,t,n){t.exports=function(e){try{return!!e()}catch(t){return!0}}},{}],46:[function(e,t,n){var i=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},{}],47:[function(e,t,n){var i=e("./_object-dp"),r=e("./_property-desc");t.exports=e("./_descriptors")?function(e,t,n){return i.f(e,t,r(1,n))}:function(e,t,n){return e[t]=n,e}},{"./_descriptors":42,"./_object-dp":52,"./_property-desc":53}],48:[function(e,t,n){t.exports=e("./_global").document&&document.documentElement},{"./_global":46}],49:[function(e,t,n){t.exports=!e("./_descriptors")&&!e("./_fails")(function(){return 7!=Object.defineProperty(e("./_dom-create")("div"),"a",{get:function(){return 7}}).a})},{"./_descriptors":42,"./_dom-create":43,"./_fails":45}],50:[function(e,t,n){t.exports=function(e,t,n){var i=void 0===n;switch(t.length){case 0:return i?e():e.call(n);case 1:return i?e(t[0]):e.call(n,t[0]);case 2:return i?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return i?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return i?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}return e.apply(n,t)}},{}],51:[function(e,t,n){t.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},{}],52:[function(e,t,n){var i=e("./_an-object"),r=e("./_ie8-dom-define"),a=e("./_to-primitive"),o=Object.defineProperty;n.f=e("./_descriptors")?Object.defineProperty:function(e,t,n){if(i(e),t=a(t,!0),i(n),r)try{return o(e,t,n)}catch(s){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},{"./_an-object":38,"./_descriptors":42,"./_ie8-dom-define":49,"./_to-primitive":55}],53:[function(e,t,n){t.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},{}],54:[function(e,t,n){var i,r,a,o=e("./_ctx"),s=e("./_invoke"),l=e("./_html"),c=e("./_dom-create"),u=e("./_global"),h=u.process,d=u.setImmediate,f=u.clearImmediate,p=u.MessageChannel,g=0,m={},v="onreadystatechange",y=function(){var e=+this;if(m.hasOwnProperty(e)){var t=m[e];delete m[e],t()}},b=function(e){y.call(e.data)};d&&f||(d=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return m[++g]=function(){s("function"==typeof e?e:Function(e),t)},i(g),g},f=function(e){delete m[e]},"process"==e("./_cof")(h)?i=function(e){h.nextTick(o(y,e,1))}:p?(a=(r=new p).port2,r.port1.onmessage=b,i=o(a.postMessage,a,1)):u.addEventListener&&"function"==typeof postMessage&&!u.importScripts?(i=function(e){u.postMessage(e+"","*")},u.addEventListener("message",b,!1)):i=v in c("script")?function(e){l.appendChild(c("script"))[v]=function(){l.removeChild(this),y.call(e)}}:function(e){setTimeout(o(y,e,1),0)}),t.exports={set:d,clear:f}},{"./_cof":39,"./_ctx":41,"./_dom-create":43,"./_global":46,"./_html":48,"./_invoke":50}],55:[function(e,t,n){var i=e("./_is-object");t.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},{"./_is-object":51}],56:[function(e,t,n){var i=e("./_export"),r=e("./_task");i(i.G+i.B,{setImmediate:r.set,clearImmediate:r.clear})},{"./_export":44,"./_task":54}],57:[function(e,t,n){(function(e){"use strict";function n(){c=!0;for(var e,t,n=u.length;n;){for(t=u,u=[],e=-1;++e<n;)t[e]();n=u.length}c=!1}var i,r=e.MutationObserver||e.WebKitMutationObserver;if(r){var a=0,o=new r(n),s=e.document.createTextNode("");o.observe(s,{characterData:!0}),i=function(){s.data=a=++a%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){n(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(n,0)};else{var l=new e.MessageChannel;l.port1.onmessage=n,i=function(){l.port2.postMessage(0)}}var c,u=[];t.exports=function(e){1!==u.push(e)||c||i()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],58:[function(e,t,n){"use strict";function i(){}function r(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=p,this.queue=[],this.outcome=void 0,e!==i&&l(this,e)}function a(e,t,n){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function o(e,t,n){u(function(){var i;try{i=t(n)}catch(r){return h.reject(e,r)}i===e?h.reject(e,new TypeError("Cannot resolve promise with itself")):h.resolve(e,i)})}function s(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function l(e,t){function n(t){r||(r=!0,h.reject(e,t))}function i(t){r||(r=!0,h.resolve(e,t))}var r=!1,a=c(function(){t(i,n)});"error"===a.status&&n(a.value)}function c(e,t){var n={};try{n.value=e(t),n.status="success"}catch(i){n.status="error",n.value=i}return n}var u=e("immediate"),h={},d=["REJECTED"],f=["FULFILLED"],p=["PENDING"];t.exports=r,r.prototype.catch=function(e){return this.then(null,e)},r.prototype.then=function(e,t){if("function"!=typeof e&&this.state===f||"function"!=typeof t&&this.state===d)return this;var n=new this.constructor(i);return this.state!==p?o(n,this.state===f?e:t,this.outcome):this.queue.push(new a(n,e,t)),n},a.prototype.callFulfilled=function(e){h.resolve(this.promise,e)},a.prototype.otherCallFulfilled=function(e){o(this.promise,this.onFulfilled,e)},a.prototype.callRejected=function(e){h.reject(this.promise,e)},a.prototype.otherCallRejected=function(e){o(this.promise,this.onRejected,e)},h.resolve=function(e,t){var n=c(s,t);if("error"===n.status)return h.reject(e,n.value);var i=n.value;if(i)l(e,i);else{e.state=f,e.outcome=t;for(var r=-1,a=e.queue.length;++r<a;)e.queue[r].callFulfilled(t)}return e},h.reject=function(e,t){e.state=d,e.outcome=t;for(var n=-1,i=e.queue.length;++n<i;)e.queue[n].callRejected(t);return e},r.resolve=function(e){return e instanceof this?e:h.resolve(new this(i),e)},r.reject=function(e){var t=new this(i);return h.reject(t,e)},r.all=function(e){function t(e,t){n.resolve(e).then(function(e){o[t]=e,++s!==r||a||(a=!0,h.resolve(c,o))},function(e){a||(a=!0,h.reject(c,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,a=!1;if(!r)return this.resolve([]);for(var o=new Array(r),s=0,l=-1,c=new this(i);++l<r;)t(e[l],l);return c},r.race=function(e){function t(e){n.resolve(e).then(function(e){a||(a=!0,h.resolve(s,e))},function(e){a||(a=!0,h.reject(s,e))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var r=e.length,a=!1;if(!r)return this.resolve([]);for(var o=-1,s=new this(i);++o<r;)t(e[o]);return s}},{immediate:57}],59:[function(e,t,n){"use strict";var i={};(0,e("./lib/utils/common").assign)(i,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=i},{"./lib/deflate":60,"./lib/inflate":61,"./lib/utils/common":62,"./lib/zlib/constants":65}],60:[function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);this.options=o.assign({level:d,method:p,chunkSize:16384,windowBits:15,memLevel:8,strategy:f,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var n=a.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(n!==h)throw new Error(l[n]);if(t.header&&a.deflateSetHeader(this.strm,t.header),t.dictionary){var r;if(r="string"==typeof t.dictionary?s.string2buf(t.dictionary):"[object ArrayBuffer]"===u.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(n=a.deflateSetDictionary(this.strm,r))!==h)throw new Error(l[n]);this._dict_set=!0}}function r(e,t){var n=new i(t);if(n.push(e,!0),n.err)throw n.msg||l[n.err];return n.result}var a=e("./zlib/deflate"),o=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/messages"),c=e("./zlib/zstream"),u=Object.prototype.toString,h=0,d=-1,f=0,p=8;i.prototype.push=function(e,t){var n,i,r=this.strm,l=this.options.chunkSize;if(this.ended)return!1;i=t===~~t?t:!0===t?4:0,r.input="string"==typeof e?s.string2buf(e):"[object ArrayBuffer]"===u.call(e)?new Uint8Array(e):e,r.next_in=0,r.avail_in=r.input.length;do{if(0===r.avail_out&&(r.output=new o.Buf8(l),r.next_out=0,r.avail_out=l),1!==(n=a.deflate(r,i))&&n!==h)return this.onEnd(n),this.ended=!0,!1;0!==r.avail_out&&(0!==r.avail_in||4!==i&&2!==i)||this.onData("string"===this.options.to?s.buf2binstring(o.shrinkBuf(r.output,r.next_out)):o.shrinkBuf(r.output,r.next_out))}while((r.avail_in>0||0===r.avail_out)&&1!==n);return 4===i?(n=a.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===h):2!==i||(this.onEnd(h),r.avail_out=0,!0)},i.prototype.onData=function(e){this.chunks.push(e)},i.prototype.onEnd=function(e){e===h&&(this.result="string"===this.options.to?this.chunks.join(""):o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Deflate=i,n.deflate=r,n.deflateRaw=function(e,t){return(t=t||{}).raw=!0,r(e,t)},n.gzip=function(e,t){return(t=t||{}).gzip=!0,r(e,t)}},{"./utils/common":62,"./utils/strings":63,"./zlib/deflate":67,"./zlib/messages":72,"./zlib/zstream":74}],61:[function(e,t,n){"use strict";function i(e){if(!(this instanceof i))return new i(e);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var n=a.inflateInit2(this.strm,t.windowBits);if(n!==l.Z_OK)throw new Error(c[n]);this.header=new h,a.inflateGetHeader(this.strm,this.header)}function r(e,t){var n=new i(t);if(n.push(e,!0),n.err)throw n.msg||c[n.err];return n.result}var a=e("./zlib/inflate"),o=e("./utils/common"),s=e("./utils/strings"),l=e("./zlib/constants"),c=e("./zlib/messages"),u=e("./zlib/zstream"),h=e("./zlib/gzheader"),d=Object.prototype.toString;i.prototype.push=function(e,t){var n,i,r,c,u,h,f=this.strm,p=this.options.chunkSize,g=this.options.dictionary,m=!1;if(this.ended)return!1;i=t===~~t?t:!0===t?l.Z_FINISH:l.Z_NO_FLUSH,f.input="string"==typeof e?s.binstring2buf(e):"[object ArrayBuffer]"===d.call(e)?new Uint8Array(e):e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new o.Buf8(p),f.next_out=0,f.avail_out=p),(n=a.inflate(f,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&g&&(h="string"==typeof g?s.string2buf(g):"[object ArrayBuffer]"===d.call(g)?new Uint8Array(g):g,n=a.inflateSetDictionary(this.strm,h)),n===l.Z_BUF_ERROR&&!0===m&&(n=l.Z_OK,m=!1),n!==l.Z_STREAM_END&&n!==l.Z_OK)return this.onEnd(n),this.ended=!0,!1;f.next_out&&(0!==f.avail_out&&n!==l.Z_STREAM_END&&(0!==f.avail_in||i!==l.Z_FINISH&&i!==l.Z_SYNC_FLUSH)||("string"===this.options.to?(r=s.utf8border(f.output,f.next_out),c=f.next_out-r,u=s.buf2string(f.output,r),f.next_out=c,f.avail_out=p-c,c&&o.arraySet(f.output,f.output,r,c,0),this.onData(u)):this.onData(o.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(m=!0)}while((f.avail_in>0||0===f.avail_out)&&n!==l.Z_STREAM_END);return n===l.Z_STREAM_END&&(i=l.Z_FINISH),i===l.Z_FINISH?(n=a.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===l.Z_OK):i!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),f.avail_out=0,!0)},i.prototype.onData=function(e){this.chunks.push(e)},i.prototype.onEnd=function(e){e===l.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):o.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},n.Inflate=i,n.inflate=r,n.inflateRaw=function(e,t){return(t=t||{}).raw=!0,r(e,t)},n.ungzip=r},{"./utils/common":62,"./utils/strings":63,"./zlib/constants":65,"./zlib/gzheader":68,"./zlib/inflate":70,"./zlib/messages":72,"./zlib/zstream":74}],62:[function(e,t,n){"use strict";var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;n.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)n.hasOwnProperty(i)&&(e[i]=n[i])}}return e},n.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var r={arraySet:function(e,t,n,i,r){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+i),r);else for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){var t,n,i,r,a,o;for(i=0,t=0,n=e.length;t<n;t++)i+=e[t].length;for(o=new Uint8Array(i),r=0,t=0,n=e.length;t<n;t++)o.set(a=e[t],r),r+=a.length;return o}},a={arraySet:function(e,t,n,i,r){for(var a=0;a<i;a++)e[r+a]=t[n+a]},flattenChunks:function(e){return[].concat.apply([],e)}};n.setTyped=function(e){e?(n.Buf8=Uint8Array,n.Buf16=Uint16Array,n.Buf32=Int32Array,n.assign(n,r)):(n.Buf8=Array,n.Buf16=Array,n.Buf32=Array,n.assign(n,a))},n.setTyped(i)},{}],63:[function(e,t,n){"use strict";function i(e,t){if(t<65537&&(e.subarray&&o||!e.subarray&&a))return String.fromCharCode.apply(null,r.shrinkBuf(e,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}var r=e("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch(c){a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(c){o=!1}for(var s=new r.Buf8(256),l=0;l<256;l++)s[l]=l>=252?6:l>=248?5:l>=240?4:l>=224?3:l>=192?2:1;s[254]=s[254]=1,n.string2buf=function(e){var t,n,i,a,o,s=e.length,l=0;for(a=0;a<s;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),l+=n<128?1:n<2048?2:n<65536?3:4;for(t=new r.Buf8(l),o=0,a=0;o<l;a++)55296==(64512&(n=e.charCodeAt(a)))&&a+1<s&&56320==(64512&(i=e.charCodeAt(a+1)))&&(n=65536+(n-55296<<10)+(i-56320),a++),n<128?t[o++]=n:n<2048?(t[o++]=192|n>>>6,t[o++]=128|63&n):n<65536?(t[o++]=224|n>>>12,t[o++]=128|n>>>6&63,t[o++]=128|63&n):(t[o++]=240|n>>>18,t[o++]=128|n>>>12&63,t[o++]=128|n>>>6&63,t[o++]=128|63&n);return t},n.buf2binstring=function(e){return i(e,e.length)},n.binstring2buf=function(e){for(var t=new r.Buf8(e.length),n=0,i=t.length;n<i;n++)t[n]=e.charCodeAt(n);return t},n.buf2string=function(e,t){var n,r,a,o,l=t||e.length,c=new Array(2*l);for(r=0,n=0;n<l;)if((a=e[n++])<128)c[r++]=a;else if((o=s[a])>4)c[r++]=65533,n+=o-1;else{for(a&=2===o?31:3===o?15:7;o>1&&n<l;)a=a<<6|63&e[n++],o--;o>1?c[r++]=65533:a<65536?c[r++]=a:(c[r++]=55296|(a-=65536)>>10&1023,c[r++]=56320|1023&a)}return i(c,r)},n.utf8border=function(e,t){var n;for((t=t||e.length)>e.length&&(t=e.length),n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+s[e[n]]>t?n:t}},{"./common":62}],64:[function(e,t,n){"use strict";t.exports=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(r=r+t[i++]|0)|0}while(--o);r%=65521,a%=65521}return r|a<<16|0}},{}],65:[function(e,t,n){"use strict";t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],66:[function(e,t,n){"use strict";var i=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();t.exports=function(e,t,n,r){var a=i,o=r+n;e^=-1;for(var s=r;s<o;s++)e=e>>>8^a[255&(e^t[s])];return-1^e}},{}],67:[function(e,t,n){"use strict";function i(e,t){return e.msg=T[t],t}function r(e){return(e<<1)-(e>4?9:0)}function a(e){for(var t=e.length;--t>=0;)e[t]=0}function o(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(x.arraySet(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function s(e,t){C._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,o(e.strm)}function l(e,t){e.pending_buf[e.pending++]=t}function c(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function u(e,t,n,i){var r=e.avail_in;return r>i&&(r=i),0===r?0:(e.avail_in-=r,x.arraySet(t,e.input,e.next_in,r,n),1===e.state.wrap?e.adler=E(e.adler,t,r,n):2===e.state.wrap&&(e.adler=S(e.adler,t,r,n)),e.next_in+=r,e.total_in+=r,r)}function h(e,t){var n,i,r=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-G?e.strstart-(e.w_size-G):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+W,f=c[a+o-1],p=c[a+o];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+o]===p&&c[n+o-1]===f&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<d);if(i=W-(d-a),a=d-W,i>o){if(e.match_start=t,o=i,i>=s)break;f=c[a+o-1],p=c[a+o]}}}while((t=h[t&u])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead}function d(e){var t,n,i,r,a,o=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=o+(o-G)){x.arraySet(e.window,e.window,o,o,0),e.match_start-=o,e.strstart-=o,e.block_start-=o,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=o?i-o:0}while(--n);t=n=o;do{i=e.prev[--t],e.prev[t]=i>=o?i-o:0}while(--n);r+=o}if(0===e.strm.avail_in)break;if(n=u(e.strm,e.window,e.strstart+e.lookahead,r),e.lookahead+=n,e.lookahead+e.insert>=V)for(e.ins_h=e.window[a=e.strstart-e.insert],e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[a+V-1])&e.hash_mask,e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<V)););}while(e.lookahead<G&&0!==e.strm.avail_in)}function f(e,t){for(var n,i;;){if(e.lookahead<G){if(d(e),e.lookahead<G&&t===O)return q;if(0===e.lookahead)break}if(n=0,e.lookahead>=V&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-G&&(e.match_length=h(e,n)),e.match_length>=V)if(i=C._tr_tally(e,e.strstart-e.match_start,e.match_length-V),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=V){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(s(e,!1),0===e.strm.avail_out))return q}return e.insert=e.strstart<V-1?e.strstart:V-1,t===I?(s(e,!0),0===e.strm.avail_out?K:$):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?q:X}function p(e,t){for(var n,i,r;;){if(e.lookahead<G){if(d(e),e.lookahead<G&&t===O)return q;if(0===e.lookahead)break}if(n=0,e.lookahead>=V&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=V-1,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-G&&(e.match_length=h(e,n),e.match_length<=5&&(e.strategy===D||e.match_length===V&&e.strstart-e.match_start>4096)&&(e.match_length=V-1)),e.prev_length>=V&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-V,i=C._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-V),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+V-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=V-1,e.strstart++,i&&(s(e,!1),0===e.strm.avail_out))return q}else if(e.match_available){if((i=C._tr_tally(e,0,e.window[e.strstart-1]))&&s(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return q}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=C._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<V-1?e.strstart:V-1,t===I?(s(e,!0),0===e.strm.avail_out?K:$):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?q:X}function g(e,t){for(var n,i,r,a,o=e.window;;){if(e.lookahead<=W){if(d(e),e.lookahead<=W&&t===O)return q;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=V&&e.strstart>0&&(i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r]){a=e.strstart+W;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<a);e.match_length=W-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=V?(n=C._tr_tally(e,1,e.match_length-V),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(s(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===I?(s(e,!0),0===e.strm.avail_out?K:$):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?q:X}function m(e,t){for(var n;;){if(0===e.lookahead&&(d(e),0===e.lookahead)){if(t===O)return q;break}if(e.match_length=0,n=C._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(s(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===I?(s(e,!0),0===e.strm.avail_out?K:$):e.last_lit&&(s(e,!1),0===e.strm.avail_out)?q:X}function v(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}function y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=N,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new x.Buf16(2*U),this.dyn_dtree=new x.Buf16(2*(2*B+1)),this.bl_tree=new x.Buf16(2*(2*j+1)),a(this.dyn_ltree),a(this.dyn_dtree),a(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new x.Buf16(H+1),this.heap=new x.Buf16(2*L+1),a(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new x.Buf16(2*L+1),a(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function b(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=F,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Z:Y,e.adler=2===t.wrap?0:1,t.last_flush=O,C._tr_init(t),M):i(e,A)}function k(e){var t=b(e);return t===M&&function(e){e.window_size=2*e.w_size,a(e.head),e.max_lazy_match=w[e.level].max_lazy,e.good_match=w[e.level].good_length,e.nice_match=w[e.level].nice_length,e.max_chain_length=w[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=V-1,e.match_available=0,e.ins_h=0}(e.state),t}function _(e,t,n,r,a,o){if(!e)return A;var s=1;if(t===P&&(t=6),r<0?(s=0,r=-r):r>15&&(s=2,r-=16),a<1||a>z||n!==N||r<8||r>15||t<0||t>9||o<0||o>R)return i(e,A);8===r&&(r=9);var l=new y;return e.state=l,l.strm=e,l.wrap=s,l.gzhead=null,l.w_bits=r,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=a+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+V-1)/V),l.window=new x.Buf8(2*l.w_size),l.head=new x.Buf16(l.hash_size),l.prev=new x.Buf16(l.w_size),l.lit_bufsize=1<<a+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new x.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=n,k(e)}var w,x=e("../utils/common"),C=e("./trees"),E=e("./adler32"),S=e("./crc32"),T=e("./messages"),O=0,I=4,M=0,A=-2,P=-1,D=1,R=4,F=2,N=8,z=9,L=286,B=30,j=19,U=2*L+1,H=15,V=3,W=258,G=W+V+1,Z=42,Y=113,q=1,X=2,K=3,$=4;w=[new v(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(d(e),0===e.lookahead&&t===O)return q;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,s(e,!1),0===e.strm.avail_out))return q;if(e.strstart-e.block_start>=e.w_size-G&&(s(e,!1),0===e.strm.avail_out))return q}return e.insert=0,t===I?(s(e,!0),0===e.strm.avail_out?K:$):(e.strstart>e.block_start&&s(e,!1),q)}),new v(4,4,8,4,f),new v(4,5,16,8,f),new v(4,6,32,32,f),new v(4,4,16,16,p),new v(8,16,32,32,p),new v(8,16,128,128,p),new v(8,32,128,256,p),new v(32,128,258,1024,p),new v(32,258,258,4096,p)],n.deflateInit=function(e,t){return _(e,t,N,15,8,0)},n.deflateInit2=_,n.deflateReset=k,n.deflateResetKeep=b,n.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?A:(e.state.gzhead=t,M):A},n.deflate=function(e,t){var n,s,u,h;if(!e||!e.state||t>5||t<0)return e?i(e,A):A;if(s=e.state,!e.output||!e.input&&0!==e.avail_in||666===s.status&&t!==I)return i(e,0===e.avail_out?-5:A);if(s.strm=e,n=s.last_flush,s.last_flush=t,s.status===Z)if(2===s.wrap)e.adler=0,l(s,31),l(s,139),l(s,8),s.gzhead?(l(s,(s.gzhead.text?1:0)+(s.gzhead.hcrc?2:0)+(s.gzhead.extra?4:0)+(s.gzhead.name?8:0)+(s.gzhead.comment?16:0)),l(s,255&s.gzhead.time),l(s,s.gzhead.time>>8&255),l(s,s.gzhead.time>>16&255),l(s,s.gzhead.time>>24&255),l(s,9===s.level?2:s.strategy>=2||s.level<2?4:0),l(s,255&s.gzhead.os),s.gzhead.extra&&s.gzhead.extra.length&&(l(s,255&s.gzhead.extra.length),l(s,s.gzhead.extra.length>>8&255)),s.gzhead.hcrc&&(e.adler=S(e.adler,s.pending_buf,s.pending,0)),s.gzindex=0,s.status=69):(l(s,0),l(s,0),l(s,0),l(s,0),l(s,0),l(s,9===s.level?2:s.strategy>=2||s.level<2?4:0),l(s,3),s.status=Y);else{var d=N+(s.w_bits-8<<4)<<8;d|=(s.strategy>=2||s.level<2?0:s.level<6?1:6===s.level?2:3)<<6,0!==s.strstart&&(d|=32),d+=31-d%31,s.status=Y,c(s,d),0!==s.strstart&&(c(s,e.adler>>>16),c(s,65535&e.adler)),e.adler=1}if(69===s.status)if(s.gzhead.extra){for(u=s.pending;s.gzindex<(65535&s.gzhead.extra.length)&&(s.pending!==s.pending_buf_size||(s.gzhead.hcrc&&s.pending>u&&(e.adler=S(e.adler,s.pending_buf,s.pending-u,u)),o(e),u=s.pending,s.pending!==s.pending_buf_size));)l(s,255&s.gzhead.extra[s.gzindex]),s.gzindex++;s.gzhead.hcrc&&s.pending>u&&(e.adler=S(e.adler,s.pending_buf,s.pending-u,u)),s.gzindex===s.gzhead.extra.length&&(s.gzindex=0,s.status=73)}else s.status=73;if(73===s.status)if(s.gzhead.name){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(e.adler=S(e.adler,s.pending_buf,s.pending-u,u)),o(e),u=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.name.length?255&s.gzhead.name.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>u&&(e.adler=S(e.adler,s.pending_buf,s.pending-u,u)),0===h&&(s.gzindex=0,s.status=91)}else s.status=91;if(91===s.status)if(s.gzhead.comment){u=s.pending;do{if(s.pending===s.pending_buf_size&&(s.gzhead.hcrc&&s.pending>u&&(e.adler=S(e.adler,s.pending_buf,s.pending-u,u)),o(e),u=s.pending,s.pending===s.pending_buf_size)){h=1;break}h=s.gzindex<s.gzhead.comment.length?255&s.gzhead.comment.charCodeAt(s.gzindex++):0,l(s,h)}while(0!==h);s.gzhead.hcrc&&s.pending>u&&(e.adler=S(e.adler,s.pending_buf,s.pending-u,u)),0===h&&(s.status=103)}else s.status=103;if(103===s.status&&(s.gzhead.hcrc?(s.pending+2>s.pending_buf_size&&o(e),s.pending+2<=s.pending_buf_size&&(l(s,255&e.adler),l(s,e.adler>>8&255),e.adler=0,s.status=Y)):s.status=Y),0!==s.pending){if(o(e),0===e.avail_out)return s.last_flush=-1,M}else if(0===e.avail_in&&r(t)<=r(n)&&t!==I)return i(e,-5);if(666===s.status&&0!==e.avail_in)return i(e,-5);if(0!==e.avail_in||0!==s.lookahead||t!==O&&666!==s.status){var f=2===s.strategy?m(s,t):3===s.strategy?g(s,t):w[s.level].func(s,t);if(f!==K&&f!==$||(s.status=666),f===q||f===K)return 0===e.avail_out&&(s.last_flush=-1),M;if(f===X&&(1===t?C._tr_align(s):5!==t&&(C._tr_stored_block(s,0,0,!1),3===t&&(a(s.head),0===s.lookahead&&(s.strstart=0,s.block_start=0,s.insert=0))),o(e),0===e.avail_out))return s.last_flush=-1,M}return t!==I?M:s.wrap<=0?1:(2===s.wrap?(l(s,255&e.adler),l(s,e.adler>>8&255),l(s,e.adler>>16&255),l(s,e.adler>>24&255),l(s,255&e.total_in),l(s,e.total_in>>8&255),l(s,e.total_in>>16&255),l(s,e.total_in>>24&255)):(c(s,e.adler>>>16),c(s,65535&e.adler)),o(e),s.wrap>0&&(s.wrap=-s.wrap),0!==s.pending?M:1)},n.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==Z&&69!==t&&73!==t&&91!==t&&103!==t&&t!==Y&&666!==t?i(e,A):(e.state=null,t===Y?i(e,-3):M):A},n.deflateSetDictionary=function(e,t){var n,i,r,o,s,l,c,u,h=t.length;if(!e||!e.state)return A;if(2===(o=(n=e.state).wrap)||1===o&&n.status!==Z||n.lookahead)return A;for(1===o&&(e.adler=E(e.adler,t,h,0)),n.wrap=0,h>=n.w_size&&(0===o&&(a(n.head),n.strstart=0,n.block_start=0,n.insert=0),u=new x.Buf8(n.w_size),x.arraySet(u,t,h-n.w_size,n.w_size,0),t=u,h=n.w_size),s=e.avail_in,l=e.next_in,c=e.input,e.avail_in=h,e.next_in=0,e.input=t,d(n);n.lookahead>=V;){i=n.strstart,r=n.lookahead-(V-1);do{n.ins_h=(n.ins_h<<n.hash_shift^n.window[i+V-1])&n.hash_mask,n.prev[i&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=i,i++}while(--r);n.strstart=i,n.lookahead=V-1,d(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=V-1,n.match_available=0,e.next_in=l,e.input=c,e.avail_in=s,n.wrap=o,M},n.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./messages":72,"./trees":73}],68:[function(e,t,n){"use strict";t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],69:[function(e,t,n){"use strict";t.exports=function(e,t){var n,i,r,a,o,s,l,c,u,h,d,f,p,g,m,v,y,b,k,_,w,x,C,E,S;E=e.input,r=(i=e.next_in)+(e.avail_in-5),S=e.output,o=(a=e.next_out)-(t-e.avail_out),s=a+(e.avail_out-257),l=(n=e.state).dmax,c=n.wsize,u=n.whave,h=n.wnext,d=n.window,f=n.hold,p=n.bits,g=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,y=(1<<n.distbits)-1;e:do{p<15&&(f+=E[i++]<<p,f+=E[i++]<<(p+=8),p+=8),b=g[f&v];t:for(;;){if(f>>>=k=b>>>24,p-=k,0==(k=b>>>16&255))S[a++]=65535&b;else{if(!(16&k)){if(0==(64&k)){b=g[(65535&b)+(f&(1<<k)-1)];continue t}if(32&k){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}_=65535&b,(k&=15)&&(p<k&&(f+=E[i++]<<p,p+=8),_+=f&(1<<k)-1,f>>>=k,p-=k),p<15&&(f+=E[i++]<<p,f+=E[i++]<<(p+=8),p+=8),b=m[f&y];n:for(;;){if(f>>>=k=b>>>24,p-=k,!(16&(k=b>>>16&255))){if(0==(64&k)){b=m[(65535&b)+(f&(1<<k)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(w=65535&b,p<(k&=15)&&(f+=E[i++]<<p,(p+=8)<k&&(f+=E[i++]<<p,p+=8)),(w+=f&(1<<k)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(f>>>=k,p-=k,w>(k=a-o)){if((k=w-k)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(x=0,C=d,0===h){if(x+=c-k,k<_){_-=k;do{S[a++]=d[x++]}while(--k);x=a-w,C=S}}else if(h<k){if(x+=c+h-k,(k-=h)<_){_-=k;do{S[a++]=d[x++]}while(--k);if(x=0,h<_){_-=k=h;do{S[a++]=d[x++]}while(--k);x=a-w,C=S}}}else if(x+=h-k,k<_){_-=k;do{S[a++]=d[x++]}while(--k);x=a-w,C=S}for(;_>2;)S[a++]=C[x++],S[a++]=C[x++],S[a++]=C[x++],_-=3;_&&(S[a++]=C[x++],_>1&&(S[a++]=C[x++]))}else{x=a-w;do{S[a++]=S[x++],S[a++]=S[x++],S[a++]=S[x++],_-=3}while(_>2);_&&(S[a++]=S[x++],_>1&&(S[a++]=S[x++]))}break}}break}}while(i<r&&a<s);f&=(1<<(p-=(_=p>>3)<<3))-1,e.next_in=i-=_,e.next_out=a,e.avail_in=i<r?r-i+5:5-(i-r),e.avail_out=a<s?s-a+257:257-(a-s),n.hold=f,n.bits=p}},{}],70:[function(e,t,n){"use strict";function i(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function r(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new f.Buf16(320),this.work=new f.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function a(e){var t;return e&&e.state?(e.total_in=e.total_out=(t=e.state).total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=w,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new f.Buf32(C),t.distcode=t.distdyn=new f.Buf32(E),t.sane=1,t.back=-1,k):_}function o(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,a(e)):_}function s(e,t){var n,i;return e&&e.state?(i=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?_:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,o(e))):_}function l(e,t){var n,i;return e?(i=new r,e.state=i,i.window=null,(n=s(e,t))!==k&&(e.state=null),n):_}function c(e){if(S){var t;for(h=new f.Buf32(512),d=new f.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(v(y,e.lens,0,288,h,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;v(b,e.lens,0,32,d,0,e.work,{bits:5}),S=!1}e.lencode=h,e.lenbits=9,e.distcode=d,e.distbits=5}function u(e,t,n,i){var r,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new f.Buf8(a.wsize)),i>=a.wsize?(f.arraySet(a.window,t,n-a.wsize,a.wsize,0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>i&&(r=i),f.arraySet(a.window,t,n-i,r,a.wnext),(i-=r)?(f.arraySet(a.window,t,n-i,i,0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0}var h,d,f=e("../utils/common"),p=e("./adler32"),g=e("./crc32"),m=e("./inffast"),v=e("./inftrees"),y=1,b=2,k=0,_=-2,w=1,x=12,C=852,E=592,S=!0;n.inflateReset=o,n.inflateReset2=s,n.inflateResetKeep=a,n.inflateInit=function(e){return l(e,15)},n.inflateInit2=l,n.inflate=function(e,t){var n,r,a,o,s,l,h,d,C,E,S,T,O,I,M,A,P,D,R,F,N,z,L,B,j=0,U=new f.Buf8(4),H=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return _;(n=e.state).mode===x&&(n.mode=13),s=e.next_out,a=e.output,o=e.next_in,r=e.input,d=n.hold,C=n.bits,E=l=e.avail_in,S=h=e.avail_out,z=k;e:for(;;)switch(n.mode){case w:if(0===n.wrap){n.mode=13;break}for(;C<16;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(2&n.wrap&&35615===d){n.check=0,U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0),d=0,C=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&d)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&d)){e.msg="unknown compression method",n.mode=30;break}if(C-=4,N=8+(15&(d>>>=4)),0===n.wbits)n.wbits=N;else if(N>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<N,e.adler=n.check=1,n.mode=512&d?10:x,d=0,C=0;break;case 2:for(;C<16;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(n.flags=d,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=d>>8&1),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0)),d=0,C=0,n.mode=3;case 3:for(;C<32;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}n.head&&(n.head.time=d),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,U[2]=d>>>16&255,U[3]=d>>>24&255,n.check=g(n.check,U,4,0)),d=0,C=0,n.mode=4;case 4:for(;C<16;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}n.head&&(n.head.xflags=255&d,n.head.os=d>>8),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0)),d=0,C=0,n.mode=5;case 5:if(1024&n.flags){for(;C<16;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}n.length=d,n.head&&(n.head.extra_len=d),512&n.flags&&(U[0]=255&d,U[1]=d>>>8&255,n.check=g(n.check,U,2,0)),d=0,C=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((T=n.length)>l&&(T=l),T&&(n.head&&(N=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),f.arraySet(n.head.extra,r,o,T,N)),512&n.flags&&(n.check=g(n.check,r,T,o)),l-=T,o+=T,n.length-=T),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===l)break e;T=0;do{N=r[o+T++],n.head&&N&&n.length<65536&&(n.head.name+=String.fromCharCode(N))}while(N&&T<l);if(512&n.flags&&(n.check=g(n.check,r,T,o)),l-=T,o+=T,N)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===l)break e;T=0;do{N=r[o+T++],n.head&&N&&n.length<65536&&(n.head.comment+=String.fromCharCode(N))}while(N&&T<l);if(512&n.flags&&(n.check=g(n.check,r,T,o)),l-=T,o+=T,N)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;C<16;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(d!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}d=0,C=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=x;break;case 10:for(;C<32;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}e.adler=n.check=i(d),d=0,C=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=s,e.avail_out=h,e.next_in=o,e.avail_in=l,n.hold=d,n.bits=C,2;e.adler=n.check=1,n.mode=x;case x:if(5===t||6===t)break e;case 13:if(n.last){d>>>=7&C,C-=7&C,n.mode=27;break}for(;C<3;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}switch(n.last=1&d,C-=1,3&(d>>>=1)){case 0:n.mode=14;break;case 1:if(c(n),n.mode=20,6===t){d>>>=2,C-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}d>>>=2,C-=2;break;case 14:for(d>>>=7&C,C-=7&C;C<32;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if((65535&d)!=(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&d,d=0,C=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(T=n.length){if(T>l&&(T=l),T>h&&(T=h),0===T)break e;f.arraySet(a,r,o,T,s),l-=T,o+=T,h-=T,s+=T,n.length-=T;break}n.mode=x;break;case 17:for(;C<14;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(n.nlen=257+(31&d),C-=5,n.ndist=1+(31&(d>>>=5)),C-=5,n.ncode=4+(15&(d>>>=5)),d>>>=4,C-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;C<3;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}n.lens[H[n.have++]]=7&d,d>>>=3,C-=3}for(;n.have<19;)n.lens[H[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,z=v(0,n.lens,0,19,n.lencode,0,n.work,L={bits:n.lenbits}),n.lenbits=L.bits,z){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;A=(j=n.lencode[d&(1<<n.lenbits)-1])>>>16&255,P=65535&j,!((M=j>>>24)<=C);){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(P<16)d>>>=M,C-=M,n.lens[n.have++]=P;else{if(16===P){for(B=M+2;C<B;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(d>>>=M,C-=M,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}N=n.lens[n.have-1],T=3+(3&d),d>>>=2,C-=2}else if(17===P){for(B=M+3;C<B;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}C-=M,N=0,T=3+(7&(d>>>=M)),d>>>=3,C-=3}else{for(B=M+7;C<B;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}C-=M,N=0,T=11+(127&(d>>>=M)),d>>>=7,C-=7}if(n.have+T>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;T--;)n.lens[n.have++]=N}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,z=v(y,n.lens,0,n.nlen,n.lencode,0,n.work,L={bits:n.lenbits}),n.lenbits=L.bits,z){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,z=v(b,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,L={bits:n.distbits}),n.distbits=L.bits,z){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(l>=6&&h>=258){e.next_out=s,e.avail_out=h,e.next_in=o,e.avail_in=l,n.hold=d,n.bits=C,m(e,S),s=e.next_out,a=e.output,h=e.avail_out,o=e.next_in,r=e.input,l=e.avail_in,d=n.hold,C=n.bits,n.mode===x&&(n.back=-1);break}for(n.back=0;A=(j=n.lencode[d&(1<<n.lenbits)-1])>>>16&255,P=65535&j,!((M=j>>>24)<=C);){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(A&&0==(240&A)){for(D=M,R=A,F=P;A=(j=n.lencode[F+((d&(1<<D+R)-1)>>D)])>>>16&255,P=65535&j,!(D+(M=j>>>24)<=C);){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}d>>>=D,C-=D,n.back+=D}if(d>>>=M,C-=M,n.back+=M,n.length=P,0===A){n.mode=26;break}if(32&A){n.back=-1,n.mode=x;break}if(64&A){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&A,n.mode=22;case 22:if(n.extra){for(B=n.extra;C<B;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,C-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;A=(j=n.distcode[d&(1<<n.distbits)-1])>>>16&255,P=65535&j,!((M=j>>>24)<=C);){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(0==(240&A)){for(D=M,R=A,F=P;A=(j=n.distcode[F+((d&(1<<D+R)-1)>>D)])>>>16&255,P=65535&j,!(D+(M=j>>>24)<=C);){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}d>>>=D,C-=D,n.back+=D}if(d>>>=M,C-=M,n.back+=M,64&A){e.msg="invalid distance code",n.mode=30;break}n.offset=P,n.extra=15&A,n.mode=24;case 24:if(n.extra){for(B=n.extra;C<B;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,C-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===h)break e;if(n.offset>(T=S-h)){if((T=n.offset-T)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}O=T>n.wnext?n.wsize-(T-=n.wnext):n.wnext-T,T>n.length&&(T=n.length),I=n.window}else I=a,O=s-n.offset,T=n.length;T>h&&(T=h),h-=T,n.length-=T;do{a[s++]=I[O++]}while(--T);0===n.length&&(n.mode=21);break;case 26:if(0===h)break e;a[s++]=n.length,h--,n.mode=21;break;case 27:if(n.wrap){for(;C<32;){if(0===l)break e;l--,d|=r[o++]<<C,C+=8}if(e.total_out+=S-=h,n.total+=S,S&&(e.adler=n.check=n.flags?g(n.check,a,S,s-S):p(n.check,a,S,s-S)),S=h,(n.flags?d:i(d))!==n.check){e.msg="incorrect data check",n.mode=30;break}d=0,C=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;C<32;){if(0===l)break e;l--,d+=r[o++]<<C,C+=8}if(d!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}d=0,C=0}n.mode=29;case 29:z=1;break e;case 30:z=-3;break e;case 31:return-4;case 32:default:return _}return e.next_out=s,e.avail_out=h,e.next_in=o,e.avail_in=l,n.hold=d,n.bits=C,(n.wsize||S!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&u(e,e.output,e.next_out,S-e.avail_out)?(n.mode=31,-4):(S-=e.avail_out,e.total_in+=E-=e.avail_in,e.total_out+=S,n.total+=S,n.wrap&&S&&(e.adler=n.check=n.flags?g(n.check,a,S,e.next_out-S):p(n.check,a,S,e.next_out-S)),e.data_type=n.bits+(n.last?64:0)+(n.mode===x?128:0)+(20===n.mode||15===n.mode?256:0),(0===E&&0===S||4===t)&&z===k&&(z=-5),z)},n.inflateEnd=function(e){if(!e||!e.state)return _;var t=e.state;return t.window&&(t.window=null),e.state=null,k},n.inflateGetHeader=function(e,t){var n;return e&&e.state?0==(2&(n=e.state).wrap)?_:(n.head=t,t.done=!1,k):_},n.inflateSetDictionary=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?_:11===n.mode&&p(1,t,i,0)!==n.check?-3:u(e,t,i,i)?(n.mode=31,-4):(n.havedict=1,k):_},n.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":62,"./adler32":64,"./crc32":66,"./inffast":69,"./inftrees":71}],71:[function(e,t,n){"use strict";var i=e("../utils/common"),r=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],s=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,n,l,c,u,h,d){var f,p,g,m,v,y,b,k,_,w=d.bits,x=0,C=0,E=0,S=0,T=0,O=0,I=0,M=0,A=0,P=0,D=null,R=0,F=new i.Buf16(16),N=new i.Buf16(16),z=null,L=0;for(x=0;x<=15;x++)F[x]=0;for(C=0;C<l;C++)F[t[n+C]]++;for(T=w,S=15;S>=1&&0===F[S];S--);if(T>S&&(T=S),0===S)return c[u++]=20971520,c[u++]=20971520,d.bits=1,0;for(E=1;E<S&&0===F[E];E++);for(T<E&&(T=E),M=1,x=1;x<=15;x++)if(M<<=1,(M-=F[x])<0)return-1;if(M>0&&(0===e||1!==S))return-1;for(N[1]=0,x=1;x<15;x++)N[x+1]=N[x]+F[x];for(C=0;C<l;C++)0!==t[n+C]&&(h[N[t[n+C]]++]=C);if(0===e?(D=z=h,y=19):1===e?(D=r,R-=257,z=a,L-=257,y=256):(D=o,z=s,y=-1),P=0,C=0,x=E,v=u,O=T,I=0,g=-1,m=(A=1<<T)-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){b=x-I,h[C]<y?(k=0,_=h[C]):h[C]>y?(k=z[L+h[C]],_=D[R+h[C]]):(k=96,_=0),f=1<<x-I,E=p=1<<O;do{c[v+(P>>I)+(p-=f)]=b<<24|k<<16|_|0}while(0!==p);for(f=1<<x-1;P&f;)f>>=1;if(0!==f?(P&=f-1,P+=f):P=0,C++,0==--F[x]){if(x===S)break;x=t[n+h[C]]}if(x>T&&(P&m)!==g){for(0===I&&(I=T),v+=E,M=1<<(O=x-I);O+I<S&&!((M-=F[O+I])<=0);)O++,M<<=1;if(A+=1<<O,1===e&&A>852||2===e&&A>592)return 1;c[g=P&m]=T<<24|O<<16|v-u|0}}return 0!==P&&(c[v+P]=x-I<<24|64<<16|0),d.bits=T,0}},{"../utils/common":62}],72:[function(e,t,n){"use strict";t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],73:[function(e,t,n){"use strict";function i(e){for(var t=e.length;--t>=0;)e[t]=0}function r(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function a(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function o(e){return e<256?j[e]:j[256+(e>>>7)]}function s(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function l(e,t,n){e.bi_valid>I-n?(e.bi_buf|=t<<e.bi_valid&65535,s(e,e.bi_buf),e.bi_buf=t>>I-e.bi_valid,e.bi_valid+=n-I):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function c(e,t,n){l(e,n[2*t],n[2*t+1])}function u(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function h(e,t,n){var i,r,a=new Array(O+1),o=0;for(i=1;i<=O;i++)a[i]=o=o+n[i-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=u(a[s]++,s))}}function d(e){var t;for(t=0;t<C;t++)e.dyn_ltree[2*t]=0;for(t=0;t<E;t++)e.dyn_dtree[2*t]=0;for(t=0;t<S;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*M]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function f(e){e.bi_valid>8?s(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function p(e,t,n,i){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[n]}function g(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&p(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!p(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i}function m(e,t,n){var i,r,a,s,u=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*u]<<8|e.pending_buf[e.d_buf+2*u+1],r=e.pending_buf[e.l_buf+u],u++,0===i?c(e,r,t):(c(e,(a=U[r])+x+1,t),0!==(s=R[a])&&l(e,r-=H[a],s),c(e,a=o(--i),n),0!==(s=F[a])&&l(e,i-=V[a],s))}while(u<e.last_lit);c(e,M,t)}function v(e,t){var n,i,r,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=T,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=o[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)g(e,a,n);r=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],g(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,a[2*r]=a[2*n]+a[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,a[2*n+1]=a[2*i+1]=r,e.heap[1]=r++,g(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,a,o,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(a=0;a<=O;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<T;n++)(a=l[2*l[2*(i=e.heap[n])+1]+1]+1)>p&&(a=p,g++),l[2*i+1]=a,i>c||(e.bl_count[a]++,o=0,i>=f&&(o=d[i-f]),e.opt_len+=(s=l[2*i])*(a+o),h&&(e.static_len+=s*(u[2*i+1]+o)));if(0!==g){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,g-=2}while(g>0);for(a=p;0!==a;a--)for(i=e.bl_count[a];0!==i;)(r=e.heap[--n])>c||(l[2*r+1]!==a&&(e.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),i--)}}(e,t),h(a,c,e.bl_count)}function y(e,t,n){var i,r,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++s<l&&r===o||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[2*A]++):s<=10?e.bl_tree[2*P]++:e.bl_tree[2*D]++,s=0,a=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))}function b(e,t,n){var i,r,a=-1,o=t[1],s=0,u=7,h=4;for(0===o&&(u=138,h=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++s<u&&r===o)){if(s<h)do{c(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==a&&(c(e,r,e.bl_tree),s--),c(e,A,e.bl_tree),l(e,s-3,2)):s<=10?(c(e,P,e.bl_tree),l(e,s-3,3)):(c(e,D,e.bl_tree),l(e,s-11,7));s=0,a=r,0===o?(u=138,h=3):r===o?(u=6,h=3):(u=7,h=4)}}function k(e,t,n,i){l(e,(w<<1)+(i?1:0),3),function(e,t,n,i){f(e),s(e,n),s(e,~n),_.arraySet(e.pending_buf,e.window,t,n,e.pending),e.pending+=n}(e,t,n)}var _=e("../utils/common"),w=0,x=256,C=x+1+29,E=30,S=19,T=2*C+1,O=15,I=16,M=256,A=16,P=17,D=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],F=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],L=new Array(2*(C+2));i(L);var B=new Array(2*E);i(B);var j=new Array(512);i(j);var U=new Array(256);i(U);var H=new Array(29);i(H);var V=new Array(E);i(V);var W,G,Z,Y=!1;n._tr_init=function(e){Y||(function(){var e,t,n,i,a,o=new Array(O+1);for(n=0,i=0;i<28;i++)for(H[i]=n,e=0;e<1<<R[i];e++)U[n++]=i;for(U[n-1]=i,a=0,i=0;i<16;i++)for(V[i]=a,e=0;e<1<<F[i];e++)j[a++]=i;for(a>>=7;i<E;i++)for(V[i]=a<<7,e=0;e<1<<F[i]-7;e++)j[256+a++]=i;for(t=0;t<=O;t++)o[t]=0;for(e=0;e<=143;)L[2*e+1]=8,e++,o[8]++;for(;e<=255;)L[2*e+1]=9,e++,o[9]++;for(;e<=279;)L[2*e+1]=7,e++,o[7]++;for(;e<=287;)L[2*e+1]=8,e++,o[8]++;for(h(L,C+1,o),e=0;e<E;e++)B[2*e+1]=5,B[2*e]=u(e,5);W=new r(L,R,x+1,C,O),G=new r(B,F,0,E,O),Z=new r(new Array(0),N,0,S,7)}(),Y=!0),e.l_desc=new a(e.dyn_ltree,W),e.d_desc=new a(e.dyn_dtree,G),e.bl_desc=new a(e.bl_tree,Z),e.bi_buf=0,e.bi_valid=0,d(e)},n._tr_stored_block=k,n._tr_flush_block=function(e,t,n,i){var r,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<x;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),v(e,e.l_desc),v(e,e.d_desc),o=function(e){var t;for(y(e,e.dyn_ltree,e.l_desc.max_code),y(e,e.dyn_dtree,e.d_desc.max_code),v(e,e.bl_desc),t=S-1;t>=3&&0===e.bl_tree[2*z[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),(a=e.static_len+3+7>>>3)<=(r=e.opt_len+3+7>>>3)&&(r=a)):r=a=n+5,n+4<=r&&-1!==t?k(e,t,n,i):4===e.strategy||a===r?(l(e,2+(i?1:0),3),m(e,L,B)):(l(e,4+(i?1:0),3),function(e,t,n,i){var r;for(l(e,t-257,5),l(e,n-1,5),l(e,i-4,4),r=0;r<i;r++)l(e,e.bl_tree[2*z[r]+1],3);b(e,e.dyn_ltree,t-1),b(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),m(e,e.dyn_ltree,e.dyn_dtree)),d(e),i&&f(e)},n._tr_tally=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(U[n]+x+1)]++,e.dyn_dtree[2*o(t)]++),e.last_lit===e.lit_bufsize-1},n._tr_align=function(e){l(e,2,3),c(e,M,L),function(e){16===e.bi_valid?(s(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)}},{"../utils/common":62}],74:[function(e,t,n){"use strict";t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}]},{},[10])(10)},yLV6:function(e,t,n){var i;!function(r,a,o,s){"use strict";var l,c=["","webkit","Moz","MS","ms","o"],u=a.createElement("div"),h=Math.round,d=Math.abs,f=Date.now;function p(e,t,n){return setTimeout(_(e,n),t)}function g(e,t,n){return!!Array.isArray(e)&&(m(e,n[t],n),!0)}function m(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(void 0!==e.length)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function v(e,t,n){var i="DEPRECATED METHOD: "+t+"\n"+n+" AT \n";return function(){var t=new Error("get-stack-trace"),n=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",a=r.console&&(r.console.warn||r.console.log);return a&&a.call(r.console,i,n),e.apply(this,arguments)}}l="function"!=typeof Object.assign?function(e){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var r in i)i.hasOwnProperty(r)&&(t[r]=i[r])}return t}:Object.assign;var y=v(function(e,t,n){for(var i=Object.keys(t),r=0;r<i.length;)(!n||n&&void 0===e[i[r]])&&(e[i[r]]=t[i[r]]),r++;return e},"extend","Use `assign`."),b=v(function(e,t){return y(e,t,!0)},"merge","Use `assign`.");function k(e,t,n){var i,r=t.prototype;(i=e.prototype=Object.create(r)).constructor=e,i._super=r,n&&l(i,n)}function _(e,t){return function(){return e.apply(t,arguments)}}function w(e,t){return"function"==typeof e?e.apply(t&&t[0]||void 0,t):e}function x(e,t){return void 0===e?t:e}function C(e,t,n){m(O(t),function(t){e.addEventListener(t,n,!1)})}function E(e,t,n){m(O(t),function(t){e.removeEventListener(t,n,!1)})}function S(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function T(e,t){return e.indexOf(t)>-1}function O(e){return e.trim().split(/\s+/g)}function I(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function M(e){return Array.prototype.slice.call(e,0)}function A(e,t,n){for(var i=[],r=[],a=0;a<e.length;){var o=t?e[a][t]:e[a];I(r,o)<0&&i.push(e[a]),r[a]=o,a++}return n&&(i=t?i.sort(function(e,n){return e[t]>n[t]}):i.sort()),i}function P(e,t){for(var n,i,r=t[0].toUpperCase()+t.slice(1),a=0;a<c.length;){if((i=(n=c[a])?n+r:t)in e)return i;a++}}var D=1;function R(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||r}var F="ontouchstart"in r,N=void 0!==P(r,"PointerEvent"),z=F&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),L=["x","y"],B=["clientX","clientY"];function j(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){w(e.options.enable,[e])&&n.handler(t)},this.init()}function U(e,t,n){var i=n.pointers.length,r=n.changedPointers.length,a=1&t&&i-r==0,o=12&t&&i-r==0;n.isFirst=!!a,n.isFinal=!!o,a&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,r=i.length;n.firstInput||(n.firstInput=H(t)),r>1&&!n.firstMultiple?n.firstMultiple=H(t):1===r&&(n.firstMultiple=!1);var a=n.firstInput,o=n.firstMultiple,s=o?o.center:a.center,l=t.center=V(i);t.timeStamp=f(),t.deltaTime=t.timeStamp-a.timeStamp,t.angle=Y(s,l),t.distance=Z(s,l),function(e,t){var n=t.center,i=e.offsetDelta||{},r=e.prevDelta||{},a=e.prevInput||{};1!==t.eventType&&4!==a.eventType||(r=e.prevDelta={x:a.deltaX||0,y:a.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=r.x+(n.x-i.x),t.deltaY=r.y+(n.y-i.y)}(n,t),t.offsetDirection=G(t.deltaX,t.deltaY);var c,u,h=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=h.x,t.overallVelocityY=h.y,t.overallVelocity=d(h.x)>d(h.y)?h.x:h.y,t.scale=o?(c=o.pointers,Z((u=i)[0],u[1],B)/Z(c[0],c[1],B)):1,t.rotation=o?function(e,t){return Y(t[1],t[0],B)+Y(e[1],e[0],B)}(o.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,r,a,o=e.lastInterval||t,s=t.timeStamp-o.timeStamp;if(8!=t.eventType&&(s>25||void 0===o.velocity)){var l=t.deltaX-o.deltaX,c=t.deltaY-o.deltaY,u=W(s,l,c);i=u.x,r=u.y,n=d(u.x)>d(u.y)?u.x:u.y,a=G(l,c),e.lastInterval=t}else n=o.velocity,i=o.velocityX,r=o.velocityY,a=o.direction;t.velocity=n,t.velocityX=i,t.velocityY=r,t.direction=a}(n,t);var p=e.element;S(t.srcEvent.target,p)&&(p=t.srcEvent.target),t.target=p}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function H(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:h(e.pointers[n].clientX),clientY:h(e.pointers[n].clientY)},n++;return{timeStamp:f(),pointers:t,center:V(t),deltaX:e.deltaX,deltaY:e.deltaY}}function V(e){var t=e.length;if(1===t)return{x:h(e[0].clientX),y:h(e[0].clientY)};for(var n=0,i=0,r=0;r<t;)n+=e[r].clientX,i+=e[r].clientY,r++;return{x:h(n/t),y:h(i/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function G(e,t){return e===t?1:d(e)>=d(t)?e<0?2:4:t<0?8:16}function Z(e,t,n){n||(n=L);var i=t[n[0]]-e[n[0]],r=t[n[1]]-e[n[1]];return Math.sqrt(i*i+r*r)}function Y(e,t,n){return n||(n=L),180*Math.atan2(t[n[1]]-e[n[1]],t[n[0]]-e[n[0]])/Math.PI}j.prototype={handler:function(){},init:function(){this.evEl&&C(this.element,this.evEl,this.domHandler),this.evTarget&&C(this.target,this.evTarget,this.domHandler),this.evWin&&C(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(R(this.element),this.evWin,this.domHandler)}};var q={mousedown:1,mousemove:2,mouseup:4};function X(){this.evEl="mousedown",this.evWin="mousemove mouseup",this.pressed=!1,j.apply(this,arguments)}k(X,j,{handler:function(e){var t=q[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:"mouse",srcEvent:e}))}});var K={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},$={2:"touch",3:"pen",4:"mouse",5:"kinect"},Q="pointerdown",J="pointermove pointerup pointercancel";function ee(){this.evEl=Q,this.evWin=J,j.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}r.MSPointerEvent&&!r.PointerEvent&&(Q="MSPointerDown",J="MSPointerMove MSPointerUp MSPointerCancel"),k(ee,j,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),r=K[i],a=$[e.pointerType]||e.pointerType,o="touch"==a,s=I(t,e.pointerId,"pointerId");1&r&&(0===e.button||o)?s<0&&(t.push(e),s=t.length-1):12&r&&(n=!0),s<0||(t[s]=e,this.callback(this.manager,r,{pointers:t,changedPointers:[e],pointerType:a,srcEvent:e}),n&&t.splice(s,1))}});var te={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ne(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,j.apply(this,arguments)}function ie(e,t){var n=M(e.touches),i=M(e.changedTouches);return 12&t&&(n=A(n.concat(i),"identifier",!0)),[n,i]}k(ne,j,{handler:function(e){var t=te[e.type];if(1===t&&(this.started=!0),this.started){var n=ie.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}});var re={touchstart:1,touchmove:2,touchend:4,touchcancel:8};function ae(){this.evTarget="touchstart touchmove touchend touchcancel",this.targetIds={},j.apply(this,arguments)}function oe(e,t){var n=M(e.touches),i=this.targetIds;if(3&t&&1===n.length)return i[n[0].identifier]=!0,[n,n];var r,a,o=M(e.changedTouches),s=[],l=this.target;if(a=n.filter(function(e){return S(e.target,l)}),1===t)for(r=0;r<a.length;)i[a[r].identifier]=!0,r++;for(r=0;r<o.length;)i[o[r].identifier]&&s.push(o[r]),12&t&&delete i[o[r].identifier],r++;return s.length?[A(a.concat(s),"identifier",!0),s]:void 0}function se(){j.apply(this,arguments);var e=_(this.handler,this);this.touch=new ae(this.manager,e),this.mouse=new X(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function le(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,ce.call(this,t)):12&e&&ce.call(this,t)}function ce(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout(function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)},2500)}}function ue(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var r=this.lastTouches[i],a=Math.abs(t-r.x),o=Math.abs(n-r.y);if(a<=25&&o<=25)return!0}return!1}k(ae,j,{handler:function(e){var t=re[e.type],n=oe.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:"touch",srcEvent:e})}}),k(se,j,{handler:function(e,t,n){var i="mouse"==n.pointerType;if(!(i&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if("touch"==n.pointerType)le.call(this,t,n);else if(i&&ue.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var he=P(u.style,"touchAction"),de=void 0!==he,fe=function(){if(!de)return!1;var e={},t=r.CSS&&r.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!t||r.CSS.supports("touch-action",n)}),e}();function pe(e,t){this.manager=e,this.set(t)}function ge(e){this.options=l({},this.defaults,e||{}),this.id=D++,this.manager=null,this.options.enable=x(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function me(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function ve(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ye(e,t){var n=t.manager;return n?n.get(e):e}function be(){ge.apply(this,arguments)}function ke(){be.apply(this,arguments),this.pX=null,this.pY=null}function _e(){be.apply(this,arguments)}function we(){ge.apply(this,arguments),this._timer=null,this._input=null}function xe(){be.apply(this,arguments)}function Ce(){be.apply(this,arguments)}function Ee(){ge.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Se(e,t){return(t=t||{}).recognizers=x(t.recognizers,Se.defaults.preset),new Te(e,t)}function Te(e,t){this.options=l({},Se.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(N?ee:z?ae:F?se:X))(this,U),this.touchAction=new pe(this,this.options.touchAction),Oe(this,!0),m(this.options.recognizers,function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])},this)}function Oe(e,t){var n,i=e.element;i.style&&(m(e.options.cssProps,function(r,a){n=P(i.style,a),t?(e.oldCssProps[n]=i.style[n],i.style[n]=r):i.style[n]=e.oldCssProps[n]||""}),t||(e.oldCssProps={}))}pe.prototype={set:function(e){"compute"==e&&(e=this.compute()),de&&this.manager.element.style&&fe[e]&&(this.manager.element.style[he]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return m(this.manager.recognizers,function(t){w(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))}),function(e){if(T(e,"none"))return"none";var t=T(e,"pan-x"),n=T(e,"pan-y");return t&&n?"none":t||n?t?"pan-x":"pan-y":T(e,"manipulation")?"manipulation":"auto"}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,r=T(i,"none")&&!fe.none,a=T(i,"pan-y")&&!fe["pan-y"],o=T(i,"pan-x")&&!fe["pan-x"];if(r&&1===e.pointers.length&&e.distance<2&&e.deltaTime<250)return;if(!o||!a)return r||a&&6&n||o&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}},ge.prototype={defaults:{},set:function(e){return l(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(g(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ye(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return g(e,"dropRecognizeWith",this)||(e=ye(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(g(e,"requireFailure",this))return this;var t=this.requireFail;return-1===I(t,e=ye(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(g(e,"dropRequireFailure",this))return this;e=ye(e,this);var t=I(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<8&&i(t.options.event+me(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=8&&i(t.options.event+me(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=32},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=l({},e);if(!w(this.options.enable,[this,t]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},k(be,ge,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=6&t,r=this.attrTest(e);return i&&(8&n||!r)?16|t:i||r?4&n?8|t:2&t?4|t:2:32}}),k(ke,be,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push("pan-y"),24&e&&t.push("pan-x"),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,r=e.direction,a=e.deltaX,o=e.deltaY;return r&t.direction||(6&t.direction?(r=0===a?1:a<0?2:4,n=a!=this.pX,i=Math.abs(e.deltaX)):(r=0===o?1:o<0?8:16,n=o!=this.pY,i=Math.abs(e.deltaY))),e.direction=r,n&&i>t.threshold&&r&t.direction},attrTest:function(e){return be.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=ve(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),k(_e,be,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){1!==e.scale&&(e.additionalEvent=this.options.event+(e.scale<1?"in":"out")),this._super.emit.call(this,e)}}),k(we,ge,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime>t.time;if(this._input=e,!i||!n||12&e.eventType&&!r)this.reset();else if(1&e.eventType)this.reset(),this._timer=p(function(){this.state=8,this.tryEmit()},t.time,this);else if(4&e.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=f(),this.manager.emit(this.options.event,this._input)))}}),k(xe,be,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return["none"]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),k(Ce,be,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return ke.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&d(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=ve(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),k(Ee,ge,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return["manipulation"]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,r=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(i&&r&&n){if(4!=e.eventType)return this.failTimeout();var a=!this.pTime||e.timeStamp-this.pTime<t.interval,o=!this.pCenter||Z(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,o&&a?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=p(function(){this.state=8,this.tryEmit()},t.interval,this),2):8}return 32},failTimeout:function(){return this._timer=p(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Se.VERSION="2.0.7",Se.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[xe,{enable:!1}],[_e,{enable:!1},["rotate"]],[Ce,{direction:6}],[ke,{direction:6},["swipe"]],[Ee],[Ee,{event:"doubletap",taps:2},["tap"]],[we]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Te.prototype={set:function(e){return l(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,r=t.curRecognizer;(!r||r&&8&r.state)&&(r=t.curRecognizer=null);for(var a=0;a<i.length;)n=i[a],2===t.stopped||r&&n!=r&&!n.canRecognizeWith(r)?n.reset():n.recognize(e),!r&&14&n.state&&(r=t.curRecognizer=n),a++}},get:function(e){if(e instanceof ge)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(g(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(g(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=I(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(void 0!==e&&void 0!==t){var n=this.handlers;return m(O(e),function(e){n[e]=n[e]||[],n[e].push(t)}),this}},off:function(e,t){if(void 0!==e){var n=this.handlers;return m(O(e),function(e){t?n[e]&&n[e].splice(I(n[e],t),1):delete n[e]}),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=a.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var i=0;i<n.length;)n[i](t),i++}},destroy:function(){this.element&&Oe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},l(Se,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:Te,Input:j,TouchAction:pe,TouchInput:ae,MouseInput:X,PointerEventInput:ee,TouchMouseInput:se,SingleTouchInput:ne,Recognizer:ge,AttrRecognizer:be,Tap:Ee,Pan:ke,Swipe:Ce,Pinch:_e,Rotate:xe,Press:we,on:C,off:E,each:m,merge:b,extend:y,assign:l,inherit:k,bindFn:_,prefixed:P}),(void 0!==r?r:"undefined"!=typeof self?self:{}).Hammer=Se,void 0===(i=(function(){return Se}).call(t,n,t,e))||(e.exports=i)}(window,document)},"yeV+":function(e,t,n){var i=n("49sm"),r=n("IKIk"),a=r.Uint64BE,o=r.Int64BE,s=n("5ukv"),l=n("W3Yc"),c=n("k5sU"),u=n("ngnX").uint8,h=n("19AM").ExtBuffer,d="undefined"!=typeof Uint8Array,f="undefined"!=typeof Map,p=[];p[1]=212,p[2]=213,p[4]=214,p[8]=215,p[16]=216,t.getWriteType=function(e){var t,n=c.getWriteToken(e),r=e&&e.useraw,g=d&&e&&e.binarraybuffer,m=g?s.isArrayBuffer:s.isBuffer,v=g?function(e,t){_(e,new Uint8Array(t))}:_,y=f&&e&&e.usemap?function(e,t){if(!(t instanceof Map))return w(e,t);var i=t.size;n[i<16?128+i:i<=65535?222:223](e,i);var r=e.codec.encode;t.forEach(function(t,n,i){r(e,n),r(e,t)})}:w;return{boolean:function(e,t){n[t?195:194](e,t)},function:k,number:function(e,t){var i=0|t;t===i?n[-32<=i&&i<=127?255&i:0<=i?i<=255?204:i<=65535?205:206:-128<=i?208:-32768<=i?209:210](e,i):n[203](e,t)},object:r?function(e,t){if(m(t))return function(e,t){var i=t.length;n[i<32?160+i:i<=65535?218:219](e,i),e.send(t)}(e,t);b(e,t)}:b,string:(t=r?function(e){return e<32?1:e<=65535?3:5}:function(e){return e<32?1:e<=255?2:e<=65535?3:5},function(e,i){var r=i.length;e.offset=e.reserve(5+3*r);var a=e.buffer,o=t(r),s=e.offset+o;r=l.write.call(a,i,s);var c=t(r);o!==c&&l.copy.call(a,a,s+c-o,s,s+r),n[1===c?160+r:c<=3?215+c:219](e,r),e.offset+=r}),symbol:k,undefined:k};function b(e,t){if(null===t)return k(e,t);if(m(t))return v(e,t);if(i(t))return function(e,t){var i=t.length;n[i<16?144+i:i<=65535?220:221](e,i);for(var r=e.codec.encode,a=0;a<i;a++)r(e,t[a])}(e,t);if(a.isUint64BE(t))return function(e,t){n[207](e,t.toArray())}(e,t);if(o.isInt64BE(t))return function(e,t){n[211](e,t.toArray())}(e,t);var r=e.codec.getExtPacker(t);if(r&&(t=r(t)),t instanceof h)return function(e,t){var i=t.buffer,r=i.length;n[p[r]||(r<255?199:r<=65535?200:201)](e,r),u[t.type](e),e.send(i)}(e,t);y(e,t)}function k(e,t){n[192](e,t)}function _(e,t){var i=t.length;n[i<255?196:i<=65535?197:198](e,i),e.send(t)}function w(e,t){var i=Object.keys(t),r=i.length;n[r<16?128+r:r<=65535?222:223](e,r);var a=e.codec.encode;i.forEach(function(n){a(e,n),a(e,t[n])})}}},zTos:function(e,t){function n(e){return e&&e.isBuffer&&e}e.exports=n("undefined"!=typeof Buffer&&Buffer)||n(this.Buffer)||n("undefined"!=typeof window&&window.Buffer)||this.Buffer},zUnb:function(s,d,p){"use strict";function m(e){return"function"==typeof e}p.r(d);var b=!1,_={Promise:void 0,set useDeprecatedSynchronousErrorHandling(e){if(e){var t=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+t.stack)}else b&&console.log("RxJS: Back to a better error behavior. Thank you. <3");b=e},get useDeprecatedSynchronousErrorHandling(){return b}};function w(e){setTimeout(function(){throw e},0)}var x={closed:!0,next:function(e){},error:function(e){if(_.useDeprecatedSynchronousErrorHandling)throw e;w(e)},complete:function(){}},C=Array.isArray||function(e){return e&&"number"==typeof e.length};function E(e){return null!==e&&"object"==typeof e}var S,T=function(){function e(e){return Error.call(this),this.message=e?"".concat(e.length," errors occurred during unsubscription:\n").concat(e.map(function(e,t){return"".concat(t+1,") ").concat(e.toString())}).join("\n  ")):"",this.name="UnsubscriptionError",this.errors=e,this}return e.prototype=Object.create(Error.prototype),e}(),O=((S=function(){function e(t){y(this,e),this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return k(e,[{key:"unsubscribe",value:function(){var t;if(!this.closed){var n=this._parentOrParents,i=this._ctorUnsubscribe,r=this._unsubscribe,a=this._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof e)n.remove(this);else if(null!==n)for(var o=0;o<n.length;++o)n[o].remove(this);if(m(r)){i&&(this._unsubscribe=void 0);try{r.call(this)}catch(u){t=u instanceof T?I(u.errors):[u]}}if(C(a))for(var s=-1,l=a.length;++s<l;){var c=a[s];if(E(c))try{c.unsubscribe()}catch(u){t=t||[],u instanceof T?t=t.concat(I(u.errors)):t.push(u)}}if(t)throw new T(t)}}},{key:"add",value:function(t){var n=t;if(!t)return e.EMPTY;switch(typeof t){case"function":n=new e(t);case"object":if(n===this||n.closed||"function"!=typeof n.unsubscribe)return n;if(this.closed)return n.unsubscribe(),n;if(!(n instanceof e)){var i=n;(n=new e)._subscriptions=[i]}break;default:throw new Error("unrecognized teardown "+t+" added to Subscription.")}var r=n._parentOrParents;if(null===r)n._parentOrParents=this;else if(r instanceof e){if(r===this)return n;n._parentOrParents=[r,this]}else{if(-1!==r.indexOf(this))return n;r.push(this)}var a=this._subscriptions;return null===a?this._subscriptions=[n]:a.push(n),n}},{key:"remove",value:function(e){var t=this._subscriptions;if(t){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}}}]),e}()).EMPTY=function(e){return e.closed=!0,e}(new S),S);function I(e){return e.reduce(function(e,t){return e.concat(t instanceof T?t.errors:t)},[])}var M="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random(),A=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;switch(y(this,n),(a=t.call(this)).syncErrorValue=null,a.syncErrorThrown=!1,a.syncErrorThrowable=!1,a.isStopped=!1,arguments.length){case 0:a.destination=x;break;case 1:if(!e){a.destination=x;break}if("object"==typeof e){e instanceof n?(a.syncErrorThrowable=e.syncErrorThrowable,a.destination=e,e.add(g(a))):(a.syncErrorThrowable=!0,a.destination=new P(g(a),e));break}default:a.syncErrorThrowable=!0,a.destination=new P(g(a),e,i,r)}return a}return k(n,[{key:M,value:function(){return this}},{key:"next",value:function(e){this.isStopped||this._next(e)}},{key:"error",value:function(e){this.isStopped||(this.isStopped=!0,this._error(e))}},{key:"complete",value:function(){this.isStopped||(this.isStopped=!0,this._complete())}},{key:"unsubscribe",value:function(){this.closed||(this.isStopped=!0,u(v(n.prototype),"unsubscribe",this).call(this))}},{key:"_next",value:function(e){this.destination.next(e)}},{key:"_error",value:function(e){this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.destination.complete(),this.unsubscribe()}},{key:"_unsubscribeAndRecycle",value:function(){var e=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=e,this}}],[{key:"create",value:function(e,t,i){var r=new n(e,t,i);return r.syncErrorThrowable=!1,r}}]),n}(O),P=function(e){h(n,e);var t=f(n);function n(e,i,r,a){var o,s;y(this,n),(o=t.call(this))._parentSubscriber=e;var l=g(o);return m(i)?s=i:i&&(s=i.next,r=i.error,a=i.complete,i!==x&&(m((l=Object.create(i)).unsubscribe)&&o.add(l.unsubscribe.bind(l)),l.unsubscribe=o.unsubscribe.bind(g(o)))),o._context=l,o._next=s,o._error=r,o._complete=a,o}return k(n,[{key:"next",value:function(e){if(!this.isStopped&&this._next){var t=this._parentSubscriber;_.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?this.__tryOrSetError(t,this._next,e)&&this.unsubscribe():this.__tryOrUnsub(this._next,e)}}},{key:"error",value:function(e){if(!this.isStopped){var t=this._parentSubscriber,n=_.useDeprecatedSynchronousErrorHandling;if(this._error)n&&t.syncErrorThrowable?(this.__tryOrSetError(t,this._error,e),this.unsubscribe()):(this.__tryOrUnsub(this._error,e),this.unsubscribe());else if(t.syncErrorThrowable)n?(t.syncErrorValue=e,t.syncErrorThrown=!0):w(e),this.unsubscribe();else{if(this.unsubscribe(),n)throw e;w(e)}}}},{key:"complete",value:function(){var e=this;if(!this.isStopped){var t=this._parentSubscriber;if(this._complete){var n=function(){return e._complete.call(e._context)};_.useDeprecatedSynchronousErrorHandling&&t.syncErrorThrowable?(this.__tryOrSetError(t,n),this.unsubscribe()):(this.__tryOrUnsub(n),this.unsubscribe())}else this.unsubscribe()}}},{key:"__tryOrUnsub",value:function(e,t){try{e.call(this._context,t)}catch(n){if(this.unsubscribe(),_.useDeprecatedSynchronousErrorHandling)throw n;w(n)}}},{key:"__tryOrSetError",value:function(e,t,n){if(!_.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{t.call(this._context,n)}catch(i){return _.useDeprecatedSynchronousErrorHandling?(e.syncErrorValue=i,e.syncErrorThrown=!0,!0):(w(i),!0)}return!1}},{key:"_unsubscribe",value:function(){var e=this._parentSubscriber;this._context=null,this._parentSubscriber=null,e.unsubscribe()}}]),n}(A),D="function"==typeof Symbol&&Symbol.observable||"@@observable";function R(e){return e}var F,N=((F=function(){function e(t){y(this,e),this._isScalar=!1,t&&(this._subscribe=t)}return k(e,[{key:"lift",value:function(t){var n=new e;return n.source=this,n.operator=t,n}},{key:"subscribe",value:function(e,t,n){var i=this.operator,r=function(e,t,n){if(e){if(e instanceof A)return e;if(e[M])return e[M]()}return e||t||n?new A(e,t,n):new A(x)}(e,t,n);if(r.add(i?i.call(r,this.source):this.source||_.useDeprecatedSynchronousErrorHandling&&!r.syncErrorThrowable?this._subscribe(r):this._trySubscribe(r)),_.useDeprecatedSynchronousErrorHandling&&r.syncErrorThrowable&&(r.syncErrorThrowable=!1,r.syncErrorThrown))throw r.syncErrorValue;return r}},{key:"_trySubscribe",value:function(e){try{return this._subscribe(e)}catch(t){_.useDeprecatedSynchronousErrorHandling&&(e.syncErrorThrown=!0,e.syncErrorValue=t),function(e){for(;e;){var t=e,n=t.closed,i=t.destination,r=t.isStopped;if(n||r)return!1;e=i&&i instanceof A?i:null}return!0}(e)?e.error(t):console.warn(t)}}},{key:"forEach",value:function(e,t){var n=this;return new(t=z(t))(function(t,i){var r;r=n.subscribe(function(t){try{e(t)}catch(n){i(n),r&&r.unsubscribe()}},i,t)})}},{key:"_subscribe",value:function(e){var t=this.source;return t&&t.subscribe(e)}},{key:D,value:function(){return this}},{key:"pipe",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?this:(0===(i=t).length?R:1===i.length?i[0]:function(e){return i.reduce(function(e,t){return t(e)},e)})(this);var i}},{key:"toPromise",value:function(e){var t=this;return new(e=z(e))(function(e,n){var i;t.subscribe(function(e){return i=e},function(e){return n(e)},function(){return e(i)})})}}]),e}()).create=function(e){return new F(e)},F);function z(e){if(e||(e=_.Promise||Promise),!e)throw new Error("no Promise impl found");return e}var L,B=function(){function e(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return e.prototype=Object.create(Error.prototype),e}(),j=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this)).subject=e,r.subscriber=i,r.closed=!1,r}return k(n,[{key:"unsubscribe",value:function(){if(!this.closed){this.closed=!0;var e=this.subject,t=e.observers;if(this.subject=null,t&&0!==t.length&&!e.isStopped&&!e.closed){var n=t.indexOf(this.subscriber);-1!==n&&t.splice(n,1)}}}}]),n}(O),U=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this,e)).destination=e,i}return n}(A),H=((L=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.call(this)).observers=[],e.closed=!1,e.isStopped=!1,e.hasError=!1,e.thrownError=null,e}return k(n,[{key:M,value:function(){return new U(this)}},{key:"lift",value:function(e){var t=new V(this,this);return t.operator=e,t}},{key:"next",value:function(e){if(this.closed)throw new B;if(!this.isStopped)for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].next(e)}},{key:"error",value:function(e){if(this.closed)throw new B;this.hasError=!0,this.thrownError=e,this.isStopped=!0;for(var t=this.observers,n=t.length,i=t.slice(),r=0;r<n;r++)i[r].error(e);this.observers.length=0}},{key:"complete",value:function(){if(this.closed)throw new B;this.isStopped=!0;for(var e=this.observers,t=e.length,n=e.slice(),i=0;i<t;i++)n[i].complete();this.observers.length=0}},{key:"unsubscribe",value:function(){this.isStopped=!0,this.closed=!0,this.observers=null}},{key:"_trySubscribe",value:function(e){if(this.closed)throw new B;return u(v(n.prototype),"_trySubscribe",this).call(this,e)}},{key:"_subscribe",value:function(e){if(this.closed)throw new B;return this.hasError?(e.error(this.thrownError),O.EMPTY):this.isStopped?(e.complete(),O.EMPTY):(this.observers.push(e),new j(this,e))}},{key:"asObservable",value:function(){var e=new N;return e.source=this,e}}]),n}(N)).create=function(e,t){return new V(e,t)},L),V=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this)).destination=e,r.source=i,r}return k(n,[{key:"next",value:function(e){var t=this.destination;t&&t.next&&t.next(e)}},{key:"error",value:function(e){var t=this.destination;t&&t.error&&this.destination.error(e)}},{key:"complete",value:function(){var e=this.destination;e&&e.complete&&this.destination.complete()}},{key:"_subscribe",value:function(e){return this.source?this.source.subscribe(e):O.EMPTY}}]),n}(H);function W(e){return e&&"function"==typeof e.schedule}function G(e,t){return function(n){if("function"!=typeof e)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return n.lift(new Z(e,t))}}var Z=function(){function e(t,n){y(this,e),this.project=t,this.thisArg=n}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new Y(e,this.project,this.thisArg))}}]),e}(),Y=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this,e)).project=i,a.count=0,a.thisArg=r||g(a),a}return k(n,[{key:"_next",value:function(e){var t;try{t=this.project.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}this.destination.next(t)}}]),n}(A),q=function(e){return function(t){for(var n=0,i=e.length;n<i&&!t.closed;n++)t.next(e[n]);t.complete()}};var X="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",K=function(e){return e&&"number"==typeof e.length&&"function"!=typeof e};function $(e){return!!e&&"function"!=typeof e.subscribe&&"function"==typeof e.then}var Q=function(e){if(e&&"function"==typeof e[D])return i=e,function(e){var t=i[D]();if("function"!=typeof t.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return t.subscribe(e)};if(K(e))return q(e);if($(e))return n=e,function(e){return n.then(function(t){e.closed||(e.next(t),e.complete())},function(t){return e.error(t)}).then(null,w),e};if(e&&"function"==typeof e[X])return t=e,function(e){for(var n=t[X]();;){var i=void 0;try{i=n.next()}catch(r){return e.error(r),e}if(i.done){e.complete();break}if(e.next(i.value),e.closed)break}return"function"==typeof n.return&&e.add(function(){n.return&&n.return()}),e};var t,n,i,r=E(e)?"an invalid object":"'".concat(e,"'");throw new TypeError("You provided ".concat(r," where a stream was expected. You can provide an Observable, Promise, Array, or Iterable."))};function J(e,t){return new N(function(n){var i=new O,r=0;return i.add(t.schedule(function(){r!==e.length?(n.next(e[r++]),n.closed||i.add(this.schedule())):n.complete()})),i})}function ee(e,t){return t?function(e,t){if(null!=e){if(function(e){return e&&"function"==typeof e[D]}(e))return function(e,t){return new N(function(n){var i=new O;return i.add(t.schedule(function(){var r=e[D]();i.add(r.subscribe({next:function(e){i.add(t.schedule(function(){return n.next(e)}))},error:function(e){i.add(t.schedule(function(){return n.error(e)}))},complete:function(){i.add(t.schedule(function(){return n.complete()}))}}))})),i})}(e,t);if($(e))return function(e,t){return new N(function(n){var i=new O;return i.add(t.schedule(function(){return e.then(function(e){i.add(t.schedule(function(){n.next(e),i.add(t.schedule(function(){return n.complete()}))}))},function(e){i.add(t.schedule(function(){return n.error(e)}))})})),i})}(e,t);if(K(e))return J(e,t);if(function(e){return e&&"function"==typeof e[X]}(e)||"string"==typeof e)return function(e,t){if(!e)throw new Error("Iterable cannot be null");return new N(function(n){var i,r=new O;return r.add(function(){i&&"function"==typeof i.return&&i.return()}),r.add(t.schedule(function(){i=e[X](),r.add(t.schedule(function(){if(!n.closed){var e,t;try{var r=i.next();e=r.value,t=r.done}catch(a){return void n.error(a)}t?n.complete():(n.next(e),this.schedule())}}))})),r})}(e,t)}throw new TypeError((null!==e&&typeof e||e)+" is not observable")}(e,t):e instanceof N?e:new N(Q(e))}var te=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this)).parent=e,i}return k(n,[{key:"_next",value:function(e){this.parent.notifyNext(e)}},{key:"_error",value:function(e){this.parent.notifyError(e),this.unsubscribe()}},{key:"_complete",value:function(){this.parent.notifyComplete(),this.unsubscribe()}}]),n}(A),ne=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"notifyNext",value:function(e){this.destination.next(e)}},{key:"notifyError",value:function(e){this.destination.error(e)}},{key:"notifyComplete",value:function(){this.destination.complete()}}]),n}(A);function ie(e,t){if(!t.closed){if(e instanceof N)return e.subscribe(t);var n;try{n=Q(e)(t)}catch(i){t.error(i)}return n}}function re(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return"function"==typeof t?function(i){return i.pipe(re(function(n,i){return ee(e(n,i)).pipe(G(function(e,r){return t(n,e,i,r)}))},n))}:("number"==typeof t&&(n=t),function(t){return t.lift(new ae(e,n))})}var ae=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY;y(this,e),this.project=t,this.concurrent=n}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new oe(e,this.project,this.concurrent))}}]),e}(),oe=function(e){h(n,e);var t=f(n);function n(e,i){var r,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Number.POSITIVE_INFINITY;return y(this,n),(r=t.call(this,e)).project=i,r.concurrent=a,r.hasCompleted=!1,r.buffer=[],r.active=0,r.index=0,r}return k(n,[{key:"_next",value:function(e){this.active<this.concurrent?this._tryNext(e):this.buffer.push(e)}},{key:"_tryNext",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(i){return void this.destination.error(i)}this.active++,this._innerSub(t)}},{key:"_innerSub",value:function(e){var t=new te(this),n=this.destination;n.add(t);var i=ie(e,t);i!==t&&n.add(i)}},{key:"_complete",value:function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}},{key:"notifyNext",value:function(e){this.destination.next(e)}},{key:"notifyComplete",value:function(){var e=this.buffer;this.active--,e.length>0?this._next(e.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}]),n}(ne);function se(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Number.POSITIVE_INFINITY;return re(R,e)}function le(e,t){return t?J(e,t):new N(q(e))}function ce(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=Number.POSITIVE_INFINITY,r=null,a=t[t.length-1];return W(a)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(i=t.pop())):"number"==typeof a&&(i=t.pop()),null===r&&1===t.length&&t[0]instanceof N?t[0]:se(i)(le(t,r))}function ue(){return function(e){return e.lift(new de(e))}}var he,de=function(){function e(t){y(this,e),this.connectable=t}return k(e,[{key:"call",value:function(e,t){var n=this.connectable;n._refCount++;var i=new fe(e,n),r=t.subscribe(i);return i.closed||(i.connection=n.connect()),r}}]),e}(),fe=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this,e)).connectable=i,r}return k(n,[{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._refCount;if(t<=0)this.connection=null;else if(e._refCount=t-1,t>1)this.connection=null;else{var n=this.connection,i=e._connection;this.connection=null,!i||n&&i!==n||i.unsubscribe()}}else this.connection=null}}]),n}(A),pe={operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:(he=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this)).source=e,r.subjectFactory=i,r._refCount=0,r._isComplete=!1,r}return k(n,[{key:"_subscribe",value:function(e){return this.getSubject().subscribe(e)}},{key:"getSubject",value:function(){var e=this._subject;return e&&!e.isStopped||(this._subject=this.subjectFactory()),this._subject}},{key:"connect",value:function(){var e=this._connection;return e||(this._isComplete=!1,(e=this._connection=new O).add(this.source.subscribe(new ge(this.getSubject(),this))),e.closed&&(this._connection=null,e=O.EMPTY)),e}},{key:"refCount",value:function(){return ue()(this)}}]),n}(N).prototype)._subscribe},_isComplete:{value:he._isComplete,writable:!0},getSubject:{value:he.getSubject},connect:{value:he.connect},refCount:{value:he.refCount}},ge=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this,e)).connectable=i,r}return k(n,[{key:"_error",value:function(e){this._unsubscribe(),u(v(n.prototype),"_error",this).call(this,e)}},{key:"_complete",value:function(){this.connectable._isComplete=!0,this._unsubscribe(),u(v(n.prototype),"_complete",this).call(this)}},{key:"_unsubscribe",value:function(){var e=this.connectable;if(e){this.connectable=null;var t=e._connection;e._refCount=0,e._subject=null,e._connection=null,t&&t.unsubscribe()}}}]),n}(U);function me(e,t){return function(n){var i;if(i="function"==typeof e?e:function(){return e},"function"==typeof t)return n.lift(new ve(i,t));var r=Object.create(n,pe);return r.source=n,r.subjectFactory=i,r}}var ve=function(){function e(t,n){y(this,e),this.subjectFactory=t,this.selector=n}return k(e,[{key:"call",value:function(e,t){var n=this.selector,i=this.subjectFactory(),r=n(i).subscribe(e);return r.add(t.subscribe(i)),r}}]),e}();function ye(){return new H}function be(e){for(var t in e)if(e[t]===be)return t;throw Error("Could not find renamed property on target object.")}function ke(e,t){for(var n in t)t.hasOwnProperty(n)&&!e.hasOwnProperty(n)&&(e[n]=t[n])}function _e(e){if("string"==typeof e)return e;if(Array.isArray(e))return"["+e.map(_e).join(", ")+"]";if(null==e)return""+e;if(e.overriddenName)return"".concat(e.overriddenName);if(e.name)return"".concat(e.name);var t=e.toString();if(null==t)return""+t;var n=t.indexOf("\n");return-1===n?t:t.substring(0,n)}function we(e,t){return null==e||""===e?null===t?"":t:null==t||""===t?e:e+" "+t}var xe=be({__forward_ref__:be});function Ce(e){return e.__forward_ref__=Ce,e.toString=function(){return _e(this())},e}function Ee(e){return Se(e)?e():e}function Se(e){return"function"==typeof e&&e.hasOwnProperty(xe)&&e.__forward_ref__===Ce}var Te=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this,function(e,t){return"".concat(e?"NG0".concat(e,": "):"").concat(t)}(e,i))).code=e,r}return n}(l(Error));function Oe(e){return"string"==typeof e?e:null==e?"":String(e)}function Ie(e){return"function"==typeof e?e.name||e.toString():"object"==typeof e&&null!=e&&"function"==typeof e.type?e.type.name||e.type.toString():Oe(e)}function Me(e,t){var n=t?" in ".concat(t):"";throw new Te("201","No provider for ".concat(Ie(e)," found").concat(n))}function Ae(e){return{token:e.token,providedIn:e.providedIn||null,factory:e.factory,value:void 0}}function Pe(e){return{providers:e.providers||[],imports:e.imports||[]}}function De(e){return Re(e,ze)||Re(e,Be)}function Re(e,t){return e.hasOwnProperty(t)?e[t]:null}function Fe(e){return e&&(e.hasOwnProperty(Le)||e.hasOwnProperty(je))?e[Le]:null}var Ne,ze=be({"\u0275prov":be}),Le=be({"\u0275inj":be}),Be=be({ngInjectableDef:be}),je=be({ngInjectorDef:be}),Ue=function(e){return e[e.Default=0]="Default",e[e.Host=1]="Host",e[e.Self=2]="Self",e[e.SkipSelf=4]="SkipSelf",e[e.Optional=8]="Optional",e}({});function He(e){var t=Ne;return Ne=e,t}function Ve(e,t,n){var i=De(e);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:n&Ue.Optional?null:void 0!==t?t:void Me(_e(e),"Injector")}function We(e){return{toString:e}.toString()}var Ge=function(e){return e[e.OnPush=0]="OnPush",e[e.Default=1]="Default",e}({}),Ze=function(e){return e[e.Emulated=0]="Emulated",e[e.None=2]="None",e[e.ShadowDom=3]="ShadowDom",e}({}),Ye="undefined"!=typeof globalThis&&globalThis,qe="undefined"!=typeof window&&window,Xe="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ke="undefined"!=typeof global&&global,$e=Ye||Ke||qe||Xe,Qe={},Je=[],et=[],tt=be({"\u0275cmp":be}),nt=be({"\u0275dir":be}),it=be({"\u0275pipe":be}),rt=be({"\u0275mod":be}),at=be({"\u0275loc":be}),ot=be({"\u0275fac":be}),st=be({__NG_ELEMENT_ID__:be}),lt=0;function ct(e){return We(function(){var t={},n={type:e.type,providersResolver:null,decls:e.decls,vars:e.vars,factory:null,template:e.template||null,consts:e.consts||null,ngContentSelectors:e.ngContentSelectors,hostBindings:e.hostBindings||null,hostVars:e.hostVars||0,hostAttrs:e.hostAttrs||null,contentQueries:e.contentQueries||null,declaredInputs:t,inputs:null,outputs:null,exportAs:e.exportAs||null,onPush:e.changeDetection===Ge.OnPush,directiveDefs:null,pipeDefs:null,selectors:e.selectors||et,viewQuery:e.viewQuery||null,features:e.features||null,data:e.data||{},encapsulation:e.encapsulation||Ze.Emulated,id:"c",styles:e.styles||et,_:null,setInput:null,schemas:e.schemas||null,tView:null},i=e.directives,r=e.features,a=e.pipes;return n.id+=lt++,n.inputs=gt(e.inputs,t),n.outputs=gt(e.outputs),r&&r.forEach(function(e){return e(n)}),n.directiveDefs=i?function(){return("function"==typeof i?i():i).map(ht)}:null,n.pipeDefs=a?function(){return("function"==typeof a?a():a).map(dt)}:null,n})}function ut(e,t,n){var i=e.\u0275cmp;i.directiveDefs=function(){return t.map(ht)},i.pipeDefs=function(){return n.map(dt)}}function ht(e){return yt(e)||function(e){return e[nt]||null}(e)}function dt(e){return function(e){return e[it]||null}(e)}var ft={};function pt(e){var t={type:e.type,bootstrap:e.bootstrap||et,declarations:e.declarations||et,imports:e.imports||et,exports:e.exports||et,transitiveCompileScopes:null,schemas:e.schemas||null,id:e.id||null};return null!=e.id&&We(function(){ft[e.id]=e.type}),t}function gt(e,t){if(null==e)return Qe;var n={};for(var i in e)if(e.hasOwnProperty(i)){var r=e[i],a=r;Array.isArray(r)&&(a=r[1],r=r[0]),n[r]=i,t&&(t[r]=a)}return n}var mt=ct;function vt(e){return{type:e.type,name:e.name,factory:null,pure:!1!==e.pure,onDestroy:e.type.prototype.ngOnDestroy||null}}function yt(e){return e[tt]||null}function bt(e,t){var n=e[rt]||null;if(!n&&!0===t)throw new Error("Type ".concat(_e(e)," does not have '\u0275mod' property."));return n}function kt(e){return Array.isArray(e)&&"object"==typeof e[1]}function _t(e){return Array.isArray(e)&&!0===e[1]}function wt(e){return 0!=(8&e.flags)}function xt(e){return 2==(2&e.flags)}function Ct(e){return 1==(1&e.flags)}function Et(e){return null!==e.template}function St(e,t){return e.hasOwnProperty(ot)?e[ot]:null}var Tt,Ot=function(){function e(t,n,i){y(this,e),this.previousValue=t,this.currentValue=n,this.firstChange=i}return k(e,[{key:"isFirstChange",value:function(){return this.firstChange}}]),e}();function It(){return Mt}function Mt(e){return e.type.prototype.ngOnChanges&&(e.setInput=Pt),At}function At(){var e=Dt(this),t=null==e?void 0:e.current;if(t){var n=e.previous;if(n===Qe)e.previous=t;else for(var i in t)n[i]=t[i];e.current=null,this.ngOnChanges(t)}}function Pt(e,t,n,i){var r=Dt(e)||function(e,t){return e.__ngSimpleChanges__=t}(e,{previous:Qe,current:null}),a=r.current||(r.current={}),o=r.previous,s=this.declaredInputs[n],l=o[s];a[s]=new Ot(l&&l.currentValue,t,o===Qe),e[i]=t}function Dt(e){return e.__ngSimpleChanges__||null}function Rt(){return void 0!==Tt?Tt:"undefined"!=typeof document?document:void 0}function Ft(e){return!!e.listen}It.ngInherit=!0;var Nt={createRenderer:function(e,t){return Rt()}};function zt(e){for(;Array.isArray(e);)e=e[0];return e}function Lt(e,t){return zt(t[e])}function Bt(e,t){return zt(t[e.index])}function jt(e,t){return e.data[t]}function Ut(e,t){return e[t]}function Ht(e,t){var n=t[e];return kt(n)?n:n[0]}function Vt(e){var t=function(e){return e.__ngContext__||null}(e);return t?Array.isArray(t)?t:t.lView:null}function Wt(e){return 4==(4&e[2])}function Gt(e){return 128==(128&e[2])}function Zt(e,t){return null==t?null:e[t]}function Yt(e){e[18]=0}function qt(e,t){e[5]+=t;for(var n=e,i=e[3];null!==i&&(1===t&&1===n[5]||-1===t&&0===n[5]);)i[5]+=t,n=i,i=i[3]}var Xt={lFrame:bn(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Kt(){return Xt.bindingsEnabled}function $t(){return Xt.lFrame.lView}function Qt(){return Xt.lFrame.tView}function Jt(e){Xt.lFrame.contextLView=e}function en(){for(var e=tn();null!==e&&64===e.type;)e=e.parent;return e}function tn(){return Xt.lFrame.currentTNode}function nn(e,t){var n=Xt.lFrame;n.currentTNode=e,n.isParent=t}function rn(){return Xt.lFrame.isParent}function an(){Xt.lFrame.isParent=!1}function on(){return Xt.isInCheckNoChangesMode}function sn(e){Xt.isInCheckNoChangesMode=e}function ln(){var e=Xt.lFrame,t=e.bindingRootIndex;return-1===t&&(t=e.bindingRootIndex=e.tView.bindingStartIndex),t}function cn(){return Xt.lFrame.bindingIndex}function un(){return Xt.lFrame.bindingIndex++}function hn(e){var t=Xt.lFrame,n=t.bindingIndex;return t.bindingIndex=t.bindingIndex+e,n}function dn(e){Xt.lFrame.currentDirectiveIndex=e}function fn(){return Xt.lFrame.currentQueryIndex}function pn(e){Xt.lFrame.currentQueryIndex=e}function gn(e){var t=e[1];return 2===t.type?t.declTNode:1===t.type?e[6]:null}function mn(e,t,n){if(n&Ue.SkipSelf){for(var i=t,r=e;!(null!==(i=i.parent)||n&Ue.Host||(i=gn(r),null===i)||(r=r[15],10&i.type)););if(null===i)return!1;t=i,e=r}var a=Xt.lFrame=yn();return a.currentTNode=t,a.lView=e,!0}function vn(e){var t=yn(),n=e[1];Xt.lFrame=t,t.currentTNode=n.firstChild,t.lView=e,t.tView=n,t.contextLView=e,t.bindingIndex=n.bindingStartIndex,t.inI18n=!1}function yn(){var e=Xt.lFrame,t=null===e?null:e.child;return null===t?bn(e):t}function bn(e){var t={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:e,child:null,inI18n:!1};return null!==e&&(e.child=t),t}function kn(){var e=Xt.lFrame;return Xt.lFrame=e.parent,e.currentTNode=null,e.lView=null,e}var _n=kn;function wn(){var e=kn();e.isParent=!0,e.tView=null,e.selectedIndex=-1,e.contextLView=null,e.elementDepthCount=0,e.currentDirectiveIndex=-1,e.currentNamespace=null,e.bindingRootIndex=-1,e.bindingIndex=-1,e.currentQueryIndex=0}function xn(){return Xt.lFrame.selectedIndex}function Cn(e){Xt.lFrame.selectedIndex=e}function En(){var e=Xt.lFrame;return jt(e.tView,e.selectedIndex)}function Sn(e,t){for(var n=t.directiveStart,i=t.directiveEnd;n<i;n++){var r=e.data[n].type.prototype,a=r.ngAfterContentInit,o=r.ngAfterContentChecked,s=r.ngAfterViewInit,l=r.ngAfterViewChecked,c=r.ngOnDestroy;a&&(e.contentHooks||(e.contentHooks=[])).push(-n,a),o&&((e.contentHooks||(e.contentHooks=[])).push(n,o),(e.contentCheckHooks||(e.contentCheckHooks=[])).push(n,o)),s&&(e.viewHooks||(e.viewHooks=[])).push(-n,s),l&&((e.viewHooks||(e.viewHooks=[])).push(n,l),(e.viewCheckHooks||(e.viewCheckHooks=[])).push(n,l)),null!=c&&(e.destroyHooks||(e.destroyHooks=[])).push(n,c)}}function Tn(e,t,n){Mn(e,t,3,n)}function On(e,t,n,i){(3&e[2])===n&&Mn(e,t,n,i)}function In(e,t){var n=e[2];(3&n)===t&&(n&=2047,n+=1,e[2]=n)}function Mn(e,t,n,i){for(var r=null!=i?i:-1,a=t.length-1,o=0,s=void 0!==i?65535&e[18]:0;s<a;s++)if("number"==typeof t[s+1]){if(o=t[s],null!=i&&o>=i)break}else t[s]<0&&(e[18]+=65536),(o<r||-1==r)&&(An(e,n,t,s),e[18]=(4294901760&e[18])+s+2),s++}function An(e,t,n,i){var r=n[i]<0,a=n[i+1],o=e[r?-n[i]:n[i]];if(r){if(e[2]>>11<e[18]>>16&&(3&e[2])===t){e[2]+=2048;try{a.call(o)}finally{}}}else try{a.call(o)}finally{}}var Pn=function e(t,n,i){y(this,e),this.factory=t,this.resolving=!1,this.canSeeViewProviders=n,this.injectImpl=i};function Dn(e,t,n){for(var i=Ft(e),r=0;r<n.length;){var a=n[r];if("number"==typeof a){if(0!==a)break;r++;var o=n[r++],s=n[r++],l=n[r++];i?e.setAttribute(t,s,l,o):t.setAttributeNS(o,s,l)}else{var c=a,u=n[++r];Rn(c)?i&&e.setProperty(t,c,u):i?e.setAttribute(t,c,u):t.setAttribute(c,u),r++}}return r}function Rn(e){return 64===e.charCodeAt(0)}function Fn(e,t){if(null===t||0===t.length);else if(null===e||0===e.length)e=t.slice();else for(var n=-1,i=0;i<t.length;i++){var r=t[i];"number"==typeof r?n=r:0===n||Nn(e,n,r,null,-1===n||2===n?t[++i]:null)}return e}function Nn(e,t,n,i,r){var a=0,o=e.length;if(-1===t)o=-1;else for(;a<e.length;){var s=e[a++];if("number"==typeof s){if(s===t){o=-1;break}if(s>t){o=a-1;break}}}for(;a<e.length;){var l=e[a];if("number"==typeof l)break;if(l===n){if(null===i)return void(null!==r&&(e[a+1]=r));if(i===e[a+1])return void(e[a+2]=r)}a++,null!==i&&a++,null!==r&&a++}-1!==o&&(e.splice(o,0,t),a=o+1),e.splice(a++,0,n),null!==i&&e.splice(a++,0,i),null!==r&&e.splice(a++,0,r)}function zn(e){return-1!==e}function Ln(e){return 32767&e}function Bn(e,t){for(var n=e>>16,i=t;n>0;)i=i[15],n--;return i}var jn=!0;function Un(e){var t=jn;return jn=e,t}var Hn=0;function Vn(e,t){var n=Gn(e,t);if(-1!==n)return n;var i=t[1];i.firstCreatePass&&(e.injectorIndex=t.length,Wn(i.data,e),Wn(t,null),Wn(i.blueprint,null));var r=Zn(e,t),a=e.injectorIndex;if(zn(r))for(var o=Ln(r),s=Bn(r,t),l=s[1].data,c=0;c<8;c++)t[a+c]=s[o+c]|l[o+c];return t[a+8]=r,a}function Wn(e,t){e.push(0,0,0,0,0,0,0,0,t)}function Gn(e,t){return-1===e.injectorIndex||e.parent&&e.parent.injectorIndex===e.injectorIndex||null===t[e.injectorIndex+8]?-1:e.injectorIndex}function Zn(e,t){if(e.parent&&-1!==e.parent.injectorIndex)return e.parent.injectorIndex;for(var n=0,i=null,r=t;null!==r;){var a=r[1],o=a.type;if(null===(i=2===o?a.declTNode:1===o?r[6]:null))return-1;if(n++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|n<<16}return-1}function Yn(e,t,n){!function(e,t,n){var i;"string"==typeof n?i=n.charCodeAt(0)||0:n.hasOwnProperty(st)&&(i=n[st]),null==i&&(i=n[st]=Hn++);var r=255&i;t.data[e+(r>>5)]|=1<<r}(e,t,n)}function qn(e,t,n){if(n&Ue.Optional)return e;Me(t,"NodeInjector")}function Xn(e,t,n,i){if(n&Ue.Optional&&void 0===i&&(i=null),0==(n&(Ue.Self|Ue.Host))){var r=e[9],a=He(void 0);try{return r?r.get(t,i,n&Ue.Optional):Ve(t,i,n&Ue.Optional)}finally{He(a)}}return qn(i,t,n)}function Kn(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Ue.Default,r=arguments.length>4?arguments[4]:void 0;if(null!==e){var a=function(e){if("string"==typeof e)return e.charCodeAt(0)||0;var t=e.hasOwnProperty(st)?e[st]:void 0;return"number"==typeof t?t>=0?255&t:Qn:t}(n);if("function"==typeof a){if(!mn(t,e,i))return i&Ue.Host?qn(r,n,i):Xn(t,n,i,r);try{var o=a();if(null!=o||i&Ue.Optional)return o;Me(n)}finally{_n()}}else if("number"==typeof a){var s=null,l=Gn(e,t),c=-1,u=i&Ue.Host?t[16][6]:null;for((-1===l||i&Ue.SkipSelf)&&(-1!==(c=-1===l?Zn(e,t):t[l+8])&&ii(i,!1)?(s=t[1],l=Ln(c),t=Bn(c,t)):l=-1);-1!==l;){var h=t[1];if(ni(a,l,h.data)){var d=Jn(l,t,n,s,i,u);if(d!==$n)return d}-1!==(c=t[l+8])&&ii(i,t[1].data[l+8]===u)&&ni(a,l,t)?(s=h,l=Ln(c),t=Bn(c,t)):l=-1}}}return Xn(t,n,i,r)}var $n={};function Qn(){return new ri(en(),$t())}function Jn(e,t,n,i,r,a){var o=t[1],s=o.data[e+8],l=ei(s,o,n,null==i?xt(s)&&jn:i!=o&&0!=(3&s.type),r&Ue.Host&&a===s);return null!==l?ti(t,o,l,s):$n}function ei(e,t,n,i,r){for(var a=e.providerIndexes,o=t.data,s=1048575&a,l=e.directiveStart,c=a>>20,u=r?s+c:e.directiveEnd,h=i?s:s+c;h<u;h++){var d=o[h];if(h<l&&n===d||h>=l&&d.type===n)return h}if(r){var f=o[l];if(f&&Et(f)&&f.type===n)return l}return null}function ti(e,t,n,i){var r=e[n],a=t.data;if(r instanceof Pn){var o=r;o.resolving&&function(e,t){throw new Te("200","Circular dependency in DI detected for ".concat(e))}(Ie(a[n]));var s=Un(o.canSeeViewProviders);o.resolving=!0;var l=o.injectImpl?He(o.injectImpl):null;mn(e,i,Ue.Default);try{r=e[n]=o.factory(void 0,a,e,i),t.firstCreatePass&&n>=i.directiveStart&&function(e,t,n){var i=t.type.prototype,r=i.ngOnChanges,a=i.ngOnInit,o=i.ngDoCheck;if(r){var s=Mt(t);(n.preOrderHooks||(n.preOrderHooks=[])).push(e,s),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,s)}a&&(n.preOrderHooks||(n.preOrderHooks=[])).push(0-e,a),o&&((n.preOrderHooks||(n.preOrderHooks=[])).push(e,o),(n.preOrderCheckHooks||(n.preOrderCheckHooks=[])).push(e,o))}(n,a[n],t)}finally{null!==l&&He(l),Un(s),o.resolving=!1,_n()}}return r}function ni(e,t,n){return!!(n[t+(e>>5)]&1<<e)}function ii(e,t){return!(e&Ue.Self||e&Ue.Host&&t)}var ri=function(){function e(t,n){y(this,e),this._tNode=t,this._lView=n}return k(e,[{key:"get",value:function(e,t){return Kn(this._tNode,this._lView,e,void 0,t)}}]),e}();function ai(e){return Se(e)?function(){var t=ai(Ee(e));return t&&t()}:St(e)}function oi(e,t,n){return We(function(){var i=function(e){return function(){if(e){var t=e.apply(void 0,arguments);for(var n in t)this[n]=t[n]}}}(t);function r(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(this instanceof r)return i.apply(this,t),this;var a=c(r,t);return o.annotation=a,o;function o(e,t,n){for(var i=e.hasOwnProperty("__parameters__")?e.__parameters__:Object.defineProperty(e,"__parameters__",{value:[]}).__parameters__;i.length<=n;)i.push(null);return(i[n]=i[n]||[]).push(a),e}}return n&&(r.prototype=Object.create(n.prototype)),r.prototype.ngMetadataName=e,r.annotationCls=r,r})}var si=function(){function e(t,n){y(this,e),this._desc=t,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof n?this.__NG_ELEMENT_ID__=n:void 0!==n&&(this.\u0275prov=Ae({token:this,providedIn:n.providedIn||"root",factory:n.factory}))}return k(e,[{key:"toString",value:function(){return"InjectionToken ".concat(this._desc)}}]),e}();function li(e,t){void 0===t&&(t=e);for(var n=0;n<e.length;n++){var i=e[n];Array.isArray(i)?(t===e&&(t=e.slice(0,n)),li(i,t)):t!==e&&t.push(i)}return t}function ci(e,t){e.forEach(function(e){return Array.isArray(e)?ci(e,t):t(e)})}function ui(e,t,n){t>=e.length?e.push(n):e.splice(t,0,n)}function hi(e,t){return t>=e.length-1?e.pop():e.splice(t,1)[0]}function di(e,t){for(var n=[],i=0;i<e;i++)n.push(t);return n}function fi(e,t,n){var i=gi(e,t);return i>=0?e[1|i]=n:function(e,t,n,i){var r=e.length;if(r==t)e.push(n,i);else if(1===r)e.push(i,e[0]),e[0]=n;else{for(r--,e.push(e[r-1],e[r]);r>t;)e[r]=e[r-2],r--;e[t]=n,e[t+1]=i}}(e,i=~i,t,n),i}function pi(e,t){var n=gi(e,t);if(n>=0)return e[1|n]}function gi(e,t){return function(e,t,n){for(var i=0,r=e.length>>1;r!==i;){var a=i+(r-i>>1),o=e[a<<1];if(t===o)return a<<1;o>t?r=a:i=a+1}return~(r<<1)}(e,t)}var mi,vi={},yi=/\n/gm,bi=be({provide:String,useValue:be});function ki(e){var t=mi;return mi=e,t}function _i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.Default;if(void 0===mi)throw new Error("inject() must be called from an injection context");return null===mi?Ve(e,void 0,t):mi.get(e,t&Ue.Optional?null:void 0,t)}function wi(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.Default;return(Ne||_i)(Ee(e),t)}function xi(e){for(var t=[],n=0;n<e.length;n++){var i=Ee(e[n]);if(Array.isArray(i)){if(0===i.length)throw new Error("Arguments array must have arguments.");for(var r=void 0,a=Ue.Default,o=0;o<i.length;o++){var s=i[o],l=s.__NG_DI_FLAG__;"number"==typeof l?-1===l?r=s.token:a|=l:r=s}t.push(wi(r,a))}else t.push(wi(i))}return t}function Ci(e,t){return e.__NG_DI_FLAG__=t,e.prototype.__NG_DI_FLAG__=t,e}var Ei,Si,Ti=Ci(oi("Inject",function(e){return{token:e}}),-1),Oi=Ci(oi("Optional"),8),Ii=Ci(oi("SkipSelf"),4);function Mi(e){var t;return(null===(t=function(){if(void 0===Ei&&(Ei=null,$e.trustedTypes))try{Ei=$e.trustedTypes.createPolicy("angular",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(t){}return Ei}())||void 0===t?void 0:t.createHTML(e))||e}function Ai(e){var t;return(null===(t=function(){if(void 0===Si&&(Si=null,$e.trustedTypes))try{Si=$e.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:function(e){return e},createScript:function(e){return e},createScriptURL:function(e){return e}})}catch(t){}return Si}())||void 0===t?void 0:t.createHTML(e))||e}var Pi=function(){function e(t){y(this,e),this.changingThisBreaksApplicationSecurity=t}return k(e,[{key:"toString",value:function(){return"SafeValue must use [property]=binding: ".concat(this.changingThisBreaksApplicationSecurity," (see https://g.co/ng/security#xss)")}}]),e}(),Di=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"getTypeName",value:function(){return"HTML"}}]),n}(Pi),Ri=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"getTypeName",value:function(){return"Style"}}]),n}(Pi),Fi=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"getTypeName",value:function(){return"Script"}}]),n}(Pi),Ni=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"getTypeName",value:function(){return"URL"}}]),n}(Pi),zi=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"getTypeName",value:function(){return"ResourceURL"}}]),n}(Pi);function Li(e){return e instanceof Pi?e.changingThisBreaksApplicationSecurity:e}function Bi(e,t){var n=ji(e);if(null!=n&&n!==t){if("ResourceURL"===n&&"URL"===t)return!0;throw new Error("Required a safe ".concat(t,", got a ").concat(n," (see https://g.co/ng/security#xss)"))}return n===t}function ji(e){return e instanceof Pi&&e.getTypeName()||null}var Ui=function(){function e(t){y(this,e),this.inertDocumentHelper=t}return k(e,[{key:"getInertBodyElement",value:function(e){e="<body><remove></remove>"+e;try{var t=(new window.DOMParser).parseFromString(Mi(e),"text/html").body;return null===t?this.inertDocumentHelper.getInertBodyElement(e):(t.removeChild(t.firstChild),t)}catch(n){return null}}}]),e}(),Hi=function(){function e(t){if(y(this,e),this.defaultDoc=t,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){var n=this.inertDocument.createElement("html");this.inertDocument.appendChild(n);var i=this.inertDocument.createElement("body");n.appendChild(i)}}return k(e,[{key:"getInertBodyElement",value:function(e){var t=this.inertDocument.createElement("template");if("content"in t)return t.innerHTML=Mi(e),t;var n=this.inertDocument.createElement("body");return n.innerHTML=Mi(e),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(n),n}},{key:"stripCustomNsAttrs",value:function(e){for(var t=e.attributes,n=t.length-1;0<n;n--){var i=t.item(n).name;"xmlns:ns1"!==i&&0!==i.indexOf("ns1:")||e.removeAttribute(i)}for(var r=e.firstChild;r;)r.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(r),r=r.nextSibling}}]),e}(),Vi=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Wi=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Gi(e){return(e=String(e)).match(Vi)||e.match(Wi)?e:"unsafe:"+e}function Zi(e){var t,n={},i=a(e.split(","));try{for(i.s();!(t=i.n()).done;){n[t.value]=!0}}catch(r){i.e(r)}finally{i.f()}return n}function Yi(){for(var e={},t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];for(var r=0,a=n;r<a.length;r++){var o=a[r];for(var s in o)o.hasOwnProperty(s)&&(e[s]=!0)}return e}var qi,Xi=Zi("area,br,col,hr,img,wbr"),Ki=Zi("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),$i=Zi("rp,rt"),Qi=Yi($i,Ki),Ji=Yi(Xi,Yi(Ki,Zi("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Yi($i,Zi("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Qi),er=Zi("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),tr=Zi("srcset"),nr=Yi(er,tr,Zi("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Zi("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),ir=Zi("script,style,template"),rr=function(){function e(){y(this,e),this.sanitizedSomething=!1,this.buf=[]}return k(e,[{key:"sanitizeChildren",value:function(e){for(var t=e.firstChild,n=!0;t;)if(t.nodeType===Node.ELEMENT_NODE?n=this.startElement(t):t.nodeType===Node.TEXT_NODE?this.chars(t.nodeValue):this.sanitizedSomething=!0,n&&t.firstChild)t=t.firstChild;else for(;t;){t.nodeType===Node.ELEMENT_NODE&&this.endElement(t);var i=this.checkClobberedElement(t,t.nextSibling);if(i){t=i;break}t=this.checkClobberedElement(t,t.parentNode)}return this.buf.join("")}},{key:"startElement",value:function(e){var t=e.nodeName.toLowerCase();if(!Ji.hasOwnProperty(t))return this.sanitizedSomething=!0,!ir.hasOwnProperty(t);this.buf.push("<"),this.buf.push(t);for(var n,i=e.attributes,r=0;r<i.length;r++){var a=i.item(r),o=a.name,s=o.toLowerCase();if(nr.hasOwnProperty(s)){var l=a.value;er[s]&&(l=Gi(l)),tr[s]&&(n=l,l=(n=String(n)).split(",").map(function(e){return Gi(e.trim())}).join(", ")),this.buf.push(" ",o,'="',sr(l),'"')}else this.sanitizedSomething=!0}return this.buf.push(">"),!0}},{key:"endElement",value:function(e){var t=e.nodeName.toLowerCase();Ji.hasOwnProperty(t)&&!Xi.hasOwnProperty(t)&&(this.buf.push("</"),this.buf.push(t),this.buf.push(">"))}},{key:"chars",value:function(e){this.buf.push(sr(e))}},{key:"checkClobberedElement",value:function(e,t){if(t&&(e.compareDocumentPosition(t)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error("Failed to sanitize html because the element is clobbered: ".concat(e.outerHTML));return t}}]),e}(),ar=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,or=/([^\#-~ |!])/g;function sr(e){return e.replace(/&/g,"&amp;").replace(ar,function(e){return"&#"+(1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320)+65536)+";"}).replace(or,function(e){return"&#"+e.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}function lr(e,t){var n=null;try{qi=qi||function(e){var t=new Hi(e);return function(){try{return!!(new window.DOMParser).parseFromString(Mi(""),"text/html")}catch(e){return!1}}()?new Ui(t):t}(e);var i=t?String(t):"";n=qi.getInertBodyElement(i);var r=5,a=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=a,a=n.innerHTML,n=qi.getInertBodyElement(i)}while(i!==a);return Mi((new rr).sanitizeChildren(cr(n)||n))}finally{if(n)for(var o=cr(n)||n;o.firstChild;)o.removeChild(o.firstChild)}}function cr(e){return"content"in e&&function(e){return e.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===e.nodeName}(e)?e.content:null}var ur=function(e){return e[e.NONE=0]="NONE",e[e.HTML=1]="HTML",e[e.STYLE=2]="STYLE",e[e.SCRIPT=3]="SCRIPT",e[e.URL=4]="URL",e[e.RESOURCE_URL=5]="RESOURCE_URL",e}({});function hr(e){var t=fr();return t?Ai(t.sanitize(ur.HTML,e)||""):Bi(e,"HTML")?Ai(Li(e)):lr(Rt(),Oe(e))}function dr(e){var t=fr();return t?t.sanitize(ur.URL,e)||"":Bi(e,"URL")?Li(e):Gi(Oe(e))}function fr(){var e=$t();return e&&e[12]}function pr(e){return e.ngDebugContext}function gr(e){return e.ngOriginalError}function mr(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];e.error.apply(e,n)}var vr=function(){function e(){y(this,e),this._console=console}return k(e,[{key:"handleError",value:function(e){var t=this._findOriginalError(e),n=this._findContext(e),i=function(e){return e.ngErrorLogger||mr}(e);i(this._console,"ERROR",e),t&&i(this._console,"ORIGINAL ERROR",t),n&&i(this._console,"ERROR CONTEXT",n)}},{key:"_findContext",value:function(e){return e?pr(e)?pr(e):this._findContext(gr(e)):null}},{key:"_findOriginalError",value:function(e){for(var t=gr(e);t&&gr(t);)t=gr(t);return t}}]),e}();function yr(e,t){e.__ngContext__=t}var br=("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind($e);function kr(e){return e instanceof Function?e():e}var _r=function(e){return e[e.Important=1]="Important",e[e.DashCase=2]="DashCase",e}({});function wr(e,t){return(void 0)(e,t)}function xr(e){var t=e[3];return _t(t)?t[3]:t}function Cr(e){return Sr(e[13])}function Er(e){return Sr(e[4])}function Sr(e){for(;null!==e&&!_t(e);)e=e[4];return e}function Tr(e,t,n,i,r){if(null!=i){var a,o=!1;_t(i)?a=i:kt(i)&&(o=!0,i=i[0]);var s=zt(i);0===e&&null!==n?null==r?Fr(t,n,s):Rr(t,n,s,r||null,!0):1===e&&null!==n?Rr(t,n,s,r||null,!0):2===e?function(e,t,n){var i=zr(e,t);i&&function(e,t,n,i){Ft(e)?e.removeChild(t,n,i):t.removeChild(n)}(e,i,t,n)}(t,s,o):3===e&&t.destroyNode(s),null!=a&&function(e,t,n,i,r){var a=n[7];a!==zt(n)&&Tr(t,e,i,a,r);for(var o=10;o<n.length;o++){var s=n[o];Gr(s[1],s,e,t,i,a)}}(t,e,a,n,r)}}function Or(e,t,n){return Ft(e)?e.createElement(t,n):null===n?e.createElement(t):e.createElementNS(n,t)}function Ir(e,t){var n=e[9],i=n.indexOf(t),r=t[3];1024&t[2]&&(t[2]&=-1025,qt(r,-1)),n.splice(i,1)}function Mr(e,t){if(!(e.length<=10)){var n,i=10+t,r=e[i];if(r){var a=r[17];null!==a&&a!==e&&Ir(a,r),t>0&&(e[i-1][4]=r[4]);var o=hi(e,10+t);Gr(r[1],n=r,n[11],2,null,null),n[0]=null,n[6]=null;var s=o[19];null!==s&&s.detachView(o[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}}function Ar(e,t){if(!(256&t[2])){var n=t[11];Ft(n)&&n.destroyNode&&Gr(e,t,n,3,null,null),function(e){var t=e[13];if(!t)return Pr(e[1],e);for(;t;){var n=null;if(kt(t))n=t[13];else{var i=t[10];i&&(n=i)}if(!n){for(;t&&!t[4]&&t!==e;)kt(t)&&Pr(t[1],t),t=t[3];null===t&&(t=e),kt(t)&&Pr(t[1],t),n=t&&t[4]}t=n}}(t)}}function Pr(e,t){if(!(256&t[2])){t[2]&=-129,t[2]|=256,function(e,t){var n;if(null!=e&&null!=(n=e.destroyHooks))for(var i=0;i<n.length;i+=2){var r=t[n[i]];if(!(r instanceof Pn)){var a=n[i+1];if(Array.isArray(a))for(var o=0;o<a.length;o+=2)a[o+1].call(r[a[o]]);else a.call(r)}}}(e,t),function(e,t){var n=e.cleanup,i=t[7],r=-1;if(null!==n)for(var a=0;a<n.length-1;a+=2)if("string"==typeof n[a]){var o=n[a+1],s="function"==typeof o?o(t):zt(t[o]),l=i[r=n[a+2]],c=n[a+3];"boolean"==typeof c?s.removeEventListener(n[a],l,c):c>=0?i[r=c]():i[r=-c].unsubscribe(),a+=2}else{var u=i[r=n[a+1]];n[a].call(u)}if(null!==i){for(var h=r+1;h<i.length;h++)(0,i[h])();t[7]=null}}(e,t),1===t[1].type&&Ft(t[11])&&t[11].destroy();var n=t[17];if(null!==n&&_t(t[3])){n!==t[3]&&Ir(n,t);var i=t[19];null!==i&&i.detachView(e)}}}function Dr(e,t,n){return function(e,t,n){for(var i=t;null!==i&&40&i.type;)i=(t=i).parent;if(null===i)return n[0];if(2&i.flags){var r=e.data[i.directiveStart].encapsulation;if(r===Ze.None||r===Ze.Emulated)return null}return Bt(i,n)}(e,t.parent,n)}function Rr(e,t,n,i,r){Ft(e)?e.insertBefore(t,n,i,r):t.insertBefore(n,i,r)}function Fr(e,t,n){Ft(e)?e.appendChild(t,n):t.appendChild(n)}function Nr(e,t,n,i,r){null!==i?Rr(e,t,n,i,r):Fr(e,t,n)}function zr(e,t){return Ft(e)?e.parentNode(t):t.parentNode}function Lr(e,t,n){return Br(e,t,n)}var Br=function(e,t,n){return 40&e.type?Bt(e,n):null};function jr(e,t,n,i){var r=Dr(e,i,t),a=t[11],o=Lr(i.parent||t[6],i,t);if(null!=r)if(Array.isArray(n))for(var s=0;s<n.length;s++)Nr(a,r,n[s],o,!1);else Nr(a,r,n,o,!1)}function Ur(e,t){if(null!==t){var n=t.type;if(3&n)return Bt(t,e);if(4&n)return Vr(-1,e[t.index]);if(8&n){var i=t.child;if(null!==i)return Ur(e,i);var r=e[t.index];return _t(r)?Vr(-1,r):zt(r)}if(32&n)return wr(t,e)()||zt(e[t.index]);var a=Hr(e,t);return null!==a?Array.isArray(a)?a[0]:Ur(xr(e[16]),a):Ur(e,t.next)}return null}function Hr(e,t){return null!==t?e[16][6].projection[t.projection]:null}function Vr(e,t){var n=10+e+1;if(n<t.length){var i=t[n],r=i[1].firstChild;if(null!==r)return Ur(i,r)}return t[7]}function Wr(e,t,n,i,r,a,o){for(;null!=n;){var s=i[n.index],l=n.type;if(o&&0===t&&(s&&yr(zt(s),i),n.flags|=4),64!=(64&n.flags))if(8&l)Wr(e,t,n.child,i,r,a,!1),Tr(t,e,r,s,a);else if(32&l){for(var c=wr(n,i),u=void 0;u=c();)Tr(t,e,r,u,a);Tr(t,e,r,s,a)}else 16&l?Zr(e,t,i,n,r,a):Tr(t,e,r,s,a);n=o?n.projectionNext:n.next}}function Gr(e,t,n,i,r,a){Wr(n,i,e.firstChild,t,r,a,!1)}function Zr(e,t,n,i,r,a){var o=n[16],s=o[6].projection[i.projection];if(Array.isArray(s))for(var l=0;l<s.length;l++)Tr(t,e,r,s[l],a);else Wr(e,t,s,o[3],r,a,!0)}function Yr(e,t,n){Ft(e)?e.setAttribute(t,"style",n):t.style.cssText=n}function qr(e,t,n){Ft(e)?""===n?e.removeAttribute(t,"class"):e.setAttribute(t,"class",n):t.className=n}function Xr(e,t,n){for(var i=e.length;;){var r=e.indexOf(t,n);if(-1===r)return r;if(0===r||e.charCodeAt(r-1)<=32){var a=t.length;if(r+a===i||e.charCodeAt(r+a)<=32)return r}n=r+1}}function Kr(e,t,n){for(var i=0;i<e.length;){var r=e[i++];if(n&&"class"===r){if(-1!==Xr((r=e[i]).toLowerCase(),t,0))return!0}else if(1===r){for(;i<e.length&&"string"==typeof(r=e[i++]);)if(r.toLowerCase()===t)return!0;return!1}}return!1}function $r(e){return 4===e.type&&"ng-template"!==e.value}function Qr(e,t,n){return t===(4!==e.type||n?e.value:"ng-template")}function Jr(e,t,n){for(var i=4,r=e.attrs||[],a=function(e){for(var t=0;t<e.length;t++)if(3===(n=e[t])||4===n||6===n)return t;var n;return e.length}(r),o=!1,s=0;s<t.length;s++){var l=t[s];if("number"!=typeof l){if(!o)if(4&i){if(i=2|1&i,""!==l&&!Qr(e,l,n)||""===l&&1===t.length){if(ea(i))return!1;o=!0}}else{var c=8&i?l:t[++s];if(8&i&&null!==e.attrs){if(!Kr(e.attrs,c,n)){if(ea(i))return!1;o=!0}continue}var u=ta(8&i?"class":l,r,$r(e),n);if(-1===u){if(ea(i))return!1;o=!0;continue}if(""!==c){var h;h=u>a?"":r[u+1].toLowerCase();var d=8&i?h:null;if(d&&-1!==Xr(d,c,0)||2&i&&c!==h){if(ea(i))return!1;o=!0}}}}else{if(!o&&!ea(i)&&!ea(l))return!1;if(o&&ea(l))continue;o=!1,i=l|1&i}}return ea(i)||o}function ea(e){return 0==(1&e)}function ta(e,t,n,i){if(null===t)return-1;var r=0;if(i||!n){for(var a=!1;r<t.length;){var o=t[r];if(o===e)return r;if(3===o||6===o)a=!0;else{if(1===o||2===o){for(var s=t[++r];"string"==typeof s;)s=t[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=a?1:2}return-1}return function(e,t){var n=e.indexOf(4);if(n>-1)for(n++;n<e.length;){var i=e[n];if("number"==typeof i)return-1;if(i===t)return n;n++}return-1}(t,e)}function na(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=0;i<t.length;i++)if(Jr(e,t[i],n))return!0;return!1}function ia(e,t){e:for(var n=0;n<t.length;n++){var i=t[n];if(e.length===i.length){for(var r=0;r<e.length;r++)if(e[r]!==i[r])continue e;return!0}}return!1}function ra(e,t){return e?":not("+t.trim()+")":t}function aa(e){for(var t=e[0],n=1,i=2,r="",a=!1;n<e.length;){var o=e[n];if("string"==typeof o)if(2&i){var s=e[++n];r+="["+o+(s.length>0?'="'+s+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""===r||ea(o)||(t+=ra(a,r),r=""),i=o,a=a||!ea(i);n++}return""!==r&&(t+=ra(a,r)),t}var oa={};function sa(e){la(Qt(),$t(),xn()+e,on())}function la(e,t,n,i){if(!i)if(3==(3&t[2])){var r=e.preOrderCheckHooks;null!==r&&Tn(t,r,n)}else{var a=e.preOrderHooks;null!==a&&On(t,a,0,n)}Cn(n)}function ca(e,t){return e<<17|t<<2}function ua(e){return e>>17&32767}function ha(e){return 2|e}function da(e){return(131068&e)>>2}function fa(e,t){return-131069&e|t<<2}function pa(e){return 1|e}function ga(e,t){var n=e.contentQueries;if(null!==n)for(var i=0;i<n.length;i+=2){var r=n[i],a=n[i+1];if(-1!==a){var o=e.data[a];pn(r),o.contentQueries(2,t[a],a)}}}function ma(e,t,n,i,r,a,o,s,l,c){var u=t.blueprint.slice();return u[0]=r,u[2]=140|i,Yt(u),u[3]=u[15]=e,u[8]=n,u[10]=o||e&&e[10],u[11]=s||e&&e[11],u[12]=l||e&&e[12]||null,u[9]=c||e&&e[9]||null,u[6]=a,u[16]=2==t.type?e[16]:u,u}function va(e,t,n,i,r){var a,o,s=e.data[t];if(null===s)s=function(e,t,n,i,r){var a=tn(),o=rn(),s=e.data[t]=function(e,t,n,i,r,a){return{type:n,index:i,insertBeforeIndex:null,injectorIndex:t?t.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:a,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:t,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?a:a&&a.parent,n,t,i,r);return null===e.firstChild&&(e.firstChild=s),null!==a&&(o?null==a.child&&null!==s.parent&&(a.child=s):null===a.next&&(a.next=s)),s}(e,t,n,i,r),Xt.lFrame.inI18n&&(s.flags|=64);else if(64&s.type){s.type=n,s.value=i,s.attrs=r;var l=(a=Xt.lFrame,o=a.currentTNode,a.isParent?o:o.parent);s.injectorIndex=null===l?-1:l.injectorIndex}return nn(s,!0),s}function ya(e,t,n,i){if(0===n)return-1;for(var r=t.length,a=0;a<n;a++)t.push(i),e.blueprint.push(i),e.data.push(null);return r}function ba(e,t,n){vn(t);try{var i=e.viewQuery;null!==i&&Ka(1,i,n);var r=e.template;null!==r&&wa(e,t,r,1,n),e.firstCreatePass&&(e.firstCreatePass=!1),e.staticContentQueries&&ga(e,t),e.staticViewQueries&&Ka(2,e.viewQuery,n);var a=e.components;null!==a&&function(e,t){for(var n=0;n<t.length;n++)Ga(e,t[n])}(t,a)}catch(o){throw e.firstCreatePass&&(e.incompleteFirstPass=!0),o}finally{t[2]&=-5,wn()}}function ka(e,t,n,i){var r=t[2];if(256!=(256&r)){vn(t);var a=on();try{Yt(t),Xt.lFrame.bindingIndex=e.bindingStartIndex,null!==n&&wa(e,t,n,2,i);var o=3==(3&r);if(!a)if(o){var s=e.preOrderCheckHooks;null!==s&&Tn(t,s,null)}else{var l=e.preOrderHooks;null!==l&&On(t,l,0,null),In(t,0)}if(function(e){for(var t=Cr(e);null!==t;t=Er(t))if(t[2])for(var n=t[9],i=0;i<n.length;i++){var r=n[i],a=r[3];0==(1024&r[2])&&qt(a,1),r[2]|=1024}}(t),function(e){for(var t=Cr(e);null!==t;t=Er(t))for(var n=10;n<t.length;n++){var i=t[n],r=i[1];Gt(i)&&ka(r,i,r.template,i[8])}}(t),null!==e.contentQueries&&ga(e,t),!a)if(o){var c=e.contentCheckHooks;null!==c&&Tn(t,c)}else{var u=e.contentHooks;null!==u&&On(t,u,1),In(t,1)}!function(e,t){var n,i,r,a=e.hostBindingOpCodes;if(null!==a)try{for(var o=0;o<a.length;o++){var s=a[o];if(s<0)Cn(~s);else{var l=s,c=a[++o],u=a[++o];n=c,i=l,r=void 0,(r=Xt.lFrame).bindingIndex=r.bindingRootIndex=n,dn(i),u(2,t[l])}}}finally{Cn(-1)}}(e,t);var h=e.components;null!==h&&function(e,t){for(var n=0;n<t.length;n++)Va(e,t[n])}(t,h);var d=e.viewQuery;if(null!==d&&Ka(2,d,i),!a)if(o){var f=e.viewCheckHooks;null!==f&&Tn(t,f)}else{var p=e.viewHooks;null!==p&&On(t,p,2),In(t,2)}!0===e.firstUpdatePass&&(e.firstUpdatePass=!1),a||(t[2]&=-73),1024&t[2]&&(t[2]&=-1025,qt(t[3],-1))}finally{wn()}}}function _a(e,t,n,i){var r=t[10],a=!on(),o=Wt(t);try{a&&!o&&r.begin&&r.begin(),o&&ba(e,t,i),ka(e,t,n,i)}finally{a&&!o&&r.end&&r.end()}}function wa(e,t,n,i,r){var a=xn(),o=2&i;try{Cn(-1),o&&t.length>20&&la(e,t,20,on()),n(i,r)}finally{Cn(a)}}function xa(e,t,n){if(wt(t))for(var i=t.directiveEnd,r=t.directiveStart;r<i;r++){var a=e.data[r];a.contentQueries&&a.contentQueries(1,n[r],r)}}function Ca(e,t,n){Kt()&&(function(e,t,n,i){var r=n.directiveStart,a=n.directiveEnd;e.firstCreatePass||Vn(n,t),yr(i,t);for(var o=n.initialInputs,s=r;s<a;s++){var l=e.data[s],c=Et(l);c&&La(t,n,l);var u=ti(t,e,s,n);yr(u,t),null!==o&&ja(0,s-r,u,l,0,o),c&&(Ht(n.index,t)[8]=u)}}(e,t,n,Bt(n,t)),128==(128&n.flags)&&function(e,t,n){var i=n.directiveStart,r=n.directiveEnd,a=n.index,o=Xt.lFrame.currentDirectiveIndex;try{Cn(a);for(var s=i;s<r;s++){var l=e.data[s],c=t[s];dn(s),null===l.hostBindings&&0===l.hostVars&&null===l.hostAttrs||Da(l,c)}}finally{Cn(-1),dn(o)}}(e,t,n))}function Ea(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bt,i=t.localNames;if(null!==i)for(var r=t.index+1,a=0;a<i.length;a+=2){var o=i[a+1],s=-1===o?n(t,e):e[o];e[r++]=s}}function Sa(e){var t=e.tView;return null===t||t.incompleteFirstPass?e.tView=Ta(1,null,e.template,e.decls,e.vars,e.directiveDefs,e.pipeDefs,e.viewQuery,e.schemas,e.consts):t}function Ta(e,t,n,i,r,a,o,s,l,c){var u=20+i,h=u+r,d=function(e,t){for(var n=[],i=0;i<t;i++)n.push(i<e?null:oa);return n}(u,h),f="function"==typeof c?c():c;return d[1]={type:e,blueprint:d,template:n,queries:null,viewQuery:s,declTNode:t,data:d.slice().fill(null,u),bindingStartIndex:u,expandoStartIndex:h,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof a?a():a,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:l,consts:f,incompleteFirstPass:!1}}function Oa(e,t,n,i){var r=Qa(t);null===n?r.push(i):(r.push(n),e.firstCreatePass&&Ja(e).push(i,r.length-1))}function Ia(e,t,n){for(var i in e)if(e.hasOwnProperty(i)){var r=e[i];(n=null===n?{}:n).hasOwnProperty(i)?n[i].push(t,r):n[i]=[t,r]}return n}function Ma(e,t,n,i,r,a,o,s){var l,c=Bt(t,n),u=t.inputs;!s&&null!=u&&(l=u[i])?(to(e,n,l,i,r),xt(t)&&function(e,t){var n=Ht(t,e);16&n[2]||(n[2]|=64)}(n,t.index)):3&t.type&&(i=function(e){return"class"===e?"className":"for"===e?"htmlFor":"formaction"===e?"formAction":"innerHtml"===e?"innerHTML":"readonly"===e?"readOnly":"tabindex"===e?"tabIndex":e}(i),r=null!=o?o(r,t.value||"",i):r,Ft(a)?a.setProperty(c,i,r):Rn(i)||(c.setProperty?c.setProperty(i,r):c[i]=r))}function Aa(e,t,n,i){var r=!1;if(Kt()){var a=function(e,t,n){var i=e.directiveRegistry,r=null;if(i)for(var a=0;a<i.length;a++){var o=i[a];na(n,o.selectors,!1)&&(r||(r=[]),Yn(Vn(n,t),e,o.type),Et(o)?(Ra(e,n),r.unshift(o)):r.push(o))}return r}(e,t,n),o=null===i?null:{"":-1};if(null!==a){r=!0,Na(n,e.data.length,a.length);for(var s=0;s<a.length;s++){var l=a[s];l.providersResolver&&l.providersResolver(l)}for(var c=!1,u=!1,h=ya(e,t,a.length,null),d=0;d<a.length;d++){var f=a[d];n.mergedAttrs=Fn(n.mergedAttrs,f.hostAttrs),za(e,n,t,h,f),Fa(h,f,o),null!==f.contentQueries&&(n.flags|=8),null===f.hostBindings&&null===f.hostAttrs&&0===f.hostVars||(n.flags|=128);var p=f.type.prototype;!c&&(p.ngOnChanges||p.ngOnInit||p.ngDoCheck)&&((e.preOrderHooks||(e.preOrderHooks=[])).push(n.index),c=!0),u||!p.ngOnChanges&&!p.ngDoCheck||((e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(n.index),u=!0),h++}!function(e,t){for(var n=t.directiveEnd,i=e.data,r=t.attrs,a=[],o=null,s=null,l=t.directiveStart;l<n;l++){var c=i[l],u=c.inputs,h=null===r||$r(t)?null:Ua(u,r);a.push(h),o=Ia(u,l,o),s=Ia(c.outputs,l,s)}null!==o&&(o.hasOwnProperty("class")&&(t.flags|=16),o.hasOwnProperty("style")&&(t.flags|=32)),t.initialInputs=a,t.inputs=o,t.outputs=s}(e,n)}o&&function(e,t,n){if(t)for(var i=e.localNames=[],r=0;r<t.length;r+=2){var a=n[t[r+1]];if(null==a)throw new Te("301","Export of name '".concat(t[r+1],"' not found!"));i.push(t[r],a)}}(n,i,o)}return n.mergedAttrs=Fn(n.mergedAttrs,n.attrs),r}function Pa(e,t,n,i,r,a){var o=a.hostBindings;if(o){var s=e.hostBindingOpCodes;null===s&&(s=e.hostBindingOpCodes=[]);var l=~t.index;(function(e){for(var t=e.length;t>0;){var n=e[--t];if("number"==typeof n&&n<0)return n}return 0})(s)!=l&&s.push(l),s.push(i,r,o)}}function Da(e,t){null!==e.hostBindings&&e.hostBindings(1,t)}function Ra(e,t){t.flags|=2,(e.components||(e.components=[])).push(t.index)}function Fa(e,t,n){if(n){if(t.exportAs)for(var i=0;i<t.exportAs.length;i++)n[t.exportAs[i]]=e;Et(t)&&(n[""]=e)}}function Na(e,t,n){e.flags|=1,e.directiveStart=t,e.directiveEnd=t+n,e.providerIndexes=t}function za(e,t,n,i,r){e.data[i]=r;var a=r.factory||(r.factory=St(r.type)),o=new Pn(a,Et(r),null);e.blueprint[i]=o,n[i]=o,Pa(e,t,0,i,ya(e,n,r.hostVars,oa),r)}function La(e,t,n){var i=Bt(t,e),r=Sa(n),a=e[10],o=Za(e,ma(e,r,null,n.onPush?64:16,i,t,a,a.createRenderer(i,n),null,null));e[t.index]=o}function Ba(e,t,n,i,r,a){var o=Bt(e,t);!function(e,t,n,i,r,a,o){if(null==a)Ft(e)?e.removeAttribute(t,r,n):t.removeAttribute(r);else{var s=null==o?Oe(a):o(a,i||"",r);Ft(e)?e.setAttribute(t,r,s,n):n?t.setAttributeNS(n,r,s):t.setAttribute(r,s)}}(t[11],o,a,e.value,n,i,r)}function ja(e,t,n,i,r,a){var o=a[t];if(null!==o)for(var s=i.setInput,l=0;l<o.length;){var c=o[l++],u=o[l++],h=o[l++];null!==s?i.setInput(n,h,c,u):n[u]=h}}function Ua(e,t){for(var n=null,i=0;i<t.length;){var r=t[i];if(0!==r)if(5!==r){if("number"==typeof r)break;e.hasOwnProperty(r)&&(null===n&&(n=[]),n.push(r,e[r],t[i+1])),i+=2}else i+=2;else i+=4}return n}function Ha(e,t,n,i){return new Array(e,!0,!1,t,null,0,i,n,null,null)}function Va(e,t){var n=Ht(t,e);if(Gt(n)){var i=n[1];80&n[2]?ka(i,n,i.template,n[8]):n[5]>0&&Wa(n)}}function Wa(e){for(var t=Cr(e);null!==t;t=Er(t))for(var n=10;n<t.length;n++){var i=t[n];if(1024&i[2]){var r=i[1];ka(r,i,r.template,i[8])}else i[5]>0&&Wa(i)}var a=e[1].components;if(null!==a)for(var o=0;o<a.length;o++){var s=Ht(a[o],e);Gt(s)&&s[5]>0&&Wa(s)}}function Ga(e,t){var n=Ht(t,e),i=n[1];!function(e,t){for(var n=t.length;n<e.blueprint.length;n++)t.push(e.blueprint[n])}(i,n),ba(i,n,n[8])}function Za(e,t){return e[13]?e[14][4]=t:e[13]=t,e[14]=t,t}function Ya(e){for(;e;){e[2]|=64;var t=xr(e);if(0!=(512&e[2])&&!t)return e;e=t}return null}function qa(e,t,n){var i=t[10];i.begin&&i.begin();try{ka(e,t,e.template,n)}catch(r){throw eo(t,r),r}finally{i.end&&i.end()}}function Xa(e){!function(e){for(var t=0;t<e.components.length;t++){var n=e.components[t],i=Vt(n),r=i[1];_a(r,i,r.template,n)}}(e[8])}function Ka(e,t,n){pn(0),t(e,n)}var $a=Promise.resolve(null);function Qa(e){return e[7]||(e[7]=[])}function Ja(e){return e.cleanup||(e.cleanup=[])}function eo(e,t){var n=e[9],i=n?n.get(vr,null):null;i&&i.handleError(t)}function to(e,t,n,i,r){for(var a=0;a<n.length;){var o=n[a++],s=n[a++],l=t[o],c=e.data[o];null!==c.setInput?c.setInput(l,r,i,s):l[s]=r}}function no(e,t,n){var i=Lt(t,e);!function(e,t,n){Ft(e)?e.setValue(t,n):t.textContent=n}(e[11],i,n)}function io(e,t,n){var i=n?e.styles:null,r=n?e.classes:null,a=0;if(null!==t)for(var o=0;o<t.length;o++){var s=t[o];"number"==typeof s?a=s:1==a?r=we(r,s):2==a&&(i=we(i,s+": "+t[++o]+";"))}n?e.styles=i:e.stylesWithoutHost=i,n?e.classes=r:e.classesWithoutHost=r}var ro,ao=new si("INJECTOR",-1),oo=function(){function e(){y(this,e)}return k(e,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vi;if(t===vi){var n=new Error("NullInjectorError: No provider for ".concat(_e(e),"!"));throw n.name="NullInjectorError",n}return t}}]),e}(),so=new si("Set Injector scope."),lo={},co={},uo=[];function ho(){return void 0===ro&&(ro=new oo),ro}function fo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0;return new po(e,n,t||ho(),i)}var po=function(){function e(t,n,i){var r=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;y(this,e),this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;var o=[];n&&ci(n,function(e){return r.processProvider(e,t,n)}),ci([t],function(e){return r.processInjectorType(e,[],o)}),this.records.set(ao,vo(void 0,this));var s=this.records.get(so);this.scope=null!=s?s.value:null,this.source=a||("object"==typeof t?null:_e(t))}return k(e,[{key:"destroyed",get:function(){return this._destroyed}},{key:"destroy",value:function(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(function(e){return e.ngOnDestroy()})}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:vi,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ue.Default;this.assertNotDestroyed();var i,r=ki(this);try{if(!(n&Ue.SkipSelf)){var a=this.records.get(e);if(void 0===a){var o=("function"==typeof(i=e)||"object"==typeof i&&i instanceof si)&&De(e);a=o&&this.injectableDefInScope(o)?vo(go(e),lo):null,this.records.set(e,a)}if(null!=a)return this.hydrate(e,a)}return(n&Ue.Self?ho():this.parent).get(e,t=n&Ue.Optional&&t===vi?null:t)}catch(s){if("NullInjectorError"===s.name){if((s.ngTempTokenPath=s.ngTempTokenPath||[]).unshift(_e(e)),r)throw s;return function(e,t,n,i){var r=e.ngTempTokenPath;throw t.__source&&r.unshift(t.__source),e.message=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e=e&&"\n"===e.charAt(0)&&"\u0275"==e.charAt(1)?e.substr(2):e;var r=_e(t);if(Array.isArray(t))r=t.map(_e).join(" -> ");else if("object"==typeof t){var a=[];for(var o in t)if(t.hasOwnProperty(o)){var s=t[o];a.push(o+":"+("string"==typeof s?JSON.stringify(s):_e(s)))}r="{".concat(a.join(", "),"}")}return"".concat(n).concat(i?"("+i+")":"","[").concat(r,"]: ").concat(e.replace(yi,"\n  "))}("\n"+e.message,r,"R3InjectorError",i),e.ngTokenPath=r,e.ngTempTokenPath=null,e}(s,e,0,this.source)}throw s}finally{ki(r)}}},{key:"_resolveInjectorDefTypes",value:function(){var e=this;this.injectorDefTypes.forEach(function(t){return e.get(t)})}},{key:"toString",value:function(){var e=[];return this.records.forEach(function(t,n){return e.push(_e(n))}),"R3Injector[".concat(e.join(", "),"]")}},{key:"assertNotDestroyed",value:function(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}},{key:"processInjectorType",value:function(e,t,n){var i=this;if(!(e=Ee(e)))return!1;var r=Fe(e),a=null==r&&e.ngModule||void 0,o=void 0===a?e:a,s=-1!==n.indexOf(o);if(void 0!==a&&(r=Fe(a)),null==r)return!1;if(null!=r.imports&&!s){var l;n.push(o);try{ci(r.imports,function(e){i.processInjectorType(e,t,n)&&(void 0===l&&(l=[]),l.push(e))})}finally{}if(void 0!==l)for(var c=function(e){var t=l[e],n=t.ngModule,r=t.providers;ci(r,function(e){return i.processProvider(e,n,r||uo)})},u=0;u<l.length;u++)c(u)}this.injectorDefTypes.add(o);var h=St(o)||function(){return new o};this.records.set(o,vo(h,lo));var d=r.providers;if(null!=d&&!s){var f=e;ci(d,function(e){return i.processProvider(e,f,d)})}return void 0!==a&&void 0!==e.providers}},{key:"processProvider",value:function(e,t,n){var i=bo(e=Ee(e))?e:Ee(e&&e.provide),r=function(e,t,n){return yo(e)?vo(void 0,e.useValue):vo(mo(e),lo)}(e);if(bo(e)||!0!==e.multi)this.records.get(i);else{var a=this.records.get(i);a||((a=vo(void 0,lo,!0)).factory=function(){return xi(a.multi)},this.records.set(i,a)),i=e,a.multi.push(e)}this.records.set(i,r)}},{key:"hydrate",value:function(e,t){var n;return t.value===lo&&(t.value=co,t.value=t.factory()),"object"==typeof t.value&&t.value&&null!==(n=t.value)&&"object"==typeof n&&"function"==typeof n.ngOnDestroy&&this.onDestroy.add(t.value),t.value}},{key:"injectableDefInScope",value:function(e){return!!e.providedIn&&("string"==typeof e.providedIn?"any"===e.providedIn||e.providedIn===this.scope:this.injectorDefTypes.has(e.providedIn))}}]),e}();function go(e){var t=De(e),n=null!==t?t.factory:St(e);if(null!==n)return n;if(e instanceof si)throw new Error("Token ".concat(_e(e)," is missing a \u0275prov definition."));if(e instanceof Function)return function(e){var t=e.length;if(t>0){var n=di(t,"?");throw new Error("Can't resolve all parameters for ".concat(_e(e),": (").concat(n.join(", "),")."))}var i=function(e){var t=e&&(e[ze]||e[Be]);if(t){var n=function(e){if(e.hasOwnProperty("name"))return e.name;var t=(""+e).match(/^function\s*([^\s(]+)/);return null===t?"":t[1]}(e);return console.warn('DEPRECATED: DI is instantiating a token "'.concat(n,'" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "').concat(n,'" class.')),t}return null}(e);return null!==i?function(){return i.factory(e)}:function(){return new e}}(e);throw new Error("unreachable")}function mo(e,t,n){var r,a;if(bo(e)){var o=Ee(e);return St(o)||go(o)}if(yo(e))r=function(){return Ee(e.useValue)};else if((a=e)&&a.useFactory)r=function(){return e.useFactory.apply(e,i(xi(e.deps||[])))};else if(function(e){return!(!e||!e.useExisting)}(e))r=function(){return wi(Ee(e.useExisting))};else{var s=Ee(e&&(e.useClass||e.provide));if(!function(e){return!!e.deps}(e))return St(s)||go(s);r=function(){return c(s,i(xi(e.deps)))}}return r}function vo(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{factory:e,value:t,multi:n?[]:void 0}}function yo(e){return null!==e&&"object"==typeof e&&bi in e}function bo(e){return"function"==typeof e}var ko=function(e,t,n){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3?arguments[3]:void 0,r=fo(e,t,n,i);return r._resolveInjectorDefTypes(),r}({name:n},t,e,n)},_o=function(){var e=function(){function e(){y(this,e)}return k(e,null,[{key:"create",value:function(e,t){return Array.isArray(e)?ko(e,t,""):ko(e.providers,e.parent,e.name||"")}}]),e}();return e.THROW_IF_NOT_FOUND=vi,e.NULL=new oo,e.\u0275prov=Ae({token:e,providedIn:"any",factory:function(){return wi(ao)}}),e.__NG_ELEMENT_ID__=-1,e}();function wo(e,t){Sn(Vt(e)[1],en())}function xo(e){for(var t=Object.getPrototypeOf(e.type.prototype).constructor,n=!0,i=[e];t;){var r=void 0;if(Et(e))r=t.\u0275cmp||t.\u0275dir;else{if(t.\u0275cmp)throw new Error("Directives cannot inherit Components");r=t.\u0275dir}if(r){if(n){i.push(r);var a=e;a.inputs=Co(e.inputs),a.declaredInputs=Co(e.declaredInputs),a.outputs=Co(e.outputs);var o=r.hostBindings;o&&To(e,o);var s=r.viewQuery,l=r.contentQueries;if(s&&Eo(e,s),l&&So(e,l),ke(e.inputs,r.inputs),ke(e.declaredInputs,r.declaredInputs),ke(e.outputs,r.outputs),Et(r)&&r.data.animation){var c=e.data;c.animation=(c.animation||[]).concat(r.data.animation)}}var u=r.features;if(u)for(var h=0;h<u.length;h++){var d=u[h];d&&d.ngInherit&&d(e),d===xo&&(n=!1)}}t=Object.getPrototypeOf(t)}!function(e){for(var t=0,n=null,i=e.length-1;i>=0;i--){var r=e[i];r.hostVars=t+=r.hostVars,r.hostAttrs=Fn(r.hostAttrs,n=Fn(n,r.hostAttrs))}}(i)}function Co(e){return e===Qe?{}:e===et?[]:e}function Eo(e,t){var n=e.viewQuery;e.viewQuery=n?function(e,i){t(e,i),n(e,i)}:t}function So(e,t){var n=e.contentQueries;e.contentQueries=n?function(e,i,r){t(e,i,r),n(e,i,r)}:t}function To(e,t){var n=e.hostBindings;e.hostBindings=n?function(e,i){t(e,i),n(e,i)}:t}var Oo=null;function Io(){if(!Oo){var e=$e.Symbol;if(e&&e.iterator)Oo=e.iterator;else for(var t=Object.getOwnPropertyNames(Map.prototype),n=0;n<t.length;++n){var i=t[n];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(Oo=i)}}return Oo}var Mo=function(){function e(t){y(this,e),this.wrapped=t}return k(e,null,[{key:"wrap",value:function(t){return new e(t)}},{key:"unwrap",value:function(t){return e.isWrapped(t)?t.wrapped:t}},{key:"isWrapped",value:function(t){return t instanceof e}}]),e}();function Ao(e){return!!Po(e)&&(Array.isArray(e)||!(e instanceof Map)&&Io()in e)}function Po(e){return null!==e&&("function"==typeof e||"object"==typeof e)}function Do(e,t,n){return e[t]=n}function Ro(e,t){return e[t]}function Fo(e,t,n){return!Object.is(e[t],n)&&(e[t]=n,!0)}function No(e,t,n,i){var r=Fo(e,t,n);return Fo(e,t+1,i)||r}function zo(e,t,n,i,r,a){var o=No(e,t,n,i);return No(e,t+2,r,a)||o}function Lo(e,t,n,i){var r=$t();return Fo(r,un(),t)&&(Qt(),Ba(En(),r,e,t,n,i)),Lo}function Bo(e,t,n,i){return Fo(e,un(),n)?t+Oe(n)+i:oa}function jo(e,t,n,i,r,a){var o=$t(),s=Bo(o,t,n,i);return s!==oa&&Ba(En(),o,e,s,r,a),jo}function Uo(e,t,n,i,r,a,o,s){var l=$t(),c=Qt(),u=e+20,h=c.firstCreatePass?function(e,t,n,i,r,a,o,s,l){var c=t.consts,u=va(t,e,4,o||null,Zt(c,s));Aa(t,n,u,Zt(c,l)),Sn(t,u);var h=u.tViews=Ta(2,u,i,r,a,t.directiveRegistry,t.pipeRegistry,null,t.schemas,c);return null!==t.queries&&(t.queries.template(t,u),h.queries=t.queries.embeddedTView(u)),u}(u,c,l,t,n,i,r,a,o):c.data[u];nn(h,!1);var d=l[11].createComment("");jr(c,l,d,h),yr(d,l),Za(l,l[u]=Ha(d,l,d,h)),Ct(h)&&Ca(c,l,h),null!=o&&Ea(l,h,s)}function Ho(e){return Ut(Xt.lFrame.contextLView,20+e)}function Vo(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ue.Default,n=$t();return null===n?wi(e,t):Kn(en(),n,Ee(e),t)}function Wo(e,t,n){var i=$t();return Fo(i,un(),t)&&Ma(Qt(),En(),i,e,t,i[11],n,!1),Wo}function Go(e,t,n,i,r){var a=r?"class":"style";to(e,n,t.inputs[a],a,i)}function Zo(e,t,n,i){var r=$t(),a=Qt(),o=20+e,s=r[11],l=r[o]=Or(s,t,Xt.lFrame.currentNamespace),c=a.firstCreatePass?function(e,t,n,i,r,a,o){var s=t.consts,l=va(t,e,2,r,Zt(s,a));return Aa(t,n,l,Zt(s,o)),null!==l.attrs&&io(l,l.attrs,!1),null!==l.mergedAttrs&&io(l,l.mergedAttrs,!0),null!==t.queries&&t.queries.elementStart(t,l),l}(o,a,r,0,t,n,i):a.data[o];nn(c,!0);var u=c.mergedAttrs;null!==u&&Dn(s,l,u);var h=c.classes;null!==h&&qr(s,l,h);var d=c.styles;null!==d&&Yr(s,l,d),64!=(64&c.flags)&&jr(a,r,l,c),0===Xt.lFrame.elementDepthCount&&yr(l,r),Xt.lFrame.elementDepthCount++,Ct(c)&&(Ca(a,r,c),xa(a,c,r)),null!==i&&Ea(r,c)}function Yo(){var e=en();rn()?an():nn(e=e.parent,!1);var t=e;Xt.lFrame.elementDepthCount--;var n=Qt();n.firstCreatePass&&(Sn(n,e),wt(e)&&n.queries.elementEnd(e)),null!=t.classesWithoutHost&&function(e){return 0!=(16&e.flags)}(t)&&Go(n,t,$t(),t.classesWithoutHost,!0),null!=t.stylesWithoutHost&&function(e){return 0!=(32&e.flags)}(t)&&Go(n,t,$t(),t.stylesWithoutHost,!1)}function qo(e,t,n,i){Zo(e,t,n,i),Yo()}function Xo(e,t,n){var i=$t(),r=Qt(),a=e+20,o=r.firstCreatePass?function(e,t,n,i,r){var a=t.consts,o=Zt(a,i),s=va(t,e,8,"ng-container",o);return null!==o&&io(s,o,!0),Aa(t,n,s,Zt(a,r)),null!==t.queries&&t.queries.elementStart(t,s),s}(a,r,i,t,n):r.data[a];nn(o,!0);var s=i[a]=i[11].createComment("");jr(r,i,s,o),yr(s,i),Ct(o)&&(Ca(r,i,o),xa(r,o,i)),null!=n&&Ea(i,o)}function Ko(){var e=en(),t=Qt();rn()?an():nn(e=e.parent,!1),t.firstCreatePass&&(Sn(t,e),wt(e)&&t.queries.elementEnd(e))}function $o(e,t,n){Xo(e,t,n),Ko()}function Qo(){return $t()}function Jo(e){return!!e&&"function"==typeof e.then}function es(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3?arguments[3]:void 0,r=$t(),a=Qt(),o=en();return function(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7?arguments[7]:void 0,l=Ct(i),c=e.firstCreatePass&&Ja(e),u=Qa(t),h=!0;if(3&i.type){var d=Bt(i,t),f=s?s(d):Qe,p=f.target||d,g=u.length,m=s?function(e){return s(zt(e[i.index])).target}:i.index;if(Ft(n)){var v=null;if(!s&&l&&(v=function(e,t,n,i){var r=e.cleanup;if(null!=r)for(var a=0;a<r.length-1;a+=2){var o=r[a];if(o===n&&r[a+1]===i){var s=t[7],l=r[a+2];return s.length>l?s[l]:null}"string"==typeof o&&(a+=2)}return null}(e,t,r,i.index)),null!==v)(v.__ngLastListenerFn__||v).__ngNextListenerFn__=a,v.__ngLastListenerFn__=a,h=!1;else{a=ns(i,t,0,a,!1);var y=n.listen(f.name||p,r,a);u.push(a,y),c&&c.push(r,m,g,g+1)}}else a=ns(i,t,0,a,!0),p.addEventListener(r,a,o),u.push(a),c&&c.push(r,m,g,o)}else a=ns(i,t,0,a,!1);var b,k=i.outputs;if(h&&null!==k&&(b=k[r])){var _=b.length;if(_)for(var w=0;w<_;w+=2){var x=t[b[w]][b[w+1]].subscribe(a),C=u.length;u.push(a,x),c&&c.push(r,i.index,C,-(C+1))}}}(a,r,r[11],o,e,t,n,i),es}function ts(e,t,n,i){try{return!1!==n(i)}catch(r){return eo(e,r),!1}}function ns(e,t,n,i,r){return function n(a){if(a===Function)return i;var o=2&e.flags?Ht(e.index,t):t;0==(32&t[2])&&Ya(o);for(var s=ts(t,0,i,a),l=n.__ngNextListenerFn__;l;)s=ts(t,0,l,a)&&s,l=l.__ngNextListenerFn__;return r&&!1===s&&(a.preventDefault(),a.returnValue=!1),s}}function is(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return function(e){return(Xt.lFrame.contextLView=function(e,t){for(;e>0;)t=t[15],e--;return t}(e,Xt.lFrame.contextLView))[8]}(e)}function rs(e,t){for(var n=null,i=function(e){var t=e.attrs;if(null!=t){var n=t.indexOf(5);if(0==(1&n))return t[n+1]}return null}(e),r=0;r<t.length;r++){var a=t[r];if("*"!==a){if(null===i?na(e,a,!0):ia(i,a))return r}else n=r}return n}function as(e){var t=$t()[16][6];if(!t.projection)for(var n=t.projection=di(e?e.length:1,null),i=n.slice(),r=t.child;null!==r;){var a=e?rs(r,e):0;null!==a&&(i[a]?i[a].projectionNext=r:n[a]=r,i[a]=r),r=r.next}}function os(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,i=$t(),r=Qt(),a=va(r,20+e,16,null,n||null);null===a.projection&&(a.projection=t),an(),64!=(64&a.flags)&&function(e,t,n){Zr(t[11],0,t,n,Dr(e,n,t),Lr(n.parent||t[6],n,t))}(r,i,a)}function ss(e,t,n){return ls(e,"",t,"",n),ss}function ls(e,t,n,i,r){var a=$t(),o=Bo(a,t,n,i);return o!==oa&&Ma(Qt(),En(),a,e,o,a[11],r,!1),ls}function cs(e,t,n,i,r){for(var a=e[n+1],o=null===t,s=i?ua(a):da(a),l=!1;0!==s&&(!1===l||o);){var c=e[s+1];us(e[s],t)&&(l=!0,e[s+1]=i?pa(c):ha(c)),s=i?ua(c):da(c)}l&&(e[n+1]=i?ha(a):pa(a))}function us(e,t){return null===e||null==t||(Array.isArray(e)?e[1]:e)===t||!(!Array.isArray(e)||"string"!=typeof t)&&gi(e,t)>=0}var hs={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function ds(e){return e.substring(hs.key,hs.keyEnd)}function fs(e){return e.substring(hs.value,hs.valueEnd)}function ps(e,t){var n=hs.textEnd;return n===t?-1:(t=hs.keyEnd=function(e,t,n){for(;t<n&&e.charCodeAt(t)>32;)t++;return t}(e,hs.key=t,n),vs(e,t,n))}function gs(e,t){var n=hs.textEnd,i=hs.key=vs(e,t,n);return n===i?-1:(i=hs.keyEnd=function(e,t,n){for(var i;t<n&&(45===(i=e.charCodeAt(t))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)t++;return t}(e,i,n),i=ys(e,i,n),i=hs.value=vs(e,i,n),i=hs.valueEnd=function(e,t,n){for(var i=-1,r=-1,a=-1,o=t,s=o;o<n;){var l=e.charCodeAt(o++);if(59===l)return s;34===l||39===l?s=o=bs(e,l,o,n):t===o-4&&85===a&&82===r&&76===i&&40===l?s=o=bs(e,41,o,n):l>32&&(s=o),a=r,r=i,i=-33&l}return s}(e,i,n),ys(e,i,n))}function ms(e){hs.key=0,hs.keyEnd=0,hs.value=0,hs.valueEnd=0,hs.textEnd=e.length}function vs(e,t,n){for(;t<n&&e.charCodeAt(t)<=32;)t++;return t}function ys(e,t,n,i){return(t=vs(e,t,n))<n&&t++,t}function bs(e,t,n,i){for(var r=-1,a=n;a<i;){var o=e.charCodeAt(a++);if(o==t&&92!==r)return a;r=92==o&&92===r?0:o}throw new Error}function ks(e,t,n){return Ss(e,t,n,!1),ks}function _s(e,t){return Ss(e,t,null,!0),_s}function ws(e){Ts(Ps,xs,e,!1)}function xs(e,t){for(var n=function(e){return ms(e),gs(e,vs(e,0,hs.textEnd))}(t);n>=0;n=gs(t,n))Ps(e,ds(t),fs(t))}function Cs(e){Ts(fi,Es,e,!0)}function Es(e,t){for(var n=function(e){return ms(e),ps(e,vs(e,0,hs.textEnd))}(t);n>=0;n=ps(t,n))fi(e,ds(t),!0)}function Ss(e,t,n,i){var r=$t(),a=Qt(),o=hn(2);a.firstUpdatePass&&Is(a,e,o,i),t!==oa&&Fo(r,o,t)&&Ds(a,a.data[xn()],r,r[11],e,r[o+1]=function(e,t){return null==e||("string"==typeof t?e+=t:"object"==typeof e&&(e=_e(Li(e)))),e}(t,n),i,o)}function Ts(e,t,n,i){var r=Qt(),a=hn(2);r.firstUpdatePass&&Is(r,null,a,i);var o=$t();if(n!==oa&&Fo(o,a,n)){var s=r.data[xn()];if(Ns(s,i)&&!Os(r,a)){var l=i?s.classesWithoutHost:s.stylesWithoutHost;null!==l&&(n=we(l,n||"")),Go(r,s,o,n,i)}else!function(e,t,n,i,r,a,o,s){r===oa&&(r=Je);for(var l=0,c=0,u=0<r.length?r[0]:null,h=0<a.length?a[0]:null;null!==u||null!==h;){var d=l<r.length?r[l+1]:void 0,f=c<a.length?a[c+1]:void 0,p=void 0,g=null;u===h?(l+=2,c+=2,d!==f&&(g=h,p=f)):null===h||null!==u&&u<h?(l+=2,g=u):(c+=2,g=h,p=f),null!==g&&Ds(e,t,n,i,g,p,o,s),u=l<r.length?r[l]:null,h=c<a.length?a[c]:null}}(r,s,o,o[11],o[a+1],o[a+1]=function(e,t,n){if(null==n||""===n)return Je;var i=[],r=Li(n);if(Array.isArray(r))for(var a=0;a<r.length;a++)e(i,r[a],!0);else if("object"==typeof r)for(var o in r)r.hasOwnProperty(o)&&e(i,o,r[o]);else"string"==typeof r&&t(i,r);return i}(e,t,n),i,a)}}function Os(e,t){return t>=e.expandoStartIndex}function Is(e,t,n,i){var r=e.data;if(null===r[n+1]){var a=r[xn()],o=Os(e,n);Ns(a,i)&&null===t&&!o&&(t=!1),t=function(e,t,n,i){var r=function(e){var t=Xt.lFrame.currentDirectiveIndex;return-1===t?null:e[t]}(e),a=i?t.residualClasses:t.residualStyles;if(null===r)0===(i?t.classBindings:t.styleBindings)&&(n=As(n=Ms(null,e,t,n,i),t.attrs,i),a=null);else{var o=t.directiveStylingLast;if(-1===o||e[o]!==r)if(n=Ms(r,e,t,n,i),null===a){var s=function(e,t,n){var i=n?t.classBindings:t.styleBindings;if(0!==da(i))return e[ua(i)]}(e,t,i);void 0!==s&&Array.isArray(s)&&function(e,t,n,i){e[ua(n?t.classBindings:t.styleBindings)]=i}(e,t,i,s=As(s=Ms(null,e,t,s[1],i),t.attrs,i))}else a=function(e,t,n){for(var i,r=t.directiveEnd,a=1+t.directiveStylingLast;a<r;a++)i=As(i,e[a].hostAttrs,n);return As(i,t.attrs,n)}(e,t,i)}return void 0!==a&&(i?t.residualClasses=a:t.residualStyles=a),n}(r,a,t,i),function(e,t,n,i,r,a){var o=a?t.classBindings:t.styleBindings,s=ua(o),l=da(o);e[i]=n;var c,u=!1;if(Array.isArray(n)){var h=n;(null===(c=h[1])||gi(h,c)>0)&&(u=!0)}else c=n;if(r)if(0!==l){var d=ua(e[s+1]);e[i+1]=ca(d,s),0!==d&&(e[d+1]=fa(e[d+1],i)),e[s+1]=131071&e[s+1]|i<<17}else e[i+1]=ca(s,0),0!==s&&(e[s+1]=fa(e[s+1],i)),s=i;else e[i+1]=ca(l,0),0===s?s=i:e[l+1]=fa(e[l+1],i),l=i;u&&(e[i+1]=ha(e[i+1])),cs(e,c,i,!0),cs(e,c,i,!1),function(e,t,n,i,r){var a=r?e.residualClasses:e.residualStyles;null!=a&&"string"==typeof t&&gi(a,t)>=0&&(n[i+1]=pa(n[i+1]))}(t,c,e,i,a),o=ca(s,l),a?t.classBindings=o:t.styleBindings=o}(r,a,t,n,o,i)}}function Ms(e,t,n,i,r){var a=null,o=n.directiveEnd,s=n.directiveStylingLast;for(-1===s?s=n.directiveStart:s++;s<o&&(i=As(i,(a=t[s]).hostAttrs,r),a!==e);)s++;return null!==e&&(n.directiveStylingLast=s),i}function As(e,t,n){var i=n?1:2,r=-1;if(null!==t)for(var a=0;a<t.length;a++){var o=t[a];"number"==typeof o?r=o:r===i&&(Array.isArray(e)||(e=void 0===e?[]:["",e]),fi(e,o,!!n||t[++a]))}return void 0===e?null:e}function Ps(e,t,n){fi(e,t,Li(n))}function Ds(e,t,n,i,r,a,o,s){if(3&t.type){var l=e.data,c=l[s+1];Fs(1==(1&c)?Rs(l,t,n,r,da(c),o):void 0)||(Fs(a)||2==(2&c)&&(a=Rs(l,null,n,r,s,o)),function(e,t,n,i,r){var a=Ft(e);if(t)r?a?e.addClass(n,i):n.classList.add(i):a?e.removeClass(n,i):n.classList.remove(i);else{var o=-1===i.indexOf("-")?void 0:_r.DashCase;if(null==r)a?e.removeStyle(n,i,o):n.style.removeProperty(i);else{var s="string"==typeof r&&r.endsWith("!important");s&&(r=r.slice(0,-10),o|=_r.Important),a?e.setStyle(n,i,r,o):n.style.setProperty(i,r,s?"important":"")}}}(i,o,Lt(xn(),n),r,a))}}function Rs(e,t,n,i,r,a){for(var o,s=null===t;r>0;){var l=e[r],c=Array.isArray(l),u=c?l[1]:l,h=null===u,d=n[r+1];d===oa&&(d=h?Je:void 0);var f=h?pi(d,i):u===i?d:void 0;if(c&&!Fs(f)&&(f=pi(l,i)),Fs(f)&&(o=f,s))return o;var p=e[r+1];r=s?ua(p):da(p)}if(null!==t){var g=a?t.residualClasses:t.residualStyles;null!=g&&(o=pi(g,i))}return o}function Fs(e){return void 0!==e}function Ns(e,t){return 0!=(e.flags&(t?16:32))}function zs(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=$t(),i=Qt(),r=e+20,a=i.firstCreatePass?va(i,r,1,t,null):i.data[r],o=n[r]=function(e,t){return Ft(e)?e.createText(t):e.createTextNode(t)}(n[11],t);jr(i,n,o,a),nn(a,!1)}function Ls(e){return Bs("",e,""),Ls}function Bs(e,t,n){var i=$t(),r=Bo(i,e,t,n);return r!==oa&&no(i,xn(),r),Bs}function js(e,t,n,i,r){var a=$t(),o=function(e,t,n,i,r,a){var o=No(e,cn(),n,r);return hn(2),o?t+Oe(n)+i+Oe(r)+a:oa}(a,e,t,n,i,r);return o!==oa&&no(a,xn(),o),js}var Us=void 0,Hs=["en",[["a","p"],["AM","PM"],Us],[["AM","PM"],Us,Us],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Us,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Us,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Us,"{1} 'at' {0}",Us],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(e){var t=Math.floor(Math.abs(e)),n=e.toString().replace(/^[^.]*\.?/,"").length;return 1===t&&0===n?1:5}],Vs={};function Ws(e){var t=function(e){return e.toLowerCase().replace(/_/g,"-")}(e),n=Gs(t);if(n)return n;var i=t.split("-")[0];if(n=Gs(i))return n;if("en"===i)return Hs;throw new Error('Missing locale data for the locale "'.concat(e,'".'))}function Gs(e){return e in Vs||(Vs[e]=$e.ng&&$e.ng.common&&$e.ng.common.locales&&$e.ng.common.locales[e]),Vs[e]}var Zs=function(e){return e[e.LocaleId=0]="LocaleId",e[e.DayPeriodsFormat=1]="DayPeriodsFormat",e[e.DayPeriodsStandalone=2]="DayPeriodsStandalone",e[e.DaysFormat=3]="DaysFormat",e[e.DaysStandalone=4]="DaysStandalone",e[e.MonthsFormat=5]="MonthsFormat",e[e.MonthsStandalone=6]="MonthsStandalone",e[e.Eras=7]="Eras",e[e.FirstDayOfWeek=8]="FirstDayOfWeek",e[e.WeekendRange=9]="WeekendRange",e[e.DateFormat=10]="DateFormat",e[e.TimeFormat=11]="TimeFormat",e[e.DateTimeFormat=12]="DateTimeFormat",e[e.NumberSymbols=13]="NumberSymbols",e[e.NumberFormats=14]="NumberFormats",e[e.CurrencyCode=15]="CurrencyCode",e[e.CurrencySymbol=16]="CurrencySymbol",e[e.CurrencyName=17]="CurrencyName",e[e.Currencies=18]="Currencies",e[e.Directionality=19]="Directionality",e[e.PluralCase=20]="PluralCase",e[e.ExtraData=21]="ExtraData",e}({});function Ys(e){var t;null==(t=e)&&function(e,t,n,i){throw new Error("ASSERTION ERROR: ".concat("Expected localeId to be defined"," [Expected=> null != ").concat(t," <=Actual]"))}(0,t),"string"==typeof e&&e.toLowerCase().replace(/_/g,"-")}function qs(e,t,n,i,r){if(e=Ee(e),Array.isArray(e))for(var a=0;a<e.length;a++)qs(e[a],t,n,i,r);else{var o=Qt(),s=$t(),l=bo(e)?e:Ee(e.provide),c=mo(e),u=en(),h=1048575&u.providerIndexes,d=u.directiveStart,f=u.providerIndexes>>20;if(bo(e)||!e.multi){var p=new Pn(c,r,Vo),g=$s(l,t,r?h:h+f,d);-1===g?(Yn(Vn(u,s),o,l),Xs(o,e,t.length),t.push(l),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(p),s.push(p)):(n[g]=p,s[g]=p)}else{var m=$s(l,t,h+f,d),v=$s(l,t,h,h+f),y=m>=0&&n[m],b=v>=0&&n[v];if(r&&!b||!r&&!y){Yn(Vn(u,s),o,l);var k=function(e,t,n,i,r){var a=new Pn(e,n,Vo);return a.multi=[],a.index=t,a.componentProviders=0,Ks(a,r,i&&!n),a}(r?Js:Qs,n.length,r,i,c);!r&&b&&(n[v].providerFactory=k),Xs(o,e,t.length,0),t.push(l),u.directiveStart++,u.directiveEnd++,r&&(u.providerIndexes+=1048576),n.push(k),s.push(k)}else Xs(o,e,m>-1?m:v,Ks(n[r?v:m],c,!r&&i));!r&&i&&b&&n[v].componentProviders++}}}function Xs(e,t,n,i){var r=bo(t);if(r||t.useClass){var a=(t.useClass||t).prototype.ngOnDestroy;if(a){var o=e.destroyHooks||(e.destroyHooks=[]);if(!r&&t.multi){var s=o.indexOf(n);-1===s?o.push(n,[i,a]):o[s+1].push(i,a)}else o.push(n,a)}}}function Ks(e,t,n){return n&&e.componentProviders++,e.multi.push(t)-1}function $s(e,t,n,i){for(var r=n;r<i;r++)if(t[r]===e)return r;return-1}function Qs(e,t,n,i){return el(this.multi,[])}function Js(e,t,n,i){var r,a=this.multi;if(this.providerFactory){var o=this.providerFactory.componentProviders,s=ti(n,n[1],this.providerFactory.index,i);el(a,r=s.slice(0,o));for(var l=o;l<s.length;l++)r.push(s[l])}else el(a,r=[]);return r}function el(e,t){for(var n=0;n<e.length;n++)t.push((0,e[n])());return t}function tl(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return function(n){n.providersResolver=function(n,i){return function(e,t,n){var i=Qt();if(i.firstCreatePass){var r=Et(e);qs(n,i.data,i.blueprint,r,!0),qs(t,i.data,i.blueprint,r,!1)}}(n,i?i(e):e,t)}}}var nl=function e(){y(this,e)},il=function(){function e(){y(this,e)}return k(e,[{key:"resolveComponentFactory",value:function(e){throw function(e){var t=Error("No component factory found for ".concat(_e(e),". Did you add it to @NgModule.entryComponents?"));return t.ngComponent=e,t}(e)}}]),e}(),rl=function(){var e=function e(){y(this,e)};return e.NULL=new il,e}();function al(){}function ol(e,t){return new ll(Bt(e,t))}var sl=function(){return ol(en(),$t())},ll=function(){var e=function e(t){y(this,e),this.nativeElement=t};return e.__NG_ELEMENT_ID__=sl,e}();function cl(e){return e instanceof ll?e.nativeElement:e}var ul=function e(){y(this,e)},hl=function(){var e=function e(){y(this,e)};return e.__NG_ELEMENT_ID__=function(){return dl()},e}(),dl=function(){var e=$t(),t=Ht(en().index,e);return function(e){return e[11]}(kt(t)?t:e)},fl=function(){var e=function e(){y(this,e)};return e.\u0275prov=Ae({token:e,providedIn:"root",factory:function(){return null}}),e}(),pl=new function e(t){y(this,e),this.full=t,this.major=t.split(".")[0],this.minor=t.split(".")[1],this.patch=t.split(".").slice(2).join(".")}("11.2.9"),gl=function(){function e(){y(this,e)}return k(e,[{key:"supports",value:function(e){return Ao(e)}},{key:"create",value:function(e){return new vl(e)}}]),e}(),ml=function(e,t){return t},vl=function(){function e(t){y(this,e),this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=t||ml}return k(e,[{key:"forEachItem",value:function(e){var t;for(t=this._itHead;null!==t;t=t._next)e(t)}},{key:"forEachOperation",value:function(e){for(var t=this._itHead,n=this._removalsHead,i=0,r=null;t||n;){var a=!n||t&&t.currentIndex<_l(n,i,r)?t:n,o=_l(a,i,r),s=a.currentIndex;if(a===n)i--,n=n._nextRemoved;else if(t=t._next,null==a.previousIndex)i++;else{r||(r=[]);var l=o-i,c=s-i;if(l!=c){for(var u=0;u<l;u++){var h=u<r.length?r[u]:r[u]=0,d=h+u;c<=d&&d<l&&(r[u]=h+1)}r[a.previousIndex]=c-l}}o!==s&&e(a,o,s)}}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousItHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachMovedItem",value:function(e){var t;for(t=this._movesHead;null!==t;t=t._nextMoved)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"forEachIdentityChange",value:function(e){var t;for(t=this._identityChangesHead;null!==t;t=t._nextIdentityChange)e(t)}},{key:"diff",value:function(e){if(null==e&&(e=[]),!Ao(e))throw new Error("Error trying to diff '".concat(_e(e),"'. Only arrays and iterables are allowed"));return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n,i,r,a=this._itHead,o=!1;if(Array.isArray(e)){this.length=e.length;for(var s=0;s<this.length;s++)i=e[s],r=this._trackByFn(s,i),null!==a&&Object.is(a.trackById,r)?(o&&(a=this._verifyReinsertion(a,i,r,s)),Object.is(a.item,i)||this._addIdentityChange(a,i)):(a=this._mismatch(a,i,r,s),o=!0),a=a._next}else n=0,function(e,t){if(Array.isArray(e))for(var n=0;n<e.length;n++)t(e[n]);else for(var i,r=e[Io()]();!(i=r.next()).done;)t(i.value)}(e,function(e){r=t._trackByFn(n,e),null!==a&&Object.is(a.trackById,r)?(o&&(a=t._verifyReinsertion(a,e,r,n)),Object.is(a.item,e)||t._addIdentityChange(a,e)):(a=t._mismatch(a,e,r,n),o=!0),a=a._next,n++}),this.length=n;return this._truncate(a),this.collection=e,this.isDirty}},{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}},{key:"_reset",value:function(){if(this.isDirty){var e;for(e=this._previousItHead=this._itHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._additionsHead;null!==e;e=e._nextAdded)e.previousIndex=e.currentIndex;for(this._additionsHead=this._additionsTail=null,e=this._movesHead;null!==e;e=e._nextMoved)e.previousIndex=e.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}},{key:"_mismatch",value:function(e,t,n,i){var r;return null===e?r=this._itTail:(r=e._prev,this._remove(e)),null!==(e=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._reinsertAfter(e,r,i)):null!==(e=null===this._linkedRecords?null:this._linkedRecords.get(n,i))?(Object.is(e.item,t)||this._addIdentityChange(e,t),this._moveAfter(e,r,i)):e=this._addAfter(new yl(t,n),r,i),e}},{key:"_verifyReinsertion",value:function(e,t,n,i){var r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(n,null);return null!==r?e=this._reinsertAfter(r,e._prev,i):e.currentIndex!=i&&(e.currentIndex=i,this._addToMoves(e,i)),e}},{key:"_truncate",value:function(e){for(;null!==e;){var t=e._next;this._addToRemovals(this._unlink(e)),e=t}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}},{key:"_reinsertAfter",value:function(e,t,n){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(e);var i=e._prevRemoved,r=e._nextRemoved;return null===i?this._removalsHead=r:i._nextRemoved=r,null===r?this._removalsTail=i:r._prevRemoved=i,this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_moveAfter",value:function(e,t,n){return this._unlink(e),this._insertAfter(e,t,n),this._addToMoves(e,n),e}},{key:"_addAfter",value:function(e,t,n){return this._insertAfter(e,t,n),this._additionsTail=null===this._additionsTail?this._additionsHead=e:this._additionsTail._nextAdded=e,e}},{key:"_insertAfter",value:function(e,t,n){var i=null===t?this._itHead:t._next;return e._next=i,e._prev=t,null===i?this._itTail=e:i._prev=e,null===t?this._itHead=e:t._next=e,null===this._linkedRecords&&(this._linkedRecords=new kl),this._linkedRecords.put(e),e.currentIndex=n,e}},{key:"_remove",value:function(e){return this._addToRemovals(this._unlink(e))}},{key:"_unlink",value:function(e){null!==this._linkedRecords&&this._linkedRecords.remove(e);var t=e._prev,n=e._next;return null===t?this._itHead=n:t._next=n,null===n?this._itTail=t:n._prev=t,e}},{key:"_addToMoves",value:function(e,t){return e.previousIndex===t||(this._movesTail=null===this._movesTail?this._movesHead=e:this._movesTail._nextMoved=e),e}},{key:"_addToRemovals",value:function(e){return null===this._unlinkedRecords&&(this._unlinkedRecords=new kl),this._unlinkedRecords.put(e),e.currentIndex=null,e._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=e,e._prevRemoved=null):(e._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=e),e}},{key:"_addIdentityChange",value:function(e,t){return e.item=t,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=e:this._identityChangesTail._nextIdentityChange=e,e}}]),e}(),yl=function e(t,n){y(this,e),this.item=t,this.trackById=n,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null},bl=function(){function e(){y(this,e),this._head=null,this._tail=null}return k(e,[{key:"add",value:function(e){null===this._head?(this._head=this._tail=e,e._nextDup=null,e._prevDup=null):(this._tail._nextDup=e,e._prevDup=this._tail,e._nextDup=null,this._tail=e)}},{key:"get",value:function(e,t){var n;for(n=this._head;null!==n;n=n._nextDup)if((null===t||t<=n.currentIndex)&&Object.is(n.trackById,e))return n;return null}},{key:"remove",value:function(e){var t=e._prevDup,n=e._nextDup;return null===t?this._head=n:t._nextDup=n,null===n?this._tail=t:n._prevDup=t,null===this._head}}]),e}(),kl=function(){function e(){y(this,e),this.map=new Map}return k(e,[{key:"put",value:function(e){var t=e.trackById,n=this.map.get(t);n||(n=new bl,this.map.set(t,n)),n.add(e)}},{key:"get",value:function(e,t){var n=this.map.get(e);return n?n.get(e,t):null}},{key:"remove",value:function(e){var t=e.trackById;return this.map.get(t).remove(e)&&this.map.delete(t),e}},{key:"isEmpty",get:function(){return 0===this.map.size}},{key:"clear",value:function(){this.map.clear()}}]),e}();function _l(e,t,n){var i=e.previousIndex;if(null===i)return i;var r=0;return n&&i<n.length&&(r=n[i]),i+t+r}var wl=function(){function e(){y(this,e)}return k(e,[{key:"supports",value:function(e){return e instanceof Map||Po(e)}},{key:"create",value:function(){return new xl}}]),e}(),xl=function(){function e(){y(this,e),this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}return k(e,[{key:"isDirty",get:function(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}},{key:"forEachItem",value:function(e){var t;for(t=this._mapHead;null!==t;t=t._next)e(t)}},{key:"forEachPreviousItem",value:function(e){var t;for(t=this._previousMapHead;null!==t;t=t._nextPrevious)e(t)}},{key:"forEachChangedItem",value:function(e){var t;for(t=this._changesHead;null!==t;t=t._nextChanged)e(t)}},{key:"forEachAddedItem",value:function(e){var t;for(t=this._additionsHead;null!==t;t=t._nextAdded)e(t)}},{key:"forEachRemovedItem",value:function(e){var t;for(t=this._removalsHead;null!==t;t=t._nextRemoved)e(t)}},{key:"diff",value:function(e){if(e){if(!(e instanceof Map||Po(e)))throw new Error("Error trying to diff '".concat(_e(e),"'. Only maps and objects are allowed"))}else e=new Map;return this.check(e)?this:null}},{key:"onDestroy",value:function(){}},{key:"check",value:function(e){var t=this;this._reset();var n=this._mapHead;if(this._appendAfter=null,this._forEach(e,function(e,i){if(n&&n.key===i)t._maybeAddToChanges(n,e),t._appendAfter=n,n=n._next;else{var r=t._getOrCreateRecordForKey(i,e);n=t._insertBeforeOrAppend(n,r)}}),n){n._prev&&(n._prev._next=null),this._removalsHead=n;for(var i=n;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}},{key:"_insertBeforeOrAppend",value:function(e,t){if(e){var n=e._prev;return t._next=e,t._prev=n,e._prev=t,n&&(n._next=t),e===this._mapHead&&(this._mapHead=t),this._appendAfter=e,e}return this._appendAfter?(this._appendAfter._next=t,t._prev=this._appendAfter):this._mapHead=t,this._appendAfter=t,null}},{key:"_getOrCreateRecordForKey",value:function(e,t){if(this._records.has(e)){var n=this._records.get(e);this._maybeAddToChanges(n,t);var i=n._prev,r=n._next;return i&&(i._next=r),r&&(r._prev=i),n._next=null,n._prev=null,n}var a=new Cl(e);return this._records.set(e,a),a.currentValue=t,this._addToAdditions(a),a}},{key:"_reset",value:function(){if(this.isDirty){var e;for(this._previousMapHead=this._mapHead,e=this._previousMapHead;null!==e;e=e._next)e._nextPrevious=e._next;for(e=this._changesHead;null!==e;e=e._nextChanged)e.previousValue=e.currentValue;for(e=this._additionsHead;null!=e;e=e._nextAdded)e.previousValue=e.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}},{key:"_maybeAddToChanges",value:function(e,t){Object.is(t,e.currentValue)||(e.previousValue=e.currentValue,e.currentValue=t,this._addToChanges(e))}},{key:"_addToAdditions",value:function(e){null===this._additionsHead?this._additionsHead=this._additionsTail=e:(this._additionsTail._nextAdded=e,this._additionsTail=e)}},{key:"_addToChanges",value:function(e){null===this._changesHead?this._changesHead=this._changesTail=e:(this._changesTail._nextChanged=e,this._changesTail=e)}},{key:"_forEach",value:function(e,t){e instanceof Map?e.forEach(t):Object.keys(e).forEach(function(n){return t(e[n],n)})}}]),e}(),Cl=function e(t){y(this,e),this.key=t,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null};function El(){return new Sl([new gl])}var Sl=function(){var e=function(){function e(t){y(this,e),this.factories=t}return k(e,[{key:"find",value:function(e){var t,n=this.factories.find(function(t){return t.supports(e)});if(null!=n)return n;throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'"))}}],[{key:"create",value:function(t,n){if(null!=n){var i=n.factories.slice();t=t.concat(i)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||El())},deps:[[e,new Ii,new Oi]]}}}]),e}();return e.\u0275prov=Ae({token:e,providedIn:"root",factory:El}),e}();function Tl(){return new Ol([new wl])}var Ol=function(){var e=function(){function e(t){y(this,e),this.factories=t}return k(e,[{key:"find",value:function(e){var t=this.factories.find(function(t){return t.supports(e)});if(t)return t;throw new Error("Cannot find a differ supporting object '".concat(e,"'"))}}],[{key:"create",value:function(t,n){if(n){var i=n.factories.slice();t=t.concat(i)}return new e(t)}},{key:"extend",value:function(t){return{provide:e,useFactory:function(n){return e.create(t,n||Tl())},deps:[[e,new Ii,new Oi]]}}}]),e}();return e.\u0275prov=Ae({token:e,providedIn:"root",factory:Tl}),e}();function Il(e,t,n,r){for(var a=arguments.length>4&&void 0!==arguments[4]&&arguments[4];null!==n;){var o=t[n.index];if(null!==o&&r.push(zt(o)),_t(o))for(var s=10;s<o.length;s++){var l=o[s],c=l[1].firstChild;null!==c&&Il(l[1],l,c,r)}var u=n.type;if(8&u)Il(e,t,n.child,r);else if(32&u)for(var h=wr(n,t),d=void 0;d=h();)r.push(d);else if(16&u){var f=Hr(t,n);if(Array.isArray(f))r.push.apply(r,i(f));else{var p=xr(t[16]);Il(p[1],p,f,r,!0)}}n=a?n.projectionNext:n.next}return r}var Ml=function(){function e(t,n){y(this,e),this._lView=t,this._cdRefInjectingView=n,this._appRef=null,this._attachedToViewContainer=!1}return k(e,[{key:"rootNodes",get:function(){var e=this._lView,t=e[1];return Il(t,e,t.firstChild,[])}},{key:"context",get:function(){return this._lView[8]}},{key:"destroyed",get:function(){return 256==(256&this._lView[2])}},{key:"destroy",value:function(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){var e=this._lView[3];if(_t(e)){var t=e[8],n=t?t.indexOf(this):-1;n>-1&&(Mr(e,n),hi(t,n))}this._attachedToViewContainer=!1}Ar(this._lView[1],this._lView)}},{key:"onDestroy",value:function(e){Oa(this._lView[1],this._lView,null,e)}},{key:"markForCheck",value:function(){Ya(this._cdRefInjectingView||this._lView)}},{key:"detach",value:function(){this._lView[2]&=-129}},{key:"reattach",value:function(){this._lView[2]|=128}},{key:"detectChanges",value:function(){qa(this._lView[1],this._lView,this.context)}},{key:"checkNoChanges",value:function(){!function(e,t,n){sn(!0);try{qa(e,t,n)}finally{sn(!1)}}(this._lView[1],this._lView,this.context)}},{key:"attachToViewContainerRef",value:function(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}},{key:"detachFromAppRef",value:function(){var e;this._appRef=null,Gr(this._lView[1],e=this._lView,e[11],2,null,null)}},{key:"attachToAppRef",value:function(e){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=e}}]),e}(),Al=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this,e))._view=e,i}return k(n,[{key:"detectChanges",value:function(){Xa(this._view)}},{key:"checkNoChanges",value:function(){!function(e){sn(!0);try{Xa(e)}finally{sn(!1)}}(this._view)}},{key:"context",get:function(){return null}}]),n}(Ml),Pl=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return function(e,t,n){if(!n&&xt(e)){var i=Ht(e.index,t);return new Ml(i,i)}return 47&e.type?new Ml(t[16],t):null}(en(),$t(),e)},Dl=function(){var e=function e(){y(this,e)};return e.__NG_ELEMENT_ID__=Pl,e.__ChangeDetectorRef__=!0,e}(),Rl=[new wl],Fl=new Sl([new gl]),Nl=new Ol(Rl),zl=function(){return jl(en(),$t())},Ll=function(){var e=function e(){y(this,e)};return e.__NG_ELEMENT_ID__=zl,e}(),Bl=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this))._declarationLView=e,a._declarationTContainer=i,a.elementRef=r,a}return k(n,[{key:"createEmbeddedView",value:function(e){var t=this._declarationTContainer.tViews,n=ma(this._declarationLView,t,e,16,null,t.declTNode,null,null,null,null);n[17]=this._declarationLView[this._declarationTContainer.index];var i=this._declarationLView[19];return null!==i&&(n[19]=i.createEmbeddedView(t)),ba(t,n,e),new Ml(n)}}]),n}(Ll);function jl(e,t){return 4&e.type?new Bl(t,e,ol(e,t)):null}var Ul=function e(){y(this,e)},Hl=function(){return Yl(en(),$t())},Vl=function(){var e=function e(){y(this,e)};return e.__NG_ELEMENT_ID__=Hl,e}(),Wl=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this))._lContainer=e,a._hostTNode=i,a._hostLView=r,a}return k(n,[{key:"element",get:function(){return ol(this._hostTNode,this._hostLView)}},{key:"injector",get:function(){return new ri(this._hostTNode,this._hostLView)}},{key:"parentInjector",get:function(){var e=Zn(this._hostTNode,this._hostLView);if(zn(e)){var t=Bn(e,this._hostLView),n=Ln(e);return new ri(t[1].data[n+8],t)}return new ri(null,this._hostLView)}},{key:"clear",value:function(){for(;this.length>0;)this.remove(this.length-1)}},{key:"get",value:function(e){var t=Gl(this._lContainer);return null!==t&&t[e]||null}},{key:"length",get:function(){return this._lContainer.length-10}},{key:"createEmbeddedView",value:function(e,t,n){var i=e.createEmbeddedView(t||{});return this.insert(i,n),i}},{key:"createComponent",value:function(e,t,n,i,r){var a=n||this.parentInjector;if(!r&&null==e.ngModule&&a){var o=a.get(Ul,null);o&&(r=o)}var s=e.create(a,i,void 0,r);return this.insert(s.hostView,t),s}},{key:"insert",value:function(e,t){var i=e._lView,r=i[1];if(_t(i[3])){var a=this.indexOf(e);if(-1!==a)this.detach(a);else{var o=i[3],s=new n(o,o[6],o[3]);s.detach(s.indexOf(e))}}var l=this._adjustIndex(t),c=this._lContainer;!function(e,t,n,i){var r=10+i,a=n.length;i>0&&(n[r-1][4]=t),i<a-10?(t[4]=n[r],ui(n,10+i,t)):(n.push(t),t[4]=null),t[3]=n;var o=t[17];null!==o&&n!==o&&function(e,t){var n=e[9];t[16]!==t[3][3][16]&&(e[2]=!0),null===n?e[9]=[t]:n.push(t)}(o,t);var s=t[19];null!==s&&s.insertView(e),t[2]|=128}(r,i,c,l);var u=Vr(l,c),h=i[11],d=zr(h,c[7]);return null!==d&&function(e,t,n,i,r,a){i[0]=r,i[6]=t,Gr(e,i,n,1,r,a)}(r,c[6],h,i,d,u),e.attachToViewContainerRef(),ui(Zl(c),l,e),e}},{key:"move",value:function(e,t){return this.insert(e,t)}},{key:"indexOf",value:function(e){var t=Gl(this._lContainer);return null!==t?t.indexOf(e):-1}},{key:"remove",value:function(e){var t=this._adjustIndex(e,-1),n=Mr(this._lContainer,t);n&&(hi(Zl(this._lContainer),t),Ar(n[1],n))}},{key:"detach",value:function(e){var t=this._adjustIndex(e,-1),n=Mr(this._lContainer,t);return n&&null!=hi(Zl(this._lContainer),t)?new Ml(n):null}},{key:"_adjustIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return null==e?this.length+t:e}}]),n}(Vl);function Gl(e){return e[8]}function Zl(e){return e[8]||(e[8]=[])}function Yl(e,t){var n,i=t[e.index];if(_t(i))n=i;else{var r;if(8&e.type)r=zt(i);else{var a=t[11];r=a.createComment("");var o=Bt(e,t);Rr(a,zr(a,o),r,function(e,t){return Ft(e)?e.nextSibling(t):t.nextSibling}(a,o),!1)}t[e.index]=n=Ha(i,t,r,e),Za(t,n)}return new Wl(n,e,t)}var ql={},Xl=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this)).ngModule=e,i}return k(n,[{key:"resolveComponentFactory",value:function(e){var t=yt(e);return new Ql(t,this.ngModule)}}]),n}(rl);function Kl(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push({propName:e[n],templateName:n});return t}var $l=new si("SCHEDULER_TOKEN",{providedIn:"root",factory:function(){return br}}),Ql=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this)).componentDef=e,r.ngModule=i,r.componentType=e.type,r.selector=e.selectors.map(aa).join(","),r.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],r.isBoundToModule=!!i,r}return k(n,[{key:"inputs",get:function(){return Kl(this.componentDef.inputs)}},{key:"outputs",get:function(){return Kl(this.componentDef.outputs)}},{key:"create",value:function(e,t,n,i){var r,a,o=(i=i||this.ngModule)?function(e,t){return{get:function(n,i,r){var a=e.get(n,ql,r);return a!==ql||i===ql?a:t.get(n,i,r)}}}(e,i.injector):e,s=o.get(ul,Nt),l=o.get(fl,null),c=s.createRenderer(null,this.componentDef),u=this.componentDef.selectors[0][0]||"div",h=n?function(e,t,n){if(Ft(e))return e.selectRootElement(t,n===Ze.ShadowDom);var i="string"==typeof t?e.querySelector(t):t;return i.textContent="",i}(c,n,this.componentDef.encapsulation):Or(s.createRenderer(null,this.componentDef),u,function(e){var t=e.toLowerCase();return"svg"===t?"http://www.w3.org/2000/svg":"math"===t?"http://www.w3.org/1998/MathML/":null}(u)),d=this.componentDef.onPush?576:528,f={components:[],scheduler:br,clean:$a,playerHandler:null,flags:0},p=Ta(0,null,null,1,0,null,null,null,null,null),g=ma(null,p,f,d,null,null,s,c,l,o);vn(g);try{var m=function(e,t,n,i,r,a){var o=n[1];n[20]=e;var s=va(o,20,2,"#host",null),l=s.mergedAttrs=t.hostAttrs;null!==l&&(io(s,l,!0),null!==e&&(Dn(r,e,l),null!==s.classes&&qr(r,e,s.classes),null!==s.styles&&Yr(r,e,s.styles)));var c=i.createRenderer(e,t),u=ma(n,Sa(t),null,t.onPush?64:16,n[20],s,i,c,null,null);return o.firstCreatePass&&(Yn(Vn(s,n),o,t.type),Ra(o,s),Na(s,n.length,1)),Za(n,u),n[20]=u}(h,this.componentDef,g,s,c);if(h)if(n)Dn(c,h,["ng-version",pl.full]);else{var v=function(e){for(var t=[],n=[],i=1,r=2;i<e.length;){var a=e[i];if("string"==typeof a)2===r?""!==a&&t.push(a,e[++i]):8===r&&n.push(a);else{if(!ea(r))break;r=a}i++}return{attrs:t,classes:n}}(this.componentDef.selectors[0]),y=v.attrs,b=v.classes;y&&Dn(c,h,y),b&&b.length>0&&qr(c,h,b.join(" "))}if(a=jt(p,20),void 0!==t)for(var k=a.projection=[],_=0;_<this.ngContentSelectors.length;_++){var w=t[_];k.push(null!=w?Array.from(w):null)}r=function(e,t,n,i,r){var a=n[1],o=function(e,t,n){var i=en();e.firstCreatePass&&(n.providersResolver&&n.providersResolver(n),za(e,i,t,ya(e,t,1,null),n));var r=ti(t,e,i.directiveStart,i);yr(r,t);var a=Bt(i,t);return a&&yr(a,t),r}(a,n,t);if(i.components.push(o),e[8]=o,r&&r.forEach(function(e){return e(o,t)}),t.contentQueries){var s=en();t.contentQueries(1,o,s.directiveStart)}var l=en();return!a.firstCreatePass||null===t.hostBindings&&null===t.hostAttrs||(Cn(l.index),Pa(n[1],l,0,l.directiveStart,l.directiveEnd,t),Da(t,o)),o}(m,this.componentDef,g,f,[wo]),ba(p,g,null)}finally{wn()}return new Jl(this.componentType,r,ol(a,g),g,a)}}]),n}(nl),Jl=function(e){h(n,e);var t=f(n);function n(e,i,r,a,o){var s;return y(this,n),(s=t.call(this)).location=r,s._rootLView=a,s._tNode=o,s.instance=i,s.hostView=s.changeDetectorRef=new Al(a),s.componentType=e,s}return k(n,[{key:"injector",get:function(){return new ri(this._tNode,this._rootLView)}},{key:"destroy",value:function(){this.hostView.destroy()}},{key:"onDestroy",value:function(e){this.hostView.onDestroy(e)}}]),n}(function(){return function e(){y(this,e)}}()),ec=new Map,tc=function(e){h(n,e);var t=f(n);function n(e,i){var r;y(this,n),(r=t.call(this))._parent=i,r._bootstrapComponents=[],r.injector=g(r),r.destroyCbs=[],r.componentFactoryResolver=new Xl(g(r));var a=bt(e),o=e[at]||null;return o&&Ys(o),r._bootstrapComponents=kr(a.bootstrap),r._r3Injector=fo(e,i,[{provide:Ul,useValue:g(r)},{provide:rl,useValue:r.componentFactoryResolver}],_e(e)),r._r3Injector._resolveInjectorDefTypes(),r.instance=r.get(e),r}return k(n,[{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:_o.THROW_IF_NOT_FOUND,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ue.Default;return e===_o||e===Ul||e===ao?this:this._r3Injector.get(e,t,n)}},{key:"destroy",value:function(){var e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(function(e){return e()}),this.destroyCbs=null}},{key:"onDestroy",value:function(e){this.destroyCbs.push(e)}}]),n}(Ul),nc=function(e){h(n,e);var t=f(n);function n(e){var i,r,o;return y(this,n),(i=t.call(this)).moduleType=e,null!==bt(e)&&(r=e,o=new Set,function e(t){var n=bt(t,!0),i=n.id;null!==i&&(function(e,t,n){if(t&&t!==n)throw new Error("Duplicate module registered for ".concat(e," - ").concat(_e(t)," vs ").concat(_e(t.name)))}(i,ec.get(i),t),ec.set(i,t));var r,s=a(kr(n.imports));try{for(s.s();!(r=s.n()).done;){var l=r.value;o.has(l)||(o.add(l),e(l))}}catch(c){s.e(c)}finally{s.f()}}(r)),i}return k(n,[{key:"create",value:function(e){return new tc(this.moduleType,e)}}]),n}(function(){return function e(){y(this,e)}}());function ic(e,t,n){var i=ln()+e,r=$t();return r[i]===oa?Do(r,i,n?t.call(n):t()):Ro(r,i)}function rc(e,t,n,i){return function(e,t,n,i,r,a){var o=t+n;return Fo(e,o,r)?Do(e,o+1,a?i.call(a,r):i(r)):cc(e,o+1)}($t(),ln(),e,t,n,i)}function ac(e,t,n,i,r){return uc($t(),ln(),e,t,n,i,r)}function oc(e,t,n,i,r,a){return function(e,t,n,i,r,a,o,s){var l=t+n;return function(e,t,n,i,r){var a=No(e,t,n,i);return Fo(e,t+2,r)||a}(e,l,r,a,o)?Do(e,l+3,s?i.call(s,r,a,o):i(r,a,o)):cc(e,l+3)}($t(),ln(),e,t,n,i,r,a)}function sc(e,t,n,i,r,a,o){return function(e,t,n,i,r,a,o,s,l){var c=t+n;return zo(e,c,r,a,o,s)?Do(e,c+4,l?i.call(l,r,a,o,s):i(r,a,o,s)):cc(e,c+4)}($t(),ln(),e,t,n,i,r,a,o)}function lc(e,t,n,i,r,a,o,s,l,c,u){var h=ln()+e,d=$t(),f=zo(d,h,n,i,r,a);return zo(d,h+4,o,s,l,c)||f?Do(d,h+8,u?t.call(u,n,i,r,a,o,s,l,c):t(n,i,r,a,o,s,l,c)):Ro(d,h+8)}function cc(e,t){var n=e[t];return n===oa?void 0:n}function uc(e,t,n,i,r,a,o){var s=t+n;return No(e,s,r,a)?Do(e,s+2,o?i.call(o,r,a):i(r,a)):cc(e,s+2)}function hc(e,t){var n,i=Qt(),r=e+20;i.firstCreatePass?(n=function(e,t){if(t)for(var n=t.length-1;n>=0;n--){var i=t[n];if(e===i.name)return i}throw new Te("302","The pipe '".concat(e,"' could not be found!"))}(t,i.pipeRegistry),i.data[r]=n,n.onDestroy&&(i.destroyHooks||(i.destroyHooks=[])).push(r,n.onDestroy)):n=i.data[r];var a=n.factory||(n.factory=St(n.type)),o=He(Vo);try{var s=Un(!1),l=a();return Un(s),function(e,t,n,i){n>=e.data.length&&(e.data[n]=null,e.blueprint[n]=null),t[n]=i}(i,$t(),r,l),l}finally{He(o)}}function dc(e,t,n,i){var r=e+20,a=$t(),o=Ut(a,r);return function(e,t){return Mo.isWrapped(t)&&(t=Mo.unwrap(t),e[cn()]=oa),t}(a,function(e,t){return e[1].data[t].pure}(a,r)?uc(a,ln(),t,o.transform,n,i,o):o.transform(n,i))}var fc=function(e){h(n,e);var t=f(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return y(this,n),(e=t.call(this)).__isAsync=i,e}return k(n,[{key:"emit",value:function(e){u(v(n.prototype),"next",this).call(this,e)}},{key:"subscribe",value:function(e,t,i){var r,a=function(e){return null},o=function(){return null};e&&"object"==typeof e?(r=this.__isAsync?function(t){setTimeout(function(){return e.next(t)})}:function(t){e.next(t)},e.error&&(a=this.__isAsync?function(t){setTimeout(function(){return e.error(t)})}:function(t){e.error(t)}),e.complete&&(o=this.__isAsync?function(){setTimeout(function(){return e.complete()})}:function(){e.complete()})):(r=this.__isAsync?function(t){setTimeout(function(){return e(t)})}:function(t){e(t)},t&&(a=this.__isAsync?function(e){setTimeout(function(){return t(e)})}:function(e){t(e)}),i&&(o=this.__isAsync?function(){setTimeout(function(){return i()})}:function(){i()}));var s=u(v(n.prototype),"subscribe",this).call(this,r,a,o);return e instanceof O&&e.add(s),s}}]),n}(H);function pc(){return this._results[Io()]()}var gc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];y(this,e),this._emitDistinctChangesOnly=t,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;var n=Io(),i=e.prototype;i[n]||(i[n]=pc)}return k(e,[{key:"changes",get:function(){return this._changes||(this._changes=new fc)}},{key:"get",value:function(e){return this._results[e]}},{key:"map",value:function(e){return this._results.map(e)}},{key:"filter",value:function(e){return this._results.filter(e)}},{key:"find",value:function(e){return this._results.find(e)}},{key:"reduce",value:function(e,t){return this._results.reduce(e,t)}},{key:"forEach",value:function(e){this._results.forEach(e)}},{key:"some",value:function(e){return this._results.some(e)}},{key:"toArray",value:function(){return this._results.slice()}},{key:"toString",value:function(){return this._results.toString()}},{key:"reset",value:function(e,t){this.dirty=!1;var n=li(e);(this._changesDetected=!function(e,t,n){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++){var r=e[i],a=t[i];if(n&&(r=n(r),a=n(a)),a!==r)return!1}return!0}(this._results,n,t))&&(this._results=n,this.length=n.length,this.last=n[this.length-1],this.first=n[0])}},{key:"notifyOnChanges",value:function(){!this._changes||!this._changesDetected&&this._emitDistinctChangesOnly||this._changes.emit(this)}},{key:"setDirty",value:function(){this.dirty=!0}},{key:"destroy",value:function(){this.changes.complete(),this.changes.unsubscribe()}}]),e}(),mc=function(){function e(t){y(this,e),this.queryList=t,this.matches=null}return k(e,[{key:"clone",value:function(){return new e(this.queryList)}},{key:"setDirty",value:function(){this.queryList.setDirty()}}]),e}(),vc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];y(this,e),this.queries=t}return k(e,[{key:"createEmbeddedView",value:function(t){var n=t.queries;if(null!==n){for(var i=null!==t.contentQueries?t.contentQueries[0]:n.length,r=[],a=0;a<i;a++){var o=n.getByIndex(a);r.push(this.queries[o.indexInDeclarationView].clone())}return new e(r)}return null}},{key:"insertView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"detachView",value:function(e){this.dirtyQueriesWithMatches(e)}},{key:"dirtyQueriesWithMatches",value:function(e){for(var t=0;t<this.queries.length;t++)null!==Oc(e,t).matches&&this.queries[t].setDirty()}}]),e}(),yc=function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;y(this,e),this.predicate=t,this.flags=n,this.read=i},bc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];y(this,e),this.queries=t}return k(e,[{key:"elementStart",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].elementStart(e,t)}},{key:"elementEnd",value:function(e){for(var t=0;t<this.queries.length;t++)this.queries[t].elementEnd(e)}},{key:"embeddedTView",value:function(t){for(var n=null,i=0;i<this.length;i++){var r=null!==n?n.length:0,a=this.getByIndex(i).embeddedTView(t,r);a&&(a.indexInDeclarationView=i,null!==n?n.push(a):n=[a])}return null!==n?new e(n):null}},{key:"template",value:function(e,t){for(var n=0;n<this.queries.length;n++)this.queries[n].template(e,t)}},{key:"getByIndex",value:function(e){return this.queries[e]}},{key:"length",get:function(){return this.queries.length}},{key:"track",value:function(e){this.queries.push(e)}}]),e}(),kc=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;y(this,e),this.metadata=t,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=n}return k(e,[{key:"elementStart",value:function(e,t){this.isApplyingToNode(t)&&this.matchTNode(e,t)}},{key:"elementEnd",value:function(e){this._declarationNodeIndex===e.index&&(this._appliesToNextNode=!1)}},{key:"template",value:function(e,t){this.elementStart(e,t)}},{key:"embeddedTView",value:function(t,n){return this.isApplyingToNode(t)?(this.crossesNgTemplate=!0,this.addMatch(-t.index,n),new e(this.metadata)):null}},{key:"isApplyingToNode",value:function(e){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){for(var t=this._declarationNodeIndex,n=e.parent;null!==n&&8&n.type&&n.index!==t;)n=n.parent;return t===(null!==n?n.index:-1)}return this._appliesToNextNode}},{key:"matchTNode",value:function(e,t){var n=this.metadata.predicate;if(Array.isArray(n))for(var i=0;i<n.length;i++){var r=n[i];this.matchTNodeWithReadOption(e,t,_c(t,r)),this.matchTNodeWithReadOption(e,t,ei(t,e,r,!1,!1))}else n===Ll?4&t.type&&this.matchTNodeWithReadOption(e,t,-1):this.matchTNodeWithReadOption(e,t,ei(t,e,n,!1,!1))}},{key:"matchTNodeWithReadOption",value:function(e,t,n){if(null!==n){var i=this.metadata.read;if(null!==i)if(i===ll||i===Vl||i===Ll&&4&t.type)this.addMatch(t.index,-2);else{var r=ei(t,e,i,!1,!1);null!==r&&this.addMatch(t.index,r)}else this.addMatch(t.index,n)}}},{key:"addMatch",value:function(e,t){null===this.matches?this.matches=[e,t]:this.matches.push(e,t)}}]),e}();function _c(e,t){var n=e.localNames;if(null!==n)for(var i=0;i<n.length;i+=2)if(n[i]===t)return n[i+1];return null}function wc(e,t,n,i){return-1===n?function(e,t){return 11&e.type?ol(e,t):4&e.type?jl(e,t):null}(t,e):-2===n?function(e,t,n){return n===ll?ol(t,e):n===Ll?jl(t,e):n===Vl?Yl(t,e):void 0}(e,t,i):ti(e,e[1],n,t)}function xc(e,t,n,i){var r=t[19].queries[i];if(null===r.matches){for(var a=e.data,o=n.matches,s=[],l=0;l<o.length;l+=2){var c=o[l];s.push(c<0?null:wc(t,a[c],o[l+1],n.metadata.read))}r.matches=s}return r.matches}function Cc(e,t,n,i){var r=e.queries.getByIndex(n),a=r.matches;if(null!==a)for(var o=xc(e,t,r,n),s=0;s<a.length;s+=2){var l=a[s];if(l>0)i.push(o[s/2]);else{for(var c=a[s+1],u=t[-l],h=10;h<u.length;h++){var d=u[h];d[17]===d[3]&&Cc(d[1],d,c,i)}if(null!==u[9])for(var f=u[9],p=0;p<f.length;p++){var g=f[p];Cc(g[1],g,c,i)}}}return i}function Ec(e){var t=$t(),n=Qt(),i=fn();pn(i+1);var r=Oc(n,i);if(e.dirty&&Wt(t)===(2==(2&r.metadata.flags))){if(null===r.matches)e.reset([]);else{var a=r.crossesNgTemplate?Cc(n,t,i,[]):xc(n,t,r,i);e.reset(a,cl),e.notifyOnChanges()}return!0}return!1}function Sc(e,t,n){var i=Qt();i.firstCreatePass&&(function(e,t,n){null===e.queries&&(e.queries=new bc),e.queries.track(new kc(t,-1))}(i,new yc(e,t,n)),2==(2&t)&&(i.staticViewQueries=!0)),function(e,t,n){var i=new gc(4==(4&n));Oa(e,t,i,i.destroy),null===t[19]&&(t[19]=new vc),t[19].queries.push(new mc(i))}(i,$t(),t)}function Tc(){return e=$t(),t=fn(),e[19].queries[t].queryList;var e,t}function Oc(e,t){return e.queries.getByIndex(t)}function Ic(e,t){return jl(e,t)}var Mc=new si("Application Initializer"),Ac=function(){var e=function(){function e(t){var n=this;y(this,e),this.appInits=t,this.resolve=al,this.reject=al,this.initialized=!1,this.done=!1,this.donePromise=new Promise(function(e,t){n.resolve=e,n.reject=t})}return k(e,[{key:"runInitializers",value:function(){var e=this;if(!this.initialized){var t=[],n=function(){e.done=!0,e.resolve()};if(this.appInits)for(var i=0;i<this.appInits.length;i++){var r=this.appInits[i]();Jo(r)&&t.push(r)}Promise.all(t).then(function(){n()}).catch(function(t){e.reject(t)}),0===t.length&&n(),this.initialized=!0}}}]),e}();return e.\u0275fac=function(t){return new(t||e)(wi(Mc,8))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac}),e}(),Pc=new si("AppId"),Dc={provide:Pc,useFactory:function(){return"".concat(Rc()).concat(Rc()).concat(Rc())},deps:[]};function Rc(){return String.fromCharCode(97+Math.floor(25*Math.random()))}var Fc=new si("Platform Initializer"),Nc=new si("Platform ID"),zc=new si("appBootstrapListener"),Lc=function(){var e=function(){function e(){y(this,e)}return k(e,[{key:"log",value:function(e){console.log(e)}},{key:"warn",value:function(e){console.warn(e)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac}),e}(),Bc=new si("LocaleId"),jc=new si("DefaultCurrencyCode"),Uc=function e(t,n){y(this,e),this.ngModuleFactory=t,this.componentFactories=n},Hc=function(e){return new nc(e)},Vc=Hc,Wc=function(e){return Promise.resolve(Hc(e))},Gc=function(e){var t=Hc(e),n=kr(bt(e).declarations).reduce(function(e,t){var n=yt(t);return n&&e.push(new Ql(n)),e},[]);return new Uc(t,n)},Zc=Gc,Yc=function(e){return Promise.resolve(Gc(e))},qc=function(){var e=function(){function e(){y(this,e),this.compileModuleSync=Vc,this.compileModuleAsync=Wc,this.compileModuleAndAllComponentsSync=Zc,this.compileModuleAndAllComponentsAsync=Yc}return k(e,[{key:"clearCache",value:function(){}},{key:"clearCacheFor",value:function(e){}},{key:"getModuleId",value:function(e){}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac}),e}(),Xc=Promise.resolve(0);function Kc(e){"undefined"==typeof Zone?Xc.then(function(){e&&e.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",e)}var $c=function(){function e(t){var n,i,r=t.enableLongStackTrace,a=void 0!==r&&r,o=t.shouldCoalesceEventChangeDetection,s=void 0!==o&&o,l=t.shouldCoalesceRunChangeDetection,c=void 0!==l&&l;if(y(this,e),this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new fc(!1),this.onMicrotaskEmpty=new fc(!1),this.onStable=new fc(!1),this.onError=new fc(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched(),this._nesting=0,this._outer=this._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(this._inner=this._inner.fork(new Zone.TaskTrackingZoneSpec)),a&&Zone.longStackTraceZoneSpec&&(this._inner=this._inner.fork(Zone.longStackTraceZoneSpec)),this.shouldCoalesceEventChangeDetection=!c&&s,this.shouldCoalesceRunChangeDetection=c,this.lastRequestAnimationFrameId=-1,this.nativeRequestAnimationFrame=function(){var e=$e.requestAnimationFrame,t=$e.cancelAnimationFrame;if("undefined"!=typeof Zone&&e&&t){var n=e[Zone.__symbol__("OriginalDelegate")];n&&(e=n);var i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i)}return{nativeRequestAnimationFrame:e,nativeCancelAnimationFrame:t}}().nativeRequestAnimationFrame,i=function(){!function(e){-1===e.lastRequestAnimationFrameId&&(e.lastRequestAnimationFrameId=e.nativeRequestAnimationFrame.call($e,function(){e.fakeTopEventTask||(e.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",function(){e.lastRequestAnimationFrameId=-1,eu(e),Jc(e)},void 0,function(){},function(){})),e.fakeTopEventTask.invoke()}),eu(e))}(n)},(n=this)._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:function(e,t,r,a,o,s){try{return tu(n),e.invokeTask(r,a,o,s)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===a.type||n.shouldCoalesceRunChangeDetection)&&i(),nu(n)}},onInvoke:function(e,t,r,a,o,s,l){try{return tu(n),e.invoke(r,a,o,s,l)}finally{n.shouldCoalesceRunChangeDetection&&i(),nu(n)}},onHasTask:function(e,t,i,r){e.hasTask(i,r),t===i&&("microTask"==r.change?(n._hasPendingMicrotasks=r.microTask,eu(n),Jc(n)):"macroTask"==r.change&&(n.hasPendingMacrotasks=r.macroTask))},onHandleError:function(e,t,i,r){return e.handleError(i,r),n.runOutsideAngular(function(){return n.onError.emit(r)}),!1}})}return k(e,[{key:"run",value:function(e,t,n){return this._inner.run(e,t,n)}},{key:"runTask",value:function(e,t,n,i){var r=this._inner,a=r.scheduleEventTask("NgZoneEvent: "+i,e,Qc,al,al);try{return r.runTask(a,t,n)}finally{r.cancelTask(a)}}},{key:"runGuarded",value:function(e,t,n){return this._inner.runGuarded(e,t,n)}},{key:"runOutsideAngular",value:function(e){return this._outer.run(e)}}],[{key:"isInAngularZone",value:function(){return!0===Zone.current.get("isAngularZone")}},{key:"assertInAngularZone",value:function(){if(!e.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}},{key:"assertNotInAngularZone",value:function(){if(e.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}}]),e}(),Qc={};function Jc(e){if(0==e._nesting&&!e.hasPendingMicrotasks&&!e.isStable)try{e._nesting++,e.onMicrotaskEmpty.emit(null)}finally{if(e._nesting--,!e.hasPendingMicrotasks)try{e.runOutsideAngular(function(){return e.onStable.emit(null)})}finally{e.isStable=!0}}}function eu(e){e.hasPendingMicrotasks=!!(e._hasPendingMicrotasks||(e.shouldCoalesceEventChangeDetection||e.shouldCoalesceRunChangeDetection)&&-1!==e.lastRequestAnimationFrameId)}function tu(e){e._nesting++,e.isStable&&(e.isStable=!1,e.onUnstable.emit(null))}function nu(e){e._nesting--,Jc(e)}var iu,ru=function(){function e(){y(this,e),this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new fc,this.onMicrotaskEmpty=new fc,this.onStable=new fc,this.onError=new fc}return k(e,[{key:"run",value:function(e,t,n){return e.apply(t,n)}},{key:"runGuarded",value:function(e,t,n){return e.apply(t,n)}},{key:"runOutsideAngular",value:function(e){return e()}},{key:"runTask",value:function(e,t,n,i){return e.apply(t,n)}}]),e}(),au=function(){var e=function(){function e(t){var n=this;y(this,e),this._ngZone=t,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),t.run(function(){n.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}return k(e,[{key:"_watchAngularEvents",value:function(){var e=this;this._ngZone.onUnstable.subscribe({next:function(){e._didWork=!0,e._isZoneStable=!1}}),this._ngZone.runOutsideAngular(function(){e._ngZone.onStable.subscribe({next:function(){$c.assertNotInAngularZone(),Kc(function(){e._isZoneStable=!0,e._runCallbacksIfReady()})}})})}},{key:"increasePendingRequestCount",value:function(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}},{key:"decreasePendingRequestCount",value:function(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}},{key:"isStable",value:function(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}},{key:"_runCallbacksIfReady",value:function(){var e=this;if(this.isStable())Kc(function(){for(;0!==e._callbacks.length;){var t=e._callbacks.pop();clearTimeout(t.timeoutId),t.doneCb(e._didWork)}e._didWork=!1});else{var t=this.getPendingTasks();this._callbacks=this._callbacks.filter(function(e){return!e.updateCb||!e.updateCb(t)||(clearTimeout(e.timeoutId),!1)}),this._didWork=!0}}},{key:"getPendingTasks",value:function(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(function(e){return{source:e.source,creationLocation:e.creationLocation,data:e.data}}):[]}},{key:"addCallback",value:function(e,t,n){var i=this,r=-1;t&&t>0&&(r=setTimeout(function(){i._callbacks=i._callbacks.filter(function(e){return e.timeoutId!==r}),e(i._didWork,i.getPendingTasks())},t)),this._callbacks.push({doneCb:e,timeoutId:r,updateCb:n})}},{key:"whenStable",value:function(e,t,n){if(n&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/dist/task-tracking.js" loaded?');this.addCallback(e,t,n),this._runCallbacksIfReady()}},{key:"getPendingRequestCount",value:function(){return this._pendingCount}},{key:"findProviders",value:function(e,t,n){return[]}}]),e}();return e.\u0275fac=function(t){return new(t||e)(wi($c))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac}),e}(),ou=function(){var e=function(){function e(){y(this,e),this._applications=new Map,su.addToWindow(this)}return k(e,[{key:"registerApplication",value:function(e,t){this._applications.set(e,t)}},{key:"unregisterApplication",value:function(e){this._applications.delete(e)}},{key:"unregisterAllApplications",value:function(){this._applications.clear()}},{key:"getTestability",value:function(e){return this._applications.get(e)||null}},{key:"getAllTestabilities",value:function(){return Array.from(this._applications.values())}},{key:"getAllRootElements",value:function(){return Array.from(this._applications.keys())}},{key:"findTestabilityInTree",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return su.findTestabilityInTree(this,e,t)}}]),e}();return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=Ae({token:e,factory:e.\u0275fac}),e}(),su=new(function(){function e(){y(this,e)}return k(e,[{key:"addToWindow",value:function(e){}},{key:"findTestabilityInTree",value:function(e,t,n){return null}}]),e}()),lu=!0,cu=!1,uu=new si("AllowMultipleToken");function hu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],i="Platform: ".concat(t),r=new si(i);return function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],a=du();if(!a||a.injector.get(uu,!1))if(e)e(n.concat(t).concat({provide:r,useValue:!0}));else{var o=n.concat(t).concat({provide:r,useValue:!0},{provide:so,useValue:"platform"});!function(e){if(iu&&!iu.destroyed&&!iu.injector.get(uu,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");iu=e.get(fu);var t=e.get(Fc,null);t&&t.forEach(function(e){return e()})}(_o.create({providers:o,name:i}))}return function(e){var t=du();if(!t)throw new Error("No platform exists!");if(!t.injector.get(e,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return t}(r)}}function du(){return iu&&!iu.destroyed?iu:null}var fu=function(){var e=function(){function e(t){y(this,e),this._injector=t,this._modules=[],this._destroyListeners=[],this._destroyed=!1}return k(e,[{key:"bootstrapModuleFactory",value:function(e,t){var n,i,r=this,a=(n=t?t.ngZone:void 0,i={ngZoneEventCoalescing:t&&t.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:t&&t.ngZoneRunCoalescing||!1},"noop"===n?new ru:("zone.js"===n?void 0:n)||new $c({enableLongStackTrace:(cu=!0,lu),shouldCoalesceEventChangeDetection:!!(null==i?void 0:i.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==i?void 0:i.ngZoneRunCoalescing)})),o=[{provide:$c,useValue:a}];return a.run(function(){var t=_o.create({providers:o,parent:r.injector,name:e.moduleType.name}),n=e.create(t),i=n.injector.get(vr,null);if(!i)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return a.runOutsideAngular(function(){var e=a.onError.subscribe({next:function(e){i.handleError(e)}});n.onDestroy(function(){vu(r._modules,n),e.unsubscribe()})}),function(e,t,i){try{var a=((o=n.injector.get(Ac)).runInitializers(),o.donePromise.then(function(){return Ys(n.injector.get(Bc,"en-US")||"en-US"),r._moduleDoBootstrap(n),n}));return Jo(a)?a.catch(function(n){throw t.runOutsideAngular(function(){return e.handleError(n)}),n}):a}catch(s){throw t.runOutsideAngular(function(){return e.handleError(s)}),s}var o}(i,a)})}},{key:"bootstrapModule",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=pu({},n);return function(e,t,n){var i=new nc(n);return Promise.resolve(i)}(0,0,e).then(function(e){return t.bootstrapModuleFactory(e,i)})}},{key:"_moduleDoBootstrap",value:function(e){var t=e.injector.get(mu);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(function(e){return t.bootstrap(e)});else{if(!e.instance.ngDoBootstrap)throw new Error("The module ".concat(_e(e.instance.constructor),' was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.'));e.instance.ngDoBootstrap(t)}this._modules.push(e)}},{key:"onDestroy",value:function(e){this._destroyListeners.push(e)}},{key:"injector",get:function(){return this._injector}},{key:"destroy",value:function(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(function(e){return e.destroy()}),this._destroyListeners.forEach(function(e){return e()}),this._destroyed=!0}},{key:"destroyed",get:function(){return this._destroyed}}]),e}();return e.\u0275fac=function(t){return new(t||e)(wi(_o))},e.\u0275prov=Ae({token:e,factory:e.\u0275fac}),e}();function pu(e,t){return Array.isArray(t)?t.reduce(pu,e):Object.assign(Object.assign({},e),t)}var gu,mu=((gu=function(){function e(t,n,i,r,a){var o=this;y(this,e),this._zone=t,this._injector=n,this._exceptionHandler=i,this._componentFactoryResolver=r,this._initStatus=a,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:function(){o._zone.run(function(){o.tick()})}});var s=new N(function(e){o._stable=o._zone.isStable&&!o._zone.hasPendingMacrotasks&&!o._zone.hasPendingMicrotasks,o._zone.runOutsideAngular(function(){e.next(o._stable),e.complete()})}),l=new N(function(e){var t;o._zone.runOutsideAngular(function(){t=o._zone.onStable.subscribe(function(){$c.assertNotInAngularZone(),Kc(function(){o._stable||o._zone.hasPendingMacrotasks||o._zone.hasPendingMicrotasks||(o._stable=!0,e.next(!0))})})});var n=o._zone.onUnstable.subscribe(function(){$c.assertInAngularZone(),o._stable&&(o._stable=!1,o._zone.runOutsideAngular(function(){e.next(!1)}))});return function(){t.unsubscribe(),n.unsubscribe()}});this.isStable=ce(s,l.pipe(function(e){return ue()(me(ye)(e))}))}return k(e,[{key:"bootstrap",value:function(e,t){var n,i=this;if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");n=e instanceof nl?e:this._componentFactoryResolver.resolveComponentFactory(e),this.componentTypes.push(n.componentType);var r=n.isBoundToModule?void 0:this._injector.get(Ul),a=n.create(_o.NULL,[],t||n.selector,r),o=a.location.nativeElement,s=a.injector.get(au,null),l=s&&a.injector.get(ou);return s&&l&&l.registerApplication(o,s),a.onDestroy(function(){i.detachView(a.hostView),vu(i.components,a),l&&l.unregisterApplication(o)}),this._loadComponent(a),a}},{key:"tick",value:function(){var e=this;if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;var t,n=a(this._views);try{for(n.s();!(t=n.n()).done;)t.value.detectChanges()}catch(i){n.e(i)}finally{n.f()}}catch(r){this._zone.runOutsideAngular(function(){return e._exceptionHandler.handleError(r)})}finally{this._runningTick=!1}}},{key:"attachView",value:function(e){var t=e;this._views.push(t),t.attachToAppRef(this)}},{key:"detachView",value:function(e){var t=e;vu(this._views,t),t.detachFromAppRef()}},{key:"_loadComponent",value:function(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(zc,[]).concat(this._bootstrapListeners).forEach(function(t){return t(e)})}},{key:"ngOnDestroy",value:function(){this._views.slice().forEach(function(e){return e.destroy()}),this._onMicrotaskEmptySubscription.unsubscribe()}},{key:"viewCount",get:function(){return this._views.length}}]),e}()).\u0275fac=function(e){return new(e||gu)(wi($c),wi(_o),wi(vr),wi(rl),wi(Ac))},gu.\u0275prov=Ae({token:gu,factory:gu.\u0275fac}),gu);function vu(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}var yu=hu(null,"core",[{provide:Nc,useValue:"unknown"},{provide:fu,deps:[_o]},{provide:ou,deps:[]},{provide:Lc,deps:[]}]),bu=[{provide:mu,useClass:mu,deps:[$c,_o,vr,rl,Ac]},{provide:$l,deps:[$c],useFactory:function(e){var t=[];return e.onStable.subscribe(function(){for(;t.length;)t.pop()()}),function(e){t.push(e)}}},{provide:Ac,useClass:Ac,deps:[[new Oi,Mc]]},{provide:qc,useClass:qc,deps:[]},Dc,{provide:Sl,useFactory:function(){return Fl},deps:[]},{provide:Ol,useFactory:function(){return Nl},deps:[]},{provide:Bc,useFactory:function(e){return Ys(e=e||"undefined"!=typeof $localize&&$localize.locale||"en-US"),e},deps:[[new Ti(Bc),new Oi,new Ii]]},{provide:jc,useValue:"USD"}],ku=function(){var e=function e(t){y(this,e)};return e.\u0275fac=function(t){return new(t||e)(wi(mu))},e.\u0275mod=pt({type:e}),e.\u0275inj=Pe({providers:bu}),e}(),_u=null;function wu(){return _u}var xu=new si("DocumentToken"),Cu=function(e){return e[e.Zero=0]="Zero",e[e.One=1]="One",e[e.Two=2]="Two",e[e.Few=3]="Few",e[e.Many=4]="Many",e[e.Other=5]="Other",e}({}),Eu=function(e){return e[e.Format=0]="Format",e[e.Standalone=1]="Standalone",e}({}),Su=function(e){return e[e.Narrow=0]="Narrow",e[e.Abbreviated=1]="Abbreviated",e[e.Wide=2]="Wide",e[e.Short=3]="Short",e}({}),Tu=function(e){return e[e.Short=0]="Short",e[e.Medium=1]="Medium",e[e.Long=2]="Long",e[e.Full=3]="Full",e}({}),Ou=function(e){return e[e.Decimal=0]="Decimal",e[e.Group=1]="Group",e[e.List=2]="List",e[e.PercentSign=3]="PercentSign",e[e.PlusSign=4]="PlusSign",e[e.MinusSign=5]="MinusSign",e[e.Exponential=6]="Exponential",e[e.SuperscriptingExponent=7]="SuperscriptingExponent",e[e.PerMille=8]="PerMille",e[e[1/0]=9]="Infinity",e[e.NaN=10]="NaN",e[e.TimeSeparator=11]="TimeSeparator",e[e.CurrencyDecimal=12]="CurrencyDecimal",e[e.CurrencyGroup=13]="CurrencyGroup",e}({});function Iu(e,t){return Ru(Ws(e)[Zs.DateFormat],t)}function Mu(e,t){return Ru(Ws(e)[Zs.TimeFormat],t)}function Au(e,t){return Ru(Ws(e)[Zs.DateTimeFormat],t)}function Pu(e,t){var n=Ws(e),i=n[Zs.NumberSymbols][t];if(void 0===i){if(t===Ou.CurrencyDecimal)return n[Zs.NumberSymbols][Ou.Decimal];if(t===Ou.CurrencyGroup)return n[Zs.NumberSymbols][Ou.Group]}return i}function Du(e){if(!e[Zs.ExtraData])throw new Error('Missing extra locale data for the locale "'.concat(e[Zs.LocaleId],'". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.'))}function Ru(e,t){for(var n=t;n>-1;n--)if(void 0!==e[n])return e[n];throw new Error("Locale data API: locale data undefined")}function Fu(t){var n=e(t.split(":"),2);return{hours:+n[0],minutes:+n[1]}}var Nu=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,zu={},Lu=/((?:[^GyYMLwWdEabBhHmsSzZO']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/,Bu=function(e){return e[e.Short=0]="Short",e[e.ShortGMT=1]="ShortGMT",e[e.Long=2]="Long",e[e.Extended=3]="Extended",e}({}),ju=function(e){return e[e.FullYear=0]="FullYear",e[e.Month=1]="Month",e[e.Date=2]="Date",e[e.Hours=3]="Hours",e[e.Minutes=4]="Minutes",e[e.Seconds=5]="Seconds",e[e.FractionalSeconds=6]="FractionalSeconds",e[e.Day=7]="Day",e}({}),Uu=function(e){return e[e.DayPeriods=0]="DayPeriods",e[e.Days=1]="Days",e[e.Months=2]="Months",e[e.Eras=3]="Eras",e}({});function Hu(t,n,i,r){var a=function(t){if(th(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){var n=e(t.split("-").map(function(e){return+e}),3),i=n[0],r=n[1],a=void 0===r?1:r,o=n[2];return Vu(i,a-1,void 0===o?1:o)}var s,l=parseFloat(t);if(!isNaN(t-l))return new Date(l);if(s=t.match(Nu))return function(e){var t=new Date(0),n=0,i=0,r=e[8]?t.setUTCFullYear:t.setFullYear,a=e[8]?t.setUTCHours:t.setHours;e[9]&&(n=Number(e[9]+e[10]),i=Number(e[9]+e[11])),r.call(t,Number(e[1]),Number(e[2])-1,Number(e[3]));var o=Number(e[4]||0)-n,s=Number(e[5]||0)-i,l=Number(e[6]||0),c=Math.floor(1e3*parseFloat("0."+(e[7]||0)));return a.call(t,o,s,l,c),t}(s)}var c=new Date(t);if(!th(c))throw new Error('Unable to convert "'.concat(t,'" into a date'));return c}(t);n=Wu(i,n)||n;for(var o,s=[];n;){if(!(o=Lu.exec(n))){s.push(n);break}var l=(s=s.concat(o.slice(1))).pop();if(!l)break;n=l}var c=a.getTimezoneOffset();r&&(c=eh(r,c),a=function(e,t,n){var i=e.getTimezoneOffset();return function(e,t){return(e=new Date(e.getTime())).setMinutes(e.getMinutes()+t),e}(e,-1*(eh(t,i)-i))}(a,r));var u="";return s.forEach(function(e){var t=function(e){if(Ju[e])return Ju[e];var t;switch(e){case"G":case"GG":case"GGG":t=qu(Uu.Eras,Su.Abbreviated);break;case"GGGG":t=qu(Uu.Eras,Su.Wide);break;case"GGGGG":t=qu(Uu.Eras,Su.Narrow);break;case"y":t=Yu(ju.FullYear,1,0,!1,!0);break;case"yy":t=Yu(ju.FullYear,2,0,!0,!0);break;case"yyy":t=Yu(ju.FullYear,3,0,!1,!0);break;case"yyyy":t=Yu(ju.FullYear,4,0,!1,!0);break;case"Y":t=Qu(1);break;case"YY":t=Qu(2,!0);break;case"YYY":t=Qu(3);break;case"YYYY":t=Qu(4);break;case"M":case"L":t=Yu(ju.Month,1,1);break;case"MM":case"LL":t=Yu(ju.Month,2,1);break;case"MMM":t=qu(Uu.Months,Su.Abbreviated);break;case"MMMM":t=qu(Uu.Months,Su.Wide);break;case"MMMMM":t=qu(Uu.Months,Su.Narrow);break;case"LLL":t=qu(Uu.Months,Su.Abbreviated,Eu.Standalone);break;case"LLLL":t=qu(Uu.Months,Su.Wide,Eu.Standalone);break;case"LLLLL":t=qu(Uu.Months,Su.Narrow,Eu.Standalone);break;case"w":t=$u(1);break;case"ww":t=$u(2);break;case"W":t=$u(1,!0);break;case"d":t=Yu(ju.Date,1);break;case"dd":t=Yu(ju.Date,2);break;case"E":case"EE":case"EEE":t=qu(Uu.Days,Su.Abbreviated);break;case"EEEE":t=qu(Uu.Days,Su.Wide);break;case"EEEEE":t=qu(Uu.Days,Su.Narrow);break;case"EEEEEE":t=qu(Uu.Days,Su.Short);break;case"a":case"aa":case"aaa":t=qu(Uu.DayPeriods,Su.Abbreviated);break;case"aaaa":t=qu(Uu.DayPeriods,Su.Wide);break;case"aaaaa":t=qu(Uu.DayPeriods,Su.Narrow);break;case"b":case"bb":case"bbb":t=qu(Uu.DayPeriods,Su.Abbreviated,Eu.Standalone,!0);break;case"bbbb":t=qu(Uu.DayPeriods,Su.Wide,Eu.Standalone,!0);break;case"bbbbb":t=qu(Uu.DayPeriods,Su.Narrow,Eu.Standalone,!0);break;case"B":case"BB":case"BBB":t=qu(Uu.DayPeriods,Su.Abbreviated,Eu.Format,!0);break;case"BBBB":t=qu(Uu.DayPeriods,Su.Wide,Eu.Format,!0);break;case"BBBBB":t=qu(Uu.DayPeriods,Su.Narrow,Eu.Format,!0);break;case"h":t=Yu(ju.Hours,1,-12);break;case"hh":t=Yu(ju.Hours,2,-12);break;case"H":t=Yu(ju.Hours,1);break;case"HH":t=Yu(ju.Hours,2);break;case"m":t=Yu(ju.Minutes,1);break;case"mm":t=Yu(ju.Minutes,2);break;case"s":t=Yu(ju.Seconds,1);break;case"ss":t=Yu(ju.Seconds,2);break;case"S":t=Yu(ju.FractionalSeconds,1);break;case"SS":t=Yu(ju.FractionalSeconds,2);break;case"SSS":t=Yu(ju.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":t=Xu(Bu.Short);break;case"ZZZZZ":t=Xu(Bu.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":t=Xu(Bu.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":t=Xu(Bu.Long);break;default:return null}return Ju[e]=t,t}(e);u+=t?t(a,i,c):"''"===e?"'":e.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function Vu(e,t,n){var i=new Date(0);return i.setFullYear(e,t,n),i.setHours(0,0,0),i}function Wu(e,t){var n=function(e){return Ws(e)[Zs.LocaleId]}(e);if(zu[n]=zu[n]||{},zu[n][t])return zu[n][t];var i="";switch(t){case"shortDate":i=Iu(e,Tu.Short);break;case"mediumDate":i=Iu(e,Tu.Medium);break;case"longDate":i=Iu(e,Tu.Long);break;case"fullDate":i=Iu(e,Tu.Full);break;case"shortTime":i=Mu(e,Tu.Short);break;case"mediumTime":i=Mu(e,Tu.Medium);break;case"longTime":i=Mu(e,Tu.Long);break;case"fullTime":i=Mu(e,Tu.Full);break;case"short":var r=Wu(e,"shortTime"),a=Wu(e,"shortDate");i=Gu(Au(e,Tu.Short),[r,a]);break;case"medium":var o=Wu(e,"mediumTime"),s=Wu(e,"mediumDate");i=Gu(Au(e,Tu.Medium),[o,s]);break;case"long":var l=Wu(e,"longTime"),c=Wu(e,"longDate");i=Gu(Au(e,Tu.Long),[l,c]);break;case"full":var u=Wu(e,"fullTime"),h=Wu(e,"fullDate");i=Gu(Au(e,Tu.Full),[u,h])}return i&&(zu[n][t]=i),i}function Gu(e,t){return t&&(e=e.replace(/\{([^}]+)}/g,function(e,n){return null!=t&&n in t?t[n]:e})),e}function Zu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"-",i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0,a="";(e<0||r&&e<=0)&&(r?e=1-e:(e=-e,a=n));for(var o=String(e);o.length<t;)o="0"+o;return i&&(o=o.substr(o.length-t)),a+o}function Yu(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]&&arguments[4];return function(a,o){var s,l=function(e,t){switch(e){case ju.FullYear:return t.getFullYear();case ju.Month:return t.getMonth();case ju.Date:return t.getDate();case ju.Hours:return t.getHours();case ju.Minutes:return t.getMinutes();case ju.Seconds:return t.getSeconds();case ju.FractionalSeconds:return t.getMilliseconds();case ju.Day:return t.getDay();default:throw new Error('Unknown DateType value "'.concat(e,'".'))}}(e,a);if((n>0||l>-n)&&(l+=n),e===ju.Hours)0===l&&-12===n&&(l=12);else if(e===ju.FractionalSeconds)return s=t,Zu(l,3).substr(0,s);var c=Pu(o,Ou.MinusSign);return Zu(l,t,c,i,r)}}function qu(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Eu.Format,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return function(a,o){return function(t,n,i,r,a,o){switch(i){case Uu.Months:return function(e,t,n){var i=Ws(e),r=Ru([i[Zs.MonthsFormat],i[Zs.MonthsStandalone]],t);return Ru(r,n)}(n,a,r)[t.getMonth()];case Uu.Days:return function(e,t,n){var i=Ws(e),r=Ru([i[Zs.DaysFormat],i[Zs.DaysStandalone]],t);return Ru(r,n)}(n,a,r)[t.getDay()];case Uu.DayPeriods:var s=t.getHours(),l=t.getMinutes();if(o){var c=function(e){var t=Ws(e);return Du(t),(t[Zs.ExtraData][2]||[]).map(function(e){return"string"==typeof e?Fu(e):[Fu(e[0]),Fu(e[1])]})}(n),u=function(e,t,n){var i=Ws(e);Du(i);var r=Ru([i[Zs.ExtraData][0],i[Zs.ExtraData][1]],t)||[];return Ru(r,n)||[]}(n,a,r),h=c.findIndex(function(t){if(Array.isArray(t)){var n=e(t,2),i=n[0],r=n[1],a=s>=i.hours&&l>=i.minutes,o=s<r.hours||s===r.hours&&l<r.minutes;if(i.hours<r.hours){if(a&&o)return!0}else if(a||o)return!0}else if(t.hours===s&&t.minutes===l)return!0;return!1});if(-1!==h)return u[h]}return function(e,t,n){var i=Ws(e),r=Ru([i[Zs.DayPeriodsFormat],i[Zs.DayPeriodsStandalone]],t);return Ru(r,n)}(n,a,r)[s<12?0:1];case Uu.Eras:return function(e,t){return Ru(Ws(e)[Zs.Eras],t)}(n,r)[t.getFullYear()<=0?0:1];default:throw new Error("unexpected translation type ".concat(i))}}(a,o,t,n,i,r)}}function Xu(e){return function(t,n,i){var r=-1*i,a=Pu(n,Ou.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(e){case Bu.Short:return(r>=0?"+":"")+Zu(o,2,a)+Zu(Math.abs(r%60),2,a);case Bu.ShortGMT:return"GMT"+(r>=0?"+":"")+Zu(o,1,a);case Bu.Long:return"GMT"+(r>=0?"+":"")+Zu(o,2,a)+":"+Zu(Math.abs(r%60),2,a);case Bu.Extended:return 0===i?"Z":(r>=0?"+":"")+Zu(o,2,a)+":"+Zu(Math.abs(r%60),2,a);default:throw new Error('Unknown zone width "'.concat(e,'"'))}}}function Ku(e){return Vu(e.getFullYear(),e.getMonth(),e.getDate()+(4-e.getDay()))}function $u(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,i){var r,a,o;if(t){var s=new Date(n.getFullYear(),n.getMonth(),1).getDay()-1,l=n.getDate();r=1+Math.floor((l+s)/7)}else{var c=Ku(n),u=(a=c.getFullYear(),o=Vu(a,0,1).getDay(),Vu(a,0,1+(o<=4?4:11)-o)),h=c.getTime()-u.getTime();r=1+Math.round(h/6048e5)}return Zu(r,e,Pu(i,Ou.MinusSign))}}function Qu(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,i){return Zu(Ku(n).getFullYear(),e,Pu(i,Ou.MinusSign),t)}}var Ju={};function eh(e,t){e=e.replace(/:/g,"");var n=Date.parse("Jan 01, 1970 00:00:00 "+e)/6e4;return isNaN(n)?t:n}function th(e){return e instanceof Date&&!isNaN(e.valueOf())}var nh,ih,rh,ah,oh=function e(){y(this,e)},sh=((ih=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this)).locale=e,i}return k(n,[{key:"getPluralCategory",value:function(e,t){switch(function(e){return Ws(e)[Zs.PluralCase]}(t||this.locale)(e)){case Cu.Zero:return"zero";case Cu.One:return"one";case Cu.Two:return"two";case Cu.Few:return"few";case Cu.Many:return"many";default:return"other"}}}]),n}(oh)).\u0275fac=function(e){return new(e||ih)(wi(Bc))},ih.\u0275prov=Ae({token:ih,factory:ih.\u0275fac}),ih),lh=((nh=function(){function e(t,n,i,r){y(this,e),this._iterableDiffers=t,this._keyValueDiffers=n,this._ngEl=i,this._renderer=r,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}return k(e,[{key:"klass",set:function(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}},{key:"ngClass",set:function(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Ao(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}},{key:"ngDoCheck",value:function(){if(this._iterableDiffer){var e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){var t=this._keyValueDiffer.diff(this._rawClass);t&&this._applyKeyValueChanges(t)}}},{key:"_applyKeyValueChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._toggleClass(e.key,e.currentValue)}),e.forEachRemovedItem(function(e){e.previousValue&&t._toggleClass(e.key,!1)})}},{key:"_applyIterableChanges",value:function(e){var t=this;e.forEachAddedItem(function(e){if("string"!=typeof e.item)throw new Error("NgClass can only toggle CSS classes expressed as strings, got ".concat(_e(e.item)));t._toggleClass(e.item,!0)}),e.forEachRemovedItem(function(e){return t._toggleClass(e.item,!1)})}},{key:"_applyClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!0)}):Object.keys(e).forEach(function(n){return t._toggleClass(n,!!e[n])}))}},{key:"_removeClasses",value:function(e){var t=this;e&&(Array.isArray(e)||e instanceof Set?e.forEach(function(e){return t._toggleClass(e,!1)}):Object.keys(e).forEach(function(e){return t._toggleClass(e,!1)}))}},{key:"_toggleClass",value:function(e,t){var n=this;(e=e.trim())&&e.split(/\s+/g).forEach(function(e){t?n._renderer.addClass(n._ngEl.nativeElement,e):n._renderer.removeClass(n._ngEl.nativeElement,e)})}}]),e}()).\u0275fac=function(e){return new(e||nh)(Vo(Sl),Vo(Ol),Vo(ll),Vo(hl))},nh.\u0275dir=mt({type:nh,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),nh),ch=function(){function e(t,n,i,r){y(this,e),this.$implicit=t,this.ngForOf=n,this.index=i,this.count=r}return k(e,[{key:"first",get:function(){return 0===this.index}},{key:"last",get:function(){return this.index===this.count-1}},{key:"even",get:function(){return this.index%2==0}},{key:"odd",get:function(){return!this.even}}]),e}(),uh=((rh=function(){function e(t,n,i){y(this,e),this._viewContainer=t,this._template=n,this._differs=i,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}return k(e,[{key:"ngForOf",set:function(e){this._ngForOf=e,this._ngForOfDirty=!0}},{key:"ngForTrackBy",get:function(){return this._trackByFn},set:function(e){this._trackByFn=e}},{key:"ngForTemplate",set:function(e){e&&(this._template=e)}},{key:"ngDoCheck",value:function(){if(this._ngForOfDirty){this._ngForOfDirty=!1;var e=this._ngForOf;if(!this._differ&&e)try{this._differ=this._differs.find(e).create(this.ngForTrackBy)}catch(i){throw new Error("Cannot find a differ supporting object '".concat(e,"' of type '").concat((t=e).name||typeof t,"'. NgFor only supports binding to Iterables such as Arrays."))}}var t;if(this._differ){var n=this._differ.diff(this._ngForOf);n&&this._applyChanges(n)}}},{key:"_applyChanges",value:function(e){var t=this,n=[];e.forEachOperation(function(e,i,r){if(null==e.previousIndex){var a=t._viewContainer.createEmbeddedView(t._template,new ch(null,t._ngForOf,-1,-1),null===r?void 0:r),o=new hh(e,a);n.push(o)}else if(null==r)t._viewContainer.remove(null===i?void 0:i);else if(null!==i){var s=t._viewContainer.get(i);t._viewContainer.move(s,r);var l=new hh(e,s);n.push(l)}});for(var i=0;i<n.length;i++)this._perViewChange(n[i].view,n[i].record);for(var r=0,a=this._viewContainer.length;r<a;r++){var o=this._viewContainer.get(r);o.context.index=r,o.context.count=a,o.context.ngForOf=this._ngForOf}e.forEachIdentityChange(function(e){t._viewContainer.get(e.currentIndex).context.$implicit=e.item})}},{key:"_perViewChange",value:function(e,t){e.context.$implicit=t.item}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||rh)(Vo(Vl),Vo(Ll),Vo(Sl))},rh.\u0275dir=mt({type:rh,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),rh),hh=function e(t,n){y(this,e),this.record=t,this.view=n},dh=((ah=function(){function e(t,n){y(this,e),this._viewContainer=t,this._context=new fh,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=n}return k(e,[{key:"ngIf",set:function(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}},{key:"ngIfThen",set:function(e){ph("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}},{key:"ngIfElse",set:function(e){ph("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}},{key:"_updateView",value:function(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}}],[{key:"ngTemplateContextGuard",value:function(e,t){return!0}}]),e}()).\u0275fac=function(e){return new(e||ah)(Vo(Vl),Vo(Ll))},ah.\u0275dir=mt({type:ah,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),ah),fh=function e(){y(this,e),this.$implicit=null,this.ngIf=null};function ph(e,t){if(t&&!t.createEmbeddedView)throw new Error("".concat(e," must be a TemplateRef, but received '").concat(_e(t),"'."))}var gh,mh,vh,yh,bh,kh,_h,wh=function(){function e(t,n){y(this,e),this._viewContainerRef=t,this._templateRef=n,this._created=!1}return k(e,[{key:"create",value:function(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}},{key:"destroy",value:function(){this._created=!1,this._viewContainerRef.clear()}},{key:"enforceState",value:function(e){e&&!this._created?this.create():!e&&this._created&&this.destroy()}}]),e}(),xh=((_h=function(){function e(){y(this,e),this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}return k(e,[{key:"ngSwitch",set:function(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}},{key:"_addCase",value:function(){return this._caseCount++}},{key:"_addDefault",value:function(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}},{key:"_matchCase",value:function(e){var t=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||t,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),t}},{key:"_updateDefaultCases",value:function(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(var t=0;t<this._defaultViews.length;t++)this._defaultViews[t].enforceState(e)}}}]),e}()).\u0275fac=function(e){return new(e||_h)},_h.\u0275dir=mt({type:_h,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),_h),Ch=((kh=function(){function e(t,n,i){y(this,e),this.ngSwitch=i,i._addCase(),this._view=new wh(t,n)}return k(e,[{key:"ngDoCheck",value:function(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}]),e}()).\u0275fac=function(e){return new(e||kh)(Vo(Vl),Vo(Ll),Vo(xh,1))},kh.\u0275dir=mt({type:kh,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),kh),Eh=((bh=function e(t,n,i){y(this,e),i._addDefault(new wh(t,n))}).\u0275fac=function(e){return new(e||bh)(Vo(Vl),Vo(Ll),Vo(xh,1))},bh.\u0275dir=mt({type:bh,selectors:[["","ngSwitchDefault",""]]}),bh),Sh=((yh=function(){function t(e,n,i){y(this,t),this._ngEl=e,this._differs=n,this._renderer=i,this._ngStyle=null,this._differ=null}return k(t,[{key:"ngStyle",set:function(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}},{key:"ngDoCheck",value:function(){if(this._differ){var e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}},{key:"_setStyle",value:function(t,n){var i=e(t.split("."),2),r=i[0],a=i[1];null!=(n=null!=n&&a?"".concat(n).concat(a):n)?this._renderer.setStyle(this._ngEl.nativeElement,r,n):this._renderer.removeStyle(this._ngEl.nativeElement,r)}},{key:"_applyChanges",value:function(e){var t=this;e.forEachRemovedItem(function(e){return t._setStyle(e.key,null)}),e.forEachAddedItem(function(e){return t._setStyle(e.key,e.currentValue)}),e.forEachChangedItem(function(e){return t._setStyle(e.key,e.currentValue)})}}]),t}()).\u0275fac=function(e){return new(e||yh)(Vo(ll),Vo(Ol),Vo(hl))},yh.\u0275dir=mt({type:yh,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),yh),Th=((vh=function(){function e(t){y(this,e),this._viewContainerRef=t,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}return k(e,[{key:"ngOnChanges",value:function(e){if(this._shouldRecreateView(e)){var t=this._viewContainerRef;this._viewRef&&t.remove(t.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?t.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&this.ngTemplateOutletContext&&this._updateExistingContext(this.ngTemplateOutletContext)}},{key:"_shouldRecreateView",value:function(e){var t=e.ngTemplateOutletContext;return!!e.ngTemplateOutlet||t&&this._hasContextShapeChanged(t)}},{key:"_hasContextShapeChanged",value:function(e){var t=Object.keys(e.previousValue||{}),n=Object.keys(e.currentValue||{});if(t.length===n.length){var i,r=a(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;if(-1===t.indexOf(o))return!0}}catch(s){r.e(s)}finally{r.f()}return!1}return!0}},{key:"_updateExistingContext",value:function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];this._viewRef.context[i]=this.ngTemplateOutletContext[i]}}}]),e}()).\u0275fac=function(e){return new(e||vh)(Vo(Vl))},vh.\u0275dir=mt({type:vh,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[It]}),vh),Oh=((mh=function(){function e(t){y(this,e),this.locale=t}return k(e,[{key:"transform",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mediumDate",i=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;if(null==t||""===t||t!=t)return null;try{return Hu(t,n,r||this.locale,i)}catch(a){throw function(e,t){return Error("InvalidPipeArgument: '".concat(t,"' for pipe '").concat(_e(e),"'"))}(e,a.message)}}}]),e}()).\u0275fac=function(e){return new(e||mh)(Vo(Bc))},mh.\u0275pipe=vt({name:"date",type:mh,pure:!0}),mh),Ih=((gh=function e(){y(this,e)}).\u0275fac=function(e){return new(e||gh)},gh.\u0275mod=pt({type:gh}),gh.\u0275inj=Pe({providers:[{provide:oh,useClass:sh}]}),gh);function Mh(e){return"browser"===e}var Ah,Ph,Dh,Rh,Fh=function(t){h(i,t);var n=f(i);function i(){return y(this,i),n.apply(this,arguments)}return k(i,[{key:"getProperty",value:function(e,t){return e[t]}},{key:"log",value:function(e){window.console&&window.console.log&&window.console.log(e)}},{key:"logGroup",value:function(e){window.console&&window.console.group&&window.console.group(e)}},{key:"logGroupEnd",value:function(){window.console&&window.console.groupEnd&&window.console.groupEnd()}},{key:"onAndCancel",value:function(e,t,n){return e.addEventListener(t,n,!1),function(){e.removeEventListener(t,n,!1)}}},{key:"dispatchEvent",value:function(e,t){e.dispatchEvent(t)}},{key:"remove",value:function(e){return e.parentNode&&e.parentNode.removeChild(e),e}},{key:"getValue",value:function(e){return e.value}},{key:"createElement",value:function(e,t){return(t=t||this.getDefaultDocument()).createElement(e)}},{key:"createHtmlDocument",value:function(){return document.implementation.createHTMLDocument("fakeTitle")}},{key:"getDefaultDocument",value:function(){return document}},{key:"isElementNode",value:function(e){return e.nodeType===Node.ELEMENT_NODE}},{key:"isShadowRoot",value:function(e){return e instanceof DocumentFragment}},{key:"getGlobalEventTarget",value:function(e,t){return"window"===t?window:"document"===t?e:"body"===t?e.body:null}},{key:"getHistory",value:function(){return window.history}},{key:"getLocation",value:function(){return window.location}},{key:"getBaseHref",value:function(e){var t,n=Nh||(Nh=document.querySelector("base"))?Nh.getAttribute("href"):null;return null==n?null:(t=n,Ah||(Ah=document.createElement("a")),Ah.setAttribute("href",t),"/"===Ah.pathname.charAt(0)?Ah.pathname:"/"+Ah.pathname)}},{key:"resetBaseElement",value:function(){Nh=null}},{key:"getUserAgent",value:function(){return window.navigator.userAgent}},{key:"performanceNow",value:function(){return window.performance&&window.performance.now?window.performance.now():(new Date).getTime()}},{key:"supportsCookies",value:function(){return!0}},{key:"getCookie",value:function(t){return function(t,n){n=encodeURIComponent(n);var i,r=a(t.split(";"));try{for(r.s();!(i=r.n()).done;){var o=i.value,s=o.indexOf("="),l=e(-1==s?[o,""]:[o.slice(0,s),o.slice(s+1)],2),c=l[0],u=l[1];if(c.trim()===n)return decodeURIComponent(u)}}catch(h){r.e(h)}finally{r.f()}return null}(document.cookie,t)}}],[{key:"makeCurrent",value:function(){var e;e=new i,_u||(_u=e)}}]),i}(function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.call(this)}return k(n,[{key:"supportsDOMEvents",value:function(){return!0}}]),n}(function(){return function e(){y(this,e)}}())),Nh=null,zh=new si("TRANSITION_ID"),Lh=[{provide:Mc,useFactory:function(e,t,n){return function(){n.get(Ac).donePromise.then(function(){var n=wu();Array.prototype.slice.apply(t.querySelectorAll("style[ng-transition]")).filter(function(t){return t.getAttribute("ng-transition")===e}).forEach(function(e){return n.remove(e)})})}},deps:[zh,xu,_o],multi:!0}],Bh=function(){function e(){y(this,e)}return k(e,[{key:"addToWindow",value:function(e){$e.getAngularTestability=function(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e.findTestabilityInTree(t,n);if(null==i)throw new Error("Could not find testability for element.");return i},$e.getAllAngularTestabilities=function(){return e.getAllTestabilities()},$e.getAllAngularRootElements=function(){return e.getAllRootElements()},$e.frameworkStabilizers||($e.frameworkStabilizers=[]),$e.frameworkStabilizers.push(function(e){var t=$e.getAllAngularTestabilities(),n=t.length,i=!1,r=function(t){i=i||t,0==--n&&e(i)};t.forEach(function(e){e.whenStable(r)})})}},{key:"findTestabilityInTree",value:function(e,t,n){if(null==t)return null;var i=e.getTestability(t);return null!=i?i:n?wu().isShadowRoot(t)?this.findTestabilityInTree(e,t.host,!0):this.findTestabilityInTree(e,t.parentElement,!0):null}}],[{key:"init",value:function(){var t;t=new e,su=t}}]),e}(),jh=new si("EventManagerPlugins"),Uh=((Ph=function(){function e(t,n){var i=this;y(this,e),this._zone=n,this._eventNameToPlugin=new Map,t.forEach(function(e){return e.manager=i}),this._plugins=t.slice().reverse()}return k(e,[{key:"addEventListener",value:function(e,t,n){return this._findPluginFor(t).addEventListener(e,t,n)}},{key:"addGlobalEventListener",value:function(e,t,n){return this._findPluginFor(t).addGlobalEventListener(e,t,n)}},{key:"getZone",value:function(){return this._zone}},{key:"_findPluginFor",value:function(e){var t=this._eventNameToPlugin.get(e);if(t)return t;for(var n=this._plugins,i=0;i<n.length;i++){var r=n[i];if(r.supports(e))return this._eventNameToPlugin.set(e,r),r}throw new Error("No event manager plugin found for event ".concat(e))}}]),e}()).\u0275fac=function(e){return new(e||Ph)(wi(jh),wi($c))},Ph.\u0275prov=Ae({token:Ph,factory:Ph.\u0275fac}),Ph),Hh=function(){function e(t){y(this,e),this._doc=t}return k(e,[{key:"addGlobalEventListener",value:function(e,t,n){var i=wu().getGlobalEventTarget(this._doc,e);if(!i)throw new Error("Unsupported event target ".concat(i," for event ").concat(t));return this.addEventListener(i,t,n)}}]),e}(),Vh=((Rh=function(){function e(){y(this,e),this._stylesSet=new Set}return k(e,[{key:"addStyles",value:function(e){var t=this,n=new Set;e.forEach(function(e){t._stylesSet.has(e)||(t._stylesSet.add(e),n.add(e))}),this.onStylesAdded(n)}},{key:"onStylesAdded",value:function(e){}},{key:"getAllStyles",value:function(){return Array.from(this._stylesSet)}}]),e}()).\u0275fac=function(e){return new(e||Rh)},Rh.\u0275prov=Ae({token:Rh,factory:Rh.\u0275fac}),Rh),Wh=((Dh=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this))._doc=e,i._hostNodes=new Set,i._styleNodes=new Set,i._hostNodes.add(e.head),i}return k(n,[{key:"_addStylesToHost",value:function(e,t){var n=this;e.forEach(function(e){var i=n._doc.createElement("style");i.textContent=e,n._styleNodes.add(t.appendChild(i))})}},{key:"addHost",value:function(e){this._addStylesToHost(this._stylesSet,e),this._hostNodes.add(e)}},{key:"removeHost",value:function(e){this._hostNodes.delete(e)}},{key:"onStylesAdded",value:function(e){var t=this;this._hostNodes.forEach(function(n){return t._addStylesToHost(e,n)})}},{key:"ngOnDestroy",value:function(){this._styleNodes.forEach(function(e){return wu().remove(e)})}}]),n}(Vh)).\u0275fac=function(e){return new(e||Dh)(wi(xu))},Dh.\u0275prov=Ae({token:Dh,factory:Dh.\u0275fac}),Dh),Gh={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Zh=/%COMP%/g;function Yh(e,t,n){for(var i=0;i<t.length;i++){var r=t[i];Array.isArray(r)?Yh(e,r,n):(r=r.replace(Zh,e),n.push(r))}return n}function qh(e){return function(t){if("__ngUnwrap__"===t)return e;!1===e(t)&&(t.preventDefault(),t.returnValue=!1)}}var Xh,Kh,$h,Qh,Jh,ed,td=((Xh=function(){function e(t,n,i){y(this,e),this.eventManager=t,this.sharedStylesHost=n,this.appId=i,this.rendererByCompId=new Map,this.defaultRenderer=new nd(t)}return k(e,[{key:"createRenderer",value:function(e,t){if(!e||!t)return this.defaultRenderer;switch(t.encapsulation){case Ze.Emulated:var n=this.rendererByCompId.get(t.id);return n||(n=new id(this.eventManager,this.sharedStylesHost,t,this.appId),this.rendererByCompId.set(t.id,n)),n.applyToHost(e),n;case 1:case Ze.ShadowDom:return new rd(this.eventManager,this.sharedStylesHost,e,t);default:if(!this.rendererByCompId.has(t.id)){var i=Yh(t.id,t.styles,[]);this.sharedStylesHost.addStyles(i),this.rendererByCompId.set(t.id,this.defaultRenderer)}return this.defaultRenderer}}},{key:"begin",value:function(){}},{key:"end",value:function(){}}]),e}()).\u0275fac=function(e){return new(e||Xh)(wi(Uh),wi(Wh),wi(Pc))},Xh.\u0275prov=Ae({token:Xh,factory:Xh.\u0275fac}),Xh),nd=function(){function e(t){y(this,e),this.eventManager=t,this.data=Object.create(null)}return k(e,[{key:"destroy",value:function(){}},{key:"createElement",value:function(e,t){return t?document.createElementNS(Gh[t]||t,e):document.createElement(e)}},{key:"createComment",value:function(e){return document.createComment(e)}},{key:"createText",value:function(e){return document.createTextNode(e)}},{key:"appendChild",value:function(e,t){e.appendChild(t)}},{key:"insertBefore",value:function(e,t,n){e&&e.insertBefore(t,n)}},{key:"removeChild",value:function(e,t){e&&e.removeChild(t)}},{key:"selectRootElement",value:function(e,t){var n="string"==typeof e?document.querySelector(e):e;if(!n)throw new Error('The selector "'.concat(e,'" did not match any elements'));return t||(n.textContent=""),n}},{key:"parentNode",value:function(e){return e.parentNode}},{key:"nextSibling",value:function(e){return e.nextSibling}},{key:"setAttribute",value:function(e,t,n,i){if(i){t=i+":"+t;var r=Gh[i];r?e.setAttributeNS(r,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}},{key:"removeAttribute",value:function(e,t,n){if(n){var i=Gh[n];i?e.removeAttributeNS(i,t):e.removeAttribute("".concat(n,":").concat(t))}else e.removeAttribute(t)}},{key:"addClass",value:function(e,t){e.classList.add(t)}},{key:"removeClass",value:function(e,t){e.classList.remove(t)}},{key:"setStyle",value:function(e,t,n,i){i&(_r.DashCase|_r.Important)?e.style.setProperty(t,n,i&_r.Important?"important":""):e.style[t]=n}},{key:"removeStyle",value:function(e,t,n){n&_r.DashCase?e.style.removeProperty(t):e.style[t]=""}},{key:"setProperty",value:function(e,t,n){e[t]=n}},{key:"setValue",value:function(e,t){e.nodeValue=t}},{key:"listen",value:function(e,t,n){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,t,qh(n)):this.eventManager.addEventListener(e,t,qh(n))}}]),e}(),id=function(e){h(n,e);var t=f(n);function n(e,i,r,a){var o;y(this,n),(o=t.call(this,e)).component=r;var s=Yh(a+"-"+r.id,r.styles,[]);return i.addStyles(s),o.contentAttr="_ngcontent-%COMP%".replace(Zh,a+"-"+r.id),o.hostAttr="_nghost-%COMP%".replace(Zh,a+"-"+r.id),o}return k(n,[{key:"applyToHost",value:function(e){u(v(n.prototype),"setAttribute",this).call(this,e,this.hostAttr,"")}},{key:"createElement",value:function(e,t){var i=u(v(n.prototype),"createElement",this).call(this,e,t);return u(v(n.prototype),"setAttribute",this).call(this,i,this.contentAttr,""),i}}]),n}(nd),rd=function(e){h(n,e);var t=f(n);function n(e,i,r,a){var o;y(this,n),(o=t.call(this,e)).sharedStylesHost=i,o.hostEl=r,o.shadowRoot=r.attachShadow({mode:"open"}),o.sharedStylesHost.addHost(o.shadowRoot);for(var s=Yh(a.id,a.styles,[]),l=0;l<s.length;l++){var c=document.createElement("style");c.textContent=s[l],o.shadowRoot.appendChild(c)}return o}return k(n,[{key:"nodeOrShadowRoot",value:function(e){return e===this.hostEl?this.shadowRoot:e}},{key:"destroy",value:function(){this.sharedStylesHost.removeHost(this.shadowRoot)}},{key:"appendChild",value:function(e,t){return u(v(n.prototype),"appendChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"insertBefore",value:function(e,t,i){return u(v(n.prototype),"insertBefore",this).call(this,this.nodeOrShadowRoot(e),t,i)}},{key:"removeChild",value:function(e,t){return u(v(n.prototype),"removeChild",this).call(this,this.nodeOrShadowRoot(e),t)}},{key:"parentNode",value:function(e){return this.nodeOrShadowRoot(u(v(n.prototype),"parentNode",this).call(this,this.nodeOrShadowRoot(e)))}}]),n}(nd),ad=((Kh=function(e){h(n,e);var t=f(n);function n(e){return y(this,n),t.call(this,e)}return k(n,[{key:"supports",value:function(e){return!0}},{key:"addEventListener",value:function(e,t,n){var i=this;return e.addEventListener(t,n,!1),function(){return i.removeEventListener(e,t,n)}}},{key:"removeEventListener",value:function(e,t,n){return e.removeEventListener(t,n)}}]),n}(Hh)).\u0275fac=function(e){return new(e||Kh)(wi(xu))},Kh.\u0275prov=Ae({token:Kh,factory:Kh.\u0275fac}),Kh),od=["alt","control","meta","shift"],sd={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},ld={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},cd={alt:function(e){return e.altKey},control:function(e){return e.ctrlKey},meta:function(e){return e.metaKey},shift:function(e){return e.shiftKey}},ud=((Jh=function(e){h(n,e);var t=f(n);function n(e){return y(this,n),t.call(this,e)}return k(n,[{key:"supports",value:function(e){return null!=n.parseEventName(e)}},{key:"addEventListener",value:function(e,t,i){var r=n.parseEventName(t),a=n.eventCallback(r.fullKey,i,this.manager.getZone());return this.manager.getZone().runOutsideAngular(function(){return wu().onAndCancel(e,r.domEventName,a)})}}],[{key:"parseEventName",value:function(e){var t=e.toLowerCase().split("."),i=t.shift();if(0===t.length||"keydown"!==i&&"keyup"!==i)return null;var r=n._normalizeKey(t.pop()),a="";if(od.forEach(function(e){var n=t.indexOf(e);n>-1&&(t.splice(n,1),a+=e+".")}),a+=r,0!=t.length||0===r.length)return null;var o={};return o.domEventName=i,o.fullKey=a,o}},{key:"getEventFullKey",value:function(e){var t="",n=function(e){var t=e.key;if(null==t){if(null==(t=e.keyIdentifier))return"Unidentified";t.startsWith("U+")&&(t=String.fromCharCode(parseInt(t.substring(2),16)),3===e.location&&ld.hasOwnProperty(t)&&(t=ld[t]))}return sd[t]||t}(e);return" "===(n=n.toLowerCase())?n="space":"."===n&&(n="dot"),od.forEach(function(i){i!=n&&(0,cd[i])(e)&&(t+=i+".")}),t+=n}},{key:"eventCallback",value:function(e,t,i){return function(r){n.getEventFullKey(r)===e&&i.runGuarded(function(){return t(r)})}}},{key:"_normalizeKey",value:function(e){switch(e){case"esc":return"escape";default:return e}}}]),n}(Hh)).\u0275fac=function(e){return new(e||Jh)(wi(xu))},Jh.\u0275prov=Ae({token:Jh,factory:Jh.\u0275fac}),Jh),hd=((Qh=function e(){y(this,e)}).\u0275fac=function(e){return new(e||Qh)},Qh.\u0275prov=Ae({factory:function(){return wi(dd)},token:Qh,providedIn:"root"}),Qh),dd=(($h=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this))._doc=e,i}return k(n,[{key:"sanitize",value:function(e,t){if(null==t)return null;switch(e){case ur.NONE:return t;case ur.HTML:return Bi(t,"HTML")?Li(t):lr(this._doc,String(t)).toString();case ur.STYLE:return Bi(t,"Style")?Li(t):t;case ur.SCRIPT:if(Bi(t,"Script"))return Li(t);throw new Error("unsafe value used in a script context");case ur.URL:return ji(t),Bi(t,"URL")?Li(t):Gi(String(t));case ur.RESOURCE_URL:if(Bi(t,"ResourceURL"))return Li(t);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error("Unexpected SecurityContext ".concat(e," (see https://g.co/ng/security#xss)"))}}},{key:"bypassSecurityTrustHtml",value:function(e){return new Di(e)}},{key:"bypassSecurityTrustStyle",value:function(e){return new Ri(e)}},{key:"bypassSecurityTrustScript",value:function(e){return new Fi(e)}},{key:"bypassSecurityTrustUrl",value:function(e){return new Ni(e)}},{key:"bypassSecurityTrustResourceUrl",value:function(e){return new zi(e)}}]),n}(hd)).\u0275fac=function(e){return new(e||$h)(wi(xu))},$h.\u0275prov=Ae({factory:function(){return e=wi(ao),new dd(e.get(xu));var e},token:$h,providedIn:"root"}),$h),fd=hu(yu,"browser",[{provide:Nc,useValue:"browser"},{provide:Fc,useValue:function(){Fh.makeCurrent(),Bh.init()},multi:!0},{provide:xu,useFactory:function(){return function(e){Tt=e}(document),document},deps:[]}]),pd=[[],{provide:so,useValue:"root"},{provide:vr,useFactory:function(){return new vr},deps:[]},{provide:jh,useClass:ad,multi:!0,deps:[xu,$c,Nc]},{provide:jh,useClass:ud,multi:!0,deps:[xu]},[],{provide:td,useClass:td,deps:[Uh,Wh,Pc]},{provide:ul,useExisting:td},{provide:Vh,useExisting:Wh},{provide:Wh,useClass:Wh,deps:[xu]},{provide:au,useClass:au,deps:[$c]},{provide:Uh,useClass:Uh,deps:[jh,$c]},[]],gd=((ed=function(){function e(t){if(y(this,e),t)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}return k(e,null,[{key:"withServerTransition",value:function(t){return{ngModule:e,providers:[{provide:Pc,useValue:t.appId},{provide:zh,useExisting:Pc},Lh]}}}]),e}()).\u0275fac=function(e){return new(e||ed)(wi(ed,12))},ed.\u0275mod=pt({type:ed}),ed.\u0275inj=Pe({providers:pd,imports:[Ih,ku]}),ed);function md(e,t){return new N(function(n){var i=e.length;if(0!==i)for(var r=new Array(i),a=0,o=0,s=function(s){var l=ee(e[s]),c=!1;n.add(l.subscribe({next:function(e){c||(c=!0,o++),r[s]=e},error:function(e){return n.error(e)},complete:function(){++a!==i&&c||(o===i&&n.next(t?t.reduce(function(e,t,n){return e[t]=r[n],e},{}):r),n.complete())}}))},l=0;l<i;l++)s(l);else n.complete()})}"undefined"!=typeof window&&window,p("yLV6");var vd,yd,bd=function e(){y(this,e)},kd=new si("NgValueAccessor"),_d={provide:kd,useExisting:Ce(function(){return wd}),multi:!0},wd=((vd=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._renderer=e,r._elementRef=i,r.onChange=function(e){},r.onTouched=function(){},r}return k(n,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"checked",e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),n}(bd)).\u0275fac=function(e){return new(e||vd)(Vo(hl),Vo(ll))},vd.\u0275dir=mt({type:vd,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,t){1&e&&es("change",function(e){return t.onChange(e.target.checked)})("blur",function(){return t.onTouched()})},features:[tl([_d]),xo]}),vd),xd={provide:kd,useExisting:Ce(function(){return Ed}),multi:!0},Cd=new si("CompositionEventMode"),Ed=((yd=function(){function e(t,n,i){var r;y(this,e),this._renderer=t,this._elementRef=n,this._compositionMode=i,this.onChange=function(e){},this.onTouched=function(){},this._composing=!1,null==this._compositionMode&&(this._compositionMode=(r=wu()?wu().getUserAgent():"",!/android (\d+)/.test(r.toLowerCase())))}return k(e,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=e}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_handleInput",value:function(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}},{key:"_compositionStart",value:function(){this._composing=!0}},{key:"_compositionEnd",value:function(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}]),e}()).\u0275fac=function(e){return new(e||yd)(Vo(hl),Vo(ll),Vo(Cd,8))},yd.\u0275dir=mt({type:yd,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,t){1&e&&es("input",function(e){return t._handleInput(e.target.value)})("blur",function(){return t.onTouched()})("compositionstart",function(){return t._compositionStart()})("compositionend",function(e){return t._compositionEnd(e.target.value)})},features:[tl([xd])]}),yd);function Sd(e){return null==e||0===e.length}function Td(e){return null!=e&&"number"==typeof e.length}var Od=new si("NgValidators"),Id=new si("NgAsyncValidators");function Md(e){return null}function Ad(e){return null!=e}function Pd(e){var t=Jo(e)?ee(e):e;return t}function Dd(e){var t={};return e.forEach(function(e){t=null!=e?Object.assign(Object.assign({},t),e):t}),0===Object.keys(t).length?null:t}function Rd(e,t){return t.map(function(t){return t(e)})}function Fd(e){return e.map(function(e){return function(e){return!e.validate}(e)?e:function(t){return e.validate(t)}})}function Nd(e){return null!=e?function(e){if(!e)return null;var t=e.filter(Ad);return 0==t.length?null:function(e){return Dd(Rd(e,t))}}(Fd(e)):null}function zd(e){return null!=e?function(e){if(!e)return null;var t=e.filter(Ad);return 0==t.length?null:function(e){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(1===t.length){var r=t[0];if(C(r))return md(r,null);if(E(r)&&Object.getPrototypeOf(r)===Object.prototype){var a=Object.keys(r);return md(a.map(function(e){return r[e]}),a)}}if("function"==typeof t[t.length-1]){var o=t.pop();return md(t=1===t.length&&C(t[0])?t[0]:t,null).pipe(G(function(e){return o.apply(void 0,i(e))}))}return md(t,null)}(Rd(e,t).map(Pd)).pipe(G(Dd))}}(Fd(e)):null}function Ld(e,t){return null===e?[t]:Array.isArray(e)?[].concat(i(e),[t]):[e,t]}var Bd,jd,Ud,Hd,Vd,Wd=((jd=function(){function e(){y(this,e),this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}return k(e,[{key:"value",get:function(){return this.control?this.control.value:null}},{key:"valid",get:function(){return this.control?this.control.valid:null}},{key:"invalid",get:function(){return this.control?this.control.invalid:null}},{key:"pending",get:function(){return this.control?this.control.pending:null}},{key:"disabled",get:function(){return this.control?this.control.disabled:null}},{key:"enabled",get:function(){return this.control?this.control.enabled:null}},{key:"errors",get:function(){return this.control?this.control.errors:null}},{key:"pristine",get:function(){return this.control?this.control.pristine:null}},{key:"dirty",get:function(){return this.control?this.control.dirty:null}},{key:"touched",get:function(){return this.control?this.control.touched:null}},{key:"status",get:function(){return this.control?this.control.status:null}},{key:"untouched",get:function(){return this.control?this.control.untouched:null}},{key:"statusChanges",get:function(){return this.control?this.control.statusChanges:null}},{key:"valueChanges",get:function(){return this.control?this.control.valueChanges:null}},{key:"path",get:function(){return null}},{key:"_setValidators",value:function(e){this._rawValidators=e||[],this._composedValidatorFn=Nd(this._rawValidators)}},{key:"_setAsyncValidators",value:function(e){this._rawAsyncValidators=e||[],this._composedAsyncValidatorFn=zd(this._rawAsyncValidators)}},{key:"validator",get:function(){return this._composedValidatorFn||null}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn||null}},{key:"_registerOnDestroy",value:function(e){this._onDestroyCallbacks.push(e)}},{key:"_invokeOnDestroyCallbacks",value:function(){this._onDestroyCallbacks.forEach(function(e){return e()}),this._onDestroyCallbacks=[]}},{key:"reset",value:function(e){this.control&&this.control.reset(e)}},{key:"hasError",value:function(e,t){return!!this.control&&this.control.hasError(e,t)}},{key:"getError",value:function(e,t){return this.control?this.control.getError(e,t):null}}]),e}()).\u0275fac=function(e){return new(e||jd)},jd.\u0275dir=mt({type:jd}),jd),Gd=((Bd=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"formDirective",get:function(){return null}},{key:"path",get:function(){return null}}]),n}(Wd)).\u0275fac=function(e){return Zd(e||Bd)},Bd.\u0275dir=mt({type:Bd,features:[xo]}),Bd),Zd=(Ud=Gd,We(function(){for(var e=Ud.prototype.constructor,t=e[ot]||ai(e),n=Object.prototype,i=Object.getPrototypeOf(Ud.prototype).constructor;i&&i!==n;){var r=i[ot]||ai(i);if(r&&r!==t)return r;i=Object.getPrototypeOf(i)}return function(e){return new e}})),Yd=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments))._parent=null,e.name=null,e.valueAccessor=null,e}return n}(Wd),qd=function(){function e(t){y(this,e),this._cd=t}return k(e,[{key:"is",value:function(e){var t,n;return!!(null===(n=null===(t=this._cd)||void 0===t?void 0:t.control)||void 0===n?void 0:n[e])}}]),e}(),Xd=((Vd=function(e){h(n,e);var t=f(n);function n(e){return y(this,n),t.call(this,e)}return n}(qd)).\u0275fac=function(e){return new(e||Vd)(Vo(Yd,2))},Vd.\u0275dir=mt({type:Vd,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,t){2&e&&_s("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[xo]}),Vd),Kd=((Hd=function(e){h(n,e);var t=f(n);function n(e){return y(this,n),t.call(this,e)}return n}(qd)).\u0275fac=function(e){return new(e||Hd)(Vo(Gd,10))},Hd.\u0275dir=mt({type:Hd,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:14,hostBindings:function(e,t){2&e&&_s("ng-untouched",t.is("untouched"))("ng-touched",t.is("touched"))("ng-pristine",t.is("pristine"))("ng-dirty",t.is("dirty"))("ng-valid",t.is("valid"))("ng-invalid",t.is("invalid"))("ng-pending",t.is("pending"))},features:[xo]}),Hd);function $d(e,t){Jd(e,t,!0),t.valueAccessor.writeValue(e.value),function(e,t){t.valueAccessor.registerOnChange(function(n){e._pendingValue=n,e._pendingChange=!0,e._pendingDirty=!0,"change"===e.updateOn&&ef(e,t)})}(e,t),function(e,t){var n=function(e,n){t.valueAccessor.writeValue(e),n&&t.viewToModelUpdate(e)};e.registerOnChange(n),t._registerOnDestroy(function(){e._unregisterOnChange(n)})}(e,t),function(e,t){t.valueAccessor.registerOnTouched(function(){e._pendingTouched=!0,"blur"===e.updateOn&&e._pendingChange&&ef(e,t),"submit"!==e.updateOn&&e.markAsTouched()})}(e,t),function(e,t){if(t.valueAccessor.setDisabledState){var n=function(e){t.valueAccessor.setDisabledState(e)};e.registerOnDisabledChange(n),t._registerOnDestroy(function(){e._unregisterOnDisabledChange(n)})}}(e,t)}function Qd(e,t){e.forEach(function(e){e.registerOnValidatorChange&&e.registerOnValidatorChange(t)})}function Jd(e,t,n){var i=function(e){return e._rawValidators}(e);null!==t.validator?e.setValidators(Ld(i,t.validator)):"function"==typeof i&&e.setValidators([i]);var r=function(e){return e._rawAsyncValidators}(e);if(null!==t.asyncValidator?e.setAsyncValidators(Ld(r,t.asyncValidator)):"function"==typeof r&&e.setAsyncValidators([r]),n){var a=function(){return e.updateValueAndValidity()};Qd(t._rawValidators,a),Qd(t._rawAsyncValidators,a)}}function ef(e,t){e._pendingDirty&&e.markAsDirty(),e.setValue(e._pendingValue,{emitModelToViewChange:!1}),t.viewToModelUpdate(e._pendingValue),e._pendingChange=!1}function tf(e,t){var n=e.indexOf(t);n>-1&&e.splice(n,1)}function nf(e){return(sf(e)?e.validators:e)||null}function rf(e){return Array.isArray(e)?Nd(e):e||null}function af(e,t){return(sf(t)?t.asyncValidators:e)||null}function of(e){return Array.isArray(e)?zd(e):e||null}function sf(e){return null!=e&&!Array.isArray(e)&&"object"==typeof e}var lf,cf,uf,hf,df,ff,pf,gf,mf=function(){function e(t,n){y(this,e),this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=function(){},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=t,this._rawAsyncValidators=n,this._composedValidatorFn=rf(this._rawValidators),this._composedAsyncValidatorFn=of(this._rawAsyncValidators)}return k(e,[{key:"validator",get:function(){return this._composedValidatorFn},set:function(e){this._rawValidators=this._composedValidatorFn=e}},{key:"asyncValidator",get:function(){return this._composedAsyncValidatorFn},set:function(e){this._rawAsyncValidators=this._composedAsyncValidatorFn=e}},{key:"parent",get:function(){return this._parent}},{key:"valid",get:function(){return"VALID"===this.status}},{key:"invalid",get:function(){return"INVALID"===this.status}},{key:"pending",get:function(){return"PENDING"==this.status}},{key:"disabled",get:function(){return"DISABLED"===this.status}},{key:"enabled",get:function(){return"DISABLED"!==this.status}},{key:"dirty",get:function(){return!this.pristine}},{key:"untouched",get:function(){return!this.touched}},{key:"updateOn",get:function(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}},{key:"setValidators",value:function(e){this._rawValidators=e,this._composedValidatorFn=rf(e)}},{key:"setAsyncValidators",value:function(e){this._rawAsyncValidators=e,this._composedAsyncValidatorFn=of(e)}},{key:"clearValidators",value:function(){this.validator=null}},{key:"clearAsyncValidators",value:function(){this.asyncValidator=null}},{key:"markAsTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!0,this._parent&&!e.onlySelf&&this._parent.markAsTouched(e)}},{key:"markAllAsTouched",value:function(){this.markAsTouched({onlySelf:!0}),this._forEachChild(function(e){return e.markAllAsTouched()})}},{key:"markAsUntouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=!1,this._pendingTouched=!1,this._forEachChild(function(e){e.markAsUntouched({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"markAsDirty",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!1,this._parent&&!e.onlySelf&&this._parent.markAsDirty(e)}},{key:"markAsPristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!0,this._pendingDirty=!1,this._forEachChild(function(e){e.markAsPristine({onlySelf:!0})}),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"markAsPending",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.status="PENDING",!1!==e.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!e.onlySelf&&this._parent.markAsPending(e)}},{key:"disable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="DISABLED",this.errors=null,this._forEachChild(function(t){t.disable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this._updateValue(),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!0)})}},{key:"enable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this._parentMarkedDirty(e.onlySelf);this.status="VALID",this._forEachChild(function(t){t.enable(Object.assign(Object.assign({},e),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},e),{skipPristineCheck:t})),this._onDisabledChange.forEach(function(e){return e(!1)})}},{key:"_updateAncestors",value:function(e){this._parent&&!e.onlySelf&&(this._parent.updateValueAndValidity(e),e.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}},{key:"setParent",value:function(e){this._parent=e}},{key:"updateValueAndValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),"VALID"!==this.status&&"PENDING"!==this.status||this._runAsyncValidator(e.emitEvent)),!1!==e.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!e.onlySelf&&this._parent.updateValueAndValidity(e)}},{key:"_updateTreeValidity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{emitEvent:!0};this._forEachChild(function(t){return t._updateTreeValidity(e)}),this.updateValueAndValidity({onlySelf:!0,emitEvent:e.emitEvent})}},{key:"_setInitialStatus",value:function(){this.status=this._allControlsDisabled()?"DISABLED":"VALID"}},{key:"_runValidator",value:function(){return this.validator?this.validator(this):null}},{key:"_runAsyncValidator",value:function(e){var t=this;if(this.asyncValidator){this.status="PENDING",this._hasOwnPendingAsyncValidator=!0;var n=Pd(this.asyncValidator(this));this._asyncValidationSubscription=n.subscribe(function(n){t._hasOwnPendingAsyncValidator=!1,t.setErrors(n,{emitEvent:e})})}}},{key:"_cancelExistingSubscription",value:function(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}},{key:"setErrors",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.errors=e,this._updateControlsErrors(!1!==t.emitEvent)}},{key:"get",value:function(e){return function(e,t,n){if(null==t)return null;if(Array.isArray(t)||(t=t.split(".")),Array.isArray(t)&&0===t.length)return null;var i=e;return t.forEach(function(e){i=i instanceof yf?i.controls.hasOwnProperty(e)?i.controls[e]:null:i instanceof bf&&i.at(e)||null}),i}(this,e)}},{key:"getError",value:function(e,t){var n=t?this.get(t):this;return n&&n.errors?n.errors[e]:null}},{key:"hasError",value:function(e,t){return!!this.getError(e,t)}},{key:"root",get:function(){for(var e=this;e._parent;)e=e._parent;return e}},{key:"_updateControlsErrors",value:function(e){this.status=this._calculateStatus(),e&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(e)}},{key:"_initObservables",value:function(){this.valueChanges=new fc,this.statusChanges=new fc}},{key:"_calculateStatus",value:function(){return this._allControlsDisabled()?"DISABLED":this.errors?"INVALID":this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus("PENDING")?"PENDING":this._anyControlsHaveStatus("INVALID")?"INVALID":"VALID"}},{key:"_anyControlsHaveStatus",value:function(e){return this._anyControls(function(t){return t.status===e})}},{key:"_anyControlsDirty",value:function(){return this._anyControls(function(e){return e.dirty})}},{key:"_anyControlsTouched",value:function(){return this._anyControls(function(e){return e.touched})}},{key:"_updatePristine",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.pristine=!this._anyControlsDirty(),this._parent&&!e.onlySelf&&this._parent._updatePristine(e)}},{key:"_updateTouched",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.touched=this._anyControlsTouched(),this._parent&&!e.onlySelf&&this._parent._updateTouched(e)}},{key:"_isBoxedValue",value:function(e){return"object"==typeof e&&null!==e&&2===Object.keys(e).length&&"value"in e&&"disabled"in e}},{key:"_registerOnCollectionChange",value:function(e){this._onCollectionChange=e}},{key:"_setUpdateStrategy",value:function(e){sf(e)&&null!=e.updateOn&&(this._updateOn=e.updateOn)}},{key:"_parentMarkedDirty",value:function(e){return!e&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}]),e}(),vf=function(e){h(n,e);var t=f(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0;return y(this,n),(e=t.call(this,nf(r),af(a,r)))._onChange=[],e._applyFormState(i),e._setUpdateStrategy(r),e._initObservables(),e.updateValueAndValidity({onlySelf:!0,emitEvent:!!a}),e}return k(n,[{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.value=this._pendingValue=e,this._onChange.length&&!1!==n.emitModelToViewChange&&this._onChange.forEach(function(e){return e(t.value,!1!==n.emitViewToModelChange)}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.setValue(e,t)}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._applyFormState(e),this.markAsPristine(t),this.markAsUntouched(t),this.setValue(this.value,t),this._pendingChange=!1}},{key:"_updateValue",value:function(){}},{key:"_anyControls",value:function(e){return!1}},{key:"_allControlsDisabled",value:function(){return this.disabled}},{key:"registerOnChange",value:function(e){this._onChange.push(e)}},{key:"_unregisterOnChange",value:function(e){tf(this._onChange,e)}},{key:"registerOnDisabledChange",value:function(e){this._onDisabledChange.push(e)}},{key:"_unregisterOnDisabledChange",value:function(e){tf(this._onDisabledChange,e)}},{key:"_forEachChild",value:function(e){}},{key:"_syncPendingControls",value:function(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}},{key:"_applyFormState",value:function(e){this._isBoxedValue(e)?(this.value=this._pendingValue=e.value,e.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=e}}]),n}(mf),yf=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this,nf(i),af(r,i))).controls=e,a._initObservables(),a._setUpdateStrategy(i),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!r}),a}return k(n,[{key:"registerControl",value:function(e,t){return this.controls[e]?this.controls[e]:(this.controls[e]=t,t.setParent(this),t._registerOnCollectionChange(this._onCollectionChange),t)}},{key:"addControl",value:function(e,t){this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"removeControl",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],this.updateValueAndValidity(),this._onCollectionChange()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),delete this.controls[e],t&&this.registerControl(e,t),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"contains",value:function(e){return this.controls.hasOwnProperty(e)&&this.controls[e].enabled}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),Object.keys(e).forEach(function(i){t._throwIfControlMissing(i),t.controls[i].setValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(Object.keys(e).forEach(function(i){t.controls[i]&&t.controls[i].patchValue(e[i],{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,i){n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this._reduceChildren({},function(e,t,n){return e[n]=t instanceof vf?t.value:t.getRawValue(),e})}},{key:"_syncPendingControls",value:function(){var e=this._reduceChildren(!1,function(e,t){return!!t._syncPendingControls()||e});return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[e])throw new Error("Cannot find form control with name: ".concat(e,"."))}},{key:"_forEachChild",value:function(e){var t=this;Object.keys(this.controls).forEach(function(n){var i=t.controls[n];i&&e(i,n)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){t.setParent(e),t._registerOnCollectionChange(e._onCollectionChange)})}},{key:"_updateValue",value:function(){this.value=this._reduceValue()}},{key:"_anyControls",value:function(e){for(var t=0,n=Object.keys(this.controls);t<n.length;t++){var i=n[t],r=this.controls[i];if(this.contains(i)&&e(r))return!0}return!1}},{key:"_reduceValue",value:function(){var e=this;return this._reduceChildren({},function(t,n,i){return(n.enabled||e.disabled)&&(t[i]=n.value),t})}},{key:"_reduceChildren",value:function(e,t){var n=e;return this._forEachChild(function(e,i){n=t(n,e,i)}),n}},{key:"_allControlsDisabled",value:function(){for(var e=0,t=Object.keys(this.controls);e<t.length;e++){var n=t[e];if(this.controls[n].enabled)return!1}return Object.keys(this.controls).length>0||this.disabled}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control with name: '".concat(n,"'."))})}}]),n}(mf),bf=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this,nf(i),af(r,i))).controls=e,a._initObservables(),a._setUpdateStrategy(i),a._setUpControls(),a.updateValueAndValidity({onlySelf:!0,emitEvent:!!r}),a}return k(n,[{key:"at",value:function(e){return this.controls[e]}},{key:"push",value:function(e){this.controls.push(e),this._registerControl(e),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"insert",value:function(e,t){this.controls.splice(e,0,t),this._registerControl(t),this.updateValueAndValidity()}},{key:"removeAt",value:function(e){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),this.updateValueAndValidity()}},{key:"setControl",value:function(e,t){this.controls[e]&&this.controls[e]._registerOnCollectionChange(function(){}),this.controls.splice(e,1),t&&(this.controls.splice(e,0,t),this._registerControl(t)),this.updateValueAndValidity(),this._onCollectionChange()}},{key:"length",get:function(){return this.controls.length}},{key:"setValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._checkAllValuesPresent(e),e.forEach(function(e,i){t._throwIfControlMissing(i),t.at(i).setValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n)}},{key:"patchValue",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};null!=e&&(e.forEach(function(e,i){t.at(i)&&t.at(i).patchValue(e,{onlySelf:!0,emitEvent:n.emitEvent})}),this.updateValueAndValidity(n))}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this._forEachChild(function(n,i){n.reset(e[i],{onlySelf:!0,emitEvent:t.emitEvent})}),this._updatePristine(t),this._updateTouched(t),this.updateValueAndValidity(t)}},{key:"getRawValue",value:function(){return this.controls.map(function(e){return e instanceof vf?e.value:e.getRawValue()})}},{key:"clear",value:function(){this.controls.length<1||(this._forEachChild(function(e){return e._registerOnCollectionChange(function(){})}),this.controls.splice(0),this.updateValueAndValidity())}},{key:"_syncPendingControls",value:function(){var e=this.controls.reduce(function(e,t){return!!t._syncPendingControls()||e},!1);return e&&this.updateValueAndValidity({onlySelf:!0}),e}},{key:"_throwIfControlMissing",value:function(e){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(e))throw new Error("Cannot find form control at index ".concat(e))}},{key:"_forEachChild",value:function(e){this.controls.forEach(function(t,n){e(t,n)})}},{key:"_updateValue",value:function(){var e=this;this.value=this.controls.filter(function(t){return t.enabled||e.disabled}).map(function(e){return e.value})}},{key:"_anyControls",value:function(e){return this.controls.some(function(t){return t.enabled&&e(t)})}},{key:"_setUpControls",value:function(){var e=this;this._forEachChild(function(t){return e._registerControl(t)})}},{key:"_checkAllValuesPresent",value:function(e){this._forEachChild(function(t,n){if(void 0===e[n])throw new Error("Must supply a value for form control at index: ".concat(n,"."))})}},{key:"_allControlsDisabled",value:function(){var e,t=a(this.controls);try{for(t.s();!(e=t.n()).done;){if(e.value.enabled)return!1}}catch(n){t.e(n)}finally{t.f()}return this.controls.length>0||this.disabled}},{key:"_registerControl",value:function(e){e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange)}}]),n}(mf),kf={provide:Gd,useExisting:Ce(function(){return wf})},_f=Promise.resolve(null),wf=((lf=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this)).submitted=!1,r._directives=[],r.ngSubmit=new fc,r.form=new yf({},Nd(e),zd(i)),r}return k(n,[{key:"ngAfterViewInit",value:function(){this._setUpdateStrategy()}},{key:"formDirective",get:function(){return this}},{key:"control",get:function(){return this.form}},{key:"path",get:function(){return[]}},{key:"controls",get:function(){return this.form.controls}},{key:"addControl",value:function(e){var t=this;_f.then(function(){var n=t._findContainer(e.path);e.control=n.registerControl(e.name,e.control),$d(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),t._directives.push(e)})}},{key:"getControl",value:function(e){return this.form.get(e.path)}},{key:"removeControl",value:function(e){var t=this;_f.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name),tf(t._directives,e)})}},{key:"addFormGroup",value:function(e){var t=this;_f.then(function(){var n=t._findContainer(e.path),i=new yf({});(function(e,t){Jd(e,t,!1)})(i,e),n.registerControl(e.name,i),i.updateValueAndValidity({emitEvent:!1})})}},{key:"removeFormGroup",value:function(e){var t=this;_f.then(function(){var n=t._findContainer(e.path);n&&n.removeControl(e.name)})}},{key:"getFormGroup",value:function(e){return this.form.get(e.path)}},{key:"updateModel",value:function(e,t){var n=this;_f.then(function(){n.form.get(e.path).setValue(t)})}},{key:"setValue",value:function(e){this.control.setValue(e)}},{key:"onSubmit",value:function(e){return this.submitted=!0,t=this._directives,this.form._syncPendingControls(),t.forEach(function(e){var t=e.control;"submit"===t.updateOn&&t._pendingChange&&(e.viewToModelUpdate(t._pendingValue),t._pendingChange=!1)}),this.ngSubmit.emit(e),!1;var t}},{key:"onReset",value:function(){this.resetForm()}},{key:"resetForm",value:function(e){this.form.reset(e),this.submitted=!1}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}},{key:"_findContainer",value:function(e){return e.pop(),e.length?this.form.get(e):this.form}}]),n}(Gd)).\u0275fac=function(e){return new(e||lf)(Vo(Od,10),Vo(Id,10))},lf.\u0275dir=mt({type:lf,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,t){1&e&&es("submit",function(e){return t.onSubmit(e)})("reset",function(){return t.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[tl([kf]),xo]}),lf),xf={provide:Yd,useExisting:Ce(function(){return Ef})},Cf=Promise.resolve(null),Ef=((uf=function(e){h(n,e);var t=f(n);function n(e,i,r,a){var o;return y(this,n),(o=t.call(this)).control=new vf,o._registered=!1,o.update=new fc,o._parent=e,o._setValidators(i),o._setAsyncValidators(r),o.valueAccessor=function(e,t){return t?(Array.isArray(t),t.forEach(function(e){e.constructor===Ed?n=e:Object.getPrototypeOf(e.constructor)===bd?i=e:r=e}),r||i||n||null):null;var n,i,r}(0,a),o}return k(n,[{key:"ngOnChanges",value:function(e){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in e&&this._updateDisabled(e),function(e,t){if(!e.hasOwnProperty("model"))return!1;var n=e.model;return!!n.isFirstChange()||!Object.is(t,n.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}},{key:"ngOnDestroy",value:function(){this.formDirective&&this.formDirective.removeControl(this)}},{key:"path",get:function(){return this._parent?function(e,t){return[].concat(i(t.path),[e])}(this.name,this._parent):[this.name]}},{key:"formDirective",get:function(){return this._parent?this._parent.formDirective:null}},{key:"viewToModelUpdate",value:function(e){this.viewModel=e,this.update.emit(e)}},{key:"_setUpControl",value:function(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}},{key:"_setUpdateStrategy",value:function(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}},{key:"_isStandalone",value:function(){return!this._parent||!(!this.options||!this.options.standalone)}},{key:"_setUpStandalone",value:function(){$d(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}},{key:"_checkForErrors",value:function(){this._isStandalone()||this._checkParentType(),this._checkName()}},{key:"_checkParentType",value:function(){}},{key:"_checkName",value:function(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}},{key:"_updateValue",value:function(e){var t=this;Cf.then(function(){t.control.setValue(e,{emitViewToModelChange:!1})})}},{key:"_updateDisabled",value:function(e){var t=this,n=e.isDisabled.currentValue,i=""===n||n&&"false"!==n;Cf.then(function(){i&&!t.control.disabled?t.control.disable():!i&&t.control.disabled&&t.control.enable()})}}]),n}(Yd)).\u0275fac=function(e){return new(e||uf)(Vo(Gd,9),Vo(Od,10),Vo(Id,10),Vo(kd,10))},uf.\u0275dir=mt({type:uf,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[tl([xf]),xo,It]}),uf),Sf=((cf=function e(){y(this,e)}).\u0275fac=function(e){return new(e||cf)},cf.\u0275dir=mt({type:cf,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),cf),Tf={provide:kd,useExisting:Ce(function(){return Of}),multi:!0},Of=((hf=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._renderer=e,r._elementRef=i,r.onChange=function(e){},r.onTouched=function(){},r}return k(n,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",null==e?"":e)}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),n}(bd)).\u0275fac=function(e){return new(e||hf)(Vo(hl),Vo(ll))},hf.\u0275dir=mt({type:hf,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,t){1&e&&es("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[tl([Tf]),xo]}),hf),If={provide:kd,useExisting:Ce(function(){return Pf}),multi:!0},Mf=((pf=function e(){y(this,e)}).\u0275fac=function(e){return new(e||pf)},pf.\u0275mod=pt({type:pf}),pf.\u0275inj=Pe({}),pf),Af=((ff=function(){function e(){y(this,e),this._accessors=[]}return k(e,[{key:"add",value:function(e,t){this._accessors.push([e,t])}},{key:"remove",value:function(e){for(var t=this._accessors.length-1;t>=0;--t)if(this._accessors[t][1]===e)return void this._accessors.splice(t,1)}},{key:"select",value:function(e){var t=this;this._accessors.forEach(function(n){t._isSameGroup(n,e)&&n[1]!==e&&n[1].fireUncheck(e.value)})}},{key:"_isSameGroup",value:function(e,t){return!!e[0].control&&e[0]._parent===t._control._parent&&e[1].name===t.name}}]),e}()).\u0275fac=function(e){return new(e||ff)},ff.\u0275prov=Ae({factory:function(){return new ff},token:ff,providedIn:Mf}),ff),Pf=((df=function(e){h(n,e);var t=f(n);function n(e,i,r,a){var o;return y(this,n),(o=t.call(this))._renderer=e,o._elementRef=i,o._registry=r,o._injector=a,o.onChange=function(){},o.onTouched=function(){},o}return k(n,[{key:"ngOnInit",value:function(){this._control=this._injector.get(Yd),this._checkName(),this._registry.add(this._control,this)}},{key:"ngOnDestroy",value:function(){this._registry.remove(this)}},{key:"writeValue",value:function(e){this._state=e===this.value,this._renderer.setProperty(this._elementRef.nativeElement,"checked",this._state)}},{key:"registerOnChange",value:function(e){var t=this;this._fn=e,this.onChange=function(){e(t.value),t._registry.select(t)}}},{key:"fireUncheck",value:function(e){this.writeValue(e)}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_checkName",value:function(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}]),n}(bd)).\u0275fac=function(e){return new(e||df)(Vo(hl),Vo(ll),Vo(Af),Vo(_o))},df.\u0275dir=mt({type:df,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,t){1&e&&es("change",function(){return t.onChange()})("blur",function(){return t.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[tl([If]),xo]}),df),Df={provide:kd,useExisting:Ce(function(){return Rf}),multi:!0},Rf=((gf=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._renderer=e,r._elementRef=i,r.onChange=function(e){},r.onTouched=function(){},r}return k(n,[{key:"writeValue",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"value",parseFloat(e))}},{key:"registerOnChange",value:function(e){this.onChange=function(t){e(""==t?null:parseFloat(t))}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}}]),n}(bd)).\u0275fac=function(e){return new(e||gf)(Vo(hl),Vo(ll))},gf.\u0275dir=mt({type:gf,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,t){1&e&&es("change",function(e){return t.onChange(e.target.value)})("input",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},features:[tl([Df]),xo]}),gf),Ff={provide:kd,useExisting:Ce(function(){return Bf}),multi:!0};function Nf(e,t){return null==e?"".concat(t):(t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var zf,Lf,Bf=((Lf=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._renderer=e,r._elementRef=i,r._optionMap=new Map,r._idCounter=0,r.onChange=function(e){},r.onTouched=function(){},r._compareWith=Object.is,r}return k(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){this.value=e;var t=this._getOptionId(e);null==t&&this._renderer.setProperty(this._elementRef.nativeElement,"selectedIndex",-1);var n=Nf(t,e);this._renderer.setProperty(this._elementRef.nativeElement,"value",n)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){t.value=t._getOptionValue(n),e(t.value)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(){return(this._idCounter++).toString()}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var i=n[t];if(this._compareWith(this._optionMap.get(i),e))return i}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t):e}}]),n}(bd)).\u0275fac=function(e){return new(e||Lf)(Vo(hl),Vo(ll))},Lf.\u0275dir=mt({type:Lf,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,t){1&e&&es("change",function(e){return t.onChange(e.target.value)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[tl([Ff]),xo]}),Lf),jf=((zf=function(){function e(t,n,i){y(this,e),this._element=t,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption())}return k(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(Nf(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}()).\u0275fac=function(e){return new(e||zf)(Vo(ll),Vo(hl),Vo(Bf,9))},zf.\u0275dir=mt({type:zf,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),zf),Uf={provide:kd,useExisting:Ce(function(){return Kf}),multi:!0};function Hf(e,t){return null==e?"".concat(t):("string"==typeof t&&(t="'".concat(t,"'")),t&&"object"==typeof t&&(t="Object"),"".concat(e,": ").concat(t).slice(0,50))}var Vf,Wf,Gf,Zf,Yf,qf,Xf,Kf=((Wf=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._renderer=e,r._elementRef=i,r._optionMap=new Map,r._idCounter=0,r.onChange=function(e){},r.onTouched=function(){},r._compareWith=Object.is,r}return k(n,[{key:"compareWith",set:function(e){this._compareWith=e}},{key:"writeValue",value:function(e){var t,n=this;if(this.value=e,Array.isArray(e)){var i=e.map(function(e){return n._getOptionId(e)});t=function(e,t){e._setSelected(i.indexOf(t.toString())>-1)}}else t=function(e,t){e._setSelected(!1)};this._optionMap.forEach(t)}},{key:"registerOnChange",value:function(e){var t=this;this.onChange=function(n){var i=[];if(void 0!==n.selectedOptions)for(var r=n.selectedOptions,a=0;a<r.length;a++){var o=r.item(a),s=t._getOptionValue(o.value);i.push(s)}else for(var l=n.options,c=0;c<l.length;c++){var u=l.item(c);if(u.selected){var h=t._getOptionValue(u.value);i.push(h)}}t.value=i,e(i)}}},{key:"registerOnTouched",value:function(e){this.onTouched=e}},{key:"setDisabledState",value:function(e){this._renderer.setProperty(this._elementRef.nativeElement,"disabled",e)}},{key:"_registerOption",value:function(e){var t=(this._idCounter++).toString();return this._optionMap.set(t,e),t}},{key:"_getOptionId",value:function(e){for(var t=0,n=Array.from(this._optionMap.keys());t<n.length;t++){var i=n[t];if(this._compareWith(this._optionMap.get(i)._value,e))return i}return null}},{key:"_getOptionValue",value:function(e){var t=function(e){return e.split(":")[0]}(e);return this._optionMap.has(t)?this._optionMap.get(t)._value:e}}]),n}(bd)).\u0275fac=function(e){return new(e||Wf)(Vo(hl),Vo(ll))},Wf.\u0275dir=mt({type:Wf,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,t){1&e&&es("change",function(e){return t.onChange(e.target)})("blur",function(){return t.onTouched()})},inputs:{compareWith:"compareWith"},features:[tl([Uf]),xo]}),Wf),$f=((Vf=function(){function e(t,n,i){y(this,e),this._element=t,this._renderer=n,this._select=i,this._select&&(this.id=this._select._registerOption(this))}return k(e,[{key:"ngValue",set:function(e){null!=this._select&&(this._value=e,this._setElementValue(Hf(this.id,e)),this._select.writeValue(this._select.value))}},{key:"value",set:function(e){this._select?(this._value=e,this._setElementValue(Hf(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}},{key:"_setElementValue",value:function(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}},{key:"_setSelected",value:function(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}},{key:"ngOnDestroy",value:function(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}]),e}()).\u0275fac=function(e){return new(e||Vf)(Vo(ll),Vo(hl),Vo(Kf,9))},Vf.\u0275dir=mt({type:Vf,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),Vf),Qf={provide:Od,useExisting:Ce(function(){return Jf}),multi:!0},Jf=((Gf=function(){function e(){y(this,e),this._required=!1}return k(e,[{key:"required",get:function(){return this._required},set:function(e){this._required=null!=e&&!1!==e&&"false"!="".concat(e),this._onChange&&this._onChange()}},{key:"validate",value:function(e){return this.required?function(e){return Sd(e.value)?{required:!0}:null}(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}}]),e}()).\u0275fac=function(e){return new(e||Gf)},Gf.\u0275dir=mt({type:Gf,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,t){2&e&&Lo("required",t.required?"":null)},inputs:{required:"required"},features:[tl([Qf])]}),Gf),ep={provide:Od,useExisting:Ce(function(){return tp}),multi:!0},tp=((Zf=function(){function e(){y(this,e),this._validator=Md}return k(e,[{key:"ngOnChanges",value:function(e){"minlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return null==this.minlength?null:this._validator(e)}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){var e;this._validator=(e="number"==typeof this.minlength?this.minlength:parseInt(this.minlength,10),function(t){return Sd(t.value)||!Td(t.value)?null:t.value.length<e?{minlength:{requiredLength:e,actualLength:t.value.length}}:null})}}]),e}()).\u0275fac=function(e){return new(e||Zf)},Zf.\u0275dir=mt({type:Zf,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&Lo("minlength",t.minlength?t.minlength:null)},inputs:{minlength:"minlength"},features:[tl([ep]),It]}),Zf),np={provide:Od,useExisting:Ce(function(){return ip}),multi:!0},ip=((Xf=function(){function e(){y(this,e),this._validator=Md}return k(e,[{key:"ngOnChanges",value:function(e){"maxlength"in e&&(this._createValidator(),this._onChange&&this._onChange())}},{key:"validate",value:function(e){return null!=this.maxlength?this._validator(e):null}},{key:"registerOnValidatorChange",value:function(e){this._onChange=e}},{key:"_createValidator",value:function(){var e;this._validator=(e="number"==typeof this.maxlength?this.maxlength:parseInt(this.maxlength,10),function(t){return Td(t.value)&&t.value.length>e?{maxlength:{requiredLength:e,actualLength:t.value.length}}:null})}}]),e}()).\u0275fac=function(e){return new(e||Xf)},Xf.\u0275dir=mt({type:Xf,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,t){2&e&&Lo("maxlength",t.maxlength?t.maxlength:null)},inputs:{maxlength:"maxlength"},features:[tl([np]),It]}),Xf),rp=((qf=function e(){y(this,e)}).\u0275fac=function(e){return new(e||qf)},qf.\u0275mod=pt({type:qf}),qf.\u0275inj=Pe({imports:[[Mf]]}),qf),ap=((Yf=function e(){y(this,e)}).\u0275fac=function(e){return new(e||Yf)},Yf.\u0275mod=pt({type:Yf}),Yf.\u0275inj=Pe({imports:[rp]}),Yf),op=function e(){y(this,e)};function sp(e,t){return{type:7,name:e,definitions:t,options:{}}}function lp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:4,styles:t,timings:e}}function cp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return{type:2,steps:e,options:t}}function up(e){return{type:6,styles:e,offset:null}}function hp(e,t,n){return{type:0,name:e,styles:t,options:n}}function dp(e){return{type:5,steps:e}}function fp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{type:1,expr:e,animation:t,options:n}}function pp(e){Promise.resolve(null).then(e)}var gp=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;y(this,e),this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=t+n}return k(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"init",value:function(){}},{key:"play",value:function(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}},{key:"triggerMicrotask",value:function(){var e=this;pp(function(){return e._onFinish()})}},{key:"_onStart",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"pause",value:function(){}},{key:"restart",value:function(){}},{key:"finish",value:function(){this._onFinish()}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){}},{key:"setPosition",value:function(e){this._position=this.totalTime?e*this.totalTime:1}},{key:"getPosition",value:function(){return this.totalTime?this._position/this.totalTime:1}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),mp=function(){function e(t){var n=this;y(this,e),this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=t;var i=0,r=0,a=0,o=this.players.length;0==o?pp(function(){return n._onFinish()}):this.players.forEach(function(e){e.onDone(function(){++i==o&&n._onFinish()}),e.onDestroy(function(){++r==o&&n._onDestroy()}),e.onStart(function(){++a==o&&n._onStart()})}),this.totalTime=this.players.reduce(function(e,t){return Math.max(e,t.totalTime)},0)}return k(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this.players.forEach(function(e){return e.init()})}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"_onStart",value:function(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[])}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(function(e){return e.play()})}},{key:"pause",value:function(){this.players.forEach(function(e){return e.pause()})}},{key:"restart",value:function(){this.players.forEach(function(e){return e.restart()})}},{key:"finish",value:function(){this._onFinish(),this.players.forEach(function(e){return e.finish()})}},{key:"destroy",value:function(){this._onDestroy()}},{key:"_onDestroy",value:function(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(function(e){return e.destroy()}),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"reset",value:function(){this.players.forEach(function(e){return e.reset()}),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"setPosition",value:function(e){var t=e*this.totalTime;this.players.forEach(function(e){var n=e.totalTime?Math.min(1,t/e.totalTime):1;e.setPosition(n)})}},{key:"getPosition",value:function(){var e=this.players.reduce(function(e,t){return null===e||t.totalTime>e.totalTime?t:e},null);return null!=e?e.getPosition():0}},{key:"beforeDestroy",value:function(){this.players.forEach(function(e){e.beforeDestroy&&e.beforeDestroy()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}();function vp(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function yp(e){switch(e.length){case 0:return new gp;case 1:return e[0];default:return new mp(e)}}function bp(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=[],s=[],l=-1,c=null;if(i.forEach(function(e){var n=e.offset,i=n==l,u=i&&c||{};Object.keys(e).forEach(function(n){var i=n,s=e[n];if("offset"!==n)switch(i=t.normalizePropertyName(i,o),s){case"!":s=r[n];break;case"*":s=a[n];break;default:s=t.normalizeStyleValue(n,i,s,o)}u[i]=s}),i||s.push(u),c=u,l=n}),o.length){var u="\n - ";throw new Error("Unable to animate due to the following errors:".concat(u).concat(o.join(u)))}return s}function kp(e,t,n,i){switch(t){case"start":e.onStart(function(){return i(n&&_p(n,"start",e))});break;case"done":e.onDone(function(){return i(n&&_p(n,"done",e))});break;case"destroy":e.onDestroy(function(){return i(n&&_p(n,"destroy",e))})}}function _p(e,t,n){var i=n.totalTime,r=wp(e.element,e.triggerName,e.fromState,e.toState,t||e.phaseName,null==i?e.totalTime:i,!!n.disabled),a=e._data;return null!=a&&(r._data=a),r}function wp(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6?arguments[6]:void 0;return{element:e,triggerName:t,fromState:n,toState:i,phaseName:r,totalTime:a,disabled:!!o}}function xp(e,t,n){var i;return e instanceof Map?(i=e.get(t))||e.set(t,i=n):(i=e[t])||(i=e[t]=n),i}function Cp(e){var t=e.indexOf(":");return[e.substring(1,t),e.substr(t+1)]}var Ep=function(e,t){return!1},Sp=function(e,t){return!1},Tp=function(e,t,n){return[]},Op=vp();(Op||"undefined"!=typeof Element)&&(Ep=function(e,t){return e.contains(t)},Sp=function(){if(Op||Element.prototype.matches)return function(e,t){return e.matches(t)};var e=Element.prototype,t=e.matchesSelector||e.mozMatchesSelector||e.msMatchesSelector||e.oMatchesSelector||e.webkitMatchesSelector;return t?function(e,n){return t.apply(e,[n])}:Sp}(),Tp=function(e,t,n){var i=[];if(n)for(var r=e.querySelectorAll(t),a=0;a<r.length;a++)i.push(r[a]);else{var o=e.querySelector(t);o&&i.push(o)}return i});var Ip=null,Mp=!1;function Ap(e){Ip||(Ip=("undefined"!=typeof document?document.body:null)||{},Mp=!!Ip.style&&"WebkitAppearance"in Ip.style);var t=!0;return Ip.style&&!function(e){return"ebkit"==e.substring(1,6)}(e)&&(!(t=e in Ip.style)&&Mp)&&(t="Webkit"+e.charAt(0).toUpperCase()+e.substr(1)in Ip.style),t}var Pp=Sp,Dp=Ep,Rp=Tp;function Fp(e){var t={};return Object.keys(e).forEach(function(n){var i=n.replace(/([a-z])([A-Z])/g,"$1-$2");t[i]=e[n]}),t}var Np,zp=((Np=function(){function e(){y(this,e)}return k(e,[{key:"validateStyleProperty",value:function(e){return Ap(e)}},{key:"matchesElement",value:function(e,t){return Pp(e,t)}},{key:"containsElement",value:function(e,t){return Dp(e,t)}},{key:"query",value:function(e,t,n){return Rp(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return n||""}},{key:"animate",value:function(e,t,n,i,r){return new gp(n,i)}}]),e}()).\u0275fac=function(e){return new(e||Np)},Np.\u0275prov=Ae({token:Np,factory:Np.\u0275fac}),Np),Lp=function(){var e=function e(){y(this,e)};return e.NOOP=new zp,e}();function Bp(e){if("number"==typeof e)return e;var t=e.match(/^(-?[\.\d]+)(m?s)/);return!t||t.length<2?0:jp(parseFloat(t[1]),t[2])}function jp(e,t){switch(t){case"s":return 1e3*e;default:return e}}function Up(e,t,n){return e.hasOwnProperty("duration")?e:function(e,t,n){var i,r=0,a="";if("string"==typeof e){var o=e.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===o)return t.push('The provided timing value "'.concat(e,'" is invalid.')),{duration:0,delay:0,easing:""};i=jp(parseFloat(o[1]),o[2]);var s=o[3];null!=s&&(r=jp(parseFloat(s),o[4]));var l=o[5];l&&(a=l)}else i=e;if(!n){var c=!1,u=t.length;i<0&&(t.push("Duration values below 0 are not allowed for this animation step."),c=!0),r<0&&(t.push("Delay values below 0 are not allowed for this animation step."),c=!0),c&&t.splice(u,0,'The provided timing value "'.concat(e,'" is invalid.'))}return{duration:i,delay:r,easing:a}}(e,t,n)}function Hp(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Object.keys(e).forEach(function(n){t[n]=e[n]}),t}function Vp(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(t)for(var i in e)n[i]=e[i];else Hp(e,n);return n}function Wp(e,t,n){return n?t+":"+n+";":""}function Gp(e){for(var t="",n=0;n<e.style.length;n++){var i=e.style.item(n);t+=Wp(0,i,e.style.getPropertyValue(i))}for(var r in e.style)e.style.hasOwnProperty(r)&&!r.startsWith("_")&&(t+=Wp(0,r.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),e.style[r]));e.setAttribute("style",t)}function Zp(e,t,n){e.style&&(Object.keys(t).forEach(function(i){var r=eg(i);n&&!n.hasOwnProperty(i)&&(n[i]=e.style[r]),e.style[r]=t[i]}),vp()&&Gp(e))}function Yp(e,t){e.style&&(Object.keys(t).forEach(function(t){var n=eg(t);e.style[n]=""}),vp()&&Gp(e))}function qp(e){return Array.isArray(e)?1==e.length?e[0]:cp(e):e}var Xp=new RegExp("{{\\s*(.+?)\\s*}}","g");function Kp(e){var t=[];if("string"==typeof e){for(var n;n=Xp.exec(e);)t.push(n[1]);Xp.lastIndex=0}return t}function $p(e,t,n){var i=e.toString(),r=i.replace(Xp,function(e,i){var r=t[i];return t.hasOwnProperty(i)||(n.push("Please provide a value for the animation param ".concat(i)),r=""),r.toString()});return r==i?e:r}function Qp(e){for(var t=[],n=e.next();!n.done;)t.push(n.value),n=e.next();return t}var Jp=/-+([a-z0-9])/g;function eg(e){return e.replace(Jp,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t[1].toUpperCase()})}function tg(e,t){return 0===e||0===t}function ng(e,t,n){var i=Object.keys(n);if(i.length&&t.length){var r=t[0],a=[];if(i.forEach(function(e){r.hasOwnProperty(e)||a.push(e),r[e]=n[e]}),a.length)for(var o=function(){var n=t[s];a.forEach(function(t){n[t]=rg(e,t)})},s=1;s<t.length;s++)o()}return t}function ig(e,t,n){switch(t.type){case 7:return e.visitTrigger(t,n);case 0:return e.visitState(t,n);case 1:return e.visitTransition(t,n);case 2:return e.visitSequence(t,n);case 3:return e.visitGroup(t,n);case 4:return e.visitAnimate(t,n);case 5:return e.visitKeyframes(t,n);case 6:return e.visitStyle(t,n);case 8:return e.visitReference(t,n);case 9:return e.visitAnimateChild(t,n);case 10:return e.visitAnimateRef(t,n);case 11:return e.visitQuery(t,n);case 12:return e.visitStagger(t,n);default:throw new Error("Unable to resolve animation metadata node #".concat(t.type))}}function rg(e,t){return window.getComputedStyle(e)[t]}var ag=new Set(["true","1"]),og=new Set(["false","0"]);function sg(e,t){var n=ag.has(e)||og.has(e),i=ag.has(t)||og.has(t);return function(r,a){var o="*"==e||e==r,s="*"==t||t==a;return!o&&n&&"boolean"==typeof r&&(o=r?ag.has(e):og.has(e)),!s&&i&&"boolean"==typeof a&&(s=a?ag.has(t):og.has(t)),o&&s}}var lg=new RegExp("s*:selfs*,?","g");function cg(e,t,n){return new ug(e).build(t,n)}var ug=function(){function t(e){y(this,t),this._driver=e}return k(t,[{key:"build",value:function(e,t){var n=new hg(t);return this._resetContextStyleTimingState(n),ig(this,qp(e),n)}},{key:"_resetContextStyleTimingState",value:function(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}},{key:"visitTrigger",value:function(e,t){var n=this,i=t.queryCount=0,r=t.depCount=0,a=[],o=[];return"@"==e.name.charAt(0)&&t.errors.push("animation triggers cannot be prefixed with an `@` sign (e.g. trigger('@foo', [...]))"),e.definitions.forEach(function(e){if(n._resetContextStyleTimingState(t),0==e.type){var s=e,l=s.name;l.toString().split(/\s*,\s*/).forEach(function(e){s.name=e,a.push(n.visitState(s,t))}),s.name=l}else if(1==e.type){var c=n.visitTransition(e,t);i+=c.queryCount,r+=c.depCount,o.push(c)}else t.errors.push("only state() and transition() definitions can sit inside of a trigger()")}),{type:7,name:e.name,states:a,transitions:o,queryCount:i,depCount:r,options:null}}},{key:"visitState",value:function(e,t){var n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){var r=new Set,a=i||{};if(n.styles.forEach(function(e){if(dg(e)){var t=e;Object.keys(t).forEach(function(e){Kp(t[e]).forEach(function(e){a.hasOwnProperty(e)||r.add(e)})})}}),r.size){var o=Qp(r.values());t.errors.push('state("'.concat(e.name,'", ...) must define default values for all the following style substitutions: ').concat(o.join(", ")))}}return{type:0,name:e.name,style:n,options:i?{params:i}:null}}},{key:"visitTransition",value:function(e,t){t.queryCount=0,t.depCount=0;var n,i,r,a=ig(this,qp(e.animation),t);return{type:1,matchers:(n=e.expr,i=t.errors,r=[],"string"==typeof n?n.split(/\s*,\s*/).forEach(function(e){return function(e,t,n){if(":"==e[0]){var i=function(e,t){switch(e){case":enter":return"void => *";case":leave":return"* => void";case":increment":return function(e,t){return parseFloat(t)>parseFloat(e)};case":decrement":return function(e,t){return parseFloat(t)<parseFloat(e)};default:return t.push('The transition alias value "'.concat(e,'" is not supported')),"* => *"}}(e,n);if("function"==typeof i)return void t.push(i);e=i}var r=e.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return n.push('The provided transition expression "'.concat(e,'" is not supported')),t;var a=r[1],o=r[2],s=r[3];t.push(sg(a,s)),"<"!=o[0]||"*"==a&&"*"==s||t.push(sg(s,a))}(e,r,i)}):r.push(n),r),animation:a,queryCount:t.queryCount,depCount:t.depCount,options:fg(e.options)}}},{key:"visitSequence",value:function(e,t){var n=this;return{type:2,steps:e.steps.map(function(e){return ig(n,e,t)}),options:fg(e.options)}}},{key:"visitGroup",value:function(e,t){var n=this,i=t.currentTime,r=0,a=e.steps.map(function(e){t.currentTime=i;var a=ig(n,e,t);return r=Math.max(r,t.currentTime),a});return t.currentTime=r,{type:3,steps:a,options:fg(e.options)}}},{key:"visitAnimate",value:function(e,t){var n,i=function(e,t){var n=null;if(e.hasOwnProperty("duration"))n=e;else if("number"==typeof e)return pg(Up(e,t).duration,0,"");var i=e;if(i.split(/\s+/).some(function(e){return"{"==e.charAt(0)&&"{"==e.charAt(1)})){var r=pg(0,0,"");return r.dynamic=!0,r.strValue=i,r}return pg((n=n||Up(i,t)).duration,n.delay,n.easing)}(e.timings,t.errors);t.currentAnimateTimings=i;var r=e.styles?e.styles:up({});if(5==r.type)n=this.visitKeyframes(r,t);else{var a=e.styles,o=!1;if(!a){o=!0;var s={};i.easing&&(s.easing=i.easing),a=up(s)}t.currentTime+=i.duration+i.delay;var l=this.visitStyle(a,t);l.isEmptyStep=o,n=l}return t.currentAnimateTimings=null,{type:4,timings:i,style:n,options:null}}},{key:"visitStyle",value:function(e,t){var n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}},{key:"_makeStyleAst",value:function(e,t){var n=[];Array.isArray(e.styles)?e.styles.forEach(function(e){"string"==typeof e?"*"==e?n.push(e):t.errors.push("The provided style string value ".concat(e," is not allowed.")):n.push(e)}):n.push(e.styles);var i=!1,r=null;return n.forEach(function(e){if(dg(e)){var t=e,n=t.easing;if(n&&(r=n,delete t.easing),!i)for(var a in t)if(t[a].toString().indexOf("{{")>=0){i=!0;break}}}),{type:6,styles:n,easing:r,offset:e.offset,containsDynamicStyles:i,options:null}}},{key:"_validateStyleAst",value:function(e,t){var n=this,i=t.currentAnimateTimings,r=t.currentTime,a=t.currentTime;i&&a>0&&(a-=i.duration+i.delay),e.styles.forEach(function(e){"string"!=typeof e&&Object.keys(e).forEach(function(i){if(n._driver.validateStyleProperty(i)){var o,s,l,c,u,h=t.collectedStyles[t.currentQuerySelector],d=h[i],f=!0;d&&(a!=r&&a>=d.startTime&&r<=d.endTime&&(t.errors.push('The CSS property "'.concat(i,'" that exists between the times of "').concat(d.startTime,'ms" and "').concat(d.endTime,'ms" is also being animated in a parallel animation between the times of "').concat(a,'ms" and "').concat(r,'ms"')),f=!1),a=d.startTime),f&&(h[i]={startTime:a,endTime:r}),t.options&&(o=e[i],s=t.options,l=t.errors,c=s.params||{},(u=Kp(o)).length&&u.forEach(function(e){c.hasOwnProperty(e)||l.push("Unable to resolve the local animation param ".concat(e," in the given list of values"))}))}else t.errors.push('The provided animation property "'.concat(i,'" is not a supported CSS property for animations'))})})}},{key:"visitKeyframes",value:function(e,t){var n=this,i={type:5,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push("keyframes() must be placed inside of a call to animate()"),i;var r=0,a=[],o=!1,s=!1,l=0,c=e.steps.map(function(e){var i=n._makeStyleAst(e,t),c=null!=i.offset?i.offset:function(e){if("string"==typeof e)return null;var t=null;if(Array.isArray(e))e.forEach(function(e){if(dg(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}});else if(dg(e)&&e.hasOwnProperty("offset")){var n=e;t=parseFloat(n.offset),delete n.offset}return t}(i.styles),u=0;return null!=c&&(r++,u=i.offset=c),s=s||u<0||u>1,o=o||u<l,l=u,a.push(u),i});s&&t.errors.push("Please ensure that all keyframe offsets are between 0 and 1"),o&&t.errors.push("Please ensure that all keyframe offsets are in order");var u=e.steps.length,h=0;r>0&&r<u?t.errors.push("Not all style() steps within the declared keyframes() contain offsets"):0==r&&(h=1/(u-1));var d=u-1,f=t.currentTime,p=t.currentAnimateTimings,g=p.duration;return c.forEach(function(e,r){var o=h>0?r==d?1:h*r:a[r],s=o*g;t.currentTime=f+p.delay+s,p.duration=s,n._validateStyleAst(e,t),e.offset=o,i.styles.push(e)}),i}},{key:"visitReference",value:function(e,t){return{type:8,animation:ig(this,qp(e.animation),t),options:fg(e.options)}}},{key:"visitAnimateChild",value:function(e,t){return t.depCount++,{type:9,options:fg(e.options)}}},{key:"visitAnimateRef",value:function(e,t){return{type:10,animation:this.visitReference(e.animation,t),options:fg(e.options)}}},{key:"visitQuery",value:function(t,n){var i=n.currentQuerySelector,r=t.options||{};n.queryCount++,n.currentQuery=t;var a=e(function(e){var t=!!e.split(/\s*,\s*/).find(function(e){return":self"==e});return t&&(e=e.replace(lg,"")),[e=e.replace(/@\*/g,".ng-trigger").replace(/@\w+/g,function(e){return".ng-trigger-"+e.substr(1)}).replace(/:animating/g,".ng-animating"),t]}(t.selector),2),o=a[0],s=a[1];n.currentQuerySelector=i.length?i+" "+o:o,xp(n.collectedStyles,n.currentQuerySelector,{});var l=ig(this,qp(t.animation),n);return n.currentQuery=null,n.currentQuerySelector=i,{type:11,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:l,originalSelector:t.selector,options:fg(t.options)}}},{key:"visitStagger",value:function(e,t){t.currentQuery||t.errors.push("stagger() can only be used inside of query()");var n="full"===e.timings?{duration:0,delay:0,easing:"full"}:Up(e.timings,t.errors,!0);return{type:12,animation:ig(this,qp(e.animation),t),timings:n,options:null}}}]),t}(),hg=function e(t){y(this,e),this.errors=t,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null};function dg(e){return!Array.isArray(e)&&"object"==typeof e}function fg(e){var t;return e?(e=Hp(e)).params&&(e.params=(t=e.params)?Hp(t):null):e={},e}function pg(e,t,n){return{duration:e,delay:t,easing:n}}function gg(e,t,n,i,r,a){var o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7];return{type:1,element:e,keyframes:t,preStyleProps:n,postStyleProps:i,duration:r,delay:a,totalTime:r+a,easing:o,subTimeline:s}}var mg=function(){function e(){y(this,e),this._map=new Map}return k(e,[{key:"consume",value:function(e){var t=this._map.get(e);return t?this._map.delete(e):t=[],t}},{key:"append",value:function(e,t){var n,r=this._map.get(e);r||this._map.set(e,r=[]),(n=r).push.apply(n,i(t))}},{key:"has",value:function(e){return this._map.has(e)}},{key:"clear",value:function(){this._map.clear()}}]),e}(),vg=new RegExp(":enter","g"),yg=new RegExp(":leave","g");function bg(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{},s=arguments.length>7?arguments[7]:void 0,l=arguments.length>8?arguments[8]:void 0,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];return(new kg).buildKeyframes(e,t,n,i,r,a,o,s,l,c)}var kg=function(){function e(){y(this,e)}return k(e,[{key:"buildKeyframes",value:function(e,t,n,i,r,a,o,s,l){var c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:[];l=l||new mg;var u=new wg(e,t,l,i,r,c,[]);u.options=s,u.currentTimeline.setStyles([a],null,u.errors,s),ig(this,n,u);var h=u.timelines.filter(function(e){return e.containsAnimation()});if(h.length&&Object.keys(o).length){var d=h[h.length-1];d.allowOnlyTimelineStyles()||d.setStyles([o],null,u.errors,s)}return h.length?h.map(function(e){return e.buildKeyframes()}):[gg(t,[],[],[],0,0,"",!1)]}},{key:"visitTrigger",value:function(e,t){}},{key:"visitState",value:function(e,t){}},{key:"visitTransition",value:function(e,t){}},{key:"visitAnimateChild",value:function(e,t){var n=t.subInstructions.consume(t.element);if(n){var i=t.createSubContext(e.options),r=t.currentTimeline.currentTime,a=this._visitSubInstructions(n,i,i.options);r!=a&&t.transformIntoNewTimeline(a)}t.previousNode=e}},{key:"visitAnimateRef",value:function(e,t){var n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}},{key:"_visitSubInstructions",value:function(e,t,n){var i=t.currentTimeline.currentTime,r=null!=n.duration?Bp(n.duration):null,a=null!=n.delay?Bp(n.delay):null;return 0!==r&&e.forEach(function(e){var n=t.appendInstructionToTimeline(e,r,a);i=Math.max(i,n.duration+n.delay)}),i}},{key:"visitReference",value:function(e,t){t.updateOptions(e.options,!0),ig(this,e.animation,t),t.previousNode=e}},{key:"visitSequence",value:function(e,t){var n=this,i=t.subContextCount,r=t,a=e.options;if(a&&(a.params||a.delay)&&((r=t.createSubContext(a)).transformIntoNewTimeline(),null!=a.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=_g);var o=Bp(a.delay);r.delayNextStep(o)}e.steps.length&&(e.steps.forEach(function(e){return ig(n,e,r)}),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),t.previousNode=e}},{key:"visitGroup",value:function(e,t){var n=this,i=[],r=t.currentTimeline.currentTime,a=e.options&&e.options.delay?Bp(e.options.delay):0;e.steps.forEach(function(o){var s=t.createSubContext(e.options);a&&s.delayNextStep(a),ig(n,o,s),r=Math.max(r,s.currentTimeline.currentTime),i.push(s.currentTimeline)}),i.forEach(function(e){return t.currentTimeline.mergeTimelineCollectedStyles(e)}),t.transformIntoNewTimeline(r),t.previousNode=e}},{key:"_visitTiming",value:function(e,t){if(e.dynamic){var n=e.strValue;return Up(t.params?$p(n,t.params,t.errors):n,t.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}},{key:"visitAnimate",value:function(e,t){var n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());var r=e.style;5==r.type?this.visitKeyframes(r,t):(t.incrementTime(n.duration),this.visitStyle(r,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}},{key:"visitStyle",value:function(e,t){var n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.getCurrentStyleProperties().length&&n.forwardFrame();var r=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(r):n.setStyles(e.styles,r,t.errors,t.options),t.previousNode=e}},{key:"visitKeyframes",value:function(e,t){var n=t.currentAnimateTimings,i=t.currentTimeline.duration,r=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(function(e){a.forwardTime((e.offset||0)*r),a.setStyles(e.styles,e.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+r),t.previousNode=e}},{key:"visitQuery",value:function(e,t){var n=this,i=t.currentTimeline.currentTime,r=e.options||{},a=r.delay?Bp(r.delay):0;a&&(6===t.previousNode.type||0==i&&t.currentTimeline.getCurrentStyleProperties().length)&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=_g);var o=i,s=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!r.optional,t.errors);t.currentQueryTotal=s.length;var l=null;s.forEach(function(i,r){t.currentQueryIndex=r;var s=t.createSubContext(e.options,i);a&&s.delayNextStep(a),i===t.element&&(l=s.currentTimeline),ig(n,e.animation,s),s.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,s.currentTimeline.currentTime)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(o),l&&(t.currentTimeline.mergeTimelineCollectedStyles(l),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}},{key:"visitStagger",value:function(e,t){var n=t.parentContext,i=t.currentTimeline,r=e.timings,a=Math.abs(r.duration),o=a*(t.currentQueryTotal-1),s=a*t.currentQueryIndex;switch(r.duration<0?"reverse":r.easing){case"reverse":s=o-s;break;case"full":s=n.currentStaggerTime}var l=t.currentTimeline;s&&l.delayNextStep(s);var c=l.currentTime;ig(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-c+(i.startTime-n.currentTimeline.startTime)}}]),e}(),_g={},wg=function(){function e(t,n,i,r,a,o,s,l){y(this,e),this._driver=t,this.element=n,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=a,this.errors=o,this.timelines=s,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=_g,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new xg(this._driver,n,0),s.push(this.currentTimeline)}return k(e,[{key:"params",get:function(){return this.options.params}},{key:"updateOptions",value:function(e,t){var n=this;if(e){var i=e,r=this.options;null!=i.duration&&(r.duration=Bp(i.duration)),null!=i.delay&&(r.delay=Bp(i.delay));var a=i.params;if(a){var o=r.params;o||(o=this.options.params={}),Object.keys(a).forEach(function(e){t&&o.hasOwnProperty(e)||(o[e]=$p(a[e],o,n.errors))})}}}},{key:"_copyOptions",value:function(){var e={};if(this.options){var t=this.options.params;if(t){var n=e.params={};Object.keys(t).forEach(function(e){n[e]=t[e]})}}return e}},{key:"createSubContext",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=n||this.element,a=new e(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return a.previousNode=this.previousNode,a.currentAnimateTimings=this.currentAnimateTimings,a.options=this._copyOptions(),a.updateOptions(t),a.currentQueryIndex=this.currentQueryIndex,a.currentQueryTotal=this.currentQueryTotal,a.parentContext=this,this.subContextCount++,a}},{key:"transformIntoNewTimeline",value:function(e){return this.previousNode=_g,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}},{key:"appendInstructionToTimeline",value:function(e,t,n){var i={duration:null!=t?t:e.duration,delay:this.currentTimeline.currentTime+(null!=n?n:0)+e.delay,easing:""},r=new Cg(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(r),i}},{key:"incrementTime",value:function(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}},{key:"delayNextStep",value:function(e){e>0&&this.currentTimeline.delayNextStep(e)}},{key:"invokeQuery",value:function(e,t,n,r,a,o){var s=[];if(r&&s.push(this.element),e.length>0){e=(e=e.replace(vg,"."+this._enterClassName)).replace(yg,"."+this._leaveClassName);var l=this._driver.query(this.element,e,1!=n);0!==n&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),s.push.apply(s,i(l))}return a||0!=s.length||o.push('`query("'.concat(t,'")` returned zero elements. (Use `query("').concat(t,'", { optional: true })` if you wish to allow this.)')),s}}]),e}(),xg=function(){function e(t,n,i,r){y(this,e),this._driver=t,this.element=n,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(n),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(n,this._localTimelineStyles)),this._loadKeyframe()}return k(e,[{key:"containsAnimation",value:function(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}},{key:"getCurrentStyleProperties",value:function(){return Object.keys(this._currentKeyframe)}},{key:"currentTime",get:function(){return this.startTime+this.duration}},{key:"delayNextStep",value:function(e){var t=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}},{key:"fork",value:function(t,n){return this.applyStylesToKeyframe(),new e(this._driver,t,n||this.currentTime,this._elementTimelineStylesLookup)}},{key:"_loadKeyframe",value:function(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}},{key:"forwardFrame",value:function(){this.duration+=1,this._loadKeyframe()}},{key:"forwardTime",value:function(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}},{key:"_updateStyle",value:function(e,t){this._localTimelineStyles[e]=t,this._globalTimelineStyles[e]=t,this._styleSummary[e]={time:this.currentTime,value:t}}},{key:"allowOnlyTimelineStyles",value:function(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}},{key:"applyEmptyStep",value:function(e){var t=this;e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(function(e){t._backFill[e]=t._globalTimelineStyles[e]||"*",t._currentKeyframe[e]="*"}),this._currentEmptyStepKeyframe=this._currentKeyframe}},{key:"setStyles",value:function(e,t,n,i){var r=this;t&&(this._previousKeyframe.easing=t);var a=i&&i.params||{},o=function(e,t){var n,i={};return e.forEach(function(e){"*"===e?(n=n||Object.keys(t)).forEach(function(e){i[e]="*"}):Vp(e,!1,i)}),i}(e,this._globalTimelineStyles);Object.keys(o).forEach(function(e){var t=$p(o[e],a,n);r._pendingStyles[e]=t,r._localTimelineStyles.hasOwnProperty(e)||(r._backFill[e]=r._globalTimelineStyles.hasOwnProperty(e)?r._globalTimelineStyles[e]:"*"),r._updateStyle(e,t)})}},{key:"applyStylesToKeyframe",value:function(){var e=this,t=this._pendingStyles,n=Object.keys(t);0!=n.length&&(this._pendingStyles={},n.forEach(function(n){e._currentKeyframe[n]=t[n]}),Object.keys(this._localTimelineStyles).forEach(function(t){e._currentKeyframe.hasOwnProperty(t)||(e._currentKeyframe[t]=e._localTimelineStyles[t])}))}},{key:"snapshotCurrentStyles",value:function(){var e=this;Object.keys(this._localTimelineStyles).forEach(function(t){var n=e._localTimelineStyles[t];e._pendingStyles[t]=n,e._updateStyle(t,n)})}},{key:"getFinalKeyframe",value:function(){return this._keyframes.get(this.duration)}},{key:"properties",get:function(){var e=[];for(var t in this._currentKeyframe)e.push(t);return e}},{key:"mergeTimelineCollectedStyles",value:function(e){var t=this;Object.keys(e._styleSummary).forEach(function(n){var i=t._styleSummary[n],r=e._styleSummary[n];(!i||r.time>i.time)&&t._updateStyle(n,r.value)})}},{key:"buildKeyframes",value:function(){var e=this;this.applyStylesToKeyframe();var t=new Set,n=new Set,i=1===this._keyframes.size&&0===this.duration,r=[];this._keyframes.forEach(function(a,o){var s=Vp(a,!0);Object.keys(s).forEach(function(e){var i=s[e];"!"==i?t.add(e):"*"==i&&n.add(e)}),i||(s.offset=o/e.duration),r.push(s)});var a=t.size?Qp(t.values()):[],o=n.size?Qp(n.values()):[];if(i){var s=r[0],l=Hp(s);s.offset=0,l.offset=1,r=[s,l]}return gg(this.element,r,a,o,this.duration,this.startTime,this.easing,!1)}}]),e}(),Cg=function(e){h(n,e);var t=f(n);function n(e,i,r,a,o,s){var l,c=arguments.length>6&&void 0!==arguments[6]&&arguments[6];return y(this,n),(l=t.call(this,e,i,s.delay)).element=i,l.keyframes=r,l.preStyleProps=a,l.postStyleProps=o,l._stretchStartingKeyframe=c,l.timings={duration:s.duration,delay:s.delay,easing:s.easing},l}return k(n,[{key:"containsAnimation",value:function(){return this.keyframes.length>1}},{key:"buildKeyframes",value:function(){var e=this.keyframes,t=this.timings,n=t.delay,i=t.duration,r=t.easing;if(this._stretchStartingKeyframe&&n){var a=[],o=i+n,s=n/o,l=Vp(e[0],!1);l.offset=0,a.push(l);var c=Vp(e[0],!1);c.offset=Eg(s),a.push(c);for(var u=e.length-1,h=1;h<=u;h++){var d=Vp(e[h],!1);d.offset=Eg((n+d.offset*i)/o),a.push(d)}i=o,n=0,r="",e=a}return gg(this.element,e,this.preStyleProps,this.postStyleProps,i,n,r,!0)}}]),n}(xg);function Eg(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(10,t-1);return Math.round(e*n)/n}var Sg,Tg,Og=function e(){y(this,e)},Ig=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"normalizePropertyName",value:function(e,t){return eg(e)}},{key:"normalizeStyleValue",value:function(e,t,n,i){var r="",a=n.toString().trim();if(Mg[t]&&0!==n&&"0"!==n)if("number"==typeof n)r="px";else{var o=n.match(/^[+-]?[\d\.]+([a-z]*)$/);o&&0==o[1].length&&i.push("Please provide a CSS unit value for ".concat(e,":").concat(n))}return a+r}}]),n}(Og),Mg=(Sg="width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(","),Tg={},Sg.forEach(function(e){return Tg[e]=!0}),Tg);function Ag(e,t,n,i,r,a,o,s,l,c,u,h,d){return{type:0,element:e,triggerName:t,isRemovalTransition:r,fromState:n,fromStyles:a,toState:i,toStyles:o,timelines:s,queriedElements:l,preStyleProps:c,postStyleProps:u,totalTime:h,errors:d}}var Pg={},Dg=function(){function e(t,n,i){y(this,e),this._triggerName=t,this.ast=n,this._stateStyles=i}return k(e,[{key:"match",value:function(e,t,n,i){return function(e,t,n,i,r){return e.some(function(e){return e(t,n,i,r)})}(this.ast.matchers,e,t,n,i)}},{key:"buildStyles",value:function(e,t,n){var i=this._stateStyles["*"],r=this._stateStyles[e],a=i?i.buildStyles(t,n):{};return r?r.buildStyles(t,n):a}},{key:"build",value:function(e,t,n,i,r,a,o,s,l,c){var u=[],h=this.ast.options&&this.ast.options.params||Pg,d=this.buildStyles(n,o&&o.params||Pg,u),f=s&&s.params||Pg,p=this.buildStyles(i,f,u),g=new Set,m=new Map,v=new Map,y="void"===i,b={params:Object.assign(Object.assign({},h),f)},k=c?[]:bg(e,t,this.ast.animation,r,a,d,p,b,l,u),_=0;if(k.forEach(function(e){_=Math.max(e.duration+e.delay,_)}),u.length)return Ag(t,this._triggerName,n,i,y,d,p,[],[],m,v,_,u);k.forEach(function(e){var n=e.element,i=xp(m,n,{});e.preStyleProps.forEach(function(e){return i[e]=!0});var r=xp(v,n,{});e.postStyleProps.forEach(function(e){return r[e]=!0}),n!==t&&g.add(n)});var w=Qp(g.values());return Ag(t,this._triggerName,n,i,y,d,p,k,w,m,v,_)}}]),e}(),Rg=function(){function e(t,n){y(this,e),this.styles=t,this.defaultParams=n}return k(e,[{key:"buildStyles",value:function(e,t){var n={},i=Hp(this.defaultParams);return Object.keys(e).forEach(function(t){var n=e[t];null!=n&&(i[t]=n)}),this.styles.styles.forEach(function(e){if("string"!=typeof e){var r=e;Object.keys(r).forEach(function(e){var a=r[e];a.length>1&&(a=$p(a,i,t)),n[e]=a})}}),n}}]),e}(),Fg=function(){function e(t,n){var i=this;y(this,e),this.name=t,this.ast=n,this.transitionFactories=[],this.states={},n.states.forEach(function(e){i.states[e.name]=new Rg(e.style,e.options&&e.options.params||{})}),Ng(this.states,"true","1"),Ng(this.states,"false","0"),n.transitions.forEach(function(e){i.transitionFactories.push(new Dg(t,e,i.states))}),this.fallbackTransition=new Dg(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[function(e,t){return!0}],options:null,queryCount:0,depCount:0},this.states)}return k(e,[{key:"containsQueries",get:function(){return this.ast.queryCount>0}},{key:"matchTransition",value:function(e,t,n,i){return this.transitionFactories.find(function(r){return r.match(e,t,n,i)})||null}},{key:"matchStyles",value:function(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}}]),e}();function Ng(e,t,n){e.hasOwnProperty(t)?e.hasOwnProperty(n)||(e[n]=e[t]):e.hasOwnProperty(n)&&(e[t]=e[n])}var zg=new mg,Lg=function(){function e(t,n,i){y(this,e),this.bodyNode=t,this._driver=n,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}return k(e,[{key:"register",value:function(e,t){var n=[],i=cg(this._driver,t,n);if(n.length)throw new Error("Unable to build the animation due to the following errors: ".concat(n.join("\n")));this._animations[e]=i}},{key:"_buildPlayer",value:function(e,t,n){var i=e.element,r=bp(0,this._normalizer,0,e.keyframes,t,n);return this._driver.animate(i,r,e.duration,e.delay,e.easing,[],!0)}},{key:"create",value:function(e,t){var n,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=[],o=this._animations[e],s=new Map;if(o?(n=bg(this._driver,t,o,"ng-enter","ng-leave",{},{},r,zg,a)).forEach(function(e){var t=xp(s,e.element,{});e.postStyleProps.forEach(function(e){return t[e]=null})}):(a.push("The requested animation doesn't exist or has already been destroyed"),n=[]),a.length)throw new Error("Unable to create the animation due to the following errors: ".concat(a.join("\n")));s.forEach(function(e,t){Object.keys(e).forEach(function(n){e[n]=i._driver.computeStyle(t,n,"*")})});var l=yp(n.map(function(e){var t=s.get(e.element);return i._buildPlayer(e,{},t)}));return this._playersById[e]=l,l.onDestroy(function(){return i.destroy(e)}),this.players.push(l),l}},{key:"destroy",value:function(e){var t=this._getPlayer(e);t.destroy(),delete this._playersById[e];var n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}},{key:"_getPlayer",value:function(e){var t=this._playersById[e];if(!t)throw new Error("Unable to find the timeline player referenced by ".concat(e));return t}},{key:"listen",value:function(e,t,n,i){var r=wp(t,"","","");return kp(this._getPlayer(e),n,r,i),function(){}}},{key:"command",value:function(e,t,n,i){if("register"!=n)if("create"!=n){var r=this._getPlayer(e);switch(n){case"play":r.play();break;case"pause":r.pause();break;case"reset":r.reset();break;case"restart":r.restart();break;case"finish":r.finish();break;case"init":r.init();break;case"setPosition":r.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e)}}else this.create(e,t,i[0]||{});else this.register(e,i[0])}}]),e}(),Bg=[],jg={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},Ug={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Hg=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";y(this,e),this.namespaceId=n;var i,r=t&&t.hasOwnProperty("value");if(this.value=null!=(i=r?t.value:t)?i:null,r){var a=Hp(t);delete a.value,this.options=a}else this.options={};this.options.params||(this.options.params={})}return k(e,[{key:"params",get:function(){return this.options.params}},{key:"absorbOptions",value:function(e){var t=e.params;if(t){var n=this.options.params;Object.keys(t).forEach(function(e){null==n[e]&&(n[e]=t[e])})}}}]),e}(),Vg=new Hg("void"),Wg=function(){function e(t,n,i){y(this,e),this.id=t,this.hostElement=n,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+t,$g(n,this._hostClassName)}return k(e,[{key:"listen",value:function(e,t,n,i){var r,a=this;if(!this._triggers.hasOwnProperty(t))throw new Error('Unable to listen on the animation trigger event "'.concat(n,'" because the animation trigger "').concat(t,"\" doesn't exist!"));if(null==n||0==n.length)throw new Error('Unable to listen on the animation trigger "'.concat(t,'" because the provided event is undefined!'));if("start"!=(r=n)&&"done"!=r)throw new Error('The provided animation trigger event "'.concat(n,'" for the animation trigger "').concat(t,'" is not supported!'));var o=xp(this._elementListeners,e,[]),s={name:t,phase:n,callback:i};o.push(s);var l=xp(this._engine.statesByElement,e,{});return l.hasOwnProperty(t)||($g(e,"ng-trigger"),$g(e,"ng-trigger-"+t),l[t]=Vg),function(){a._engine.afterFlush(function(){var e=o.indexOf(s);e>=0&&o.splice(e,1),a._triggers[t]||delete l[t]})}}},{key:"register",value:function(e,t){return!this._triggers[e]&&(this._triggers[e]=t,!0)}},{key:"_getTrigger",value:function(e){var t=this._triggers[e];if(!t)throw new Error('The provided animation trigger "'.concat(e,'" has not been registered!'));return t}},{key:"trigger",value:function(e,t,n){var i=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=this._getTrigger(t),o=new Zg(this.id,t,e),s=this._engine.statesByElement.get(e);s||($g(e,"ng-trigger"),$g(e,"ng-trigger-"+t),this._engine.statesByElement.set(e,s={}));var l=s[t],c=new Hg(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&l&&c.absorbOptions(l.options),s[t]=c,l||(l=Vg),"void"===c.value||l.value!==c.value){var u=xp(this._engine.playersByElement,e,[]);u.forEach(function(e){e.namespaceId==i.id&&e.triggerName==t&&e.queued&&e.destroy()});var h=a.matchTransition(l.value,c.value,e,c.params),d=!1;if(!h){if(!r)return;h=a.fallbackTransition,d=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:h,fromState:l,toState:c,player:o,isFallbackTransition:d}),d||($g(e,"ng-animate-queued"),o.onStart(function(){Qg(e,"ng-animate-queued")})),o.onDone(function(){var t=i.players.indexOf(o);t>=0&&i.players.splice(t,1);var n=i._engine.playersByElement.get(e);if(n){var r=n.indexOf(o);r>=0&&n.splice(r,1)}}),this.players.push(o),u.push(o),o}if(!function(e,t){var n=Object.keys(e),i=Object.keys(t);if(n.length!=i.length)return!1;for(var r=0;r<n.length;r++){var a=n[r];if(!t.hasOwnProperty(a)||e[a]!==t[a])return!1}return!0}(l.params,c.params)){var f=[],p=a.matchStyles(l.value,l.params,f),g=a.matchStyles(c.value,c.params,f);f.length?this._engine.reportError(f):this._engine.afterFlush(function(){Yp(e,p),Zp(e,g)})}}},{key:"deregister",value:function(e){var t=this;delete this._triggers[e],this._engine.statesByElement.forEach(function(t,n){delete t[e]}),this._elementListeners.forEach(function(n,i){t._elementListeners.set(i,n.filter(function(t){return t.name!=e}))})}},{key:"clearElementCache",value:function(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);var t=this._engine.playersByElement.get(e);t&&(t.forEach(function(e){return e.destroy()}),this._engine.playersByElement.delete(e))}},{key:"_signalRemovalForInnerTriggers",value:function(e,t){var n=this,i=this._engine.driver.query(e,".ng-trigger",!0);i.forEach(function(e){if(!e.__ng_removed){var i=n._engine.fetchNamespacesByElement(e);i.size?i.forEach(function(n){return n.triggerLeaveAnimation(e,t,!1,!0)}):n.clearElementCache(e)}}),this._engine.afterFlushAnimationsDone(function(){return i.forEach(function(e){return n.clearElementCache(e)})})}},{key:"triggerLeaveAnimation",value:function(e,t,n,i){var r=this,a=this._engine.statesByElement.get(e);if(a){var o=[];if(Object.keys(a).forEach(function(t){if(r._triggers[t]){var n=r.trigger(e,t,"void",i);n&&o.push(n)}}),o.length)return this._engine.markElementAsRemoved(this.id,e,!0,t),n&&yp(o).onDone(function(){return r._engine.processLeaveNode(e)}),!0}return!1}},{key:"prepareLeaveAnimationListeners",value:function(e){var t=this,n=this._elementListeners.get(e),i=this._engine.statesByElement.get(e);if(n&&i){var r=new Set;n.forEach(function(n){var a=n.name;if(!r.has(a)){r.add(a);var o=t._triggers[a].fallbackTransition,s=i[a]||Vg,l=new Hg("void"),c=new Zg(t.id,a,e);t._engine.totalQueuedPlayers++,t._queue.push({element:e,triggerName:a,transition:o,fromState:s,toState:l,player:c,isFallbackTransition:!0})}})}}},{key:"removeNode",value:function(e,t){var n=this,i=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),!this.triggerLeaveAnimation(e,t,!0)){var r=!1;if(i.totalAnimations){var a=i.players.length?i.playersByQueriedElement.get(e):[];if(a&&a.length)r=!0;else for(var o=e;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}if(this.prepareLeaveAnimationListeners(e),r)i.markElementAsRemoved(this.id,e,!1,t);else{var s=e.__ng_removed;s&&s!==jg||(i.afterFlush(function(){return n.clearElementCache(e)}),i.destroyInnerAnimations(e),i._onRemovalComplete(e,t))}}}},{key:"insertNode",value:function(e,t){$g(e,this._hostClassName)}},{key:"drainQueuedTransitions",value:function(e){var t=this,n=[];return this._queue.forEach(function(i){var r=i.player;if(!r.destroyed){var a=i.element,o=t._elementListeners.get(a);o&&o.forEach(function(t){if(t.name==i.triggerName){var n=wp(a,i.triggerName,i.fromState.value,i.toState.value);n._data=e,kp(i.player,t.phase,n,t.callback)}}),r.markedForDestroy?t._engine.afterFlush(function(){r.destroy()}):n.push(i)}}),this._queue=[],n.sort(function(e,n){var i=e.transition.ast.depCount,r=n.transition.ast.depCount;return 0==i||0==r?i-r:t._engine.driver.containsElement(e.element,n.element)?1:-1})}},{key:"destroy",value:function(e){this.players.forEach(function(e){return e.destroy()}),this._signalRemovalForInnerTriggers(this.hostElement,e)}},{key:"elementContainsData",value:function(e){var t=!1;return this._elementListeners.has(e)&&(t=!0),t=!!this._queue.find(function(t){return t.element===e})||t}}]),e}(),Gg=function(){function e(t,n,i){y(this,e),this.bodyNode=t,this.driver=n,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=function(e,t){}}return k(e,[{key:"_onRemovalComplete",value:function(e,t){this.onRemovalComplete(e,t)}},{key:"queuedPlayers",get:function(){var e=[];return this._namespaceList.forEach(function(t){t.players.forEach(function(t){t.queued&&e.push(t)})}),e}},{key:"createNamespace",value:function(e,t){var n=new Wg(e,t,this);return t.parentNode?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}},{key:"_balanceNamespaceList",value:function(e,t){var n=this._namespaceList.length-1;if(n>=0){for(var i=!1,r=n;r>=0;r--)if(this.driver.containsElement(this._namespaceList[r].hostElement,t)){this._namespaceList.splice(r+1,0,e),i=!0;break}i||this._namespaceList.splice(0,0,e)}else this._namespaceList.push(e);return this.namespacesByHostElement.set(t,e),e}},{key:"register",value:function(e,t){var n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}},{key:"registerTrigger",value:function(e,t,n){var i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}},{key:"destroy",value:function(e,t){var n=this;if(e){var i=this._fetchNamespace(e);this.afterFlush(function(){n.namespacesByHostElement.delete(i.hostElement),delete n._namespaceLookup[e];var t=n._namespaceList.indexOf(i);t>=0&&n._namespaceList.splice(t,1)}),this.afterFlushAnimationsDone(function(){return i.destroy(t)})}}},{key:"_fetchNamespace",value:function(e){return this._namespaceLookup[e]}},{key:"fetchNamespacesByElement",value:function(e){var t=new Set,n=this.statesByElement.get(e);if(n)for(var i=Object.keys(n),r=0;r<i.length;r++){var a=n[i[r]].namespaceId;if(a){var o=this._fetchNamespace(a);o&&t.add(o)}}return t}},{key:"trigger",value:function(e,t,n,i){if(Yg(t)){var r=this._fetchNamespace(e);if(r)return r.trigger(t,n,i),!0}return!1}},{key:"insertNode",value:function(e,t,n,i){if(Yg(t)){var r=t.__ng_removed;if(r&&r.setForRemoval){r.setForRemoval=!1,r.setForMove=!0;var a=this.collectedLeaveElements.indexOf(t);a>=0&&this.collectedLeaveElements.splice(a,1)}if(e){var o=this._fetchNamespace(e);o&&o.insertNode(t,n)}i&&this.collectEnterElement(t)}}},{key:"collectEnterElement",value:function(e){this.collectedEnterElements.push(e)}},{key:"markElementAsDisabled",value:function(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),$g(e,"ng-animate-disabled")):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Qg(e,"ng-animate-disabled"))}},{key:"removeNode",value:function(e,t,n,i){if(Yg(t)){var r=e?this._fetchNamespace(e):null;if(r?r.removeNode(t,i):this.markElementAsRemoved(e,t,!1,i),n){var a=this.namespacesByHostElement.get(t);a&&a.id!==e&&a.removeNode(t,i)}}else this._onRemovalComplete(t,i)}},{key:"markElementAsRemoved",value:function(e,t,n,i){this.collectedLeaveElements.push(t),t.__ng_removed={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1}}},{key:"listen",value:function(e,t,n,i,r){return Yg(t)?this._fetchNamespace(e).listen(t,n,i,r):function(){}}},{key:"_buildInstruction",value:function(e,t,n,i,r){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,r)}},{key:"destroyInnerAnimations",value:function(e){var t=this,n=this.driver.query(e,".ng-trigger",!0);n.forEach(function(e){return t.destroyActiveAnimationsForElement(e)}),0!=this.playersByQueriedElement.size&&(n=this.driver.query(e,".ng-animating",!0)).forEach(function(e){return t.finishActiveQueriedAnimationOnElement(e)})}},{key:"destroyActiveAnimationsForElement",value:function(e){var t=this.playersByElement.get(e);t&&t.forEach(function(e){e.queued?e.markedForDestroy=!0:e.destroy()})}},{key:"finishActiveQueriedAnimationOnElement",value:function(e){var t=this.playersByQueriedElement.get(e);t&&t.forEach(function(e){return e.finish()})}},{key:"whenRenderingDone",value:function(){var e=this;return new Promise(function(t){if(e.players.length)return yp(e.players).onDone(function(){return t()});t()})}},{key:"processLeaveNode",value:function(e){var t=this,n=e.__ng_removed;if(n&&n.setForRemoval){if(e.__ng_removed=jg,n.namespaceId){this.destroyInnerAnimations(e);var i=this._fetchNamespace(n.namespaceId);i&&i.clearElementCache(e)}this._onRemovalComplete(e,n.setForRemoval)}this.driver.matchesElement(e,".ng-animate-disabled")&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(function(e){t.markElementAsDisabled(e,!1)})}},{key:"flush",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,n=[];if(this.newHostElements.size&&(this.newHostElements.forEach(function(t,n){return e._balanceNamespaceList(t,n)}),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(var i=0;i<this.collectedEnterElements.length;i++)$g(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){var r=[];try{n=this._flushAnimations(r,t)}finally{for(var a=0;a<r.length;a++)r[a]()}}else for(var o=0;o<this.collectedLeaveElements.length;o++)this.processLeaveNode(this.collectedLeaveElements[o]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(function(e){return e()}),this._flushFns=[],this._whenQuietFns.length){var s=this._whenQuietFns;this._whenQuietFns=[],n.length?yp(n).onDone(function(){s.forEach(function(e){return e()})}):s.forEach(function(e){return e()})}}},{key:"reportError",value:function(e){throw new Error("Unable to process animations due to the following failed trigger transitions\n ".concat(e.join("\n")))}},{key:"_flushAnimations",value:function(e,t){var n=this,r=new mg,a=[],o=new Map,s=[],l=new Map,c=new Map,u=new Map,h=new Set;this.disabledNodes.forEach(function(e){h.add(e);for(var t=n.driver.query(e,".ng-animate-queued",!0),i=0;i<t.length;i++)h.add(t[i])});var d=this.bodyNode,f=Array.from(this.statesByElement.keys()),p=Kg(f,this.collectedEnterElements),g=new Map,m=0;p.forEach(function(e,t){var n="ng-enter"+m++;g.set(t,n),e.forEach(function(e){return $g(e,n)})});for(var v=[],y=new Set,b=new Set,k=0;k<this.collectedLeaveElements.length;k++){var _=this.collectedLeaveElements[k],w=_.__ng_removed;w&&w.setForRemoval&&(v.push(_),y.add(_),w.hasAnimation?this.driver.query(_,".ng-star-inserted",!0).forEach(function(e){return y.add(e)}):b.add(_))}var x=new Map,C=Kg(f,Array.from(y));C.forEach(function(e,t){var n="ng-leave"+m++;x.set(t,n),e.forEach(function(e){return $g(e,n)})}),e.push(function(){p.forEach(function(e,t){var n=g.get(t);e.forEach(function(e){return Qg(e,n)})}),C.forEach(function(e,t){var n=x.get(t);e.forEach(function(e){return Qg(e,n)})}),v.forEach(function(e){n.processLeaveNode(e)})});for(var E=[],S=[],T=this._namespaceList.length-1;T>=0;T--)this._namespaceList[T].drainQueuedTransitions(t).forEach(function(e){var t=e.player,i=e.element;if(E.push(t),n.collectedEnterElements.length){var o=i.__ng_removed;if(o&&o.setForMove)return void t.destroy()}var h=!d||!n.driver.containsElement(d,i),f=x.get(i),p=g.get(i),m=n._buildInstruction(e,r,p,f,h);if(m.errors&&m.errors.length)S.push(m);else{if(h)return t.onStart(function(){return Yp(i,m.fromStyles)}),t.onDestroy(function(){return Zp(i,m.toStyles)}),void a.push(t);if(e.isFallbackTransition)return t.onStart(function(){return Yp(i,m.fromStyles)}),t.onDestroy(function(){return Zp(i,m.toStyles)}),void a.push(t);m.timelines.forEach(function(e){return e.stretchStartingKeyframe=!0}),r.append(i,m.timelines),s.push({instruction:m,player:t,element:i}),m.queriedElements.forEach(function(e){return xp(l,e,[]).push(t)}),m.preStyleProps.forEach(function(e,t){var n=Object.keys(e);if(n.length){var i=c.get(t);i||c.set(t,i=new Set),n.forEach(function(e){return i.add(e)})}}),m.postStyleProps.forEach(function(e,t){var n=Object.keys(e),i=u.get(t);i||u.set(t,i=new Set),n.forEach(function(e){return i.add(e)})})}});if(S.length){var O=[];S.forEach(function(e){O.push("@".concat(e.triggerName," has failed due to:\n")),e.errors.forEach(function(e){return O.push("- ".concat(e,"\n"))})}),E.forEach(function(e){return e.destroy()}),this.reportError(O)}var I=new Map,M=new Map;s.forEach(function(e){var t=e.element;r.has(t)&&(M.set(t,t),n._beforeAnimationBuild(e.player.namespaceId,e.instruction,I))}),a.forEach(function(e){var t=e.element;n._getPreviousPlayers(t,!1,e.namespaceId,e.triggerName,null).forEach(function(e){xp(I,t,[]).push(e),e.destroy()})});var A=v.filter(function(e){return tm(e,c,u)}),P=new Map;Xg(P,this.driver,b,u,"*").forEach(function(e){tm(e,c,u)&&A.push(e)});var D=new Map;p.forEach(function(e,t){Xg(D,n.driver,new Set(e),c,"!")}),A.forEach(function(e){var t=P.get(e),n=D.get(e);P.set(e,Object.assign(Object.assign({},t),n))});var R=[],F=[],N={};s.forEach(function(e){var t=e.element,i=e.player,s=e.instruction;if(r.has(t)){if(h.has(t))return i.onDestroy(function(){return Zp(t,s.toStyles)}),i.disabled=!0,i.overrideTotalTime(s.totalTime),void a.push(i);var l=N;if(M.size>1){for(var c=t,u=[];c=c.parentNode;){var d=M.get(c);if(d){l=d;break}u.push(c)}u.forEach(function(e){return M.set(e,l)})}var f=n._buildAnimation(i.namespaceId,s,I,o,D,P);if(i.setRealPlayer(f),l===N)R.push(i);else{var p=n.playersByElement.get(l);p&&p.length&&(i.parentPlayer=yp(p)),a.push(i)}}else Yp(t,s.fromStyles),i.onDestroy(function(){return Zp(t,s.toStyles)}),F.push(i),h.has(t)&&a.push(i)}),F.forEach(function(e){var t=o.get(e.element);if(t&&t.length){var n=yp(t);e.setRealPlayer(n)}}),a.forEach(function(e){e.parentPlayer?e.syncPlayerEvents(e.parentPlayer):e.destroy()});for(var z=0;z<v.length;z++){var L=v[z],B=L.__ng_removed;if(Qg(L,"ng-leave"),!B||!B.hasAnimation){var j=[];if(l.size){var U=l.get(L);U&&U.length&&j.push.apply(j,i(U));for(var H=this.driver.query(L,".ng-animating",!0),V=0;V<H.length;V++){var W=l.get(H[V]);W&&W.length&&j.push.apply(j,i(W))}}var G=j.filter(function(e){return!e.destroyed});G.length?Jg(this,L,G):this.processLeaveNode(L)}}return v.length=0,R.forEach(function(e){n.players.push(e),e.onDone(function(){e.destroy();var t=n.players.indexOf(e);n.players.splice(t,1)}),e.play()}),R}},{key:"elementContainsData",value:function(e,t){var n=!1,i=t.__ng_removed;return i&&i.setForRemoval&&(n=!0),this.playersByElement.has(t)&&(n=!0),this.playersByQueriedElement.has(t)&&(n=!0),this.statesByElement.has(t)&&(n=!0),this._fetchNamespace(e).elementContainsData(t)||n}},{key:"afterFlush",value:function(e){this._flushFns.push(e)}},{key:"afterFlushAnimationsDone",value:function(e){this._whenQuietFns.push(e)}},{key:"_getPreviousPlayers",value:function(e,t,n,i,r){var a=[];if(t){var o=this.playersByQueriedElement.get(e);o&&(a=o)}else{var s=this.playersByElement.get(e);if(s){var l=!r||"void"==r;s.forEach(function(e){e.queued||(l||e.triggerName==i)&&a.push(e)})}}return(n||i)&&(a=a.filter(function(e){return!(n&&n!=e.namespaceId||i&&i!=e.triggerName)})),a}},{key:"_beforeAnimationBuild",value:function(e,t,n){var i,r=this,o=t.element,s=t.isRemovalTransition?void 0:e,l=t.isRemovalTransition?void 0:t.triggerName,c=a(t.timelines);try{var u=function(){var e=i.value.element,a=e!==o,c=xp(n,e,[]);r._getPreviousPlayers(e,a,s,l,t.toState).forEach(function(e){var t=e.getRealPlayer();t.beforeDestroy&&t.beforeDestroy(),e.destroy(),c.push(e)})};for(c.s();!(i=c.n()).done;)u()}catch(h){c.e(h)}finally{c.f()}Yp(o,t.fromStyles)}},{key:"_buildAnimation",value:function(e,t,n,i,r,a){var o=this,s=t.triggerName,l=t.element,c=[],u=new Set,h=new Set,d=t.timelines.map(function(t){var d=t.element;u.add(d);var f=d.__ng_removed;if(f&&f.removedBeforeQueried)return new gp(t.duration,t.delay);var p,g,m=d!==l,v=(p=(n.get(d)||Bg).map(function(e){return e.getRealPlayer()}),g=[],em(p,g),g).filter(function(e){return!!e.element&&e.element===d}),y=r.get(d),b=a.get(d),k=bp(0,o._normalizer,0,t.keyframes,y,b),_=o._buildPlayer(t,k,v);if(t.subTimeline&&i&&h.add(d),m){var w=new Zg(e,s,d);w.setRealPlayer(_),c.push(w)}return _});c.forEach(function(e){xp(o.playersByQueriedElement,e.element,[]).push(e),e.onDone(function(){return function(e,t,n){var i;if(e instanceof Map){if(i=e.get(t)){if(i.length){var r=i.indexOf(n);i.splice(r,1)}0==i.length&&e.delete(t)}}else if(i=e[t]){if(i.length){var a=i.indexOf(n);i.splice(a,1)}0==i.length&&delete e[t]}return i}(o.playersByQueriedElement,e.element,e)})}),u.forEach(function(e){return $g(e,"ng-animating")});var f=yp(d);return f.onDestroy(function(){u.forEach(function(e){return Qg(e,"ng-animating")}),Zp(l,t.toStyles)}),h.forEach(function(e){xp(i,e,[]).push(f)}),f}},{key:"_buildPlayer",value:function(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new gp(e.duration,e.delay)}}]),e}(),Zg=function(){function e(t,n,i){y(this,e),this.namespaceId=t,this.triggerName=n,this.element=i,this._player=new gp,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}return k(e,[{key:"setRealPlayer",value:function(e){var t=this;this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(function(n){t._queuedCallbacks[n].forEach(function(t){return kp(e,n,void 0,t)})}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}},{key:"getRealPlayer",value:function(){return this._player}},{key:"overrideTotalTime",value:function(e){this.totalTime=e}},{key:"syncPlayerEvents",value:function(e){var t=this,n=this._player;n.triggerCallback&&e.onStart(function(){return n.triggerCallback("start")}),e.onDone(function(){return t.finish()}),e.onDestroy(function(){return t.destroy()})}},{key:"_queueEvent",value:function(e,t){xp(this._queuedCallbacks,e,[]).push(t)}},{key:"onDone",value:function(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}},{key:"onStart",value:function(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}},{key:"onDestroy",value:function(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}},{key:"init",value:function(){this._player.init()}},{key:"hasStarted",value:function(){return!this.queued&&this._player.hasStarted()}},{key:"play",value:function(){!this.queued&&this._player.play()}},{key:"pause",value:function(){!this.queued&&this._player.pause()}},{key:"restart",value:function(){!this.queued&&this._player.restart()}},{key:"finish",value:function(){this._player.finish()}},{key:"destroy",value:function(){this.destroyed=!0,this._player.destroy()}},{key:"reset",value:function(){!this.queued&&this._player.reset()}},{key:"setPosition",value:function(e){this.queued||this._player.setPosition(e)}},{key:"getPosition",value:function(){return this.queued?0:this._player.getPosition()}},{key:"triggerCallback",value:function(e){var t=this._player;t.triggerCallback&&t.triggerCallback(e)}}]),e}();function Yg(e){return e&&1===e.nodeType}function qg(e,t){var n=e.style.display;return e.style.display=null!=t?t:"none",n}function Xg(e,t,n,i,r){var a=[];n.forEach(function(e){return a.push(qg(e))});var o=[];i.forEach(function(n,i){var a={};n.forEach(function(e){var n=a[e]=t.computeStyle(i,e,r);n&&0!=n.length||(i.__ng_removed=Ug,o.push(i))}),e.set(i,a)});var s=0;return n.forEach(function(e){return qg(e,a[s++])}),o}function Kg(e,t){var n=new Map;if(e.forEach(function(e){return n.set(e,[])}),0==t.length)return n;var i=new Set(t),r=new Map;function a(e){if(!e)return 1;var t=r.get(e);if(t)return t;var o=e.parentNode;return t=n.has(o)?o:i.has(o)?1:a(o),r.set(e,t),t}return t.forEach(function(e){var t=a(e);1!==t&&n.get(t).push(e)}),n}function $g(e,t){if(e.classList)e.classList.add(t);else{var n=e.$$classes;n||(n=e.$$classes={}),n[t]=!0}}function Qg(e,t){if(e.classList)e.classList.remove(t);else{var n=e.$$classes;n&&delete n[t]}}function Jg(e,t,n){yp(n).onDone(function(){return e.processLeaveNode(t)})}function em(e,t){for(var n=0;n<e.length;n++){var i=e[n];i instanceof mp?em(i.players,t):t.push(i)}}function tm(e,t,n){var i=n.get(e);if(!i)return!1;var r=t.get(e);return r?i.forEach(function(e){return r.add(e)}):t.set(e,i),n.delete(e),!0}var nm=function(){function t(e,n,i){var r=this;y(this,t),this.bodyNode=e,this._driver=n,this._triggerCache={},this.onRemovalComplete=function(e,t){},this._transitionEngine=new Gg(e,n,i),this._timelineEngine=new Lg(e,n,i),this._transitionEngine.onRemovalComplete=function(e,t){return r.onRemovalComplete(e,t)}}return k(t,[{key:"registerTrigger",value:function(e,t,n,i,r){var a=e+"-"+i,o=this._triggerCache[a];if(!o){var s=[],l=cg(this._driver,r,s);if(s.length)throw new Error('The animation trigger "'.concat(i,'" has failed to build due to the following errors:\n - ').concat(s.join("\n - ")));o=function(e,t){return new Fg(e,t)}(i,l),this._triggerCache[a]=o}this._transitionEngine.registerTrigger(t,i,o)}},{key:"register",value:function(e,t){this._transitionEngine.register(e,t)}},{key:"destroy",value:function(e,t){this._transitionEngine.destroy(e,t)}},{key:"onInsert",value:function(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}},{key:"onRemove",value:function(e,t,n,i){this._transitionEngine.removeNode(e,t,i||!1,n)}},{key:"disableAnimations",value:function(e,t){this._transitionEngine.markElementAsDisabled(e,t)}},{key:"process",value:function(t,n,i,r){if("@"==i.charAt(0)){var a=e(Cp(i),2),o=a[0],s=a[1];this._timelineEngine.command(o,n,s,r)}else this._transitionEngine.trigger(t,n,i,r)}},{key:"listen",value:function(t,n,i,r,a){if("@"==i.charAt(0)){var o=e(Cp(i),2),s=o[0],l=o[1];return this._timelineEngine.listen(s,n,l,a)}return this._transitionEngine.listen(t,n,i,r,a)}},{key:"flush",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1;this._transitionEngine.flush(e)}},{key:"players",get:function(){return this._transitionEngine.players.concat(this._timelineEngine.players)}},{key:"whenRenderingDone",value:function(){return this._transitionEngine.whenRenderingDone()}}]),t}();function im(e,t){var n=null,i=null;return Array.isArray(t)&&t.length?(n=am(t[0]),t.length>1&&(i=am(t[t.length-1]))):t&&(n=am(t)),n||i?new rm(e,n,i):null}var rm=function(){var e=function(){function e(t,n,i){y(this,e),this._element=t,this._startStyles=n,this._endStyles=i,this._state=0;var r=e.initialStylesByElement.get(t);r||e.initialStylesByElement.set(t,r={}),this._initialStyles=r}return k(e,[{key:"start",value:function(){this._state<1&&(this._startStyles&&Zp(this._element,this._startStyles,this._initialStyles),this._state=1)}},{key:"finish",value:function(){this.start(),this._state<2&&(Zp(this._element,this._initialStyles),this._endStyles&&(Zp(this._element,this._endStyles),this._endStyles=null),this._state=1)}},{key:"destroy",value:function(){this.finish(),this._state<3&&(e.initialStylesByElement.delete(this._element),this._startStyles&&(Yp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Yp(this._element,this._endStyles),this._endStyles=null),Zp(this._element,this._initialStyles),this._state=3)}}]),e}();return e.initialStylesByElement=new WeakMap,e}();function am(e){for(var t=null,n=Object.keys(e),i=0;i<n.length;i++){var r=n[i];om(r)&&((t=t||{})[r]=e[r])}return t}function om(e){return"display"===e||"position"===e}var sm=function(){function e(t,n,i,r,a,o,s){var l=this;y(this,e),this._element=t,this._name=n,this._duration=i,this._delay=r,this._easing=a,this._fillMode=o,this._onDoneFn=s,this._finished=!1,this._destroyed=!1,this._startTime=0,this._position=0,this._eventFn=function(e){return l._handleCallback(e)}}return k(e,[{key:"apply",value:function(){var e,t,n;e=this._element,t="".concat(this._duration,"ms ").concat(this._easing," ").concat(this._delay,"ms 1 normal ").concat(this._fillMode," ").concat(this._name),(n=fm(e,"").trim()).length&&(function(e,t){for(var n=0;n<e.length;n++)e.charAt(n)}(n),t="".concat(n,", ").concat(t)),dm(e,"",t),hm(this._element,this._eventFn,!1),this._startTime=Date.now()}},{key:"pause",value:function(){lm(this._element,this._name,"paused")}},{key:"resume",value:function(){lm(this._element,this._name,"running")}},{key:"setPosition",value:function(e){var t=cm(this._element,this._name);this._position=e*this._duration,dm(this._element,"Delay","-".concat(this._position,"ms"),t)}},{key:"getPosition",value:function(){return this._position}},{key:"_handleCallback",value:function(e){var t=e._ngTestManualTimestamp||Date.now(),n=1e3*parseFloat(e.elapsedTime.toFixed(3));e.animationName==this._name&&Math.max(t-this._startTime,0)>=this._delay&&n>=this._duration&&this.finish()}},{key:"finish",value:function(){this._finished||(this._finished=!0,this._onDoneFn(),hm(this._element,this._eventFn,!0))}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this.finish(),function(e,t){var n=fm(e,"").split(","),i=um(n,t);i>=0&&(n.splice(i,1),dm(e,"",n.join(",")))}(this._element,this._name))}}]),e}();function lm(e,t,n){dm(e,"PlayState",n,cm(e,t))}function cm(e,t){var n=fm(e,"");return n.indexOf(",")>0?um(n.split(","),t):um([n],t)}function um(e,t){for(var n=0;n<e.length;n++)if(e[n].indexOf(t)>=0)return n;return-1}function hm(e,t,n){n?e.removeEventListener("animationend",t):e.addEventListener("animationend",t)}function dm(e,t,n,i){var r="animation"+t;if(null!=i){var a=e.style[r];if(a.length){var o=a.split(",");o[i]=n,n=o.join(",")}}e.style[r]=n}function fm(e,t){return e.style["animation"+t]||""}var pm=function(){function e(t,n,i,r,a,o,s,l){y(this,e),this.element=t,this.keyframes=n,this.animationName=i,this._duration=r,this._delay=a,this._finalStyles=s,this._specialStyles=l,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this.currentSnapshot={},this._state=0,this.easing=o||"linear",this.totalTime=r+a,this._buildStyler()}return k(e,[{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"destroy",value:function(){this.init(),this._state>=4||(this._state=4,this._styler.destroy(),this._flushStartFns(),this._flushDoneFns(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"_flushDoneFns",value:function(){this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[]}},{key:"_flushStartFns",value:function(){this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[]}},{key:"finish",value:function(){this.init(),this._state>=3||(this._state=3,this._styler.finish(),this._flushStartFns(),this._specialStyles&&this._specialStyles.finish(),this._flushDoneFns())}},{key:"setPosition",value:function(e){this._styler.setPosition(e)}},{key:"getPosition",value:function(){return this._styler.getPosition()}},{key:"hasStarted",value:function(){return this._state>=2}},{key:"init",value:function(){this._state>=1||(this._state=1,this._styler.apply(),this._delay&&this._styler.pause())}},{key:"play",value:function(){this.init(),this.hasStarted()||(this._flushStartFns(),this._state=2,this._specialStyles&&this._specialStyles.start()),this._styler.resume()}},{key:"pause",value:function(){this.init(),this._styler.pause()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"reset",value:function(){this._styler.destroy(),this._buildStyler(),this._styler.apply()}},{key:"_buildStyler",value:function(){var e=this;this._styler=new sm(this.element,this.animationName,this._duration,this._delay,this.easing,"forwards",function(){return e.finish()})}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}},{key:"beforeDestroy",value:function(){var e=this;this.init();var t={};if(this.hasStarted()){var n=this._state>=3;Object.keys(this._finalStyles).forEach(function(i){"offset"!=i&&(t[i]=n?e._finalStyles[i]:rg(e.element,i))})}this.currentSnapshot=t}}]),e}(),gm=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this)).element=e,r._startingStyles={},r.__initialized=!1,r._styles=Fp(i),r}return k(n,[{key:"init",value:function(){var e=this;!this.__initialized&&this._startingStyles&&(this.__initialized=!0,Object.keys(this._styles).forEach(function(t){e._startingStyles[t]=e.element.style[t]}),u(v(n.prototype),"init",this).call(this))}},{key:"play",value:function(){var e=this;this._startingStyles&&(this.init(),Object.keys(this._styles).forEach(function(t){return e.element.style.setProperty(t,e._styles[t])}),u(v(n.prototype),"play",this).call(this))}},{key:"destroy",value:function(){var e=this;this._startingStyles&&(Object.keys(this._startingStyles).forEach(function(t){var n=e._startingStyles[t];n?e.element.style.setProperty(t,n):e.element.style.removeProperty(t)}),this._startingStyles=null,u(v(n.prototype),"destroy",this).call(this))}}]),n}(gp),mm=function(){function e(){y(this,e),this._count=0,this._head=document.querySelector("head")}return k(e,[{key:"validateStyleProperty",value:function(e){return Ap(e)}},{key:"matchesElement",value:function(e,t){return Pp(e,t)}},{key:"containsElement",value:function(e,t){return Dp(e,t)}},{key:"query",value:function(e,t,n){return Rp(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"buildKeyframeElement",value:function(e,t,n){n=n.map(function(e){return Fp(e)});var i="@keyframes ".concat(t," {\n"),r="";n.forEach(function(e){r=" ";var t=parseFloat(e.offset);i+="".concat(r).concat(100*t,"% {\n"),r+=" ",Object.keys(e).forEach(function(t){var n=e[t];switch(t){case"offset":return;case"easing":return void(n&&(i+="".concat(r,"animation-timing-function: ").concat(n,";\n")));default:return void(i+="".concat(r).concat(t,": ").concat(n,";\n"))}}),i+="".concat(r,"}\n")}),i+="}\n";var a=document.createElement("style");return a.textContent=i,a}},{key:"animate",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=a.filter(function(e){return e instanceof pm}),s={};tg(n,i)&&o.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return s[e]=t[e]})});var l=function(e){var t={};return e&&(Array.isArray(e)?e:[e]).forEach(function(e){Object.keys(e).forEach(function(n){"offset"!=n&&"easing"!=n&&(t[n]=e[n])})}),t}(t=ng(e,t,s));if(0==n)return new gm(e,l);var c="gen_css_kf_"+this._count++,u=this.buildKeyframeElement(e,c,t);document.querySelector("head").appendChild(u);var h=im(e,t),d=new pm(e,t,c,n,i,r,l,h);return d.onDestroy(function(){var e;(e=u).parentNode.removeChild(e)}),d}}]),e}(),vm=function(){function e(t,n,i,r){y(this,e),this.element=t,this.keyframes=n,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}return k(e,[{key:"_onFinish",value:function(){this._finished||(this._finished=!0,this._onDoneFns.forEach(function(e){return e()}),this._onDoneFns=[])}},{key:"init",value:function(){this._buildPlayer(),this._preparePlayerBeforeStart()}},{key:"_buildPlayer",value:function(){var e=this;if(!this._initialized){this._initialized=!0;var t=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,t,this.options),this._finalKeyframe=t.length?t[t.length-1]:{},this.domPlayer.addEventListener("finish",function(){return e._onFinish()})}}},{key:"_preparePlayerBeforeStart",value:function(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}},{key:"_triggerWebAnimation",value:function(e,t,n){return e.animate(t,n)}},{key:"onStart",value:function(e){this._onStartFns.push(e)}},{key:"onDone",value:function(e){this._onDoneFns.push(e)}},{key:"onDestroy",value:function(e){this._onDestroyFns.push(e)}},{key:"play",value:function(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(function(e){return e()}),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}},{key:"pause",value:function(){this.init(),this.domPlayer.pause()}},{key:"finish",value:function(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}},{key:"reset",value:function(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}},{key:"_resetDomPlayerState",value:function(){this.domPlayer&&this.domPlayer.cancel()}},{key:"restart",value:function(){this.reset(),this.play()}},{key:"hasStarted",value:function(){return this._started}},{key:"destroy",value:function(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(function(e){return e()}),this._onDestroyFns=[])}},{key:"setPosition",value:function(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}},{key:"getPosition",value:function(){return this.domPlayer.currentTime/this.time}},{key:"totalTime",get:function(){return this._delay+this._duration}},{key:"beforeDestroy",value:function(){var e=this,t={};this.hasStarted()&&Object.keys(this._finalKeyframe).forEach(function(n){"offset"!=n&&(t[n]=e._finished?e._finalKeyframe[n]:rg(e.element,n))}),this.currentSnapshot=t}},{key:"triggerCallback",value:function(e){var t="start"==e?this._onStartFns:this._onDoneFns;t.forEach(function(e){return e()}),t.length=0}}]),e}(),ym=function(){function e(){y(this,e),this._isNativeImpl=/\{\s*\[native\s+code\]\s*\}/.test(bm().toString()),this._cssKeyframesDriver=new mm}return k(e,[{key:"validateStyleProperty",value:function(e){return Ap(e)}},{key:"matchesElement",value:function(e,t){return Pp(e,t)}},{key:"containsElement",value:function(e,t){return Dp(e,t)}},{key:"query",value:function(e,t,n){return Rp(e,t,n)}},{key:"computeStyle",value:function(e,t,n){return window.getComputedStyle(e)[t]}},{key:"overrideWebAnimationsSupport",value:function(e){this._isNativeImpl=e}},{key:"animate",value:function(e,t,n,i,r){var a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[],o=arguments.length>6?arguments[6]:void 0;if(!o&&!this._isNativeImpl)return this._cssKeyframesDriver.animate(e,t,n,i,r,a);var s={duration:n,delay:i,fill:0==i?"both":"forwards"};r&&(s.easing=r);var l={},c=a.filter(function(e){return e instanceof vm});tg(n,i)&&c.forEach(function(e){var t=e.currentSnapshot;Object.keys(t).forEach(function(e){return l[e]=t[e]})});var u=im(e,t=ng(e,t=t.map(function(e){return Vp(e,!1)}),l));return new vm(e,t,s,u)}}]),e}();function bm(){return"undefined"!=typeof window&&void 0!==window.document&&Element.prototype.animate||{}}var km,_m=((km=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._nextAnimationId=0,r._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Ze.None,styles:[],data:{animation:[]}}),r}return k(n,[{key:"build",value:function(e){var t=this._nextAnimationId.toString();this._nextAnimationId++;var n=Array.isArray(e)?cp(e):e;return Cm(this._renderer,null,t,"register",[n]),new wm(t,this._renderer)}}]),n}(op)).\u0275fac=function(e){return new(e||km)(wi(ul),wi(xu))},km.\u0275prov=Ae({token:km,factory:km.\u0275fac}),km),wm=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this))._id=e,r._renderer=i,r}return k(n,[{key:"create",value:function(e,t){return new xm(this._id,e,t||{},this._renderer)}}]),n}(function(){return function e(){y(this,e)}}()),xm=function(){function e(t,n,i,r){y(this,e),this.id=t,this.element=n,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}return k(e,[{key:"_listen",value:function(e,t){return this._renderer.listen(this.element,"@@".concat(this.id,":").concat(e),t)}},{key:"_command",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Cm(this._renderer,this.element,this.id,e,n)}},{key:"onDone",value:function(e){this._listen("done",e)}},{key:"onStart",value:function(e){this._listen("start",e)}},{key:"onDestroy",value:function(e){this._listen("destroy",e)}},{key:"init",value:function(){this._command("init")}},{key:"hasStarted",value:function(){return this._started}},{key:"play",value:function(){this._command("play"),this._started=!0}},{key:"pause",value:function(){this._command("pause")}},{key:"restart",value:function(){this._command("restart")}},{key:"finish",value:function(){this._command("finish")}},{key:"destroy",value:function(){this._command("destroy")}},{key:"reset",value:function(){this._command("reset")}},{key:"setPosition",value:function(e){this._command("setPosition",e)}},{key:"getPosition",value:function(){var e,t;return null!==(t=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==t?t:0}}]),e}();function Cm(e,t,n,i,r){return e.setProperty(t,"@@".concat(n,":").concat(i),r)}var Em,Sm,Tm,Om,Im,Mm=((Em=function(){function t(e,n,i){y(this,t),this.delegate=e,this.engine=n,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),n.onRemovalComplete=function(e,t){t&&t.parentNode(e)&&t.removeChild(e.parentNode,e)}}return k(t,[{key:"createRenderer",value:function(e,t){var n=this,i=this.delegate.createRenderer(e,t);if(!(e&&t&&t.data&&t.data.animation)){var r=this._rendererCache.get(i);return r||(r=new Am("",i,this.engine),this._rendererCache.set(i,r)),r}var a=t.id,o=t.id+"-"+this._currentId;return this._currentId++,this.engine.register(o,e),t.data.animation.forEach(function t(i){Array.isArray(i)?i.forEach(t):n.engine.registerTrigger(a,o,e,i.name,i)}),new Pm(this,o,i,this.engine)}},{key:"begin",value:function(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}},{key:"_scheduleCountTask",value:function(){var e=this;this.promise.then(function(){e._microtaskId++})}},{key:"scheduleListenerCallback",value:function(t,n,i){var r=this;t>=0&&t<this._microtaskId?this._zone.run(function(){return n(i)}):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(function(){r._zone.run(function(){r._animationCallbacksBuffer.forEach(function(t){var n=e(t,2);(0,n[0])(n[1])}),r._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([n,i]))}},{key:"end",value:function(){var e=this;this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(function(){e._scheduleCountTask(),e.engine.flush(e._microtaskId)}),this.delegate.end&&this.delegate.end()}},{key:"whenRenderingDone",value:function(){return this.engine.whenRenderingDone()}}]),t}()).\u0275fac=function(e){return new(e||Em)(wi(ul),wi(nm),wi($c))},Em.\u0275prov=Ae({token:Em,factory:Em.\u0275fac}),Em),Am=function(){function e(t,n,i){y(this,e),this.namespaceId=t,this.delegate=n,this.engine=i,this.destroyNode=this.delegate.destroyNode?function(e){return n.destroyNode(e)}:null}return k(e,[{key:"data",get:function(){return this.delegate.data}},{key:"destroy",value:function(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}},{key:"createElement",value:function(e,t){return this.delegate.createElement(e,t)}},{key:"createComment",value:function(e){return this.delegate.createComment(e)}},{key:"createText",value:function(e){return this.delegate.createText(e)}},{key:"appendChild",value:function(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}},{key:"insertBefore",value:function(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}},{key:"removeChild",value:function(e,t,n){this.engine.onRemove(this.namespaceId,t,this.delegate,n)}},{key:"selectRootElement",value:function(e,t){return this.delegate.selectRootElement(e,t)}},{key:"parentNode",value:function(e){return this.delegate.parentNode(e)}},{key:"nextSibling",value:function(e){return this.delegate.nextSibling(e)}},{key:"setAttribute",value:function(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}},{key:"removeAttribute",value:function(e,t,n){this.delegate.removeAttribute(e,t,n)}},{key:"addClass",value:function(e,t){this.delegate.addClass(e,t)}},{key:"removeClass",value:function(e,t){this.delegate.removeClass(e,t)}},{key:"setStyle",value:function(e,t,n,i){this.delegate.setStyle(e,t,n,i)}},{key:"removeStyle",value:function(e,t,n){this.delegate.removeStyle(e,t,n)}},{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)&&"@.disabled"==t?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}},{key:"setValue",value:function(e,t){this.delegate.setValue(e,t)}},{key:"listen",value:function(e,t,n){return this.delegate.listen(e,t,n)}},{key:"disableAnimations",value:function(e,t){this.engine.disableAnimations(e,t)}}]),e}(),Pm=function(t){h(i,t);var n=f(i);function i(e,t,r,a){var o;return y(this,i),(o=n.call(this,t,r,a)).factory=e,o.namespaceId=t,o}return k(i,[{key:"setProperty",value:function(e,t,n){"@"==t.charAt(0)?"."==t.charAt(1)&&"@.disabled"==t?this.disableAnimations(e,n=void 0===n||!!n):this.engine.process(this.namespaceId,e,t.substr(1),n):this.delegate.setProperty(e,t,n)}},{key:"listen",value:function(t,n,i){var r,a,o=this;if("@"==n.charAt(0)){var s,l=function(e){switch(e){case"body":return document.body;case"document":return document;case"window":return window;default:return e}}(t),c=n.substr(1),u="";return"@"!=c.charAt(0)&&(a=(r=c).indexOf("."),c=(s=e([r.substring(0,a),r.substr(a+1)],2))[0],u=s[1]),this.engine.listen(this.namespaceId,l,c,u,function(e){o.factory.scheduleListenerCallback(e._data||-1,i,e)})}return this.delegate.listen(t,n,i)}}]),i}(Am),Dm=((Sm=function(e){h(n,e);var t=f(n);function n(e,i,r){return y(this,n),t.call(this,e.body,i,r)}return n}(nm)).\u0275fac=function(e){return new(e||Sm)(wi(xu),wi(Lp),wi(Og))},Sm.\u0275prov=Ae({token:Sm,factory:Sm.\u0275fac}),Sm),Rm=[{provide:Lp,useFactory:function(){return"function"==typeof bm()?new ym:new mm}},{provide:new si("AnimationModuleType"),useValue:"BrowserAnimations"},{provide:op,useClass:_m},{provide:Og,useFactory:function(){return new Ig}},{provide:nm,useClass:Dm},{provide:ul,useFactory:function(e,t,n){return new Mm(e,t,n)},deps:[td,nm,$c]}],Fm=((Om=function e(){y(this,e)}).\u0275fac=function(e){return new(e||Om)},Om.\u0275mod=pt({type:Om}),Om.\u0275inj=Pe({providers:Rm,imports:[gd]}),Om),Nm=((Tm=function(){function e(){y(this,e),this.count=0,this.animeState="active"}return k(e,[{key:"ngOnChanges",value:function(){var e=this;this.animeState="inactive",setTimeout(function(){e.animeState="active"})}},{key:"animationShuffleDone",value:function(e){this.animeState="inactive"}}]),e}()).\u0275fac=function(e){return new(e||Tm)},Tm.\u0275cmp=ct({type:Tm,selectors:[["badge"]],inputs:{count:"count"},features:[It],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,t){1&e&&(Zo(0,"div",0),zs(1),Yo()),2&e&&(Wo("@bounce",t.animeState),sa(1),Ls(t.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[sp("bounce",[hp("active",up({transform:""})),fp("* => active",[lp("600ms ease",dp([up({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),up({transform:"scale3d(2, 2, 2)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),Tm);function zm(e,t,n,i){var r,a=arguments.length,o=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(r=e[s])&&(o=(a<3?r(o):a>3?r(t,n,o):r(t,n))||o);return a>3&&o&&Object.defineProperty(t,n,o),o}function Lm(e,t,n,i){return new(n||(n=Promise))(function(r,a){function o(e){try{l(i.next(e))}catch(t){a(t)}}function s(e){try{l(i.throw(e))}catch(t){a(t)}}function l(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}l((i=i.apply(e,t||[])).next())})}!function(e){e.resize=function(e,t,n,i){for(var r=e.width,a=e.height,o=r/(t=Math.round(t)),s=a/(n=Math.round(n)),l=Math.ceil(o/2),c=Math.ceil(s/2),u=e.getContext("2d"),h=u.getImageData(0,0,r,a),d=u.createImageData(t,n),f=h.data,p=d.data,g=0;g<n;g++)for(var m=0;m<t;m++){for(var v=4*(m+g*t),y=0,b=0,k=0,_=0,w=0,x=0,C=0,E=(g+.5)*s,S=Math.floor(g*s),T=Math.ceil((g+1)*s),O=S;O<T;O++)for(var I=Math.abs(E-(O+.5))/c,M=(m+.5)*o,A=I*I,P=Math.floor(m*o),D=Math.ceil((m+1)*o),R=P;R<D;R++){var F=Math.abs(M-(R+.5))/l,N=Math.sqrt(A+F*F);if(!(N>=1)){var z=4*(R+O*r);C+=(y=2*N*N*N-3*N*N+1)*f[z+3],k+=y,f[z+3]<255&&(y=y*f[z+3]/250),_+=y*f[z],w+=y*f[z+1],x+=y*f[z+2],b+=y}}p[v]=_/b,p[v+1]=w/b,p[v+2]=x/b,p[v+3]=C/k}!0===i?(e.width=t,e.height=n):u.clearRect(0,0,r,a),u.putImageData(d,0,0)}}(Im||(Im={}));var Bm,jm=p("F+F2"),Um=p("lPiR");!function(e){function t(e){var t=jm.create(e);return Um(t).toString()}e.readAsArrayBufferAsync=function(e){return new Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(i.result)},i.onabort=i.onerror=function(e){n(e)},i.readAsArrayBuffer(e)})},e.readAsTextAsync=function(e){return new Promise(function(t,n){var i=new FileReader;i.onload=function(e){t(i.result)},i.onabort=i.onerror=function(e){n(e)},i.readAsText(e)})},e.calcSHA256Async=function(n){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.abrupt("return",n instanceof Blob?function(n){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.t0=t,i.next=3,e.readAsArrayBufferAsync(n);case 3:return i.t1=i.sent,i.abrupt("return",(0,i.t0)(i.t1));case 5:case"end":return i.stop()}},i)}))}(n):t(n));case 1:case"end":return i.stop()}},i)}))}}(Bm||(Bm={}));var Hm,Vm=function(e){return e[e.NULL=0]="NULL",e[e.THUMBNAIL=1]="THUMBNAIL",e[e.COMPLETE=2]="COMPLETE",e[e.URL=1e3]="URL",e}({}),Wm=((Hm=function(){function e(){y(this,e),this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}return k(e,[{key:"identifier",get:function(){return this.context.identifier}},{key:"name",get:function(){return this.context.name}},{key:"blob",get:function(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}},{key:"url",get:function(){return this.context.url?this.context.url:this.context.thumbnail.url}},{key:"thumbnail",get:function(){return this.context.thumbnail}},{key:"state",get:function(){return this.url||this.blob?this.url&&!this.blob?Vm.URL:this.blob===this.thumbnail.blob?Vm.THUMBNAIL:Vm.COMPLETE:Vm.NULL}},{key:"isEmpty",get:function(){return this.state<=Vm.NULL}},{key:"destroy",value:function(){this.revokeURLs()}},{key:"apply",value:function(e){!this.context.identifier&&e.identifier&&(this.context.identifier=e.identifier),!this.context.name&&e.name&&(this.context.name=e.name),!this.context.blob&&e.blob&&(this.context.blob=e.blob),!this.context.type&&e.type&&(this.context.type=e.type),!this.context.url&&e.url&&(this.state!==Vm.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=e.url),!this.context.thumbnail.blob&&e.thumbnail.blob&&(this.context.thumbnail.blob=e.thumbnail.blob),!this.context.thumbnail.type&&e.thumbnail.type&&(this.context.thumbnail.type=e.thumbnail.type),!this.context.thumbnail.url&&e.thumbnail.url&&(this.state!==Vm.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=e.thumbnail.url),this.createURLs()}},{key:"toContext",value:function(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}},{key:"createURLs",value:function(){this.state!==Vm.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}},{key:"revokeURLs",value:function(){this.state!==Vm.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}}],[{key:"createEmpty",value:function(t){var n=new e;return n.context.identifier=t,n}},{key:"create",value:function(t){if("string"==typeof t){var n=new e;return n.context.identifier=t,n.context.name=t,n.context.url=t,n}var i=new e;return i.apply(t),i}},{key:"createAsync",value:function(t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t instanceof File)){n.next=6;break}return n.next=3,e._createAsync(t,t.name);case 3:n.t0=n.sent,n.next=14;break;case 6:if(!(t instanceof Blob)){n.next=12;break}return n.next=9,e._createAsync(t);case 9:n.t1=n.sent,n.next=13;break;case 12:n.t1=void 0;case 13:n.t0=n.t1;case 14:return n.abrupt("return",n.t0);case 15:case"end":return n.stop()}},n)}))}},{key:"_createAsync",value:function(t,n){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Bm.readAsArrayBufferAsync(t);case 2:return r=i.sent,a=new e,i.next=6,Bm.calcSHA256Async(r);case 6:return a.context.identifier=i.sent,a.context.name=n,a.context.blob=new Blob([r],{type:t.type}),a.context.url=window.URL.createObjectURL(a.context.blob),i.prev=10,i.next=13,e.createThumbnailAsync(a.context);case 13:a.context.thumbnail=i.sent,i.next=19;break;case 16:throw i.prev=16,i.t0=i.catch(10),i.t0;case 19:return i.abrupt("return",(null!=a.context.name&&(a.context.name=a.context.identifier),a));case 20:case"end":return i.stop()}},i,null,[[10,16]])}))}},{key:"createThumbnailAsync",value:function(e){return new Promise(function(t,n){var i=document.createElement("canvas"),r=i.getContext("2d"),a=new Image;a.onload=function(n){var o=128/(a.width<a.height?a.height:a.width);o=o<1?o:1;var s=a.width*o,l=a.height*o;i.width=a.width,i.height=a.height,r.drawImage(a,0,0),Im.resize(i,s,l,!0),i.toBlob(function(e){var n={type:e.type,blob:e,url:window.URL.createObjectURL(e)};t(n)},e.blob.type)},a.onabort=a.onerror=function(){n()},a.src=e.url})}}]),e}()).Empty=Hm.createEmpty("null"),Hm),Gm=0,Zm=new Map,Ym=new MessageChannel;function qm(e){if(4294967296===Gm&&(Gm=0),++Gm in Zm)throw new Error("setZeroTimeout queue overflow.");return Zm.set(Gm,e),Ym.port2.postMessage(Gm),Gm}Ym.port1.onmessage=function(e){var t=Zm.get(e.data);Zm.delete(e.data),t&&t()},Ym.port1.start(),Ym.port2.start();var Xm=function e(){y(this,e)},Km=p("zqaK"),$m=function(e){if(e.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<e.length;i++){var r=e.charAt(i),a=r.charCodeAt(0);if(255!==t[a])throw new TypeError(r+" is ambiguous");t[a]=i}var o=e.length,s=e.charAt(0),l=Math.log(o)/Math.log(256),c=Math.log(256)/Math.log(o);function u(e){if("string"!=typeof e)throw new TypeError("Expected String");if(0===e.length)return new Uint8Array;var n=0;if(" "!==e[n]){for(var i=0,r=0;e[n]===s;)i++,n++;for(var a=(e.length-n)*l+1>>>0,c=new Uint8Array(a);e[n];){var u=t[e.charCodeAt(n)];if(255===u)return;for(var h=0,d=a-1;(0!==u||h<r)&&-1!==d;d--,h++)u+=o*c[d]>>>0,c[d]=u%256>>>0,u=u/256>>>0;if(0!==u)throw new Error("Non-zero carry");r=h,n++}if(" "!==e[n]){for(var f=a-r;f!==a&&0===c[f];)f++;for(var p=new Uint8Array(i+(a-f)),g=i;f!==a;)p[g++]=c[f++];return p}}}return{encode:function(t){if(t instanceof Uint8Array||(ArrayBuffer.isView(t)?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):Array.isArray(t)&&(t=Uint8Array.from(t))),!(t instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===t.length)return"";for(var n=0,i=0,r=0,a=t.length;r!==a&&0===t[r];)r++,n++;for(var l=(a-r)*c+1>>>0,u=new Uint8Array(l);r!==a;){for(var h=t[r],d=0,f=l-1;(0!==h||d<i)&&-1!==f;f--,d++)h+=256*u[f]>>>0,u[f]=h%o>>>0,h=h/o>>>0;if(0!==h)throw new Error("Non-zero carry");i=d,r++}for(var p=l-i;p!==l&&0===u[p];)p++;for(var g=s.repeat(n);p<l;++p)g+=e.charAt(u[p]);return g},decodeUnsafe:u,decode:function(e){var t=u(e);if(t)return t;throw new Error("Non-base"+o+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),Qm=/^(\w{6})(\w{3})(\w*)-(\w*)/i,Jm=function(){function e(t){y(this,e),this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.parse(t)}return k(e,[{key:"isRoom",get:function(){return 0<this.roomId.length}},{key:"hasPassword",get:function(){return 0<this.password.length+this.digestPassword.length}},{key:"parse",value:function(e){try{this.peerId=e;var t=Qm.exec(e);if(null!=t)return this.digestUserId=t[1],this.roomId=t[2],this.roomName=Km.decompress(t[3]),void(this.digestPassword=t[4])}catch(n){console.warn(n)}this.digestUserId=e}},{key:"verifyPassword",value:function(e){return ev(this.roomId,e)===this.digestPassword}}],[{key:"parse",value:function(t){return new e(t)}},{key:"create",value:function(){for(var t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];return n.length<=1?e._create.apply(this,n):e._createRoom.apply(this,n)}},{key:"_create",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=function(e){return null==e?"":tv(e)}(t),i=new e(n);return i.userId=t,i}},{key:"_createRoom",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=this.generateId("******"),o=ev(n,r),s="".concat(a).concat(n).concat(Km.compress(i),"-").concat(o),l=new e(s);return l.userId=t,l.password=r,l}},{key:"generateId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"********",t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";return e.replace(/\*/g,function(e){return t[Math.floor(Math.random()*t.length)]})}}]),e}();function ev(e,t){return null==e||null==t?"":0<t.length?tv(e+t,7):""}function tv(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(null==e)return"";var n=Um(e),i=new Uint8Array(Uint32Array.from(n.words).buffer),r=$m.encode(i);return t<0&&(t=r.length),r.length<t&&(t=r.length),r=r.slice(0,t)}var nv=p("HlZf");function iv(e){for(var t=e.length;--t>=0;)e[t]=0}var rv=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),av=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ov=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),sv=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lv=new Array(576);iv(lv);var cv=new Array(60);iv(cv);var uv=new Array(512);iv(uv);var hv=new Array(256);iv(hv);var dv=new Array(29);iv(dv);var fv,pv,gv,mv=new Array(30);function vv(e,t,n,i,r){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=i,this.max_length=r,this.has_stree=e&&e.length}function yv(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}iv(mv);var bv=function(e){return e<256?uv[e]:uv[256+(e>>>7)]},kv=function(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255},_v=function(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,kv(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)},wv=function(e,t,n){_v(e,n[2*t],n[2*t+1])},xv=function(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1},Cv=function(e,t,n){var i,r,a=new Array(16),o=0;for(i=1;i<=15;i++)a[i]=o=o+n[i-1]<<1;for(r=0;r<=t;r++){var s=e[2*r+1];0!==s&&(e[2*r]=xv(a[s]++,s))}},Ev=function(e){var t;for(t=0;t<286;t++)e.dyn_ltree[2*t]=0;for(t=0;t<30;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0},Sv=function(e){e.bi_valid>8?kv(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Tv=function(e,t,n,i){var r=2*t,a=2*n;return e[r]<e[a]||e[r]===e[a]&&i[t]<=i[n]},Ov=function(e,t,n){for(var i=e.heap[n],r=n<<1;r<=e.heap_len&&(r<e.heap_len&&Tv(t,e.heap[r+1],e.heap[r],e.depth)&&r++,!Tv(t,i,e.heap[r],e.depth));)e.heap[n]=e.heap[r],n=r,r<<=1;e.heap[n]=i},Iv=function(e,t,n){var i,r,a,o,s=0;if(0!==e.last_lit)do{i=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],r=e.pending_buf[e.l_buf+s],s++,0===i?wv(e,r,t):(a=hv[r],wv(e,a+256+1,t),0!==(o=rv[a])&&(r-=dv[a],_v(e,r,o)),i--,a=bv(i),wv(e,a,n),0!==(o=av[a])&&(i-=mv[a],_v(e,i,o)))}while(s<e.last_lit);wv(e,256,t)},Mv=function(e,t){var n,i,r,a=t.dyn_tree,o=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==a[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):a[2*n+1]=0;for(;e.heap_len<2;)a[2*(r=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[r]=0,e.opt_len--,s&&(e.static_len-=o[2*r+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)Ov(e,a,n);r=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],Ov(e,a,1),i=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=i,a[2*r]=a[2*n]+a[2*i],e.depth[r]=(e.depth[n]>=e.depth[i]?e.depth[n]:e.depth[i])+1,a[2*n+1]=a[2*i+1]=r,e.heap[1]=r++,Ov(e,a,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,i,r,a,o,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,h=t.stat_desc.has_stree,d=t.stat_desc.extra_bits,f=t.stat_desc.extra_base,p=t.stat_desc.max_length,g=0;for(a=0;a<=15;a++)e.bl_count[a]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(a=l[2*l[2*(i=e.heap[n])+1]+1]+1)>p&&(a=p,g++),l[2*i+1]=a,i>c||(e.bl_count[a]++,o=0,i>=f&&(o=d[i-f]),s=l[2*i],e.opt_len+=s*(a+o),h&&(e.static_len+=s*(u[2*i+1]+o)));if(0!==g){do{for(a=p-1;0===e.bl_count[a];)a--;e.bl_count[a]--,e.bl_count[a+1]+=2,e.bl_count[p]--,g-=2}while(g>0);for(a=p;0!==a;a--)for(i=e.bl_count[a];0!==i;)(r=e.heap[--n])>c||(l[2*r+1]!==a&&(e.opt_len+=(a-l[2*r+1])*l[2*r],l[2*r+1]=a),i--)}}(e,t),Cv(a,c,e.bl_count)},Av=function(e,t,n){var i,r,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(n+1)+1]=65535,i=0;i<=n;i++)r=o,o=t[2*(i+1)+1],++s<l&&r===o||(s<c?e.bl_tree[2*r]+=s:0!==r?(r!==a&&e.bl_tree[2*r]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,a=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4))},Pv=function(e,t,n){var i,r,a=-1,o=t[1],s=0,l=7,c=4;for(0===o&&(l=138,c=3),i=0;i<=n;i++)if(r=o,o=t[2*(i+1)+1],!(++s<l&&r===o)){if(s<c)do{wv(e,r,e.bl_tree)}while(0!=--s);else 0!==r?(r!==a&&(wv(e,r,e.bl_tree),s--),wv(e,16,e.bl_tree),_v(e,s-3,2)):s<=10?(wv(e,17,e.bl_tree),_v(e,s-3,3)):(wv(e,18,e.bl_tree),_v(e,s-11,7));s=0,a=r,0===o?(l=138,c=3):r===o?(l=6,c=3):(l=7,c=4)}},Dv=!1,Rv=function(e,t,n,i){_v(e,0+(i?1:0),3),function(e,t,n,i){Sv(e),kv(e,n),kv(e,~n),e.pending_buf.set(e.window.subarray(t,t+n),e.pending),e.pending+=n}(e,t,n)},Fv=function(e){Dv||(function(){var e,t,n,i,r,a=new Array(16);for(n=0,i=0;i<28;i++)for(dv[i]=n,e=0;e<1<<rv[i];e++)hv[n++]=i;for(hv[n-1]=i,r=0,i=0;i<16;i++)for(mv[i]=r,e=0;e<1<<av[i];e++)uv[r++]=i;for(r>>=7;i<30;i++)for(mv[i]=r<<7,e=0;e<1<<av[i]-7;e++)uv[256+r++]=i;for(t=0;t<=15;t++)a[t]=0;for(e=0;e<=143;)lv[2*e+1]=8,e++,a[8]++;for(;e<=255;)lv[2*e+1]=9,e++,a[9]++;for(;e<=279;)lv[2*e+1]=7,e++,a[7]++;for(;e<=287;)lv[2*e+1]=8,e++,a[8]++;for(Cv(lv,287,a),e=0;e<30;e++)cv[2*e+1]=5,cv[2*e]=xv(e,5);fv=new vv(lv,rv,257,286,15),pv=new vv(cv,av,0,30,15),gv=new vv(new Array(0),ov,0,19,7)}(),Dv=!0),e.l_desc=new yv(e.dyn_ltree,fv),e.d_desc=new yv(e.dyn_dtree,pv),e.bl_desc=new yv(e.bl_tree,gv),e.bi_buf=0,e.bi_valid=0,Ev(e)},Nv=Rv,zv=function(e,t,n,i){var r,a,o=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<256;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Mv(e,e.l_desc),Mv(e,e.d_desc),o=function(e){var t;for(Av(e,e.dyn_ltree,e.l_desc.max_code),Av(e,e.dyn_dtree,e.d_desc.max_code),Mv(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*sv[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),r=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=r&&(r=a)):r=a=n+5,n+4<=r&&-1!==t?Rv(e,t,n,i):4===e.strategy||a===r?(_v(e,2+(i?1:0),3),Iv(e,lv,cv)):(_v(e,4+(i?1:0),3),function(e,t,n,i){var r;for(_v(e,t-257,5),_v(e,n-1,5),_v(e,i-4,4),r=0;r<i;r++)_v(e,e.bl_tree[2*sv[r]+1],3);Pv(e,e.dyn_ltree,t-1),Pv(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),Iv(e,e.dyn_ltree,e.dyn_dtree)),Ev(e),i&&Sv(e)},Lv=function(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(hv[n]+256+1)]++,e.dyn_dtree[2*bv(t)]++),e.last_lit===e.lit_bufsize-1},Bv=function(e){_v(e,2,3),wv(e,256,lv),function(e){16===e.bi_valid?(kv(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}(e)},jv=function(e,t,n,i){for(var r=65535&e|0,a=e>>>16&65535|0,o=0;0!==n;){n-=o=n>2e3?2e3:n;do{a=a+(r=r+t[i++]|0)|0}while(--o);r%=65521,a%=65521}return r|a<<16|0},Uv=new Uint32Array(function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}()),Hv=function(e,t,n,i){var r=Uv,a=i+n;e^=-1;for(var o=i;o<a;o++)e=e>>>8^r[255&(e^t[o])];return-1^e},Vv={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Wv={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Gv=Fv,Zv=Nv,Yv=zv,qv=Lv,Xv=Bv,Kv=Wv.Z_NO_FLUSH,$v=Wv.Z_PARTIAL_FLUSH,Qv=Wv.Z_FULL_FLUSH,Jv=Wv.Z_FINISH,ey=Wv.Z_BLOCK,ty=Wv.Z_OK,ny=Wv.Z_STREAM_END,iy=Wv.Z_STREAM_ERROR,ry=Wv.Z_DATA_ERROR,ay=Wv.Z_BUF_ERROR,oy=Wv.Z_DEFAULT_COMPRESSION,sy=Wv.Z_FILTERED,ly=Wv.Z_HUFFMAN_ONLY,cy=Wv.Z_RLE,uy=Wv.Z_FIXED,hy=Wv.Z_UNKNOWN,dy=Wv.Z_DEFLATED,fy=function(e,t){return e.msg=Vv[t],t},py=function(e){return(e<<1)-(e>4?9:0)},gy=function(e){for(var t=e.length;--t>=0;)e[t]=0},my=function(e,t,n){return(t<<e.hash_shift^n)&e.hash_mask},vy=function(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+n),e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))},yy=function(e,t){Yv(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,vy(e.strm)},by=function(e,t){e.pending_buf[e.pending++]=t},ky=function(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t},_y=function(e,t){var n,i,r=e.max_chain_length,a=e.strstart,o=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-262?e.strstart-(e.w_size-262):0,c=e.window,u=e.w_mask,h=e.prev,d=e.strstart+258,f=c[a+o-1],p=c[a+o];e.prev_length>=e.good_match&&(r>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+o]===p&&c[n+o-1]===f&&c[n]===c[a]&&c[++n]===c[a+1]){a+=2,n++;do{}while(c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&c[++a]===c[++n]&&a<d);if(i=258-(d-a),a=d-258,i>o){if(e.match_start=t,o=i,i>=s)break;f=c[a+o-1],p=c[a+o]}}}while((t=h[t&u])>l&&0!=--r);return o<=e.lookahead?o:e.lookahead},wy=function(e){var t,n,i,r,a,o,s,l,c,u,h=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=h+(h-262)){e.window.set(e.window.subarray(h,h+h),0),e.match_start-=h,e.strstart-=h,e.block_start-=h,t=n=e.hash_size;do{i=e.head[--t],e.head[t]=i>=h?i-h:0}while(--n);t=n=h;do{i=e.prev[--t],e.prev[t]=i>=h?i-h:0}while(--n);r+=h}if(0===e.strm.avail_in)break;if(o=e.strm,s=e.window,l=e.strstart+e.lookahead,c=r,u=void 0,(u=o.avail_in)>c&&(u=c),n=0===u?0:(o.avail_in-=u,s.set(o.input.subarray(o.next_in,o.next_in+u),l),1===o.state.wrap?o.adler=jv(o.adler,s,u,l):2===o.state.wrap&&(o.adler=Hv(o.adler,s,u,l)),o.next_in+=u,o.total_in+=u,u),e.lookahead+=n,e.lookahead+e.insert>=3)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=my(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=my(e,e.ins_h,e.window[a+3-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<262&&0!==e.strm.avail_in)},xy=function(e,t){for(var n,i;;){if(e.lookahead<262){if(wy(e),e.lookahead<262&&t===Kv)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=my(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-262&&(e.match_length=_y(e,n)),e.match_length>=3)if(i=qv(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=my(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=my(e,e.ins_h,e.window[e.strstart+1]);else i=qv(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(yy(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,t===Jv?(yy(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yy(e,!1),0===e.strm.avail_out)?1:2},Cy=function(e,t){for(var n,i,r;;){if(e.lookahead<262){if(wy(e),e.lookahead<262&&t===Kv)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=my(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-262&&(e.match_length=_y(e,n),e.match_length<=5&&(e.strategy===sy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){r=e.strstart+e.lookahead-3,i=qv(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=r&&(e.ins_h=my(e,e.ins_h,e.window[e.strstart+3-1]),n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,i&&(yy(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((i=qv(e,0,e.window[e.strstart-1]))&&yy(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=qv(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,t===Jv?(yy(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yy(e,!1),0===e.strm.avail_out)?1:2};function Ey(e,t,n,i,r){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=i,this.func=r}var Sy=[new Ey(0,0,0,0,function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(wy(e),0===e.lookahead&&t===Kv)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+n;if((0===e.strstart||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,yy(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-262&&(yy(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Jv?(yy(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&yy(e,!1),1)}),new Ey(4,4,8,4,xy),new Ey(4,5,16,8,xy),new Ey(4,6,32,32,xy),new Ey(4,4,16,16,Cy),new Ey(8,16,32,32,Cy),new Ey(8,16,128,128,Cy),new Ey(8,32,128,256,Cy),new Ey(32,128,258,1024,Cy),new Ey(32,258,258,4096,Cy)];function Ty(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=dy,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),gy(this.dyn_ltree),gy(this.dyn_dtree),gy(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),gy(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),gy(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}var Oy=function(e,t,n,i,r,a){if(!e)return iy;var o=1;if(t===oy&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||n!==dy||i<8||i>15||t<0||t>9||a<0||a>uy)return fy(e,iy);8===i&&(i=9);var s=new Ty;return e.state=s,s.strm=e,s.wrap=o,s.gzhead=null,s.w_bits=i,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=r+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Uint8Array(2*s.w_size),s.head=new Uint16Array(s.hash_size),s.prev=new Uint16Array(s.w_size),s.lit_bufsize=1<<r+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Uint8Array(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=a,s.method=n,function(e){var t,n=function(e){if(!e||!e.state)return fy(e,iy);e.total_in=e.total_out=0,e.data_type=hy;var t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?42:113,e.adler=2===t.wrap?0:1,t.last_flush=Kv,Gv(t),ty}(e);return n===ty&&((t=e.state).window_size=2*t.w_size,gy(t.head),t.max_lazy_match=Sy[t.level].max_lazy,t.good_match=Sy[t.level].good_length,t.nice_match=Sy[t.level].nice_length,t.max_chain_length=Sy[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),n}(e)},Iy=function(e,t){var n,i;if(!e||!e.state||t>ey||t<0)return e?fy(e,iy):iy;var r=e.state;if(!e.output||!e.input&&0!==e.avail_in||666===r.status&&t!==Jv)return fy(e,0===e.avail_out?ay:iy);r.strm=e;var a=r.last_flush;if(r.last_flush=t,42===r.status)if(2===r.wrap)e.adler=0,by(r,31),by(r,139),by(r,8),r.gzhead?(by(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),by(r,255&r.gzhead.time),by(r,r.gzhead.time>>8&255),by(r,r.gzhead.time>>16&255),by(r,r.gzhead.time>>24&255),by(r,9===r.level?2:r.strategy>=ly||r.level<2?4:0),by(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(by(r,255&r.gzhead.extra.length),by(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Hv(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(by(r,0),by(r,0),by(r,0),by(r,0),by(r,0),by(r,9===r.level?2:r.strategy>=ly||r.level<2?4:0),by(r,3),r.status=113);else{var o=dy+(r.w_bits-8<<4)<<8;o|=(r.strategy>=ly||r.level<2?0:r.level<6?1:6===r.level?2:3)<<6,0!==r.strstart&&(o|=32),o+=31-o%31,r.status=113,ky(r,o),0!==r.strstart&&(ky(r,e.adler>>>16),ky(r,65535&e.adler)),e.adler=1}if(69===r.status)if(r.gzhead.extra){for(n=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>n&&(e.adler=Hv(e.adler,r.pending_buf,r.pending-n,n)),vy(e),n=r.pending,r.pending!==r.pending_buf_size));)by(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>n&&(e.adler=Hv(e.adler,r.pending_buf,r.pending-n,n)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=Hv(e.adler,r.pending_buf,r.pending-n,n)),vy(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,by(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>n&&(e.adler=Hv(e.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){n=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>n&&(e.adler=Hv(e.adler,r.pending_buf,r.pending-n,n)),vy(e),n=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,by(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>n&&(e.adler=Hv(e.adler,r.pending_buf,r.pending-n,n)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&vy(e),r.pending+2<=r.pending_buf_size&&(by(r,255&e.adler),by(r,e.adler>>8&255),e.adler=0,r.status=113)):r.status=113),0!==r.pending){if(vy(e),0===e.avail_out)return r.last_flush=-1,ty}else if(0===e.avail_in&&py(t)<=py(a)&&t!==Jv)return fy(e,ay);if(666===r.status&&0!==e.avail_in)return fy(e,ay);if(0!==e.avail_in||0!==r.lookahead||t!==Kv&&666!==r.status){var s=r.strategy===ly?function(e,t){for(var n;;){if(0===e.lookahead&&(wy(e),0===e.lookahead)){if(t===Kv)return 1;break}if(e.match_length=0,n=qv(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(yy(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Jv?(yy(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yy(e,!1),0===e.strm.avail_out)?1:2}(r,t):r.strategy===cy?function(e,t){for(var n,i,r,a,o=e.window;;){if(e.lookahead<=258){if(wy(e),e.lookahead<=258&&t===Kv)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&((i=o[r=e.strstart-1])===o[++r]&&i===o[++r]&&i===o[++r])){a=e.strstart+258;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<a);e.match_length=258-(a-r),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=qv(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=qv(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(yy(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,t===Jv?(yy(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(yy(e,!1),0===e.strm.avail_out)?1:2}(r,t):Sy[r.level].func(r,t);if(3!==s&&4!==s||(r.status=666),1===s||3===s)return 0===e.avail_out&&(r.last_flush=-1),ty;if(2===s&&(t===$v?Xv(r):t!==ey&&(Zv(r,0,0,!1),t===Qv&&(gy(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),vy(e),0===e.avail_out))return r.last_flush=-1,ty}return t!==Jv?ty:r.wrap<=0?ny:(2===r.wrap?(by(r,255&e.adler),by(r,e.adler>>8&255),by(r,e.adler>>16&255),by(r,e.adler>>24&255),by(r,255&e.total_in),by(r,e.total_in>>8&255),by(r,e.total_in>>16&255),by(r,e.total_in>>24&255)):(ky(r,e.adler>>>16),ky(r,65535&e.adler)),vy(e),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?ty:ny)},My=function(e){if(!e||!e.state)return iy;var t=e.state.status;return 42!==t&&69!==t&&73!==t&&91!==t&&103!==t&&113!==t&&666!==t?fy(e,iy):(e.state=null,113===t?fy(e,ry):ty)},Ay=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},Py=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var n=t.shift();if(n){if("object"!=typeof n)throw new TypeError(n+"must be non-object");for(var i in n)Ay(n,i)&&(e[i]=n[i])}}return e},Dy=function(e){for(var t=0,n=0,i=e.length;n<i;n++)t+=e[n].length;for(var r=new Uint8Array(t),a=0,o=0,s=e.length;a<s;a++){var l=e[a];r.set(l,o),o+=l.length}return r},Ry=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(iL){Ry=!1}for(var Fy=new Uint8Array(256),Ny=0;Ny<256;Ny++)Fy[Ny]=Ny>=252?6:Ny>=248?5:Ny>=240?4:Ny>=224?3:Ny>=192?2:1;Fy[254]=Fy[254]=1;var zy=function(e){var t,n,i,r,a,o=e.length,s=0;for(r=0;r<o;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<o&&(56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++)),s+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(s),a=0,r=0;a<s;r++)55296==(64512&(n=e.charCodeAt(r)))&&r+1<o&&(56320==(64512&(i=e.charCodeAt(r+1)))&&(n=65536+(n-55296<<10)+(i-56320),r++)),n<128?t[a++]=n:n<2048?(t[a++]=192|n>>>6,t[a++]=128|63&n):n<65536?(t[a++]=224|n>>>12,t[a++]=128|n>>>6&63,t[a++]=128|63&n):(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63,t[a++]=128|n>>>6&63,t[a++]=128|63&n);return t},Ly=function(e,t){var n,i,r=t||e.length,a=new Array(2*r);for(i=0,n=0;n<r;){var o=e[n++];if(o<128)a[i++]=o;else{var s=Fy[o];if(s>4)a[i++]=65533,n+=s-1;else{for(o&=2===s?31:3===s?15:7;s>1&&n<r;)o=o<<6|63&e[n++],s--;s>1?a[i++]=65533:o<65536?a[i++]=o:(o-=65536,a[i++]=55296|o>>10&1023,a[i++]=56320|1023&o)}}}return function(e,t){if(t<65534&&e.subarray&&Ry)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));for(var n="",i=0;i<t;i++)n+=String.fromCharCode(e[i]);return n}(a,i)},By=function(e,t){(t=t||e.length)>e.length&&(t=e.length);for(var n=t-1;n>=0&&128==(192&e[n]);)n--;return n<0||0===n?t:n+Fy[e[n]]>t?n:t},jy=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0},Uy=Object.prototype.toString,Hy=Wv.Z_NO_FLUSH,Vy=Wv.Z_SYNC_FLUSH,Wy=Wv.Z_FULL_FLUSH,Gy=Wv.Z_FINISH,Zy=Wv.Z_OK,Yy=Wv.Z_STREAM_END,qy=Wv.Z_DEFAULT_COMPRESSION,Xy=Wv.Z_DEFAULT_STRATEGY,Ky=Wv.Z_DEFLATED;function $y(e){this.options=Py({level:qy,method:Ky,chunkSize:16384,windowBits:15,memLevel:8,strategy:Xy},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jy,this.strm.avail_out=0;var n,i,r=Oy(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Zy)throw new Error(Vv[r]);if(t.header&&(i=t.header,(n=this.strm)&&n.state&&(2!==n.state.wrap||(n.state.gzhead=i))),t.dictionary){var a;if(a="string"==typeof t.dictionary?zy(t.dictionary):"[object ArrayBuffer]"===Uy.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(r=function(e,t){var n=t.length;if(!e||!e.state)return iy;var i=e.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return iy;if(1===r&&(e.adler=jv(e.adler,t,n,0)),i.wrap=0,n>=i.w_size){0===r&&(gy(i.head),i.strstart=0,i.block_start=0,i.insert=0);var a=new Uint8Array(i.w_size);a.set(t.subarray(n-i.w_size,n),0),t=a,n=i.w_size}var o=e.avail_in,s=e.next_in,l=e.input;for(e.avail_in=n,e.next_in=0,e.input=t,wy(i);i.lookahead>=3;){var c=i.strstart,u=i.lookahead-2;do{i.ins_h=my(i,i.ins_h,i.window[c+3-1]),i.prev[c&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=c,c++}while(--u);i.strstart=c,i.lookahead=2,wy(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,e.next_in=s,e.input=l,e.avail_in=o,i.wrap=r,ty}(this.strm,a))!==Zy)throw new Error(Vv[r]);this._dict_set=!0}}$y.prototype.push=function(e,t){var n,i,r=this.strm,a=this.options.chunkSize;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Gy:Hy,r.input="string"==typeof e?zy(e):"[object ArrayBuffer]"===Uy.call(e)?new Uint8Array(e):e,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(a),r.next_out=0,r.avail_out=a),(i===Vy||i===Wy)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if((n=Iy(r,i))===Yy)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=My(this.strm),this.onEnd(n),this.ended=!0,n===Zy;if(0!==r.avail_out){if(i>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},$y.prototype.onData=function(e){this.chunks.push(e)},$y.prototype.onEnd=function(e){e===Zy&&(this.result=Dy(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Qy=$y,Jy=function(e,t){var n,i,r,a,o,s,l,c,u,h,d,f,p,g,m,v,y,b,k,_,w,x,C,E,S=e.state;n=e.next_in,C=e.input,i=n+(e.avail_in-5),r=e.next_out,E=e.output,a=r-(t-e.avail_out),o=r+(e.avail_out-257),s=S.dmax,l=S.wsize,c=S.whave,u=S.wnext,h=S.window,d=S.hold,f=S.bits,p=S.lencode,g=S.distcode,m=(1<<S.lenbits)-1,v=(1<<S.distbits)-1;e:do{f<15&&(d+=C[n++]<<f,f+=8,d+=C[n++]<<f,f+=8),y=p[d&m];t:for(;;){if(d>>>=b=y>>>24,f-=b,0===(b=y>>>16&255))E[r++]=65535&y;else{if(!(16&b)){if(0==(64&b)){y=p[(65535&y)+(d&(1<<b)-1)];continue t}if(32&b){S.mode=12;break e}e.msg="invalid literal/length code",S.mode=30;break e}k=65535&y,(b&=15)&&(f<b&&(d+=C[n++]<<f,f+=8),k+=d&(1<<b)-1,d>>>=b,f-=b),f<15&&(d+=C[n++]<<f,f+=8,d+=C[n++]<<f,f+=8),y=g[d&v];n:for(;;){if(d>>>=b=y>>>24,f-=b,!(16&(b=y>>>16&255))){if(0==(64&b)){y=g[(65535&y)+(d&(1<<b)-1)];continue n}e.msg="invalid distance code",S.mode=30;break e}if(_=65535&y,f<(b&=15)&&(d+=C[n++]<<f,(f+=8)<b&&(d+=C[n++]<<f,f+=8)),(_+=d&(1<<b)-1)>s){e.msg="invalid distance too far back",S.mode=30;break e}if(d>>>=b,f-=b,_>(b=r-a)){if((b=_-b)>c&&S.sane){e.msg="invalid distance too far back",S.mode=30;break e}if(w=0,x=h,0===u){if(w+=l-b,b<k){k-=b;do{E[r++]=h[w++]}while(--b);w=r-_,x=E}}else if(u<b){if(w+=l+u-b,(b-=u)<k){k-=b;do{E[r++]=h[w++]}while(--b);if(w=0,u<k){k-=b=u;do{E[r++]=h[w++]}while(--b);w=r-_,x=E}}}else if(w+=u-b,b<k){k-=b;do{E[r++]=h[w++]}while(--b);w=r-_,x=E}for(;k>2;)E[r++]=x[w++],E[r++]=x[w++],E[r++]=x[w++],k-=3;k&&(E[r++]=x[w++],k>1&&(E[r++]=x[w++]))}else{w=r-_;do{E[r++]=E[w++],E[r++]=E[w++],E[r++]=E[w++],k-=3}while(k>2);k&&(E[r++]=E[w++],k>1&&(E[r++]=E[w++]))}break}}break}}while(n<i&&r<o);n-=k=f>>3,d&=(1<<(f-=k<<3))-1,e.next_in=n,e.next_out=r,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=r<o?o-r+257:257-(r-o),S.hold=d,S.bits=f},eb=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),tb=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),nb=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),ib=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),rb=function(e,t,n,i,r,a,o,s){var l,c,u,h,d,f,p,g,m,v=s.bits,y=0,b=0,k=0,_=0,w=0,x=0,C=0,E=0,S=0,T=0,O=null,I=0,M=new Uint16Array(16),A=new Uint16Array(16),P=null,D=0;for(y=0;y<=15;y++)M[y]=0;for(b=0;b<i;b++)M[t[n+b]]++;for(w=v,_=15;_>=1&&0===M[_];_--);if(w>_&&(w=_),0===_)return r[a++]=20971520,r[a++]=20971520,s.bits=1,0;for(k=1;k<_&&0===M[k];k++);for(w<k&&(w=k),E=1,y=1;y<=15;y++)if(E<<=1,(E-=M[y])<0)return-1;if(E>0&&(0===e||1!==_))return-1;for(A[1]=0,y=1;y<15;y++)A[y+1]=A[y]+M[y];for(b=0;b<i;b++)0!==t[n+b]&&(o[A[t[n+b]]++]=b);if(0===e?(O=P=o,f=19):1===e?(O=eb,I-=257,P=tb,D-=257,f=256):(O=nb,P=ib,f=-1),T=0,b=0,y=k,d=a,x=w,C=0,u=-1,h=(S=1<<w)-1,1===e&&S>852||2===e&&S>592)return 1;for(;;){p=y-C,o[b]<f?(g=0,m=o[b]):o[b]>f?(g=P[D+o[b]],m=O[I+o[b]]):(g=96,m=0),l=1<<y-C,k=c=1<<x;do{r[d+(T>>C)+(c-=l)]=p<<24|g<<16|m|0}while(0!==c);for(l=1<<y-1;T&l;)l>>=1;if(0!==l?(T&=l-1,T+=l):T=0,b++,0==--M[y]){if(y===_)break;y=t[n+o[b]]}if(y>w&&(T&h)!==u){for(0===C&&(C=w),d+=k,E=1<<(x=y-C);x+C<_&&!((E-=M[x+C])<=0);)x++,E<<=1;if(S+=1<<x,1===e&&S>852||2===e&&S>592)return 1;r[u=T&h]=w<<24|x<<16|d-a|0}}return 0!==T&&(r[d+T]=y-C<<24|64<<16|0),s.bits=w,0},ab=Wv.Z_FINISH,ob=Wv.Z_BLOCK,sb=Wv.Z_TREES,lb=Wv.Z_OK,cb=Wv.Z_STREAM_END,ub=Wv.Z_NEED_DICT,hb=Wv.Z_STREAM_ERROR,db=Wv.Z_DATA_ERROR,fb=Wv.Z_MEM_ERROR,pb=Wv.Z_BUF_ERROR,gb=Wv.Z_DEFLATED,mb=function(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)};function vb(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}var yb,bb,kb=function(e){if(!e||!e.state)return hb;var t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,function(e){if(!e||!e.state)return hb;var t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(852),t.distcode=t.distdyn=new Int32Array(592),t.sane=1,t.back=-1,lb}(e)},_b=!0,wb=function(e){if(_b){yb=new Int32Array(512),bb=new Int32Array(32);for(var t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(rb(1,e.lens,0,288,yb,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;rb(2,e.lens,0,32,bb,0,e.work,{bits:5}),_b=!1}e.lencode=yb,e.lenbits=9,e.distcode=bb,e.distbits=5},xb=function(e,t,n,i){var r,a=e.state;return null===a.window&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),i>=a.wsize?(a.window.set(t.subarray(n-a.wsize,n),0),a.wnext=0,a.whave=a.wsize):((r=a.wsize-a.wnext)>i&&(r=i),a.window.set(t.subarray(n-i,n-i+r),a.wnext),(i-=r)?(a.window.set(t.subarray(n-i,n),0),a.wnext=i,a.whave=a.wsize):(a.wnext+=r,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=r))),0},Cb=kb,Eb=function(e,t){var n,i,r,a,o,s,l,c,u,h,d,f,p,g,m,v,y,b,k,_,w,x,C,E,S=0,T=new Uint8Array(4),O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return hb;12===(n=e.state).mode&&(n.mode=13),o=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,i=e.input,s=e.avail_in,c=n.hold,u=n.bits,h=s,d=l,x=lb;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(2&n.wrap&&35615===c){n.check=0,T[0]=255&c,T[1]=c>>>8&255,n.check=Hv(n.check,T,2,0),c=0,u=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=30;break}if((15&c)!==gb){e.msg="unknown compression method",n.mode=30;break}if(u-=4,w=8+(15&(c>>>=4)),0===n.wbits)n.wbits=w;else if(w>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<n.wbits,e.adler=n.check=1,n.mode=512&c?10:12,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(n.flags=c,(255&n.flags)!==gb){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(T[0]=255&c,T[1]=c>>>8&255,n.check=Hv(n.check,T,2,0)),c=0,u=0,n.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&(T[0]=255&c,T[1]=c>>>8&255,T[2]=c>>>16&255,T[3]=c>>>24&255,n.check=Hv(n.check,T,4,0)),c=0,u=0,n.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(T[0]=255&c,T[1]=c>>>8&255,n.check=Hv(n.check,T,2,0)),c=0,u=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(T[0]=255&c,T[1]=c>>>8&255,n.check=Hv(n.check,T,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((f=n.length)>s&&(f=s),f&&(n.head&&(w=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(i.subarray(a,a+f),w)),512&n.flags&&(n.check=Hv(n.check,i,f,a)),s-=f,a+=f,n.length-=f),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break e;f=0;do{w=i[a+f++],n.head&&w&&n.length<65536&&(n.head.name+=String.fromCharCode(w))}while(w&&f<s);if(512&n.flags&&(n.check=Hv(n.check,i,f,a)),s-=f,a+=f,w)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break e;f=0;do{w=i[a+f++],n.head&&w&&n.length<65536&&(n.head.comment+=String.fromCharCode(w))}while(w&&f<s);if(512&n.flags&&(n.check=Hv(n.check,i,f,a)),s-=f,a+=f,w)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}e.adler=n.check=mb(c),c=0,u=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=o,e.avail_out=l,e.next_in=a,e.avail_in=s,n.hold=c,n.bits=u,ub;e.adler=n.check=1,n.mode=12;case 12:if(t===ob||t===sb)break e;case 13:if(n.last){c>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}switch(n.last=1&c,u-=1,3&(c>>>=1)){case 0:n.mode=14;break;case 1:if(wb(n),n.mode=20,t===sb){c>>>=2,u-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&c,c=0,u=0,n.mode=15,t===sb)break e;case 15:n.mode=16;case 16:if(f=n.length){if(f>s&&(f=s),f>l&&(f=l),0===f)break e;r.set(i.subarray(a,a+f),o),s-=f,a+=f,l-=f,o+=f,n.length-=f;break}n.mode=12;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}n.lens[O[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},x=rb(0,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,x){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(S=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,y=65535&S,!((m=S>>>24)<=u);){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(y<16)c>>>=m,u-=m,n.lens[n.have++]=y;else{if(16===y){for(E=m+2;u<E;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(c>>>=m,u-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}w=n.lens[n.have-1],f=3+(3&c),c>>>=2,u-=2}else if(17===y){for(E=m+3;u<E;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}u-=m,w=0,f=3+(7&(c>>>=m)),c>>>=3,u-=3}else{for(E=m+7;u<E;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}u-=m,w=0,f=11+(127&(c>>>=m)),c>>>=7,u-=7}if(n.have+f>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;f--;)n.lens[n.have++]=w}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,C={bits:n.lenbits},x=rb(1,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,x){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},x=rb(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,x){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,t===sb)break e;case 20:n.mode=21;case 21:if(s>=6&&l>=258){e.next_out=o,e.avail_out=l,e.next_in=a,e.avail_in=s,n.hold=c,n.bits=u,Jy(e,d),o=e.next_out,r=e.output,l=e.avail_out,a=e.next_in,i=e.input,s=e.avail_in,c=n.hold,u=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;v=(S=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,y=65535&S,!((m=S>>>24)<=u);){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(v&&0==(240&v)){for(b=m,k=v,_=y;v=(S=n.lencode[_+((c&(1<<b+k)-1)>>b)])>>>16&255,y=65535&S,!(b+(m=S>>>24)<=u);){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}c>>>=b,u-=b,n.back+=b}if(c>>>=m,u-=m,n.back+=m,n.length=y,0===v){n.mode=26;break}if(32&v){n.back=-1,n.mode=12;break}if(64&v){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(E=n.extra;u<E;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(S=n.distcode[c&(1<<n.distbits)-1])>>>16&255,y=65535&S,!((m=S>>>24)<=u);){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(0==(240&v)){for(b=m,k=v,_=y;v=(S=n.distcode[_+((c&(1<<b+k)-1)>>b)])>>>16&255,y=65535&S,!(b+(m=S>>>24)<=u);){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}c>>>=b,u-=b,n.back+=b}if(c>>>=m,u-=m,n.back+=m,64&v){e.msg="invalid distance code",n.mode=30;break}n.offset=y,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(E=n.extra;u<E;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break e;if(f=d-l,n.offset>f){if((f=n.offset-f)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}f>n.wnext?(f-=n.wnext,p=n.wsize-f):p=n.wnext-f,f>n.length&&(f=n.length),g=n.window}else g=r,p=o-n.offset,f=n.length;f>l&&(f=l),l-=f,n.length-=f;do{r[o++]=g[p++]}while(--f);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;r[o++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===s)break e;s--,c|=i[a++]<<u,u+=8}if(d-=l,e.total_out+=d,n.total+=d,d&&(e.adler=n.check=n.flags?Hv(n.check,r,d,o-d):jv(n.check,r,d,o-d)),d=l,(n.flags?c:mb(c))!==n.check){e.msg="incorrect data check",n.mode=30;break}c=0,u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,c+=i[a++]<<u,u+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}c=0,u=0}n.mode=29;case 29:x=cb;break e;case 30:x=db;break e;case 31:return fb;case 32:default:return hb}return e.next_out=o,e.avail_out=l,e.next_in=a,e.avail_in=s,n.hold=c,n.bits=u,(n.wsize||d!==e.avail_out&&n.mode<30&&(n.mode<27||t!==ab))&&xb(e,e.output,e.next_out,d-e.avail_out),h-=e.avail_in,d-=e.avail_out,e.total_in+=h,e.total_out+=d,n.total+=d,n.wrap&&d&&(e.adler=n.check=n.flags?Hv(n.check,r,d,e.next_out-d):jv(n.check,r,d,e.next_out-d)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0===h&&0===d||t===ab)&&x===lb&&(x=pb),x},Sb=function(e){if(!e||!e.state)return hb;var t=e.state;return t.window&&(t.window=null),e.state=null,lb},Tb=function(e,t){var n,i=t.length;return e&&e.state?0!==(n=e.state).wrap&&11!==n.mode?hb:11===n.mode&&jv(1,t,i,0)!==n.check?db:xb(e,t,i,i)?(n.mode=31,fb):(n.havedict=1,lb):hb},Ob=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1},Ib=Object.prototype.toString,Mb=Wv.Z_NO_FLUSH,Ab=Wv.Z_FINISH,Pb=Wv.Z_OK,Db=Wv.Z_STREAM_END,Rb=Wv.Z_NEED_DICT,Fb=Wv.Z_STREAM_ERROR,Nb=Wv.Z_DATA_ERROR,zb=Wv.Z_MEM_ERROR;function Lb(e){this.options=Py({chunkSize:65536,windowBits:15,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(t.windowBits>=0&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&0==(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new jy,this.strm.avail_out=0;var n=function(e,t){if(!e)return hb;var n=new vb;e.state=n,n.window=null;var i=function(e,t){var n;if(!e||!e.state)return hb;var i=e.state;return t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?hb:(null!==i.window&&i.wbits!==t&&(i.window=null),i.wrap=n,i.wbits=t,kb(e))}(e,t);return i!==lb&&(e.state=null),i}(this.strm,t.windowBits);if(n!==Pb)throw new Error(Vv[n]);if(this.header=new Ob,function(e,t){if(!e||!e.state)return hb;var n=e.state;0==(2&n.wrap)||(n.head=t,t.done=!1)}(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=zy(t.dictionary):"[object ArrayBuffer]"===Ib.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=Tb(this.strm,t.dictionary))!==Pb))throw new Error(Vv[n])}Lb.prototype.push=function(e,t){var n,i,r,a=this.strm,o=this.options.chunkSize,s=this.options.dictionary;if(this.ended)return!1;for(i=t===~~t?t:!0===t?Ab:Mb,a.input="[object ArrayBuffer]"===Ib.call(e)?new Uint8Array(e):e,a.next_in=0,a.avail_in=a.input.length;;){for(0===a.avail_out&&(a.output=new Uint8Array(o),a.next_out=0,a.avail_out=o),(n=Eb(a,i))===Rb&&s&&((n=Tb(a,s))===Pb?n=Eb(a,i):n===Nb&&(n=Rb));a.avail_in>0&&n===Db&&a.state.wrap>0&&0!==e[a.next_in];)Cb(a),n=Eb(a,i);switch(n){case Fb:case Nb:case Rb:case zb:return this.onEnd(n),this.ended=!0,!1}if(r=a.avail_out,a.next_out&&(0===a.avail_out||n===Db))if("string"===this.options.to){var l=By(a.output,a.next_out),c=a.next_out-l,u=Ly(a.output,l);a.next_out=c,a.avail_out=o-c,c&&a.output.set(a.output.subarray(l,l+c),0),this.onData(u)}else this.onData(a.output.length===a.next_out?a.output:a.output.subarray(0,a.next_out));if(n!==Pb||0!==r){if(n===Db)return n=Sb(this.strm),this.onEnd(n),this.ended=!0,!0;if(0===a.avail_in)break}}return!0},Lb.prototype.onData=function(e){this.chunks.push(e)},Lb.prototype.onEnd=function(e){e===Pb&&(this.result="string"===this.options.to?this.chunks.join(""):Dy(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};var Bb=Qy,jb=Lb;function Ub(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16384;return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,a,o;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:r=Math.ceil(t.byteLength/n),a=null,o=0;case 2:if(!(o<r)){i.next=10;break}return i.next=5,new Promise(function(e){return qm(e)});case 5:a=t.slice(o*n,(o+1)*n),e.push(a,r<=o+1);case 7:o++,i.next=2;break;case 10:if(!e.err){i.next=12;break}throw new Error("error: ".concat(e.err));case 12:return i.abrupt("return",e);case 13:case"end":return i.stop()}},i)}))}var Hb,Vb=p("+qE3");!function(e){for(var t=[],n=0;n<256;n++)t[n]=(n<16?"0":"")+n.toString(16);e.generateUuid=function(){var e=new Uint32Array(4);window.crypto.getRandomValues(e);var n=e[0],i=e[1],r=e[2],a=e[3];return t[255&n]+t[n>>8&255]+t[n>>16&255]+t[n>>24&255]+"-"+t[255&i]+t[i>>8&255]+"-"+t[i>>16&15|64]+t[i>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&a]+t[a>>8&255]+t[a>>16&255]+t[a>>24&255]}}(Hb||(Hb={}));var Wb=function(e){h(n,e);var t=f(n);function n(e){var i;return y(this,n),(i=t.call(this)).conn=e,i.chunkSize=15872,i.receivedMap=new Map,i.timeoutTimer=null,e.on("data",function(e){return i.onData(e)}),e.on("open",function(){i.clearTimeoutTimer(),function(e){e._dc&&e._sendBuffer&&(e._startSendLoop=Gb)}(e),i.emit("open")}),e.on("close",function(){i.clearTimeoutTimer(),i.emit("close")}),e.on("error",function(e){i.clearTimeoutTimer(),i.emit("error",e)}),i.setTimeoutTimer(),i}return k(n,[{key:"open",get:function(){return this.conn.open}},{key:"remoteId",get:function(){return this.conn.remoteId}},{key:"metadata",get:function(){return this.conn.metadata}},{key:"close",value:function(){this.clearTimeoutTimer(),this.conn.close()}},{key:"send",value:function(e){var t=nv.encode(e),n=Math.ceil(t.byteLength/this.chunkSize);if(n<=1)this.conn.send(t);else for(var i=Hb.generateUuid(),r=null,a=0;a<n;a++)r={id:i,data:t.slice(a*this.chunkSize,(a+1)*this.chunkSize),index:a,total:n},this.conn.send(nv.encode(r))}},{key:"onData",value:function(e){var t=nv.decode(new Uint8Array(e));if(null!=t.id){var n=this.receivedMap.get(t.id);if(!(null==n&&(n={id:t.id,chanks:new Array(t.total),length:0,byteLength:0},this.receivedMap.set(t.id,n)),null!=n.chanks[t.index]||(n.length++,n.byteLength+=t.data.byteLength,n.chanks[t.index]=t.data,n.length<t.total))){this.receivedMap.delete(t.id);var i,r=new Uint8Array(n.byteLength),o=0,s=a(n.chanks);try{for(s.s();!(i=s.n()).done;){var l=i.value;r.set(l,o),o+=l.byteLength}}catch(u){s.e(u)}finally{s.f()}var c=nv.decode(r);this.emit("data",c)}}else this.emit("data",t)}},{key:"setTimeoutTimer",value:function(){var e=this;this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(function(){console.warn("timeout ".concat(e.conn.remoteId)),e.timeoutTimer=null,e.emit("close")},15e3)}},{key:"clearTimeoutTimer",value:function(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}]),n}(Vb.EventEmitter);function Gb(){this.sendInterval||(this.sendInterval=qm(Zb.bind(this)))}function Zb(){var e=this._sendBuffer.shift();try{this._dc.send(e)}catch(t){this._sendBuffer.push(e)}this.sendInterval=0===this._sendBuffer.length?void 0:qm(Zb.bind(this))}var Yb,qb=function(){function e(){y(this,e),this._peerIds=[],this.peerContexts=[],this.callback=new Xm,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.queue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}return k(e,[{key:"peerId",get:function(){return this.peerContext?this.peerContext.peerId:"???"}},{key:"peerIds",get:function(){return this._peerIds}},{key:"open",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("open",t),this.peerContext=0===t.length?Jm.create(Jm.generateId()):1===t.length?Jm.create(t[0]):Jm.create(t[0],t[1],t[2],t[3]),this.openPeer()}},{key:"close",value:function(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=null}},{key:"connect",value:function(e){if(!this.shouldConnect(e))return!1;var t=new Wb(this.peer.connect(e,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(t),!0}},{key:"shouldConnect",value:function(e){return this.peerContext&&this.peer&&this.peerId?this.peerId===e?(console.log("connect() is Fail. "+e+" is me."),!1):this.findDataConnection(e)?(console.log("connect() is Fail. <"+e+"> is already connecting."),!1):!(!e||!e.length||e===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}},{key:"disconnect",value:function(e){var t=this.findDataConnection(e);return!!t&&(this.closeDataConnection(t),!0)}},{key:"disconnectAll",value:function(){console.log("<closeAllDataConnection()>");var e,t=a(this.connections.concat());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.closeDataConnection(n)}}catch(i){t.e(i)}finally{t.f()}}},{key:"send",value:function(e,t){var n=this;if(!(this.connections.length<1)){var i={data:nv.encode(e),ttl:1},r=i.data.byteLength;this.bandwidthUsage+=r,this.queue=this.queue.then(function(){return new Promise(function(e,a){qm(function(){return Lm(n,void 0,void 0,regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(1024<i.data.byteLength)){n.next=5;break}return n.next=3,function(e,t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new Bb({level:2,gzip:!0}),t.prev=1,t.next=4,Ub(n,e,void 0);case 4:return t.abrupt("return",n.result);case 7:t.prev=7,t.t0=t.catch(1),console.error(t.t0);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}},t,null,[[1,7]])}))}(i.data);case 3:(a=n.sent).byteLength<i.data.byteLength&&(i.data=a,i.isCompressed=!0);case 5:return n.abrupt("return",(t?this.sendUnicast(i,t):this.sendBroadcast(i),this.bandwidthUsage-=r,e()));case 6:case"end":return n.stop()}},n,this)}))})})})}}},{key:"sendUnicast",value:function(e,t){e.ttl=0;var n=this.findDataConnection(t);n&&n.open&&n.send(e)}},{key:"sendBroadcast",value:function(e){var t,n=a(this.connections);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.open&&i.send(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"setApiKey",value:function(e){this.key!==e&&console.log("Key Change"),this.key=e}},{key:"listAllPeers",value:function(){var e=this;return new Promise(function(t,n){if(!e.peer)return t([]);var i=performance.now();if(i<e.httpRequestInterval)return console.warn("httpRequestInterval... "+(e.httpRequestInterval-i)),void t(e.listAllPeersCache.concat());e.httpRequestInterval=i+6e3,e.peer.listAllPeers(function(n){e.listAllPeersCache=n.concat(),t(n)})})}},{key:"openPeer",value:function(){var e=this;this.peer&&(console.warn("It is already opened."),this.close());var t=new Peer(this.peerContext.peerId,{key:this.key});t.on("open",function(t){console.log("My peer ID is: "+t),e.peerContext&&e.peerContext.peerId===t||(e.peerContext=Jm.parse(t)),e.peerContext.isOpen=!0,console.log("My peer Context",e.peerContext),e.callback.onOpen&&e.callback.onOpen(e.peerId)}),t.on("connection",function(t){e.openDataConnection(new Wb(t))}),t.on("error",function(t){console.error("<"+e.peerId+"> "+t.type+" => "+t.message);var n=e.getSkyWayErrorMessage(t.type);switch(n+=": "+t.message,t.type){case"peer-unavailable":case"invalid-id":case"invalid-key":case"list-error":case"server-error":break;case"disconnected":case"socket-error":default:e.peerContext&&e.peerContext.isOpen&&e.callback.onClose&&e.callback.onClose(e.peerId)}e.callback.onError&&e.callback.onError(e.peerId,n)}),this.peer=t}},{key:"openDataConnection",value:function(e){var t=this;if(!1!==this.addDataConnection(e)){var n=this.connections.indexOf(e),i=null;0<=n&&(i=this.peerContexts[n]),this.maybeUnavailablePeerIds.add(e.remoteId),e.on("data",function(n){t.onData(e,n)}),e.on("open",function(){t.maybeUnavailablePeerIds.delete(e.remoteId),i&&(i.isOpen=!0),t.updatePeerList(),t.callback.onConnect&&t.callback.onConnect(e.remoteId)}),e.on("close",function(){t.closeDataConnection(e),t.callback.onDisconnect&&t.callback.onDisconnect(e.remoteId)}),e.on("error",function(n){t.closeDataConnection(e),t.callback.onError&&t.callback.onError(e.remoteId,n)})}}},{key:"closeDataConnection",value:function(e){e.close();var t=this.connections.indexOf(e);0<=t&&(console.log(e.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+t+" length:"+this.connections.length),this.connections.splice(t,1),this.peerContexts.splice(t,1)),this.relayingPeerIds.delete(e.remoteId),this.relayingPeerIds.forEach(function(t){var n=t.indexOf(e.remoteId);0<=n&&t.splice(n,1)}),console.log("<close()> Peer:"+e.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList()}},{key:"addDataConnection",value:function(e){var t=this.findDataConnection(e.remoteId);if(null!==t){if(console.log("add() is Fail. "+e.remoteId+" is already connecting."),t!==e){if(!(t.metadata.sendFrom<e.metadata.sendFrom))return this.closeDataConnection(t),this.addDataConnection(e),!0;this.closeDataConnection(e)}return!1}return this.connections.push(e),this.peerContexts.push(Jm.parse(e.remoteId)),console.log("<add()> Peer:"+e.remoteId+" length:"+this.connections.length),!0}},{key:"findDataConnection",value:function(e){var t,n=a(this.connections);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.remoteId===e)return i}}catch(r){n.e(r)}finally{n.f()}return null}},{key:"onData",value:function(e,t){var n=this;if(t.peers&&0<t.peers.length&&this.onUpdatePeerList(e,t),0<t.ttl&&this.onRelay(e,t),this.callback.onData){var i=t.data.byteLength;this.bandwidthUsage+=i,this.queue=this.queue.then(function(){return new Promise(function(r,a){qm(function(){return Lm(n,void 0,void 0,regeneratorRuntime.mark(function n(){var a;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.isCompressed){n.next=6;break}return n.next=3,function(e,t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=new jb,t.prev=1,t.next=4,Ub(n,e,void 0);case 4:return t.abrupt("return",n.result);case 7:t.prev=7,t.t0=t.catch(1),console.error(t.t0);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}},t,null,[[1,7]])}))}(t.data);case 3:n.t0=n.sent,n.next=7;break;case 6:n.t0=t.data;case 7:return a=n.t0,n.abrupt("return",(this.callback.onData(e.remoteId,nv.decode(a)),this.bandwidthUsage-=i,r()));case 9:case"end":return n.stop()}},n,this)}))})})})}}},{key:"onRelay",value:function(e,t){t.ttl--;var n=this.relayingPeerIds.get(e.remoteId);if(null!=n){var i,r=a(n);try{for(r.s();!(i=r.n()).done;){var o=i.value,s=this.findDataConnection(o);s&&s.open&&(console.log("<"+o+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),s.send(t))}}catch(l){r.e(l)}finally{r.f()}}}},{key:"onUpdatePeerList",value:function(e,t){var n,i,r=function(e,t){var n,i=[],r=[],o=!1,s=!1,l=a(e.concat(t));try{for(l.s();!(n=l.n()).done;){var c=n.value;o=e.includes(c),s=t.includes(c),o&&!s?i.push(c):!o&&s&&r.push(c)}}catch(u){l.e(u)}finally{l.f()}return{diff1:i,diff2:r}}(this._peerIds,t.peers);if(n=r.diff1,i=r.diff2,this.relayingPeerIds.set(e.remoteId,n),t.peers=t.peers.concat(n),i.length){var o,s=a(i);try{for(s.s();!(o=s.n()).done;){var l=o.value;!this.maybeUnavailablePeerIds.has(l)&&this.connect(l)&&console.log("auto connect to unknown Peer <"+l+">")}}catch(c){s.e(c)}finally{s.f()}}}},{key:"updatePeerList",value:function(){var e,t=[],n=a(this.connections);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.open&&t.push(i.remoteId)}}catch(r){n.e(r)}finally{n.f()}return t.push(this.peerId),t.sort(function(e,t){return e>t?1:e<t?-1:0}),this._peerIds=t,console.log("<update()>",t),this.notifyPeerList(),t}},{key:"notifyPeerList",value:function(){if(!(this.connections.length<1)){var e={data:nv.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(e)}}},{key:"getSkyWayErrorMessage",value:function(e){switch(e){case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-id":return"Peer ID\u304c\u4e0d\u6b63\u3067\u3059\u3002";case"invalid-key":return"SkyWay API\u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"list-error":return"SkyWay API\u30ad\u30fc\u306eREST API\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"server-error":return"SkyWay\u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u304b\u3089Peer\u4e00\u89a7\u3092\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002";case"disconnected":return"SkyWay\u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay\u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u304c\u5931\u308f\u308c\u307e\u3057\u305f\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f("+e+")"}}}]),e}(),Xb=Jm.parse("???"),Kb=function(){function e(){var t=this;y(this,e),this.callback=new Xm,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=function(){t.sendQueue()},this.callbackUnload=function(e){t.close()},console.log("Network ready...")}return k(e,[{key:"peerId",get:function(){return this.connection?this.connection.peerId:Xb.peerId}},{key:"peerIds",get:function(){return this.connection?this.connection.peerIds.concat():[]}},{key:"peerContexts",get:function(){return this.connection?this.connection.peerContexts.concat():[]}},{key:"peerContext",get:function(){return this.connection?this.connection.peerContext:Xb}},{key:"isOpen",get:function(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}},{key:"bandwidthUsage",get:function(){return this.connection?this.connection.bandwidthUsage:0}},{key:"open",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",t),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,t),window.addEventListener("unload",this.callbackUnload,!1)}},{key:"close",value:function(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}},{key:"connect",value:function(e){return!!this.connection&&this.connection.connect(e)}},{key:"disconnect",value:function(e){this.connection&&this.connection.disconnect(e)&&(console.log("<disconnectPeer()> Peer:"+e),this.disconnect(e))}},{key:"send",value:function(e,t){this.queue.add({data:e,sendTo:t}),null===this.sendInterval&&(this.sendInterval=qm(this.sendCallback))}},{key:"sendQueue",value:function(){var e,t=[],n={},i=[],r=this.queue.size<128?this.queue.size:128,o=a(this.queue);try{for(o.s();!(e=o.n()).done;){var s=e.value;if(r<=0)break;r--,this.queue.delete(s),null==s.sendTo?t.push(s.data):s.sendTo===this.peerId?i.push(s.data):(s.sendTo in n||(n[s.sendTo]=[]),n[s.sendTo].push(s.data))}}catch(c){o.e(c)}finally{o.f()}if(this.connection)for(var l in t.length&&this.connection.send(t),n)this.connection.send(n[l],l);this.callback.onData&&(this.callback.onData(null,t),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?qm(this.sendCallback):null}},{key:"setApiKey",value:function(e){this.key!==e&&console.log("Key Change"),this.key=e}},{key:"listAllPeers",value:function(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}},{key:"initializeConnection",value:function(){var e=this,t=new qb;return t.setApiKey(this.key),t.callback.onOpen=function(t){e.callback.onOpen&&e.callback.onOpen(t)},t.callback.onClose=function(t){e.callback.onClose&&e.callback.onClose(t)},t.callback.onConnect=function(t){e.callback.onConnect&&e.callback.onConnect(t)},t.callback.onDisconnect=function(t){e.callback.onDisconnect&&e.callback.onDisconnect(t)},t.callback.onData=function(t,n){e.callback.onData&&e.callback.onData(t,n)},t.callback.onError=function(t,n){e.callback.onError&&e.callback.onError(t,n)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=qm(this.sendCallback)),t}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),$b=function(){function e(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Kb.instance.peerId;y(this,e),this.eventName=t,this.data=n,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Kb.instance.peerId}return k(e,[{key:"toContext",value:function(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}]),e}(),Qb=function(){function e(t,n){y(this,e),this._priority=0,this._isRegistered=!1,this._subject=t,this._key=n}return k(e,[{key:"subject",get:function(){return this._subject}},{key:"key",get:function(){return this._key}},{key:"eventName",get:function(){return this._eventName}},{key:"priority",get:function(){return this._priority}},{key:"callback",get:function(){return this._callback}},{key:"isOnlyOnce",get:function(){return this._isOnlyOnce}},{key:"isRegistered",get:function(){return this._isRegistered}},{key:"on",value:function(){return this._isOnlyOnce=!1,2===arguments.length?this.register(arguments.length<=0?void 0:arguments[0],0,arguments.length<=1?void 0:arguments[1]):this.register(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"once",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=this.on.apply(this,t);return this._isOnlyOnce=!0,i}},{key:"register",value:function(t,n,i){return this.isRegistered&&this.unregister(),this._eventName=t||"*",this._priority=n,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new e(this.subject,this.key)}},{key:"unregister",value:function(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}},{key:"trigger",value:function(e){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[e,this]),this.isOnlyOnce&&this.unregister())}},{key:"isEqual",value:function(e,t,n){return!(null!=e&&e!==this.key||null!=t&&t!==this.eventName||null!=n&&n!==this.callback)}}]),e}(),Jb=function(){function e(){y(this,e),this.listenerMap=new Map,console.log("EventSystem ready...")}return k(e,[{key:"register",value:function(e){return new Qb(this,e)}},{key:"unregister",value:function(){1===arguments.length?this._unregister(arguments.length<=0?void 0:arguments[0],null,null):2===arguments.length?"string"==typeof(arguments.length<=1?void 0:arguments[1])?this._unregister(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],null):this._unregister(arguments.length<=0?void 0:arguments[0],null,arguments.length<=1?void 0:arguments[1]):this._unregister(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1],arguments.length<=2?void 0:arguments[2])}},{key:"_unregister",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,n=arguments.length>1?arguments[1]:void 0,i=arguments.length>2?arguments[2]:void 0,r=this.listenerMap.values(),o=a(r);try{for(o.s();!(e=o.n()).done;){var s,l=e.value,c=a(l.concat());try{for(c.s();!(s=c.n()).done;){var u=s.value;u.isEqual(t,n,i)&&u.unregister()}}catch(h){c.e(h)}finally{c.f()}}}catch(h){o.e(h)}finally{o.f()}}},{key:"registerListener",value:function(e){var t=this.getListeners(e.eventName);return t.push(e),t.sort(function(e,t){return t.priority-e.priority}),this.listenerMap.set(e.eventName,t),e}},{key:"unregisterListener",value:function(e){var t=this.getListeners(e.eventName),n=t.indexOf(e);return n<0?null:(t.splice(n,1),e.unregister(),t.length<1&&this.listenerMap.delete(e.eventName),e)}},{key:"call",value:function(){"string"==typeof(arguments.length<=0?void 0:arguments[0])?this._call(new $b(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1]),arguments.length<=2?void 0:arguments[2]):this._call(arguments.length<=0?void 0:arguments[0],arguments.length<=1?void 0:arguments[1])}},{key:"_call",value:function(e,t){var n=e.toContext();Kb.instance.send(n,t)}},{key:"trigger",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];if(2!==t.length)return this._trigger(t[0]instanceof $b?t[0]:new $b(t[0].eventName,t[0].data,t[0].sendFrom));this._trigger(new $b(t[0],t[1]))}},{key:"_trigger",value:function(e){var t,n=a(this.getListeners(e.eventName).concat(this.getListeners("*")));try{for(n.s();!(t=n.n()).done;){t.value.trigger(e)}}catch(i){n.e(i)}finally{n.f()}return e}},{key:"getListeners",value:function(e){return this.listenerMap.has(e)?this.listenerMap.get(e):[]}},{key:"initializeNetworkEvent",value:function(){var e=this,t=Kb.instance.callback;t.onOpen=function(t){e.trigger("OPEN_NETWORK",{peerId:t})},t.onClose=function(t){e.trigger("CLOSE_NETWORK",{peerId:t})},t.onConnect=function(t){e.sendSystemMessage("<"+t+"> connect <DataConnection>"),e.trigger("CONNECT_PEER",{peerId:t})},t.onDisconnect=function(t){e.sendSystemMessage("<"+t+"> disconnect <DataConnection>"),e.trigger("DISCONNECT_PEER",{peerId:t})},t.onData=function(t,n){var i,r=a(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;e.trigger(o)}}catch(s){r.e(s)}finally{r.f()}},t.onError=function(t,n){e.sendSystemMessage("<"+t+"> "+n)}}},{key:"sendSystemMessage",value:function(e){console.log(e)}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e,e._instance.initializeNetworkEvent()),e._instance}}]),e}().instance,ek=Kb.instance,tk=function(){function e(){var t=this;y(this,e),this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=function(){t.updateQueue()},console.log("ObjectStore ready...")}return k(e,[{key:"add",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null!=this.get(e.identifier)||this.isDeleted(e.identifier)?null:(this.identifierMap.set(e.identifier,e),(this.aliasNameMap.has(e.aliasName)?this.aliasNameMap.get(e.aliasName):this.aliasNameMap.set(e.aliasName,new Map).get(e.aliasName)).set(e.identifier,e),e.onStoreAdded(),t&&this.update(e.toContext()),e)}},{key:"remove",value:function(e){if(!this.identifierMap.has(e.identifier))return null;this.identifierMap.delete(e.identifier);var t=this.aliasNameMap.get(e.aliasName);return t&&t.delete(e.identifier),e.onStoreRemoved(),e}},{key:"delete",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=null,i=null;return"string"==typeof e?(n=this.get(e),i=e):(n=e,i=e.identifier),this.markForDelete(i),null==n?null:this._delete(n,t)}},{key:"_delete",value:function(e,t){return null===this.remove(e)?null:(t&&Jb.call("DELETE_GAME_OBJECT",{identifier:e.identifier}),e)}},{key:"markForDelete",value:function(e){this.garbageMap.set(e,performance.now()),this.garbageCollection(6e5)}},{key:"get",value:function(e){return this.identifierMap.has(e)?this.identifierMap.get(e):null}},{key:"getObjects",value:function(e){if(null==e)return Array.from(this.identifierMap.values());var t;return t="string"==typeof e?e:e.aliasName,this.aliasNameMap.has(t)?Array.from(this.aliasNameMap.get(t).values()):[]}},{key:"update",value:function(e){var t=null;if("string"==typeof e){var n=this.get(e);n&&(t=n.toContext())}else t=e;if(t)if(this.queueMap.has(t.identifier)){var i=this.queueMap.get(t.identifier);for(var r in t)i[r]=t[r]}else Jb.call("UPDATE_GAME_OBJECT",t),this.queueMap.set(t.identifier,t),null===this.updateInterval&&(this.updateInterval=qm(this.updateCallback))}},{key:"updateQueue",value:function(){this.queueMap.clear(),this.updateInterval=null}},{key:"isDeleted",value:function(e){return null!=this.garbageMap.get(e)}},{key:"getCatalog",value:function(){var e,t=[],n=a(this.identifierMap.values());try{for(n.s();!(e=n.n()).done;){var i=e.value;t.push({identifier:i.identifier,version:i.version})}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"clearDeleteHistory",value:function(){this.garbageMap.clear()}},{key:"garbageCollection",value:function(e){var t=this;"number"==typeof e?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(function(){t.garbageCollectionInterval=null},1e3),this._garbageCollection(e)):this.garbageMap.delete(e.identifier)}},{key:"_garbageCollection",value:function(e){var t=performance.now(),n=this.garbageMap.size-1e5;if(!(n<1))for(var i=this.garbageMap.entries();n<1;){n--;var r=i.next();if(r.done)break;var a=r.value[0];r.value[1]+e<t||this.garbageMap.delete(a)}}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),nk=function(){function e(t,n){y(this,e),this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=t,this.timerMilliSecond=n,this.reset()}return k(e,[{key:"isActive",get:function(){return null!=this.timeoutTimer}},{key:"stop",value:function(){this.isStopped=!0}},{key:"clear",value:function(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}},{key:"reset",value:function(){1===arguments.length?this.timerMilliSecond=arguments.length<=0?void 0:arguments[0]:1<arguments.length&&(this.callback=arguments.length<=0?void 0:arguments[0],this.timerMilliSecond=arguments.length<=1?void 0:arguments[1]),this.isStopped=!1;var e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,this.timeoutTimer&&e<=this.timeoutDate||this.setTimeout()}},{key:"setTimeout",value:function(e){function t(){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=this;this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(function(){e.timeoutTimer=null,e.isStopped||(performance.now()<e.timeoutDate?e.setTimeout():e.callback&&e.callback())},this.timeoutDate-performance.now()))})}]),e}(),ik=function(){function e(){y(this,e),this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}return k(e,[{key:"register",value:function(e,t){t||(t=e.name||e.toString().match(/function\s*([^(]*)\(/)[1]),this.constructorMap.has(t)?console.error("\u305d\u306e alias<"+t+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(e)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",e):(console.log("addGameObjectFactory -> "+t),this.constructorMap.set(t,e),this.aliasMap.set(e,t))}},{key:"create",value:function(e,t){var n=this.constructorMap.get(e);return n?new n(t):(console.error(e+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}},{key:"getAlias",value:function(e){return this.aliasMap.get(e)}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}();function rk(e){return function(t){ik.instance.register(t,e)}}function ak(){return function(e,t){Object.defineProperty(e,t,{get:function(){return this.context.syncData[t]},set:function(e){this.context.syncData[t]=e,this.update()},enumerable:!0,configurable:!0})}}!function(e){var t=/&|<|>|"|'/g,n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},a=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function o(e){return n[e]}function s(e){return r[e]}e.xml2element=function(e){var t=new DOMParser,n=null;try{e=function(e){return e.replace(a,"").trim()}(e),(n=t.parseFromString(e,"application/xml")).getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",n.documentElement),n=null)}catch(i){console.error(i)}return n?n.documentElement:null},e.encodeEntityReference=function(e){return e.replace(t,o)},e.decodeEntityReference=function(e){return e.replace(i,s)}}(Yb||(Yb={}));var ok=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);var sk,lk=function(){function e(){y(this,e),console.log("ObjectSerializer ready...")}return k(e,[{key:"toXml",value:function(t){var n="",i="toAttributes"in t?t.toAttributes():e.toAttributes(t.toContext().syncData),r=t.aliasName,a="";for(var o in i){var s=Yb.encodeEntityReference(i[o]+"");null!=s&&(a+=" "+o+'="'+s+'"')}return n+="<".concat(r+a,">"),n+="innerXml"in t?t.innerXml():"",n+="</".concat(r,">")}},{key:"parseXml",value:function(t){var n;if(!(n="string"==typeof t?Yb.xml2element(t):t))return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;var i=ik.instance.create(n.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(n.attributes);else{var r=i.toContext();e.parseAttributes(r.syncData,n.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(n),i}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}},{key:"toAttributes",value:function(t){var n={};for(var i in t){var r=e.make2Attributes(t[i],i);for(var a in r)n[a]=r[a]}return n}},{key:"make2Attributes",value:function(t,n){var i={};if(Array.isArray(t)){var r=e.array2attributes(t,n);for(var a in r)i[a]=r[a]}else if("object"==typeof t){var o=e.object2attributes(t,n);for(var s in o)i[s]=o[s]}else i[n]=t;return i}},{key:"object2attributes",value:function(t,n){var i={};for(var r in t){var a=e.make2Attributes(t[r],n+"."+r);for(var o in a)i[o]=a[o]}return i}},{key:"array2attributes",value:function(t,n){for(var i={},r=t.length,a=0;a<r;a++){var o=e.make2Attributes(t[a],n+"."+a);for(var s in o)i[s]=o[s]}return i}},{key:"parseAttributes",value:function(t,n){for(var i=n.length,r=0;r<i;r++){var a,o=n[r].value;o=Yb.decodeEntityReference(o);var s=n[r].name.split("."),l=s[0],c=t,u=s.find(function(e){return ok.includes(e)});null==u?1<s.length&&(c=(a=e.attributes2object(s,c,l)).obj,null==(l=a.key))||("string"!=typeof c[l]&&null!=c[l]&&(o=JSON.parse(o)),c[l]=o):console.log("skip invalid key (".concat(u,")"))}return t}},{key:"attributes2object",value:function(e,t,n){for(var i=null,r=e.length,a=0;a<r;a++){var o=parseInt(e[a]);if(i&&!Number.isNaN(o)&&!Array.isArray(t)&&Object.keys(i).length&&(i[n]=[],t=i[n]),n=Number.isNaN(o)?e[a]:o,Array.isArray(t)&&"number"!=typeof n)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:t,key:null};a+1<r&&(null==t[n]&&(t[n]="number"==typeof n?[]:{}),i=t,t=t[n])}return{obj:t,key:n}}},{key:"parseInnerXml",value:function(e){return null}}]),e}(),ck=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hb.generateUuid();y(this,e),this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=t}return k(e,[{key:"aliasName",get:function(){return this.context.aliasName}},{key:"identifier",get:function(){return this.context.identifier}},{key:"version",get:function(){return this.context.majorVersion+this.context.minorVersion}},{key:"initialize",value:function(){tk.instance.add(this)}},{key:"destroy",value:function(){tk.instance.delete(this)}},{key:"onStoreAdded",value:function(){}},{key:"onStoreRemoved",value:function(){}},{key:"update",value:function(){this.versionUp(),tk.instance.update(this.identifier)}},{key:"versionUp",value:function(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}},{key:"apply",value:function(e){null!==e&&this.identifier===e.identifier&&(this.context.majorVersion=e.majorVersion,this.context.minorVersion=e.minorVersion,this.context.syncData=e.syncData)}},{key:"clone",value:function(){var e=this.toXml();return lk.instance.parseXml(e)}},{key:"toContext",value:function(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:uk(this.context.syncData)}}},{key:"toXml",value:function(){return lk.instance.toXml(this)}}],[{key:"aliasName",get:function(){return ik.instance.getAlias(this)}}]),e}();function uk(e){if(null==e)return e;var t,n=Array.isArray(e)?[]:{},i=a(Object.getOwnPropertyNames(e));try{for(i.s();!(t=i.n()).done;){var r=t.value,o=typeof e[r];null!=e[r]&&"object"===o?n[r]=uk(e[r]):"function"!==o&&(n[r]=e[r])}}catch(s){i.e(s)}finally{i.f()}return n}var hk,dk=((hk=sk=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).value="",e.attributes={},e.parentIdentifier="",e.majorIndex=0,e.minorIndex=Math.random(),e._children=[],e.needsSort=!0,e}return k(n,[{key:"index",get:function(){return this.majorIndex+this.minorIndex},set:function(e){this.majorIndex=0|e,this.minorIndex=e-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}},{key:"parent",get:function(){return tk.instance.get(this.parentIdentifier)}},{key:"parentId",get:function(){return this.parentIdentifier}},{key:"parentIsAssigned",get:function(){return 0<this.parentIdentifier.length}},{key:"parentIsUnknown",get:function(){return this.parentIsAssigned&&null==tk.instance.get(this.parentIdentifier)}},{key:"parentIsDestroyed",get:function(){return this.parentIsAssigned&&tk.instance.isDeleted(this.parentIdentifier)}},{key:"children",get:function(){return this.needsSort&&(this.needsSort=!1,this._children.sort(function(e,t){return e.index-t.index})),this._children.concat()}},{key:"destroy",value:function(){u(v(n.prototype),"destroy",this).call(this);var e,t=a(this._children.concat());try{for(t.s();!(e=t.n()).done;)e.value.destroy()}catch(i){t.e(i)}finally{t.f()}this._children=[]}},{key:"onStoreAdded",value:function(){u(v(n.prototype),"onStoreAdded",this).call(this),this.initializeChildren()}},{key:"onStoreRemoved",value:function(){u(v(n.prototype),"onStoreRemoved",this).call(this),this.parent&&this.parent.removeChild(this)}},{key:"onChildAdded",value:function(e){}},{key:"onChildRemoved",value:function(e){}},{key:"_onChildAdded",value:function(e){for(var t=this;t&&(t.onChildAdded(e),(t=t.parent)!==this););}},{key:"_onChildRemoved",value:function(e){for(var t=this;t&&(t.onChildRemoved(e),(t=t.parent)!==this););}},{key:"initializeChildren",value:function(){if(null!=sk.unknownNodes[this.identifier]){var e,t=a(sk.unknownNodes[this.identifier]);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.parent===this&&this.updateChildren(n)}}catch(i){t.e(i)}finally{t.f()}sk.unknownNodes[this.identifier]&&delete sk.unknownNodes[this.identifier]}}},{key:"updateChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this,t=this._children.indexOf(e),n=!1,i=e.parent===this;if(t<0&&i)this._children.push(e),t=this._children.length-1,n=!0;else{if(0<=t&&!i)return this._children.splice(t,1),void this._onChildRemoved(e);if(t<0&&!i)return}var r=this._children.length;r&&((this._children[t-1<0?0:t-1].index>e.index||e.index>this._children[r-1<t+1?r-1:t+1].index)&&(this.needsSort=!0),n&&this._onChildAdded(e))}},{key:"updateIndexs",value:function(){for(var e=this.children,t=0;t<e.length;t++)e[t].majorIndex=t,e[t].minorIndex=Math.random()}},{key:"appendChild",value:function(e){if(e.contains(this))return null;e.parent&&e.parent!==this&&e.parent.removeChild(e);var t=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return e.parentIdentifier=this.identifier,e.majorIndex=t,e.minorIndex=Math.random(),this.updateChildren(e),e}},{key:"insertBefore",value:function(e,t){if(e.contains(this))return null;if(e===t&&e.parent===this)return e;e.parent&&e.parent!==this&&e.parent.removeChild(e);var n=this.children.indexOf(t);if(n<0)return this.appendChild(e);e.parentIdentifier=this.identifier;var i=0<n?this.children[n-1].index:0,r=t.index-i,a=i+r*(.45+.1*Math.random());return e.majorIndex=0|a,e.minorIndex=a-e.majorIndex,this.updateChildren(e),r<1e-7&&this.updateIndexs(),e}},{key:"removeChild",value:function(e){return this.children.indexOf(e)<0?null:(e.parentIdentifier="",e.majorIndex=0,e.minorIndex=Math.random(),this.updateChildren(e),e)}},{key:"contains",value:function(e){for(var t=e.parent;t;){if(t===e)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",e),!1;if(t===this)return!0;t=t.parent}return!1}},{key:"setAttribute",value:function(e,t){this.attributes[e]=t,this.update()}},{key:"getAttribute",value:function(e){return null==this.attributes[e]?"":this.attributes[e]}},{key:"removeAttribute",value:function(e){delete this.attributes[e],this.update()}},{key:"toAttributes",value:function(){return lk.toAttributes(this.attributes)}},{key:"parseAttributes",value:function(e){lk.parseAttributes(this.attributes,e)}},{key:"innerXml",value:function(){var e="";e+=Yb.encodeEntityReference(this.value+"");var t,n=a(this.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;e+=lk.instance.toXml(i)}}catch(r){n.e(r)}finally{n.f()}return e}},{key:"parseInnerXml",value:function(e){var t=e.children,n=t.length;if(0<n)for(var i=0;i<n;i++){var r=lk.instance.parseXml(t[i]);r instanceof sk&&this.appendChild(r)}else this.value=Yb.decodeEntityReference(e.innerHTML)}},{key:"apply",value:function(e){var t=this.parent;u(v(n.prototype),"apply",this).call(this,e),t&&this.parent!==t&&t.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in sk.unknownNodes||(sk.unknownNodes[this.parentIdentifier]=[]),sk.unknownNodes[this.parentIdentifier].push(this))}}]),n}(ck)).unknownNodes={},zm([ak()],hk.prototype,"value",void 0),zm([ak()],hk.prototype,"attributes",void 0),zm([ak()],hk.prototype,"parentIdentifier",void 0),zm([ak()],hk.prototype,"majorIndex",void 0),zm([ak()],hk.prototype,"minorIndex",void 0),hk=sk=zm([rk("node")],hk));function fk(e){return function(t){rk(e)(t)}}function pk(){return function(e,t){e instanceof dk?function(e,t){Object.defineProperty(e,t,{get:function(){return this.getAttribute(t)},set:function(e){this.setAttribute(t,e)},enumerable:!0,configurable:!0})}(e,t):ak()(e,t)}}var gk,mk,vk=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Queue";y(this,e),this.name=t,this.queue=Promise.resolve(),this._length=0}return k(e,[{key:"length",get:function(){return this._length}},{key:"add",value:function(e){var t=this;this._length++,console.log("".concat(this.name," add: ").concat(this._length)),this.queue=this.queue.then("function"==typeof e.then?function(){return e}:0<e.length?function(){return new Promise(e)}:e);var n=this.queue;return this.queue=this.queue.catch(function(e){console.error(e)}),this.queue=this.queue.then(function(){t._length--,console.log("".concat(t.name," done: ").concat(t._length))}),n}}]),e}();!function(e){var t=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));e.toHalfWidth=function(e){return e.replace(/[\uff01-\uff5e]/g,function(e){return String.fromCharCode(e.charCodeAt(0)-65248)})},e.isEmote=function(e){return!!e&&(e=this.cr(e).replace(/[\r\n]/g,"")).length<=3&&(t.test(e)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a]/.test(e))},e.cr=function(e){if(!e)return"";var t="",n="";return i(e).forEach(function(e){if(n){switch(e){case"n":case"\uff4e":t+="\n";break;case"\\":case"\uffe5":t+=e;break;default:t+=n+e}n=""}else"\\"==e||"\uffe5"==e?n=e:t+=e}),t},e.validUrl=function(e){if(!e)return!1;try{new URL(e.trim())}catch(t){return!1}return/^https?\:\/\//.test(e.trim())},e.sameOrigin=function(e){if(!e)return!1;try{return new URL(e).origin===window.location.origin}catch(t){return!1}},e.escapeHtml=function(e){return"string"!=typeof e?e.toString():e.replace(/[&'`"<>]/g,function(e){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[e]})}}(gk||(gk={}));var yk,bk,kk,_k,wk,xk,Ck,Ek,Sk,Tk,Ok,Ik,Mk,Ak,Pk,Dk=function(){function e(){y(this,e),this.imageHash={},console.log("ImageStorage ready...")}return k(e,[{key:"images",get:function(){var e=[];for(var t in this.imageHash)e.push(this.imageHash[t]);return e}},{key:"destroy",value:function(){for(var e in this.imageHash)this.delete(e)}},{key:"addAsync",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Wm.createAsync(e);case 2:return n=t.sent,t.abrupt("return",this._add(n));case 4:case"end":return t.stop()}},t,this)}))}},{key:"add",value:function(e){var t;if("string"==typeof e)t=Wm.create(e);else if(e instanceof Wm)t=e;else{if(this.update(e))return this.imageHash[e.identifier];t=Wm.create(e)}return this._add(t)}},{key:"_add",value:function(e){return Vm.COMPLETE<=e.state&&this.lazySynchronize(100),this.update(e)?this.imageHash[e.identifier]:(this.imageHash[e.identifier]=e,console.log("add Image: "+e.identifier),e)}},{key:"update",value:function(e){e instanceof Wm&&e.toContext();var t=this.imageHash[e.identifier];return!!t&&(t.apply(e),!0)}},{key:"delete",value:function(e){var t=this.imageHash[e];return!!t&&(t.destroy(),delete this.imageHash[e],!0)}},{key:"get",value:function(e){return this.imageHash[e]||null}},{key:"synchronize",value:function(e){this.lazyTimer&&this.lazyTimer.stop(),Jb.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),e)}},{key:"lazySynchronize",value:function(e,t){var n=this;null==this.lazyTimer&&(this.lazyTimer=new nk(function(){return n.synchronize(t)},e)),this.lazyTimer.reset(e)}},{key:"getCatalog",value:function(){var e,t=[],n=a(this.images);try{for(n.s();!(e=n.n()).done;){var i=e.value;Vm.COMPLETE<=i.state&&t.push({identifier:i.identifier,state:i.state})}}catch(r){n.e(r)}finally{n.f()}return t}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),Rk=((bk=mk=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).userId="",e.peerId="",e.name="",e.imageIdentifier="",e.color=mk.CHAT_DEFAULT_COLOR,e}return k(n,[{key:"isMine",get:function(){return mk.myCursor&&mk.myCursor===this}},{key:"image",get:function(){return Dk.instance.get(this.imageIdentifier)}},{key:"onStoreAdded",value:function(){var e=this;u(v(n.prototype),"onStoreAdded",this).call(this),this.isMine||Jb.register(this).on("DISCONNECT_PEER",-1e3,function(t){t.data.peerId===e.peerId&&(mk.userIdMap.delete(e.userId),mk.peerIdMap.delete(e.peerId),tk.instance.remove(e))})}},{key:"onStoreRemoved",value:function(){u(v(n.prototype),"onStoreRemoved",this).call(this),Jb.unregister(this),mk.userIdMap.delete(this.userId),mk.peerIdMap.delete(this.peerId)}},{key:"apply",value:function(e){var t=e.syncData.userId,i=e.syncData.peerId;t!==this.userId&&(mk.userIdMap.set(t,this.identifier),mk.userIdMap.delete(this.userId)),i!==this.peerId&&(mk.peerIdMap.set(i,this.identifier),mk.peerIdMap.delete(this.peerId)),u(v(n.prototype),"apply",this).call(this,e)}},{key:"isPeerAUdon",value:function(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}}],[{key:"findByUserId",value:function(e){return this.find(mk.userIdMap,e,!0)}},{key:"findByPeerId",value:function(e){return this.find(mk.peerIdMap,e,!1)}},{key:"find",value:function(e,t,n){var i=e.get(t);if(null!=i&&tk.instance.get(i))return tk.instance.get(i);var r,o=a(tk.instance.getObjects(mk));try{for(o.s();!(r=o.n()).done;){var s=r.value,l=n?s.userId:s.peerId;if(l===t)return e.set(l,s.identifier),s}}catch(c){o.e(c)}finally{o.f()}return null}},{key:"createMyCursor",value:function(){return mk.myCursor?(console.warn("It is already created."),mk.myCursor):(mk.myCursor=new mk,mk.myCursor.peerId=ek.peerId,mk.myCursor.initialize(),window.localStorage&&localStorage.getItem(mk.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(mk.myCursor.name=localStorage.getItem(mk.CHAT_MY_NAME_LOCAL_STORAGE_KEY)),window.localStorage&&localStorage.getItem(mk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(mk.myCursor.color=localStorage.getItem(mk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)),mk.myCursor)}}]),n}(ck)).CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",bk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",bk.CHAT_DEFAULT_COLOR="#444444",bk.CHAT_TRANSPARENT_COLOR="#ffffff",bk.myCursor=null,bk.userIdMap=new Map,bk.peerIdMap=new Map,zm([pk()],bk.prototype,"userId",void 0),zm([pk()],bk.prototype,"peerId",void 0),zm([pk()],bk.prototype,"name",void 0),zm([pk()],bk.prototype,"imageIdentifier",void 0),zm([pk()],bk.prototype,"color",void 0),bk=mk=zm([fk("PeerCursor")],bk)),Fk=(yk=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).dicebot="",e.paletteColor="",e._palettes=[],e._paletteLines=[],e._paletteVariables=[],e.isAnalized=!1,e}return k(n,[{key:"color",get:function(){return this.paletteColor&&"#ffffff"!=this.paletteColor?this.paletteColor:window.localStorage&&localStorage.getItem(Rk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&"#ffffff"!=localStorage.getItem(Rk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)?localStorage.getItem(Rk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY):Rk.CHAT_DEFAULT_COLOR},set:function(e){this.paletteColor=e}},{key:"paletteLines",get:function(){return this.isAnalized||this.parse(this.value),this._paletteLines}},{key:"paletteVariables",get:function(){return this.isAnalized||this.parse(this.value),this._paletteVariables}},{key:"getPalette",value:function(){return this.isAnalized||this.parse(this.value),this._palettes}},{key:"setPalette",value:function(e){this.value=e,this.isAnalized=!1}},{key:"evaluate",value:function(e,t){var n=this,i="";i="string"==typeof e?e:e.palette,console.log(i);for(var r=0,o=!0;o;)r++,o=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,function(e,i){i=gk.toHalfWidth(i),console.log(i),o=!0;var r,s="",l=a(n.paletteVariables);try{for(l.s();!(r=l.n()).done;){var c=r.value;c.name==i&&(s=c.value)}}catch(h){l.e(h)}finally{l.f()}if(t){var u=t.getFirstElementByName(i);return u?null==(s=u.isNumberResource?u.currentValue:u.isCheckProperty?(u.currentValue+"").split(/[|\uff5c]/g)[u.value?0:1]:u.isAbilityScore?u.calcAbilityScore():u.value)&&(s=""):((u=t.getFirstElementByName(i.replace(/^\u6700\u5927/,""))||t.getFirstElementByName(i.replace(/^Max[\:\_\-\s]?/i,""))||t.getFirstElementByName(i.replace(/^\u57fa\u672c/,""))||t.getFirstElementByName(i.replace(/^\u521d\u671f/,""))||t.getFirstElementByName(i.replace(/^\u539f/,""))||t.getFirstElementByName(i.replace(/\u57fa\u672c\u5024$/,""))||t.getFirstElementByName(i.replace(/\u521d\u671f\u5024$/,""))||t.getFirstElementByName(i.replace(/\u539f\u70b9$/,"")))&&(u.isNumberResource||u.isAbilityScore)&&(s=u.value),(u=t.getFirstElementByName(i.replace(/\u4fee\u6b63\u5024?$/,""))||t.getFirstElementByName(i.replace(/\s*Mod(ifier|\.)?$/i,""))||t.getFirstElementByName(i.replace(/\u30dc\u30fc\u30ca\u30b9$/,"")))&&u.isAbilityScore&&(s=u.calcAbilityScore())),s+""}return""}),128<r&&(o=!1);return i}},{key:"parse",value:function(e){this._palettes=e.split("\n"),this._paletteLines=[],this._paletteVariables=[];var t,n=a(this._palettes);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=this.parseVariable(i);r?this._paletteVariables.push(r):this._paletteLines.push({palette:i})}}catch(o){n.e(o)}finally{n.f()}this.isAnalized=!0}},{key:"parseVariable",value:function(e){var t=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(e);return t?{name:gk.toHalfWidth(t[1]),value:t[2]}:null}},{key:"apply",value:function(e){u(v(n.prototype),"apply",this).call(this,e),this.isAnalized=!1}}]),n}(dk),zm([pk()],yk.prototype,"dicebot",void 0),zm([pk()],yk.prototype,"paletteColor",void 0),yk=zm([fk("chat-palette")],yk)),Nk=(wk=kk=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"isSimpleNumber",get:function(){return null!=this.type&&"simpleNumber"===this.type}},{key:"isNumberResource",get:function(){return null!=this.type&&"numberResource"===this.type}},{key:"isCheckProperty",get:function(){return null!=this.type&&"checkProperty"===this.type}},{key:"isNote",get:function(){return null!=this.type&&"note"===this.type}},{key:"isAbilityScore",get:function(){return null!=this.type&&"abilityScore"===this.type}},{key:"isUrl",get:function(){return null!=this.type&&"url"===this.type}},{key:"getElementsByName",value:function(e){var t,n=[],i=a(this.children);try{for(i.s();!(t=i.n()).done;){var r=t.value;r instanceof kk&&(r.getAttribute("name")===e&&n.push(r),Array.prototype.push.apply(n,r.getElementsByName(e)))}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"getElementsByType",value:function(e){var t,n=[],i=a(this.children);try{for(i.s();!(t=i.n()).done;){var r=t.value;r instanceof kk&&(r.getAttribute("type")===e&&n.push(r),Array.prototype.push.apply(n,r.getElementsByType(e)))}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"getFirstElementByName",value:function(e){var t,n=a(this.children);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i instanceof kk){if(i.getAttribute("name")===e)return i;var r=i.getFirstElementByName(e);if(r)return r}}}catch(o){n.e(o)}finally{n.f()}return null}},{key:"calcAbilityScore",value:function(){return this.isAbilityScore&&this.currentValue?(e=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+e[1]):(e=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):0:0;var e}}],[{key:"create",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return(t=r&&0<r.length?new kk(r):new kk).attributes=i,t.name=e,t.value=n,t.initialize(),t}}]),n}(dk),zm([pk()],wk.prototype,"name",void 0),zm([pk()],wk.prototype,"type",void 0),zm([pk()],wk.prototype,"currentValue",void 0),wk=kk=zm([fk("data")],wk)),zk=(_k=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).location={name:"table",x:0,y:0},e.posZ=0,e._imageFile=Wm.Empty,e._shadowImageFile=Wm.Empty,e._dataElements={},e.currntImageIndex=0,e.isUseIconToOverviewImage=!1,e.currntIconIndex=0,e.isAltitudeIndicate=!1,e.isInverse=!1,e.isHollow=!1,e.isBlackPaint=!1,e.aura=-1,e.isNotRide=!0,e.isInventoryIndicate=!0,e}return k(n,[{key:"isVisibleOnTable",get:function(){return"table"===this.location.name}},{key:"rootDataElement",get:function(){var e,t=a(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n.getAttribute("name")===this.aliasName)return n}}catch(i){t.e(i)}finally{t.f()}return null}},{key:"imageDataElement",get:function(){return this.getElement("image")}},{key:"commonDataElement",get:function(){return this.getElement("common")}},{key:"detailDataElement",get:function(){return this.getElement("detail")}},{key:"imageElement",get:function(){if(!this.imageDataElement)return null;var e=this.imageDataElement.getElementsByName("imageIdentifier");return e[this.currntImageIndex<0?0:this.currntImageIndex>=e.length?e.length-1:this.currntImageIndex]}},{key:"imageFile",get:function(){if(!this.imageDataElement)return this._imageFile;var e=this.imageElement;if(e&&this._imageFile.identifier!==e.value){var t=Dk.instance.get(e.value);this._imageFile=t||Wm.Empty}return this._imageFile}},{key:"imageFiles",get:function(){return this.imageDataElement.getElementsByName("imageIdentifier").map(function(e){return Dk.instance.get(e.value)||null}).filter(function(e){return null!=e})}},{key:"faceIcon",get:function(){if(!this.imageDataElement)return null;var e=this.imageDataElement.getElementsByName("faceIcon");if(e){var t=e[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),t?Dk.instance.get(t.value):null}return null}},{key:"faceIcons",get:function(){return this.imageDataElement.getElementsByName("faceIcon").map(function(e){return Dk.instance.get(e.value)||null}).filter(function(e){return null!=e})}},{key:"shadowImageFile",get:function(){if(!this.imageDataElement)return this._shadowImageFile;var e=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(e&&this._shadowImageFile.identifier!==e.value){var t=Dk.instance.get(e.value);this._shadowImageFile=t||Wm.Empty}else{var n=this.imageElement;if(n&&this._shadowImageFile.identifier!==n.currentValue){var i=Dk.instance.get(n.currentValue);this._shadowImageFile=i||Wm.Empty}}return this._shadowImageFile}},{key:"altitude",get:function(){var e=this.getElement("altitude",this.commonDataElement);!e&&this.commonDataElement&&this.commonDataElement.appendChild(Nk.create("altitude",0,{},"altitude_"+this.identifier));var t=e?+e.value:0;return Number.isNaN(t)?0:t},set:function(e){var t=this.getElement("altitude",this.commonDataElement);t&&(t.value=e)}},{key:"createDataElements",value:function(){this.initialize();var e=this.aliasName;if(!this.rootDataElement){var t=Nk.create(e,"",{},e+"_"+this.identifier);this.appendChild(t)}this.imageDataElement||(this.rootDataElement.appendChild(Nk.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(Nk.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(Nk.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(Nk.create("detail","",{},"detail_"+this.identifier))}},{key:"getElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootDataElement;if(!t)return null;var n=this._dataElements[e]?tk.instance.get(this._dataElements[e]):null;return n&&t.contains(n)||(n=t.getFirstElementByName(e),this._dataElements[e]=n?n.identifier:null),n}},{key:"getCommonValue",value:function(e,t){var n=this.getElement(e,this.commonDataElement);if(!n)return t;if("number"==typeof t){var i=+n.value;return Number.isNaN(i)?t:i}return n.value+""}},{key:"getUrls",value:function(){return this.rootDataElement.getElementsByType("url")}},{key:"setCommonValue",value:function(e,t){var n=this.getElement(e,this.commonDataElement);n&&(n.value=t)}},{key:"getImageFile",value:function(e){if(!this.imageDataElement)return null;var t=this.getElement(e,this.imageDataElement);return t?Dk.instance.get(t.value):null}},{key:"setImageFile",value:function(e,t){var n=t?this.getElement(e,this.imageDataElement):null;n&&(n.value=t.identifier)}},{key:"setLocation",value:function(e){this.location.name=e,this.update()}}]),n}(dk),zm([pk()],_k.prototype,"location",void 0),zm([pk()],_k.prototype,"posZ",void 0),zm([pk()],_k.prototype,"currntImageIndex",void 0),zm([pk()],_k.prototype,"isUseIconToOverviewImage",void 0),zm([pk()],_k.prototype,"currntIconIndex",void 0),zm([pk()],_k.prototype,"isAltitudeIndicate",void 0),zm([pk()],_k.prototype,"isInverse",void 0),zm([pk()],_k.prototype,"isHollow",void 0),zm([pk()],_k.prototype,"isBlackPaint",void 0),zm([pk()],_k.prototype,"aura",void 0),zm([pk()],_k.prototype,"isNotRide",void 0),zm([pk()],_k.prototype,"isInventoryIndicate",void 0),_k=zm([fk("TabletopObject")],_k)),Lk=function(e){return e[e.Default=1]="Default",e[e.Image=2]="Image",e[e.Postfix=3]="Postfix",e[e.PostfixOrImage=4]="PostfixOrImage",e[e.PostfixAndImage=5]="PostfixAndImage",e[e.NotConditionStandUp=6]="NotConditionStandUp",e}({}),Bk=(xk=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).position=5,e.height=35,e.overviewIndex=-1,e}return k(n,[{key:"standElements",get:function(){return this.getElementsByName("stand")}},{key:"add",value:function(e){var t=this.getFirstElementByName("stand")?Lk.NotConditionStandUp:Lk.Default,n=Nk.create("stand");n.appendChild(Nk.create("name","",{},"name_"+n.identifier)),n.appendChild(Nk.create("imageIdentifier",e&&e!=Wm.Empty.identifier?e:"stand_no_image",{type:"image"},"imageIdentifier_"+n.identifier)),n.appendChild(Nk.create("conditionType",t,{},"conditionType_"+n.identifier)),n.appendChild(Nk.create("height",0,{currentValue:0},"height_"+n.identifier)),n.appendChild(Nk.create("applyImageEffect","",{},"applyImageEffect_"+n.identifier)),n.appendChild(Nk.create("applyRoll","",{},"applyRoll_"+n.identifier)),n.appendChild(Nk.create("applyDialog","applyDialog",{},"applyDialog_"+n.identifier)),n.appendChild(Nk.create("postfix","",{},"postfix_"+n.identifier)),n.appendChild(Nk.create("position",0,{currentValue:""},"position_"+n.identifier)),n.appendChild(Nk.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+n.identifier)),this.appendChild(n)}},{key:"remove",value:function(e){this.removeChild(e)}},{key:"matchStandInfo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=t instanceof Wm?t.identifier:t,r="",o=!1,s=[];["\uff20\u9000\u53bb","@farewell"].forEach(function(t){gk.toHalfWidth(e).toUpperCase().endsWith(gk.toHalfWidth(t).toUpperCase())&&(("@"==t.slice(0,1)||"\uff20"==t.slice(0,1))&&r.length<t.length&&(r=t),o=!0)});var l,c=a(this.standElements);try{for(c.s();!(l=c.n()).done;){var u=l.value,h=u.getFirstElementByName("name");h&&h.value.toString()==n&&s.push(u)}}catch(O){c.e(O)}finally{c.f()}var d,f=1,p=!0,g=[],m=[],v=a(this.standElements);try{for(v.s();!(d=v.n()).done;){var y=d.value;if(y.getFirstElementByName("imageIdentifier")&&y.getFirstElementByName("conditionType")){var b=y.getFirstElementByName("conditionType").value;if(b!=Lk.NotConditionStandUp)if(b==Lk.Default)g.push(y);else{var k=y.getFirstElementByName("postfix")?y.getFirstElementByName("postfix").value.toString():null,_=y.getFirstElementByName("targetImageIdentifier")?y.getElementsByName("targetImageIdentifier").map(function(e){return e.value}):[],w=!1,x=!1;if(k&&(b==Lk.Postfix||b==Lk.PostfixOrImage||b==Lk.PostfixAndImage)){var C,E=a(k.split(/[\r\n]+/g));try{for(E.s();!(C=E.n()).done;){var S=C.value;S&&0!=S.length&&gk.toHalfWidth(e).toUpperCase().endsWith(gk.toHalfWidth(S).toUpperCase())&&(("@"==S.slice(0,1)||"\uff20"==S.slice(0,1))&&r.length<S.length&&(r=S),w=!0)}}catch(O){E.e(O)}finally{E.f()}}_.length>0&&(b==Lk.Image||b==Lk.PostfixOrImage||b==Lk.PostfixAndImage)&&(x=i&&_.indexOf(i)>=0),(w&&(b==Lk.Postfix||b==Lk.PostfixOrImage)||x&&(b==Lk.Image||b==Lk.PostfixOrImage)||w&&x&&b==Lk.PostfixAndImage)&&(p=!1,m.push(y),f<+b&&(f=+b))}}}}catch(O){v.e(O)}finally{v.f()}n||(s=p?g:m.filter(function(e){return+e.getFirstElementByName("conditionType").value==f}));var T={standElementIdentifier:null,matchMostLongText:r,farewell:o};return s&&s.length>0&&(T.standElementIdentifier=s[Math.floor(Math.random()*s.length)].identifier),T}}]),n}(Nk),zm([pk()],xk.prototype,"position",void 0),zm([pk()],xk.prototype,"height",void 0),zm([pk()],xk.prototype,"overviewIndex",void 0),xk=zm([fk("stand-list")],xk)),jk=(Sk=Ck=function(e){h(n,e);var t=f(n);function n(){var e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Hb.generateUuid();return y(this,n),(e=t.call(this,i)).rotate=0,e.roll=0,e.isDropShadow=!0,e.isShowChatBubble=!0,e.text="",e.isEmote=!1,e.isAltitudeIndicate=!0,e}return k(n,[{key:"name",get:function(){return this.getCommonValue("name","")}},{key:"size",get:function(){return this.getCommonValue("size",1)}},{key:"chatPalette",get:function(){var e,t=a(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n instanceof Fk)return n}}catch(i){t.e(i)}finally{t.f()}return null}},{key:"standList",get:function(){var e,t=a(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n instanceof Bk)return n}}catch(r){t.e(r)}finally{t.f()}var i=new Bk("StandList_"+this.identifier);return i.initialize(),this.appendChild(i),i}},{key:"createTestGameDataElement",value:function(e,t,n){this.createDataElements();var i=Nk.create("name",e,{},"name_"+this.identifier),r=Nk.create("size",t,{},"size_"+this.identifier),a=Nk.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=n);var o=Nk.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),s=Nk.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),l=Nk.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(i),this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(a),this.detailDataElement.appendChild(o),o.appendChild(s),o.appendChild(l);var c=Nk.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(c),c.appendChild(Nk.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),c.appendChild(Nk.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),c.appendChild(Nk.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),c=Nk.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(Nk.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),c.appendChild(Nk.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),c.appendChild(Nk.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),c.appendChild(Nk.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),c.appendChild(Nk.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),c.appendChild(Nk.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),c=Nk.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(c),c.appendChild(Nk.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),c.appendChild(Nk.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),c.appendChild(Nk.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),c.appendChild(Nk.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),c.appendChild(Nk.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),c.appendChild(Nk.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");var u=new Fk("ChatPalette_"+this.identifier);u.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),u.initialize(),this.appendChild(u);var h=new Bk("StandList_"+this.identifier);h.initialize(),this.appendChild(h)}}],[{key:"create",value:function(e,t,n){var i=new Ck;return i.createDataElements(),i.initialize(),i.createTestGameDataElement(e,t,n),i}}]),n}(zk),zm([pk()],Sk.prototype,"rotate",void 0),zm([pk()],Sk.prototype,"roll",void 0),zm([pk()],Sk.prototype,"isDropShadow",void 0),zm([pk()],Sk.prototype,"isShowChatBubble",void 0),Sk=Ck=zm([fk("character")],Sk)),Uk=(Ek=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).name="",e.command="",e.dice="",e}return k(n,[{key:"parseText",value:function(){return this.value?this.value.split(/[\r\n]+/).map(function(e){var t=null;if(t=(e=e.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){var n=+gk.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-")),i=+gk.toHalfWidth(t[2].replace(/[\-\uff0d\u2010]/,"-"));return n<=i?{range:{start:n,end:i},result:t[3]}:{range:{start:i,end:n},result:t[3]}}if(t=e.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+gk.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:t[2]};if(t=e.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+gk.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-"))},result:t[2]};if(t=e.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){var r=+gk.toHalfWidth(t[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:r,end:r},result:t[2]}}return(t=e.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(t=e.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:t[1]}:null}).filter(function(e){return e}):[]}}]),n}(dk),zm([pk()],Ek.prototype,"name",void 0),zm([pk()],Ek.prototype,"command",void 0),zm([pk()],Ek.prototype,"dice",void 0),Ek=zm([fk("dice-roll-table")],Ek)),Hk=(Ok=Tk=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"diceRollTables",get:function(){return this.children}},{key:"addDiceRollTable",value:function(){var e=null;if((arguments.length<=0?void 0:arguments[0])instanceof Uk)e=arguments.length<=0?void 0:arguments[0];else{var t=arguments.length<=0?void 0:arguments[0];(e=new Uk(arguments.length<=1?void 0:arguments[1])).name=t,e.initialize()}return this.appendChild(e)}},{key:"parseInnerXml",value:function(e){var t,i=a(Tk.instance.children);try{for(i.s();!(t=i.n()).done;)t.value.destroy()}catch(o){i.e(o)}finally{i.f()}var r=Tk.instance.toContext();r.syncData=this.toContext().syncData,Tk.instance.apply(r),Tk.instance.update(),u(v(n.prototype),"parseInnerXml",this).apply(Tk.instance,[e]),this.destroy()}}],[{key:"instance",get:function(){return Tk._instance||(Tk._instance=new Tk("DiceRollTableList"),Tk._instance.initialize()),Tk._instance}}]),n}(dk),Ok=Tk=zm([fk("dice-roll-table-list")],Ok)),Vk=((Ak=Ik=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"onStoreAdded",value:function(){var e=this;u(v(n.prototype),"onStoreAdded",this).call(this),Ik.queue.add(Ik.loadScriptAsync("./assets/cgiDiceBot.js")),Jb.register(this).on("SEND_MESSAGE",function(t){return Lm(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n,i,r,o,s,l,c,u,h,d,f,p,g,m,v,y,b,k,_,w,x,C,E,S,T;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((n=tk.instance.get(t.data.messageIdentifier))&&n.isSendFromSelf&&!n.isSystem){e.next=3;break}return e.abrupt("return");case 3:if(i=gk.toHalfWidth(n.text),r=n.tag,e.prev=4,o=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?\s+)?([^\s]*)?/gi.exec(i),s=o[2],l=s&&0===s.toUpperCase().indexOf("S"),c=null!=o[3]?Number(o[3]):1,(u=null!=o[4]?o[4]:i)&&!(c<1)&&(/choice\[.*\]/i.test(u)||/choice\(.*\)/i.test(u)||/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(u))){e.next=8;break}return e.abrupt("return");case 8:h={result:"",isSecret:!1,isDiceRollTable:!1},d=!1,f=a(Hk.instance.diceRollTables),e.prev=10,f.s();case 12:if((p=f.n()).done){e.next=52;break}if(g=p.value,m=!1,g.command&&u.trim().toUpperCase()==="S"+g.command.trim().toUpperCase()?(d=!0,m=!0):g.command&&u.trim().toUpperCase()===g.command.trim().toUpperCase()&&(d=!0),!d){e.next=50;break}h.isDiceRollTable=!0,h.tableName=g.name&&g.name.length>0?g.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",h.isSecret=m||l,v=g.parseText(),y=0;case 19:if(!(y<c&&y<32)){e.next=49;break}return e.next=22,Ik.diceRollAsync(gk.toHalfWidth(g.dice),"DiceBot",1);case 22:(b=e.sent).result&&(b.result=b.result.replace("DiceBot : ","").replace(/[\uff1e]/g,function(e){return"\u2192"}).trim()),k=0,_=null,b.result.length>0&&(_=b.result.match(/\s\u2192\s(?:\u6210\u529f\u6570)?(\-?\d+)$/))&&(k=+_[1]),w=!1,x=a(v),e.prev=28,x.s();case 30:if((C=x.n()).done){e.next=37;break}if(!(null===(E=C.value).range.start||E.range.start<=k)||!(null===E.range.end||k<=E.range.end)){e.next=35;break}return h.result+="\ud83c\udfb2 "+b.result+"\n"+gk.cr(E.result),w=!0,e.abrupt("break",37);case 35:e.next=30;break;case 37:e.next=42;break;case 39:e.prev=39,e.t0=e.catch(28),x.e(e.t0);case 42:return e.prev=42,x.f(),e.finish(42);case 45:w||(h.result+="\ud83c\udfb2 "+b.result+"\n(\u7d50\u679c\u306a\u3057)"),1<c&&(h.result+=" #".concat(y+1,"\n"));case 46:y++,e.next=19;break;case 49:return e.abrupt("break",52);case 50:e.next=12;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(10),f.e(e.t1);case 57:return e.prev=57,f.f(),e.finish(57);case 60:if(d){e.next=79;break}if(!Ik.apiUrl){e.next=68;break}return e.next=64,Ik.diceRollAsync(u,r,c);case 64:(h=e.sent).isSecret=h.isSecret||l,e.next=79;break;case 68:S=0;case 69:if(!(S<c&&S<32)){e.next=79;break}return e.next=72,Ik.diceRollAsync(u,r,c);case 72:if(!((T=e.sent).result.length<1)){e.next=75;break}return e.abrupt("break",79);case 75:h.result+=T.result,h.isSecret=h.isSecret||T.isSecret||l,1<c&&(h.result+=" #".concat(S+1));case 76:S++,e.next=69;break;case 79:this.sendResultMessage(h,n),e.next=85;break;case 82:e.prev=82,e.t2=e.catch(4),console.error(e.t2);case 85:case"end":return e.stop()}},e,this,[[4,82],[10,54,57,60],[28,39,42,45]])}))})}},{key:"onStoreRemoved",value:function(){u(v(n.prototype),"onStoreRemoved",this).call(this),Jb.unregister(this)}},{key:"sendResultMessage",value:function(e,t){var n=e.result,i=e.isSecret;if(!(n.length<1)){e.isDiceRollTable||(n=n.replace(/[\uff1e]/g,function(e){return"\u2192"}).trim());var r={identifier:"",tabIdentifier:t.tabIdentifier,originFrom:t.from,from:e.isDiceRollTable?"Dice-Roll Table":Ik.apiUrl?"BCDice-API(".concat(Ik.apiUrl,")"):"System-BCDice",timestamp:t.timestamp+1,imageIdentifier:"",tag:i?"system secret":"system",name:e.isDiceRollTable?i?"<"+e.tableName+" (Secret)\uff1a"+t.name+">":"<"+e.tableName+"\uff1a"+t.name+">":i?"<Secret-BCDice\uff1a"+t.name+">":"<BCDice\uff1a"+t.name+">",text:n,color:t.color,isUseStandImage:t.isUseStandImage};if(!i&&!t.standName&&t.isUseStandImage){var a=tk.instance.get(t.characterIdentifier);if(a instanceof jk){var o=a.standList.matchStandInfo(n,t.imageIdentifier);if(o.farewell){var s={characterIdentifier:a.identifier};if(t.to){var l=Rk.findByUserId(t.to);l&&(l.peerId!=Rk.myCursor.peerId&&Jb.call("FAREWELL_STAND_IMAGE",s,l.peerId),Jb.call("FAREWELL_STAND_IMAGE",s,Rk.myCursor.peerId))}else Jb.call("FAREWELL_STAND_IMAGE",s)}else if(o&&o.standElementIdentifier){var c=tk.instance.get(o.standElementIdentifier);if(c&&c.getFirstElementByName("conditionType")){var u=+c.getFirstElementByName("conditionType").value;if(u==Lk.Postfix||u==Lk.PostfixOrImage||u==Lk.PostfixAndImage){var h={characterIdentifier:a.identifier,standIdentifier:o.standElementIdentifier,color:t.color,secret:!!t.to};if(h.secret){var d=Rk.findByUserId(t.to);d&&(d.peerId!=Rk.myCursor.peerId&&Jb.call("POPUP_STAND_IMAGE",h,d.peerId),Jb.call("POPUP_STAND_IMAGE",h,Rk.myCursor.peerId))}else Jb.call("POPUP_STAND_IMAGE",h)}}}o.matchMostLongText&&r.text&&(r.text=r.text.slice(0,r.text.length-o.matchMostLongText.length))}}null!=t.to&&0<t.to.length&&(r.to=t.to,t.to.indexOf(t.from)<0&&(r.to+=" "+t.from));var f=tk.instance.get(t.tabIdentifier);f&&f.addMessage(r)}}}],[{key:"diceRollAsync",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(Ik.apiUrl){for(var i=Ik.apiUrl+"/v1/diceroll?system="+(t?encodeURIComponent(t):"DiceBot")+"&command="+encodeURIComponent(e),r=[],a=function(e){r.push(fetch(i,{mode:"cors"}).then(function(e){if(e.ok)return e.json();throw new Error(e.statusText)}).then(function(i){return{result:(t||"DiceBot")+i.result+(n>1?" #".concat(e,"\n"):""),isSecret:i.secret}}).catch(function(e){return{result:"",isSecret:!1}}))},o=1;o<=n;o++)a(o);return Ik.queue.add(Promise.all(r).then(function(e){return e.reduce(function(e,t){return{result:e.result+t.result,isSecret:e.isSecret||t.isSecret}},{result:"",isSecret:!1})}))}return Ik.queue.add(Ik.loadDiceBotAsync(t)),Ik.queue.add(function(){if("Opal"in window==0)return console.warn("Opal is not loaded..."),{result:"",isSecret:!1};var n=[];try{Opal.gvars.isDebug=!1;var i=Opal.CgiDiceBot.$new();return n=i.$roll(e,t,[],"diceBotTable_",!0),console.log("diceRoll!!!",n),console.log("isSecret!!!",i.isSecret),{result:n[0],isSecret:i.isSecret}}catch(r){console.error(r)}return{result:"",isSecret:!1}})}},{key:"getHelpMessage",value:function(e){if(Ik.apiUrl){var t=[fetch(Ik.apiUrl+"/v1/systeminfo?system=DiceBot",{mode:"cors"}).then(function(e){return e.json()})];return e&&"DiceBot"!=e&&t.push(fetch(Ik.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(e),{mode:"cors"}).then(function(e){return e.json()})),Promise.all(t).then(function(e){return e.map(function(e){return e.systeminfo&&e.systeminfo.info?e.systeminfo.info.replace("\u3053\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306f\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d\u8868\u793a\u7528\u3068\u306a\u308a\u307e\u3059","\u3053\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306f\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d\u8868\u793a\u7528\u3068\u306a\u308a\u307e\u3059"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"})})}return Ik.queue.add(Ik.loadDiceBotAsync(e)),Ik.queue.add(function(){if("Opal"in window==0)return console.warn("Opal is not loaded..."),"";var t=["\u3010\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3011\u30c1\u30e3\u30c3\u30c8\u306b\u30c0\u30a4\u30b9\u7528\u306e\u6587\u5b57\u3092\u5165\u529b\u3059\u308b\u3068\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304c\u53ef\u80fd\n\u5165\u529b\u4f8b\uff09\uff12\uff44\uff16\uff0b\uff11\u3000\u653b\u6483\uff01\n\u51fa\u529b\u4f8b\uff092d6+1\u3000\u653b\u6483\uff01\n\u3000\u3000\u3000\u3000  diceBot: (2d6) \u2192 7\n\u4e0a\u8a18\u306e\u3088\u3046\u306b\u30c0\u30a4\u30b9\u6587\u5b57\u306e\u5f8c\u308d\u306b\u7a7a\u767d\u3092\u5165\u308c\u3066\u767a\u8a00\u3059\u308b\u4e8b\u3082\u53ef\u80fd\u3002\n\u4ee5\u4e0b\u3001\u4f7f\u7528\u4f8b\n\u30003D6+1>=9 \uff1a3d6+1\u3067\u76ee\u6a19\u50249\u4ee5\u4e0a\u304b\u306e\u5224\u5b9a\n\u30001D100<=50 \uff1aD100\u306750\uff05\u76ee\u6a19\u306e\u4e0b\u65b9\u30ed\u30fc\u30eb\u306e\u4f8b\n\u30003U6[5] \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u304c5\u4ee5\u4e0a\u306e\u5834\u5408\u306b\u632f\u308a\u8db3\u3057\u3057\u3066\u5408\u8a08\u3059\u308b(\u4e0a\u65b9\u7121\u9650)\n\u30003B6 \uff1a3d6\u306e\u30c0\u30a4\u30b9\u76ee\u3092\u30d0\u30e9\u30d0\u30e9\u306e\u307e\u307e\u51fa\u529b\u3059\u308b\uff08\u5408\u8a08\u3057\u306a\u3044\uff09\n\u300010B6>=4 \uff1a10d6\u3092\u632f\u308a4\u4ee5\u4e0a\u306e\u30c0\u30a4\u30b9\u76ee\u306e\u500b\u6570\u3092\u6570\u3048\u308b\n\u3000(8/2)D(4+6)<=(5*3)\uff1a\u500b\u6570\u30fb\u30c0\u30a4\u30b9\u30fb\u9054\u6210\u5024\u306b\u306f\u56db\u5247\u6f14\u7b97\u3082\u4f7f\u7528\u53ef\u80fd\n\u3000C(10-4*3/2+2)\uff1aC(\u8a08\u7b97\u5f0f\uff09\u3067\u8a08\u7b97\u3060\u3051\u306e\u5b9f\u884c\u3082\u53ef\u80fd\n\u3000choice[a,b,c]\uff1a\u5217\u6319\u3057\u305f\u8981\u7d20\u304b\u3089\u4e00\u3064\u3092\u9078\u629e\u8868\u793a\u3002\u30e9\u30f3\u30c0\u30e0\u653b\u6483\u5bfe\u8c61\u6c7a\u5b9a\u306a\u3069\u306b\n\u3000S3d6 \uff1a \u5404\u30b3\u30de\u30f3\u30c9\u306e\u5148\u982d\u306b\u300cS\u300d\u3092\u4ed8\u3051\u308b\u3068\u4ed6\u4eba\u306b\u7d50\u679c\u306e\u898b\u3048\u306a\u3044\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30ed\u30fc\u30eb\n\u30003d6/2 \uff1a \u30c0\u30a4\u30b9\u51fa\u76ee\u3092\u5272\u308a\u7b97\uff08\u5207\u308a\u6368\u3066\uff09\u3002\u5207\u308a\u4e0a\u3052\u306f /2U\u3001\u56db\u6368\u4e94\u5165\u306f /2R\u3002\n\u3000D66 \uff1a D66\u30c0\u30a4\u30b9\u3002\u9806\u5e8f\u306f\u30b2\u30fc\u30e0\u306b\u4f9d\u5b58\u3002D66N\uff1a\u305d\u306e\u307e\u307e\u3001D66S\uff1a\u6607\u9806\u3002"];try{var n=Opal.CgiDiceBot.$new().$newBcDice();n.$setGameByTitle(e);var i=n.diceBot.$getHelpMessage();i&&t.push(i)}catch(r){console.error(r)}return t})}},{key:"loadDiceBotAsync",value:function(e){return new Promise(function(t,n){if(console.log("loadDiceBotAsync"),!(e=e.replace(/\./g,function(e){return"_"}))&&e.length<1||Ik.loadedDiceBots[e])return console.log(e+" is loaded"),void t();Ik.loadedDiceBots[e]=!1;var i=[];i.push(Ik.loadScriptAsync("./assets/dicebot/"+e+".js"));var r,o=a(Ik.extratablesTables);try{for(o.s();!(r=o.n()).done;){var s=r.value;s.indexOf(e)||i.push(Ik.loadExtratablesAsync("./assets/extratables/"+s,s))}}catch(l){o.e(l)}finally{o.f()}Promise.all(i).then(function(){Ik.loadedDiceBots[e]=!0,t()})})}},{key:"loadScriptAsync",value:function(e){return new Promise(function(t,n){var i=document.head,r=document.createElement("script");r.src=e,i.appendChild(r),r.onload=function(n){i&&r.parentNode&&i.removeChild(r),console.log(e+" is loading OK!!!"),t()},r.onabort=r.onerror=function(e){i&&r.parentNode&&i.removeChild(r),console.error(e),t()}})}},{key:"loadExtratablesAsync",value:function(e,t){return new Promise(function(n,i){fetch(e).then(function(e){if(e.ok)return e.text();throw new Error("Network response was not ok.")}).then(function(e){var i=/((.+)_(.+)).txt$/gi.exec(t);Opal.TableFileData.$setVirtualTableData(i[1],i[2],i[3],e),console.log(t+" is loading OK!!!"),n()}).catch(function(e){console.warn("There has been a problem with your fetch operation: ",e.message),n()})})}}]),n}(ck)).loadedDiceBots={},Ak.queue=new vk("DiceBotQueue"),Ak.apiUrl=null,Ak.adminUrl=null,Ak.diceBotInfos=[{script:"EarthDawn",game:"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3"},{script:"EarthDawn3",game:"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248"},{script:"EarthDawn4",game:"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248"},{script:"Airgetlamh",game:"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0"},{script:"AFF2e",game:"ADVANCED FIGHTING FANTASY 2nd Edition"},{script:"AnimaAnimus",game:"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9"},{script:"Amadeus",game:"\u30a2\u30de\u30c7\u30a6\u30b9"},{script:"Arianrhod",game:"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG"},{script:"OrgaRain",game:"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"},{script:"Alshard",game:"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9"},{script:"ArsMagica",game:"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab"},{script:"AlterRaise",game:"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"},{script:"IthaWenUa",game:"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc"},{script:"YearZeroEngine",game:"YearZeroEngine"},{script:"Insane",game:"\u30a4\u30f3\u30bb\u30a4\u30f3"},{script:"VampireTheMasquerade5th",game:"Vampire: The Masquerade 5th Edition"},{script:"WitchQuest",game:"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8"},{script:"Warhammer",game:"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc"},{script:"Utakaze",game:"\u30a6\u30bf\u30ab\u30bc"},{script:"Alsetto",game:"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8"},{script:"AceKillerGene",game:"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3"},{script:"EclipsePhase",game:"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba"},{script:"EmbryoMachine",game:"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG"},{script:"Elysion",game:"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3"},{script:"Elric",game:"\u30a8\u30eb\u30ea\u30c3\u30af\uff01"},{script:"EndBreaker",game:"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01"},{script:"Oukahoushin3rd",game:"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248"},{script:"OracleEngine",game:"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3"},{script:"GardenOrder",game:"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc"},{script:"CardRanker",game:"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc"},{script:"Gurps",game:"\u30ac\u30fc\u30d7\u30b9"},{script:"GurpsFW",game:"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"},{script:"ChaosFlare",game:"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2"},{script:"OneWayHeroics",game:"\u7247\u9053\u52c7\u8005TRPG"},{script:"Kamigakari",game:"\u795e\u6211\u72e9"},{script:"Garako",game:"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854"},{script:"KanColle",game:"\u8266\u3053\u308cRPG"},{script:"Gundog",game:"\u30ac\u30f3\u30c9\u30c3\u30b0"},{script:"GundogZero",game:"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed"},{script:"GundogRevised",game:"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9"},{script:"KillDeathBusiness",game:"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9"},{script:"StellarKnights",game:"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4"},{script:"Cthulhu",game:"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"},{script:"CthulhuTech",game:"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af"},{script:"KurayamiCrying",game:"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3"},{script:"GranCrest",game:"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG"},{script:"GeishaGirlwithKatana",game:"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca"},{script:"GehennaAn",game:"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9"},{script:"KemonoNoMori",game:"\u7378\u30ce\u68ee"},{script:"Illusio",game:"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"},{script:"CodeLayerd",game:"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9"},{script:"Avandner",game:"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc"},{script:"GoblinSlayer",game:"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"},{script:"Gorilla",game:"\u30b4\u30ea\u30e9TRPG"},{script:"ColossalHunter",game:"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc"},{script:"Postman",game:"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"},{script:"Satasupe",game:"\u30b5\u30bf\u30b9\u30da"},{script:"SamsaraBallad",game:"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9"},{script:"SharedFantasia",game:"Shared\u2020Fantasia"},{script:"JamesBond",game:"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007"},{script:"LiveraDoll",game:"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"},{script:"ShinobiGami",game:"\u30b7\u30ce\u30d3\u30ac\u30df"},{script:"ShadowRun",game:"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3"},{script:"ShadowRun4",game:"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition"},{script:"ShadowRun5",game:"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition"},{script:"ShoujoTenrankai",game:"\u5c11\u5973\u5c55\u721b\u4f1aTRPG"},{script:"ShinkuuGakuen",game:"\u771f\u7a7a\u5b66\u5712"},{script:"Cthulhu7th",game:"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"},{script:"ShinMegamiTenseiKakuseihen",game:"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"},{script:"Skynauts",game:"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"},{script:"ScreamHighSchool",game:"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb"},{script:"SRS",game:"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0"},{script:"SteamPunkers",game:"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba"},{script:"SterileLife",game:"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG"},{script:"StratoShout",game:"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8"},{script:"TherapieSein",game:"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"},{script:"EtrianOdysseySRS",game:"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS"},{script:"ZettaiReido",game:"\u7d76\u5bfe\u96b7\u5974"},{script:"SevenFortressMobius",game:"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9"},{script:"Villaciel",game:"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb"},{script:"SwordWorld",game:"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG"},{script:"SwordWorld2_0",game:"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0"},{script:"SwordWorld2_5",game:"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5"},{script:"DarkSouls",game:"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG"},{script:"DarkDaysDrive",game:"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6"},{script:"DarkBlaze",game:"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba"},{script:"DiceOfTheDead",game:"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9"},{script:"DoubleCross",game:"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd, 3rd"},{script:"DungeonsAndDragons",game:"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba"},{script:"Paradiso",game:"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be"},{script:"StrangerOfSwordCity",game:"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG"},{script:"Chill",game:"Chill"},{script:"Chill3",game:"Chill 3rd Edition"},{script:"CrashWorld",game:"\u589c\u843d\u4e16\u754c"},{script:"DetatokoSaga",game:"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac"},{script:"DeadlineHeroes",game:"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG"},{script:"DemonParasite",game:"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8"},{script:"TokyoGhostResearch",game:"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1"},{script:"TokyoNova",game:"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA"},{script:"Torg",game:"\u30c8\u30fc\u30b0"},{script:"Torg1_5",game:"\u30c8\u30fc\u30b01.5\u7248"},{script:"TorgEternity",game:"TORG Eternity"},{script:"TokumeiTenkousei",game:"\u7279\u547d\u8ee2\u653b\u751f"},{script:"Dracurouge",game:"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5"},{script:"TrinitySeven",game:"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG"},{script:"TwilightGunsmoke",game:"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af"},{script:"TunnelsAndTrolls",game:"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba"},{script:"NightWizard",game:"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"},{script:"NightWizard3rd",game:"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition"},{script:"NightmareHunterDeep",game:"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc\uff1d\u30c7\u30a3\u30fc\u30d7"},{script:"NinjaSlayer",game:"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"},{script:"NjslyrBattle",game:"NJSLYRBATTLE"},{script:"Nuekagami",game:"\u9d7a\u93e1"},{script:"Nechronica",game:"\u30cd\u30af\u30ed\u30cb\u30ab"},{script:"NeverCloud",game:"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG"},{script:"HarnMaster",game:"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc"},{script:"Pathfinder",game:"Pathfinder"},{script:"BadLife",game:"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"},{script:"HatsuneMiku",game:"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3"},{script:"BattleTech",game:"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af"},{script:"ParasiteBlood",game:"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG"},{script:"Paranoia",game:"\u30d1\u30e9\u30ce\u30a4\u30a2"},{script:"ParanoiaRebooted",game:"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9"},{script:"BarnaKronika",game:"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab"},{script:"PulpCthulhu",game:"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5"},{script:"Raisondetre",game:"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb"},{script:"HuntersMoon",game:"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3"},{script:"Peekaboo",game:"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc"},{script:"BeastBindTrinity",game:"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3"},{script:"BBN",game:"BBNTRPG"},{script:"Hieizan",game:"\u6bd4\u53e1\u5c71\u708e\u4e0a"},{script:"BeginningIdol",game:"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb"},{script:"PhantasmAdventure",game:"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc"},{script:"Fiasco",game:"\u30d5\u30a3\u30a2\u30b9\u30b3"},{script:"FilledWith",game:"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"},{script:"FutariSousa",game:"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5"},{script:"BlindMythos",game:"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG"},{script:"BloodCrusade",game:"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9"},{script:"BloodMoon",game:"\u30d6\u30e9\u30c3\u30c9\u30fb\u30e0\u30fc\u30f3"},{script:"FullMetalPanic",game:"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG"},{script:"BladeOfArcana",game:"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca"},{script:"Strave",game:"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4"},{script:"Pendragon",game:"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3"},{script:"HouraiGakuen",game:"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!"},{script:"MagicaLogia",game:"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2"},{script:"InfiniteFantasia",game:"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2"},{script:"MeikyuKingdom",game:"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0"},{script:"MeikyuKingdomBasic",game:"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af"},{script:"MeikyuDays",game:"\u8ff7\u5bae\u30c7\u30a4\u30ba"},{script:"MetallicGuardian",game:"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG"},{script:"MetalHead",game:"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9"},{script:"MetalHeadExtream",game:"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0"},{script:"MonotoneMuseum",game:"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG"},{script:"YankeeYogSothoth",game:"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9"},{script:"GoldenSkyStories",game:"\u3086\u3046\u3084\u3051\u3053\u3084\u3051"},{script:"Ryutama",game:"\u308a\u3085\u3046\u305f\u307e"},{script:"RyuTuber",game:"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1"},{script:"RuneQuest",game:"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8"},{script:"RecordOfSteam",game:"Record of Steam"},{script:"RecordOfLodossWar",game:"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG"},{script:"RoleMaster",game:"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc"},{script:"LogHorizon",game:"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG"},{script:"RokumonSekai2",game:"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3"},{script:"LostRecord",game:"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9"},{script:"LostRoyal",game:"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb"},{script:"WaresBlade",game:"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9"},{script:"WARPS",game:"\u30ef\u30fc\u30d7\u30b9"},{script:"WorldOfDarkness",game:"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"},{script:"Cthulhu_ChineseTraditional",game:"\u514b\u8607\u9b6f\u7684\u547c\u559a",lang:"\u6b63\u9ad4\u4e2d\u6587"},{script:"Cthulhu7th_ChineseTraditional",game:"\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248",lang:"\u6b63\u9ad4\u4e2d\u6587"},{script:"KillDeathBusiness_Korean",game:"Kill Death Business (\ud55c\uad6d\uc5b4)",lang:"\ud55c\uad6d\uc5b4"},{script:"Nechronica_Korean",game:"\ub124\ud06c\ub85c\ub2c8\uce74",lang:"\ud55c\uad6d\uc5b4"},{script:"DoubleCross_Korean",game:"\ub354\ube14\ud06c\ub85c\uc2a42nd, 3rd",lang:"\ud55c\uad6d\uc5b4"},{script:"DetatokoSaga_Korean",game:"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00",lang:"\ud55c\uad6d\uc5b4"},{script:"FutariSousa_Korean",game:"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)",lang:"\ud55c\uad6d\uc5b4"},{script:"Dracurouge_Korean",game:"\ub4dc\ub77c\ud06c\ub8e8\uc8fc",lang:"\ud55c\uad6d\uc5b4"},{script:"LogHorizon_Korean",game:"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c",lang:"\ud55c\uad6d\uc5b4"},{script:"MonotoneMuseum_Korean",game:"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4",lang:"\ud55c\uad6d\uc5b4"},{script:"BeginningIdol_Korean",game:"\ube44\uae30\ub2dd \uc544\uc774\ub3cc",lang:"\ud55c\uad6d\uc5b4"},{script:"StratoShout_Korean",game:"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8",lang:"\ud55c\uad6d\uc5b4"},{script:"Amadeus_Korean",game:"\uc544\ub9c8\ub370\uc6b0\uc2a4",lang:"\ud55c\uad6d\uc5b4"},{script:"Insane_Korean",game:"\uc778\uc138\uc778",lang:"\ud55c\uad6d\uc5b4"},{script:"Kamigakari_Korean",game:"\uce74\ubbf8\uac00\uce74\ub9ac",lang:"\ud55c\uad6d\uc5b4"},{script:"Cthulhu7th_Korean",game:"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310",lang:"\ud55c\uad6d\uc5b4"},{script:"Cthulhu_Korean",game:"\ud06c\ud234\ub8e8",lang:"\ud55c\uad6d\uc5b4"},{script:"Fiasco_Korean",game:"\ud53c\uc544\uc2a4\ucf54",lang:"\ud55c\uad6d\uc5b4"}],Ak.diceBotInfosIndexed=[],Ak.extratablesTables=["BloodCrusade_TD2T.txt","BloodCrusade_TD3T.txt","BloodCrusade_TD4T.txt","BloodCrusade_TD5T.txt","BloodCrusade_TD6T.txt","BloodCrusade_TDHT.txt","BloodMoon_ID2T.txt","BloodMoon_IDT.txt","BloodMoon_RAT.txt","CardRanker_BFT.txt","CardRanker_CDT.txt","CardRanker_CST.txt","CardRanker_DT.txt","CardRanker_GDT.txt","CardRanker_OST.txt","CardRanker_SST.txt","CardRanker_ST.txt","CardRanker_TDT.txt","CardRanker_WT.txt","Elysion_EBT.txt","Elysion_GIT.txt","Elysion_HBT.txt","Elysion_HT.txt","Elysion_IT.txt","Elysion_JH.txt","Elysion_KT.txt","Elysion_NA.txt","Elysion_NT.txt","Elysion_OJ1.txt","Elysion_OJ2.txt","Elysion_TBT.txt","Elysion_UBT.txt","Elysion_UT1.txt","Elysion_UT2.txt","Elysion_UT3.txt","Elysion_UT4.txt","HuntersMoon_DS1ET.txt","HuntersMoon_DS2ET.txt","HuntersMoon_DS3ET.txt","HuntersMoon_EE1ET.txt","HuntersMoon_EE2ET.txt","HuntersMoon_EE3ET.txt","HuntersMoon_ERT.txt","HuntersMoon_ET1ET.txt","HuntersMoon_ET2ET.txt","HuntersMoon_ET3ET.txt","HuntersMoon_MST.txt","HuntersMoon_TK1ET.txt","HuntersMoon_TK2ET.txt","HuntersMoon_TK3ET.txt","Kamigakari_ET.txt","Kamigakari_KT.txt","Kamigakari_NT.txt","KanColle_BT2.txt","KanColle_BT3.txt","KanColle_BT4.txt","KanColle_BT5.txt","KanColle_BT6.txt","KanColle_BT7.txt","KanColle_BT8.txt","KanColle_BT9.txt","KanColle_BT10.txt","KanColle_BT11.txt","KanColle_BT12.txt","KanColle_ETIT.txt","KanColle_LFDT.txt","KanColle_LFVT.txt","KanColle_LSFT.txt","KanColle_WPCN.txt","KanColle_WPFA.txt","KanColle_WPMC.txt","KanColle_WPMCN.txt","KillDeathBusiness_ANSPT.txt","KillDeathBusiness_MASPT.txt","KillDeathBusiness_MOSPT.txt","KillDeathBusiness_PASPT.txt","KillDeathBusiness_POSPT.txt","KillDeathBusiness_UMSPT.txt","Oukahoushin3rd_BKT.txt","Oukahoushin3rd_KKT.txt","Oukahoushin3rd_NHT.txt","Oukahoushin3rd_SDT.txt","Oukahoushin3rd_SKT.txt","Oukahoushin3rd_STT.txt","Oukahoushin3rd_UKT.txt","ShinobiGami_AKST.txt","ShinobiGami_CLST.txt","ShinobiGami_DXST.txt","ShinobiGami_HC.txt","ShinobiGami_HK.txt","ShinobiGami_HLST.txt","ShinobiGami_HM.txt","ShinobiGami_HO.txt","ShinobiGami_HR.txt","ShinobiGami_HS.txt","ShinobiGami_HT.txt","ShinobiGami_HY.txt","ShinobiGami_NTST.txt","ShinobiGami_OTKRT.txt","ShinobiGami_PLST.txt","BloodCrusade_BDST.txt","BloodCrusade_CYST.txt","BloodCrusade_DMST.txt","BloodCrusade_MNST.txt","BloodCrusade_SLST.txt","BloodCrusade_TD1T.txt"],Ak.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a","\u514b\u8607\u9b6f\u7684\u547c\u559a"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","TORG"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","TORG 1.5\u7248"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a3\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],Ak=Ik=zm([fk("dice-bot")],Ak)),Wk=((Mk=function(){function e(t){y(this,e),this.componentFactoryResolver=t,this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.scrollablePanel=null}return k(e,[{key:"isShow",get:function(){return!!this.panelComponentRef}},{key:"open",value:function(t,n,i){var r;i||(i=e.defaultParentViewContainerRef);var a=i.injector,o=this.componentFactoryResolver.resolveComponentFactory(e.UIPanelComponentClass),s=this.componentFactoryResolver.resolveComponentFactory(t),l=(r=i.createComponent(o,i.length,a)).instance.content.createComponent(s),c=r.injector.get(e);return c.panelComponentRef=r,n&&(n.title&&(c.title=n.title),n.top&&(c.top=n.top),n.left&&(c.left=n.left),n.width&&(c.width=n.width),n.height&&(c.height=n.height)),r.onDestroy(function(){c.panelComponentRef=null}),l.instance}},{key:"close",value:function(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}]),e}()).UIPanelComponentClass=null,Mk.\u0275fac=function(e){return new(e||Mk)(wi(rl))},Mk.\u0275prov=Ae({token:Mk,factory:Mk.\u0275fac}),Mk),Gk=function(){function e(t,n,i){y(this,e),this._resolve=t,this._reject=n,this.option=i}return k(e,[{key:"resolve",value:function(e){this._resolve(e),this._resolve=null}},{key:"reject",value:function(e){this._reject(e),this._reject=null}}]),e}(),Zk=((Pk=function(){function e(t){y(this,e),this.componentFactoryResolver=t,this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}return k(e,[{key:"option",get:function(){return this.modalContext?this.modalContext.option:null}},{key:"isShow",get:function(){return this.count>0}},{key:"open",value:function(t,n,i){var r,a=this;return i||(i=e.defaultParentViewContainerRef),new Promise(function(o,s){var l=new e(a.componentFactoryResolver);l.modalContext=new Gk(function(e){r&&(r.destroy(),o(e),a.count--)},function(e){r&&(r.destroy(),s(e),a.count--)},n);var c=_o.create([{provide:e,useValue:l}],i.injector),u=a.componentFactoryResolver.resolveComponentFactory(e.ModalComponentClass),h=a.componentFactoryResolver.resolveComponentFactory(t);(r=i.createComponent(u,i.length,c)).instance.content.createComponent(h),r.onDestroy(function(){a.count--}),a.count++})}},{key:"resolve",value:function(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}},{key:"reject",value:function(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}]),e}()).ModalComponentClass=null,Pk.\u0275fac=function(e){return new(e||Pk)(wi(rl))},Pk.\u0275prov=Ae({token:Pk,factory:Pk.\u0275fac}),Pk),Yk=function(e){return{outer:e}};function qk(e,t){if(1&e&&(Zo(0,"div",5),zs(1),Zo(2,"span",6),zs(3),Yo(),zs(4),Zo(5,"span",7),zs(6),Yo(),Yo()),2&e){var n=is();sa(1),Bs("",n.urlObj.protocol,"//"),sa(1),Wo("ngClass",rc(6,Yk,n.isOuter)),sa(1),Ls(n.urlObj.host),sa(1),Ls(n.urlObj.pathname),sa(2),js("",n.urlObj.search,"",n.urlObj.hash,"")}}function Xk(e,t){if(1&e&&(Zo(0,"div",5),zs(1),Yo()),2&e){var n=is();sa(1),Ls(n.url)}}function Kk(e,t){1&e&&(Zo(0,"div"),zs(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),Yo())}function $k(e,t){1&e&&(Zo(0,"div"),zs(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),Yo())}var Qk,Jk=((Qk=function(){function e(t,n){y(this,e),this.panelService=t,this.modalService=n,this.url="",this.title="",this.subTitle="",this.url=n.option.url?n.option.url:"",this.title=n.option.title?n.option.title:"",this.subTitle=n.option.subTitle?n.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}return k(e,[{key:"isValid",get:function(){return gk.validUrl(this.url.trim())}},{key:"isOuter",get:function(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){var t="\u5916\u90e8URL\u3092\u958b\u304f";e.title?t+="\u3008"+e.title+(e.subTitle?"\uff1a".concat(e.subTitle):"")+"\u3009":e.subTitle&&(t+="\u3008".concat(e.subTitle,"\u3009")),e.modalService.title=e.panelService.title=t}),Jb.register(this)}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"openUrl",value:function(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}},{key:"cancel",value:function(){this.modalService.resolve(!1)}}]),e}()).\u0275fac=function(e){return new(e||Qk)(Vo(Wk),Vo(Zk))},Qk.\u0275cmp=ct({type:Qk,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,t){1&e&&(Zo(0,"div"),Uo(1,qk,7,8,"div",0),Uo(2,Xk,2,1,"div",0),qo(3,"hr"),Zo(4,"div",1),Uo(5,Kk,2,0,"div",2),Uo(6,$k,2,0,"div",2),Yo(),Yo(),Zo(7,"button",3),es("click",function(){return t.openUrl()}),zs(8,"\u958b\u304f"),Yo(),Zo(9,"button",4),es("click",function(){return t.cancel()}),zs(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),Yo()),2&e&&(sa(1),Wo("ngIf",t.isValid),sa(1),Wo("ngIf",!t.isValid),sa(3),Wo("ngIf",t.isValid),sa(1),Wo("ngIf",!t.isValid),sa(1),Wo("disabled",!t.isValid))},directives:[dh,lh],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:grey}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),Qk);function e_(e,t){if(Array.prototype.indexOf)return e.indexOf(t);for(var n=0,i=e.length;n<i;n++)if(e[n]===t)return n;return-1}function t_(e,t){for(var n=e.length-1;n>=0;n--)!0===t(e[n])&&e.splice(n,1)}function n_(e){throw new Error("Unhandled case for value: '"+e+"'")}var i_=function(){function e(e){void 0===e&&(e={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=e.tagName||"",this.attrs=e.attrs||{},this.innerHTML=e.innerHtml||e.innerHTML||""}return e.prototype.setTagName=function(e){return this.tagName=e,this},e.prototype.getTagName=function(){return this.tagName||""},e.prototype.setAttr=function(e,t){return this.getAttrs()[e]=t,this},e.prototype.getAttr=function(e){return this.getAttrs()[e]},e.prototype.setAttrs=function(e){return Object.assign(this.getAttrs(),e),this},e.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},e.prototype.setClass=function(e){return this.setAttr("class",e)},e.prototype.addClass=function(e){for(var t,n=this.getClass(),i=this.whitespaceRegex,r=n?n.split(i):[],a=e.split(i);t=a.shift();)-1===e_(r,t)&&r.push(t);return this.getAttrs().class=r.join(" "),this},e.prototype.removeClass=function(e){for(var t,n=this.getClass(),i=this.whitespaceRegex,r=n?n.split(i):[],a=e.split(i);r.length&&(t=a.shift());){var o=e_(r,t);-1!==o&&r.splice(o,1)}return this.getAttrs().class=r.join(" "),this},e.prototype.getClass=function(){return this.getAttrs().class||""},e.prototype.hasClass=function(e){return-1!==(" "+this.getClass()+" ").indexOf(" "+e+" ")},e.prototype.setInnerHTML=function(e){return this.innerHTML=e,this},e.prototype.setInnerHtml=function(e){return this.setInnerHTML(e)},e.prototype.getInnerHTML=function(){return this.innerHTML||""},e.prototype.getInnerHtml=function(){return this.getInnerHTML()},e.prototype.toAnchorString=function(){var e=this.getTagName(),t=this.buildAttrsStr();return["<",e,t=t?" "+t:"",">",this.getInnerHtml(),"</",e,">"].join("")},e.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var e=this.getAttrs(),t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+'="'+e[n]+'"');return t.join(" ")},e}(),r_=function(){function e(e){void 0===e&&(e={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=e.newWindow||!1,this.truncate=e.truncate||{},this.className=e.className||""}return e.prototype.build=function(e){return new i_({tagName:"a",attrs:this.createAttrs(e),innerHtml:this.processAnchorText(e.getAnchorText())})},e.prototype.createAttrs=function(e){var t={href:e.getAnchorHref()},n=this.createCssClass(e);return n&&(t.class=n),this.newWindow&&(t.target="_blank",t.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<e.getAnchorText().length&&(t.title=e.getAnchorHref()),t},e.prototype.createCssClass=function(e){var t=this.className;if(t){for(var n=[t],i=e.getCssClassSuffixes(),r=0,a=i.length;r<a;r++)n.push(t+"-"+i[r]);return n.join(" ")}return""},e.prototype.processAnchorText=function(e){return this.doTruncate(e)},e.prototype.doTruncate=function(e){var t=this.truncate;if(!t||!t.length)return e;var n=t.length,i=t.location;return"smart"===i?function(e,t,n){var i,r;null==n?(n="&hellip;",r=3,i=8):(r=n.length,i=n.length);var a=function(e){var t="";return e.scheme&&e.host&&(t+=e.scheme+"://"),e.host&&(t+=e.host),e.path&&(t+="/"+e.path),e.query&&(t+="?"+e.query),e.fragment&&(t+="#"+e.fragment),t},o=function(e,t){var i=t/2,r=Math.ceil(i),a=-1*Math.floor(i),o="";return a<0&&(o=e.substr(a)),e.substr(0,r)+n+o};if(e.length<=t)return e;var s=t-r,l=function(e){var t={},n=e,i=n.match(/^([a-z]+):\/\//i);return i&&(t.scheme=i[1],n=n.substr(i[0].length)),(i=n.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(t.host=i[1],n=n.substr(i[0].length)),(i=n.match(/^\/(.*?)(?=(\?|#|$))/i))&&(t.path=i[1],n=n.substr(i[0].length)),(i=n.match(/^\?(.*?)(?=(#|$))/i))&&(t.query=i[1],n=n.substr(i[0].length)),(i=n.match(/^#(.*?)$/i))&&(t.fragment=i[1]),t}(e);if(l.query){var c=l.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);c&&(l.query=l.query.substr(0,c[1].length),e=a(l))}if(e.length<=t)return e;if(l.host&&(l.host=l.host.replace(/^www\./,""),e=a(l)),e.length<=t)return e;var u="";if(l.host&&(u+=l.host),u.length>=s)return l.host.length==t?(l.host.substr(0,t-r)+n).substr(0,s+i):o(u,s).substr(0,s+i);var h="";if(l.path&&(h+="/"+l.path),l.query&&(h+="?"+l.query),h){if((u+h).length>=s)return(u+h).length==t?(u+h).substr(0,t):(u+o(h,s-u.length)).substr(0,s+i);u+=h}if(l.fragment){var d="#"+l.fragment;if((u+d).length>=s)return(u+d).length==t?(u+d).substr(0,t):(u+o(d,s-u.length)).substr(0,s+i);u+=d}if(l.scheme&&l.host){var f=l.scheme+"://";if((u+f).length<s)return(f+u).substr(0,t)}if(u.length<=t)return u;var p="";return s>0&&(p=u.substr(-1*Math.floor(s/2))),(u.substr(0,Math.ceil(s/2))+n+p).substr(0,s+i)}(e,n):"middle"===i?function(e,t,n){if(e.length<=t)return e;var i,r;null==n?(n="&hellip;",i=8,r=3):(i=n.length,r=n.length);var a=t-r,o="";return a>0&&(o=e.substr(-1*Math.floor(a/2))),(e.substr(0,Math.ceil(a/2))+n+o).substr(0,a+i)}(e,n):function(e,t,n){return function(e,t,n){var i;return e.length>t&&(null==n?(n="&hellip;",i=3):i=n.length,e=e.substring(0,t-i)+n),e}(e,t,void 0)}(e,n)},e}(),a_=function(){function e(e){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=e.tagBuilder,this.matchedText=e.matchedText,this.offset=e.offset}return e.prototype.getMatchedText=function(){return this.matchedText},e.prototype.setOffset=function(e){this.offset=e},e.prototype.getOffset=function(){return this.offset},e.prototype.getCssClassSuffixes=function(){return[this.getType()]},e.prototype.buildTag=function(){return this.tagBuilder.build(this)},e}(),o_=function(e,t){return(o_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function s_(e,t){function n(){this.constructor=e}o_(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l_,c_,u_,h_=function(){return(h_=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},d_=function(e){function t(t){var n=e.call(this,t)||this;return n.email="",n.email=t.email,n}return s_(t,e),t.prototype.getType=function(){return"email"},t.prototype.getEmail=function(){return this.email},t.prototype.getAnchorHref=function(){return"mailto:"+this.email},t.prototype.getAnchorText=function(){return this.email},t}(a_),f_=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="",n.hashtag="",n.serviceName=t.serviceName,n.hashtag=t.hashtag,n}return s_(t,e),t.prototype.getType=function(){return"hashtag"},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getHashtag=function(){return this.hashtag},t.prototype.getAnchorHref=function(){var e=this.serviceName,t=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+t;case"facebook":return"https://www.facebook.com/hashtag/"+t;case"instagram":return"https://instagram.com/explore/tags/"+t;default:throw new Error("Unknown service name to point hashtag to: "+e)}},t.prototype.getAnchorText=function(){return"#"+this.hashtag},t}(a_),p_=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.mention="",n.mention=t.mention,n.serviceName=t.serviceName,n}return s_(t,e),t.prototype.getType=function(){return"mention"},t.prototype.getMention=function(){return this.mention},t.prototype.getServiceName=function(){return this.serviceName},t.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},t.prototype.getAnchorText=function(){return"@"+this.mention},t.prototype.getCssClassSuffixes=function(){var t=e.prototype.getCssClassSuffixes.call(this),n=this.getServiceName();return n&&t.push(n),t},t}(a_),g_=function(e){function t(t){var n=e.call(this,t)||this;return n.number="",n.plusSign=!1,n.number=t.number,n.plusSign=t.plusSign,n}return s_(t,e),t.prototype.getType=function(){return"phone"},t.prototype.getPhoneNumber=function(){return this.number},t.prototype.getNumber=function(){return this.getPhoneNumber()},t.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},t.prototype.getAnchorText=function(){return this.matchedText},t}(a_),m_=function(e){function t(t){var n=e.call(this,t)||this;return n.url="",n.urlMatchType="scheme",n.protocolUrlMatch=!1,n.protocolRelativeMatch=!1,n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.schemePrefixRegex=/^(https?:\/\/)?/i,n.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,n.protocolRelativeRegex=/^\/\//,n.protocolPrepended=!1,n.urlMatchType=t.urlMatchType,n.url=t.url,n.protocolUrlMatch=t.protocolUrlMatch,n.protocolRelativeMatch=t.protocolRelativeMatch,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return s_(t,e),t.prototype.getType=function(){return"url"},t.prototype.getUrlMatchType=function(){return this.urlMatchType},t.prototype.getUrl=function(){var e=this.url;return this.protocolRelativeMatch||this.protocolUrlMatch||this.protocolPrepended||(e=this.url="http://"+e,this.protocolPrepended=!0),e},t.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},t.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},t.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},t.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},t.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},t.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},t.prototype.removePercentEncoding=function(e){var t=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(t)}catch(n){return t}},t}(a_),v_=function(e){this.__jsduckDummyDocProp=null,this.tagBuilder=e.tagBuilder},y_=/[A-Za-z]/,b_=/[\d]/,k_=/[\D]/,__=/\s/,w_=/['"]/,x_=/[\x00-\x1F\x7F]/,C_=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,E_=C_+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,S_=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,T_=E_+S_,O_=E_+S_,I_="(?:["+S_+"]{1,3}\\.){3}["+S_+"]{1,3}",M_="["+O_+"](?:["+O_+"\\-]{0,61}["+O_+"])?",A_=function(e){return"(?=("+M_+"))\\"+e},P_=function(e){return"(?:"+A_(e)+"(?:\\."+A_(e+1)+"){0,126}|"+I_+")"},D_=(new RegExp("["+O_+".\\-]*["+O_+"\\-]"),new RegExp("["+O_+"]")),R_=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbb9fbpob|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|spreadbetting|travelchannel|wolterskluwer|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|rightathome|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--estv75g|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--kpu716f|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pbt977c|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nationwide|newholland|nextdirect|onyourside|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|telefonica|university|vistaprint|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|fujixerox|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|honeywell|institute|insurance|kuokgroup|ladbrokes|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--tckwe|xn--vhquv|yodobashi|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|chrysler|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|esurance|etisalat|everbank|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|movistar|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|symantec|training|uconnect|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|cartier|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|iselect|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lancome|lanxess|lasalle|latrobe|leclerc|liaison|limited|lincoln|markets|metlife|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|shriram|singles|staples|starhub|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0645\u0648\u0628\u0627\u064a\u0644\u064a|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|active|africa|agency|airbus|airtel|alipay|alsace|alstom|anquan|aramco|author|bayern|beauty|berlin|bharti|blanco|bostik|boston|broker|camera|career|caseih|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|mobily|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|piaget|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|warman|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|dodge|drive|dubai|earth|edeka|email|epost|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|intel|irish|iveco|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|lupin|macys|mango|media|miami|money|mopar|movie|nadex|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|zippo|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|aigo|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|doha|duck|duns|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scor|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u5927\u4f17\u6c7d\u8f66|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bnl|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceb|ceo|cfa|cfd|com|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jcp|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|srl|srt|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5de5\u884c|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u624b\u8868|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u73e0\u5b9d|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,F_=new RegExp("["+O_+"!#$%&'*+/=?^_`{|}~-]"),N_=new RegExp("^"+R_.source+"$"),z_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.localPartCharRegex=F_,t.strictTldRegex=N_,t}return s_(t,e),t.prototype.parseMatches=function(e){for(var t=this.tagBuilder,n=this.localPartCharRegex,i=this.strictTldRegex,r=[],a=e.length,o=new L_,s={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},l=0,c=0,u=o;l<a;){var h=e.charAt(l);switch(c){case 0:"m"===(k=h)?_(1):n.test(k)&&_();break;case 1:y=e.charAt(l-1),b=h,":"===y?n.test(b)?(c=2,u=new L_(h_(h_({},u),{hasMailtoPrefix:!0}))):w():s[y]===b||(n.test(b)?c=2:"."===b?c=3:"@"===b?c=4:w());break;case 2:"."===(v=h)?c=3:"@"===v?c=4:n.test(v)||w();break;case 3:"."===(m=h)||"@"===m?w():n.test(m)?c=2:w();break;case 4:g=h,D_.test(g)?c=5:w();break;case 5:"."===(p=h)?c=7:"-"===p?c=6:D_.test(p)||x();break;case 6:"-"===(f=h)||"."===f?x():D_.test(f)?c=5:x();break;case 7:"."===(d=h)||"-"===d?x():D_.test(d)?(c=5,u=new L_(h_(h_({},u),{hasDomainDot:!0}))):x();break;default:n_(c)}l++}var d,f,p,g,m,v,y,b,k;return x(),r;function _(e){void 0===e&&(e=2),c=e,u=new L_({idx:l})}function w(){c=0,u=o}function x(){if(u.hasDomainDot){var n=e.slice(u.idx,l);/[-.]$/.test(n)&&(n=n.slice(0,-1));var a=u.hasMailtoPrefix?n.slice("mailto:".length):n;(function(e){var t=(e.split(".").pop()||"").toLowerCase();return i.test(t)})(a)&&r.push(new d_({tagBuilder:t,matchedText:n,offset:u.idx,email:a}))}w()}},t}(v_),L_=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.hasMailtoPrefix=!!e.hasMailtoPrefix,this.hasDomainDot=!!e.hasDomainDot},B_=function(){function e(){}return e.isValid=function(e,t){return!(t&&!this.isValidUriScheme(t)||this.urlMatchDoesNotHaveProtocolOrDot(e,t)||this.urlMatchDoesNotHaveAtLeastOneWordChar(e,t)&&!this.isValidIpAddress(e)||this.containsMultipleDots(e))},e.isValidIpAddress=function(e){var t=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==e.match(t)},e.containsMultipleDots=function(e){var t=e;return this.hasFullProtocolRegex.test(e)&&(t=e.split("://")[1]),t.split("/")[0].indexOf("..")>-1},e.isValidUriScheme=function(e){var t=e.match(this.uriSchemeRegex),n=t&&t[0].toLowerCase();return"javascript:"!==n&&"vbscript:"!==n},e.urlMatchDoesNotHaveProtocolOrDot=function(e,t){return!(!e||t&&this.hasFullProtocolRegex.test(t)||-1!==e.indexOf("."))},e.urlMatchDoesNotHaveAtLeastOneWordChar=function(e,t){return!(!e||!t||this.hasFullProtocolRegex.test(t)||this.hasWordCharAfterProtocolRegex.test(e))},e.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,e.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,e.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+C_+"]"),e.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,e}(),j_=(l_=new RegExp("[/?#](?:["+O_+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+O_+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,P_(2),")","|","(","(//)?",/(?:www\.)/.source,P_(6),")","|","(","(//)?",P_(10)+"\\.",R_.source,"(?![-"+T_+"])",")",")","(?::[0-9]+)?","(?:"+l_.source+")?"].join(""),"gi")),U_=new RegExp("["+O_+"]"),H_=function(e){function t(t){var n=e.call(this,t)||this;return n.stripPrefix={scheme:!0,www:!0},n.stripTrailingSlash=!0,n.decodePercentEncoding=!0,n.matcherRegex=j_,n.wordCharRegExp=U_,n.stripPrefix=t.stripPrefix,n.stripTrailingSlash=t.stripTrailingSlash,n.decodePercentEncoding=t.decodePercentEncoding,n}return s_(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.stripPrefix,r=this.stripTrailingSlash,a=this.decodePercentEncoding,o=this.tagBuilder,s=[],l=function(){var n=t[0],l=t[1],u=t[4],h=t.index,d=t[5]||t[9],f=e.charAt(h-1);if(!B_.isValid(n,l))return"continue";if(h>0&&"@"===f)return"continue";if(h>0&&d&&c.wordCharRegExp.test(f))return"continue";if(/\?$/.test(n)&&(n=n.substr(0,n.length-1)),c.matchHasUnbalancedClosingParen(n))n=n.substr(0,n.length-1);else{var p=c.matchHasInvalidCharAfterTld(n,l);p>-1&&(n=n.substr(0,p))}var g=["http://","https://"].find(function(e){return!!l&&-1!==l.indexOf(e)});if(g){var m=n.indexOf(g);n=n.substr(m),l=l.substr(m),h+=m}s.push(new m_({tagBuilder:o,matchedText:n,offset:h,urlMatchType:l?"scheme":u?"www":"tld",url:n,protocolUrlMatch:!!l,protocolRelativeMatch:!!d,stripPrefix:i,stripTrailingSlash:r,decodePercentEncoding:a}))},c=this;null!==(t=n.exec(e));)l();return s},t.prototype.matchHasUnbalancedClosingParen=function(e){var t,n=e.charAt(e.length-1);if(")"===n)t="(";else if("]"===n)t="[";else{if("}"!==n)return!1;t="{"}for(var i=0,r=0,a=e.length-1;r<a;r++){var o=e.charAt(r);o===t?i++:o===n&&(i=Math.max(i-1,0))}return 0===i},t.prototype.matchHasInvalidCharAfterTld=function(e,t){if(!e)return-1;var n=0;t&&(n=e.indexOf(":"),e=e.slice(n));var i=new RegExp("^((.?//)?[-."+O_+"]*[-"+O_+"]\\.[-"+O_+"]+)").exec(e);return null===i?-1:(n+=i[1].length,e=e.slice(i[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?n:-1)},t}(v_),V_=new RegExp("#[_"+O_+"]{1,139}(?![_"+O_+"])","g"),W_=new RegExp("[^"+O_+"]"),G_=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegex=V_,n.nonWordCharRegex=W_,n.serviceName=t.serviceName,n}return s_(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.nonWordCharRegex,r=this.serviceName,a=this.tagBuilder,o=[];null!==(t=n.exec(e));){var s=t.index,l=e.charAt(s-1);if(0===s||i.test(l)){var c=t[0],u=t[0].slice(1);o.push(new f_({tagBuilder:a,matchedText:c,offset:s,serviceName:r,hashtag:u}))}}return o},t}(v_),Z_=new RegExp(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source+"|"+/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source,"g"),Y_=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.matcherRegex=Z_,t}return s_(t,e),t.prototype.parseMatches=function(e){for(var t,n=this.matcherRegex,i=this.tagBuilder,r=[];null!==(t=n.exec(e));){var a=t[0],o=a.replace(/[^0-9,;#]/g,""),s=!(!t[1]&&!t[2]),l=0==t.index?"":e.substr(t.index-1,1),c=e.substr(t.index+a.length,1),u=!l.match(/\d/)&&!c.match(/\d/);this.testMatch(t[3])&&this.testMatch(a)&&u&&r.push(new g_({tagBuilder:i,matchedText:a,offset:t.index,number:o,plusSign:s}))}return r},t.prototype.testMatch=function(e){return k_.test(e)},t}(v_),q_=new RegExp("@[_"+O_+"]{1,50}(?![_"+O_+"])","g"),X_=new RegExp("@[_."+O_+"]{1,30}(?![_"+O_+"])","g"),K_=new RegExp("@[-_."+O_+"]{1,50}(?![-_"+O_+"])","g"),$_=new RegExp("[^"+O_+"]"),Q_=function(e){function t(t){var n=e.call(this,t)||this;return n.serviceName="twitter",n.matcherRegexes={twitter:q_,instagram:X_,soundcloud:K_},n.nonWordCharRegex=$_,n.serviceName=t.serviceName,n}return s_(t,e),t.prototype.parseMatches=function(e){var t,n=this.serviceName,i=this.matcherRegexes[this.serviceName],r=this.nonWordCharRegex,a=this.tagBuilder,o=[];if(!i)return o;for(;null!==(t=i.exec(e));){var s=t.index,l=e.charAt(s-1);if(0===s||r.test(l)){var c=t[0].replace(/\.+$/g,""),u=c.slice(1);o.push(new p_({tagBuilder:a,matchedText:c,offset:s,serviceName:n,mention:u}))}}return o},t}(v_),J_=function(e){void 0===e&&(e={}),this.idx=void 0!==e.idx?e.idx:-1,this.type=e.type||"tag",this.name=e.name||"",this.isOpening=!!e.isOpening,this.isClosing=!!e.isClosing},ew=function(){function e(t){void 0===t&&(t={}),this.version=e.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(t.urls),this.email="boolean"==typeof t.email?t.email:this.email,this.phone="boolean"==typeof t.phone?t.phone:this.phone,this.hashtag=t.hashtag||this.hashtag,this.mention=t.mention||this.mention,this.newWindow="boolean"==typeof t.newWindow?t.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(t.stripPrefix),this.stripTrailingSlash="boolean"==typeof t.stripTrailingSlash?t.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof t.decodePercentEncoding?t.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=t.sanitizeHtml||!1;var n=this.mention;if(!1!==n&&"twitter"!==n&&"instagram"!==n&&"soundcloud"!==n)throw new Error("invalid `mention` cfg - see docs");var i=this.hashtag;if(!1!==i&&"twitter"!==i&&"facebook"!==i&&"instagram"!==i)throw new Error("invalid `hashtag` cfg - see docs");this.truncate=this.normalizeTruncateCfg(t.truncate),this.className=t.className||this.className,this.replaceFn=t.replaceFn||this.replaceFn,this.context=t.context||this}return e.link=function(t,n){return new e(n).link(t)},e.parse=function(t,n){return new e(n).parse(t)},e.prototype.normalizeUrlsCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{schemeMatches:e,wwwMatches:e,tldMatches:e}:{schemeMatches:"boolean"!=typeof e.schemeMatches||e.schemeMatches,wwwMatches:"boolean"!=typeof e.wwwMatches||e.wwwMatches,tldMatches:"boolean"!=typeof e.tldMatches||e.tldMatches}},e.prototype.normalizeStripPrefixCfg=function(e){return null==e&&(e=!0),"boolean"==typeof e?{scheme:e,www:e}:{scheme:"boolean"!=typeof e.scheme||e.scheme,www:"boolean"!=typeof e.www||e.www}},e.prototype.normalizeTruncateCfg=function(e){return"number"==typeof e?{length:e,location:"end"}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&void 0===e[n]&&(e[n]=t[n]);return e}(e||{},{length:Number.POSITIVE_INFINITY,location:"end"})},e.prototype.parse=function(e){var t=this,n=["a","style","script"],i=0,r=[];return function(e,t){for(var n,i=t.onOpenTag,r=t.onCloseTag,a=t.onText,o=t.onComment,s=t.onDoctype,l=new J_,c=0,u=e.length,h=0,d=0,f=l;c<u;){var p=e.charAt(c);switch(h){case 0:"<"===p&&M();break;case 1:"!"===(O=p)?h=13:"/"===O?(h=2,f=new J_(h_(h_({},f),{isClosing:!0}))):"<"===O?M():y_.test(O)?(h=3,f=new J_(h_(h_({},f),{isOpening:!0}))):(h=0,f=l);break;case 2:">"===(T=p)?I():y_.test(T)?h=3:I();break;case 3:S=p,__.test(S)?(f=new J_(h_(h_({},f),{name:P()})),h=4):"<"===S?M():"/"===S?(f=new J_(h_(h_({},f),{name:P()})),h=12):">"===S?(f=new J_(h_(h_({},f),{name:P()})),A()):y_.test(S)||b_.test(S)||":"===S||I();break;case 4:E=p,__.test(E)||("/"===E?h=12:">"===E?A():"<"===E?M():"="===E||w_.test(E)||x_.test(E)?I():h=5);break;case 5:C=p,__.test(C)?h=6:"/"===C?h=12:"="===C?h=7:">"===C?A():"<"===C?M():w_.test(C)&&I();break;case 6:x=p,__.test(x)||("/"===x?h=12:"="===x?h=7:">"===x?A():"<"===x?M():w_.test(x)?I():h=5);break;case 7:w=p,__.test(w)||('"'===w?h=8:"'"===w?h=9:/[>=`]/.test(w)?I():"<"===w?M():h=10);break;case 8:'"'===p&&(h=11);break;case 9:"'"===p&&(h=11);break;case 10:_=p,__.test(_)?h=4:">"===_?A():"<"===_&&M();break;case 11:k=p,__.test(k)?h=4:"/"===k?h=12:">"===k?A():"<"===k?M():(h=4,c--);break;case 12:">"===p?(f=new J_(h_(h_({},f),{isClosing:!0})),A()):h=4;break;case 13:"--"===e.substr(c,2)?(c+=2,f=new J_(h_(h_({},f),{type:"comment"})),h=14):"DOCTYPE"===e.substr(c,7).toUpperCase()?(c+=7,f=new J_(h_(h_({},f),{type:"doctype"})),h=20):I();break;case 14:"-"===(b=p)?h=15:">"===b?I():h=16;break;case 15:"-"===(y=p)?h=18:">"===y?I():h=16;break;case 16:"-"===p&&(h=17);break;case 17:h="-"===p?18:16;break;case 18:">"===(v=p)?A():"!"===v?h=19:"-"===v||(h=16);break;case 19:"-"===(m=p)?h=17:">"===m?A():h=16;break;case 20:">"===(g=p)?A():"<"===g&&M();break;default:n_(h)}c++}var g,m,v,y,b,k,_,w,x,C,E,S,T,O;function I(){h=0,f=l}function M(){h=1,f=new J_({idx:c})}function A(){var t=e.slice(d,f.idx);t&&a(t,d),"comment"===f.type?o(f.idx):"doctype"===f.type?s(f.idx):(f.isOpening&&i(f.name,f.idx),f.isClosing&&r(f.name,f.idx)),I(),d=c+1}function P(){return e.slice(f.idx+(f.isClosing?2:1),c).toLowerCase()}d<c&&(n=e.slice(d,c),a(n,d),d=c+1)}(e,{onOpenTag:function(e){n.indexOf(e)>=0&&i++},onText:function(e,n){if(0===i){var a=function(e,t){if(!t.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var n,i=[],r=0;n=t.exec(e);)i.push(e.substring(r,n.index)),i.push(n[0]),r=n.index+n[0].length;return i.push(e.substring(r)),i}(e,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),o=n;a.forEach(function(e,n){if(n%2==0){var i=t.parseText(e,o);r.push.apply(r,i)}o+=e.length})}},onCloseTag:function(e){n.indexOf(e)>=0&&(i=Math.max(i-1,0))},onComment:function(e){},onDoctype:function(e){}}),r=this.compactMatches(r),r=this.removeUnwantedMatches(r)},e.prototype.compactMatches=function(e){e.sort(function(e,t){return e.getOffset()-t.getOffset()});for(var t=0;t<e.length-1;t++){var n=e[t],i=n.getOffset(),r=n.getMatchedText().length,a=i+r;if(t+1<e.length){if(e[t+1].getOffset()===i){var o=e[t+1].getMatchedText().length>r?t:t+1;e.splice(o,1);continue}e[t+1].getOffset()<a&&e.splice(t+1,1)}}return e},e.prototype.removeUnwantedMatches=function(e){return this.hashtag||t_(e,function(e){return"hashtag"===e.getType()}),this.email||t_(e,function(e){return"email"===e.getType()}),this.phone||t_(e,function(e){return"phone"===e.getType()}),this.mention||t_(e,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||t_(e,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||t_(e,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||t_(e,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),e},e.prototype.parseText=function(e,t){void 0===t&&(t=0),t=t||0;for(var n=this.getMatchers(),i=[],r=0,a=n.length;r<a;r++){for(var o=n[r].parseMatches(e),s=0,l=o.length;s<l;s++)o[s].setOffset(t+o[s].getOffset());i.push.apply(i,o)}return i},e.prototype.link=function(e){if(!e)return"";this.sanitizeHtml&&(e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var t=this.parse(e),n=[],i=0,r=0,a=t.length;r<a;r++){var o=t[r];n.push(e.substring(i,o.getOffset())),n.push(this.createMatchReturnVal(o)),i=o.getOffset()+o.getMatchedText().length}return n.push(e.substring(i)),n.join("")},e.prototype.createMatchReturnVal=function(e){var t;return this.replaceFn&&(t=this.replaceFn.call(this.context,e)),"string"==typeof t?t:!1===t?e.getMatchedText():t instanceof i_?t.toAnchorString():e.buildTag().toAnchorString()},e.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var e=this.getTagBuilder(),t=[new G_({tagBuilder:e,serviceName:this.hashtag}),new z_({tagBuilder:e}),new Y_({tagBuilder:e}),new Q_({tagBuilder:e,serviceName:this.mention}),new H_({tagBuilder:e,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=t},e.prototype.getTagBuilder=function(){var e=this.tagBuilder;return e||(e=this.tagBuilder=new r_({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),e},e.version="3.14.3",e.AnchorTagBuilder=r_,e.HtmlTag=i_,e.matcher={Email:z_,Hashtag:G_,Matcher:v_,Mention:Q_,Phone:Y_,Url:H_},e.match={Email:d_,Hashtag:f_,Match:a_,Mention:p_,Phone:g_,Url:m_},e}(),tw=((u_=function(){function e(){y(this,e)}return k(e,[{key:"transform",value:function(e,t){return ew.link(e,t)}}]),e}()).\u0275fac=function(e){return new(e||u_)},u_.\u0275pipe=vt({name:"linky",type:u_,pure:!0}),u_),nw=((c_=function e(){y(this,e)}).\u0275fac=function(e){return new(e||c_)},c_.\u0275mod=pt({type:c_}),c_.\u0275inj=Pe({}),c_),iw=["message"];function rw(e,t){if(1&e&&(Zo(0,"span"),Zo(1,"pre",1),zs(2),Yo(),Yo()),2&e){var n=is();sa(2),Ls(n.text)}}function aw(e,t){1&e&&qo(0,"hr")}var ow=function(){return{schemeMatches:!0,wwwMatches:!0,tldMatches:!1}},sw=function(e){return{urls:e,decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1}};function lw(e,t){if(1&e&&(Zo(0,"pre",1),qo(1,"span",3,4),hc(3,"linky"),Uo(4,aw,1,0,"hr",0),Yo()),2&e){var n=t.$implicit,i=t.last,r=is(2);sa(1),Wo("innerHTML",dc(3,2,r.stringUtil.escapeHtml(n),rc(6,sw,ic(5,ow))),hr),sa(3),Wo("ngIf",!i)}}function cw(e,t){if(1&e&&(Zo(0,"span"),Uo(1,lw,5,8,"pre",2),Yo()),2&e){var n=is();sa(1),Wo("ngForOf",n.text)}}var uw,hw,dw,fw,pw,gw,mw,vw,yw,bw,kw,_w=((uw=function(){function e(t,n){y(this,e),this.panelService=t,this.modalService=n,this.text="",this.title="",this.stringUtil=gk}return k(e,[{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){e.panelService.title=e.title,e.modalService.option&&null!=e.modalService.option.title&&(e.modalService.title=e.modalService.option.title?e.modalService.option.title:"",e.text=e.modalService.option.text?e.modalService.option.text:"")})}},{key:"ngAfterViewInit",value:function(){var e=this;this.messageElm&&this.messageElm.nativeElement.querySelectorAll("A[href]").forEach(function(t){var n=t.getAttribute("href");gk.validUrl(n)?gk.sameOrigin(n)||(t.classList.add("outer-link"),t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.modalService.open(Jk,{url:n})},!0)):(t.removeAttribute("href"),t.removeAttribute("target"))})}},{key:"isObj",value:function(e){return"object"==typeof e}}]),e}()).\u0275fac=function(e){return new(e||uw)(Vo(Wk),Vo(Zk))},uw.\u0275cmp=ct({type:uw,selectors:[["text-view"]],viewQuery:function(e,t){var n;1&e&&Sc(iw,1),2&e&&Ec(n=Tc())&&(t.messageElm=n.first)},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML"],["message",""]],template:function(e,t){1&e&&(Uo(0,rw,3,1,"span",0),Uo(1,cw,2,1,"span",0)),2&e&&(Wo("ngIf",!t.isObj(t.text)),sa(1),Wo("ngIf",t.isObj(t.text)))},directives:[dh,uh],pipes:[tw],styles:[".text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0}"]}),uw),ww={name:"",disabled:!0,type:(hw={},hw.ACTION="action",hw.SEPARATOR="separator",hw).SEPARATOR},xw=((dw=function(){function e(t){y(this,e),this.componentFactoryResolver=t,this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=Rk.CHAT_DEFAULT_COLOR,this.titleBold=!1}return k(e,[{key:"isShow",get:function(){return!!this.panelComponentRef}},{key:"open",value:function(t,n,i,r,a,o){var s;this.close(),r||(r=e.defaultParentViewContainerRef,console.log("Context Open"));var l=r.injector,c=this.componentFactoryResolver.resolveComponentFactory(e.ContextMenuComponentClass),u=(s=r.createComponent(c,r.length,l)).injector.get(e);u.panelComponentRef=s,n&&(u.actions=n),t&&(u.position.x=t.x,u.position.y=t.y),u.titleColor=a||Rk.CHAT_DEFAULT_COLOR,u.titleBold=o,u.title=null!=i?i:"",s.onDestroy(function(){u.panelComponentRef=null})}},{key:"close",value:function(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}]),e}()).ContextMenuComponentClass=null,dw.\u0275fac=function(e){return new(e||dw)(wi(rl))},dw.\u0275prov=Ae({token:dw,factory:dw.\u0275fac}),dw),Cw=function(e){return e[e.NULL=0]="NULL",e[e.THUMBNAIL=1]="THUMBNAIL",e[e.COMPLETE=2]="COMPLETE",e[e.URL=1e3]="URL",e}({}),Ew=function(){function e(){y(this,e),this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}return k(e,[{key:"identifier",get:function(){return this.context.identifier}},{key:"name",get:function(){return this.context.name}},{key:"blob",get:function(){return this.context.blob}},{key:"url",get:function(){return this.context.url}},{key:"isReady",get:function(){return Cw.NULL<this.state}},{key:"state",get:function(){return this.url||this.blob?this.url&&!this.blob?Cw.URL:Cw.COMPLETE:Cw.NULL}},{key:"destroy",value:function(){this.revokeURLs()}},{key:"apply",value:function(e){!this.context.identifier&&e.identifier&&(this.context.identifier=e.identifier),e.name&&(this.context.name=e.name),!this.context.blob&&e.blob&&(this.context.blob=e.blob),!this.context.type&&e.type&&(this.context.type=e.type),!this.context.url&&e.url&&(this.state!==Cw.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=e.url),this.createURLs()}},{key:"createURLs",value:function(){this.state!==Cw.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}},{key:"revokeURLs",value:function(){this.state!==Cw.URL&&window.URL.revokeObjectURL(this.context.url)}},{key:"toContext",value:function(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}],[{key:"createEmpty",value:function(t){var n=new e;return n.context.identifier=t,n}},{key:"create",value:function(t){if("string"==typeof t){var n=new e;return n.context.identifier=t,n.context.name=t,n.context.url=t,n}var i=new e;return i.apply(t),i}},{key:"createAsync",value:function(t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(!(t instanceof File)){n.next=6;break}return n.next=3,e._createAsync(t,t.name);case 3:n.t0=n.sent,n.next=14;break;case 6:if(!(t instanceof Blob)){n.next=12;break}return n.next=9,e._createAsync(t);case 9:n.t1=n.sent,n.next=13;break;case 12:n.t1=void 0;case 13:n.t0=n.t1;case 14:return n.abrupt("return",n.t0);case 15:case"end":return n.stop()}},n)}))}},{key:"_createAsync",value:function(t,n){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,Bm.readAsArrayBufferAsync(t);case 2:return r=i.sent,a=new e,i.next=6,Bm.calcSHA256Async(r);case 6:return a.context.identifier=i.sent,a.context.name=n,a.context.blob=new Blob([r],{type:t.type}),a.context.type=a.context.blob.type,a.context.url=window.URL.createObjectURL(a.context.blob),a.context.name||(a.context.name=a.context.identifier),i.abrupt("return",a);case 13:case"end":return i.stop()}},i)}))}}]),e}(),Sw=function(e){return e[e.MASTER=0]="MASTER",e[e.AUDITION=1]="AUDITION",e}({}),Tw=((fw=function(){function e(t){y(this,e),this.volumeType=Sw.MASTER,this.audio=t}return k(e,[{key:"audioElm",get:function(){var e=this;return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=function(){},this._audioElm.onpause=function(){e.mediaElementSource.disconnect()},this._audioElm.onended=function(){e.mediaElementSource.disconnect()}),this._audioElm}},{key:"mediaElementSource",get:function(){return this._mediaElementSource||(this._mediaElementSource=e.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}},{key:"volume",get:function(){return this.audioElm.volume},set:function(e){this.audioElm.volume=e}},{key:"loop",get:function(){return this.audioElm.loop},set:function(e){this.audioElm.loop=e}},{key:"paused",get:function(){return this.audioElm.paused}},{key:"play",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.audio;if(this.stop(),this.audio=t,this.audio){var n=this.audio.url;t.state===Cw.URL&&(e.cacheMap.has(t.identifier)?n=e.cacheMap.get(t.identifier).url:e.createCacheAsync(t)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=n,this.audioElm.load(),this.audioElm.play().catch(function(e){console.warn(e)})}}},{key:"pause",value:function(){this.audioElm.pause()}},{key:"stop",value:function(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}},{key:"getConnectingAudioNode",value:function(){switch(this.volumeType){case Sw.AUDITION:return e.auditionNode;default:return e.rootNode}}}],[{key:"audioContext",get:function(){return e._audioContext||(e._audioContext=new(window.AudioContext||window.webkitAudioContext)),e._audioContext}},{key:"volume",get:function(){return e._volume},set:function(t){e._volume=t,e.masterGainNode.gain.setTargetAtTime(e._volume,e.audioContext.currentTime,.01)}},{key:"auditionVolume",get:function(){return e._auditionVolume},set:function(t){e._auditionVolume=t,e.auditionGainNode.gain.setTargetAtTime(e._auditionVolume,e.audioContext.currentTime,.01)}},{key:"masterGainNode",get:function(){if(!e._masterGainNode){var t=e.audioContext.createGain();t.gain.setValueAtTime(e._volume,e.audioContext.currentTime),t.connect(e.audioContext.destination),e._masterGainNode=t}return e._masterGainNode}},{key:"auditionGainNode",get:function(){if(!e._auditionGainNode){var t=e.audioContext.createGain();t.gain.setValueAtTime(e._auditionVolume,e.audioContext.currentTime),t.connect(e.audioContext.destination),e._auditionGainNode=t}return e._auditionGainNode}},{key:"rootNode",get:function(){return e.masterGainNode}},{key:"auditionNode",get:function(){return e.auditionGainNode}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.playBufferAsync(e,t)}},{key:"playBufferAsync",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,a;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,e.createBufferSourceAsync(t);case 2:if(r=i.sent){i.next=5;break}return i.abrupt("return");case 5:(a=e.audioContext.createGain()).gain.setValueAtTime(n,e.audioContext.currentTime),a.connect(e.rootNode),r.connect(a),r.onended=function(){r.stop(),r.disconnect(),a.disconnect(),r.buffer=null},r.start();case 7:case"end":return i.stop()}},i)}))}},{key:"createBufferSourceAsync",value:function(t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,a,o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=2;break}return n.abrupt("return",null);case 2:if(n.prev=2,i=t.blob,t.state!==Cw.URL){n.next=13;break}if(!e.cacheMap.has(t.identifier)){n.next=9;break}i=e.cacheMap.get(t.identifier).blob,n.next=13;break;case 9:return n.next=11,e.createCacheAsync(t);case 11:r=n.sent,i=r&&r.blob?r.blob:null;case 13:if(i){n.next=15;break}return n.abrupt("return",null);case 15:return n.next=17,this.decodeAudioDataAsync(i);case 17:return a=n.sent,o=e.audioContext.createBufferSource(),n.abrupt("return",(o.buffer=a,o));case 22:return n.prev=22,n.t0=n.catch(2),n.abrupt("return",(console.warn(n.t0),null));case 25:case"end":return n.stop()}},n,this,[[2,22]])}))}},{key:"decodeAudioDataAsync",value:function(t){var n=this;return new Promise(function(i,r){return Lm(n,void 0,void 0,regeneratorRuntime.mark(function n(){return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.t0=e.audioContext,n.next=3,Bm.readAsArrayBufferAsync(t);case 3:n.t1=n.sent,n.t2=function(e){return i(e)},n.t3=function(e){return r(e)},n.t0.decodeAudioData.call(n.t0,n.t1,n.t2,n.t3);case 7:case"end":return n.stop()}},n)}))})}},{key:"getBlobAsync",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.blob){t.next=2;break}return t.abrupt("return",e.blob);case 2:if(!(e.url.length<1)){t.next=4;break}throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");case 4:return t.prev=4,t.next=7,fetch(e.url);case 7:if((n=t.sent).ok){t.next=10;break}throw new Error("Network response was not ok.");case 10:return t.next=12,n.blob();case 12:return t.abrupt("return",t.sent);case 15:throw t.prev=15,t.t0=t.catch(4),console.warn("There has been a problem with your fetch operation: ",t.t0.message),t.t0;case 18:case"end":return t.stop()}},t,null,[[4,15]])}))}},{key:"createCacheAsync",value:function(t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return i={url:t.url,blob:null},n.prev=1,n.next=4,e.getBlobAsync(t);case 4:i.blob=n.sent,n.next=10;break;case 7:return n.prev=7,n.t0=n.catch(1),n.abrupt("return",(console.error(n.t0),i));case 10:return n.abrupt("return",e.cacheMap.has(t.identifier)?e.cacheMap.get(t.identifier):(i.url=URL.createObjectURL(i.blob),e.cacheMap.set(t.identifier,i),i));case 11:case"end":return n.stop()}},n,null,[[1,7]])}))}},{key:"resumeAudioContext",value:function(){e.audioContext.resume();var t=function t(){e.audioContext.resume(),document.removeEventListener("touchstart",t,!0),document.removeEventListener("mousedown",t,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",t,!0),document.addEventListener("mousedown",t,!0)}}]),e}())._volume=.5,fw._auditionVolume=.5,fw.cacheMap=new Map,fw),Ow=function(){function e(){y(this,e),this.hash={},console.log("AudioStorage ready...")}return k(e,[{key:"audios",get:function(){var e=[];for(var t in this.hash)e.push(this.hash[t]);return e}},{key:"destroy",value:function(){for(var e in this.hash)this.delete(e)}},{key:"addAsync",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ew.createAsync(e);case 2:return n=t.sent,t.abrupt("return",this._add(n));case 4:case"end":return t.stop()}},t,this)}))}},{key:"add",value:function(e){var t;if("string"==typeof e)t=Ew.create(e);else if(e instanceof Ew)t=e;else{if(this.update(e))return this.hash[e.identifier];t=Ew.create(e)}return this._add(t)}},{key:"_add",value:function(e){return Cw.COMPLETE<=e.state&&this.lazySynchronize(100),this.update(e)?this.hash[e.identifier]:(this.hash[e.identifier]=e,console.log("add Audio: "+e.identifier),e)}},{key:"update",value:function(e){e instanceof Ew&&e.toContext();var t=this.hash[e.identifier];return!!t&&(t.apply(e),!0)}},{key:"delete",value:function(e){var t=this.hash[e];return!!t&&(t.destroy(),delete this.hash[e],!0)}},{key:"get",value:function(e){return this.hash[e]||null}},{key:"synchronize",value:function(e){this.lazyTimer&&this.lazyTimer.stop(),Jb.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),e)}},{key:"lazySynchronize",value:function(e,t){var n=this;null==this.lazyTimer&&(this.lazyTimer=new nk(function(){return n.synchronize(t)},e)),this.lazyTimer.reset(e)}},{key:"getCatalog",value:function(){var t,n=[],i=a(e.instance.audios);try{for(i.s();!(t=i.n()).done;){var r=t.value;Cw.COMPLETE<=r.state&&n.push({identifier:r.identifier,state:r.state})}}catch(o){i.e(o)}finally{i.f()}return n}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),Iw=function(){var e=function e(){y(this,e)};return e.dicePick="",e.dicePut="",e.diceRoll1="",e.diceRoll2="",e.cardDraw="",e.cardPick="",e.cardPut="",e.cardShuffle="",e.piecePick="",e.piecePut="",e.blockPick="",e.blockPut="",e.lock="",e.unlock="",e.sweep="",e.puyon="",e.surprise="",e}(),Mw=(gw=pw=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"onStoreAdded",value:function(){u(v(n.prototype),"onStoreAdded",this).call(this),Jb.register(this).on("SOUND_EFFECT",function(e){Tw.play(Ow.instance.get(e.data),.5)}).on("SEND_MESSAGE",function(e){var t=tk.instance.get(e.data.messageIdentifier);t&&t.isSendFromSelf&&t.isDicebot&&(Math.random()<.5?pw.play(Iw.diceRoll1):pw.play(Iw.diceRoll2))})}},{key:"onStoreRemoved",value:function(){u(v(n.prototype),"onStoreRemoved",this).call(this),Jb.unregister(this)}},{key:"play",value:function(e){pw.play(e)}}],[{key:"play",value:function(e){var t;t="string"==typeof e?e:e.identifier,pw._play(t)}},{key:"_play",value:function(e){Jb.call("SOUND_EFFECT",e)}}]),n}(ck),gw=pw=zm([fk("sound-effect")],gw)),Aw=(vw=mw=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).imageIdentifier="",e.tag="",e.hide=!1,e}return k(n,[{key:"words",get:function(){return null!=this.tag&&""!=this.tag.trim()||(this.tag=""),""===this.tag.trim()?[]:(this.tag=gk.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}},{key:"containsWords",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if("string"==typeof e&&(e=e.trim().split(/\s+/)),0==e.length)return!1;if(e=e.concat(),t){var n,i=a(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(" ".concat(this.tag," ").indexOf(" ".concat(gk.toHalfWidth(r).toLowerCase()," "))>=0)return!0}}catch(c){i.e(c)}finally{i.f()}return!1}var o,s=a(e);try{for(s.s();!(o=s.n()).done;){var l=o.value;if(" ".concat(this.tag," ").indexOf(" ".concat(gk.toHalfWidth(l).toLowerCase()," "))<0)return!1}}catch(c){s.e(c)}finally{s.f()}return!0}},{key:"addWords",value:function(e){"string"==typeof e&&(e=e.trim().split(/\s+/)),e=e.concat();var t=Array.from(new Set(e.map(function(e){return gk.toHalfWidth(e).toLowerCase()})));return this.tag=Array.from(new Set(t.concat(this.words))).sort().join(" "),Jb.call("OPERATE_IMAGE_TAGS",this.identifier),t}},{key:"removeWords",value:function(e){"string"==typeof e&&(e=e.trim().split(/\s+/)),e=e.concat();var t=Array.from(new Set(e.map(function(e){return gk.toHalfWidth(e).toLowerCase()})));return this.tag=this.words.filter(function(e){return!t.includes(gk.toHalfWidth(e).toLowerCase())}).sort().join(" "),Jb.call("OPERATE_IMAGE_TAGS",this.identifier),t}},{key:"parseInnerXml",value:function(e){var t=mw.get(this.imageIdentifier);t||(t=mw.create(this.imageIdentifier));var n=t.toContext();n.syncData=this.toContext().syncData,t.apply(n),t.update(),this.destroy()}}],[{key:"get",value:function(e){return tk.instance.get("imagetag_".concat(e))}},{key:"create",value:function(e){var t=new mw("imagetag_".concat(e));return t.imageIdentifier=e,t.initialize(),t}}]),n}(dk),zm([pk()],vw.prototype,"imageIdentifier",void 0),zm([pk()],vw.prototype,"tag",void 0),zm([pk()],vw.prototype,"hide",void 0),vw=mw=zm([fk("image-tag")],vw)),Pw=(bw=yw=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).identifiers=[],e}return k(n,[{key:"onStoreAdded",value:function(){u(v(n.prototype),"onStoreAdded",this).call(this),tk.instance.remove(this)}},{key:"innerXml",value:function(){return Array.from(new Set(this.identifiers)).map(function(e){return Aw.get(e)}).filter(function(e){return e}).map(function(e){return e.toXml()}).join("")}}],[{key:"searchImages",value:function(e,t,n,i){"string"==typeof e&&(e=e.trim().split(/\s+/));var r=yw.allImagesOwnWords(i);return e=e.filter(function(e){return r.includes(e)}),this.allImages(i).filter(function(i){var r=Aw.get(i.identifier);return t&&(n||0===e.length)&&(!r||null==r.tag||""===r.tag.trim())||(!t||n)&&r&&r.containsWords(e,n)})}},{key:"allImages",value:function(e){return Dk.instance.images.filter(function(t){if(e)return!0;var n=Aw.get(t.identifier);return!n||!n.hide})}},{key:"allImagesOwnWords",value:function(e){return yw.imagesOwnWords(this.allImages(e))}},{key:"imagesOwnWords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(t){var n=function(){if(0===e.length)return{v:[]};var t=e.map(function(e){return Aw.get(e.identifier)});if(!t[0])return{v:[]};for(var n=t[0].words,i=function(e){return t[e]?0===(n=n.filter(function(n){return t[e].words.includes(n)})).length?{v:{v:n}}:void 0:{v:{v:[]}}},r=1;r<t.length;r++){var a=i(r);if("object"==typeof a)return a.v}return{v:n.sort()}}();if("object"==typeof n)return n.v}var r,o=[],s=a(e);try{for(s.s();!(r=s.n()).done;){var l=r.value,c=Aw.get(l.identifier);c&&o.push.apply(o,i(c.words))}}catch(u){s.e(u)}finally{s.f()}return Array.from(new Set(o)).sort()}},{key:"countAllImagesHasWord",value:function(e,t){var n=0;if(null!=e&&""===e.trim())return n;var i,r=a(yw.allImages(t));try{for(r.s();!(i=r.n()).done;){var o=i.value,s=Aw.get(o.identifier);null==e?s&&null!=s.tag&&""!=s.tag.trim()||n++:s&&s.containsWords(e.trim(),!1)&&n++}}catch(l){r.e(l)}finally{r.f()}return n}},{key:"imagesIsHidden",value:function(e){var t,n=a(e);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=Aw.get(i.identifier);if(!r||!r.hide)return!1}}catch(o){n.e(o)}finally{n.f()}return!0}},{key:"sortImagesByWords",value:function(e,t){var n=e.map(function(e){var t=Aw.get(e.identifier);return{image:e,tag:t&&null!=t.tag?t.tag:""}});return n.sort(function(e,n){var i=0;return t.some(function(t){return!!(i=yw._sortByWordCriteria(e,n,t))}),i}),n.map(function(e){return e.image})}},{key:"_sortByWordCriteria",value:function(e,t,n){if(null==n)return""==e.tag&&""==t.tag?0:""==e.tag?-1:""==t.tag?1:0;var i=" ".concat(e.tag," ").indexOf(" ".concat(n," ")),r=" ".concat(t.tag," ").indexOf(" ".concat(n," "));return-1==i&&-1==r?0:i>=0&&-1==r?-1:-1==i&&r>=0?1:0}},{key:"create",value:function(e){var t=new yw;return t.identifiers=e.map(function(e){return e.identifier}),t}}]),n}(dk),bw=yw=zm([fk("image-tag-list")],bw)),Dw=p("Iab2"),Rw=p("xOOu");!function(e){var t={gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};e.type=function(e){var n=e.replace(/.*[\.\/\\]/,"").toLowerCase();return t[n]?t[n]:""},e.extension=function(e){for(var n in t)if(t[n]===e)return n;return e.split("/")[1]}}(kw||(kw={}));var Fw=function(){function e(){y(this,e),this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}return k(e,[{key:"initialize",value:function(){this.destroy(),this.addEventListeners()}},{key:"destroy",value:function(){this.removeEventListeners()}},{key:"addEventListeners",value:function(){var e=this;this.removeEventListeners(),this.callbackOnDragEnter=function(t){return e.onDragEnter(t)},this.callbackOnDragOver=function(t){return e.onDragOver(t)},this.callbackOnDrop=function(t){return e.onDrop(t)},document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}},{key:"removeEventListeners",value:function(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}},{key:"onDragEnter",value:function(e){e.preventDefault()}},{key:"onDragOver",value:function(e){e.preventDefault()}},{key:"onDrop",value:function(e){e.preventDefault(),console.log("onDrop",e.dataTransfer),this.load(e.dataTransfer.files)}},{key:"load",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,o;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return");case 2:n=e instanceof FileList?Nw(e):e,i=a(n),t.prev=4,i.s();case 6:if((r=i.n()).done){t.next=19;break}return o=r.value,t.next=10,this.handleImage(o);case 10:return t.next=12,this.handleAudio(o);case 12:return t.next=14,this.handleText(o);case 14:return t.next=16,this.handleZip(o);case 16:Jb.trigger("FILE_LOADED",{file:o});case 17:t.next=6;break;case 19:t.next=24;break;case 21:t.prev=21,t.t0=t.catch(4),i.e(t.t0);case 24:return t.prev=24,i.f(),t.finish(24);case 27:case"end":return t.stop()}},t,this,[[4,21,24,27]])}))}},{key:"handleImage",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.type.indexOf("image/")<0,t.t0){t.next=9;break}if(!(this.maxImageSize<e.size)){t.next=6;break}console.warn("File size limit exceeded. -> ".concat(e.name," (").concat((e.size/1024/1024).toFixed(2),"MB)")),t.next=9;break;case 6:return console.log(e.name+" type:"+e.type),t.next=9,Dk.instance.addAsync(e);case 9:case"end":return t.stop()}},t,this)}))}},{key:"handleAudio",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(t.t0=e.type.indexOf("audio/")<0,t.t0){t.next=9;break}if(!(this.maxAudioeSize<e.size)){t.next=6;break}console.warn("File size limit exceeded. -> ".concat(e.name," (").concat((e.size/1024/1024).toFixed(2),"MB)")),t.next=9;break;case 6:return console.log(e.name+" type:"+e.type),t.next=9,Ow.instance.addAsync(e);case 9:case"end":return t.stop()}},t,this)}))}},{key:"handleText",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.type.indexOf("text/")<0){t.next=14;break}return console.log(e.name+" type:"+e.type),t.prev=2,t.t0=Yb,t.next=6,Bm.readAsTextAsync(e);case 6:t.t1=t.sent,(n=t.t0.xml2element.call(t.t0,t.t1))&&Jb.trigger("XML_LOADED",{xmlElement:n}),t.next=14;break;case 11:t.prev=11,t.t2=t.catch(2),console.warn(t.t2);case 14:case"end":return t.stop()}},t,null,[[2,11]])}))}},{key:"handleZip",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,a,o,s;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(0<=e.type.indexOf("application/")||e.type.length<1){t.next=2;break}return t.abrupt("return");case 2:return n=new Rw,t.prev=3,t.next=6,n.loadAsync(e);case 6:n=t.sent,t.next=12;break;case 9:return t.prev=9,t.t0=t.catch(3),t.abrupt("return",void console.warn(t.t0));case 12:i=[],n.forEach(function(e,t){return i.push(t)}),r=0,a=i;case 15:if(!(r<a.length)){t.next=32;break}return o=a[r],t.prev=17,t.next=20,o.async("arraybuffer");case 20:return s=t.sent,console.log(o.name+" \u89e3\u51cd..."),t.next=24,this.load([new File([s],o.name,{type:kw.type(o.name)})]);case 24:t.next=29;break;case 26:t.prev=26,t.t1=t.catch(17),console.warn(t.t1);case 29:r++,t.next=15;break;case 32:case"end":return t.stop()}},t,this,[[3,9],[17,26]])}))}},{key:"saveAsync",value:function(e,t,n){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function i(){var r,o,s,l,c,u;return regeneratorRuntime.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(e){i.next=2;break}return i.abrupt("return");case 2:r=e instanceof FileList?Nw(e):e,o=new Rw,s=a(r);try{for(s.s();!(l=s.n()).done;)c=l.value,o.file(c.name,c)}catch(h){s.e(h)}finally{s.f()}return i.next=7,o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},n);case 7:u=i.sent,Object(Dw.saveAs)(u,t+".zip");case 9:case"end":return i.stop()}},i)}))}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}();function Nw(e){for(var t=[],n=e.length,i=0;i<n;i++)t.push(e[i]);return t}var zw,Lw=((zw=function(){function e(t){y(this,e),this._sanitizer=t}return k(e,[{key:"transform",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"html";switch(t){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error("Invalid safe type specified: ".concat(t))}}}]),e}()).\u0275fac=function(e){return new(e||zw)(Vo(hd))},zw.\u0275pipe=vt({name:"safe",type:zw,pure:!0}),zw);function Bw(e,t){1&e&&qo(0,"badge",12),2&e&&Wo("count",is(2).countImagesHasWord(null))("@.disabled",!0)}function jw(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",25),es("ngModelChange",function(e){return Jt(n),is().searchNoTagImage=e})("change",function(){Jt(n);var e=is();return e.searchNoTagImage=!!e.searchNoTagImage}),Yo(),Zo(2,"div",26),Zo(3,"s"),zs(4,"No Tag"),Yo(),Uo(5,Bw,1,2,"badge",27),Yo(),Yo()}if(2&e){var i=is();sa(1),ss("checked",i.searchNoTagImage?"checked":""),Wo("ngModel",i.searchNoTagImage),sa(4),Wo("ngIf",i.countImagesHasWord(null)>0)}}function Uw(e,t){if(1&e&&qo(0,"badge",12),2&e){var n=is().$implicit;Wo("count",is().countImagesHasWord(n))("@.disabled",!0)}}function Hw(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",28),es("change",function(){Jt(n);var e=t.$implicit;return is().onSelectedWord(e)}),Yo(),Zo(2,"div"),zs(3),Uo(4,Uw,1,2,"badge",27),Yo(),Yo()}if(2&e){var i=t.$implicit,r=is();sa(1),ss("value",i),Wo("checked",r.searchWords.includes(i)),sa(2),Ls(i),sa(1),Wo("ngIf",r.countImagesHasWord(i)>0)}}function Vw(e,t){1&e&&$o(0)}function Ww(e,t){if(1&e&&(Zo(0,"label",39),zs(1),Yo()),2&e){var n=is().$implicit;sa(1),Ls(n)}}function Gw(e,t){1&e&&(Zo(0,"span",40),zs(1,"\u2026"),Yo())}function Zw(e,t){if(1&e&&(Xo(0),Uo(1,Ww,2,1,"label",37),Uo(2,Gw,2,0,"span",38),Ko()),2&e){var n=t.index;sa(1),Wo("ngIf",n<6),sa(1),Wo("ngIf",6==n)}}function Yw(e,t){if(1&e&&Uo(0,Zw,3,2,"ng-container",14),2&e){var n=is().$implicit;Wo("ngForOf",is().getTagWords(n))}}function qw(e,t){1&e&&(Zo(0,"s",41),zs(1,"No Tag"),Yo())}function Xw(e,t){1&e&&(Zo(0,"div",42),Zo(1,"i",43),zs(2,"visibility"),Yo(),Yo())}function Kw(e,t){if(1&e){var n=Qo();Zo(0,"img",44),es("click",function(){Jt(n);var e=is().$implicit;return is().onSelectedFile(e)}),hc(1,"safe"),Yo()}if(2&e){var i=is().$implicit;Wo("src",dc(1,2,i.url,"resourceUrl"),dr)("alt",i.name)}}function $w(e,t){1&e&&qo(0,"img",45),2&e&&ss("alt",is().$implicit.name)}var Qw=function(e){return{selected:e}};function Jw(e,t){if(1&e&&(Zo(0,"div",29),Zo(1,"div",30),Uo(2,Vw,1,0,"ng-container",31),Uo(3,Yw,1,1,"ng-template",null,32,Ic),Uo(5,qw,2,0,"ng-template",null,33,Ic),Yo(),Uo(7,Xw,3,0,"div",34),Uo(8,Kw,2,5,"img",35),Uo(9,$w,1,1,"img",36),Yo()),2&e){var n=t.$implicit,i=Ho(4),r=Ho(6),a=is();Wo("@scaleInOut",void 0)("ngClass",rc(8,Qw,a.selected(n))),sa(2),Wo("ngIf",a.getTagWords(n).length>0)("ngIfThen",i)("ngIfElse",r),sa(5),Wo("ngIf",a.getHidden(n)),sa(1),Wo("ngIf",0<n.url.length),sa(1),Wo("ngIf",n.url.length<=0)}}function ex(e,t){if(1&e){var n=Qo();Zo(0,"label",55),es("click",function(){Jt(n);var e=t.$implicit;return is(3).removeTagWord(e)}),zs(1),Zo(2,"sup",56),zs(3,"\xd7"),Yo(),Yo()}if(2&e){var i=t.$implicit;sa(1),Ls(i)}}function tx(e,t){if(1&e&&(Xo(0),Uo(1,ex,4,1,"label",54),Ko()),2&e){var n=is(2);sa(1),Wo("ngForOf",n.selectedImagesOwnWords())}}function nx(e,t){1&e&&(Xo(0),Zo(1,"span",57),Zo(2,"s"),zs(3,"No Tag"),Yo(),Yo(),Ko())}function ix(e,t){if(1&e&&(Zo(0,"option",58),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n),sa(1),Ls(n)}}var rx=function(e){return{"red-eye":e}};function ax(e,t){if(1&e){var n=Qo();Zo(0,"div",46),Zo(1,"div"),Zo(2,"div",47),Zo(3,"button",48),es("click",function(){Jt(n);var e=is();return e.setectedImagesToHidden(!e.selectedImagesIsHidden)}),Zo(4,"i",8),zs(5),Yo(),Yo(),Yo(),Zo(6,"button",49),es("click",function(){return Jt(n),is().onUnselect()}),zs(7,"\u753b\u50cf\u9078\u629e\u89e3\u9664"),Yo(),Zo(8,"input",50),es("ngModelChange",function(e){return Jt(n),is().addingTagWord=e}),Yo(),Zo(9,"button",51),es("click",function(){return Jt(n),is().addTagWord()}),zs(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),Yo(),Uo(11,tx,2,1,"ng-container",13),Uo(12,nx,4,0,"ng-container",13),Yo(),Zo(13,"datalist",52),Uo(14,ix,2,2,"option",53),Yo(),Yo()}if(2&e){var i=is();Wo("@fadeAndUpInOut",void 0),sa(3),Lo("title",i.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),sa(1),Wo("ngClass",rc(11,rx,i.selectedImagesIsHidden)),sa(1),Ls(i.selectedImagesIsHidden?"visibility":"visibility_off"),sa(3),jo("list","",i.panelId,"_suggest"),Wo("ngModel",i.addingTagWord),sa(1),Wo("disabled",null==i.addingTagWord||""===i.addingTagWord.trim()),sa(2),Wo("ngIf",i.selectedImagesOwnWords().length>0),sa(1),Wo("ngIf",0==i.selectedImagesOwnWords().length),sa(1),ls("id","",i.panelId,"_suggest"),sa(1),Wo("ngForOf",i.suggestWords())}}var ox,sx=function(e){return{selecter:e}},lx=((ox=function(){function e(t,n){y(this,e),this.changeDetector=t,this.panelService=n,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}return k(e,[{key:"images",get:function(){var t=Pw.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),n=t.map(function(e){return e.identifier});return this.selectedImageFiles=this.selectedImageFiles.filter(function(e){return n.includes(e.identifier)}),this.isSort?Pw.sortImagesByWords(t,e.sortOrder):t}},{key:"searchNoTagImage",get:function(){return this._searchNoTagImage},set:function(t){t?e.sortOrder.unshift(null):e.sortOrder=e.sortOrder.filter(function(e){return null!=e}),e.sortOrder=Array.from(new Set(e.sortOrder)),this._searchNoTagImage=t,Jb.trigger("CHANGE_SORT_ORDER",null)}},{key:"searchAllImage",get:function(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;var e,t=a(this.allImagesOwnWords);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!this.searchWords.includes(n))return!1}}catch(i){t.e(i)}finally{t.f()}return!0}},{key:"isSelected",get:function(){var e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}},{key:"selectedImagesIsHidden",get:function(){return Pw.imagesIsHidden(this.selectedImageFiles)}},{key:"allImagesOwnWords",get:function(){return Pw.allImagesOwnWords(this.isShowHideImages)}},{key:"ngOnInit",value:function(){var t=this;Promise.resolve().then(function(){return t.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"}),this.searchWords=this.allImagesOwnWords,this.panelId=Hb.generateUuid(),e.imageCount=Dk.instance.images.length}},{key:"ngAfterViewInit",value:function(){var t=this;Jb.register(this).on("SYNCHRONIZE_FILE_LIST",function(n){n.isSendFromSelf&&t.changeDetector.markForCheck(),e.imageCount=n.data.length}).on("OPERATE_IMAGE_TAGS",function(e){t.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",function(e){e.isSendFromSelf&&t.changeDetector.markForCheck()})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"allImages",value:function(){return Pw.allImages(this.isShowHideImages)}},{key:"countAllImagesHasWord",value:function(e){return Pw.countAllImagesHasWord(e,this.isShowHideImages)}},{key:"countImagesHasWord",value:function(e){var t=0;if(null!=e&&""===e.trim())return t;var n,i=a(this.images);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=Aw.get(r.identifier);null==e?o&&null!=o.tag&&""!=o.tag.trim()||t++:o&&o.containsWords(e.trim(),!1)&&t++}}catch(s){i.e(s)}finally{i.f()}return t}},{key:"handleFileSelect",value:function(e){var t=e.target,n=t.files;n.length&&Fw.instance.load(n),t.value=""}},{key:"selected",value:function(e){return this.selectedImageFiles.map(function(e){return e.identifier}).includes(e.identifier)}},{key:"selectedImagesOwnWords",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Pw.imagesOwnWords(this.selectedImageFiles,e)}},{key:"onSelectedWord",value:function(t){null!=t&&""!==t.trim()&&(this.searchWords.includes(t)?(this.searchWords=this.searchWords.filter(function(e){return t!==e}),e.sortOrder=e.sortOrder.filter(function(e){return t!==e})):(this.searchWords.push(t),e.sortOrder.unshift(t)),e.sortOrder=Array.from(new Set(e.sortOrder)),Jb.trigger("CHANGE_SORT_ORDER",t))}},{key:"onSelectedFile",value:function(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(function(t){return t.identifier!==e.identifier}):this.selectedImageFiles.push(e)}},{key:"getTagWords",value:function(e){var t=Aw.get(e.identifier);return t?t.words:[]}},{key:"getHidden",value:function(e){var t=Aw.get(e.identifier);return!!t&&t.hide}},{key:"onSearchAllImage",value:function(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}},{key:"onUnselect",value:function(){this.selectedImageFiles=[]}},{key:"onShowHiddenImages",value:function(e){this.isShowHideImages?this.isShowHideImages=!1:window.confirm("\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\uff08\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\uff09\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")?this.isShowHideImages=!0:(this.isShowHideImages=!1,e.preventDefault())}},{key:"setectedImagesToHidden",value:function(e){if(window.confirm("\u9078\u629e\u3057\u305f\u753b\u50cf".concat(e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664","\u3057\u307e\u3059").concat(e?"\uff08\u3053\u308c\u306f\u300c\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7\u3092\u958b\u3044\u305f\u969b\u306b\u610f\u56f3\u305b\u305a\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3059\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\uff09":"","\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f"))){var t,n=a(this.selectedImageFiles);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=Aw.get(i.identifier)||Aw.create(i.identifier);r.hide=e,Jb.call("OPERATE_IMAGE_TAGS",r.identifier)}}catch(o){n.e(o)}finally{n.f()}}}},{key:"addTagWord",value:function(){if(null!=this.addingTagWord&&""!=this.addingTagWord.trim()){var t=this.addingTagWord.trim().split(/\s+/),n=null;if(window.confirm("\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+t.map(function(e){return"\ud83c\udff7\ufe0f".concat(e," ")}).join(" ")+"\u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")){var r,o,s,l=a(this.selectedImageFiles);try{for(l.s();!(s=l.n()).done;){var c=s.value;n=(Aw.get(c.identifier)||Aw.create(c.identifier)).addWords(t)}}catch(u){l.e(u)}finally{l.f()}n&&(this.serchCondIsOr&&(r=this.searchWords).push.apply(r,i(n)),(o=e.sortOrder).unshift.apply(o,i(n))),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),e.sortOrder=Array.from(new Set(e.sortOrder)),Jb.trigger("CHANGE_SORT_ORDER",n),this.addingTagWord=""}}}},{key:"removeTagWord",value:function(e){if(window.confirm("\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 \ud83c\udff7\ufe0f"+e+" \u3092\u524a\u9664\u3057\u307e\u3059\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")&&null!=e&&""!=e.trim()){var t,n=a(this.selectedImageFiles);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=Aw.get(i.identifier);r&&r.removeWords(e)}}catch(s){n.e(s)}finally{n.f()}var o=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(function(e){return o.includes(e)}),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),Jb.trigger("CHANGE_SORT_ORDER",this.deletedWords)}}},{key:"identify",value:function(e,t){return t.identifier}},{key:"suggestWords",value:function(){var e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(function(t){return 0!==t.indexOf("*")&&!e.includes(t)})}}]),e}()).sortOrder=[],ox.imageCount=0,ox.\u0275fac=function(e){return new(e||ox)(Vo(Dl),Vo(Wk))},ox.\u0275cmp=ct({type:ox,selectors:[["file-storage"]],decls:41,vars:19,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100px","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModel","ngModelChange"],[2,"font-size","x-small",3,"disabled","click"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["class","word-tag",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(e,t){1&e&&(Zo(0,"label"),Zo(1,"div",0),Zo(2,"div"),Zo(3,"i",1),zs(4,"add_photo_alternate"),Yo(),Yo(),Zo(5,"div"),zs(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),Yo(),Zo(7,"div",2),zs(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),Yo(),Zo(9,"input",3),es("change",function(e){return t.handleFileSelect(e)}),Yo(),Zo(10,"div",2),qo(11,"br"),zs(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),Yo(),Yo(),Yo(),Zo(13,"div",4),Zo(14,"div",5),Zo(15,"label",6),Zo(16,"input",7),es("click",function(e){return t.onShowHiddenImages(e)}),Yo(),Zo(17,"i",8),zs(18),Yo(),Yo(),Yo(),Zo(19,"span",9),Zo(20,"label"),Zo(21,"input",10),es("click",function(){return t.onSearchAllImage()}),Yo(),Zo(22,"div",11),Zo(23,"b"),zs(24,"ALL"),Yo(),qo(25,"badge",12),Yo(),Yo(),Uo(26,jw,6,3,"label",13),Uo(27,Hw,5,4,"label",14),Yo(),Zo(28,"span",15),Zo(29,"select",16),es("ngModelChange",function(e){return t.serchCondIsOr=e}),Zo(30,"option",17),zs(31,"\u3044\u305a\u308c\u304b (OR)"),Yo(),Zo(32,"option",18),zs(33,"\u3059\u3079\u3066 (AND)"),Yo(),Yo(),Zo(34,"label",19),Zo(35,"input",20),es("ngModelChange",function(e){return t.isSort=e})("change",function(){return t.isSort=!!t.isSort}),Yo(),Zo(36,"b",21),zs(37,"\u30bd\u30fc\u30c8"),Yo(),Yo(),Yo(),Yo(),Zo(38,"div",22),Uo(39,Jw,10,10,"div",23),Yo(),Uo(40,ax,15,13,"div",24)),2&e&&(sa(16),ss("checked",t.isShowHideImages?"checked":""),sa(1),Wo("ngClass",rc(15,rx,t.isShowHideImages)),sa(1),Ls(t.isShowHideImages?"visibility":"visibility_off"),sa(3),ss("checked",t.searchAllImage?"checked":""),sa(4),Wo("count",t.images.length)("@.disabled",!0),sa(1),Wo("ngIf",t.countAllImagesHasWord(null)>0),sa(1),Wo("ngForOf",t.allImagesOwnWords),sa(2),Wo("ngModel",t.serchCondIsOr),sa(6),ss("checked",t.isSort?"checked":""),Wo("ngModel",t.isSort),sa(3),Wo("ngClass",rc(17,sx,t.isSelected)),sa(1),Wo("ngForOf",t.images)("ngForTrackBy",t.identify),sa(1),Wo("ngIf",t.isSelected))},directives:[lh,Nm,dh,uh,Bf,Xd,Ef,jf,$f,wd,Ed],pipes:[Lw],styles:['.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold,Vollkorn;color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent}.image[_ngcontent-%COMP%]:hover{border:2px dotted red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:brightness(50%);opacity:.7}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{top:0;border-bottom:1px dotted #666}.sticky-bottom[_ngcontent-%COMP%], .sticky-top[_ngcontent-%COMP%]{position:sticky;background-color:rgba(240,218,189,.9);z-index:100}.sticky-bottom[_ngcontent-%COMP%]{bottom:0;border-top:1px dotted #666}.word-tag[_ngcontent-%COMP%]{font-size:smaller;margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:before{content:"\ud83c\udff7\ufe0f"}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,-1px -1px 0 #fff,1px 0 0 #fff,0 1px 0 #fff,-1px 0 0 #fff,0 -1px 0 #fff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0 0 2px #dc143c,0 0 4px #fff;font-weight:bolder}'],data:{animation:[sp("scaleInOut",[fp("void => *",[lp("200ms ease",dp([up({transform:"scale3d(0, 0, 0)",offset:0}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp("180ms ease",up({transform:"scale3d(0, 0, 0)"}))])]),sp("fadeAndUpInOut",[fp("void => *",[lp("100ms ease-in-out",dp([up({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),up({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),fp("* => void",[lp("100ms ease-in-out",up({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),lp("100ms ease-in-out",up({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0}),ox);function cx(e,t){1&e&&qo(0,"badge",8),2&e&&Wo("count",is(2).countImagesHasWord(null))("@.disabled",!0)}function ux(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",21),es("ngModelChange",function(e){return Jt(n),is().searchNoTagImage=e})("change",function(){Jt(n);var e=is();return e.searchNoTagImage=!!e.searchNoTagImage}),Yo(),Zo(2,"div",22),Zo(3,"s"),zs(4,"No Tag"),Yo(),Uo(5,cx,1,2,"badge",23),Yo(),Yo()}if(2&e){var i=is();sa(1),ss("checked",i.searchNoTagImage?"checked":""),Wo("ngModel",i.searchNoTagImage),sa(4),Wo("ngIf",i.countImagesHasWord(null)>0)}}function hx(e,t){if(1&e&&qo(0,"badge",8),2&e){var n=is().$implicit;Wo("count",is().countImagesHasWord(n))("@.disabled",!0)}}function dx(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",24),es("change",function(){Jt(n);var e=t.$implicit;return is().onSelectedWord(e)}),Yo(),Zo(2,"div"),zs(3),Uo(4,hx,1,2,"badge",23),Yo(),Yo()}if(2&e){var i=t.$implicit,r=is();sa(1),ss("value",i),Wo("checked",r.searchWords.includes(i)),sa(2),Ls(i),sa(1),Wo("ngIf",r.countImagesHasWord(i)>0)}}function fx(e,t){if(1&e){var n=Qo();Zo(0,"span",25),Zo(1,"button",26),es("click",function(){Jt(n);var e=is();return e.onSelectedFile(e.empty)}),zs(2,"\u753b\u50cf\u306a\u3057"),Yo(),Yo()}}function px(e,t){1&e&&$o(0)}function gx(e,t){if(1&e&&(Zo(0,"label",37),zs(1),Yo()),2&e){var n=is().$implicit;sa(1),Ls(n)}}function mx(e,t){1&e&&(Zo(0,"span",38),zs(1,"\u2026"),Yo())}function vx(e,t){if(1&e&&(Xo(0),Uo(1,gx,2,1,"label",35),Uo(2,mx,2,0,"span",36),Ko()),2&e){var n=t.index;sa(1),Wo("ngIf",n<6),sa(1),Wo("ngIf",6==n)}}function yx(e,t){if(1&e&&Uo(0,vx,3,2,"ng-container",10),2&e){var n=is().$implicit;Wo("ngForOf",is().getTagWords(n))}}function bx(e,t){1&e&&(Zo(0,"s",39),zs(1,"No Tag"),Yo())}function kx(e,t){1&e&&(Zo(0,"div",40),Zo(1,"i",41),zs(2,"visibility"),Yo(),Yo())}function _x(e,t){if(1&e){var n=Qo();Zo(0,"img",42),es("click",function(){Jt(n);var e=is().$implicit;return is().onSelectedFile(e)}),hc(1,"safe"),Yo()}if(2&e){var i=is().$implicit;Wo("src",dc(1,2,i.url,"resourceUrl"),dr)("alt",i.name)}}function wx(e,t){1&e&&qo(0,"img",43),2&e&&ss("alt",is().$implicit.name)}function xx(e,t){if(1&e&&(Zo(0,"div",27),Zo(1,"div",28),Uo(2,px,1,0,"ng-container",29),Uo(3,yx,1,1,"ng-template",null,30,Ic),Uo(5,bx,2,0,"ng-template",null,31,Ic),Yo(),Uo(7,kx,3,0,"div",32),Uo(8,_x,2,5,"img",33),Uo(9,wx,1,1,"img",34),Yo()),2&e){var n=t.$implicit,i=Ho(4),r=Ho(6),a=is();Wo("@scaleInOut",void 0),sa(2),Wo("ngIf",a.getTagWords(n).length>0)("ngIfThen",i)("ngIfElse",r),sa(5),Wo("ngIf",a.getHidden(n)),sa(1),Wo("ngIf",0<n.url.length),sa(1),Wo("ngIf",n.url.length<=0)}}var Cx,Ex=function(e){return{"red-eye":e}},Sx=((Cx=function(){function e(t,n,i){y(this,e),this.changeDetector=t,this.panelService=n,this.modalService=i,this.isAllowedEmpty=!1,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty)}return k(e,[{key:"images",get:function(){var e=Pw.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?Pw.sortImagesByWords(e,lx.sortOrder):e}},{key:"empty",get:function(){return Wm.Empty}},{key:"searchNoTagImage",get:function(){return this._searchNoTagImage},set:function(e){e?lx.sortOrder.unshift(null):lx.sortOrder=lx.sortOrder.filter(function(e){return null!=e}),lx.sortOrder=Array.from(new Set(lx.sortOrder)),this._searchNoTagImage=e,Jb.trigger("CHANGE_SORT_ORDER",null)}},{key:"searchAllImage",get:function(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;var e,t=a(this.allImagesOwnWords);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!this.searchWords.includes(n))return!1}}catch(i){t.e(i)}finally{t.f()}return!0}},{key:"allImagesOwnWords",get:function(){return Pw.allImagesOwnWords(this.isShowHideImages)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.modalService.title=e.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"}),this.searchWords=this.allImagesOwnWords,lx.imageCount=Dk.instance.images.length}},{key:"ngAfterViewInit",value:function(){var e=this;Jb.register(this).on("SYNCHRONIZE_FILE_LIST",function(t){t.isSendFromSelf&&e.changeDetector.markForCheck(),lx.imageCount=t.data.length}).on("OPERATE_IMAGE_TAGS",function(t){e.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",function(t){t.isSendFromSelf&&e.changeDetector.markForCheck()})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"allImages",value:function(){return Pw.allImages(this.isShowHideImages)}},{key:"countAllImagesHasWord",value:function(e){return Pw.countAllImagesHasWord(e,this.isShowHideImages)}},{key:"countImagesHasWord",value:function(e){var t=0;if(null!=e&&""===e.trim())return t;var n,i=a(this.images);try{for(i.s();!(n=i.n()).done;){var r=n.value,o=Aw.get(r.identifier);null==e?o&&null!=o.tag&&""!=o.tag.trim()||t++:o&&o.containsWords(e.trim(),!1)&&t++}}catch(s){i.e(s)}finally{i.f()}return t}},{key:"getTagWords",value:function(e){var t=Aw.get(e.identifier);return t?t.words:[]}},{key:"getHidden",value:function(e){var t=Aw.get(e.identifier);return!!t&&t.hide}},{key:"onShowHiddenImages",value:function(e){this.isShowHideImages?this.isShowHideImages=!1:window.confirm("\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\uff08\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\uff09\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")?this.isShowHideImages=!0:(this.isShowHideImages=!1,e.preventDefault())}},{key:"onSelectedFile",value:function(e){this.modalService.resolve(e.identifier)}},{key:"onSearchAllImage",value:function(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}},{key:"onSelectedWord",value:function(e){null!=e&&""!==e.trim()&&(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(function(t){return e!==t}),lx.sortOrder=lx.sortOrder.filter(function(t){return e!==t})):(this.searchWords.push(e),lx.sortOrder.unshift(e)),lx.sortOrder=Array.from(new Set(lx.sortOrder)),Jb.trigger("CHANGE_SORT_ORDER",e))}},{key:"identify",value:function(e,t){return t.identifier}}]),e}()).\u0275fac=function(e){return new(e||Cx)(Vo(Dl),Vo(Wk),Vo(Zk))},Cx.\u0275cmp=ct({type:Cx,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty"},decls:28,vars:16,consts:[[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px"],["class","empty",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"empty"],[3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100px","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"div",1),Zo(2,"label",2),Zo(3,"input",3),es("click",function(e){return t.onShowHiddenImages(e)}),Yo(),Zo(4,"i",4),zs(5),Yo(),Yo(),Yo(),Zo(6,"span",5),Zo(7,"label"),Zo(8,"input",6),es("click",function(){return t.onSearchAllImage()}),Yo(),Zo(9,"div",7),Zo(10,"b"),zs(11,"ALL"),Yo(),qo(12,"badge",8),Yo(),Yo(),Uo(13,ux,6,3,"label",9),Uo(14,dx,5,4,"label",10),Yo(),Zo(15,"span",11),Zo(16,"select",12),es("ngModelChange",function(e){return t.serchCondIsOr=e}),Zo(17,"option",13),zs(18,"\u3044\u305a\u308c\u304b (OR)"),Yo(),Zo(19,"option",14),zs(20,"\u3059\u3079\u3066 (AND)"),Yo(),Yo(),Zo(21,"label",15),Zo(22,"input",16),es("ngModelChange",function(e){return t.isSort=e})("change",function(){return t.isSort=!!t.isSort}),Yo(),Zo(23,"b",17),zs(24,"\u30bd\u30fc\u30c8"),Yo(),Yo(),Yo(),Yo(),Zo(25,"div",18),Uo(26,fx,3,0,"span",19),Uo(27,xx,10,7,"div",20),Yo()),2&e&&(sa(3),ss("checked",t.isShowHideImages?"checked":""),sa(1),Wo("ngClass",rc(14,Ex,t.isShowHideImages)),sa(1),Ls(t.isShowHideImages?"visibility":"visibility_off"),sa(3),ss("checked",t.searchAllImage?"checked":""),sa(4),Wo("count",t.images.length)("@.disabled",!0),sa(1),Wo("ngIf",t.countAllImagesHasWord(null)>0),sa(1),Wo("ngForOf",t.allImagesOwnWords),sa(2),Wo("ngModel",t.serchCondIsOr),sa(6),ss("checked",t.isSort?"checked":""),Wo("ngModel",t.isSort),sa(4),Wo("ngIf",t.isAllowedEmpty),sa(1),Wo("ngForOf",t.images)("ngForTrackBy",t.identify))},directives:[lh,Nm,dh,uh,Bf,Xd,Ef,jf,$f,wd],pipes:[Lw],styles:['.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent}.image[_ngcontent-%COMP%]:hover{border:2px dotted red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{transition-duration:.12s}.empty[_ngcontent-%COMP%], .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.empty[_ngcontent-%COMP%]{line-height:120px}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:100px}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:rgba(240,218,189,.9);border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{font-size:smaller;margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:before{content:"\ud83c\udff7\ufe0f"}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,-1px -1px 0 #fff,1px 0 0 #fff,0 1px 0 #fff,-1px 0 0 #fff,0 -1px 0 #fff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0 0 2px #dc143c,0 0 4px #fff;font-weight:bolder}'],data:{animation:[sp("scaleInOut",[fp("void => *",[lp("200ms ease",dp([up({transform:"scale3d(0, 0, 0)",offset:0}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp("180ms ease",up({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),Cx);function Tx(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=tk.instance.getObjects(e.aliasName);t.forEach(function(e){return n=n.concat(tk.instance.getObjects(e))}),n=n.filter(function(e){return e.isVisibleOnTable});for(var i=-1,r=!1,a=0;a<n.length;a++)i===n[a].zindex?r=!0:i<n[a].zindex&&(i=n[a].zindex,r=!1);if((i!==e.zindex||r)&&(e.zindex=i+1,!(e.zindex<n.length+256))){n.sort(function(e,t){return e.zindex-t.zindex});for(var o=0;o<n.length;o++)n[o].zindex=o}}var Ox,Ix,Mx,Ax,Px,Dx,Rx,Fx,Nx,zx,Lx,Bx=function(e){return e[e.FRONT=0]="FRONT",e[e.BACK=1]="BACK",e}({}),jx=(Ix=Ox=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).state=Bx.FRONT,e.rotate=0,e.owner="",e.zindex=0,e}return k(n,[{key:"isVisibleOnTable",get:function(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}},{key:"name",get:function(){return this.getCommonValue("name","")}},{key:"size",get:function(){return this.getCommonValue("size",2)},set:function(e){this.setCommonValue("size",e)}},{key:"frontImage",get:function(){return this.getImageFile("front")}},{key:"backImage",get:function(){return this.getImageFile("back")}},{key:"imageFile",get:function(){return this.isVisible?this.frontImage:this.backImage}},{key:"ownerName",get:function(){var e=Rk.findByUserId(this.owner);return e?e.name:""}},{key:"ownerColor",get:function(){var e=Rk.findByUserId(this.owner);return e?e.color:"#444444"}},{key:"hasOwner",get:function(){return 0<this.owner.length}},{key:"isHand",get:function(){return ek.peerContext.userId===this.owner}},{key:"isFront",get:function(){return this.state===Bx.FRONT}},{key:"isVisible",get:function(){return this.isHand||this.isFront}},{key:"faceUp",value:function(){this.state=Bx.FRONT,this.owner=""}},{key:"faceDown",value:function(){this.state=Bx.BACK,this.owner=""}},{key:"toTopmost",value:function(){Tx(this,["card-stack"])}}],[{key:"create",value:function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,r=arguments.length>4?arguments[4]:void 0,a=null;return(a=r?new Ox(r):new Ox).createDataElements(),a.commonDataElement.appendChild(Nk.create("name",e,{},"name_"+a.identifier)),a.commonDataElement.appendChild(Nk.create("size",i,{},"size_"+a.identifier)),a.imageDataElement.appendChild(Nk.create("front",t,{type:"image"},"front_"+a.identifier)),a.imageDataElement.appendChild(Nk.create("back",n,{type:"image"},"back_"+a.identifier)),a.initialize(),a}}]),n}(zk),zm([pk()],Ix.prototype,"state",void 0),zm([pk()],Ix.prototype,"rotate",void 0),zm([pk()],Ix.prototype,"owner",void 0),zm([pk()],Ix.prototype,"zindex",void 0),Ix=Ox=zm([fk("card")],Ix)),Ux=(Ax=Mx=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).rotate=0,e.zindex=0,e.owner="",e.isShowTotal=!0,e}return k(n,[{key:"name",get:function(){return this.getCommonValue("name","")}},{key:"ownerName",get:function(){var e=Rk.findByUserId(this.owner);return e?e.name:""}},{key:"ownerColor",get:function(){var e=Rk.findByUserId(this.owner);return e?e.color:"#444444"}},{key:"hasOwner",get:function(){return 0<this.owner.length}},{key:"cardRoot",get:function(){var e,t=a(this.children);try{for(t.s();!(e=t.n()).done;){var n=e.value;if("cardRoot"===n.getAttribute("name"))return n}}catch(i){t.e(i)}finally{t.f()}return null}},{key:"cards",get:function(){return this.cardRoot?this.cardRoot.children:[]}},{key:"topCard",get:function(){return this.isEmpty?null:this.cards[0]}},{key:"isEmpty",get:function(){return this.cards.length<1}},{key:"imageFile",get:function(){return this.topCard?this.topCard.imageFile:null}},{key:"onChildRemoved",value:function(e){u(v(n.prototype),"onChildRemoved",this).call(this,e),e instanceof jx&&Jb.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:e.identifier})}},{key:"shuffle",value:function(){if(this.cardRoot){var e,t=this.cardRoot.children.length,n=a(this.cards);try{for(n.s();!(e=n.n()).done;){var i=e.value;i.index=Math.random()*t,i.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(i)}}catch(r){n.e(r)}finally{n.f()}return this.cards}}},{key:"drawCard",value:function(){var e=this.topCard?this.cardRoot.removeChild(this.topCard):null;return e&&(e.rotate+=this.rotate,360<e.rotate&&(e.rotate-=360),this.setSamePositionFor(e),e.toTopmost()),e}},{key:"drawCardAll",value:function(){var e,t=this.cards,n=a(t);try{for(n.s();!(e=n.n()).done;){var i=e.value;this.cardRoot.removeChild(i),i.rotate+=this.rotate,this.setSamePositionFor(i),360<i.rotate&&(i.rotate-=360)}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"faceUp",value:function(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}},{key:"faceDown",value:function(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}},{key:"faceUpAll",value:function(){var e,t=a(this.cards);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.faceUp(),this.setSamePositionFor(n)}}catch(i){t.e(i)}finally{t.f()}}},{key:"faceDownAll",value:function(){var e,t=a(this.cards);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.faceDown(),this.setSamePositionFor(n)}}catch(i){t.e(i)}finally{t.f()}}},{key:"uprightAll",value:function(){var e,t=a(this.cards);try{for(t.s();!(e=t.n()).done;){var n=e.value;n.rotate=0,this.setSamePositionFor(n)}}catch(i){t.e(i)}finally{t.f()}}},{key:"inverse",value:function(){for(var e=[];;){var t=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==t)break;e.unshift(t),t.state=t.state==Bx.FRONT?Bx.BACK:Bx.FRONT}for(var n=0,i=e;n<i.length;n++){var r=i[n];this.putOnBottom(r)}}},{key:"unifyCardsSize",value:function(e){var t,n=a(this.cards);try{for(n.s();!(t=n.n()).done;){var i=t.value;i.size!==e&&(i.size=e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"putOnTop",value:function(e){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(e);e.owner="",e.zindex=0;var t=Math.abs(e.rotate-this.rotate);return 180<t&&(t=360-t),e.rotate=t<=90?0:180,this.setSamePositionFor(e),this.cardRoot.insertBefore(e,this.topCard)}},{key:"putOnBottom",value:function(e){if(!this.cardRoot)return null;e.owner="",e.zindex=0;var t=Math.abs(e.rotate-this.rotate);return 180<t&&(t=360-t),e.rotate=t<=90?0:180,this.setSamePositionFor(e),this.cardRoot.appendChild(e)}},{key:"toTopmost",value:function(){Tx(this,["card"])}},{key:"setLocation",value:function(e){u(v(n.prototype),"setLocation",this).call(this,e);var t,i=a(this.cards);try{for(i.s();!(t=i.n()).done;)t.value.setLocation(e)}catch(r){i.e(r)}finally{i.f()}}},{key:"setSamePositionFor",value:function(e){e.location.name=this.location.name,e.location.x=this.location.x,e.location.y=this.location.y,e.posZ=this.posZ}}],[{key:"create",value:function(e,t){var n=null;(n=t?new Mx(t):new Mx).createDataElements(),n.commonDataElement.appendChild(Nk.create("name",e,{},"name_"+n.identifier));var i=new dk("cardRoot_"+n.identifier);return i.setAttribute("name","cardRoot"),i.initialize(),n.appendChild(i),n.initialize(),n}}]),n}(zk),zm([pk()],Ax.prototype,"rotate",void 0),zm([pk()],Ax.prototype,"zindex",void 0),zm([pk()],Ax.prototype,"owner",void 0),zm([pk()],Ax.prototype,"isShowTotal",void 0),Ax=Mx=zm([fk("card-stack")],Ax)),Hx=function(e){return e[e.D2=0]="D2",e[e.D4=1]="D4",e[e.D6=2]="D6",e[e.D8=3]="D8",e[e.D10=4]="D10",e[e.D10_10TIMES=5]="D10_10TIMES",e[e.D12=6]="D12",e[e.D20=7]="D20",e}({}),Vx=(Fx=Px=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).face="0",e.owner="",e.rotate=0,e.isDropShadow=!0,e.isLock=!1,e}return k(n,[{key:"name",get:function(){return this.getCommonValue("name","")},set:function(e){this.setCommonValue("name",e)}},{key:"size",get:function(){return this.getCommonValue("size",1)},set:function(e){this.setCommonValue("size",e)}},{key:"faces",get:function(){return this.imageDataElement.children.filter(function(e){return"nothing"!=e.currentValue}).map(function(e){return e.name})}},{key:"imageFile",get:function(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}},{key:"nothingFaces",get:function(){return this.imageDataElement.children.filter(function(e){return"nothing"==e.currentValue}).map(function(e){return e.name})}},{key:"ownerName",get:function(){var e=Rk.findByUserId(this.owner);return e?e.name:""}},{key:"ownerColor",get:function(){var e=Rk.findByUserId(this.owner);return e?e.color:"#444444"}},{key:"hasOwner",get:function(){return 0<this.owner.length}},{key:"isMine",get:function(){return ek.peerContext.userId===this.owner}},{key:"isVisible",get:function(){return!this.hasOwner||this.isMine}},{key:"diceRoll",value:function(){var e=this.faces;return this.face=0<e.length?e[Math.floor(Math.random()*e.length)]:"",this.face}},{key:"setDicetype",value:function(e){this.makeDiceFace(e)}},{key:"makeDiceFace",value:function(e,t){var n=this,i=1,r=[],a=function(e){return e+1+""};switch(e){case Hx.D2:i=2;break;case Hx.D4:i=4;break;case Hx.D6:i=6,r.push(Nk.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=t?"nothing_"+t:null));break;case Hx.D8:i=8;break;case Hx.D10_10TIMES:a=function(e){return e+1+"0"};case Hx.D10:i=10;break;case Hx.D12:i=12;break;case Hx.D20:i=20;break;default:i=2}for(var o=0;o<i;o++){var s=a(o);r.push(Nk.create(s,"",{type:"image"},null!=t?s+"_"+t:null))}return this.imageDataElement.children.forEach(function(e){return e.destroy()}),r.forEach(function(e){return n.imageDataElement.appendChild(e)}),this.face=this.faces[0],r}}],[{key:"create",value:function(e,t,n,i){var r=i?new Px(i):new Px;return r.createDataElements(),r.commonDataElement.appendChild(Nk.create("name",e,{},"name_"+r.identifier)),r.commonDataElement.appendChild(Nk.create("size",n,{},"size_"+r.identifier)),r.makeDiceFace(t,r.identifier),r.initialize(),r}}]),n}(zk),zm([pk()],Fx.prototype,"face",void 0),zm([pk()],Fx.prototype,"owner",void 0),zm([pk()],Fx.prototype,"rotate",void 0),zm([pk()],Fx.prototype,"isDropShadow",void 0),zm([pk()],Fx.prototype,"isLock",void 0),Fx=Px=zm([fk("dice-symbol")],Fx)),Wx=(Rx=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).aura=-1,e._sendTo=[],e._tags=[],e}return k(n,[{key:"tabIdentifier",get:function(){return this.parent.identifier}},{key:"text",get:function(){return this.value}},{key:"timestamp",get:function(){var e=this.getAttribute("timestamp"),t=e?+e:0;return Number.isNaN(t)?1:t}},{key:"sendTo",get:function(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}},{key:"tags",get:function(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}},{key:"image",get:function(){return Dk.instance.get(this.imageIdentifier)}},{key:"index",get:function(){return this.minorIndex+this.timestamp}},{key:"isDirect",get:function(){return 0<this.sendTo.length}},{key:"isSendFromSelf",get:function(){return this.from===ek.peerContext.userId||this.originFrom===ek.peerContext.userId}},{key:"isRelatedToMe",get:function(){return!!(-1<this.sendTo.indexOf(ek.peerContext.userId)||this.isSendFromSelf)}},{key:"isDisplayable",get:function(){return!this.isDirect||this.isRelatedToMe}},{key:"isSystem",get:function(){return-1<this.tags.indexOf("system")}},{key:"isDicebot",get:function(){return!!(this.isSystem&&this.from.indexOf("Dice")>=0&&this.text.indexOf(": \u8a08\u7b97\u7d50\u679c \u2192")<0)}},{key:"isCalculate",get:function(){return!!(this.isSystem&&this.from.indexOf("Dice")>=0&&this.text.indexOf(": \u8a08\u7b97\u7d50\u679c \u2192")>-1)}},{key:"isSecret",get:function(){return-1<this.tags.indexOf("secret")}},{key:"isSpecialColor",get:function(){return this.isDirect||this.isSecret||this.isSystem||this.isDicebot||this.isCalculate}}]),n}(dk),zm([pk()],Rx.prototype,"originFrom",void 0),zm([pk()],Rx.prototype,"from",void 0),zm([pk()],Rx.prototype,"to",void 0),zm([pk()],Rx.prototype,"name",void 0),zm([pk()],Rx.prototype,"tag",void 0),zm([pk()],Rx.prototype,"dicebot",void 0),zm([pk()],Rx.prototype,"imageIdentifier",void 0),zm([pk()],Rx.prototype,"color",void 0),zm([pk()],Rx.prototype,"isInverseIcon",void 0),zm([pk()],Rx.prototype,"isHollowIcon",void 0),zm([pk()],Rx.prototype,"isBlackPaint",void 0),zm([pk()],Rx.prototype,"aura",void 0),zm([pk()],Rx.prototype,"characterIdentifier",void 0),zm([pk()],Rx.prototype,"standIdentifier",void 0),zm([pk()],Rx.prototype,"standName",void 0),zm([pk()],Rx.prototype,"isUseStandImage",void 0),Rx=zm([fk("chat")],Rx)),Gx=(Dx=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).name="\u30bf\u30d6",e.isUseStandImage=!0,e._unreadLength=0,e}return k(n,[{key:"chatMessages",get:function(){return this.children}},{key:"unreadLength",get:function(){return this._unreadLength}},{key:"hasUnread",get:function(){return 0<this.unreadLength}},{key:"latestTimeStamp",get:function(){var e=this.chatMessages.length-1;return e<0?0:this.chatMessages[e].timestamp}},{key:"onChildAdded",value:function(e){u(v(n.prototype),"onChildAdded",this).call(this,e),e.parent===this&&e instanceof Wx&&e.isDisplayable&&(this._unreadLength++,Jb.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}))}},{key:"addMessage",value:function(e){e.tabIdentifier=this.identifier;var t=new Wx;for(var n in e)"identifier"!==n&&"tabIdentifier"!==n&&("text"!==n?null!=e[n]&&""!==e[n]&&t.setAttribute(n,e[n]):t.value=e[n]);return t.initialize(),Jb.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:t.identifier}),this.appendChild(t),t}},{key:"markForRead",value:function(){this._unreadLength=0}},{key:"innerXml",value:function(){var e,t="",n=a(this.children);try{for(n.s();!(e=n.n()).done;){var i=e.value;i instanceof Wx&&!i.isDisplayable||(t+=lk.instance.toXml(i))}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"parseInnerXml",value:function(e){return u(v(n.prototype),"parseInnerXml",this).call(this,e)}}]),n}(dk),zm([pk()],Dx.prototype,"name",void 0),zm([pk()],Dx.prototype,"isUseStandImage",void 0),Dx=zm([fk("chat-tab")],Dx)),Zx=(Lx=Nx=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"chatTabs",get:function(){return this.children}},{key:"addChatTab",value:function(){var e=null;if((arguments.length<=0?void 0:arguments[0])instanceof Gx)e=arguments.length<=0?void 0:arguments[0];else{var t=arguments.length<=0?void 0:arguments[0];(e=new Gx(arguments.length<=1?void 0:arguments[1])).name=t,e.initialize()}return this.appendChild(e)}},{key:"parseInnerXml",value:function(e){var t,i=a(Nx.instance.children);try{for(i.s();!(t=i.n()).done;)t.value.destroy()}catch(o){i.e(o)}finally{i.f()}var r=Nx.instance.toContext();r.syncData=this.toContext().syncData,Nx.instance.apply(r),Nx.instance.update(),u(v(n.prototype),"parseInnerXml",this).apply(Nx.instance,[e]),this.destroy()}}],[{key:"instance",get:function(){return Nx._instance||(Nx._instance=new Nx("ChatTabList"),Nx._instance.initialize()),Nx._instance}}]),n}(dk),Lx=Nx=zm([fk("chat-tab-list")],Lx)),Yx=((zx=function(){function e(){y(this,e),this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://ntp-a1.nict.go.jp/cgi-bin/json","https://ntp-b1.nict.go.jp/cgi-bin/json"],this.gameType=""}return k(e,[{key:"chatTabs",get:function(){return Zx.instance.chatTabs}},{key:"calibrateTimeOffset",value:function(){var e=this;if(null==this.intervalTimer){var t=Math.floor(Math.random()*this.ntpApiUrls.length),n=this.ntpApiUrls[t],i=performance.now();fetch(n).then(function(e){if(e.ok)return e.json();throw new Error("Network response was not ok.")}).then(function(t){var n=performance.now(),r=(n-i)/2,a=1e3*t.st;e.timeOffset=a+r,e.performanceOffset=n,console.log("latency: "+r+"ms"),console.log("st: "+a),console.log("timeOffset: "+e.timeOffset),console.log("performanceOffset: "+e.performanceOffset),e.setIntervalTimer()}).catch(function(t){console.warn("There has been a problem with your fetch operation: ",t.message),e.setIntervalTimer()}),this.setIntervalTimer()}else console.log("calibrateTimeOffset was canceled.")}},{key:"setIntervalTimer",value:function(){var e=this;null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(function(){e.intervalTimer=null,e.calibrateTimeOffset()},216e5)}},{key:"getTime",value:function(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}},{key:"sendMessage",value:function(t,n,i,r,a,o,s,l,c,u,h,d,f,p,g){var m=!(h&&this.findFaceIconIdentifier(r)),v={from:ek.peerContext.userId,to:e.findId(a),name:this.makeMessageName(r,a),imageIdentifier:this.findImageIdentifier(r,h),timestamp:this.calcTimeStamp(t),tag:i,text:gk.cr(n),color:o,isInverseIcon:m&&s?1:0,isHollowIcon:m&&l?1:0,isBlackPaint:m&&c?1:0,aura:m?u:-1,characterIdentifier:d,standIdentifier:f,standName:p,isUseStandImage:g};return t.addMessage(v)}},{key:"findObjectName",value:function(e){var t=tk.instance.get(e);return t instanceof jk||t instanceof Rk?t.name:e}},{key:"makeMessageName",value:function(e,t){var n=this.findObjectName(e);return null==t||t.length<1?n:n+" \u27a1 "+this.findObjectName(t)}},{key:"findImageIdentifier",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=tk.instance.get(e);return n instanceof jk?t&&n.faceIcon&&0<n.faceIcon.url.length?n.faceIcon.identifier:n.imageFile?n.imageFile.identifier:"":n instanceof Rk?n.imageIdentifier:e}},{key:"findFaceIconIdentifier",value:function(e){var t=tk.instance.get(e);return t instanceof jk&&t.faceIcon&&0<t.faceIcon.url.length?t.faceIcon.identifier:""}},{key:"calcTimeStamp",value:function(e){var t=this.getTime(),n=e.latestTimeStamp;return t<=n?n+1:t}}],[{key:"findId",value:function(e){var t=tk.instance.get(e);return t instanceof jk?t.identifier:t instanceof Rk?t.userId:null}}]),e}()).\u0275fac=function(e){return new(e||zx)},zx.\u0275prov=Ae({token:zx,factory:zx.\u0275fac}),zx),qx=["chatInput"],Xx=["chatPlette"];function Kx(e,t){1&e&&qo(0,"badge",12),2&e&&Wo("count",is().$implicit.unreadLength)}function $x(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",10),es("ngModelChange",function(e){return Jt(n),is().chatTabidentifier=e}),Yo(),Zo(2,"div"),zs(3),Uo(4,Kx,1,1,"badge",11),Yo(),Yo()}if(2&e){var i=t.$implicit,r=is();sa(1),ss("value",i.identifier),Wo("ngModel",r.chatTabidentifier),sa(2),Ls(i.name),sa(1),Wo("ngIf",i.hasUnread)}}function Qx(e,t){1&e&&(Zo(0,"div",13),Zo(1,"i",14),zs(2,"info_outline"),Yo(),zs(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),Yo())}function Jx(e,t){if(1&e&&(Zo(0,"option",19),zs(1),Yo()),2&e){var n=is().$implicit;ks("color",is(3).color),ss("value",n),sa(1),Ls(n)}}function eC(e,t){if(1&e&&(Xo(0),Uo(1,Jx,2,4,"option",18),Ko()),2&e){var n=t.$implicit,i=is(3);sa(1),Wo("ngIf",i.filter(n))}}function tC(e,t){if(1&e&&(Xo(0),Uo(1,eC,2,1,"ng-container",3),Ko()),2&e){var n=is(2);sa(1),Wo("ngForOf",n.palette.getPalette())}}function nC(e,t){if(1&e){var n=Qo();Zo(0,"div",15),Zo(1,"select",16,17),es("input",function(e){return Jt(n),is().selectPalette(e.target.value)})("click",function(e){return Jt(n),is().clickPalette(e.target.value)}),Uo(3,tC,2,1,"ng-container",9),Yo(),Yo()}if(2&e){var i=is();sa(3),Wo("ngIf",i.palette)}}function iC(e,t){if(1&e){var n=Qo();Zo(0,"div",15),Zo(1,"textarea",20),es("ngModelChange",function(e){return Jt(n),is().editPalette=e}),Yo(),Yo()}if(2&e){var i=is();sa(1),Wo("ngModel",i.editPalette)}}function rC(e,t){1&e&&(Zo(0,"span"),zs(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),Yo())}function aC(e,t){1&e&&(Zo(0,"span"),zs(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),Yo())}var oC,sC=((oC=function(){function e(t,n){y(this,e),this.chatMessageService=t,this.panelService=n,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}return k(e,[{key:"palette",get:function(){return this.character.chatPalette}},{key:"color",get:function(){return this.chatInputComponent.color}},{key:"gameType",get:function(){return this._gameType},set:function(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}},{key:"sendFrom",get:function(){return this.character.identifier},set:function(e){this.onSelectedCharacter(e)}},{key:"diceBotInfos",get:function(){return Vk.diceBotInfos}},{key:"chatTab",get:function(){return tk.instance.get(this.chatTabidentifier)}},{key:"myPeer",get:function(){return Rk.myCursor}},{key:"otherPeers",get:function(){return tk.instance.getObjects(Rk)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.updatePanelTitle()}),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Jb.register(this).on("DELETE_GAME_OBJECT",-1e3,function(t){e.character&&e.character.identifier===t.data.identifier&&e.panelService.close(),e.chatTabidentifier===t.data.identifier&&(e.chatTabidentifier=e.chatMessageService.chatTabs?e.chatMessageService.chatTabs[0].identifier:"")})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this),this.isEdit&&this.toggleEditMode()}},{key:"updatePanelTitle",value:function(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}},{key:"onSelectedCharacter",value:function(e){this.isEdit&&this.toggleEditMode();var t=tk.instance.get(e);if(t instanceof jk){this.character=t;var n=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<n.length&&(this.gameType=n)}this.updatePanelTitle()}},{key:"selectPalette",value:function(e){this.text=e}},{key:"clickPalette",value:function(e){var t=this;if(this.chatPletteElementRef.nativeElement){var n=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=n,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(function(){t.doubleClickTimer=null},400))}}},{key:"sendChat",value:function(e){if(this.chatTab){var t=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,t,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}},{key:"resetPletteSelect",value:function(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}},{key:"toggleEditMode",value:function(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}},{key:"filter",value:function(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}}]),e}()).\u0275fac=function(e){return new(e||oC)(Vo(Yx),Vo(Wk))},oC.\u0275cmp=ct({type:oC,selectors:[["chat-palette"]],viewQuery:function(e,t){var n;1&e&&(Sc(qx,3),Sc(Xx,1)),2&e&&(Ec(n=Tc())&&(t.chatInputComponent=n.first),Ec(n=Tc())&&(t.chatPletteElementRef=n.first))},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"div",1),Zo(2,"form"),Zo(3,"div",2),Uo(4,$x,5,4,"label",3),Yo(),Yo(),Zo(5,"chat-input",4,5),es("gameTypeChange",function(e){return t.gameType=e})("sendFromChange",function(e){return t.sendFrom=e})("textChange",function(e){return t.text=e})("chat",function(e){return t.sendChat(e)}),Yo(),Uo(7,Qx,4,0,"div",6),Yo(),Uo(8,nC,4,1,"div",7),Uo(9,iC,2,1,"div",7),Zo(10,"div",1),Zo(11,"button",8),es("click",function(){return t.toggleEditMode()}),Uo(12,rC,2,0,"span",9),Uo(13,aC,2,0,"span",9),Yo(),Yo(),Yo()),2&e&&(sa(4),Wo("ngForOf",t.chatMessageService.chatTabs),sa(1),Wo("onlyCharacters",!0)("chatTabidentifier",t.chatTabidentifier)("gameType",t.gameType)("sendFrom",t.sendFrom)("text",t.text),sa(2),Wo("ngIf",t.isEdit),sa(1),Wo("ngIf",!t.isEdit),sa(1),Wo("ngIf",t.isEdit),sa(3),Wo("ngIf",!t.isEdit),sa(1),Wo("ngIf",t.isEdit))},styles:[".edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:rgba(30,30,30,.8)}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}"]}),oC);function lC(e,t){if(1&e&&(Zo(0,"div",11),zs(1),Yo()),2&e){var n=is(2);sa(1),Ls(n.isSpeaking?"\ud83d\ude03":"\ud83e\udd10")}}var cC=function(e){return{transform:e}},uC=function(e){return{inverse:e}},hC=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}},dC=function(e,t){return{"black-paint":e,hollow:t}};function fC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div"),Zo(2,"div",5),Zo(3,"div",6),Zo(4,"span",7),Zo(5,"img",8),es("dblclick",function(){return Jt(n),is().openModal()}),hc(6,"safe"),Yo(),Yo(),Yo(),Yo(),Zo(7,"button",9),es("click",function(){return Jt(n),is().openModal()}),Zo(8,"b"),zs(9),Yo(),Yo(),Uo(10,lC,2,1,"div",10),Yo(),Ko()}if(2&e){var i=is();sa(2),Wo("ngStyle",rc(10,cC,i.isApplyRoll?"rotate("+i.gameCharacter.roll+"deg)":"")),sa(1),Wo("ngClass",rc(12,uC,i.isApplyImageEffect&&i.gameCharacter.isInverse)),sa(1),Wo("ngClass",lc(14,hC,i.isApplyImageEffect&&0==i.gameCharacter.aura,i.isApplyImageEffect&&1==i.gameCharacter.aura,i.isApplyImageEffect&&2==i.gameCharacter.aura,i.isApplyImageEffect&&3==i.gameCharacter.aura,i.isApplyImageEffect&&4==i.gameCharacter.aura,i.isApplyImageEffect&&5==i.gameCharacter.aura,i.isApplyImageEffect&&6==i.gameCharacter.aura,i.isApplyImageEffect&&7==i.gameCharacter.aura)),sa(1),Wo("src",dc(6,7,i.standImage.url,"resourceUrl"),dr)("ngClass",ac(23,dC,i.isApplyImageEffect&&i.gameCharacter.isBlackPaint,i.isApplyImageEffect&&i.gameCharacter.isHollow)),sa(4),Bs("",i.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),sa(1),Wo("ngIf",i.isSpeakable)}}function pC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"span",12),Zo(2,"input",13),es("ngModelChange",function(e){return Jt(n),is().nameElement.value=e}),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(2),Wo("ngModel",i.nameElement.value)}}function gC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"b",12),zs(2,"\u3000Cond: "),Yo(),Zo(3,"select",14),es("ngModelChange",function(e){return Jt(n),is().conditionTypeElement.value=e}),Zo(4,"option",15),zs(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),Yo(),Zo(6,"option",15),zs(7,"\u6307\u5b9a\u753b\u50cf"),Yo(),Zo(8,"option",15),zs(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),Yo(),Zo(10,"option",15),zs(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),Yo(),Zo(12,"option",15),zs(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),Yo(),Zo(14,"option",15),zs(15,"\u9078\u629e\u6642\u306e\u307f"),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(3),Wo("ngModel",i.conditionTypeElement.value),sa(1),ss("value",i.standConditionType.Default),sa(2),ss("value",i.standConditionType.Image),sa(2),ss("value",i.standConditionType.Postfix),sa(2),ss("value",i.standConditionType.PostfixOrImage),sa(2),ss("value",i.standConditionType.PostfixAndImage),sa(2),ss("value",i.standConditionType.NotConditionStandUp)}}function mC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"span",12),Zo(2,"b",16),zs(3,"Tag: "),Yo(),Zo(4,"input",17),es("ngModelChange",function(e){return Jt(n),is().nameElement.currentValue=e}),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(4),Wo("ngModel",i.nameElement.currentValue)}}function vC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"label",18),Zo(2,"input",19),es("ngModelChange",function(e){return Jt(n),is().applyImageEffectElement.value=e})("change",function(){Jt(n);var e=is();return e.applyImageEffectElement.value=e.applyImageEffectElement.value?"applyImageEffect":""}),Yo(),Zo(3,"b",12),zs(4,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u52b9\u679c\u3092\u53cd\u6620"),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(2),ss("checked",i.applyImageEffectElement.value?"checked":""),Wo("ngModel",i.applyImageEffectElement.value)}}function yC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"label",18),Zo(2,"input",19),es("ngModelChange",function(e){return Jt(n),is().applyRollElement.value=e})("change",function(){Jt(n);var e=is();return e.applyRollElement.value=e.applyRollElement.value?"applyRoll":""}),Yo(),Zo(3,"b",12),zs(4,"\u56de\u8ee2\u3092\u53cd\u6620"),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(2),ss("checked",i.applyRollElement.value?"checked":""),Wo("ngModel",i.applyRollElement.value)}}function bC(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"label",20),Zo(2,"input",19),es("ngModelChange",function(e){return Jt(n),is().applyDialogElement.value=e})("change",function(){Jt(n);var e=is();return e.applyDialogElement.value=e.applyDialogElement.value?"applyDialog":""}),Yo(),Zo(3,"b",12),zs(4,"\ud83d\udcad"),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(2),ss("checked",i.applyDialogElement.value?"checked":""),Wo("ngModel",i.applyDialogElement.value)}}var kC=function(e){return{"disabled-text":e}};function _C(e,t){if(1&e){var n=Qo();Xo(0),qo(1,"br"),Zo(2,"button",21),es("click",function(){return Jt(n),is().testStandUp()}),Zo(3,"b"),zs(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),Yo(),Yo(),Zo(5,"label",20),Zo(6,"input",19),es("ngModelChange",function(e){return Jt(n),is().positionElement.currentValue=e})("change",function(){Jt(n);var e=is();return e.positionElement.currentValue=e.positionElement.currentValue?"posSpecialize":""}),Yo(),Zo(7,"b",12),zs(8,"Pos\u500b\u5225\u6307\u5b9a: "),Yo(),Yo(),Zo(9,"span",22),Zo(10,"input",23),es("ngModelChange",function(e){return Jt(n),is().positionElement.value=e}),Yo(),Zo(11,"input",24),es("ngModelChange",function(e){return Jt(n),is().positionElement.value=e}),Yo(),Zo(12,"b",25),zs(13,"%"),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(6),ss("checked",i.positionElement.currentValue?"checked":""),Wo("ngModel",i.positionElement.currentValue),sa(4),Wo("ngModel",i.positionElement.value)("disabled",!i.positionElement.currentValue),sa(1),Wo("ngModel",i.positionElement.value)("disabled",!i.positionElement.currentValue),sa(1),Wo("ngClass",rc(7,kC,!i.positionElement.currentValue))}}function wC(e,t){if(1&e){var n=Qo();Xo(0),qo(1,"br"),Zo(2,"span",22),Zo(3,"b",26),zs(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),Yo(),Zo(5,"input",27),es("ngModelChange",function(e){return Jt(n),is().heightElement.value=e}),Yo(),Zo(6,"input",28),es("ngModelChange",function(e){return Jt(n),is().heightElement.value=e}),Yo(),Zo(7,"b",29),zs(8,"%"),Yo(),Yo(),Zo(9,"span",30),Zo(10,"b",26),zs(11,"AdjY: "),Yo(),Zo(12,"input",31),es("ngModelChange",function(e){return Jt(n),is().heightElement.currentValue=e}),Yo(),Zo(13,"b",29),zs(14,"%"),Yo(),Yo(),Ko()}if(2&e){var i=is();sa(5),Wo("ngModel",i.heightElement.value),sa(1),Wo("ngModel",i.heightElement.value),sa(6),Wo("ngModel",i.heightElement.currentValue)}}function xC(e,t){if(1&e){var n=Qo();Zo(0,"div"),Zo(1,"textarea",32),es("ngModelChange",function(e){return Jt(n),is().postfixElement.value=e}),Yo(),Yo()}if(2&e){var i=is();sa(1),Wo("ngModel",i.postfixElement.value)}}var CC=function(e){return{"current-icon":e}};function EC(e,t){if(1&e){var n=Qo();Zo(0,"div",37),Zo(1,"img",38),es("click",function(){Jt(n);var e=is().$implicit;return is(3).selectImage(e.identifier)}),hc(2,"safe"),Yo(),Yo()}if(2&e){var i=is().$implicit,r=is(3);Wo("ngClass",rc(6,CC,r.isSelectedImage(i.identifier))),sa(1),Wo("src",dc(2,3,i.url,"resourceUrl"),dr)("alt",i.name)}}function SC(e,t){if(1&e&&(Xo(0),Uo(1,EC,3,8,"div",36),Ko()),2&e){var n=t.$implicit;sa(1),Wo("ngIf",0<n.url.length)}}function TC(e,t){if(1&e&&(Zo(0,"div",34),Uo(1,SC,2,1,"ng-container",35),Yo()),2&e){var n=is(2);sa(1),Wo("ngForOf",n.imageList)}}function OC(e,t){1&e&&(Zo(0,"div"),zs(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),Yo())}function IC(e,t){if(1&e&&(Zo(0,"div"),Uo(1,TC,2,1,"div",33),Uo(2,OC,2,0,"div",2),Yo()),2&e){var n=is();sa(1),Wo("ngIf",n.imageList&&n.imageList.length>0),sa(1),Wo("ngIf",!n.imageList||0==n.imageList.length)}}var MC,AC,PC=((AC=function(){function e(t){y(this,e),this.modalService=t,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=Wm.Empty,this.standConditionType=Lk}return k(e,[{key:"ngOnInit",value:function(){}},{key:"standImage",get:function(){if(!this.standElement)return this._imageFile;var e=null;if(this.isSpeaking&&((e=this.standElement.getFirstElementByName("speakingImageIdentifier"))||(e=this.standElement.appendChild(Nk.create("speakingImageIdentifier",Wm.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),e&&e.value&&e.value!=Wm.Empty.identifier||(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){var t=Dk.instance.get(e.value);this._imageFile=t||Wm.Empty}}else{var n=Wm.createEmpty("stand_no_image").toContext();n.url="./assets/images/nc96424.png",this._imageFile=Dk.instance.add(n),this.standElement.appendChild(Nk.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}},{key:"nameElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(Nk.create("name","",{},"name_"+this.standElement.identifier)):null}},{key:"heightElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(Nk.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}},{key:"conditionTypeElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(Nk.create("conditionType",Lk.Default,{},"conditionType_"+this.standElement.identifier)):null}},{key:"postfixElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(Nk.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}},{key:"applyImageEffectElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(Nk.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}},{key:"applyRollElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(Nk.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}},{key:"applyDialogElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(Nk.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}},{key:"positionElement",get:function(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(Nk.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}},{key:"isApplyImageEffect",get:function(){var e=this.applyImageEffectElement;return!(!e||!e.value)}},{key:"isApplyRoll",get:function(){var e=this.applyRollElement;return!(!e||!e.value)}},{key:"isApplyDialog",get:function(){var e=this.applyDialogElement;return!(!e||!e.value)}},{key:"isSpeakable",get:function(){if(!this.standElement)return!1;var e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Wm.Empty.identifier}},{key:"openModal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"imageIdentifier",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.standElement){var n=this.standElement.getFirstElementByName(e);n||(n=this.standElement.appendChild(Nk.create(e,"",{type:"image"},e+"_"+this.standElement.identifier))),this.modalService.open(Sx,{isAllowedEmpty:t}).then(function(e){e&&(n.value=e)})}}},{key:"openSpeakingModal",value:function(){this.openModal("speakingImageIdentifier",!0)}},{key:"remove",value:function(){this.standElement&&this.standElement.parent.removeChild(this.standElement)}},{key:"selectImage",value:function(e){if(this.standElement){var t,n=!1,i=a(this.standElement.getElementsByName("targetImageIdentifier"));try{for(i.s();!(t=i.n()).done;){var r,o=t.value,s=!0,l=a(this.imageList);try{for(l.s();!(r=l.n()).done;)if(r.value.identifier==o.value){s=!1;break}}catch(c){l.e(c)}finally{l.f()}s?this.standElement.removeChild(o):o.value==e&&(n=!0,this.standElement.removeChild(o))}}catch(c){i.e(c)}finally{i.f()}n||this.standElement.appendChild(Nk.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+Hb.generateUuid()))}}},{key:"isSelectedImage",value:function(e){var t,n=a(this.standElement.getElementsByName("targetImageIdentifier"));try{for(n.s();!(t=n.n()).done;)if(t.value.value==e)return!0}catch(i){n.e(i)}finally{n.f()}return!1}},{key:"testStandUp",value:function(){Jb.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),Jb.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8\u30c6\u30b9\u30c8",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}]),e}()).\u0275fac=function(e){return new(e||AC)(Vo(Zk))},AC.\u0275cmp=ct({type:AC,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:19,vars:13,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.3em"],[2,"font-size","9px","margin-right","1em",3,"click"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\n@\u6012\u308a\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,t){1&e&&(Zo(0,"div"),Zo(1,"div",0),Zo(2,"div",1),Uo(3,fC,11,26,"ng-container",2),Yo(),Zo(4,"div",3),Zo(5,"div"),Uo(6,pC,3,1,"ng-container",2),Uo(7,gC,16,7,"ng-container",2),Uo(8,mC,5,1,"ng-container",2),Yo(),Zo(9,"div"),Uo(10,vC,5,2,"ng-container",2),Uo(11,yC,5,2,"ng-container",2),Uo(12,bC,5,2,"ng-container",2),Zo(13,"button",4),es("click",function(){return t.openSpeakingModal()}),zs(14,"\u53e3\u30d1\u30af\u30a2\u30cb\u30e1 (APNG\u306a\u3069)"),Yo(),Uo(15,_C,14,9,"ng-container",2),Uo(16,wC,15,3,"ng-container",2),Yo(),Uo(17,xC,2,1,"div",2),Uo(18,IC,3,2,"div",2),Yo(),Yo(),Yo()),2&e&&(sa(3),Wo("ngIf",t.standImage),sa(3),Wo("ngIf",t.nameElement),sa(1),Wo("ngIf",t.conditionTypeElement),sa(1),Wo("ngIf",t.nameElement),sa(2),Wo("ngIf",t.applyImageEffectElement),sa(1),Wo("ngIf",t.applyRollElement),sa(1),Wo("ngIf",t.applyDialogElement),sa(1),ks("font-weight",t.isSpeakable?"bolder":"normal"),sa(2),Wo("ngIf",t.positionElement),sa(1),Wo("ngIf",t.heightElement),sa(1),Wo("ngIf",t.postfixElement&&(t.conditionTypeElement.value==t.standConditionType.Postfix||t.conditionTypeElement.value==t.standConditionType.PostfixOrImage||t.conditionTypeElement.value==t.standConditionType.PostfixAndImage)),sa(1),Wo("ngIf",t.conditionTypeElement.value==t.standConditionType.Image||t.conditionTypeElement.value==t.standConditionType.PostfixOrImage||t.conditionTypeElement.value==t.standConditionType.PostfixAndImage))},directives:[dh,Sh,lh,Ed,Xd,Ef,Bf,jf,$f,wd,Rf,Of,uh],pipes:[Lw],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image[_ngcontent-%COMP%], .stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted red}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:grey}"]}),AC),DC=((MC=function(){function e(t){var n=this;y(this,e),this.ngZone=t,this.callbackOnPointerDown=function(e){return n.onPointerDown(e)},this.callbackOnPointerMove=function(e){return n.onPointerMove(e)},this.callbackOnPointerUp=function(e){return n.onPointerUp(e)},this.callbackOnContextMenu=function(e){return n.onContextMenu(e)},this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}return k(e,[{key:"isAllowedToOpenContextMenu",get:function(){return this._isAllowedToOpenContextMenu}},{key:"pointer",get:function(){return this.primaryPointer}},{key:"pointerX",get:function(){return this.primaryPointer.x}},{key:"pointerY",get:function(){return this.primaryPointer.y}},{key:"isDragging",get:function(){return this._isDragging},set:function(e){var t=this;e!==this._isDragging&&this.ngZone.run(function(){return t._isDragging=e})}},{key:"initialize",value:function(){this.addEventListeners()}},{key:"destroy",value:function(){this.removeEventListeners()}},{key:"onPointerDown",value:function(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}},{key:"onPointerMove",value:function(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}},{key:"onPointerUp",value:function(e){this.onPointerMove(e)}},{key:"onMouseMove",value:function(e){var t={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(t)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(t),this.pointers=[t],this.primaryPointer=t)}},{key:"onTouchMove",value:function(e){var t=e.touches.length;if(!(t<1)){this.pointers=[];for(var n=0;n<t;n++){var i=e.touches[n],r={x:i.pageX,y:i.pageY,z:0,identifier:i.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(r),this.pointers.push(r)}this.primaryPointer=this.pointers[0]}}},{key:"onContextMenu",value:function(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}},{key:"preventContextMenuIfNeeded",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3,n=Math.pow(e.x-this.startPostion.x,2)+Math.pow(e.y-this.startPostion.y,2);Math.pow(t,2)<n&&(this._isAllowedToOpenContextMenu=!1)}},{key:"isSyntheticEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,i=a(this.pointers);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.identifier!==e.identifier&&Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2)<Math.pow(n,2))return!0}}catch(o){i.e(o)}finally{i.f()}return!1}},{key:"addEventListeners",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){document.body.addEventListener("mousedown",e.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",e.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",e.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",e.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",e.callbackOnPointerMove,!0),document.body.addEventListener("touchend",e.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",e.callbackOnPointerUp,!0),document.body.addEventListener("drop",e.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",e.callbackOnContextMenu,!0)})}},{key:"removeEventListeners",value:function(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}]),e}()).\u0275fac=function(e){return new(e||MC)(wi($c))},MC.\u0275prov=Ae({token:MC,factory:MC.\u0275fac,providedIn:"root"}),MC);function RC(e,t){if(1&e){var n=Qo();Zo(0,"div",12),Zo(1,"div",13),Zo(2,"div",14),Zo(3,"input",15),es("click",function(){Jt(n);var e=t.index;return is().overviewIndex=e}),Yo(),Yo(),Zo(4,"div",16),qo(5,"stand-element",17,18),Yo(),Zo(7,"div",19),Zo(8,"button",20),es("click",function(){Jt(n);var e=t.$implicit,i=t.index;return is().delele(e,i)}),zs(9,"\xd7"),Yo(),Zo(10,"button",21),es("click",function(){Jt(n);var e=t.$implicit;return is().upStandIndex(e)}),zs(11,"\u2191"),Yo(),Zo(12,"button",22),es("click",function(){Jt(n);var e=t.$implicit;return is().downStandIndex(e)}),zs(13,"\u2193"),Yo(),Yo(),Yo(),qo(14,"hr"),Yo()}if(2&e){var i=t.$implicit,r=t.index,a=is();sa(1),ks("border-color",a.overviewIndex==r?"red":"transparent"),sa(2),ls("name","",a.panelId,"_overviewIndex"),ss("value",r),Wo("checked",a.overviewIndex==r),sa(2),Wo("standElement",i)("imageList",a.imageList)("gameCharacter",a.character)}}var FC,NC,zC,LC,BC,jC,UC,HC,VC,WC,GC,ZC,YC=((FC=function(){function e(t,n){y(this,e),this.panelService=t,this.pointerDeviceService=n,this.character=null,this.isSpeaking=!1}return k(e,[{key:"standElements",get:function(){return this.character.standList.standElements}},{key:"imageList",get:function(){if(!this.character)return[];var e,t=[],n={},i=a(this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon")));try{for(i.s();!(e=i.n()).done;){var r=e.value;if(!n[r.value]){var o=this.imageElementToFile(r);o&&(n[r.value]=!0,t.push(o))}}}catch(s){i.e(s)}finally{i.f()}return t}},{key:"position",get:function(){return this.character&&this.character.standList?this.character.standList.position:0},set:function(e){this.character&&this.character.standList&&(this.character.standList.position=e)}},{key:"height",get:function(){return this.character&&this.character.standList?this.character.standList.height:0},set:function(e){this.character&&this.character.standList&&(this.character.standList.height=e)}},{key:"overviewIndex",get:function(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1},set:function(e){this.character&&this.character.standList&&(this.character.standList.overviewIndex=e)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.updatePanelTitle()}),Jb.register(this).on("DELETE_GAME_OBJECT",-1e3,function(t){e.character&&e.character.identifier===t.data.identifier&&e.panelService.close()}),this.panelId=Hb.generateUuid()}},{key:"ngAfterViewInit",value:function(){var e=this;this._intervalId=setInterval(function(){e.isSpeaking=!e.isSpeaking,e.standElementComponents.forEach(function(t){t.isSpeaking=e.isSpeaking})},3600)}},{key:"ngOnDestroy",value:function(){clearInterval(this._intervalId),Jb.unregister(this)}},{key:"updatePanelTitle",value:function(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}},{key:"add",value:function(){this.character.standList.add(this.character.imageFile.identifier)}},{key:"delele",value:function(e,t){this.character&&this.character.standList&&window.confirm("\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f")&&this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==t?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>t&&(this.character.standList.overviewIndex-=1))}},{key:"upStandIndex",value:function(e){var t=this.character.standList,n=t.children.indexOf(e);0<n&&(t.insertBefore(e,t.children[n-1]),this.character.standList.overviewIndex==n?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==n-1&&(this.character.standList.overviewIndex+=1))}},{key:"downStandIndex",value:function(e){var t=this.character.standList,n=t.children.indexOf(e);n<t.children.length-1&&(t.insertBefore(t.children[n+1],e),this.character.standList.overviewIndex==n?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==n+1&&(this.character.standList.overviewIndex-=1))}},{key:"helpStandSeteing",value:function(){var e=this.pointerDeviceService.pointers[0],t=this.panelService.open(_w,{left:e.x,top:e.y,width:600,height:590});t.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",t.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}},{key:"imageElementToFile",value:function(e){return e?Dk.instance.get(e.value):null}}]),e}()).\u0275fac=function(e){return new(e||FC)(Vo(Wk),Vo(DC))},FC.\u0275cmp=ct({type:FC,selectors:[["app-stand-setting"]],viewQuery:function(e,t){var n;1&e&&Sc(PC,1),2&e&&Ec(n=Tc())&&(t.standElementComponents=n)},inputs:{character:"character"},decls:26,vars:9,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"button",1),es("click",function(){return t.helpStandSeteing()}),zs(2,"?"),Yo(),Zo(3,"div",2),Zo(4,"b"),zs(5,"Pos: "),Yo(),Zo(6,"input",3),es("ngModelChange",function(e){return t.position=e}),Yo(),Zo(7,"input",4),es("ngModelChange",function(e){return t.position=e}),Yo(),Zo(8,"b",5),zs(9,"\uff05\u3000"),Yo(),Yo(),Zo(10,"div",2),Zo(11,"b"),zs(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),Yo(),Zo(13,"input",3),es("ngModelChange",function(e){return t.height=e}),Yo(),Zo(14,"input",4),es("ngModelChange",function(e){return t.height=e}),Yo(),Zo(15,"b",5),zs(16,"\uff05"),Yo(),Yo(),Yo(),Zo(17,"div",6),Zo(18,"label",7),Zo(19,"input",8),es("click",function(){return t.overviewIndex=-1}),Yo(),zs(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),Yo(),Yo(),qo(21,"hr"),Zo(22,"div",9),Uo(23,RC,15,8,"div",10),Yo(),Zo(24,"button",11),es("click",function(){return t.add()}),zs(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),Yo()),2&e&&(sa(6),Wo("ngModel",t.position),sa(1),Wo("ngModel",t.position),sa(6),Wo("ngModel",t.height),sa(1),Wo("ngModel",t.height),sa(3),ks("border-color",-1==t.overviewIndex?"red":"transparent"),sa(2),ls("name","",t.panelId,"_overviewIndex"),Wo("checked",-1==t.overviewIndex),sa(4),Wo("ngForOf",t.standElements))},directives:[Rf,Ed,Xd,Ef,Of,uh,PC],styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%], .remove-button[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),FC),qC=function(e){return e.ASC="ASC",e.DESC="DESC",e}({}),XC=(zC=NC=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).sortTag="name",e.sortOrder=qC.ASC,e.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b",e}return k(n,[{key:"dataTags",get:function(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}},{key:"innerXml",value:function(){return""}},{key:"parseInnerXml",value:function(e){var t=NC.instance.toContext();t.syncData=this.toContext().syncData,NC.instance.apply(t),NC.instance.update(),this.destroy()}}],[{key:"instance",get:function(){return NC._instance||(NC._instance=new NC("DataSummarySetting"),NC._instance.initialize()),NC._instance}}]),n}(ck),zm([pk()],zC.prototype,"sortTag",void 0),zm([pk()],zC.prototype,"sortOrder",void 0),zm([pk()],zC.prototype,"dataTag",void 0),zC=NC=zm([fk("summary-setting")],zC)),KC=(BC=LC=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).isLock=!1,e}return k(n,[{key:"name",get:function(){return this.getCommonValue("name","")}},{key:"width",get:function(){return this.getCommonValue("width",1)}},{key:"height",get:function(){return this.getCommonValue("height",1)}},{key:"opacity",get:function(){var e=this.getElement("opacity",this.commonDataElement),t=e?e.currentValue/e.value:1;return Number.isNaN(t)?1:t}}],[{key:"create",value:function(e,t,n,i,r){var a=null;return(a=r?new LC(r):new LC).createDataElements(),a.commonDataElement.appendChild(Nk.create("name",e,{},"name_"+a.identifier)),a.commonDataElement.appendChild(Nk.create("width",t,{},"width_"+a.identifier)),a.commonDataElement.appendChild(Nk.create("height",n,{},"height_"+a.identifier)),a.commonDataElement.appendChild(Nk.create("opacity",i,{type:"numberResource",currentValue:i},"opacity_"+a.identifier)),a.initialize(),a}}]),n}(zk),zm([pk()],BC.prototype,"isLock",void 0),BC=LC=zm([fk("table-mask")],BC)),$C=function(e){return e[e.NULL=0]="NULL",e[e.FLOOR=1]="FLOOR",e[e.WALL=2]="WALL",e[e.ALL=3]="ALL",e}({}),QC=(UC=jC=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).isLocked=!1,e.mode=$C.ALL,e.rotate=0,e.isDropShadow=!0,e.isSurfaceShading=!0,e.isInteract=!0,e.isSlope=!1,e}return k(n,[{key:"width",get:function(){return this.getCommonValue("width",1)},set:function(e){this.setCommonValue("width",e)}},{key:"height",get:function(){return this.getCommonValue("height",1)},set:function(e){this.setCommonValue("height",e)}},{key:"depth",get:function(){return this.getCommonValue("depth",1)},set:function(e){this.setCommonValue("depth",e)}},{key:"name",get:function(){return this.getCommonValue("name","")},set:function(e){this.setCommonValue("name",e)}},{key:"wallImage",get:function(){return this.getImageFile("wall")}},{key:"floorImage",get:function(){return this.getImageFile("floor")}},{key:"hasWall",get:function(){return!!(this.mode&$C.WALL)}},{key:"hasFloor",get:function(){return!!(this.mode&$C.FLOOR)}}],[{key:"create",value:function(e,t,n,i,r,a,o){var s=null;return(s=o?new jC(o):new jC).createDataElements(),s.commonDataElement.appendChild(Nk.create("name",e,{},"name_"+s.identifier)),s.commonDataElement.appendChild(Nk.create("width",t,{},"width_"+s.identifier)),s.commonDataElement.appendChild(Nk.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(Nk.create("depth",n,{},"depth_"+s.identifier)),s.commonDataElement.appendChild(Nk.create("altitude",0,{},"altitude_"+s.identifier)),s.imageDataElement.appendChild(Nk.create("wall",r,{type:"image"},"wall_"+s.identifier)),s.imageDataElement.appendChild(Nk.create("floor",a,{type:"image"},"floor_"+s.identifier)),s.initialize(),s}}]),n}(zk),zm([pk()],UC.prototype,"isLocked",void 0),zm([pk()],UC.prototype,"mode",void 0),zm([pk()],UC.prototype,"rotate",void 0),zm([pk()],UC.prototype,"isDropShadow",void 0),zm([pk()],UC.prototype,"isSurfaceShading",void 0),zm([pk()],UC.prototype,"isInteract",void 0),zm([pk()],UC.prototype,"isSlope",void 0),UC=jC=zm([fk("terrain")],UC)),JC=function(e){return e[e.NONE=-1]="NONE",e[e.SQUARE=0]="SQUARE",e[e.HEX_VERTICAL=1]="HEX_VERTICAL",e[e.HEX_HORIZONTAL=2]="HEX_HORIZONTAL",e}({}),eE=function(e){return e.NONE="",e.WHITE="white",e.BLACK="black",e}({}),tE=(HC=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).name="\u30c6\u30fc\u30d6\u30eb",e.width=20,e.height=20,e.gridSize=50,e.imageIdentifier="imageIdentifier",e.backgroundImageIdentifier="imageIdentifier",e.backgroundFilterType=eE.NONE,e.selected=!1,e.gridType=JC.SQUARE,e.gridColor="#000000e6",e.gridHeight=0,e}return k(n,[{key:"terrains",get:function(){var e=[];return this.children.forEach(function(t){t instanceof QC&&e.push(t)}),e}},{key:"masks",get:function(){var e=[];return this.children.forEach(function(t){t instanceof KC&&e.push(t)}),e}},{key:"onStoreAdded",value:function(){u(v(n.prototype),"onStoreAdded",this).call(this),this.selected&&Jb.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}}]),n}(dk),zm([pk()],HC.prototype,"name",void 0),zm([pk()],HC.prototype,"width",void 0),zm([pk()],HC.prototype,"height",void 0),zm([pk()],HC.prototype,"gridSize",void 0),zm([pk()],HC.prototype,"imageIdentifier",void 0),zm([pk()],HC.prototype,"backgroundImageIdentifier",void 0),zm([pk()],HC.prototype,"backgroundFilterType",void 0),zm([pk()],HC.prototype,"selected",void 0),zm([pk()],HC.prototype,"gridType",void 0),zm([pk()],HC.prototype,"gridColor",void 0),HC=zm([fk("game-table")],HC)),nE=(GC=VC=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).rotate=0,e.zindex=0,e.password="",e.isUpright=!0,e.isLocked=!1,e}return k(n,[{key:"width",get:function(){return this.getCommonValue("width",1)}},{key:"height",get:function(){return this.getCommonValue("height",1)}},{key:"fontSize",get:function(){return this.getCommonValue("fontsize",1)}},{key:"title",get:function(){return this.getCommonValue("title","")}},{key:"text",get:function(){return this.getCommonValue("text","")},set:function(e){this.setCommonValue("text",e)}},{key:"toTopmost",value:function(){Tx(this)}}],[{key:"create",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:16,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,a=arguments.length>5?arguments[5]:void 0,o=a?new VC(a):new VC;return o.createDataElements(),o.commonDataElement.appendChild(Nk.create("width",i,{},"width_"+o.identifier)),o.commonDataElement.appendChild(Nk.create("height",r,{},"height_"+o.identifier)),o.commonDataElement.appendChild(Nk.create("fontsize",n,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(Nk.create("title",e,{},"title_"+o.identifier)),o.commonDataElement.appendChild(Nk.create("text",t,{type:"note",currentValue:t},"text_"+o.identifier)),o.commonDataElement.appendChild(Nk.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}}]),n}(zk),zm([pk()],GC.prototype,"rotate",void 0),zm([pk()],GC.prototype,"zindex",void 0),zm([pk()],GC.prototype,"password",void 0),zm([pk()],GC.prototype,"isUpright",void 0),zm([pk()],GC.prototype,"isLocked",void 0),GC=VC=zm([fk("text-note")],GC)),iE=(WC=function(e){h(n,e);var t=f(n);function n(){return y(this,n),t.apply(this,arguments)}return k(n,[{key:"onStoreAdded",value:function(){u(v(n.prototype),"onStoreAdded",this).call(this),tk.instance.remove(this)}},{key:"innerXml",value:function(){var e,t="",n=[],i=a(n=(n=(n=(n=(n=(n=n.concat(tk.instance.getObjects(tE))).concat(tk.instance.getObjects(jk))).concat(tk.instance.getObjects(nE))).concat(tk.instance.getObjects(Ux))).concat(tk.instance.getObjects(jx).filter(function(e){return null===e.parent}))).concat(tk.instance.getObjects(Vx)));try{for(i.s();!(e=i.n()).done;)t+=e.value.toXml()}catch(r){i.e(r)}finally{i.f()}return t}},{key:"parseInnerXml",value:function(e){var t,n=[],i=a(n=(n=(n=(n=(n=(n=(n=(n=n.concat(tk.instance.getObjects(tE))).concat(tk.instance.getObjects(KC))).concat(tk.instance.getObjects(QC))).concat(tk.instance.getObjects(jk))).concat(tk.instance.getObjects(nE))).concat(tk.instance.getObjects(Ux))).concat(tk.instance.getObjects(jx))).concat(tk.instance.getObjects(Vx)));try{for(i.s();!(t=i.n()).done;)t.value.destroy()}catch(o){i.e(o)}finally{i.f()}for(var r=0;r<e.children.length;r++)lk.instance.parseXml(e.children[r])}}]),n}(ck),WC=zm([fk("room")],WC)),rE=p("NH6c"),aE=((ZC=function(){function e(t){y(this,e),this.ngZone=t}return k(e,[{key:"saveRoomAsync",value:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",i=arguments.length>1?arguments[1]:void 0;return e.queue.add(function(e,r){return e(t._saveRoomAsync(n,i))})}},{key:"_saveRoomAsync",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",t=arguments.length>1?arguments[1]:void 0,n=[],i=this.convertToXml(new iE),r=this.convertToXml(Zx.instance),o=this.convertToXml(Hk.instance),s=this.convertToXml(XC.instance);n.push(new File([i],"data.xml",{type:"text/plain"})),n.push(new File([r],"chat.xml",{type:"text/plain"})),n.push(new File([o],"rollTable.xml",{type:"text/plain"})),n.push(new File([s],"summary.xml",{type:"text/plain"}));var l,c=[],u=a(c=(c=c.concat(this.searchImageFiles(i))).concat(this.searchImageFiles(r)));try{for(u.s();!(l=u.n()).done;){var h=l.value;h.state===Vm.COMPLETE&&n.push(new File([h.blob],h.identifier+"."+kw.extension(h.blob.type),{type:h.blob.type}))}}catch(f){u.e(f)}finally{u.f()}var d=this.convertToXml(Pw.create(c));return n.push(new File([d],"imageTag.xml",{type:"text/plain"})),this.saveAsync(n,this.appendTimestamp(e),t)}},{key:"saveGameObjectAsync",value:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"xml_data",r=arguments.length>2?arguments[2]:void 0;return e.queue.add(function(e,a){return e(n._saveGameObjectAsync(t,i,r))})}},{key:"_saveGameObjectAsync",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"xml_data",n=arguments.length>2?arguments[2]:void 0,i=[],r=this.convertToXml(e);i.push(new File([r],"data.xml",{type:"text/plain"}));var o,s=[],l=a(s=s.concat(this.searchImageFiles(r)));try{for(l.s();!(o=l.n()).done;){var c=o.value;c.state===Vm.COMPLETE&&i.push(new File([c.blob],c.identifier+"."+kw.extension(c.blob.type),{type:c.blob.type}))}}catch(h){l.e(h)}finally{l.f()}var u=this.convertToXml(Pw.create(s));return i.push(new File([u],"imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(t),n)}},{key:"saveAsync",value:function(e,t,n){var i=this,r=-1;return Fw.instance.saveAsync(e,t,function(e){var t=0|e.percent;t<=r||(r=t,i.ngZone.run(function(){return n(r)}))})}},{key:"convertToXml",value:function(e){return'<?xml version="1.0" encoding="UTF-8"?>\n'+rE.xml(e.toXml(),2)}},{key:"searchImageFiles",value:function(e){var t=Yb.xml2element(e),n=[];if(!t)return n;for(var i={},r=t.ownerDocument.querySelectorAll('*[type="image"]'),a=0;a<r.length;a++){var o=r[a].innerHTML;i[o]=Dk.instance.get(o);var s=r[a].getAttribute("currentValue");s&&(i[s]=Dk.instance.get(s))}r=t.ownerDocument.querySelectorAll("*[imageIdentifier], *[backgroundImageIdentifier]");for(var l=0;l<r.length;l++){var c=r[l].getAttribute("imageIdentifier");c&&(i[c]=Dk.instance.get(c));var u=r[l].getAttribute("backgroundImageIdentifier");u&&(i[u]=Dk.instance.get(u))}for(var h in i){var d=i[h];d&&n.push(d)}return n}},{key:"appendTimestamp",value:function(e){var t=new Date;return e+"_".concat(t.getFullYear(),"-").concat(("00"+(t.getMonth()+1)).slice(-2),"-").concat(("00"+t.getDate()).slice(-2),"_").concat(("00"+t.getHours()).slice(-2)).concat(("00"+t.getMinutes()).slice(-2))}}]),e}()).queue=new vk("SaveDataServiceQueue"),ZC.\u0275fac=function(e){return new(e||ZC)(wi($c))},ZC.\u0275prov=Ae({token:ZC,factory:ZC.\u0275fac,providedIn:"root"}),ZC);function oE(e,t){1&e&&$o(0)}function sE(e,t){if(1&e){var n=Qo();Zo(0,"div",3),Uo(1,oE,1,0,"ng-container",5),Zo(2,"select",6),es("change",function(e){return Jt(n),is(3).setElementType(e.target.value)}),Zo(3,"option",7),zs(4,"\u901a\u5e38"),Yo(),Zo(5,"option",8),zs(6,"\u6570\u5024"),Yo(),Zo(7,"option",9),zs(8,"\u30ea\u30bd\u30fc\u30b9"),Yo(),Zo(9,"option",10),zs(10,"\u80fd\u529b\u5024"),Yo(),Zo(11,"option",11),zs(12,"\u30c1\u30a7\u30c3\u30af"),Yo(),Zo(13,"option",12),zs(14,"\u30ce\u30fc\u30c8"),Yo(),Zo(15,"option",13),zs(16,"\u53c2\u7167URL"),Yo(),Yo(),Yo()}if(2&e){var i=is(3),r=Ho(2);sa(1),Wo("ngTemplateOutlet",r),sa(1),Wo("ngModel",i.gameDataElement.type)}}function lE(e,t){if(1&e&&(Xo(0),Zo(1,"div",14),zs(2),Yo(),Ko()),2&e){var n=is(3);sa(2),Ls(n.name)}}function cE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",15),zs(2),Yo(),Zo(3,"input",16),es("ngModelChange",function(e){return Jt(n),is(3).name=e}),Yo(),Ko()}if(2&e){var i=is(3);sa(2),Ls(i.name),sa(1),Wo("ngModel",i.name)}}function uE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"input",17),es("ngModelChange",function(e){return Jt(n),is(3).value=e}),hc(2,"safe"),Yo(),qo(3,"br"),Zo(4,"input",18),es("ngModelChange",function(e){return Jt(n),is(3).value=e}),Yo(),Ko()}if(2&e){var i=is(3);sa(1),ws(dc(2,10,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),ss("title",i.value),ss("min","altitude"===i.name?-12:"fontsize"===i.name?1:0),ss("max","fontsize"===i.name?128:12),ss("step","fontsize"===i.name?1:.5),Wo("ngModel",i.value),sa(3),ss("min","altitude"===i.name?-24:"fontsize"===i.name?1:0),ss("step","fontsize"===i.name?1:.1),Wo("ngModel",i.value)}}function hE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",22),zs(2),Yo(),Zo(3,"input",23),es("ngModelChange",function(e){return Jt(n),is(4).value=e}),Yo(),Ko()}if(2&e){var i=is(4);sa(2),Ls(i.value),sa(1),ss("type",i.isNum(i.value)?"number":"text"),Wo("ngModel",i.value)}}function dE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"input",24),es("ngModelChange",function(e){return Jt(n),is(4).currentValue=e}),hc(2,"safe"),Yo(),qo(3,"br"),Zo(4,"input",25),es("ngModelChange",function(e){return Jt(n),is(4).currentValue=e}),Yo(),zs(5," / "),Zo(6,"input",26),es("ngModelChange",function(e){return Jt(n),is(4).value=e}),Yo(),Ko()}if(2&e){var i=is(4);sa(1),ws(dc(2,7,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),ss("title",i.currentValue),ss("max",i.isNum(i.value)?i.value:1e3),Wo("ngModel",i.currentValue),sa(3),Wo("ngModel",i.currentValue),sa(2),Wo("ngModel",i.value)}}function fE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"select",28),es("ngModelChange",function(e){return Jt(n),is(5).currentValue=e}),Zo(2,"option",7),zs(3,"\u306a\u3057"),Yo(),Zo(4,"option",29),zs(5,"\xf72"),Yo(),Zo(6,"option",30),zs(7,"\xf73 SRS,LHZ"),Yo(),Zo(8,"option",31),zs(9,"\xf74"),Yo(),Zo(10,"option",32),zs(11,"\xf75"),Yo(),Zo(12,"option",33),zs(13,"\xf76 SW"),Yo(),Zo(14,"option",34),zs(15,"\xf710"),Yo(),Zo(16,"option",35),zs(17,"D&D 3e\uff5e"),Yo(),Yo(),Ko()}if(2&e){var i=is(5);sa(1),Wo("ngModel",i.currentValue)}}function pE(e,t){if(1&e&&(Xo(0),Zo(1,"span",36),zs(2),Yo(),Ko()),2&e){var n=is(5);sa(2),Ls("("+(n.abilityScore>=0?"+":"")+n.abilityScore+")")}}function gE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"input",27),es("ngModelChange",function(e){return Jt(n),is(4).value=e}),Yo(),Uo(2,fE,18,1,"ng-container",0),Uo(3,pE,3,1,"ng-container",0),Ko()}if(2&e){var i=is(4);sa(1),ss("type",i.isNum(i.value)?"number":"text"),Wo("ngModel",i.value),sa(1),Wo("ngIf",i.isEdit),sa(1),Wo("ngIf",!i.isEdit)}}function mE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"input",37),es("ngModelChange",function(e){return Jt(n),is(4).currentValue=e}),Yo(),Zo(2,"input",38),es("ngModelChange",function(e){return Jt(n),is(4).value=e})("change",function(){Jt(n);var e=is(4);return e.value=e.value?e.name:""}),Yo(),Ko()}if(2&e){var i=is(4);sa(1),Wo("ngModel",i.currentValue),sa(1),ss("checked",i.value?"checked":""),Wo("ngModel",i.value)}}function vE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"textarea",39),es("ngModelChange",function(e){return Jt(n),is(4).value=e}),Yo(),Ko()}if(2&e){var i=is(4);sa(1),Wo("ngModel",i.value)}}function yE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",22),zs(2),Yo(),Zo(3,"span",40),Zo(4,"input",41),es("ngModelChange",function(e){return Jt(n),is(4).value=e}),Yo(),Zo(5,"button",42),es("click",function(){Jt(n);var e=is(4);return!!e.stringUtil.validUrl(e.value)&&e.openUrl(e.value)}),Zo(6,"i",43),zs(7),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(4);sa(2),Ls(i.value),sa(2),Wo("ngModel",i.value),sa(1),Lo("disabled",i.stringUtil.validUrl(i.value)?null:""),sa(2),Ls(i.stringUtil.validUrl(i.value)?i.stringUtil.sameOrigin(i.value)?"link":"open_in_new":"link_off")}}function bE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",22),zs(2),Yo(),Zo(3,"input",44),es("ngModelChange",function(e){return Jt(n),is(4).value=e}),Yo(),Ko()}if(2&e){var i=is(4);sa(2),Ls(i.value),sa(1),Wo("ngModel",i.value)}}function kE(e,t){if(1&e&&(Xo(0),Xo(1,19),Uo(2,hE,4,3,"ng-container",20),Uo(3,dE,7,10,"ng-container",20),Uo(4,gE,4,4,"ng-container",20),Uo(5,mE,3,3,"ng-container",20),Uo(6,vE,2,1,"ng-container",20),Uo(7,yE,8,4,"ng-container",20),Uo(8,bE,4,2,"ng-container",21),Ko(),Ko()),2&e){var n=is(3);sa(1),Wo("ngSwitch",n.gameDataElement.type),sa(1),Wo("ngSwitchCase","simpleNumber"),sa(1),Wo("ngSwitchCase","numberResource"),sa(1),Wo("ngSwitchCase","abilityScore"),sa(1),Wo("ngSwitchCase","checkProperty"),sa(1),Wo("ngSwitchCase","note"),sa(1),Wo("ngSwitchCase","url")}}function _E(e,t){if(1&e&&(Xo(0),Uo(1,sE,17,2,"div",2),Zo(2,"div",3),Uo(3,lE,3,1,"ng-container",0),Uo(4,cE,4,2,"ng-container",0),Yo(),Zo(5,"div",4),Uo(6,uE,5,13,"ng-container",0),Uo(7,kE,9,7,"ng-container",0),Yo(),Ko()),2&e){var n=is(2);sa(1),Wo("ngIf",n.isEdit),sa(2),Wo("ngIf",n.isTagLocked),sa(1),Wo("ngIf",!n.isTagLocked),sa(2),Wo("ngIf",n.isCommonValue),sa(1),Wo("ngIf",!n.isCommonValue)}}function wE(e,t){1&e&&$o(0)}function xE(e,t){if(1&e&&(Zo(0,"div",50),Uo(1,wE,1,0,"ng-container",5),Yo()),2&e){is(3);var n=Ho(2);sa(1),Wo("ngTemplateOutlet",n)}}function CE(e,t){if(1&e&&(Xo(0),Zo(1,"div",51),zs(2),Yo(),Ko()),2&e){var n=is(3);sa(2),Ls(n.name)}}function EE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"input",52),es("ngModelChange",function(e){return Jt(n),is(3).name=e}),Yo(),Ko()}if(2&e){var i=is(3);sa(1),Wo("ngModel",i.name)}}function SE(e,t){if(1&e&&qo(0,"div",55),2&e){var n=t.$implicit,i=is(4);Wo("gameDataElement",n)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)}}function TE(e,t){if(1&e&&(Zo(0,"div",53),Uo(1,SE,1,4,"div",54),Yo()),2&e){var n=is(3);sa(1),Wo("ngForOf",n.gameDataElement.children)}}function OE(e,t){if(1&e&&(Xo(0),Uo(1,xE,2,1,"div",45),qo(2,"div",46),Zo(3,"div",47),Zo(4,"div",48),Uo(5,CE,3,1,"ng-container",0),Uo(6,EE,2,1,"ng-container",0),Yo(),Uo(7,TE,2,1,"div",49),Yo(),Ko()),2&e){var n=is(2);sa(1),Wo("ngIf",n.isEdit),sa(4),Wo("ngIf",n.isTagLocked),sa(1),Wo("ngIf",!n.isTagLocked),sa(1),Wo("ngIf",0<n.gameDataElement.children.length)}}function IE(e,t){if(1&e&&(Xo(0),Uo(1,_E,8,5,"ng-container",0),Uo(2,OE,8,4,"ng-container",0),Ko()),2&e){var n=is();sa(1),Wo("ngIf",n.gameDataElement.children.length<1),sa(1),Wo("ngIf",0<n.gameDataElement.children.length)}}function ME(e,t){if(1&e){var n=Qo();Zo(0,"button",56),es("click",function(){return Jt(n),is().addElement()}),Zo(1,"i",57),zs(2,"add_circle"),Yo(),Yo(),Zo(3,"button",56),es("click",function(){return Jt(n),is().upElement()}),Zo(4,"i",57),zs(5,"arrow_upward"),Yo(),Yo(),qo(6,"br"),Zo(7,"button",56),es("click",function(){return Jt(n),is().deleteElement()}),Zo(8,"i",57),zs(9,"remove_circle_outline"),Yo(),Yo(),Zo(10,"button",56),es("click",function(){return Jt(n),is().downElement()}),Zo(11,"i",57),zs(12,"arrow_downward"),Yo(),Yo()}}var AE,PE=((AE=function(){function e(t,n){y(this,e),this.changeDetector=t,this.modalService=n,this.tableTopObjectName=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.stringUtil=gk,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}return k(e,[{key:"name",get:function(){return this._name},set:function(e){this._name=e,this.setUpdateTimer()}},{key:"value",get:function(){return this._value},set:function(e){this._value=e,this.setUpdateTimer()}},{key:"currentValue",get:function(){return this._currentValue},set:function(e){this._currentValue=e,this.setUpdateTimer()}},{key:"abilityScore",get:function(){return this.gameDataElement.calcAbilityScore()}},{key:"isCommonValue",get:function(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"altitude"===this.gameDataElement.name)}},{key:"ngOnInit",value:function(){var e=this;this.gameDataElement&&this.setValues(this.gameDataElement),Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){e.gameDataElement&&t.data.identifier===e.gameDataElement.identifier&&(e.setValues(e.gameDataElement),e.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",-1e3,function(t){e.gameDataElement&&e.gameDataElement.identifier===t.data.identifier&&e.changeDetector.markForCheck()})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"ngAfterViewInit",value:function(){}},{key:"addElement",value:function(){this.gameDataElement.appendChild(Nk.create("\u30bf\u30b0","",{}))}},{key:"deleteElement",value:function(){this.gameDataElement.destroy()}},{key:"upElement",value:function(){var e=this.gameDataElement.parent,t=e.children.indexOf(this.gameDataElement);0<t&&e.insertBefore(this.gameDataElement,e.children[t-1])}},{key:"downElement",value:function(){var e=this.gameDataElement.parent,t=e.children.indexOf(this.gameDataElement);t<e.children.length-1&&e.insertBefore(e.children[t+1],this.gameDataElement)}},{key:"setElementType",value:function(e){this.gameDataElement.setAttribute("type",e)}},{key:"isNum",value:function(e){return isFinite(e)}},{key:"openUrl",value:function(e){gk.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Jk,{url:e,title:this.tableTopObjectName,subTitle:this.name})}},{key:"setValues",value:function(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}},{key:"setUpdateTimer",value:function(){var e=this;clearTimeout(this.updateTimer),this.updateTimer=setTimeout(function(){e.gameDataElement.name!==e.name&&(e.gameDataElement.name=e.name),e.gameDataElement.currentValue!==e.currentValue&&(e.gameDataElement.currentValue=e.currentValue),e.gameDataElement.value!==e.value&&(e.gameDataElement.value=e.value),e.updateTimer=null},66)}}]),e}()).\u0275fac=function(e){return new(e||AE)(Vo(Dl),Vo(Zk))},AE.\u0275cmp=ct({type:AE,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tableTopObjectName:"tableTopObjectName",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","40%","max-width","8em","text-align","right",3,"min","step","ngModel","ngModelChange"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"type","ngModel","ngModelChange"],["type","range","min","0",3,"ngModel","title","max","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModel","ngModelChange"],["size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModel","ngModelChange"],["size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],["type","checkbox",2,"width","30%","max-width","4em",3,"ngModel","checked","ngModelChange","change"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModel","ngModelChange"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked"],[3,"click"],[1,"material-icons"]],template:function(e,t){1&e&&(Uo(0,IE,3,2,"ng-container",0),Uo(1,ME,13,0,"ng-template",null,1,Ic)),2&e&&Wo("ngIf",t.gameDataElement)},directives:[dh,Th,Bf,Xd,Ef,jf,$f,Ed,Rf,Of,xh,Ch,Eh,wd,uh,AE],pipes:[Lw],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%}.table[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}button[_ngcontent-%COMP%], input[_ngcontent-%COMP%], select[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover{background:#eee}input[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus{background:#fff}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:grey}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color:transparent;--slider-fill-color:#555;--slider-border-color:#777;--slider-height:0.8em;--slider-thumb-size:1.0em;--range:calc(var(--max) - var(--min));--ratio:calc((var(--val) - var(--min))/var(--range));--sx:calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:1px solid var(--slider-border-color);border-bottom:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color);background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}"],changeDetection:0}),AE);function DE(e,t){1&e&&$o(0)}function RE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",0),es("click",function(){return Jt(n),is().openModal("front")}),zs(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),Yo(),Zo(3,"button",0),es("click",function(){return Jt(n),is().openModal("back")}),zs(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),Yo(),Ko()}}function FE(e,t){1&e&&$o(0)}function NE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",0),es("click",function(){return Jt(n),is().openModal("floor")}),zs(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),Yo(),Zo(3,"button",0),es("click",function(){return Jt(n),is().openModal("wall")}),zs(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),Yo(),Ko()}}function zE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",4),es("click",function(){Jt(n);var e=is();return e.openModal(e.tabletopObject.face)}),zs(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),Yo(),Ko()}if(2&e){var i=is();sa(1),Wo("disabled",!i.tabletopObject.isVisible)}}function LE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",0),es("click",function(){Jt(n);var e=is();return e.openModalReplaceImage(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))}),zs(2),Yo(),Zo(3,"button",4),es("click",function(){return Jt(n),is().openModal("faceIcon")}),zs(4),Yo(),Ko()}if(2&e){var i=is();sa(2),Bs("\u753b\u50cf",(null==i.tabletopObject.imageFiles?null:i.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),sa(1),Wo("disabled",(null==i.tabletopObject.faceIcons?null:i.tabletopObject.faceIcons.length)>=i.MAX_IMAGE_ICON_COUNT),sa(1),Bs("\u9854IC",(null==i.tabletopObject.faceIcons?null:i.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function BE(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",0),es("click",function(){Jt(n);var e=is();return e.openModal("imageIdentifier",e.tabletopObject.imageFile&&e.tabletopObject.imageFile.url.length>0)}),zs(2,"\u753b\u50cf\u5909\u66f4"),Yo(),Ko()}}function jE(e,t){if(1&e&&(Zo(0,"div",10),zs(1),Yo()),2&e){var n=is();sa(1),Bs("",n.progresPercent,"%")}}function UE(e,t){if(1&e){var n=Qo();Zo(0,"select",12),es("change",function(e){return Jt(n),is(2).setLocation(e.target.value)}),Zo(1,"option",13),zs(2,"\u30c6\u30fc\u30d6\u30eb"),Yo(),Zo(3,"option",14),zs(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Yo(),Zo(5,"option",15),zs(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Yo(),Zo(7,"option",16),zs(8,"\u5893\u5730"),Yo(),Yo()}if(2&e){var i=is(2);Wo("ngModel",i.tabletopObject.location.name),sa(5),ss("value",i.networkService.peerId)}}function HE(e,t){if(1&e){var n=Qo();Xo(0),Uo(1,UE,9,2,"select",11),Zo(2,"button",4),es("click",function(){Jt(n);var e=is();return e.openModal("shadowImageIdentifier",e.tabletopObject.shadowImageFile.url.length>0)}),zs(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),Yo(),Ko()}if(2&e){var i=is();sa(1),Wo("ngIf",i.tabletopObject),sa(1),Wo("disabled",!i.tabletopObject.imageElement||"null"==i.tabletopObject.imageElement.value)}}function VE(e,t){if(1&e){var n=Qo();Zo(0,"button",33),es("click",function(){Jt(n);var e=is(2),t=e.index,i=e.$implicit;return is(3).deleteIcon(t,i.identifier)}),Zo(1,"b",34),zs(2,"close"),Yo(),Yo()}}var WE=function(e){return{"current-icon":e}};function GE(e,t){if(1&e){var n=Qo();Zo(0,"div",30),Zo(1,"img",31),es("click",function(){Jt(n);var e=is().index;return is(3).selectIcon(e)}),hc(2,"safe"),Yo(),Uo(3,VE,3,0,"button",32),Yo()}if(2&e){var i=is(),r=i.index,a=i.$implicit,o=is(3);Wo("@bounceInOut",void 0)("ngClass",rc(8,WE,o.tabletopObject.currntIconIndex==r)),sa(1),Wo("src",dc(2,5,a.url,"resourceUrl"),dr)("alt",a.name),sa(2),Wo("ngIf",o.tabletopObject.currntIconIndex==r)}}function ZE(e,t){if(1&e&&(Zo(0,"div"),Uo(1,GE,4,10,"div",29),Yo()),2&e){var n=t.$implicit;sa(1),Wo("ngIf",0<n.url.length)}}var YE=function(e){return{hide:e}};function qE(e,t){if(1&e){var n=Qo();Zo(0,"span",35),Zo(1,"img",31),es("click",function(){Jt(n);var e=t.index;return is(3).selectImage(e)}),hc(2,"safe"),Yo(),Yo()}if(2&e){var i=t.$implicit,r=t.index,a=is(3);ks("left",50*(a.tabletopObject.currntImageIndex<=r?r-1:r),"px"),Wo("ngClass",rc(9,YE,a.tabletopObject.currntImageIndex==r)),sa(1),Wo("@bounceInOut",void 0)("src",dc(2,6,i.url,"resourceUrl"),dr)("alt",i.name)}}function XE(e,t){if(1&e){var n=Qo();Zo(0,"button",36),es("click",function(){return Jt(n),is(3).openModalAddImage()}),zs(1),Yo()}if(2&e){var i=is(3);ks("left",i.tabletopObject.imageFiles.length<0?-5:50*(i.tabletopObject.imageFiles.length-1)-5,"px"),sa(1),Ls(i.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}var KE=function(e){return{inverse:e}},$E=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}},QE=function(e,t){return{"black-paint":e,hollow:t}};function JE(e,t){if(1&e){var n=Qo();Zo(0,"div",20),Zo(1,"div",21),Uo(2,ZE,2,1,"div",22),Yo(),Zo(3,"div",23),Uo(4,qE,3,11,"span",24),Uo(5,XE,2,3,"button",25),Yo(),Zo(6,"span",26),Zo(7,"span",27),Zo(8,"img",28),es("dblclick",function(){return Jt(n),is(2).openMainImageModal()}),hc(9,"safe"),Yo(),Yo(),Yo(),Yo()}if(2&e){var i=is(2);sa(2),Wo("ngForOf",i.tabletopObject.faceIcons)("ngForTrackBy",i.identify),sa(2),Wo("ngForOf",i.tabletopObject.imageFiles),sa(1),Wo("ngIf","character"==i.tabletopObject.aliasName&&i.tabletopObject.imageFiles.length<i.MAX_IMAGE_ICON_COUNT&&(i.tabletopObject.imageFiles.length>1||0<(null==i.tabletopObject.imageFile?null:i.tabletopObject.imageFile.url.length))),sa(1),Wo("ngClass",rc(13,KE,i.tabletopObject.isInverse)),sa(1),Wo("ngClass",lc(15,$E,0==i.tabletopObject.aura,1==i.tabletopObject.aura,2==i.tabletopObject.aura,3==i.tabletopObject.aura,4==i.tabletopObject.aura,5==i.tabletopObject.aura,6==i.tabletopObject.aura,7==i.tabletopObject.aura)),sa(1),Wo("src",dc(9,10,i.tabletopObject.imageFile.url,"resourceUrl"),dr)("alt",i.tabletopObject.imageFile.name)("ngClass",ac(24,QE,i.tabletopObject.isBlackPaint,i.tabletopObject.isHollow))("@switchImage",i.tabletopObject.currntImageIndex)}}function eS(e,t){if(1&e){var n=Qo();Zo(0,"div",41),Zo(1,"button",42),es("click",function(){return Jt(n),is(3).showChatPalette()}),zs(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),Yo(),Zo(3,"button",42),es("click",function(){return Jt(n),is(3).showStandSetting()}),zs(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),Yo(),Yo()}}function tS(e,t){if(1&e&&(Xo(0),Zo(1,"div",37),Zo(2,"div",38),qo(3,"div",39),Yo(),Uo(4,eS,5,0,"div",40),Yo(),Ko()),2&e){var n=is(2);sa(3),Wo("gameDataElement",n.tabletopObject.commonDataElement)("tableTopObjectName",n.tableTopObjectName)("isTagLocked",!0),sa(1),Wo("ngIf","character"===n.tabletopObject.aliasName)}}function nS(e,t){if(1&e&&(Zo(0,"div",37),Zo(1,"div",38),qo(2,"div",44),Yo(),Yo()),2&e){var n=t.$implicit,i=is(3);sa(2),Wo("gameDataElement",n)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)}}function iS(e,t){if(1&e&&(Xo(0),Uo(1,nS,3,3,"div",43),Ko()),2&e){var n=is(2);sa(1),Wo("ngForOf",n.tabletopObject.detailDataElement.children)}}function rS(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",37),Zo(2,"button",45),es("click",function(){return Jt(n),is(2).addDataElement()}),zs(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),Yo(),Yo(),Ko()}}function aS(e,t){if(1&e){var n=Qo();Zo(0,"div",17),Zo(1,"img",18),es("click",function(){return Jt(n),is().openModal("shadowImageIdentifier",!0)}),hc(2,"safe"),Yo(),Uo(3,JE,10,27,"div",19),Uo(4,tS,5,4,"ng-container",8),Uo(5,iS,2,1,"ng-container",8),Uo(6,rS,4,0,"ng-container",8),Yo()}if(2&e){var i=is();sa(1),Wo("src",dc(2,6,i.tabletopObject.shadowImageFile.url,"resourceUrl"),dr)("alt",i.tabletopObject.shadowImageFile.name),sa(2),Wo("ngIf",0<(null==i.tabletopObject.imageFile?null:i.tabletopObject.imageFile.url.length)||0<(null==i.tabletopObject.faceIcons?null:i.tabletopObject.faceIcons.length)),sa(1),Wo("ngIf",i.tabletopObject.commonDataElement),sa(1),Wo("ngIf",i.tabletopObject.detailDataElement),sa(1),Wo("ngIf",i.isEdit)}}var oS,sS,lS=function(e){return{"is-hidden":e}},cS=((oS=function(){function e(t,n,i,r){y(this,e),this.saveDataService=t,this.panelService=n,this.modalService=i,this.pointerDeviceService=r,this.tabletopObject=null,this.isEdit=!1,this.networkService=ek,this.MAX_IMAGE_ICON_COUNT=5,this.isSaveing=!1,this.progresPercent=0}return k(e,[{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("DELETE_GAME_OBJECT",-1e3,function(t){e.tabletopObject&&e.tabletopObject.identifier===t.data.identifier&&e.panelService.close()})}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"toggleEditMode",value:function(){this.isEdit=!this.isEdit}},{key:"addDataElement",value:function(){if(this.tabletopObject.detailDataElement){var e=Nk.create("\u898b\u51fa\u3057","",{}),t=Nk.create("\u30bf\u30b0","",{});e.appendChild(t),this.tabletopObject.detailDataElement.appendChild(e)}}},{key:"clone",value:function(){var e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":Mw.play(Iw.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,Mw.play(Iw.cardPut);break;case"text-note":e.toTopmost(),Mw.play(Iw.cardPut);break;case"dice-symbol":Mw.play(Iw.dicePut);default:Mw.play(Iw.piecePut)}}},{key:"tableTopObjectName",get:function(){var e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}},{key:"saveToXML",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.tabletopObject&&!this.isSaveing){e.next=2;break}return e.abrupt("return");case 2:return this.isSaveing=!0,this.progresPercent=0,t=this.tableTopObjectName,e.next=6,this.saveDataService.saveGameObjectAsync(this.tabletopObject,"xml_"+t,function(e){n.progresPercent=e});case 6:setTimeout(function(){n.isSaveing=!1,n.progresPercent=0},500);case 7:case"end":return e.stop()}},e,this)}))}},{key:"setLocation",value:function(e){Jb.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),Mw.play("graveyard"==e?Iw.sweep:Iw.piecePut),this.tabletopObject.setLocation(e)}},{key:"openModal",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.modalService.open(Sx,{isAllowedEmpty:n}).then(function(n){if(e.tabletopObject&&e.tabletopObject.imageDataElement&&n)if("shadowImageIdentifier"==t){var i=e.tabletopObject.imageElement;if(i){"null"!=i.value&&(i.currentValue=n);var r,o=a(e.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier"));try{for(o.s();!(r=o.n()).done;){var s=r.value;e.tabletopObject.imageDataElement.removeChild(s)}}catch(h){o.e(h)}finally{o.f()}}}else if("faceIcon"===t){var l=e.tabletopObject.imageDataElement.getElementsByName(t);if(l.length>=e.MAX_IMAGE_ICON_COUNT){for(var c=e.MAX_IMAGE_ICON_COUNT;c<l.length;c++)e.deleteIcon(c);l[e.MAX_IMAGE_ICON_COUNT-1].value=n}else e.tabletopObject.imageDataElement.appendChild(Nk.create(t,n,{type:"image"},t+Hb.generateUuid()));e.tabletopObject.currntIconIndex<0&&(e.tabletopObject.currntIconIndex=0)}else{var u=e.tabletopObject.imageDataElement.getFirstElementByName(t);if(!u)return;u.value=n}}),Jb.trigger("UPDATE_GAME_OBJECT",this.tabletopObject)}},{key:"openModalAddImage",value:function(){var e=this;this.modalService.open(Sx).then(function(t){if(e.tabletopObject&&e.tabletopObject.imageDataElement&&t){var n=e.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(n.length>=e.MAX_IMAGE_ICON_COUNT){for(var i=e.MAX_IMAGE_ICON_COUNT;i<n.length;i++)e.deleteImage(i);n[e.MAX_IMAGE_ICON_COUNT-1].value=t}else e.tabletopObject.imageDataElement.appendChild(Nk.create("imageIdentifier",t,{type:"image"},name+Hb.generateUuid()));e.tabletopObject.currntImageIndex<0&&(e.tabletopObject.currntImageIndex=0)}})}},{key:"openModalReplaceImage",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.modalService.open(Sx,{isAllowedEmpty:t}).then(function(t){e.tabletopObject&&e.tabletopObject.imageDataElement&&t&&("null"==t?e.tabletopObject.imageElement&&1==e.tabletopObject.imageFiles.length?(e.tabletopObject.imageElement.value=t,e.tabletopObject.imageElement.currentValue=t):e.deleteImage(e.tabletopObject.currntImageIndex):e.tabletopObject.imageElement&&(e.tabletopObject.imageElement.value=t))})}},{key:"selectImage",value:function(e){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,Mw.play(Iw.surprise),Jb.trigger("UPDATE_INVENTORY",null))}},{key:"selectIcon",value:function(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}},{key:"deleteImage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"imageIdentifier";if(this.tabletopObject&&this.tabletopObject.imageDataElement){var n=this.tabletopObject.imageDataElement.getElementsByName(t);n&&0<n.length&&e<n.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(n[e]),this.tabletopObject.currntImageIndex>=n.length-1&&(this.tabletopObject.currntImageIndex=n.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}}},{key:"deleteIcon",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(this.tabletopObject&&this.tabletopObject.imageDataElement){var n=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");n&&0<n.length&&e<n.length&&(!t||n[e].value===t)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(n[e]),this.tabletopObject.currntIconIndex>=n.length-1&&(this.tabletopObject.currntIconIndex=n.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}}},{key:"openMainImageModal",value:function(){var e;this.tabletopObject instanceof Ux||(this.tabletopObject instanceof jx?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof Vx?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof jk?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<(null===(e=this.tabletopObject.imageFile)||void 0===e?void 0:e.url.length)):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}},{key:"showChatPalette",value:function(){if(this.tabletopObject instanceof jk){var e=this.pointerDeviceService.pointers[0];this.panelService.open(sC,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}}},{key:"showStandSetting",value:function(){if(this.tabletopObject instanceof jk){var e=this.pointerDeviceService.pointers[0];this.panelService.open(YC,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}}},{key:"identify",value:function(e,t){return t.identifier}}]),e}()).\u0275fac=function(e){return new(e||oS)(Vo(aE),Vo(Wk),Vo(Zk),Vo(DC))},oS.\u0275cmp=ct({type:oS,selectors:[["game-character-sheet"]],inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isTagLocked"],["style","text-align: right; margin-top: 3px;",4,"ngIf"],[2,"text-align","right","margin-top","3px"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit"],[2,"width","100%","color","#555",3,"click"]],template:function(e,t){1&e&&(Zo(0,"button",0),es("click",function(){return t.toggleEditMode()}),zs(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),Yo(),Xo(2,1),Uo(3,DE,1,0,"ng-container",2),Uo(4,RE,5,0,"ng-container",2),Uo(5,FE,1,0,"ng-container",2),Uo(6,NE,5,0,"ng-container",2),Uo(7,zE,3,1,"ng-container",2),Uo(8,LE,5,3,"ng-container",2),Uo(9,BE,3,0,"ng-container",3),Ko(),Zo(10,"button",0),es("click",function(){return t.clone()}),zs(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),Yo(),Zo(12,"button",4),es("click",function(){return t.saveToXML()}),Zo(13,"div",5),Zo(14,"div",6),zs(15,"\u4fdd\u5b58"),Yo(),Uo(16,jE,2,1,"div",7),Yo(),Yo(),Uo(17,HE,4,2,"ng-container",8),Uo(18,aS,7,9,"div",9)),2&e&&(sa(2),Wo("ngSwitch",t.tabletopObject.aliasName),sa(1),Wo("ngSwitchCase","numberResource"),sa(1),Wo("ngSwitchCase","card"),sa(1),Wo("ngSwitchCase","card-stack"),sa(1),Wo("ngSwitchCase","terrain"),sa(1),Wo("ngSwitchCase","dice-symbol"),sa(1),Wo("ngSwitchCase","character"),sa(4),Wo("disabled",t.isSaveing),sa(2),Wo("ngClass",rc(12,lS,t.isSaveing)),sa(2),Wo("ngIf",t.isSaveing),sa(1),Wo("ngIf","character"===t.tabletopObject.aliasName),sa(1),Wo("ngIf",t.tabletopObject))},directives:[xh,Ch,Eh,lh,dh,Bf,Xd,Ef,jf,$f,uh,PE],pipes:[Lw],styles:[".main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block}.image-showcase[_ngcontent-%COMP%], .image-thumbnail[_ngcontent-%COMP%]{vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0 rgb(255,244,232)) drop-shadow(-1px 1px 0 rgb(255,244,232)) drop-shadow(-1px -1px 0 rgb(255,244,232)) drop-shadow(1px -1px 0 rgb(255,244,232));z-index:100;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0 rgb(255,244,232)) drop-shadow(-1px 1px 0 rgb(255,244,232)) drop-shadow(-1px -1px 0 rgb(255,244,232)) drop-shadow(1px -1px 0 rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted red}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px);opacity:.7;margin-top:2px;margin-left:5px}.table[_ngcontent-%COMP%]{display:table;width:100%}.table[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%]{box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #fff;vertical-align:top}.box[_ngcontent-%COMP%], .table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:rgba(234,201,157,.8);background-color:rgba(240,218,189,.8);color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"],data:{animation:[sp("switchImage",[fp(":increment, :decrement",[lp("200ms ease",dp([up({transform:"scale3d(0, 0, 0)"}),up({transform:"scale3d(0, 1.2, 1.2)"}),up({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),sp("showcase",[fp(":increment, :decrement",[lp("200ms 200ms ease-in",dp([up({transform:"scale3d(0, 1.0, 1.0)"}),up({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),sp("showcaseItem",[fp(":enter",[lp("200ms ease",dp([up({transform:"scale3d(0, 0, 0)"}),up({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),fp(":leave",[lp("200ms ease",dp([up({transform:"scale3d(1.0, 1.0, 1.0)"}),up({transform:"scale3d(0, 0, 0)"})]))])]),sp("bounceInOut",[fp("void => *",[lp("600ms ease",dp([up({transform:"scale3d(0, 0, 0)",offset:0}),up({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp(100,up({transform:"scale3d(0, 0, 0)"}))])])]}}),oS),uS=function(){return{standalone:!0}},hS=((sS=function(){function e(t,n){y(this,e),this.panelService=t,this.modalService=n,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=Jm.parse(n.option.peerId?n.option.peerId:"???"),this.title=n.option.title?n.option.title:""}return k(e,[{key:"peerId",get:function(){return ek.peerId}},{key:"isConnected",get:function(){return!(ek.peerIds.length<=1)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.modalService.title=e.panelService.title="\u30d1\u30b9\u30ef\u30fc\u30c9\u3008".concat(e.title,"\u3009")}),Jb.register(this)}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"onInputChange",value:function(e){this.help=""}},{key:"submit",value:function(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}]),e}()).\u0275fac=function(e){return new(e||sS)(Vo(Wk),Vo(Zk))},sS.\u0275cmp=ct({type:sS,selectors:[["password-check"]],decls:10,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Zo(0,"form",null,0),Zo(2,"div"),zs(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Zo(4,"input",1),es("ngModelChange",function(e){return t.password=e})("input",function(e){return t.onInputChange(e.target.value)}),Yo(),Yo(),Zo(5,"button",2),es("click",function(){return t.submit()}),zs(6,"\u5165\u5ba4"),Yo(),Yo(),Zo(7,"div"),Zo(8,"span",3),zs(9),Yo(),Yo()),2&e&&(sa(4),Wo("ngModel",t.password)("ngModelOptions",ic(3,uS)),sa(5),Ls(t.help))},directives:[Sf,Kd,wf,Ed,Xd,Ef],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}"]}),sS);function dS(e,t){if(1&e&&(Zo(0,"div"),Zo(1,"div",9),zs(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),Yo(),Zo(3,"div",9),zs(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),Yo(),Zo(5,"div",9),zs(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),Yo(),Yo()),2&e){is();var n=Ho(4);sa(1),Wo("hidden",!n.errors.required),sa(2),Wo("hidden",!n.errors.minlength),sa(2),Wo("hidden",!n.errors.maxlength)}}function fS(e,t){if(1&e&&(Zo(0,"div"),Zo(1,"div",9),zs(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),Yo(),Yo()),2&e){is();var n=Ho(8);sa(1),Wo("hidden",!n.errors.maxlength)}}function pS(e,t){1&e&&(Zo(0,"div"),zs(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),Yo())}function gS(e,t){if(1&e){var n=Qo();Zo(0,"div"),Zo(1,"div"),zs(2,"\u30eb\u30fc\u30e0\u540d : "),Zo(3,"input",3,4),es("input",function(e){Jt(n);var t=is();return t.calcPeerId(e.target.value,t.password)})("ngModelChange",function(e){return Jt(n),is().roomName=e}),Yo(),Yo(),Zo(5,"div"),zs(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),Zo(7,"input",5,6),es("input",function(e){Jt(n);var t=is();return t.calcPeerId(t.roomName,e.target.value)})("ngModelChange",function(e){return Jt(n),is().password=e}),Yo(),Yo(),qo(9,"hr"),Uo(10,dS,7,3,"div",7),Uo(11,fS,3,1,"div",7),Uo(12,pS,2,0,"div",7),Zo(13,"div"),Zo(14,"button",8),es("click",function(){return Jt(n),is().createRoom()}),zs(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),Yo(),Yo(),Yo()}if(2&e){var i=Ho(4),r=Ho(8),a=is();sa(3),Wo("ngModel",a.roomName),sa(4),Wo("ngModel",a.password),sa(3),Wo("ngIf",i.errors&&(i.dirty||i.touched)),sa(1),Wo("ngIf",r.errors&&(r.dirty||r.touched)),sa(1),Wo("ngIf",!a.validateLength),sa(2),Wo("disabled",!i.valid||!r.valid||!a.validateLength)}}function mS(e,t){1&e&&(Zo(0,"span",1),zs(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),qo(2,"br"),zs(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),qo(4,"br"),zs(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),Yo())}var vS,yS=((vS=function(){function e(t,n){y(this,e),this.panelService=t,this.modalService=n,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}return k(e,[{key:"peerId",get:function(){return ek.peerId}},{key:"isConnected",get:function(){return!(ek.peerIds.length<=1)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.modalService.title=e.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"}),Jb.register(this),this.calcPeerId(this.roomName,this.password)}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"calcPeerId",value:function(e,t){var n=ek.peerContext?ek.peerContext.userId:Jm.generateId(),i=Jm.create(n,Jm.generateId("***"),e,t);this.validateLength=i.peerId.length<64}},{key:"createRoom",value:function(){var e=ek.peerContext?ek.peerContext.userId:Jm.generateId();ek.open(e,Jm.generateId("***"),this.roomName,this.password),Rk.myCursor.peerId=ek.peerId,this.modalService.resolve()}}]),e}()).\u0275fac=function(e){return new(e||vS)(Vo(Wk),Vo(Zk))},vS.\u0275cmp=ct({type:vS,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,t){if(1&e&&(Uo(0,gS,16,6,"div",0),Zo(1,"div"),Zo(2,"span",1),zs(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),Yo(),Yo(),Uo(4,mS,6,0,"ng-template",null,2,Ic)),2&e){var n=Ho(5);Wo("ngIf",!t.isConnected)("ngIfElse",n)}},directives:[dh,Ed,Jf,tp,ip,Xd,Ef],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),vS);function bS(e,t){1&e&&(Zo(0,"td"),Zo(1,"i",11),zs(2,"lock"),Yo(),Yo())}function kS(e,t){1&e&&(Zo(0,"td"),zs(1,"-"),Yo())}function _S(e,t){if(1&e){var n=Qo();Zo(0,"button",12),es("click",function(){Jt(n);var e=is().$implicit;return is(3).connect(e.peerContexts)}),zs(1,"\u63a5\u7d9a"),Yo()}if(2&e){var i=is().$implicit,r=is(3);Wo("disabled",(null==i.peerContexts[0]?null:i.peerContexts[0].roomId)===r.currentRoom)}}function wS(e,t){if(1&e&&(Xo(0),Zo(1,"tr"),Zo(2,"td",9),zs(3),Yo(),Zo(4,"td",7),zs(5),Yo(),Uo(6,bS,3,0,"td",4),Uo(7,kS,2,0,"td",4),Zo(8,"td"),zs(9),Yo(),Zo(10,"td"),Uo(11,_S,2,1,"button",10),Yo(),Yo(),Ko()),2&e){var n=t.$implicit;sa(3),Ls(null==n.peerContexts[0]?null:n.peerContexts[0].roomId),sa(2),Ls(n.roomName),sa(1),Wo("ngIf",n.peerContexts[0].hasPassword),sa(1),Wo("ngIf",!n.peerContexts[0].hasPassword),sa(2),Bs("",n.peerContexts.length,"\u4eba"),sa(2),Wo("ngIf",0<n.alias.length)}}function xS(e,t){if(1&e&&(Xo(0),Zo(1,"table",6),Zo(2,"tr"),Zo(3,"th"),zs(4,"\u30eb\u30fc\u30e0ID"),Yo(),Zo(5,"th",7),zs(6,"\u30eb\u30fc\u30e0\u540d"),Yo(),Zo(7,"th"),zs(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),Yo(),Zo(9,"th"),zs(10,"\u53c2\u52a0\u8005"),Yo(),qo(11,"th"),Yo(),Uo(12,wS,12,6,"ng-container",8),Yo(),Ko()),2&e){var n=is(2);sa(12),Wo("ngForOf",n.rooms)}}function CS(e,t){if(1&e&&(Zo(0,"span",13),zs(1),Yo()),2&e){var n=is(2);sa(1),Ls(n.help)}}function ES(e,t){if(1&e){var n=Qo();Zo(0,"div"),Zo(1,"button",2),es("click",function(){return Jt(n),is().reload()}),zs(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),Yo(),Zo(3,"button",3),es("click",function(){return Jt(n),is().showRoomSetting()}),zs(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),Yo(),qo(5,"hr"),Uo(6,xS,13,1,"ng-container",4),Uo(7,CS,2,1,"span",5),Yo()}if(2&e){var i=is();sa(1),Wo("disabled",i.isReloading),sa(5),Wo("ngIf",i.rooms.length),sa(1),Wo("ngIf",i.rooms.length<1)}}function SS(e,t){1&e&&(Zo(0,"span",13),zs(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),qo(2,"br"),zs(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),Yo())}var TS,OS,IS=((OS=function(){function e(t,n){y(this,e),this.panelService=t,this.modalService=n,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}return k(e,[{key:"currentRoom",get:function(){return ek.peerContext.roomId}},{key:"peerId",get:function(){return ek.peerId}},{key:"isConnected",get:function(){return!(ek.peerIds.length<=1)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.changeTitle()}),Jb.register(this).on("OPEN_NETWORK",function(t){e.changeTitle()}).on("CONNECT_PEER",function(t){e.changeTitle()}),this.reload()}},{key:"changeTitle",value:function(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",ek.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+ek.peerContext.roomName+"/"+ek.peerContext.roomId+"\u3009")}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"reload",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,r,o,s,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.isReloading=!0,this.help="\u691c\u7d22\u4e2d...",this.rooms=[],t={},e.next=4,ek.listAllPeers();case 4:n=e.sent,i=a(n);try{for(i.s();!(r=i.n()).done;)o=r.value,(s=Jm.parse(o)).isRoom&&((l=s.roomId+s.roomName)in t||(t[l]=[]),t[l].push(s))}catch(u){i.e(u)}finally{i.f()}for(c in t)this.rooms.push({alias:c,roomName:t[c][0].roomName,peerContexts:t[c]});this.rooms.sort(function(e,t){return e.alias<t.alias?-1:e.alias>t.alias?1:0}),this.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",this.isReloading=!1;case 9:case"end":return e.stop()}},e,this)}))}},{key:"connect",value:function(e){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i,r,o,s=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e[0],i="",t.t0=n.hasPassword,!t.t0){t.next=7;break}return t.next=5,this.modalService.open(hS,{peerId:n.peerId,title:"".concat(n.roomName,"/").concat(n.roomId)});case 5:null==(i=t.sent)&&(i="");case 7:if(n.verifyPassword(i)){t.next=9;break}return t.abrupt("return");case 9:r=ek.peerContext?ek.peerContext.userId:Jm.generateId(),ek.open(r,n.roomId,n.roomName,i),Rk.myCursor.peerId=ek.peerId,o=[],Jb.register(o).on("OPEN_NETWORK",function(t){console.log("LobbyComponent OPEN_PEER",t.data.peerId),Jb.unregister(o),tk.instance.clearDeleteHistory();var n,i=a(e);try{for(i.s();!(n=i.n()).done;){var r=n.value;ek.connect(r.peerId)}}catch(l){i.e(l)}finally{i.f()}Jb.register(o).on("CONNECT_PEER",function(t){console.log("\u63a5\u7d9a\u6210\u529f\uff01",t.data.peerId),o.push(t.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+o.length+"/"+e.length),e.length<=o.length&&(s.resetNetwork(),Jb.unregister(o))}).on("DISCONNECT_PEER",function(t){console.warn("\u63a5\u7d9a\u5931\u6557",t.data.peerId),o.push(t.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+o.length+"/"+e.length),e.length<=o.length&&(s.resetNetwork(),Jb.unregister(o))})});case 13:case"end":return t.stop()}},t,this)}))}},{key:"resetNetwork",value:function(){ek.peerContexts.length<1&&(ek.open(),Rk.myCursor.peerId=ek.peerId)}},{key:"showRoomSetting",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.modalService.open(yS,{width:700,height:400,left:0,top:400});case 2:this.reload(),this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002";case 4:case"end":return e.stop()}},e,this)}))}}]),e}()).\u0275fac=function(e){return new(e||OS)(Vo(Wk),Vo(Zk))},OS.\u0275cmp=ct({type:OS,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,t){if(1&e&&(Uo(0,ES,8,3,"div",0),Uo(1,SS,4,0,"ng-template",null,1,Ic)),2&e){var n=Ho(2);Wo("ngIf",!t.isConnected)("ngIfElse",n)}},directives:[dh,uh],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),OS),MS=((TS=function(){function e(){y(this,e),this.queue=new vk("DatabaseQueue"),this.openDB(e.DB_NAME,e.VERSION)}return k(e,[{key:"openDB",value:function(e,t){var n=this;return this.queue.add(function(i,r){console.log("openDB");var a=indexedDB.open(e,t);a.onerror=function(r){console.error(a.error,r),"VersionError"===a.error.name&&(indexedDB.deleteDatabase(e),n.openDB(e,t)),i()},a.onblocked=function(e){console.warn("openDB onblocked"),alert("\u3053\u306e\u30b5\u30a4\u30c8\u3092\u958b\u3044\u3066\u3044\u308b\u4ed6\u306e\u30bf\u30d6\u3092\u3059\u3079\u3066\u9589\u3058\u3066\u304f\u3060\u3055\u3044!")},a.onupgradeneeded=function(e){console.log("openDB onupgradeneeded"),n.initializeDB(a.result),n.createStores()},a.onsuccess=function(e){console.log("openDB onsuccess"),n.initializeDB(a.result),i()}})}},{key:"createStores",value:function(){console.log("createStores"),this.db.objectStoreNames.contains("PeerHistory")&&this.db.deleteObjectStore("PeerHistory");var e=this.db.createObjectStore("PeerHistory",{keyPath:"peerId"});e.createIndex("timestamp","timestamp",{unique:!1}),e.transaction.oncomplete=function(e){console.log("createStores oncomplete")}}},{key:"initializeDB",value:function(e){console.log("initializeDB"),e.onversionchange=function(t){console.warn("db.onversionchange."),e.close(),alert("\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30da\u30fc\u30b8\u304c\u4f7f\u7528\u53ef\u80fd\u306b\u306a\u308a\u307e\u3057\u305f\u3002\u518d\u8aad\u307f\u8fbc\u307f\u3057\u3066\u304f\u3060\u3055\u3044!")},e.onabort=function(e){console.error(e)},e.onerror=function(e){console.error(e)},this.db=e}},{key:"addPeerHistory",value:function(e,t){var n=this;this.queue.add(function(i,r){console.log("addPeerHistory");var a=n.db.transaction(["PeerHistory"],"readwrite"),o=a.objectStore("PeerHistory");a.oncomplete=function(e){console.log("addPeerHistory done.","readwrite"),i()},a.onerror=function(e){console.error(e),i()};var s={peerId:e,timestamp:Date.now(),history:t};o.put(s)})}},{key:"deletePeerHistory",value:function(e){var t=this;this.queue.add(function(n,i){var r=t.db.transaction(["PeerHistory"],"readwrite"),a=r.objectStore("PeerHistory");r.oncomplete=function(e){console.log("addPeerHistory done.","readwrite"),n()},r.onerror=function(e){console.error(e),n()},a.delete(e)})}},{key:"getPeerHistory",value:function(){var e=this;return this.queue.add(function(t,n){console.log("getPeerHistory");var i=e.db.transaction(["PeerHistory"],"readonly"),r=i.objectStore("PeerHistory").openCursor(),a=[];i.oncomplete=function(e){console.log("getPeerHistory done."),t(a)},i.onerror=function(e){console.error(e),t(a)},r.onerror=function(e){console.error(e),t(a)},r.onsuccess=function(e){var t=r.result;t?(console.log("id:"+t.key+" value:",t.value),a.push(t.value),t.continue()):console.log("Entries all displayed.")}})}}]),e}()).DB_NAME="UdonariumDataBase",TS.VERSION=1,TS),AS=function(e,t){var n,i="";for(n=0;n<t;n+=1)i+=e;return i},PS=function(e){return 0===e&&Number.NEGATIVE_INFINITY===1/e};function DS(e,t){var n="",i=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+="\n\n"+e.mark.snippet),i+" "+n):i}function RS(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=DS(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(RS.prototype=Object.create(Error.prototype)).constructor=RS,RS.prototype.toString=function(e){return this.name+": "+DS(this,e)};var FS=RS;function NS(e,t,n,i,r){var a="",o="",s=Math.floor(r/2)-1;return i-t>s&&(t=i-s+(a=" ... ").length),n-i>s&&(n=i+s-(o=" ...").length),{str:a+e.slice(t,n).replace(/\t/g,"\u2192")+o,pos:i-t+a.length}}function zS(e,t){return AS(" ",t-e.length)+e}var LS=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],BS=["scalar","sequence","mapping"],jS=function(e,t){var n,i;if(t=t||{},Object.keys(t).forEach(function(t){if(-1===LS.indexOf(t))throw new FS('Unknown option "'+t+'" is met in definition of "'+e+'" YAML type.')}),this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(e){return e},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=(i={},null!==(n=t.styleAliases||null)&&Object.keys(n).forEach(function(e){n[e].forEach(function(t){i[String(t)]=e})}),i),-1===BS.indexOf(this.kind))throw new FS('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')};function US(e,t,n){var i=[];return e[t].forEach(function(e){n.forEach(function(t,n){t.tag===e.tag&&t.kind===e.kind&&t.multi===e.multi&&i.push(n)}),n.push(e)}),n.filter(function(e,t){return-1===i.indexOf(t)})}function HS(e){return this.extend(e)}HS.prototype.extend=function(e){var t=[],n=[];if(e instanceof jS)n.push(e);else if(Array.isArray(e))n=n.concat(e);else{if(!e||!Array.isArray(e.implicit)&&!Array.isArray(e.explicit))throw new FS("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");e.implicit&&(t=t.concat(e.implicit)),e.explicit&&(n=n.concat(e.explicit))}t.forEach(function(e){if(!(e instanceof jS))throw new FS("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(e.loadKind&&"scalar"!==e.loadKind)throw new FS("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(e.multi)throw new FS("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),n.forEach(function(e){if(!(e instanceof jS))throw new FS("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var i=Object.create(HS.prototype);return i.implicit=(this.implicit||[]).concat(t),i.explicit=(this.explicit||[]).concat(n),i.compiledImplicit=US(i,"implicit",[]),i.compiledExplicit=US(i,"explicit",[]),i.compiledTypeMap=function(){var e,t,n={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(e){e.multi?(n.multi[e.kind].push(e),n.multi.fallback.push(e)):n[e.kind][e.tag]=n.fallback[e.tag]=e}for(e=0,t=arguments.length;e<t;e+=1)arguments[e].forEach(i);return n}(i.compiledImplicit,i.compiledExplicit),i};var VS=new HS({explicit:[new jS("tag:yaml.org,2002:str",{kind:"scalar",construct:function(e){return null!==e?e:""}}),new jS("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(e){return null!==e?e:[]}}),new jS("tag:yaml.org,2002:map",{kind:"mapping",construct:function(e){return null!==e?e:{}}})]}),WS=new jS("tag:yaml.org,2002:null",{kind:"scalar",resolve:function(e){if(null===e)return!0;var t=e.length;return 1===t&&"~"===e||4===t&&("null"===e||"Null"===e||"NULL"===e)},construct:function(){return null},predicate:function(e){return null===e},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),GS=new jS("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t=e.length;return 4===t&&("true"===e||"True"===e||"TRUE"===e)||5===t&&("false"===e||"False"===e||"FALSE"===e)},construct:function(e){return"true"===e||"True"===e||"TRUE"===e},predicate:function(e){return"[object Boolean]"===Object.prototype.toString.call(e)},represent:{lowercase:function(e){return e?"true":"false"},uppercase:function(e){return e?"TRUE":"FALSE"},camelcase:function(e){return e?"True":"False"}},defaultStyle:"lowercase"});function ZS(e){return 48<=e&&e<=55}function YS(e){return 48<=e&&e<=57}var qS=new jS("tag:yaml.org,2002:int",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,i=e.length,r=0,a=!1;if(!i)return!1;if("-"!==(t=e[r])&&"+"!==t||(t=e[++r]),"0"===t){if(r+1===i)return!0;if("b"===(t=e[++r])){for(r++;r<i;r++)if("_"!==(t=e[r])){if("0"!==t&&"1"!==t)return!1;a=!0}return a&&"_"!==t}if("x"===t){for(r++;r<i;r++)if("_"!==(t=e[r])){if(!(48<=(n=e.charCodeAt(r))&&n<=57||65<=n&&n<=70||97<=n&&n<=102))return!1;a=!0}return a&&"_"!==t}if("o"===t){for(r++;r<i;r++)if("_"!==(t=e[r])){if(!ZS(e.charCodeAt(r)))return!1;a=!0}return a&&"_"!==t}}if("_"===t)return!1;for(;r<i;r++)if("_"!==(t=e[r])){if(!YS(e.charCodeAt(r)))return!1;a=!0}return!(!a||"_"===t)},construct:function(e){var t,n=e,i=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),"-"!==(t=n[0])&&"+"!==t||("-"===t&&(i=-1),t=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===t){if("b"===n[1])return i*parseInt(n.slice(2),2);if("x"===n[1])return i*parseInt(n.slice(2),16);if("o"===n[1])return i*parseInt(n.slice(2),8)}return i*parseInt(n,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&e%1==0&&!PS(e)},represent:{binary:function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},octal:function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},decimal:function(e){return e.toString(10)},hexadecimal:function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),XS=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),KS=/^[-+]?[0-9]+e/,$S=new jS("tag:yaml.org,2002:float",{kind:"scalar",resolve:function(e){return null!==e&&!(!XS.test(e)||"_"===e[e.length-1])},construct:function(e){var t,n;return n="-"===(t=e.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),".inf"===t?1===n?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===t?NaN:n*parseFloat(t,10)},predicate:function(e){return"[object Number]"===Object.prototype.toString.call(e)&&(e%1!=0||PS(e))},represent:function(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(PS(e))return"-0.0";return n=e.toString(10),KS.test(n)?n.replace("e",".e"):n},defaultStyle:"lowercase"}),QS=VS.extend({implicit:[WS,GS,qS,$S]}),JS=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),eT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),tT=new jS("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function(e){return null!==e&&(null!==JS.exec(e)||null!==eT.exec(e))},construct:function(e){var t,n,i,r,a,o,s,l,c=0,u=null;if(null===(t=JS.exec(e))&&(t=eT.exec(e)),null===t)throw new Error("Date resolve error");if(n=+t[1],i=+t[2]-1,r=+t[3],!t[4])return new Date(Date.UTC(n,i,r));if(a=+t[4],o=+t[5],s=+t[6],t[7]){for(c=t[7].slice(0,3);c.length<3;)c+="0";c=+c}return t[9]&&(u=6e4*(60*+t[10]+ +(t[11]||0)),"-"===t[9]&&(u=-u)),l=new Date(Date.UTC(n,i,r,a,o,s,c)),u&&l.setTime(l.getTime()-u),l},instanceOf:Date,represent:function(e){return e.toISOString()}}),nT=new jS("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function(e){return"<<"===e||null===e}}),iT="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",rT=new jS("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function(e){if(null===e)return!1;var t,n,i=0,r=e.length,a=iT;for(n=0;n<r;n++)if(!((t=a.indexOf(e.charAt(n)))>64)){if(t<0)return!1;i+=6}return i%8==0},construct:function(e){var t,n,i=e.replace(/[\r\n=]/g,""),r=i.length,a=iT,o=0,s=[];for(t=0;t<r;t++)t%4==0&&t&&(s.push(o>>16&255),s.push(o>>8&255),s.push(255&o)),o=o<<6|a.indexOf(i.charAt(t));return 0==(n=r%4*6)?(s.push(o>>16&255),s.push(o>>8&255),s.push(255&o)):18===n?(s.push(o>>10&255),s.push(o>>2&255)):12===n&&s.push(o>>4&255),new Uint8Array(s)},predicate:function(e){return"[object Uint8Array]"===Object.prototype.toString.call(e)},represent:function(e){var t,n,i="",r=0,a=e.length,o=iT;for(t=0;t<a;t++)t%3==0&&t&&(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]),r=(r<<8)+e[t];return 0==(n=a%3)?(i+=o[r>>18&63],i+=o[r>>12&63],i+=o[r>>6&63],i+=o[63&r]):2===n?(i+=o[r>>10&63],i+=o[r>>4&63],i+=o[r<<2&63],i+=o[64]):1===n&&(i+=o[r>>2&63],i+=o[r<<4&63],i+=o[64],i+=o[64]),i}}),aT=Object.prototype.hasOwnProperty,oT=Object.prototype.toString,sT=new jS("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,r,a,o=[],s=e;for(t=0,n=s.length;t<n;t+=1){if(a=!1,"[object Object]"!==oT.call(i=s[t]))return!1;for(r in i)if(aT.call(i,r)){if(a)return!1;a=!0}if(!a)return!1;if(-1!==o.indexOf(r))return!1;o.push(r)}return!0},construct:function(e){return null!==e?e:[]}}),lT=Object.prototype.toString,cT=new jS("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function(e){if(null===e)return!0;var t,n,i,r,a,o=e;for(a=new Array(o.length),t=0,n=o.length;t<n;t+=1){if("[object Object]"!==lT.call(i=o[t]))return!1;if(1!==(r=Object.keys(i)).length)return!1;a[t]=[r[0],i[r[0]]]}return!0},construct:function(e){if(null===e)return[];var t,n,i,r,a,o=e;for(a=new Array(o.length),t=0,n=o.length;t<n;t+=1)i=o[t],r=Object.keys(i),a[t]=[r[0],i[r[0]]];return a}}),uT=Object.prototype.hasOwnProperty,hT=new jS("tag:yaml.org,2002:set",{kind:"mapping",resolve:function(e){if(null===e)return!0;var t,n=e;for(t in n)if(uT.call(n,t)&&null!==n[t])return!1;return!0},construct:function(e){return null!==e?e:{}}}),dT=QS.extend({implicit:[tT,nT],explicit:[rT,sT,cT,hT]}),fT=Object.prototype.hasOwnProperty,pT=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,gT=/[\x85\u2028\u2029]/,mT=/[,\[\]\{\}]/,vT=/^(?:!|!!|![a-z\-]+!)$/i,yT=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function bT(e){return Object.prototype.toString.call(e)}function kT(e){return 10===e||13===e}function _T(e){return 9===e||32===e}function wT(e){return 9===e||32===e||10===e||13===e}function xT(e){return 44===e||91===e||93===e||123===e||125===e}function CT(e){var t;return 48<=e&&e<=57?e-48:97<=(t=32|e)&&t<=102?t-97+10:-1}function ET(e){return 48===e?"\0":97===e?"\x07":98===e?"\b":116===e||9===e?"\t":110===e?"\n":118===e?"\v":102===e?"\f":114===e?"\r":101===e?"\x1b":32===e?" ":34===e?'"':47===e?"/":92===e?"\\":78===e?"\x85":95===e?"\xa0":76===e?"\u2028":80===e?"\u2029":""}function ST(e){return e<=65535?String.fromCharCode(e):String.fromCharCode(55296+(e-65536>>10),56320+(e-65536&1023))}for(var TT=new Array(256),OT=new Array(256),IT=0;IT<256;IT++)TT[IT]=ET(IT)?1:0,OT[IT]=ET(IT);function MT(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||dT,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function AT(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=function(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),"number"!=typeof t.indent&&(t.indent=1),"number"!=typeof t.linesBefore&&(t.linesBefore=3),"number"!=typeof t.linesAfter&&(t.linesAfter=2);for(var n,i=/\r?\n|\r|\0/g,r=[0],a=[],o=-1;n=i.exec(e.buffer);)a.push(n.index),r.push(n.index+n[0].length),e.position<=n.index&&o<0&&(o=r.length-2);o<0&&(o=r.length-1);var s,l,c="",u=Math.min(e.line+t.linesAfter,a.length).toString().length,h=t.maxLength-(t.indent+u+3);for(s=1;s<=t.linesBefore&&!(o-s<0);s++)l=NS(e.buffer,r[o-s],a[o-s],e.position-(r[o]-r[o-s]),h),c=AS(" ",t.indent)+zS((e.line-s+1).toString(),u)+" | "+l.str+"\n"+c;for(l=NS(e.buffer,r[o],a[o],e.position,h),c+=AS(" ",t.indent)+zS((e.line+1).toString(),u)+" | "+l.str+"\n",c+=AS("-",t.indent+u+3+l.pos)+"^\n",s=1;s<=t.linesAfter&&!(o+s>=a.length);s++)l=NS(e.buffer,r[o+s],a[o+s],e.position-(r[o]-r[o+s]),h),c+=AS(" ",t.indent)+zS((e.line+s+1).toString(),u)+" | "+l.str+"\n";return c.replace(/\n$/,"")}(n),new FS(t,n)}function PT(e,t){throw AT(e,t)}function DT(e,t){e.onWarning&&e.onWarning.call(null,AT(e,t))}var RT={YAML:function(e,t,n){var i,r,a;null!==e.version&&PT(e,"duplication of %YAML directive"),1!==n.length&&PT(e,"YAML directive accepts exactly one argument"),null===(i=/^([0-9]+)\.([0-9]+)$/.exec(n[0]))&&PT(e,"ill-formed argument of the YAML directive"),r=parseInt(i[1],10),a=parseInt(i[2],10),1!==r&&PT(e,"unacceptable YAML version of the document"),e.version=n[0],e.checkLineBreaks=a<2,1!==a&&2!==a&&DT(e,"unsupported YAML version of the document")},TAG:function(e,t,n){var i,r;2!==n.length&&PT(e,"TAG directive accepts exactly two arguments"),r=n[1],vT.test(i=n[0])||PT(e,"ill-formed tag handle (first argument) of the TAG directive"),fT.call(e.tagMap,i)&&PT(e,'there is a previously declared suffix for "'+i+'" tag handle'),yT.test(r)||PT(e,"ill-formed tag prefix (second argument) of the TAG directive");try{r=decodeURIComponent(r)}catch(a){PT(e,"tag prefix is malformed: "+r)}e.tagMap[i]=r}};function FT(e,t,n,i){var r,a,o,s;if(t<n){if(s=e.input.slice(t,n),i)for(r=0,a=s.length;r<a;r+=1)9===(o=s.charCodeAt(r))||32<=o&&o<=1114111||PT(e,"expected valid JSON character");else pT.test(s)&&PT(e,"the stream contains non-printable characters");e.result+=s}}function NT(e,t,n,i){var r,a,o,s,l;for("object"==typeof(l=n)&&null!==l||PT(e,"cannot merge mappings; the provided source object is unacceptable"),o=0,s=(r=Object.keys(n)).length;o<s;o+=1)fT.call(t,a=r[o])||(t[a]=n[a],i[a]=!0)}function zT(e,t,n,i,r,a,o,s,l){var c,u;if(Array.isArray(r))for(c=0,u=(r=Array.prototype.slice.call(r)).length;c<u;c+=1)Array.isArray(r[c])&&PT(e,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===bT(r[c])&&(r[c]="[object Object]");if("object"==typeof r&&"[object Object]"===bT(r)&&(r="[object Object]"),r=String(r),null===t&&(t={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(a))for(c=0,u=a.length;c<u;c+=1)NT(e,t,a[c],n);else NT(e,t,a,n);else e.json||fT.call(n,r)||!fT.call(t,r)||(e.line=o||e.line,e.lineStart=s||e.lineStart,e.position=l||e.position,PT(e,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(t,r,{configurable:!0,enumerable:!0,writable:!0,value:a}):t[r]=a,delete n[r];return t}function LT(e){var t;10===(t=e.input.charCodeAt(e.position))?e.position++:13===t?(e.position++,10===e.input.charCodeAt(e.position)&&e.position++):PT(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}function BT(e,t,n){for(var i=0,r=e.input.charCodeAt(e.position);0!==r;){for(;_T(r);)9===r&&-1===e.firstTabInLine&&(e.firstTabInLine=e.position),r=e.input.charCodeAt(++e.position);if(t&&35===r)do{r=e.input.charCodeAt(++e.position)}while(10!==r&&13!==r&&0!==r);if(!kT(r))break;for(LT(e),r=e.input.charCodeAt(e.position),i++,e.lineIndent=0;32===r;)e.lineIndent++,r=e.input.charCodeAt(++e.position)}return-1!==n&&0!==i&&e.lineIndent<n&&DT(e,"deficient indentation"),i}function jT(e){var t,n=e.position;return!(45!==(t=e.input.charCodeAt(n))&&46!==t||t!==e.input.charCodeAt(n+1)||t!==e.input.charCodeAt(n+2)||0!==(t=e.input.charCodeAt(n+=3))&&!wT(t))}function UT(e,t){1===t?e.result+=" ":t>1&&(e.result+=AS("\n",t-1))}function HT(e,t){var n,i,r=e.tag,a=e.anchor,o=[],s=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=o),i=e.input.charCodeAt(e.position);0!==i&&(-1!==e.firstTabInLine&&(e.position=e.firstTabInLine,PT(e,"tab characters must not be used in indentation")),45===i)&&wT(e.input.charCodeAt(e.position+1));)if(s=!0,e.position++,BT(e,!0,-1)&&e.lineIndent<=t)o.push(null),i=e.input.charCodeAt(e.position);else if(n=e.line,GT(e,t,3,!1,!0),o.push(e.result),BT(e,!0,-1),i=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&0!==i)PT(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break;return!!s&&(e.tag=r,e.anchor=a,e.kind="sequence",e.result=o,!0)}function VT(e){var t,n,i,r,a=!1,o=!1;if(33!==(r=e.input.charCodeAt(e.position)))return!1;if(null!==e.tag&&PT(e,"duplication of a tag property"),60===(r=e.input.charCodeAt(++e.position))?(a=!0,r=e.input.charCodeAt(++e.position)):33===r?(o=!0,n="!!",r=e.input.charCodeAt(++e.position)):n="!",t=e.position,a){do{r=e.input.charCodeAt(++e.position)}while(0!==r&&62!==r);e.position<e.length?(i=e.input.slice(t,e.position),r=e.input.charCodeAt(++e.position)):PT(e,"unexpected end of the stream within a verbatim tag")}else{for(;0!==r&&!wT(r);)33===r&&(o?PT(e,"tag suffix cannot contain exclamation marks"):(n=e.input.slice(t-1,e.position+1),vT.test(n)||PT(e,"named tag handle cannot contain such characters"),o=!0,t=e.position+1)),r=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),mT.test(i)&&PT(e,"tag suffix cannot contain flow indicator characters")}i&&!yT.test(i)&&PT(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch(s){PT(e,"tag name is malformed: "+i)}return a?e.tag=i:fT.call(e.tagMap,n)?e.tag=e.tagMap[n]+i:"!"===n?e.tag="!"+i:"!!"===n?e.tag="tag:yaml.org,2002:"+i:PT(e,'undeclared tag handle "'+n+'"'),!0}function WT(e){var t,n;if(38!==(n=e.input.charCodeAt(e.position)))return!1;for(null!==e.anchor&&PT(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;0!==n&&!wT(n)&&!xT(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&PT(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}function GT(e,t,n,i,r){var a,o,s,l,c,u,h,d,f,p=1,g=!1,m=!1;if(null!==e.listener&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,a=o=s=4===n||3===n,i&&BT(e,!0,-1)&&(g=!0,e.lineIndent>t?p=1:e.lineIndent===t?p=0:e.lineIndent<t&&(p=-1)),1===p)for(;VT(e)||WT(e);)BT(e,!0,-1)?(g=!0,s=a,e.lineIndent>t?p=1:e.lineIndent===t?p=0:e.lineIndent<t&&(p=-1)):s=!1;if(s&&(s=g||r),1!==p&&4!==n||(d=1===n||2===n?t:t+1,f=e.position-e.lineStart,1===p?s&&(HT(e,f)||function(e,t,n){var i,r,a,o,s,l,c,u=e.tag,h=e.anchor,d={},f=Object.create(null),p=null,g=null,m=null,v=!1,y=!1;if(-1!==e.firstTabInLine)return!1;for(null!==e.anchor&&(e.anchorMap[e.anchor]=d),c=e.input.charCodeAt(e.position);0!==c;){if(v||-1===e.firstTabInLine||(e.position=e.firstTabInLine,PT(e,"tab characters must not be used in indentation")),i=e.input.charCodeAt(e.position+1),a=e.line,63!==c&&58!==c||!wT(i)){if(o=e.line,s=e.lineStart,l=e.position,!GT(e,n,2,!1,!0))break;if(e.line===a){for(c=e.input.charCodeAt(e.position);_T(c);)c=e.input.charCodeAt(++e.position);if(58===c)wT(c=e.input.charCodeAt(++e.position))||PT(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(zT(e,d,f,p,g,null,o,s,l),p=g=m=null),y=!0,v=!1,r=!1,p=e.tag,g=e.result;else{if(!y)return e.tag=u,e.anchor=h,!0;PT(e,"can not read an implicit mapping pair; a colon is missed")}}else{if(!y)return e.tag=u,e.anchor=h,!0;PT(e,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===c?(v&&(zT(e,d,f,p,g,null,o,s,l),p=g=m=null),y=!0,v=!0,r=!0):v?(v=!1,r=!0):PT(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,c=i;if((e.line===a||e.lineIndent>t)&&(v&&(o=e.line,s=e.lineStart,l=e.position),GT(e,t,4,!0,r)&&(v?g=e.result:m=e.result),v||(zT(e,d,f,p,g,m,o,s,l),p=g=m=null),BT(e,!0,-1),c=e.input.charCodeAt(e.position)),(e.line===a||e.lineIndent>t)&&0!==c)PT(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&zT(e,d,f,p,g,null,o,s,l),y&&(e.tag=u,e.anchor=h,e.kind="mapping",e.result=d),y}(e,f,d))||function(e,t){var n,i,r,a,o,s,l,c,u,h,d,f,p=!0,g=e.tag,m=e.anchor,v=Object.create(null);if(91===(f=e.input.charCodeAt(e.position)))o=93,c=!1,a=[];else{if(123!==f)return!1;o=125,c=!0,a={}}for(null!==e.anchor&&(e.anchorMap[e.anchor]=a),f=e.input.charCodeAt(++e.position);0!==f;){if(BT(e,!0,t),(f=e.input.charCodeAt(e.position))===o)return e.position++,e.tag=g,e.anchor=m,e.kind=c?"mapping":"sequence",e.result=a,!0;p?44===f&&PT(e,"expected the node content, but found ','"):PT(e,"missed comma between flow collection entries"),d=null,s=l=!1,63===f&&wT(e.input.charCodeAt(e.position+1))&&(s=l=!0,e.position++,BT(e,!0,t)),n=e.line,i=e.lineStart,r=e.position,GT(e,t,1,!1,!0),h=e.tag,u=e.result,BT(e,!0,t),f=e.input.charCodeAt(e.position),!l&&e.line!==n||58!==f||(s=!0,f=e.input.charCodeAt(++e.position),BT(e,!0,t),GT(e,t,1,!1,!0),d=e.result),c?zT(e,a,v,h,u,d,n,i,r):a.push(s?zT(e,null,v,h,u,d,n,i,r):u),BT(e,!0,t),44===(f=e.input.charCodeAt(e.position))?(p=!0,f=e.input.charCodeAt(++e.position)):p=!1}PT(e,"unexpected end of the stream within a flow collection")}(e,d)?m=!0:(o&&function(e,t){var n,i,r,a,o,s=1,l=!1,c=!1,u=t,h=0,d=!1;if(124===(a=e.input.charCodeAt(e.position)))i=!1;else{if(62!==a)return!1;i=!0}for(e.kind="scalar",e.result="";0!==a;)if(43===(a=e.input.charCodeAt(++e.position))||45===a)1===s?s=43===a?3:2:PT(e,"repeat of a chomping mode identifier");else{if(!((r=48<=(o=a)&&o<=57?o-48:-1)>=0))break;0===r?PT(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):c?PT(e,"repeat of an indentation width identifier"):(u=t+r-1,c=!0)}if(_T(a)){do{a=e.input.charCodeAt(++e.position)}while(_T(a));if(35===a)do{a=e.input.charCodeAt(++e.position)}while(!kT(a)&&0!==a)}for(;0!==a;){for(LT(e),e.lineIndent=0,a=e.input.charCodeAt(e.position);(!c||e.lineIndent<u)&&32===a;)e.lineIndent++,a=e.input.charCodeAt(++e.position);if(!c&&e.lineIndent>u&&(u=e.lineIndent),kT(a))h++;else{if(e.lineIndent<u){3===s?e.result+=AS("\n",l?1+h:h):1===s&&l&&(e.result+="\n");break}for(i?_T(a)?(d=!0,e.result+=AS("\n",l?1+h:h)):d?(d=!1,e.result+=AS("\n",h+1)):0===h?l&&(e.result+=" "):e.result+=AS("\n",h):e.result+=AS("\n",l?1+h:h),l=!0,c=!0,h=0,n=e.position;!kT(a)&&0!==a;)a=e.input.charCodeAt(++e.position);FT(e,n,e.position,!1)}}return!0}(e,d)||function(e,t){var n,i,r;if(39!==(n=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,i=r=e.position;0!==(n=e.input.charCodeAt(e.position));)if(39===n){if(FT(e,i,e.position,!0),39!==(n=e.input.charCodeAt(++e.position)))return!0;i=e.position,e.position++,r=e.position}else kT(n)?(FT(e,i,r,!0),UT(e,BT(e,!1,t)),i=r=e.position):e.position===e.lineStart&&jT(e)?PT(e,"unexpected end of the document within a single quoted scalar"):(e.position++,r=e.position);PT(e,"unexpected end of the stream within a single quoted scalar")}(e,d)||function(e,t){var n,i,r,a,o,s,l;if(34!==(s=e.input.charCodeAt(e.position)))return!1;for(e.kind="scalar",e.result="",e.position++,n=i=e.position;0!==(s=e.input.charCodeAt(e.position));){if(34===s)return FT(e,n,e.position,!0),e.position++,!0;if(92===s){if(FT(e,n,e.position,!0),kT(s=e.input.charCodeAt(++e.position)))BT(e,!1,t);else if(s<256&&TT[s])e.result+=OT[s],e.position++;else if((o=120===(l=s)?2:117===l?4:85===l?8:0)>0){for(r=o,a=0;r>0;r--)(o=CT(s=e.input.charCodeAt(++e.position)))>=0?a=(a<<4)+o:PT(e,"expected hexadecimal character");e.result+=ST(a),e.position++}else PT(e,"unknown escape sequence");n=i=e.position}else kT(s)?(FT(e,n,i,!0),UT(e,BT(e,!1,t)),n=i=e.position):e.position===e.lineStart&&jT(e)?PT(e,"unexpected end of the document within a double quoted scalar"):(e.position++,i=e.position)}PT(e,"unexpected end of the stream within a double quoted scalar")}(e,d)?m=!0:function(e){var t,n,i;if(42!==(i=e.input.charCodeAt(e.position)))return!1;for(i=e.input.charCodeAt(++e.position),t=e.position;0!==i&&!wT(i)&&!xT(i);)i=e.input.charCodeAt(++e.position);return e.position===t&&PT(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),fT.call(e.anchorMap,n)||PT(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],BT(e,!0,-1),!0}(e)?(m=!0,null===e.tag&&null===e.anchor||PT(e,"alias node should not have any properties")):function(e,t,n){var i,r,a,o,s,l,c,u,h=e.kind,d=e.result;if(wT(u=e.input.charCodeAt(e.position))||xT(u)||35===u||38===u||42===u||33===u||124===u||62===u||39===u||34===u||37===u||64===u||96===u)return!1;if((63===u||45===u)&&(wT(i=e.input.charCodeAt(e.position+1))||n&&xT(i)))return!1;for(e.kind="scalar",e.result="",r=a=e.position,o=!1;0!==u;){if(58===u){if(wT(i=e.input.charCodeAt(e.position+1))||n&&xT(i))break}else if(35===u){if(wT(e.input.charCodeAt(e.position-1)))break}else{if(e.position===e.lineStart&&jT(e)||n&&xT(u))break;if(kT(u)){if(s=e.line,l=e.lineStart,c=e.lineIndent,BT(e,!1,-1),e.lineIndent>=t){o=!0,u=e.input.charCodeAt(e.position);continue}e.position=a,e.line=s,e.lineStart=l,e.lineIndent=c;break}}o&&(FT(e,r,a,!1),UT(e,e.line-s),r=a=e.position,o=!1),_T(u)||(a=e.position+1),u=e.input.charCodeAt(++e.position)}return FT(e,r,a,!1),!!e.result||(e.kind=h,e.result=d,!1)}(e,d,1===n)&&(m=!0,null===e.tag&&(e.tag="?")),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):0===p&&(m=s&&HT(e,f))),null===e.tag)null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);else if("?"===e.tag){for(null!==e.result&&"scalar"!==e.kind&&PT(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),l=0,c=e.implicitTypes.length;l<c;l+=1)if((h=e.implicitTypes[l]).resolve(e.result)){e.result=h.construct(e.result),e.tag=h.tag,null!==e.anchor&&(e.anchorMap[e.anchor]=e.result);break}}else if("!"!==e.tag){if(fT.call(e.typeMap[e.kind||"fallback"],e.tag))h=e.typeMap[e.kind||"fallback"][e.tag];else for(h=null,l=0,c=(u=e.typeMap.multi[e.kind||"fallback"]).length;l<c;l+=1)if(e.tag.slice(0,u[l].tag.length)===u[l].tag){h=u[l];break}h||PT(e,"unknown tag !<"+e.tag+">"),null!==e.result&&h.kind!==e.kind&&PT(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+h.kind+'", not "'+e.kind+'"'),h.resolve(e.result,e.tag)?(e.result=h.construct(e.result,e.tag),null!==e.anchor&&(e.anchorMap[e.anchor]=e.result)):PT(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return null!==e.listener&&e.listener("close",e),null!==e.tag||null!==e.anchor||m}function ZT(e){var t,n,i,r,a=e.position,o=!1;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);0!==(r=e.input.charCodeAt(e.position))&&(BT(e,!0,-1),r=e.input.charCodeAt(e.position),!(e.lineIndent>0||37!==r));){for(o=!0,r=e.input.charCodeAt(++e.position),t=e.position;0!==r&&!wT(r);)r=e.input.charCodeAt(++e.position);for(i=[],(n=e.input.slice(t,e.position)).length<1&&PT(e,"directive name must not be less than one character in length");0!==r;){for(;_T(r);)r=e.input.charCodeAt(++e.position);if(35===r){do{r=e.input.charCodeAt(++e.position)}while(0!==r&&!kT(r));break}if(kT(r))break;for(t=e.position;0!==r&&!wT(r);)r=e.input.charCodeAt(++e.position);i.push(e.input.slice(t,e.position))}0!==r&&LT(e),fT.call(RT,n)?RT[n](e,n,i):DT(e,'unknown document directive "'+n+'"')}BT(e,!0,-1),0===e.lineIndent&&45===e.input.charCodeAt(e.position)&&45===e.input.charCodeAt(e.position+1)&&45===e.input.charCodeAt(e.position+2)?(e.position+=3,BT(e,!0,-1)):o&&PT(e,"directives end mark is expected"),GT(e,e.lineIndent-1,4,!1,!0),BT(e,!0,-1),e.checkLineBreaks&&gT.test(e.input.slice(a,e.position))&&DT(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&jT(e)?46===e.input.charCodeAt(e.position)&&(e.position+=3,BT(e,!0,-1)):e.position<e.length-1&&PT(e,"end of the stream or a document separator is expected")}function YT(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}var qT=function(e,t){var n=function(e,t){t=t||{},0!==(e=String(e)).length&&(10!==e.charCodeAt(e.length-1)&&13!==e.charCodeAt(e.length-1)&&(e+="\n"),65279===e.charCodeAt(0)&&(e=e.slice(1)));var n=new MT(e,t),i=e.indexOf("\0");for(-1!==i&&(n.position=i,PT(n,"null byte is not allowed in input")),n.input+="\0";32===n.input.charCodeAt(n.position);)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)ZT(n);return n.documents}(e,t);if(0!==n.length){if(1===n.length)return n[0];throw new FS("expected a single document in the stream, but found more")}};YT("safeLoad","load"),YT("safeLoadAll","loadAll"),YT("safeDump","dump");var XT,KT=Object.getOwnPropertyNames(Object.prototype),$T=Object.getOwnPropertyNames(Array.prototype),QT=((XT=function(){function e(){y(this,e),this.peerHistory=[],this.isOpen=!1}return k(e,[{key:"initialize",value:function(){this.initAppConfig(),this.initDatabase()}},{key:"initDatabase",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,r,o,s,l=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("initDatabase..."),window.indexedDB){e.next=2;break}return e.abrupt("return",void console.warn("\u3053\u306e\u30d6\u30e9\u30a6\u30b6\u306f\u5b89\u5b9a\u677f\u306e IndexedDB \u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002IndexedDB \u306e\u6a5f\u80fd\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"));case 2:return t=new MS,e.next=5,t.getPeerHistory();case 5:for((n=e.sent).sort(function(e,t){return e.timestamp<t.timestamp?1:e.timestamp>t.timestamp?-1:0}),i=1;i<n.length;i++)t.deletePeerHistory(n[i].peerId);if(console.log("\u5c65\u6b74: ",n),this.peerHistory=[],n.length){r=a(n[0].history);try{for(r.s();!(o=r.n()).done;)(s=o.value)!==n[0].peerId&&this.peerHistory.push(s)}catch(c){r.e(c)}finally{r.f()}}console.log("\u6700\u7d42\u5c65\u6b74: ",this.peerHistory),Jb.register(this).on("CONNECT_PEER",-1e3,function(){console.log("AppConfigService CONNECT_PEER",ek.peerIds),l.isOpen||(l.isOpen=!0),t.addPeerHistory(ek.peerId,ek.peerIds)}).on("DISCONNECT_PEER",-1e3,function(){console.log("AppConfigService DISCONNECT_PEER",ek.peerIds)});case 10:case"end":return e.stop()}},e,this)}))}},{key:"initAppConfig",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function t(){var n,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,console.log("YAML\u8aad\u307f\u8fbc\u307f..."),t.next=4,this.loadYaml();case 4:n=t.sent,i=qT(n),e.applyConfig(i),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(0),console.warn(t.t0);case 12:Jb.trigger("LOAD_CONFIG",e.appConfig);case 13:case"end":return t.stop()}},t,this,[[0,9]])}))}},{key:"loadYaml",value:function(){return new Promise(function(e,t){var n=document.querySelector('script[type$="yaml"]');if(!n)return console.warn("loadYaml element not found."),void e("");var i=n.textContent,r=n.getAttribute("src");if(null==r)return console.warn("loadYaml url undefined."),void e(i);var a=new XMLHttpRequest;a.open("get",r,!0),a.onerror=function(t){console.error(t),e(i)},a.onreadystatechange=function(t){4===a.readyState&&(200===a.status?(console.log("loadYaml success!"),i=a.responseText):console.warn("loadYaml fail...? status:"+a.status),e(i))},console.log("loadYaml start"),a.send(null)})}}],[{key:"applyConfig",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.appConfig;if(null==t)return n;var i,r=Object.getOwnPropertyNames(t),o=a(r);try{for(o.s();!(i=o.n()).done;){var s=i.value;(Array.isArray(t)||Array.isArray(n)?KT.concat($T):KT).includes(s)?console.log("skip invalid key (".concat(s,")")):null!=t[s]&&"object"==typeof t[s]?(null==n[s]&&(n[s]=Array.isArray(t[s])?[]:{}),e.applyConfig(t[s],n[s])):"function"!=typeof t[s]&&"function"!=typeof n[s]&&(n[s]=t[s])}}catch(l){o.e(l)}finally{o.f()}return n}}]),e}()).appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:""}},XT.\u0275fac=function(e){return new(e||XT)},XT.\u0275prov=Ae({token:XT,factory:XT.\u0275fac}),XT),JT=["idInput"],eO=["idSpacer"];function tO(e,t){if(1&e){var n=Qo();Zo(0,"div",9),es("click",function(){return Jt(n),is(2).changeIcon()}),hc(1,"safe"),Yo()}2&e&&ks("background-image",dc(1,2,"url("+is(2).myPeer.image.url+")","style"))}function nO(e,t){if(1&e){var n=Qo();Zo(0,"div"),Zo(1,"button",5),es("click",function(){return Jt(n),is().changeIcon()}),zs(2,"\u30a2\u30a4\u30b3\u30f3\u3092\u5909\u66f4\u3059\u308b"),Yo(),Uo(3,tO,2,5,"div",6),Zo(4,"span"),zs(5,"\u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),Zo(6,"input",7),es("ngModelChange",function(e){return Jt(n),is().myPeerColor=e}),Yo(),Zo(7,"input",8),es("ngModelChange",function(e){return Jt(n),is().myPeerName=e}),Yo(),qo(8,"br"),zs(9,"\u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3001"),qo(10,"br"),zs(11,"\u3000\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),Yo(),Yo()}if(2&e){var i=is();sa(3),Wo("ngIf",i.myPeer.image),sa(3),Wo("ngModel",i.myPeerColor),sa(1),ks("color",i.myPeerColor),Wo("ngModel",i.myPeerName)}}function iO(e,t){if(1&e){var n=Qo();Zo(0,"button",16),es("click",function(){return Jt(n),is(2).copyPeerId()}),Zo(1,"b",17),zs(2,"content_copy"),Yo(),Yo()}2&e&&Wo("disabled",is(2).isCopied)}function rO(e,t){if(1&e&&(Xo(0),Zo(1,"span",10),Zo(2,"span",11,12),zs(4),Yo(),qo(5,"input",13,14),Yo(),Uo(7,iO,3,1,"button",3),Zo(8,"span",15),zs(9),Yo(),Ko()),2&e){var n=is();sa(4),Ls(n.networkService.peerContext.userId),sa(1),ss("value",n.networkService.peerContext.userId),sa(2),Wo("ngIf",n.isAbleClipboardCopy),sa(1),ks("color",n.myPeerColor),Wo("@fadeInOut",n.isCopied),sa(1),Bs(" ",n.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function aO(e,t){1&e&&(Zo(0,"span",18),zs(1,"???"),Yo())}function oO(e,t){if(1&e&&(Zo(0,"span",18),zs(1),Yo()),2&e){var n=is(2);sa(1),js("",n.networkService.peerContext.roomName,"/",n.networkService.peerContext.roomId,"")}}function sO(e,t){if(1&e&&(Zo(0,"span",18),zs(1),Yo()),2&e){var n=is(2);sa(1),Ls(n.networkService.peerContext.password)}}function lO(e,t){if(1&e&&(Xo(0),qo(1,"hr"),Zo(2,"div"),Zo(3,"span"),zs(4,"\u30eb\u30fc\u30e0\u540d\uff1a"),Uo(5,oO,2,2,"span",1),Yo(),Yo(),Zo(6,"div"),Zo(7,"span"),zs(8,"\u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"),Uo(9,sO,2,1,"span",1),Yo(),Yo(),Ko()),2&e){var n=is();sa(5),Wo("ngIf",n.networkService.isOpen),sa(4),Wo("ngIf",n.networkService.isOpen)}}function cO(e,t){1&e&&(Zo(0,"span"),zs(1,"[\u63a5\u7d9a\u4e2d]"),Yo())}function uO(e,t){if(1&e&&(Zo(0,"div"),Zo(1,"div"),Uo(2,cO,2,0,"span",0),Zo(3,"span"),zs(4),Zo(5,"b"),zs(6),Yo(),zs(7,"]"),Yo(),Yo(),Yo()),2&e){var n=t.$implicit,i=is();sa(2),Wo("ngIf",!n.isOpen),sa(2),Bs("\u4ed6\u306e\u53c2\u52a0\u8005\uff1a",i.findUserId(n.peerId)," ["),sa(1),ks("color",i.findPeerColor(n.peerId)),sa(1),Ls(i.findPeerName(n.peerId))}}function hO(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"input",19),es("ngModelChange",function(e){return Jt(n),is().targetUserId=e}),Yo(),Zo(2,"button",16),es("click",function(){return Jt(n),is().connectPeer()}),zs(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),Yo(),qo(4,"br"),Ko()}if(2&e){var i=is();sa(1),Wo("ngModel",i.targetUserId),sa(1),Wo("disabled",!i.networkService.isOpen)}}function dO(e,t){if(1&e){var n=Qo();Zo(0,"button",16),es("click",function(){return Jt(n),is().showLobby()}),zs(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),Yo()}2&e&&Wo("disabled",!is().networkService.isOpen)}function fO(e,t){1&e&&(Zo(0,"div",4),zs(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),Yo())}function pO(e,t){1&e&&(Zo(0,"div",4),zs(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),Yo())}function gO(e,t){if(1&e&&(Xo(0),Uo(1,fO,2,0,"div",20),Uo(2,pO,2,0,"div",20),Ko()),2&e){var n=is();sa(1),Wo("ngIf",n.networkService.peerContexts.length<1),sa(1),Wo("ngIf",n.networkService.peerContexts.length<1)}}function mO(e,t){1&e&&(Xo(0),Zo(1,"div",4),zs(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),Yo(),Ko())}var vO,yO,bO=((yO=function(){function e(t,n,i,r){y(this,e),this.ngZone=t,this.modalService=n,this.panelService=i,this.appConfigService=r,this.targetUserId="",this.networkService=ek,this.gameRoomService=tk.instance,this.help="",this.isCopied=!1}return k(e,[{key:"myPeer",get:function(){return Rk.myCursor}},{key:"myPeerName",get:function(){return Rk.myCursor?Rk.myCursor.name:null},set:function(e){window.localStorage&&localStorage.setItem(Rk.CHAT_MY_NAME_LOCAL_STORAGE_KEY,e),Rk.myCursor&&(Rk.myCursor.name=e)}},{key:"myPeerColor",get:function(){return Rk.myCursor?Rk.myCursor.color:Rk.CHAT_DEFAULT_COLOR},set:function(e){Rk.myCursor&&(Rk.myCursor.color=e==Rk.CHAT_TRANSPARENT_COLOR?Rk.CHAT_DEFAULT_COLOR:e),window.localStorage&&localStorage.setItem(Rk.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Rk.myCursor.color)}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){e.panelService.title="\u63a5\u7d9a\u60c5\u5831",e.panelService.isAbleFullScreenButton=!1})}},{key:"ngAfterViewInit",value:function(){var e=this;Jb.register(this).on("OPEN_NETWORK",function(t){e.ngZone.run(function(){}),e.idInput&&e.idInput.nativeElement&&(e.idInput.nativeElement.style.width=e.idSpacer.nativeElement.getBoundingClientRect().width+"px")}),this.idInput&&this.idInput.nativeElement&&(this.idInput.nativeElement.style.width=this.idSpacer.nativeElement.getBoundingClientRect().width+"px")}},{key:"ngOnDestroy",value:function(){clearTimeout(this._timeOutId),Jb.unregister(this)}},{key:"changeIcon",value:function(){var e=this;this.modalService.open(Sx).then(function(t){e.myPeer&&t&&(e.myPeer.imageIdentifier=t)})}},{key:"resetPeerIfNeeded",value:function(){ek.peerContexts.length<1&&(ek.open(),Rk.myCursor.peerId=ek.peerId)}},{key:"connectPeer",value:function(){this.help="";var e=Jm.create(this.targetUserId);e.isRoom||(tk.instance.clearDeleteHistory(),ek.connect(e.peerId))}},{key:"connectPeerHistory",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,i,r,o,s,l,c,u,h,d,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.help="",t=[],n="",i=a(this.appConfigService.peerHistory);try{for(i.s();!(r=i.n()).done;)o=r.value,(s=Jm.parse(o)).isRoom?(n!==s.roomId&&(t=[]),n=s.roomId,t.push(s)):(n!==s.roomId&&(t=[]),t.push(s))}catch(g){i.e(g)}finally{i.f()}if(!n.length){e.next=17;break}return console.warn("connectPeerRoom <"+n+">"),l=[],e.next=9,ek.listAllPeers();case 9:c=e.sent,u=a(c);try{for(u.s();!(h=u.n()).done;)d=h.value,console.log(d),(f=Jm.parse(d)).roomId===n&&l.push(f)}catch(g){u.e(g)}finally{u.f()}if(!(l.length<1)){e.next=14;break}return e.abrupt("return",(this.help="\u524d\u56de\u63a5\u7d9a\u3057\u3066\u3044\u305f\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u65e2\u306b\u89e3\u6563\u3057\u3066\u3044\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002",void console.warn("Room is already closed...")));case 14:ek.open(Jm.generateId(),l[0].roomId,l[0].roomName,l[0].password),e.next=18;break;case 17:console.warn("connectPeers "+t.length),ek.open();case 18:Rk.myCursor.peerId=ek.peerId,(p=Jb.register(this)).on("OPEN_NETWORK",function(e){console.log("OPEN_NETWORK",e.data.peerId),Jb.unregisterListener(p),tk.instance.clearDeleteHistory();var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;ek.connect(r.peerId)}}catch(g){i.e(g)}finally{i.f()}});case 21:case"end":return e.stop()}},e,this)}))}},{key:"showLobby",value:function(){this.modalService.open(IS,{width:700,height:400,left:0,top:400})}},{key:"findUserId",value:function(e){var t=Rk.findByPeerId(e);return t?t.userId:""}},{key:"findPeerName",value:function(e){var t=Rk.findByPeerId(e);return t?t.name:""}},{key:"findPeerColor",value:function(e){var t=Rk.findByPeerId(e);return t?t.color:""}},{key:"copyPeerId",value:function(){var e=this;navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(function(){e.isCopied=!1},1e3))}},{key:"isAbleClipboardCopy",value:function(){return!!navigator.clipboard}}]),e}()).\u0275fac=function(e){return new(e||yO)(Vo($c),Vo(Zk),Vo(Wk),Vo(QT))},yO.\u0275cmp=ct({type:yO,selectors:[["peer-menu"]],viewQuery:function(e,t){var n;1&e&&(Sc(JT,1),Sc(eO,1)),2&e&&(Ec(n=Tc())&&(t.idInput=n.first),Ec(n=Tc())&&(t.idSpacer=n.first))},decls:18,vars:10,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"disabled","click",4,"ngIf"],[2,"font-size","12px"],[3,"click"],["class","image cover",3,"background-image","click",4,"ngIf"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[1,"image","cover",3,"click"],[2,"display","inline-block"],[1,"id-spacer"],["idSpacer",""],["type","text","readonly","",1,"id-input",3,"value"],["idInput",""],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","ngModelChange"],["style","font-size: 12px;",4,"ngIf"]],template:function(e,t){1&e&&(Uo(0,nO,12,5,"div",0),Zo(1,"div"),Zo(2,"span"),zs(3,"\u3042\u306a\u305f\u306eID\uff1a"),Zo(4,"span"),Uo(5,rO,10,7,"ng-container",0),Yo(),Uo(6,aO,2,0,"span",1),Yo(),Yo(),Uo(7,lO,10,2,"ng-container",0),qo(8,"hr"),Uo(9,uO,8,5,"div",2),Zo(10,"div"),Uo(11,hO,5,2,"ng-container",0),Uo(12,dO,2,1,"button",3),Yo(),Zo(13,"div"),Zo(14,"span",4),zs(15),Yo(),Yo(),Uo(16,gO,3,2,"ng-container",0),Uo(17,mO,3,0,"ng-container",0)),2&e&&(Wo("ngIf",t.myPeer),sa(5),Wo("ngIf",t.networkService.isOpen),sa(1),Wo("ngIf",!t.networkService.isOpen),sa(1),Wo("ngIf",t.networkService.peerContext.isRoom),sa(2),Wo("ngForOf",t.networkService.peerContexts),sa(2),Wo("ngIf",!t.networkService.peerContext.isRoom),sa(1),Wo("ngIf",t.networkService.peerIds.length<=1),sa(3),Ls(t.help),sa(1),Wo("ngIf",!t.networkService.peerContext.isRoom),sa(1),Wo("ngIf",t.networkService.peerContext.isRoom))},directives:[dh,uh,Ed,Xd,Ef],pipes:[Lw],styles:[".image[_ngcontent-%COMP%]{padding:0;width:128px;height:128px;display:table-cell;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:top;background-repeat:no-repeat;background-size:cover}.id-spacer[_ngcontent-%COMP%]{position:absolute;visibility:hidden;pointer-events:none;height:0;padding:0 3px;border-radius:3px;border:2px solid transparent}.id-input[_ngcontent-%COMP%], .id-spacer[_ngcontent-%COMP%]{box-sizing:border-box;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{width:100%;background:none;border-radius:2px;outline:none;color:#444;padding:2px;border-radius:3px;border:2px solid transparent}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0}"],data:{animation:[sp("fadeInOut",[fp("false => true",[lp("50ms ease-in-out",up({opacity:1})),lp("900ms ease-in-out",up({opacity:0}))])])]}}),yO),kO=((vO=function(){function e(){y(this,e),this.batchTask=new Map,this.batchTaskTimer=null}return k(e,[{key:"add",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.batchTask.set(n,e),null==this.batchTaskTimer&&(this.execBatch(),this.batchTaskTimer=setInterval(function(){0<t.batchTask.size?t.execBatch():(clearInterval(t.batchTaskTimer),t.batchTaskTimer=null)},66))}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.batchTask.delete(e)}},{key:"execBatch",value:function(){this.batchTask.forEach(function(e){return e()}),this.batchTask.clear()}}]),e}()).\u0275fac=function(e){return new(e||vO)},vO.\u0275prov=Ae({token:vO,factory:vO.\u0275fac,providedIn:"root"}),vO),_O=["textArea"];function wO(e,t){1&e&&(qo(0,"img",26),hc(1,"safe")),2&e&&Wo("src",dc(1,1,is(2).imageFile.url,"resourceUrl"),dr)}function xO(e,t){if(1&e&&(Zo(0,"div",24),Uo(1,wO,2,4,"img",25),Yo()),2&e){var n=is();sa(1),Wo("ngIf",0<n.imageFile.url.length)}}function CO(e,t){if(1&e&&(Zo(0,"div",24),qo(1,"img",26),hc(2,"safe"),Yo()),2&e){var n=is(2);sa(1),Wo("src",dc(2,1,null==n.character.faceIcon?null:n.character.faceIcon.url,"resourceUrl"),dr)}}var EO=function(e,t){return{inverse:e,hollow:t}},SO=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}},TO=function(e){return{"black-paint":e}};function OO(e,t){if(1&e&&(Zo(0,"div",29),Zo(1,"span",30),qo(2,"img",31),hc(3,"safe"),Yo(),Yo()),2&e){var n=is(3);Wo("ngClass",ac(7,EO,n.character.isInverse,n.character.isHollow)),sa(1),Wo("ngClass",lc(10,SO,0==n.character.aura,1==n.character.aura,2==n.character.aura,3==n.character.aura,4==n.character.aura,5==n.character.aura,6==n.character.aura,7==n.character.aura)),sa(1),Wo("src",dc(3,4,n.character.imageFile.url,"resourceUrl"),dr)("ngClass",rc(19,TO,n.character.isBlackPaint))}}function IO(e,t){if(1&e&&Uo(0,OO,4,21,"div",28),2&e){var n=is(2);Wo("ngIf",n.character&&null!=n.character.imageFile&&0<n.character.imageFile.url.length)}}function MO(e,t){if(1&e&&(Uo(0,CO,3,4,"div",2),Uo(1,IO,1,1,"ng-template",null,27,Ic)),2&e){var n=Ho(2),i=is();Wo("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",n)}}function AO(e,t){if(1&e&&(Zo(0,"option",32),zs(1),Yo()),2&e){var n=is();ks("color",n.myColor),ss("value",null==n.myPeer?null:n.myPeer.identifier),sa(1),Bs("",null==n.myPeer?null:n.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function PO(e,t){if(1&e&&(Zo(0,"option",33),zs(1),Yo()),2&e){var n=t.$implicit;ks("color",n.chatPalette&&n.chatPalette.color&&"#ffffff"!=n.chatPalette.color?n.chatPalette.color:"#444"),ss("value",n.identifier),sa(1),Ls(n.name)}}function DO(e,t){1&e&&(Xo(0),zs(1,"\uff08\u3042\u306a\u305f\uff09"),Ko())}function RO(e,t){if(1&e&&(Zo(0,"option",32),zs(1),Uo(2,DO,2,0,"ng-container",23),Yo()),2&e){var n=t.$implicit,i=is();ks("color",n.color),ss("value",n.identifier),sa(1),Bs("",n.name," "),sa(1),Wo("ngIf",n===i.myPeer)}}function FO(e,t){if(1&e&&(Zo(0,"option",36),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n.script),sa(1),Ls(n.game)}}var NO=function(){return{standalone:!0}},zO=function(e){return{"not-specified":e}};function LO(e,t){if(1&e){var n=Qo();Zo(0,"select",34),es("change",function(e){return Jt(n),is().loadDiceBot(e.target.value)})("ngModelChange",function(e){return Jt(n),is().gameType=e}),Zo(1,"option",13),zs(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),Yo(),Uo(3,FO,2,2,"option",35),Yo()}if(2&e){var i=is();Wo("ngModel",i.gameType)("ngModelOptions",ic(4,NO))("ngClass",rc(5,zO,""==i.gameType)),sa(3),Wo("ngForOf",i.diceBotInfos)}}function BO(e,t){if(1&e&&(Zo(0,"option",36),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n.script),sa(1),Ls(n.game)}}function jO(e,t){if(1&e&&(Zo(0,"optgroup",38),Uo(1,BO,2,2,"option",35),Yo()),2&e){var n=t.$implicit;ss("label",n.index),sa(1),Wo("ngForOf",n.infos)}}function UO(e,t){if(1&e){var n=Qo();Zo(0,"select",34),es("change",function(e){return Jt(n),is().loadDiceBot(e.target.value)})("ngModelChange",function(e){return Jt(n),is().gameType=e}),Zo(1,"option",13),zs(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),Yo(),Uo(3,jO,2,2,"optgroup",37),Yo()}if(2&e){var i=is();Wo("ngModel",i.gameType)("ngModelOptions",ic(4,NO))("ngClass",rc(5,zO,""==i.gameType)),sa(3),Wo("ngForOf",i.diceBotInfosIndexed)}}function HO(e,t){if(1&e&&(Zo(0,"option",36),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n),sa(1),Ls(n)}}var VO=function(e){return{"disabled-stand":e}};function WO(e,t){if(1&e){var n=Qo();Zo(0,"div",39),Zo(1,"label",5),Zo(2,"input",6),es("ngModelChange",function(e){return Jt(n),is().isUseStandImage=e})("change",function(){Jt(n);var e=is();return e.isUseStandImage=!!e.isUseStandImage}),Yo(),Zo(3,"b",7),zs(4,"Stand: "),Yo(),Yo(),Zo(5,"select",40),es("change",function(){return Jt(n),is().isUseStandImage=!0})("ngModelChange",function(e){return Jt(n),is().standName=e}),Zo(6,"option",13),zs(7,"\u672a\u9078\u629e"),Yo(),Uo(8,HO,2,2,"option",35),Yo(),Zo(9,"span",41),Zo(10,"b",7),zs(11,"Pos: "),Yo(),Zo(12,"input",42),es("change",function(){return Jt(n),is().isUseStandImage=!0})("ngModelChange",function(e){return Jt(n),is().character.standList.position=e}),Yo(),Zo(13,"input",43),es("change",function(){return Jt(n),is().isUseStandImage=!0})("ngModelChange",function(e){return Jt(n),is().character.standList.position=e}),Yo(),Zo(14,"b",7),zs(15,"\uff05"),Yo(),Yo(),Zo(16,"button",44),es("click",function(){return Jt(n),is().farewellStand()}),zs(17,"\u9000\u53bb"),Yo(),Yo()}if(2&e){var i=is();Wo("ngClass",rc(14,VO,!i.isUseStandImageOnChatTab)),sa(2),ss("checked",i.isUseStandImage?"checked":""),Wo("ngModel",i.isUseStandImage),Lo("disabled",i.isUseStandImageOnChatTab?null:""),sa(3),Wo("ngModel",i.standName)("ngModelOptions",ic(16,NO))("ngClass",rc(17,zO,""==i.standName)),Lo("disabled",i.isUseStandImageOnChatTab?null:""),sa(3),Wo("ngForOf",i.standNameList),sa(4),Wo("ngModel",i.character.standList.position),Lo("disabled",i.isUseStandImageOnChatTab?null:""),sa(1),Wo("ngModel",i.character.standList.position),Lo("disabled",i.isUseStandImageOnChatTab?null:""),sa(3),Lo("disabled",i.isUseStandImageOnChatTab?null:"")}}function GO(e,t){if(1&e){var n=Qo();Zo(0,"input",45),es("ngModelChange",function(e){return Jt(n),is().paletteColor=e}),Yo()}2&e&&Wo("ngModel",is().paletteColor)("ngModelOptions",ic(2,NO))}function ZO(e,t){1&e&&(Zo(0,"span"),zs(1,", "),Yo())}function YO(e,t){if(1&e&&(Zo(0,"span",47),zs(1),Uo(2,ZO,2,0,"span",23),Yo()),2&e){var n=t.$implicit,i=t.index,r=is(2);ks("color",n.color),sa(1),Ls(n.name),sa(1),Wo("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function qO(e,t){if(1&e&&(Xo(0),Uo(1,YO,3,4,"span",46),Zo(2,"span"),zs(3," \u304c\u5165\u529b\u4e2d..."),Yo(),Ko()),2&e){var n=is();sa(1),Wo("ngForOf",n.writingPeerNameAndColors)}}var XO,KO,$O,QO=function(e){return{"direct-message":e}},JO=function(e,t){return{color:e,"font-weight":t}},eI=((KO=function(){function e(t,n,i,r,a,o){y(this,e),this.ngZone=t,this.chatMessageService=n,this.batchService=i,this.panelService=r,this.pointerDeviceService=a,this.contextMenuService=o,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new fc,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new fc,this._sendTo="",this.sendToChange=new fc,this._text="",this.textChange=new fc,this.chat=new fc,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}return k(e,[{key:"isUseStandImageOnChatTab",get:function(){var e=tk.instance.get(this.chatTabidentifier);return e&&e.isUseStandImage}},{key:"gameType",get:function(){return this._gameType},set:function(e){this._gameType=e,this.gameTypeChange.emit(e)}},{key:"sendFrom",get:function(){return this._sendFrom},set:function(e){this._sendFrom=e,this.sendFromChange.emit(e)}},{key:"sendTo",get:function(){return this._sendTo},set:function(e){this._sendTo=e,this.sendToChange.emit(e)}},{key:"text",get:function(){return this._text},set:function(e){this._text=e,this.textChange.emit(e)}},{key:"isDirect",get:function(){return!(null==this.sendTo||!this.sendTo.length)}},{key:"character",get:function(){var e=tk.instance.get(this.sendFrom);return e instanceof jk?e:null}},{key:"hasStand",get:function(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}},{key:"standNameList",get:function(){if(!this.hasStand)return[];var e,t=[],n=a(this.character.standList.standElements);try{for(n.s();!(e=n.n()).done;){var i=e.value.getFirstElementByName("name");i&&i.value&&t.indexOf(i.value.toString())<0&&t.push(i.value.toString())}}catch(r){n.e(r)}finally{n.f()}return t.sort()}},{key:"standListNoGroup",get:function(){return[]}},{key:"standListWithGroup",get:function(){if(!this.hasStand)return[];var e={},t=this.character.standList.standElements.map(function(e){return e.getFirstElementByName("name")}).filter(function(e){return e});t.sort(function(e,t){return e.currentValue===t.currentValue?0:e.currentValue>t.currentValue?-1:1});var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;if(r&&r.value){var o=r.currentValue&&r.currentValue.toString().length>0?r.currentValue.toString():"";o&&(e[o]||(e[o]=[]),e[o].indexOf(r.value.toString())<0&&e[o].push(r.value.toString()))}}}catch(s){i.e(s)}finally{i.f()}return Object.keys(e).sort().map(function(t){return{name:t,stands:e[t].sort()}}).filter(function(e){return e.stands.length>0})}},{key:"imageFile",get:function(){var e=tk.instance.get(this.sendFrom),t=null;return e instanceof jk?t=e.imageFile:e instanceof Rk&&(t=e.image),t||Wm.Empty}},{key:"paletteColor",get:function(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:Rk.CHAT_TRANSPARENT_COLOR},set:function(e){this.character.chatPalette.color=e||Rk.CHAT_TRANSPARENT_COLOR}},{key:"myColor",get:function(){return Rk.myCursor&&Rk.myCursor.color&&Rk.myCursor.color!=Rk.CHAT_TRANSPARENT_COLOR?Rk.myCursor.color:Rk.CHAT_DEFAULT_COLOR}},{key:"color",get:function(){return this.paletteColor&&this.paletteColor!=Rk.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}},{key:"sendToColor",get:function(){var e=tk.instance.get(this.sendTo);return e instanceof Rk?e.color:Rk.CHAT_DEFAULT_COLOR}},{key:"gameCharacters",get:function(){var e=this;return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=tk.instance.getObjects(jk).filter(function(t){return e.allowsChat(t)})),this._gameCharacters}},{key:"diceBotInfos",get:function(){return Vk.diceBotInfos}},{key:"myPeer",get:function(){return Rk.myCursor}},{key:"otherPeers",get:function(){return tk.instance.getObjects(Rk)}},{key:"diceBotInfosIndexed",get:function(){return Vk.diceBotInfosIndexed}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("MESSAGE_ADDED",function(t){if(t.data.tabIdentifier===e.chatTabidentifier){var n=tk.instance.get(t.data.messageIdentifier),i=tk.instance.getObjects(Rk).find(function(e){return e.userId===n.from}),r=i?i.peerId:"?";e.writingPeers.has(r)&&(e.writingPeers.get(r).stop(),e.writingPeers.delete(r),e.updateWritingPeerNameAndColors())}}).on("UPDATE_GAME_OBJECT",-1e3,function(t){if(t.data.aliasName===jk.aliasName&&(e.shouldUpdateCharacterList=!0,t.data.identifier===e.sendFrom)){var n=tk.instance.get(t.data.identifier);n&&!e.allowsChat(n)&&(e.sendFrom=0<e.gameCharacters.length&&e.onlyCharacters?e.gameCharacters[0].identifier:e.myPeer.identifier)}}).on("DISCONNECT_PEER",function(t){var n=tk.instance.get(e.sendTo);n instanceof Rk&&n.peerId===t.data.peerId&&(e.sendTo="")}).on("WRITING_A_MESSAGE",function(t){t.isSendFromSelf||t.data!==e.chatTabidentifier||(e.writingPeers.has(t.sendFrom)||e.writingPeers.set(t.sendFrom,new nk(function(){e.writingPeers.delete(t.sendFrom),e.updateWritingPeerNameAndColors(),e.ngZone.run(function(){})},2e3)),e.writingPeers.get(t.sendFrom).reset(),e.updateWritingPeerNameAndColors(),e.batchService.add(function(){return e.ngZone.run(function(){})},e))})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this),this.batchService.remove(this)}},{key:"updateWritingPeerNameAndColors",value:function(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(function(e){var t=Rk.findByPeerId(e);return{name:t?t.name:"",color:t?t.color:Rk.CHAT_TRANSPARENT_COLOR}})}},{key:"onInput",value:function(){var e=this;if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){var t=null;if(this.isDirect){var n=tk.instance.get(this.sendTo);if(n instanceof Rk){var i=Jm.parse(n.peerId);i&&(t=i.peerId)}}Jb.call("WRITING_A_MESSAGE",this.chatTabidentifier,t),this.writingEventInterval=setTimeout(function(){e.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}},{key:"sendChat",value:function(e){if(e&&e.preventDefault(),!e||13===e.keyCode){this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);var t=this.text,n=null;if(this.character&&(gk.cr(t).trim()||this.standName)){if(t=this.character.chatPalette.evaluate(this.text,this.character.rootDataElement),this.character.standList){var i;i=this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:this.character.imageFile?this.character.imageFile.identifier:null;var r=this.character.standList.matchStandInfo(t,i,this.standName);if(r.farewell)this.farewellStand();else if(this.isUseStandImage&&this.isUseStandImageOnChatTab&&r.standElementIdentifier){n=r.standElementIdentifier;var a={characterIdentifier:this.character.identifier,standIdentifier:r.standElementIdentifier,color:this.character.chatPalette?this.character.chatPalette.color:Rk.CHAT_DEFAULT_COLOR,secret:!!this.sendTo};if(a.secret){var o=tk.instance.get(this.sendTo);o&&(o.peerId!=Rk.myCursor.peerId&&Jb.call("POPUP_STAND_IMAGE",a,o.peerId),Jb.call("POPUP_STAND_IMAGE",a,Rk.myCursor.peerId))}else Jb.call("POPUP_STAND_IMAGE",a)}r.matchMostLongText&&(t=t.slice(0,t.length-r.matchMostLongText.length))}var s,l=/\u300c([\s\S]+?)\u300d/gm,c=[];if(gk.isEmote(t))c.push(t);else for(;null!==(s=l.exec(t));)c.push(s[1]);if(c.length>0){var u={characterIdentifier:this.character.identifier,text:c.join("\n\n"),faceIconIdentifier:this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:null,color:this.color,secret:!!this.sendTo};if(u.secret){var h=tk.instance.get(this.sendTo);h&&(h.peerId!=Rk.myCursor.peerId&&Jb.call("POPUP_CHAT_BALLOON",u,h.peerId),Jb.call("POPUP_CHAT_BALLOON",u,Rk.myCursor.peerId))}else Jb.call("POPUP_CHAT_BALLOON",u)}else gk.cr(t).trim()&&this.character.text&&Jb.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.character.identifier})}gk.cr(t).trim()&&this.chat.emit({text:t,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo,color:this.color,isInverse:!!this.character&&this.character.isInverse,isHollow:!!this.character&&this.character.isHollow,isBlackPaint:!!this.character&&this.character.isBlackPaint,aura:this.character?this.character.aura:-1,isUseFaceIcon:this.isUseFaceIcon,characterIdentifier:this.character?this.character.identifier:null,standIdentifier:n,standName:this.standName,isUseStandImage:this.isUseStandImage&&this.isUseStandImageOnChatTab}),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight()}}},{key:"calcFitHeight",value:function(){var e=this.textAreaElementRef.nativeElement;e.style.height="",e.scrollHeight>=e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}},{key:"loadDiceBot",value:function(e){console.log("onChangeGameType ready"),Vk.getHelpMessage(e).then(function(e){console.log("onChangeGameType done\n"+e)})}},{key:"showDicebotHelp",value:function(){var e=this;Vk.getHelpMessage(this.gameType).then(function(t){e.gameHelp=t;var n,i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8",r=a(Vk.diceBotInfos);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.script===e.gameType&&(i="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+o.game+"\u3009")}}catch(c){r.e(c)}finally{r.f()}i+="\u4f7f\u7528\u6cd5";var s=e.pointerDeviceService.pointers[0],l=e.panelService.open(_w,{left:s.x,top:s.y,width:600,height:500});l.title=i,l.text=e.gameHelp})}},{key:"onContextMenu",value:function(e){var t=this;if(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu){var n=this.pointerDeviceService.pointers[0];if(this.character){var i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:function(){var e=t.textAreaElementRef.nativeElement,n=t.text.trim();"\u300c"!=n.slice(0,1)&&(n="\u300c"+n),"\u300d"!=n.slice(-1)&&(n+="\u300d"),t.text=n,e.value=t.text,e.selectionStart=t.text.length-1,e.selectionEnd=t.text.length-1,e.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(ww),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5909\u66f4",action:null,subActions:this.character.faceIcons.map(function(e,n){return{name:t.character.currntIconIndex==n?"\u25c9":"\u25cb",action:function(){t.character.currntIconIndex!=n&&(t.character.currntIconIndex=n)},default:t.character.currntIconIndex==n,icon:e}}),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(ww),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map(function(e,n){return{name:t.character.currntImageIndex==n?"\u25c9":"\u25cb",action:function(){t.character.currntImageIndex=n,Mw.play(Iw.surprise),Jb.trigger("UPDATE_INVENTORY",null)},default:t.character.currntImageIndex==n,icon:e}})})),i.push(ww),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:function(){t.character.isInverse=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:function(){t.character.isInverse=!0,Jb.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:function(){t.character.isHollow=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:function(){t.character.isHollow=!0,Jb.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:function(){t.character.isBlackPaint=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:function(){t.character.isBlackPaint=!0,Jb.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:function(){t.character.aura=-1,Jb.trigger("UPDATE_INVENTORY",null)}},ww].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map(function(e,n){return{name:"".concat(t.character.aura==n?"\u25c9":"\u25cb"," ").concat(e),action:function(){t.character.aura=n,Jb.trigger("UPDATE_INVENTORY",null)}}}))},ww,{name:"\u30ea\u30bb\u30c3\u30c8",action:function(){t.character.isInverse=!1,t.character.isHollow=!1,t.character.isBlackPaint=!1,t.character.aura=-1,Jb.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(ww),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:function(){t.showDetail(t.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:function(){t.showChatPalette(t.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:function(){t.showStandSetting(t.character)}})),this.contextMenuService.open(n,i,this.character.name)}else this.contextMenuService.open(n,[{name:"\u63a5\u7d9a\u60c5\u5831",action:function(){t.panelService.open(bO,{width:520,height:600,top:n.y-100,left:n.x-100})}}],Rk.myCursor.name,null,Rk.myCursor.color,!0)}}},{key:"farewellStand",value:function(){if(this.character){var e={characterIdentifier:this.character.identifier};if(this.sendTo){var t=tk.instance.get(this.sendTo);t&&(t.peerId!=Rk.myCursor.peerId&&Jb.call("FAREWELL_STAND_IMAGE",e,t.peerId),Jb.call("FAREWELL_STAND_IMAGE",e,Rk.myCursor.peerId))}else Jb.call("FAREWELL_STAND_IMAGE",e)}}},{key:"showDetail",value:function(e){var t=this.pointerDeviceService.pointers[0],n="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-400,top:t.y-300,width:800,height:600}).tabletopObject=e}},{key:"showChatPalette",value:function(e){var t=this.pointerDeviceService.pointers[0];this.panelService.open(sC,{left:t.x-250,top:t.y-175,width:620,height:350}).character=e}},{key:"showStandSetting",value:function(e){var t=this.pointerDeviceService.pointers[0];this.panelService.open(YC,{left:t.x-400,top:t.y-175,width:730,height:572}).character=e}},{key:"allowsChat",value:function(e){switch(e.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:var t,n=a(ek.peerContexts);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.isOpen&&e.location.name===i.peerId)return!1}}catch(r){n.e(r)}finally{n.f()}return!0}}}]),e}()).\u0275fac=function(e){return new(e||KO)(Vo($c),Vo(Yx),Vo(kO),Vo(Wk),Vo(DC),Vo(xw))},KO.\u0275cmp=ct({type:KO,selectors:[["chat-input"]],viewQuery:function(e,t){var n;1&e&&Sc(_O,3),2&e&&Ec(n=Tc())&&(t.textAreaElementRef=n.first)},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:36,vars:32,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","2px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"max-width","10em",3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller;",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image",3,"src",4,"ngIf"],[1,"image",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[2,"font-size","smaller",3,"ngClass"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","font-weight: bold;",3,"color",4,"ngFor","ngForOf"],[2,"font-weight","bold"]],template:function(e,t){if(1&e&&(Zo(0,"div",0),Zo(1,"div",1),es("contextmenu",function(e){return t.onContextMenu(e)}),Uo(2,xO,2,1,"div",2),Uo(3,MO,3,2,"ng-template",null,3,Ic),Yo(),Zo(5,"div",4),Zo(6,"div"),Zo(7,"label",5),Zo(8,"input",6),es("ngModelChange",function(e){return t.isUseFaceIcon=e})("change",function(){return t.isUseFaceIcon=!!t.isUseFaceIcon}),Yo(),Zo(9,"b",7),zs(10,"\u9854IC"),Yo(),Yo(),Zo(11,"select",8),es("ngModelChange",function(e){return t.sendFrom=e})("change",function(){return t.standName=""}),Uo(12,AO,2,4,"option",9),Uo(13,PO,2,4,"option",10),Yo(),Zo(14,"span",11),zs(15," \u27a1 "),Zo(16,"select",12),es("ngModelChange",function(e){return t.sendTo=e}),Zo(17,"option",13),zs(18,"\u5168\u54e1"),Yo(),Uo(19,RO,3,5,"option",14),Yo(),Yo(),Zo(20,"span",11),Uo(21,LO,4,7,"select",15),Uo(22,UO,4,7,"select",15),Zo(23,"button",16),es("click",function(){return t.showDicebotHelp()}),zs(24,"?"),Yo(),Yo(),Yo(),Uo(25,WO,18,19,"div",17),Zo(26,"div"),Zo(27,"form"),Uo(28,GO,1,3,"input",18),Zo(29,"textarea",19,20),es("ngModelChange",function(e){return t.text=e})("input",function(){return t.onInput()})("keydown.enter",function(e){return t.sendChat(e)}),Yo(),Zo(31,"button",21),es("click",function(){return t.sendChat(null)}),Zo(32,"b"),zs(33,"SEND"),Yo(),Yo(),Yo(),Yo(),Zo(34,"div",22),Uo(35,qO,4,1,"ng-container",23),Yo(),Yo(),Yo()),2&e){var n=Ho(4);Wo("ngClass",rc(21,QO,t.isDirect)),sa(2),Wo("ngIf",!t.character)("ngIfElse",n),sa(6),ss("checked",t.isUseFaceIcon?"checked":""),Wo("ngModel",t.isUseFaceIcon),sa(3),Wo("ngModel",t.sendFrom)("ngStyle",ac(23,JO,t.color,t.sendFrom!=(null==t.myPeer?null:t.myPeer.identifier)?"normal":"bolder")),sa(1),Wo("ngIf",!t.onlyCharacters),sa(1),Wo("ngForOf",t.gameCharacters),sa(3),Wo("ngModel",t.sendTo)("ngClass",rc(26,zO,""==t.sendTo))("ngStyle",ac(28,JO,""==t.sendTo?null:t.sendToColor,""==t.sendTo?"normal":"bolder")),sa(3),Wo("ngForOf",t.otherPeers),sa(2),Wo("ngIf",t.diceBotInfosIndexed.length<1),sa(1),Wo("ngIf",t.diceBotInfosIndexed.length>0),sa(3),Wo("ngIf",t.hasStand),sa(3),Wo("ngIf",t.onlyCharacters),sa(1),Wo("placeholder",t.onlyCharacters?"Enter\u3067\u9001\u4fe1\u3000Shift+Enter\u3067\u6539\u884c\u3000\u767d(255,255,255)\u306e\u5834\u5408\u3042\u306a\u305f\u306e\u8272":"Enter\u3067\u9001\u4fe1\u3000Shift+Enter\u3067\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",t.text)("ngModelOptions",ic(31,NO)),sa(6),Wo("ngIf",0<t.writingPeerNameAndColors.length)}},directives:[lh,dh,wd,Xd,Ef,Bf,Sh,uh,jf,$f,Sf,Kd,wf,Ed,Rf,Of],pipes:[Lw],styles:[".table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:Arial;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:grey}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:grey}"]}),KO),tI=((XO=function(){function e(){var t=this;y(this,e),this.tableInventory=new nI(function(e){return"table"===e.location.name}),this.commonInventory=new nI(function(e){return!t.isAnyLocation(e.location.name)}),this.privateInventory=new nI(function(e){return e.location.name===ek.peerId}),this.graveyardInventory=new nI(function(e){return"graveyard"===e.location.name}),this.indicateAll=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=Nk.create(this.newLineString),this.initialize()}return k(e,[{key:"summarySetting",get:function(){return XC.instance}},{key:"sortTag",get:function(){return this.summarySetting.sortTag},set:function(e){this.summarySetting.sortTag=e}},{key:"sortOrder",get:function(){return this.summarySetting.sortOrder},set:function(e){this.summarySetting.sortOrder=e}},{key:"dataTag",get:function(){return this.summarySetting.dataTag},set:function(e){this.summarySetting.dataTag=e}},{key:"dataTags",get:function(){return this.summarySetting.dataTags}},{key:"initialize",value:function(){var e=this;Jb.register(this).on("OPEN_NETWORK",function(t){e.refresh()}).on("CONNECT_PEER",function(t){e.refresh()}).on("DISCONNECT_PEER",function(t){e.refresh()}).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);if(n)if(n instanceof jk){var i=e.locationMap.get(n.identifier);n.location.name!==i&&(e.locationMap.set(n.identifier,n.location.name),e.refresh())}else if(n instanceof Nk){if(!e.containsInGameCharacter(n))return;var r=e.tagNameMap.get(n.identifier);(e.dataTags.includes(r)||e.dataTags.includes(n.name))&&n.name!==r&&(e.tagNameMap.set(n.identifier,n.name),e.refreshDataElements()),e.sortTag===n.name&&e.refreshSort(),0<n.children.length&&(e.refreshDataElements(),e.refreshSort()),e.callInventoryUpdate()}else n instanceof XC&&(e.refreshDataElements(),e.refreshSort(),e.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",1e3,function(t){e.locationMap.delete(t.data.identifier),e.tagNameMap.delete(t.data.identifier),e.refresh()}).on("SYNCHRONIZE_FILE_LIST",function(t){t.isSendFromSelf&&e.callInventoryUpdate()})}},{key:"containsInGameCharacter",value:function(e){for(var t=e.parent,n=jk.aliasName;t;){if(t.aliasName===n)return!0;t=t.parent}return!1}},{key:"refresh",value:function(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}},{key:"refreshObjects",value:function(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}},{key:"refreshDataElements",value:function(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}},{key:"refreshSort",value:function(){this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort()}},{key:"callInventoryUpdate",value:function(){Jb.trigger("UPDATE_INVENTORY",null)}},{key:"isAnyLocation",value:function(e){if("table"===e||e===ek.peerId||"graveyard"===e)return!0;var t,n=a(ek.peerContexts);try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i.isOpen&&e===i.peerId)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}}]),e}()).\u0275fac=function(e){return new(e||XO)},XO.\u0275prov=Ae({token:XO,factory:XO.\u0275fac,providedIn:"root"}),XO),nI=function(){function e(t){y(this,e),this.classifier=t,this.newLineString="/",this.newLineDataElement=Nk.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}return k(e,[{key:"summarySetting",get:function(){return XC.instance}},{key:"sortTag",get:function(){return this.summarySetting.sortTag},set:function(e){this.summarySetting.sortTag=e}},{key:"sortOrder",get:function(){return this.summarySetting.sortOrder},set:function(e){this.summarySetting.sortOrder=e}},{key:"dataTag",get:function(){return this.summarySetting.dataTag},set:function(e){this.summarySetting.dataTag=e}},{key:"dataTags",get:function(){return this.summarySetting.dataTags}},{key:"tabletopObjects",get:function(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}},{key:"length",get:function(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}},{key:"dataElementMap",get:function(){var e=this;if(this.needsRefreshElements){this._dataElementMap.clear();var t,n=a(this.tabletopObjects);try{var i=function(){var n=t.value;if(!n.rootDataElement)return"continue";var i=e.dataTags.map(function(t){return t===e.newLineString?e.newLineDataElement:n.rootDataElement.getFirstElementByName(t)});e._dataElementMap.set(n.identifier,i)};for(n.s();!(t=n.n()).done;)i()}catch(r){n.e(r)}finally{n.f()}this.needsRefreshElements=!1}return this._dataElementMap}},{key:"refreshObjects",value:function(){this.needsRefreshObjects=!0}},{key:"refreshDataElements",value:function(){this.needsRefreshElements=!0}},{key:"refreshSort",value:function(){this.needsSort=!0}},{key:"searchTabletopObjects",value:function(){var e,t=[],n=a(tk.instance.getObjects(jk));try{for(n.s();!(e=n.n()).done;){var i=e.value;this.classifier(i)&&t.push(i)}}catch(r){n.e(r)}finally{n.f()}return t}},{key:"sortTabletopObjects",value:function(e){var t=this,n=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return n.length<1||e.sort(function(e,r){var a=e.rootDataElement.getFirstElementByName(n),o=r.rootDataElement.getFirstElementByName(n);if(!a&&!o)return 0;if(!o)return-1;if(!a)return 1;var s=t.convertToSortableValue(a),l=t.convertToSortableValue(o);return s<l?i:s>l?-1*i:0}),e}},{key:"convertToSortableValue",value:function(e){var t=gk.toHalfWidth(((e.isNumberResource?e.currentValue:e.value)+"").trim()),n=+t;return Number.isNaN(n)?t:n}}]),e}();!function(e){function t(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e=parseFloat(e),isNaN(e)?t:e}e.relation=function(e,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return"number"==typeof e?e:"string"==typeof e?(e=e.trim().toLowerCase()).indexOf("%")>0?t(e.replace("%",""),i)/100*n:e.indexOf("px")>0||e.indexOf("pt")>0?t(e.replace("px",""),i):e.indexOf("vw")>0?t(e.replace("vw",""),i)/100*window.innerWidth:e.indexOf("vh")>0?t(e.replace("vh",""),i)/100*window.innerHeight:e.indexOf("vm")>0?t(e.replace("vm",""),i)/100*Math.min(window.innerWidth,window.innerHeight):e.indexOf("em")>0?t(e.replace("em",""),i):"top"===e||"left"===e?0:"center"===e||"middle"===e?.5*n:"bottom"===e||"right"===e?n:i:i},e.parse=t}($O||($O={}));var iI,rI,aI,oI,sI,lI=((iI=function(){function e(){y(this,e),this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}return k(e,[{key:"setData",value:function(e){if(null!=e){var t=e.length;return 16==t?(this.m11=e[0],this.m12=e[1],this.m13=e[2],this.m14=e[3],this.m21=e[4],this.m22=e[5],this.m23=e[6],this.m24=e[7],this.m31=e[8],this.m32=e[9],this.m33=e[10],this.m34=e[11],this.m41=e[12],this.m42=e[13],this.m43=e[14],this.m44=e[15]):6==t?(this.m11=e[0],this.m12=e[1],this.m13=0,this.m14=0,this.m21=e[2],this.m22=e[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=e[4],this.m42=e[5],this.m43=0,this.m44=1):9==t&&(this.m11=e[0],this.m12=e[1],this.m13=0,this.m14=e[2],this.m21=e[3],this.m22=e[4],this.m23=0,this.m24=e[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=e[6],this.m42=e[7],this.m43=0,this.m44=e[8]),this}}},{key:"identity",value:function(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}},{key:"scalar",value:function(e){return this.m11*=e,this.m12*=e,this.m13*=e,this.m14*=e,this.m21*=e,this.m22*=e,this.m23*=e,this.m24*=e,this.m31*=e,this.m32*=e,this.m33*=e,this.m34*=e,this.m41*=e,this.m42*=e,this.m43*=e,this.m44*=e,this}},{key:"unproject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0,w:1},n=e.x*this.m11+e.y*this.m21+this.m41,i=e.x*this.m12+e.y*this.m22+this.m42,r=e.x*this.m13+e.y*this.m23+this.m43,a=e.x*this.m14+e.y*this.m24+this.m44,o=n+this.m31,s=i+this.m32,l=r+this.m33,c=a+this.m34;0==a&&(a=1e-4),n/=a,i/=a,0==c&&(c=1e-4),o/=c,s/=c;var u=(l/=c)-(r/=a);if(0==u)return t.x=n,t.y=i,t.z=r,t.w=r,t;var h=-r/u;return n+=h*(o-n),i+=h*(s-i),t.x=n,t.y=i,t.z=r,t.w=r,t}},{key:"project",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:0,y:0,z:0,w:1},n=e.z,i=e.x*this.m14+e.y*this.m24+n*this.m34+this.m44,r=e.x*this.m11+e.y*this.m21+n*this.m31+this.m41,a=e.x*this.m12+e.y*this.m22+n*this.m32+this.m42;return 0==i&&(i=1e-4),r/=i,a/=i,i<0&&(r-=this.m41,a-=this.m42,r*=1/i,a*=1/i,r+=this.m41,a+=this.m42),t.x=r,t.y=a,t.z=n,t.w=n,t}},{key:"append",value:function(t){return e.multiply(this,t,this)}},{key:"setPosition",value:function(e){return this.m41=e.x,this.m42=e.y,this.m43=e.z,this}},{key:"getPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0,w:1};return e.x=this.m41,e.y=this.m42,e.z=this.m43,e}},{key:"appendPosition",value:function(){var t;return t=1===arguments.length?arguments.length<=0?void 0:arguments[0]:{x:arguments.length<=0?void 0:arguments[0],y:arguments.length<=1?void 0:arguments[1],z:arguments.length<=2?void 0:arguments[2],w:1},this.append(e.makePosition(t,e.MATRIX3D))}},{key:"appendPerspective",value:function(t){return t?this.append(e.makePerspective(t,e.MATRIX3D)):this}},{key:"invert",value:function(e){e=e||this;var t=[],n=this.m11,i=this.m12,r=this.m13,a=this.m14,o=this.m21,s=this.m22,l=this.m23,c=this.m24,u=this.m31,h=this.m32,d=this.m33,f=this.m34,p=this.m41,g=this.m42,m=this.m43,v=this.m44;t[0]=l*f*g-c*d*g+c*h*m-s*f*m-l*h*v+s*d*v,t[1]=a*d*g-r*f*g-a*h*m+i*f*m+r*h*v-i*d*v,t[2]=r*c*g-a*l*g+a*s*m-i*c*m-r*s*v+i*l*v,t[3]=a*l*h-r*c*h-a*s*d+i*c*d+r*s*f-i*l*f;var y=n*t[0]+o*t[1]+u*t[2]+p*t[3];return 0==y?(console.warn("Can not invert matrix, determinant is 0"),this):(t[4]=c*d*p-l*f*p-c*u*m+o*f*m+l*u*v-o*d*v,t[5]=r*f*p-a*d*p+a*u*m-n*f*m-r*u*v+n*d*v,t[6]=a*l*p-r*c*p-a*o*m+n*c*m+r*o*v-n*l*v,t[7]=r*c*u-a*l*u+a*o*d-n*c*d-r*o*f+n*l*f,t[8]=s*f*p-c*h*p+c*u*g-o*f*g-s*u*v+o*h*v,t[9]=a*h*p-i*f*p-a*u*g+n*f*g+i*u*v-n*h*v,t[10]=i*c*p-a*s*p+a*o*g-n*c*g-i*o*v+n*s*v,t[11]=a*s*u-i*c*u-a*o*h+n*c*h+i*o*f-n*s*f,t[12]=l*h*p-s*d*p-l*u*g+o*d*g+s*u*m-o*h*m,t[13]=i*d*p-r*h*p+r*u*g-n*d*g-i*u*m+n*h*m,t[14]=r*s*p-i*l*p-r*o*g+n*l*g+i*o*m-n*s*m,t[15]=i*l*u-r*s*u+r*o*h-n*l*h-i*o*d+n*s*d,e.setData(t),e.scalar(1/y),e)}},{key:"setCSS",value:function(e){if(!e||"none"==e)return this.identity();for(var t=e.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),n=t.length,i=0;i<n;++i)t[i]=$O.parse(t[i]);return this.setData(t)}},{key:"appendCSS",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t&&"none"!=t?n&&t.indexOf("matrix3d")>=0?this.append(e.MATRIX3D.setCSS(t).flatten()):this.append(e.MATRIX3D.setCSS(t)):this}},{key:"flatten",value:function(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return"m11="+this.m11.toFixed(e)+"\tm21="+this.m21.toFixed(e)+"\tm31="+this.m31.toFixed(e)+"\tm41="+this.m41.toFixed(e)+"\nm12="+this.m12.toFixed(e)+"\tm22="+this.m22.toFixed(e)+"\tm32="+this.m32.toFixed(e)+"\tm42="+this.m42.toFixed(e)+"\nm13="+this.m13.toFixed(e)+"\tm23="+this.m23.toFixed(e)+"\tm33="+this.m33.toFixed(e)+"\tm43="+this.m43.toFixed(e)+"\nm14="+this.m14.toFixed(e)+"\tm24="+this.m24.toFixed(e)+"\tm34="+this.m34.toFixed(e)+"\tm44="+this.m44.toFixed(e)}}],[{key:"create",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e;return t&&t.ownerDocument?i.setCSS((n||window.getComputedStyle(t)).transform):i.identity()}},{key:"makePosition",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return n.identity(),n.setPosition(t),n}},{key:"makePerspective",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new e;return n.identity(),n.m34=t?-1/t:0,n}},{key:"multiply",value:function(t,n){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new e,r=t.m11*n.m12+t.m12*n.m22+t.m13*n.m32+t.m14*n.m42,a=t.m11*n.m13+t.m12*n.m23+t.m13*n.m33+t.m14*n.m43,o=t.m11*n.m14+t.m12*n.m24+t.m13*n.m34+t.m14*n.m44,s=t.m21*n.m11+t.m22*n.m21+t.m23*n.m31+t.m24*n.m41,l=t.m21*n.m12+t.m22*n.m22+t.m23*n.m32+t.m24*n.m42,c=t.m21*n.m13+t.m22*n.m23+t.m23*n.m33+t.m24*n.m43,u=t.m21*n.m14+t.m22*n.m24+t.m23*n.m34+t.m24*n.m44,h=t.m31*n.m11+t.m32*n.m21+t.m33*n.m31+t.m34*n.m41,d=t.m31*n.m12+t.m32*n.m22+t.m33*n.m32+t.m34*n.m42,f=t.m31*n.m13+t.m32*n.m23+t.m33*n.m33+t.m34*n.m43,p=t.m31*n.m14+t.m32*n.m24+t.m33*n.m34+t.m34*n.m44,g=t.m41*n.m11+t.m42*n.m21+t.m43*n.m31+t.m44*n.m41,m=t.m41*n.m12+t.m42*n.m22+t.m43*n.m32+t.m44*n.m42,v=t.m41*n.m13+t.m42*n.m23+t.m43*n.m33+t.m44*n.m43,y=t.m41*n.m14+t.m42*n.m24+t.m43*n.m34+t.m44*n.m44;return i.m11=t.m11*n.m11+t.m12*n.m21+t.m13*n.m31+t.m14*n.m41,i.m12=r,i.m13=a,i.m14=o,i.m21=s,i.m22=l,i.m23=c,i.m24=u,i.m31=h,i.m32=d,i.m33=f,i.m34=p,i.m41=g,i.m42=m,i.m43=v,i.m44=y,i}}]),e}()).MATRIX3D=new iI,iI),cI=function(){function e(t){y(this,e),this.matrix=new lI,this.sceneTransform=new lI,this.inverseSceneTransform=new lI,this.initialize(t)}return k(e,[{key:"clear",value:function(){return this.element=null,this.matrix.identity(),this}},{key:"initialize",value:function(e){if(e){this.element=e;var t=window.getComputedStyle(e),n=0,i=0;return this.element.parentElement?(n=this.element.parentElement.clientWidth,i=this.element.parentElement.clientHeight):(n=window.innerWidth,i=window.innerHeight),this.paddingLeft=$O.relation(t.paddingTop,n),this.paddingTop=$O.relation(t.paddingTop,i),this.marginLeft=$O.relation(t.marginLeft,n),this.marginTop=$O.relation(t.marginTop,i),this.borderLeft=$O.relation(t.borderLeft,n),this.borderTop=$O.relation(t.borderTop,i),this.matrix.setCSS(t.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}}},{key:"globalToLocal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i={x:e,y:t,z:n,w:1};return this.inverseSceneTransform.unproject(i,i),this.fromBorderBox(i),i}},{key:"localToGlobal",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i={x:e,y:t,z:n,w:1};return this.sceneTransform.project(i,i),this.fromBorderBox(i),i}},{key:"localToLocal",value:function(t,n,i,r){var a=t,o=n,s=i,l=new e(r),c=lI.multiply(this.sceneTransform,l.inverseSceneTransform),u={x:0,y:0,z:0,w:1};return u.x=a*c.m11+o*c.m21+s*c.m31+1*c.m41,u.y=a*c.m12+o*c.m22+s*c.m32+1*c.m42,u.z=a*c.m13+o*c.m23+s*c.m33+1*c.m43,u.w=a*c.m14+o*c.m24+s*c.m34+1*c.m44,l.clear(),this.toBorderBox(u),u}},{key:"extract",value:function(e,t){for(var n=e.element;n;)this.extractMatrix(n,t),n&&"fixed"===n.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),t.appendPosition(window.pageXOffset,window.pageYOffset,0)),n=n.parentElement}},{key:"extractMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t||(t=new lI),!e)return t;var n=e,i=window.getComputedStyle(e);if("none"!=i.transform){var r=i.transformOrigin?i.transformOrigin.split(" "):[],a=$O.relation(r[0],n.offsetWidth,.5*n.offsetWidth),o=$O.relation(r[1],n.offsetHeight,.5*n.offsetHeight),s=$O.relation(r[2],0,0);t.appendPosition(-a,-o,-s),t.appendCSS(i.transform),t.appendPosition(a,o,s)}var l=this.getPosition(e);t.appendPosition(l.x,l.y,0);var c=0;if(e.parentElement){var u=window.getComputedStyle(e.parentElement);c=$O.parse(u.perspective)}if(e.parentElement&&c){var h=window.getComputedStyle(e.parentElement).perspectiveOrigin.split(" "),d=$O.relation(h[0],n.parentElement.offsetWidth),f=$O.relation(h[1],n.parentElement.offsetHeight);t.appendPosition(-d,-f,0),t.appendPerspective(c),t.appendPosition(d,f,0)}return t}},{key:"getPosition",value:function(e){var t={x:0,y:0};return t.x=e.offsetParent?e.parentElement===e.offsetParent?e.offsetLeft:e.parentElement.offsetParent===e.offsetParent?e.offsetLeft-e.parentElement.offsetLeft:0:e.offsetLeft,t.y=e.offsetParent?e.parentElement===e.offsetParent?e.offsetTop:e.parentElement.offsetParent===e.offsetParent?e.offsetTop-e.parentElement.offsetTop:0:e.offsetTop,t.x+=e.offsetParent?e.offsetParent.clientLeft:0,t.y+=e.offsetParent?e.offsetParent.clientTop:0,t}},{key:"fromBorderBox",value:function(e){e.x+=this.paddingLeft,e.y+=this.paddingTop,e.x+=this.marginLeft,e.y+=this.marginTop,e.x-=this.borderLeft,e.y-=this.borderTop}},{key:"toBorderBox",value:function(e){e.x-=this.paddingLeft,e.y-=this.paddingTop,e.x-=this.marginLeft,e.y-=this.marginTop,e.x+=this.borderLeft,e.y+=this.borderTop}}]),e}(),uI=((aI=function(){function e(t){y(this,e),this.pointerDeviceService=t,this.tabletopOriginElement=document.body}return k(e,[{key:"convertToLocal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,n=new cI(t),i=n.globalToLocal(e.x,e.y,e.z?e.z:0);return n.clear(),{x:i.x,y:i.y,z:i.z}}},{key:"convertToGlobal",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body,n=new cI(t),i=n.localToGlobal(e.x,e.y,e.z?e.z:0);return n.clear(),{x:i.x,y:i.y,z:i.z}}},{key:"convertLocalToLocal",value:function(e,t,n){var i=new cI(t),r=i.globalToLocal(e.x,e.y,e.z?e.z:0),a=i.localToLocal(r.x,r.y,0,n);return i.clear(),{x:a.x,y:a.y,z:a.z}}},{key:"calcTabletopLocalCoordinate",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.pointerDeviceService.targetElement;return t.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,t,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}]),e}()).\u0275fac=function(e){return new(e||aI)(wi(DC))},aI.\u0275prov=Ae({token:aI,factory:aI.\u0275fac,providedIn:"root"}),aI),hI=((rI=function(){function e(t){var n=this;y(this,e),this.coordinateService=t,this._emptyTable=new tE(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new dI(function(){return tk.instance.getObjects(jk).filter(function(e){return e.isVisibleOnTable})}),this.cardCache=new dI(function(){return tk.instance.getObjects(jx).filter(function(e){return e.isVisibleOnTable})}),this.cardStackCache=new dI(function(){return tk.instance.getObjects(Ux).filter(function(e){return e.isVisibleOnTable})}),this.tableMaskCache=new dI(function(){var e=n.tableSelecter.viewTable;return e?e.masks:[]}),this.terrainCache=new dI(function(){var e=n.tableSelecter.viewTable;return e?e.terrains:[]}),this.textNoteCache=new dI(function(){return tk.instance.getObjects(nE)}),this.diceSymbolCache=new dI(function(){return tk.instance.getObjects(Vx)}),this.initialize()}return k(e,[{key:"tableSelecter",get:function(){return tk.instance.get("tableSelecter")}},{key:"currentTable",get:function(){return this.tableSelecter.viewTable||this._emptyTable}},{key:"characters",get:function(){return this.characterCache.objects}},{key:"cards",get:function(){return this.cardCache.objects}},{key:"cardStacks",get:function(){return this.cardStackCache.objects}},{key:"tableMasks",get:function(){return this.tableMaskCache.objects}},{key:"terrains",get:function(){return this.terrainCache.objects}},{key:"textNotes",get:function(){return this.textNoteCache.objects}},{key:"diceSymbols",get:function(){return this.diceSymbolCache.objects}},{key:"peerCursors",get:function(){return tk.instance.getObjects(Rk)}},{key:"initialize",value:function(){var e=this;this.refreshCacheAll(),Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){if(t.data.identifier===e.currentTable.identifier||t.data.identifier===e.tableSelecter.identifier)return e.refreshCache(KC.aliasName),void e.refreshCache(QC.aliasName);var n=tk.instance.get(t.data.identifier);n&&n instanceof zk?e.shouldRefreshCache(n)&&(e.refreshCache(t.data.aliasName),e.updateMap(n)):e.refreshCache(t.data.aliasName)}).on("DELETE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);null==n||n.aliasName.length<1?e.refreshCacheAll():e.refreshCache(n.aliasName)}).on("XML_LOADED",function(t){var n=lk.instance.parseXml(t.data.xmlElement);if(n instanceof zk){var i=e.coordinateService.calcTabletopLocalCoordinate();n.location.x=i.x-25,n.location.y=i.y-25,n.posZ=i.z,e.placeToTabletop(n),Mw.play(Iw.piecePut)}else n instanceof Gx?Zx.instance.addChatTab(n):n instanceof Uk&&Hk.instance.addDiceRollTable(n)})}},{key:"findCache",value:function(e){switch(e){case jk.aliasName:return this.characterCache;case jx.aliasName:return this.cardCache;case Ux.aliasName:return this.cardStackCache;case KC.aliasName:return this.tableMaskCache;case QC.aliasName:return this.terrainCache;case nE.aliasName:return this.textNoteCache;case Vx.aliasName:return this.diceSymbolCache;default:return null}}},{key:"refreshCache",value:function(e){var t=this.findCache(e);t&&t.refresh()}},{key:"refreshCacheAll",value:function(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}},{key:"shouldRefreshCache",value:function(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}},{key:"updateMap",value:function(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}},{key:"clearMap",value:function(){this.locationMap.clear(),this.parentMap.clear()}},{key:"placeToTabletop",value:function(e){switch(e.aliasName){case KC.aliasName:e instanceof KC&&(e.isLock=!1);case QC.aliasName:if(e instanceof QC&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}]),e}()).\u0275fac=function(e){return new(e||rI)(wi(uI))},rI.\u0275prov=Ae({token:rI,factory:rI.\u0275fac}),rI),dI=function(){function e(t){y(this,e),this.refreshCollector=t,this.needsRefresh=!0,this._objects=[]}return k(e,[{key:"objects",get:function(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}},{key:"refresh",value:function(){this.needsRefresh=!0}}]),e}(),fI=function(){function e(t,n,i){y(this,e),this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=t,this.sendTo=n,this.data=i}return k(e,[{key:"start",value:function(e){this.onstart?(this.data=e,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}},{key:"progress",value:function(e,t){this.onprogress&&this.onprogress(this,e,t)}},{key:"finish",value:function(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}},{key:"timeout",value:function(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}},{key:"cancel",value:function(){this.isCanceled||(null!=this.sendTo&&Jb.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}},{key:"_cancel",value:function(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}},{key:"dispose",value:function(){Jb.unregister(this),this.sendChankTimer&&Zm.delete(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}},{key:"initializeSend",value:function(){var e=this;this.uint8Array=nv.encode(this.data);var t=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(t),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Jb.register(this).on("FILE_MORE_CHANK_"+this.identifier,function(t){e.sendTo===t.sendFrom&&(e.completedChankIndex=t.data,null==e.sendChankTimer&&(e.resetTimeout(),e.sendChank(e.sentChankIndex+1)))}).on("DISCONNECT_PEER",function(t){t.data.peerId===e.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",e,t.data.peerId),e._cancel())}).on("CANCEL_TASK_"+this.identifier,function(t){console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",e,t.sendFrom),e._cancel()}),this.sentChankIndex=this.completedChankIndex=0,qm(function(){return e.sendChank(0)})}},{key:"sendChank",value:function(e){var t=this,n=this.uint8Array.slice(e*this.chankSize,(e+1)*this.chankSize);Jb.call("FILE_SEND_CHANK_"+this.identifier,{index:e,length:this.chanks.length,chank:n},this.sendTo),this.sentChankIndex=e,this.sendChankTimer=null,this.chanks.length<=e+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),qm(function(){return t.finish()})):this.completedChankIndex+4<=e?this.resetTimeout():this.sendChankTimer=qm(function(){t.sendChank(t.sentChankIndex+1)})}},{key:"initializeReceive",value:function(){var e=this;this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Jb.register(this).on("FILE_SEND_CHANK_"+this.identifier,function(t){e.chanks.length<1&&(e.chanks=new Array(t.data.length)),null==e.chanks[t.data.index]?(e.chankReceiveCount++,e.chanks[t.data.index]=t.data.chank,e.progress(t.data.index,t.data.length),e.chanks.length<=e.chankReceiveCount?e.finishReceive():(e.resetTimeout(),Jb.call("FILE_MORE_CHANK_"+e.identifier,t.data.index,t.sendFrom))):console.log("already received. [".concat(t.data.index,"] <").concat(e.identifier,">"))}).on("DISCONNECT_PEER",function(t){t.data.peerId===e.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",e,t.data.peerId),e._cancel())}).on("CANCEL_TASK_"+this.identifier,function(t){console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",e,t.sendFrom),e._cancel()})}},{key:"finishReceive",value:function(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);var e,t=0,n=a(this.chanks);try{for(n.s();!(e=n.n()).done;){t+=e.value.byteLength}}catch(h){n.e(h)}finally{n.f()}var i=performance.now()-this.startTime,r=t/1024/1024/(i/1e3);console.log("".concat((t/1024).toFixed(2),"KB ").concat((i/1e3).toFixed(2),"\u79d2 \u8ee2\u9001\u901f\u5ea6: ").concat(r.toFixed(2),"MB/s"));var o,s=new Uint8Array(t),l=0,c=a(this.chanks);try{for(c.s();!(o=c.n()).done;){var u=o.value;s.set(u,l),l+=u.byteLength}}catch(h){c.e(h)}finally{c.f()}this.data=nv.decode(s),this.finish()}},{key:"resetTimeout",value:function(){var e=this;null==this.timeoutTimer&&(this.timeoutTimer=new nk(function(){return e.timeout()},3e4)),this.timeoutTimer.reset()}}],[{key:"createSendTask",value:function(t,n,i){var r=new e(t,n,i);return r.onstart=function(){return r.initializeSend()},r}},{key:"createReceiveTask",value:function(t){var n=new e(t);return n.onstart=function(){return n.initializeReceive()},n}}]),e}(),pI=function(){function e(){y(this,e),this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}return k(e,[{key:"initialize",value:function(){var e=this;console.log("AudioSharingSystem ready..."),this.destroy(),Jb.register(this).on("CONNECT_PEER",-1,function(e){e.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",e.data.peerId),Ow.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",function(t){if(!t.isSendFromSelf){console.log("SYNCHRONIZE_AUDIO_LIST "+t.sendFrom);var n=t.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",e.sendTaskMap.size+e.receiveTaskMap.size);var r,o=a(n);try{for(o.s();!(r=o.n()).done;){var s=r.value,l=Ow.instance.get(s.identifier);null===l&&(l=Ew.createEmpty(s.identifier),Ow.instance.add(l)),l.state<Cw.COMPLETE&&!e.receiveTaskMap.has(s.identifier)&&i.push({identifier:s.identifier,state:l.state})}}catch(u){o.e(u)}finally{o.f()}if(i.length<1&&!e.hasActiveTask()&&n.length<Ow.instance.getCatalog().length&&Ow.instance.synchronize(t.sendFrom),!(i.length<1||e.isLimitReceiveTask())){var c=Math.floor(Math.random()*i.length);e.request([i[c]],t.sendFrom)}}}).on("REQUEST_AUDIO_RESOURE",function(t){if(!t.isSendFromSelf){var n,i=[],r=a(t.data.identifiers);try{for(r.s();!(n=r.n()).done;){var o=n.value,s=Ow.instance.get(o.identifier);s&&o.state<s.state&&i.push({identifier:o.identifier,state:o.state})}}catch(g){r.e(g)}finally{r.f()}if(!1===e.isLimitSendTask()&&0<i.length&&!e.existsSendTask(t.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+t.data.receiver+" -> "+i);var l=Math.floor(Math.random()*i.length),c=Ow.instance.get(i[l].identifier);e.startSendTask(c,t.data.receiver)}else{var u=t.data.candidatePeers,h=u.indexOf(ek.peerId);-1<h&&u.splice(h,1);var d,f=a(u);try{for(f.s();!(d=f.n()).done;){var p=d.value;return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+p+" -> "+t.data.identifiers),void Jb.call(t,p)}}catch(g){f.e(g)}finally{f.f()}console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+t.data.receiver,i.length)}}}).on("UPDATE_AUDIO_RESOURE",function(e){var t=e.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+e.sendFrom+" -> ",t);var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),Ow.instance.add(r)}}catch(o){i.e(o)}finally{i.f()}}).on("START_AUDIO_TRANSMISSION",function(t){console.log("START_AUDIO_TRANSMISSION "+t.data.fileIdentifier);var n=t.data.fileIdentifier,i=Ow.instance.get(n);e.receiveTaskMap.has(n)||i&&Cw.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+n),Jb.call("CANCEL_TASK_"+n,null,t.sendFrom)):e.startReceiveTask(n)})}},{key:"destroy",value:function(){Jb.unregister(this)}},{key:"startSendTask",value:function(e,t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(i=fI.createSendTask(e.identifier,t),this.sendTaskMap.set(e.identifier,i),Jb.call("START_AUDIO_TRANSMISSION",{fileIdentifier:e.identifier},t),r={identifier:e.identifier,name:e.name,blob:null,type:"",url:null},e.state!==Cw.URL){n.next=7;break}r.url=e.url,n.next=11;break;case 7:return n.next=9,Bm.readAsArrayBufferAsync(e.blob);case 9:r.blob=n.sent,r.type=e.blob.type;case 11:i.onfinish=function(){a.stopSendTask(i.identifier),Ow.instance.synchronize()},i.start(r);case 13:case"end":return n.stop()}},n,this)}))}},{key:"startReceiveTask",value:function(e){var t=this,n=Ow.instance.get(e),i=fI.createReceiveTask(e);this.receiveTaskMap.set(e,i),i.onprogress=function(e,t,i){var r=n.toContext();r.name=(100*t/i).toFixed(1)+"%",n.apply(r)},i.onfinish=function(e,n){t.stopReceiveTask(e.identifier),n&&Jb.trigger("UPDATE_AUDIO_RESOURE",[n]),Ow.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}},{key:"stopSendTask",value:function(e){var t=this.sendTaskMap.get(e);t&&t.cancel(),this.sendTaskMap.delete(e),console.log("stopSendTask => ",this.sendTaskMap.size)}},{key:"stopReceiveTask",value:function(e){var t=this.receiveTaskMap.get(e);t&&t.cancel(),this.receiveTaskMap.delete(e),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}},{key:"request",value:function(e,t){console.log("requestFile() "+t);var n=ek.peerIds;n.splice(n.indexOf(ek.peerId),1),Jb.call("REQUEST_AUDIO_RESOURE",{identifiers:e,receiver:ek.peerId,candidatePeers:n},t)}},{key:"hasActiveTask",value:function(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}},{key:"isLimitSendTask",value:function(){return this.maxSendTask<=this.sendTaskMap.size}},{key:"isLimitReceiveTask",value:function(){return this.maxReceiveTask<=this.receiveTaskMap.size}},{key:"existsSendTask",value:function(e){var t,n=a(this.sendTaskMap.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i&&i.sendTo===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),gI=function(){function e(){y(this,e),this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}return k(e,[{key:"initialize",value:function(){var e=this;Jb.register(this).on("CONNECT_PEER",1,function(e){e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Dk.instance.synchronize())}).on("XML_LOADED",function(e){!function(e){for(var t=[],n=e.querySelectorAll('*[type="image"]'),i=0;i<n.length;i++){var r=n[i].innerHTML;!Dk.instance.get(r)&&0<kw.type(r).length&&t.push(r)}n=e.querySelectorAll("*[imageIdentifier]");for(var a=0;a<n.length;a++){var o=n[a].getAttribute("imageIdentifier");!Dk.instance.get(o)&&0<kw.type(o).length&&t.push(o)}for(var s=0,l=t;s<l.length;s++){var c=l[s];Dk.instance.add(c)}}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",function(t){if(!t.isSendFromSelf){console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+t.sendFrom);var n,i=t.data,r=[],o=a(i);try{for(o.s();!(n=o.n()).done;){var s=n.value,l=Dk.instance.get(s.identifier);null===l&&(l=Wm.createEmpty(s.identifier),Dk.instance.add(l)),l.state<Vm.COMPLETE&&!e.receiveTaskMap.has(s.identifier)&&r.push({identifier:s.identifier,state:l.state})}}catch(c){o.e(c)}finally{o.f()}r.length<1&&!e.hasActiveTask()&&i.length<Dk.instance.getCatalog().length&&Dk.instance.synchronize(t.sendFrom),r.length<1||e.isLimitReceiveTask()||e.request(r,t.sendFrom)}}).on("REQUEST_FILE_RESOURE",function(t){return Lm(e,void 0,void 0,regeneratorRuntime.mark(function e(){var n,i,r,o,s,l,c,u,h,d,f,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isSendFromSelf){e.next=2;break}return e.abrupt("return");case 2:n=t.data.identifiers,i=[],r=a(n);try{for(r.s();!(o=r.n()).done;)s=o.value,(l=Dk.instance.get(s.identifier))&&s.state<l.state&&i.push({identifier:s.identifier,state:s.state})}catch(g){r.e(g)}finally{r.f()}if(!(!1===this.isLimitSendTask()&&0<i.length)||this.existsSendTask(t.data.receiver)){e.next=10;break}c=this.makeSendUpdateImages(i),console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+t.data.receiver+" -> "+c.length),this.startSendTask(c,t.data.receiver),e.next=29;break;case 10:u=t.data.candidatePeers,-1<(h=u.indexOf(ek.peerId))&&u.splice(h,1),d=a(u),e.prev=13,d.s();case 15:if((f=d.n()).done){e.next=20;break}return p=f.value,e.abrupt("return",(console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+p+" -> "+t.data.identifiers),void Jb.call(t,p)));case 18:e.next=15;break;case 20:e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),d.e(e.t0);case 25:return e.prev=25,d.f(),e.finish(25);case 28:console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+t.data.receiver,i.length);case 29:case"end":return e.stop()}},e,this,[[13,22,25,28]])}))}).on("UPDATE_FILE_RESOURE",function(e){var t=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",t);var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Dk.instance.add(r)}}catch(o){i.e(o)}finally{i.f()}}).on("START_FILE_TRANSMISSION",function(t){console.log("START_FILE_TRANSMISSION "+t.data.taskIdentifier);var n=t.data.taskIdentifier,i=Dk.instance.get(n);e.receiveTaskMap.has(n)||i&&Vm.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+n),Jb.call("CANCEL_TASK_"+n,null,t.sendFrom)):e.startReceiveTask(n)})}},{key:"destroy",value:function(){Jb.unregister(this)}},{key:"startSendTask",value:function(e,t){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function n(){var i,r,o,s,l,c=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:i=1===e.length?e[0].identifier:Hb.generateUuid(),r=fI.createSendTask(i,t),this.sendTaskMap.set(r.identifier,r),Jb.call("START_FILE_TRANSMISSION",{taskIdentifier:i},t),o=a(e),n.prev=3,o.s();case 5:if((s=o.n()).done){n.next=20;break}if(!(l=s.value).thumbnail.blob){n.next=13;break}return n.next=10,Bm.readAsArrayBufferAsync(l.thumbnail.blob);case 10:l.thumbnail.blob=n.sent,n.next=18;break;case 13:if(n.t0=l.blob,!n.t0){n.next=18;break}return n.next=17,Bm.readAsArrayBufferAsync(l.blob);case 17:l.blob=n.sent;case 18:n.next=5;break;case 20:n.next=25;break;case 22:n.prev=22,n.t1=n.catch(3),o.e(n.t1);case 25:return n.prev=25,o.f(),n.finish(25);case 28:r.onfinish=function(e,t){c.stopSendTask(e.identifier),Dk.instance.synchronize()},r.start(e);case 29:case"end":return n.stop()}},n,this,[[3,22,25,28]])}))}},{key:"startReceiveTask",value:function(e){var t=this,n=fI.createReceiveTask(e);this.receiveTaskMap.set(e,n),n.onfinish=function(e,n){t.stopReceiveTask(e.identifier),n&&Jb.trigger("UPDATE_FILE_RESOURE",{identifier:e.identifier,updateImages:n}),Dk.instance.synchronize()},n.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}},{key:"stopSendTask",value:function(e){var t=this.sendTaskMap.get(e);t&&t.cancel(),this.sendTaskMap.delete(e),console.log("stopSendTask => ",this.sendTaskMap.size)}},{key:"stopReceiveTask",value:function(e){var t=this.receiveTaskMap.get(e);t&&t.cancel(),this.receiveTaskMap.delete(e),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}},{key:"request",value:function(e,t){console.log("requestFile() "+t);var n=ek.peerIds;n.splice(n.indexOf(ek.peerId),1),Jb.call("REQUEST_FILE_RESOURE",{identifiers:e,receiver:ek.peerId,candidatePeers:n},t)}},{key:"makeSendUpdateImages",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:524288,n=[],i=0,r=e.length-1;0<=r;r--){var a=Math.floor(Math.random()*(r+1)),o=[e[a],e[r]];e[r]=o[0],e[a]=o[1]}e.sort(function(e,t){return e.state<t.state?-1:e.state>t.state?1:0});for(var s=0;s<e.length;s++){var l=e[s],c=Dk.instance.get(l.identifier),u={identifier:c.identifier,name:c.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};c.state===Vm.URL?u.url=c.url:l.state===Vm.NULL?(u.thumbnail.blob=c.thumbnail.blob,u.thumbnail.type=c.thumbnail.type):(u.blob=c.blob,u.type=c.blob.type);var h=u.blob?u.blob.size:u.thumbnail.blob?u.thumbnail.blob.size:100;if(n.push(u),t<(i+=h))break}return n}},{key:"hasActiveTask",value:function(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}},{key:"isLimitSendTask",value:function(){return this.maxSendTask<=this.sendTaskMap.size}},{key:"isLimitReceiveTask",value:function(){return this.maxReceiveTask<=this.receiveTaskMap.size}},{key:"existsSendTask",value:function(e){var t,n=a(this.sendTaskMap.values());try{for(n.s();!(t=n.n()).done;){var i=t.value;if(i&&i.sendTo===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}}],[{key:"instance",get:function(){return e._instance||(e._instance=new e),e._instance}}]),e}(),mI=((oI=function(){function e(t){y(this,e),this.peerId=t,this.requestMap=new Map}return k(e,[{key:"cancel",value:function(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;var e,t=a(this.requestMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;this.deleteTasksMap(n.identifier)}}catch(i){t.e(i)}finally{t.f()}this.requestMap.clear()}},{key:"initialize",value:function(t){var n,i=this,r=a(t);try{for(r.s();!(n=r.n()).done;){var o=n.value;o.ttl--,this.requestMap.set(o.identifier,o);var s=e.tasksMap.get(o.identifier);null==s&&(s=[]),s.push(this),e.tasksMap.set(o.identifier,s);var l=null!=this.peerId&&o.holderIds.includes(this.peerId)?this.peerId:null;Jb.call("REQUEST_GAME_OBJECT",o.identifier,l)}}catch(c){r.e(c)}finally{r.f()}this.requestMap.size<1?setTimeout(function(){return i.finish()}):this.resetTimeout()}},{key:"finish",value:function(){this.onfinish&&this.onfinish(this),this.cancel()}},{key:"timeout",value:function(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(function(e){return 0<=e.ttl})),this.finish()}},{key:"onUpdate",value:function(e){this.requestMap.delete(e),this.onsynchronize&&this.onsynchronize(this,e),this.requestMap.size<1?this.finish():this.resetTimeout()}},{key:"deleteTasksMap",value:function(t){var n=e.tasksMap.get(t),i=n.indexOf(this);-1<i&&n.splice(i,1),n.length<1&&e.tasksMap.delete(t)}},{key:"resetTimeout",value:function(){var e=this;null==this.timeoutTimer&&(this.timeoutTimer=new nk(function(){return e.timeout()},3e4)),this.timeoutTimer.reset()}}],[{key:"create",value:function(t,n){e.tasksMap.size<1&&Jb.register(e.key).on("DISCONNECT_PEER",function(t){e.onDisconnect(t.data.peerId)}).on("UPDATE_GAME_OBJECT",function(t){t.isSendFromSelf||e.onUpdate(t.data.identifier)}).on("DELETE_GAME_OBJECT",function(t){t.isSendFromSelf||e.onUpdate(t.data.identifier)});var i=new e(t);return i.initialize(n),i}},{key:"onDisconnect",value:function(t){var n,i=a(e.tasksMap.values());try{for(i.s();!(n=i.n()).done;){var r,o=a(n.value.concat());try{for(o.s();!(r=o.n()).done;){var s=r.value;s.peerId===t&&s.timeout()}}catch(l){o.e(l)}finally{o.f()}}}catch(l){i.e(l)}finally{i.f()}e.tasksMap.size<1&&Jb.unregister(e.key)}},{key:"onUpdate",value:function(t){if(e.tasksMap.has(t)){var n,i=a(e.tasksMap.get(t).concat());try{for(i.s();!(n=i.n()).done;)n.value.onUpdate(t)}catch(r){i.e(r)}finally{i.f()}e.tasksMap.size<1&&Jb.unregister(e.key)}}}]),e}()).key={},oI.tasksMap=new Map,oI),vI=function(){function t(){y(this,t),this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}return k(t,[{key:"initialize",value:function(){var e=this;this.destroy(),console.log("ObjectSynchronizer ready..."),Jb.register(this).on("CONNECT_PEER",2,function(t){t.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",t.data.peerId),e.sendCatalog(t.data.peerId))}).on("DISCONNECT_PEER",function(t){e.removePeerMap(t.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",function(t){if(!t.isSendFromSelf){console.log("SYNCHRONIZE_GAME_OBJECT "+t.sendFrom);var n,i=a(t.data);try{for(i.s();!(n=i.n()).done;){var r=n.value;tk.instance.isDeleted(r.identifier)?Jb.call("DELETE_GAME_OBJECT",{identifier:r.identifier},t.sendFrom):e.addRequestMap(r,t.sendFrom)}}catch(o){i.e(o)}finally{i.f()}e.synchronize()}}).on("REQUEST_GAME_OBJECT",function(e){if(!e.isSendFromSelf)if(tk.instance.isDeleted(e.data))Jb.call("DELETE_GAME_OBJECT",{identifier:e.data},e.sendFrom);else{var t=tk.instance.get(e.data);t&&Jb.call("UPDATE_GAME_OBJECT",t.toContext(),e.sendFrom)}}).on("UPDATE_GAME_OBJECT",function(t){var n=t.data,i=tk.instance.get(n.identifier);i?t.isSendFromSelf||e.updateObject(i,n):tk.instance.isDeleted(n.identifier)?Jb.call("DELETE_GAME_OBJECT",{identifier:n.identifier},t.sendFrom):e.createObject(n)}).on("DELETE_GAME_OBJECT",function(e){tk.instance.delete(e.data.identifier,!1)})}},{key:"destroy",value:function(){Jb.unregister(this)}},{key:"updateObject",value:function(e,t){t.majorVersion+t.minorVersion>e.version&&e.apply(t)}},{key:"createObject",value:function(e){var t=ik.instance.create(e.aliasName,e.identifier);t?(tk.instance.add(t,!1),t.apply(e)):console.warn(e.aliasName+" is Unknown...?",e)}},{key:"sendCatalog",value:function(e){var t=tk.instance.getCatalog(),n=setInterval(function(){Jb.call("SYNCHRONIZE_GAME_OBJECT",t.splice(0,t.length<2048?t.length:2048),e),t.length<1&&clearInterval(n)})}},{key:"addRequestMap",value:function(e,t){var n=this.requestMap.get(e.identifier);n&&n.version===e.version?(n.holderIds.push(t),this.addPeerMap(t)):(!n||n.version<e.version)&&(this.requestMap.set(e.identifier,{identifier:e.identifier,version:e.version,holderIds:[t],ttl:2}),this.addPeerMap(t))}},{key:"addPeerMap",value:function(e){this.peerMap.has(e)||this.peerMap.set(e,[])}},{key:"removePeerMap",value:function(e){this.peerMap.delete(e)}},{key:"synchronize",value:function(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}},{key:"runSynchronizeTask",value:function(){var e=this,t=this.getTargetPeerId(),n=this.makeRequestList(t);if(n.length<1)this.removePeerMap(t);else{var i=mI.create(t,n);this.tasks.push(i);var r=this.peerMap.get(t);r&&r.push(i),i.onfinish=function(n){e.tasks.splice(e.tasks.indexOf(n),1);var i=e.peerMap.get(t);i&&i.splice(i.indexOf(n),1),e.synchronize()},i.ontimeout=function(t,n){console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),n.forEach(function(t){return e.requestMap.set(t.identifier,t)})}}}},{key:"makeRequestList",value:function(t){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=[],o=a(this.requestMap);try{for(o.s();!(n=o.n()).done;){var s=e(n.value,2),l=s[0],c=s[1];if(i<=r.length)break;if(c.holderIds.includes(t)){var u=tk.instance.get(c.identifier);(!u||u.version<c.version)&&r.push(c),this.requestMap.delete(l)}}}catch(h){o.e(h)}finally{o.f()}return r}},{key:"getTargetPeerId",value:function(){for(var e=9999,t=null,n=ek.peerContexts,i=n.length-1;0<=i;i--){var r=Math.floor(Math.random()*(i+1)),o=[n[r],n[i]];n[i]=o[0],n[r]=o[1]}var s,l=a(n);try{for(l.s();!(s=l.n()).done;){var c=s.value,u=this.peerMap.get(c.peerId);c.isOpen&&u&&u.length<e&&(e=u.length,t=c.peerId)}}catch(h){l.e(h)}finally{l.f()}return t}}],[{key:"instance",get:function(){return t._instance||(t._instance=new t),t._instance}}]),t}(),yI=(sI=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).audioIdentifier="",e.startTime=0,e.isLoop=!1,e.isPlaying=!1,e.audioPlayer=new Tw,e}return k(n,[{key:"audio",get:function(){return Ow.instance.get(this.audioIdentifier)}},{key:"onStoreAdded",value:function(){u(v(n.prototype),"onStoreAdded",this).call(this),this.unlockAfterUserInteraction()}},{key:"onStoreRemoved",value:function(){u(v(n.prototype),"onStoreRemoved",this).call(this),this._stop()}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Ow.instance.get(e);n&&n.isReady&&(this.audioIdentifier=e,this.isPlaying=!0,this.isLoop=t,this._play())}},{key:"_play",value:function(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}},{key:"stop",value:function(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}},{key:"_stop",value:function(){this.unregisterEvent(),this.audioPlayer.stop()}},{key:"playAfterFileUpdate",value:function(){var e=this;Jb.register(this).on("UPDATE_AUDIO_RESOURE",-100,function(t){e._play()})}},{key:"unlockAfterUserInteraction",value:function(){var e=this,t=function t(){document.body.removeEventListener("touchstart",t,!0),document.body.removeEventListener("mousedown",t,!0),e.audioPlayer.stop(),e.isPlaying&&e._play()};document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)}},{key:"unregisterEvent",value:function(){Jb.unregister(this,"UPDATE_AUDIO_RESOURE")}},{key:"apply",value:function(e){var t=this.audioIdentifier,i=this.isPlaying;u(v(n.prototype),"apply",this).call(this,e),t===this.audioIdentifier&&i||!this.isPlaying?i===this.isPlaying||this.isPlaying||this._stop():this._play()}}]),n}(ck),zm([pk()],sI.prototype,"audioIdentifier",void 0),zm([pk()],sI.prototype,"startTime",void 0),zm([pk()],sI.prototype,"isLoop",void 0),zm([pk()],sI.prototype,"isPlaying",void 0),sI=zm([fk("jukebox")],sI));function bI(e,t){if(1&e&&(Zo(0,"option",7),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n.identifier),sa(1),Ls(n.name)}}function kI(e,t){if(1&e&&(Zo(0,"div",16),zs(1),Yo()),2&e){var n=is(3);sa(1),Bs("",n.progresPercent,"%")}}var _I=function(e){return{"is-hidden":e}};function wI(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",2),es("click",function(){return Jt(n),is(2).upTabIndex()}),zs(2,"\u2191"),Yo(),Zo(3,"button",2),es("click",function(){return Jt(n),is(2).downTabIndex()}),zs(4,"\u2193"),Yo(),Zo(5,"button",11),es("click",function(){return Jt(n),is(2).save()}),Zo(6,"div",12),Zo(7,"div",13),zs(8,"\u4fdd\u5b58"),Yo(),Uo(9,kI,2,1,"div",14),Yo(),Yo(),Zo(10,"button",15),es("click",function(){return Jt(n),is(2).delete()}),zs(11,"\u524a\u9664"),Yo(),Ko()}if(2&e){var i=is(2);sa(5),Wo("disabled",i.isSaveing),sa(2),Wo("ngClass",rc(4,_I,i.isSaveing)),sa(2),Wo("ngIf",i.isSaveing),sa(1),Lo("disabled",i.chatTabs.length<=1?"":null)}}function xI(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",2),es("click",function(){return Jt(n),is(2).restore()}),zs(2,"\u5143\u306b\u623b\u3059"),Yo(),Ko()}}function CI(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div"),zs(2,"\u30bf\u30d6\u540d : "),Zo(3,"input",8),es("ngModelChange",function(e){return Jt(n),is().tabName=e}),Yo(),Yo(),Zo(4,"div",9),Zo(5,"label"),Zo(6,"input",10),es("ngModelChange",function(e){return Jt(n),is().isUseStandImage=e})("change",function(){Jt(n);var e=is();return e.isUseStandImage=!!e.isUseStandImage}),Yo(),zs(7," \u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),Yo(),Yo(),qo(8,"hr"),Zo(9,"div"),Uo(10,wI,12,6,"ng-container",6),Uo(11,xI,3,0,"ng-container",6),Yo(),Ko()}if(2&e){var i=is();sa(3),Wo("ngModel",i.tabName),Lo("disabled",i.isEditable?null:""),sa(3),ss("checked",i.isUseStandImage?"checked":""),Wo("ngModel",i.isUseStandImage),Lo("disabled",i.isEditable?null:""),sa(4),Wo("ngIf",!i.isDeleted),sa(1),Wo("ngIf",i.isDeleted)}}function EI(e,t){1&e&&(Xo(0),Zo(1,"div",17),zs(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),Yo(),Ko())}var SI,TI=((SI=function(){function e(t,n,i,r){y(this,e),this.modalService=t,this.panelService=n,this.chatMessageService=i,this.saveDataService=r,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}return k(e,[{key:"tabName",get:function(){return this.selectedTab.name},set:function(e){this.isEditable&&(this.selectedTab.name=e)}},{key:"isUseStandImage",get:function(){return this.selectedTab.isUseStandImage},set:function(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}},{key:"chatTabs",get:function(){return this.chatMessageService.chatTabs}},{key:"isEmpty",get:function(){return this.chatMessageService.chatTabs.length<1}},{key:"isDeleted",get:function(){return!!this.selectedTab&&null==tk.instance.get(this.selectedTab.identifier)}},{key:"isEditable",get:function(){return!this.isEmpty&&!this.isDeleted}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.modalService.title=e.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a"}),Jb.register(this).on("DELETE_GAME_OBJECT",1e3,function(t){if(e.selectedTab&&t.data.identifier===e.selectedTab.identifier){var n=tk.instance.get(t.data.identifier);null!==n&&(e.selectedTabXml=n.toXml())}})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"onChangeSelectTab",value:function(e){this.selectedTab=tk.instance.get(e),this.selectedTabXml=""}},{key:"create",value:function(){Zx.instance.addChatTab("\u30bf\u30d6")}},{key:"save",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.selectedTab&&!this.isSaveing){e.next=2;break}return e.abrupt("return");case 2:return this.isSaveing=!0,this.progresPercent=0,t="chat_"+this.selectedTab.name,e.next=6,this.saveDataService.saveGameObjectAsync(this.selectedTab,t,function(e){n.progresPercent=e});case 6:setTimeout(function(){n.isSaveing=!1,n.progresPercent=0},500);case 7:case"end":return e.stop()}},e,this)}))}},{key:"delete",value:function(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}},{key:"restore",value:function(){if(this.selectedTab&&this.selectedTabXml){var e=lk.instance.parseXml(this.selectedTabXml);Zx.instance.addChatTab(e),this.selectedTabXml=""}}},{key:"upTabIndex",value:function(){if(this.selectedTab){var e=this.selectedTab.parent,t=e.children.indexOf(this.selectedTab);0<t&&e.insertBefore(this.selectedTab,e.children[t-1])}}},{key:"downTabIndex",value:function(){if(this.selectedTab){var e=this.selectedTab.parent,t=e.children.indexOf(this.selectedTab);t<e.children.length-1&&e.insertBefore(e.children[t+1],this.selectedTab)}}}]),e}()).\u0275fac=function(e){return new(e||SI)(Vo(Zk),Vo(Wk),Vo(Yx),Vo(aE))},SI.\u0275cmp=ct({type:SI,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],["placeholder","Name",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"div",1),Zo(2,"div"),Zo(3,"button",2),es("click",function(){return t.create()}),zs(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),Yo(),Yo(),Zo(5,"select",3),es("change",function(e){return t.onChangeSelectTab(e.target.value)}),Uo(6,bI,2,2,"option",4),Yo(),Yo(),Zo(7,"div",5),Uo(8,CI,12,7,"ng-container",6),Yo(),Yo(),Uo(9,EI,3,0,"ng-container",6)),2&e&&(sa(5),Wo("ngModel",null==t.selectedTab?null:t.selectedTab.identifier),sa(1),Wo("ngForOf",t.chatTabs),sa(2),Wo("ngIf",!t.isEmpty&&t.selectedTab),sa(1),Wo("ngIf",t.isEmpty))},directives:[Bf,Xd,Ef,uh,dh,jf,$f,Ed,wd,lh],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),SI),OI=["msgFrom"],II=["message"],MI=function(e){return{"black-paint":e}};function AI(e,t){if(1&e&&(qo(0,"img",16),hc(1,"safe")),2&e){var n=is(2);Wo("src",dc(1,2,null==n.imageFile?null:n.imageFile.url,"resourceUrl"),dr)("ngClass",rc(5,MI,1==n.chatMessage.isBlackPaint))}}var PI=function(e,t){return{inverse:e,hollow:t}},DI=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}};function RI(e,t){if(1&e&&(Zo(0,"div",13),Zo(1,"span",14),Uo(2,AI,2,7,"img",15),Yo(),Yo()),2&e){var n=is();Wo("ngClass",ac(3,PI,1==n.chatMessage.isInverseIcon,1==n.chatMessage.isHollowIcon)),sa(1),Wo("ngClass",lc(6,DI,0==n.chatMessage.aura,1==n.chatMessage.aura,2==n.chatMessage.aura,3==n.chatMessage.aura,4==n.chatMessage.aura,5==n.chatMessage.aura,6==n.chatMessage.aura,7==n.chatMessage.aura)),sa(1),Wo("ngIf",0<(null==n.imageFile||null==n.imageFile.url?null:n.imageFile.url.length))}}function FI(e,t){1&e&&$o(0)}function NI(e,t){if(1&e&&(qo(0,"img",16),hc(1,"safe")),2&e){var n=is(2);Wo("src",dc(1,2,null==n.imageFile?null:n.imageFile.url,"resourceUrl"),dr)("ngClass",rc(5,MI,1==n.chatMessage.isBlackPaint))}}function zI(e,t){if(1&e&&(Zo(0,"div",13),Zo(1,"span",14),Uo(2,NI,2,7,"img",15),Yo(),Yo()),2&e){var n=is();Wo("ngClass",ac(3,PI,1==n.chatMessage.isInverseIcon,1==n.chatMessage.isHollowIcon)),sa(1),Wo("ngClass",lc(6,DI,0==n.chatMessage.aura,1==n.chatMessage.aura,2==n.chatMessage.aura,3==n.chatMessage.aura,4==n.chatMessage.aura,5==n.chatMessage.aura,6==n.chatMessage.aura,7==n.chatMessage.aura)),sa(1),Wo("ngIf",0<(null==n.imageFile||null==n.imageFile.url?null:n.imageFile.url.length))}}function LI(e,t){if(1&e){var n=Qo();Zo(0,"button",20),es("click",function(){return Jt(n),is(2).discloseMessage()}),zs(1,"\u7d50\u679c\u3092\u516c\u958b"),Yo()}}var BI=function(){return{schemeMatches:!0,wwwMatches:!0,tldMatches:!1}},jI=function(){return{length:48,location:"end"}},UI=function(e,t){return{urls:e,truncate:t,decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1}};function HI(e,t){if(1&e&&(qo(0,"span",17,18),hc(2,"linky"),Uo(3,LI,2,0,"button",19)),2&e){var n=is();ks("color",!n.chatMessage.isSpecialColor&&n.chatMessage.color&&"#ffffff"!=n.chatMessage.color?n.chatMessage.color:""),Wo("innerHTML",dc(2,4,n.stringUtil.escapeHtml(n.chatMessage.text),ac(9,UI,ic(7,BI),ic(8,jI))),hr),sa(3),Wo("ngIf",n.chatMessage.isSecret)}}function VI(e,t){1&e&&(Zo(0,"span"),zs(1,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),Yo())}var WI,GI=function(e,t,n,i,r){return{"is-mine":e,"is-others":t,"direct-message":n,"system-message":i,"dicebot-message":r}},ZI=function(e,t){return{urls:e,truncate:t,decodePercentEncoding:!1,stripPrefix:!0,stripTrailingSlash:!0,email:!1,phone:!1}},YI=((WI=function(){function e(t,n){y(this,e),this.chatMessageService=t,this.modalService=n,this.imageFile=Wm.Empty,this.animeState="inactive",this.stringUtil=gk}return k(e,[{key:"ngOnInit",value:function(){var e=this.chatMessage.image;e&&(this.imageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}},{key:"isMine",get:function(){return this.chatMessage.isSendFromSelf}},{key:"ngAfterViewInit",value:function(){var e=this;if(this.msgFromElm&&this.msgFromElm.nativeElement){var t=this.msgFromElm.nativeElement.querySelector("A[href]");if(t){var n=t.getAttribute("href");gk.validUrl(n)?gk.sameOrigin(n)||(t.classList.add("outer-link"),t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.modalService.open(Jk,{url:n})},!0)):(t.removeAttribute("href"),t.removeAttribute("target"))}}this.messageElm&&this.messageElm.nativeElement&&this.messageElm.nativeElement.querySelectorAll("A[href]").forEach(function(t){var n=t.getAttribute("href");gk.validUrl(n)?gk.sameOrigin(n)||(t.classList.add("outer-link"),t.addEventListener("click",function(t){t.stopPropagation(),t.preventDefault(),e.modalService.open(Jk,{url:n})},!0)):(t.removeAttribute("href"),t.removeAttribute("target"))})}},{key:"discloseMessage",value:function(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}}]),e}()).\u0275fac=function(e){return new(e||WI)(Vo(Yx),Vo(Zk))},WI.\u0275cmp=ct({type:WI,selectors:[["chat-message"]],viewQuery:function(e,t){var n;1&e&&(Sc(OI,1),Sc(II,1)),2&e&&(Ec(n=Tc())&&(t.msgFromElm=n.first),Ec(n=Tc())&&(t.messageElm=n.first))},inputs:{chatMessage:"chatMessage"},decls:20,vars:34,consts:[[1,"container"],[1,"message",3,"ngClass"],["class","image",3,"ngClass",4,"ngIf"],[1,"body"],[1,"title"],[1,"msg-name"],[1,"tip","msg-from",3,"innerHTML"],["msgFrom",""],[1,"tip","msg-timestamp"],[1,"text","msg-text"],[4,"ngIf","ngIfThen","ngIfElse"],["visible",""],["secret",""],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],[3,"src","ngClass",4,"ngIf"],[3,"src","ngClass"],[3,"innerHTML"],["message",""],["style","padding-top: 1px; padding-bottom: 1px;",3,"click",4,"ngIf"],[2,"padding-top","1px","padding-bottom","1px",3,"click"]],template:function(e,t){if(1&e&&(Zo(0,"div",0),Zo(1,"div",1),Uo(2,RI,3,15,"div",2),Zo(3,"div",3),Zo(4,"div",4),Zo(5,"span",5),zs(6),Yo(),qo(7,"span",6,7),hc(9,"linky"),Zo(10,"span",8),zs(11),hc(12,"date"),Yo(),Yo(),Zo(13,"div",9),Uo(14,FI,1,0,"ng-container",10),Yo(),Yo(),Uo(15,zI,3,15,"div",2),Yo(),Yo(),Uo(16,HI,4,12,"ng-template",null,11,Ic),Uo(18,VI,2,0,"ng-template",null,12,Ic)),2&e){var n=Ho(17),i=Ho(19);sa(1),ks("border-left-color",!t.chatMessage.isSystem||t.chatMessage.isDicebot||t.chatMessage.isCalculate?t.chatMessage.color:"#444444")("border-right-color",!t.chatMessage.isSystem||t.chatMessage.isDicebot||t.chatMessage.isCalculate?t.chatMessage.color:"#444444"),Wo("ngClass",(r=GI,a=t.isMine,o=!t.isMine,s=t.chatMessage.isDirect||t.chatMessage.isSecret,l=t.chatMessage.isSystem,c=t.chatMessage.isDicebot||t.chatMessage.isCalculate,u=ln()+23,h=$t(),d=zo(h,u,a,o,s,l),Fo(h,u+4,c)||d?Do(h,u+5,r(a,o,s,l,c)):Ro(h,u+5)))("@flyInOut",t.isMine?null:"active")("@flyInOutMe",t.isMine?"active":null),sa(1),Wo("ngIf",t.isMine),sa(3),ks("color",!t.chatMessage.isSpecialColor&&t.chatMessage.color&&"#ffffff"!=t.chatMessage.color?t.chatMessage.color:""),sa(1),Ls(t.chatMessage.name),sa(1),Wo("innerHTML",dc(9,17,t.stringUtil.escapeHtml("\u3000"+t.chatMessage.from),ac(31,ZI,ic(29,BI),ic(30,jI))),hr),sa(4),Bs("\u3000",dc(12,20,t.chatMessage.timestamp,"y/M/d H:mm"),""),sa(3),Wo("ngIf",!t.chatMessage.isSecret||t.chatMessage.isSendFromSelf)("ngIfThen",n)("ngIfElse",i),sa(1),Wo("ngIf",!t.isMine)}var r,a,o,s,l,c,u,h,d},directives:[lh,dh],pipes:[tw,Oh,Lw],styles:["[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #ccc}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#22f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:inline-block;text-align:left;max-width:100%}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}"],data:{animation:[sp("flyInOut",[fp("* => active",[lp("200ms ease-out",dp([up({transform:"translateX(100px)",opacity:"0",offset:0}),up({transform:"translateX(0)",opacity:"1",offset:1})]))]),fp("void => *",[lp("200ms ease-out",dp([up({opacity:"0",offset:0}),up({opacity:"1",offset:1})]))])]),sp("flyInOutMe",[fp("* => active",[lp("200ms ease-out",dp([up({transform:"translateX(-100px)",opacity:"0",offset:0}),up({transform:"translateX(0)",opacity:"1",offset:1})]))]),fp("void => *",[lp("200ms ease-out",dp([up({opacity:"0",offset:0}),up({opacity:"1",offset:1})]))])])]}}),WI),qI=["logContainer"],XI=["messageContainer"];function KI(e,t){1&e&&qo(0,"chat-message",7),2&e&&Wo("chatMessage",is().$implicit)}function $I(e,t){if(1&e&&(Xo(0),Uo(1,KI,1,1,"chat-message",6),Ko()),2&e){var n=t.$implicit;sa(1),Wo("ngIf",n.isDisplayable)}}function QI(e,t){if(1&e&&(Xo(0),Uo(1,$I,2,1,"ng-container",5),Ko()),2&e){var n=is();sa(1),Wo("ngForOf",n.chatMessages)("ngForTrackBy",n.trackByChatMessage)}}function JI(e,t){1&e&&qo(0,"chat-message",7),2&e&&Wo("chatMessage",t.$implicit)}function eM(e,t){if(1&e&&(Xo(0),Uo(1,JI,1,1,"chat-message",8),Ko()),2&e){var n=is();sa(1),Wo("ngForOf",n.sampleMessages)}}var tM,nM=window.navigator.userAgent.toLowerCase(),iM=nM.indexOf("iphone")>-1||nM.indexOf("ipad")>-1||nM.indexOf("macintosh")>-1&&"ontouchend"in document,rM=((tM=function(){function e(t,n,i){var r=this;y(this,e),this.ngZone=t,this.changeDetector=n,this.panelService=i,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb \u27a1 \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",to:"???",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb \u27a1 \u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",tag:"",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.minMessageHeight=61,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=function(){return r.onScroll()},this.callbackOnScrollToBottom=function(){return r.resetMessages()},this.onAddMessage=new fc}return k(e,[{key:"chatMessages",get:function(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;var e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}},{key:"minScrollHeight",get:function(){var e=this.chatTab?this.chatTab.chatMessages.length:this.sampleMessages.length;return(e<1e4?e:1e4)*this.minMessageHeight}},{key:"topSpace",get:function(){return this.minScrollHeight-this.bottomSpace}},{key:"bottomSpace",get:function(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}},{key:"ngOnInit",value:function(){var e,t=this,n=[],i=a(this.sampleMessages);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=new Wx;for(var s in r)"identifier"!==s&&"tabIdentifier"!==s&&("text"!==s?null!=r[s]&&""!==r[s]&&o.setAttribute(s,r[s]):o.value=r[s]);n.push(o)}}catch(l){i.e(l)}finally{i.f()}this.sampleMessages=n,Jb.register(this).on("MESSAGE_ADDED",function(e){var n=tk.instance.get(e.data.messageIdentifier);n&&t.chatTab.contains(n)&&t.topTimestamp<=n.timestamp&&(t.changeDetector.markForCheck(),t.needUpdate=!0,t.onMessageInit())}).on("UPDATE_GAME_OBJECT",function(e){var n=tk.instance.get(e.data.identifier);n&&n instanceof Wx&&t.topTimestamp<=n.timestamp&&n.timestamp<=t.botomTimestamp&&t.chatTab.contains(n)&&t.changeDetector.markForCheck()})}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.scrollEventShortTimer=new nk(function(){return e.lazyScrollUpdate()},33),e.scrollEventLongTimer=new nk(function(){return e.lazyScrollUpdate(!1)},66),e.onScroll(),e.panelService.scrollablePanel.addEventListener("scroll",e.callbackOnScroll,!1),e.panelService.scrollablePanel.addEventListener("scrolltobottom",e.callbackOnScrollToBottom,!1)})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}},{key:"ngOnChanges",value:function(){var e=this;Promise.resolve().then(function(){return e.resetMessages()})}},{key:"ngAfterViewChecked",value:function(){var e=this;this.topElm&&this.bottomElm&&this.ngZone.runOutsideAngular(function(){Promise.resolve().then(function(){return e.adjustScrollPosition()})})}},{key:"onMessageInit",value:function(){var e=this;null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(function(){e.addMessageEventTimer=setTimeout(function(){e.addMessageEventTimer=null,e.ngZone.run(function(){return e.onAddMessage.emit()})},0)})}},{key:"resetMessages",value:function(){var e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}},{key:"trackByChatMessage",value:function(e,t){return t.identifier}},{key:"adjustIndex",value:function(){var e=this.chatTab?this.chatTab.chatMessages:[],t=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),t<this.bottomIndex&&(this.bottomIndex=t),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),t<this.topIndex&&(this.topIndex=t),t<this.bottomIndex&&(this.bottomIndex=t)}},{key:"getScrollPosition",value:function(){var e=this.panelService.scrollablePanel.scrollTop,t=this.panelService.scrollablePanel.clientHeight,n=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),n-t<e&&(e=n-t),{top:e,bottom:e+t,clientHeight:t,scrollHeight:n}}},{key:"adjustScrollPosition",value:function(){var e=this;if(this.topElm&&this.bottomElm){var t=this.logContainerRef.nativeElement.contains(this.topElm),n=this.logContainerRef.nativeElement.contains(this.bottomElm),i=this.checkBlank(t,n),r=i.hasTopBlank,a=i.hasBotomBlank;this.topElm=this.bottomElm=null,(r||a||!t&&!n)&&qm(function(){return e.lazyScrollUpdate()})}}},{key:"checkBlank",value:function(e,t){var n=!e,i=!t;if(!e&&!t)return{hasTopBlank:n,hasBotomBlank:i};var r,a,o=null,s=null;t?(o=this.bottomElm,s=this.bottomElmBox):e&&(o=this.topElm,s=this.topElmBox),r=o.getBoundingClientRect(),a=s.top-r.top-this.scrollSpeed,n&&i||!(Math.pow(.5,2)<Math.pow(a,2))||(this.panelService.scrollablePanel.scrollTop-=a);var l=this.logContainerRef.nativeElement.getBoundingClientRect(),c=this.messageContainerRef.nativeElement.getBoundingClientRect(),u=c.top-l.top,h=u+c.height,d=this.getScrollPosition();return{hasTopBlank:n=d.top<u,hasBotomBlank:i=h<d.bottom&&d.bottom<d.scrollHeight}}},{key:"markForReadIfNeeded",value:function(){var e=this;if(this.chatTab.hasUnread){var t=this.getScrollPosition();t.scrollHeight<=t.bottom+100&&qm(function(){e.chatTab.markForRead(),e.changeDetector.markForCheck(),e.ngZone.run(function(){})})}}},{key:"onScroll",value:function(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}},{key:"lazyScrollUpdate",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();var n=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),i=this.messageContainerRef.nativeElement.offsetTop,r=i+this.messageContainerRef.nativeElement.clientHeight,a=this.topIndex,o=this.bottomIndex,s=this.getScrollPosition();this.scrollSpeed=s.top-this.preScrollTop,this.preScrollTop=s.top;var l=s.top<i,c=r<s.bottom&&s.bottom<s.scrollHeight;if(t||this.scrollEventShortTimer.reset(),t||l||c){var u=s.top-(!t&&l?100:1200),h=s.bottom+(!t&&c?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(i,r,u,h,s,n),(this.topIndex!=a||this.bottomIndex!=o)&&(this.needUpdate=!0,this.topElm=n[0],this.bottomElm=n[n.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),qm(function(){var t=e.getScrollPosition();e.scrollSpeed=t.top-e.preScrollTop,e.preScrollTop=t.top,e.changeDetector.markForCheck(),e.ngZone.run(function(){})}))}}},{key:"calcElementMaxHeight",value:function(e){for(var t=this.minMessageHeight,n=e.length-1;0<=n;n--){var i=e[n].clientHeight;t<i&&(t=i)}return t}},{key:"calcItemIndexRange",value:function(e,t,n,i,r,a){if(n>=t||e>=i)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((r.scrollHeight-r.top-r.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(r.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{var o=this.calcElementMaxHeight(a);n<e?this.topIndex-=Math.floor((e-n)/o)+1:n>e&&(iM||(this.topIndex+=Math.floor((n-e)/o))),t>i?iM||(this.bottomIndex-=Math.floor((t-i)/o)):t<i&&(this.bottomIndex+=Math.floor((i-t)/o)+1)}this.adjustIndex()}}]),e}()).\u0275fac=function(e){return new(e||tM)(Vo($c),Vo(Dl),Vo(Wk))},tM.\u0275cmp=ct({type:tM,selectors:[["chat-tab"]],viewQuery:function(e,t){var n;1&e&&(Sc(qI,3),Sc(XI,3)),2&e&&(Ec(n=Tc())&&(t.logContainerRef=n.first),Ec(n=Tc())&&(t.messageContainerRef=n.first))},inputs:{chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[It],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage",4,"ngIf"],[3,"chatMessage"],[3,"chatMessage",4,"ngFor","ngForOf"]],template:function(e,t){1&e&&(Zo(0,"div",0,1),Zo(2,"div",2,3),Uo(4,QI,2,2,"ng-container",4),Uo(5,eM,2,1,"ng-container",4),Yo(),Yo()),2&e&&(ks("min-height",t.minScrollHeight,"px"),sa(2),ks("margin-bottom",t.bottomSpace,"px"),sa(2),Wo("ngIf",0<t.chatMessages.length),sa(1),Wo("ngIf",t.chatMessages.length<=0))},directives:[dh,uh,YI],styles:[".log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),tM);function aM(e,t){if(1&e){var n=Qo();Zo(0,"chat-tab",10),es("onAddMessage",function(){return Jt(n),is().scrollToBottom()}),Yo()}2&e&&Wo("chatTab",is().chatTab)}function oM(e,t){1&e&&(Zo(0,"div"),zs(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),Yo())}function sM(e,t){1&e&&qo(0,"badge",13),2&e&&Wo("count",is().$implicit.unreadLength)}function lM(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",11),es("ngModelChange",function(e){return Jt(n),is().chatTabidentifier=e}),Yo(),Zo(2,"div"),zs(3),Uo(4,sM,1,1,"badge",12),Yo(),Yo()}if(2&e){var i=t.$implicit,r=is();sa(1),ss("value",i.identifier),Wo("ngModel",r.chatTabidentifier),sa(2),Ls(i.name),sa(1),Wo("ngIf",i.hasUnread)}}var cM,uM=((cM=function(){function e(t,n,i){y(this,e),this.chatMessageService=t,this.panelService=n,this.pointerDeviceService=i,this.sendFrom="Guest",this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}return k(e,[{key:"gameType",get:function(){return this.chatMessageService.gameType},set:function(e){this.chatMessageService.gameType=e}},{key:"chatTabidentifier",get:function(){return this._chatTabidentifier},set:function(e){var t=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),t&&this.scrollToBottom(!0)}},{key:"chatTab",get:function(){return tk.instance.get(this.chatTabidentifier)}},{key:"ngOnInit",value:function(){var e=this;this.sendFrom=Rk.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Jb.register(this).on("MESSAGE_ADDED",function(t){if(t.data.tabIdentifier===e.chatTabidentifier){var n=tk.instance.get(t.data.messageIdentifier);n&&n.isSendFromSelf?e.isAutoScroll=!0:e.checkAutoScroll(),e.isAutoScroll&&e.chatTab&&e.chatTab.markForRead()}}),Promise.resolve().then(function(){return e.updatePanelTitle()})}},{key:"ngAfterViewInit",value:function(){this.scrollToBottom(!0)}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"scrollToBottom",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t&&(this.isAutoScroll=!0),null==this.scrollToBottomTimer&&this.isAutoScroll&&(this.scrollToBottomTimer=setTimeout(function(){if(e.chatTab&&e.chatTab.markForRead(),e.scrollToBottomTimer=null,e.isAutoScroll=!1,e.panelService.scrollablePanel){e.panelService.scrollablePanel.scrollTop=e.panelService.scrollablePanel.scrollHeight;var t=new CustomEvent("scrolltobottom",{});e.panelService.scrollablePanel.dispatchEvent(t)}},0))}},{key:"checkAutoScroll",value:function(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}},{key:"updatePanelTitle",value:function(){this.panelService.title=this.chatTab?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}},{key:"onSelectedTab",value:function(e){this.updatePanelTitle()}},{key:"showTabSetting",value:function(){var e=this.pointerDeviceService.pointers[0];this.panelService.open(TI,{left:e.x-250,top:e.y-175,width:500,height:350}).selectedTab=this.chatTab}},{key:"sendChat",value:function(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}},{key:"trackByChatTab",value:function(e,t){return t.identifier}}]),e}()).\u0275fac=function(e){return new(e||cM)(Vo(Yx),Vo(Wk),Vo(DC))},cM.\u0275cmp=ct({type:cM,selectors:[["chat-window"]],decls:13,vars:7,consts:[[1,"component"],[1,"log"],[3,"chatTab","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","onAddMessage"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"div",1),Uo(2,aM,1,1,"chat-tab",2),Uo(3,oM,2,0,"div",3),Yo(),Zo(4,"div",4),Zo(5,"form"),Zo(6,"div",5),Uo(7,lM,5,4,"label",6),Zo(8,"button",7),es("click",function(){return t.showTabSetting()}),Zo(9,"i",8),zs(10,"settings"),Yo(),zs(11,"\u30bf\u30d6\u8a2d\u5b9a"),Yo(),Yo(),Yo(),Zo(12,"chat-input",9),es("gameTypeChange",function(e){return t.gameType=e})("sendFromChange",function(e){return t.sendFrom=e})("chat",function(e){return t.sendChat(e)}),Yo(),Yo(),Yo()),2&e&&(sa(2),Wo("ngIf",t.chatTab),sa(1),Wo("ngIf",!t.chatTab),sa(4),Wo("ngForOf",t.chatMessageService.chatTabs)("ngForTrackBy",t.trackByChatTab),sa(5),Wo("chatTabidentifier",t.chatTabidentifier)("gameType",t.gameType)("sendFrom",t.sendFrom))},directives:[dh,Sf,Kd,wf,uh,eI,rM,Pf,Ed,Xd,Ef,Nm],styles:[".loop-anime[_ngcontent-%COMP%]{-webkit-animation:anime1 1.3s ease-in-out infinite;animation:anime1 1.3s ease-in-out infinite}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:rgba(240,218,189,.8);border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:1px solid #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}"]}),cM),hM=["root"],dM=["altitudeSlider"];function fM(e,t){if(1&e){var n=Qo();Zo(0,"span",12),zs(1," (\u9ad8\u5ea6 "),Zo(2,"input",13),es("ngModelChange",function(e){return Jt(n),is(2).altitudeHande.altitude=e}),Yo(),zs(3,")"),Yo()}if(2&e){var i=is(2);sa(2),Wo("ngModel",i.altitudeHande.altitude)}}function pM(e,t){if(1&e&&(Zo(0,"div"),Zo(1,"div",10),zs(2),Uo(3,fM,4,1,"span",11),Yo(),Yo()),2&e){var n=is();sa(1),ks("color",n.titleColor)("font-weight",n.titleBold?"bolder":"normal"),sa(1),Ls(n.title),sa(1),Wo("ngIf",n.altitudeHande)}}function gM(e,t){1&e&&(Zo(0,"div",14),Zo(1,"div",15),zs(2,"\u9ad8"),Yo(),Zo(3,"div",16),zs(4,"0"),Yo(),Zo(5,"div",17),zs(6,"\u4f4e"),Yo(),Yo())}function mM(e,t){if(1&e){var n=Qo();Zo(0,"div",18),Zo(1,"input",19,20),es("ngModelChange",function(e){return Jt(n),is().altitudeHande.altitude=e}),Yo(),Yo()}if(2&e){var i=is();sa(1),ss("title",i.altitudeHande.altitude),Wo("ngModel",i.altitudeHande.altitude)}}function vM(e,t){1&e&&$o(0)}var yM=function(e){return{action:e}};function bM(e,t){if(1&e&&(Xo(0),Uo(1,vM,1,0,"ng-container",21),Ko()),2&e){var n=is().$implicit;is();var i=Ho(12),r=Ho(10);sa(1),Wo("ngTemplateOutlet","separator"===(null==n?null:n.type)?i:r)("ngTemplateOutletContext",rc(2,yM,n))}}function kM(e,t){if(1&e&&(Xo(0),Uo(1,bM,2,4,"ng-container",2),Ko()),2&e){var n=t.$implicit;sa(1),Wo("ngIf",n)}}function _M(e,t){1&e&&(Zo(0,"span",42),zs(1,"\u26a0\ufe0f"),Yo()),2&e&&ss("title",is().action.error)}function wM(e,t){1&e&&qo(0,"input",43),2&e&&Wo("disabled",is().action.disabled)}function xM(e,t){1&e&&qo(0,"input",44),2&e&&Wo("disabled",is().action.disabled)}function CM(e,t){1&e&&qo(0,"input",45),2&e&&Wo("disabled",is().action.disabled)}function EM(e,t){1&e&&qo(0,"input",46),2&e&&Wo("disabled",is().action.disabled)}function SM(e,t){1&e&&(Zo(0,"span",47),zs(1,"\u25a0"),Yo())}function TM(e,t){1&e&&(Zo(0,"span",48),zs(1,"\u25a0"),Yo())}function OM(e,t){1&e&&(Zo(0,"span",49),zs(1,"\u25a0"),Yo())}function IM(e,t){1&e&&(Zo(0,"span",50),zs(1,"\u25a0"),Yo())}function MM(e,t){1&e&&(Zo(0,"span",51),zs(1,"\u25a0"),Yo())}function AM(e,t){1&e&&(Zo(0,"span",52),zs(1,"\u25a0"),Yo())}function PM(e,t){1&e&&(Zo(0,"span",53),zs(1,"\u25a0"),Yo())}function DM(e,t){1&e&&(Zo(0,"span",54),zs(1,"\u25a0"),Yo())}function RM(e,t){if(1&e&&(Zo(0,"span",55),Zo(1,"i",56),zs(2),Yo(),Yo()),2&e){var n=is().action;sa(2),Ls(n.materialIcon)}}function FM(e,t){if(1&e&&(Zo(0,"span",57),qo(1,"img",58),hc(2,"safe"),Yo()),2&e){var n=is().action;sa(1),Wo("src",dc(2,1,n.icon.url,"resourceUrl"),dr)}}function NM(e,t){1&e&&(Zo(0,"i",59),zs(1,"open_in_new"),Yo())}function zM(e,t){1&e&&(Zo(0,"div",60),Zo(1,"i",61),zs(2,"arrow_forward_ios"),Yo(),Yo())}function LM(e,t){if(1&e&&qo(0,"context-menu",62),2&e){var n=is().action,i=is();Wo("title",n.name)("actions",i.subMenu)("isSubmenu",!0)}}var BM=function(e,t){return{hasHighlight:e,disabled:t}},jM=function(e,t){return{"icon-menu":e,default:t}};function UM(e,t){if(1&e){var n=Qo();Zo(0,"li",22),es("click",function(){Jt(n);var e=t.action,i=is();return!(e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)&&i.doAction(e)})("mouseenter",function(){Jt(n);var e=t.action,i=is();return!(e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)&&i.showSubMenu(e)}),Zo(1,"div",23),Uo(2,_M,2,1,"span",24),Uo(3,wM,1,1,"input",25),Uo(4,xM,1,1,"input",26),Uo(5,CM,1,1,"input",27),Uo(6,EM,1,1,"input",28),Uo(7,SM,2,0,"span",29),Uo(8,TM,2,0,"span",30),Uo(9,OM,2,0,"span",31),Uo(10,IM,2,0,"span",32),Uo(11,MM,2,0,"span",33),Uo(12,AM,2,0,"span",34),Uo(13,PM,2,0,"span",35),Uo(14,DM,2,0,"span",36),Uo(15,RM,3,1,"span",37),zs(16),Uo(17,FM,3,4,"span",38),Uo(18,NM,2,0,"i",39),Yo(),Uo(19,zM,3,0,"div",40),Uo(20,LM,1,3,"context-menu",41),Yo()}if(2&e){var i=t.action,r=is();Wo("ngClass",ac(21,BM,!(i.disabled||i.icon||i.altitudeHande&&0==i.altitudeHande.altitude),i.disabled||i.altitudeHande&&0==i.altitudeHande.altitude)),sa(1),Wo("ngClass",ac(24,jM,i.icon,i.default)),sa(1),Wo("ngIf",i.error),sa(1),Wo("ngIf",i.name&&0==i.name.indexOf("\u2611")),sa(1),Wo("ngIf",i.name&&0==i.name.indexOf("\u2610")),sa(1),Wo("ngIf",i.name&&0==i.name.indexOf("\u25c9")),sa(1),Wo("ngIf",i.name&&0==i.name.indexOf("\u25cb")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30d6\u30e9\u30c3\u30af")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30d6\u30eb\u30fc")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30b7\u30a2\u30f3")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30ec\u30c3\u30c9")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30de\u30bc\u30f3\u30bf")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),sa(1),Wo("ngIf",i.name&&2==i.name.indexOf("\u30db\u30ef\u30a4\u30c8")),sa(1),Wo("ngIf",i.materialIcon),sa(1),Bs(" ",i.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb","")," "),sa(1),Wo("ngIf",i.icon&&0<(null==i.icon?null:i.icon.url.length)),sa(1),Wo("ngIf",i.isOuterLink),sa(1),Wo("ngIf",i.subActions&&!i.disabled),sa(1),Wo("ngIf",r.subMenu&&r.parentMenu===i)}}function HM(e,t){1&e&&(Zo(0,"li"),qo(1,"hr",63),Yo())}var VM,WM,GM=function(e,t,n,i){return{"icons-panel":e,"submenu-panel":t,"is-max-limit":n,"pointer-events-none":i}},ZM=((WM=function(){function e(t,n,i){var r=this;y(this,e),this.elementRef=t,this.contextMenuService=n,this.pointerDeviceService=i,this.title="",this.actions=[],this.titleColor=Rk.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=function(e){return r.onOutsideClick(e)}}return k(e,[{key:"isPointerDragging",get:function(){return this.pointerDeviceService.isDragging}},{key:"altitudeHande",get:function(){var e,t=a(this.actions);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(n&&n.altitudeHande)return n.altitudeHande}}catch(i){t.e(i)}finally{t.f()}return null}},{key:"isIconsMenu",get:function(){var e,t=a(this.actions);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(!n||!n.icon)return!1}}catch(i){t.e(i)}finally{t.f()}return!0}},{key:"ngOnInit",value:function(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}},{key:"ngAfterViewInit",value:function(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}},{key:"ngOnDestroy",value:function(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}},{key:"onOutsideClick",value:function(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}},{key:"onContextMenu",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"adjustPositionRoot",value:function(){var e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";var t=e.getBoundingClientRect(),n=0,i=0;window.innerWidth<t.right+n&&(n+=window.innerWidth-(t.right+n)),t.left+n<0&&(n+=0-(t.left+n)),window.innerHeight<t.bottom+i&&(i+=window.innerHeight-(t.bottom+i)),t.top+i<0&&(i+=0-(t.top+i)),e.style.left=e.offsetLeft+n+"px",e.style.top=e.offsetTop+i+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}},{key:"adjustPositionSub",value:function(){var e=this.rootElementRef.nativeElement,t=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),n=e.getBoundingClientRect(),i=0,r=0;window.innerWidth<n.right+i&&(i-=t.width+n.width,i+=8),n.left+i<0&&(i+=0-(n.left+i)),window.innerHeight<n.bottom+r&&(r+=window.innerHeight-(n.bottom+r)),n.top+r<0&&(r+=0-(n.top+r)),e.style.left=e.offsetLeft+i+"px",e.style.top=e.offsetTop+r+"px"}},{key:"doAction",value:function(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}},{key:"showSubMenu",value:function(e){var t=this;this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),null==e.subActions||e.subActions.length<1||(this.showSubMenuTimer=setTimeout(function(){t.parentMenu=e,t.subMenu=e.subActions,clearTimeout(t.hideSubMenuTimer)},250))}},{key:"hideSubMenu",value:function(){var e=this;clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(function(){e.subMenu=null},1200)}},{key:"close",value:function(){this.contextMenuService&&this.contextMenuService.close()}}]),e}()).\u0275fac=function(e){return new(e||WM)(Vo(ll),Vo(xw),Vo(DC))},WM.\u0275cmp=ct({type:WM,selectors:[["context-menu"]],viewQuery:function(e,t){var n;1&e&&(Sc(hM,3),Sc(dM,1)),2&e&&(Ec(n=Tc())&&(t.rootElementRef=n.first),Ec(n=Tc())&&(t.altitudeSlider=n.first))},hostBindings:function(e,t){1&e&&es("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,t){1&e&&(Zo(0,"div",0,1),es("mouseleave",function(){return t.hideSubMenu()}),Uo(2,pM,4,6,"div",2),Zo(3,"div",3),Uo(4,gM,7,0,"div",4),Uo(5,mM,3,2,"div",5),Zo(6,"div",6),Zo(7,"ul"),Uo(8,kM,2,1,"ng-container",7),Yo(),Yo(),Yo(),Yo(),Uo(9,UM,21,27,"ng-template",null,8,Ic),Uo(11,HM,2,0,"ng-template",null,9,Ic)),2&e&&(Wo("ngClass",sc(5,GM,t.isIconsMenu,t.isSubmenu,!t.isSubmenu,t.isPointerDragging)),sa(2),Wo("ngIf",!t.isIconsMenu&&0<t.title.length||t.altitudeHande),sa(2),Wo("ngIf",t.altitudeHande),sa(1),Wo("ngIf",t.altitudeHande),sa(3),Wo("ngForOf",t.actions))},directives:[lh,dh,uh,Of,Ed,Xd,Ef,Rf,Th,WM],pipes:[Lw],styles:[".component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:9900}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #aaa}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:rgba(30,30,30,.8)}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%]{color:grey}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted red;z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,-1px -1px 0 #fff,1px 0 0 #fff,0 1px 0 #fff,-1px 0 0 #fff,0 -1px 0 #fff;margin-right:-.2rem}"]}),WM),YM=((VM=function(){function e(t,n,i){y(this,e),this.viewContainerRef=t,this.modalService=n,this.panelService=i,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Wm.createEmpty("null")}return k(e,[{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"}),Jb.register(this).on("SELECT_FILE",function(t){console.log("SELECT_FILE GameCharacterGeneratorComponent "+t.data.fileIdentifier);var n=Dk.instance.get(t.data.fileIdentifier);n&&(e.tableBackgroundImage=n)})}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"createGameCharacter",value:function(){jk.create(this.name,this.size,this.tableBackgroundImage.identifier)}},{key:"createGameTableMask",value:function(){var e=tk.instance.get("tableSelecter").viewTable;if(e){var t=KC.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(t)}}},{key:"createGameCharacterForXML",value:function(e){lk.instance.parseXml(e)}},{key:"openModal",value:function(){this.modalService.open(Sx)}}]),e}()).\u0275fac=function(e){return new(e||VM)(Vo(Vl),Vo(Zk),Vo(Wk))},VM.\u0275cmp=ct({type:VM,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,t){1&e&&(Zo(0,"button",0),es("click",function(){return t.openModal()}),zs(1,"\u753b\u50cf\u3092\u9078\u3076"),Yo(),Zo(2,"div"),qo(3,"img",1),hc(4,"safe"),Yo(),Zo(5,"input",2),es("ngModelChange",function(e){return t.name=e}),Yo(),Zo(6,"div"),Zo(7,"div"),Zo(8,"input",3),es("ngModelChange",function(e){return t.size=e}),Yo(),zs(9," Size : "),Zo(10,"input",4),es("ngModelChange",function(e){return t.size=e}),Yo(),Yo(),Zo(11,"button",0),es("click",function(){return t.createGameCharacter()}),zs(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),Yo(),Zo(13,"button",0),es("click",function(){return t.createGameTableMask()}),zs(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),Yo(),Yo()),2&e&&(sa(3),Wo("src",dc(4,9,t.tableBackgroundImage.url,"resourceUrl"),dr),sa(2),Wo("ngModel",t.name),sa(3),ss("title",t.size),ss("min",t.minSize),ss("max",t.maxSize),Wo("ngModel",t.size),sa(2),ss("min",t.minSize),ss("max",t.maxSize),Wo("ngModel",t.size))},directives:[Ed,Xd,Ef,Rf,Of],pipes:[Lw],styles:[""]}),VM);function qM(e,t){1&e&&$o(0)}function XM(e,t){1&e&&$o(0)}function KM(e,t){if(1&e&&(Zo(0,"div"),zs(1),Yo()),2&e){var n=is();sa(1),Bs("",n.getTabTitle(n.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function $M(e,t){1&e&&$o(0)}var QM=function(e){return{box:!0,selected:e}},JM=function(e){return{gameObject:e}};function eA(e,t){if(1&e){var n=Qo();Zo(0,"div",9),es("contextmenu",function(e){Jt(n);var i=t.$implicit;return is().onContextMenu(e,i)})("click",function(){Jt(n);var e=t.$implicit;return is().selectGameObject(e)}),Uo(1,$M,1,0,"ng-container",10),Yo()}if(2&e){var i=t.$implicit,r=is(),a=Ho(11);Wo("ngClass",rc(3,QM,r.selectedIdentifier===i.identifier)),sa(1),Wo("ngTemplateOutlet",a)("ngTemplateOutletContext",rc(5,JM,i))}}function tA(e,t){if(1&e){var n=Qo();Zo(0,"div",11),Zo(1,"button",12),es("click",function(){return Jt(n),is().cleanInventory()}),zs(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),Yo(),Yo()}if(2&e){var i=is();sa(1),Lo("disabled",i.getGameObjects(i.selectTab).length<1?"":null)}}function nA(e,t){if(1&e){var n=Qo();Zo(0,"label"),Zo(1,"input",16),es("ngModelChange",function(e){return Jt(n),is(2).selectTab=e}),Yo(),Zo(2,"div"),zs(3),Yo(),Yo()}if(2&e){var i=t.$implicit,r=is(2);sa(1),ss("value",i),Wo("ngModel",r.selectTab),sa(2),js("",r.getTabTitle(i)," (",r.getGameObjects(i).length,")")}}function iA(e,t){if(1&e&&(Zo(0,"form",13),Zo(1,"div",14),Uo(2,nA,4,4,"label",15),Yo(),Yo()),2&e){var n=is();sa(2),Wo("ngForOf",n.inventoryTypes)}}function rA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div"),Zo(2,"div",17),zs(3,"\u4e26\u3073\u9806"),Yo(),Zo(4,"input",18),es("ngModelChange",function(e){return Jt(n),is(2).sortTag=e}),Yo(),Zo(5,"select",19),es("ngModelChange",function(e){return Jt(n),is(2).sortOrder=e}),Zo(6,"option",20),zs(7,"\u6607\u9806"),Yo(),Zo(8,"option",21),zs(9,"\u964d\u9806"),Yo(),Yo(),Yo(),Zo(10,"div",22),zs(11,"\u8868\u793a\u9805\u76ee"),Yo(),Zo(12,"input",23),es("ngModelChange",function(e){return Jt(n),is(2).dataTag=e}),Yo(),Zo(13,"div",11),Zo(14,"button",24),es("click",function(){return Jt(n),is(2).toggleEdit()}),Zo(15,"i",25),zs(16,"settings"),Yo(),zs(17,"\u5b8c\u4e86"),Yo(),Yo(),Ko()}if(2&e){var i=is(2);sa(4),Wo("ngModel",i.sortTag),sa(1),Wo("ngModel",i.sortOrder),sa(7),Wo("ngModel",i.dataTag)}}function aA(e,t){if(1&e&&(Xo(0),zs(1),Ko()),2&e){var n=is(3);sa(1),js("",n.sortTag," (",n.sortOrderName,")")}}function oA(e,t){1&e&&(Xo(0),zs(1,"-"),Ko())}function sA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"label"),Zo(2,"input",28),es("ngModelChange",function(e){return Jt(n),is(3).indicateAll=e}),Yo(),zs(3,"\u3059\u3079\u3066\u8868\u793a"),Yo(),Ko()}if(2&e){var i=is(3);sa(2),Wo("ngModel",i.indicateAll)}}function lA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"table",26),Zo(2,"tr"),Zo(3,"th",27),zs(4,"\u4e26\u3073\u9806:"),Yo(),Zo(5,"td",27),Uo(6,aA,2,2,"ng-container",2),Uo(7,oA,2,0,"ng-container",2),Yo(),Zo(8,"td"),Uo(9,sA,4,1,"ng-container",2),Zo(10,"button",24),es("click",function(){return Jt(n),is(2).toggleEdit()}),Zo(11,"i",25),zs(12,"settings"),Yo(),zs(13,"\u8a2d\u5b9a"),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2);sa(6),Wo("ngIf",0<i.sortTag.length),sa(1),Wo("ngIf",i.sortTag.length<1),sa(2),Wo("ngIf","table"===i.selectTab)}}function cA(e,t){if(1&e&&(Uo(0,rA,18,3,"ng-container",2),Uo(1,lA,14,3,"ng-container",2)),2&e){var n=is();Wo("ngIf",n.isEdit),sa(1),Wo("ngIf",!n.isEdit)}}function uA(e,t){if(1&e&&(Zo(0,"i",48),qo(1,"img",49),hc(2,"safe"),Yo()),2&e){var n=is().gameObject;sa(1),Wo("src",dc(2,1,n.faceIcon.url,"resourceUrl"),dr)}}function hA(e,t){1&e&&(Zo(0,"i",37),zs(1,"emoji_emotions"),Yo())}var dA=function(e){return{opacity:e}};function fA(e,t){if(1&e&&(Zo(0,"i",48),qo(1,"img",50),hc(2,"safe"),Yo()),2&e){var n=is().gameObject;sa(1),Wo("ngStyle",rc(5,dA,n.isDropShadow?.7:.3))("src",dc(2,2,n.shadowImageFile.url,"resourceUrl"),dr)}}function pA(e,t){if(1&e&&(Zo(0,"i",37),zs(1),Yo()),2&e){var n=is().gameObject;sa(1),Ls(n.isDropShadow?"star_half":"star_border")}}function gA(e,t){if(1&e){var n=Qo();Zo(0,"button",51),es("click",function(e){Jt(n);var t=is().gameObject;return is().onContextMenu(e,t)}),Zo(1,"i",37),zs(2,"settings"),Yo(),Yo()}}var mA=function(e,t,n){return{inverse:e,hollow:t,"black-paint":n}};function vA(e,t){if(1&e&&(qo(0,"img",52),hc(1,"safe")),2&e){var n=is().gameObject;Wo("src",dc(1,2,n.imageFile.url,"resourceUrl"),dr)("ngClass",oc(5,mA,n.isInverse,n.isHollow,n.isBlackPaint))}}function yA(e,t){1&e&&$o(0)}var bA=function(e,t){return{dataElm:e,name:t}};function kA(e,t){if(1&e&&(Xo(0),Uo(1,yA,1,0,"ng-container",10),Ko()),2&e){var n=t.$implicit,i=is(2).gameObject;is();var r=Ho(13);sa(1),Wo("ngTemplateOutlet",r)("ngTemplateOutletContext",ac(2,bA,n,i.name))}}function _A(e,t){if(1&e&&(Zo(0,"div"),Uo(1,kA,2,5,"ng-container",53),Yo()),2&e){var n=is().gameObject,i=is();sa(1),Wo("ngForOf",i.getInventoryTags(n))("ngForTrackBy",i.trackByGameObject)}}var wA=function(e){return{"is-active":e}},xA=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}};function CA(e,t){if(1&e&&(Zo(0,"div",29),Zo(1,"div",30),Zo(2,"button",31),es("click",function(){var e=t.gameObject;return e.isUseIconToOverviewImage=!e.isUseIconToOverviewImage}),Uo(3,uA,3,4,"i",32),Uo(4,hA,2,0,"ng-template",null,33,Ic),Yo(),zs(6),Zo(7,"button",34),es("click",function(){var e=t.gameObject;return e.isDropShadow=!e.isDropShadow}),Uo(8,fA,3,7,"i",32),Uo(9,pA,2,1,"ng-template",null,35,Ic),Yo(),Zo(11,"button",36),es("click",function(){var e=t.gameObject;return e.isNotRide=!e.isNotRide}),Zo(12,"i",37),zs(13),Yo(),Yo(),Zo(14,"button",38),es("click",function(){var e=t.gameObject;return e.isAltitudeIndicate=!e.isAltitudeIndicate}),Zo(15,"i",39),zs(16,"straighten"),Yo(),Zo(17,"span",40),zs(18),Yo(),Yo(),Zo(19,"button",41),es("click",function(){var e=t.gameObject;return e.isInventoryIndicate=!e.isInventoryIndicate}),Zo(20,"i",37),zs(21,"all_inbox"),Yo(),Yo(),Uo(22,gA,3,0,"button",42),Yo(),Zo(23,"div",43),Zo(24,"div",44),Zo(25,"span",45),Uo(26,vA,2,9,"img",46),Yo(),Yo(),Zo(27,"div",47),Uo(28,_A,2,2,"div",2),Yo(),Yo(),Yo()),2&e){var n=t.gameObject,i=Ho(5),r=Ho(10),a=is();sa(2),Wo("disabled",a.selectedIdentifier!==n.identifier)("ngClass",rc(21,wA,n.isUseIconToOverviewImage)),sa(1),Wo("ngIf",n.faceIcon&&0<(null==n.faceIcon?null:n.faceIcon.url.length))("ngIfElse",i),sa(3),Bs(" ",n.name," "),sa(1),Wo("disabled",a.selectedIdentifier!==n.identifier)("ngClass",rc(23,wA,n.isDropShadow)),sa(1),Wo("ngIf",n.shadowImageFile&&0<n.shadowImageFile.url.length)("ngIfElse",r),sa(3),Wo("disabled",a.selectedIdentifier!==n.identifier)("ngClass",rc(25,wA,!n.isNotRide)),sa(2),Ls(n.isNotRide?"directions_run":"directions_bike"),sa(1),Wo("disabled",a.selectedIdentifier!==n.identifier)("ngClass",rc(27,wA,n.isAltitudeIndicate)),sa(4),Ls(n.altitude),sa(1),Wo("disabled",a.selectedIdentifier!==n.identifier)("ngClass",rc(29,wA,n.isInventoryIndicate)),sa(3),Wo("ngIf",a.selectedIdentifier===n.identifier),sa(3),Wo("ngClass",lc(31,xA,0==n.aura,1==n.aura,2==n.aura,3==n.aura,4==n.aura,5==n.aura,6==n.aura,7==n.aura)),sa(1),Wo("ngIf",n.imageFile.url),sa(2),Wo("ngIf",n.rootDataElement)}}function EA(e,t){1&e&&(Xo(0),qo(1,"br"),Ko())}function SA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",59),zs(2),Yo(),Zo(3,"div",60),Zo(4,"div",61),Zo(5,"div",62),Zo(6,"div",63),zs(7),Yo(),Zo(8,"input",64),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(2),Ls(i.name),sa(5),Ls(i.value),sa(1),ss("type",i.value&&i.value==+i.value?"number":"text"),Wo("ngModel",i.value)}}var TA=function(){return{"background-color":"green"}};function OA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",65),Zo(2,"div",66),zs(3),Yo(),Zo(4,"input",67),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.currentValue=e}),Yo(),Yo(),Zo(5,"div",65),Zo(6,"input",68),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.currentValue=e}),hc(7,"safe"),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(3),Ls(i.name),sa(1),Wo("ngModel",i.currentValue),sa(2),ws(dc(7,8,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),ss("title",i.currentValue),ss("max",+i.value?i.value:1e3),Wo("ngStyle",ic(11,TA))("ngModel",i.currentValue)}}function IA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",59),zs(2),Yo(),Zo(3,"div",60),Zo(4,"div",61),Zo(5,"div",62),Zo(6,"input",69),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e})("change",function(){Jt(n);var e=is(2).dataElm;return e.value=e.value?e.name:""}),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(1),ks("text-decoration",i.value?"none":"line-through"),sa(1),Ls(i.name),sa(4),ss("checked",i.value?"checked":""),Wo("ngModel",i.value)}}function MA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",59),zs(2),Yo(),Zo(3,"div",60),Zo(4,"div",61),Zo(5,"div",62),Zo(6,"div",63),zs(7),Yo(),Zo(8,"input",64),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Zo(9,"span",70),zs(10),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(2),Ls(i.name),sa(5),Ls(i.value),sa(1),ss("type",i.value&&i.value==+i.value?"number":"text"),Wo("ngModel",i.value),sa(2),Bs("(",(i.calcAbilityScore()>=0?"+":"")+i.calcAbilityScore(),")")}}function AA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",59),zs(2),Yo(),Zo(3,"div",60),Zo(4,"div",61),Zo(5,"div",71),Zo(6,"div",63),zs(7),Yo(),Zo(8,"input",72),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Zo(9,"button",73),es("click",function(){Jt(n);var e=is(2),t=e.dataElm,i=e.name,r=is();return!!r.stringUtil.validUrl(t.value)&&r.openUrl(t.value,i,t.name)}),Zo(10,"i",74),zs(11),Yo(),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm,r=is();sa(2),Ls(i.name),sa(5),Ls(i.value),sa(1),Wo("ngModel",i.value),sa(1),Lo("disabled",r.stringUtil.validUrl(i.value)?null:""),sa(2),Ls(r.stringUtil.validUrl(i.value)?r.stringUtil.sameOrigin(i.value)?"link":"open_in_new":"link_off")}}function PA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",59),zs(2),Yo(),Zo(3,"div",60),Zo(4,"div",61),Zo(5,"div",62),Zo(6,"div",63),zs(7),Yo(),Zo(8,"input",75),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(2),Ls(i.name),sa(5),Ls(i.value),sa(1),ss("type","size"===i.name||"altitude"===i.name?"number":"text"),ss("min","size"===i.name?"0":""),Wo("ngModel",i.value)}}function DA(e,t){if(1&e&&(Zo(0,"div",55),Xo(1,56),Uo(2,SA,9,4,"ng-container",57),Uo(3,OA,8,12,"ng-container",57),Uo(4,IA,7,5,"ng-container",57),Uo(5,MA,11,5,"ng-container",57),Uo(6,AA,12,5,"ng-container",57),Uo(7,PA,9,5,"ng-container",58),Ko(),Yo()),2&e){var n=is().dataElm;sa(1),Wo("ngSwitch",n.attributes.type),sa(1),Wo("ngSwitchCase","simpleNumber"),sa(1),Wo("ngSwitchCase","numberResource"),sa(1),Wo("ngSwitchCase","checkProperty"),sa(1),Wo("ngSwitchCase","abilityScore"),sa(1),Wo("ngSwitchCase","url")}}function RA(e,t){if(1&e&&(Uo(0,EA,2,0,"ng-container",2),Uo(1,DA,8,6,"div",54)),2&e){var n=t.dataElm,i=is();Wo("ngIf",(null==n?null:n.name)===i.newLineString),sa(1),Wo("ngIf",n&&n.name!==i.newLineString)}}var FA,NA,zA=((FA=function(){function e(t,n,i,r,a,o){y(this,e),this.changeDetector=t,this.panelService=n,this.inventoryService=i,this.contextMenuService=r,this.pointerDeviceService=a,this.modalService=o,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=gk}return k(e,[{key:"sortTag",get:function(){return this.inventoryService.sortTag},set:function(e){this.inventoryService.sortTag=e}},{key:"sortOrder",get:function(){return this.inventoryService.sortOrder},set:function(e){this.inventoryService.sortOrder=e}},{key:"dataTag",get:function(){return this.inventoryService.dataTag},set:function(e){this.inventoryService.dataTag=e}},{key:"dataTags",get:function(){return this.inventoryService.dataTags}},{key:"indicateAll",get:function(){return this.inventoryService.indicateAll},set:function(e){this.inventoryService.indicateAll=e}},{key:"sortOrderName",get:function(){return this.sortOrder===qC.ASC?"\u6607\u9806":"\u964d\u9806"}},{key:"newLineString",get:function(){return this.inventoryService.newLineString}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"}),Jb.register(this).on("SELECT_TABLETOP_OBJECT",-1e3,function(t){tk.instance.get(t.data.identifier)instanceof zk&&(e.selectedIdentifier=t.data.identifier,e.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",function(t){t.isSendFromSelf&&e.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",function(t){t.isSendFromSelf&&e.changeDetector.markForCheck()}).on("OPEN_NETWORK",function(t){e.inventoryTypes=["table","common",ek.peerId,"graveyard"],e.inventoryTypes.includes(e.selectTab)||(e.selectTab=ek.peerId)}),this.inventoryTypes=["table","common",ek.peerId,"graveyard"]}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"getTabTitle",value:function(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case ek.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}},{key:"getInventory",value:function(e){switch(e){case"table":return this.inventoryService.tableInventory;case ek.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}},{key:"getGameObjects",value:function(e){var t=this;return this.getInventory(e).tabletopObjects.filter(function(n){return"table"!=e||t.indicateAll||n.isInventoryIndicate})}},{key:"getInventoryTags",value:function(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}},{key:"onContextMenu",value:function(e,t){var n=this;if(!(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type"))&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)){this.selectGameObject(t);var i=this.pointerDeviceService.pointers[0],r=[];t.imageFiles.length>1&&(r.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:t.imageFiles.map(function(e,n){return{name:t.currntImageIndex==n?"\u25c9":"\u25cb",action:function(){t.currntImageIndex=n,Mw.play(Iw.surprise),Jb.trigger("UPDATE_INVENTORY",null)},default:t.currntImageIndex==n,icon:e}})}),r.push(ww)),r.push(t.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:function(){t.isUseIconToOverviewImage=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:function(){t.isUseIconToOverviewImage=!0,Jb.trigger("UPDATE_INVENTORY",null)}}),r.push(t.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:function(){t.isDropShadow=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:function(){t.isDropShadow=!0,Jb.trigger("UPDATE_INVENTORY",null)}}),r.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[t.isInverse?{name:"\u2611 \u53cd\u8ee2",action:function(){t.isInverse=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:function(){t.isInverse=!0,Jb.trigger("UPDATE_INVENTORY",null)}},t.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:function(){t.isHollow=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:function(){t.isHollow=!0,Jb.trigger("UPDATE_INVENTORY",null)}},t.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:function(){t.isBlackPaint=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:function(){t.isBlackPaint=!0,Jb.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==t.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:function(){t.aura=-1,Jb.trigger("UPDATE_INVENTORY",null)}},ww].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map(function(e,n){return{name:"".concat(t.aura==n?"\u25c9":"\u25cb"," ").concat(e),action:function(){t.aura=n,Jb.trigger("UPDATE_INVENTORY",null)}}}))},ww,{name:"\u30ea\u30bb\u30c3\u30c8",action:function(){t.isInverse=!1,t.isHollow=!1,t.isBlackPaint=!1,t.aura=-1,Jb.trigger("UPDATE_INVENTORY",null)},disabled:!t.isInverse&&!t.isHollow&&!t.isBlackPaint&&-1==t.aura}]}),r.push(ww),r.push(t.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:function(){t.isNotRide=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:function(){t.isNotRide=!0,Jb.trigger("UPDATE_INVENTORY",null)}}),r.push(t.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!0,Jb.trigger("UPDATE_INVENTORY",null)}}),r.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:function(){0!=t.altitude&&(t.altitude=0,"table"===t.location.name&&Mw.play(Iw.sweep))},altitudeHande:t}),r.push(ww),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:function(){n.showDetail(t)}}),r.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:function(){n.showChatPalette(t)},disabled:"graveyard"===t.location.name}),r.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:function(){n.showStandSetting(t)}}),r.push(ww),r.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:t.getUrls().map(function(e){var i=e.value.toString();return{name:e.name?e.name:i,action:function(){gk.sameOrigin(i)?window.open(i.trim(),"_blank","noopener"):n.modalService.open(Jk,{url:i,title:t.name,subTitle:e.name})},disabled:!gk.validUrl(i),error:gk.validUrl(i)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(i)&&!gk.sameOrigin(i)}}),disabled:t.getUrls().length<=0}),r.push(ww),r.push(t.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:function(){t.isInventoryIndicate=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:function(){t.isInventoryIndicate=!0,Jb.trigger("UPDATE_INVENTORY",null)}});var a=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:ek.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];r.push({name:"".concat((a.find(function(e){return e.name==t.location.name})||a[1]).alias,"\u304b\u3089\u79fb\u52d5"),action:null,subActions:a.filter(function(e,n){return!(t.location.name==e.name||1==n&&!a.map(function(e){return e.name}).includes(t.location.name))}).map(function(e){return{name:"".concat(e.alias),action:function(){Jb.call("FAREWELL_STAND_IMAGE",{characterIdentifier:t.identifier}),t.setLocation(e.name),Mw.play("graveyard"==e.name?Iw.sweep:Iw.piecePut)}}})}),r.push(ww),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){n.cloneGameObject(t),Mw.play(Iw.piecePut)}}),"graveyard"===t.location.name&&r.push({name:"\u524a\u9664\u3059\u308b",action:function(){n.deleteGameObject(t),Mw.play(Iw.sweep)}}),this.contextMenuService.open(i,r,t.name)}}},{key:"toggleEdit",value:function(){this.isEdit=!this.isEdit}},{key:"cleanInventory",value:function(){var e=this.getTabTitle(this.selectTab),t=this.getGameObjects(this.selectTab);if(confirm("".concat(e,"\u306b\u5b58\u5728\u3059\u308b").concat(t.length,"\u500b\u306e\u8981\u7d20\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f"))){var n,i=a(t);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.deleteGameObject(r)}}catch(o){i.e(o)}finally{i.f()}Mw.play(Iw.sweep)}}},{key:"cloneGameObject",value:function(e){e.clone()}},{key:"showDetail",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-800,top:t.y-300,width:800,height:600}).tabletopObject=e}},{key:"showChatPalette",value:function(e){var t=this.pointerDeviceService.pointers[0];this.panelService.open(sC,{left:t.x-250,top:t.y-175,width:620,height:350}).character=e}},{key:"selectGameObject",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName})}},{key:"deleteGameObject",value:function(e){e.destroy(),this.changeDetector.markForCheck()}},{key:"showStandSetting",value:function(e){var t=this.pointerDeviceService.pointers[0];this.panelService.open(YC,{left:t.x-400,top:t.y-175,width:730,height:572}).character=e}},{key:"trackByGameObject",value:function(e,t){return t?t.identifier:e}},{key:"openUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;gk.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Jk,{url:e,title:t,subTitle:n})}}]),e}()).\u0275fac=function(e){return new(e||FA)(Vo(Dl),Vo(Wk),Vo(tI),Vo(xw),Vo(DC),Vo(Zk))},FA.\u0275cmp=ct({type:FA,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component"],[4,"ngTemplateOutlet"],[4,"ngIf"],[3,"ngClass","contextmenu","click",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[3,"ngClass","contextmenu","click"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],[2,"vertical-align","middle"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box"],[1,"table-cell","image-box"],[1,"aura",3,"ngClass"],["class","inverser",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["size","1","placeholder","",1,"input","tag-value",3,"type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModel","ngModelChange"],["type","range","min","0",3,"title","max","ngStyle","ngModel","ngModelChange"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[1,"tag-value-box",2,"white-space","nowrap"],["type","url","size","1","placeholder","https://example.com",1,"input","tag-value",2,"min-width","calc(6em - 2rem)","width","calc(100% - 2rem)","max-width","calc(100% - 2rem)",3,"ngModel","ngModelChange"],[1,"link",2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"type","min","ngModel","ngModelChange"]],template:function(e,t){if(1&e&&(Zo(0,"div",0),Uo(1,qM,1,0,"ng-container",1),Uo(2,XM,1,0,"ng-container",1),Uo(3,KM,2,1,"div",2),Uo(4,eA,2,7,"div",3),Uo(5,tA,3,1,"div",4),Yo(),Uo(6,iA,3,1,"ng-template",null,5,Ic),Uo(8,cA,2,2,"ng-template",null,6,Ic),Uo(10,CA,29,40,"ng-template",null,7,Ic),Uo(12,RA,2,2,"ng-template",null,8,Ic)),2&e){var n=Ho(7),i=Ho(9);sa(1),Wo("ngTemplateOutlet",n),sa(1),Wo("ngTemplateOutlet",i),sa(1),Wo("ngIf",t.getGameObjects(t.selectTab).length<1),sa(1),Wo("ngForOf",t.getGameObjects(t.selectTab))("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngIf","graveyard"===t.selectTab)}},directives:[Th,dh,uh,lh,Sf,Kd,wf,Pf,Ed,Xd,Ef,Bf,jf,$f,wd,Sh,xh,Ch,Eh,Of,Rf],pipes:[Lw],styles:[".component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border-left:2px solid transparent;border-bottom:2px solid transparent;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-color:transparent transparent #666;border-style:solid solid dotted;border-width:2px 2px 1px 6px}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #444}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:focus, input[type=number][_ngcontent-%COMP%]:hover{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color:transparent;--slider-fill-color:#555;--slider-border-color:#777;--slider-height:0.8em;--slider-thumb-size:1.0em;--range:calc(var(--max) - var(--min));--ratio:calc((var(--val) - var(--min))/var(--range));--sx:calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:1px solid var(--slider-border-color);border-bottom:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color);background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none;padding:0;border:1px solid #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:rgba(240,218,189,.9)}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:1px solid #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:1px solid #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.image-box[_ngcontent-%COMP%], .table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.3rem}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.5}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:grey}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.2rem}"],changeDetection:0}),FA),LA=Wm.create("./assets/images/skeleton.png"),BA=((NA=function(){function e(){y(this,e)}return k(e,[{key:"getSkeletonOr",value:function(e){var t=e instanceof Wm?e:Dk.instance.get(e);return t&&!t.isEmpty?t:LA}},{key:"getEmptyOr",value:function(e){var t=e instanceof Wm?e:Dk.instance.get(e);return t&&!t.isEmpty?t:Wm.Empty}}]),e}()).\u0275fac=function(e){return new(e||NA)},NA.\u0275prov=Ae({token:NA,factory:NA.\u0275fac,providedIn:"root"}),NA);function jA(e,t){if(1&e&&(Zo(0,"option",11),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n.identifier),sa(1),Ls(n.name)}}function UA(e,t){if(1&e&&(Zo(0,"div",38),Zo(1,"i",39),zs(2),Yo(),Yo()),2&e){var n=is(2);sa(1),Cs(n.isShowHideImages?"red-eye":"grow"),sa(1),Ls(n.isShowHideImages?"visibility":"visibility_off")}}function HA(e,t){if(1&e){var n=Qo();Zo(0,"div"),Zo(1,"button",40),es("click",function(){return Jt(n),is(2).openDistanceViewImageModal()}),zs(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),Yo(),Yo()}}function VA(e,t){if(1&e&&(Zo(0,"div",38),Zo(1,"i",39),zs(2),Yo(),Yo()),2&e){var n=is(3);sa(1),Cs(n.isShowHideImages?"red-eye":"grow"),sa(1),Ls(n.isShowHideImages?"visibility":"visibility_off")}}var WA=function(e){return{blackout:e}};function GA(e,t){if(1&e){var n=Qo();Zo(0,"div",13),es("click",function(){return Jt(n),is(2).openDistanceViewImageModal()}),Uo(1,VA,3,3,"div",14),qo(2,"img",15),hc(3,"safe"),Yo()}if(2&e){var i=is(2);sa(1),Wo("ngIf",i.getHidden(i.tableDistanceviewImage)),sa(1),Wo("ngClass",rc(6,WA,!i.isShowHideImages&&i.getHidden(i.tableDistanceviewImage)))("src",dc(3,3,i.tableDistanceviewImage.url,"resourceUrl"),dr)}}function ZA(e,t){if(1&e&&(Zo(0,"div",46),zs(1),Yo()),2&e){var n=is(3);sa(1),Bs("",n.progresPercent,"%")}}var YA=function(e){return{"is-hidden":e}};function qA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",41),es("click",function(){return Jt(n),is(2).save()}),Zo(2,"div",42),Zo(3,"div",43),zs(4,"\u4fdd\u5b58"),Yo(),Uo(5,ZA,2,1,"div",44),Yo(),Yo(),Zo(6,"button",45),es("click",function(){return Jt(n),is(2).delete()}),zs(7,"\u524a\u9664"),Yo(),Ko()}if(2&e){var i=is(2);sa(1),Wo("disabled",i.isSaveing),sa(2),Wo("ngClass",rc(4,YA,i.isSaveing)),sa(2),Wo("ngIf",i.isSaveing),sa(1),Lo("disabled",i.getGameTables().length<=1?"":null)}}function XA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",2),es("click",function(){return Jt(n),is(2).restore()}),zs(2,"\u5143\u306b\u623b\u3059"),Yo(),Ko()}}function KA(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",12),Zo(2,"div"),zs(3," \u753b\u50cf "),Zo(4,"div",13),es("click",function(){return Jt(n),is().openBgImageModal()}),Uo(5,UA,3,3,"div",14),qo(6,"img",15),hc(7,"safe"),Yo(),Yo(),Zo(8,"div"),zs(9," \u80cc\u666f "),Uo(10,HA,3,0,"div",10),Uo(11,GA,4,8,"div",16),Yo(),Yo(),Zo(12,"div"),zs(13,"Name : "),Zo(14,"input",17),es("ngModelChange",function(e){return Jt(n),is().tableName=e}),Yo(),Yo(),Zo(15,"div"),Zo(16,"input",18),es("ngModelChange",function(e){return Jt(n),is().tableWidth=e}),Yo(),zs(17," Width : "),Zo(18,"input",19),es("ngModelChange",function(e){return Jt(n),is().tableWidth=e}),Yo(),Yo(),Zo(19,"div"),Zo(20,"input",20),es("ngModelChange",function(e){return Jt(n),is().tableHeight=e}),Yo(),zs(21," Height : "),Zo(22,"input",19),es("ngModelChange",function(e){return Jt(n),is().tableHeight=e}),Yo(),Yo(),Zo(23,"div"),zs(24," \u30b0\u30ea\u30c3\u30c9: "),Zo(25,"select",21),es("ngModelChange",function(e){return Jt(n),is().tableGridType=e}),Zo(26,"option",22),zs(27,"\u306a\u3057"),Yo(),Zo(28,"option",23),zs(29,"\u30b9\u30af\u30a8\u30a2"),Yo(),Zo(30,"option",24),zs(31,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),Yo(),Zo(32,"option",25),zs(33,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),Yo(),Yo(),zs(34," \u8272: "),Zo(35,"select",26),es("ngModelChange",function(e){return Jt(n),is().tableGridColor=e}),Zo(36,"option",27),zs(37,"\u9ed2"),Yo(),Zo(38,"option",28),zs(39,"\u767d"),Yo(),Yo(),Yo(),Zo(40,"div"),zs(41," \u80cc\u666f\u30d5\u30a3\u30eb\u30bf "),Zo(42,"select",29),es("ngModelChange",function(e){return Jt(n),is().tableDistanceviewFilter=e}),Zo(43,"option",30),zs(44,"\u306a\u3057"),Yo(),Zo(45,"option",31),zs(46,"\u30db\u30ef\u30a4\u30c8"),Yo(),Zo(47,"option",32),zs(48,"\u30d6\u30e9\u30c3\u30af"),Yo(),Yo(),Yo(),qo(49,"hr"),Zo(50,"div"),Zo(51,"label",33),Zo(52,"input",34),es("ngModelChange",function(e){return Jt(n),is().tableGridShow=e}),Yo(),zs(53," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),Zo(54,"sup",35),zs(55,"*"),Yo(),Yo(),Zo(56,"label",36),Zo(57,"input",37),es("ngModelChange",function(e){return Jt(n),is().tableGridSnap=e}),Yo(),zs(58," \u30b9\u30ca\u30c3\u30d7"),Zo(59,"sup",35),zs(60,"*"),Yo(),Yo(),Uo(61,qA,8,6,"ng-container",10),Uo(62,XA,3,0,"ng-container",10),Yo(),Ko()}if(2&e){var i=is();sa(5),Wo("ngIf",i.getHidden(i.tableBackgroundImage)),sa(1),Wo("ngClass",rc(38,WA,!i.isShowHideImages&&i.getHidden(i.tableBackgroundImage)))("src",dc(7,35,i.tableBackgroundImage.url,"resourceUrl"),dr),sa(4),Wo("ngIf",!i.tableDistanceviewImage.url),sa(1),Wo("ngIf",i.tableDistanceviewImage.url),sa(3),Wo("ngModel",i.tableName),Lo("disabled",i.isEditable?null:""),sa(2),ss("title",i.tableWidth),ss("min",i.minSize),ss("max",i.maxSize),Wo("ngModel",i.tableWidth),Lo("disabled",i.isEditable?null:""),sa(2),ss("min",i.minSize),ss("max",i.maxSize),Wo("ngModel",i.tableWidth),Lo("disabled",i.isEditable?null:""),sa(2),ss("title",i.tableHeight),ss("min",i.minSize),ss("max",i.maxSize),Wo("ngModel",i.tableHeight),Lo("disabled",i.isEditable?null:""),sa(2),ss("min",i.minSize),ss("max",i.maxSize),Wo("ngModel",i.tableHeight),Lo("disabled",i.isEditable?null:""),sa(3),Wo("ngModel",i.tableGridType),Lo("disabled",i.isEditable?null:""),sa(10),Wo("ngModel",i.tableGridColor),Lo("disabled",i.isEditable?null:""),sa(7),Wo("ngModel",i.tableDistanceviewFilter),Lo("disabled",i.isEditable?null:""),sa(10),Wo("ngModel",i.tableGridShow),sa(5),Wo("ngModel",i.tableGridSnap),sa(4),Wo("ngIf",!i.isDeleted),sa(1),Wo("ngIf",i.isDeleted)}}function $A(e,t){1&e&&(Xo(0),Zo(1,"div",47),zs(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),Yo(),Ko())}var QA,JA=function(e){return{"red-eye":e}},eP=((QA=function(){function e(t,n,i,r){y(this,e),this.modalService=t,this.saveDataService=n,this.imageService=i,this.panelService=r,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}return k(e,[{key:"tableBackgroundImage",get:function(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}},{key:"tableDistanceviewImage",get:function(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}},{key:"tableName",get:function(){return this.selectedTable.name},set:function(e){this.isEditable&&(this.selectedTable.name=e)}},{key:"tableWidth",get:function(){return this.selectedTable.width},set:function(e){this.isEditable&&(this.selectedTable.width=e)}},{key:"tableHeight",get:function(){return this.selectedTable.height},set:function(e){this.isEditable&&(this.selectedTable.height=e)}},{key:"tableGridColor",get:function(){return this.selectedTable.gridColor},set:function(e){this.isEditable&&(this.selectedTable.gridColor=e)}},{key:"tableGridShow",get:function(){return this.tableSelecter.gridShow},set:function(e){this.tableSelecter.gridShow=e,Jb.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}},{key:"tableGridSnap",get:function(){return this.tableSelecter.gridSnap},set:function(e){this.tableSelecter.gridSnap=e}},{key:"tableGridType",get:function(){return this.selectedTable.gridType},set:function(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}},{key:"tableDistanceviewFilter",get:function(){return this.selectedTable.backgroundFilterType},set:function(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}},{key:"tableSelecter",get:function(){return tk.instance.get("tableSelecter")}},{key:"isEmpty",get:function(){return!this.tableSelecter||!this.tableSelecter.viewTable}},{key:"isDeleted",get:function(){return!this.selectedTable||null==tk.instance.get(this.selectedTable.identifier)}},{key:"isEditable",get:function(){return!this.isEmpty&&!this.isDeleted}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){e.modalService.title=e.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",e.panelService.isAbleFullScreenButton=!1}),this.selectedTable=this.tableSelecter.viewTable,Jb.register(this).on("DELETE_GAME_OBJECT",1e3,function(t){if(e.selectedTable&&t.data.identifier===e.selectedTable.identifier){var n=tk.instance.get(t.data.identifier);null!==n&&(e.selectedTableXml=n.toXml())}})}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"selectGameTable",value:function(e){Jb.call("SELECT_GAME_TABLE",{identifier:e},ek.peerId),this.selectedTable=tk.instance.get(e),this.selectedTableXml=""}},{key:"getGameTables",value:function(){return tk.instance.getObjects(tE)}},{key:"createGameTable",value:function(){var e=new tE;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}},{key:"save",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.selectedTable&&!this.isSaveing,!e.t0){e.next=8;break}return this.isSaveing=!0,this.progresPercent=0,this.selectedTable.selected=!0,e.next=7,this.saveDataService.saveGameObjectAsync(this.selectedTable,"map_"+this.selectedTable.name,function(e){t.progresPercent=e});case 7:setTimeout(function(){t.isSaveing=!1,t.progresPercent=0},500);case 8:case"end":return e.stop()}},e,this)}))}},{key:"delete",value:function(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}},{key:"restore",value:function(){if(this.selectedTable&&this.selectedTableXml){var e=lk.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}},{key:"getHidden",value:function(e){var t=Aw.get(e.identifier);return!!t&&t.hide}},{key:"openBgImageModal",value:function(){var e=this;this.isDeleted||this.modalService.open(Sx).then(function(t){e.selectedTable&&t&&(e.selectedTable.imageIdentifier=t)})}},{key:"openDistanceViewImageModal",value:function(){var e=this;this.isDeleted||this.modalService.open(Sx,{isAllowedEmpty:!0}).then(function(t){e.selectedTable&&t&&(e.selectedTable.backgroundImageIdentifier=t)})}},{key:"onShowHiddenImages",value:function(e){this.isShowHideImages?this.isShowHideImages=!1:window.confirm("\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\uff08\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\uff09\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")?this.isShowHideImages=!0:(this.isShowHideImages=!1,e.preventDefault())}}]),e}()).\u0275fac=function(e){return new(e||QA)(Vo(Zk),Vo(aE),Vo(BA),Vo(Wk))},QA.\u0275cmp=ct({type:QA,selectors:[["game-table-setting"]],decls:15,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[3,"click"],["size","10",2,"width","10em",3,"ngModel","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value"],[1,"images-select"],[2,"position","relative","overflow","hidden",3,"click"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none",4,"ngIf"],["height","120",3,"ngClass","src"],["style","position: relative; overflow: hidden",3,"click",4,"ngIf"],["placeholder","Name",3,"ngModel","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","ngModelChange"],["name","tableGridType",3,"ngModel","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],["name","tableGridColor",3,"ngModel","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["name","tableDistanceviewFilter",3,"ngModel","ngModelChange"],["value",""],["value","white"],["value","black"],[1,"self-setting"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px",3,"click"],[2,"margin-left","2em",3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"div",1),Zo(2,"div"),Zo(3,"button",2),es("click",function(){return t.createGameTable()}),zs(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),Yo(),Yo(),Zo(5,"select",3),es("change",function(e){return t.selectGameTable(e.target.value)}),Uo(6,jA,2,2,"option",4),Yo(),Yo(),Zo(7,"div",5),Zo(8,"div",6),Zo(9,"label",7),Zo(10,"input",8),es("click",function(e){return t.onShowHiddenImages(e)}),Yo(),Zo(11,"i",9),zs(12),Yo(),Yo(),Yo(),Uo(13,KA,63,40,"ng-container",10),Yo(),Yo(),Uo(14,$A,3,0,"ng-container",10)),2&e&&(sa(5),Wo("ngModel",null==t.selectedTable?null:t.selectedTable.identifier),sa(1),Wo("ngForOf",t.getGameTables()),sa(4),ss("checked",t.isShowHideImages?"checked":""),sa(1),Wo("ngClass",rc(7,JA,t.isShowHideImages)),sa(1),Ls(t.isShowHideImages?"visibility":"visibility_off"),sa(1),Wo("ngIf",!t.isEmpty||t.selectedTable),sa(1),Wo("ngIf",t.isEmpty))},directives:[Bf,Xd,Ef,uh,lh,dh,jf,$f,Ed,Rf,Of,wd],pipes:[Lw],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0 0 2px #dc143c,0 0 4px #fff;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0 #fff,-1px 1px 0 #fff,1px -1px 0 #fff,-1px -1px 0 #fff,1px 0 0 #fff,0 1px 0 #fff,-1px 0 0 #fff,0 -1px 0 #fff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s ease 0s}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}"]}),QA);function tP(e,t){if(1&e){var n=Qo();Zo(0,"button",12),es("click",function(){Jt(n);var e=is().$implicit;return is().play(e)}),zs(1,"\u8a66\u8074/\u518d\u751f"),Yo()}2&e&&Wo("disabled",!is().$implicit.isReady)}function nP(e,t){if(1&e){var n=Qo();Zo(0,"button",12),es("click",function(){return Jt(n),is(2).stop()}),zs(1,"\u8a66\u8074/\u505c\u6b62"),Yo()}2&e&&Wo("disabled",!is().$implicit.isReady)}function iP(e,t){if(1&e){var n=Qo();Zo(0,"button",12),es("click",function(){Jt(n);var e=is().$implicit;return is().playBGM(e)}),zs(1,"BGM/\u518d\u751f"),Yo()}2&e&&Wo("disabled",!is().$implicit.isReady)}function rP(e,t){if(1&e){var n=Qo();Zo(0,"button",12),es("click",function(){Jt(n);var e=is().$implicit;return is().stopBGM(e)}),zs(1,"BGM/\u505c\u6b62"),Yo()}2&e&&Wo("disabled",!is().$implicit.isReady)}function aP(e,t){1&e&&(Zo(0,"span"),zs(1,"\u3010\u8a66\u8074\u4e2d\u3011"),Yo())}function oP(e,t){1&e&&(Zo(0,"span"),zs(1,"\u3010BGM\u3011"),Yo())}function sP(e,t){if(1&e&&(Zo(0,"div",10),Uo(1,tP,2,1,"button",11),Uo(2,nP,2,1,"button",11),Uo(3,iP,2,1,"button",11),Uo(4,rP,2,1,"button",11),Uo(5,aP,2,0,"span",4),Uo(6,oP,2,0,"span",4),Zo(7,"span"),zs(8),Yo(),Yo()),2&e){var n=t.$implicit,i=is();sa(1),Wo("ngIf",n!==(null==i.auditionPlayer?null:i.auditionPlayer.audio)||(null==i.auditionPlayer?null:i.auditionPlayer.paused)),sa(1),Wo("ngIf",n===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),sa(1),Wo("ngIf",n!==(null==i.jukebox?null:i.jukebox.audio)),sa(1),Wo("ngIf",n===(null==i.jukebox?null:i.jukebox.audio)),sa(1),Wo("ngIf",n===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused)),sa(1),Wo("ngIf",n===(null==i.jukebox?null:i.jukebox.audio)),sa(2),Ls(n.name)}}function lP(e,t){1&e&&(Zo(0,"div"),zs(1,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),Yo())}var cP,uP,hP,dP,fP=((cP=function(){function e(t,n,i){y(this,e),this.modalService=t,this.panelService=n,this.ngZone=i,this.auditionPlayer=new Tw,this.lazyUpdateTimer=null,this.math=Math}return k(e,[{key:"volume",get:function(){return Tw.volume},set:function(e){Tw.volume=e}},{key:"auditionVolume",get:function(){return Tw.auditionVolume},set:function(e){Tw.auditionVolume=e}},{key:"audios",get:function(){return Ow.instance.audios.filter(function(e){return!e.isHidden})}},{key:"jukebox",get:function(){return tk.instance.get("Jukebox")}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.modalService.title=e.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"}),this.auditionPlayer.volumeType=Sw.AUDITION,Jb.register(this).on("*",function(t){t.eventName.startsWith("FILE_")&&e.lazyNgZoneUpdate()})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this),this.stop()}},{key:"play",value:function(e){this.auditionPlayer.play(e)}},{key:"stop",value:function(){this.auditionPlayer.stop()}},{key:"playBGM",value:function(e){this.jukebox.play(e.identifier,!0)}},{key:"stopBGM",value:function(e){this.jukebox.audio===e&&this.jukebox.stop()}},{key:"handleFileSelect",value:function(e){var t=e.target,n=t.files;n.length&&Fw.instance.load(n),t.value=""}},{key:"lazyNgZoneUpdate",value:function(){var e=this;null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(function(){e.lazyUpdateTimer=null,e.ngZone.run(function(){})},100))}}]),e}()).\u0275fac=function(e){return new(e||cP)(Vo(Zk),Vo(Wk),Vo($c))},cP.\u0275cmp=ct({type:cP,selectors:[["app-jukebox"]],decls:37,vars:10,consts:[[1,"material-icons"],["type","range","min","0","max","1","step","0.01",2,"width","60%",3,"ngModel","title","ngModelChange"],[1,"volume"],["class","box",4,"ngFor","ngForOf"],[4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px"],[1,"box"],[3,"disabled","click",4,"ngIf"],[3,"disabled","click"]],template:function(e,t){1&e&&(Zo(0,"div"),zs(1,"\u8a66\u8074\u97f3\u91cf\uff1a"),Zo(2,"i",0),zs(3),Yo(),Zo(4,"input",1),es("ngModelChange",function(e){return t.auditionVolume=e}),Yo(),Zo(5,"span",2),zs(6),Yo(),Yo(),Zo(7,"div"),zs(8,"\u518d\u751f\u97f3\u91cf\uff1a"),Zo(9,"i",0),zs(10),Yo(),Zo(11,"input",1),es("ngModelChange",function(e){return t.volume=e}),Yo(),Zo(12,"span",2),zs(13),Yo(),Yo(),qo(14,"hr"),Zo(15,"div"),Uo(16,sP,9,7,"div",3),Uo(17,lP,2,0,"div",4),Yo(),Zo(18,"label"),Zo(19,"div",5),Zo(20,"div"),Zo(21,"i",6),zs(22,"playlist_add"),Yo(),Yo(),Zo(23,"div"),zs(24,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),Yo(),Zo(25,"div",7),zs(26,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),Yo(),Zo(27,"input",8),es("change",function(e){return t.handleFileSelect(e)}),Yo(),Zo(28,"div",7),qo(29,"br"),zs(30,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),Yo(),Yo(),Yo(),Zo(31,"div",9),zs(32,"\u203b\u300c\u8a66\u8074\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),Yo(),Zo(33,"div",9),zs(34,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),Yo(),Zo(35,"div",9),zs(36,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),Yo()),2&e&&(sa(3),Ls(0==t.auditionVolume?"volume_off":t.auditionVolume<=.5?"volume_down":"volume_up"),sa(1),ss("title",t.math.floor(100*t.auditionVolume)+"%"),Wo("ngModel",t.auditionVolume),sa(2),Ls(t.math.floor(100*t.auditionVolume)+"%"),sa(4),Ls(0==t.volume?"volume_off":t.volume<=.5?"volume_down":"volume_up"),sa(1),ss("title",t.math.floor(100*t.volume)+"%"),Wo("ngModel",t.volume),sa(2),Ls(t.math.floor(100*t.volume)+"%"),sa(3),Wo("ngForOf",t.audios),sa(1),Wo("ngIf",t.audios.length<1))},directives:[Rf,Ed,Xd,Ef,uh,dh],styles:[".drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold,Vollkorn;color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}"]}),cP),pP=["content"],gP=["*"],mP=((uP=function(){function e(t){y(this,e),this.modalService=t}return k(e,[{key:"clickBackground",value:function(e){e.target===e.currentTarget&&this.resolve()}},{key:"resolve",value:function(){this.modalService.resolve(null)}},{key:"reject",value:function(){this.modalService.reject()}}]),e}()).\u0275fac=function(e){return new(e||uP)(Vo(Zk))},uP.\u0275cmp=ct({type:uP,selectors:[["modal"]],viewQuery:function(e,t){var n;1&e&&Sc(pP,3,Vl),2&e&&Ec(n=Tc())&&(t.content=n.first)},ngContentSelectors:gP,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,t){1&e&&(as(),Zo(0,"div",0),Zo(1,"div",1),es("click",function(e){return t.clickBackground(e)}),Yo(),Zo(2,"div",2),Zo(3,"div",3),Zo(4,"div",4),Zo(5,"button",5),es("click",function(){return t.resolve()}),Zo(6,"i",6),zs(7,"close"),Yo(),Yo(),Yo(),zs(8),Yo(),Zo(9,"div",7),os(10),qo(11,"div",null,8),Yo(),Yo(),Yo()),2&e&&(sa(1),Wo("@bgInOut","in"),sa(1),Wo("@flyInOut","in"),sa(6),Bs(" ",t.modalService.title," "))},styles:[".component[_ngcontent-%COMP%]{z-index:9999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component[_ngcontent-%COMP%], .modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;top:0;bottom:0;left:0;right:0}.modal-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.3);z-index:-1}.modal-panel[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.modal-panel[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444}.title[_ngcontent-%COMP%]{position:relative;white-space:nowrap;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.content[_ngcontent-%COMP%], .header[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[sp("flyInOut",[fp("void => *",[lp("100ms ease-out",dp([up({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),up({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),fp("* => void",[lp(100,up({transform:"scale(0, 0)"}))])]),sp("bgInOut",[hp("in",up({"background-color":"rgba(30, 30, 30, 0.4)"})),fp("void => *",[up({"background-color":"rgba(30, 30, 30, 0.0)"}),lp(200)]),fp("* => void",[lp(200,up({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),uP),vP=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{capture:!1,passive:!1,always:!1};y(this,e),this.target=t,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===n.capture,passive:!0===n.passive,always:!0===n.always},this.initialize()}return k(e,[{key:"pointer",get:function(){return this.primaryPointer}},{key:"isDragging",get:function(){return this._isDragging}},{key:"isGrabbing",get:function(){return this._isGrabbing}},{key:"isDestroyed",get:function(){return this._isDestroyed}},{key:"initialize",value:function(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}},{key:"destroy",value:function(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}},{key:"cancel",value:function(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}},{key:"onMouse",value:function(e){var t={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(t)||(this.lastPointers=[t],this.primaryPointer=t,this.onPointer(e))}},{key:"onTouch",value:function(e){var t=this,n=e.changedTouches.length;if(!(n<1)){this.lastPointers=[];for(var i=0;i<n;i++){var r=e.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===e.type)this.primaryPointer=this.lastPointers[0];else{var a=Array.from(e.changedTouches).find(function(e){return e.identifier===t.primaryPointer.identifier});if(null==a)return void(null!=Array.from(e.touches).find(function(e){return e.identifier===t.primaryPointer.identifier})||(this.onEnd&&this.onEnd(e),this.cancel()));this.primaryPointer={x:a.pageX,y:a.pageY,z:0,identifier:a.identifier}}this.onPointer(e)}}},{key:"onPointer",value:function(e){switch(e.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(e);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(e),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(e),this.cancel()}}},{key:"onMenu",value:function(e){this.onContextMenu&&this.onContextMenu(e)}},{key:"isSyntheticEvent",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:15,i=a(this.lastPointers);try{for(i.s();!(t=i.n()).done;){var r=t.value;if(r.identifier!==e.identifier&&Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2)<Math.pow(n,2))return!0}}catch(o){i.e(o)}finally{i.f()}return!1}},{key:"addEventListeners",value:function(){var e={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,e),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,e),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,e),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,e),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,e),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,e),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,e)}},{key:"removeEventListeners",value:function(){var e={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,e),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,e),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,e),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,e),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,e),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,e),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,e)}}]),e}(),yP=((hP=function(){function e(t,n){y(this,e),this.ngZone=t,this.elementRef=n,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.onstart=new fc,this.onmove=new fc,this.onend=new fc,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}return k(e,[{key:"ngAfterViewInit",value:function(){this.initialize(),this.adjustPosition(),this.setForeground()}},{key:"ngOnDestroy",value:function(){this.cancel(),this.destroy()}},{key:"initialize",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement),window.addEventListener("resize",e.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}},{key:"cancel",value:function(){this.input.cancel()}},{key:"destroy",value:function(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}},{key:"onInputStart",value:function(e){if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};var t=this.isHandleElement(e.target),n=this.isUnhandleElement(e.target),i=null!=e.touches&&this.isScrollableElement(e.target);!t||n||i?this.cancel():e.stopPropagation()}},{key:"onInputMove",value:function(e){var t={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},n=this.calcCorrectionPosition({x:t.x-this.prevTrans.x,y:t.y-this.prevTrans.y,z:t.z-this.prevTrans.z});t.x+=n.x,t.y+=n.y,t.z+=n.z,0<Math.pow(t.x,2)+Math.pow(t.y,2)+Math.pow(t.z,2)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.left=t.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=t.y+this.startPosition.y+"px",this.prevTrans=t,e.cancelable&&e.preventDefault(),e.stopPropagation()}},{key:"onInputEnd",value:function(e){this.elementRef.nativeElement.style.opacity=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}},{key:"onContextMenu",value:function(e){e.stopPropagation()}},{key:"preventClickIfNeeded",value:function(e){var t=this;if(null==e.touches){var n=this.input.pointer.y-this.startPointer.y,i=this.input.pointer.z-this.startPointer.z,r=Math.pow(this.input.pointer.x-this.startPointer.x,2)+Math.pow(n,2)+Math.pow(i,2);if(!(Math.pow(15,2)>r)){var a=function(e){e.cancelable&&e.preventDefault(),e.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",a,!0),setTimeout(function(){return t.elementRef.nativeElement.removeEventListener("click",a,!0)})}}}},{key:"adjustPosition",value:function(){var e=this.calcElementPosition(this.elementRef.nativeElement),t=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=t.x+e.x+"px",this.elementRef.nativeElement.style.top=t.y+e.y+"px"}},{key:"isHandleElement",value:function(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}},{key:"isUnhandleElement",value:function(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}},{key:"isContainsElement",value:function(e,t){for(var n=this.elementRef.nativeElement.querySelectorAll(t),i=0;i<n.length;i++)if(n[i].contains(e))return!0;return!1}},{key:"isScrollableElement",value:function(e){for(var t=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),n=e,i=["scroll","auto"],r=["fixed","sticky","-webkit-sticky"];n&&t!==n&&this.elementRef.nativeElement!==n;){var a=window.getComputedStyle(n);if(0<=i.indexOf(a.overflowY)&&n.offsetHeight<n.scrollHeight)return!0;if(0<=r.indexOf(a.position))return!1;n=n.parentElement}return!1}},{key:"calcCorrectionPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{x:0,y:0,z:0},t={x:0,y:0,z:0},n=this.elementRef.nativeElement.getBoundingClientRect(),i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return i.right<n.right+e.x&&(t.x+=i.right-(n.right+e.x)),n.left+e.x<i.left&&(t.x+=i.left-(n.left+e.x)),i.bottom<n.bottom+e.y&&(t.y+=i.bottom-(n.bottom+e.y)),n.top+e.y<i.top&&(t.y+=i.top-(n.top+e.y)),t}},{key:"calcElementPosition",value:function(e){var t=window.getComputedStyle(e);return{x:$O.relation(t.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:$O.relation(t.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}},{key:"setForeground",value:function(){if(!(this.stackSelector.length<1)){var e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),t=0,n=99999;e.forEach(function(e){var i=parseInt(e.style.zIndex);t<i&&(t=i),i<n&&(n=i)}),t<=parseInt(this.elementRef.nativeElement.style.zIndex)||(e.forEach(function(e){e.style.zIndex=parseInt(e.style.zIndex)-n+""}),this.elementRef.nativeElement.style.zIndex=t+1+"")}}}]),e}()).\u0275fac=function(e){return new(e||hP)(Vo($c),Vo(ll))},hP.\u0275dir=mt({type:hP,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),hP),bP=function(e){return e.N="n",e.E="e",e.W="w",e.S="s",e.NE="ne",e.NW="nw",e.SE="se",e.SW="sw",e}({}),kP=function(){function e(t,n){y(this,e),this.target=t,this.type=n,this.input=null,this.handle=null,this.width=12,this.initialize()}return k(e,[{key:"initialize",value:function(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new vP(this.handle),this.target.appendChild(this.handle);var e=this.handle.style;switch(e.position="absolute",e.zIndex="1",e.backgroundColor="transparent",this.type){case bP.N:e.top=3*-this.width/4+"px",e.left="0px",e.right="0px",e.height="".concat(this.width,"px"),e.cursor="ns-resize";break;case bP.E:e.top="0px",e.bottom="0px",e.right=3*-this.width/4+"px",e.width="".concat(this.width,"px"),e.cursor="ew-resize";break;case bP.W:e.top="0px",e.bottom="0px",e.left=3*-this.width/4+"px",e.width="".concat(this.width,"px"),e.cursor="ew-resize";break;case bP.S:e.bottom=3*-this.width/4+"px",e.left="0px",e.right="0px",e.height="".concat(this.width,"px"),e.cursor="ns-resize";break;case bP.NE:e.top=3*-this.width/4+"px",e.right=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nesw-resize",e.zIndex="2";break;case bP.NW:e.top=3*-this.width/4+"px",e.left=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nwse-resize",e.zIndex="2";break;case bP.SE:e.bottom=3*-this.width/4+"px",e.right=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nwse-resize",e.zIndex="2";break;case bP.SW:e.bottom=3*-this.width/4+"px",e.left=3*-this.width/4+"px",e.width=3*this.width/2+"px",e.height=3*this.width/2+"px",e.cursor="nesw-resize",e.zIndex="2"}}},{key:"destroy",value:function(){this.handle.remove(),this.input.destroy()}}]),e}(),_P=((dP=function(){function e(t,n){y(this,e),this.ngZone=t,this.elementRef=n,this.isDisable=!1,this.boundsSelector="body",this.minWidth=100,this.minHeight=100,this.ostart=new fc,this.onmove=new fc,this.onend=new fc,this.handleMap=new Map,this.handleTypes=[bP.N,bP.E,bP.W,bP.S,bP.NE,bP.NW,bP.SE,bP.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}return k(e,[{key:"ngAfterViewInit",value:function(){this.initialize()}},{key:"ngOnDestroy",value:function(){this.cancel(),this.destroy()}},{key:"initialize",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.handleTypes.forEach(function(t){var n=new kP(e.elementRef.nativeElement,t);e.handleMap.set(t,n),n.input.onStart=function(t){return e.onResizeStart(t,n)},n.input.onMove=function(t){return e.onResizeMove(t,n)},n.input.onEnd=function(t){return e.onResizeEnd(t,n)},n.input.onContextMenu=function(t){return e.onContextMenu(t,n)}})})}},{key:"cancel",value:function(){this.handleMap.forEach(function(e){return e.input.cancel()})}},{key:"destroy",value:function(){this.handleMap.forEach(function(e){return e.input.destroy()})}},{key:"onResizeStart",value:function(e,t){if(1===e.button||2===e.button)return this.cancel();this.handleMap.forEach(function(e){e!==t&&e.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=t.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},e.stopPropagation()}},{key:"onResizeMove",value:function(e,t){var n={left:0,top:0,width:t.input.pointer.x-this.startPointer.x,height:t.input.pointer.y-this.startPointer.y};switch(t.type){case bP.N:case bP.S:n.width=0;break;case bP.E:case bP.W:n.height=0}switch(t.type){case bP.SW:n.left=n.width,n.width*=-1;break;case bP.NE:n.top=n.height,n.height*=-1;break;case bP.E:case bP.S:case bP.SE:break;case bP.N:case bP.W:case bP.NW:n.left=n.width,n.top=n.height,n.width*=-1,n.height*=-1}n.width+this.startPosition.width<this.minWidth&&(n.width=this.minWidth-this.startPosition.width,n.left=0!==n.left?-n.width:n.left),n.height+this.startPosition.height<this.minHeight&&(n.height=this.minHeight-this.startPosition.height,n.top=0!==n.top?-n.height:n.top);var i=this.calcCorrectionPosition({left:n.left-this.prevTrans.left,top:n.top-this.prevTrans.top,width:n.width-this.prevTrans.width,height:n.height-this.prevTrans.height});n.left+=i.left,n.top+=i.top,n.width+=i.width,n.height+=i.height,this.elementRef.nativeElement.style.left=n.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=n.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=n.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=n.height+this.startPosition.height+"px",this.prevTrans=n,e.cancelable&&e.preventDefault(),e.stopPropagation()}},{key:"onResizeEnd",value:function(e,t){t.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}},{key:"onContextMenu",value:function(e,t){e.stopPropagation()}},{key:"calcCorrectionPosition",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{left:0,top:0,width:0,height:0},t={left:0,top:0,width:0,height:0},n=this.elementRef.nativeElement.getBoundingClientRect(),i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return i.right<n.right+e.left+e.width&&(t.width+=i.right-(n.right+e.left+e.width)),n.left+e.left<i.left&&(t.left+=i.left-(n.left+e.left),t.width-=t.left),i.bottom<n.bottom+e.top+e.height&&(t.height+=i.bottom-(n.bottom+e.top+e.height)),n.top+e.top<i.top&&(t.top+=i.top-(n.top+e.top),t.height-=t.top),t}},{key:"calcElementPosition",value:function(e){var t=window.getComputedStyle(e);return{left:$O.relation(t.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:$O.relation(t.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:$O.relation(t.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:$O.relation(t.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}}]),e}()).\u0275fac=function(e){return new(e||dP)(Vo($c),Vo(ll))},dP.\u0275dir=mt({type:dP,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),dP),wP=["draggablePanel"],xP=["scrollablePanel"],CP=["content"];function EP(e,t){if(1&e){var n=Qo();Zo(0,"button",8),es("click",function(){return Jt(n),is().toggleFullScreen()}),Zo(1,"i",9),zs(2,"fullscreen"),Yo(),Yo()}}function SP(e,t){if(1&e){var n=Qo();Zo(0,"button",8),es("click",function(){return Jt(n),is().close()}),Zo(1,"i",9),zs(2,"close"),Yo(),Yo()}}var TP,OP=function(e){return{"pointer-events-none":e}},IP=["*"],MP=((TP=function(){function e(t,n){y(this,e),this.panelService=t,this.pointerDeviceService=n,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.isFullScreen=!1}return k(e,[{key:"title",get:function(){return this.panelService.title},set:function(e){this.panelService.title=e}},{key:"left",get:function(){return this.panelService.left},set:function(e){this.panelService.left=e}},{key:"top",get:function(){return this.panelService.top},set:function(e){this.panelService.top=e}},{key:"width",get:function(){return this.panelService.width},set:function(e){this.panelService.width=e}},{key:"height",get:function(){return this.panelService.height},set:function(e){this.panelService.height=e}},{key:"isAbleFullScreenButton",get:function(){return this.panelService.isAbleFullScreenButton},set:function(e){this.panelService.isAbleFullScreenButton=e}},{key:"isAbleCloseButton",get:function(){return this.panelService.isAbleCloseButton},set:function(e){this.panelService.isAbleCloseButton=e}},{key:"isPointerDragging",get:function(){return this.pointerDeviceService.isDragging}},{key:"ngOnInit",value:function(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}},{key:"toggleFullScreen",value:function(){var e=this.draggablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",setTimeout(function(){e.style.transition=null},100),this.isFullScreen=!(e.offsetLeft<=0&&e.offsetTop<=0&&e.offsetWidth>=window.innerWidth&&e.offsetHeight>=window.innerHeight),this.isFullScreen?(this.preLeft=e.offsetLeft,this.preTop=e.offsetTop,this.preWidth=e.offsetWidth,this.preHeight=e.offsetHeight,this.left=0,this.top=0,this.width=window.innerWidth,this.height=window.innerHeight,e.style.left=this.left+"px",e.style.top=this.top+"px",e.style.width=this.width+"px",e.style.height=this.height+"px"):(this.left=this.preLeft,this.top=this.preTop,this.width=this.preWidth,this.height=this.preHeight)}},{key:"close",value:function(){this.panelService&&this.panelService.close()}}]),e}()).\u0275fac=function(e){return new(e||TP)(Vo(Wk),Vo(DC))},TP.\u0275cmp=ct({type:TP,selectors:[["ui-panel"]],viewQuery:function(e,t){var n;1&e&&(Sc(wP,3),Sc(xP,3),Sc(CP,3,Vl)),2&e&&(Ec(n=Tc())&&(t.draggablePanel=n.first),Ec(n=Tc())&&(t.scrollablePanel=n.first),Ec(n=Tc())&&(t.content=n.first))},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton"},features:[tl([Wk])],ngContentSelectors:IP,decls:12,vars:16,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","draggable.stack"],["draggablePanel",""],[1,"title"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel"],["scrollablePanel",""],["content",""],[3,"click"],[1,"material-icons",2,"font-size","14px"]],template:function(e,t){1&e&&(as(),Zo(0,"div",0,1),Zo(2,"div",2),Zo(3,"div",3),Uo(4,EP,3,0,"button",4),Uo(5,SP,3,0,"button",4),Yo(),zs(6),Yo(),Zo(7,"div",5,6),os(9),qo(10,"div",null,7),Yo(),Yo()),2&e&&(ks("left",t.left,"px")("top",t.top,"px")("width",t.width,"px")("height",t.height,"px"),Wo("@flyInOut","in")("ngClass",rc(14,OP,t.isPointerDragging))("draggable.stack",".draggable-panel"),sa(4),Wo("ngIf",t.isAbleFullScreenButton),sa(1),Wo("ngIf",t.isAbleCloseButton),sa(1),Bs(" ",t.panelService.title," "))},directives:[yP,_P,lh,dh],styles:[".draggable-panel[_ngcontent-%COMP%]{overflow:visible;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%}.draggable-panel[_ngcontent-%COMP%], .scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute}.scrollable-panel[_ngcontent-%COMP%]{overflow:auto;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"],data:{animation:[sp("flyInOut",[fp("void => *",[lp("100ms ease-out",dp([up({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),up({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),fp("* => void",[lp(100,up({transform:"scale(0, 0)"}))])])]}}),TP),AP=["standImageElement"],PP=function(e){return{"emote-secret":e}};function DP(e,t){if(1&e&&(Zo(0,"div",12),zs(1),Yo()),2&e){var n=is(3);ks("visibility",n.isShowStand&&n.isApplyDialog?"visible":"hidden")("width",n.imageWidth,"px")("font-size",n.imageWidth/4.5>16?n.imageWidth/4.5:16,"px")("color",n.color?n.color:"#444"),Wo("@fadeAndScaleInOut",void 0)("ngClass",rc(11,PP,n.isSecret)),sa(1),Ls(n.gameCharacter.text)}}var RP=function(e,t){return{"transform-origin":e,transform:t}},FP=function(e){return{inverse:e}},NP=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}},zP=function(e,t){return{"black-paint":e,hollow:t}};function LP(e,t){if(1&e){var n=Qo();Xo(0),Uo(1,DP,2,13,"div",5),Zo(2,"div",6),Zo(3,"div",7),Zo(4,"div",8),Zo(5,"div",9),Zo(6,"img",10,11),es("load",function(){return Jt(n),is(2).onImageLoad()}),hc(8,"safe"),Yo(),Yo(),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2);sa(1),Wo("ngIf",!i.isBackyard&&i.gameCharacter.isEmote),sa(1),Wo("ngStyle",ac(11,RP,i.standImageTransformOrigin,i.isApplyRoll?"rotate("+i.gameCharacter.roll+"deg)":"")),sa(1),Wo("ngClass",rc(14,FP,i.isApplyImageEffect&&i.gameCharacter.isInverse)),sa(1),Wo("ngClass",lc(16,NP,i.isApplyImageEffect&&0==i.gameCharacter.aura,i.isApplyImageEffect&&1==i.gameCharacter.aura,i.isApplyImageEffect&&2==i.gameCharacter.aura,i.isApplyImageEffect&&3==i.gameCharacter.aura,i.isApplyImageEffect&&4==i.gameCharacter.aura,i.isApplyImageEffect&&5==i.gameCharacter.aura,i.isApplyImageEffect&&6==i.gameCharacter.aura,i.isApplyImageEffect&&7==i.gameCharacter.aura)),sa(2),ks("height",i.height>0?i.height+"vh":"auto"),Wo("src",dc(8,8,i.standImage.url,"resourceUrl"),dr)("ngClass",ac(25,zP,i.isApplyImageEffect&&i.gameCharacter.isBlackPaint,i.isApplyImageEffect&&i.gameCharacter.isHollow))}}var BP=function(e,t,n,i){return{"is-can-be-gone":e,"is-ghostly":t,backyard:n,secret:i}};function jP(e,t){if(1&e){var n=Qo();Zo(0,"div",3),es("click",function(){Jt(n);var e=is();return e.toGhostly(),e.toBackyard()}),Uo(1,LP,9,28,"ng-container",4),Yo()}if(2&e){var i=is();ks("left",i.position+"%")("height",0==i.height?"":i.height+"vh")("margin-left",-i.imageWidth/2,"px")("margin-bottom",i.adjustY,"px"),Wo("@standInOut",i.groupValue)("ngClass",sc(11,BP,i.isCanBeGone,i.isGhostly,i.isBackyard,i.isSecret)),sa(1),Wo("ngIf",i.gameCharacter&&i.standImage.url&&i.standImage.url.length>0)}}var UP=function(e,t,n){return{"is-can-be-gone":e,"is-ghostly":t,backyard:n}};function HP(e,t){if(1&e&&(Zo(0,"span",13),Zo(1,"b"),zs(2),Yo(),Yo()),2&e){var n=is();ks("color",n.color?n.color:"#444")("left",n.position+"%")("margin-bottom",n.adjustY>0?n.adjustY:0,"px")("border-color",n.color?n.color:"#444")("margin-left",n.nameTagCSSMarginLeft,"px"),Wo("ngClass",oc(12,UP,n.isCanBeGone,n.isGhostly,n.isBackyard)),sa(2),Ls(n.gameCharacter.name)}}var VP=function(e,t,n){return{left:e,right:t,"transform-origin":n}},WP=function(e,t,n,i,r,a){return{"is-can-be-gone":e,"is-ghostly":t,backyard:n,"dialog-secret":i,"is-position-right":r,"is-position-left":a}};function GP(e,t){if(1&e){var n=Qo();Zo(0,"div",14),es("click",function(){Jt(n);var e=is();return e.toGhostly(),e.toBackyard()}),Zo(1,"p",15),es("@dialogShake.start",function(e){return Jt(n),is().onSpeaking(e)}),zs(2),Yo(),Yo()}if(2&e){var i=is();ks("visibility",i.isShowStand&&i.isApplyDialog?"visible":"hidden")("color",i.isSecret?"#ccc":i.color?i.color:"#444")("left",i.dialogBoxCSSLeft,"px")("bottom",i.dialogBoxCssBottom+i.adjustY>12?i.dialogBoxCssBottom:12,"px")("max-width",i.dialogBoxCSSMaxWidth,"px")("margin-bottom",i.dialogBoxCssBottom+i.adjustY>12?i.adjustY:0,"px")("border-color",i.color?i.color:"#444"),Wo("@fadeAndScaleInOut",void 0)("ngStyle",oc(19,VP,i.position<=50?i.dialogBoxCSSLeft+"px":"auto",i.position>50?i.dialogBoxCSSRight+"px":"auto",i.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",(r=WP,a=i.isCanBeGone,o=i.isGhostly,s=i.isBackyard,l=i.isSecret,c=i.position<=50,u=i.position>50,h=ln()+23,d=$t(),f=zo(d,h,a,o,s,l),No(d,h+4,c,u)||f?Do(d,h+6,r(a,o,s,l,c,u)):Ro(d,h+6))),sa(1),Wo("@dialogShake",i.dialogText.length),sa(1),Ls(i.dialogText)}var r,a,o,s,l,c,u,h,d,f}var ZP,YP,qP=((YP=function(){function e(t){y(this,e),this.ngZone=t,this._imageFile=Wm.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1}return k(e,[{key:"onSpeaking",value:function(e){var t=this;this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){t.ngZone.run(function(){t.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(function(){t.isSpeaking=!1},200))}},{key:"isShowStand",get:function(){return e.isShowStand}},{key:"isShowNameTag",get:function(){return e.isShowNameTag}},{key:"isCanBeGone",get:function(){return e.isCanBeGone}},{key:"dialogText",get:function(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}},{key:"standImage",get:function(){if(!this.standElement)return this._imageFile;var e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),e&&e.value&&e.value!=Wm.Empty.identifier||(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){var t=Dk.instance.get(e.value);this._imageFile=t||Wm.Empty}return this._imageFile}},{key:"isSpeakable",get:function(){if(!this.standElement)return!1;var e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Wm.Empty.identifier}},{key:"ngOnInit",value:function(){}},{key:"ngOnDestroy",value:function(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}},{key:"group",get:function(){if(!this.gameCharacter)return"";var e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}},{key:"groupValue",get:function(){for(var e=0,t=this.group,n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e}},{key:"position",get:function(){if(!this.gameCharacter)return 0;var e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}},{key:"adjustY",get:function(){if(!this.gameCharacter)return 0;var e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}},{key:"height",get:function(){if(!this.gameCharacter||!this.standElement)return 0;var e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}},{key:"imageHeight",get:function(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}},{key:"imageWidth",get:function(){return this.imageHeight*this.naturalWidth/this.naturalHeight}},{key:"dialogBoxCSSLeft",get:function(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}},{key:"dialogBoxCSSRight",get:function(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}},{key:"dialogBoxCSSMaxWidth",get:function(){var e=this.imageWidth/document.documentElement.clientWidth;return(e/=2)<.14&&(e=.14),e*document.documentElement.clientWidth}},{key:"dialogBoxCssBottom",get:function(){var e=.66*this.imageHeight;return e<48&&(e=48),e}},{key:"nameTagCSSMarginLeft",get:function(){var e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}},{key:"isApplyImageEffect",get:function(){if(!this.standElement||!this.gameCharacter)return!1;var e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}},{key:"isApplyRoll",get:function(){if(!this.standElement||!this.gameCharacter)return!1;var e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}},{key:"isApplyDialog",get:function(){if(!this.standElement||!this.gameCharacter)return!1;var e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}},{key:"calcStandImageTransformOrigin",value:function(){if(!this.standImageElement)return"center";var e=1-this.naturalWidth/(2*this.naturalHeight);return e>.66&&(e=.66),"center "+100*e+"%"}},{key:"toGhostly",value:function(){var e=this;this.ngZone.run(function(){e.isGhostly=!0})}},{key:"toBackyard",value:function(){var e=this;this.ngZone.run(function(){e.isBackyard=!0})}},{key:"toFront",value:function(){var e=this;this.ngZone.run(function(){e.isFarewell=!1,e.isGhostly=!1,e.isBackyard=!1,e.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(function(){e.ngZone.run(function(){e.isVisible=!1})},12e3)}},{key:"toFarewell",value:function(){var e=this;this.ngZone.run(function(){e.isFarewell=!0,e.isVisible=!1})}},{key:"onImageLoad",value:function(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}]),e}()).isShowStand=!0,YP.isShowNameTag=!0,YP.isCanBeGone=!0,YP.\u0275fac=function(e){return new(e||YP)(Vo($c))},YP.\u0275cmp=ct({type:YP,selectors:[["stand-image"]],viewQuery:function(e,t){var n;1&e&&Sc(AP,1),2&e&&Ec(n=Tc())&&(t.standImageElement=n.first)},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","margin-bottom","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],[1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],[2,"width","100%"]],template:function(e,t){1&e&&(Zo(0,"div"),Uo(1,jP,2,16,"div",0),Uo(2,HP,3,16,"span",1),Uo(3,GP,3,30,"div",2),Yo()),2&e&&(ks("visibility",t.isShowStand?"visible":"hidden")("pointer-events",t.isShowStand?"auto":"none"),sa(1),Wo("ngIf",!t.isFarewell&&(t.isVisible||!t.isCanBeGone)),sa(1),Wo("ngIf",t.isShowStand&&!t.isFarewell&&(t.isVisible||!t.isCanBeGone)&&t.isShowNameTag&&t.gameCharacter&&t.gameCharacter.name),sa(1),Wo("ngIf",!t.isFarewell&&t.isVisible&&!t.isBackyard&&t.gameCharacter&&t.gameCharacter.text&&!t.gameCharacter.isEmote))},directives:[dh,lh,Sh],pipes:[Lw],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px 24px 24px 24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px 24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px 24px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px 12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px #f5f5f5}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before, .dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit}.dialog.is-position-left[_ngcontent-%COMP%]:before{right:17px;margin:0 -12px 0 0}@supports (-moz-user-select:-moz-none){.dialog.is-position-left[_ngcontent-%COMP%]:before, .dialog.is-position-right[_ngcontent-%COMP%]:after{bottom:-39px!important}}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s;transform-origin:center bottom}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[sp("standInOut",[fp("void => *,:increment,:decrement",[lp("132ms cubic-bezier(.21,.97,.75,1.25)",dp([up({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),up({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),fp("* => void,:increment,:decrement",[lp("132ms ease-out",dp([up({transform:"translateY(0px) scale(1.0)",offset:0}),up({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),sp("dialogShake",[fp(":increment",[lp("19ms ease",dp([up({transform:"translateX(1px)"})])),lp("19ms ease",dp([up({transform:"translateX(-1px)"})]))])]),sp("fadeAndScaleInOut",[fp("void => *, true => false",[lp("200ms ease-in-out",dp([up({transform:"scale3d(0, 0, 0)",opacity:0}),up({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),fp("* => void, true => false",[lp("100ms ease-in-out",up({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),YP),XP=((ZP=function(){function e(t){y(this,e),this.componentFactoryResolver=t}return k(e,[{key:"show",value:function(t,n){var i,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=!0,l=a(e.currentStandImageShowing);try{for(l.s();!(i=l.n()).done;){var c=i.value,u=c[0],h=c[1];if(h){var d=h.instance;d.isVisible&&t.identifier!=u?d.toGhostly():t.identifier==u&&"graveyard"!=t.location.name?(d.standElement=n,d.color=r||t.chatPalette.color,d.isSecret=o,d.toFront(),s=!1):(d.isFarewell||qP.isCanBeGone)&&(h.destroy(),e.currentStandImageShowing.delete(u))}}}catch(p){l.e(p)}finally{l.f()}if(s&&"graveyard"!=t.location.name){var f=e.defaultParentViewContainerRef.createComponent(this.componentFactoryResolver.resolveComponentFactory(qP));f.instance.gameCharacter=t,f.instance.standElement=n,f.instance.color=r||t.chatPalette.color,f.instance.isSecret=o,f.instance.toFront(),e.currentStandImageShowing.set(t.identifier,f)}}},{key:"farewell",value:function(t){t instanceof jk&&(t=t.identifier);var n=e.currentStandImageShowing.get(t);n&&n.instance&&n.instance.toFarewell()}},{key:"destroyAll",value:function(){var t,n=a(e.currentStandImageShowing);try{for(n.s();!(t=n.n()).done;){var i=t.value,r=i[0],o=i[1];o&&(o.destroy(),e.currentStandImageShowing.delete(r))}}catch(s){n.e(s)}finally{n.f()}}}]),e}()).currentStandImageShowing=new Map,ZP.\u0275fac=function(e){return new(e||ZP)(wi(rl))},ZP.\u0275prov=Ae({token:ZP,factory:ZP.\u0275fac,providedIn:"root"}),ZP),KP=["diceRollTableSelecter"];function $P(e,t){if(1&e&&(Zo(0,"option",8),zs(1),Yo()),2&e){var n=t.$implicit;ss("value",n.identifier),sa(1),Ls(n.name)}}function QP(e,t){if(1&e&&(Zo(0,"div",24),zs(1),Yo()),2&e){var n=is(3);sa(1),Bs("",n.progresPercent,"%")}}var JP=function(e){return{"is-hidden":e}};function eD(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",18),es("click",function(){return Jt(n),is(2).upTabIndex()}),zs(2,"\u2191"),Yo(),Zo(3,"button",18),es("click",function(){return Jt(n),is(2).downTabIndex()}),zs(4,"\u2193"),Yo(),Zo(5,"button",19),es("click",function(){return Jt(n),is(2).save()}),Zo(6,"div",20),Zo(7,"div",21),zs(8,"\u4fdd\u5b58"),Yo(),Uo(9,QP,2,1,"div",22),Yo(),Yo(),Zo(10,"button",23),es("click",function(){return Jt(n),is(2).delete()}),zs(11,"\u524a\u9664"),Yo(),Ko()}if(2&e){var i=is(2);sa(5),Wo("disabled",i.isSaveing),sa(2),Wo("ngClass",rc(3,JP,i.isSaveing)),sa(2),Wo("ngIf",i.isSaveing)}}function tD(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"button",18),es("click",function(){return Jt(n),is(2).restore()}),zs(2,"\u5143\u306b\u623b\u3059"),Yo(),Ko()}}function nD(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",9),Zo(2,"button",10),es("click",function(){return Jt(n),is().helpDiceRollTable()}),zs(3,"?"),Yo(),Zo(4,"div",11),Zo(5,"b"),zs(6,"name: "),Yo(),Zo(7,"input",12),es("ngModelChange",function(e){return Jt(n),is().diceRollTableName=e}),Yo(),Yo(),Zo(8,"div"),Zo(9,"span",13),Zo(10,"b"),zs(11,"command: "),Yo(),Zo(12,"input",14),es("ngModelChange",function(e){return Jt(n),is().diceRollTableCommand=e}),Yo(),Yo(),Zo(13,"span",15),Zo(14,"b"),zs(15,"dice: "),Yo(),Zo(16,"input",16),es("ngModelChange",function(e){return Jt(n),is().diceRollTableDice=e}),Yo(),Yo(),Yo(),Yo(),Zo(17,"div"),Zo(18,"textarea",17),es("ngModelChange",function(e){return Jt(n),is().diceRollTableText=e}),Yo(),Yo(),qo(19,"hr"),Zo(20,"div"),Uo(21,eD,12,5,"ng-container",7),Uo(22,tD,3,0,"ng-container",7),Yo(),Ko()}if(2&e){var i=is();sa(7),Wo("ngModel",i.diceRollTableName),Lo("disabled",i.isEditable?null:""),sa(5),Wo("ngModel",i.diceRollTableCommand),Lo("disabled",i.isEditable?null:""),sa(4),Wo("ngModel",i.diceRollTableDice),Lo("disabled",i.isEditable?null:""),sa(2),Wo("ngModel",i.diceRollTableText),sa(3),Wo("ngIf",!i.isDeleted),sa(1),Wo("ngIf",i.isDeleted)}}function iD(e,t){1&e&&(Xo(0),Zo(1,"div",25),zs(2,"\u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002"),Yo(),Ko())}var rD,aD,oD,sD,lD,cD=((rD=function(){function e(t,n,i,r){y(this,e),this.pointerDeviceService=t,this.modalService=n,this.panelService=i,this.saveDataService=r,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}return k(e,[{key:"diceRollTableName",get:function(){return this.selectedDiceRollTable.name},set:function(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}},{key:"diceRollTableDice",get:function(){return this.selectedDiceRollTable.dice},set:function(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}},{key:"diceRollTableCommand",get:function(){return this.selectedDiceRollTable.command},set:function(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}},{key:"diceRollTableText",get:function(){return this.selectedDiceRollTable.value},set:function(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}},{key:"diceRollTables",get:function(){return Hk.instance.children}},{key:"isEmpty",get:function(){return this.diceRollTables.length<1}},{key:"isDeleted",get:function(){return!!this.selectedDiceRollTable&&null==tk.instance.get(this.selectedDiceRollTable.identifier)}},{key:"isEditable",get:function(){return!this.isEmpty&&!this.isDeleted}},{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.modalService.title=e.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"}),Jb.register(this).on("DELETE_GAME_OBJECT",1e3,function(t){if(e.selectedDiceRollTable&&t.data.identifier===e.selectedDiceRollTable.identifier){var n=tk.instance.get(t.data.identifier);null!==n&&(e.selectedDiceRollTableXml=n.toXml())}})}},{key:"ngAfterViewInit",value:function(){var e=this;this.diceRollTables.length>0&&setTimeout(function(){e.onChangeDiceRollTable(e.diceRollTables[0].identifier),e.diceRollTableSelecter.nativeElement.selectedIndex=0})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"onChangeDiceRollTable",value:function(e){this.selectedDiceRollTable=tk.instance.get(e),this.selectedDiceRollTableXml=""}},{key:"create",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";return Hk.instance.addDiceRollTable(e)}},{key:"add",value:function(){var e=this,t=this.create("\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868");setTimeout(function(){e.onChangeDiceRollTable(t.identifier),e.diceRollTableSelecter.nativeElement.value=t.identifier})}},{key:"save",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.selectedDiceRollTable&&!this.isSaveing){e.next=2;break}return e.abrupt("return");case 2:return this.isSaveing=!0,this.progresPercent=0,t="rollTable_"+this.selectedDiceRollTable.name,e.next=6,this.saveDataService.saveGameObjectAsync(this.selectedDiceRollTable,t,function(e){n.progresPercent=e});case 6:setTimeout(function(){n.isSaveing=!1,n.progresPercent=0},500);case 7:case"end":return e.stop()}},e,this)}))}},{key:"delete",value:function(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}},{key:"restore",value:function(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){var e=lk.instance.parseXml(this.selectedDiceRollTableXml);Hk.instance.addDiceRollTable(e),this.selectedDiceRollTableXml=""}}},{key:"upTabIndex",value:function(){if(this.selectedDiceRollTable){var e=this.selectedDiceRollTable.parent,t=e.children.indexOf(this.selectedDiceRollTable);0<t&&e.insertBefore(this.selectedDiceRollTable,e.children[t-1])}}},{key:"downTabIndex",value:function(){if(this.selectedDiceRollTable){var e=this.selectedDiceRollTable.parent,t=e.children.indexOf(this.selectedDiceRollTable);t<e.children.length-1&&e.insertBefore(e.children[t+1],this.selectedDiceRollTable)}}},{key:"helpDiceRollTable",value:function(){var e=this.pointerDeviceService.pointers[0],t=this.panelService.open(_w,{left:e.x,top:e.y,width:600,height:460});t.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",t.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3001\u306a\u304a\u30b3\u30de\u30f3\u30c9\u306b\u306f\u82f1\u6570\u3001\u8a18\u53f7\u306e\u307f\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30ed\u30fc\u30eb nBm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b\u300c\\n\u300d\u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002"}}]),e}()).\u0275fac=function(e){return new(e||rD)(Vo(DC),Vo(Zk),Vo(Wk),Vo(aE))},rD.\u0275cmp=ct({type:rD,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,t){var n;1&e&&Sc(KP,1),2&e&&Ec(n=Tc())&&(t.diceRollTableSelecter=n.first)},decls:11,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-size","smaller"],[2,"float","right",3,"click"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3092\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\n2:\u7d50\u679c\uff12\n3:\u7d50\u679c\uff13\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,t){1&e&&(Zo(0,"div",0),Zo(1,"div",1),Zo(2,"div"),Zo(3,"button",2),es("click",function(){return t.add()}),zs(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),Yo(),Yo(),Zo(5,"select",3,4),es("change",function(e){return t.onChangeDiceRollTable(e.target.value)}),Uo(7,$P,2,2,"option",5),Yo(),Yo(),Zo(8,"div",6),Uo(9,nD,23,9,"ng-container",7),Yo(),Yo(),Uo(10,iD,3,0,"ng-container",7)),2&e&&(sa(7),Wo("ngForOf",t.diceRollTables),sa(2),Wo("ngIf",!t.isEmpty&&t.selectedDiceRollTable),sa(1),Wo("ngIf",t.isEmpty))},directives:[uh,dh,jf,$f,Ed,Xd,Ef,lh],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),rD),uD=function(){function e(t){y(this,e),this.canvasElement=t}return k(e,[{key:"makeBrush",value:function(e,t,n){e.strokeStyle=n,e.fillStyle=e.strokeStyle,e.lineWidth=1;var i=Math.floor(t/5);return e.font="bold ".concat(i,"px sans-serif"),e.textBaseline="top",e.textAlign="center",e}},{key:"render",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JC.SQUARE,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000000e6";this.canvasElement.width=e*n,this.canvasElement.height=t*n;var a=this.canvasElement.getContext("2d");if(!(i<0)){var o=this.generateCalcGridPositionFunc(i);this.makeBrush(a,n,r);for(var s=0;s<=t;s++)for(var l=0;l<=e;l++){var c=o(l,s,n),u=c.gx,h=c.gy;this.strokeSquare(a,u,h,n),a.fillText((l+1).toString()+"-"+(s+1).toString(),u+n/2,h+n/2)}}}},{key:"generateCalcGridPositionFunc",value:function(e){switch(e){case JC.HEX_VERTICAL:return function(e,t,n){return e%2==1?{gx:e*n,gy:t*n}:{gx:e*n,gy:t*n+n/2}};case JC.HEX_HORIZONTAL:return function(e,t,n){return t%2==1?{gx:e*n,gy:t*n}:{gx:e*n+n/2,gy:t*n}};default:return function(e,t,n){return{gx:e*n,gy:t*n}}}}},{key:"strokeSquare",value:function(e,t,n,i){e.beginPath(),e.strokeRect(t,n,i,i)}},{key:"strokeHex",value:function(e,t,n,i,r){var a=r===JC.HEX_HORIZONTAL?-30:0,o=i/Math.sqrt(3),s=t+i/2,l=n+i/2;e.beginPath();for(var c=0;c<6;c++){a+=60;var u=Math.PI/180*a,h=Math.cos(u)*o+s,d=Math.sin(u)*o+l;e.lineTo(h,d)}e.closePath(),e.stroke()}}]),e}(),hD=function(e){return e.DRAG="drag",e.ZOOM="zoom",e.ROTATE="rotate",e.KEYBOARD="keyboard",e}({}),dD=function(e){return e.ArrowLeft="ArrowLeft",e.ArrowUp="ArrowUp",e.ArrowRight="ArrowRight",e.ArrowDown="ArrowDown",e}({}),fD=function(){function e(t){var n=this;y(this,e),this.targetElement=t,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=function(e){return n.onWheel(e)},this.callbackOnKeydown=function(e){return n.onKeydown(e)},this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}return k(e,[{key:"isGrabbing",get:function(){return this.input.isGrabbing}},{key:"isDragging",get:function(){return this.input.isDragging}},{key:"initialize",value:function(){this.input=new vP(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}},{key:"cancel",value:function(){this.input.cancel()}},{key:"destroy",value:function(){this.input.destroy(),this.removeEventListeners()}},{key:"onInputStart",value:function(e){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=e.button,this.onstart&&this.onstart(e)}},{key:"onInputEnd",value:function(e){this.onend&&this.onend(e)}},{key:"onInputMove",value:function(e){var t=this.input.pointer.x,n=this.input.pointer.y,i=t-this.currentPositionX,r=n-this.currentPositionY,a=0,o=0,s=0,l=0,c=hD.DRAG;2===this.buttonCode?(c=hD.ROTATE,l=-i/5,s=-r/5):(a=i,o=r),this.currentPositionX=t,this.currentPositionY=n,this.ontransform&&this.ontransform(a,o,0,s,0,l,c,e)}},{key:"onWheel",value:function(e){var t=0;switch(e.deltaMode){case WheelEvent.DOM_DELTA_LINE:t=16*e.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:t=e.deltaY*window.innerHeight;break;default:t=e.deltaY}var n=0;n=-1.5*t,Math.pow(300,2)<Math.pow(n,2)&&(n=Math.min(Math.max(n,-300),300)),this.ontransform&&this.ontransform(0,0,n,0,0,0,hD.ZOOM,e)}},{key:"onKeydown",value:function(e){var t=0,n=0,i=0,r=0,a=0,o=this.getKeyName(e);switch(o){case dD.ArrowLeft:e.shiftKey?a=-2:t=10;break;case dD.ArrowUp:e.shiftKey?r=-2:e.ctrlKey?i=150:n=10;break;case dD.ArrowRight:e.shiftKey?a=2:t=-10;break;case dD.ArrowDown:e.shiftKey?r=2:e.ctrlKey?i=-150:n=-10}null!=dD[o]&&this.ontransform&&this.ontransform(t,n,i,r,0,a,hD.KEYBOARD,e)}},{key:"getKeyName",value:function(e){if(e.key)return e.key;switch(e.keyCode){case 37:return dD.ArrowLeft;case 38:return dD.ArrowUp;case 39:return dD.ArrowRight;case 40:return dD.ArrowDown;default:return""}}},{key:"addEventListeners",value:function(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}},{key:"removeEventListeners",value:function(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}]),e}(),pD=function(e){return e.PAN="pan",e.TAP_PINCH="tappinch",e.PINCH="pinch",e.ROTATE="rotate",e}({}),gD=function(){function e(t,n){y(this,e),this.targetElement=t,this.ngZone=n,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}return k(e,[{key:"destroy",value:function(){this.clearTappedPanTimer(),this.hammer.destroy()}},{key:"initializeHammer",value:function(){var e=this;this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});var t=new Hammer.Tap,n=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,a=new Hammer.Rotate;n.recognizeWith(i),n.recognizeWith(a),n.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(a),r.recognizeWith(a),this.hammer.add([t,n,i,r,a]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));var o=window.navigator.userAgent.toLowerCase();(o.indexOf("iphone")>-1||o.indexOf("ipad")>-1||o.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",function(t){var n=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:t.center.x,clientY:t.center.y});e.ngZone.run(function(){return t.srcEvent.target.dispatchEvent(n)})}))}},{key:"onHammer",value:function(e){if(e.isFirst?(this.deltaHammerScale=e.scale,this.deltaHammerRotation=e.rotation,this.deltaHammerDeltaX=e.deltaX,this.deltaHammerDeltaY=e.deltaY,this.onstart&&this.onstart(e.srcEvent)):e.isFinal?this.onend&&this.onend(e.srcEvent):(this.deltaHammerScale=e.scale-this.prevHammerScale,this.deltaHammerRotation=e.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=e.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=e.deltaY-this.prevHammerDeltaY),this.prevHammerScale=e.scale,this.prevHammerRotation=e.rotation,this.prevHammerDeltaX=e.deltaX,this.prevHammerDeltaY=e.deltaY,null!=this.tappedPanTimer&&e.eventType==Hammer.INPUT_START){var t=Math.pow(this.tappedPanCenter.x-e.center.x,2)+Math.pow(this.tappedPanCenter.y-e.center.y,2);Math.pow(50,2)<t&&this.clearTappedPanTimer()}}},{key:"onTap",value:function(e){var t=this;this.tappedPanCenter=e.center,this.tappedPanTimer=setTimeout(function(){t.tappedPanTimer=null},400),this.ongesture&&this.ongesture(e.srcEvent)}},{key:"onTappedPanStart",value:function(e){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(e.srcEvent))}},{key:"onTappedPanEnd",value:function(e){this.clearTappedPanTimer()}},{key:"onTappedPanMove",value:function(e){if(null==this.tappedPanTimer){var t=this.deltaHammerDeltaX,n=this.deltaHammerDeltaY;this.ontransform&&this.ontransform(t,n,0,0,0,0,pD.PAN,e.srcEvent)}else{this.clearTappedPanTimer(!1);var i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,pD.TAP_PINCH,e.srcEvent)}}},{key:"onPanMove",value:function(e){this.clearTappedPanTimer();var t=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,0,t,0,0,pD.ROTATE,e.srcEvent)}},{key:"onPinchMove",value:function(e){this.clearTappedPanTimer();var t=500*this.deltaHammerScale;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,t,0,0,0,pD.PINCH,e.srcEvent)}},{key:"onRotateMove",value:function(e){this.clearTappedPanTimer();var t=this.deltaHammerRotation;this.ongesture&&this.ongesture(e.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,t,pD.ROTATE,e.srcEvent)}},{key:"clearTappedPanTimer",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];clearTimeout(this.tappedPanTimer),e&&(this.tappedPanTimer=null)}}]),e}(),mD=(lD=function(e){h(n,e);var t=f(n);function n(){var e;return y(this,n),(e=t.apply(this,arguments)).viewTableIdentifier="",e.gridShow=!1,e.gridSnap=!0,e}return k(n,[{key:"onStoreAdded",value:function(){var e=this;u(v(n.prototype),"onStoreAdded",this).call(this),Jb.register(this).on("SELECT_GAME_TABLE",function(t){console.log("SELECT_GAME_TABLE "+e.identifier),e.viewTable&&(e.viewTable.selected=!1),e.viewTableIdentifier=t.data.identifier,e.viewTable&&(e.viewTable.selected=!0)})}},{key:"onStoreRemoved",value:function(){u(v(n.prototype),"onStoreRemoved",this).call(this),Jb.unregister(this)}},{key:"viewTable",get:function(){var e=tk.instance.get(this.viewTableIdentifier);return e||(e=tk.instance.getObjects(tE)[0])&&(this.viewTableIdentifier.length<1||tk.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=e.identifier,Jb.trigger("SELECT_GAME_TABLE",{identifier:e.identifier})),e}}]),n}(ck),zm([pk()],lD.prototype,"viewTableIdentifier",void 0),lD=zm([fk("TableSelecter")],lD)),vD=((sD=function(){function e(){y(this,e)}return k(e,[{key:"createGameCharacter",value:function(e){var t=jk.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return t.location.x=e.x-25,t.location.y=e.y-25,t.posZ=e.z,t}},{key:"createGameTableMask",value:function(e){var t=this.getViewTable();if(t){var n=KC.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return n.location.x=e.x-25,n.location.y=e.y-25,n.posZ=e.z,t.appendChild(n),n}}},{key:"createTerrain",value:function(e){var t="./assets/images/tex.jpg",n=Dk.instance.get(t);n||(n=Dk.instance.add(t),Aw.create(n.identifier).tag="*default \u5730\u5f62");var i=this.getViewTable();if(i){var r=QC.create("\u5730\u5f62",2,2,2,n.identifier,n.identifier);return r.location.x=e.x-50,r.location.y=e.y-50,r.posZ=e.z,i.appendChild(r),r}}},{key:"createTextNote",value:function(e){var t=nE.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return t.location.x=e.x,t.location.y=e.y,t.posZ=e.z,t}},{key:"createDiceSymbol",value:function(e,t,n,i){var r=Vx.create(t,n,1),a=null;return r.nothingFaces.forEach(function(e){var t="./assets/images/dice/".concat(i,"/").concat(i,"[0].png");(a=Dk.instance.get(t))||(a=Dk.instance.add(t),Aw.create(a.identifier).tag="*default \u30c0\u30a4\u30b9"),r.imageDataElement.getFirstElementByName(e).value=a.identifier}),r.faces.forEach(function(e){var t="./assets/images/dice/".concat(i,"/").concat(i,"[").concat(e,"].png");(a=Dk.instance.get(t))||(a=Dk.instance.add(t),Aw.create(a.identifier).tag="*default \u30c0\u30a4\u30b9"),r.imageDataElement.getFirstElementByName(e).value=a.identifier}),r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,r}},{key:"createTrump",value:function(e){var t=Ux.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");t.location.x=e.x-25,t.location.y=e.y-25,t.posZ=e.z;var n="./assets/images/trump/z02.gif";if(!Dk.instance.get(n)){var i=Dk.instance.add(n);Aw.create(i.identifier).tag="*default \u30ab\u30fc\u30c9"}for(var r=[],a=0,o=["c","d","h","s"];a<o.length;a++)for(var s=o[a],l=1;l<=13;l++)r.push(s+("00"+l).slice(-2));r.push("x01"),r.push("x02");for(var c=0,u=r;c<u.length;c++){var h="./assets/images/trump/"+u[c]+".gif";if(!Dk.instance.get(h)){var d=Dk.instance.add(h);Aw.create(d.identifier).tag="*default \u30ab\u30fc\u30c9"}var f=jx.create("\u30ab\u30fc\u30c9",h,n);t.putOnBottom(f)}return t}},{key:"makeDefaultTable",value:function(){var e=new mD("tableSelecter");e.initialize();var t,n=new tE("gameTable"),i=Wm.createEmpty("testTableBackgroundImage_image").toContext();i.url="./assets/images/BG10a_80.jpg",t=Dk.instance.add(i),Aw.create(t.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",n.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",n.imageIdentifier=t.identifier,n.width=20,n.height=15,n.initialize(),e.viewTableIdentifier=n.identifier}},{key:"makeDefaultTabletopObjects",value:function(){var e=null,t=null,n=null;e=new jk("testCharacter_1"),(n=Wm.createEmpty("testCharacter_1_image").toContext()).url="./assets/images/mon_052.gif",t=Dk.instance.add(n),Aw.create(t.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,t.identifier),(e=new jk("testCharacter_2")).location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,t.identifier),e=new jk("testCharacter_3"),(n=Wm.createEmpty("testCharacter_3_image").toContext()).url="./assets/images/mon_128.gif",t=Dk.instance.add(n),Aw.create(t.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,t.identifier),e=new jk("testCharacter_4"),(n=Wm.createEmpty("testCharacter_4_image").toContext()).url="./assets/images/mon_150.gif",t=Dk.instance.add(n),Aw.create(t.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,t.identifier),e=new jk("testCharacter_5"),(n=Wm.createEmpty("testCharacter_5_image").toContext()).url="./assets/images/mon_211.gif",t=Dk.instance.add(n),Aw.create(t.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,t.identifier),e=new jk("testCharacter_6"),(n=Wm.createEmpty("testCharacter_6_image").toContext()).url="./assets/images/mon_135.gif",t=Dk.instance.add(n),Aw.create(t.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,t.identifier)}},{key:"makeDefaultContextMenuActions",value:function(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e)]}},{key:"getCreateCharacterMenu",value:function(e){var t=this;return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:function(){var n=t.createGameCharacter(e);Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:n.identifier,className:n.aliasName}),Mw.play(Iw.piecePut)}}}},{key:"getCreateTableMaskMenu",value:function(e){var t=this;return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:function(){t.createGameTableMask(e),Mw.play(Iw.cardPut)}}}},{key:"getCreateTerrainMenu",value:function(e){var t=this;return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:function(){t.createTerrain(e),Mw.play(Iw.blockPut)}}}},{key:"getCreateTextNoteMenu",value:function(e){var t=this;return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:function(){t.createTextNote(e),Mw.play(Iw.cardPut)}}}},{key:"getCreateTrumpMenu",value:function(e){var t=this;return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:function(){t.createTrump(e),Mw.play(Iw.cardPut)}}}},{key:"getCreateDiceSymbolMenu",value:function(e){var t=this,n=[];return[{menuName:"D4",diceName:"D4",type:Hx.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:Hx.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:Hx.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:Hx.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:Hx.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:Hx.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:Hx.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:Hx.D20,imagePathPrefix:"20_dice"}].forEach(function(i){n.push({name:i.menuName,action:function(){t.createDiceSymbol(e,i.diceName,i.type,i.imagePathPrefix),Mw.play(Iw.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:n}}},{key:"getViewTable",value:function(){var e=tk.instance.get("tableSelecter");return e?e.viewTable:null}}]),e}()).\u0275fac=function(e){return new(e||sD)},sD.\u0275prov=Ae({token:sD,factory:sD.\u0275fac,providedIn:"root"}),sD),yD=((oD=function(){function e(t,n,i,r,a,o){y(this,e),this.ngZone=t,this.elementRef=n,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=a,this.tabletopService=o,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new fc,this.ondragstart=new fc,this.ondrag=new fc,this.ondragend=new fc,this.onend=new fc,this._posX=0,this._posY=0,this._posZ=0,this.pointer3d={x:0,y:0,z:0},this.pointerOffset3d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.pointerPrev3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}return k(e,[{key:"option",set:function(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}},{key:"posX",get:function(){return this._posX},set:function(e){this._posX=e,this.setUpdateTimer()}},{key:"posY",get:function(){return this._posY},set:function(e){this._posY=e,this.setUpdateTimer()}},{key:"posZ",get:function(){return this._posZ},set:function(e){this._posZ=e,this.setUpdateTimer()}},{key:"isGridSnap",get:function(){var e=tk.instance.get("tableSelecter");return!!e&&e.gridSnap}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){t.isSendFromSelf&&e.input.isGrabbing||t.data.identifier!==e.tabletopObject.identifier||!e.shouldTransition(e.tabletopObject)||e.batchService.add(function(){e.input.isGrabbing?e.cancel():e.setAnimatedTransition(!0),e.stopTransition(),e.setPosition(e.tabletopObject)},e)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}},{key:"ngOnDestroy",value:function(){this.cancel(),this.input.destroy(),this.unregister(),Jb.unregister(this),this.batchService.remove(this)}},{key:"cancel",value:function(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable.gridHeight=0}},{key:"onInputStart",value:function(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract);var t=document.elementFromPoint(this.input.pointer.x,this.input.pointer.y);this.pointer3d=this.coordinateService.calcTabletopLocalCoordinate(this.input.pointer,t),this.setPointerEvents(!0),this.pointerOffset3d.x=this.posX-this.pointer3d.x,this.pointerOffset3d.y=this.posY-this.pointer3d.y,this.pointerOffset3d.z=this.posZ-this.pointer3d.z,this.pointerStart3d.x=this.pointerPrev3d.x=this.pointer3d.x,this.pointerStart3d.y=this.pointerPrev3d.y=this.pointer3d.y,this.pointerStart3d.z=this.pointerPrev3d.z=this.pointer3d.z,this.ratio=1,this.pointer3d.z!==this.posZ&&(this.ratio/=Math.abs(this.pointer3d.z-this.posZ)/2),this.width=this.input.target.clientWidth,this.height=this.input.target.clientHeight,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}},{key:"onInputMove",value:function(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);var t=document.elementFromPoint(this.input.pointer.x,this.input.pointer.y);if(null!=t&&(this.pointer3d=this.coordinateService.calcTabletopLocalCoordinate(this.input.pointer,t),this.pointerPrev3d.x!==this.pointer3d.x||this.pointerPrev3d.y!==this.pointer3d.y||this.pointerPrev3d.z!==this.pointer3d.z)){this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);var n=this.calcDistanceRatio(this.pointerStart3d,this.pointer3d);n<this.ratio&&(this.ratio=n),this.pointerPrev3d.x=this.pointer3d.x,this.pointerPrev3d.y=this.pointer3d.y,this.pointerPrev3d.z=this.pointer3d.z,this.posX=this.pointer3d.x+this.pointerOffset3d.x*this.ratio+-this.width/2*(1-this.ratio),this.posY=this.pointer3d.y+this.pointerOffset3d.y*this.ratio+-this.height/2*(1-this.ratio),this.posZ=this.pointer3d.z,tk.instance.get("tableSelecter").viewTable.gridHeight=this.posZ+.5}}},{key:"onInputEnd",value:function(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}},{key:"onContextMenu",value:function(e){var t=this;if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();var n=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),n){e.stopPropagation();var i=new MouseEvent(e.type,e);this.ngZone.run(function(){return t.input.target.dispatchEvent(i)})}}},{key:"callSelectedEvent",value:function(){this.tabletopObject&&Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}},{key:"calcDistanceRatio",value:function(e,t){var n=this.collidableElements[0].clientWidth,i=this.collidableElements[0].clientHeight,r=Math.sqrt(n*n+i*i);r=r<1?1:3*r;var a=e.x-t.x,o=100*(e.z-t.z);return r/(Math.sqrt(Math.pow(e.y-t.y,2)+Math.pow(a,2)+Math.pow(o,2))+r)}},{key:"snapToGrid",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:25;this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}},{key:"calcSnapNum",value:function(e,t){return t<=0?e:(e=e<0?e-t/2:e+t/2)-e%t}},{key:"setPosition",value:function(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}},{key:"setUpdateTimer",value:function(){var e=this;null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(function(){e.tabletopObject.location.x=e.posX,e.tabletopObject.location.y=e.posY,e.tabletopObject.posZ=e.posZ,e.updateTimer=null},66)),this.updateTransformCss()}},{key:"findCollidableElements",value:function(){this.collidableElements=[],"none"===getComputedStyle(this.input.target).pointerEvents?this.findNestedCollidableElements(this.input.target):this.collidableElements=[this.input.target]}},{key:"findNestedCollidableElements",value:function(e){for(var t=e.children,n=0;n<t.length;n++){var i=t[n];i instanceof HTMLElement&&"none"!==getComputedStyle(i).pointerEvents&&this.collidableElements.push(i)}if(this.collidableElements.length<1)for(var r=0;r<t.length;r++){var a=t[r];a instanceof HTMLElement&&this.findNestedCollidableElements(a)}}},{key:"setPointerEvents",value:function(e){var t=e?"auto":"none";this.collidableElements.forEach(function(e){return e.style.pointerEvents=t})}},{key:"setAnimatedTransition",value:function(e){this.input&&(this.input.target.style.transition=e?"transform 132ms linear":"")}},{key:"shouldTransition",value:function(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}},{key:"stopTransition",value:function(){this.input.target.style.transform=window.getComputedStyle(this.input.target).transform}},{key:"updateTransformCss",value:function(){this.input&&(this.input.target.style.transform=this.transformCssOffset+" translateX("+this.posX+"px) translateY("+this.posY+"px) translateZ("+this.posZ+"px)")}},{key:"setCollidableLayer",value:function(t){var n=this,i=t;for(var r in e.layerHash)i=-1<this.colideLayers.indexOf(r)?"character"==r?!this.input.isGrabbing||t&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||t:!t,e.layerHash[r].forEach(function(e){e===n||e.input.isGrabbing||e.setPointerEvents(i)})}},{key:"register",value:function(){this.layerName in e.layerHash||(e.layerHash[this.layerName]=[]),e.layerHash[this.layerName].indexOf(this)<0&&e.layerHash[this.layerName].push(this)}},{key:"unregister",value:function(){if(this.layerName in e.layerHash){var t=e.layerHash[this.layerName].indexOf(this);-1<t&&e.layerHash[this.layerName].splice(t,1)}}}]),e}()).layerHash={},oD.\u0275fac=function(e){return new(e||oD)(Vo($c),Vo(ll),Vo(kO),Vo(DC),Vo(uI),Vo(hI))},oD.\u0275dir=mt({type:oD,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),oD),bD=((aD=function(){function e(t,n,i,r,a,o){y(this,e),this.ngZone=t,this.elementRef=n,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=a,this.tabletopService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new fc,this.ondragstart=new fc,this.ondrag=new fc,this.ondragend=new fc,this.onend=new fc,this._rotate=0,this.valueChange=new fc,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}return k(e,[{key:"option",set:function(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}},{key:"rotate",get:function(){return this._rotate},set:function(e){this._rotate=e,this.setUpdateTimer()}},{key:"value",set:function(e){this._rotate=e,this.updateTransformCss()}},{key:"isAllowedToRotate",get:function(){if(!this.grabbingElement||!this.input.target)return!1;if(this.grabbingSelecter.length<1)return!0;for(var e=this.input.target.querySelectorAll(this.grabbingSelecter),t=0;t<e.length;t++)if(e[t].contains(this.grabbingElement))return!0;return!1}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){t.isSendFromSelf&&e.input.isGrabbing||t.data.identifier!==e.tabletopObject.identifier||!e.shouldTransition(e.tabletopObject)||e.batchService.add(function(){e.input.isGrabbing?e.cancel():e.setAnimatedTransition(!0),e.stopTransition(),e.setRotate(e.tabletopObject)},e)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}},{key:"ngOnDestroy",value:function(){this.cancel(),this.input.destroy(),Jb.unregister(this),this.batchService.remove(this)}},{key:"cancel",value:function(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable.gridHeight=0}},{key:"onInputStart",value:function(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);var t=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.input.target.parentElement);this.rotateOffset=this.calcRotate(t,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}},{key:"onInputMove",value:function(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();var t=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.input.target.parentElement),n=this.calcRotate(t,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=n}},{key:"onInputEnd",value:function(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.onend.emit(e)}},{key:"onContextMenu",value:function(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}},{key:"calcRotate",value:function(e,t){return(180*Math.atan2(e.y-this.input.target.clientHeight/2,e.x-this.input.target.clientWidth/2)/Math.PI-t)%360}},{key:"snapToPolygonal",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:24;e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}},{key:"setUpdateTimer",value:function(){var e=this;null===this.updateTimer&&(this.updateTimer=setTimeout(function(){e.valueChange.emit(e.rotate),e.tabletopObject&&(e.tabletopObject.rotate=e.rotate),e.updateTimer=null},66)),this.updateTransformCss()}},{key:"setRotate",value:function(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}},{key:"setAnimatedTransition",value:function(e){this.input&&(this.input.target.style.transition=e?"transform 132ms linear":"")}},{key:"shouldTransition",value:function(e){return e.rotate!==this.rotate}},{key:"stopTransition",value:function(){this.input.target.style.transform=window.getComputedStyle(this.input.target).transform}},{key:"updateTransformCss",value:function(){this.input&&(this.input.target.style.transform=this.transformCssOffset+" rotateZ("+this.rotate+"deg)")}}]),e}()).\u0275fac=function(e){return new(e||aD)(Vo($c),Vo(ll),Vo(kO),Vo(DC),Vo(uI),Vo(hI))},aD.\u0275dir=mt({type:aD,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),aD),kD=function(e){return{"blinking-animation":e}};function _D(e,t){if(1&e&&(Zo(0,"div",6),hc(1,"safe"),Yo()),2&e){var n=is(2);ks("background-image",dc(1,3,"url("+n.floorImage.url+")","style")),Wo("ngClass",rc(6,kD,!n.isLocked))}}var wD=function(e,t){return{"backface-visibility":e,transform:t}};function xD(e,t){if(1&e&&(Xo(0),Uo(1,_D,2,8,"div",4),Zo(2,"div",5),hc(3,"safe"),Yo(),Ko()),2&e){var n=is();sa(1),Wo("ngIf",n.isDropShadow&&(0!=n.terreinAltitude||n.isSlope&&!n.hasWall)),sa(1),ks("background-image",dc(3,5,"url("+n.floorImage.url+")","style")),Wo("ngClass",rc(8,kD,!n.isLocked))("ngStyle",ac(10,wD,n.isSlope?"visible":"hidden","translateZ("+(n.height/(n.isSlope?2:1)+n.altitude)*n.gridSize+"px)"+(n.isSlope?" rotateX("+-n.math.atan(n.height/n.depth)+"rad) scaleY("+1/n.math.cos(n.math.atan(n.height/n.depth))+")":"")))}}var CD=function(e,t){return{"blinking-animation":e,"no-shadow":t}},ED=function(e){return{transform:e}};function SD(e,t){if(1&e&&(Zo(0,"div",10),hc(1,"safe"),Yo()),2&e){var n=is(2);ks("background-image",dc(1,8,"url("+n.wallImage.url+")","style"))("width",n.width*n.gridSize,"px")("height",n.height*n.gridSize,"px"),Wo("ngClass",ac(11,CD,!n.isLocked,!n.isSurfaceShading))("ngStyle",rc(14,ED,"translateZ("+n.altitude*n.gridSize+"px) translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)"))}}function TD(e,t){if(1&e&&(Zo(0,"div",12),hc(1,"safe"),Yo()),2&e){var n=is(3);ks("background-image",dc(1,8,"url("+n.wallImage.url+")","style"))("width",n.width*n.gridSize,"px")("height",n.height*n.gridSize,"px"),Wo("ngClass",ac(11,CD,!n.isLocked,!n.isSurfaceShading))("ngStyle",rc(14,ED,"translateZ("+n.altitude*n.gridSize+"px) rotateX(-90deg)"))}}function OD(e,t){if(1&e&&(Xo(0),Uo(1,TD,2,16,"div",11),Ko()),2&e){var n=is(2);sa(1),Wo("ngIf",n.isVisibleWallTopBottom)}}var ID=function(e,t,n){return{"blinking-animation":e,"no-shadow":t,"is-slope":n}};function MD(e,t){if(1&e&&(Zo(0,"div",13),hc(1,"safe"),Yo()),2&e){var n=is(2);ks("background-image",dc(1,8,"url("+n.wallImage.url+")","style"))("width",n.depth*n.gridSize,"px")("height",n.height*n.gridSize,"px"),Wo("ngClass",oc(11,ID,!n.isLocked,!n.isSurfaceShading,n.isSlope))("ngStyle",rc(15,ED,"translateZ("+n.altitude*n.gridSize+"px) rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)"))}}function AD(e,t){if(1&e&&(Zo(0,"div",14),hc(1,"safe"),Yo()),2&e){var n=is(2);ks("background-image",dc(1,8,"url("+n.wallImage.url+")","style"))("width",n.depth*n.gridSize,"px")("height",n.height*n.gridSize,"px"),Wo("ngClass",oc(11,ID,!n.isLocked,!n.isSurfaceShading,n.isSlope))("ngStyle",rc(15,ED,"translateZ("+n.altitude*n.gridSize+"px) rotateZ(-90deg) rotateX(-90deg) translateY(-100%)"))}}function PD(e,t){if(1&e&&(Xo(0),Uo(1,SD,2,16,"div",7),Uo(2,OD,2,1,"ng-container",2),Uo(3,MD,2,17,"div",8),Uo(4,AD,2,17,"div",9),Ko()),2&e){var n=is();sa(1),Wo("ngIf",n.isVisibleWallTopBottom),sa(1),Wo("ngIf",!n.isSlope),sa(1),Wo("ngIf",n.isVisibleWallLeftRight),sa(1),Wo("ngIf",n.isVisibleWallLeftRight)}}function DD(e,t){if(1&e&&(Xo(0),Zo(1,"div"),qo(2,"div",15),Zo(3,"div",16),Zo(4,"i",17),zs(5,"autorenew"),Yo(),Yo(),Zo(6,"div",18),Zo(7,"i",17),zs(8,"autorenew"),Yo(),Yo(),Zo(9,"div",19),Zo(10,"i",17),zs(11,"autorenew"),Yo(),Yo(),Zo(12,"div",20),Zo(13,"i",17),zs(14,"autorenew"),Yo(),Yo(),Yo(),Ko()),2&e){var n=is();sa(1),ks("opacity",n.isInteract?"1.0":"0.5")}}var RD=function(e){return{transform:e}};function FD(e,t){if(1&e&&(Zo(0,"div",21),Zo(1,"div",22),zs(2),Yo(),Zo(3,"div",23),zs(4),Yo(),Yo()),2&e){var n=is();ks("height",n.math.abs(n.terreinAltitude*n.gridSize),"px"),Wo("ngStyle",rc(5,RD,"translateX("+n.width*n.gridSize/2+"px) translateY("+-n.depth*n.gridSize/2+"px) rotateX(-90deg) translateY("+(n.terreinAltitude>0?-(n.altitude+(n.isSlope||n.isWallExist?0:n.height))*n.gridSize:0)+"px) rotateY("+n.viewRotateZ+"deg)")),sa(2),Ls(n.math.abs(n.terreinAltitude)),sa(2),Ls(n.math.abs(n.terreinAltitude))}}var ND,zD=function(e){return{"is-grab":e}},LD=((ND=function(){function e(t,n,i,r,a,o,s,l,c,u){y(this,e),this.ngZone=t,this.imageService=n,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=a,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=l,this.modalService=c,this.coordinateService=u,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.input=null,this.viewRotateZ=10}return k(e,[{key:"name",get:function(){return this.terrain.name}},{key:"mode",get:function(){return this.terrain.mode},set:function(e){this.terrain.mode=e}},{key:"isLocked",get:function(){return this.terrain.isLocked},set:function(e){this.terrain.isLocked=e}},{key:"hasWall",get:function(){return this.terrain.hasWall}},{key:"hasFloor",get:function(){return this.terrain.hasFloor}},{key:"wallImage",get:function(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}},{key:"floorImage",get:function(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}},{key:"height",get:function(){return this.adjustMinBounds(this.terrain.height)}},{key:"width",get:function(){return this.adjustMinBounds(this.terrain.width)}},{key:"depth",get:function(){return this.adjustMinBounds(this.terrain.depth)}},{key:"altitude",get:function(){return this.terrain.altitude},set:function(e){this.terrain.altitude=e}},{key:"isDropShadow",get:function(){return this.terrain.isDropShadow},set:function(e){this.terrain.isDropShadow=e}},{key:"isSurfaceShading",get:function(){return this.terrain.isSurfaceShading},set:function(e){this.terrain.isSurfaceShading=e}},{key:"isInteract",get:function(){return this.terrain.isInteract},set:function(e){this.terrain.isInteract=e}},{key:"isSlope",get:function(){return this.terrain.isSlope},set:function(e){this.terrain.isSlope=e}},{key:"isAltitudeIndicate",get:function(){return this.terrain.isAltitudeIndicate},set:function(e){this.terrain.isAltitudeIndicate=e}},{key:"isVisibleFloor",get:function(){return 0<this.width*this.depth}},{key:"isVisibleWallTopBottom",get:function(){return 0<this.width*this.height}},{key:"isVisibleWallLeftRight",get:function(){return 0<this.depth*this.height}},{key:"isWallExist",get:function(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}},{key:"terreinAltitude",get:function(){var e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.terrain&&n&&(e.terrain===n||n instanceof dk&&e.terrain.contains(n))&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,function(t){e.ngZone.run(function(){e.viewRotateZ=t.data.z,e.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}},{key:"ngOnDestroy",value:function(){this.input.destroy(),Jb.unregister(this)}},{key:"onDragstart",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onInputStart",value:function(e){this.input.cancel(),this.isLocked&&Jb.trigger("DRAG_LOCKED_OBJECT",{})}},{key:"onContextMenu",value:function(e){var t=this;if(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu){var n=this.pointerDeviceService.pointers[0],i=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(n,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:function(){t.isLocked=!1,Mw.play(Iw.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:function(){t.isLocked=!0,Mw.play(Iw.lock)}},ww,this.isSlope?{name:"\u2611 \u50be\u659c",action:function(){t.isSlope=!1}}:{name:"\u2610 \u50be\u659c",action:function(){t.isSlope=!0}},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:function(){t.mode=$C.ALL,t.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:function(){t.mode=$C.ALL,t.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:function(){t.mode=$C.FLOOR,t.depth*t.width==0&&(t.terrain.width=t.width<=0?1:t.width,t.terrain.depth=t.depth<=0?1:t.depth)}}]},ww,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:function(){t.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:function(){t.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:function(){0!=t.altitude&&(t.altitude=0,Mw.play(Iw.sweep))},altitudeHande:this.terrain},ww,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:function(){t.showDetail(t.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.terrain.name,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}})},this.terrain.getUrls().length<=0?null:ww,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.terrain.clone();e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.isLocked=!1,t.terrain.parent&&t.terrain.parent.appendChild(e),Mw.play(Iw.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:function(){t.terrain.destroy(),Mw.play(Iw.sweep)}},ww,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(i)}],this.name)}}},{key:"onMove",value:function(){Mw.play(Iw.blockPick)}},{key:"onMoved",value:function(){Mw.play(Iw.blockPut)}},{key:"adjustMinBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t?t:e}},{key:"showDetail",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-250,top:t.y-150,width:550,height:380}).tabletopObject=e}}]),e}()).\u0275fac=function(e){return new(e||ND)(Vo($c),Vo(BA),Vo(vD),Vo(xw),Vo(ll),Vo(Wk),Vo(Dl),Vo(DC),Vo(Zk),Vo(uI))},ND.\u0275cmp=ct({type:ND,selectors:[["terrain"]],hostBindings:function(e,t){1&e&&es("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","texture",3,"ngClass","background-image",4,"ngIf"],[1,"texture",3,"ngClass","ngStyle"],[1,"texture",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],["class","texture of-wall-top",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],["class","texture of-wall-left",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],["class","texture of-wall-right",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],[1,"texture","of-wall-top",3,"ngClass","ngStyle"],["class","texture of-wall-bottom",3,"ngClass","background-image","width","height","ngStyle",4,"ngIf"],[1,"texture","of-wall-bottom",3,"ngClass","ngStyle"],[1,"texture","of-wall-left",3,"ngClass","ngStyle"],[1,"texture","of-wall-right",3,"ngClass","ngStyle"],[1,"pedestal-grab","rotate-grab"],[1,"rotate-grab","of-left-top","rotate-grab-icon"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon"],[1,"rotate-grab","of-right-top","rotate-grab-icon"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Zo(1,"div",1),es("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Uo(2,xD,4,13,"ng-container",2),Uo(3,PD,5,4,"ng-container",2),Uo(4,DD,15,2,"ng-container",2),Yo(),Uo(5,FD,5,7,"div",3),Yo()),2&e&&(ks("width",t.width*t.gridSize,"px")("height",t.depth*t.gridSize,"px"),Wo("movable.option",t.movableOption)("movable.disable",t.isLocked)("movable.interact",t.isInteract),sa(1),Wo("ngClass",rc(14,zD,!t.isLocked))("rotable.option",t.rotableOption)("rotable.disable",t.isLocked),sa(1),Wo("ngIf",t.hasFloor&&t.isVisibleFloor&&0<(null==t.floorImage?null:t.floorImage.url.length)),sa(1),Wo("ngIf",t.isWallExist),sa(1),Wo("ngIf",!t.isLocked),sa(1),Wo("ngIf",t.isAltitudeIndicate&&!((t.isSlope||t.isWallExist)&&-t.height<t.altitude&&t.altitude<0)&&(t.terreinAltitude<=-.5||.5<=t.terreinAltitude)))},directives:[yD,bD,lh,dh,Sh],pipes:[Lw],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%], .texture[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0 0;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translateX(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0,0 100%,100% 100%);clip-path:polygon(100% 0,0 100%,100% 100%)}.of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%], .of-wall-top.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border:7px solid #ccc;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:2px solid #ccc;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px 14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px 7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px 14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px 7px 14px}.blinking-animation[_ngcontent-%COMP%]{-webkit-animation:blink 1s linear infinite alternate;animation:blink 1s linear infinite alternate}@-webkit-keyframes blink{0%{opacity:.9}to{opacity:.5}}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0 0 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}"],changeDetection:0}),ND);function BD(e,t){1&e&&qo(0,"div")}function jD(e,t){1&e&&qo(0,"div",5),2&e&&ks("background-color","rgba(10, 10, 10,"+is().opacity+")")}function UD(e,t){if(1&e&&(Zo(0,"div",6),qo(1,"img",7),hc(2,"safe"),Yo()),2&e){var n=is();sa(1),ks("opacity",n.opacity),Wo("src",dc(2,3,n.imageFile.url,"resourceUrl"),dr)}}function HD(e,t){1&e&&(Zo(0,"div",8),Zo(1,"i",9),zs(2,"lock"),Yo(),Yo())}var VD,WD=function(e){return{"is-grab":e}},GD=((VD=function(){function e(t,n,i,r,a,o,s,l,c){y(this,e),this.ngZone=t,this.tabletopActionService=n,this.contextMenuService=i,this.elementRef=r,this.panelService=a,this.changeDetector=o,this.pointerDeviceService=s,this.modalService=l,this.coordinateService=c,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.input=null}return k(e,[{key:"name",get:function(){return this.gameTableMask.name}},{key:"width",get:function(){return this.adjustMinBounds(this.gameTableMask.width)}},{key:"height",get:function(){return this.adjustMinBounds(this.gameTableMask.height)}},{key:"opacity",get:function(){return this.gameTableMask.opacity}},{key:"imageFile",get:function(){return this.gameTableMask.imageFile}},{key:"isLock",get:function(){return this.gameTableMask.isLock},set:function(e){this.gameTableMask.isLock=e}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.gameTableMask&&n&&(e.gameTableMask===n||n instanceof dk&&e.gameTableMask.contains(n))&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]}}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}},{key:"ngOnDestroy",value:function(){this.input.destroy(),Jb.unregister(this)}},{key:"onDragstart",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onInputStart",value:function(e){this.input.cancel(),this.isLock&&Jb.trigger("DRAG_LOCKED_OBJECT",{})}},{key:"onContextMenu",value:function(e){var t=this;if(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu){var n=this.pointerDeviceService.pointers[0],i=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(n,[this.isLock?{name:"\u2611 \u56fa\u5b9a",action:function(){t.isLock=!1,Mw.play(Iw.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:function(){t.isLock=!0,Mw.play(Iw.lock)}},ww,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:function(){t.showDetail(t.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.gameTableMask.name,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}})},this.gameTableMask.getUrls().length<=0?null:ww,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",e),e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.isLock=!1,t.gameTableMask.parent&&t.gameTableMask.parent.appendChild(e),Mw.play(Iw.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:function(){t.gameTableMask.destroy(),Mw.play(Iw.sweep)}},ww,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(i)}],this.name)}}},{key:"onMove",value:function(){Mw.play(Iw.cardPick)}},{key:"onMoved",value:function(){Mw.play(Iw.cardPut)}},{key:"adjustMinBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t?t:e}},{key:"showDetail",value:function(e){var t=this.pointerDeviceService.pointers[0],n="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-200,top:t.y-150,width:400,height:330}).tabletopObject=e}}]),e}()).\u0275fac=function(e){return new(e||VD)(Vo($c),Vo(vD),Vo(xw),Vo(ll),Vo(Wk),Vo(Dl),Vo(DC),Vo(Zk),Vo(uI))},VD.\u0275cmp=ct({type:VD,selectors:[["game-table-mask"]],hostBindings:function(e,t){1&e&&es("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:7,vars:13,consts:[["appMovable","",1,"component",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[4,"ngIf","ngIfThen","ngIfElse"],["blackMask",""],["imageMask",""],["class","lock-icon is-center",4,"ngIf"],[1,"border","is-fit-full"],[1,"border","image","is-fit-full"],[1,"is-fit-full",2,"display","block",3,"src"],[1,"lock-icon","is-center"],[1,"material-icons"]],template:function(e,t){if(1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Uo(1,BD,1,0,"div",1),Uo(2,jD,1,2,"ng-template",null,2,Ic),Uo(4,UD,3,6,"ng-template",null,3,Ic),Uo(6,HD,3,0,"div",4),Yo()),2&e){var n=Ho(3),i=Ho(5);ks("width",t.width*t.gridSize,"px")("height",t.height*t.gridSize,"px"),Wo("ngClass",rc(11,WD,!t.isLock))("movable.option",t.movableOption)("movable.disable",t.isLock),sa(1),Wo("ngIf",t.imageFile.url.length<1)("ngIfThen",n)("ngIfElse",i),sa(5),Wo("ngIf",t.isLock)}},directives:[yD,lh,dh],pipes:[Lw],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:2px solid transparent}.image.border[_ngcontent-%COMP%]{border-width:0}.component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:2px solid #ccc}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}"],changeDetection:0}),VD),ZD=["textArea"];function YD(e,t){if(1&e&&(Zo(0,"div",14),zs(1),Yo()),2&e){var n=is();sa(1),Ls(n.title)}}var qD=function(e){return{"is-grab":e}},XD=function(e){return{transform:e}};function KD(e,t){if(1&e&&qo(0,"div",15),2&e){var n=is();ks("width",(n.width-1)*n.gridSize,"px")("min-height",n.gridSize/2,"px"),Wo("ngClass",rc(6,qD,!n.isLocked))("ngStyle",rc(8,XD,"translateX("+n.gridSize/2+"px) translateY("+-n.gridSize/4+"px)"))}}function $D(e,t){1&e&&(Zo(0,"div"),Zo(1,"div",9),Zo(2,"i",10),zs(3,"autorenew"),Yo(),Yo(),Zo(4,"div",11),Zo(5,"i",10),zs(6,"autorenew"),Yo(),Yo(),Yo())}var QD=function(e){return{transform:e}};function JD(e,t){if(1&e&&(Zo(0,"div",16),Zo(1,"div",17),Zo(2,"span",18),zs(3),Yo(),Zo(4,"span",19),zs(5),Yo(),Yo(),Yo()),2&e){var n=is();ks("height",n.math.abs(n.textNoteAltitude*n.gridSize),"px"),Wo("ngStyle",rc(5,QD,"rotateX(-90deg) translateY("+(n.altitude>0?-n.altitude*n.gridSize:0)+"px) rotateY("+n.viewRotateZ+"deg)")),sa(3),Ls(n.math.abs(n.textNoteAltitude)),sa(2),Ls(n.textNoteAltitude)}}var eR,tR=function(e,t,n){return{"is-pointer-events-none":e,"is-pointer-events-auto":t,"is-outline-text":n}},nR=((eR=function(){function e(t,n,i,r,a,o){var s=this;y(this,e),this.ngZone=t,this.contextMenuService=n,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=a,this.modalService=o,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=function(e){return s.onMouseUp(e)},this.gridSize=50,this.math=Math,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10}return k(e,[{key:"title",get:function(){return this.textNote.title}},{key:"text",get:function(){return this.calcFitHeightIfNeeded(),this.textNote.text},set:function(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}},{key:"fontSize",get:function(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}},{key:"imageFile",get:function(){return this.textNote.imageFile}},{key:"rotate",get:function(){return this.textNote.rotate},set:function(e){this.textNote.rotate=e}},{key:"height",get:function(){return this.adjustMinBounds(this.textNote.height)}},{key:"width",get:function(){return this.adjustMinBounds(this.textNote.width)}},{key:"altitude",get:function(){return this.textNote.altitude},set:function(e){this.textNote.altitude=e}},{key:"textNoteAltitude",get:function(){var e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}},{key:"isUpright",get:function(){return this.textNote.isUpright},set:function(e){this.textNote.isUpright=e}},{key:"isAltitudeIndicate",get:function(){return this.textNote.isAltitudeIndicate},set:function(e){this.textNote.isAltitudeIndicate=e}},{key:"isLocked",get:function(){return this.textNote.isLocked},set:function(e){this.textNote.isLocked=e}},{key:"isSelected",get:function(){return document.activeElement===this.textAreaElementRef.nativeElement}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.textNote&&n&&(e.textNote===n||n instanceof dk&&e.textNote.contains(n))&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,function(t){e.ngZone.run(function(){e.viewRotateZ=t.data.z,e.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"onDragstart",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onMouseDown",value:function(e){this.isSelected||(e.preventDefault(),this.textNote.toTopmost(),2!==e.button?this.addMouseEventListeners():Jb.trigger("DRAG_LOCKED_OBJECT",{}))}},{key:"onMouseUp",value:function(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){var t=window.getSelection();t.isCollapsed||t.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}},{key:"onRotateMouseDown",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onContextMenu",value:function(e){var t=this;this.removeMouseEventListeners(),this.isSelected||(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:function(){t.isLocked=!1,Mw.play(Iw.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:function(){t.isLocked=!0,Mw.play(Iw.lock)}},ww,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:function(){t.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:function(){t.isUpright=!0}},ww,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:function(){0!=t.altitude&&(t.altitude=0,Mw.play(Iw.sweep))},altitudeHande:this.textNote},ww,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:function(){t.showDetail(t.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.textNote.title,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}})},this.textNote.getUrls().length<=0?null:ww,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.textNote.clone();e.isLocked=!1,console.log("\u30b3\u30d4\u30fc",e),e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.toTopmost(),Mw.play(Iw.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:function(){t.textNote.destroy(),Mw.play(Iw.sweep)}}],this.title))}},{key:"onMove",value:function(){Mw.play(Iw.cardPick)}},{key:"onMoved",value:function(){Mw.play(Iw.cardPut)}},{key:"calcFitHeightIfNeeded",value:function(){var e=this;this.calcFitHeightTimer||this.ngZone.runOutsideAngular(function(){e.calcFitHeightTimer=setTimeout(function(){e.calcFitHeight(),e.calcFitHeightTimer=null},0)})}},{key:"calcFitHeight",value:function(){var e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}},{key:"adjustMinBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t?t:e}},{key:"addMouseEventListeners",value:function(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}},{key:"removeMouseEventListeners",value:function(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}},{key:"showDetail",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(n+=" - "+e.title),this.panelService.open(cS,{title:n,left:t.x-350,top:t.y-200,width:700,height:400}).tabletopObject=e}}]),e}()).\u0275fac=function(e){return new(e||eR)(Vo($c),Vo(xw),Vo(Wk),Vo(Dl),Vo(DC),Vo(Zk))},eR.\u0275cmp=ct({type:eR,selectors:[["text-note"]],viewQuery:function(e,t){var n;1&e&&Sc(ZD,3),2&e&&Ec(n=Tc())&&(t.textAreaElementRef=n.first)},hostBindings:function(e,t){1&e&&es("dragstart",function(e){return t.onDragstart(e)})("mousedown",function(e){return t.onMouseDown(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:18,vars:35,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"upright-transform","is-3d","is-bg-color","is-bg-texture",3,"ngStyle"],["class","title is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Zo(1,"div",1),es("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Zo(2,"div",2),Zo(3,"div",3),hc(4,"safe"),Uo(5,YD,2,1,"div",4),Zo(6,"textarea",5,6),es("input",function(){return t.calcFitHeight()})("ngModelChange",function(e){return t.text=e}),Yo(),Yo(),Uo(8,KD,1,10,"div",7),Zo(9,"div",8),Zo(10,"div",9),Zo(11,"i",10),zs(12),Yo(),Yo(),Zo(13,"div",11),Zo(14,"i",10),zs(15),Yo(),Yo(),Yo(),Uo(16,$D,7,0,"div",12),Yo(),Yo(),Uo(17,JD,6,7,"div",13),Yo()),2&e&&(Wo("movable.option",t.movableOption)("movable.disable",t.isSelected||t.isLocked),sa(1),Wo("rotable.option",t.rotableOption)("rotable.disable",t.isLocked),sa(1),ks("width",t.width*t.gridSize,"px"),sa(1),ks("background-image",dc(4,24,"url("+(null==t.imageFile?null:t.imageFile.url)+")","style"))("width",t.width*t.gridSize,"px")("min-height",t.height*t.gridSize,"px"),Wo("ngStyle",rc(27,XD,"translateZ("+t.altitude*t.gridSize+"px) rotateY(90deg) rotateZ("+(t.isUpright?-90:0)+"deg) rotateY(-90deg)")),sa(2),Wo("ngIf",t.title.length),sa(1),ks("font-size",t.fontSize+9,"px"),Wo("ngClass",oc(29,tR,!t.isSelected,t.isSelected,!t.isSelected))("ngModel",t.text),sa(2),Wo("ngIf",!t.isLocked),sa(1),Wo("ngStyle",rc(33,XD,"translateZ("+t.altitude*t.gridSize+"px)")),sa(3),Ls(t.isLocked?"lock":"autorenew"),sa(3),Ls(t.isLocked?"lock":"autorenew"),sa(1),Wo("ngIf",!t.isLocked),sa(1),Wo("ngIf",t.isAltitudeIndicate&&t.math.abs(t.textNoteAltitude)>=.5))},directives:[yD,bD,Sh,dh,Ed,lh,Xd,Ef],pipes:[Lw],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:0;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translateX(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:rgba(240,218,189,.9);border:1px solid #999}.title[_ngcontent-%COMP%]{font-size:15px;padding:3px 9px;white-space:nowrap;text-overflow:ellipsis}.textarea[_ngcontent-%COMP%], .title[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:focus{background:hsla(0,0%,100%,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px,#f2f2f2 0 0 .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0 0 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}"],changeDetection:0}),eR),iR=["draggablePanel"];function rR(e,t){1&e&&$o(0)}function aR(e,t){1&e&&$o(0)}var oR=function(e){return{card:e}};function sR(e,t){if(1&e&&(Xo(0),Uo(1,aR,1,0,"ng-container",12),Ko()),2&e){var n=is(),i=Ho(12);sa(1),Wo("ngTemplateOutlet",i)("ngTemplateOutletContext",rc(2,oR,n.tabletopObject))}}function lR(e,t){1&e&&$o(0)}function cR(e,t){if(1&e&&(Xo(0),Uo(1,lR,1,0,"ng-container",12),Ko()),2&e){var n=is(),i=Ho(12);sa(1),Wo("ngTemplateOutlet",i)("ngTemplateOutletContext",rc(2,oR,n.tabletopObject))}}function uR(e,t){1&e&&$o(0)}var hR=function(e){return{note:e}};function dR(e,t){if(1&e&&(Xo(0),Uo(1,uR,1,0,"ng-container",12),Ko()),2&e){var n=is(),i=Ho(14);sa(1),Wo("ngTemplateOutlet",i)("ngTemplateOutletContext",rc(2,hR,n.tabletopObject))}}function fR(e,t){1&e&&$o(0)}var pR=function(e){return{character:e}};function gR(e,t){if(1&e&&(Xo(0),Uo(1,fR,1,0,"ng-container",12),Ko()),2&e){var n=is(),i=Ho(16);sa(1),Wo("ngTemplateOutlet",i)("ngTemplateOutletContext",rc(2,pR,n.tabletopObject))}}function mR(e,t){1&e&&$o(0)}var vR=function(e){return{dice:e}};function yR(e,t){if(1&e&&(Xo(0),Uo(1,mR,1,0,"ng-container",12),Ko()),2&e){var n=is(),i=Ho(18);sa(1),Wo("ngTemplateOutlet",i)("ngTemplateOutletContext",rc(2,vR,n.tabletopObject))}}function bR(e,t){1&e&&$o(0)}function kR(e,t){if(1&e&&(Xo(0),Uo(1,bR,1,0,"ng-container",12),Ko()),2&e){var n=is(),i=Ho(16);sa(1),Wo("ngTemplateOutlet",i)("ngTemplateOutletContext",rc(2,pR,n.tabletopObject))}}function _R(e,t){1&e&&$o(0)}function wR(e,t){if(1&e&&(Xo(0),Uo(1,_R,1,0,"ng-container",13),Ko()),2&e){is();var n=Ho(22);sa(1),Wo("ngTemplateOutlet",n)}}var xR=function(e){return{"with-button-marign":e}};function CR(e,t){if(1&e&&(Zo(0,"div",24),Zo(1,"div",25),zs(2),Yo(),Yo()),2&e){var n=is(2).card,i=is();Wo("ngClass",rc(4,xR,i.hasImage)),sa(1),ks("background-color",n.ownerColor),sa(1),Ls(n.ownerName)}}function ER(e,t){if(1&e){var n=Qo();Zo(0,"div",19),qo(1,"img",20),hc(2,"safe"),Zo(3,"button",21),es("click",function(){return Jt(n),is(2).chanageImageView(!0)}),Zo(4,"i",22),zs(5,"zoom_in"),Yo(),Yo(),Uo(6,CR,3,6,"div",23),Yo()}if(2&e){var i=is().card,r=is();sa(1),Wo("src",dc(2,2,r.imageUrl,"resourceUrl"),dr),sa(5),Wo("ngIf",i.hasOwner&&0<i.ownerName.length)}}function SR(e,t){if(1&e&&(Xo(0),zs(1),Ko()),2&e){var n=is(2).card;sa(1),Ls(n.name)}}function TR(e,t){1&e&&(Xo(0),zs(1,"\u30ab\u30fc\u30c9"),Ko())}function OR(e,t){if(1&e&&(Zo(0,"div",26),Uo(1,SR,2,1,"ng-container",5),Uo(2,TR,2,0,"ng-container",5),Yo()),2&e){var n=is().card,i=is();Wo("ngClass",rc(3,xR,i.hasImage)),sa(1),Wo("ngIf",null==n.isVisible||n.isVisible),sa(1),Wo("ngIf",null!=n.isVisible&&!n.isVisible)}}function IR(e,t){1&e&&$o(0)}var MR=function(e,t){return{dataElm:e,name:t}};function AR(e,t){if(1&e&&(Xo(0),Uo(1,IR,1,0,"ng-container",12),Ko()),2&e){var n=t.$implicit,i=is(2).card;is();var r=Ho(20);sa(1),Wo("ngTemplateOutlet",r)("ngTemplateOutletContext",ac(2,MR,n,i.name))}}function PR(e,t){if(1&e&&(Zo(0,"div",27),Zo(1,"div",28),Uo(2,AR,2,5,"ng-container",29),Yo(),Yo()),2&e){var n=is(2);sa(2),Wo("ngForOf",n.dataElms)}}var DR=function(e,t){return{"is-pointer-events-auto":e,"pointer-events-none":t}};function RR(e,t){if(1&e&&(Zo(0,"div",14),Uo(1,ER,7,5,"div",15),Uo(2,OR,3,5,"div",16),Zo(3,"div",17),Uo(4,PR,3,1,"div",18),Yo(),Yo()),2&e){var n=t.card,i=is();Wo("ngClass",ac(4,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Wo("ngIf",i.hasImage),sa(1),Wo("ngIf",0<(null==n||null==n.name?null:n.name.length)),sa(2),Wo("ngIf",i.hasDataElms&&n.isVisible)}}function FR(e,t){if(1&e&&(Zo(0,"div",30),Zo(1,"div",31),zs(2),Yo(),Zo(3,"div",32),Zo(4,"div",19),Zo(5,"div",33),Zo(6,"textarea",34),es("ngModelChange",function(e){return t.note.text=e}),Yo(),Yo(),Zo(7,"div",35),zs(8),Yo(),Yo(),Yo(),Yo()),2&e){var n=t.note,i=is();Wo("ngClass",ac(4,DR,!i.isPointerDragging,i.isPointerDragging)),sa(2),Ls(n.title),sa(4),Wo("ngModel",n.text),sa(2),Ls(n.text)}}var NR=function(e){return{transform:e}},zR=function(e,t){return{inverse:e,hollow:t}},LR=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}},BR=function(e){return{"black-paint":e}};function jR(e,t){if(1&e&&(Xo(0),Zo(1,"div",43),Zo(2,"div",44),Zo(3,"span",45),qo(4,"img",46),hc(5,"safe"),Yo(),Yo(),Yo(),Ko()),2&e){var n=is(3);sa(1),Wo("ngStyle",rc(8,NR,"rotate("+n.roll+"deg)")),sa(1),Wo("ngClass",ac(10,zR,n.isInverse,n.isHollow)),sa(1),Wo("ngClass",lc(13,LR,0==n.aura,1==n.aura,2==n.aura,3==n.aura,4==n.aura,5==n.aura,6==n.aura,7==n.aura)),sa(1),Wo("ngClass",rc(22,BR,n.isBlackPaint))("src",dc(5,5,n.imageUrl,"resourceUrl"),dr)}}function UR(e,t){if(1&e&&(Xo(0),qo(1,"img",47),hc(2,"safe"),Ko()),2&e){var n=is(3);sa(1),Wo("src",dc(2,1,n.imageUrl,"resourceUrl"),dr)}}var HR=function(e,t,n){return{"has-icon":e,"is-pointer-events-auto":t,"pointer-events-none":n}};function VR(e,t){if(1&e&&(Zo(0,"div",42),Uo(1,jR,6,24,"ng-container",5),Uo(2,UR,3,4,"ng-container",5),Yo()),2&e){var n=is(2);Wo("ngClass",oc(3,HR,n.isUseIcon,!n.isPointerDragging,n.isPointerDragging)),sa(1),Wo("ngIf",!n.isUseIcon),sa(1),Wo("ngIf",n.isUseIcon)}}function WR(e,t){1&e&&$o(0)}function GR(e,t){if(1&e&&(Xo(0),Zo(1,"div",28),Uo(2,WR,1,0,"ng-container",12),Yo(),Ko()),2&e){var n=is().$implicit,i=is(2).character;is();var r=Ho(20);sa(2),Wo("ngTemplateOutlet",r)("ngTemplateOutletContext",ac(2,MR,n,i.name))}}function ZR(e,t){if(1&e&&(Xo(0),Uo(1,GR,3,5,"ng-container",5),Ko()),2&e){var n=t.$implicit,i=is(3);sa(1),Wo("ngIf",n&&n.name!==i.newLineString)}}function YR(e,t){if(1&e&&(Zo(0,"div",27),Uo(1,ZR,2,1,"ng-container",29),Yo()),2&e){var n=is(2);sa(1),Wo("ngForOf",n.inventoryDataElms)}}function qR(e,t){if(1&e&&(Zo(0,"div",36),qo(1,"div",37),Uo(2,VR,3,7,"div",38),Zo(3,"div",39),zs(4),Yo(),qo(5,"div",40),Zo(6,"div",41),Uo(7,YR,2,1,"div",18),Yo(),Yo()),2&e){var n=t.character,i=is();sa(1),Wo("ngClass",ac(6,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Wo("ngIf",i.hasImage),sa(1),Wo("ngClass",ac(9,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Ls(n.name),sa(2),Wo("ngClass",ac(12,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Wo("ngIf",i.hasDataElms)}}function XR(e,t){if(1&e&&(Xo(0),zs(1),Ko()),2&e){var n=is().dice;sa(1),Ls(n.face)}}function KR(e,t){1&e&&(Xo(0),zs(1,"???"),Ko())}function $R(e,t){if(1&e&&(Zo(0,"div",49),Zo(1,"div",25),zs(2),Yo(),Yo()),2&e){var n=is().dice,i=is();Wo("ngClass",ac(4,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),ks("background-color",n.ownerColor),sa(1),Bs("",n.ownerName," ")}}var QR=function(e,t){return{"is-black-mask":e,"is-harf-black-mask":t}};function JR(e,t){if(1&e&&(Zo(0,"div",42),qo(1,"img",46),hc(2,"safe"),Yo()),2&e){var n=is().dice,i=is();Wo("ngClass",ac(6,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Wo("ngClass",ac(9,QR,!n.isVisible,n.isMine))("src",dc(2,3,i.imageUrl,"resourceUrl"),dr)}}function eF(e,t){1&e&&$o(0)}function tF(e,t){if(1&e&&(Xo(0),Uo(1,eF,1,0,"ng-container",12),Ko()),2&e){var n=is().$implicit,i=is(2).dice;is();var r=Ho(20);sa(1),Wo("ngTemplateOutlet",r)("ngTemplateOutletContext",ac(2,MR,n,i.name))}}function nF(e,t){if(1&e&&(Xo(0),Uo(1,tF,2,5,"ng-container",5),Ko()),2&e){var n=t.$implicit,i=is(3);sa(1),Wo("ngIf",n&&n.name!==i.newLineString)}}function iF(e,t){if(1&e&&(Zo(0,"div",27),Zo(1,"div",28),Uo(2,nF,2,1,"ng-container",29),Yo(),Yo()),2&e){var n=is(2);sa(2),Wo("ngForOf",n.dataElms)}}function rF(e,t){if(1&e&&(Zo(0,"div",36),qo(1,"div",37),Zo(2,"div",39),zs(3),Uo(4,XR,2,1,"ng-container",5),Uo(5,KR,2,0,"ng-container",5),Yo(),Uo(6,$R,3,7,"div",48),Uo(7,JR,3,12,"div",38),qo(8,"div",40),Zo(9,"div",41),Uo(10,iF,3,1,"div",18),Yo(),Yo()),2&e){var n=t.dice,i=is();sa(1),Wo("ngClass",ac(9,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Wo("ngClass",ac(12,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Bs(" ",n.name,": "),sa(1),Wo("ngIf",n.isVisible),sa(1),Wo("ngIf",!n.isVisible),sa(1),Wo("ngIf",n.hasOwner&&0<n.ownerName.length),sa(1),Wo("ngIf",i.hasImage),sa(2),Wo("ngClass",ac(15,DR,!i.isPointerDragging,i.isPointerDragging)),sa(1),Wo("ngIf",i.hasDataElms&&n.isVisible)}}function aF(e,t){1&e&&$o(0)}function oF(e,t){if(1&e&&(Zo(0,"div",56),zs(1),Yo()),2&e){var n=is(2).dataElm;Lo("title",n.name),sa(1),Ls(n.name)}}function sF(e,t){1&e&&$o(0)}function lF(e,t){if(1&e&&(Xo(0),Uo(1,sF,1,0,"ng-container",12),Ko()),2&e){var n=t.$implicit,i=is(2).name;is();var r=Ho(20);sa(1),Wo("ngTemplateOutlet",r)("ngTemplateOutletContext",ac(2,MR,n,i))}}function cF(e,t){if(1&e&&(Zo(0,"div",53),Uo(1,oF,2,2,"div",54),Zo(2,"div",55),Uo(3,lF,2,5,"ng-container",29),Yo(),Yo()),2&e){var n=is().dataElm;sa(1),Wo("ngIf",0<n.name.trim().length),sa(2),Wo("ngForOf",n.children)}}function uF(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",58),Zo(2,"div"),zs(3),Yo(),Zo(4,"div",59),Zo(5,"div",33),Zo(6,"textarea",34),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Yo(),Zo(7,"div",35),zs(8),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(2),Lo("title",i.name),sa(1),Ls(i.name),sa(3),Wo("ngModel",i.value),sa(2),Ls(i.value)}}function hF(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",60),zs(2),Yo(),Zo(3,"div",61),Zo(4,"div",62),zs(5),Yo(),Zo(6,"input",63),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(1),Lo("title",i.name),sa(1),Ls(i.name),sa(3),Ls(i.value),sa(1),ss("type",i.value&&i.value==+i.value?"number":"text"),Wo("ngModel",i.value)}}function dF(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",64),zs(2),Yo(),Zo(3,"div",61),Zo(4,"div",65),Zo(5,"div",66),zs(6),Yo(),Zo(7,"input",67),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.currentValue=e}),Yo(),Yo(),Zo(8,"div",68),zs(9),Yo(),Yo(),Zo(10,"div",69),Zo(11,"input",70),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.currentValue=e}),hc(12,"safe"),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(1),Lo("title",i.name),sa(1),Ls(i.name),sa(4),Ls(i.currentValue),sa(1),Wo("ngModel",i.currentValue),sa(2),Bs(" / ",+i.value?i.value:"???",""),sa(2),ws(dc(12,10,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),ss("title",i.currentValue),ss("max",+i.value?i.value:1e3),Wo("ngModel",i.currentValue)}}function fF(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",60),Zo(2,"span"),zs(3),Yo(),zs(4),Yo(),Zo(5,"div",61),Zo(6,"input",71),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e})("change",function(){Jt(n);var e=is(2).dataElm;return e.value=e.value?e.name:""}),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm,r=is();sa(1),Lo("title",i.name),sa(1),ks("text-decoration",i.value?"none":"line-through"),sa(1),Ls(i.name),sa(1),Bs(" ",i.currentValue.split(r.checkRegExp)[i.value?0:1],""),sa(2),ss("checked",i.value?"checked":""),Wo("ngModel",i.value)}}function pF(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",60),zs(2),Yo(),Zo(3,"div",61),Zo(4,"div",62),zs(5),Yo(),Zo(6,"input",63),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Zo(7,"span",72),zs(8),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(1),Lo("title",i.name),sa(1),Ls(i.name),sa(3),Ls(i.value),sa(1),ss("type",i.value&&i.value==+i.value?"number":"text"),Wo("ngModel",i.value),sa(2),Bs("(",(i.calcAbilityScore()>=0?"+":"")+i.calcAbilityScore(),")")}}function gF(e,t){if(1&e){var n=Qo();Xo(0),Zo(1,"div",60),zs(2),Yo(),Zo(3,"div",61),Zo(4,"div",62),zs(5),Yo(),Zo(6,"input",73),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Zo(7,"button",74),es("click",function(){Jt(n);var e=is(2),t=e.dataElm,i=e.name,r=is();return!!r.stringUtil.validUrl(t.value)&&r.openUrl(t.value,i,t.name)}),Zo(8,"i",75),zs(9),Yo(),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm,r=is();sa(1),Lo("title",i.name),sa(1),Ls(i.name),sa(3),Ls(i.value),sa(1),Wo("ngModel",i.value),sa(1),Lo("disabled",r.stringUtil.validUrl(i.value)?null:""),sa(2),Ls(r.stringUtil.validUrl(i.value)?r.stringUtil.sameOrigin(i.value)?"link":"open_in_new":"link_off")}}function mF(e,t){if(1&e&&(Zo(0,"div",60),zs(1),Yo()),2&e){var n=is(3).dataElm;Lo("title",n.name),sa(1),Ls(n.name)}}function vF(e,t){if(1&e&&(Zo(0,"div",62),zs(1),Yo()),2&e){var n=is(3).dataElm;sa(1),Ls(n.value)}}var yF=function(e){return{"min-width":e}};function bF(e,t){if(1&e){var n=Qo();Xo(0),Uo(1,mF,2,2,"div",76),Zo(2,"div",61),Uo(3,vF,2,1,"div",77),Zo(4,"input",78),es("ngModelChange",function(e){return Jt(n),is(2).dataElm.value=e}),Yo(),Yo(),Ko()}if(2&e){var i=is(2).dataElm;sa(1),Wo("ngIf",i.name),sa(2),Wo("ngIf",i.name),sa(1),ss("type","size"===i.name||"altitude"===i.name?"number":"text"),ss("min","size"===i.name?"0":""),Wo("ngStyle",rc(6,yF,i.name?"8em":"100%"))("ngModel",i.value)}}function kF(e,t){1&e&&(Xo(0,2),Uo(1,uF,9,4,"ng-container",3),Uo(2,hF,7,5,"ng-container",3),Uo(3,dF,13,13,"ng-container",3),Uo(4,fF,7,7,"ng-container",3),Uo(5,pF,9,6,"ng-container",3),Uo(6,gF,10,6,"ng-container",3),Uo(7,bF,5,8,"ng-container",4),Ko(),qo(8,"div",57)),2&e&&(Wo("ngSwitch",is().dataElm.type),sa(1),Wo("ngSwitchCase","note"),sa(1),Wo("ngSwitchCase","simpleNumber"),sa(1),Wo("ngSwitchCase","numberResource"),sa(1),Wo("ngSwitchCase","checkProperty"),sa(1),Wo("ngSwitchCase","abilityScore"),sa(1),Wo("ngSwitchCase","url"))}function _F(e,t){if(1&e&&(Uo(0,aF,1,0,"ng-container",50),Uo(1,cF,4,2,"ng-template",null,51,Ic),Uo(3,kF,9,7,"ng-template",null,52,Ic)),2&e){var n=t.dataElm,i=Ho(2),r=Ho(4);Wo("ngIf",0<n.children.length)("ngIfThen",i)("ngIfElse",r)}}function wF(e,t){if(1&e){var n=Qo();Zo(0,"div",79),es("click",function(){return Jt(n),is().chanageImageView(!1)}),Zo(1,"div",80),Zo(2,"i",22),zs(3,"close"),Yo(),Yo(),qo(4,"img",81),hc(5,"safe"),Yo()}if(2&e){var i=is();Wo("@fadeInOut","in"),sa(4),Wo("src",dc(5,2,i.imageUrl,"resourceUrl"),dr)}}var xF,CF,EF=((CF=function(){function e(t,n,i,r){y(this,e),this.inventoryService=t,this.changeDetector=n,this.pointerDeviceService=i,this.modalService=r,this.tabletopObject=null,this.left=0,this.top=0,this.stringUtil=gk,this._imageFile=Wm.Empty,this.isOpenImageView=!1,this.checkRegExp=/[|\uff5c]/g}return k(e,[{key:"imageUrl",get:function(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof jk&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){var e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";var t=e.getFirstElementByName("imageIdentifier");if(!t)return"";if(this._imageFile.identifier!=t.value){var n=Dk.instance.get(t.value);this._imageFile=n||Wm.Empty}return this._imageFile.url}return this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}},{key:"hasImage",get:function(){return 0<this.imageUrl.length}},{key:"isUseIcon",get:function(){return this.tabletopObject instanceof jk&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}},{key:"roll",get:function(){if(this.tabletopObject instanceof jk){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){var e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;var t=e.getFirstElementByName("applyRoll");return t&&t.value?this.tabletopObject.roll:0}return this.tabletopObject.roll}return 0}},{key:"applyImageEffect",get:function(){if(this.tabletopObject instanceof jk){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){var e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;var t=e.getFirstElementByName("applyImageEffect");return!(!t||!t.value)}return!0}return!1}},{key:"isInverse",get:function(){return this.tabletopObject instanceof jk&&!!this.applyImageEffect&&this.tabletopObject.isInverse}},{key:"isHollow",get:function(){return this.tabletopObject instanceof jk&&!!this.applyImageEffect&&this.tabletopObject.isHollow}},{key:"isBlackPaint",get:function(){return this.tabletopObject instanceof jk&&!!this.applyImageEffect&&this.tabletopObject.isBlackPaint}},{key:"aura",get:function(){return this.tabletopObject instanceof jk&&this.applyImageEffect?this.tabletopObject.aura:-1}},{key:"inventoryDataElms",get:function(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}},{key:"dataElms",get:function(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}},{key:"hasDataElms",get:function(){return 0<this.dataElms.length}},{key:"newLineString",get:function(){return this.inventoryService.newLineString}},{key:"isPointerDragging",get:function(){return this.pointerDeviceService.isDragging}},{key:"pointerEventsStyle",get:function(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}},{key:"ngAfterViewInit",value:function(){var e=this;this.initPanelPosition(),setTimeout(function(){e.adjustPositionRoot()},16),Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.tabletopObject&&n&&n instanceof dk&&(e.tabletopObject===n||e.tabletopObject.contains(n))&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"initPanelPosition",value:function(){var e=this.draggablePanel.nativeElement,t=e.offsetWidth,n=this.left+100,i=this.top-e.offsetHeight-50,r=!1;window.innerWidth<n+t&&(n=window.innerWidth-t,r=!0),i<=0&&(i=0),r&&(n=this.left-t-100),n<0&&(n=0),i<0&&(i=0),e.style.left=n+"px",e.style.top=i+"px"}},{key:"adjustPositionRoot",value:function(){var e=this.draggablePanel.nativeElement,t=e.getBoundingClientRect(),n=0,i=0;window.innerWidth<t.right+n&&(n+=window.innerWidth-(t.right+n)),t.left+n<0&&(n+=0-(t.left+n)),window.innerHeight<t.bottom+i&&(i+=window.innerHeight-(t.bottom+i)),t.top+i<0&&(i+=0-(t.top+i)),e.style.left=e.offsetLeft+n+"px",e.style.top=e.offsetTop+i+"px"}},{key:"chanageImageView",value:function(e){this.isOpenImageView=e}},{key:"openUrl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;gk.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Jk,{url:e,title:t,subTitle:n})}},{key:"getInventoryTags",value:function(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}}]),e}()).\u0275fac=function(e){return new(e||CF)(Vo(tI),Vo(Dl),Vo(DC),Vo(Zk))},CF.\u0275cmp=ct({type:CF,selectors:[["overview-panel"]],viewQuery:function(e,t){var n;1&e&&Sc(iR,3),2&e&&Ec(n=Tc())&&(t.draggablePanel=n.first)},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:23,vars:9,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],["class","component-title title-background",3,"ngClass",4,"ngIf"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],[1,"card-image",3,"src"],[1,"zoom-button",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom",3,"ngClass",4,"ngIf"],[1,"component-owner","position-right-bottom",3,"ngClass"],[1,"owner-tag"],[1,"component-title","title-background",3,"ngClass"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[1,"is-fill"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",3,"ngClass","src"],[1,"character-image",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],[1,"tag"],[1,"value"],[1,"hidden-spacer"],["size","1",1,"input",2,"width","4em",3,"type","ngModel","ngModelChange"],[1,"tag",2,"min-width","100px"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["type","range","min","0",3,"title","max","ngModel","ngModelChange"],["type","checkbox",2,"width","2em","margin-right","1em",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],["type","url","size","1",1,"input",2,"width","calc(8em - 1.6rem)",3,"ngModel","ngModelChange"],[1,"link",2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none"],[1,"contain-image",3,"src"]],template:function(e,t){1&e&&(Zo(0,"div",0,1),Xo(2,2),Uo(3,rR,1,0,"ng-container",3),Uo(4,sR,2,4,"ng-container",3),Uo(5,cR,2,4,"ng-container",3),Uo(6,dR,2,4,"ng-container",3),Uo(7,gR,2,4,"ng-container",3),Uo(8,yR,2,4,"ng-container",3),Uo(9,kR,2,4,"ng-container",4),Ko(),Yo(),Uo(10,wR,2,1,"ng-container",5),Uo(11,RR,5,7,"ng-template",null,6,Ic),Uo(13,FR,9,7,"ng-template",null,7,Ic),Uo(15,qR,8,15,"ng-template",null,8,Ic),Uo(17,rF,11,18,"ng-template",null,9,Ic),Uo(19,_F,5,3,"ng-template",null,10,Ic),Uo(21,wF,6,5,"ng-template",null,11,Ic)),2&e&&(Wo("@fadeInOut","in"),sa(2),Wo("ngSwitch",t.tabletopObject.aliasName),sa(1),Wo("ngSwitchCase","numberResource"),sa(1),Wo("ngSwitchCase","card"),sa(1),Wo("ngSwitchCase","card-stack"),sa(1),Wo("ngSwitchCase","text-note"),sa(1),Wo("ngSwitchCase","character"),sa(1),Wo("ngSwitchCase","dice-symbol"),sa(2),Wo("ngIf",t.isOpenImageView))},directives:[yP,xh,Ch,Eh,dh,Th,lh,uh,Ed,Xd,Ef,Sh,Of,Rf,wd],pipes:[Lw],styles:[".component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:1px solid #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:1px solid #999;border-left:1px solid #999;border-right:1px solid #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;text-align:right;padding:2px 1em}.component-owner[_ngcontent-%COMP%], .owner-tag[_ngcontent-%COMP%]{overflow:hidden;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;margin-left:auto;margin-right:0;color:#f5f5f5;background-color:#1e1e1e;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:hsla(0,0%,80%,.5)}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.3);z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.5em 1.5em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:1px solid #999;border-right:1px solid #999}.character-image-box[_ngcontent-%COMP%]{width:100px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom left;object-position:bottom left}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:-webkit-min-content auto;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3/1/4/3}.title-area[_ngcontent-%COMP%]{grid-area:3/2/4/3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2/2/3/3}.image-area[_ngcontent-%COMP%]{grid-area:1/1/4/2}.void-area[_ngcontent-%COMP%]{grid-area:1/2/3/3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4/1/5/3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:1px solid #999;border-right:1px solid #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1/span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:both;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#eee}.textarea[_ngcontent-%COMP%]:focus{background:#fff}.tag[_ngcontent-%COMP%]{padding-right:1em;min-width:7em}.tag[_ngcontent-%COMP%], .value[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.value[_ngcontent-%COMP%]{font-size:1.2em;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{height:0}.hidden-spacer[_ngcontent-%COMP%], .textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{height:auto;min-height:24px;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:focus, input[type=number][_ngcontent-%COMP%]:hover{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}input[type=range][_ngcontent-%COMP%]{--slider-track-color:transparent;--slider-fill-color:#555;--slider-border-color:#777;--slider-height:0.8em;--slider-thumb-size:1.0em;--range:calc(var(--max) - var(--min));--ratio:calc((var(--val) - var(--min))/var(--range));--sx:calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:1px solid var(--slider-border-color);border-bottom:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color);background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:1px solid var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:grey}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}"],data:{animation:[sp("fadeInOut",[fp("void => *",[lp("100ms ease-out",dp([up({opacity:0,offset:0}),up({opacity:1,offset:1})]))]),fp("* => void",[lp("100ms ease-in",dp([up({opacity:1,offset:0}),up({opacity:0,offset:1})]))])])]},changeDetection:0}),CF),SF=((xF=function(){function e(t,n,i,r){var a=this;y(this,e),this.ngZone=t,this.viewContainerRef=n,this.componentFactoryResolver=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=function(e){return a.onMouseEnter(e)},this.callbackOnMouseLeave=function(e){return a.onMouseLeave(e)},this.callbackOnMouseDown=function(e){return a.onMouseDown(e)}}return k(e,[{key:"ngOnInit",value:function(){}},{key:"ngAfterViewInit",value:function(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}},{key:"ngOnDestroy",value:function(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}},{key:"onMouseEnter",value:function(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}},{key:"onMouseLeave",value:function(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}},{key:"onMouseDown",value:function(e){var t=this;this.tooltipComponentRef&&(this.tooltipComponentRef.location.nativeElement.contains(e.target)||this.viewContainerRef.element.nativeElement.contains(e.target)||this.ngZone.run(function(){return t.closeAll()}))}},{key:"startOpenTimer",value:function(){var e=this,t=this.pointerDeviceService.pointerX,n=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(function(){e.openTooltipTimer=null,4<Math.pow(t-e.pointerDeviceService.pointerX,2)+Math.pow(n-e.pointerDeviceService.pointerY,2)?e.startOpenTimer():e.ngZone.run(function(){return e.open()})},100)}},{key:"startCloseTimer",value:function(){var e=this;this.closeTooltipTimer=setTimeout(function(){e.closeTooltipTimer=null,e.tooltipComponentRef&&e.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?e.startCloseTimer():e.ngZone.run(function(){return e.closeAll()})},400)}},{key:"clearTimer",value:function(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}},{key:"open",value:function(){var t=this;if(this.closeAll(),!this.pointerDeviceService.isDragging){var n=xw.defaultParentViewContainerRef,i=n.injector,r=this.componentFactoryResolver.resolveComponentFactory(EF);this.tooltipComponentRef=n.createComponent(r,n.length,i),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(function(){document.body.addEventListener("touchstart",t.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",t.callbackOnMouseDown,!0)}),Jb.register(this).on("DELETE_GAME_OBJECT",-1e3,function(e){t.tabletopObject&&t.tabletopObject.identifier===e.data.identifier&&t.closeAll()}),this.tooltipComponentRef.onDestroy(function(){t.removeEventListeners(t.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",t.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",t.callbackOnMouseDown,!0),t.clearTimer(),t.tooltipComponentRef=null,Jb.unregister(t)}),e.activeTooltips.push(this.tooltipComponentRef)}}},{key:"close",value:function(){if(this.tooltipComponentRef){var t=e.activeTooltips.indexOf(this.tooltipComponentRef);0<=t&&e.activeTooltips.splice(t,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}}},{key:"closeAll",value:function(){e.activeTooltips.forEach(function(e){return e.destroy()}),e.activeTooltips=[],this.close()}},{key:"addEventListeners",value:function(e){var t=this;this.ngZone.runOutsideAngular(function(){e.addEventListener("mouseenter",t.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",t.callbackOnMouseLeave,!1)})}},{key:"removeEventListeners",value:function(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}]),e}()).activeTooltips=[],xF.\u0275fac=function(e){return new(e||xF)(Vo($c),Vo(Vl),Vo(rl),Vo(DC))},xF.\u0275dir=mt({type:xF,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),xF);function TF(e,t){if(1&e){var n=Qo();Zo(0,"div",2),Zo(1,"div",3),Zo(2,"div",4),hc(3,"safe"),Yo(),Zo(4,"div",4),hc(5,"safe"),Yo(),Yo(),Zo(6,"div",5),Zo(7,"button",6),es("click",function(){Jt(n);var e=t.$implicit;return is().drawCard(e)}),zs(8,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),Yo(),Zo(9,"button",0),es("click",function(){Jt(n);var e=t.$implicit;return is().showDetail(e)}),Zo(10,"i",7),zs(11,"settings"),Yo(),zs(12,"\u7de8\u96c6"),Yo(),qo(13,"br"),Zo(14,"button",0),es("click",function(){Jt(n);var e=t.$implicit;return is().up(e)}),zs(15,"\u2191"),Yo(),Zo(16,"button",0),es("click",function(){Jt(n);var e=t.$implicit;return is().down(e)}),zs(17,"\u2193"),Yo(),qo(18,"br"),Yo(),Yo()}if(2&e){var i=t.$implicit;sa(1),Wo("appTooltip",i),sa(1),ks("background-image",dc(3,5,"url("+(null==i||null==i.frontImage?null:i.frontImage.url)+")","style")),sa(2),ks("background-image",dc(5,8,"url("+(null==i||null==i.backImage?null:i.backImage.url)+")","style"))}}var OF,IF=((OF=function(){function e(t,n){y(this,e),this.panelService=t,this.changeDetector=n,this.cardStack=null,this.owner=ek.peerContext.userId}return k(e,[{key:"ngOnInit",value:function(){var e=this;Promise.resolve().then(function(){return e.panelService.title=e.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"}),Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.cardStack&&n&&((e.cardStack===n||n instanceof dk&&e.cardStack.contains(n))&&e.changeDetector.markForCheck(),t.data.identifier===e.cardStack.identifier&&e.cardStack.owner!==e.owner&&e.panelService.close())}).on("DELETE_GAME_OBJECT",-1e3,function(t){e.cardStack&&e.cardStack.identifier===t.data.identifier&&e.panelService.close()})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}},{key:"drawCard",value:function(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),Mw.play(Iw.cardDraw)}},{key:"up",value:function(e){var t=e.parent,n=t.children.indexOf(e);0<n&&t.insertBefore(e,t.children[n-1])}},{key:"down",value:function(e){var t=e.parent,n=t.children.indexOf(e);n<t.children.length-1&&t.insertBefore(t.children[n+1],e)}},{key:"close",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];e&&(this.cardStack.shuffle(),Jb.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),Mw.play(Iw.cardShuffle)),this.panelService.close()}},{key:"showDetail",value:function(e){var t="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(t+=" - "+e.name),this.panelService.open(cS,{title:t,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}},{key:"trackByCard",value:function(e,t){return t.identifier}}]),e}()).\u0275fac=function(e){return new(e||OF)(Vo(Wk),Vo(Dl))},OF.\u0275cmp=ct({type:OF,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[1,"image-box",3,"appTooltip"],[1,"image","contain"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,t){1&e&&(Zo(0,"div"),Zo(1,"button",0),es("click",function(){return t.close(!0)}),zs(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),Yo(),qo(3,"hr"),Uo(4,TF,19,11,"div",1),Yo()),2&e&&(sa(4),Wo("ngForOf",t.cardStack.cards)("ngForTrackBy",t.trackByCard))},directives:[uh,SF],pipes:[Lw],styles:[".box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%], .image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px}.contain[_ngcontent-%COMP%]{background-position:50%;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),OF),MF=function(e){return{transform:e}};function AF(e,t){if(1&e){var n=Qo();Zo(0,"div"),es("@shuffle.start",function(e){return Jt(n),is().animationShuffleStarted(e)})("@shuffle.done",function(e){return Jt(n),is().animationShuffleDone(e)}),qo(1,"img",5),hc(2,"safe"),Yo()}if(2&e){var i=is();Wo("@bounceInOut",void 0)("@shuffle",i.animeState),sa(1),Wo("ngStyle",rc(7,MF,"rotateZ("+i.topCard.rotate+"deg)"))("src",dc(2,4,i.imageFile.url,"resourceUrl"),dr)}}function PF(e,t){1&e&&(Xo(0),Zo(1,"div",6),Zo(2,"i",7),zs(3,"autorenew"),Yo(),Yo(),Zo(4,"div",8),Zo(5,"i",7),zs(6,"autorenew"),Yo(),Yo(),Zo(7,"div",9),Zo(8,"i",7),zs(9,"autorenew"),Yo(),Yo(),Zo(10,"div",10),Zo(11,"i",7),zs(12,"autorenew"),Yo(),Yo(),Ko())}function DF(e,t){if(1&e&&(Zo(0,"div",11),Zo(1,"span"),zs(2),Yo(),Yo()),2&e){var n=is();Wo("ngStyle",rc(2,MF,"translateY(-50%) translateX(-50%) translateX("+n.size*n.gridSize/2+"px)")),sa(2),Bs("",n.cards.length,"\u679a")}}var RF=function(e,t){return{"background-color":e,transform:t}};function FF(e,t){if(1&e&&(Zo(0,"div",12),Zo(1,"span"),Zo(2,"b"),zs(3),Yo(),zs(4," \u304c\u78ba\u8a8d\u4e2d"),Yo(),Yo()),2&e){var n=is();Wo("ngStyle",ac(2,RF,n.ownerColor,"translateY(50%) translateX(-50%) translateX("+n.size*n.gridSize/2+"px)")),sa(3),Ls(n.ownerName)}}var NF,zF=function(e){return{"is-empty":e}},LF=((NF=function(){function e(t,n,i,r,a,o,s,l){y(this,e),this.ngZone=t,this.contextMenuService=n,this.panelService=i,this.elementRef=r,this.changeDetector=a,this.imageService=o,this.pointerDeviceService=s,this.modalService=l,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}return k(e,[{key:"name",get:function(){return this.cardStack.name}},{key:"rotate",get:function(){return this.cardStack.rotate},set:function(e){this.cardStack.rotate=e}},{key:"zindex",get:function(){return this.cardStack.zindex}},{key:"isShowTotal",get:function(){return this.cardStack.isShowTotal}},{key:"cards",get:function(){return this.cardStack.cards}},{key:"isEmpty",get:function(){return this.cardStack.isEmpty}},{key:"size",get:function(){var e=this.cardStack.topCard;return e?e.size:2}},{key:"hasOwner",get:function(){return this.cardStack.hasOwner}},{key:"ownerName",get:function(){return this.cardStack.ownerName}},{key:"ownerColor",get:function(){return this.cardStack.ownerColor}},{key:"topCard",get:function(){return this.cardStack.topCard}},{key:"imageFile",get:function(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}},{key:"isIconHidden",get:function(){return null!=this.iconHiddenTimer}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("SHUFFLE_CARD_STACK",-1e3,function(t){t.data.identifier===e.cardStack.identifier&&(e.animeState="active",e.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",-1e3,function(t){t.data.identifier===e.cardStack.identifier&&(e.animeState="inverse",e.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.cardStack&&n&&(e.cardStack===n||n instanceof dk&&e.cardStack.contains(n)||n instanceof Rk&&n.userId===e.cardStack.owner)&&e.changeDetector.markForCheck()}).on("CARD_STACK_DECREASED",function(t){t.data.cardStackIdentifier===e.cardStack.identifier&&e.cardStack&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}).on("DISCONNECT_PEER",function(t){var n=Rk.findByPeerId(t.data.peerId);n&&e.cardStack.owner!==n.userId||e.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=function(t){return e.ngZone.run(function(){return e.onInputStart(t)})}}},{key:"ngOnDestroy",value:function(){this.input.destroy(),Jb.unregister(this)}},{key:"animationShuffleStarted",value:function(e){}},{key:"animationShuffleDone",value:function(e){this.animeState="inactive",this.changeDetector.markForCheck()}},{key:"onCardDrop",value:function(e){if(this.cardStack!==e.detail&&(e.detail instanceof jx!=0||e.detail instanceof Ux!=0))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof jx){var t=e.detail;Math.pow(t.location.x-this.cardStack.location.x,2)+Math.pow(t.location.y-this.cardStack.location.y,2)+Math.pow(t.posZ-this.cardStack.posZ,2)<Math.pow(50,2)&&this.cardStack.putOnTop(t)}else if(e.detail instanceof Ux){var n=e.detail;Math.pow(n.location.x-this.cardStack.location.x,2)+Math.pow(n.location.y-this.cardStack.location.y,2)+Math.pow(n.posZ-this.cardStack.posZ,2)<Math.pow(25,2)&&this.concatStack(n)}}},{key:"startDoubleClickTimer",value:function(e){var t=this;if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(function(){return t.stopDoubleClickTimer()},e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}},{key:"stopDoubleClickTimer",value:function(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}},{key:"onDoubleClick",value:function(){this.stopDoubleClickTimer(),Math.pow(this.doubleClickPoint.x-this.input.pointer.x,2)+Math.pow(this.doubleClickPoint.y-this.input.pointer.y,2)<Math.pow(10,2)&&(console.log("onDoubleClick !!!!"),null!=this.drawCard()&&Mw.play(Iw.cardDraw))}},{key:"onDragstart",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onInputStart",value:function(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}},{key:"onContextMenu",value:function(e){var t=this;e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:function(){null!=t.drawCard()&&Mw.play(Iw.cardDraw)},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(function(e){return{name:"".concat(e,"\u679a"),action:function(){for(var n=0;n<e&&null!=t.drawCard();n++)0!=n&&3!=n&&9!=n||Mw.play(Iw.cardDraw)}}}),disabled:0==this.cards.length},ww,{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:function(){t.cardStack.faceUp(),Mw.play(Iw.cardDraw)},disabled:0==this.cards.length},{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:function(){t.cardStack.faceDown(),Mw.play(Iw.cardDraw)},disabled:0==this.cards.length},ww,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:function(){t.cardStack.faceUpAll(),Mw.play(Iw.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:function(){t.cardStack.faceDownAll(),Mw.play(Iw.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:function(){t.cardStack.uprightAll(),Mw.play(Iw.cardDraw)},disabled:0==this.cards.length},ww,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:function(){t.cardStack.shuffle(),Mw.play(Iw.cardShuffle),Jb.call("SHUFFLE_CARD_STACK",{identifier:t.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b",action:function(){t.showStackList(t.cardStack)},disabled:0==this.cards.length},ww,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:function(){t.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:function(){t.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:function(){t.cardStack.topCard&&t.cardStack.unifyCardsSize(t.cardStack.topCard.size)},disabled:0==this.cards.length},ww,{name:"\u5c71\u672d\u3092\u4eba\u6570\u5206\u306b\u5206\u5272\u3059\u308b",action:function(){t.splitStack(ek.peerIds.length),Mw.play(Iw.cardDraw)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:function(){t.breakStack(),Mw.play(Iw.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:function(){t.cardStack.inverse(),Mw.play(Iw.cardDraw),Mw.play(Iw.cardDraw),Jb.call("INVERSE_CARD_STACK",{identifier:t.cardStack.identifier})},disabled:0==this.cards.length},ww,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:function(){t.showDetail(t.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.cardStack.name,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}})},this.cardStack.getUrls().length<=0?null:ww,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.cardStack.clone();e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.owner="",e.toTopmost(),Mw.play(Iw.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:function(){t.cardStack.setLocation("graveyard"),t.cardStack.destroy(),Mw.play(Iw.sweep)}}],this.name)}},{key:"onMove",value:function(){Mw.play(Iw.cardPick)}},{key:"onMoved",value:function(){var e=this;Mw.play(Iw.cardPut),this.ngZone.run(function(){return e.dispatchCardDropEvent()})}},{key:"drawCard",value:function(){var e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}},{key:"breakStack",value:function(){var e,t=a(this.cardStack.drawCardAll().reverse());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.location.x+=25-50*Math.random(),n.location.y+=25-50*Math.random(),n.toTopmost(),n.setLocation(this.cardStack.location.name)}}catch(i){t.e(i)}finally{t.f()}this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}},{key:"splitStack",value:function(e){if(!(e<2)){for(var t=[],n=0;n<e;n++){var i=Ux.create(this.cardStack.name);i.location.x=this.cardStack.location.x+50-100*Math.random(),i.location.y=this.cardStack.location.y+50-100*Math.random(),i.posZ=this.cardStack.posZ,i.location.name=this.cardStack.location.name,i.rotate=this.rotate,i.toTopmost(),t.push(i)}var r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();for(var a=0,o=r.length/e*(a+1),s=0;s<r.length;s++)t[a].putOnBottom(r[s]),o<=s+1&&(a++,o=r.length/e*(a+1))}}},{key:"concatStack",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.cardStack,n=Ux.create(e.name);n.location.name=t.location.name,n.location.x=t.location.x,n.location.y=t.location.y,n.posZ=t.posZ,n.zindex=e.zindex,n.rotate=t.rotate;var i,r=t.drawCardAll(),o=e.drawCardAll(),s=a(o.concat(r));try{for(s.s();!(i=s.n()).done;){var l=i.value;n.putOnBottom(l)}}catch(c){s.e(c)}finally{s.f()}t.setLocation(""),t.destroy(),e.setLocation(""),e.destroy()}},{key:"dispatchCardDropEvent",value:function(){for(var e=this.elementRef.nativeElement.parentElement.children,t=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0}),n=0;n<e.length;n++)e[n].dispatchEvent(t)}},{key:"showDetail",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-300,top:t.y-300,width:600,height:600}).tabletopObject=e}},{key:"showStackList",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n={left:t.x-200,top:t.y-300,width:400,height:600};this.cardStack.owner=ek.peerContext.userId,this.panelService.open(IF,n).cardStack=e}},{key:"startIconHiddenTimer",value:function(){var e=this;clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(function(){e.iconHiddenTimer=null,e.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}]),e}()).\u0275fac=function(e){return new(e||NF)(Vo($c),Vo(xw),Vo(Wk),Vo(ll),Vo(Dl),Vo(BA),Vo(DC),Vo(Zk))},NF.\u0275cmp=ct({type:NF,selectors:[["card-stack"]],hostBindings:function(e,t){1&e&&es("carddrop",function(e){return t.onCardDrop(e)})("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:11,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-grab",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background","style","color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"card-image",3,"ngStyle","src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"name-tag","is-nowrap","is-black-background",3,"ngStyle"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",2,"color","whitesmoke",3,"ngStyle"]],template:function(e,t){1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Zo(1,"div",1),es("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Uo(2,AF,3,9,"div",2),Uo(3,PF,13,0,"ng-container",2),Uo(4,DF,3,4,"div",3),Uo(5,FF,5,5,"div",4),Yo(),Yo()),2&e&&(ks("width",t.size*t.gridSize,"px"),Wo("ngClass",rc(9,zF,t.isEmpty))("movable.option",t.movableOption),sa(1),Wo("rotable.option",t.rotableOption),sa(1),Wo("ngIf",t.topCard&&t.imageFile),sa(1),Wo("ngIf",!t.isIconHidden),sa(1),Wo("ngIf",t.isShowTotal),sa(1),Wo("ngIf",t.hasOwner))},directives:[yD,lh,bD,dh,Sh],pipes:[Lw],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component[_ngcontent-%COMP%], .component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:5px solid #ccc;border-radius:5px;background-color:#ccc}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;max-width:18em}.has-length-limit[_ngcontent-%COMP%], .is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[sp("shuffle",[hp("active",up({transform:""})),fp("* => active",[lp("800ms ease",dp([up({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),up({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),fp("* => inverse",[lp("200ms ease",dp([up({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),up({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),up({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),sp("bounceInOut",[fp("void => *",[lp("600ms ease",dp([up({transform:"scale3d(0, 0, 0)",offset:0}),up({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp(100,up({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),NF);function BF(e,t){if(1&e&&(qo(0,"img",7),hc(1,"safe")),2&e){var n=is();Wo("@inverse",n.state)("src",dc(1,2,n.isFront?n.frontImage.url:n.backImage.url,"resourceUrl"),dr)}}var jF=function(e,t){return{"background-color":e,transform:t}};function UF(e,t){if(1&e&&(Zo(0,"div",8),Zo(1,"span"),Zo(2,"b"),zs(3),Yo(),Yo(),Yo()),2&e){var n=is();Wo("ngStyle",ac(2,jF,n.ownerColor,"translateY(-75%) translateX(-50%) translateX("+n.size*n.gridSize/2+"px)")),sa(3),Ls(n.ownerName)}}function HF(e,t){1&e&&(qo(0,"img",9),hc(1,"safe")),2&e&&Wo("src",dc(1,1,is().frontImage.url,"resourceUrl"),dr)}function VF(e,t){1&e&&(Xo(0),Zo(1,"div",10),Zo(2,"i",11),zs(3,"autorenew"),Yo(),Yo(),Zo(4,"div",12),Zo(5,"i",11),zs(6,"autorenew"),Yo(),Yo(),Zo(7,"div",13),Zo(8,"i",11),zs(9,"autorenew"),Yo(),Yo(),Zo(10,"div",14),Zo(11,"i",11),zs(12,"autorenew"),Yo(),Yo(),qo(13,"div",15),Ko())}var WF,GF=((WF=function(){function e(t,n,i,r,a,o,s,l,c){y(this,e),this.ngZone=t,this.contextMenuService=n,this.panelService=i,this.elementRef=r,this.changeDetector=a,this.tabletopService=o,this.imageService=s,this.pointerDeviceService=l,this.modalService=c,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}return k(e,[{key:"name",get:function(){return this.card.name}},{key:"state",get:function(){return this.card.state},set:function(e){this.card.state=e}},{key:"rotate",get:function(){return this.card.rotate},set:function(e){this.card.rotate=e}},{key:"owner",get:function(){return this.card.owner},set:function(e){this.card.owner=e}},{key:"zindex",get:function(){return this.card.zindex}},{key:"size",get:function(){return this.adjustMinBounds(this.card.size)}},{key:"isHand",get:function(){return this.card.isHand}},{key:"isFront",get:function(){return this.card.isFront}},{key:"isVisible",get:function(){return this.card.isVisible}},{key:"hasOwner",get:function(){return this.card.hasOwner}},{key:"ownerName",get:function(){return this.card.ownerName}},{key:"ownerColor",get:function(){return this.card.ownerColor}},{key:"imageFile",get:function(){return this.imageService.getSkeletonOr(this.card.imageFile)}},{key:"frontImage",get:function(){return this.imageService.getSkeletonOr(this.card.frontImage)}},{key:"backImage",get:function(){return this.imageService.getSkeletonOr(this.card.backImage)}},{key:"isIconHidden",get:function(){return null!=this.iconHiddenTimer}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.card&&n&&(e.card===n||n instanceof dk&&e.card.contains(n)||n instanceof Rk&&n.userId===e.card.owner)&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}).on("DISCONNECT_PEER",function(t){var n=Rk.findByPeerId(t.data.peerId);n&&e.card.owner!==n.userId||e.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=function(t){return e.ngZone.run(function(){return e.onInputStart(t)})}}},{key:"ngOnDestroy",value:function(){this.input.destroy(),Jb.unregister(this)}},{key:"onCardDrop",value:function(e){if(this.card!==e.detail&&(e.detail instanceof jx!=0||e.detail instanceof Ux!=0)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof Ux)){var t=e.detail;Math.pow(t.location.x-this.card.location.x,2)+Math.pow(t.location.y-this.card.location.y,2)+Math.pow(t.posZ-this.card.posZ,2)<Math.pow(25,2)&&(t.location.x=this.card.location.x,t.location.y=this.card.location.y,t.posZ=this.card.posZ,t.putOnBottom(this.card))}}},{key:"startDoubleClickTimer",value:function(e){var t=this;if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(function(){return t.stopDoubleClickTimer()},e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}},{key:"stopDoubleClickTimer",value:function(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}},{key:"onDoubleClick",value:function(){if(this.stopDoubleClickTimer(),Math.pow(this.doubleClickPoint.x-this.input.pointer.x,2)+Math.pow(this.doubleClickPoint.y-this.input.pointer.y,2)<Math.pow(10,2)){if(console.log("onDoubleClick !!!!"),this.hasOwner&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?Bx.BACK:Bx.FRONT,this.owner="",Mw.play(Iw.cardDraw)}}},{key:"onDragstart",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onInputStart",value:function(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer()}},{key:"onContextMenu",value:function(e){var t=this;e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.hasOwner?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:function(){t.card.faceUp(),Mw.play(Iw.cardDraw)},default:!this.hasOwner||this.isHand}:{name:"\u88cf\u306b\u3059\u308b",action:function(){t.card.faceDown(),Mw.play(Iw.cardDraw)},default:!this.hasOwner||this.isHand},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:function(){t.card.faceDown(),Mw.play(Iw.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:function(){Mw.play(Iw.cardDraw),t.card.faceDown(),t.owner=ek.peerContext.userId}},ww,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:function(){t.createStack(),Mw.play(Iw.cardPut)}},ww,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:function(){t.showDetail(t.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.card.name,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}})}:null,this.isVisible&&this.card.getUrls().length>0?ww:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.card.clone();e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.toTopmost(),Mw.play(Iw.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:function(){t.card.destroy(),Mw.play(Iw.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}},{key:"onMove",value:function(){this.input.cancel(),Mw.play(Iw.cardPick)}},{key:"onMoved",value:function(){var e=this;Mw.play(Iw.cardPut),this.ngZone.run(function(){return e.dispatchCardDropEvent()})}},{key:"createStack",value:function(){var e=this,t=Ux.create("\u5c71\u672d");t.location.x=this.card.location.x,t.location.y=this.card.location.y,t.posZ=this.card.posZ,t.location.name=this.card.location.name,t.rotate=this.rotate,t.zindex=this.card.zindex;var n=this.tabletopService.cards.filter(function(t){return Math.pow(t.location.x-e.card.location.x,2)+Math.pow(t.location.y-e.card.location.y,2)+Math.pow(t.posZ-e.card.posZ,2)<Math.pow(100,2)});n.sort(function(e,t){return e.zindex<t.zindex?1:e.zindex>t.zindex?-1:0});var i,r=a(n);try{for(r.s();!(i=r.n()).done;){var o=i.value;t.putOnBottom(o)}}catch(s){r.e(s)}finally{r.f()}}},{key:"dispatchCardDropEvent",value:function(){console.log("dispatchCardDropEvent");for(var e=this.elementRef.nativeElement.parentElement.children,t=new CustomEvent("carddrop",{detail:this.card,bubbles:!0}),n=0;n<e.length;n++)e[n].dispatchEvent(t)}},{key:"startIconHiddenTimer",value:function(){var e=this;clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(function(){e.iconHiddenTimer=null,e.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}},{key:"adjustMinBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t?t:e}},{key:"showDetail",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-300,top:t.y-300,width:600,height:600}).tabletopObject=e}}]),e}()).\u0275fac=function(e){return new(e||WF)(Vo($c),Vo(xw),Vo(Wk),Vo(ll),Vo(Dl),Vo(hI),Vo(BA),Vo(DC),Vo(Zk))},WF.\u0275cmp=ct({type:WF,selectors:[["card"]],hostBindings:function(e,t){1&e&&es("carddrop",function(e){return t.onCardDrop(e)})("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{card:"card",is3D:"is3D"},decls:7,vars:9,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none","is-grab",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none"],["appRotable","",1,"component-content","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],["class","card-image",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent",3,"src",4,"ngIf"],[4,"ngIf"],[1,"card-image",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background",3,"ngStyle"],[1,"card-image","thumbnail-transform","is-translucent",3,"src"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom"],[1,"rotate-grab","of-right-bottom"],[1,"rotate-grab","of-right-top"],[1,"border-bg","is-pointer-events-none"]],template:function(e,t){1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Zo(1,"div",1),Zo(2,"div",2),es("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Uo(3,BF,2,5,"img",3),Uo(4,UF,4,5,"div",4),Uo(5,HF,2,4,"img",5),Uo(6,VF,14,0,"ng-container",6),Yo(),Yo(),Yo()),2&e&&(ks("width",t.size*t.gridSize,"px"),Wo("movable.option",t.movableOption),sa(1),Wo("@slidInOut",void 0),sa(1),Wo("rotable.option",t.rotableOption),sa(1),Wo("ngIf",t.imageFile),sa(1),Wo("ngIf",!t.isFront&&t.hasOwner&&0<t.ownerName.length),sa(1),Wo("ngIf",t.isHand&&t.frontImage),sa(1),Wo("ngIf",!t.isIconHidden))},directives:[yD,bD,dh,Sh],pipes:[Lw],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component[_ngcontent-%COMP%], .component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px}.of-left-bottom[_ngcontent-%COMP%], .of-left-top[_ngcontent-%COMP%]{left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:hsla(0,0%,80%,.5);top:-2px;left:-2px;right:-2px;bottom:-2px;z-index:-1;display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;max-width:18em}.has-length-limit[_ngcontent-%COMP%], .is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}"],data:{animation:[sp("inverse",[hp("inverse",up({transform:""})),fp(":increment, :decrement",[lp("200ms ease",dp([up({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),up({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),up({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),sp("slidInOut",[fp("void => *",[lp("200ms ease",dp([up({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),up({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp(100,up({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),WF);function ZF(e,t){1&e&&(Xo(0),Zo(1,"div",17),Zo(2,"div",18),Zo(3,"div",19),zs(4,"autorenew"),Yo(),Zo(5,"div",20),zs(6,"autorenew"),Yo(),Yo(),Yo(),Ko())}function YF(e,t){1&e&&(Zo(0,"i",25),zs(1,"lock"),Yo())}function qF(e,t){if(1&e&&(Zo(0,"span"),zs(1),Yo()),2&e){var n=is(2);sa(1),Ls(n.face)}}function XF(e,t){1&e&&(Zo(0,"span"),zs(1,"???"),Yo())}function KF(e,t){1&e&&(Zo(0,"i",25),zs(1,"lock"),Yo())}function $F(e,t){if(1&e&&(Zo(0,"span"),zs(1),Yo()),2&e){var n=is(2);sa(1),Ls(n.face)}}function QF(e,t){1&e&&(Zo(0,"span"),zs(1,"???"),Yo())}var JF=function(e){return{transform:e}};function eN(e,t){if(1&e&&(Zo(0,"div",21),Zo(1,"div",22),Uo(2,YF,2,0,"i",23),zs(3),Uo(4,qF,2,1,"span",5),Uo(5,XF,2,0,"span",5),Yo(),Zo(6,"div",24),Uo(7,KF,2,0,"i",23),zs(8),Uo(9,$F,2,1,"span",5),Uo(10,QF,2,0,"span",5),Yo(),Yo()),2&e){var n=is();Wo("ngStyle",rc(9,JF,"translateX(-50%) translateX("+n.size*n.gridSize/2+"px) rotateX("+n.nameTagRotate+"deg)")),sa(2),Wo("ngIf",n.isLock&&n.hasOwner),sa(1),Bs("",n.name,":"),sa(1),Wo("ngIf",n.isVisible),sa(1),Wo("ngIf",!n.isVisible),sa(2),Wo("ngIf",n.isLock&&n.hasOwner),sa(1),Bs("",n.name,":"),sa(1),Wo("ngIf",n.isVisible),sa(1),Wo("ngIf",!n.isVisible)}}var tN=function(e,t){return{"background-color":e,transform:t}};function nN(e,t){if(1&e&&(Zo(0,"div",26),Zo(1,"div",27),Zo(2,"b"),zs(3),Yo(),Yo(),Zo(4,"div",28),Zo(5,"b"),zs(6),Yo(),Yo(),Yo()),2&e){var n=is();Wo("ngStyle",ac(3,tN,n.ownerColor+"dd","translateX(-50%) translateX("+n.size*n.gridSize/2+"px) rotateX("+n.nameTagRotate+"deg)")),sa(3),Ls(n.ownerName),sa(3),Ls(n.ownerName)}}var iN=function(e,t){return{"is-black-mask":e,"is-harf-black-mask":t}};function rN(e,t){if(1&e&&(qo(0,"img",29),hc(1,"safe")),2&e){var n=is();Wo("src",dc(1,2,n.imageFile.url,"resourceUrl"),dr)("ngClass",ac(5,iN,!n.isVisible,n.isMine))}}function aN(e,t){if(1&e&&(qo(0,"img",30),hc(1,"safe")),2&e){var n=is();Wo("src",dc(1,2,n.imageFile.url,"resourceUrl"),dr)("ngClass",ac(5,iN,!n.isVisible,n.isMine))}}function oN(e,t){1&e&&(qo(0,"img",31),hc(1,"safe")),2&e&&Wo("src",dc(1,1,is().imageFile.url,"resourceUrl"),dr)}function sN(e,t){1&e&&(qo(0,"img",32),hc(1,"safe")),2&e&&Wo("src",dc(1,1,is().imageFile.url,"resourceUrl"),dr)}var lN,cN=function(e){return{"is-gray-border":e}},uN=((lN=function(){function e(t,n,i,r,a,o,s,l){y(this,e),this.ngZone=t,this.panelService=n,this.contextMenuService=i,this.elementRef=r,this.changeDetector=a,this.pointerDeviceService=o,this.imageService=s,this.modalService=l,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}return k(e,[{key:"face",get:function(){return this.diceSymbol.face},set:function(e){this.diceSymbol.face=e}},{key:"owner",get:function(){return this.diceSymbol.owner},set:function(e){this.diceSymbol.owner=e}},{key:"rotate",get:function(){return this.diceSymbol.rotate},set:function(e){this.diceSymbol.rotate=e}},{key:"name",get:function(){return this.diceSymbol.name},set:function(e){this.diceSymbol.name=e}},{key:"size",get:function(){return this.adjustMinBounds(this.diceSymbol.size)}},{key:"faces",get:function(){return this.diceSymbol.faces}},{key:"nothingFaces",get:function(){return this.diceSymbol.nothingFaces}},{key:"imageFile",get:function(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}},{key:"isMine",get:function(){return this.diceSymbol.isMine}},{key:"hasOwner",get:function(){return this.diceSymbol.hasOwner}},{key:"ownerName",get:function(){return this.diceSymbol.ownerName}},{key:"ownerColor",get:function(){return this.diceSymbol.ownerColor}},{key:"isVisible",get:function(){return this.diceSymbol.isVisible}},{key:"isDropShadow",get:function(){return this.diceSymbol.isDropShadow},set:function(e){this.diceSymbol.isDropShadow=e}},{key:"isLock",get:function(){return this.diceSymbol.isLock},set:function(e){this.diceSymbol.isLock=e}},{key:"isIconHidden",get:function(){return null!=this.iconHiddenTimer}},{key:"nameTagRotate",get:function(){var e=this.viewRotateX%360-90,t=(this.viewRotateZ+this.rotate)%360;return t=t>0?t:360+t,(e>0?e:360+e)*(this.isFlip?1:-1)}},{key:"isFlip",get:function(){var e=(this.viewRotateZ+this.rotate)%360;return 90<(e=e>0?e:360+e)&&e<270}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("ROLL_DICE_SYNBOL",-1e3,function(t){t.data.identifier===e.diceSymbol.identifier&&e.ngZone.run(function(){e.animeState="inactive",e.changeDetector.markForCheck(),setTimeout(function(){e.animeState="active",e.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.diceSymbol&&n&&(e.diceSymbol===n||n instanceof dk&&e.diceSymbol.contains(n)||n instanceof Rk&&n.userId===e.diceSymbol.owner)&&e.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",-1e3,function(t){e.owner&&!e.isLock&&(e.owner="",Mw.play(Iw.unlock))}).on("TABLE_VIEW_ROTATE",-1e3,function(t){e.ngZone.run(function(){e.viewRotateX=t.data.x,e.viewRotateZ=t.data.z,e.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}).on("DISCONNECT_PEER",function(t){var n=Rk.findByPeerId(t.data.peerId);n&&e.diceSymbol.owner!==n.userId||e.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.input=new vP(e.elementRef.nativeElement)}),this.input.onStart=function(t){return e.ngZone.run(function(){return e.onInputStart(t)})}}},{key:"ngOnDestroy",value:function(){this.input.destroy(),Jb.unregister(this)}},{key:"onDragstart",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"animationShuffleDone",value:function(e){this.animeState="inactive",this.changeDetector.markForCheck()}},{key:"onInputStart",value:function(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}},{key:"startDoubleClickTimer",value:function(e){var t=this;if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(function(){return t.stopDoubleClickTimer()},e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}},{key:"stopDoubleClickTimer",value:function(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}},{key:"onDoubleClick",value:function(){this.stopDoubleClickTimer(),Math.pow(this.doubleClickPoint.x-this.input.pointer.x,2)+Math.pow(this.doubleClickPoint.y-this.input.pointer.y,2)<Math.pow(10,2)&&this.isVisible&&this.diceRoll()}},{key:"onContextMenu",value:function(e){var t=this;if(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu){var n=this.pointerDeviceService.pointers[0],i=[];if(i.push({name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:function(){t.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),i.push(ww),(this.isMine||this.hasOwner)&&i.push({name:"\u30c0\u30a4\u30b9\u3092\u516c\u958b",action:function(){t.owner="",Mw.play(Iw.unlock)}}),this.isMine||i.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:function(){t.owner=ek.peerContext.userId,Mw.play(Iw.lock)}}),i.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:function(){t.isLock=!1,Mw.play(Iw.unlock)}}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:function(){t.isLock=!0,Mw.play(Iw.lock)}}),this.isVisible){var r=[],a=this.nothingFaces;a.length>0&&(a.forEach(function(e){r.push({name:"".concat(t.face==e?"\u25c9":"\u25cb"," ").concat(e,"\u3000"),action:function(){Mw.play(Iw.dicePut),t.face=e}})}),r.push(ww)),this.faces.forEach(function(e){r.push({name:"".concat(t.face==e?"\u25c9":"\u25cb"," ").concat(e,"\u3000"),action:function(){Mw.play(Iw.dicePut),t.face=e}})}),i.push({name:"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:r})}i.push(ww),i.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:function(){t.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:function(){t.isDropShadow=!0}}),i.push(ww),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:function(){t.showDetail(t.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(i.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.diceSymbol.name,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}})}),i.push(ww)),i.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.diceSymbol.clone();e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.update(),Mw.play(Iw.dicePut)}}),i.push({name:"\u524a\u9664\u3059\u308b",action:function(){t.diceSymbol.destroy(),Mw.play(Iw.sweep)}}),this.contextMenuService.open(n,i,this.name)}}},{key:"onMove",value:function(){Mw.play(Iw.dicePick)}},{key:"onMoved",value:function(){Mw.play(Iw.dicePut)}},{key:"diceRoll",value:function(){return Jb.call("ROLL_DICE_SYNBOL",{identifier:this.diceSymbol.identifier}),Mw.play(Iw.diceRoll1),this.diceSymbol.diceRoll()}},{key:"showDetail",value:function(e){Jb.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});var t=this.pointerDeviceService.pointers[0],n="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-300,top:t.y-300,width:600,height:600}).tabletopObject=e}},{key:"startIconHiddenTimer",value:function(){var e=this;clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(function(){e.iconHiddenTimer=null,e.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}},{key:"adjustMinBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t?t:e}}]),e}()).\u0275fac=function(e){return new(e||lN)(Vo($c),Vo(Wk),Vo(xw),Vo(ll),Vo(Dl),Vo(DC),Vo(BA),Vo(Zk))},lN.\u0275cmp=ct({type:lN,selectors:[["dice-symbol"]],hostBindings:function(e,t){1&e&&es("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:19,vars:31,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",2,"transform-origin","center bottom"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow","style","opacity: 0.7; filter: brightness(0) blur(1px); transform: scaleX(-1)",3,"src",4,"ngIf"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d",3,"src","ngClass"],[1,"image","back-face","is-3d",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"],[1,"image","shadow",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","scaleX(-1)",3,"src"]],template:function(e,t){1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Zo(1,"div",1),Zo(2,"div",2),es("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),qo(3,"div",3),qo(4,"div",4),Uo(5,ZF,7,0,"ng-container",5),Zo(6,"div",1),Zo(7,"div",6),Zo(8,"div",7),Zo(9,"div",8),Zo(10,"div",9),es("@diceRollNameTag.done",function(e){return t.animationShuffleDone(e)}),Uo(11,eN,11,11,"div",10),Yo(),Uo(12,nN,7,6,"div",11),Zo(13,"div",1),es("@diceRoll.done",function(e){return t.animationShuffleDone(e)}),Uo(14,rN,2,8,"img",12),Uo(15,aN,2,8,"img",13),Yo(),Yo(),Yo(),Yo(),Zo(16,"div",14),es("@diceRoll.done",function(e){return t.animationShuffleDone(e)}),Uo(17,oN,2,4,"img",15),Uo(18,sN,2,4,"img",16),Yo(),Yo(),Yo(),Yo(),Yo()),2&e&&(ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),Wo("movable.option",t.movableOption),sa(1),Wo("@bounceInOut","in"),sa(1),Wo("rotable.option",t.rotableOption),sa(1),Wo("ngClass",rc(29,cN,t.hasOwner)),sa(2),Wo("ngIf",!t.isIconHidden),sa(3),ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),sa(2),Wo("@changeFaceNameTag",t.isVisible?t.face:null)("@diceRollNameTag",t.animeState),sa(1),Wo("ngIf",0<t.name.length),sa(1),Wo("ngIf",t.hasOwner&&0<t.ownerName.length),sa(1),Wo("@changeFace",t.isVisible?t.face:null)("@diceRoll",t.animeState),sa(1),Wo("ngIf",0<t.imageFile.url.length),sa(1),Wo("ngIf",0<t.imageFile.url.length),sa(1),ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),Wo("@changeFace",t.isVisible?t.face:null)("@diceRoll",t.animeState),sa(1),Wo("ngIf",!t.isFlip&&t.isDropShadow&&0<t.imageFile.url.length),sa(1),Wo("ngIf",t.isFlip&&t.isDropShadow&&0<t.imageFile.url.length))},directives:[yD,bD,lh,dh,Sh],pipes:[Lw],styles:[".is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;border-color:#999 #ccc #ccc #999;border-style:solid;border-width:28px 12px;border-radius:22px}.pedestal-grab-border[_ngcontent-%COMP%], .pedestal-inner[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;border:6px solid #d88b4b;border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:2px solid #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute}.fill-frame[_ngcontent-%COMP%], .image[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{font-size:15px;top:-30px}.name-tag[_ngcontent-%COMP%], .owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;padding:3px 9px;border-radius:6px;position:absolute}.owner-tag[_ngcontent-%COMP%]{font-size:12px;top:-55px}.rotate-frame[_ngcontent-%COMP%], .rotate-inner[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.back-tag[_ngcontent-%COMP%], .fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{bottom:0}.of-back[_ngcontent-%COMP%], .of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{top:0}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.back-face[_ngcontent-%COMP%], .front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{position:absolute;transform:rotateY(-180deg)}"],data:{animation:[sp("diceRoll",[fp("* => active",[lp("800ms ease",dp([up({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),up({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),sp("diceRollNameTag",[fp("* => active",[lp("800ms ease",dp([up({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),up({transform:"scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),sp("changeFace",[fp(":increment,:decrement",[lp("200ms ease",dp([up({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),up({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),sp("changeFaceNameTag",[fp(":increment,:decrement",[lp("200ms ease",dp([up({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),up({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),sp("bounceInOut",[fp("void => *",[lp("600ms ease",dp([up({transform:"scale3d(0, 0, 0)",offset:0}),up({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp(100,up({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),lN),hN=["characterImage"],dN=["chatBubble"],fN=function(e){return{opacity:e}};function pN(e,t){if(1&e&&(qo(0,"img",30),hc(1,"safe")),2&e){var n=is();ks("height",n.size*n.gridSize*n.heightWidthRatio,"px"),Wo("src",dc(1,5,0<n.shadowImageFile.url.length?n.shadowImageFile.url:n.imageFile.url,"resourceUrl"),dr)("ngStyle",rc(8,fN,n.isHollow?.4:.7))("@switchImageShadow",n.gameCharacter.currntImageIndex)}}var gN=function(e){return{transform:e}};function mN(e,t){if(1&e&&(Zo(0,"div",31),Zo(1,"div",32),zs(2),Yo(),Zo(3,"div",33),zs(4),Yo(),Yo()),2&e){var n=is();Wo("ngStyle",rc(3,gN,"translateX(-50%) translateX("+n.size*n.gridSize/2+"px) translateY("+n.nameplateOffset+"px) rotateX("+n.nameTagRotate+"deg)")),sa(2),Ls(n.name),sa(2),Ls(n.name)}}var vN=function(e,t){return{"black-paint":e,hollow:t}};function yN(e,t){if(1&e){var n=Qo();Zo(0,"img",34,35),es("load",function(){return Jt(n),is().onImageLoad()}),hc(2,"safe"),Yo()}if(2&e){var i=is();ks("height",i.size*i.gridSize*i.heightWidthRatio,"px"),Wo("ngClass",ac(7,vN,i.isBlackPaint,i.isHollow))("src",dc(2,4,i.imageFile.url,"resourceUrl"),dr)}}function bN(e,t){if(1&e&&(Zo(0,"span",41),qo(1,"img",42),hc(2,"safe"),Yo()),2&e){var n=is(2);sa(1),ks("border-color",n.dialogColor),Wo("src",dc(2,3,n.dialogFaceIcon.url,"resourceUrl"),dr)}}function kN(e,t){if(1&e&&(Zo(0,"span",41),qo(1,"img",42),hc(2,"safe"),Yo()),2&e){var n=is(2);sa(1),ks("border-color",n.dialogColor),Wo("src",dc(2,3,n.dialogFaceIcon.url,"resourceUrl"),dr)}}var _N=function(e,t){return{emote:e,"is-whisper":t}};function wN(e,t){if(1&e&&(Zo(0,"div",36),Zo(1,"div",37),Zo(2,"p",38),Uo(3,bN,3,6,"span",39),zs(4),Yo(),Zo(5,"p",40),Uo(6,kN,3,6,"span",39),zs(7),Yo(),Yo(),Yo()),2&e){var n=is();ks("color",!n.isEmote&&n.isWhisper?"#ccc":n.dialogColor),Wo("@fadeAndScaleInOut",n.isEmote),sa(2),ks("min-width",n.dialogChatBubbleMinWidth,"px")("border-color",n.dialogColor),Wo("ngClass",ac(17,_N,n.isEmote,n.isWhisper)),sa(1),Wo("ngIf",!n.isEmote&&n.isUseFaceIcon&&0<(null==n.dialogFaceIcon?null:n.dialogFaceIcon.url.length)),sa(1),Ls(n.dialogText),sa(1),ks("min-width",n.dialogChatBubbleMinWidth,"px")("border-color",n.dialogColor),Wo("ngClass",ac(20,_N,n.isEmote,n.isWhisper)),sa(1),Wo("ngIf",!n.isEmote&&n.isUseFaceIcon&&0<(null==n.dialogFaceIcon?null:n.dialogFaceIcon.url.length)),sa(1),Ls(n.dialogText)}}var xN=function(e){return{transform:e}};function CN(e,t){if(1&e&&(Zo(0,"div",43),Zo(1,"div",37),Zo(2,"span",44),Zo(3,"i"),zs(4),Yo(),Yo(),Zo(5,"span",45),Zo(6,"i"),zs(7),Yo(),Yo(),Yo(),Zo(8,"div",37),Zo(9,"span",46),zs(10),Yo(),Zo(11,"span",47),zs(12),Yo(),Yo(),Zo(13,"div",37),Zo(14,"span",44),Zo(15,"i"),zs(16),Yo(),Yo(),Zo(17,"span",45),Zo(18,"i"),zs(19),Yo(),Yo(),Yo(),Yo()),2&e){var n=is();ks("height",n.math.abs(n.altitude*n.gridSize)-(n.altitude>0?0:n.chatBubbleAltitude+4),"px"),Wo("ngStyle",rc(13,xN,"translateX("+n.size*n.gridSize/2+"px) translateY("+-n.size*n.gridSize/2+"px) rotateX(-90deg) translateY("+(n.altitude>0?-n.altitude*n.gridSize:0)+"px) rotateY("+n.viewRotateZ+"deg)")),sa(1),ks("visibility",n.altitude>0?"visible":"hidden"),sa(3),Ls(n.elevation),sa(3),Ls(n.elevation),sa(3),Ls(n.math.abs(n.altitude)),sa(2),Ls(n.math.abs(n.altitude)),sa(1),ks("visibility",n.altitude<0?"visible":"hidden"),sa(3),Ls(n.elevation),sa(3),Ls(n.elevation)}}var EN,SN=function(e){return{"not-inventory":e}},TN=function(e,t){return{"transform-origin":e,transform:t}},ON=function(e,t,n,i,r,a,o,s){return{black:e,blue:t,green:n,cyan:i,red:r,magenta:a,yellow:o,white:s}},IN=function(e){return{fall:e}},MN=function(e){return{inverse:e}},AN=function(e,t,n){return{bottom:e,transform:t,visibility:n}},PN=((EN=function(){function e(t,n,i,r,a,o){y(this,e),this.contextMenuService=t,this.panelService=n,this.changeDetector=i,this.pointerDeviceService=r,this.ngZone=a,this.modalService=o,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=gk,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.movableOption={},this.rotableOption={}}return k(e,[{key:"name",get:function(){return this.gameCharacter.name}},{key:"size",get:function(){return this.adjustMinBounds(this.gameCharacter.size)}},{key:"altitude",get:function(){return this.gameCharacter.altitude},set:function(e){this.gameCharacter.altitude=e}},{key:"imageFile",get:function(){return this.gameCharacter.imageFile}},{key:"rotate",get:function(){return this.gameCharacter.rotate},set:function(e){this.gameCharacter.rotate=e}},{key:"roll",get:function(){return this.gameCharacter.roll},set:function(e){this.gameCharacter.roll=e}},{key:"isDropShadow",get:function(){return this.gameCharacter.isDropShadow},set:function(e){this.gameCharacter.isDropShadow=e}},{key:"isAltitudeIndicate",get:function(){return this.gameCharacter.isAltitudeIndicate},set:function(e){this.gameCharacter.isAltitudeIndicate=e}},{key:"isInverse",get:function(){return this.gameCharacter.isInverse},set:function(e){this.gameCharacter.isInverse=e}},{key:"isHollow",get:function(){return this.gameCharacter.isHollow},set:function(e){this.gameCharacter.isHollow=e}},{key:"isBlackPaint",get:function(){return this.gameCharacter.isBlackPaint},set:function(e){this.gameCharacter.isBlackPaint=e}},{key:"aura",get:function(){return this.gameCharacter.aura},set:function(e){this.gameCharacter.aura=e}},{key:"isNotRide",get:function(){return this.gameCharacter.isNotRide},set:function(e){this.gameCharacter.isNotRide=e}},{key:"isUseIconToOverviewImage",get:function(){return this.gameCharacter.isUseIconToOverviewImage},set:function(e){this.gameCharacter.isUseIconToOverviewImage=e}},{key:"faceIcon",get:function(){return this.gameCharacter.faceIcon}},{key:"dialogFaceIcon",get:function(){return this.dialog&&this.dialog.faceIconIdentifier?Dk.instance.get(this.dialog.faceIconIdentifier):null}},{key:"shadowImageFile",get:function(){return this.gameCharacter.shadowImageFile}},{key:"elevation",get:function(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}},{key:"dialog",get:function(){return this._dialog},set:function(e){var t=this;if(this.gameCharacter){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);var n=gk.cr(e.text),i=gk.isEmote(n);i||(n=n.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd());var r=1e3/n.length>36?1e3/n.length:36;r>200&&(r=200),i||(this.gameCharacter.text=n.slice(0,1)),this.dialogTimeOutId=setTimeout(function(){t._dialog=null,t.gameCharacter.text="",t.gameCharacter.isEmote=!1,t.changeDetector.markForCheck()},n.length*r+6e3),this._dialog=e,this.gameCharacter.isEmote=i;var a=1;i?(this.gameCharacter.text=n,this.changeDetector.markForCheck()):this.chatIntervalId=setInterval(function(){a++,t.gameCharacter.text=n.slice(0,a),t.changeDetector.markForCheck(),a>=n.length&&clearInterval(t.chatIntervalId)},r)}}},{key:"dialogText",get:function(){if(!this.gameCharacter||!this.gameCharacter.text)return"";var e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(function(e){return e.trim()});return e.length>0?e.reverse()[0].trim():""}},{key:"dialogChatBubbleMinWidth",get:function(){var e=(this.gameCharacter.size+1.8)*this.gridSize,t=11*this.dialogText.length+52+(this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url?32:0);return e<t?e:t}},{key:"chatBubbleXDeg",get:function(){var e=90-this.viewRotateX;return e<0&&(e=360+e),(e%=360)>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}},{key:"characterImageHeight",get:function(){if(!this.characterImage)return 0;var e=this.characterImage.nativeElement.naturalHeight/this.characterImage.nativeElement.naturalWidth;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}},{key:"chatBubbleAltitude",get:function(){var e=Math.cos(this.roll*Math.PI/180),t=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),t<.5&&(t=.5);var n=(this.characterImageHeight+(this.name?36:0))*e+4,i=this.gridSize*this.size/2*t+4+this.gridSize*this.size/2;return n>i?n:i}},{key:"nameplateOffset",get:function(){return this.characterImage?this.gridSize*this.size*this.heightWidthRatio-this.characterImageHeight:this.gridSize*this.size*this.heightWidthRatio}},{key:"nameTagRotate",get:function(){var e=this.viewRotateX%360-90,t=(this.viewRotateZ+this.rotate)%360,n=this.roll%360;return(e>0?e:360+e)*(90<(t=t>0?t:360+t)&&t<270?1:-1)*(90<=(n=n>0?n:360+n)&&n<=270?-1:1)}},{key:"isListen",get:function(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}},{key:"isWhisper",get:function(){return this.dialog&&this.dialog.secret}},{key:"isEmote",get:function(){return this.gameCharacter.isEmote}},{key:"isUseFaceIcon",get:function(){return this.dialog&&this.dialog.faceIconIdentifier}},{key:"dialogColor",get:function(){return this.dialog&&this.dialog.color?this.dialog.color:Rk.CHAT_DEFAULT_COLOR}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){var n=tk.instance.get(t.data.identifier);e.gameCharacter&&n&&(e.gameCharacter===n||n instanceof dk&&e.gameCharacter.contains(n))&&e.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",function(t){e.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,function(t){e.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,function(t){e.ngZone.run(function(){e.viewRotateX=t.data.x,e.viewRotateZ=t.data.z,e.changeDetector.markForCheck()})}).on("POPUP_CHAT_BALLOON",-1e3,function(t){e.gameCharacter&&e.gameCharacter.identifier==t.data.characterIdentifier&&e.ngZone.run(function(){e.dialog=t.data,e.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,function(t){e.gameCharacter&&e.gameCharacter.identifier==t.data.characterIdentifier&&(e.ngZone.run(function(){e._dialog=null,e.gameCharacter.text="",e.gameCharacter.isEmote=!1,e.changeDetector.markForCheck()}),clearTimeout(e.dialogTimeOutId),clearInterval(e.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}},{key:"ngAfterViewInit",value:function(){}},{key:"ngOnDestroy",value:function(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),Jb.unregister(this)}},{key:"onDragstart",value:function(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}},{key:"onContextMenu",value:function(e){var t=this;e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map(function(e,n){return{name:t.gameCharacter.currntImageIndex==n?"\u25c9":"\u25cb",action:function(){t.changeImage(n)},default:t.gameCharacter.currntImageIndex==n,icon:e}})},this.gameCharacter.imageFiles.length<=1?null:ww,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:function(){t.isUseIconToOverviewImage=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:function(){t.isUseIconToOverviewImage=!0,Jb.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \ud83d\udcad\u306e\u8868\u793a",action:function(){t.gameCharacter.isShowChatBubble=!1}}:{name:"\u2610 \ud83d\udcad\u306e\u8868\u793a",action:function(){t.gameCharacter.isShowChatBubble=!0}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:function(){t.isDropShadow=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:function(){t.isDropShadow=!0,Jb.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:function(){t.isInverse=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:function(){t.isInverse=!0,Jb.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:function(){t.isHollow=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:function(){t.isHollow=!0,Jb.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:function(){t.isBlackPaint=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:function(){t.isBlackPaint=!0,Jb.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:function(){t.aura=-1,Jb.trigger("UPDATE_INVENTORY",null)}},ww].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map(function(e,n){return{name:"".concat(t.aura==n?"\u25c9":"\u25cb"," ").concat(e),action:function(){t.aura=n,Jb.trigger("UPDATE_INVENTORY",null)}}}))},ww,{name:"\u30ea\u30bb\u30c3\u30c8",action:function(){t.isInverse=!1,t.isHollow=!1,t.isBlackPaint=!1,t.aura=-1,Jb.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},ww,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:function(){t.isNotRide=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:function(){t.isNotRide=!0,Jb.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:function(){t.isAltitudeIndicate=!0,Jb.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:function(){0!=t.altitude&&(t.altitude=0,Mw.play(Iw.sweep))},altitudeHande:this.gameCharacter},ww,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:function(){t.showDetail(t.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:function(){t.showChatPalette(t.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:function(){t.showStandSetting(t.gameCharacter)}},ww,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(function(e){var n=e.value.toString();return{name:e.name?e.name:n,action:function(){gk.sameOrigin(n)?window.open(n.trim(),"_blank","noopener"):t.modalService.open(Jk,{url:n,title:t.gameCharacter.name,subTitle:e.name})},disabled:!gk.validUrl(n),error:gk.validUrl(n)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:gk.validUrl(n)&&!gk.sameOrigin(n)}}),disabled:this.gameCharacter.getUrls().length<=0},ww,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:function(){t.gameCharacter.isInventoryIndicate=!1,Jb.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:function(){t.gameCharacter.isInventoryIndicate=!0,Jb.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:function(){Jb.call("FAREWELL_STAND_IMAGE",{characterIdentifier:t.gameCharacter.identifier}),t.gameCharacter.setLocation("common"),Mw.play(Iw.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:function(){Jb.call("FAREWELL_STAND_IMAGE",{characterIdentifier:t.gameCharacter.identifier}),t.gameCharacter.setLocation(ek.peerId),Mw.play(Iw.piecePut)}},{name:"\u5893\u5834",action:function(){Jb.call("FAREWELL_STAND_IMAGE",{characterIdentifier:t.gameCharacter.identifier}),t.gameCharacter.setLocation("graveyard"),Mw.play(Iw.sweep)}}]},ww,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:function(){var e=t.gameCharacter.clone();e.location.x+=t.gridSize,e.location.y+=t.gridSize,e.update(),Mw.play(Iw.piecePut)}}],this.name)}},{key:"onMove",value:function(){Mw.play(Iw.piecePick)}},{key:"onMoved",value:function(){this.gameCharacter&&this.gameCharacter.text&&Jb.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),Mw.play(Iw.piecePut)}},{key:"onImageLoad",value:function(){Jb.trigger("UPDATE_GAME_OBJECT",this.gameCharacter)}},{key:"adjustMinBounds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e<t?t:e}},{key:"showDetail",value:function(e){var t=this.pointerDeviceService.pointers[0],n="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(n+=" - "+e.name),this.panelService.open(cS,{title:n,left:t.x-400,top:t.y-300,width:800,height:600}).tabletopObject=e}},{key:"showChatPalette",value:function(e){var t=this.pointerDeviceService.pointers[0];this.panelService.open(sC,{left:t.x-250,top:t.y-175,width:620,height:350}).character=e}},{key:"showStandSetting",value:function(e){var t=this.pointerDeviceService.pointers[0];this.panelService.open(YC,{left:t.x-400,top:t.y-175,width:730,height:572}).character=e}},{key:"changeImage",value:function(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,Mw.play(Iw.surprise),Jb.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),Jb.trigger("UPDATE_INVENTORY",null))}},{key:"nextImage",value:function(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}]),e}()).\u0275fac=function(e){return new(e||EN)(Vo(xw),Vo(Wk),Vo(Dl),Vo(DC),Vo($c),Vo(Zk))},EN.\u0275cmp=ct({type:EN,selectors:[["game-character"]],viewQuery:function(e,t){var n;1&e&&(Sc(hN,1),Sc(dN,1)),2&e&&(Ec(n=Tc())&&(t.characterImage=n.first),Ec(n=Tc())&&(t.chatBubble=n.first))},hostBindings:function(e,t){1&e&&es("dragstart",function(e){return t.onDragstart(e)})("contextmenu",function(e){return t.onContextMenu(e)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:78,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none"],[1,"image-box","is-3d",2,"pointer-events","none",3,"ngStyle"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d","style","pointer-events: none;","style","filter: brightness(0) blur(1px);",3,"height","src","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],[1,"inverser","is-3d",3,"ngClass"],[1,"aura","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image",3,"ngClass","src","height","load",4,"ngIf"],[1,"grab-group"],[1,"rotate-grab","rotate-grab-icon","of-top",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d",2,"filter","brightness(0) blur(1px)",3,"src","ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image",3,"ngClass","src","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box",4,"ngIf"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box"],[1,"face-icon",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&(Zo(0,"div",0),es("movable.ondragstart",function(){return t.onMove()})("movable.ondragend",function(){return t.onMoved()}),Zo(1,"div",1),Zo(2,"div",2),es("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),qo(3,"div",3),qo(4,"div",4),Zo(5,"div",5),Zo(6,"div",6),Zo(7,"div",7),zs(8,"autorenew"),Yo(),Zo(9,"div",8),zs(10,"autorenew"),Yo(),Yo(),Yo(),Zo(11,"div",9),Zo(12,"div",10),Zo(13,"div",11),Zo(14,"div",12),Uo(15,pN,2,10,"img",13),Yo(),Yo(),Yo(),Yo(),Zo(16,"div",14),es("dblclick",function(){return t.nextImage()}),Zo(17,"div",15),es("rotable.valueChange",function(e){return t.roll=e})("rotable.ondragstart",function(){return t.onMove()})("rotable.ondragend",function(){return t.onMoved()}),Zo(18,"div",16),Uo(19,mN,5,5,"div",17),Zo(20,"div",9),Zo(21,"div",18),Zo(22,"span",19),Zo(23,"span",20),Uo(24,yN,3,10,"img",21),Yo(),Yo(),Yo(),Yo(),Zo(25,"div",22),Zo(26,"div",23),Zo(27,"i",24),zs(28,"autorenew"),Yo(),Yo(),Zo(29,"div",25),Zo(30,"i",24),zs(31,"autorenew"),Yo(),Yo(),Yo(),Yo(),Yo(),Zo(32,"div",26,27),Uo(34,wN,8,23,"div",28),Yo(),Yo(),Yo(),Uo(35,CN,20,15,"div",29),Yo(),Yo()),2&e&&(ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),Wo("movable.option",t.movableOption),sa(1),Wo("@bounceInOut","in"),sa(1),Wo("rotable.option",t.rotableOption),sa(1),Wo("@switchImagePedestal",t.gameCharacter.currntImageIndex)("ngClass",rc(39,SN,!t.gameCharacter.isInventoryIndicate)),sa(1),Wo("@switchImagePedestal",t.gameCharacter.currntImageIndex),sa(8),ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize*t.heightWidthRatio,"px"),Wo("ngStyle",ac(41,TN,"50% "+t.size*t.gridSize+"px","translateY(-10%) scale(1.0,"+1/t.heightWidthRatio+") translateY(-"+99/t.heightWidthRatio+"%) rotateZ("+t.roll+"deg)")),sa(1),Wo("ngClass",lc(44,ON,0==t.aura,1==t.aura,2==t.aura,3==t.aura,4==t.aura,5==t.aura,6==t.aura,7==t.aura)),sa(1),Wo("ngStyle",rc(53,gN,"scaleX("+(t.isInverse?"-1":"1")+")")),sa(1),Wo("ngIf",t.isDropShadow&&(0<t.imageFile.url.length||0<t.shadowImageFile.url.length)),sa(1),Wo("ngClass",rc(55,IN,0==t.altitude))("ngStyle",rc(57,gN,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-t.altitude*t.gridSize+"px)")),sa(1),ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize,"px"),Wo("rotable.value",t.roll),sa(2),Wo("ngIf",0<t.name.length),sa(1),Wo("@switchImage",t.gameCharacter.currntImageIndex),sa(1),Wo("ngClass",rc(59,MN,t.isInverse)),sa(1),Wo("ngClass",lc(61,ON,0==t.aura,1==t.aura,2==t.aura,3==t.aura,4==t.aura,5==t.aura,6==t.aura,7==t.aura)),sa(1),ks("width",t.size*t.gridSize,"px")("height",t.size*t.gridSize*t.heightWidthRatio,"px"),sa(1),Wo("ngIf",0<t.imageFile.url.length),sa(2),Wo("ngStyle",rc(70,gN,"translateX(-50%) translateX("+t.size*t.gridSize/2+"px) translateY("+(t.nameplateOffset-10)+"px)")),sa(3),Wo("ngStyle",rc(72,gN,"translateX(-50%) translateX("+t.size*t.gridSize/2+"px")),sa(3),Wo("ngStyle",oc(74,AN,t.chatBubbleAltitude-(t.isEmote?t.gridSize/2:0)-4+"px","translateX(-50%) translateX("+t.size*t.gridSize/2+"px) rotateY("+(t.rotate+t.viewRotateZ)+"deg) rotateX("+t.chatBubbleXDeg+"deg)",t.gameCharacter.isShowChatBubble?"visible":"hidden")),sa(2),Wo("ngIf",t.isListen),sa(1),Wo("ngIf",t.isAltitudeIndicate&&(t.altitude<=-.5||.5<=t.altitude)))},directives:[yD,bD,lh,Sh,dh],pipes:[Lw],styles:['@supports (-moz-user-select:-moz-none){.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{bottom:-28px!important}}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;border-color:#999 #ccc #ccc #999;border-style:solid;border-width:28px 12px;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%], .pedestal-inner[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;border:6px solid #ffcc80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:2px solid #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute}.fill-frame[_ngcontent-%COMP%], .image[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms ease 0s}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px}.rotate-frame[_ngcontent-%COMP%], .rotate-inner[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:rgba(30,30,30,.8)}.back-tag[_ngcontent-%COMP%], .fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{bottom:0}.of-back[_ngcontent-%COMP%], .of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{top:0}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.altitude-indicator[_ngcontent-%COMP%], .elevation-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0 0 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:11px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px #f0dabd;letter-spacing:-8px;white-space:nowrap}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:11px;background:rgba(85,85,85,.8);box-shadow:0 0 2px 0 #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0 transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleX(1)}}@-webkit-keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleX(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleX(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:inline-block;position:relative;border:0;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0;object-position:50% 0;border-radius:.4em}'],data:{animation:[sp("switchImage",[fp(":increment, :decrement",[lp("400ms ease",dp([up({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),up({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),up({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),sp("switchImageShadow",[fp(":increment, :decrement",[lp("400ms ease",dp([up({transform:"scale3d(0.8, 0.8, 0.8)"}),up({transform:"scale3d(0, 1.2, 1.2)"}),up({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),sp("switchImagePedestal",[fp(":increment, :decrement",[lp("400ms ease",dp([up({transform:"scale3d(0, 0, 0)"}),up({transform:"scale3d(1.2, 1.2, 1.2)"}),up({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),sp("bounceInOut",[fp("void => *",[lp("600ms ease",dp([up({transform:"scale3d(0, 0, 0)",offset:0}),up({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),up({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),up({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),up({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),fp("* => void",[lp(100,up({transform:"scale3d(0, 0, 0)"}))])]),sp("fadeAndScaleInOut",[fp("void => *, true => false",[lp("200ms ease-in-out",dp([up({transform:"scale3d(0, 0, 0)",opacity:0}),up({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),fp("* => void, true => false",[lp("100ms ease-in-out",up({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),EN),DN=["cursor"],RN=["opacity"],FN=function(e){return{transform:e}};function NN(e,t){if(1&e&&(Zo(0,"div",1,2),Zo(2,"div",3),Zo(3,"div",4,5),Zo(5,"div",6),hc(6,"safe"),Zo(7,"div",7),Zo(8,"div",8),Zo(9,"span",9),Zo(10,"b"),zs(11),Yo(),Yo(),Yo(),Zo(12,"div",10),Zo(13,"span",9),Zo(14,"b"),zs(15),Yo(),Yo(),Yo(),Yo(),Yo(),Yo(),Yo(),Yo()),2&e){var n=is();sa(2),Wo("ngStyle",rc(15,FN,"rotateZ("+-n.rotateZ+"deg)")),sa(1),ks("background-color",n.color+"dd"),sa(2),ks("background-image",dc(6,12,"url("+n.iconUrl+")","style")),sa(2),Wo("ngStyle",rc(17,FN,"translateX(-50%) rotateX("+n.nameTagRotate+"deg)")),sa(1),ks("background-color",n.color+"dd"),sa(3),Ls(n.name),sa(1),ks("background-color",n.color+"dd"),sa(3),Ls(n.name)}}var zN,LN=((zN=function(){function e(t,n,i,r){var a=this;y(this,e),this.changeDetector=t,this.batchService=n,this.coordinateService=i,this.ngZone=r,this.cursor=Rk.myCursor,this.cursorElement=null,this.opacityElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=function(e){return a.onMouseMove(e)},this._x=0,this._y=0}return k(e,[{key:"iconUrl",get:function(){return this.cursor.image.url}},{key:"name",get:function(){return this.cursor.name}},{key:"isMine",get:function(){return this.cursor.isMine}},{key:"color",get:function(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}},{key:"rotateZ",get:function(){return e.viewRotateZ}},{key:"nameTagRotate",get:function(){var t=e.viewRotateX%360-90;return-(t>0?t:360+t)}},{key:"delayMs",get:function(){var e=16.6*ek.peerIds.length;return e<100?100:e}},{key:"ngOnInit",value:function(){var t=this;this.isMine||Jb.register(this).on("CURSOR_MOVE",function(e){e.sendFrom===t.cursor.peerId&&t.batchService.add(function(){t.stopTransition(),t.setAnimatedTransition(),t.setPosition(e.data[0],e.data[1],e.data[2]),t.resetFadeOut(),t.changeDetector.markForCheck()},t)}).on("TABLE_VIEW_ROTATE",-1e3,function(n){e.viewRotateX=n.data.x,e.viewRotateZ=n.data.z,t.changeDetector.markForCheck()})}},{key:"ngAfterViewInit",value:function(){var e=this;this.isMine?this.ngZone.runOutsideAngular(function(){document.body.addEventListener("mousemove",e.callcack),document.body.addEventListener("touchmove",e.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}},{key:"ngOnDestroy",value:function(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Jb.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}},{key:"onMouseMove",value:function(e){var t=this,n=e.touches?e.changedTouches[0].pageX:e.pageX,i=e.touches?e.changedTouches[0].pageY:e.pageY;n===this._x&&i===this._y||(this._x=n,this._y=i,this._target=e.target,this.updateInterval||(this.updateInterval=setTimeout(function(){t.updateInterval=null,t.calcLocalCoordinate(t._x,t._y,t._target)},this.delayMs)))}},{key:"calcLocalCoordinate",value:function(e,t,n){if(document.getElementById("app-table-layer").contains(n)){var i={x:e,y:t,z:0};i=this.coordinateService.calcTabletopLocalCoordinate(i,n),Jb.call("CURSOR_MOVE",[i.x,i.y,i.z])}}},{key:"resetFadeOut",value:function(){var e=this;this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new nk(function(){e.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}},{key:"stopTransition",value:function(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}},{key:"setAnimatedTransition",value:function(){this.cursorElement.style.transition="transform ".concat(this.delayMs+33,"ms linear, opacity 0.5s ease-out")}},{key:"setPosition",value:function(e,t,n){this.cursorElement.style.transform="translateX("+e+"px) translateY("+t+"px) translateZ("+n+"px)"}}]),e}()).viewRotateX=50,zN.viewRotateZ=10,zN.ctor=void Jb.register(zN).on("TABLE_VIEW_ROTATE",-1e3,function(e){zN.viewRotateX=e.data.x,zN.viewRotateZ=e.data.z}),zN.\u0275fac=function(e){return new(e||zN)(Vo(Dl),Vo(kO),Vo(uI),Vo($c))},zN.\u0275cmp=ct({type:zN,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,t){var n;1&e&&(Sc(DN,1),Sc(RN,1)),2&e&&(Ec(n=Tc())&&(t.cursorElementRef=n.first),Ec(n=Tc())&&(t.opacityElementRef=n.first))},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[["class","component is-3d is-transition is-pointer-events-none",4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d","is-transition",3,"ngStyle"],[1,"peer-cursor","is-3d","is-transition"],["opacity",""],[1,"icon","is-3d"],[1,"is-center","is-3d",3,"ngStyle"],[1,"name","is-3d",2,"backface-visibility","hidden"],[2,"white-space","nowrap","color","whitesmoke"],[1,"name","is-3d",2,"position","absolute","backface-visibility","hidden","transform","rotateY(-180deg)"]],template:function(e,t){1&e&&Uo(0,NN,16,19,"div",0),2&e&&Wo("ngIf",!t.isMine)},directives:[dh,Sh],pipes:[Lw],styles:[".component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:1px solid #f0dabd;border-radius:50% 50% 5% 50%;background-color:rgba(240,218,189,.9);opacity:.6;transform-origin:100% 100%;transform:translateX(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,50%;background-repeat:no-repeat;background-size:cover;background-color:#f0dabd;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:rgba(30,30,30,.8);transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translateX(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]}),zN),BN=["root"],jN=["gameTable"],UN=["gameObjects"],HN=["gridCanvas"];function VN(e,t){1&e&&qo(0,"terrain",17),2&e&&Wo("terrain",t.$implicit)}function WN(e,t){1&e&&qo(0,"game-table-mask",18),2&e&&Wo("gameTableMask",t.$implicit)}var GN=function(e){return{"z-index":e}};function ZN(e,t){if(1&e&&qo(0,"text-note",19),2&e){var n=t.$implicit;Wo("textNote",n)("appTooltip",n)("ngStyle",rc(3,GN,n.zindex))}}var YN=function(e,t){return{"z-index":e,transform:t}};function qN(e,t){if(1&e&&qo(0,"card-stack",20),2&e){var n=t.$implicit;Wo("cardStack",n)("appTooltip",n)("ngStyle",ac(3,YN,n.zindex,"translateZ("+.001*n.zindex+"px)"))}}function XN(e,t){if(1&e&&qo(0,"card",21),2&e){var n=t.$implicit;Wo("card",n)("appTooltip",n)("ngStyle",ac(3,YN,n.zindex,"translateZ("+.001*n.zindex+"px)"))}}function KN(e,t){if(1&e&&qo(0,"dice-symbol",22),2&e){var n=t.$implicit;Wo("diceSymbol",n)("appTooltip",n)}}function $N(e,t){if(1&e&&qo(0,"game-character",23),2&e){var n=t.$implicit;Wo("gameCharacter",n)("appTooltip",n)}}function QN(e,t){1&e&&qo(0,"peer-cursor",24),2&e&&Wo("cursor",t.$implicit)}var JN,ez,tz=function(e,t){return[e,t]},nz=function(e){return{"is-grabbing":e}},iz=function(e){return{transform:e}},rz=((ez=function(){function e(t,n,i,r,a,o,s,l){y(this,e),this.ngZone=t,this.contextMenuService=n,this.pointerDeviceService=i,this.coordinateService=r,this.imageService=a,this.tabletopService=o,this.tabletopActionService=s,this.modalService=l,this.isTransformMode=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}return k(e,[{key:"tableSelecter",get:function(){return this.tabletopService.tableSelecter}},{key:"currentTable",get:function(){return this.tabletopService.currentTable}},{key:"gridHeight",get:function(){return this.tabletopService.currentTable.gridHeight}},{key:"tableImage",get:function(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}},{key:"backgroundImage",get:function(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}},{key:"backgroundFilterType",get:function(){return this.currentTable.backgroundFilterType}},{key:"isPointerDragging",get:function(){return this.pointerDeviceService.isDragging}},{key:"characters",get:function(){return this.tabletopService.characters}},{key:"tableMasks",get:function(){return this.tabletopService.tableMasks}},{key:"cards",get:function(){return this.tabletopService.cards}},{key:"cardStacks",get:function(){return this.tabletopService.cardStacks}},{key:"terrains",get:function(){return this.tabletopService.terrains}},{key:"textNotes",get:function(){return this.tabletopService.textNotes}},{key:"diceSymbols",get:function(){return this.tabletopService.diceSymbols}},{key:"peerCursors",get:function(){return this.tabletopService.peerCursors}},{key:"ngOnInit",value:function(){var e=this;Jb.register(this).on("UPDATE_GAME_OBJECT",-1e3,function(t){e.gameTable.nativeElement.style.transition=null,t.data.identifier!==e.currentTable.identifier&&t.data.identifier!==e.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+e.currentTable.identifier),e.setGameTableGrid(e.currentTable.width,e.currentTable.height,e.currentTable.gridSize,e.currentTable.gridType,e.currentTable.gridColor))}).on("DRAG_LOCKED_OBJECT",function(t){e.gameTable.nativeElement.style.transition=null,e.isTransformMode=!0,e.pointerDeviceService.isDragging=!1,e.gridCanvas.nativeElement.style.opacity=(e.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",function(t){e.isTransformMode=!1,e.pointerDeviceService.isDragging=!1,e.setTransform(e.viewPotisonX,e.viewPotisonY,e.viewPotisonZ,e._rightRotate(e.viewRotateX),e._rightRotate(e.viewRotateY,!0),e._rightRotate(e.viewRotateZ),!0),setTimeout(function(){e.gridCanvas.nativeElement.style.opacity="0.0",e.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(function(){e.gameTable.nativeElement.style.transition=null},100),t&&"top"==t.data?e.setTransform(0,0,0,0,0,0,!0):e.setTransform(100,0,0,50,0,10,!0)},50),e.removeFocus()}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}},{key:"_rightRotate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=e%360;return t||(n>180?n-=360:n<-180&&(n+=360)),n}},{key:"ngAfterViewInit",value:function(){var e=this;this.ngZone.runOutsideAngular(function(){e.initializeTableTouchGesture(),e.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}},{key:"ngOnDestroy",value:function(){Jb.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}},{key:"initializeTableTouchGesture",value:function(){this.touchGesture=new gD(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}},{key:"initializeTableMouseGesture",value:function(){this.mouseGesture=new fD(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}},{key:"onTableTouchStart",value:function(){this.mouseGesture.cancel()}},{key:"onTableTouchEnd",value:function(){this.cancelInput()}},{key:"onTableTouchGesture",value:function(){this.cancelInput()}},{key:"onTableTouchTransform",value:function(e,t,n,i,r,a,o,s){var l=this;if(this.isTransformMode&&document.body===document.activeElement){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(function(){return l.contextMenuService.close()}),s.cancelable&&s.preventDefault();var c=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<i+this.viewRotateX&&(i+=80-(i+this.viewRotateX)),i+this.viewRotateX<0&&(i+=0-(i+this.viewRotateX)),750<n+this.viewPotisonZ&&(n+=750-(n+this.viewPotisonZ)),this.setTransform(e*=c,t*=c,n,i,r,a)}}},{key:"onTableMouseStart",value:function(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTransformMode=!0:(this.isTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}},{key:"onTableMouseEnd",value:function(e){this.cancelInput()}},{key:"onTableMouseTransform",value:function(e,t,n,i,r,a,o,s){var l=this;if(this.isTransformMode&&document.body===document.activeElement){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(function(){return l.contextMenuService.close()}),s.cancelable&&s.preventDefault();var c=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=c,t*=c,n,i,r,a)}}},{key:"cancelInput",value:function(){this.mouseGesture.cancel(),this.isTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}},{key:"onContextMenu",value:function(e){var t=this;if(document.activeElement.contains(this.gameObjects.nativeElement)&&(e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)){var n=this.pointerDeviceService.pointers[0],i=this.coordinateService.calcTabletopLocalCoordinate(),r=[];Array.prototype.push.apply(r,this.tabletopActionService.makeDefaultContextMenuActions(i)),r.push(ww),r.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:function(){t.modalService.open(eP)}}),this.contextMenuService.open(n,r,this.currentTable.name)}}},{key:"setTransform",value:function(e,t,n,i,r,a){var o=this,s=arguments.length>6&&void 0!==arguments[6]&&arguments[6];s?(this.viewRotateX=i,this.viewRotateY=r,this.viewRotateZ=a,this.viewPotisonX=e,this.viewPotisonY=t,this.viewPotisonZ=n):(this.viewRotateX+=i,this.viewRotateY+=r,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=t,this.viewPotisonZ+=n),(s||0!=i||0!=r||0!=i)&&this.ngZone.run(function(){Jb.trigger("TABLE_VIEW_ROTATE",{x:o.viewRotateX,y:o.viewRotateY,z:o.viewRotateZ})}),this.gameTable.nativeElement.style.transform="translateZ("+this.viewPotisonZ+"px) translateY("+this.viewPotisonY+"px) translateX("+this.viewPotisonX+"px) rotateY("+this.viewRotateY+"deg) rotateX("+this.viewRotateX+"deg) rotateZ("+this.viewRotateZ+"deg) "}},{key:"setGameTableGrid",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:JC.SQUARE,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"#000000e6";this.gameTable.nativeElement.style.width=e*n+"px",this.gameTable.nativeElement.style.height=t*n+"px",new uD(this.gridCanvas.nativeElement).render(e,t,n,i,r),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}},{key:"removeSelectionRanges",value:function(){var e=window.getSelection();e.isCollapsed||e.removeAllRanges()}},{key:"removeFocus",value:function(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}},{key:"trackByGameObject",value:function(e,t){return t.identifier}}]),e}()).\u0275fac=function(e){return new(e||ez)(Vo($c),Vo(xw),Vo(DC),Vo(uI),Vo(BA),Vo(hI),Vo(vD),Vo(Zk))},ez.\u0275cmp=ct({type:ez,selectors:[["game-table"]],viewQuery:function(e,t){var n;1&e&&(Sc(BN,3),Sc(jN,3),Sc(UN,3),Sc(HN,3)),2&e&&(Ec(n=Tc())&&(t.rootElementRef=n.first),Ec(n=Tc())&&(t.gameTable=n.first),Ec(n=Tc())&&(t.gameObjects=n.first),Ec(n=Tc())&&(t.gridCanvas=n.first))},hostBindings:function(e,t){1&e&&es("contextmenu",function(e){return t.onContextMenu(e)})},decls:19,vars:36,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],["class","is-3d",3,"terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameCharacter","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,t){1&e&&(Zo(0,"div",0),hc(1,"safe"),Yo(),Zo(2,"div",1,2),Zo(4,"div",3,4),Zo(6,"div",5,6),hc(8,"safe"),qo(9,"canvas",7,8),Uo(11,VN,1,1,"terrain",9),Uo(12,WN,1,1,"game-table-mask",10),Uo(13,ZN,1,5,"text-note",11),Uo(14,qN,1,6,"card-stack",12),Uo(15,XN,1,6,"card",13),Uo(16,KN,1,2,"dice-symbol",14),Uo(17,$N,1,2,"game-character",15),Uo(18,QN,1,1,"peer-cursor",16),Yo(),Yo(),Yo()),2&e&&(ks("background-image",dc(1,23,"url("+t.backgroundImage.url+")","style")),Wo("ngClass",ac(29,tz,t.backgroundFilterType?"is-filter":"",t.backgroundFilterType)),sa(2),Wo("ngClass",rc(32,nz,t.isPointerDragging)),sa(4),ks("background-image",dc(8,26,"url("+t.tableImage.url+")","style")),sa(3),Wo("ngStyle",rc(34,iz,"translateZ("+(t.gridHeight+.1)+"px)")),sa(2),Wo("ngForOf",t.terrains)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.tableMasks)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.textNotes)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.cardStacks)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.cards)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.diceSymbols)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.characters)("ngForTrackBy",t.trackByGameObject),sa(1),Wo("ngForOf",t.peerCursors)("ngForTrackBy",t.trackByGameObject))},directives:[lh,Sh,uh,LD,GD,nR,SF,LF,GF,uN,PN,LN],pipes:[Lw],styles:['.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%], .is-fill[_ngcontent-%COMP%]{position:absolute}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%], .table-image[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;background-size:100% 100%}.background-image[_ngcontent-%COMP%], .table-image[_ngcontent-%COMP%]{position:absolute;background-repeat:no-repeat}.background-image[_ngcontent-%COMP%]{top:0;left:0;bottom:0;right:0;margin:-5px;background-position:50%;background-size:cover}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.black[_ngcontent-%COMP%], .background-image.is-filter.white[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}']}),ez),az=((JN=function(){function e(t){y(this,e),this.elementRef=t,this.timer=null,this.needRepeat=!1}return k(e,[{key:"ngAfterViewInit",value:function(){var e=this,t=function t(){e.needRepeat?(e.timer=setTimeout(t,650),e.needRepeat=!1):(e.timer=null,e.elementRef.nativeElement.style.display="none")};Jb.register(this).on("*",function(n){e.needRepeat||ek.bandwidthUsage<3072||(null===e.timer?(e.elementRef.nativeElement.style.display="block",e.timer=setTimeout(t,650)):e.needRepeat=!0)})}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}}]),e}()).\u0275fac=function(e){return new(e||JN)(Vo(ll))},JN.\u0275cmp=ct({type:JN,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,t){1&e&&(Zo(0,"div",0),qo(1,"div",1),qo(2,"div",2),qo(3,"div",3),qo(4,"div",4),qo(5,"div",5),qo(6,"div",6),qo(7,"div",7),qo(8,"div",8),qo(9,"div",9),Zo(10,"div",10),zs(11,"sync"),Yo(),Yo())},styles:[".sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:hsla(0,0%,96.9%,.6)}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:hsla(0,0%,96.9%,.6)}"]}),JN),oz=["modalLayer"];function sz(e,t){if(1&e){var n=Qo();Zo(0,"li",2),es("click",function(){return Jt(n),is().save()}),Zo(1,"a",3),Zo(2,"div"),Zo(3,"i",5),zs(4,"sd_storage"),Yo(),Yo(),Zo(5,"div"),zs(6,"\u4fdd\u5b58"),Yo(),Yo(),Yo()}}function lz(e,t){if(1&e&&(Zo(0,"li",13),Zo(1,"a"),Zo(2,"div"),Zo(3,"i",14),zs(4,"sd_storage"),Yo(),Yo(),Zo(5,"div"),zs(6),Yo(),Yo(),Yo()),2&e){var n=is();sa(6),Bs("",n.progresPercent,"%")}}var cz,uz=((cz=function(){function e(t,n,r,o,s,l,c,u,h){var d=this;y(this,e),this.modalService=t,this.panelService=n,this.pointerDeviceService=r,this.chatMessageService=o,this.appConfigService=s,this.saveDataService=l,this.ngZone=c,this.contextMenuService=u,this.standImageService=h,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.ngZone.runOutsideAngular(function(){Fw.instance.initialize(),gI.instance.initialize(),pI.instance.initialize(),vI.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Zx.instance.initialize(),XC.instance.initialize(),new Vk("DiceBot").initialize(),new yI("Jukebox").initialize(),new Mw("SoundEffect").initialize(),Zx.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Zx.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab");var f=new Uk("SampleDiceRollTable");f.initialize(),f.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",f.command="SAMPLE",f.dice="1d6",f.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",Hk.instance.addDiceRollTable(f);var p=Wm.createEmpty("none_icon").toContext();p.url="./assets/images/ic_account_circle_black_24dp_2x.png";var g=Dk.instance.add(p);Aw.create(g.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",(p=Wm.createEmpty("stand_no_image").toContext()).url="./assets/images/nc96424.png";var m=Dk.instance.add(p);Aw.create(m.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9",Tw.resumeAudioContext(),Iw.dicePick=Ow.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Iw.dicePut=Ow.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Iw.diceRoll1=Ow.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Iw.diceRoll2=Ow.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Iw.cardDraw=Ow.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Iw.cardPick=Ow.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Iw.cardPut=Ow.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Iw.cardShuffle=Ow.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Iw.piecePick=Ow.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Iw.piecePut=Ow.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Iw.blockPick=Ow.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Iw.blockPut=Ow.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Iw.lock=Ow.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Iw.unlock=Ow.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Iw.sweep=Ow.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Iw.puyon=Ow.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,Iw.surprise=Ow.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,Ow.instance.get(Iw.dicePick).isHidden=!0,Ow.instance.get(Iw.dicePut).isHidden=!0,Ow.instance.get(Iw.diceRoll1).isHidden=!0,Ow.instance.get(Iw.diceRoll2).isHidden=!0,Ow.instance.get(Iw.cardDraw).isHidden=!0,Ow.instance.get(Iw.cardPick).isHidden=!0,Ow.instance.get(Iw.cardPut).isHidden=!0,Ow.instance.get(Iw.cardShuffle).isHidden=!0,Ow.instance.get(Iw.piecePick).isHidden=!0,Ow.instance.get(Iw.piecePut).isHidden=!0,Ow.instance.get(Iw.blockPick).isHidden=!0,Ow.instance.get(Iw.blockPut).isHidden=!0,Ow.instance.get(Iw.lock).isHidden=!0,Ow.instance.get(Iw.unlock).isHidden=!0,Ow.instance.get(Iw.sweep).isHidden=!0,Ow.instance.get(Iw.puyon).isHidden=!0,Ow.instance.get(Iw.surprise).isHidden=!0,Rk.createMyCursor(),Rk.myCursor.name||(Rk.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc"),Rk.myCursor.imageIdentifier=g.identifier,Jb.register(this).on("UPDATE_GAME_OBJECT",function(e){d.lazyNgZoneUpdate(e.isSendFromSelf)}).on("DELETE_GAME_OBJECT",function(e){d.lazyNgZoneUpdate(e.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",function(e){e.isSendFromSelf&&d.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",function(e){e.isSendFromSelf&&d.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",function(e){if(console.log("LOAD_CONFIG !!!",e.data),e.data.dice&&e.data.dice.url)fetch(e.data.dice.url+"/v1/names",{mode:"cors"}).then(function(e){return e.json()}).then(function(t){var n,r=e.data.dice.url;Vk.apiUrl="/"===r.substr(r.length-1)?r.substr(0,r.length-1):r,Vk.diceBotInfos=[];var o=t.names.filter(function(e){return"DiceBot"!=e.system}).map(function(e){var t,n=e.sort_key&&e.sort_key.indexOf("\u56fd\u969b\u5316")<0?e.sort_key:e.name.normalize("NFKD"),i=a(Vk.replaceData);try{for(i.s();!(t=i.n()).done;){var r=t.value;r[2]&&e.name===r[0]&&(n=r[1],e.name=r[2]),n=n.split(r[0].normalize("NFKD")).join(r[1].normalize("NFKD"))}}catch(o){i.e(o)}finally{i.f()}return e.normalize=n.replace(/[\u3041-\u3096]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+96)}).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),e}).map(function(e){var t=/.+\:(.+)/.exec(e.system);return e.lang=t?t[1]:"A",e}).sort(function(e,t){return e.lang<t.lang?-1:e.lang>t.lang?1:e.normalize==t.normalize?0:e.normalize<t.normalize?-1:1});if((n=Vk.diceBotInfos).push.apply(n,i(o.map(function(e){return{script:e.system,game:e.name}}))),o.length>0){var s,l=o[0].normalize.substr(0,1),c={index:o[0].normalize.substr(0,1),infos:[]},u=a(o);try{for(u.s();!(s=u.n()).done;){var h=s.value,d="B"==h.lang?"\u7279\u6b8a":"ChineseTraditional"==h.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==h.lang?"\ud55c\uad6d\uc5b4":"English"==h.lang?"English":h.normalize.substr(0,1);d!==l&&(l=d,Vk.diceBotInfosIndexed.push(c),c={index:d,infos:[]}),c.infos.push({script:h.system,game:h.name})}}catch(f){u.e(f)}finally{u.f()}Vk.diceBotInfosIndexed.push(c)}});else{Vk.diceBotInfos.forEach(function(e){var t,n=e.game.normalize("NFKD"),i=a(Vk.replaceData);try{for(i.s();!(t=i.n()).done;){var r=t.value;r[2]&&e.game===r[0]&&(n=r[1],e.game=r[2]),n=n.split(r[0].normalize("NFKD")).join(r[1].normalize("NFKD"))}}catch(o){i.e(o)}finally{i.f()}n=n.replace(/[\u3041-\u3096]/g,function(e){return String.fromCharCode(e.charCodeAt(0)+96)}).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),e.sort_key=e.lang?e.lang:n.normalize("NFKD")}),Vk.diceBotInfos.sort(function(e,t){return e.sort_key==t.sort_key?0:e.sort_key<t.sort_key?-1:1});var t,n=Vk.diceBotInfos[0].sort_key[0],r={index:n,infos:[]},o=a(Vk.diceBotInfos);try{for(o.s();!(t=o.n()).done;){var s=t.value;(s.lang?s.lang:s.sort_key[0])!==n&&(n=s.lang?s.lang:s.sort_key[0],Vk.diceBotInfosIndexed.push(r),r={index:n,infos:[]}),r.infos.push({script:s.script,game:s.game})}}catch(l){o.e(l)}finally{o.f()}Vk.diceBotInfosIndexed.push(r)}ek.setApiKey(e.data.webrtc.key),ek.open()}).on("FILE_LOADED",function(e){d.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",function(e){console.log("OPEN_NETWORK",e.data.peerId),Rk.myCursor.peerId=ek.peerContext.peerId,Rk.myCursor.userId=ek.peerContext.userId}).on("CLOSE_NETWORK",function(e){console.log("CLOSE_NETWORK",e.data.peerId),d.ngZone.run(function(){return Lm(d,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(1<ek.peerIds.length)){e.next=5;break}return e.next=3,this.modalService.open(_w,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u63a5\u7d9a\u306b\u4f55\u3089\u304b\u306e\u7570\u5e38\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002\n\u3053\u306e\u8868\u793a\u4ee5\u5f8c\u3001\u63a5\u7d9a\u304c\u4e0d\u5b89\u5b9a\u3067\u3042\u308c\u3070\u3001\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u3066\u304f\u3060\u3055\u3044\u3002"});case 3:e.next=8;break;case 5:return e.next=7,this.modalService.open(_w,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u63a5\u7d9a\u60c5\u5831\u304c\u7834\u68c4\u3055\u308c\u307e\u3057\u305f\u3002\n\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"});case 7:ek.open();case 8:case"end":return e.stop()}},e,this)}))})}).on("CONNECT_PEER",function(e){e.isSendFromSelf&&d.chatMessageService.calibrateTimeOffset(),d.lazyNgZoneUpdate(e.isSendFromSelf)}).on("DISCONNECT_PEER",function(e){d.lazyNgZoneUpdate(e.isSendFromSelf)}).on("POPUP_STAND_IMAGE",-1e3,function(e){var t=tk.instance.get(e.data.standIdentifier),n=tk.instance.get(e.data.characterIdentifier);d.standImageService.show(n,t,e.data.color?e.data.color:null,e.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,function(e){d.standImageService.farewell(e.data.characterIdentifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,function(e){d.standImageService.destroyAll()})}return k(e,[{key:"ngAfterViewInit",value:function(){var e=this;Wk.defaultParentViewContainerRef=Zk.defaultParentViewContainerRef=xw.defaultParentViewContainerRef=XP.defaultParentViewContainerRef=this.modalLayerViewContainerRef,setTimeout(function(){e.panelService.open(bO,{width:520,height:450,left:100}),e.panelService.open(uM,{width:700,height:400,left:100,top:450})},0)}},{key:"ngOnDestroy",value:function(){Jb.unregister(this)}},{key:"open",value:function(e){var t=null,n={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":n.width=520,t=bO;break;case"ChatWindowComponent":t=uM,n.width=700;break;case"GameTableSettingComponent":t=eP,n={width:610,height:400,left:100};break;case"FileStorageComponent":t=lx,n.width=700;break;case"GameCharacterSheetComponent":t=cS;break;case"JukeboxComponent":t=fP;break;case"GameCharacterGeneratorComponent":t=YM,n={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":t=zA;break;case"DiceRollTableSettingComponent":t=cD,n={width:645,height:470}}t&&(n.top=20*(this.openPanelCount%10+1),n.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(t,n))}},{key:"save",value:function(){return Lm(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isSaveing){e.next=2;break}return e.abrupt("return");case 2:return this.isSaveing=!0,this.progresPercent=0,t=ek.peerContext&&0<ek.peerContext.roomName.length?ek.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e.next=6,this.saveDataService.saveRoomAsync(t,function(e){n.progresPercent=e});case 6:setTimeout(function(){n.isSaveing=!1,n.progresPercent=0},500);case 7:case"end":return e.stop()}},e,this)}))}},{key:"handleFileSelect",value:function(e){var t=e.target,n=t.files;n.length&&Fw.instance.load(n),t.value=""}},{key:"lazyNgZoneUpdate",value:function(e){var t=this;if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(function(){t.immediateUpdateTimer=null,null!=t.lazyUpdateTimer&&(clearTimeout(t.lazyUpdateTimer),t.lazyUpdateTimer=null),t.ngZone.run(function(){})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(function(){t.lazyUpdateTimer=null,null!=t.immediateUpdateTimer&&(clearTimeout(t.immediateUpdateTimer),t.immediateUpdateTimer=null),t.ngZone.run(function(){})},100)}}},{key:"openDiceRollTable",value:function(){}},{key:"resetPointOfView",value:function(){this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:function(){return Jb.trigger("RESET_POINT_OF_VIEW",null)}},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:function(){return Jb.trigger("RESET_POINT_OF_VIEW","top")}}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}},{key:"standSetteings",value:function(){var e=qP.isShowStand,t=qP.isShowNameTag,n=qP.isCanBeGone;this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:(e?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:function(){qP.isShowStand=!e}},{name:(t?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:function(){qP.isShowNameTag=!t}},{name:(n?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:function(){qP.isCanBeGone=!n}},ww,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:function(){return Jb.trigger("DESTORY_STAND_IMAGE_ALL",null)}}],"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a")}},{key:"diceAllOpne",value:function(){confirm("\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u3067\u306f\u306a\u3044\u30c0\u30a4\u30b9\u3092\u3059\u3079\u3066\u516c\u958b\u3057\u307e\u3059\u3002\n\u3088\u308d\u3057\u3044\u3067\u3059\u304b\uff1f")&&Jb.trigger("DICE_ALL_OPEN",null)}}]),e}()).\u0275fac=function(e){return new(e||cz)(Vo(Zk),Vo(Wk),Vo(DC),Vo(Yx),Vo(QT),Vo(aE),Vo($c),Vo(xw),Vo(XP))},cz.\u0275cmp=ct({type:cz,selectors:[["app-root"]],viewQuery:function(e,t){var n;1&e&&Sc(oz,3,Vl),2&e&&Ec(n=Tc())&&(t.modalLayerViewContainerRef=n.first)},decls:98,vars:9,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[2,"margin-top","2em","font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,t){1&e&&(Zo(0,"div",0),qo(1,"game-table"),Yo(),Zo(2,"ui-panel",1),Zo(3,"nav"),Zo(4,"ul"),Zo(5,"li",2),es("click",function(){return t.open("PeerMenuComponent")}),Zo(6,"a",3),Zo(7,"div"),Zo(8,"i",4),zs(9,"people"),Yo(),Yo(),Zo(10,"div"),zs(11,"\u63a5\u7d9a"),Yo(),Yo(),Yo(),Zo(12,"li",2),es("click",function(){return t.open("ChatWindowComponent")}),Zo(13,"a",3),Zo(14,"div"),Zo(15,"i",4),zs(16,"speaker_notes"),Yo(),Yo(),Zo(17,"div"),zs(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),Yo(),Yo(),Yo(),Zo(19,"li",2),es("click",function(){return t.open("GameTableSettingComponent")}),Zo(20,"a",3),Zo(21,"div"),Zo(22,"i",4),zs(23,"layers"),Yo(),Yo(),Zo(24,"div"),zs(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),Yo(),Yo(),Yo(),Zo(26,"li",2),es("click",function(){return t.open("FileStorageComponent")}),Zo(27,"a",3),Zo(28,"div"),Zo(29,"i",4),zs(30,"photo_library"),Yo(),Yo(),Zo(31,"div"),zs(32,"\u753b\u50cf"),Yo(),Yo(),Yo(),Zo(33,"li",2),es("click",function(){return t.open("JukeboxComponent")}),Zo(34,"a",3),Zo(35,"div"),Zo(36,"i",5),zs(37,"queue_music"),Yo(),Yo(),Zo(38,"div"),zs(39,"\u97f3\u697d"),Yo(),Yo(),Yo(),Zo(40,"li",2),es("click",function(){return t.open("DiceRollTableSettingComponent")}),Zo(41,"a",3),Zo(42,"div"),Zo(43,"i",5),zs(44,"table_rows"),Yo(),Yo(),Zo(45,"div"),zs(46,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"),Yo(),Yo(),Yo(),Zo(47,"li",2),es("click",function(){return t.open("GameObjectInventoryComponent")}),Zo(48,"a",3),Zo(49,"div"),Zo(50,"i",4),zs(51,"folder_shared"),Yo(),Yo(),Zo(52,"div"),zs(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Yo(),Yo(),Yo(),Zo(54,"li",2),es("click",function(){return t.diceAllOpne()}),Zo(55,"a",3),Zo(56,"div"),Zo(57,"i",4),zs(58,"all_out"),Yo(),Yo(),Zo(59,"div"),zs(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),Yo(),Yo(),Yo(),Zo(61,"li",2),es("click",function(){return t.standSetteings()}),Zo(62,"a",3),Zo(63,"div"),Zo(64,"i",4),zs(65,"how_to_reg"),Yo(),Yo(),Zo(66,"div"),zs(67,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),Zo(68,"sup",6),zs(69,"*"),Yo(),Yo(),Yo(),Yo(),Zo(70,"li",2),es("click",function(){return t.resetPointOfView()}),Zo(71,"a",3),Zo(72,"div"),Zo(73,"i",4),zs(74,"remove_red_eye"),Yo(),Yo(),Zo(75,"div"),zs(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),Zo(77,"sup",6),zs(78,"*"),Yo(),Yo(),Yo(),Yo(),Zo(79,"li"),Zo(80,"a",3),Zo(81,"label"),Zo(82,"div"),Zo(83,"i",5),zs(84,"open_in_browser"),Yo(),Yo(),Zo(85,"div"),zs(86,"ZIP\u8aad\u8fbc"),Yo(),Zo(87,"input",7),es("change",function(e){return t.handleFileSelect(e)}),Yo(),Yo(),Yo(),Yo(),Uo(88,sz,7,0,"li",8),Uo(89,lz,7,1,"li",9),Yo(),Zo(90,"div",10),Zo(91,"b"),Zo(92,"sup",6),zs(93,"*"),Yo(),zs(94,"\u306f\u81ea\u5206\u306e\u307f"),Yo(),Yo(),Yo(),Yo(),qo(95,"div",null,11),qo(97,"network-indicator",12)),2&e&&(sa(2),Wo("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1),sa(86),Wo("ngIf",!t.isSaveing),sa(1),Wo("ngIf",t.isSaveing))},directives:[rz,MP,dh,az],styles:["nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:rgba(30,30,30,.8)}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:rgba(30,30,30,.8);border:1px solid #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{-webkit-animation:vibration .2s infinite;animation:vibration .2s infinite}@-webkit-keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}"]}),cz);Wk.UIPanelComponentClass=MP,xw.ContextMenuComponentClass=ZM,Zk.ModalComponentClass=mP;var hz=new N(function(e){return e.complete()});function dz(e){return e?function(e){return new N(function(t){return e.schedule(function(){return t.complete()})})}(e):hz}function fz(e){return new N(function(t){var n;try{n=e()}catch(i){return void t.error(i)}return(n?ee(n):dz()).subscribe(t)})}function pz(e,t){return new N(t?function(n){return t.schedule(gz,0,{error:e,subscriber:n})}:function(t){return t.error(e)})}function gz(e){var t=e.error;e.subscriber.error(t)}function mz(e,t,n,r){return m(n)&&(r=n,n=void 0),r?mz(e,t,n).pipe(G(function(e){return C(e)?r.apply(void 0,i(e)):r(e)})):new N(function(i){vz(e,t,function(e){i.next(arguments.length>1?Array.prototype.slice.call(arguments):e)},i,n)})}function vz(e,t,n,i,r){var a;if(function(e){return e&&"function"==typeof e.addEventListener&&"function"==typeof e.removeEventListener}(e)){var o=e;e.addEventListener(t,n,r),a=function(){return o.removeEventListener(t,n,r)}}else if(function(e){return e&&"function"==typeof e.on&&"function"==typeof e.off}(e)){var s=e;e.on(t,n),a=function(){return s.off(t,n)}}else if(function(e){return e&&"function"==typeof e.addListener&&"function"==typeof e.removeListener}(e)){var l=e;e.addListener(t,n),a=function(){return l.removeListener(t,n)}}else{if(!e||!e.length)throw new TypeError("Invalid event target");for(var c=0,u=e.length;c<u;c++)vz(e[c],t,n,i,r)}i.add(a)}function yz(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var i=t[t.length-1];return W(i)?(t.pop(),J(t,i)):le(t)}function bz(){}var kz=new N(bz);function _z(e,t){return function(n){return n.lift(new wz(e,t))}}var wz=function(){function e(t,n){y(this,e),this.predicate=t,this.thisArg=n}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new xz(e,this.predicate,this.thisArg))}}]),e}(),xz=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this,e)).predicate=i,a.thisArg=r,a.count=0,a}return k(n,[{key:"_next",value:function(e){var t;try{t=this.predicate.call(this.thisArg,e,this.count++)}catch(n){return void this.destination.error(n)}t&&this.destination.next(e)}}]),n}(A);function Cz(e,t){return"function"==typeof t?function(n){return n.pipe(Cz(function(n,i){return ee(e(n,i)).pipe(G(function(e,r){return t(n,e,i,r)}))}))}:function(t){return t.lift(new Ez(e))}}var Ez=function(){function e(t){y(this,e),this.project=t}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new Sz(e,this.project))}}]),e}(),Sz=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this,e)).project=i,r.index=0,r}return k(n,[{key:"_next",value:function(e){var t,n=this.index++;try{t=this.project(e,n)}catch(i){return void this.destination.error(i)}this._innerSub(t)}},{key:"_innerSub",value:function(e){var t=this.innerSubscription;t&&t.unsubscribe();var n=new te(this),i=this.destination;i.add(n),this.innerSubscription=ie(e,n),this.innerSubscription!==n&&i.add(this.innerSubscription)}},{key:"_complete",value:function(){var e=this.innerSubscription;e&&!e.closed||u(v(n.prototype),"_complete",this).call(this),this.unsubscribe()}},{key:"_unsubscribe",value:function(){this.innerSubscription=void 0}},{key:"notifyComplete",value:function(){this.innerSubscription=void 0,this.isStopped&&u(v(n.prototype),"_complete",this).call(this)}},{key:"notifyNext",value:function(e){this.destination.next(e)}}]),n}(ne),Tz=function(){function e(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return e.prototype=Object.create(Error.prototype),e}();function Oz(e){return function(t){return 0===e?dz():t.lift(new Pz(e))}}var Iz,Mz,Az,Pz=function(){function e(t){if(y(this,e),this.total=t,this.total<0)throw new Tz}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new Dz(e,this.total))}}]),e}(),Dz=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this,e)).total=i,r.count=0,r}return k(n,[{key:"_next",value:function(e){var t=this.total,n=++this.count;n<=t&&(this.destination.next(e),n===t&&(this.destination.complete(),this.unsubscribe()))}}]),n}(A),Rz=function(){function e(t,n,i){y(this,e),this.nextOrObserver=t,this.error=n,this.complete=i}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new Fz(e,this.nextOrObserver,this.error,this.complete))}}]),e}(),Fz=function(e){h(n,e);var t=f(n);function n(e,i,r,a){var o;return y(this,n),(o=t.call(this,e))._tapNext=bz,o._tapError=bz,o._tapComplete=bz,o._tapError=r||bz,o._tapComplete=a||bz,m(i)?(o._context=g(o),o._tapNext=i):i&&(o._context=i,o._tapNext=i.next||bz,o._tapError=i.error||bz,o._tapComplete=i.complete||bz),o}return k(n,[{key:"_next",value:function(e){try{this._tapNext.call(this._context,e)}catch(t){return void this.destination.error(t)}this.destination.next(e)}},{key:"_error",value:function(e){try{this._tapError.call(this._context,e)}catch(e){return void this.destination.error(e)}this.destination.error(e)}},{key:"_complete",value:function(){try{this._tapComplete.call(this._context)}catch(e){return void this.destination.error(e)}return this.destination.complete()}}]),n}(A),Nz=function(e){h(n,e);var t=f(n);function n(e,i){var r;return y(this,n),(r=t.call(this,e,i)).scheduler=e,r.work=i,r.pending=!1,r}return k(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(this.closed)return this;this.state=e;var n=this.id,i=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(i,n,t)),this.pending=!0,this.delay=t,this.id=this.id||this.requestAsyncId(i,this.id,t),this}},{key:"requestAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return setInterval(e.flush.bind(e,this),n)}},{key:"recycleAsyncId",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(null!==n&&this.delay===n&&!1===this.pending)return t;clearInterval(t)}},{key:"execute",value:function(e,t){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var n=this._execute(e,t);if(n)return n;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}},{key:"_execute",value:function(e,t){var n,i=!1;try{this.work(e)}catch(r){i=!0,n=!!r&&r||new Error(r)}if(i)return this.unsubscribe(),n}},{key:"_unsubscribe",value:function(){var e=this.id,t=this.scheduler,n=t.actions,i=n.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==i&&n.splice(i,1),null!=e&&(this.id=this.recycleAsyncId(t,e,null)),this.delay=null}}]),n}(function(e){h(n,e);var t=f(n);function n(e,i){return y(this,n),t.call(this)}return k(n,[{key:"schedule",value:function(e){return this}}]),n}(O)),zz=function(){var e=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.now;y(this,e),this.SchedulerAction=t,this.now=n}return k(e,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0;return new this.SchedulerAction(this,e).schedule(n,t)}}]),e}();return e.now=function(){return Date.now()},e}(),Lz=new(function(e){h(n,e);var t=f(n);function n(e){var i,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zz.now;return y(this,n),(i=t.call(this,e,function(){return n.delegate&&n.delegate!==g(i)?n.delegate.now():r()})).actions=[],i.active=!1,i.scheduled=void 0,i}return k(n,[{key:"schedule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0;return n.delegate&&n.delegate!==this?n.delegate.schedule(e,t,i):u(v(n.prototype),"schedule",this).call(this,e,t,i)}},{key:"flush",value:function(e){var t=this.actions;if(this.active)t.push(e);else{var n;this.active=!0;do{if(n=e.execute(e.state,e.delay))break}while(e=t.shift());if(this.active=!1,n){for(;e=t.shift();)e.unsubscribe();throw n}}}}]),n}(zz))(Nz),Bz=((Iz=function(){function e(t,n,i){y(this,e),this.kind=t,this.value=n,this.error=i,this.hasValue="N"===t}return k(e,[{key:"observe",value:function(e){switch(this.kind){case"N":return e.next&&e.next(this.value);case"E":return e.error&&e.error(this.error);case"C":return e.complete&&e.complete()}}},{key:"do",value:function(e,t,n){switch(this.kind){case"N":return e&&e(this.value);case"E":return t&&t(this.error);case"C":return n&&n()}}},{key:"accept",value:function(e,t,n){return e&&"function"==typeof e.next?this.observe(e):this.do(e,t,n)}},{key:"toObservable",value:function(){switch(this.kind){case"N":return yz(this.value);case"E":return pz(this.error);case"C":return dz()}throw new Error("unexpected notification kind value")}}],[{key:"createNext",value:function(t){return void 0!==t?new e("N",t):e.undefinedValueNotification}},{key:"createError",value:function(t){return new e("E",void 0,t)}},{key:"createComplete",value:function(){return e.completeNotification}}]),e}()).completeNotification=new Iz("C"),Iz.undefinedValueNotification=new Iz("N",void 0),Iz),jz=function(){function e(t,n){y(this,e),this.delay=t,this.scheduler=n}return k(e,[{key:"call",value:function(e,t){return t.subscribe(new Uz(e,this.delay,this.scheduler))}}]),e}(),Uz=function(e){h(n,e);var t=f(n);function n(e,i,r){var a;return y(this,n),(a=t.call(this,e)).delay=i,a.scheduler=r,a.queue=[],a.active=!1,a.errored=!1,a}return k(n,[{key:"_schedule",value:function(e){this.active=!0,this.destination.add(e.schedule(n.dispatch,this.delay,{source:this,destination:this.destination,scheduler:e}))}},{key:"scheduleNotification",value:function(e){if(!0!==this.errored){var t=this.scheduler,n=new Hz(t.now()+this.delay,e);this.queue.push(n),!1===this.active&&this._schedule(t)}}},{key:"_next",value:function(e){this.scheduleNotification(Bz.createNext(e))}},{key:"_error",value:function(e){this.errored=!0,this.queue=[],this.destination.error(e),this.unsubscribe()}},{key:"_complete",value:function(){this.scheduleNotification(Bz.createComplete()),this.unsubscribe()}}],[{key:"dispatch",value:function(e){for(var t=e.source,n=t.queue,i=e.scheduler,r=e.destination;n.length>0&&n[0].time-i.now()<=0;)n.shift().notification.observe(r);if(n.length>0){var a=Math.max(0,n[0].time-i.now());this.schedule(e,a)}else this.unsubscribe(),t.active=!1}}]),n}(A),Hz=function e(t,n){y(this,e),this.time=t,this.notification=n},Vz="Service workers are disabled or not supported by this browser",Wz=function(){function e(t){if(y(this,e),this.serviceWorker=t,t){var n=mz(t,"controllerchange").pipe(G(function(){return t.controller})),i=function(){return se(1)(yz.apply(void 0,arguments))}(fz(function(){return yz(t.controller)}),n);this.worker=i.pipe(_z(function(e){return!!e})),this.registration=this.worker.pipe(Cz(function(){return t.getRegistration()}));var r=mz(t,"message").pipe(G(function(e){return e.data})).pipe(_z(function(e){return e&&e.type})).pipe(me(new H));r.connect(),this.events=r}else this.worker=this.events=this.registration=fz(function(){return pz(new Error("Service workers are disabled or not supported by this browser"))})}return k(e,[{key:"postMessage",value:function(e,t){return this.worker.pipe(Oz(1),(n=function(n){n.postMessage(Object.assign({action:e},t))},function(e){return e.lift(new Rz(n,void 0,void 0))})).toPromise().then(function(){});var n}},{key:"postMessageWithStatus",value:function(e,t,n){var i=this.waitForStatus(n),r=this.postMessage(e,t);return Promise.all([i,r]).then(function(){})}},{key:"generateNonce",value:function(){return Math.round(1e7*Math.random())}},{key:"eventsOfType",value:function(e){return this.events.pipe(_z(function(t){return t.type===e}))}},{key:"nextEventOfType",value:function(e){return this.eventsOfType(e).pipe(Oz(1))}},{key:"waitForStatus",value:function(e){return this.eventsOfType("STATUS").pipe(_z(function(t){return t.nonce===e}),Oz(1),G(function(e){if(!e.status)throw new Error(e.error)})).toPromise()}},{key:"isEnabled",get:function(){return!!this.serviceWorker}}]),e}(),Gz=((Az=function(){function e(t){if(y(this,e),this.sw=t,this.subscriptionChanges=new H,!t.isEnabled)return this.messages=kz,this.notificationClicks=kz,void(this.subscription=kz);this.messages=this.sw.eventsOfType("PUSH").pipe(G(function(e){return e.data})),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(G(function(e){return e.data})),this.pushManager=this.sw.registration.pipe(G(function(e){return e.pushManager}));var n=this.pushManager.pipe(Cz(function(e){return e.getSubscription()}));this.subscription=ce(n,this.subscriptionChanges)}return k(e,[{key:"isEnabled",get:function(){return this.sw.isEnabled}},{key:"requestSubscription",value:function(e){var t=this;if(!this.sw.isEnabled)return Promise.reject(new Error(Vz));for(var n={userVisibleOnly:!0},i=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),r=new Uint8Array(new ArrayBuffer(i.length)),a=0;a<i.length;a++)r[a]=i.charCodeAt(a);return n.applicationServerKey=r,this.pushManager.pipe(Cz(function(e){return e.subscribe(n)}),Oz(1)).toPromise().then(function(e){return t.subscriptionChanges.next(e),e})}},{key:"unsubscribe",value:function(){var e=this;return this.sw.isEnabled?this.subscription.pipe(Oz(1),Cz(function(t){if(null===t)throw new Error("Not subscribed to push notifications.");return t.unsubscribe().then(function(t){if(!t)throw new Error("Unsubscribe failed!");e.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(Vz))}},{key:"decodeBase64",value:function(e){return atob(e)}}]),e}()).\u0275fac=function(e){return new(e||Az)(wi(Wz))},Az.\u0275prov=Ae({token:Az,factory:Az.\u0275fac}),Az),Zz=((Mz=function(){function e(t){if(y(this,e),this.sw=t,!t.isEnabled)return this.available=kz,this.activated=kz,void(this.unrecoverable=kz);this.available=this.sw.eventsOfType("UPDATE_AVAILABLE"),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}return k(e,[{key:"isEnabled",get:function(){return this.sw.isEnabled}},{key:"checkForUpdate",value:function(){if(!this.sw.isEnabled)return Promise.reject(new Error(Vz));var e=this.sw.generateNonce();return this.sw.postMessageWithStatus("CHECK_FOR_UPDATES",{statusNonce:e},e)}},{key:"activateUpdate",value:function(){if(!this.sw.isEnabled)return Promise.reject(new Error(Vz));var e=this.sw.generateNonce();return this.sw.postMessageWithStatus("ACTIVATE_UPDATE",{statusNonce:e},e)}}]),e}()).\u0275fac=function(e){return new(e||Mz)(wi(Wz))},Mz.\u0275prov=Ae({token:Mz,factory:Mz.\u0275fac}),Mz),Yz=function e(){y(this,e)},qz=new si("NGSW_REGISTER_SCRIPT");function Xz(e,i,a,s){return function(){if(Mh(s)&&"serviceWorker"in navigator&&!1!==a.enabled){var l,c;if(navigator.serviceWorker.addEventListener("controllerchange",function(){null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof a.registrationStrategy)l=a.registrationStrategy();else{var u=(a.registrationStrategy||"registerWhenStable:30000").split(":"),h=n(c=u)||r(c)||o(c)||t(),d=h[0],f=h.slice(1);switch(d){case"registerImmediately":l=yz(null);break;case"registerWithDelay":l=Kz(+f[0]||0);break;case"registerWhenStable":l=f[0]?ce($z(e),Kz(+f[0])):$z(e);break;default:throw new Error("Unknown ServiceWorker registration strategy: ".concat(a.registrationStrategy))}}e.get($c).runOutsideAngular(function(){return l.pipe(Oz(1)).subscribe(function(){return navigator.serviceWorker.register(i,{scope:a.scope}).catch(function(e){return console.error("Service worker registration failed with:",e)})})})}}}function Kz(e){return yz(null).pipe(function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lz,i=(t=e)instanceof Date&&!isNaN(+t)?+e-n.now():Math.abs(e);return function(e){return e.lift(new jz(i,n))}}(e))}function $z(e){return e.get(mu).isStable.pipe(_z(function(e){return e}))}function Qz(e,t){return new Wz(Mh(t)&&!1!==e.enabled?navigator.serviceWorker:void 0)}var Jz,eL,tL=((eL=function(){function e(){y(this,e)}return k(e,null,[{key:"register",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return{ngModule:e,providers:[{provide:qz,useValue:t},{provide:Yz,useValue:n},{provide:Wz,useFactory:Qz,deps:[Yz,Nc]},{provide:Mc,useFactory:Xz,deps:[_o,qz,Yz,Nc],multi:!0}]}}}]),e}()).\u0275fac=function(e){return new(e||eL)},eL.\u0275mod=pt({type:eL}),eL.\u0275inj=Pe({providers:[Gz,Zz]}),eL),nL=((Jz=function e(){y(this,e)}).\u0275fac=function(e){return new(e||Jz)},Jz.\u0275mod=pt({type:Jz,bootstrap:[uz]}),Jz.\u0275inj=Pe({providers:[QT,Yx,xw,Zk,tI,Wk,DC,hI,XP],imports:[[gd,Fm,Ih,ap,nw,tL.register("ngsw-worker.js",{enabled:!0})]]}),Jz);ut(sC,[Sf,Kd,wf,uh,Pf,Ed,Xd,Ef,dh,Nm,eI,jf,$f],[]),ut(sC,[Sf,Kd,wf,uh,Pf,Ed,Xd,Ef,dh,Nm,eI,jf,$f],[]),function(){if(cu)throw new Error("Cannot enable prod mode after platform setup.");lu=!1}(),fd().bootstrapModule(nL).catch(function(e){return console.error(e)})},zn8P:function(e,t){function n(e){return Promise.resolve().then(function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t})}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id="zn8P"},zqaK:function(e,t,n){var i=n("aKC4"),r=n("McxJ");t.version=n("7ice").version,t.compress=function(e,t){return new i(t).compress(e)},t.decompress=function(e,t){return new r(t).decompress(e)}}},[[0,0]]])}();