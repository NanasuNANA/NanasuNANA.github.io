(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[928],{90928:function(t,e,r){r(93683),Opal.modules["racc/parser"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function c(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function a(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}var i,o,u,s,_,d=[],l=t.nil,f=t.$$$,p=t.$$,y=t.module,h=t.klass,m=t.truthy,v=t.gvars,g=t.send;return s=d,i=(_=[y(d[0],"Racc")].concat(s))[0],o=p(_,"StandardError"),u=_,[h(i,o,"ParseError")].concat(u),m(f("::","ParseError","skip_raise")?"constant":l)||t.const_set(d[0],"ParseError",f(p(d,"Racc"),"ParseError")),function(i,o){var u,s,_,d,b,R,E,x,k,D,A,w,N,T,C,L,S,B,O,z,I,U,P,V,M,F,H,K=[y(i,"Racc")].concat(o);m(p(K,"Racc_No_Extensions","skip_raise")?"constant":l)||t.const_set(K[0],"Racc_No_Extensions",!1),u=K,F=h(K[0],null,"Parser"),H=[F].concat(u),F.$$prototype.yydebug=F.$$prototype.racc_debug_out=F.$$prototype.racc_error_status=F.$$prototype.racc_t=F.$$prototype.racc_vstack=F.$$prototype.racc_val=F.$$prototype.racc_state=F.$$prototype.racc_tstack=l,t.const_set(H[0],"Racc_Runtime_Version","1.4.6"),t.const_set(H[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),t.const_set(H[0],"Racc_Runtime_Core_Version_R","1.4.6"),t.const_set(H[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),t.const_set(H[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),t.const_set(H[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),t.const_set(H[0],"Racc_Runtime_Core_Version",p(H,"Racc_Runtime_Core_Version_R")),t.const_set(H[0],"Racc_Runtime_Core_Revision",p(H,"Racc_Runtime_Core_Revision_R")),t.const_set(H[0],"Racc_Runtime_Type","ruby"),t.defs(p(H,"Parser"),"$racc_runtime_type",s=function(){return p(H,"Racc_Runtime_Type")},s.$$arity=0),t.def(F,"$_racc_setup",_=function(){var n,$,c=this,a=l,i=l,o=l;return null==v.stderr&&(v.stderr=l),m(f(c.$class(),"Racc_debug_parser"))||(c.yydebug=!1),m(null!=(n=c.yydebug)&&n!==l?"instance-variable":l)||(c.yydebug=!1),m(c.yydebug)&&(m(null!=($=c.racc_debug_out)&&$!==l?"instance-variable":l)||(c.racc_debug_out=v.stderr),c.racc_debug_out=m(a=c.racc_debug_out)?a:v.stderr),i=f(c.$class(),"Racc_arg"),m(e(i.$size(),14))&&(g(i,"[]=",t.to_a(o=[13,!0])),r(o.length,1)),i},_.$$arity=0),t.def(F,"$_racc_init_sysvars",d=function(){var t=this;return t.racc_state=[0],t.racc_tstack=[],t.racc_vstack=[],t.racc_t=l,t.racc_val=l,t.racc_read_next=!0,t.racc_user_yyerror=!1,t.racc_error_status=0},d.$$arity=0),t.def(F,"$do_parse",b=function(){return this.$__send__(p(H,"Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},b.$$arity=0),t.def(F,"$next_token",R=function(){return this.$raise(p(H,"NotImplementedError"),this.$class()+"#next_token is not defined")},R.$$arity=0),t.def(F,"$_racc_do_parse_rb",E=function(e,r){var c,a,i=this,o=l,u=l,s=l,_=l,d=l,f=l,p=l,y=l;return c=t.to_ary(e),o=null==c[0]?l:c[0],u=null==c[1]?l:c[1],s=null==c[2]?l:c[2],_=null==c[3]?l:c[3],d=null==c[10]?l:c[10],i.$_racc_init_sysvars(),f=p=y=l,g(i,"catch",["racc_end_parse"],((a=function(){var r,c,i=null==a.$$s?this:a.$$s,h=l,v=l,g=l;for(null==i.racc_state&&(i.racc_state=l),null==i.racc_read_next&&(i.racc_read_next=l),null==i.racc_t&&(i.racc_t=l),null==i.yydebug&&(i.yydebug=l),null==i.racc_val&&(i.racc_val=l);m(!0);)for(m(y=_["$[]"](i.racc_state["$[]"](-1)))?(m(i.racc_read_next)&&m(i.racc_t["$!="](0))&&(c=i.$next_token(),r=t.to_ary(c),f=null==r[0]?l:r[0],i.racc_val=null==r[1]?l:r[1],i.racc_t=m(f)?m(h=d["$[]"](f))?h:1:0,m(i.yydebug)&&i.$racc_read_token(i.racc_t,f,i.racc_val),i.racc_read_next=!1),y=n(y,i.racc_t),m(m(v=m(g=$(y,0))?p=o["$[]"](y):g)?u["$[]"](y)["$=="](i.racc_state["$[]"](-1)):v)||(p=s["$[]"](i.racc_state["$[]"](-1)))):p=s["$[]"](i.racc_state["$[]"](-1));m(p=i.$_racc_evalact(p,e)););}).$$s=i,a.$$arity=0,a))},E.$$arity=2),t.def(F,"$yyparse",x=function(t,e){return this.$__send__(p(H,"Racc_YY_Parse_Method"),t,e,this.$_racc_setup(),!0)},x.$$arity=2),t.def(F,"$_racc_yyparse_rb",k=function(e,r,c,a){var i,o,u=l,s=l,_=l,d=l,f=l,p=l,y=l;return i=t.to_ary(c),u=null==i[0]?l:i[0],s=null==i[1]?l:i[1],_=null==i[2]?l:i[2],d=null==i[3]?l:i[3],f=null==i[10]?l:i[10],this.$_racc_init_sysvars(),p=l,y=l,g(this,"catch",["racc_end_parse"],((o=function(){var t,a=null==o.$$s?this:o.$$s;for(null==a.racc_state&&(a.racc_state=l);!m(y=d["$[]"](a.racc_state["$[]"](-1)));)for(;m(p=a.$_racc_evalact(_["$[]"](a.racc_state["$[]"](-1)),c)););return g(e,"__send__",[r],((t=function(e,r){var a,i,o=null==t.$$s?this:t.$$s,h=l,v=l,g=l,b=l,R=l,E=l,x=l;for(null==o.racc_t&&(o.racc_t=l),null==o.racc_state&&(o.racc_state=l),null==o.racc_read_next&&(o.racc_read_next=l),null==e&&(e=l),null==r&&(r=l),o.racc_t=m(e)?m(h=f["$[]"](e))?h:1:0,o.racc_val=r,o.racc_read_next=!1,y=n(y,o.racc_t),m(m(a=m(i=$(y,0))?p=u["$[]"](y):i)?s["$[]"](y)["$=="](o.racc_state["$[]"](-1)):a)||(p=_["$[]"](o.racc_state["$[]"](-1)));m(p=o.$_racc_evalact(p,c)););for(;m(m(v=m(g=(y=d["$[]"](o.racc_state["$[]"](-1)))["$!"]())?g:o.racc_read_next["$!"]())?v:o.racc_t["$=="](0));)for(m(m(b=m(R=m(E=m(x=y)?y=n(y,o.racc_t):x)?$(y,0):E)?p=u["$[]"](y):R)?s["$[]"](y)["$=="](o.racc_state["$[]"](-1)):b)||(p=_["$[]"](o.racc_state["$[]"](-1)));m(p=o.$_racc_evalact(p,c)););}).$$s=a,t.$$arity=2,t))}).$$s=this,o.$$arity=0,o))},k.$$arity=4),t.def(F,"$_racc_evalact",D=function(i,o){var u,s,_,d,f=this,p=l,y=l,h=l,v=l,b=l,R=l,E=l,x=l,k=l,D=l;if(p=null==(u=t.to_ary(o))[0]?l:u[0],y=null==u[1]?l:u[1],h=null==u[3]?l:u[3],_=null==u[11]?l:u[11],v=null==u[12]?l:u[12],m(m(d=c(i,0))?e(i,_):d))m(c(f.racc_error_status,0))&&(f.racc_t["$=="](1)||(f.racc_error_status=r(f.racc_error_status,1))),f.racc_vstack.$push(f.racc_val),f.racc_state.$push(i),f.racc_read_next=!0,m(f.yydebug)&&(f.racc_tstack.$push(f.racc_t),f.$racc_shift(f.racc_t,f.racc_tstack,f.racc_vstack));else if(m(m(b=e(i,0))?c(i,v["$-@"]()):b)){if(R=g(f,"catch",["racc_jump"],((s=function(){var t=null==s.$$s?this:s.$$s;return null==t.racc_state&&(t.racc_state=l),t.racc_state.$push(t.$_racc_do_reduce(o,i)),!1}).$$s=f,s.$$arity=0,s)),m(R)){if(1["$==="](E=R))return f.racc_user_yyerror=!0,v["$-@"]();if(2["$==="](E))return _;f.$raise("[Racc Bug] unknown jump code")}}else if(i["$=="](_))m(f.yydebug)&&f.$racc_accept(),f.$throw("racc_end_parse",f.racc_vstack["$[]"](0));else{if(i["$=="](v["$-@"]())){for((0)["$==="](E=f.racc_error_status)?m(o["$[]"](21))||f.$on_error(f.racc_t,f.racc_val,f.racc_vstack):3["$==="](E)&&(f.racc_t["$=="](0)&&f.$throw("racc_end_parse",l),f.racc_read_next=!0),f.racc_user_yyerror=!1,f.racc_error_status=3;m(!0)&&(!m(x=h["$[]"](f.racc_state["$[]"](-1)))||(x=n(x,1),!m(m(k=m(D=$(x,0))?i=p["$[]"](x):D)?y["$[]"](x)["$=="](f.racc_state["$[]"](-1)):k)));)m(a(f.racc_state.$size(),1))&&f.$throw("racc_end_parse",l),f.racc_state.$pop(),f.racc_vstack.$pop(),m(f.yydebug)&&(f.racc_tstack.$pop(),f.$racc_e_pop(f.racc_state,f.racc_tstack,f.racc_vstack));return i}f.$raise("[Racc Bug] unknown action "+i.$inspect())}return m(f.yydebug)&&f.$racc_next_state(f.racc_state["$[]"](-1),f.racc_state),l},D.$$arity=2),t.def(F,"$_racc_do_reduce",A=function(e,c){var a,i,o,u,s,_,d,f=this,p=l,y=l,h=l,v=l,b=l,R=l,E=l,x=l,k=l,D=l,A=l,w=l,N=l,T=l,C=l,L=l;return p=null==(a=t.to_ary(e))[4]?l:a[4],y=null==a[5]?l:a[5],h=null==a[6]?l:a[6],v=null==a[7]?l:a[7],i=null==a[8]?l:a[8],b=null==a[9]?l:a[9],o=null==a[13]?l:a[13],R=f.racc_state,E=f.racc_vstack,x=f.racc_tstack,k=function(t,e){return"number"==typeof t?-3*t:t["$*"](-3)}(c),D=b["$[]"](k),u=b["$[]"](n(k,1)),s=b["$[]"](n(k,2)),_=[],m(f.yydebug)&&(A=x["$[]"](D["$-@"](),D)),w=E["$[]"](D["$-@"](),D),m(f.yydebug)&&(N=[D["$-@"](),D,_],g(x,"[]=",t.to_a(N)),r(N.length,1)),N=[D["$-@"](),D,_],g(E,"[]=",t.to_a(N)),r(N.length,1),N=[D["$-@"](),D,_],g(R,"[]=",t.to_a(N)),r(N.length,1),m(o)?E.$push(f.$__send__(s,w,E,w["$[]"](0))):E.$push(f.$__send__(s,w,E)),x.$push(u),m(f.yydebug)&&f.$racc_reduce(A,u,x,E),d=r(u,i),m(k=v["$[]"](d))&&(k=n(k,R["$[]"](-1)),m(m(T=m(C=$(k,0))?L=p["$[]"](k):C)?y["$[]"](k)["$=="](d):T))?L:h["$[]"](d)},A.$$arity=2),t.def(F,"$on_error",w=function(t,e,r){var n,$=this;return $.$raise(p(H,"ParseError"),$.$sprintf("\nparse error on value %s (%s)",e.$inspect(),m(n=$.$token_to_str(t))?n:"?"))},w.$$arity=3),t.def(F,"$yyerror",N=function(){return this.$throw("racc_jump",1)},N.$$arity=0),t.def(F,"$yyaccept",T=function(){return this.$throw("racc_jump",2)},T.$$arity=0),t.def(F,"$yyerrok",C=function(){return this.racc_error_status=0},C.$$arity=0),t.def(F,"$racc_read_token",L=function(t,e,r){var n=this;return n.racc_debug_out.$print("read    "),n.racc_debug_out.$print(e.$inspect(),"(",n.$racc_token2str(t),") "),n.racc_debug_out.$puts(r.$inspect()),n.racc_debug_out.$puts()},L.$$arity=3),t.def(F,"$racc_shift",S=function(t,e,r){var n=this;return n.racc_debug_out.$puts("shift   "+n.$racc_token2str(t)),n.$racc_print_stacks(e,r),n.racc_debug_out.$puts()},S.$$arity=3),t.def(F,"$racc_reduce",B=function(t,e,r,n){var $,c=this,a=l;return(a=c.racc_debug_out).$print("reduce "),m(t["$empty?"]())?a.$print(" <none>"):g(t,"each",[],(($=function(t){return null==t&&(t=l),a.$print(" ",(null==$.$$s?this:$.$$s).$racc_token2str(t))}).$$s=c,$.$$arity=1,$)),a.$puts(" --\x3e "+c.$racc_token2str(e)),c.$racc_print_stacks(r,n),c.racc_debug_out.$puts()},B.$$arity=4),t.def(F,"$racc_accept",O=function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},O.$$arity=0),t.def(F,"$racc_e_pop",z=function(t,e,r){var n=this;return n.racc_debug_out.$puts("error recovering mode: pop token"),n.$racc_print_states(t),n.$racc_print_stacks(e,r),n.racc_debug_out.$puts()},z.$$arity=3),t.def(F,"$racc_next_state",I=function(t,e){var r=this;return r.racc_debug_out.$puts("goto    "+t),r.$racc_print_states(e),r.racc_debug_out.$puts()},I.$$arity=2),t.def(F,"$racc_print_stacks",U=function(t,e){var r,n=l;return(n=this.racc_debug_out).$print("        ["),g(t,"each_index",[],((r=function($){return null==$&&($=l),n.$print(" (",(null==r.$$s?this:r.$$s).$racc_token2str(t["$[]"]($))," ",e["$[]"]($).$inspect(),")")}).$$s=this,r.$$arity=1,r)),n.$puts(" ]")},U.$$arity=2),t.def(F,"$racc_print_states",P=function(t){var e,r=l;return(r=this.racc_debug_out).$print("        ["),g(t,"each",[],((e=function(t){return null==t&&(t=l),r.$print(" ",t)}).$$s=this,e.$$arity=1,e)),r.$puts(" ]")},P.$$arity=1),t.def(F,"$racc_token2str",V=function(t){var e;return m(e=f(this.$class(),"Racc_token_to_s_table")["$[]"](t))?e:this.$raise("[Racc Bug] can't convert token "+t+" to string")},V.$$arity=1),t.def(F,"$token_to_str",M=function(t){return f(this.$class(),"Racc_token_to_s_table")["$[]"](t)},M.$$arity=1)}(d[0],d)},Opal.modules.strscan=function(t){var e,r,n,$,c,a,i,o,u,s,_,d,l,f,p,y,h,m,v,g,b,R,E,x,k,D,A,w,N=[],T=t.nil,C=t.$$,L=t.truthy,S=t.send;return e=N,A=(0,t.klass)(N[0],null,"StringScanner"),w=[A].concat(e),A.$$prototype.pos=A.$$prototype.string=A.$$prototype.working=A.$$prototype.matched=A.$$prototype.prev_pos=A.$$prototype.match=T,A.$attr_reader("pos"),A.$attr_reader("matched"),t.def(A,"$initialize",r=function(t){var e=this;return e.string=t,e.pos=0,e.matched=T,e.working=t,e.match=[]},r.$$arity=1),A.$attr_reader("string"),t.def(A,"$beginning_of_line?",n=function(){var t=this;return 0===t.pos||"\n"===t.string.charAt(t.pos-1)},n.$$arity=0),t.alias(A,"bol?","beginning_of_line?"),t.def(A,"$scan",$=function(t){var e=this,r=(t=e.$anchor(t)).exec(e.working);return null==r?e.matched=T:"object"==typeof r?(e.prev_pos=e.pos,e.pos+=r[0].length,e.working=e.working.substring(r[0].length),e.matched=r[0],e.match=r,r[0]):"string"==typeof r?(e.pos+=r.length,e.working=e.working.substring(r.length),r):T},$.$$arity=1),t.def(A,"$scan_until",c=function(t){var e=this;t=e.$anchor(t);for(var r,n=e.pos,$=e.working;;){if(r=t.exec($),n+=1,$=$.substr(1),null!=r)return e.matched=e.string.substr(e.pos,n-e.pos-1+r[0].length),e.match=r,e.prev_pos=n-1,e.pos=n,e.working=$.substr(r[0].length),e.matched;if(0===$.length)return e.match=[],e.matched=T}},c.$$arity=1),t.def(A,"$[]",a=function(t){var e;if(L(this.match["$empty?"]()))return T;e=t,C(w,"Symbol")["$==="](e)?t=t.$to_s():C(w,"String")["$==="](e)||(t=C(w,"Opal")["$coerce_to!"](t,C(w,"Integer"),"to_int"));var r=this.match;return t<0&&(t+=r.length),t<0||t>=r.length||null==r[t]?T:r[t]},a.$$arity=1),t.def(A,"$check",i=function(t){var e=this,r=(t=e.$anchor(t)).exec(e.working);return e.matched=null==r?T:r[0]},i.$$arity=1),t.def(A,"$check_until",o=function(t){var e=this,r=e.prev_pos,n=e.pos,$=e.$scan_until(t);return $!==T&&(e.matched=$.substr(-1),e.working=e.string.substr(n)),e.prev_pos=r,e.pos=n,$},o.$$arity=1),t.def(A,"$peek",u=function(t){return this.working.substring(0,t)},u.$$arity=1),t.def(A,"$eos?",s=function(){return 0===this.working.length},s.$$arity=0),t.def(A,"$exist?",_=function(t){var e=t.exec(this.working);return null==e?T:0==e.index?0:e.index+1},_.$$arity=1),t.def(A,"$skip",d=function(t){var e=this,r=(t=e.$anchor(t)).exec(e.working);if(null==r)return e.match=[],e.matched=T;var n=r[0],$=n.length;return e.matched=n,e.match=r,e.prev_pos=e.pos,e.pos+=$,e.working=e.working.substring($),$},d.$$arity=1),t.def(A,"$skip_until",l=function(t){var e=this.$scan_until(t);return e===T?T:(this.matched=e.substr(-1),e.length)},l.$$arity=1),t.def(A,"$get_byte",f=function(){var t=this,e=T;return t.pos<t.string.length?(t.prev_pos=t.pos,t.pos+=1,e=t.matched=t.working.substring(0,1),t.working=t.working.substring(1)):t.matched=T,e},f.$$arity=0),t.alias(A,"getch","get_byte"),t.def(A,"$match?",p=function(t){var e=this,r=(t=e.$anchor(t)).exec(e.working);return null==r?T:(e.prev_pos=e.pos,r[0].length)},p.$$arity=1),t.def(A,"$pos=",y=function(t){var e=this;return t<0&&(t+=e.string.$length()),e.pos=t,e.working=e.string.slice(t)},y.$$arity=1),t.def(A,"$matched_size",h=function(){return this.matched===T?T:this.matched.length},h.$$arity=0),t.def(A,"$post_match",m=function(){var t=this;return t.matched===T?T:t.string.substr(t.pos)},m.$$arity=0),t.def(A,"$pre_match",v=function(){var t=this;return t.matched===T?T:t.string.substr(0,t.prev_pos)},v.$$arity=0),t.def(A,"$reset",g=function(){var t=this;return t.working=t.string,t.matched=T,t.pos=0},g.$$arity=0),t.def(A,"$rest",b=function(){return this.working},b.$$arity=0),t.def(A,"$rest?",R=function(){return 0!==this.working.length},R.$$arity=0),t.def(A,"$rest_size",E=function(){return this.$rest().$size()},E.$$arity=0),t.def(A,"$terminate",x=function(){var e,r,n=this;return n.match=T,e=[n.string.$length()],S(n,"pos=",t.to_a(e)),e[(r=e.length,"number"==typeof r?r-1:r["$-"](1))]},x.$$arity=0),t.def(A,"$unscan",k=function(){var t=this;return t.pos=t.prev_pos,t.prev_pos=T,t.match=T,t},k.$$arity=0),A.$private(),t.def(A,"$anchor",D=function(t){var e=t.toString().match(/\/([^\/]+)$/);return e=e?e[1]:void 0,new RegExp("^(?:"+t.source+")",e)},D.$$arity=1),T&&"anchor"},Opal.modules["bcdice/normalize"]=function(t){var e,r,n,$,c,a,i=[],o=t.nil,u=t.module;return c=i,e=a=[u(i[0],"BCDice")].concat(c),[$=u(a[0],"Normalize")].concat(e),$.$module_function(),t.def($,"$comparison_operator",r=function(t){var e;return/<=|=</["$==="](e=t)?"<=":/>=|=>/["$==="](e)?">=":/<>|!=|=!/["$==="](e)?"!=":/</["$==="](e)?"<":/>/["$==="](e)?">":/=/["$==="](e)?"==":o},r.$$arity=1),void t.def($,"$target_number",n=function(t){return t["$=="]("?")?t:t.$to_i()},n.$$arity=1)},Opal.modules["bcdice/common_command/lexer"]=function(t){var e,r,n,$,c,a,i,o,u,s,_=t.top,d=[],l=t.nil,f=t.$$,p=t.module,y=t.klass,h=t.hash2,m=t.truthy;return _.$require("strscan"),_.$require("bcdice/normalize"),e=d,r=s=[p(d[0],"BCDice")].concat(e),n=u=[p(s[0],"CommonCommand")].concat(r),i=y(u[0],null,"Lexer"),o=[i].concat(n),i.$$prototype.scanner=l,t.const_set(o[0],"SYMBOLS",h(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),t.def(i,"$initialize",$=function(t){var e;return t=m(e=t.$split(" ",2).$first())?e:"",this.scanner=f(o,"StringScanner").$new(t)},$.$$arity=1),t.def(i,"$next_token",c=function(){var t=this,e=l,r=l,n=l,$=l;return m(t.scanner["$eos?"]())?[!1,"$"]:m(e=t.scanner.$scan(/\d+/))?["NUMBER",e.$to_i()]:m(r=t.scanner.$scan(/[<>!=]+/))?["CMP_OP",f(o,"Normalize").$comparison_operator(r)]:(n=t.scanner.$getch().$upcase(),[m($=f(o,"SYMBOLS")["$[]"](n))?$:n.$to_sym(),n])},c.$$arity=0),void t.def(i,"$source",a=function(){return this.scanner.$string()},a.$$arity=0)},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t<e:t["$<"](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}function n(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}function $(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}var c,a,i,o,u,s,_,d,l,f,p,y,h,m,v,g,b=[],R=t.nil,E=t.$$,x=t.module,k=t.klass,D=t.hash2,A=t.truthy,w=t.send;return c=b,a=g=[x(b[0],"BCDice")].concat(c),i=v=[x(g[0],"CommonCommand")].concat(a),o=m=[x(v[0],"RerollDice")].concat(i),u=h=[x(m[0],"Node")].concat(o),p=k(h[0],null,"Command"),y=[p].concat(u),p.$$prototype.cmp_op=p.$$prototype.reroll_cmp_op=p.$$prototype.target_number_node=p.$$prototype.reroll_threshold_node=p.$$prototype.notations=p.$$prototype.source=R,t.def(p,"$initialize",s=function(e){var r,n,$,c,a,i,o,u=this;if(null==e)e=D([],{});else if(!e.$$is_hash)throw t.ArgumentError.$new("expected kwargs");if(!t.hasOwnProperty.call(e.$$smap,"secret"))throw t.ArgumentError.$new("missing keyword: secret");if(r=e.$$smap.secret,!t.hasOwnProperty.call(e.$$smap,"notations"))throw t.ArgumentError.$new("missing keyword: notations");if(n=e.$$smap.notations,!t.hasOwnProperty.call(e.$$smap,"source"))throw t.ArgumentError.$new("missing keyword: source");return $=e.$$smap.source,null==(c=e.$$smap.cmp_op)&&(c=R),null==(a=e.$$smap.target_number)&&(a=R),null==(i=e.$$smap.reroll_cmp_op)&&(i=R),null==(o=e.$$smap.reroll_threshold)&&(o=R),u.secret=r,u.notations=n,u.cmp_op=c,u.target_number_node=a,u.reroll_cmp_op=i,u.reroll_threshold_node=o,u.source=$},s.$$arity=1),t.def(p,"$eval",_=function(t,e){var r,n,$,c,a,i,o,u,s,_,d,l,f,p,h,m,v,g,b=this,x=R,k=R,D=R,N=R,T=R,C=R;return o=t.$round_type(),u=A(f=b.cmp_op)?f:t.$default_cmp_op(),s=A(p=A(h=b.reroll_cmp_op)?h:u)?p:">=",_=A(m=(r=b.target_number_node)===R||null==r?R:w(r,"eval",[o]))?m:t.$default_target_number(),d=A(v=A(g=(n=b.reroll_threshold_node)===R||null==n?R:w(n,"eval",[o]))?g:t.$reroll_dice_reroll_threshold())?v:_,x=E(y,"RerollCondition").$new(s,d),l=w(b.notations,"map",[],(($=function(t){return null==t&&(t=R),t.$to_dice(o)}).$$s=b,$.$$arity=1,$)),A(w(l,"all?",[],((c=function(t){return null==t&&(t=R),x["$valid?"](t.$sides())}).$$s=b,c.$$arity=1,c)))?(D=(k=b.$roll(l,e,x,t["$sort_barabara_dice?"]())).$flatten(),N=k.$take(b.notations.$size()).$flatten().$count(1),T=A(u)?w(D,"count",[],((a=function(t){return null==t&&(t=R),t.$send(u,_)}).$$s=b,a.$$arity=1,a)):0,C=[b.$expr(o,x,u,_),w(k,"map",[],(i=function(t){return null==t&&(t=R),t.$join(",")},i.$$s=b,i.$$arity=1,i)).$join(" + "),"\u6210\u529f\u6570"+T,t.$grich_text(N,D.$size(),T)].$compact(),b.$result_with_text(C.$join(" \uff1e "))):b.$result_with_text(b.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")},_.$$arity=2),p.$private(),t.def(p,"$roll",d=function(t,$,c,a){var i,o=R,u=R,s=R,_=R,d=R,l=R;for(o=[],u=0;A(A(s=t["$empty?"]()["$!"]())?e(u,E(y,"REROLL_LIMIT")):s);)_=t.$shift(),u=r(u,1),d=_.$roll($),A(a)&&d["$sort!"](),o.$push(d),l=w(d,"count",[],((i=function(t){return null==t&&(t=R),c["$reroll?"](t)}).$$s=this,i.$$arity=1,i)),A(n(l,0))&&t.$push(E(y,"Dice").$new(l,_.$sides()));return o},d.$$arity=4),t.def(p,"$expr",l=function(t,e,r,n){var $,c,a,i;return c=w(this.notations,"map",[],($=function(e){return null==e&&(e=R),e.$to_dice(t)},$.$$s=this,$.$$arity=1,$)).$join("+"),a=e.$cmp_op()["$=="](r)?"":E(y,"Format").$comparison_operator(e.$cmp_op()),i=E(y,"Format").$comparison_operator(r),"("+c+"["+a+e.$threshold()+"]"+i+n+")"},l.$$arity=4),t.def(p,"$result_with_text",f=function(e){var r;return w(E(y,"Result").$new(),"tap",[],((r=function(n){var c=null==r.$$s?this:r.$$s,a=R;return null==c.secret&&(c.secret=R),null==n&&(n=R),w(n,"secret=",t.to_a(a=[c.secret])),$(a.length,1),w(n,"text=",t.to_a(a=[e])),a[$(a.length,1)]}).$$s=this,r.$$arity=1,r))},f.$$arity=1),function(r,$,c){var a,i,o,u=k(r,null,"RerollCondition");[u].concat(c),u.$$prototype.threshold=u.$$prototype.cmp_op=R,u.$attr_reader("cmp_op"),u.$attr_reader("threshold"),t.def(u,"$initialize",a=function(t,e){return this.cmp_op=t,this.threshold=e},a.$$arity=2),t.def(u,"$valid?",i=function(r){var $,c=this,a=R;return!!A(c.threshold)&&("<="["$==="](a=c.cmp_op)?e(c.threshold,r):"<"["$==="](a)?function(t,e){return"number"==typeof t&&"number"==typeof e?t<=e:t["$<="](e)}(c.threshold,r):">="["$==="](a)?n(c.threshold,1):">"["$==="](a)?"number"==typeof($=c.threshold)?$>=1:$["$>="](1):!"!="["$==="](a)||t.Range.$new(1,r,!1)["$include?"](c.threshold))},i.$$arity=1),t.def(u,"$reroll?",o=function(t){return t.$send(this.cmp_op,this.threshold)},o.$$arity=1)}(h[0],0,h),function(e,r,n){var $,c,a=k(e,null,"Notation"),i=[a].concat(n);a.$$prototype.times=a.$$prototype.sides=R,t.def(a,"$initialize",$=function(t,e){return this.times=t,this.sides=e},$.$$arity=2),t.def(a,"$to_dice",c=function(t){var e,r;return e=this.times.$eval(t),r=this.sides.$eval(t),E(i,"Dice").$new(e,r)},c.$$arity=1)}(h[0],0,h),void function(e,r,n){var $,c,a,i=k(e,null,"Dice");[i].concat(n),i.$attr_reader("times","sides"),t.def(i,"$initialize",$=function(t,e){return this.times=t,this.sides=e},$.$$arity=2),t.def(i,"$roll",c=function(t){return t.$roll_barabara(this.$times(),this.$sides())},c.$$arity=1),t.def(i,"$to_s",a=function(){return this.$times()+"R"+this.$sides()},a.$$arity=0)}(h[0],0,h)},Opal.modules["bcdice/arithmetic/node"]=function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t/e:t["$/"](e)}var r,n,$,c,a,i,o,u,s,_,d,l,f,p,y,h,m,v=[],g=t.nil,b=t.$$$,R=t.$$,E=t.module,x=t.klass,k=t.send2;return r=v,n=m=[E(v[0],"BCDice")].concat(r),$=h=[E(m[0],"Arithmetic")].concat(n),function(e,r,n){var $,c,a,i,o,u=x(e,null,"BinaryOp");[u].concat(n),u.$$prototype.lhs=u.$$prototype.rhs=u.$$prototype.op=g,t.def(u,"$initialize",$=function(t,e,r){var n=this;return n.lhs=t,n.op=e,n.rhs=r},$.$$arity=3),t.def(u,"$eval",c=function(t){var e,r=this,n=g;return n=r.lhs.$eval(t),e=r.rhs.$eval(t),n.$send(r.op,e)},c.$$arity=1),t.def(u,"$output",a=function(){var t=this;return""+t.lhs.$output()+t.op+t.rhs.$output()},a.$$arity=0),t.def(u,"$s_exp",i=function(){var t=this;return"("+t.$op_for_s_exp()+" "+t.lhs.$s_exp()+" "+t.rhs.$s_exp()+")"},i.$$arity=0),t.def(u,"$op_for_s_exp",o=function(){return this.op},o.$$arity=0)}((y=[E(h[0],"Node")].concat($))[0],0,y),c=y[0],a=R(y,"BinaryOp"),i=y,f=x(c,a,"DivideBase"),p=[f].concat(i),f.$$prototype.lhs=f.$$prototype.rhs=f.$$prototype.op=g,t.def(f,"$initialize",o=function(e,r){return o.$$p&&(o.$$p=null),k(this,t.find_super_dispatcher(this,"initialize",o,!1,!0),"initialize",[e,"/",r],null)},o.$$arity=2),t.def(f,"$eval",u=function(t){var e,r=this,n=g;return e=r.lhs.$eval(t),(n=r.rhs.$eval(t))["$=="](0)&&r.$raise(R(p,"ZeroDivisionError")),r.$divide_and_round(e,n,t)},u.$$arity=1),t.def(f,"$output",s=function(){var e=s.$$p,r=this,n=g,$=g,c=g;for(e&&(s.$$p=null),$=0,c=arguments.length,n=new Array(c);$<c;$++)n[$]=arguments[$];return""+k(r,t.find_super_dispatcher(r,"output",s,!1,!0),"output",n,e)+r.$rounding_method()},s.$$arity=0),f.$private(),t.def(f,"$rounding_method",_=function(){return b(this.$class(),"ROUNDING_METHOD")},_.$$arity=0),t.def(f,"$op_for_s_exp",d=function(){return""+this.op+this.$rounding_method()},d.$$arity=0),t.def(f,"$divide_and_round",l=function(t,e,r){return this.$raise(R(p,"NotImplementedError"))},l.$$arity=3),function(r,n,$){var c,a=x(r,n,"DivideWithGameSystemDefault"),i=[a].concat($);t.const_set(i[0],"ROUNDING_METHOD",""),a.$private(),t.def(a,"$divide_and_round",c=function(t,r,n){var $;return $=n,b(R(i,"RoundType"),"CEIL")["$==="]($)?e(t.$to_f(),r).$ceil():b(R(i,"RoundType"),"ROUND")["$==="]($)?e(t.$to_f(),r).$round():e(t,r).$to_i()},c.$$arity=3)}(y[0],R(y,"DivideBase"),y),function(r,n,$){var c,a=x(r,n,"DivideWithCeil"),i=[a].concat($);t.const_set(i[0],"ROUNDING_METHOD","C"),a.$private(),t.def(a,"$divide_and_round",c=function(t,r,n){return e(t.$to_f(),r).$ceil()},c.$$arity=3)}(y[0],R(y,"DivideBase"),y),function(r,n,$){var c,a=x(r,n,"DivideWithRound"),i=[a].concat($);t.const_set(i[0],"ROUNDING_METHOD","R"),a.$private(),t.def(a,"$divide_and_round",c=function(t,r,n){return e(t.$to_f(),r).$round()},c.$$arity=3)}(y[0],R(y,"DivideBase"),y),function(r,n,$){var c,a=x(r,n,"DivideWithFloor"),i=[a].concat($);t.const_set(i[0],"ROUNDING_METHOD","F"),a.$private(),t.def(a,"$divide_and_round",c=function(t,r,n){return e(t,r).$to_i()},c.$$arity=3)}(y[0],R(y,"DivideBase"),y),function(e,r,n){var $,c,a,i,o=x(e,null,"Negative");[o].concat(n),o.$$prototype.body=g,t.def(o,"$initialize",$=function(t){return this.body=t},$.$$arity=1),t.def(o,"$eval",c=function(t){return this.body.$eval(t)["$-@"]()},c.$$arity=1),t.def(o,"$output",a=function(){return"-"+this.body.$output()},a.$$arity=0),t.def(o,"$s_exp",i=function(){return"(- "+this.body.$s_exp()+")"},i.$$arity=0)}(y[0],0,y),function(e,r,n){var $,c,a,i,o=x(e,null,"Parenthesis");[o].concat(n),o.$$prototype.expr=g,t.def(o,"$initialize",$=function(t){return this.expr=t},$.$$arity=1),t.def(o,"$eval",c=function(t){return this.expr.$eval(t)},c.$$arity=1),t.def(o,"$output",a=function(){return"("+this.expr.$output()+")"},a.$$arity=0),t.def(o,"$s_exp",i=function(){return"(Parenthesis "+this.expr.$s_exp()+")"},i.$$arity=0)}(y[0],0,y),void function(e,r,n){var $,c,a,i=x(e,null,"Number");[i].concat(n),i.$$prototype.value=g,t.def(i,"$initialize",$=function(t){return this.value=t},$.$$arity=1),t.def(i,"$eval",c=function(t){return this.value},c.$$arity=1),t.def(i,"$output",a=function(){return this.value.$to_s()},a.$$arity=0),t.alias(i,"s_exp","output")}(y[0],0,y)},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(t){var e,r,n,$,c,a,i,o,u,s,_,d,l,f,p,y,h,m,v,g,b,R,E,x,k,D,A,w,N,T,C,L,S,B,O,z,I,U,P,V,M,F,H,K,Y=t.top,G=[],j=t.nil,q=t.$$$,J=t.$$,W=t.module,Q=t.klass,X=t.hash,Z=t.hash2,tt=t.truthy;return Y.$require("racc/parser.rb"),Y.$require("bcdice/common_command/lexer"),Y.$require("bcdice/common_command/reroll_dice/node"),Y.$require("bcdice/arithmetic/node"),e=G,r=K=[W(G[0],"BCDice")].concat(e),n=H=[W(K[0],"CommonCommand")].concat(r),$=F=[W(H[0],"BarabaraDice")].concat(n),V=Q(F[0],q(J(F,"Racc"),"Parser"),"Parser"),M=[V].concat($),V.$$prototype.lexer=j,t.defs(V,"$parse",c=function(t){return this.$new().$parse(t)},c.$$arity=1),t.def(V,"$parse",a=function(e){try{return this.lexer=J(M,"Lexer").$new(e),this.$do_parse()}catch(r){if(!t.rescue(r,[J(M,"ParseError")]))throw r;try{return j}finally{t.pop_exception()}}},a.$$arity=1),V.$private(),t.def(V,"$next_token",i=function(){return this.lexer.$next_token()},i.$$arity=0),T=[13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14],C=[5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7],L=[-6,21,-1,j,56,-9,j,55,1,j,j,j,6,4,5,-5,24,j,18,20,j,28,j,j,30,32,j,42,44,j,j,36,38,j,19,j,j,j,j,j],S=[-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19],B=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],O=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],z=[j,1,4,8,11,-5,0,-2,-16,-13,-17],I=[j,j,j,j,j,j,j,20,16,17,j],U=[0,0,"racc_error",3,24,"_reduce_1",0,25,"_reduce_2",1,25,"_reduce_3",0,27,"_reduce_4",2,27,"_reduce_5",3,26,"_reduce_6",1,26,"_reduce_7",3,29,"_reduce_8",3,28,"_reduce_9",3,28,"_reduce_10",1,28,"_reduce_none",3,31,"_reduce_12",4,31,"_reduce_13",1,31,"_reduce_none",0,33,"_reduce_15",1,33,"_reduce_16",1,33,"_reduce_17",1,33,"_reduce_18",1,33,"_reduce_19",2,32,"_reduce_20",2,32,"_reduce_21",1,32,"_reduce_none",3,30,"_reduce_23",1,30,"_reduce_24"],P=X(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),t.const_set(M[0],"Racc_arg",[T,C,S,L,B,O,I,z,23,U,P,40,25,!0]),t.const_set(M[0],"Racc_token_to_s_table",["$end","error","NUMBER","B","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","add","dice","term","mul","unary","round_type"]),t.const_set(M[0],"Racc_debug_parser",!1),t.def(V,"$_reduce_1",o=function(t,e,r){return q(J(M,"Node"),"Command").$new(Z(["secret","notations","cmp_op","target_number"],{secret:t["$[]"](0),notations:t["$[]"](1),cmp_op:t["$[]"](2)["$[]"]("cmp_op"),target_number:t["$[]"](2)["$[]"]("target")}))},o.$$arity=3),t.def(V,"$_reduce_2",u=function(t,e,r){return!1},u.$$arity=3),t.def(V,"$_reduce_3",s=function(t,e,r){return!0},s.$$arity=3),t.def(V,"$_reduce_4",_=function(t,e,r){return Z([],{})},_.$$arity=3),t.def(V,"$_reduce_5",d=function(e,r,n){var $,c,a;return a=null==($=t.to_ary(e))[1]?j:$[1],tt(c=null==$[0]?j:$[0])||this.$raise(J(M,"ParseError")),Z(["cmp_op","target"],{cmp_op:c,target:a})},d.$$arity=3),t.def(V,"$_reduce_6",l=function(t,e,r){var n=j;return(n=t["$[]"](0)).$push(t["$[]"](2)),n},l.$$arity=3),t.def(V,"$_reduce_7",f=function(t,e,r){return[t["$[]"](0)]},f.$$arity=3),t.def(V,"$_reduce_8",p=function(t,e,r){var n,$;return n=t["$[]"](0),$=t["$[]"](2),q(J(M,"Node"),"Notation").$new(n,$)},p.$$arity=3),t.def(V,"$_reduce_9",y=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"+",t["$[]"](2))},y.$$arity=3),t.def(V,"$_reduce_10",h=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"-",t["$[]"](2))},h.$$arity=3),t.def(V,"$_reduce_12",m=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"BinaryOp").$new(t["$[]"](0),"*",t["$[]"](2))},m.$$arity=3),t.def(V,"$_reduce_13",v=function(t,e,r){return t["$[]"](3).$new(t["$[]"](0),t["$[]"](2))},v.$$arity=3),t.def(V,"$_reduce_15",g=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"DivideWithGameSystemDefault")},g.$$arity=3),t.def(V,"$_reduce_16",b=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"DivideWithCeil")},b.$$arity=3),t.def(V,"$_reduce_17",R=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"DivideWithCeil")},R.$$arity=3),t.def(V,"$_reduce_18",E=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"DivideWithRound")},E.$$arity=3),t.def(V,"$_reduce_19",x=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"DivideWithFloor")},x.$$arity=3),t.def(V,"$_reduce_20",k=function(t,e,r){return t["$[]"](1)},k.$$arity=3),t.def(V,"$_reduce_21",D=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"Negative").$new(t["$[]"](1))},D.$$arity=3),t.def(V,"$_reduce_23",A=function(t,e,r){return t["$[]"](1)},A.$$arity=3),t.def(V,"$_reduce_24",w=function(t,e,r){return q(q(J(M,"Arithmetic"),"Node"),"Number").$new(t["$[]"](0))},w.$$arity=3),void t.def(V,"$_reduce_none",N=function(t,e,r){return t["$[]"](0)},N.$$arity=3)},Opal.modules["bcdice/common_command/barabara_dice"]=function(t){var e,r,n,$,c,a,i,o,u,s,_=[],d=t.nil,l=t.$$,f=t.module,p=t.send;return t.top.$require("bcdice/common_command/barabara_dice/parser"),e=_,r=s=[f(_[0],"BCDice")].concat(e),n=u=[f(s[0],"CommonCommand")].concat(r),o=[i=f(u[0],"BarabaraDice")].concat(n),t.const_set(o[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),$=t.get_singleton_class(i),a=[$].concat(o),void t.def($,"$eval",c=function(t,e,r){var n;return(n=l(a,"Parser").$parse(t))===d||null==n?d:p(n,"eval",[e,r])},c.$$arity=3)},Opal.modules["bcdice/dice_table/table"]=function(t){var e,r,n,$,c,a,i,o,u,s,_,d=[],l=t.nil,f=t.$$,p=t.module,y=t.klass,h=t.hash2,m=t.truthy;return e=d,r=_=[p(d[0],"BCDice")].concat(e),n=s=[p(_[0],"DiceTable")].concat(r),o=y(s[0],null,"Table"),u=[o].concat(n),o.$$prototype.times=o.$$prototype.sides=o.$$prototype.name=o.$$prototype.items=l,t.defs(o,"$from_i18n",$=function(t,e){var r=l;return r=f(u,"I18n").$t(t,h(["locale"],{locale:e})),this.$new(r["$[]"]("name"),r["$[]"]("type"),r["$[]"]("items"))},$.$$arity=2),t.def(o,"$initialize",c=function(t,e,r){var n=this,$=l;return n.name=t,n.items=r.$freeze(),$=/(\d+)D(\d+)/i.$match(e),m($)||n.$raise(f(u,"ArgumentError"),"Unexpected table type: "+e),n.times=$["$[]"](1).$to_i(),n.sides=$["$[]"](2).$to_i()},c.$$arity=3),t.def(o,"$roll",a=function(t){var e,r=this;return e=t.$roll_sum(r.times,r.sides),r.$choice(e)},a.$$arity=1),void t.def(o,"$choice",i=function(t){var e,r=this;return e=function(t,e){return"number"==typeof t&&"number"==typeof e?t-e:t["$-"](e)}(t,r.times),f(u,"RollResult").$new(r.name,t,r.items["$[]"](e))},i.$$arity=1)},function(t){function e(t,e){return"number"==typeof t&&"number"==typeof e?t>=e:t["$>="](e)}function r(t,e){return"number"==typeof t&&"number"==typeof e?t+e:t["$+"](e)}var n,$,c,a,i,o,u,s,_,d,l,f,p,y,h,m,v,g,b,R=t.top,E=[],x=t.nil,k=t.$$$,D=t.$$,A=t.module,w=t.klass,N=t.send2,T=t.hash2,C=t.truthy,L=t.send;R.$require("bcdice/common_command/barabara_dice"),R.$require("bcdice/dice_table/table"),n=E,$=b=[A(E[0],"BCDice")].concat(n),c=g=[A(b[0],"GameSystem")].concat($),m=w(g[0],D(g,"Base"),"NinjaSlayer"),v=[m].concat(c),m.$$prototype.randomizer=x,t.const_set(v[0],"ID","NinjaSlayer"),t.const_set(v[0],"NAME","\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG"),t.const_set(v[0],"SORT_KEY","\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG"),t.const_set(v[0],"HELP_MESSAGE","\u30fb\u901a\u5e38\u5224\u5b9a\u3000NJ\n\u3000NJx[y] or NJx@y or NJx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:NJ4@H \u96e3\u6613\u5ea6HARD\u3001\u5224\u5b9a\u30c0\u30a4\u30b94\u3067\u5224\u5b9a\n\u30fb\u56de\u907f\u5224\u5b9a\u3000EV\n\u3000EVx[y]/z or EVx@y/z or EVx/z or EVx[y] or EVx@y or EVx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 z=\u653b\u6483\u5074\u306e\u6210\u529f\u6570(\u7701\u7565\u53ef) \u96e3\u6613\u5ea6\u3092\u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u653b\u6483\u5074\u306e\u6210\u529f\u6570\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u3001\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:EV5/3 \u96e3\u6613\u5ea6NORMAL(\u7701\u7565\u6642)\u3001\u5224\u5b9a\u30c0\u30a4\u30b95\u3001\u653b\u6483\u5074\u306e\u6210\u529f\u65703\u3067\u5224\u5b9a\n\u30fb\u8fd1\u63a5\u653b\u6483\u3000AT\n\u3000ATx[y] or ATx@y or ATx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4) \u30b5\u30c4\u30d0\u30c4\uff01\u767a\u751f\u6642\u306b\u306f\u8868\u793a\n\u3000\u4f8b:AT6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u8fd1\u63a5\u653b\u6483\u306e\u5224\u5b9a\n\u30fb\u30b5\u30c4\u30d0\u30c4\u5224\u5b9a\u3000SB\n\u30fb\u96fb\u5b50\u6226\u3000EL\n\u3000ELx[y] or ELx@y or ELx\n\u3000x=\u5224\u5b9a\u30c0\u30a4\u30b9 y=\u96e3\u6613\u5ea6 \u7701\u7565\u6642\u306fNORMAL(4)\n\u3000\u4f8b:EL6[H] \u96e3\u6613\u5ea6HARD,\u5224\u5b9a\u30c0\u30a4\u30b95\u3067\u96fb\u5b50\u6226\u306e\u5224\u5b9a\n\n\u30fb\u96e3\u6613\u5ea6\n\u3000KIDS=K,EASY=E,NORMAL=N,HARD=H,ULTRA HARD=UH \u6570\u5b57\u306b\u3082\u5bfe\u5fdc\n"),t.def(m,"$initialize",a=function(e){var r=this;return a.$$p&&(a.$$p=null),N(r,t.find_super_dispatcher(r,"initialize",a,!1,!0),"initialize",[e],null),r.default_cmp_op=">=",r.default_target_number=4},a.$$arity=1),t.const_set(v[0],"DIFFICULTY_VALUE_RE","UH|[2-6KENH]".$freeze()),t.const_set(v[0],"DIFFICULTY_RE",("(\\[("+D(v,"DIFFICULTY_VALUE_RE")+")\\]|@("+D(v,"DIFFICULTY_VALUE_RE")+"))").$freeze()),t.const_set(v[0],"NJ_RE",t.regexp(["^(S)?NJ(\\d+)",D(v,"DIFFICULTY_RE"),"?$"],"i").$freeze()),t.const_set(v[0],"EV_RE",t.regexp(["^EV(\\d+)",D(v,"DIFFICULTY_RE"),"?(?:/(\\d+))?$"],"i").$freeze()),t.const_set(v[0],"AT_RE",t.regexp(["^AT(\\d+)",D(v,"DIFFICULTY_RE"),"?$"],"i").$freeze()),t.const_set(v[0],"EL_RE",t.regexp(["^EL(\\d+)",D(v,"DIFFICULTY_RE"),"?$"],"i").$freeze()),t.const_set(v[0],"EV",D(v,"Struct").$new("num","difficulty","targetValue")),t.const_set(v[0],"AT",D(v,"Struct").$new("num","difficulty")),t.const_set(v[0],"EL",D(v,"Struct").$new("num","difficulty")),t.const_set(v[0],"DIFFICULTY_SYMBOL_TO_INTEGER",T(["K","E","N","H","UH"],{K:2,E:3,N:4,H:5,UH:6}).$freeze()),t.def(m,"$change_text",i=function(t){var e=x,r=x,n=x;return e=D(v,"NJ_RE").$match(t),C(e)?(r=this.$bRollCommand(e["$[]"](2),this.$integerValueOfDifficulty(C(n=e["$[]"](4))?n:e["$[]"](5))),""+e["$[]"](1)+r):t},i.$$arity=1),t.def(m,"$eval_game_system_specific_command",o=function(t){var e=this,r=x,n=x,$=x;return e.$debug("eval_game_system_specific_command begin string",t),C(r=D(v,"TABLES")["$[]"](t))?r.$roll(e.$randomizer()):(n=$=e.$parse(t),D(v,"EV")["$==="](n)?e.$executeEV($):D(v,"AT")["$==="](n)?e.$executeAT($):D(v,"EL")["$==="](n)?e.$executeEL($):x)},o.$$arity=1),m.$private(),t.def(m,"$parse",u=function(t){var e,r=this;return e=t,D(v,"EV_RE")["$==="](e)?r.$parseEV(D(v,"Regexp").$last_match()):D(v,"AT_RE")["$==="](e)?r.$parseAT(D(v,"Regexp").$last_match()):D(v,"EL_RE")["$==="](e)?r.$parseEL(D(v,"Regexp").$last_match()):x},u.$$arity=1),t.def(m,"$parseEV",s=function(t){var e,r,n,$,c;return r=t["$[]"](1).$to_i(),n=this.$integerValueOfDifficulty(C($=t["$[]"](3))?$:t["$[]"](4)),c=(e=t["$[]"](5))===x||null==e?x:L(e,"to_i",[]),D(v,"EV").$new(r,n,c)},s.$$arity=1),t.def(m,"$parseAT",_=function(t){var e,r,n;return e=t["$[]"](1).$to_i(),r=this.$integerValueOfDifficulty(C(n=t["$[]"](3))?n:t["$[]"](4)),D(v,"AT").$new(e,r)},_.$$arity=1),t.def(m,"$parseEL",d=function(t){var e,r,n;return e=t["$[]"](1).$to_i(),r=this.$integerValueOfDifficulty(C(n=t["$[]"](3))?n:t["$[]"](4)),D(v,"EL").$new(e,r)},d.$$arity=1),t.def(m,"$executeEV",l=function(t){var e,r,n=this,$=x,c=x;return e=n.$bRollCommand(t.$num(),t.$difficulty()),c=[($=k(k(D(v,"BCDice"),"CommonCommand"),"BarabaraDice").$eval(e,n,n.randomizer)).$text()],C(C(r=t.$targetValue())?function(t,e){return"number"==typeof t&&"number"==typeof e?t>e:t["$>"](e)}($.$success_num(),t.$targetValue()):r)&&c.$push("\u30ab\u30a6\u30f3\u30bf\u30fc\u30ab\u30e9\u30c6!!"),c.$join(" \uff1e ")},l.$$arity=1),t.def(m,"$executeAT",f=function(t){var r,n,$=this,c=x,a=x;return r=$.$bRollCommand(t.$num(),t.$difficulty()),n=(c=k(k(D(v,"BCDice"),"CommonCommand"),"BarabaraDice").$eval(r,$,$.randomizer)).$last_dice_list().$count(6),a=[c.$text()],C(e(n,2))&&a.$push("\u30b5\u30c4\u30d0\u30c4!!"),a.$join(" \uff1e ")},f.$$arity=1),t.def(m,"$executeEL",p=function(t){var n,$,c,a,i=this,o=x,u=x;return $=i.$bRollCommand(t.$num(),t.$difficulty()),c=(u=(o=k(k(D(v,"BCDice"),"CommonCommand"),"BarabaraDice").$eval($,i,i.randomizer)).$last_dice_list()).$count(6),a=L(u,"count",[],((n=function(r){return null==r&&(r=x),e(r,t.$difficulty())}).$$s=i,n.$$arity=1,n)),C(e(c,1))?[o.$text()+" + "+c,r(a,c)].$join(" \uff1e "):o.$text()},p.$$arity=1),t.def(m,"$integerValueOfDifficulty",y=function(t){return C(t)?C(/^[2-6]$/.$match(t))?t.$to_i():D(v,"DIFFICULTY_SYMBOL_TO_INTEGER").$fetch(t.$upcase()):4},y.$$arity=1),t.def(m,"$bRollCommand",h=function(t,e){return t+"B6>="+e},h.$$arity=2),t.const_set(v[0],"SATSUBATSU_TABLE",["\u300c\u6b7b\u306d\u30fc\u30c3\uff01\u300d\u8179\u90e8\u306b\u5f37\u70c8\u306a\u4e00\u6483\uff01\u3000\u6575\u306f\u304f\u306e\u5b57\u306b\u6298\u308c\u66f2\u304c\u308a\u3001\u30ef\u30a4\u30e4\u30fc\u30a2\u30af\u30b7\u30e7\u30f3\u3081\u3044\u3066\u5439\u3063\u98db\u3093\u3060\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u6575\u306f\u5f8c\u65b9\u306e\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u5411\u304b\u3063\u3066\u3001\u4f55\u30de\u30b9\u3067\u3082\u307e\u3063\u3059\u3050\u5f3e\u304d\u98db\u3070\u3055\u308c\u308b\uff08\u4ed6\u306e\u30ad\u30e3\u30e9\u306e\u3044\u308b\u30de\u30b9\u306f\u901a\u904e\u3059\u308b\uff09\u3002\u58c1\u307e\u305f\u306f\u969c\u5bb3\u7269\u306b\u63a5\u89e6\u3057\u305f\u6642\u70b9\u3067\u3001\u6575\u306f\u3055\u3089\u306b1\u30c0\u30e1\u30fc\u30b8\u3092\u53d7\u3051\u308b\u3002\u6575\u306f\u3053\u306e\u6fc0\u7a81\u30c0\u30e1\u30fc\u30b8\u306b\u5bfe\u3057\u3066\u6539\u3081\u3066\u300e\u56de\u907f\u5224\u5b9a\u300f\u3092\u884c\u3063\u3066\u3082\u826f\u3044\u3002","\u300c\u30a4\u30e4\u30fc\u30c3\uff01\u300d\u982d\u90e8\u3078\u306e\u75db\u70c8\u306a\u30ab\u30e9\u30c6\uff01\u3000\u773c\u7403\u7834\u58ca\u3082\u3057\u304f\u306f\u6fc0\u3057\u3044\u8133\u9707\u76ea\u304c\u6575\u3092\u8972\u3046\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u3068\u3010\u30ef\u30b6\u30de\u30a8\u3011\u304c\u305d\u308c\u305e\u308c1\u305a\u3064\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u82e6\u3057\u307f\u629c\u3044\u3066\u6b7b\u306c\u304c\u3044\u3044\u300d\u6025\u6240\u3092\u60c5\u3051\u5bb9\u8d66\u306a\u304f\u7834\u58ca\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u8010\u3048\u96e3\u3044\u82e6\u75db\u306b\u3088\u308a\u3001\u6575\u306f\u3010\u7cbe\u795e\u529b\u3011\u304c-2\u3055\u308c\u3001\u3010\u30cb\u30e5\u30fc\u30ed\u30f3\u3011\u304c1\u6e1b\u5c11\u3059\u308b\uff08\u3053\u308c\u306b\u3088\u308b\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u9003\u3052\u3089\u308c\u308b\u3082\u306e\u306a\u3089\u9003\u3052\u3066\u307f\u3088\u300d\u6575\u306e\u811a\u3092\u7c89\u7815\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u811a\u529b\u3011\u304cD3\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u3053\u308c\u3067\u624b\u3082\u8db3\u3082\u51fa\u307e\u3044\uff01\u300d\u6575\u306e\u4e21\u8155\u3092\u5207\u308a\u98db\u3070\u3057\u305f\uff01\u3000\u9bae\u8840\u304c\u30b9\u30d7\u30ea\u30f3\u30af\u30e9\u30fc\u3081\u3044\u3066\u5674\u304d\u51fa\u3059\uff01\uff1a\u672c\u6765\u306e\u30c0\u30e1\u30fc\u30b8+1\u30c0\u30e1\u30fc\u30b8\u3092\u4e0e\u3048\u308b\u3002\u3055\u3089\u306b\u6575\u306e\u3010\u30ef\u30b6\u30de\u30a8\u3011\u3068\u3010\u30ab\u30e9\u30c6\u3011\u304c\u305d\u308c\u305e\u308c2\u6e1b\u5c11\u3059\u308b\uff08\u6700\u4f4e\u5024\u306f1\uff09\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD3\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD3\u4e0a\u6607\u3059\u308b\u3002","\u300c\u30a4\u30a4\u30a4\u30e4\u30a2\u30a2\u30a2\u30a2\u30fc\u30fc\u30fc\u30fc\u30c3\uff01\u300d\u30e4\u30ea\u3081\u3044\u305f\u30c1\u30e7\u30c3\u30d7\u304c\u6575\u306e\u80f8\u3092\u8cab\u901a\uff01\u3000\u3055\u3089\u306b\u5fc3\u81d3\u3092\u63b4\u307f\u53d6\u308a\u3001\u63e1\u308a\u3064\u3076\u3057\u305f\uff01\u3000\u30ca\u30e0\u30a2\u30df\u30c0\u30d6\u30c4\uff01\uff1a\u6575\u306f\u6b8b\u308a\u3010\u4f53\u529b\u3011\u306b\u95a2\u4fc2\u306a\u304f\u5373\u6b7b\u3059\u308b\u3002\u6b8b\u8650\u30dc\u30fc\u30ca\u30b9\u306b\u3088\u308a\u3010\u4e07\u672d\u3011\u304cD6\u767a\u751f\u3002\u3053\u306e\u653b\u6483\u3092\u3010\u30ab\u30eb\u30de\uff1a\u5584\u3011\u306e\u30ad\u30e3\u30e9\u306b\u5bfe\u3057\u3066\u884c\u3063\u3066\u3057\u307e\u3063\u305f\u5834\u5408\u3001\u3010DKK\u3011\u304cD6\u4e0a\u6607\u3059\u308b\u3002"].$freeze()),t.const_set(v[0],"TABLES",T(["SB"],{SB:k(D(v,"DiceTable"),"Table").$new("\u30b5\u30c4\u30d0\u30c4\u8868","1D6",D(v,"SATSUBATSU_TABLE"))}).$freeze()),m.$register_prefix("NJ","EV","AT","EL",D(v,"TABLES").$keys())}(Opal)}}]);