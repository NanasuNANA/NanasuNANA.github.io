(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[1141],{61141:function(t,r,e){e(93683),Opal.modules["bcdice/normalize"]=function(t){var r,e,n,o,i,a,$=[],m=t.nil,_=t.module;return i=$,r=a=[_($[0],"BCDice")].concat(i),[o=_(a[0],"Normalize")].concat(r),o.$module_function(),t.def(o,"$comparison_operator",e=function(t){var r;return/<=|=</["$==="](r=t)?"<=":/>=|=>/["$==="](r)?">=":/<>|!=|=!/["$==="](r)?"!=":/</["$==="](r)?"<":/>/["$==="](r)?">":/=/["$==="](r)?"==":m},e.$$arity=1),void t.def(o,"$target_number",n=function(t){return t["$=="]("?")?t:t.$to_i()},n.$$arity=1)},Opal.modules["bcdice/format"]=function(t){var r,e,n,o,i,a,$,m=[],_=t.nil,u=t.$$,c=t.module,l=t.truthy;return r=m,e=$=[c(m[0],"BCDice")].concat(r),i=c($[0],"Format"),a=[i].concat(e),i.$module_function(),t.def(i,"$comparison_operator",n=function(t){var r;return"=="["$==="](r=t)?"=":"!="["$==="](r)?"<>":u(a,"Symbol")["$==="](r)?t.$to_s():_},n.$$arity=1),void t.def(i,"$modifier",o=function(t){return l(t["$nil?"]())?_:t["$=="](0)?"":l("number"==typeof(r=t)?r>0:r["$>"](0))?"+"+t:t.$to_s();var r},o.$$arity=1)},function(t){function r(t,r){return"number"==typeof t&&"number"==typeof r?t+r:t["$+"](r)}function e(t,r){return"number"==typeof t&&"number"==typeof r?t-r:t["$-"](r)}var n,o,i,a,$,m,_,u,c,l,s,p,d,f,b,y,v,h,g,z,x,w,N,E,W,P=t.top,j=[],A=t.nil,C=t.$$,R=t.module,k=t.klass,S=t.send2,B=t.truthy,D=t.send;P.$require("bcdice/normalize"),P.$require("bcdice/format"),n=j,o=W=[R(j[0],"BCDice")].concat(n),i=(E=[R(W[0],"GameSystem")].concat(o))[0],a=C(E,"Base"),$=E,w=k(i,a,"NightWizard"),N=[w].concat($),w.$$prototype.nw_command=w.$$prototype.randomizer=w.$$prototype.total=w.$$prototype.interim_expr=w.$$prototype.status=w.$$prototype.fumble_numbers=w.$$prototype.critical_numbers=A,t.const_set(N[0],"ID","NightWizard"),t.const_set(N[0],"NAME","\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition"),t.const_set(N[0],"SORT_KEY","\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682"),t.const_set(N[0],"HELP_MESSAGE","\u30fb\u5224\u5b9a\u7528\u30b3\u30de\u30f3\u30c9\u3000(aNW+b@x#y$z+c)\n\u3000\u3000a : \u57fa\u672c\u5024\n\u3000\u3000b : \u5e38\u6642\u306b\u6e96\u3058\u308b\u7279\u6280\u306b\u3088\u308b\u88dc\u6b63\n\u3000\u3000c : \u5e38\u6642\u4ee5\u5916\u306e\u7279\u6280\u3001\u304a\u3088\u3073\u652f\u63f4\u52b9\u679c\u306b\u3088\u308b\u88dc\u6b63\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u3000x : \u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 10\uff09\n\u3000\u3000y : \u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u306e\u30ab\u30f3\u30de\u533a\u5207\u308a\uff08\u7701\u7565\u6642 5\uff09\n\u3000\u3000z : \u30d7\u30e9\u30fc\u30ca\u306b\u3088\u308b\u9054\u6210\u5024\u88dc\u6b63\u306e\u30d7\u30e9\u30fc\u30ca\u6d88\u8cbb\u6570\uff08\u30d5\u30a1\u30f3\u30d6\u30eb\u6642\u306b\u306f\u9069\u7528\u3055\u308c\u306a\u3044\uff09\n\u3000\u30af\u30ea\u30c6\u30a3\u30ab\u30eb\u5024\u3001\u30d5\u30a1\u30f3\u30d6\u30eb\u5024\u304c\u7121\u3044\u5834\u5408\u306f1\u308413\u306a\u3069\u306e\u3042\u308a\u5f97\u306a\u3044\u6570\u5024\u3092\u5165\u308c\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u4f8b\uff0912NW-5@7#2$3 1NW 50nw+5@7,10#2,5 50nw-5+10@7,10#2,5+15+25\n"),w.$register_prefix("([-+]?\\d+)?NW","2R6"),t.def(w,"$initialize",m=function(r){var e=this;return m.$$p&&(m.$$p=null),S(e,t.find_super_dispatcher(e,"initialize",m,!1,!0),"initialize",[r],null),e.nw_command="NW"},m.$$arity=1),t.def(w,"$eval_game_system_specific_command",_=function(r){var e,n,o,i=this,a=A,$=A,m=A,_=A,u=A;return a=B(o=i.$parse_nw(r))?o:i.$parse_2r6(r),B(a)?(n=i.$roll_nw(a),$=null==(e=t.to_ary(n))[0]?A:e[0],m=null==e[1]?A:e[1],_=null==e[2]?A:e[2],u=B(a.$cmp_op())?B($.$send(a.$cmp_op(),a.$target_number()))?"\u6210\u529f":"\u5931\u6557":A,["("+a+")",m,_,$.$to_s(),u].$compact().$join(" \uff1e ")):A},_.$$arity=1),w.$private(),function(t,r,e){var n=k(t,null,"Parsed");[n].concat(e),n.$attr_accessor("critical_numbers"),n.$attr_accessor("fumble_numbers"),n.$attr_accessor("prana"),n.$attr_accessor("active_modify_number"),n.$attr_accessor("cmp_op"),n.$attr_accessor("target_number")}(N[0],0,N),f=N[0],b=C(N,"Parsed"),y=N,z=k(f,b,"ParsedNW"),x=[z].concat(y),z.$$prototype.base=z.$$prototype.modify_number=z.$$prototype.active_modify_number=z.$$prototype.prana=z.$$prototype.command=z.$$prototype.critical_numbers=z.$$prototype.fumble_numbers=z.$$prototype.cmp_op=z.$$prototype.target_number=A,z.$attr_accessor("base"),z.$attr_accessor("modify_number"),t.def(z,"$initialize",v=function(r){var e=this;return v.$$p&&(v.$$p=null),S(e,t.find_super_dispatcher(e,"initialize",v,!1,!0),"initialize",[],null),e.command=r},v.$$arity=1),t.def(z,"$passive_modify_number",h=function(){return r(this.base,this.modify_number)},h.$$arity=0),t.def(z,"$to_s",g=function(){var t,r,e,n,o,i=this;return t=B(i.base["$zero?"]())?A:i.base,r=C(x,"Format").$modifier(i.modify_number),e=C(x,"Format").$modifier(i.active_modify_number),n=B(o=i.prana)?"$"+i.prana:o,""+t+i.command+r+"@"+i.critical_numbers.$join(",")+"#"+i.fumble_numbers.$join(",")+n+e+i.cmp_op+i.target_number},g.$$arity=0),function(r,e,n){var o,i=k(r,e,"Parsed2R6");[i].concat(n),i.$$prototype.passive_modify_number=i.$$prototype.active_modify_number=i.$$prototype.critical_numbers=i.$$prototype.fumble_numbers=i.$$prototype.cmp_op=i.$$prototype.target_number=A,i.$attr_accessor("passive_modify_number"),t.def(i,"$to_s",o=function(){var t=this;return"2R6M["+t.passive_modify_number+","+t.active_modify_number+"]C["+t.critical_numbers.$join(",")+"]F["+t.fumble_numbers.$join(",")+"]"+t.cmp_op+t.target_number},o.$$arity=0)}(N[0],C(N,"Parsed"),N),t.def(w,"$parse_nw",u=function(r){var n,o,i=A,a=A,$=A;return i=t.regexp(["^([-+]?\\d+)?",this.nw_command,"((?:[-+]\\d+)+)?(?:@(\\d+(?:,\\d+)*))?(?:#(\\d+(?:,\\d+)*))?(?:\\$(\\d+(?:,\\d+)*))?((?:[-+]\\d+)+)?(?:([>=]+)(\\d+))?$"]).$match(r),B(i)?(a=C(N,"ParsedNW").$new(this.nw_command),$=[i["$[]"](1).$to_i()],D(a,"base=",t.to_a($)),e($.length,1),$=[C(N,"ArithmeticEvaluator").$eval(i["$[]"](2))],D(a,"modify_number=",t.to_a($)),e($.length,1),$=[B(i["$[]"](3))?D(i["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],D(a,"critical_numbers=",t.to_a($)),e($.length,1),$=[B(i["$[]"](4))?D(i["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],D(a,"fumble_numbers=",t.to_a($)),e($.length,1),$=[(n=i["$[]"](5),n===A||null==n?A:D(n,"to_i",[]))],D(a,"prana=",t.to_a($)),e($.length,1),$=[C(N,"ArithmeticEvaluator").$eval(i["$[]"](6))],D(a,"active_modify_number=",t.to_a($)),e($.length,1),$=[C(N,"Normalize").$comparison_operator(i["$[]"](7))],D(a,"cmp_op=",t.to_a($)),e($.length,1),$=[(o=i["$[]"](8),o===A||null==o?A:D(o,"to_i",[]))],D(a,"target_number=",t.to_a($)),e($.length,1),a):A},u.$$arity=1),t.def(w,"$parse_2r6",c=function(r){var n,o=A,i=A,a=A;return o=/^2R6m\[([-+]?\d+(?:[-+]\d+)*)(?:,([-+]?\d+(?:[-+]\d+)*))?\](?:c\[(\d+(?:,\d+)*)\])?(?:f\[(\d+(?:,\d+)*)\])?(?:([>=]+)(\d+))?/i.$match(r),B(o)?(i=C(N,"Parsed2R6").$new(),a=[C(N,"ArithmeticEvaluator").$eval(o["$[]"](1))],D(i,"passive_modify_number=",t.to_a(a)),e(a.length,1),a=[C(N,"ArithmeticEvaluator").$eval(o["$[]"](2))],D(i,"active_modify_number=",t.to_a(a)),e(a.length,1),a=[B(o["$[]"](3))?D(o["$[]"](3).$split(","),"map",[],"to_i".$to_proc()):[10]],D(i,"critical_numbers=",t.to_a(a)),e(a.length,1),a=[B(o["$[]"](4))?D(o["$[]"](4).$split(","),"map",[],"to_i".$to_proc()):[5]],D(i,"fumble_numbers=",t.to_a(a)),e(a.length,1),a=[C(N,"Normalize").$comparison_operator(o["$[]"](5))],D(i,"cmp_op=",t.to_a(a)),e(a.length,1),a=[(n=o["$[]"](6),n===A||null==n?A:D(n,"to_i",[]))],D(i,"target_number=",t.to_a(a)),e(a.length,1),i):A},c.$$arity=1),t.def(w,"$roll_nw",l=function(t){var e,n=this,o=A,i=A,a=A,$=A,m=A;for(n.critical_numbers=t.$critical_numbers(),n.fumble_numbers=t.$fumble_numbers(),n.total=0,n.interim_expr="",n.status=A,o=n.$roll_once_first();o["$=="]("critical");)o=n.$roll_once();return B(B(e=o["$!="]("fumble"))?t.$prana():e)&&(a=(i=n.randomizer.$roll_barabara(t.$prana(),6)).$sum(),$=i.$join(","),n.total=r(n.total,a),n.interim_expr=r(n.interim_expr,"+"+a+"["+$+"]")),m=o["$=="]("fumble")?n.$fumble_base_number(t):r(t.$passive_modify_number(),t.$active_modify_number()),n.total=r(n.total,m),n.interim_expr=r(m.$to_s(),n.interim_expr),[n.total,n.interim_expr,n.status]},l.$$arity=1),t.def(w,"$roll_once",s=function(t){var n,o,i,a=this,$=A;return null==t&&(t=!1),n=($=a.randomizer.$roll_barabara(2,6)).$sum(),o=$.$join(","),B(B(i=t)?a.fumble_numbers["$include?"](n):i)?(a.total=e(a.total,10),a.interim_expr=r(a.interim_expr,"-10["+o+"]"),a.status="\u30d5\u30a1\u30f3\u30d6\u30eb","fumble"):B(a.critical_numbers["$include?"](n))?(a.total=r(a.total,10),a.interim_expr=r(a.interim_expr,"+10["+o+"]"),a.status="\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","critical"):(a.total=r(a.total,n),a.interim_expr=r(a.interim_expr,"+"+n+"["+o+"]"),A)},s.$$arity=-1),t.def(w,"$roll_once_first",p=function(){return this.$roll_once(!0)},p.$$arity=0),t.def(w,"$fumble_base_number",d=function(t){return t.$passive_modify_number()},d.$$arity=1)}(Opal)}}]);