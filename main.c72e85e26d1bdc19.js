(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[8792],{8848:(Nt,Fe,me)=>{"use strict";me.d(Fe,{U:()=>R});class R{}},442:(Nt,Fe,me)=>{"use strict";me.d(Fe,{y:()=>ie});var oe=me(1782),te=me(4232),K=me(6609);const q=function R(ye){if(ye.length>=255)throw new TypeError("Alphabet too long");const de=new Uint8Array(256);for(let ct=0;ct<de.length;ct++)de[ct]=255;for(let ct=0;ct<ye.length;ct++){const Ee=ye.charAt(ct),Tt=Ee.charCodeAt(0);if(255!==de[Tt])throw new TypeError(Ee+" is ambiguous");de[Tt]=ct}const Ve=ye.length,Je=ye.charAt(0),Lt=Math.log(Ve)/Math.log(256),Ae=Math.log(256)/Math.log(Ve);function rt(ct){if("string"!=typeof ct)throw new TypeError("Expected String");if(0===ct.length)return new Uint8Array;let Ee=0,Tt=0,Gt=0;for(;ct[Ee]===Je;)Tt++,Ee++;const Et=(ct.length-Ee)*Lt+1>>>0,_t=new Uint8Array(Et);for(;Ee<ct.length;){const Bt=ct.charCodeAt(Ee);if(Bt>255)return;let Ut=de[Bt];if(255===Ut)return;let Ht=0;for(let zn=Et-1;(0!==Ut||Ht<Gt)&&-1!==zn;zn--,Ht++)Ut+=Ve*_t[zn]>>>0,_t[zn]=Ut%256>>>0,Ut=Ut/256>>>0;if(0!==Ut)throw new Error("Non-zero carry");Gt=Ht,Ee++}let Vt=Et-Gt;for(;Vt!==Et&&0===_t[Vt];)Vt++;const un=new Uint8Array(Tt+(Et-Vt));let wt=Tt;for(;Vt!==Et;)un[wt++]=_t[Vt++];return un}return{encode:function ot(ct){if(ct instanceof Uint8Array||(ArrayBuffer.isView(ct)?ct=new Uint8Array(ct.buffer,ct.byteOffset,ct.byteLength):Array.isArray(ct)&&(ct=Uint8Array.from(ct))),!(ct instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===ct.length)return"";let Ee=0,Tt=0,Gt=0;const Et=ct.length;for(;Gt!==Et&&0===ct[Gt];)Gt++,Ee++;const _t=(Et-Gt)*Ae+1>>>0,Vt=new Uint8Array(_t);for(;Gt!==Et;){let Bt=ct[Gt],Ut=0;for(let Ht=_t-1;(0!==Bt||Ut<Tt)&&-1!==Ht;Ht--,Ut++)Bt+=256*Vt[Ht]>>>0,Vt[Ht]=Bt%Ve>>>0,Bt=Bt/Ve>>>0;if(0!==Bt)throw new Error("Non-zero carry");Tt=Ut,Gt++}let un=_t-Tt;for(;un!==_t&&0===Vt[un];)un++;let wt=Je.repeat(Ee);for(;un<_t;++un)wt+=ye.charAt(Vt[un]);return wt},decodeUnsafe:rt,decode:function qe(ct){const Ee=rt(ct);if(Ee)return Ee;throw new Error("Non-base"+Ve+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),W=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class ie{get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}constructor(de){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:K.s.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(de)}parse(de){try{this.peerId=de;let Ve=W.exec(de);if(null!=Ve)return this.digestUserId=Ve[1],this.roomId=Ve[2],this.roomName=oe.decompress(Ve[3]),void(this.digestPassword=Ve[4])}catch(Ve){console.warn(Ve)}this.digestUserId=de}verifyPassword(de){return H(this.digestUserId,this.roomId,this.roomName,de)===this.digestPassword&&this.verifyRoomId(de)}verifyRoomId(de){return $(this.roomId,this.roomName,de)===this.roomId}verifyPeer(de){let Ve=ie.parse(de);return this.roomId==Ve.roomId&&this.roomName==Ve.roomName&&this.hasPassword==Ve.hasPassword&&(!this.hasPassword||(this.password.length<1?(console.error("do not know password."),!1):Ve.verifyPassword(this.password)))}static parse(de){return new ie(de)}static create(...de){return de.length<=1?ie._create.apply(this,de):ie._createRoom.apply(this,de)}static _create(de=""){let Ve=function Q(ye){return null==ye?"":he(ye)}(de),Je=new ie(Ve);return Je.userId=de,Je}static _createRoom(de="",Ve="",Je="",Lt=""){let Ae=he(de,6),ot=$(Ve,Je,Lt),rt=H(Ae,ot,Je,Lt),qe=`${Ae}${ot}${oe.compress(Je)}-${rt}`,ct=new ie(qe);return ct.userId=de,ct.password=Lt,ct}static generateId(de="********"){let Je=de;return Je=de.replace(/\*/g,Lt=>"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())]),Je}}function H(ye,de,Ve,Je){return null==de||null==Je?"":0<Je.length?he(ye+de+Ve+Je,7):""}function $(ye,de,Ve){if(Ve.length<1)return ye;let Je=ye.slice(0,2);return Je+he(Je+de+Ve,1)}function he(ye,de=-1){if(null==ye)return"";let Ve=te.M.sha256(ye),Je=q.encode(Ve);return de<0&&(de=Je.length),Je.length<de&&(de=Je.length),Je=Je.slice(0,de),Je}},6609:(Nt,Fe,me)=>{"use strict";me.d(Fe,{s:()=>R});var R=function(A){return A[A.UNSPECIFIED=0]="UNSPECIFIED",A[A.LOW=1]="LOW",A[A.MIDDLE=2]="MIDDLE",A[A.HIGH=3]="HIGH",A}(R||{})},4232:(Nt,Fe,me)=>{"use strict";me.d(Fe,{M:()=>K});var K,R=me(8823),A=me.n(R),oe=me(5168),te=me.n(oe);!function(q){function H($){let he=new Uint8Array($.words.length<<2),ye=0;for(let de of $.words)he[ye++]=(4278190080&de)>>>24,he[ye++]=(16711680&de)>>>16,he[ye++]=(65280&de)>>>8,he[ye++]=255&de;return he}q.sha256=function W($){let he;if($ instanceof ArrayBuffer){let ye=A().create($);he=te()(ye)}else he=te()($);return H(he)},q.sha256Hex=function ie($){if($ instanceof ArrayBuffer){let he=A().create($);return te()(he).toString()}return te()($).toString()},q.sha256Base64Url=function Q($){if(null==$)return"";let ye=H(te()($));return btoa(String.fromCharCode(...ye)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=*$/g,"")}}(K||(K={}))},8161:(Nt,Fe,me)=>{"use strict";me.d(Fe,{$:()=>A});var A,oe,R=me(4999);(oe=A||(A={})).encode=function te(q){try{return R.encode(q)}catch(W){console.error(W,q)}return null},oe.decode=function K(q){try{return R.decode(q)}catch(W){console.error(W,q)}return null}},9757:(Nt,Fe,me)=>{"use strict";me.d(Fe,{b:()=>R});class R{get isActive(){return null!=this.timeoutTimer}constructor(oe,te,K=!0){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=oe,this.timerMilliSecond=te,K&&this.reset()}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...oe){1===oe.length?this.timerMilliSecond=oe[0]:1<oe.length&&(this.callback=oe[0],this.timerMilliSecond=oe[1]),this.isStopped=!1;let te=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&te<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}},1185:(Nt,Fe,me)=>{"use strict";var R;me.d(Fe,{k:()=>R}),function(A){let oe=[];for(let K=0;K<256;K++)oe[K]=(K<16?"0":"")+K.toString(16);A.generateUuid=function te(){const K=new Uint32Array(4);window.crypto.getRandomValues(K);const q=K[0],W=K[1],ie=K[2],Q=K[3];return oe[255&q]+oe[q>>8&255]+oe[q>>16&255]+oe[q>>24&255]+"-"+oe[255&W]+oe[W>>8&255]+"-"+oe[W>>16&15|64]+oe[W>>24&255]+"-"+oe[63&ie|128]+oe[ie>>8&255]+"-"+oe[ie>>16&255]+oe[ie>>24&255]+oe[255&Q]+oe[Q>>8&255]+oe[Q>>16&255]+oe[Q>>24&255]}}(R||(R={}))},2306:(Nt,Fe,me)=>{"use strict";me.d(Fe,{W:()=>te,v:()=>K});let R=0;const A=new Map,oe=new MessageChannel;function te(q){if(4294967296===R&&(R=0),++R in A)throw new Error("setZeroTimeout queue overflow.");return A.set(R,q),oe.port2.postMessage(R),R}function K(q){A.delete(q)}oe.port1.onmessage=function(q){const W=A.get(q.data);A.delete(q.data),W&&W()},oe.port1.start(),oe.port2.start()},3781:(Nt,Fe,me)=>{"use strict";var R=me(467);let oe=null,K=1;const q=Symbol("SIGNAL");function W(t){const n=oe;return oe=t,n}function de(t){if((!Tt(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==K)){if(!t.producerMustRecompute(t)&&!rt(t))return t.dirty=!1,void(t.lastCleanEpoch=K);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=K}}function rt(t){Gt(t);for(let n=0;n<t.producerNode.length;n++){const e=t.producerNode[n],i=t.producerLastReadVersion[n];if(i!==e.version||(de(e),i!==e.version))return!0}return!1}function Ee(t,n){if(function Et(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),Gt(t),1===t.liveConsumerNode.length)for(let i=0;i<t.producerNode.length;i++)Ee(t.producerNode[i],t.producerIndexOfThis[i]);const e=t.liveConsumerNode.length-1;if(t.liveConsumerNode[n]=t.liveConsumerNode[e],t.liveConsumerIndexOfThis[n]=t.liveConsumerIndexOfThis[e],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,n<t.liveConsumerNode.length){const i=t.liveConsumerIndexOfThis[n],r=t.liveConsumerNode[n];Gt(r),r.producerIndexOfThis[i]=n}}function Tt(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function Gt(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let Ht=null;function Rt(t){return"function"==typeof t}function pn(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const ln=pn(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function dn(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class qn{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const o of e)o.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(Rt(i))try{i()}catch(o){n=o instanceof ln?o.errors:[o]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const o of r)try{qr(o)}catch(s){n=n??[],s instanceof ln?n=[...n,...s.errors]:n.push(s)}}if(n)throw new ln(n)}}add(n){var e;if(n&&n!==this)if(this.closed)qr(n);else{if(n instanceof qn){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&dn(e,n)}remove(n){const{_finalizers:e}=this;e&&dn(e,n),n instanceof qn&&n._removeParent(this)}}qn.EMPTY=(()=>{const t=new qn;return t.closed=!0,t})();const wi=qn.EMPTY;function ar(t){return t instanceof qn||t&&"closed"in t&&Rt(t.remove)&&Rt(t.add)&&Rt(t.unsubscribe)}function qr(t){Rt(t)?t():t.unsubscribe()}const so={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},lr={setTimeout(t,n,...e){const{delegate:i}=lr;return i?.setTimeout?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=lr;return(n?.clearTimeout||clearTimeout)(t)},delegate:void 0};function Vr(t){lr.setTimeout(()=>{const{onUnhandledError:n}=so;if(!n)throw t;n(t)})}function ia(){}const Od=Da("C",void 0,void 0);function Da(t,n,e){return{kind:t,value:n,error:e}}let Ao=null;function Oa(t){if(so.useDeprecatedSynchronousErrorHandling){const n=!Ao;if(n&&(Ao={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=Ao;if(Ao=null,e)throw i}}else t()}class Ka extends qn{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,ar(n)&&n.add(this)):this.destination=Gc}static create(n,e,i){return new dc(n,e,i)}next(n){this.isStopped?jc(function Ad(t){return Da("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?jc(function Ll(t){return Da("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?jc(Od,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Qa=Function.prototype.bind;function Aa(t,n){return Qa.call(t,n)}class uc{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){Bl(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){Bl(i)}else Bl(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){Bl(e)}}}class dc extends Ka{constructor(n,e,i){let r;if(super(),Rt(n)||!n)r={next:n??void 0,error:e??void 0,complete:i??void 0};else{let o;this&&so.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&Aa(n.next,o),error:n.error&&Aa(n.error,o),complete:n.complete&&Aa(n.complete,o)}):r=n}this.destination=new uc(r)}}function Bl(t){so.useDeprecatedSynchronousErrorHandling?function cc(t){so.useDeprecatedSynchronousErrorHandling&&Ao&&(Ao.errorThrown=!0,Ao.error=t)}(t):Vr(t)}function jc(t,n){const{onStoppedNotification:e}=so;e&&lr.setTimeout(()=>e(t,n))}const Gc={closed:!0,next:ia,error:function hc(t){throw t},complete:ia},Ls="function"==typeof Symbol&&Symbol.observable||"@@observable";function Wc(t){return t}let Zi=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const o=function Fd(t){return t&&t instanceof Ka||function rf(t){return t&&Rt(t.next)&&Rt(t.error)&&Rt(t.complete)}(t)&&ar(t)}(e)?e:new dc(e,i,r);return Oa(()=>{const{operator:s,source:a}=this;o.add(s?s.call(o,a):a?this._subscribe(o):this._trySubscribe(o))}),o}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=Pd(i))((r,o)=>{const s=new dc({next:a=>{try{e(a)}catch(l){o(l),s.unsubscribe()}},error:o,complete:r});this.subscribe(s)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[Ls](){return this}pipe(...e){return function $c(t){return 0===t.length?Wc:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}(e)(this)}toPromise(e){return new(e=Pd(e))((i,r)=>{let o;this.subscribe(s=>o=s,s=>r(s),()=>i(o))})}}return t.create=n=>new t(n),t})();function Pd(t){var n;return null!==(n=t??so.Promise)&&void 0!==n?n:Promise}const Nd=pn(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let ra=(()=>{class t extends Zi{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new Rd(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Nd}next(e){Oa(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){Oa(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){Oa(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:o}=this;return i||r?wi:(this.currentObservers=null,o.push(e),new qn(()=>{this.currentObservers=null,dn(o,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:o}=this;i?e.error(r):o&&e.complete()}asObservable(){const e=new Zi;return e.source=this,e}}return t.create=(n,e)=>new Rd(n,e),t})();class Rd extends ra{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:wi}}class Yc extends ra{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function fc(t){return Rt(t?.lift)}function ko(t){return n=>{if(fc(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function mo(t,n,e,i,r){return new Ld(t,n,e,i,r)}class Ld extends Ka{constructor(n,e,i,r,o,s){super(n),this.onFinalize=o,this.shouldUnsubscribe=s,this._next=e?function(a){try{e(a)}catch(l){n.error(l)}}:super._next,this._error=r?function(a){try{r(a)}catch(l){n.error(l)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(a){n.error(a)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function jo(t,n){return ko((e,i)=>{let r=0;e.subscribe(mo(i,o=>{i.next(t.call(n,o,r++))}))})}const Pu="https://g.co/ng/security#xss";class it extends Error{constructor(n,e){super(function Ja(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function Go(t){return{toString:t}.toString()}const oa="__parameters__";function Hs(t,n,e){return Go(()=>{const i=function Us(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...o){if(this instanceof r)return i.apply(this,o),this;const s=new r(...o);return a.annotation=s,a;function a(l,u,f){const g=l.hasOwnProperty(oa)?l[oa]:Object.defineProperty(l,oa,{value:[]})[oa];for(;g.length<=f;)g.push(null);return(g[f]=g[f]||[]).push(s),l}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}const si=globalThis;function di(t){for(let n in t)if(t[n]===di)return n;throw Error("Could not find renamed property on target object.")}function zs(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Si(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Si).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function Zc(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const j=di({__forward_ref__:di});function ne(t){return t.__forward_ref__=ne,t.toString=function(){return Si(this())},t}function V(t){return we(t)?t():t}function we(t){return"function"==typeof t&&t.hasOwnProperty(j)&&t.__forward_ref__===ne}function Wt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Pa(t){return{providers:t.providers||[],imports:t.imports||[]}}function af(t){return pv(t,Ud)||pv(t,gv)}function pv(t,n){return t.hasOwnProperty(n)?t[n]:null}function Ap(t){return t&&(t.hasOwnProperty(t_)||t.hasOwnProperty(ow))?t[t_]:null}const Ud=di({\u0275prov:di}),t_=di({\u0275inj:di}),gv=di({ngInjectableDef:di}),ow=di({ngInjectorDef:di});class hn{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Wt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function o_(t){return t&&!!t.\u0275providers}const Kr=di({\u0275cmp:di}),kp=di({\u0275dir:di}),Nu=di({\u0275pipe:di}),s_=di({\u0275mod:di}),el=di({\u0275fac:di}),ns=di({__NG_ELEMENT_ID__:di}),a_=di({__NG_ENV_ID__:di});function Nn(t){return"string"==typeof t?t:null==t?"":String(t)}function js(t,n){throw new it(-201,!1)}var mi=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(mi||{});let Pp;function gc(){return Pp}function Wo(t){const n=Pp;return Pp=t,n}function Fp(t,n,e){const i=af(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&mi.Optional?null:void 0!==n?n:void js()}const Lu={},l_="__NG_DI_FLAG__",Hd="ngTempTokenPath",dw=/\n/gm,c_="__source";let mc;function Xc(t){const n=mc;return mc=t,n}function bv(t,n=mi.Default){if(void 0===mc)throw new it(-203,!1);return null===mc?Fp(t,void 0,n):mc.get(t,n&mi.Optional?null:void 0,n)}function kn(t,n=mi.Default){return(gc()||bv)(V(t),n)}function En(t,n=mi.Default){return kn(t,lf(n))}function lf(t){return typeof t>"u"||"number"==typeof t?t:(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function u_(t){const n=[];for(let e=0;e<t.length;e++){const i=V(t[e]);if(Array.isArray(i)){if(0===i.length)throw new it(900,!1);let r,o=mi.Default;for(let s=0;s<i.length;s++){const a=i[s],l=d_(a);"number"==typeof l?-1===l?r=a.token:o|=l:r=a}n.push(kn(r,o))}else n.push(kn(i))}return n}function Bu(t,n){return t[l_]=n,t.prototype[l_]=n,t}function d_(t){return t[l_]}const cf=Bu(Hs("Optional"),8),Rp=Bu(Hs("SkipSelf"),4);function Uu(t,n){return t.hasOwnProperty(el)?t[el]:null}function Vd(t,n){t.forEach(e=>Array.isArray(e)?Vd(e,n):n(e))}function Cv(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function _c(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function is(t,n,e){let i=jd(t,n);return i>=0?t[1|i]=e:(i=~i,function f_(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function p_(t,n){const e=jd(t,n);if(e>=0)return t[1|e]}function jd(t,n){return function zu(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const o=i+(r-i>>1),s=t[o<<e];if(n===s)return o<<e;s>n?r=o:i=o+1}return~(r<<e)}(t,n,1)}const lo={},Ti=[],Gd=new hn(""),wv=new hn("",-1),g_=new hn("");class Bp{get(n,e=Lu){if(e===Lu){const i=new Error(`NullInjectorError: No provider for ${Si(n)}!`);throw i.name="NullInjectorError",i}return e}}var Up=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Up||{}),Ws=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Ws||{}),ae=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(ae||{});function ut(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const o=n.length;if(r+o===i||t.charCodeAt(r+o)<=32)return r}e=r+1}}function et(t,n,e){let i=0;for(;i<e.length;){const r=e[i];if("number"==typeof r){if(0!==r)break;i++;const o=e[i++],s=e[i++],a=e[i++];t.setAttribute(n,s,a,o)}else{const o=r,s=e[++i];Bn(o)?t.setProperty(n,o,s):t.setAttribute(n,o,s),i++}}return i}function Qt(t){return 3===t||4===t||6===t}function Bn(t){return 64===t.charCodeAt(0)}function _i(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||co(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function co(t,n,e,i,r){let o=0,s=t.length;if(-1===n)s=-1;else for(;o<t.length;){const a=t[o++];if("number"==typeof a){if(a===n){s=-1;break}if(a>n){s=o-1;break}}}for(;o<t.length;){const a=t[o];if("number"==typeof a)break;if(a===e){if(null===i)return void(null!==r&&(t[o+1]=r));if(i===t[o+1])return void(t[o+2]=r)}o++,null!==i&&o++,null!==r&&o++}-1!==s&&(t.splice(s,0,n),o=s+1),t.splice(o++,0,e),null!==i&&t.splice(o++,0,i),null!==r&&t.splice(o++,0,r)}const Xi="ng-template";function m_(t,n,e,i){let r=0;if(i){for(;r<n.length&&"string"==typeof n[r];r+=2)if("class"===n[r]&&-1!==ut(n[r+1].toLowerCase(),e,0))return!0}else if(__(t))return!1;if(r=n.indexOf(1,r),r>-1){let o;for(;++r<n.length&&"string"==typeof(o=n[r]);)if(o.toLowerCase()===e)return!0}return!1}function __(t){return 4===t.type&&t.value!==Xi}function Na(t,n,e){return n===(4!==t.type||e?t.value:Xi)}function Hp(t,n,e){let i=4;const r=t.attrs,o=null!==r?function $i(t){for(let n=0;n<t.length;n++)if(Qt(t[n]))return n;return t.length}(r):0;let s=!1;for(let a=0;a<n.length;a++){const l=n[a];if("number"!=typeof l){if(!s)if(4&i){if(i=2|1&i,""!==l&&!Na(t,l,e)||""===l&&1===n.length){if(tl(i))return!1;s=!0}}else if(8&i){if(null===r||!m_(t,r,l,e)){if(tl(i))return!1;s=!0}}else{const u=n[++a],f=Wd(l,r,__(t),e);if(-1===f){if(tl(i))return!1;s=!0;continue}if(""!==u){let g;if(g=f>o?"":r[f+1].toLowerCase(),2&i&&u!==g){if(tl(i))return!1;s=!0}}}}else{if(!s&&!tl(i)&&!tl(l))return!1;if(s&&tl(l))continue;s=!1,i=l|1&i}}return tl(i)||s}function tl(t){return!(1&t)}function Wd(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let o=!1;for(;r<n.length;){const s=n[r];if(s===t)return r;if(3===s||6===s)o=!0;else{if(1===s||2===s){let a=n[++r];for(;"string"==typeof a;)a=n[++r];continue}if(4===s)break;if(0===s){r+=4;continue}}r+=o?1:2}return-1}return function gw(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function df(t,n,e=!1){for(let i=0;i<n.length;i++)if(Hp(t,n[i],e))return!0;return!1}function Ev(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function hf(t,n){return t?":not("+n.trim()+")":n}function mw(t){let n=t[0],e=1,i=2,r="",o=!1;for(;e<t.length;){let s=t[e];if("string"==typeof s)if(2&i){const a=t[++e];r+="["+s+(a.length>0?'="'+a+'"':"")+"]"}else 8&i?r+="."+s:4&i&&(r+=" "+s);else""!==r&&!tl(s)&&(n+=hf(o,r),r=""),i=s,o=o||!tl(i);e++}return""!==r&&(n+=hf(o,r)),n}function xn(t){return Go(()=>{const n=Tv(t),e={...n,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Up.OnPush,directiveDefs:null,pipeDefs:null,dependencies:n.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Ws.Emulated,styles:t.styles||Ti,_:null,schemas:t.schemas||null,tView:null,id:""};Iv(e);const i=t.dependencies;return e.directiveDefs=jp(i,!1),e.pipeDefs=jp(i,!0),e.id=function Wp(t){let n=0;const e=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const r of e)n=Math.imul(31,n)+r.charCodeAt(0)|0;return n+=2147483648,"c"+n}(e),e})}function Kc(t){return Xn(t)||uo(t)}function Vp(t){return null!==t}function Ra(t){return Go(()=>({type:t.type,bootstrap:t.bootstrap||Ti,declarations:t.declarations||Ti,imports:t.imports||Ti,exports:t.exports||Ti,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function ff(t,n){if(null==t)return lo;const e={};for(const i in t)if(t.hasOwnProperty(i)){const r=t[i];let o,s,a=ae.None;Array.isArray(r)?(a=r[0],o=r[1],s=r[2]??o):(o=r,s=r),n?(e[o]=a!==ae.None?[i,a]:i,n[o]=s):e[o]=i}return e}function wn(t){return Go(()=>{const n=Tv(t);return Iv(n),n})}function rs(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function Xn(t){return t[Kr]||null}function uo(t){return t[kp]||null}function Qr(t){return t[Nu]||null}function Tv(t){const n={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:n,inputTransforms:null,inputConfig:t.inputs||lo,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||Ti,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ff(t.inputs,n),outputs:ff(t.outputs),debugInfo:null}}function Iv(t){t.features?.forEach(n=>n(t))}function jp(t,n){if(!t)return null;const e=n?Qr:Kc;return()=>("function"==typeof t?t():t).map(i=>e(i)).filter(Vp)}function vw(...t){return{\u0275providers:$p(0,t),\u0275fromNgModule:!0}}function $p(t,...n){const e=[],i=new Set;let r;const o=s=>{e.push(s)};return Vd(n,s=>{const a=s;Yp(a,o,[],i)&&(r||=[],r.push(a))}),void 0!==r&&Sv(r,o),e}function Sv(t,n){for(let e=0;e<t.length;e++){const{ngModule:i,providers:r}=t[e];Fo(r,o=>{n(o,i)})}}function Yp(t,n,e,i){if(!(t=V(t)))return!1;let r=null,o=Ap(t);const s=!o&&Xn(t);if(o||s){if(s&&!s.standalone)return!1;r=t}else{const l=t.ngModule;if(o=Ap(l),!o)return!1;r=l}const a=i.has(r);if(s){if(a)return!1;if(i.add(r),s.dependencies){const l="function"==typeof s.dependencies?s.dependencies():s.dependencies;for(const u of l)Yp(u,n,e,i)}}else{if(!o)return!1;{if(null!=o.imports&&!a){let u;i.add(r);try{Vd(o.imports,f=>{Yp(f,n,e,i)&&(u||=[],u.push(f))})}finally{}void 0!==u&&Sv(u,n)}if(!a){const u=Uu(r)||(()=>new r);n({provide:r,useFactory:u,deps:Ti},r),n({provide:g_,useValue:r,multi:!0},r),n({provide:Gd,useValue:()=>kn(r),multi:!0},r)}const l=o.providers;if(null!=l&&!a){const u=t;Fo(l,f=>{n(f,u)})}}}return r!==t&&void 0!==t.providers}function Fo(t,n){for(let e of t)o_(e)&&(e=e.\u0275providers),Array.isArray(e)?Fo(e,n):n(e)}const yw=di({provide:String,useValue:di});function b_(t){return null!==t&&"object"==typeof t&&yw in t}function bc(t){return"function"==typeof t}const gf=new hn(""),vc={},mf={};let ju;function Gu(){return void 0===ju&&(ju=new Bp),ju}class Cs{}class $d extends Cs{get destroyed(){return this._destroyed}constructor(n,e,i,r){super(),this.parent=e,this.source=i,this.scopes=r,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Qc(n,s=>this.processProvider(s)),this.records.set(wv,yc(void 0,this)),r.has("environment")&&this.records.set(Cs,yc(void 0,this));const o=this.records.get(gf);null!=o&&"string"==typeof o.value&&this.scopes.add(o.value),this.injectorDefTypes=new Set(this.get(g_,Ti,mi.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;const n=W(null);try{for(const i of this._ngOnDestroyHooks)i.ngOnDestroy();const e=this._onDestroyHooks;this._onDestroyHooks=[];for(const i of e)i()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),W(n)}}onDestroy(n){return this.assertNotDestroyed(),this._onDestroyHooks.push(n),()=>this.removeOnDestroy(n)}runInContext(n){this.assertNotDestroyed();const e=Xc(this),i=Wo(void 0);try{return n()}finally{Xc(e),Wo(i)}}get(n,e=Lu,i=mi.Default){if(this.assertNotDestroyed(),n.hasOwnProperty(a_))return n[a_](this);i=lf(i);const o=Xc(this),s=Wo(void 0);try{if(!(i&mi.SkipSelf)){let l=this.records.get(n);if(void 0===l){const u=function z(t){return"function"==typeof t||"object"==typeof t&&t instanceof hn}(n)&&af(n);l=u&&this.injectableDefInScope(u)?yc(y_(n),vc):null,this.records.set(n,l)}if(null!=l)return this.hydrate(n,l)}return(i&mi.Self?Gu():this.parent).get(n,e=i&mi.Optional&&e===Lu?null:e)}catch(a){if("NullInjectorError"===a.name){if((a[Hd]=a[Hd]||[]).unshift(Si(n)),o)throw a;return function fw(t,n,e,i){const r=t[Hd];throw n[c_]&&r.unshift(n[c_]),t.message=function vv(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let r=Si(n);if(Array.isArray(n))r=n.map(Si).join(" -> ");else if("object"==typeof n){let o=[];for(let s in n)if(n.hasOwnProperty(s)){let a=n[s];o.push(s+":"+("string"==typeof a?JSON.stringify(a):Si(a)))}r=`{${o.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(dw,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[Hd]=null,t}(a,n,"R3InjectorError",this.source)}throw a}finally{Wo(s),Xc(o)}}resolveInjectorInitializers(){const n=W(null),e=Xc(this),i=Wo(void 0);try{const o=this.get(Gd,Ti,mi.Self);for(const s of o)s()}finally{Xc(e),Wo(i),W(n)}}toString(){const n=[],e=this.records;for(const i of e.keys())n.push(Si(i));return`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new it(205,!1)}processProvider(n){let e=bc(n=V(n))?n:V(n&&n.provide);const i=function xw(t){return b_(t)?yc(void 0,t.useValue):yc(Dv(t),vc)}(n);if(!bc(n)&&!0===n.multi){let r=this.records.get(e);r||(r=yc(void 0,vc,!0),r.factory=()=>u_(r.multi),this.records.set(e,r)),e=n,r.multi.push(n)}this.records.set(e,i)}hydrate(n,e){const i=W(null);try{return e.value===vc&&(e.value=mf,e.value=e.factory()),"object"==typeof e.value&&e.value&&function Ov(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this._ngOnDestroyHooks.add(e.value),e.value}finally{W(i)}}injectableDefInScope(n){if(!n.providedIn)return!1;const e=V(n.providedIn);return"string"==typeof e?"any"===e||this.scopes.has(e):this.injectorDefTypes.has(e)}removeOnDestroy(n){const e=this._onDestroyHooks.indexOf(n);-1!==e&&this._onDestroyHooks.splice(e,1)}}function y_(t){const n=af(t),e=null!==n?n.factory:Uu(t);if(null!==e)return e;if(t instanceof hn)throw new it(204,!1);if(t instanceof Function)return function Cw(t){if(t.length>0)throw new it(204,!1);const e=function rw(t){return t&&(t[Ud]||t[gv])||null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new it(204,!1)}function Dv(t,n,e){let i;if(bc(t)){const r=V(t);return Uu(r)||y_(r)}if(b_(t))i=()=>V(t.useValue);else if(function Mv(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...u_(t.deps||[]));else if(function v_(t){return!(!t||!t.useExisting)}(t))i=()=>kn(V(t.useExisting));else{const r=V(t&&(t.useClass||t.provide));if(!function _f(t){return!!t.deps}(t))return Uu(r)||y_(r);i=()=>new r(...u_(t.deps))}return i}function yc(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function Qc(t,n){for(const e of t)Array.isArray(e)?Qc(e,n):e&&o_(e)?Qc(e.\u0275providers,n):n(e)}const ki=0,Ot=1,fn=2,Jr=3,nl=4,os=5,bo=6,qd=7,cr=8,Hi=9,il=10,Pn=11,yf=12,kv=13,Zd=14,vr=15,Xd=16,Kd=17,xc=18,Wu=19,Qd=20,rl=21,Zp=22,Jc=23,Un=25,ol=1,ss=7,Jd=9,jr=10;var Xp=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}(Xp||{});function ho(t){return Array.isArray(t)&&"object"==typeof t[ol]}function Pr(t){return Array.isArray(t)&&!0===t[ol]}function Kp(t){return!!(4&t.flags)}function Yu(t){return t.componentOffset>-1}function qu(t){return!(1&~t.flags)}function sl(t){return!!t.template}function Qp(t){return!!(512&t[fn])}class Fw{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Lv(t,n,e,i){null!==n?n.applyValueToInputSignal(n,i):t[e]=i}function mr(){return E_}function E_(t){return t.type.prototype.ngOnChanges&&(t.setInput=Nw),T_}function T_(){const t=I_(this),n=t?.current;if(n){const e=t.previous;if(e===lo)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function Nw(t,n,e,i,r){const o=this.declaredInputs[i],s=I_(t)||function Bv(t,n){return t[tg]=n}(t,{previous:lo,current:null}),a=s.current||(s.current={}),l=s.previous,u=l[o];a[o]=new Fw(u&&u.currentValue,e,l===lo),Lv(t,n,r,e)}mr.ngInherit=!0;const tg="__ngSimpleChanges__";function I_(t){return t[tg]||null}const Ul=function(t,n,e){},S_="svg";let Uv=!1;function zi(t){for(;Array.isArray(t);)t=t[ki];return t}function Zu(t,n){return zi(n[t])}function ws(t,n){return zi(n[t.index])}function Wn(t,n){return t.data[n]}function ih(t,n){return t[n]}function ca(t,n){const e=n[t];return ho(e)?e:e[ki]}function og(t){return!(128&~t[fn])}function Hl(t,n){return null==n?null:t[n]}function ua(t){t[Kd]=0}function Lw(t){1024&t[fn]||(t[fn]|=1024,og(t)&&rh(t))}function wf(t){return!!(9216&t[fn]||t[Jc]?.dirty)}function sg(t){t[il].changeDetectionScheduler?.notify(1),wf(t)?rh(t):64&t[fn]&&(function Hv(){return Uv}()?(t[fn]|=1024,rh(t)):t[il].changeDetectionScheduler?.notify())}function rh(t){t[il].changeDetectionScheduler?.notify();let n=wc(t);for(;null!==n&&!(8192&n[fn])&&(n[fn]|=8192,og(n));)n=wc(n)}function as(t,n){if(!(256&~t[fn]))throw new it(911,!1);null===t[rl]&&(t[rl]=[]),t[rl].push(n)}function wc(t){const n=t[Jr];return Pr(n)?n[Jr]:n}const Mn={lFrame:Sf(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function ag(){return Mn.bindingsEnabled}function da(){return null!==Mn.skipHydrationRootTNode}function st(){return Mn.lFrame.lView}function hi(){return Mn.lFrame.tView}function O(t){return Mn.lFrame.contextLView=t,t[cr]}function D(t){return Mn.lFrame.contextLView=null,t}function Vi(){let t=Gv();for(;null!==t&&64===t.type;)t=t.parent;return t}function Gv(){return Mn.lFrame.currentTNode}function ll(t,n){const e=Mn.lFrame;e.currentTNode=t,e.isParent=n}function ls(){return Mn.lFrame.isParent}function La(){Mn.lFrame.isParent=!1}function fo(){const t=Mn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Vl(){return Mn.lFrame.bindingIndex}function cl(){return Mn.lFrame.bindingIndex++}function jl(t){const n=Mn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function zw(t,n){const e=Mn.lFrame;e.bindingIndex=e.bindingRootIndex=t,lg(n)}function lg(t){Mn.lFrame.currentDirectiveIndex=t}function cg(){return Mn.lFrame.currentQueryIndex}function Xu(t){Mn.lFrame.currentQueryIndex=t}function F_(t){const n=t[Ot];return 2===n.type?n.declTNode:1===n.type?t[os]:null}function If(t,n,e){if(e&mi.SkipSelf){let r=n,o=t;for(;!(r=r.parent,null!==r||e&mi.Host||(r=F_(o),null===r||(o=o[Zd],10&r.type))););if(null===r)return!1;n=r,t=o}const i=Mn.lFrame=R_();return i.currentTNode=n,i.lView=t,!0}function N_(t){const n=R_(),e=t[Ot];Mn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function R_(){const t=Mn.lFrame,n=null===t?null:t.child;return null===n?Sf(t):n}function Sf(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function L_(){const t=Mn.lFrame;return Mn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const ug=L_;function B_(){const t=L_();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function yr(){return Mn.lFrame.selectedIndex}function tu(t){Mn.lFrame.selectedIndex=t}function er(){const t=Mn.lFrame;return Wn(t.tView,t.selectedIndex)}function nu(){Mn.lFrame.currentNamespace=S_}let dg=!0;function Ku(){return dg}function Ba(t){dg=t}function Ec(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const o=t.data[e].type.prototype,{ngAfterContentInit:s,ngAfterContentChecked:a,ngAfterViewInit:l,ngAfterViewChecked:u,ngOnDestroy:f}=o;s&&(t.contentHooks??=[]).push(-e,s),a&&((t.contentHooks??=[]).push(e,a),(t.contentCheckHooks??=[]).push(e,a)),l&&(t.viewHooks??=[]).push(-e,l),u&&((t.viewHooks??=[]).push(e,u),(t.viewCheckHooks??=[]).push(e,u)),null!=f&&(t.destroyHooks??=[]).push(e,f)}}function bn(t,n,e){iu(t,n,3,e)}function Qu(t,n,e,i){(3&t[fn])===e&&iu(t,n,e,i)}function Mf(t,n){let e=t[fn];(3&e)===n&&(e&=16383,e+=1,t[fn]=e)}function iu(t,n,e,i){const o=i??-1,s=n.length-1;let a=0;for(let l=void 0!==i?65535&t[Kd]:0;l<s;l++)if("number"==typeof n[l+1]){if(a=n[l],null!=i&&a>=i)break}else n[l]<0&&(t[Kd]+=65536),(a<o||-1==o)&&(U_(t,e,n,l),t[Kd]=(4294901760&t[Kd])+l+2),l++}function qv(t,n){Ul(4,t,n);const e=W(null);try{n.call(t)}finally{W(e),Ul(5,t,n)}}function U_(t,n,e,i){const r=e[i]<0,o=e[i+1],a=t[r?-e[i]:e[i]];r?t[fn]>>14<t[Kd]>>16&&(3&t[fn])===n&&(t[fn]+=16384,qv(a,o)):qv(a,o)}const Ju=-1;class po{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function z_(t){return t!==Ju}function ha(t){return 32767&t}function ed(t,n){let e=function Es(t){return t>>16}(t),i=n;for(;e>0;)i=i[Zd],e--;return i}let V_=!0;function ch(t){const n=V_;return V_=t,n}const Kv=255,uh=5;let Qv=0;const ul={};function fg(t,n){const e=Jv(t,n);if(-1!==e)return e;const i=n[Ot];i.firstCreatePass&&(t.injectorIndex=n.length,j_(i.data,t),j_(n,null),j_(i.blueprint,null));const r=Df(t,n),o=t.injectorIndex;if(z_(r)){const s=ha(r),a=ed(r,n),l=a[Ot].data;for(let u=0;u<8;u++)n[o+u]=a[s+u]|l[s+u]}return n[o+8]=r,o}function j_(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Jv(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Df(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){if(i=n1(r),null===i)return Ju;if(e++,r=r[Zd],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return Ju}function pg(t,n,e){!function $w(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(ns)&&(i=e[ns]),null==i&&(i=e[ns]=Qv++);const r=i&Kv;n.data[t+(r>>uh)]|=1<<r}(t,n,e)}function gg(t,n,e){if(e&mi.Optional||void 0!==t)return t;js()}function G_(t,n,e,i){if(e&mi.Optional&&void 0===i&&(i=null),!(e&(mi.Self|mi.Host))){const r=t[Hi],o=Wo(void 0);try{return r?r.get(n,i,e&mi.Optional):Fp(n,i,e&mi.Optional)}finally{Wo(o)}}return gg(i,0,e)}function dh(t,n,e,i=mi.Default,r){if(null!==t){if(2048&n[fn]&&!(i&mi.Self)){const s=function Zw(t,n,e,i,r){let o=t,s=n;for(;null!==o&&null!==s&&2048&s[fn]&&!(512&s[fn]);){const a=mg(o,s,e,i|mi.Self,ul);if(a!==ul)return a;let l=o.parent;if(!l){const u=s[Qd];if(u){const f=u.get(e,ul,i);if(f!==ul)return f}l=n1(s),s=s[Zd]}o=l}return r}(t,n,e,i,ul);if(s!==ul)return s}const o=mg(t,n,e,i,ul);if(o!==ul)return o}return G_(n,e,i,r)}function mg(t,n,e,i,r){const o=function t1(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(ns)?t[ns]:void 0;return"number"==typeof n?n>=0?n&Kv:qw:n}(e);if("function"==typeof o){if(!If(n,t,i))return i&mi.Host?gg(r,0,i):G_(n,e,i,r);try{let s;if(s=o(i),null!=s||i&mi.Optional)return s;js()}finally{ug()}}else if("number"==typeof o){let s=null,a=Jv(t,n),l=Ju,u=i&mi.Host?n[vr][os]:null;for((-1===a||i&mi.SkipSelf)&&(l=-1===a?Df(t,n):n[a+8],l!==Ju&&ru(i,!1)?(s=n[Ot],a=ha(l),n=ed(l,n)):a=-1);-1!==a;){const f=n[Ot];if(dl(o,a,f.data)){const g=e1(a,n,e,s,i,u);if(g!==ul)return g}l=n[a+8],l!==Ju&&ru(i,n[Ot].data[a+8]===u)&&dl(o,a,n)?(s=f,a=ha(l),n=ed(l,n)):a=-1}}return r}function e1(t,n,e,i,r,o){const s=n[Ot],a=s.data[t+8],f=Of(a,s,e,null==i?Yu(a)&&V_:i!=s&&!!(3&a.type),r&mi.Host&&o===a);return null!==f?Wl(n,s,f,a):ul}function Of(t,n,e,i,r){const o=t.providerIndexes,s=n.data,a=1048575&o,l=t.directiveStart,f=o>>20,v=r?a+f:t.directiveEnd;for(let C=i?a:a+f;C<v;C++){const E=s[C];if(C<l&&e===E||C>=l&&E.type===e)return C}if(r){const C=s[l];if(C&&sl(C)&&C.type===e)return l}return null}function Wl(t,n,e,i){let r=t[e];const o=n.data;if(function Gw(t){return t instanceof po}(r)){const s=r;s.resolving&&function _v(t,n){throw n&&n.join(" > "),new it(-200,t)}(function Ai(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Nn(t)}(o[e]));const a=ch(s.canSeeViewProviders);s.resolving=!0;const u=s.injectImpl?Wo(s.injectImpl):null;If(t,i,mi.Default);try{r=t[e]=s.factory(void 0,o,t,i),n.firstCreatePass&&e>=i.directiveStart&&function hg(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:o}=n.type.prototype;if(i){const s=E_(n);(e.preOrderHooks??=[]).push(t,s),(e.preOrderCheckHooks??=[]).push(t,s)}r&&(e.preOrderHooks??=[]).push(0-t,r),o&&((e.preOrderHooks??=[]).push(t,o),(e.preOrderCheckHooks??=[]).push(t,o))}(e,o[e],n)}finally{null!==u&&Wo(u),ch(a),s.resolving=!1,ug()}}return r}function dl(t,n,e){return!!(e[n+(t>>uh)]&1<<t)}function ru(t,n){return!(t&mi.Self||t&mi.Host&&n)}class vo{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return dh(this._tNode,this._lView,n,lf(i),e)}}function qw(){return new vo(Vi(),st())}function cs(t){return Go(()=>{const n=t.prototype.constructor,e=n[el]||W_(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const o=r[el]||W_(r);if(o&&o!==e)return o;r=Object.getPrototypeOf(r)}return o=>new o})}function W_(t){return we(t)?()=>{const n=W_(V(t));return n&&n()}:Uu(t)}function n1(t){const n=t[Ot],e=n.type;return 2===e?n.declTNode:1===e?t[os]:null}function a1(t,n=null,e=null,i){const r=l1(t,n,e,i);return r.resolveInjectorInitializers(),r}function l1(t,n=null,e=null,i,r=new Set){const o=[e||Ti,vw(t)];return i=i||("object"==typeof t?void 0:Si(t)),new $d(o,n||Gu(),i||null,r)}let Ts=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=Lu;static#t=this.NULL=new Bp;static create(e,i){if(Array.isArray(e))return a1({name:""},i,e,"");{const r=e.name??"";return a1({name:r},e.parent,e.providers,r)}}static#n=this.\u0275prov=Wt({token:t,providedIn:"any",factory:()=>kn(wv)});static#i=this.__NG_ELEMENT_ID__=-1}return t})();function Z_(t){return t.ngOriginalError}class fl{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n);this._console.error("ERROR",n),e&&this._console.error("ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&Z_(n);for(;e&&Z_(e);)e=Z_(e);return e||null}}const u1=new hn("",{providedIn:"root",factory:()=>En(fl).handleError.bind(void 0)});let fh=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=nE;static#t=this.__NG_ENV_ID__=e=>e}return t})();class tE extends fh{constructor(n){super(),this._lView=n}onDestroy(n){return as(this._lView,n),()=>function zl(t,n){if(null===t[rl])return;const e=t[rl].indexOf(n);-1!==e&&t[rl].splice(e,1)}(this._lView,n)}}function nE(){return new tE(st())}function iE(){return ph(Vi(),st())}function ph(t,n){return new _r(ws(t,n))}let _r=(()=>{class t{constructor(e){this.nativeElement=e}static#e=this.__NG_ELEMENT_ID__=iE}return t})();function d1(t){return t instanceof _r?t.nativeElement:t}function X_(t){return n=>{setTimeout(t,void 0,n)}}const Qn=class rE extends ra{constructor(n=!1){super(),this.destroyRef=void 0,this.__isAsync=n,function la(){return void 0!==gc()||null!=function zd(){return mc}()}()&&(this.destroyRef=En(fh,{optional:!0})??void 0)}emit(n){const e=W(null);try{super.next(n)}finally{W(e)}}subscribe(n,e,i){let r=n,o=e||(()=>null),s=i;if(n&&"object"==typeof n){const l=n;r=l.next?.bind(l),o=l.error?.bind(l),s=l.complete?.bind(l)}this.__isAsync&&(o=X_(o),r&&(r=X_(r)),s&&(s=X_(s)));const a=super.subscribe({next:r,error:o,complete:s});return n instanceof qn&&n.add(a),a}};function oE(){return this._results[Symbol.iterator]()}class K_{static#e=Symbol.iterator;get changes(){return this._changes??=new Qn}constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._onDirty=void 0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const e=K_.prototype;e[Symbol.iterator]||(e[Symbol.iterator]=oE)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){this.dirty=!1;const i=function Gs(t){return t.flat(Number.POSITIVE_INFINITY)}(n);(this._changesDetected=!function pw(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],o=n[i];if(e&&(r=e(r),o=e(o)),o!==r)return!1}return!0}(this._results,i,e))&&(this._results=i,this.length=i.length,this.last=i[this.length-1],this.first=i[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}onDirty(n){this._onDirty=n}setDirty(){this.dirty=!0,this._onDirty?.()}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}function yg(t){return!(128&~t.flags)}const kf=new Map;let p1=0;const xg="__ngContext__";function us(t,n){ho(n)?(t[xg]=n[Wu],function lE(t){kf.set(t[Wu],t)}(n)):t[xg]=n}function x1(t){return E1(t[yf])}function w1(t){return E1(t[nl])}function E1(t){for(;null!==t&&!Pr(t);)t=t[nl];return t}let t0;function pl(){if(void 0!==t0)return t0;if(typeof document<"u")return document;throw new it(210,!1)}const Tg=new hn("",{providedIn:"root",factory:()=>O1}),O1="ng",n0=new hn(""),gl=new hn("",{providedIn:"platform",factory:()=>"unknown"}),r0=new hn(""),Ig=new hn("",{providedIn:"root",factory:()=>pl().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let k1=()=>null;function d0(t,n,e=!1){return k1(t,n,e)}const f0=new hn("",{providedIn:"root",factory:()=>!1});let Pg,cu;function mh(t){return function p0(){if(void 0===Pg&&(Pg=null,si.trustedTypes))try{Pg=si.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Pg}()?.createHTML(t)||t}function F1(t){return function Lf(){if(void 0===cu&&(cu=null,si.trustedTypes))try{cu=si.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return cu}()?.createHTML(t)||t}class yo{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Pu})`}}class _h extends yo{getTypeName(){return"HTML"}}class NE extends yo{getTypeName(){return"Style"}}class RE extends yo{getTypeName(){return"Script"}}class LE extends yo{getTypeName(){return"URL"}}class BE extends yo{getTypeName(){return"ResourceURL"}}function fa(t){return t instanceof yo?t.changingThisBreaksApplicationSecurity:t}function _l(t,n){const e=function Tc(t){return t instanceof yo&&t.getTypeName()||null}(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see ${Pu})`)}return e===n}class HE{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(mh(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch{return null}}}class L1{constructor(n){this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert")}getInertBodyElement(n){const e=this.inertDocument.createElement("template");return e.innerHTML=mh(n),e}}const zE=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;function Ng(t){return(t=String(t)).match(zE)?t:"unsafe:"+t}function Ic(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Uf(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const B1=Ic("area,br,col,hr,img,wbr"),U1=Ic("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),H1=Ic("rp,rt"),m0=Uf(B1,Uf(U1,Ic("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Uf(H1,Ic("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Uf(H1,U1)),_0=Ic("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),V1=Uf(_0,Ic("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,srcset,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Ic("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),b0=Ic("script,style,template");class VE{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0,r=[];for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)r.push(e),e=Ro(e);else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let o=GE(e);if(o){e=o;break}e=r.pop()}return this.buf.join("")}startElement(n){const e=Is(n).toLowerCase();if(!m0.hasOwnProperty(e))return this.sanitizedSomething=!0,!b0.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const o=i.item(r),s=o.name,a=s.toLowerCase();if(!V1.hasOwnProperty(a)){this.sanitizedSomething=!0;continue}let l=o.value;_0[a]&&(l=Ng(l)),this.buf.push(" ",s,'="',v0(l),'"')}return this.buf.push(">"),!0}endElement(n){const e=Is(n).toLowerCase();m0.hasOwnProperty(e)&&!B1.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(v0(n))}}function GE(t){const n=t.nextSibling;if(n&&t!==n.previousSibling)throw j1(n);return n}function Ro(t){const n=t.firstChild;if(n&&function jE(t,n){return(t.compareDocumentPosition(n)&Node.DOCUMENT_POSITION_CONTAINED_BY)!==Node.DOCUMENT_POSITION_CONTAINED_BY}(t,n))throw j1(n);return n}function Is(t){const n=t.nodeName;return"string"==typeof n?n:"FORM"}function j1(t){return new Error(`Failed to sanitize html because the element is clobbered: ${t.outerHTML}`)}const WE=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,$E=/([^\#-~ |!])/g;function v0(t){return t.replace(/&/g,"&amp;").replace(WE,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace($E,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Rg;function G1(t,n){let e=null;try{Rg=Rg||function Ri(t){const n=new L1(t);return function Fg(){try{return!!(new window.DOMParser).parseFromString(mh(""),"text/html")}catch{return!1}}()?new HE(n):n}(t);let i=n?String(n):"";e=Rg.getInertBodyElement(i);let r=5,o=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=o,o=e.innerHTML,e=Rg.getInertBodyElement(i)}while(i!==o);return mh((new VE).sanitizeChildren(y0(e)||e))}finally{if(e){const i=y0(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function y0(t){return"content"in t&&function W1(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Ha=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(Ha||{});function eo(t){const n=Hf();return n?F1(n.sanitize(Ha.HTML,t)||""):_l(t,"HTML")?F1(fa(t)):G1(pl(),Nn(t))}function gn(t){const n=Hf();return n?n.sanitize(Ha.URL,t)||"":_l(t,"URL")?fa(t):Ng(Nn(t))}function Hf(){const t=st();return t&&t[il].sanitizer}const QE=/^>|^->|<!--|-->|--!>|<!-$/g,JE=/(<|>)/g,$1="\u200b$1\u200b";function zf(t){return t.ownerDocument}var to=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(to||{});let Vf;function S0(t,n){return Vf(t,n)}function yh(t,n,e,i,r){if(null!=i){let o,s=!1;Pr(i)?o=i:ho(i)&&(s=!0,i=i[ki]);const a=zi(i);0===t&&null!==e?null==r?iy(n,e,a):rd(n,e,a,r||null,!0):1===t&&null!==e?rd(n,e,a,r||null,!0):2===t?function $f(t,n,e){const i=Hg(t,n);i&&function m2(t,n,e,i){t.removeChild(n,e,i)}(t,i,n,e)}(n,a,s):3===t&&n.destroyNode(a),null!=o&&function Y(t,n,e,i,r){const o=e[ss];o!==zi(e)&&yh(n,t,i,o,r);for(let a=jr;a<e.length;a++){const l=e[a];b(l[Ot],l,t,n,i,o)}}(n,t,o,e,r)}}function D0(t,n){return t.createComment(function x0(t){return t.replace(QE,n=>n.replace(JE,$1))}(n))}function Ch(t,n,e){return t.createElement(n,e)}function J1(t,n){n[il].changeDetectionScheduler?.notify(1),b(t,n,n[Pn],2,null,null)}function ty(t,n){const e=t[Jd],i=e.indexOf(n);e.splice(i,1)}function jf(t,n){if(t.length<=jr)return;const e=jr+n,i=t[e];if(i){const r=i[Xd];null!==r&&r!==t&&ty(r,i),n>0&&(t[e-1][nl]=i[nl]);const o=_c(t,jr+n);!function u2(t,n){J1(t,n),n[ki]=null,n[os]=null}(i[Ot],i);const s=o[xc];null!==s&&s.detachView(o[Ot]),i[Jr]=null,i[nl]=null,i[fn]&=-129}return i}function xh(t,n){if(!(256&n[fn])){const e=n[Pn];e.destroyNode&&b(t,n,e,3,null,null),function h2(t){let n=t[yf];if(!n)return Gf(t[Ot],t);for(;n;){let e=null;if(ho(n))e=n[yf];else{const i=n[jr];i&&(e=i)}if(!e){for(;n&&!n[nl]&&n!==t;)ho(n)&&Gf(n[Ot],n),n=n[Jr];null===n&&(n=t),ho(n)&&Gf(n[Ot],n),e=n&&n[nl]}n=e}}(n)}}function Gf(t,n){if(256&n[fn])return;const e=W(null);try{n[fn]&=-129,n[fn]|=256,n[Jc]&&function qe(t){if(Gt(t),Tt(t))for(let n=0;n<t.producerNode.length;n++)Ee(t.producerNode[n],t.producerIndexOfThis[n]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}(n[Jc]),function g2(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof po)){const o=e[i+1];if(Array.isArray(o))for(let s=0;s<o.length;s+=2){const a=r[o[s]],l=o[s+1];Ul(4,a,l);try{l.call(a)}finally{Ul(5,a,l)}}else{Ul(4,r,o);try{o.call(r)}finally{Ul(5,r,o)}}}}}(t,n),function p2(t,n){const e=t.cleanup,i=n[qd];if(null!==e)for(let o=0;o<e.length-1;o+=2)if("string"==typeof e[o]){const s=e[o+3];s>=0?i[s]():i[-s].unsubscribe(),o+=2}else e[o].call(i[e[o+1]]);null!==i&&(n[qd]=null);const r=n[rl];if(null!==r){n[rl]=null;for(let o=0;o<r.length;o++)(0,r[o])()}}(t,n),1===n[Ot].type&&n[Pn].destroy();const i=n[Xd];if(null!==i&&Pr(n[Jr])){i!==n[Jr]&&ty(i,n);const r=n[xc];null!==r&&r.detachView(t)}!function cE(t){kf.delete(t[Wu])}(n)}finally{W(e)}}function O0(t,n,e){return function ny(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[ki];{const{componentOffset:r}=i;if(r>-1){const{encapsulation:o}=t.data[i.directiveStart+r];if(o===Ws.None||o===Ws.Emulated)return null}return ws(i,e)}}(t,n.parent,e)}function rd(t,n,e,i,r){t.insertBefore(n,e,i,r)}function iy(t,n,e){t.appendChild(n,e)}function ry(t,n,e,i,r){null!==i?rd(t,n,e,i,r):iy(t,n,e)}function Hg(t,n){return t.parentNode(n)}function oy(t,n,e){return ay(t,n,e)}let A0,ay=function sy(t,n,e){return 40&t.type?ws(t,e):null};function zg(t,n,e,i){const r=O0(t,i,n),o=n[Pn],a=oy(i.parent||n[os],i,n);if(null!=r)if(Array.isArray(e))for(let l=0;l<e.length;l++)ry(o,r,e[l],a,!1);else ry(o,r,e,a,!1);void 0!==A0&&A0(o,i,n,e,r)}function Wf(t,n){if(null!==n){const e=n.type;if(3&e)return ws(n,t);if(4&e)return k0(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Wf(t,i);{const r=t[n.index];return Pr(r)?k0(-1,r):zi(r)}}if(32&e)return S0(n,t)()||zi(t[n.index]);{const i=cy(t,n);return null!==i?Array.isArray(i)?i[0]:Wf(wc(t[vr]),i):Wf(t,n.next)}}return null}function cy(t,n){return null!==n?t[vr][os].projection[n.projection]:null}function k0(t,n){const e=jr+t+1;if(e<n.length){const i=n[e],r=i[Ot].firstChild;if(null!==r)return Wf(i,r)}return n[ss]}function d(t,n,e,i,r,o,s){for(;null!=e;){const a=i[e.index],l=e.type;if(s&&0===n&&(a&&us(zi(a),i),e.flags|=2),32&~e.flags)if(8&l)d(t,n,e.child,i,r,o,!1),yh(n,t,r,a,o);else if(32&l){const u=S0(e,i);let f;for(;f=u();)yh(n,t,r,f,o);yh(n,t,r,a,o)}else 16&l?k(t,n,i,e,r,o):yh(n,t,r,a,o);e=s?e.projectionNext:e.next}}function b(t,n,e,i,r,o){d(e,i,t.firstChild,n,r,o,!1)}function k(t,n,e,i,r,o){const s=e[vr],l=s[os].projection[i.projection];if(Array.isArray(l))for(let u=0;u<l.length;u++)yh(n,t,r,l[u],o);else{let u=l;const f=s[Jr];yg(i)&&(u.flags|=128),d(t,n,u,f,r,o,!0)}}function Le(t,n,e){""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e)}function gt(t,n,e){const{mergedAttrs:i,classes:r,styles:o}=e;null!==i&&et(t,n,i),null!==r&&Le(t,n,r),null!==o&&function ge(t,n,e){t.setAttribute(n,"style",e)}(t,n,o)}const je={};function h(t=1){zt(hi(),st(),yr()+t,!1)}function zt(t,n,e,i){if(!i)if(3&~n[fn]){const o=t.preOrderHooks;null!==o&&Qu(n,o,0,e)}else{const o=t.preOrderCheckHooks;null!==o&&bn(n,o,e)}tu(e)}function F(t,n=mi.Default){const e=st();return null===e?kn(t,n):dh(Vi(),e,V(t),n)}function ei(t,n,e,i,r,o){const s=W(null);try{let a=null;r&ae.SignalBased&&(a=n[i][q]),null!==a&&void 0!==a.transformFn&&(o=a.transformFn(o)),r&ae.HasDecoratorInputTransform&&(o=t.inputTransforms[i].call(n,o)),null!==t.setInput?t.setInput(n,a,o,e,i):Lv(n,a,i,o)}finally{W(s)}}function ri(t,n,e,i,r,o,s,a,l,u,f){const g=n.blueprint.slice();return g[ki]=r,g[fn]=204|i,(null!==u||t&&2048&t[fn])&&(g[fn]|=2048),ua(g),g[Jr]=g[Zd]=t,g[cr]=e,g[il]=s||t&&t[il],g[Pn]=a||t&&t[Pn],g[Hi]=l||t&&t[Hi]||null,g[os]=o,g[Wu]=function aE(){return p1++}(),g[bo]=f,g[Qd]=u,g[vr]=2==n.type?t[vr]:g,g}function oi(t,n,e,i,r){let o=t.data[n];if(null===o)o=function Ms(t,n,e,i,r){const o=Gv(),s=ls(),l=t.data[n]=function NB(t,n,e,i,r,o){let s=n?n.injectorIndex:-1,a=0;return da()&&(a|=128),{type:e,index:i,insertBeforeIndex:null,injectorIndex:s,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:a,providerIndexes:0,value:r,attrs:o,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,s?o:o&&o.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=l),null!==o&&(s?null==o.child&&null!==l.parent&&(o.child=l):null===o.next&&(o.next=l,l.prev=o)),l}(t,n,e,i,r),function sh(){return Mn.lFrame.inI18n}()&&(o.flags|=32);else if(64&o.type){o.type=e,o.value=i,o.attrs=r;const s=function oh(){const t=Mn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();o.injectorIndex=null===s?-1:s.injectorIndex}return ll(o,!0),o}function Co(t,n,e,i){if(0===e)return-1;const r=n.length;for(let o=0;o<e;o++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function qs(t,n,e,i,r){const o=yr(),s=2&i;try{tu(-1),s&&n.length>Un&&zt(t,n,Un,!1),Ul(s?2:0,r),e(i,r)}finally{tu(o),Ul(s?3:1,r)}}function Nr(t,n,e){if(Kp(n)){const i=W(null);try{const o=n.directiveEnd;for(let s=n.directiveStart;s<o;s++){const a=t.data[s];a.contentQueries&&a.contentQueries(1,e[s],s)}}finally{W(i)}}}function pa(t,n,e){ag()&&(function VB(t,n,e,i){const r=e.directiveStart,o=e.directiveEnd;Yu(e)&&function ZB(t,n,e){const i=ws(n,t),r=P0(e);let s=16;e.signals?s=4096:e.onPush&&(s=64);const a=uy(t,ri(t,r,null,s,i,n,null,t[il].rendererFactory.createRenderer(i,e),null,null,null));t[n.index]=a}(n,e,t.data[r+e.componentOffset]),t.firstCreatePass||fg(e,n),us(i,n);const s=e.initialInputs;for(let a=r;a<o;a++){const l=t.data[a],u=Wl(n,t,a,e);us(u,n),null!==s&&XB(0,a-r,u,l,0,s),sl(l)&&(ca(e.index,n)[cr]=Wl(n,t,a,e))}}(t,n,e,ws(e,n)),!(64&~e.flags)&&VD(t,n,e))}function bl(t,n,e=ws){const i=n.localNames;if(null!==i){let r=n.index+1;for(let o=0;o<i.length;o+=2){const s=i[o+1],a=-1===s?e(n,t):t[s];t[r++]=a}}}function P0(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=b2(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):n}function b2(t,n,e,i,r,o,s,a,l,u,f){const g=Un+i,v=g+r,C=function DB(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:je);return e}(g,v),E="function"==typeof u?u():u;return C[Ot]={type:t,blueprint:C,template:e,queries:null,viewQuery:a,declTNode:n,data:C.slice().fill(null,g),bindingStartIndex:g,expandoStartIndex:v,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof o?o():o,pipeRegistry:"function"==typeof s?s():s,firstChild:null,schemas:l,consts:E,incompleteFirstPass:!1,ssrId:f}}let BD=()=>null;function UD(t,n,e,i,r){for(let o in n){if(!n.hasOwnProperty(o))continue;const s=n[o];if(void 0===s)continue;i??={};let a,l=ae.None;Array.isArray(s)?(a=s[0],l=s[1]):a=s;let u=o;if(null!==r){if(!r.hasOwnProperty(o))continue;u=r[o]}0===t?HD(i,e,u,a,l):HD(i,e,u,a)}return i}function HD(t,n,e,i,r){let o;t.hasOwnProperty(e)?(o=t[e]).push(n,i):o=t[e]=[n,i],void 0!==r&&o.push(r)}function Va(t,n,e,i,r,o,s,a){const l=ws(n,e);let f,u=n.inputs;!a&&null!=u&&(f=u[i])?(w2(t,e,f,i,r),Yu(n)&&function BB(t,n){const e=ca(n,t);16&e[fn]||(e[fn]|=64)}(e,n.index)):3&n.type&&(i=function LB(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=s?s(r,n.value||"",i):r,o.setProperty(l,i,r))}function v2(t,n,e,i){if(ag()){const r=null===i?null:{"":-1},o=function GB(t,n){const e=t.directiveRegistry;let i=null,r=null;if(e)for(let o=0;o<e.length;o++){const s=e[o];if(df(n,s.selectors,!1))if(i||(i=[]),sl(s))if(null!==s.findHostDirectiveDefs){const a=[];r=r||new Map,s.findHostDirectiveDefs(s,a,r),i.unshift(...a,s),y2(t,n,a.length)}else i.unshift(s),y2(t,n,0);else r=r||new Map,s.findHostDirectiveDefs?.(s,i,r),i.push(s)}return null===i?null:[i,r]}(t,e);let s,a;null===o?s=a=null:[s,a]=o,null!==s&&zD(t,n,e,s,r,a),r&&function WB(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const o=e[n[r+1]];if(null==o)throw new it(-301,!1);i.push(n[r],o)}}}(e,i,r)}e.mergedAttrs=_i(e.mergedAttrs,e.attrs)}function zD(t,n,e,i,r,o){for(let u=0;u<i.length;u++)pg(fg(e,n),t,i[u].type);!function YB(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}(e,t.data.length,i.length);for(let u=0;u<i.length;u++){const f=i[u];f.providersResolver&&f.providersResolver(f)}let s=!1,a=!1,l=Co(t,n,i.length,null);for(let u=0;u<i.length;u++){const f=i[u];e.mergedAttrs=_i(e.mergedAttrs,f.hostAttrs),qB(t,e,n,l,f),$B(l,f,r),null!==f.contentQueries&&(e.flags|=4),(null!==f.hostBindings||null!==f.hostAttrs||0!==f.hostVars)&&(e.flags|=64);const g=f.type.prototype;!s&&(g.ngOnChanges||g.ngOnInit||g.ngDoCheck)&&((t.preOrderHooks??=[]).push(e.index),s=!0),!a&&(g.ngOnChanges||g.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(e.index),a=!0),l++}!function RB(t,n,e){const r=n.directiveEnd,o=t.data,s=n.attrs,a=[];let l=null,u=null;for(let f=n.directiveStart;f<r;f++){const g=o[f],v=e?e.get(g):null,E=v?v.outputs:null;l=UD(0,g.inputs,f,l,v?v.inputs:null),u=UD(1,g.outputs,f,u,E);const w=null===l||null===s||__(n)?null:KB(l,f,s);a.push(w)}null!==l&&(l.hasOwnProperty("class")&&(n.flags|=8),l.hasOwnProperty("style")&&(n.flags|=16)),n.initialInputs=a,n.inputs=l,n.outputs=u}(t,e,o)}function VD(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,s=function Wv(){return Mn.lFrame.currentDirectiveIndex}();try{tu(o);for(let a=i;a<r;a++){const l=t.data[a],u=n[a];lg(a),(null!==l.hostBindings||0!==l.hostVars||null!==l.hostAttrs)&&jB(l,u)}}finally{tu(-1),lg(s)}}function jB(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function y2(t,n,e){n.componentOffset=e,(t.components??=[]).push(n.index)}function $B(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;sl(n)&&(e[""]=t)}}function qB(t,n,e,i,r){t.data[i]=r;const o=r.factory||(r.factory=Uu(r.type)),s=new po(o,sl(r),F);t.blueprint[i]=s,e[i]=s,function HB(t,n,e,i,r){const o=r.hostBindings;if(o){let s=t.hostBindingOpCodes;null===s&&(s=t.hostBindingOpCodes=[]);const a=~n.index;(function zB(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(s)!=a&&s.push(a),s.push(e,i,o)}}(t,n,i,Co(t,e,r.hostVars,je),r)}function uu(t,n,e,i,r,o){const s=ws(t,n);!function C2(t,n,e,i,r,o,s){if(null==o)t.removeAttribute(n,r,e);else{const a=null==s?Nn(o):s(o,i||"",r);t.setAttribute(n,r,a,e)}}(n[Pn],s,o,t.value,e,i,r)}function XB(t,n,e,i,r,o){const s=o[n];if(null!==s)for(let a=0;a<s.length;)ei(i,e,s[a++],s[a++],s[a++],s[a++])}function KB(t,n,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;if(t.hasOwnProperty(o)){null===i&&(i=[]);const s=t[o];for(let a=0;a<s.length;a+=3)if(s[a]===n){i.push(o,s[a+1],s[a+2],e[r+1]);break}}r+=2}else r+=2;else r+=4}return i}function jD(t,n,e,i){return[t,!0,0,n,null,i,null,e,null,null]}function GD(t,n){const e=t.contentQueries;if(null!==e){const i=W(null);try{for(let r=0;r<e.length;r+=2){const s=e[r+1];if(-1!==s){const a=t.data[s];Xu(e[r]),a.contentQueries(2,n[s],s)}}}finally{W(i)}}}function uy(t,n){return t[yf]?t[kv][nl]=n:t[yf]=n,t[kv]=n,n}function x2(t,n,e){Xu(0);const i=W(null);try{n(t,e)}finally{W(i)}}function WD(t){return t[qd]||(t[qd]=[])}function $D(t){return t.cleanup||(t.cleanup=[])}function dy(t,n){const e=t[Hi],i=e?e.get(fl,null):null;i&&i.handleError(n)}function w2(t,n,e,i,r){for(let o=0;o<e.length;){const s=e[o++],a=e[o++],l=e[o++];ei(t.data[s],n[s],i,a,l,r)}}function od(t,n,e){const i=Zu(n,t);!function Ug(t,n,e){t.setValue(n,e)}(t[Pn],i,e)}function QB(t,n){const e=ca(n,t),i=e[Ot];!function JB(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])}(i,e);const r=e[ki];null!==r&&null===e[bo]&&(e[bo]=d0(r,e[Hi])),E2(i,e,e[cr])}function E2(t,n,e){N_(n);try{const i=t.viewQuery;null!==i&&x2(1,i,e);const r=t.template;null!==r&&qs(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),n[xc]?.finishViewCreation(t),t.staticContentQueries&&GD(t,n),t.staticViewQueries&&x2(2,t.viewQuery,e);const o=t.components;null!==o&&function e9(t,n){for(let e=0;e<n.length;e++)QB(t,n[e])}(n,o)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[fn]&=-5,B_()}}function F0(t,n,e,i){const r=W(null);try{const o=n.tView,l=ri(t,o,e,4096&t[fn]?4096:16,null,n,null,null,i?.injector??null,i?.embeddedViewInjector??null,i?.dehydratedView??null);l[Xd]=t[n.index];const f=t[xc];return null!==f&&(l[xc]=f.createEmbeddedView(o)),E2(o,l,e),l}finally{W(r)}}function Vg(t,n){return!n||null===n.firstChild||yg(t)}function N0(t,n,e,i=!0){const r=n[Ot];if(function ey(t,n,e,i){const r=jr+i,o=e.length;i>0&&(e[r-1][nl]=n),i<o-jr?(n[nl]=e[r],Cv(e,jr+i,n)):(e.push(n),n[nl]=null),n[Jr]=e;const s=n[Xd];null!==s&&e!==s&&function f2(t,n){const e=t[Jd];n[vr]!==n[Jr][Jr][vr]&&(t[fn]|=Xp.HasTransplantedViews),null===e?t[Jd]=[n]:e.push(n)}(s,n);const a=n[xc];null!==a&&a.insertView(t),sg(n),n[fn]|=128}(r,n,t,e),i){const s=k0(e,t),a=n[Pn],l=Hg(a,t[ss]);null!==l&&function d2(t,n,e,i,r,o){i[ki]=r,i[os]=n,b(t,i,e,1,r,o)}(r,t[os],a,n,l,s)}const o=n[bo];null!==o&&null!==o.firstChild&&(o.firstChild=null)}function R0(t,n,e,i,r=!1){for(;null!==e;){const o=n[e.index];null!==o&&i.push(zi(o)),Pr(o)&&ZD(o,i);const s=e.type;if(8&s)R0(t,n,e.child,i);else if(32&s){const a=S0(e,n);let l;for(;l=a();)i.push(l)}else if(16&s){const a=cy(n,e);if(Array.isArray(a))i.push(...a);else{const l=wc(n[vr]);R0(l[Ot],l,a,i,!0)}}e=r?e.projectionNext:e.next}return i}function ZD(t,n){for(let e=jr;e<t.length;e++){const i=t[e],r=i[Ot].firstChild;null!==r&&R0(i[Ot],i,r,n)}t[ss]!==t[ki]&&n.push(t[ss])}let XD=[];const r9={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{rh(t.lView)},consumerOnSignalRead(){this.lView[Jc]=this}},KD=100;function hy(t,n=!0,e=0){const i=t[il],r=i.rendererFactory;r.begin?.();try{!function o9(t,n){I2(t,n);let e=0;for(;wf(t);){if(e===KD)throw new it(103,!1);e++,I2(t,1)}}(t,e)}catch(s){throw n&&dy(t,s),s}finally{r.end?.(),i.inlineEffectRunner?.flush()}}function s9(t,n,e,i){const r=n[fn];if(!(256&~r))return;n[il].inlineEffectRunner?.flush(),N_(n);let s=null,a=null;(function a9(t){return 2!==t.type})(t)&&(a=function t9(t){return t[Jc]??function n9(t){const n=XD.pop()??Object.create(r9);return n.lView=t,n}(t)}(n),s=function Ae(t){return t&&(t.nextProducerIndex=0),W(t)}(a));try{ua(n),function P_(t){return Mn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&qs(t,n,e,2,i);const l=!(3&~r);if(l){const g=t.preOrderCheckHooks;null!==g&&bn(n,g,null)}else{const g=t.preOrderHooks;null!==g&&Qu(n,g,0,null),Mf(n,0)}if(function l9(t){for(let n=x1(t);null!==n;n=w1(n)){if(!(n[fn]&Xp.HasTransplantedViews))continue;const e=n[Jd];for(let i=0;i<e.length;i++){Lw(e[i])}}}(n),QD(n,0),null!==t.contentQueries&&GD(t,n),l){const g=t.contentCheckHooks;null!==g&&bn(n,g)}else{const g=t.contentHooks;null!==g&&Qu(n,g,1),Mf(n,1)}!function In(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)tu(~r);else{const o=r,s=e[++i],a=e[++i];zw(s,o),a(2,n[o])}}}finally{tu(-1)}}(t,n);const u=t.components;null!==u&&eO(n,u,0);const f=t.viewQuery;if(null!==f&&x2(2,f,i),l){const g=t.viewCheckHooks;null!==g&&bn(n,g)}else{const g=t.viewHooks;null!==g&&Qu(n,g,2),Mf(n,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[Zp]){for(const g of n[Zp])g();n[Zp]=null}n[fn]&=-73}catch(l){throw rh(n),l}finally{null!==a&&(function ot(t,n){if(W(n),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(Tt(t))for(let e=t.nextProducerIndex;e<t.producerNode.length;e++)Ee(t.producerNode[e],t.producerIndexOfThis[e]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}(a,s),function i9(t){t.lView[Jc]!==t&&(t.lView=null,XD.push(t))}(a)),B_()}}function QD(t,n){for(let e=x1(t);null!==e;e=w1(e))for(let i=jr;i<e.length;i++)JD(e[i],n)}function c9(t,n,e){JD(ca(n,t),e)}function JD(t,n){og(t)&&I2(t,n)}function I2(t,n){const i=t[Ot],r=t[fn],o=t[Jc];let s=!!(0===n&&16&r);if(s||=!!(64&r&&0===n),s||=!!(1024&r),s||=!(!o?.dirty||!rt(o)),o&&(o.dirty=!1),t[fn]&=-9217,s)s9(i,t,i.template,t[cr]);else if(8192&r){QD(t,1);const a=i.components;null!==a&&eO(t,a,1)}}function eO(t,n,e){for(let i=0;i<n.length;i++)c9(t,n[i],e)}function L0(t){for(t[il].changeDetectionScheduler?.notify();t;){t[fn]|=64;const n=wc(t);if(Qp(t)&&!n)return t;t=n}return null}class B0{get rootNodes(){const n=this._lView,e=n[Ot];return R0(e,n,e.firstChild,[])}constructor(n,e,i=!0){this._lView=n,this._cdRefInjectingView=e,this.notifyErrorHandler=i,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[cr]}set context(n){this._lView[cr]=n}get destroyed(){return!(256&~this._lView[fn])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[Jr];if(Pr(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(jf(n,i),_c(e,i))}this._attachedToViewContainer=!1}xh(this._lView[Ot],this._lView)}onDestroy(n){as(this._lView,n)}markForCheck(){L0(this._cdRefInjectingView||this._lView)}detach(){this._lView[fn]&=-129}reattach(){sg(this._lView),this._lView[fn]|=128}detectChanges(){this._lView[fn]|=1024,hy(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new it(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,J1(this._lView[Ot],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new it(902,!1);this._appRef=n,sg(this._lView)}}let sd=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=h9}return t})();const u9=sd,d9=class extends u9{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(n,e){return this.createEmbeddedViewImpl(n,e)}createEmbeddedViewImpl(n,e,i){const r=F0(this._declarationLView,this._declarationTContainer,n,{embeddedViewInjector:e,dehydratedView:i});return new B0(r)}};function h9(){return fy(Vi(),st())}function fy(t,n){return 4&t.type?new d9(n,t,ph(t,n)):null}let sO=()=>null;function jg(t,n){return sO(t,n)}class by{}class R9{}class aO{}class B9{resolveComponentFactory(n){throw function L9(t){const n=Error(`No component factory found for ${Si(t)}.`);return n.ngComponent=t,n}(n)}}let vy=(()=>{class t{static#e=this.NULL=new B9}return t})();class k2{}let Yf=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function U9(){const t=st(),e=ca(Vi().index,t);return(ho(e)?e:t)[Pn]}()}return t})(),H9=(()=>{class t{static#e=this.\u0275prov=Wt({token:t,providedIn:"root",factory:()=>null})}return t})();const P2={},cO=new Set;function du(t){cO.has(t)||(cO.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function uO(...t){}class Sn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Qn(!1),this.onMicrotaskEmpty=new Qn(!1),this.onStable=new Qn(!1),this.onError=new Qn(!1),typeof Zone>"u")throw new it(908,!1);Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function z9(){const t="function"==typeof si.requestAnimationFrame;let n=si[t?"requestAnimationFrame":"setTimeout"],e=si[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&n&&e){const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function G9(t){const n=()=>{!function j9(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(si,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,N2(t),t.isCheckStableRunning=!0,F2(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),N2(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,o,s,a)=>{if(function W9(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(a))return e.invokeTask(r,o,s,a);try{return dO(t),e.invokeTask(r,o,s,a)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===o.type||t.shouldCoalesceRunChangeDetection)&&n(),hO(t)}},onInvoke:(e,i,r,o,s,a,l)=>{try{return dO(t),e.invoke(r,o,s,a,l)}finally{t.shouldCoalesceRunChangeDetection&&n(),hO(t)}},onHasTask:(e,i,r,o)=>{e.hasTask(r,o),i===r&&("microTask"==o.change?(t._hasPendingMicrotasks=o.microTask,N2(t),F2(t)):"macroTask"==o.change&&(t.hasPendingMacrotasks=o.macroTask))},onHandleError:(e,i,r,o)=>(e.handleError(r,o),t.runOutsideAngular(()=>t.onError.emit(o)),!1)})}(r)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Sn.isInAngularZone())throw new it(909,!1)}static assertNotInAngularZone(){if(Sn.isInAngularZone())throw new it(909,!1)}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const o=this._inner,s=o.scheduleEventTask("NgZoneEvent: "+r,n,V9,uO,uO);try{return o.runTask(s,e,i)}finally{o.cancelTask(s)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const V9={};function F2(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function N2(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function dO(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function hO(t){t._nesting--,F2(t)}class fO{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Qn,this.onMicrotaskEmpty=new Qn,this.onStable=new Qn,this.onError=new Qn}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}let j0=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){this.executeInternalCallbacks(),this.handler?.execute()}executeInternalCallbacks(){const e=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const i of e)i()}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=Wt({token:t,providedIn:"root",factory:()=>new t})}return t})();function Cy(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,o=0;if(null!==n)for(let s=0;s<n.length;s++){const a=n[s];"number"==typeof a?o=a:1==o?r=Zc(r,a):2==o&&(i=Zc(i,a+": "+n[++s]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}class vO extends vy{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=Xn(n);return new $0(e,this.ngModule)}}function yO(t){const n=[];for(const e in t){if(!t.hasOwnProperty(e))continue;const i=t[e];void 0!==i&&n.push({propName:Array.isArray(i)?i[0]:i,templateName:e})}return n}class xy{constructor(n,e){this.injector=n,this.parentInjector=e}get(n,e,i){i=lf(i);const r=this.injector.get(n,P2,i);return r!==P2||e===P2?r:this.parentInjector.get(n,e,i)}}class $0 extends aO{get inputs(){const n=this.componentDef,e=n.inputTransforms,i=yO(n.inputs);if(null!==e)for(const r of i)e.hasOwnProperty(r.propName)&&(r.transform=e[r.propName]);return i}get outputs(){return yO(this.componentDef.outputs)}constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function _w(t){return t.map(mw).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}create(n,e,i,r){const o=W(null);try{let s=(r=r||this.ngModule)instanceof Cs?r:r?.injector;s&&null!==this.componentDef.getStandaloneInjector&&(s=this.componentDef.getStandaloneInjector(s)||s);const a=s?new xy(n,s):n,l=a.get(k2,null);if(null===l)throw new it(407,!1);const u=a.get(H9,null),v={rendererFactory:l,sanitizer:u,inlineEffectRunner:null,afterRenderEventManager:a.get(j0,null),changeDetectionScheduler:a.get(by,null)},C=l.createRenderer(null,this.componentDef),E=this.componentDef.selectors[0][0]||"div",w=i?function OB(t,n,e,i){const o=i.get(f0,!1)||e===Ws.ShadowDom,s=t.selectRootElement(n,o);return function AB(t){BD(t)}(s),s}(C,i,this.componentDef.encapsulation,a):Ch(C,E,function K9(t){const n=t.toLowerCase();return"svg"===n?S_:"math"===n?"math":null}(E));let T=512;this.componentDef.signals?T|=4096:this.componentDef.onPush||(T|=16);let M=null;null!==w&&(M=d0(w,a,!0));const S=b2(0,null,null,1,0,null,null,null,null,null,null),P=ri(null,S,null,T,null,null,v,C,a,null,M);let Z,ee;N_(P);try{const B=this.componentDef;let J,le=null;B.findHostDirectiveDefs?(J=[],le=new Map,B.findHostDirectiveDefs(B,J,le),J.push(B)):J=[B];const se=function J9(t,n){const e=t[Ot],i=Un;return t[i]=n,oi(e,i,2,"#host",null)}(P,w),fe=function e7(t,n,e,i,r,o,s){const a=r[Ot];!function t7(t,n,e,i){for(const r of t)n.mergedAttrs=_i(n.mergedAttrs,r.hostAttrs);null!==n.mergedAttrs&&(Cy(n,n.mergedAttrs,!0),null!==e&&gt(i,e,n))}(i,t,n,s);let l=null;null!==n&&(l=d0(n,r[Hi]));const u=o.rendererFactory.createRenderer(n,e);let f=16;e.signals?f=4096:e.onPush&&(f=64);const g=ri(r,P0(e),null,f,r[t.index],t,o,u,null,null,l);return a.firstCreatePass&&y2(a,t,i.length-1),uy(r,g),r[t.index]=g}(se,w,B,J,P,v,C);ee=Wn(S,Un),w&&function i7(t,n,e,i){if(i)et(t,e,["ng-version","17.3.12"]);else{const{attrs:r,classes:o}=function bw(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let o=t[i];if("string"==typeof o)2===r?""!==o&&n.push(o,t[++i]):8===r&&e.push(o);else{if(!tl(r))break;r=o}i++}return{attrs:n,classes:e}}(n.selectors[0]);r&&et(t,e,r),o&&o.length>0&&Le(t,e,o.join(" "))}}(C,B,w,i),void 0!==e&&function r7(t,n,e){const i=t.projection=[];for(let r=0;r<n.length;r++){const o=e[r];i.push(null!=o?Array.from(o):null)}}(ee,this.ngContentSelectors,e),Z=function n7(t,n,e,i,r,o){const s=Vi(),a=r[Ot],l=ws(s,r);zD(a,r,s,e,null,i);for(let f=0;f<e.length;f++)us(Wl(r,a,s.directiveStart+f,s),r);VD(a,r,s),l&&us(l,r);const u=Wl(r,a,s.directiveStart+s.componentOffset,s);if(t[cr]=r[cr]=u,null!==o)for(const f of o)f(u,n);return Nr(a,s,r),u}(fe,B,J,le,P,[o7]),E2(S,P,null)}finally{B_()}return new Q9(this.componentType,Z,ph(ee,P),P,ee)}finally{W(o)}}}class Q9 extends R9{constructor(n,e,i,r,o){super(),this.location=i,this._rootLView=r,this._tNode=o,this.previousInputValues=null,this.instance=e,this.hostView=this.changeDetectorRef=new B0(r,void 0,!1),this.componentType=n}setInput(n,e){const i=this._tNode.inputs;let r;if(null!==i&&(r=i[n])){if(this.previousInputValues??=new Map,this.previousInputValues.has(n)&&Object.is(this.previousInputValues.get(n),e))return;const o=this._rootLView;w2(o[Ot],o,r,n,e),this.previousInputValues.set(n,e),L0(ca(this._tNode.index,o))}}get injector(){return new vo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}function o7(){const t=Vi();Ec(st()[Ot],t)}let ja=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=s7}return t})();function s7(){return wO(Vi(),st())}const a7=ja,CO=class extends a7{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return ph(this._hostTNode,this._hostLView)}get injector(){return new vo(this._hostTNode,this._hostLView)}get parentInjector(){const n=Df(this._hostTNode,this._hostLView);if(z_(n)){const e=ed(n,this._hostLView),i=ha(n);return new vo(e[Ot].data[i+8],e)}return new vo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=xO(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-jr}createEmbeddedView(n,e,i){let r,o;"number"==typeof i?r=i:null!=i&&(r=i.index,o=i.injector);const s=jg(this._lContainer,n.ssrId),a=n.createEmbeddedViewImpl(e||{},o,s);return this.insertImpl(a,r,Vg(this._hostTNode,s)),a}createComponent(n,e,i,r,o){const s=n&&!function vf(t){return"function"==typeof t}(n);let a;if(s)a=e;else{const E=e||{};a=E.index,i=E.injector,r=E.projectableNodes,o=E.environmentInjector||E.ngModuleRef}const l=s?n:new $0(Xn(n)),u=i||this.parentInjector;if(!o&&null==l.ngModule){const w=(s?u:this.parentInjector).get(Cs,null);w&&(o=w)}const f=Xn(l.componentType??{}),g=jg(this._lContainer,f?.id??null),C=l.create(u,r,g?.firstChild??null,o);return this.insertImpl(C.hostView,a,Vg(this._hostTNode,g)),C}insert(n,e){return this.insertImpl(n,e,!0)}insertImpl(n,e,i){const r=n._lView;if(function Rw(t){return Pr(t[Jr])}(r)){const a=this.indexOf(n);if(-1!==a)this.detach(a);else{const l=r[Jr],u=new CO(l,l[os],l[Jr]);u.detach(u.indexOf(n))}}const o=this._adjustIndex(e),s=this._lContainer;return N0(s,r,o,i),n.attachToViewContainerRef(),Cv(U2(s),o,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=xO(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=jf(this._lContainer,e);i&&(_c(U2(this._lContainer),e),xh(i[Ot],i))}detach(n){const e=this._adjustIndex(n,-1),i=jf(this._lContainer,e);return i&&null!=_c(U2(this._lContainer),e)?new B0(i):null}_adjustIndex(n,e=0){return n??this.length+e}};function xO(t){return t[8]}function U2(t){return t[8]||(t[8]=[])}function wO(t,n){let e;const i=n[t.index];return Pr(i)?e=i:(e=jD(i,n,null,t),n[t.index]=e,uy(n,e)),EO(e,n,t,i),new CO(e,t,n)}let EO=function IO(t,n,e,i){if(t[ss])return;let r;r=8&e.type?zi(i):function l7(t,n){const e=t[Pn],i=e.createComment(""),r=ws(n,t);return rd(e,Hg(e,r),i,function _2(t,n){return t.nextSibling(n)}(e,r),!1),i}(n,e),t[ss]=r},H2=()=>!1;class z2{constructor(n){this.queryList=n,this.matches=null}clone(){return new z2(this.queryList)}setDirty(){this.queryList.setDirty()}}class V2{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let o=0;o<i;o++){const s=e.getByIndex(o);r.push(this.queries[s.indexInDeclarationView].clone())}return new V2(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}finishViewCreation(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==Y2(n,e).matches&&this.queries[e].setDirty()}}class SO{constructor(n,e,i=null){this.flags=e,this.read=i,this.predicate="string"==typeof n?function m7(t){return t.split(",").map(n=>n.trim())}(n):n}}class j2{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,o=this.getByIndex(i).embeddedTView(n,r);o&&(o.indexInDeclarationView=i,null!==e?e.push(o):e=[o])}return null!==e?new j2(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class G2{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new G2(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1&~this.metadata.flags){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const o=i[r];this.matchTNodeWithReadOption(n,e,h7(e,o)),this.matchTNodeWithReadOption(n,e,Of(e,n,o,!1,!1))}else i===sd?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,Of(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===_r||r===ja||r===sd&&4&e.type)this.addMatch(e.index,-2);else{const o=Of(e,n,r,!1,!1);null!==o&&this.addMatch(e.index,o)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function h7(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function p7(t,n,e,i){return-1===e?function f7(t,n){return 11&t.type?ph(t,n):4&t.type?fy(t,n):null}(n,t):-2===e?function g7(t,n,e){return e===_r?ph(n,t):e===sd?fy(n,t):e===ja?wO(n,t):void 0}(t,n,i):Wl(t,t[Ot],e,n)}function MO(t,n,e,i){const r=n[xc].queries[i];if(null===r.matches){const o=t.data,s=e.matches,a=[];for(let l=0;null!==s&&l<s.length;l+=2){const u=s[l];a.push(u<0?null:p7(n,o[u],s[l+1],e.metadata.read))}r.matches=a}return r.matches}function W2(t,n,e,i){const r=t.queries.getByIndex(e),o=r.matches;if(null!==o){const s=MO(t,n,r,e);for(let a=0;a<o.length;a+=2){const l=o[a];if(l>0)i.push(s[a/2]);else{const u=o[a+1],f=n[-l];for(let g=jr;g<f.length;g++){const v=f[g];v[Xd]===v[Jr]&&W2(v[Ot],v,u,i)}if(null!==f[Jd]){const g=f[Jd];for(let v=0;v<g.length;v++){const C=g[v];W2(C[Ot],C,u,i)}}}}}return i}function OO(t,n,e){const i=hi();return i.firstCreatePass&&(function kO(t,n,e){null===t.queries&&(t.queries=new j2),t.queries.track(new G2(n,e))}(i,new SO(t,n,e),-1),!(2&~n)&&(i.staticViewQueries=!0)),function DO(t,n,e){const i=new K_(!(4&~e));return function FB(t,n,e,i){const r=WD(n);r.push(e),t.firstCreatePass&&$D(t).push(i,r.length-1)}(t,n,i,i.destroy),(n[xc]??=new V2).queries.push(new z2(i))-1}(i,st(),n)}function Y2(t,n){return t.queries.getByIndex(n)}function PO(t,n){const e=t[Ot],i=Y2(e,n);return i.crossesNgTemplate?W2(e,t,n,[]):MO(e,t,i,n)}function RO(t){return function FO(t){return"function"==typeof t&&void 0!==t[q]}(t)&&"function"==typeof t.set}function tr(t){let n=function YO(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(sl(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new it(903,!1);r=n.\u0275dir}if(r){if(e){i.push(r);const s=t;s.inputs=Ey(t.inputs),s.inputTransforms=Ey(t.inputTransforms),s.declaredInputs=Ey(t.declaredInputs),s.outputs=Ey(t.outputs);const a=r.hostBindings;a&&k7(t,a);const l=r.viewQuery,u=r.contentQueries;if(l&&O7(t,l),u&&A7(t,u),M7(t,r),zs(t.outputs,r.outputs),sl(r)&&r.data.animation){const f=t.data;f.animation=(f.animation||[]).concat(r.data.animation)}}const o=r.features;if(o)for(let s=0;s<o.length;s++){const a=o[s];a&&a.ngInherit&&a(t),a===tr&&(e=!1)}}n=Object.getPrototypeOf(n)}!function D7(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=_i(r.hostAttrs,e=_i(e,r.hostAttrs))}}(i)}function M7(t,n){for(const e in n.inputs){if(!n.inputs.hasOwnProperty(e)||t.inputs.hasOwnProperty(e))continue;const i=n.inputs[e];if(void 0!==i&&(t.inputs[e]=i,t.declaredInputs[e]=n.declaredInputs[e],null!==n.inputTransforms)){const r=Array.isArray(i)?i[0]:i;if(!n.inputTransforms.hasOwnProperty(r))continue;t.inputTransforms??={},t.inputTransforms[r]=n.inputTransforms[r]}}}function Ey(t){return t===lo?{}:t===Ti?[]:t}function O7(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function A7(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,o)=>{n(i,r,o),e(i,r,o)}:n}function k7(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}function KO(t){const n=t.inputConfig,e={};for(const i in n)if(n.hasOwnProperty(i)){const r=n[i];Array.isArray(r)&&r[3]&&(e[i]=r[3])}t.inputTransforms=e}class Xf{}class B7{}class Z2 extends Xf{constructor(n,e,i){super(),this._parent=e,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new vO(this);const r=function _o(t,n){const e=t[s_]||null;if(!e&&!0===n)throw new Error(`Type ${Si(t)} does not have '\u0275mod' property.`);return e}(n);this._bootstrapComponents=function Ss(t){return t instanceof Function?t():t}(r.bootstrap),this._r3Injector=l1(n,e,[{provide:Xf,useValue:this},{provide:vy,useValue:this.componentFactoryResolver},...i],Si(n),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(n)}get injector(){return this._r3Injector}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class X2 extends B7{constructor(n){super(),this.moduleType=n}create(n){return new Z2(this.moduleType,n,[])}}class QO extends Xf{constructor(n){super(),this.componentFactoryResolver=new vO(this),this.instance=null;const e=new $d([...n.providers,{provide:Xf,useValue:this},{provide:vy,useValue:this.componentFactoryResolver}],n.parent||Gu(),n.debugName,new Set(["environment"]));this.injector=e,n.runEnvironmentInitializers&&e.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(n){this.injector.onDestroy(n)}}let q0=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new Yc(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const e=this.taskId++;return this.pendingTasks.add(e),e}remove(e){this.pendingTasks.delete(e),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function Iy(t){return!!K2(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function K2(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function hu(t,n,e){return t[n]=e}function Z0(t,n){return t[n]}function xo(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function Kf(t,n,e,i){const r=xo(t,n,e);return xo(t,n+1,i)||r}function Sy(t,n,e,i,r){const o=Kf(t,n,e,i);return xo(t,n+2,r)||o}function Yl(t,n,e,i,r,o){const s=Kf(t,n,e,i);return Kf(t,n+2,r,o)||s}function L(t,n,e,i,r,o,s,a){const l=st(),u=hi(),f=t+Un,g=u.firstCreatePass?function $7(t,n,e,i,r,o,s,a,l){const u=n.consts,f=oi(n,t,4,s||null,Hl(u,a));v2(n,e,f,Hl(u,l)),Ec(n,f);const g=f.tView=b2(2,f,i,r,o,n.directiveRegistry,n.pipeRegistry,null,n.schemas,u,null);return null!==n.queries&&(n.queries.template(n,f),g.queries=n.queries.embeddedTView(f)),f}(f,u,l,n,e,i,r,o,s):u.data[f];ll(g,!1);const v=eA(u,l,g,t);Ku()&&zg(u,l,v,g),us(v,l);const C=jD(v,l,v,g);return l[f]=C,uy(l,C),function TO(t,n,e){return H2(t,n,e)}(C,g,l),qu(g)&&pa(u,l,g),null!=s&&bl(l,g,a),L}let eA=function tA(t,n,e,i){return Ba(!0),n[Pn].createComment("")};function $t(t,n,e,i){const r=st();return xo(r,cl(),n)&&(hi(),uu(er(),r,t,n,e,i)),$t}function Qg(t,n,e,i){return xo(t,cl(),e)?n+Nn(e)+i:je}function Py(t,n,e,i,r,o){const s=st(),a=Qg(s,n,e,i);return a!==je&&uu(er(),s,t,a,r,o),Py}function Fy(t,n){return t<<17|n<<2}function Th(t){return t>>17&32767}function aT(t){return 2|t}function Jf(t){return(131068&t)>>2}function lT(t,n){return-131069&t|n<<2}function cT(t){return 1|t}function AA(t,n,e,i){const r=t[e+1],o=null===n;let s=i?Th(r):Jf(r),a=!1;for(;0!==s&&(!1===a||o);){const u=t[s+1];kU(t[s],n)&&(a=!0,t[s+1]=i?cT(u):aT(u)),s=i?Th(u):Jf(u)}a&&(t[e+1]=i?aT(r):cT(r))}function kU(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&jd(t,n)>=0}const Yo={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function kA(t){return t.substring(Yo.key,Yo.keyEnd)}function PU(t){return t.substring(Yo.value,Yo.valueEnd)}function PA(t,n){const e=Yo.textEnd;return e===n?-1:(n=Yo.keyEnd=function RU(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,Yo.key=n,e),sm(t,n,e))}function FA(t,n){const e=Yo.textEnd;let i=Yo.key=sm(t,n,e);return e===i?-1:(i=Yo.keyEnd=function LU(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=RA(t,i,e),i=Yo.value=sm(t,i,e),i=Yo.valueEnd=function BU(t,n,e){let i=-1,r=-1,o=-1,s=n,a=s;for(;s<e;){const l=t.charCodeAt(s++);if(59===l)return a;34===l||39===l?a=s=LA(t,l,s,e):n===s-4&&85===o&&82===r&&76===i&&40===l?a=s=LA(t,41,s,e):l>32&&(a=s),o=r,r=i,i=-33&l}return a}(t,i,e),RA(t,i,e))}function NA(t){Yo.key=0,Yo.keyEnd=0,Yo.value=0,Yo.valueEnd=0,Yo.textEnd=t.length}function sm(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function RA(t,n,e,i){return(n=sm(t,n,e))<e&&n++,n}function LA(t,n,e,i){let r=-1,o=e;for(;o<i;){const s=t.charCodeAt(o++);if(s==n&&92!==r)return o;r=92==s&&92===r?0:s}throw new Error}function _(t,n,e){const i=st();return xo(i,cl(),n)&&Va(hi(),er(),i,t,n,i[Pn],e,!1),_}function uT(t,n,e,i,r){const s=r?"class":"style";w2(t,e,n.inputs[s],s,i)}function ke(t,n,e){return Sc(t,n,e,!1),ke}function eb(t,n){return Sc(t,n,null,!0),eb}function Ds(t){Mc(HA,UU,t,!1)}function UU(t,n){for(let e=function NU(t){return NA(t),FA(t,sm(t,0,Yo.textEnd))}(n);e>=0;e=FA(n,e))HA(t,kA(n),PU(n))}function am(t){Mc(WU,fu,t,!0)}function fu(t,n){for(let e=function FU(t){return NA(t),PA(t,sm(t,0,Yo.textEnd))}(n);e>=0;e=PA(n,e))is(t,kA(n),!0)}function Sc(t,n,e,i){const r=st(),o=hi(),s=jl(2);o.firstUpdatePass&&UA(o,t,s,i),n!==je&&xo(r,s,n)&&zA(o,o.data[yr()],r,r[Pn],t,r[s+1]=function YU(t,n){return null==t||""===t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Si(fa(t)))),t}(n,e),i,s)}function Mc(t,n,e,i){const r=hi(),o=jl(2);r.firstUpdatePass&&UA(r,null,o,i);const s=st();if(e!==je&&xo(s,o,e)){const a=r.data[yr()];if(jA(a,i)&&!BA(r,o)){let l=i?a.classesWithoutHost:a.stylesWithoutHost;null!==l&&(e=Zc(l,e||"")),uT(r,a,s,e,i)}else!function $U(t,n,e,i,r,o,s,a){r===je&&(r=Ti);let l=0,u=0,f=0<r.length?r[0]:null,g=0<o.length?o[0]:null;for(;null!==f||null!==g;){const v=l<r.length?r[l+1]:void 0,C=u<o.length?o[u+1]:void 0;let w,E=null;f===g?(l+=2,u+=2,v!==C&&(E=g,w=C)):null===g||null!==f&&f<g?(l+=2,E=f):(u+=2,E=g,w=C),null!==E&&zA(t,n,e,i,E,w,s,a),f=l<r.length?r[l]:null,g=u<o.length?o[u]:null}}(r,a,s,s[Pn],s[o+1],s[o+1]=function GU(t,n,e){if(null==e||""===e)return Ti;const i=[],r=fa(e);if(Array.isArray(r))for(let o=0;o<r.length;o++)t(i,r[o],!0);else if("object"==typeof r)for(const o in r)r.hasOwnProperty(o)&&t(i,o,r[o]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,o)}}function BA(t,n){return n>=t.expandoStartIndex}function UA(t,n,e,i){const r=t.data;if(null===r[e+1]){const o=r[yr()],s=BA(t,e);jA(o,i)&&null===n&&!s&&(n=!1),n=function HU(t,n,e,i){const r=function lh(t){const n=Mn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let o=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=tb(e=dT(null,t,n,e,i),n.attrs,i),o=null);else{const s=n.directiveStylingLast;if(-1===s||t[s]!==r)if(e=dT(r,t,n,e,i),null===o){let l=function zU(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==Jf(i))return t[Th(i)]}(t,n,i);void 0!==l&&Array.isArray(l)&&(l=dT(null,t,n,l[1],i),l=tb(l,n.attrs,i),function VU(t,n,e,i){t[Th(e?n.classBindings:n.styleBindings)]=i}(t,n,i,l))}else o=function jU(t,n,e){let i;const r=n.directiveEnd;for(let o=1+n.directiveStylingLast;o<r;o++)i=tb(i,t[o].hostAttrs,e);return tb(i,n.attrs,e)}(t,n,i)}return void 0!==o&&(i?n.residualClasses=o:n.residualStyles=o),e}(r,o,n,i),function OU(t,n,e,i,r,o){let s=o?n.classBindings:n.styleBindings,a=Th(s),l=Jf(s);t[i]=e;let f,u=!1;if(Array.isArray(e)?(f=e[1],(null===f||jd(e,f)>0)&&(u=!0)):f=e,r)if(0!==l){const v=Th(t[a+1]);t[i+1]=Fy(v,a),0!==v&&(t[v+1]=lT(t[v+1],i)),t[a+1]=function MU(t,n){return 131071&t|n<<17}(t[a+1],i)}else t[i+1]=Fy(a,0),0!==a&&(t[a+1]=lT(t[a+1],i)),a=i;else t[i+1]=Fy(l,0),0===a?a=i:t[l+1]=lT(t[l+1],i),l=i;u&&(t[i+1]=aT(t[i+1])),AA(t,f,i,!0),AA(t,f,i,!1),function AU(t,n,e,i,r){const o=r?t.residualClasses:t.residualStyles;null!=o&&"string"==typeof n&&jd(o,n)>=0&&(e[i+1]=cT(e[i+1]))}(n,f,t,i,o),s=Fy(a,l),o?n.classBindings=s:n.styleBindings=s}(r,o,n,e,s,i)}}function dT(t,n,e,i,r){let o=null;const s=e.directiveEnd;let a=e.directiveStylingLast;for(-1===a?a=e.directiveStart:a++;a<s&&(o=n[a],i=tb(i,o.hostAttrs,r),o!==t);)a++;return null!==t&&(e.directiveStylingLast=a),i}function tb(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let o=0;o<n.length;o++){const s=n[o];"number"==typeof s?r=s:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),is(t,s,!!e||n[++o]))}return void 0===t?null:t}function HA(t,n,e){is(t,n,fa(e))}function WU(t,n,e){const i=String(n);""!==i&&!i.includes(" ")&&is(t,i,e)}function zA(t,n,e,i,r,o,s,a){if(!(3&n.type))return;const l=t.data,u=l[a+1],f=function DU(t){return!(1&~t)}(u)?VA(l,n,e,r,Jf(u),s):void 0;Ny(f)||(Ny(o)||function SU(t){return!(2&~t)}(u)&&(o=VA(l,null,e,r,a,s)),function ce(t,n,e,i,r){if(n)r?t.addClass(e,i):t.removeClass(e,i);else{let o=-1===i.indexOf("-")?void 0:to.DashCase;null==r?t.removeStyle(e,i,o):("string"==typeof r&&r.endsWith("!important")&&(r=r.slice(0,-10),o|=to.Important),t.setStyle(e,i,r,o))}}(i,s,Zu(yr(),e),r,o))}function VA(t,n,e,i,r,o){const s=null===n;let a;for(;r>0;){const l=t[r],u=Array.isArray(l),f=u?l[1]:l,g=null===f;let v=e[r+1];v===je&&(v=g?Ti:void 0);let C=g?p_(v,i):f===i?v:void 0;if(u&&!Ny(C)&&(C=p_(l,i)),Ny(C)&&(a=C,s))return a;const E=t[r+1];r=s?Th(E):Jf(E)}if(null!==n){let l=o?n.residualClasses:n.residualStyles;null!=l&&(a=p_(l,i))}return a}function Ny(t){return void 0!==t}function jA(t,n){return!!(t.flags&(n?8:16))}function YA(t,n,e){du("NgControlFlow");const i=st(),r=cl(),o=function pT(t,n){return t[n]}(i,Un+t);if(xo(i,r,n)){const a=W(null);try{if(function T2(t,n){const e=jf(t,n);return void 0!==e&&xh(e[Ot],e),e}(o,0),-1!==n){const l=function gT(t,n){return Wn(t,n)}(i[Ot],Un+n),u=jg(o,l.tView.ssrId);N0(o,F0(i,l,e,{dehydratedView:u}),0,Vg(l,u))}}finally{W(a)}}else{const a=function qD(t,n){const e=jr+n;if(e<t.length)return t[e]}(o,0);void 0!==a&&(a[cr]=e)}}function p(t,n,e,i){const r=st(),o=hi(),s=Un+t,a=r[Pn],l=o.firstCreatePass?function gH(t,n,e,i,r,o){const s=n.consts,l=oi(n,t,2,i,Hl(s,r));return v2(n,e,l,Hl(s,o)),null!==l.attrs&&Cy(l,l.attrs,!1),null!==l.mergedAttrs&&Cy(l,l.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,l),l}(s,o,r,n,e,i):o.data[s],u=qA(o,r,l,a,n,t);r[s]=u;const f=qu(l);return ll(l,!0),gt(a,u,l),!function X0(t){return!(32&~t.flags)}(l)&&Ku()&&zg(o,r,u,l),0===function O_(){return Mn.lFrame.elementDepthCount}()&&us(u,r),function zv(){Mn.lFrame.elementDepthCount++}(),f&&(pa(o,r,l),Nr(o,l,r)),null!==i&&bl(r,l),p}function m(){let t=Vi();ls()?La():(t=t.parent,ll(t,!1));const n=t;(function Uw(t){return Mn.skipHydrationRootTNode===t})(n)&&function k_(){Mn.skipHydrationRootTNode=null}(),function A_(){Mn.lFrame.elementDepthCount--}();const e=hi();return e.firstCreatePass&&(Ec(e,t),Kp(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function Ww(t){return!!(8&t.flags)}(n)&&uT(e,n,st(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function Xv(t){return!!(16&t.flags)}(n)&&uT(e,n,st(),n.stylesWithoutHost,!1),m}function Ne(t,n,e,i){return p(t,n,e,i),m(),Ne}let qA=(t,n,e,i,r,o)=>(Ba(!0),Ch(i,r,function Gl(){return Mn.lFrame.currentNamespace}()));function Me(t,n,e){const i=st(),r=hi(),o=t+Un,s=r.firstCreatePass?function bH(t,n,e,i,r){const o=n.consts,s=Hl(o,i),a=oi(n,t,8,"ng-container",s);return null!==s&&Cy(a,s,!0),v2(n,e,a,Hl(o,r)),null!==n.queries&&n.queries.elementStart(n,a),a}(o,r,i,n,e):r.data[o];ll(s,!0);const a=ZA(r,i,s,t);return i[o]=a,Ku()&&zg(r,i,a,s),us(a,i),qu(s)&&(pa(r,i,s),Nr(r,s,i)),null!=e&&bl(i,s),Me}function De(){let t=Vi();const n=hi();return ls()?La():(t=t.parent,ll(t,!1)),n.firstCreatePass&&(Ec(n,t),Kp(t)&&n.queries.elementEnd(t)),De}function ti(t,n,e){return Me(t,n,e),De(),ti}let ZA=(t,n,e,i)=>(Ba(!0),D0(n[Pn],""));function Ie(){return st()}const ep=void 0;var xH=["en",[["a","p"],["AM","PM"],ep],[["AM","PM"],ep,ep],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ep,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ep,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ep,"{1} 'at' {0}",ep],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function CH(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let lm={};function ga(t){const n=function wH(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=JA(n);if(e)return e;const i=n.split("-")[0];if(e=JA(i),e)return e;if("en"===i)return xH;throw new it(701,!1)}function JA(t){return t in lm||(lm[t]=si.ng&&si.ng.common&&si.ng.common.locales&&si.ng.common.locales[t]),lm[t]}var Cr=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(Cr||{});const cm="en-US";let ek=cm;function X(t,n,e,i){const r=st(),o=hi(),s=Vi();return bT(o,r,r[Pn],s,t,n,i),X}function bT(t,n,e,i,r,o,s){const a=qu(i),u=t.firstCreatePass&&$D(t),f=n[cr],g=WD(n);let v=!0;if(3&i.type||s){const w=ws(i,n),T=s?s(w):w,M=g.length,S=s?Z=>s(zi(Z[i.index])):i.index;let P=null;if(!s&&a&&(P=function vz(t,n,e,i){const r=t.cleanup;if(null!=r)for(let o=0;o<r.length-1;o+=2){const s=r[o];if(s===e&&r[o+1]===i){const a=n[qd],l=r[o+2];return a.length>l?a[l]:null}"string"==typeof s&&(o+=2)}return null}(t,n,r,i.index)),null!==P)(P.__ngLastListenerFn__||P).__ngNextListenerFn__=o,P.__ngLastListenerFn__=o,v=!1;else{o=Mk(i,n,f,o,!1);const Z=e.listen(T,r,o);g.push(o,Z),u&&u.push(r,S,M,M+1)}}else o=Mk(i,n,f,o,!1);const C=i.outputs;let E;if(v&&null!==C&&(E=C[r])){const w=E.length;if(w)for(let T=0;T<w;T+=2){const ee=n[E[T]][E[T+1]].subscribe(o),B=g.length;g.push(o,ee),u&&u.push(r,i.index,B,-(B+1))}}}function Sk(t,n,e,i){const r=W(null);try{return Ul(6,n,e),!1!==e(i)}catch(o){return dy(t,o),!1}finally{Ul(7,n,e),W(r)}}function Mk(t,n,e,i,r){return function o(s){if(s===Function)return i;L0(t.componentOffset>-1?ca(t.index,n):n);let l=Sk(n,e,i,s),u=o.__ngNextListenerFn__;for(;u;)l=Sk(n,e,u,s)&&l,u=u.__ngNextListenerFn__;return r&&!1===l&&s.preventDefault(),l}}function y(t=1){return function $v(t){return(Mn.lFrame.contextLView=function xf(t,n){for(;t>0;)n=n[Zd],t--;return n}(t,Mn.lFrame.contextLView))[cr]}(t)}function yz(t,n){let e=null;const i=function zp(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(!(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const o=n[r];if("*"!==o){if(null===i?df(t,o,!0):Ev(i,o))return r}else e=r}return e}function vT(t){const n=st()[vr][os];if(!n.projection){const i=n.projection=function Lp(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}(t?t.length:1,null),r=i.slice();let o=n.child;for(;null!==o;){const s=t?yz(o,t):0;null!==s&&(r[s]?r[s].projectionNext=o:i[s]=o,r[s]=o),o=o.next}}}function yT(t,n=0,e){const i=st(),r=hi(),o=oi(r,Un+t,16,null,e||null);null===o.projection&&(o.projection=n),La(),(!i[bo]||da())&&32&~o.flags&&function I(t,n,e){k(n[Pn],0,n,e,O0(t,e,n),oy(e.parent||n[os],e,n))}(r,i,o)}function ft(t,n,e){return no(t,"",n,"",e),ft}function no(t,n,e,i,r){const o=st(),s=Qg(o,n,e,i);return s!==je&&Va(hi(),er(),o,t,s,o[Pn],r,!1),no}function Dn(t,n,e){OO(t,n,e)}function On(t){const n=st(),e=hi(),i=cg();Xu(i+1);const r=Y2(e,i);if(t.dirty&&function Cf(t){return!(4&~t[fn])}(n)===!(2&~r.metadata.flags)){if(null===r.matches)t.reset([]);else{const o=PO(n,i);t.reset(o,d1),t.notifyOnChanges()}return!0}return!1}function An(){return function $2(t,n){return t[xc].queries[n].queryList}(st(),cg())}function rn(t){return ih(function Hw(){return Mn.lFrame.contextLView}(),Un+t)}function x(t,n=""){const e=st(),i=hi(),r=t+Un,o=i.firstCreatePass?oi(i,r,1,n,null):i.data[r],s=$k(i,e,o,n,t);e[r]=s,Ku()&&zg(i,e,s,o),ll(o,!1)}let $k=(t,n,e,i,r)=>(Ba(!0),function M0(t,n){return t.createText(n)}(n[Pn],i));function Re(t){return Mi("",t,""),Re}function Mi(t,n,e){const i=st(),r=Qg(i,t,n,e);return r!==je&&od(i,yr(),r),Mi}function Ih(t,n,e,i,r){const o=st(),s=function Jg(t,n,e,i,r,o){const a=Kf(t,Vl(),e,r);return jl(2),a?n+Nn(e)+i+Nn(r)+o:je}(o,t,n,e,i,r);return s!==je&&od(o,yr(),s),Ih}function CT(t,n,e,i,r,o,s,a,l,u,f){const g=st(),v=function nm(t,n,e,i,r,o,s,a,l,u,f,g){const v=Vl();let C=Yl(t,v,e,r,s,l);return C=xo(t,v+4,f)||C,jl(5),C?n+Nn(e)+i+Nn(r)+o+Nn(s)+a+Nn(l)+u+Nn(f)+g:je}(g,t,n,e,i,r,o,s,a,l,u,f);return v!==je&&od(g,yr(),v),CT}function We(t,n,e){RO(n)&&(n=n());const i=st();return xo(i,cl(),n)&&Va(hi(),er(),i,t,n,i[Pn],e,!1),We}function Ge(t,n){const e=RO(t);return e&&t.set(n),e}function $e(t,n){const e=st(),i=hi(),r=Vi();return bT(i,e,e[Pn],r,t,n),$e}function xT(t,n,e,i,r){if(t=V(t),Array.isArray(t))for(let o=0;o<t.length;o++)xT(t[o],n,e,i,r);else{const o=hi(),s=st(),a=Vi();let l=bc(t)?t:V(t.provide);const u=Dv(t),f=1048575&a.providerIndexes,g=a.directiveStart,v=a.providerIndexes>>20;if(bc(t)||!t.multi){const C=new po(u,r,F),E=ET(l,n,r?f:f+v,g);-1===E?(pg(fg(a,s),o,l),wT(o,t,n.length),n.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(C),s.push(C)):(e[E]=C,s[E]=C)}else{const C=ET(l,n,f+v,g),E=ET(l,n,f,f+v),T=E>=0&&e[E];if(r&&!T||!r&&!(C>=0&&e[C])){pg(fg(a,s),o,l);const M=function Hz(t,n,e,i,r){const o=new po(t,e,F);return o.multi=[],o.index=n,o.componentProviders=0,Jk(o,r,i&&!e),o}(r?Uz:Bz,e.length,r,i,u);!r&&T&&(e[E].providerFactory=M),wT(o,t,n.length,0),n.push(l),a.directiveStart++,a.directiveEnd++,r&&(a.providerIndexes+=1048576),e.push(M),s.push(M)}else wT(o,t,C>-1?C:E,Jk(e[r?E:C],u,!r&&i));!r&&i&&T&&e[E].componentProviders++}}}function wT(t,n,e,i){const r=bc(n),o=function pf(t){return!!t.useClass}(n);if(r||o){const l=(o?V(n.useClass):n).prototype.ngOnDestroy;if(l){const u=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const f=u.indexOf(e);-1===f?u.push(e,[i,l]):u[f+1].push(i,l)}else u.push(e,l)}}}function Jk(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function ET(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function Bz(t,n,e,i){return TT(this.multi,[])}function Uz(t,n,e,i){const r=this.multi;let o;if(this.providerFactory){const s=this.providerFactory.componentProviders,a=Wl(e,e[Ot],this.providerFactory.index,i);o=a.slice(0,s),TT(r,o);for(let l=s;l<a.length;l++)o.push(a[l])}else o=[],TT(r,o);return o}function TT(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function xr(t,n=[]){return e=>{e.providersResolver=(i,r)=>function Lz(t,n,e){const i=hi();if(i.firstCreatePass){const r=sl(t);xT(e,i.data,i.blueprint,r,!0),xT(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}let zz=(()=>{class t{constructor(e){this._injector=e,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(e){if(!e.standalone)return null;if(!this.cachedInjectors.has(e)){const i=$p(0,e.type),r=i.length>0?function JO(t,n,e=null){return new QO({providers:t,parent:n,debugName:e,runEnvironmentInitializers:!0}).injector}([i],this._injector,`Standalone[${e.type.name}]`):null;this.cachedInjectors.set(e,r)}return this.cachedInjectors.get(e)}ngOnDestroy(){try{for(const e of this.cachedInjectors.values())null!==e&&e.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=Wt({token:t,providedIn:"environment",factory:()=>new t(kn(Cs))})}return t})();function IT(t){du("NgStandalone"),t.getStandaloneInjector=n=>n.get(zz).getOrCreateStandaloneInjector(t)}function um(t,n,e){const i=t.\u0275cmp;i.directiveDefs=jp(n,!1),i.pipeDefs=jp(e,!0)}function ad(t,n,e){const i=fo()+t,r=st();return r[i]===je?hu(r,i,e?n.call(e):n()):Z0(r,i)}function Be(t,n,e,i){return function tP(t,n,e,i,r,o){const s=n+e;return xo(t,s,r)?hu(t,s+1,o?i.call(o,r):i(r)):lb(t,s+1)}(st(),fo(),t,n,e,i)}function Cn(t,n,e,i,r){return nP(st(),fo(),t,n,e,i,r)}function ma(t,n,e,i,r,o){return function iP(t,n,e,i,r,o,s,a){const l=n+e;return Sy(t,l,r,o,s)?hu(t,l+3,a?i.call(a,r,o,s):i(r,o,s)):lb(t,l+3)}(st(),fo(),t,n,e,i,r,o)}function yl(t,n,e,i,r,o,s){return function rP(t,n,e,i,r,o,s,a,l){const u=n+e;return Yl(t,u,r,o,s,a)?hu(t,u+4,l?i.call(l,r,o,s,a):i(r,o,s,a)):lb(t,u+4)}(st(),fo(),t,n,e,i,r,o,s)}function ST(t,n,e,i,r,o,s,a,l){const u=fo()+t,f=st(),g=Yl(f,u,e,i,r,o);return Kf(f,u+4,s,a)||g?hu(f,u+6,l?n.call(l,e,i,r,o,s,a):n(e,i,r,o,s,a)):Z0(f,u+6)}function dm(t,n,e,i,r,o,s,a,l,u){const f=fo()+t,g=st();let v=Yl(g,f,e,i,r,o);return Sy(g,f+4,s,a,l)||v?hu(g,f+7,u?n.call(u,e,i,r,o,s,a,l):n(e,i,r,o,s,a,l)):Z0(g,f+7)}function Dc(t,n,e,i,r,o,s,a,l,u,f){const g=fo()+t,v=st(),C=Yl(v,g,e,i,r,o);return Yl(v,g+4,s,a,l,u)||C?hu(v,g+8,f?n.call(f,e,i,r,o,s,a,l,u):n(e,i,r,o,s,a,l,u)):Z0(v,g+8)}function lb(t,n){const e=t[n];return e===je?void 0:e}function nP(t,n,e,i,r,o,s){const a=n+e;return Kf(t,a,r,o)?hu(t,a+2,s?i.call(s,r,o):i(r,o)):lb(t,a+2)}function It(t,n){const e=hi();let i;const r=t+Un;e.firstCreatePass?(i=function Wz(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks??=[]).push(r,i.onDestroy)):i=e.data[r];const o=i.factory||(i.factory=Uu(i.type)),a=Wo(F);try{const l=ch(!1),u=o();return ch(l),function Tz(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,st(),r,u),u}finally{Wo(a)}}function St(t,n,e,i){const r=t+Un,o=st(),s=ih(o,r);return function cb(t,n){return t[Ot].data[n].pure}(o,r)?nP(o,fo(),n,s.transform,e,i,s):s.transform(e,i)}function Pi(t,n){return fy(t,n)}const TP=new hn(""),Gy=new hn("");let NT,PT=(()=>{class t{constructor(e,i,r){this._ngZone=e,this.registry=i,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,NT||(function jV(t){NT=t}(r),r.addToWindow(i)),this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Sn.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb()}});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let o=-1;i&&i>0&&(o=setTimeout(()=>{this._callbacks=this._callbacks.filter(s=>s.timeoutId!==o),e()},i)),this._callbacks.push({doneCb:e,timeoutId:o,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(e){this.registry.registerApplication(e,this)}unregisterApplication(e){this.registry.unregisterApplication(e)}findProviders(e,i,r){return[]}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Sn),kn(FT),kn(Gy))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})(),FT=(()=>{class t{constructor(){this._applications=new Map}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return NT?.findTestabilityInTree(this,e,i)??null}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();function Wy(t){return!!t&&"function"==typeof t.then}function IP(t){return!!t&&"function"==typeof t.subscribe}const SP=new hn("");let RT=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((e,i)=>{this.resolve=e,this.reject=i}),this.appInits=En(SP,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const e=[];for(const r of this.appInits){const o=r();if(Wy(o))e.push(o);else if(IP(o)){const s=new Promise((a,l)=>{o.subscribe({complete:a,error:l})});e.push(s)}}const i=()=>{this.done=!0,this.resolve()};Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const MP=new hn("");function AP(t,n){return Array.isArray(n)?n.reduce(AP,t):{...t,...n}}let Sh=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=En(u1),this.afterRenderEffectManager=En(j0),this.externalTestViews=new Set,this.beforeRender=new ra,this.afterTick=new ra,this.componentTypes=[],this.components=[],this.isStable=En(q0).hasPendingTasks.pipe(jo(e=>!e)),this._injector=En(Cs)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(e,i){const r=e instanceof aO;if(!this._injector.get(RT).done)throw!r&&function aa(t){const n=Xn(t)||uo(t)||Qr(t);return null!==n&&n.standalone}(e),new it(405,!1);let s;s=r?e:this._injector.get(vy).resolveComponentFactory(e),this.componentTypes.push(s.componentType);const a=function GV(t){return t.isBoundToModule}(s)?void 0:this._injector.get(Xf),u=s.create(Ts.NULL,[],i||s.selector,a),f=u.location.nativeElement,g=u.injector.get(TP,null);return g?.registerApplication(f),u.onDestroy(()=>{this.detachView(u.hostView),$y(this.components,u),g?.unregisterApplication(f)}),this._loadComponent(u),u}tick(){this._tick(!0)}_tick(e){if(this._runningTick)throw new it(101,!1);const i=W(null);try{this._runningTick=!0,this.detectChangesInAttachedViews(e)}catch(r){this.internalErrorHandler(r)}finally{this.afterTick.next(),this._runningTick=!1,W(i)}}detectChangesInAttachedViews(e){let i=0;const r=this.afterRenderEffectManager;for(;;){if(i===KD)throw new it(103,!1);if(e){const o=0===i;this.beforeRender.next(o);for(let{_lView:s,notifyErrorHandler:a}of this._views)$V(s,o,a)}if(i++,r.executeInternalCallbacks(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>LT(o))&&(r.execute(),![...this.externalTestViews.keys(),...this._views].some(({_lView:o})=>LT(o))))break}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;$y(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e);const i=this._injector.get(MP,[]);[...this._bootstrapListeners,...i].forEach(r=>r(e))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(e=>e()),this._views.slice().forEach(e=>e.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(e){return this._destroyListeners.push(e),()=>$y(this._destroyListeners,e)}destroy(){if(this._destroyed)throw new it(406,!1);const e=this._injector;e.destroy&&!e.destroyed&&e.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function $y(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function $V(t,n,e){!n&&!LT(t)||function YV(t,n,e){let i;e?(i=0,t[fn]|=1024):i=64&t[fn]?0:1,hy(t,n,i)}(t,e,n)}function LT(t){return wf(t)}let KV=(()=>{class t{constructor(){this.zone=En(Sn),this.applicationRef=En(Sh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function QV(){const t=En(Sn),n=En(fl);return e=>t.runOutsideAngular(()=>n.handleError(e))}let ej=(()=>{class t{constructor(){this.subscription=new qn,this.initialized=!1,this.zone=En(Sn),this.pendingTasks=En(q0)}initialize(){if(this.initialized)return;this.initialized=!0;let e=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(e=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{Sn.assertNotInAngularZone(),queueMicrotask(()=>{null!==e&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(e),e=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{Sn.assertInAngularZone(),e??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const ld=new hn("",{providedIn:"root",factory:()=>En(ld,mi.Optional|mi.SkipSelf)||function tj(){return typeof $localize<"u"&&$localize.locale||cm}()}),BT=new hn("");let NP=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const r=function $9(t="zone.js",n){return"noop"===t?new fO:"zone.js"===t?new Sn(n):t}(i?.ngZone,function FP(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:i?.ngZoneEventCoalescing,runCoalescing:i?.ngZoneRunCoalescing}));return r.run(()=>{const o=function H7(t,n,e){return new Z2(t,n,e)}(e.moduleType,this.injector,function PP(t){return[{provide:Sn,useFactory:t},{provide:Gd,multi:!0,useFactory:()=>{const n=En(KV,{optional:!0});return()=>n.initialize()}},{provide:Gd,multi:!0,useFactory:()=>{const n=En(ej);return()=>{n.initialize()}}},{provide:u1,useFactory:QV}]}(()=>r)),s=o.injector.get(fl,null);return r.runOutsideAngular(()=>{const a=r.onError.subscribe({next:l=>{s.handleError(l)}});o.onDestroy(()=>{$y(this._modules,o),a.unsubscribe()})}),function OP(t,n,e){try{const i=e();return Wy(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(s,r,()=>{const a=o.injector.get(RT);return a.runInitializers(),a.donePromise.then(()=>(function tk(t){"string"==typeof t&&(ek=t.toLowerCase().replace(/_/g,"-"))}(o.injector.get(ld,cm)||cm),this._moduleDoBootstrap(o),o))})})}bootstrapModule(e,i=[]){const r=AP({},i);return function XV(t,n,e){const i=new X2(e);return Promise.resolve(i)}(0,0,e).then(o=>this.bootstrapModuleFactory(o,r))}_moduleDoBootstrap(e){const i=e.injector.get(Sh);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new it(-403,!1);e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new it(404,!1);this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(BT,null);e&&(e.forEach(i=>i()),e.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Ts))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),Mh=null;const RP=new hn("");function LP(t,n,e=[]){const i=`Platform: ${n}`,r=new hn(i);return(o=[])=>{let s=UT();if(!s||s.injector.get(RP,!1)){const a=[...e,...o,{provide:r,useValue:!0}];t?t(a):function rj(t){if(Mh&&!Mh.get(RP,!1))throw new it(400,!1);(function DP(){!function Oo(t){Ht=t}(()=>{throw new it(600,!1)})})(),Mh=t;const n=t.get(NP);(function UP(t){t.get(n0,null)?.forEach(e=>e())})(t)}(function BP(t=[],n){return Ts.create({name:n,providers:[{provide:gf,useValue:"platform"},{provide:BT,useValue:new Set([()=>Mh=null])},...t]})}(a,i))}return function oj(t){const n=UT();if(!n)throw new it(401,!1);return n}()}}function UT(){return Mh?.get(NP)??null}let io=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=aj}return t})();function aj(t){return function lj(t,n,e){if(Yu(t)&&!e){const i=ca(t.index,n);return new B0(i,i)}return 47&t.type?new B0(n[vr],n):null}(Vi(),st(),!(16&~t))}class GP{constructor(){}supports(n){return Iy(n)}create(n){return new fj(n)}}const hj=(t,n)=>n;class fj{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||hj}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,o=null;for(;e||i;){const s=!i||e&&e.currentIndex<$P(i,r,o)?e:i,a=$P(s,r,o),l=s.currentIndex;if(s===i)r--,i=i._nextRemoved;else if(e=e._next,null==s.previousIndex)r++;else{o||(o=[]);const u=a-r,f=l-r;if(u!=f){for(let v=0;v<u;v++){const C=v<o.length?o[v]:o[v]=0,E=C+v;f<=E&&E<u&&(o[v]=C+1)}o[s.previousIndex]=f-u}}a!==l&&n(s,a,l)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Iy(n))throw new it(900,!1);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,o,s,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let a=0;a<this.length;a++)o=n[a],s=this._trackByFn(a,o),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,o,s,a)),Object.is(e.item,o)||this._addIdentityChange(e,o)):(e=this._mismatch(e,o,s,a),i=!0),e=e._next}else r=0,function G7(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[Symbol.iterator]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,a=>{s=this._trackByFn(r,a),null!==e&&Object.is(e.trackById,s)?(i&&(e=this._verifyReinsertion(e,a,s,r)),Object.is(e.item,a)||this._addIdentityChange(e,a)):(e=this._mismatch(e,a,s,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let o;return null===n?o=this._itTail:(o=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,o,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,o,r)):n=this._addAfter(new pj(e,i),o,r),n}_verifyReinsertion(n,e,i,r){let o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==o?n=this._reinsertAfter(o,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,o=n._nextRemoved;return null===r?this._removalsHead=o:r._nextRemoved=o,null===o?this._removalsTail=r:o._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new WP),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new WP),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class pj{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class gj{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class WP{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new gj,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function $P(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class YP{constructor(){}supports(n){return n instanceof Map||K2(n)}create(){return new mj}}class mj{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||K2(n)))throw new it(900,!1)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const o=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,o)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const o=r._prev,s=r._next;return o&&(o._next=s),s&&(s._prev=o),r._next=null,r._prev=null,r}const i=new _j(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class _j{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function qP(){return new GT([new GP])}let GT=(()=>{class t{static#e=this.\u0275prov=Wt({token:t,providedIn:"root",factory:qP});constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||qP()),deps:[[t,new Rp,new cf]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new it(901,!1)}}return t})();function ZP(){return new Xy([new YP])}let Xy=(()=>{class t{static#e=this.\u0275prov=Wt({token:t,providedIn:"root",factory:ZP});constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||ZP()),deps:[[t,new Rp,new cf]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(i)return i;throw new it(901,!1)}}return t})();const yj=LP(null,"core",[]);let Cj=(()=>{class t{constructor(e){}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Sh))};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({})}return t})();function np(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function qT(t,n=NaN){return isNaN(parseFloat(t))||isNaN(Number(t))?n:Number(t)}let bF=null;function pb(){return bF}class iG{}const cd=new hn("");var ba=function(t){return t[t.Format=0]="Format",t[t.Standalone=1]="Standalone",t}(ba||{}),br=function(t){return t[t.Narrow=0]="Narrow",t[t.Abbreviated=1]="Abbreviated",t[t.Wide=2]="Wide",t[t.Short=3]="Short",t}(br||{}),Cl=function(t){return t[t.Short=0]="Short",t[t.Medium=1]="Medium",t[t.Long=2]="Long",t[t.Full=3]="Full",t}(Cl||{});const Lo={Decimal:0,Group:1,List:2,PercentSign:3,PlusSign:4,MinusSign:5,Exponential:6,SuperscriptingExponent:7,PerMille:8,Infinity:9,NaN:10,TimeSeparator:11,CurrencyDecimal:12,CurrencyGroup:13};function iC(t,n){return Zl(ga(t)[Cr.DateFormat],n)}function rC(t,n){return Zl(ga(t)[Cr.TimeFormat],n)}function oC(t,n){return Zl(ga(t)[Cr.DateTimeFormat],n)}function ql(t,n){const e=ga(t),i=e[Cr.NumberSymbols][n];if(typeof i>"u"){if(n===Lo.CurrencyDecimal)return e[Cr.NumberSymbols][Lo.Decimal];if(n===Lo.CurrencyGroup)return e[Cr.NumberSymbols][Lo.Group]}return i}function yF(t){if(!t[Cr.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Cr.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Zl(t,n){for(let e=n;e>-1;e--)if(typeof t[e]<"u")return t[e];throw new Error("Locale data API: locale data undefined")}function XT(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const vG=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,sC={},yG=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var ud=function(t){return t[t.Short=0]="Short",t[t.ShortGMT=1]="ShortGMT",t[t.Long=2]="Long",t[t.Extended=3]="Extended",t}(ud||{}),Yi=function(t){return t[t.FullYear=0]="FullYear",t[t.Month=1]="Month",t[t.Date=2]="Date",t[t.Hours=3]="Hours",t[t.Minutes=4]="Minutes",t[t.Seconds=5]="Seconds",t[t.FractionalSeconds=6]="FractionalSeconds",t[t.Day=7]="Day",t}(Yi||{}),qi=function(t){return t[t.DayPeriods=0]="DayPeriods",t[t.Days=1]="Days",t[t.Months=2]="Months",t[t.Eras=3]="Eras",t}(qi||{});function gb(t,n,e,i){let r=function DG(t){if(wF(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,o=1,s=1]=t.split("-").map(a=>+a);return aC(r,o-1,s)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(vG))return function OG(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,o=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const s=Number(t[4]||0)-e,a=Number(t[5]||0)-i,l=Number(t[6]||0),u=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return o.call(n,s,a,l,u),n}(i)}const n=new Date(t);if(!wF(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=dd(e,n)||n;let a,s=[];for(;n;){if(a=yG.exec(n),!a){s.push(n);break}{s=s.concat(a.slice(1));const f=s.pop();if(!f)break;n=f}}let l=r.getTimezoneOffset();i&&(l=xF(i,l),r=function MG(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function SG(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(xF(n,r)-r))}(r,i,!0));let u="";return s.forEach(f=>{const g=function IG(t){if(QT[t])return QT[t];let n;switch(t){case"G":case"GG":case"GGG":n=wr(qi.Eras,br.Abbreviated);break;case"GGGG":n=wr(qi.Eras,br.Wide);break;case"GGGGG":n=wr(qi.Eras,br.Narrow);break;case"y":n=Bo(Yi.FullYear,1,0,!1,!0);break;case"yy":n=Bo(Yi.FullYear,2,0,!0,!0);break;case"yyy":n=Bo(Yi.FullYear,3,0,!1,!0);break;case"yyyy":n=Bo(Yi.FullYear,4,0,!1,!0);break;case"Y":n=dC(1);break;case"YY":n=dC(2,!0);break;case"YYY":n=dC(3);break;case"YYYY":n=dC(4);break;case"M":case"L":n=Bo(Yi.Month,1,1);break;case"MM":case"LL":n=Bo(Yi.Month,2,1);break;case"MMM":n=wr(qi.Months,br.Abbreviated);break;case"MMMM":n=wr(qi.Months,br.Wide);break;case"MMMMM":n=wr(qi.Months,br.Narrow);break;case"LLL":n=wr(qi.Months,br.Abbreviated,ba.Standalone);break;case"LLLL":n=wr(qi.Months,br.Wide,ba.Standalone);break;case"LLLLL":n=wr(qi.Months,br.Narrow,ba.Standalone);break;case"w":n=KT(1);break;case"ww":n=KT(2);break;case"W":n=KT(1,!0);break;case"d":n=Bo(Yi.Date,1);break;case"dd":n=Bo(Yi.Date,2);break;case"c":case"cc":n=Bo(Yi.Day,1);break;case"ccc":n=wr(qi.Days,br.Abbreviated,ba.Standalone);break;case"cccc":n=wr(qi.Days,br.Wide,ba.Standalone);break;case"ccccc":n=wr(qi.Days,br.Narrow,ba.Standalone);break;case"cccccc":n=wr(qi.Days,br.Short,ba.Standalone);break;case"E":case"EE":case"EEE":n=wr(qi.Days,br.Abbreviated);break;case"EEEE":n=wr(qi.Days,br.Wide);break;case"EEEEE":n=wr(qi.Days,br.Narrow);break;case"EEEEEE":n=wr(qi.Days,br.Short);break;case"a":case"aa":case"aaa":n=wr(qi.DayPeriods,br.Abbreviated);break;case"aaaa":n=wr(qi.DayPeriods,br.Wide);break;case"aaaaa":n=wr(qi.DayPeriods,br.Narrow);break;case"b":case"bb":case"bbb":n=wr(qi.DayPeriods,br.Abbreviated,ba.Standalone,!0);break;case"bbbb":n=wr(qi.DayPeriods,br.Wide,ba.Standalone,!0);break;case"bbbbb":n=wr(qi.DayPeriods,br.Narrow,ba.Standalone,!0);break;case"B":case"BB":case"BBB":n=wr(qi.DayPeriods,br.Abbreviated,ba.Format,!0);break;case"BBBB":n=wr(qi.DayPeriods,br.Wide,ba.Format,!0);break;case"BBBBB":n=wr(qi.DayPeriods,br.Narrow,ba.Format,!0);break;case"h":n=Bo(Yi.Hours,1,-12);break;case"hh":n=Bo(Yi.Hours,2,-12);break;case"H":n=Bo(Yi.Hours,1);break;case"HH":n=Bo(Yi.Hours,2);break;case"m":n=Bo(Yi.Minutes,1);break;case"mm":n=Bo(Yi.Minutes,2);break;case"s":n=Bo(Yi.Seconds,1);break;case"ss":n=Bo(Yi.Seconds,2);break;case"S":n=Bo(Yi.FractionalSeconds,1);break;case"SS":n=Bo(Yi.FractionalSeconds,2);break;case"SSS":n=Bo(Yi.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=cC(ud.Short);break;case"ZZZZZ":n=cC(ud.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=cC(ud.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=cC(ud.Long);break;default:return null}return QT[t]=n,n}(f);u+=g?g(r,e,l):"''"===f?"'":f.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),u}function aC(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function dd(t,n){const e=function aG(t){return ga(t)[Cr.LocaleId]}(t);if(sC[e]??={},sC[e][n])return sC[e][n];let i="";switch(n){case"shortDate":i=iC(t,Cl.Short);break;case"mediumDate":i=iC(t,Cl.Medium);break;case"longDate":i=iC(t,Cl.Long);break;case"fullDate":i=iC(t,Cl.Full);break;case"shortTime":i=rC(t,Cl.Short);break;case"mediumTime":i=rC(t,Cl.Medium);break;case"longTime":i=rC(t,Cl.Long);break;case"fullTime":i=rC(t,Cl.Full);break;case"short":const r=dd(t,"shortTime"),o=dd(t,"shortDate");i=lC(oC(t,Cl.Short),[r,o]);break;case"medium":const s=dd(t,"mediumTime"),a=dd(t,"mediumDate");i=lC(oC(t,Cl.Medium),[s,a]);break;case"long":const l=dd(t,"longTime"),u=dd(t,"longDate");i=lC(oC(t,Cl.Long),[l,u]);break;case"full":const f=dd(t,"fullTime"),g=dd(t,"fullDate");i=lC(oC(t,Cl.Full),[f,g])}return i&&(sC[e][n]=i),i}function lC(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function Oc(t,n,e="-",i,r){let o="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,o=e));let s=String(t);for(;s.length<n;)s="0"+s;return i&&(s=s.slice(s.length-n)),o+s}function Bo(t,n,e=0,i=!1,r=!1){return function(o,s){let a=function xG(t,n){switch(t){case Yi.FullYear:return n.getFullYear();case Yi.Month:return n.getMonth();case Yi.Date:return n.getDate();case Yi.Hours:return n.getHours();case Yi.Minutes:return n.getMinutes();case Yi.Seconds:return n.getSeconds();case Yi.FractionalSeconds:return n.getMilliseconds();case Yi.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,o);if((e>0||a>-e)&&(a+=e),t===Yi.Hours)0===a&&-12===e&&(a=12);else if(t===Yi.FractionalSeconds)return function CG(t,n){return Oc(t,3).substring(0,n)}(a,n);const l=ql(s,Lo.MinusSign);return Oc(a,n,l,i,r)}}function wr(t,n,e=ba.Format,i=!1){return function(r,o){return function wG(t,n,e,i,r,o){switch(e){case qi.Months:return function uG(t,n,e){const i=ga(t),o=Zl([i[Cr.MonthsFormat],i[Cr.MonthsStandalone]],n);return Zl(o,e)}(n,r,i)[t.getMonth()];case qi.Days:return function cG(t,n,e){const i=ga(t),o=Zl([i[Cr.DaysFormat],i[Cr.DaysStandalone]],n);return Zl(o,e)}(n,r,i)[t.getDay()];case qi.DayPeriods:const s=t.getHours(),a=t.getMinutes();if(o){const u=function pG(t){const n=ga(t);return yF(n),(n[Cr.ExtraData][2]||[]).map(i=>"string"==typeof i?XT(i):[XT(i[0]),XT(i[1])])}(n),f=function gG(t,n,e){const i=ga(t);yF(i);const o=Zl([i[Cr.ExtraData][0],i[Cr.ExtraData][1]],n)||[];return Zl(o,e)||[]}(n,r,i),g=u.findIndex(v=>{if(Array.isArray(v)){const[C,E]=v,w=s>=C.hours&&a>=C.minutes,T=s<E.hours||s===E.hours&&a<E.minutes;if(C.hours<E.hours){if(w&&T)return!0}else if(w||T)return!0}else if(v.hours===s&&v.minutes===a)return!0;return!1});if(-1!==g)return f[g]}return function lG(t,n,e){const i=ga(t),o=Zl([i[Cr.DayPeriodsFormat],i[Cr.DayPeriodsStandalone]],n);return Zl(o,e)}(n,r,i)[s<12?0:1];case qi.Eras:return function dG(t,n){return Zl(ga(t)[Cr.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,o,t,n,e,i)}}function cC(t){return function(n,e,i){const r=-1*i,o=ql(e,Lo.MinusSign),s=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case ud.Short:return(r>=0?"+":"")+Oc(s,2,o)+Oc(Math.abs(r%60),2,o);case ud.ShortGMT:return"GMT"+(r>=0?"+":"")+Oc(s,1,o);case ud.Long:return"GMT"+(r>=0?"+":"")+Oc(s,2,o)+":"+Oc(Math.abs(r%60),2,o);case ud.Extended:return 0===i?"Z":(r>=0?"+":"")+Oc(s,2,o)+":"+Oc(Math.abs(r%60),2,o);default:throw new Error(`Unknown zone width "${t}"`)}}}const EG=0,uC=4;function CF(t){const n=t.getDay(),e=0===n?-3:uC-n;return aC(t.getFullYear(),t.getMonth(),t.getDate()+e)}function KT(t,n=!1){return function(e,i){let r;if(n){const o=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,s=e.getDate();r=1+Math.floor((s+o)/7)}else{const o=CF(e),s=function TG(t){const n=aC(t,EG,1).getDay();return aC(t,0,1+(n<=uC?uC:uC+7)-n)}(o.getFullYear()),a=o.getTime()-s.getTime();r=1+Math.round(a/6048e5)}return Oc(r,t,ql(i,Lo.MinusSign))}}function dC(t,n=!1){return function(e,i){return Oc(CF(e).getFullYear(),t,ql(i,Lo.MinusSign),n)}}const QT={};function xF(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function wF(t){return t instanceof Date&&!isNaN(t.valueOf())}const rI=/\s+/,SF=[];let Fi=(()=>{class t{constructor(e,i){this._ngEl=e,this._renderer=i,this.initialClasses=SF,this.stateMap=new Map}set klass(e){this.initialClasses=null!=e?e.trim().split(rI):SF}set ngClass(e){this.rawClass="string"==typeof e?e.trim().split(rI):e}ngDoCheck(){for(const i of this.initialClasses)this._updateState(i,!0);const e=this.rawClass;if(Array.isArray(e)||e instanceof Set)for(const i of e)this._updateState(i,!0);else if(null!=e)for(const i of Object.keys(e))this._updateState(i,!!e[i]);this._applyStateDiff()}_updateState(e,i){const r=this.stateMap.get(e);void 0!==r?(r.enabled!==i&&(r.changed=!0,r.enabled=i),r.touched=!0):this.stateMap.set(e,{enabled:i,changed:!0,touched:!0})}_applyStateDiff(){for(const e of this.stateMap){const i=e[0],r=e[1];r.changed?(this._toggleClass(i,r.enabled),r.changed=!1):r.touched||(r.enabled&&this._toggleClass(i,!1),this.stateMap.delete(i)),r.touched=!1}}_toggleClass(e,i){(e=e.trim()).length>0&&e.split(rI).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r),F(Yf))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngClass",""]],inputs:{klass:[ae.None,"class","klass"],ngClass:"ngClass"},standalone:!0})}return t})();class GG{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let nr=(()=>{class t{set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,o,s)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new GG(r.item,this._ngForOf,-1,-1),null===s?void 0:s);else if(null==s)i.remove(null===o?void 0:o);else if(null!==o){const a=i.get(o);i.move(a,s),DF(a,r)}});for(let r=0,o=i.length;r<o;r++){const a=i.get(r).context;a.index=r,a.count=o,a.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{DF(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(F(ja),F(sd),F(GT))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return t})();function DF(t,n){t.context.$implicit=n.item}let ni=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new WG,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){OF("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){OF("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}static#e=this.\u0275fac=function(i){return new(i||t)(F(ja),F(sd))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return t})();class WG{constructor(){this.$implicit=null,this.ngIf=null}}function OF(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Si(n)}'.`)}class oI{constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let Dh=(()=>{class t{constructor(){this._defaultViews=[],this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews.push(e)}_matchCase(e){const i=e===this._ngSwitch;return this._lastCasesMatched||=i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews.length>0&&e!==this._defaultUsed){this._defaultUsed=e;for(const i of this._defaultViews)i.enforceState(e)}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"},standalone:!0})}return t})(),mm=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new oI(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}static#e=this.\u0275fac=function(i){return new(i||t)(F(ja),F(sd),F(Dh,9))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"},standalone:!0})}return t})(),_b=(()=>{class t{constructor(e,i,r){r._addDefault(new oI(e,i))}static#e=this.\u0275fac=function(i){return new(i||t)(F(ja),F(sd),F(Dh,9))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngSwitchDefault",""]],standalone:!0})}return t})(),Zo=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,o]=e.split("."),s=-1===r.indexOf("-")?void 0:to.DashCase;null!=i?this._renderer.setStyle(this._ngEl.nativeElement,r,o?`${i}${o}`:i,s):this._renderer.removeStyle(this._ngEl.nativeElement,r,s)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r),F(Xy),F(Yf))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"},standalone:!0})}return t})(),ip=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(e){if(this._shouldRecreateView(e)){const i=this._viewContainerRef;if(this._viewRef&&i.remove(i.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const r=this._createContextForwardProxy();this._viewRef=i.createEmbeddedView(this.ngTemplateOutlet,r,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(e){return!!e.ngTemplateOutlet||!!e.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(e,i,r)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,i,r),get:(e,i,r)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,i,r)}})}static#e=this.\u0275fac=function(i){return new(i||t)(F(ja))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[mr]})}return t})();const rW=new hn(""),oW=new hn("");let kF=(()=>{class t{constructor(e,i,r){this.locale=e,this.defaultTimezone=i,this.defaultOptions=r}transform(e,i,r,o){if(null==e||""===e||e!=e)return null;try{return gb(e,i??this.defaultOptions?.dateFormat??"mediumDate",o||this.locale,r??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(s){throw function Ac(t,n){return new it(2100,!1)}()}}static#e=this.\u0275fac=function(i){return new(i||t)(F(ld,16),F(rW,24),F(oW,24))};static#t=this.\u0275pipe=rs({name:"date",type:t,pure:!0,standalone:!0})}return t})(),FF=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({})}return t})();const NF="browser";function lI(t){return t===NF}function RF(t){return"server"===t}class YW extends iG{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class uI extends YW{static makeCurrent(){!function nG(t){bF??=t}(new uI)}onAndCancel(n,e,i){return n.addEventListener(e,i),()=>{n.removeEventListener(e,i)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function qW(){return yb=yb||document.querySelector("base"),yb?yb.getAttribute("href"):null}();return null==e?null:function ZW(t){return new URL(t,document.baseURI).pathname}(e)}resetBaseElement(){yb=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function VG(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,o]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(o)}return null}(document.cookie,n)}}let yb=null,KW=(()=>{class t{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const dI=new hn("");let WF=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>{r.manager=this}),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){let i=this._eventNameToPlugin.get(e);if(i)return i;if(i=this._plugins.find(o=>o.supports(e)),!i)throw new it(5101,!1);return this._eventNameToPlugin.set(e,i),i}static#e=this.\u0275fac=function(i){return new(i||t)(kn(dI),kn(Sn))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();class $F{constructor(n){this._doc=n}}const hI="ng-app-id";let YF=(()=>{class t{constructor(e,i,r,o={}){this.doc=e,this.appId=i,this.nonce=r,this.platformId=o,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=RF(o),this.resetHostNodes()}addStyles(e){for(const i of e)1===this.changeUsageCount(i,1)&&this.onStyleAdded(i)}removeStyles(e){for(const i of e)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){const e=this.styleNodesInDOM;e&&(e.forEach(i=>i.remove()),e.clear());for(const i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(e){this.hostNodes.add(e);for(const i of this.getAllStyles())this.addStyleToHost(e,i)}removeHost(e){this.hostNodes.delete(e)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(e){for(const i of this.hostNodes)this.addStyleToHost(i,e)}onStyleRemoved(e){const i=this.styleRef;i.get(e)?.elements?.forEach(r=>r.remove()),i.delete(e)}collectServerRenderedStyles(){const e=this.doc.head?.querySelectorAll(`style[${hI}="${this.appId}"]`);if(e?.length){const i=new Map;return e.forEach(r=>{null!=r.textContent&&i.set(r.textContent,r)}),i}return null}changeUsageCount(e,i){const r=this.styleRef;if(r.has(e)){const o=r.get(e);return o.usage+=i,o.usage}return r.set(e,{usage:i,elements:[]}),i}getStyleElement(e,i){const r=this.styleNodesInDOM,o=r?.get(i);if(o?.parentNode===e)return r.delete(i),o.removeAttribute(hI),o;{const s=this.doc.createElement("style");return this.nonce&&s.setAttribute("nonce",this.nonce),s.textContent=i,this.platformIsServer&&s.setAttribute(hI,this.appId),e.appendChild(s),s}}addStyleToHost(e,i){const r=this.getStyleElement(e,i),o=this.styleRef,s=o.get(i)?.elements;s?s.push(r):o.set(i,{elements:[r],usage:1})}resetHostNodes(){const e=this.hostNodes;e.clear(),e.add(this.doc.head)}static#e=this.\u0275fac=function(i){return new(i||t)(kn(cd),kn(Tg),kn(Ig,8),kn(gl))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const fI={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},pI=/%COMP%/g,t$=new hn("",{providedIn:"root",factory:()=>!0});function ZF(t,n){return n.map(e=>e.replace(pI,t))}let gI=(()=>{class t{constructor(e,i,r,o,s,a,l,u=null){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.removeStylesOnCompDestroy=o,this.doc=s,this.platformId=a,this.ngZone=l,this.nonce=u,this.rendererByCompId=new Map,this.platformIsServer=RF(a),this.defaultRenderer=new mI(e,s,l,this.platformIsServer)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Ws.ShadowDom&&(i={...i,encapsulation:Ws.Emulated});const r=this.getOrCreateRenderer(e,i);return r instanceof KF?r.applyToHost(e):r instanceof _I&&r.applyStyles(),r}getOrCreateRenderer(e,i){const r=this.rendererByCompId;let o=r.get(i.id);if(!o){const s=this.doc,a=this.ngZone,l=this.eventManager,u=this.sharedStylesHost,f=this.removeStylesOnCompDestroy,g=this.platformIsServer;switch(i.encapsulation){case Ws.Emulated:o=new KF(l,u,i,this.appId,f,s,a,g);break;case Ws.ShadowDom:return new o$(l,u,e,i,s,a,this.nonce,g);default:o=new _I(l,u,i,f,s,a,g)}r.set(i.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(i){return new(i||t)(kn(WF),kn(YF),kn(Tg),kn(t$),kn(cd),kn(gl),kn(Sn),kn(Ig))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();class mI{constructor(n,e,i,r){this.eventManager=n,this.doc=e,this.ngZone=i,this.platformIsServer=r,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(n,e){return e?this.doc.createElementNS(fI[e]||e,n):this.doc.createElement(n)}createComment(n){return this.doc.createComment(n)}createText(n){return this.doc.createTextNode(n)}appendChild(n,e){(XF(n)?n.content:n).appendChild(e)}insertBefore(n,e,i){n&&(XF(n)?n.content:n).insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?this.doc.querySelector(n):n;if(!i)throw new it(-5104,!1);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const o=fI[r];o?n.setAttributeNS(o,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=fI[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(to.DashCase|to.Important)?n.style.setProperty(e,i,r&to.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&to.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){null!=n&&(n[e]=i)}setValue(n,e){n.nodeValue=e}listen(n,e,i){if("string"==typeof n&&!(n=pb().getGlobalEventTarget(this.doc,n)))throw new Error(`Unsupported event target ${n} for event ${e}`);return this.eventManager.addEventListener(n,e,this.decoratePreventDefault(i))}decoratePreventDefault(n){return e=>{if("__ngUnwrap__"===e)return n;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>n(e)):n(e))&&e.preventDefault()}}}function XF(t){return"TEMPLATE"===t.tagName&&void 0!==t.content}class o$ extends mI{constructor(n,e,i,r,o,s,a,l){super(n,o,s,l),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const u=ZF(r.id,r.styles);for(const f of u){const g=document.createElement("style");a&&g.setAttribute("nonce",a),g.textContent=f,this.shadowRoot.appendChild(g)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class _I extends mI{constructor(n,e,i,r,o,s,a,l){super(n,o,s,a),this.sharedStylesHost=e,this.removeStylesOnCompDestroy=r,this.styles=l?ZF(l,i.styles):i.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class KF extends _I{constructor(n,e,i,r,o,s,a,l){const u=r+"-"+i.id;super(n,e,i,o,s,a,l,u),this.contentAttr=function n$(t){return"_ngcontent-%COMP%".replace(pI,t)}(u),this.hostAttr=function i$(t){return"_nghost-%COMP%".replace(pI,t)}(u)}applyToHost(n){this.applyStyles(),this.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}let s$=(()=>{class t extends $F{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}static#e=this.\u0275fac=function(i){return new(i||t)(kn(cd))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const QF=["alt","control","meta","shift"],a$={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},l$={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let c$=(()=>{class t extends $F{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const o=t.parseEventName(i),s=t.eventCallback(o.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>pb().onAndCancel(e,o.domEventName,s))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const o=t._normalizeKey(i.pop());let s="",a=i.indexOf("code");if(a>-1&&(i.splice(a,1),s="code."),QF.forEach(u=>{const f=i.indexOf(u);f>-1&&(i.splice(f,1),s+=u+".")}),s+=o,0!=i.length||0===o.length)return null;const l={};return l.domEventName=r,l.fullKey=s,l}static matchEventFullKeyCode(e,i){let r=a$[e.key]||e.key,o="";return i.indexOf("code.")>-1&&(r=e.code,o="code."),!(null==r||!r)&&(r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),QF.forEach(s=>{s!==r&&(0,l$[s])(e)&&(o+=s+".")}),o+=r,o===i)}static eventCallback(e,i,r){return o=>{t.matchEventFullKeyCode(o,e)&&r.runGuarded(()=>i(o))}}static _normalizeKey(e){return"esc"===e?"escape":e}static#e=this.\u0275fac=function(i){return new(i||t)(kn(cd))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const e4=[{provide:gl,useValue:NF},{provide:n0,useValue:function u$(){uI.makeCurrent()},multi:!0},{provide:cd,useFactory:function h$(){return function EE(t){t0=t}(document),document},deps:[]}],f$=LP(yj,"browser",e4),p$=new hn(""),t4=[{provide:Gy,useClass:class XW{addToWindow(n){si.getAngularTestability=(i,r=!0)=>{const o=n.findTestabilityInTree(i,r);if(null==o)throw new it(5103,!1);return o},si.getAllAngularTestabilities=()=>n.getAllTestabilities(),si.getAllAngularRootElements=()=>n.getAllRootElements(),si.frameworkStabilizers||(si.frameworkStabilizers=[]),si.frameworkStabilizers.push(i=>{const r=si.getAllAngularTestabilities();let o=r.length;const s=function(){o--,0==o&&i()};r.forEach(a=>{a.whenStable(s)})})}findTestabilityInTree(n,e,i){return null==e?null:n.getTestability(e)??(i?pb().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null)}},deps:[]},{provide:TP,useClass:PT,deps:[Sn,FT,Gy]},{provide:PT,useClass:PT,deps:[Sn,FT,Gy]}],n4=[{provide:gf,useValue:"root"},{provide:fl,useFactory:function d$(){return new fl},deps:[]},{provide:dI,useClass:s$,multi:!0,deps:[cd,Sn,gl]},{provide:dI,useClass:c$,multi:!0,deps:[cd]},gI,YF,WF,{provide:k2,useExisting:gI},{provide:class vW{},useClass:KW,deps:[]},[]];let i4=(()=>{class t{constructor(e){}static withServerTransition(e){return{ngModule:t,providers:[{provide:Tg,useValue:e.appId}]}}static#e=this.\u0275fac=function(i){return new(i||t)(kn(p$,12))};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({providers:[...n4,...t4],imports:[FF,Cj]})}return t})(),s4=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:function(i){let r=null;return r=i?new(i||t):kn(b$),r},providedIn:"root"})}return t})(),b$=(()=>{class t extends s4{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case Ha.NONE:return i;case Ha.HTML:return _l(i,"HTML")?fa(i):G1(this._doc,String(i)).toString();case Ha.STYLE:return _l(i,"Style")?fa(i):i;case Ha.SCRIPT:if(_l(i,"Script"))return fa(i);throw new it(5200,!1);case Ha.URL:return _l(i,"URL")?fa(i):Ng(String(i));case Ha.RESOURCE_URL:if(_l(i,"ResourceURL"))return fa(i);throw new it(5201,!1);default:throw new it(5202,!1)}}bypassSecurityTrustHtml(e){return function Jn(t){return new _h(t)}(e)}bypassSecurityTrustStyle(e){return function N1(t){return new NE(t)}(e)}bypassSecurityTrustScript(e){return function Ua(t){return new RE(t)}(e)}bypassSecurityTrustUrl(e){return function R1(t){return new LE(t)}(e)}bypassSecurityTrustResourceUrl(e){return function UE(t){return new BE(t)}(e)}static#e=this.\u0275fac=function(i){return new(i||t)(kn(cd))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();me(4511);var bI=function(t,n){return(bI=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(t,n)};function kc(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}bI(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var ro=function(){return ro=Object.assign||function(n){for(var e,i=1,r=arguments.length;i<r;i++)for(var o in e=arguments[i])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},ro.apply(this,arguments)};function Oe(t,n,e,i){var s,r=arguments.length,o=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(t,n,e,i);else for(var a=t.length-1;a>=0;a--)(s=t[a])&&(o=(r<3?s(o):r>3?s(n,e,o):s(n,e))||o);return r>3&&o&&Object.defineProperty(n,e,o),o}function Oh(t){return this instanceof Oh?(this.v=t,this):new Oh(t)}function d4(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function yI(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(o){e[o]=t[o]&&function(s){return new Promise(function(a,l){!function r(o,s,a,l){Promise.resolve(l).then(function(u){o({value:u,done:a})},s)}(a,l,(s=t[o](s)).done,s.value)})}}}"function"==typeof SuppressedError&&SuppressedError;const xI=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function h4(t){return Rt(t?.then)}function f4(t){return Rt(t[Ls])}function p4(t){return Symbol.asyncIterator&&Rt(t?.[Symbol.asyncIterator])}function g4(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const m4=function j$(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function _4(t){return Rt(t?.[m4])}function b4(t){return function u4(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),o=[];return r=Object.create(("function"==typeof AsyncIterator?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",function s(C){return function(E){return Promise.resolve(E).then(C,g)}}),r[Symbol.asyncIterator]=function(){return this},r;function a(C,E){i[C]&&(r[C]=function(w){return new Promise(function(T,M){o.push([C,w,T,M])>1||l(C,w)})},E&&(r[C]=E(r[C])))}function l(C,E){try{!function u(C){C.value instanceof Oh?Promise.resolve(C.value.v).then(f,g):v(o[0][2],C)}(i[C](E))}catch(w){v(o[0][3],w)}}function f(C){l("next",C)}function g(C){l("throw",C)}function v(C,E){C(E),o.shift(),o.length&&l(o[0][0],o[0][1])}}(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Oh(e.read());if(r)return yield Oh(void 0);yield yield Oh(i)}}finally{e.releaseLock()}})}function v4(t){return Rt(t?.getReader)}function xl(t){if(t instanceof Zi)return t;if(null!=t){if(f4(t))return function G$(t){return new Zi(n=>{const e=t[Ls]();if(Rt(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(xI(t))return function W$(t){return new Zi(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(h4(t))return function $$(t){return new Zi(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,Vr)})}(t);if(p4(t))return y4(t);if(_4(t))return function Y$(t){return new Zi(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(v4(t))return function q$(t){return y4(b4(t))}(t)}throw g4(t)}function y4(t){return new Zi(n=>{(function Z$(t,n){var e,i,r,o;return function l4(t,n,e,i){return new(e||(e=Promise))(function(o,s){function a(f){try{u(i.next(f))}catch(g){s(g)}}function l(f){try{u(i.throw(f))}catch(g){s(g)}}function u(f){f.done?o(f.value):function r(o){return o instanceof e?o:new e(function(s){s(o)})}(f.value).then(a,l)}u((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=d4(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(s){r={error:s}}finally{try{i&&!i.done&&(o=e.return)&&(yield o.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function Ah(t,n,e,i=0,r=!1){const o=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(o),!r)return o}function C4(t,n=0){return ko((e,i)=>{e.subscribe(mo(i,r=>Ah(i,t,()=>i.next(r),n),()=>Ah(i,t,()=>i.complete(),n),r=>Ah(i,t,()=>i.error(r),n)))})}function x4(t,n=0){return ko((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function w4(t,n){if(!t)throw new Error("Iterable cannot be null");return new Zi(e=>{Ah(e,n,()=>{const i=t[Symbol.asyncIterator]();Ah(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function mC(t,n){return n?function tY(t,n){if(null!=t){if(f4(t))return function X$(t,n){return xl(t).pipe(x4(n),C4(n))}(t,n);if(xI(t))return function Q$(t,n){return new Zi(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(h4(t))return function K$(t,n){return xl(t).pipe(x4(n),C4(n))}(t,n);if(p4(t))return w4(t,n);if(_4(t))return function J$(t,n){return new Zi(e=>{let i;return Ah(e,n,()=>{i=t[m4](),Ah(e,n,()=>{let r,o;try{({value:r,done:o}=i.next())}catch(s){return void e.error(s)}o?e.complete():e.next(r)},0,!0)}),()=>Rt(i?.return)&&i.return()})}(t,n);if(v4(t))return function eY(t,n){return w4(b4(t),n)}(t,n)}throw g4(t)}(t,n):xl(t)}const{isArray:nY}=Array,{getPrototypeOf:iY,prototype:rY,keys:oY}=Object;function E4(t){return t&&Rt(t.schedule)}function wI(t){return t[t.length-1]}function EI(t){return E4(wI(t))?t.pop():void 0}const{isArray:uY}=Array;function TI(t){return jo(n=>function dY(t,n){return uY(n)?t(...n):t(n)}(t,n))}function hY(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}function fY(...t){const n=function lY(t){return Rt(wI(t))?t.pop():void 0}(t),{args:e,keys:i}=function sY(t){if(1===t.length){const n=t[0];if(nY(n))return{args:n,keys:null};if(function aY(t){return t&&"object"==typeof t&&iY(t)===rY}(n)){const e=oY(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}(t),r=new Zi(o=>{const{length:s}=e;if(!s)return void o.complete();const a=new Array(s);let l=s,u=s;for(let f=0;f<s;f++){let g=!1;xl(e[f]).subscribe(mo(o,v=>{g||(g=!0,u--),a[f]=v},()=>l--,void 0,()=>{(!l||!g)&&(u||o.next(i?hY(i,a):a),o.complete())}))}});return n?r.pipe(TI(n)):r}let T4=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}static#e=this.\u0275fac=function(i){return new(i||t)(F(Yf),F(_r))};static#t=this.\u0275dir=wn({type:t})}return t})(),rp=(()=>{class t extends T4{static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,features:[tr]})}return t})();const pu=new hn(""),pY={provide:pu,useExisting:ne(()=>Wa),multi:!0};let Wa=(()=>{class t extends rp{writeValue(e){this.setProperty("checked",e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(i,r){1&i&&X("change",function(s){return r.onChange(s.target.checked)})("blur",function(){return r.onTouched()})},features:[xr([pY]),tr]})}return t})();const gY={provide:pu,useExisting:ne(()=>Rr),multi:!0},I4=new hn("");let Rr=(()=>{class t extends T4{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function mY(){const t=pb()?pb().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",e??"")}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}static#e=this.\u0275fac=function(i){return new(i||t)(F(Yf),F(_r),F(I4,8))};static#t=this.\u0275dir=wn({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(i,r){1&i&&X("input",function(s){return r._handleInput(s.target.value)})("blur",function(){return r.onTouched()})("compositionstart",function(){return r._compositionStart()})("compositionend",function(s){return r._compositionEnd(s.target.value)})},features:[xr([gY]),tr]})}return t})();function kh(t){return null==t||("string"==typeof t||Array.isArray(t))&&0===t.length}function S4(t){return null!=t&&"number"==typeof t.length}const Zs=new hn(""),Ph=new hn("");function O4(t){return kh(t.value)?{required:!0}:null}function _C(t){return null}function R4(t){return null!=t}function L4(t){return Wy(t)?mC(t):t}function B4(t){let n={};return t.forEach(e=>{n=null!=e?{...n,...e}:n}),0===Object.keys(n).length?null:n}function U4(t,n){return n.map(e=>e(t))}function H4(t){return t.map(n=>function bY(t){return!t.validate}(n)?n:e=>n.validate(e))}function II(t){return null!=t?function z4(t){if(!t)return null;const n=t.filter(R4);return 0==n.length?null:function(e){return B4(U4(e,n))}}(H4(t)):null}function SI(t){return null!=t?function V4(t){if(!t)return null;const n=t.filter(R4);return 0==n.length?null:function(e){return fY(U4(e,n).map(L4)).pipe(jo(B4))}}(H4(t)):null}function j4(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function MI(t){return t?Array.isArray(t)?t:[t]:[]}function bC(t,n){return Array.isArray(t)?t.includes(n):t===n}function $4(t,n){const e=MI(n);return MI(t).forEach(r=>{bC(e,r)||e.push(r)}),e}function Y4(t,n){return MI(n).filter(e=>!bC(t,e))}class q4{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=II(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=SI(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n=void 0){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class va extends q4{get formDirective(){return null}get path(){return null}}class Fh extends q4{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Z4{constructor(n){this._cd=n}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Lr=(()=>{class t extends Z4{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(F(Fh,2))};static#t=this.\u0275dir=wn({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(i,r){2&i&&eb("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)},features:[tr]})}return t})(),op=(()=>{class t extends Z4{constructor(e){super(e)}static#e=this.\u0275fac=function(i){return new(i||t)(F(va,10))};static#t=this.\u0275dir=wn({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(i,r){2&i&&eb("ng-untouched",r.isUntouched)("ng-touched",r.isTouched)("ng-pristine",r.isPristine)("ng-dirty",r.isDirty)("ng-valid",r.isValid)("ng-invalid",r.isInvalid)("ng-pending",r.isPending)("ng-submitted",r.isSubmitted)},features:[tr]})}return t})();const xb="VALID",yC="INVALID",_m="PENDING",wb="DISABLED";function AI(t){return(CC(t)?t.validators:t)||null}function kI(t,n){return(CC(n)?n.asyncValidators:t)||null}function CC(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}class PI{constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(n),this._assignAsyncValidators(e)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===xb}get invalid(){return this.status===yC}get pending(){return this.status==_m}get disabled(){return this.status===wb}get enabled(){return this.status!==wb}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._assignValidators(n)}setAsyncValidators(n){this._assignAsyncValidators(n)}addValidators(n){this.setValidators($4(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators($4(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(Y4(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(Y4(n,this._rawAsyncValidators))}hasValidator(n){return bC(this._rawValidators,n)}hasAsyncValidator(n){return bC(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=_m,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=wb,this.errors=null,this._forEachChild(i=>{i.disable({...n,onlySelf:!0})}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=xb,this._forEachChild(i=>{i.enable({...n,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors({...n,skipPristineCheck:e}),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}getRawValue(){return this.value}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xb||this.status===_m)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?wb:xb}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=_m,this._hasOwnPendingAsyncValidator=!0;const e=L4(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){let e=n;return null==e||(Array.isArray(e)||(e=e.split(".")),0===e.length)?null:e.reduce((i,r)=>i&&i._find(r),this)}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new Qn,this.statusChanges=new Qn}_calculateStatus(){return this._allControlsDisabled()?wb:this.errors?yC:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_m)?_m:this._anyControlsHaveStatus(yC)?yC:xb}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){CC(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(n){return null}_assignValidators(n){this._rawValidators=Array.isArray(n)?n.slice():n,this._composedValidatorFn=function xY(t){return Array.isArray(t)?II(t):t||null}(this._rawValidators)}_assignAsyncValidators(n){this._rawAsyncValidators=Array.isArray(n)?n.slice():n,this._composedAsyncValidatorFn=function wY(t){return Array.isArray(t)?SI(t):t||null}(this._rawAsyncValidators)}}class FI extends PI{constructor(n,e,i){super(AI(e),kI(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){(function Q4(t,n,e){t._forEachChild((i,r)=>{if(void 0===e[r])throw new it(1002,"")})})(this,0,n),Object.keys(n).forEach(i=>{(function K4(t,n,e){const i=t.controls;if(!(n?Object.keys(i):i).length)throw new it(1e3,"");if(!i[e])throw new it(1001,"")})(this,!0,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{const r=this.controls[i];r&&r.patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n?n[r]:null,{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=e.getRawValue(),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const[e,i]of Object.entries(this.controls))if(this.contains(e)&&n(i))return!0;return!1}_reduceValue(){return this._reduceChildren({},(e,i,r)=>((i.enabled||this.disabled)&&(e[r]=i.value),e))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,o)=>{i=e(i,r,o)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_find(n){return this.controls.hasOwnProperty(n)?this.controls[n]:null}}const bm=new hn("CallSetDisabledState",{providedIn:"root",factory:()=>xC}),xC="always";function Eb(t,n,e=xC){NI(t,n),n.valueAccessor.writeValue(t.value),(t.disabled||"always"===e)&&n.valueAccessor.setDisabledState?.(t.disabled),function IY(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&J4(t,n)})}(t,n),function MY(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function SY(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&J4(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function TY(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function TC(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function NI(t,n){const e=function G4(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(j4(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function W4(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(j4(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();TC(n._rawValidators,r),TC(n._rawAsyncValidators,r)}function J4(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}const PY={provide:va,useExisting:ne(()=>hd)},Tb=Promise.resolve();let hd=(()=>{class t extends va{constructor(e,i,r){super(),this.callSetDisabledState=r,this.submitted=!1,this._directives=new Set,this.ngSubmit=new Qn,this.form=new FI({},II(e),SI(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Tb.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Eb(e.control,e,this.callSetDisabledState),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Tb.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Tb.then(()=>{const i=this._findContainer(e.path),r=new FI({});(function eN(t,n){NI(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Tb.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){Tb.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function tN(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),"dialog"===e?.target?.method}onReset(){this.resetForm()}resetForm(e=void 0){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}static#e=this.\u0275fac=function(i){return new(i||t)(F(Zs,10),F(Ph,10),F(bm,8))};static#t=this.\u0275dir=wn({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(i,r){1&i&&X("submit",function(s){return r.onSubmit(s)})("reset",function(){return r.onReset()})},inputs:{options:[ae.None,"ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[xr([PY]),tr]})}return t})();function nN(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}function iN(t){return"object"==typeof t&&null!==t&&2===Object.keys(t).length&&"value"in t&&"disabled"in t}const rN=class extends PI{constructor(n=null,e,i){super(AI(e),kI(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),CC(e)&&(e.nonNullable||e.initialValueIsDefault)&&(this.defaultValue=iN(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){nN(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){nN(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){iN(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}},RY={provide:Fh,useExisting:ne(()=>Tr)},aN=Promise.resolve();let Tr=(()=>{class t extends Fh{constructor(e,i,r,o,s,a){super(),this._changeDetectorRef=s,this.callSetDisabledState=a,this.control=new rN,this._registered=!1,this.name="",this.update=new Qn,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function BI(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(o=>{o.constructor===Rr?e=o:function AY(t){return Object.getPrototypeOf(t.constructor)===rp}(o)?i=o:r=o}),r||i||e||null}(0,o)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function LI(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Eb(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){aN.then(()=>{this.control.setValue(e,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=0!==i&&np(i);aN.then(()=>{r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(e){return this._parent?function wC(t,n){return[...n.path,t]}(e,this._parent):[e]}static#e=this.\u0275fac=function(i){return new(i||t)(F(va,9),F(Zs,10),F(Ph,10),F(pu,10),F(io,8),F(bm,8))};static#t=this.\u0275dir=wn({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[ae.None,"disabled","isDisabled"],model:[ae.None,"ngModel","model"],options:[ae.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[xr([RY]),tr,mr]})}return t})(),sp=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=wn({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]})}return t})();const LY={provide:pu,useExisting:ne(()=>Xl),multi:!0};let Xl=(()=>{class t extends rp{writeValue(e){this.setProperty("value",e??"")}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(i,r){1&i&&X("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[xr([LY]),tr]})}return t})();const BY={provide:pu,useExisting:ne(()=>Nh),multi:!0};let UY=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Nh=(()=>{class t extends rp{constructor(e,i,r,o){super(e,i),this._registry=r,this._injector=o,this.setDisabledStateFired=!1,this.onChange=()=>{},this.callSetDisabledState=En(bm,{optional:!0})??xC}ngOnInit(){this._control=this._injector.get(Fh),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}setDisabledState(e){(this.setDisabledStateFired||e||"whenDisabledForLegacyCode"===this.callSetDisabledState)&&this.setProperty("disabled",e),this.setDisabledStateFired=!0}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}static#e=this.\u0275fac=function(i){return new(i||t)(F(Yf),F(_r),F(UY),F(Ts))};static#t=this.\u0275dir=wn({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(i,r){1&i&&X("change",function(){return r.onChange()})("blur",function(){return r.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[xr([BY]),tr]})}return t})();const HY={provide:pu,useExisting:ne(()=>Kl),multi:!0};let Kl=(()=>{class t extends rp{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(i,r){1&i&&X("change",function(s){return r.onChange(s.target.value)})("input",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},features:[xr([HY]),tr]})}return t})();const $Y={provide:pu,useExisting:ne(()=>wl),multi:!0};function hN(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let wl=(()=>{class t extends rp{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=hN(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function YY(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(i,r){1&i&&X("change",function(s){return r.onChange(s.target.value)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[xr([$Y]),tr]})}return t})(),ya=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(hN(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r),F(Yf),F(wl,9))};static#t=this.\u0275dir=wn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return t})();const qY={provide:pu,useExisting:ne(()=>VI),multi:!0};function fN(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let VI=(()=>{class t extends rp{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(o=>this._getOptionId(o));i=(o,s)=>{o._setSelected(r.indexOf(s.toString())>-1)}}else i=(r,o)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],o=i.selectedOptions;if(void 0!==o){const s=o;for(let a=0;a<s.length;a++){const u=this._getOptionValue(s[a].value);r.push(u)}}else{const s=i.options;for(let a=0;a<s.length;a++){const l=s[a];if(l.selected){const u=this._getOptionValue(l.value);r.push(u)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of this._optionMap.keys())if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function ZY(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(i,r){1&i&&X("change",function(s){return r.onChange(s.target)})("blur",function(){return r.onTouched()})},inputs:{compareWith:"compareWith"},features:[xr([qY]),tr]})}return t})(),Ca=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(fN(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(fN(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r),F(Yf),F(VI,9))};static#t=this.\u0275dir=wn({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}})}return t})();function pN(t){return"number"==typeof t?t:parseInt(t,10)}function gN(t){return"number"==typeof t?t:parseFloat(t)}let ap=(()=>{class t{constructor(){this._validator=_C}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):_C,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275dir=wn({type:t,features:[mr]})}return t})();const XY={provide:Zs,useExisting:ne(()=>fd),multi:!0};let fd=(()=>{class t extends ap{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>gN(e),this.createValidator=e=>function D4(t){return n=>{if(kh(n.value)||kh(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$t("max",r._enabled?r.max:null)},inputs:{max:"max"},features:[xr([XY]),tr]})}return t})();const KY={provide:Zs,useExisting:ne(()=>pd),multi:!0};let pd=(()=>{class t extends ap{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>gN(e),this.createValidator=e=>function M4(t){return n=>{if(kh(n.value)||kh(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$t("min",r._enabled?r.min:null)},inputs:{min:"min"},features:[xr([KY]),tr]})}return t})();const QY={provide:Zs,useExisting:ne(()=>SC),multi:!0};let SC=(()=>{class t extends ap{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=np,this.createValidator=e=>O4}enabled(e){return e}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(i,r){2&i&&$t("required",r._enabled?"":null)},inputs:{required:"required"},features:[xr([QY]),tr]})}return t})();const tq={provide:Zs,useExisting:ne(()=>jI),multi:!0};let jI=(()=>{class t extends ap{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>pN(e),this.createValidator=e=>function P4(t){return n=>kh(n.value)||!S4(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$t("minlength",r._enabled?r.minlength:null)},inputs:{minlength:"minlength"},features:[xr([tq]),tr]})}return t})();const nq={provide:Zs,useExisting:ne(()=>GI),multi:!0};let GI=(()=>{class t extends ap{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>pN(e),this.createValidator=e=>function F4(t){return n=>S4(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}static#e=this.\u0275fac=(()=>{let e;return function(r){return(e||(e=cs(t)))(r||t)}})();static#t=this.\u0275dir=wn({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(i,r){2&i&&$t("maxlength",r._enabled?r.maxlength:null)},inputs:{maxlength:"maxlength"},features:[xr([nq]),tr]})}return t})(),rq=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({})}return t})(),sq=(()=>{class t{static withConfig(e){return{ngModule:t,providers:[{provide:bm,useValue:e.callSetDisabledState??xC}]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({imports:[rq]})}return t})();var Rn=function(t){return t[t.State=0]="State",t[t.Transition=1]="Transition",t[t.Sequence=2]="Sequence",t[t.Group=3]="Group",t[t.Animate=4]="Animate",t[t.Keyframes=5]="Keyframes",t[t.Style=6]="Style",t[t.Trigger=7]="Trigger",t[t.Reference=8]="Reference",t[t.AnimateChild=9]="AnimateChild",t[t.AnimateRef=10]="AnimateRef",t[t.Query=11]="Query",t[t.Stagger=12]="Stagger",t}(Rn||{});const gd="*";function Vn(t,n){return{type:Rn.Trigger,name:t,definitions:n,options:{}}}function jt(t,n=null){return{type:Rn.Animate,styles:n,timings:t}}function Pe(t){return{type:Rn.Style,styles:t,offset:null}}function WI(t,n,e){return{type:Rn.State,name:t,styles:n,options:e}}function mn(t){return{type:Rn.Keyframes,steps:t}}function Xt(t,n,e=null){return{type:Rn.Transition,expr:t,animation:n,options:e}}class Ib{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class vN{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const o=this.players.length;0==o?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++e==o&&this._onFinish()}),s.onDestroy(()=>{++i==o&&this._onDestroy()}),s.onStart(()=>{++r==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}function yN(t){return new it(3e3,!1)}function Rh(t){switch(t.length){case 0:return new Ib;case 1:return t[0];default:return new vN(t)}}function CN(t,n,e=new Map,i=new Map){const r=[],o=[];let s=-1,a=null;if(n.forEach(l=>{const u=l.get("offset"),f=u==s,g=f&&a||new Map;l.forEach((v,C)=>{let E=C,w=v;if("offset"!==C)switch(E=t.normalizePropertyName(E,r),w){case"!":w=e.get(C);break;case gd:w=i.get(C);break;default:w=t.normalizeStyleValue(C,E,w,r)}g.set(E,w)}),f||o.push(g),a=g,s=u}),r.length)throw function Fq(t){return new it(3502,!1)}();return o}function YI(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&qI(e,"start",t)));break;case"done":t.onDone(()=>i(e&&qI(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&qI(e,"destroy",t)))}}function qI(t,n,e){const o=ZI(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,e.totalTime??t.totalTime,!!e.disabled),s=t._data;return null!=s&&(o._data=s),o}function ZI(t,n,e,i,r="",o=0,s){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:o,disabled:!!s}}function El(t,n,e){let i=t.get(n);return i||t.set(n,i=e),i}function xN(t){const n=t.indexOf(":");return[t.substring(1,n),t.slice(n+1)]}const $q=typeof document>"u"?null:document.documentElement;function XI(t){const n=t.parentNode||t.host||null;return n===$q?null:n}let lp=null,wN=!1;function EN(t,n){for(;n;){if(n===t)return!0;n=XI(n)}return!1}function TN(t,n,e){if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]}let KI=(()=>{class t{validateStyleProperty(e){return function qq(t){lp||(lp=function Zq(){return typeof document<"u"?document.body:null}()||{},wN=!!lp.style&&"WebkitAppearance"in lp.style);let n=!0;return lp.style&&!function Yq(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in lp.style,!n&&wN&&(n="Webkit"+t.charAt(0).toUpperCase()+t.slice(1)in lp.style)),n}(e)}matchesElement(e,i){return!1}containsElement(e,i){return EN(e,i)}getParentElement(e){return XI(e)}query(e,i,r){return TN(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,o,s,a=[],l){return new Ib(r,o)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();class QI{static#e=this.NOOP=new KI}class JI{}const Kq=1e3,eS="ng-enter",MC="ng-leave",DC="ng-trigger",OC=".ng-trigger",SN="ng-animating",tS=".ng-animating";function md(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:nS(parseFloat(n[1]),n[2])}function nS(t,n){return"s"===n?t*Kq:t}function AC(t,n,e){return t.hasOwnProperty("duration")?t:function Jq(t,n,e){let r,o=0,s="";if("string"==typeof t){const a=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===a)return n.push(yN()),{duration:0,delay:0,easing:""};r=nS(parseFloat(a[1]),a[2]);const l=a[3];null!=l&&(o=nS(parseFloat(l),a[4]));const u=a[5];u&&(s=u)}else r=t;if(!e){let a=!1,l=n.length;r<0&&(n.push(function hq(){return new it(3100,!1)}()),a=!0),o<0&&(n.push(function fq(){return new it(3101,!1)}()),a=!0),a&&n.splice(l,0,yN())}return{duration:r,delay:o,easing:s}}(t,n,e)}function gu(t,n,e){n.forEach((i,r)=>{const o=rS(r);e&&!e.has(r)&&e.set(r,t.style[o]),t.style[o]=i})}function cp(t,n){n.forEach((e,i)=>{const r=rS(i);t.style[r]=""})}function Sb(t){return Array.isArray(t)?1==t.length?t[0]:function aq(t,n=null){return{type:Rn.Sequence,steps:t,options:n}}(t):t}const iS=new RegExp("{{\\s*(.+?)\\s*}}","g");function DN(t){let n=[];if("string"==typeof t){let e;for(;e=iS.exec(t);)n.push(e[1]);iS.lastIndex=0}return n}function Mb(t,n,e){const i=`${t}`,r=i.replace(iS,(o,s)=>{let a=n[s];return null==a&&(e.push(function gq(t){return new it(3003,!1)}()),a=""),a.toString()});return r==i?t:r}const nZ=/-+([a-z0-9])/g;function rS(t){return t.replace(nZ,(...n)=>n[1].toUpperCase())}function Tl(t,n,e){switch(n.type){case Rn.Trigger:return t.visitTrigger(n,e);case Rn.State:return t.visitState(n,e);case Rn.Transition:return t.visitTransition(n,e);case Rn.Sequence:return t.visitSequence(n,e);case Rn.Group:return t.visitGroup(n,e);case Rn.Animate:return t.visitAnimate(n,e);case Rn.Keyframes:return t.visitKeyframes(n,e);case Rn.Style:return t.visitStyle(n,e);case Rn.Reference:return t.visitReference(n,e);case Rn.AnimateChild:return t.visitAnimateChild(n,e);case Rn.AnimateRef:return t.visitAnimateRef(n,e);case Rn.Query:return t.visitQuery(n,e);case Rn.Stagger:return t.visitStagger(n,e);default:throw function mq(t){return new it(3004,!1)}()}}function oS(t,n){return window.getComputedStyle(t)[n]}const oZ=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]);class ON extends JI{normalizePropertyName(n,e){return rS(n)}normalizeStyleValue(n,e,i,r){let o="";const s=i.toString().trim();if(oZ.has(e)&&0!==i&&"0"!==i)if("number"==typeof i)o="px";else{const a=i.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&0==a[1].length&&r.push(function _q(t,n){return new it(3005,!1)}())}return s+o}}const kC="*";const PC=new Set(["true","1"]),FC=new Set(["false","0"]);function AN(t,n){const e=PC.has(t)||FC.has(t),i=PC.has(n)||FC.has(n);return(r,o)=>{let s=t==kC||t==r,a=n==kC||n==o;return!s&&e&&"boolean"==typeof r&&(s=r?PC.has(t):FC.has(t)),!a&&i&&"boolean"==typeof o&&(a=o?PC.has(n):FC.has(n)),s&&a}}const cZ=new RegExp("s*:selfs*,?","g");function sS(t,n,e,i){return new uZ(t).build(n,e,i)}class uZ{constructor(n){this._driver=n}build(n,e,i){const r=new fZ(e);return this._resetContextStyleTimingState(r),Tl(this,Sb(n),r)}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles=new Map,n.collectedStyles.set("",new Map),n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const o=[],s=[];return"@"==n.name.charAt(0)&&e.errors.push(function bq(){return new it(3006,!1)}()),n.definitions.forEach(a=>{if(this._resetContextStyleTimingState(e),a.type==Rn.State){const l=a,u=l.name;u.toString().split(/\s*,\s*/).forEach(f=>{l.name=f,o.push(this.visitState(l,e))}),l.name=u}else if(a.type==Rn.Transition){const l=this.visitTransition(a,e);i+=l.queryCount,r+=l.depCount,s.push(l)}else e.errors.push(function vq(){return new it(3007,!1)}())}),{type:Rn.Trigger,name:n.name,states:o,transitions:s,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const o=new Set,s=r||{};i.styles.forEach(a=>{a instanceof Map&&a.forEach(l=>{DN(l).forEach(u=>{s.hasOwnProperty(u)||o.add(u)})})}),o.size&&e.errors.push(function yq(t,n){return new it(3008,!1)}(0,o.values()))}return{type:Rn.State,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=Tl(this,Sb(n.animation),e),r=function sZ(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function aZ(t,n,e){if(":"==t[0]){const l=function lZ(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function Oq(t){return new it(3016,!1)}()),"* => *"}}(t,e);if("function"==typeof l)return void n.push(l);t=l}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function Dq(t){return new it(3015,!1)}()),n;const r=i[1],o=i[2],s=i[3];n.push(AN(r,s)),"<"==o[0]&&(r!=kC||s!=kC)&&n.push(AN(s,r))}(i,e,n)):e.push(t),e}(n.expr,e.errors);return{type:Rn.Transition,matchers:r,animation:i,queryCount:e.queryCount,depCount:e.depCount,options:up(n.options)}}visitSequence(n,e){return{type:Rn.Sequence,steps:n.steps.map(i=>Tl(this,i,e)),options:up(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const o=n.steps.map(s=>{e.currentTime=i;const a=Tl(this,s,e);return r=Math.max(r,e.currentTime),a});return e.currentTime=r,{type:Rn.Group,steps:o,options:up(n.options)}}visitAnimate(n,e){const i=function gZ(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return aS(AC(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(o=>"{"==o.charAt(0)&&"{"==o.charAt(1))){const o=aS(0,0,"");return o.dynamic=!0,o.strValue=e,o}const r=AC(e,n);return aS(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,o=n.styles?n.styles:Pe({});if(o.type==Rn.Keyframes)r=this.visitKeyframes(o,e);else{let s=n.styles,a=!1;if(!s){a=!0;const u={};i.easing&&(u.easing=i.easing),s=Pe(u)}e.currentTime+=i.duration+i.delay;const l=this.visitStyle(s,e);l.isEmptyStep=a,r=l}return e.currentAnimateTimings=null,{type:Rn.Animate,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[],r=Array.isArray(n.styles)?n.styles:[n.styles];for(let a of r)"string"==typeof a?a===gd?i.push(a):e.errors.push(new it(3002,!1)):i.push(new Map(Object.entries(a)));let o=!1,s=null;return i.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o))for(let l of a.values())if(l.toString().indexOf("{{")>=0){o=!0;break}}),{type:Rn.Style,styles:i,easing:s,offset:n.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,o=e.currentTime;i&&o>0&&(o-=i.duration+i.delay),n.styles.forEach(s=>{"string"!=typeof s&&s.forEach((a,l)=>{const u=e.collectedStyles.get(e.currentQuerySelector),f=u.get(l);let g=!0;f&&(o!=r&&o>=f.startTime&&r<=f.endTime&&(e.errors.push(function xq(t,n,e,i,r){return new it(3010,!1)}()),g=!1),o=f.startTime),g&&u.set(l,{startTime:o,endTime:r}),e.options&&function tZ(t,n,e){const i=n.params||{},r=DN(t);r.length&&r.forEach(o=>{i.hasOwnProperty(o)||e.push(function pq(t){return new it(3001,!1)}())})}(a,e.options,e.errors)})})}visitKeyframes(n,e){const i={type:Rn.Keyframes,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function wq(){return new it(3011,!1)}()),i;let o=0;const s=[];let a=!1,l=!1,u=0;const f=n.steps.map(M=>{const S=this._makeStyleAst(M,e);let P=null!=S.offset?S.offset:function pZ(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(e instanceof Map&&e.has("offset")){const i=e;n=parseFloat(i.get("offset")),i.delete("offset")}});else if(t instanceof Map&&t.has("offset")){const e=t;n=parseFloat(e.get("offset")),e.delete("offset")}return n}(S.styles),Z=0;return null!=P&&(o++,Z=S.offset=P),l=l||Z<0||Z>1,a=a||Z<u,u=Z,s.push(Z),S});l&&e.errors.push(function Eq(){return new it(3012,!1)}()),a&&e.errors.push(function Tq(){return new it(3200,!1)}());const g=n.steps.length;let v=0;o>0&&o<g?e.errors.push(function Iq(){return new it(3202,!1)}()):0==o&&(v=1/(g-1));const C=g-1,E=e.currentTime,w=e.currentAnimateTimings,T=w.duration;return f.forEach((M,S)=>{const P=v>0?S==C?1:v*S:s[S],Z=P*T;e.currentTime=E+w.delay+Z,w.duration=Z,this._validateStyleAst(M,e),M.offset=P,i.styles.push(M)}),i}visitReference(n,e){return{type:Rn.Reference,animation:Tl(this,Sb(n.animation),e),options:up(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:Rn.AnimateChild,options:up(n.options)}}visitAnimateRef(n,e){return{type:Rn.AnimateRef,animation:this.visitReference(n.animation,e),options:up(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[o,s]=function dZ(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(cZ,"")),t=t.replace(/@\*/g,OC).replace(/@\w+/g,e=>OC+"-"+e.slice(1)).replace(/:animating/g,tS),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+o:o,El(e.collectedStyles,e.currentQuerySelector,new Map);const a=Tl(this,Sb(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:Rn.Query,selector:o,limit:r.limit||0,optional:!!r.optional,includeSelf:s,animation:a,originalSelector:n.selector,options:up(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function Sq(){return new it(3013,!1)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:AC(n.timings,e.errors,!0);return{type:Rn.Stagger,animation:Tl(this,Sb(n.animation),e),timings:i,options:null}}}class fZ{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function up(t){return t?(t={...t}).params&&(t.params=function hZ(t){return t?{...t}:null}(t.params)):t={},t}function aS(t,n,e){return{duration:t,delay:n,easing:e}}function lS(t,n,e,i,r,o,s=null,a=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:o,totalTime:r+o,easing:s,subTimeline:a}}class NC{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const bZ=new RegExp(":enter","g"),yZ=new RegExp(":leave","g");function cS(t,n,e,i,r,o=new Map,s=new Map,a,l,u=[]){return(new CZ).buildKeyframes(t,n,e,i,r,o,s,a,l,u)}class CZ{buildKeyframes(n,e,i,r,o,s,a,l,u,f=[]){u=u||new NC;const g=new uS(n,e,u,r,o,f,[]);g.options=l;const v=l.delay?md(l.delay):0;g.currentTimeline.delayNextStep(v),g.currentTimeline.setStyles([s],null,g.errors,l),Tl(this,i,g);const C=g.timelines.filter(E=>E.containsAnimation());if(C.length&&a.size){let E;for(let w=C.length-1;w>=0;w--){const T=C[w];if(T.element===e){E=T;break}}E&&!E.allowOnlyTimelineStyles()&&E.setStyles([a],null,g.errors,l)}return C.length?C.map(E=>E.buildKeyframes()):[lS(e,[],[],[],0,v,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),o=e.currentTimeline.currentTime,s=this._visitSubInstructions(i,r,r.options);o!=s&&e.transformIntoNewTimeline(s)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this._applyAnimationRefDelays([n.options,n.animation.options],e,i),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_applyAnimationRefDelays(n,e,i){for(const r of n){const o=r?.delay;if(o){const s="number"==typeof o?o:md(Mb(o,r?.params??{},e.errors));i.delayNextStep(s)}}}_visitSubInstructions(n,e,i){let o=e.currentTimeline.currentTime;const s=null!=i.duration?md(i.duration):null,a=null!=i.delay?md(i.delay):null;return 0!==s&&n.forEach(l=>{const u=e.appendInstructionToTimeline(l,s,a);o=Math.max(o,u.duration+u.delay)}),o}visitReference(n,e){e.updateOptions(n.options,!0),Tl(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const o=n.options;if(o&&(o.params||o.delay)&&(r=e.createSubContext(o),r.transformIntoNewTimeline(),null!=o.delay)){r.previousNode.type==Rn.Style&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=RC);const s=md(o.delay);r.delayNextStep(s)}n.steps.length&&(n.steps.forEach(s=>Tl(this,s,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const o=n.options&&n.options.delay?md(n.options.delay):0;n.steps.forEach(s=>{const a=e.createSubContext(n.options);o&&a.delayNextStep(o),Tl(this,s,a),r=Math.max(r,a.currentTimeline.currentTime),i.push(a.currentTimeline)}),i.forEach(s=>e.currentTimeline.mergeTimelineCollectedStyles(s)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return AC(e.params?Mb(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const o=n.style;o.type==Rn.Keyframes?this.visitKeyframes(o,e):(e.incrementTime(i.duration),this.visitStyle(o,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.hasCurrentStyleProperties()&&i.forwardFrame();const o=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(o):i.setStyles(n.styles,o,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,o=i.duration,a=e.createSubContext().currentTimeline;a.easing=i.easing,n.styles.forEach(l=>{a.forwardTime((l.offset||0)*o),a.setStyles(l.styles,l.easing,e.errors,e.options),a.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(a),e.transformIntoNewTimeline(r+o),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},o=r.delay?md(r.delay):0;o&&(e.previousNode.type===Rn.Style||0==i&&e.currentTimeline.hasCurrentStyleProperties())&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=RC);let s=i;const a=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=a.length;let l=null;a.forEach((u,f)=>{e.currentQueryIndex=f;const g=e.createSubContext(n.options,u);o&&g.delayNextStep(o),u===e.element&&(l=g.currentTimeline),Tl(this,n.animation,g),g.currentTimeline.applyStylesToKeyframe(),s=Math.max(s,g.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(s),l&&(e.currentTimeline.mergeTimelineCollectedStyles(l),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,o=n.timings,s=Math.abs(o.duration),a=s*(e.currentQueryTotal-1);let l=s*e.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":l=a-l;break;case"full":l=i.currentStaggerTime}const f=e.currentTimeline;l&&f.delayNextStep(l);const g=f.currentTime;Tl(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-g+(r.startTime-i.currentTimeline.startTime)}}const RC={};class uS{constructor(n,e,i,r,o,s,a,l){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=RC,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=l||new LC(this._driver,e,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=md(i.duration)),null!=i.delay&&(r.delay=md(i.delay));const o=i.params;if(o){let s=r.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!e||!s.hasOwnProperty(a))&&(s[a]=Mb(o[a],s,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,o=new uS(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(n),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(n){return this.previousNode=RC,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:e??n.duration,delay:this.currentTimeline.currentTime+(i??0)+n.delay,easing:""},o=new xZ(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(o),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,o,s){let a=[];if(r&&a.push(this.element),n.length>0){n=(n=n.replace(bZ,"."+this._enterClassName)).replace(yZ,"."+this._leaveClassName);let u=this._driver.query(this.element,n,1!=i);0!==i&&(u=i<0?u.slice(u.length+i,u.length):u.slice(0,i)),a.push(...u)}return!o&&0==a.length&&s.push(function Mq(t){return new it(3014,!1)}()),a}}class LC{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1===this._keyframes.size&&this._pendingStyles.size;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new LC(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles.set(n,e),this._globalTimelineStyles.set(n,e),this._styleSummary.set(n,{time:this.currentTime,value:e})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&this._previousKeyframe.set("easing",n);for(let[e,i]of this._globalTimelineStyles)this._backFill.set(e,i||gd),this._currentKeyframe.set(e,gd);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&this._previousKeyframe.set("easing",e);const o=r&&r.params||{},s=function wZ(t,n){const e=new Map;let i;return t.forEach(r=>{if("*"===r){i??=n.keys();for(let o of i)e.set(o,gd)}else for(let[o,s]of r)e.set(o,s)}),e}(n,this._globalTimelineStyles);for(let[a,l]of s){const u=Mb(l,o,i);this._pendingStyles.set(a,u),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??gd),this._updateStyle(a,u)}}applyStylesToKeyframe(){0!=this._pendingStyles.size&&(this._pendingStyles.forEach((n,e)=>{this._currentKeyframe.set(e,n)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((n,e)=>{this._currentKeyframe.has(e)||this._currentKeyframe.set(e,n)}))}snapshotCurrentStyles(){for(let[n,e]of this._localTimelineStyles)this._pendingStyles.set(n,e),this._updateStyle(n,e)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){n._styleSummary.forEach((e,i)=>{const r=this._styleSummary.get(i);(!r||e.time>r.time)&&this._updateStyle(i,e.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((a,l)=>{const u=new Map([...this._backFill,...a]);u.forEach((f,g)=>{"!"===f?n.add(g):f===gd&&e.add(g)}),i||u.set("offset",l/this.duration),r.push(u)});const o=[...n.values()],s=[...e.values()];if(i){const a=r[0],l=new Map(a);a.set("offset",0),l.set("offset",1),r=[a,l]}return lS(this.element,r,o,s,this.duration,this.startTime,this.easing,!1)}}class xZ extends LC{constructor(n,e,i,r,o,s,a=!1){super(n,e,s.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const o=[],s=i+e,a=e/s,l=new Map(n[0]);l.set("offset",0),o.push(l);const u=new Map(n[0]);u.set("offset",FN(a)),o.push(u);const f=n.length-1;for(let g=1;g<=f;g++){let v=new Map(n[g]);const C=v.get("offset");v.set("offset",FN((e+C*i)/s)),o.push(v)}i=s,e=0,r="",n=o}return lS(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function FN(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}function NN(t,n,e,i,r,o,s,a,l,u,f,g,v){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:o,toState:i,toStyles:s,timelines:a,queriedElements:l,preStyleProps:u,postStyleProps:f,totalTime:g,errors:v}}const dS={};class RN{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function EZ(t,n,e,i,r){return t.some(o=>o(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){let r=this._stateStyles.get("*");return void 0!==n&&(r=this._stateStyles.get(n?.toString())||r),r?r.buildStyles(e,i):new Map}build(n,e,i,r,o,s,a,l,u,f){const g=[],v=this.ast.options&&this.ast.options.params||dS,E=this.buildStyles(i,a&&a.params||dS,g),w=l&&l.params||dS,T=this.buildStyles(r,w,g),M=new Set,S=new Map,P=new Map,Z="void"===r,ee={params:LN(w,v),delay:this.ast.options?.delay},B=f?[]:cS(n,e,this.ast.animation,o,s,E,T,ee,u,g);let J=0;return B.forEach(le=>{J=Math.max(le.duration+le.delay,J)}),g.length?NN(e,this._triggerName,i,r,Z,E,T,[],[],S,P,J,g):(B.forEach(le=>{const se=le.element,fe=El(S,se,new Set);le.preStyleProps.forEach(ue=>fe.add(ue));const Se=El(P,se,new Set);le.postStyleProps.forEach(ue=>Se.add(ue)),se!==e&&M.add(se)}),NN(e,this._triggerName,i,r,Z,E,T,B,[...M.values()],S,P,J))}}function LN(t,n){const e={...n};return Object.entries(t).forEach(([i,r])=>{null!=r&&(e[i]=r)}),e}class TZ{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i=new Map,r=LN(n,this.defaultParams);return this.styles.styles.forEach(o=>{"string"!=typeof o&&o.forEach((s,a)=>{s&&(s=Mb(s,r,e));const l=this.normalizer.normalizePropertyName(a,e);s=this.normalizer.normalizeStyleValue(a,l,s,e),i.set(a,s)})}),i}}class SZ{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states=new Map,e.states.forEach(r=>{this.states.set(r.name,new TZ(r.style,r.options&&r.options.params||{},i))}),BN(this.states,"true","1"),BN(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new RN(n,r,this.states))}),this.fallbackTransition=function MZ(t,n,e){return new RN(t,{type:Rn.Transition,animation:{type:Rn.Sequence,steps:[],options:null},matchers:[(s,a)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(s=>s.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function BN(t,n,e){t.has(n)?t.has(e)||t.set(e,t.get(n)):t.has(e)&&t.set(n,t.get(e))}const DZ=new NC;class OZ{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations=new Map,this._playersById=new Map,this.players=[]}register(n,e){const i=[],o=sS(this._driver,e,i,[]);if(i.length)throw function Nq(t){return new it(3503,!1)}();this._animations.set(n,o)}_buildPlayer(n,e,i){const r=n.element,o=CN(this._normalizer,n.keyframes,e,i);return this._driver.animate(r,o,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],o=this._animations.get(n);let s;const a=new Map;if(o?(s=cS(this._driver,e,o,eS,MC,new Map,new Map,i,DZ,r),s.forEach(f=>{const g=El(a,f.element,new Map);f.postStyleProps.forEach(v=>g.set(v,null))})):(r.push(function Rq(){return new it(3300,!1)}()),s=[]),r.length)throw function Lq(t){return new it(3504,!1)}();a.forEach((f,g)=>{f.forEach((v,C)=>{f.set(C,this._driver.computeStyle(g,C,gd))})});const u=Rh(s.map(f=>{const g=a.get(f.element);return this._buildPlayer(f,new Map,g)}));return this._playersById.set(n,u),u.onDestroy(()=>this.destroy(n)),this.players.push(u),u}destroy(n){const e=this._getPlayer(n);e.destroy(),this._playersById.delete(n);const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById.get(n);if(!e)throw function Bq(t){return new it(3301,!1)}();return e}listen(n,e,i,r){const o=ZI(e,"","","");return YI(this._getPlayer(n),i,o,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const o=this._getPlayer(n);switch(i){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const UN="ng-animate-queued",hS="ng-animate-disabled",NZ=[],HN={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},RZ={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Pc="__ng_removed";class fS{get params(){return this.options.params}constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function HZ(t){return t??null}(i?n.value:n),i){const{value:o,...s}=n;this.options=s}else this.options={};this.options.params||(this.options.params={})}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Db="void",pS=new fS(Db);class LZ{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Ql(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.has(e))throw function Uq(t,n){return new it(3302,!1)}();if(null==i||0==i.length)throw function Hq(t){return new it(3303,!1)}();if(!function zZ(t){return"start"==t||"done"==t}(i))throw function zq(t,n){return new it(3400,!1)}();const o=El(this._elementListeners,n,[]),s={name:e,phase:i,callback:r};o.push(s);const a=El(this._engine.statesByElement,n,new Map);return a.has(e)||(Ql(n,DC),Ql(n,DC+"-"+e),a.set(e,pS)),()=>{this._engine.afterFlush(()=>{const l=o.indexOf(s);l>=0&&o.splice(l,1),this._triggers.has(e)||a.delete(e)})}}register(n,e){return!this._triggers.has(n)&&(this._triggers.set(n,e),!0)}_getTrigger(n){const e=this._triggers.get(n);if(!e)throw function Vq(t){return new it(3401,!1)}();return e}trigger(n,e,i,r=!0){const o=this._getTrigger(e),s=new gS(this.id,e,n);let a=this._engine.statesByElement.get(n);a||(Ql(n,DC),Ql(n,DC+"-"+e),this._engine.statesByElement.set(n,a=new Map));let l=a.get(e);const u=new fS(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&l&&u.absorbOptions(l.options),a.set(e,u),l||(l=pS),u.value!==Db&&l.value===u.value){if(!function GZ(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const o=e[r];if(!n.hasOwnProperty(o)||t[o]!==n[o])return!1}return!0}(l.params,u.params)){const w=[],T=o.matchStyles(l.value,l.params,w),M=o.matchStyles(u.value,u.params,w);w.length?this._engine.reportError(w):this._engine.afterFlush(()=>{cp(n,T),gu(n,M)})}return}const v=El(this._engine.playersByElement,n,[]);v.forEach(w=>{w.namespaceId==this.id&&w.triggerName==e&&w.queued&&w.destroy()});let C=o.matchTransition(l.value,u.value,n,u.params),E=!1;if(!C){if(!r)return;C=o.fallbackTransition,E=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:C,fromState:l,toState:u,player:s,isFallbackTransition:E}),E||(Ql(n,UN),s.onStart(()=>{vm(n,UN)})),s.onDone(()=>{let w=this.players.indexOf(s);w>=0&&this.players.splice(w,1);const T=this._engine.playersByElement.get(n);if(T){let M=T.indexOf(s);M>=0&&T.splice(M,1)}}),this.players.push(s),v.push(s),s}deregister(n){this._triggers.delete(n),this._engine.statesByElement.forEach(e=>e.delete(n)),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,OC,!0);i.forEach(r=>{if(r[Pc])return;const o=this._engine.fetchNamespacesByElement(r);o.size?o.forEach(s=>s.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const o=this._engine.statesByElement.get(n),s=new Map;if(o){const a=[];if(o.forEach((l,u)=>{if(s.set(u,l.value),this._triggers.has(u)){const f=this.trigger(n,u,Db,r);f&&a.push(f)}}),a.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,s),i&&Rh(a).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(o=>{const s=o.name;if(r.has(s))return;r.add(s);const l=this._triggers.get(s).fallbackTransition,u=i.get(s)||pS,f=new fS(Db),g=new gS(this.id,s,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:s,transition:l,fromState:u,toState:f,player:g,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const o=i.players.length?i.playersByQueriedElement.get(n):[];if(o&&o.length)r=!0;else{let s=n;for(;s=s.parentNode;)if(i.statesByElement.get(s)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const o=n[Pc];(!o||o===HN)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){Ql(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const o=i.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==i.triggerName){const l=ZI(o,i.triggerName,i.fromState.value,i.toState.value);l._data=n,YI(i.player,a.phase,l,a.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const o=i.transition.ast.depCount,s=r.transition.ast.depCount;return 0==o||0==s?o-s:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}}class BZ{_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}constructor(n,e,i,r){this.bodyNode=n,this.driver=e,this._normalizer=i,this.scheduler=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,s)=>{}}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new LZ(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement;if(i.length-1>=0){let s=!1,a=this.driver.getParentElement(e);for(;a;){const l=r.get(a);if(l){const u=i.indexOf(l);i.splice(u+1,0,n),s=!0;break}a=this.driver.getParentElement(a)}s||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){n&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{const i=this._fetchNamespace(n);this.namespacesByHostElement.delete(i.hostElement);const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1),i.destroy(e),delete this._namespaceLookup[n]}))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i)for(let r of i.values())if(r.namespaceId){const o=this._fetchNamespace(r.namespaceId);o&&e.add(o)}return e}trigger(n,e,i,r){if(BC(e)){const o=this._fetchNamespace(n);if(o)return o.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!BC(e))return;const o=e[Pc];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;const s=this.collectedLeaveElements.indexOf(e);s>=0&&this.collectedLeaveElements.splice(s,1)}if(n){const s=this._fetchNamespace(n);s&&s.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Ql(n,hS)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),vm(n,hS))}removeNode(n,e,i){if(BC(e)){this.scheduler?.notify();const r=n?this._fetchNamespace(n):null;r?r.removeNode(e,i):this.markElementAsRemoved(n,e,!1,i);const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,i)}else this._onRemovalComplete(e,i)}markElementAsRemoved(n,e,i,r,o){this.collectedLeaveElements.push(e),e[Pc]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:o}}listen(n,e,i,r,o){return BC(e)?this._fetchNamespace(n).listen(e,i,r,o):()=>{}}_buildInstruction(n,e,i,r,o){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,o)}destroyInnerAnimations(n){let e=this.driver.query(n,OC,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,tS,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return Rh(this.players).onDone(()=>n());n()})}processLeaveNode(n){const e=n[Pc];if(e&&e.setForRemoval){if(n[Pc]=HN,e.namespaceId){this.destroyInnerAnimations(n);const i=this._fetchNamespace(e.namespaceId);i&&i.clearElementCache(n)}this._onRemovalComplete(n,e.setForRemoval)}n.classList?.contains(hS)&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(i=>{this.markElementAsDisabled(i,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ql(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?Rh(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function jq(t){return new it(3402,!1)}()}_flushAnimations(n,e){const i=new NC,r=[],o=new Map,s=[],a=new Map,l=new Map,u=new Map,f=new Set;this.disabledNodes.forEach(be=>{f.add(be);const Ye=this.driver.query(be,".ng-animate-queued",!0);for(let Ke=0;Ke<Ye.length;Ke++)f.add(Ye[Ke])});const g=this.bodyNode,v=Array.from(this.statesByElement.keys()),C=jN(v,this.collectedEnterElements),E=new Map;let w=0;C.forEach((be,Ye)=>{const Ke=eS+w++;E.set(Ye,Ke),be.forEach(tt=>Ql(tt,Ke))});const T=[],M=new Set,S=new Set;for(let be=0;be<this.collectedLeaveElements.length;be++){const Ye=this.collectedLeaveElements[be],Ke=Ye[Pc];Ke&&Ke.setForRemoval&&(T.push(Ye),M.add(Ye),Ke.hasAnimation?this.driver.query(Ye,".ng-star-inserted",!0).forEach(tt=>M.add(tt)):S.add(Ye))}const P=new Map,Z=jN(v,Array.from(M));Z.forEach((be,Ye)=>{const Ke=MC+w++;P.set(Ye,Ke),be.forEach(tt=>Ql(tt,Ke))}),n.push(()=>{C.forEach((be,Ye)=>{const Ke=E.get(Ye);be.forEach(tt=>vm(tt,Ke))}),Z.forEach((be,Ye)=>{const Ke=P.get(Ye);be.forEach(tt=>vm(tt,Ke))}),T.forEach(be=>{this.processLeaveNode(be)})});const ee=[],B=[];for(let be=this._namespaceList.length-1;be>=0;be--)this._namespaceList[be].drainQueuedTransitions(e).forEach(Ke=>{const tt=Ke.player,lt=Ke.element;if(ee.push(tt),this.collectedEnterElements.length){const yn=lt[Pc];if(yn&&yn.setForMove){if(yn.previousTriggersValues&&yn.previousTriggersValues.has(Ke.triggerName)){const en=yn.previousTriggersValues.get(Ke.triggerName),pr=this.statesByElement.get(Ke.element);if(pr&&pr.has(Ke.triggerName)){const Vo=pr.get(Ke.triggerName);Vo.value=en,pr.set(Ke.triggerName,Vo)}}return void tt.destroy()}}const sn=!g||!this.driver.containsElement(g,lt),Ct=P.get(lt),Ft=E.get(lt),an=this._buildInstruction(Ke,i,Ft,Ct,sn);if(an.errors&&an.errors.length)return void B.push(an);if(sn)return tt.onStart(()=>cp(lt,an.fromStyles)),tt.onDestroy(()=>gu(lt,an.toStyles)),void r.push(tt);if(Ke.isFallbackTransition)return tt.onStart(()=>cp(lt,an.fromStyles)),tt.onDestroy(()=>gu(lt,an.toStyles)),void r.push(tt);const Qe=[];an.timelines.forEach(yn=>{yn.stretchStartingKeyframe=!0,this.disabledNodes.has(yn.element)||Qe.push(yn)}),an.timelines=Qe,i.append(lt,an.timelines),s.push({instruction:an,player:tt,element:lt}),an.queriedElements.forEach(yn=>El(a,yn,[]).push(tt)),an.preStyleProps.forEach((yn,en)=>{if(yn.size){let pr=l.get(en);pr||l.set(en,pr=new Set),yn.forEach((Vo,ea)=>pr.add(ea))}}),an.postStyleProps.forEach((yn,en)=>{let pr=u.get(en);pr||u.set(en,pr=new Set),yn.forEach((Vo,ea)=>pr.add(ea))})});if(B.length){const be=[];B.forEach(Ye=>{be.push(function Gq(t,n){return new it(3505,!1)}())}),ee.forEach(Ye=>Ye.destroy()),this.reportError(be)}const J=new Map,le=new Map;s.forEach(be=>{const Ye=be.element;i.has(Ye)&&(le.set(Ye,Ye),this._beforeAnimationBuild(be.player.namespaceId,be.instruction,J))}),r.forEach(be=>{const Ye=be.element;this._getPreviousPlayers(Ye,!1,be.namespaceId,be.triggerName,null).forEach(tt=>{El(J,Ye,[]).push(tt),tt.destroy()})});const se=T.filter(be=>WN(be,l,u)),fe=new Map;VN(fe,this.driver,S,u,gd).forEach(be=>{WN(be,l,u)&&se.push(be)});const ue=new Map;C.forEach((be,Ye)=>{VN(ue,this.driver,new Set(be),l,"!")}),se.forEach(be=>{const Ye=fe.get(be),Ke=ue.get(be);fe.set(be,new Map([...Ye?.entries()??[],...Ke?.entries()??[]]))});const Ue=[],Ze=[],nt={};s.forEach(be=>{const{element:Ye,player:Ke,instruction:tt}=be;if(i.has(Ye)){if(f.has(Ye))return Ke.onDestroy(()=>gu(Ye,tt.toStyles)),Ke.disabled=!0,Ke.overrideTotalTime(tt.totalTime),void r.push(Ke);let lt=nt;if(le.size>1){let Ct=Ye;const Ft=[];for(;Ct=Ct.parentNode;){const an=le.get(Ct);if(an){lt=an;break}Ft.push(Ct)}Ft.forEach(an=>le.set(an,lt))}const sn=this._buildAnimation(Ke.namespaceId,tt,J,o,ue,fe);if(Ke.setRealPlayer(sn),lt===nt)Ue.push(Ke);else{const Ct=this.playersByElement.get(lt);Ct&&Ct.length&&(Ke.parentPlayer=Rh(Ct)),r.push(Ke)}}else cp(Ye,tt.fromStyles),Ke.onDestroy(()=>gu(Ye,tt.toStyles)),Ze.push(Ke),f.has(Ye)&&r.push(Ke)}),Ze.forEach(be=>{const Ye=o.get(be.element);if(Ye&&Ye.length){const Ke=Rh(Ye);be.setRealPlayer(Ke)}}),r.forEach(be=>{be.parentPlayer?be.syncPlayerEvents(be.parentPlayer):be.destroy()});for(let be=0;be<T.length;be++){const Ye=T[be],Ke=Ye[Pc];if(vm(Ye,MC),Ke&&Ke.hasAnimation)continue;let tt=[];if(a.size){let sn=a.get(Ye);sn&&sn.length&&tt.push(...sn);let Ct=this.driver.query(Ye,tS,!0);for(let Ft=0;Ft<Ct.length;Ft++){let an=a.get(Ct[Ft]);an&&an.length&&tt.push(...an)}}const lt=tt.filter(sn=>!sn.destroyed);lt.length?VZ(this,Ye,lt):this.processLeaveNode(Ye)}return T.length=0,Ue.forEach(be=>{this.players.push(be),be.onDone(()=>{be.destroy();const Ye=this.players.indexOf(be);this.players.splice(Ye,1)}),be.play()}),Ue}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,o){let s=[];if(e){const a=this.playersByQueriedElement.get(n);a&&(s=a)}else{const a=this.playersByElement.get(n);if(a){const l=!o||o==Db;a.forEach(u=>{u.queued||!l&&u.triggerName!=r||s.push(u)})}}return(i||r)&&(s=s.filter(a=>!(i&&i!=a.namespaceId||r&&r!=a.triggerName))),s}_beforeAnimationBuild(n,e,i){const o=e.element,s=e.isRemovalTransition?void 0:n,a=e.isRemovalTransition?void 0:e.triggerName;for(const l of e.timelines){const u=l.element,f=u!==o,g=El(i,u,[]);this._getPreviousPlayers(u,f,s,a,e.toState).forEach(C=>{const E=C.getRealPlayer();E.beforeDestroy&&E.beforeDestroy(),C.destroy(),g.push(C)})}cp(o,e.fromStyles)}_buildAnimation(n,e,i,r,o,s){const a=e.triggerName,l=e.element,u=[],f=new Set,g=new Set,v=e.timelines.map(E=>{const w=E.element;f.add(w);const T=w[Pc];if(T&&T.removedBeforeQueried)return new Ib(E.duration,E.delay);const M=w!==l,S=function jZ(t){const n=[];return GN(t,n),n}((i.get(w)||NZ).map(J=>J.getRealPlayer())).filter(J=>!!J.element&&J.element===w),P=o.get(w),Z=s.get(w),ee=CN(this._normalizer,E.keyframes,P,Z),B=this._buildPlayer(E,ee,S);if(E.subTimeline&&r&&g.add(w),M){const J=new gS(n,a,w);J.setRealPlayer(B),u.push(J)}return B});u.forEach(E=>{El(this.playersByQueriedElement,E.element,[]).push(E),E.onDone(()=>function UZ(t,n,e){let i=t.get(n);if(i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}return i}(this.playersByQueriedElement,E.element,E))}),f.forEach(E=>Ql(E,SN));const C=Rh(v);return C.onDestroy(()=>{f.forEach(E=>vm(E,SN)),gu(l,e.toStyles)}),g.forEach(E=>{El(r,E,[]).push(C)}),C}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new Ib(n.duration,n.delay)}}class gS{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new Ib,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,this._queuedCallbacks.forEach((e,i)=>{e.forEach(r=>YI(n,i,void 0,r))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){El(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function BC(t){return t&&1===t.nodeType}function zN(t,n){const e=t.style.display;return t.style.display=n??"none",e}function VN(t,n,e,i,r){const o=[];e.forEach(l=>o.push(zN(l)));const s=[];i.forEach((l,u)=>{const f=new Map;l.forEach(g=>{const v=n.computeStyle(u,g,r);f.set(g,v),(!v||0==v.length)&&(u[Pc]=RZ,s.push(u))}),t.set(u,f)});let a=0;return e.forEach(l=>zN(l,o[a++])),s}function jN(t,n){const e=new Map;if(t.forEach(a=>e.set(a,[])),0==n.length)return e;const r=new Set(n),o=new Map;function s(a){if(!a)return 1;let l=o.get(a);if(l)return l;const u=a.parentNode;return l=e.has(u)?u:r.has(u)?1:s(u),o.set(a,l),l}return n.forEach(a=>{const l=s(a);1!==l&&e.get(l).push(a)}),e}function Ql(t,n){t.classList?.add(n)}function vm(t,n){t.classList?.remove(n)}function VZ(t,n,e){Rh(e).onDone(()=>t.processLeaveNode(n))}function GN(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof vN?GN(i.players,n):n.push(i)}}function WN(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(o=>r.add(o)):n.set(t,i),e.delete(t),!0}class Ob{constructor(n,e,i,r){this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(o,s)=>{},this._transitionEngine=new BZ(n.body,e,i,r),this._timelineEngine=new OZ(n.body,e,i),this._transitionEngine.onRemovalComplete=(o,s)=>this.onRemovalComplete(o,s)}registerTrigger(n,e,i,r,o){const s=n+"-"+r;let a=this._triggerCache[s];if(!a){const l=[],f=sS(this._driver,o,l,[]);if(l.length)throw function Pq(t,n){return new it(3404,!1)}();a=function IZ(t,n,e){return new SZ(t,n,e)}(r,f,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(e,r,a)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i){this._transitionEngine.removeNode(n,e,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[o,s]=xN(i);this._timelineEngine.command(o,e,s,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,o){if("@"==i.charAt(0)){const[s,a]=xN(i);return this._timelineEngine.listen(s,e,a,o)}return this._transitionEngine.listen(n,e,i,r,o)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(n){this._transitionEngine.afterFlushAnimationsDone(n)}}class Ab{static#e=this.initialStylesByElement=new WeakMap;constructor(n,e,i){this._element=n,this._startStyles=e,this._endStyles=i,this._state=0;let r=Ab.initialStylesByElement.get(n);r||Ab.initialStylesByElement.set(n,r=new Map),this._initialStyles=r}start(){this._state<1&&(this._startStyles&&gu(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(gu(this._element,this._initialStyles),this._endStyles&&(gu(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(Ab.initialStylesByElement.delete(this._element),this._startStyles&&(cp(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(cp(this._element,this._endStyles),this._endStyles=null),gu(this._element,this._initialStyles),this._state=3)}}function mS(t){let n=null;return t.forEach((e,i)=>{(function $Z(t){return"display"===t||"position"===t})(i)&&(n=n||new Map,n.set(i,e))}),n}class $N{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:new Map;const e=()=>this._onFinish();this.domPlayer.addEventListener("finish",e),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",e)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(n){const e=[];return n.forEach(i=>{e.push(Object.fromEntries(i))}),e}_triggerWebAnimation(n,e,i){return n.animate(this._convertKeyframesToObject(e),i)}onStart(n){this._originalOnStartFns.push(n),this._onStartFns.push(n)}onDone(n){this._originalOnDoneFns.push(n),this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n=new Map;this.hasStarted()&&this._finalKeyframe.forEach((i,r)=>{"offset"!==r&&n.set(r,this._finished?i:oS(this.element,r))}),this.currentSnapshot=n}triggerCallback(n){const e="start"===n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class YN{validateStyleProperty(n){return!0}validateAnimatableStyleProperty(n){return!0}matchesElement(n,e){return!1}containsElement(n,e){return EN(n,e)}getParentElement(n){return XI(n)}query(n,e,i){return TN(n,e,i)}computeStyle(n,e,i){return oS(n,e)}animate(n,e,i,r,o,s=[]){const l={duration:i,delay:r,fill:0==r?"both":"forwards"};o&&(l.easing=o);const u=new Map,f=s.filter(C=>C instanceof $N);(function iZ(t,n){return 0===t||0===n})(i,r)&&f.forEach(C=>{C.currentSnapshot.forEach((E,w)=>u.set(w,E))});let g=function eZ(t){return t.length?t[0]instanceof Map?t:t.map(n=>new Map(Object.entries(n))):[]}(e).map(C=>new Map(C));g=function rZ(t,n,e){if(e.size&&n.length){let i=n[0],r=[];if(e.forEach((o,s)=>{i.has(s)||r.push(s),i.set(s,o)}),r.length)for(let o=1;o<n.length;o++){let s=n[o];r.forEach(a=>s.set(a,oS(t,a)))}}return n}(n,g,u);const v=function WZ(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=mS(n[0]),n.length>1&&(i=mS(n[n.length-1]))):n instanceof Map&&(e=mS(n)),e||i?new Ab(t,e,i):null}(n,g);return new $N(n,g,l,v)}}const qN="@.disabled";class ZN{constructor(n,e,i,r){this.namespaceId=n,this.delegate=e,this.engine=i,this._onDestroy=r,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(n){this.delegate.destroyNode?.(n)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==qN?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class YZ extends ZN{constructor(n,e,i,r,o){super(e,i,r,o),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==qN?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.slice(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function qZ(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let o=e.slice(1),s="";return"@"!=o.charAt(0)&&([o,s]=function ZZ(t){const n=t.indexOf(".");return[t.substring(0,n),t.slice(n+1)]}(o)),this.engine.listen(this.namespaceId,r,o,s,a=>{this.factory.scheduleListenerCallback(a._data||-1,i,a)})}return this.delegate.listen(n,e,i)}}class XZ{constructor(n,e,i){this.delegate=n,this.engine=e,this._zone=i,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,e.onRemovalComplete=(r,o)=>{const s=o?.parentNode(r);s&&o.removeChild(s,r)}}createRenderer(n,e){const r=this.delegate.createRenderer(n,e);if(!n||!e?.data?.animation){const u=this._rendererCache;let f=u.get(r);return f||(f=new ZN("",r,this.engine,()=>u.delete(r)),u.set(r,f)),f}const o=e.id,s=e.id+"-"+this._currentId;this._currentId++,this.engine.register(s,n);const a=u=>{Array.isArray(u)?u.forEach(a):this.engine.registerTrigger(o,s,n,u.name,u)};return e.data.animation.forEach(a),new YZ(this,s,r,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(n,e,i){if(n>=0&&n<this._microtaskId)return void this._zone.run(()=>e(i));const r=this._animationCallbacksBuffer;0==r.length&&queueMicrotask(()=>{this._zone.run(()=>{r.forEach(o=>{const[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),r.push([e,i])}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}let KZ=(()=>{class t extends Ob{constructor(e,i,r){super(e,i,r,En(by,{optional:!0}))}ngOnDestroy(){this.flush()}static#e=this.\u0275fac=function(i){return new(i||t)(kn(cd),kn(QI),kn(JI))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const XN=[{provide:JI,useFactory:function QZ(){return new ON}},{provide:Ob,useClass:KZ},{provide:k2,useFactory:function JZ(t,n,e){return new XZ(t,n,e)},deps:[gI,Ob,Sn]}],_S=[{provide:QI,useFactory:()=>new YN},{provide:r0,useValue:"BrowserAnimations"},...XN],KN=[{provide:QI,useClass:KI},{provide:r0,useValue:"NoopAnimations"},...XN];let eX=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?KN:_S}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({providers:_S,imports:[i4]})}return t})(),kb=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=xn({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[mr],decls:2,vars:2,consts:[[1,"badge"]],template:function(i,r){1&i&&(p(0,"div",0),x(1),m()),2&i&&(_("@bounce",r.animeState),h(),Re(r.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[Vn("bounce",[WI("active",Pe({transform:""})),Xt("* => active",[jt("600ms ease",mn([Pe({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),Pe({transform:"scale3d(2, 2, 2)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}})}return t})();var bS;(bS||(bS={})).resize=function n(e,i,r,o){let s=e.width,a=e.height,l=s/(i=Math.round(i)),u=a/(r=Math.round(r)),f=Math.ceil(l/2),g=Math.ceil(u/2),v=e.getContext("2d"),C=v.getImageData(0,0,s,a),E=v.createImageData(i,r),w=C.data,T=E.data;for(let M=0;M<r;M++)for(let S=0;S<i;S++){let P=4*(S+M*i),Z=0,ee=0,B=0,J=0,le=0,se=0,fe=0,Se=(M+.5)*u,ue=Math.floor(M*u),Ue=Math.ceil((M+1)*u);for(let Ze=ue;Ze<Ue;Ze++){let nt=Math.abs(Se-(Ze+.5))/g,be=(S+.5)*l,Ye=nt*nt,Ke=Math.floor(S*l),tt=Math.ceil((S+1)*l);for(let lt=Ke;lt<tt;lt++){let sn=Math.abs(be-(lt+.5))/f,Ct=Math.sqrt(Ye+sn*sn);if(Ct>=1)continue;Z=2*Ct*Ct*Ct-3*Ct*Ct+1;let Ft=4*(lt+Ze*s);fe+=Z*w[Ft+3],B+=Z,w[Ft+3]<255&&(Z=Z*w[Ft+3]/250),J+=Z*w[Ft],le+=Z*w[Ft+1],se+=Z*w[Ft+2],ee+=Z}}T[P]=J/ee,T[P+1]=le/ee,T[P+2]=se/ee,T[P+3]=fe/B}!0===o?(e.width=i,e.height=r):v.clearRect(0,0,s,a),v.putImageData(E,0,0)};var Fc,QN=me(4232);!function(t){function r(){return(r=(0,R.A)(function*(o){return o instanceof Blob?QN.M.sha256Hex(yield t.readAsArrayBufferAsync(o)):QN.M.sha256Hex(o)})).apply(this,arguments)}t.readAsArrayBufferAsync=function n(o){return new Promise((s,a)=>{let l=new FileReader;l.onload=u=>{s(l.result)},l.onabort=l.onerror=u=>{a(u)},l.readAsArrayBuffer(o)})},t.readAsTextAsync=function e(o){return new Promise((s,a)=>{let l=new FileReader;l.onload=u=>{s(l.result)},l.onabort=l.onerror=u=>{a(u)},l.readAsText(o)})},t.calcSHA256Async=function i(o){return r.apply(this,arguments)}}(Fc||(Fc={}));var Di=function(t){return t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL",t}(Di||{});class _n{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Di.URL:this.blob===this.thumbnail.blob?Di.THUMBNAIL:Di.COMPLETE:Di.NULL}get isEmpty(){return this.state<=Di.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}static createEmpty(n){let e=new _n;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new _n;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new _n;return e.apply(n),e}}static createAsync(n){return(0,R.A)(function*(){return n instanceof File?yield _n._createAsync(n,n.name):n instanceof Blob?yield _n._createAsync(n):void 0})()}static _createAsync(n,e){return(0,R.A)(function*(){let i=yield Fc.readAsArrayBufferAsync(n),r=new _n;r.context.identifier=yield Fc.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield _n.createThumbnailAsync(r.context)}catch(o){throw o}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Di.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Di.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=o=>{let s=Math.min(128/Math.max(r.width,r.height),1),a=r.width*s,l=r.height*s,u=document.createElement("canvas"),f=u.getContext("2d");u.width=r.width,u.height=r.height,f.drawImage(r,0,0),bS.resize(u,a,l,!0),u.toBlob(g=>{let v={type:g.type,blob:g,url:window.URL.createObjectURL(g)};e(v)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}static#e=this.Empty=_n.createEmpty("null")}var Jl=me(2306),tX=me(8848),ym=me(442);const JN=ym.y.parse("???");class mu{static get instance(){return mu._instance||(mu._instance=new mu),mu._instance}get isOpen(){return!!this.connection&&this.connection.peer.isOpen}get peerId(){return this.connection?this.connection.peerId:JN.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peer(){return this.connection?this.connection.peer:JN}get peers(){return this.connection?this.connection.peers.concat():[]}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}constructor(){this.callback=new tX.U,this.config={},this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}configure(n){this.config=n}open(...n){this.connectionClassPromise&&(console.warn("It is already opened."),this.close()),this.openAsync.apply(this,n)}openAsync(...n){var e=this;return(0,R.A)(function*(){let i=e.dynamicImport(e.config?.backend?.mode);e.connectionClassPromise=i,e.connectionClass=yield i,e.connectionClassPromise==i&&(console.log("Network open...",n),e.connection=e.initializeConnection(),e.connection.open.apply(e.connection,n),window.addEventListener("unload",e.callbackUnload,!1))})()}close(){this.connection&&this.connection.close(),this.connection=null,this.connectionClassPromise=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){this.connection&&this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n.peerId),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=(0,Jl.W)(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let o of this.queue){if(r<=0)break;r--,this.queue.delete(o),null==o.sendTo?n.push(o.data):o.sendTo===this.peerId?i.push(o.data):(o.sendTo in e||(e[o.sendTo]=[]),e[o.sendTo].push(o.data))}if(this.connection){n.length&&this.connection.send(n);for(let o in e)this.connection.send(e[o],o)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peer,i)),this.sendInterval=0<this.queue.size?(0,Jl.W)(this.sendCallback):null}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}listAllRooms(){return this.connection?this.connection.listAllRooms():Promise.resolve([])}initializeConnection(){let n=new this.connectionClass;return n.configure(this.config),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,o)=>{this.callback.onError&&this.callback.onError(e,i,r,o)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=(0,Jl.W)(this.sendCallback)),n}dynamicImport(n=""){return(0,R.A)(function*(){return"skyway2023"===n?(yield Promise.all([me.e(918),me.e(7299)]).then(me.bind(me,1652))).SkyWayConnection:(yield Promise.all([me.e(918),me.e(1528)]).then(me.bind(me,844))).SkyWayConnection})()}}class Cm{constructor(n,e,i=mu.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===mu.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class vS{get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new vS(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class dp{static get instance(){return dp._instance||(dp._instance=new dp,dp._instance.initializeNetworkEvent()),dp._instance}constructor(){this.listenerMap=new Map,this.keyMap=new Map,console.log("EventSystem ready...")}register(n){return new vS(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=[];if(null!=n)r=this.getListenersByKey(n);else if(null!=e)r=this.getListenersByEventName(e);else{let o=this.listenerMap.values();for(let s of o)r=r.concat(s)}for(let o of r.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListenersByEventName(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),e=this.getListenersByKey(n.key),e.push(n),this.keyMap.set(n.key,e),n}unregisterListener(n){let e=this.getListenersByEventName(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),e.length<1&&this.listenerMap.delete(n.eventName),e=this.getListenersByKey(n.key),i=e.indexOf(n),0<=i&&e.splice(i,1),e.length<1&&this.keyMap.delete(n.key),n.unregister(),n)}call(...n){"string"==typeof n[0]?this._call(new Cm(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();mu.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof Cm?n[0]:new Cm(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new Cm(n[0],n[1]))}_trigger(n){let e=this.getListenersByEventName(n.eventName).concat(this.getListenersByEventName("*"));for(let i of e)i.trigger(n);return n}getListenersByEventName(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}getListenersByKey(n){return this.keyMap.has(n)?this.keyMap.get(n):[]}initializeNetworkEvent(){let n=mu.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e.peerId})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e.peerId})},n.onConnect=e=>{this.sendSystemMessage("<"+e.userId+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e.peerId})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e.userId+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e.peerId})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,o)=>{this.sendSystemMessage("<"+e.userId+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e.peerId,errorType:i,errorMessage:r,errorObject:o})}}sendSystemMessage(n){console.log(n)}}const U=dp.instance,xt=mu.instance;class dt{static get instance(){return dt._instance||(dt._instance=new dt),dt._instance}constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&U.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}U.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=(0,Jl.W)(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let o=r.next();if(o.done)break;o.value[1]+n<e||this.garbageMap.delete(o.value[0])}}}var _d=me(9757);class _u{static get instance(){return _u._instance||(_u._instance=new _u),_u._instance}constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}register(n,e){e||(e=n.name??n.toString().match(/function\s*([^(]*)\(/)?.[1]??""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){return this.aliasMap.get(n)??""}}const e5=Symbol("synchronize-variables"),t5=Symbol("synchronize-attributes");function n5(t){return n=>{const e=class extends n{constructor(...r){super(...r),this.constructor===e&&function iX(t){r5(t,e5,n=>function(){return this.context.syncData[n]},n=>function(i){this.context.syncData[n]=i,this.update()}),r5(t,t5,n=>function(){return this.context.syncData.attributes[n]},n=>function(i){this.context.syncData.attributes[n]=i,this.update()})}(this)}};return _u.instance.register(e,t),e}}function xm(){return(t,n)=>{i5(t,e5,n)}}function i5(t,n,e){t.hasOwnProperty(n)||Object.defineProperty(t,n,{enumerable:!1,configurable:!0,writable:!0,value:new Set}),t[n].add(e)}function r5(t,n,e,i){const r=new Set;let o=t;for(;o;){const s=o[n];if(null!=s&&o.hasOwnProperty(n))for(const a of s){if(r.has(a))continue;r.add(a);const l=t[a];Object.defineProperty(t,a,{get:e(a),set:i(a),enumerable:!0,configurable:!0}),void 0!==l&&(t[a]=l)}o=Object.getPrototypeOf(o)}}var bd;!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},o=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function f(v){return e[v]}function g(v){return r[v]}t.xml2element=function s(v){let C=new DOMParser,E=null;try{v=function u(v){return v.replace(o,"").trim()}(v),E=C.parseFromString(v,"application/xml"),E.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",E.documentElement),E=null)}catch(w){console.error(w)}return E?E.documentElement:null},t.encodeEntityReference=function a(v){return v.replace(n,f)},t.decodeEntityReference=function l(v){return v.replace(i,g)}}(bd||(bd={}));var Il=me(1185);const rX=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class dr{static get instance(){return dr._instance||(dr._instance=new dr),dr._instance}constructor(){console.log("ObjectSerializer ready...")}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():dr.toAttributes(n.toContext().syncData),r=n.aliasName,o="";for(let s in i)void 0!==i[s]&&(o+=" "+s+'="'+bd.encodeEntityReference(i[s]+"")+'"');return e+=`<${r+o}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let s=dr.make2Attributes(n[i],i);for(let a in s)void 0!==s[a]&&(e[a]=s[a])}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=dr.array2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else if("object"==typeof n){let r=dr.object2attributes(n,e);for(let o in r)void 0!==r[o]&&(i[o]=r[o])}else void 0!==n&&(i[e]=n);return i}static object2attributes(n,e){let i={};for(let r in n){let a=dr.make2Attributes(n[r],e+"."+r);for(let l in a)void 0!==a[l]&&(i[l]=a[l])}return i}static array2attributes(n,e){let i={},r=n.length;for(let o=0;o<r;o++){let l=dr.make2Attributes(n[o],e+"."+o);for(let u in l)void 0!==l[u]&&(i[u]=l[u])}return i}parseXml(n){let e=null;if(e="string"==typeof n?bd.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=_u.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();dr.parseAttributes(r.syncData,e.attributes),i.apply(r)}i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e);try{i.complement()}catch(r){console.log(r)}return i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let o=e[r].value;o=bd.decodeEntityReference(o);let s=e[r].name.split("."),a=s[0],l=n,u=s.find(g=>rX.includes(g));null==u?1<s.length&&(({obj:l,key:a}=dr.attributes2object(s,l,a)),null==a)||("string"!=typeof l[a]&&null!=l[a]&&(o=JSON.parse(o)),l[a]=o):console.log(`skip invalid key (${u})`)}return n}static attributes2object(n,e,i){let r=null,o=n.length;for(let s=0;s<o;s++){let a=parseInt(n[s]);if(r&&!Number.isNaN(a)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(a)?n[s]:a,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};s+1<o&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class Lh{static get aliasName(){return _u.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}constructor(n=Il.k.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}initialize(){dt.instance.add(this)}destroy(){dt.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),dt.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){const n=this.toXml();return dr.instance.parseXml(n)}complement(){}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:o5(this.context.syncData)}}toXml(){return dr.instance.toXml(this)}}function o5(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=o5(t[i]):"function"!==r&&(n[i]=t[i])}return n}const yS=new Map,HC=new Set;let CS=!1;function s5(t,n=xt.peerId){yS.set(t.identifier,{object:t,originFrom:n}),t instanceof Ir&&xS(t.parent),a5()}function xS(t){let n=t;for(;n&&!HC.has(n.identifier);)HC.add(n.identifier),n=n.parent;a5()}function a5(){CS||(queueMicrotask(oX),CS=!0)}const oX=()=>{CS=!1;let t=Array.from(yS.values()),n=Array.from(HC.values());yS.clear(),HC.clear();for(let e of t){let i={aliasName:e.object.aliasName,identifier:e.object.identifier};U.trigger(new Cm(`UPDATE_GAME_OBJECT/aliasName/${i.aliasName}`,i,e.originFrom)),U.trigger(new Cm(`UPDATE_GAME_OBJECT/identifier/${i.identifier}`,i,e.originFrom))}for(let e of n)U.trigger(`UPDATE_OBJECT_CHILDREN/identifier/${e}`,{identifier:e})};var wS;const hp={};let Ir=wS=class extends Lh{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!1}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return dt.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==dt.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&dt.instance.isDeleted(this.parentIdentifier)}get children(){return this.sortChildren().concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){xS(this);let e=new Set,i=this;for(;i&&!e.has(i.identifier);)e.add(i.identifier),i.onChildAdded(n),i=i.parent}_onChildRemoved(n){xS(this);let e=new Set,i=this;for(;i&&!e.has(i.identifier);)e.add(i.identifier),i.onChildRemoved(n),i=i.parent}initializeChildren(){if(null==hp[this.identifier])return;let n=hp[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);hp[this.identifier]&&delete hp[this.identifier]}sortChildren(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parentIdentifier===this.identifier;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let o=this._children.length;o&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[o-1<e+1?o-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.sortChildren();for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;let e=n.parentIdentifier!==this.identifier;n.parent&&e&&n.parent.removeChild(n);let i=this.sortChildren(),r=0<i.length?i[i.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=r,n.minorIndex=Math.random(),e&&(i.push(n),this._onChildAdded(n)),n}prependChild(n){return this._children.length<1?this.appendChild(n):this.insertBefore(n,this.sortChildren()[0])}insertBefore(n,e){if(n.contains(this))return null;let i=n.parentIdentifier!==this.identifier;if(n===e&&!i)return n;n.parent&&i&&n.parent.removeChild(n);let r=this.sortChildren(),o=r.indexOf(e);if(o<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let s=0<o?r[o-1].index:0,a=e.index-s,l=s+a*(.45+.1*Math.random());return n.majorIndex=0|l,n.minorIndex=l-n.majorIndex,i?(r.splice(o,0,n),this._onChildAdded(n)):this.needsSort=!0,a<1e-7&&this.updateIndexs(),n}removeChild(n){let e=this._children.indexOf(n);return e<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this._children.splice(e,1),this._onChildRemoved(n),n)}contains(n){let e=new Set,i=n.parent;for(;i;){if(e.has(i.identifier))return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(i===this)return!0;e.add(i.identifier),i=i.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return dr.toAttributes(this.attributes)}parseAttributes(n){dr.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=bd.encodeEntityReference(this.value+"");for(let e of this.children)n+=dr.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let o=dr.instance.parseXml(e[r]);o instanceof wS&&this.appendChild(o)}else this.value=bd.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in hp||(hp[this.parentIdentifier]=[]),hp[this.parentIdentifier].push(this))}};function ir(t){return n=>n5(t)(n)}function Xe(){return(t,n)=>{t instanceof Ir?function nX(){return(t,n)=>{i5(t,t5,n)}}()(t,n):xm()(t,n)}}Oe([xm()],Ir.prototype,"value",void 0),Oe([xm()],Ir.prototype,"attributes",void 0),Oe([xm()],Ir.prototype,"parentIdentifier",void 0),Oe([xm()],Ir.prototype,"majorIndex",void 0),Oe([xm()],Ir.prototype,"minorIndex",void 0),Ir=wS=Oe([n5("node")],Ir);class l5{get length(){return this._length}constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var _e,Bh=function(t){return t[t.None=0]="None",t[t.IgnoreCase=1]="IgnoreCase",t[t.IgnoreWidth=2]="IgnoreWidth",t}(Bh||{});!function(t){const n=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));function v(w){return null==w||""==w.toString()?"":w.toString().replace(/[\uff01-\uff5e]/g,T=>String.fromCharCode(T.charCodeAt(0)-65248))}function E(w,T){if(T===Bh.None)return w;let M=w;return T&Bh.IgnoreCase&&(M=M.toLocaleLowerCase()),T&Bh.IgnoreWidth&&(M=v(M)),M}t.isEmote=function e(w){return!!w&&(w=this.cr(w).replace(/[\s\r\n]/g,""),Array.from(w).length<=3&&!/[\u300c\u300d]/.test(w)&&(n.test(w)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(w)))},t.cr=function i(w){if(null==w||""==w)return"";let T="",M="";return[...w].forEach(S=>{if(M){switch(S){case"n":case"\uff4e":T+="\n";break;case"s":case"\uff53":T+="s"===S?" ":"\u3000";break;case"\\":case"\uffe5":T+=S;break;default:T+=M+S}M=""}else"\\"==S||"\uffe5"==S?M=S:T+=S}),T+M},t.parseCommands=function r(w,T=!1){const M=/[:\uff1a]/,S=/[\uff0b\uff1d+\-=\u2015\u2014\u2010\uff0d>\uff1e]/,P=/[\s\u3000]/,ee=[M,S],B=[S,/[:\uff1a\s\u3000]/],J=[S,M],le=[...w],se=[];let fe="",Se=0,ue=0,Ue={},Ze="",nt="",be="",Ye="";for(;Se<le.length;Se++){const tt=le[Se];if((!T||!nt)&&P.test(tt))break;if(be)M.test(tt)||S.test(tt)||T&&tt===nt||(Ze+=be),Ze+=tt,Ye+=tt,be="";else if("\\"!==tt&&"\uffe5"!==tt)if(T&&nt)tt!==nt||null!=le[Se-1]&&!B[ue].test(le[Se+1])?Ze+=tt:nt="",Ye+=tt;else if(!T||'"'!==tt&&"'"!==tt||null!=le[Se-1]&&!ee[ue].test(le[Se-1]))if(J[ue].test(tt)){switch(Ye+=tt,ue){case 0:Ue.targetName=nt+Ze,Ue.operator=this.toHalfWidth(tt.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),ue=1;break;case 1:Ue.value=nt+Ze,se.push(Ue),Ue={},ue=0}fe+=Ye,Ye="",Ze="",nt=""}else Ze+=tt,Ye+=tt;else nt=tt,Ye+=tt;else be=tt,Ye+=tt}const Ke=nt+Ze+be;switch(ue){case 0:if(""==Ke)break;Ue.targetName=Ke,fe+=Ke,Ue.isIncomplete=!0,se.push(Ue);break;case 1:Ue.value=Ke,fe+=Ke,se.push(Ue)}return{commands:se,commandString:fe,endString:(Se<le.length?le.slice(Se).join(""):"").replace(/^[\s\u3000]/,"")}},t.validUrl=function o(w){if(!w)return!1;try{new URL(w.trim())}catch{return!1}return/^https?\:\/\//.test(w.trim())},t.sameOrigin=function s(w){if(!w)return!1;try{return new URL(w).origin===window.location.origin}catch{return!1}},t.escapeHtml=function a(w){return"string"!=typeof w&&(w=w.toString()),w.replace(/[&'`"<>]/g,function(T){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[T]})},t.rubyToHtml=function l(w){return"string"!=typeof w&&(w=w.toString()),w.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},t.rubyToText=function u(w){return"string"!=typeof w&&(w=w.toString()),w.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},t.aliasNameToClassName=function f(w){switch(w){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";case"range":return"\u5c04\u7a0b\u30fb\u7bc4\u56f2";default:return w}},t.textShadowColor=function g(w,T="#ffffff",M="#333333"){return w&&/^\#[0-9a-f]{6}$/i.test(w)&&w.substring(1,7).match(/.{2}/g).reduce((S,P)=>S+parseInt(P,16),0)>510?M:T},t.toHalfWidth=v,t.equals=function C(w,T,M=Bh.None){return w.length===T.length&&(w===T||E(w,M)===E(T,M))},t.normalize=E}(_e||(_e={}));class Yt{static get instance(){return Yt._instance||(Yt._instance=new Yt),Yt._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}constructor(){this.imageHash={},console.log("ImageStorage ready...")}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,R.A)(function*(){let i=yield _n.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=_n.create(n);else if(n instanceof _n)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=_n.create(n)}return this._add(e)}_add(n){return Di.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof _n?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),U.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new _d.b(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Di.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var Fn,Kn=me(119);let Ce=class extends Lh{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=Fn.CHAT_DEFAULT_COLOR,this.isGMMode=!1}static#e=Fn=this;static#t=this.isGMHold=!1;static#n=this.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage";static#i=this.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage";static#r=this.CHAT_MY_ICON_LOCAL_STORAGE_KEY="udonanaumu-chat-my-icon-local-storage";static#o=this.CHAT_DEFAULT_COLOR="#444444";static#s=this.CHAT_DEFAULT_NAME="\u30d7\u30ec\u30a4\u30e4\u30fc";static#a=this.CHAT_TRANSPARENT_COLOR="#ffffff";static#l=this.myCursor=null;static#c=this.userIdMap=new Map;static#u=this.peerIdMap=new Map;get isMine(){return Fn.myCursor&&Fn.myCursor===this}get image(){return Yt.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||U.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{xt.peerIds.includes(this.peerId)||(Fn.userIdMap.delete(this.userId),Fn.peerIdMap.delete(this.peerId),dt.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),U.unregister(this),Fn.userIdMap.delete(this.userId),Fn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(Fn.userIdMap,n,!0)}static findByPeerId(n){return this.find(Fn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&dt.instance.get(r))return dt.instance.get(r);let o=dt.instance.getObjects(Fn);for(let s of o){let a=i?s.userId:s.peerId;if(a===e)return n.set(a,s.identifier),s}return null}static createMyCursor(){return(0,R.A)(function*(){if(Fn.myCursor)return console.warn("It is already created."),Fn.myCursor;Fn.myCursor=new Fn,Fn.myCursor.peerId=xt.peerId,Fn.myCursor.initialize();try{try{window.localStorage&&localStorage.getItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(Fn.myCursor.name=localStorage.getItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY),yield Kn.setItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY,Fn.myCursor.name,()=>{localStorage.removeItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}try{window.localStorage&&localStorage.getItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(Fn.myCursor.color=localStorage.getItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY),yield Kn.setItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Fn.myCursor.color,()=>{localStorage.removeItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)}))}catch(n){console.log(n)}yield Kn.getItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n?Fn.myCursor.name=n:void 0!==n&&Kn.removeItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)}),yield Kn.getItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).then(n=>{"string"==typeof n&&/^\#[0-9a-f]{6}$/.test(n.trim().toLowerCase())?Fn.myCursor.color=n.trim().toLowerCase():void 0!==n&&Kn.removeItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)});try{yield Kn.getItem(Fn.CHAT_MY_ICON_LOCAL_STORAGE_KEY).then(n=>{let e=null;if("string"==typeof n)if(n.startsWith("data:image/")){const i=n.substring(5,n.indexOf(";")),r=atob(n.replace(/^.*,/,""));let o=new Uint8Array(r.length);for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);e=new Blob([o.buffer],{type:i})}else Yt.instance.images.find(r=>r.identifier===n)?Fn.myCursor.imageIdentifier=n:Kn.removeItem(Fn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);else n instanceof Blob?e=n:Kn.removeItem(Fn.CHAT_MY_ICON_LOCAL_STORAGE_KEY);e&&_n.createAsync(e).then(i=>{i.state===Di.COMPLETE?(Yt.instance.add(i),Fn.myCursor.imageIdentifier=i.identifier):Kn.removeItem(Fn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)})}).catch(n=>{throw n})}catch(n){console.log(n),Kn.removeItem(Fn.CHAT_MY_ICON_LOCAL_STORAGE_KEY)}}catch(n){console.log(n),yield Kn.removeItem(Fn.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(e=>console.log(e)),yield Kn.removeItem(Fn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(e=>console.log(e))}return Fn.myCursor})()}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(Fn.userIdMap.set(e,this.identifier),Fn.userIdMap.delete(this.userId)),i!==this.peerId&&(Fn.peerIdMap.set(i,this.identifier),Fn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};Oe([Xe()],Ce.prototype,"userId",void 0),Oe([Xe()],Ce.prototype,"peerId",void 0),Oe([Xe()],Ce.prototype,"name",void 0),Oe([Xe()],Ce.prototype,"imageIdentifier",void 0),Oe([Xe()],Ce.prototype,"color",void 0),Oe([Xe()],Ce.prototype,"isGMMode",void 0),Ce=Fn=Oe([ir("PeerCursor")],Ce);let wm=class extends Ir{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&this.paletteColor!=Ce.CHAT_TRANSPARENT_COLOR?this.paletteColor:Ce.myCursor&&Ce.myCursor.color!=Ce.CHAT_TRANSPARENT_COLOR?Ce.myCursor.color:Ce.CHAT_DEFAULT_COLOR}set color(n){this.paletteColor=n}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e,i){let r="";r="string"==typeof n?n:n.palette;const o=[];let a=0,l=!0;for(;l;)a++,l=!1,r=r.replace(/[{\uff5b][\s\u3000]*([^{}\uff5b\uff5d]+)[\s\u3000]*[}\uff5d]/g,(u,f)=>{if(o.includes(f))return u;l=!0;let g="";for(let v of this.paletteVariables)_e.cr(_e.toHalfWidth(v.name.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim()===_e.cr(_e.toHalfWidth(f.replace(/[\u2015\u30fc\u2014\u2010]/g,"-"))).toLowerCase().replace(/[\s\r\n]+/," ").trim()&&(g=v.value);if(e){let v=e.getFirstElementByNameUnsensitive(f);if(v?(g=v.isNumberResource?v.currentValue:v.isCheckProperty?v.checkValue():v.isAbilityScore?v.calcAbilityScore():v.value,null==g&&(g="")):(v=e.getFirstElementByNameUnsensitive(f,/^\u6700\u5927/)||e.getFirstElementByNameUnsensitive(f,/^Max[\:\_\-\s]*/i)||e.getFirstElementByNameUnsensitive(f,/^\u521d\u671f/)||e.getFirstElementByNameUnsensitive(f,/\u521d\u671f\u5024$/)||e.getFirstElementByNameUnsensitive(f,/\u6700\u5927\u5024$/))&&(v.isNumberResource||v.isAbilityScore)||(v=e.getFirstElementByNameUnsensitive(f,/^\u57fa\u672c/)||e.getFirstElementByNameUnsensitive(f,/^\u539f/)||e.getFirstElementByNameUnsensitive(f,/\^$/)||e.getFirstElementByNameUnsensitive(f,/\u57fa\u672c\u5024$/)||e.getFirstElementByNameUnsensitive(f,/\u539f\u70b9$/))&&(v.isNumberResource||v.isAbilityScore)?g=v.value:(v=e.getFirstElementByNameUnsensitive(f,/\u4fee\u6b63\u5024?$/)||e.getFirstElementByNameUnsensitive(f,/\s*Mod(ifier|\.)?$/i)||e.getFirstElementByNameUnsensitive(f,/\u30dc\u30fc\u30ca\u30b9$/))&&v.isAbilityScore&&(g=v.calcAbilityScore()),""==g){let C;if(C=/^\$(.+)$/.exec(_e.toHalfWidth(f.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")))){if(i){if(/^\d+$/.test(_e.toHalfWidth(C[1]))){const E=parseInt(_e.toHalfWidth(C[1]));return null!=i[E-1]?i[E-1]:""}return u.replace(f,C[1])}return o.push(f),u}}return g+""}return""}),128<a&&(l=!1);return r}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^[\s\u3000]*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s\u3000]+)[\s\u3000]*[=\uff1d][\s\u3000]*(.+)[\s\u3000]*/gi.exec(n);return e?{name:_e.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var Uh;Oe([Xe()],wm.prototype,"dicebot",void 0),Oe([Xe()],wm.prototype,"paletteColor",void 0),wm=Oe([ir("chat-palette")],wm);let ht=Uh=class extends Ir{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(n,e="",i={},r=""){let o;return o=r&&0<r.length?new Uh(r):new Uh,o.attributes=i,o.name=n,o.value=e,o.initialize(),o}get loggingValue(){let n;if(this.isSimpleNumber)n=`${this.value}`;else if(this.isNumberResource)n=`${this.currentValue}/${this.value&&0!=this.value?this.value:"???"}`;else if(this.isCheckProperty)n=this.value?" \u2192 \u2714ON":" \u2192 OFF";else if(this.isAbilityScore){const e=this.calcAbilityScore();n=`${this.value}`,this.currentValue&&(n+=`(${e>=0?"+":""}${e})`)}else n=null==this.value?"":this.value.toString();return this.oldLoggingValue!==n&&(this.oldLoggingValue=n,this.changeObserver&&this.changeObserver()),n}getElementsByName(n,e=Bh.None){let i=[];for(let r of this.children)r instanceof Uh&&(_e.equals(r.getAttribute("name"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByName(n,e)));return i}getElementsByType(n,e=Bh.None){let i=[];for(let r of this.children)r instanceof Uh&&(_e.equals(r.getAttribute("type"),n,e)&&i.push(r),Array.prototype.push.apply(i,r.getElementsByType(n,e)));return i}getFirstElementByName(n,e=Bh.None){for(let i of this.children)if(i instanceof Uh){if(_e.equals(i.getAttribute("name"),n,e))return i;let r=i.getFirstElementByName(n,e);if(r)return r}return null}getFirstElementByNameUnsensitive(n,e=null,i=""){for(let r of this.children)if(r instanceof Uh){let o=_e.cr(_e.toHalfWidth(n.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim();if(null!=e&&(o=o.replace(e,i)),_e.cr(_e.toHalfWidth(r.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()).replace(/[\s\r\n]+/," ").trim()===o)return r;let s=r.getFirstElementByNameUnsensitive(n,e,i);if(s)return s}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let n;return null==this.currentValue?+this.value:(n=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+n[1]):(n=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}checkValue(){if(!this.isCheckProperty)return"0";let n=(this.currentValue+"").trim().split(/[|\uff5c]/g,2);return null==n[1]&&(n[1]="0",(null==n[0]||""===n[0].trim()&&!/[|\uff5c]/.test(this.currentValue+""))&&(n[0]="1")),n[this.value?0:1].trim()}};var ji,t;Oe([Xe()],ht.prototype,"name",void 0),Oe([Xe()],ht.prototype,"type",void 0),Oe([Xe()],ht.prototype,"currentValue",void 0),ht=Uh=Oe([ir("data")],ht),(t=ji||(ji={})).sqrMagnitude=function n(s,a={x:0,y:0,z:0}){return(s.x-a.x)**2+(s.y-a.y)**2+((s.z??0)-(a.z??0))**2},t.clampMin=function e(s,a=0){return s<a?a:s},t.clampMax=function i(s,a=100){return s<a?s:a},t.radians=function r(s){return s*Math.PI/180},t.degrees=function o(s){return 180*s/Math.PI};let Sr=class extends Ir{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=_n.Empty,this._shadowImageFile=_n.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("imageIdentifier");return n[this.currntImageIndex<0?0:this.currntImageIndex>=n.length?n.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageElement;if(n&&this._imageFile.identifier!==n.value){let e=Yt.instance.get(n.value);this._imageFile=e||_n.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>Yt.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("faceIcon");if(n){let e=n[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?Yt.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>Yt.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let n=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(n&&this._shadowImageFile.identifier!==n.value){let e=Yt.instance.get(n.value);this._shadowImageFile=e||_n.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=Yt.instance.get(e.currentValue);this._shadowImageFile=i||_n.Empty}}return this._shadowImageFile}get altitude(){let n=this.getElement("altitude",this.commonDataElement),e=n?+n.value:0;return Number.isNaN(e)?0:e}set altitude(n){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=n)}get isHaveAltitude(){return!!this.getElement("altitude",this.commonDataElement)}get isGMMode(){return!!Ce.myCursor&&Ce.myCursor.isGMMode}calcSqrDistance(n){return ji.sqrMagnitude({x:this.location.x,y:this.location.y,z:this.posZ},{x:n.location.x,y:n.location.y,z:n.posZ})}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=ht.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(ht.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(ht.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(ht.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(ht.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?dt.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);i&&(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?Yt.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;i&&(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};Oe([Xe()],Sr.prototype,"location",void 0),Oe([Xe()],Sr.prototype,"posZ",void 0),Oe([Xe()],Sr.prototype,"currntImageIndex",void 0),Oe([Xe()],Sr.prototype,"isUseIconToOverviewImage",void 0),Oe([Xe()],Sr.prototype,"currntIconIndex",void 0),Oe([Xe()],Sr.prototype,"isAltitudeIndicate",void 0),Oe([Xe()],Sr.prototype,"isInverse",void 0),Oe([Xe()],Sr.prototype,"isHollow",void 0),Oe([Xe()],Sr.prototype,"isBlackPaint",void 0),Oe([Xe()],Sr.prototype,"aura",void 0),Oe([Xe()],Sr.prototype,"isNotRide",void 0),Oe([Xe()],Sr.prototype,"isInventoryIndicate",void 0),Sr=Oe([ir("TabletopObject")],Sr);var To=function(t){return t[t.Default=1]="Default",t[t.Image=2]="Image",t[t.Postfix=3]="Postfix",t[t.PostfixOrImage=4]="PostfixOrImage",t[t.PostfixAndImage=5]="PostfixAndImage",t[t.NotConditionStandUp=6]="NotConditionStandUp",t}(To||{});let vd=class extends ht{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1,this.isSortNameList=!0}get standElements(){return this.getElementsByName("stand")}add(n){let e=this.getFirstElementByName("stand")?To.NotConditionStandUp:To.Default,i=ht.create("stand");i.appendChild(ht.create("name","",{},"name_"+i.identifier)),i.appendChild(ht.create("imageIdentifier",n&&n!=_n.Empty.identifier?n:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(ht.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(ht.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(ht.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(ht.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(ht.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(ht.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(ht.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(ht.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(ht.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(n){this.removeChild(n)}matchStandInfo(n,e,i=null){const r=e instanceof _n?e.identifier:e;let o="",s=!1,a=[];["\uff20\u9000\u53bb","@farewell"].forEach(C=>{_e.toHalfWidth(n).trimRight().toUpperCase().endsWith(_e.toHalfWidth(C).toUpperCase())&&(("@"==C.slice(0,1)||"\uff20"==C.slice(0,1))&&o.length<C.length&&(o=C),s=!0)});for(const C of this.standElements){const E=C.getFirstElementByName("name");E&&E.value.toString()==i&&a.push(C)}let l=1,u=!0,f=[],g=[];for(const C of this.standElements){if(!C.getFirstElementByName("imageIdentifier")||!C.getFirstElementByName("conditionType"))continue;const E=C.getFirstElementByName("conditionType").value;if(E!=To.NotConditionStandUp)if(E==To.Default)f.push(C);else{const w=C.getFirstElementByName("postfix")?C.getFirstElementByName("postfix").value.toString():null,T=C.getFirstElementByName("targetImageIdentifier")?C.getElementsByName("targetImageIdentifier").map(P=>P.value):[];let M=!1,S=!1;if(w&&(E==To.Postfix||E==To.PostfixOrImage||E==To.PostfixAndImage))for(let P of w.split(/[\r\n]+/g))null==P||0==P.trim().length||_e.toHalfWidth(n.replaceAll("\uff1e","\u2192")).toUpperCase().trimRight().endsWith(_e.toHalfWidth(P.replaceAll("\uff1e","\u2192")).trimRight().toUpperCase())&&(("@"==P.slice(0,1)||"\uff20"==P.slice(0,1))&&o.length<P.length&&(o=P),M=!0);T.length>0&&(E==To.Image||E==To.PostfixOrImage||E==To.PostfixAndImage)&&(S=r&&T.indexOf(r)>=0),(M&&(E==To.Postfix||E==To.PostfixOrImage)||S&&(E==To.Image||E==To.PostfixOrImage)||M&&S&&E==To.PostfixAndImage)&&(u=!1,g.push(C),l<+E&&(l=+E))}}i||(a=u?f:g.filter(C=>+C.getFirstElementByName("conditionType").value==l));let v={standElementIdentifier:null,matchMostLongText:o,farewell:s};return a&&a.length>0&&(v.standElementIdentifier=a[Math.floor(Math.random()*a.length)].identifier),v}};var zC;Oe([Xe()],vd.prototype,"position",void 0),Oe([Xe()],vd.prototype,"height",void 0),Oe([Xe()],vd.prototype,"overviewIndex",void 0),Oe([Xe()],vd.prototype,"isSortNameList",void 0),vd=Oe([ir("stand-list")],vd);let cn=zC=class extends Sr{constructor(n=Il.k.generateUuid()){super(n),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.isAllowsChat=!0,this.text="",this.dialog=null,this.isEmote=!1,this.isLoaded=!1,this.chatBubbleAltitude=0,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}get height(){let n=this.getElement("height",this.commonDataElement),e=n?+n.value:0;return n&&n.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let n of this.children)if(n instanceof wm)return n;return null}get ownerName(){let n=Ce.findByUserId(this.owner);return n?n.name:null}get ownerColor(){let n=Ce.findByUserId(this.owner);return n?n.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof vd)return e;let n=new vd("StandList_"+this.identifier);return n.initialize(),this.appendChild(n),n}static create(n,e,i){let r=new zC;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||xt.peer.userId===this.owner}static get isStealthMode(){for(const n of dt.instance.getObjects(zC))if(n.isHideIn&&n.isVisible&&"table"===n.location.name)return!0;return!1}complement(){let n=this.getElement("altitude",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+this.identifier)),n=this.getElement("height",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.insertBefore(ht.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement))}createTestGameDataElement(n,e,i){this.createDataElements();let r=ht.create("name",n,{},"name_"+this.identifier),o=ht.create("size",e,{},"size_"+this.identifier),s=ht.create("height",0,{currentValue:""},"height_"+this.identifier),a=ht.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let l=ht.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),u=ht.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),f=ht.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(a),this.detailDataElement.appendChild(l),l.appendChild(u),l.appendChild(f);let g=ht.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(g),g.appendChild(ht.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),g.appendChild(ht.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),g.appendChild(ht.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),g=ht.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(g),g.appendChild(ht.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),g.appendChild(ht.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),g.appendChild(ht.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),g.appendChild(ht.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),g.appendChild(ht.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),g.appendChild(ht.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),g=ht.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(g),g.appendChild(ht.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),g.appendChild(ht.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),g.appendChild(ht.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),g.appendChild(ht.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),g.appendChild(ht.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),g.appendChild(ht.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let E=new wm("ChatPalette_"+this.identifier);E.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n:\uff48\uff50-3d6 2d20KH1+{\u5668\u7528\u5ea6}+2>=15 \u300a{Lv1}\u300b\u3092\u4f7f\u7528\u3000HP\uff5b\uff041\uff5d\n:HP={\u6700\u5927HP}:MP-10 HP\u5168\u56de\u5fa9\uff01 MP{$2}\u3001HP{HP} \u2192 {$HP}\uff08{$1}\u70b9\u56de\u5fa9\uff09\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),E.initialize(),this.appendChild(E);let w=new vd("StandList_"+this.identifier);w.initialize(),this.appendChild(w)}};Oe([Xe()],cn.prototype,"rotate",void 0),Oe([Xe()],cn.prototype,"roll",void 0),Oe([Xe()],cn.prototype,"isDropShadow",void 0),Oe([Xe()],cn.prototype,"isShowChatBubble",void 0),Oe([Xe()],cn.prototype,"owner",void 0),Oe([Xe()],cn.prototype,"isAllowsChat",void 0),cn=zC=Oe([ir("character")],cn);let yd=class extends Ir{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(n=>{let e=null;if(e=(n=n.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+_e.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+_e.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+_e.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+_e.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+_e.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=n.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(n=>n):[]}};var ec;Oe([Xe()],yd.prototype,"name",void 0),Oe([Xe()],yd.prototype,"command",void 0),Oe([Xe()],yd.prototype,"dice",void 0),yd=Oe([ir("dice-roll-table")],yd);let Nc=class extends Ir{static#e=ec=this;static get instance(){return ec._instance||(ec._instance=new ec("DiceRollTableList"),ec._instance.initialize()),ec._instance}get diceRollTables(){return this.children}addDiceRollTable(...n){let e=null;if(n[0]instanceof yd)e=n[0];else{let i=n[0];e=new yd(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of ec.instance.children)i.destroy();let e=ec.instance.toContext();e.syncData=this.toContext().syncData,ec.instance.apply(e),ec.instance.update(),super.parseInnerXml.apply(ec.instance,[n]),this.destroy()}};Nc=ec=Oe([ir("dice-roll-table-list")],Nc);var $a=function(t){return t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL",t}($a||{});class Sl{get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return $a.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?$a.URL:$a.COMPLETE:$a.NULL}constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}static createEmpty(n){let e=new Sl;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Sl;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Sl;return e.apply(n),e}}static createAsync(n){return(0,R.A)(function*(){return n instanceof File?yield Sl._createAsync(n,n.name):n instanceof Blob?yield Sl._createAsync(n):void 0})()}static _createAsync(n,e){return(0,R.A)(function*(){let i=yield Fc.readAsArrayBufferAsync(n),r=new Sl;return r.context.identifier=yield Fc.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.context.url=n.url),this.createURLs()}createURLs(){this.state!==$a.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==$a.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Rc=function(t){return t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION",t[t.SOUND_EFFECT=2]="SOUND_EFFECT",t[t.NOTICE=3]="NOTICE",t}(Rc||{});class He{static#e=this.AUDITION_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-volume-local-storage";static#t=this.MAIN_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-volume-local-storage";static#n=this.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-volume-local-storage";static#i=this.NOTICE_VOLUME_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-volume-local-storage";static#r=this.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-audition-is-mute-local-storage";static#o=this.MAIN_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-main-is-mute-local-storage";static#s=this.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-sound-effect-is-mute-local-storage";static#a=this.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY="udonanaumu-audio-player-notice-is-mute-local-storage";static get audioContext(){return He._audioContext||(He._audioContext=new(window.AudioContext||window.webkitAudioContext)),He._audioContext}static#l=this._isMute=!1;static get isMute(){return He._isMute}static set isMute(n){He._isMute=n,He.volume=He._volume}static#c=this._volume=.5;static get volume(){return He._volume}static set volume(n){He._volume=n,He.masterGainNode.gain.setTargetAtTime(He.isMute?0:He._volume,He.audioContext.currentTime,.01)}static#u=this._isAuditionMute=!1;static get isAuditionMute(){return He._isAuditionMute}static set isAuditionMute(n){He._isAuditionMute=n,He.auditionVolume=He._auditionVolume}static#d=this._auditionVolume=.5;static get auditionVolume(){return He._auditionVolume}static set auditionVolume(n){He._auditionVolume=n,He.auditionGainNode.gain.setTargetAtTime(He.isAuditionMute?0:He._auditionVolume,He.audioContext.currentTime,.01)}static#h=this._isSoundEffectMute=!1;static get isSoundEffectMute(){return He._isSoundEffectMute}static set isSoundEffectMute(n){He._isSoundEffectMute=n,He.soundEffectVolume=He._soundEffectVolume}static#f=this._soundEffectVolume=.5;static get soundEffectVolume(){return He._soundEffectVolume}static set soundEffectVolume(n){He._soundEffectVolume=n,He.soundEffectGainNode.gain.setTargetAtTime(He.isSoundEffectMute?0:He._soundEffectVolume,He.audioContext.currentTime,.01)}static#p=this._isNoticeMute=!1;static get isNoticeMute(){return He._isNoticeMute}static set isNoticeMute(n){He._isNoticeMute=n,He.noticeVolume=He._noticeVolume}static#g=this._noticeVolume=.5;static get noticeVolume(){return He._noticeVolume}static set noticeVolume(n){He._noticeVolume=n,He.noticeGainNode.gain.setTargetAtTime(He.isNoticeMute?0:He._noticeVolume,He.audioContext.currentTime,.01)}static get masterGainNode(){if(!He._masterGainNode){let n=He.audioContext.createGain();n.gain.setValueAtTime(He._volume,He.audioContext.currentTime),n.connect(He.audioContext.destination),He._masterGainNode=n}return He._masterGainNode}static get auditionGainNode(){if(!He._auditionGainNode){let n=He.audioContext.createGain();n.gain.setValueAtTime(He._auditionVolume,He.audioContext.currentTime),n.connect(He.audioContext.destination),He._auditionGainNode=n}return He._auditionGainNode}static get soundEffectGainNode(){if(!He._soundEffectGainNode){let n=He.audioContext.createGain();n.gain.setValueAtTime(He._soundEffectVolume,He.audioContext.currentTime),n.connect(He.audioContext.destination),He._soundEffectGainNode=n}return He._soundEffectGainNode}static get noticeGainNode(){if(!He._noticeGainNode){let n=He.audioContext.createGain();n.gain.setValueAtTime(He._noticeVolume,He.audioContext.currentTime),n.connect(He.audioContext.destination),He._noticeGainNode=n}return He._noticeGainNode}static get rootNode(){return He.masterGainNode}static get auditionNode(){return He.auditionGainNode}static get soundEffectNode(){return He.soundEffectGainNode}static get noticeNode(){return He.noticeGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=He.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static#m=this.cacheMap=new Map;constructor(n){this.volumeType=Rc.MASTER,this.audio=n}static play(n,e=1){this.playBufferAsync(n,e)}static playSoundEffect(n,e=1){this.playBufferAsyncBase(He.soundEffectNode,n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===$a.URL&&(He.cacheMap.has(n.identifier)?e=He.cacheMap.get(n.identifier).url:He.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){this.audioElm&&(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){switch(this.volumeType){case Rc.AUDITION:return He.auditionNode;case Rc.SOUND_EFFECT:return He.soundEffectNode;case Rc.NOTICE:return He.noticeNode;default:return He.rootNode}}static playBufferAsync(n,e=1){return(0,R.A)(function*(){He.playBufferAsyncBase(He.rootNode,n,e)})()}static playBufferAsyncBase(n,e,i=1){return(0,R.A)(function*(){let r=yield He.createBufferSourceAsync(e);if(!r)return;let o=He.audioContext.createGain();o.gain.setValueAtTime(i,He.audioContext.currentTime),o.connect(n),r.connect(o),r.onended=()=>{r.stop(),r.disconnect(),o.disconnect(),r.buffer=null},r.start()})()}static createBufferSourceAsync(n){var e=this;return(0,R.A)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===$a.URL)if(He.cacheMap.has(n.identifier))i=He.cacheMap.get(n.identifier).blob;else{let s=yield He.createCacheAsync(n);i=s&&s.blob?s.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),o=He.audioContext.createBufferSource();return o.buffer=r,o}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,R.A)(function*(i,r){He.audioContext.decodeAudioData(yield Fc.readAsArrayBufferAsync(n),o=>i(o),o=>r(o))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,R.A)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,R.A)(function*(){let e={url:n.url,blob:null};try{e.blob=yield He.getBlobAsync(n)}catch(i){return console.error(i),e}return He.cacheMap.has(n.identifier)?He.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),He.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){He.audioContext.resume();let n=()=>{He.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}class Jt{static get instance(){return Jt._instance||(Jt._instance=new Jt),Jt._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}constructor(){this.hash={},console.log("AudioStorage ready...")}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,R.A)(function*(){let i=yield Sl.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Sl.create(n);else if(n instanceof Sl)e=n;else{if(this.update(n))return this.hash[n.identifier];e=Sl.create(n)}return this._add(e)}_add(n){return $a.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof Sl?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),U.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new _d.b(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of Jt.instance.audios)$a.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var c5=function(t){return t.ACTION="action",t.SEPARATOR="separator",t}(c5||{});const At={name:"",disabled:!0,type:c5.SEPARATOR};let Xo=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=Ce.CHAT_DEFAULT_COLOR,this.titleBold=!1}static#e=this.ContextMenuComponentClass=null;get isShow(){return!!this.panelComponentRef}open(e,i,r,o,s,a){this.close(),o||(o=t.defaultParentViewContainerRef);let u=o.createComponent(t.ContextMenuComponentClass,{index:o.length,injector:o.injector});const f=u.injector.get(t);f.panelComponentRef=u,i&&(f.actions=i),e&&(f.position.x=e.x,f.position.y=e.y),f.titleColor=s||Ce.CHAT_DEFAULT_COLOR,f.titleBold=a,f.title=r??"",u.onDestroy(()=>{f.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})(),hr=(()=>{class t{get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>{this._isDragging=e,document.body.dispatchEvent(new CustomEvent("draggingstate",{detail:e,bubbles:!0}))})}constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1,this.isTablePickGesture=!1}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i,3),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let o=e.touches[r],s={x:o.pageX,y:o.pageY,z:0,identifier:o.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(s,12),this.pointers.push(s)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<ji.sqrMagnitude(e,this.startPostion)&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&ji.sqrMagnitude(e,r)<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Sn))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function u5(t,n,e){return e?u5(t,n).pipe(TI(e)):new Zi(i=>{const r=(...s)=>i.next(1===s.length?s[0]:s),o=t(r);return Rt(n)?()=>n(r,o):void 0})}function VC(...t){return mC(t,EI(t))}function Pb(t,n){return ko((e,i)=>{let r=null,o=0,s=!1;const a=()=>s&&!r&&i.complete();e.subscribe(mo(i,l=>{r?.unsubscribe();let u=0;const f=o++;xl(t(l,f)).subscribe(r=mo(i,g=>i.next(n?n(l,g,f,u++):g),()=>{r=null,a()}))},()=>{s=!0,a()}))})}const lX=["youtubeContainer"];function cX(t,n){if(1&t){const e=Ie();p(0,"youtube-player-placeholder",2),X("click",function(){return O(e),D(y()._load(!0))}),m()}if(2&t){const e=y();_("videoId",e.videoId)("width",e.width)("height",e.height)("isLoading",e._isLoading)("buttonLabel",e.placeholderButtonLabel)("quality",e.placeholderImageQuality)}}let uX=(()=>{class t{_getBackgroundImage(){let e;return e="low"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/hqdefault.jpg`:"high"===this.quality?`https://i.ytimg.com/vi/${this.videoId}/maxresdefault.jpg`:`https://i.ytimg.com/vi_webp/${this.videoId}/sddefault.webp`,`url(${e})`}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=xn({type:t,selectors:[["youtube-player-placeholder"]],hostAttrs:[1,"youtube-player-placeholder"],hostVars:8,hostBindings:function(i,r){2&i&&(ke("background-image",r._getBackgroundImage())("width",r.width,"px")("height",r.height,"px"),eb("youtube-player-placeholder-loading",r.isLoading))},inputs:{videoId:"videoId",width:"width",height:"height",isLoading:"isLoading",buttonLabel:"buttonLabel",quality:"quality"},standalone:!0,features:[IT],decls:4,vars:1,consts:[["type","button",1,"youtube-player-placeholder-button"],["height","100%","version","1.1","viewBox","0 0 68 48","focusable","false","aria-hidden","true"],["d","M66.52,7.74c-0.78-2.93-2.49-5.41-5.42-6.19C55.79,.13,34,0,34,0S12.21,.13,6.9,1.55 C3.97,2.33,2.27,4.81,1.48,7.74C0.06,13.05,0,24,0,24s0.06,10.95,1.48,16.26c0.78,2.93,2.49,5.41,5.42,6.19 C12.21,47.87,34,48,34,48s21.79-0.13,27.1-1.55c2.93-0.78,4.64-3.26,5.42-6.19C67.94,34.95,68,24,68,24S67.94,13.05,66.52,7.74z","fill","#f00"],["d","M 45,24 27,14 27,34","fill","#fff"]],template:function(i,r){1&i&&(p(0,"button",0),nu(),p(1,"svg",1),Ne(2,"path",2)(3,"path",3),m()()),2&i&&$t("aria-label",r.buttonLabel)},styles:[".youtube-player-placeholder{display:flex;align-items:center;justify-content:center;width:100%;overflow:hidden;cursor:pointer;background-color:#000;background-position:center center;background-size:cover;transition:box-shadow 300ms ease;box-shadow:inset 0 120px 90px -90px rgba(0,0,0,.8)}.youtube-player-placeholder-button{transition:opacity 300ms ease;-moz-appearance:none;-webkit-appearance:none;background:none;border:none;padding:0;display:flex}.youtube-player-placeholder-button svg{width:68px;height:48px}.youtube-player-placeholder-loading{box-shadow:none}.youtube-player-placeholder-loading .youtube-player-placeholder-button{opacity:0}"],encapsulation:2,changeDetection:0})}return t})();const dX=new hn("YOUTUBE_PLAYER_CONFIG");function f5(t){return null==t?t:qT(t,0)}let hX=(()=>{class t{get height(){return this._height}set height(e){this._height=null==e||isNaN(e)?390:e}get width(){return this._width}set width(e){this._width=null==e||isNaN(e)?640:e}constructor(e,i){this._ngZone=e,this._destroyed=new ra,this._playerChanges=new Yc(void 0),this._nonce=En(Ig,{optional:!0}),this._changeDetectorRef=En(io),this._isLoading=!1,this._hasPlaceholder=!0,this._height=390,this._width=640,this.disableCookies=!1,this.disablePlaceholder=!1,this.showBeforeIframeApiLoads=!1,this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange");const r=En(dX,{optional:!0});this.loadApi=r?.loadApi??!0,this.disablePlaceholder=!!r?.disablePlaceholder,this.placeholderButtonLabel=r?.placeholderButtonLabel||"Play video",this.placeholderImageQuality=r?.placeholderImageQuality||"standard",this._isBrowser=lI(i)}ngAfterViewInit(){this._conditionallyLoad()}ngOnChanges(e){this._shouldRecreatePlayer(e)?this._conditionallyLoad():this._player&&((e.width||e.height)&&this._setSize(),e.suggestedQuality&&this._setQuality(),(e.startSeconds||e.endSeconds||e.suggestedQuality)&&this._cuePlayer())}ngOnDestroy(){this._pendingPlayer?.destroy(),this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_load(e){this._isBrowser&&(window.YT&&window.YT.Player?this._createPlayer(e):(this.loadApi&&(this._isLoading=!0,function fX(t){if(ES)return;const e=document.createElement("script"),i=r=>{e.removeEventListener("load",i),e.removeEventListener("error",i),"error"===r.type&&(ES=!1)};e.addEventListener("load",i),e.addEventListener("error",i),e.src="https://www.youtube.com/iframe_api",e.async=!0,t&&e.setAttribute("nonce",t),ES=!0,document.body.appendChild(e)}(this._nonce)),this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback?.(),this._ngZone.run(()=>this._createPlayer(e))}))}_conditionallyLoad(){this._shouldShowPlaceholder()?1===this.playerVars?.autoplay&&this._load(!0):this._load(!1)}_shouldShowPlaceholder(){return!this.disablePlaceholder&&(!this._isBrowser||this._hasPlaceholder&&!!this.videoId&&!this._player)}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_shouldRecreatePlayer(e){const i=e.videoId||e.playerVars||e.disableCookies||e.disablePlaceholder;return!!i&&!i.isFirstChange()}_createPlayer(e){if(this._player?.destroy(),this._pendingPlayer?.destroy(),typeof YT>"u"||!this.videoId&&!this.playerVars?.list)return;const i=this._ngZone.runOutsideAngular(()=>new YT.Player(this.youtubeContainer.nativeElement,{videoId:this.videoId,host:this.disableCookies?"https://www.youtube-nocookie.com":void 0,width:this.width,height:this.height,playerVars:e?{...this.playerVars||{},autoplay:1}:this.playerVars})),r=()=>{this._ngZone.run(()=>{this._isLoading=!1,this._hasPlaceholder=!1,this._player=i,this._pendingPlayer=void 0,i.removeEventListener("onReady",r),this._playerChanges.next(i),this._setSize(),this._setQuality(),this._pendingPlayerState&&(this._applyPendingPlayerState(i,this._pendingPlayerState),this._pendingPlayerState=void 0);const o=i.getPlayerState();(o===YT.PlayerState.UNSTARTED||o===YT.PlayerState.CUED||null==o)&&this._cuePlayer(),this._changeDetectorRef.markForCheck()})};this._pendingPlayer=i,i.addEventListener("onReady",r)}_applyPendingPlayerState(e,i){const{playbackState:r,playbackRate:o,volume:s,muted:a,seek:l}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=o&&e.setPlaybackRate(o),null!=s&&e.setVolume(s),null!=a&&(a?e.mute():e.unMute()),null!=l&&e.seekTo(l.seconds,l.allowSeekAhead)}_cuePlayer(){this._player&&this.videoId&&this._player.cueVideoById({videoId:this.videoId,startSeconds:this.startSeconds,endSeconds:this.endSeconds,suggestedQuality:this.suggestedQuality})}_setSize(){this._player?.setSize(this.width,this.height)}_setQuality(){this._player&&this.suggestedQuality&&this._player.setPlaybackQuality(this.suggestedQuality)}_getLazyEmitter(e){return this._playerChanges.pipe(Pb(i=>i?u5(r=>{i.addEventListener(e,r)},r=>{try{i?.removeEventListener?.(e,r)}catch{}}):VC()),i=>new Zi(r=>i.subscribe({next:o=>this._ngZone.run(()=>r.next(o)),error:o=>r.error(o),complete:()=>r.complete()})),function aX(t){return ko((n,e)=>{xl(t).subscribe(mo(e,()=>e.complete(),ia)),!e.closed&&n.subscribe(e)})}(this._destroyed))}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(gl))};static#t=this.\u0275cmp=xn({type:t,selectors:[["youtube-player"]],viewQuery:function(i,r){if(1&i&&Dn(lX,7),2&i){let o;On(o=An())&&(r.youtubeContainer=o.first)}},inputs:{videoId:"videoId",height:[ae.HasDecoratorInputTransform,"height","height",qT],width:[ae.HasDecoratorInputTransform,"width","width",qT],startSeconds:[ae.HasDecoratorInputTransform,"startSeconds","startSeconds",f5],endSeconds:[ae.HasDecoratorInputTransform,"endSeconds","endSeconds",f5],suggestedQuality:"suggestedQuality",playerVars:"playerVars",disableCookies:[ae.HasDecoratorInputTransform,"disableCookies","disableCookies",np],loadApi:[ae.HasDecoratorInputTransform,"loadApi","loadApi",np],disablePlaceholder:[ae.HasDecoratorInputTransform,"disablePlaceholder","disablePlaceholder",np],showBeforeIframeApiLoads:[ae.HasDecoratorInputTransform,"showBeforeIframeApiLoads","showBeforeIframeApiLoads",np],placeholderButtonLabel:"placeholderButtonLabel",placeholderImageQuality:"placeholderImageQuality"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},standalone:!0,features:[KO,mr,IT],decls:4,vars:3,consts:[["youtubeContainer",""],[3,"videoId","width","height","isLoading","buttonLabel","quality"],[3,"click","videoId","width","height","isLoading","buttonLabel","quality"]],template:function(i,r){1&i&&(L(0,cX,1,6,"youtube-player-placeholder",1),p(1,"div"),Ne(2,"div",null,0),m()),2&i&&(YA(0,r._shouldShowPlaceholder()?0:-1),h(),ke("display",r._shouldShowPlaceholder()?"none":""))},dependencies:[uX],encapsulation:2,changeDetection:0})}return t})(),ES=!1,pX=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({})}return t})();var Io;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,o=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),o)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),o):i.indexOf("vw")>0?e(i.replace("vw",""),o)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),o)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),o)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),o):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:o:o},t.parse=e}(Io||(Io={}));const Fb=-9999;class bu{get startPointer(){return this.firstPointer}get pointer(){return this.primaryPointer}get magnitude(){return ji.sqrMagnitude(this.firstPointer,this.primaryPointer)}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isPointerMoved(){return this._isPointerMoved}get isDestroyed(){return this._isDestroyed}constructor(...n){this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.startTime=-1e3,this.clearLastPointerTimer=new _d.b(this.clearLastPointer.bind(this),2e3,!1),this.firstPointer={x:0,y:0,z:0,identifier:Fb},this.lastStartPointers=[],this.lastMovePointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:Fb},this._isDragging=!1,this._isGrabbing=!1,this._isPointerMoved=!1,this._isDestroyed=!1;let e=n[0],i={capture:!1,passive:!1,always:!1},r=!0;switch(n.length){case 3:i=n[1],r=n[2];break;case 2:"boolean"==typeof n[1]?r=n[1]:i=n[1]}this.target=e,this.option={capture:!0===i.capture,passive:!0===i.passive,always:!0===i.always},r&&this.initialize()}initialize(){let n={capture:this.option.capture,passive:this.option.passive};this.target.addEventListener("mousedown",this.callbackOnMouse,n),this.target.addEventListener("touchstart",this.callbackOnTouch,n),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this.clearLastPointerTimer.clear(),this._isDestroyed=!0;let n={capture:this.option.capture};this.target.removeEventListener("mousedown",this.callbackOnMouse,n),this.target.removeEventListener("touchstart",this.callbackOnTouch,n),this.removeEventListeners(),this.onStart=null,this.onMove=null,this.onEnd=null,this.onContextMenu=null}cancel(){this._isDragging=this._isGrabbing=!1,this.clearLastPointerTimer.reset(),this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:Fb};this.isSyntheticEvent(n)?this.updateLastPointer(n):(this.updateLastPointer(n),this.primaryPointer=e,this.onPointer(n))}onTouch(n){if(!(n.changedTouches.length<1)){if(this.updateLastPointer(n),"touchstart"===n.type)this.primaryPointer=this.lastStartPointers[0];else{let r=Array.from(n.changedTouches).find(s=>s.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(a=>a.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this.onTap&&(this.startTime=performance.now()),this.clearLastPointerTimer.stop(),this.firstPointer=this.primaryPointer,this._isGrabbing=!0,this._isDragging=!1,this._isPointerMoved=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing,this._isPointerMoved=this._isPointerMoved||(n instanceof MouseEvent?3:12)**2<ji.sqrMagnitude(this.firstPointer,this.primaryPointer);break;default:this.onEnd&&this.onEnd(n),this.onTap&&performance.now()-this.startTime<250&&!this._isPointerMoved&&this.onTap(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){let i={x:n.pageX,y:n.pageY,z:0,identifier:Fb},r=this.lastMovePointers;"mousemove"!==n.type&&(r=r.concat(this.lastStartPointers));for(let o of r)if(o.identifier!==i.identifier&&ji.sqrMagnitude(i,o)<e**2)return!0;return!1}updateLastPointer(n){let e=[];if(n instanceof MouseEvent)e.push({x:n.pageX,y:n.pageY,z:0,identifier:Fb});else{let i=n.touches.length;for(let r=0;r<i;r++){let o=n.touches[r];e.push({x:o.pageX,y:o.pageY,z:0,identifier:o.identifier})}}this.lastMovePointers=e,("mousedown"===n.type||"touchstart"===n.type)&&(this.lastStartPointers=e)}clearLastPointer(){this.clearLastPointerTimer.stop(),this.lastStartPointers=[],this.lastMovePointers=[]}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let TS=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span,label,li",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new Qn,this.onmove=new Qn,this.onend=new Qn,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new bu(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),o=null!=e.touches&&this.isScrollableElement(e.target);!i||r||o?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",this.removeSelectionRanges(),this.removeFocus(),e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},o=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=o.x,i.y+=o.y,i.z+=o.z,0<ji.sqrMagnitude(i)&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,this.removeSelectionRanges(),this.removeFocus(),e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>ji.sqrMagnitude(this.input.pointer,this.startPointer))return;let r=o=>{o.cancelable&&o.preventDefault(),o.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",r,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",r,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let o=0;o<r.length;o++)if(r[o].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,o=["scroll","auto"],s=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let a=window.getComputedStyle(r);if(0<=o.indexOf(a.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=s.indexOf(a.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const s=r.right-r.left,a=r.bottom-r.top;o.right+s/2<r.right+e.x&&(i.x+=o.right+s/2-(r.right+e.x)),r.left+e.x<o.left-s/2&&(i.x+=o.left-s/2-(r.left+e.x)),o.bottom+a/2<r.bottom+e.y&&(i.y+=o.bottom+a/2-(r.bottom+e.y)),r.top+e.y<o.top-a/2&&(i.y+=o.top-a/2-(r.top+e.y))}else o.right<r.right+e.x&&(i.x+=o.right-(r.right+e.x)),r.left+e.x<o.left&&(i.x+=o.left-(r.left+e.x)),o.bottom<r.bottom+e.y&&(i.y+=o.bottom-(r.bottom+e.y)),r.top+e.y<o.top&&(i.y+=o.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Io.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Io.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(_r))};static#t=this.\u0275dir=wn({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:[ae.None,"draggable.disable","isDisable"],boundsSelector:[ae.None,"draggable.bounds","boundsSelector"],handleSelector:[ae.None,"draggable.handle","handleSelector"],unhandleSelector:[ae.None,"draggable.unhandle","unhandleSelector"],stackSelector:[ae.None,"draggable.stack","stackSelector"],opacity:[ae.None,"draggable.opacity","opacity"],allowOverHalf:[ae.None,"draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}})}return t})(),fr=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}static#e=this.\u0275fac=function(i){return new(i||t)(F(s4,16))};static#t=this.\u0275pipe=rs({name:"safe",type:t,pure:!0})}return t})();const gX=["cutInImageElement"],mX=["videoPlayerComponent"],Nb=(t,n,e,i,r,o,s)=>({video:t,test:n,secret:e,minimaize:i,"is-bordered":r,"is-grab":o,"is-grabbing":s}),jC=t=>({transform:t}),_X=(t,n,e,i)=>({autoplay:1,controls:0,start:t,loop:n,playsinline:1,rel:0,listType:"player",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1});function bX(t,n){1&t&&ti(0)}function vX(t,n){if(1&t){const e=Ie();p(0,"div",5,1),X("@cutInNone.done",function(){O(e);const r=y();return D(r.isVisible?null:r.end())})("dblclick",function(){return O(e),D(y().stop())})("mousedown",function(){return O(e),D(y().draggstart())})("mouseup",function(){return O(e),D(y().draggend())})("mouseleave",function(){return O(e),D(y().draggend())})("mouseout",function(){return O(e),D(y().draggend())})("mousemove",function(){O(e);const r=y();return D(!!r.isPointerDragging&&r.draggstart())}),L(2,bX,1,0,"ng-container",6),m()}if(2&t){const e=y(),i=rn(6);ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),_("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",dm(17,Nb,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),_("ngTemplateOutlet",i)}}function yX(t,n){1&t&&ti(0)}function CX(t,n){if(1&t){const e=Ie();p(0,"div",5,1),X("@cutInFadeInOut.done",function(){O(e);const r=y();return D(r.isVisible?null:r.end())})("dblclick",function(){return O(e),D(y().stop())})("mousedown",function(){return O(e),D(y().draggstart())})("mouseup",function(){return O(e),D(y().draggend())})("mouseleave",function(){return O(e),D(y().draggend())})("mouseout",function(){return O(e),D(y().draggend())})("mousemove",function(){O(e);const r=y();return D(!!r.isPointerDragging&&r.draggstart())}),L(2,yX,1,0,"ng-container",6),m()}if(2&t){const e=y(),i=rn(6);ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),_("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",dm(17,Nb,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),_("ngTemplateOutlet",i)}}function xX(t,n){1&t&&ti(0)}function wX(t,n){if(1&t){const e=Ie();p(0,"div",5,1),X("@cutInBounceInOut.done",function(){O(e);const r=y();return D(r.isVisible?null:r.end())})("dblclick",function(){return O(e),D(y().stop())})("mousedown",function(){return O(e),D(y().draggstart())})("mouseup",function(){return O(e),D(y().draggend())})("mouseleave",function(){return O(e),D(y().draggend())})("mouseout",function(){return O(e),D(y().draggend())})("mousemove",function(){O(e);const r=y();return D(!!r.isPointerDragging&&r.draggstart())}),L(2,xX,1,0,"ng-container",6),m()}if(2&t){const e=y(),i=rn(6);ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),_("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",dm(17,Nb,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),_("ngTemplateOutlet",i)}}function EX(t,n){1&t&&ti(0)}function TX(t,n){if(1&t){const e=Ie();p(0,"div",5,1),X("@cutInOpenInOut.done",function(){O(e);const r=y();return D(r.isVisible?null:r.end())})("dblclick",function(){return O(e),D(y().stop())})("mousedown",function(){return O(e),D(y().draggstart())})("mouseup",function(){return O(e),D(y().draggend())})("mouseleave",function(){return O(e),D(y().draggend())})("mouseout",function(){return O(e),D(y().draggend())})("mousemove",function(){O(e);const r=y();return D(!!r.isPointerDragging&&r.draggstart())}),L(2,EX,1,0,"ng-container",6),m()}if(2&t){const e=y(),i=rn(6);ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),_("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",dm(17,Nb,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),_("ngTemplateOutlet",i)}}function IX(t,n){1&t&&ti(0)}function SX(t,n){if(1&t){const e=Ie();p(0,"div",5,1),X("@cutInOpenInOut2.done",function(){O(e);const r=y();return D(r.isVisible?null:r.end())})("dblclick",function(){return O(e),D(y().stop())})("mousedown",function(){return O(e),D(y().draggstart())})("mouseup",function(){return O(e),D(y().draggend())})("mouseleave",function(){return O(e),D(y().draggend())})("mouseout",function(){return O(e),D(y().draggend())})("mousemove",function(){O(e);const r=y();return D(!!r.isPointerDragging&&r.draggstart())}),L(2,IX,1,0,"ng-container",6),m()}if(2&t){const e=y(),i=rn(6);ke("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),_("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",dm(17,Nb,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),h(2),_("ngTemplateOutlet",i)}}function MX(t,n){1&t&&(p(0,"div",23),x(1,"TEST"),m())}function DX(t,n){1&t&&(p(0,"div",24),x(1,"TEST"),m())}function OX(t,n){1&t&&(p(0,"div",25),x(1,"TEST"),m())}function AX(t,n){1&t&&(p(0,"div",26),x(1,"TEST"),m())}function kX(t,n){1&t&&(p(0,"div",27)(1,"i",28),x(2,"visibility"),m(),x(3," For Your Eyes Only"),m())}function PX(t,n){1&t&&(p(0,"div",29),x(1,"For Your Eyes Only "),p(2,"i",28),x(3,"visibility"),m()())}function FX(t,n){if(1&t&&(p(0,"div",30)(1,"span")(2,"span",31),x(3),m()()()),2&t){const e=y(2);h(),ke("color",e.senderColor),h(),ke("width",e.pixcelWidth-(e.isBordered?6:0),"px"),h(),Ih("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function NX(t,n){if(1&t&&(p(0,"div",32)(1,"span")(2,"span",31),x(3),m()()()),2&t){const e=y(2);h(),ke("color",e.senderColor),h(),ke("width",e.pixcelWidth-(e.isBordered?6:0),"px"),h(),Ih("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function RX(t,n){if(1&t){const e=Ie();p(0,"div",33),X("contextmenu",function(r){return O(e),D(y(2).onContextMenu(r))}),m()}if(2&t){const e=y(2);ke("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}function LX(t,n){if(1&t){const e=Ie();p(0,"youtube-player",34,2),X("ready",function(r){return O(e),D(y(2).onPlayerReady(r))})("stateChange",function(r){return O(e),D(y(2).onPlayerStateChange(r))}),m()}if(2&t){const e=y(2);ke("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),_("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",yl(6,_X,e.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function BX(t,n){if(1&t){const e=Ie();p(0,"img",35,3),X("error",function(){return O(e),D(y(2).onErrorFallback())}),m()}if(2&t){const e=y(2);ke("object-fit",e.objectFit),_("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",gn)}}function UX(t,n){if(1&t){const e=Ie();p(0,"img",36,3),It(2,"safe"),X("load",function(){return O(e),D(y(2).onImageLoad())})("contextmenu",function(r){return O(e),D(y(2).onContextMenu(r))}),m()}if(2&t){const e=y(2);ke("object-fit",e.objectFit),_("src",St(2,3,e.cutInImgageUrl,"resourceUrl"),gn)}}function HX(t,n){if(1&t){const e=Ie();L(0,MX,2,0,"div",7)(1,DX,2,0,"div",8)(2,OX,2,0,"div",9)(3,AX,2,0,"div",10)(4,kX,4,0,"div",11)(5,PX,4,0,"div",12)(6,FX,4,6,"div",13)(7,NX,4,6,"div",14),p(8,"div",15),X("contextmenu",function(r){return O(e),D(y().onContextMenu(r))}),m(),p(9,"div",16),X("contextmenu",function(r){return O(e),D(y().onContextMenu(r))}),m(),p(10,"div",17),X("contextmenu",function(r){return O(e),D(y().onContextMenu(r))}),m(),p(11,"div",18),X("contextmenu",function(r){return O(e),D(y().onContextMenu(r))}),m(),L(12,RX,1,4,"div",19)(13,LX,2,11,"youtube-player",20)(14,BX,2,3,"img",21)(15,UX,3,6,"img",22)}if(2&t){const e=y();_("ngIf",e.isTest),h(),_("ngIf",e.isTest),h(),_("ngIf",e.isTest),h(),_("ngIf",e.isTest),h(),_("ngIf",e.isSecret),h(),_("ngIf",e.isSecret),h(),_("ngIf",e.isIndicateSender),h(),_("ngIf",e.isIndicateSender),h(),ke("width",e.pixcelWidth+3,"px")("height",19,"px"),_("ngStyle",Be(32,jC,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),h(),ke("width",e.pixcelWidth+3,"px")("height",19,"px"),_("ngStyle",Be(34,jC,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),h(),ke("width",19,"px")("height",e.pixcelHeight+3,"px"),_("ngStyle",Be(36,jC,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),h(),ke("width",19,"px")("height",e.pixcelHeight+3,"px"),_("ngStyle",Be(38,jC,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),h(),_("ngIf",!e.videoId),h(),_("ngIf",e.videoId),h(),_("ngIf",e.videoId&&!e.isSoundOnly),h(),_("ngIf",!e.videoId||e.isSoundOnly)}}let p5=(()=>{class t{static#e=this.MIN_SIZE=250;get naturalWidth(){return this.videoId&&!this.isSoundOnly?this.cutIn.videoUrl.indexOf("/shorts/")>=0?270:480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?this.cutIn.videoUrl.indexOf("/shorts/")>=0?480:270:this._naturalHeight}constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=_n.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new He,this._cutInImgageUrl=""}ngOnInit(){U.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()}),this._cutInImgageUrl=this.cutInImage.state!==Di.COMPLETE||this._cutInImgageUrl?this.cutInImage.url:URL.createObjectURL(this.cutInImage.blob)}ngOnDestroy(){U.unregister(this,"UPDATE_AUDIO_RESOURE"),U.unregister(this,"CHANGE_JUKEBOX_VOLUME"),U.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo),this._cutInImgageUrl&&URL.revokeObjectURL(this._cutInImgageUrl)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=Yt.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||_n.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=t.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=t.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return this.isTest?He.isAuditionMute?0:100*He.auditionVolume:He.isMute?0:100*He.volume}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=Ce.findByPeerId(this.sender);return i instanceof Ce&&(e=i.name),e}get isMine(){return this.sender===Ce.myCursor.peerId}get senderColor(){let e=Ce.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=Ce.findByPeerId(this.sender);return i instanceof Ce&&(e=i.color),e}get cutInImgageUrl(){return this._cutInImgageUrl}get videoStart(){return parseInt(this.cutIn.videoStart)}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.videoId?12:this.cutIn.duration)))))}_play(){if(this.isEnd)return;const e=Jt.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?Rc.AUDITION:Rc.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):U.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){U.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;if(1==i){if(this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume),this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn.duration>0){clearTimeout(this._timeoutId);const r=this.cutIn.duration-this.videoPlayer.getCurrentTime()+(this.cutIn.videoStart?parseInt(this.cutIn.videoStart):0);r<=0?this.stop():this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*(this.cutIn.duration>r?r:this.cutIn.duration))}this.cutIn&&U.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})}2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},At,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0,checkBox:"check"},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0,checkBox:"check"},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0,checkBox:"check"}],this.cutIn.name)}static#t=this.\u0275fac=function(i){return new(i||t)(F(hr),F(Xo),F(Sn))};static#n=this.\u0275cmp=xn({type:t,selectors:[["cut-in"]],viewQuery:function(i,r){if(1&i&&(Dn(gX,5),Dn(mX,5)),2&i){let o;On(o=An())&&(r.cutInImageElement=o.first),On(o=An())&&(r.videoPlayer=o.first)}},hostBindings:function(i,r){1&i&&X("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["image",""],["cutInContainerElement",""],["videoPlayerComponent",""],["cutInImageElement",""],["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["appDraggable","",1,"container",2,"position","absolute",3,"dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove","draggable.allowOverHalf","draggable.unhandle","ngClass"],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"contextmenu","ngStyle"],[1,"handler","bottom",3,"contextmenu","ngStyle"],[1,"handler","left",3,"contextmenu","ngStyle"],[1,"handler","right",3,"contextmenu","ngStyle"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"ready","stateChange","videoId","width","height","playerVars"],["draggable","false",2,"pointer-events","auto",3,"error","src"],["draggable","false",2,"pointer-events","none",3,"load","contextmenu","src"]],template:function(i,r){1&i&&L(0,vX,3,25,"div",4)(1,CX,3,25,"div",4)(2,wX,3,25,"div",4)(3,TX,3,25,"div",4)(4,SX,3,25,"div",4)(5,HX,16,40,"ng-template",null,0,Pi),2&i&&(_("ngIf",r.isVisible&&-1==r.animationType),h(),_("ngIf",r.isVisible&&0==r.animationType),h(),_("ngIf",r.isVisible&&1==r.animationType),h(),_("ngIf",r.isVisible&&2==r.animationType),h(),_("ngIf",r.isVisible&&3==r.animationType))},dependencies:[Fi,ni,ip,Zo,hX,TS,fr],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0;top:0}.left-bottom[_ngcontent-%COMP%]{left:0;bottom:0}.right-top[_ngcontent-%COMP%]{right:0;top:0}.right-bottom[_ngcontent-%COMP%]{right:0;bottom:0}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0;left:0}.handler.bottom[_ngcontent-%COMP%]{bottom:0;right:0}.handler.left[_ngcontent-%COMP%]{top:0;left:0}.handler.right[_ngcontent-%COMP%]{right:0;bottom:0}"],data:{animation:[Vn("cutInNone",[Xt("void => *",[jt("10ms ease-in",mn([Pe({opacity:0,offset:0}),Pe({opacity:1,offset:1})]))]),Xt("* => void",[jt("10ms ease-in",mn([Pe({opacity:0,offset:1})]))])]),Vn("cutInFadeInOut",[Xt("void => *",[jt("330ms ease-in",mn([Pe({opacity:0,offset:0}),Pe({opacity:1,offset:1})]))]),Xt("* => void",[jt("330ms ease-in",mn([Pe({opacity:1,offset:0}),Pe({opacity:0,offset:1})]))])]),Vn("cutInBounceInOut",[Xt("void => *",[jt("600ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale3d(0, 0, 0)"}))])]),Vn("cutInOpenInOut",[Xt("void => *",[jt("262ms ease",mn([Pe({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),Pe({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),Pe({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),Vn("cutInOpenInOut2",[Xt("void => *",[jt("262ms ease",mn([Pe({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),Pe({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),Pe({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}})}return t})(),GC=(()=>{class t{static#e=this.cutInComponentRefQueue=[];constructor(){}static nowShowingIdentifiers(){return t.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,o=null){if(!e)return;for(const a of t.cutInComponentRefQueue)if(a&&a.instance){const l=a.instance;if(l.isEnd)a.destroy();else{const u=l.cutIn;(e.identifier===u.identifier||e.videoId&&u.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=u.tag&&""!=u.tag.trim()&&_e.toHalfWidth(e.tag).toUpperCase().trim()==_e.toHalfWidth(u.tag).toUpperCase().trim())&&l.stop()}}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(a=>a&&a.instance);const s=t.defaultParentViewContainerRef.createComponent(p5);s.instance.cutIn=e,s.instance.animationType=e.animationType,s.instance.videoId=e.videoId,s.instance.playListId=e.playListId,s.instance.isSecret=i,s.instance.isTest=r,s.instance.sender=o,s.instance.play(),t.cutInComponentRefQueue.push(s)}stop(e){if(e){e instanceof Br&&(e=e.identifier);for(const i of t.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(i=>i&&i.instance)}}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Br=class extends Ir{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=_n.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let n="";if(!_e.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){if(this.videoUrl.indexOf("/shorts/")>=0){let i=this.videoUrl.split("/shorts/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else if(this.videoUrl.indexOf("v=")>=0){let i=this.videoUrl.split("v=");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const n=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return n&&n[1]?this._sec(n[1]):null}_sec(n){if(!n)return null;let e=null;if(e=/^(\d+)$/.exec(n))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(n)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let n="";if(!_e.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(n=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!Jt.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(n=>null!=n?n.trimRight():""))).filter(n=>""!=n)}get isPlayingNow(){return GC.nowShowingIdentifiers().includes(this.identifier)}};var tc;Oe([Xe()],Br.prototype,"name",void 0),Oe([Xe()],Br.prototype,"tag",void 0),Oe([Xe()],Br.prototype,"duration",void 0),Oe([Xe()],Br.prototype,"width",void 0),Oe([Xe()],Br.prototype,"height",void 0),Oe([Xe()],Br.prototype,"posX",void 0),Oe([Xe()],Br.prototype,"posY",void 0),Oe([Xe()],Br.prototype,"zIndex",void 0),Oe([Xe()],Br.prototype,"objectFitType",void 0),Oe([Xe()],Br.prototype,"animationType",void 0),Oe([Xe()],Br.prototype,"borderStyle",void 0),Oe([Xe()],Br.prototype,"isFrontOfStand",void 0),Oe([Xe()],Br.prototype,"isPreventOutBounds",void 0),Oe([Xe()],Br.prototype,"imageIdentifier",void 0),Oe([Xe()],Br.prototype,"isVideoCutIn",void 0),Oe([Xe()],Br.prototype,"videoUrl",void 0),Oe([Xe()],Br.prototype,"audioFileName",void 0),Oe([Xe()],Br.prototype,"audioIdentifier",void 0),Oe([Xe()],Br.prototype,"isLoop",void 0),Br=Oe([ir("cut-in")],Br);let Lc=class extends Ir{static#e=tc=this;static get instance(){return tc._instance||(tc._instance=new tc("CutInList"),tc._instance.initialize()),tc._instance}get cutIns(){return this.children}addCutIn(...n){let e=null;if(n[0]instanceof Br)e=n[0];else{let i=n[0];e=new Br(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of tc.instance.children)i.destroy();let e=tc.instance.toContext();e.syncData=this.toContext().syncData,tc.instance.apply(e),tc.instance.update(),super.parseInnerXml.apply(tc.instance,[n]),this.destroy()}matchCutInInfo(n){let e="",i=new Map;const r=[];for(const a of this.cutIns.map(l=>[Math.random(),l]).sort((l,u)=>l[0]-u[0]).map(l=>l[1])){if(!a)continue;let l=!1;for(const u of a.postfixes)_e.toHalfWidth(n.replaceAll("\uff1e","\u2192")).toUpperCase().trimRight().endsWith(_e.toHalfWidth(u.replaceAll("\uff1e","\u2192")).toUpperCase().trimRight())&&(l=!0,("@"==u.slice(0,1)||"\uff20"==u.slice(0,1))&&e.length<u.length&&(e=u));if(l){const u=a.tag;null!=u&&u.trim().length>0?i.set(_e.toHalfWidth(u).toUpperCase().trim(),a):r.push(a)}}r.push(...i.values());const s=r.map(a=>[Math.random(),a]).sort((a,l)=>a[0]-l[0]);return{names:s.map(a=>a[1].name),identifiers:s.map(a=>a[1].identifier),matchMostLongText:e}}};var fi;Lc=tc=Oe([ir("cut-in-list")],Lc);let WC,zX=function VX(){const t=["English","\u6b63\u9ad4\u4e2d\u6587","\u7b80\u4f53\u4e2d\u6587","\ud55c\uad6d\uc5b4","Other"];let n=new l5("DiceBotQueue");return n.add((0,R.A)(function*(){WC=new((yield me.e(4402).then(me.bind(me,8914))).default),rr.diceBotInfos=WC.listAvailableGameSystems().filter(r=>"DiceBot"!=r.id).sort((r,o)=>{const s=r.sortKey,a=o.sortKey;return s<a?-1:s>a?1:0}).map(r=>{const o=/.+\:(.+)/.exec(r.id);let s;return o&&o[1]&&(s="ChineseTraditional"==o[1]?"\u6b63\u9ad4\u4e2d\u6587":"English"==o[1]?"English":"Korean"==o[1]?"\ud55c\uad6d\uc5b4":"SimplifiedChinese"==o[1]?"\u7b80\u4f53\u4e2d\u6587":"Other"),{id:r.id,game:r.name,lang:s,sort_key:r.sortKey}}),rr.diceBotInfos.forEach(r=>{let o=r.sort_key.normalize("NFKD");for(let s of rr.replaceData)s[2]&&r.game===s[0]&&(o=s[1],r.game=s[2]),o=o.split(s[0].normalize("NFKD")).join(s[1].normalize("NFKD"));o=o.replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),r.sort_key=r.lang?r.lang:o.normalize("NFKD")}),rr.diceBotInfos.sort((r,o)=>r.lang&&o.lang?t.indexOf(r.lang)==t.indexOf(o.lang)?0:t.indexOf(r.lang)<t.indexOf(o.lang)?-1:1:r.lang?1:o.lang?-1:r.sort_key==o.sort_key?0:r.sort_key<o.sort_key?-1:1);let e=rr.diceBotInfos[0].sort_key[0],i={index:e,infos:[]};for(let r of rr.diceBotInfos)(r.lang?r.lang:r.sort_key[0])!==e&&(e=r.lang?r.lang:r.sort_key[0],rr.diceBotInfosIndexed.push(i),i={index:e,infos:[]}),i.infos.push({id:r.id,game:r.game});rr.diceBotInfosIndexed.push(i)})),n}(),rr=class extends Lh{static#e=fi=this;static#t=this.apiUrl=null;static#n=this.apiVersion=2;static#i=this.adminUrl=null;static#r=this.diceBotInfos=[];static#o=this.diceBotInfosIndexed=[];static#s=this.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","\ub354\ube14\ud06c\ub85c\uc2a4 The 2nd Edition/The 3rd Edtion","\ub354\ube14\ud06c\ub85c\uc2a4 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0","\u30ec\u30b3\u30fc\u30c9\u30fb\u30aa\u30d6\u30fb\u30b9\u30c1\u30fc\u30e0"],["\u7802\u5875\u6226\u6a5f\u30a2\u30fc\u30ac\u30b92ndEdition","\u30b5\u30b7\u30f3\u30bb\u30f3\u30ad\u30a2\u30a2\u30ab\u30b92","\u7802\u5875\u6226\u6a5f\u30a2\u30fc\u30ac\u30b9 2nd Edition"],["FINAL FANTSY XIV TTRPG(English)","\u30d5\u30a2\u30a4\u30ca\u30eb\u30d5\u30a1\u30f3\u30bf\u30b7\u30a414TTRPG","FINAL FANTSY XIV TTRPG (English)"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (\u30d6\u30e9\u30c3\u30af\u30fb\u30d6\u30e9\u30c3\u30af\u30fb\u30cd\u30c3\u30c8\u30ef\u30fc\u30afTRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","\u30ac\u30fc\u30d7\u30b9\uff08GURPS\uff09"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","\u30ac\u30fc\u30d7\u30b9\uff08GURPS\uff09 \u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["RuneQuest\uff1aRoleplaying in Glorantha","\u30eb\u30a6\u30f3\u30af\u30a8\u30b9\u30c84","RuneQuest: Roleplaying in Glorantha"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]];constructor(n,e=null){super(n),this.chatMessageService=e}static rollCommandAsync(n,e="DiceBot",i=!1){var r=this;return(0,R.A)(function*(){const o=n.replace("\u200b",""),s=/^(([s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[s\uff33\uff53][x\uff38\uff58]|[x\uff38\uff58])?([\d\uff10-\uff19]+)?[ \u3000]+)?([^\n]*)?/gi.exec(o),a=_e.toHalfWidth(s[2]),l=a&&0===_e.toHalfWidth(a).toUpperCase().indexOf("S"),u=null!=s[3]?Number(_e.toHalfWidth(s[3])):1;let f=null!=s[4]?s[4]:o,g={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1};if(!f||u<=0)return g;let v=!1;for(const C of Nc.instance.diceRollTables){if(null==C.command)continue;let E=!1,w=0,T="",M=!1;const S=_e.toHalfWidth(C.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim().toUpperCase(),P=_e.toHalfWidth(f.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim().toUpperCase();if(!P.startsWith("S"+S)||P[("S"+S).length]&&!/[ \=\+\-]/.test(P.charAt(("S"+S).length))?P.startsWith(S)&&(!P[S.length]||/[ \=\+\-]/.test(P.charAt(S.length)))&&(v=!0,P[S.length]&&" "!=P[S.length]&&(T=P.substring(S.length))):(v=!0,E=!0,P[("S"+S).length]&&" "!=P[("S"+S).length]&&(T=P.substring(("S"+S).length))),T)if(T=T.split(" ")[0],/^[\+\-]\d+$/.test(T))w=+T,T=` (\u4fee\u6b63${T})`;else{if(!/^\=\-?\d+$/.test(T)){v=!1;continue}M=!0}if(v){g.isFailure=!1,g.isDiceRollTable=!0,g.tableName=C.name&&C.name.length>0?C.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",g.isSecret=E||l;const Z=C.parseText();for(let ee=0;ee<u&&ee<32;ee++){let B=null,J=yield fi.diceRollAsync(M?`C(${T.substring(1)})`:_e.toHalfWidth(C.dice).trim().replace(/[\u216e\xd0]/g,"D").replace(/\xd7/g,"*").replace(/\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);g.isEmptyDice=g.isEmptyDice&&J.isEmptyDice;let le=null;J.result.length>0&&(le=J.result.match(/\s\uff1e\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(B=+le[1]),J.result&&i&&(J.result=r.formatRollResult(J.result));let se=!1;if(null!=B)for(const fe of Z)if((null===fe.range.start||fe.range.start<=B+w)&&(null===fe.range.end||B+w<=fe.range.end)){i?g.result+=M?"\u6307\u5b9a="+B+"\n"+_e.cr(fe.result):J.result+T+(T?` \u2192 ${B+w}`:"")+"\n"+_e.cr(fe.result):g.result=(M?"\u6307\u5b9a=":"")+B+(M?"":T)+" \uff1e "+fe.result,se=!0;break}se||(null==B?(g.isFailure=!0,g.result+="\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)"):g.result+=M?"\u6307\u5b9a="+B+"\n(\u7d50\u679c\u306a\u3057)":J.result+T+(T?` \u2192 ${B+w}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<u&&(g.result+=` #${ee+1}`),ee<u-1&&(g.result+="\n")}break}}if(!v){let E,C=!1;if(E=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*)([ \u3000]+|[\\\uffe5][s\uff53])([^\n]*)/gi.exec(f.trim())){if(f=_e.toHalfWidth(E[1]+_e.cr(E[2])),null!=E[2]){const w=null!=E[3]?E[3]:"";/^\d+\-\d+|[a-z]\-[a-z]$/i.test(_e.toHalfWidth(w.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim())?f+=_e.toHalfWidth(w.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim():f+=(""===_e.toHalfWidth(w).trim()?w:_e.cr(w)).trim().replace(/[\u3000\s]+/g," ")}C=!0}if(!C&&((E=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\[\uff3b])([^\]\uff3d]+)([\]\uff3d])/gi.exec(f.trim()))||(E=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\(\uff08])([^\)\uff09]+)([\)\uff09])/gi.exec(f.trim())))){const w=null!=E[2]?E[2]:"";f=/^\d+\-\d+|[a-z]\-[a-z]$/i.test(_e.toHalfWidth(w.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim())?_e.toHalfWidth(E[1])+_e.toHalfWidth(w.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim()+_e.toHalfWidth(E[3]):_e.toHalfWidth(E[1])+w.replace(/\uff0c/g,",")+_e.toHalfWidth(E[3]),C=!0}if(C||(f=_e.toHalfWidth(f).trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\xd7/g,"*").replace(/\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),fi.apiUrl){if(!C&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(f))return;g=yield fi.diceRollAsync(f,e,u),g.isSecret=g.isSecret||l}else{if(!(yield fi.loadGameSystemAsync(e)).COMMAND_PATTERN.test(f))return;for(let T=0;T<u&&T<32;T++){let M=yield fi.diceRollAsync(f,e,u);if(M.result.length<1)break;g.id=M.id,g.result+=M.result,g.isSecret=g.isSecret||M.isSecret||l,g.isEmptyDice=g.isEmptyDice&&M.isEmptyDice,g.isSuccess=g.isSuccess||M.isSuccess,g.isFailure=g.isFailure&&M.isFailure,g.isCritical=g.isCritical||M.isCritical,g.isFumble=g.isFumble||M.isFumble,1<u&&(g.result+=` #${T+1}\n`)}}}return g.result&&(g.result=g.result.trimRight()),g})()}onStoreAdded(){var n=this;super.onStoreAdded(),U.register(this).on("SEND_MESSAGE",function(){var e=(0,R.A)(function*(i){const r=dt.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;let o=r.tag.replace("noface","").trim();o=o||"DiceBot";try{const s=yield fi.rollCommandAsync(r.text,o,!0);if(!s||!s.result)return;n.sendResultMessage(s,r)}catch(s){console.error(s)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),U.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result;const o=n.isSecret;if(r.length<1)return;let g="system";o&&(g+=" secret"),n.isEmptyDice&&(g+=" empty"),n.isSuccess&&(g+=" success"),n.isFailure&&(g+=" failure"),n.isCritical&&(g+=" critical"),n.isFumble&&(g+=" fumble");let v={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:n.isDiceRollTable?"Dice-Roll Table":fi.apiUrl?`BCDice-API(${fi.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:g,name:`${n.isDiceRollTable?n.tableName:i} : ${e.name}${o?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},C="";const E=dt.instance.get(e.characterIdentifier);if(E instanceof cn){const M=E.standList.matchStandInfo(r,e.imageIdentifier);if(!o&&!e.standName&&e.isUseStandImage)if(M.farewell){const S={characterIdentifier:E.identifier};if(e.to){const P=Ce.findByUserId(e.to);P&&(P.peerId!=Ce.myCursor.peerId&&U.call("FAREWELL_STAND_IMAGE",S,P.peerId),U.call("FAREWELL_STAND_IMAGE",S,Ce.myCursor.peerId))}else U.call("FAREWELL_STAND_IMAGE",S)}else if(M&&M.standElementIdentifier){const S=dt.instance.get(M.standElementIdentifier);if(S&&S.getFirstElementByName("conditionType")){const P=+S.getFirstElementByName("conditionType").value;if(P==To.Postfix||P==To.PostfixOrImage||P==To.PostfixAndImage){const Z={characterIdentifier:E.identifier,standIdentifier:M.standElementIdentifier,color:e.color,secret:!!e.to};if(Z.secret){const ee=Ce.findByUserId(e.to);ee&&(ee.peerId!=Ce.myCursor.peerId&&U.call("POPUP_STAND_IMAGE",Z,ee.peerId),U.call("POPUP_STAND_IMAGE",Z,Ce.myCursor.peerId))}else U.call("POPUP_STAND_IMAGE",Z)}}}C=M.matchMostLongText}const w=dt.instance.get(e.tabIdentifier),T=Lc.instance.matchCutInInfo(r);if(!o&&w.isUseStandImage&&T){for(const M of T.identifiers){const S={identifier:M,secret:!!e.to,sender:Ce.myCursor.peerId};if(S.secret){const P=Ce.findByUserId(e.to);P&&(P.peerId!=Ce.myCursor.peerId&&U.call("PLAY_CUT_IN",S,P.peerId),U.call("PLAY_CUT_IN",S,Ce.myCursor.peerId))}else U.call("PLAY_CUT_IN",S)}if(T.names&&T.names.length&&!e.to&&this.chatMessageService){const M=new Map;for(const P of T.names){let Z=M.get(P)||0;Z+=1,M.set(""==P?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":P,Z)}const S=`${[...M.keys()].map(P=>M.get(P)>1?`${P}\xd7${M.get(P)}`:P).join("\u3001")}`;this.chatMessageService.sendOperationLog(S+" \u304c\u8d77\u52d5\u3057\u305f")}}C.length<T.matchMostLongText.length&&(C=T.matchMostLongText),C&&v.text&&(v.text=v.text.slice(0,v.text.length-C.length)),n.isDiceRollTable||(v.text=fi.formatRollResult(v.text,i)),null!=e.to&&0<e.to.length&&(v.to=e.to,e.to.indexOf(e.from)<0&&(v.to+=" "+e.from)),w&&w.addMessage(v)}static diceRollAsync(n,e,i=1){return(0,R.A)(function*(){if(e=e||"DiceBot",fi.apiUrl){const r=1==fi.apiVersion?fi.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(n):`${fi.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(n)}`,o=[];for(let s=1;s<=i;s++)o.push(fetch(r,{mode:"cors"}).then(a=>{if(a.ok)return a.json();throw new Error(a.statusText)}).then(a=>({id:e,result:(1==fi.apiVersion?a.result:a.text)+(i>1?` #${s}\n`:""),isSecret:a.secret,isEmptyDice:1==fi.apiVersion?a.dices&&0==a.dices.length:a.rands&&0==a.rands.length,isSuccess:a.success,isFailure:a.failure,isCritical:a.critical,isFumble:a.fumble})).catch(a=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(o).then(s=>s.reduce((a,l)=>({id:e,result:a.result+l.result,isSecret:a.isSecret||l.isSecret,isEmptyDice:a.isEmptyDice&&l.isEmptyDice,isSuccess:a.isSuccess||l.isSuccess,isFailure:a.isFailure&&l.isFailure,isCritical:a.isCritical||l.isCritical,isFumble:a.isFumble||l.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield fi.loadGameSystemAsync(e);const o=r.eval(n);return o?(console.log("diceRoll!!!",o),console.log("isSecret!!!",o.secret),console.log("isEmptyDice!!!",!o.rands||0==o.rands.length),{id:r.ID,result:o.text,isSecret:o.secret,isEmptyDice:!o.rands||0==o.rands.length,isSuccess:o.success,isFailure:o.failure,isCritical:o.critical,isFumble:o.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(n){return(0,R.A)(function*(){if(n=n||"DiceBot",fi.apiUrl){const e=[fetch(1==fi.apiVersion?fi.apiUrl+"/v1/systeminfo?system=DiceBot":`${fi.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return n&&"DiceBot"!=n&&e.push(fetch(1==fi.apiVersion?fi.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(n):`${fi.apiUrl}/v2/game_system/${encodeURIComponent(n)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==fi.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield fi.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],n&&""!=n&&"DiceBot"!=n){let i=yield fi.loadGameSystemAsync(n);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(n){var e=this;return(0,R.A)(function*(){return yield zX.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return WC.getGameSystemClass(i)}catch{return WC.dynamicLoad(i)}})})()}static formatRollResult(n,e="DiceBot"){if(null==n)return"";let i=0,r=0;return n.split("\n").map(o=>{let s=[],a=[],l=[],u=[];return"Cthulhu7th"===e&&/^\d+(:?\u56de\u76ee|\u6b21|\ubc88\uc9f8): \uff1e/.test(o)&&(i+=1,o="\u{1f3b2}"+o),o.split(/\s\uff1e\s/).map((f,g,v)=>{let C=null;if("Cthulhu7th"===e&&(C=/(?:\u30dc\u30fc\u30ca\u30b9\u30fb\u30da\u30ca\u30eb\u30c6\u30a3\u30c0\u30a4\u30b9|\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024|\ubcf4\ub108\uc2a4, \ud328\ub110\ud2f0 \uc8fc\uc0ac\uc704)\[(?<bonusDice>\-?\d+)\]/.exec(f))&&C&&C.groups&&(r=+C.groups.bonusDice),1===v.length)return f;if(0==g){if("Cthulhu"===e&&/\d\) (?:\u6545\u969c\u30ca\u30f3\u30d0\u30fc|\u6545\u969c\u7387|\uace0\uc7a5\ub118\ubc84)\[\-?\d+\]/.test(f)||"Cthulhu7th"===e&&/\d\) (?:\u30dc\u30fc\u30ca\u30b9\u30fb\u30da\u30ca\u30eb\u30c6\u30a3\u30c0\u30a4\u30b9|\u734e\u52f5\u3001\u61f2\u7f70\u9ab0\u5024|\ubcf4\ub108\uc2a4, \ud328\ub110\ud2f0 \uc8fc\uc0ac\uc704)\[\-?\d+\]/.test(f))return"\u{1f3b2}"+f.replace(/\((1D100<=\d+)\) /i,"$1 ");const w=fi.apiUrl&&1==fi.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,T=f.match(fi.apiUrl&&1==fi.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@#\$\?]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@#\$\?]+)\)$/i)||f.match(w);return T&&!T[1].toUpperCase().startsWith("CHOICE")&&(s=[...f.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],s.length||(a=[...f.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],a.length||(l=[...f.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],l.length||(u=[...f.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),T?"\u{1f3b2}"+T[1]:f}if(g==v.length-1)return f;if(1==g&&(s.length||a.length||l.length||u.length))try{let E=f;const T=[...f.matchAll(s.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:u.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(T.length){let S,M=0;T.forEach((P,Z)=>{if(S=P[0],s.length){const{diceCount:B,keepDrop:J,keepDropCount:le}=s[Z].groups,{total:se,diceArrayString:fe}=P.groups;if(J){const Se=null!=fe?fe.split(",").sort((Ze,nt)=>+Ze-+nt):[],ue=J.startsWith("K")?le:B-le;("KH"===J||"DL"===J)&&Se.reverse();const Ue=Se.map((Ze,nt)=>nt+1<=ue?`${Ze}`:`~~~${Ze}~~~`);("DH"===J||"DL"===J)&&Ue.reverse(),S=`${se}[${Ue.join(",")}]`}}else if(a.length){const{sign:B,criteria:J}=a[0].groups,{diceArrayString:le}=P.groups;S=le.split(",").map(se=>fi.isPass(se,B,J)?`${se}`:`~~~${se}~~~`).join(",")}else if(l.length){let{rerollSign:B,rerollCriteria:J,sign:le,criteria:se}=l[0].groups;B||(B=le),J||(J=se);const{diceArrayString:fe}=P.groups;S=fe.split(",").map(Se=>fi.isPass(Se,B,J)?`###${Se}###`:Se).map(Se=>fi.isPass(Se,le,se,!1)?Se:`~~~${Se}~~~`).join(",")}else if(u.length){const{rerollCriteria:B,modifier:J,sign:le,criteria:se}=u[0].groups,{total:fe,diceArrayString:Se,modifier2:ue,dieString:Ue}=P.groups;if(console.log(u[0],P),ue)S=` (${ue})`;else if(fe)S=fe+"["+Se.split(",").map(Ze=>fi.isPass(Ze,">=",B)?`###${Ze}###`:Ze).join(",")+"]",fi.isPass(+fe+(J?+J:0),le,se)||(S=`~~~${S}~~~`);else{let Ze=S;S=fi.isPass(Ue,">=",B)?`###${Ue}###`:Ue,fi.isPass(+Ze+(J?+J:0),le,se)||(S=`~~~${S}~~~`)}}const ee=E.indexOf(P[0],M);S!=P[0]&&(E=E.substring(0,ee)+S+E.substring(ee+P[0].length)),M=ee+S.length})}f=E}catch(E){console.error(E)}else if("BladeOfArcana"!=e||1!=g&&2!=g)if("Cthulhu7th"!=e||1!=g&&2!=g){if("DoubleCross"==e&&1==g)f=f.split("+").map(E=>{const w=E.match(/(?<result>\d{1,2})\[(?<diceArrayString>\d{1,2}(?:,\d{1,2})*)\]/);if(w){const T=v[0].match(/\(\d+DX(?<critical>\d+)/i);if(T){const{result:M,diceArrayString:S}=w.groups,{critical:P}=T.groups;let Z=!1;const ee=S.split(",").map((B,J,le)=>parseInt(B)>=parseInt(P)?(Z=!0,`###${B}###`):J===le.length-1?`${B}`:`~~~${B}~~~`).join(",");return`${Z?`###${M}###`:M}[${ee}]`}}return E}).join("+");else if("DungeonsAndDragons5"==e&&1==g&&(v[0].startsWith("(AT")||v[0].startsWith("(AR"))){const E=v[0].startsWith("(AT"),w=v[0].endsWith("A)"),T=v[0].endsWith("D)");if(w||T){const M=f.match(/\[(?<diceArrayString>\d+(?:,\d+)*)?\](?<modifier>[\-+]\d+)?/i);if(!M)return f;const{diceArrayString:S,modifier:P}=M.groups,Z=S.split(",").map(J=>parseInt(J)),ee=w?Math.max(...Z):Math.min(...Z);let B=!1;f="["+Z.map(J=>{let le=!E||20!==J&&1!==J?J.toString():`###${J}###`;return B||J!==ee?le=`~~~${le}~~~`:B=!0,le}).join(",")+"]"+(P||"")}else if(E){const M=f.match(/(?<diceString>\d+)?(?<modifier>[\-+]\d+)?/i);if(M){const{diceString:S,modifier:P}=M.groups;S&&(20===parseInt(S)||1===parseInt(S))&&(f=`###${S}###${P||""}`)}}}}else console.log(f),f=f.replace(/(?:\d+, )*\d+/,E=>{const w=r-(i>0?i-1:0)>=0;let T=w?101:-1;const M=E.split(",").map(P=>{let Z=+P.trim();return w&&T>Z&&(T=Z),!w&&T<Z&&(T=Z),Z});let S=!0;return M.map(P=>{let Z=1==P?`###${P}###`:P.toString();return M.length>1&&(S&&P==T?S=!1:Z=`~~~${Z}~~~`),Z}).join(", ")});else{const E=v[0].match(/^\(\d+A(?<deficult>\d+)C(?<critical>\d+)F(?<fumble>\d+)\)$/i);if(E){const{deficult:w,critical:T,fumble:M}=E.groups;f=f.split(",").map(S=>{let P=parseInt(S.trim());return 1===P?`###${P}###`:P>=parseInt(M)?`~~~###${P}###~~~`:P<=parseInt(T)?`###${P}###`:P>parseInt(w)?`~~~${P}~~~`:S}).join(",")}}return f}).join(" \uff1e ").replace(/(\s|^)\uff1e\s/g,"$1\u2192 ").replace(/\((\d+)(D)(\d+)\uff1e(\d)/gi,"(\u{1f3b2}$1$2$3\u2192$4")}).join("\n")}static isPass(n,e,i,r=!0){if(null==n)return r;let o=n.toString().match(/(\d+)/);o&&(n=o[1]);let s=r;switch(e){case"==":case"=":s=+n==+i;break;case"!=":case"<>":s=+n!=+i;break;case">=":s=+n>=+i;break;case"<=":s=+n<=+i;break;case"<":s=+n<+i;break;case">":s=+n>+i}return s}};function g5(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function fp(t,n){for(var e=t.length-1;e>=0;e--)!0===n(t[e])&&t.splice(e,1)}function IS(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}rr=fi=Oe([ir("dice-bot")],rr);var e,SS=function(){function t(n){void 0===n&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,e){return this.getAttrs()[n]=e,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);s=o.shift();)-1===g5(r,s)&&r.push(s);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var s,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],o=n.split(i);r.length&&(s=o.shift());){var a=g5(r,s);-1!==a&&r.splice(a,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return-1!==(" "+this.getClass()+" ").indexOf(" "+n+" ")},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),e=this.buildAttrsStr();return["<",n,e=e?" "+e:"",">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),e=[];for(var i in n)n.hasOwnProperty(i)&&e.push(i+'="'+n[i]+'"');return e.join(" ")},t}(),m5=function(){function t(n){void 0===n&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new SS({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var e={href:n.getAnchorHref()},i=this.createCssClass(n);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(e.title=n.getAnchorHref()),e},t.prototype.createCssClass=function(n){var e=this.className;if(e){for(var i=[e],r=n.getCssClassSuffixes(),o=0,s=r.length;o<s;o++)i.push(e+"-"+r[o]);return i.join(" ")}return""},t.prototype.processAnchorText=function(n){return this.doTruncate(n)},t.prototype.doTruncate=function(n){var e=this.truncate;if(!e||!e.length)return n;var i=e.length,r=e.location;return"smart"===r?function YX(t,n,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var s=function(S){var P="";return S.scheme&&S.host&&(P+=S.scheme+"://"),S.host&&(P+=S.host),S.path&&(P+="/"+S.path),S.query&&(P+="?"+S.query),S.fragment&&(P+="#"+S.fragment),P},a=function(S,P){var Z=P/2,ee=Math.ceil(Z),B=-1*Math.floor(Z),J="";return B<0&&(J=S.substr(B)),S.substr(0,ee)+e+J};if(t.length<=n)return t;var P,Z,ee,l=n-r,u=(P={},(ee=(Z=t).match(/^([a-z]+):\/\//i))&&(P.scheme=ee[1],Z=Z.substr(ee[0].length)),(ee=Z.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(P.host=ee[1],Z=Z.substr(ee[0].length)),(ee=Z.match(/^\/(.*?)(?=(\?|#|$))/i))&&(P.path=ee[1],Z=Z.substr(ee[0].length)),(ee=Z.match(/^\?(.*?)(?=(#|$))/i))&&(P.query=ee[1],Z=Z.substr(ee[0].length)),(ee=Z.match(/^#(.*?)$/i))&&(P.fragment=ee[1]),P);if(u.query){var f=u.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);f&&(u.query=u.query.substr(0,f[1].length),t=s(u))}if(t.length<=n||(u.host&&(u.host=u.host.replace(/^www\./,""),t=s(u)),t.length<=n))return t;var g="";if(u.host&&(g+=u.host),g.length>=l)return u.host.length==n?(u.host.substr(0,n-r)+e).substr(0,l+i):a(g,l).substr(0,l+i);var v="";if(u.path&&(v+="/"+u.path),u.query&&(v+="?"+u.query),v){if((g+v).length>=l)return(g+v).length==n?(g+v).substr(0,n):(g+a(v,l-g.length)).substr(0,l+i);g+=v}if(u.fragment){var E="#"+u.fragment;if((g+E).length>=l)return(g+E).length==n?(g+E).substr(0,n):(g+a(E,l-g.length)).substr(0,l+i);g+=E}if(u.scheme&&u.host){var T=u.scheme+"://";if((g+T).length<l)return(T+g).substr(0,n)}if(g.length<=n)return g;var M="";return l>0&&(M=g.substr(-1*Math.floor(l/2))),(g.substr(0,Math.ceil(l/2))+e+M).substr(0,l+i)}(n,i):"middle"===r?function qX(t,n,e){if(t.length<=n)return t;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var o=n-r,s="";return o>0&&(s=t.substr(-1*Math.floor(o/2))),(t.substr(0,Math.ceil(o/2))+e+s).substr(0,o+i)}(n,i):function ZX(t,n,e){return function WX(t,n,e){var i;return t.length>n&&(null==e?(e="&hellip;",i=3):i=e.length,t=t.substring(0,n-i)+e),t}(t,n,e)}(n,i)},t}(),Em=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}(),_5=function(t){function n(e){var i=t.call(this,e)||this;return i.email="",i.email=e.email,i}return kc(n,t),n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(Em),b5=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return kc(n,t),n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(Em),v5=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return kc(n,t),n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var e=t.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},n}(Em),y5=function(t){function n(e){var i=t.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return kc(n,t),n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(Em),C5=function(t){function n(e){var i=t.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return kc(n,t),n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},n.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},n.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},n.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch{return i}},n}(Em),Tm=function(){return function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder}}(),MS=/[A-Za-z]/,XX=/[\d]/,KX=/[\D]/,pp=/\s/,DS=/['"]/,QX=/[\x00-\x1F\x7F]/,x5=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,w5=x5+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,$C=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,tK=w5+$C,Wr=w5+$C,Rb=new RegExp("[".concat(Wr,"]")),nK="(?:["+$C+"]{1,3}\\.){3}["+$C+"]{1,3}",iK="["+Wr+"](?:["+Wr+"\\-_]{0,61}["+Wr+"])?",E5=function(t){return"(?=("+iK+"))\\"+t},OS=function(t){return"(?:"+E5(t)+"(?:\\."+E5(t+1)+"){0,126}|"+nK+")"},YC=(new RegExp("["+Wr+".\\-]*["+Wr+"\\-]"),Rb),T5=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|music|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kids|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|read|reit|rent|rest|rich|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,rK=new RegExp("[".concat(Wr,"!#$%&'*+/=?^_`{|}~-]")),oK=new RegExp("^".concat(T5.source,"$")),I5=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.localPartCharRegex=rK,e.strictTldRegex=oK,e}return kc(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,o=this.strictTldRegex,s=[],a=e.length,l=new qC,u={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},f=0,g=0,v=l;f<a;){var C=e.charAt(f);switch(g){case 0:"m"===(se=C)?B(1):r.test(se)&&B();break;case 1:w(e.charAt(f-1),C);break;case 2:T(C);break;case 3:M(C);break;case 4:S(C);break;case 5:P(C);break;case 6:Z(C);break;case 7:ee(C);break;default:IS(g)}f++}var se;return le(),s;function w(se,fe){":"===se?r.test(fe)?(g=2,v=new qC(ro(ro({},v),{hasMailtoPrefix:!0}))):J():u[se]===fe||(r.test(fe)?g=2:"."===fe?g=3:"@"===fe?g=4:J())}function T(se){"."===se?g=3:"@"===se?g=4:r.test(se)||J()}function M(se){"."===se||"@"===se?J():r.test(se)?g=2:J()}function S(se){YC.test(se)?g=5:J()}function P(se){"."===se?g=7:"-"===se?g=6:YC.test(se)||le()}function Z(se){"-"===se||"."===se?le():YC.test(se)?g=5:le()}function ee(se){"."===se||"-"===se?le():YC.test(se)?(g=5,v=new qC(ro(ro({},v),{hasDomainDot:!0}))):le()}function B(se){void 0===se&&(se=2),g=se,v=new qC({idx:f})}function J(){g=0,v=l}function le(){if(v.hasDomainDot){var se=e.slice(v.idx,f);/[-.]$/.test(se)&&(se=se.slice(0,-1));var fe=v.hasMailtoPrefix?se.slice(7):se;(function Se(ue){var Ze=(ue.split(".").pop()||"").toLowerCase();return o.test(Ze)})(fe)&&s.push(new _5({tagBuilder:i,matchedText:se,offset:v.idx,email:fe}))}J()}},n}(Tm),qC=function(){return function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot}}(),sK=function(){function t(){}return t.isValid=function(n,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(n,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,e)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==n.match(e)},t.containsMultipleDots=function(n){var e=n;return this.hasFullProtocolRegex.test(n)&&(e=n.split("://")[1]),e.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var e=n.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},t.urlMatchDoesNotHaveProtocolOrDot=function(n,e){return!(!n||e&&this.hasFullProtocolRegex.test(e)||-1!==n.indexOf("."))},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,e){return!(!n||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(n))},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+x5+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}(),aK=(e=new RegExp("[/?#](?:["+Wr+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+Wr+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,OS(2),")","|","(","(//)?",/(?:www\.)/.source,OS(6),")","|","(","(//)?",OS(10)+"\\.",T5.source,"(?![-"+tK+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),lK=new RegExp("["+Wr+"]"),S5=function(t){function n(e){var i=t.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=aK,i.wordCharRegExp=lK,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return kc(n,t),n.prototype.parseMatches=function(e){for(var u,i=this.matcherRegex,r=this.stripPrefix,o=this.stripTrailingSlash,s=this.decodePercentEncoding,a=this.tagBuilder,l=[],f=function(){var v=u[0],C=u[1],E=u[4],M=u.index,S=u[5]||u[9],P=e.charAt(M-1);if(!sK.isValid(v,C)||M>0&&"@"===P||M>0&&S&&g.wordCharRegExp.test(P))return"continue";if(/\?$/.test(v)&&(v=v.substr(0,v.length-1)),g.matchHasUnbalancedClosingParen(v))v=v.substr(0,v.length-1);else{var Z=g.matchHasInvalidCharAfterTld(v,C);Z>-1&&(v=v.substr(0,Z))}var ee=["http://","https://"].find(function(se){return!!C&&-1!==C.indexOf(se)});if(ee){var B=v.indexOf(ee);v=v.substr(B),C=C.substr(B),M+=B}l.push(new C5({tagBuilder:a,matchedText:v,offset:M,urlMatchType:C?"scheme":E?"www":"tld",url:v,protocolUrlMatch:!!C,protocolRelativeMatch:!!S,stripPrefix:r,stripTrailingSlash:o,decodePercentEncoding:s}))},g=this;null!==(u=i.exec(e));)f();return l},n.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var o=0,s=0,a=e.length-1;s<a;s++){var l=e.charAt(s);l===r?o++:l===i&&(o=Math.max(o-1,0))}return 0===o},n.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var s=new RegExp("^((.?//)?[-."+Wr+"]*[-"+Wr+"]\\.[-"+Wr+"]+)").exec(e);return null===s?-1:(r+=s[1].length,e=e.slice(s[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},n}(Tm),M5=new RegExp("[_".concat(Wr,"]")),D5=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.serviceName=e.serviceName,i}return kc(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.serviceName,o=[],s=e.length,a=0,l=-1,u=0;a<s;){var f=e.charAt(a);switch(u){case 0:"#"===(T=f)?(u=2,l=a):Rb.test(T)&&(u=1);break;case 1:v(f);break;case 2:C(f);break;case 3:E(f);break;default:IS(u)}a++}var T;return w(),o;function v(T){Rb.test(T)||(u=0)}function C(T){u=M5.test(T)?3:Rb.test(T)?1:0}function E(T){M5.test(T)||(w(),l=-1,u=Rb.test(T)?1:0)}function w(){if(l>-1&&a-l<=140){var T=e.slice(l,a),M=new b5({tagBuilder:i,matchedText:T,offset:l,serviceName:r,hashtag:T.slice(1)});o.push(M)}}},n}(Tm),cK=["twitter","facebook","instagram","tiktok"],hK=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),O5=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.matcherRegex=hK,e}return kc(n,t),n.prototype.parseMatches=function(e){for(var s,i=this.matcherRegex,r=this.tagBuilder,o=[];null!==(s=i.exec(e));){var a=s[0],l=a.replace(/[^0-9,;#]/g,""),u=!(!s[1]&&!s[2]),f=0==s.index?"":e.substr(s.index-1,1),g=e.substr(s.index+a.length,1),v=!f.match(/\d/)&&!g.match(/\d/);this.testMatch(s[3])&&this.testMatch(a)&&v&&o.push(new y5({tagBuilder:r,matchedText:a,offset:s.index,number:l,plusSign:u}))}return o},n.prototype.testMatch=function(e){return KX.test(e)},n}(Tm),fK=new RegExp("@[_".concat(Wr,"]{1,50}(?![_").concat(Wr,"])"),"g"),pK=new RegExp("@[_.".concat(Wr,"]{1,30}(?![_").concat(Wr,"])"),"g"),gK=new RegExp("@[-_.".concat(Wr,"]{1,50}(?![-_").concat(Wr,"])"),"g"),mK=new RegExp("@[_.".concat(Wr,"]{1,23}[_").concat(Wr,"](?![_").concat(Wr,"])"),"g"),_K=new RegExp("[^"+Wr+"]"),A5=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:fK,instagram:pK,soundcloud:gK,tiktok:mK},i.nonWordCharRegex=_K,i.serviceName=e.serviceName,i}return kc(n,t),n.prototype.parseMatches=function(e){var l,i=this.serviceName,r=this.matcherRegexes[this.serviceName],o=this.nonWordCharRegex,s=this.tagBuilder,a=[];if(!r)return a;for(;null!==(l=r.exec(e));){var u=l.index,f=e.charAt(u-1);if(0===u||o.test(f)){var g=l[0].replace(/\.+$/g,""),v=g.slice(1);a.push(new v5({tagBuilder:s,matchedText:g,offset:u,serviceName:i,mention:v}))}}return a},n}(Tm);var vu=function(){return function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing}}(),vK=function(){function t(n){void 0===n&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email="boolean"==typeof n.email?n.email:this.email,this.phone="boolean"==typeof n.phone?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow="boolean"==typeof n.newWindow?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash="boolean"==typeof n.stripTrailingSlash?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof n.decodePercentEncoding?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===cK.indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,e){return new t(e).link(n)},t.parse=function(n,e){return new t(e).parse(n)},t.prototype.normalizeUrlsCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:"boolean"!=typeof n.schemeMatches||n.schemeMatches,wwwMatches:"boolean"!=typeof n.wwwMatches||n.wwwMatches,tldMatches:"boolean"!=typeof n.tldMatches||n.tldMatches}},t.prototype.normalizeStripPrefixCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{scheme:n,www:n}:{scheme:"boolean"!=typeof n.scheme||n.scheme,www:"boolean"!=typeof n.www||n.www}},t.prototype.normalizeTruncateCfg=function(n){return"number"==typeof n?{length:n,location:"end"}:function GX(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0===t[e]&&(t[e]=n[e]);return t}(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var e=this,i=["a","style","script"],r=0,o=[];return function bK(t,n){for(var e=n.onOpenTag,i=n.onCloseTag,r=n.onText,o=n.onComment,s=n.onDoctype,a=new vu,l=0,u=t.length,f=0,g=0,v=a;l<u;){var C=t.charAt(l);switch(f){case 0:"<"===C&&lt();break;case 1:"!"===(Qe=C)?f=13:"/"===Qe?(f=2,v=new vu(ro(ro({},v),{isClosing:!0}))):"<"===Qe?lt():MS.test(Qe)?(f=3,v=new vu(ro(ro({},v),{isOpening:!0}))):(f=0,v=a);break;case 2:M(C);break;case 3:T(C);break;case 4:S(C);break;case 5:P(C);break;case 6:Z(C);break;case 7:ee(C);break;case 8:B(C);break;case 9:J(C);break;case 10:le(C);break;case 11:se(C);break;case 12:fe(C);break;case 13:"--"===t.substr(l,2)?(l+=2,v=new vu(ro(ro({},v),{type:"comment"})),f=14):"DOCTYPE"===t.substr(l,7).toUpperCase()?(l+=7,v=new vu(ro(ro({},v),{type:"doctype"})),f=20):tt();break;case 14:ue(C);break;case 15:Ue(C);break;case 16:Ze(C);break;case 17:nt(C);break;case 18:be(C);break;case 19:Ye(C);break;case 20:Ke(C);break;default:IS(f)}l++}var Qe;function T(Qe){pp.test(Qe)?(v=new vu(ro(ro({},v),{name:Ft()})),f=4):"<"===Qe?lt():"/"===Qe?(v=new vu(ro(ro({},v),{name:Ft()})),f=12):">"===Qe?(v=new vu(ro(ro({},v),{name:Ft()})),sn()):!MS.test(Qe)&&!XX.test(Qe)&&":"!==Qe&&tt()}function M(Qe){">"===Qe?tt():MS.test(Qe)?f=3:tt()}function S(Qe){pp.test(Qe)||("/"===Qe?f=12:">"===Qe?sn():"<"===Qe?lt():"="===Qe||DS.test(Qe)||QX.test(Qe)?tt():f=5)}function P(Qe){pp.test(Qe)?f=6:"/"===Qe?f=12:"="===Qe?f=7:">"===Qe?sn():"<"===Qe?lt():DS.test(Qe)&&tt()}function Z(Qe){pp.test(Qe)||("/"===Qe?f=12:"="===Qe?f=7:">"===Qe?sn():"<"===Qe?lt():DS.test(Qe)?tt():f=5)}function ee(Qe){pp.test(Qe)||('"'===Qe?f=8:"'"===Qe?f=9:/[>=`]/.test(Qe)?tt():"<"===Qe?lt():f=10)}function B(Qe){'"'===Qe&&(f=11)}function J(Qe){"'"===Qe&&(f=11)}function le(Qe){pp.test(Qe)?f=4:">"===Qe?sn():"<"===Qe&&lt()}function se(Qe){pp.test(Qe)?f=4:"/"===Qe?f=12:">"===Qe?sn():"<"===Qe?lt():(f=4,function an(){l--}())}function fe(Qe){">"===Qe?(v=new vu(ro(ro({},v),{isClosing:!0})),sn()):f=4}function ue(Qe){"-"===Qe?f=15:">"===Qe?tt():f=16}function Ue(Qe){"-"===Qe?f=18:">"===Qe?tt():f=16}function Ze(Qe){"-"===Qe&&(f=17)}function nt(Qe){f="-"===Qe?18:16}function be(Qe){">"===Qe?sn():"!"===Qe?f=19:"-"===Qe||(f=16)}function Ye(Qe){"-"===Qe?f=17:">"===Qe?sn():f=16}function Ke(Qe){">"===Qe?sn():"<"===Qe&&lt()}function tt(){f=0,v=a}function lt(){f=1,v=new vu({idx:l})}function sn(){var Qe=t.slice(g,v.idx);Qe&&r(Qe,g),"comment"===v.type?o(v.idx):"doctype"===v.type?s(v.idx):(v.isOpening&&e(v.name,v.idx),v.isClosing&&i(v.name,v.idx)),tt(),g=l+1}function Ft(){return t.slice(v.idx+(v.isClosing?2:1),l).toLowerCase()}g<l&&function Ct(){var Qe=t.slice(g,l);r(Qe,g),g=l+1}()}(n,{onOpenTag:function(s){i.indexOf(s)>=0&&r++},onText:function(s,a){if(0===r){var u=function $X(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=n.exec(t);)e.push(t.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(t.substring(i)),e}(s,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),f=a;u.forEach(function(g,v){if(v%2==0){var C=e.parseText(g,f);o.push.apply(o,C)}f+=g.length})}},onCloseTag:function(s){i.indexOf(s)>=0&&(r=Math.max(r-1,0))},onComment:function(s){},onDoctype:function(s){}}),o=this.compactMatches(o),o=this.removeUnwantedMatches(o)},t.prototype.compactMatches=function(n){n.sort(function(l,u){return l.getOffset()-u.getOffset()});for(var e=0;e<n.length-1;){var i=n[e],r=i.getOffset(),o=i.getMatchedText().length,s=r+o;if(e+1<n.length){if(n[e+1].getOffset()===r){var a=n[e+1].getMatchedText().length>o?e:e+1;n.splice(a,1);continue}if(n[e+1].getOffset()<s){n.splice(e+1,1);continue}}e++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||fp(n,function(e){return"hashtag"===e.getType()}),this.email||fp(n,function(e){return"email"===e.getType()}),this.phone||fp(n,function(e){return"phone"===e.getType()}),this.mention||fp(n,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||fp(n,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||fp(n,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||fp(n,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),n},t.prototype.parseText=function(n,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],o=0,s=i.length;o<s;o++){for(var a=i[o].parseMatches(n),l=0,u=a.length;l<u;l++)a[l].setOffset(e+a[l].getOffset());r.push.apply(r,a)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(n),i=[],r=0,o=0,s=e.length;o<s;o++){var a=e[o];i.push(n.substring(r,a.getOffset())),i.push(this.createMatchReturnVal(a)),r=a.getOffset()+a.getMatchedText().length}return i.push(n.substring(r)),i.join("")},t.prototype.createMatchReturnVal=function(n){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,n)),"string"==typeof e?e:!1===e?n.getMatchedText():e instanceof SS?e.toAnchorString():n.buildTag().toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),e=[new D5({tagBuilder:n,serviceName:this.hashtag}),new I5({tagBuilder:n}),new O5({tagBuilder:n}),new A5({tagBuilder:n,serviceName:this.mention}),new S5({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new m5({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version="3.16.2",t.AnchorTagBuilder=m5,t.HtmlTag=SS,t.matcher={Email:I5,Hashtag:D5,Matcher:Tm,Mention:A5,Phone:O5,Url:S5},t.match={Email:_5,Hashtag:b5,Match:Em,Mention:v5,Phone:y5,Url:C5},t}();const k5=vK,P5=k5;let bi=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}static#e=this.UIPanelComponentClass=null;get isShow(){return!!this.panelComponentRef}open(e,i,r){r||(r=t.defaultParentViewContainerRef);let s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector}),a=s.instance.content.createComponent(e);const l=s.injector.get(t);l.panelComponentRef=s,i&&(i.title&&(l.title=i.title),i.top&&(l.top=i.top),i.left&&(l.left=i.left),i.width&&(l.width=i.width),i.height&&(l.height=i.height)),s.onDestroy(()=>{l.panelComponentRef=null,s=null}),a.onDestroy(()=>{a=null});let u=s.instance,f=a.instance;return(null!=u?.ngOnChanges||null!=f?.ngOnChanges)&&queueMicrotask(()=>{a&&null!=f?.ngOnChanges&&f?.ngOnChanges({}),s&&null!=u?.ngOnChanges&&u?.ngOnChanges({})}),a.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();class yK{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let Ii=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}static#e=this.ModalComponentClass=null;get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){return r||(r=t.defaultParentViewContainerRef),new Promise((o,s)=>{const u=new t;u.modalContext=new yK(T=>{v&&(v.destroy(),o(T),this.count--)},T=>{v&&(v.destroy(),s(T),this.count--)},i);const g=Ts.create({providers:[{provide:t,useValue:u}],parent:r.injector});let v=r.createComponent(t.ModalComponentClass,{index:r.length,injector:g}),C=v.instance.content.createComponent(e);v.onDestroy(()=>{v=null,this.count--}),C.onDestroy(()=>{C=null,this.count--}),this.count++;let E=v.instance,w=C.instance;(null!=E?.ngOnChanges||null!=w?.ngOnChanges)&&queueMicrotask(()=>{C&&w?.ngOnChanges({}),v&&E?.ngOnChanges({})})})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const CK=t=>({outer:t});function xK(t,n){if(1&t&&(p(0,"div",5)(1,"small")(2,"small"),x(3),m()(),p(4,"span",6),x(5),m(),p(6,"small"),x(7),p(8,"span",7),x(9),m()()()),2&t){const e=y();h(3),Mi("",e.urlObj.protocol,"//"),h(),_("ngClass",Be(6,CK,e.isOuter)),h(),Re(e.urlObj.host),h(2),Re(e.urlObj.pathname),h(2),Ih("",e.urlObj.search,"",e.urlObj.hash,"")}}function wK(t,n){if(1&t&&(p(0,"div",5),x(1),m()),2&t){const e=y();h(),Re(e.url)}}function EK(t,n){1&t&&(p(0,"div"),x(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),m())}function TK(t,n){1&t&&(p(0,"div"),x(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),m())}let xa=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return _e.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),U.register(this)}ngOnDestroy(){U.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noreferrer"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"click","disabled"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(i,r){1&i&&(p(0,"div"),L(1,xK,10,8,"div",0)(2,wK,2,1,"div",0),Ne(3,"hr"),p(4,"div",1),L(5,EK,2,0,"div",2)(6,TK,2,0,"div",2),m()(),p(7,"button",3),X("click",function(){return r.openUrl()}),x(8,"\u958b\u304f"),m(),p(9,"button",4),X("click",function(){return r.cancel()}),x(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),m()),2&i&&(h(),_("ngIf",r.isValid),h(),_("ngIf",!r.isValid),h(3),_("ngIf",r.isValid),h(),_("ngIf",!r.isValid),h(),_("disabled",!r.isValid))},dependencies:[Fi,ni],styles:[".url[_ngcontent-%COMP%]{word-break:break-all;font-size:larger}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray;font-size:smaller}.help[_ngcontent-%COMP%]{font-size:smaller}"]})}return t})();const IK=["message"];function SK(t,n){if(1&t&&(p(0,"span")(1,"pre",2),x(2),m()()),2&t){const e=y();h(2),Re(e.text)}}function MK(t,n){1&t&&Ne(0,"hr")}function DK(t,n){if(1&t){const e=Ie();p(0,"pre",2)(1,"span",4,0),It(3,"safe"),X("click",function(r){return O(e),D(y(2).onLinkClick(r))}),m(),L(4,MK,1,0,"hr",1),m()}if(2&t){const e=n.$implicit,i=n.last,r=y(2);h(),_("innerHTML",St(3,2,r.textShadwing(r.htmlEscapeLinking(e)),"html"),eo),h(3),_("ngIf",!i)}}function OK(t,n){if(1&t&&(p(0,"span"),L(1,DK,5,5,"pre",3),m()),2&t){const e=y();h(),_("ngForOf",e.text)}}let gp=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.shadowing="",this.stringUtil=_e}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return P5.link(_e.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&_e.validUrl(r.getAnchorHref())){if(_e.sameOrigin(r.getAnchorHref()))return!0;{const o=r.buildTag();return o.setAttr("rel","noreferrer"),o.addClass("outer-link"),o}}return!1}})}textShadwing(e){if(null==e)return"";if(null==this.shadowing||""===this.shadowing)return e;const i=new RegExp(`[${this.shadowing}]`,"g");return e.replace(i,'<span style="text-shadow: #111 0 0 1px">$&</span>')}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!_e.sameOrigin(i))return e.preventDefault(),this.modalService.open(xa,{url:e.target.getAttribute("href")}),!1}return!0}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["text-view"]],viewQuery:function(i,r){if(1&i&&Dn(IK,5),2&i){let o;On(o=An())&&(r.messageElm=o.first)}},inputs:{text:"text",title:"title",shadowing:"shadowing"},decls:2,vars:2,consts:[["message",""],[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"click","innerHTML"]],template:function(i,r){1&i&&L(0,SK,3,1,"span",1)(1,OK,2,1,"span",1),2&i&&(_("ngIf",!r.isObj(r.text)),h(),_("ngIf",r.isObj(r.text)))},dependencies:[nr,ni,fr],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]})}return t})();var mp;let pe=(()=>{class t{static#e=this.dicePick="";static#t=this.dicePut="";static#n=this.diceRoll1="";static#i=this.diceRoll2="";static#r=this.cardDraw="";static#o=this.cardPick="";static#s=this.cardPut="";static#a=this.cardShuffle="";static#l=this.piecePick="";static#c=this.piecePut="";static#u=this.blockPick="";static#d=this.blockPut="";static#h=this.lock="";static#f=this.unlock="";static#p=this.sweep="";static#g=this.puyon="";static#m=this.surprise="";static#_=this.coinToss="";static#b=this.selectionStart=""}return t})(),ze=mp=class extends Lh{onStoreAdded(){super.onStoreAdded(),U.register(this).on("SOUND_EFFECT",n=>{He.playSoundEffect(Jt.instance.get(n.data))}).on("SEND_MESSAGE",n=>{let e=dt.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?mp.play(pe.diceRoll1):mp.play(pe.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),U.unregister(this)}play(n){mp.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,mp._play(e)}static _play(n){U.call("SOUND_EFFECT",n)}static playLocal(n){let e="";e="string"==typeof n?n:n.identifier,mp._playLocal(e)}static _playLocal(n){U.trigger("SOUND_EFFECT",n)}};var Lb;ze=mp=Oe([ir("sound-effect")],ze);let li=Lb=class extends Ir{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=_e.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(n,e=!0){if("string"==typeof n&&(n=n.trim().split(/\s+/)),0==n.length)return!1;if(n=n.concat(),e){for(const i of n)if(` ${this.tag} `.indexOf(` ${_e.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of n)if(` ${this.tag} `.indexOf(` ${_e.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>_e.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),U.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>_e.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(_e.toHalfWidth(i).toLowerCase())).sort().join(" "),U.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(n){return dt.instance.get(`imagetag_${n}`)}static create(n){const e=new Lb(`imagetag_${n}`);return e.imageIdentifier=n,e.initialize(),e}parseInnerXml(n){let e=Lb.get(this.imageIdentifier);e||(e=Lb.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var _p;Oe([Xe()],li.prototype,"imageIdentifier",void 0),Oe([Xe()],li.prototype,"tag",void 0),Oe([Xe()],li.prototype,"hide",void 0),li=Lb=Oe([ir("image-tag")],li);let Xs=_p=class extends Ir{constructor(){super(...arguments),this.identifiers=[]}static searchImages(n,e,i,r){"string"==typeof n&&(n=n.trim().split(/\s+/));const o=_p.allImagesOwnWords(r);return n=n.filter(a=>o.includes(a)),this.allImages(r).filter(a=>{const l=li.get(a.identifier);return e&&(i||0===n.length)&&(!l||null==l.tag||""===l.tag.trim())||(!e||i)&&l&&l.containsWords(n,i)})}static allImages(n){return Yt.instance.images.filter(i=>{if(n)return!0;const r=li.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(n){return _p.imagesOwnWords(this.allImages(n))}static imagesOwnWords(n,e=!1){if(e){if(0===n.length)return[];const i=n.map(o=>li.get(o.identifier));if(!i[0])return[];let r=i[0].words;for(let o=1;o<i.length;o++){if(!i[o])return[];if(r=r.filter(s=>i[o].words.includes(s)),0===r.length)return r}return r.sort()}{const i=[];for(const r of n){const o=li.get(r.identifier);o&&i.push(...o.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(n,e){let i=0;if(null!=n&&""===n.trim())return i;for(const r of _p.allImages(e)){const o=li.get(r.identifier);null==n?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(n.trim(),!1)&&i++}return i}static imagesIsHidden(n){for(const e of n){const i=li.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(n,e){const i=n.map(r=>{const o=li.get(r.identifier);return{image:r,tag:o&&null!=o.tag?o.tag:""}});return i.sort((r,o)=>{let s=0;return e.some(a=>(s=_p._sortByWordCriteria(r,o,a),!!s)),s}),i.map(r=>r.image)}static _sortByWordCriteria(n,e,i){if(null==i)return""==n.tag&&""==e.tag?0:""==n.tag?-1:""==e.tag?1:0;const r=` ${n.tag} `.indexOf(` ${i} `),o=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==o?0:r>=0&&-1==o?-1:-1==r&&o>=0?1:0}onStoreAdded(){super.onStoreAdded(),dt.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(n=>li.get(n)).filter(n=>n).map(n=>n.toXml()).join("")}static create(n){const e=new _p;return e.identifiers=n.map(i=>i.identifier),e}};Xs=_p=Oe([ir("image-tag-list")],Xs);const Bb=15,F5=573;function JC(t){return ex(t.map(([n,e])=>new Array(n).fill(e,0,n)))}function ex(t){return t.reduce((n,e)=>n.concat(Array.isArray(e)?ex(e):e),[])}const H5=[0,1,2,3].concat(...JC([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function Ur(){const t=this;function e(r,o){let s=0;do{s|=1&r,r>>>=1,s<<=1}while(--o>0);return s>>>1}t.build_tree=function(r){const o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.elems;let l,u,g,f=-1;for(r.heap_len=0,r.heap_max=F5,l=0;l<a;l++)0!==o[2*l]?(r.heap[++r.heap_len]=f=l,r.depth[l]=0):o[2*l+1]=0;for(;r.heap_len<2;)g=r.heap[++r.heap_len]=f<2?++f:0,o[2*g]=1,r.depth[g]=0,r.opt_len--,s&&(r.static_len-=s[2*g+1]);for(t.max_code=f,l=Math.floor(r.heap_len/2);l>=1;l--)r.pqdownheap(o,l);g=a;do{l=r.heap[1],r.heap[1]=r.heap[r.heap_len--],r.pqdownheap(o,1),u=r.heap[1],r.heap[--r.heap_max]=l,r.heap[--r.heap_max]=u,o[2*g]=o[2*l]+o[2*u],r.depth[g]=Math.max(r.depth[l],r.depth[u])+1,o[2*l+1]=o[2*u+1]=g,r.heap[1]=g++,r.pqdownheap(o,1)}while(r.heap_len>=2);r.heap[--r.heap_max]=r.heap[1],function n(r){const o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,u=t.stat_desc.max_length;let f,g,v,C,E,w,T=0;for(C=0;C<=Bb;C++)r.bl_count[C]=0;for(o[2*r.heap[r.heap_max]+1]=0,f=r.heap_max+1;f<F5;f++)g=r.heap[f],C=o[2*o[2*g+1]+1]+1,C>u&&(C=u,T++),o[2*g+1]=C,!(g>t.max_code)&&(r.bl_count[C]++,E=0,g>=l&&(E=a[g-l]),w=o[2*g],r.opt_len+=w*(C+E),s&&(r.static_len+=w*(s[2*g+1]+E)));if(0!==T){do{for(C=u-1;0===r.bl_count[C];)C--;r.bl_count[C]--,r.bl_count[C+1]+=2,r.bl_count[u]--,T-=2}while(T>0);for(C=u;0!==C;C--)for(g=r.bl_count[C];0!==g;)v=r.heap[--f],!(v>t.max_code)&&(o[2*v+1]!=C&&(r.opt_len+=(C-o[2*v+1])*o[2*v],o[2*v+1]=C),g--)}}(r),function i(r,o,s){const a=[];let u,f,g,l=0;for(u=1;u<=Bb;u++)a[u]=l=l+s[u-1]<<1;for(f=0;f<=o;f++)g=r[2*f+1],0!==g&&(r[2*f]=e(a[g]++,g))}(o,t.max_code,r.bl_count)}}function Os(t,n,e,i,r){const o=this;o.static_tree=t,o.extra_bits=n,o.extra_base=e,o.elems=i,o.max_length=r}Ur._length_code=[0,1,2,3,4,5,6,7].concat(...JC([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),Ur.base_length=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],Ur.base_dist=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],Ur.d_code=function(t){return t<256?H5[t]:H5[256+(t>>>7)]},Ur.extra_lbits=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],Ur.extra_dbits=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Ur.extra_blbits=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ur.bl_order=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const BK=JC([[144,8],[112,9],[24,7],[8,8]]);Os.static_ltree=ex([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map((t,n)=>[t,BK[n]]));const HK=JC([[30,5]]);function yu(t,n,e,i,r){const o=this;o.good_length=t,o.max_lazy=n,o.nice_length=e,o.max_chain=i,o.func=r}Os.static_dtree=ex([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map((t,n)=>[t,HK[n]])),Os.static_l_desc=new Os(Os.static_ltree,Ur.extra_lbits,257,286,Bb),Os.static_d_desc=new Os(Os.static_dtree,Ur.extra_dbits,0,30,Bb),Os.static_bl_desc=new Os(null,Ur.extra_blbits,0,19,7);const Hc=[new yu(0,0,0,0,0),new yu(4,4,8,4,1),new yu(4,5,16,8,1),new yu(4,6,32,32,1),new yu(4,4,16,16,2),new yu(8,16,32,32,2),new yu(8,16,128,128,2),new yu(8,32,128,256,2),new yu(32,128,258,1024,2),new yu(32,258,258,4096,2)],nx=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Ml=262;function V5(t,n,e,i){const r=t[2*n],o=t[2*e];return r<o||r==o&&i[n]<=i[e]}function $K(){const t=this;let n,e,i,r,o,s,a,l,u,f,g,v,C,E,w,T,M,S,P,Z,ee,B,J,le,se,fe,Se,ue,Ue,Ze,nt,be,Ye;const Ke=new Ur,tt=new Ur,lt=new Ur;let sn,Ct,Ft,an,Qe,Yn;function en(){let pt;for(pt=0;pt<286;pt++)nt[2*pt]=0;for(pt=0;pt<30;pt++)be[2*pt]=0;for(pt=0;pt<19;pt++)Ye[2*pt]=0;nt[512]=1,t.opt_len=t.static_len=0,Ct=Ft=0}function Vo(pt,Dt){let Pt,yt=-1,on=pt[1],Ln=0,Ni=7,Ma=4;0===on&&(Ni=138,Ma=3),pt[2*(Dt+1)+1]=65535;for(let Vc=0;Vc<=Dt;Vc++)Pt=on,on=pt[2*(Vc+1)+1],!(++Ln<Ni&&Pt==on)&&(Ln<Ma?Ye[2*Pt]+=Ln:0!==Pt?(Pt!=yt&&Ye[2*Pt]++,Ye[32]++):Ln<=10?Ye[34]++:Ye[36]++,Ln=0,yt=Pt,0===on?(Ni=138,Ma=3):Pt==on?(Ni=6,Ma=3):(Ni=7,Ma=4))}function ms(pt){t.pending_buf[t.pending++]=pt}function _s(pt){ms(255&pt),ms(pt>>>8&255)}function Or(pt,Dt){let yt;const Pt=Dt;Yn>16-Pt?(yt=pt,Qe|=yt<<Yn&65535,_s(Qe),Qe=yt>>>16-Yn,Yn+=Pt-16):(Qe|=pt<<Yn&65535,Yn+=Pt)}function ts(pt,Dt){const yt=2*pt;Or(65535&Dt[yt],65535&Dt[yt+1])}function Pl(pt,Dt){let yt,on,Pt=-1,Ln=pt[1],Ni=0,Ma=7,Vc=4;for(0===Ln&&(Ma=138,Vc=3),yt=0;yt<=Dt;yt++)if(on=Ln,Ln=pt[2*(yt+1)+1],!(++Ni<Ma&&on==Ln)){if(Ni<Vc)do{ts(on,Ye)}while(0!=--Ni);else 0!==on?(on!=Pt&&(ts(on,Ye),Ni--),ts(16,Ye),Or(Ni-3,2)):Ni<=10?(ts(17,Ye),Or(Ni-3,3)):(ts(18,Ye),Or(Ni-11,7));Ni=0,Pt=on,0===Ln?(Ma=138,Vc=3):on==Ln?(Ma=6,Vc=3):(Ma=7,Vc=4)}}function Fl(){16==Yn?(_s(Qe),Qe=0,Yn=0):Yn>=8&&(ms(255&Qe),Qe>>>=8,Yn-=8)}function Nl(pt,Dt){let yt,Pt,on;if(t.dist_buf[Ct]=pt,t.lc_buf[Ct]=255&Dt,Ct++,0===pt?nt[2*Dt]++:(Ft++,pt--,nt[2*(Ur._length_code[Dt]+256+1)]++,be[2*Ur.d_code(pt)]++),!(8191&Ct)&&Se>2){for(yt=8*Ct,Pt=ee-M,on=0;on<30;on++)yt+=be[2*on]*(5+Ur.extra_dbits[on]);if(yt>>>=3,Ft<Math.floor(Ct/2)&&yt<Math.floor(Pt/2))return!0}return Ct==sn-1}function nf(pt,Dt){let yt,Pt,Ln,Ni,on=0;if(0!==Ct)do{yt=t.dist_buf[on],Pt=t.lc_buf[on],on++,0===yt?ts(Pt,pt):(Ln=Ur._length_code[Pt],ts(Ln+256+1,pt),Ni=Ur.extra_lbits[Ln],0!==Ni&&(Pt-=Ur.base_length[Ln],Or(Pt,Ni)),yt--,Ln=Ur.d_code(yt),ts(Ln,Dt),Ni=Ur.extra_dbits[Ln],0!==Ni&&(yt-=Ur.base_dist[Ln],Or(yt,Ni)))}while(on<Ct);ts(256,pt),an=pt[513]}function nw(){Yn>8?_s(Qe):Yn>0&&ms(255&Qe),Qe=0,Yn=0}function iw(pt,Dt,yt){Or(0+(yt?1:0),3),function H3(pt,Dt,yt){nw(),an=8,yt&&(_s(Dt),_s(~Dt)),t.pending_buf.set(l.subarray(pt,pt+Dt),t.pending),t.pending+=Dt}(pt,Dt,!0)}function ta(pt){(function z3(pt,Dt,yt){let Pt,on,Ln=0;Se>0?(Ke.build_tree(t),tt.build_tree(t),Ln=function ea(){let pt;for(Vo(nt,Ke.max_code),Vo(be,tt.max_code),lt.build_tree(t),pt=18;pt>=3&&0===Ye[2*Ur.bl_order[pt]+1];pt--);return t.opt_len+=3*(pt+1)+5+5+4,pt}(),Pt=t.opt_len+3+7>>>3,on=t.static_len+3+7>>>3,on<=Pt&&(Pt=on)):Pt=on=Dt+5,Dt+4<=Pt&&-1!=pt?iw(pt,Dt,yt):on==Pt?(Or(2+(yt?1:0),3),nf(Os.static_ltree,Os.static_dtree)):(Or(4+(yt?1:0),3),function Sa(pt,Dt,yt){let Pt;for(Or(pt-257,5),Or(Dt-1,5),Or(yt-4,4),Pt=0;Pt<yt;Pt++)Or(Ye[2*Ur.bl_order[Pt]+1],3);Pl(nt,pt-1),Pl(be,Dt-1)}(Ke.max_code+1,tt.max_code+1,Ln+1),nf(nt,be)),en(),yt&&nw()})(M>=0?M:-1,ee-M,pt),M=ee,n.flush_pending()}function V3(){let pt,Dt,yt,Pt;do{if(Pt=u-J-ee,0===Pt&&0===ee&&0===J)Pt=o;else if(-1==Pt)Pt--;else if(ee>=o+o-Ml){l.set(l.subarray(o,o+o),0),B-=o,ee-=o,M-=o,pt=C,yt=pt;do{Dt=65535&g[--yt],g[yt]=Dt>=o?Dt-o:0}while(0!=--pt);pt=o,yt=pt;do{Dt=65535&f[--yt],f[yt]=Dt>=o?Dt-o:0}while(0!=--pt);Pt+=o}if(0===n.avail_in)return;pt=n.read_buf(l,ee+J,Pt),J+=pt,J>=3&&(v=255&l[ee],v=(v<<T^255&l[ee+1])&w)}while(J<Ml&&0!==n.avail_in)}function IB(pt){let Pt,on,Dt=se,yt=ee,Ln=le;const Ni=ee>o-Ml?ee-(o-Ml):0;let Ma=Ze;const Vc=a,j3=ee+258;let SB=l[yt+Ln-1],MB=l[yt+Ln];le>=Ue&&(Dt>>=2),Ma>J&&(Ma=J);do{if(Pt=pt,l[Pt+Ln]==MB&&l[Pt+Ln-1]==SB&&l[Pt]==l[yt]&&l[++Pt]==l[yt+1]){yt+=2,Pt++;do{}while(l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&l[++yt]==l[++Pt]&&yt<j3);if(on=258-(j3-yt),yt=j3-258,on>Ln){if(B=pt,Ln=on,on>=Ma)break;SB=l[yt+Ln-1],MB=l[yt+Ln]}}}while((pt=65535&f[pt&Vc])>Ni&&0!=--Dt);return Ln<=J?Ln:J}t.depth=[],t.bl_count=[],t.heap=[],nt=[],be=[],Ye=[],t.pqdownheap=function(pt,Dt){const yt=t.heap,Pt=yt[Dt];let on=Dt<<1;for(;on<=t.heap_len&&(on<t.heap_len&&V5(pt,yt[on+1],yt[on],t.depth)&&on++,!V5(pt,Pt,yt[on],t.depth));)yt[Dt]=yt[on],Dt=on,on<<=1;yt[Dt]=Pt},t.deflateInit=function(pt,Dt,yt,Pt,on,Ln){return Pt||(Pt=8),on||(on=8),Ln||(Ln=0),pt.msg=null,-1==Dt&&(Dt=6),on<1||on>9||8!=Pt||yt<9||yt>15||Dt<0||Dt>9||Ln<0||Ln>2?-2:(pt.dstate=t,s=yt,o=1<<s,a=o-1,E=on+7,C=1<<E,w=C-1,T=Math.floor((E+3-1)/3),l=new Uint8Array(2*o),f=[],g=[],sn=1<<on+6,t.pending_buf=new Uint8Array(4*sn),i=4*sn,t.dist_buf=new Uint16Array(sn),t.lc_buf=new Uint8Array(sn),Se=Dt,ue=Ln,function f0e(pt){return pt.total_in=pt.total_out=0,pt.msg=null,t.pending=0,t.pending_out=0,e=113,r=0,function pr(){Ke.dyn_tree=nt,Ke.stat_desc=Os.static_l_desc,tt.dyn_tree=be,tt.stat_desc=Os.static_d_desc,lt.dyn_tree=Ye,lt.stat_desc=Os.static_bl_desc,Qe=0,Yn=0,an=8,en()}(),function yn(){u=2*o,g[C-1]=0;for(let pt=0;pt<C-1;pt++)g[pt]=0;fe=Hc[Se].max_lazy,Ue=Hc[Se].good_length,Ze=Hc[Se].nice_length,se=Hc[Se].max_chain,ee=0,M=0,J=0,S=le=2,Z=0,v=0}(),0}(pt))},t.deflateEnd=function(){return 42!=e&&113!=e&&666!=e?-2:(t.lc_buf=null,t.dist_buf=null,t.pending_buf=null,g=null,f=null,l=null,t.dstate=null,113==e?-3:0)},t.deflateParams=function(pt,Dt,yt){let Pt=0;return-1==Dt&&(Dt=6),Dt<0||Dt>9||yt<0||yt>2?-2:(Hc[Se].func!=Hc[Dt].func&&0!==pt.total_in&&(Pt=pt.deflate(1)),Se!=Dt&&(Se=Dt,fe=Hc[Se].max_lazy,Ue=Hc[Se].good_length,Ze=Hc[Se].nice_length,se=Hc[Se].max_chain),ue=yt,Pt)},t.deflateSetDictionary=function(pt,Dt,yt){let on,Pt=yt,Ln=0;if(!Dt||42!=e)return-2;if(Pt<3)return 0;for(Pt>o-Ml&&(Pt=o-Ml,Ln=yt-Pt),l.set(Dt.subarray(Ln,Ln+Pt),0),ee=Pt,M=Pt,v=255&l[0],v=(v<<T^255&l[1])&w,on=0;on<=Pt-3;on++)v=(v<<T^255&l[on+2])&w,f[on&a]=g[v],g[v]=on;return 0},t.deflate=function(pt,Dt){let yt,Pt,on,Ln,Ni;if(Dt>4||Dt<0)return-2;if(!pt.next_out||!pt.next_in&&0!==pt.avail_in||666==e&&4!=Dt)return pt.msg=nx[4],-2;if(0===pt.avail_out)return pt.msg=nx[7],-5;if(n=pt,Ln=r,r=Dt,42==e&&(Pt=8+(s-8<<4)<<8,on=(Se-1&255)>>1,on>3&&(on=3),Pt|=on<<6,0!==ee&&(Pt|=32),Pt+=31-Pt%31,e=113,function ku(pt){ms(pt>>8&255),ms(255&pt)}(Pt)),0!==t.pending){if(n.flush_pending(),0===n.avail_out)return r=-1,0}else if(0===n.avail_in&&Dt<=Ln&&4!=Dt)return n.msg=nx[7],-5;if(666==e&&0!==n.avail_in)return pt.msg=nx[7],-5;if(0!==n.avail_in||0!==J||0!=Dt&&666!=e){switch(Ni=-1,Hc[Se].func){case 0:Ni=function u0e(pt){let yt,Dt=65535;for(Dt>i-5&&(Dt=i-5);;){if(J<=1){if(V3(),0===J&&0==pt)return 0;if(0===J)break}if(ee+=J,J=0,yt=M+Dt,(0===ee||ee>=yt)&&(J=ee-yt,ee=yt,ta(!1),0===n.avail_out)||ee-M>=o-Ml&&(ta(!1),0===n.avail_out))return 0}return ta(4==pt),0===n.avail_out?4==pt?2:0:4==pt?3:1}(Dt);break;case 1:Ni=function d0e(pt){let yt,Dt=0;for(;;){if(J<Ml){if(V3(),J<Ml&&0==pt)return 0;if(0===J)break}if(J>=3&&(v=(v<<T^255&l[ee+2])&w,Dt=65535&g[v],f[ee&a]=g[v],g[v]=ee),0!==Dt&&(ee-Dt&65535)<=o-Ml&&2!=ue&&(S=IB(Dt)),S>=3)if(yt=Nl(ee-B,S-3),J-=S,S<=fe&&J>=3){S--;do{ee++,v=(v<<T^255&l[ee+2])&w,Dt=65535&g[v],f[ee&a]=g[v],g[v]=ee}while(0!=--S);ee++}else ee+=S,S=0,v=255&l[ee],v=(v<<T^255&l[ee+1])&w;else yt=Nl(0,255&l[ee]),J--,ee++;if(yt&&(ta(!1),0===n.avail_out))return 0}return ta(4==pt),0===n.avail_out?4==pt?2:0:4==pt?3:1}(Dt);break;case 2:Ni=function h0e(pt){let yt,Pt,Dt=0;for(;;){if(J<Ml){if(V3(),J<Ml&&0==pt)return 0;if(0===J)break}if(J>=3&&(v=(v<<T^255&l[ee+2])&w,Dt=65535&g[v],f[ee&a]=g[v],g[v]=ee),le=S,P=B,S=2,0!==Dt&&le<fe&&(ee-Dt&65535)<=o-Ml&&(2!=ue&&(S=IB(Dt)),S<=5&&(1==ue||3==S&&ee-B>4096)&&(S=2)),le>=3&&S<=le){Pt=ee+J-3,yt=Nl(ee-1-P,le-3),J-=le-1,le-=2;do{++ee<=Pt&&(v=(v<<T^255&l[ee+2])&w,Dt=65535&g[v],f[ee&a]=g[v],g[v]=ee)}while(0!=--le);if(Z=0,S=2,ee++,yt&&(ta(!1),0===n.avail_out))return 0}else if(0!==Z){if(yt=Nl(0,255&l[ee-1]),yt&&ta(!1),ee++,J--,0===n.avail_out)return 0}else Z=1,ee++,J--}return 0!==Z&&(yt=Nl(0,255&l[ee-1]),Z=0),ta(4==pt),0===n.avail_out?4==pt?2:0:4==pt?3:1}(Dt)}if((2==Ni||3==Ni)&&(e=666),0==Ni||2==Ni)return 0===n.avail_out&&(r=-1),0;if(1==Ni){if(1==Dt)!function Xa(){Or(2,3),ts(256,Os.static_ltree),Fl(),1+an+10-Yn<9&&(Or(2,3),ts(256,Os.static_ltree),Fl()),an=7}();else if(iw(0,0,!1),3==Dt)for(yt=0;yt<C;yt++)g[yt]=0;if(n.flush_pending(),0===n.avail_out)return r=-1,0}}return 4!=Dt?0:1}}function j5(){const t=this;t.next_in_index=0,t.next_out_index=0,t.avail_in=0,t.total_in=0,t.avail_out=0,t.total_out=0}j5.prototype={deflateInit(t,n){const e=this;return e.dstate=new $K,n||(n=Bb),e.dstate.deflateInit(e,t,n)},deflate(t){const n=this;return n.dstate?n.dstate.deflate(n,t):-2},deflateEnd(){const t=this;if(!t.dstate)return-2;const n=t.dstate.deflateEnd();return t.dstate=null,n},deflateParams(t,n){const e=this;return e.dstate?e.dstate.deflateParams(e,t,n):-2},deflateSetDictionary(t,n){const e=this;return e.dstate?e.dstate.deflateSetDictionary(e,t,n):-2},read_buf(t,n,e){const i=this;let r=i.avail_in;return r>e&&(r=e),0===r?0:(i.avail_in-=r,t.set(i.next_in.subarray(i.next_in_index,i.next_in_index+r),n),i.next_in_index+=r,i.total_in+=r,r)},flush_pending(){const t=this;let n=t.dstate.pending;n>t.avail_out&&(n=t.avail_out),0!==n&&(t.next_out.set(t.dstate.pending_buf.subarray(t.dstate.pending_out,t.dstate.pending_out+n),t.next_out_index),t.next_out_index+=n,t.dstate.pending_out+=n,t.total_out+=n,t.avail_out-=n,t.dstate.pending-=n,0===t.dstate.pending&&(t.dstate.pending_out=0))}};const Li=0,Cd=1,qa=-2,Hr=-3,G5=-4,xd=-5,Dl=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],W5=1440,tQ=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],nQ=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],iQ=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],rQ=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],oQ=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],sQ=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Hh=15;function BS(){let n,e,i,r,o,s;function a(u,f,g,v,C,E,w,T,M,S,P){let Z,ee,B,J,le,se,fe,Se,ue,Ue,Ze,nt,be,Ye,Ke;Ue=0,le=g;do{i[u[f+Ue]]++,Ue++,le--}while(0!==le);if(i[0]==g)return w[0]=-1,T[0]=0,Li;for(Se=T[0],se=1;se<=Hh&&0===i[se];se++);for(fe=se,Se<se&&(Se=se),le=Hh;0!==le&&0===i[le];le--);for(B=le,Se>le&&(Se=le),T[0]=Se,Ye=1<<se;se<le;se++,Ye<<=1)if((Ye-=i[se])<0)return Hr;if((Ye-=i[le])<0)return Hr;for(i[le]+=Ye,s[1]=se=0,Ue=1,be=2;0!=--le;)s[be]=se+=i[Ue],be++,Ue++;le=0,Ue=0;do{0!==(se=u[f+Ue])&&(P[s[se]++]=le),Ue++}while(++le<g);for(g=s[B],s[0]=le=0,Ue=0,J=-1,nt=-Se,o[0]=0,Ze=0,Ke=0;fe<=B;fe++)for(Z=i[fe];0!=Z--;){for(;fe>nt+Se;){if(J++,nt+=Se,Ke=B-nt,Ke=Ke>Se?Se:Ke,(ee=1<<(se=fe-nt))>Z+1&&(ee-=Z+1,be=fe,se<Ke))for(;++se<Ke&&!((ee<<=1)<=i[++be]);)ee-=i[be];if(Ke=1<<se,S[0]+Ke>W5)return Hr;o[J]=Ze=S[0],S[0]+=Ke,0!==J?(s[J]=le,r[0]=se,r[1]=Se,se=le>>>nt-Se,r[2]=Ze-o[J-1]-se,M.set(r,3*(o[J-1]+se))):w[0]=Ze}for(r[1]=fe-nt,Ue>=g?r[0]=192:P[Ue]<v?(r[0]=P[Ue]<256?0:96,r[2]=P[Ue++]):(r[0]=E[P[Ue]-v]+16+64,r[2]=C[P[Ue++]-v]),ee=1<<fe-nt,se=le>>>nt;se<Ke;se+=ee)M.set(r,3*(Ze+se));for(se=1<<fe-1;le&se;se>>>=1)le^=se;for(le^=se,ue=(1<<nt)-1;(le&ue)!=s[J];)J--,nt-=Se,ue=(1<<nt)-1}return 0!==Ye&&1!=B?xd:Li}function l(u){let f;for(n||(n=[],e=[],i=new Int32Array(Hh+1),r=[],o=new Int32Array(Hh),s=new Int32Array(Hh+1)),e.length<u&&(e=[]),f=0;f<u;f++)e[f]=0;for(f=0;f<Hh+1;f++)i[f]=0;for(f=0;f<3;f++)r[f]=0;o.set(i.subarray(0,Hh),0),s.set(i.subarray(0,Hh+1),0)}this.inflate_trees_bits=function(u,f,g,v,C){let E;return l(19),n[0]=0,E=a(u,0,19,19,null,null,g,f,v,n,e),E==Hr?C.msg="oversubscribed dynamic bit lengths tree":(E==xd||0===f[0])&&(C.msg="incomplete dynamic bit lengths tree",E=Hr),E},this.inflate_trees_dynamic=function(u,f,g,v,C,E,w,T,M){let S;return l(288),n[0]=0,S=a(g,0,u,257,iQ,rQ,E,v,T,n,e),S!=Li||0===v[0]?(S==Hr?M.msg="oversubscribed literal/length tree":S!=G5&&(M.msg="incomplete literal/length tree",S=Hr),S):(l(288),S=a(g,u,f,0,oQ,sQ,w,C,T,n,e),S!=Li||0===C[0]&&u>257?(S==Hr?M.msg="oversubscribed distance tree":S==xd?(M.msg="incomplete distance tree",S=Hr):S!=G5&&(M.msg="empty distance tree with lengths",S=Hr),S):Li)}}BS.inflate_trees_fixed=function(t,n,e,i){return t[0]=9,n[0]=5,e[0]=tQ,i[0]=nQ,Li};const ax=0,$5=1,Y5=2,q5=3,Z5=4,X5=5,K5=6,US=7,Q5=8,lx=9;function aQ(){const t=this;let n,i,g,C,e=0,r=0,o=0,s=0,a=0,l=0,u=0,f=0,v=0,E=0;function w(T,M,S,P,Z,ee,B,J){let le,se,fe,Se,ue,Ue,Ze,nt,be,Ye,Ke,tt,lt,sn,Ct,Ft;Ze=J.next_in_index,nt=J.avail_in,ue=B.bitb,Ue=B.bitk,be=B.write,Ye=be<B.read?B.read-be-1:B.end-be,Ke=Dl[T],tt=Dl[M];do{for(;Ue<20;)nt--,ue|=(255&J.read_byte(Ze++))<<Ue,Ue+=8;if(le=ue&Ke,se=S,fe=P,Ft=3*(fe+le),0!==(Se=se[Ft]))for(;;){if(ue>>=se[Ft+1],Ue-=se[Ft+1],16&Se){for(Se&=15,lt=se[Ft+2]+(ue&Dl[Se]),ue>>=Se,Ue-=Se;Ue<15;)nt--,ue|=(255&J.read_byte(Ze++))<<Ue,Ue+=8;for(le=ue&tt,se=Z,fe=ee,Ft=3*(fe+le),Se=se[Ft];;){if(ue>>=se[Ft+1],Ue-=se[Ft+1],16&Se){for(Se&=15;Ue<Se;)nt--,ue|=(255&J.read_byte(Ze++))<<Ue,Ue+=8;if(sn=se[Ft+2]+(ue&Dl[Se]),ue>>=Se,Ue-=Se,Ye-=lt,be>=sn)Ct=be-sn,be-Ct>0&&2>be-Ct?(B.win[be++]=B.win[Ct++],B.win[be++]=B.win[Ct++],lt-=2):(B.win.set(B.win.subarray(Ct,Ct+2),be),be+=2,Ct+=2,lt-=2);else{Ct=be-sn;do{Ct+=B.end}while(Ct<0);if(Se=B.end-Ct,lt>Se){if(lt-=Se,be-Ct>0&&Se>be-Ct)do{B.win[be++]=B.win[Ct++]}while(0!=--Se);else B.win.set(B.win.subarray(Ct,Ct+Se),be),be+=Se,Ct+=Se,Se=0;Ct=0}}if(be-Ct>0&&lt>be-Ct)do{B.win[be++]=B.win[Ct++]}while(0!=--lt);else B.win.set(B.win.subarray(Ct,Ct+lt),be),be+=lt,Ct+=lt,lt=0;break}if(64&Se)return J.msg="invalid distance code",lt=J.avail_in-nt,lt=Ue>>3<lt?Ue>>3:lt,nt+=lt,Ze-=lt,Ue-=lt<<3,B.bitb=ue,B.bitk=Ue,J.avail_in=nt,J.total_in+=Ze-J.next_in_index,J.next_in_index=Ze,B.write=be,Hr;le+=se[Ft+2],le+=ue&Dl[Se],Ft=3*(fe+le),Se=se[Ft]}break}if(64&Se)return 32&Se?(lt=J.avail_in-nt,lt=Ue>>3<lt?Ue>>3:lt,nt+=lt,Ze-=lt,Ue-=lt<<3,B.bitb=ue,B.bitk=Ue,J.avail_in=nt,J.total_in+=Ze-J.next_in_index,J.next_in_index=Ze,B.write=be,Cd):(J.msg="invalid literal/length code",lt=J.avail_in-nt,lt=Ue>>3<lt?Ue>>3:lt,nt+=lt,Ze-=lt,Ue-=lt<<3,B.bitb=ue,B.bitk=Ue,J.avail_in=nt,J.total_in+=Ze-J.next_in_index,J.next_in_index=Ze,B.write=be,Hr);if(le+=se[Ft+2],le+=ue&Dl[Se],Ft=3*(fe+le),0===(Se=se[Ft])){ue>>=se[Ft+1],Ue-=se[Ft+1],B.win[be++]=se[Ft+2],Ye--;break}}else ue>>=se[Ft+1],Ue-=se[Ft+1],B.win[be++]=se[Ft+2],Ye--}while(Ye>=258&&nt>=10);return lt=J.avail_in-nt,lt=Ue>>3<lt?Ue>>3:lt,nt+=lt,Ze-=lt,Ue-=lt<<3,B.bitb=ue,B.bitk=Ue,J.avail_in=nt,J.total_in+=Ze-J.next_in_index,J.next_in_index=Ze,B.write=be,Li}t.init=function(T,M,S,P,Z,ee){n=ax,u=T,f=M,g=S,v=P,C=Z,E=ee,i=null},t.proc=function(T,M,S){let P,Z,ee,se,fe,Se,ue,B=0,J=0,le=0;for(le=M.next_in_index,se=M.avail_in,B=T.bitb,J=T.bitk,fe=T.write,Se=fe<T.read?T.read-fe-1:T.end-fe;;)switch(n){case ax:if(Se>=258&&se>=10&&(T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,S=w(u,f,g,v,C,E,T,M),le=M.next_in_index,se=M.avail_in,B=T.bitb,J=T.bitk,fe=T.write,Se=fe<T.read?T.read-fe-1:T.end-fe,S!=Li)){n=S==Cd?US:lx;break}o=u,i=g,r=v,n=$5;case $5:for(P=o;J<P;){if(0===se)return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);S=Li,se--,B|=(255&M.read_byte(le++))<<J,J+=8}if(Z=3*(r+(B&Dl[P])),B>>>=i[Z+1],J-=i[Z+1],ee=i[Z],0===ee){s=i[Z+2],n=K5;break}if(16&ee){a=15&ee,e=i[Z+2],n=Y5;break}if(!(64&ee)){o=ee,r=Z/3+i[Z+2];break}if(32&ee){n=US;break}return n=lx,M.msg="invalid literal/length code",S=Hr,T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);case Y5:for(P=a;J<P;){if(0===se)return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);S=Li,se--,B|=(255&M.read_byte(le++))<<J,J+=8}e+=B&Dl[P],B>>=P,J-=P,o=f,i=C,r=E,n=q5;case q5:for(P=o;J<P;){if(0===se)return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);S=Li,se--,B|=(255&M.read_byte(le++))<<J,J+=8}if(Z=3*(r+(B&Dl[P])),B>>=i[Z+1],J-=i[Z+1],ee=i[Z],16&ee){a=15&ee,l=i[Z+2],n=Z5;break}if(!(64&ee)){o=ee,r=Z/3+i[Z+2];break}return n=lx,M.msg="invalid distance code",S=Hr,T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);case Z5:for(P=a;J<P;){if(0===se)return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);S=Li,se--,B|=(255&M.read_byte(le++))<<J,J+=8}l+=B&Dl[P],B>>=P,J-=P,n=X5;case X5:for(ue=fe-l;ue<0;)ue+=T.end;for(;0!==e;){if(0===Se&&(fe==T.end&&0!==T.read&&(fe=0,Se=fe<T.read?T.read-fe-1:T.end-fe),0===Se&&(T.write=fe,S=T.inflate_flush(M,S),fe=T.write,Se=fe<T.read?T.read-fe-1:T.end-fe,fe==T.end&&0!==T.read&&(fe=0,Se=fe<T.read?T.read-fe-1:T.end-fe),0===Se)))return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);T.win[fe++]=T.win[ue++],Se--,ue==T.end&&(ue=0),e--}n=ax;break;case K5:if(0===Se&&(fe==T.end&&0!==T.read&&(fe=0,Se=fe<T.read?T.read-fe-1:T.end-fe),0===Se&&(T.write=fe,S=T.inflate_flush(M,S),fe=T.write,Se=fe<T.read?T.read-fe-1:T.end-fe,fe==T.end&&0!==T.read&&(fe=0,Se=fe<T.read?T.read-fe-1:T.end-fe),0===Se)))return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);S=Li,T.win[fe++]=s,Se--,n=ax;break;case US:if(J>7&&(J-=8,se++,le--),T.write=fe,S=T.inflate_flush(M,S),fe=T.write,Se=fe<T.read?T.read-fe-1:T.end-fe,T.read!=T.write)return T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);n=Q5;case Q5:return S=Cd,T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);case lx:return S=Hr,T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S);default:return S=qa,T.bitb=B,T.bitk=J,M.avail_in=se,M.total_in+=le-M.next_in_index,M.next_in_index=le,T.write=fe,T.inflate_flush(M,S)}},t.free=function(){}}const J5=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Mm=0,HS=1,eR=2,tR=3,nR=4,iR=5,cx=6,ux=7,rR=8,vp=9;function lQ(t,n){const e=this;let a,i=Mm,r=0,o=0,s=0;const l=[0],u=[0],f=new aQ;let g=0,v=new Int32Array(3*W5);const E=new BS;e.bitk=0,e.bitb=0,e.win=new Uint8Array(n),e.end=n,e.read=0,e.write=0,e.reset=function(w,T){T&&(T[0]=0),i==cx&&f.free(w),i=Mm,e.bitk=0,e.bitb=0,e.read=e.write=0},e.reset(t,null),e.inflate_flush=function(w,T){let M,S,P;return S=w.next_out_index,P=e.read,M=(P<=e.write?e.write:e.end)-P,M>w.avail_out&&(M=w.avail_out),0!==M&&T==xd&&(T=Li),w.avail_out-=M,w.total_out+=M,w.next_out.set(e.win.subarray(P,P+M),S),S+=M,P+=M,P==e.end&&(P=0,e.write==e.end&&(e.write=0),M=e.write-P,M>w.avail_out&&(M=w.avail_out),0!==M&&T==xd&&(T=Li),w.avail_out-=M,w.total_out+=M,w.next_out.set(e.win.subarray(P,P+M),S),S+=M,P+=M),w.next_out_index=S,e.read=P,T},e.proc=function(w,T){let M,S,P,Z,ee,B,J,le;for(Z=w.next_in_index,ee=w.avail_in,S=e.bitb,P=e.bitk,B=e.write,J=B<e.read?e.read-B-1:e.end-B;;){let se,fe,Se,ue,Ue,Ze,nt,be;switch(i){case Mm:for(;P<3;){if(0===ee)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);T=Li,ee--,S|=(255&w.read_byte(Z++))<<P,P+=8}switch(M=7&S,g=1&M,M>>>1){case 0:S>>>=3,P-=3,M=7&P,S>>>=M,P-=M,i=HS;break;case 1:se=[],fe=[],Se=[[]],ue=[[]],BS.inflate_trees_fixed(se,fe,Se,ue),f.init(se[0],fe[0],Se[0],0,ue[0],0),S>>>=3,P-=3,i=cx;break;case 2:S>>>=3,P-=3,i=tR;break;case 3:return S>>>=3,P-=3,i=vp,w.msg="invalid block type",T=Hr,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T)}break;case HS:for(;P<32;){if(0===ee)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);T=Li,ee--,S|=(255&w.read_byte(Z++))<<P,P+=8}if((~S>>>16&65535)!=(65535&S))return i=vp,w.msg="invalid stored block lengths",T=Hr,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);r=65535&S,S=P=0,i=0!==r?eR:0!==g?ux:Mm;break;case eR:if(0===ee||0===J&&(B==e.end&&0!==e.read&&(B=0,J=B<e.read?e.read-B-1:e.end-B),0===J&&(e.write=B,T=e.inflate_flush(w,T),B=e.write,J=B<e.read?e.read-B-1:e.end-B,B==e.end&&0!==e.read&&(B=0,J=B<e.read?e.read-B-1:e.end-B),0===J)))return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);if(T=Li,M=r,M>ee&&(M=ee),M>J&&(M=J),e.win.set(w.read_buf(Z,M),B),Z+=M,ee-=M,B+=M,J-=M,0!=(r-=M))break;i=0!==g?ux:Mm;break;case tR:for(;P<14;){if(0===ee)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);T=Li,ee--,S|=(255&w.read_byte(Z++))<<P,P+=8}if(o=M=16383&S,(31&M)>29||(M>>5&31)>29)return i=vp,w.msg="too many length or distance symbols",T=Hr,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);if(M=258+(31&M)+(M>>5&31),!a||a.length<M)a=[];else for(le=0;le<M;le++)a[le]=0;S>>>=14,P-=14,s=0,i=nR;case nR:for(;s<4+(o>>>10);){for(;P<3;){if(0===ee)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);T=Li,ee--,S|=(255&w.read_byte(Z++))<<P,P+=8}a[J5[s++]]=7&S,S>>>=3,P-=3}for(;s<19;)a[J5[s++]]=0;if(l[0]=7,M=E.inflate_trees_bits(a,l,u,v,w),M!=Li)return(T=M)==Hr&&(a=null,i=vp),e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);s=0,i=iR;case iR:for(;M=o,!(s>=258+(31&M)+(M>>5&31));){let Ye,Ke;for(M=l[0];P<M;){if(0===ee)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);T=Li,ee--,S|=(255&w.read_byte(Z++))<<P,P+=8}if(M=v[3*(u[0]+(S&Dl[M]))+1],Ke=v[3*(u[0]+(S&Dl[M]))+2],Ke<16)S>>>=M,P-=M,a[s++]=Ke;else{for(le=18==Ke?7:Ke-14,Ye=18==Ke?11:3;P<M+le;){if(0===ee)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);T=Li,ee--,S|=(255&w.read_byte(Z++))<<P,P+=8}if(S>>>=M,P-=M,Ye+=S&Dl[le],S>>>=le,P-=le,le=s,M=o,le+Ye>258+(31&M)+(M>>5&31)||16==Ke&&le<1)return a=null,i=vp,w.msg="invalid bit length repeat",T=Hr,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);Ke=16==Ke?a[le-1]:0;do{a[le++]=Ke}while(0!=--Ye);s=le}}if(u[0]=-1,Ue=[],Ze=[],nt=[],be=[],Ue[0]=9,Ze[0]=6,M=o,M=E.inflate_trees_dynamic(257+(31&M),1+(M>>5&31),a,Ue,Ze,nt,be,v,w),M!=Li)return M==Hr&&(a=null,i=vp),T=M,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);f.init(Ue[0],Ze[0],v,nt[0],v,be[0]),i=cx;case cx:if(e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,(T=f.proc(e,w,T))!=Cd)return e.inflate_flush(w,T);if(T=Li,f.free(w),Z=w.next_in_index,ee=w.avail_in,S=e.bitb,P=e.bitk,B=e.write,J=B<e.read?e.read-B-1:e.end-B,0===g){i=Mm;break}i=ux;case ux:if(e.write=B,T=e.inflate_flush(w,T),B=e.write,J=B<e.read?e.read-B-1:e.end-B,e.read!=e.write)return e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);i=rR;case rR:return T=Cd,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);case vp:return T=Hr,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T);default:return T=qa,e.bitb=S,e.bitk=P,w.avail_in=ee,w.total_in+=Z-w.next_in_index,w.next_in_index=Z,e.write=B,e.inflate_flush(w,T)}}},e.free=function(w){e.reset(w,null),e.win=null,v=null},e.set_dictionary=function(w,T,M){e.win.set(w.subarray(T,T+M),0),e.read=e.write=M},e.sync_point=function(){return i==HS?1:0}}const hQ=[0,0,255,255];function fQ(){const t=this;function n(e){return e&&e.istate?(e.total_in=e.total_out=0,e.msg=null,e.istate.mode=7,e.istate.blocks.reset(e,null),Li):qa}t.mode=0,t.method=0,t.was=[0],t.need=0,t.marker=0,t.wbits=0,t.inflateEnd=function(e){return t.blocks&&t.blocks.free(e),t.blocks=null,Li},t.inflateInit=function(e,i){return e.msg=null,t.blocks=null,i<8||i>15?(t.inflateEnd(e),qa):(t.wbits=i,e.istate.blocks=new lQ(e,1<<i),n(e),Li)},t.inflate=function(e,i){let r,o;if(!e||!e.istate||!e.next_in)return qa;const s=e.istate;for(i=4==i?xd:Li,r=xd;;)switch(s.mode){case 0:if(0===e.avail_in)return r;if(r=i,e.avail_in--,e.total_in++,8!=(15&(s.method=e.read_byte(e.next_in_index++)))){s.mode=13,e.msg="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.wbits){s.mode=13,e.msg="invalid win size",s.marker=5;break}s.mode=1;case 1:if(0===e.avail_in)return r;if(r=i,e.avail_in--,e.total_in++,o=255&e.read_byte(e.next_in_index++),((s.method<<8)+o)%31!=0){s.mode=13,e.msg="incorrect header check",s.marker=5;break}if(!(32&o)){s.mode=7;break}s.mode=2;case 2:if(0===e.avail_in)return r;r=i,e.avail_in--,e.total_in++,s.need=(255&e.read_byte(e.next_in_index++))<<24&4278190080,s.mode=3;case 3:if(0===e.avail_in)return r;r=i,e.avail_in--,e.total_in++,s.need+=(255&e.read_byte(e.next_in_index++))<<16&16711680,s.mode=4;case 4:if(0===e.avail_in)return r;r=i,e.avail_in--,e.total_in++,s.need+=(255&e.read_byte(e.next_in_index++))<<8&65280,s.mode=5;case 5:return 0===e.avail_in?r:(r=i,e.avail_in--,e.total_in++,s.need+=255&e.read_byte(e.next_in_index++),s.mode=6,2);case 6:return s.mode=13,e.msg="need dictionary",s.marker=0,qa;case 7:if(r=s.blocks.proc(e,r),r==Hr){s.mode=13,s.marker=0;break}if(r==Li&&(r=i),r!=Cd)return r;r=i,s.blocks.reset(e,s.was),s.mode=12;case 12:return e.avail_in=0,Cd;case 13:return Hr;default:return qa}},t.inflateSetDictionary=function(e,i,r){let o=0,s=r;if(!e||!e.istate||6!=e.istate.mode)return qa;const a=e.istate;return s>=1<<a.wbits&&(s=(1<<a.wbits)-1,o=r-s),a.blocks.set_dictionary(i,o,s),a.mode=7,Li},t.inflateSync=function(e){let i,r,o,s,a;if(!e||!e.istate)return qa;const l=e.istate;if(13!=l.mode&&(l.mode=13,l.marker=0),0===(i=e.avail_in))return xd;for(r=e.next_in_index,o=l.marker;0!==i&&o<4;)e.read_byte(r)==hQ[o]?o++:o=0!==e.read_byte(r)?0:4-o,r++,i--;return e.total_in+=r-e.next_in_index,e.next_in_index=r,e.avail_in=i,l.marker=o,4!=o?Hr:(s=e.total_in,a=e.total_out,n(e),e.total_in=s,e.total_out=a,l.mode=7,Li)},t.inflateSyncPoint=function(e){return e&&e.istate&&e.istate.blocks?e.istate.blocks.sync_point():qa}}function dR(){}dR.prototype={inflateInit(t){const n=this;return n.istate=new fQ,t||(t=15),n.istate.inflateInit(n,t)},inflate(t){const n=this;return n.istate?n.istate.inflate(n,t):qa},inflateEnd(){const t=this;if(!t.istate)return qa;const n=t.istate.inflateEnd(t);return t.istate=null,n},inflateSync(){const t=this;return t.istate?t.istate.inflateSync(t):qa},inflateSetDictionary(t,n){const e=this;return e.istate?e.istate.inflateSetDictionary(e,t,n):qa},read_byte(t){return this.next_in[t]},read_buf(t,n){return this.next_in.subarray(t,t+n)}};const go=4294967295,oo=65535,VS=8,gQ=9,jS=134695760,gR=jS,GS=33639248,mR=101010256,WS=101075792,_R=117853008,ER=6534,YS=1,yQ=2,CQ=4,xQ=6,qS=8,ZS=2048,yp=30,JS=10,Dm=14,Om=18,MR=new Date(2107,11,31),DR=new Date(1980,0,1),ii=void 0,Vh="undefined",$b="function";class OR{constructor(n){return class extends TransformStream{constructor(e,i){const r=new n(i);super({transform(o,s){s.enqueue(r.append(o))},flush(o){const s=r.flush();s&&o.enqueue(s)}})}}}}const TQ=64;let AR=2;try{typeof navigator!=Vh&&navigator.hardwareConcurrency&&(AR=navigator.hardwareConcurrency)}catch{}const IQ={chunkSize:524288,maxWorkers:AR,terminateWorkerTimeout:5e3,useWebWorkers:!0,useCompressionStream:!0,workerScripts:ii,CompressionStreamNative:typeof CompressionStream!=Vh&&CompressionStream,DecompressionStreamNative:typeof DecompressionStream!=Vh&&DecompressionStream},jh=Object.assign({},IQ);function eM(){return jh}function kR(t){return Math.max(t.chunkSize,TQ)}function tM(t){const{baseURL:n,chunkSize:e,maxWorkers:i,terminateWorkerTimeout:r,useCompressionStream:o,useWebWorkers:s,Deflate:a,Inflate:l,CompressionStream:u,DecompressionStream:f,workerScripts:g}=t;if(Gh("baseURL",n),Gh("chunkSize",e),Gh("maxWorkers",i),Gh("terminateWorkerTimeout",r),Gh("useCompressionStream",o),Gh("useWebWorkers",s),a&&(jh.CompressionStream=new OR(a)),l&&(jh.DecompressionStream=new OR(l)),Gh("CompressionStream",u),Gh("DecompressionStream",f),g!==ii){const{deflate:v,inflate:C}=g;if((v||C)&&(jh.workerScripts||(jh.workerScripts={})),v){if(!Array.isArray(v))throw new Error("workerScripts.deflate must be an array");jh.workerScripts.deflate=v}if(C){if(!Array.isArray(C))throw new Error("workerScripts.inflate must be an array");jh.workerScripts.inflate=C}}}function Gh(t,n){n!==ii&&(jh[t]=n)}const nM={application:{"andrew-inset":"ez",annodex:"anx","atom+xml":"atom","atomcat+xml":"atomcat","atomserv+xml":"atomsrv",bbolin:"lin","cu-seeme":"cu","davmount+xml":"davmount",dsptype:"tsp",ecmascript:["es","ecma"],futuresplash:"spl",hta:"hta","java-archive":"jar","java-serialized-object":"ser","java-vm":"class",m3g:"m3g","mac-binhex40":"hqx",mathematica:["nb","ma","mb"],msaccess:"mdb",msword:["doc","dot","wiz"],mxf:"mxf",oda:"oda",ogg:"ogx",pdf:"pdf","pgp-keys":"key","pgp-signature":["asc","sig"],"pics-rules":"prf",postscript:["ps","ai","eps","epsi","epsf","eps2","eps3"],rar:"rar","rdf+xml":"rdf","rss+xml":"rss",rtf:"rtf","xhtml+xml":["xhtml","xht"],xml:["xml","xsl","xsd","xpdl"],"xspf+xml":"xspf",zip:"zip","vnd.android.package-archive":"apk","vnd.cinderella":"cdy","vnd.google-earth.kml+xml":"kml","vnd.google-earth.kmz":"kmz","vnd.mozilla.xul+xml":"xul","vnd.ms-excel":["xls","xlb","xlt","xlm","xla","xlc","xlw"],"vnd.ms-pki.seccat":"cat","vnd.ms-pki.stl":"stl","vnd.ms-powerpoint":["ppt","pps","pot","ppa","pwz"],"vnd.oasis.opendocument.chart":"odc","vnd.oasis.opendocument.database":"odb","vnd.oasis.opendocument.formula":"odf","vnd.oasis.opendocument.graphics":"odg","vnd.oasis.opendocument.graphics-template":"otg","vnd.oasis.opendocument.image":"odi","vnd.oasis.opendocument.presentation":"odp","vnd.oasis.opendocument.presentation-template":"otp","vnd.oasis.opendocument.spreadsheet":"ods","vnd.oasis.opendocument.spreadsheet-template":"ots","vnd.oasis.opendocument.text":"odt","vnd.oasis.opendocument.text-master":["odm","otm"],"vnd.oasis.opendocument.text-template":"ott","vnd.oasis.opendocument.text-web":"oth","vnd.openxmlformats-officedocument.spreadsheetml.sheet":"xlsx","vnd.openxmlformats-officedocument.spreadsheetml.template":"xltx","vnd.openxmlformats-officedocument.presentationml.presentation":"pptx","vnd.openxmlformats-officedocument.presentationml.slideshow":"ppsx","vnd.openxmlformats-officedocument.presentationml.template":"potx","vnd.openxmlformats-officedocument.wordprocessingml.document":"docx","vnd.openxmlformats-officedocument.wordprocessingml.template":"dotx","vnd.smaf":"mmf","vnd.stardivision.calc":"sdc","vnd.stardivision.chart":"sds","vnd.stardivision.draw":"sda","vnd.stardivision.impress":"sdd","vnd.stardivision.math":["sdf","smf"],"vnd.stardivision.writer":["sdw","vor"],"vnd.stardivision.writer-global":"sgl","vnd.sun.xml.calc":"sxc","vnd.sun.xml.calc.template":"stc","vnd.sun.xml.draw":"sxd","vnd.sun.xml.draw.template":"std","vnd.sun.xml.impress":"sxi","vnd.sun.xml.impress.template":"sti","vnd.sun.xml.math":"sxm","vnd.sun.xml.writer":"sxw","vnd.sun.xml.writer.global":"sxg","vnd.sun.xml.writer.template":"stw","vnd.symbian.install":["sis","sisx"],"vnd.visio":["vsd","vst","vss","vsw","vsdx","vssx","vstx","vssm","vstm"],"vnd.wap.wbxml":"wbxml","vnd.wap.wmlc":"wmlc","vnd.wap.wmlscriptc":"wmlsc","vnd.wordperfect":"wpd","vnd.wordperfect5.1":"wp5","x-123":"wk","x-7z-compressed":"7z","x-abiword":"abw","x-apple-diskimage":"dmg","x-bcpio":"bcpio","x-bittorrent":"torrent","x-cbr":["cbr","cba","cbt","cb7"],"x-cbz":"cbz","x-cdf":["cdf","cda"],"x-cdlink":"vcd","x-chess-pgn":"pgn","x-cpio":"cpio","x-csh":"csh","x-director":["dir","dxr","cst","cct","cxt","w3d","fgd","swa"],"x-dms":"dms","x-doom":"wad","x-dvi":"dvi","x-httpd-eruby":"rhtml","x-font":"pcf.Z","x-freemind":"mm","x-gnumeric":"gnumeric","x-go-sgf":"sgf","x-graphing-calculator":"gcf","x-gtar":["gtar","taz"],"x-hdf":"hdf","x-httpd-php":["phtml","pht","php"],"x-httpd-php-source":"phps","x-httpd-php3":"php3","x-httpd-php3-preprocessed":"php3p","x-httpd-php4":"php4","x-httpd-php5":"php5","x-ica":"ica","x-info":"info","x-internet-signup":["ins","isp"],"x-iphone":"iii","x-iso9660-image":"iso","x-java-jnlp-file":"jnlp","x-jmol":"jmz","x-killustrator":"kil","x-latex":"latex","x-lyx":"lyx","x-lzx":"lzx","x-maker":["frm","fb","fbdoc"],"x-ms-wmd":"wmd","x-msdos-program":["com","exe","bat","dll"],"x-netcdf":["nc"],"x-ns-proxy-autoconfig":["pac","dat"],"x-nwc":"nwc","x-object":"o","x-oz-application":"oza","x-pkcs7-certreqresp":"p7r","x-python-code":["pyc","pyo"],"x-qgis":["qgs","shp","shx"],"x-quicktimeplayer":"qtl","x-redhat-package-manager":["rpm","rpa"],"x-ruby":"rb","x-sh":"sh","x-shar":"shar","x-shockwave-flash":["swf","swfl"],"x-silverlight":"scr","x-stuffit":"sit","x-sv4cpio":"sv4cpio","x-sv4crc":"sv4crc","x-tar":"tar","x-tex-gf":"gf","x-tex-pk":"pk","x-texinfo":["texinfo","texi"],"x-trash":["~","%","bak","old","sik"],"x-ustar":"ustar","x-wais-source":"src","x-wingz":"wz","x-x509-ca-cert":["crt","der","cer"],"x-xcf":"xcf","x-xfig":"fig","x-xpinstall":"xpi",applixware:"aw","atomsvc+xml":"atomsvc","ccxml+xml":"ccxml","cdmi-capability":"cdmia","cdmi-container":"cdmic","cdmi-domain":"cdmid","cdmi-object":"cdmio","cdmi-queue":"cdmiq","docbook+xml":"dbk","dssc+der":"dssc","dssc+xml":"xdssc","emma+xml":"emma","epub+zip":"epub",exi:"exi","font-tdpfr":"pfr","gml+xml":"gml","gpx+xml":"gpx",gxf:"gxf",hyperstudio:"stk","inkml+xml":["ink","inkml"],ipfix:"ipfix","jsonml+json":"jsonml","lost+xml":"lostxml","mads+xml":"mads",marc:"mrc","marcxml+xml":"mrcx","mathml+xml":["mathml","mml"],mbox:"mbox","mediaservercontrol+xml":"mscml","metalink+xml":"metalink","metalink4+xml":"meta4","mets+xml":"mets","mods+xml":"mods",mp21:["m21","mp21"],mp4:"mp4s","oebps-package+xml":"opf","omdoc+xml":"omdoc",onenote:["onetoc","onetoc2","onetmp","onepkg"],oxps:"oxps","patch-ops-error+xml":"xer","pgp-encrypted":"pgp",pkcs10:"p10","pkcs7-mime":["p7m","p7c"],"pkcs7-signature":"p7s",pkcs8:"p8","pkix-attr-cert":"ac","pkix-crl":"crl","pkix-pkipath":"pkipath",pkixcmp:"pki","pls+xml":"pls","prs.cww":"cww","pskc+xml":"pskcxml","reginfo+xml":"rif","relax-ng-compact-syntax":"rnc","resource-lists+xml":"rl","resource-lists-diff+xml":"rld","rls-services+xml":"rs","rpki-ghostbusters":"gbr","rpki-manifest":"mft","rpki-roa":"roa","rsd+xml":"rsd","sbml+xml":"sbml","scvp-cv-request":"scq","scvp-cv-response":"scs","scvp-vp-request":"spq","scvp-vp-response":"spp",sdp:"sdp","set-payment-initiation":"setpay","set-registration-initiation":"setreg","shf+xml":"shf","sparql-query":"rq","sparql-results+xml":"srx",srgs:"gram","srgs+xml":"grxml","sru+xml":"sru","ssdl+xml":"ssdl","ssml+xml":"ssml","tei+xml":["tei","teicorpus"],"thraud+xml":"tfi","timestamped-data":"tsd","vnd.3gpp.pic-bw-large":"plb","vnd.3gpp.pic-bw-small":"psb","vnd.3gpp.pic-bw-var":"pvb","vnd.3gpp2.tcap":"tcap","vnd.3m.post-it-notes":"pwn","vnd.accpac.simply.aso":"aso","vnd.accpac.simply.imp":"imp","vnd.acucobol":"acu","vnd.acucorp":["atc","acutc"],"vnd.adobe.air-application-installer-package+zip":"air","vnd.adobe.formscentral.fcdt":"fcdt","vnd.adobe.fxp":["fxp","fxpl"],"vnd.adobe.xdp+xml":"xdp","vnd.adobe.xfdf":"xfdf","vnd.ahead.space":"ahead","vnd.airzip.filesecure.azf":"azf","vnd.airzip.filesecure.azs":"azs","vnd.amazon.ebook":"azw","vnd.americandynamics.acc":"acc","vnd.amiga.ami":"ami","vnd.anser-web-certificate-issue-initiation":"cii","vnd.anser-web-funds-transfer-initiation":"fti","vnd.antix.game-component":"atx","vnd.apple.installer+xml":"mpkg","vnd.apple.mpegurl":"m3u8","vnd.aristanetworks.swi":"swi","vnd.astraea-software.iota":"iota","vnd.audiograph":"aep","vnd.blueice.multipass":"mpm","vnd.bmi":"bmi","vnd.businessobjects":"rep","vnd.chemdraw+xml":"cdxml","vnd.chipnuts.karaoke-mmd":"mmd","vnd.claymore":"cla","vnd.cloanto.rp9":"rp9","vnd.clonk.c4group":["c4g","c4d","c4f","c4p","c4u"],"vnd.cluetrust.cartomobile-config":"c11amc","vnd.cluetrust.cartomobile-config-pkg":"c11amz","vnd.commonspace":"csp","vnd.contact.cmsg":"cdbcmsg","vnd.cosmocaller":"cmc","vnd.crick.clicker":"clkx","vnd.crick.clicker.keyboard":"clkk","vnd.crick.clicker.palette":"clkp","vnd.crick.clicker.template":"clkt","vnd.crick.clicker.wordbank":"clkw","vnd.criticaltools.wbs+xml":"wbs","vnd.ctc-posml":"pml","vnd.cups-ppd":"ppd","vnd.curl.car":"car","vnd.curl.pcurl":"pcurl","vnd.dart":"dart","vnd.data-vision.rdz":"rdz","vnd.dece.data":["uvf","uvvf","uvd","uvvd"],"vnd.dece.ttml+xml":["uvt","uvvt"],"vnd.dece.unspecified":["uvx","uvvx"],"vnd.dece.zip":["uvz","uvvz"],"vnd.denovo.fcselayout-link":"fe_launch","vnd.dna":"dna","vnd.dolby.mlp":"mlp","vnd.dpgraph":"dpg","vnd.dreamfactory":"dfac","vnd.ds-keypoint":"kpxx","vnd.dvb.ait":"ait","vnd.dvb.service":"svc","vnd.dynageo":"geo","vnd.ecowin.chart":"mag","vnd.enliven":"nml","vnd.epson.esf":"esf","vnd.epson.msf":"msf","vnd.epson.quickanime":"qam","vnd.epson.salt":"slt","vnd.epson.ssf":"ssf","vnd.eszigno3+xml":["es3","et3"],"vnd.ezpix-album":"ez2","vnd.ezpix-package":"ez3","vnd.fdf":"fdf","vnd.fdsn.mseed":"mseed","vnd.fdsn.seed":["seed","dataless"],"vnd.flographit":"gph","vnd.fluxtime.clip":"ftc","vnd.framemaker":["fm","frame","maker","book"],"vnd.frogans.fnc":"fnc","vnd.frogans.ltf":"ltf","vnd.fsc.weblaunch":"fsc","vnd.fujitsu.oasys":"oas","vnd.fujitsu.oasys2":"oa2","vnd.fujitsu.oasys3":"oa3","vnd.fujitsu.oasysgp":"fg5","vnd.fujitsu.oasysprs":"bh2","vnd.fujixerox.ddd":"ddd","vnd.fujixerox.docuworks":"xdw","vnd.fujixerox.docuworks.binder":"xbd","vnd.fuzzysheet":"fzs","vnd.genomatix.tuxedo":"txd","vnd.geogebra.file":"ggb","vnd.geogebra.tool":"ggt","vnd.geometry-explorer":["gex","gre"],"vnd.geonext":"gxt","vnd.geoplan":"g2w","vnd.geospace":"g3w","vnd.gmx":"gmx","vnd.grafeq":["gqf","gqs"],"vnd.groove-account":"gac","vnd.groove-help":"ghf","vnd.groove-identity-message":"gim","vnd.groove-injector":"grv","vnd.groove-tool-message":"gtm","vnd.groove-tool-template":"tpl","vnd.groove-vcard":"vcg","vnd.hal+xml":"hal","vnd.handheld-entertainment+xml":"zmm","vnd.hbci":"hbci","vnd.hhe.lesson-player":"les","vnd.hp-hpgl":"hpgl","vnd.hp-hpid":"hpid","vnd.hp-hps":"hps","vnd.hp-jlyt":"jlt","vnd.hp-pcl":"pcl","vnd.hp-pclxl":"pclxl","vnd.hydrostatix.sof-data":"sfd-hdstx","vnd.ibm.minipay":"mpy","vnd.ibm.modcap":["afp","listafp","list3820"],"vnd.ibm.rights-management":"irm","vnd.ibm.secure-container":"sc","vnd.iccprofile":["icc","icm"],"vnd.igloader":"igl","vnd.immervision-ivp":"ivp","vnd.immervision-ivu":"ivu","vnd.insors.igm":"igm","vnd.intercon.formnet":["xpw","xpx"],"vnd.intergeo":"i2g","vnd.intu.qbo":"qbo","vnd.intu.qfx":"qfx","vnd.ipunplugged.rcprofile":"rcprofile","vnd.irepository.package+xml":"irp","vnd.is-xpr":"xpr","vnd.isac.fcs":"fcs","vnd.jam":"jam","vnd.jcp.javame.midlet-rms":"rms","vnd.jisp":"jisp","vnd.joost.joda-archive":"joda","vnd.kahootz":["ktz","ktr"],"vnd.kde.karbon":"karbon","vnd.kde.kchart":"chrt","vnd.kde.kformula":"kfo","vnd.kde.kivio":"flw","vnd.kde.kontour":"kon","vnd.kde.kpresenter":["kpr","kpt"],"vnd.kde.kspread":"ksp","vnd.kde.kword":["kwd","kwt"],"vnd.kenameaapp":"htke","vnd.kidspiration":"kia","vnd.kinar":["kne","knp"],"vnd.koan":["skp","skd","skt","skm"],"vnd.kodak-descriptor":"sse","vnd.las.las+xml":"lasxml","vnd.llamagraphics.life-balance.desktop":"lbd","vnd.llamagraphics.life-balance.exchange+xml":"lbe","vnd.lotus-1-2-3":"123","vnd.lotus-approach":"apr","vnd.lotus-freelance":"pre","vnd.lotus-notes":"nsf","vnd.lotus-organizer":"org","vnd.lotus-screencam":"scm","vnd.lotus-wordpro":"lwp","vnd.macports.portpkg":"portpkg","vnd.mcd":"mcd","vnd.medcalcdata":"mc1","vnd.mediastation.cdkey":"cdkey","vnd.mfer":"mwf","vnd.mfmp":"mfm","vnd.micrografx.flo":"flo","vnd.micrografx.igx":"igx","vnd.mif":"mif","vnd.mobius.daf":"daf","vnd.mobius.dis":"dis","vnd.mobius.mbk":"mbk","vnd.mobius.mqy":"mqy","vnd.mobius.msl":"msl","vnd.mobius.plc":"plc","vnd.mobius.txf":"txf","vnd.mophun.application":"mpn","vnd.mophun.certificate":"mpc","vnd.ms-artgalry":"cil","vnd.ms-cab-compressed":"cab","vnd.ms-excel.addin.macroenabled.12":"xlam","vnd.ms-excel.sheet.binary.macroenabled.12":"xlsb","vnd.ms-excel.sheet.macroenabled.12":"xlsm","vnd.ms-excel.template.macroenabled.12":"xltm","vnd.ms-fontobject":"eot","vnd.ms-htmlhelp":"chm","vnd.ms-ims":"ims","vnd.ms-lrm":"lrm","vnd.ms-officetheme":"thmx","vnd.ms-powerpoint.addin.macroenabled.12":"ppam","vnd.ms-powerpoint.presentation.macroenabled.12":"pptm","vnd.ms-powerpoint.slide.macroenabled.12":"sldm","vnd.ms-powerpoint.slideshow.macroenabled.12":"ppsm","vnd.ms-powerpoint.template.macroenabled.12":"potm","vnd.ms-project":["mpp","mpt"],"vnd.ms-word.document.macroenabled.12":"docm","vnd.ms-word.template.macroenabled.12":"dotm","vnd.ms-works":["wps","wks","wcm","wdb"],"vnd.ms-wpl":"wpl","vnd.ms-xpsdocument":"xps","vnd.mseq":"mseq","vnd.musician":"mus","vnd.muvee.style":"msty","vnd.mynfc":"taglet","vnd.neurolanguage.nlu":"nlu","vnd.nitf":["ntf","nitf"],"vnd.noblenet-directory":"nnd","vnd.noblenet-sealer":"nns","vnd.noblenet-web":"nnw","vnd.nokia.n-gage.data":"ngdat","vnd.nokia.n-gage.symbian.install":"n-gage","vnd.nokia.radio-preset":"rpst","vnd.nokia.radio-presets":"rpss","vnd.novadigm.edm":"edm","vnd.novadigm.edx":"edx","vnd.novadigm.ext":"ext","vnd.oasis.opendocument.chart-template":"otc","vnd.oasis.opendocument.formula-template":"odft","vnd.oasis.opendocument.image-template":"oti","vnd.olpc-sugar":"xo","vnd.oma.dd2+xml":"dd2","vnd.openofficeorg.extension":"oxt","vnd.openxmlformats-officedocument.presentationml.slide":"sldx","vnd.osgeo.mapguide.package":"mgp","vnd.osgi.dp":"dp","vnd.osgi.subsystem":"esa","vnd.palm":["pdb","pqa","oprc"],"vnd.pawaafile":"paw","vnd.pg.format":"str","vnd.pg.osasli":"ei6","vnd.picsel":"efif","vnd.pmi.widget":"wg","vnd.pocketlearn":"plf","vnd.powerbuilder6":"pbd","vnd.previewsystems.box":"box","vnd.proteus.magazine":"mgz","vnd.publishare-delta-tree":"qps","vnd.pvi.ptid1":"ptid","vnd.quark.quarkxpress":["qxd","qxt","qwd","qwt","qxl","qxb"],"vnd.realvnc.bed":"bed","vnd.recordare.musicxml":"mxl","vnd.recordare.musicxml+xml":"musicxml","vnd.rig.cryptonote":"cryptonote","vnd.rn-realmedia":"rm","vnd.rn-realmedia-vbr":"rmvb","vnd.route66.link66+xml":"link66","vnd.sailingtracker.track":"st","vnd.seemail":"see","vnd.sema":"sema","vnd.semd":"semd","vnd.semf":"semf","vnd.shana.informed.formdata":"ifm","vnd.shana.informed.formtemplate":"itp","vnd.shana.informed.interchange":"iif","vnd.shana.informed.package":"ipk","vnd.simtech-mindmapper":["twd","twds"],"vnd.smart.teacher":"teacher","vnd.solent.sdkm+xml":["sdkm","sdkd"],"vnd.spotfire.dxp":"dxp","vnd.spotfire.sfs":"sfs","vnd.stepmania.package":"smzip","vnd.stepmania.stepchart":"sm","vnd.sus-calendar":["sus","susp"],"vnd.svd":"svd","vnd.syncml+xml":"xsm","vnd.syncml.dm+wbxml":"bdm","vnd.syncml.dm+xml":"xdm","vnd.tao.intent-module-archive":"tao","vnd.tcpdump.pcap":["pcap","cap","dmp"],"vnd.tmobile-livetv":"tmo","vnd.trid.tpt":"tpt","vnd.triscape.mxs":"mxs","vnd.trueapp":"tra","vnd.ufdl":["ufd","ufdl"],"vnd.uiq.theme":"utz","vnd.umajin":"umj","vnd.unity":"unityweb","vnd.uoml+xml":"uoml","vnd.vcx":"vcx","vnd.visionary":"vis","vnd.vsf":"vsf","vnd.webturbo":"wtb","vnd.wolfram.player":"nbp","vnd.wqd":"wqd","vnd.wt.stf":"stf","vnd.xara":"xar","vnd.xfdl":"xfdl","vnd.yamaha.hv-dic":"hvd","vnd.yamaha.hv-script":"hvs","vnd.yamaha.hv-voice":"hvp","vnd.yamaha.openscoreformat":"osf","vnd.yamaha.openscoreformat.osfpvg+xml":"osfpvg","vnd.yamaha.smaf-audio":"saf","vnd.yamaha.smaf-phrase":"spf","vnd.yellowriver-custom-menu":"cmp","vnd.zul":["zir","zirz"],"vnd.zzazz.deck+xml":"zaz","voicexml+xml":"vxml",widget:"wgt",winhlp:"hlp","wsdl+xml":"wsdl","wspolicy+xml":"wspolicy","x-ace-compressed":"ace","x-authorware-bin":["aab","x32","u32","vox"],"x-authorware-map":"aam","x-authorware-seg":"aas","x-blorb":["blb","blorb"],"x-bzip":"bz","x-bzip2":["bz2","boz"],"x-cfs-compressed":"cfs","x-chat":"chat","x-conference":"nsc","x-dgc-compressed":"dgc","x-dtbncx+xml":"ncx","x-dtbook+xml":"dtb","x-dtbresource+xml":"res","x-eva":"eva","x-font-bdf":"bdf","x-font-ghostscript":"gsf","x-font-linux-psf":"psf","x-font-pcf":"pcf","x-font-snf":"snf","x-font-ttf":["ttf","ttc"],"x-font-type1":["pfa","pfb","pfm","afm"],"x-freearc":"arc","x-gca-compressed":"gca","x-glulx":"ulx","x-gramps-xml":"gramps","x-install-instructions":"install","x-lzh-compressed":["lzh","lha"],"x-mie":"mie","x-mobipocket-ebook":["prc","mobi"],"x-ms-application":"application","x-ms-shortcut":"lnk","x-ms-xbap":"xbap","x-msbinder":"obd","x-mscardfile":"crd","x-msclip":"clp","application/x-ms-installer":"msi","x-msmediaview":["mvb","m13","m14"],"x-msmetafile":["wmf","wmz","emf","emz"],"x-msmoney":"mny","x-mspublisher":"pub","x-msschedule":"scd","x-msterminal":"trm","x-mswrite":"wri","x-nzb":"nzb","x-pkcs12":["p12","pfx"],"x-pkcs7-certificates":["p7b","spc"],"x-research-info-systems":"ris","x-silverlight-app":"xap","x-sql":"sql","x-stuffitx":"sitx","x-subrip":"srt","x-t3vm-image":"t3","x-tex-tfm":"tfm","x-tgif":"obj","x-xliff+xml":"xlf","x-xz":"xz","x-zmachine":["z1","z2","z3","z4","z5","z6","z7","z8"],"xaml+xml":"xaml","xcap-diff+xml":"xdf","xenc+xml":"xenc","xml-dtd":"dtd","xop+xml":"xop","xproc+xml":"xpl","xslt+xml":"xslt","xv+xml":["mxml","xhvml","xvml","xvm"],yang:"yang","yin+xml":"yin",envoy:"evy",fractals:"fif","internet-property-stream":"acx",olescript:"axs","vnd.ms-outlook":"msg","vnd.ms-pkicertstore":"sst","x-compress":"z","x-perfmon":["pma","pmc","pmr","pmw"],"ynd.ms-pkipko":"pko",gzip:["gz","tgz"],"smil+xml":["smi","smil"],"vnd.debian.binary-package":["deb","udeb"],"vnd.hzn-3d-crossword":"x3d","vnd.sqlite3":["db","sqlite","sqlite3","db-wal","sqlite-wal","db-shm","sqlite-shm"],"vnd.wap.sic":"sic","vnd.wap.slc":"slc","x-krita":["kra","krz"],"x-perl":["pm","pl"],yaml:["yaml","yml"]},audio:{amr:"amr","amr-wb":"awb",annodex:"axa",basic:["au","snd"],flac:"flac",midi:["mid","midi","kar","rmi"],mpeg:["mpga","mpega","mp3","m4a","mp2a","m2a","m3a"],mpegurl:"m3u",ogg:["oga","ogg","spx"],"prs.sid":"sid","x-aiff":"aifc","x-gsm":"gsm","x-ms-wma":"wma","x-ms-wax":"wax","x-pn-realaudio":"ram","x-realaudio":"ra","x-sd2":"sd2",adpcm:"adp",mp4:"mp4a",s3m:"s3m",silk:"sil","vnd.dece.audio":["uva","uvva"],"vnd.digital-winds":"eol","vnd.dra":"dra","vnd.dts":"dts","vnd.dts.hd":"dtshd","vnd.lucent.voice":"lvp","vnd.ms-playready.media.pya":"pya","vnd.nuera.ecelp4800":"ecelp4800","vnd.nuera.ecelp7470":"ecelp7470","vnd.nuera.ecelp9600":"ecelp9600","vnd.rip":"rip",webm:"weba","x-caf":"caf","x-matroska":"mka","x-pn-realaudio-plugin":"rmp",xm:"xm",aac:"aac",aiff:["aiff","aif","aff"],opus:"opus",wav:"wav"},chemical:{"x-alchemy":"alc","x-cache":["cac","cache"],"x-cache-csf":"csf","x-cactvs-binary":["cbin","cascii","ctab"],"x-cdx":"cdx","x-chem3d":"c3d","x-cif":"cif","x-cmdf":"cmdf","x-cml":"cml","x-compass":"cpa","x-crossfire":"bsd","x-csml":["csml","csm"],"x-ctx":"ctx","x-cxf":["cxf","cef"],"x-embl-dl-nucleotide":["emb","embl"],"x-gamess-input":["inp","gam","gamin"],"x-gaussian-checkpoint":["fch","fchk"],"x-gaussian-cube":"cub","x-gaussian-input":["gau","gjc","gjf"],"x-gaussian-log":"gal","x-gcg8-sequence":"gcg","x-genbank":"gen","x-hin":"hin","x-isostar":["istr","ist"],"x-jcamp-dx":["jdx","dx"],"x-kinemage":"kin","x-macmolecule":"mcm","x-macromodel-input":"mmod","x-mdl-molfile":"mol","x-mdl-rdfile":"rd","x-mdl-rxnfile":"rxn","x-mdl-sdfile":"sd","x-mdl-tgf":"tgf","x-mmcif":"mcif","x-mol2":"mol2","x-molconn-Z":"b","x-mopac-graph":"gpt","x-mopac-input":["mop","mopcrt","zmt"],"x-mopac-out":"moo","x-ncbi-asn1":"asn","x-ncbi-asn1-ascii":["prt","ent"],"x-ncbi-asn1-binary":"val","x-rosdal":"ros","x-swissprot":"sw","x-vamas-iso14976":"vms","x-vmd":"vmd","x-xtel":"xtel","x-xyz":"xyz"},font:{otf:"otf",woff:"woff",woff2:"woff2"},image:{gif:"gif",ief:"ief",jpeg:["jpeg","jpg","jpe","jfif","jfif-tbnl","jif"],pcx:"pcx",png:"png","svg+xml":["svg","svgz"],tiff:["tiff","tif"],"vnd.djvu":["djvu","djv"],"vnd.wap.wbmp":"wbmp","x-canon-cr2":"cr2","x-canon-crw":"crw","x-cmu-raster":"ras","x-coreldraw":"cdr","x-coreldrawpattern":"pat","x-coreldrawtemplate":"cdt","x-corelphotopaint":"cpt","x-epson-erf":"erf","x-icon":"ico","x-jg":"art","x-jng":"jng","x-nikon-nef":"nef","x-olympus-orf":"orf","x-portable-anymap":"pnm","x-portable-bitmap":"pbm","x-portable-graymap":"pgm","x-portable-pixmap":"ppm","x-rgb":"rgb","x-xbitmap":"xbm","x-xpixmap":"xpm","x-xwindowdump":"xwd",bmp:"bmp",cgm:"cgm",g3fax:"g3",ktx:"ktx","prs.btif":"btif",sgi:"sgi","vnd.dece.graphic":["uvi","uvvi","uvg","uvvg"],"vnd.dwg":"dwg","vnd.dxf":"dxf","vnd.fastbidsheet":"fbs","vnd.fpx":"fpx","vnd.fst":"fst","vnd.fujixerox.edmics-mmr":"mmr","vnd.fujixerox.edmics-rlc":"rlc","vnd.ms-modi":"mdi","vnd.ms-photo":"wdp","vnd.net-fpx":"npx","vnd.xiff":"xif",webp:"webp","x-3ds":"3ds","x-cmx":"cmx","x-freehand":["fh","fhc","fh4","fh5","fh7"],"x-pict":["pic","pct"],"x-tga":"tga","cis-cod":"cod",avif:"avifs",heic:["heif","heic"],pjpeg:["pjpg"],"vnd.adobe.photoshop":"psd","x-adobe-dng":"dng","x-fuji-raf":"raf","x-icns":"icns","x-kodak-dcr":"dcr","x-kodak-k25":"k25","x-kodak-kdc":"kdc","x-minolta-mrw":"mrw","x-panasonic-raw":["raw","rw2","rwl"],"x-pentax-pef":["pef","ptx"],"x-sigma-x3f":"x3f","x-sony-arw":"arw","x-sony-sr2":"sr2","x-sony-srf":"srf"},message:{rfc822:["eml","mime","mht","mhtml","nws"]},model:{iges:["igs","iges"],mesh:["msh","mesh","silo"],vrml:["wrl","vrml"],"x3d+vrml":["x3dv","x3dvz"],"x3d+xml":"x3dz","x3d+binary":["x3db","x3dbz"],"vnd.collada+xml":"dae","vnd.dwf":"dwf","vnd.gdl":"gdl","vnd.gtw":"gtw","vnd.mts":"mts","vnd.usdz+zip":"usdz","vnd.vtu":"vtu"},text:{"cache-manifest":["manifest","appcache"],calendar:["ics","icz","ifb"],css:"css",csv:"csv",h323:"323",html:["html","htm","shtml","stm"],iuls:"uls",plain:["txt","text","brf","conf","def","list","log","in","bas","diff","ksh"],richtext:"rtx",scriptlet:["sct","wsc"],texmacs:"tm","tab-separated-values":"tsv","vnd.sun.j2me.app-descriptor":"jad","vnd.wap.wml":"wml","vnd.wap.wmlscript":"wmls","x-bibtex":"bib","x-boo":"boo","x-c++hdr":["h++","hpp","hxx","hh"],"x-c++src":["c++","cpp","cxx","cc"],"x-component":"htc","x-dsrc":"d","x-diff":"patch","x-haskell":"hs","x-java":"java","x-literate-haskell":"lhs","x-moc":"moc","x-pascal":["p","pas","pp","inc"],"x-pcs-gcd":"gcd","x-python":"py","x-scala":"scala","x-setext":"etx","x-tcl":["tcl","tk"],"x-tex":["tex","ltx","sty","cls"],"x-vcalendar":"vcs","x-vcard":"vcf",n3:"n3","prs.lines.tag":"dsc",sgml:["sgml","sgm"],troff:["t","tr","roff","man","me","ms"],turtle:"ttl","uri-list":["uri","uris","urls"],vcard:"vcard","vnd.curl":"curl","vnd.curl.dcurl":"dcurl","vnd.curl.scurl":"scurl","vnd.curl.mcurl":"mcurl","vnd.dvb.subtitle":"sub","vnd.fly":"fly","vnd.fmi.flexstor":"flx","vnd.graphviz":"gv","vnd.in3d.3dml":"3dml","vnd.in3d.spot":"spot","x-asm":["s","asm"],"x-c":["c","h","dic"],"x-fortran":["f","for","f77","f90"],"x-opml":"opml","x-nfo":"nfo","x-sfv":"sfv","x-uuencode":"uu",webviewhtml:"htt",javascript:"js",json:"json",markdown:["md","markdown","mdown","markdn"],"vnd.wap.si":"si","vnd.wap.sl":"sl"},video:{avif:"avif","3gpp":"3gp",annodex:"axv",dl:"dl",dv:["dif","dv"],fli:"fli",gl:"gl",mpeg:["mpeg","mpg","mpe","m1v","m2v","mp2","mpa","mpv2"],mp4:["mp4","mp4v","mpg4"],quicktime:["qt","mov"],ogg:"ogv","vnd.mpegurl":["mxu","m4u"],"x-flv":"flv","x-la-asf":["lsf","lsx"],"x-mng":"mng","x-ms-asf":["asf","asx","asr"],"x-ms-wm":"wm","x-ms-wmv":"wmv","x-ms-wmx":"wmx","x-ms-wvx":"wvx","x-msvideo":"avi","x-sgi-movie":"movie","x-matroska":["mpv","mkv","mk3d","mks"],"3gpp2":"3g2",h261:"h261",h263:"h263",h264:"h264",jpeg:"jpgv",jpm:["jpm","jpgm"],mj2:["mj2","mjp2"],"vnd.dece.hd":["uvh","uvvh"],"vnd.dece.mobile":["uvm","uvvm"],"vnd.dece.pd":["uvp","uvvp"],"vnd.dece.sd":["uvs","uvvs"],"vnd.dece.video":["uvv","uvvv"],"vnd.dvb.file":"dvb","vnd.fvt":"fvt","vnd.ms-playready.media.pyv":"pyv","vnd.uvvu.mp4":["uvu","uvvu"],"vnd.vivo":"viv",webm:"webm","x-f4v":"f4v","x-m4v":"m4v","x-ms-vob":"vob","x-smv":"smv",mp2t:"ts"},"x-conference":{"x-cooltalk":"ice"},"x-world":{"x-vrml":["vrm","flr","wrz","xaf","xof"]}};(()=>{const t={};for(const n of Object.keys(nM))for(const e of Object.keys(nM[n])){const i=nM[n][e];if("string"==typeof i)t[i]=n+"/"+e;else for(let r=0;r<i.length;r++)t[i[r]]=n+"/"+e}})();const PR=[];for(let t=0;t<256;t++){let n=t;for(let e=0;e<8;e++)1&n?n=n>>>1^3988292384:n>>>=1;PR[t]=n}class hx{constructor(n){this.crc=n||-1}append(n){let e=0|this.crc;for(let i=0,r=0|n.length;i<r;i++)e=e>>>8^PR[255&(e^n[i])];this.crc=e}get(){return~this.crc}}class FR extends TransformStream{constructor(){let n;const e=new hx;super({transform(i,r){e.append(i),r.enqueue(i)},flush(){const i=new Uint8Array(4);new DataView(i.buffer).setUint32(0,e.get()),n.value=i}}),n=this}}function fx(t){if(typeof TextEncoder==Vh){t=unescape(encodeURIComponent(t));const n=new Uint8Array(t.length);for(let e=0;e<n.length;e++)n[e]=t.charCodeAt(e);return n}return(new TextEncoder).encode(t)}const wa={concat(t,n){if(0===t.length||0===n.length)return t.concat(n);const e=t[t.length-1],i=wa.getPartial(e);return 32===i?t.concat(n):wa._shiftRight(n,i,0|e,t.slice(0,t.length-1))},bitLength(t){const n=t.length;return 0===n?0:32*(n-1)+wa.getPartial(t[n-1])},clamp(t,n){if(32*t.length<n)return t;const e=(t=t.slice(0,Math.ceil(n/32))).length;return n&=31,e>0&&n&&(t[e-1]=wa.partial(n,t[e-1]&2147483648>>n-1,1)),t},partial:(t,n,e)=>32===t?n:(e?0|n:n<<32-t)+1099511627776*t,getPartial:t=>Math.round(t/1099511627776)||32,_shiftRight(t,n,e,i){for(void 0===i&&(i=[]);n>=32;n-=32)i.push(e),e=0;if(0===n)return i.concat(t);for(let s=0;s<t.length;s++)i.push(e|t[s]>>>n),e=t[s]<<32-n;const o=wa.getPartial(t.length?t[t.length-1]:0);return i.push(wa.partial(n+o&31,n+o>32?e:i.pop(),1)),i}},px={bytes:{fromBits(t){const e=wa.bitLength(t)/8,i=new Uint8Array(e);let r;for(let o=0;o<e;o++)3&o||(r=t[o/4]),i[o]=r>>>24,r<<=8;return i},toBits(t){const n=[];let e,i=0;for(e=0;e<t.length;e++)i=i<<8|t[e],!(3&~e)&&(n.push(i),i=0);return 3&e&&n.push(wa.partial(8*(3&e),i)),n}}},NR_sha1=class{constructor(t){const n=this;n.blockSize=512,n._init=[1732584193,4023233417,2562383102,271733878,3285377520],n._key=[1518500249,1859775393,2400959708,3395469782],t?(n._h=t._h.slice(0),n._buffer=t._buffer.slice(0),n._length=t._length):n.reset()}reset(){const t=this;return t._h=t._init.slice(0),t._buffer=[],t._length=0,t}update(t){const n=this;"string"==typeof t&&(t=px.utf8String.toBits(t));const e=n._buffer=wa.concat(n._buffer,t),i=n._length,r=n._length=i+wa.bitLength(t);if(r>9007199254740991)throw new Error("Cannot hash more than 2^53 - 1 bits");const o=new Uint32Array(e);let s=0;for(let a=n.blockSize+i-(n.blockSize+i&n.blockSize-1);a<=r;a+=n.blockSize)n._block(o.subarray(16*s,16*(s+1))),s+=1;return e.splice(0,16*s),n}finalize(){const t=this;let n=t._buffer;const e=t._h;n=wa.concat(n,[wa.partial(1,1)]);for(let i=n.length+2;15&i;i++)n.push(0);for(n.push(Math.floor(t._length/4294967296)),n.push(0|t._length);n.length;)t._block(n.splice(0,16));return t.reset(),e}_f(t,n,e,i){return t<=19?n&e|~n&i:t<=39?n^e^i:t<=59?n&e|n&i|e&i:t<=79?n^e^i:void 0}_S(t,n){return n<<t|n>>>32-t}_block(t){const n=this,e=n._h,i=Array(80);for(let u=0;u<16;u++)i[u]=t[u];let r=e[0],o=e[1],s=e[2],a=e[3],l=e[4];for(let u=0;u<=79;u++){u>=16&&(i[u]=n._S(1,i[u-3]^i[u-8]^i[u-14]^i[u-16]));const f=n._S(5,r)+n._f(u,o,s,a)+l+i[u]+n._key[Math.floor(u/20)]|0;l=a,a=s,s=n._S(30,o),o=r,r=f}e[0]=e[0]+r|0,e[1]=e[1]+o|0,e[2]=e[2]+s|0,e[3]=e[3]+a|0,e[4]=e[4]+l|0}},RR_aes=class{constructor(t){const n=this;n._tables=[[[],[],[],[],[]],[[],[],[],[],[]]],n._tables[0][0][0]||n._precompute();const e=n._tables[0][4],i=n._tables[1],r=t.length;let o,s,a,l=1;if(4!==r&&6!==r&&8!==r)throw new Error("invalid aes key size");for(n._key=[s=t.slice(0),a=[]],o=r;o<4*r+28;o++){let u=s[o-1];(o%r==0||8===r&&o%r==4)&&(u=e[u>>>24]<<24^e[u>>16&255]<<16^e[u>>8&255]<<8^e[255&u],o%r==0&&(u=u<<8^u>>>24^l<<24,l=l<<1^283*(l>>7))),s[o]=s[o-r]^u}for(let u=0;o;u++,o--){const f=s[3&u?o:o-4];a[u]=o<=4||u<4?f:i[0][e[f>>>24]]^i[1][e[f>>16&255]]^i[2][e[f>>8&255]]^i[3][e[255&f]]}}encrypt(t){return this._crypt(t,0)}decrypt(t){return this._crypt(t,1)}_precompute(){const t=this._tables[0],n=this._tables[1],e=t[4],i=n[4],r=[],o=[];let s,a,l,u;for(let f=0;f<256;f++)o[(r[f]=f<<1^283*(f>>7))^f]=f;for(let f=s=0;!e[f];f^=a||1,s=o[s]||1){let g=s^s<<1^s<<2^s<<3^s<<4;g=g>>8^255&g^99,e[f]=g,i[g]=f,u=r[l=r[a=r[f]]];let v=16843009*u^65537*l^257*a^16843008*f,C=257*r[g]^16843008*g;for(let E=0;E<4;E++)t[E][f]=C=C<<24^C>>>8,n[E][g]=v=v<<24^v>>>8}for(let f=0;f<5;f++)t[f]=t[f].slice(0),n[f]=n[f].slice(0)}_crypt(t,n){if(4!==t.length)throw new Error("invalid aes block size");const e=this._key[n],i=e.length/4-2,r=[0,0,0,0],o=this._tables[n],s=o[0],a=o[1],l=o[2],u=o[3],f=o[4];let T,M,S,g=t[0]^e[0],v=t[n?3:1]^e[1],C=t[2]^e[2],E=t[n?1:3]^e[3],w=4;for(let P=0;P<i;P++)T=s[g>>>24]^a[v>>16&255]^l[C>>8&255]^u[255&E]^e[w],M=s[v>>>24]^a[C>>16&255]^l[E>>8&255]^u[255&g]^e[w+1],S=s[C>>>24]^a[E>>16&255]^l[g>>8&255]^u[255&v]^e[w+2],E=s[E>>>24]^a[g>>16&255]^l[v>>8&255]^u[255&C]^e[w+3],w+=4,g=T,v=M,C=S;for(let P=0;P<4;P++)r[n?3&-P:P]=f[g>>>24]<<24^f[v>>16&255]<<16^f[C>>8&255]<<8^f[255&E]^e[w++],T=g,g=v,v=C,C=E,E=T;return r}},MQ={getRandomValues(t){const n=new Uint32Array(t.buffer),e=i=>{let r=987654321;const o=4294967295;return function(){return r=36969*(65535&r)+(r>>16)&o,(((r<<16)+(i=18e3*(65535&i)+(i>>16)&o)&o)/4294967296+.5)*(Math.random()>.5?1:-1)}};for(let r,i=0;i<t.length;i+=4){const o=e(4294967296*(r||Math.random()));r=987654071*o(),n[i/4]=4294967296*o()|0}return t}},LR_ctrGladman=class{constructor(t,n){this._prf=t,this._initIv=n,this._iv=n}reset(){this._iv=this._initIv}update(t){return this.calculate(this._prf,t,this._iv)}incWord(t){if(255&~(t>>24))t+=1<<24;else{let n=t>>16&255,e=t>>8&255,i=255&t;255===n?(n=0,255===e?(e=0,255===i?i=0:++i):++e):++n,t=0,t+=n<<16,t+=e<<8,t+=i}return t}incCounter(t){0===(t[0]=this.incWord(t[0]))&&(t[1]=this.incWord(t[1]))}calculate(t,n,e){let i;if(!(i=n.length))return[];const r=wa.bitLength(n);for(let o=0;o<i;o+=4){this.incCounter(e);const s=t.encrypt(e);n[o]^=s[0],n[o+1]^=s[1],n[o+2]^=s[2],n[o+3]^=s[3]}return wa.clamp(n,r)}},Cp={importKey:t=>new Cp.hmacSha1(px.bytes.toBits(t)),pbkdf2(t,n,e,i){if(e=e||1e4,i<0||e<0)throw new Error("invalid params to pbkdf2");const r=1+(i>>5)<<2;let o,s,a,l,u;const f=new ArrayBuffer(r),g=new DataView(f);let v=0;const C=wa;for(n=px.bytes.toBits(n),u=1;v<(r||1);u++){for(o=s=t.encrypt(C.concat(n,[u])),a=1;a<e;a++)for(s=t.encrypt(s),l=0;l<s.length;l++)o[l]^=s[l];for(a=0;v<(r||1)&&a<o.length;a++)g.setInt32(v,o[a]),v+=4}return f.slice(0,i/8)},hmacSha1:class{constructor(t){const n=this,e=n._hash=NR_sha1,i=[[],[]];n._baseHash=[new e,new e];const r=n._baseHash[0].blockSize/32;t.length>r&&(t=(new e).update(t).finalize());for(let o=0;o<r;o++)i[0][o]=909522486^t[o],i[1][o]=1549556828^t[o];n._baseHash[0].update(i[0]),n._baseHash[1].update(i[1]),n._resultHash=new e(n._baseHash[0])}reset(){const t=this;t._resultHash=new t._hash(t._baseHash[0]),t._updated=!1}update(t){this._updated=!0,this._resultHash.update(t)}digest(){const t=this,n=t._resultHash.finalize(),e=new t._hash(t._baseHash[1]).update(n).finalize();return t.reset(),e}encrypt(t){if(this._updated)throw new Error("encrypt on already updated hmac called!");return this.update(t),this.digest(t)}}},DQ=typeof crypto!=Vh&&typeof crypto.getRandomValues==$b,iM="Invalid password",BR="Invalid signature",rM="zipjs-abort-check-password";function UR(t){return DQ?crypto.getRandomValues(t):MQ.getRandomValues(t)}const OQ="raw",HR={name:"PBKDF2"},PQ=Object.assign({hash:{name:"HMAC"}},HR),oM=Object.assign({iterations:1e3,hash:{name:"SHA-1"}},HR),FQ=["deriveBits"],Yb=[8,12,16],qb=[16,24,32],NQ=[0,0,0,0],gx=typeof crypto!=Vh,Zb=gx&&crypto.subtle,zR=gx&&typeof Zb!=Vh,Cu=px.bytes,RQ=RR_aes,LQ=LR_ctrGladman,BQ=Cp.hmacSha1;let VR=gx&&zR&&typeof Zb.importKey==$b,jR=gx&&zR&&typeof Zb.deriveBits==$b;class UQ extends TransformStream{constructor({password:n,rawPassword:e,signed:i,encryptionStrength:r,checkPasswordOnly:o}){super({start(){Object.assign(this,{ready:new Promise(s=>this.resolveReady=s),password:$R(n,e),signed:i,strength:r-1,pending:new Uint8Array})},transform(s,a){var l=this;return(0,R.A)(function*(){const u=l,{password:f,strength:g,resolveReady:v,ready:C}=u;f?(yield function zQ(t,n,e,i){return sM.apply(this,arguments)}(u,g,f,rc(s,0,Yb[g]+2)),s=rc(s,Yb[g]+2),o?a.error(new Error(rM)):v()):yield C;const E=new Uint8Array(s.length-10-(s.length-10)%16);a.enqueue(GR(u,s,E,0,10,!0))})()},flush(s){var a=this;return(0,R.A)(function*(){const{signed:l,ctr:u,hmac:f,pending:g,ready:v}=a;if(f&&u){yield v;const C=rc(g,0,g.length-10),E=rc(g,g.length-10);let w=new Uint8Array;if(C.length){const T=Kb(Cu,C);f.update(T);const M=u.update(T);w=Xb(Cu,M)}if(l){const T=rc(Xb(Cu,f.digest()),0,10);for(let M=0;M<10;M++)if(T[M]!=E[M])throw new Error(BR)}s.enqueue(w)}})()}})}}class HQ extends TransformStream{constructor({password:n,rawPassword:e,encryptionStrength:i}){let r;super({start(){Object.assign(this,{ready:new Promise(o=>this.resolveReady=o),password:$R(n,e),strength:i-1,pending:new Uint8Array})},transform(o,s){var a=this;return(0,R.A)(function*(){const l=a,{password:u,strength:f,resolveReady:g,ready:v}=l;let C=new Uint8Array;u?(C=yield function VQ(t,n,e){return aM.apply(this,arguments)}(l,f,u),g()):yield v;const E=new Uint8Array(C.length+o.length-o.length%16);E.set(C,0),s.enqueue(GR(l,o,E,C.length,0))})()},flush(o){var s=this;return(0,R.A)(function*(){const{ctr:a,hmac:l,pending:u,ready:f}=s;if(l&&a){yield f;let g=new Uint8Array;if(u.length){const v=a.update(Kb(Cu,u));l.update(v),g=Xb(Cu,v)}r.signature=Xb(Cu,l.digest()).slice(0,10),o.enqueue(dM(g,r.signature))}})()}}),r=this}}function GR(t,n,e,i,r,o){const{ctr:s,hmac:a,pending:l}=t,u=n.length-r;let f;for(l.length&&(n=dM(l,n),e=function WQ(t,n){if(n&&n>t.length){const e=t;(t=new Uint8Array(n)).set(e,0)}return t}(e,u-u%16)),f=0;f<=u-16;f+=16){const g=Kb(Cu,rc(n,f,f+16));o&&a.update(g);const v=s.update(g);o||a.update(v),e.set(Xb(Cu,v),f+i)}return t.pending=rc(n,f),e}function sM(){return sM=(0,R.A)(function*(t,n,e,i){const r=yield WR(t,n,e,rc(i,0,Yb[n])),o=rc(i,Yb[n]);if(r[0]!=o[0]||r[1]!=o[1])throw new Error(iM)}),sM.apply(this,arguments)}function aM(){return aM=(0,R.A)(function*(t,n,e){const i=UR(new Uint8Array(Yb[n]));return dM(i,yield WR(t,n,e,i))}),aM.apply(this,arguments)}function WR(t,n,e,i){return lM.apply(this,arguments)}function lM(){return lM=(0,R.A)(function*(t,n,e,i){t.password=null;const r=yield function jQ(t,n,e,i,r){return cM.apply(this,arguments)}(OQ,e,PQ,!1,FQ),o=yield function GQ(t,n,e){return uM.apply(this,arguments)}(Object.assign({salt:i},oM),r,8*(2*qb[n]+2)),s=new Uint8Array(o),a=Kb(Cu,rc(s,0,qb[n])),l=Kb(Cu,rc(s,qb[n],2*qb[n])),u=rc(s,2*qb[n]);return Object.assign(t,{keys:{key:a,authentication:l,passwordVerification:u},ctr:new LQ(new RQ(a),Array.from(NQ)),hmac:new BQ(l)}),u}),lM.apply(this,arguments)}function cM(){return cM=(0,R.A)(function*(t,n,e,i,r){if(!VR)return Cp.importKey(n);try{return yield Zb.importKey(t,n,e,i,r)}catch{return VR=!1,Cp.importKey(n)}}),cM.apply(this,arguments)}function uM(){return uM=(0,R.A)(function*(t,n,e){if(!jR)return Cp.pbkdf2(n,t.salt,oM.iterations,e);try{return yield Zb.deriveBits(t,n,e)}catch{return jR=!1,Cp.pbkdf2(n,t.salt,oM.iterations,e)}}),uM.apply(this,arguments)}function $R(t,n){return n===ii?fx(t):n}function dM(t,n){let e=t;return t.length+n.length&&(e=new Uint8Array(t.length+n.length),e.set(t,0),e.set(n,t.length)),e}function rc(t,n,e){return t.subarray(n,e)}function Xb(t,n){return t.fromBits(n)}function Kb(t,n){return t.toBits(n)}class $Q extends TransformStream{constructor({password:n,passwordVerification:e,checkPasswordOnly:i}){super({start(){Object.assign(this,{password:n,passwordVerification:e}),ZR(this,n)},transform(r,o){const s=this;if(s.password){const a=YR(s,r.subarray(0,12));if(s.password=null,a[11]!=s.passwordVerification)throw new Error(iM);r=r.subarray(12)}i?o.error(new Error(rM)):o.enqueue(YR(s,r))}})}}class YQ extends TransformStream{constructor({password:n,passwordVerification:e}){super({start(){Object.assign(this,{password:n,passwordVerification:e}),ZR(this,n)},transform(i,r){const o=this;let s,a;if(o.password){o.password=null;const l=UR(new Uint8Array(12));l[11]=o.passwordVerification,s=new Uint8Array(i.length+l.length),s.set(qR(o,l),0),a=12}else s=new Uint8Array(i.length),a=0;s.set(qR(o,i),a),r.enqueue(s)}})}}function YR(t,n){const e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=XR(t)^n[i],hM(t,e[i]);return e}function qR(t,n){const e=new Uint8Array(n.length);for(let i=0;i<n.length;i++)e[i]=XR(t)^n[i],hM(t,n[i]);return e}function ZR(t,n){const e=[305419896,591751049,878082192];Object.assign(t,{keys:e,crcKey0:new hx(e[0]),crcKey2:new hx(e[2])});for(let i=0;i<n.length;i++)hM(t,n.charCodeAt(i))}function hM(t,n){let[e,i,r]=t.keys;t.crcKey0.append([n]),e=~t.crcKey0.get(),i=QR(Math.imul(QR(i+KR(e)),134775813)+1),t.crcKey2.append([i>>>24]),r=~t.crcKey2.get(),t.keys=[e,i,r]}function XR(t){const n=2|t.keys[2];return KR(Math.imul(n,1^n)>>>8)}function KR(t){return 255&t}function QR(t){return 4294967295&t}const JR="Invalid uncompressed size",e8="deflate-raw";class qQ extends TransformStream{constructor(n,{chunkSize:e,CompressionStream:i,CompressionStreamNative:r}){super({});const{compressed:o,encrypted:s,useCompressionStream:a,zipCrypto:l,signed:u,level:f}=n,g=this;let v,C,E=super.readable;(!s||l)&&u&&(v=new FR,E=wd(E,v)),o&&(E=n8(E,a,{level:f,chunkSize:e},r,i)),s&&(l?E=wd(E,new YQ(n)):(C=new HQ(n),E=wd(E,C))),t8(g,E,()=>{let w;s&&!l&&(w=C.signature),(!s||l)&&u&&(w=new DataView(v.value.buffer).getUint32(0)),g.signature=w})}}class ZQ extends TransformStream{constructor(n,{chunkSize:e,DecompressionStream:i,DecompressionStreamNative:r}){super({});const{zipCrypto:o,encrypted:s,signed:a,signature:l,compressed:u,useCompressionStream:f}=n;let g,v,C=super.readable;s&&(o?C=wd(C,new $Q(n)):(v=new UQ(n),C=wd(C,v))),u&&(C=n8(C,f,{chunkSize:e},r,i)),(!s||o)&&a&&(g=new FR,C=wd(C,g)),t8(this,C,()=>{if((!s||o)&&a){const E=new DataView(g.value.buffer);if(l!=E.getUint32(0,!1))throw new Error(BR)}})}}function t8(t,n,e){n=wd(n,new TransformStream({flush:e})),Object.defineProperty(t,"readable",{get:()=>n})}function n8(t,n,e,i,r){try{t=wd(t,new(n&&i?i:r)(e8,e))}catch(o){if(!n)throw o;t=wd(t,new r(e8,e))}return t}function wd(t,n){return t.pipeThrough(n)}const KQ="start",QQ="pull",i8="data",JQ="ack",r8="close",o8="deflate",s8="inflate";class eJ extends TransformStream{constructor(n,e){super({});const i=this,{codecType:r}=n;let o;r.startsWith(o8)?o=qQ:r.startsWith(s8)&&(o=ZQ),i.outputSize=0;let s=0;const a=new o(n,e),l=super.readable,u=new TransformStream({transform(g,v){g&&g.length&&(s+=g.length,v.enqueue(g))},flush(){Object.assign(i,{inputSize:s})}}),f=new TransformStream({transform(g,v){if(g&&g.length&&(v.enqueue(g),i.outputSize+=g.length,n.outputSize&&i.outputSize>n.outputSize))throw new Error(JR)},flush(){const{signature:g}=a;Object.assign(i,{signature:g,inputSize:s})}});Object.defineProperty(i,"readable",{get:()=>l.pipeThrough(u).pipeThrough(a).pipeThrough(f)})}}class tJ extends TransformStream{constructor(n){let e;super({transform:function i(r,o){if(e){const s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),r=s,e=null}r.length>n?(o.enqueue(r.slice(0,n)),i(r.slice(n),o)):e=r},flush(r){e&&e.length&&r.enqueue(e)}})}}let a8=typeof Worker!=Vh;class fM{constructor(n,{readable:e,writable:i},{options:r,config:o,streamOptions:s,useWebWorkers:a,transferStreams:l,scripts:u},f){const{signal:g}=s;return Object.assign(n,{busy:!0,readable:e.pipeThrough(new tJ(o.chunkSize)).pipeThrough(new nJ(s),{signal:g}),writable:i,options:Object.assign({},r),scripts:u,transferStreams:l,terminate:()=>new Promise(v=>{const{worker:C,busy:E}=n;C?(E?n.resolveTerminated=v:(C.terminate(),v()),n.interface=null):v()}),onTaskFinished(){const{resolveTerminated:v}=n;v&&(n.resolveTerminated=null,n.terminated=!0,n.worker.terminate(),v()),n.busy=!1,f(n)}}),(a&&a8?iJ:l8)(n,o)}}class nJ extends TransformStream{constructor({onstart:n,onprogress:e,size:i,onend:r}){let o=0;super({start:()=>(0,R.A)(function*(){n&&(yield pM(n,i))})(),transform:(s,a)=>(0,R.A)(function*(){o+=s.length,e&&(yield pM(e,o,i)),a.enqueue(s)})(),flush:()=>(0,R.A)(function*(){r&&(yield pM(r,o))})()})}}function pM(t){return gM.apply(this,arguments)}function gM(){return gM=(0,R.A)(function*(t,...n){try{yield t(...n)}catch{}}),gM.apply(this,arguments)}function l8(t,n){return{run:()=>function rJ(t,n){return mM.apply(this,arguments)}(t,n)}}function iJ(t,n){const{baseURL:e,chunkSize:i}=n;if(!t.interface){let r;try{r=function aJ(t,n,e){const i={type:"module"};let r,o;typeof t==$b&&(t=t());try{r=new URL(t,n)}catch{r=t}if(c8)try{o=new Worker(r)}catch{c8=!1,o=new Worker(r,i)}else o=new Worker(r,i);return o.addEventListener("message",s=>function lJ(t,n){return bM.apply(this,arguments)}(s,e)),o}(t.scripts[0],e,t)}catch{return a8=!1,l8(t,n)}Object.assign(t,{worker:r,interface:{run:()=>function oJ(t,n){return _M.apply(this,arguments)}(t,{chunkSize:i})}})}return t.interface}function mM(){return mM=(0,R.A)(function*({options:t,readable:n,writable:e,onTaskFinished:i},r){let o;try{o=new eJ(t,r),yield n.pipeThrough(o).pipeTo(e,{preventClose:!0,preventAbort:!0});const{signature:s,inputSize:a,outputSize:l}=o;return{signature:s,inputSize:a,outputSize:l}}catch(s){throw o&&(s.outputSize=o.outputSize),s}finally{i()}}),mM.apply(this,arguments)}function _M(){return _M=(0,R.A)(function*(t,n){let e,i;const r=new Promise((v,C)=>{e=v,i=C});Object.assign(t,{reader:null,writer:null,resolveResult:e,rejectResult:i,result:r});const{readable:o,options:s,scripts:a}=t,{writable:l,closed:u}=function sJ(t){let n;const e=new Promise(r=>n=r);return{writable:new WritableStream({write:r=>(0,R.A)(function*(){const o=t.getWriter();yield o.ready,yield o.write(r),o.releaseLock()})(),close(){n()},abort:r=>t.getWriter().abort(r)}),closed:e}}(t.writable),f=mx({type:KQ,scripts:a.slice(1),options:s,config:n,readable:o,writable:l},t);f||Object.assign(t,{reader:o.getReader(),writer:l.getWriter()});const g=yield r;return f||(yield l.getWriter().close()),yield u,g}),_M.apply(this,arguments)}let c8=!0,u8=!0;function mx(t,{worker:n,writer:e,onTaskFinished:i,transferStreams:r}){try{const{value:o,readable:s,writable:a}=t,l=[];if(o&&(t.value=o.byteLength<o.buffer.byteLength?o.buffer.slice(0,o.byteLength):o.buffer,l.push(t.value)),r&&u8?(s&&l.push(s),a&&l.push(a)):t.readable=t.writable=null,l.length)try{return n.postMessage(t,l),!0}catch{u8=!1,t.readable=t.writable=null,n.postMessage(t)}else n.postMessage(t)}catch(o){throw e&&e.releaseLock(),i(),o}}function bM(){return bM=(0,R.A)(function*({data:t},n){const{type:e,value:i,messageId:r,result:o,error:s}=t,{reader:a,writer:l,resolveResult:u,rejectResult:f,onTaskFinished:g}=n;try{if(s){const{message:C,stack:E,code:w,name:T,outputSize:M}=s,S=new Error(C);Object.assign(S,{stack:E,code:w,name:T,outputSize:M}),v(S)}else{if(e==QQ){const{value:C,done:E}=yield a.read();mx({type:i8,value:C,done:E,messageId:r},n)}e==i8&&(yield l.ready,yield l.write(new Uint8Array(i)),mx({type:JQ,messageId:r},n)),e==r8&&v(null,o)}}catch(C){mx({type:r8,messageId:r},n),v(C)}function v(C,E){C?f(C):u(E),l&&l.releaseLock(),g()}}),bM.apply(this,arguments)}let $h=[];const vM=[];let d8=0;function h8(t,n){return yM.apply(this,arguments)}function yM(){return yM=(0,R.A)(function*(t,n){const{options:e,config:i}=n,{transferStreams:r,useWebWorkers:o,useCompressionStream:s,codecType:a,compressed:l,signed:u,encrypted:f}=e,{workerScripts:g,maxWorkers:v}=i;return n.transferStreams=r||r===ii,n.useWebWorkers=!!(l||u||f||n.transferStreams)&&(o||o===ii&&i.useWebWorkers),n.scripts=n.useWebWorkers&&g?g[a]:[],e.useCompressionStream=s||s===ii&&i.useCompressionStream,(yield function E(){return w.apply(this,arguments)}()).run();function w(){return(w=(0,R.A)(function*(){const M=$h.find(S=>!S.busy);if(M)return CM(M),new fM(M,t,n,T);if($h.length<v){const S={indexWorker:d8};return d8++,$h.push(S),new fM(S,t,n,T)}return new Promise(S=>vM.push({resolve:S,stream:t,workerOptions:n}))})).apply(this,arguments)}function T(M){if(vM.length){const[{resolve:S,stream:P,workerOptions:Z}]=vM.splice(0,1);S(new fM(M,P,Z,T))}else M.worker?(CM(M),function cJ(t,n){const{config:e}=n,{terminateWorkerTimeout:i}=e;Number.isFinite(i)&&i>=0&&(t.terminated?t.terminated=!1:t.terminateTimeout=setTimeout((0,R.A)(function*(){$h=$h.filter(r=>r!=t);try{yield t.terminate()}catch{}}),i))}(M,n)):$h=$h.filter(S=>S!=M)}}),yM.apply(this,arguments)}function CM(t){const{terminateTimeout:n}=t;n&&(clearTimeout(n),t.terminateTimeout=null)}const CJ=65536,EM="writable";class bx{constructor(){this.size=0}init(){this.initialized=!0}}class Yh extends bx{get readable(){const n=this,{chunkSize:e=CJ}=n,i=new ReadableStream({start(){this.chunkOffset=0},pull(r){var o=this;return(0,R.A)(function*(){const{offset:s=0,size:a,diskNumberStart:l}=i,{chunkOffset:u}=o,f=a===ii?e:Math.min(e,a-u),g=yield As(n,s+u,f,l);r.enqueue(g),u+e>a||a===ii&&!g.length&&f?r.close():o.chunkOffset+=e})()}});return i}}class qh extends Yh{constructor(n){super(),Object.assign(this,{blob:n,size:n.size})}readUint8Array(n,e){var i=this;return(0,R.A)(function*(){const r=i,o=n+e;let a=yield(n||o<r.size?r.blob.slice(n,o):r.blob).arrayBuffer();return a.byteLength>e&&(a=a.slice(n,o)),new Uint8Array(a)})()}}class Zh extends bx{constructor(n){super();const i=new TransformStream,r=[];n&&r.push(["Content-Type",n]),Object.defineProperty(this,EM,{get:()=>i.writable}),this.blob=new Response(i.readable,{headers:r}).blob()}getData(){return this.blob}}class EJ extends Yh{constructor(n){super(),this.readers=n}init(){var n=()=>super.init,e=this;return(0,R.A)(function*(){const i=e,{readers:r}=i;i.lastDiskNumber=0,i.lastDiskOffset=0,yield Promise.all(r.map(function(){var o=(0,R.A)(function*(s,a){yield s.init(),a!=r.length-1&&(i.lastDiskOffset+=s.size),i.size+=s.size});return function(s,a){return o.apply(this,arguments)}}())),n().call(e)})()}readUint8Array(n,e,i=0){var r=this;return(0,R.A)(function*(){const o=r,{readers:s}=r;let a,l=i;-1==l&&(l=s.length-1);let u=n;for(;s[l]&&u>=s[l].size;)u-=s[l].size,l++;const f=s[l];if(f){const g=f.size;if(u+e<=g)a=yield As(f,u,e);else{const v=g-u;a=new Uint8Array(e);const C=yield As(f,u,v);a.set(C,0);const E=yield o.readUint8Array(n+v,e-v,i);a.set(E,v),C.length+E.length<e&&(a=a.subarray(0,C.length+E.length))}}else a=new Uint8Array;return o.lastDiskNumber=Math.max(l,o.lastDiskNumber),a})()}}class I8 extends bx{constructor(n,e=4294967295){super();const i=this;let r,o,s;Object.assign(i,{diskNumber:0,diskOffset:0,size:0,maxSize:e,availableSize:e});const a=new WritableStream({write(v){var C=this;return(0,R.A)(function*(){const{availableSize:E}=i;if(s)v.length>=E?(yield l(v.subarray(0,E)),yield f(),i.diskOffset+=r.size,i.diskNumber++,s=null,yield C.write(v.subarray(E))):yield l(v);else{const{value:w,done:T}=yield n.next();if(T&&!w)throw new Error("Writer iterator completed too soon");r=w,r.size=0,r.maxSize&&(i.maxSize=r.maxSize),i.availableSize=i.maxSize,yield Ol(r),o=w.writable,s=o.getWriter(),yield C.write(v)}})()},close:()=>(0,R.A)(function*(){yield s.ready,yield f()})()});function l(v){return u.apply(this,arguments)}function u(){return(u=(0,R.A)(function*(v){const C=v.length;C&&(yield s.ready,yield s.write(v),r.size+=C,i.size+=C,i.availableSize-=C)})).apply(this,arguments)}function f(){return g.apply(this,arguments)}function g(){return(g=(0,R.A)(function*(){yield s.close()})).apply(this,arguments)}Object.defineProperty(i,EM,{get:()=>a})}}class UM{constructor(n){return Array.isArray(n)&&(n=new EJ(n)),n instanceof ReadableStream&&(n={readable:n}),n}}class S8{constructor(n){return n.writable===ii&&typeof n.next==$b&&(n=new I8(n)),n instanceof WritableStream&&(n={writable:n}),n.size===ii&&(n.size=0),n instanceof I8||Object.assign(n,{diskNumber:0,diskOffset:0,availableSize:1/0,maxSize:1/0}),n}}function Ol(t,n){return HM.apply(this,arguments)}function HM(){return HM=(0,R.A)(function*(t,n){if(!t.init||t.initialized)return Promise.resolve();yield t.init(n)}),HM.apply(this,arguments)}function As(t,n,e,i){return t.readUint8Array(n,e,i)}function Cx(t){function n(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var i=e.done;return Promise.resolve(e.value).then(function(r){return{value:r,done:i}})}return(Cx=function(i){this.s=i,this.n=i.next}).prototype={s:null,n:null,next:function(){return n(this.n.apply(this.s,arguments))},return:function(i){var r=this.s.return;return void 0===r?Promise.resolve({value:i,done:!0}):n(r.apply(this.s,arguments))},throw:function(i){var r=this.s.return;return void 0===r?Promise.reject(i):n(r.apply(this.s,arguments))}},new Cx(t)}function D8(t,n){this.v=t,this.k=n}function Ea(t){return new D8(t,0)}function Qb(t){var n,e;function i(o,s){try{var a=t[o](s),l=a.value,u=l instanceof D8;Promise.resolve(u?l.v:l).then(function(f){if(u){var g="return"===o?"return":"next";if(!l.k||f.done)return i(g,f);f=t[g](f).value}r(a.done?"return":"normal",f)},function(f){i("throw",f)})}catch(f){r("throw",f)}}function r(o,s){switch(o){case"return":n.resolve({value:s,done:!0});break;case"throw":n.reject(s);break;default:n.resolve({value:s,done:!1})}(n=n.next)?i(n.key,n.arg):e=null}this._invoke=function(o,s){return new Promise(function(a,l){var u={key:o,arg:s,resolve:a,reject:l,next:null};e?e=e.next=u:(n=e=u,i(o,s))})},"function"!=typeof t.return&&(this.return=void 0)}Qb.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Qb.prototype.next=function(t){return this._invoke("next",t)},Qb.prototype.throw=function(t){return this._invoke("throw",t)},Qb.prototype.return=function(t){return this._invoke("return",t)};const O8="\0\u263a\u263b\u2665\u2666\u2663\u2660\u2022\u25d8\u25cb\u25d9\u2642\u2640\u266a\u266b\u263c\u25ba\u25c4\u2195\u203c\xb6\xa7\u25ac\u21a8\u2191\u2193\u2192\u2190\u221f\u2194\u25b2\u25bc !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\u2302\xc7\xfc\xe9\xe2\xe4\xe0\xe5\xe7\xea\xeb\xe8\xef\xee\xec\xc4\xc5\xc9\xe6\xc6\xf4\xf6\xf2\xfb\xf9\xff\xd6\xdc\xa2\xa3\xa5\u20a7\u0192\xe1\xed\xf3\xfa\xf1\xd1\xaa\xba\xbf\u2310\xac\xbd\xbc\xa1\xab\xbb\u2591\u2592\u2593\u2502\u2524\u2561\u2562\u2556\u2555\u2563\u2551\u2557\u255d\u255c\u255b\u2510\u2514\u2534\u252c\u251c\u2500\u253c\u255e\u255f\u255a\u2554\u2569\u2566\u2560\u2550\u256c\u2567\u2568\u2564\u2565\u2559\u2558\u2552\u2553\u256b\u256a\u2518\u250c\u2588\u2584\u258c\u2590\u2580\u03b1\xdf\u0393\u03c0\u03a3\u03c3\xb5\u03c4\u03a6\u0398\u03a9\u03b4\u221e\u03c6\u03b5\u2229\u2261\xb1\u2265\u2264\u2320\u2321\xf7\u2248\xb0\u2219\xb7\u221a\u207f\xb2\u25a0 ".split(""),SJ=256==O8.length;function xx(t,n){return n&&"cp437"==n.trim().toLowerCase()?function MJ(t){if(SJ){let n="";for(let e=0;e<t.length;e++)n+=O8[t[e]];return n}return(new TextDecoder).decode(t)}(t):new TextDecoder(n).decode(t)}const A8="filename",k8="rawFilename",zM="comment",P8="rawComment",VM="uncompressedSize",F8="compressedSize",jM="diskNumberStart",wx="lastModDate",GM="rawLastModDate",WM="lastAccessDate",$M="creationDate",R8="internalFileAttribute",L8="internalFileAttributes",B8="externalFileAttribute",U8="externalFileAttributes",H8="msDosCompatible",YM="zip64",z8="encrypted",V8="version",j8="versionMadeBy",G8="zipCrypto",Ex="directory",W8="executable",$8="compressionMethod",Y8="signature",q8="extraField",AJ=[A8,k8,F8,VM,wx,GM,zM,P8,WM,$M,"offset",jM,jM,R8,L8,B8,U8,H8,YM,z8,V8,j8,G8,Ex,W8,$8,Y8,q8,"bitFlag","filenameUTF8","commentUTF8","rawExtraField","extraFieldZip64","extraFieldUnicodePath","extraFieldUnicodeComment","extraFieldAES","extraFieldNTFS","extraFieldExtendedTimestamp"];class Jb{constructor(n){AJ.forEach(e=>this[e]=n[e])}}const Z8="password",X8="rawPassword",K8="passThrough",J8="useWebWorkers",eL="useCompressionStream",tL="preventClose",nL="supportZip64SplitFile",rL="usdz",qM="File format is not recognized",oL="Compression method not supported",sL="Split zip file",oee=[[VM,go],[F8,go],["offset",go],[jM,oo]],see={[oo]:{getValue:zr,bytes:4},[go]:{getValue:Fm,bytes:8}};class Tx{constructor(n,e={}){Object.assign(this,{reader:new UM(n),options:e,config:eM(),readRanges:[]})}getEntriesGenerator(n={}){var e=this;return function IJ(t){return function(){return new Qb(t.apply(this,arguments))}}(function*(){const i=e;let{reader:r}=i;const{config:o}=i;if(yield Ea(Ol(r)),(r.size===ii||!r.readUint8Array)&&(r=new qh(yield Ea(new Response(r.readable).blob())),yield Ea(Ol(r))),r.size<22)throw new Error(qM);r.chunkSize=kR(o);const s=yield Ea(function fee(t,n,e,i,r){return XM.apply(this,arguments)}(r,mR,r.size,22,16*oo));if(!s)throw zr(Yr(yield Ea(As(r,0,4))))==jS?new Error(sL):new Error("End of central directory not found");const a=Yr(s);let l=zr(a,12),u=zr(a,16);const f=s.offset,g=ds(a,20),v=f+22+g;let C=ds(a,4);const E=r.lastDiskNumber||0;let w=ds(a,6),T=ds(a,8),M=0,S=0;if(u==go||l==go||T==oo||w==oo){const ue=Yr(yield Ea(As(r,s.offset-20,20)));if(zr(ue,0)==_R){u=Fm(ue,8);let Ue=yield Ea(As(r,u,56,-1)),Ze=Yr(Ue);const nt=s.offset-20-56;if(zr(Ze,0)!=WS&&u!=nt){const be=u;u=nt,u>be&&(M=u-be),Ue=yield Ea(As(r,u,56,-1)),Ze=Yr(Ue)}if(zr(Ze,0)!=WS)throw new Error("End of Zip64 central directory locator not found");C==oo&&(C=zr(Ze,16)),w==oo&&(w=zr(Ze,20)),T==oo&&(T=Fm(Ze,32)),l==go&&(l=Fm(Ze,40)),u-=l}}if(u>=r.size&&(M=r.size-u-l-22,u=r.size-l-22),E!=C)throw new Error(sL);if(u<0)throw new Error(qM);let P=0,Z=yield Ea(As(r,u,l,w)),ee=Yr(Z);if(l){const Se=s.offset-l;if(zr(ee,P)!=GS&&u!=Se){const ue=u;u=Se,u>ue&&(M+=u-ue),Z=yield Ea(As(r,u,l,w)),ee=Yr(Z)}}const B=s.offset-u-(r.lastDiskOffset||0);if(l!=B&&B>=0&&(l=B,Z=yield Ea(As(r,u,l,w)),ee=Yr(Z)),u<0||u>=r.size)throw new Error(qM);const J=ks(i,n,"filenameEncoding"),le=ks(i,n,"commentEncoding");for(let Se=0;Se<T;Se++){const ue=new aee(r,o,i.options);if(zr(ee,P)!=GS)throw new Error("Central directory header not found");cL(ue,ee,P+6);const Ue=!!ue.bitFlag.languageEncodingFlag,Ze=P+46,nt=Ze+ue.filenameLength,be=nt+ue.extraFieldLength,Ye=ds(ee,P+4),Ke=!(Ye>>8),tt=Ye>>8==3,lt=Z.subarray(Ze,nt),sn=ds(ee,P+32),Ct=be+sn,Ft=Z.subarray(be,Ct),an=Ue,Qe=Ue,Yn=zr(ee,P+38),yn=Ke&&!(16&~Pm(ee,P+38))||tt&&16384==(Yn>>16&61440)||lt.length&&lt[lt.length-1]=="/".charCodeAt(0),en=tt&&!!(Yn>>16&73),pr=zr(ee,P+42)+M;Object.assign(ue,{versionMadeBy:Ye,msDosCompatible:Ke,compressedSize:0,uncompressedSize:0,commentLength:sn,directory:yn,offset:pr,diskNumberStart:ds(ee,P+34),internalFileAttributes:ds(ee,P+36),externalFileAttributes:Yn,rawFilename:lt,filenameUTF8:an,commentUTF8:Qe,rawExtraField:Z.subarray(nt,be),executable:en}),ue.internalFileAttribute=ue.internalFileAttributes,ue.externalFileAttribute=ue.externalFileAttributes;const Vo=ks(i,n,"decodeText")||xx,ea=an?"utf-8":J||"cp437",ms=Qe?"utf-8":le||"cp437";let _s=Vo(lt,ea);_s===ii&&(_s=xx(lt,ea));let ku=Vo(Ft,ms);ku===ii&&(ku=xx(Ft,ms)),Object.assign(ue,{rawComment:Ft,filename:_s,comment:ku,directory:yn||_s.endsWith("/")}),S=Math.max(pr,S),uL(ue,ue,ee,P+6),ue.zipCrypto=ue.encrypted&&!ue.extraFieldAES;const Or=new Jb(ue);Or.getData=(Pl,Sa)=>ue.getData(Pl,Or,i.readRanges,Sa),Or.arrayBuffer=function(){var Pl=(0,R.A)(function*(Sa){const Fl=new TransformStream,[Xa]=yield Promise.all([new Response(Fl.readable).arrayBuffer(),ue.getData(Fl,Or,i.readRanges,Sa)]);return Xa});return function(Sa){return Pl.apply(this,arguments)}}(),P=Ct;const{onprogress:ts}=n;if(ts)try{yield Ea(ts(Se+1,T,new Jb(ue)))}catch{}yield Or}const se=ks(i,n,"extractPrependedData"),fe=ks(i,n,"extractAppendedData");return se&&(i.prependedData=S>0?yield Ea(As(r,0,S)):new Uint8Array),i.comment=g?yield Ea(As(r,f+22,g)):new Uint8Array,fe&&(i.appendedData=v<r.size?yield Ea(As(r,v,r.size-v)):new Uint8Array),!0})()}getEntries(n={}){var e=this;return(0,R.A)(function*(){const i=[];var s,r=!1,o=!1;try{for(var l,a=function M8(t){var n,e,i,r=2;for(typeof Symbol<"u"&&(e=Symbol.asyncIterator,i=Symbol.iterator);r--;){if(e&&null!=(n=t[e]))return n.call(t);if(i&&null!=(n=t[i]))return new Cx(n.call(t));e="@@asyncIterator",i="@@iterator"}throw new TypeError("Object is not async iterable")}(e.getEntriesGenerator(n));r=!(l=yield a.next()).done;r=!1)i.push(l.value)}catch(u){o=!0,s=u}finally{try{r&&null!=a.return&&(yield a.return())}finally{if(o)throw s}}return i})()}close(){return(0,R.A)(function*(){})()}}class aee{constructor(n,e,i){Object.assign(this,{reader:n,config:e,options:i})}getData(n,e,i,r={}){var o=this;return(0,R.A)(function*(){const s=o,{reader:a,offset:l,diskNumberStart:u,extraFieldAES:f,extraFieldZip64:g,compressionMethod:v,config:C,bitFlag:E,signature:w,rawLastModDate:T,uncompressedSize:M,compressedSize:S}=s,{dataDescriptor:P}=E,Z=e.localDirectory={},B=Yr(yield As(a,l,yp,u));let J=ks(s,r,Z8),le=ks(s,r,X8);const se=ks(s,r,K8);if(J=J&&J.length&&J,le=le&&le.length&&le,f&&99!=f.originalCompressionMethod)throw new Error(oL);if(0!=v&&v!=VS&&!se)throw new Error(oL);if(67324752!=zr(B,0))throw new Error("Local file header not found");cL(Z,B,4);const{extraFieldLength:fe,filenameLength:Se,lastAccessDate:ue,creationDate:Ue}=Z;Z.rawExtraField=fe?yield As(a,l+yp+Se,fe,u):new Uint8Array,uL(s,Z,B,4,!0),Object.assign(e,{lastAccessDate:ue,creationDate:Ue});const Ze=s.encrypted&&Z.encrypted&&!se,nt=Ze&&!f;if(se||(e.zipCrypto=nt),Ze){if(!nt&&f.strength===ii)throw new Error("Encryption method not supported");if(!J&&!le)throw new Error("File contains encrypted entry")}const be=l+yp+Se+fe,Ye=S,Ke=a.readable;Object.assign(Ke,{diskNumberStart:u,offset:be,size:Ye});const tt=ks(s,r,"signal"),lt=ks(s,r,"checkPasswordOnly");let sn=ks(s,r,"checkOverlappingEntry");const Ct=ks(s,r,"checkOverlappingEntryOnly");Ct&&(sn=!0);const{onstart:Ft,onprogress:an,onend:Qe}=r,Yn={options:{codecType:s8,password:J,rawPassword:le,zipCrypto:nt,encryptionStrength:f&&f.strength,signed:ks(s,r,"checkSignature")&&!se,passwordVerification:nt&&(P?T>>>8&255:w>>>24&255),outputSize:M,signature:w,compressed:0!=v&&!se,encrypted:s.encrypted&&!se,useWebWorkers:ks(s,r,J8),useCompressionStream:ks(s,r,eL),transferStreams:ks(s,r,"transferStreams"),checkPasswordOnly:lt},config:C,streamOptions:{signal:tt,size:Ye,onstart:Ft,onprogress:an,onend:Qe}};let yn;sn&&(yield function hee(t){return ZM.apply(this,arguments)}({reader:a,fileEntry:e,offset:l,diskNumberStart:u,signature:w,compressedSize:S,uncompressedSize:M,dataOffset:be,dataDescriptor:P||Z.bitFlag.dataDescriptor,extraFieldZip64:g||Z.extraFieldZip64,readRanges:i}));try{if(!Ct){lt&&(n=new WritableStream),n=new S8(n),yield Ol(n,se?S:M),({writable:yn}=n);const{outputSize:en}=yield h8({readable:Ke,writable:yn},Yn);if(n.size+=en,en!=(se?S:M))throw new Error(JR)}}catch(en){if(en.outputSize!==ii&&(n.size+=en.outputSize),!lt||en.message!=rM)throw en}finally{!ks(s,r,tL)&&yn&&!yn.locked&&(yield yn.getWriter().close())}return lt||Ct?ii:n.getData?n.getData():yn})()}}function cL(t,n,e){const i=t.rawBitFlag=ds(n,e+2),r=(i&YS)==YS,o=zr(n,e+6);Object.assign(t,{encrypted:r,version:ds(n,e),bitFlag:{level:(6&i)>>1,dataDescriptor:(i&qS)==qS,languageEncodingFlag:(i&ZS)==ZS},rawLastModDate:o,lastModDate:pee(o),filenameLength:ds(n,e+22),extraFieldLength:ds(n,e+24)})}function uL(t,n,e,i,r){const{rawExtraField:o}=n,s=n.extraField=new Map,a=Yr(new Uint8Array(o));let l=0;try{for(;l<o.length;){const M=ds(a,l),S=ds(a,l+2);s.set(M,{type:M,data:o.slice(l+4,l+4+S)}),l+=4+S}}catch{}const u=ds(e,i+4);Object.assign(n,{signature:zr(e,i+JS),compressedSize:zr(e,i+Dm),uncompressedSize:zr(e,i+Om)});const f=s.get(1);f&&(function lee(t,n){n.zip64=!0;const e=Yr(t.data),i=oee.filter(([r,o])=>n[r]==o);for(let r=0,o=0;r<i.length;r++){const[s,a]=i[r];if(n[s]==a){const l=see[a];n[s]=t[s]=l.getValue(e,o),o+=l.bytes}else if(t[s])throw new Error("Zip64 extra field not found")}}(f,n),n.extraFieldZip64=f);const g=s.get(28789);g&&(dL(g,A8,k8,n,t),n.extraFieldUnicodePath=g);const v=s.get(25461);v&&(dL(v,zM,P8,n,t),n.extraFieldUnicodeComment=v);const C=s.get(39169);C?(function cee(t,n,e){const i=Yr(t.data),r=Pm(i,4);Object.assign(t,{vendorVersion:Pm(i,0),vendorId:Pm(i,2),strength:r,originalCompressionMethod:e,compressionMethod:ds(i,5)}),n.compressionMethod=t.compressionMethod}(C,n,u),n.extraFieldAES=C):n.compressionMethod=u;const E=s.get(10);E&&(function uee(t,n){const e=Yr(t.data);let r,i=4;try{for(;i<t.data.length&&!r;){const o=ds(e,i),s=ds(e,i+2);1==o&&(r=t.data.slice(i+4,i+4+s)),i+=4+s}}catch{}try{if(r&&24==r.length){const o=Yr(r),s=o.getBigUint64(0,!0),a=o.getBigUint64(8,!0),l=o.getBigUint64(16,!0);Object.assign(t,{rawLastModDate:s,rawLastAccessDate:a,rawCreationDate:l});const u=KM(s),v={lastModDate:u,lastAccessDate:KM(a),creationDate:KM(l)};Object.assign(t,v),Object.assign(n,v)}}catch{}}(E,n),n.extraFieldNTFS=E);const w=s.get(21589);w&&(function dee(t,n,e){const i=Yr(t.data),r=Pm(i,0),o=[],s=[];e?(!(1&~r)&&(o.push(wx),s.push(GM)),!(2&~r)&&(o.push(WM),s.push("rawLastAccessDate")),!(4&~r)&&(o.push($M),s.push("rawCreationDate"))):t.data.length>=5&&(o.push(wx),s.push(GM));let a=1;o.forEach((l,u)=>{if(t.data.length>=a+4){const f=zr(i,a);n[l]=t[l]=new Date(1e3*f),t[s[u]]=f}a+=4})}(w,n,r),n.extraFieldExtendedTimestamp=w);const T=s.get(ER);T&&(n.extraFieldUSDZ=T)}function dL(t,n,e,i,r){const o=Yr(t.data),s=new hx;s.append(r[e]);const a=Yr(new Uint8Array(4));a.setUint32(0,s.get(),!0);const l=zr(o,1);Object.assign(t,{version:Pm(o,0),[n]:xx(t.data.subarray(5)),valid:!r.bitFlag.languageEncodingFlag&&l==zr(a,0)}),t.valid&&(i[n]=t[n],i[n+"UTF8"]=!0)}function ZM(){return ZM=(0,R.A)(function*({reader:t,fileEntry:n,offset:e,diskNumberStart:i,signature:r,compressedSize:o,uncompressedSize:s,dataOffset:a,dataDescriptor:l,extraFieldZip64:u,readRanges:f}){let g=0;if(i)for(let E=0;E<i;E++)g+=t.readers[E].size;let v=0;if(l&&(v=u?20:12),v){const E=yield As(t,a+o,v+4,i);if(zr(Yr(E),0)==gR){const T=zr(Yr(E),4);let M,S;u?(M=Fm(Yr(E),8),S=Fm(Yr(E),16)):(M=zr(Yr(E),8),S=zr(Yr(E),12)),(n.encrypted&&!n.zipCrypto||T==r)&&M==o&&S==s&&(v+=4)}}const C={start:g+e,end:g+a+o+v,fileEntry:n};for(const E of f)if(E.fileEntry!=n&&C.start>=E.start&&C.start<E.end){const w=new Error("Overlapping entry found");throw w.overlappingEntry=E.fileEntry,w}f.push(C)}),ZM.apply(this,arguments)}function XM(){return XM=(0,R.A)(function*(t,n,e,i,r){const o=new Uint8Array(4);!function gee(t,n,e){t.setUint32(n,e,!0)}(Yr(o),0,n);const a=i+r;return(yield l(i))||(yield l(Math.min(a,e)));function l(f){return u.apply(this,arguments)}function u(){return(u=(0,R.A)(function*(f){const g=e-f,v=yield As(t,g,f);for(let C=v.length-i;C>=0;C--)if(v[C]==o[0]&&v[C+1]==o[1]&&v[C+2]==o[2]&&v[C+3]==o[3])return{offset:g+C,buffer:v.slice(C,C+i).buffer}})).apply(this,arguments)}}),XM.apply(this,arguments)}function ks(t,n,e){return n[e]===ii?t.options[e]:n[e]}function pee(t){const n=(4294901760&t)>>16,e=65535&t;try{return new Date(1980+((65024&n)>>9),((480&n)>>5)-1,31&n,(63488&e)>>11,(2016&e)>>5,2*(31&e),0)}catch{}}function KM(t){return new Date(Number(t/BigInt(1e4)-BigInt(116444736e5)))}function Pm(t,n){return t.getUint8(n)}function ds(t,n){return t.getUint16(n,!0)}function zr(t,n){return t.getUint32(n,!0)}function Fm(t,n){return Number(t.getBigUint64(n,!0))}function Yr(t){return new DataView(t.buffer)}const hL="Version exceeds 65535",QM="Zip64 is not supported (make sure 'keepOrder' is set to 'true')",fL=new Uint8Array([7,0,2,0,65,69,3,0,0]);let JM=0;const pL=[];class e3{constructor(n,e={}){n=new S8(n),Object.assign(this,{writer:n,addSplitZipSignature:n.availableSize!==ii&&n.availableSize>0&&n.availableSize!==1/0&&n.maxSize!==ii&&n.maxSize>0&&n.maxSize!==1/0,options:e,config:eM(),files:new Map,filenames:new Set,offset:e.offset===ii?n.size||n.writable.size||0:e.offset,pendingEntriesSize:0,pendingAddFileCalls:new Set,bufferedWrites:0})}prependZip(n){var e=this;return(0,R.A)(function*(){if(e.filenames.size)throw new Error("Zip file not empty");n=new UM(n);const i=new Tx(n.readable),r=yield i.getEntries();yield i.close(),yield n.readable.pipeTo(e.writer.writable,{preventClose:!0,preventAbort:!0}),e.writer.size=e.offset=n.size,e.filenames=new Set(r.map(o=>o.filename)),e.files=new Map(r.map(o=>{const{version:s,compressionMethod:a,lastModDate:l,lastAccessDate:u,creationDate:f,rawFilename:g,bitFlag:v,encrypted:C,uncompressedSize:E,compressedSize:w,diskOffset:T,diskNumber:M,zip64:S}=o;let{rawExtraFieldZip64:P,rawExtraFieldAES:Z,rawExtraFieldExtendedTimestamp:ee,rawExtraFieldNTFS:B,rawExtraField:J}=o;const{level:le,languageEncodingFlag:se,dataDescriptor:fe}=v;P=P||new Uint8Array,Z=Z||new Uint8Array,ee=ee||new Uint8Array,B=B||new Uint8Array,J=J||new Uint8Array;const Se=yi(P,Z,ee,B,J),ue=S&&E>go,Ue=S&&w>go,{headerArray:Ze,headerView:nt}=_L({version:s,bitFlag:bL(le,se,fe,C,a),compressionMethod:a,uncompressedSize:E,compressedSize:w,lastModDate:l,rawFilename:g,zip64CompressedSize:Ue,zip64UncompressedSize:ue,extraFieldLength:Se});return Object.assign(o,{zip64UncompressedSize:ue,zip64CompressedSize:Ue,zip64Offset:S&&e.offset-T>go,zip64DiskNumberStart:S&&M>oo,rawExtraFieldZip64:P,rawExtraFieldAES:Z,rawExtraFieldExtendedTimestamp:ee,rawExtraFieldNTFS:B,rawExtraField:J,extendedTimestamp:ee.length>0||B.length>0,extraFieldExtendedTimestampFlag:1+(u?2:0)+(f?4:0),headerArray:Ze,headerView:nt}),[o.filename,o]}))})()}add(n="",e,i={}){var r=this;return(0,R.A)(function*(){const o=r,{pendingAddFileCalls:s,config:a}=o;let l;JM<a.maxWorkers?JM++:yield new Promise(u=>pL.push(u));try{if(n=n.trim(),o.filenames.has(n))throw new Error("File already exists");return o.filenames.add(n),l=function Tee(t,n,e,i){return t3.apply(this,arguments)}(o,n,e,i),s.add(l),yield l}catch(u){throw o.filenames.delete(n),u}finally{s.delete(l);const u=pL.shift();u?u():JM--}})()}remove(n){const{filenames:e,files:i}=this;if("string"==typeof n&&(n=i.get(n)),n&&n.filename!==ii){const{filename:r}=n;if(e.has(r)&&i.has(r))return e.delete(r),i.delete(r),!0}return!1}close(n=new Uint8Array,e={}){var i=this;return(0,R.A)(function*(){const r=i,{pendingAddFileCalls:o,writer:s}=i,{writable:a}=s;for(;o.size;)yield Promise.allSettled(Array.from(o));return yield function Pee(t,n,e){return r3.apply(this,arguments)}(i,n,e),Oi(r,e,tL)||(yield a.getWriter().close()),s.getData?s.getData():a})()}}function t3(){return t3=(0,R.A)(function*(t,n,e,i){n=n.trim();const r=Oi(t,i,H8),o=Oi(t,i,j8,r?20:768),s=Oi(t,i,W8);if(o>oo)throw new Error(hL);let a=Oi(t,i,U8,0);0===a&&(a=Oi(t,i,B8,0)),!i[Ex]&&n.endsWith("/")&&(i[Ex]=!0),Oi(t,i,Ex)?(n.endsWith("/")||(n+="/"),0===a&&(a=16,r||(a|=16877<<16))):!r&&0===a&&(a=s?493<<16:420<<16);const u=Oi(t,i,"encodeText",fx);let f=u(n);if(f===ii&&(f=fx(n)),yi(f)>oo)throw new Error("File entry name exceeds 64KB");const g=i[zM]||"";let v=u(g);if(v===ii&&(v=fx(g)),yi(v)>oo)throw new Error("File entry comment exceeds 64KB");const C=Oi(t,i,V8,20);if(C>oo)throw new Error(hL);const E=Oi(t,i,wx,new Date),w=Oi(t,i,WM),T=Oi(t,i,$M);let M=Oi(t,i,L8,0);0===M&&(M=Oi(t,i,R8,0));const S=Oi(t,i,K8);let P,Z;S||(P=Oi(t,i,Z8),Z=Oi(t,i,X8));const ee=Oi(t,i,"encryptionStrength",3),B=Oi(t,i,G8),J=Oi(t,i,"extendedTimestamp",!0),le=Oi(t,i,"keepOrder",!0),se=Oi(t,i,"level"),fe=Oi(t,i,J8),Se=Oi(t,i,"bufferedWrite"),ue=Oi(t,i,"dataDescriptorSignature",!1),Ue=Oi(t,i,"signal"),Ze=Oi(t,i,"useUnicodeFileNames",!0),nt=Oi(t,i,eL),be=Oi(t,i,$8);let Ye=Oi(t,i,"dataDescriptor");Se&&Ye===ii&&(Ye=!1),(Ye===ii||B)&&(Ye=!0);let Ke=Oi(t,i,YM);if(!(B||P===ii&&Z===ii||ee>=1&&ee<=3))throw new Error("The strength must equal 1, 2, or 3");let tt=new Uint8Array;const lt=i[q8];if(lt){let Sa=0,Fl=0;lt.forEach(Xa=>Sa+=4+yi(Xa)),tt=new Uint8Array(Sa),lt.forEach((Xa,Nl)=>{if(Nl>oo)throw new Error("Extra field type exceeds 65535");if(yi(Xa)>oo)throw new Error("Extra field data exceeds 64KB");So(tt,new Uint16Array([Nl]),Fl),So(tt,new Uint16Array([yi(Xa)]),Fl+2),So(tt,Xa,Fl+4),Fl+=4+yi(Xa)})}let sn=0,Ct=0,Ft=0;if(S&&(Ft=i[VM],Ft===ii))throw new Error("Undefined uncompressed size");const an=!0===Ke;e&&(e=new UM(e),yield Ol(e),S?(i.uncompressedSize=Ft,sn=mL(Ft)):e.size===ii?(Ye=!0,(Ke||Ke===ii)&&(Ke=!0,Ft=sn=go+1)):(i.uncompressedSize=Ft=e.size,sn=mL(Ft)));const{diskOffset:Qe,diskNumber:Yn,maxSize:yn}=t.writer,en=an||Ft>go,pr=an||sn>go,Vo=an||t.offset+t.pendingEntriesSize-Qe>go,ms=Oi(t,i,nL,!0)&&an||Yn+Math.ceil(t.pendingEntriesSize/yn)>oo;if(Vo||en||pr||ms){if(!1===Ke||!le)throw new Error(QM);Ke=!0}Ke=Ke||!1;const _s=Oi(t,i,z8),ku=function Mee(t){const{rawFilename:n,lastModDate:e,lastAccessDate:i,creationDate:r,level:o,zip64:s,zipCrypto:a,useUnicodeFileNames:l,dataDescriptor:u,directory:f,rawExtraField:g,encryptionStrength:v,extendedTimestamp:C,passThrough:E,encrypted:w,zip64UncompressedSize:T,zip64CompressedSize:M,zip64Offset:S,zip64DiskNumberStart:P,uncompressedSize:Z,offset:ee,diskNumberStart:B}=t;let{version:J,compressionMethod:le}=t;const se=!f&&(o>0||o===ii&&0!==le);let fe;const Se=E||!se,ue=s&&(t.bufferedWrite||!T&&!M||Se);if(s){let Qe=4;T&&(Qe+=8),M&&(Qe+=8),S&&(Qe+=8),P&&(Qe+=4),fe=new Uint8Array(Qe);const Yn=Ps(fe);if(Bi(Yn,0,1),Bi(Yn,2,yi(fe)-4),ue){const yn=Ps(fe);let en=4;T&&(Uo(yn,en,BigInt(Z)),en+=8),M&&Se&&(Uo(yn,en,BigInt(Z)),en+=8),S&&(Uo(yn,en,BigInt(ee)),en+=8),P&&(vi(yn,en,B),en+=4)}}else fe=new Uint8Array;let Ue,Ze,nt,be;if(w&&!a){Ue=new Uint8Array(yi(fL)+2);const Qe=Ps(Ue);Bi(Qe,0,39169),So(Ue,fL,2),a3(Qe,8,v)}else Ue=new Uint8Array;if(C){nt=new Uint8Array(9+(i?4:0)+(r?4:0));const Qe=Ps(nt);Bi(Qe,0,21589),Bi(Qe,2,yi(nt)-4),be=1+(i?2:0)+(r?4:0),a3(Qe,4,be);let Yn=5;vi(Qe,Yn,Math.floor(e.getTime()/1e3)),Yn+=4,i&&(vi(Qe,Yn,Math.floor(i.getTime()/1e3)),Yn+=4),r&&vi(Qe,Yn,Math.floor(r.getTime()/1e3));try{Ze=new Uint8Array(36);const yn=Ps(Ze),en=s3(e);Bi(yn,0,10),Bi(yn,2,32),Bi(yn,8,1),Bi(yn,10,24),Uo(yn,12,en),Uo(yn,20,s3(i)||en),Uo(yn,28,s3(r)||en)}catch{Ze=new Uint8Array}}else Ze=nt=new Uint8Array;le===ii&&(le=se?VS:0),s&&(J=J>45?J:45),w&&!a&&(J=J>51?J:51,Ue[9]=le,le=99);const Ye=ue?yi(fe):0,Ke=Ye+yi(Ue,nt,Ze,g),{headerArray:tt,headerView:lt,rawLastModDate:sn}=_L({version:J,bitFlag:bL(o,l,u,w,le),compressionMethod:le,uncompressedSize:Z,lastModDate:e<DR?DR:e>MR?MR:e,rawFilename:n,zip64CompressedSize:M,zip64UncompressedSize:T,extraFieldLength:Ke});let Ct=yp;const Ft=new Uint8Array(Ct+yi(n)+Ke),an=Ps(Ft);return vi(an,0,67324752),So(Ft,tt,4),So(Ft,n,Ct),Ct+=yi(n),ue&&So(Ft,fe,Ct),Ct+=Ye,So(Ft,Ue,Ct),Ct+=yi(Ue),So(Ft,nt,Ct),Ct+=yi(nt),So(Ft,Ze,Ct),Ct+=yi(Ze),So(Ft,g,Ct),u&&(vi(an,Dm+4,0),vi(an,Om+4,0)),{localHeaderArray:Ft,localHeaderView:an,headerArray:tt,headerView:lt,lastModDate:e,rawLastModDate:sn,encrypted:w,compressed:se,version:J,compressionMethod:le,extraFieldExtendedTimestampFlag:be,rawExtraFieldZip64:fe,localExtraFieldZip64Length:Ye,rawExtraFieldExtendedTimestamp:nt,rawExtraFieldNTFS:Ze,rawExtraFieldAES:Ue,extraFieldLength:Ke}}(i=Object.assign({},i,{rawFilename:f,rawComment:v,version:C,versionMadeBy:o,lastModDate:E,lastAccessDate:w,creationDate:T,rawExtraField:tt,zip64:Ke,zip64UncompressedSize:en,zip64CompressedSize:pr,zip64Offset:Vo,zip64DiskNumberStart:ms,password:P,rawPassword:Z,level:nt||t.config.CompressionStream!==ii||t.config.CompressionStreamNative!==ii?se:0,useWebWorkers:fe,encryptionStrength:ee,extendedTimestamp:J,zipCrypto:B,bufferedWrite:Se,keepOrder:le,useUnicodeFileNames:Ze,dataDescriptor:Ye,dataDescriptorSignature:ue,signal:Ue,msDosCompatible:r,internalFileAttribute:M,internalFileAttributes:M,externalFileAttribute:a,externalFileAttributes:a,useCompressionStream:nt,passThrough:S,encrypted:!!(P&&yi(P)||Z&&yi(Z))||S&&_s,signature:i[Y8],compressionMethod:be,uncompressedSize:Ft,offset:t.offset-Qe,diskNumberStart:Yn})),Or=function Oee({zip64:t,dataDescriptor:n,dataDescriptorSignature:e}){let r,i=new Uint8Array,o=0,s=t?20:12;return e&&(s+=4),n&&(i=new Uint8Array(s),r=Ps(i),e&&(o=4,vi(r,0,gR))),{dataDescriptorArray:i,dataDescriptorView:r,dataDescriptorOffset:o}}(i),ts=yi(ku.localHeaderArray,Or.dataDescriptorArray);let Pl;Ct=ts+sn,t.options[rL]&&(Ct+=Ct+64),t.pendingEntriesSize+=Ct;try{Pl=yield function Iee(t,n,e,i,r){return n3.apply(this,arguments)}(t,n,e,{headerInfo:ku,dataDescriptorInfo:Or,metadataSize:ts},i)}finally{t.pendingEntriesSize-=Ct}return Object.assign(Pl,{name:n,comment:g,extraField:lt}),new Jb(Pl)}),t3.apply(this,arguments)}function n3(){return n3=(0,R.A)(function*(t,n,e,i,r){const{files:o,writer:s}=t,{keepOrder:a,dataDescriptor:l,signal:u}=r,{headerInfo:f}=i,g=t.options[rL],v=Array.from(o.values()).pop();let E,w,T,M,S,P,Z,C={};o.set(n,C);try{let fe;a&&(fe=v&&v.lock,function ee(){C.lock=new Promise(fe=>T=fe)}()),!(r.bufferedWrite||t.writerLocked||t.bufferedWrites&&a)&&l||g?(P=s,yield B()):(P=new TransformStream,P.size=0,E=!0,t.bufferedWrites++,yield Ol(s)),yield Ol(P);const{writable:Se,diskOffset:ue}=s;if(t.addSplitZipSignature){delete t.addSplitZipSignature;const Ye=new Uint8Array(4);vi(Ps(Ye),0,jS),yield Ed(s,Ye),t.offset+=4}g&&function Dee(t,n){const{headerInfo:e}=t;let{localHeaderArray:i,extraFieldLength:r}=e,o=Ps(i),s=64-(n+yi(i))%64;s<4&&(s+=64);const a=new Uint8Array(s),l=Ps(a);Bi(l,0,ER),Bi(l,2,s-2);const u=i;e.localHeaderArray=i=new Uint8Array(yi(u)+s),So(i,u),So(i,a,yi(u)),o=Ps(i),Bi(o,28,r+s),t.metadataSize+=s}(i,t.offset-ue);const{localHeaderView:Ue,localHeaderArray:Ze}=f;E||(yield fe,yield le(Se));const{diskNumber:nt}=s;S=!0,C.diskNumberStart=nt,E?Z=new Response(P.readable).blob():yield Ed(P,Ze),C=yield function See(t,n,e,i,r,o){return i3.apply(this,arguments)}(e,P,C,i,t.config,r);const{zip64:be}=C;if(S=!1,o.set(n,C),C.filename=n,E){const[Ye]=yield Promise.all([Z,P.writable.getWriter().close(),fe]);yield B(),M=!0,C.diskNumberStart=s.diskNumber,C.offset=t.offset-s.diskOffset,be&&gL(C),function kee({rawFilename:t,encrypted:n,zip64:e,localExtraFieldZip64Length:i,signature:r,compressedSize:o,uncompressedSize:s,offset:a,diskNumberStart:l,zip64UncompressedSize:u,zip64CompressedSize:f,zip64Offset:g,zip64DiskNumberStart:v},C,{dataDescriptor:E}){if(E||(n||vi(C,JS+4,r),e||(vi(C,Dm+4,o),vi(C,Om+4,s))),e&&i){let w=yp+yi(t)+4;u&&(Uo(C,w,BigInt(s)),w+=8),f&&(Uo(C,w,BigInt(o)),w+=8),g&&(Uo(C,w,BigInt(a)),w+=8),v&&vi(C,w,l)}}(C,Ue,r),yield le(Se),yield Ed(s,Ze),yield Ye.stream().pipeTo(Se,{preventClose:!0,preventAbort:!0,signal:u}),s.size+=P.size,M=!1}else C.offset=t.offset-ue,be&&gL(C);if(C.offset>go&&!be)throw new Error(QM);return t.offset+=C.size,C}catch(fe){if(E&&M||!E&&S){if(t.hasCorruptedEntries=!0,fe)try{fe.corruptedEntry=!0}catch{}E?t.offset+=P.size:t.offset=P.size}throw o.delete(n),fe}finally{E&&t.bufferedWrites--,T&&T(),w&&w()}function B(){return J.apply(this,arguments)}function J(){return(J=(0,R.A)(function*(){t.writerLocked=!0;const{lockWriter:fe}=t;t.lockWriter=new Promise(Se=>w=()=>{t.writerLocked=!1,Se()}),yield fe})).apply(this,arguments)}function le(fe){return se.apply(this,arguments)}function se(){return(se=(0,R.A)(function*(fe){yi(f.localHeaderArray)>s.availableSize&&(s.availableSize=0,yield Ed(fe,new Uint8Array))})).apply(this,arguments)}}),n3.apply(this,arguments)}function i3(){return i3=(0,R.A)(function*(t,n,{diskNumberStart:e,lock:i},r,o,s){const{headerInfo:a,dataDescriptorInfo:l,metadataSize:u}=r,{headerArray:f,headerView:g,lastModDate:v,rawLastModDate:C,encrypted:E,compressed:w,version:T,compressionMethod:M,rawExtraFieldZip64:S,localExtraFieldZip64Length:P,rawExtraFieldExtendedTimestamp:Z,extraFieldExtendedTimestampFlag:ee,rawExtraFieldNTFS:B,rawExtraFieldAES:J}=a,{dataDescriptorArray:le}=l,{rawFilename:se,lastAccessDate:fe,creationDate:Se,password:ue,rawPassword:Ue,level:Ze,zip64:nt,zip64UncompressedSize:be,zip64CompressedSize:Ye,zip64Offset:Ke,zip64DiskNumberStart:tt,zipCrypto:lt,dataDescriptor:sn,directory:Ct,executable:Ft,versionMadeBy:an,rawComment:Qe,rawExtraField:Yn,useWebWorkers:yn,onstart:en,onprogress:pr,onend:Vo,signal:ea,encryptionStrength:ms,extendedTimestamp:_s,msDosCompatible:ku,internalFileAttributes:Or,externalFileAttributes:ts,useCompressionStream:Pl,passThrough:Sa}=s,Fl={lock:i,versionMadeBy:an,zip64:nt,directory:!!Ct,executable:!!Ft,filenameUTF8:!0,rawFilename:se,commentUTF8:!0,rawComment:Qe,rawExtraFieldZip64:S,localExtraFieldZip64Length:P,rawExtraFieldExtendedTimestamp:Z,rawExtraFieldNTFS:B,rawExtraFieldAES:J,rawExtraField:Yn,extendedTimestamp:_s,msDosCompatible:ku,internalFileAttributes:Or,externalFileAttributes:ts,diskNumberStart:e};let{signature:Xa,uncompressedSize:Nl}=s,nf=0;Sa||(Nl=0);const{writable:nw}=n;if(t){t.chunkSize=kR(o);const H3=t.readable,z3={options:{codecType:o8,level:Ze,rawPassword:Ue,password:ue,encryptionStrength:ms,zipCrypto:E&&lt,passwordVerification:E&&lt&&C>>8&255,signed:!Sa,compressed:w&&!Sa,encrypted:E&&!Sa,useWebWorkers:yn,useCompressionStream:Pl,transferStreams:!1},config:o,streamOptions:{signal:ea,size:t.size,onstart:en,onprogress:pr,onend:Vo}};try{const ta=yield h8({readable:H3,writable:nw},z3);nf=ta.outputSize,n.size+=nf,Sa||(Nl=ta.inputSize,Xa=ta.signature)}catch(ta){throw ta.outputSize!==ii&&(n.size+=ta.outputSize),ta}}return function Aee({signature:t,compressedSize:n,uncompressedSize:e,headerInfo:i,dataDescriptorInfo:r},{zip64:o,zipCrypto:s,dataDescriptor:a}){const{headerView:l,encrypted:u}=i,{dataDescriptorView:f,dataDescriptorOffset:g}=r;(!u||s)&&t!==ii&&(vi(l,JS,t),a&&vi(f,g,t)),o?a&&(Uo(f,g+4,BigInt(n)),Uo(f,g+12,BigInt(e))):(vi(l,Dm,n),vi(l,Om,e),a&&(vi(f,g+4,n),vi(f,g+8,e)))}({signature:Xa,compressedSize:nf,uncompressedSize:Nl,headerInfo:a,dataDescriptorInfo:l},s),sn&&(yield Ed(n,le)),Object.assign(Fl,{uncompressedSize:Nl,compressedSize:nf,lastModDate:v,rawLastModDate:C,creationDate:Se,lastAccessDate:fe,encrypted:E,zipCrypto:lt,size:u+nf,compressionMethod:M,version:T,headerArray:f,headerView:g,signature:Xa,extraFieldExtendedTimestampFlag:ee,zip64UncompressedSize:be,zip64CompressedSize:Ye,zip64Offset:Ke,zip64DiskNumberStart:tt}),Fl}),i3.apply(this,arguments)}function gL({compressedSize:t,uncompressedSize:n,offset:e,diskNumberStart:i,zip64UncompressedSize:r,zip64CompressedSize:o,zip64Offset:s,zip64DiskNumberStart:a,rawExtraFieldZip64:l}){const u=Ps(l);let f=4;r&&(Uo(u,f,BigInt(n)),f+=8),o&&(Uo(u,f,BigInt(t)),f+=8),s&&(Uo(u,f,BigInt(e)),f+=8),a&&vi(u,f,i)}function r3(){return r3=(0,R.A)(function*(t,n,e){const{files:i,writer:r}=t,{diskOffset:o}=r;let{diskNumber:s}=r,a=0,l=0,u=t.offset-o,f=i.size;for(const[,Z]of i){const{rawFilename:ee,rawExtraFieldZip64:B,rawExtraFieldAES:J,rawComment:le,rawExtraFieldNTFS:se,rawExtraField:fe,extendedTimestamp:Se,extraFieldExtendedTimestampFlag:ue,lastModDate:Ue}=Z;let Ze;if(Se){Ze=new Uint8Array(9);const nt=Ps(Ze);Bi(nt,0,21589),Bi(nt,2,5),a3(nt,4,ue),vi(nt,5,Math.floor(Ue.getTime()/1e3))}else Ze=new Uint8Array;Z.rawExtraFieldExtendedTimestamp=Ze,l+=46+yi(ee,le,B,J,se,Ze,fe)}const g=new Uint8Array(l),v=Ps(g);yield Ol(r);let C=0;for(const[Z,ee]of Array.from(i.values()).entries()){const{offset:B,rawFilename:J,rawExtraFieldZip64:le,rawExtraFieldAES:se,rawExtraFieldExtendedTimestamp:fe,rawExtraFieldNTFS:Se,rawExtraField:ue,rawComment:Ue,versionMadeBy:Ze,headerArray:nt,headerView:be,zip64:Ye,zip64UncompressedSize:Ke,zip64CompressedSize:tt,zip64DiskNumberStart:lt,zip64Offset:sn,internalFileAttributes:Ct,externalFileAttributes:Ft,diskNumberStart:an,uncompressedSize:Qe,compressedSize:Yn}=ee,yn=yi(le,se,fe,Se,ue);vi(v,a,GS),Bi(v,a+4,Ze),Ke||vi(be,Om,Qe),tt||vi(be,Dm,Yn),So(g,nt,a+6);let en=a+yp;if(Bi(v,en,yn),en+=2,Bi(v,en,yi(Ue)),en+=2,Bi(v,en,Ye&&lt?oo:an),en+=2,Bi(v,en,Ct),en+=2,Ft&&vi(v,en,Ft),en+=4,vi(v,en,Ye&&sn?go:B),en+=4,So(g,J,en),en+=yi(J),So(g,le,en),en+=yi(le),So(g,se,en),en+=yi(se),So(g,fe,en),en+=yi(fe),So(g,Se,en),en+=yi(Se),So(g,ue,en),en+=yi(ue),So(g,Ue,en),a-C>r.availableSize&&(r.availableSize=0,yield Ed(r,g.slice(C,a)),C=a),a=en,e.onprogress)try{yield e.onprogress(Z+1,i.size,new Jb(ee))}catch{}}yield Ed(r,C?g.slice(C):g);let E=r.diskNumber;const{availableSize:w}=r;w<22&&E++;let T=Oi(t,e,YM);if(u>go||l>go||f>oo||E>oo){if(!1===T)throw new Error(QM);T=!0}const M=new Uint8Array(T?98:22),S=Ps(M);a=0,T&&(vi(S,0,WS),Uo(S,4,BigInt(44)),Bi(S,12,45),Bi(S,14,45),vi(S,16,E),vi(S,20,s),Uo(S,24,BigInt(f)),Uo(S,32,BigInt(f)),Uo(S,40,BigInt(l)),Uo(S,48,BigInt(u)),vi(S,56,_R),Uo(S,64,BigInt(u)+BigInt(l)),vi(S,72,E+1),Oi(t,e,nL,!0)&&(E=oo,s=oo),f=oo,u=go,l=go,a+=76),vi(S,a,mR),Bi(S,a+4,E),Bi(S,a+6,s),Bi(S,a+8,f),Bi(S,a+10,f),vi(S,a+12,l),vi(S,a+16,u);const P=yi(n);if(P){if(!(P<=oo))throw new Error("Zip file comment exceeds 64KB");Bi(S,a+20,P)}yield Ed(r,M),P&&(yield Ed(r,n))}),r3.apply(this,arguments)}function Ed(t,n){return o3.apply(this,arguments)}function o3(){return o3=(0,R.A)(function*(t,n){const{writable:e}=t,i=e.getWriter();try{yield i.ready,t.size+=yi(n),yield i.write(n)}finally{i.releaseLock()}}),o3.apply(this,arguments)}function s3(t){if(t)return(BigInt(t.getTime())+BigInt(116444736e5))*BigInt(1e4)}function Oi(t,n,e,i){const r=n[e]===ii?t.options[e]:n[e];return r===ii?i:r}function mL(t){return t+5*(Math.floor(t/16383)+1)}function a3(t,n,e){t.setUint8(n,e)}function Bi(t,n,e){t.setUint16(n,e,!0)}function vi(t,n,e){t.setUint32(n,e,!0)}function Uo(t,n,e){t.setBigUint64(n,e,!0)}function So(t,n,e){t.set(n,e)}function Ps(t){return new DataView(t.buffer)}function yi(...t){let n=0;return t.forEach(e=>e&&(n+=e.length)),n}function _L({version:t,bitFlag:n,compressionMethod:e,uncompressedSize:i,compressedSize:r,lastModDate:o,rawFilename:s,zip64CompressedSize:a,zip64UncompressedSize:l,extraFieldLength:u}){const f=new Uint8Array(yp-4),g=Ps(f);Bi(g,0,t),Bi(g,2,n),Bi(g,4,e);const v=new Uint32Array(1),C=Ps(v);Bi(C,0,(o.getHours()<<6|o.getMinutes())<<5|o.getSeconds()/2),Bi(C,2,(o.getFullYear()-1980<<4|o.getMonth()+1)<<5|o.getDate());const E=v[0];return vi(g,6,E),(a||r!==ii)&&vi(g,Dm,a?go:r),(l||i!==ii)&&vi(g,Om,l?go:i),Bi(g,22,yi(s)),Bi(g,24,u),{headerArray:f,headerView:g,rawLastModDate:E}}function bL(t,n,e,i,r){let o=0;return n&&(o|=ZS),e&&(o|=qS),(r==VS||r==gQ)&&(t>=0&&t<=3&&(o|=xQ),t>3&&t<=5&&(o|=CQ),9==t&&(o|=yQ)),i&&(o|=YS),o}let EL;try{EL="file:///C:/Users/keyra/OneDrive/Documents/Prog/UdonariumWithFly/node_modules/@zip.js/zip.js/lib/zip-fs.js"}catch{}tM({baseURL:EL}),function uJ(t,n={}){const e='const{Array:e,Object:t,Number:n,Math:r,Error:s,Uint8Array:i,Uint16Array:o,Uint32Array:c,Int32Array:f,Map:a,DataView:l,Promise:u,TextEncoder:w,crypto:h,postMessage:d,TransformStream:p,ReadableStream:y,WritableStream:m,CompressionStream:b,DecompressionStream:g}=self,k=void 0,v="undefined",S="function";class z{constructor(e){return class extends p{constructor(t,n){const r=new e(n);super({transform(e,t){t.enqueue(r.append(e))},flush(e){const t=r.flush();t&&e.enqueue(t)}})}}}}const C=[];for(let e=0;256>e;e++){let t=e;for(let e=0;8>e;e++)1&t?t=t>>>1^3988292384:t>>>=1;C[e]=t}class x{constructor(e){this.t=e||-1}append(e){let t=0|this.t;for(let n=0,r=0|e.length;r>n;n++)t=t>>>8^C[255&(t^e[n])];this.t=t}get(){return~this.t}}class A extends p{constructor(){let e;const t=new x;super({transform(e,n){t.append(e),n.enqueue(e)},flush(){const n=new i(4);new l(n.buffer).setUint32(0,t.get()),e.value=n}}),e=this}}const I={concat(e,t){if(0===e.length||0===t.length)return e.concat(t);const n=e[e.length-1],r=I.i(n);return 32===r?e.concat(t):I.o(t,r,0|n,e.slice(0,e.length-1))},l(e){const t=e.length;if(0===t)return 0;const n=e[t-1];return 32*(t-1)+I.i(n)},u(e,t){if(32*e.length<t)return e;const n=(e=e.slice(0,r.ceil(t/32))).length;return t&=31,n>0&&t&&(e[n-1]=I.h(t,e[n-1]&2147483648>>t-1,1)),e},h:(e,t,n)=>32===e?t:(n?0|t:t<<32-e)+1099511627776*e,i:e=>r.round(e/1099511627776)||32,o(e,t,n,r){for(void 0===r&&(r=[]);t>=32;t-=32)r.push(n),n=0;if(0===t)return r.concat(e);for(let s=0;s<e.length;s++)r.push(n|e[s]>>>t),n=e[s]<<32-t;const s=e.length?e[e.length-1]:0,i=I.i(s);return r.push(I.h(t+i&31,t+i>32?n:r.pop(),1)),r}},_={bytes:{p(e){const t=I.l(e)/8,n=new i(t);let r;for(let s=0;t>s;s++)3&s||(r=e[s/4]),n[s]=r>>>24,r<<=8;return n},m(e){const t=[];let n,r=0;for(n=0;n<e.length;n++)r=r<<8|e[n],3&~n||(t.push(r),r=0);return 3&n&&t.push(I.h(8*(3&n),r)),t}}},P=class{constructor(e){const t=this;t.blockSize=512,t.k=[1732584193,4023233417,2562383102,271733878,3285377520],t.v=[1518500249,1859775393,2400959708,3395469782],e?(t.S=e.S.slice(0),t.C=e.C.slice(0),t.A=e.A):t.reset()}reset(){const e=this;return e.S=e.k.slice(0),e.C=[],e.A=0,e}update(e){const t=this;"string"==typeof e&&(e=_.I.m(e));const n=t.C=I.concat(t.C,e),r=t.A,i=t.A=r+I.l(e);if(i>9007199254740991)throw new s("Cannot hash more than 2^53 - 1 bits");const o=new c(n);let f=0;for(let e=t.blockSize+r-(t.blockSize+r&t.blockSize-1);i>=e;e+=t.blockSize)t._(o.subarray(16*f,16*(f+1))),f+=1;return n.splice(0,16*f),t}P(){const e=this;let t=e.C;const n=e.S;t=I.concat(t,[I.h(1,1)]);for(let e=t.length+2;15&e;e++)t.push(0);for(t.push(r.floor(e.A/4294967296)),t.push(0|e.A);t.length;)e._(t.splice(0,16));return e.reset(),n}D(e,t,n,r){return e>19?e>39?e>59?e>79?void 0:t^n^r:t&n|t&r|n&r:t^n^r:t&n|~t&r}V(e,t){return t<<e|t>>>32-e}_(t){const n=this,s=n.S,i=e(80);for(let e=0;16>e;e++)i[e]=t[e];let o=s[0],c=s[1],f=s[2],a=s[3],l=s[4];for(let e=0;79>=e;e++){16>e||(i[e]=n.V(1,i[e-3]^i[e-8]^i[e-14]^i[e-16]));const t=n.V(5,o)+n.D(e,c,f,a)+l+i[e]+n.v[r.floor(e/20)]|0;l=a,a=f,f=n.V(30,c),c=o,o=t}s[0]=s[0]+o|0,s[1]=s[1]+c|0,s[2]=s[2]+f|0,s[3]=s[3]+a|0,s[4]=s[4]+l|0}},D={getRandomValues(e){const t=new c(e.buffer),n=e=>{let t=987654321;const n=4294967295;return()=>(t=36969*(65535&t)+(t>>16)&n,(((t<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n)/4294967296+.5)*(r.random()>.5?1:-1))};for(let s,i=0;i<e.length;i+=4){const e=n(4294967296*(s||r.random()));s=987654071*e(),t[i/4]=4294967296*e()|0}return e}},V={importKey:e=>new V.R(_.bytes.m(e)),B(e,t,n,r){if(n=n||1e4,0>r||0>n)throw new s("invalid params to pbkdf2");const i=1+(r>>5)<<2;let o,c,f,a,u;const w=new ArrayBuffer(i),h=new l(w);let d=0;const p=I;for(t=_.bytes.m(t),u=1;(i||1)>d;u++){for(o=c=e.encrypt(p.concat(t,[u])),f=1;n>f;f++)for(c=e.encrypt(c),a=0;a<c.length;a++)o[a]^=c[a];for(f=0;(i||1)>d&&f<o.length;f++)h.setInt32(d,o[f]),d+=4}return w.slice(0,r/8)},R:class{constructor(e){const t=this,n=t.M=P,r=[[],[]];t.U=[new n,new n];const s=t.U[0].blockSize/32;e.length>s&&(e=(new n).update(e).P());for(let t=0;s>t;t++)r[0][t]=909522486^e[t],r[1][t]=1549556828^e[t];t.U[0].update(r[0]),t.U[1].update(r[1]),t.K=new n(t.U[0])}reset(){const e=this;e.K=new e.M(e.U[0]),e.N=!1}update(e){this.N=!0,this.K.update(e)}digest(){const e=this,t=e.K.P(),n=new e.M(e.U[1]).update(t).P();return e.reset(),n}encrypt(e){if(this.N)throw new s("encrypt on already updated hmac called!");return this.update(e),this.digest(e)}}},R=typeof h!=v&&typeof h.getRandomValues==S,B="Invalid password",E="Invalid signature",M="zipjs-abort-check-password";function U(e){return R?h.getRandomValues(e):D.getRandomValues(e)}const K=16,N={name:"PBKDF2"},O=t.assign({hash:{name:"HMAC"}},N),T=t.assign({iterations:1e3,hash:{name:"SHA-1"}},N),W=["deriveBits"],j=[8,12,16],H=[16,24,32],L=10,F=[0,0,0,0],q=typeof h!=v,G=q&&h.subtle,J=q&&typeof G!=v,Q=_.bytes,X=class{constructor(e){const t=this;t.O=[[[],[],[],[],[]],[[],[],[],[],[]]],t.O[0][0][0]||t.T();const n=t.O[0][4],r=t.O[1],i=e.length;let o,c,f,a=1;if(4!==i&&6!==i&&8!==i)throw new s("invalid aes key size");for(t.v=[c=e.slice(0),f=[]],o=i;4*i+28>o;o++){let e=c[o-1];(o%i===0||8===i&&o%i===4)&&(e=n[e>>>24]<<24^n[e>>16&255]<<16^n[e>>8&255]<<8^n[255&e],o%i===0&&(e=e<<8^e>>>24^a<<24,a=a<<1^283*(a>>7))),c[o]=c[o-i]^e}for(let e=0;o;e++,o--){const t=c[3&e?o:o-4];f[e]=4>=o||4>e?t:r[0][n[t>>>24]]^r[1][n[t>>16&255]]^r[2][n[t>>8&255]]^r[3][n[255&t]]}}encrypt(e){return this.W(e,0)}decrypt(e){return this.W(e,1)}T(){const e=this.O[0],t=this.O[1],n=e[4],r=t[4],s=[],i=[];let o,c,f,a;for(let e=0;256>e;e++)i[(s[e]=e<<1^283*(e>>7))^e]=e;for(let l=o=0;!n[l];l^=c||1,o=i[o]||1){let i=o^o<<1^o<<2^o<<3^o<<4;i=i>>8^255&i^99,n[l]=i,r[i]=l,a=s[f=s[c=s[l]]];let u=16843009*a^65537*f^257*c^16843008*l,w=257*s[i]^16843008*i;for(let n=0;4>n;n++)e[n][l]=w=w<<24^w>>>8,t[n][i]=u=u<<24^u>>>8}for(let n=0;5>n;n++)e[n]=e[n].slice(0),t[n]=t[n].slice(0)}W(e,t){if(4!==e.length)throw new s("invalid aes block size");const n=this.v[t],r=n.length/4-2,i=[0,0,0,0],o=this.O[t],c=o[0],f=o[1],a=o[2],l=o[3],u=o[4];let w,h,d,p=e[0]^n[0],y=e[t?3:1]^n[1],m=e[2]^n[2],b=e[t?1:3]^n[3],g=4;for(let e=0;r>e;e++)w=c[p>>>24]^f[y>>16&255]^a[m>>8&255]^l[255&b]^n[g],h=c[y>>>24]^f[m>>16&255]^a[b>>8&255]^l[255&p]^n[g+1],d=c[m>>>24]^f[b>>16&255]^a[p>>8&255]^l[255&y]^n[g+2],b=c[b>>>24]^f[p>>16&255]^a[y>>8&255]^l[255&m]^n[g+3],g+=4,p=w,y=h,m=d;for(let e=0;4>e;e++)i[t?3&-e:e]=u[p>>>24]<<24^u[y>>16&255]<<16^u[m>>8&255]<<8^u[255&b]^n[g++],w=p,p=y,y=m,m=b,b=w;return i}},Y=class{constructor(e,t){this.j=e,this.H=t,this.L=t}reset(){this.L=this.H}update(e){return this.F(this.j,e,this.L)}q(e){if(255&~(e>>24))e+=1<<24;else{let t=e>>16&255,n=e>>8&255,r=255&e;255===t?(t=0,255===n?(n=0,255===r?r=0:++r):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=r}return e}G(e){0===(e[0]=this.q(e[0]))&&(e[1]=this.q(e[1]))}F(e,t,n){let r;if(!(r=t.length))return[];const s=I.l(t);for(let s=0;r>s;s+=4){this.G(n);const r=e.encrypt(n);t[s]^=r[0],t[s+1]^=r[1],t[s+2]^=r[2],t[s+3]^=r[3]}return I.u(t,s)}},Z=V.R;let $=q&&J&&typeof G.importKey==S,ee=q&&J&&typeof G.deriveBits==S;class te extends p{constructor({password:e,rawPassword:n,signed:r,encryptionStrength:o,checkPasswordOnly:c}){super({start(){t.assign(this,{ready:new u(e=>this.J=e),password:ie(e,n),signed:r,X:o-1,pending:new i})},async transform(e,t){const n=this,{password:r,X:o,J:f,ready:a}=n;r?(await(async(e,t,n,r)=>{const i=await se(e,t,n,ce(r,0,j[t])),o=ce(r,j[t]);if(i[0]!=o[0]||i[1]!=o[1])throw new s(B)})(n,o,r,ce(e,0,j[o]+2)),e=ce(e,j[o]+2),c?t.error(new s(M)):f()):await a;const l=new i(e.length-L-(e.length-L)%K);t.enqueue(re(n,e,l,0,L,!0))},async flush(e){const{signed:t,Y:n,Z:r,pending:o,ready:c}=this;if(r&&n){await c;const f=ce(o,0,o.length-L),a=ce(o,o.length-L);let l=new i;if(f.length){const e=ae(Q,f);r.update(e);const t=n.update(e);l=fe(Q,t)}if(t){const e=ce(fe(Q,r.digest()),0,L);for(let t=0;L>t;t++)if(e[t]!=a[t])throw new s(E)}e.enqueue(l)}}})}}class ne extends p{constructor({password:e,rawPassword:n,encryptionStrength:r}){let s;super({start(){t.assign(this,{ready:new u(e=>this.J=e),password:ie(e,n),X:r-1,pending:new i})},async transform(e,t){const n=this,{password:r,X:s,J:o,ready:c}=n;let f=new i;r?(f=await(async(e,t,n)=>{const r=U(new i(j[t]));return oe(r,await se(e,t,n,r))})(n,s,r),o()):await c;const a=new i(f.length+e.length-e.length%K);a.set(f,0),t.enqueue(re(n,e,a,f.length,0))},async flush(e){const{Y:t,Z:n,pending:r,ready:o}=this;if(n&&t){await o;let c=new i;if(r.length){const e=t.update(ae(Q,r));n.update(e),c=fe(Q,e)}s.signature=fe(Q,n.digest()).slice(0,L),e.enqueue(oe(c,s.signature))}}}),s=this}}function re(e,t,n,r,s,o){const{Y:c,Z:f,pending:a}=e,l=t.length-s;let u;for(a.length&&(t=oe(a,t),n=((e,t)=>{if(t&&t>e.length){const n=e;(e=new i(t)).set(n,0)}return e})(n,l-l%K)),u=0;l-K>=u;u+=K){const e=ae(Q,ce(t,u,u+K));o&&f.update(e);const s=c.update(e);o||f.update(s),n.set(fe(Q,s),u+r)}return e.pending=ce(t,u),n}async function se(n,r,s,o){n.password=null;const c=await(async(e,t,n,r,s)=>{if(!$)return V.importKey(t);try{return await G.importKey("raw",t,n,!1,s)}catch(e){return $=!1,V.importKey(t)}})(0,s,O,0,W),f=await(async(e,t,n)=>{if(!ee)return V.B(t,e.salt,T.iterations,n);try{return await G.deriveBits(e,t,n)}catch(r){return ee=!1,V.B(t,e.salt,T.iterations,n)}})(t.assign({salt:o},T),c,8*(2*H[r]+2)),a=new i(f),l=ae(Q,ce(a,0,H[r])),u=ae(Q,ce(a,H[r],2*H[r])),w=ce(a,2*H[r]);return t.assign(n,{keys:{key:l,$:u,passwordVerification:w},Y:new Y(new X(l),e.from(F)),Z:new Z(u)}),w}function ie(e,t){return t===k?(e=>{if(typeof w==v){const t=new i((e=unescape(encodeURIComponent(e))).length);for(let n=0;n<t.length;n++)t[n]=e.charCodeAt(n);return t}return(new w).encode(e)})(e):t}function oe(e,t){let n=e;return e.length+t.length&&(n=new i(e.length+t.length),n.set(e,0),n.set(t,e.length)),n}function ce(e,t,n){return e.subarray(t,n)}function fe(e,t){return e.p(t)}function ae(e,t){return e.m(t)}class le extends p{constructor({password:e,passwordVerification:n,checkPasswordOnly:r}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;if(n.password){const t=we(n,e.subarray(0,12));if(n.password=null,t[11]!=n.passwordVerification)throw new s(B);e=e.subarray(12)}r?t.error(new s(M)):t.enqueue(we(n,e))}})}}class ue extends p{constructor({password:e,passwordVerification:n}){super({start(){t.assign(this,{password:e,passwordVerification:n}),de(this,e)},transform(e,t){const n=this;let r,s;if(n.password){n.password=null;const t=U(new i(12));t[11]=n.passwordVerification,r=new i(e.length+t.length),r.set(he(n,t),0),s=12}else r=new i(e.length),s=0;r.set(he(n,e),s),t.enqueue(r)}})}}function we(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,n[r]);return n}function he(e,t){const n=new i(t.length);for(let r=0;r<t.length;r++)n[r]=ye(e)^t[r],pe(e,t[r]);return n}function de(e,n){const r=[305419896,591751049,878082192];t.assign(e,{keys:r,ee:new x(r[0]),te:new x(r[2])});for(let t=0;t<n.length;t++)pe(e,n.charCodeAt(t))}function pe(e,t){let[n,s,i]=e.keys;e.ee.append([t]),n=~e.ee.get(),s=be(r.imul(be(s+me(n)),134775813)+1),e.te.append([s>>>24]),i=~e.te.get(),e.keys=[n,s,i]}function ye(e){const t=2|e.keys[2];return me(r.imul(t,1^t)>>>8)}function me(e){return 255&e}function be(e){return 4294967295&e}const ge="deflate-raw";class ke extends p{constructor(e,{chunkSize:t,CompressionStream:n,CompressionStreamNative:r}){super({});const{compressed:s,encrypted:i,useCompressionStream:o,zipCrypto:c,signed:f,level:a}=e,u=this;let w,h,d=super.readable;i&&!c||!f||(w=new A,d=Ce(d,w)),s&&(d=ze(d,o,{level:a,chunkSize:t},r,n)),i&&(c?d=Ce(d,new ue(e)):(h=new ne(e),d=Ce(d,h))),Se(u,d,()=>{let e;i&&!c&&(e=h.signature),i&&!c||!f||(e=new l(w.value.buffer).getUint32(0)),u.signature=e})}}class ve extends p{constructor(e,{chunkSize:t,DecompressionStream:n,DecompressionStreamNative:r}){super({});const{zipCrypto:i,encrypted:o,signed:c,signature:f,compressed:a,useCompressionStream:u}=e;let w,h,d=super.readable;o&&(i?d=Ce(d,new le(e)):(h=new te(e),d=Ce(d,h))),a&&(d=ze(d,u,{chunkSize:t},r,n)),o&&!i||!c||(w=new A,d=Ce(d,w)),Se(this,d,()=>{if((!o||i)&&c){const e=new l(w.value.buffer);if(f!=e.getUint32(0,!1))throw new s(E)}})}}function Se(e,n,r){n=Ce(n,new p({flush:r})),t.defineProperty(e,"readable",{get:()=>n})}function ze(e,t,n,r,s){try{e=Ce(e,new(t&&r?r:s)(ge,n))}catch(r){if(!t)throw r;e=Ce(e,new s(ge,n))}return e}function Ce(e,t){return e.pipeThrough(t)}const xe="data",Ae="close";class Ie extends p{constructor(e,n){super({});const r=this,{codecType:i}=e;let o;i.startsWith("deflate")?o=ke:i.startsWith("inflate")&&(o=ve),r.outputSize=0;let c=0;const f=new o(e,n),a=super.readable,l=new p({transform(e,t){e&&e.length&&(c+=e.length,t.enqueue(e))},flush(){t.assign(r,{inputSize:c})}}),u=new p({transform(t,n){if(t&&t.length&&(n.enqueue(t),r.outputSize+=t.length,e.outputSize&&r.outputSize>e.outputSize))throw new s("Invalid uncompressed size")},flush(){const{signature:e}=f;t.assign(r,{signature:e,inputSize:c})}});t.defineProperty(r,"readable",{get:()=>a.pipeThrough(l).pipeThrough(f).pipeThrough(u)})}}class _e extends p{constructor(e){let t;super({transform:function n(r,s){if(t){const e=new i(t.length+r.length);e.set(t),e.set(r,t.length),r=e,t=null}r.length>e?(s.enqueue(r.slice(0,e)),n(r.slice(e),s)):t=r},flush(e){t&&t.length&&e.enqueue(t)}})}}const Pe=new a,De=new a;let Ve,Re=0,Be=!0;async function Ee(e){try{const{options:t,scripts:r,config:s}=e;if(r&&r.length)try{Be?importScripts.apply(k,r):await Me(r)}catch(e){Be=!1,await Me(r)}self.initCodec&&self.initCodec(),s.CompressionStreamNative=self.CompressionStream,s.DecompressionStreamNative=self.DecompressionStream,self.Deflate&&(s.CompressionStream=new z(self.Deflate)),self.Inflate&&(s.DecompressionStream=new z(self.Inflate));const i={highWaterMark:1},o=e.readable||new y({async pull(e){const t=new u(e=>Pe.set(Re,e));Ue({type:"pull",messageId:Re}),Re=(Re+1)%n.MAX_SAFE_INTEGER;const{value:r,done:s}=await t;e.enqueue(r),s&&e.close()}},i),c=e.writable||new m({async write(e){let t;const r=new u(e=>t=e);De.set(Re,t),Ue({type:xe,value:e,messageId:Re}),Re=(Re+1)%n.MAX_SAFE_INTEGER,await r}},i),f=new Ie(t,s);Ve=new AbortController;const{signal:a}=Ve;await o.pipeThrough(f).pipeThrough(new _e(s.chunkSize)).pipeTo(c,{signal:a,preventClose:!0,preventAbort:!0}),await c.getWriter().close();const{signature:l,inputSize:w,outputSize:h}=f;Ue({type:Ae,result:{signature:l,inputSize:w,outputSize:h}})}catch(e){e.outputSize=0,Ke(e)}}async function Me(e){for(const t of e)await import(t)}function Ue(e){let{value:t}=e;if(t)if(t.length)try{t=new i(t),e.value=t.buffer,d(e,[e.value])}catch(t){d(e)}else d(e);else d(e)}function Ke(e=new s("Unknown error")){const{message:t,stack:n,code:r,name:i,outputSize:o}=e;d({error:{message:t,stack:n,code:r,name:i,outputSize:o}})}addEventListener("message",({data:e})=>{const{type:t,messageId:n,value:r,done:s}=e;try{if("start"==t&&Ee(e),t==xe){const e=Pe.get(n);Pe.delete(n),e({value:new i(r),done:s})}if("ack"==t){const e=De.get(n);De.delete(n),e()}t==Ae&&Ve.abort()}catch(e){Ke(e)}});const Ne=-2;function Oe(t){return Te(t.map(([t,n])=>new e(t).fill(n,0,t)))}function Te(t){return t.reduce((t,n)=>t.concat(e.isArray(n)?Te(n):n),[])}const We=[0,1,2,3].concat(...Oe([[2,4],[2,5],[4,6],[4,7],[8,8],[8,9],[16,10],[16,11],[32,12],[32,13],[64,14],[64,15],[2,0],[1,16],[1,17],[2,18],[2,19],[4,20],[4,21],[8,22],[8,23],[16,24],[16,25],[32,26],[32,27],[64,28],[64,29]]));function je(){const e=this;function t(e,t){let n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}e.ne=n=>{const s=e.re,i=e.ie.se,o=e.ie.oe;let c,f,a,l=-1;for(n.ce=0,n.fe=573,c=0;o>c;c++)0!==s[2*c]?(n.ae[++n.ce]=l=c,n.le[c]=0):s[2*c+1]=0;for(;2>n.ce;)a=n.ae[++n.ce]=2>l?++l:0,s[2*a]=1,n.le[a]=0,n.ue--,i&&(n.we-=i[2*a+1]);for(e.he=l,c=r.floor(n.ce/2);c>=1;c--)n.de(s,c);a=o;do{c=n.ae[1],n.ae[1]=n.ae[n.ce--],n.de(s,1),f=n.ae[1],n.ae[--n.fe]=c,n.ae[--n.fe]=f,s[2*a]=s[2*c]+s[2*f],n.le[a]=r.max(n.le[c],n.le[f])+1,s[2*c+1]=s[2*f+1]=a,n.ae[1]=a++,n.de(s,1)}while(n.ce>=2);n.ae[--n.fe]=n.ae[1],(t=>{const n=e.re,r=e.ie.se,s=e.ie.pe,i=e.ie.ye,o=e.ie.me;let c,f,a,l,u,w,h=0;for(l=0;15>=l;l++)t.be[l]=0;for(n[2*t.ae[t.fe]+1]=0,c=t.fe+1;573>c;c++)f=t.ae[c],l=n[2*n[2*f+1]+1]+1,l>o&&(l=o,h++),n[2*f+1]=l,f>e.he||(t.be[l]++,u=0,i>f||(u=s[f-i]),w=n[2*f],t.ue+=w*(l+u),r&&(t.we+=w*(r[2*f+1]+u)));if(0!==h){do{for(l=o-1;0===t.be[l];)l--;t.be[l]--,t.be[l+1]+=2,t.be[o]--,h-=2}while(h>0);for(l=o;0!==l;l--)for(f=t.be[l];0!==f;)a=t.ae[--c],a>e.he||(n[2*a+1]!=l&&(t.ue+=(l-n[2*a+1])*n[2*a],n[2*a+1]=l),f--)}})(n),((e,n,r)=>{const s=[];let i,o,c,f=0;for(i=1;15>=i;i++)s[i]=f=f+r[i-1]<<1;for(o=0;n>=o;o++)c=e[2*o+1],0!==c&&(e[2*o]=t(s[c]++,c))})(s,e.he,n.be)}}function He(e,t,n,r,s){const i=this;i.se=e,i.pe=t,i.ye=n,i.oe=r,i.me=s}je.ge=[0,1,2,3,4,5,6,7].concat(...Oe([[2,8],[2,9],[2,10],[2,11],[4,12],[4,13],[4,14],[4,15],[8,16],[8,17],[8,18],[8,19],[16,20],[16,21],[16,22],[16,23],[32,24],[32,25],[32,26],[31,27],[1,28]])),je.ke=[0,1,2,3,4,5,6,7,8,10,12,14,16,20,24,28,32,40,48,56,64,80,96,112,128,160,192,224,0],je.ve=[0,1,2,3,4,6,8,12,16,24,32,48,64,96,128,192,256,384,512,768,1024,1536,2048,3072,4096,6144,8192,12288,16384,24576],je.Se=e=>256>e?We[e]:We[256+(e>>>7)],je.ze=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],je.Ce=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],je.xe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],je.Ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];const Le=Oe([[144,8],[112,9],[24,7],[8,8]]);He.Ie=Te([12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,19,275,147,403,83,339,211,467,51,307,179,435,115,371,243,499,11,267,139,395,75,331,203,459,43,299,171,427,107,363,235,491,27,283,155,411,91,347,219,475,59,315,187,443,123,379,251,507,7,263,135,391,71,327,199,455,39,295,167,423,103,359,231,487,23,279,151,407,87,343,215,471,55,311,183,439,119,375,247,503,15,271,143,399,79,335,207,463,47,303,175,431,111,367,239,495,31,287,159,415,95,351,223,479,63,319,191,447,127,383,255,511,0,64,32,96,16,80,48,112,8,72,40,104,24,88,56,120,4,68,36,100,20,84,52,116,3,131,67,195,35,163,99,227].map((e,t)=>[e,Le[t]]));const Fe=Oe([[30,5]]);function qe(e,t,n,r,s){const i=this;i._e=e,i.Pe=t,i.De=n,i.Ve=r,i.Re=s}He.Be=Te([0,16,8,24,4,20,12,28,2,18,10,26,6,22,14,30,1,17,9,25,5,21,13,29,3,19,11,27,7,23].map((e,t)=>[e,Fe[t]])),He.Ee=new He(He.Ie,je.ze,257,286,15),He.Me=new He(He.Be,je.Ce,0,30,15),He.Ue=new He(null,je.xe,0,19,7);const Ge=[new qe(0,0,0,0,0),new qe(4,4,8,4,1),new qe(4,5,16,8,1),new qe(4,6,32,32,1),new qe(4,4,16,16,2),new qe(8,16,32,32,2),new qe(8,16,128,128,2),new qe(8,32,128,256,2),new qe(32,128,258,1024,2),new qe(32,258,258,4096,2)],Je=["need dictionary","stream end","","","stream error","data error","","buffer error","",""],Qe=113,Xe=666,Ye=262;function Ze(e,t,n,r){const s=e[2*t],i=e[2*n];return i>s||s==i&&r[t]<=r[n]}function $e(){const e=this;let t,n,s,c,f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z,C,x,A,I,_,P,D,V,R,B,E,M,U;const K=new je,N=new je,O=new je;let T,W,j,H,L,F;function q(){let t;for(t=0;286>t;t++)E[2*t]=0;for(t=0;30>t;t++)M[2*t]=0;for(t=0;19>t;t++)U[2*t]=0;E[512]=1,e.ue=e.we=0,W=j=0}function G(e,t){let n,r=-1,s=e[1],i=0,o=7,c=4;0===s&&(o=138,c=3),e[2*(t+1)+1]=65535;for(let f=0;t>=f;f++)n=s,s=e[2*(f+1)+1],++i<o&&n==s||(c>i?U[2*n]+=i:0!==n?(n!=r&&U[2*n]++,U[32]++):i>10?U[36]++:U[34]++,i=0,r=n,0===s?(o=138,c=3):n==s?(o=6,c=3):(o=7,c=4))}function J(t){e.Ke[e.pending++]=t}function Q(e){J(255&e),J(e>>>8&255)}function X(e,t){let n;const r=t;F>16-r?(n=e,L|=n<<F&65535,Q(L),L=n>>>16-F,F+=r-16):(L|=e<<F&65535,F+=r)}function Y(e,t){const n=2*e;X(65535&t[n],65535&t[n+1])}function Z(e,t){let n,r,s=-1,i=e[1],o=0,c=7,f=4;for(0===i&&(c=138,f=3),n=0;t>=n;n++)if(r=i,i=e[2*(n+1)+1],++o>=c||r!=i){if(f>o)do{Y(r,U)}while(0!==--o);else 0!==r?(r!=s&&(Y(r,U),o--),Y(16,U),X(o-3,2)):o>10?(Y(18,U),X(o-11,7)):(Y(17,U),X(o-3,3));o=0,s=r,0===i?(c=138,f=3):r==i?(c=6,f=3):(c=7,f=4)}}function $(){16==F?(Q(L),L=0,F=0):8>F||(J(255&L),L>>>=8,F-=8)}function ee(t,n){let s,i,o;if(e.Ne[W]=t,e.Oe[W]=255&n,W++,0===t?E[2*n]++:(j++,t--,E[2*(je.ge[n]+256+1)]++,M[2*je.Se(t)]++),!(8191&W)&&D>2){for(s=8*W,i=C-k,o=0;30>o;o++)s+=M[2*o]*(5+je.Ce[o]);if(s>>>=3,j<r.floor(W/2)&&s<r.floor(i/2))return!0}return W==T-1}function te(t,n){let r,s,i,o,c=0;if(0!==W)do{r=e.Ne[c],s=e.Oe[c],c++,0===r?Y(s,t):(i=je.ge[s],Y(i+256+1,t),o=je.ze[i],0!==o&&(s-=je.ke[i],X(s,o)),r--,i=je.Se(r),Y(i,n),o=je.Ce[i],0!==o&&(r-=je.ve[i],X(r,o)))}while(W>c);Y(256,t),H=t[513]}function ne(){F>8?Q(L):F>0&&J(255&L),L=0,F=0}function re(t,n,r){X(0+(r?1:0),3),((t,n)=>{ne(),H=8,Q(n),Q(~n),e.Ke.set(u.subarray(t,t+n),e.pending),e.pending+=n})(t,n)}function se(n){((t,n,r)=>{let s,i,o=0;D>0?(K.ne(e),N.ne(e),o=(()=>{let t;for(G(E,K.he),G(M,N.he),O.ne(e),t=18;t>=3&&0===U[2*je.Ae[t]+1];t--);return e.ue+=14+3*(t+1),t})(),s=e.ue+3+7>>>3,i=e.we+3+7>>>3,i>s||(s=i)):s=i=n+5,n+4>s||-1==t?i==s?(X(2+(r?1:0),3),te(He.Ie,He.Be)):(X(4+(r?1:0),3),((e,t,n)=>{let r;for(X(e-257,5),X(t-1,5),X(n-4,4),r=0;n>r;r++)X(U[2*je.Ae[r]+1],3);Z(E,e-1),Z(M,t-1)})(K.he+1,N.he+1,o+1),te(E,M)):re(t,n,r),q(),r&&ne()})(0>k?-1:k,C-k,n),k=C,t.Te()}function ie(){let e,n,r,s;do{if(s=w-A-C,0===s&&0===C&&0===A)s=f;else if(-1==s)s--;else if(C>=f+f-Ye){u.set(u.subarray(f,f+f),0),x-=f,C-=f,k-=f,e=y,r=e;do{n=65535&d[--r],d[r]=f>n?0:n-f}while(0!==--e);e=f,r=e;do{n=65535&h[--r],h[r]=f>n?0:n-f}while(0!==--e);s+=f}if(0===t.We)return;e=t.je(u,C+A,s),A+=e,3>A||(p=255&u[C],p=(p<<g^255&u[C+1])&b)}while(Ye>A&&0!==t.We)}function oe(e){let t,n,r=_,s=C,i=I;const o=C>f-Ye?C-(f-Ye):0;let c=B;const a=l,w=C+258;let d=u[s+i-1],p=u[s+i];R>I||(r>>=2),c>A&&(c=A);do{if(t=e,u[t+i]==p&&u[t+i-1]==d&&u[t]==u[s]&&u[++t]==u[s+1]){s+=2,t++;do{}while(u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&u[++s]==u[++t]&&w>s);if(n=258-(w-s),s=w-258,n>i){if(x=e,i=n,n>=c)break;d=u[s+i-1],p=u[s+i]}}}while((e=65535&h[e&a])>o&&0!==--r);return i>A?A:i}e.le=[],e.be=[],e.ae=[],E=[],M=[],U=[],e.de=(t,n)=>{const r=e.ae,s=r[n];let i=n<<1;for(;i<=e.ce&&(i<e.ce&&Ze(t,r[i+1],r[i],e.le)&&i++,!Ze(t,s,r[i],e.le));)r[n]=r[i],n=i,i<<=1;r[n]=s},e.He=(t,S,x,W,j,G)=>(W||(W=8),j||(j=8),G||(G=0),t.Le=null,-1==S&&(S=6),1>j||j>9||8!=W||9>x||x>15||0>S||S>9||0>G||G>2?Ne:(t.Fe=e,a=x,f=1<<a,l=f-1,m=j+7,y=1<<m,b=y-1,g=r.floor((m+3-1)/3),u=new i(2*f),h=[],d=[],T=1<<j+6,e.Ke=new i(4*T),s=4*T,e.Ne=new o(T),e.Oe=new i(T),D=S,V=G,(t=>(t.qe=t.Ge=0,t.Le=null,e.pending=0,e.Je=0,n=Qe,c=0,K.re=E,K.ie=He.Ee,N.re=M,N.ie=He.Me,O.re=U,O.ie=He.Ue,L=0,F=0,H=8,q(),(()=>{w=2*f,d[y-1]=0;for(let e=0;y-1>e;e++)d[e]=0;P=Ge[D].Pe,R=Ge[D]._e,B=Ge[D].De,_=Ge[D].Ve,C=0,k=0,A=0,v=I=2,z=0,p=0})(),0))(t))),e.Qe=()=>42!=n&&n!=Qe&&n!=Xe?Ne:(e.Oe=null,e.Ne=null,e.Ke=null,d=null,h=null,u=null,e.Fe=null,n==Qe?-3:0),e.Xe=(e,t,n)=>{let r=0;return-1==t&&(t=6),0>t||t>9||0>n||n>2?Ne:(Ge[D].Re!=Ge[t].Re&&0!==e.qe&&(r=e.Ye(1)),D!=t&&(D=t,P=Ge[D].Pe,R=Ge[D]._e,B=Ge[D].De,_=Ge[D].Ve),V=n,r)},e.Ze=(e,t,r)=>{let s,i=r,o=0;if(!t||42!=n)return Ne;if(3>i)return 0;for(i>f-Ye&&(i=f-Ye,o=r-i),u.set(t.subarray(o,o+i),0),C=i,k=i,p=255&u[0],p=(p<<g^255&u[1])&b,s=0;i-3>=s;s++)p=(p<<g^255&u[s+2])&b,h[s&l]=d[p],d[p]=s;return 0},e.Ye=(r,i)=>{let o,w,m,_,R;if(i>4||0>i)return Ne;if(!r.$e||!r.et&&0!==r.We||n==Xe&&4!=i)return r.Le=Je[4],Ne;if(0===r.tt)return r.Le=Je[7],-5;var B;if(t=r,_=c,c=i,42==n&&(w=8+(a-8<<4)<<8,m=(D-1&255)>>1,m>3&&(m=3),w|=m<<6,0!==C&&(w|=32),w+=31-w%31,n=Qe,J((B=w)>>8&255),J(255&B)),0!==e.pending){if(t.Te(),0===t.tt)return c=-1,0}else if(0===t.We&&_>=i&&4!=i)return t.Le=Je[7],-5;if(n==Xe&&0!==t.We)return r.Le=Je[7],-5;if(0!==t.We||0!==A||0!=i&&n!=Xe){switch(R=-1,Ge[D].Re){case 0:R=(e=>{let n,r=65535;for(r>s-5&&(r=s-5);;){if(1>=A){if(ie(),0===A&&0==e)return 0;if(0===A)break}if(C+=A,A=0,n=k+r,(0===C||C>=n)&&(A=C-n,C=n,se(!1),0===t.tt))return 0;if(C-k>=f-Ye&&(se(!1),0===t.tt))return 0}return se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i);break;case 1:R=(e=>{let n,r=0;for(;;){if(Ye>A){if(ie(),Ye>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C),0===r||(C-r&65535)>f-Ye||2!=V&&(v=oe(r)),3>v)n=ee(0,255&u[C]),A--,C++;else if(n=ee(C-x,v-3),A-=v,v>P||3>A)C+=v,v=0,p=255&u[C],p=(p<<g^255&u[C+1])&b;else{v--;do{C++,p=(p<<g^255&u[C+2])&b,r=65535&d[p],h[C&l]=d[p],d[p]=C}while(0!==--v);C++}if(n&&(se(!1),0===t.tt))return 0}return se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i);break;case 2:R=(e=>{let n,r,s=0;for(;;){if(Ye>A){if(ie(),Ye>A&&0==e)return 0;if(0===A)break}if(3>A||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C),I=v,S=x,v=2,0!==s&&P>I&&f-Ye>=(C-s&65535)&&(2!=V&&(v=oe(s)),5>=v&&(1==V||3==v&&C-x>4096)&&(v=2)),3>I||v>I)if(0!==z){if(n=ee(0,255&u[C-1]),n&&se(!1),C++,A--,0===t.tt)return 0}else z=1,C++,A--;else{r=C+A-3,n=ee(C-1-S,I-3),A-=I-1,I-=2;do{++C>r||(p=(p<<g^255&u[C+2])&b,s=65535&d[p],h[C&l]=d[p],d[p]=C)}while(0!==--I);if(z=0,v=2,C++,n&&(se(!1),0===t.tt))return 0}}return 0!==z&&(n=ee(0,255&u[C-1]),z=0),se(4==e),0===t.tt?4==e?2:0:4==e?3:1})(i)}if(2!=R&&3!=R||(n=Xe),0==R||2==R)return 0===t.tt&&(c=-1),0;if(1==R){if(1==i)X(2,3),Y(256,He.Ie),$(),9>1+H+10-F&&(X(2,3),Y(256,He.Ie),$()),H=7;else if(re(0,0,!1),3==i)for(o=0;y>o;o++)d[o]=0;if(t.Te(),0===t.tt)return c=-1,0}}return 4!=i?0:1}}function et(){const e=this;e.nt=0,e.rt=0,e.We=0,e.qe=0,e.tt=0,e.Ge=0}function tt(e){const t=new et,n=(o=e&&e.chunkSize?e.chunkSize:65536)+5*(r.floor(o/16383)+1);var o;const c=new i(n);let f=e?e.level:-1;void 0===f&&(f=-1),t.He(f),t.$e=c,this.append=(e,r)=>{let o,f,a=0,l=0,u=0;const w=[];if(e.length){t.nt=0,t.et=e,t.We=e.length;do{if(t.rt=0,t.tt=n,o=t.Ye(0),0!=o)throw new s("deflating: "+t.Le);t.rt&&(t.rt==n?w.push(new i(c)):w.push(c.subarray(0,t.rt))),u+=t.rt,r&&t.nt>0&&t.nt!=a&&(r(t.nt),a=t.nt)}while(t.We>0||0===t.tt);return w.length>1?(f=new i(u),w.forEach(e=>{f.set(e,l),l+=e.length})):f=w[0]?new i(w[0]):new i,f}},this.flush=()=>{let e,r,o=0,f=0;const a=[];do{if(t.rt=0,t.tt=n,e=t.Ye(4),1!=e&&0!=e)throw new s("deflating: "+t.Le);n-t.tt>0&&a.push(c.slice(0,t.rt)),f+=t.rt}while(t.We>0||0===t.tt);return t.Qe(),r=new i(f),a.forEach(e=>{r.set(e,o),o+=e.length}),r}}et.prototype={He(e,t){const n=this;return n.Fe=new $e,t||(t=15),n.Fe.He(n,e,t)},Ye(e){const t=this;return t.Fe?t.Fe.Ye(t,e):Ne},Qe(){const e=this;if(!e.Fe)return Ne;const t=e.Fe.Qe();return e.Fe=null,t},Xe(e,t){const n=this;return n.Fe?n.Fe.Xe(n,e,t):Ne},Ze(e,t){const n=this;return n.Fe?n.Fe.Ze(n,e,t):Ne},je(e,t,n){const r=this;let s=r.We;return s>n&&(s=n),0===s?0:(r.We-=s,e.set(r.et.subarray(r.nt,r.nt+s),t),r.nt+=s,r.qe+=s,s)},Te(){const e=this;let t=e.Fe.pending;t>e.tt&&(t=e.tt),0!==t&&(e.$e.set(e.Fe.Ke.subarray(e.Fe.Je,e.Fe.Je+t),e.rt),e.rt+=t,e.Fe.Je+=t,e.Ge+=t,e.tt-=t,e.Fe.pending-=t,0===e.Fe.pending&&(e.Fe.Je=0))}};const nt=-2,rt=-3,st=-5,it=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535],ot=[96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,192,80,7,10,0,8,96,0,8,32,0,9,160,0,8,0,0,8,128,0,8,64,0,9,224,80,7,6,0,8,88,0,8,24,0,9,144,83,7,59,0,8,120,0,8,56,0,9,208,81,7,17,0,8,104,0,8,40,0,9,176,0,8,8,0,8,136,0,8,72,0,9,240,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,200,81,7,13,0,8,100,0,8,36,0,9,168,0,8,4,0,8,132,0,8,68,0,9,232,80,7,8,0,8,92,0,8,28,0,9,152,84,7,83,0,8,124,0,8,60,0,9,216,82,7,23,0,8,108,0,8,44,0,9,184,0,8,12,0,8,140,0,8,76,0,9,248,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,196,81,7,11,0,8,98,0,8,34,0,9,164,0,8,2,0,8,130,0,8,66,0,9,228,80,7,7,0,8,90,0,8,26,0,9,148,84,7,67,0,8,122,0,8,58,0,9,212,82,7,19,0,8,106,0,8,42,0,9,180,0,8,10,0,8,138,0,8,74,0,9,244,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,204,81,7,15,0,8,102,0,8,38,0,9,172,0,8,6,0,8,134,0,8,70,0,9,236,80,7,9,0,8,94,0,8,30,0,9,156,84,7,99,0,8,126,0,8,62,0,9,220,82,7,27,0,8,110,0,8,46,0,9,188,0,8,14,0,8,142,0,8,78,0,9,252,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,194,80,7,10,0,8,97,0,8,33,0,9,162,0,8,1,0,8,129,0,8,65,0,9,226,80,7,6,0,8,89,0,8,25,0,9,146,83,7,59,0,8,121,0,8,57,0,9,210,81,7,17,0,8,105,0,8,41,0,9,178,0,8,9,0,8,137,0,8,73,0,9,242,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,202,81,7,13,0,8,101,0,8,37,0,9,170,0,8,5,0,8,133,0,8,69,0,9,234,80,7,8,0,8,93,0,8,29,0,9,154,84,7,83,0,8,125,0,8,61,0,9,218,82,7,23,0,8,109,0,8,45,0,9,186,0,8,13,0,8,141,0,8,77,0,9,250,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,198,81,7,11,0,8,99,0,8,35,0,9,166,0,8,3,0,8,131,0,8,67,0,9,230,80,7,7,0,8,91,0,8,27,0,9,150,84,7,67,0,8,123,0,8,59,0,9,214,82,7,19,0,8,107,0,8,43,0,9,182,0,8,11,0,8,139,0,8,75,0,9,246,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,206,81,7,15,0,8,103,0,8,39,0,9,174,0,8,7,0,8,135,0,8,71,0,9,238,80,7,9,0,8,95,0,8,31,0,9,158,84,7,99,0,8,127,0,8,63,0,9,222,82,7,27,0,8,111,0,8,47,0,9,190,0,8,15,0,8,143,0,8,79,0,9,254,96,7,256,0,8,80,0,8,16,84,8,115,82,7,31,0,8,112,0,8,48,0,9,193,80,7,10,0,8,96,0,8,32,0,9,161,0,8,0,0,8,128,0,8,64,0,9,225,80,7,6,0,8,88,0,8,24,0,9,145,83,7,59,0,8,120,0,8,56,0,9,209,81,7,17,0,8,104,0,8,40,0,9,177,0,8,8,0,8,136,0,8,72,0,9,241,80,7,4,0,8,84,0,8,20,85,8,227,83,7,43,0,8,116,0,8,52,0,9,201,81,7,13,0,8,100,0,8,36,0,9,169,0,8,4,0,8,132,0,8,68,0,9,233,80,7,8,0,8,92,0,8,28,0,9,153,84,7,83,0,8,124,0,8,60,0,9,217,82,7,23,0,8,108,0,8,44,0,9,185,0,8,12,0,8,140,0,8,76,0,9,249,80,7,3,0,8,82,0,8,18,85,8,163,83,7,35,0,8,114,0,8,50,0,9,197,81,7,11,0,8,98,0,8,34,0,9,165,0,8,2,0,8,130,0,8,66,0,9,229,80,7,7,0,8,90,0,8,26,0,9,149,84,7,67,0,8,122,0,8,58,0,9,213,82,7,19,0,8,106,0,8,42,0,9,181,0,8,10,0,8,138,0,8,74,0,9,245,80,7,5,0,8,86,0,8,22,192,8,0,83,7,51,0,8,118,0,8,54,0,9,205,81,7,15,0,8,102,0,8,38,0,9,173,0,8,6,0,8,134,0,8,70,0,9,237,80,7,9,0,8,94,0,8,30,0,9,157,84,7,99,0,8,126,0,8,62,0,9,221,82,7,27,0,8,110,0,8,46,0,9,189,0,8,14,0,8,142,0,8,78,0,9,253,96,7,256,0,8,81,0,8,17,85,8,131,82,7,31,0,8,113,0,8,49,0,9,195,80,7,10,0,8,97,0,8,33,0,9,163,0,8,1,0,8,129,0,8,65,0,9,227,80,7,6,0,8,89,0,8,25,0,9,147,83,7,59,0,8,121,0,8,57,0,9,211,81,7,17,0,8,105,0,8,41,0,9,179,0,8,9,0,8,137,0,8,73,0,9,243,80,7,4,0,8,85,0,8,21,80,8,258,83,7,43,0,8,117,0,8,53,0,9,203,81,7,13,0,8,101,0,8,37,0,9,171,0,8,5,0,8,133,0,8,69,0,9,235,80,7,8,0,8,93,0,8,29,0,9,155,84,7,83,0,8,125,0,8,61,0,9,219,82,7,23,0,8,109,0,8,45,0,9,187,0,8,13,0,8,141,0,8,77,0,9,251,80,7,3,0,8,83,0,8,19,85,8,195,83,7,35,0,8,115,0,8,51,0,9,199,81,7,11,0,8,99,0,8,35,0,9,167,0,8,3,0,8,131,0,8,67,0,9,231,80,7,7,0,8,91,0,8,27,0,9,151,84,7,67,0,8,123,0,8,59,0,9,215,82,7,19,0,8,107,0,8,43,0,9,183,0,8,11,0,8,139,0,8,75,0,9,247,80,7,5,0,8,87,0,8,23,192,8,0,83,7,51,0,8,119,0,8,55,0,9,207,81,7,15,0,8,103,0,8,39,0,9,175,0,8,7,0,8,135,0,8,71,0,9,239,80,7,9,0,8,95,0,8,31,0,9,159,84,7,99,0,8,127,0,8,63,0,9,223,82,7,27,0,8,111,0,8,47,0,9,191,0,8,15,0,8,143,0,8,79,0,9,255],ct=[80,5,1,87,5,257,83,5,17,91,5,4097,81,5,5,89,5,1025,85,5,65,93,5,16385,80,5,3,88,5,513,84,5,33,92,5,8193,82,5,9,90,5,2049,86,5,129,192,5,24577,80,5,2,87,5,385,83,5,25,91,5,6145,81,5,7,89,5,1537,85,5,97,93,5,24577,80,5,4,88,5,769,84,5,49,92,5,12289,82,5,13,90,5,3073,86,5,193,192,5,24577],ft=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],at=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,112,112],lt=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],ut=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];function wt(){let e,t,n,r,s,i;function o(e,t,o,c,f,a,l,u,w,h,d){let p,y,m,b,g,k,v,S,z,C,x,A,I,_,P;C=0,g=o;do{n[e[t+C]]++,C++,g--}while(0!==g);if(n[0]==o)return l[0]=-1,u[0]=0,0;for(S=u[0],k=1;15>=k&&0===n[k];k++);for(v=k,k>S&&(S=k),g=15;0!==g&&0===n[g];g--);for(m=g,S>g&&(S=g),u[0]=S,_=1<<k;g>k;k++,_<<=1)if(0>(_-=n[k]))return rt;if(0>(_-=n[g]))return rt;for(n[g]+=_,i[1]=k=0,C=1,I=2;0!==--g;)i[I]=k+=n[C],I++,C++;g=0,C=0;do{0!==(k=e[t+C])&&(d[i[k]++]=g),C++}while(++g<o);for(o=i[m],i[0]=g=0,C=0,b=-1,A=-S,s[0]=0,x=0,P=0;m>=v;v++)for(p=n[v];0!==p--;){for(;v>A+S;){if(b++,A+=S,P=m-A,P=P>S?S:P,(y=1<<(k=v-A))>p+1&&(y-=p+1,I=v,P>k))for(;++k<P&&(y<<=1)>n[++I];)y-=n[I];if(P=1<<k,h[0]+P>1440)return rt;s[b]=x=h[0],h[0]+=P,0!==b?(i[b]=g,r[0]=k,r[1]=S,k=g>>>A-S,r[2]=x-s[b-1]-k,w.set(r,3*(s[b-1]+k))):l[0]=x}for(r[1]=v-A,o>C?d[C]<c?(r[0]=256>d[C]?0:96,r[2]=d[C++]):(r[0]=a[d[C]-c]+16+64,r[2]=f[d[C++]-c]):r[0]=192,y=1<<v-A,k=g>>>A;P>k;k+=y)w.set(r,3*(x+k));for(k=1<<v-1;0!==(g&k);k>>>=1)g^=k;for(g^=k,z=(1<<A)-1;(g&z)!=i[b];)b--,A-=S,z=(1<<A)-1}return 0!==_&&1!=m?st:0}function c(o){let c;for(e||(e=[],t=[],n=new f(16),r=[],s=new f(15),i=new f(16)),t.length<o&&(t=[]),c=0;o>c;c++)t[c]=0;for(c=0;16>c;c++)n[c]=0;for(c=0;3>c;c++)r[c]=0;s.set(n.subarray(0,15),0),i.set(n.subarray(0,16),0)}this.st=(n,r,s,i,f)=>{let a;return c(19),e[0]=0,a=o(n,0,19,19,null,null,s,r,i,e,t),a==rt?f.Le="oversubscribed dynamic bit lengths tree":a!=st&&0!==r[0]||(f.Le="incomplete dynamic bit lengths tree",a=rt),a},this.it=(n,r,s,i,f,a,l,u,w)=>{let h;return c(288),e[0]=0,h=o(s,0,n,257,ft,at,a,i,u,e,t),0!=h||0===i[0]?(h==rt?w.Le="oversubscribed literal/length tree":-4!=h&&(w.Le="incomplete literal/length tree",h=rt),h):(c(288),h=o(s,n,r,0,lt,ut,l,f,u,e,t),0!=h||0===f[0]&&n>257?(h==rt?w.Le="oversubscribed distance tree":h==st?(w.Le="incomplete distance tree",h=rt):-4!=h&&(w.Le="empty distance tree with lengths",h=rt),h):0)}}function ht(){const e=this;let t,n,r,s,i=0,o=0,c=0,f=0,a=0,l=0,u=0,w=0,h=0,d=0;function p(e,t,n,r,s,i,o,c){let f,a,l,u,w,h,d,p,y,m,b,g,k,v,S,z;d=c.nt,p=c.We,w=o.ot,h=o.ct,y=o.write,m=y<o.read?o.read-y-1:o.end-y,b=it[e],g=it[t];do{for(;20>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;if(f=w&b,a=n,l=r,z=3*(l+f),0!==(u=a[z]))for(;;){if(w>>=a[z+1],h-=a[z+1],16&u){for(u&=15,k=a[z+2]+(w&it[u]),w>>=u,h-=u;15>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;for(f=w&g,a=s,l=i,z=3*(l+f),u=a[z];;){if(w>>=a[z+1],h-=a[z+1],16&u){for(u&=15;u>h;)p--,w|=(255&c.ft(d++))<<h,h+=8;if(v=a[z+2]+(w&it[u]),w>>=u,h-=u,m-=k,v>y){S=y-v;do{S+=o.end}while(0>S);if(u=o.end-S,k>u){if(k-=u,y-S>0&&u>y-S)do{o.lt[y++]=o.lt[S++]}while(0!==--u);else o.lt.set(o.lt.subarray(S,S+u),y),y+=u,S+=u,u=0;S=0}}else S=y-v,y-S>0&&2>y-S?(o.lt[y++]=o.lt[S++],o.lt[y++]=o.lt[S++],k-=2):(o.lt.set(o.lt.subarray(S,S+2),y),y+=2,S+=2,k-=2);if(y-S>0&&k>y-S)do{o.lt[y++]=o.lt[S++]}while(0!==--k);else o.lt.set(o.lt.subarray(S,S+k),y),y+=k,S+=k,k=0;break}if(64&u)return c.Le="invalid distance code",k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,rt;f+=a[z+2],f+=w&it[u],z=3*(l+f),u=a[z]}break}if(64&u)return 32&u?(k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,1):(c.Le="invalid literal/length code",k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,rt);if(f+=a[z+2],f+=w&it[u],z=3*(l+f),0===(u=a[z])){w>>=a[z+1],h-=a[z+1],o.lt[y++]=a[z+2],m--;break}}else w>>=a[z+1],h-=a[z+1],o.lt[y++]=a[z+2],m--}while(m>=258&&p>=10);return k=c.We-p,k=k>h>>3?h>>3:k,p+=k,d-=k,h-=k<<3,o.ot=w,o.ct=h,c.We=p,c.qe+=d-c.nt,c.nt=d,o.write=y,0}e.init=(e,i,o,c,f,a)=>{t=0,u=e,w=i,r=o,h=c,s=f,d=a,n=null},e.ut=(e,y,m)=>{let b,g,k,v,S,z,C,x=0,A=0,I=0;for(I=y.nt,v=y.We,x=e.ot,A=e.ct,S=e.write,z=S<e.read?e.read-S-1:e.end-S;;)switch(t){case 0:if(z>=258&&v>=10&&(e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,m=p(u,w,r,h,s,d,e,y),I=y.nt,v=y.We,x=e.ot,A=e.ct,S=e.write,z=S<e.read?e.read-S-1:e.end-S,0!=m)){t=1==m?7:9;break}c=u,n=r,o=h,t=1;case 1:for(b=c;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}if(g=3*(o+(x&it[b])),x>>>=n[g+1],A-=n[g+1],k=n[g],0===k){f=n[g+2],t=6;break}if(16&k){a=15&k,i=n[g+2],t=2;break}if(!(64&k)){c=k,o=g/3+n[g+2];break}if(32&k){t=7;break}return t=9,y.Le="invalid literal/length code",m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);case 2:for(b=a;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}i+=x&it[b],x>>=b,A-=b,c=w,n=s,o=d,t=3;case 3:for(b=c;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}if(g=3*(o+(x&it[b])),x>>=n[g+1],A-=n[g+1],k=n[g],16&k){a=15&k,l=n[g+2],t=4;break}if(!(64&k)){c=k,o=g/3+n[g+2];break}return t=9,y.Le="invalid distance code",m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);case 4:for(b=a;b>A;){if(0===v)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,v--,x|=(255&y.ft(I++))<<A,A+=8}l+=x&it[b],x>>=b,A-=b,t=5;case 5:for(C=S-l;0>C;)C+=e.end;for(;0!==i;){if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);e.lt[S++]=e.lt[C++],z--,C==e.end&&(C=0),i--}t=0;break;case 6:if(0===z&&(S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z&&(e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,S==e.end&&0!==e.read&&(S=0,z=S<e.read?e.read-S-1:e.end-S),0===z)))return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);m=0,e.lt[S++]=f,z--,t=0;break;case 7:if(A>7&&(A-=8,v++,I--),e.write=S,m=e.wt(y,m),S=e.write,z=S<e.read?e.read-S-1:e.end-S,e.read!=e.write)return e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);t=8;case 8:return m=1,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);case 9:return m=rt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m);default:return m=nt,e.ot=x,e.ct=A,y.We=v,y.qe+=I-y.nt,y.nt=I,e.write=S,e.wt(y,m)}},e.ht=()=>{}}wt.dt=(e,t,n,r)=>(e[0]=9,t[0]=5,n[0]=ot,r[0]=ct,0);const dt=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];function pt(e,t){const n=this;let r,s=0,o=0,c=0,a=0;const l=[0],u=[0],w=new ht;let h=0,d=new f(4320);const p=new wt;n.ct=0,n.ot=0,n.lt=new i(t),n.end=t,n.read=0,n.write=0,n.reset=(e,t)=>{t&&(t[0]=0),6==s&&w.ht(e),s=0,n.ct=0,n.ot=0,n.read=n.write=0},n.reset(e,null),n.wt=(e,t)=>{let r,s,i;return s=e.rt,i=n.read,r=(i>n.write?n.end:n.write)-i,r>e.tt&&(r=e.tt),0!==r&&t==st&&(t=0),e.tt-=r,e.Ge+=r,e.$e.set(n.lt.subarray(i,i+r),s),s+=r,i+=r,i==n.end&&(i=0,n.write==n.end&&(n.write=0),r=n.write-i,r>e.tt&&(r=e.tt),0!==r&&t==st&&(t=0),e.tt-=r,e.Ge+=r,e.$e.set(n.lt.subarray(i,i+r),s),s+=r,i+=r),e.rt=s,n.read=i,t},n.ut=(e,t)=>{let i,f,y,m,b,g,k,v;for(m=e.nt,b=e.We,f=n.ot,y=n.ct,g=n.write,k=g<n.read?n.read-g-1:n.end-g;;){let S,z,C,x,A,I,_,P;switch(s){case 0:for(;3>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}switch(i=7&f,h=1&i,i>>>1){case 0:f>>>=3,y-=3,i=7&y,f>>>=i,y-=i,s=1;break;case 1:S=[],z=[],C=[[]],x=[[]],wt.dt(S,z,C,x),w.init(S[0],z[0],C[0],0,x[0],0),f>>>=3,y-=3,s=6;break;case 2:f>>>=3,y-=3,s=3;break;case 3:return f>>>=3,y-=3,s=9,e.Le="invalid block type",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t)}break;case 1:for(;32>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if((~f>>>16&65535)!=(65535&f))return s=9,e.Le="invalid stored block lengths",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);o=65535&f,f=y=0,s=0!==o?2:0!==h?7:0;break;case 2:if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(0===k&&(g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k&&(n.write=g,t=n.wt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,g==n.end&&0!==n.read&&(g=0,k=g<n.read?n.read-g-1:n.end-g),0===k)))return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(t=0,i=o,i>b&&(i=b),i>k&&(i=k),n.lt.set(e.je(m,i),g),m+=i,b-=i,g+=i,k-=i,0!==(o-=i))break;s=0!==h?7:0;break;case 3:for(;14>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(c=i=16383&f,(31&i)>29||(i>>5&31)>29)return s=9,e.Le="too many length or distance symbols",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);if(i=258+(31&i)+(i>>5&31),!r||r.length<i)r=[];else for(v=0;i>v;v++)r[v]=0;f>>>=14,y-=14,a=0,s=4;case 4:for(;4+(c>>>10)>a;){for(;3>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}r[dt[a++]]=7&f,f>>>=3,y-=3}for(;19>a;)r[dt[a++]]=0;if(l[0]=7,i=p.st(r,l,u,d,e),0!=i)return(t=i)==rt&&(r=null,s=9),n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);a=0,s=5;case 5:for(;i=c,258+(31&i)+(i>>5&31)>a;){let o,w;for(i=l[0];i>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(i=d[3*(u[0]+(f&it[i]))+1],w=d[3*(u[0]+(f&it[i]))+2],16>w)f>>>=i,y-=i,r[a++]=w;else{for(v=18==w?7:w-14,o=18==w?11:3;i+v>y;){if(0===b)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);t=0,b--,f|=(255&e.ft(m++))<<y,y+=8}if(f>>>=i,y-=i,o+=f&it[v],f>>>=v,y-=v,v=a,i=c,v+o>258+(31&i)+(i>>5&31)||16==w&&1>v)return r=null,s=9,e.Le="invalid bit length repeat",t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);w=16==w?r[v-1]:0;do{r[v++]=w}while(0!==--o);a=v}}if(u[0]=-1,A=[],I=[],_=[],P=[],A[0]=9,I[0]=6,i=c,i=p.it(257+(31&i),1+(i>>5&31),r,A,I,_,P,d,e),0!=i)return i==rt&&(r=null,s=9),t=i,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);w.init(A[0],I[0],d,_[0],d,P[0]),s=6;case 6:if(n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,1!=(t=w.ut(n,e,t)))return n.wt(e,t);if(t=0,w.ht(e),m=e.nt,b=e.We,f=n.ot,y=n.ct,g=n.write,k=g<n.read?n.read-g-1:n.end-g,0===h){s=0;break}s=7;case 7:if(n.write=g,t=n.wt(e,t),g=n.write,k=g<n.read?n.read-g-1:n.end-g,n.read!=n.write)return n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);s=8;case 8:return t=1,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);case 9:return t=rt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t);default:return t=nt,n.ot=f,n.ct=y,e.We=b,e.qe+=m-e.nt,e.nt=m,n.write=g,n.wt(e,t)}}},n.ht=e=>{n.reset(e,null),n.lt=null,d=null},n.yt=(e,t,r)=>{n.lt.set(e.subarray(t,t+r),0),n.read=n.write=r},n.bt=()=>1==s?1:0}const yt=13,mt=[0,0,255,255];function bt(){const e=this;function t(e){return e&&e.gt?(e.qe=e.Ge=0,e.Le=null,e.gt.mode=7,e.gt.kt.reset(e,null),0):nt}e.mode=0,e.method=0,e.vt=[0],e.St=0,e.marker=0,e.zt=0,e.Ct=t=>(e.kt&&e.kt.ht(t),e.kt=null,0),e.xt=(n,r)=>(n.Le=null,e.kt=null,8>r||r>15?(e.Ct(n),nt):(e.zt=r,n.gt.kt=new pt(n,1<<r),t(n),0)),e.At=(e,t)=>{let n,r;if(!e||!e.gt||!e.et)return nt;const s=e.gt;for(t=4==t?st:0,n=st;;)switch(s.mode){case 0:if(0===e.We)return n;if(n=t,e.We--,e.qe++,8!=(15&(s.method=e.ft(e.nt++)))){s.mode=yt,e.Le="unknown compression method",s.marker=5;break}if(8+(s.method>>4)>s.zt){s.mode=yt,e.Le="invalid win size",s.marker=5;break}s.mode=1;case 1:if(0===e.We)return n;if(n=t,e.We--,e.qe++,r=255&e.ft(e.nt++),((s.method<<8)+r)%31!=0){s.mode=yt,e.Le="incorrect header check",s.marker=5;break}if(!(32&r)){s.mode=7;break}s.mode=2;case 2:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St=(255&e.ft(e.nt++))<<24&4278190080,s.mode=3;case 3:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St+=(255&e.ft(e.nt++))<<16&16711680,s.mode=4;case 4:if(0===e.We)return n;n=t,e.We--,e.qe++,s.St+=(255&e.ft(e.nt++))<<8&65280,s.mode=5;case 5:return 0===e.We?n:(n=t,e.We--,e.qe++,s.St+=255&e.ft(e.nt++),s.mode=6,2);case 6:return s.mode=yt,e.Le="need dictionary",s.marker=0,nt;case 7:if(n=s.kt.ut(e,n),n==rt){s.mode=yt,s.marker=0;break}if(0==n&&(n=t),1!=n)return n;n=t,s.kt.reset(e,s.vt),s.mode=12;case 12:return e.We=0,1;case yt:return rt;default:return nt}},e.It=(e,t,n)=>{let r=0,s=n;if(!e||!e.gt||6!=e.gt.mode)return nt;const i=e.gt;return s<1<<i.zt||(s=(1<<i.zt)-1,r=n-s),i.kt.yt(t,r,s),i.mode=7,0},e._t=e=>{let n,r,s,i,o;if(!e||!e.gt)return nt;const c=e.gt;if(c.mode!=yt&&(c.mode=yt,c.marker=0),0===(n=e.We))return st;for(r=e.nt,s=c.marker;0!==n&&4>s;)e.ft(r)==mt[s]?s++:s=0!==e.ft(r)?0:4-s,r++,n--;return e.qe+=r-e.nt,e.nt=r,e.We=n,c.marker=s,4!=s?rt:(i=e.qe,o=e.Ge,t(e),e.qe=i,e.Ge=o,c.mode=7,0)},e.Pt=e=>e&&e.gt&&e.gt.kt?e.gt.kt.bt():nt}function gt(){}function kt(e){const t=new gt,n=e&&e.chunkSize?r.floor(2*e.chunkSize):131072,o=new i(n);let c=!1;t.xt(),t.$e=o,this.append=(e,r)=>{const f=[];let a,l,u=0,w=0,h=0;if(0!==e.length){t.nt=0,t.et=e,t.We=e.length;do{if(t.rt=0,t.tt=n,0!==t.We||c||(t.nt=0,c=!0),a=t.At(0),c&&a===st){if(0!==t.We)throw new s("inflating: bad input")}else if(0!==a&&1!==a)throw new s("inflating: "+t.Le);if((c||1===a)&&t.We===e.length)throw new s("inflating: bad input");t.rt&&(t.rt===n?f.push(new i(o)):f.push(o.subarray(0,t.rt))),h+=t.rt,r&&t.nt>0&&t.nt!=u&&(r(t.nt),u=t.nt)}while(t.We>0||0===t.tt);return f.length>1?(l=new i(h),f.forEach(e=>{l.set(e,w),w+=e.length})):l=f[0]?new i(f[0]):new i,l}},this.flush=()=>{t.Ct()}}gt.prototype={xt(e){const t=this;return t.gt=new bt,e||(e=15),t.gt.xt(t,e)},At(e){const t=this;return t.gt?t.gt.At(t,e):nt},Ct(){const e=this;if(!e.gt)return nt;const t=e.gt.Ct(e);return e.gt=null,t},_t(){const e=this;return e.gt?e.gt._t(e):nt},It(e,t){const n=this;return n.gt?n.gt.It(n,e,t):nt},ft(e){return this.et[e]},je(e,t){return this.et.subarray(e,e+t)}},self.initCodec=()=>{self.Deflate=tt,self.Inflate=kt};\n',i=()=>n.useDataURI?"data:text/javascript,"+encodeURIComponent(e):URL.createObjectURL(new Blob([e],{type:"text/javascript"}));t({workerScripts:{inflate:[i],deflate:[i]}})}(tM),tM({Deflate:function YK(t){const e=new j5,i=function qK(t){return t+5*(Math.floor(t/16383)+1)}(t&&t.chunkSize?t.chunkSize:65536),o=new Uint8Array(i);let s=t?t.level:-1;typeof s>"u"&&(s=-1),e.deflateInit(s),e.next_out=o,this.append=function(a,l){let u,f,g=0,v=0,C=0;const E=[];if(a.length){e.next_in_index=0,e.next_in=a,e.avail_in=a.length;do{if(e.next_out_index=0,e.avail_out=i,u=e.deflate(0),0!=u)throw new Error("deflating: "+e.msg);e.next_out_index&&E.push(e.next_out_index==i?new Uint8Array(o):o.subarray(0,e.next_out_index)),C+=e.next_out_index,l&&e.next_in_index>0&&e.next_in_index!=g&&(l(e.next_in_index),g=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return E.length>1?(f=new Uint8Array(C),E.forEach(function(w){f.set(w,v),v+=w.length})):f=E[0]?new Uint8Array(E[0]):new Uint8Array,f}},this.flush=function(){let a,l,u=0,f=0;const g=[];do{if(e.next_out_index=0,e.avail_out=i,a=e.deflate(4),1!=a&&0!=a)throw new Error("deflating: "+e.msg);i-e.avail_out>0&&g.push(o.slice(0,e.next_out_index)),f+=e.next_out_index}while(e.avail_in>0||0===e.avail_out);return e.deflateEnd(),l=new Uint8Array(f),g.forEach(function(v){l.set(v,u),u+=v.length}),l}},Inflate:function pQ(t){const e=new dR,i=t&&t.chunkSize?Math.floor(2*t.chunkSize):131072,o=new Uint8Array(i);let s=!1;e.inflateInit(),e.next_out=o,this.append=function(a,l){const u=[];let f,g,v=0,C=0,E=0;if(0!==a.length){e.next_in_index=0,e.next_in=a,e.avail_in=a.length;do{if(e.next_out_index=0,e.avail_out=i,0===e.avail_in&&!s&&(e.next_in_index=0,s=!0),f=e.inflate(0),s&&f===xd){if(0!==e.avail_in)throw new Error("inflating: bad input")}else if(f!==Li&&f!==Cd)throw new Error("inflating: "+e.msg);if((s||f===Cd)&&e.avail_in===a.length)throw new Error("inflating: bad input");e.next_out_index&&u.push(e.next_out_index===i?new Uint8Array(o):o.subarray(0,e.next_out_index)),E+=e.next_out_index,l&&e.next_in_index>0&&e.next_in_index!=v&&(l(e.next_in_index),v=e.next_in_index)}while(e.avail_in>0||0===e.avail_out);return u.length>1?(g=new Uint8Array(E),u.forEach(function(w){g.set(w,C),C+=w.length})):g=u[0]?new Uint8Array(u[0]):new Uint8Array,g}},this.flush=function(){e.inflateEnd()}}});var Td,TL=me(2578);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let o=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[o]?n[o]:""},t.extension=function i(r){for(let o in n)if(n[o]===r)return o;return r.split("/")[1]}}(Td||(Td={}));class wu{static get instance(){return wu._instance||(wu._instance=new wu),wu._instance}constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,R.A)(function*(){if(!n)return;let i=n instanceof FileList?SL(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),U.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,R.A)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Yt.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,R.A)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Jt.instance.addAsync(n)}})()}handleText(n){return(0,R.A)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=bd.xml2element(yield Fc.readAsTextAsync(n));e&&U.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,R.A)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let r=yield new Tx(new qh(n)).getEntries();for(let o of r)try{let s=yield o.getData(new Zh);console.log(o.filename+" \u89e3\u51cd..."),yield e.load([new File([s],o.filename,{type:Td.type(o.filename)})])}catch(s){console.warn(s)}})()}saveAsync(n,e,i,r){return(0,R.A)(function*(){if(!n)return;let o=n instanceof FileList?SL(n):n,s=new e3(new Zh("application/zip"),{bufferedWrite:!0}),a=0,l=0;yield Promise.all(Array.from(o).map(function(){var u=(0,R.A)(function*(f){let g=0;l+=f.size,s.add((r&&f.type.indexOf("image/")>=0?"images/":"")+f.name,new qh(f),{onprogress:(v,C)=>(0,R.A)(function*(){a+=v-g,g=v,i({percent:100*a/l,currentFile:f.name})})()})});return function(f){return u.apply(this,arguments)}}())),(0,TL.saveAs)(yield s.close(),e+".zip")})()}}function SL(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}function Uee(t,n){if(1&t&&(p(0,"i",6),x(1),m()),2&t){const e=y();h(),Re(e.materialIcon)}}function Hee(t,n){if(1&t&&(p(0,"div",7),x(1),m()),2&t){const e=y();h(),Re(e.help)}}function zee(t,n){1&t&&(Ne(0,"div",8),It(1,"safe")),2&t&&_("innerHTML",St(1,1,y().helpHtml,"html"),eo)}function Vee(t,n){if(1&t){const e=Ie();p(0,"button",9),X("click",function(){return O(e),D(y().cancel())}),x(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),m()}}let Mr=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=or.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:or.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),U.register(this)}ngOnDestroy(){U.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(i,r){1&i&&(p(0,"div",0),L(1,Uee,2,1,"i",1),x(2),m(),Ne(3,"hr"),L(4,Hee,2,1,"div",2)(5,zee,2,4,"div",3),p(6,"button",4),X("click",function(){return r.ok()}),x(7,"\uff2f\uff2b"),m(),L(8,Vee,2,0,"button",5)),2&i&&(h(),_("ngIf",r.materialIcon),h(),Re(r.text),h(2),_("ngIf",r.help&&!r.helpHtml),h(),_("ngIf",r.helpHtml),h(3),_("ngIf",r.type>1))},dependencies:[ni,fr],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]})}return t})();var h3,or=function(t){return t[t.OK=1]="OK",t[t.OK_CANCEL=2]="OK_CANCEL",t}(or||{});let Ki=h3=class extends Ir{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(n){this.value=n??""}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return"undefined"===this.to?(""!==this._to&&(this._to="",this._sendTo=[]),this._sendTo):(this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo)}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return Yt.instance.get(this.imageIdentifier)}get toImage(){return Yt.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===xt.peer.userId||this.originFrom===xt.peer.userId||-1<this.tags.indexOf("mine")}get isSendToMe(){return-1<this.sendTo.indexOf(xt.peer.userId)}get isRelatedToMe(){return this.isSendToMe||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===xt.peer.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!Ce.myCursor&&Ce.myCursor.isGMMode}plainText(){if(this.isSecret&&!this.isSendFromSelf)return"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09";let n=_e.rubyToText(this.text);return this.isDicebot&&(n=n.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),n}logFragment(n,e=null,i="HH:mm",r){return 0==n?this.logFragmentText(e,i):this.logFragmentHtml(e,i,r)}logFragmentText(n=null,e="HH:mm"){n=n&&""!=n.trim()?`[${n}] `:"";const i=""==e?"":gb(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${gb(new Date(this.lastUpdate),e,this.locale)})`:"";let o=_e.rubyToText(this.text);return this.isDicebot&&(o=o.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),o.lastIndexOf("\n")==o.length-1&&!r&&(o+="\n"),`${n}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":o+r}`}logFragmentHtml(n=null,e="HH:mm",i){const r=!!i,o=_e.escapeHtml(this.color?this.color:Ce.CHAT_DEFAULT_COLOR),s=` style="color: ${o}"`,a=this.toColor?_e.escapeHtml(this.toColor):"",l=this.toColor?` style="color: ${a}"`:"",u=this.isDirect||this.isSecret?' class="grow"':"",f=null==n||""==n.trim()?"":`<span class="tab-name">${_e.escapeHtml(n)}</span> `,g=new Date(this.timestamp),v=""==e?"":`<time datetime="${g.toISOString()}">${_e.escapeHtml(gb(g,e,this.locale))}</time>`,C=r&&this.toImageIdentifier&&i[this.toImageIdentifier]?`<img class="to-icon" src="${_e.escapeHtml(i[this.toImageIdentifier])}">`:"",E=`<span${u}${s}>${_e.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 ${C}<span${u}${l}>${_e.escapeHtml(this.toName)}</span>`:"");let w=["message"];(this.isDirect||this.isSecret)&&w.push("direct-message"),this.isSystem&&w.push("system-message"),(this.isDicebot||this.isCalculate)&&w.push("dicebot-message"),this.isOperationLog&&w.push("operation-log"),r&&this.isFaceIcon&&w.push("face-icon-msessage");let T=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&T.push("is-success"),this.isFailure&&T.push("is-failure"),this.isCritical&&T.push("is-critical"),this.isFumble&&T.push("is-fumble"));let M=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":k5.link(this.isOperationLog?_e.escapeHtml(this.text):_e.rubyToHtml(_e.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(P){return"url"==P.getType()&&_e.validUrl(P.getAnchorHref())}});this.isDicebot&&(M=h3.decorationDiceResult(M));let S="";if(this.isEdited)if(""==e)S='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const P=new Date(this.lastUpdate);S=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${P.toISOString()}">${_e.escapeHtml(gb(P,e,this.locale))}</time></span>`}if(M.lastIndexOf("\n")==M.length-1&&!S&&(M+="\n"),r){const P=["msg-icon"],Z=["aura"];1==this.isInverseIcon&&P.push("inverse"),1==this.isHollowIcon&&P.push("hollow"),0<=this.aura&&this.aura<=7&&Z.push(["black","blue","green","cyan","red","magenta","yellow","white"][this.aura]);const ee=this.imageIdentifier&&i[this.imageIdentifier]?`<img class="icon${1==this.isBlackPaint?" black-paint":""}" src="${_e.escapeHtml(i[this.imageIdentifier])}">`:'<span class="icon-space"></span>';return`<div class="${w.join(" ")}" style="display: flex; border-left-color: ${o}">\n  <div class="msg-header">${f}${""==f?"":"<br>"}${v}</div>\n  <div class="${P.join(" ")}">\n    <span class="${Z.join(" ")}">\n      ${ee}\n    </span>\n  </div>\n  <div>\n    <div><span class="msg-name">${E}</span></div>\n    <div class="${T.join(" ")}"><span${this.isSpecialColor?"":s}>${M}</span>${S}</div>\n  </div>\n</div>`}return`<div class="${w.join(" ")}" style="border-left-color: ${o}">\n  <div class="msg-header">${f}${v}\uff1a<span class="msg-name">${E}</span>\uff1a</div>\n  <div class="${T.join(" ")}"><span${this.isSpecialColor?"":s}>${M}</span>${S}</div>\n</div>`}static logCss(n){return"body {\n  color: #444;\n  background-color: #FFF;\n}\nhr {\n  margin: 2px 0px;\n  border: 1px dotted #aaa;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #fff,\n       0px  1px 1px #fff,\n      -1px  0px 1px #fff,\n       0px -1px 1px #fff; \n}"+(n?"\n\n.msg-header::first-line, .msg-name {\n  font-size: 116%;\n}\n.msg-header {\n   white-space: nowrap;\n}\n.msg-icon {\n  vertical-align: top;\n  padding: 2px 3px;\n  overflow: hidden;\n  flex-shrink: 0;\n}\nimg.icon {\n  width: 4.2em;\n  height: 4.2em;\n  vertical-align: bottom;\n  object-fit: cover;\n  object-position: 50% 0%;\n}\n.face-icon-msessage img.icon {\n  border-radius: 0.5rem;\n}\n.to-icon {\n  width: 1.2em;\n  height: 1.2em;\n  vertical-align: top;\n  margin-right: 2px;\n  margin-top: 2px;\n  object-fit: cover;\n  object-position: 50% 0%;\n  border-radius: 0.25rem;\n  filter: drop-shadow(1px  0px 0px #fff)\n      drop-shadow( 0px  1px 0px #fff)\n      drop-shadow(-1px  0px 0px #fff)\n      drop-shadow( 0px -1px 0px #fff);\n}\nspan.icon-space {\n  display: inline-block;\n  width: 4.2em;\n  height: 4.2em;\n  vertical-align: bottom;\n}\n.inverse {\n  transform: scaleX(-1);\n}\n.hollow {\n  opacity: 0.6;\n  filter: blur(1px);\n}\n.black-paint {\n  filter: brightness(0);\n}\n.aura.black {\n  filter: drop-shadow(0 -0.2rem 0.2rem black);\n}\n.aura.blue {\n  filter: drop-shadow(0 -0.2rem 0.2rem #00f);\n}\n.aura.green {\n  filter: drop-shadow(0 -0.2rem 0.2rem #3f3);\n}\n.aura.cyan {\n  filter: drop-shadow(0 -0.2rem 0.2rem #3ff);\n}\n.aura.red {\n  filter: drop-shadow(0 -0.2rem 0.2rem #f00);\n}\n.aura.magenta {\n  filter: drop-shadow(0 -0.2rem 0.2rem #f0f);\n}\n.aura.yellow {\n  filter: drop-shadow(0 -0.2rem 0.2rem #ff3);\n}\n.aura.white {\n  filter: drop-shadow(0 -0.2rem 0.3rem #999) drop-shadow(0 -0.2rem 0.2rem #fff);\n}":"")}static decorationDiceResult(n){return n.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};Oe([Xe()],Ki.prototype,"originFrom",void 0),Oe([Xe()],Ki.prototype,"from",void 0),Oe([Xe()],Ki.prototype,"to",void 0),Oe([Xe()],Ki.prototype,"name",void 0),Oe([Xe()],Ki.prototype,"toName",void 0),Oe([Xe()],Ki.prototype,"tag",void 0),Oe([Xe()],Ki.prototype,"dicebot",void 0),Oe([Xe()],Ki.prototype,"imageIdentifier",void 0),Oe([Xe()],Ki.prototype,"toImageIdentifier",void 0),Oe([Xe()],Ki.prototype,"color",void 0),Oe([Xe()],Ki.prototype,"toColor",void 0),Oe([Xe()],Ki.prototype,"isInverseIcon",void 0),Oe([Xe()],Ki.prototype,"isHollowIcon",void 0),Oe([Xe()],Ki.prototype,"isBlackPaint",void 0),Oe([Xe()],Ki.prototype,"aura",void 0),Oe([Xe()],Ki.prototype,"characterIdentifier",void 0),Oe([Xe()],Ki.prototype,"standIdentifier",void 0),Oe([Xe()],Ki.prototype,"standName",void 0),Oe([Xe()],Ki.prototype,"isUseStandImage",void 0),Oe([Xe()],Ki.prototype,"lastUpdate",void 0),Ki=h3=Oe([ir("chat")],Ki);let Xh=class extends Ir{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof Ki&&n.isDisplayable&&(this._unreadLength++,U.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}),!n.isSendFromSelf&&!n.isOperationLog&&!n.isSystem&&U.trigger("MESSAGE_NORTIFICATION",{tabIdentifier:this.identifier,messageIdentifier:n.identifier,isDirect:n.isDirect}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new Ki;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),U.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof Ki&&!e.isDisplayable||(n+=dr.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}log(n,e,i=!0,r){const o=this.chatMessages.filter(s=>s.isDisplayable&&(i||!s.isOperationLog)).sort((s,a)=>s.index-a.index).map(s=>s.logFragment(n,null,e,r)).join("\n");return 0==n?o:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${_e.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)+(r?"\uff08\u753b\u50cf\u4ed8\u304d\uff09":"")}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Ki.logCss(r)}\n</style>\n</head>\n<body>\n${o}\n</body>\n</html>`}};var oc;Oe([Xe()],Xh.prototype,"name",void 0),Oe([Xe()],Xh.prototype,"isUseStandImage",void 0),Oe([Xe()],Xh.prototype,"recieveOperationLogLevel",void 0),Xh=Oe([ir("chat-tab")],Xh);let Al=class extends Ir{static#e=oc=this;static get instance(){return oc._instance||(oc._instance=new oc("ChatTabList"),oc._instance.initialize()),oc._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof Xh)e=n[0];else{let i=n[0];e=new Xh(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of oc.instance.children)i.destroy();let e=oc.instance.toContext();e.syncData=this.toContext().syncData,oc.instance.apply(e),oc.instance.update(),super.parseInnerXml.apply(oc.instance,[n]),this.destroy()}log(n,e,i=!0,r,o){if(!this.chatTabs||o&&0==o.length)return"";o&&o.length>1&&o.map(f=>f.identifier).sort().join()==this.chatTabs.map(f=>f.identifier).sort().join()&&(o=null);const s=(o||this.chatTabs).reduce((f,g)=>(g&&f.push(...g.chatMessages.filter(v=>v.isDisplayable&&(i||!v.isOperationLog)).map(v=>({index:v.index,tabName:g.name,chatMessage:v}))),f),[]).sort((f,g)=>f.index-g.index),a=[];let l=s.length>0?s[0].chatMessage.tabIdentifier:null;for(const f of s)l&&l!==f.chatMessage.tabIdentifier&&(l=f.chatMessage.tabIdentifier,a.push(0==n?"--------":"<hr>")),a.push(f.chatMessage.logFragment(n,o&&1==o.length?null:f.tabName,e,r));const u=a.join("\n");return 0==n?u:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${o?""==o[0].name?"\uff08\u7121\u540d\u306e\u30bf\u30d6\uff09":o[0].name:"\u5168\u3066\u306e\u30bf\u30d6"}${o&&o.length>1?"\u3001\u4ed6":""}${r?"\uff08\u753b\u50cf\u4ed8\u304d\uff09":""}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Ki.logCss(r)}\n</style>\n</head>\n<body>\n${u}\n</body>\n</html>`}};Al=oc=Oe([ir("chat-tab-list")],Al);var ML=me(8161);class xp{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new xp(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new xp(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&U.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){U.unregister(this),this.sendChankTimer&&(0,Jl.v)(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=ML.$.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),U.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),(0,Jl.W)(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);U.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),(0,Jl.W)(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=(0,Jl.W)(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,U.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),U.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=ML.$.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new _d.b(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class Lm{static get instance(){return Lm._instance||(Lm._instance=new Lm),Lm._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),U.register(this).on("CONNECT_PEER",-1,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),Jt.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let o of e){let s=Jt.instance.get(o.identifier);null===s&&(s=Sl.createEmpty(o.identifier),Jt.instance.add(s)),s.state<$a.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&i.push({identifier:o.identifier,state:s.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<Jt.instance.getCatalog().length&&Jt.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let o=Jt.instance.get(r.identifier);o&&r.state<o.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),s=Jt.instance.get(i[r].identifier);this.startSendTask(s,n.data.receiver)}else{let r=n.data.candidatePeers,o=r.indexOf(xt.peerId);-1<o&&r.splice(o,1);for(let s of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+s+" -> "+n.data.identifiers),void U.call(n,s);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),Jt.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=Jt.instance.get(e);this.receiveTaskMap.has(e)||i&&$a.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),U.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){U.unregister(this)}startSendTask(n,e){var i=this;return(0,R.A)(function*(){let r=xp.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),U.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let o={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===$a.URL?o.url=n.url:(o.blob=yield Fc.readAsArrayBufferAsync(n.blob),o.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),Jt.instance.synchronize()},r.start(o)})()}startReceiveTask(n){let e=Jt.instance.get(n),i=xp.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,o,s)=>{let a=e.toContext();a.name=(100*o/s).toFixed(1)+"%",e.apply(a)},i.onfinish=(r,o)=>{this.stopReceiveTask(r.identifier),o&&U.trigger("UPDATE_AUDIO_RESOURE",[o]),Jt.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),U.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:xt.peerId,candidatePeers:xt.peerIds},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Bm{static get instance(){return Bm._instance||(Bm._instance=new Bm),Bm._instance}constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}initialize(){var n=this;U.register(this).on("CONNECT_PEER",1,e=>{e.isSendFromSelf&&(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),Yt.instance.synchronize())}).on("XML_LOADED",e=>{!function jee(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!Yt.instance.get(r)&&0<Td.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!Yt.instance.get(r)&&0<Td.type(r).length&&n.push(r)}for(let i of n)Yt.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let o of i){let s=Yt.instance.get(o.identifier);null===s&&(s=_n.createEmpty(o.identifier),Yt.instance.add(s)),s.state<Di.COMPLETE&&!this.receiveTaskMap.has(o.identifier)&&r.push({identifier:o.identifier,state:s.state})}r.length<1&&!this.hasActiveTask()&&i.length<Yt.instance.getCatalog().length&&Yt.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,R.A)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,o=[];for(let s of r){let a=Yt.instance.get(s.identifier);a&&s.state<a.state&&o.push({identifier:s.identifier,state:s.state})}if(!1===n.isLimitSendTask()&&0<o.length&&!n.existsSendTask(i.data.receiver)){let s=n.makeSendUpdateImages(o);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+s.length),n.startSendTask(s,i.data.receiver)}else{let s=i.data.candidatePeers,a=s.indexOf(xt.peerId);-1<a&&s.splice(a,1);for(let l of s)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+l+" -> "+i.data.identifiers),void U.call(i,l);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,o.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),Yt.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=Yt.instance.get(i);this.receiveTaskMap.has(i)||r&&Di.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),U.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){U.unregister(this)}startSendTask(n,e){var i=this;return(0,R.A)(function*(){let r=1===n.length?n[0].identifier:Il.k.generateUuid(),o=xp.createSendTask(r,e);i.sendTaskMap.set(o.identifier,o),U.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let s of n)s.thumbnail.blob?s.thumbnail.blob=yield Fc.readAsArrayBufferAsync(s.thumbnail.blob):s.blob&&(s.blob=yield Fc.readAsArrayBufferAsync(s.blob));o.onfinish=(s,a)=>{i.stopSendTask(s.identifier),Yt.instance.synchronize()},o.start(n)})()}startReceiveTask(n){let e=xp.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&U.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),Yt.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e),U.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:xt.peerId,candidatePeers:xt.peerIds},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let o=n.length-1;0<=o;o--){let s=Math.floor(Math.random()*(o+1));[n[o],n[s]]=[n[s],n[o]]}n.sort((o,s)=>o.state<s.state?-1:o.state>s.state?1:0);for(let o=0;o<n.length;o++){let s=n[o],a=Yt.instance.get(s.identifier),l={identifier:a.identifier,name:a.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};a.state===Di.URL?l.url=a.url:s.state===Di.NULL?(l.thumbnail.blob=a.thumbnail.blob,l.thumbnail.type=a.thumbnail.type):(l.blob=a.blob,l.type=a.blob.type);let u=l.blob?l.blob.size:l.thumbnail.blob?l.thumbnail.blob.size:100;if(i.push(l),r+=u,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class Ko{static#e=this.key={};static#t=this.tasksMap=new Map;constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){Ko.tasksMap.size<1&&U.register(Ko.key).on("DISCONNECT_PEER",r=>{Ko.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||Ko.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||Ko.onUpdate(r.data.identifier)});let i=new Ko(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=Ko.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),Ko.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;U.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of Ko.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();Ko.tasksMap.size<1&&U.unregister(Ko.key)}static onUpdate(n){if(!Ko.tasksMap.has(n))return;let e=Ko.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);Ko.tasksMap.size<1&&U.unregister(Ko.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=Ko.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&Ko.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new _d.b(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}class Um{static get instance(){return Um._instance||(Um._instance=new Um),Um._instance}constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),U.register(this).on("CONNECT_PEER",2,n=>{n.isSendFromSelf&&(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)dt.instance.isDeleted(i.identifier)?U.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(dt.instance.isDeleted(n.data))U.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=dt.instance.get(n.data);e&&U.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=dt.instance.get(e.identifier);if(i){let r=n.isSendFromSelf?i:this.updateObject(i,e);r?s5(r,n.sendFrom):n.isSendFromSelf||U.call("UPDATE_GAME_OBJECT",i.toContext(),n.sendFrom)}else if(dt.instance.isDeleted(e.identifier))U.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom);else{let r=this.createObject(e);r&&s5(r,n.sendFrom)}}).on("DELETE_GAME_OBJECT",1e3,n=>{dt.instance.delete(n.data.identifier,!1)})}destroy(){U.unregister(this)}updateObject(n,e){let i=e.majorVersion+e.minorVersion;if(n.version<i)n.apply(e);else if(i<n.version)return null;return n}createObject(n){let e=_u.instance.create(n.aliasName,n.identifier);return e?(dt.instance.add(e,!1),e.apply(n),e):(console.warn(n.aliasName+" is Unknown...?",n),null)}sendCatalog(n){let e=dt.instance.getCatalog(),i=setInterval(()=>{U.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){let n=!0;for(;0<this.requestMap.size&&this.tasks.length<32&&n;)n=this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId();if(n.length<1)return!1;let e=this.makeRequestList(n);if(e.length<1)return this.removePeerMap(n),0<this.peerMap.size;let i=Ko.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);return r&&r.push(i),i.onfinish=o=>{this.tasks.splice(this.tasks.indexOf(o),1);let s=this.peerMap.get(n);s&&s.splice(s.indexOf(o),1),this.synchronize()},i.ontimeout=(o,s)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),s.forEach(a=>this.requestMap.set(a.identifier,a))},!0}makeRequestList(n,e=32){let i=[];for(let[r,o]of this.requestMap){if(e<=i.length)break;if(!o.holderIds.includes(n))continue;let s=dt.instance.get(o.identifier);(!s||s.version<o.version)&&i.push(o),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e="",i=xt.peers;for(let r=i.length-1;0<=r;r--){let o=Math.floor(Math.random()*(r+1));[i[r],i[o]]=[i[o],i[r]]}for(let r of i){let o=this.peerMap.get(r.peerId);r.isOpen&&o&&o.length<n&&(n=o.length,e=r.peerId)}return e}}var Eu,f3=function(t){return t.ASC="ASC",t.DESC="DESC",t}(f3||{});let Tu=class extends Lh{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=f3.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static#e=Eu=this;static get instance(){return Eu._instance||(Eu._instance=new Eu("DataSummarySetting"),Eu._instance.initialize()),Eu._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/[\u3000\s]+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=Eu.instance.toContext();e.syncData=this.toContext().syncData,Eu.instance.apply(e),Eu.instance.update(),this.destroy()}};Oe([Xe()],Tu.prototype,"sortTag",void 0),Oe([Xe()],Tu.prototype,"sortOrder",void 0),Oe([Xe()],Tu.prototype,"dataTag",void 0),Tu=Eu=Oe([ir("summary-setting")],Tu);let wp=class extends Lh{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new He}get audio(){return Jt.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=Jt.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){U.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){U.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};var Sx;Oe([Xe()],wp.prototype,"audioIdentifier",void 0),Oe([Xe()],wp.prototype,"startTime",void 0),Oe([Xe()],wp.prototype,"isLoop",void 0),Oe([Xe()],wp.prototype,"isPlaying",void 0),wp=Oe([ir("jukebox")],wp);let Qo=Sx=class extends Sr{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1,this.owner="",this.scratchingGrids="",this.scratchedGrids="",this.isScratchPreviewOnGMMode=!1,this.isPreview=!1,this.borderType=1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#555555"}set color(n){this.setCommonValue("color",n)}get bgcolor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#0a0a0a"}set bgcolor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get ownerName(){let n=Ce.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Ce.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isMine||xt.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isMine(){return xt.peer.userId===this.owner}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o){let s=null;return s=o?new Sx(o):new Sx,s.createDataElements(),s.commonDataElement.appendChild(ht.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(ht.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(ht.create("height",i,{},"height_"+s.identifier)),s.commonDataElement.appendChild(ht.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(ht.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};Oe([Xe()],Qo.prototype,"isLock",void 0),Oe([Xe()],Qo.prototype,"blendType",void 0),Oe([Xe()],Qo.prototype,"isTransparentOnGMMode",void 0),Oe([Xe()],Qo.prototype,"owner",void 0),Oe([Xe()],Qo.prototype,"scratchingGrids",void 0),Oe([Xe()],Qo.prototype,"scratchedGrids",void 0),Oe([Xe()],Qo.prototype,"isScratchPreviewOnGMMode",void 0),Oe([Xe()],Qo.prototype,"isPreview",void 0),Oe([Xe()],Qo.prototype,"borderType",void 0),Qo=Sx=Oe([ir("table-mask")],Qo);var Mx,Ep=function(t){return t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL",t}(Ep||{}),Dr=function(t){return t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT",t}(Dr||{});let hs=Mx=class extends Sr{constructor(){super(...arguments),this.isLocked=!1,this.mode=Ep.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=Dr.NONE}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&Ep.WALL)}get hasFloor(){return!!(this.mode&Ep.FLOOR)}complement(){!this.getElement("altitude",this.commonDataElement)&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+this.identifier))}static create(n,e,i,r,o,s,a){let l=null;return l=a?new Mx(a):new Mx,l.createDataElements(),l.commonDataElement.appendChild(ht.create("name",n,{},"name_"+l.identifier)),l.commonDataElement.appendChild(ht.create("width",e,{},"width_"+l.identifier)),l.commonDataElement.appendChild(ht.create("height",r,{},"height_"+l.identifier)),l.commonDataElement.appendChild(ht.create("depth",i,{},"depth_"+l.identifier)),l.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+l.identifier)),l.imageDataElement.appendChild(ht.create("wall",o,{type:"image"},"wall_"+l.identifier)),l.imageDataElement.appendChild(ht.create("floor",s,{type:"image"},"floor_"+l.identifier)),l.initialize(),l}};Oe([Xe()],hs.prototype,"isLocked",void 0),Oe([Xe()],hs.prototype,"mode",void 0),Oe([Xe()],hs.prototype,"rotate",void 0),Oe([Xe()],hs.prototype,"isDropShadow",void 0),Oe([Xe()],hs.prototype,"isSurfaceShading",void 0),Oe([Xe()],hs.prototype,"isInteract",void 0),Oe([Xe()],hs.prototype,"isSlope",void 0),Oe([Xe()],hs.prototype,"slopeDirection",void 0),hs=Mx=Oe([ir("terrain")],hs);var Iu=function(t){return t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL",t}(Iu||{}),DL=function(t){return t.NONE="",t.WHITE="white",t.BLACK="black",t}(DL||{});let Mo=class extends Ir{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundImageIdentifier2="imageIdentifier",this.backgroundFilterType=DL.NONE,this.selected=!1,this.gridType=Iu.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0,this.gridClipRect=null}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof hs&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof Qo&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&U.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var Tp;Oe([Xe()],Mo.prototype,"name",void 0),Oe([Xe()],Mo.prototype,"width",void 0),Oe([Xe()],Mo.prototype,"height",void 0),Oe([Xe()],Mo.prototype,"gridSize",void 0),Oe([Xe()],Mo.prototype,"imageIdentifier",void 0),Oe([Xe()],Mo.prototype,"backgroundImageIdentifier",void 0),Oe([Xe()],Mo.prototype,"backgroundImageIdentifier2",void 0),Oe([Xe()],Mo.prototype,"backgroundFilterType",void 0),Oe([Xe()],Mo.prototype,"selected",void 0),Oe([Xe()],Mo.prototype,"gridType",void 0),Oe([Xe()],Mo.prototype,"gridColor",void 0),Oe([Xe()],Mo.prototype,"isShowNumber",void 0),Mo=Oe([ir("game-table")],Mo);let Jo=class extends Lh{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static#e=Tp=this;static get instance(){return Tp._instance||(Tp._instance=new Tp("TableSelecter"),Tp._instance.initialize()),Tp._instance}onStoreAdded(){super.onStoreAdded(),U.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),U.unregister(this)}get viewTable(){let n=dt.instance.get(this.viewTableIdentifier);return n||(n=dt.instance.getObjects(Mo)[0],n&&(this.viewTableIdentifier.length<1||dt.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,U.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};Oe([Xe()],Jo.prototype,"viewTableIdentifier",void 0),Jo=Tp=Oe([ir("TableSelecter")],Jo);let Do=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return Al.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(o=>{if(o.ok)return o.json();throw new Error("Network response was not ok.")}).then(o=>{let s=performance.now(),a=(s-r)/2,u=new Date(o.utc_datetime).getTime();this.timeOffset=u+a,this.performanceOffset=s,console.log("latency: "+a+"ms"),console.log("st: "+u),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(o=>{console.warn("There has been a problem with your fetch operation: ",o.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,o,s,a,l,u,f,g,v,C,E,w,T){let M=!(v&&this.findFaceIconIdentifier(o)),S={from:xt.peer.userId,to:t.findId(s),name:this.findObjectName(o),toName:s?this.findObjectName(s):"",imageIdentifier:this.findImageIdentifier(o,v),toImageIdentifier:s?this.findImageIdentifier(s):"",timestamp:this.calcTimeStamp(e),tag:M?`${r} noface`:r,text:_e.cr(i),color:a,toColor:s?this.findObjectColor(s):"",isInverseIcon:M&&l?1:0,isHollowIcon:M&&u?1:0,isBlackPaint:M&&f?1:0,aura:M?g:-1,characterIdentifier:C,standIdentifier:E,standName:w,isUseStandImage:T};return e.addMessage(S)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let o={from:xt.peer.userId,name:Ce.myCursor.name,imageIdentifier:Ce.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:e,color:Ce.myCursor.color};r.addMessage(o)}}static findId(e){let i=dt.instance.get(e);return i instanceof cn?i.identifier:i instanceof Ce?i.userId:null}findObjectName(e){let i=dt.instance.get(e);return i instanceof cn?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof Ce?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=dt.instance.get(e);return i instanceof cn?i.chatPalette.color:i instanceof Ce?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=dt.instance.get(e);return r instanceof cn?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof Ce?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=dt.instance.get(e);return i instanceof cn&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();function Dx(t,n=[]){let e=AL(t.aliasName,n),i=-1,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:i<e[o].zindex&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function OL(t,n=[]){let e=AL(t.aliasName,n),i=Number.MAX_SAFE_INTEGER,r=!1;for(let o=0;o<e.length;o++)i===e[o].zindex?r=!0:e[o].zindex<i&&(i=e[o].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i-1,!(0<=t.zindex))){e.sort((o,s)=>o.zindex-s.zindex);for(let o=0;o<e.length;o++)e[o].zindex=o}}function AL(t,n){let e=dt.instance.getObjects(t);return n.forEach(i=>e=e.concat(dt.instance.getObjects(i))),e=e.filter(i=>i.isVisibleOnTable),e}var Ox,Fs=function(t){return t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK",t}(Fs||{});let Ci=Ox=class extends Sr{constructor(){super(...arguments),this.state=Fs.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#555555")}set color(n){this.setCommonValue("color",n)}get ownerName(){let n=Ce.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Ce.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&(this.isHand||xt.peers.some(n=>n.userId===this.owner&&n.isOpen))}get isHand(){return xt.peer.userId===this.owner}get isFront(){return this.state===Fs.FRONT}get isVisible(){return this.isHand||this.isFront}complement(){let n=this.getElement("fontsize",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+this.identifier)),n=this.getElement("text",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n=this.getElement("color",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("color","#555555",{type:"color"},"color_"+this.identifier))}faceUp(){this.state=Fs.FRONT,this.owner=""}faceDown(){this.state=Fs.BACK,this.owner=""}toTopmost(){Dx(this,["card-stack"])}toBackmost(){OL(this,["card-stack"])}static create(n,e,i,r=2,o){let s=null;return s=o?new Ox(o):new Ox,s.createDataElements(),s.commonDataElement.appendChild(ht.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(ht.create("size",r,{},"size_"+s.identifier)),s.imageDataElement.appendChild(ht.create("front",e,{type:"image"},"front_"+s.identifier)),s.imageDataElement.appendChild(ht.create("back",i,{type:"image"},"back_"+s.identifier)),s.commonDataElement.appendChild(ht.create("fontsize",18,{},"fontsize_"+s.identifier)),s.commonDataElement.appendChild(ht.create("text","",{type:"note",currentValue:""},"text_"+s.identifier)),s.commonDataElement.appendChild(ht.create("color","#555555",{type:"color"},"ccolor_"+s.identifier)),s.initialize(),s}};var Ax;Oe([Xe()],Ci.prototype,"state",void 0),Oe([Xe()],Ci.prototype,"rotate",void 0),Oe([Xe()],Ci.prototype,"owner",void 0),Oe([Xe()],Ci.prototype,"zindex",void 0),Oe([Xe()],Ci.prototype,"isLocked",void 0),Ci=Ox=Oe([ir("card")],Ci);let Gi=Ax=class extends Sr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let n=Ce.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Ce.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&xt.peers.some(n=>n.userId===this.owner&&n.isOpen)}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}complement(){this.cards.forEach(n=>n.complement())}onChildRemoved(n){super.onChildRemoved(n),n instanceof Ci&&U.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}inverse(){const n=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;n.unshift(e),e.state=e.state==Fs.FRONT?Fs.BACK:Fs.FRONT}for(let e of n)this.putOnBottom(e)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.prependChild(n)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){Dx(this,["card"])}toBackmost(){OL(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new Ax(e):new Ax,i.createDataElements(),i.commonDataElement.appendChild(ht.create("name",n,{},"name_"+i.identifier));let r=new Ir("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};Oe([Xe()],Gi.prototype,"rotate",void 0),Oe([Xe()],Gi.prototype,"zindex",void 0),Oe([Xe()],Gi.prototype,"owner",void 0),Oe([Xe()],Gi.prototype,"isShowTotal",void 0),Oe([Xe()],Gi.prototype,"isLocked",void 0),Gi=Ax=Oe([ir("card-stack")],Gi);var kx,Ho=function(t){return t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20",t}(Ho||{});let fs=kx=class extends Sr{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?.children.filter(n=>"nothing"!=n.currentValue).map(n=>n.name)??[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(n=>"nothing"==n.currentValue).map(n=>n.name)}get ownerName(){let n=Ce.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=Ce.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get ownerIsOnline(){return this.hasOwner&&xt.peers.some(n=>n.userId===this.owner&&n.isOpen)}get isMine(){return xt.peer.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],o=s=>s+1+"";switch(n){case Ho.D2:i=2,o=a=>0===a?"\u8868":"\u88cf";break;case Ho.D4:i=4;break;case Ho.D6:i=6,r.push(ht.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case Ho.D8:i=8;break;case Ho.D10_10TIMES:o=a=>a+1+"0";case Ho.D10:i=10;break;case Ho.D12:i=12;break;case Ho.D20:i=20;break;default:i=2}for(let s=0;s<i;s++){let a=o(s);r.push(ht.create(a,"",{type:"image"},null!=e?a+"_"+e:null))}return this.imageDataElement.children.forEach(s=>s.destroy()),r.forEach(s=>this.imageDataElement.appendChild(s)),this.face=this.faces[0],r}static create(n,e,i,r){let o=r?new kx(r):new kx;return o.createDataElements(),o.commonDataElement.appendChild(ht.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(ht.create("size",i,{},"size_"+o.identifier)),o.makeDiceFace(e,o.identifier),o.initialize(),o}};var Px;Oe([Xe()],fs.prototype,"face",void 0),Oe([Xe()],fs.prototype,"owner",void 0),Oe([Xe()],fs.prototype,"rotate",void 0),Oe([Xe()],fs.prototype,"isDropShadow",void 0),Oe([Xe()],fs.prototype,"isLock",void 0),fs=kx=Oe([ir("dice-symbol")],fs);let sr=Px=class extends Sr{constructor(n=Il.k.generateUuid()){super(n),this.isLocked=!1,this.rotate=0,this.zindex=0,this.followingCharctorIdentifier=null,this.followingCounterDummy=0,this.offSetX=!1,this.offSetY=!1,this.type="CORN",this.subDivisionSnapPolygonal=!0,this.fillType=1,this.isExpandByFollowing=!1,this.isFollowAltitude=!1,this.followingCharactorCache=null,this.gridSize=50,this.isAltitudeIndicate=!0,this.followingCharctorIdentifier=null}get name(){return this.getCommonValue("name","")}get length(){return this.getCommonValue("length",1)}get width(){return this.getCommonValue("width",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get rangeColor(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#ff0000"}set rangeColor(n){this.setCommonValue("color",n)}get gridColor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#ffff00"}set gridColor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}get isApplyWidth(){return"LINE"===this.type||"CORN"===this.type}get followingCharactor(){if(this.followingCharctorIdentifier){if(!this.followingCharactorCache||this.followingCharactorCache.identifier!==this.followingCharctorIdentifier){let n=dt.instance.get(this.followingCharctorIdentifier);n&&n instanceof cn?this.followingCharactorCache=n:(this.followingCharctorIdentifier=null,this.followingCharactorCache=null)}}else this.followingCharactorCache=null;return this.followingCharactorCache}set followingCharactor(n){n?(this.followingCharactorCache=n,this.followingCharctorIdentifier=n.identifier):(this.followingCharactorCache=null,this.followingCharctorIdentifier=null)}followingCounterDummyCount(){this.followingCounterDummy++,this.followingCounterDummy>=50&&(this.followingCounterDummy=0)}following(){this.followingCharactor&&!this.followingCharactor.isHideIn?(this.location.x=this.followingCharactor.location.x+this.gridSize*this.followingCharactor.size/2,this.location.y=this.followingCharactor.location.y+this.gridSize*this.followingCharactor.size/2,this.isFollowAltitude&&(this.altitude=this.followingCharactor.altitude,this.posZ=this.followingCharactor.posZ),this.followingCounterDummyCount()):this.followingCharactor=null}toTopmost(){Dx(this)}static create(n,e,i,r,o){let s=null;return s=o?new Px(o):new Px,s.createDataElements(),s.commonDataElement.appendChild(ht.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(ht.create("length",i,{},"length_"+s.identifier)),s.commonDataElement.appendChild(ht.create("width",e,{},"width_"+s.identifier)),s.commonDataElement.appendChild(ht.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+s.identifier)),s.commonDataElement.appendChild(ht.create("color","#ff0000",{type:"colors",currentValue:"#ffff00"},"ccolor_"+s.identifier)),s.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+s.identifier)),s.initialize(),s}};var Fx;Oe([Xe()],sr.prototype,"isLocked",void 0),Oe([Xe()],sr.prototype,"rotate",void 0),Oe([Xe()],sr.prototype,"zindex",void 0),Oe([Xe()],sr.prototype,"followingCharctorIdentifier",void 0),Oe([Xe()],sr.prototype,"followingCounterDummy",void 0),Oe([Xe()],sr.prototype,"offSetX",void 0),Oe([Xe()],sr.prototype,"offSetY",void 0),Oe([Xe()],sr.prototype,"type",void 0),Oe([Xe()],sr.prototype,"subDivisionSnapPolygonal",void 0),Oe([Xe()],sr.prototype,"fillType",void 0),Oe([Xe()],sr.prototype,"isExpandByFollowing",void 0),Oe([Xe()],sr.prototype,"isFollowAltitude",void 0),sr=Px=Oe([ir("range")],sr);let Ns=Fx=class extends Sr{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1,this.isWhiteOut=!1,this.isShowTitle=!0}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#444444")}set color(n){this.setCommonValue("color",n)}complement(){let n=this.getElement("color",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("color","#555555",{type:"color"},"color_"+this.identifier)),n=this.getElement("altitude",this.commonDataElement),!n&&this.commonDataElement&&this.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+this.identifier))}toTopmost(){Dx(this)}static create(n,e,i=16,r=1,o=1,s){let a=s?new Fx(s):new Fx;return a.createDataElements(),a.commonDataElement.appendChild(ht.create("width",r,{},"width_"+a.identifier)),a.commonDataElement.appendChild(ht.create("height",o,{},"height_"+a.identifier)),a.commonDataElement.appendChild(ht.create("fontsize",i,{},"fontsize_"+a.identifier)),a.commonDataElement.appendChild(ht.create("title",n,{},"title_"+a.identifier)),a.commonDataElement.appendChild(ht.create("text",e,{type:"note",currentValue:e},"text_"+a.identifier)),a.commonDataElement.appendChild(ht.create("color","#444444",{type:"color"},"ccolor_"+a.identifier)),a.commonDataElement.appendChild(ht.create("altitude",0,{},"altitude_"+a.identifier)),a.initialize(),a}};Oe([Xe()],Ns.prototype,"rotate",void 0),Oe([Xe()],Ns.prototype,"zindex",void 0),Oe([Xe()],Ns.prototype,"password",void 0),Oe([Xe()],Ns.prototype,"isUpright",void 0),Oe([Xe()],Ns.prototype,"isLocked",void 0),Oe([Xe()],Ns.prototype,"isWhiteOut",void 0),Oe([Xe()],Ns.prototype,"isShowTitle",void 0),Ns=Fx=Oe([ir("text-note")],Ns);let p3=class extends Lh{onStoreAdded(){super.onStoreAdded(),dt.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(dt.instance.getObjects(Mo)),e=e.concat(dt.instance.getObjects(cn)),e=e.concat(dt.instance.getObjects(sr)),e=e.concat(dt.instance.getObjects(Ns)),e=e.concat(dt.instance.getObjects(Gi)),e=e.concat(dt.instance.getObjects(Ci).filter(i=>null===i.parent)),e=e.concat(dt.instance.getObjects(fs));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(dt.instance.getObjects(Mo)),e=e.concat(dt.instance.getObjects(Qo)),e=e.concat(dt.instance.getObjects(hs)),e=e.concat(dt.instance.getObjects(cn)),e=e.concat(dt.instance.getObjects(sr)),e=e.concat(dt.instance.getObjects(Ns)),e=e.concat(dt.instance.getObjects(Gi)),e=e.concat(dt.instance.getObjects(Ci)),e=e.concat(dt.instance.getObjects(fs));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)dr.instance.parseXml(n.children[i])}};p3=Oe([ir("room")],p3);var Wee=me(9822),$ee=me.n(Wee);class kl{static#e=this.queue=new l5("SaveDataServiceQueue");constructor(n,e){this.ngZone=n,this.chatMessageService=e}saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${n}.zip \u3092\u4fdd\u5b58`),kl.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new p3),o=this.convertToXml(Al.instance),s=this.convertToXml(Nc.instance),a=this.convertToXml(Lc.instance),l=this.convertToXml(Tu.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([o],"fly_chat.xml",{type:"text/plain"})),i.push(new File([s],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([a],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([l],"summary.xml",{type:"text/plain"}));let u=[];u=u.concat(this.searchImageFiles(r)),u=u.concat(this.searchImageFiles(o)),u=u.concat(this.searchImageFiles(a));for(const g of u)g.state===Di.COMPLETE&&i.push(new File([g.blob],g.identifier+"."+Td.extension(g.blob.type),{type:g.blob.type}));let f=this.convertToXml(Xs.create(u));return i.push(new File([f],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${_e.aliasNameToClassName(n.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),kl.queue.add((r,o)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="fly_xml_data",i){let r=[],o=this.convertToXml(n);r.push(new File([o],"fly_data.xml",{type:"text/plain"}));let s=[];s=s.concat(this.searchImageFiles(o));for(const l of s)l.state===Di.COMPLETE&&r.push(new File([l.blob],l.identifier+"."+Td.extension(l.blob.type),{type:l.blob.type}));let a=this.convertToXml(Xs.create(s));return r.push(new File([a],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i,r){let o=-1;return wu.instance.saveAsync(n,e,s=>{let a=0|s.percent;a<=o||(o=a,this.ngZone.run(()=>i(o)))},r)}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+$ee().xml(n.toXml(),2)}searchImageFiles(n){let e=bd.xml2element(n),i=[];if(!e)return i;let r={},o=e.ownerDocument.querySelectorAll('*[type="image"]');for(let s=0;s<o.length;s++){let a=o[s].innerHTML;r[a]=Yt.instance.get(a);let l=o[s].getAttribute("currentValue");l&&(r[l]=Yt.instance.get(l))}o=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier], *[backgroundImageIdentifier2]");for(let s=0;s<o.length;s++){let a=o[s].getAttribute("imageIdentifier");a&&(r[a]=Yt.instance.get(a));let l=o[s].getAttribute("toImageIdentifier");l&&(r[a]=Yt.instance.get(l));let u=o[s].getAttribute("backgroundImageIdentifier");u&&(r[u]=Yt.instance.get(u));let f=o[s].getAttribute("backgroundImageIdentifier2");f&&(r[f]=Yt.instance.get(f))}for(let s in r){let a=r[s];a&&i.push(a)}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(n,e,i=null,r="HH:mm",o=!0){const s=0==n?"text/plain":"text/html",a=0==n?".txt":".html",l="fly_"+this.appendTimestamp(e)+a;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${l} \u3092\u4fdd\u5b58`),TL(new Blob([Al.instance.log(n,r,o,null,i)],{type:`${s};charset=utf-8`}),l)}saveChatLogAsync(n,e,i=null,r="HH:mm",o=!0,s){var a=this;return(0,R.A)(function*(){const l="fly_"+a.appendTimestamp(e);a.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${l}.zip \u3092\u4fdd\u5b58`);const u=[],f=(i||[Al.instance]).reduce((v,C)=>v.concat(a.searchImageFiles(a.convertToXml(C))),[]),g={};for(const v of f)if(!g[v.identifier])if(v.state===Di.COMPLETE){const C=v.identifier+"."+Td.extension(v.blob.type);g[v.identifier]="./images/"+C,u.push(new File([v.blob],C,{type:v.blob.type}))}else v.state===Di.URL&&(0==v.url.indexOf("http")?_e.validUrl(v.url)&&(g[v.identifier]=v.url):yield fetch(v.url).then(C=>C.blob()).then(C=>{const E=v.identifier+"."+Td.extension(C.type);g[v.identifier]="./images/"+E,u.push(new File([C],E,{type:C.type}))}));return u.push(new File([Al.instance.log(n,r,o,g,i)],"index.html",{type:"text/html;charset=utf-8"})),a.saveAsync(u,l,s,!0)})()}static#t=this.\u0275fac=function(e){return new(e||kl)(kn(Sn),kn(Do))};static#n=this.\u0275prov=Wt({token:kl,factory:kl.\u0275fac,providedIn:"root"})}const Yee=["select"],qee=t=>({"is-hidden":t});function Zee(t,n){if(1&t&&(p(0,"option",7),x(1),m()),2&t){const e=n.$implicit;ft("value",e.identifier),h(),Re(e.name)}}function Xee(t,n){if(1&t&&(p(0,"div",19),x(1),m()),2&t){const e=y(2);h(),Mi("",e.progresPercent,"%")}}function Kee(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",8)(2,"div"),x(3," \u30bf\u30d6\uff1a "),p(4,"label")(5,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.isAllTabs,r)||(o.isAllTabs=r),D(r)}),m(),x(6,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),m(),p(7,"label")(8,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.isAllTabs,r)||(o.isAllTabs=r),D(r)}),m(),x(9,"\u5168\u3066\u306e\u30bf\u30d6"),m()(),p(10,"div"),x(11," \u5f62\u5f0f\uff1a "),p(12,"label")(13,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.logFormat,r)||(o.logFormat=r),D(r)}),m(),x(14,"\u30c6\u30ad\u30b9\u30c8"),m(),p(15,"label")(16,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.logFormat,r)||(o.logFormat=r),D(r)}),m(),x(17,"HTML"),m(),p(18,"label")(19,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.logFormat,r)||(o.logFormat=r),D(r)}),m(),x(20,"HTML (\u753b\u50cf\u3042\u308a)"),m(),p(21,"div",10),x(22,"\u203b"),p(23,"b"),x(24,"HTML\uff08\u753b\u50cf\u3042\u308a\uff09"),m(),x(25," \u306fZIP\u30d5\u30a1\u30a4\u30eb\u3068\u306a\u308a\u307e\u3059\u3001"),Ne(26,"br"),x(27,"\u3000\u30d5\u30a9\u30eb\u30c0\u69cb\u9020\u3092\u4fdd\u3063\u3066\u89e3\u51cd\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),m()(),p(28,"div"),x(29," \u6642\u523b\uff1a "),p(30,"label")(31,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.dateFormat,r)||(o.dateFormat=r),D(r)}),m(),x(32,"\u306a\u3057"),m(),p(33,"label")(34,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.dateFormat,r)||(o.dateFormat=r),D(r)}),m(),x(35,"\u6642\uff1a\u5206"),m(),p(36,"label")(37,"input",9),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.dateFormat,r)||(o.dateFormat=r),D(r)}),m(),x(38,"\u65e5\u4ed8\u6642\u523b"),m()()(),Ne(39,"hr"),p(40,"div",11)(41,"div")(42,"label",12)(43,"input",13),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.isWriteOerationLog,r)||(o.isWriteOerationLog=r),D(r)}),m(),x(44,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b "),m()(),p(45,"div",14)(46,"button",15),X("click",function(){O(e);const r=y();return D(r.logFormat<2?r.saveLog():r.saveLogWithImages())}),p(47,"div",16)(48,"div",17),x(49,"\u30ed\u30b0\u51fa\u529b"),m(),L(50,Xee,2,1,"div",18),m()()()(),De()}if(2&t){const e=y();h(5),no("name","",e.panelId,"-log-output-tab"),We("ngModel",e.isAllTabs),_("checked",!e.isAllTabs)("value",!1),h(3),no("name","",e.panelId,"-log-output-tab"),We("ngModel",e.isAllTabs),_("checked",e.isAllTabs)("value",!0),h(5),no("name","",e.panelId,"-log-output-format"),We("ngModel",e.logFormat),_("checked",0==e.logFormat)("value",0),h(3),no("name","",e.panelId,"-log-output-format"),We("ngModel",e.logFormat),_("checked",1==e.logFormat)("value",1),h(3),no("name","",e.panelId,"-log-output-format"),We("ngModel",e.logFormat),_("checked",2==e.logFormat)("value",2),h(12),no("name","",e.panelId,"-log-output-timestamp-type"),We("ngModel",e.dateFormat),_("checked",""==e.dateFormat)("value",""),h(3),no("name","",e.panelId,"-log-output-timestamp-type"),We("ngModel",e.dateFormat),_("checked","HH:mm"==e.dateFormat)("value","HH:mm"),h(3),no("name","",e.panelId,"-log-output-timestamp-type"),We("ngModel",e.dateFormat),_("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),h(6),ft("checked",e.isWriteOerationLog?"checked":""),We("ngModel",e.isWriteOerationLog),h(3),_("disabled",e.isDisable),h(2),_("ngClass",Be(45,qee,e.isSaveing)),h(2),_("ngIf",e.isSaveing)}}function Qee(t,n){1&t&&(Me(0),p(1,"div",20),x(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),m(),De())}let kL=(()=>{class t{static#e=this.isAllTabs=!1;static#t=this.logFormat=1;static#n=this.dateFormat="HH:mm";static#i=this.isWriteOerationLog=!0;get isAllTabs(){return t.isAllTabs}set isAllTabs(e){t.isAllTabs=e}get logFormat(){return t.logFormat}set logFormat(e){t.logFormat=e}get dateFormat(){return t.dateFormat}set dateFormat(e){t.dateFormat=e}get isWriteOerationLog(){return t.isWriteOerationLog}set isWriteOerationLog(e){t.isWriteOerationLog=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDisable(){return this.isEmpty||this.isSaveing||!this.isAllTabs&&0===this.selectedTabs.length}get roomName(){return xt.peer&&0<xt.peer.roomName.length?xt.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.selectedTabs=[],this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),U.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{0!=this.selectedTabs.length&&e.data.identifier&&(dt.instance.get(e.data.identifier)||(this.selectedTabs=this.selectedTabs.filter(r=>r&&r.identifier!=e.data.identifier)),this.selectTabsApplay())}),this.panelId=Il.k.generateUuid()}ngAfterViewInit(){this.selectTabsApplay()}ngOnDestroy(){U.unregister(this)}onChangeSelectTabs(){this.select&&(this.selectedTabs=Array.from(this.select.nativeElement.options).filter(e=>e.selected).map(e=>dt.instance.get(e.value)).filter(e=>e))}selectTabsApplay(){if(!this.select||this.isAllTabs)return;const e=this.selectedTabs.map(i=>i.identifier);Array.from(this.select.nativeElement.options).forEach(i=>{i.selected=e.includes(i.value)})}saveLog(){this.isDisable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTabs[0].name+(this.selectedTabs.length>1?"\u3001\u4ed6":"")),this.isAllTabs?null:this.selectedTabs,this.dateFormat,this.isWriteOerationLog)}saveLogWithImages(){var e=this;return(0,R.A)(function*(){if(e.isDisable)return;const i=e.roomName+"_chatLogWithImages_"+(e.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":e.selectedTabs[0].name+(e.selectedTabs.length>1?"\u3001\u4ed6":"")),r=e.isAllTabs?null:e.selectedTabs;e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveChatLogAsync(e.logFormat,i,r,e.dateFormat,e.isWriteOerationLog,o=>{e.progresPercent=o}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}static#r=this.\u0275fac=function(i){return new(i||t)(F(Ii),F(bi),F(Do),F(kl))};static#o=this.\u0275cmp=xn({type:t,selectors:[["app-chat-log-output"]],viewQuery:function(i,r){if(1&i&&Dn(Yee,5),2&i){let o;On(o=An())&&(r.select=o.first)}},decls:8,vars:4,consts:[["select",""],[1,"flex-container",2,"flex-wrap","nowrap"],[1,"flex-item","no-grow"],["size","10","multiple","",2,"width","140px",3,"change","disabled"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","radio",3,"ngModelChange","name","ngModel","checked","value"],[2,"font-weight","normal","padding-left","1em"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModelChange","ngModel","checked"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1)(1,"div",2)(2,"select",3,0),X("change",function(){return O(o),D(r.onChangeSelectTabs())}),L(4,Zee,2,2,"option",4),m()(),p(5,"div",5),L(6,Kee,51,47,"ng-container",6),m()(),L(7,Qee,3,0,"ng-container",6)}2&i&&(h(2),_("disabled",r.isAllTabs),h(2),_("ngForOf",r.chatTabs),h(2),_("ngIf",!r.isEmpty),h(),_("ngIf",r.isEmpty))},dependencies:[Fi,nr,ni,ya,Ca,Rr,Wa,Nh,Lr,Tr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]})}return t})();const Jee=t=>({"is-hidden":t});function ete(t,n){if(1&t&&(p(0,"option",8),x(1),m()),2&t){const e=n.$implicit;ke("color",""==e.name?"gray":""),ft("value",e.identifier),ft("title",e.name),h(),Re(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function tte(t,n){if(1&t&&(p(0,"div",22),x(1),m()),2&t){const e=y(3);h(),Mi("",e.progresPercent,"%")}}function nte(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",14),X("click",function(){return O(e),D(y(2).upTabIndex())}),x(2,"\u2191"),m(),p(3,"button",14),X("click",function(){return O(e),D(y(2).downTabIndex())}),x(4,"\u2193"),m(),p(5,"div",15)(6,"button",14),X("click",function(){return O(e),D(y(2).showLogOutput())}),p(7,"i",16),x(8,"history_edu"),m(),x(9,"\u30ed\u30b0"),m(),p(10,"button",17),X("click",function(){return O(e),D(y(2).save())}),p(11,"div",18)(12,"div",19),x(13,"\u4fdd\u5b58"),m(),L(14,tte,2,1,"div",20),m()(),p(15,"button",21),X("click",function(){return O(e),D(y(2).delete())}),x(16,"\u524a\u9664"),m()(),De()}if(2&t){const e=y(2);h(10),_("disabled",e.isSaveing),h(2),_("ngClass",Be(4,Jee,e.isSaveing)),h(2),_("ngIf",e.isSaveing),h(),$t("disabled",e.chatTabs.length<=1?"":null)}}function ite(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",14),X("click",function(){return O(e),D(y(2).restore())}),x(2,"\u5143\u306b\u623b\u3059"),m(),De()}}function rte(t,n){if(1&t){const e=Ie();Me(0),p(1,"div")(2,"b",9),x(3,"\u30bf\u30d6\u540d: "),m(),p(4,"input",10),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tabName,r)||(o.tabName=r),D(r)}),m()(),p(5,"div",11)(6,"label")(7,"input",12),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.isUseStandImage,r)||(o.isUseStandImage=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.isUseStandImage=!!r.isUseStandImage)}),m(),p(8,"span",13),x(9,"\u{1f4ad}"),m(),x(10,"\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),m()(),p(11,"div",11)(12,"label")(13,"input",12),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.recieveOperationLogLevel,r)||(o.recieveOperationLogLevel=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0)}),m(),x(14," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),m()(),Ne(15,"hr"),p(16,"div"),L(17,nte,17,6,"ng-container",7)(18,ite,3,0,"ng-container",7),m(),De()}if(2&t){const e=y();h(4),We("ngModel",e.tabName),$t("disabled",e.isEditable?null:""),h(2),ke("cursor",e.isEditable?"pointer":"default"),h(),ft("checked",e.isUseStandImage?"checked":""),We("ngModel",e.isUseStandImage),$t("disabled",e.isEditable?null:""),h(5),ke("cursor",e.isEditable?"pointer":"default"),h(),ft("checked",e.recieveOperationLogLevel>0?"checked":""),We("ngModel",e.recieveOperationLogLevel),$t("disabled",e.isEditable?null:""),h(4),_("ngIf",!e.isDeleted),h(),_("ngIf",e.isDeleted)}}function ote(t,n){1&t&&(Me(0),p(1,"div",23),x(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),m(),De())}let ste=(()=>{class t{get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==dt.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return xt.peer&&0<xt.peer.roomName.length?xt.peer.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}constructor(e,i,r,o,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=o,this.pointerDeviceService=s,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),U.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=dt.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){U.unregister(this)}onChangeSelectTab(e){this.selectedTab=dt.instance.get(e),this.selectedTabXml=""}create(){Al.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,R.A)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=dr.instance.parseXml(this.selectedTabXml);Al.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(kL,{left:e.x-250,top:e.y-175,width:540,height:300});r.selectedTabs=[this.selectedTab],r.selectTabsApplay()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Ii),F(bi),F(Do),F(kl),F(hr))};static#t=this.\u0275cmp=xn({type:t,selectors:[["app-chat-tab-setting"]],decls:11,vars:4,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"change","ngModel"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModelChange","ngModel"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"text-shadow","#111 0 0 1px"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),X("click",function(){return O(o),D(r.create())}),x(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),m()(),p(5,"select",4,0),X("change",function(){O(o);const a=rn(6);return D(r.onChangeSelectTab(a.value))}),L(7,ete,2,5,"option",5),m()(),p(8,"div",6),L(9,rte,19,14,"ng-container",7),m()(),L(10,ote,3,0,"ng-container",7)}2&i&&(h(5),_("ngModel",null==r.selectedTab?null:r.selectedTab.identifier),h(2),_("ngForOf",r.chatTabs),h(2),_("ngIf",!r.isEmpty&&r.selectedTab),h(),_("ngIf",r.isEmpty))},dependencies:[Fi,nr,ni,ya,Ca,Rr,Wa,wl,Lr,Tr],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]})}return t})();const ate=["chatTabComponemt"],PL=t=>({"is-active":t});function lte(t,n){if(1&t){const e=Ie();p(0,"chat-tab",16,0),X("onAddMessage",function(){return O(e),D(y().scrollToBottom())}),m()}if(2&t){const e=y();_("chatTab",e.chatTab)("compact",e.isCompact)}}function cte(t,n){1&t&&(p(0,"div"),x(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),m())}function ute(t,n){1&t&&(p(0,"i",9),x(1,"how_to_reg"),m())}function dte(t,n){1&t&&(p(0,"i",9),x(1,"history_edu"),m())}function hte(t,n){1&t&&Ne(0,"badge",21),2&t&&_("count",y().$implicit.unreadLength)}function fte(t,n){if(1&t){const e=Ie();p(0,"label",17)(1,"input",18),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.chatTabidentifier,r)||(o.chatTabidentifier=r),D(r)}),m(),p(2,"div")(3,"span"),x(4),m(),L(5,ute,2,0,"i",19)(6,dte,2,0,"i",19)(7,hte,1,1,"badge",20),m()()}if(2&t){const e=n.$implicit,i=y();h(),ft("value",e.identifier),We("ngModel",i.chatTabidentifier),h(2),ke("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),h(),Re(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),h(),_("ngIf",e.isUseStandImage),h(),_("ngIf",e.recieveOperationLogLevel>0),h(),_("ngIf",e.hasUnread)}}let Ip=(()=>{class t{static#e=this.isNoticeOn=!1;get isNoticeOn(){return t.isNoticeOn}set isNoticeOn(e){t.isNoticeOn=e}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return dt.instance.get(this.chatTabidentifier)}constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}ngOnInit(){this.sendFrom=Ce.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",U.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=dt.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){U.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(ste,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(kL,{left:e.x-250,top:e.y-175,width:540,height:300});r.selectedTabs=this.chatTab?[this.chatTab]:[],r.selectTabsApplay()}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}static#t=this.\u0275fac=function(i){return new(i||t)(F(Do),F(bi),F(hr))};static#n=this.\u0275cmp=xn({type:t,selectors:[["chat-window"]],viewQuery:function(i,r){if(1&i&&Dn(ate,5),2&i){let o;On(o=An())&&(r.chatTabComponemt=o.first)}},decls:28,vars:15,consts:[["chatTabComponemt",""],[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["title","\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","ngClass"],[1,"material-icons",2,"font-size","1em"],[2,"color","red"],["title","\u7c21\u6613\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","ngClass"],[3,"gameTypeChange","sendFromChange","chat","chatTabidentifier","gameType","sendFrom"],[3,"onAddMessage","chatTab","compact"],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(i,r){1&i&&(p(0,"div",1)(1,"div",2),L(2,lte,2,2,"chat-tab",3)(3,cte,2,0,"div",4),m(),p(4,"div",5)(5,"form")(6,"div",6),L(7,fte,8,10,"label",7),p(8,"button",8),X("click",function(){return r.showTabSetting()}),p(9,"i",9),x(10,"settings"),m(),x(11,"\u30bf\u30d6"),m(),p(12,"button",8),X("click",function(){return r.showLogOutput()}),p(13,"i",9),x(14,"history_edu"),m(),x(15,"\u30ed\u30b0"),m(),p(16,"div",10)(17,"button",11),X("click",function(){return r.isNoticeOn=!r.isNoticeOn}),p(18,"i",12),x(19),m(),p(20,"sup",13),x(21,"*"),m()(),p(22,"button",14),X("click",function(){return r.isCompact=!r.isCompact}),p(23,"i",12),x(24),m(),p(25,"sup",13),x(26,"*"),m()()()()(),p(27,"chat-input",15),$e("gameTypeChange",function(s){return Ge(r.gameType,s)||(r.gameType=s),s})("sendFromChange",function(s){return Ge(r.sendFrom,s)||(r.sendFrom=s),s}),X("chat",function(s){return r.sendChat(s)}),m()()()),2&i&&(h(2),_("ngIf",r.chatTab),h(),_("ngIf",!r.chatTab),h(4),_("ngForOf",r.chatMessageService.chatTabs)("ngForTrackBy",r.trackByChatTab),h(10),_("ngClass",Be(11,PL,r.isNoticeOn)),h(2),Re(r.isNoticeOn?"notifications_active":"notifications_off"),h(3),_("ngClass",Be(13,PL,r.isCompact)),h(2),Re(r.isCompact?"list":"forum"),h(3),_("chatTabidentifier",r.chatTabidentifier),We("gameType",r.gameType)("sendFrom",r.sendFrom))},styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}button.indicate[_ngcontent-%COMP%]{margin:0 0 0 1px}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.indicate.is-active[_ngcontent-%COMP%]{background-color:#fff}button.indicate.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.indicate[_ngcontent-%COMP%]   sup[_ngcontent-%COMP%]{display:inline-block;top:2px;position:relative}"]})}return t})();const pte=["root"],gte=["altitudeSlider"],mte=(t,n,e,i)=>({"icons-panel":t,"submenu-panel":n,"is-max-limit":e,"pointer-events-none":i}),_te=t=>({action:t}),bte=(t,n,e)=>({"has-color":t,hasHighlight:n,disabled:e}),vte=(t,n)=>({"icon-menu":t,default:n});function yte(t,n){if(1&t){const e=Ie();p(0,"span",13),x(1," (\u9ad8\u5ea6 "),p(2,"input",14),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.altitudeHande.altitude,r)||(o.altitudeHande.altitude=r),D(r)}),m(),x(3,")"),m()}if(2&t){const e=y(2);h(2),We("ngModel",e.altitudeHande.altitude),_("disabled",!e.altitudeHande.isHaveAltitude||e.isAltitudeDisabled)}}function Cte(t,n){if(1&t&&(p(0,"div")(1,"div",11),x(2),L(3,yte,4,2,"span",12),m()()),2&t){const e=y();h(),ke("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),h(),Re(e.title),h(),_("ngIf",e.altitudeHande)}}function xte(t,n){1&t&&(p(0,"div",15)(1,"div",16),x(2,"\u9ad8"),m(),p(3,"div",17),x(4,"0"),m(),p(5,"div",18),x(6,"\u4f4e"),m()())}function wte(t,n){if(1&t){const e=Ie();p(0,"div",19)(1,"input",20,3),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.altitudeHande.altitude,r)||(o.altitudeHande.altitude=r),D(r)}),m()()}if(2&t){const e=y();h(),ft("title",e.altitudeHande.altitude),We("ngModel",e.altitudeHande.altitude),_("disabled",!e.altitudeHande.isHaveAltitude||e.isAltitudeDisabled)}}function Ete(t,n){1&t&&ti(0)}function Tte(t,n){if(1&t&&(Me(0),L(1,Ete,1,0,"ng-container",21),De()),2&t){const e=y().$implicit;y();const i=rn(10),r=rn(12);h(),_("ngTemplateOutlet","separator"===(null==e?null:e.type)?r:i)("ngTemplateOutletContext",Be(2,_te,e))}}function Ite(t,n){if(1&t&&(Me(0),L(1,Tte,2,4,"ng-container",5),De()),2&t){const e=n.$implicit;h(),_("ngIf",e)}}function Ste(t,n){1&t&&(p(0,"span",45),x(1,"\u26a0\ufe0f"),m()),2&t&&ft("title",y().action.error)}function Mte(t,n){1&t&&Ne(0,"input",46),2&t&&_("disabled",y().action.disabled)}function Dte(t,n){1&t&&Ne(0,"input",47),2&t&&_("disabled",y().action.disabled)}function Ote(t,n){1&t&&Ne(0,"input",48),2&t&&_("disabled",y().action.disabled)}function Ate(t,n){1&t&&Ne(0,"input",49),2&t&&_("disabled",y().action.disabled)}function kte(t,n){1&t&&(p(0,"span",50),x(1,"\u25a0"),m())}function Pte(t,n){1&t&&(p(0,"span",51),x(1,"\u25a0"),m())}function Fte(t,n){1&t&&(p(0,"span",52),x(1,"\u25a0"),m())}function Nte(t,n){1&t&&(p(0,"span",53),x(1,"\u25a0"),m())}function Rte(t,n){1&t&&(p(0,"span",54),x(1,"\u25a0"),m())}function Lte(t,n){1&t&&(p(0,"span",55),x(1,"\u25a0"),m())}function Bte(t,n){1&t&&(p(0,"span",56),x(1,"\u25a0"),m())}function Ute(t,n){1&t&&(p(0,"span",57),x(1,"\u25a0"),m())}function Hte(t,n){if(1&t&&(p(0,"span",58)(1,"i",59),x(2),m()()),2&t){const e=y().action;h(2),Re(e.materialIcon)}}function zte(t,n){1&t&&(p(0,"sup",60),x(1,"*"),m())}function Vte(t,n){1&t&&Ne(0,"span",61),2&t&&_("innerHtml",y().action.hotkey,eo)}function jte(t,n){if(1&t&&(p(0,"span",62),Ne(1,"img",63),It(2,"safe"),m()),2&t){const e=y().action;h(),_("src",St(2,1,e.icon.url,"resourceUrl"),gn)}}function Gte(t,n){1&t&&(p(0,"i",64),x(1,"open_in_new"),m())}function Wte(t,n){1&t&&(p(0,"div",65)(1,"i",66),x(2,"arrow_forward_ios"),m()())}function $te(t,n){if(1&t&&Ne(0,"context-menu",67),2&t){const e=y().action,i=y();_("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}function Yte(t,n){if(1&t){const e=Ie();p(0,"li",22),X("click",function(){const r=O(e).action,o=y();return D(!(r.disabled||r.altitudeHande&&0==r.altitudeHande.altitude)&&o.doAction(r))})("mouseenter",function(){const r=O(e).action,o=y();return D(!(r.disabled||r.altitudeHande&&0==r.altitudeHande.altitude)&&o.showSubMenu(r))}),p(1,"div",23),L(2,Ste,2,1,"span",24)(3,Mte,1,1,"input",25)(4,Dte,1,1,"input",26)(5,Ote,1,1,"input",27)(6,Ate,1,1,"input",28)(7,kte,2,0,"span",29)(8,Pte,2,0,"span",30)(9,Fte,2,0,"span",31)(10,Nte,2,0,"span",32)(11,Rte,2,0,"span",33)(12,Lte,2,0,"span",34)(13,Bte,2,0,"span",35)(14,Ute,2,0,"span",36)(15,Hte,3,1,"span",37),Ne(16,"span",38),It(17,"safe"),L(18,zte,2,0,"sup",39)(19,Vte,1,1,"span",40)(20,jte,3,4,"span",41)(21,Gte,2,0,"i",42),m(),L(22,Wte,3,0,"div",43)(23,$te,1,3,"context-menu",44),m()}if(2&t){const e=n.action,i=y();ke("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),_("ngClass",ma(32,bte,e.color,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),h(),_("ngClass",Cn(36,vte,e.icon,e.default)),h(),_("ngIf",e.error),h(),_("ngIf",e.name&&"check"==e.checkBox&&0==e.name.indexOf("\u2611")),h(),_("ngIf",e.name&&"check"==e.checkBox&&0==e.name.indexOf("\u2610")),h(),_("ngIf",e.name&&"radio"==e.checkBox&&0==e.name.indexOf("\u25c9")),h(),_("ngIf",e.name&&"radio"==e.checkBox&&0==e.name.indexOf("\u25cb")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),h(),_("ngIf",e.name&&e.colorSample&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),h(),_("ngIf",e.materialIcon),h(),_("innerHTML",St(17,29,i.actionNameHtmlEscape(e.name,e.checkBox),"html"),eo),h(2),_("ngIf",e.selfOnly),h(),_("ngIf",""!=e.hotkey),h(),_("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),h(),_("ngIf",e.isOuterLink),h(),_("ngIf",e.subActions&&!e.disabled),h(),_("ngIf",i.subMenu&&i.parentMenu===e)}}function qte(t,n){1&t&&(p(0,"li"),Ne(1,"hr",68),m())}let Zte=(()=>{class t{get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isAltitudeDisabled(){return this.actions.some(e=>e&&e.altitudeDisabled)}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=Ce.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=o=>this.onOutsideClick(o)}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),o=i.getBoundingClientRect(),s=0,a=0;window.innerWidth<o.right+s&&(s-=r.width+o.width,s+=8),o.left+s<0&&(s+=0-(o.left+s)),window.innerHeight<o.bottom+a&&(a+=window.innerHeight-(o.bottom+a)),o.top+a<0&&(a+=0-(o.top+a)),i.style.left=i.offsetLeft+s+"px",i.style.top=i.offsetTop+a+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}actionNameHtmlEscape(e,i=null){return null==e?"":("check"==i&&(e=e.replace(/^[\u2611\u2610]/,"")),"radio"==i&&(e=e.replace(/^[\u25c9\u25cb]/,"")),_e.escapeHtml(e).replace(/\ud83d\udcad/g,'<span style="text-shadow: #111 0 0 1px">\u{1f4ad}</span>'))}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r),F(Xo),F(hr))};static#t=this.\u0275cmp=xn({type:t,selectors:[["context-menu"]],viewQuery:function(i,r){if(1&i&&(Dn(pte,7),Dn(gte,5)),2&i){let o;On(o=An())&&(r.rootElementRef=o.first),On(o=An())&&(r.altitudeSlider=o.first)}},hostBindings:function(i,r){1&i&&X("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[["root",""],["actionMenu",""],["separator",""],["altitudeSlider",""],[1,"component",2,"display","flex","flex-direction","column",3,"mouseleave","ngClass"],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModelChange","ngModel","disabled"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"ngModelChange","title","ngModel","disabled"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"click","mouseenter","ngClass"],[1,"menu-title",2,"width","100%",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],[3,"innerHTML"],["class","self-only",4,"ngIf"],["class","hotkey",3,"innerHtml",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"hotkey",3,"innerHtml"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",4,0),X("mouseleave",function(){return O(o),D(r.hideSubMenu())}),L(2,Cte,4,6,"div",5),p(3,"div",6),L(4,xte,7,0,"div",7)(5,wte,3,3,"div",8),p(6,"div",9)(7,"ul"),L(8,Ite,2,1,"ng-container",10),m()()()(),L(9,Yte,24,39,"ng-template",null,1,Pi)(11,qte,2,0,"ng-template",null,2,Pi)}2&i&&(_("ngClass",yl(5,mte,r.isIconsMenu,r.isSubmenu,!r.isSubmenu,r.isPointerDragging)),h(2),_("ngIf",!r.isIconsMenu&&0<r.title.length||r.altitudeHande),h(2),_("ngIf",r.altitudeHande),h(),_("ngIf",r.altitudeHande),h(3),_("ngForOf",r.actions))},dependencies:[Fi,nr,ni,ip,Rr,Xl,Kl,Lr,Tr,t,fr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;padding:0;white-space:nowrap;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}ul[_ngcontent-%COMP%] > li.has-color.hasHighlight[_ngcontent-%COMP%]:hover{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;object-fit:cover;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}.hotkey[_ngcontent-%COMP%]{float:right;font-size:smaller}"]})}return t})();const Xte=["chatInput"],Kte=["chatPlette"];function Qte(t,n){1&t&&(p(0,"i",15),x(1,"how_to_reg"),m())}function Jte(t,n){1&t&&(p(0,"i",15),x(1,"history_edu"),m())}function ene(t,n){1&t&&Ne(0,"badge",16),2&t&&_("count",y().$implicit.unreadLength)}function tne(t,n){if(1&t){const e=Ie();p(0,"label")(1,"input",12),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.chatTabidentifier,r)||(o.chatTabidentifier=r),D(r)}),m(),p(2,"div")(3,"span"),x(4),m(),L(5,Qte,2,0,"i",13)(6,Jte,2,0,"i",13)(7,ene,1,1,"badge",14),m()()}if(2&t){const e=n.$implicit,i=y();h(),ft("value",e.identifier),We("ngModel",i.chatTabidentifier),h(2),ke("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),h(),Re(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),h(),_("ngIf",e.isUseStandImage),h(),_("ngIf",e.recieveOperationLogLevel>0),h(),_("ngIf",e.hasUnread)}}function nne(t,n){if(1&t){const e=Ie();p(0,"div",17)(1,"div",18)(2,"i",19),x(3,"info_outline"),m(),x(4," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d"),m(),p(5,"div",20)(6,"button",21),X("click",function(){return O(e),D(y().helpChatPallet())}),x(7,"?"),m()()()}}function ine(t,n){if(1&t&&(p(0,"option",25),x(1),m()),2&t){const e=y().$implicit;ke("color",y(3).color),ft("value",e),ft("title",e),h(),Re(e)}}function rne(t,n){if(1&t&&(Me(0),L(1,ine,2,5,"option",24),De()),2&t){const e=n.$implicit,i=y(3);h(),_("ngIf",i.filter(e))}}function one(t,n){if(1&t&&(Me(0),L(1,rne,2,1,"ng-container",5),De()),2&t){const e=y(2);h(),_("ngForOf",e.filteredPaletteStrings)}}function sne(t,n){if(1&t){const e=Ie();p(0,"div",22)(1,"select",23,1),X("focus",function(){return O(e),D(y().arrowPalette())})("keydown.arrowUp",function(r){return O(e),D(y().moveToInput(r))})("keyup.arrowUp",function(){return O(e),D(y().arrowPalette())})("keyup.arrowDown",function(){return O(e),D(y().arrowPalette())})("keydown.enter",function(r){O(e);const o=rn(2);return D(y().enterPalette(o.value,r))})("click",function(){O(e);const r=rn(2);return D(y().clickPalette(r.value))}),L(3,one,2,1,"ng-container",11),m()()}if(2&t){const e=y();h(3),_("ngIf",e.palette)}}function ane(t,n){if(1&t){const e=Ie();p(0,"div",22)(1,"textarea",26),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.editPalette,r)||(o.editPalette=r),D(r)}),m()()}if(2&t){const e=y();h(),We("ngModel",e.editPalette)}}function lne(t,n){1&t&&(p(0,"span"),x(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6"),m())}function cne(t,n){1&t&&(p(0,"span"),x(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u78ba\u5b9a"),m())}let Hm=(()=>{class t{get palette(){return this.character.chatPalette}get filteredPaletteStrings(){return this.ngZone.run(()=>{this.paletteRenewInterval&&(this.paletteRenewInterval=!1,this.paletteCache=this.character.chatPalette.getPalette().filter(e=>this.filter(e)))}),this.paletteCache}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return rr.diceBotInfos}get chatTab(){return dt.instance.get(this.chatTabidentifier)}get myPeer(){return Ce.myCursor}get otherPeers(){return[Ce.myCursor,...xt.peers.filter(e=>e.isOpen).map(e=>Ce.findByPeerId(e.peerId))].filter(e=>e)}constructor(e,i,r,o){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.ngZone=o,this.character=null,this.paletteCache=[],this.paletteRenewInterval=!0,this.paletteRenewIntervalId=setInterval(()=>{this.paletteRenewInterval=!0},200),this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",U.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){U.unregister(this),clearInterval(this.paletteRenewIntervalId),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=dt.instance.get(e);if(i instanceof cn){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}moveToInput(e){this.chatPletteElementRef.nativeElement&&this.chatPletteElementRef.nativeElement.selectedIndex<=0&&(this.text=this._tempText,this.chatInputComponent.textAreaElementRef.nativeElement.value=this._tempText,this.chatInputComponent.textAreaElementRef.nativeElement.focus(),e.preventDefault())}arrowPalette(){this.chatPletteElementRef.nativeElement&&(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.selectedPaletteIndex>=0&&this.chatPletteElementRef.nativeElement.options[this.selectedPaletteIndex]&&this.ngZone.run(()=>{this.text=this.palette.evaluate(this.chatPletteElementRef.nativeElement.options[this.selectedPaletteIndex].value,this.character.rootDataElement),this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text}))}enterPalette(e,i=null){this.chatPletteElementRef.nativeElement&&(this.text=this.palette.evaluate(e,this.character.rootDataElement),this.chatInputComponent.focusInput(),i&&i.preventDefault())}moveToPalette(e){this._tempText=e,this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.options.length<=0||(this.chatPletteElementRef.nativeElement.selectedIndex<=0&&(this.chatPletteElementRef.nativeElement.options[0].selected=!0),this.chatPletteElementRef.nativeElement.focus()))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){this.chatPletteElementRef.nativeElement&&(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){if(null==this.filterText||""==this.filterText.trim())return!0;const i=_e.toHalfWidth(this.filterText.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96))).replace(/[\r\n\s]+/," ").toUpperCase().trim();return _e.toHalfWidth(e.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96))).replace(/[\r\n\s]+/," ").toUpperCase().trim().indexOf(i)>=0||_e.toHalfWidth(/[{\uff5b]/.test(e)?this.palette.evaluate(e,this.character.rootDataElement).replace(/[\u2015\u30fc\u2014\u2010]/g,"-").replace(/[\u3041-\u3096]/g,s=>String.fromCharCode(s.charCodeAt(0)+96)):e).replace(/[\r\n\s]+/," ").toUpperCase().trim().indexOf(i)>=0}helpChatPallet(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(gp,{left:e.x,top:e.y,width:560,height:620});r.title="\u30c1\u30e3\u30c3\u30c8\u8a18\u6cd5\u3068\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u4f7f\u3044\u65b9",r.shadowing="\u{1f4ad}",r.text=["\u3000\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u306f\u5168\u89d2\u3068\u534a\u89d2\u3092\u533a\u5225\u3057\u307e\u305b\u3093\u3001\u307e\u305f\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3084\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u540d\u524d\u306f\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u3068\u5c0f\u6587\u5b57\u3092\u533a\u5225\u3057\u307e\u305b\u3093\u3002\u4e0b\u8a18\u3092\u4f75\u7528\u3059\u308b\u5834\u5408\u3001\u30b9\u30da\u30fc\u30b9\u3067\u533a\u5207\u3063\u3066\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3001\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306e\u9806\u306b\u8a18\u8ff0\u3057\u307e\u3059\u3001\u305d\u308c\u305e\u308c\u7701\u7565\u304c\u53ef\u80fd\u3067\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u5185\u5bb9\u3092\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306b\u6e96\u5099\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u5404\u884c\u306b\u4e00\u3064\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u3001\u884c\u3092\u30b7\u30f3\u30b0\u30eb\u30af\u30ea\u30c3\u30af\u3067\u30c1\u30e3\u30c3\u30c8\u6b04\u306b\u547c\u3073\u51fa\u3057\u3001\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9001\u4fe1\u3057\u307e\u3059\u3002\n\n\u30fb\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\n\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u306e\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u3001\u5148\u982d\u306b : \u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u3001\u64cd\u4f5c\uff08\u5897\u52a0 + \u3001\u6e1b\u5c11 -\u3001\u4ee3\u5165 =\uff09\u3001\u64cd\u4f5c\u5185\u5bb9\u306e\u9806\u306b\u8a18\u8ff0\u3057\u3066\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\u64cd\u4f5c\u5185\u5bb9\u306b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u8a18\u8f09\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3067\u64cd\u4f5c\u3092\u884c\u3046\u3053\u3068\u304c\u3067\u304d\u307e\u3059\uff08\u30ea\u30bd\u30fc\u30b9\u3084\u6570\u5024\u3001\u80fd\u529b\u5024\u3092\u64cd\u4f5c\u3059\u308b\u5834\u5408\u3001\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\uff09\u3002\n\u3000\u307e\u305f\u3001\u64cd\u4f5c\u3068\u3057\u3066 > \u3092\u4f7f\u7528\u3059\u308c\u3070\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\uff08\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3092\u884c\u308f\u305a\uff09\u76f4\u63a5\u30d1\u30e9\u30e1\u30fc\u30bf\u306b\u4ee3\u5165\u3067\u304d\u307e\u3059\uff08\u73fe\u72b6 name\u3001size\u3001height\u3001altitude \u306f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\uff09\u3002\u3055\u3089\u306b : \u3067\u533a\u5207\u3063\u3066\u8907\u6570\u306e\u64cd\u4f5c\u3092\u8a18\u8ff0\u3067\u304d\u307e\u3059\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306f\u30c1\u30e3\u30c3\u30c8\u306b\u8868\u793a\u3055\u308c\u307e\u305b\u3093\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000:HP+2d6:MP-4\u3000 HP\u30922d6\u56de\u5fa9\u3057\u3001MP\u30924\u70b9\u6d88\u8cbb\u3057\u307e\u3059\u3002\n\u3000:\u6d78\u98df\u7387+1D10\u3000 \u767b\u5834\uff01\n\n\u30ea\u30bd\u30fc\u30b9\u306e\u64cd\u4f5c\u306f\u6700\u5927\u5024\u304c\u9069\u7528\u3055\u308c\u307e\u3059\u3001\u30b3\u30de\u30f3\u30c9\u306b\u3088\u308b\u64cd\u4f5c\u3067\u306f\u6700\u5927\u5024\u3092\u8d85\u3048\u305a\u3001\u3059\u3067\u306b\u6700\u5927\u5024\u3092\u8d85\u3048\u3066\u3044\u308c\u3070\u305d\u308c\u4ee5\u4e0a\u5897\u52a0\u3057\u307e\u305b\u3093\u3002\n\n\u3000\u30c1\u30a7\u30c3\u30af\u30dc\u30c3\u30af\u30b9\u306f\u64cd\u4f5c\u304c + \u306e\u5834\u5408\u306f\u64cd\u4f5c\u5185\u5bb9\u306b\u95a2\u308f\u3089\u305a\u30aa\u30f3\u3001- \u306e\u5834\u5408\u306f\u30aa\u30d5\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u7a7a\u6587\u5b57\u30010\u3001off\u3001\u2610\uff08\u7a7a\u306e\u30c1\u30a7\u30c3\u30af\u30dc\u30c3\u30af\u30b9\uff09\u3092\u4ee3\u5165\uff08 = \u307e\u305f\u306f > \uff09\u3057\u305f\u5834\u5408\u30aa\u30d5\u3001\u305d\u308c\u4ee5\u5916\u306e\u4ee3\u5165\u306f\u30aa\u30f3\u306b\u306a\u308a\u307e\u3059\u3001\u3055\u3089\u306b\u6210\u529f/\u5931\u6557\u3092\u8fd4\u3059\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3092\u4ee3\u5165\uff08 = \uff09\u3057\u305f\u5834\u5408\u3001\u6210\u529f\u306f\u30aa\u30f3\u3001\u5931\u6557\u306f\u30aa\u30d5\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30fb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u3084\u8868\u306e\u53c2\u7167\u304c\u53ef\u80fd\u3067\u3059\u3002\u5b9f\u969b\u306e\u30b3\u30de\u30f3\u30c9\u306f\u30b2\u30fc\u30e0\u30b7\u30b9\u30c6\u30e0\u3054\u3068\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u306e\u30d8\u30eb\u30d7\u3092\u53c2\u7167\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u307e\u305f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u6a5f\u80fd\u306b\u3088\u308a\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9\u3092\u62e1\u5f35\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u30fb\u30d1\u30e9\u30e1\u30fc\u30bf\u53c2\u7167\n\u3000{ \u3068 } \u3067\u56f2\u3093\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u3092\u8a18\u8f09\u3059\u308b\u3068\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u304b\u3089\u9078\u629e\u3057\u305f\u969b\u3068\u30c1\u30e3\u30c3\u30c8\u3092\u9001\u4fe1\u3057\u305f\u969b\u306b\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u306e\u5185\u5bb9\u306b\u7f6e\u304d\u63db\u3048\u3089\u308c\u307e\u3059\u3002\u307e\u305f\u30d1\u30e9\u30e1\u30fc\u30bf\u540d\u306e\u5148\u982d\u306b $ \u3092\u4ed8\u8a18\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u524d\u8ff0\u306e\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u3092\u9069\u7528\u5f8c\u306e\u5024\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\n\u3000\u3055\u3089\u306b $\u6570\u5024 \u3092\u53c2\u7167\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u306b\u3088\u308b\u5b9f\u969b\u306e\u5909\u5316\u91cf\uff08\u30ea\u30bd\u30fc\u30b9\u3001\u6570\u5024\u3001\u80fd\u529b\u5024\u306e\u307f\u3001\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u7d50\u679c\u3084\u6700\u5927\u5024\u306b\u3088\u308b\u5207\u308a\u6368\u3066\u3092\u8003\u616e\uff09\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u6570\u5024\u306f1\u304b\u3089\u958b\u59cb\u30671\u3067\u30d1\u30e9\u30e1\u30fc\u30bf\u64cd\u4f5c\u30b3\u30de\u30f3\u30c9\u306e\u6700\u521d\u306e\u64cd\u4f5c\u7d50\u679c\u30012\u30672\u756a\u76ee\u306e\u7d50\u679c\u2026\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u30d1\u30e9\u30e1\u30fc\u30bf\u53c2\u7167\u306e\u4f8b\uff09\n\u3000:HP-2d6\u30002d6+{\u7b4b\u529b}+2\u3000 HP{$1}\u3001\u7b4b\u529b\u306b+2\u3057\u3066\u5224\u5b9a\uff08\u73fe\u5728HP {$HP}\uff09\n\n\u30fb\u8ffd\u52a0\u306e\u5024\n\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u884c\u306b //\u540d\u524d=\u5024 \u306e\u5f62\u3067\u8a18\u8ff0\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30d1\u30e9\u30e1\u30fc\u30bf\u540c\u69d8\u306b\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u304b\u3089\u53c2\u7167\u3067\u304d\u308b\u5024\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\uff08\u30b3\u30de\u30f3\u30c9\u3067\u64cd\u4f5c\u306f\u3067\u304d\u307e\u305b\u3093\uff09\u3002\n\n\u8ffd\u52a0\u306e\u5024\u306e\u4f8b\uff09\n\u3000//\u4eca\u306e\u5929\u6c17=\u96e8\n\n\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u3044\u305a\u308c\u304b\u306e\u884c\u306b\u4e0a\u8a18\u306e\u4f8b\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3055\u308c\u3066\u3044\u308c\u3070\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u9001\u4fe1\u3059\u308b\u30b3\u30de\u30f3\u30c9\u3084\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u4e2d\u306e {\u4eca\u306e\u5929\u6c17} \u304c \u96e8 \u306b\u7f6e\u304d\u63db\u308f\u308a\u307e\u3059\u3002\n\n\u30fb\u6539\u884c\u3001\u7a7a\u767d\n\u3000\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u4e2d\u306b \\n \u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u305d\u3053\u3067\u6539\u884c\u3055\u308c\u307e\u3059\uff08n\u306f\u5c0f\u6587\u5b57\u3001\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306f1\u884c\u306b\u4e00\u3064\u306e\u9001\u4fe1\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u3001\u6539\u884c\u3092\u76f4\u63a5\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u3053\u308c\u3092\u5229\u7528\u3057\u3066\u6539\u884c\u3057\u307e\u3059\u3002\n\u3000\\s \uff08s\u304c\u534a\u89d2\uff09\u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u534a\u89d2\u30b9\u30da\u30fc\u30b9\u3001\\\uff53 \uff08\uff53\u304c\u5168\u89d2\uff09\u3068\u8a18\u8ff0\u3057\u305f\u5834\u5408\u5168\u89d2\u30b9\u30da\u30fc\u30b9\u3068\u306a\u308a\u307e\u3059\uff08\u5168\u89d2\u534a\u89d2\u3092\u533a\u5225\u3059\u308b\u4f8b\u5916\u3067\u3059\uff09\u3001\u30b3\u30de\u30f3\u30c9\u4e2d\u306b\u30b9\u30da\u30fc\u30b9\u306f\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u3089\u3053\u3061\u3089\u3092\u5229\u7528\u3057\u307e\u3059\u3002\u4f8b\u5916\u3068\u3057\u3066\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u30b3\u30de\u30f3\u30c9 CHOICE \u306e\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u306e\u8a18\u8ff0\u3067\u306f\u3001\u30b9\u30da\u30fc\u30b9\u3092\u8a18\u8ff0\u3067\u304d\u307e\u3059\u304c\u3001\u305d\u306e\u5834\u5408\u30c1\u30e3\u30c3\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u3092\u8a18\u8ff0\u3067\u304d\u307e\u305b\u3093\uff08\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u306e\u6700\u5f8c\u3082CHOICE\u30b3\u30de\u30f3\u30c9\u306e\u4e00\u90e8\u3068\u307f\u306a\u3055\u308c\u307e\u3059\uff09\u3002\n\n\u30fb\u30eb\u30d3\uff08\u30d5\u30ea\u30ac\u30ca\uff09\n\u3000\u30c1\u30e3\u30c3\u30c8\u5185\u5bb9\u306e\u30d5\u30ea\u30ac\u30ca\u3092\u632f\u308a\u305f\u3044\u90e8\u5206\u306e\u958b\u59cb\u306b | \uff08\u30d1\u30a4\u30d7\uff09\u3001\u7d42\u4e86\u306b \u300a \u3068 \u300b \u3067\u56f2\u3093\u3067\u30d5\u30ea\u30ac\u30ca\u306e\u5185\u5bb9\u3092\u8a18\u8ff0\u3057\u307e\u3059\u3002\n\n\u30eb\u30d3\u306e\u4f8b\uff09\n\u3000\u53d7\u3051\u308b\u304c\u826f\u3044\uff01\uff5c\u7d04\u675f\u3055\u308c\u305f\u52dd\u5229\u306e\u5263\u300a\u30a8\u30af\u30b9\u30ab\u30ea\u30d0\u30fc\u300b\uff01\n\n\u30fb\u{1f4ad}\n\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304b\u3089\u306e\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u3001 \u300c \u3068 \u300d \u3067\u56f2\u3093\u3060\u5185\u5bb9\u3092\u{1f4ad}\u3067\u8868\u793a\u3057\u307e\u3059\u3002"]}static#e=this.\u0275fac=function(i){return new(i||t)(F(Do),F(bi),F(hr),F(Sn))};static#t=this.\u0275cmp=xn({type:t,selectors:[["chat-palette"]],viewQuery:function(i,r){if(1&i&&(Dn(Xte,7),Dn(Kte,5)),2&i){let o;On(o=An())&&(r.chatInputComponent=o.first),On(o=An())&&(r.chatPletteElementRef=o.first)}},inputs:{character:"character"},decls:14,vars:12,consts:[["chatInput",""],["chatPlette",""],[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"moveToPalette","gameTypeChange","sendFromChange","textChange","filterTextChange","chat","onlyCharacters","chatTabidentifier","gameType","sendFrom","text","filterText"],["class","edit-info","style","display: flex",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],[2,"flex-grow","0","padding-left","0px","padding-top","1px"],["type","submit",2,"margin","0px",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info",2,"display","flex"],[2,"width","calc(100% - 1.6em)","text-align","center"],[1,"material-icons",2,"vertical-align","middle","font-size","1.05rem"],[2,"width","1.6em","text-align","right"],[2,"padding","2px 6px","vertical-align","baseline","font-size","x-small","height","1.24rem","cursor","help",3,"click"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"focus","keydown.arrowUp","keyup.arrowUp","keyup.arrowDown","keydown.enter","click"],[3,"value","color","title",4,"ngIf"],[3,"value","title"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModelChange","ngModel"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",2)(1,"div",3)(2,"form")(3,"div",4),L(4,tne,8,10,"label",5),m()(),p(5,"chat-input",6,0),X("moveToPalette",function(a){return O(o),D(r.moveToPalette(a))}),$e("gameTypeChange",function(a){return O(o),Ge(r.gameType,a)||(r.gameType=a),D(a)})("sendFromChange",function(a){return O(o),Ge(r.sendFrom,a)||(r.sendFrom=a),D(a)})("textChange",function(a){return O(o),Ge(r.text,a)||(r.text=a),D(a)})("filterTextChange",function(a){return O(o),Ge(r.filterText,a)||(r.filterText=a),D(a)}),X("chat",function(a){return O(o),D(r.sendChat(a))}),m(),L(7,nne,8,0,"div",7),m(),L(8,sne,4,1,"div",8)(9,ane,2,1,"div",8),p(10,"div",9)(11,"button",10),X("click",function(){return O(o),D(r.toggleEditMode())}),L(12,lne,2,0,"span",11)(13,cne,2,0,"span",11),m()()()}2&i&&(h(4),_("ngForOf",r.chatMessageService.chatTabs),h(),_("onlyCharacters",!0)("chatTabidentifier",r.chatTabidentifier),We("gameType",r.gameType)("sendFrom",r.sendFrom)("text",r.text)("filterText",r.filterText),h(2),_("ngIf",r.isEdit),h(),_("ngIf",!r.isEdit),h(),_("ngIf",r.isEdit),h(3),_("ngIf",!r.isEdit),h(),_("ngIf",r.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]})}return t})();const une=t=>({transform:t}),dne=t=>({inverse:t}),hne=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),fne=(t,n)=>({"black-paint":t,hollow:n}),pne=t=>({"disabled-text":t}),gne=t=>({"current-icon":t});function mne(t,n){if(1&t&&(p(0,"div",11),x(1),m()),2&t){const e=y(2);h(),Re(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}function _ne(t,n){if(1&t){const e=Ie();Me(0),p(1,"div")(2,"div",5)(3,"div",6)(4,"div",7)(5,"img",8),It(6,"safe"),X("dblclick",function(){return O(e),D(y().openModal())}),m()()()(),p(7,"button",9),X("click",function(){return O(e),D(y().openModal())}),p(8,"b"),x(9),m()(),L(10,mne,2,1,"div",10),m(),De()}if(2&t){const e=y();h(2),_("ngStyle",Be(10,une,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),h(),_("ngClass",Be(12,dne,e.isApplyImageEffect&&e.gameCharacter.isInverse)),h(),_("ngClass",Dc(14,hne,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),h(),_("src",St(6,7,e.standImage.url,"resourceUrl"),gn)("ngClass",Cn(23,fne,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),h(4),Mi("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),h(),_("ngIf",e.isSpeakable)}}function bne(t,n){if(1&t){const e=Ie();Me(0),p(1,"span",12)(2,"input",13),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.nameElement.value,r)||(o.nameElement.value=r),D(r)}),m()(),De()}if(2&t){const e=y();h(2),We("ngModel",e.nameElement.value)}}function vne(t,n){if(1&t){const e=Ie();Me(0),p(1,"b",12),x(2,"\u3000Cond: "),m(),p(3,"select",14),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.conditionTypeElement.value,r)||(o.conditionTypeElement.value=r),D(r)}),p(4,"option",15),x(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),m(),p(6,"option",15),x(7,"\u6307\u5b9a\u753b\u50cf"),m(),p(8,"option",15),x(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),m(),p(10,"option",15),x(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),m(),p(12,"option",15),x(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),m(),p(14,"option",15),x(15,"\u9078\u629e\u6642\u306e\u307f"),m()(),De()}if(2&t){const e=y();h(3),We("ngModel",e.conditionTypeElement.value),h(),ft("value",e.standConditionType.Default),h(2),ft("value",e.standConditionType.Image),h(2),ft("value",e.standConditionType.Postfix),h(2),ft("value",e.standConditionType.PostfixOrImage),h(2),ft("value",e.standConditionType.PostfixAndImage),h(2),ft("value",e.standConditionType.NotConditionStandUp)}}function yne(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",16)(2,"b",17),x(3,"Tag: "),m(),p(4,"input",18),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.nameElement.currentValue,r)||(o.nameElement.currentValue=r),D(r)}),m()(),De()}if(2&t){const e=y();h(4),We("ngModel",e.nameElement.currentValue)}}function Cne(t,n){if(1&t){const e=Ie();Me(0),p(1,"label",19)(2,"input",20),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.showNameElement.value,r)||(o.showNameElement.value=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.showNameElement.value=r.showNameElement.value?"showName":"")}),m(),p(3,"b",12),x(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),m()(),De()}if(2&t){const e=y();h(2),ft("checked",e.showNameElement.value?"checked":""),We("ngModel",e.showNameElement.value)}}function xne(t,n){if(1&t){const e=Ie();Me(0),p(1,"label",19)(2,"input",20),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.applyImageEffectElement.value,r)||(o.applyImageEffectElement.value=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":"")}),m(),p(3,"b",12),x(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),m()(),De()}if(2&t){const e=y();h(2),ft("checked",e.applyImageEffectElement.value?"checked":""),We("ngModel",e.applyImageEffectElement.value)}}function wne(t,n){if(1&t){const e=Ie();Me(0),p(1,"label",19)(2,"input",20),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.applyRollElement.value,r)||(o.applyRollElement.value=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.applyRollElement.value=r.applyRollElement.value?"applyRoll":"")}),m(),p(3,"b",12),x(4,"\u56de\u8ee2\u53cd\u6620"),m()(),De()}if(2&t){const e=y();h(2),ft("checked",e.applyRollElement.value?"checked":""),We("ngModel",e.applyRollElement.value)}}function Ene(t,n){if(1&t){const e=Ie();Me(0),p(1,"label",21)(2,"input",20),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.applyDialogElement.value,r)||(o.applyDialogElement.value=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":"")}),m(),p(3,"b",22),x(4,"\u{1f4ad}"),m()(),De()}if(2&t){const e=y();h(2),ft("checked",e.applyDialogElement.value?"checked":""),We("ngModel",e.applyDialogElement.value)}}function Tne(t,n){if(1&t){const e=Ie();Me(0),Ne(1,"br"),p(2,"button",23),X("click",function(){return O(e),D(y().testStandUp())}),p(3,"b"),x(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),p(5,"sup",24),x(6,"*"),m()()(),p(7,"label",25)(8,"input",20),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.positionElement.currentValue,r)||(o.positionElement.currentValue=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":"")}),m(),p(9,"b",12),x(10,"Pos\u500b\u5225\u6307\u5b9a: "),m()(),p(11,"span",26)(12,"input",27),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.positionElement.value,r)||(o.positionElement.value=r),D(r)}),m(),p(13,"input",28),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.positionElement.value,r)||(o.positionElement.value=r),D(r)}),m(),p(14,"b",29),x(15,"%"),m()(),De()}if(2&t){const e=y();h(8),ft("checked",e.positionElement.currentValue?"checked":""),We("ngModel",e.positionElement.currentValue),h(4),_("title",e.positionElement.value+"%"),We("ngModel",e.positionElement.value),_("disabled",!e.positionElement.currentValue),h(),We("ngModel",e.positionElement.value),_("disabled",!e.positionElement.currentValue),h(),_("ngClass",Be(8,pne,!e.positionElement.currentValue))}}function Ine(t,n){if(1&t){const e=Ie();Me(0),Ne(1,"br"),p(2,"div",30)(3,"b",31),x(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),m(),p(5,"input",32),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.heightElement.value,r)||(o.heightElement.value=r),D(r)}),m(),p(6,"input",33),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.heightElement.value,r)||(o.heightElement.value=r),D(r)}),m(),p(7,"b",34),x(8,"%"),m()(),p(9,"div",35)(10,"b",31),x(11,"AdjY: "),m(),p(12,"input",36),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.heightElement.currentValue,r)||(o.heightElement.currentValue=r),D(r)}),m(),p(13,"b",34),x(14,"%"),m()(),De()}if(2&t){const e=y();h(5),_("title",e.heightElement.value?e.heightElement.value+"%":"\u6307\u5b9a\u306a\u3057"),We("ngModel",e.heightElement.value),h(),We("ngModel",e.heightElement.value),h(6),We("ngModel",e.heightElement.currentValue)}}function Sne(t,n){if(1&t){const e=Ie();p(0,"div")(1,"textarea",37),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.postfixElement.value,r)||(o.postfixElement.value=r),D(r)}),m()()}if(2&t){const e=y();h(),We("ngModel",e.postfixElement.value)}}function Mne(t,n){if(1&t){const e=Ie();p(0,"span",42)(1,"img",43),It(2,"safe"),X("click",function(){O(e);const r=y().$implicit;return D(y(3).selectImage(r.identifier))}),m()()}if(2&t){const e=y().$implicit,i=y(3);_("ngClass",Be(6,gne,i.isSelectedImage(e.identifier))),h(),_("src",St(2,3,e.url,"resourceUrl"),gn)("alt",e.name)}}function Dne(t,n){if(1&t&&(Me(0),L(1,Mne,3,8,"span",41),De()),2&t){const e=n.$implicit;h(),_("ngIf",0<e.url.length)}}function One(t,n){if(1&t&&(p(0,"div",39),L(1,Dne,2,1,"ng-container",40),m()),2&t){const e=y(2);h(),_("ngForOf",e.imageList)}}function Ane(t,n){1&t&&(p(0,"div")(1,"b",44),x(2,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),m()())}function kne(t,n){if(1&t&&(p(0,"div"),L(1,One,2,1,"div",38)(2,Ane,3,0,"div",2),m()),2&t){const e=y();h(),_("ngIf",e.imageList&&e.imageList.length>0),h(),_("ngIf",!e.imageList||0==e.imageList.length)}}let FL=(()=>{class t{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=_n.Empty,this.standConditionType=To}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(ht.create("speakingImageIdentifier",_n.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==_n.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=Yt.instance.get(e.value);this._imageFile=i||_n.Empty}}else{let i=_n.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=Yt.instance.add(i),this.standElement.appendChild(ht.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(ht.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(ht.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(ht.create("conditionType",To.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(ht.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(ht.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(ht.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(ht.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(ht.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(ht.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==_n.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],o=this.standElement.getFirstElementByName(e);o?r=[o.value+""]:o=this.standElement.appendChild(ht.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(Ou,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{s&&(o.value=s)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){this.standElement&&this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let o=!0;for(let s of this.imageList)if(s.identifier==r.value){o=!1;break}o?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(ht.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+Il.k.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){U.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),U.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}static#e=this.\u0275fac=function(i){return new(i||t)(F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",2,"display","inline",3,"ngClass"],["draggable","false",1,"stand-image",3,"dblclick","src","ngClass"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModelChange","ngModel"],[2,"width","15.5em",3,"ngModelChange","ngModel"],[3,"value"],[2,"display","inline","font-size","smaller"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModelChange","ngModel"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"margin-right","0.2em"],[2,"font-size","smaller","text-shadow","#111 0 0 1px"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModelChange","title","ngModel","disabled"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModelChange","ngModel","disabled"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline","white-space","nowrap","font-size","smaller"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModelChange","title","ngModel"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModelChange","ngModel"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"display","inline","white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModelChange","ngModel"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModelChange","ngModel"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["style","display: block","class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",2,"display","block",3,"ngClass"],["draggable","false","draggable","false",2,"cursor","pointer",3,"click","src","alt"],[2,"font-size","smaller","color","red"]],template:function(i,r){1&i&&(p(0,"div")(1,"div",0)(2,"div",1),L(3,_ne,11,26,"ng-container",2),m(),p(4,"div",3)(5,"div"),L(6,bne,3,1,"ng-container",2)(7,vne,16,7,"ng-container",2)(8,yne,5,1,"ng-container",2),m(),p(9,"div"),L(10,Cne,5,2,"ng-container",2)(11,xne,5,2,"ng-container",2)(12,wne,5,2,"ng-container",2)(13,Ene,5,2,"ng-container",2),p(14,"button",4),X("click",function(){return r.openSpeakingModal()}),x(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),m(),L(16,Tne,16,10,"ng-container",2)(17,Ine,15,4,"ng-container",2),m(),L(18,Sne,2,1,"div",2)(19,kne,3,2,"div",2),m()()()),2&i&&(h(3),_("ngIf",r.standImage),h(3),_("ngIf",r.nameElement),h(),_("ngIf",r.conditionTypeElement),h(),_("ngIf",r.nameElement),h(2),_("ngIf",r.showNameElement),h(),_("ngIf",r.applyImageEffectElement),h(),_("ngIf",r.applyRollElement),h(),_("ngIf",r.applyDialogElement),h(),ke("font-weight",r.isSpeakable?"bolder":"normal"),h(2),_("ngIf",r.positionElement),h(),_("ngIf",r.heightElement),h(),_("ngIf",r.postfixElement&&(r.conditionTypeElement.value==r.standConditionType.Postfix||r.conditionTypeElement.value==r.standConditionType.PostfixOrImage||r.conditionTypeElement.value==r.standConditionType.PostfixAndImage)),h(),_("ngIf",r.conditionTypeElement.value==r.standConditionType.Image||r.conditionTypeElement.value==r.standConditionType.PostfixOrImage||r.conditionTypeElement.value==r.standConditionType.PostfixAndImage))},dependencies:[Fi,nr,ni,Zo,ya,Ca,Rr,Xl,Kl,Wa,wl,Lr,pd,fd,Tr,fr],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]})}return t})();function Pne(t,n){if(1&t){const e=Ie();p(0,"div",18)(1,"div",19)(2,"div",20)(3,"input",21),X("click",function(){const r=O(e).index;return D(y().overviewIndex=r)}),m()(),p(4,"div",22),Ne(5,"stand-element",23,0),m(),p(7,"div",24)(8,"button",25),X("click",function(){const r=O(e),o=r.$implicit,s=r.index;return D(y().delele(o,s))}),x(9,"\xd7"),m(),p(10,"button",26),X("click",function(){const r=O(e).$implicit;return D(y().upStandIndex(r))}),x(11,"\u2191"),m(),p(12,"button",27),X("click",function(){const r=O(e).$implicit;return D(y().downStandIndex(r))}),x(13,"\u2193"),m()()(),Ne(14,"hr"),m()}if(2&t){const e=n.$implicit,i=n.index,r=y();h(),ke("border-color",r.overviewIndex==i?"red":"transparent"),h(2),no("name","",r.panelId,"_overviewIndex"),ft("value",i),_("checked",r.overviewIndex==i),h(2),_("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function Fne(t,n){if(1&t){const e=Ie();p(0,"button",16),X("click",function(){return O(e),D(y().restore())}),x(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),m()}}let ev=(()=>{class t{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const o=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let s of o){if(i[s.value])continue;let a=this.imageElementToFile(s);a&&(i[s.value]=!0,e.push(a))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}set isSortNameList(e){!this.character||!this.character.standList||(this.character.standList.isSortNameList=e)}get isSortNameList(){return!this.character||!this.character.standList||this.character.standList.isSortNameList}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),U.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=Il.k.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),U.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){U.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(Mr,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:or.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=dr.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(gp,{left:e.x,top:e.y,width:600,height:620});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\u307e\u305f\u3001\u4ed6\u306eBCDice\u3092\u5229\u7528\u3059\u308b\u30aa\u30f3\u30e9\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u30c4\u30fc\u30eb\u3068\u306e\u4e92\u63db\u6027\u306e\u305f\u3081\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u4e21\u5074\u306b\u30b9\u30da\u30fc\u30b9\u304c\u5165\u3063\u305f \u201c \uff1e \u201d \u3068 \u201c \u2192 \u201d \u3092\u540c\u5024\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?Yt.instance.get(e.value):null}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(hr),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["app-stand-setting"]],viewQuery:function(i,r){if(1&i&&Dn(FL,5),2&i){let o;On(o=An())&&(r.standElementComponents=o)}},inputs:{character:"character"},decls:31,vars:15,consts:[["standElementComponent",""],[2,"margin-bottom","4px"],[2,"float","right","cursor","help",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModelChange","title","ngModel"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModelChange","ngModel"],["sytle","margin-left: 3px; margin-right: 1em "],[2,"margin-left","1em","white-space","nowrap"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller"],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModelChange","ngModel"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",2,"cursor","pointer",3,"click","name","checked"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"cursor","pointer",3,"click","name","value","checked"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(i,r){1&i&&(p(0,"div",1)(1,"button",2),X("click",function(){return r.helpStandSeteing()}),x(2,"?"),m(),p(3,"div",3)(4,"b"),x(5,"Pos: "),m(),p(6,"input",4),$e("ngModelChange",function(s){return Ge(r.position,s)||(r.position=s),s}),m(),p(7,"input",5),$e("ngModelChange",function(s){return Ge(r.position,s)||(r.position=s),s}),m(),p(8,"b",6),x(9,"\uff05\u3000"),m(),p(10,"label",7)(11,"input",8),$e("ngModelChange",function(s){return Ge(r.isSortNameList,s)||(r.isSortNameList=s),s}),X("change",function(){return r.isSortNameList=!!r.isSortNameList}),m(),p(12,"b",9),x(13,"\u30c1\u30e3\u30c3\u30c8\u5165\u529b\u3067\u540d\u524d\u3092\u30bd\u30fc\u30c8"),m()()(),p(14,"div",3)(15,"b"),x(16,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),m(),p(17,"input",4),$e("ngModelChange",function(s){return Ge(r.height,s)||(r.height=s),s}),m(),p(18,"input",10),$e("ngModelChange",function(s){return Ge(r.height,s)||(r.height=s),s}),m(),p(19,"b",6),x(20,"\uff05"),m()()(),p(21,"div",11)(22,"label",12)(23,"input",13),X("click",function(){return r.overviewIndex=-1}),m(),x(24," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),m()(),Ne(25,"hr"),p(26,"div",14),L(27,Pne,15,9,"div",15),m(),p(28,"button",16),X("click",function(){return r.add()}),x(29,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),m(),L(30,Fne,2,0,"button",17)),2&i&&(h(6),_("title",r.position+"%"),We("ngModel",r.position),h(),We("ngModel",r.position),h(4),ft("checked",r.isSortNameList?"checked":""),We("ngModel",r.isSortNameList),h(6),_("title",r.height?r.height+"%":"\u5143\u753b\u50cf\u306e\u307e\u307e"),We("ngModel",r.height),h(),We("ngModel",r.height),h(3),ke("border-color",-1==r.overviewIndex?"red":"transparent"),h(2),no("name","",r.panelId,"_overviewIndex"),_("checked",-1==r.overviewIndex),h(4),_("ngForOf",r.standElements),h(3),_("ngIf",r.standSettingXML))},styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]})}return t})();class ps{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new ps){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,o=n.x*this.m13+n.y*this.m23+this.m43,s=n.x*this.m14+n.y*this.m24+this.m44,a=i+this.m31,l=r+this.m32,u=o+this.m33,f=s+this.m34;0==s&&(s=1e-4),i/=s,r/=s,o/=s,0==f&&(f=1e-4),a/=f,l/=f,u/=f;let g=u-o;if(0==g)return e.x=i,e.y=r,e.z=o,e.w=o,e;let v=-o/g;return i+=v*(a-i),r+=v*(l-r),e.x=i,e.y=r,e.z=o,e.w=o,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,o=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,s=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),o/=r,s/=r,r<0&&(o-=this.m41,s-=this.m42,o*=1/r,s*=1/r,o+=this.m41,s+=this.m42),e.x=o,e.y=s,e.z=i,e.w=i,e}append(n){return ps.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new ps){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(ps.makePosition(e,ps.MATRIX3D))}static makePerspective(n,e=new ps){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(ps.makePerspective(n,ps.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,o=this.m13,s=this.m14,a=this.m21,l=this.m22,u=this.m23,f=this.m24,g=this.m31,v=this.m32,C=this.m33,E=this.m34,w=this.m41,T=this.m42,M=this.m43,S=this.m44;e[0]=u*E*T-f*C*T+f*v*M-l*E*M-u*v*S+l*C*S,e[1]=s*C*T-o*E*T-s*v*M+r*E*M+o*v*S-r*C*S,e[2]=o*f*T-s*u*T+s*l*M-r*f*M-o*l*S+r*u*S,e[3]=s*u*v-o*f*v-s*l*C+r*f*C+o*l*E-r*u*E;let P=i*e[0]+a*e[1]+g*e[2]+w*e[3];return 0==P?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=f*C*w-u*E*w-f*g*M+a*E*M+u*g*S-a*C*S,e[5]=o*E*w-s*C*w+s*g*M-i*E*M-o*g*S+i*C*S,e[6]=s*u*w-o*f*w-s*a*M+i*f*M+o*a*S-i*u*S,e[7]=o*f*g-s*u*g+s*a*C-i*f*C-o*a*E+i*u*E,e[8]=l*E*w-f*v*w+f*g*T-a*E*T-l*g*S+a*v*S,e[9]=s*v*w-r*E*w-s*g*T+i*E*T+r*g*S-i*v*S,e[10]=r*f*w-s*l*w+s*a*T-i*f*T-r*a*S+i*l*S,e[11]=s*l*g-r*f*g-s*a*v+i*f*v+r*a*E-i*l*E,e[12]=u*v*w-l*C*w-u*g*T+a*C*T+l*g*M-a*v*M,e[13]=r*C*w-o*v*w+o*g*T-i*C*T-r*g*M+i*v*M,e[14]=o*l*w-r*u*w-o*a*T+i*u*T+r*a*M-i*l*M,e[15]=r*u*g-o*l*g+o*a*v-i*u*v-r*a*C+i*l*C,n.setData(e),n.scalar(1/P),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Io.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(ps.MATRIX3D.setCSS(n).flatten()):this.append(ps.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new ps){let o=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,s=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,a=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,l=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,u=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,f=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,g=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,v=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,C=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,E=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,w=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,T=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,M=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,S=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,P=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=o,i.m13=s,i.m14=a,i.m21=l,i.m22=u,i.m23=f,i.m24=g,i.m31=v,i.m32=C,i.m33=E,i.m34=w,i.m41=T,i.m42=M,i.m43=S,i.m44=P,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}static#e=this.MATRIX3D=new ps}class zm{constructor(n){this.matrix=new ps,this.sceneTransform=new ps,this.inverseSceneTransform=new ps,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Io.relation(e.paddingTop,i),this.paddingTop=Io.relation(e.paddingTop,r),this.marginLeft=Io.relation(e.marginLeft,i),this.marginTop=Io.relation(e.marginTop,r),this.borderLeft=Io.relation(e.borderLeft,i),this.borderTop=Io.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let o_x=n,o_y=e,o_z=i,s=new zm(r),a=ps.multiply(this.sceneTransform,s.inverseSceneTransform),l={x:0,y:0,z:0,w:1};return l.x=o_x*a.m11+o_y*a.m21+o_z*a.m31+1*a.m41,l.y=o_x*a.m12+o_y*a.m22+o_z*a.m32+1*a.m42,l.z=o_x*a.m13+o_y*a.m23+o_z*a.m33+1*a.m43,l.w=o_x*a.m14+o_y*a.m24+o_z*a.m34+1*a.m44,s.clear(),this.toBorderBox(l),l}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new ps),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let a=r.transformOrigin?r.transformOrigin.split(" "):[],l=Io.relation(a[0],i.offsetWidth,.5*i.offsetWidth),u=Io.relation(a[1],i.offsetHeight,.5*i.offsetHeight),f=Io.relation(a[2],0,0);e.appendPosition(-l,-u,-f),e.appendCSS(r.transform),e.appendPosition(l,u,f)}let o=this.getPosition(n);e.appendPosition(o.x,o.y,0);let s=0;if(n.parentElement){let a=window.getComputedStyle(n.parentElement);s=Io.parse(a.perspective)}if(n.parentElement&&s){let l=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),u=Io.relation(l[0],i.parentElement.offsetWidth),f=Io.relation(l[1],i.parentElement.offsetHeight);e.appendPosition(-u,-f,0),e.appendPerspective(s),e.appendPosition(u,f,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let Nx=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{(0,Jl.W)(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Sn))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Kh=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new zm(i),o=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertToGlobal(e,i=document.body){let r=new zm(i),o=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:o.x,y:o.y,z:o.z}}convertLocalToLocal(e,i,r){let o=new zm(i),s=o.globalToLocal(e.x,e.y,e.z?e.z:0),a=o.localToLocal(s.x,s.y,0,r);return o.clear(),{x:a.x,y:a.y,z:a.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}static#e=this.\u0275fac=function(i){return new(i||t)(kn(hr))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Vm=(()=>{class t{get tableSelecter(){return Jo.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get ranges(){return this.rangeCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return dt.instance.getObjects(Ce)}constructor(e){this.coordinateService=e,this._emptyTable=new Mo(""),this.locationMap=new Map,this.parentMap=new Map,this.indexMap=new Map,this.characterCache=new Qh(()=>dt.instance.getObjects(cn).filter(i=>i.isVisibleOnTable)),this.cardCache=new Qh(()=>dt.instance.getObjects(Ci).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Qh(()=>dt.instance.getObjects(Gi).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Qh(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.rangeCache=new Qh(()=>dt.instance.getObjects(sr).filter(i=>i.isVisibleOnTable)),this.terrainCache=new Qh(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Qh(()=>dt.instance.getObjects(Ns)),this.diceSymbolCache=new Qh(()=>dt.instance.getObjects(fs)),this.initialize()}initialize(){this.refreshCacheAll(),U.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(Qo.aliasName),void this.refreshCache(hs.aliasName);let i=dt.instance.get(e.data.identifier);i&&i instanceof Sr?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=dr.instance.parseXml(e.data.xmlElement);if(r instanceof Sr){let o=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=o.x-25,r.location.y=o.y-25,r.posZ=o.z,this.placeToTabletop(r),ze.play(pe.piecePut)}else r instanceof Xh?Al.instance.addChatTab(r):r instanceof yd?Nc.instance.addDiceRollTable(r):r instanceof Br&&Lc.instance.addCutIn(r)})}findCache(e){switch(e){case cn.aliasName:return this.characterCache;case Ci.aliasName:return this.cardCache;case Gi.aliasName:return this.cardStackCache;case Qo.aliasName:return this.tableMaskCache;case hs.aliasName:return this.terrainCache;case Ns.aliasName:return this.textNoteCache;case fs.aliasName:return this.diceSymbolCache;case sr.aliasName:return this.rangeCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.rangeCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId||e.isVisibleOnTable&&this.indexMap.get(e.identifier)!==e.index}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId),this.indexMap.set(e.identifier,e.index)}clearMap(){this.locationMap.clear(),this.parentMap.clear(),this.indexMap.clear()}placeToTabletop(e){switch(e.aliasName){case Qo.aliasName:e instanceof Qo&&(e.isLock=!1,e.isPreview=!1);case hs.aliasName:if(e instanceof hs&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;case Ci.aliasName:case Gi.aliasName:case sr.aliasName:case Ns.aliasName:(e instanceof Ci||e instanceof Gi||e instanceof sr||e instanceof Ns)&&(e.isLocked=!1),e instanceof sr&&(e.followingCharctorIdentifier=null);default:e.setLocation("table")}}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Kh))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();class Qh{get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}refresh(){this.needsRefresh=!0}}class gs{static#e=this.layerMap=new Map;get tabletopObject(){return this._tabletopObject}get layerName(){return this._layerName}get colideLayers(){return this._colideLayers}get transformCssOffset(){return this._transformCssOffset}set option(n){this.unregister(),this.synchronizer.unregister(),this._tabletopObject=n.tabletopObject??null,this._layerName=n.layerName??"",this._colideLayers=n.colideLayers??[],this._transformCssOffset=n.transformCssOffset??"",this._layerName.length<1&&this._tabletopObject&&(this._layerName=this._tabletopObject.aliasName),this.register(),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(n){this._posX=n,this.setUpdateBatching()}get posY(){return this._posY}set posY(n){this._posY=n,this.setUpdateBatching()}get posZ(){return this._posZ}set posZ(n){this._posZ=n,this.setUpdateBatching()}get magnitude(){return this.input.magnitude}get isPointerMoved(){return this.input.isPointerMoved}get state(){return this.selectionService.state(this.tabletopObject)}set state(n){this.selectionService.add(this.tabletopObject,n)}get isGridSnap(){return Jo.instance.gridSnap}constructor(n,e,i,r,o,s,a){this.ngZone=n,this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.tabletopService=s,this.selectionService=a,this._layerName="",this._colideLayers=[],this._transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new Qn,this.ondragstart=new Qn,this.ondrag=new Qn,this.ondragend=new Qn,this.onend=new Qn,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=-1,this.width=-1,this.ratio=1,this.isUpdateBatching=!1,this.collidableElements=[],this.input=new bu(this.nativeElement,!1),this.synchronizer=new Id(this,this.selectionService,this.pointerDeviceService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,n=>{n.isSendFromSelf&&(this.input.isGrabbing||this.state!==Hn.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.state=Hn.NONE,this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.isDisable&&this.state!==Hn.NONE&&(this.state=Hn.NONE),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.input.isGrabbing&&this.cancel(),this.unregister(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.findCollidableElements()}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}dispose(){U.unregister(this),this.batchService.remove(this)}onInputStart(n){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||n instanceof MouseEvent&&(0!==n.button||n.ctrlKey||n.shiftKey))return void this.cancel();this.onstart.emit(n),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let e={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},i=this.coordinateService.convertToGlobal(e,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=i.x-this.input.pointer.x,this.pointerOffset2d.y=i.y-this.input.pointer.y,this.pointerOffset2d.z=i.z-this.input.pointer.z,this.pointerStart3d.x=e.x,this.pointerStart3d.y=e.y,this.pointerStart3d.z=e.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1;const r=Jo.instance.viewTable;r.gridClipRect=null,r.gridHeight=this.posZ+.5,this.synchronizer.prepareMove()}onInputMove(n){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();n.cancelable&&n.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let e={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};e.x=Math.min(window.innerWidth-.1,Math.max(e.x,.1)),e.y=Math.min(window.innerHeight-.1,Math.max(e.y,.1));let i=document.elementFromPoint(e.x,e.y);if(null==i)return;let r=this.coordinateService.calcTabletopLocalCoordinate(e,i);if(r.x-=this.width/2,r.y-=this.height/2,this.posX===r.x&&this.posY===r.y&&this.posZ===r.z)return;this.input.isDragging||this.ondragstart.emit(n),this.ondrag.emit(n);let s=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;s<this.ratio&&(this.ratio+=.1*(s-this.ratio));const a=Jo.instance.viewTable;a.gridClipRect=null,a.gridHeight=this.posZ+.5;let l={x:r.x-this.posX,y:r.y-this.posY,z:r.z-this.posZ};this.posX=r.x,this.posY=r.y,this.posZ=r.z,this.synchronizer.updateMove(l)}onInputEnd(n){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(n);let e_x=this.posX,e_y=this.posY,e_z=this.posZ;this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.synchronizer.finishMove({x:this.posX-e_x,y:this.posY-e_y,z:this.posZ-e_z}),this.cancel(),this.onend.emit(n)}onContextMenu(n){if(this.isDisable)return this.cancel();n.cancelable&&n.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let e=this.input.isGrabbing&&n.isTrusted;if(this.cancel(),e){n.stopPropagation();let i=new MouseEvent(n.type,n);this.ngZone.run(()=>this.nativeElement.dispatchEvent(i))}}callSelectedEvent(){this.tabletopObject&&U.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(n=25){this.posX=this.calcSnapNum(this.posX,n),this.posY=this.calcSnapNum(this.posY,n)}calcSnapNum(n,e){return e<=0?n:(n=n<0?n-e/2:n+e/2)-n%e}setPosition(n){this._posX=n.location.x,this._posY=n.location.y,this._posZ=n.posZ,this.updateTransformCss()}setUpdateBatching(){!this.isUpdateBatching&&this.tabletopObject&&(this.isUpdateBatching=!0,this.batchService.add(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.isUpdateBatching=!1})),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(n){let e=n.children;for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&"none"!==getComputedStyle(r).pointerEvents&&this.collidableElements.push(r)}if(this.collidableElements.length<1)for(let i=0;i<e.length;i++){let r=e[i];r instanceof HTMLElement&&this.findNestedCollidableElements(r)}}setPointerEvents(n){let e=n?"auto":"none";this.collidableElements.forEach(i=>i.style.pointerEvents=e)}setAnimatedTransition(n){this.nativeElement.style.transition=n?"transform 132ms linear":""}shouldTransition(n){return n.location.x!==this.posX||n.location.y!==this.posY||n.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let n=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=n}setCollidableLayer(n){let e=n;for(let i of gs.layerMap.keys())e=this.colideLayers.includes(i)?"character"==i?!this.input.isGrabbing||n&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||n:!n,gs.layerMap.get(i).forEach(r=>{r===this||r.input?.isGrabbing||r.setPointerEvents(e)})}register(){let n=gs.layerMap.get(this.layerName)??new Set;n.add(this),gs.layerMap.set(this.layerName,n)}unregister(){let n=gs.layerMap.get(this.layerName);n&&(n.delete(this),n.size<1&&gs.layerMap.delete(this.layerName))}static#t=this.\u0275fac=function(e){return new(e||gs)(F(Sn),F(_r),F(Nx),F(hr),F(Kh),F(Vm),F(sc))};static#n=this.\u0275dir=wn({type:gs,selectors:[["","appMovable",""]],inputs:{option:[ae.None,"movable.option","option"],isDisable:[ae.None,"movable.disable","isDisable"],isInteract:[ae.None,"movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"},features:[mr]})}class Id{static#e=this.objectMap=new Map;get selectedMovables(){let n=new Set;for(let e of this.selection.objects)Id.objectMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e,i){this.movable=n,this.selection=e,this.pointerDevice=i,this.callbackOnPickStart=this.onPickStart.bind(this),this.callbackOnPickObject=this.onPickObject.bind(this),this.callbackOnPickRegion=this.onPickRegion.bind(this),this._isDestroyed=!1,this.latestRectPoints=[]}initialize(){this.register(),this.addEventListeners()}destroy(){this.unregister(),this._isDestroyed=!0,this.removeEventListeners(),this.movable=null}onPickStart(n){null==this.movable.tabletopObject||this.movable.isDisable||(this.movable.state=n.detail.isMagnetic?Hn.MAGNETIC:Hn.SELECTED,this.prepareMove())}onPickObject(n){this.selection.excludeElement!==this.movable.nativeElement&&(this.pointerDevice.isDragging||this.movable.isDisable||(null==this.selection.excludeElement?(this.toggleState(),this.selection.excludeElement=this.movable.nativeElement):this.movable.state=Hn.SELECTED))}onPickRegion(n){if(this.pointerDevice.isDragging||this.movable.isDisable)return;let e=n.detail.x,i=n.detail.y,r=n.detail.width,o=n.detail.height,s=this.movable.nativeElement.getBoundingClientRect();if(s.x<=e+r&&e<=s.x+s.width&&s.y<=i+o&&i<=s.y+s.height){if(null==this.latestDomRect||this.latestDomRect.x!==s.x||this.latestDomRect.y!==s.y||this.latestDomRect.width!==s.width||this.latestDomRect.height!==s.height||this.latestDomRect.top!==s.top||this.latestDomRect.left!==s.left||this.latestDomRect.bottom!==s.bottom||this.latestDomRect.right!==s.right){let v=[{x:0,y:0},{x:this.movable.nativeElement.clientWidth,y:0},{x:this.movable.nativeElement.clientWidth,y:this.movable.nativeElement.clientHeight},{x:0,y:this.movable.nativeElement.clientHeight}],C=new zm(this.movable.nativeElement);this.latestDomRect=s,this.latestRectPoints=v.map(E=>C.localToGlobal(E.x,E.y)),C.clear()}(function Nne(t,n){let e=[...NL(t),...NL(n)];for(let i of e){let r={x:-i.y,y:i.x},o=RL(t,r),s=RL(n,r);if(o.max<s.min||s.max<o.min)return!1}return!0})([{x:e,y:i},{x:e+r,y:i},{x:e+r,y:i+o},{x:e,y:i+o}],this.latestRectPoints)&&(this.movable.state=Hn.SELECTED)}}toggleState(){this.movable.state=this.movable.state===Hn.SELECTED?Hn.NONE:Hn.SELECTED}prepareMove(){if(this.shouldSynchronize())for(let n of this.selectedMovables)n!==this.movable&&(n.isDisable?n.state=Hn.NONE:(n.state=Hn.SELECTED,n.setPointerEvents(!1),n.setAnimatedTransition(!1)))}updateMove(n){if(this.shouldSynchronize()){if(this.movable.state===Hn.MAGNETIC){let e=gs.layerMap.get(this.movable.layerName);if(e)for(let i of e)i!==this.movable&&!i.isDisable&&i.state===Hn.NONE&&(i.width<0&&(i.width=i.nativeElement.clientWidth),i.height<0&&(i.height=i.nativeElement.clientHeight),this.isProximity(i)&&(i.state=Hn.MAGNETIC,i.setPointerEvents(!1),i.setAnimatedTransition(!1)))}for(let e of this.selectedMovables)e!==this.movable&&(e.posX+=n.x,e.posY+=n.y,e.posZ+=n.z,e.state===Hn.MAGNETIC&&(e.posX=.02*(this.movable.posX+(this.movable.width-e.width)/2)+.98*e.posX,e.posY=.02*(this.movable.posY+(this.movable.height-e.height)/2)+.98*e.posY,e.posZ=.02*this.movable.posZ+.98*e.posZ),e.posZ<0&&(e.posZ=0))}else this.movable.isPointerMoved&&this.selection.clear()}finishMove(n){if(!this.shouldSynchronize())return void this.selection.clear();for(let a of this.selectedMovables)a!==this.movable&&(a.posX+=n.x,a.posY+=n.y,a.posZ+=n.z);let e=Array.from(this.selectedMovables).sort((a,l)=>{let u=a.tabletopObject.zindex,f=l.tabletopObject.zindex;return null==u||null==f?0:u-f}).filter(a=>a.state===Hn.MAGNETIC&&a!==this.movable),i=360/e.length,r=360*Math.random(),o=Math.min(Math.max((this.movable.width+this.movable.height)/2,50),75),s_x=this.movable.posX+this.movable.width/2,s_y=this.movable.posY+this.movable.height/2;for(let a of e){if(a===this.movable)continue;r+=i;let l=ji.radians(r);a.posX=s_x+o*Math.sin(l)-a.width/2,a.posY=s_y+o*Math.cos(l)-a.height/2}this.movable.state===Hn.MAGNETIC&&this.selection.size<=1?this.selection.clear():this.refreshState()}shouldSynchronize(){return this.movable.state!==Hn.NONE}refreshState(){for(let n of this.selectedMovables)n.state=Hn.SELECTED,n!==this.movable&&(n.setPointerEvents(!0),n.setAnimatedTransition(!0),n.width=n.height=-1)}isProximity(n,e=this.movable){let i=Math.max(.95*((n.width+e.width)/4+(n.height+e.height)/4),25)**2;return ji.sqrMagnitude({x:n.posX+n.width/2,y:n.posY+n.height/2,z:n.posZ},{x:e.posX+e.width/2,y:e.posY+e.height/2,z:e.posZ})<i}addEventListeners(){this.movable.nativeElement.addEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.addEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.addEventListener("pickregion",this.callbackOnPickRegion)}removeEventListeners(){this.movable.nativeElement.removeEventListener("pickstart",this.callbackOnPickStart),this.movable.nativeElement.removeEventListener("pickobject",this.callbackOnPickObject),this.movable.nativeElement.ownerDocument.removeEventListener("pickregion",this.callbackOnPickRegion)}register(){let n=Id.objectMap.get(this.movable.tabletopObject)??new Set;n.add(this.movable),Id.objectMap.set(this.movable.tabletopObject,n)}unregister(){let n=Id.objectMap.get(this.movable.tabletopObject);n&&(n.delete(this.movable),n.size<1&&Id.objectMap.delete(this.movable.tabletopObject))}static congregate(n,e){let i=e.sort((a,l)=>{let u=a.zindex,f=l.zindex;return null==u||null==f?0:u-f}),r=360/i.length,o=360*Math.random(),s=Math.min(Math.max(9*i.length,5),75);for(let a of i){let l=Id.objectMap.get(a);if(null!=l)for(let u of l){u.setAnimatedTransition(!0),u.stopTransition(),u.width<0&&(u.width=u.nativeElement.clientWidth),u.height<0&&(u.height=u.nativeElement.clientHeight),o+=r;let f=ji.radians(o);u.posX=n.x+s*Math.sin(f)-u.width/2,u.posY=n.y+s*Math.cos(f)-u.height/2,u.posZ=n.z}}}}function NL(t){let n=[];for(let e=0;e<t.length;e++){let i=(e+1)%t.length;n.push({x:t[i].x-t[e].x,y:t[i].y-t[e].y})}return n}function RL(t,n){let e=1/0,i=-1/0;for(let r of t){let o=r.x*n.x+r.y*n.y;e=Math.min(e,o),i=Math.max(i,o)}return{min:e,max:i}}var Hn=function(t){return t[t.NONE=0]="NONE",t[t.SELECTED=1]="SELECTED",t[t.MAGNETIC=2]="MAGNETIC",t}(Hn||{});let sc=(()=>{class t{get size(){return this.selectionMap.size}get objects(){return Array.from(this.selectionMap.keys())}constructor(){this.selectionMap=new Map,this.previus=new Set,this.excludeElement=null,this.isUdpateCssBatching=!1}state(e){return this.selectionMap.get(e)??Hn.NONE}add(e,i=Hn.SELECTED){if(i===Hn.NONE)return this.remove(e);let r=this.objects;this.selectionMap.set(e,i),this.updateHighlight(r)}remove(e){if(!this.selectionMap.has(e))return;let i=this.objects;this.selectionMap.delete(e),this.updateHighlight(i)}clear(){let e=this.objects;this.selectionMap.clear(),this.updateHighlight(e)}congregate(e){Id.congregate(e,this.objects)}updateHighlight(e=[]){e.forEach(i=>this.previus.add(i)),!this.isUdpateCssBatching&&(queueMicrotask(()=>{this.isUdpateCssBatching=!1,this.selectionMap.forEach((r,o)=>this.previus.add(o));let i=Array.from(this.previus);this.previus.clear(),0<i.length&&U.trigger("UPDATE_SELECTION",{changed:i});for(let r of i)U.trigger(`UPDATE_SELECTION/identifier/${r.identifier}`,{changed:i});U.trigger("UPDATE_INVENTORY",null)}),this.isUdpateCssBatching=!0)}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class Sd{get summarySetting(){return Tu.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this._sortStop}set sortStop(n){const e=this._sortStop;this._sortStop=n,e&&!this._sortStop&&this.refresh()}static#e=this._newLineDataElement=function Rne(t){let e=new ht("newLineString_DataElement");return e.name=t,e}("/");get newLineDataElement(){return Sd._newLineDataElement}constructor(){this.tableInventory=new Rx(n=>"table"===n.location.name),this.commonInventory=new Rx(n=>!this.isAnyLocation(n.location.name)),this.privateInventory=new Rx(n=>n.location.name===xt.peerId),this.graveyardInventory=new Rx(n=>"graveyard"===n.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.initialize()}initialize(){U.register(this).on("OPEN_NETWORK",n=>{this.refresh()}).on("CONNECT_PEER",n=>{this.refresh()}).on("DISCONNECT_PEER",n=>{this.refresh()}).on("UPDATE_GAME_OBJECT",n=>{let e=dt.instance.get(n.data.identifier);if(e)if(e instanceof cn){let i=this.locationMap.get(e.identifier);e.location.name!==i&&(this.locationMap.set(e.identifier,e.location.name),this.refresh())}else if(e instanceof ht){if(!this.containsInGameCharacter(e))return;let i=this.tagNameMap.get(e.identifier);(this.dataTags.includes(i)||this.dataTags.includes(e.name))&&e.name!==i&&(this.tagNameMap.set(e.identifier,e.name),this.refreshDataElements()),0<e.children.length&&this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}else e instanceof Tu&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",n=>{this.locationMap.delete(n.data.identifier),this.tagNameMap.delete(n.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",n=>{n.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(n){let e=n.parent,i=cn.aliasName;for(;e;){if(e.aliasName===i)return!0;e=e.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this.sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){U.trigger("UPDATE_INVENTORY",null)}isAnyLocation(n){if("table"===n||n===xt.peerId||"graveyard"===n)return!0;for(let e of xt.peers)if(e.isOpen&&n===e.peerId)return!0;return!1}static#t=this.\u0275fac=function(e){return new(e||Sd)};static#n=this.\u0275prov=Wt({token:Sd,factory:Sd.\u0275fac,providedIn:"root"})}class Rx{get summarySetting(){return Tu.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.detailDataElement)continue;let i=this.dataTags.map(r=>this.newLineString===_e.toHalfWidth(r)?this.newLineDataElement:e.detailDataElement.getFirstElementByNameUnsensitive(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=Sd._newLineDataElement,this._tabletopObjects=[],this._tempSortOrder=new Map,this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=dt.instance.getObjects(cn),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||(n.sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByName("name"),a=o.rootDataElement?.getFirstElementByName("name");if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let l=this.convertToSortableValue(s,r),u=this.convertToSortableValue(a,o);return l<u?-1:l>u?1:0}).sort((r,o)=>{const s=this._tempSortOrder.get(r.identifier),a=this._tempSortOrder.get(o.identifier);return null==s?null==a?0:1:null==a?-1:s==a?0:s-a<0?-1:1}).sort((r,o)=>{let s=r.rootDataElement?.getFirstElementByNameUnsensitive(e),a=o.rootDataElement?.getFirstElementByNameUnsensitive(e);if(!s&&!a)return 0;if(!a)return-1;if(!s)return 1;let l=this.convertToSortableValue(s,r),u=this.convertToSortableValue(a,o);return l<u?i:l>u?-1*i:0}),this._tempSortOrder.clear(),n.forEach((r,o)=>{this._tempSortOrder.set(r.identifier,o)})),n}convertToSortableValue(n,e=null){let i=this.evaluate(n,e),r=_e.toHalfWidth((i+"").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase().trim(),o=+r;return Number.isNaN(o)?r:o}evaluate(n,e=null){let i;if(n.isCheckProperty){let r=n.currentValue.toString().split(/[|\uff5c]/,2);if(r.length<=1)return null==n.value||""==n.value?"":n.currentValue.toString();i=null==n.value||""==n.value?r[1]:r[0]}else i=n.isAbilityScore?n.calcAbilityScore:n.isNumberResource?n.currentValue:n.value;return null!=i&&e instanceof cn&&e.chatPalette&&(i=e.chatPalette.evaluate(i+"",e.rootDataElement)),i}}class Md{static#e=this.LoggingValueMap=new Map;ngAfterViewInit(){let n=this.dataElement;for(;(n=n.parent)&&(n instanceof Ci&&(this.type="\u30ab\u30fc\u30c9"),n instanceof Gi&&(this.type="\u5c71\u672d"),n instanceof fs&&(this.type=n.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),n instanceof cn&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),n instanceof Qo&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),n instanceof hs&&(this.type="\u5730\u5f62"),n instanceof Ns&&(this.type="\u5171\u6709\u30e1\u30e2"),n instanceof sr&&(this.type="\u5c04\u7a0b\u30fb\u7bc4\u56f2"),n.parentIsAssigned&&!n.parentIsUnknown););const e=Md.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.dataElement.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)}),this.dataElement.changeObserver=()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging&&this.doLogging(!1)},0)}}ngOnDestroy(){const n=Md.LoggingValueMap,e=this.dataElement.identifier;n.get(e)&&n.get(e).timerId&&this.doLogging()}doLogging(n=!0){const e=Md.LoggingValueMap,i=this.dataElement.identifier;e.get(i).timerId&&(clearTimeout(e.get(i).timerId),e.get(i).timerId=null);const r=e.get(i).oldValue,o=this.dataElement.loggingValue,s=this.dataElement;if(n&&!this.isDisable&&o!=r){let a=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==s.name?"(\u7121\u540d\u306e\u5909\u6570)":s.name} \u3092\u5909\u66f4`;this.showValue&&(s.isSimpleNumber||s.isNumberResource||s.isAbilityScore)?a+=` ${r} \u2192 ${o}`:s.isCheckProperty&&(a+=` ${o}`),this.chatMessageService.sendOperationLog(a)}e.get(i).oldValue=o}constructor(n,e){this.elementRef=n,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}static#t=this.\u0275fac=function(e){return new(e||Md)(F(_r),F(Do))};static#n=this.\u0275dir=wn({type:Md,selectors:[["","appLogging",""]],inputs:{isDisable:[ae.None,"logging.disable","isDisable"],timeout:[ae.None,"logging.timeout","timeout"],name:[ae.None,"logging.name","name"],dataElement:[ae.None,"logging.dataElement","dataElement"],showValue:[ae.None,"logging.loggingValue","showValue"]}})}const Lne=(t,n,e,i)=>({box:!0,selected:t,"muluti-selected":n,"is-hide-in":e,"is-inventory-no-indicate":i}),Bne=t=>({gameObject:t}),jm=t=>({"is-active":t}),LL=t=>({"is-hide-in":t}),Une=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),Hne=t=>({opacity:t}),zne=(t,n,e,i)=>({inverse:t,hollow:n,"is-hide-in":e,"black-paint":i}),Vne=(t,n)=>({dataElm:t,name:n}),jne=()=>({"background-color":"green"}),Gne=(t,n)=>({"outer-link":t,invalid:n});function Wne(t,n){1&t&&ti(0)}function $ne(t,n){1&t&&ti(0)}function Yne(t,n){if(1&t&&(p(0,"div")(1,"small")(2,"b"),x(3),m(),x(4,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059"),m()()),2&t){const e=y();h(3),Re(e.getTabTitle(e.selectTab))}}function qne(t,n){if(1&t&&(p(0,"div",16),x(1),m()),2&t){const e=y().$implicit;ke("background-color",e.ownerColor),h(),Re(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function Zne(t,n){1&t&&ti(0)}function Xne(t,n){if(1&t){const e=Ie();p(0,"div",13),X("contextmenu",function(r){const o=O(e).$implicit;return D(y().onContextMenu(r,o))})("click",function(r){const o=O(e).$implicit;return D(y().selectGameObject(o,r))})("dblclick",function(r){const o=O(e).$implicit;return D(y().focusGameObject(o,r))}),L(1,qne,2,3,"div",14)(2,Zne,1,0,"ng-container",15),m()}if(2&t){const e=n.$implicit,i=n.index,r=y(),o=rn(13);_("ngClass",yl(5,Lne,r.selectedIdentifier===e.identifier,r.checkSelected(e),e.isHideIn,!e.isInventoryIndicate))("@SlideInOut",i),h(),_("ngIf",e.isHideIn&&null!=e.ownerName),h(),_("ngTemplateOutlet",o)("ngTemplateOutletContext",Be(10,Bne,e))}}function Kne(t,n){if(1&t){const e=Ie();p(0,"div",17)(1,"button",18),X("click",function(){return O(e),D(y().cleanInventory())}),x(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),m()()}if(2&t){const e=y();h(),$t("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function Qne(t,n){if(1&t&&(p(0,"option",19),x(1),m()),2&t){const e=n.$implicit;ft("value",e),h(),Re(e)}}function Jne(t,n){if(1&t){const e=Ie();p(0,"label")(1,"input",23),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.selectTab,r)||(o.selectTab=r),D(r)}),m(),p(2,"div"),x(3),m()()}if(2&t){const e=n.$implicit,i=y(2);h(),ft("value",e),We("ngModel",i.selectTab),h(2),Ih("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function eie(t,n){if(1&t&&(p(0,"form",20)(1,"div",21),L(2,Jne,4,4,"label",22),m()()),2&t){const e=y();h(2),_("ngForOf",e.inventoryTypes)}}function tie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div")(2,"div",24)(3,"b"),x(4,"\u4e26\u3073\u9806: "),m()(),p(5,"input",25),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.sortTag,r)||(o.sortTag=r),D(r)}),m(),p(6,"select",26),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.sortOrder,r)||(o.sortOrder=r),D(r)}),p(7,"option",27),x(8,"\u6607\u9806"),m(),p(9,"option",28),x(10,"\u964d\u9806"),m()()(),p(11,"div",29)(12,"b"),x(13,"\u8868\u793a\u9805\u76ee: "),m()(),p(14,"input",30),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.dataTag,r)||(o.dataTag=r),D(r)}),m(),p(15,"div",17)(16,"button",31),X("click",function(){return O(e),D(y(2).toggleEdit())}),p(17,"i",32),x(18,"settings"),m(),x(19,"\u5b8c\u4e86"),m()(),De()}if(2&t){const e=y(2);h(5),Py("list","",e.panelId,"_suggest"),We("ngModel",e.sortTag),h(),We("ngModel",e.sortOrder),h(8),We("ngModel",e.dataTag)}}function nie(t,n){if(1&t&&(Me(0),p(1,"span"),x(2),m(),De()),2&t){const e=y(3);h(2),Ih("",e.sortTag," (",e.sortOrderName,")")}}function iie(t,n){1&t&&(Me(0),x(1,"-"),De())}function rie(t,n){if(1&t){const e=Ie();p(0,"label",39)(1,"input",40),$e("ngModelChange",function(r){O(e);const o=y(3);return Ge(o.indicateAll,r)||(o.indicateAll=r),D(r)}),m(),p(2,"b"),x(3,"\u3059\u3079\u3066\u8868\u793a"),p(4,"sup",41),x(5,"*"),m()()()}if(2&t){const e=y(3);h(),We("ngModel",e.indicateAll)}}function oie(t,n){if(1&t){const e=Ie();Me(0),p(1,"table",33)(2,"tr")(3,"th",34),x(4,"\u4e26\u3073\u9806:"),m(),p(5,"td",34),L(6,nie,3,2,"ng-container",8)(7,iie,2,0,"ng-container",8),m(),p(8,"td",35)(9,"button",31),X("click",function(){return O(e),D(y(2).toggleEdit())}),p(10,"i",32),x(11,"settings"),m(),x(12,"\u8a2d\u5b9a"),m(),L(13,rie,6,1,"label",36),p(14,"span",37)(15,"small")(16,"kbd",38),x(17,"Ctrl"),m(),x(18,"+\u30af\u30ea\u30c3\u30af\u3067\u8907\u6570\u9078\u629e"),m()()()()(),De()}if(2&t){const e=y(2);h(6),_("ngIf",0<e.sortTag.length),h(),_("ngIf",e.sortTag.length<1),h(6),_("ngIf","table"===e.selectTab)}}function sie(t,n){if(1&t&&L(0,tie,20,5,"ng-container",8)(1,oie,19,3,"ng-container",8),2&t){const e=y();_("ngIf",e.isEdit),h(),_("ngIf",!e.isEdit)}}function aie(t,n){if(1&t&&(p(0,"i",61),Ne(1,"img",62),It(2,"safe"),m()),2&t){const e=y().gameObject;h(),_("src",St(2,1,e.faceIcon.url,"resourceUrl"),gn)}}function lie(t,n){1&t&&(p(0,"i",48),x(1,"emoji_emotions"),m())}function cie(t,n){if(1&t&&(p(0,"i",61),Ne(1,"img",63),It(2,"safe"),m()),2&t){const e=y().gameObject;h(),_("ngStyle",Be(5,Hne,e.isDropShadow?.7:.3))("src",St(2,2,e.shadowImageFile.url,"resourceUrl"),gn)}}function uie(t,n){if(1&t&&(p(0,"i",48),x(1),m()),2&t){const e=y().gameObject;h(),Re(e.isDropShadow?"star_half":"star_border")}}function die(t,n){if(1&t){const e=Ie();p(0,"button",64),X("click",function(r){O(e);const o=y().gameObject;return D(y().onContextMenu(r,o))}),p(1,"i",65),x(2,"settings"),m()()}}function hie(t,n){if(1&t&&(Ne(0,"img",66),It(1,"safe")),2&t){const e=y().gameObject;_("src",St(1,2,e.imageFile.url,"resourceUrl"),gn)("ngClass",yl(5,zne,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function fie(t,n){1&t&&ti(0)}function pie(t,n){if(1&t&&(Me(0),L(1,fie,1,0,"ng-container",15),De()),2&t){const e=n.$implicit,i=y(2).gameObject;y();const r=rn(15);h(),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Vne,e,i.name))}}function gie(t,n){if(1&t&&(p(0,"div"),L(1,pie,2,5,"ng-container",67),m()),2&t){const e=y().gameObject,i=y();h(),_("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}function mie(t,n){if(1&t){const e=Ie();p(0,"div",42)(1,"div",43)(2,"button",44),X("click",function(){const r=O(e).gameObject;return D(r.isUseIconToOverviewImage=!r.isUseIconToOverviewImage)}),L(3,aie,3,4,"i",45)(4,lie,2,0,"ng-template",null,4,Pi),m(),p(6,"span",46),x(7),m(),p(8,"button",47),X("click",function(){const r=O(e).gameObject;return D(r.isShowChatBubble=!r.isShowChatBubble)}),p(9,"i",48),x(10),m()(),p(11,"button",49),X("click",function(){const r=O(e).gameObject;return D(r.isDropShadow=!r.isDropShadow)}),L(12,cie,3,7,"i",45)(13,uie,2,1,"ng-template",null,5,Pi),m(),p(15,"button",50),X("click",function(){const r=O(e).gameObject;return D(r.isNotRide=!r.isNotRide)}),p(16,"i",48),x(17),m()(),p(18,"button",51),X("click",function(){const r=O(e).gameObject;return D(r.isAltitudeIndicate=!r.isAltitudeIndicate)}),p(19,"i",52),x(20,"straighten"),m(),p(21,"span",53),x(22),m()(),p(23,"button",54),X("click",function(){const r=O(e).gameObject;return D(r.isInventoryIndicate=!r.isInventoryIndicate)}),p(24,"i",48),x(25,"all_inbox"),m()(),L(26,die,3,0,"button",55),m(),p(27,"div",56)(28,"div",57)(29,"span",58),L(30,hie,2,10,"img",59),m()(),p(31,"div",60),L(32,gie,2,2,"div",8),m()()()}if(2&t){const e=n.gameObject,i=rn(5),r=rn(14),o=y();h(2),_("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Be(26,jm,e.isUseIconToOverviewImage)),h(),_("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),h(4),Re(e.name),h(),_("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Be(28,jm,e.isShowChatBubble)),h(2),Re(e.isShowChatBubble?"textsms":"speaker_notes_off"),h(),_("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Be(30,jm,e.isDropShadow)),h(),_("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),h(3),_("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Be(32,jm,!e.isNotRide)),h(2),Re(e.isNotRide?"directions_run":"directions_bike"),h(),_("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Be(34,jm,e.isAltitudeIndicate)),h(4),Re(e.altitude),h(),_("disabled",o.selectedIdentifier!==e.identifier)("ngClass",Be(36,jm,e.isInventoryIndicate)),h(3),_("ngIf",o.selectedIdentifier===e.identifier),h(),_("ngClass",Be(38,LL,e.isHideIn)),h(),_("ngClass",Be(40,LL,e.isHideIn)),h(),_("ngClass",Dc(42,Une,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),h(),_("ngIf",e.imageFile.url),h(2),_("ngIf",e.rootDataElement)}}function _ie(t,n){1&t&&(Me(0),Ne(1,"br"),De())}function bie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73)(2,"span"),x(3),m()(),p(4,"div",74)(5,"div",75)(6,"div",76)(7,"div",77),x(8),m(),p(9,"input",78),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m()()()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name;h(3),Re(i.name),h(5),Re(i.value),h(),ft("type",i.value&&i.value==+i.value?"number":"text"),_("logging.name",r)("logging.dataElement",i),We("ngModel",i.value)}}function vie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",79)(2,"div",80)(3,"span"),x(4),m()(),p(5,"input",81),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m()(),p(6,"div",79)(7,"input",82),It(8,"safe"),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name;h(4),Re(i.name),h(),_("logging.name",r)("logging.dataElement",i),We("ngModel",i.currentValue),$t("data-init-value",i.currentValue),h(2),Ds(St(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),ft("title",i.currentValue),ft("max",+i.value?i.value:1e3),_("logging.name",r)("logging.dataElement",i)("ngStyle",ad(17,jne)),We("ngModel",i.currentValue),$t("data-init-value",i.currentValue)}}function yie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73)(2,"span"),x(3),m()(),p(4,"div",74)(5,"div",75)(6,"div",76)(7,"input",83),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),X("change",function(){O(e);const r=y(2).dataElm;return D(r.value=r.value?r.name:"")}),m()()()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name;h(),ke("text-decoration",i.value?"none":"line-through"),h(2),Re(i.name),h(4),ft("checked",i.value?"checked":""),_("logging.name",r)("logging.dataElement",i),We("ngModel",i.value)}}function Cie(t,n){if(1&t&&(p(0,"span",85),x(1),m()),2&t){const e=y(3).dataElm;h(),Mi("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function xie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73)(2,"span"),x(3),m()(),p(4,"div",74)(5,"div",75)(6,"div",76)(7,"div",77),x(8),m(),p(9,"input",78),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m(),L(10,Cie,2,1,"span",84),m()()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name;h(3),Re(i.name),h(5),Re(i.value),h(),ft("type",i.value&&i.value==+i.value?"number":"text"),_("logging.name",r)("logging.dataElement",i),We("ngModel",i.value),h(),_("ngIf",i.currentValue)}}function wie(t,n){1&t&&(p(0,"span",89),x(1,"\u26a0\ufe0f"),m())}function Eie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73),L(2,wie,2,0,"span",86),p(3,"a",87),It(4,"safe"),X("click",function(){O(e);const r=y(2),o=r.dataElm,s=r.name,a=y();return D(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),p(5,"span",88),x(6),m()()(),De()}if(2&t){const e=y(2).dataElm,i=y();h(2),_("ngIf",!i.stringUtil.validUrl(e.value)),h(),_("ngClass",Cn(9,Gne,!i.stringUtil.sameOrigin(e.value)&&i.stringUtil.validUrl(e.value),!i.stringUtil.validUrl(e.value))),$t("title",e.value)("href",St(4,6,i.stringUtil.validUrl(e.value)?e.value:"","url"),gn)("disabled",i.stringUtil.validUrl(e.value)?null:""),h(3),Re(e.name)}}function Tie(t,n){1&t&&ti(0)}function Iie(t,n){1&t&&ti(0)}function Sie(t,n){1&t&&ti(0)}function Mie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73)(2,"span"),x(3),m()(),p(4,"div",74)(5,"div",75)(6,"div",76)(7,"div",77),x(8),m(),p(9,"input",90),$e("ngModelChange",function(r){O(e);const o=y(3).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m()()()(),De()}if(2&t){const e=y(3).dataElm;h(3),Re(e.name),h(5),Re(e.value),h(),ft("type","size"===e.name||"altitude"===e.name?"number":"text"),ft("min","size"===e.name?"0":""),We("ngModel",e.value)}}function Die(t,n){if(1&t&&(Me(0),L(1,Mie,10,5,"ng-container",8),De()),2&t){const e=y(2).dataElm;h(),_("ngIf",0==e.children.length)}}function Oie(t,n){if(1&t&&(p(0,"div",69),Me(1,70),L(2,bie,10,6,"ng-container",71)(3,vie,9,18,"ng-container",71)(4,yie,8,7,"ng-container",71)(5,xie,11,7,"ng-container",71)(6,Eie,7,12,"ng-container",71)(7,Tie,1,0,"ng-container",71)(8,Iie,1,0,"ng-container",71)(9,Sie,1,0,"ng-container",71)(10,Die,2,1,"ng-container",72),De(),m()),2&t){const e=y().dataElm;h(),_("ngSwitch",e.attributes.type),h(),_("ngSwitchCase","simpleNumber"),h(),_("ngSwitchCase","numberResource"),h(),_("ngSwitchCase","checkProperty"),h(),_("ngSwitchCase","abilityScore"),h(),_("ngSwitchCase","url"),h(),_("ngSwitchCase","colors"),h(),_("ngSwitchCase","color"),h(),_("ngSwitchCase","note")}}function Aie(t,n){if(1&t&&L(0,_ie,2,0,"ng-container",8)(1,Oie,11,9,"div",68),2&t){const e=n.dataElm,i=y();_("ngIf",e===i.newLineDataElement),h(),_("ngIf",e&&e!==i.newLineDataElement)}}let kie=(()=>{class t{get selectTab(){return this._selectTab}set selectTab(e){this._selectTab=e,this.selectionService.clear()}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===f3.ASC?"\u6607\u9806":"\u964d\u9806"}get isGMMode(){return!!Ce.myCursor&&Ce.myCursor.isGMMode}selectionState(e){return this.selectionService.state(e)}checkSelected(e){return this.selectionState(e)!==Hn.NONE}checkMagnetic(e){return this.selectionState(e)===Hn.MAGNETIC}get newLineDataElement(){return this.inventoryService.newLineDataElement}constructor(e,i,r,o,s,a,l){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=o,this.pointerDeviceService=s,this.modalService=a,this.selectionService=l,this.inventoryTypes=["table","common","graveyard"],this._selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=_e,this.sortStopTimerId=null}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),U.register(this).on("SELECT_TABLETOP_OBJECT",e=>{dt.instance.get(e.data.identifier)instanceof Sr&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",xt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=xt.peerId)}),this.inventoryTypes=["table","common",xt.peerId,"graveyard"],this.panelId=Il.k.generateUuid()}ngOnDestroy(){U.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case xt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case xt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);const r=e.target;let o;if(r&&"BUTTON"===r.tagName){const l=r.getBoundingClientRect();o={x:window.pageXOffset+l.left+r.clientWidth,y:window.pageYOffset+l.top}}else o=this.pointerDeviceService.pointers[0];let s=[];if(this.checkSelected(i)){let l=()=>this.selectionService.objects.filter(f=>f.aliasName===i.aliasName),u=[];"table"!=this.selectTab&&u.push({name:"\u3059\u3079\u3066\u30c6\u30fc\u30d6\u30eb\u306b\u79fb\u52d5",action:()=>{l().forEach(f=>{U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:f.identifier});let g=cn.isStealthMode;f.setLocation("table"),this.selectionService.remove(f),f.isHideIn&&f.isVisible&&!g&&!Ce.myCursor.isGMMode&&this.modalService.open(Mr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:or.OK,materialIcon:"disabled_visible"})}),ze.play(pe.piecePut),U.call("UPDATE_INVENTORY",!0)}}),"common"!=this.selectTab&&u.push({name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{l().forEach(f=>{f.setLocation("common"),this.selectionService.remove(f)}),ze.play(pe.piecePut),U.call("UPDATE_INVENTORY",!0)}}),("table"===this.selectTab||"common"===this.selectTab||"graveyard"===this.selectTab)&&u.push({name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{l().forEach(f=>{f.setLocation(xt.peerId),this.selectionService.remove(f)}),ze.play(pe.piecePut),U.call("UPDATE_INVENTORY",!0)}}),"graveyard"!=this.selectTab&&u.push({name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{l().forEach(f=>{f.setLocation("graveyard"),this.selectionService.remove(f)}),ze.play(pe.sweep),U.call("UPDATE_INVENTORY",!0)}}),s.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:u}),s.push(At)}"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&U.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),"table"!=i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u3078\u79fb\u52d5",action:()=>{let l=cn.isStealthMode;U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("table"),this.selectionService.remove(i),i.isHideIn&&i.isVisible&&!l&&!Ce.myCursor.isGMMode&&this.modalService.open(Mr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:or.OK,materialIcon:"disabled_visible"}),ze.play(pe.piecePut),U.call("UPDATE_INVENTORY",!0)}}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",ze.play(pe.piecePut),U.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!cn.isStealthMode&&!Ce.myCursor.isGMMode&&this.modalService.open(Mr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:or.OK,materialIcon:"disabled_visible"}),i.owner=xt.peer.userId,ze.play(pe.sweep),U.call("UPDATE_INVENTORY",!0)}}),s.push(At),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((l,u)=>({name:i.currntImageIndex==u?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=u,ze.play(pe.surprise),U.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==u,icon:l,checkBox:"radio"}))}),s.push(At)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"},At].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((l,u)=>({name:`${i.aura==u?"\u25c9":"\u25cb"} ${l}`,action:()=>{i.aura=u,U.trigger("UPDATE_INVENTORY",null)},colorSample:!0,checkBox:"radio"})))},At,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,U.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(At),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&ze.play(pe.sweep))},altitudeHande:i}),s.push(At),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(i)}}),s.push(i.isAllowsChat?{name:"\u2611 \u30c1\u30e3\u30c3\u30c8\u3092\u884c\u3046",action:()=>{i.isAllowsChat=!1,U.trigger("UPDATE_INVENTORY",null)},disabled:"graveyard"===i.location.name,checkBox:"check"}:{name:"\u2610 \u30c1\u30e3\u30c3\u30c8\u3092\u884c\u3046",action:()=>{i.isAllowsChat=!0,U.trigger("UPDATE_INVENTORY",null)},disabled:"graveyard"===i.location.name,checkBox:"check"}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(i)},disabled:!i.isAllowsChat||"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(i)},disabled:!i.isAllowsChat||"graveyard"===i.location.name}),s.push(At),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(l=>{const u=l.value.toString();return{name:l.name?l.name:u,action:()=>{_e.sameOrigin(u)?window.open(u.trim(),"_blank","noopener"):this.modalService.open(xa,{url:u,title:i.name,subTitle:l.name})},disabled:!_e.validUrl(u),error:_e.validUrl(u)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(u)&&!_e.sameOrigin(u)}}),disabled:i.getUrls().length<=0}),s.push(At),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"});let a=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:xt.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(a.find(l=>l.name==i.location.name)||a[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:a.filter((l,u)=>!(i.location.name==l.name||1==u&&!a.map(f=>f.name).includes(i.location.name))).map(l=>({name:`${l.alias}`,action:()=>{let u=cn.isStealthMode;U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(l.name),this.selectionService.remove(i),"table"===l.name&&i.isHideIn&&i.isVisible&&!u&&!Ce.myCursor.isGMMode&&this.modalService.open(Mr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:or.OK,materialIcon:"disabled_visible"}),ze.play("graveyard"==l.name?pe.sweep:pe.piecePut),U.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(At),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),ze.play(pe.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const l=i.clone(),u=l.name.split("_");let f;f=u.length>1&&/\d+/.test(u[u.length-1])?u.slice(0,u.length-1).join("_"):u.join("_");let g=0;for(const v of dt.instance.getObjects(cn)){if(!v.name.startsWith(f))continue;let C=v.name.match(/_(\d+)$/)?+RegExp.$1:0;C>g&&(g=C)}l.name=f+"_"+(g+1),l.update(),ze.play(pe.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(At),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.selectionService.remove(i),this.deleteGameObject(i),ze.play(pe.sweep)}})):(s.push(At),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),this.selectionService.remove(i),i.setLocation("graveyard"),ze.play(pe.sweep)}})),this.contextMenuService.open(o,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(Mr,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${_e.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:or.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);ze.play(pe.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Hm,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e,i=null){e instanceof Sr&&(i&&i instanceof MouseEvent&&i.ctrlKey?(ze.playLocal(pe.selectionStart),this.checkSelected(e)?this.selectionService.remove(e):(U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0}),this.selectionService.add(e))):(U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0}),this.checkSelected(e)||this.selectionService.clear()))}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||i instanceof MouseEvent&&i.ctrlKey||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||U.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x+50*e.size/2,y:e.location.y+50*e.size/2,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(ev,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return _e.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(xa,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}suggestWords(){return["name","size"].concat([...new Set(this.inventoryService.dataTags)].filter(e=>"/"!=e&&"\uff0f"!=e).sort())}static#e=this.\u0275fac=function(i){return new(i||t)(F(io),F(bi),F(Sd),F(Xo),F(hr),F(Ii),F(sc))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-object-inventory"]],decls:16,vars:9,consts:[["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],["altImage",""],["altShadow",""],[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],[1,"object-container",3,"contextmenu","click","dblclick","ngClass"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[3,"value"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"ngModelChange","value","ngModel"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModelChange","ngModel"],[1,"order-control",3,"ngModelChange","ngModel"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModelChange","ngModel"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap","",2,"vertical-align","middle"],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","margin","2px"],[2,"border-radius","3px","border","1px outset #ccc","padding","1px","background-color","#eee"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"click","disabled","ngClass"],["class","face-icon",4,"ngIf","ngIfElse"],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"click","disabled","ngClass"],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"click","disabled","ngClass"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],[1,"material-icons",2,"font-size","1em","pointer-events","none"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"ngModelChange","logging.name","logging.dataElement","type","ngModel"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"ngModelChange","logging.name","logging.dataElement","ngModel"],["appLogging","","type","range","min","0",3,"ngModelChange","logging.name","logging.dataElement","title","max","ngStyle","ngModel"],["appLogging","","type","checkbox",3,"ngModelChange","change","logging.name","logging.dataElement","ngModel","checked"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059",4,"ngIf"],["draggable","false","target","_blank",3,"click","ngClass"],[1,"url-link"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"ngModelChange","type","min","ngModel"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",6),X("input",function(){return O(o),D(r.onInput())}),L(1,Wne,1,0,"ng-container",7)(2,$ne,1,0,"ng-container",7)(3,Yne,5,1,"div",8)(4,Xne,3,12,"div",9)(5,Kne,3,1,"div",10),p(6,"datalist",11),L(7,Qne,2,2,"option",12),m()(),L(8,eie,3,1,"ng-template",null,0,Pi)(10,sie,2,2,"ng-template",null,1,Pi)(12,mie,33,51,"ng-template",null,2,Pi)(14,Aie,2,2,"ng-template",null,3,Pi)}if(2&i){const o=rn(9),s=rn(11);h(),_("ngTemplateOutlet",o),h(),_("ngTemplateOutlet",s),h(),_("ngIf",r.getGameObjects(r.selectTab).length<1),h(),_("ngForOf",r.getGameObjects(r.selectTab))("ngForTrackBy",r.trackByGameObject),h(),_("ngIf","graveyard"===r.selectTab),h(),no("id","",r.panelId,"_suggest"),h(),_("ngForOf",r.suggestWords())}},dependencies:[Fi,nr,ni,ip,Zo,Dh,mm,_b,sp,ya,Ca,Rr,Xl,Kl,Wa,wl,Nh,Lr,op,Tr,hd,Md,fr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%;overflow-x:hidden}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out;pointer-events:none}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}@keyframes _ngcontent-%COMP%_fadeIn{0%{opacity:0}to{opacity:1}}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:inherit}.muluti-selected[_ngcontent-%COMP%]{border-top:2px dotted #666;border-bottom:2px dotted #666;border-right:5px solid hsla(200,100%,75%,.6)}.muluti-selected[_ngcontent-%COMP%]:not(.selected){padding-left:6px;border-left:2px dotted #666}"],data:{animation:[Vn("SlideInOut",[Xt("void => *",[jt("200ms ease",mn([Pe({transform:"translateX(60px)",opacity:0,offset:0}),Pe({transform:"translateX(0px)",opacity:1,offset:1})]))]),Xt("* => void",[jt("200ms ease",mn([Pe({transform:"translateX(0px)",opacity:1,offset:0}),Pe({transform:"translateX(60px)",opacity:0,offset:1})]))])])]},changeDetection:0})}return t})();const Pie=_n.create("./assets/images/skeleton.png");let Gm=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof _n?e:Yt.instance.get(e);return i&&!i.isEmpty?i:Pie}getEmptyOr(e){let i=e instanceof _n?e:Yt.instance.get(e);return i&&!i.isEmpty?i:_n.Empty}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Fie=t=>({"red-eye":t}),g3=t=>({blackout:t}),Nie=t=>({disabled:t}),Rie=t=>({"is-hidden":t});function Lie(t,n){if(1&t&&(p(0,"option",12),x(1),m()),2&t){const e=n.$implicit;ke("color",""==e.name?"gray":""),ft("value",e.identifier),ft("title",e.name),h(),Re(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function Bie(t,n){if(1&t&&(p(0,"span",54)(1,"i",55),x(2),m()()),2&t){const e=y(2);h(),am(e.isShowHideImages?"red-eye":"grow"),h(),Re(e.isShowHideImages?"visibility":"visibility_off")}}function Uie(t,n){if(1&t){const e=Ie();p(0,"div")(1,"button",56),X("click",function(){return O(e),D(y(2).openDistanceViewImageModal())}),x(2,"\u80cc\u666f\u753b\u50cf\uff11\u3092\u8ffd\u52a0"),m()()}if(2&t){const e=y(2);h(),_("disabled",!e.isEditable)}}function Hie(t,n){if(1&t&&(p(0,"span",54)(1,"i",55),x(2),m()()),2&t){const e=y(3);h(),am(e.isShowHideImages?"red-eye":"grow"),h(),Re(e.isShowHideImages?"visibility":"visibility_off")}}function zie(t,n){if(1&t){const e=Ie();p(0,"span",14),X("click",function(){return O(e),D(y(2).openDistanceViewImageModal())}),L(1,Hie,3,3,"span",15),Ne(2,"img",16),It(3,"safe"),m()}if(2&t){const e=y(2);ke("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),h(),_("ngIf",e.getHidden(e.tableDistanceviewImage)),h(),_("ngClass",Be(8,g3,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",St(3,5,e.tableDistanceviewImage.url,"resourceUrl"),gn)}}function Vie(t,n){if(1&t){const e=Ie();p(0,"div")(1,"button",57),X("click",function(){return O(e),D(y(2).openDistanceViewImageModal2())}),x(2,"\u80cc\u666f\u753b\u50cf\uff12\u3092\u8ffd\u52a0"),m()()}if(2&t){const e=y(2);h(),_("disabled",!e.isEditable)}}function jie(t,n){if(1&t&&(p(0,"span",54)(1,"i",55),x(2),m()()),2&t){const e=y(3);h(),am(e.isShowHideImages?"red-eye":"grow"),h(),Re(e.isShowHideImages?"visibility":"visibility_off")}}function Gie(t,n){if(1&t){const e=Ie();p(0,"span",14),X("click",function(){return O(e),D(y(2).openDistanceViewImageModal2())}),L(1,jie,3,3,"span",15),Ne(2,"img",16),It(3,"safe"),m()}if(2&t){const e=y(2);ke("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),h(),_("ngIf",e.getHidden(e.tableDistanceviewImage2)),h(),_("ngClass",Be(8,g3,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage2)))("src",St(3,5,e.tableDistanceviewImage2.url,"resourceUrl"),gn)}}function Wie(t,n){if(1&t&&(p(0,"div",62),x(1),m()),2&t){const e=y(3);h(),Mi("",e.progresPercent,"%")}}function $ie(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",58),X("click",function(){return O(e),D(y(2).save())}),p(2,"div",59)(3,"div",45),x(4,"\u4fdd\u5b58"),m(),L(5,Wie,2,1,"div",60),m()(),p(6,"button",61),X("click",function(){return O(e),D(y(2).delete())}),x(7,"\u524a\u9664"),m(),De()}if(2&t){const e=y(2);h(),_("disabled",e.isSaveing),h(2),_("ngClass",Be(4,Rie,e.isSaveing)),h(2),_("ngIf",e.isSaveing),h(),_("disabled",e.getGameTables().length<=1)}}function Yie(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",63),X("click",function(){return O(e),D(y(2).restore())}),x(2,"\u5143\u306b\u623b\u3059"),m(),De()}}function qie(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",13)(2,"div")(3,"b"),x(4,"\u753b\u50cf"),m(),p(5,"span",14),X("click",function(){return O(e),D(y().openBgImageModal())}),L(6,Bie,3,3,"span",15),Ne(7,"img",16),It(8,"safe"),m()()(),p(9,"div",13)(10,"div")(11,"b"),x(12,"\u80cc\u666f\uff11\uff08\u524d\u9762\uff09"),m(),L(13,Uie,3,1,"div",11)(14,zie,4,10,"span",17),m(),p(15,"div")(16,"b"),x(17,"\u80cc\u666f\uff12\uff08\u80cc\u9762\uff09"),m(),L(18,Vie,3,1,"div",11)(19,Gie,4,10,"span",17),m()(),p(20,"div")(21,"div",18),x(22,"Name\uff1a"),p(23,"input",19),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableName,r)||(o.tableName=r),D(r)}),m()()(),p(24,"div",20)(25,"div",21)(26,"div",22)(27,"div",18),x(28,"Width\uff1a"),m()(),p(29,"div",23)(30,"input",24),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableWidth,r)||(o.tableWidth=r),D(r)}),m()(),p(31,"div",25)(32,"input",26),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableWidth,r)||(o.tableWidth=r),D(r)}),m()()(),p(33,"div",21)(34,"div",22)(35,"div",18),x(36,"Height\uff1a"),m()(),p(37,"div",23)(38,"input",27),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableHeight,r)||(o.tableHeight=r),D(r)}),m()(),p(39,"div",25)(40,"input",26),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableHeight,r)||(o.tableHeight=r),D(r)}),m()()()(),p(41,"div")(42,"div",18),x(43,"\u30b0\u30ea\u30c3\u30c9\uff1a "),p(44,"select",28),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableGridType,r)||(o.tableGridType=r),D(r)}),p(45,"option",29),x(46,"\u306a\u3057"),m(),p(47,"option",30),x(48,"\u30b9\u30af\u30a8\u30a2"),m(),p(49,"option",31),x(50,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),m(),p(51,"option",32),x(52,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),m()()(),p(53,"div",33),x(54,"\u8272\uff1a "),p(55,"select",34),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableGridColor,r)||(o.tableGridColor=r),D(r)}),p(56,"option",35),x(57,"\u9ed2"),m(),p(58,"option",36),x(59,"\u9752"),m(),p(60,"option",37),x(61,"\u7dd1"),m(),p(62,"option",38),x(63,"\u6c34\u8272"),m(),p(64,"option",39),x(65,"\u8d64"),m(),p(66,"option",40),x(67,"\u7d2b"),m(),p(68,"option",41),x(69,"\u9ec4"),m(),p(70,"option",42),x(71,"\u767d"),m()()()(),p(72,"div")(73,"label",43)(74,"input",44),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableGridNumberShow,r)||(o.tableGridNumberShow=r),D(r)}),m(),p(75,"span",45),x(76,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),m()()(),p(77,"div")(78,"div",18),x(79,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),p(80,"select",46),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableDistanceviewFilter,r)||(o.tableDistanceviewFilter=r),D(r)}),p(81,"option",47),x(82,"\u306a\u3057"),m(),p(83,"option",48),x(84,"\u30db\u30ef\u30a4\u30c8"),m(),p(85,"option",49),x(86,"\u30d6\u30e9\u30c3\u30af"),m()()()(),Ne(87,"hr"),p(88,"div")(89,"label",43)(90,"input",50),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableGridShow,r)||(o.tableGridShow=r),D(r)}),m(),x(91," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),p(92,"sup",51),x(93,"*"),m()(),p(94,"label",52)(95,"input",53),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.tableGridSnap,r)||(o.tableGridSnap=r),D(r)}),m(),x(96," \u30b9\u30ca\u30c3\u30d7"),p(97,"sup",51),x(98,"*"),m()(),L(99,$ie,8,6,"ng-container",11)(100,Yie,3,0,"ng-container",11),m(),De()}if(2&t){const e=y();h(5),ke("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),h(),_("ngIf",e.getHidden(e.tableBackgroundImage)),h(),_("ngClass",Be(47,g3,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",St(8,44,e.tableBackgroundImage.url,"resourceUrl"),gn),h(6),_("ngIf",!e.tableDistanceviewImage.url),h(),_("ngIf",e.tableDistanceviewImage.url),h(4),_("ngIf",!e.tableDistanceviewImage2.url),h(),_("ngIf",e.tableDistanceviewImage2.url),h(4),We("ngModel",e.tableName),_("disabled",!e.isEditable),h(7),ft("title",e.tableWidth),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.tableWidth),_("disabled",!e.isEditable),h(2),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.tableWidth),_("disabled",!e.isEditable),h(6),ft("title",e.tableHeight),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.tableHeight),_("disabled",!e.isEditable),h(2),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.tableHeight),_("disabled",!e.isEditable),h(4),We("ngModel",e.tableGridType),_("disabled",!e.isEditable),h(11),We("ngModel",e.tableGridColor),_("disabled",!e.isEditable||-1==e.tableGridType),h(19),We("ngModel",e.tableGridNumberShow),_("disabled",!e.isEditable||-1==e.tableGridType),h(),ke("cursor",e.isEditable&&-1!=e.tableGridType?"pointer":"default"),_("ngClass",Be(49,Nie,!e.isEditable||-1==e.tableGridType)),h(5),We("ngModel",e.tableDistanceviewFilter),_("disabled",!e.isEditable),h(10),We("ngModel",e.tableGridShow),h(5),We("ngModel",e.tableGridSnap),h(4),_("ngIf",!e.isDeleted),h(),_("ngIf",e.isDeleted)}}function Zie(t,n){1&t&&(Me(0),p(1,"div",64),x(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),m(),De())}let BL=(()=>{class t{get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableDistanceviewImage2(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier2:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,e&&(this.tableSelecter.viewTable.gridClipRect=null),U.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,U.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return Jo.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==dt.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o,s,a){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=o,this.panelService=s,this.chatMessageService=a,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,U.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=dt.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngOnDestroy(){U.unregister(this)}selectGameTable(e){U.call("SELECT_GAME_TABLE",{identifier:e},xt.peerId),this.selectedTable=dt.instance.get(e),this.selectedTableXml=""}getGameTables(){return dt.instance.getObjects(Mo)}createGameTable(){let e=new Mo;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,R.A)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=dr.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=li.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(Ou,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(Ou,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}openDistanceViewImageModal2(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier2&&(e=[this.selectedTable.backgroundImageIdentifier2]),this.modalService.open(Ou,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier2=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Mr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}static#e=this.\u0275fac=function(i){return new(i||t)(F(io),F(Ii),F(kl),F(Gm),F(bi),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-table-setting"]],decls:16,vars:9,consts:[["select",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","19",2,"width","100%","max-width","155px",3,"change","ngModel"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"display","block","position","relative","overflow","hidden",3,"click"],["style","display: block; position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120","draggable","false",3,"ngClass","src"],["style","display: block; position: relative; overflow: hidden",3,"cursor","click",4,"ngIf"],[1,"self-setting",2,"display","inline"],["placeholder","Name",3,"ngModelChange","ngModel","disabled"],[2,"display","table","width","90%"],[2,"display","table-row"],[2,"display","table-cell","width","4em"],[2,"display","table-cell"],["type","range","name","tableWidth",2,"width","calc(100% - 4px)",3,"ngModelChange","ngModel","title","min","max","disabled"],[2,"display","table-cell","width","5em"],["type","number",2,"width","5em",3,"ngModelChange","ngModel","min","max","disabled"],["type","range","name","tableHeight",2,"width","calc(100% - 4px)",3,"ngModelChange","ngModel","title","min","max","disabled"],["name","tableGridType",3,"ngModelChange","ngModel","disabled"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"display","inline","margin-left","1.2em"],["name","tableGridColor",3,"ngModelChange","ngModel","disabled"],["value","#000000e6"],["value","#0000dde6"],["value","#00dd00e6"],["value","#00dddde6"],["value","#dd0000e6"],["value","#dd00dde6"],["value","#dddd00e6"],["value","#dddddde6"],[1,"self-setting"],["type","checkbox","name","tableGridNumberShow",3,"ngModelChange","ngModel","disabled"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModelChange","ngModel","disabled"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModelChange","ngModel"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModelChange","ngModel"],[2,"display","block","position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px","margin","0px 1px 2px 0px",3,"click","disabled"],[2,"height","120px","margin","0px 0px 2px 0px",3,"click","disabled"],[2,"margin-left","2em",3,"click","disabled"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"click","disabled"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),X("click",function(){return O(o),D(r.createGameTable())}),x(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),m()(),p(5,"select",4,0),X("change",function(){O(o);const a=rn(6);return D(r.selectGameTable(a.value))}),L(7,Lie,2,5,"option",5),m()(),p(8,"div",6)(9,"div",7)(10,"label",8)(11,"input",9),X("click",function(a){return O(o),D(r.onShowHiddenImages(a))}),m(),p(12,"i",10),x(13),m()()(),L(14,qie,101,51,"ng-container",11),m()(),L(15,Zie,3,0,"ng-container",11)}2&i&&(h(5),_("ngModel",null==r.selectedTable?null:r.selectedTable.identifier),h(2),_("ngForOf",r.getGameTables()),h(4),ft("checked",r.isShowHideImages?"checked":""),h(),_("ngClass",Be(7,Fie,r.isShowHideImages)),h(),Re(r.isShowHideImages?"visibility":"visibility_off"),h(),_("ngIf",!r.isEmpty||r.selectedTable),h(),_("ngIf",r.isEmpty))},dependencies:[Fi,nr,ni,ya,Ca,Rr,Xl,Kl,Wa,wl,Lr,pd,fd,Tr,fr],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]})}return t})();const Xie=t=>({last:t});function Kie(t,n){if(1&t){const e=Ie();p(0,"button",33),X("click",function(){O(e);const r=y().$implicit;return D(y().play(r))}),p(1,"i",34),x(2,"play_arrow"),m(),x(3,"\u8a66\u8074"),p(4,"sup",27),x(5,"*"),m()()}2&t&&_("disabled",!y().$implicit.isReady)}function Qie(t,n){if(1&t){const e=Ie();p(0,"button",33),X("click",function(){return O(e),D(y(2).stop())}),p(1,"i",34),x(2,"stop"),m(),x(3,"\u8a66\u8074"),p(4,"sup",27),x(5,"*"),m()()}2&t&&_("disabled",!y().$implicit.isReady)}function Jie(t,n){if(1&t){const e=Ie();p(0,"button",33),X("click",function(){O(e);const r=y().$implicit;return D(y().playBGM(r))}),p(1,"i",34),x(2,"loop"),m(),x(3,"\uff22\uff27\uff2d"),m()}2&t&&_("disabled",!y().$implicit.isReady)}function ere(t,n){if(1&t){const e=Ie();p(0,"button",33),X("click",function(){O(e);const r=y().$implicit;return D(y().stopBGM(r))}),p(1,"i",34),x(2,"stop"),m(),x(3,"\uff22\uff27\uff2d"),m()}2&t&&_("disabled",!y().$implicit.isReady)}function tre(t,n){1&t&&(p(0,"span",32)(1,"b"),x(2,"\u3010\u8a66\u8074\u4e2d\u3011"),m()())}function nre(t,n){1&t&&(p(0,"span",32)(1,"i",35),x(2,"volume_up"),m()())}function ire(t,n){1&t&&(p(0,"span",32)(1,"i",35),x(2,"volume_up"),m(),p(3,"b"),x(4,"\u3010\u8a66\u8074\u4e2d\u3011"),m()())}function rre(t,n){if(1&t&&(Me(0),L(1,nre,3,0,"span",30)(2,ire,5,0,"span",30),De()),2&t){const e=y().$implicit,i=y();h(),_("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),h(),_("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}function ore(t,n){if(1&t&&(p(0,"div",28),L(1,Kie,6,1,"button",29)(2,Qie,6,1,"button",29)(3,Jie,4,1,"button",29)(4,ere,4,1,"button",29)(5,tre,3,0,"span",30)(6,rre,3,2,"ng-container",31),p(7,"span",32),x(8),m()()),2&t){const e=n.$implicit,i=n.last,r=y();_("ngClass",Be(10,Xie,i)),h(),_("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),h(),_("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),h(),_("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),h(),_("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),h(),_("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),h(),_("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),h(),ke("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),h(),Re(e.name)}}function sre(t,n){1&t&&(p(0,"div",36)(1,"small")(2,"b"),x(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),m()()())}let are=(()=>{class t{get isMute(){return He.isMute}set isMute(e){He.isMute=e,U.trigger("CHANGE_JUKEBOX_VOLUME",null),e?Kn.setItem(He.MAIN_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Kn.removeItem(He.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get volume(){return He.volume}set volume(e){this.isMute=0==e,He.volume=e,U.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==He.volume?Kn.removeItem(He.MAIN_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Kn.setItem(He.MAIN_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isAuditionMute(){return He.isAuditionMute}set isAuditionMute(e){He.isAuditionMute=e,U.trigger("CHANGE_JUKEBOX_VOLUME",null),e?Kn.setItem(He.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Kn.removeItem(He.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get auditionVolume(){return He.auditionVolume}set auditionVolume(e){this.isAuditionMute=0==e,He.auditionVolume=e,U.trigger("CHANGE_JUKEBOX_VOLUME",null),.5==He.auditionVolume?Kn.removeItem(He.AUDITION_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Kn.setItem(He.AUDITION_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isSoundEffectMute(){return He.isSoundEffectMute}set isSoundEffectMute(e){He.isSoundEffectMute=e,e?Kn.setItem(He.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Kn.removeItem(He.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get soundEffectVolume(){return He.soundEffectVolume}set soundEffectVolume(e){this.isSoundEffectMute=0==e,He.soundEffectVolume=e,.5==He.soundEffectVolume?Kn.removeItem(He.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Kn.setItem(He.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get isNoticeMute(){return He.isNoticeMute}set isNoticeMute(e){He.isNoticeMute=e,e?Kn.setItem(He.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i)):Kn.removeItem(He.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).catch(i=>console.log(i))}get noticeVolume(){return He.noticeVolume}set noticeVolume(e){this.isNoticeMute=0==e,He.noticeVolume=e,.5==He.noticeVolume?Kn.removeItem(He.NOTICE_VOLUME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Kn.setItem(He.NOTICE_VOLUME_LOCAL_STORAGE_KEY,e).catch(i=>console.log(i))}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return dt.instance.get("Jukebox")}get percentVolume(){return Math.floor(100*this.volume)}set percentVolume(e){this.volume=e/100}get percentAuditionVolume(){return Math.floor(100*this.auditionVolume)}set percentAuditionVolume(e){this.auditionVolume=e/100}get percentSoundEffectVolume(){return Math.floor(100*this.soundEffectVolume)}set percentSoundEffectVolume(e){this.soundEffectVolume=e/100}get percentNoticeVolume(){return Math.floor(100*this.noticeVolume)}set percentNoticeVolume(e){this.noticeVolume=e/100}constructor(e,i,r,o){this.modalService=e,this.panelService=i,this.ngZone=r,this.contextMenuService=o,this.auditionPlayer=new He,this.lazyUpdateTimer=null,this.soundTestPlayer=new He,this.noticeTestPlayer=new He,this.soundTestPlayer.volumeType=Rc.SOUND_EFFECT,this.noticeTestPlayer.volumeType=Rc.NOTICE}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Rc.AUDITION,U.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){U.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&wu.instance.load(r),i.value=""}noticeTest(e=pe.puyon){const i=Jt.instance.get(e);i&&i.isReady&&this.noticeTestPlayer.play(i)}soundTest(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+i.clientWidth,y:window.pageYOffset+r.top};this.contextMenuService.open(o,[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30fb\u5730\u5f62",subActions:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u79fb\u52d5\u958b\u59cb",action:()=>{this.playSETest(pe.piecePick)}},{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u7f6e\u304f",action:()=>{this.playSETest(pe.piecePut)}},{name:"\u5730\u5f62\u306e\u79fb\u52d5\u958b\u59cb\uff0f\u7d42\u4e86",action:()=>{this.playSETest(pe.blockPick)}}]},{name:"\u30c0\u30a4\u30b9\u30fb\u30b3\u30a4\u30f3",subActions:[{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u53d6\u308b",action:()=>{this.playSETest(pe.dicePick)}},{name:"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u3092\u7f6e\u304f",action:()=>{this.playSETest(pe.dicePut)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff11",action:()=>{this.playSETest(pe.diceRoll1)}},{name:"\u30c0\u30a4\u30b9\u3092\u632f\u308b\uff12",action:()=>{this.playSETest(pe.diceRoll2)}},{name:"\u30b3\u30a4\u30f3\u30c8\u30b9",action:()=>{this.playSETest(pe.coinToss)}}]},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d",subActions:[{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f\uff0f\u88cf\u8fd4\u3059",action:()=>{this.playSETest(pe.cardDraw)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u53d6\u308b",action:()=>{this.playSETest(pe.cardPick)}},{name:"\u30ab\u30fc\u30c9\u30fb\u5c71\u672d\u3092\u7f6e\u304f",action:()=>{this.playSETest(pe.cardPut)}},{name:"\u5c71\u672d\u3092\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.playSETest(pe.cardShuffle)}}]},{name:"\u305d\u306e\u4ed6",subActions:[{name:"\u56fa\u5b9a\u30fb\u30ed\u30c3\u30af\uff0f\u89e3\u9664",action:()=>{this.playSETest(pe.lock)}},{name:"\u843d\u4e0b\uff0f\u53d6\u308a\u9664\u304f\uff0f\u524a\u9664",action:()=>{this.playSETest(pe.sweep)}},{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u9078\u629e",action:()=>{this.playSETest(pe.selectionStart)}},{name:"\u5909\u8eab\uff01",action:()=>{this.playSETest(pe.surprise)}}]}],"SE\u30c6\u30b9\u30c8")}playSETest(e){const i=Jt.instance.get(e);i&&i.isReady?(U.unregister(this,"UPDATE_AUDIO_RESOURE"),this.isSoundEffectMute||this.soundTestPlayer.play(i)):U.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.playSETest(e)})}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}static#e=this.\u0275fac=function(i){return new(i||t)(F(Ii),F(bi),F(Sn),F(Xo))};static#t=this.\u0275cmp=xn({type:t,selectors:[["app-jukebox"]],decls:118,vars:22,consts:[[2,"margin-bottom","2px","min-height","4em"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[1,"self-only"],[2,"font-size","12px"],[2,"font-size","12px","margin-bottom","8px"],[1,"footer",2,"position","sticky","bottom","0px","padding","2px 0px 0px 3px"],[2,"display","flex"],[2,"flex-basis","auto"],[2,"white-space","nowrap"],[1,"button-mute",3,"click","title"],[1,"material-icons",2,"font-size","22px"],[2,"flex-basis","100%","max-width","250px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModelChange","ngModel","title"],[2,"flex-basis","auto","padding-right","1em"],[2,"white-space","nowrap","padding-left","4px"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","padding-left","3px"],["type","range","min","0","max","1","step","0.01",2,"width","100%",3,"ngModelChange","change","ngModel","title"],["type","number","min","0","max","100","step","1",2,"width","3.2em",3,"change","ngModelChange","ngModel"],[2,"display","flex","justify-content","space-between","padding-bottom","2px"],[2,"font-size","xx-small","font-weight","bolder","margin-right","2em","white-space","nowrap",3,"click"],[1,"self-only",2,"font-size","larger"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"click","disabled"],[1,"material-icons"],[1,"material-icons",2,"font-size","16px","vertical-align","middle"],[2,"padding","1em 0px","text-align","center"]],template:function(i,r){1&i&&(p(0,"div",0),L(1,ore,9,12,"div",1)(2,sre,4,0,"div",2),m(),p(3,"label")(4,"span",3)(5,"span")(6,"i",4),x(7,"playlist_add"),m()(),p(8,"span"),x(9,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),m(),p(10,"span",5),x(11,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),m(),p(12,"input",6),X("change",function(s){return r.handleFileSelect(s)}),m(),p(13,"span",5),Ne(14,"br"),x(15,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),m()()(),p(16,"div",7),x(17,"\u203b "),p(18,"b"),x(19,"\u8a66\u8074"),p(20,"sup",8),x(21,"*"),m()(),x(22,"\u3001"),p(23,"b"),x(24,"SE\u30c6\u30b9\u30c8"),p(25,"sup",8),x(26,"*"),m()(),x(27," \u306f\u81ea\u5206\u306e\u74b0\u5883\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),m(),p(28,"div",9),x(29,"\u203b "),p(30,"b"),x(31,"BGM"),m(),x(32," \u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),m(),p(33,"div",10),x(34,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),m(),p(35,"div",11)(36,"div",12)(37,"div",13)(38,"b",14),x(39,"\u8a66\u8074\u97f3\u91cf"),p(40,"sup",8),x(41,"*"),m(),x(42,"\uff1a"),m()(),p(43,"div",13)(44,"button",15),X("click",function(){return r.isAuditionMute=!r.isAuditionMute}),p(45,"i",16),x(46),m()()(),p(47,"div",17)(48,"input",18),$e("ngModelChange",function(s){return Ge(r.auditionVolume,s)||(r.auditionVolume=s),s}),m()(),p(49,"div",19)(50,"span",20)(51,"input",21),$e("ngModelChange",function(s){return Ge(r.percentAuditionVolume,s)||(r.percentAuditionVolume=s),s}),m(),p(52,"b",22),x(53,"%"),m()()()(),p(54,"div",12)(55,"div",13)(56,"b",14),x(57,"\u518d\u751f\u97f3\u91cf"),p(58,"sup",8),x(59,"*"),m(),x(60,"\uff1a"),m()(),p(61,"div",13)(62,"button",15),X("click",function(){return r.isMute=!r.isMute}),p(63,"i",16),x(64),m()()(),p(65,"div",17)(66,"input",18),$e("ngModelChange",function(s){return Ge(r.volume,s)||(r.volume=s),s}),m()(),p(67,"div",19)(68,"span",20)(69,"input",21),$e("ngModelChange",function(s){return Ge(r.percentVolume,s)||(r.percentVolume=s),s}),m(),p(70,"b",22),x(71,"%"),m()()()(),Ne(72,"hr"),p(73,"div",12)(74,"div",13)(75,"b",14),x(76,"\u901a\u77e5\u97f3\u91cf"),p(77,"sup",8),x(78,"*"),m(),x(79,"\uff1a"),m()(),p(80,"div",13)(81,"button",15),X("click",function(){return r.isNoticeMute=!r.isNoticeMute}),p(82,"i",16),x(83),m()()(),p(84,"div",17)(85,"input",23),$e("ngModelChange",function(s){return Ge(r.noticeVolume,s)||(r.noticeVolume=s),s}),X("change",function(){return r.noticeTest()}),m()(),p(86,"div",19)(87,"span",20)(88,"input",24),X("change",function(){return r.noticeTest()}),$e("ngModelChange",function(s){return Ge(r.percentNoticeVolume,s)||(r.percentNoticeVolume=s),s}),m(),p(89,"b",22),x(90,"%"),m()()()(),p(91,"div",12)(92,"div",13)(93,"b",14),x(94,"\uff33\uff25\u97f3\u91cf"),p(95,"sup",8),x(96,"*"),m(),x(97,"\uff1a"),m()(),p(98,"div",13)(99,"button",15),X("click",function(){return r.isSoundEffectMute=!r.isSoundEffectMute}),p(100,"i",16),x(101),m()()(),p(102,"div",17)(103,"input",18),$e("ngModelChange",function(s){return Ge(r.soundEffectVolume,s)||(r.soundEffectVolume=s),s}),m()(),p(104,"div",19)(105,"span",20)(106,"input",21),$e("ngModelChange",function(s){return Ge(r.percentSoundEffectVolume,s)||(r.percentSoundEffectVolume=s),s}),m(),p(107,"b",22),x(108,"%"),m()()()(),p(109,"div",25)(110,"div")(111,"small"),x(112,"\u203b\u8a2d\u5b9a\u3057\u305f\u97f3\u91cf\u306f\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"),m()(),p(113,"div")(114,"button",26),X("click",function(s){return r.soundTest(s)}),x(115,"\uff33\uff25\u30c6\u30b9\u30c8"),p(116,"sup",27),x(117,"*"),m()()()()()),2&i&&(h(),_("ngForOf",r.audios),h(),_("ngIf",r.audios.length<1),h(42),_("title",r.isAuditionMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Re(r.isAuditionMute?"volume_off":0==r.auditionVolume?"volume_mute":r.auditionVolume<=.5?"volume_down":"volume_up"),h(2),We("ngModel",r.auditionVolume),_("title",r.isAuditionMute?"":r.percentAuditionVolume+"%"),h(3),We("ngModel",r.percentAuditionVolume),h(11),_("title",r.isMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Re(r.isMute?"volume_off":0==r.volume?"volume_mute":r.volume<=.5?"volume_down":"volume_up"),h(2),We("ngModel",r.volume),_("title",r.isMute?"":r.percentVolume+"%"),h(3),We("ngModel",r.percentVolume),h(12),_("title",r.isNoticeMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Re(r.isNoticeMute?"volume_off":0==r.noticeVolume?"volume_mute":r.noticeVolume<=.5?"volume_down":"volume_up"),h(2),We("ngModel",r.noticeVolume),_("title",r.isNoticeMute?"":r.percentNoticeVolume+"%"),h(3),We("ngModel",r.percentNoticeVolume),h(11),_("title",r.isSoundEffectMute?"\u30df\u30e5\u30fc\u30c8\u89e3\u9664":"\u30df\u30e5\u30fc\u30c8"),h(2),Re(r.isSoundEffectMute?"volume_off":0==r.soundEffectVolume?"volume_mute":r.soundEffectVolume<=.5?"volume_down":"volume_up"),h(2),We("ngModel",r.soundEffectVolume),_("title",r.isSoundEffectMute?"":r.percentSoundEffectVolume+"%"),h(3),We("ngModel",r.percentSoundEffectVolume))},dependencies:[Fi,nr,ni,Rr,Xl,Kl,Lr,pd,fd,Tr],styles:['[_nghost-%COMP%]{display:block;height:100%}.drop-zone[_ngcontent-%COMP%]{display:block;-webkit-user-select:none;user-select:none;border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.drop-zone[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.footer[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border-top:dotted 1px #888}.button-mute[_ngcontent-%COMP%]{box-sizing:border-box;width:25px;height:25px;padding:1px;display:inline-block;background-color:transparent;border-color:transparent}.button-mute[_ngcontent-%COMP%]:hover, .button-mute[_ngcontent-%COMP%]:active, .button-mute[_ngcontent-%COMP%]::selection{background-color:#666;border-color:#ccc;color:snow}']})}return t})();const lre=["content"],cre=["*"];let ure=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["modal"]],viewQuery:function(i,r){if(1&i&&Dn(lre,7,ja),2&i){let o;On(o=An())&&(r.content=o.first)}},ngContentSelectors:cre,decls:14,vars:3,consts:[["content",""],[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-text"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"]],template:function(i,r){if(1&i){const o=Ie();vT(),p(0,"div",1)(1,"div",2),X("click",function(a){return O(o),D(r.clickBackground(a))}),m(),p(2,"div",3)(3,"div",4)(4,"div",5),x(5),m(),p(6,"div",6)(7,"button",7),X("click",function(){return O(o),D(r.resolve())}),p(8,"i",8),x(9,"close"),m()()()(),p(10,"div",9),yT(11),Ne(12,"div",null,0),m()()()}2&i&&(h(),_("@bgInOut","in"),h(),_("@flyInOut","in"),h(3),Re(r.modalService.title))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;inset:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;inset:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%;display:flex;flex-direction:column}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;width:100%;background-color:#ccc;color:#444;flex-shrink:0;display:flex}.title-text[_ngcontent-%COMP%]{align-self:center;flex-grow:1;padding:0 5px;text-overflow:ellipsis;overflow:hidden}.title-button[_ngcontent-%COMP%]{align-self:center;flex-shrink:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100% - 41px);width:100%;padding:8px;flex-grow:1}"],data:{animation:[Vn("flyInOut",[Xt("void => *",[jt("100ms ease-out",mn([Pe({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),Pe({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale(0, 0)"}))])]),Vn("bgInOut",[WI("in",Pe({"background-color":"rgba(30, 30, 30, 0.4)"})),Xt("void => *",[Pe({"background-color":"rgba(30, 30, 30, 0.0)"}),jt(200)]),Xt("* => void",[jt(200,Pe({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}})}return t})();var m3=me(6609);const dre=["passwordInput"],hre=()=>({standalone:!0});let fre=(()=>{class t{get peerId(){return xt.peerId}get isConnected(){return 0<xt.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeers=[],this.title="",this.targetPeers=i.option.peers??[],this.title=i.option.title?i.option.title:""}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),U.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){U.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeers.find(e=>e.verifyPassword(this.password))&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["password-check"]],viewQuery:function(i,r){if(1&i&&Dn(dre,7),2&i){let o;On(o=An())&&(r.passwordInputElementRef=o.first)}},decls:13,vars:4,consts:[["passwordForm","ngForm"],["input","","passwordInput",""],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModelChange","input","keypress.enter","ngModel","ngModelOptions"],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ie();p(0,"form",null,0)(2,"div"),x(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),p(4,"input",2,1),$e("ngModelChange",function(a){return O(o),Ge(r.password,a)||(r.password=a),D(a)}),X("input",function(){O(o);const a=rn(5);return D(r.onInputChange(a.value))})("keypress.enter",function(){return O(o),D(r.submit())}),m()(),p(7,"button",3),X("click",function(){return O(o),D(r.submit())}),p(8,"b"),x(9,"\u5165\u5ba4"),m()()(),p(10,"div")(11,"span",4),x(12),m()()}2&i&&(h(4),We("ngModel",r.password),_("ngModelOptions",ad(3,hre)),h(8),Re(r.help))},dependencies:[sp,Rr,Lr,op,Tr,hd],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]})}return t})();function pre(t,n){if(1&t&&(p(0,"div")(1,"div",9),x(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),m(),p(3,"div",9),x(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),m(),p(5,"div",9),x(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),m()()),2&t){y();const e=rn(5);h(),_("hidden",!e.errors.required),h(2),_("hidden",!e.errors.minlength),h(2),_("hidden",!e.errors.maxlength)}}function gre(t,n){if(1&t&&(p(0,"div")(1,"div",9),x(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),m()()),2&t){y();const e=rn(10);h(),_("hidden",!e.errors.maxlength)}}function mre(t,n){1&t&&(p(0,"div"),x(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),m())}function _re(t,n){if(1&t){const e=Ie();p(0,"div")(1,"div"),x(2,"\u30eb\u30fc\u30e0\u540d : "),p(3,"input",5,1),X("input",function(){O(e);const r=rn(4),o=y();return D(o.calcPeerId(r.value,o.password))}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.roomName,r)||(o.roomName=r),D(r)}),m()(),p(6,"div"),x(7,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),p(8,"input",6,2),X("input",function(){O(e);const r=rn(4),o=y();return D(o.calcPeerId(o.roomName,r.value))}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.password,r)||(o.password=r),D(r)}),m()(),Ne(11,"hr"),L(12,pre,7,3,"div",7)(13,gre,3,1,"div",7)(14,mre,2,0,"div",7),p(15,"div")(16,"button",8),X("click",function(){return O(e),D(y().createRoom())}),x(17,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),m()()()}if(2&t){const e=rn(5),i=rn(10),r=y();h(3),We("ngModel",r.roomName),h(5),We("ngModel",r.password),h(4),_("ngIf",e.errors&&(e.dirty||e.touched)),h(),_("ngIf",i.errors&&(i.dirty||i.touched)),h(),_("ngIf",!r.validateLength),h(2),_("disabled",!e.valid||!i.valid||!r.validateLength)}}function bre(t,n){1&t&&(p(0,"span",4),x(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),Ne(2,"br"),x(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ne(4,"br"),x(5,"\uff08\u203b\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u9000\u51fa\uff0f\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),m())}let vre=(()=>{class t{get peerId(){return xt.peerId}get isConnected(){return 0<xt.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),U.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){U.unregister(this)}calcPeerId(e,i){let o=ym.y.create(xt.peer.userId,ym.y.generateId("***"),e,i);this.validateLength=o.peerId.length<64}createRoom(){xt.open(xt.peer.userId,ym.y.generateId("***"),this.roomName,this.password),Ce.myCursor.peerId=xt.peerId,this.modalService.resolve(!0)}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[["other_content",""],["input","","roomNameValidation","ngModel"],["input","","passwordValidation","ngModel"],[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"input","ngModelChange","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"input","ngModelChange","ngModel"],[4,"ngIf"],[3,"click","disabled"],[3,"hidden"]],template:function(i,r){if(1&i&&(L(0,_re,18,6,"div",3),p(1,"div")(2,"span",4),x(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),m()(),L(4,bre,6,0,"ng-template",null,0,Pi)),2&i){const o=rn(5);_("ngIf",!r.isConnected)("ngIfElse",o)}},dependencies:[ni,Rr,Lr,SC,jI,GI,Tr],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]})}return t})();function yre(t,n){1&t&&(p(0,"td")(1,"i",15),x(2,"lock"),m()())}function Cre(t,n){1&t&&(p(0,"td"),x(1,"-"),m())}function xre(t,n){if(1&t){const e=Ie();p(0,"button",16),X("click",function(){O(e);const r=y().$implicit;return D(y(3).connect(r))}),x(1,"\u63a5\u7d9a"),m()}if(2&t){const e=y().$implicit,i=y(3);_("disabled",e.id===i.currentRoom)}}function wre(t,n){if(1&t&&(Me(0),p(1,"tr")(2,"td",11),x(3),m(),p(4,"td",12)(5,"div",13),x(6),m()(),L(7,yre,3,0,"td",5)(8,Cre,2,0,"td",5),p(9,"td"),x(10),m(),p(11,"td"),L(12,xre,2,1,"button",14),m()(),De()),2&t){const e=n.$implicit;h(3),Re(e.id),h(3),Re(e.name),h(),_("ngIf",e.hasPassword),h(),_("ngIf",!e.hasPassword),h(2),Mi("",e.peers.length,"\u4eba"),h(2),_("ngIf",0<e.id.length)}}function Ere(t,n){if(1&t&&(Me(0),p(1,"table",7)(2,"tr")(3,"th",8),x(4,"\u30eb\u30fc\u30e0ID"),m(),p(5,"th",9),x(6,"\u30eb\u30fc\u30e0\u540d"),m(),p(7,"th",8),x(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),m(),p(9,"th",8),x(10,"\u53c2\u52a0\u8005"),m(),Ne(11,"th",8),m(),L(12,wre,13,6,"ng-container",10),m(),De()),2&t){const e=y(2);h(12),_("ngForOf",e.rooms)}}function Tre(t,n){if(1&t&&(p(0,"span",17),x(1),m()),2&t){const e=y(2);h(),Re(e.help)}}function Ire(t,n){if(1&t){const e=Ie();p(0,"div")(1,"button",2),X("click",function(){return O(e),D(y().reload())}),p(2,"i",3),x(3,"refresh"),m(),x(4,"\u4e00\u89a7\u3092\u66f4\u65b0"),m(),p(5,"button",4),X("click",function(){return O(e),D(y().showRoomSetting())}),p(6,"i",3),x(7,"room_preferences"),m(),x(8,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),m(),Ne(9,"hr"),L(10,Ere,13,1,"ng-container",5)(11,Tre,2,1,"span",6),m()}if(2&t){const e=y();h(),_("disabled",e.isReloading),h(9),_("ngIf",e.rooms.length),h(),_("ngIf",e.rooms.length<1)}}function Sre(t,n){1&t&&(p(0,"span",17),x(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),Ne(2,"br"),x(3,"\uff08\u203b\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u9000\u51fa\uff0f\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),m())}let Mre=(()=>{class t{get currentRoom(){return xt.peer.roomId}get peerId(){return xt.peerId}get isConnected(){return 0<xt.peerIds.length}constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),U.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",xt.peer.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+xt.peer.roomName+"/"+xt.peer.roomId+"\u3009")}ngOnDestroy(){U.unregister(this)}reload(){var e=this;return(0,R.A)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=yield xt.listAllRooms(),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,R.A)(function*(){let r="";e.hasPassword&&(r=yield i.modalService.open(fre,{peers:e.peers,title:`${e.name}/${e.id}`}),null==r&&(r=""));let o=e.filterByPassword(r);if(o.length<1)return;xt.open(xt.peer.userId,e.id,e.name,r),Ce.myCursor.peerId=xt.peerId;let a=[],l=()=>!(a.length<o.length||(i.resetNetwork(),U.unregister(a),i.closeIfConnected(),0)),f=g=>(console.warn("\u63a5\u7d9a\u5931\u6557",g),a.push(g),console.warn("\u63a5\u7d9a\u5931\u6557 "+a.length+"/"+o.length),l());U.register(a).on("OPEN_NETWORK",g=>{console.log("LobbyComponent OPEN_PEER",g.data.peerId),U.unregister(a),dt.instance.clearDeleteHistory();for(let v of o)if(!xt.connect(v)&&f(v.peerId))return;U.register(a).on("CONNECT_PEER",v=>(g=>(console.log("\u63a5\u7d9a\u6210\u529f\uff01",g),a.push(g),console.log("\u63a5\u7d9a\u6210\u529f "+a.length+"/"+o.length),l()))(v.data.peerId)).on("DISCONNECT_PEER",v=>f(v.data.peerId))})})()}resetNetwork(){xt.peers.length<1&&(xt.open(),Ce.myCursor.peerId=xt.peerId)}closeIfConnected(){0<xt.peers.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,R.A)(function*(){(yield e.modalService.open(vre,{width:700,height:400,left:0,top:400}))&&e.modalService.resolve(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[["other_content",""],[4,"ngIf","ngIfElse"],[3,"click","disabled"],[1,"material-icons",2,"display","inline-block","margin-right","2px"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"is-0-width","is-small-font"],[1,"is-small-font"],[4,"ngFor","ngForOf"],[1,"room-id"],[1,"room-name"],[1,"room-name-text"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"click","disabled"],[2,"font-size","12px"]],template:function(i,r){if(1&i&&L(0,Ire,12,3,"div",1)(1,Sre,4,0,"ng-template",null,0,Pi),2&i){const o=rn(2);_("ngIf",!r.isConnected)("ngIfElse",o)}},dependencies:[nr,ni],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px 1em;text-align:center}.room-id[_ngcontent-%COMP%]{text-overflow:ellipsis;overflow:hidden}.room-name[_ngcontent-%COMP%]{max-width:0;text-overflow:ellipsis;overflow:hidden;white-space:normal}.room-name-text[_ngcontent-%COMP%]{display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:3;line-clamp:3}.is-small-font[_ngcontent-%COMP%]{font-size:10px}.is-0-width[_ngcontent-%COMP%]{width:0}.material-icons[_ngcontent-%COMP%]{font-size:18px;vertical-align:bottom}"]})}return t})();function UL(t){return typeof t>"u"||null===t}var es={isNothing:UL,isObject:function Dre(t){return"object"==typeof t&&null!==t},toArray:function Ore(t){return Array.isArray(t)?t:UL(t)?[]:[t]},repeat:function kre(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},isNegativeZero:function Pre(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t},extend:function Are(t,n){var e,i,r,o;if(n)for(e=0,i=(o=Object.keys(n)).length;e<i;e+=1)t[r=o[e]]=n[r];return t}};function HL(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function tv(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=HL(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(tv.prototype=Object.create(Error.prototype)).constructor=tv,tv.prototype.toString=function(n){return this.name+": "+HL(this,n)};var Ta=tv;function _3(t,n,e,i,r){var o="",s="",a=Math.floor(r/2)-1;return i-n>a&&(n=i-a+(o=" ... ").length),e-i>a&&(e=i+a-(s=" ...").length),{str:o+t.slice(n,e).replace(/\t/g,"\u2192")+s,pos:i-n+o.length}}function b3(t,n){return es.repeat(" ",n-t.length)+t}var zre=function Hre(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var o,e=/\r?\n|\r|\0/g,i=[0],r=[],s=-1;o=e.exec(t.buffer);)r.push(o.index),i.push(o.index+o[0].length),t.position<=o.index&&s<0&&(s=i.length-2);s<0&&(s=i.length-1);var l,u,a="",f=Math.min(t.line+n.linesAfter,r.length).toString().length,g=n.maxLength-(n.indent+f+3);for(l=1;l<=n.linesBefore&&!(s-l<0);l++)u=_3(t.buffer,i[s-l],r[s-l],t.position-(i[s]-i[s-l]),g),a=es.repeat(" ",n.indent)+b3((t.line-l+1).toString(),f)+" | "+u.str+"\n"+a;for(u=_3(t.buffer,i[s],r[s],t.position,g),a+=es.repeat(" ",n.indent)+b3((t.line+1).toString(),f)+" | "+u.str+"\n",a+=es.repeat("-",n.indent+f+3+u.pos)+"^\n",l=1;l<=n.linesAfter&&!(s+l>=r.length);l++)u=_3(t.buffer,i[s+l],r[s+l],t.position-(i[s]-i[s+l]),g),a+=es.repeat(" ",n.indent)+b3((t.line+l+1).toString(),f)+" | "+u.str+"\n";return a.replace(/\n$/,"")},Vre=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],jre=["scalar","sequence","mapping"],Rs=function Wre(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===Vre.indexOf(e))throw new Ta('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function Gre(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===jre.indexOf(this.kind))throw new Ta('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function zL(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(o,s){o.tag===i.tag&&o.kind===i.kind&&o.multi===i.multi&&(r=s)}),e[r]=i}),e}function v3(t){return this.extend(t)}v3.prototype.extend=function(n){var e=[],i=[];if(n instanceof Rs)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new Ta("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(o){if(!(o instanceof Rs))throw new Ta("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(o.loadKind&&"scalar"!==o.loadKind)throw new Ta("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(o.multi)throw new Ta("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(o){if(!(o instanceof Rs))throw new Ta("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(v3.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=zL(r,"implicit"),r.compiledExplicit=zL(r,"explicit"),r.compiledTypeMap=function $re(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var VL=v3,jL=new Rs("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),GL=new Rs("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),WL=new Rs("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),$L=new VL({explicit:[jL,GL,WL]}),YL=new Rs("tag:yaml.org,2002:null",{kind:"scalar",resolve:function Yre(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function qre(){return null},predicate:function Zre(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),qL=new Rs("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function Xre(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function Kre(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function Qre(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function Jre(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function eoe(t){return 48<=t&&t<=55}function toe(t){return 48<=t&&t<=57}var ZL=new Rs("tag:yaml.org,2002:int",{kind:"scalar",resolve:function noe(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!Jre(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!eoe(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!toe(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function ioe(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function roe(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!es.isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),ooe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),loe=/^[-+]?[0-9]+e/,XL=new Rs("tag:yaml.org,2002:float",{kind:"scalar",resolve:function soe(t){return!(null===t||!ooe.test(t)||"_"===t[t.length-1])},construct:function aoe(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function uoe(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||es.isNegativeZero(t))},represent:function coe(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(es.isNegativeZero(t))return"-0.0";return e=t.toString(10),loe.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),KL=$L.extend({implicit:[YL,qL,ZL,XL]}),QL=KL,JL=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),e6=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),t6=new Rs("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function doe(t){return null!==t&&(null!==JL.exec(t)||null!==e6.exec(t))},construct:function hoe(t){var n,e,i,r,o,s,a,v,l=0,u=null;if(null===(n=JL.exec(t))&&(n=e6.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(o=+n[4],s=+n[5],a=+n[6],n[7]){for(l=n[7].slice(0,3);l.length<3;)l+="0";l=+l}return n[9]&&(u=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(u=-u)),v=new Date(Date.UTC(e,i,r,o,s,a,l)),u&&v.setTime(v.getTime()-u),v},instanceOf:Date,represent:function foe(t){return t.toISOString()}}),n6=new Rs("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function poe(t){return"<<"===t||null===t}}),y3="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",i6=new Rs("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function goe(t){if(null===t)return!1;var n,e,i=0,r=t.length,o=y3;for(e=0;e<r;e++)if(!((n=o.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function moe(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,o=y3,s=0,a=[];for(n=0;n<r;n++)n%4==0&&n&&(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)),s=s<<6|o.indexOf(i.charAt(n));return 0==(e=r%4*6)?(a.push(s>>16&255),a.push(s>>8&255),a.push(255&s)):18===e?(a.push(s>>10&255),a.push(s>>2&255)):12===e&&a.push(s>>4&255),new Uint8Array(a)},predicate:function boe(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function _oe(t){var i,r,n="",e=0,o=t.length,s=y3;for(i=0;i<o;i++)i%3==0&&i&&(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]),e=(e<<8)+t[i];return 0==(r=o%3)?(n+=s[e>>18&63],n+=s[e>>12&63],n+=s[e>>6&63],n+=s[63&e]):2===r?(n+=s[e>>10&63],n+=s[e>>4&63],n+=s[e<<2&63],n+=s[64]):1===r&&(n+=s[e>>2&63],n+=s[e<<4&63],n+=s[64],n+=s[64]),n}}),voe=Object.prototype.hasOwnProperty,yoe=Object.prototype.toString,r6=new Rs("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function Coe(t){if(null===t)return!0;var e,i,r,o,s,n=[],a=t;for(e=0,i=a.length;e<i;e+=1){if(s=!1,"[object Object]"!==yoe.call(r=a[e]))return!1;for(o in r)if(voe.call(r,o)){if(s)return!1;s=!0}if(!s)return!1;if(-1!==n.indexOf(o))return!1;n.push(o)}return!0},construct:function xoe(t){return null!==t?t:[]}}),woe=Object.prototype.toString,o6=new Rs("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function Eoe(t){if(null===t)return!0;var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1){if("[object Object]"!==woe.call(i=s[n])||1!==(r=Object.keys(i)).length)return!1;o[n]=[r[0],i[r[0]]]}return!0},construct:function Toe(t){if(null===t)return[];var n,e,i,r,o,s=t;for(o=new Array(s.length),n=0,e=s.length;n<e;n+=1)i=s[n],r=Object.keys(i),o[n]=[r[0],i[r[0]]];return o}}),Ioe=Object.prototype.hasOwnProperty,s6=new Rs("tag:yaml.org,2002:set",{kind:"mapping",resolve:function Soe(t){if(null===t)return!0;var n,e=t;for(n in e)if(Ioe.call(e,n)&&null!==e[n])return!1;return!0},construct:function Moe(t){return null!==t?t:{}}}),C3=QL.extend({implicit:[t6,n6],explicit:[i6,r6,o6,s6]}),Jh=Object.prototype.hasOwnProperty,Lx=1,a6=2,l6=3,Bx=4,x3=1,Doe=2,c6=3,Ooe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,Aoe=/[\x85\u2028\u2029]/,koe=/[,\[\]\{\}]/,u6=/^(?:!|!!|![a-z\-]+!)$/i,d6=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function h6(t){return Object.prototype.toString.call(t)}function Su(t){return 10===t||13===t}function Sp(t){return 9===t||32===t}function Za(t){return 9===t||32===t||10===t||13===t}function Wm(t){return 44===t||91===t||93===t||123===t||125===t}function Poe(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function Foe(t){return 120===t?2:117===t?4:85===t?8:0}function Noe(t){return 48<=t&&t<=57?t-48:-1}function f6(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function Roe(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var p6=new Array(256),g6=new Array(256),$m=0;$m<256;$m++)p6[$m]=f6($m)?1:0,g6[$m]=f6($m);function Loe(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||C3,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function m6(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=zre(e),new Ta(n,e)}function vn(t,n){throw m6(t,n)}function Ux(t,n){t.onWarning&&t.onWarning.call(null,m6(t,n))}var _6={YAML:function(n,e,i){var r,o,s;null!==n.version&&vn(n,"duplication of %YAML directive"),1!==i.length&&vn(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&vn(n,"ill-formed argument of the YAML directive"),o=parseInt(r[1],10),s=parseInt(r[2],10),1!==o&&vn(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=s<2,1!==s&&2!==s&&Ux(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,o;2!==i.length&&vn(n,"TAG directive accepts exactly two arguments"),o=i[1],u6.test(r=i[0])||vn(n,"ill-formed tag handle (first argument) of the TAG directive"),Jh.call(n.tagMap,r)&&vn(n,'there is a previously declared suffix for "'+r+'" tag handle'),d6.test(o)||vn(n,"ill-formed tag prefix (second argument) of the TAG directive");try{o=decodeURIComponent(o)}catch{vn(n,"tag prefix is malformed: "+o)}n.tagMap[r]=o}};function ef(t,n,e,i){var r,o,s,a;if(n<e){if(a=t.input.slice(n,e),i)for(r=0,o=a.length;r<o;r+=1)9===(s=a.charCodeAt(r))||32<=s&&s<=1114111||vn(t,"expected valid JSON character");else Ooe.test(a)&&vn(t,"the stream contains non-printable characters");t.result+=a}}function b6(t,n,e,i){var r,o,s,a;for(es.isObject(e)||vn(t,"cannot merge mappings; the provided source object is unacceptable"),s=0,a=(r=Object.keys(e)).length;s<a;s+=1)Jh.call(n,o=r[s])||(n[o]=e[o],i[o]=!0)}function Ym(t,n,e,i,r,o,s,a,l){var u,f;if(Array.isArray(r))for(u=0,f=(r=Array.prototype.slice.call(r)).length;u<f;u+=1)Array.isArray(r[u])&&vn(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===h6(r[u])&&(r[u]="[object Object]");if("object"==typeof r&&"[object Object]"===h6(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(o))for(u=0,f=o.length;u<f;u+=1)b6(t,n,o[u],e);else b6(t,n,o,e);else!t.json&&!Jh.call(e,r)&&Jh.call(n,r)&&(t.line=s||t.line,t.lineStart=a||t.lineStart,t.position=l||t.position,vn(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:o}):n[r]=o,delete e[r];return n}function w3(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):vn(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function zo(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;Sp(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Su(r))break;for(w3(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&Ux(t,"deficient indentation"),i}function Hx(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!Za(e)))}function E3(t,n){1===n?t.result+=" ":n>1&&(t.result+=es.repeat("\n",n-1))}function v6(t,n){var e,l,i=t.tag,r=t.anchor,o=[],a=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=o),l=t.input.charCodeAt(t.position);0!==l&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,vn(t,"tab characters must not be used in indentation")),45===l&&Za(t.input.charCodeAt(t.position+1)));)if(a=!0,t.position++,zo(t,!0,-1)&&t.lineIndent<=n)o.push(null),l=t.input.charCodeAt(t.position);else if(e=t.line,qm(t,n,l6,!1,!0),o.push(t.result),zo(t,!0,-1),l=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==l)vn(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!a&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=o,!0)}function Goe(t){var n,r,o,s,e=!1,i=!1;if(33!==(s=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&vn(t,"duplication of a tag property"),60===(s=t.input.charCodeAt(++t.position))?(e=!0,s=t.input.charCodeAt(++t.position)):33===s?(i=!0,r="!!",s=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&62!==s);t.position<t.length?(o=t.input.slice(n,t.position),s=t.input.charCodeAt(++t.position)):vn(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==s&&!Za(s);)33===s&&(i?vn(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),u6.test(r)||vn(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),s=t.input.charCodeAt(++t.position);o=t.input.slice(n,t.position),koe.test(o)&&vn(t,"tag suffix cannot contain flow indicator characters")}o&&!d6.test(o)&&vn(t,"tag name cannot contain such characters: "+o);try{o=decodeURIComponent(o)}catch{vn(t,"tag name is malformed: "+o)}return e?t.tag=o:Jh.call(t.tagMap,r)?t.tag=t.tagMap[r]+o:"!"===r?t.tag="!"+o:"!!"===r?t.tag="tag:yaml.org,2002:"+o:vn(t,'undeclared tag handle "'+r+'"'),!0}function Woe(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&vn(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!Za(e)&&!Wm(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&vn(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function qm(t,n,e,i,r){var o,s,a,g,v,C,E,w,T,l=1,u=!1,f=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,o=s=a=Bx===e||l6===e,i&&zo(t,!0,-1)&&(u=!0,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)),1===l)for(;Goe(t)||Woe(t);)zo(t,!0,-1)?(u=!0,a=o,t.lineIndent>n?l=1:t.lineIndent===n?l=0:t.lineIndent<n&&(l=-1)):a=!1;if(a&&(a=u||r),(1===l||Bx===e)&&(w=Lx===e||a6===e?n:n+1,T=t.position-t.lineStart,1===l?a&&(v6(t,T)||function joe(t,n,e){var i,r,o,s,a,l,S,u=t.tag,f=t.anchor,g={},v=Object.create(null),C=null,E=null,w=null,T=!1,M=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=g),S=t.input.charCodeAt(t.position);0!==S;){if(!T&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,vn(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),o=t.line,63!==S&&58!==S||!Za(i)){if(s=t.line,a=t.lineStart,l=t.position,!qm(t,e,a6,!1,!0))break;if(t.line===o){for(S=t.input.charCodeAt(t.position);Sp(S);)S=t.input.charCodeAt(++t.position);if(58===S)Za(S=t.input.charCodeAt(++t.position))||vn(t,"a whitespace character is expected after the key-value separator within a block mapping"),T&&(Ym(t,g,v,C,E,null,s,a,l),C=E=w=null),M=!0,T=!1,r=!1,C=t.tag,E=t.result;else{if(!M)return t.tag=u,t.anchor=f,!0;vn(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!M)return t.tag=u,t.anchor=f,!0;vn(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===S?(T&&(Ym(t,g,v,C,E,null,s,a,l),C=E=w=null),M=!0,T=!0,r=!0):T?(T=!1,r=!0):vn(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,S=i;if((t.line===o||t.lineIndent>n)&&(T&&(s=t.line,a=t.lineStart,l=t.position),qm(t,n,Bx,!0,r)&&(T?E=t.result:w=t.result),T||(Ym(t,g,v,C,E,w,s,a,l),C=E=w=null),zo(t,!0,-1),S=t.input.charCodeAt(t.position)),(t.line===o||t.lineIndent>n)&&0!==S)vn(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return T&&Ym(t,g,v,C,E,null,s,a,l),M&&(t.tag=u,t.anchor=f,t.kind="mapping",t.result=g),M}(t,T,w))||function zoe(t,n){var i,r,o,a,f,g,v,C,w,T,M,S,e=!0,s=t.tag,l=t.anchor,E=Object.create(null);if(91===(S=t.input.charCodeAt(t.position)))f=93,C=!1,a=[];else{if(123!==S)return!1;f=125,C=!0,a={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=a),S=t.input.charCodeAt(++t.position);0!==S;){if(zo(t,!0,n),(S=t.input.charCodeAt(t.position))===f)return t.position++,t.tag=s,t.anchor=l,t.kind=C?"mapping":"sequence",t.result=a,!0;e?44===S&&vn(t,"expected the node content, but found ','"):vn(t,"missed comma between flow collection entries"),M=null,g=v=!1,63===S&&Za(t.input.charCodeAt(t.position+1))&&(g=v=!0,t.position++,zo(t,!0,n)),i=t.line,r=t.lineStart,o=t.position,qm(t,n,Lx,!1,!0),T=t.tag,w=t.result,zo(t,!0,n),S=t.input.charCodeAt(t.position),(v||t.line===i)&&58===S&&(g=!0,S=t.input.charCodeAt(++t.position),zo(t,!0,n),qm(t,n,Lx,!1,!0),M=t.result),C?Ym(t,a,E,T,w,M,i,r,o):a.push(g?Ym(t,null,E,T,w,M,i,r,o):w),zo(t,!0,n),44===(S=t.input.charCodeAt(t.position))?(e=!0,S=t.input.charCodeAt(++t.position)):e=!1}vn(t,"unexpected end of the stream within a flow collection")}(t,w)?f=!0:(s&&function Voe(t,n){var e,i,f,g,r=x3,o=!1,s=!1,a=n,l=0,u=!1;if(124===(g=t.input.charCodeAt(t.position)))i=!1;else{if(62!==g)return!1;i=!0}for(t.kind="scalar",t.result="";0!==g;)if(43===(g=t.input.charCodeAt(++t.position))||45===g)x3===r?r=43===g?c6:Doe:vn(t,"repeat of a chomping mode identifier");else{if(!((f=Noe(g))>=0))break;0===f?vn(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):s?vn(t,"repeat of an indentation width identifier"):(a=n+f-1,s=!0)}if(Sp(g)){do{g=t.input.charCodeAt(++t.position)}while(Sp(g));if(35===g)do{g=t.input.charCodeAt(++t.position)}while(!Su(g)&&0!==g)}for(;0!==g;){for(w3(t),t.lineIndent=0,g=t.input.charCodeAt(t.position);(!s||t.lineIndent<a)&&32===g;)t.lineIndent++,g=t.input.charCodeAt(++t.position);if(!s&&t.lineIndent>a&&(a=t.lineIndent),Su(g))l++;else{if(t.lineIndent<a){r===c6?t.result+=es.repeat("\n",o?1+l:l):r===x3&&o&&(t.result+="\n");break}for(i?Sp(g)?(u=!0,t.result+=es.repeat("\n",o?1+l:l)):u?(u=!1,t.result+=es.repeat("\n",l+1)):0===l?o&&(t.result+=" "):t.result+=es.repeat("\n",l):t.result+=es.repeat("\n",o?1+l:l),o=!0,s=!0,l=0,e=t.position;!Su(g)&&0!==g;)g=t.input.charCodeAt(++t.position);ef(t,e,t.position,!1)}}return!0}(t,w)||function Uoe(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(ef(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Su(e)?(ef(t,i,r,!0),E3(t,zo(t,!1,n)),i=r=t.position):t.position===t.lineStart&&Hx(t)?vn(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);vn(t,"unexpected end of the stream within a single quoted scalar")}(t,w)||function Hoe(t,n){var e,i,r,o,s,a;if(34!==(a=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(a=t.input.charCodeAt(t.position));){if(34===a)return ef(t,e,t.position,!0),t.position++,!0;if(92===a){if(ef(t,e,t.position,!0),Su(a=t.input.charCodeAt(++t.position)))zo(t,!1,n);else if(a<256&&p6[a])t.result+=g6[a],t.position++;else if((s=Foe(a))>0){for(r=s,o=0;r>0;r--)(s=Poe(a=t.input.charCodeAt(++t.position)))>=0?o=(o<<4)+s:vn(t,"expected hexadecimal character");t.result+=Roe(o),t.position++}else vn(t,"unknown escape sequence");e=i=t.position}else Su(a)?(ef(t,e,i,!0),E3(t,zo(t,!1,n)),e=i=t.position):t.position===t.lineStart&&Hx(t)?vn(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}vn(t,"unexpected end of the stream within a double quoted scalar")}(t,w)?f=!0:function $oe(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!Za(i)&&!Wm(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&vn(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Jh.call(t.anchorMap,e)||vn(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],zo(t,!0,-1),!0}(t)?(f=!0,(null!==t.tag||null!==t.anchor)&&vn(t,"alias node should not have any properties")):function Boe(t,n,e){var r,o,s,a,l,u,f,C,g=t.kind,v=t.result;if(Za(C=t.input.charCodeAt(t.position))||Wm(C)||35===C||38===C||42===C||33===C||124===C||62===C||39===C||34===C||37===C||64===C||96===C||(63===C||45===C)&&(Za(r=t.input.charCodeAt(t.position+1))||e&&Wm(r)))return!1;for(t.kind="scalar",t.result="",o=s=t.position,a=!1;0!==C;){if(58===C){if(Za(r=t.input.charCodeAt(t.position+1))||e&&Wm(r))break}else if(35===C){if(Za(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&Hx(t)||e&&Wm(C))break;if(Su(C)){if(l=t.line,u=t.lineStart,f=t.lineIndent,zo(t,!1,-1),t.lineIndent>=n){a=!0,C=t.input.charCodeAt(t.position);continue}t.position=s,t.line=l,t.lineStart=u,t.lineIndent=f;break}}a&&(ef(t,o,s,!1),E3(t,t.line-l),o=s=t.position,a=!1),Sp(C)||(s=t.position+1),C=t.input.charCodeAt(++t.position)}return ef(t,o,s,!1),!!t.result||(t.kind=g,t.result=v,!1)}(t,w,Lx===e)&&(f=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===l&&(f=a&&v6(t,T))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&vn(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),g=0,v=t.implicitTypes.length;g<v;g+=1)if((E=t.implicitTypes[g]).resolve(t.result)){t.result=E.construct(t.result),t.tag=E.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Jh.call(t.typeMap[t.kind||"fallback"],t.tag))E=t.typeMap[t.kind||"fallback"][t.tag];else for(E=null,g=0,v=(C=t.typeMap.multi[t.kind||"fallback"]).length;g<v;g+=1)if(t.tag.slice(0,C[g].tag.length)===C[g].tag){E=C[g];break}E||vn(t,"unknown tag !<"+t.tag+">"),null!==t.result&&E.kind!==t.kind&&vn(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+E.kind+'", not "'+t.kind+'"'),E.resolve(t.result,t.tag)?(t.result=E.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):vn(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||f}function Yoe(t){var e,i,r,s,n=t.position,o=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(s=t.input.charCodeAt(t.position))&&(zo(t,!0,-1),s=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==s));){for(o=!0,s=t.input.charCodeAt(++t.position),e=t.position;0!==s&&!Za(s);)s=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&vn(t,"directive name must not be less than one character in length");0!==s;){for(;Sp(s);)s=t.input.charCodeAt(++t.position);if(35===s){do{s=t.input.charCodeAt(++t.position)}while(0!==s&&!Su(s));break}if(Su(s))break;for(e=t.position;0!==s&&!Za(s);)s=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==s&&w3(t),Jh.call(_6,i)?_6[i](t,i,r):Ux(t,'unknown document directive "'+i+'"')}zo(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,zo(t,!0,-1)):o&&vn(t,"directives end mark is expected"),qm(t,t.lineIndent-1,Bx,!1,!0),zo(t,!0,-1),t.checkLineBreaks&&Aoe.test(t.input.slice(n,t.position))&&Ux(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&Hx(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,zo(t,!0,-1)):t.position<t.length-1&&vn(t,"end of the stream or a document separator is expected")}function y6(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new Loe(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,vn(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)Yoe(e);return e.documents}var C6={loadAll:function qoe(t,n,e){null!==n&&"object"==typeof n&&typeof e>"u"&&(e=n,n=null);var i=y6(t,e);if("function"!=typeof n)return i;for(var r=0,o=i.length;r<o;r+=1)n(i[r])},load:function Zoe(t,n){var e=y6(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new Ta("expected a single document in the stream, but found more")}}},x6=Object.prototype.toString,w6=Object.prototype.hasOwnProperty,T3=65279,Qoe=9,nv=10,Joe=13,ese=32,tse=33,nse=34,I3=35,ise=37,rse=38,ose=39,sse=42,E6=44,ase=45,zx=58,lse=61,cse=62,use=63,dse=64,T6=91,I6=93,hse=96,S6=123,fse=124,M6=125,Ks={0:"\\0",7:"\\a",8:"\\b",9:"\\t",10:"\\n",11:"\\v",12:"\\f",13:"\\r",27:"\\e",34:'\\"',92:"\\\\",133:"\\N",160:"\\_",8232:"\\L",8233:"\\P"},pse=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],gse=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function _se(t){var n,e,i;if(n=t.toString(16).toUpperCase(),t<=255)e="x",i=2;else if(t<=65535)e="u",i=4;else{if(!(t<=4294967295))throw new Ta("code point within a string may not be greater than 0xFFFFFFFF");e="U",i=8}return"\\"+e+es.repeat("0",i-n.length)+n}var iv=2;function vse(t){this.schema=t.schema||C3,this.indent=Math.max(1,t.indent||2),this.noArrayIndent=t.noArrayIndent||!1,this.skipInvalid=t.skipInvalid||!1,this.flowLevel=es.isNothing(t.flowLevel)?-1:t.flowLevel,this.styleMap=function mse(t,n){var e,i,r,o,s,a,l;if(null===n)return{};for(e={},r=0,o=(i=Object.keys(n)).length;r<o;r+=1)s=i[r],a=String(n[s]),"!!"===s.slice(0,2)&&(s="tag:yaml.org,2002:"+s.slice(2)),(l=t.compiledTypeMap.fallback[s])&&w6.call(l.styleAliases,a)&&(a=l.styleAliases[a]),e[s]=a;return e}(this.schema,t.styles||null),this.sortKeys=t.sortKeys||!1,this.lineWidth=t.lineWidth||80,this.noRefs=t.noRefs||!1,this.noCompatMode=t.noCompatMode||!1,this.condenseFlow=t.condenseFlow||!1,this.quotingType='"'===t.quotingType?iv:1,this.forceQuotes=t.forceQuotes||!1,this.replacer="function"==typeof t.replacer?t.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}function D6(t,n){for(var s,e=es.repeat(" ",n),i=0,r=-1,o="",a=t.length;i<a;)-1===(r=t.indexOf("\n",i))?(s=t.slice(i),i=a):(s=t.slice(i,r+1),i=r+1),s.length&&"\n"!==s&&(o+=e),o+=s;return o}function S3(t,n){return"\n"+es.repeat(" ",t.indent*n)}function Vx(t){return t===ese||t===Qoe}function rv(t){return 32<=t&&t<=126||161<=t&&t<=55295&&8232!==t&&8233!==t||57344<=t&&t<=65533&&t!==T3||65536<=t&&t<=1114111}function O6(t){return rv(t)&&t!==T3&&t!==Joe&&t!==nv}function A6(t,n,e){var i=O6(t),r=i&&!Vx(t);return(e?i:i&&t!==E6&&t!==T6&&t!==I6&&t!==S6&&t!==M6)&&t!==I3&&!(n===zx&&!r)||O6(n)&&!Vx(n)&&t===I3||n===zx&&r}function ov(t,n){var i,e=t.charCodeAt(n);return e>=55296&&e<=56319&&n+1<t.length&&(i=t.charCodeAt(n+1))>=56320&&i<=57343?1024*(e-55296)+i-56320+65536:e}function k6(t){return/^\n* /.test(t)}var P6=1,M3=2,F6=3,N6=4,Zm=5;function Ese(t,n,e,i,r){t.dump=function(){if(0===n.length)return t.quotingType===iv?'""':"''";if(!t.noCompatMode&&(-1!==pse.indexOf(n)||gse.test(n)))return t.quotingType===iv?'"'+n+'"':"'"+n+"'";var o=t.indent*Math.max(1,e),s=-1===t.lineWidth?-1:Math.max(Math.min(t.lineWidth,40),t.lineWidth-o);switch(function wse(t,n,e,i,r,o,s,a){var l,u=0,f=null,g=!1,v=!1,C=-1!==i,E=-1,w=function Cse(t){return rv(t)&&t!==T3&&!Vx(t)&&t!==ase&&t!==use&&t!==zx&&t!==E6&&t!==T6&&t!==I6&&t!==S6&&t!==M6&&t!==I3&&t!==rse&&t!==sse&&t!==tse&&t!==fse&&t!==lse&&t!==cse&&t!==ose&&t!==nse&&t!==ise&&t!==dse&&t!==hse}(ov(t,0))&&function xse(t){return!Vx(t)&&t!==zx}(ov(t,t.length-1));if(n||s)for(l=0;l<t.length;u>=65536?l+=2:l++){if(!rv(u=ov(t,l)))return Zm;w=w&&A6(u,f,a),f=u}else{for(l=0;l<t.length;u>=65536?l+=2:l++){if((u=ov(t,l))===nv)g=!0,C&&(v=v||l-E-1>i&&" "!==t[E+1],E=l);else if(!rv(u))return Zm;w=w&&A6(u,f,a),f=u}v=v||C&&l-E-1>i&&" "!==t[E+1]}return g||v?e>9&&k6(t)?Zm:s?o===iv?Zm:M3:v?N6:F6:!w||s||r(t)?o===iv?Zm:M3:P6}(n,i||t.flowLevel>-1&&e>=t.flowLevel,t.indent,s,function l(u){return function yse(t,n){var e,i;for(e=0,i=t.implicitTypes.length;e<i;e+=1)if(t.implicitTypes[e].resolve(n))return!0;return!1}(t,u)},t.quotingType,t.forceQuotes&&!i,r)){case P6:return n;case M3:return"'"+n.replace(/'/g,"''")+"'";case F6:return"|"+R6(n,t.indent)+L6(D6(n,o));case N6:return">"+R6(n,t.indent)+L6(D6(function Tse(t,n){for(var o,s,e=/(\n+)([^\n]*)/g,i=(u=void 0,u=t.indexOf("\n"),e.lastIndex=u=-1!==u?u:t.length,B6(t.slice(0,u),n)),r="\n"===t[0]||" "===t[0];s=e.exec(t);){var l=s[2];o=" "===l[0],i+=s[1]+(r||o||""===l?"":"\n")+B6(l,n),r=o}var u;return i}(n,s),o));case Zm:return'"'+function Ise(t){for(var i,n="",e=0,r=0;r<t.length;e>=65536?r+=2:r++)e=ov(t,r),!(i=Ks[e])&&rv(e)?(n+=t[r],e>=65536&&(n+=t[r+1])):n+=i||_se(e);return n}(n)+'"';default:throw new Ta("impossible error: invalid scalar style")}}()}function R6(t,n){var e=k6(t)?String(n):"",i="\n"===t[t.length-1];return e+(!i||"\n"!==t[t.length-2]&&"\n"!==t?i?"":"-":"+")+"\n"}function L6(t){return"\n"===t[t.length-1]?t.slice(0,-1):t}function B6(t,n){if(""===t||" "===t[0])return t;for(var i,o,e=/ [^ ]/g,r=0,s=0,a=0,l="";i=e.exec(t);)(a=i.index)-r>n&&(l+="\n"+t.slice(r,o=s>r?s:a),r=o+1),s=a;return l+="\n",(l+=t.length-r>n&&s>r?t.slice(r,s)+"\n"+t.slice(s+1):t.slice(r)).slice(1)}function H6(t,n,e){var i,r,o,s,a,l;for(o=0,s=(r=e?t.explicitTypes:t.implicitTypes).length;o<s;o+=1)if(((a=r[o]).instanceOf||a.predicate)&&(!a.instanceOf||"object"==typeof n&&n instanceof a.instanceOf)&&(!a.predicate||a.predicate(n))){if(t.tag=e?a.multi&&a.representName?a.representName(n):a.tag:"?",a.represent){if(l=t.styleMap[a.tag]||a.defaultStyle,"[object Function]"===x6.call(a.represent))i=a.represent(n,l);else{if(!w6.call(a.represent,l))throw new Ta("!<"+a.tag+'> tag resolver accepts not "'+l+'" style');i=a.represent[l](n,l)}t.dump=i}return!0}return!1}function Dd(t,n,e,i,r,o,s){t.tag=null,t.dump=e,H6(t,e,!1)||H6(t,e,!0);var u,a=x6.call(t.dump),l=i;i&&(i=t.flowLevel<0||t.flowLevel>n);var g,v,f="[object Object]"===a||"[object Array]"===a;if(f&&(v=-1!==(g=t.duplicates.indexOf(e))),(null!==t.tag&&"?"!==t.tag||v||2!==t.indent&&n>0)&&(r=!1),v&&t.usedDuplicates[g])t.dump="*ref_"+g;else{if(f&&v&&!t.usedDuplicates[g]&&(t.usedDuplicates[g]=!0),"[object Object]"===a)i&&0!==Object.keys(t.dump).length?(function Dse(t,n,e,i){var a,l,u,f,g,v,r="",o=t.tag,s=Object.keys(e);if(!0===t.sortKeys)s.sort();else if("function"==typeof t.sortKeys)s.sort(t.sortKeys);else if(t.sortKeys)throw new Ta("sortKeys must be a boolean or a function");for(a=0,l=s.length;a<l;a+=1)v="",(!i||""!==r)&&(v+=S3(t,n)),f=e[u=s[a]],t.replacer&&(f=t.replacer.call(e,u,f)),Dd(t,n+1,u,!0,!0,!0)&&((g=null!==t.tag&&"?"!==t.tag||t.dump&&t.dump.length>1024)&&(t.dump&&nv===t.dump.charCodeAt(0)?v+="?":v+="? "),v+=t.dump,g&&(v+=S3(t,n)),Dd(t,n+1,f,!0,g)&&(t.dump&&nv===t.dump.charCodeAt(0)?v+=":":v+=": ",r+=v+=t.dump));t.tag=o,t.dump=r||"{}"}(t,n,t.dump,r),v&&(t.dump="&ref_"+g+t.dump)):(function Mse(t,n,e){var s,a,l,u,f,i="",r=t.tag,o=Object.keys(e);for(s=0,a=o.length;s<a;s+=1)f="",""!==i&&(f+=", "),t.condenseFlow&&(f+='"'),u=e[l=o[s]],t.replacer&&(u=t.replacer.call(e,l,u)),Dd(t,n,l,!1,!1)&&(t.dump.length>1024&&(f+="? "),f+=t.dump+(t.condenseFlow?'"':"")+":"+(t.condenseFlow?"":" "),Dd(t,n,u,!1,!1)&&(i+=f+=t.dump));t.tag=r,t.dump="{"+i+"}"}(t,n,t.dump),v&&(t.dump="&ref_"+g+" "+t.dump));else if("[object Array]"===a)i&&0!==t.dump.length?(function U6(t,n,e,i){var s,a,l,r="",o=t.tag;for(s=0,a=e.length;s<a;s+=1)l=e[s],t.replacer&&(l=t.replacer.call(e,String(s),l)),(Dd(t,n+1,l,!0,!0,!1,!0)||typeof l>"u"&&Dd(t,n+1,null,!0,!0,!1,!0))&&((!i||""!==r)&&(r+=S3(t,n)),t.dump&&nv===t.dump.charCodeAt(0)?r+="-":r+="- ",r+=t.dump);t.tag=o,t.dump=r||"[]"}(t,t.noArrayIndent&&!s&&n>0?n-1:n,t.dump,r),v&&(t.dump="&ref_"+g+t.dump)):(function Sse(t,n,e){var o,s,a,i="",r=t.tag;for(o=0,s=e.length;o<s;o+=1)a=e[o],t.replacer&&(a=t.replacer.call(e,String(o),a)),(Dd(t,n,a,!1,!1)||typeof a>"u"&&Dd(t,n,null,!1,!1))&&(""!==i&&(i+=","+(t.condenseFlow?"":" ")),i+=t.dump);t.tag=r,t.dump="["+i+"]"}(t,n,t.dump),v&&(t.dump="&ref_"+g+" "+t.dump));else{if("[object String]"!==a){if("[object Undefined]"===a)return!1;if(t.skipInvalid)return!1;throw new Ta("unacceptable kind of an object to dump "+a)}"?"!==t.tag&&Ese(t,t.dump,n,o,l)}null!==t.tag&&"?"!==t.tag&&(u=encodeURI("!"===t.tag[0]?t.tag.slice(1):t.tag).replace(/!/g,"%21"),u="!"===t.tag[0]?"!"+u:"tag:yaml.org,2002:"===u.slice(0,18)?"!!"+u.slice(18):"!<"+u+">",t.dump=u+" "+t.dump)}return!0}function Ose(t,n){var r,o,e=[],i=[];for(D3(t,e,i),r=0,o=i.length;r<o;r+=1)n.duplicates.push(e[i[r]]);n.usedDuplicates=new Array(o)}function D3(t,n,e){var i,r,o;if(null!==t&&"object"==typeof t)if(-1!==(r=n.indexOf(t)))-1===e.indexOf(r)&&e.push(r);else if(n.push(t),Array.isArray(t))for(r=0,o=t.length;r<o;r+=1)D3(t[r],n,e);else for(r=0,o=(i=Object.keys(t)).length;r<o;r+=1)D3(t[i[r]],n,e)}function O3(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}const Zse={Type:Rs,Schema:VL,FAILSAFE_SCHEMA:$L,JSON_SCHEMA:KL,CORE_SCHEMA:QL,DEFAULT_SCHEMA:C3,load:C6.load,loadAll:C6.loadAll,dump:function Ase(t,n){var e=new vse(n=n||{});e.noRefs||Ose(t,e);var i=t;return e.replacer&&(i=e.replacer.call({"":i},"",i)),Dd(e,0,i,!0,!0)?e.dump+"\n":""},YAMLException:Ta,types:{binary:i6,float:XL,map:WL,null:YL,pairs:o6,set:s6,timestamp:t6,bool:qL,int:ZL,merge:n6,omap:r6,seq:GL,str:jL},safeLoad:O3("safeLoad","load"),safeLoadAll:O3("safeLoadAll","loadAll"),safeDump:O3("safeDump","dump")},z6=Object.getOwnPropertyNames(Object.prototype),Xse=Object.getOwnPropertyNames(Array.prototype);let jx=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}static#e=this.appConfig={backend:{mode:"",url:""},webrtc:{key:""},app:{title:""},dice:{url:"",api:2}};initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,R.A)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=Zse.load(i);t.applyConfig(r)}catch(i){console.warn(i)}U.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,R.A)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let o of r)(Array.isArray(e)||Array.isArray(i)?z6.concat(Xse):z6).includes(o)?console.log(`skip invalid key (${o})`):null!=e[o]&&"object"==typeof e[o]?(null==i[o]&&(i[o]=Array.isArray(e[o])?[]:{}),t.applyConfig(e[o],i[o])):"function"!=typeof e[o]&&"function"!=typeof i[o]&&(i[o]=e[o]);return i}static#t=this.\u0275fac=function(i){return new(i||t)};static#n=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const Kse=t=>({"cant-use-private-session":t}),Qse=t=>({"i-am-gm":t}),Jse=t=>({"red-eye":t}),eae=t=>({"is-gm-mode":t});function tae(t,n){if(1&t){const e=Ie();p(0,"span",15),It(1,"safe"),X("click",function(){return O(e),D(y(2).changeIcon())}),m()}2&t&&ke("background-image",St(1,2,"url("+y(2).myPeer.image.url+")","style"))}function nae(t,n){if(1&t){const e=Ie();p(0,"div")(1,"div",6),L(2,tae,2,5,"span",7),p(3,"div")(4,"label",8)(5,"b",9)(6,"input",10),X("click",function(r){return O(e),D(y().onGMMode(r))}),m(),x(7),m()(),Ne(8,"br"),p(9,"button",11),X("click",function(){return O(e),D(y().changeIcon())}),x(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),m()()(),p(11,"div"),x(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),p(13,"input",12),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.myPeerColor,r)||(o.myPeerColor=r),D(r)}),m(),p(14,"input",13),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.myPeerName,r)||(o.myPeerName=r),D(r)}),m(),Ne(15,"br"),p(16,"small"),x(17,"\u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f"),p(18,"b"),x(19,"\u30a2\u30a4\u30b3\u30f3"),m(),x(20,"\u3001"),p(21,"b"),x(22,"\u8272"),m(),x(23,"\u3001"),p(24,"b"),x(25,"\u30cb\u30c3\u30af\u30cd\u30fc\u30e0"),m(),x(26,"\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002"),m(),Ne(27,"br"),p(28,"span",14),x(29,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),m()()()}if(2&t){const e=y();h(2),_("ngIf",e.myPeer.image),h(2),_("ngClass",Be(8,Qse,e.isGMMode||e.isGMHold)),h(2),ft("checked",e.isGMMode||e.isGMHold?"checked":""),h(),Re(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),h(6),We("ngModel",e.myPeerColor),h(),ke("color",e.myPeerColor),We("ngModel",e.myPeerName)}}function iae(t,n){if(1&t){const e=Ie();p(0,"button",21),X("click",function(){return O(e),D(y(2).copyPeerId())}),p(1,"b",22),x(2,"content_copy"),m()()}2&t&&_("disabled",y(2).isCopied)}function rae(t,n){if(1&t&&(Me(0),p(1,"span",16)(2,"span",17),x(3),m(),Ne(4,"input",18),m(),L(5,iae,3,1,"button",19),p(6,"span",20),x(7),m(),De()),2&t){const e=y();h(3),Re(e.networkService.peer.userId),h(),ft("value",e.networkService.peer.userId),h(),_("ngIf",e.isAbleClipboardCopy&&e.canUsePrivateSession),h(),ke("color",e.myPeerColor),_("@fadeInOut",e.isCopied),h(),Mi(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function oae(t,n){1&t&&(p(0,"span",23),x(1,"???"),m())}function sae(t,n){if(1&t){const e=Ie();p(0,"button",21),X("click",function(){return O(e),D(y(3).copyRoomName())}),p(1,"b",22),x(2,"content_copy"),m()()}2&t&&_("disabled",y(3).isRoomNameCopied)}function aae(t,n){if(1&t&&(Me(0),p(1,"span",16)(2,"span",24),x(3),m(),Ne(4,"input",25),m(),L(5,sae,3,1,"button",19),p(6,"span",20),x(7),m(),De()),2&t){const e=y(2);h(3),Ih("",e.networkService.peer.roomName,"/",e.networkService.peer.roomId,""),h(),ft("value",e.networkService.peer.roomName+"/"+e.networkService.peer.roomId),h(),_("ngIf",e.isAbleClipboardCopy),h(),ke("color",e.myPeerColor),_("@fadeInOut",e.isRoomNameCopied),h(),Mi(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function lae(t,n){if(1&t&&(p(0,"span",16)(1,"span",24),x(2),m(),Ne(3,"input",25),m()),2&t){const e=y(3);h(2),Re(e.networkService.peer.password),h(),ft("value",e.networkService.peer.password)}}function cae(t,n){if(1&t&&(p(0,"div",33),x(1),m()),2&t){const e=y(3);h(),Re(e.maskedPassword)}}function uae(t,n){if(1&t){const e=Ie();p(0,"button",21),X("click",function(){return O(e),D(y(3).copyPassword())}),p(1,"b",22),x(2,"content_copy"),m()()}if(2&t){const e=y(3);_("disabled",e.isPasswordCopied||e.isRoomInfoCopied)}}function dae(t,n){if(1&t){const e=Ie();p(0,"button",34),X("click",function(){return O(e),D(y(3).copyRoomInfo())}),p(1,"b",35),x(2,"content_copy"),m(),p(3,"b",36),x(4,"\u30eb\u30fc\u30e0\u60c5\u5831\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc"),m()()}if(2&t){const e=y(3);_("disabled",e.isPasswordCopied||e.isRoomInfoCopied)}}function hae(t,n){if(1&t){const e=Ie();Me(0),p(1,"div"),x(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),p(3,"label",26)(4,"input",27),X("click",function(r){return O(e),D(y(2).onPasswordOpen(r))}),m(),p(5,"b",28),x(6),m(),x(7,"\uff1a "),m(),p(8,"div",29),L(9,lae,4,2,"span",30)(10,cae,2,1,"div",31)(11,uae,3,1,"button",19),p(12,"span",20),x(13),m(),Ne(14,"br"),L(15,dae,5,1,"button",32),p(16,"span",20),x(17),m()()(),De()}if(2&t){const e=y(2);h(4),ft("checked",e.isPasswordOpen?"checked":""),h(),_("ngClass",Be(15,Jse,e.isPasswordOpen)),h(),Re(e.isPasswordOpen?"visibility":"visibility_off"),h(3),_("ngIf",e.isPasswordOpen),h(),_("ngIf",!e.isPasswordOpen),h(),_("ngIf",e.isAbleClipboardCopy),h(),ke("color",e.myPeerColor),_("@fadeInOut",e.isPasswordCopied),h(),Mi(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"",""),h(2),_("ngIf",e.isAbleClipboardCopy),h(),ke("color",e.myPeerColor),_("@fadeInOut",e.isRoomInfoCopied),h(),Mi(" ",e.isRoomInfoCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function fae(t,n){if(1&t&&(Me(0),Ne(1,"hr"),p(2,"div"),x(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),p(4,"span"),L(5,aae,8,8,"ng-container",0),m()(),L(6,hae,18,17,"ng-container",0),De()),2&t){const e=y();h(5),_("ngIf",e.networkService.isOpen),h(),_("ngIf",e.networkService.peer.password)}}function pae(t,n){1&t&&(p(0,"div",23),x(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),p(2,"span",42),x(3,"\uff08\u826f\u597d "),m(),p(4,"i",43),x(5,"sentiment_very_satisfied"),m(),p(6,"span",42),x(7," \uff1e "),m(),p(8,"i",44),x(9,"sentiment_dissatisfied"),m(),p(10,"span",42),x(11," \uff1e "),m(),p(12,"i",45),x(13,"mood_bad"),m(),p(14,"span",42),x(15," \uff1e "),m(),p(16,"i",46),x(17,"sentiment_very_dissatisfied"),m(),p(18,"span",42),x(19," \u4e0d\u826f\uff09"),m(),x(20,"\uff1a"),m())}function gae(t,n){1&t&&(p(0,"span"),x(1,"[\u63a5\u7d9a\u4e2d]"),m())}function mae(t,n){if(1&t&&(Ne(0,"span",47),It(1,"safe")),2&t){const e=y().$implicit;ke("background-image",St(1,2,"url("+y().findPeerImageUrl(e.peerId)+")","style"))}}function _ae(t,n){if(1&t&&(p(0,"div"),L(1,pae,21,0,"div",2),p(2,"div",37),L(3,gae,2,0,"span",0),p(4,"span")(5,"span",1)(6,"i",38),x(7),m(),p(8,"span",39),x(9),m(),x(10," ["),L(11,mae,2,5,"span",40),p(12,"span")(13,"b"),x(14),m()(),x(15,"] "),m()(),p(16,"div",41)(17,"span"),x(18),m()()()()),2&t){const e=n.$implicit,i=n.index,r=y();h(),_("ngIf",0==i),h(2),_("ngIf",!e.isOpen),h(2),_("ngClass",Be(19,eae,r.findPeerIsGMMode(e.peerId))),h(),am("material-icons health "+r.healthClass(e.session.health)),h(),Re(r.healthIcon(e.session.health)),h(2),Re(r.findUserId(e.peerId)),h(2),_("ngIf",r.findPeerImageUrl(e.peerId)),h(2),ke("color",r.findPeerColor(e.peerId)),h(),Re(r.findPeerName(e.peerId)),h(2),ke("border-left-color",r.findPeerColor(e.peerId)),h(2),CT("\u63a5\u7d9a\u72b6\u614b Grade:",r.stringFromSessionGrade(e.session.grade)," (",e.session.description,") Health:",(100*e.session.health).toFixed(0),"% Speed:",(100*e.session.speed).toFixed(0),"% Ping:",e.session.ping.toFixed(1),"ms")}}function bae(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",50),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.targetUserId,r)||(o.targetUserId=r),D(r)}),m(),p(2,"button",51),X("click",function(){return O(e),D(y(2).connectPeer())}),x(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),m(),Ne(4,"br"),De()}if(2&t){const e=y(2);h(),We("ngModel",e.targetUserId),_("disabled",e.isDisableConnect),h(),_("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function vae(t,n){if(1&t){const e=Ie();p(0,"button",52),X("click",function(){return O(e),D(y(2).showLobby())}),p(1,"i",53),x(2,"meeting_room"),m(),x(3,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),m()}if(2&t){const e=y(2);_("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function yae(t,n){if(1&t&&(p(0,"div",48),L(1,bae,5,3,"ng-container",0)(2,vae,4,1,"button",49),m()),2&t){const e=y();h(),_("ngIf",!e.networkService.peer.isRoom&&e.canUsePrivateSession),h(),_("ngIf",e.networkService.peers.length<1)}}function Cae(t,n){1&t&&(p(0,"div",5),x(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),m())}function xae(t,n){1&t&&(p(0,"div",5),x(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),m())}function wae(t,n){if(1&t&&(Me(0),L(1,Cae,2,0,"div",54)(2,xae,2,0,"div",54),De()),2&t){const e=y(2);h(),_("ngIf",e.networkService.peers.length<1&&e.canUsePrivateSession),h(),_("ngIf",e.networkService.peers.length<1)}}function Eae(t,n){1&t&&(Me(0),p(1,"div",5),x(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),m(),De())}function Tae(t,n){if(1&t&&(Me(0),L(1,wae,3,2,"ng-container",0)(2,Eae,3,0,"ng-container",0),De()),2&t){const e=y();h(),_("ngIf",!e.networkService.peer.isRoom),h(),_("ngIf",e.networkService.peer.isRoom&&e.canUsePrivateSession)}}function Iae(t,n){1&t&&(Me(0),p(1,"div",5),x(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),m(),De())}let A3=(()=>{class t{get myPeer(){return Ce.myCursor}get myPeerName(){return Ce.myCursor?Ce.myCursor.name:null}set myPeerName(e){Ce.myCursor&&(Ce.myCursor.name=e,Ce.myCursor.name===Ce.CHAT_DEFAULT_NAME?Kn.removeItem(Ce.CHAT_MY_NAME_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Kn.setItem(Ce.CHAT_MY_NAME_LOCAL_STORAGE_KEY,Ce.myCursor.name).catch(i=>console.log(i)))}get myPeerColor(){return Ce.myCursor?Ce.myCursor.color:Ce.CHAT_DEFAULT_COLOR}set myPeerColor(e){if(e&&Ce.myCursor){if(e=e.trim().toLowerCase(),!/^\#[0-9a-f]{6}$/.test(e))return;Ce.myCursor.color=e==Ce.CHAT_TRANSPARENT_COLOR?Ce.CHAT_DEFAULT_COLOR:e,Ce.myCursor.color===Ce.CHAT_DEFAULT_COLOR?Kn.removeItem(Ce.CHAT_MY_COLOR_LOCAL_STORAGE_KEY).catch(i=>console.log(i)):Kn.setItem(Ce.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,Ce.myCursor.color).catch(i=>console.log(i))}}get isGMMode(){return!!Ce.myCursor&&Ce.myCursor.isGMMode}set isGMMode(e){Ce.myCursor&&(Ce.myCursor.isGMMode=e)}get isGMHold(){return Ce.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}get config(){return jx.appConfig}get canUsePrivateSession(){return"skyway"==this.config.backend.mode}constructor(e,i,r,o,s){this.ngZone=e,this.modalService=i,this.panelService=r,this.chatMessageService=o,this.appConfigService=s,this.targetUserId="",this.networkService=xt,this.gameRoomService=dt.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.isRoomInfoCopied=!1,this.help=""}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngAfterViewInit(){U.register(this).on("OPEN_NETWORK",e=>{this.ngZone.run(()=>{})}),this.interval=setInterval(()=>{},1e3)}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),clearTimeout(this._timeOutId4),U.unregister(this),clearInterval(this.interval)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(Ou,{currentImageIdentifires:e}).then(i=>{if(!this.myPeer||!i)return;this.myPeer.imageIdentifier=i;let r=Yt.instance.get(i);r&&(r.state===Di.COMPLETE?Kn.setItem(Ce.CHAT_MY_ICON_LOCAL_STORAGE_KEY,r.blob).catch(o=>console.log(o)):"none_icon"===i?Kn.removeItem(Ce.CHAT_MY_ICON_LOCAL_STORAGE_KEY).catch(o=>console.log(o)):Kn.setItem(Ce.CHAT_MY_ICON_LOCAL_STORAGE_KEY,i).catch(o=>console.log(o)))})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;this.help="";let i=ym.y.create(e);i.isRoom||(dt.instance.clearDeleteHistory(),xt.connect(i),(Ce.isGMHold||this.isGMMode)&&(Ce.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),U.trigger("CHANGE_GM_MODE",null))))}showLobby(){(Ce.isGMHold||this.isGMMode)&&(Ce.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),U.trigger("CHANGE_GM_MODE",null))),this.modalService.open(Mre,{width:700,height:400,left:0,top:400})}stringFromSessionGrade(e){return m3.s[e]??m3.s[m3.s.UNSPECIFIED]}findUserId(e){const i=Ce.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=Ce.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=Ce.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=Ce.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=Ce.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&this.canUsePrivateSession&&(navigator.clipboard.writeText(this.networkService.peer.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peer.roomName+"/"+this.networkService.peer.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(this.modalService.open(Mr,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u30b3\u30d4\u30fc",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5171\u6709\u3059\u308b\u969b\u306b\u306f\u3001SNS\u306e\u516c\u958b\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u3067<b>\u4e0d\u7279\u5b9a\u591a\u6570\u306b\u516c\u958b\u3059\u308b\u3053\u3068\u306f\u907f\u3051\u3066</b>\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"content_copy",action:()=>{navigator.clipboard.writeText(this.networkService.peer.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId3=setTimeout(()=>{this.isPasswordCopied=!1},1e3)}}),this.isPasswordOpen=!1)}copyRoomInfo(){navigator.clipboard&&(this.modalService.open(Mr,{title:"\u30eb\u30fc\u30e0\u60c5\u5831\u306e\u30b3\u30d4\u30fc",text:"\u30eb\u30fc\u30e0\u60c5\u5831\uff08\u30eb\u30fc\u30e0\u540d/\u30eb\u30fc\u30e0ID\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\uff09\u3092\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5171\u6709\u3059\u308b\u969b\u306b\u306f\u3001SNS\u306e\u516c\u958b\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u3067<b>\u4e0d\u7279\u5b9a\u591a\u6570\u306b\u516c\u958b\u3059\u308b\u3053\u3068\u306f\u907f\u3051\u3066</b>\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"content_copy",action:()=>{navigator.clipboard.writeText("\u30eb\u30fc\u30e0\u540d\uff1a"+this.networkService.peer.roomName+"/"+this.networkService.peer.roomId+"  \u30d1\u30b9\u30ef\u30fc\u30c9\uff1a"+this.networkService.peer.password),this.isRoomInfoCopied=!0,clearTimeout(this._timeOutId4),this._timeOutId4=setTimeout(()=>{this.isRoomInfoCopied=!1},1e3)}}),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(Mr,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u30d7\u30ec\u30a4\u914d\u4fe1\u4e2d\u306a\u3069\u306b\u8aa4\u3063\u3066\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u306a\u3044\u3088\u3046\u306b\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002<br>\u307e\u305f\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u5171\u6709\u3059\u308b\u969b\u306b\u306f\u3001SNS\u306e\u516c\u958b\u30a2\u30ab\u30a6\u30f3\u30c8\u306a\u3069\u3067<b>\u4e0d\u7279\u5b9a\u591a\u6570\u306b\u516c\u958b\u3059\u308b\u3053\u3068\u306f\u907f\u3051\u3066</b>\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){Ce.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(Mr,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:or.OK_CANCEL,materialIcon:"person_remove",action:()=>{Ce.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),U.trigger("CHANGE_GM_MODE",null),cn.isStealthMode&&this.modalService.open(Mr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:or.OK,materialIcon:"disabled_visible"})}})):(Ce.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(Mr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:or.OK_CANCEL,materialIcon:"person_add",action:()=>{Ce.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(Mr,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:or.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Ii),F(bi),F(Do),F(jx))};static#t=this.\u0275cmp=xn({type:t,selectors:[["peer-menu"]],decls:16,vars:12,consts:[[4,"ngIf"],[3,"ngClass"],["style","font-weight: bold",4,"ngIf"],[4,"ngFor","ngForOf"],["style","margin-top: 1px",4,"ngIf"],[2,"font-size","12px"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"click","checked"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModelChange","ngModel"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModelChange","ngModel"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],["title","\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc",3,"disabled","click",4,"ngIf"],[1,"copied"],["title","\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc",3,"click","disabled"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",1,"show-hides",3,"click","checked"],[1,"material-icons","show-hides",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["style","margin-top: 2px; margin-left: 0px",3,"disabled","click",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],[2,"margin-top","2px","margin-left","0px",3,"click","disabled"],[1,"material-icons",2,"font-size","1em","vertical-align","middle"],[2,"margin-left","2px","display","inline-block","font-size","smaller"],[1,"peer-info"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"session-info"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],[2,"margin-top","1px"],["style","margin-left: 0px",3,"disabled","click",4,"ngIf"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModelChange","ngModel","disabled"],[3,"click","disabled"],[2,"margin-left","0px",3,"click","disabled"],[1,"material-icons",2,"vertical-align","bottom"],["style","font-size: 12px",4,"ngIf"]],template:function(i,r){1&i&&(L(0,nae,30,10,"div",0),p(1,"div")(2,"div",1),x(3,"\u3042\u306a\u305f\u306eID\uff1a "),p(4,"span"),L(5,rae,8,7,"ng-container",0),m(),L(6,oae,2,0,"span",2),m()(),L(7,fae,7,2,"ng-container",0),Ne(8,"hr"),L(9,_ae,19,21,"div",3)(10,yae,3,2,"div",4),p(11,"div")(12,"span",5),x(13),m()(),L(14,Tae,3,2,"ng-container",0)(15,Iae,3,0,"ng-container",0)),2&i&&(_("ngIf",r.myPeer),h(2),_("ngClass",Be(10,Kse,!r.canUsePrivateSession)),h(3),_("ngIf",r.networkService.isOpen),h(),_("ngIf",!r.networkService.isOpen),h(),_("ngIf",r.networkService.peer.isRoom),h(2),_("ngForOf",r.networkService.peers),h(),_("ngIf",!r.isGMMode&&!r.isGMHold),h(3),Re(r.help),h(),_("ngIf",!r.isGMMode&&!r.isGMHold),h(),_("ngIf",(r.isGMMode||r.isGMHold)&&r.canUsePrivateSession))},dependencies:[Fi,nr,ni,Rr,Lr,Tr,fr],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}.peer-info[_ngcontent-%COMP%]{position:relative}.session-info[_ngcontent-%COMP%]{visibility:hidden;pointer-events:none;position:absolute;top:-110%;padding:.2rem .4rem;font-size:12px;color:#444;background:linear-gradient(-30deg,#f0dabd,#fff4e8);border:solid 1px #999;border-left:solid 4px #555}.peer-info[_ngcontent-%COMP%]:hover   .session-info[_ngcontent-%COMP%]{visibility:visible}.cant-use-private-session[_ngcontent-%COMP%]{font-size:90%}.material-icons[_ngcontent-%COMP%]{font-size:18px;display:inline-block;vertical-align:middle;margin-right:1px}.material-icons.health[_ngcontent-%COMP%]{vertical-align:text-bottom}.show-hides[_ngcontent-%COMP%]{vertical-align:text-bottom;margin-bottom:1px}'],data:{animation:[Vn("fadeInOut",[Xt("false => true",[jt("50ms ease-in-out",Pe({opacity:1})),jt("900ms ease-in-out",Pe({opacity:0}))])])]}})}return t})();var ci=function(t){return t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw",t}(ci||{});class Sae{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new bu(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case ci.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case ci.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`;break;case ci.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`;break;case ci.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case ci.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case ci.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case ci.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case ci.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(n){let e=this.handle.style;if(n)switch(this.type){case ci.N:e.cursor="ns-resize";break;case ci.E:case ci.W:e.cursor="ew-resize";break;case ci.S:e.cursor="ns-resize";break;case ci.NE:e.cursor="nesw-resize";break;case ci.NW:case ci.SE:e.cursor="nwse-resize";break;case ci.SW:e.cursor="nesw-resize"}else e.cursor="default"}}let Mae=(()=>{class t{set isDisable(e){this._isDisable=e,this.initialize()}set align(e){this._align=e,this.initialize()}get handleTypes(){return this._isDisable||"none"===this._align?[]:"horizontal"===this._align?[ci.E,ci.W]:"vertical"===this._align?[ci.N,ci.S]:[ci.N,ci.E,ci.W,ci.S,ci.NE,ci.NW,ci.SE,ci.SW]}constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new Qn,this.onmove=new Qn,this.onend=new Qn,this.handleMap=new Map,this._isDisable=!1,this._align="normal",this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0}}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear(),this.handleTypes.forEach(e=>{let i=new Sae(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.destroy()),this.handleMap.clear()}onResizeStart(e,i){if(this._isDisable||1===e.button||2===e.button)return this.cancel();this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},this.removeSelectionRanges(),this.removeFocus(),e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case ci.N:case ci.S:r.width=0;break;case ci.E:case ci.W:r.height=0}switch(i.type){case ci.SW:r.left=r.width,r.width*=-1;break;case ci.NE:r.top=r.height,r.height*=-1;break;case ci.E:case ci.S:case ci.SE:break;case ci.N:case ci.W:case ci.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let s=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=s.left,r.top+=s.top,r.width+=s.width,r.height+=s.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,this.removeSelectionRanges(),this.removeFocus(),e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),o=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return o.right<r.right+e.left+e.width&&(i.width+=o.right-(r.right+e.left+e.width)),r.left+e.left<o.left&&(i.left+=o.left-(r.left+e.left),i.width-=i.left),o.bottom<r.bottom+e.top+e.height&&(i.height+=o.bottom-(r.bottom+e.top+e.height)),r.top+e.top<o.top&&(i.top+=o.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Io.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Io.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Io.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Io.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(o=>{let s=parseInt(o.style.zIndex);i<s&&(i=s),s<r&&(r=s)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(o=>{o.style.zIndex=parseInt(o.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(_r))};static#t=this.\u0275dir=wn({type:t,selectors:[["","appResizable",""]],inputs:{boundsSelector:[ae.None,"resizable.bounds","boundsSelector"],stackSelector:[ae.None,"resizable.stack","stackSelector"],minWidth:[ae.None,"resizable.minWidth","minWidth"],minHeight:[ae.None,"resizable.minHeight","minHeight"],isDisable:[ae.None,"resizable.disable","isDisable"],align:[ae.None,"resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}})}return t})();const Dae=["draggablePanel"],Oae=["scrollablePanel"],Aae=["content"],kae=["titleBar"],Pae=["*"],Fae=(t,n,e,i)=>({"pointer-events-none":t,"is-full-screen":n,"is-minimized":e,"i-am-gm":i}),Nae=t=>({rotateble:t}),Rae=(t,n)=>({overlay:t,horizontal:n});function Lae(t,n){if(1&t){const e=Ie();p(0,"button",11),X("dblclick",function(r){return O(e),D(y().notOperaion(r))})("click",function(r){return O(e),D(y().toggleRotate(r))}),p(1,"i",12),x(2,"pivot_table_chart"),m()()}}function Bae(t,n){if(1&t){const e=Ie();p(0,"button",13),X("dblclick",function(r){return O(e),D(y().notOperaion(r))})("click",function(r){return O(e),D(y().toggleMinimize(r))}),p(1,"i",14),x(2),m()()}if(2&t){const e=y();h(),ke("font-size",e.isMinimized?12:14,"px"),h(),Re(e.isMinimized?"crop_din":"minimize")}}function Uae(t,n){if(1&t){const e=Ie();p(0,"button",13),X("dblclick",function(r){return O(e),D(y().notOperaion(r))})("click",function(r){return O(e),D(y().toggleFullScreen(r))}),p(1,"i",14),x(2),m()()}if(2&t){const e=y();h(),ke("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),h(),Re(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function Hae(t,n){if(1&t){const e=Ie();p(0,"button",13),X("dblclick",function(r){return O(e),D(y().notOperaion(r))})("click",function(r){return O(e),D(y().close(r))}),p(1,"i",12),x(2,"close"),m()()}}let V6=(()=>{class t{set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!Ce.myCursor&&Ce.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new Qn,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1092,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(e=null){e&&(e.stopPropagation(),e.preventDefault());const i=this.draggablePanel.nativeElement,r=this.scrollablePanel.nativeElement;if(i.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",r.style.overflowY="hidden",setTimeout(()=>{i.style.transition=null,r.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const o=i.offsetWidth,s=i.offsetHeight;this.isHorizontal?(this.horizontalWidth=o,this.horizontalHeight=s):(this.verticalWidth=o,this.verticalHeight=s)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(e=null){e&&(e.stopPropagation(),e.preventDefault());const i=this.draggablePanel.nativeElement,r=this.scrollablePanel.nativeElement;if(i.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",r.style.overflowY="hidden",setTimeout(()=>{i.style.transition=null,r.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const o=i.offsetWidth,s=i.offsetHeight;this.isHorizontal?(this.horizontalWidth=o,this.horizontalHeight=s):(this.verticalWidth=o,this.verticalHeight=s)}this.isFullScreen=!this.isFullScreen}toggleRotate(e=null){e&&(e.stopPropagation(),e.preventDefault());const i=this.draggablePanel.nativeElement,r=this.scrollablePanel.nativeElement;i.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",r.style.overflowY="hidden",setTimeout(()=>{i.style.transition=null,r.style.overflowY=null},500);const o=i.offsetWidth,s=i.offsetHeight;return this.isHorizontal?(this.isHorizontal=!1,i.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",i.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=o,this.horizontalHeight=s)):(this.isHorizontal=!0,i.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",i.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=o,this.verticalHeight=s)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal),!1}close(e=null){e&&(e.stopPropagation(),e.preventDefault()),this.panelService&&this.panelService.close()}notOperaion(e=null){return e&&(e.stopPropagation(),e.preventDefault()),!1}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(hr))};static#t=this.\u0275cmp=xn({type:t,selectors:[["ui-panel"]],viewQuery:function(i,r){if(1&i&&(Dn(Dae,7),Dn(Oae,7),Dn(Aae,7,ja),Dn(kae,7)),2&i){let o;On(o=An())&&(r.draggablePanel=o.first),On(o=An())&&(r.scrollablePanel=o.first),On(o=An())&&(r.content=o.first),On(o=An())&&(r.titleBar=o.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[xr([bi])],ngContentSelectors:Pae,decls:16,vars:34,consts:[["draggablePanel",""],["titleBar",""],["scrollablePanel",""],["content",""],["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],[1,"title",3,"dblclick"],["style","padding: 0px; height: 14px; margin-top: 4px; margin-left: 5px",3,"dblclick","click",4,"ngIf"],[1,"title-text",3,"ngClass"],[1,"title-button"],[3,"dblclick","click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],[2,"padding","0px","height","14px","margin-top","4px","margin-left","5px",3,"dblclick","click"],[1,"material-icons",2,"font-size","14px"],[3,"dblclick","click"],[1,"material-icons"]],template:function(i,r){if(1&i){const o=Ie();vT(),p(0,"div",4,0)(2,"div",5,1),X("dblclick",function(a){return O(o),D(r.isFullScreen?r.toggleFullScreen(a):r.toggleMinimize(a))}),L(4,Lae,3,0,"button",6),p(5,"div",7),x(6),m(),p(7,"div",8),L(8,Bae,3,3,"button",9)(9,Uae,3,3,"button",9)(10,Hae,3,0,"button",9),m()(),p(11,"div",10,2),yT(13),Ne(14,"div",null,3),m()()}2&i&&(ke("left",r.left,"px")("top",r.top,"px")("width",r.width,"px")("height",r.height,"px"),_("@flyInOut","in")("ngClass",yl(24,Fae,r.isPointerDragging,r.isFullScreen,r.isMinimized&&!r.isFullScreen,r.isGMMode))("resizable.disable",r.isMinimized||r.isFullScreen)("resizable.align",r.isAbleRotateButton?r.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",r.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),h(4),_("ngIf",r.isAbleRotateButton),h(),_("ngClass",Be(29,Nae,r.isAbleRotateButton)),h(),Re(r.panelService.title),h(2),_("ngIf",r.isAbleMinimizeButton),h(),_("ngIf",r.isAbleFullScreenButton),h(),_("ngIf",r.isAbleCloseButton),h(),ke("display",r.isMinimized&&!r.isFullScreen?"none":null),_("ngClass",Cn(31,Rae,r.isAbleRotateButton,r.isHorizontal)))},dependencies:[Fi,ni,TS,Mae],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;user-select:none;display:flex}.title-text[_ngcontent-%COMP%]{align-self:center;flex-grow:1;padding:0 5px;text-overflow:ellipsis;overflow:hidden}.title-text.rotateble[_ngcontent-%COMP%]{padding:3px 0 0;overflow:visible}.title-button[_ngcontent-%COMP%]{align-self:center;flex-shrink:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0!important;top:0!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0d0d0e6,#ffecece6)}.scrollable-panel[_ngcontent-%COMP%]{scrollbar-width:thin}"],data:{animation:[Vn("flyInOut",[Xt("void => *",[jt("100ms ease-out",mn([Pe({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),Pe({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale(0, 0)"}))])])]}})}return t})();const zae=["standImageElement"],Vae=["dialogElement"],jae=(t,n,e,i)=>({"is-can-be-gone":t,"is-ghostly":n,backyard:e,secret:i}),Gae=t=>({transform:t}),Wae=t=>({inverse:t}),$ae=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),j6=(t,n)=>({"black-paint":t,hollow:n}),Yae=t=>({"emote-secret":t}),qae=(t,n,e)=>({"is-can-be-gone":t,"is-ghostly":n,backyard:e}),Zae=(t,n,e)=>({left:t,right:n,"transform-origin":e}),Xae=(t,n,e,i,r,o)=>({"is-can-be-gone":t,"is-ghostly":n,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":o});function Kae(t,n){if(1&t&&(p(0,"div",14),x(1),m()),2&t){const e=y(3);ke("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),_("@fadeAndScaleInOut",void 0)("ngClass",Be(13,Yae,e.isSecret)),h(),Re(e.gameCharacter.text)}}function Qae(t,n){if(1&t){const e=Ie();Me(0),L(1,Kae,2,15,"div",7),p(2,"div",8)(3,"div",9)(4,"div",10)(5,"div",11)(6,"img",12,0),It(8,"safe"),X("load",function(){return O(e),D(y(2).onImageLoad())}),m(),Ne(9,"img",13),It(10,"safe"),m()()()(),De()}if(2&t){const e=y(2);h(),_("ngIf",!e.isBackyard&&e.isImageLoaded&&e.gameCharacter.isEmote),h(),_("ngStyle",Be(22,Gae,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),h(),_("ngClass",Be(24,Wae,e.isApplyImageEffect&&e.gameCharacter.isInverse)),h(),_("ngClass",Dc(26,$ae,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),h(2),ke("display",e.isSpeakable&&e.isSpeaking?"none":"inline-block")("height",e.height>0?e.height+"vh":"auto"),_("src",St(8,16,e.imageUrl,"resourceUrl"),gn)("ngClass",Cn(35,j6,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),h(3),ke("display",e.isSpeakable&&e.isSpeaking?"inline-block":"none")("height",e.height>0?e.height+"vh":"auto"),_("src",St(10,19,e.speakingImageUrl,"resourceUrl"),gn)("ngClass",Cn(38,j6,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}function Jae(t,n){if(1&t){const e=Ie();p(0,"div",5),X("@standInOut.start",function(){return O(e),D(y().refleshImageUrls(!0))})("click",function(){O(e);const r=y();return r.toGhostly(),D(r.toBackyard())}),L(1,Qae,11,41,"ng-container",6),m()}if(2&t){const e=y();ke("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),_("@standInOut",e.groupValue)("ngClass",yl(11,jae,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),h(),_("ngIf",e.gameCharacter&&e.imageUrl&&e.imageUrl.length>0)}}function ele(t,n){if(1&t&&(p(0,"span",15)(1,"b"),x(2),m()()),2&t){const e=y();ke("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),_("ngClass",ma(12,qae,e.isCanBeGone,e.isGhostly,e.isBackyard)),h(2),Re(e.gameCharacter.name)}}function tle(t,n){if(1&t&&(p(0,"span",20),Ne(1,"img",21),It(2,"safe"),m()),2&t){const e=y(2);h(),ke("border-color",e.color),_("src",St(2,3,e.dialogFaceIcon.url,"resourceUrl"),gn)}}function nle(t,n){if(1&t){const e=Ie();p(0,"div",16,1),X("click",function(){O(e);const r=y();return r.toGhostly(),D(r.toBackyard())}),p(2,"p",17),X("@dialogShake.start",function(r){return O(e),D(y().onSpeaking(r))}),L(3,tle,3,6,"span",18),Ne(4,"span",19),It(5,"safe"),m()()}if(2&t){const e=y();ke("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),_("@fadeAndScaleInOut",void 0)("ngStyle",ma(21,Zae,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",ST(25,Xae,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),h(2),_("@dialogShake",e.math.floor(e.dialogText.length/2)),h(),_("ngIf",!e.gameCharacter.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),h(),_("innerHTML",St(5,18,e.dialogText,"html"),eo)}}let Mu=(()=>{class t{static#e=this.isShowStand=!0;static#t=this.isShowNameTag=!0;static#n=this.isCanBeGone=!0;constructor(e){this.ngZone=e,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.isImageLoaded=!1,this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math,this._imageUrl=_n.Empty.url}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&!this.gameCharacter.isEmote&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking||this.refleshSpeakingImageUrl(),this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get imageUrl(){return this._imageUrl}get speakingImageUrl(){return this._speakingImageUrl?this._speakingImageUrl:this._imageUrl}get isShowStand(){return t.isShowStand}get isShowNameTag(){return t.isShowNameTag&&this.isShowName}get isCanBeGone(){return t.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=_e.cr(e.text);const r=_e.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,l=0,u=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let M=a.index-3*l;o.push({base:a[1],ruby:a[2],start:M-u,end:M+a[1].length-u-1}),l++,u+=a[2].length}let f=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;f>200&&(f=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*f+6e3),this.gameCharacter.dialog=e,this.gameCharacter.isEmote=r,l=0;let g=0,v=0,C="",E=o.shift(),w="",T=!1;if(r)this.gameCharacter.text=i;else{const M=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let S=M[l],P=S.length>1;if(S){if(!T&&E&&g>=E.start&&(C+="<ruby>",T=!0,v=0),C+=_e.escapeHtml(S),T){v+=1;let Z=E.ruby;w="<rt>"+_e.escapeHtml(Array.from(Z).slice(0,Math.ceil(Array.from(Z).length*(v/Array.from(E.base).length))).join(""))+"</rt>"}T&&E&&g>=E.end-(P?1:0)&&(C+=w+"</ruby>",T=!1,E=o.shift()),g+=S.length}l+=1,this.gameCharacter.text=C+(T?w+"</ruby>":""),l>=M.length&&clearInterval(this._chatIntervalId)},f)}}get dialog(){return this.gameCharacter?this.gameCharacter.dialog:null}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==_n.Empty.identifier}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?Yt.instance.get(this.dialog.faceIconIdentifier):null}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}ngOnInit(){U.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))}),this.refleshImageUrls()}refleshImageUrls(e=!1){const i=this.standElement.getFirstElementByName("imageIdentifier");if(e||!i||this._imageIdentifier!==i.value){e=!0;const r=this._imageUrl;if(i){const o=Yt.instance.get(i.value);this._imageUrl=o?o.state===Di.COMPLETE?URL.createObjectURL(o.blob):o.url:_n.Empty.url}else this._imageUrl=_n.Empty.url;URL.revokeObjectURL(r),this._imageIdentifier=i&&i.value?i.value.toString():null}this.refleshSpeakingImageUrl(e)}refleshSpeakingImageUrl(e=!0){const i=this.standElement.getFirstElementByName("speakingImageIdentifier");if(e||!i||this._speakingImageIdentifier!==i.value){const r=this._speakingImageUrl;if(i){const o=Yt.instance.get(i.value);this._speakingImageUrl=o?o.state===Di.COMPLETE?URL.createObjectURL(o.blob):o.url:null}else this._speakingImageUrl=null;URL.revokeObjectURL(r),this._speakingImageIdentifier=i&&i.value?i.value.toString():null}}ngOnDestroy(){clearTimeout(this._timeoutId),clearInterval(this._chatIntervalId),URL.revokeObjectURL(this._speakingImageUrl),URL.revokeObjectURL(this._imageUrl)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1}),clearTimeout(this._timeoutId),clearInterval(this._chatIntervalId)}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.isImageLoaded=!0}static#i=this.\u0275fac=function(i){return new(i||t)(F(Sn))};static#r=this.\u0275cmp=xn({type:t,selectors:[["stand-image"]],viewQuery:function(i,r){if(1&i&&(Dn(zae,5),Dn(Vae,5)),2&i){let o;On(o=An())&&(r.standImageElement=o.first),On(o=An())&&(r.dialogElement=o.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["standImageElement",""],["dialogElement",""],["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"click","ngClass"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[2,"transform-origin","center 66%",3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-filter"],["draggable","false",1,"stand-image",3,"load","src","ngClass"],["draggable","false",1,"stand-image",3,"src","ngClass"],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"click","ngStyle","ngClass"],[2,"width","100%"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"]],template:function(i,r){1&i&&(p(0,"div"),L(1,Jae,2,16,"div",2)(2,ele,3,16,"span",3)(3,nle,6,32,"div",4),m()),2&i&&(ke("visibility",r.isShowStand&&r.isImageLoaded?"visible":"hidden")("pointer-events",r.isShowStand?"auto":"none"),h(),_("ngIf",!r.isFarewell&&(r.isVisible||!r.isCanBeGone)),h(),_("ngIf",r.isShowStand&&r.isImageLoaded&&!r.isFarewell&&(r.isVisible||!r.isCanBeGone)&&r.isShowNameTag&&r.gameCharacter&&r.gameCharacter.name),h(),_("ngIf",!r.isFarewell&&r.isImageLoaded&&r.isVisible&&!r.isBackyard&&r.gameCharacter&&r.gameCharacter.text&&!r.gameCharacter.isEmote))},dependencies:[Fi,ni,Zo,fr],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-filter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:#555555e6}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;animation:_ngcontent-%COMP%_chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s;transform-origin:center bottom}@keyframes _ngcontent-%COMP%_chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:50px;height:50px;max-width:50px;max-height:50px;overflow:hidden;left:-24px;top:-32px;margin-right:-16px;margin-bottom:-32px;float:left}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[Vn("standInOut",[Xt("void => *,:increment,:decrement",[jt("132ms cubic-bezier(.21,.97,.75,1.25)",mn([Pe({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),Pe({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),Xt("* => void,:increment,:decrement",[jt("132ms ease-out",mn([Pe({transform:"translateY(0px) scale(1.0)",offset:0}),Pe({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),Vn("dialogShake",[Xt(":increment",[jt("19ms ease",mn([Pe({transform:"translateX(1px)"})])),jt("19ms ease",mn([Pe({transform:"translateX(-1px)"})]))])]),Vn("fadeAndScaleInOut",[Xt("void => *, true => false",[jt("200ms ease-in-out",mn([Pe({transform:"scale3d(0, 0, 0)",opacity:0}),Pe({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),Xt("* => void, true => false",[jt("100ms ease-in-out",Pe({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}})}return t})();class Qs{static#e=this.currentStandImageShowing=new Map;constructor(){}show(n,e,i=null,r=!1){let o=!0;for(const s of Qs.currentStandImageShowing){const a=s[0],l=s[1];if(!l)continue;const u=l.instance;u.isVisible&&n.identifier!=a?u.toGhostly():n.identifier==a&&"graveyard"!=n.location.name?(u.standElement=e,u.color=i||n.chatPalette.color,u.isSecret=r,u.refleshImageUrls(),u.toFront(),o=!1):(u.isFarewell||Mu.isCanBeGone)&&(l.destroy(),Qs.currentStandImageShowing.delete(a))}if(o&&"graveyard"!=n.location.name){const s=Qs.defaultParentViewContainerRef.createComponent(Mu);s.instance.gameCharacter=n,s.instance.standElement=e,s.instance.color=i||n.chatPalette.color,s.instance.isSecret=r,s.instance.refleshImageUrls(),s.instance.toFront(),Qs.currentStandImageShowing.set(n.identifier,s)}}farewell(n){n instanceof cn&&(n=n.identifier);const e=Qs.currentStandImageShowing.get(n);e&&e.instance&&e.instance.toFarewell()}destroy(n,e){n instanceof cn&&(n=n.identifier),e instanceof ht&&(e=e.identifier);for(const i of Qs.currentStandImageShowing){const r=i[1];r&&(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),Qs.currentStandImageShowing.delete(n))}}destroyAll(){for(const n of Qs.currentStandImageShowing){const e=n[0],i=n[1];i&&(i.destroy(),Qs.currentStandImageShowing.delete(e))}}static#t=this.\u0275fac=function(e){return new(e||Qs)};static#n=this.\u0275prov=Wt({token:Qs,factory:Qs.\u0275fac,providedIn:"root"})}const ile=["diceRollTableSelecter"],rle=t=>({"is-hidden":t});function ole(t,n){if(1&t&&(p(0,"option",9),x(1),m()),2&t){const e=n.$implicit;ke("color",""==e.name?"gray":""),ft("value",e.identifier),ft("title",e.name),h(),Re(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function sle(t,n){if(1&t&&(p(0,"div",25),x(1),m()),2&t){const e=y(3);h(),Mi("",e.progresPercent,"%")}}function ale(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",18),X("click",function(){return O(e),D(y(2).upTabIndex())}),x(2,"\u2191"),m(),p(3,"button",18),X("click",function(){return O(e),D(y(2).downTabIndex())}),x(4,"\u2193"),m(),p(5,"div",19)(6,"button",20),X("click",function(){return O(e),D(y(2).save())}),p(7,"div",21)(8,"div",22),x(9,"\u4fdd\u5b58"),m(),L(10,sle,2,1,"div",23),m()(),p(11,"button",24),X("click",function(){return O(e),D(y(2).delete())}),x(12,"\u524a\u9664"),m()(),De()}if(2&t){const e=y(2);h(6),_("disabled",e.isSaveing),h(2),_("ngClass",Be(3,rle,e.isSaveing)),h(2),_("ngIf",e.isSaveing)}}function lle(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",18),X("click",function(){return O(e),D(y(2).restore())}),x(2,"\u5143\u306b\u623b\u3059"),m(),De()}}function cle(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",10)(2,"div",11)(3,"b"),x(4,"name: "),m(),p(5,"input",12),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.diceRollTableName,r)||(o.diceRollTableName=r),D(r)}),m()(),p(6,"div")(7,"span",13)(8,"b"),x(9,"command: "),m(),p(10,"input",14),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.diceRollTableCommand,r)||(o.diceRollTableCommand=r),D(r)}),m()(),p(11,"span",15)(12,"b"),x(13,"dice: "),m(),p(14,"input",16),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.diceRollTableDice,r)||(o.diceRollTableDice=r),D(r)}),m()()()(),p(15,"div")(16,"textarea",17),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.diceRollTableText,r)||(o.diceRollTableText=r),D(r)}),m()(),Ne(17,"hr"),p(18,"div"),L(19,ale,13,5,"ng-container",8)(20,lle,3,0,"ng-container",8),m(),De()}if(2&t){const e=y();h(5),We("ngModel",e.diceRollTableName),$t("disabled",e.isEditable?null:""),h(5),We("ngModel",e.diceRollTableCommand),$t("disabled",e.isEditable?null:""),h(4),We("ngModel",e.diceRollTableDice),$t("disabled",e.isEditable?null:""),h(2),We("ngModel",e.diceRollTableText),$t("disabled",e.isEditable?null:""),h(3),_("ngIf",!e.isDeleted),h(),_("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function ule(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",18),X("click",function(){return O(e),D(y(2).restore())}),x(2,"\u5143\u306b\u623b\u3059"),m(),De()}}function dle(t,n){if(1&t&&(Me(0),p(1,"div",26),x(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),L(3,ule,3,0,"ng-container",8),m(),De()),2&t){const e=y();h(3),_("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let hle=(()=>{class t{get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return Nc.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==dt.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}constructor(e,i,r,o){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=o,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),U.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=dt.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){U.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=dt.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return Nc.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,R.A)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,R.A)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(Nc.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=dr.instance.parseXml(this.selectedDiceRollTableXml);Nc.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(gp,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}static#e=this.\u0275fac=function(i){return new(i||t)(F(hr),F(Ii),F(bi),F(kl))};static#t=this.\u0275cmp=xn({type:t,selectors:[["dice-roll-table-setting"]],viewQuery:function(i,r){if(1&i&&Dn(ile,5),2&i){let o;On(o=An())&&(r.diceRollTableSelecter=o.first)}},decls:13,vars:3,consts:[["diceRollTableSelecter",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","15",2,"width","14em",3,"change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","cursor","help",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModelChange","ngModel"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModelChange","ngModel"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModelChange","ngModel"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModelChange","ngModel"],[3,"click"],[2,"float","right"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1)(1,"div",2)(2,"div")(3,"button",3),X("click",function(){return O(o),D(r.add())}),x(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),m()(),p(5,"select",4,0),X("change",function(){O(o);const a=rn(6);return D(r.onChangeDiceRollTable(a.value))}),L(7,ole,2,5,"option",5),m()(),p(8,"div",6)(9,"button",7),X("click",function(){return O(o),D(r.helpDiceRollTable())}),x(10,"?"),m(),L(11,cle,21,10,"ng-container",8),m()(),L(12,dle,4,1,"ng-container",8)}2&i&&(h(7),_("ngForOf",r.diceRollTables),h(4),_("ngIf",!r.isEmpty&&r.selectedDiceRollTable),h(),_("ngIf",r.isEmpty))},dependencies:[Fi,nr,ni,ya,Ca,Rr,Lr,Tr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}"]})}return t})();const fle=["cutInSelecter"],ple=t=>({blackout:t}),gle=t=>({"red-eye":t}),G6=t=>({"not-specified":t}),mle=(t,n)=>({color:t,"font-weight":n}),_le=t=>({"is-hidden":t});function ble(t,n){if(1&t&&(p(0,"option",11),x(1),m()),2&t){const e=n.$implicit;ke("color",e.isValidAudio?""==e.name?"gray":"":"red"),ft("value",e.identifier),ft("title",e.name),h(),Re((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function vle(t,n){if(1&t&&(p(0,"div",78)(1,"i",79),x(2),m()()),2&t){const e=y(2);h(),am(e.isShowHideImages?"red-eye":"grow"),h(),Re(e.isShowHideImages?"visibility":"visibility_off")}}function yle(t,n){if(1&t){const e=Ie();p(0,"button",38),X("click",function(){return O(e),D(y(3).openModal())}),p(1,"b"),x(2,"\u753b\u50cf\u5909\u66f4"),m()()}}function Cle(t,n){if(1&t&&(p(0,"div",80),L(1,yle,3,0,"button",81),m()),2&t){const e=y(2);h(),_("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function xle(t,n){if(1&t&&(p(0,"div",82)(1,"i",83),x(2),m()()),2&t){const e=y(2);h(2),Re(e.cutInPlayListId?"featured_play_list":"movie")}}function wle(t,n){1&t&&(Me(0),x(1,"\uff08\u3042\u306a\u305f\uff09"),De())}function Ele(t,n){if(1&t&&(p(0,"option",84),x(1),L(2,wle,2,0,"ng-container",10),m()),2&t){const e=n.$implicit,i=y(2);ke("color",e.color),ft("value",e.identifier),h(),Mi("",e.name," "),h(),_("ngIf",e===i.myPeer)}}function Tle(t,n){if(1&t&&(p(0,"option",85),x(1),m()),2&t){const e=n.$implicit;ft("value",e.identifier),h(),Re(e.name)}}function Ile(t,n){1&t&&(p(0,"span",50)(1,"i",88),x(2,"check"),m(),p(3,"span",89),x(4,"Link OK"),m()())}function Sle(t,n){if(1&t&&(p(0,"span",90),Ne(1,"i",91),p(2,"span",92),x(3,"\u26a0\ufe0fLink NG:"),m(),x(4),m()),2&t){const e=y(3);h(4),Mi(" ",e.cutInAudioFileName,"")}}function Mle(t,n){if(1&t&&(Me(0),L(1,Ile,5,0,"span",86)(2,Sle,5,1,"span",87),De()),2&t){const e=y(2);h(),_("ngIf",e.isValidAudio),h(),_("ngIf",!e.isValidAudio)}}function Dle(t,n){if(1&t&&(p(0,"div",98),x(1),m()),2&t){const e=y(3);h(),Mi("",e.progresPercent,"%")}}function Ole(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",38),X("click",function(){return O(e),D(y(2).upTabIndex())}),x(2,"\u2191"),m(),p(3,"button",38),X("click",function(){return O(e),D(y(2).downTabIndex())}),x(4,"\u2193"),m(),p(5,"div",20)(6,"button",93),X("click",function(){return O(e),D(y(2).save())}),p(7,"div",94)(8,"div",95),x(9,"\u4fdd\u5b58"),m(),L(10,Dle,2,1,"div",96),m()(),p(11,"button",97),X("click",function(){return O(e),D(y(2).delete())}),x(12,"\u524a\u9664"),m()(),De()}if(2&t){const e=y(2);h(6),_("disabled",e.isSaveing),h(2),_("ngClass",Be(3,_le,e.isSaveing)),h(2),_("ngIf",e.isSaveing)}}function Ale(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",38),X("click",function(){return O(e),D(y(2).restore())}),x(2,"\u5143\u306b\u623b\u3059"),m(),De()}}function kle(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",12)(2,"div")(3,"div",13),X("dblclick",function(){O(e);const r=y();return D(!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal())}),L(4,vle,3,3,"div",14)(5,Cle,2,1,"div",15)(6,xle,3,1,"div",16),Ne(7,"img",17),It(8,"safe"),m()(),p(9,"div",18)(10,"div",19)(11,"div",20)(12,"label",21)(13,"input",22),X("click",function(r){return O(e),D(y().onShowHiddenImages(r))}),m(),p(14,"i",23),x(15),m()()()(),p(16,"div",24)(17,"b",25),x(18,"Name: "),m(),p(19,"input",26),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInName,r)||(o.cutInName=r),D(r)}),m(),p(20,"b",27),x(21,"Tag: "),m(),p(22,"input",28),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInTag,r)||(o.cutInTag=r),D(r)}),m()(),p(23,"div",29)(24,"b",25),x(25,"Duration (0=\u7121\u5236\u9650): "),m(),p(26,"input",30),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInDuration,r)||(o.cutInDuration=r),D(r)}),m(),p(27,"b",31),x(28,"sec."),m()(),p(29,"div",24)(30,"b",25),x(31,"Cut In: "),m(),p(32,"select",32),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInType,r)||(o.cutInType=r),D(r)}),p(33,"option",33),x(34,"\u5373\u6642\u51fa\u73fe"),m(),p(35,"option",33),x(36,"\u6d6e\u304d\u51fa\u308b"),m(),p(37,"option",33),x(38,"\u98db\u3073\u51fa\u3059"),m(),p(39,"option",33),x(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),m(),p(41,"option",33),x(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),m()(),p(43,"label",34)(44,"input",35),X("click",function(){O(e);const r=y();return D(r.borderStyle=0==r.borderStyle?1:0)}),m(),p(45,"b"),x(46,"\u67a0\u3042\u308a"),m()()(),p(47,"div",24)(48,"b",25),x(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),m(),Ne(50,"br"),p(51,"textarea",36),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInCond,r)||(o.cutInCond=r),D(r)}),m()()()(),p(52,"div",37)(53,"div")(54,"button",38),X("click",function(){return O(e),D(y().testCutIn())}),p(55,"b"),x(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),p(57,"sup",39),x(58,"*"),m()()(),p(59,"span",40)(60,"button",41),X("click",function(){return O(e),D(y().playCutIn())}),p(61,"b")(62,"i",42),x(63,"play_arrow"),m(),x(64,"\u518d\u751f"),m()(),p(65,"button",43),X("click",function(){return O(e),D(y().stopCutIn())}),p(66,"b")(67,"i",42),x(68,"stop"),m(),x(69,"\u505c\u6b62"),m()(),p(70,"span",44),x(71," \u27a1 "),p(72,"select",45),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.sendTo,r)||(o.sendTo=r),D(r)}),p(73,"option",46),x(74,"\u5168\u54e1"),m(),L(75,Ele,3,5,"option",47),m()()()(),p(76,"div",48)(77,"div")(78,"b",49),x(79,"\u4f4d\u7f6e"),m(),p(80,"label",50)(81,"input",51),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInIsPreventOutBounds,r)||(o.cutInIsPreventOutBounds=r),D(r)}),m(),p(82,"b"),x(83,"\u898b\u5207\u308c\u9632\u6b62"),m()()(),p(84,"div",52)(85,"div",53)(86,"div",54)(87,"b"),x(88,"PosX: "),m()(),p(89,"div",55)(90,"input",56),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInPosX,r)||(o.cutInPosX=r),D(r)}),m()(),p(91,"div",57)(92,"input",58),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInPosX,r)||(o.cutInPosX=r),D(r)}),m(),p(93,"b",24),x(94,"%"),m()()(),p(95,"div",53)(96,"div",54)(97,"b"),x(98,"PosY: "),m()(),p(99,"div",55)(100,"input",59),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInPosY,r)||(o.cutInPosY=r),D(r)}),m()(),p(101,"div",57)(102,"input",58),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInPosY,r)||(o.cutInPosY=r),D(r)}),m(),p(103,"b",24),x(104,"%"),m()()()(),p(105,"div",60)(106,"b"),x(107,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),m(),p(108,"input",58),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInZIndex,r)||(o.cutInZIndex=r),D(r)}),m(),p(109,"label",50)(110,"input",61),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInIsFrontOfStand,r)||(o.cutInIsFrontOfStand=r),D(r)}),m(),p(111,"b"),x(112,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),m()()()(),p(113,"div",48)(114,"div")(115,"b",49),x(116,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),m()(),p(117,"div",62)(118,"div",53)(119,"div",63)(120,"b"),x(121,"Width (0=\u6307\u5b9a\u306a\u3057): "),m()(),p(122,"div",64)(123,"input",65),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInWidth,r)||(o.cutInWidth=r),D(r)}),m()(),p(124,"div",57)(125,"input",58),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInWidth,r)||(o.cutInWidth=r),D(r)}),m(),p(126,"b",24),x(127,"%"),m()()(),p(128,"div",53)(129,"div",63)(130,"b"),x(131,"Height (0=\u6307\u5b9a\u306a\u3057): "),m()(),p(132,"div",64)(133,"input",66),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInHeight,r)||(o.cutInHeight=r),D(r)}),m()(),p(134,"div",57)(135,"input",58),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInHeight,r)||(o.cutInHeight=r),D(r)}),m(),p(136,"b",24),x(137,"%"),m()()()(),p(138,"div",60)(139,"b"),x(140,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),m(),p(141,"select",67),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.objectFitType,r)||(o.objectFitType=r),D(r)}),p(142,"option",33),x(143,"\u4f38\u7e2e\u3059\u308b"),m(),p(144,"option",33),x(145,"\u5207\u308a\u53d6\u308b"),m()()()(),p(146,"div",48)(147,"div")(148,"b",49),x(149,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),m(),p(150,"label",50)(151,"input",68),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInSEIsLoop,r)||(o.cutInSEIsLoop=r),D(r)}),m(),p(152,"b"),x(153,"\u7e70\u308a\u8fd4\u3057"),m()()(),p(154,"div",69)(155,"input",70),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInIsVideo,r)||(o.cutInIsVideo=r),D(r)}),m(),p(156,"label",71)(157,"b"),x(158,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),m()(),p(159,"select",72,1),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInAudioIdentifier,r)||(o.cutInAudioIdentifier=r),D(r)}),X("change",function(){O(e);const r=rn(160);return D(y().onAudioFileChange(r.value))}),p(161,"option",46),x(162,"\u52b9\u679c\u97f3\u306a\u3057"),m(),L(163,Tle,2,2,"option",73),m(),L(164,Mle,3,2,"ng-container",10),m(),p(165,"div",69)(166,"input",74),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInIsVideo,r)||(o.cutInIsVideo=r),D(r)}),m(),p(167,"label",71)(168,"b"),x(169,"\u52d5\u753bURL: "),m()(),p(170,"input",75),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.cutInVideoURL,r)||(o.cutInVideoURL=r),D(r)}),m()(),p(171,"div",76)(172,"a",77),X("click",function(){return O(e),D(y().openYouTubeTerms())}),x(173,"YouTube \u5229\u7528\u898f\u7d04"),m()()()(),Ne(174,"hr"),p(175,"div"),L(176,Ole,13,5,"ng-container",10)(177,Ale,3,0,"ng-container",10),m(),De()}if(2&t){const e=y();h(4),_("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),h(),_("ngIf",e.isEditable),h(),_("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),h(),_("ngClass",Be(141,ple,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",St(8,138,e.cutInImageUrl,"resourceUrl"),gn),h(6),ft("checked",e.isShowHideImages?"checked":""),h(),_("ngClass",Be(143,gle,e.isShowHideImages)),h(),Re(e.isShowHideImages?"visibility":"visibility_off"),h(4),We("ngModel",e.cutInName),$t("disabled",e.isEditable?null:""),h(3),We("ngModel",e.cutInTag),$t("disabled",e.isEditable?null:""),h(4),We("ngModel",e.cutInDuration),$t("disabled",!e.isEditable||e.isPlaying?"":null),h(6),We("ngModel",e.cutInType),$t("disabled",e.isEditable?null:""),h(),_("value",-1)("selected",-1==e.cutInType),h(2),_("value",0)("selected",0==e.cutInType),h(2),_("value",1)("selected",1==e.cutInType),h(2),_("value",2)("selected",2==e.cutInType),h(2),_("value",3)("selected",3==e.cutInType),h(2),ke("cursor",e.isEditable?"pointer":"default"),h(),_("checked",1==e.borderStyle),$t("disabled",e.isEditable?null:""),h(7),We("ngModel",e.cutInCond),$t("disabled",e.isEditable?null:""),h(3),$t("disabled",e.isEditable?null:""),h(6),$t("disabled",e.isEditable?null:""),h(5),$t("disabled",e.isEditable?null:""),h(7),We("ngModel",e.sendTo),_("ngClass",Be(145,G6,""==e.sendTo))("ngStyle",Cn(147,mle,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),h(3),_("ngForOf",e.otherPeers),h(5),ke("cursor",e.isEditable?"pointer":"default"),h(),We("ngModel",e.cutInIsPreventOutBounds),_("checked",e.cutInIsPreventOutBounds)("value",!0),$t("disabled",!e.isEditable||e.cutInVideoId?"":null),h(9),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.cutInPosX),_("title",e.cutInPosX+"%"),$t("disabled",e.isEditable?null:""),h(2),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.cutInPosX),$t("disabled",e.isEditable?null:""),h(8),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.cutInPosY),_("title",e.cutInPosY+"%"),$t("disabled",e.isEditable?null:""),h(2),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.cutInPosY),$t("disabled",e.isEditable?null:""),h(6),ft("min",-e.maxSize),ft("max",e.maxSize),We("ngModel",e.cutInZIndex),$t("disabled",!e.isEditable||e.cutInVideoId?"":null),h(2),We("ngModel",e.cutInIsFrontOfStand),_("checked",e.cutInIsFrontOfStand)("value",!0),$t("disabled",!e.isEditable||e.cutInVideoId?"":null),h(13),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.cutInWidth),_("title",e.cutInWidth?e.cutInWidth+"%":"\u6307\u5b9a\u306a\u3057"),$t("disabled",e.isEditable?null:""),h(2),ft("min",e.minSize),ft("max",2*e.maxSize),We("ngModel",e.cutInWidth),$t("disabled",e.isEditable?null:""),h(8),ft("min",e.minSize),ft("max",e.maxSize),We("ngModel",e.cutInHeight),_("title",e.cutInHeight?e.cutInHeight+"%":"\u6307\u5b9a\u306a\u3057"),$t("disabled",e.isEditable?null:""),h(2),ft("min",e.minSize),ft("max",2*e.maxSize),We("ngModel",e.cutInHeight),$t("disabled",e.isEditable?null:""),h(6),We("ngModel",e.objectFitType),$t("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),h(),_("value",0)("selected",0==e.objectFitType),h(2),_("value",1)("selected",1==e.objectFitType),h(6),ke("cursor",e.isEditable?"pointer":"default"),h(),We("ngModel",e.cutInSEIsLoop),_("checked",e.cutInSEIsLoop)("value",!0),$t("disabled",!e.isEditable||e.isPlaying?"":null),h(4),no("name","",e.panelId,"-media"),no("id","",e.panelId,"-media-sound"),We("ngModel",e.cutInIsVideo),_("checked",!e.cutInIsVideo)("value",!1),$t("disabled",!e.isEditable||e.isPlaying?"":null),h(),ke("cursor",e.isEditable?"pointer":"default"),no("for","",e.panelId,"-media-sound"),h(3),ke("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),We("ngModel",e.cutInAudioIdentifier),_("ngClass",Be(150,G6,""==e.cutInAudioIdentifier)),$t("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),h(4),_("ngForOf",e.audios),h(),_("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),h(2),no("name","",e.panelId,"-media"),no("id","",e.panelId,"-media-video"),We("ngModel",e.cutInIsVideo),_("checked",e.cutInIsVideo)("value",!0)("disabled",!e.isEditable||e.isPlaying?"":null),h(),ke("cursor",e.isEditable?"pointer":"default"),no("for","",e.panelId,"-media-video"),h(3),We("ngModel",e.cutInVideoURL),_("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),h(6),_("ngIf",!e.isDeleted),h(),_("ngIf",e.isDeleted&&e.selectedCutInXml)}}function Ple(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",38),X("click",function(){return O(e),D(y(2).restore())}),x(2,"\u5143\u306b\u623b\u3059"),m(),De()}}function Fle(t,n){if(1&t&&(Me(0),p(1,"div",99),x(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),L(3,Ple,3,0,"ng-container",10),m(),De()),2&t){const e=y();h(3),_("ngIf",e.isDeleted&&e.selectedCutInXml)}}let Nle=(()=>{class t{get cutIns(){return Lc.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==dt.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&Yt.instance.get(this.selectedCutIn.imageIdentifier)||_n.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:_n.Empty.url}get isPlaying(){return!!this.selectedCutIn&&GC.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return Ce.myCursor}get otherPeers(){return[Ce.myCursor,...xt.peers.filter(e=>e.isOpen).map(e=>Ce.findByPeerId(e.peerId))].filter(e=>e)}get myColor(){return Ce.myCursor&&Ce.myCursor.color&&Ce.myCursor.color!=Ce.CHAT_TRANSPARENT_COLOR?Ce.myCursor.color:Ce.CHAT_DEFAULT_COLOR}get sendToColor(){let e=dt.instance.get(this.sendTo);return e instanceof Ce?e.color:Ce.CHAT_DEFAULT_COLOR}get audios(){return Jt.instance.audios.filter(e=>!e.isHidden)}constructor(e,i,r,o,s,a){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=o,this.saveDataService=s,this.chatMessageService=a,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),U.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=Il.k.generateUuid()}ngAfterViewInit(){queueMicrotask(()=>{this.cutIns.length>0&&(this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0)})}ngOnDestroy(){U.unregister(this)}onChangeCutIn(e){this.selectedCutIn=dt.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return Lc.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,R.A)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){this.selectedCutIn&&(U.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=dr.instance.parseXml(this.selectedCutInXml);Lc.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=li.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(Ou,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Mr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:Ce.myCursor.peerId};if(i.secret){const r=dt.instance.get(this.sendTo);r&&(r.peerId!=Ce.myCursor.peerId&&U.call("PLAY_CUT_IN",i,r.peerId),U.call("PLAY_CUT_IN",i,Ce.myCursor.peerId))}else U.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:Ce.myCursor.peerId};if(e.secret){const i=dt.instance.get(this.sendTo);i&&(i.peerId!=Ce.myCursor.peerId&&U.call("STOP_CUT_IN",e,i.peerId),U.call("STOP_CUT_IN",e,Ce.myCursor.peerId))}else U.call("STOP_CUT_IN",e)}testCutIn(){this.selectedCutIn&&queueMicrotask(()=>{U.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=Jt.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(xa,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(gp,{left:e.x,top:e.y,width:600,height:680});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\u307e\u305f\u3001\u4ed6\u306eBCDice\u3092\u5229\u7528\u3059\u308b\u30aa\u30f3\u30e9\u30a4\u30f3\u30bb\u30c3\u30b7\u30e7\u30f3\u30c4\u30fc\u30eb\u3068\u306e\u4e92\u63db\u6027\u306e\u305f\u3081\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u4e21\u5074\u306b\u30b9\u30da\u30fc\u30b9\u304c\u5165\u3063\u305f \u201c \uff1e \u201d \u3068 \u201c \u2192 \u201d \u3092\u540c\u5024\u3068\u307f\u306a\u3057\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${p5.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}static#e=this.\u0275fac=function(i){return new(i||t)(F(io),F(hr),F(Ii),F(bi),F(kl),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["app-cut-in-setting"]],viewQuery:function(i,r){if(1&i&&Dn(fle,5),2&i){let o;On(o=An())&&(r.cutInSelecter=o.first)}},decls:14,vars:3,consts:[["cutInSelecter",""],["audioSelect",""],[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin","0px 0px 2px 0px","font-size","smaller",3,"click"],["size","15",2,"width","12em",3,"change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[2,"cursor","help",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],["draggable","false",2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModelChange","ngModel"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModelChange","ngModel"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"click","checked"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModelChange","ngModel"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[3,"click"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModelChange","ngModel","ngClass","ngStyle"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModelChange","ngModel","checked","value"],[2,"margin-left","1em","display","table","width","65%"],[2,"display","table-row"],[2,"display","table-cell","width","3.5em"],[2,"display","table-cell","width","calc(100% - 9.5em)"],["type","range","name","cutInPosX",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],[2,"display","table-cell","width","6em","text-align","right"],["type","number",2,"width","3.5em",3,"ngModelChange","ngModel","min","max"],["type","range","name","cutInPosY",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],[2,"margin-left","1em"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModelChange","ngModel","checked","value"],[2,"margin-left","1em","display","table","width","90%"],[2,"display","table-cell","width","11.5em"],[2,"display","table-cell","width","calc(100% - 15.5em)"],["type","range","name","cutInWidth",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],["type","range","name","cutIHeight",2,"width","100%",3,"ngModelChange","ngModel","title","min","max"],[3,"ngModelChange","ngModel"],["name","cutInSEIsLoop","type","checkbox",3,"ngModelChange","ngModel","checked","value"],[2,"padding-left","1em"],["type","radio",3,"ngModelChange","name","id","ngModel","checked","value"],[3,"for"],[3,"ngModelChange","change","ngModel","ngClass"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","radio",3,"ngModelChange","name","id","ngModel","checked","value","disabled"],["type","text",2,"width","24em",3,"ngModelChange","ngModel","disabled"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",2)(1,"div",3)(2,"div")(3,"button",4),X("click",function(){return O(o),D(r.add())}),x(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),m()(),p(5,"select",5,0),X("change",function(){O(o);const a=rn(6);return D(r.onChangeCutIn(a.value))}),L(7,ble,2,5,"option",6),m()(),p(8,"div",7)(9,"div",8)(10,"button",9),X("click",function(){return O(o),D(r.helpCutIn())}),x(11,"?"),m()(),L(12,kle,178,152,"ng-container",10),m()(),L(13,Fle,4,1,"ng-container",10)}2&i&&(h(7),_("ngForOf",r.cutIns),h(5),_("ngIf",!r.isEmpty&&r.selectedCutIn),h(),_("ngIf",r.isEmpty))},dependencies:[Fi,nr,ni,Zo,ya,Ca,Rr,Xl,Kl,Wa,wl,Nh,Lr,pd,fd,Tr,fr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]})}return t})();function W6(t){return new Zi(n=>{xl(t()).subscribe(n)})}function Gx(t,n,e=1/0){return Rt(n)?Gx((i,r)=>jo((o,s)=>n(i,o,r,s))(xl(t(i,r))),e):("number"==typeof n&&(e=n),ko((i,r)=>function Lle(t,n,e,i,r,o,s,a){const l=[];let u=0,f=0,g=!1;const v=()=>{g&&!l.length&&!u&&n.complete()},C=w=>u<i?E(w):l.push(w),E=w=>{o&&n.next(w),u++;let T=!1;xl(e(w,f++)).subscribe(mo(n,M=>{r?.(M),o?C(M):n.next(M)},()=>{T=!0},void 0,()=>{if(T)try{for(u--;l.length&&u<i;){const M=l.shift();s?Ah(n,s,()=>E(M)):E(M)}v()}catch(M){n.error(M)}}))};return t.subscribe(mo(n,C,()=>{g=!0,v()})),()=>{a?.()}}(i,r,t,e)))}const Ble=["addListener","removeListener"],Ule=["addEventListener","removeEventListener"],Hle=["on","off"];function Wx(t,n,e,i){if(Rt(e)&&(i=e,e=void 0),i)return Wx(t,n,e).pipe(TI(i));const[r,o]=function jle(t){return Rt(t.addEventListener)&&Rt(t.removeEventListener)}(t)?Ule.map(s=>a=>t[s](n,a,e)):function zle(t){return Rt(t.addListener)&&Rt(t.removeListener)}(t)?Ble.map($6(t,n)):function Vle(t){return Rt(t.on)&&Rt(t.off)}(t)?Hle.map($6(t,n)):[];if(!r&&xI(t))return Gx(s=>Wx(s,n,e))(xl(t));if(!r)throw new TypeError("Invalid event target");return new Zi(s=>{const a=(...l)=>s.next(1<l.length?l:l[0]);return r(a),()=>o(a)})}function $6(t,n){return e=>i=>t[e](n,i)}function Y6(t=1/0){return Gx(Wc,t)}function q6(...t){return function Gle(){return Y6(1)}()(mC(t,EI(t)))}const Xm=new Zi(ia),k3=new Zi(t=>t.complete());function Z6(...t){const n=EI(t),e=function cY(t,n){return"number"==typeof wI(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?xl(i[0]):Y6(e)(mC(i,n)):k3}function sv(t,n){return ko((e,i)=>{let r=0;e.subscribe(mo(i,o=>t.call(n,o,r++)&&i.next(o)))})}class Yle extends Zi{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,fc(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,n?.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new qn;const e=this.getSubject();n.add(this.source.subscribe(mo(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=qn.EMPTY)}return n}refCount(){return function $le(){return ko((t,n)=>{let e=null;t._refCount++;const i=mo(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,o=e;e=null,r&&(!o||r===o)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}()(this)}}const Zle={connector:()=>new ra};function X6(t,n=Zle){const{connector:e}=n;return ko((i,r)=>{const o=e();xl(t(function qle(t){return new Zi(n=>t.subscribe(n))}(o))).subscribe(r),r.add(i.subscribe(o))})}function tf(t){return t<=0?()=>k3:ko((n,e)=>{let i=0;n.subscribe(mo(e,r=>{++i<=t&&(e.next(r),t<=i&&e.complete())}))})}class Jle extends qn{constructor(n,e){super()}schedule(n,e=0){return this}}const $x={setInterval(t,n,...e){const{delegate:i}=$x;return i?.setInterval?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=$x;return(n?.clearInterval||clearInterval)(t)},delegate:void 0},K6={now:()=>(K6.delegate||Date).now(),delegate:void 0};class av{constructor(n,e=av.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}av.now=K6.now;const Q6=new class tce extends av{constructor(n,e=av.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}(class ece extends Jle{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(o,this.id,e),this}requestAsyncId(n,e,i=0){return $x.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&$x.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,i=!1;try{this.work(n)}catch(o){i=!0,r=o||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,dn(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),nce=Q6;function J6(t,n){return n?e=>q6(n.pipe(tf(1),function ice(){return ko((t,n)=>{t.subscribe(mo(n,ia))})}()),e.pipe(J6(t))):Gx((e,i)=>xl(t(e,i)).pipe(tf(1),function rce(t){return jo(()=>t)}(e)))}const lv="Service workers are disabled or not supported by this browser";class Yx{constructor(n){if(this.serviceWorker=n,n){const i=Wx(n,"controllerchange").pipe(jo(()=>n.controller)),o=q6(W6(()=>VC(n.controller)),i);this.worker=o.pipe(sv(f=>!!f)),this.registration=this.worker.pipe(Pb(()=>n.getRegistration()));const u=Wx(n,"message").pipe(jo(f=>f.data)).pipe(sv(f=>f&&f.type)).pipe(function Kle(t){return t?n=>X6(t)(n):n=>function Xle(t,n){const e=Rt(t)?t:()=>t;return Rt(n)?X6(n,{connector:e}):i=>new Yle(i,e)}(new ra)(n)}());u.connect(),this.events=u}else this.worker=this.events=this.registration=function lce(t){return W6(()=>function Rle(t,n){const e=Rt(t)?t:()=>t,i=r=>r.error(e());return new Zi(n?r=>n.schedule(i,0,r):i)}(new Error(t)))}(lv)}postMessage(n,e){return this.worker.pipe(tf(1),function Qle(t,n,e){const i=Rt(t)||n||e?{next:t,error:n,complete:e}:t;return i?ko((r,o)=>{var s;null===(s=i.subscribe)||void 0===s||s.call(i);let a=!0;r.subscribe(mo(o,l=>{var u;null===(u=i.next)||void 0===u||u.call(i,l),o.next(l)},()=>{var l;a=!1,null===(l=i.complete)||void 0===l||l.call(i),o.complete()},l=>{var u;a=!1,null===(u=i.error)||void 0===u||u.call(i,l),o.error(l)},()=>{var l,u;a&&(null===(l=i.unsubscribe)||void 0===l||l.call(i)),null===(u=i.finalize)||void 0===u||u.call(i)}))}):Wc}(i=>{i.postMessage({action:n,...e})})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const r=this.waitForOperationCompleted(i),o=this.postMessage(n,e);return Promise.all([o,r]).then(([,s])=>s)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(sv(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(tf(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(sv(e=>e.nonce===n),tf(1),jo(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let eB=(()=>{class t{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,this.pushManager=null,this.subscriptionChanges=new ra,!e.isEnabled)return this.messages=Xm,this.notificationClicks=Xm,void(this.subscription=Xm);this.messages=this.sw.eventsOfType("PUSH").pipe(jo(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(jo(r=>r.data)),this.pushManager=this.sw.registration.pipe(jo(r=>r.pushManager));const i=this.pushManager.pipe(Pb(r=>r.getSubscription()));this.subscription=Z6(i,this.subscriptionChanges)}requestSubscription(e){if(!this.sw.isEnabled||null===this.pushManager)return Promise.reject(new Error(lv));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),o=new Uint8Array(new ArrayBuffer(r.length));for(let s=0;s<r.length;s++)o[s]=r.charCodeAt(s);return i.applicationServerKey=o,this.pushManager.pipe(Pb(s=>s.subscribe(i)),tf(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(tf(1),Pb(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(lv))}decodeBase64(e){return atob(e)}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Yx))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})(),P3=(()=>{class t{get isEnabled(){return this.sw.isEnabled}constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=Xm,void(this.unrecoverable=Xm);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(lv));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(lv));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}static#e=this.\u0275fac=function(i){return new(i||t)(kn(Yx))};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac})}return t})();const tB=new hn("");function cce(t,n,e,i){return()=>{if(!lI(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let r;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)r=e.registrationStrategy();else{const[s,...a]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(s){case"registerImmediately":r=VC(null);break;case"registerWithDelay":r=nB(+a[0]||0);break;case"registerWhenStable":r=a[0]?Z6(iB(t),nB(+a[0])):iB(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(Sn).runOutsideAngular(()=>r.pipe(tf(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(s=>console.error("Service worker registration failed with:",s))))}}function nB(t){return VC(null).pipe(function ace(t,n=Q6){const e=function sce(t=0,n,e=nce){let i=-1;return null!=n&&(E4(n)?e=n:i=n),new Zi(r=>{let o=function oce(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;o<0&&(o=0);let s=0;return e.schedule(function(){r.closed||(r.next(s++),0<=i?this.schedule(void 0,i):r.complete())},o)})}(t,n);return J6(()=>e)}(t))}function iB(t){return t.get(Sh).isStable.pipe(sv(e=>e))}function uce(t,n){return new Yx(lI(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}class F3{}function dce(t,n={}){return function Vu(t){return{\u0275providers:t}}([eB,P3,{provide:tB,useValue:t},{provide:F3,useValue:n},{provide:Yx,useFactory:uce,deps:[F3,gl]},{provide:SP,useFactory:cce,deps:[Ts,tB,F3,gl],multi:!0}])}let hce=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[dce(e,i)]}}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t});static#n=this.\u0275inj=Pa({providers:[eB,P3]})}return t})();const fce=["modalLayer"],pce=(t,n)=>({horizontal:t,vertical:n});function gce(t,n){if(1&t){const e=Ie();p(0,"li",4),X("click",function(){return O(e),D(y().save())}),p(1,"a",5)(2,"div")(3,"i",7),x(4,"sd_storage"),m()(),p(5,"div"),x(6,"\u4fdd\u5b58"),m()()()}}function mce(t,n){if(1&t&&(p(0,"li",16)(1,"a")(2,"div")(3,"i",17),x(4,"sd_storage"),m()(),p(5,"div"),x(6),m()()()),2&t){const e=y();h(6),Mi("",e.progresPercent,"%")}}function _ce(t,n){if(1&t){const e=Ie();p(0,"div",18),X("click",function(){return O(e),D(y().closeImagePreview())}),p(1,"div",19)(2,"i",7),x(3,"close"),m()(),Ne(4,"img",20),It(5,"safe"),m()}if(2&t){const e=y();_("@fadeInOut","in"),h(4),_("src",St(5,2,e.imageUrl,"resourceUrl"),gn)}}let Du=(()=>{class t{static#e=this.imageUrl="";get imageUrl(){return t.imageUrl}get otherPeers(){return[Ce.myCursor,...xt.peers.filter(e=>e.isOpen).map(e=>Ce.findByPeerId(e.peerId))].filter(e=>e)}get isRoom(){return xt.peer?.isRoom}static get noticePlayer(){return t._noticePlayer||(t._noticePlayer=new He,t._noticePlayer.volumeType=Rc.NOTICE),t._noticePlayer}notice(e=pe.puyon){const i=Jt.instance.get(e);i&&i.isReady?(U.unregister(this,"UPDATE_AUDIO_RESOURE"),t.noticePlayer.play(i)):U.register(this).on("UPDATE_AUDIO_RESOURE",-100,r=>{this.notice(e)})}constructor(e,i,r,o,s,a,l,u,f,g,v){var C=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=o,this.chatMessageService=s,this.appConfigService=a,this.saveDataService=l,this.ngZone=u,this.contextMenuService=f,this.standImageService=g,this.cutInService=v,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.noticeIntervalTimer=null,this.ngZone.runOutsideAngular(()=>{wu.instance.initialize(),Bm.instance.initialize(),Lm.instance.initialize(),Um.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),Jo.instance.initialize(),Al.instance.initialize(),Tu.instance.initialize(),new rr("DiceBot",this.chatMessageService).initialize(),rr.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new wp("Jukebox").initialize(),new ze("SoundEffect").initialize(),Al.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),Al.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,Lc.instance.initialize();let S=new yd("SampleDiceRollTable");S.initialize(),S.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",S.command="SAMPLE",S.dice="1d6",S.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",Nc.instance.addDiceRollTable(S);let P=_n.createEmpty("none_icon").toContext();P.url="./assets/images/ic_account_circle_black_24dp_2x.png";let Z=Yt.instance.add(P);li.create(Z.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",P=_n.createEmpty("stand_no_image").toContext(),P.url="./assets/images/nc96424.png";let ee=Yt.instance.add(P);li.create(ee.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9";try{Kn.getItem(He.MAIN_VOLUME_LOCAL_STORAGE_KEY).then(B=>{"number"==typeof B&&0<=B&&B<=1&&(He.volume=B)}),Kn.getItem(He.AUDITION_VOLUME_LOCAL_STORAGE_KEY).then(B=>{"number"==typeof B&&0<=B&&B<=1&&(He.auditionVolume=B)}),Kn.getItem(He.SOUND_EFFECT_VOLUME_LOCAL_STORAGE_KEY).then(B=>{"number"==typeof B&&0<=B&&B<=1&&(He.soundEffectVolume=B)}),Kn.getItem(He.NOTICE_VOLUME_LOCAL_STORAGE_KEY).then(B=>{"number"==typeof B&&0<=B&&B<=1&&(He.noticeVolume=B)}),Kn.getItem(He.MAIN_IS_MUTE_LOCAL_STORAGE_KEY).then(B=>He.isMute=!!B),Kn.getItem(He.AUDITION_IS_MUTE_LOCAL_STORAGE_KEY).then(B=>He.isAuditionMute=!!B),Kn.getItem(He.SOUND_EFFECT_IS_MUTE_LOCAL_STORAGE_KEY).then(B=>He.isSoundEffectMute=!!B),Kn.getItem(He.NOTICE_IS_MUTE_LOCAL_STORAGE_KEY).then(B=>He.isNoticeMute=!!B)}catch(B){console.log(B)}He.resumeAudioContext(),pe.dicePick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,pe.dicePut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,pe.diceRoll1=Jt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,pe.diceRoll2=Jt.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,pe.cardDraw=Jt.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,pe.cardPick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,pe.cardPut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,pe.cardShuffle=Jt.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,pe.piecePick=Jt.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,pe.piecePut=Jt.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,pe.blockPick=Jt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,pe.blockPut=Jt.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,pe.lock=Jt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,pe.unlock=Jt.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,pe.sweep=Jt.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,pe.puyon=Jt.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,pe.surprise=Jt.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,pe.coinToss=Jt.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,pe.selectionStart=Jt.instance.add("./assets/sounds/soundeffect-lab/decision50.mp3").identifier,Jt.instance.get(pe.dicePick).isHidden=!0,Jt.instance.get(pe.dicePut).isHidden=!0,Jt.instance.get(pe.diceRoll1).isHidden=!0,Jt.instance.get(pe.diceRoll2).isHidden=!0,Jt.instance.get(pe.cardDraw).isHidden=!0,Jt.instance.get(pe.cardPick).isHidden=!0,Jt.instance.get(pe.cardPut).isHidden=!0,Jt.instance.get(pe.cardShuffle).isHidden=!0,Jt.instance.get(pe.piecePick).isHidden=!0,Jt.instance.get(pe.piecePut).isHidden=!0,Jt.instance.get(pe.blockPick).isHidden=!0,Jt.instance.get(pe.blockPut).isHidden=!0,Jt.instance.get(pe.lock).isHidden=!0,Jt.instance.get(pe.unlock).isHidden=!0,Jt.instance.get(pe.sweep).isHidden=!0,Jt.instance.get(pe.puyon).isHidden=!0,Jt.instance.get(pe.surprise).isHidden=!0,Jt.instance.get(pe.coinToss).isHidden=!0,Jt.instance.get(pe.sweep).isHidden=!0,Jt.instance.get(pe.selectionStart).isHidden=!0,Ce.createMyCursor().then(()=>{(null==Ce.myCursor.name||""===Ce.myCursor.name)&&(Ce.myCursor.name=Ce.CHAT_DEFAULT_NAME),Ce.myCursor.imageIdentifier||(Ce.myCursor.imageIdentifier=Z.identifier)}),U.register(this).on("UPDATE_GAME_OBJECT",B=>{this.lazyNgZoneUpdate(B.isSendFromSelf)}).on("DELETE_GAME_OBJECT",B=>{this.lazyNgZoneUpdate(B.isSendFromSelf)}).on("UPDATE_SELECTION",B=>{this.lazyNgZoneUpdate(B.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",B=>{B.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",B=>{B.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",B=>{if(console.log("LOAD_CONFIG !!!",B.data),B.data.dice&&B.data.dice.url){const J=B.data.dice.api,le=["A","English","ChineseTraditional","SimplifiedChinese","Korean","Other"];fetch(B.data.dice.url+(1==J?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(se=>se.json()).then(se=>{let fe=B.data.dice.url;rr.apiUrl=fe.endsWith("/")?fe.substring(0,fe.length-1):fe,rr.apiVersion=J,rr.diceBotInfos=[];let Se=(1==J?se.names:se.game_system).filter(ue=>"DiceBot"!=(1==J?ue.system:ue.id)).map(ue=>{let Ue=ue.sort_key&&ue.sort_key.indexOf("\u56fd\u969b\u5316")<0?ue.sort_key:ue.name.normalize("NFKD");for(let Ze of rr.replaceData)Ze[2]&&ue.name===Ze[0]&&(Ue=Ze[1],ue.name=Ze[2]),Ue=Ue.split(Ze[0].normalize("NFKD")).join(Ze[1].normalize("NFKD"));return ue.normalize=Ue.replace(/[\u3041-\u3096]/g,Ze=>String.fromCharCode(Ze.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),ue}).map(ue=>{const Ue=/.+\:(.+)/.exec(1==J?ue.system:ue.id);return ue.lang=Ue?Ue[1]:"A",ue}).sort((ue,Ue)=>le.indexOf(ue.lang)<le.indexOf(Ue.lang)?-1:le.indexOf(ue.lang)>le.indexOf(Ue.lang)?1:ue.normalize==Ue.normalize?0:ue.normalize<Ue.normalize?-1:1);if(rr.diceBotInfos=[],rr.diceBotInfosIndexed=[],rr.diceBotInfos.push(...Se.map(ue=>({id:1==J?ue.system:ue.id,game:ue.name}))),Se.length>0){let ue=Se[0].normalize.substring(0,1),Ue={index:Se[0].normalize.substring(0,1),infos:[]};for(let Ze of Se){let nt="Other"==Ze.lang?"Other":"ChineseTraditional"==Ze.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==Ze.lang?"\ud55c\uad6d\uc5b4":"English"==Ze.lang?"English":"SimplifiedChinese"==Ze.lang?"\u7b80\u4f53\u4e2d\u6587":Ze.normalize.substring(0,1);nt!==ue&&(ue=nt,rr.diceBotInfosIndexed.push(Ue),Ue={index:nt,infos:[]}),Ue.infos.push({id:1==J?Ze.system:Ze.id,game:Ze.name})}rr.diceBotInfosIndexed.push(Ue)}})}console.log("LOAD_CONFIG !!!"),xt.configure(B.data),xt.open()}).on("FILE_LOADED",B=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",B=>{console.log("OPEN_NETWORK",B.data.peerId),Ce.myCursor.peerId=xt.peer.peerId,Ce.myCursor.userId=xt.peer.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",B=>{console.log("NETWORK_ERROR",B.data.peerId);let J=B.data.errorType,le=B.data.errorMessage;this.ngZone.run((0,R.A)(function*(){["peer-unavailable"].includes(J)||(yield C.modalService.open(gp,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:le}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(J)&&(yield C.modalService.open(gp,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),xt.open(),C.isLoggedin=!1))}))}).on("CONNECT_PEER",B=>{B.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,s.sendOperationLog((this.isRoom?xt.peer.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(B.isSendFromSelf)}).on("DISCONNECT_PEER",B=>{this.lazyNgZoneUpdate(B.isSendFromSelf),B.isSendFromSelf&&(this.isLoggedin=!1)}).on("MESSAGE_NORTIFICATION",B=>{Ip.isNoticeOn?(B.data?.isDirect||!this.noticeIntervalTimer)&&(clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=setTimeout(()=>{clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null},100),this.notice()):this.noticeIntervalTimer&&(clearTimeout(this.noticeIntervalTimer),this.noticeIntervalTimer=null)}).on("PLAY_CUT_IN",-1e3,B=>{let J=dt.instance.get(B.data.identifier);this.cutInService.play(J,!!B.data.secret&&B.data.secret,!!B.data.test&&B.data.test,B.data.sender)}).on("STOP_CUT_IN",-1e3,B=>{this.cutInService.stop(B.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,B=>{let J=dt.instance.get(B.data.standIdentifier),le=dt.instance.get(B.data.characterIdentifier);this.standImageService.show(le,J,B.data.color?B.data.color:null,B.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,B=>{this.standImageService.farewell(B.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,B=>{this.standImageService.destroy(B.data.characterIdentifier,B.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,B=>{this.standImageService.destroyAll()}),function bce(){let t=window.navigator.userAgent.toLowerCase();if(t.indexOf("iphone")>-1||t.indexOf("ipad")>-1||t.indexOf("macintosh")>-1&&"ontouchend"in document){let e=document.createElement("style");e.innerHTML="\n      .chrome-smooth-image-trick {\n        transform-style: flat;\n      }\n      ",document.body.appendChild(e)}}()}static#t=this.beforeUnloadProc=e=>{e.stopImmediatePropagation(),e.preventDefault(),e.returnValue=""};ngOnInit(){window.addEventListener("beforeunload",t.beforeUnloadProc)}ngAfterViewInit(){let e;bi.defaultParentViewContainerRef=Ii.defaultParentViewContainerRef=Xo.defaultParentViewContainerRef=Qs.defaultParentViewContainerRef=GC.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(A3,{width:520,height:450,left:100}),this.panelService.open(Ip,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(i=>{switch(i.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${i.version.hash}`),Notification.requestPermission().then(r=>{"granted"===r&&(e=new Notification("Udonarium with Fly",{body:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u4e2d\u3067\u3059\u3002",icon:"card.png"}),e.addEventListener("click",function(o){return o.preventDefault(),o.stopPropagation(),e&&(e.close(),e=null),!1}))});break;case"VERSION_READY":console.log(`Current app version: ${i.currentVersion.hash}`),console.log(`New app version ready for use: ${i.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(Mr,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30c0\u30a6\u30f3\u30ed\u30fc\u30c9\u3057\u307e\u3057\u305f\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",helpHtml:'<b style="color: red">\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002</b>\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002',type:or.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{e&&(e.close(),e=null),window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${i.version.hash}': ${i.error}`)}})}ngOnDestroy(){U.unregister(this),this.noticeIntervalTimer&&clearTimeout(this.noticeIntervalTimer)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=A3;break;case"ChatWindowComponent":i=Ip,r.width=700;break;case"GameTableSettingComponent":i=BL,r={width:610,height:540,left:100};break;case"FileStorageComponent":i=ac,r.width=700;break;case"GameCharacterSheetComponent":i=lc;break;case"JukeboxComponent":i=are,r.height=540;break;case"GameObjectInventoryComponent":i=kie;break;case"DiceRollTableSettingComponent":i=hle,r={width:645,height:475};break;case"CutInSettingComponent":i=Nle,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,R.A)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=0<xt.peer.roomName.length?xt.peer.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&wu.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=[],a=Lc.instance.cutIns;s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===a.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:a.map(l=>({name:`${l.isValidAudio?"":"\u26a0\ufe0f"}${""==l.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":l.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{U.call("PLAY_CUT_IN",{identifier:l.identifier,secret:!1,sender:Ce.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==l.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":l.name)+" \u3092\u518d\u751f\u3057\u305f")}},At,...this.otherPeers.map(u=>({name:u.name+(u===Ce.myCursor?" (\u3042\u306a\u305f)":""),color:u.color,default:!0,action:()=>{u!==Ce.myCursor&&U.call("PLAY_CUT_IN",{identifier:l.identifier,secret:!0,sender:Ce.myCursor.peerId},u.peerId),U.call("PLAY_CUT_IN",{identifier:l.identifier,secret:!0,sender:Ce.myCursor.peerId},Ce.myCursor.peerId)}}))]}))}),s.push(At),s.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a...",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),s.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a...",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(o,s,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)};this.contextMenuService.open(o,[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>U.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>U.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(e){const i=e.target,r=i.getBoundingClientRect(),o={x:window.pageXOffset+r.left+(this.isHorizontal?0:.9*i.clientWidth),y:window.pageYOffset+r.top+(this.isHorizontal?.9*i.clientHeight:0)},s=Mu.isShowStand,a=Mu.isShowNameTag,l=Mu.isCanBeGone;this.contextMenuService.open(o,[{name:(Jo.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{Jo.instance.gridShow=!Jo.instance.gridShow,U.trigger("UPDATE_GAME_OBJECT",Jo.instance.toContext())},checkBox:"check"},{name:(Jo.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{Jo.instance.gridSnap=!Jo.instance.gridSnap},checkBox:"check"},At,{name:(Ip.isNoticeOn?"\u2611":"\u2610")+"\u30c1\u30e3\u30c3\u30c8\u53d7\u4fe1\u6642\u306b\u97f3\u3067\u901a\u77e5",action:()=>{Ip.isNoticeOn=!Ip.isNoticeOn},checkBox:"check"},At,{name:(s?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{Mu.isShowStand=!s},checkBox:"check"},{name:(a?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{Mu.isShowNameTag=!a},level:1,disabled:!Mu.isShowStand,checkBox:"check"},{name:(l?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{Mu.isCanBeGone=!l},level:1,disabled:!Mu.isShowStand,checkBox:"check"},At,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>U.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(Mr,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:or.OK_CANCEL,materialIcon:"all_out",action:()=>{U.trigger("DICE_ALL_OPEN",null)}})}logout(){this.modalService.open(Mr,{title:"\u9000\u51fa\uff0f\u5207\u65ad",text:`\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u65ad\u3057${this.isRoom?"\u3001\u30eb\u30fc\u30e0\u304b\u3089\u9000\u51fa\u3057":""}\u307e\u3059\u3002`,helpHtml:'<b style="color: red">\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002</b>\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58\u304c\u5fc5\u8981\u306a\u3089\u30ad\u30e3\u30f3\u30bb\u30eb\u3057\u3066\u304f\u3060\u3055\u3044\u3002',type:or.OK_CANCEL,materialIcon:"logout",action:()=>{window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}closeImagePreview(){URL.revokeObjectURL(t.imageUrl),t.imageUrl=""}static#n=this.\u0275fac=function(i){return new(i||t)(F(P3),F(Ii),F(bi),F(hr),F(Do),F(jx),F(kl),F(Sn),F(Xo),F(Qs),F(GC))};static#i=this.\u0275cmp=xn({type:t,selectors:[["app-root"]],viewQuery:function(i,r){if(1&i&&Dn(fce,7,ja),2&i){let o;On(o=An())&&(r.modalLayerViewContainerRef=o.first)}},decls:107,vars:15,consts:[["modalLayer",""],["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"rotateEvent","top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],["routerLink","/","routerLinkActive","active",2,"pointer-events","none"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],[1,"networkIndicator"],["class","image-view-background is-fill",3,"click",4,"ngIf"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"],[1,"image-view-background","is-fill",3,"click"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1),Ne(1,"game-table"),m(),p(2,"ui-panel",2),X("rotateEvent",function(a){return O(o),D(r.rotateChange(a))}),p(3,"nav",3)(4,"ul")(5,"li",4),X("click",function(){return O(o),D(r.open("PeerMenuComponent"))}),p(6,"a",5)(7,"div")(8,"i",6),x(9,"people"),m()(),p(10,"div"),x(11,"\u63a5\u7d9a"),m()()(),p(12,"li",4),X("click",function(){return O(o),D(r.open("ChatWindowComponent"))}),p(13,"a",5)(14,"div")(15,"i",6),x(16,"speaker_notes"),m()(),p(17,"div"),x(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),m()()(),p(19,"li",4),X("click",function(){return O(o),D(r.open("GameTableSettingComponent"))}),p(20,"a",5)(21,"div")(22,"i",6),x(23,"layers"),m()(),p(24,"div"),x(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),m()()(),p(26,"li",4),X("click",function(){return O(o),D(r.open("FileStorageComponent"))}),p(27,"a",5)(28,"div")(29,"i",6),x(30,"photo_library"),m()(),p(31,"div"),x(32,"\u753b\u50cf"),m()()(),p(33,"li",4),X("click",function(){return O(o),D(r.open("JukeboxComponent"))}),p(34,"a",5)(35,"div")(36,"i",7),x(37,"queue_music"),m()(),p(38,"div"),x(39,"\u97f3\u697d"),m()()(),p(40,"li",4),X("click",function(a){return O(o),D(r.toolBox(a))}),p(41,"a",8)(42,"div")(43,"i",7),x(44,"build"),m()(),p(45,"div"),x(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),m()()(),p(47,"li",4),X("click",function(){return O(o),D(r.open("GameObjectInventoryComponent"))}),p(48,"a",5)(49,"div")(50,"i",6),x(51,"folder_shared"),m()(),p(52,"div"),x(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),m()()(),p(54,"li",4),X("click",function(){return O(o),D(r.diceAllOpne())}),p(55,"a",5)(56,"div")(57,"i",6),x(58,"all_out"),m()(),p(59,"div"),x(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),m()()(),p(61,"li",4),X("click",function(a){return O(o),D(r.standSetteings(a))}),p(62,"a",8)(63,"div")(64,"i",6),x(65,"how_to_reg"),m()(),p(66,"div"),x(67,"\u500b\u4eba\u8a2d\u5b9a"),p(68,"sup",9),x(69,"*"),m()()()(),p(70,"li",4),X("click",function(a){return O(o),D(r.resetPointOfView(a))}),p(71,"a",8)(72,"div")(73,"i",6),x(74,"remove_red_eye"),m()(),p(75,"div"),x(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),p(77,"sup",9),x(78,"*"),m()()()(),p(79,"li")(80,"a",5)(81,"label")(82,"div")(83,"i",7),x(84,"open_in_browser"),m()(),p(85,"div"),x(86,"ZIP\u8aad\u8fbc"),m(),p(87,"input",10),X("change",function(a){return O(o),D(r.handleFileSelect(a))}),m()()()(),L(88,gce,7,0,"li",11)(89,mce,7,1,"li",12),p(90,"li",4),X("click",function(){return O(o),D(r.logout())}),p(91,"a",5)(92,"label")(93,"div")(94,"i",7),x(95,"logout"),m()(),p(96,"div"),x(97,"\u9000\u51fa\uff0f\u5207\u65ad"),m()()()()(),p(98,"div",13)(99,"b")(100,"sup",9),x(101,"*"),m(),x(102,"\u306f\u81ea\u5206\u306e\u307f"),m()()()(),Ne(103,"div",null,0)(105,"network-indicator",14),L(106,_ce,6,5,"div",15)}2&i&&(h(2),_("top",0)("left",0)("width",100)("height",765)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),h(),_("ngClass",Cn(12,pce,r.isHorizontal,!r.isHorizontal)),h(85),_("ngIf",!r.isSaveing),h(),_("ngIf",r.isSaveing),h(17),_("ngIf",r.imageUrl))},styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer;white-space:nowrap}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0;left:0;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_vibration .2s infinite}@keyframes _ngcontent-%COMP%_vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}.vertical[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{overflow-y:hidden;text-overflow:ellipsis}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:100000000000;position:absolute;inset:0;width:100%;height:100%;box-sizing:border-box;overflow:visible;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;display:flex;justify-content:center;align-items:center}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{display:block;max-width:calc(100% - 32px);max-height:calc(100% - 32px);min-width:100px;min-height:120px;box-sizing:border-box;object-fit:contain}"],data:{animation:[Vn("fadeInOut",[Xt("void => *",[jt("100ms ease-out",mn([Pe({opacity:0,offset:0}),Pe({opacity:1,offset:1})]))]),Xt("* => void",[jt("100ms ease-in",mn([Pe({opacity:1,offset:0}),Pe({opacity:0,offset:1})]))])])]}})}return t})();bi.UIPanelComponentClass=V6,Xo.ContextMenuComponentClass=Zte,Ii.ModalComponentClass=ure;const rB=t=>({"red-eye":t}),vce=t=>({selecter:t}),yce=t=>({selected:t});function Cce(t,n){1&t&&Ne(0,"badge",14),2&t&&_("count",y(2).countImagesHasWord(null))("@.disabled",!0)}function xce(t,n){if(1&t){const e=Ie();p(0,"label")(1,"input",27),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.searchNoTagImage,r)||(o.searchNoTagImage=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.searchNoTagImage=!!r.searchNoTagImage)}),m(),p(2,"div",28)(3,"s"),x(4,"No Tag"),m(),L(5,Cce,1,2,"badge",29),m()()}if(2&t){const e=y();h(),ft("checked",e.searchNoTagImage?"checked":""),We("ngModel",e.searchNoTagImage),h(4),_("ngIf",e.countImagesHasWord(null)>0)}}function wce(t,n){if(1&t&&Ne(0,"badge",14),2&t){const e=y().$implicit;_("count",y().countImagesHasWord(e))("@.disabled",!0)}}function Ece(t,n){if(1&t){const e=Ie();p(0,"label")(1,"input",30),X("change",function(){const r=O(e).$implicit;return D(y().onSelectedWord(r))}),m(),p(2,"div"),x(3),L(4,wce,1,2,"badge",29),m()()}if(2&t){const e=n.$implicit,i=y();h(),ft("value",e),_("checked",i.searchWords.includes(e)),h(2),Re(e),h(),_("ngIf",i.countImagesHasWord(e)>0)}}function Tce(t,n){1&t&&ti(0)}function Ice(t,n){if(1&t&&(p(0,"label",44),x(1),m()),2&t){const e=y().$implicit;h(),Re(e)}}function Sce(t,n){1&t&&(p(0,"span",45),x(1,"\u2026"),m())}function Mce(t,n){if(1&t&&(Me(0),L(1,Ice,2,1,"label",42)(2,Sce,2,0,"span",43),De()),2&t){const e=n.index;h(),_("ngIf",e<6),h(),_("ngIf",6==e)}}function Dce(t,n){if(1&t&&(p(0,"div",41),L(1,Mce,3,2,"ng-container",16),m()),2&t){const e=y().$implicit,i=y();h(),_("ngForOf",i.getTagWords(e))}}function Oce(t,n){1&t&&(p(0,"div",41)(1,"s",46),x(2,"No Tag"),m()())}function Ace(t,n){1&t&&(p(0,"div",47)(1,"i",48),x(2,"visibility"),m()())}function kce(t,n){if(1&t){const e=Ie();p(0,"img",49),It(1,"safe"),X("click",function(){O(e);const r=y().$implicit;return D(y().onSelectedFile(r))}),m()}if(2&t){const e=y().$implicit;_("src",St(1,2,e.url,"resourceUrl"),gn)("alt",e.name)}}function Pce(t,n){1&t&&Ne(0,"img",50),2&t&&ft("alt",y().$implicit.name)}function Fce(t,n){if(1&t){const e=Ie();p(0,"div",31)(1,"div",32),L(2,Tce,1,0,"ng-container",33)(3,Dce,2,1,"ng-template",null,0,Pi)(5,Oce,3,0,"ng-template",null,1,Pi),p(7,"div",34)(8,"button",35),X("click",function(){const r=O(e).$implicit;return D(y().chanageImageView(r))}),p(9,"i",36),x(10,"zoom_in"),m()()()(),L(11,Ace,3,0,"div",37),p(12,"span",38),L(13,kce,2,5,"img",39)(14,Pce,1,1,"img",40),m()()}if(2&t){const e=n.$implicit,i=rn(4),r=rn(6),o=y();_("@scaleInOut",void 0)("ngClass",Be(8,yce,o.selected(e))),h(2),_("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),h(9),_("ngIf",o.getHidden(e)),h(2),_("ngIf",0<e.url.length),h(),_("ngIf",e.url.length<=0)}}function Nce(t,n){if(1&t){const e=Ie();p(0,"label",61),X("click",function(){const r=O(e).$implicit;return D(y(3).removeTagWord(r))}),x(1),p(2,"sup",62),x(3,"\xd7"),m()()}if(2&t){const e=n.$implicit;h(),Re(e)}}function Rce(t,n){if(1&t&&(Me(0),p(1,"span",59),L(2,Nce,4,1,"label",60),m(),De()),2&t){const e=y(2);h(2),_("ngForOf",e.selectedImagesOwnWords())}}function Lce(t,n){1&t&&(Me(0),p(1,"span",63)(2,"s"),x(3,"No Tag"),m()(),De())}function Bce(t,n){if(1&t&&(p(0,"option",64),x(1),m()),2&t){const e=n.$implicit;ft("value",e),h(),Re(e)}}function Uce(t,n){if(1&t){const e=Ie();p(0,"div",51)(1,"div")(2,"div",52)(3,"button",53),X("click",function(){O(e);const r=y();return D(r.setectedImagesToHidden(!r.selectedImagesIsHidden))}),p(4,"i",10),x(5),m()()(),p(6,"button",54),X("click",function(){return O(e),D(y().onUnselect())}),x(7),m(),p(8,"input",55),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.addingTagWord,r)||(o.addingTagWord=r),D(r)}),m(),p(9,"button",56),X("click",function(){return O(e),D(y().addTagWord())}),x(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),m(),L(11,Rce,3,1,"ng-container",15)(12,Lce,4,0,"ng-container",15),m(),p(13,"datalist",57),L(14,Bce,2,2,"option",58),m()()}if(2&t){const e=y();_("@fadeAndUpInOut",void 0),h(3),$t("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),h(),_("ngClass",Be(14,rB,e.selectedImagesIsHidden)),h(),Re(e.selectedImagesIsHidden?"visibility":"visibility_off"),h(2),Mi("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),h(),Py("list","",e.panelId,"_suggest"),We("ngModel",e.addingTagWord),h(),_("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),h(2),_("ngIf",e.selectedImagesOwnWords().length>0),h(),_("ngIf",0==e.selectedImagesOwnWords().length),h(),no("id","",e.panelId,"_suggest"),h(),_("ngForOf",e.suggestWords())}}let ac=(()=>{class t{static#e=this.sortOrder=[];get images(){const e=Xs.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?Xs.sortImagesByWords(e,t.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?t.sortOrder.unshift(null):t.sortOrder=t.sortOrder.filter(i=>null!=i),t.sortOrder=Array.from(new Set(t.sortOrder)),this._searchNoTagImage=e,U.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return Xs.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return Xs.allImagesOwnWords(this.isShowHideImages)}constructor(e,i,r,o){this.changeDetector=e,this.panelService=i,this.modalService=r,this.chatMessageService=o,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=Il.k.generateUuid()}ngAfterViewInit(){U.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){U.unregister(this)}allImages(){return Xs.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Xs.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=li.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&wu.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return Xs.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),t.sortOrder=t.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),t.sortOrder.unshift(e)),t.sortOrder=Array.from(new Set(t.sortOrder)),U.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=li.get(e.identifier);return i?i.words:[]}getHidden(e){const i=li.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Mr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7 \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(Mr,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:or.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=li.get(i.identifier)||li.create(i.identifier);r.hide=e,U.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(Mr,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${_e.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:or.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(li.get(r.identifier)||li.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),t.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),t.sortOrder=Array.from(new Set(t.sortOrder)),U.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(Mr,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${_e.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:or.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let o=li.get(r.identifier);o&&o.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),U.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}chanageImageView(e){e.state===Di.COMPLETE?(Du.imageUrl&&URL.revokeObjectURL(Du.imageUrl),Du.imageUrl=URL.createObjectURL(e.blob)):Du.imageUrl=e.url}static#t=this.\u0275fac=function(i){return new(i||t)(F(io),F(bi),F(Ii),F(Do))};static#n=this.\u0275cmp=xn({type:t,selectors:[["file-storage"]],decls:41,vars:19,consts:[["tagsBlock",""],["noTagBlock",""],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"click","checked"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModelChange","ngModel"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModelChange","change","ngModel","checked"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"change","value","checked"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"zoom-in",2,"z-index","10","position","absolute","right","0px","bottom","2px"],[1,"zoom-button",3,"click"],[1,"material-icons"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],[2,"cursor","pointer"],["height","120","draggable","false",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif","draggable","false",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120","draggable","false",3,"click","src","alt"],["src","assets/images/loading.gif","draggable","false",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModelChange","ngModel"],[2,"font-size","x-small",3,"click","disabled"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],[2,"user-select","none"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(i,r){1&i&&(p(0,"label")(1,"span",2)(2,"span")(3,"i",3),x(4,"add_photo_alternate"),m()(),p(5,"span"),x(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),m(),p(7,"span",4),x(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),m(),p(9,"input",5),X("change",function(s){return r.handleFileSelect(s)}),m(),p(10,"span",4),Ne(11,"br"),x(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),m()()(),p(13,"div",6)(14,"div",7)(15,"label",8)(16,"input",9),X("click",function(s){return r.onShowHiddenImages(s)}),m(),p(17,"i",10),x(18),m()()(),p(19,"span",11)(20,"label")(21,"input",12),X("click",function(){return r.onSearchAllImage()}),m(),p(22,"div",13)(23,"b"),x(24,"ALL"),m(),Ne(25,"badge",14),m()(),L(26,xce,6,3,"label",15)(27,Ece,5,4,"label",16),m(),p(28,"span",17)(29,"select",18),$e("ngModelChange",function(s){return Ge(r.serchCondIsOr,s)||(r.serchCondIsOr=s),s}),p(30,"option",19),x(31,"\u3044\u305a\u308c\u304b (OR)"),m(),p(32,"option",20),x(33,"\u3059\u3079\u3066 (AND)"),m()(),p(34,"label",21)(35,"input",22),$e("ngModelChange",function(s){return Ge(r.isSort,s)||(r.isSort=s),s}),X("change",function(){return r.isSort=!!r.isSort}),m(),p(36,"b",23),x(37,"\u30bd\u30fc\u30c8"),m()()()(),p(38,"div",24),L(39,Fce,15,10,"div",25),m(),L(40,Uce,15,16,"div",26)),2&i&&(h(16),ft("checked",r.isShowHideImages?"checked":""),h(),_("ngClass",Be(15,rB,r.isShowHideImages)),h(),Re(r.isShowHideImages?"visibility":"visibility_off"),h(3),ft("checked",r.searchAllImage?"checked":""),h(4),_("count",r.images.length)("@.disabled",!0),h(),_("ngIf",r.countAllImagesHasWord(null)>0),h(),_("ngForOf",r.allImagesOwnWords),h(2),We("ngModel",r.serchCondIsOr),h(6),ft("checked",r.isSort?"checked":""),We("ngModel",r.isSort),h(3),_("ngClass",Be(17,vce,r.isSelected)),h(),_("ngForOf",r.images)("ngForTrackBy",r.identify),h(),_("ngIf",r.isSelected))},dependencies:[Fi,nr,ni,ya,Ca,Rr,Wa,wl,Lr,Tr,kb,fr],styles:['[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.drop-zone[_ngcontent-%COMP%]{display:block;-webkit-user-select:none;user-select:none;border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.drop-zone[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.zoom-button[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:100px;padding:1px;pointer-events:auto;cursor:zoom-in}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{display:inline-block;font-size:16px;vertical-align:bottom}'],data:{animation:[Vn("scaleInOut",[Xt("void => *",[jt("200ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt("180ms ease",Pe({transform:"scale3d(0, 0, 0)"}))])]),Vn("fadeAndUpInOut",[Xt("void => *",[jt("100ms ease-in-out",mn([Pe({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),Pe({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),Xt("* => void",[jt("100ms ease-in-out",Pe({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),jt("100ms ease-in-out",Pe({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0})}return t})();const Hce=t=>({"red-eye":t}),zce=t=>({"current-images":t});function Vce(t,n){1&t&&Ne(0,"badge",10),2&t&&_("count",y(2).countImagesHasWord(null))("@.disabled",!0)}function jce(t,n){if(1&t){const e=Ie();p(0,"label")(1,"input",23),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.searchNoTagImage,r)||(o.searchNoTagImage=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.searchNoTagImage=!!r.searchNoTagImage)}),m(),p(2,"div",24)(3,"s"),x(4,"No Tag"),m(),L(5,Vce,1,2,"badge",25),m()()}if(2&t){const e=y();h(),ft("checked",e.searchNoTagImage?"checked":""),We("ngModel",e.searchNoTagImage),h(4),_("ngIf",e.countImagesHasWord(null)>0)}}function Gce(t,n){if(1&t&&Ne(0,"badge",10),2&t){const e=y().$implicit;_("count",y().countImagesHasWord(e))("@.disabled",!0)}}function Wce(t,n){if(1&t){const e=Ie();p(0,"label")(1,"input",26),X("change",function(){const r=O(e).$implicit;return D(y().onSelectedWord(r))}),m(),p(2,"div"),x(3),L(4,Gce,1,2,"badge",25),m()()}if(2&t){const e=n.$implicit,i=y();h(),ft("value",e),_("checked",i.searchWords.includes(e)),h(2),Re(e),h(),_("ngIf",i.countImagesHasWord(e)>0)}}function $ce(t,n){if(1&t){const e=Ie();p(0,"span",27)(1,"button",28),X("click",function(){O(e);const r=y();return D(r.onSelectedFile(r.empty))}),x(2,"\u753b\u50cf\u306a\u3057"),Ne(3,"br"),x(4,"/\u8a2d\u5b9a\u89e3\u9664"),m()()}}function Yce(t,n){1&t&&ti(0)}function qce(t,n){if(1&t&&(p(0,"label",42),x(1),m()),2&t){const e=y().$implicit;h(),Re(e)}}function Zce(t,n){1&t&&(p(0,"span",43),x(1,"\u2026"),m())}function Xce(t,n){if(1&t&&(Me(0),L(1,qce,2,1,"label",40)(2,Zce,2,0,"span",41),De()),2&t){const e=n.index;h(),_("ngIf",e<6),h(),_("ngIf",6==e)}}function Kce(t,n){if(1&t&&(p(0,"div",39),L(1,Xce,3,2,"ng-container",12),m()),2&t){const e=y().$implicit,i=y();h(),_("ngForOf",i.getTagWords(e))}}function Qce(t,n){1&t&&(p(0,"div",39)(1,"s",44),x(2,"No Tag"),m()())}function Jce(t,n){1&t&&(p(0,"div",45)(1,"i",46),x(2,"visibility"),m()())}function eue(t,n){1&t&&(p(0,"div",47)(1,"b",48),x(2,"\u8a2d\u5b9a\u4e2d"),m()())}function tue(t,n){if(1&t){const e=Ie();p(0,"img",49),It(1,"safe"),X("click",function(){O(e);const r=y().$implicit,o=y();return D(!o.getCurrent(r)&&o.onSelectedFile(r))}),m()}if(2&t){const e=y().$implicit;_("src",St(1,2,e.url,"resourceUrl"),gn)("alt",e.name)}}function nue(t,n){1&t&&Ne(0,"img",50),2&t&&ft("alt",y().$implicit.name)}function iue(t,n){if(1&t){const e=Ie();p(0,"div",29)(1,"div",30),L(2,Yce,1,0,"ng-container",31)(3,Kce,2,1,"ng-template",null,0,Pi)(5,Qce,3,0,"ng-template",null,1,Pi),p(7,"div",32)(8,"button",33),X("click",function(){const r=O(e).$implicit;return D(y().chanageImageView(r))}),p(9,"i",34),x(10,"zoom_in"),m()()()(),L(11,Jce,3,0,"div",35)(12,eue,3,0,"div",36)(13,tue,2,5,"img",37)(14,nue,1,1,"img",38),m()}if(2&t){const e=n.$implicit,i=rn(4),r=rn(6),o=y();_("@scaleInOut",void 0)("ngClass",Be(9,zce,o.getCurrent(e))),h(2),_("ngIf",o.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),h(9),_("ngIf",o.getHidden(e)),h(),_("ngIf",o.getCurrent(e)),h(),_("ngIf",0<e.url.length),h(),_("ngIf",e.url.length<=0)}}let Ou=(()=>{class t{get images(){const e=Xs.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?Xs.sortImagesByWords(e,ac.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return _n.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?ac.sortOrder.unshift(null):ac.sortOrder=ac.sortOrder.filter(i=>null!=i),ac.sortOrder=Array.from(new Set(ac.sortOrder)),this._searchNoTagImage=e,U.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return Xs.allImagesOwnWords(this.isShowHideImages)}constructor(e,i,r,o){this.changeDetector=e,this.panelService=i,this.modalService=r,this.chatMessageService=o,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){U.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){U.unregister(this)}allImages(){return Xs.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return Xs.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const o=li.get(r.identifier);null==e?(!o||null==o.tag||""==o.tag.trim())&&i++:o&&o.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=li.get(e.identifier);return i?i.words:[]}getHidden(e){const i=li.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(Mr,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:or.OK_CANCEL,materialIcon:"visibility",action:()=>{this.chatMessageService.sendOperationLog("\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7 \u304b\u3089\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u305f"),this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),ac.sortOrder=ac.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),ac.sortOrder.unshift(e)),ac.sortOrder=Array.from(new Set(ac.sortOrder)),U.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}chanageImageView(e){e.state===Di.COMPLETE?(Du.imageUrl&&URL.revokeObjectURL(Du.imageUrl),Du.imageUrl=URL.createObjectURL(e.blob)):Du.imageUrl=e.url}static#e=this.\u0275fac=function(i){return new(i||t)(F(io),F(bi),F(Ii),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[["tagsBlock",""],["noTagBlock",""],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"click","checked"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"click","checked"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModelChange","ngModel"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModelChange","change","ngModel","checked"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"change","value","checked"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"zoom-in",2,"z-index","10","position","absolute","right","0px","bottom","2px"],[1,"zoom-button",3,"click"],[1,"material-icons"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120","draggable","false",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif","draggable","false",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120","draggable","false",3,"click","src","alt"],["src","assets/images/loading.gif","draggable","false",3,"alt"]],template:function(i,r){1&i&&(p(0,"div",2)(1,"div",3)(2,"label",4)(3,"input",5),X("click",function(s){return r.onShowHiddenImages(s)}),m(),p(4,"i",6),x(5),m()()(),p(6,"span",7)(7,"label")(8,"input",8),X("click",function(){return r.onSearchAllImage()}),m(),p(9,"div",9)(10,"b"),x(11,"ALL"),m(),Ne(12,"badge",10),m()(),L(13,jce,6,3,"label",11)(14,Wce,5,4,"label",12),m(),p(15,"span",13)(16,"select",14),$e("ngModelChange",function(s){return Ge(r.serchCondIsOr,s)||(r.serchCondIsOr=s),s}),p(17,"option",15),x(18,"\u3044\u305a\u308c\u304b (OR)"),m(),p(19,"option",16),x(20,"\u3059\u3079\u3066 (AND)"),m()(),p(21,"label",17)(22,"input",18),$e("ngModelChange",function(s){return Ge(r.isSort,s)||(r.isSort=s),s}),X("change",function(){return r.isSort=!!r.isSort}),m(),p(23,"b",19),x(24,"\u30bd\u30fc\u30c8"),m()()()(),p(25,"div",20),L(26,$ce,5,0,"span",21)(27,iue,15,11,"div",22),m()),2&i&&(h(3),ft("checked",r.isShowHideImages?"checked":""),h(),_("ngClass",Be(14,Hce,r.isShowHideImages)),h(),Re(r.isShowHideImages?"visibility":"visibility_off"),h(3),ft("checked",r.searchAllImage?"checked":""),h(4),_("count",r.images.length)("@.disabled",!0),h(),_("ngIf",r.countAllImagesHasWord(null)>0),h(),_("ngForOf",r.allImagesOwnWords),h(2),We("ngModel",r.serchCondIsOr),h(6),ft("checked",r.isSort?"checked":""),We("ngModel",r.isSort),h(4),_("ngIf",r.isAllowedEmpty),h(),_("ngForOf",r.images)("ngForTrackBy",r.identify))},dependencies:[Fi,nr,ni,ya,Ca,Wa,wl,Lr,Tr,kb,fr],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.zoom-button[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:100px;padding:1px;pointer-events:auto;cursor:zoom-in}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{display:inline-block;font-size:16px;vertical-align:bottom}"],data:{animation:[Vn("scaleInOut",[Xt("void => *",[jt("200ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt("180ms ease",Pe({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();function rue(t,n){1&t&&ti(0)}function oue(t,n){if(1&t){const e=Ie();p(0,"div",4),L(1,rue,1,0,"ng-container",6),p(2,"select",7,1),X("change",function(){O(e);const r=rn(3);return D(y(3).setElementType(r.value))}),p(4,"option",8),x(5,"\u901a\u5e38"),m(),p(6,"option",9),x(7,"\u6570\u5024"),m(),p(8,"option",10),x(9,"\u30ea\u30bd\u30fc\u30b9"),m(),p(10,"option",11),x(11,"\u80fd\u529b\u5024"),m(),p(12,"option",12),x(13,"\u30c1\u30a7\u30c3\u30af"),m(),p(14,"option",13),x(15,"\u30ce\u30fc\u30c8"),m(),p(16,"option",14),x(17,"\u53c2\u7167URL"),m()()()}if(2&t){let e;const i=y(3),r=rn(2);h(),_("ngTemplateOutlet",r),h(),_("ngModel",null!==(e=i.gameDataElement.type)&&void 0!==e?e:"")}}function sue(t,n){1&t&&(Me(0),Ne(1,"br"),p(2,"span",16),x(3,"0=\u753b\u50cf\u4f9d\u5b58"),m(),De())}function aue(t,n){if(1&t&&(Me(0),p(1,"span",15),x(2),m(),L(3,sue,4,0,"ng-container",2),De()),2&t){const e=y(3);h(2),Re(e.name),h(),_("ngIf","character"===e.descriptionType&&"height"===e.name)}}function lue(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",17),x(2),m(),p(3,"input",18),$e("ngModelChange",function(r){O(e);const o=y(3);return Ge(o.name,r)||(o.name=r),D(r)}),m(),De()}if(2&t){const e=y(3);h(2),Re(e.name),h(),We("ngModel",e.name)}}function cue(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",22),It(2,"safe"),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m(),Ne(3,"br"),p(4,"input",23),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m(),p(5,"b",24),x(6,"%"),m(),De()}if(2&t){const e=y(4);h(),Ds(St(2,6,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),no("title","",e.currentValue,"%"),We("ngModel",e.currentValue),h(3),We("ngModel",e.currentValue)}}function uue(t,n){if(1&t){const e=Ie();Me(0),p(1,"label",25)(2,"input",26),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.value,r)||(o.value=r),D(r)}),m(),p(3,"div",27),x(4),m()(),p(5,"label",28)(6,"input",26),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m(),p(7,"div",27),x(8),m()(),De()}if(2&t){const e=y(5);h(),ke("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),h(),We("ngModel",e.value),h(2),Re(e.value),h(),ke("color",e.value)("background-color",e.currentValue)("text-shadow",e.colorSampleTextShadowCss),h(),We("ngModel",e.currentValue),h(2),Mi("(",e.currentValue,")")}}function due(t,n){if(1&t){const e=Ie();Me(0),p(1,"label",25)(2,"input",26),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.value,r)||(o.value=r),D(r)}),m(),x(3),m(),De()}if(2&t){const e=y(5);h(),ke("color",e.value)("text-shadow",e.colorSampleTextShadowCss),h(),We("ngModel",e.value),h(),Mi(" ",e.value,"")}}function hue(t,n){if(1&t&&(Me(0),L(1,uue,9,16,"ng-container",2)(2,due,4,6,"ng-container",2),De()),2&t){const e=y(4);h(),_("ngIf","colors"===e.gameDataElement.type),h(),_("ngIf","color"===e.gameDataElement.type)}}function fue(t,n){if(1&t){const e=Ie();p(0,"div",32)(1,"label"),x(2,"\xd7 size"),p(3,"input",33),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),X("change",function(){O(e);const r=y(5);return D(r.currentValue=r.currentValue?r.name:"")}),m()()()}if(2&t){const e=y(5);h(),ke("text-decoration",e.currentValue?"none":"line-through"),h(2),ft("checked",e.currentValue?"checked":""),We("ngModel",e.currentValue)}}function pue(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",29),It(2,"safe"),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),Ne(3,"br"),p(4,"input",30),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),L(5,fue,4,4,"div",31),De()}if(2&t){const e=y(4);h(),Ds(St(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ft("title",e.value),ft("min","altitude"===e.name?-12:"fontsize"===e.name||"length"===e.name?1:0),ft("max","fontsize"===e.name?128:12),ft("step","fontsize"===e.name?1:.5),We("ngModel",e.value),h(3),ft("min","altitude"===e.name?-24:"fontsize"===e.name||"length"===e.name?1:0),ft("step","fontsize"===e.name?1:.1),We("ngModel",e.value),h(),_("ngIf","character"===e.descriptionType&&"height"===e.name)}}function gue(t,n){if(1&t&&(Me(0)(1,19),L(2,cue,7,9,"ng-container",20)(3,hue,3,2,"ng-container",20)(4,pue,6,14,"ng-container",21),De()()),2&t){const e=y(3);h(),_("ngSwitch",e.gameDataElement.name),h(),_("ngSwitchCase","opacity"),h(),_("ngSwitchCase","color")}}function mue(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",34),x(2),m(),p(3,"input",35),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),De()}if(2&t){const e=y(4);h(2),Re(e.value),h(),ft("type",e.isNum(e.value)?"number":"text"),_("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),We("ngModel",e.value)}}function _ue(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",36),It(2,"safe"),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m(),Ne(3,"br"),p(4,"input",37),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m(),x(5," / "),p(6,"input",38),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),De()}if(2&t){const e=y(4);h(),Ds(St(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),ft("title",e.currentValue),ft("max",e.isNum(e.value)?e.value:1e3),_("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),We("ngModel",e.currentValue),h(3),_("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),We("ngModel",e.currentValue),h(2),_("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),We("ngModel",e.value)}}function bue(t,n){if(1&t){const e=Ie();Me(0),p(1,"select",40),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),p(2,"option",8),x(3,"\u306a\u3057"),m(),p(4,"option",41),x(5,"\xf72"),m(),p(6,"option",42),x(7,"\xf73 SRS,LHZ"),m(),p(8,"option",43),x(9,"\xf74"),m(),p(10,"option",44),x(11,"\xf75"),m(),p(12,"option",45),x(13,"\xf76 SW"),m(),p(14,"option",46),x(15,"\xf710"),m(),p(16,"option",47),x(17,"D&D 3e\uff5e"),m()(),De()}if(2&t){const e=y(5);h(),We("ngModel",e.currentValue)}}function vue(t,n){if(1&t&&(Me(0),p(1,"span",48),x(2),m(),De()),2&t){const e=y(5);h(2),Re("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function yue(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",39),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),L(2,bue,18,1,"ng-container",2)(3,vue,3,1,"ng-container",2),De()}if(2&t){const e=y(4);h(),ft("type",e.isNum(e.value)?"number":"text"),_("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),We("ngModel",e.value),h(),_("ngIf",e.isEdit),h(),_("ngIf",!e.isEdit&&e.currentValue)}}function Cue(t,n){if(1&t){const e=Ie();p(0,"input",52),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m()}2&t&&We("ngModel",y(5).currentValue)}function xue(t,n){if(1&t&&(p(0,"span",53),x(1),m()),2&t){const e=y(5);h(),Re(e.checkValue)}}function wue(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",49),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),X("change",function(){O(e);const r=y(4);return D(r.value=r.value?r.name:"")}),m(),L(2,Cue,1,1,"input",50)(3,xue,2,1,"span",51),De()}if(2&t){const e=y(4);h(),ft("checked",e.value?"checked":""),_("logging.name",e.tabletopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging),We("ngModel",e.value),h(),_("ngIf",e.isEdit),h(),_("ngIf",!e.isEdit)}}function Eue(t,n){if(1&t){const e=Ie();Me(0),p(1,"textarea",54),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),De()}if(2&t){const e=y(4);h(),We("ngModel",e.value)}}function Tue(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",34),x(2),m(),p(3,"span",55)(4,"input",56),$e("ngModelChange",function(r){O(e);const o=y(4);return Ge(o.value,r)||(o.value=r),D(r)}),m(),p(5,"button",57),X("click",function(){O(e);const r=y(4);return D(!!r.stringUtil.validUrl(r.value.toString())&&r.openUrl(r.value))}),p(6,"i",58),x(7),m()()(),De()}if(2&t){const e=y(4);h(2),Re(e.value),h(2),We("ngModel",e.value),h(),$t("disabled",e.stringUtil.validUrl(e.value.toString())?null:""),h(2),Re(e.stringUtil.validUrl(e.value.toString())?e.stringUtil.sameOrigin(e.value.toString())?"link":"open_in_new":"link_off")}}function Iue(t,n){if(1&t){const e=Ie();p(0,"input",61),$e("ngModelChange",function(r){O(e);const o=y(5);return Ge(o.value,r)||(o.value=r),D(r)}),m()}2&t&&We("ngModel",y(5).value)}function Sue(t,n){1&t&&(p(0,"span",62),x(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),m())}function Mue(t,n){if(1&t&&(Me(0),p(1,"div",34),x(2),m(),L(3,Iue,1,1,"input",59)(4,Sue,2,0,"span",60),De()),2&t){const e=y(4);h(2),Re(e.value),h(),_("ngIf",!(e.isHideText&&e.isTabletopObjectName)),h(),_("ngIf",e.isHideText&&e.isTabletopObjectName)}}function Due(t,n){if(1&t&&(Me(0)(1,19),L(2,mue,4,6,"ng-container",20)(3,_ue,7,19,"ng-container",20)(4,yue,4,7,"ng-container",20)(5,wue,4,7,"ng-container",20)(6,Eue,2,1,"ng-container",20)(7,Tue,8,4,"ng-container",20)(8,Mue,5,3,"ng-container",21),De()()),2&t){const e=y(3);h(),_("ngSwitch",e.gameDataElement.type),h(),_("ngSwitchCase","simpleNumber"),h(),_("ngSwitchCase","numberResource"),h(),_("ngSwitchCase","abilityScore"),h(),_("ngSwitchCase","checkProperty"),h(),_("ngSwitchCase","note"),h(),_("ngSwitchCase","url")}}function Oue(t,n){if(1&t&&(Me(0),L(1,oue,18,2,"div",3),p(2,"div",4),L(3,aue,4,2,"ng-container",2)(4,lue,4,2,"ng-container",2),m(),p(5,"div",5),L(6,gue,5,3,"ng-container",2)(7,Due,9,7,"ng-container",2),m(),De()),2&t){const e=y(2);h(),_("ngIf",e.isEdit),h(2),_("ngIf",e.isTagLocked),h(),_("ngIf",!e.isTagLocked),h(2),_("ngIf",e.isCommonValue),h(),_("ngIf",!e.isCommonValue)}}function Aue(t,n){1&t&&ti(0)}function kue(t,n){if(1&t&&(p(0,"div",68),L(1,Aue,1,0,"ng-container",6),m()),2&t){y(3);const e=rn(2);h(),_("ngTemplateOutlet",e)}}function Pue(t,n){if(1&t&&(Me(0),p(1,"div",69),x(2),m(),De()),2&t){const e=y(3);h(2),Re(e.name)}}function Fue(t,n){if(1&t){const e=Ie();Me(0),p(1,"input",70),$e("ngModelChange",function(r){O(e);const o=y(3);return Ge(o.name,r)||(o.name=r),D(r)}),m(),De()}if(2&t){const e=y(3);h(),We("ngModel",e.name)}}function Nue(t,n){if(1&t&&Ne(0,"div",73),2&t){const e=n.$implicit,i=y(4);_("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function Rue(t,n){if(1&t&&(p(0,"div",71),L(1,Nue,1,7,"div",72),m()),2&t){const e=y(3);h(),_("ngForOf",e.gameDataElement.children)}}function Lue(t,n){if(1&t&&(Me(0),L(1,kue,2,1,"div",63),Ne(2,"div",64),p(3,"div",65)(4,"div",66),L(5,Pue,3,1,"ng-container",2)(6,Fue,2,1,"ng-container",2),m(),L(7,Rue,2,1,"div",67),m(),De()),2&t){const e=y(2);h(),_("ngIf",e.isEdit),h(3),ke("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),h(),_("ngIf",e.isTagLocked&&"common"!=e.name),h(),_("ngIf",!e.isTagLocked),h(),_("ngIf",0<e.gameDataElement.children.length)}}function Bue(t,n){if(1&t&&(Me(0),L(1,Oue,8,5,"ng-container",2)(2,Lue,8,6,"ng-container",2),De()),2&t){const e=y();h(),_("ngIf",e.gameDataElement.children.length<1),h(),_("ngIf",0<e.gameDataElement.children.length)}}function Uue(t,n){if(1&t){const e=Ie();p(0,"button",74),X("click",function(){return O(e),D(y().addElement())}),p(1,"i",75),x(2,"add_circle"),m()(),p(3,"button",74),X("click",function(){return O(e),D(y().upElement())}),p(4,"i",75),x(5,"arrow_upward"),m()(),Ne(6,"br"),p(7,"button",74),X("click",function(){return O(e),D(y().deleteElement())}),p(8,"i",75),x(9,"remove_circle_outline"),m()(),p(10,"button",74),X("click",function(){return O(e),D(y().downElement())}),p(11,"i",75),x(12,"arrow_downward"),m()()}}let Hue=(()=>{class t{get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return null==this._currentValue?"":this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTabletopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get checkValue(){if(null==this.currentValue)return"";let e=this.currentValue.toString().split(/[|\uff5c]/,2);if(e.length<=1)return null==this.value||""==this.value?"":this.currentValue.toString();let i=null==this.value||""==this.value?e[1]:e[0];return this.tabletopObject instanceof cn&&this.tabletopObject.chatPalette&&(i=this.tabletopObject.chatPalette.evaluate(i,this.tabletopObject.rootDataElement)),i}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"length"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name||"color"===this.gameDataElement.name)}get isNotApplicable(){return this.isCommonValue&&"range-not-width"===this.descriptionType&&"width"===this.gameDataElement.name}get colorSampleTextShadowCss(){const e=_e.textShadowColor(this.value.toString());return`${e} -1px -1px 0px, \n      ${e} 0px -1px 0px, \n      ${e} 1px -1px 0px, \n      ${e} -1px 0px 0px, \n      ${e} 1px 0px 0px,\n      ${e} -1px 1px 0px,\n      ${e} 0px 1px 0px,\n      ${e} 1px 1px 0px`}get identifier(){return this.gameDataElement.identifier}constructor(e,i){this.changeDetector=e,this.modalService=i,this.tabletopObject=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=_e,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement)}ngOnChanges(){U.unregister(this),U.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=!1;this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier?(this.setValues(this.gameDataElement),i=!0):this.tabletopObject&&this.tabletopObject.contains(this.gameDataElement)&&(i=!0),i&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.gameDataElement?.identifier}`,e=>{this.setValues(this.gameDataElement),this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){U.unregister(this)}addElement(){this.gameDataElement.appendChild(ht.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){_e.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(xa,{url:e,title:this.tabletopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}static#e=this.\u0275fac=function(i){return new(i||t)(F(io),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tabletopObject:"tabletopObject",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},features:[mr],decls:3,vars:1,consts:[["editButtons",""],["select",""],[4,"ngIf"],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"change","ngModel"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModelChange","ngModel"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModelChange","ngModel","title"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModelChange","ngModel"],[1,"move",2,"font-size","small"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModelChange","ngModel"],[2,"display","inline-block","box-sizing","border-box","width","calc(100% - 1em)","text-align","center"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["type","range",2,"width","90%",3,"ngModelChange","ngModel","title","min","max","step"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"ngModelChange","min","step","ngModel"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","type","ngModel"],["appLogging","","type","range","min","0",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel","title","max"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","type","ngModel"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModelChange","ngModel"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",3,"ngModelChange","change","logging.name","logging.dataElement","logging.disable","ngModel","checked"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModelChange","ngModel"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModelChange","ngModel"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModelChange","ngModel"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModelChange","ngModel"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModelChange","ngModel"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(i,r){1&i&&L(0,Bue,3,2,"ng-container",2)(1,Uue,13,0,"ng-template",null,0,Pi),2&i&&_("ngIf",r.gameDataElement&&!r.isNotApplicable&&!(r.isHideText&&("text"==r.name||"fontsize"==r.name||"color"==r.name)))},dependencies:[nr,ni,ip,Dh,mm,_b,ya,Ca,Rr,Xl,Kl,Wa,wl,Lr,pd,fd,Tr,t,Md,fr],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#eee}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#fff}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#eee -1px -1px 0px,#eee 0px -1px 0px,#eee 1px -1px 0px,#eee -1px 0px 0px,#eee 1px 0px 0px,#eee -1px 1px 0px,#eee 0px 1px 0px,#eee 1px 1px 0px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0})}return t})();const zue=["mainImage"],Vue=t=>({"is-hidden":t}),jue=t=>({inverse:t}),Gue=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),Wue=(t,n,e)=>({"black-paint":t,hollow:n,small:e}),$ue=t=>({"current-icon":t}),Yue=t=>({hide:t}),que=t=>({transform:t});function Zue(t,n){1&t&&ti(0)}function Xue(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",6),X("click",function(){return O(e),D(y().openModal("front"))}),x(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),m(),p(3,"button",2),X("click",function(){return O(e),D(y().openModal("back"))}),x(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),m(),De()}if(2&t){const e=y();h(),_("disabled",!e.isVisible)}}function Kue(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",2),X("click",function(){return O(e),D(y().openModalChangeAllCardImages())}),x(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),m(),De()}}function Que(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",2),X("click",function(){return O(e),D(y().openModal("floor"))}),x(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),m(),p(3,"button",2),X("click",function(){return O(e),D(y().openModal("wall"))}),x(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),m(),De()}}function Jue(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",6),X("click",function(){O(e);const r=y();return D(r.openModal(r.tabletopObject.face))}),x(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),m(),De()}if(2&t){const e=y();h(),_("disabled",!e.isVisible)}}function ede(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",2),X("click",function(){O(e);const r=y();return D(r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length)))}),x(2),m(),p(3,"button",6),X("click",function(){return O(e),D(y().openModal("faceIcon"))}),x(4),m(),De()}if(2&t){const e=y();h(2),Mi("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),h(),_("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),h(),Mi("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function tde(t,n){if(1&t){const e=Ie();Me(0),p(1,"button",2),X("click",function(){O(e);const r=y(2);return D(r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0))}),x(2,"\u753b\u50cf\u5909\u66f4"),m(),De()}}function nde(t,n){if(1&t&&(Me(0),L(1,tde,3,0,"ng-container",10),De()),2&t){const e=y();h(),_("ngIf","range"!==e.tabletopObject.aliasName)}}function ide(t,n){if(1&t&&(p(0,"div",12),x(1),m()),2&t){const e=y();h(),Mi("",e.progresPercent,"%")}}function rde(t,n){if(1&t){const e=Ie();p(0,"select",14,0),X("change",function(){O(e);const r=rn(1);return D(y(2).setLocation(r.value))}),p(2,"option",15),x(3,"\u30c6\u30fc\u30d6\u30eb"),m(),p(4,"option",16),x(5,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),m(),p(6,"option",17),x(7,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),m(),p(8,"option",18),x(9,"\u5893\u5730"),m()()}if(2&t){const e=y(2);_("ngModel",e.tabletopObject.location.name),h(6),ft("value",e.networkService.peerId)}}function ode(t,n){if(1&t){const e=Ie();Me(0),L(1,rde,10,2,"select",13),p(2,"button",6),X("click",function(){O(e);const r=y();return D(r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0))}),x(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),m(),De()}if(2&t){const e=y();h(),_("ngIf",e.tabletopObject),h(),_("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function sde(t,n){if(1&t){const e=Ie();p(0,"button",36),X("click",function(){O(e);const r=y(2),o=r.$implicit,s=r.index;return D(y(3).deleteIcon(s,o.identifier))}),p(1,"b",37),x(2,"close"),m()()}}function ade(t,n){if(1&t){const e=Ie();p(0,"span",33)(1,"img",34),It(2,"safe"),X("click",function(){O(e);const r=y().index;return D(y(3).selectIcon(r))}),m(),L(3,sde,3,0,"button",35),m()}if(2&t){const e=y(),i=e.$implicit,r=e.index,o=y(3);_("@bounceInOut",void 0)("ngClass",Be(10,$ue,o.tabletopObject.currntIconIndex==r)),h(),ke("cursor",o.tabletopObject.currntIconIndex==r?"auto":"pointer"),_("src",St(2,7,i.url,"resourceUrl"),gn)("alt",i.name),h(2),_("ngIf",o.tabletopObject.currntIconIndex==r)}}function lde(t,n){if(1&t&&(p(0,"div",7),L(1,ade,4,12,"span",32),m()),2&t){const e=n.$implicit,i=n.index;ke("top",-y(3).showIconOffset(i),"px"),h(),_("ngIf",0<e.url.length)}}function cde(t,n){if(1&t){const e=Ie();p(0,"span",38)(1,"img",39),It(2,"safe"),X("click",function(){const r=O(e).index;return D(y(3).selectImage(r))}),m()()}if(2&t){const e=n.$implicit,i=n.index,r=y(3);ke("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),_("ngClass",Be(9,Yue,r.tabletopObject.currntImageIndex==i)),h(),_("@bounceInOut",void 0)("src",St(2,6,e.url,"resourceUrl"),gn)("alt",e.name)}}function ude(t,n){if(1&t){const e=Ie();p(0,"button",40),X("click",function(){return O(e),D(y(3).openModalAddImage())}),x(1),m()}if(2&t){const e=y(3);ke("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),h(),Re(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}function dde(t,n){if(1&t&&(p(0,"div",41),Ne(1,"div",42),It(2,"safe"),m()),2&t){const e=y(3);ke("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),_("ngStyle",Be(15,que,"scale("+e.imageAreaRreact.scale+")")),h(),ke("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),_("innerHTML",St(2,12,e.cardText,"html"),eo)}}function hde(t,n){if(1&t){const e=Ie();p(0,"div",22)(1,"div",23),L(2,lde,2,3,"div",24),m(),p(3,"div",25),L(4,cde,3,11,"span",26)(5,ude,2,3,"button",27),m(),L(6,dde,3,17,"div",28),p(7,"div",29)(8,"div",30)(9,"img",31,1),It(11,"safe"),X("dblclick",function(){return O(e),D(y(2).openMainImageModal())})("load",function(){return O(e),D(y(2).onMainImageLoad())}),m()()()()}if(2&t){const e=y(2);h(2),_("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),h(2),_("ngForOf",e.tabletopObject.imageFiles),h(),_("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),h(),_("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),h(),_("ngClass",Be(14,jue,e.tabletopObject.isInverse)),h(),_("ngClass",Dc(16,Gue,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),h(),_("src",St(11,11,e.imageFile.url,"resourceUrl"),gn)("alt",e.imageFile.name)("ngClass",ma(25,Wue,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function fde(t,n){if(1&t){const e=Ie();p(0,"div",47)(1,"button",48),X("click",function(){return O(e),D(y(3).showChatPalette())}),x(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),m(),p(3,"button",48),X("click",function(){return O(e),D(y(3).showStandSetting())}),x(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),m()()}if(2&t){const e=y(3);h(),_("disabled",!e.isAllowsChat),h(2),_("disabled",!e.isAllowsChat)}}function pde(t,n){if(1&t&&(Me(0),p(1,"div",43)(2,"div",44),Ne(3,"div",45),m(),L(4,fde,5,2,"div",46),m(),De()),2&t){const e=y(2);h(3),_("gameDataElement",e.tabletopObject.commonDataElement)("tabletopObject",e.tabletopObject)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.descriptionType),h(),_("ngIf","character"===e.tabletopObject.aliasName)}}function gde(t,n){if(1&t&&(p(0,"div",43)(1,"div",44),Ne(2,"div",50),m()()),2&t){const e=n.$implicit,i=y(3);h(2),_("gameDataElement",e)("tabletopObject",i.tabletopObject)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function mde(t,n){if(1&t&&(Me(0),L(1,gde,3,4,"div",49),De()),2&t){const e=y(2);h(),_("ngForOf",e.tabletopObject.detailDataElement.children)}}function _de(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",43)(2,"button",51),X("click",function(){return O(e),D(y(2).addDataElement())}),x(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),m()(),De()}}function bde(t,n){if(1&t){const e=Ie();p(0,"div",19)(1,"span")(2,"img",20),It(3,"safe"),X("click",function(){return O(e),D(y().openModal("shadowImageIdentifier",!0))}),m()(),L(4,hde,12,29,"div",21)(5,pde,5,7,"ng-container",10)(6,mde,2,1,"ng-container",10)(7,_de,4,0,"ng-container",10),m()}if(2&t){const e=y();h(2),_("src",St(3,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),gn)("alt",e.tabletopObject.shadowImageFile.name),h(2),_("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),h(),_("ngIf",e.tabletopObject.commonDataElement),h(),_("ngIf",e.tabletopObject.detailDataElement),h(),_("ngIf",e.isEdit)}}let lc=(()=>{class t{constructor(e,i,r,o,s){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=o,this.chatMessageService=s,this.tabletopObject=null,this.isEdit=!1,this.networkService=xt,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){U.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof Ci&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tabletopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tabletopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tabletopObjectName}`;break;case"range":this.panelService.title=`\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a - ${this.tabletopObjectName}`}})}ngAfterViewInit(){queueMicrotask(()=>{this.chatMessageService.sendOperationLog(`${this.tabletopObject instanceof Ci&&!this.tabletopObject.isFront?"\u30ab\u30fc\u30c9\u8a2d\u5b9a - \u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09":this.panelService.title} \u3092\u958b\u3044\u305f`)})}ngOnDestroy(){U.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=ht.create("\u898b\u51fa\u3057","",{}),i=ht.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":ze.play(pe.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,e.isPreview=!1,ze.play(pe.cardPut);break;case"text-note":e.toTopmost(),ze.play(pe.cardPut);break;case"dice-symbol":ze.play(pe.dicePut);default:ze.play(pe.piecePut)}}get tabletopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof Ci&&this.isVisible?e.frontImage:e.imageFile:_n.Empty}get descriptionType(){return this.tabletopObject instanceof sr&&!this.tabletopObject.isApplyWidth?"range-not-width":this.tabletopObject.aliasName}get isAllowsChat(){if(!(this.tabletopObject instanceof cn&&this.tabletopObject.isAllowsChat))return!1;switch(this.tabletopObject.location.name){case"table":case Ce.myCursor.peerId:return!0;case"graveyard":return!1;default:for(const e of xt.peers)if(e.isOpen&&this.tabletopObject.location.name===e.peerId)return!1;return!0}}saveToXML(){var e=this;return(0,R.A)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;const i=e.tabletopObject instanceof Ci&&!e.tabletopObject.isFront?"\u30ab\u30fc\u30c9":e.tabletopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),ze.play("graveyard"==e?pe.sweep:pe.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;o&&"null"!=o.value&&o.currentValue&&(r=[o.currentValue+""])}else{const o=this.tabletopObject.imageDataElement.getElementsByName(e);o&&o.length>0&&(r=o.map(s=>s.value+""))}this.modalService.open(Ou,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&o)if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;if(s){"null"!=s.value&&(s.currentValue=o);const a=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const l of a)this.tabletopObject.imageDataElement.removeChild(l)}}else if("faceIcon"===e){let s=this.tabletopObject.imageDataElement.getElementsByName(e);if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let a=this.MAX_IMAGE_ICON_COUNT;a<s.length;a++)this.deleteIcon(a);s[this.MAX_IMAGE_ICON_COUNT-1].value=o}else this.tabletopObject.imageDataElement.appendChild(ht.create(e,o,{type:"image"},e+Il.k.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let s=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!s)return;s.value=o}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(Ou,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let o=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let s=this.MAX_IMAGE_ICON_COUNT;s<o.length;s++)this.deleteImage(s);o[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(ht.create("imageIdentifier",r,{type:"image"},name+Il.k.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(o=>o.value+"")),this.modalService.open(Ou,{isAllowedEmpty:e,currentImageIdentifires:i}).then(o=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!o||("null"==o?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=o,this.tabletopObject.imageElement.currentValue=o):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=o))})}openModalChangeAllCardImages(){this.modalService.open(Ou,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof Gi)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,ze.play(pe.surprise),U.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){this.tabletopObject instanceof Gi||(this.tabletopObject instanceof Ci?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof fs?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof cn?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<this.tabletopObject.imageFile?.url.length):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof cn))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Hm,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof cn))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(ev,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){this.mainImageElement&&(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let l=null;return this.tabletopObject instanceof Gi?l=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(l=this.tabletopObject),l&&(o.scale=o.width/(l.size*this.gridSize),o.width=l.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof Gi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Gi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Gi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?_e.rubyToHtml(_e.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=_e.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isVisible(){return!!this.tabletopObject&&(!(!Ce.myCursor||!Ce.myCursor.isGMMode)||(this.tabletopObject instanceof Ci?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof fs)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof cn?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof fs&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof Ci?!this.tabletopObject.isFront:this.tabletopObject instanceof fs&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}static#e=this.\u0275fac=function(i){return new(i||t)(F(kl),F(bi),F(Ii),F(hr),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-character-sheet"]],viewQuery:function(i,r){if(1&i&&Dn(zue,5),2&i){let o;On(o=An())&&(r.mainImageElement=o.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[["select",""],["mainImage",""],[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"click","disabled"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"change","ngModel"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],["draggable","false",1,"shadow-image",2,"cursor","pointer",3,"click","src","alt"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",2,"display","inline-block",3,"ngClass"],["draggable","false",1,"main-image",3,"dblclick","load","src","alt","ngClass"],["class","icon-image-box","style","display: block",3,"ngClass",4,"ngIf"],[1,"icon-image-box",2,"display","block",3,"ngClass"],["draggable","false",3,"click","src","alt"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],["draggable","false",2,"cursor","pointer",3,"click","src","alt"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[1,"character-setteings",3,"click","disabled"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tabletopObject","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(i,r){1&i&&(p(0,"button",2),X("click",function(){return r.toggleEditMode()}),x(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),m(),Me(2,3),L(3,Zue,1,0,"ng-container",4)(4,Xue,5,1,"ng-container",4)(5,Kue,3,0,"ng-container",4)(6,Que,5,0,"ng-container",4)(7,Jue,3,1,"ng-container",4)(8,ede,5,3,"ng-container",4)(9,nde,2,1,"ng-container",5),De(),p(10,"button",2),X("click",function(){return r.clone()}),x(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),m(),p(12,"button",6),X("click",function(){return r.saveToXML()}),p(13,"div",7)(14,"div",8),x(15,"\u4fdd\u5b58"),m(),L(16,ide,2,1,"div",9),m()(),L(17,ode,4,2,"ng-container",10)(18,bde,8,9,"div",11)),2&i&&(h(2),_("ngSwitch",r.tabletopObject.aliasName),h(),_("ngSwitchCase","numberResource"),h(),_("ngSwitchCase","card"),h(),_("ngSwitchCase","card-stack"),h(),_("ngSwitchCase","terrain"),h(),_("ngSwitchCase","dice-symbol"),h(),_("ngSwitchCase","character"),h(4),_("disabled",r.isSaveing),h(2),_("ngClass",Be(12,Vue,r.isSaveing)),h(2),_("ngIf",r.isSaveing),h(),_("ngIf","character"===r.tabletopObject.aliasName),h(),_("ngIf",r.tabletopObject))},dependencies:[Fi,nr,ni,Zo,Dh,mm,_b,ya,Ca,wl,Lr,Tr,Hue,fr],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;object-fit:contain;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;inset:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.flex-item[_ngcontent-%COMP%]   button.character-setteings[_ngcontent-%COMP%]{font-size:11px;color:#444}.flex-item[_ngcontent-%COMP%]   button.character-setteings[_ngcontent-%COMP%]:disabled{background-color:#eee;color:#aaa;cursor:auto}"],data:{animation:[Vn("switchImage",[Xt(":increment, :decrement",[jt("200ms ease",mn([Pe({transform:"scale3d(0, 0, 0)"}),Pe({transform:"scale3d(0, 1.2, 1.2)"}),Pe({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("showcase",[Xt(":increment, :decrement",[jt("200ms 200ms ease-in",mn([Pe({transform:"scale3d(0, 1.0, 1.0)"}),Pe({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("showcaseItem",[Xt(":enter",[jt("200ms ease",mn([Pe({transform:"scale3d(0, 0, 0)"}),Pe({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),Xt(":leave",[jt("200ms ease",mn([Pe({transform:"scale3d(1.0, 1.0, 1.0)"}),Pe({transform:"scale3d(0, 0, 0)"})]))])]),Vn("bounceInOut",[Xt("void => *",[jt("600ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale3d(0, 0, 0)"}))])])]}})}return t})();const vde=["textArea"],yde=t=>({"direct-message":t}),oB=(t,n)=>({color:t,"font-weight":n}),qx=t=>({"not-specified":t}),cv=()=>({standalone:!0}),Cde=(t,n)=>({inverse:t,hollow:n}),xde=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),wde=t=>({"black-paint":t}),sB=t=>({"is-active":t}),Ede=t=>({"disabled-stand":t});function Tde(t,n){1&t&&(Ne(0,"img",32),It(1,"safe")),2&t&&_("src",St(1,1,y(2).imageFile.url,"resourceUrl"),gn)}function Ide(t,n){if(1&t&&(p(0,"div",30),L(1,Tde,2,4,"img",31),m()),2&t){const e=y();h(),_("ngIf",0<e.imageFile.url.length)}}function Sde(t,n){if(1&t&&(p(0,"div",30),Ne(1,"img",32),It(2,"safe"),m()),2&t){const e=y(2);h(),_("src",St(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),gn)}}function Mde(t,n){if(1&t&&(p(0,"div",34)(1,"span",35),Ne(2,"img",36),It(3,"safe"),m()()),2&t){const e=y(3);_("ngClass",Cn(7,Cde,e.character.isInverse,e.character.isHollow)),h(),_("ngClass",Dc(10,xde,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),h(),_("src",St(3,4,e.character.imageFile.url,"resourceUrl"),gn)("ngClass",Be(19,wde,e.character.isBlackPaint))}}function Dde(t,n){if(1&t&&L(0,Mde,4,21,"div",33),2&t){const e=y(2);_("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function Ode(t,n){if(1&t&&L(0,Sde,3,4,"div",6)(1,Dde,1,1,"ng-template",null,2,Pi),2&t){const e=rn(2),i=y();_("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function Ade(t,n){if(1&t){const e=Ie();p(0,"input",37),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.isUseFaceIcon,r)||(o.isUseFaceIcon=r),D(r)}),X("change",function(){O(e);const r=y();return D(r.isUseFaceIcon=!!r.isUseFaceIcon)}),m()}if(2&t){const e=y();ft("checked",e.isUseFaceIcon?"checked":""),We("ngModel",e.isUseFaceIcon)}}function kde(t,n){1&t&&(p(0,"b",38),x(1,"\u9854IC"),m())}function Pde(t,n){if(1&t&&(p(0,"option",39),x(1),m()),2&t){const e=y();ke("color",e.myColor),ft("value",null==e.myPeer?null:e.myPeer.identifier),h(),Mi("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function Fde(t,n){if(1&t&&(p(0,"option",40),x(1),m()),2&t){const e=n.$implicit;ke("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),ft("value",e.identifier),h(),Re(e.name)}}function Nde(t,n){if(1&t){const e=Ie();p(0,"button",41),X("click",function(){O(e);const r=y();return D(r.isUseChatBalloon=!r.isUseChatBalloon)}),p(1,"i",42),x(2),m()()}if(2&t){const e=y();_("title",e.isUseStandImageOnChatTab?"\u30c1\u30e3\u30c3\u30c8\u306e\u300c\u300d\u5185\u3092\u{1f4ad}\u306b\u8868\u793a":"\u73fe\u5728\u306e\u30bf\u30d6\u3067\u306f\u{1f4ad}\u306f\u7121\u52b9\u3067\u3059")("ngClass",Be(3,sB,e.isUseChatBalloon)),h(2),Re(e.isUseChatBalloon&&e.isUseStandImageOnChatTab?"textsms":"speaker_notes_off")}}function Rde(t,n){1&t&&(Me(0),x(1,"\uff08\u3042\u306a\u305f\uff09"),De())}function Lde(t,n){if(1&t&&(p(0,"option",39),x(1),L(2,Rde,2,0,"ng-container",29),m()),2&t){const e=n.$implicit,i=y();ke("color",e.color),ft("value",e.identifier),h(),Mi("",e.name," "),h(),_("ngIf",e===i.myPeer)}}function Bde(t,n){if(1&t&&(p(0,"option",48),x(1),m()),2&t){const e=n.$implicit;ft("value",e.id),h(),Re(e.game)}}function Ude(t,n){if(1&t&&(p(0,"optgroup",46),L(1,Bde,2,2,"option",47),m()),2&t){const e=n.$implicit;ft("label",e.index),h(),_("ngForOf",e.infos)}}function Hde(t,n){if(1&t){const e=Ie();p(0,"select",43,3),X("change",function(){O(e);const r=rn(1);return D(y().loadDiceBot(r.value))}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.gameType,r)||(o.gameType=r),D(r)}),p(2,"option",44),x(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),m(),L(4,Ude,2,2,"optgroup",45),m()}if(2&t){const e=y();We("ngModel",e.gameType),_("ngModelOptions",ad(4,cv))("ngClass",Be(5,qx,"DiceBot"==e.gameType||""==e.gameType)),h(4),_("ngForOf",e.diceBotInfosIndexed)}}function zde(t,n){if(1&t){const e=Ie();p(0,"select",49,3),X("change",function(){O(e);const r=rn(1);return D(y().loadDiceBot(r.value))}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.gameType,r)||(o.gameType=r),D(r)}),p(2,"option",44),x(3,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),m()()}if(2&t){const e=y();We("ngModel",e.gameType),_("ngModelOptions",ad(3,cv))("ngClass",Be(4,qx,"DiceBot"==e.gameType||""==e.gameType))}}function Vde(t,n){if(1&t&&(p(0,"option",48),x(1),m()),2&t){const e=n.$implicit;ft("value",e),h(),Re(e)}}function jde(t,n){if(1&t){const e=Ie();p(0,"div",50)(1,"span",51)(2,"button",52),X("click",function(){O(e);const r=y();return D(r.isUseStandImage=!r.isUseStandImage)}),p(3,"i",53),x(4),m()()(),p(5,"select",54),X("change",function(){return O(e),D(y().isUseStandImage=!0)}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.standName,r)||(o.standName=r),D(r)}),p(6,"option",19),x(7,"\u672a\u9078\u629e"),m(),L(8,Vde,2,2,"option",47),m(),p(9,"span",55)(10,"b",38),x(11,"Pos: "),m(),p(12,"input",56),X("change",function(){return O(e),D(y().isUseStandImage=!0)}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.character.standList.position,r)||(o.character.standList.position=r),D(r)}),m(),p(13,"input",57),X("change",function(){return O(e),D(y().isUseStandImage=!0)}),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.character.standList.position,r)||(o.character.standList.position=r),D(r)}),m(),p(14,"b",38),x(15,"\uff05"),m()(),p(16,"button",58),X("click",function(){return O(e),D(y().farewellStand())}),x(17,"\u9000\u53bb"),m()()}if(2&t){const e=y();_("ngClass",Be(14,Ede,!e.isUseStandImageOnChatTab))("title",e.isUseStandImageOnChatTab?"":"\u73fe\u5728\u306e\u30bf\u30d6\u3067\u306f\u30b9\u30bf\u30f3\u30c9\u306f\u7121\u52b9\u3067\u3059"),h(2),_("title",e.isUseStandImageOnChatTab?"\u30b9\u30bf\u30f3\u30c9\u3092\u8868\u793a":"\u73fe\u5728\u306e\u30bf\u30d6\u3067\u306f\u30b9\u30bf\u30f3\u30c9\u306f\u7121\u52b9\u3067\u3059")("ngClass",Be(16,sB,e.isUseStandImage)),h(2),Re(e.isUseStandImageOnChatTab&&e.isUseStandImage?"how_to_reg":"person_off"),h(),We("ngModel",e.standName),_("ngModelOptions",ad(18,cv))("ngClass",Be(19,qx,""==e.standName)),$t("disabled",e.isUseStandImageOnChatTab&&e.isUseStandImage?null:""),h(3),_("ngForOf",e.standNameList),h(4),We("ngModel",e.character.standList.position),$t("disabled",e.isUseStandImageOnChatTab&&e.isUseStandImage?null:""),h(),We("ngModel",e.character.standList.position),$t("disabled",e.isUseStandImageOnChatTab&&e.isUseStandImage?null:"")}}function Gde(t,n){if(1&t){const e=Ie();p(0,"input",59),$e("ngModelChange",function(r){O(e);const o=y();return Ge(o.paletteColor,r)||(o.paletteColor=r),D(r)}),m()}2&t&&(We("ngModel",y().paletteColor),_("ngModelOptions",ad(2,cv)))}function Wde(t,n){1&t&&(Ne(0,"div",66),It(1,"safe")),2&t&&ke("background-image",St(1,2,"url("+y().$implicit.imageUrl+")","style"))}function $de(t,n){1&t&&(p(0,"span",67),x(1,", "),m())}function Yde(t,n){if(1&t&&(p(0,"div",61),L(1,Wde,2,5,"div",62),p(2,"div",63)(3,"span",64),It(4,"safe"),x(5),m(),L(6,$de,2,0,"span",65),m()()),2&t){const e=n.$implicit,i=n.index,r=y(2);h(),_("ngIf",e.imageUrl),h(2),ke("color",St(4,5,e.color,"style")),h(2),Re(e.name),h(),_("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function qde(t,n){if(1&t&&(Me(0),L(1,Yde,7,8,"div",60),x(2," \u304c\u5165\u529b\u4e2d... "),De()),2&t){const e=y();h(),_("ngForOf",e.writingPeerNameAndColors)}}class Ia{get isUseStandImageOnChatTab(){const n=dt.instance.get(this.chatTabidentifier);return n&&n.isUseStandImage}get gameType(){return this._gameType}set gameType(n){this._gameType=n,this.gameTypeChange.emit(n)}get sendFrom(){return this._sendFrom}set sendFrom(n){this._sendFrom=n,this.sendFromChange.emit(n)}get sendTo(){return this._sendTo}set sendTo(n){this._sendTo=n,this.sendToChange.emit(n)}get text(){return this._text}set text(n){this._text=n,this.textChange.emit(n),null!=n&&this.isFilterTextUpdate&&(this.filterText=n)}get filterText(){return this._filterText}set filterText(n){this._filterText=n,this.filterTextChange.emit(n)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}static#e=this.history=new Array;static#t=this.MAX_HISTORY_NUM=1e3;get character(){let n=dt.instance.get(this.sendFrom);return n instanceof cn?n:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let n=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&null!=i.value&&""!=i.value.toString().trim()&&n.indexOf(i.value.toString())<0&&n.push(i.value.toString())}return this.character.standList.isSortNameList?n.sort():n}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let n={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(n[r]||(n[r]=[]),n[r].indexOf(i.value.toString())<0&&n[r].push(i.value.toString()))}return Object.keys(n).sort().map(i=>({name:i,stands:n[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let n=dt.instance.get(this.sendFrom),e=null;return n instanceof cn?e=n.imageFile:n instanceof Ce&&(e=n.image),e||_n.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:Ce.CHAT_TRANSPARENT_COLOR}set paletteColor(n){this.character.chatPalette.color=n||Ce.CHAT_TRANSPARENT_COLOR}get myColor(){return Ce.myCursor&&Ce.myCursor.color&&Ce.myCursor.color!=Ce.CHAT_TRANSPARENT_COLOR?Ce.myCursor.color:Ce.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=Ce.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let n=dt.instance.get(this.sendTo);return n instanceof Ce?n.color:Ce.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=dt.instance.getObjects(cn).filter(n=>this.allowsChat(n))),this._gameCharacters}get diceBotInfos(){return rr.diceBotInfos}get myPeer(){return Ce.myCursor}get otherPeers(){return[Ce.myCursor,...xt.peers.filter(n=>n.isOpen).map(n=>Ce.findByPeerId(n.peerId))].filter(n=>n)}get diceBotInfosIndexed(){return rr.diceBotInfosIndexed}constructor(n,e,i,r,o,s){this.ngZone=n,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=o,this.contextMenuService=s,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new Qn,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new Qn,this._sendTo="",this.sendToChange=new Qn,this._text="",this.textChange=new Qn,this.isFilterTextUpdate=!1,this._filterText="",this.filterTextChange=new Qn,this.moveToPalette=new Qn,this.chat=new Qn,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.isUseChatBalloon=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}ngOnInit(){U.register(this).on("MESSAGE_ADDED",n=>{if(n.data.tabIdentifier!==this.chatTabidentifier)return;let e=dt.instance.get(n.data.messageIdentifier),i=dt.instance.getObjects(Ce).find(o=>o.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on(`UPDATE_GAME_OBJECT/aliasName/${cn.aliasName}`,n=>{if(this.shouldUpdateCharacterList=!0,n.data.identifier!==this.sendFrom)return;let e=dt.instance.get(n.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",n=>{let e=dt.instance.get(this.sendTo);e instanceof Ce&&e.peerId===n.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",n=>{n.isSendFromSelf||n.data!==this.chatTabidentifier||(this.writingPeers.has(n.sendFrom)||this.writingPeers.set(n.sendFrom,new _d.b(()=>{this.writingPeers.delete(n.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(n.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){U.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(n=>{let e=Ce.findByPeerId(n);return{name:e?e.name:"",color:e?e.color:Ce.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let n=null;if(this.isDirect){let e=dt.instance.get(this.sendTo);if(e instanceof Ce){let i=ym.y.parse(e.peerId);i&&(n=i.peerId)}}U.call("WRITING_A_MESSAGE",this.chatTabidentifier,n),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(n,e){if(n&&n.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=Ia.history.length-1)return void(this.currentHistoryIndex=Ia.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=Ia.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}moveTo(n){this.textAreaElementRef&&this.textAreaElementRef.nativeElement.selectionStart==this.textAreaElementRef.nativeElement.selectionEnd&&this.textAreaElementRef.nativeElement.selectionStart===this.textAreaElementRef.nativeElement.value.length&&(this.moveToPalette.emit(this.text),n.preventDefault())}focusInput(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement.focus()}sendChat(n){var e=this;if(n&&n.preventDefault(),n&&13!==n.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let i=this.text,r=this.character;const o=this.gameType,s=this.sendFrom,a=this.sendTo,l=this.color,u=this.isUseFaceIcon,f=this.standName,g=this.isUseStandImage,v=this.isUseStandImageOnChatTab;""!=this.text&&(Ia.history=Ia.history.filter(E=>E!==this.text),Ia.history.unshift(this.text),Ia.history.length>=Ia.MAX_HISTORY_NUM&&Ia.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null),this.text="",this.previousWritingLength=this.text.length;const C=this.textAreaElementRef.nativeElement;C&&(C.value=""),this.calcFitHeight(),U.trigger("MESSAGE_EDITING_START",null),(0,R.A)(function*(){let E="",w=null;const T=[];if(""!=i&&/^[\\\uffe5]+[:\uff1a]/.test(i))i=i.replace(/[\\\uffe5]([:\uff1a])/,"$1");else if(""!=i&&_e.toHalfWidth(i).startsWith(":"))if(r){const S=_e.parseCommands(r.chatPalette.evaluate(i.substring(1),r.rootDataElement));if(i=S.endString,S.commands.length){const P=[`${""==r.name?"(\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc)":r.name} \u3078\u306e\u30b3\u30de\u30f3\u30c9\uff1a${S.commandString}`];let Z=!1;for(let ee=0;ee<S.commands.length;ee++){let B=null;try{const J=S.commands[ee];if(J.isIncomplete)throw"\u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a\u30b3\u30de\u30f3\u30c9\u4e0d\u5b8c\u5168\uff1a"+J.targetName;const le=r.chatPalette.evaluate(J.targetName,r.rootDataElement,T),se=_e.toHalfWidth(J.operator),fe=r.chatPalette.evaluate(J.value,r.rootDataElement,T);let Se,ue,Ue,Ze=!1,nt=!1;if((ue=r.detailDataElement.getFirstElementByNameUnsensitive(le))?(ue.isNumberResource||ue.isSimpleNumber||ue.isAbilityScore)&&(Ze=!0):(ue=r.detailDataElement.getFirstElementByNameUnsensitive(le,/^\u6700\u5927/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/^Max[\:\_\-\s]*/i)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/^\u521d\u671f/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/\u521d\u671f\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/\u6700\u5927\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/^\u57fa\u672c/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/^\u539f/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/\^$/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/\u57fa\u672c\u5024$/)||r.detailDataElement.getFirstElementByNameUnsensitive(le,/\u539f\u70b9$/))&&(ue.isNumberResource||ue.isAbilityScore?(Ze=!0,nt=!0):ue=null),!ue)throw`\u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a${""==_e.cr(le).trim()?"(\u7121\u540d\u306e\u5909\u6570)":_e.cr(le).trim()} \u306f\u898b\u3064\u304b\u3089\u306a\u304b\u3063\u305f`;Se=ue.loggingValue;let be=null;if(J.isEscapeRoll||">"===se)be=fe;else{const tt=_e.toHalfWidth(fe.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).trim();if(""==_e.cr(tt))be="";else if(/^[\+\-]?\d+$/.test(tt)?be=parseInt(tt):/^[\d\+\-\*\/\(\)]+$/.test(tt.replace(/[\u216e\xd0]/g,"D").replace(/\xd7/g,"*").replace(/\xf7/g,"/"))?B=yield rr.rollCommandAsync(`C(${tt.replace(/[\u216e\xd0]/g,"D").replace(/\xd7/g,"*").replace(/\xf7/g,"/")})`,o||"DiceBot"):/^[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45]/i.test(fe)||/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(tt.replace(/[\u216e\xd0]/g,"D").replace(/\xd7/g,"*").replace(/\xf7/g,"/"))||Nc.instance.diceRollTables.some(lt=>null!=lt.command&&new RegExp("^"+_e.toHalfWidth(lt.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toUpperCase().trim()+"([=+\\-]\\d*)?$").test(tt.toUpperCase()))?B=yield rr.rollCommandAsync(fe,o||"DiceBot"):be=fe,B){let lt=null;Ze&&B.result.length>0&&(lt=B.result.match(/\s\uff1e\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))?be=lt[1]:ue.isCheckProperty&&(B.isSuccess||B.isFailure)?be=B.isSuccess?"1":"0":B.result.length>0&&(be=B.isDiceRollTable?B.result.split(/\s\uff1e\s/).slice(1).join(""):B.result.split(/\s\uff1e\s/).slice(-1)[0])}else Ze||(be=fe)}if(null==be||B&&B.isDiceRollTable&&B.isFailure||Ze&&""!==be&&isNaN(be))throw`\u2192 ${""==ue.name?"(\u7121\u540d\u306e\u5909\u6570)":ue.name} \u3092\u64cd\u4f5c \u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a`+J.operator+J.value;if(ue.isUrl&&!_e.validUrl(_e.cr(be)))throw`\u2192 ${""==ue.name?"(\u7121\u540d\u306e\u5909\u6570)":ue.name} \u3092\u64cd\u4f5c \u2192 URL\u4e0d\u6b63\uff1a`+J.value;if(">"===se)if(Ze)if(""!=be)if(ue.isNumberResource&&!nt){const tt=parseInt(ue.currentValue+"");ue.currentValue=parseInt(be),Ue=(parseInt(be)-tt).toString()}else{const tt=null==ue.value?0:parseInt(ue.value+"");ue.value=parseInt(be),Ue=(parseInt(be)-tt).toString()}else Ue="0";else ue.value=ue.isCheckProperty?""==be||0==parseInt(be)||"off"===_e.toHalfWidth(be).toLowerCase()||"\u2610"===_e.toHalfWidth(be).toLowerCase()?"":ue.name:ue.isNote||ue.isUrl?_e.cr(be):_e.cr(be).replace(/(:?\r\n|\r|\n)/g," ");else if(ue.isNumberResource&&!nt)if(null!=be&&""!=be.toString()){const tt=parseInt(ue.currentValue+""),lt=parseInt(ue.currentValue&&"="!==se?ue.currentValue.toString():"0")+parseInt(be)*("-"===se?-1:1);lt<=parseInt(ue.currentValue+"")?ue.currentValue=lt:lt>parseInt(ue.value+"")&&parseInt(ue.currentValue+"")<parseInt(ue.value+"")&&0!=parseInt(ue.value+"")?ue.currentValue=ue.value:(lt<=parseInt(ue.value+"")||0==parseInt(ue.value+""))&&(ue.currentValue=lt),Ue=(parseInt(ue.currentValue+"")-tt).toString()}else Ue="0";else if(Ze){const tt=null==ue.currentValue?0:parseInt(ue.value.toString());null!=be&&""!=be.toString()&&(ue.value=parseInt(ue.value&&"="!==se?ue.value+"":"0")+parseInt(be)*("-"===se?-1:1)),Ue=(parseInt(ue.value+"")-tt).toString()}else if(ue.isCheckProperty)switch(se){case"=":ue.value=""===be||0===parseInt(be)||"off"===_e.toHalfWidth(be).toLowerCase()||"\u2610"===_e.toHalfWidth(be).toLowerCase()?"":ue.name;break;case"+":ue.value=ue.name;break;case"-":ue.value=""}else{if("="!==se)throw`\u2192 ${""===ue.name?"(\u7121\u540d\u306e\u5909\u6570)":ue.name} \u3092\u64cd\u4f5c \u2192 \u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a`+J.operator+J.value;ue.value=ue.isNote||ue.isUrl?isNaN(be)||""===be||ue.isUrl?_e.cr(be):parseInt(be):isNaN(be)||""===be?_e.cr(be).replace(/(:?\r\n|\r|\n)/g," "):parseInt(be)}const Ye=ue.loggingValue;let Ke=`\u2192 ${""===ue.name?"(\u7121\u540d\u306e\u5909\u6570)":ue.name} \u3092\u64cd\u4f5c`;Ke+=Ze?` ${Se} \u2192 ${Se===Ye?"\u5909\u66f4\u306a\u3057":Ye}`:ue.isCheckProperty?`${Se===Ye?" \u5909\u66f4\u306a\u3057":Ye}`:` "${Se}" \u2192 ${Se===Ye?"\u5909\u66f4\u306a\u3057":'"'+Ye+'"'}`,B&&(Ke+=B.isDiceRollTable?` (${B.tableName}\uff1a${B.isEmptyDice?"":"\u{1f3b2}"}${B.result.split(/\s\uff1e\s/)[0]})`:` (${B.result.split(/\s\uff1e\s/g).map((tt,lt)=>0==lt?B.isEmptyDice?"\u8a08\u7b97\u7d50\u679c":"\u{1f3b2}"+o+"\uff1a"+tt.replace(/^c?\(/i,"").replace(/\)$/,""):tt).join(" \u2192 ")})`,B.isEmptyDice||(Z=!0)),P.push(Ke),T.push(Ue??"")}catch(J){if(J instanceof Error)throw J;P.push(J),T.push("");continue}}P.length&&e.chatMessageService.sendOperationLog(P.join("\n")),Z&&(Math.random()<.5?ze.play(pe.diceRoll1):ze.play(pe.diceRoll2))}}else e.chatMessageService.sendOperationLog("\u30b3\u30de\u30f3\u30c9\u30a8\u30e9\u30fc\uff1a\u5bfe\u8c61\u304c\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306f\u306a\u3044");if(r&&(i=r.chatPalette.evaluate(i,r.rootDataElement,T),(_e.cr(i).trim()||f)&&r.standList)){let S=null;S=u&&r.faceIcon?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:null;const P=r.standList.matchStandInfo(i,S,f);if(g&&v)if(P.farewell)e.farewellStand(r);else if(P.standElementIdentifier){w=P.standElementIdentifier;const Z={characterIdentifier:r.identifier,standIdentifier:P.standElementIdentifier,color:r.chatPalette?r.chatPalette.color:Ce.CHAT_DEFAULT_COLOR,secret:!!a};if(Z.secret){const ee=dt.instance.get(a);ee&&(ee.peerId!=Ce.myCursor.peerId&&U.call("POPUP_STAND_IMAGE",Z,ee.peerId),U.call("POPUP_STAND_IMAGE",Z,Ce.myCursor.peerId))}else U.call("POPUP_STAND_IMAGE",Z)}E=P.matchMostLongText}const M=Lc.instance.matchCutInInfo(i);if(v&&M){for(const S of M.identifiers){const P={identifier:S,secret:!!a,sender:Ce.myCursor.peerId};if(P.secret){const Z=dt.instance.get(a);Z&&(Z.peerId!=Ce.myCursor.peerId&&U.call("PLAY_CUT_IN",P,Z.peerId),U.call("PLAY_CUT_IN",P,Ce.myCursor.peerId))}else U.call("PLAY_CUT_IN",P)}if(M.names&&M.names.length&&!a){const S=new Map;for(const Z of M.names){let ee=S.get(Z)||0;ee+=1,S.set(""==Z?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":Z,ee)}const P=`${[...S.keys()].map(Z=>S.get(Z)>1?`${Z}\xd7${S.get(Z)}`:Z).join("\u3001")}`;e.chatMessageService.sendOperationLog(P+" \u304c\u8d77\u52d5\u3057\u305f")}}if(E.length<M.matchMostLongText.length&&(E=M.matchMostLongText),i=i.slice(0,i.length-E.length),e.isUseChatBalloon&&v&&r&&_e.cr(i).trim()){const S=/^(([s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50][e\uff25\uff45][a\uff21\uff41][t\uff34\uff54]|[s\uff33\uff53][r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[r\uff32\uff52][e\uff25\uff45][p\uff30\uff50]|[s\uff33\uff53][x\uff38\uff58]|[x\uff38\uff58])?([\d\uff10-\uff19]+)?[ \u3000]+)?([\s\S]*)?/gim.exec(i);let Z,P=null!=S[4]?S[4].trim():i.trim();/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*)[ \u3000]+([^ \u3000]*)/gi.test(P)?P="":((Z=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\[\uff3b][^\]\uff3d]+[\]\uff3d])/gi.exec(P))||(Z=/^([s\uff33\uff53]?[c\uff23\uff43][h\uff28\uff48][o\uff2f\uff4f][i\uff29\uff49][c\uff23\uff43][e\uff25\uff45][\d\uff10-\uff19]*[\(\uff08][^\)\uff09]+[\)\uff09])/gi.exec(P)))&&(P=P.slice(Z[1].length));let B,J=[];if(null!==(B=/\u300c+([\s\S]+?)\u300d/gm.exec(P))&&J.push(B[1]),0===J.length){const le=P.split(/[\s\u3000]/).slice(-1)[0];_e.isEmote(le)&&J.push(le)}if(J.length>0){const le={characterIdentifier:r.identifier,text:J.join("\n\n"),faceIconIdentifier:u&&r.faceIcon?r.faceIcon.identifier:null,color:l,secret:!!a};if(le.secret){const se=dt.instance.get(a);se&&(se.peerId!=Ce.myCursor.peerId&&U.call("POPUP_CHAT_BALLOON",le,se.peerId),U.call("POPUP_CHAT_BALLOON",le,Ce.myCursor.peerId))}else U.call("POPUP_CHAT_BALLOON",le)}else _e.cr(i).trim()&&r.text&&U.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:r.identifier})}Ce.isGMHold&&!a&&!Ce.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(_e.toHalfWidth(i))&&(Ce.myCursor.isGMMode=!0,e.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),U.trigger("CHANGE_GM_MODE",null)),_e.cr(i).trim()&&e.chat.emit({text:i,gameType:o,sendFrom:s,sendTo:a,color:l,isInverse:!!r&&r.isInverse,isHollow:!!r&&r.isHollow,isBlackPaint:!!r&&r.isBlackPaint,aura:r?r.aura:-1,isUseFaceIcon:u,characterIdentifier:r?r.identifier:null,standIdentifier:w,standName:f,isUseStandImage:g&&v})})()}calcFitHeight(){let n=this.textAreaElementRef.nativeElement;n.style.height="",n.scrollHeight>=n.offsetHeight&&(n.style.height=n.scrollHeight+"px")}loadDiceBot(n){console.log("onChangeGameType ready"),rr.getHelpMessage(n).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){rr.getHelpMessage(this.gameType).then(n=>{this.gameHelp=n;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let s of rr.diceBotInfos)s.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+s.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],o=this.panelService.open(gp,{left:i.x,top:i.y,width:600,height:500});o.title=e,o.text=this.gameHelp})}onContextMenu(n){if(n.stopPropagation(),n.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831...",action:()=>{this.panelService.open(A3,{width:520,height:600,top:e.y-100,left:e.x-100})}}],Ce.myCursor.name,null,Ce.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,o=this.text.trim();"\u300c"!=o.slice(0,1)&&(o="\u300c"+o),"\u300d"!=o.slice(-1)&&(o+="\u300d"),this.text=o,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(At),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,o)=>({name:this.character.currntIconIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=o&&(this.character.currntIconIndex=o)},default:this.character.currntIconIndex==o,icon:r,checkBox:"radio"})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(At),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,o)=>({name:this.character.currntImageIndex==o?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=o,ze.play(pe.surprise),U.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==o,icon:r,checkBox:"radio"}))})),i.push(At),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"},At].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,o)=>({name:`${this.character.aura==o?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=o,U.trigger("UPDATE_INVENTORY",null)},colorSample:!0,checkBox:"radio"})))},At,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,U.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(At),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(n=null){if(n||(n=this.character),this.character){const e={characterIdentifier:this.character.identifier};if(this.sendTo){const i=dt.instance.get(this.sendTo);i&&(i.peerId!=Ce.myCursor.peerId&&U.call("FAREWELL_STAND_IMAGE",e,i.peerId),U.call("FAREWELL_STAND_IMAGE",e,Ce.myCursor.peerId))}else U.call("FAREWELL_STAND_IMAGE",e)}}showDetail(n){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";n.name.length&&(i+=" - "+n.name),this.panelService.open(lc,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=n}showChatPalette(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Hm,{left:e.x-250,top:e.y-175,width:620,height:350}).character=n}showStandSetting(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(ev,{left:e.x-400,top:e.y-175,width:730,height:572}).character=n}allowsChat(n){if(!n.isAllowsChat)return!1;switch(n.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of xt.peers)if(e.isOpen&&n.location.name===e.peerId)return!1;return!0}}static#n=this.\u0275fac=function(e){return new(e||Ia)(F(Sn),F(Do),F(Nx),F(bi),F(hr),F(Xo))};static#i=this.\u0275cmp=xn({type:Ia,selectors:[["chat-input"]],viewQuery:function(e,i){if(1&e&&Dn(vde,7),2&e){let r;On(r=An())&&(i.textAreaElementRef=r.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:[ae.None,"gameType","_gameType"],_sendFrom:[ae.None,"sendFrom","_sendFrom"],_sendTo:[ae.None,"sendTo","_sendTo"],_text:[ae.None,"text","_text"],_filterText:[ae.None,"filterText","_filterText"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",filterTextChange:"filterTextChange",moveToPalette:"moveToPalette",chat:"chat"},decls:38,vars:35,consts:[["isCharacter",""],["textArea",""],["noFaceIcon",""],["select",""],[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px","padding-right","2px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],[1,"table-cell"],[1,"ff-flex"],[2,"margin-right","2px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller",4,"ngIf"],[2,"white-space","nowrap"],[3,"ngModelChange","change","ngModel","ngStyle"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],["class","indicate ff-button speech-bubble-indicate",3,"title","ngClass","click",4,"ngIf"],[2,"display","inline-block","margin","auto 2px","text-align","center"],[2,"max-width","9.5em",3,"ngModelChange","ngModel","ngClass","ngStyle"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[1,"ff-button","dicebot-help",2,"cursor","help",3,"click"],["style","font-size: smaller; margin-top: 1px",3,"ngClass","title",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"ngModelChange","input","keydown.enter","focus","blur","keydown.control.arrowup","keydown.control.arrowdown","keydown.arrowdown","placeholder","ngModel","ngModelOptions"],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModelChange","change","ngModel","checked"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[1,"indicate","ff-button","speech-bubble-indicate",3,"click","title","ngClass"],[1,"material-icons",2,"font-size","0.8em"],[2,"width","12em",3,"change","ngModelChange","ngModel","ngModelOptions","ngClass"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"change","ngModelChange","ngModel","ngModelOptions","ngClass"],[2,"font-size","smaller","margin-top","1px",3,"ngClass","title"],[2,"font-size","medium"],[1,"indicate","ff-button","stand-indicate",2,"font-size","0.8em","padding","1px","height","1.3rem","width","1.3rem","margin-left","2px","margin-right","2px",3,"click","title","ngClass"],[1,"material-icons",2,"font-size","12px","overflow","hidden","vertical-align","text-bottom"],[2,"width","10em","margin-right","3px",3,"change","ngModelChange","ngModel","ngModelOptions","ngClass"],[2,"white-space","nowrap","margin-left","0.6em","display","inline-block"],["type","range","min","0","max","100",2,"width","176px",3,"change","ngModelChange","ngModel"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"change","ngModelChange","ngModel"],["type","button",2,"margin-left","0.6em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModelChange","ngModel","ngModelOptions"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"display","inline"],[1,"peer-name",2,"font-weight","bold"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(e,i){if(1&e){const r=Ie();p(0,"div",4)(1,"div",5),X("contextmenu",function(s){return O(r),D(i.onContextMenu(s))}),L(2,Ide,2,1,"div",6)(3,Ode,3,2,"ng-template",null,0,Pi),m(),p(5,"div",7)(6,"div",8)(7,"label",9),L(8,Ade,1,2,"input",10)(9,kde,2,0,"b",11),m(),p(10,"span",12)(11,"select",13),$e("ngModelChange",function(s){return O(r),Ge(i.sendFrom,s)||(i.sendFrom=s),D(s)}),X("change",function(){return O(r),D(i.standName="")}),L(12,Pde,2,4,"option",14)(13,Fde,2,4,"option",15),m(),L(14,Nde,3,5,"button",16),m(),p(15,"span",12)(16,"span",17),x(17,"\u27a1"),m(),p(18,"select",18),$e("ngModelChange",function(s){return O(r),Ge(i.sendTo,s)||(i.sendTo=s),D(s)}),p(19,"option",19),x(20,"\u5168\u54e1"),m(),L(21,Lde,3,5,"option",20),m()(),p(22,"span",12),L(23,Hde,5,7,"select",21)(24,zde,4,6,"select",22),p(25,"button",23),X("click",function(){return O(r),D(i.showDicebotHelp())}),x(26,"?"),m()()(),L(27,jde,18,21,"div",24),p(28,"div")(29,"form"),L(30,Gde,1,3,"input",25),p(31,"textarea",26,1),$e("ngModelChange",function(s){return O(r),Ge(i.text,s)||(i.text=s),D(s)}),X("input",function(){return O(r),D(i.onInput())})("keydown.enter",function(s){return O(r),D(i.sendChat(s))})("focus",function(){return O(r),D(i.isFilterTextUpdate=!0)})("blur",function(){return O(r),D(i.isFilterTextUpdate=!1)})("keydown.control.arrowup",function(s){return O(r),D(i.moveHistory(s,1))})("keydown.control.arrowdown",function(s){return O(r),D(i.moveHistory(s,-1))})("keydown.arrowdown",function(s){return O(r),D(i.moveTo(s))}),m(),p(33,"button",27),X("click",function(){return O(r),D(i.sendChat(null))}),p(34,"b"),x(35,"SEND"),m()()()(),p(36,"div",28),L(37,qde,3,1,"ng-container",29),m()()()}if(2&e){const r=rn(4);_("ngClass",Be(24,yde,i.isDirect)),h(2),_("ngIf",!i.character)("ngIfElse",r),h(6),_("ngIf",i.character),h(),_("ngIf",i.character),h(2),ke("max-width",i.character?"10em":"13em"),We("ngModel",i.sendFrom),_("ngStyle",Cn(26,oB,i.color,i.sendFrom!=(null==i.myPeer?null:i.myPeer.identifier)?"normal":"bolder")),h(),_("ngIf",!i.onlyCharacters),h(),_("ngForOf",i.gameCharacters),h(),_("ngIf",i.character),h(4),We("ngModel",i.sendTo),_("ngClass",Be(29,qx,""==i.sendTo))("ngStyle",Cn(31,oB,""==i.sendTo?null:i.sendToColor,""==i.sendTo?"normal":"bolder")),h(3),_("ngForOf",i.otherPeers),h(2),_("ngIf",i.diceBotInfosIndexed.length>0),h(),_("ngIf",i.diceBotInfosIndexed.length<1),h(3),_("ngIf",i.hasStand),h(3),_("ngIf",i.onlyCharacters),h(),_("placeholder",i.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148"),We("ngModel",i.text),_("ngModelOptions",ad(34,cv)),h(6),_("ngIf",0<i.writingPeerNameAndColors.length)}},dependencies:[Fi,nr,ni,Zo,sp,ya,Ca,Rr,Xl,Kl,Wa,wl,Lr,op,pd,fd,Tr,hd,fr],styles:['.speech-bubble-indicate[_ngcontent-%COMP%]{font-size:.8em;padding:1px;height:1.3rem;width:1.3rem;margin-left:1px;margin-right:2px}.dicebot-help[_ngcontent-%COMP%]{padding:2px 6px;vertical-align:baseline;font-size:.8em;height:1.3rem;width:1.3rem}@-moz-document url-prefix(){.ff-flex{display:flex}.ff-button{display:inline-block;width:initial!important;height:auto!important}.speech-bubble-indicate{padding:5px 7px!important}.dicebot-help{padding:5px 8px!important}.stand-indicate{padding:4px 5px!important}}[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out;pointer-events:none}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em;margin-bottom:1px}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}.mini-face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.mini-face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:50% 0%;border-radius:.2rem}']})}const Zde=["edit"],Xde=(t,n)=>({compact:t,editing:n}),Kde=(t,n,e,i,r,o)=>({"is-mine":t,"is-others":n,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":o}),Qde=(t,n,e,i)=>({"is-success":t,"is-failure":n,"is-critical":e,"is-fumble":i}),Jde=(t,n)=>({inverse:t,hollow:n}),ehe=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),the=(t,n)=>({"black-paint":t,"face-icon":n}),N3=t=>({grow:t});function nhe(t,n){1&t&&ti(0)}function ihe(t,n){if(1&t&&(Me(0),L(1,nhe,1,0,"ng-container",12),De()),2&t){y();const e=rn(11);h(),_("ngTemplateOutlet",e)}}function rhe(t,n){1&t&&ti(0)}function ohe(t,n){if(1&t&&(Me(0),L(1,rhe,1,0,"ng-container",12),De()),2&t){y();const e=rn(13);h(),_("ngTemplateOutlet",e)}}function she(t,n){1&t&&ti(0)}function ahe(t,n){1&t&&ti(0)}function lhe(t,n){if(1&t&&(p(0,"div"),L(1,ahe,1,0,"ng-container",12),m()),2&t){y();const e=rn(19);h(),_("ngTemplateOutlet",e)}}function che(t,n){1&t&&ti(0)}function uhe(t,n){if(1&t&&(Me(0),L(1,che,1,0,"ng-container",12),De()),2&t){y();const e=rn(13);h(),_("ngTemplateOutlet",e)}}function dhe(t,n){1&t&&ti(0)}function hhe(t,n){if(1&t&&(Me(0),L(1,dhe,1,0,"ng-container",12),De()),2&t){y();const e=rn(11);h(),_("ngTemplateOutlet",e)}}function fhe(t,n){if(1&t&&(Ne(0,"img",16),It(1,"safe")),2&t){const e=y(2);_("src",St(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),gn)("ngClass",Cn(5,the,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}function phe(t,n){if(1&t&&(p(0,"div",13)(1,"span",14),L(2,fhe,2,8,"img",15),m()()),2&t){const e=y();_("ngClass",Cn(3,Jde,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),h(),_("ngClass",Dc(6,ehe,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),h(),_("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function ghe(t,n){if(1&t&&(Me(0),p(1,"span",20),x(2),It(3,"date"),m(),De()),2&t){const e=y(2);h(2),Re(St(3,1,e.chatMessage.timestamp,"H:mm"))}}function mhe(t,n){if(1&t&&(Ne(0,"img",23),It(1,"safe")),2&t){const e=y(3);_("src",St(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),gn)}}function _he(t,n){1&t&&(Me(0),x(1,"\uff08\u3042\u306a\u305f\uff09"),De())}function bhe(t,n){if(1&t&&(Me(0),L(1,mhe,2,4,"img",21),p(2,"span",19),x(3),L(4,_he,2,0,"ng-container",8),m(),p(5,"span",22),x(6,"\u27a1"),m(),De()),2&t){const e=y(2);h(),_("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),h(),ke("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),_("ngClass",Be(6,N3,e.chatMessage.isDirect||e.chatMessage.isSecret)),h(),Re(e.chatMessage.toName),h(),_("ngIf",e.chatMessage.isSendToMe)}}function vhe(t,n){if(1&t&&(Ne(0,"img",23),It(1,"safe")),2&t){const e=y(3);_("src",St(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),gn)}}function yhe(t,n){1&t&&(Me(0),x(1,"\uff08\u3042\u306a\u305f\uff09"),De())}function Che(t,n){if(1&t&&(Me(0),p(1,"span",24),x(2,"\u27a1"),m(),L(3,vhe,2,4,"img",21),p(4,"span",19),x(5),L(6,yhe,2,0,"ng-container",8),m(),De()),2&t){const e=y(2);h(3),_("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),h(),ke("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),_("ngClass",Be(6,N3,e.chatMessage.isDirect||e.chatMessage.isSecret)),h(),Re(e.chatMessage.toName),h(),_("ngIf",e.chatMessage.isSendToMe)}}function xhe(t,n){if(1&t){const e=Ie();p(0,"span",28),It(1,"safe"),X("click",function(r){return O(e),D(y(3).onLinkClick(r))}),m()}2&t&&_("innerHTML",St(1,1,y(3).htmlEscapedFrom,"html"),eo)}function whe(t,n){if(1&t&&(p(0,"span",20),x(1),It(2,"date"),m()),2&t){const e=y(3);h(),Re(St(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function Ehe(t,n){if(1&t&&(p(0,"span",20),x(1),It(2,"date"),m()),2&t){const e=y(3);h(),Re(St(2,1,e.chatMessage.timestamp,"H:mm"))}}function The(t,n){1&t&&ti(0)}function Ihe(t,n){if(1&t&&(Me(0),L(1,xhe,2,4,"span",25)(2,whe,3,4,"span",26)(3,Ehe,3,4,"span",26)(4,The,1,0,"ng-container",27),De()),2&t){const e=y(2),i=rn(19);h(),_("ngIf",!e.isCompact),h(),_("ngIf",!e.isCompact&&e.chatMessage.timestamp),h(),_("ngIf",e.isCompact&&e.chatMessage.timestamp),h(),_("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function She(t,n){if(1&t&&(p(0,"div",17),L(1,ghe,4,4,"ng-container",8),p(2,"span",18),L(3,bhe,7,8,"ng-container",8),p(4,"span",19),x(5),m(),L(6,Che,7,8,"ng-container",8),m(),L(7,Ihe,5,5,"ng-container",8),m()),2&t){const e=y();h(),_("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),h(2),_("ngIf",!e.isMine&&e.chatMessage.toColor&&e.isGMMode),h(),ke("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),_("ngClass",Be(8,N3,e.chatMessage.isDirect||e.chatMessage.isSecret)),h(),Re(e.chatMessage.name),h(),_("ngIf",e.isMine&&e.chatMessage.toColor),h(),_("ngIf",!e.isCompact||e.isMine)}}function Mhe(t,n){if(1&t){const e=Ie();p(0,"div",34)(1,"span",35),x(2),m(),p(3,"textarea",36,5),$e("ngModelChange",function(r){O(e);const o=y(2);return Ge(o.editingText,r)||(o.editingText=r),D(r)}),X("keydown.enter",function(r){return O(e),D(y(2).editEnd(r))})("keydown.escape",function(){return O(e),D(y(2).editCancel())}),m()()}if(2&t){const e=y(2);h(2),Re(e.lastNewLineAdjust(e.editingText)),h(),We("ngModel",e.editingText)}}function Dhe(t,n){if(1&t&&(p(0,"span",37)(1,"b",38),x(2,"\u7de8\u96c6\u6e08"),m(),x(3),It(4,"date"),m()),2&t){const e=y(2);h(3),Mi(" ",St(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function Ohe(t,n){if(1&t){const e=Ie();p(0,"button",39),X("click",function(){return O(e),D(y(2).discloseMessage())}),x(1,"\u7d50\u679c\u3092\u516c\u958b"),m()}}function Ahe(t,n){if(1&t){const e=Ie();L(0,Mhe,5,2,"div",29),p(1,"div")(2,"span",30)(3,"span",31),It(4,"safe"),X("click",function(r){return O(e),D(y().onLinkClick(r))}),m(),L(5,Dhe,5,4,"span",32)(6,Ohe,2,0,"button",33),m()()}if(2&t){const e=y();_("ngIf",e.isEditing),h(),ke("display",e.isEditing?"none":"block"),h(2),ke("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),_("innerHTML",St(4,8,e.htmlEscapedText,"html"),eo),h(2),_("ngIf",!e.isEditing&&e.chatMessage.isEdited),h(),_("ngIf",e.chatMessage.isSecret)}}function khe(t,n){1&t&&(p(0,"span")(1,"s"),x(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),m()())}function Phe(t,n){if(1&t){const e=Ie();p(0,"button",45),X("click",function(){return O(e),D(y(2).editStart())}),p(1,"i",46),x(2,"edit"),m()()}}function Fhe(t,n){1&t&&(p(0,"button",47)(1,"i",46),x(2,"clear"),m()())}function Nhe(t,n){if(1&t){const e=Ie();p(0,"button",48),X("click",function(){return O(e),D(y(2).editEnd())}),p(1,"i",46),x(2,"done"),m()()}2&t&&_("disabled",0==y(2).editingText.trim().length)}function Rhe(t,n){if(1&t){const e=Ie();p(0,"button",49),X("click",function(){return O(e),D(y(2).editCancel())}),p(1,"i",46),x(2,"clear"),m()()}}function Lhe(t,n){if(1&t&&(p(0,"span",40),L(1,Phe,3,0,"button",41)(2,Fhe,3,0,"button",42)(3,Nhe,3,1,"button",43)(4,Rhe,3,0,"button",44),m()),2&t){const e=y();h(),_("ngIf",!e.isEditing),h(),_("ngIf",!e.isEditing),h(),_("ngIf",e.isEditing),h(),_("ngIf",e.isEditing)}}let Bhe=(()=>{class t{get isGMMode(){return this.chatMessage.isGMMode}constructor(e,i){this.modalService=e,this.changeDetector=i,this.compact=!1,this.imageFile=_n.Empty,this.isEditing=!1,this.editingText="",this.stringUtil=_e}ngOnInit(){U.register(this).on("MESSAGE_EDITING_START",-1e3,i=>{i.isSendFromSelf&&(!i.data||i.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",i=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e)}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=Ki.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=_e.escapeHtml(e),r&&(e=_e.rubyToHtml(e)),P5.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(o){if("url"==o.getType()&&_e.validUrl(o.getAnchorHref())){if(_e.sameOrigin(o.getAnchorHref()))return!0;{const s=o.buildTag();return s.setAttr("rel","noreferrer"),s.addClass("outer-link"),s}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){U.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!_e.sameOrigin(i))return e.preventDefault(),this.modalService.open(xa,{url:e.target.getAttribute("href")}),!1}return!0}static#e=this.\u0275fac=function(i){return new(i||t)(F(Ii),F(io))};static#t=this.\u0275cmp=xn({type:t,selectors:[["chat-message"]],viewQuery:function(i,r){if(1&i&&Dn(Zde,5),2&i){let o;On(o=An())&&(r.editElm=o.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[xr([{provide:I4,useValue:!1}])],decls:20,vars:36,consts:[["image",""],["title",""],["visible",""],["secret",""],["editor",""],["edit",""],[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"click","innerHTML"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"click","innerHTML"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModelChange","keydown.enter","keydown.escape","ngModel"],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"click","disabled"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(i,r){if(1&i&&(p(0,"div",6)(1,"div",7),L(2,ihe,2,1,"ng-container",8),p(3,"div",9),L(4,ohe,2,1,"ng-container",8),p(5,"div",10),L(6,she,1,0,"ng-container",11),m(),L(7,lhe,2,1,"div",8)(8,uhe,2,1,"ng-container",8),m(),L(9,hhe,2,1,"ng-container",8),m()(),L(10,phe,3,15,"ng-template",null,0,Pi)(12,She,8,10,"ng-template",null,1,Pi)(14,Ahe,7,11,"ng-template",null,2,Pi)(16,khe,3,0,"ng-template",null,3,Pi)(18,Lhe,5,4,"ng-template",null,4,Pi)),2&i){const o=rn(15),s=rn(17);_("ngClass",Cn(21,Xde,r.isCompact,r.isEditing)),h(),ke("border-left-color",!r.chatMessage.isSystem||r.chatMessage.isDicebot||r.chatMessage.isCalculate?r.chatMessage.color:"#444444")("border-right-color",!r.chatMessage.isSystem||r.chatMessage.isDicebot||r.chatMessage.isCalculate?r.chatMessage.color:"#444444"),_("ngClass",ST(24,Kde,r.isMine,!r.isMine,r.chatMessage.isDirect||r.chatMessage.isSecret,r.chatMessage.isSystem,r.chatMessage.isDicebot||r.chatMessage.isCalculate,r.chatMessage.isOperationLog))("@flyInOut",r.isMine?null:"active")("@flyInOutMe",r.isMine?"active":null),h(),_("ngIf",r.isMine&&!r.isCompact),h(),ke("justify-content",r.isCompact&&!r.isMine?"flex-end":"flex-start"),h(),_("ngIf",!r.isCompact||r.isMine),h(),ke("flex-grow",r.isCompact&&!r.isEditing?0:1),_("ngClass",yl(31,Qde,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isSuccess,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isFailure,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isCritical,(!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf)&&r.chatMessage.isFumble)),h(),_("ngIf",!r.chatMessage.isSecret||r.chatMessage.isSendFromSelf||r.isGMMode)("ngIfThen",o)("ngIfElse",s),h(),_("ngIf",r.isEditable&&r.isCompact),h(),_("ngIf",r.isCompact&&!r.isMine),h(),_("ngIf",!r.isMine&&!r.isCompact)}},dependencies:[Fi,ni,ip,Rr,Lr,Tr,kF,fr],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden;display:none}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{visibility:visible;display:inline-block}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #999) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[Vn("flyInOut",[Xt("* => active",[jt("200ms ease-out",mn([Pe({transform:"translateX(100px)",opacity:"0",offset:0}),Pe({transform:"translateX(0)",opacity:"1",offset:1})]))]),Xt("void => *",[jt("200ms ease-out",mn([Pe({opacity:"0",offset:0}),Pe({opacity:"1",offset:1})]))])]),Vn("flyInOutMe",[Xt("* => active",[jt("200ms ease-out",mn([Pe({transform:"translateX(-100px)",opacity:"0",offset:0}),Pe({transform:"translateX(0)",opacity:"1",offset:1})]))]),Xt("void => *",[jt("200ms ease-out",mn([Pe({opacity:"0",offset:0}),Pe({opacity:"1",offset:1})]))])])]}})}return t})();const Uhe=["logContainer"],Hhe=["messageContainer"];function zhe(t,n){if(1&t&&Ne(0,"chat-message",7),2&t){const e=y().$implicit,i=y(2);_("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||i.checkAnimated(e))}}function Vhe(t,n){if(1&t&&(Me(0),L(1,zhe,1,3,"chat-message",6),De()),2&t){const e=n.$implicit;h(),_("ngIf",e.isDisplayable)}}function jhe(t,n){if(1&t&&(Me(0),L(1,Vhe,2,1,"ng-container",5),De()),2&t){const e=y();h(),_("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function Ghe(t,n){if(1&t&&Ne(0,"chat-message",7),2&t){const e=n.$implicit,i=y(2);_("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||i.checkAnimated(e))}}function Whe(t,n){if(1&t&&(Me(0),L(1,Ghe,1,3,"chat-message",8),De()),2&t){const e=y();h(),_("ngForOf",e.sampleMessages)}}const R3=window.navigator.userAgent.toLowerCase(),aB=R3.indexOf("iphone")>-1||R3.indexOf("ipad")>-1||R3.indexOf("macintosh")>-1&&"ontouchend"in document;let $he=(()=>{class t{get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((e,i)=>e+(i.isDisplayable?this.compact||i.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}constructor(e,i,r,o){this.chatMessageService=e,this.ngZone=i,this.changeDetector=r,this.panelService=o,this.compact=!1,this.sampleMessages=[this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\uff1a\u306f\u3058\u3081\u306b",null,"\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u306f\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c6\u30fc\u30d6\u30eb\u3068\u30b3\u30de\u306e\u57fa\u672c\u64cd\u4f5c",null,"\uff1c\u30c6\u30fc\u30d6\u30eb\u306e\u64cd\u4f5c\uff1e\n\u30c6\u30fc\u30d6\u30eb\u3092\u5de6\u30c9\u30e9\u30c3\u30b0 : \u8996\u70b9\u5909\u66f4\n\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30c9\u30e9\u30c3\u30b0 : \u8996\u70b9\u56de\u8ee2\n\u30c6\u30fc\u30d6\u30eb\u3092\u53f3\u30af\u30ea\u30c3\u30af : \u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\n\n\uff1c\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u64cd\u4f5c\uff1e\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u79fb\u52d5\u3084\u56de\u8ee2\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u53f3\u30af\u30ea\u30c3\u30af : \u500b\u5225\u306e\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u3092\u8868\u793a\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5de6\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af : \u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u56fa\u6709\u306e\u52d5\u4f5c"),this.makeSampleMessage("System",null,"\u7bc4\u56f2\u9078\u629e",null,"<\u7528\u8a9e>\n\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9 : \u9078\u629e\u9818\u57df\u306e\u5185\u5074\u306b\u898b\u3048\u3066\u3044\u308b\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u9078\u629e\u72b6\u614b\u306b\u3059\u308b\n\u78c1\u77f3\u30e2\u30fc\u30c9 : \u540c\u3058\u7a2e\u985e\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5dfb\u304d\u8fbc\u307f\u306a\u304c\u3089\u79fb\u52d5\u3055\u305b\u308b\n\n<\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u9078\u629e>\n\u30c6\u30fc\u30d6\u30eb\u3092\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3\u9577\u62bc\u3057+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u9577\u62bc\u3057\u3067\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u7bc4\u56f2\u9818\u57df\u3092\u6307\u5b9a\n\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u5de6\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u9577\u62bc\u3057+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u9577\u62bc\u3057\u3067\u78c1\u77f3\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5\nShift+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u5373\u6642\u306b\u7bc4\u56f2\u9078\u629e\u30e2\u30fc\u30c9\u3092\u958b\u59cb\u3057\u3001\u30c9\u30e9\u30c3\u30b0\u3067\u7bc4\u56f2\u9818\u57df\u3092\u6307\u5b9a\nCtrl+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3 : \u30af\u30ea\u30c3\u30af\u3057\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u9078\u629e\u72b6\u614b\u3092\u5207\u308a\u66ff\u3048\u308b\nCtrl+\u30de\u30a6\u30b9\u5de6\u30dc\u30bf\u30f3+\u30c9\u30e9\u30c3\u30b0\u64cd\u4f5c : \u30de\u30a6\u30b9\u30ab\u30fc\u30bd\u30eb\u306e\u89e6\u308c\u305f\u5bfe\u8c61\u3092\u9078\u629e\u72b6\u614b\u306b\u3059\u308b\n\n<\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306e\u64cd\u4f5c>\n\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u79fb\u52d5 : \u9078\u629e\u72b6\u614b\u306e\u5168\u3066\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u540c\u671f\u3057\u3066\u79fb\u52d5\n\u9078\u629e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u56de\u8ee2 : \u9078\u629e\u72b6\u614b\u306e\u540c\u3058\u7a2e\u985e\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u304c\u540c\u671f\u3057\u3066\u56de\u8ee2\n\n<\u9078\u629e\u89e3\u9664>\n\u4efb\u610f\u306e\u5834\u6240\u3092\u30af\u30ea\u30c3\u30af : \u5168\u3066\u306e\u9078\u629e\u72b6\u614b\u3092\u89e3\u9664"),this.makeSampleMessage("System",null,"\u753b\u50cf\u3068\u97f3\u697d",null,"\u30d5\u30a1\u30a4\u30eb\u3092\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u306b\u30c9\u30e9\u30c3\u30b0&\u30c9\u30ed\u30c3\u30d7\u3059\u308b\u3053\u3068\u3067\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u306b\u53d6\u308a\u8fbc\u3081\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u30c7\u30fc\u30bf\u306e\u4fdd\u5b58",null,"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u306e\u307f\u5b58\u5728\u3059\u308b\u305f\u3081\u3001\u5168\u54e1\u304c\u30eb\u30fc\u30e0\u304b\u3089\u96e2\u8131\u3059\u308b\u3068\u30c7\u30fc\u30bf\u304c\u6d88\u5931\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u30bb\u30c3\u30b7\u30e7\u30f3\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"),this.makeSampleMessage("System","???","\u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"),this.makeSampleMessage("System","???","\u30d7\u30ec\u30a4\u30e4\u30fc","\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8","\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),this.makeSampleMessage("System",null,"\u52d5\u4f5c\u74b0\u5883",null,"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7\u7248 Google Chrome \u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u64cd\u4f5c\u6027\u306b\u96e3\u304c\u3042\u308a\u307e\u3059\u3002"),this.makeSampleMessage("System",null,"\u52d5\u4f5c\u304c\u4e0d\u5b89\u5b9a\u306a\u6642\u306f",null,"\u5229\u7528\u74b0\u5883\u306e\u8a2d\u5b9a\u5909\u66f4\u3067\u6539\u5584\u3067\u304d\u308b\u304b\u3082\u3057\u308c\u307e\u305b\u3093\u3002\u6b21\u306e\u4e8b\u3092\u8a66\u3057\u3066\u307f\u3066\u4e0b\u3055\u3044\u3002\n\u30fb\u30cf\u30fc\u30c9\u30a6\u30a7\u30a2 \u30a2\u30af\u30bb\u30e9\u30ec\u30fc\u30b7\u30e7\u30f3\u3092\u30aa\u30f3\u306b\u3059\u308b\n\u30fb\u30d6\u30e9\u30a6\u30b6\u62e1\u5f35\u6a5f\u80fd\uff08\u30a2\u30c9\u30aa\u30f3\uff0f\u30d7\u30e9\u30b0\u30a4\u30f3\uff09\u3092\u5168\u3066\u30aa\u30d5\u306b\u3059\u308b\n\u30fbChrome \u21d4 Firefox\u306a\u3069\u9055\u3046\u30d6\u30e9\u30a6\u30b6\u3092\u4f7f\u7528\u3059\u308b"),this.makeSampleMessage("System",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\uff1a\u304a\u308f\u308a\u306b",null,"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002")],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new Qn}ngOnInit(){U.register(this).on("MESSAGE_ADDED",e=>{let i=dt.instance.get(e.data.messageIdentifier);!i||!this.chatTab.contains(i)||this.topTimestamp<=i.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on(`UPDATE_GAME_OBJECT/aliasName/${Ki.aliasName}`,e=>{let i=dt.instance.get(e.data.identifier);i&&this.topTimestamp<=i.timestamp&&i.timestamp<=this.botomTimestamp&&this.chatTab.contains(i)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new _d.b(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new _d.b(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){U.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}checkAnimated(e){return!(e.timestamp+1e3>=this.chatMessageService.getTime())}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:o}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||o||!e&&!i)&&(0,Jl.W)(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,o=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:o};let s=null,a=null,l=null,u=0;i?(s=this.bottomElm,a=this.bottomElmBox):e&&(s=this.topElm,a=this.topElmBox),l=s.getBoundingClientRect(),u=a.top-l.top-this.scrollSpeed,(!r||!o)&&.25<u**2&&(this.panelService.scrollablePanel.scrollTop-=u);let f=this.logContainerRef.nativeElement.getBoundingClientRect(),g=this.messageContainerRef.nativeElement.getBoundingClientRect(),v=g.top-f.top,C=v+g.height,E=this.getScrollPosition();return r=E.top<v,o=C<E.bottom&&E.bottom<E.scrollHeight,{hasTopBlank:r,hasBotomBlank:o}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&(0,Jl.W)(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,o=r+this.messageContainerRef.nativeElement.clientHeight,s=this.topIndex,a=this.bottomIndex,l=this.getScrollPosition();this.scrollSpeed=l.top-this.preScrollTop,this.preScrollTop=l.top;let u=l.top<r,f=o<l.bottom&&l.bottom<l.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!u&&!f)return;let g=l.top-(!e&&u?100:1200),v=l.bottom+(!e&&f?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,o,g,v,l,i),(this.topIndex!=s||this.bottomIndex!=a)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),(0,Jl.W)(()=>{let E=this.getScrollPosition();this.scrollSpeed=E.top-this.preScrollTop,this.preScrollTop=E.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let o=e[r].clientHeight;i<o&&(i=o)}return i}calcItemIndexRange(e,i,r,o,s,a){if(r>=i||e>=o)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((s.scrollHeight-s.top-s.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(s.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let l=this.calcElementMaxHeight(a);r<e?this.topIndex-=Math.floor((e-r)/l)+1:r>e&&(aB||(this.topIndex+=Math.floor((r-e)/l))),i>o?aB||(this.bottomIndex-=Math.floor((i-o)/l)):i<o&&(this.bottomIndex+=Math.floor((o-i)/l)+1)}this.adjustIndex()}makeSampleMessage(e,i,r,o,s,a="mine"){let l=new Ki;return l.from=e,l.to=i,l.name=r,l.toName=o,l.color="#444444",l.toColor=o?"#444444":null,l.tag=a,l.value=s,l}static#e=this.\u0275fac=function(i){return new(i||t)(F(Do),F(Sn),F(io),F(bi))};static#t=this.\u0275cmp=xn({type:t,selectors:[["chat-tab"]],viewQuery:function(i,r){if(1&i&&(Dn(Uhe,7),Dn(Hhe,7)),2&i){let o;On(o=An())&&(r.logContainerRef=o.first),On(o=An())&&(r.messageContainerRef=o.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[mr],decls:6,vars:6,consts:[["logContainer",""],["messageContainer",""],[1,"log"],[1,"virtual-scroll-container"],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(i,r){1&i&&(p(0,"div",2,0)(2,"div",3,1),L(4,jhe,2,2,"ng-container",4)(5,Whe,2,1,"ng-container",4),m()()),2&i&&(ke("min-height",r.minScrollHeight,"px"),h(2),ke("margin-bottom",r.bottomSpace,"px"),h(2),_("ngIf",!r.isEmpty),h(),_("ngIf",r.isEmpty))},dependencies:[nr,ni,Bhe],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0})}return t})();class Yhe{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=Iu.SQUARE,o="#000000e6",s=!0){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let a=this.canvasElement.getContext("2d");if(r<0)return;let l=this.generateCalcGridPositionFunc(r);this.makeBrush(a,i,o);for(let u=0;u<=e;u++)for(let f=0;f<=n;f++){let{gx:g,gy:v}=l(f,u,i);this.strokeSquare(a,g,v,i),s&&a.fillText((f+1).toString()+"-"+(u+1).toString(),g+i/2,v+i/2)}}generateCalcGridPositionFunc(n){switch(n){case Iu.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case Iu.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===Iu.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),l=e+r/2,u=i+r/2;n.beginPath();for(let f=0;f<6;f++){s+=60;let g=ji.radians(s),v=Math.cos(g)*a+l,C=Math.sin(g)*a+u;n.lineTo(v,C)}n.closePath(),n.stroke()}}var uv=function(t){return t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard",t}(uv||{}),Au=function(t){return t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown",t}(Au||{});class qhe{get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}initialize(){this.input=new bu(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,o=i-this.currentPositionY,s=0,a=0,u=0,g=0,v=uv.DRAG;2===this.buttonCode?(v=uv.ROTATE,g=-r/5,u=-o/5):(s=r,a=o),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(s,a,0,u,0,g,v,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let o=0;o=-1.5*e,9e4<o**2&&(o=Math.min(Math.max(o,-300),300)),this.ontransform&&this.ontransform(0,0,o,0,0,0,uv.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,o=0,a=0,l=this.getKeyName(n);switch(l){case Au.ArrowLeft:n.shiftKey?a=-2:e=10;break;case Au.ArrowUp:n.shiftKey?o=-2:n.ctrlKey?r=150:i=10;break;case Au.ArrowRight:n.shiftKey?a=2:e=-10;break;case Au.ArrowDown:n.shiftKey?o=2:n.ctrlKey?r=-150:i=-10}null!=Au[l]&&this.ontransform&&this.ontransform(e,i,r,o,0,a,uv.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return Au.ArrowLeft;case 38:return Au.ArrowUp;case 39:return Au.ArrowRight;case 40:return Au.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}class Zhe{get isActive(){return this.pointerDevice.isTablePickGesture}set isActive(n){this.pointerDevice.isTablePickGesture=n}constructor(n,e,i,r,o,s){this.targetElement=n,this.gameObjectsElement=e,this.pointerDevice=o,this.selection=s,this.pickCursorScale=1,this.input=null,this.activateTimer=null,this.keydownTimer=null,this.tappedTimer=null,this.tappedPointer={x:0,y:0,z:0},this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.callbackOnKeydown=a=>this.onKeydown(a),this.onstart=null,this.onend=null,this.oncancelifneeded=null,this.onpick=null,this.pickCursor=new Xhe(i),this.pickArea=new Khe(r),this.initialize()}initialize(){this.input=new bu(this.targetElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onTap=this.onInputTap.bind(this)}cancel(){this.input.cancel(),this.clearActivateTimer(),this.pickCursor.deactive(),this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isActive=!1,this.isKeepSelection=!1,this.isObjectDragging=!1,this.isPointerMoved=!1,this.target=null,this.clearKeyDownTimer(),this.clearTappedTimer()}destroy(){this.cancel(),this.input.destroy(),this.clearKeyDownTimer(),this.clearTappedTimer()}onInputStart(n){if(this.target=null,this.isPickObjectMode=!1,this.isPickRegionMode=!1,this.isMagneticMode=!1,this.isStrokeMode=!1,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.clearActivateTimer(),this.pickCursor.update(this.input.pointer),!(n instanceof MouseEvent&&0===n.button||n.touches))return this.cancel();this.isStrokeMode=n instanceof MouseEvent&&0===n.button&&n.ctrlKey;let i=n instanceof MouseEvent&&0===n.button&&n.shiftKey;this.isStrokeMode||i?this.startQuickCursor(n):this.startLongPressCursor(n)}onInputMove(n){let e=1<n.touches?.length,i=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||i<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,null==this.keydownTimer&&((e||null!=this.target&&this.isObjectDragging&&this.isPointerMoved&&!this.isMagneticMode||null!=this.activateTimer&&this.isPointerMoved)&&this.cancel(),this.isActive&&(null==this.oncancelifneeded||!this.oncancelifneeded())&&(this.pickCursor.update(this.input.pointer),this.pickCursor.scale(0),this.isPickObjectMode&&n instanceof MouseEvent&&n.ctrlKey?this.pickObject(n):this.isPointerMoved&&this.isPickRegionMode&&this.pickRegion(n),this.onpick&&this.onpick()))}onInputEnd(n){let e=(n instanceof MouseEvent?3:12)**2;this.isObjectDragging=this.pointerDevice.isDragging,this.isPointerMoved=this.isPointerMoved||e<this.input.magnitude,this.isKeepSelection=this.isKeepSelection||this.isPointerMoved||this.isObjectDragging,this.onend&&this.onend(),this.cancel()}onInputTap(n){this.setTappedTimer(),this.tappedPointer=this.input.pointer}onKeydown(n){if(!this.isActive||this.input.isGrabbing)switch(n.key){case"Control":this.isStrokeMode=!0;case"Shift":this.clearActivateTimer(),this.clearKeyDownTimer(),this.target=null,this.isPointerMoved=!1,this.isObjectDragging=!1,this.isKeepSelection=!1,this.isActive=!0,this.pickCursor.update(this.input.pointer),this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(.6),requestAnimationFrame(()=>this.pickCursor.scale(0)),this.pointerDevice.isDragging=!1,this.pickStart()}}startQuickCursor(n){this.isActive=!0,this.pickCursor.active(),this.pickCursor.disableAnimation(),this.pickCursor.scale(1),requestAnimationFrame(()=>this.pickCursor.scale(.6)),this.isMagneticMode=!1,this.isPickObjectMode=this.isStrokeMode,this.isPickRegionMode=!this.isStrokeMode,this.pointerDevice.isDragging=!1,this.pickStart(),this.isPickObjectMode&&(this.selection.excludeElement=null,this.pickObject(n))}startLongPressCursor(n){let e=n.target;e.contains(this.gameObjectsElement)||(this.target=e),this.isMagneticMode=null!=this.target&&this.pointerDevice.isDragging&&null!=this.tappedTimer&&ji.sqrMagnitude(this.tappedPointer,this.input.pointer)<625,this.isPickObjectMode=null!=this.target&&this.pointerDevice.isDragging&&!this.isMagneticMode,this.isPickRegionMode=null==this.target||!this.isPickObjectMode&&!this.isMagneticMode,!this.isPickObjectMode&&(this.setActivateTimer(),this.setKeyDownTimer(),this.pickCursorScale=n.touches?4.5:1,this.pickCursor.active(),this.pickCursor.scale(this.pickCursorScale),this.isMagneticMode&&this.pickCursor.color(L3.MAGNETIC,L3.MAGNETIC_FILL))}pickStart(){let n=new CustomEvent("pickstart",{detail:{isMagnetic:this.isMagneticMode,isPickRegion:this.isPickRegionMode,isPickObject:this.isPickObjectMode},bubbles:!0});this.target?this.target.dispatchEvent(n):document.dispatchEvent(n),this.onstart&&this.onstart()}pickObject(n){let e=n.target;if(e.contains(this.gameObjectsElement))this.selection.excludeElement=document.body;else{this.isKeepSelection=!0;let i=new CustomEvent("pickobject",{detail:{srcEvent:n,first:this.input.startPointer,last:this.input.pointer},bubbles:!0});e.dispatchEvent(i)}}pickRegion(n){let e=this.input.startPointer,i=this.input.pointer,r=Math.min(e.x,i.x),o=Math.min(e.y,i.y),s=Math.abs(e.x-i.x),a=Math.abs(e.y-i.y);this.pickArea.update(r,o,s,a),this.selection.clear();let l=new CustomEvent("pickregion",{detail:{srcEvent:n,x:r,y:o,width:s,height:a},bubbles:!0});document.dispatchEvent(l)}setActivateTimer(){this.clearActivateTimer(),this.activateTimer=setTimeout(()=>{this.activateTimer=null,this.pickCursor.scale(.6*this.pickCursorScale),this.isActive=!0,this.isKeepSelection=this.isPickObjectMode||this.isMagneticMode,this.pickStart()},850)}clearActivateTimer(){this.isActive=!1,null!=this.activateTimer&&(clearTimeout(this.activateTimer),this.activateTimer=null),this.pickArea.deactive()}setKeyDownTimer(){this.clearKeyDownTimer(),this.keydownTimer=setTimeout(()=>{this.keydownTimer=null},66),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}clearKeyDownTimer(){null!=this.keydownTimer&&(clearTimeout(this.keydownTimer),this.keydownTimer=null),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}setTappedTimer(){this.clearTappedTimer(),this.tappedTimer=setTimeout(()=>{this.tappedTimer=null},300)}clearTappedTimer(){null!=this.tappedTimer&&(clearTimeout(this.tappedTimer),this.tappedTimer=null)}}var L3=function(t){return t.SELECTED="hsl(200, 100%, 50%)",t.MAGNETIC="hsl(45, 100%, 50%)",t.SELECTED_FILL="hsla(200, 100%, 95%, .7)",t.MAGNETIC_FILL="hsla(45, 100%, 95%, .7)",t}(L3||{});class Xhe{constructor(n){this.targetElement=n,this.width=0,this.height=0,this.circleElement=this.targetElement.querySelector("circle"),this.active();let e=this.targetElement.getBoundingClientRect();this.width=e.width,this.height=e.height,this.deactive()}active(){this.deactive(),this.targetElement.style.display="block"}deactive(){this.targetElement.style.display=null,this.targetElement.style.stroke=null,this.targetElement.style.scale=null,this.circleElement.style.animation=null,this.circleElement.style.fill=null}scale(n){this.targetElement.style.scale=n+""}color(n,e){this.targetElement.style.stroke=n,this.circleElement.style.fill=e}disableAnimation(){this.circleElement.style.animation="none"}update(n){this.targetElement.style.left=n.x-this.width/2+"px",this.targetElement.style.top=n.y-this.height/2+"px"}}class Khe{constructor(n){this.targetElement=n}update(n,e,i,r){this.targetElement.style.left=n+"px",this.targetElement.style.top=e+"px",this.targetElement.style.width=i+"px",this.targetElement.style.height=r+"px",this.targetElement.style.display="block"}deactive(){this.targetElement.style.width="0px",this.targetElement.style.height="0px",this.targetElement.style.display=null}}var Km=function(t){return t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate",t}(Km||{});class Qhe{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,o=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(o),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(o),r.recognizeWith(o),this.hammer.add([n,e,i,r,o]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let s=window.navigator.userAgent.toLowerCase();(s.indexOf("iphone")>-1||s.indexOf("ipad")>-1||s.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",l=>{let u=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:l.center.x,clientY:l.center.y});this.ngZone.run(()=>l.srcEvent.target.dispatchEvent(u))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<ji.sqrMagnitude(this.tappedPanCenter,n.center)&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer)this.ontransform&&this.ontransform(this.deltaHammerDeltaX,this.deltaHammerDeltaY,0,0,0,0,Km.PAN,n.srcEvent);else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,Km.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,Km.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,Km.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,Km.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let Zx=(()=>{class t{constructor(){}createGameCharacter(e){let i=cn.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=Qo.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=Yt.instance.get(i);r||(r=Yt.instance.add(i),li.create(r.identifier).tag="*default \u5730\u5f62");let o=this.getViewTable();if(!o)return;let s=hs.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return s.location.x=e.x-50,s.location.y=e.y-50,s.posZ=e.z,o.appendChild(s),s}createTextNote(e){let i=Ns.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,o){let s=fs.create(i,r,1),a=null;return s.nothingFaces.forEach(l=>{let u=`./assets/images/dice/${o}/${o}[0].png`;a=Yt.instance.get(u),a||(a=Yt.instance.add(u),li.create(a.identifier).tag="*default "+(r===Ho.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(l).value=a.identifier}),s.faces.forEach(l=>{let u=`./assets/images/dice/${o}/${o}[${l}].png`;a=Yt.instance.get(u),a||(a=Yt.instance.add(u),li.create(a.identifier).tag="*default "+(r===Ho.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),s.imageDataElement.getFirstElementByName(l).value=a.identifier}),s.location.x=e.x-25,s.location.y=e.y-25,s.posZ=e.z,s}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let o,s;o=Yt.instance.get(i),o||(o=Yt.instance.add(i),li.create(o.identifier).tag="*default \u30ab\u30fc\u30c9"),s=Yt.instance.get(r),s||(s=Yt.instance.add(r),li.create(s.identifier).tag="*default \u30ab\u30fc\u30c9");let a=Ci.create("\u30ab\u30fc\u30c9",o.identifier,s.identifier);return a.location.x=e.x-25,a.location.y=e.y-25,a.posZ=e.z,a}cardName(e){let i="";const r=e.slice(0,1),o=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==o?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==o?"\u30a8\u30fc\u30b9":o>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][o-11]:o}`,i}createTrump(e){let i=Gi.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!Yt.instance.get(r)){const a=Yt.instance.add(r);li.create(a.identifier).tag="*default \u30ab\u30fc\u30c9"}let o=["c","d","h","s"],s=[];for(let a of o)for(let l=1;l<=13;l++)s.push(a+("00"+l).slice(-2));s.push("x01"),s.push("x02");for(let a of s){let l="./assets/images/trump/"+a+".gif";if(!Yt.instance.get(l)){const f=Yt.instance.add(l);li.create(f.identifier).tag="*default \u30ab\u30fc\u30c9"}let u=Ci.create(this.cardName(a),l,r);i.putOnBottom(u)}return i}createRangeArea(e,i){let r;switch(i){case"LINE":r=sr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u76f4\u7dda)",1,6,100);break;case"CIRCLE":r=sr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u5186)",3,3,100);break;case"SQUARE":r=sr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u6b63\u65b9\u5f62)",3,3,100);break;case"DIAMOND":r=sr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u30c0\u30a4\u30e4)",3,3,100);break;default:r=sr.create("\u5c04\u7a0b\u30fb\u7bc4\u56f2 (\u9310\u5f62)",6,6,100)}return r.location.x=e.x,r.location.y=e.y,r.posZ=e.z,r.type=i,r.commonDataElement.getFirstElementByName("opacity").currentValue=60,r}makeDefaultTable(){let e=new Mo("gameTable"),i=null,r=_n.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=Yt.instance.add(r),li.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),Jo.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new cn("testCharacter_1"),r=_n.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=Yt.instance.add(r),li.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new cn("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new cn("testCharacter_3"),r=_n.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=Yt.instance.add(r),li.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new cn("testCharacter_4"),r=_n.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=Yt.instance.add(r),li.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new cn("testCharacter_5"),r=_n.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=Yt.instance.add(r),li.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new cn("testCharacter_6"),r=_n.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=Yt.instance.add(r),li.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e),this.getCreateRangeMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);U.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),ze.play(pe.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),ze.play(pe.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),ze.play(pe.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),ze.play(pe.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),ze.play(pe.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),ze.play(pe.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:Ho.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:Ho.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:Ho.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:Ho.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:Ho.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:Ho.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:Ho.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:Ho.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:Ho.D20,imagePathPrefix:"20_dice"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createDiceSymbol(e,o.diceName,o.type,o.imagePathPrefix),ze.play(pe.dicePut)}})}),{name:"\u30b3\u30a4\u30f3\uff0f\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getCreateRangeMenu(e){let r=[];return[{menuName:"\u9310\u5f62",typeName:"CORN"},{menuName:"\u76f4\u7dda",typeName:"LINE"},{menuName:"\u5186",typeName:"CIRCLE"},{menuName:"\u6b63\u65b9\u5f62",typeName:"SQUARE"},{menuName:"\u30c0\u30a4\u30e4\u30e2\u30f3\u30c9",typeName:"DIAMOND"}].forEach(o=>{r.push({name:o.menuName,action:()=>{this.createRangeArea(e,o.typeName),ze.play(pe.dicePut)}})}),{name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return Jo.instance.viewTable}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275prov=Wt({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();class B3{constructor(n){this.targetElement=n,this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchMouseInput}),this.isEnable=!0,this.onstart=null,this.oninteract=null,this.initializeHammer()}cancel(){this.isEnable=!1}destroy(){this.hammer.destroy()}initializeHammer(){let n=new Hammer.Tap({event:"tap2",taps:2});this.hammer.add([n]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap2",this.onInteract.bind(this))}onHammer(n){if(!n.isFirst)return;let e=n.srcEvent instanceof MouseEvent&&(0!==n.srcEvent.button||n.srcEvent.ctrlKey||n.srcEvent.shiftKey);this.isEnable=!e,this.isEnable&&this.onstart&&this.onstart(n.srcEvent)}onInteract(n){this.isEnable&&this.oninteract&&this.oninteract(n.srcEvent)}}class Mp{static#e=this.rotablesMap=new Map;get selectedRotables(){let n=new Set;for(let e of this.selection.objects)Mp.rotablesMap.get(e)?.forEach(i=>n.add(i));return n}get isDestroyed(){return this._isDestroyed}constructor(n,e){this.rotable=n,this.selection=e,this._isDestroyed=!1}initialize(){this.register()}destroy(){this.unregister(),this._isDestroyed=!0,this.rotable=null}prepareRotate(){if(1<this.selection.size&&this.rotable.state!==Hn.NONE)for(let n of this.selectedRotables)n!==this.rotable&&(n.isDisable||n.setAnimatedTransition(!1));else this.selection.clear()}updateRotate(){if(!(this.selection.size<=1||this.rotable.state===Hn.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.rotate=this.rotable.rotate)}finishRotate(){if(!(this.selection.size<=1||this.rotable.state===Hn.NONE))for(let n of this.selectedRotables)n!==this.rotable&&!n.isDisable&&n.tabletopObject.aliasName===this.rotable.tabletopObject.aliasName&&n.targetPropertyName===this.rotable.targetPropertyName&&(n.setAnimatedTransition(!0),n.rotate=this.rotable.rotate)}register(){let n=Mp.rotablesMap.get(this.rotable.tabletopObject)??new Set;n.add(this.rotable),Mp.rotablesMap.set(this.rotable.tabletopObject,n)}unregister(){let n=Mp.rotablesMap.get(this.rotable.tabletopObject);n&&(n.delete(this.rotable),n.size<1&&Mp.rotablesMap.delete(this.rotable.tabletopObject))}}let Dp=(()=>{class t{get tabletopObject(){return this._tabletopObject}get targetPropertyName(){return this._targetPropertyName}get targetProperty(){return this.tabletopObject[this.targetPropertyName]}set targetProperty(e){this.targetPropertyName in this.tabletopObject&&(this.tabletopObject[this.targetPropertyName]=e)}get transformCssOffset(){return this._transformCssOffset}get grabbingSelecter(){return this._grabbingSelecter}set option(e){this.synchronizer.unregister(),this._tabletopObject=e.tabletopObject,this._targetPropertyName=e.targetPropertyName??"",this._grabbingSelecter=e.grabbingSelecter??".rotate-grab",this._transformCssOffset=e.transformCssOffset??"",this._targetPropertyName.length<1&&this._tabletopObject&&(this._targetPropertyName="rotate"),this.synchronizer.register()}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateBatching()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}get state(){return this.selectionService.state(this.tabletopObject)}constructor(e,i,r,o,s,a){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=o,this.tabletopService=s,this.selectionService=a,this._targetPropertyName="",this._transformCssOffset="",this._grabbingSelecter=".rotate-grab",this.isDisable=!1,this.polygonal=24,this.onstart=new Qn,this.ondragstart=new Qn,this.ondrag=new Qn,this.ondragend=new Qn,this.onend=new Qn,this.cssRotate=0,this._rotate=0,this.rotateOffset=0,this.isUpdateBatching=!1,this.grabbingElement=null,this.input=new bu(this.nativeElement,!1),this.synchronizer=new Mp(this,this.selectionService)}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.onstart)}ngOnChanges(){this.dispose(),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{e.isSendFromSelf&&(this.input.isGrabbing||this.state!==Hn.NONE)||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(this.targetProperty),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)}ngOnDestroy(){this.input.isGrabbing&&this.cancel(),this.dispose(),this.synchronizer.destroy(),this.input.destroy(),this.batchService.remove(this),this.batchService.remove(this.onstart)}initialize(){this.synchronizer.initialize(),this.input.initialize(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.setAnimatedTransition(!0)}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}dispose(){U.unregister(this),this.batchService.remove(this)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||e instanceof MouseEvent&&(0!==e.button||e.ctrlKey||e.shiftKey))return void this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5),this.synchronizer.prepareRotate()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r,this.synchronizer.updateRotate()}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(this.polygonal),this.synchronizer.finishRotate(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal(this.polygonal)}calcRotate(e,i){let l=Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2),u=(ji.degrees(l)-i+720)%360;return u<180?u:u-360}radianFromMatrix(e,i,r,o,s,a){let l=0;if(0!==e||0!==i){let u=Math.sqrt(e*e+i*i);l=i>0?Math.acos(e/u):-Math.acos(e/u)}else if(0!==r||0!==o){let u=Math.sqrt(r*r+o*o);l=.5*Math.PI-(o>0?Math.acos(-r/u):-Math.acos(r/u))}return l}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateBatching(){this.isUpdateBatching||(this.isUpdateBatching=!0,this.batchService.add(()=>{this.targetProperty=this.rotate,this.isUpdateBatching=!1})),this.updateTransformCss()}setRotate(e){e&&this.targetPropertyName in e&&(this._rotate=e[this.targetPropertyName]),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return this.targetProperty!==this.rotate}stopTransition(e=this.rotate){let i=window.getComputedStyle(this.nativeElement).transform;if(Math.abs(e-this.cssRotate)<180)return;let r=/matrix\(([^,]+),([^,]+),([^,]+),([^,]+),([^,]+),([^,]+)\)/gi.exec(i);if(!r)return;let o=this.radianFromMatrix(Number(r[1]),Number(r[2]),Number(r[3]),Number(r[4]),Number(r[5]),Number(r[6])),s=ji.degrees(o),a_x=Math.cos(o),a_y=Math.sin(o),l=ji.radians(e),u_x=Math.cos(l),f=a_x*Math.sin(l)-u_x*a_y,g=Math.abs(e-s);180<g&&(g=360-g);let v=e+(0<f?-g:g);if(v===s)return;let C=this.nativeElement.style.transition;this.nativeElement.style.transition="",this.cssRotate=v,this.nativeElement.style.transform=`${this.transformCssOffset} rotateZ(${v.toFixed(4)}deg)`,this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform,this.nativeElement.style.transition=C}updateTransformCss(){this.cssRotate=this.rotate;let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r),F(Nx),F(hr),F(Kh),F(Vm),F(sc))};static#t=this.\u0275dir=wn({type:t,selectors:[["","appRotable",""]],inputs:{option:[ae.None,"rotable.option","option"],isDisable:[ae.None,"rotable.disable","isDisable"],polygonal:[ae.None,"rotable.polygonal","polygonal"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend"},features:[mr]})}return t})();const Jhe=["cardImage"],efe=["translucentImage"],tfe=t=>({"is-grab":t}),dv=t=>({"is-inverse":t}),nfe=(t,n)=>({"background-color":t,transform:n}),ife=t=>({"is-magnetic":t});function rfe(t,n){if(1&t){const e=Ie();p(0,"img",11,0),It(2,"safe"),X("load",function(){return O(e),D(y().onImageLoad())}),m()}if(2&t){const e=y();_("@inverse",e.state)("src",St(2,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),gn)}}function ofe(t,n){if(1&t){const e=Ie();p(0,"img",11,1),It(2,"safe"),X("load",function(){return O(e),D(y().onImageLoad())}),m()}if(2&t){const e=y();_("@flipOpen",void 0)("src",St(2,2,e.frontImage.url,"resourceUrl"),gn)}}function sfe(t,n){if(1&t&&(p(0,"div",12),Ne(1,"div",13),It(2,"safe"),m()),2&t){const e=y();_("@flipOpen",void 0),h(),ke("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),_("@inverse",e.state)("innerHTML",St(2,9,e.rubiedText,"html"),eo)}}function afe(t,n){if(1&t&&(Me(0),p(1,"div",14)(2,"i",15),x(3),m()(),p(4,"div",16)(5,"i",15),x(6),m()(),p(7,"div",17)(8,"i",15),x(9),m()(),p(10,"div",18)(11,"i",15),x(12),m()(),Ne(13,"div",19),De()),2&t){const e=y();h(2),_("ngClass",Be(8,dv,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(10,dv,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(12,dv,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(14,dv,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew")}}function lfe(t,n){if(1&t&&(p(0,"div",20)(1,"span",21)(2,"b"),x(3),m()()()),2&t){const e=y();_("ngStyle",Cn(3,nfe,e.ownerColor,"translateY("+(e.isHand?"calc("+-e.backImageClientHeight/2+"px - 75%)":"-50%")+") translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),h(),_("ngClass",Be(6,dv,e.isInverse)),h(2),Re(e.ownerName)}}function cfe(t,n){if(1&t&&Ne(0,"div",22),2&t){const e=y();_("ngClass",Be(1,ife,e.isMagnetic))}}let ufe=(()=>{class t{get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return ji.clampMin(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get textShadowCss(){const e=_e.textShadowColor(this.color);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerIsOnline(){return this.card.ownerIsOnline}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get selectionState(){return this.selectionService.state(this.card)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return _e.rubyToHtml(_e.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}get textDivTopPixcel(){return this.isFront?0:(this.backImageClientHeight-this.frontImageClientHeight)/2}get textDivHeightCss(){return this.isFront||!this.frontImageClientHeight?"100%":this.frontImageClientHeight+"px"}constructor(e,i,r,o,s,a,l,u,f,g,v){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.tabletopService=a,this.selectionService=l,this.imageService=u,this.pointerDeviceService=f,this.modalService=g,this.chatMessageService=v,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.frontImageClientHeight=0,this.backImageClientHeight=0,this.interactGesture=null}ngOnChanges(){U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/aliasName/${Ce.aliasName}`,e=>{let i=dt.instance.get(e.data.identifier);this.card&&i&&i.userId===this.card.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.card?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Ce.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new B3(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),U.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Ci||e.detail instanceof Gi)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof Gi)){if(this.isLocked)return;let i=e.detail;this.card.calcSqrDistance(i)<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}onDoubleClick(){this.isLocked||this.ownerIsOnline&&!this.isHand||this.ngZone.run(()=>{this.state=this.isVisible&&!this.isHand?Fs.BACK:Fs.FRONT,this.owner="",this.state===Fs.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),ze.play(pe.cardDraw)})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.ngZone.run(()=>{this.card.toTopmost()}),this.startIconHiddenTimer(),this.isLocked&&U.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.contextMenuService.close(),ze.play(pe.cardPick)}onMoved(){ze.play(pe.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}onImageLoad(){this.isFront?(this.cardImageElement&&(this.frontImageClientHeight=this.cardImageElement.nativeElement.clientHeight),this.backImageClientHeight||(this.backImageClientHeight=this.frontImageClientHeight)):(this.cardImageElement&&(this.backImageClientHeight=this.cardImageElement.nativeElement.clientHeight),this.frontImageClientHeight||(this.frontImageClientHeight=this.backImageClientHeight),this.translucentImageElement&&(this.frontImageClientHeight=this.translucentImageElement.nativeElement.clientHeight))}createStack(){let e=Gi.create("\u5c71\u672d");e.location.x=this.card.location.x,e.location.y=this.card.location.y,e.posZ=this.card.posZ,e.location.name=this.card.location.name,e.rotate=this.rotate,e.zindex=this.card.zindex;let i=this.tabletopService.cards.filter(r=>this.card.calcSqrDistance(r)<1e4);i.sort((r,o)=>r.zindex<o.zindex?1:r.zindex>o.zindex?-1:0);for(let r of i)e.putOnBottom(r)}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.card.location.x+this.card.size*this.gridSize/2,y:this.card.location.y+this.card.size*this.gridSize/2,z:this.card.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.card.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ab\u30fc\u30c9",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09",action:()=>{const o=new Map;r().forEach(s=>{if(s.hasOwner||!s.isFront){const a=""==s.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":s.name;let l=o.get(a)||0;l+=1,o.set(a,l)}s.faceUp()}),this.chatMessageService.sendOperationLog([...o.keys()].map(s=>s+(o.get(s)<=1?"":` \xd7${o.get(s)}\u679a`)).join("\u3001")+" \u3092\u516c\u958b"),ze.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{r().forEach(o=>o.faceDown()),ze.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{const o=new Map;let s=0;r().forEach(l=>{if(!l.isHand)if(l.isFront){const u=""==l.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":l.name;let f=o.get(u)||0;f+=1,o.set(u,f)}else s+=1;l.faceDown(),l.owner=xt.peer.userId});const a=[...o.keys()].map(l=>l+(o.get(l)<=1?"":` \xd7${o.get(l)}\u679a`));s&&a.push(`(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)\xd7${s}\u679a`),this.chatMessageService.sendOperationLog(a.join("\u3001")+" \u3092\u81ea\u5206\u3060\u3051\u898b\u305f"),ze.play(pe.cardDraw)}}]})}return e.push(At),e}makeContextMenu(){let e=[];return e.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ze.play(pe.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ze.play(pe.lock)},checkBox:"check"}),e.push(At),e.push(!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.ownerIsOnline?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),ze.play(pe.cardDraw)},default:!this.isLocked&&(!this.ownerIsOnline||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),ze.play(pe.cardDraw)},default:!this.card.isLocked&&(!this.ownerIsOnline||this.isHand)}),e.push(this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),ze.play(pe.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{ze.play(pe.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=xt.peer.userId}}),e.push(At),e.push({name:"\u53f3\u56de\u8ee2",action:()=>{this.turnRight()},materialIcon:"turn_right",hotkey:"R",disabled:this.isLocked},{name:"\u5de6\u56de\u8ee2",action:()=>{this.turnLeft()},materialIcon:"turn_left",hotkey:"Shift+R",disabled:this.isLocked}),this.card.isVisible&&e.push(At,{name:"\u6b63\u4f4d\u7f6e(0\xb0)\u306b\u3059\u308b",action:()=>{this.vertical()},hotkey:"U",disabled:!this.card.isVisible||this.isLocked||0==this.card.rotate},{name:"\u6a2a\u5411\u304d(90\xb0)\u306b\u3059\u308b",action:()=>{this.horizontal()},hotkey:"T",disabled:!this.card.isVisible||this.isLocked||90==this.card.rotate}),e.push(At),e.push({name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),ze.play(pe.cardPut)},disabled:this.isLocked}),e.push(At),e.push({name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.card)}}),this.isVisible&&this.card.getUrls().length>0&&(e.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{_e.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(xa,{url:r,title:this.card.name,subTitle:i.name})},disabled:!_e.validUrl(r),error:_e.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(r)&&!_e.sameOrigin(r)}})}),e.push(At)),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.card.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),i.isLocked=!1,ze.play(pe.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),ze.play(pe.sweep)}}),e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}vertical(){!this.card.isVisible||0==this.card.rotate||(this.card.rotate=0,ze.play(pe.cardPut))}horizontal(){!this.card.isVisible||90==this.card.rotate||(this.card.rotate=90,ze.play(pe.cardPut))}turnRight(){this.card.rotate+=45,ze.play(pe.cardPut)}turnLeft(){this.card.rotate-=45,ze.play(pe.cardPut)}showDetail(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(lc,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Xo),F(bi),F(_r),F(io),F(Vm),F(sc),F(Gm),F(hr),F(Ii),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["card"]],viewQuery:function(i,r){if(1&i&&(Dn(Jhe,5),Dn(efe,5)),2&i){let o;On(o=An())&&(r.cardImageElement=o.first),On(o=An())&&(r.translucentImageElement=o.first)}},hostBindings:function(i,r){1&i&&X("carddrop",function(s){return r.onCardDrop(s)})("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{card:"card",is3D:"is3D"},features:[mr],decls:10,vars:27,consts:[["cardImage",""],["translucentImage",""],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","keyup.t","keyup.r","keyup.u","keyup.shift.r","ngClass","movable.option","movable.disable"],[1,"is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option","rotable.disable"],["class","card-image is-3d chrome-smooth-image-trick",3,"src","load",4,"ngIf"],[1,"is-3d","is-pointer-events-none",2,"position","absolute"],["style","position: absolute","class","card-image text is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-pointer-events-none is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"load","src"],[1,"card-image","text","is-3d",2,"position","absolute"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"],[1,"name-tag","is-nowrap","has-length-limit","is-pointer-events-none","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d",2,"display","inline-block",3,"ngClass"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){1&i&&(p(0,"div",2),X("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()})("keyup.t",function(){return r.horizontal()})("keyup.r",function(){return r.turnRight()})("keyup.u",function(){return r.vertical()})("keyup.shift.r",function(){return r.turnLeft()}),p(1,"div",3)(2,"div",4),X("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),L(3,rfe,3,5,"img",5),p(4,"div",6),L(5,ofe,3,5,"img",5)(6,sfe,3,12,"div",7),m(),L(7,afe,14,16,"ng-container",8)(8,lfe,4,8,"div",9)(9,cfe,1,3,"div",10),m()()()),2&i&&(ke("width",r.size*r.gridSize,"px"),_("ngClass",Be(25,tfe,!r.isLocked))("movable.option",r.movableOption)("movable.disable",r.isLocked),$t("tabindex",r.isLocked?null:-1),h(),_("@slidInOut",void 0),h(),_("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),_("ngIf",r.imageFile),h(),ke("opacity",r.isFront?1:.8)("transform",r.isFront?"":"scale(0.9)")("top",r.textDivTopPixcel,"px")("width",r.size*r.gridSize,"px")("height",r.textDivHeightCss),h(),_("ngIf",!r.isFront&&(r.isHand||r.isGMMode)&&r.frontImage),h(),_("ngIf",r.isFront||r.isHand||r.isGMMode),h(),_("ngIf",!r.isIconHidden),h(),_("ngIf",!r.isFront&&r.ownerIsOnline&&0<r.ownerName.length),h(),_("ngIf",r.isSelected))},dependencies:[Fi,ni,Zo,gs,Dp,fr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%;backface-visibility:hidden}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8);z-index:2}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:3px;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;inset:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;color:#f5f5f5!important;opacity:.9;z-index:10;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;backface-visibility:hidden;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.component[_ngcontent-%COMP%]:hover   .name-tag[_ngcontent-%COMP%]{visibility:hidden}"],data:{animation:[Vn("inverse",[WI("inverse",Pe({transform:""})),Xt(":increment, :decrement",[jt("200ms ease",mn([Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),Pe({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),Pe({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Vn("flipOpen",[Xt(":enter",[jt("200ms ease",mn([Pe({transform:"scale3d(0, 1.0, 1.0)",offset:0}),Pe({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),Pe({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Vn("slidInOut",[Xt("void => *",[jt("200ms ease",mn([Pe({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),Pe({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0})}return t})();const dfe=["draggablePanel"],hfe=["cardImage"],ffe=["fullCardImage"],pfe=["textArea"],lB=t=>({card:t}),gfe=t=>({note:t}),mfe=t=>({character:t}),_fe=t=>({dice:t}),bfe=t=>({range:t}),vfe=t=>({object:t}),Js=(t,n)=>({"is-pointer-events-auto":t,"pointer-events-none":n}),cB=t=>({"with-button-marign":t}),uB=t=>({transform:t}),Qm=(t,n)=>({dataElm:t,name:n}),yfe=t=>({"hide-text-area":t}),Cfe=t=>({"hide-area":t}),xfe=(t,n,e)=>({"has-icon":t,"is-pointer-events-auto":n,"pointer-events-none":e}),wfe=t=>({transform:t}),dB=(t,n)=>({inverse:t,hollow:n}),hB=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),fB=t=>({"black-paint":t}),Efe=(t,n)=>({"is-black-mask":t,"is-harf-black-mask":n}),Tfe=(t,n)=>({"outer-link":t,invalid:n}),Ife=t=>({"min-width":t});function Sfe(t,n){1&t&&ti(0)}function Mfe(t,n){1&t&&ti(0)}function Dfe(t,n){if(1&t&&(Me(0),L(1,Mfe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(13);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,lB,e.tabletopObject))}}function Ofe(t,n){1&t&&ti(0)}function Afe(t,n){if(1&t&&(Me(0),L(1,Ofe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(13);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,lB,e.tabletopObject))}}function kfe(t,n){1&t&&ti(0)}function Pfe(t,n){if(1&t&&(Me(0),L(1,kfe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(15);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,gfe,e.tabletopObject))}}function Ffe(t,n){1&t&&ti(0)}function Nfe(t,n){if(1&t&&(Me(0),L(1,Ffe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(17);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,mfe,e.tabletopObject))}}function Rfe(t,n){1&t&&ti(0)}function Lfe(t,n){if(1&t&&(Me(0),L(1,Rfe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(19);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,_fe,e.tabletopObject))}}function Bfe(t,n){1&t&&ti(0)}function Ufe(t,n){if(1&t&&(Me(0),L(1,Bfe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(21);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,bfe,e.tabletopObject))}}function Hfe(t,n){1&t&&ti(0)}function zfe(t,n){if(1&t&&(Me(0),L(1,Hfe,1,0,"ng-container",19),De()),2&t){const e=y(),i=rn(23);h(),_("ngTemplateOutlet",i)("ngTemplateOutletContext",Be(2,vfe,e.tabletopObject))}}function Vfe(t,n){1&t&&ti(0)}function jfe(t,n){if(1&t&&(Me(0),L(1,Vfe,1,0,"ng-container",20),De()),2&t){y();const e=rn(27);h(),_("ngTemplateOutlet",e)}}function Gfe(t,n){if(1&t&&(p(0,"div",32),Ne(1,"div",33),It(2,"safe"),m()),2&t){const e=y(3);ke("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),_("ngStyle",Be(17,uB,"scale("+e.imageAreaRect.scale+")")),h(),ke("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),_("innerHTML",St(2,14,e.cardText,"html"),eo)}}function Wfe(t,n){if(1&t&&(p(0,"div",34)(1,"div",35),x(2),m()()),2&t){const e=y(2).card,i=y();_("ngClass",Be(4,cB,i.hasImage)),h(),ke("background-color",e.ownerColor),h(),Re(e.ownerName)}}function $fe(t,n){if(1&t){const e=Ie();p(0,"div",26),L(1,Gfe,3,19,"div",27),p(2,"img",28,9),It(4,"safe"),X("load",function(){return O(e),D(y(2).onCardImageLoad())}),m(),p(5,"button",29),X("click",function(){return O(e),D(y(2).chanageImageView(!0))}),p(6,"i",30),x(7,"zoom_in"),m()(),L(8,Wfe,3,6,"div",31),m()}if(2&t){const e=y().card,i=y();h(),_("ngIf","card"==e.aliasName&&i.cardState!==i.CardStateBack&&(i.cardState==i.CardStateFront||e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),h(),_("src",St(4,3,i.imageUrl,"resourceUrl"),gn),h(6),_("ngIf",e.ownerIsOnline&&0<e.ownerName.length)}}function Yfe(t,n){if(1&t&&(Me(0),x(1),De()),2&t){const e=y().card;h(),Re(e.name)}}function qfe(t,n){1&t&&(Me(0),x(1," \u306e\u30c8\u30c3\u30d7"),De())}function Zfe(t,n){1&t&&(Me(0),x(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),De())}function Xfe(t,n){1&t&&ti(0)}function Kfe(t,n){if(1&t&&(Me(0),L(1,Xfe,1,0,"ng-container",19),De()),2&t){const e=n.$implicit,i=y(2).card;y();const r=rn(25);h(),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Qm,e,i.name))}}function Qfe(t,n){if(1&t&&(p(0,"div",36)(1,"div",37),L(2,Kfe,2,5,"ng-container",38),m()()),2&t){const e=y(2);h(2),_("ngForOf",e.dataElms)}}function Jfe(t,n){if(1&t&&(p(0,"div",21),L(1,$fe,9,6,"div",22),p(2,"div",23),L(3,Yfe,2,1,"ng-container",18)(4,qfe,2,0,"ng-container",18)(5,Zfe,2,0,"ng-container",18),m(),p(6,"div",24),L(7,Qfe,3,1,"div",25),m()()),2&t){const e=n.card,i=y();_("ngClass",Cn(7,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngIf",i.hasImage),h(),_("ngClass",Be(10,cB,i.hasImage)),h(),_("ngIf",i.cardState!==i.CardStateBack&&(i.cardState===i.CardStateFront||null==e.isVisible||e.isVisible||e.isGMMode)),h(),_("ngIf","card-stack"==e.aliasName&&!e.isEmpty),h(),_("ngIf",i.cardState!==i.CardStateFront&&(i.cardState===i.CardStateBack||null!=e.isVisible&&!e.isVisible&&!e.isGMMode)),h(2),_("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}function epe(t,n){if(1&t){const e=Ie();p(0,"div",39)(1,"div",40),x(2),m(),p(3,"div",41)(4,"div",42),X("mousedown",function(){return O(e),D(y().textAreaActivate())}),p(5,"div",43)(6,"textarea",44,10),$e("ngModelChange",function(r){const o=O(e).note;return Ge(o.text,r)||(o.text=r),D(r)}),m()(),Ne(8,"div",45),It(9,"safe"),Ne(10,"div",46),It(11,"safe"),m()()()}if(2&t){const e=n.note,i=y();_("ngClass",Cn(13,Js,!i.isPointerDragging,i.isPointerDragging)),h(2),Re(e.title),h(4),We("ngModel",e.text),_("ngClass",Be(16,yfe,!i.isSelected)),h(2),_("innerHTML",St(9,7,i.adjustedRubiedNote(e.text),"html"),eo)("ngClass",Be(18,Cfe,i.isSelected)),h(2),_("innerHTML",St(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),eo)}}function tpe(t,n){if(1&t&&(Me(0),p(1,"div",54)(2,"div",55)(3,"span",56),Ne(4,"img",57),It(5,"safe"),m()()(),De()),2&t){const e=y(3);h(),_("ngStyle",Be(8,wfe,"rotate("+e.roll+"deg)")),h(),_("ngClass",Cn(10,dB,e.isInverse,e.isHollow)),h(),_("ngClass",Dc(13,hB,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),h(),_("ngClass",Be(22,fB,e.isBlackPaint))("src",St(5,5,e.imageUrl,"resourceUrl"),gn)}}function npe(t,n){if(1&t&&(Me(0),Ne(1,"img",58),It(2,"safe"),De()),2&t){const e=y(3);h(),_("src",St(2,1,e.imageUrl,"resourceUrl"),gn)}}function ipe(t,n){if(1&t&&(p(0,"div",53),L(1,tpe,6,24,"ng-container",18)(2,npe,3,4,"ng-container",18),m()),2&t){const e=y(2);_("ngClass",ma(3,xfe,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),h(),_("ngIf",!e.isUseIcon),h(),_("ngIf",e.isUseIcon)}}function rpe(t,n){1&t&&ti(0)}function ope(t,n){if(1&t&&(Me(0),p(1,"div",37),L(2,rpe,1,0,"ng-container",19),m(),De()),2&t){const e=y().$implicit,i=y(2).character;y();const r=rn(25);h(2),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Qm,e,i.name))}}function spe(t,n){if(1&t&&(Me(0),L(1,ope,3,5,"ng-container",18),De()),2&t){const e=n.$implicit,i=y(3);h(),_("ngIf",e&&e!==i.newLineDataElement)}}function ape(t,n){if(1&t&&(p(0,"div",36),L(1,spe,2,1,"ng-container",38),m()),2&t){const e=y(2);h(),_("ngForOf",e.inventoryDataElms)}}function lpe(t,n){if(1&t&&(p(0,"div",47),Ne(1,"div",48),L(2,ipe,3,7,"div",49),p(3,"div",50),x(4),m(),Ne(5,"div",51),p(6,"div",52),L(7,ape,2,1,"div",25),m()()),2&t){const e=n.character,i=y();h(),_("ngClass",Cn(6,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngIf",i.hasImage),h(),_("ngClass",Cn(9,Js,!i.isPointerDragging,i.isPointerDragging)),h(),Re(e.name),h(2),_("ngClass",Cn(12,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngIf",i.hasDataElms)}}function cpe(t,n){if(1&t&&(Me(0),x(1),De()),2&t){const e=y().dice;h(),Mi("",e.name,":")}}function upe(t,n){if(1&t&&(Me(0),x(1),De()),2&t){const e=y().dice;h(),Re(e.face)}}function dpe(t,n){1&t&&(Me(0),x(1,"???"),De())}function hpe(t,n){if(1&t&&(p(0,"div",60)(1,"div",35),x(2),m()()),2&t){const e=y().dice,i=y();_("ngClass",Cn(4,Js,!i.isPointerDragging,i.isPointerDragging)),h(),ke("background-color",e.ownerColor),h(),Mi("",e.ownerName," ")}}function fpe(t,n){if(1&t&&(p(0,"div",53),Ne(1,"img",61),It(2,"safe"),m()),2&t){const e=y().dice,i=y();_("ngClass",Cn(6,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngClass",Cn(9,Efe,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",St(2,3,i.imageUrl,"resourceUrl"),gn)}}function ppe(t,n){1&t&&ti(0)}function gpe(t,n){if(1&t&&(Me(0),L(1,ppe,1,0,"ng-container",19),De()),2&t){const e=y().$implicit,i=y(2).dice;y();const r=rn(25);h(),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Qm,e,i.name))}}function mpe(t,n){if(1&t&&(Me(0),L(1,gpe,2,5,"ng-container",18),De()),2&t){const e=n.$implicit,i=y(3);h(),_("ngIf",e&&e!==i.newLineDataElement)}}function _pe(t,n){if(1&t&&(p(0,"div",36)(1,"div",37),L(2,mpe,2,1,"ng-container",38),m()()),2&t){const e=y(2);h(2),_("ngForOf",e.dataElms)}}function bpe(t,n){if(1&t&&(p(0,"div",47),Ne(1,"div",48),p(2,"div",50),L(3,cpe,2,1,"ng-container",18)(4,upe,2,1,"ng-container",18)(5,dpe,2,0,"ng-container",18),m(),L(6,hpe,3,7,"div",59)(7,fpe,3,12,"div",49),Ne(8,"div",51),p(9,"div",52),L(10,_pe,3,1,"div",25),m()()),2&t){const e=n.dice,i=y();h(),_("ngClass",Cn(9,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngClass",Cn(12,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngIf",0<(null==e||null==e.name?null:e.name.length)),h(),_("ngIf",e.isVisible),h(),_("ngIf",!e.isVisible),h(),_("ngIf",e.hasOwner&&0<e.ownerName.length),h(),_("ngIf",i.hasImage),h(2),_("ngClass",Cn(15,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngIf",i.hasDataElms&&e.isVisible)}}function vpe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",63),x(2),m(),p(3,"div",64)(4,"div",65)(5,"div",66),x(6),m(),p(7,"input",67),$e("ngModelChange",function(r){O(e);const o=y().$implicit;return Ge(o.value,r)||(o.value=r),D(r)}),m()()(),p(8,"div",68)(9,"input",69),It(10,"safe"),$e("ngModelChange",function(r){O(e);const o=y().$implicit;return Ge(o.value,r)||(o.value=r),D(r)}),m()(),De()}if(2&t){const e=y().$implicit;h(),$t("title",e.name),h(),Re(e.name),h(4),Re(e.value),h(),We("ngModel",e.value),h(2),Ds(St(10,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),ft("title",e.value),_("min","length"==e.name?1:0),We("ngModel",e.value)}}function ype(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",63),x(2),m(),p(3,"div",64)(4,"div",65)(5,"div",66),x(6),m(),p(7,"input",70),$e("ngModelChange",function(r){O(e);const o=y().$implicit;return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m(),p(8,"b",71),x(9,"%"),m()()(),p(10,"div",68)(11,"input",72),It(12,"safe"),$e("ngModelChange",function(r){O(e);const o=y().$implicit;return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m()(),De()}if(2&t){const e=y().$implicit;h(),$t("title",e.name),h(),Re(e.name),h(4),Re(e.currentValue),h(),We("ngModel",e.currentValue),h(4),Ds(St(12,9,"font-size: 0.8em; width: 100%; --min: 0; --max:"+e.value+"; --val:"+e.currentValue+";","style")),no("title","",e.currentValue,"%"),We("ngModel",e.currentValue)}}function Cpe(t,n){if(1&t&&(Me(0),L(1,vpe,11,12,"ng-container",18)(2,ype,13,12,"ng-container",18),De()),2&t){const e=n.$implicit;h(),_("ngIf","length"==e.name||"width"==e.name),h(),_("ngIf","opacity"==e.name)}}function xpe(t,n){if(1&t&&(Me(0),p(1,"div",73),x(2),m(),p(3,"div",74)(4,"div",75)(5,"span",76),Ne(6,"img",77),It(7,"safe"),m()()(),De()),2&t){const e=y(2).range;h(2),Mi("\u27a1 ",e.followingCharactor.name,""),h(2),_("ngClass",Cn(8,dB,e.followingCharactor.isInverse,e.followingCharactor.isHollow)),h(),_("ngClass",Dc(11,hB,0==e.followingCharactor.aura,1==e.followingCharactor.aura,2==e.followingCharactor.aura,3==e.followingCharactor.aura,4==e.followingCharactor.aura,5==e.followingCharactor.aura,6==e.followingCharactor.aura,7==e.followingCharactor.aura)),h(),_("ngClass",Be(20,fB,e.followingCharactor.isBlackPaint))("src",St(7,5,e.followingCharactor.imageFile.url,"resourceUrl"),gn)}}function wpe(t,n){1&t&&Ne(0,"div",78)}function Epe(t,n){1&t&&ti(0)}function Tpe(t,n){if(1&t&&(Me(0),L(1,Epe,1,0,"ng-container",19),De()),2&t){const e=y().$implicit,i=y(2).range;y();const r=rn(25);h(),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Qm,e,i.name))}}function Ipe(t,n){if(1&t&&(Me(0),L(1,Tpe,2,5,"ng-container",18),De()),2&t){const e=n.$implicit,i=y(3);h(),_("ngIf",e&&e!==i.newLineDataElement)}}function Spe(t,n){if(1&t&&(p(0,"div",36)(1,"div",37),L(2,Cpe,3,2,"ng-container",38)(3,xpe,8,22,"ng-container",18)(4,wpe,1,0,"div",62)(5,Ipe,2,1,"ng-container",38),m()()),2&t){const e=y().range,i=y();h(2),_("ngForOf",i.rangeElms),h(),_("ngIf",e.followingCharactor),h(),_("ngIf",i.dataElms.length>0),h(),_("ngForOf",i.dataElms)}}function Mpe(t,n){if(1&t&&(p(0,"div",47),Ne(1,"div",48),p(2,"div",50),x(3),m(),Ne(4,"div",51),p(5,"div",52),L(6,Spe,6,4,"div",25),m()()),2&t){const e=n.range,i=y();h(),_("ngClass",Cn(5,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngClass",Cn(8,Js,!i.isPointerDragging,i.isPointerDragging)),h(),Re(e.name),h(2),_("ngClass",Cn(11,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngIf",i.rangeElms.length>0)}}function Dpe(t,n){1&t&&ti(0)}function Ope(t,n){if(1&t&&(Me(0),L(1,Dpe,1,0,"ng-container",19),De()),2&t){const e=y().$implicit,i=y().object;y();const r=rn(25);h(),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Qm,e,i.name))}}function Ape(t,n){if(1&t&&(Me(0),L(1,Ope,2,5,"ng-container",18),De()),2&t){const e=n.$implicit,i=y(2);h(),_("ngIf",e&&e!==i.newLineDataElement)}}function kpe(t,n){if(1&t&&(p(0,"div",47),Ne(1,"div",48),p(2,"div",50),x(3),m(),Ne(4,"div",51),p(5,"div",52)(6,"div",36)(7,"div",37),L(8,Ape,2,1,"ng-container",38),m()()()()),2&t){const e=n.object,i=y();h(),_("ngClass",Cn(5,Js,!i.isPointerDragging,i.isPointerDragging)),h(),_("ngClass",Cn(8,Js,!i.isPointerDragging,i.isPointerDragging)),h(),Re(e.name),h(2),_("ngClass",Cn(11,Js,!i.isPointerDragging,i.isPointerDragging)),h(3),_("ngForOf",i.dataElms)}}function Ppe(t,n){1&t&&ti(0)}function Fpe(t,n){if(1&t&&(p(0,"div",83),x(1),m()),2&t){const e=y(2).dataElm;$t("title",e.name),h(),Re(e.name)}}function Npe(t,n){1&t&&ti(0)}function Rpe(t,n){if(1&t&&(Me(0),L(1,Npe,1,0,"ng-container",19),De()),2&t){const e=n.$implicit,i=y(2).name;y();const r=rn(25);h(),_("ngTemplateOutlet",r)("ngTemplateOutletContext",Cn(2,Qm,e,i))}}function Lpe(t,n){if(1&t&&(p(0,"div",80),L(1,Fpe,2,2,"div",81),p(2,"div",82),L(3,Rpe,2,5,"ng-container",38),m()()),2&t){const e=y().dataElm;h(),_("ngIf",0<e.name.trim().length),h(2),_("ngForOf",e.children)}}function Bpe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",85)(2,"div"),x(3),m(),p(4,"div",86)(5,"div",43)(6,"textarea",87),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m()(),p(7,"div",88),x(8),m()()(),De()}if(2&t){const e=y(2).dataElm;h(2),$t("title",e.name),h(),Re(e.name),h(3),We("ngModel",e.value),h(2),Re(e.value)}}function Upe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73),x(2),m(),p(3,"div",64)(4,"div",89),x(5),m(),p(6,"input",90),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name,o=y();h(),$t("title",i.name),h(),Re(i.name),h(3),Re(i.value),h(),ft("type",i.value&&i.value==+i.value?"number":"text"),_("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),We("ngModel",i.value)}}function Hpe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",63),x(2),m(),p(3,"div",64)(4,"div",65)(5,"div",66),x(6),m(),p(7,"input",91),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m()(),p(8,"div",92),x(9),m()(),p(10,"div",68)(11,"input",93),It(12,"safe"),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.currentValue,r)||(o.currentValue=r),D(r)}),m()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name,o=y();h(),$t("title",i.name),h(),Re(i.name),h(4),Re(i.currentValue),h(),_("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),We("ngModel",i.currentValue),h(2),Mi(" / ",+i.value?i.value:"???",""),h(2),Ds(St(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),ft("title",i.currentValue),ft("max",+i.value?i.value:1e3),_("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),We("ngModel",i.currentValue)}}function zpe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73)(2,"span"),x(3),m(),x(4),m(),p(5,"div",64)(6,"input",94),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),X("change",function(){O(e);const r=y(2).dataElm;return D(r.value=r.value?r.name:"")}),m()(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name,o=y();h(),$t("title",i.name),h(),ke("text-decoration",i.value?"none":"line-through"),h(),Re(i.name),h(),Mi(" ",o.checkValue(i),""),h(2),ft("checked",i.value?"checked":""),_("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),We("ngModel",i.value)}}function Vpe(t,n){if(1&t&&(p(0,"span",96),x(1),m()),2&t){const e=y(3).dataElm;h(),Mi("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function jpe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73),x(2),m(),p(3,"div",64)(4,"div",89),x(5),m(),p(6,"input",90),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m(),L(7,Vpe,2,1,"span",95),m(),De()}if(2&t){const e=y(2),i=e.dataElm,r=e.name,o=y();h(),$t("title",i.name),h(),Re(i.name),h(3),Re(i.value),h(),ft("type",i.value&&i.value==+i.value?"number":"text"),_("logging.name",r)("logging.dataElement",i)("logging.disable",o.isNoLogging),We("ngModel",i.value),h(),_("ngIf",i.currentValue)}}function Gpe(t,n){1&t&&(p(0,"span",100),x(1,"\u26a0\ufe0f"),m())}function Wpe(t,n){if(1&t){const e=Ie();Me(0),p(1,"div",73),L(2,Gpe,2,0,"span",97),p(3,"a",98),It(4,"safe"),X("click",function(){O(e);const r=y(2),o=r.dataElm,s=r.name,a=y();return D(!!a.stringUtil.validUrl(o.value)&&a.openUrl(o.value,s,o.name))}),p(5,"span",99),x(6),m()()(),De()}if(2&t){const e=y(2).dataElm,i=y();h(2),_("ngIf",!i.stringUtil.validUrl(e.value)),h(),_("ngClass",Cn(9,Tfe,!i.stringUtil.sameOrigin(e.value)&&i.stringUtil.validUrl(e.value),!i.stringUtil.validUrl(e.value))),$t("title",e.value)("href",St(4,6,i.stringUtil.validUrl(e.value)?e.value:"","url"),gn)("disabled",i.stringUtil.validUrl(e.value)?null:""),h(3),Re(e.name)}}function $pe(t,n){if(1&t&&(p(0,"div",73),x(1),m()),2&t){const e=y(3).dataElm;$t("title",e.name),h(),Re(e.name)}}function Ype(t,n){if(1&t&&(p(0,"div",89),x(1),m()),2&t){const e=y(3).dataElm;h(),Re(e.value)}}function qpe(t,n){if(1&t){const e=Ie();Me(0),L(1,$pe,2,2,"div",101),p(2,"div",64),L(3,Ype,2,1,"div",102),p(4,"input",103),$e("ngModelChange",function(r){O(e);const o=y(2).dataElm;return Ge(o.value,r)||(o.value=r),D(r)}),m()(),De()}if(2&t){const e=y(2).dataElm;h(),_("ngIf",e.name),h(2),_("ngIf",e.name),h(),ft("type","size"===e.name||"altitude"===e.name?"number":"text"),ft("min","size"===e.name?"0":""),_("ngStyle",Be(6,Ife,e.name?"8em":"100%")),We("ngModel",e.value)}}function Zpe(t,n){1&t&&(Me(0,15),L(1,Bpe,9,4,"ng-container",16)(2,Upe,7,8,"ng-container",16)(3,Hpe,13,19,"ng-container",16)(4,zpe,7,10,"ng-container",16)(5,jpe,8,9,"ng-container",16)(6,Wpe,7,12,"ng-container",16)(7,qpe,5,8,"ng-container",17),De(),Ne(8,"div",84)),2&t&&(_("ngSwitch",y().dataElm.type),h(),_("ngSwitchCase","note"),h(),_("ngSwitchCase","simpleNumber"),h(),_("ngSwitchCase","numberResource"),h(),_("ngSwitchCase","checkProperty"),h(),_("ngSwitchCase","abilityScore"),h(),_("ngSwitchCase","url"))}function Xpe(t,n){if(1&t&&L(0,Ppe,1,0,"ng-container",79)(1,Lpe,4,2,"ng-template",null,11,Pi)(3,Zpe,9,7,"ng-template",null,12,Pi),2&t){const e=n.dataElm,i=rn(2),r=rn(4);_("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function Kpe(t,n){if(1&t&&(p(0,"div",108),Ne(1,"div",33),It(2,"safe"),m()),2&t){const e=y(2);ke("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),_("ngStyle",Be(19,uB,"scale("+e.fullImageAreaRect.scale+")")),h(),ke("font-size",e.cardFontSize,"px")("color",e.cardColor)("text-shadow",e.cardTextShadowCss),_("innerHTML",St(2,16,e.cardText,"html"),eo)}}function Qpe(t,n){if(1&t){const e=Ie();p(0,"div",104),X("click",function(){return O(e),D(y().chanageImageView(!1))}),L(1,Kpe,3,21,"div",105),p(2,"div",106)(3,"i",30),x(4,"close"),m()(),Ne(5,"img",107,13),It(7,"safe"),m()}if(2&t){const e=y();_("@fadeInOut","in"),h(),_("ngIf","card"==e.tabletopObject.aliasName&&e.cardState!==e.CardStateBack&&(e.cardState==e.CardStateFront||e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),h(4),_("src",St(7,3,e.imageUrl,"resourceUrl"),gn)}}let Jpe=(()=>{class t{get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof cn&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=Yt.instance.get(i.value);this._imageFile=r||_n.Empty}}catch(i){console.log(i)}return this._imageFile.url}if(this.tabletopObject instanceof Ci){if(null!==this.cardState){if(this.cardState===this.CardStateFront)return this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"";if(this.cardState===this.CardStateBack)return this.tabletopObject.backImage?this.tabletopObject.backImage.url:""}if(this.tabletopObject.isGMMode)return this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:""}return this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof cn&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof cn){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof cn){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof cn&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof cn&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof cn&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof cn&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineDataElement(){return this.inventoryService.newLineDataElement}get isPointerDragging(){return this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}checkValue(e){if(!e||null==e.currentValue)return"";let i=e.currentValue.toString().split(/[|\uff5c]/,2);if(i.length<=1)return null==e.value||""==e.value?"":e.currentValue.toString();let r=null==e.value||""==e.value?i[1]:i[0];return this.tabletopObject instanceof cn&&this.tabletopObject.chatPalette&&(r=this.tabletopObject.chatPalette.evaluate(r,this.tabletopObject.rootDataElement)),r}constructor(e,i,r,o){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=o,this.tabletopObject=null,this.left=0,this.top=0,this.cardState=null,this.CardStateFront=Fs.FRONT,this.CardStateBack=Fs.BACK,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=_e,this._imageFile=_n.Empty,this.isOpenImageView=!1}ngOnChanges(){U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.tabletopObject?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16)}ngOnDestroy(){U.unregister(this)}onChangeDragging(e){this.changeDetector.markForCheck()}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,o=this.left+100,s=this.top-e.offsetHeight-50,a=!1;window.innerWidth<o+i&&(o=window.innerWidth-i,a=!0),s<=0&&(s=0),a&&(o=this.left-i-100),o<0&&(o=0),s<0&&(s=0),e.style.left=o+"px",e.style.top=s+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,o=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+o&&(o+=window.innerHeight-(i.bottom+o)),i.top+o<0&&(o+=0-(i.top+o)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+o+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){return _e.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(xa,{url:e,title:i,subTitle:r}),!1}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){this.cardImageElement&&(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){this.cardImageElement&&(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2);let l=null;return this.tabletopObject instanceof Gi?l=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(l=this.tabletopObject),l&&(o.scale=o.width/(l.size*this.gridSize),o.width=l.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){let e=null;return this.tabletopObject instanceof Gi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Gi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Gi?e=this.tabletopObject.topCard:this.tabletopObject instanceof Ci&&(e=this.tabletopObject),e?_e.rubyToHtml(_e.escapeHtml(e.text)):""}get cardTextShadowCss(){const e=_e.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}get rangeElms(){let e=[];return!this.tabletopObject||!(this.tabletopObject instanceof sr)||!this.tabletopObject.commonDataElement||(this.tabletopObject.commonDataElement.getFirstElementByName("length")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("length")),("CORN"===this.tabletopObject.type||"LINE"===this.tabletopObject.type)&&this.tabletopObject.commonDataElement.getFirstElementByName("width")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("width")),this.tabletopObject.commonDataElement.getFirstElementByName("opacity")&&e.push(this.tabletopObject.commonDataElement.getFirstElementByName("opacity"))),e}get isNoLogging(){return this.tabletopObject instanceof Ci?!this.tabletopObject.isFront:this.tabletopObject instanceof fs&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=_e.escapeHtml(e);return i&&(r=_e.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sd),F(io),F(hr),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["overview-panel"]],viewQuery:function(i,r){if(1&i&&(Dn(dfe,7),Dn(hfe,5),Dn(ffe,5),Dn(pfe,5)),2&i){let o;On(o=An())&&(r.draggablePanel=o.first),On(o=An())&&(r.cardImageElement=o.first),On(o=An())&&(r.fullCardImageElement=o.first),On(o=An())&&(r.textAreaElementRef=o.first)}},hostBindings:function(i,r){1&i&&X("draggingstate",function(s){return r.onChangeDragging(s)},0,zf)},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top",cardState:"cardState"},features:[mr],decls:28,vars:10,consts:[["draggablePanel",""],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["overviewRange",""],["overviewTabletop",""],["dataElement",""],["imageView",""],["cardImage",""],["textArea",""],["thenBlock",""],["elseBlock",""],["fullCardImage",""],["appDraggable","",1,"component","is-pointer-events-none"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"load","src"],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModelChange","ngModel","ngClass"],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],["class","section border","style","padding-top: 2px",4,"ngIf"],[1,"tag",2,"min-width","100px"],[1,"value"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["type","number","step","0.1","size","1",1,"input",2,"width","4em",3,"ngModelChange","ngModel"],[1,"section",2,"line-height","1em"],["type","range","max","12","step","0.5",3,"ngModelChange","title","min","ngModel"],["type","number","size","1",1,"input",2,"width","4em",3,"ngModelChange","ngModel"],[1,"move",2,"font-size","small"],["type","range","min","0","max","100",3,"ngModelChange","title","ngModel"],[1,"tag"],[1,"value",2,"margin-top","3px","pointer-events","none"],[1,"inverser",2,"min-width","32px","min-height","32px","max-width","32px","max-height","32px","margin-left","auto","margin-right","0px",3,"ngClass"],[1,"aura-following",3,"ngClass"],["draggable","false",1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"section","border",2,"padding-top","2px"],[4,"ngIf","ngIfThen","ngIfElse"],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModelChange","ngModel"],[1,"textarea-spacer"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","type","ngModel"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","ngModel"],[2,"display","inline"],["appLogging","","type","range","min","0",3,"ngModelChange","logging.name","logging.dataElement","logging.disable","title","max","ngModel"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"ngModelChange","change","logging.name","logging.dataElement","logging.disable","ngModel","checked"],["style","font-size: smaller",4,"ngIf"],[2,"font-size","smaller"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059",4,"ngIf"],["draggable","false","target","_blank",3,"click","ngClass"],[1,"url-link"],["title","URL\u304c\u4e0d\u6b63\u3067\u3059"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngModelChange","ngStyle","type","min","ngModel"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(i,r){1&i&&(p(0,"div",14,0),Me(2,15),L(3,Sfe,1,0,"ng-container",16)(4,Dfe,2,4,"ng-container",16)(5,Afe,2,4,"ng-container",16)(6,Pfe,2,4,"ng-container",16)(7,Nfe,2,4,"ng-container",16)(8,Lfe,2,4,"ng-container",16)(9,Ufe,2,4,"ng-container",16)(10,zfe,2,4,"ng-container",17),De(),m(),L(11,jfe,2,1,"ng-container",18)(12,Jfe,8,12,"ng-template",null,1,Pi)(14,epe,12,20,"ng-template",null,2,Pi)(16,lpe,8,15,"ng-template",null,3,Pi)(18,bpe,11,18,"ng-template",null,4,Pi)(20,Mpe,7,14,"ng-template",null,5,Pi)(22,kpe,9,14,"ng-template",null,6,Pi)(24,Xpe,5,3,"ng-template",null,7,Pi)(26,Qpe,8,6,"ng-template",null,8,Pi)),2&i&&(_("@fadeInOut","in"),h(2),_("ngSwitch",r.tabletopObject.aliasName),h(),_("ngSwitchCase","numberResource"),h(),_("ngSwitchCase","card"),h(),_("ngSwitchCase","card-stack"),h(),_("ngSwitchCase","text-note"),h(),_("ngSwitchCase","character"),h(),_("ngSwitchCase","dice-symbol"),h(),_("ngSwitchCase","range"),h(2),_("ngIf",r.isOpenImageView))},dependencies:[Fi,nr,ni,ip,Zo,Dh,mm,_b,Rr,Xl,Kl,Wa,Lr,Tr,TS,Md,fr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px;cursor:zoom-in}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:150px;vertical-align:bottom;object-fit:contain;object-position:bottom center}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:none;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#eee}.textarea[_ngcontent-%COMP%]:focus{background:#fff}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#eee}.input[_ngcontent-%COMP%]:focus{background:#fff}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;inset:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.aura-following.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura-following.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #33f)}.aura-following.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura-following.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura-following.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura-following.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura-following.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura-following.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}.url-link[_ngcontent-%COMP%]{cursor:inherit}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],data:{animation:[Vn("fadeInOut",[Xt("void => *",[jt("100ms ease-out",mn([Pe({opacity:0,offset:0}),Pe({opacity:1,offset:1})]))]),Xt("* => void",[jt("100ms ease-in",mn([Pe({opacity:1,offset:0}),Pe({opacity:0,offset:1})]))])])]},changeDetection:0})}return t})(),pB=(()=>{class t{static#e=this.activeTooltips=[];constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=o=>this.onMouseEnter(o),this.callbackOnMouseLeave=o=>this.onMouseLeave(o),this.callbackOnMouseDown=o=>this.onMouseDown(o),this.callbackOnPick=o=>this.ngZone.run(()=>this.closeAll())}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){this.tooltipComponentRef&&!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointer;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<ji.sqrMagnitude(e,this.pointerDeviceService.pointer)?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging||this.pointerDeviceService.isTablePickGesture)return;let e=Xo.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(Jpe,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.tooltipComponentRef.instance.cardState=this.cardState,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0),document.addEventListener("pickstart",this.callbackOnPick,!0),document.addEventListener("pickobject",this.callbackOnPick,!0),document.addEventListener("pickregion",this.callbackOnPick,!0)}),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.tabletopObject.identifier}`,o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("UPDATE_SELECTION",o=>{this.pointerDeviceService.isDragging&&this.ngZone.run(()=>this.closeAll())}).on("DELETE_GAME_OBJECT",o=>{this.tabletopObject&&this.tabletopObject.identifier===o.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),document.removeEventListener("pickstart",this.callbackOnPick,!0),document.removeEventListener("pickobject",this.callbackOnPick,!0),document.removeEventListener("pickregion",this.callbackOnPick,!0),this.clearTimer(),this.tooltipComponentRef=null,U.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef);let r=this.tooltipComponentRef.instance;null!=r?.ngOnChanges&&queueMicrotask(()=>{this.tooltipComponentRef.instance&&r?.ngOnChanges({})})}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}static#t=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(ja),F(hr))};static#n=this.\u0275dir=wn({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:[ae.None,"appTooltip","tabletopObject"],cardState:"cardState"}})}return t})();const ege=["cardImage"],gB=t=>({downside:t}),mB=t=>({reverse:t}),tge=t=>({transform:t});function nge(t,n){1&t&&(p(0,"i",10),x(1,"face-"),Ne(2,"br"),p(3,"span",11),x(4,"U"),m(),x(5,"p"),m())}function ige(t,n){1&t&&(p(0,"i",10)(1,"span",12),x(2,"face-"),m(),Ne(3,"br"),p(4,"span",11),x(5,"D"),m(),x(6,"own"),m())}let rge=(()=>{class t{constructor(){this.card=null,this.CardStateFront=Fs.FRONT,this.CardStateBack=Fs.BACK,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){this.cardImageElement&&(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?_e.rubyToHtml(_e.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const o={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return o;const s=e-2*r,a=i-2*r;return this.naturalHeight*s/this.naturalWidth>a?(o.width=this.naturalWidth*a/this.naturalHeight,o.height=a,o.left=r+(s-o.width)/2):(o.width=s,o.height=this.naturalHeight*s/this.naturalWidth,o.top=r+(a-o.height)/2),this.card&&(o.scale=o.width/(this.card.size*this.gridSize),o.width=this.card.size*this.gridSize,o.height=o.width*this.naturalHeight/this.naturalWidth),o}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}get textShadowCss(){const e=_e.textShadowColor(this.cardColor);return`${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px, \n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px,\n    ${e} 0px 0px 2px`}static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275cmp=xn({type:t,selectors:[["card-list-image"]],viewQuery:function(i,r){if(1&i&&Dn(ege,7),2&i){let o;On(o=An())&&(r.cardImageElement=o.first)}},inputs:{card:"card"},decls:15,vars:48,consts:[["cardImage",""],[1,"image-box",2,"position","relative",3,"appTooltip","cardState"],[1,"image",3,"ngClass"],[1,"image",2,"position","relative",3,"ngClass"],["draggable","false",2,"position","absolute",3,"load","src"],[1,"text",2,"z-index","5","position","absolute",3,"ngStyle"],[3,"innerHTML"],["class","indicate-text",4,"ngIf"],[1,"image",2,"position","relative"],["draggable","false",2,"position","absolute",3,"src","ngClass"],[1,"indicate-text"],[1,"initial",2,"padding-left","3px"],[2,"font-size","smaller"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1)(1,"div",2)(2,"div",3)(3,"img",4,0),It(5,"safe"),X("load",function(){return O(o),D(r.onCardImageLoad())}),m(),p(6,"div",5),Ne(7,"div",6),It(8,"safe"),m()(),L(9,nge,6,0,"i",7),m(),p(10,"div",8)(11,"div",2),Ne(12,"img",9),It(13,"safe"),L(14,ige,7,0,"i",7),m()()()}2&i&&(_("appTooltip",r.card)("cardState",r.CardStateFront)("@flipCard",null!=r.card&&r.card.isFront?0:1),h(),_("ngClass",Be(38,gB,r.card&&!r.card.isFront)),h(),_("ngClass",Be(40,mB,r.card&&180==r.card.rotate))("@reverseCard",r.card.rotate),h(),_("src",St(5,29,null==r.card||null==r.card.frontImage?null:r.card.frontImage.url,"resourceUrl"),gn),h(3),ke("width",r.imageAreaRect.width,"px")("height",r.imageAreaRect.height,"px")("left",r.imageAreaRect.left,"px")("top",r.imageAreaRect.top,"px"),_("ngStyle",Be(42,tge,"scale("+r.imageAreaRect.scale+")")),h(),ke("font-size",r.cardFontSize,"px")("color",r.cardColor)("text-shadow",r.textShadowCss),_("innerHTML",St(8,32,r.rubiedText,"html"),eo),h(2),_("ngIf",null==r.card?null:r.card.isFront),h(2),_("ngClass",Be(44,gB,r.card&&r.card.isFront)),h(),_("src",St(13,35,null==r.card||null==r.card.backImage?null:r.card.backImage.url,"resourceUrl"),gn)("ngClass",Be(46,mB,r.card&&180==r.card.rotate))("@reverseCard",r.card.rotate),h(2),_("ngIf",!(null!=r.card&&r.card.isFront)))},dependencies:[Fi,ni,Zo,pB,fr],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.downside[_ngcontent-%COMP%]{background-color:#555}.indicate-text[_ngcontent-%COMP%]{font-size:xx-small;display:inline-block;position:absolute;opacity:80%;bottom:1px;left:1px;color:#000;pointer-events:none;text-shadow:#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px,#fff 0px 0px 1px}.indicate-text[_ngcontent-%COMP%]   .initial[_ngcontent-%COMP%]{font-weight:700;color:#fff;text-shadow:#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px,#000 0px 0px 1px}.reverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Vn("reverseCard",[Xt(":increment",[jt("132ms ease-in-out",mn([Pe({transform:"rotateZ(0deg)",offset:0}),Pe({transform:"rotateZ(90deg)",offset:.5}),Pe({transform:"rotateZ(180deg)",offset:1})]))]),Xt(":decrement",[jt("132ms ease-in-out",mn([Pe({transform:"rotateZ(180deg)",offset:0}),Pe({transform:"rotateZ(270deg)",offset:.5}),Pe({transform:"rotateZ(360deg)",offset:1})]))])]),Vn("flipCard",[Xt(":increment,:decrement",[jt("132ms ease-in-out",mn([Pe({transform:"scaleX(1.0)",offset:0}),Pe({transform:"scaleX(0.1)",offset:.5}),Pe({transform:"scaleX(1.0)",offset:1})]))])])]}})}return t})();function oge(t,n){if(1&t){const e=Ie();p(0,"div",2),Ne(1,"card-list-image",3),p(2,"div",4)(3,"button",5),X("click",function(){const r=O(e).$implicit;return D(y().drawCard(r))}),x(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),m(),p(5,"button",0),X("click",function(){const r=O(e).$implicit;return D(y().showDetail(r))}),p(6,"i",6),x(7,"settings"),m(),x(8," \u7de8\u96c6"),m(),Ne(9,"br"),p(10,"button",0),X("click",function(){const r=O(e).$implicit;return D(y().up(r))}),x(11,"\u2191"),m(),p(12,"button",0),X("click",function(){const r=O(e).$implicit;return D(y().down(r))}),x(13,"\u2193"),m(),p(14,"button",7),X("click",function(){const r=O(e).$implicit;return D(r.rotate=180==r.rotate?0:180)}),x(15,"\u56de\u8ee2\u3059\u308b"),m(),p(16,"button",0),X("click",function(){const r=O(e).$implicit,o=y();return D(r.state=r.state==o.CardStateFront?o.CardStateBack:o.CardStateFront)}),x(17,"\u88cf\u8fd4\u3059"),m(),Ne(18,"br"),m()()}if(2&t){const e=n.$implicit;h(),_("card",e)}}let sge=(()=>{class t{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=xt.peer.userId,this.CardStateFront=Fs.FRONT,this.CardStateBack=Fs.BACK}ngOnChanges(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck(),this.cardStack.owner!==this.owner&&this.panelService.close()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){U.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),ze.play(pe.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),U.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),ze.play(pe.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}static#e=this.\u0275fac=function(i){return new(i||t)(F(bi),F(io),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},features:[mr],decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block","margin-left","2px"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"],[2,"margin-left","5px",3,"click"]],template:function(i,r){1&i&&(p(0,"div")(1,"button",0),X("click",function(){return r.close(!0)}),x(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),m(),Ne(3,"hr"),L(4,oge,19,1,"div",1),m()),2&i&&(h(4),_("ngForOf",r.cardStack.cards)("ngForTrackBy",r.trackByCard))},dependencies:[nr,rge],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}button[_ngcontent-%COMP%]{font-size:smaller;height:2.2em;padding:0 8px;min-width:2.2em;margin:1px;vertical-align:baseline}"],changeDetection:0})}return t})();const age=t=>({"is-empty":t}),lge=t=>({"is-grab":t}),U3=t=>({transform:t}),Jm=t=>({"is-inverse":t}),cge=(t,n)=>({"background-color":t,transform:n}),uge=t=>({"is-magnetic":t});function dge(t,n){if(1&t&&(p(0,"div",10),Ne(1,"div",11),It(2,"safe"),m()),2&t){const e=y(2);_("ngStyle",Be(11,U3,"rotateZ("+e.topCard.rotate+"deg)")),h(),ke("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color)("text-shadow",e.textShadowCss(e.topCard.color)),_("innerHTML",St(2,8,e.rubiedText,"html"),eo)}}function hge(t,n){if(1&t){const e=Ie();p(0,"div",7),X("@shuffle.start",function(r){return O(e),D(y().animationShuffleStarted(r))})("@shuffle.done",function(r){return O(e),D(y().animationShuffleDone(r))}),L(1,dge,3,13,"div",8),Ne(2,"img",9),It(3,"safe"),m()}if(2&t){const e=y();_("@bounceInOut",void 0)("@shuffle",e.animeState),h(),_("ngIf",e.topCard.isFront),h(),_("ngStyle",Be(8,U3,"rotateZ("+e.topCard.rotate+"deg)"))("src",St(3,5,e.imageFile.url,"resourceUrl"),gn)}}function fge(t,n){if(1&t&&(Me(0),p(1,"div",12)(2,"i",13),x(3),m()(),p(4,"div",14)(5,"i",13),x(6),m()(),p(7,"div",15)(8,"i",13),x(9),m()(),p(10,"div",16)(11,"i",13),x(12),m()(),De()),2&t){const e=y();h(2),_("ngClass",Be(8,Jm,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(10,Jm,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(12,Jm,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(14,Jm,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew")}}function pge(t,n){if(1&t&&(p(0,"div",17)(1,"span",18),x(2),m()()),2&t){const e=y();_("ngStyle",Be(3,U3,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),h(),_("ngClass",Be(5,Jm,e.isInverse)),h(),Mi("",e.cards.length,"\u679a")}}function gge(t,n){if(1&t&&(p(0,"div",19)(1,"span",18)(2,"b"),x(3),m(),x(4," \u304c\u78ba\u8a8d\u4e2d"),m()()),2&t){const e=y();_("ngStyle",Cn(3,cge,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),h(),_("ngClass",Be(6,Jm,e.isInverse)),h(2),Re(e.ownerName)}}function mge(t,n){if(1&t&&Ne(0,"div",20),2&t){const e=y();_("ngClass",Be(1,uge,e.isMagnetic))}}let _ge=(()=>{class t{get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?ji.clampMin(e.size):2}get hasOwner(){return this.cardStack.hasOwner}get ownerIsOnline(){return this.cardStack.ownerIsOnline}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get selectionState(){return this.selectionService.state(this.cardStack)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return _e.rubyToHtml(_e.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}constructor(e,i,r,o,s,a,l,u,f,g){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=o,this.changeDetector=s,this.selectionService=a,this.imageService=l,this.pointerDeviceService=u,this.modalService=f,this.chatMessageService=g,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.interactGesture=null}ngOnChanges(){U.unregister(this),U.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=dt.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof Ir&&this.cardStack.contains(i)||i instanceof Ce&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/aliasName/${Ce.aliasName}`,e=>{let i=dt.instance.get(e.data.identifier);this.cardStack&&i&&i.userId===this.cardStack.owner&&this.changeDetector.markForCheck()}).on(`UPDATE_GAME_OBJECT/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.cardStack?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Ce.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new B3(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),U.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Ci||e.detail instanceof Gi))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Ci){let i=e.detail;this.cardStack.calcSqrDistance(i)<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof Gi){let i=e.detail;this.cardStack.calcSqrDistance(i)<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}onDoubleClick(){this.ngZone.run(()=>{const e=this.drawCard();if(e){let i;ze.play(pe.cardDraw),i=e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(i)}})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){if(this.isLocked)return this.cardStack.toTopmost(),void U.trigger("DRAG_LOCKED_OBJECT",{});U.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"}),this.ngZone.run(()=>{this.cardStack.toTopmost(),this.startIconHiddenTimer()})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),ze.play(pe.cardPick)}onMoved(){ze.play(pe.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}textShadowCss(e){const i=_e.textShadowColor(e);return`${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px, \n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px,\n    ${i} 0px 0px 2px`}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let a=0;a<e;a++){let l=Gi.create(`${this.cardStack.name}_${("0"+(a+1).toString()).slice(-2)}`);l.location.x=this.cardStack.location.x+50-100*Math.random(),l.location.y=this.cardStack.location.y+50-100*Math.random(),l.posZ=this.cardStack.posZ,l.location.name=this.cardStack.location.name,l.rotate=this.rotate,l.toTopmost(),i.push(l)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let o=0,s=r.length/e*(o+1);for(let a=0;a<r.length;a++)i[o].putOnBottom(r[a]),s<=a+1&&(o++,s=r.length/e*(o+1))}concatStack(e,i=this.cardStack){let r=Gi.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let o=i.drawCardAll(),s=e.drawCardAll();for(let a of s.concat(o))r.putOnBottom(a);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,o=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let s=0;s<r.length;s++)r[s].dispatchEvent(o)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.cardStack.topCard?.size??2,r={x:this.cardStack.location.x+i*this.gridSize/2,y:this.cardStack.location.y+i*this.gridSize/2,z:this.cardStack.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),this.isSelected){let o=()=>this.selectionService.objects.filter(s=>s.aliasName===this.cardStack.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5c71\u672d",action:null,subActions:[{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceUpAll()),ze.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.faceDownAll()),ze.play(pe.cardDraw)}},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{o().forEach(s=>s.uprightAll()),ze.play(pe.cardDraw)}},At,{name:"\u3059\u3079\u3066\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{ze.play(pe.cardShuffle),o().forEach(s=>{s.shuffle(),U.call("SHUFFLE_CARD_STACK",{identifier:s.identifier})})}}]})}return e.push(At),e}makeContextMenu(){return[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ze.play(pe.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ze.play(pe.lock)},checkBox:"check"},At,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const i=this.drawCard();if(i){let r;ze.play(pe.cardDraw),r=i.isFront?`${this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(i=>({name:`${i}\u679a`,action:()=>{const r=[];for(let o=0;o<i;o++){const s=this.drawCard();s&&(r.push(s),(0==o||3==o||9==o)&&ze.play(pe.cardDraw))}if(r.length>0){const o=r.filter(s=>s.isFront);if(0==o.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${r.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const s=new Map;for(const l of o){const u=""==l.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":l.name;let f=s.get(u)||0;f+=1,s.set(u,f)}let a=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...s.keys()].map(l=>l+(s.get(l)<=1?"":` \xd7${s.get(l)}\u679a`)).join("\u3001")}`;a+=o.length===r.length?" \u3092\u5f15\u3044\u305f":` \u3092\u5f15\u304d\u3001${r.length-o.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(a)}}}})),disabled:0==this.cards.length},At,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),ze.play(pe.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.topCard&&(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),ze.play(pe.cardDraw))},disabled:0==this.cards.length},At,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),ze.play(pe.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),ze.play(pe.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),ze.play(pe.cardDraw)},disabled:0==this.cards.length},At,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),ze.play(pe.cardShuffle),U.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b...",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},At,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1},checkBox:"check"}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0},checkBox:"check"},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},At,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(xt.peerIds.length),ze.play(pe.cardDraw)}},At,...[2,3,4,5,6].map(i=>({name:`${i}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(i),ze.play(pe.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),ze.play(pe.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),ze.play(pe.cardDraw),ze.play(pe.cardDraw),U.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},At,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{_e.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(xa,{url:r,title:this.cardStack.name,subTitle:i.name})},disabled:!_e.validUrl(r),error:_e.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(r)&&!_e.sameOrigin(r)}})},this.cardStack.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.cardStack.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.owner="",i.isLocked=!1,i.toTopmost(),ze.play(pe.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),ze.play(pe.sweep)}}]}showDetail(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=xt.peer.userId,this.panelService.open(sge,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Xo),F(bi),F(_r),F(io),F(sc),F(Gm),F(hr),F(Ii),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["card-stack"]],hostBindings:function(i,r){1&i&&X("carddrop",function(s){return r.onCardDrop(s)})("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{cardStack:"cardStack",is3D:"is3D"},features:[mr],decls:7,vars:17,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.ondragstart","rotable.ondragend","ngClass","rotable.option","rotable.disable"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards is-pointer-events-none","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards","is-pointer-events-none",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"],[1,"selected-highlight",3,"ngClass"]],template:function(i,r){1&i&&(p(0,"div",0),X("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1),X("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),L(2,hge,4,10,"div",2)(3,fge,13,16,"ng-container",3)(4,pge,3,7,"div",4)(5,gge,5,8,"div",5)(6,mge,1,3,"div",6),m()()),2&i&&(ke("width",r.size*r.gridSize,"px"),_("ngClass",Be(13,age,r.isEmpty))("movable.option",r.movableOption)("movable.disable",r.isLocked),h(),_("ngClass",Be(15,lge,!r.isLocked))("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),_("ngIf",r.topCard&&r.imageFile),h(),_("ngIf",!r.isIconHidden),h(),_("ngIf",r.isShowTotal),h(),_("ngIf",r.hasOwner),h(),_("ngIf",r.isSelected))},dependencies:[Fi,ni,Zo,gs,Dp,fr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.is-backface-hidden[_ngcontent-%COMP%]{backface-visibility:hidden}.component[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;inset:0;margin:auto;height:auto;width:100%;backface-visibility:hidden}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;position:absolute;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99;inset:-5px}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5;transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9;backface-visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[Vn("shuffle",[Xt("* => active",[jt("800ms ease",mn([Pe({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),Pe({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),Xt("* => inverse",[jt("200ms ease",mn([Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),Pe({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),Pe({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),Vn("bounceInOut",[Xt("void => *",[jt("600ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();const bge=["characterImage"],vge=["chatBubble"],yge=(t,n,e)=>({selected:t,"not-inventory":n,"is-hide-in-pedestal":e}),_B=(t,n,e,i,r,o,s,a)=>({black:t,blue:n,green:e,cyan:i,red:r,magenta:o,yellow:s,white:a}),hv=t=>({transform:t}),Cge=t=>({fall:t}),xge=(t,n,e)=>({inverse:t,"black-paint":n,hollow:e}),wge=(t,n,e)=>({bottom:t,transform:n,visibility:e}),Ege=t=>({"is-magnetic":t}),Tge=t=>({opacity:t}),Ige=(t,n)=>({"background-color":t,transform:n}),Sge=t=>({"is-hide-in-tag":t}),Mge=t=>({"is-hide-in":t}),bB=(t,n,e)=>({emote:t,rubied:n,"is-whisper":e}),vB=t=>({transform:t});function Dge(t,n){if(1&t&&Ne(0,"div",33),2&t){const e=y();_("ngClass",Be(1,Ege,e.isMagnetic))}}function Oge(t,n){if(1&t&&(Ne(0,"img",34),It(1,"safe")),2&t){const e=y();ke("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),_("src",St(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),gn)("ngStyle",Be(10,Tge,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}function Age(t,n){if(1&t&&(p(0,"div",35)(1,"div",36)(2,"b"),x(3),m()(),p(4,"div",37)(5,"b"),x(6),m()()()),2&t){const e=y();_("ngStyle",Cn(3,Ige,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),h(3),Re(e.ownerName),h(3),Re(e.ownerName)}}function kge(t,n){if(1&t&&(p(0,"div",38)(1,"div",39),x(2),m(),p(3,"div",40),x(4),m()()),2&t){const e=y();_("ngClass",Be(4,Sge,e.isHideIn))("ngStyle",Be(6,hv,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),h(2),Re(e.name),h(2),Re(e.name)}}function Pge(t,n){if(1&t){const e=Ie();p(0,"img",41,1),It(2,"safe"),X("load",function(){return O(e),D(y().onImageLoad())}),m()}if(2&t){const e=y();ke("height",e.characterImageHeight,"px"),_("src",St(2,4,e.imageFile.url,"resourceUrl"),gn)("ngClass",Be(7,Mge,e.isHideIn))}}function Fge(t,n){if(1&t&&(p(0,"span",48),Ne(1,"img",49),It(2,"safe"),m()),2&t){const e=y(2);h(),ke("border-color",e.dialogColor),_("src",St(2,3,e.dialogFaceIcon.url,"resourceUrl"),gn)}}function Nge(t,n){if(1&t&&(p(0,"span",48),Ne(1,"img",49),It(2,"safe"),m()),2&t){const e=y(2);h(),ke("border-color",e.dialogColor),_("src",St(2,3,e.dialogFaceIcon.url,"resourceUrl"),gn)}}function Rge(t,n){if(1&t&&(p(0,"div",42)(1,"div",43)(2,"p",44),L(3,Fge,3,6,"span",45),Ne(4,"span",46),It(5,"safe"),m(),p(6,"p",47),L(7,Nge,3,6,"span",45),Ne(8,"span",46),It(9,"safe"),m()()()),2&t){const e=y();ke("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),_("@fadeAndScaleInOut",e.isEmote),h(2),ke("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),_("ngClass",ma(23,bB,e.isEmote,e.isRubied,e.isWhisper)),h(),_("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),h(),_("innerHTML",St(5,17,e.dialogText,"html"),eo),h(2),ke("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),_("ngClass",ma(27,bB,e.isEmote,e.isRubied,e.isWhisper)),h(),_("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),h(),_("innerHTML",St(9,20,e.dialogText,"html"),eo)}}function Lge(t,n){if(1&t&&(p(0,"div",50)(1,"div",43)(2,"span",51)(3,"i"),x(4),m()(),p(5,"span",52)(6,"i"),x(7),m()()(),p(8,"div",43)(9,"span",53),x(10),m(),p(11,"span",54),x(12),m()(),p(13,"div",55)(14,"span",51)(15,"i"),x(16),m()(),p(17,"span",52)(18,"i"),x(19),m()()()()),2&t){const e=y();ke("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),_("ngStyle",Be(14,vB,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(),ke("visibility",e.altitude>0?"visible":"hidden"),h(3),Re(e.elevation),h(3),Re(e.elevation),h(3),Re(e.math.abs(e.altitude)),h(2),Re(e.math.abs(e.altitude)),h(),ke("visibility",e.altitude<0?"visible":"hidden"),_("ngStyle",Be(16,vB,"translateY("+(e.chatBubbleAltitude+4)+"px)")),h(3),Re(e.elevation),h(3),Re(e.elevation)}}let Bge=(()=>{class t{get name(){return this.gameCharacter.name}get size(){return ji.clampMin(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return ji.clampMin(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!Ce.myCursor&&Ce.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?Yt.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get selectionState(){return this.selectionService.state(this.gameCharacter)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=_e.cr(e.text);const r=_e.isEmote(i),o=[],s=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let a,l=0,u=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(a=s.exec(i));){let M=a.index-3*l;o.push({base:a[1],ruby:a[2],start:M-u,end:M+a[1].length-u-1}),l++,u+=a[2].length}let f=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;f>200&&(f=200),this.dialogTimeOutId=setTimeout(()=>{this.gameCharacter.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*f+6e3),this.gameCharacter.dialog=e,this.gameCharacter.isEmote=r,l=0;let g=0,v=0,C="",E=o.shift(),w="",T=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const M=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let S=M[l],P=S.length>1;if(S){if(!T&&E&&g>=E.start&&(C+="<ruby>",T=!0,v=0),C+=_e.escapeHtml(S),T){v+=1;let Z=E.ruby;w="<rt>"+_e.escapeHtml(Array.from(Z).slice(0,Math.ceil(Array.from(Z).length*(v/Array.from(E.base).length))).join(""))+"</rt>"}T&&E&&g>=E.end-(P?1:0)&&(C+=w+"</ruby>",T=!1,E=o.shift()),g+=S.length}l+=1,this.gameCharacter.text=C+(T?w+"</ruby>":""),this.changeDetector.markForCheck(),l>=M.length&&clearInterval(this.chatIntervalId)},f)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this.gameCharacter.dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(""!=this.name?24:0))*e+4,o=this.characterImageWidth/2*i+4+this.characterImageWidth/2;let s=r>o?r:o;return this.gameCharacter.chatBubbleAltitude=s,s}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:Ce.CHAT_DEFAULT_COLOR}constructor(e,i,r,o,s,a,l){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=o,this.ngZone=s,this.modalService=a,this.selectionService=l,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=_e,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={},this.rollOption={}}ngOnChanges(){U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameCharacter?.identifier}`,e=>{this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameCharacter?.identifier}`,e=>{this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.gameCharacter.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}).on(`UPDATE_SELECTION/identifier/${this.gameCharacter?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter},this.rollOption={tabletopObject:this.gameCharacter,targetPropertyName:"roll"}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),U.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),this.isHideIn||ze.play(pe.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&U.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||ze.play(pe.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.gameCharacter.location.x+this.gameCharacter.size*this.gridSize/2,y:this.gameCharacter.location.y+this.gameCharacter.size*this.gridSize/2,z:this.gameCharacter.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameCharacter.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",action:null,subActions:[{name:"\u3059\u3079\u3066\u5171\u6709\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("common"),this.selectionService.remove(o)}),ze.play(pe.piecePut)}},{name:"\u3059\u3079\u3066\u500b\u4eba\u30a4\u30d9\u30f3\u30c8\u30ea\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation(xt.peerId),this.selectionService.remove(o)}),ze.play(pe.piecePut)}},{name:"\u3059\u3079\u3066\u5893\u5834\u306b\u79fb\u52d5",action:()=>{r().forEach(o=>{o.setLocation("graveyard"),this.selectionService.remove(o)}),ze.play(pe.sweep)}}]})}return e.push(At),e}makeContextMenu(){return[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",ze.play(pe.piecePut)):(!cn.isStealthMode&&!Ce.myCursor.isGMMode&&this.modalService.open(Mr,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:or.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=xt.peer.userId,ze.play(pe.sweep),U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),U.call("UPDATE_INVENTORY",!0)}},At,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((i,r)=>({name:this.gameCharacter.currntImageIndex==r?"\u25c9":"\u25cb",action:()=>{this.changeImage(r)},default:this.gameCharacter.currntImageIndex==r,icon:i,checkBox:"radio"}))},this.gameCharacter.imageFiles.length<=1?null:At,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"},At].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((i,r)=>({name:`${this.aura==r?"\u25c9":"\u25cb"} ${i}`,colorSample:!0,action:()=>{this.aura=r,U.trigger("UPDATE_INVENTORY",null)},checkBox:"radio"})))},At,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,U.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},At,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||ze.play(pe.sweep))},altitudeHande:this.gameCharacter},At,{name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.gameCharacter)}},this.gameCharacter.isAllowsChat?{name:"\u2611 \u30c1\u30e3\u30c3\u30c8\u3092\u884c\u3046",action:()=>{this.gameCharacter.isAllowsChat=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30c1\u30e3\u30c3\u30c8\u3092\u884c\u3046",action:()=>{this.gameCharacter.isAllowsChat=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a...",action:()=>{this.showChatPalette(this.gameCharacter)},disabled:!this.gameCharacter.isAllowsChat},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a...",action:()=>{this.showStandSetting(this.gameCharacter)},disabled:!this.gameCharacter.isAllowsChat},At,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{_e.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(xa,{url:r,title:this.gameCharacter.name,subTitle:i.name})},disabled:!_e.validUrl(r),error:_e.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(r)&&!_e.sameOrigin(r)}}),disabled:this.gameCharacter.getUrls().length<=0},At,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,U.trigger("UPDATE_INVENTORY",null)},checkBox:"check"},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),this.selectionService.remove(this.gameCharacter),ze.play(pe.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(xt.peerId),this.selectionService.remove(this.gameCharacter),ze.play(pe.piecePut)}},{name:"\u5893\u5834",action:()=>{U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),this.selectionService.remove(this.gameCharacter),ze.play(pe.sweep)}}]},At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.gameCharacter.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),ze.play(pe.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const i=this.gameCharacter.clone(),r=i.name.split("_");let o;o=r.length>1&&/\d+/.test(r[r.length-1])?r.slice(0,r.length-1).join("_"):r.join("_");let s=0;for(const a of dt.instance.getObjects(cn)){if(!a.name.startsWith(o))continue;let l=a.name.match(/_(\d+)$/)?+RegExp.$1:0;l>s&&(s=l)}i.name=o+"_"+(s+1),i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),ze.play(pe.piecePut)}},At,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),this.selectionService.remove(this.gameCharacter),ze.play(pe.sweep)}}]}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){if(!e||!e.isAllowsChat)return;let i=this.pointerDeviceService.pointers[0];this.panelService.open(Hm,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(ev,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||ze.play(pe.surprise),U.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),U.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}static#e=this.\u0275fac=function(i){return new(i||t)(F(Xo),F(bi),F(io),F(hr),F(Sn),F(Ii),F(sc))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-character"]],viewQuery:function(i,r){if(1&i&&(Dn(bge,5),Dn(vge,5)),2&i){let o;On(o=An())&&(r.characterImage=o.first),On(o=An())&&(r.chatBubble=o.first)}},hostBindings:function(i,r){1&i&&X("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},features:[mr],decls:37,vars:86,consts:[["chatBubble",""],["characterImage",""],["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"dblclick","ngClass","ngStyle"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"load","src","ngClass"],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",2),X("movable.ondragstart",function(){return O(o),D(r.onMove())})("movable.ondragend",function(){return O(o),D(r.onMoved())}),p(1,"div",3)(2,"div",4),X("rotable.ondragstart",function(){return O(o),D(r.onMove())})("rotable.ondragend",function(){return O(o),D(r.onMoved())}),p(3,"div",5)(4,"div",6)(5,"div",7),x(6,"autorenew"),m(),p(7,"div",8),x(8,"autorenew"),m()()(),Ne(9,"div",9),L(10,Dge,1,3,"div",10),Ne(11,"div",11),p(12,"div",12)(13,"div",13)(14,"div",14)(15,"div",15),L(16,Oge,2,12,"img",16),m()()()(),p(17,"div",17),X("dblclick",function(){return O(o),D(r.nextImage())}),p(18,"div",18),X("rotable.ondragstart",function(){return O(o),D(r.onMove())})("rotable.ondragend",function(){return O(o),D(r.onMoved())}),p(19,"div",19),L(20,Age,7,6,"div",20)(21,kge,5,8,"div",21),p(22,"div",22)(23,"div",23)(24,"span",24),L(25,Pge,3,9,"img",25),m()()(),p(26,"div",26)(27,"div",27)(28,"i",28),x(29,"autorenew"),m()(),p(30,"div",29)(31,"i",28),x(32,"autorenew"),m()()()()(),p(33,"div",30,0),L(35,Rge,10,31,"div",31),m()()(),L(36,Lge,20,18,"div",32),m()()}2&i&&(ke("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),_("movable.option",r.movableOption),h(),_("@bounceInOut","in"),h(),_("rotable.option",r.rotableOption),h(7),_("@switchImagePedestal",r.gameCharacter.currntImageIndex)("ngClass",ma(46,yge,r.selected,!r.gameCharacter.isInventoryIndicate,r.isHideIn)),h(),_("ngIf",r.isSelected),h(),_("@switchImagePedestal",r.gameCharacter.currntImageIndex),h(),ke("transform","translateX("+(r.size*r.gridSize-r.characterShadowImageWidth)/2+"px) translateY("+r.characterShadowOffset+"px) scale(1.0, 0.66)"),h(),ke("width",r.characterShadowImageWidth,"px")("height",r.characterShadowImageHeight,"px")("transform","rotateZ("+r.roll+"deg)"),h(),_("ngClass",Dc(50,_B,0==r.aura,1==r.aura,2==r.aura,3==r.aura,4==r.aura,5==r.aura,6==r.aura,7==r.aura)),h(),_("ngStyle",Be(59,hv,"scaleX("+(r.isInverse?"-1":"1")+")")),h(),_("ngIf",r.isDropShadow&&(0<r.imageFile.url.length||0<r.shadowImageFile.url.length)),h(),_("ngClass",Be(61,Cge,0==r.altitude))("ngStyle",Be(63,hv,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-r.altitude*r.gridSize+"px)")),h(),ke("transform-origin","center "+.333*-r.characterImageHeight+"px"),_("rotable.option",r.rollOption),h(),ke("transform","translateZ("+-r.size*r.gridSize/2+"px)"),h(),_("ngIf",r.isGMMode&&r.isHideIn&&0<r.ownerName.length),h(),_("ngIf",0<r.name.length),h(),_("@switchImage",r.gameCharacter.currntImageIndex)("ngClass",Dc(65,_B,0==r.aura,1==r.aura,2==r.aura,3==r.aura,4==r.aura,5==r.aura,6==r.aura,7==r.aura)),h(),_("ngClass",ma(74,xge,r.isInverse,r.isBlackPaint,r.isHollow)),h(),ke("width",r.characterImageWidth,"px")("height",r.characterImageHeight,"px")("transform","translateX("+(r.size*r.gridSize-r.characterImageWidth)/2+"px)"),h(),_("ngIf",0<r.imageFile.url.length),h(2),_("ngStyle",Be(78,hv,"translateX(-50%) translateX("+r.size*r.gridSize/2+"px) translateY("+(-r.characterImageHeight-(r.isGMMode&&r.isHideIn?20:0))+"px)")),h(3),_("ngStyle",Be(80,hv,"translateX(-50%) translateX("+r.size*r.gridSize/2+"px")),h(3),_("ngStyle",ma(82,wge,r.chatBubbleAltitude-(r.isEmote?r.gridSize/2:0)-4+"px","translateZ("+-r.size*r.gridSize/2+"px) translateX(-50%) translateX("+r.size*r.gridSize/2+"px) rotateY("+(r.rotate+r.viewRotateZ)+"deg) rotateX("+r.chatBubbleXDeg+"deg)",r.gameCharacter.isShowChatBubble?"visible":"hidden")),h(2),_("ngIf",r.isListen),h(),_("ngIf",r.isAltitudeIndicate&&(r.altitude<=-.5||.5<=r.altitude)))},dependencies:[Fi,ni,Zo,gs,Dp,fr],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:25px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{object-fit:contain;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:#f5f5f5 0px 0px 3px;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,#f0dabde6,#fff4e8e6);border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:#555c;box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:_ngcontent-%COMP%_chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;animation:_ngcontent-%COMP%_chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{animation-duration:.6s}@keyframes _ngcontent-%COMP%_chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scaleZ(1)}}@keyframes _ngcontent-%COMP%_chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scaleZ(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;object-fit:cover;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[Vn("switchImage",[Xt(":increment, :decrement",[jt("400ms ease",mn([Pe({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),Pe({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),Pe({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),Vn("switchImageShadow",[Xt(":increment, :decrement",[jt("400ms ease",mn([Pe({transform:"scale3d(0.8, 0.8, 0.8)"}),Pe({transform:"scale3d(0, 1.2, 1.2)"}),Pe({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("switchImagePedestal",[Xt(":increment, :decrement",[jt("400ms ease",mn([Pe({transform:"scale3d(0, 0, 0)"}),Pe({transform:"scale3d(1.2, 1.2, 1.2)"}),Pe({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),Vn("bounceInOut",[Xt("void => *",[jt("600ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale3d(0, 0, 0)"}))])]),Vn("fadeAndScaleInOut",[Xt("void => *, true => false",[jt("200ms ease-in-out",mn([Pe({transform:"scale3d(0, 0, 0)",opacity:0}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),Xt("* => void, true => false",[jt("100ms ease-in-out",Pe({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0})}return t})();var Uge=me(7376);const Hge=(t,n,e)=>({"is-grab":t,"is-scratching":n,"is-border":e}),zge=t=>({fall:t}),Vge=t=>({transform:t}),jge=(t,n,e,i)=>({opacity:t,"background-color":n,"-webkit-mask":e,mask:i}),Gge=t=>({image:t}),Xx=t=>({"is-inverse":t}),Wge=t=>({"is-magnetic":t}),$ge=t=>({"is-mine":t}),Yge=t=>({"background-color":t}),qge=t=>({transform:t});function Zge(t,n){if(1&t&&(p(0,"div",13),Ne(1,"div",14),m()),2&t){const e=y();ke("width",e.width*e.gridSize-4,"px")("height",e.height*e.gridSize-4,"px"),h(),ke("font-size",e.fontSize+9,"px")("color",e.color)("text-shadow",e.textShadowCss),_("ngClass",Be(12,Xx,e.isInverse))("innerHtml",e.rubiedText,eo)}}function Xge(t,n){if(1&t&&(Ne(0,"img",15),It(1,"safe")),2&t){const e=y();ke("mix-blend-mode",1==e.blendType?null:"hard-light"),_("src",St(1,3,e.imageFileUrl,"resourceUrl"),gn)}}function Kge(t,n){if(1&t&&(nu(),Me(0),Ne(1,"rect",19)(2,"rect",20),De()),2&t){const e=y().$implicit,i=y(2);h(),$t("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),h(),$t("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10)}}function Qge(t,n){if(1&t&&(nu(),Me(0),Ne(1,"line",21)(2,"line",21)(3,"line",22)(4,"line",22),De()),2&t){const e=y().$implicit,i=y(2);h(),$t("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),h(),$t("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5)),h(),$t("x1",e.x*i.gridSize+5)("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+(i.gridSize-5))("y2",e.y*i.gridSize+(i.gridSize-5)),h(),$t("x1",e.x*i.gridSize+(i.gridSize-5))("y1",e.y*i.gridSize+5)("x2",e.x*i.gridSize+5)("y2",e.y*i.gridSize+(i.gridSize-5))}}function Jge(t,n){if(1&t&&(nu(),Me(0),Ne(1,"rect",23)(2,"line",21)(3,"line",21)(4,"rect",24)(5,"line",25)(6,"line",25),De()),2&t){const e=y().$implicit,i=y(2);h(),$t("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),h(),$t("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),h(),$t("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35),h(),$t("x",e.x*i.gridSize+5)("y",e.y*i.gridSize+5)("width",i.gridSize-10)("height",i.gridSize-10),h(),$t("x1",e.x*i.gridSize+15)("y1",e.y*i.gridSize+25)("x2",e.x*i.gridSize+35)("y2",e.y*i.gridSize+25),h(),$t("x1",e.x*i.gridSize+25)("y1",e.y*i.gridSize+15)("x2",e.x*i.gridSize+25)("y2",e.y*i.gridSize+35)}}function eme(t,n){if(1&t&&(nu(),p(0,"g")(1,"desc"),x(2),m(),Me(3,17),L(4,Kge,3,8,"ng-container",18)(5,Qge,5,16,"ng-container",18)(6,Jge,7,24,"ng-container",18),De(),m()),2&t){const e=n.$implicit,i=y(2);ke("transform-origin",(e.x+.5)*i.gridSize+"px "+(e.y+.5)*i.gridSize+"px"),_("@rotateInOut",e.state),h(2),Re(e.state),h(),_("ngSwitch",e.state),h(),_("ngSwitchCase","scrached"),h(),_("ngSwitchCase","scraching"),h(),_("ngSwitchCase","restore")}}function tme(t,n){if(1&t&&(nu(),p(0,"svg"),L(1,eme,7,8,"g",16),m()),2&t){const e=y();_("@fadeInOut",void 0),$t("width",e.width*e.gridSize)("height",e.height*e.gridSize)("viewBox","0, 0, "+e.width*e.gridSize+", "+e.height*e.gridSize),h(),_("ngForOf",e.scratchingGridInfos)("ngForTrackBy",e.identify)}}function nme(t,n){if(1&t&&Ne(0,"div",26),2&t){const e=y();_("ngClass",Be(1,Wge,e.isMagnetic))}}function ime(t,n){if(1&t&&(p(0,"div",27)(1,"i",28),x(2),m()()),2&t){const e=y();h(),_("ngClass",Be(2,Xx,e.isInverse)),h(),Re(e.isLock?"lock":"open_with")}}function rme(t,n){if(1&t&&(p(0,"div",29)(1,"i",28),x(2),m()()),2&t){const e=y();_("ngClass",Be(3,$ge,e.gameTableMask.isMine)),h(),_("ngClass",Be(5,Xx,e.isInverse)),h(),Re(e.isPreviewMode?"visibility":"draw")}}function ome(t,n){1&t&&(p(0,"i",36),x(1,"visibility"),m())}function sme(t,n){if(1&t){const e=Ie();p(0,"button",37),X("pointerdown",function(r){return O(e),D(y(2).prevent(r))})("mousedown",function(r){return O(e),D(y(2).prevent(r))})("click",function(r){return O(e),D(y(2).scratchDone(r))}),p(1,"i",38),x(2,"done"),m()()}2&t&&_("title",y(2).gameTableMask.scratchingGrids?"\u78ba\u5b9a":"\u7d42\u4e86")}function ame(t,n){if(1&t){const e=Ie();p(0,"button",39),X("pointerdown",function(r){return O(e),D(y(2).prevent(r))})("mousedown",function(r){return O(e),D(y(2).prevent(r))})("click",function(r){return O(e),D(y(2).scratchCancel(r))}),p(1,"i",38),x(2,"clear"),m()()}}function lme(t,n){if(1&t&&(p(0,"div",30)(1,"div",31)(2,"span",32),L(3,ome,2,0,"i",33),p(4,"b"),x(5),m(),x(6," \u304c\u64cd\u4f5c\u4e2d "),L(7,sme,3,1,"button",34)(8,ame,3,0,"button",35),m()()()),2&t){const e=y();h(),_("ngStyle",Be(6,Yge,e.ownerColor+"E6")),h(),_("ngClass",Be(8,Xx,e.isInverse)),h(),_("ngIf",e.isPreview),h(2),Re(e.ownerName),h(2),_("ngIf",e.gameTableMask.isMine),h(),_("ngIf",e.gameTableMask.isMine)}}function cme(t,n){if(1&t&&(p(0,"div",40)(1,"div",41)(2,"span",42),x(3),m(),p(4,"span",43),x(5),m()()()),2&t){const e=y();ke("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),_("ngStyle",Be(5,qge,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(3),Re(e.math.abs(e.gameTableMaskAltitude)),h(2),Re(e.gameTableMaskAltitude)}}let ume=(()=>{class t{get name(){return this.gameTableMask.name}get width(){return ji.clampMin(this.gameTableMask.width)}get height(){return ji.clampMin(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get borderType(){return this.gameTableMask.borderType}set borderType(e){this.gameTableMask.borderType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get isPreview(){return this.gameTableMask.isPreview}set isPreview(e){this.gameTableMask.isPreview=e}get isPreviewMode(){return!!this.gameTableMask&&(this.isGMMode&&this.gameTableMask.isScratchPreviewOnGMMode||this.isPreview&&this.gameTableMask.isMine)}get textShadowCss(){const e=_e.textShadowColor(this.color);return`${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px, \n      ${e} 0px 0px 2px,\n      ${e} 0px 0px 2px,\n      ${e} 0px 0px 2px`}get scratchedGrids(){return this.gameTableMask.scratchedGrids}set scratchedGrids(e){this.gameTableMask.scratchedGrids=e}get scratchingGrids(){return this.gameTableMask.scratchingGrids}set scratchingGrids(e){this.gameTableMask.scratchingGrids=e}get isNonScratched(){return!this.gameTableMask.scratchedGrids}get isNonScratching(){return!(this.gameTableMask.scratchingGrids||this._currentScratchingSet)}get masksCss(){if(!this.isPreviewMode&&this.isNonScratched)return"";const e=[],i=new Set(this.scratchedGrids.split(/,/g)),r=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g));for(let o=0;o<this.width;o++)for(let s=0;s<this.height;s++){const a=`${o}:${s}`;if(this.isPreviewMode){if(i.has(a)&&!r.has(a)||r.has(a)&&!i.has(a))continue}else if(i.has(a))continue;e.push(`radial-gradient(#000, #000) ${o*this.gridSize-1}px ${s*this.gridSize-1}px / ${this.gridSize+2}px ${this.gridSize+2}px no-repeat`)}return e.length?e.join(","):"radial-gradient(#000, #000) 0px 0px / 0px 0px no-repeat"}get scratchingGridInfos(){const e=[];if(!this.gameTableMask||this.isNonScratching&&this.isNonScratched)return e;const i=this._currentScratchingSet?this._currentScratchingSet:new Set(this.scratchingGrids.split(/,/g)),r=new Set(this.scratchedGrids.split(/,/g));for(let o=0;o<Math.ceil(this.width);o++)for(let s=0;s<Math.ceil(this.height);s++){const a=`${o}:${s}`;(i.has(a)||r.has(a))&&e.push({x:o,y:s,state:i.has(a)?r.has(a)?"restore":"scraching":"scrached"})}return e}get operateOpacity(){const e=this.opacity*(this.isGMMode&&this.gameTableMask.isTransparentOnGMMode||this.isPreview&&this.gameTableMask.isMine?.6:1);return e<.4&&this.isScratching?.4:e}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return _e.rubyToHtml(_e.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}get isScratching(){return!!this.gameTableMask.owner}get hasOwner(){return this.gameTableMask.hasOwner}get ownerIsOnline(){return this.gameTableMask.ownerIsOnline}get ownerName(){return this.gameTableMask.ownerName}get ownerColor(){return this.gameTableMask.ownerColor}get selectionState(){return this.selectionService.state(this.gameTableMask)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get imageFileUrl(){let e="";return this.imageFile&&(this.imageFile.identifier!=this._currentimageFile?.identifier||this.imageFile.state!=this._currentImageFileState)&&(this._currentimageFile=this.imageFile,this._currentimageFile.state===Di.THUMBNAIL||this._currentimageFile.state===Di.COMPLETE?(this._currentImageFileState=this._currentimageFile.state,this._currentImageFileUrl&&(e=this._currentImageFileUrl),this._currentImageFileUrl=URL.createObjectURL(this._currentimageFile.blob)):this._currentImageFileUrl=this._currentimageFile.url),e&&queueMicrotask(()=>URL.revokeObjectURL(e)),this._currentImageFileUrl}constructor(e,i,r,o,s,a,l,u,f,g,v){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.selectionService=l,this.pointerDeviceService=u,this.modalService=f,this.coordinateService=g,this.chatMessageService=v,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null,this._currentImageFileUrl="",this._currentImageFileState=0,this._scratchingGridX=-1,this._scratchingGridY=-1}ngOnChanges(){U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${this.gameTableMask?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.10px)",colideLayers:["terrain"]},this.panelId=Il.k.generateUuid()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new bu(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this)}ngOnDestroy(){this.input.destroy(),U.unregister(this),clearTimeout(this._scratchingTimerId),this._currentImageFileUrl&&URL.revokeObjectURL(this._currentImageFileUrl)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.isScratching&&this.gameTableMask.isMine?!window.PointerEvent&&e.button<2&&e.buttons<2&&this.scratching(!0):this.input.cancel(),(this.isLock&&!this.isScratching||this.isScratching&&!this.gameTableMask.isMine)&&U.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onInputStartPointer(e){!this.isScratching||!this.gameTableMask.isMine||e.button<2&&e.buttons<2&&this.scratching(!0,{offsetX:e.offsetX,offsetY:e.offsetY})}onInputMove(e){!window.PointerEvent&&this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&this.scratching(!1)}onInputMovePointer(e){this.isScratching&&this.gameTableMask.isMine&&this.input.isDragging&&e.buttons<2&&this.scratching(!1,{offsetX:e.offsetX,offsetY:e.offsetY})}scratching(e,i=null){if(!this.gameTableMask.isMine)return;const r=Jo.instance;let o,s;if(r.gridShow||(r.viewTable.gridClipRect={top:0,right:0,bottom:0,left:0}),i)o=i.offsetX,s=i.offsetY;else{const f=this.coordinateService.calcTabletopLocalCoordinate(this.pointerDeviceService.pointers[0],this.elementRef.nativeElement);o=f.x-this.gameTableMask.location.x,s=f.y-this.gameTableMask.location.y}if(o<0||this.gameTableMask.width*this.gridSize<=o||s<0||this.gameTableMask.height*this.gridSize<=s)return;const a=Math.floor(o/this.gridSize),l=Math.floor(s/this.gridSize);if(!e&&this._scratchingGridX===a&&this._scratchingGridY===l)return;const u=`${a}:${l}`;this._scratchingGridX=a,this._scratchingGridY=l,this._currentScratchingSet||(this._currentScratchingSet=new Set(this.scratchingGrids.split(/,/g))),this._currentScratchingSet.has(u)?this._currentScratchingSet.delete(u):this._currentScratchingSet.add(u),clearTimeout(this._scratchingTimerId),this._scratchingTimerId=setTimeout(()=>{this.scratchingGrids=Array.from(this._currentScratchingSet).filter(f=>f&&/^\d+:\d+$/.test(f)).sort().join(","),this._currentScratchingSet=null},250)}scratched(){const e=this.scratchedGrids.split(/,/g);this._currentScratchingSet&&(clearTimeout(this._scratchingTimerId),this.scratchingGrids=Array.from(this._currentScratchingSet).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(","),this._currentScratchingSet=null);const i=this.scratchingGrids.split(/,/g);this.scratchedGrids=(0,Uge.xor)(e,i).filter(r=>r&&/^\d+:\d+$/.test(r)).sort().join(",")}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),ze.play(pe.cardPick)}onMoved(){ze.play(pe.cardPut)}scratchDone(e=null){return e&&(e.preventDefault(),e.stopPropagation()),this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratched(),this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,ze.play(pe.cardPut),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u7d42\u4e86\u3057\u305f`)),!1}scratchCancel(e=null){return e&&(e.preventDefault(),e.stopPropagation()),!this.gameTableMask.isMine&&this.ownerIsOnline||(this.ngZone.run(()=>{this.gameTableMask.owner="",this.scratchingGrids="",this.isPreview=!1}),this._scratchingGridX=-1,this._scratchingGridY=-1,ze.play(pe.unlock),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u7d42\u4e86\u3057\u305f`)),!1}prevent(e){e.preventDefault(),e.stopPropagation()}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.gameTableMask.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u30de\u30c3\u30d7\u30de\u30b9\u30af",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLock=!0),ze.play(pe.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,o.parent&&o.parent.appendChild(s)}),ze.play(pe.cardPut)}}]})}return e.push(At),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate();return[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u6642\u900f\u904e\u8868\u793a",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1},checkBox:"check"}:{name:"\u2610 GM\u6642\u900f\u904e\u8868\u793a",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0},checkBox:"check"}:null,this.isGMMode?this.gameTableMask.isScratchPreviewOnGMMode?{name:"\u2611 GM\u6642\u30b9\u30af\u30e9\u30c3\u30c1\u30d7\u30ec\u30d3\u30e5\u30fc",action:()=>{this.gameTableMask.isScratchPreviewOnGMMode=!1},checkBox:"check"}:{name:"\u2610 GM\u6642\u30b9\u30af\u30e9\u30c3\u30c1\u30d7\u30ec\u30d3\u30e5\u30fc",action:()=>{this.gameTableMask.isScratchPreviewOnGMMode=!0},checkBox:"check"}:null,this.isGMMode?At:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,ze.play(pe.unlock)},disabled:this.isScratching,checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,ze.play(pe.lock)},disabled:this.isScratching,checkBox:"check"},this.isLock?null:{name:"\u91cd\u306a\u308a\u9806",action:null,subActions:[{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306e\u4e00\u756a\u4e0a\u306b",action:()=>{if(!this.isLock){const r=this.gameTableMask.parent;r&&r.appendChild(this.gameTableMask)}},disabled:this.isLock},{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306e\u4e00\u756a\u4e0b\u306b",action:()=>{if(!this.isLock){const r=this.gameTableMask.parent;r&&r.prependChild(this.gameTableMask)}},disabled:this.isLock}],disabled:this.isLock},At,this.gameTableMask.isMine?{name:"\u30b9\u30af\u30e9\u30c3\u30c1"+(this.isNonScratching?"\u7d42\u4e86":"\u78ba\u5b9a"),action:()=>{this.scratchDone()}}:{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u958b\u59cb",action:()=>{let r=!1;if(""!=this.gameTableMask.owner){this.isPreview=!1,clearTimeout(this._scratchingTimerId),this._currentScratchingSet=null;const o=Ce.findByUserId(this.gameTableMask.owner);o&&(this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092 ${""==o.name?"(\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc)":o.name} \u304b\u3089\u5f15\u304d\u7d99\u3044\u3060`),r=!0)}this.gameTableMask.owner=xt.peer.userId,this._scratchingGridX=-1,this._scratchingGridY=-1,ze.play(pe.lock),r||this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u958b\u59cb\u3057\u305f`)}},{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u30ad\u30e3\u30f3\u30bb\u30eb",action:()=>{this.scratchCancel()},disabled:!this.isScratching||!this.gameTableMask.isMine&&this.ownerIsOnline},{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u64cd\u4f5c",subActions:[{name:"\u9069\u7528\u3057\u3066\u7d9a\u3051\u308b",action:()=>{this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratched(),this.scratchingGrids=""}),this._scratchingGridX=-1,this._scratchingGridY=-1,ze.play(pe.cardDraw))},disabled:!this.gameTableMask.isMine||this.isNonScratching},{name:"\u7834\u68c4\u3057\u3066\u7d9a\u3051\u308b",action:()=>{this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.scratchingGrids="",clearTimeout(this._scratchingTimerId),this._currentScratchingSet=null}),this._scratchingGridX=-1,this._scratchingGridY=-1,ze.play(pe.sweep))},disabled:!this.gameTableMask.isMine||this.isNonScratching},At,this.isPreview?{name:"\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\u89e3\u9664",action:()=>{this.gameTableMask.isMine&&(this.ngZone.run(()=>{this.isPreview=!1}),ze.play(pe.lock))},selfOnly:!0,disabled:!this.gameTableMask.isMine}:{name:"\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\u958b\u59cb",action:()=>{this.gameTableMask.isMine&&this.modalService.open(Mr,{title:"\u30b9\u30af\u30e9\u30c3\u30c1\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9",text:"\u30b9\u30af\u30e9\u30c3\u30c1\u4e2d\u306b\u9069\u7528\u5f8c\u306e\u72b6\u614b\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u81ea\u5206\u306e\u307f\u3001<b>\u3053\u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u78ba\u5b9a/\u30ad\u30e3\u30f3\u30bb\u30eb\u3059\u308b\u307e\u3067</b>\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306f\u900f\u904e\u8868\u793a\u306b\u306a\u308a\u3001\u307e\u305f\u30b9\u30af\u30e9\u30c3\u30c1\u9069\u7528\u5f8c\u306e\u72b6\u614b\u3092\u8868\u793a\u3057\u307e\u3059\u3002",type:or.OK_CANCEL,materialIcon:"visibility",action:()=>{this.ngZone.run(()=>{this.isPreview=!0}),ze.play(pe.unlock),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u30d7\u30ec\u30d3\u30e5\u30fc\u30e2\u30fc\u30c9\u306b\u3057\u305f`)}})},selfOnly:!0,disabled:!this.gameTableMask.isMine},{name:"\u30b9\u30af\u30e9\u30c3\u30c1\u521d\u671f\u5316",action:()=>{this.gameTableMask.isMine&&this.modalService.open(Mr,{title:"\u30b9\u30af\u30e9\u30c3\u30c1\u521d\u671f\u5316",text:"\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u521d\u671f\u5316\u3057\u307e\u3059\u304b\uff1f",help:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u306f\u30b9\u30af\u30e9\u30c3\u30c1\u3055\u308c\u3066\u3044\u306a\u3044\u72b6\u614b\u306b\u306a\u308a\u3001\u64cd\u4f5c\u3092\u7d42\u4e86\u3057\u307e\u3059\u3002",type:or.OK_CANCEL,materialIcon:"draw",action:()=>{this.ngZone.run(()=>{this.gameTableMask.owner="",this.scratchedGrids="",this.scratchingGrids="",this._currentScratchingSet=null,clearTimeout(this._scratchingTimerId)}),this._scratchingGridX=-1,this._scratchingGridY=-1,ze.play(pe.sweep),this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u306e\u30b9\u30af\u30e9\u30c3\u30c1\u3092\u521d\u671f\u5316\u3057\u305f`)}})},disabled:!this.gameTableMask.isMine||this.isNonScratched}],disabled:!this.gameTableMask.isMine},At,{name:"\u30dc\u30fc\u30c0\u30fc\u30e9\u30a4\u30f3\u306e\u8868\u793a",subActions:[{name:(0==this.borderType?"\u25c9":"\u25cb")+" \u64cd\u4f5c\u6642\u306e\u307f\u8868\u793a",action:()=>{this.borderType=0},checkBox:"radio"},{name:(1==this.borderType?"\u25c9":"\u25cb")+" \u64cd\u4f5c\u6642\u3001\u975e\u56fa\u5b9a",action:()=>{this.borderType=1},checkBox:"radio"},{name:(2==this.borderType?"\u25c9":"\u25cb")+" \u5e38\u306b\u8868\u793a",action:()=>{this.borderType=2},checkBox:"radio"}],disabled:this.isScratching},{name:"\u753b\u50cf\u3068\u8272\u306e\u8868\u793a",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,ze.play(pe.cardDraw)},checkBox:"radio"},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,ze.play(pe.cardDraw)},checkBox:"radio"},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,ze.play(pe.cardDraw)},checkBox:"radio"},At,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",ze.play(pe.cardDraw)}}],disabled:this.isScratching},At,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,ze.play(pe.sweep))},disabled:this.isScratching,altitudeHande:this.gameTableMask,altitudeDisabled:this.isScratching},At,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{_e.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(xa,{url:o,title:this.gameTableMask.name,subTitle:r.name})},disabled:!_e.validUrl(o),error:_e.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(o)&&!_e.sameOrigin(o)}})},this.gameTableMask.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLock=!1,r.isPreview=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(r),ze.play(pe.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.chatMessageService.sendOperationLog(`${""==this.gameTableMask.name?"(\u7121\u540d\u306e\u30de\u30c3\u30d7\u30de\u30b9\u30af)":this.gameTableMask.name} \u3092\u524a\u9664\u3057\u305f`),this.gameTableMask.destroy(),ze.play(pe.sweep)}},At,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}]}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}identify(e,i){return`${this.panelId}:${i.x}:${i.y}`}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Zx),F(Xo),F(_r),F(bi),F(io),F(sc),F(hr),F(Ii),F(Kh),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-table-mask"]],hostBindings:function(i,r){1&i&&X("dragstart",function(s){return r.onDragstart(s)})("pointerdown",function(s){return r.onInputStartPointer(s)})("pointermove",function(s){return r.onInputMovePointer(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},features:[mr],decls:13,vars:34,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],[1,"is-fit-full","is-3d",2,"pointer-events","none",3,"ngClass","ngStyle"],["class","is-3d text","style","left: 2px; top: 2px; backface-visibility: hidden",3,"width","height",4,"ngIf"],[1,"is-fit-full","is-3d"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","auto","position","absolute","backface-visibility","hidden",3,"ngStyle","ngClass"],["class","is-fit-full is-3d chrome-smooth-image-trick","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],[1,"is-fit-full","is-3d","scratching-area","border",2,"pointer-events","none","backface-visibility","hidden"],[4,"ngIf"],["class","selected-highlight border",3,"ngClass",4,"ngIf"],["class","lock-icon is-center is-3d","style","pointer-events: none; z-index: 10; backface-visibility: hidden",4,"ngIf"],["class","draw-icon is-center is-3d","style","pointer-events: none; z-index: 10; backface-visibility: hidden",3,"ngClass",4,"ngIf"],["class","scratching is-center is-3d","style","pointer-events: none; z-index: 10; top: -10px; left: 1px; backface-visibility: hidden",4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"is-fit-full","is-3d","chrome-smooth-image-trick",2,"pointer-events","none","position","absolute",3,"src"],[3,"transform-origin",4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngSwitch"],[4,"ngSwitchCase"],["fill","none","stroke","#22222288","stroke-width","5","stroke-linejoin","round"],["fill","none","stroke","#ff3e3e","stroke-width","4","stroke-linejoin","round"],["stroke","#22222288","stroke-width","6","stroke-linecap","round"],["stroke","#ff3e3e","stroke-width","4","stroke-linecap","round"],["fill","none","stroke","#22222288","stroke-width","6","stroke-linejoin","round"],["fill","none","stroke","#8098ff","stroke-width","4","stroke-linejoin","round"],["stroke","#8098ff","stroke-width","4","stroke-linecap","round"],[1,"selected-highlight","border",3,"ngClass"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10","backface-visibility","hidden"],[1,"material-icons",2,"pointer-events","none","backface-visibility","hidden","display","inline-block",3,"ngClass"],[1,"draw-icon","is-center","is-3d",2,"pointer-events","none","z-index","10","backface-visibility","hidden",3,"ngClass"],[1,"scratching","is-center","is-3d",2,"pointer-events","none","z-index","10","top","-10px","left","1px","backface-visibility","hidden"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background",2,"color","whitesmoke",3,"ngStyle"],[2,"display","inline-block",3,"ngClass"],["style","margin-right: 2px","class","material-icons",4,"ngIf"],["class","edit-button",3,"title","pointerdown","mousedown","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"pointerdown","mousedown","click",4,"ngIf"],[1,"material-icons",2,"margin-right","2px"],[1,"edit-button",3,"pointerdown","mousedown","click","title"],[1,"material-icons","small-font"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"pointerdown","mousedown","click"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(i,r){1&i&&(p(0,"div",0),X("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1),L(2,Zge,2,14,"div",2),p(3,"div",3)(4,"div",4),L(5,Xge,2,6,"img",5),m(),p(6,"div",6),L(7,tme,2,6,"svg",7),m(),L(8,nme,1,3,"div",8),m(),L(9,ime,3,4,"div",9)(10,rme,3,7,"div",10)(11,lme,9,10,"div",11),m(),L(12,cme,6,7,"div",12),m()),2&i&&(ke("width",r.width*r.gridSize,"px")("height",r.height*r.gridSize,"px"),_("ngClass",ma(19,Hge,!r.isLock&&!r.isScratching,r.isScratching&&r.gameTableMask.isMine,r.isScratching||!r.isLock&&r.borderType>=1||r.borderType>=2))("movable.option",r.movableOption)("movable.disable",r.isLock||r.isScratching),h(),_("ngClass",Be(23,zge,0==r.altitude))("ngStyle",Be(25,Vge,"translateZ("+r.altitude*r.gridSize+"px)")),h(),_("ngIf",!r.isScratching),h(2),_("ngStyle",yl(27,jge,r.operateOpacity,r.imageFileUrl.length<1||r.blendType>0?r.bgcolor:null,r.masksCss,r.masksCss))("ngClass",Be(32,Gge,r.imageFileUrl.length>=1)),h(),_("ngIf",r.imageFileUrl.length>=1),h(2),_("ngIf",r.isScratching),h(),_("ngIf",r.isSelected),h(),_("ngIf",!r.isScratching),h(),_("ngIf",r.isScratching),h(),_("ngIf",r.isScratching&&r.ownerIsOnline),h(),_("ngIf",r.isAltitudeIndicate&&r.math.abs(r.gameTableMaskAltitude)>=.5))},dependencies:[Fi,nr,ni,Zo,Dh,mm,gs,fr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-scratching[_ngcontent-%COMP%]{cursor:pointer}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px}.lock-icon[_ngcontent-%COMP%]{visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%], .scratching[_ngcontent-%COMP%], .draw-icon[_ngcontent-%COMP%]{visibility:visible}.component[_ngcontent-%COMP%]:hover   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .scratching.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:hover   .draw-icon.is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .draw-icon.is-mine[_ngcontent-%COMP%]{visibility:hidden}.is-center[_ngcontent-%COMP%]{position:absolute;inset:0;margin:auto}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-border[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{outline:2px solid #CCC!important;outline-offset:-2px}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}.scratching-area[_ngcontent-%COMP%]{overflow:hidden}.name-tag[_ngcontent-%COMP%]{font-size:15px;padding:3px 9px;border-radius:24px;pointer-events:none;display:inline-block}.component[_ngcontent-%COMP%]:hover   .is-mine[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .is-mine[_ngcontent-%COMP%]{visibility:hidden}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.name-tag[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:16px;display:inline-block;position:relative;vertical-align:text-bottom}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.edit-button[_ngcontent-%COMP%]{padding:0 4px;vertical-align:10%;margin:0 1px 0 0;pointer-events:auto}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;background-color:#80d4ff99;inset:0}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}"],data:{animation:[Vn("fadeInOut",[Xt("void => *",[jt("132ms ease-out",mn([Pe({opacity:0,offset:0}),Pe({opacity:1,offset:1})]))]),Xt("* => void",[jt("132ms ease-in",mn([Pe({opacity:1,offset:0}),Pe({opacity:0,offset:1})]))])]),Vn("rotateInOut",[Xt("scrached<=>restore",[jt("132ms ease-in-out",mn([Pe({transform:"rotateY(0deg)",offset:0}),Pe({transform:"rotateY(-90deg)",offset:1})]))])])]},changeDetection:0})}return t})();const dme=t=>({"is-grab":t}),hme=(t,n)=>({"upright-transform":t,fall:n}),yB=t=>({transform:t}),CB=t=>({"blinking-animation":t}),e_=t=>({"is-magnetic":t}),fme=(t,n,e)=>({"backface-visibility":t,transform:n,filter:e}),Kx=(t,n,e,i)=>({"blinking-animation":t,"no-shadow":n,"is-slope":e,"is-inverse-slope":i});function pme(t,n){if(1&t&&(Ne(0,"div",7),It(1,"safe")),2&t){const e=y(2);ke("background-image",St(1,3,"url("+e.floorImageUrl+")","style")),_("ngClass",Be(6,CB,!e.isLocked))}}function gme(t,n){if(1&t&&Ne(0,"div",8),2&t){const e=y(2);_("ngClass",Be(1,e_,e.isMagnetic))}}function mme(t,n){if(1&t&&(Me(0),L(1,pme,2,8,"div",5)(2,gme,1,3,"div",6),De()),2&t){const e=y();h(),_("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall)),h(),_("ngIf",e.isSelected&&e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}function _me(t,n){if(1&t&&Ne(0,"div",8),2&t){const e=y(2);_("ngClass",Be(1,e_,e.isMagnetic))}}function bme(t,n){if(1&t&&(Me(0),p(1,"div",9),It(2,"safe"),L(3,_me,1,3,"div",6),m(),De()),2&t){const e=y();h(),ke("background-image",St(2,5,"url("+e.floorImageUrl+")","style")),_("ngClass",Be(8,CB,!e.isLocked))("ngStyle",ma(10,fme,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")")),h(2),_("ngIf",e.isSelected)}}function vme(t,n){if(1&t&&Ne(0,"div",8),2&t){const e=y(4);_("ngClass",Be(1,e_,e.isMagnetic))}}function yme(t,n){if(1&t&&(p(0,"div",11),It(1,"safe"),L(2,vme,1,3,"div",6),m()),2&t){const e=y(3);ke("background-image",St(1,8,"url("+e.wallImageUrl+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),_("ngClass",yl(11,Kx,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT)),h(2),_("ngIf",e.isSelected)}}function Cme(t,n){if(1&t&&(Me(0),L(1,yme,3,16,"div",10),De()),2&t){const e=y(2);h(),_("ngIf",e.isVisibleWallTopBottom)}}function xme(t,n){if(1&t&&Ne(0,"div",8),2&t){const e=y(4);_("ngClass",Be(1,e_,e.isMagnetic))}}function wme(t,n){if(1&t&&(p(0,"div",13),It(1,"safe"),L(2,xme,1,3,"div",6),m()),2&t){const e=y(3);ke("background-image",St(1,8,"url("+e.wallImageUrl+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),_("ngClass",yl(11,Kx,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT)),h(2),_("ngIf",e.isSelected)}}function Eme(t,n){if(1&t&&(Me(0),L(1,wme,3,16,"div",12),De()),2&t){const e=y(2);h(),_("ngIf",e.isVisibleWallTopBottom)}}function Tme(t,n){if(1&t&&Ne(0,"div",8),2&t){const e=y(4);_("ngClass",Be(1,e_,e.isMagnetic))}}function Ime(t,n){if(1&t&&(p(0,"div",15),It(1,"safe"),L(2,Tme,1,3,"div",6),m()),2&t){const e=y(3);ke("background-image",St(1,8,"url("+e.wallImageUrl+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),_("ngClass",yl(11,Kx,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP)),h(2),_("ngIf",e.isSelected)}}function Sme(t,n){if(1&t&&(Me(0),L(1,Ime,3,16,"div",14),De()),2&t){const e=y(2);h(),_("ngIf",e.isVisibleWallLeftRight)}}function Mme(t,n){if(1&t&&Ne(0,"div",8),2&t){const e=y(4);_("ngClass",Be(1,e_,e.isMagnetic))}}function Dme(t,n){if(1&t&&(p(0,"div",17),It(1,"safe"),L(2,Mme,1,3,"div",6),m()),2&t){const e=y(3);ke("background-image",St(1,8,"url("+e.wallImageUrl+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),_("ngClass",yl(11,Kx,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP)),h(2),_("ngIf",e.isSelected)}}function Ome(t,n){if(1&t&&(Me(0),L(1,Dme,3,16,"div",16),De()),2&t){const e=y(2);h(),_("ngIf",e.isVisibleWallLeftRight)}}function Ame(t,n){if(1&t&&(Me(0),L(1,Cme,2,1,"ng-container",2)(2,Eme,2,1,"ng-container",2)(3,Sme,2,1,"ng-container",2)(4,Ome,2,1,"ng-container",2),De()),2&t){const e=y();h(),_("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),h(),_("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),h(),_("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),h(),_("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function kme(t,n){if(1&t&&(Me(0),p(1,"div",18),Ne(2,"div",19),p(3,"div",20)(4,"i",21),x(5,"autorenew"),m()(),p(6,"div",22)(7,"i",21),x(8,"autorenew"),m()(),p(9,"div",23)(10,"i",21),x(11,"autorenew"),m()(),p(12,"div",24)(13,"i",21),x(14,"autorenew"),m()()(),De()),2&t){const e=y();h(),ke("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}function Pme(t,n){if(1&t&&(p(0,"div",25)(1,"div",26),x(2),m(),p(3,"div",27),x(4),m()()),2&t){const e=y();ke("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),_("ngStyle",Be(5,yB,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(2),Re(e.math.abs(e.terreinAltitude)),h(2),Re(e.math.abs(e.terreinAltitude))}}let Fme=(()=>{class t{get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return ji.clampMin(this.terrain.height)}get width(){return ji.clampMin(this.terrain.width)}get depth(){return ji.clampMin(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=Dr.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===Dr.NONE?Dr.BOTTOM:this.terrain.slopeDirection:Dr.NONE}set slopeDirection(e){this.terrain.isSlope=e!=Dr.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get selectionState(){return this.selectionService.state(this.terrain)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}_tmpUrl(e){const i=[this.floorImage,this.wallImage];let r="";return(this._tmpImages[e]?.identifier!=i[e].identifier||this._tmpImageState[e]!=i[e].state)&&(this._tmpImages[e]=i[e],this._tmpImages[e].state===Di.THUMBNAIL||this._tmpImages[e].state===Di.COMPLETE?(this._tmpImageState[e]=this._tmpImages[e].state,this._tmpImageUrls[e]&&(r=this._tmpImageUrls[e]),this._tmpImageUrls[e]=URL.createObjectURL(this._tmpImages[e].blob)):this._tmpImageUrls[e]=this._tmpImages[e].url),r&&queueMicrotask(()=>URL.revokeObjectURL(r)),this._tmpImageUrls[e]}get wallImageUrl(){return this._tmpUrl(1)}get floorImageUrl(){return this._tmpUrl(0)}constructor(e,i,r,o,s,a,l,u,f,g,v){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=o,this.elementRef=s,this.panelService=a,this.changeDetector=l,this.selectionService=u,this.pointerDeviceService=f,this.modalService=g,this.coordinateService=v,this.terrain=null,this.is3D=!1,this.gridSize=50,this._tmpImages=[],this._tmpImageUrls=["",""],this._tmpImageState=[0,0],this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=Dr,this.input=null,this.viewRotateZ=10}ngOnChanges(){U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${this.terrain?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new bu(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),U.unregister(this);for(const e of this._tmpImageUrls)e&&URL.revokeObjectURL(e)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&U.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}onMove(){this.contextMenuService.close(),ze.play(pe.blockPick)}onMoved(){ze.play(pe.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case Dr.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case Dr.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case Dr.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case Dr.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case Dr.TOP:e=.4;break;case Dr.BOTTOM:e=1;break;case Dr.LEFT:e=.6;break;case Dr.RIGHT:e=.9}return e}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i=this.coordinateService.calcTabletopLocalCoordinate();if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(o=>o.aliasName===this.terrain.aliasName);e.push({name:"\u9078\u629e\u3057\u305f\u5730\u5f62",action:null,subActions:[{name:"\u3059\u3079\u3066\u56fa\u5b9a\u3059\u308b",action:()=>{r().forEach(o=>o.isLocked=!0),ze.play(pe.lock)}},{name:"\u3059\u3079\u3066\u306e\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{r().forEach(o=>{let s=o.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,o.parent&&o.parent.appendChild(s)}),ze.play(pe.blockPut)}}]})}return e.push(At),e}makeContextMenu(){let e=this.coordinateService.calcTabletopLocalCoordinate();return[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ze.play(pe.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ze.play(pe.lock)},checkBox:"check"},this.isLocked?null:{name:"\u91cd\u306a\u308a\u9806 "+(0===this.height?"":" (\u5e73\u9762\u5730\u5f62\u306e\u307f)"),action:null,subActions:[{name:"\u5e73\u9762\u5730\u5f62\u306e\u4e00\u756a\u4e0a\u306b",action:()=>{if(!this.isLocked){const r=this.terrain.parent;r&&r.appendChild(this.terrain)}},disabled:this.isLocked},{name:"\u5e73\u9762\u5730\u5f62\u306e\u4e00\u756a\u4e0b\u306b",action:()=>{if(!this.isLocked){const r=this.terrain.parent;r&&r.prependChild(this.terrain)}},disabled:this.isLocked}],disabled:this.isLocked||0!=this.height},At,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==Dr.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=Dr.NONE},checkBox:"radio"},At,{name:(this.slopeDirection==Dr.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=Dr.TOP},checkBox:"radio"},{name:(this.slopeDirection==Dr.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=Dr.BOTTOM},checkBox:"radio"},{name:(this.slopeDirection==Dr.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=Dr.LEFT},checkBox:"radio"},{name:(this.slopeDirection==Dr.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=Dr.RIGHT},checkBox:"radio"}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=Ep.ALL,this.isSurfaceShading=!0},checkBox:"radio"},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=Ep.ALL,this.isSurfaceShading=!1},checkBox:"radio"},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=Ep.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)},checkBox:"radio"}]},At,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1},checkBox:"check"}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0},checkBox:"check"},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,ze.play(pe.sweep))},altitudeHande:this.terrain},At,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(r=>{const o=r.value.toString();return{name:r.name?r.name:o,action:()=>{_e.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(xa,{url:o,title:this.terrain.name,subTitle:r.name})},disabled:!_e.validUrl(o),error:_e.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(o)&&!_e.sameOrigin(o)}})},this.terrain.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.terrain.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(r),ze.play(pe.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),ze.play(pe.sweep)}},At,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(e)}]}showDetail(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Gm),F(Zx),F(Xo),F(_r),F(bi),F(io),F(sc),F(hr),F(Ii),F(Kh))};static#t=this.\u0275cmp=xn({type:t,selectors:[["terrain"]],hostBindings:function(i,r){1&i&&X("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{terrain:"terrain",is3D:"is3D"},features:[mr],decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option","movable.disable","movable.interact"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","ngClass","rotable.option","rotable.disable"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture chrome-smooth-image-trick",3,"ngClass","background-image",4,"ngIf"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"is-3d","texture","chrome-smooth-image-trick",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"selected-highlight",3,"ngClass"],[1,"is-3d","texture","chrome-smooth-image-trick",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top chrome-smooth-image-trick","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top","chrome-smooth-image-trick",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom chrome-smooth-image-trick","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom","chrome-smooth-image-trick",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left chrome-smooth-image-trick","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left","chrome-smooth-image-trick",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right chrome-smooth-image-trick","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right","chrome-smooth-image-trick",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(i,r){1&i&&(p(0,"div",0),X("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1),X("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),L(2,mme,3,2,"ng-container",2),p(3,"div",3),L(4,bme,4,14,"ng-container",2)(5,Ame,5,4,"ng-container",2),m(),L(6,kme,15,4,"ng-container",2),m(),L(7,Pme,5,7,"div",4),m()),2&i&&(ke("width",r.width*r.gridSize,"px")("height",r.depth*r.gridSize,"px"),_("movable.option",r.movableOption)("movable.disable",r.isLocked)("movable.interact",r.isInteract),h(),_("ngClass",Be(17,dme,!r.isLocked))("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),_("ngIf",r.hasFloor&&r.isVisibleFloor&&0<r.floorImageUrl.length),h(),_("ngClass",Cn(19,hme,r.height<.5&&0==r.altitude,r.height>=.5&&0==r.altitude))("ngStyle",Be(22,yB,"translateZ("+r.altitude*r.gridSize+"px)")),h(),_("ngIf",r.hasFloor&&r.isVisibleFloor&&0<r.floorImageUrl.length),h(),_("ngIf",r.isWallExist),h(),_("ngIf",!r.isLocked),h(),_("ngIf",r.isAltitudeIndicate&&!((r.isSlope||r.isWallExist)&&-r.height<r.altitude&&r.altitude<0)&&(r.terreinAltitude<=-.5||.5<=r.terreinAltitude)))},dependencies:[Fi,ni,Zo,gs,Dp,fr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0;left:0;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0;left:0;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0;left:0;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0;right:0;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.selected-highlight[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.pedestal-grab[_ngcontent-%COMP%]{position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_blink 1s linear infinite alternate}@keyframes _ngcontent-%COMP%_blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0})}return t})();const Nme=["cursor"],Rme=["rotate"],Lme=["opacity"],Bme=()=>["is-front","is-back"];function Ume(t,n){if(1&t&&(p(0,"div",8,2)(2,"div",9),It(3,"safe"),p(4,"div",10)(5,"span",11),x(6),m()()()()),2&t){const e=n.$implicit,i=y(2);ke("background-image","radial-gradient(circle, transparent 17px, "+i.color+" 18px), radial-gradient(circle, transparent 16px, rgba(240, 218, 189) 17px)"),_("ngClass",e),h(2),ke("background-image",St(3,8,"url("+i.iconUrl+")","style")),h(2),ke("background-color",i.color),h(2),Re(i.name)}}function Hme(t,n){1&t&&(Me(0),p(1,"div",4,0)(3,"div",5,1)(5,"div",6),L(6,Ume,7,11,"div",7),m()()(),De()),2&t&&(h(6),_("ngForOf",ad(1,Bme)))}class zc{get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}static#e=this.viewRotateX=50;static#t=this.viewRotateZ=10;get rotateZ(){return zc.viewRotateZ}get nameTagRotate(){let n=zc.viewRotateX%360-90;return-(n>0?n:360+n)}get delayMs(){let n=16.6*(xt.peerIds.length+1);return n<100?100:n}constructor(n,e,i,r){this.changeDetector=n,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=Ce.myCursor,this.cursorElement=null,this.opacityElements=[],this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=o=>this.onMouseMove(o),this._x=0,this._y=0}static#n=this.ctor=(()=>{U.register(zc).on("TABLE_VIEW_ROTATE",-1e3,n=>{zc.viewRotateX=n.data.x,zc.viewRotateZ=n.data.z})})();ngOnInit(){this.isMine||U.register(this).on("CURSOR_MOVE",n=>{n.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(n.data[0],n.data[1],n.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,n=>{this.ngZone.run(()=>{zc.viewRotateX=n.data.x,zc.viewRotateZ=n.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElements=this.opacityElementRefs.map(n=>n.nativeElement),this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.rotateElement&&this.setRotate(),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),U.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(n){let e=n.touches?n.changedTouches[0].pageX:n.pageX,i=n.touches?n.changedTouches[0].pageY:n.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=n.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(n,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:n,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),U.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElements.forEach(n=>{n.style.opacity="0.9"}),null==this.fadeOutTimer&&(this.fadeOutTimer=new _d.b(()=>{this.opacityElements.forEach(n=>{n.style.opacity="0.0"})},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(n,e,i){this.cursorElement.style.transform=`translateX(${n.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}static#i=this.\u0275fac=function(e){return new(e||zc)(F(io),F(Nx),F(Kh),F(Sn))};static#r=this.\u0275cmp=xn({type:zc,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(e,i){if(1&e&&(Dn(Nme,5),Dn(Rme,5),Dn(Lme,5)),2&e){let r;On(r=An())&&(i.cursorElementRef=r.first),On(r=An())&&(i.rotateElementRef=r.first),On(r=An())&&(i.opacityElementRefs=r)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[["cursor",""],["rotate",""],["opacity",""],[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],[1,"is-3d"],[1,"upright-transform","is-3d"],["class","peer-cursor is-3d is-opacity-transition",3,"ngClass","background-image",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d","is-opacity-transition",3,"ngClass"],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(e,i){1&e&&L(0,Hme,7,2,"ng-container",3),2&e&&_("ngIf",!i.isMine)},dependencies:[Fi,nr,ni,fr],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear}.is-opacity-transition[_ngcontent-%COMP%]{transition:opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg)}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;transform-origin:100% 100%;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:transparent;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]})}const zme=["textArea"],xB=t=>({"is-grab":t}),Vme=(t,n)=>({fall:t,softy:n}),Qx=t=>({transform:t}),jme=t=>({"is-bg-filter":t}),Gme=(t,n,e)=>({"is-pointer-events-none":t,"is-pointer-events-auto":n,"hide-area":e}),Wme=t=>({"hide-area":t}),Jx=t=>({"is-inverse":t}),wB=t=>({"is-magnetic":t}),$me=t=>({transform:t});function Yme(t,n){if(1&t&&(p(0,"div",22),x(1),m()),2&t){const e=y();h(),Re(e.title)}}function qme(t,n){if(1&t&&Ne(0,"div",23),2&t){const e=y();_("ngClass",Be(1,wB,e.isMagnetic))}}function Zme(t,n){if(1&t&&Ne(0,"div",23),2&t){const e=y();_("ngClass",Be(1,wB,e.isMagnetic))}}function Xme(t,n){if(1&t&&(p(0,"div",22),x(1),m()),2&t){const e=y();h(),Re(e.title)}}function Kme(t,n){if(1&t&&Ne(0,"div",24),2&t){const e=y();ke("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),_("ngClass",Be(6,xB,!e.isLocked))("ngStyle",Be(8,Qx,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function Qme(t,n){if(1&t&&(p(0,"div")(1,"div",17)(2,"i",18),x(3,"autorenew"),m()(),p(4,"div",19)(5,"i",18),x(6,"autorenew"),m()()()),2&t){const e=y();h(2),_("ngClass",Be(2,Jx,e.isInverse)),h(3),_("ngClass",Be(4,Jx,e.isInverse))}}function Jme(t,n){if(1&t&&(p(0,"div",25)(1,"div",26)(2,"span",27),x(3),m(),p(4,"span",28),x(5),m()()()),2&t){const e=y();ke("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),_("ngStyle",Be(5,$me,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(3),Re(e.math.abs(e.textNoteAltitude)),h(2),Re(e.textNoteAltitude)}}let e_e=(()=>{class t{get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get color(){return this.textNote.color}set color(e){this.textNote.color=e}get textShadowCss(){const e=_e.textShadowColor(this.color,"#f2f2f2","#000000");return`${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px, \n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px,\n    ${e} 0px 0px 0.5px`}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return ji.clampMin(this.textNote.height)}get width(){return ji.clampMin(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isShowTitle(){return this.textNote.isShowTitle}set isShowTitle(e){this.textNote.isShowTitle=e}get isWhiteOut(){return this.textNote.isWhiteOut}set isWhiteOut(e){this.textNote.isWhiteOut=e}get isEditorSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get isActive(){return document.activeElement===this.textAreaElementRef.nativeElement}get selectionState(){return this.selectionService.state(this.textNote)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get rubiedText(){return _e.rubyToHtml(_e.escapeHtml(this.text))}constructor(e,i,r,o,s,a,l,u){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=o,this.changeDetector=s,this.pointerDeviceService=a,this.modalService=l,this.selectionService=u,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=f=>this.onMouseUp(f),this.gridSize=50,this.math=Math,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnChanges(){U.unregister(this),U.register(this).on(`UPDATE_GAME_OBJECT/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_SELECTION/identifier/${this.textNote?.identifier}`,e=>{this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new bu(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){U.unregister(this),this.input.destroy()}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&U.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e})}onMouseDown(e){if(!this.isActive&&!this.isLocked){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void U.trigger("DRAG_LOCKED_OBJECT",{srcEvent:e});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){if(this.removeMouseEventListeners(),this.isActive||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.title)}onMove(){this.contextMenuService.close(),ze.play(pe.cardPick)}onMoved(){ze.play(pe.cardPut)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.textNote.location.x,y:this.textNote.location.y,z:this.textNote.posZ};return e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),e.push(At),e}makeContextMenu(){return[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ze.play(pe.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ze.play(pe.lock)},checkBox:"check"},At,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.isUpright=!1},checkBox:"check"}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.isUpright=!0},checkBox:"check"},this.isShowTitle?{name:"\u2611 \u30bf\u30a4\u30c8\u30eb\u30d0\u30fc\u306e\u8868\u793a",action:()=>{this.isShowTitle=!1},checkBox:"check"}:{name:"\u2610 \u30bf\u30a4\u30c8\u30eb\u30d0\u30fc\u306e\u8868\u793a",action:()=>{this.isShowTitle=!0},checkBox:"check"},this.isWhiteOut?{name:"\u2611 \u80cc\u666f\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!1},checkBox:"check"}:{name:"\u2610 \u80cc\u666f\u306e\u8272\u629c\u304d",action:()=>{this.isWhiteOut=!0},checkBox:"check"},At,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,ze.play(pe.sweep))},altitudeHande:this.textNote},At,{name:"\u30e1\u30e2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{_e.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(xa,{url:r,title:this.textNote.title,subTitle:i.name})},disabled:!_e.validUrl(r),error:_e.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(r)&&!_e.sameOrigin(r)}})},this.textNote.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.textNote.clone();i.isLocked=!1,i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.toTopmost(),ze.play(pe.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),ze.play(pe.sweep)}}]}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(lc,{title:r,left:i.x-350,top:i.y-200,width:560,height:470}).tabletopObject=e}activate(){this.isLocked||this.textAreaElementRef.nativeElement.focus()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Xo),F(_r),F(bi),F(io),F(hr),F(Ii),F(sc))};static#t=this.\u0275cmp=xn({type:t,selectors:[["text-note"]],viewQuery:function(i,r){if(1&i&&Dn(zme,7),2&i){let o;On(o=An())&&(r.textAreaElementRef=o.first)}},hostBindings:function(i,r){1&i&&X("dragstart",function(s){return r.onDragstart(s)})("mousedown",function(s){return r.onMouseDown(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{textNote:"textNote",is3D:"is3D"},features:[mr],decls:31,vars:88,consts:[["textArea",""],["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],["appRotable","",1,"is-3d",3,"rotable.ondragstart","rotable.ondragend","rotable.option","rotable.disable"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"is-3d","is-transition",3,"ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture","chrome-smooth-image-trick",3,"ngClass"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"input","ngModelChange","ngClass","ngModel"],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"click","ngClass","innerHTML"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture","chrome-smooth-image-trick"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModelChange","ngModel"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"selected-highlight",3,"ngClass"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",1),X("movable.ondragstart",function(){return O(o),D(r.onMove())})("movable.ondragend",function(){return O(o),D(r.onMoved())}),p(1,"div",2),X("rotable.ondragstart",function(){return O(o),D(r.onMove())})("rotable.ondragend",function(){return O(o),D(r.onMoved())}),p(2,"div",3)(3,"div",4)(4,"div",5)(5,"div",6),It(6,"safe"),L(7,Yme,2,1,"div",7),p(8,"textarea",8,0),X("input",function(){return O(o),D(r.calcFitHeight())}),$e("ngModelChange",function(a){return O(o),Ge(r.text,a)||(r.text=a),D(a)}),m(),p(10,"div",9),It(11,"safe"),X("click",function(){return O(o),D(r.activate())}),m(),L(12,qme,1,3,"div",10),m(),p(13,"div",11),It(14,"safe"),L(15,Zme,1,3,"div",10),p(16,"div",12),L(17,Xme,2,1,"div",7),p(18,"textarea",13),$e("ngModelChange",function(a){return O(o),Ge(r.text,a)||(r.text=a),D(a)}),m(),Ne(19,"div",14),It(20,"safe"),m()()()(),L(21,Kme,1,10,"div",15),p(22,"div",16)(23,"div",17)(24,"i",18),x(25),m()(),p(26,"div",19)(27,"i",18),x(28),m()()(),L(29,Qme,7,6,"div",20),m()(),L(30,Jme,6,7,"div",21),m()}2&i&&(_("ngClass",Be(65,xB,!r.isLocked))("movable.option",r.movableOption)("movable.disable",r.isEditorSelected||r.isLocked),h(),_("rotable.option",r.rotableOption)("rotable.disable",r.isLocked),h(),ke("width",r.width*r.gridSize,"px"),h(),_("ngClass",Cn(67,Vme,0==r.altitude,!r.isUpright))("ngStyle",Be(70,Qx,"translateZ("+r.altitude*r.gridSize+"px) rotateY(90deg)")),h(),_("ngStyle",Be(72,Qx,"rotateZ("+(r.isUpright?0:90)+"deg) rotateY(-90deg)")),h(),ke("background-image",St(6,53,"url("+(null==r.imageFile?null:r.imageFile.url)+")","style"))("width",r.width*r.gridSize,"px")("min-height",r.height*r.gridSize,"px"),_("ngClass",Be(74,jme,r.isWhiteOut)),h(2),_("ngIf",r.isShowTitle&&r.title.length),h(),ke("font-size",r.fontSize+9,"px"),_("ngClass",ma(76,Gme,!r.isEditorSelected,r.isEditorSelected,!r.isEditorSelected)),We("ngModel",r.text),h(2),ke("font-size",r.fontSize+9,"px")("color",r.color)("text-shadow",r.textShadowCss),_("ngClass",Be(80,Wme,r.isEditorSelected))("innerHTML",St(11,56,r.lastNewLineAdjust(r.rubiedText),"html"),eo),h(2),_("ngIf",r.isSelected),h(),ke("background-image",St(14,59,"url("+(null==r.imageFile?null:r.imageFile.url)+")","style"))("width",r.width*r.gridSize,"px")("min-height",r.height*r.gridSize,"px"),h(2),_("ngIf",r.isSelected),h(2),_("ngIf",r.isShowTitle&&r.title.length),h(),ke("font-size",r.fontSize+9,"px"),We("ngModel",r.text),h(),ke("font-size",r.fontSize+9,"px"),_("innerHTML",St(20,62,r.lastNewLineAdjust(r.rubiedText),"html"),eo),h(2),_("ngIf",!r.isLocked),h(),_("ngStyle",Be(82,Qx,"translateZ("+r.altitude*r.gridSize+"px)")),h(2),_("ngClass",Be(84,Jx,r.isInverse)),h(),Re(r.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(86,Jx,r.isInverse)),h(),Re(r.isLocked?"lock":"autorenew"),h(),_("ngIf",!r.isLocked),h(),_("ngIf",r.isAltitudeIndicate&&r.math.abs(r.textNoteAltitude)>=.5))},dependencies:[Fi,ni,Zo,Rr,Lr,Tr,gs,Dp,fr],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-filter[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background:#ffffffb3;transition:background-color .2s}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:#ffffffbf}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;box-sizing:border-box;height:100%;width:100%;top:0;left:0;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.fall.softy[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}'],changeDetection:0})}return t})();const t_e=t=>({"is-gray-border":t}),n_e=t=>({transform:t}),i_e=t=>({"is-magnetic":t}),r_e=(t,n)=>({"background-color":t,transform:n}),EB=(t,n)=>({"is-black-mask":t,"is-harf-black-mask":n});function o_e(t,n){1&t&&(Me(0),p(1,"div",21)(2,"div",22)(3,"div",23),x(4,"autorenew"),m(),p(5,"div",24),x(6,"autorenew"),m()()(),De())}function s_e(t,n){if(1&t&&Ne(0,"div",25),2&t){const e=y();_("ngClass",Be(1,i_e,e.isMagnetic))}}function a_e(t,n){1&t&&(p(0,"i",26),x(1,"lock"),m())}function l_e(t,n){1&t&&(p(0,"span"),x(1,"\uff1a"),m())}function c_e(t,n){if(1&t&&(p(0,"span"),x(1),m()),2&t){const e=y();h(),Re(e.face)}}function u_e(t,n){1&t&&(p(0,"span"),x(1,"???"),m())}function d_e(t,n){1&t&&(p(0,"i",26),x(1,"lock"),m())}function h_e(t,n){1&t&&(p(0,"span"),x(1,"\uff1a"),m())}function f_e(t,n){if(1&t&&(p(0,"span"),x(1),m()),2&t){const e=y();h(),Re(e.face)}}function p_e(t,n){1&t&&(p(0,"span"),x(1,"???"),m())}function g_e(t,n){if(1&t&&(p(0,"div",27)(1,"div",28)(2,"b"),x(3),m()(),p(4,"div",29)(5,"b"),x(6),m()()()),2&t){const e=y();_("ngStyle",Cn(3,r_e,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),h(3),Re(e.ownerName),h(3),Re(e.ownerName)}}function m_e(t,n){if(1&t&&(Ne(0,"img",30),It(1,"safe")),2&t){const e=y();_("src",St(1,2,e.imageFile.url,"resourceUrl"),gn)("ngClass",Cn(5,EB,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function __e(t,n){if(1&t&&(Ne(0,"img",31),It(1,"safe")),2&t){const e=y();_("src",St(1,2,e.backFaceImageFile.url,"resourceUrl"),gn)("ngClass",Cn(5,EB,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function b_e(t,n){1&t&&(Ne(0,"img",32),It(1,"safe")),2&t&&_("src",St(1,1,y().imageFile.url,"resourceUrl"),gn)}function v_e(t,n){if(1&t&&(Ne(0,"img",32),It(1,"safe")),2&t){const e=y();ke("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),_("src",St(1,3,e.backFaceImageFile.url,"resourceUrl"),gn)}}let y_e=(()=>{class t{get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return ji.clampMin(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get selectionState(){return this.selectionService.state(this.diceSymbol)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}constructor(e,i,r,o,s,a,l,u,f,g){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=o,this.changeDetector=s,this.pointerDeviceService=a,this.selectionService=l,this.imageService=u,this.modalService=f,this.chatMessageService=g,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.interactGesture=null,this.viewRotateX=50,this.viewRotateZ=10}ngOnChanges(){U.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on(`UPDATE_GAME_OBJECT/aliasName/${Ce.aliasName}`,e=>{let i=dt.instance.get(e.data.identifier);this.diceSymbol&&i&&i.userId===this.diceSymbol.owner&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",ze.play(pe.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on(`UPDATE_GAME_OBJECT/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on(`UPDATE_OBJECT_CHILDREN/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.diceSymbol?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=Ce.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.interactGesture=new B3(this.elementRef.nativeElement)}),this.interactGesture.onstart=this.onInputStart.bind(this),this.interactGesture.oninteract=this.onDoubleClick.bind(this)}ngOnDestroy(){this.interactGesture.destroy(),U.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.ngZone.run(()=>this.startIconHiddenTimer())}onDoubleClick(){this.isVisible&&this.ngZone.run(()=>this.diceRoll())}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];r=r.concat(this.makeSelectionContextMenu()),r=r.concat(this.makeContextMenu()),this.contextMenuService.open(i,r,this.name)}makeSelectionContextMenu(){if(this.selectionService.objects.length<1)return[];let e=[],i={x:this.diceSymbol.location.x+this.diceSymbol.size*this.gridSize/2,y:this.diceSymbol.location.y+this.diceSymbol.size*this.gridSize/2,z:this.diceSymbol.posZ};if(e.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(i)}),this.isSelected){let r=()=>this.selectionService.objects.filter(a=>a.aliasName===this.diceSymbol.aliasName);const o=r().some(a=>a.isCoin),s=r().some(a=>!a.isCoin);e.push({name:`\u9078\u629e\u3057\u305f${o?"\u30b3\u30a4\u30f3":""}${o&&s?"\uff0f":""}${s?"\u30c0\u30a4\u30b9":""}`,action:null,subActions:[{name:`\u3059\u3079\u3066${o?"\u30c8\u30b9":""}${o&&s?"\uff0f":""}${s?"\u632f\u308b":""}`,action:()=>{let a=!1,l=!1,u=!1;const f=[];r().forEach(g=>{if(g.isVisible){a=!0,l=l||g.isCoin,u=u||!g.isCoin,U.call("ROLL_DICE_SYMBOL",{identifier:g.identifier});let v=g.diceRoll(),C=`${""==g.name?"(\u7121\u540d\u306e"+(g.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":g.name} \u3092${g.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;""===g.owner&&(C+=` \u2192 ${v}`),f.push(C)}}),f.length&&this.chatMessageService.sendOperationLog(f.join("\u3001")),a&&(l&&ze.play(pe.coinToss),u&&ze.play(pe.diceRoll1))}},{name:"\u3059\u3079\u3066\u516c\u958b",action:()=>{const a=[];r().forEach(l=>{""!=l.owner&&a.push(`${""==l.name?"(\u7121\u540d\u306e"+(l.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":l.name} \u306e${l.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${l.face}`),l.owner=""}),a.length&&this.chatMessageService.sendOperationLog(a.join("\u3001")),ze.play(pe.unlock)},disabled:!r().some(a=>""!=a.owner)},{name:"\u3059\u3079\u3066\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{const a=[];r().forEach(l=>{l.owner!=xt.peer.userId&&a.push(""==l.name?"(\u7121\u540d\u306e"+(l.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":l.name),l.owner=xt.peer.userId}),a.length&&this.chatMessageService.sendOperationLog(a.join("\u3001")+" \u3092\u81ea\u5206\u3060\u3051\u898b\u305f"),ze.play(pe.lock)},disabled:!r().some(a=>a.owner!=xt.peer.userId)}]})}return e.push(At),e}makeContextMenu(){let e=[];if(e.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),e.push(At),(this.isMine||this.hasOwner)&&e.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",ze.play(pe.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||e.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=xt.peer.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),ze.play(pe.lock)}}),e.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,ze.play(pe.unlock)},disabled:this.hasOwner&&!this.isVisible,checkBox:"check"}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,ze.play(pe.lock)},disabled:this.hasOwner&&!this.isVisible,checkBox:"check"}),this.isVisible){let i=[],r=this.nothingFaces;r.length>0&&(r.forEach(o=>{i.push({name:`${this.face==o?"\u25c9":"\u25cb"} ${o}\u3000`,action:()=>{ze.play(pe.dicePut),this.face=o},checkBox:"radio"})}),i.push(At)),this.faces.forEach(o=>{i.push({name:`${this.face==o?"\u25c9":"\u25cb"} ${o}\u3000`,action:()=>{""===this.owner&&ze.play(pe.dicePut),""===this.owner&&this.face!=o&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${o}`),this.face=o},checkBox:"radio"})}),e.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:i})}return e.push(At),e.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1},checkBox:"check"}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0},checkBox:"check"}),e.push(At),e.push({name:"\u8a73\u7d30\u3092\u8868\u793a...",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(e.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(i=>{const r=i.value.toString();return{name:i.name?i.name:r,action:()=>{_e.sameOrigin(r)?window.open(r.trim(),"_blank","noopener"):this.modalService.open(xa,{url:r,title:this.diceSymbol.name,subTitle:i.name})},disabled:!_e.validUrl(r),error:_e.validUrl(r)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(r)&&!_e.sameOrigin(r)}})}),e.push(At)),e.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let i=this.diceSymbol.clone();i.location.x+=this.gridSize,i.location.y+=this.gridSize,i.update(),ze.play(pe.dicePut)}}),e.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),ze.play(pe.sweep)}}),e}onMove(){this.contextMenuService.close(),ze.play(pe.dicePick)}onMoved(){ze.play(pe.dicePut)}diceRoll(){U.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),ze.play(this.isCoin?pe.coinToss:pe.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){U.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(bi),F(Xo),F(_r),F(io),F(hr),F(sc),F(Gm),F(Ii),F(Do))};static#t=this.\u0275cmp=xn({type:t,selectors:[["dice-symbol"]],hostBindings:function(i,r){1&i&&X("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},features:[mr],decls:32,vars:49,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.ondragstart","movable.ondragend","movable.option"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.ondragstart","rotable.ondragend","rotable.option"],[4,"ngIf"],[1,"pedestal-inner",3,"ngClass"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"pedestal-outer"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"selected-highlight",3,"ngClass"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(i,r){1&i&&(p(0,"div",0),X("movable.ondragstart",function(){return r.onMove()})("movable.ondragend",function(){return r.onMoved()}),p(1,"div",1)(2,"div",2),X("rotable.ondragstart",function(){return r.onMove()})("rotable.ondragend",function(){return r.onMoved()}),L(3,o_e,7,0,"ng-container",3),Ne(4,"div",4),L(5,s_e,1,3,"div",5),Ne(6,"div",6),p(7,"div",1)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10)(12,"div",11),X("@diceRollNameTag.done",function(s){return r.animationShuffleDone(s)}),p(13,"div",12),L(14,a_e,2,0,"i",13),x(15),L(16,l_e,2,0,"span",3)(17,c_e,2,1,"span",3)(18,u_e,2,0,"span",3),m(),p(19,"div",14),L(20,d_e,2,0,"i",13),x(21),L(22,h_e,2,0,"span",3)(23,f_e,2,1,"span",3)(24,p_e,2,0,"span",3),m()()(),L(25,g_e,7,6,"div",15),p(26,"div",1),X("@diceRoll.done",function(s){return r.animationShuffleDone(s)})("@coinFlip.done",function(s){return r.animationShuffleDone(s)}),L(27,m_e,2,8,"img",16)(28,__e,2,8,"img",17),m()()()(),p(29,"div",18),X("@diceRoll.done",function(s){return r.animationShuffleDone(s)}),L(30,b_e,2,4,"img",19)(31,v_e,2,6,"img",20),m()()()()()),2&i&&(ke("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),_("movable.option",r.movableOption),h(),_("@bounceInOut","in"),h(),_("rotable.option",r.rotableOption),h(),_("ngIf",!r.isIconHidden),h(),_("ngClass",Be(45,t_e,r.hasOwner)),h(),_("ngIf",r.isSelected),h(4),ke("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),h(2),_("ngStyle",Be(47,n_e,"translateX("+r.size*r.gridSize/2+"px) rotateX("+r.nameTagRotate+"deg)")),h(),_("@changeFaceNameTag",r.isVisible?r.face:null)("@diceRollNameTag",r.animeState),h(2),_("ngIf",r.isLock&&r.hasOwner),h(),Re(r.name),h(),_("ngIf",0<r.name.length),h(),_("ngIf",r.isVisible),h(),_("ngIf",!r.isVisible),h(2),_("ngIf",r.isLock&&r.hasOwner),h(),Re(r.name),h(),_("ngIf",0<r.name.length),h(),_("ngIf",r.isVisible),h(),_("ngIf",!r.isVisible),h(),_("ngIf",r.hasOwner&&0<r.ownerName.length),h(),ke("transform",r.isCoin?"rotateX(30deg)":""),_("@changeFace",!r.isCoin&&r.isVisible?r.face:null)("@changeFaceCoin",r.isCoin&&r.isVisible?"\u88cf"==r.face?0:1:null)("@diceRoll",!r.isCoin&&r.animeState)("@coinFlip",r.isCoin&&r.animeState),h(),_("ngIf",0<r.imageFile.url.length),h(),_("ngIf",0<r.backFaceImageFile.url.length),h(),ke("width",r.size*r.gridSize,"px")("height",r.size*r.gridSize,"px"),_("@changeFace",!r.isCoin&&r.isVisible?r.face:null)("@changeFaceCoin",r.isCoin&&r.isVisible?"\u8868"==r.face?1:2:null)("@diceRoll",r.animeState),h(),_("ngIf",!r.isFlip&&r.isDropShadow&&0<r.imageFile.url.length),h(),_("ngIf",r.isFlip&&r.isDropShadow&&0<r.backFaceImageFile.url.length))},dependencies:[Fi,ni,Zo,gs,Dp,fr],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;backface-visibility:hidden}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.selected-highlight[_ngcontent-%COMP%]{pointer-events:none;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border-radius:5px;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .pedestal-outer[_ngcontent-%COMP%]{transform-style:preserve-3d;transform:translateZ(.01px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[Vn("diceRoll",[Xt("* => active",[jt("800ms ease",mn([Pe({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),Pe({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),Vn("coinFlip",[Xt("* => active",[jt("800ms ease-out",mn([Pe({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),Pe({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),Vn("diceRollNameTag",[Xt("* => active",[jt("800ms ease",mn([Pe({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),Pe({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),Pe({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),Pe({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),Pe({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),Vn("changeFace",[Xt(":increment,:decrement",[jt("200ms ease",mn([Pe({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),Pe({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),Vn("changeFaceCoin",[Xt(":increment,:decrement",[jt("200ms ease",mn([Pe({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),Pe({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),Vn("changeFaceNameTag",[Xt(":increment,:decrement",[jt("200ms ease",mn([Pe({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),Pe({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),Vn("bounceInOut",[Xt("void => *",[jt("600ms ease",mn([Pe({transform:"scale3d(0, 0, 0)",offset:0}),Pe({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),Pe({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),Pe({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),Pe({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Xt("* => void",[jt(100,Pe({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0})}return t})();class fv{constructor(n,e,i){this.canvasElement=n,this.canvasElementRange=e,this.canvasElementCenter=i}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}chkOuterProduct(n,e,i,r,o,s){return(i-n)*(s-e)-(r-e)*(o-n)>=-.01}chkInCircle(n,e,i){return n*n>=e*e+i*i}renderCircle(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let l=this.canvasElement.getContext("2d"),u=0,f=0,g=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(l,e,n.gridColor),l.beginPath(),l.arc(i,r,n.range*e,0,2*Math.PI,!0),l.fill();else{this.makeBrush(l,e,n.gridColor);for(let v=0;v<=n.areaHeight+1;v++)for(let C=0;C<=n.areaWidth+1;C++){let{gx:E,gy:w}=g(C,v,e);if(1==n.fillType)u=E+s+e/2-i,f=w+a+e/2-r,this.chkInCircle(n.range*e,u,f)&&this.fillSquare(l,E+s,w+a,e);else{let T=0;for(let M=0;M<e;M++)for(let S=0;S<e;S++)u=E+s+M-i+.5,f=w+a+S-r+.5,this.chkInCircle(n.range*e,u,f)&&T++;(2==n.fillType&&T>=1||3==n.fillType&&T>=e*e/2||4==n.fillType&&T>=e*e)&&this.fillSquare(l,E+s,w+a,e)}}}this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,l=this.canvasElementRange.getContext("2d"),this.makeBrush(l,e,n.rangeColor),l.beginPath(),l.lineWidth=2,l.arc(i,r,n.range*e,0,2*Math.PI,!0),l.stroke(),n.isDocking?(l.beginPath(),l.strokeRect(i-6,r-6,12,12)):(l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,l=this.canvasElementCenter.getContext("2d"),this.makeBrush(l,e,n.rangeColor),n.isDocking?(l.beginPath(),l.strokeRect(i-6,r-6,12,12)):(l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill())}renderLine(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let l=this.canvasElement.getContext("2d"),f=.5*n.width*e,v=-.5*n.width*e,C=n.range*e,E=-.5*n.width*e,w=n.range*e,T=.5*n.width*e,M=0-e*Math.sqrt(2),S=f+e*Math.sqrt(2),P=0-e*Math.sqrt(2),Z=v-e*Math.sqrt(2),ee=C+e*Math.sqrt(2),B=E-e*Math.sqrt(2),J=w+e*Math.sqrt(2),le=T+e*Math.sqrt(2),se=0*Math.cos(o)-f*Math.sin(o),fe=0*Math.sin(o)+f*Math.cos(o),Se=0*Math.cos(o)-v*Math.sin(o),ue=0*Math.sin(o)+v*Math.cos(o),Ue=C*Math.cos(o)-E*Math.sin(o),Ze=C*Math.sin(o)+E*Math.cos(o),nt=w*Math.cos(o)-T*Math.sin(o),be=w*Math.sin(o)+T*Math.cos(o),Ye={clip01x:M*Math.cos(o)-S*Math.sin(o),clip01y:M*Math.sin(o)+S*Math.cos(o),clip02x:P*Math.cos(o)-Z*Math.sin(o),clip02y:P*Math.sin(o)+Z*Math.cos(o),clip03x:ee*Math.cos(o)-B*Math.sin(o),clip03y:ee*Math.sin(o)+B*Math.cos(o),clip04x:J*Math.cos(o)-le*Math.sin(o),clip04y:J*Math.sin(o)+le*Math.cos(o)},Ke=0,tt=0,lt=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(l,e,n.gridColor),0==n.fillType)this.makeBrush(l,e,n.gridColor),l.beginPath(),l.moveTo(se+i,fe+r),l.lineTo(Se+i,ue+r),l.lineTo(Ue+i,Ze+r),l.lineTo(nt+i,be+r),l.lineTo(se+i,fe+r),l.fill();else{this.makeBrush(l,e,n.gridColor);for(let sn=0;sn<=n.areaHeight+1;sn++)for(let Ct=0;Ct<=n.areaWidth+1;Ct++){let{gx:Ft,gy:an}=lt(Ct,sn,e);if(1==n.fillType)Ke=Ft+s+e/2-i,tt=an+a+e/2-r,this.chkOuterProduct(se,fe,Se,ue,Ke,tt)&&this.chkOuterProduct(Se,ue,Ue,Ze,Ke,tt)&&this.chkOuterProduct(Ue,Ze,nt,be,Ke,tt)&&this.chkOuterProduct(nt,be,se,fe,Ke,tt)&&this.fillSquare(l,Ft+s,an+a,e);else{let Qe=0;for(let Yn=0;Yn<e;Yn++)for(let yn=0;yn<e;yn++)Ke=Ft+s+Yn-i+.5,tt=an+a+yn-r+.5,this.chkOuterProduct(se,fe,Se,ue,Ke,tt)&&this.chkOuterProduct(Se,ue,Ue,Ze,Ke,tt)&&this.chkOuterProduct(Ue,Ze,nt,be,Ke,tt)&&this.chkOuterProduct(nt,be,se,fe,Ke,tt)&&Qe++;(2==n.fillType&&Qe>=1||3==n.fillType&&Qe>=e*e/2||4==n.fillType&&Qe>=e*e)&&this.fillSquare(l,Ft+s,an+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,l=this.canvasElementRange.getContext("2d"),this.makeBrush(l,e,n.rangeColor),l.beginPath(),l.lineWidth=2,l.moveTo(se+i,fe+r),l.lineTo(Se+i,ue+r),l.lineTo(Ue+i,Ze+r),l.lineTo(nt+i,be+r),l.lineTo(se+i,fe+r),l.stroke(),l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,l=this.canvasElementCenter.getContext("2d"),this.makeBrush(l,e,n.rangeColor),l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill(),Ye}static gripAreaPathLine(n){let e=n.gridSize,i=Math.PI/180*n.degree,C=.5*n.width*e,w=-.5*n.width*e,T=n.range*e,M=-.5*n.width*e,S=n.range*e,P=.5*n.width*e;return{clip01x:0*Math.cos(i)-C*Math.sin(i),clip01y:0*Math.sin(i)+C*Math.cos(i),clip02x:0*Math.cos(i)-w*Math.sin(i),clip02y:0*Math.sin(i)+w*Math.cos(i),clip03x:T*Math.cos(i)-M*Math.sin(i),clip03y:T*Math.sin(i)+M*Math.cos(i),clip04x:S*Math.cos(i)-P*Math.sin(i),clip04y:S*Math.sin(i)+P*Math.cos(i)}}renderSquare(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,s=(Math,-n.centerX%e),a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let l=this.canvasElement.getContext("2d"),u=-n.range*e,f=n.range*e,g=-n.range*e,v=-n.range*e,C=n.range*e,E=-n.range*e,w=n.range*e,T=n.range*e,se={clip01x:u-1*e,clip01y:f+1*e,clip02x:g-1*e,clip02y:v-1*e,clip03x:C+1*e,clip03y:E-1*e,clip04x:w+1*e,clip04y:T+1*e},fe=0,Se=0,ue=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(l,e,n.gridColor),0==n.fillType)this.makeBrush(l,e,n.gridColor),l.beginPath(),l.moveTo(u+i,f+r),l.lineTo(g+i,v+r),l.lineTo(C+i,E+r),l.lineTo(w+i,T+r),l.lineTo(u+i,f+r),l.fill();else{this.makeBrush(l,e,n.gridColor);for(let Ue=0;Ue<=n.areaHeight+1;Ue++)for(let Ze=0;Ze<=n.areaWidth+1;Ze++){let{gx:nt,gy:be}=ue(Ze,Ue,e);if(1==n.fillType)fe=nt+s+e/2-i,Se=be+a+e/2-r,this.chkOuterProduct(u,f,g,v,fe,Se)&&this.chkOuterProduct(g,v,C,E,fe,Se)&&this.chkOuterProduct(C,E,w,T,fe,Se)&&this.chkOuterProduct(w,T,u,f,fe,Se)&&this.fillSquare(l,nt+s,be+a,e);else{let Ye=0;for(let Ke=0;Ke<e;Ke++)for(let tt=0;tt<e;tt++)fe=nt+s+Ke-i+.5,Se=be+a+tt-r+.5,this.chkOuterProduct(u,f,g,v,fe,Se)&&this.chkOuterProduct(g,v,C,E,fe,Se)&&this.chkOuterProduct(C,E,w,T,fe,Se)&&this.chkOuterProduct(w,T,u,f,fe,Se)&&Ye++;(2==n.fillType&&Ye>=1||3==n.fillType&&Ye>=e*e/2||4==n.fillType&&Ye>=e*e)&&this.fillSquare(l,nt+s,be+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,l=this.canvasElementRange.getContext("2d"),this.makeBrush(l,e,n.rangeColor),l.beginPath(),l.lineWidth=2,l.moveTo(u+i,f+r),l.lineTo(g+i,v+r),l.lineTo(C+i,E+r),l.lineTo(w+i,T+r),l.lineTo(u+i,f+r),l.stroke(),n.isDocking?(l.beginPath(),l.strokeRect(i-6,r-6,12,12)):(l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,l=this.canvasElementCenter.getContext("2d"),this.makeBrush(l,e,n.rangeColor),n.isDocking?(l.beginPath(),l.strokeRect(i-6,r-6,12,12)):(l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill()),se}static gripAreaPathSquare(n){let e=n.gridSize;return Math,{clip01x:-n.range*e,clip01y:n.range*e,clip02x:-n.range*e,clip02y:-n.range*e,clip03x:n.range*e,clip03y:-n.range*e,clip04x:n.range*e,clip04y:n.range*e}}renderDiamond(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=-n.centerX%e,s=-n.centerY%e;o>0&&(o-=e),s>0&&(s-=e),n.offSetX&&(o<-.5?o+=e/2:o-=e/2),n.offSetY&&(s<-.5?s+=e/2:s-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let a=this.canvasElement.getContext("2d"),l=-n.range*e,g=-n.range*e,v=n.range*e,w=n.range*e,le={clip01x:l-2*e,clip01y:0,clip02x:0,clip02y:g-2*e,clip03x:v+2*e,clip03y:0,clip04x:0,clip04y:w+2*e},se=0,fe=0,Se=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(this.makeBrush(a,e,n.gridColor),0==n.fillType)this.makeBrush(a,e,n.gridColor),a.beginPath(),a.moveTo(l+i,0+r),a.lineTo(0+i,g+r),a.lineTo(v+i,0+r),a.lineTo(0+i,w+r),a.lineTo(l+i,0+r),a.fill();else{this.makeBrush(a,e,n.gridColor);for(let ue=0;ue<=n.areaHeight+1;ue++)for(let Ue=0;Ue<=n.areaWidth+1;Ue++){let{gx:Ze,gy:nt}=Se(Ue,ue,e);if(1==n.fillType)se=Ze+o+e/2-i,fe=nt+s+e/2-r,this.chkOuterProduct(l,0,0,g,se,fe)&&this.chkOuterProduct(0,g,v,0,se,fe)&&this.chkOuterProduct(v,0,0,w,se,fe)&&this.chkOuterProduct(0,w,l,0,se,fe)&&this.fillSquare(a,Ze+o,nt+s,e);else{let be=0;for(let Ye=0;Ye<e;Ye++)for(let Ke=0;Ke<e;Ke++)se=Ze+o+Ye-i+.5,fe=nt+s+Ke-r+.5,this.chkOuterProduct(l,0,0,g,se,fe)&&this.chkOuterProduct(0,g,v,0,se,fe)&&this.chkOuterProduct(v,0,0,w,se,fe)&&this.chkOuterProduct(0,w,l,0,se,fe)&&be++;(2==n.fillType&&be>=1||3==n.fillType&&be>=e*e/2||4==n.fillType&&be>=e*e)&&this.fillSquare(a,Ze+o,nt+s,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,a=this.canvasElementRange.getContext("2d"),this.makeBrush(a,e,n.rangeColor),a.beginPath(),a.lineWidth=2,a.moveTo(l+i,0+r),a.lineTo(0+i,g+r),a.lineTo(v+i,0+r),a.lineTo(0+i,w+r),a.lineTo(l+i,0+r),a.stroke(),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,a=this.canvasElementCenter.getContext("2d"),this.makeBrush(a,e,n.rangeColor),n.isDocking?(a.beginPath(),a.strokeRect(i-6,r-6,12,12)):(a.beginPath(),a.arc(i,i,5,0,2*Math.PI,!0),a.fill()),le}static gripAreaPathDiamond(n){let e=n.gridSize;return{clip01x:-n.range*e,clip01y:0,clip02x:0,clip02y:-n.range*e,clip03x:n.range*e,clip03y:0,clip04x:0,clip04y:n.range*e}}renderCorn(n){let e=n.gridSize,i=n.areaWidth*e/2,r=n.areaHeight*e/2,o=Math.PI/180*n.degree,s=-n.centerX%e,a=-n.centerY%e;s>0&&(s-=e),a>0&&(a-=e),n.offSetX&&(s<-.5?s+=e/2:s-=e/2),n.offSetY&&(a<-.5?a+=e/2:a-=e/2),this.canvasElement.width=n.areaWidth*e,this.canvasElement.height=n.areaHeight*e;let l=this.canvasElement.getContext("2d"),g=n.range*e,v=-.5*n.width*e,C=n.range*e,E=.5*n.width*e,w=0-e*Math.sqrt(2),M=0-e*Math.sqrt(2),S=0-e*Math.sqrt(2),P=g-e*Math.sqrt(2),Z=v-e*Math.sqrt(2),ee=g,B=v-e*Math.sqrt(2),J=g+e*Math.sqrt(2),le=v-e*Math.sqrt(2),se=J,fe=-le,Se=ee,ue=-B,Ue=P,Ze=-Z,nt=M,be=-S,tt=g*Math.cos(o)-v*Math.sin(o),lt=g*Math.sin(o)+v*Math.cos(o),sn=C*Math.cos(o)-E*Math.sin(o),Ct=C*Math.sin(o)+E*Math.cos(o),Ft={clip01x:w*Math.cos(o)-0*Math.sin(o),clip01y:w*Math.sin(o)+0*Math.cos(o),clip02x:M*Math.cos(o)-S*Math.sin(o),clip02y:M*Math.sin(o)+S*Math.cos(o),clip03x:P*Math.cos(o)-Z*Math.sin(o),clip03y:P*Math.sin(o)+Z*Math.cos(o),clip04x:ee*Math.cos(o)-B*Math.sin(o),clip04y:ee*Math.sin(o)+B*Math.cos(o),clip05x:J*Math.cos(o)-le*Math.sin(o),clip05y:J*Math.sin(o)+le*Math.cos(o),clip06x:se*Math.cos(o)-fe*Math.sin(o),clip06y:se*Math.sin(o)+fe*Math.cos(o),clip07x:Se*Math.cos(o)-ue*Math.sin(o),clip07y:Se*Math.sin(o)+ue*Math.cos(o),clip08x:Ue*Math.cos(o)-Ze*Math.sin(o),clip08y:Ue*Math.sin(o)+Ze*Math.cos(o),clip09x:nt*Math.cos(o)-be*Math.sin(o),clip09y:nt*Math.sin(o)+be*Math.cos(o)},an=0,Qe=0,Yn=this.generateCalcGridPositionFunc(n.gridType,n.centerX,n.centerY,n.areaWidth,n.areaHeight);if(0==n.fillType)this.makeBrush(l,e,n.gridColor),l.beginPath(),l.moveTo(0+i,0+r),l.lineTo(tt+i,lt+r),l.lineTo(sn+i,Ct+r),l.lineTo(0+i,0+r),l.fill();else{this.makeBrush(l,e,n.gridColor);for(let yn=0;yn<=n.areaHeight+1;yn++)for(let en=0;en<=n.areaWidth+1;en++){let{gx:pr,gy:Vo}=Yn(en,yn,e);if(1==n.fillType)an=pr+s+e/2-i,Qe=Vo+a+e/2-r,this.chkOuterProduct(0,0,tt,lt,an,Qe)&&this.chkOuterProduct(tt,lt,sn,Ct,an,Qe)&&this.chkOuterProduct(sn,Ct,0,0,an,Qe)&&this.fillSquare(l,pr+s,Vo+a,e);else{let ea=0;for(let ms=0;ms<e;ms++)for(let _s=0;_s<e;_s++)an=pr+s+ms-i+.5,Qe=Vo+a+_s-r+.5,this.chkOuterProduct(0,0,tt,lt,an,Qe)&&this.chkOuterProduct(tt,lt,sn,Ct,an,Qe)&&this.chkOuterProduct(sn,Ct,0,0,an,Qe)&&ea++;(2==n.fillType&&ea>=1||3==n.fillType&&ea>=e*e/2||4==n.fillType&&ea>=e*e)&&this.fillSquare(l,pr+s,Vo+a,e)}}}return this.canvasElementRange.width=n.areaWidth*e,this.canvasElementRange.height=n.areaHeight*e,l=this.canvasElementRange.getContext("2d"),this.makeBrush(l,e,n.rangeColor),l.beginPath(),l.lineWidth=2,l.moveTo(0+i,0+r),l.lineTo(tt+i,lt+r),l.lineTo(sn+i,Ct+r),l.lineTo(0+i,0+r),l.stroke(),l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill(),this.canvasElementCenter.width=n.areaWidth*e,this.canvasElementCenter.height=n.areaHeight*e,l=this.canvasElementCenter.getContext("2d"),this.makeBrush(l,e,n.rangeColor),l.beginPath(),l.arc(i,i,5,0,2*Math.PI,!0),l.fill(),Ft}static gripAreaPathCorn(n){let e=n.gridSize,i=Math.PI/180*n.degree,s=n.range*e,a=-.5*n.width*e,v=s,C=a,E=s,w=a,T=s,M=a,S=T,P=-M,Z=E,ee=-w,B=v,J=-C;return{clip01x:0*Math.cos(i)-0*Math.sin(i),clip01y:0*Math.sin(i)+0*Math.cos(i),clip02x:0*Math.cos(i)-0*Math.sin(i),clip02y:0*Math.sin(i)+0*Math.cos(i),clip03x:v*Math.cos(i)-C*Math.sin(i),clip03y:v*Math.sin(i)+C*Math.cos(i),clip04x:E*Math.cos(i)-w*Math.sin(i),clip04y:E*Math.sin(i)+w*Math.cos(i),clip05x:T*Math.cos(i)-M*Math.sin(i),clip05y:T*Math.sin(i)+M*Math.cos(i),clip06x:S*Math.cos(i)-P*Math.sin(i),clip06y:S*Math.sin(i)+P*Math.cos(i),clip07x:Z*Math.cos(i)-ee*Math.sin(i),clip07y:Z*Math.sin(i)+ee*Math.cos(i),clip08x:B*Math.cos(i)-J*Math.sin(i),clip08y:B*Math.sin(i)+J*Math.cos(i),clip09x:0*Math.cos(i)- -0*Math.sin(i),clip09y:0*Math.sin(i)+-0*Math.cos(i)}}generateCalcGridPositionFunc(n,e,i,r,o){switch(n){case Iu.HEX_VERTICAL:return(s,a,l)=>(s+(e%(2*l)<l?1:0)+(r%4==0?1:0))%2==1?{gx:s*l,gy:a*l}:{gx:s*l,gy:a*l+l/2};case Iu.HEX_HORIZONTAL:return(s,a,l)=>(a+(i%(2*l)<l?1:0)+(o%4==0?1:0))%2==1?{gx:s*l,gy:a*l}:{gx:s*l+l/2,gy:a*l};default:return(s,a,l)=>({gx:s*l,gy:a*l})}}fillSquare(n,e,i,r){n.beginPath(),n.fillRect(e,i,r,r)}strokeSquare(n,e,i,r){n.beginPath(),n.strokeStyle="#55555533",n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,o){let s=o===Iu.HEX_HORIZONTAL?-30:0,a=r/Math.sqrt(3),l=e+r/2,u=i+r/2;n.beginPath();for(let f=0;f<6;f++){s+=60;let g=Math.PI/180*s,v=Math.cos(g)*a+l,C=Math.sin(g)*a+u;n.lineTo(v,C)}n.closePath(),n.stroke()}}const C_e=["gridCanvas"],x_e=["rangeCanvas"],w_e=["centerPunch"],E_e=["rotate"],T_e=t=>({"is-grab":t}),I_e=t=>({fall:t}),S_e=t=>({"is-magnetic":t}),ew=t=>({"is-inverse":t}),TB=t=>({transform:t});function M_e(t,n){if(1&t&&Ne(0,"div",16),2&t){const e=y();_("ngClass",Be(1,S_e,e.isMagnetic))}}function D_e(t,n){if(1&t&&(p(0,"div",17)(1,"i",18),x(2),m()()),2&t){const e=y();h(),_("ngClass",Be(2,ew,e.isInverse)),h(),Re(e.isLocked?"lock":"open_with")}}function O_e(t,n){if(1&t&&(Me(0),p(1,"div",23)(2,"i",18),x(3),m()(),De()),2&t){const e=n.$implicit,i=y(2);h(),ke("left",i.math.ceil((e-.3)*i.gridSize),"px"),h(),_("ngClass",Be(4,ew,i.isInverse)),h(),Re(i.isLocked?"lock":"autorenew")}}function A_e(t,n){if(1&t&&(Me(0),p(1,"div",19),L(2,O_e,4,6,"ng-container",20),p(3,"div",21)(4,"i",18),x(5),m()(),p(6,"div",22)(7,"i",18),x(8),m()()(),De()),2&t){const e=y();h(2),_("ngForOf",e.rotateHandlesLeftPos),h(2),_("ngClass",Be(5,ew,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew"),h(2),_("ngClass",Be(7,ew,e.isInverse)),h(),Re(e.isLocked?"lock":"autorenew")}}function k_e(t,n){if(1&t&&(p(0,"div",24)(1,"div",25)(2,"span",26)(3,"i"),x(4),m()(),p(5,"span",27)(6,"i"),x(7),m()()(),p(8,"div",25)(9,"span",28),x(10),m(),p(11,"span",29),x(12),m()(),p(13,"div",30)(14,"span",26)(15,"i"),x(16),m()(),p(17,"span",27)(18,"i"),x(19),m()()()()),2&t){const e=y();ke("border-left-color",e.range.rangeColor)("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0||!e.isFollowed?0:e.followingCharactor.chatBubbleAltitude+4),"px"),_("ngStyle",Be(40,TB,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),h(),ke("visibility",e.altitude>0?"visible":"hidden"),h(),ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Re(e.elevation),h(),ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Re(e.elevation),h(2),ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(),Re(e.math.abs(e.altitude)),h(),ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(),Re(e.math.abs(e.altitude)),h(),ke("visibility",e.altitude<0?"visible":"hidden"),_("ngStyle",Be(42,TB,"translateY("+(e.isFollowed?e.followingCharactor.chatBubbleAltitude+4:0)+"px)")),h(),ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Re(e.elevation),h(),ke("color",e.range.rangeColor)("text-shadow",e.textShadowCss),h(2),Re(e.elevation)}}let P_e=(()=>{class t{get clipPathText(){let e="";switch(this.range.type){case"LINE":e=this.clipLine;break;case"CIRCLE":e=this.clipCircle;break;case"SQUARE":e=this.clipSquare;break;case"DIAMOND":e=this.clipDiamond;break;default:e=this.clipCorn}return e}get gripPathText(){let e="";switch(this.range.type){case"LINE":e=this.gripLine;break;case"CIRCLE":e=this.gripCircle;break;case"SQUARE":e=this.gripSquare;break;case"DIAMOND":e=this.gripDiamond;break;default:e=this.gripCorn}return e}get clipCircle(){return"circle("+(this.rangeLength+1.5)*this.gridSize+"px)"}get gripCircle(){return"circle("+(this.rangeLength>1?this.rangeLength:1)*this.gridSize+"px)"}get clipCorn(){return this.clipCornPath(this.clipAreaCorn)}get gripCorn(){return this.clipCornPath(this.gripAreaCorn)}clipCornPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px, ",i+=e.clip05x+"px "+e.clip05y+"px, ",i+=e.clip06x+"px "+e.clip06y+"px, ",i+=e.clip07x+"px "+e.clip07y+"px, ",i+=e.clip08x+"px "+e.clip08y+"px, ",i+=e.clip09x+"px "+e.clip09y+"px)",i}get clipLine(){return this.clipLinePath(this.clipAreaLine)}get gripLine(){return this.clipLinePath(this.gripAreaLine)}clipLinePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipSquare(){return this.clipSquarePath(this.clipAreaSquare)}get gripSquare(){return this.clipSquarePath(this.gripAreaSquare)}clipSquarePath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get clipDiamond(){return this.clipDiamondPath(this.clipAreaDiamond)}get gripDiamond(){return this.clipDiamondPath(this.gripAreaDiamond)}clipDiamondPath(e){let i="polygon("+e.clip01x+"px "+e.clip01y+"px, ";return i+=e.clip02x+"px "+e.clip02y+"px, ",i+=e.clip03x+"px "+e.clip03y+"px, ",i+=e.clip04x+"px "+e.clip04y+"px)",i}get gripLength(){return this.rangeLength>1?this.rangeLength:1}get gripWidth(){return"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type?this.gripLength:this.range.width>this.gripLength?this.range.width:this.gripLength}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get name(){return this.range.name}get width(){return this.adjustMinBounds(this.range.width)}get length(){return this.adjustMinBounds(this.range.length)}get opacity(){return this.range.opacity}get imageFile(){return this.range.imageFile}get isLocked(){return this.range.isLocked}set isLocked(e){this.range.isLocked=e}get selectionState(){return this.selectionService.state(this.range)}get isSelected(){return this.selectionState!==Hn.NONE}get isMagnetic(){return this.selectionState===Hn.MAGNETIC}get areaQuadrantSize(){let e=this.width<1?1:this.width,i=this.rangeLength<1?1:this.rangeLength;return Math.ceil(Math.sqrt(e*e+i*i))+1}get rotateDeg(){let e="0.0";return this.rotate&&this.rotate.nativeElement&&this.rotate.nativeElement.style&&this.rotate.nativeElement.style.transform?(e=this.rotate.nativeElement.style.transform.replace(/[^0-9\.\-]/g,""),e||(e="0.0"),parseFloat(e)):0}get altitude(){return this.range.altitude}set altitude(e){this.range.altitude=e}get elevation(){return+((this.range.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}get isAltitudeIndicate(){return this.range.isAltitudeIndicate}set isAltitudeIndicate(e){this.range.isAltitudeIndicate=e}get textShadowCss(){return`${_e.textShadowColor(this.range.rangeColor,"#f5f5f5")} 0px 0px 3px`}get followingCharactor(){return this.range.followingCharactor}set followingCharactor(e){this.range.followingCharactor=e}get isFollowed(){return this.followingCharactor&&this.followingCharactor.location.x<=this.range.location.x&&this.range.location.x<=this.followingCharactor.location.x+this.followingCharactor.size*this.gridSize&&this.followingCharactor.location.y<=this.range.location.y&&this.range.location.y<=this.followingCharactor.location.y+this.followingCharactor.size*this.gridSize&&this.followingCharactor.altitude+this.followingCharactor.posZ-.5<=this.range.altitude+this.range.posZ&&this.range.altitude+this.range.posZ<=this.followingCharactor.altitude+this.followingCharactor.posZ+.5}get dockableCharacters(){let e=this.tabletopService.characters.filter(i=>"table"===i.location.name&&!i.isHideIn&&[{x:0,y:0},{x:i.size*this.gridSize,y:0},{x:0,y:i.size*this.gridSize},{x:i.size*this.gridSize,y:i.size*this.gridSize}].some(r=>this.range.location.x-this.rangeLength*this.gridSize<=i.location.x+r.x&&i.location.x+r.x<=this.range.location.x+this.rangeLength*this.gridSize&&this.range.location.y-this.rangeLength*this.gridSize<=i.location.y+r.y&&i.location.y+r.y<=this.range.location.y+this.rangeLength*this.gridSize));return this.followingCharactor&&!e.some(i=>i===this.followingCharactor)&&e.push(this.followingCharactor),e.sort((i,r)=>i.name.localeCompare(r.name,"ja"))}get rangeLength(){let e=this.length<1?1:this.length;return this.followingCharactor&&this.range.isExpandByFollowing&&(e+=this.followingCharactor.size/2),e}get rotateHandlesLeftPos(){let e=[];for(let i=1;i<Math.ceil(this.rangeLength/6);i++)e.push(this.rangeLength*i/Math.ceil(this.rangeLength/6));return e.push(this.rangeLength),e}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotateDeg)%360;return 90<e&&e<270}constructor(e,i,r,o,s,a,l,u,f,g,v){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=o,this.panelService=s,this.changeDetector=a,this.pointerDeviceService=l,this.coordinateService=u,this.selectionService=f,this.tabletopService=g,this.modalService=v,this.range=null,this.is3D=!1,this.clipAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.gripAreaCorn={clip01x:0,clip01y:0,clip02x:100,clip02y:0,clip03x:100,clip03y:100,clip04x:0,clip04y:100,clip05x:0,clip05y:0,clip06x:0,clip06y:0,clip07x:0,clip07y:0,clip08x:0,clip08y:0,clip09x:0,clip09y:0},this.clipAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaLine={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaSquare={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.clipAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gripAreaDiamond={clip01x:0,clip01y:0,clip02x:0,clip02y:-50,clip03x:100,clip03y:-50,clip04x:100,clip04y:0},this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.isMoving=!1,this.math=Math,this.input=null}ngOnChanges(){U.unregister(this),U.register(this).on("UPDATE_GAME_OBJECT",-1e3,e=>{let i=dt.instance.get(e.data.identifier);if(!this.range||!i)return;let r=!1;(this.range===i||i instanceof Ir&&this.range.contains(i))&&(this.ngZone.run(()=>{this.setRange()}),r=!0),this.followingCharactor&&(i.identifier===this.followingCharactor.identifier||i instanceof Ir&&this.followingCharactor.contains(i))&&(this.ngZone.run(()=>{this.range.following(),this.setRange()}),r=!0),r&&this.changeDetector.markForCheck()}).on(`UPDATE_SELECTION/identifier/${this.range?.identifier}`,e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",-1e3,e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.range,transformCssOffset:"translateZ(0.25px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.range},this.setRange()}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new bu(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this),this.setRange(),queueMicrotask(()=>{this.changeDetector.markForCheck()})}ngOnDestroy(){this.input.destroy(),U.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.range.toTopmost(),this.isLocked&&U.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];if(this.selectionService.objects.length&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>this.selectionService.congregate(r)}),o.push(At)),o.push(this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ze.play(pe.unlock)},checkBox:"check"}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ze.play(pe.lock)},checkBox:"check"}),o.push({name:"\u5f71\u97ff\u30b0\u30ea\u30c3\u30c9\u306e\u5224\u5b9a\u65b9\u6cd5",action:null,subActions:[{name:(0==this.range.fillType?"\u25c9":"\u25cb")+" \u5224\u5b9a\u306a\u3057 (\u8f2a\u90ed\u5185\u3092\u5857\u308a\u3064\u3076\u3059)",action:()=>{this.range.fillType=0},checkBox:"radio"},At,{name:(1==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e2d\u5fc3\u3092\u8986\u3046",action:()=>{this.range.fillType=1},checkBox:"radio"},{name:(2==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u4e00\u90e8\u3067\u3082\u8986\u3046",action:()=>{this.range.fillType=2},checkBox:"radio"},{name:(3==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u306e\u534a\u5206\u4ee5\u4e0a\u3092\u8986\u3046",action:()=>{this.range.fillType=3},checkBox:"radio"},{name:(4==this.range.fillType?"\u25c9":"\u25cb")+" \u30b0\u30ea\u30c3\u30c9\u5168\u4f53\u3092\u8986\u3046",action:()=>{this.range.fillType=4},checkBox:"radio"}]}),o.push(At),"CIRCLE"==this.range.type||"SQUARE"==this.range.type||"DIAMOND"==this.range.type){let s=this.dockableCharacters.length<=0?this.followingCharactor?[]:[{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c\u3044\u307e\u305b\u3093",action:null,disabled:!0,center:!0}]:this.dockableCharacters.map(a=>({name:`${this.followingCharactor&&this.followingCharactor.identifier===a.identifier?"\u25c9":"\u25cb"} ${a.name}`,action:()=>{this.followingCharactor=a,this.ngZone.run(()=>{this.range.following()}),ze.play(pe.lock)},checkBox:"radio"}));0!=s.length&&s.push(At),s.push({name:"\u8ffd\u5f93\u3092\u89e3\u9664\u3059\u308b",action:()=>{ze.play(pe.unlock),this.followingCharactor=null},disabled:!this.followingCharactor}),o.push({name:"\u4ed8\u8fd1\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u8ffd\u5f93",action:null,subActions:s}),o.push(this.range.isExpandByFollowing?{name:"\u2611 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!1},checkBox:"check"}:{name:"\u2610 \u8ffd\u5f93\u6642\u30b5\u30a4\u30ba\u306b\u5408\u308f\u305b\u3066\u62e1\u5927",action:()=>{this.range.isExpandByFollowing=!0},checkBox:"check"}),o.push(this.range.isFollowAltitude?{name:"\u2611 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u3055\u30fb\u9ad8\u5ea6\u306b\u3082\u8ffd\u5f93",action:()=>{this.range.isFollowAltitude=!0,this.followingCharactor&&this.range.following()},checkBox:"check"})}else o.push(this.range.subDivisionSnapPolygonal?{name:"\u2611 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!1},checkBox:"check"}:{name:"\u2610 \u7d30\u304b\u3044\u89d2\u5ea6\u3067\u56de\u8ee2",action:()=>{this.range.subDivisionSnapPolygonal=!0},checkBox:"check"});o.push(At),o.push(this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1},checkBox:"check"}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0},checkBox:"check"}),o.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,ze.play(pe.sweep))},altitudeHande:this.range}),o.push(At),o.push({name:"\u5c04\u7a0b\u30fb\u7bc4\u56f2\u3092\u7de8\u96c6...",action:()=>{this.showDetail(this.range)}}),this.range.getUrls().length>0&&(o.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.range.getUrls().map(s=>{const a=s.value.toString();return{name:s.name?s.name:a,action:()=>{_e.sameOrigin(a)?window.open(a.trim(),"_blank","noopener"):this.modalService.open(xa,{url:a,title:this.range.name,subTitle:s.name})},disabled:!_e.validUrl(a),error:_e.validUrl(a)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:_e.validUrl(a)&&!_e.sameOrigin(a)}})}),o.push(At)),o.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.range.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.toTopmost(),s.isLocked=!1,s.followingCharctorIdentifier=null,this.range.parent&&this.range.parent.appendChild(s),ze.play(pe.cardPut)}}),o.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.range.destroy(),ze.play(pe.sweep)}}),o.push(At),o.push({name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}),this.contextMenuService.open(i,o,this.name)}onMove(){this.isMoving=!0,ze.play(pe.cardPick)}onMoved(){this.isMoving=!1,ze.play(pe.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u5c04\u7a0b\u30fb\u7bc4\u56f2\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lc,{title:r,left:i.x-200,top:i.y-150,width:400,height:390}).tabletopObject=e}setRange(){let e=new fv(this.gridCanvas.nativeElement,this.rangeCanvas.nativeElement,this.centerPunch.nativeElement),i={areaWidth:2*this.areaQuadrantSize,areaHeight:2*this.areaQuadrantSize,range:this.rangeLength,width:this.width<.1?.1:this.width,centerX:this.range.location.x,centerY:this.range.location.y,gridSize:this.gridSize,type:this.range.type,gridColor:this.range.gridColor,rangeColor:this.range.rangeColor,fanDegree:0,degree:this.rotateDeg,offSetX:this.range.offSetX,offSetY:this.range.offSetY,gridType:this.currentTable.gridType,isDocking:!!this.followingCharactor,fillType:this.range.fillType};switch(this.range.type){case"LINE":this.clipAreaLine=e.renderLine(i),this.gripAreaLine=fv.gripAreaPathLine(i);break;case"CIRCLE":e.renderCircle(i);break;case"SQUARE":this.clipAreaSquare=e.renderSquare(i),this.gripAreaSquare=fv.gripAreaPathSquare(i);break;case"DIAMOND":this.clipAreaDiamond=e.renderDiamond(i),this.gripAreaDiamond=fv.gripAreaPathDiamond(i);break;default:this.clipAreaCorn=e.renderCorn(i),this.gripAreaCorn=fv.gripAreaPathCorn(i)}this.gridCanvas.nativeElement.style.opacity=this.range.opacity+""}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Zx),F(Xo),F(_r),F(bi),F(io),F(hr),F(Kh),F(sc),F(Vm),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["range"]],viewQuery:function(i,r){if(1&i&&(Dn(C_e,7),Dn(x_e,7),Dn(w_e,7),Dn(E_e,5)),2&i){let o;On(o=An())&&(r.gridCanvas=o.first),On(o=An())&&(r.rangeCanvas=o.first),On(o=An())&&(r.centerPunch=o.first),On(o=An())&&(r.rotate=o.first)}},hostBindings:function(i,r){1&i&&X("dragstart",function(s){return r.onDragstart(s)})("contextmenu",function(s){return r.onContextMenu(s)})},inputs:{range:"range",is3D:"is3D"},features:[mr],decls:20,vars:49,consts:[["gridCanvas",""],["rangeCanvas",""],["rotate",""],["centerPunch",""],["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"movable.ondragstart","movable.ondragend","ngClass","movable.option","movable.disable"],[1,"is-3d",3,"ngClass"],[1,"is-3d",2,"position","absolute"],[1,"is-fill",2,"position","absolute","pointer-events","auto","top","-100%"],["class","selected-highlight",3,"ngClass",4,"ngIf"],[1,"is-3d",2,"position","absolute","pointer-events","none"],[1,"is-3d",2,"position","absolute","z-index","0"],[1,"is-fill","is-3d"],["appRotable","",1,"component-content","is-3d",2,"transform","rotateZ(0deg)",3,"rotable.ondragstart","rotable.ondragend","rotable.option","rotable.polygonal","rotable.disable"],["class","lock-icon is-center",4,"ngIf"],[4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"border-left-color","height","ngStyle",4,"ngIf"],[1,"selected-highlight",3,"ngClass"],[1,"lock-icon","is-center"],[1,"material-icons",2,"display","inline-block",3,"ngClass"],[1,"is-3d",2,"position","absolute","width","28px","pointer-events","auto"],[4,"ngFor","ngForOf"],[1,"rotate-grab","of-corn-bottom","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-top","rotate-grab-icon","is-3d","will-change"],[1,"rotate-grab","of-corn-tip","rotate-grab-icon","is-3d","will-change",2,"position","absolute"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"is-3d",3,"ngStyle"]],template:function(i,r){if(1&i){const o=Ie();p(0,"div",4),X("movable.ondragstart",function(){return O(o),D(r.onMove())})("movable.ondragend",function(){return O(o),D(r.onMoved())}),p(1,"div",5)(2,"div",6)(3,"div",7),L(4,M_e,1,3,"div",8),m()(),p(5,"div",9)(6,"div",10),Ne(7,"canvas",11,0),m(),p(9,"div",6),Ne(10,"canvas",11,1),m(),p(12,"div",12,2),X("rotable.ondragstart",function(){return O(o),D(r.onMove())})("rotable.ondragend",function(){return O(o),D(r.onMoved())}),L(14,D_e,3,4,"div",13)(15,A_e,9,9,"ng-container",14),m()()(),L(16,k_e,20,44,"div",15),p(17,"div",10),Ne(18,"canvas",11,3),m()()}2&i&&(_("ngClass",Be(45,T_e,!r.isLocked))("movable.option",r.movableOption)("movable.disable",r.isLocked),h(),ke("transform","translateZ("+r.altitude*r.gridSize+"px)"),_("ngClass",Be(47,I_e,0==r.altitude)),h(),ke("clip-path",r.gripPathText),h(),ke("left",1.5*-r.gripLength*r.gridSize,"px")("width",3*r.gripLength*r.gridSize,"px")("height",3*r.gripWidth*r.gridSize,"px"),h(),_("ngIf",r.isSelected),h(),ke("width",0,"px")("height",0,"px")("clip-path",r.clipPathText),h(),ke("top",0,"px")("left",-1*r.areaQuadrantSize*r.gridSize,"px"),h(3),ke("z-index",r.isMoving?5:0)("top",0,"px")("left",-1*r.areaQuadrantSize*r.gridSize,"px"),h(3),ke("opacity",r.isMoving?.7:1),_("rotable.option",r.rotableOption)("rotable.polygonal",r.range.subDivisionSnapPolygonal?360:24)("rotable.disable",r.isLocked||"CIRCLE"==r.range.type||"SQUARE"==r.range.type||"DIAMOND"==r.range.type),h(2),_("ngIf","CIRCLE"==r.range.type||"SQUARE"==r.range.type||"DIAMOND"==r.range.type),h(),_("ngIf","CIRCLE"!=r.range.type&&"SQUARE"!=r.range.type&&"DIAMOND"!=r.range.type),h(),_("ngIf",r.isAltitudeIndicate&&(r.altitude<=-.5||.5<=r.altitude)),h(),ke("visibility",0!=r.altitude?"visible":"hidden")("top",0,"px")("left",-1*r.areaQuadrantSize*r.gridSize,"px"))},dependencies:[Fi,nr,ni,Zo,gs,Dp],styles:[".is-grab[_ngcontent-%COMP%]{cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;backface-visibility:hidden;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:-12.5px;left:-12.5px;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:solid 2px #CCCCCC}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.pedestal-grab-corn[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px 14px -14px -14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;inset:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:30px;height:30px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:24px;transform-style:preserve-3d;transform:translateZ(.1px)}.will-change[_ngcontent-%COMP%]{will-change:opacity}.of-corn-top[_ngcontent-%COMP%]{top:-30px;left:-15px;border-radius:15px 15px 0 0}.of-corn-bottom[_ngcontent-%COMP%]{bottom:-30px;left:-15px;border-radius:0 0 15px 15px}.of-corn-tip[_ngcontent-%COMP%]{top:-15px;left:-15px;border-radius:15px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.selected-highlight[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-color:#80d4ff99}.selected-highlight.is-magnetic[_ngcontent-%COMP%]{background-color:#ffff8099}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0})}return t})();const F_e=["root"],N_e=["gameTable"],R_e=["gameObjects"],L_e=["gridCanvas"],B_e=["pickArea"],U_e=["pickCursor"],H_e=(t,n,e)=>[t,n,e],z_e=t=>({"is-grabbing":t}),V_e=(t,n)=>({transform:t,clip:n}),tw=(t,n)=>({"z-index":t,transform:n});function j_e(t,n){if(1&t&&(Me(0),Ne(1,"terrain",24),De()),2&t){const e=y(),i=e.$implicit,r=e.index;h(),ke("z-index",r+(i.height>0?0:1e4)),_("terrain",i)("appTooltip",i)}}function G_e(t,n){if(1&t&&(Me(0),Ne(1,"terrain",25),De()),2&t){const e=y(),i=e.$implicit,r=e.index;h(),ke("z-index",r+(i.height>0?0:1e4)),_("terrain",i)}}function W_e(t,n){if(1&t&&(Me(0),L(1,j_e,2,4,"ng-container",23)(2,G_e,2,3,"ng-container",23),De()),2&t){const e=n.$implicit;h(),_("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),h(),_("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function $_e(t,n){if(1&t&&(Me(0),Ne(1,"game-table-mask",26),De()),2&t){const e=y(),i=e.$implicit,r=e.index;h(),_("gameTableMask",i)("appTooltip",i)("ngStyle",Cn(3,tw,r,"translateZ("+1e-4*r+"px)"))}}function Y_e(t,n){if(1&t&&(Me(0),Ne(1,"game-table-mask",27),De()),2&t){const e=y(),i=e.$implicit,r=e.index;h(),_("gameTableMask",i)("ngStyle",Cn(2,tw,r,"translateZ("+1e-4*r+"px)"))}}function q_e(t,n){if(1&t&&(Me(0),L(1,$_e,2,6,"ng-container",23)(2,Y_e,2,5,"ng-container",23),De()),2&t){const e=n.$implicit;h(),_("ngIf",e.detailDataElement&&0<e.detailDataElement.children.length),h(),_("ngIf",!e.detailDataElement||e.detailDataElement.children.length<=0)}}function Z_e(t,n){if(1&t&&Ne(0,"text-note",30),2&t){const e=y().$implicit;ke("z-index",e.zindex),_("textNote",e)("appTooltip",e)}}function X_e(t,n){if(1&t&&Ne(0,"text-note",31),2&t){const e=y().$implicit;ke("z-index",e.zindex),_("textNote",e)}}function K_e(t,n){if(1&t&&(Me(0),L(1,Z_e,1,4,"text-note",28)(2,X_e,1,3,"text-note",29),De()),2&t){const e=n.$implicit;h(),_("ngIf",null!=e.text&&""!=e.text.trim()),h(),_("ngIf",null==e.text||""===e.text.trim())}}function Q_e(t,n){if(1&t&&Ne(0,"card-stack",32),2&t){const e=n.$implicit;_("cardStack",e)("appTooltip",e)("ngStyle",Cn(3,tw,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function J_e(t,n){if(1&t&&Ne(0,"card",33),2&t){const e=n.$implicit;_("card",e)("appTooltip",e)("ngStyle",Cn(3,tw,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function e0e(t,n){if(1&t&&Ne(0,"range",34),2&t){const e=n.$implicit;ke("z-index",e.zindex),_("range",e)("appTooltip",e)}}function t0e(t,n){if(1&t&&Ne(0,"dice-symbol",35),2&t){const e=n.$implicit;_("diceSymbol",e)("appTooltip",e)}}function n0e(t,n){if(1&t&&(Me(0),Ne(1,"game-character",36),De()),2&t){const e=y().$implicit;h(),ke("display",e.isLoaded?"":"none"),_("gameCharacter",e)("appTooltip",e)}}function i0e(t,n){if(1&t&&(Me(0),L(1,n0e,2,4,"ng-container",23),De()),2&t){const e=n.$implicit,i=y();h(),_("ngIf",e&&(e.isVisible||i.isGMMode))}}function r0e(t,n){if(1&t&&Ne(0,"peer-cursor",37),2&t){const e=n.$implicit,i=y();ke("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),_("cursor",e)}}let o0e=(()=>{class t{get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundImage2(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier2)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get ranges(){return this.tabletopService.ranges}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return cn.isStealthMode}get isGMMode(){return Ce.myCursor&&Ce.myCursor.isGMMode}get clipCss(){const e=this.currentTable.gridClipRect;return e?`rect(${e.top}px, ${e.right}px, ${e.bottom}px, ${e.left}px)`:"auto"}get tableImageUrls(){let e="",i="",r="";const o=this.currentTable?.identifier!=this._currentTable?.identifier;return this._currentTable=this.currentTable,(o||this._currentTableImage?.identifier!=this.tableImage.identifier||this._currentTableImageState!=this.tableImage.state)&&(this._currentTableImage=this.tableImage,this.tableImage.state===Di.THUMBNAIL||this.tableImage.state===Di.COMPLETE?(this._currentTableImageState=this.tableImage.state,this._currentTableImageUrl&&(e=this._currentTableImageUrl),this._currentTableImageUrl=URL.createObjectURL(this.tableImage.blob)):this._currentTableImageUrl=this.tableImage.url),(o||this._currentBackgroundImage?.identifier!=this.backgroundImage.identifier||this._currentBackgroundImageState!=this.backgroundImage.state)&&(this._currentBackgroundImage=this.backgroundImage,this.backgroundImage.state===Di.THUMBNAIL||this.backgroundImage.state===Di.COMPLETE?(this._currentBackgroundImageState=this.backgroundImage.state,this._currentBackgroundImageUrl&&(i=this._currentBackgroundImageUrl),this.isBackgroundImageLoaded=!1,this._currentBackgroundImageUrl=URL.createObjectURL(this.backgroundImage.blob)):this._currentBackgroundImageUrl=this.backgroundImage.url),(o||this._currentBackgroundImage2?.identifier!=this.backgroundImage2.identifier||this._currentBackgroundImageState2!=this.backgroundImage2.state)&&(this._currentBackgroundImage2=this.backgroundImage2,this.backgroundImage2.state===Di.THUMBNAIL||this.backgroundImage2.state===Di.COMPLETE?(this._currentBackgroundImageState2=this.backgroundImage2.state,this._currentBackgroundImageUrl2&&(r=this._currentBackgroundImageUrl2),this.isBackgroundImageLoaded2=!1,this._currentBackgroundImageUrl2=URL.createObjectURL(this.backgroundImage2.blob)):this._currentBackgroundImageUrl2=this.backgroundImage2.url),(e||i||r)&&queueMicrotask(()=>{e&&URL.revokeObjectURL(e),i&&URL.revokeObjectURL(i),r&&URL.revokeObjectURL(r)}),[this._currentTableImageUrl,this._currentBackgroundImageUrl,this._currentBackgroundImageUrl2]}get tableImageUrl(){return this.tableImageUrls[0]}get backgroundImageUrl(){return this.tableImageUrls[1]}get backgroundImageUrl2(){return this.tableImageUrls[2]}get backgroundImageCss(){if(this._currentBackgroundImageCss&&(this.backgroundImageUrl&&!this.isBackgroundImageLoaded||this.backgroundImageUrl2&&!this.isBackgroundImageLoaded2))return this._currentBackgroundImageCss;let e=[];return this.backgroundImageUrl&&e.push(`url(${this.backgroundImageUrl})`),this.backgroundImageUrl2&&(!this.backgroundImageUrl||this.backgroundImageUrl&&this.isBackgroundImageLoaded)&&e.push(`url(${this.backgroundImageUrl2})`),this._currentBackgroundImageCss=e.join(","),this._currentBackgroundImageCss}constructor(e,i,r,o,s,a,l,u,f){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=o,this.imageService=s,this.tabletopService=a,this.tabletopActionService=l,this.selectionService=u,this.modalService=f,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null,this.pickGesture=null,this._currentTableImageUrl="",this._currentTableImageState=0,this._currentBackgroundImageUrl="",this._currentBackgroundImageState=0,this._currentBackgroundImageUrl2="",this._currentBackgroundImageState2=0,this.isBackgroundImageLoaded=!1,this.isBackgroundImageLoaded2=!1,this._currentBackgroundImageCss=""}ngOnInit(){U.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let o=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,s=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,a=e.data.z,l=this.viewRotateZ/180*Math.PI,u=o*Math.cos(l)-s*Math.sin(l),f=o*Math.sin(l)+s*Math.cos(l),g=this.viewRotateX/180*Math.PI,v=f*Math.cos(g),C=f*Math.sin(g)+a;this.setTransform(100-u-this.viewPotisonX,-v-this.viewPotisonY,-C-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture(),this.initializeTablePickGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){U.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy(),this.pickGesture.destroy(),this._currentTableImageUrl&&URL.revokeObjectURL(this._currentTableImageUrl),this._currentBackgroundImageUrl&&URL.revokeObjectURL(this._currentBackgroundImageUrl),this._currentBackgroundImageUrl2&&URL.revokeObjectURL(this._currentBackgroundImageUrl2)}initializeTableTouchGesture(){this.touchGesture=new Qhe(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new qhe(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}initializeTablePickGesture(){this.pickGesture=new Zhe(this.rootElementRef.nativeElement,this.gameObjects.nativeElement,this.pickCursor.nativeElement,this.pickArea.nativeElement,this.pointerDeviceService,this.selectionService),this.pickGesture.onstart=this.onTablePickStart.bind(this),this.pickGesture.onend=this.onTablePickEnd.bind(this),this.pickGesture.oncancelifneeded=this.onTablePickCancelIfNeeded.bind(this),this.pickGesture.onpick=this.onTablePick.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,o,s,a,l,u){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),u.cancelable&&u.preventDefault();let f=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<o+this.viewRotateX&&(o+=80-(o+this.viewRotateX)),o+this.viewRotateX<0&&(o+=0-(o+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=f,i*=f,r,o,s,a),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,o,s,a,l,u){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),u.cancelable&&u.preventDefault();let f=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=f,i*=f,r,o,s,a),this.isTableTransformed=!0}onTablePickStart(){this.isTableTransformMode=!1,ze.playLocal(pe.selectionStart),this.pickGesture.isMagneticMode||(this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+"")}onTablePickEnd(){this.pickGesture.isKeepSelection||requestAnimationFrame(()=>{requestAnimationFrame(()=>{this.contextMenuService.isShow||this.selectionService.clear()})})}onTablePickCancelIfNeeded(){return this.isTableTransformMode}onTablePick(){!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close())}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),o=[];0<this.selectionService.size&&(o.push({name:"\u3053\u3053\u306b\u96c6\u3081\u308b",action:()=>{this.selectionService.congregate(r)},disabled:0<this.selectionService.size}),o.push(At)),Array.prototype.push.apply(o,this.tabletopActionService.makeDefaultContextMenuActions(r)),o.push(At),o.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a...",action:()=>{this.modalService.open(BL)}}),this.contextMenuService.open(i,o,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,o,s,a,l=!1){l?(this.viewRotateX=o,this.viewRotateY=s,this.viewRotateZ=a,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=o,this.viewRotateY+=s,this.viewRotateZ+=a,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),(l||0!=o||0!=s||0!=o)&&this.ngZone.run(()=>{U.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,o=Iu.SQUARE,s="#000000e6",a=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new Yhe(this.gridCanvas.nativeElement).render(e,i,r,o,s,a),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}static#e=this.\u0275fac=function(i){return new(i||t)(F(Sn),F(Xo),F(hr),F(Kh),F(Gm),F(Vm),F(Zx),F(sc),F(Ii))};static#t=this.\u0275cmp=xn({type:t,selectors:[["game-table"]],viewQuery:function(i,r){if(1&i&&(Dn(F_e,7),Dn(N_e,7),Dn(R_e,7),Dn(L_e,7),Dn(B_e,7),Dn(U_e,7)),2&i){let o;On(o=An())&&(r.rootElementRef=o.first),On(o=An())&&(r.gameTable=o.first),On(o=An())&&(r.gameObjects=o.first),On(o=An())&&(r.gridCanvas=o.first),On(o=An())&&(r.pickArea=o.first),On(o=An())&&(r.pickCursor=o.first)}},hostBindings:function(i,r){1&i&&X("contextmenu",function(s){return r.onContextMenu(s)})("mousedown",function(s){return r.onDocumentMouseDown(s)},!1,zf)("touchstart",function(s){return r.onDocumentTouchStart(s)},!1,zf)("contextmenu",function(s){return r.onDocumentContextMenu(s)},!1,zf)},decls:32,vars:48,consts:[["root",""],["gameTable",""],["gameObjects",""],["gridCanvas",""],["pickArea",""],["pickCursor",""],[2,"visibility","hidden","pointer-events","none","position","absolute",3,"load","src"],[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],[1,"component-content","is-fill","is-3d"],["id","app-game-table",1,"game-table","table-image","is-3d"],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],[1,"is-fill","is-3d","is-pointer-events-none"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"range","z-index","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[1,"pick-area"],[1,"pick-cursor"],["xmlns","http://www.w3.org/2000/svg","width","100","height","100","viewBox","0 0 100 100"],["cx","50","cy","50","r","15"],[4,"ngIf"],[1,"is-3d",3,"terrain","appTooltip"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask","appTooltip","ngStyle"],[1,"is-3d",3,"gameTableMask","ngStyle"],["class","is-3d",3,"textNote","appTooltip","z-index",4,"ngIf"],["class","is-3d",3,"textNote","z-index",4,"ngIf"],[1,"is-3d",3,"textNote","appTooltip"],[1,"is-3d",3,"textNote"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"range","appTooltip"],[1,"is-3d",3,"diceSymbol","appTooltip"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(i,r){if(1&i){const o=Ie();p(0,"img",6),It(1,"safe"),X("load",function(){return O(o),D(r.isBackgroundImageLoaded=!0)}),m(),p(2,"img",6),It(3,"safe"),X("load",function(){return O(o),D(r.isBackgroundImageLoaded2=!0)}),m(),Ne(4,"div",7),It(5,"safe"),p(6,"div",8,0)(8,"div",9,1)(10,"div",10,2),It(12,"safe"),Ne(13,"canvas",11,3),p(15,"div",12),L(16,W_e,3,2,"ng-container",13),m(),p(17,"div",12),L(18,q_e,3,2,"ng-container",13),m(),L(19,K_e,3,2,"ng-container",13)(20,Q_e,1,6,"card-stack",14)(21,J_e,1,6,"card",15)(22,e0e,1,4,"range",16)(23,t0e,1,2,"dice-symbol",17)(24,i0e,2,1,"ng-container",13)(25,r0e,1,3,"peer-cursor",18),m()()(),Ne(26,"div",19,4),p(28,"div",20,5),nu(),p(30,"svg",21),Ne(31,"circle",22),m()()}2&i&&(_("src",St(1,27,r.backgroundImageUrl,"resourceUrl"),gn),h(2),_("src",St(3,30,r.backgroundImageUrl2,"resourceUrl"),gn),h(2),ke("background-image",St(5,33,r.backgroundImageCss,"style")),_("ngClass",ma(39,H_e,r.backgroundFilterType?"is-filter":"",r.isStealthMode&&!r.isGMMode?"is-hide-in":"",r.backgroundFilterType)),h(2),_("ngClass",Be(43,z_e,r.isPointerDragging)),h(4),ke("background-image",St(12,36,"url("+r.tableImageUrl+")","style")),h(3),_("ngStyle",Cn(45,V_e,"translateZ("+(r.gridHeight+.1)+"px)",r.clipCss)),h(3),_("ngForOf",r.terrains)("ngForTrackBy",r.trackByGameObject),h(2),_("ngForOf",r.tableMasks)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.textNotes)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.cardStacks)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.cards)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.ranges)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.diceSymbols)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.characters)("ngForTrackBy",r.trackByGameObject),h(),_("ngForOf",r.peerCursors)("ngForTrackBy",r.trackByGameObject))},dependencies:[Fi,nr,ni,Zo,ufe,_ge,Bge,ume,Fme,zc,e_e,y_e,pB,P_e,fr],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;inset:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:none;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;inset:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}.pick-area[_ngcontent-%COMP%]{position:absolute;display:none;background-color:#00a8ff1a;border:1px solid hsl(200,100%,50%);pointer-events:none}.pick-cursor[_ngcontent-%COMP%]{position:absolute;display:none;scale:1;transition:scale .2s ease-out;stroke:#0af;pointer-events:none}.pick-cursor[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{transform:rotate(-90deg)}.pick-cursor[_ngcontent-%COMP%]   circle[_ngcontent-%COMP%]{fill:#e5f6ffb3;stroke:inherit;stroke-width:4;animation-name:_ngcontent-%COMP%_circle-animation,_ngcontent-%COMP%_circle-fill;animation-timing-function:linear,ease-out;animation-duration:.85s,.85s}@keyframes _ngcontent-%COMP%_circle-animation{0%{stroke-dasharray:0 94.3}55%{stroke-dasharray:0 94.3}99.9%,to{stroke-dasharray:94.3 94.3}}@keyframes _ngcontent-%COMP%_circle-fill{0%{opacity:0}45%{opacity:0}99.9%,to{opacity:1}}']})}return t})(),s0e=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};U.register(this).on("*",i=>{this.needRepeat||xt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){U.unregister(this)}static#e=this.\u0275fac=function(i){return new(i||t)(F(_r))};static#t=this.\u0275cmp=xn({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(i,r){1&i&&(p(0,"div",0),Ne(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),p(10,"div",10),x(11,"sync"),m()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]})}return t})();let l0e=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=Ra({type:t}),t.\u0275inj=Pa({}),t})(),c0e=(()=>{class t{static#e=this.\u0275fac=function(i){return new(i||t)};static#t=this.\u0275mod=Ra({type:t,bootstrap:[Du]});static#n=this.\u0275inj=Pa({providers:[jx,Do,Xo,Ii,Sd,bi,hr,Vm,Qs],imports:[i4,eX,FF,sq,l0e,pX,hce.register("ngsw-worker.js",{enabled:true})]})}return t})();um(Du,function(){return[Fi,ni,o0e,V6,s0e]},function(){return[fr]}),um(Hm,function(){return[nr,ni,sp,ya,Ca,Rr,Nh,Lr,op,Tr,hd,kb,Ia]},[]),um(Ip,function(){return[Fi,nr,ni,sp,Rr,Nh,Lr,op,Tr,hd,kb,$he,Ia]},[]),um(Hm,function(){return[nr,ni,sp,ya,Ca,Rr,Nh,Lr,op,Tr,hd,kb,Ia]},[]),um(ev,function(){return[nr,ni,Rr,Xl,Kl,Wa,Lr,pd,fd,Tr,FL]},[]),f$().bootstrapModule(c0e).catch(t=>console.error(t))},7656:function(Nt,Fe,me){var R;Nt.exports=(R=R||function(A,oe){var te;if(typeof window<"u"&&window.crypto&&(te=window.crypto),typeof self<"u"&&self.crypto&&(te=self.crypto),typeof globalThis<"u"&&globalThis.crypto&&(te=globalThis.crypto),!te&&typeof window<"u"&&window.msCrypto&&(te=window.msCrypto),!te&&typeof global<"u"&&global.crypto&&(te=global.crypto),!te)try{te=me(477)}catch{}var K=function(){if(te){if("function"==typeof te.getRandomValues)try{return te.getRandomValues(new Uint32Array(1))[0]}catch{}if("function"==typeof te.randomBytes)try{return te.randomBytes(4).readInt32LE()}catch{}}throw new Error("Native crypto module could not be used to get secure random number.")},q=Object.create||function(){function Ae(){}return function(ot){var rt;return Ae.prototype=ot,rt=new Ae,Ae.prototype=null,rt}}(),W={},ie=W.lib={},Q=ie.Base=function(){return{extend:function(Ae){var ot=q(this);return Ae&&ot.mixIn(Ae),(!ot.hasOwnProperty("init")||this.init===ot.init)&&(ot.init=function(){ot.$super.init.apply(this,arguments)}),ot.init.prototype=ot,ot.$super=this,ot},create:function(){var Ae=this.extend();return Ae.init.apply(Ae,arguments),Ae},init:function(){},mixIn:function(Ae){for(var ot in Ae)Ae.hasOwnProperty(ot)&&(this[ot]=Ae[ot]);Ae.hasOwnProperty("toString")&&(this.toString=Ae.toString)},clone:function(){return this.init.prototype.extend(this)}}}(),H=ie.WordArray=Q.extend({init:function(Ae,ot){Ae=this.words=Ae||[],this.sigBytes=null!=ot?ot:4*Ae.length},toString:function(Ae){return(Ae||he).stringify(this)},concat:function(Ae){var ot=this.words,rt=Ae.words,qe=this.sigBytes,ct=Ae.sigBytes;if(this.clamp(),qe%4)for(var Ee=0;Ee<ct;Ee++)ot[qe+Ee>>>2]|=(rt[Ee>>>2]>>>24-Ee%4*8&255)<<24-(qe+Ee)%4*8;else for(var Gt=0;Gt<ct;Gt+=4)ot[qe+Gt>>>2]=rt[Gt>>>2];return this.sigBytes+=ct,this},clamp:function(){var Ae=this.words,ot=this.sigBytes;Ae[ot>>>2]&=4294967295<<32-ot%4*8,Ae.length=A.ceil(ot/4)},clone:function(){var Ae=Q.clone.call(this);return Ae.words=this.words.slice(0),Ae},random:function(Ae){for(var ot=[],rt=0;rt<Ae;rt+=4)ot.push(K());return new H.init(ot,Ae)}}),$=W.enc={},he=$.Hex={stringify:function(Ae){for(var ot=Ae.words,rt=Ae.sigBytes,qe=[],ct=0;ct<rt;ct++){var Ee=ot[ct>>>2]>>>24-ct%4*8&255;qe.push((Ee>>>4).toString(16)),qe.push((15&Ee).toString(16))}return qe.join("")},parse:function(Ae){for(var ot=Ae.length,rt=[],qe=0;qe<ot;qe+=2)rt[qe>>>3]|=parseInt(Ae.substr(qe,2),16)<<24-qe%8*4;return new H.init(rt,ot/2)}},ye=$.Latin1={stringify:function(Ae){for(var ot=Ae.words,rt=Ae.sigBytes,qe=[],ct=0;ct<rt;ct++)qe.push(String.fromCharCode(ot[ct>>>2]>>>24-ct%4*8&255));return qe.join("")},parse:function(Ae){for(var ot=Ae.length,rt=[],qe=0;qe<ot;qe++)rt[qe>>>2]|=(255&Ae.charCodeAt(qe))<<24-qe%4*8;return new H.init(rt,ot)}},de=$.Utf8={stringify:function(Ae){try{return decodeURIComponent(escape(ye.stringify(Ae)))}catch{throw new Error("Malformed UTF-8 data")}},parse:function(Ae){return ye.parse(unescape(encodeURIComponent(Ae)))}},Ve=ie.BufferedBlockAlgorithm=Q.extend({reset:function(){this._data=new H.init,this._nDataBytes=0},_append:function(Ae){"string"==typeof Ae&&(Ae=de.parse(Ae)),this._data.concat(Ae),this._nDataBytes+=Ae.sigBytes},_process:function(Ae){var ot,rt=this._data,qe=rt.words,ct=rt.sigBytes,Ee=this.blockSize,Gt=ct/(4*Ee),Et=(Gt=Ae?A.ceil(Gt):A.max((0|Gt)-this._minBufferSize,0))*Ee,_t=A.min(4*Et,ct);if(Et){for(var Vt=0;Vt<Et;Vt+=Ee)this._doProcessBlock(qe,Vt);ot=qe.splice(0,Et),rt.sigBytes-=_t}return new H.init(ot,_t)},clone:function(){var Ae=Q.clone.call(this);return Ae._data=this._data.clone(),Ae},_minBufferSize:0}),Lt=(ie.Hasher=Ve.extend({cfg:Q.extend(),init:function(Ae){this.cfg=this.cfg.extend(Ae),this.reset()},reset:function(){Ve.reset.call(this),this._doReset()},update:function(Ae){return this._append(Ae),this._process(),this},finalize:function(Ae){return Ae&&this._append(Ae),this._doFinalize()},blockSize:16,_createHelper:function(Ae){return function(ot,rt){return new Ae.init(rt).finalize(ot)}},_createHmacHelper:function(Ae){return function(ot,rt){return new Lt.HMAC.init(Ae,rt).finalize(ot)}}}),W.algo={});return W}(Math),R)},8823:function(Nt,Fe,me){var R;Nt.exports=(R=me(7656),function(){if("function"==typeof ArrayBuffer){var te=R.lib.WordArray,K=te.init,q=te.init=function(W){if(W instanceof ArrayBuffer&&(W=new Uint8Array(W)),(W instanceof Int8Array||typeof Uint8ClampedArray<"u"&&W instanceof Uint8ClampedArray||W instanceof Int16Array||W instanceof Uint16Array||W instanceof Int32Array||W instanceof Uint32Array||W instanceof Float32Array||W instanceof Float64Array)&&(W=new Uint8Array(W.buffer,W.byteOffset,W.byteLength)),W instanceof Uint8Array){for(var ie=W.byteLength,Q=[],H=0;H<ie;H++)Q[H>>>2]|=W[H]<<24-H%4*8;K.call(this,Q,ie)}else K.apply(this,arguments)};q.prototype=te}}(),R.lib.WordArray)},5168:function(Nt,Fe,me){var R;Nt.exports=(R=me(7656),function(A){var oe=R,te=oe.lib,K=te.WordArray,q=te.Hasher,W=oe.algo,ie=[],Q=[];!function(){function he(Je){for(var Lt=A.sqrt(Je),Ae=2;Ae<=Lt;Ae++)if(!(Je%Ae))return!1;return!0}function ye(Je){return 4294967296*(Je-(0|Je))|0}for(var de=2,Ve=0;Ve<64;)he(de)&&(Ve<8&&(ie[Ve]=ye(A.pow(de,.5))),Q[Ve]=ye(A.pow(de,1/3)),Ve++),de++}();var H=[],$=W.SHA256=q.extend({_doReset:function(){this._hash=new K.init(ie.slice(0))},_doProcessBlock:function(he,ye){for(var de=this._hash.words,Ve=de[0],Je=de[1],Lt=de[2],Ae=de[3],ot=de[4],rt=de[5],qe=de[6],ct=de[7],Ee=0;Ee<64;Ee++){if(Ee<16)H[Ee]=0|he[ye+Ee];else{var Tt=H[Ee-15],Et=H[Ee-2];H[Ee]=((Tt<<25|Tt>>>7)^(Tt<<14|Tt>>>18)^Tt>>>3)+H[Ee-7]+((Et<<15|Et>>>17)^(Et<<13|Et>>>19)^Et>>>10)+H[Ee-16]}var un=Ve&Je^Ve&Lt^Je&Lt,Ut=ct+((ot<<26|ot>>>6)^(ot<<21|ot>>>11)^(ot<<7|ot>>>25))+(ot&rt^~ot&qe)+Q[Ee]+H[Ee];ct=qe,qe=rt,rt=ot,ot=Ae+Ut|0,Ae=Lt,Lt=Je,Je=Ve,Ve=Ut+(((Ve<<30|Ve>>>2)^(Ve<<19|Ve>>>13)^(Ve<<10|Ve>>>22))+un)|0}de[0]=de[0]+Ve|0,de[1]=de[1]+Je|0,de[2]=de[2]+Lt|0,de[3]=de[3]+Ae|0,de[4]=de[4]+ot|0,de[5]=de[5]+rt|0,de[6]=de[6]+qe|0,de[7]=de[7]+ct|0},_doFinalize:function(){var he=this._data,ye=he.words,de=8*this._nDataBytes,Ve=8*he.sigBytes;return ye[Ve>>>5]|=128<<24-Ve%32,ye[14+(Ve+64>>>9<<4)]=A.floor(de/4294967296),ye[15+(Ve+64>>>9<<4)]=de,he.sigBytes=4*ye.length,this._process(),this._hash},clone:function(){var he=q.clone.call(this);return he._hash=this._hash.clone(),he}});oe.SHA256=q._createHelper($),oe.HmacSHA256=q._createHmacHelper($)}(Math),R.SHA256)},8004:Nt=>{!function(me){Nt.exports=me;var R="listeners",A={on:function te(Q,H){return ie(this,Q).push(H),this},once:function K(Q,H){var $=this;return he.originalListener=H,ie($,Q).push(he),$;function he(){q.call($,Q,he),H.apply(this,arguments)}},off:q,emit:function W(Q,H){var $=this,he=ie($,Q,!0);if(!he)return!1;var ye=arguments.length;if(1===ye)he.forEach(function Ve(Ae){Ae.call($)});else if(2===ye)he.forEach(function Je(Ae){Ae.call($,H)});else{var de=Array.prototype.slice.call(arguments,1);he.forEach(function Lt(Ae){Ae.apply($,de)})}return!!he.length}};function oe(Q){for(var H in A)Q[H]=A[H];return Q}function q(Q,H){var he,$=this;if(arguments.length){if(H){if(he=ie($,Q,!0)){if(!(he=he.filter(function ye(de){return de!==H&&de.originalListener!==H})).length)return q.call($,Q);$[R][Q]=he}}else if((he=$[R])&&(delete he[Q],!Object.keys(he).length))return q.call($)}else delete $[R];return $}function ie(Q,H,$){if(!$||Q[R]){var he=Q[R]||(Q[R]={});return he[H]||(he[H]=[])}}oe(me.prototype),me.mixin=oe}(function Fe(){if(!(this instanceof Fe))return new Fe})},2578:function(Nt,Fe){var me,A;void 0!==(A="function"==typeof(me=function(){"use strict";function te(H,$,he){var ye=new XMLHttpRequest;ye.open("GET",H),ye.responseType="blob",ye.onload=function(){Q(ye.response,$,he)},ye.onerror=function(){console.error("could not download file")},ye.send()}function K(H){var $=new XMLHttpRequest;$.open("HEAD",H,!1);try{$.send()}catch{}return 200<=$.status&&299>=$.status}function q(H){try{H.dispatchEvent(new MouseEvent("click"))}catch{var $=document.createEvent("MouseEvents");$.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),H.dispatchEvent($)}}var W="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,ie=W.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),Q=W.saveAs||("object"!=typeof window||window!==W?function(){}:"download"in HTMLAnchorElement.prototype&&!ie?function(H,$,he){var ye=W.URL||W.webkitURL,de=document.createElement("a");de.download=$=$||H.name||"download",de.rel="noopener","string"==typeof H?(de.href=H,de.origin===location.origin?q(de):K(de.href)?te(H,$,he):q(de,de.target="_blank")):(de.href=ye.createObjectURL(H),setTimeout(function(){ye.revokeObjectURL(de.href)},4e4),setTimeout(function(){q(de)},0))}:"msSaveOrOpenBlob"in navigator?function(H,$,he){if($=$||H.name||"download","string"!=typeof H)navigator.msSaveOrOpenBlob(function oe(H,$){return typeof $>"u"?$={autoBom:!1}:"object"!=typeof $&&(console.warn("Deprecated: Expected third argument to be a object"),$={autoBom:!$}),$.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(H.type)?new Blob(["\ufeff",H],{type:H.type}):H}(H,he),$);else if(K(H))te(H,$,he);else{var ye=document.createElement("a");ye.href=H,ye.target="_blank",setTimeout(function(){q(ye)})}}:function(H,$,he,ye){if((ye=ye||open("","_blank"))&&(ye.document.title=ye.document.body.innerText="downloading..."),"string"==typeof H)return te(H,$,he);var de="application/octet-stream"===H.type,Ve=/constructor/i.test(W.HTMLElement)||W.safari,Je=/CriOS\/[\d]+/.test(navigator.userAgent);if((Je||de&&Ve||ie)&&typeof FileReader<"u"){var Lt=new FileReader;Lt.onloadend=function(){var rt=Lt.result;rt=Je?rt:rt.replace(/^data:[^;]*;/,"data:attachment/file;"),ye?ye.location.href=rt:location=rt,ye=null},Lt.readAsDataURL(H)}else{var Ae=W.URL||W.webkitURL,ot=Ae.createObjectURL(H);ye?ye.location=ot:location.href=ot,ye=null,setTimeout(function(){Ae.revokeObjectURL(ot)},4e4)}});W.saveAs=Q.saveAs=Q,Nt.exports=Q})?me.apply(Fe,[]):me)&&(Nt.exports=A)},4511:(Nt,Fe,me)=>{var R;!function(A,oe,te,K){"use strict";var Je,q=["","webkit","Moz","MS","ms","o"],W=oe.createElement("div"),ie="function",Q=Math.round,H=Math.abs,$=Date.now;function he(N,G,re){return setTimeout(rt(N,re),G)}function ye(N,G,re){return!!Array.isArray(N)&&(de(N,re[G],re),!0)}function de(N,G,re){var ve;if(N)if(N.forEach)N.forEach(G,re);else if(N.length!==K)for(ve=0;ve<N.length;)G.call(re,N[ve],ve,N),ve++;else for(ve in N)N.hasOwnProperty(ve)&&G.call(re,N[ve],ve,N)}function Ve(N,G,re){var ve="DEPRECATED METHOD: "+G+"\n"+re+" AT \n";return function(){var vt=new Error("get-stack-trace"),Zt=vt&&vt.stack?vt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Gn=A.console&&(A.console.warn||A.console.log);return Gn&&Gn.call(A.console,ve,Zt),N.apply(this,arguments)}}Je="function"!=typeof Object.assign?function(G){if(G===K||null===G)throw new TypeError("Cannot convert undefined or null to object");for(var re=Object(G),ve=1;ve<arguments.length;ve++){var vt=arguments[ve];if(vt!==K&&null!==vt)for(var Zt in vt)vt.hasOwnProperty(Zt)&&(re[Zt]=vt[Zt])}return re}:Object.assign;var Lt=Ve(function(G,re,ve){for(var vt=Object.keys(re),Zt=0;Zt<vt.length;)(!ve||ve&&G[vt[Zt]]===K)&&(G[vt[Zt]]=re[vt[Zt]]),Zt++;return G},"extend","Use `assign`."),Ae=Ve(function(G,re){return Lt(G,re,!0)},"merge","Use `assign`.");function ot(N,G,re){var vt,ve=G.prototype;(vt=N.prototype=Object.create(ve)).constructor=N,vt._super=ve,re&&Je(vt,re)}function rt(N,G){return function(){return N.apply(G,arguments)}}function qe(N,G){return typeof N==ie?N.apply(G&&G[0]||K,G):N}function ct(N,G){return N===K?G:N}function Ee(N,G,re){de(_t(G),function(ve){N.addEventListener(ve,re,!1)})}function Tt(N,G,re){de(_t(G),function(ve){N.removeEventListener(ve,re,!1)})}function Gt(N,G){for(;N;){if(N==G)return!0;N=N.parentNode}return!1}function Et(N,G){return N.indexOf(G)>-1}function _t(N){return N.trim().split(/\s+/g)}function Vt(N,G,re){if(N.indexOf&&!re)return N.indexOf(G);for(var ve=0;ve<N.length;){if(re&&N[ve][re]==G||!re&&N[ve]===G)return ve;ve++}return-1}function un(N){return Array.prototype.slice.call(N,0)}function wt(N,G,re){for(var ve=[],vt=[],Zt=0;Zt<N.length;){var Gn=G?N[Zt][G]:N[Zt];Vt(vt,Gn)<0&&ve.push(N[Zt]),vt[Zt]=Gn,Zt++}return re&&(ve=G?ve.sort(function(Xr,Wt){return Xr[G]>Wt[G]}):ve.sort()),ve}function Bt(N,G){for(var re,ve,vt=G[0].toUpperCase()+G.slice(1),Zt=0;Zt<q.length;){if((ve=(re=q[Zt])?re+vt:G)in N)return ve;Zt++}return K}var Ut=1;function zn(N){var G=N.ownerDocument||N;return G.defaultView||G.parentWindow||A}var Ar="ontouchstart"in A,xi=Bt(A,"PointerEvent")!==K,Rl=Ar&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),na="touch",Kt="mouse",pi=25,jn=1,ui=4,Ui=8,Rt=1,pn=2,ln=4,dn=8,qn=16,wi=pn|ln,ar=dn|qn,qr=wi|ar,so=["x","y"],lr=["clientX","clientY"];function Vr(N,G){var re=this;this.manager=N,this.callback=G,this.element=N.element,this.target=N.options.inputTarget,this.domHandler=function(ve){qe(N.options.enable,[N])&&re.handler(ve)},this.init()}function Od(N,G,re){var ve=re.pointers.length,vt=re.changedPointers.length,Zt=G&jn&&ve-vt==0,Gn=G&(ui|Ui)&&ve-vt==0;re.isFirst=!!Zt,re.isFinal=!!Gn,Zt&&(N.session={}),re.eventType=G,function Ll(N,G){var re=N.session,ve=G.pointers,vt=ve.length;re.firstInput||(re.firstInput=Ao(G)),vt>1&&!re.firstMultiple?re.firstMultiple=Ao(G):1===vt&&(re.firstMultiple=!1);var Zt=re.firstInput,Gn=re.firstMultiple,Zr=Gn?Gn.center:Zt.center,Xr=G.center=Oa(ve);G.timeStamp=$(),G.deltaTime=G.timeStamp-Zt.timeStamp,G.angle=Aa(Zr,Xr),G.distance=Qa(Zr,Xr),function Ad(N,G){var re=G.center,ve=N.offsetDelta||{},vt=N.prevDelta||{},Zt=N.prevInput||{};(G.eventType===jn||Zt.eventType===ui)&&(vt=N.prevDelta={x:Zt.deltaX||0,y:Zt.deltaY||0},ve=N.offsetDelta={x:re.x,y:re.y}),G.deltaX=vt.x+(re.x-ve.x),G.deltaY=vt.y+(re.y-ve.y)}(re,G),G.offsetDirection=Ka(G.deltaX,G.deltaY);var Wt=cc(G.deltaTime,G.deltaX,G.deltaY);G.overallVelocityX=Wt.x,G.overallVelocityY=Wt.y,G.overallVelocity=H(Wt.x)>H(Wt.y)?Wt.x:Wt.y,G.scale=Gn?function dc(N,G){return Qa(G[0],G[1],lr)/Qa(N[0],N[1],lr)}(Gn.pointers,ve):1,G.rotation=Gn?function uc(N,G){return Aa(G[1],G[0],lr)+Aa(N[1],N[0],lr)}(Gn.pointers,ve):0,G.maxPointers=re.prevInput?G.pointers.length>re.prevInput.maxPointers?G.pointers.length:re.prevInput.maxPointers:G.pointers.length,function Da(N,G){var vt,Zt,Gn,Zr,re=N.lastInterval||G,ve=G.timeStamp-re.timeStamp;if(G.eventType!=Ui&&(ve>pi||re.velocity===K)){var Xr=G.deltaX-re.deltaX,Wt=G.deltaY-re.deltaY,Vs=cc(ve,Xr,Wt);Zt=Vs.x,Gn=Vs.y,vt=H(Vs.x)>H(Vs.y)?Vs.x:Vs.y,Zr=Ka(Xr,Wt),N.lastInterval=G}else vt=re.velocity,Zt=re.velocityX,Gn=re.velocityY,Zr=re.direction;G.velocity=vt,G.velocityX=Zt,G.velocityY=Gn,G.direction=Zr}(re,G);var Vs=N.element;Gt(G.srcEvent.target,Vs)&&(Vs=G.srcEvent.target),G.target=Vs}(N,re),N.emit("hammer.input",re),N.recognize(re),N.session.prevInput=re}function Ao(N){for(var G=[],re=0;re<N.pointers.length;)G[re]={clientX:Q(N.pointers[re].clientX),clientY:Q(N.pointers[re].clientY)},re++;return{timeStamp:$(),pointers:G,center:Oa(G),deltaX:N.deltaX,deltaY:N.deltaY}}function Oa(N){var G=N.length;if(1===G)return{x:Q(N[0].clientX),y:Q(N[0].clientY)};for(var re=0,ve=0,vt=0;vt<G;)re+=N[vt].clientX,ve+=N[vt].clientY,vt++;return{x:Q(re/G),y:Q(ve/G)}}function cc(N,G,re){return{x:G/N||0,y:re/N||0}}function Ka(N,G){return N===G?Rt:H(N)>=H(G)?N<0?pn:ln:G<0?dn:qn}function Qa(N,G,re){re||(re=so);var ve=G[re[0]]-N[re[0]],vt=G[re[1]]-N[re[1]];return Math.sqrt(ve*ve+vt*vt)}function Aa(N,G,re){return re||(re=so),180*Math.atan2(G[re[1]]-N[re[1]],G[re[0]]-N[re[0]])/Math.PI}Vr.prototype={handler:function(){},init:function(){this.evEl&&Ee(this.element,this.evEl,this.domHandler),this.evTarget&&Ee(this.target,this.evTarget,this.domHandler),this.evWin&&Ee(zn(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&Tt(this.element,this.evEl,this.domHandler),this.evTarget&&Tt(this.target,this.evTarget,this.domHandler),this.evWin&&Tt(zn(this.element),this.evWin,this.domHandler)}};var Bl={mousedown:jn,mousemove:2,mouseup:ui},hc="mousedown",jc="mousemove mouseup";function Gc(){this.evEl=hc,this.evWin=jc,this.pressed=!1,Vr.apply(this,arguments)}ot(Gc,Vr,{handler:function(G){var re=Bl[G.type];re&jn&&0===G.button&&(this.pressed=!0),2&re&&1!==G.which&&(re=ui),this.pressed&&(re&ui&&(this.pressed=!1),this.callback(this.manager,re,{pointers:[G],changedPointers:[G],pointerType:Kt,srcEvent:G}))}});var Ls={pointerdown:jn,pointermove:2,pointerup:ui,pointercancel:Ui,pointerout:Ui},Wc={2:na,3:"pen",4:Kt,5:"kinect"},kd="pointerdown",$c="pointermove pointerup pointercancel";function Zi(){this.evEl=kd,this.evWin=$c,Vr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}A.MSPointerEvent&&!A.PointerEvent&&(kd="MSPointerDown",$c="MSPointerMove MSPointerUp MSPointerCancel"),ot(Zi,Vr,{handler:function(G){var re=this.store,ve=!1,vt=G.type.toLowerCase().replace("ms",""),Zt=Ls[vt],Gn=Wc[G.pointerType]||G.pointerType,Zr=Gn==na,Xr=Vt(re,G.pointerId,"pointerId");Zt&jn&&(0===G.button||Zr)?Xr<0&&(re.push(G),Xr=re.length-1):Zt&(ui|Ui)&&(ve=!0),!(Xr<0)&&(re[Xr]=G,this.callback(this.manager,Zt,{pointers:re,changedPointers:[G],pointerType:Gn,srcEvent:G}),ve&&re.splice(Xr,1))}});var Pd={touchstart:jn,touchmove:2,touchend:ui,touchcancel:Ui};function Nd(){this.evTarget="touchstart",this.evWin="touchstart touchmove touchend touchcancel",this.started=!1,Vr.apply(this,arguments)}function ra(N,G){var re=un(N.touches),ve=un(N.changedTouches);return G&(ui|Ui)&&(re=wt(re.concat(ve),"identifier",!0)),[re,ve]}ot(Nd,Vr,{handler:function(G){var re=Pd[G.type];if(re===jn&&(this.started=!0),this.started){var ve=ra.call(this,G,re);re&(ui|Ui)&&ve[0].length-ve[1].length==0&&(this.started=!1),this.callback(this.manager,re,{pointers:ve[0],changedPointers:ve[1],pointerType:na,srcEvent:G})}}});var Rd={touchstart:jn,touchmove:2,touchend:ui,touchcancel:Ui},Yc="touchstart touchmove touchend touchcancel";function fc(){this.evTarget=Yc,this.targetIds={},Vr.apply(this,arguments)}function ko(N,G){var re=un(N.touches),ve=this.targetIds;if(G&(2|jn)&&1===re.length)return ve[re[0].identifier]=!0,[re,re];var vt,Zt,Gn=un(N.changedTouches),Zr=[],Xr=this.target;if(Zt=re.filter(function(Wt){return Gt(Wt.target,Xr)}),G===jn)for(vt=0;vt<Zt.length;)ve[Zt[vt].identifier]=!0,vt++;for(vt=0;vt<Gn.length;)ve[Gn[vt].identifier]&&Zr.push(Gn[vt]),G&(ui|Ui)&&delete ve[Gn[vt].identifier],vt++;return Zr.length?[wt(Zt.concat(Zr),"identifier",!0),Zr]:void 0}ot(fc,Vr,{handler:function(G){var re=Rd[G.type],ve=ko.call(this,G,re);ve&&this.callback(this.manager,re,{pointers:ve[0],changedPointers:ve[1],pointerType:na,srcEvent:G})}});var mo=2500;function jo(){Vr.apply(this,arguments);var N=rt(this.handler,this);this.touch=new fc(this.manager,N),this.mouse=new Gc(this.manager,N),this.primaryTouch=null,this.lastTouches=[]}function Op(N,G){N&jn?(this.primaryTouch=G.changedPointers[0].identifier,Pu.call(this,G)):N&(ui|Ui)&&Pu.call(this,G)}function Pu(N){var G=N.changedPointers[0];if(G.identifier===this.primaryTouch){var re={x:G.clientX,y:G.clientY};this.lastTouches.push(re);var ve=this.lastTouches;setTimeout(function(){var Zt=ve.indexOf(re);Zt>-1&&ve.splice(Zt,1)},mo)}}function it(N){for(var G=N.srcEvent.clientX,re=N.srcEvent.clientY,ve=0;ve<this.lastTouches.length;ve++){var vt=this.lastTouches[ve],Zt=Math.abs(G-vt.x),Gn=Math.abs(re-vt.y);if(Zt<=25&&Gn<=25)return!0}return!1}ot(jo,Vr,{handler:function(G,re,ve){var Zt=ve.pointerType==Kt;if(!(Zt&&ve.sourceCapabilities&&ve.sourceCapabilities.firesTouchEvents)){if(ve.pointerType==na)Op.call(this,re,ve);else if(Zt&&it.call(this,ve))return;this.callback(G,re,ve)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Ja=Bt(W.style,"touchAction"),pc=Ja!==K,qc="compute",Bd="manipulation",ka="none",Go="pan-x",Bs="pan-y",oa=function Us(){if(!pc)return!1;var N={},G=A.CSS&&A.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(re){N[re]=!G||A.CSS.supports("touch-action",re)}),N}();function bs(N,G){this.manager=N,this.set(G)}bs.prototype={set:function(N){N==qc&&(N=this.compute()),pc&&this.manager.element.style&&oa[N]&&(this.manager.element.style[Ja]=N),this.actions=N.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var N=[];return de(this.manager.recognizers,function(G){qe(G.options.enable,[G])&&(N=N.concat(G.getTouchAction()))}),function Fu(N){if(Et(N,ka))return ka;var G=Et(N,Go),re=Et(N,Bs);return G&&re?ka:G||re?G?Go:Bs:Et(N,Bd)?Bd:"auto"}(N.join(" "))},preventDefaults:function(N){var G=N.srcEvent,re=N.offsetDirection;if(!this.manager.session.prevented){var ve=this.actions,vt=Et(ve,ka)&&!oa[ka],Zt=Et(ve,Bs)&&!oa[Bs],Gn=Et(ve,Go)&&!oa[Go];if(vt&&1===N.pointers.length&&N.distance<2&&N.deltaTime<250)return;return Gn&&Zt||!(vt||Zt&&re&wi||Gn&&re&ar)?void 0:this.preventSrc(G)}G.preventDefault()},preventSrc:function(N){this.manager.session.prevented=!0,N.preventDefault()}};var Hs=1;function Si(N){this.options=Je({},this.defaults,N||{}),this.id=function Ht(){return Ut++}(),this.manager=null,this.options.enable=ct(this.options.enable,!0),this.state=Hs,this.simultaneous={},this.requireFail=[]}function Zc(N){return 16&N?"cancel":8&N?"end":4&N?"move":2&N?"start":""}function sf(N){return N==qn?"down":N==dn?"up":N==pn?"left":N==ln?"right":""}function j(N,G){var re=G.manager;return re?re.get(N):N}function ne(){Si.apply(this,arguments)}function V(){ne.apply(this,arguments),this.pX=null,this.pY=null}function we(){ne.apply(this,arguments)}function Te(){Si.apply(this,arguments),this._timer=null,this._input=null}function xe(){ne.apply(this,arguments)}function at(){ne.apply(this,arguments)}function bt(){Si.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function mt(N,G){return(G=G||{}).recognizers=ct(G.recognizers,mt.defaults.preset),new tn(N,G)}function tn(N,G){this.options=Je({},mt.defaults,G||{}),this.options.inputTarget=this.options.inputTarget||N,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=N,this.input=function ia(N){return new(N.options.inputClass||(xi?Zi:Rl?fc:Ar?jo:Gc))(N,Od)}(this),this.touchAction=new bs(this,this.options.touchAction),Zn(this,!0),de(this.options.recognizers,function(re){var ve=this.add(new re[0](re[1]));re[2]&&ve.recognizeWith(re[2]),re[3]&&ve.requireFailure(re[3])},this)}function Zn(N,G){var ve,re=N.element;re.style&&(de(N.options.cssProps,function(vt,Zt){ve=Bt(re.style,Zt),G?(N.oldCssProps[ve]=re.style[ve],re.style[ve]=vt):re.style[ve]=N.oldCssProps[ve]||""}),G||(N.oldCssProps={}))}Si.prototype={defaults:{},set:function(N){return Je(this.options,N),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(N){if(ye(N,"recognizeWith",this))return this;var G=this.simultaneous;return G[(N=j(N,this)).id]||(G[N.id]=N,N.recognizeWith(this)),this},dropRecognizeWith:function(N){return ye(N,"dropRecognizeWith",this)||(N=j(N,this),delete this.simultaneous[N.id]),this},requireFailure:function(N){if(ye(N,"requireFailure",this))return this;var G=this.requireFail;return-1===Vt(G,N=j(N,this))&&(G.push(N),N.requireFailure(this)),this},dropRequireFailure:function(N){if(ye(N,"dropRequireFailure",this))return this;N=j(N,this);var G=Vt(this.requireFail,N);return G>-1&&this.requireFail.splice(G,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(N){return!!this.simultaneous[N.id]},emit:function(N){var G=this,re=this.state;function ve(vt){G.manager.emit(vt,N)}re<8&&ve(G.options.event+Zc(re)),ve(G.options.event),N.additionalEvent&&ve(N.additionalEvent),re>=8&&ve(G.options.event+Zc(re))},tryEmit:function(N){if(this.canEmit())return this.emit(N);this.state=32},canEmit:function(){for(var N=0;N<this.requireFail.length;){if(!(this.requireFail[N].state&(32|Hs)))return!1;N++}return!0},recognize:function(N){var G=Je({},N);if(!qe(this.options.enable,[this,G]))return this.reset(),void(this.state=32);56&this.state&&(this.state=Hs),this.state=this.process(G),30&this.state&&this.tryEmit(G)},process:function(N){},getTouchAction:function(){},reset:function(){}},ot(ne,Si,{defaults:{pointers:1},attrTest:function(N){var G=this.options.pointers;return 0===G||N.pointers.length===G},process:function(N){var G=this.state,re=N.eventType,ve=6&G,vt=this.attrTest(N);return ve&&(re&Ui||!vt)?16|G:ve||vt?re&ui?8|G:2&G?4|G:2:32}}),ot(V,ne,{defaults:{event:"pan",threshold:10,pointers:1,direction:qr},getTouchAction:function(){var N=this.options.direction,G=[];return N&wi&&G.push(Bs),N&ar&&G.push(Go),G},directionTest:function(N){var G=this.options,re=!0,ve=N.distance,vt=N.direction,Zt=N.deltaX,Gn=N.deltaY;return vt&G.direction||(G.direction&wi?(vt=0===Zt?Rt:Zt<0?pn:ln,re=Zt!=this.pX,ve=Math.abs(N.deltaX)):(vt=0===Gn?Rt:Gn<0?dn:qn,re=Gn!=this.pY,ve=Math.abs(N.deltaY))),N.direction=vt,re&&ve>G.threshold&&vt&G.direction},attrTest:function(N){return ne.prototype.attrTest.call(this,N)&&(2&this.state||!(2&this.state)&&this.directionTest(N))},emit:function(N){this.pX=N.deltaX,this.pY=N.deltaY;var G=sf(N.direction);G&&(N.additionalEvent=this.options.event+G),this._super.emit.call(this,N)}}),ot(we,ne,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[ka]},attrTest:function(N){return this._super.attrTest.call(this,N)&&(Math.abs(N.scale-1)>this.options.threshold||2&this.state)},emit:function(N){1!==N.scale&&(N.additionalEvent=this.options.event+(N.scale<1?"in":"out")),this._super.emit.call(this,N)}}),ot(Te,Si,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(N){var G=this.options,re=N.pointers.length===G.pointers,ve=N.distance<G.threshold,vt=N.deltaTime>G.time;if(this._input=N,!ve||!re||N.eventType&(ui|Ui)&&!vt)this.reset();else if(N.eventType&jn)this.reset(),this._timer=he(function(){this.state=8,this.tryEmit()},G.time,this);else if(N.eventType&ui)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(N){8===this.state&&(N&&N.eventType&ui?this.manager.emit(this.options.event+"up",N):(this._input.timeStamp=$(),this.manager.emit(this.options.event,this._input)))}}),ot(xe,ne,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[ka]},attrTest:function(N){return this._super.attrTest.call(this,N)&&(Math.abs(N.rotation)>this.options.threshold||2&this.state)}}),ot(at,ne,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:wi|ar,pointers:1},getTouchAction:function(){return V.prototype.getTouchAction.call(this)},attrTest:function(N){var re,G=this.options.direction;return G&(wi|ar)?re=N.overallVelocity:G&wi?re=N.overallVelocityX:G&ar&&(re=N.overallVelocityY),this._super.attrTest.call(this,N)&&G&N.offsetDirection&&N.distance>this.options.threshold&&N.maxPointers==this.options.pointers&&H(re)>this.options.velocity&&N.eventType&ui},emit:function(N){var G=sf(N.offsetDirection);G&&this.manager.emit(this.options.event+G,N),this.manager.emit(this.options.event,N)}}),ot(bt,Si,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Bd]},process:function(N){var G=this.options,re=N.pointers.length===G.pointers,ve=N.distance<G.threshold,vt=N.deltaTime<G.time;if(this.reset(),N.eventType&jn&&0===this.count)return this.failTimeout();if(ve&&vt&&re){if(N.eventType!=ui)return this.failTimeout();var Zt=!this.pTime||N.timeStamp-this.pTime<G.interval,Gn=!this.pCenter||Qa(this.pCenter,N.center)<G.posThreshold;if(this.pTime=N.timeStamp,this.pCenter=N.center,Gn&&Zt?this.count+=1:this.count=1,this._input=N,0==this.count%G.taps)return this.hasRequireFailures()?(this._timer=he(function(){this.state=8,this.tryEmit()},G.interval,this),2):8}return 32},failTimeout:function(){return this._timer=he(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),mt.VERSION="2.0.7",mt.defaults={domEvents:!1,touchAction:qc,enable:!0,inputTarget:null,inputClass:null,preset:[[xe,{enable:!1}],[we,{enable:!1},["rotate"]],[at,{direction:wi}],[V,{direction:wi},["swipe"]],[bt],[bt,{event:"doubletap",taps:2},["tap"]],[Te]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},tn.prototype={set:function(N){return Je(this.options,N),N.touchAction&&this.touchAction.update(),N.inputTarget&&(this.input.destroy(),this.input.target=N.inputTarget,this.input.init()),this},stop:function(N){this.session.stopped=N?2:1},recognize:function(N){var G=this.session;if(!G.stopped){this.touchAction.preventDefaults(N);var re,ve=this.recognizers,vt=G.curRecognizer;(!vt||vt&&8&vt.state)&&(vt=G.curRecognizer=null);for(var Zt=0;Zt<ve.length;)re=ve[Zt],2===G.stopped||vt&&re!=vt&&!re.canRecognizeWith(vt)?re.reset():re.recognize(N),!vt&&14&re.state&&(vt=G.curRecognizer=re),Zt++}},get:function(N){if(N instanceof Si)return N;for(var G=this.recognizers,re=0;re<G.length;re++)if(G[re].options.event==N)return G[re];return null},add:function(N){if(ye(N,"add",this))return this;var G=this.get(N.options.event);return G&&this.remove(G),this.recognizers.push(N),N.manager=this,this.touchAction.update(),N},remove:function(N){if(ye(N,"remove",this))return this;if(N=this.get(N)){var G=this.recognizers,re=Vt(G,N);-1!==re&&(G.splice(re,1),this.touchAction.update())}return this},on:function(N,G){if(N!==K&&G!==K){var re=this.handlers;return de(_t(N),function(ve){re[ve]=re[ve]||[],re[ve].push(G)}),this}},off:function(N,G){if(N!==K){var re=this.handlers;return de(_t(N),function(ve){G?re[ve]&&re[ve].splice(Vt(re[ve],G),1):delete re[ve]}),this}},emit:function(N,G){this.options.domEvents&&function gi(N,G){var re=oe.createEvent("Event");re.initEvent(N,!0,!0),re.gesture=G,G.target.dispatchEvent(re)}(N,G);var re=this.handlers[N]&&this.handlers[N].slice();if(re&&re.length){G.type=N,G.preventDefault=function(){G.srcEvent.preventDefault()};for(var ve=0;ve<re.length;)re[ve](G),ve++}},destroy:function(){this.element&&Zn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},Je(mt,{INPUT_START:jn,INPUT_MOVE:2,INPUT_END:ui,INPUT_CANCEL:Ui,STATE_POSSIBLE:Hs,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:Rt,DIRECTION_LEFT:pn,DIRECTION_RIGHT:ln,DIRECTION_UP:dn,DIRECTION_DOWN:qn,DIRECTION_HORIZONTAL:wi,DIRECTION_VERTICAL:ar,DIRECTION_ALL:qr,Manager:tn,Input:Vr,TouchAction:bs,TouchInput:fc,MouseInput:Gc,PointerEventInput:Zi,TouchMouseInput:jo,SingleTouchInput:Nd,Recognizer:Si,AttrRecognizer:ne,Tap:bt,Pan:V,Swipe:at,Pinch:we,Rotate:xe,Press:Te,on:Ee,off:Tt,each:de,merge:Ae,extend:Lt,assign:Je,inherit:ot,bindFn:rt,prefixed:Bt}),(typeof A<"u"?A:typeof self<"u"?self:{}).Hammer=mt,(R=function(){return mt}.call(Fe,me,Fe,Nt))!==K&&(Nt.exports=R)}(window,document)},2020:(Nt,Fe)=>{Fe.read=function(me,R,A,oe,te){var K,q,W=8*te-oe-1,ie=(1<<W)-1,Q=ie>>1,H=-7,$=A?te-1:0,he=A?-1:1,ye=me[R+$];for($+=he,K=ye&(1<<-H)-1,ye>>=-H,H+=W;H>0;K=256*K+me[R+$],$+=he,H-=8);for(q=K&(1<<-H)-1,K>>=-H,H+=oe;H>0;q=256*q+me[R+$],$+=he,H-=8);if(0===K)K=1-Q;else{if(K===ie)return q?NaN:1/0*(ye?-1:1);q+=Math.pow(2,oe),K-=Q}return(ye?-1:1)*q*Math.pow(2,K-oe)},Fe.write=function(me,R,A,oe,te,K){var q,W,ie,Q=8*K-te-1,H=(1<<Q)-1,$=H>>1,he=23===te?Math.pow(2,-24)-Math.pow(2,-77):0,ye=oe?0:K-1,de=oe?1:-1,Ve=R<0||0===R&&1/R<0?1:0;for(R=Math.abs(R),isNaN(R)||R===1/0?(W=isNaN(R)?1:0,q=H):(q=Math.floor(Math.log(R)/Math.LN2),R*(ie=Math.pow(2,-q))<1&&(q--,ie*=2),(R+=q+$>=1?he/ie:he*Math.pow(2,1-$))*ie>=2&&(q++,ie/=2),q+$>=H?(W=0,q=H):q+$>=1?(W=(R*ie-1)*Math.pow(2,te),q+=$):(W=R*Math.pow(2,$-1)*Math.pow(2,te),q=0));te>=8;me[A+ye]=255&W,ye+=de,W/=256,te-=8);for(q=q<<te|W,Q+=te;Q>0;me[A+ye]=255&q,ye+=de,q/=256,Q-=8);me[A+ye-de]|=128*Ve}},8590:function(Nt,Fe){!function(te){var ye,K="undefined",q=K!==typeof Buffer&&Buffer,W=K!==typeof Uint8Array&&Uint8Array,ie=K!==typeof ArrayBuffer&&ArrayBuffer,Q=[0,0,0,0,0,0,0,0],H=Array.isArray||function Gt(Et){return!!Et&&"[object Array]"==Object.prototype.toString.call(Et)},$=4294967296;function de(Et,_t,Vt){var un=_t?0:4,wt=_t?4:0,Bt=_t?0:3,Ut=_t?1:2,Ht=_t?2:1,zn=_t?3:0,Oo=_t?qe:Ee,Ar=_t?ct:Tt,xi=qt.prototype,Rl="is"+Et,na="_"+Rl;return xi.buffer=void 0,xi.offset=0,xi[na]=!0,xi.toNumber=jn,xi.toString=function Wi(Rt){var pn=this.buffer,ln=this.offset,dn=Ui(pn,ln+un),qn=Ui(pn,ln+wt),wi="",ar=!Vt&&2147483648&dn;for(ar&&(dn=~dn,qn=$-qn),Rt=Rt||10;;){var qr=dn%Rt*$+qn;if(dn=Math.floor(dn/Rt),qn=Math.floor(qr/Rt),wi=(qr%Rt).toString(Rt)+wi,!dn&&!qn)break}return ar&&(wi="-"+wi),wi},xi.toJSON=jn,xi.toArray=Ve,q&&(xi.toBuffer=Je),W&&(xi.toArrayBuffer=Lt),qt[Rl]=function Kt(Rt){return!(!Rt||!Rt[na])},te[Et]=qt,qt;function qt(Rt,pn,ln,dn){return this instanceof qt?function nn(Rt,pn,ln,dn,qn){W&&ie&&(pn instanceof ie&&(pn=new W(pn)),dn instanceof ie&&(dn=new W(dn))),pn||ln||dn||ye?(Ae(pn,ln)||(qn=ln,dn=pn,ln=0,pn=new(ye||Array)(8)),Rt.buffer=pn,Rt.offset=ln|=0,K!==typeof dn&&("string"==typeof dn?function pi(Rt,pn,ln,dn){var qn=0,wi=ln.length,ar=0,qr=0;"-"===ln[0]&&qn++;for(var so=qn;qn<wi;){var lr=parseInt(ln[qn++],dn);if(!(lr>=0))break;qr=qr*dn+lr,ar=ar*dn+Math.floor(qr/$),qr%=$}so&&(ar=~ar,qr?qr=$-qr:ar++),ui(Rt,pn+un,ar),ui(Rt,pn+wt,qr)}(pn,ln,dn,qn||10):Ae(dn,qn)?ot(pn,ln,dn,qn):"number"==typeof qn?(ui(pn,ln+un,dn),ui(pn,ln+wt,qn)):dn>0?Oo(pn,ln,dn):dn<0?Ar(pn,ln,dn):ot(pn,ln,Q,0))):Rt.buffer=rt(Q,0)}(this,Rt,pn,ln,dn):new qt(Rt,pn,ln,dn)}function jn(){var Rt=this.buffer,pn=this.offset,ln=Ui(Rt,pn+un),dn=Ui(Rt,pn+wt);return Vt||(ln|=0),ln?ln*$+dn:dn}function ui(Rt,pn,ln){Rt[pn+zn]=255&ln,Rt[pn+Ht]=255&(ln>>=8),Rt[pn+Ut]=255&(ln>>=8),Rt[pn+Bt]=255&(ln>>=8)}function Ui(Rt,pn){return 16777216*Rt[pn+Bt]+(Rt[pn+Ut]<<16)+(Rt[pn+Ht]<<8)+Rt[pn+zn]}}function Ve(Et){var _t=this.buffer,Vt=this.offset;return ye=null,!1!==Et&&0===Vt&&8===_t.length&&H(_t)?_t:rt(_t,Vt)}function Je(Et){var _t=this.buffer,Vt=this.offset;if(ye=q,!1!==Et&&0===Vt&&8===_t.length&&Buffer.isBuffer(_t))return _t;var un=new q(8);return ot(un,0,_t,Vt),un}function Lt(Et){var _t=this.buffer,Vt=this.offset,un=_t.buffer;if(ye=W,!1!==Et&&0===Vt&&un instanceof ie&&8===un.byteLength)return un;var wt=new W(8);return ot(wt,0,_t,Vt),wt.buffer}function Ae(Et,_t){var Vt=Et&&Et.length;return _t|=0,Vt&&_t+8<=Vt&&"string"!=typeof Et[_t]}function ot(Et,_t,Vt,un){_t|=0,un|=0;for(var wt=0;wt<8;wt++)Et[_t++]=255&Vt[un++]}function rt(Et,_t){return Array.prototype.slice.call(Et,_t,_t+8)}function qe(Et,_t,Vt){for(var un=_t+8;un>_t;)Et[--un]=255&Vt,Vt/=256}function ct(Et,_t,Vt){var un=_t+8;for(Vt++;un>_t;)Et[--un]=255&-Vt^255,Vt/=256}function Ee(Et,_t,Vt){for(var un=_t+8;_t<un;)Et[_t++]=255&Vt,Vt/=256}function Tt(Et,_t,Vt){var un=_t+8;for(Vt++;_t<un;)Et[_t++]=255&-Vt^255,Vt/=256}de("Uint64BE",!0,!0),de("Int64BE",!0,!1),de("Uint64LE",!1,!0),de("Int64LE",!1,!1)}("string"!=typeof Fe.nodeName?Fe:this||{})},53:Nt=>{var Fe={}.toString;Nt.exports=Array.isArray||function(me){return"[object Array]"==Fe.call(me)}},119:Nt=>{Nt.exports=function A(oe,te,K){function q(Q,H){if(!te[Q]){if(!oe[Q]){if(W)return W(Q,!0);var he=new Error("Cannot find module '"+Q+"'");throw he.code="MODULE_NOT_FOUND",he}var ye=te[Q]={exports:{}};oe[Q][0].call(ye.exports,function(de){return q(oe[Q][1][de]||de)},ye,ye.exports,A,oe,te,K)}return te[Q].exports}for(var W=void 0,ie=0;ie<K.length;ie++)q(K[ie]);return q}({1:[function(A,oe,te){(function(K){"use strict";var W,q=K.MutationObserver||K.WebKitMutationObserver;if(q){var ie=0,Q=new q(de),H=K.document.createTextNode("");Q.observe(H,{characterData:!0}),W=function(){H.data=ie=++ie%2}}else if(!K.setImmediate&&typeof K.MessageChannel<"u"){var $=new K.MessageChannel;$.port1.onmessage=de,W=function(){$.port2.postMessage(0)}}else W="document"in K&&"onreadystatechange"in K.document.createElement("script")?function(){var Je=K.document.createElement("script");Je.onreadystatechange=function(){de(),Je.onreadystatechange=null,Je.parentNode.removeChild(Je),Je=null},K.document.documentElement.appendChild(Je)}:function(){setTimeout(de,0)};var he,ye=[];function de(){he=!0;for(var Je,Lt,Ae=ye.length;Ae;){for(Lt=ye,ye=[],Je=-1;++Je<Ae;)Lt[Je]();Ae=ye.length}he=!1}oe.exports=function Ve(Je){1===ye.push(Je)&&!he&&W()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(A,oe,te){"use strict";var K=A(1);function q(){}var W={},ie=["REJECTED"],Q=["FULFILLED"],H=["PENDING"];function $(qe){if("function"!=typeof qe)throw new TypeError("resolver must be a function");this.state=H,this.queue=[],this.outcome=void 0,qe!==q&&Ve(this,qe)}function he(qe,ct,Ee){this.promise=qe,"function"==typeof ct&&(this.onFulfilled=ct,this.callFulfilled=this.otherCallFulfilled),"function"==typeof Ee&&(this.onRejected=Ee,this.callRejected=this.otherCallRejected)}function ye(qe,ct,Ee){K(function(){var Tt;try{Tt=ct(Ee)}catch(Gt){return W.reject(qe,Gt)}Tt===qe?W.reject(qe,new TypeError("Cannot resolve promise with itself")):W.resolve(qe,Tt)})}function de(qe){var ct=qe&&qe.then;if(qe&&("object"==typeof qe||"function"==typeof qe)&&"function"==typeof ct)return function(){ct.apply(qe,arguments)}}function Ve(qe,ct){var Ee=!1;function Tt(Vt){Ee||(Ee=!0,W.reject(qe,Vt))}function Gt(Vt){Ee||(Ee=!0,W.resolve(qe,Vt))}var _t=Je(function Et(){ct(Gt,Tt)});"error"===_t.status&&Tt(_t.value)}function Je(qe,ct){var Ee={};try{Ee.value=qe(ct),Ee.status="success"}catch(Tt){Ee.status="error",Ee.value=Tt}return Ee}oe.exports=$,$.prototype.catch=function(qe){return this.then(null,qe)},$.prototype.then=function(qe,ct){if("function"!=typeof qe&&this.state===Q||"function"!=typeof ct&&this.state===ie)return this;var Ee=new this.constructor(q);return this.state!==H?ye(Ee,this.state===Q?qe:ct,this.outcome):this.queue.push(new he(Ee,qe,ct)),Ee},he.prototype.callFulfilled=function(qe){W.resolve(this.promise,qe)},he.prototype.otherCallFulfilled=function(qe){ye(this.promise,this.onFulfilled,qe)},he.prototype.callRejected=function(qe){W.reject(this.promise,qe)},he.prototype.otherCallRejected=function(qe){ye(this.promise,this.onRejected,qe)},W.resolve=function(qe,ct){var Ee=Je(de,ct);if("error"===Ee.status)return W.reject(qe,Ee.value);var Tt=Ee.value;if(Tt)Ve(qe,Tt);else{qe.state=Q,qe.outcome=ct;for(var Gt=-1,Et=qe.queue.length;++Gt<Et;)qe.queue[Gt].callFulfilled(ct)}return qe},W.reject=function(qe,ct){qe.state=ie,qe.outcome=ct;for(var Ee=-1,Tt=qe.queue.length;++Ee<Tt;)qe.queue[Ee].callRejected(ct);return qe},$.resolve=function Lt(qe){return qe instanceof this?qe:W.resolve(new this(q),qe)},$.reject=function Ae(qe){var ct=new this(q);return W.reject(ct,qe)},$.all=function ot(qe){var ct=this;if("[object Array]"!==Object.prototype.toString.call(qe))return this.reject(new TypeError("must be an array"));var Ee=qe.length,Tt=!1;if(!Ee)return this.resolve([]);for(var Gt=new Array(Ee),Et=0,_t=-1,Vt=new this(q);++_t<Ee;)un(qe[_t],_t);return Vt;function un(wt,Bt){ct.resolve(wt).then(function Ut(Ht){Gt[Bt]=Ht,++Et===Ee&&!Tt&&(Tt=!0,W.resolve(Vt,Gt))},function(Ht){Tt||(Tt=!0,W.reject(Vt,Ht))})}},$.race=function rt(qe){var ct=this;if("[object Array]"!==Object.prototype.toString.call(qe))return this.reject(new TypeError("must be an array"));var Ee=qe.length,Tt=!1;if(!Ee)return this.resolve([]);for(var Gt=-1,Et=new this(q);++Gt<Ee;)ct.resolve(qe[Gt]).then(function(un){Tt||(Tt=!0,W.resolve(Et,un))},function(un){Tt||(Tt=!0,W.reject(Et,un))});return Et}},{1:1}],3:[function(A,oe,te){(function(K){"use strict";"function"!=typeof K.Promise&&(K.Promise=A(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(A,oe,te){"use strict";var K="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(j){return typeof j}:function(j){return j&&"function"==typeof Symbol&&j.constructor===Symbol&&j!==Symbol.prototype?"symbol":typeof j};var ie=function W(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function H(j,ne){j=j||[],ne=ne||{};try{return new Blob(j,ne)}catch(xe){if("TypeError"!==xe.name)throw xe;for(var we=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),Te=0;Te<j.length;Te+=1)we.append(j[Te]);return we.getBlob(ne.type)}}typeof Promise>"u"&&A(3);var $=Promise;function he(j,ne){ne&&j.then(function(V){ne(null,V)},function(V){ne(V)})}function ye(j,ne,V){"function"==typeof ne&&j.then(ne),"function"==typeof V&&j.catch(V)}function de(j){return"string"!=typeof j&&(console.warn(j+" used as a key, but it is not a string."),j=String(j)),j}function Ve(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var Je="local-forage-detect-blob-support",Lt=void 0,Ae={},ot=Object.prototype.toString,rt="readonly",qe="readwrite";function ct(j){for(var ne=j.length,V=new ArrayBuffer(ne),we=new Uint8Array(V),Te=0;Te<ne;Te++)we[Te]=j.charCodeAt(Te);return V}function Tt(j){return"boolean"==typeof Lt?$.resolve(Lt):function Ee(j){return new $(function(ne){var V=j.transaction(Je,qe),we=H([""]);V.objectStore(Je).put(we,"key"),V.onabort=function(Te){Te.preventDefault(),Te.stopPropagation(),ne(!1)},V.oncomplete=function(){var Te=navigator.userAgent.match(/Chrome\/(\d+)/),xe=navigator.userAgent.match(/Edge\//);ne(xe||!Te||parseInt(Te[1],10)>=43)}}).catch(function(){return!1})}(j).then(function(ne){return Lt=ne})}function Gt(j){var ne=Ae[j.name],V={};V.promise=new $(function(we,Te){V.resolve=we,V.reject=Te}),ne.deferredOperations.push(V),ne.dbReady=ne.dbReady?ne.dbReady.then(function(){return V.promise}):V.promise}function Et(j){var V=Ae[j.name].deferredOperations.pop();if(V)return V.resolve(),V.promise}function _t(j,ne){var we=Ae[j.name].deferredOperations.pop();if(we)return we.reject(ne),we.promise}function Vt(j,ne){return new $(function(V,we){if(Ae[j.name]=Ae[j.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},j.db){if(!ne)return V(j.db);Gt(j),j.db.close()}var Te=[j.name];ne&&Te.push(j.version);var xe=ie.open.apply(ie,Te);ne&&(xe.onupgradeneeded=function(at){var bt=xe.result;try{bt.createObjectStore(j.storeName),at.oldVersion<=1&&bt.createObjectStore(Je)}catch(mt){if("ConstraintError"!==mt.name)throw mt;console.warn('The database "'+j.name+'" has been upgraded from version '+at.oldVersion+" to version "+at.newVersion+', but the storage "'+j.storeName+'" already exists.')}}),xe.onerror=function(at){at.preventDefault(),we(xe.error)},xe.onsuccess=function(){var at=xe.result;at.onversionchange=function(bt){bt.target.close()},V(at),Et(j)}})}function un(j){return Vt(j,!1)}function wt(j){return Vt(j,!0)}function Bt(j,ne){if(!j.db)return!0;var V=!j.db.objectStoreNames.contains(j.storeName),Te=j.version>j.db.version;if(j.version<j.db.version&&(j.version!==ne&&console.warn('The database "'+j.name+"\" can't be downgraded from version "+j.db.version+" to version "+j.version+"."),j.version=j.db.version),Te||V){if(V){var xe=j.db.version+1;xe>j.version&&(j.version=xe)}return!0}return!1}function Ht(j){return H([ct(atob(j.data))],{type:j.type})}function zn(j){return j&&j.__local_forage_encoded_blob}function Oo(j){var ne=this,V=ne._initReady().then(function(){var we=Ae[ne._dbInfo.name];if(we&&we.dbReady)return we.dbReady});return ye(V,j,j),V}function xi(j,ne,V,we){void 0===we&&(we=1);try{var Te=j.db.transaction(j.storeName,ne);V(null,Te)}catch(xe){if(we>0&&(!j.db||"InvalidStateError"===xe.name||"NotFoundError"===xe.name))return $.resolve().then(function(){if(!j.db||"NotFoundError"===xe.name&&!j.db.objectStoreNames.contains(j.storeName)&&j.version<=j.db.version)return j.db&&(j.version=j.db.version+1),wt(j)}).then(function(){return function Ar(j){Gt(j);for(var ne=Ae[j.name],V=ne.forages,we=0;we<V.length;we++){var Te=V[we];Te._dbInfo.db&&(Te._dbInfo.db.close(),Te._dbInfo.db=null)}return j.db=null,un(j).then(function(xe){return j.db=xe,Bt(j)?wt(j):xe}).then(function(xe){j.db=ne.db=xe;for(var at=0;at<V.length;at++)V[at]._dbInfo.db=xe}).catch(function(xe){throw _t(j,xe),xe})}(j).then(function(){xi(j,ne,V,we-1)})}).catch(V);V(xe)}}var pn={_driver:"asyncStorage",_initStorage:function na(j){var ne=this,V={db:null};if(j)for(var we in j)V[we]=j[we];var Te=Ae[V.name];Te||(Ae[V.name]=Te={forages:[],db:null,dbReady:null,deferredOperations:[]}),Te.forages.push(ne),ne._initReady||(ne._initReady=ne.ready,ne.ready=Oo);var xe=[];function at(){return $.resolve()}for(var bt=0;bt<Te.forages.length;bt++){var mt=Te.forages[bt];mt!==ne&&xe.push(mt._initReady().catch(at))}var Mt=Te.forages.slice(0);return $.all(xe).then(function(){return V.db=Te.db,un(V)}).then(function(kt){return V.db=kt,Bt(V,ne._defaultConfig.version)?wt(V):kt}).then(function(kt){V.db=Te.db=kt,ne._dbInfo=V;for(var tn=0;tn<Mt.length;tn++){var Zn=Mt[tn];Zn!==ne&&(Zn._dbInfo.db=V.db,Zn._dbInfo.version=V.version)}})},_support:function Q(){try{if(!ie||!ie.open)return!1;var j=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),ne="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!j||ne)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function Kt(j,ne){var V=this,we=new $(function(Te,xe){V.ready().then(function(){xi(V._dbInfo,rt,function(at,bt){if(at)return xe(at);try{var Mt=bt.objectStore(V._dbInfo.storeName).openCursor(),kt=1;Mt.onsuccess=function(){var tn=Mt.result;if(tn){var Zn=tn.value;zn(Zn)&&(Zn=Ht(Zn));var gi=j(Zn,tn.key,kt++);void 0!==gi?Te(gi):tn.continue()}else Te()},Mt.onerror=function(){xe(Mt.error)}}catch(tn){xe(tn)}})}).catch(xe)});return he(we,ne),we},getItem:function qt(j,ne){var V=this;j=de(j);var we=new $(function(Te,xe){V.ready().then(function(){xi(V._dbInfo,rt,function(at,bt){if(at)return xe(at);try{var Mt=bt.objectStore(V._dbInfo.storeName).get(j);Mt.onsuccess=function(){var kt=Mt.result;void 0===kt&&(kt=null),zn(kt)&&(kt=Ht(kt)),Te(kt)},Mt.onerror=function(){xe(Mt.error)}}catch(kt){xe(kt)}})}).catch(xe)});return he(we,ne),we},setItem:function nn(j,ne,V){var we=this;j=de(j);var Te=new $(function(xe,at){var bt;we.ready().then(function(){return bt=we._dbInfo,"[object Blob]"===ot.call(ne)?Tt(bt.db).then(function(mt){return mt?ne:function Ut(j){return new $(function(ne,V){var we=new FileReader;we.onerror=V,we.onloadend=function(Te){var xe=btoa(Te.target.result||"");ne({__local_forage_encoded_blob:!0,data:xe,type:j.type})},we.readAsBinaryString(j)})}(ne)}):ne}).then(function(mt){xi(we._dbInfo,qe,function(Mt,kt){if(Mt)return at(Mt);try{var tn=kt.objectStore(we._dbInfo.storeName);null===mt&&(mt=void 0);var Zn=tn.put(mt,j);kt.oncomplete=function(){void 0===mt&&(mt=null),xe(mt)},kt.onabort=kt.onerror=function(){at(Zn.error?Zn.error:Zn.transaction.error)}}catch(gi){at(gi)}})}).catch(at)});return he(Te,V),Te},removeItem:function pi(j,ne){var V=this;j=de(j);var we=new $(function(Te,xe){V.ready().then(function(){xi(V._dbInfo,qe,function(at,bt){if(at)return xe(at);try{var Mt=bt.objectStore(V._dbInfo.storeName).delete(j);bt.oncomplete=function(){Te()},bt.onerror=function(){xe(Mt.error)},bt.onabort=function(){xe(Mt.error?Mt.error:Mt.transaction.error)}}catch(kt){xe(kt)}})}).catch(xe)});return he(we,ne),we},clear:function jn(j){var ne=this,V=new $(function(we,Te){ne.ready().then(function(){xi(ne._dbInfo,qe,function(xe,at){if(xe)return Te(xe);try{var mt=at.objectStore(ne._dbInfo.storeName).clear();at.oncomplete=function(){we()},at.onabort=at.onerror=function(){Te(mt.error?mt.error:mt.transaction.error)}}catch(Mt){Te(Mt)}})}).catch(Te)});return he(V,j),V},length:function Wi(j){var ne=this,V=new $(function(we,Te){ne.ready().then(function(){xi(ne._dbInfo,rt,function(xe,at){if(xe)return Te(xe);try{var mt=at.objectStore(ne._dbInfo.storeName).count();mt.onsuccess=function(){we(mt.result)},mt.onerror=function(){Te(mt.error)}}catch(Mt){Te(Mt)}})}).catch(Te)});return he(V,j),V},key:function ui(j,ne){var V=this,we=new $(function(Te,xe){j<0?Te(null):V.ready().then(function(){xi(V._dbInfo,rt,function(at,bt){if(at)return xe(at);try{var mt=bt.objectStore(V._dbInfo.storeName),Mt=!1,kt=mt.openKeyCursor();kt.onsuccess=function(){var tn=kt.result;tn?0===j||Mt?Te(tn.key):(Mt=!0,tn.advance(j)):Te(null)},kt.onerror=function(){xe(kt.error)}}catch(tn){xe(tn)}})}).catch(xe)});return he(we,ne),we},keys:function Ui(j){var ne=this,V=new $(function(we,Te){ne.ready().then(function(){xi(ne._dbInfo,rt,function(xe,at){if(xe)return Te(xe);try{var mt=at.objectStore(ne._dbInfo.storeName).openKeyCursor(),Mt=[];mt.onsuccess=function(){var kt=mt.result;kt?(Mt.push(kt.key),kt.continue()):we(Mt)},mt.onerror=function(){Te(mt.error)}}catch(kt){Te(kt)}})}).catch(Te)});return he(V,j),V},dropInstance:function Rt(j,ne){ne=Ve.apply(this,arguments);var Te,V=this.config();return(j="function"!=typeof j&&j||{}).name||(j.name=j.name||V.name,j.storeName=j.storeName||V.storeName),he(Te=j.name?(j.name===V.name&&this._dbInfo.db?$.resolve(this._dbInfo.db):un(j).then(function(bt){var mt=Ae[j.name],Mt=mt.forages;mt.db=bt;for(var kt=0;kt<Mt.length;kt++)Mt[kt]._dbInfo.db=bt;return bt})).then(j.storeName?function(bt){if(bt.objectStoreNames.contains(j.storeName)){var mt=bt.version+1;Gt(j);var Mt=Ae[j.name],kt=Mt.forages;bt.close();for(var tn=0;tn<kt.length;tn++){var Zn=kt[tn];Zn._dbInfo.db=null,Zn._dbInfo.version=mt}return new $(function(Ei,N){var G=ie.open(j.name,mt);G.onerror=function(re){G.result.close(),N(re)},G.onupgradeneeded=function(){G.result.deleteObjectStore(j.storeName)},G.onsuccess=function(){var re=G.result;re.close(),Ei(re)}}).then(function(Ei){Mt.db=Ei;for(var N=0;N<kt.length;N++){var G=kt[N];G._dbInfo.db=Ei,Et(G._dbInfo)}}).catch(function(Ei){throw(_t(j,Ei)||$.resolve()).catch(function(){}),Ei})}}:function(bt){Gt(j);var mt=Ae[j.name],Mt=mt.forages;bt.close();for(var kt=0;kt<Mt.length;kt++)Mt[kt]._dbInfo.db=null;return new $(function(gi,Ei){var N=ie.deleteDatabase(j.name);N.onerror=function(){var G=N.result;G&&G.close(),Ei(N.error)},N.onblocked=function(){console.warn('dropInstance blocked for database "'+j.name+'" until all open connections are closed')},N.onsuccess=function(){var G=N.result;G&&G.close(),gi(G)}}).then(function(gi){mt.db=gi;for(var Ei=0;Ei<Mt.length;Ei++)Et(Mt[Ei]._dbInfo)}).catch(function(gi){throw(_t(j,gi)||$.resolve()).catch(function(){}),gi})}):$.reject("Invalid arguments"),ne),Te}};var dn="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wi=/^~~local_forage_type~([^~]+)~/,ar="__lfsc__:",so="arbf",lr="blob",Qa=Object.prototype.toString;function Aa(j){var we,xe,at,bt,mt,ne=.75*j.length,V=j.length,Te=0;"="===j[j.length-1]&&(ne--,"="===j[j.length-2]&&ne--);var Mt=new ArrayBuffer(ne),kt=new Uint8Array(Mt);for(we=0;we<V;we+=4)xe=dn.indexOf(j[we]),at=dn.indexOf(j[we+1]),bt=dn.indexOf(j[we+2]),mt=dn.indexOf(j[we+3]),kt[Te++]=xe<<2|at>>4,kt[Te++]=(15&at)<<4|bt>>2,kt[Te++]=(3&bt)<<6|63&mt;return Mt}function uc(j){var we,ne=new Uint8Array(j),V="";for(we=0;we<ne.length;we+=3)V+=dn[ne[we]>>2],V+=dn[(3&ne[we])<<4|ne[we+1]>>4],V+=dn[(15&ne[we+1])<<2|ne[we+2]>>6],V+=dn[63&ne[we+2]];return ne.length%3==2?V=V.substring(0,V.length-1)+"=":ne.length%3==1&&(V=V.substring(0,V.length-2)+"=="),V}var hc={serialize:function dc(j,ne){var V="";if(j&&(V=Qa.call(j)),j&&("[object ArrayBuffer]"===V||j.buffer&&"[object ArrayBuffer]"===Qa.call(j.buffer))){var we,Te=ar;j instanceof ArrayBuffer?(we=j,Te+=so):(we=j.buffer,"[object Int8Array]"===V?Te+="si08":"[object Uint8Array]"===V?Te+="ui08":"[object Uint8ClampedArray]"===V?Te+="uic8":"[object Int16Array]"===V?Te+="si16":"[object Uint16Array]"===V?Te+="ur16":"[object Int32Array]"===V?Te+="si32":"[object Uint32Array]"===V?Te+="ui32":"[object Float32Array]"===V?Te+="fl32":"[object Float64Array]"===V?Te+="fl64":ne(new Error("Failed to get type for BinaryArray"))),ne(Te+uc(we))}else if("[object Blob]"===V){var xe=new FileReader;xe.onload=function(){var at="~~local_forage_type~"+j.type+"~"+uc(this.result);ne(ar+lr+at)},xe.readAsArrayBuffer(j)}else try{ne(JSON.stringify(j))}catch(at){console.error("Couldn't convert value into a JSON string: ",j),ne(null,at)}},deserialize:function Bl(j){if(j.substring(0,9)!==ar)return JSON.parse(j);var we,ne=j.substring(13),V=j.substring(9,13);if(V===lr&&wi.test(ne)){var Te=ne.match(wi);we=Te[1],ne=ne.substring(Te[0].length)}var xe=Aa(ne);switch(V){case so:return xe;case lr:return H([xe],{type:we});case"si08":return new Int8Array(xe);case"ui08":return new Uint8Array(xe);case"uic8":return new Uint8ClampedArray(xe);case"si16":return new Int16Array(xe);case"ur16":return new Uint16Array(xe);case"si32":return new Int32Array(xe);case"ui32":return new Uint32Array(xe);case"fl32":return new Float32Array(xe);case"fl64":return new Float64Array(xe);default:throw new Error("Unkown type: "+V)}},stringToBuffer:Aa,bufferToString:uc};function jc(j,ne,V,we){j.executeSql("CREATE TABLE IF NOT EXISTS "+ne.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],V,we)}function Ls(j,ne,V,we,Te,xe){j.executeSql(V,we,Te,function(at,bt){bt.code===bt.SYNTAX_ERR?at.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[ne.storeName],function(mt,Mt){Mt.rows.length?xe(mt,bt):jc(mt,ne,function(){mt.executeSql(V,we,Te,xe)},xe)},xe):xe(at,bt)},xe)}function $c(j,ne,V,we){var Te=this;j=de(j);var xe=new $(function(at,bt){Te.ready().then(function(){void 0===ne&&(ne=null);var mt=ne,Mt=Te._dbInfo;Mt.serializer.serialize(ne,function(kt,tn){tn?bt(tn):Mt.db.transaction(function(Zn){Ls(Zn,Mt,"INSERT OR REPLACE INTO "+Mt.storeName+" (key, value) VALUES (?, ?)",[j,kt],function(){at(mt)},function(gi,Ei){bt(Ei)})},function(Zn){if(Zn.code===Zn.QUOTA_ERR){if(we>0)return void at($c.apply(Te,[j,mt,V,we-1]));bt(Zn)}})})}).catch(bt)});return he(xe,V),xe}var fc={_driver:"webSQLStorage",_initStorage:function Gc(j){var ne=this,V={db:null};if(j)for(var we in j)V[we]="string"!=typeof j[we]?j[we].toString():j[we];var Te=new $(function(xe,at){try{V.db=openDatabase(V.name,String(V.version),V.description,V.size)}catch(bt){return at(bt)}V.db.transaction(function(bt){jc(bt,V,function(){ne._dbInfo=V,xe()},function(mt,Mt){at(Mt)})},at)});return V.serializer=hc,Te},_support:function ln(){return"function"==typeof openDatabase}(),iterate:function kd(j,ne){var V=this,we=new $(function(Te,xe){V.ready().then(function(){var at=V._dbInfo;at.db.transaction(function(bt){Ls(bt,at,"SELECT * FROM "+at.storeName,[],function(mt,Mt){for(var kt=Mt.rows,tn=kt.length,Zn=0;Zn<tn;Zn++){var gi=kt.item(Zn),Ei=gi.value;if(Ei&&(Ei=at.serializer.deserialize(Ei)),void 0!==(Ei=j(Ei,gi.key,Zn+1)))return void Te(Ei)}Te()},function(mt,Mt){xe(Mt)})})}).catch(xe)});return he(we,ne),we},getItem:function Wc(j,ne){var V=this;j=de(j);var we=new $(function(Te,xe){V.ready().then(function(){var at=V._dbInfo;at.db.transaction(function(bt){Ls(bt,at,"SELECT * FROM "+at.storeName+" WHERE key = ? LIMIT 1",[j],function(mt,Mt){var kt=Mt.rows.length?Mt.rows.item(0).value:null;kt&&(kt=at.serializer.deserialize(kt)),Te(kt)},function(mt,Mt){xe(Mt)})})}).catch(xe)});return he(we,ne),we},setItem:function Zi(j,ne,V){return $c.apply(this,[j,ne,V,1])},removeItem:function Pd(j,ne){var V=this;j=de(j);var we=new $(function(Te,xe){V.ready().then(function(){var at=V._dbInfo;at.db.transaction(function(bt){Ls(bt,at,"DELETE FROM "+at.storeName+" WHERE key = ?",[j],function(){Te()},function(mt,Mt){xe(Mt)})})}).catch(xe)});return he(we,ne),we},clear:function rf(j){var ne=this,V=new $(function(we,Te){ne.ready().then(function(){var xe=ne._dbInfo;xe.db.transaction(function(at){Ls(at,xe,"DELETE FROM "+xe.storeName,[],function(){we()},function(bt,mt){Te(mt)})})}).catch(Te)});return he(V,j),V},length:function Fd(j){var ne=this,V=new $(function(we,Te){ne.ready().then(function(){var xe=ne._dbInfo;xe.db.transaction(function(at){Ls(at,xe,"SELECT COUNT(key) as c FROM "+xe.storeName,[],function(bt,mt){var Mt=mt.rows.item(0).c;we(Mt)},function(bt,mt){Te(mt)})})}).catch(Te)});return he(V,j),V},key:function Nd(j,ne){var V=this,we=new $(function(Te,xe){V.ready().then(function(){var at=V._dbInfo;at.db.transaction(function(bt){Ls(bt,at,"SELECT key FROM "+at.storeName+" WHERE id = ? LIMIT 1",[j+1],function(mt,Mt){var kt=Mt.rows.length?Mt.rows.item(0).key:null;Te(kt)},function(mt,Mt){xe(Mt)})})}).catch(xe)});return he(we,ne),we},keys:function ra(j){var ne=this,V=new $(function(we,Te){ne.ready().then(function(){var xe=ne._dbInfo;xe.db.transaction(function(at){Ls(at,xe,"SELECT key FROM "+xe.storeName,[],function(bt,mt){for(var Mt=[],kt=0;kt<mt.rows.length;kt++)Mt.push(mt.rows.item(kt).key);we(Mt)},function(bt,mt){Te(mt)})})}).catch(Te)});return he(V,j),V},dropInstance:function Yc(j,ne){ne=Ve.apply(this,arguments);var V=this.config();(j="function"!=typeof j&&j||{}).name||(j.name=j.name||V.name,j.storeName=j.storeName||V.storeName);var Te,we=this;return he(Te=j.name?new $(function(xe){var at;at=j.name===V.name?we._dbInfo.db:openDatabase(j.name,"","",0),xe(j.storeName?{db:at,storeNames:[j.storeName]}:function Rd(j){return new $(function(ne,V){j.transaction(function(we){we.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(Te,xe){for(var at=[],bt=0;bt<xe.rows.length;bt++)at.push(xe.rows.item(bt).name);ne({db:j,storeNames:at})},function(Te,xe){V(xe)})},function(we){V(we)})})}(at))}).then(function(xe){return new $(function(at,bt){xe.db.transaction(function(mt){function Mt(gi){return new $(function(Ei,N){mt.executeSql("DROP TABLE IF EXISTS "+gi,[],function(){Ei()},function(G,re){N(re)})})}for(var kt=[],tn=0,Zn=xe.storeNames.length;tn<Zn;tn++)kt.push(Mt(xe.storeNames[tn]));$.all(kt).then(function(){at()}).catch(function(gi){bt(gi)})},function(mt){bt(mt)})})}):$.reject("Invalid arguments"),ne),Te}};function mo(j,ne){var V=j.name+"/";return j.storeName!==ne.storeName&&(V+=j.storeName+"/"),V}function jo(){return!function Ld(){var j="_localforage_support_test";try{return localStorage.setItem(j,!0),localStorage.removeItem(j),!1}catch{return!0}}()||localStorage.length>0}var Bs={_driver:"localStorageWrapper",_initStorage:function Op(j){var V={};if(j)for(var we in j)V[we]=j[we];return V.keyPrefix=mo(j,this._defaultConfig),jo()?(this._dbInfo=V,V.serializer=hc,$.resolve()):$.reject()},_support:function ko(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function Ja(j,ne){var V=this,we=V.ready().then(function(){for(var Te=V._dbInfo,xe=Te.keyPrefix,at=xe.length,bt=localStorage.length,mt=1,Mt=0;Mt<bt;Mt++){var kt=localStorage.key(Mt);if(0===kt.indexOf(xe)){var tn=localStorage.getItem(kt);if(tn&&(tn=Te.serializer.deserialize(tn)),void 0!==(tn=j(tn,kt.substring(at),mt++)))return tn}}});return he(we,ne),we},getItem:function it(j,ne){var V=this;j=de(j);var we=V.ready().then(function(){var Te=V._dbInfo,xe=localStorage.getItem(Te.keyPrefix+j);return xe&&(xe=Te.serializer.deserialize(xe)),xe});return he(we,ne),we},setItem:function ka(j,ne,V){var we=this;j=de(j);var Te=we.ready().then(function(){void 0===ne&&(ne=null);var xe=ne;return new $(function(at,bt){var mt=we._dbInfo;mt.serializer.serialize(ne,function(Mt,kt){if(kt)bt(kt);else try{localStorage.setItem(mt.keyPrefix+j,Mt),at(xe)}catch(tn){("QuotaExceededError"===tn.name||"NS_ERROR_DOM_QUOTA_REACHED"===tn.name)&&bt(tn),bt(tn)}})})});return he(Te,V),Te},removeItem:function Bd(j,ne){var V=this;j=de(j);var we=V.ready().then(function(){localStorage.removeItem(V._dbInfo.keyPrefix+j)});return he(we,ne),we},clear:function Pu(j){var ne=this,V=ne.ready().then(function(){for(var we=ne._dbInfo.keyPrefix,Te=localStorage.length-1;Te>=0;Te--){var xe=localStorage.key(Te);0===xe.indexOf(we)&&localStorage.removeItem(xe)}});return he(V,j),V},length:function of(j){var V=this.keys().then(function(we){return we.length});return he(V,j),V},key:function pc(j,ne){var V=this,we=V.ready().then(function(){var xe,Te=V._dbInfo;try{xe=localStorage.key(j)}catch{xe=null}return xe&&(xe=xe.substring(Te.keyPrefix.length)),xe});return he(we,ne),we},keys:function qc(j){var ne=this,V=ne.ready().then(function(){for(var we=ne._dbInfo,Te=localStorage.length,xe=[],at=0;at<Te;at++){var bt=localStorage.key(at);0===bt.indexOf(we.keyPrefix)&&xe.push(bt.substring(we.keyPrefix.length))}return xe});return he(V,j),V},dropInstance:function Go(j,ne){if(ne=Ve.apply(this,arguments),!(j="function"!=typeof j&&j||{}).name){var V=this.config();j.name=j.name||V.name,j.storeName=j.storeName||V.storeName}var Te,we=this;return he(Te=j.name?new $(function(xe){xe(j.storeName?mo(j,we._defaultConfig):j.name+"/")}).then(function(xe){for(var at=localStorage.length-1;at>=0;at--){var bt=localStorage.key(at);0===bt.indexOf(xe)&&localStorage.removeItem(bt)}}):$.reject("Invalid arguments"),ne),Te}},oa=function(ne,V){return ne===V||"number"==typeof ne&&"number"==typeof V&&isNaN(ne)&&isNaN(V)},bs=function(ne,V){for(var we=ne.length,Te=0;Te<we;){if(oa(ne[Te],V))return!0;Te++}return!1},Fu=Array.isArray||function(j){return"[object Array]"===Object.prototype.toString.call(j)},Us={},Hs={},ao={INDEXEDDB:pn,WEBSQL:fc,LOCALSTORAGE:Bs},si=[ao.INDEXEDDB._driver,ao.WEBSQL._driver,ao.LOCALSTORAGE._driver],vs=["dropInstance"],ys=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(vs),di={description:"",driver:si.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function zs(j,ne){j[ne]=function(){var V=arguments;return j.ready().then(function(){return j[ne].apply(j,V)})}}function Si(){for(var j=1;j<arguments.length;j++){var ne=arguments[j];if(ne)for(var V in ne)ne.hasOwnProperty(V)&&(arguments[0][V]=Fu(ne[V])?ne[V].slice():ne[V])}return arguments[0]}var Zc=function(){function j(ne){for(var V in function q(j,ne){if(!(j instanceof ne))throw new TypeError("Cannot call a class as a function")}(this,j),ao)if(ao.hasOwnProperty(V)){var we=ao[V],Te=we._driver;this[V]=Te,Us[Te]||this.defineDriver(we)}this._defaultConfig=Si({},di),this._config=Si({},this._defaultConfig,ne),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return j.prototype.config=function(V){if("object"===(typeof V>"u"?"undefined":K(V))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var we in V){if("storeName"===we&&(V[we]=V[we].replace(/\W/g,"_")),"version"===we&&"number"!=typeof V[we])return new Error("Database version must be a number.");this._config[we]=V[we]}return!("driver"in V)||!V.driver||this.setDriver(this._config.driver)}return"string"==typeof V?this._config[V]:this._config},j.prototype.defineDriver=function(V,we,Te){var xe=new $(function(at,bt){try{var mt=V._driver,Mt=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!V._driver)return void bt(Mt);for(var kt=ys.concat("_initStorage"),tn=0,Zn=kt.length;tn<Zn;tn++){var gi=kt[tn];if((!bs(vs,gi)||V[gi])&&"function"!=typeof V[gi])return void bt(Mt)}!function(){for(var ve=function(Xr){return function(){var Wt=new Error("Method "+Xr+" is not implemented by the current driver"),Vs=$.reject(Wt);return he(Vs,arguments[arguments.length-1]),Vs}},vt=0,Zt=vs.length;vt<Zt;vt++){var Gn=vs[vt];V[Gn]||(V[Gn]=ve(Gn))}}();var G=function(ve){Us[mt]&&console.info("Redefining LocalForage driver: "+mt),Us[mt]=V,Hs[mt]=ve,at()};"_support"in V?V._support&&"function"==typeof V._support?V._support().then(G,bt):G(!!V._support):G(!0)}catch(re){bt(re)}});return ye(xe,we,Te),xe},j.prototype.driver=function(){return this._driver||null},j.prototype.getDriver=function(V,we,Te){var xe=Us[V]?$.resolve(Us[V]):$.reject(new Error("Driver not found."));return ye(xe,we,Te),xe},j.prototype.getSerializer=function(V){var we=$.resolve(hc);return ye(we,V),we},j.prototype.ready=function(V){var we=this,Te=we._driverSet.then(function(){return null===we._ready&&(we._ready=we._initDriver()),we._ready});return ye(Te,V,V),Te},j.prototype.setDriver=function(V,we,Te){var xe=this;Fu(V)||(V=[V]);var at=this._getSupportedDrivers(V);function bt(){xe._config.driver=xe.driver()}function mt(tn){return xe._extend(tn),bt(),xe._ready=xe._initStorage(xe._config),xe._ready}var kt=null!==this._driverSet?this._driverSet.catch(function(){return $.resolve()}):$.resolve();return this._driverSet=kt.then(function(){var tn=at[0];return xe._dbInfo=null,xe._ready=null,xe.getDriver(tn).then(function(Zn){xe._driver=Zn._driver,bt(),xe._wrapLibraryMethodsWithReady(),xe._initDriver=function Mt(tn){return function(){var Zn=0;return function gi(){for(;Zn<tn.length;){var Ei=tn[Zn];return Zn++,xe._dbInfo=null,xe._ready=null,xe.getDriver(Ei).then(mt).catch(gi)}bt();var N=new Error("No available storage method found.");return xe._driverSet=$.reject(N),xe._driverSet}()}}(at)})}).catch(function(){bt();var tn=new Error("No available storage method found.");return xe._driverSet=$.reject(tn),xe._driverSet}),ye(this._driverSet,we,Te),this._driverSet},j.prototype.supports=function(V){return!!Hs[V]},j.prototype._extend=function(V){Si(this,V)},j.prototype._getSupportedDrivers=function(V){for(var we=[],Te=0,xe=V.length;Te<xe;Te++){var at=V[Te];this.supports(at)&&we.push(at)}return we},j.prototype._wrapLibraryMethodsWithReady=function(){for(var V=0,we=ys.length;V<we;V++)zs(this,ys[V])},j.prototype.createInstance=function(V){return new j(V)},j}(),sf=new Zc;oe.exports=sf},{3:3}]},{},[4])(4)},7376:function(Nt,Fe,me){var R;Nt=me.nmd(Nt),function(){var A,q="Expected a function",ie="__lodash_hash_undefined__",H="__lodash_placeholder__",Ht=1/0,zn=9007199254740991,xi=4294967295,qt=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],Kt="[object Arguments]",nn="[object Array]",jn="[object Boolean]",Wi="[object Date]",Ui="[object Error]",Rt="[object Function]",pn="[object GeneratorFunction]",ln="[object Map]",dn="[object Number]",wi="[object Object]",ar="[object Promise]",so="[object RegExp]",lr="[object Set]",Vr="[object String]",ia="[object Symbol]",Ll="[object WeakMap]",Da="[object ArrayBuffer]",Ao="[object DataView]",Oa="[object Float32Array]",cc="[object Float64Array]",Ka="[object Int8Array]",Qa="[object Int16Array]",Aa="[object Int32Array]",uc="[object Uint8Array]",dc="[object Uint8ClampedArray]",Bl="[object Uint16Array]",hc="[object Uint32Array]",jc=/\b__p \+= '';/g,Gc=/\b(__p \+=) '' \+/g,Ls=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Wc=/&(?:amp|lt|gt|quot|#39);/g,kd=/[&<>"']/g,$c=RegExp(Wc.source),Zi=RegExp(kd.source),Pd=/<%-([\s\S]+?)%>/g,rf=/<%([\s\S]+?)%>/g,Fd=/<%=([\s\S]+?)%>/g,Nd=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,ra=/^\w*$/,Rd=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Yc=/[\\^$.*+?()[\]{}|]/g,fc=RegExp(Yc.source),ko=/^\s+/,mo=/\s/,Ld=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,jo=/\{\n\/\* \[wrapped with (.+)\] \*/,Op=/,? & /,Pu=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,it=/[()=,{}\[\]\/\s]/,Ja=/\\(\\)?/g,pc=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,qc=/\w*$/,of=/^[-+]0x[0-9a-f]+$/i,Bd=/^0b[01]+$/i,ka=/^\[object .+?Constructor\]$/,Go=/^0o[0-7]+$/i,Bs=/^(?:0|[1-9]\d*)$/,oa=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,bs=/($^)/,Fu=/['\n\r\u2028\u2029\\]/g,Us="\\ud800-\\udfff",vs="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ys="\\u2700-\\u27bf",di="a-z\\xdf-\\xf6\\xf8-\\xff",j="A-Z\\xc0-\\xd6\\xd8-\\xde",ne="\\ufe0e\\ufe0f",V="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Te="["+Us+"]",xe="["+V+"]",at="["+vs+"]",bt="\\d+",mt="["+ys+"]",Mt="["+di+"]",kt="[^"+Us+V+bt+ys+di+j+"]",tn="\\ud83c[\\udffb-\\udfff]",gi="[^"+Us+"]",Ei="(?:\\ud83c[\\udde6-\\uddff]){2}",N="[\\ud800-\\udbff][\\udc00-\\udfff]",G="["+j+"]",ve="(?:"+Mt+"|"+kt+")",vt="(?:"+G+"|"+kt+")",Zt="(?:['\u2019](?:d|ll|m|re|s|t|ve))?",Gn="(?:['\u2019](?:D|LL|M|RE|S|T|VE))?",Zr="(?:"+at+"|"+tn+")?",Xr="["+ne+"]?",af=Xr+Zr+"(?:\\u200d(?:"+[gi,Ei,N].join("|")+")"+Xr+Zr+")*",G3="(?:"+[mt,Ei,N].join("|")+")"+af,pv="(?:"+[gi+at+"?",at,Ei,N,Te].join("|")+")",rw=RegExp("['\u2019]","g"),Ap=RegExp(at,"g"),Ud=RegExp(tn+"(?="+tn+")|"+pv+af,"g"),t_=RegExp([G+"?"+Mt+"+"+Zt+"(?="+[xe,G,"$"].join("|")+")",vt+"+"+Gn+"(?="+[xe,G+ve,"$"].join("|")+")",G+"?"+ve+"+"+Zt,G+"+"+Gn,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",bt,G3].join("|"),"g"),gv=RegExp("[\\u200d"+Us+vs+ne+"]"),ow=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,hn=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],n_=-1,Qi={};Qi[Oa]=Qi[cc]=Qi[Ka]=Qi[Qa]=Qi[Aa]=Qi[uc]=Qi[dc]=Qi[Bl]=Qi[hc]=!0,Qi[Kt]=Qi[nn]=Qi[Da]=Qi[jn]=Qi[Ao]=Qi[Wi]=Qi[Ui]=Qi[Rt]=Qi[ln]=Qi[dn]=Qi[wi]=Qi[so]=Qi[lr]=Qi[Vr]=Qi[Ll]=!1;var Ji={};Ji[Kt]=Ji[nn]=Ji[Da]=Ji[Ao]=Ji[jn]=Ji[Wi]=Ji[Oa]=Ji[cc]=Ji[Ka]=Ji[Qa]=Ji[Aa]=Ji[ln]=Ji[dn]=Ji[wi]=Ji[so]=Ji[lr]=Ji[Vr]=Ji[ia]=Ji[uc]=Ji[dc]=Ji[Bl]=Ji[hc]=!0,Ji[Ui]=Ji[Rt]=Ji[Ll]=!1;var W3={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},$3=parseFloat,Y3=parseInt,aw="object"==typeof global&&global&&global.Object===Object&&global,o_="object"==typeof self&&self&&self.Object===Object&&self,Kr=aw||o_||Function("return this")(),kp=Fe&&!Fe.nodeType&&Fe,Nu=kp&&Nt&&!Nt.nodeType&&Nt,s_=Nu&&Nu.exports===kp,el=s_&&aw.process,ns=function(){try{return Nu&&Nu.require&&Nu.require("util").types||el&&el.binding&&el.binding("util")}catch{}}(),a_=ns&&ns.isArrayBuffer,Nn=ns&&ns.isDate,Ai=ns&&ns.isMap,lw=ns&&ns.isRegExp,mv=ns&&ns.isSet,_v=ns&&ns.isTypedArray;function Fa(ae,ut,et){switch(et.length){case 0:return ae.call(ut);case 1:return ae.call(ut,et[0]);case 2:return ae.call(ut,et[0],et[1]);case 3:return ae.call(ut,et[0],et[1],et[2])}return ae.apply(ut,et)}function cw(ae,ut,et,Qt){for(var Bn=-1,_i=null==ae?0:ae.length;++Bn<_i;){var co=ae[Bn];ut(Qt,co,et(co),ae)}return Qt}function js(ae,ut){for(var et=-1,Qt=null==ae?0:ae.length;++et<Qt&&!1!==ut(ae[et],et,ae););return ae}function mi(ae,ut){for(var et=null==ae?0:ae.length;et--&&!1!==ut(ae[et],et,ae););return ae}function Pp(ae,ut){for(var et=-1,Qt=null==ae?0:ae.length;++et<Qt;)if(!ut(ae[et],et,ae))return!1;return!0}function gc(ae,ut){for(var et=-1,Qt=null==ae?0:ae.length,Bn=0,_i=[];++et<Qt;){var co=ae[et];ut(co,et,ae)&&(_i[Bn++]=co)}return _i}function Wo(ae,ut){return!(null==ae||!ae.length)&&zd(ae,ut,0)>-1}function Fp(ae,ut,et){for(var Qt=-1,Bn=null==ae?0:ae.length;++Qt<Bn;)if(et(ut,ae[Qt]))return!0;return!1}function kr(ae,ut){for(var et=-1,Qt=null==ae?0:ae.length,Bn=Array(Qt);++et<Qt;)Bn[et]=ut(ae[et],et,ae);return Bn}function Ru(ae,ut){for(var et=-1,Qt=ut.length,Bn=ae.length;++et<Qt;)ae[Bn+et]=ut[et];return ae}function Lu(ae,ut,et,Qt){var Bn=-1,_i=null==ae?0:ae.length;for(Qt&&_i&&(et=ae[++Bn]);++Bn<_i;)et=ut(et,ae[Bn],Bn,ae);return et}function l_(ae,ut,et,Qt){var Bn=null==ae?0:ae.length;for(Qt&&Bn&&(et=ae[--Bn]);Bn--;)et=ut(et,ae[Bn],Bn,ae);return et}function Hd(ae,ut){for(var et=-1,Qt=null==ae?0:ae.length;++et<Qt;)if(ut(ae[et],et,ae))return!0;return!1}var uw=Np("length");function c_(ae,ut,et){var Qt;return et(ae,function(Bn,_i,co){if(ut(Bn,_i,co))return Qt=_i,!1}),Qt}function mc(ae,ut,et,Qt){for(var Bn=ae.length,_i=et+(Qt?1:-1);Qt?_i--:++_i<Bn;)if(ut(ae[_i],_i,ae))return _i;return-1}function zd(ae,ut,et){return ut==ut?function jd(ae,ut,et){for(var Qt=et-1,Bn=ae.length;++Qt<Bn;)if(ae[Qt]===ut)return Qt;return-1}(ae,ut,et):mc(ae,bv,et)}function Xc(ae,ut,et,Qt){for(var Bn=et-1,_i=ae.length;++Bn<_i;)if(Qt(ae[Bn],ut))return Bn;return-1}function bv(ae){return ae!=ae}function kn(ae,ut){var et=null==ae?0:ae.length;return et?Bu(ae,ut)/et:NaN}function Np(ae){return function(ut){return null==ut?A:ut[ae]}}function En(ae){return function(ut){return null==ae?A:ae[ut]}}function lf(ae,ut,et,Qt,Bn){return Bn(ae,function(_i,co,Xi){et=Qt?(Qt=!1,_i):ut(et,_i,co,Xi)}),et}function Bu(ae,ut){for(var et,Qt=-1,Bn=ae.length;++Qt<Bn;){var _i=ut(ae[Qt]);_i!==A&&(et=et===A?_i:et+_i)}return et}function d_(ae,ut){for(var et=-1,Qt=Array(ae);++et<ae;)Qt[et]=ut(et);return Qt}function vv(ae){return ae&&ae.slice(0,Ti(ae)+1).replace(ko,"")}function sa(ae){return function(ut){return ae(ut)}}function cf(ae,ut){return kr(ut,function(et){return ae[et]})}function uf(ae,ut){return ae.has(ut)}function Rp(ae,ut){for(var et=-1,Qt=ae.length;++et<Qt&&zd(ut,ae[et],0)>-1;);return et}function yv(ae,ut){for(var et=ae.length;et--&&zd(ut,ae[et],0)>-1;);return et}var pw=En({\u00c0:"A",\u00c1:"A",\u00c2:"A",\u00c3:"A",\u00c4:"A",\u00c5:"A",\u00e0:"a",\u00e1:"a",\u00e2:"a",\u00e3:"a",\u00e4:"a",\u00e5:"a",\u00c7:"C",\u00e7:"c",\u00d0:"D",\u00f0:"d",\u00c8:"E",\u00c9:"E",\u00ca:"E",\u00cb:"E",\u00e8:"e",\u00e9:"e",\u00ea:"e",\u00eb:"e",\u00cc:"I",\u00cd:"I",\u00ce:"I",\u00cf:"I",\u00ec:"i",\u00ed:"i",\u00ee:"i",\u00ef:"i",\u00d1:"N",\u00f1:"n",\u00d2:"O",\u00d3:"O",\u00d4:"O",\u00d5:"O",\u00d6:"O",\u00d8:"O",\u00f2:"o",\u00f3:"o",\u00f4:"o",\u00f5:"o",\u00f6:"o",\u00f8:"o",\u00d9:"U",\u00da:"U",\u00db:"U",\u00dc:"U",\u00f9:"u",\u00fa:"u",\u00fb:"u",\u00fc:"u",\u00dd:"Y",\u00fd:"y",\u00ff:"y",\u00c6:"Ae",\u00e6:"ae",\u00de:"Th",\u00fe:"th",\u00df:"ss",\u0100:"A",\u0102:"A",\u0104:"A",\u0101:"a",\u0103:"a",\u0105:"a",\u0106:"C",\u0108:"C",\u010a:"C",\u010c:"C",\u0107:"c",\u0109:"c",\u010b:"c",\u010d:"c",\u010e:"D",\u0110:"D",\u010f:"d",\u0111:"d",\u0112:"E",\u0114:"E",\u0116:"E",\u0118:"E",\u011a:"E",\u0113:"e",\u0115:"e",\u0117:"e",\u0119:"e",\u011b:"e",\u011c:"G",\u011e:"G",\u0120:"G",\u0122:"G",\u011d:"g",\u011f:"g",\u0121:"g",\u0123:"g",\u0124:"H",\u0126:"H",\u0125:"h",\u0127:"h",\u0128:"I",\u012a:"I",\u012c:"I",\u012e:"I",\u0130:"I",\u0129:"i",\u012b:"i",\u012d:"i",\u012f:"i",\u0131:"i",\u0134:"J",\u0135:"j",\u0136:"K",\u0137:"k",\u0138:"k",\u0139:"L",\u013b:"L",\u013d:"L",\u013f:"L",\u0141:"L",\u013a:"l",\u013c:"l",\u013e:"l",\u0140:"l",\u0142:"l",\u0143:"N",\u0145:"N",\u0147:"N",\u014a:"N",\u0144:"n",\u0146:"n",\u0148:"n",\u014b:"n",\u014c:"O",\u014e:"O",\u0150:"O",\u014d:"o",\u014f:"o",\u0151:"o",\u0154:"R",\u0156:"R",\u0158:"R",\u0155:"r",\u0157:"r",\u0159:"r",\u015a:"S",\u015c:"S",\u015e:"S",\u0160:"S",\u015b:"s",\u015d:"s",\u015f:"s",\u0161:"s",\u0162:"T",\u0164:"T",\u0166:"T",\u0163:"t",\u0165:"t",\u0167:"t",\u0168:"U",\u016a:"U",\u016c:"U",\u016e:"U",\u0170:"U",\u0172:"U",\u0169:"u",\u016b:"u",\u016d:"u",\u016f:"u",\u0171:"u",\u0173:"u",\u0174:"W",\u0175:"w",\u0176:"Y",\u0177:"y",\u0178:"Y",\u0179:"Z",\u017b:"Z",\u017d:"Z",\u017a:"z",\u017c:"z",\u017e:"z",\u0132:"IJ",\u0133:"ij",\u0152:"Oe",\u0153:"oe",\u0149:"'n",\u017f:"s"}),Gs=En({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function Vd(ae){return"\\"+W3[ae]}function _c(ae){return gv.test(ae)}function xv(ae){var ut=-1,et=Array(ae.size);return ae.forEach(function(Qt,Bn){et[++ut]=[Bn,Qt]}),et}function f_(ae,ut){return function(et){return ae(ut(et))}}function Hu(ae,ut){for(var et=-1,Qt=ae.length,Bn=0,_i=[];++et<Qt;){var co=ae[et];(co===ut||co===H)&&(ae[et]=H,_i[Bn++]=et)}return _i}function is(ae){var ut=-1,et=Array(ae.size);return ae.forEach(function(Qt){et[++ut]=Qt}),et}function zu(ae){return _c(ae)?function wv(ae){for(var ut=Ud.lastIndex=0;Ud.test(ae);)++ut;return ut}(ae):uw(ae)}function lo(ae){return _c(ae)?function g_(ae){return ae.match(Ud)||[]}(ae):function dw(ae){return ae.split("")}(ae)}function Ti(ae){for(var ut=ae.length;ut--&&mo.test(ae.charAt(ut)););return ut}var Gd=En({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),Ws=function ae(ut){var c,et=(ut=null==ut?Kr:Ws.defaults(Kr.Object(),ut,Ws.pick(Kr,hn))).Array,Qt=ut.Date,Bn=ut.Error,_i=ut.Function,co=ut.Math,Xi=ut.Object,m_=ut.RegExp,__=ut.String,Na=ut.TypeError,Hp=et.prototype,Wd=Xi.prototype,df=ut["__core-js_shared__"],zp=_i.prototype.toString,$i=Wd.hasOwnProperty,gw=0,Ev=(c=/[^.]+$/.exec(df&&df.keys&&df.keys.IE_PROTO||""))?"Symbol(src)_1."+c:"",hf=Wd.toString,mw=zp.call(Xi),_w=Kr._,bw=m_("^"+zp.call($i).replace(Yc,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),xn=s_?ut.Buffer:A,Kc=ut.Symbol,Vp=ut.Uint8Array,Ra=xn?xn.allocUnsafe:A,ff=f_(Xi.getPrototypeOf,Xi),wn=Xi.create,rs=Wd.propertyIsEnumerable,Xn=Hp.splice,uo=Kc?Kc.isConcatSpreadable:A,Qr=Kc?Kc.iterator:A,aa=Kc?Kc.toStringTag:A,_o=function(){try{var c=iu(Xi,"defineProperty");return c({},"",{}),c}catch{}}(),Tv=ut.clearTimeout!==Kr.clearTimeout&&ut.clearTimeout,Iv=Qt&&Qt.now!==Kr.Date.now&&Qt.now,jp=ut.setTimeout!==Kr.setTimeout&&ut.setTimeout,Gp=co.ceil,Wp=co.floor,Vu=Xi.getOwnPropertySymbols,vw=xn?xn.isBuffer:A,$p=ut.isFinite,Sv=Hp.join,Yp=f_(Xi.keys,Xi),Po=co.max,Fo=co.min,yw=Qt.now,b_=ut.parseInt,v_=co.random,Mv=Hp.reverse,bc=iu(ut,"DataView"),pf=iu(ut,"Map"),gf=iu(ut,"Promise"),vc=iu(ut,"Set"),mf=iu(ut,"WeakMap"),ju=iu(Xi,"create"),Gu=mf&&new mf,Cs={},$d=ru(bc),y_=ru(pf),Cw=ru(gf),xw=ru(vc),Dv=ru(mf),yc=Kc?Kc.prototype:A,_f=yc?yc.valueOf:A,Ov=yc?yc.toString:A;function z(c){if(Fr(c)&&!$n(c)&&!(c instanceof ai)){if(c instanceof la)return c;if($i.call(c,"__wrapped__"))return td(c)}return new la(c)}var Qc=function(){function c(){}return function(d){if(!ur(d))return{};if(wn)return wn(d);c.prototype=d;var b=new c;return c.prototype=A,b}}();function bf(){}function la(c,d){this.__wrapped__=c,this.__actions__=[],this.__chain__=!!d,this.__index__=0,this.__values__=A}function ai(c){this.__wrapped__=c,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=xi,this.__views__=[]}function gr(c){var d=-1,b=null==c?0:c.length;for(this.clear();++d<b;){var I=c[d];this.set(I[0],I[1])}}function Cc(c){var d=-1,b=null==c?0:c.length;for(this.clear();++d<b;){var I=c[d];this.set(I[0],I[1])}}function ki(c){var d=-1,b=null==c?0:c.length;for(this.clear();++d<b;){var I=c[d];this.set(I[0],I[1])}}function bo(c){var d=-1,b=null==c?0:c.length;for(this.__data__=new ki;++d<b;)this.add(c[d])}function Hi(c){var d=this.__data__=new Cc(c);this.size=d.size}function vr(c,d){var b=$n(c),I=!b&&au(c),k=!b&&!I&&lu(c),Y=!b&&!I&&!k&&_h(c),ce=b||I||k||Y,ge=ce?d_(c.length,__):[],Le=ge.length;for(var gt in c)(d||$i.call(c,gt))&&(!ce||!("length"==gt||k&&("offset"==gt||"parent"==gt)||Y&&("buffer"==gt||"byteLength"==gt||"byteOffset"==gt)||ha(gt,Le)))&&ge.push(gt);return ge}function Xd(c){var d=c.length;return d?c[Zu(0,d-1)]:A}function Kd(c,d){return Wl(ls(c),ss(d,0,c.length))}function xc(c){return Wl(ls(c))}function Wu(c,d,b){(b!==A&&!ml(c[d],b)||b===A&&!(d in c))&&ol(c,d,b)}function Qd(c,d,b){var I=c[d];(!$i.call(c,d)||!ml(I,b)||b===A&&!(d in c))&&ol(c,d,b)}function rl(c,d){for(var b=c.length;b--;)if(ml(c[b][0],d))return b;return-1}function Zp(c,d,b,I){return Pr(c,function(k,Y,ce){d(I,k,b(k),ce)}),I}function Jc(c,d){return c&&La(d,Ro(d),c)}function ol(c,d,b){"__proto__"==d&&_o?_o(c,d,{configurable:!0,enumerable:!0,value:b,writable:!0}):c[d]=b}function $u(c,d){for(var b=-1,I=d.length,k=et(I),Y=null==c;++b<I;)k[b]=Y?A:z1(c,d[b]);return k}function ss(c,d,b){return c==c&&(b!==A&&(c=c<=b?c:b),d!==A&&(c=c>=d?c:d)),c}function xs(c,d,b,I,k,Y){var ce,ge=1&d,Le=2&d,gt=4&d;if(b&&(ce=k?b(c,I,k,Y):b(c)),ce!==A)return ce;if(!ur(c))return c;var je=$n(c);if(je){if(ce=function Ww(c){var d=c.length,b=new c.constructor(d);return d&&"string"==typeof c[0]&&$i.call(c,"index")&&(b.index=c.index,b.input=c.input),b}(c),!ge)return ls(c,ce)}else{var h=po(c),zt=h==Rt||h==pn;if(lu(c))return jv(c,ge);if(h==wi||h==Kt||zt&&!k){if(ce=Le||zt?{}:Xv(c),!ge)return Le?function iD(c,d){return La(c,Ju(c),d)}(c,function Un(c,d){return c&&La(d,Is(d),c)}(ce,c)):function Hw(c,d){return La(c,U_(c),d)}(c,Jc(ce,c))}else{if(!Ji[h])return k?c:{};ce=function rD(c,d,b){var I=c.constructor;switch(d){case Da:return k_(c);case jn:case Wi:return new I(+c);case Ao:return function st(c,d){var b=d?k_(c.buffer):c.buffer;return new c.constructor(b,c.byteOffset,c.byteLength)}(c,b);case Oa:case cc:case Ka:case Qa:case Aa:case uc:case dc:case Bl:case hc:return D(c,b);case ln:return new I;case dn:case Vr:return new I(c);case so:return function hi(c){var d=new c.constructor(c.source,qc.exec(c));return d.lastIndex=c.lastIndex,d}(c);case lr:return new I;case ia:return function O(c){return _f?Xi(_f.call(c)):{}}(c)}}(c,h,ge)}}Y||(Y=new Hi);var F=Y.get(c);if(F)return F;Y.set(c,ce),g0(c)?c.forEach(function(In){ce.add(xs(In,d,b,In,c,Y))}):f0(c)&&c.forEach(function(In,ri){ce.set(ri,xs(In,d,b,ri,c,Y))});var ei=je?A:(gt?Le?Ku:dg:Le?Is:Ro)(c);return js(ei||c,function(In,ri){ei&&(In=c[ri=In]),Qd(ce,ri,xs(In,d,b,ri,c,Y))}),ce}function jr(c,d,b){var I=b.length;if(null==c)return!I;for(c=Xi(c);I--;){var k=b[I],ce=c[k];if(ce===A&&!(k in c)||!(0,d[k])(ce))return!1}return!0}function Xp(c,d,b){if("function"!=typeof c)throw new Na(q);return dh(function(){c.apply(A,b)},d)}function ho(c,d,b,I){var k=-1,Y=Wo,ce=!0,ge=c.length,Le=[],gt=d.length;if(!ge)return Le;b&&(d=kr(d,sa(b))),I?(Y=Fp,ce=!1):d.length>=200&&(Y=uf,ce=!1,d=new bo(d));e:for(;++k<ge;){var je=c[k],h=null==b?je:b(je);if(je=I||0!==je?je:0,ce&&h==h){for(var zt=gt;zt--;)if(d[zt]===h)continue e;Le.push(je)}else Y(d,h,I)||Le.push(je)}return Le}z.templateSettings={escape:Pd,evaluate:rf,interpolate:Fd,variable:"",imports:{_:z}},(z.prototype=bf.prototype).constructor=z,(la.prototype=Qc(bf.prototype)).constructor=la,(ai.prototype=Qc(bf.prototype)).constructor=ai,gr.prototype.clear=function Av(){this.__data__=ju?ju(null):{},this.size=0},gr.prototype.delete=function Tw(c){var d=this.has(c)&&delete this.__data__[c];return this.size-=d?1:0,d},gr.prototype.get=function vf(c){var d=this.__data__;if(ju){var b=d[c];return b===ie?A:b}return $i.call(d,c)?d[c]:A},gr.prototype.has=function Iw(c){var d=this.__data__;return ju?d[c]!==A:$i.call(d,c)},gr.prototype.set=function Sw(c,d){var b=this.__data__;return this.size+=this.has(c)?0:1,b[c]=ju&&d===A?ie:d,this},Cc.prototype.clear=function Mw(){this.__data__=[],this.size=0},Cc.prototype.delete=function Dw(c){var d=this.__data__,b=rl(d,c);return!(b<0||(b==d.length-1?d.pop():Xn.call(d,b,1),--this.size,0))},Cc.prototype.get=function Ow(c){var d=this.__data__,b=rl(d,c);return b<0?A:d[b][1]},Cc.prototype.has=function C_(c){return rl(this.__data__,c)>-1},Cc.prototype.set=function qp(c,d){var b=this.__data__,I=rl(b,c);return I<0?(++this.size,b.push([c,d])):b[I][1]=d,this},ki.prototype.clear=function Ot(){this.size=0,this.__data__={hash:new gr,map:new(pf||Cc),string:new gr}},ki.prototype.delete=function fn(c){var d=Qu(this,c).delete(c);return this.size-=d?1:0,d},ki.prototype.get=function Jr(c){return Qu(this,c).get(c)},ki.prototype.has=function nl(c){return Qu(this,c).has(c)},ki.prototype.set=function os(c,d){var b=Qu(this,c),I=b.size;return b.set(c,d),this.size+=b.size==I?0:1,this},bo.prototype.add=bo.prototype.push=function qd(c){return this.__data__.set(c,ie),this},bo.prototype.has=function cr(c){return this.__data__.has(c)},Hi.prototype.clear=function il(){this.__data__=new Cc,this.size=0},Hi.prototype.delete=function Pn(c){var d=this.__data__,b=d.delete(c);return this.size=d.size,b},Hi.prototype.get=function yf(c){return this.__data__.get(c)},Hi.prototype.has=function kv(c){return this.__data__.has(c)},Hi.prototype.set=function Zd(c,d){var b=this.__data__;if(b instanceof Cc){var I=b.__data__;if(!pf||I.length<199)return I.push([c,d]),this.size=++b.size,this;b=this.__data__=new ki(I)}return b.set(c,d),this.size=b.size,this};var Pr=Vl(al),Kp=Vl(w_,!0);function Yu(c,d){var b=!0;return Pr(c,function(I,k,Y){return b=!!d(I,k,Y)}),b}function qu(c,d,b){for(var I=-1,k=c.length;++I<k;){var Y=c[I],ce=d(Y);if(null!=ce&&(ge===A?ce==ce&&!yo(ce):b(ce,ge)))var ge=ce,Le=Y}return Le}function Qp(c,d){var b=[];return Pr(c,function(I,k,Y){d(I,k,Y)&&b.push(I)}),b}function $o(c,d,b,I,k){var Y=-1,ce=c.length;for(b||(b=z_),k||(k=[]);++Y<ce;){var ge=c[Y];d>0&&b(ge)?d>1?$o(ge,d-1,b,I,k):Ru(k,ge):I||(k[k.length]=ge)}return k}var x_=P_(),Jp=P_(!0);function al(c,d){return c&&x_(c,d,Ro)}function w_(c,d){return c&&Jp(c,d,Ro)}function eh(c,d){return gc(d,function(b){return $l(c[b])})}function th(c,d){for(var b=0,I=(d=da(d,c)).length;null!=c&&b<I;)c=c[dl(d[b++])];return b&&b==I?c:A}function Aw(c,d,b){var I=d(c);return $n(c)?I:Ru(I,b(c))}function $s(c){return null==c?c===A?"[object Undefined]":"[object Null]":aa&&aa in Xi(c)?function qv(c){var d=$i.call(c,aa),b=c[aa];try{c[aa]=A;var I=!0}catch{}var k=hf.call(c);return I&&(d?c[aa]=b:delete c[aa]),k}(c):function Jv(c){return hf.call(c)}(c)}function Pv(c,d){return c>d}function Z3(c,d){return null!=c&&$i.call(c,d)}function X3(c,d){return null!=c&&d in Xi(c)}function Fv(c,d,b){for(var I=b?Fp:Wo,k=c[0].length,Y=c.length,ce=Y,ge=et(Y),Le=1/0,gt=[];ce--;){var je=c[ce];ce&&d&&(je=kr(je,sa(d))),Le=Fo(je.length,Le),ge[ce]=!b&&(d||k>=120&&je.length>=120)?new bo(ce&&je):A}je=c[0];var h=-1,zt=ge[0];e:for(;++h<k&&gt.length<Le;){var F=je[h],Tn=d?d(F):F;if(F=b||0!==F?F:0,!(zt?uf(zt,Tn):I(gt,Tn,b))){for(ce=Y;--ce;){var ei=ge[ce];if(!(ei?uf(ei,Tn):I(c[ce],Tn,b)))continue e}zt&&zt.push(Tn),gt.push(F)}}return gt}function eg(c,d,b){var I=null==(c=pg(c,d=da(d,c)))?c:c[dl(hl(d))];return null==I?A:Fa(I,c,b)}function kw(c){return Fr(c)&&$s(c)==Kt}function nh(c,d,b,I,k){return c===d||(null==c||null==d||!Fr(c)&&!Fr(d)?c!=c&&d!=d:function eD(c,d,b,I,k,Y){var ce=$n(c),ge=$n(d),Le=ce?nn:po(c),gt=ge?nn:po(d),je=(Le=Le==Kt?wi:Le)==wi,h=(gt=gt==Kt?wi:gt)==wi,zt=Le==gt;if(zt&&lu(c)){if(!lu(d))return!1;ce=!0,je=!1}if(zt&&!je)return Y||(Y=new Hi),ce||_h(c)?Yv(c,d,b,I,k,Y):function Vw(c,d,b,I,k,Y,ce){switch(b){case Ao:if(c.byteLength!=d.byteLength||c.byteOffset!=d.byteOffset)return!1;c=c.buffer,d=d.buffer;case Da:return!(c.byteLength!=d.byteLength||!Y(new Vp(c),new Vp(d)));case jn:case Wi:case dn:return ml(+c,+d);case Ui:return c.name==d.name&&c.message==d.message;case so:case Vr:return c==d+"";case ln:var ge=xv;case lr:if(ge||(ge=is),c.size!=d.size&&!(1&I))return!1;var gt=ce.get(c);if(gt)return gt==d;I|=2,ce.set(c,d);var je=Yv(ge(c),ge(d),I,k,Y,ce);return ce.delete(c),je;case ia:if(_f)return _f.call(c)==_f.call(d)}return!1}(c,d,Le,b,I,k,Y);if(!(1&b)){var F=je&&$i.call(c,"__wrapped__"),Tn=h&&$i.call(d,"__wrapped__");if(F||Tn){var ei=F?c.value():c,In=Tn?d.value():d;return Y||(Y=new Hi),k(ei,In,b,I,Y)}}return!!zt&&(Y||(Y=new Hi),function jw(c,d,b,I,k,Y){var ce=1&b,ge=dg(c),Le=ge.length;if(Le!=dg(d).length&&!ce)return!1;for(var h=Le;h--;){var zt=ge[h];if(!(ce?zt in d:$i.call(d,zt)))return!1}var F=Y.get(c),Tn=Y.get(d);if(F&&Tn)return F==d&&Tn==c;var ei=!0;Y.set(c,d),Y.set(d,c);for(var In=ce;++h<Le;){var ri=c[zt=ge[h]],oi=d[zt];if(I)var Ms=ce?I(oi,ri,zt,d,c,Y):I(ri,oi,zt,c,d,Y);if(!(Ms===A?ri===oi||k(ri,oi,b,I,Y):Ms)){ei=!1;break}In||(In="constructor"==zt)}if(ei&&!In){var Co=c.constructor,qs=d.constructor;Co!=qs&&"constructor"in c&&"constructor"in d&&!("function"==typeof Co&&Co instanceof Co&&"function"==typeof qs&&qs instanceof qs)&&(ei=!1)}return Y.delete(c),Y.delete(d),ei}(c,d,b,I,k,Y))}(c,d,b,I,nh,k))}function Rv(c,d,b,I){var k=b.length,Y=k,ce=!I;if(null==c)return!Y;for(c=Xi(c);k--;){var ge=b[k];if(ce&&ge[2]?ge[1]!==c[ge[0]]:!(ge[0]in c))return!1}for(;++k<Y;){var Le=(ge=b[k])[0],gt=c[Le],je=ge[1];if(ce&&ge[2]){if(gt===A&&!(Le in c))return!1}else{var h=new Hi;if(I)var zt=I(gt,je,Le,c,d,h);if(!(zt===A?nh(je,gt,3,I,h):zt))return!1}}return!0}function Pw(c){return!(!ur(c)||function sD(c){return!!Ev&&Ev in c}(c))&&($l(c)?bw:ka).test(ru(c))}function E_(c){return"function"==typeof c?c:null==c?to:"object"==typeof c?$n(c)?ng(c[0],c[1]):Bv(c):ey(c)}function T_(c){if(!uh(c))return Yp(c);var d=[];for(var b in Xi(c))$i.call(c,b)&&"constructor"!=b&&d.push(b);return d}function tg(c,d){return c<d}function I_(c,d){var b=-1,I=No(c)?et(c.length):[];return Pr(c,function(k,Y,ce){I[++b]=d(k,Y,ce)}),I}function Bv(c){var d=Mf(c);return 1==d.length&&d[0][2]?ul(d[0][0],d[0][1]):function(b){return b===c||Rv(b,c,d)}}function ng(c,d){return ed(c)&&Qv(d)?ul(dl(c),d):function(b){var I=z1(b,c);return I===A&&I===d?b0(b,c):nh(d,I,3)}}function ig(c,d,b,I,k){c!==d&&x_(d,function(Y,ce){if(k||(k=new Hi),ur(Y))!function Ul(c,d,b,I,k,Y,ce){var ge=gg(c,b),Le=gg(d,b),gt=ce.get(Le);if(gt)Wu(c,b,gt);else{var je=Y?Y(ge,Le,b+"",c,d,ce):A,h=je===A;if(h){var zt=$n(Le),F=!zt&&lu(Le),Tn=!zt&&!F&&_h(Le);je=Le,zt||F||Tn?$n(ge)?je=ge:Gr(ge)?je=ls(ge):F?(h=!1,je=jv(Le,!0)):Tn?(h=!1,je=D(Le,!0)):je=[]:cu(Le)||au(Le)?(je=ge,au(ge)?je=R1(ge):(!ur(ge)||$l(ge))&&(je=Xv(Le))):h=!1}h&&(ce.set(Le,je),k(je,Le,I,Y,ce),ce.delete(Le)),Wu(c,b,je)}}(c,d,ce,b,ig,I,k);else{var ge=I?I(gg(c,ce),Y,ce+"",c,d,k):A;ge===A&&(ge=Y),Wu(c,ce,ge)}},Is)}function S_(c,d){var b=c.length;if(b)return ha(d+=d<0?b:0,b)?c[d]:A}function M_(c,d,b){d=d.length?kr(d,function(Y){return $n(Y)?function(ce){return th(ce,1===Y.length?Y[0]:Y)}:Y}):[to];var I=-1;return d=kr(d,sa(bn())),function u_(ae,ut){var et=ae.length;for(ae.sort(ut);et--;)ae[et]=ae[et].value;return ae}(I_(c,function(Y,ce,ge){return{criteria:kr(d,function(gt){return gt(Y)}),index:++I,value:Y}}),function(Y,ce){return function Gv(c,d,b){for(var I=-1,k=c.criteria,Y=d.criteria,ce=k.length,ge=b.length;++I<ce;){var Le=Vi(k[I],Y[I]);if(Le)return I>=ge?Le:Le*("desc"==b[I]?-1:1)}return c.index-d.index}(Y,ce,b)})}function Hv(c,d,b){for(var I=-1,k=d.length,Y={};++I<k;){var ce=d[I],ge=th(c,ce);b(ge,ce)&&Cf(Y,da(ce,c),ge)}return Y}function zi(c,d,b,I){var k=I?Xc:zd,Y=-1,ce=d.length,ge=c;for(c===d&&(d=ls(d)),b&&(ge=kr(c,sa(b)));++Y<ce;)for(var Le=0,gt=d[Y],je=b?b(gt):gt;(Le=k(ge,je,Le,I))>-1;)ge!==c&&Xn.call(ge,Le,1),Xn.call(c,Le,1);return c}function rg(c,d){for(var b=c?d.length:0,I=b-1;b--;){var k=d[b];if(b==I||k!==Y){var Y=k;ha(k)?Xn.call(c,k,1):wc(c,k)}}return c}function Zu(c,d){return c+Wp(v_()*(d-c+1))}function D_(c,d){var b="";if(!c||d<1||d>zn)return b;do{d%2&&(b+=c),(d=Wp(d/2))&&(c+=c)}while(d);return b}function Wn(c,d){return mg(Df(c,d,to),c+"")}function ih(c){return Xd(bh(c))}function ca(c,d){var b=bh(c);return Wl(b,ss(d,0,b.length))}function Cf(c,d,b,I){if(!ur(c))return c;for(var k=-1,Y=(d=da(d,c)).length,ce=Y-1,ge=c;null!=ge&&++k<Y;){var Le=dl(d[k]),gt=b;if("__proto__"===Le||"constructor"===Le||"prototype"===Le)return c;if(k!=ce){var je=ge[Le];(gt=I?I(je,Le,ge):A)===A&&(gt=ur(je)?je:ha(d[k+1])?[]:{})}Qd(ge,Le,gt),ge=ge[Le]}return c}var og=Gu?function(c,d){return Gu.set(c,d),c}:to,Rw=_o?function(c,d){return _o(c,"toString",{configurable:!0,enumerable:!1,value:X1(d),writable:!0})}:to;function Hl(c){return Wl(bh(c))}function ua(c,d,b){var I=-1,k=c.length;d<0&&(d=-d>k?0:k+d),(b=b>k?k:b)<0&&(b+=k),k=d>b?0:b-d>>>0,d>>>=0;for(var Y=et(k);++I<k;)Y[I]=c[I+d];return Y}function Lw(c,d){var b;return Pr(c,function(I,k,Y){return!(b=d(I,k,Y))}),!!b}function xf(c,d,b){var I=0,k=null==c?I:c.length;if("number"==typeof d&&d==d&&k<=2147483647){for(;I<k;){var Y=I+k>>>1,ce=c[Y];null!==ce&&!yo(ce)&&(b?ce<=d:ce<d)?I=Y+1:k=Y}return k}return wf(c,d,to,b)}function wf(c,d,b,I){var k=0,Y=null==c?0:c.length;if(0===Y)return 0;for(var ce=(d=b(d))!=d,ge=null===d,Le=yo(d),gt=d===A;k<Y;){var je=Wp((k+Y)/2),h=b(c[je]),zt=h!==A,F=null===h,Tn=h==h,ei=yo(h);if(ce)var In=I||Tn;else In=gt?Tn&&(I||zt):ge?Tn&&zt&&(I||!F):Le?Tn&&zt&&!F&&(I||!ei):!F&&!ei&&(I?h<=d:h<d);In?k=je+1:Y=je}return Fo(Y,4294967294)}function sg(c,d){for(var b=-1,I=c.length,k=0,Y=[];++b<I;){var ce=c[b],ge=d?d(ce):ce;if(!b||!ml(ge,Le)){var Le=ge;Y[k++]=0===ce?0:ce}}return Y}function rh(c){return"number"==typeof c?c:yo(c)?NaN:+c}function as(c){if("string"==typeof c)return c;if($n(c))return kr(c,as)+"";if(yo(c))return Ov?Ov.call(c):"";var d=c+"";return"0"==d&&1/c==-Ht?"-0":d}function zl(c,d,b){var I=-1,k=Wo,Y=c.length,ce=!0,ge=[],Le=ge;if(b)ce=!1,k=Fp;else if(Y>=200){var gt=d?null:B_(c);if(gt)return is(gt);ce=!1,k=uf,Le=new bo}else Le=d?[]:ge;e:for(;++I<Y;){var je=c[I],h=d?d(je):je;if(je=b||0!==je?je:0,ce&&h==h){for(var zt=Le.length;zt--;)if(Le[zt]===h)continue e;d&&Le.push(h),ge.push(je)}else k(Le,h,b)||(Le!==ge&&Le.push(h),ge.push(je))}return ge}function wc(c,d){return null==(c=pg(c,d=da(d,c)))||delete c[dl(hl(d))]}function Mn(c,d,b,I){return Cf(c,d,b(th(c,d)),I)}function Ef(c,d,b,I){for(var k=c.length,Y=I?k:-1;(I?Y--:++Y<k)&&d(c[Y],Y,c););return b?ua(c,I?0:Y,I?Y+1:k):ua(c,I?Y+1:0,I?k:Y)}function Bw(c,d){var b=c;return b instanceof ai&&(b=b.value()),Lu(d,function(I,k){return k.func.apply(k.thisArg,Ru([I],k.args))},b)}function O_(c,d,b){var I=c.length;if(I<2)return I?zl(c[0]):[];for(var k=-1,Y=et(I);++k<I;)for(var ce=c[k],ge=-1;++ge<I;)ge!=k&&(Y[k]=ho(Y[k]||ce,c[ge],d,b));return zl($o(Y,1),d,b)}function zv(c,d,b){for(var I=-1,k=c.length,Y=d.length,ce={};++I<k;)b(ce,c[I],I<Y?d[I]:A);return ce}function A_(c){return Gr(c)?c:[]}function ag(c){return"function"==typeof c?c:to}function da(c,d){return $n(c)?c:ed(c,d)?[c]:t1(Ri(c))}var Uw=Wn;function eu(c,d,b){var I=c.length;return b=b===A?I:b,!d&&b>=I?c:ua(c,d,b)}var Vv=Tv||function(c){return Kr.clearTimeout(c)};function jv(c,d){if(d)return c.slice();var b=c.length,I=Ra?Ra(b):new c.constructor(b);return c.copy(I),I}function k_(c){var d=new c.constructor(c.byteLength);return new Vp(d).set(new Vp(c)),d}function D(c,d){var b=d?k_(c.buffer):c.buffer;return new c.constructor(b,c.byteOffset,c.length)}function Vi(c,d){if(c!==d){var b=c!==A,I=null===c,k=c==c,Y=yo(c),ce=d!==A,ge=null===d,Le=d==d,gt=yo(d);if(!ge&&!gt&&!Y&&c>d||Y&&ce&&Le&&!ge&&!gt||I&&ce&&Le||!b&&Le||!k)return 1;if(!I&&!Y&&!gt&&c<d||gt&&b&&k&&!I&&!Y||ge&&b&&k||!ce&&k||!Le)return-1}return 0}function oh(c,d,b,I){for(var k=-1,Y=c.length,ce=b.length,ge=-1,Le=d.length,gt=Po(Y-ce,0),je=et(Le+gt),h=!I;++ge<Le;)je[ge]=d[ge];for(;++k<ce;)(h||k<Y)&&(je[b[k]]=c[k]);for(;gt--;)je[ge++]=c[k++];return je}function ll(c,d,b,I){for(var k=-1,Y=c.length,ce=-1,ge=b.length,Le=-1,gt=d.length,je=Po(Y-ge,0),h=et(je+gt),zt=!I;++k<je;)h[k]=c[k];for(var F=k;++Le<gt;)h[F+Le]=d[Le];for(;++ce<ge;)(zt||k<Y)&&(h[F+b[ce]]=c[k++]);return h}function ls(c,d){var b=-1,I=c.length;for(d||(d=et(I));++b<I;)d[b]=c[b];return d}function La(c,d,b,I){var k=!b;b||(b={});for(var Y=-1,ce=d.length;++Y<ce;){var ge=d[Y],Le=I?I(b[ge],c[ge],ge,b,c):A;Le===A&&(Le=c[ge]),k?ol(b,ge,Le):Qd(b,ge,Le)}return b}function Tf(c,d){return function(b,I){var k=$n(b)?cw:Zp,Y=d?d():{};return k(b,c,bn(I,2),Y)}}function fo(c){return Wn(function(d,b){var I=-1,k=b.length,Y=k>1?b[k-1]:A,ce=k>2?b[2]:A;for(Y=c.length>3&&"function"==typeof Y?(k--,Y):A,ce&&Es(b[0],b[1],ce)&&(Y=k<3?A:Y,k=1),d=Xi(d);++I<k;){var ge=b[I];ge&&c(d,ge,I,Y)}return d})}function Vl(c,d){return function(b,I){if(null==b)return b;if(!No(b))return c(b,I);for(var k=b.length,Y=d?k:-1,ce=Xi(b);(d?Y--:++Y<k)&&!1!==I(ce[Y],Y,ce););return b}}function P_(c){return function(d,b,I){for(var k=-1,Y=Xi(d),ce=I(d),ge=ce.length;ge--;){var Le=ce[c?ge:++k];if(!1===b(Y[Le],Le,Y))break}return d}}function jl(c){return function(d){var b=_c(d=Ri(d))?lo(d):A,I=b?b[0]:d.charAt(0),k=b?eu(b,1).join(""):d.slice(1);return I[c]()+k}}function sh(c){return function(d){return Lu(za(x0(d).replace(rw,"")),c,"")}}function ah(c){return function(){var d=arguments;switch(d.length){case 0:return new c;case 1:return new c(d[0]);case 2:return new c(d[0],d[1]);case 3:return new c(d[0],d[1],d[2]);case 4:return new c(d[0],d[1],d[2],d[3]);case 5:return new c(d[0],d[1],d[2],d[3],d[4]);case 6:return new c(d[0],d[1],d[2],d[3],d[4],d[5]);case 7:return new c(d[0],d[1],d[2],d[3],d[4],d[5],d[6])}var b=Qc(c.prototype),I=c.apply(b,d);return ur(I)?I:b}}function Wv(c){return function(d,b,I){var k=Xi(d);if(!No(d)){var Y=bn(b,3);d=Ro(d),b=function(ge){return Y(k[ge],ge,k)}}var ce=c(d,b,I);return ce>-1?k[Y?d[ce]:ce]:A}}function lg(c){return Gl(function(d){var b=d.length,I=b,k=la.prototype.thru;for(c&&d.reverse();I--;){var Y=d[I];if("function"!=typeof Y)throw new Na(q);if(k&&!ce&&"wrapper"==hg(Y))var ce=new la([],!0)}for(I=ce?I:b;++I<b;){var ge=hg(Y=d[I]),Le="wrapper"==ge?Ba(Y):A;ce=Le&&ch(Le[0])&&424==Le[1]&&!Le[4].length&&1==Le[9]?ce[hg(Le[0])].apply(ce,Le[3]):1==Y.length&&ch(Y)?ce[ge]():ce.thru(Y)}return function(){var gt=arguments,je=gt[0];if(ce&&1==gt.length&&$n(je))return ce.plant(je).value();for(var h=0,zt=b?d[h].apply(this,gt):je;++h<b;)zt=d[h].call(this,zt);return zt}})}function lh(c,d,b,I,k,Y,ce,ge,Le,gt){var je=128&d,h=1&d,zt=2&d,F=24&d,Tn=512&d,ei=zt?A:ah(c);return function In(){for(var ri=arguments.length,oi=et(ri),Ms=ri;Ms--;)oi[Ms]=arguments[Ms];if(F)var Co=Ec(In),qs=function Uu(ae,ut){for(var et=ae.length,Qt=0;et--;)ae[et]===ut&&++Qt;return Qt}(oi,Co);if(I&&(oi=oh(oi,I,k,F)),Y&&(oi=ll(oi,Y,ce,F)),ri-=qs,F&&ri<gt){var Nr=Hu(oi,Co);return L_(c,d,lh,In.placeholder,b,oi,Nr,ge,Le,gt-ri)}var pa=h?b:this,bl=zt?pa[c]:c;return ri=oi.length,ge?oi=function Yw(c,d){for(var b=c.length,I=Fo(d.length,b),k=ls(c);I--;){var Y=d[I];c[I]=ha(Y,b)?k[Y]:A}return c}(oi,ge):Tn&&ri>1&&oi.reverse(),je&&Le<ri&&(oi.length=Le),this&&this!==Kr&&this instanceof In&&(bl=ei||ah(bl)),bl.apply(pa,oi)}}function cg(c,d){return function(b,I){return function Q3(c,d,b,I){return al(c,function(k,Y,ce){d(I,b(k),Y,ce)}),I}(b,c,d(I),{})}}function Xu(c,d){return function(b,I){var k;if(b===A&&I===A)return d;if(b!==A&&(k=b),I!==A){if(k===A)return I;"string"==typeof b||"string"==typeof I?(b=as(b),I=as(I)):(b=rh(b),I=rh(I)),k=c(b,I)}return k}}function F_(c){return Gl(function(d){return d=kr(d,sa(bn())),Wn(function(b){var I=this;return c(d,function(k){return Fa(k,I,b)})})})}function If(c,d){var b=(d=d===A?" ":as(d)).length;if(b<2)return b?D_(d,c):d;var I=D_(d,Gp(c/zu(d)));return _c(d)?eu(lo(I),0,c).join(""):I.slice(0,c)}function R_(c){return function(d,b,I){return I&&"number"!=typeof I&&Es(d,b,I)&&(b=I=A),d=Tc(d),b===A?(b=d,d=0):b=Tc(b),function ws(c,d,b,I){for(var k=-1,Y=Po(Gp((d-c)/(b||1)),0),ce=et(Y);Y--;)ce[I?Y:++k]=c,c+=b;return ce}(d,b,I=I===A?d<b?1:-1:Tc(I),c)}}function Sf(c){return function(d,b){return"string"==typeof d&&"string"==typeof b||(d=Ua(d),b=Ua(b)),c(d,b)}}function L_(c,d,b,I,k,Y,ce,ge,Le,gt){var je=8&d;d|=je?32:64,4&(d&=~(je?64:32))||(d&=-4);var ei=[c,d,k,je?Y:A,je?ce:A,je?A:Y,je?A:ce,ge,Le,gt],In=b.apply(A,ei);return ch(c)&&G_(In,ei),In.placeholder=I,e1(In,c,d)}function ug(c){var d=co[c];return function(b,I){if(b=Ua(b),(I=null==I?0:Fo(Jn(I),292))&&$p(b)){var k=(Ri(b)+"e").split("e");return+((k=(Ri(d(k[0]+"e"+(+k[1]+I)))+"e").split("e"))[0]+"e"+(+k[1]-I))}return d(b)}}var B_=vc&&1/is(new vc([,-0]))[1]==Ht?function(c){return new vc(c)}:Ch;function $v(c){return function(d){var b=po(d);return b==ln?xv(d):b==lr?function p_(ae){var ut=-1,et=Array(ae.size);return ae.forEach(function(Qt){et[++ut]=[Qt,Qt]}),et}(d):function fw(ae,ut){return kr(ut,function(et){return[et,ae[et]]})}(d,c(d))}}function yr(c,d,b,I,k,Y,ce,ge){var Le=2&d;if(!Le&&"function"!=typeof c)throw new Na(q);var gt=I?I.length:0;if(gt||(d&=-97,I=k=A),ce=ce===A?ce:Po(Jn(ce),0),ge=ge===A?ge:Jn(ge),gt-=k?k.length:0,64&d){var je=I,h=k;I=k=A}var zt=Le?A:Ba(c),F=[c,d,b,I,k,je,h,Y,ce,ge];if(zt&&function fg(c,d){var b=c[1],I=d[1],k=b|I;if(!(k<131)&&!(128==I&&8==b||128==I&&256==b&&c[7].length<=d[8]||384==I&&d[7].length<=d[8]&&8==b))return c;1&I&&(c[2]=d[2],k|=1&b?0:4);var ge=d[3];if(ge){var Le=c[3];c[3]=Le?oh(Le,ge,d[4]):ge,c[4]=Le?Hu(c[3],H):d[4]}(ge=d[5])&&(c[5]=(Le=c[5])?ll(Le,ge,d[6]):ge,c[6]=Le?Hu(c[5],H):d[6]),(ge=d[7])&&(c[7]=ge),128&I&&(c[8]=null==c[8]?d[8]:Fo(c[8],d[8])),null==c[9]&&(c[9]=d[9]),c[0]=d[0],c[1]=k}(F,zt),c=F[0],d=F[1],b=F[2],I=F[3],k=F[4],!(ge=F[9]=F[9]===A?Le?0:c.length:Po(F[9]-gt,0))&&24&d&&(d&=-25),d&&1!=d)Tn=8==d||16==d?function zw(c,d,b){var I=ah(c);return function k(){for(var Y=arguments.length,ce=et(Y),ge=Y,Le=Ec(k);ge--;)ce[ge]=arguments[ge];var gt=Y<3&&ce[0]!==Le&&ce[Y-1]!==Le?[]:Hu(ce,Le);return(Y-=gt.length)<b?L_(c,d,lh,k.placeholder,A,ce,gt,A,A,b-Y):Fa(this&&this!==Kr&&this instanceof k?I:c,this,ce)}}(c,d,ge):32!=d&&33!=d||k.length?lh.apply(A,F):function N_(c,d,b,I){var k=1&d,Y=ah(c);return function ce(){for(var ge=-1,Le=arguments.length,gt=-1,je=I.length,h=et(je+Le),zt=this&&this!==Kr&&this instanceof ce?Y:c;++gt<je;)h[gt]=I[gt];for(;Le--;)h[gt++]=arguments[++ge];return Fa(zt,k?b:this,h)}}(c,d,b,I);else var Tn=function cl(c,d,b){var I=1&d,k=ah(c);return function Y(){return(this&&this!==Kr&&this instanceof Y?k:c).apply(I?b:this,arguments)}}(c,d,b);return e1((zt?og:G_)(Tn,F),c,d)}function tu(c,d,b,I){return c===A||ml(c,Wd[b])&&!$i.call(I,b)?d:c}function er(c,d,b,I,k,Y){return ur(c)&&ur(d)&&(Y.set(d,c),ig(c,d,A,er,Y),Y.delete(d)),c}function nu(c){return cu(c)?A:c}function Yv(c,d,b,I,k,Y){var ce=1&b,ge=c.length,Le=d.length;if(ge!=Le&&!(ce&&Le>ge))return!1;var gt=Y.get(c),je=Y.get(d);if(gt&&je)return gt==d&&je==c;var h=-1,zt=!0,F=2&b?new bo:A;for(Y.set(c,d),Y.set(d,c);++h<ge;){var Tn=c[h],ei=d[h];if(I)var In=ce?I(ei,Tn,h,d,c,Y):I(Tn,ei,h,c,d,Y);if(In!==A){if(In)continue;zt=!1;break}if(F){if(!Hd(d,function(ri,oi){if(!uf(F,oi)&&(Tn===ri||k(Tn,ri,b,I,Y)))return F.push(oi)})){zt=!1;break}}else if(Tn!==ei&&!k(Tn,ei,b,I,Y)){zt=!1;break}}return Y.delete(c),Y.delete(d),zt}function Gl(c){return mg(Df(c,A,o1),c+"")}function dg(c){return Aw(c,Ro,U_)}function Ku(c){return Aw(c,Is,Ju)}var Ba=Gu?function(c){return Gu.get(c)}:Ch;function hg(c){for(var d=c.name+"",b=Cs[d],I=$i.call(Cs,d)?b.length:0;I--;){var k=b[I],Y=k.func;if(null==Y||Y==c)return k.name}return d}function Ec(c){return($i.call(z,"placeholder")?z:c).placeholder}function bn(){var c=z.iteratee||Vf;return c=c===Vf?E_:c,arguments.length?c(arguments[0],arguments[1]):c}function Qu(c,d){var b=c.__data__;return function V_(c){var d=typeof c;return"string"==d||"number"==d||"symbol"==d||"boolean"==d?"__proto__"!==c:null===c}(d)?b["string"==typeof d?"string":"hash"]:b.map}function Mf(c){for(var d=Ro(c),b=d.length;b--;){var I=d[b],k=c[I];d[b]=[I,k,Qv(k)]}return d}function iu(c,d){var b=function Cv(ae,ut){return null==ae?A:ae[ut]}(c,d);return Pw(b)?b:A}var U_=Vu?function(c){return null==c?[]:(c=Xi(c),gc(Vu(c),function(d){return rs.call(c,d)}))}:xh,Ju=Vu?function(c){for(var d=[];c;)Ru(d,U_(c)),c=ff(c);return d}:xh,po=$s;function Zv(c,d,b){for(var I=-1,k=(d=da(d,c)).length,Y=!1;++I<k;){var ce=dl(d[I]);if(!(Y=null!=c&&b(c,ce)))break;c=c[ce]}return Y||++I!=k?Y:!!(k=null==c?0:c.length)&&id(k)&&ha(ce,k)&&($n(c)||au(c))}function Xv(c){return"function"!=typeof c.constructor||uh(c)?{}:Qc(ff(c))}function z_(c){return $n(c)||au(c)||!!(uo&&c&&c[uo])}function ha(c,d){var b=typeof c;return!!(d=d??zn)&&("number"==b||"symbol"!=b&&Bs.test(c))&&c>-1&&c%1==0&&c<d}function Es(c,d,b){if(!ur(b))return!1;var I=typeof d;return!!("number"==I?No(b)&&ha(d,b.length):"string"==I&&d in b)&&ml(b[d],c)}function ed(c,d){if($n(c))return!1;var b=typeof c;return!("number"!=b&&"symbol"!=b&&"boolean"!=b&&null!=c&&!yo(c))||ra.test(c)||!Nd.test(c)||null!=d&&c in Xi(d)}function ch(c){var d=hg(c),b=z[d];if("function"!=typeof b||!(d in ai.prototype))return!1;if(c===b)return!0;var I=Ba(b);return!!I&&c===I[0]}(bc&&po(new bc(new ArrayBuffer(1)))!=Ao||pf&&po(new pf)!=ln||gf&&po(gf.resolve())!=ar||vc&&po(new vc)!=lr||mf&&po(new mf)!=Ll)&&(po=function(c){var d=$s(c),b=d==wi?c.constructor:A,I=b?ru(b):"";if(I)switch(I){case $d:return Ao;case y_:return ln;case Cw:return ar;case xw:return lr;case Dv:return Ll}return d});var Kv=df?$l:Gf;function uh(c){var d=c&&c.constructor;return c===("function"==typeof d&&d.prototype||Wd)}function Qv(c){return c==c&&!ur(c)}function ul(c,d){return function(b){return null!=b&&b[c]===d&&(d!==A||c in Xi(b))}}function Df(c,d,b){return d=Po(d===A?c.length-1:d,0),function(){for(var I=arguments,k=-1,Y=Po(I.length-d,0),ce=et(Y);++k<Y;)ce[k]=I[d+k];k=-1;for(var ge=et(d+1);++k<d;)ge[k]=I[k];return ge[d]=b(ce),Fa(c,this,ge)}}function pg(c,d){return d.length<2?c:th(c,ua(d,0,-1))}function gg(c,d){if(("constructor"!==d||"function"!=typeof c[d])&&"__proto__"!=d)return c[d]}var G_=Of(og),dh=jp||function(c,d){return Kr.setTimeout(c,d)},mg=Of(Rw);function e1(c,d,b){var I=d+"";return mg(c,function oD(c,d){var b=d.length;if(!b)return c;var I=b-1;return d[I]=(b>1?"& ":"")+d[I],d=d.join(b>2?", ":" "),c.replace(Ld,"{\n/* [wrapped with "+d+"] */\n")}(I,function hh(c,d){return js(qt,function(b){var I="_."+b[0];d&b[1]&&!Wo(c,I)&&c.push(I)}),c.sort()}(function H_(c){var d=c.match(jo);return d?d[1].split(Op):[]}(I),b)))}function Of(c){var d=0,b=0;return function(){var I=yw(),k=16-(I-b);if(b=I,k>0){if(++d>=800)return arguments[0]}else d=0;return c.apply(A,arguments)}}function Wl(c,d){var b=-1,I=c.length,k=I-1;for(d=d===A?I:d;++b<d;){var Y=Zu(b,k),ce=c[Y];c[Y]=c[b],c[b]=ce}return c.length=d,c}var t1=function $w(c){var d=nd(c,function(I){return 500===b.size&&b.clear(),I}),b=d.cache;return d}(function(c){var d=[];return 46===c.charCodeAt(0)&&d.push(""),c.replace(Rd,function(b,I,k,Y){d.push(k?Y.replace(Ja,"$1"):I||b)}),d});function dl(c){if("string"==typeof c||yo(c))return c;var d=c+"";return"0"==d&&1/c==-Ht?"-0":d}function ru(c){if(null!=c){try{return zp.call(c)}catch{}try{return c+""}catch{}}return""}function td(c){if(c instanceof ai)return c.clone();var d=new la(c.__wrapped__,c.__chain__);return d.__actions__=ls(c.__actions__),d.__index__=c.__index__,d.__values__=c.__values__,d}var W_=Wn(function(c,d){return Gr(c)?ho(c,$o(d,1,Gr,!0)):[]}),Zw=Wn(function(c,d){var b=hl(d);return Gr(b)&&(b=A),Gr(c)?ho(c,$o(d,1,Gr,!0),bn(b,2)):[]}),n1=Wn(function(c,d){var b=hl(d);return Gr(b)&&(b=A),Gr(c)?ho(c,$o(d,1,Gr,!0),A,b):[]});function Y_(c,d,b){var I=null==c?0:c.length;if(!I)return-1;var k=null==b?0:Jn(b);return k<0&&(k=Po(I+k,0)),mc(c,bn(d,3),k)}function r1(c,d,b){var I=null==c?0:c.length;if(!I)return-1;var k=I-1;return b!==A&&(k=Jn(b),k=b<0?Po(I+k,0):Fo(k,I-1)),mc(c,bn(d,3),k,!0)}function o1(c){return null!=c&&c.length?$o(c,1):[]}function q_(c){return c&&c.length?c[0]:A}var aD=Wn(function(c){var d=kr(c,A_);return d.length&&d[0]===c[0]?Fv(d):[]}),a1=Wn(function(c){var d=hl(c),b=kr(c,A_);return d===hl(b)?d=A:b.pop(),b.length&&b[0]===c[0]?Fv(b,bn(d,2)):[]}),l1=Wn(function(c){var d=hl(c),b=kr(c,A_);return(d="function"==typeof d?d:A)&&b.pop(),b.length&&b[0]===c[0]?Fv(b,A,d):[]});function hl(c){var d=null==c?0:c.length;return d?c[d-1]:A}var Z_=Wn(fl);function fl(c,d){return c&&c.length&&d&&d.length?zi(c,d):c}var tE=Gl(function(c,d){var b=null==c?0:c.length,I=$u(c,d);return rg(c,kr(d,function(k){return ha(k,b)?+k:k}).sort(Vi)),I});function vg(c){return null==c?c:Mv.call(c)}var Af=Wn(function(c){return zl($o(c,1,Gr,!0))}),sE=Wn(function(c){var d=hl(c);return Gr(d)&&(d=A),zl($o(c,1,Gr,!0),bn(d,2))}),h1=Wn(function(c){var d=hl(c);return d="function"==typeof d?d:A,zl($o(c,1,Gr,!0),A,d)});function kf(c){if(!c||!c.length)return[];var d=0;return c=gc(c,function(b){if(Gr(b))return d=Po(b.length,d),!0}),d_(d,function(b){return kr(c,Np(b))})}function p1(c,d){if(!c||!c.length)return[];var b=kf(c);return null==d?b:kr(b,function(I){return Fa(d,A,I)})}var aE=Wn(function(c,d){return Gr(c)?ho(c,d):[]}),lE=Wn(function(c){return O_(gc(c,Gr))}),g1=Wn(function(c){var d=hl(c);return Gr(d)&&(d=A),O_(gc(c,Gr),bn(d,2))}),cE=Wn(function(c){var d=hl(c);return d="function"==typeof d?d:A,O_(gc(c,Gr),A,d)}),uE=Wn(kf),m1=Wn(function(c){var d=c.length,b=d>1?c[d-1]:A;return b="function"==typeof b?(c.pop(),b):A,p1(c,b)});function xg(c){var d=z(c);return d.__chain__=!0,d}function ou(c,d){return d(c)}var _1=Gl(function(c){var d=c.length,b=d?c[0]:0,I=this.__wrapped__,k=function(Y){return $u(Y,c)};return!(d>1||this.__actions__.length)&&I instanceof ai&&ha(b)?((I=I.slice(b,+b+(d?1:0))).__actions__.push({func:ou,args:[k],thisArg:A}),new la(I,this.__chain__).thru(function(Y){return d&&!Y.length&&Y.push(A),Y})):this.thru(k)}),pE=Tf(function(c,d,b){$i.call(c,b)?++c[b]:ol(c,b,1)}),_E=Wv(Y_),x1=Wv(r1);function J_(c,d){return($n(c)?js:Pr)(c,bn(d,3))}function e0(c,d){return($n(c)?mi:Kp)(c,bn(d,3))}var T1=Tf(function(c,d,b){$i.call(c,b)?c[b].push(d):ol(c,b,[d])}),bE=Wn(function(c,d,b){var I=-1,k="function"==typeof d,Y=No(c)?et(c.length):[];return Pr(c,function(ce){Y[++I]=k?Fa(d,ce,b):eg(ce,d,b)}),Y}),vE=Tf(function(c,d,b){ol(c,b,d)});function Eg(c,d){return($n(c)?kr:I_)(c,bn(d,3))}var S1=Tf(function(c,d,b){c[b?0:1].push(d)},function(){return[[],[]]}),EE=Wn(function(c,d){if(null==c)return[];var b=d.length;return b>1&&Es(c,d[0],d[1])?d=[]:b>2&&Es(d[0],d[1],d[2])&&(d=[d[0]]),M_(c,$o(d,1),[])}),pl=Iv||function(){return Kr.Date.now()};function O1(c,d,b){return d=b?A:d,yr(c,128,A,A,A,A,d=c&&null==d?c.length:d)}function n0(c,d){var b;if("function"!=typeof d)throw new Na(q);return c=Jn(c),function(){return--c>0&&(b=d.apply(this,arguments)),c<=1&&(d=A),b}}var gl=Wn(function(c,d,b){var I=1;if(b.length){var k=Hu(b,Ec(gl));I|=32}return yr(c,I,d,b,k)}),TE=Wn(function(c,d,b){var I=3;if(b.length){var k=Hu(b,Ec(TE));I|=32}return yr(d,I,c,b,k)});function A1(c,d,b){var I,k,Y,ce,ge,Le,gt=0,je=!1,h=!1,zt=!0;if("function"!=typeof c)throw new Na(q);function F(Nr){var pa=I,bl=k;return I=k=A,gt=Nr,ce=c.apply(bl,pa)}function In(Nr){var pa=Nr-Le;return Le===A||pa>=d||pa<0||h&&Nr-gt>=Y}function ri(){var Nr=pl();if(In(Nr))return oi(Nr);ge=dh(ri,function ei(Nr){var P0=d-(Nr-Le);return h?Fo(P0,Y-(Nr-gt)):P0}(Nr))}function oi(Nr){return ge=A,zt&&I?F(Nr):(I=k=A,ce)}function qs(){var Nr=pl(),pa=In(Nr);if(I=arguments,k=this,Le=Nr,pa){if(ge===A)return function Tn(Nr){return gt=Nr,ge=dh(ri,d),je?F(Nr):ce}(Le);if(h)return Vv(ge),ge=dh(ri,d),F(Le)}return ge===A&&(ge=dh(ri,d)),ce}return d=Ua(d)||0,ur(b)&&(je=!!b.leading,Y=(h="maxWait"in b)?Po(Ua(b.maxWait)||0,d):Y,zt="trailing"in b?!!b.trailing:zt),qs.cancel=function Ms(){ge!==A&&Vv(ge),gt=0,I=Le=k=ge=A},qs.flush=function Co(){return ge===A?ce:oi(pl())},qs}var IE=Wn(function(c,d){return Xp(c,1,d)}),mD=Wn(function(c,d,b){return Xp(c,Ua(d)||0,b)});function nd(c,d){if("function"!=typeof c||null!=d&&"function"!=typeof d)throw new Na(q);var b=function(){var I=arguments,k=d?d.apply(this,I):I[0],Y=b.cache;if(Y.has(k))return Y.get(k);var ce=c.apply(this,I);return b.cache=Y.set(k,ce)||Y,ce};return b.cache=new(nd.Cache||ki),b}function Sg(c){if("function"!=typeof c)throw new Na(q);return function(){var d=arguments;switch(d.length){case 0:return!c.call(this);case 1:return!c.call(this,d[0]);case 2:return!c.call(this,d[0],d[1]);case 3:return!c.call(this,d[0],d[1],d[2])}return!c.apply(this,d)}}nd.Cache=ki;var s0=Uw(function(c,d){var b=(d=1==d.length&&$n(d[0])?kr(d[0],sa(bn())):kr($o(d,1),sa(bn()))).length;return Wn(function(I){for(var k=-1,Y=Fo(I.length,b);++k<Y;)I[k]=d[k].call(this,I[k]);return Fa(c,this,I)})}),su=Wn(function(c,d){var b=Hu(d,Ec(su));return yr(c,32,A,d,b)}),Mg=Wn(function(c,d){var b=Hu(d,Ec(Mg));return yr(c,64,A,d,b)}),a0=Gl(function(c,d){return yr(c,256,A,A,A,d)});function ml(c,d){return c===d||c!=c&&d!=d}var ME=Sf(Pv),d0=Sf(function(c,d){return c>=d}),au=kw(function(){return arguments}())?kw:function(c){return Fr(c)&&$i.call(c,"callee")&&!rs.call(c,"callee")},$n=et.isArray,DE=a_?sa(a_):function J3(c){return Fr(c)&&$s(c)==Da};function No(c){return null!=c&&id(c.length)&&!$l(c)}function Gr(c){return Fr(c)&&No(c)}var lu=vw||Gf,vD=Nn?sa(Nn):function Nv(c){return Fr(c)&&$s(c)==Wi};function Rf(c){if(!Fr(c))return!1;var d=$s(c);return d==Ui||"[object DOMException]"==d||"string"==typeof c.message&&"string"==typeof c.name&&!cu(c)}function $l(c){if(!ur(c))return!1;var d=$s(c);return d==Rt||d==pn||"[object AsyncFunction]"==d||"[object Proxy]"==d}function kg(c){return"number"==typeof c&&c==Jn(c)}function id(c){return"number"==typeof c&&c>-1&&c%1==0&&c<=zn}function ur(c){var d=typeof c;return null!=c&&("object"==d||"function"==d)}function Fr(c){return null!=c&&"object"==typeof c}var f0=Ai?sa(Ai):function tD(c){return Fr(c)&&po(c)==ln};function FE(c){return"number"==typeof c||Fr(c)&&$s(c)==dn}function cu(c){if(!Fr(c)||$s(c)!=wi)return!1;var d=ff(c);if(null===d)return!0;var b=$i.call(d,"constructor")&&d.constructor;return"function"==typeof b&&b instanceof b&&zp.call(b)==mw}var Lf=lw?sa(lw):function Fw(c){return Fr(c)&&$s(c)==so},g0=mv?sa(mv):function Lv(c){return Fr(c)&&po(c)==lr};function Bf(c){return"string"==typeof c||!$n(c)&&Fr(c)&&$s(c)==Vr}function yo(c){return"symbol"==typeof c||Fr(c)&&$s(c)==ia}var _h=_v?sa(_v):function mr(c){return Fr(c)&&id(c.length)&&!!Qi[$s(c)]},BE=Sf(tg),fa=Sf(function(c,d){return c<=d});function _l(c){if(!c)return[];if(No(c))return Bf(c)?lo(c):ls(c);if(Qr&&c[Qr])return function h_(ae){for(var ut,et=[];!(ut=ae.next()).done;)et.push(ut.value);return et}(c[Qr]());var d=po(c);return(d==ln?xv:d==lr?is:bh)(c)}function Tc(c){return c?(c=Ua(c))===Ht||c===-Ht?17976931348623157e292*(c<0?-1:1):c==c?c:0:0===c?c:0}function Jn(c){var d=Tc(c),b=d%1;return d==d?b?d-b:d:0}function N1(c){return c?ss(Jn(c),0,xi):0}function Ua(c){if("number"==typeof c)return c;if(yo(c))return NaN;if(ur(c)){var d="function"==typeof c.valueOf?c.valueOf():c;c=ur(d)?d+"":d}if("string"!=typeof c)return 0===c?c:+c;c=vv(c);var b=Bd.test(c);return b||Go.test(c)?Y3(c.slice(2),b?2:8):of.test(c)?NaN:+c}function R1(c){return La(c,Is(c))}function Ri(c){return null==c?"":as(c)}var HE=fo(function(c,d){if(uh(d)||No(d))La(d,Ro(d),c);else for(var b in d)$i.call(d,b)&&Qd(c,b,d[b])}),L1=fo(function(c,d){La(d,Is(d),c)}),Fg=fo(function(c,d,b,I){La(d,Is(d),c,I)}),zE=fo(function(c,d,b,I){La(d,Ro(d),c,I)}),Ng=Gl($u),Uf=Wn(function(c,d){c=Xi(c);var b=-1,I=d.length,k=I>2?d[2]:A;for(k&&Es(d[0],d[1],k)&&(I=1);++b<I;)for(var Y=d[b],ce=Is(Y),ge=-1,Le=ce.length;++ge<Le;){var gt=ce[ge],je=c[gt];(je===A||ml(je,Wd[gt])&&!$i.call(c,gt))&&(c[gt]=Y[gt])}return c}),B1=Wn(function(c){return c.push(A,er),Fa(v0,A,c)});function z1(c,d,b){var I=null==c?A:th(c,d);return I===A?b:I}function b0(c,d){return null!=c&&Zv(c,d,X3)}var VE=cg(function(c,d,b){null!=d&&"function"!=typeof d.toString&&(d=hf.call(d)),c[d]=b},X1(to)),jE=cg(function(c,d,b){null!=d&&"function"!=typeof d.toString&&(d=hf.call(d)),$i.call(c,d)?c[d].push(b):c[d]=[b]},bn),GE=Wn(eg);function Ro(c){return No(c)?vr(c):T_(c)}function Is(c){return No(c)?vr(c,!0):function Nw(c){if(!ur(c))return function j_(c){var d=[];if(null!=c)for(var b in Xi(c))d.push(b);return d}(c);var d=uh(c),b=[];for(var I in c)"constructor"==I&&(d||!$i.call(c,I))||b.push(I);return b}(c)}var $E=fo(function(c,d,b){ig(c,d,b)}),v0=fo(function(c,d,b,I){ig(c,d,b,I)}),Rg=Gl(function(c,d){var b={};if(null==c)return b;var I=!1;d=kr(d,function(Y){return Y=da(Y,c),I||(I=Y.length>1),Y}),La(c,Ku(c),b),I&&(b=xs(b,7,nu));for(var k=d.length;k--;)wc(b,d[k]);return b}),y0=Gl(function(c,d){return null==c?{}:function Uv(c,d){return Hv(c,d,function(b,I){return b0(c,I)})}(c,d)});function W1(c,d){if(null==c)return{};var b=kr(Ku(c),function(I){return[I]});return d=bn(d),Hv(c,b,function(I,k){return d(I,k[0])})}var gn=$v(Ro),C0=$v(Is);function bh(c){return null==c?[]:cf(c,Ro(c))}var JE=sh(function(c,d,b){return d=d.toLowerCase(),c+(b?$1(d):d)});function $1(c){return Ss(Ri(c).toLowerCase())}function x0(c){return(c=Ri(c))&&c.replace(oa,pw).replace(Ap,"")}var i2=sh(function(c,d,b){return c+(b?"-":"")+d.toLowerCase()}),r2=sh(function(c,d,b){return c+(b?" ":"")+d.toLowerCase()}),o2=jl("toLowerCase"),AD=sh(function(c,d,b){return c+(b?"_":"")+d.toLowerCase()}),PD=sh(function(c,d,b){return c+(b?" ":"")+Ss(d)}),vh=sh(function(c,d,b){return c+(b?" ":"")+d.toUpperCase()}),Ss=jl("toUpperCase");function za(c,d,b){return c=Ri(c),(d=b?A:d)===A?function Lp(ae){return ow.test(ae)}(c)?function Bp(ae){return ae.match(t_)||[]}(c):function hw(ae){return ae.match(Pu)||[]}(c):c.match(d)||[]}var I0=Wn(function(c,d){try{return Fa(c,A,d)}catch(b){return Rf(b)?b:new Bn(b)}}),FD=Gl(function(c,d){return js(d,function(b){b=dl(b),ol(c,b,gl(c[b],c))}),c});function X1(c){return function(){return c}}var Q1=lg(),RD=lg(!0);function to(c){return c}function Vf(c){return E_("function"==typeof c?c:xs(c,1))}var yh=Wn(function(c,d){return function(b){return eg(b,c,d)}}),M0=Wn(function(c,d){return function(b){return eg(c,b,d)}});function Ug(c,d,b){var I=Ro(d),k=eh(d,I);null==b&&(!ur(d)||!k.length&&I.length)&&(b=d,d=c,c=this,k=eh(d,Ro(d)));var Y=!(ur(b)&&"chain"in b&&!b.chain),ce=$l(c);return js(k,function(ge){var Le=d[ge];c[ge]=Le,ce&&(c.prototype[ge]=function(){var gt=this.__chain__;if(Y||gt){var je=c(this.__wrapped__);return(je.__actions__=ls(this.__actions__)).push({func:Le,args:arguments,thisArg:c}),je.__chain__=gt,je}return Le.apply(c,Ru([this.value()],arguments))})}),c}function Ch(){}var d2=F_(kr),J1=F_(Pp),h2=F_(Hd);function ey(c){return ed(c)?Np(dl(c)):function nD(c){return function(d){return th(d,c)}}(c)}var ty=R_(),jf=R_(!0);function xh(){return[]}function Gf(){return!1}var ry=Xu(function(c,d){return c+d},0),m2=ug("ceil"),LD=Xu(function(c,d){return c/d},1),Hg=ug("floor"),zg=Xu(function(c,d){return c*d},1),Wf=ug("round"),cy=Xu(function(c,d){return c-d},0);return z.after=function Tg(c,d){if("function"!=typeof d)throw new Na(q);return c=Jn(c),function(){if(--c<1)return d.apply(this,arguments)}},z.ary=O1,z.assign=HE,z.assignIn=L1,z.assignInWith=Fg,z.assignWith=zE,z.at=Ng,z.before=n0,z.bind=gl,z.bindAll=FD,z.bindKey=TE,z.castArray=function Og(){if(!arguments.length)return[];var c=arguments[0];return $n(c)?c:[c]},z.chain=xg,z.chunk=function vo(c,d,b){d=(b?Es(c,d,b):d===A)?1:Po(Jn(d),0);var I=null==c?0:c.length;if(!I||d<1)return[];for(var k=0,Y=0,ce=et(Gp(I/d));k<I;)ce[Y++]=ua(c,k,k+=d);return ce},z.compact=function qw(c){for(var d=-1,b=null==c?0:c.length,I=0,k=[];++d<b;){var Y=c[d];Y&&(k[I++]=Y)}return k},z.concat=function cs(){var c=arguments.length;if(!c)return[];for(var d=et(c-1),b=arguments[0],I=c;I--;)d[I-1]=arguments[I];return Ru($n(b)?ls(b):[b],$o(d,1))},z.cond=function l2(c){var d=null==c?0:c.length,b=bn();return c=d?kr(c,function(I){if("function"!=typeof I[1])throw new Na(q);return[b(I[0]),I[1]]}):[],Wn(function(I){for(var k=-1;++k<d;){var Y=c[k];if(Fa(Y[0],this,I))return Fa(Y[1],this,I)}})},z.conforms=function ND(c){return function Jd(c){var d=Ro(c);return function(b){return jr(b,c,d)}}(xs(c,1))},z.constant=X1,z.countBy=pE,z.create=function Ic(c,d){var b=Qc(c);return null==d?b:Jc(b,d)},z.curry=function r0(c,d,b){var I=yr(c,8,A,A,A,A,A,d=b?A:d);return I.placeholder=r0.placeholder,I},z.curryRight=function Ig(c,d,b){var I=yr(c,16,A,A,A,A,A,d=b?A:d);return I.placeholder=Ig.placeholder,I},z.debounce=A1,z.defaults=Uf,z.defaultsDeep=B1,z.defer=IE,z.delay=mD,z.difference=W_,z.differenceBy=Zw,z.differenceWith=n1,z.drop=function _g(c,d,b){var I=null==c?0:c.length;return I?ua(c,(d=b||d===A?1:Jn(d))<0?0:d,I):[]},z.dropRight=function Xw(c,d,b){var I=null==c?0:c.length;return I?ua(c,0,(d=I-(d=b||d===A?1:Jn(d)))<0?0:d):[]},z.dropRightWhile=function i1(c,d){return c&&c.length?Ef(c,bn(d,3),!0,!0):[]},z.dropWhile=function $_(c,d){return c&&c.length?Ef(c,bn(d,3),!0):[]},z.fill=function bg(c,d,b,I){var k=null==c?0:c.length;return k?(b&&"number"!=typeof b&&Es(c,d,b)&&(b=0,I=k),function sl(c,d,b,I){var k=c.length;for((b=Jn(b))<0&&(b=-b>k?0:k+b),(I=I===A||I>k?k:Jn(I))<0&&(I+=k),I=b>I?0:N1(I);b<I;)c[b++]=d;return c}(c,d,b,I)):[]},z.filter=function mE(c,d){return($n(c)?gc:Qp)(c,bn(d,3))},z.flatMap=function w1(c,d){return $o(Eg(c,d),1)},z.flatMapDeep=function E1(c,d){return $o(Eg(c,d),Ht)},z.flatMapDepth=function wg(c,d,b){return b=b===A?1:Jn(b),$o(Eg(c,d),b)},z.flatten=o1,z.flattenDeep=function Kw(c){return null!=c&&c.length?$o(c,Ht):[]},z.flattenDepth=function s1(c,d){return null!=c&&c.length?$o(c,d=d===A?1:Jn(d)):[]},z.flip=function _D(c){return yr(c,512)},z.flow=Q1,z.flowRight=RD,z.fromPairs=function Qw(c){for(var d=-1,b=null==c?0:c.length,I={};++d<b;){var k=c[d];I[k[0]]=k[1]}return I},z.functions=function _0(c){return null==c?[]:eh(c,Ro(c))},z.functionsIn=function ED(c){return null==c?[]:eh(c,Is(c))},z.groupBy=T1,z.initial=function eE(c){return null!=c&&c.length?ua(c,0,-1):[]},z.intersection=aD,z.intersectionBy=a1,z.intersectionWith=l1,z.invert=VE,z.invertBy=jE,z.invokeMap=bE,z.iteratee=Vf,z.keyBy=vE,z.keys=Ro,z.keysIn=Is,z.map=Eg,z.mapKeys=function j1(c,d){var b={};return d=bn(d,3),al(c,function(I,k,Y){ol(b,d(I,k,Y),I)}),b},z.mapValues=function WE(c,d){var b={};return d=bn(d,3),al(c,function(I,k,Y){ol(b,k,d(I,k,Y))}),b},z.matches=function S0(c){return Bv(xs(c,1))},z.matchesProperty=function c2(c,d){return ng(c,xs(d,1))},z.memoize=nd,z.merge=$E,z.mergeWith=v0,z.method=yh,z.methodOf=M0,z.mixin=Ug,z.negate=Sg,z.nthArg=function u2(c){return c=Jn(c),Wn(function(d){return S_(d,c)})},z.omit=Rg,z.omitBy=function G1(c,d){return W1(c,Sg(bn(d)))},z.once=function o0(c){return n0(2,c)},z.orderBy=function yE(c,d,b,I){return null==c?[]:($n(d)||(d=null==d?[]:[d]),$n(b=I?A:b)||(b=null==b?[]:[b]),M_(c,d,b))},z.over=d2,z.overArgs=s0,z.overEvery=J1,z.overSome=h2,z.partial=su,z.partialRight=Mg,z.partition=S1,z.pick=y0,z.pickBy=W1,z.property=ey,z.propertyOf=function f2(c){return function(d){return null==c?A:th(c,d)}},z.pull=Z_,z.pullAll=fl,z.pullAllBy=function u1(c,d,b){return c&&c.length&&d&&d.length?zi(c,d,bn(b,2)):c},z.pullAllWith=function fh(c,d,b){return c&&c.length&&d&&d.length?zi(c,d,A,b):c},z.pullAt=tE,z.range=ty,z.rangeRight=jf,z.rearg=a0,z.reject=function CE(c,d){return($n(c)?gc:Qp)(c,Sg(bn(d,3)))},z.remove=function nE(c,d){var b=[];if(!c||!c.length)return b;var I=-1,k=[],Y=c.length;for(d=bn(d,3);++I<Y;){var ce=c[I];d(ce,I,c)&&(b.push(ce),k.push(I))}return rg(c,k),b},z.rest=function Pf(c,d){if("function"!=typeof c)throw new Na(q);return Wn(c,d=d===A?d:Jn(d))},z.reverse=vg,z.sampleSize=function gD(c,d,b){return d=(b?Es(c,d,b):d===A)?1:Jn(d),($n(c)?Kd:ca)(c,d)},z.set=function eo(c,d,b){return null==c?c:Cf(c,d,b)},z.setWith=function YE(c,d,b,I){return I="function"==typeof I?I:A,null==c?c:Cf(c,d,b,I)},z.shuffle=function wE(c){return($n(c)?xc:Hl)(c)},z.slice=function cD(c,d,b){var I=null==c?0:c.length;return I?(b&&"number"!=typeof b&&Es(c,d,b)?(d=0,b=I):(d=null==d?0:Jn(d),b=b===A?I:Jn(b)),ua(c,d,b)):[]},z.sortBy=EE,z.sortedUniq=function _r(c){return c&&c.length?sg(c):[]},z.sortedUniqBy=function d1(c,d){return c&&c.length?sg(c,bn(d,2)):[]},z.split=function kD(c,d,b){return b&&"number"!=typeof b&&Es(c,d,b)&&(d=b=A),(b=b===A?xi:b>>>0)?(c=Ri(c))&&("string"==typeof d||null!=d&&!Lf(d))&&!(d=as(d))&&_c(c)?eu(lo(c),0,b):c.split(d,b):[]},z.spread=function Dg(c,d){if("function"!=typeof c)throw new Na(q);return d=null==d?0:Po(Jn(d),0),Wn(function(b){var I=b[d],k=eu(b,0,d);return I&&Ru(k,I),Fa(c,this,k)})},z.tail=function rE(c){var d=null==c?0:c.length;return d?ua(c,1,d):[]},z.take=function X_(c,d,b){return c&&c.length?ua(c,0,(d=b||d===A?1:Jn(d))<0?0:d):[]},z.takeRight=function Qn(c,d,b){var I=null==c?0:c.length;return I?ua(c,(d=I-(d=b||d===A?1:Jn(d)))<0?0:d,I):[]},z.takeRightWhile=function oE(c,d){return c&&c.length?Ef(c,bn(d,3),!1,!0):[]},z.takeWhile=function K_(c,d){return c&&c.length?Ef(c,bn(d,3)):[]},z.tap=function us(c,d){return d(c),c},z.throttle=function gh(c,d,b){var I=!0,k=!0;if("function"!=typeof c)throw new Na(q);return ur(b)&&(I="leading"in b?!!b.leading:I,k="trailing"in b?!!b.trailing:k),A1(c,d,{leading:I,maxWait:d,trailing:k})},z.thru=ou,z.toArray=_l,z.toPairs=gn,z.toPairsIn=C0,z.toPath=function rd(c){return $n(c)?kr(c,dl):yo(c)?[c]:ls(t1(Ri(c)))},z.toPlainObject=R1,z.transform=function qE(c,d,b){var I=$n(c),k=I||lu(c)||_h(c);if(d=bn(d,4),null==b){var Y=c&&c.constructor;b=k?I?new Y:[]:ur(c)&&$l(Y)?Qc(ff(c)):{}}return(k?js:al)(c,function(ce,ge,Le){return d(b,ce,ge,Le)}),b},z.unary=function l0(c){return O1(c,1)},z.union=Af,z.unionBy=sE,z.unionWith=h1,z.uniq=function f1(c){return c&&c.length?zl(c):[]},z.uniqBy=function yg(c,d){return c&&c.length?zl(c,bn(d,2)):[]},z.uniqWith=function Cg(c,d){return d="function"==typeof d?d:A,c&&c.length?zl(c,A,d):[]},z.unset=function ZE(c,d){return null==c||wc(c,d)},z.unzip=kf,z.unzipWith=p1,z.update=function XE(c,d,b){return null==c?c:Mn(c,d,ag(b))},z.updateWith=function KE(c,d,b,I){return I="function"==typeof I?I:A,null==c?c:Mn(c,d,ag(b),I)},z.values=bh,z.valuesIn=function TD(c){return null==c?[]:cf(c,Is(c))},z.without=aE,z.words=za,z.wrap=function c0(c,d){return su(ag(d),c)},z.xor=lE,z.xorBy=g1,z.xorWith=cE,z.zip=uE,z.zipObject=function Ys(c,d){return zv(c||[],d||[],Qd)},z.zipObjectDeep=function Q_(c,d){return zv(c||[],d||[],Cf)},z.zipWith=m1,z.entries=gn,z.entriesIn=C0,z.extend=L1,z.extendWith=Fg,Ug(z,z),z.add=ry,z.attempt=I0,z.camelCase=JE,z.capitalize=$1,z.ceil=m2,z.clamp=function ID(c,d,b){return b===A&&(b=d,d=A),b!==A&&(b=(b=Ua(b))==b?b:0),d!==A&&(d=(d=Ua(d))==d?d:0),ss(Ua(c),d,b)},z.clone=function bD(c){return xs(c,4)},z.cloneDeep=function Ff(c){return xs(c,5)},z.cloneDeepWith=function SE(c,d){return xs(c,5,d="function"==typeof d?d:A)},z.cloneWith=function u0(c,d){return xs(c,4,d="function"==typeof d?d:A)},z.conformsTo=function k1(c,d){return null==d||jr(c,d,Ro(d))},z.deburr=x0,z.defaultTo=function K1(c,d){return null==c||c!=c?d:c},z.divide=LD,z.endsWith=function e2(c,d,b){c=Ri(c),d=as(d);var I=c.length,k=b=b===A?I:ss(Jn(b),0,I);return(b-=d.length)>=0&&c.slice(b,k)==d},z.eq=ml,z.escape=function t2(c){return(c=Ri(c))&&Zi.test(c)?c.replace(kd,Gs):c},z.escapeRegExp=function n2(c){return(c=Ri(c))&&fc.test(c)?c.replace(Yc,"\\$&"):c},z.every=function gE(c,d,b){var I=$n(c)?Pp:Yu;return b&&Es(c,d,b)&&(d=A),I(c,bn(d,3))},z.find=_E,z.findIndex=Y_,z.findKey=function U1(c,d){return c_(c,bn(d,3),al)},z.findLast=x1,z.findLastIndex=r1,z.findLastKey=function H1(c,d){return c_(c,bn(d,3),w_)},z.floor=Hg,z.forEach=J_,z.forEachRight=e0,z.forIn=function CD(c,d){return null==c?c:x_(c,bn(d,3),Is)},z.forInRight=function xD(c,d){return null==c?c:Jp(c,bn(d,3),Is)},z.forOwn=function wD(c,d){return c&&al(c,bn(d,3))},z.forOwnRight=function m0(c,d){return c&&w_(c,bn(d,3))},z.get=z1,z.gt=ME,z.gte=d0,z.has=function V1(c,d){return null!=c&&Zv(c,d,Z3)},z.hasIn=b0,z.head=q_,z.identity=to,z.includes=function I1(c,d,b,I){c=No(c)?c:bh(c),b=b&&!I?Jn(b):0;var k=c.length;return b<0&&(b=Po(k+b,0)),Bf(c)?b<=k&&c.indexOf(d,b)>-1:!!k&&zd(c,d,b)>-1},z.indexOf=function Jw(c,d,b){var I=null==c?0:c.length;if(!I)return-1;var k=null==b?0:Jn(b);return k<0&&(k=Po(I+k,0)),zd(c,d,k)},z.inRange=function Hf(c,d,b){return d=Tc(d),b===A?(b=d,d=0):b=Tc(b),function K3(c,d,b){return c>=Fo(d,b)&&c<Po(d,b)}(c=Ua(c),d,b)},z.invoke=GE,z.isArguments=au,z.isArray=$n,z.isArrayBuffer=DE,z.isArrayLike=No,z.isArrayLikeObject=Gr,z.isBoolean=function h0(c){return!0===c||!1===c||Fr(c)&&$s(c)==jn},z.isBuffer=lu,z.isDate=vD,z.isElement=function yD(c){return Fr(c)&&1===c.nodeType&&!cu(c)},z.isEmpty=function Nf(c){if(null==c)return!0;if(No(c)&&($n(c)||"string"==typeof c||"function"==typeof c.splice||lu(c)||_h(c)||au(c)))return!c.length;var d=po(c);if(d==ln||d==lr)return!c.size;if(uh(c))return!T_(c).length;for(var b in c)if($i.call(c,b))return!1;return!0},z.isEqual=function OE(c,d){return nh(c,d)},z.isEqualWith=function Ag(c,d,b){var I=(b="function"==typeof b?b:A)?b(c,d):A;return I===A?nh(c,d,A,b):!!I},z.isError=Rf,z.isFinite=function AE(c){return"number"==typeof c&&$p(c)},z.isFunction=$l,z.isInteger=kg,z.isLength=id,z.isMap=f0,z.isMatch=function P1(c,d){return c===d||Rv(c,d,Mf(d))},z.isMatchWith=function Pg(c,d,b){return b="function"==typeof b?b:A,Rv(c,d,Mf(d),b)},z.isNaN=function p0(c){return FE(c)&&c!=+c},z.isNative=function mh(c){if(Kv(c))throw new Bn("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return Pw(c)},z.isNil=function PE(c){return null==c},z.isNull=function kE(c){return null===c},z.isNumber=FE,z.isObject=ur,z.isObjectLike=Fr,z.isPlainObject=cu,z.isRegExp=Lf,z.isSafeInteger=function F1(c){return kg(c)&&c>=-zn&&c<=zn},z.isSet=g0,z.isString=Bf,z.isSymbol=yo,z.isTypedArray=_h,z.isUndefined=function NE(c){return c===A},z.isWeakMap=function RE(c){return Fr(c)&&po(c)==Ll},z.isWeakSet=function LE(c){return Fr(c)&&"[object WeakSet]"==$s(c)},z.join=function Ts(c,d){return null==c?"":Sv.call(c,d)},z.kebabCase=i2,z.last=hl,z.lastIndexOf=function c1(c,d,b){var I=null==c?0:c.length;if(!I)return-1;var k=I;return b!==A&&(k=(k=Jn(b))<0?Po(I+k,0):Fo(k,I-1)),d==d?function q3(ae,ut,et){for(var Qt=et+1;Qt--;)if(ae[Qt]===ut)return Qt;return Qt}(c,d,k):mc(c,bv,k,!0)},z.lowerCase=r2,z.lowerFirst=o2,z.lt=BE,z.lte=fa,z.max=function _2(c){return c&&c.length?qu(c,to,Pv):A},z.maxBy=function oy(c,d){return c&&c.length?qu(c,bn(d,2),Pv):A},z.mean=function sy(c){return kn(c,to)},z.meanBy=function ay(c,d){return kn(c,bn(d,2))},z.min=function A0(c){return c&&c.length?qu(c,to,tg):A},z.minBy=function ly(c,d){return c&&c.length?qu(c,bn(d,2),tg):A},z.stubArray=xh,z.stubFalse=Gf,z.stubObject=function p2(){return{}},z.stubString=function g2(){return""},z.stubTrue=function O0(){return!0},z.multiply=zg,z.nth=function lD(c,d){return c&&c.length?S_(c,Jn(d)):A},z.noConflict=function D0(){return Kr._===this&&(Kr._=_w),this},z.noop=Ch,z.now=pl,z.pad=function w0(c,d,b){c=Ri(c);var I=(d=Jn(d))?zu(c):0;if(!d||I>=d)return c;var k=(d-I)/2;return If(Wp(k),b)+c+If(Gp(k),b)},z.padEnd=function SD(c,d,b){c=Ri(c);var I=(d=Jn(d))?zu(c):0;return d&&I<d?c+If(d-I,b):c},z.padStart=function MD(c,d,b){c=Ri(c);var I=(d=Jn(d))?zu(c):0;return d&&I<d?If(d-I,b)+c:c},z.parseInt=function E0(c,d,b){return b||null==d?d=0:d&&(d=+d),b_(Ri(c).replace(ko,""),d||0)},z.random=function QE(c,d,b){if(b&&"boolean"!=typeof b&&Es(c,d,b)&&(d=b=A),b===A&&("boolean"==typeof d?(b=d,d=A):"boolean"==typeof c&&(b=c,c=A)),c===A&&d===A?(c=0,d=1):(c=Tc(c),d===A?(d=c,c=0):d=Tc(d)),c>d){var I=c;c=d,d=I}if(b||c%1||d%1){var k=v_();return Fo(c+k*(d-c+$3("1e-"+((k+"").length-1))),d)}return Zu(c,d)},z.reduce=function pD(c,d,b){var I=$n(c)?Lu:lf,k=arguments.length<3;return I(c,bn(d,4),b,k,Pr)},z.reduceRight=function M1(c,d,b){var I=$n(c)?l_:lf,k=arguments.length<3;return I(c,bn(d,4),b,k,Kp)},z.repeat=function DD(c,d,b){return d=(b?Es(c,d,b):d===A)?1:Jn(d),D_(Ri(c),d)},z.replace=function OD(){var c=arguments,d=Ri(c[0]);return c.length<3?d:d.replace(c[1],c[2])},z.result=function Ha(c,d,b){var I=-1,k=(d=da(d,c)).length;for(k||(k=1,c=A);++I<k;){var Y=null==c?A:c[dl(d[I])];Y===A&&(I=k,Y=b),c=$l(Y)?Y.call(c):Y}return c},z.round=Wf,z.runInContext=ae,z.sample=function xE(c){return($n(c)?Xd:ih)(c)},z.size=function D1(c){if(null==c)return 0;if(No(c))return Bf(c)?zu(c):c.length;var d=po(c);return d==ln||d==lr?c.size:T_(c).length},z.snakeCase=AD,z.some=function t0(c,d,b){var I=$n(c)?Hd:Lw;return b&&Es(c,d,b)&&(d=A),I(c,bn(d,3))},z.sortedIndex=function uD(c,d){return xf(c,d)},z.sortedIndexBy=function dD(c,d,b){return wf(c,d,bn(b,2))},z.sortedIndexOf=function hD(c,d){var b=null==c?0:c.length;if(b){var I=xf(c,d);if(I<b&&ml(c[I],d))return I}return-1},z.sortedLastIndex=function fD(c,d){return xf(c,d,!0)},z.sortedLastIndexBy=function iE(c,d,b){return wf(c,d,bn(b,2),!0)},z.sortedLastIndexOf=function ph(c,d){if(null!=c&&c.length){var I=xf(c,d,!0)-1;if(ml(c[I],d))return I}return-1},z.startCase=PD,z.startsWith=function s2(c,d,b){return c=Ri(c),b=null==b?0:ss(Jn(b),0,c.length),d=as(d),c.slice(b,b+d.length)==d},z.subtract=cy,z.sum=function k0(c){return c&&c.length?Bu(c,to):0},z.sumBy=function $f(c,d){return c&&c.length?Bu(c,bn(d,2)):0},z.template=function Lg(c,d,b){var I=z.templateSettings;b&&Es(c,d,b)&&(d=A),c=Ri(c),d=Fg({},d,I,tu);var ge,Le,k=Fg({},d.imports,I.imports,tu),Y=Ro(k),ce=cf(k,Y),gt=0,je=d.interpolate||bs,h="__p += '",zt=m_((d.escape||bs).source+"|"+je.source+"|"+(je===Fd?pc:bs).source+"|"+(d.evaluate||bs).source+"|$","g"),F="//# sourceURL="+($i.call(d,"sourceURL")?(d.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++n_+"]")+"\n";c.replace(zt,function(In,ri,oi,Ms,Co,qs){return oi||(oi=Ms),h+=c.slice(gt,qs).replace(Fu,Vd),ri&&(ge=!0,h+="' +\n__e("+ri+") +\n'"),Co&&(Le=!0,h+="';\n"+Co+";\n__p += '"),oi&&(h+="' +\n((__t = ("+oi+")) == null ? '' : __t) +\n'"),gt=qs+In.length,In}),h+="';\n";var Tn=$i.call(d,"variable")&&d.variable;if(Tn){if(it.test(Tn))throw new Bn("Invalid `variable` option passed into `_.template`")}else h="with (obj) {\n"+h+"\n}\n";h=(Le?h.replace(jc,""):h).replace(Gc,"$1").replace(Ls,"$1;"),h="function("+(Tn||"obj")+") {\n"+(Tn?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(ge?", __e = _.escape":"")+(Le?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+h+"return __p\n}";var ei=I0(function(){return _i(Y,F+"return "+h).apply(A,ce)});if(ei.source=h,Rf(ei))throw ei;return ei},z.times=function ny(c,d){if((c=Jn(c))<1||c>zn)return[];var b=xi,I=Fo(c,xi);d=bn(d),c-=xi;for(var k=d_(I,d);++b<c;)d(b);return k},z.toFinite=Tc,z.toInteger=Jn,z.toLength=N1,z.toLower=function Bg(c){return Ri(c).toLowerCase()},z.toNumber=Ua,z.toSafeInteger=function UE(c){return c?ss(Jn(c),-zn,zn):0===c?c:0},z.toString=Ri,z.toUpper=function T0(c){return Ri(c).toUpperCase()},z.trim=function Y1(c,d,b){if((c=Ri(c))&&(b||d===A))return vv(c);if(!c||!(d=as(d)))return c;var I=lo(c),k=lo(d);return eu(I,Rp(I,k),yv(I,k)+1).join("")},z.trimEnd=function q1(c,d,b){if((c=Ri(c))&&(b||d===A))return c.slice(0,Ti(c)+1);if(!c||!(d=as(d)))return c;var I=lo(c);return eu(I,0,yv(I,lo(d))+1).join("")},z.trimStart=function a2(c,d,b){if((c=Ri(c))&&(b||d===A))return c.replace(ko,"");if(!c||!(d=as(d)))return c;var I=lo(c);return eu(I,Rp(I,lo(d))).join("")},z.truncate=function zf(c,d){var b=30,I="...";if(ur(d)){var k="separator"in d?d.separator:k;b="length"in d?Jn(d.length):b,I="omission"in d?as(d.omission):I}var Y=(c=Ri(c)).length;if(_c(c)){var ce=lo(c);Y=ce.length}if(b>=Y)return c;var ge=b-zu(I);if(ge<1)return I;var Le=ce?eu(ce,0,ge).join(""):c.slice(0,ge);if(k===A)return Le+I;if(ce&&(ge+=Le.length-ge),Lf(k)){if(c.slice(ge).search(k)){var gt,je=Le;for(k.global||(k=m_(k.source,Ri(qc.exec(k))+"g")),k.lastIndex=0;gt=k.exec(je);)var h=gt.index;Le=Le.slice(0,h===A?ge:h)}}else if(c.indexOf(as(k),ge)!=ge){var zt=Le.lastIndexOf(k);zt>-1&&(Le=Le.slice(0,zt))}return Le+I},z.unescape=function Z1(c){return(c=Ri(c))&&$c.test(c)?c.replace(Wc,Gd):c},z.uniqueId=function iy(c){var d=++gw;return Ri(c)+d},z.upperCase=vh,z.upperFirst=Ss,z.each=J_,z.eachRight=e0,z.first=q_,Ug(z,function(){var c={};return al(z,function(d,b){$i.call(z.prototype,b)||(c[b]=d)}),c}(),{chain:!1}),z.VERSION="4.17.21",js(["bind","bindKey","curry","curryRight","partial","partialRight"],function(c){z[c].placeholder=z}),js(["drop","take"],function(c,d){ai.prototype[c]=function(b){b=b===A?1:Po(Jn(b),0);var I=this.__filtered__&&!d?new ai(this):this.clone();return I.__filtered__?I.__takeCount__=Fo(b,I.__takeCount__):I.__views__.push({size:Fo(b,xi),type:c+(I.__dir__<0?"Right":"")}),I},ai.prototype[c+"Right"]=function(b){return this.reverse()[c](b).reverse()}}),js(["filter","map","takeWhile"],function(c,d){var b=d+1,I=1==b||3==b;ai.prototype[c]=function(k){var Y=this.clone();return Y.__iteratees__.push({iteratee:bn(k,3),type:b}),Y.__filtered__=Y.__filtered__||I,Y}}),js(["head","last"],function(c,d){var b="take"+(d?"Right":"");ai.prototype[c]=function(){return this[b](1).value()[0]}}),js(["initial","tail"],function(c,d){var b="drop"+(d?"":"Right");ai.prototype[c]=function(){return this.__filtered__?new ai(this):this[b](1)}}),ai.prototype.compact=function(){return this.filter(to)},ai.prototype.find=function(c){return this.filter(c).head()},ai.prototype.findLast=function(c){return this.reverse().find(c)},ai.prototype.invokeMap=Wn(function(c,d){return"function"==typeof c?new ai(this):this.map(function(b){return eg(b,c,d)})}),ai.prototype.reject=function(c){return this.filter(Sg(bn(c)))},ai.prototype.slice=function(c,d){c=Jn(c);var b=this;return b.__filtered__&&(c>0||d<0)?new ai(b):(c<0?b=b.takeRight(-c):c&&(b=b.drop(c)),d!==A&&(b=(d=Jn(d))<0?b.dropRight(-d):b.take(d-c)),b)},ai.prototype.takeRightWhile=function(c){return this.reverse().takeWhile(c).reverse()},ai.prototype.toArray=function(){return this.take(xi)},al(ai.prototype,function(c,d){var b=/^(?:filter|find|map|reject)|While$/.test(d),I=/^(?:head|last)$/.test(d),k=z[I?"take"+("last"==d?"Right":""):d],Y=I||/^find/.test(d);k&&(z.prototype[d]=function(){var ce=this.__wrapped__,ge=I?[1]:arguments,Le=ce instanceof ai,gt=ge[0],je=Le||$n(ce),h=function(ri){var oi=k.apply(z,Ru([ri],ge));return I&&zt?oi[0]:oi};je&&b&&"function"==typeof gt&&1!=gt.length&&(Le=je=!1);var zt=this.__chain__,Tn=Y&&!zt,ei=Le&&!this.__actions__.length;if(!Y&&je){ce=ei?ce:new ai(this);var In=c.apply(ce,ge);return In.__actions__.push({func:ou,args:[h],thisArg:A}),new la(In,zt)}return Tn&&ei?c.apply(this,ge):(In=this.thru(h),Tn?I?In.value()[0]:In.value():In)})}),js(["pop","push","shift","sort","splice","unshift"],function(c){var d=Hp[c],b=/^(?:push|sort|unshift)$/.test(c)?"tap":"thru",I=/^(?:pop|shift)$/.test(c);z.prototype[c]=function(){var k=arguments;if(I&&!this.__chain__){var Y=this.value();return d.apply($n(Y)?Y:[],k)}return this[b](function(ce){return d.apply($n(ce)?ce:[],k)})}}),al(ai.prototype,function(c,d){var b=z[d];if(b){var I=b.name+"";$i.call(Cs,I)||(Cs[I]=[]),Cs[I].push({name:d,func:b})}}),Cs[lh(A,2).name]=[{name:"wrapper",func:A}],ai.prototype.clone=function Yd(){var c=new ai(this.__wrapped__);return c.__actions__=ls(this.__actions__),c.__dir__=this.__dir__,c.__filtered__=this.__filtered__,c.__iteratees__=ls(this.__iteratees__),c.__takeCount__=this.__takeCount__,c.__views__=ls(this.__views__),c},ai.prototype.reverse=function ww(){if(this.__filtered__){var c=new ai(this);c.__dir__=-1,c.__filtered__=!0}else(c=this.clone()).__dir__*=-1;return c},ai.prototype.value=function Ew(){var c=this.__wrapped__.value(),d=this.__dir__,b=$n(c),I=d<0,k=b?c.length:0,Y=function Gw(c,d,b){for(var I=-1,k=b.length;++I<k;){var Y=b[I],ce=Y.size;switch(Y.type){case"drop":c+=ce;break;case"dropRight":d-=ce;break;case"take":d=Fo(d,c+ce);break;case"takeRight":c=Po(c,d-ce)}}return{start:c,end:d}}(0,k,this.__views__),ce=Y.start,ge=Y.end,Le=ge-ce,gt=I?ge:ce-1,je=this.__iteratees__,h=je.length,zt=0,F=Fo(Le,this.__takeCount__);if(!b||!I&&k==Le&&F==Le)return Bw(c,this.__actions__);var Tn=[];e:for(;Le--&&zt<F;){for(var ei=-1,In=c[gt+=d];++ei<h;){var ri=je[ei],Ms=ri.type,Co=(0,ri.iteratee)(In);if(2==Ms)In=Co;else if(!Co){if(1==Ms)continue e;break e}}Tn[zt++]=In}return Tn},z.prototype.at=_1,z.prototype.chain=function b1(){return xg(this)},z.prototype.commit=function dE(){return new la(this.value(),this.__chain__)},z.prototype.next=function v1(){this.__values__===A&&(this.__values__=_l(this.value()));var c=this.__index__>=this.__values__.length;return{done:c,value:c?A:this.__values__[this.__index__++]}},z.prototype.plant=function y1(c){for(var d,b=this;b instanceof bf;){var I=td(b);I.__index__=0,I.__values__=A,d?k.__wrapped__=I:d=I;var k=I;b=b.__wrapped__}return k.__wrapped__=c,d},z.prototype.reverse=function fE(){var c=this.__wrapped__;if(c instanceof ai){var d=c;return this.__actions__.length&&(d=new ai(this)),(d=d.reverse()).__actions__.push({func:ou,args:[vg],thisArg:A}),new la(d,this.__chain__)}return this.thru(vg)},z.prototype.toJSON=z.prototype.valueOf=z.prototype.value=function C1(){return Bw(this.__wrapped__,this.__actions__)},z.prototype.first=z.prototype.head,Qr&&(z.prototype[Qr]=function hE(){return this}),z}();Kr._=Ws,(R=function(){return Ws}.call(Fe,me,Fe,Nt))!==A&&(Nt.exports=R)}.call(this)},1741:(Nt,Fe,me)=>{var R=me(5662),A=me(3192);function oe(te){this._init(te)}oe.prototype={_init:function(te){te=te||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=te.onData,this._onEndCallback=te.onEnd},_createTable:function(){for(var te=A.createBuffer(8,R.TABLE_LENGTH),K=0;K<R.TABLE_LENGTH;K++)te[K]=R.BASE62TABLE.charCodeAt(K);return te},_onData:function(te,K){var q=A.bufferToString_fast(te,K);this._onDataCallback?this._onDataCallback(q):this._result+=q},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var te=2,K=this._data,q=this._offset,W=R.BUFFER_MAX;if(this._dataLen-q<W&&(W=this._dataLen-q),te>W)return!1;var $,he,ye,de,Ve,ie=q-R.WINDOW_BUFFER_MAX,Q=K.substring(ie,q+W),H=q+te-3-ie;do{if(2===te){if(he=K.charAt(q)+K.charAt(q+1),!~(ye=Q.indexOf(he))||ye>H)break}else 3===te?he+=K.charAt(q+2):he=K.substr(q,te);if(!~(de=R.STRING_LASTINDEXOF_BUG?K.substring(ie,q+te-1).lastIndexOf(he):Q.lastIndexOf(he,H)))break;Ve=de,$=ie+de;do{if(K.charCodeAt(q+te)!==K.charCodeAt($+te))break}while(++te<W);if(ye===de){te++;break}}while(++te<W);return 2!==te&&(this._index=R.WINDOW_BUFFER_MAX-Ve,this._length=te-1,!0)},compress:function(te){if(null==te||0===te.length)return"";var K,q=this._createTable(),W=A.createWindow(),ie=A.createBuffer(8,R.COMPRESS_CHUNK_SIZE),Q=0;this._result="",this._offset=W.length,this._data=W+te,this._dataLen=this._data.length,W=te=null;for(var he,ye,de,Ve,Je,H=-1,$=-1;this._offset<this._dataLen;)this._search()?(this._index<R.BUFFER_MAX?(ye=this._index,de=0):de=(this._index-(ye=this._index%R.BUFFER_MAX))/R.BUFFER_MAX,2===this._length?(ie[Q++]=q[de+R.COMPRESS_FIXED_START],ie[Q++]=q[ye]):(ie[Q++]=q[de+R.COMPRESS_START],ie[Q++]=q[ye],ie[Q++]=q[this._length]),this._offset+=this._length,~$&&($=-1)):(he=this._data.charCodeAt(this._offset++))<R.LATIN_BUFFER_MAX?(he<R.UNICODE_CHAR_MAX?(ye=he,de=0,H=R.LATIN_INDEX):H=(de=(he-(ye=he%R.UNICODE_CHAR_MAX))/R.UNICODE_CHAR_MAX)+R.LATIN_INDEX,$===H?ie[Q++]=q[ye]:(ie[Q++]=q[H-R.LATIN_INDEX_START],ie[Q++]=q[ye],$=H)):(he<R.UNICODE_BUFFER_MAX?(ye=he,de=0,H=R.UNICODE_INDEX):H=(de=(he-(ye=he%R.UNICODE_BUFFER_MAX))/R.UNICODE_BUFFER_MAX)+R.UNICODE_INDEX,ye<R.UNICODE_CHAR_MAX?(Ve=ye,Je=0):Je=(ye-(Ve=ye%R.UNICODE_CHAR_MAX))/R.UNICODE_CHAR_MAX,$===H?(ie[Q++]=q[Ve],ie[Q++]=q[Je]):(ie[Q++]=q[R.CHAR_START],ie[Q++]=q[H-R.TABLE_LENGTH],ie[Q++]=q[Ve],ie[Q++]=q[Je],$=H)),Q>=R.COMPRESS_CHUNK_MAX&&(this._onData(ie,Q),Q=0);return Q>0&&this._onData(ie,Q),this._onEnd(),K=this._result,this._result=null,null===K?"":K}},Nt.exports=oe},5662:(Nt,Fe)=>{var me=Fe.HAS_TYPED=typeof Uint8Array<"u"&&typeof Uint16Array<"u",R=!1,A=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(R=!0)}catch{}if(me)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(A=!0)}catch{}Fe.CAN_CHARCODE_APPLY=R,Fe.CAN_CHARCODE_APPLY_TYPED=A;var oe=Fe.APPLY_BUFFER_SIZE=65533;Fe.APPLY_BUFFER_SIZE_OK=null;var te=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(te=!0),Fe.STRING_LASTINDEXOF_BUG=te;var K=Fe.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",q=Fe.TABLE_LENGTH=K.length,W=Math.max(q,62)-Math.min(q,62);Fe.BUFFER_MAX=q-1;var ie=Fe.WINDOW_MAX=1024;Fe.WINDOW_BUFFER_MAX=304;var Q=Fe.COMPRESS_CHUNK_SIZE=oe;Fe.COMPRESS_CHUNK_MAX=Q-q;var H=Fe.DECOMPRESS_CHUNK_SIZE=oe;Fe.DECOMPRESS_CHUNK_MAX=H+2*ie,Fe.LATIN_BUFFER_MAX=132;var he=Fe.UNICODE_CHAR_MAX=40;Fe.UNICODE_BUFFER_MAX=he*(he+1),Fe.LATIN_INDEX=q+1,Fe.LATIN_INDEX_START=W+20,Fe.UNICODE_INDEX=q+5,Fe.DECODE_MAX=q-W-19;var ye=Fe.LATIN_DECODE_MAX=he+7,de=Fe.CHAR_START=ye+1,Ve=Fe.COMPRESS_START=de+1,Je=Fe.COMPRESS_FIXED_START=Ve+5;Fe.COMPRESS_INDEX=Je+5},2062:(Nt,Fe,me)=>{var R=me(5662),A=me(3192);function oe(te){this._init(te)}oe.prototype={_init:function(te){te=te||{},this._result=null,this._onDataCallback=te.onData,this._onEndCallback=te.onEnd},_createTable:function(){for(var te={},K=0;K<R.TABLE_LENGTH;K++)te[R.BASE62TABLE.charAt(K)]=K;return te},_onData:function(te){var K;if(this._onDataCallback){if(te)K=this._result,this._result=[];else{var q=R.DECOMPRESS_CHUNK_SIZE-R.WINDOW_MAX;K=this._result.slice(R.WINDOW_MAX,R.WINDOW_MAX+q),this._result=this._result.slice(0,R.WINDOW_MAX).concat(this._result.slice(R.WINDOW_MAX+q))}K.length>0&&this._onDataCallback(A.bufferToString_fast(K))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(te){if(null==te||0===te.length)return"";this._result=A.stringToArray(A.createWindow());for(var K,$,he,ye,Ve,Je,Lt,Ae,ot,rt,q=this._createTable(),W=!1,ie=null,Q=te.length,H=0;H<Q;H++)if(void 0!==(he=q[te.charAt(H)])){if(he<R.DECODE_MAX)Ve=W?q[te.charAt(++H)]*R.UNICODE_CHAR_MAX+he+R.UNICODE_BUFFER_MAX*ie:ie*R.UNICODE_CHAR_MAX+he,this._result[this._result.length]=Ve;else if(he<R.LATIN_DECODE_MAX)ie=he-R.DECODE_MAX,W=!1;else if(he===R.CHAR_START)ie=(ye=q[te.charAt(++H)])-5,W=!0;else if(he<R.COMPRESS_INDEX){if(ye=q[te.charAt(++H)],he<R.COMPRESS_FIXED_START?(Je=(he-R.COMPRESS_START)*R.BUFFER_MAX+ye,Lt=q[te.charAt(++H)]):(Je=(he-R.COMPRESS_FIXED_START)*R.BUFFER_MAX+ye,Lt=2),(Ae=this._result.slice(-Je)).length>Lt&&(Ae.length=Lt),ot=Ae.length,Ae.length>0)for(rt=0;rt<Lt;)for($=0;$<ot&&(this._result[this._result.length]=Ae[$],!(++rt>=Lt));$++);ie=null}this._result.length>=R.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(R.WINDOW_MAX),this._onData(!0),this._onEnd(),K=A.bufferToString_fast(this._result),this._result=null,K}},Nt.exports=oe},1782:(Nt,Fe,me)=>{var R=me(1741),A=me(2062);Fe.version=me(4469).version,Fe.compress=function(oe,te){return new R(te).compress(oe)},Fe.decompress=function(oe,te){return new A(te).decompress(oe)}},3192:(Nt,Fe,me)=>{var R=me(5662),A=String.fromCharCode;Fe.createBuffer=function(q,W){if(!R.HAS_TYPED)return new Array(W);switch(q){case 8:return new Uint8Array(W);case 16:return new Uint16Array(W)}};var oe=Fe.truncateBuffer=function(q,W){return q.length===W?q:q.subarray?q.subarray(0,W):(q.length=W,q)};Fe.bufferToString_fast=function(q,W){if(null==W?W=q.length:q=oe(q,W),R.CAN_CHARCODE_APPLY&&R.CAN_CHARCODE_APPLY_TYPED){var ie=q.length;if(ie<R.APPLY_BUFFER_SIZE&&R.APPLY_BUFFER_SIZE_OK)return A.apply(null,q);if(null===R.APPLY_BUFFER_SIZE_OK)try{var Q=A.apply(null,q);return ie>R.APPLY_BUFFER_SIZE&&(R.APPLY_BUFFER_SIZE_OK=!0),Q}catch{R.APPLY_BUFFER_SIZE_OK=!1}}return te(q)};var te=Fe.bufferToString_chunked=function(q){for(var H,W="",ie=q.length,Q=0;Q<ie;){if(H=q.subarray?q.subarray(Q,Q+R.APPLY_BUFFER_SIZE):q.slice(Q,Q+R.APPLY_BUFFER_SIZE),Q+=R.APPLY_BUFFER_SIZE,!R.APPLY_BUFFER_SIZE_OK){if(null===R.APPLY_BUFFER_SIZE_OK)try{W+=A.apply(null,H),H.length>R.APPLY_BUFFER_SIZE&&(R.APPLY_BUFFER_SIZE_OK=!0);continue}catch{R.APPLY_BUFFER_SIZE_OK=!1}return K(q)}W+=A.apply(null,H)}return W},K=Fe.bufferToString_slow=function(q){for(var W="",ie=q.length,Q=0;Q<ie;Q++)W+=A(q[Q]);return W};Fe.stringToArray=function(q){for(var W=[],ie=q&&q.length,Q=0;Q<ie;Q++)W[Q]=q.charCodeAt(Q);return W},Fe.createWindow=function(){for(var q=R.WINDOW_MAX>>7,W="        ";!(q&R.WINDOW_MAX);)W+=W,q<<=1;return W}},4999:(Nt,Fe,me)=>{Fe.encode=me(5013).encode,Fe.decode=me(2813).decode,Fe.Encoder=me(6951).Encoder,Fe.Decoder=me(2335).Decoder,Fe.createCodec=me(2032).createCodec,Fe.codec=me(4197).codec},7865:function(Nt){function Fe(me){return me&&me.isBuffer&&me}Nt.exports=Fe(typeof Buffer<"u"&&Buffer)||Fe(this.Buffer)||Fe(typeof window<"u"&&window.Buffer)||this.Buffer},5066:(Nt,Fe)=>{Fe.copy=function oe(te,K,q,W){var ie;q||(q=0),!W&&0!==W&&(W=this.length),K||(K=0);var Q=W-q;if(te===this&&q<K&&K<W)for(ie=Q-1;ie>=0;ie--)te[ie+K]=this[ie+q];else for(ie=0;ie<Q;ie++)te[ie+K]=this[ie+q];return Q},Fe.toString=function A(te,K,q){var W=this,ie=0|K;q||(q=W.length);for(var Q="",H=0;ie<q;)(H=W[ie++])<128?Q+=String.fromCharCode(H):(192==(224&H)?H=(31&H)<<6|63&W[ie++]:224==(240&H)?H=(15&H)<<12|(63&W[ie++])<<6|63&W[ie++]:240==(248&H)&&(H=(7&H)<<18|(63&W[ie++])<<12|(63&W[ie++])<<6|63&W[ie++]),H>=65536?(H-=65536,Q+=String.fromCharCode(55296+(H>>>10),56320+(1023&H))):Q+=String.fromCharCode(H));return Q},Fe.write=function R(te,K){for(var q=this,W=K||(K|=0),ie=te.length,Q=0,H=0;H<ie;)(Q=te.charCodeAt(H++))<128?q[W++]=Q:Q<2048?(q[W++]=192|Q>>>6,q[W++]=128|63&Q):Q<55296||Q>57343?(q[W++]=224|Q>>>12,q[W++]=128|Q>>>6&63,q[W++]=128|63&Q):(Q=65536+(Q-55296<<10|te.charCodeAt(H++)-56320),q[W++]=240|Q>>>18,q[W++]=128|Q>>>12&63,q[W++]=128|Q>>>6&63,q[W++]=128|63&Q);return W-K}},5129:(Nt,Fe,me)=>{var R=me(2029),A=Nt.exports=oe(0);function oe(K){return new Array(K)}A.alloc=oe,A.concat=R.concat,A.from=function te(K){if(!R.isBuffer(K)&&R.isView(K))K=R.Uint8Array.from(K);else if(R.isArrayBuffer(K))K=new Uint8Array(K);else{if("string"==typeof K)return R.from.call(A,K);if("number"==typeof K)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(K)}},864:(Nt,Fe,me)=>{var R=me(2029),A=R.global,oe=Nt.exports=R.hasBuffer?te(0):[];function te(q){return new A(q)}oe.alloc=R.hasBuffer&&A.alloc||te,oe.concat=R.concat,oe.from=function K(q){if(!R.isBuffer(q)&&R.isView(q))q=R.Uint8Array.from(q);else if(R.isArrayBuffer(q))q=new Uint8Array(q);else{if("string"==typeof q)return R.from.call(oe,q);if("number"==typeof q)throw new TypeError('"value" argument must not be a number')}return A.from&&1!==A.from.length?A.from(q):new A(q)}},1002:(Nt,Fe,me)=>{var R=me(5066);Fe.copy=q,Fe.slice=W,Fe.toString=function ie(H,$,he){return(!te&&A.isBuffer(this)?this.toString:R.toString).apply(this,arguments)},Fe.write=function Q(H){return function $(){return(this[H]||R[H]).apply(this,arguments)}}("write");var A=me(2029),oe=A.global,te=A.hasBuffer&&"TYPED_ARRAY_SUPPORT"in oe,K=te&&!oe.TYPED_ARRAY_SUPPORT;function q(H,$,he,ye){var de=A.isBuffer(this),Ve=A.isBuffer(H);if(de&&Ve)return this.copy(H,$,he,ye);if(K||de||Ve||!A.isView(this)||!A.isView(H))return R.copy.call(this,H,$,he,ye);var Je=he||null!=ye?W.call(this,he,ye):this;return H.set(Je,$),Je.length}function W(H,$){var he=this.slice||!K&&this.subarray;if(he)return he.call(this,H,$);var ye=A.alloc.call(this,$-H);return q.call(this,ye,0,H,$),ye}},8343:(Nt,Fe,me)=>{var R=me(2029),A=Nt.exports=R.hasArrayBuffer?oe(0):[];function oe(K){return new Uint8Array(K)}A.alloc=oe,A.concat=R.concat,A.from=function te(K){if(R.isView(K)){var q=K.byteOffset,W=K.byteLength;(K=K.buffer).byteLength!==W&&(K.slice?K=K.slice(q,q+W):(K=new Uint8Array(K)).byteLength!==W&&(K=Array.prototype.slice.call(K,q,q+W)))}else{if("string"==typeof K)return R.from.call(A,K);if("number"==typeof K)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(K)}},2029:(Nt,Fe,me)=>{var R=Fe.global=me(7865),A=Fe.hasBuffer=R&&!!R.isBuffer,oe=Fe.hasArrayBuffer=typeof ArrayBuffer<"u",te=Fe.isArray=me(53);Fe.isArrayBuffer=oe?function Ve(rt){return rt instanceof ArrayBuffer||de(rt)}:Ae;var K=Fe.isBuffer=A?R.isBuffer:Ae,q=Fe.isView=oe?ArrayBuffer.isView||ot("ArrayBuffer","buffer"):Ae;Fe.alloc=he,Fe.concat=function ye(rt,qe){qe||(qe=0,Array.prototype.forEach.call(rt,function Gt(_t){qe+=_t.length}));var Ee=he.call(this!==Fe&&this||rt[0],qe),Tt=0;return Array.prototype.forEach.call(rt,function Et(_t){Tt+=H.copy.call(_t,Ee,Tt)}),Ee},Fe.from=function $(rt){return"string"==typeof rt?Je.call(this,rt):Lt(this).from(rt)};var W=Fe.Array=me(5129),ie=Fe.Buffer=me(864),Q=Fe.Uint8Array=me(8343),H=Fe.prototype=me(1002);function he(rt){return Lt(this).alloc(rt)}var de=ot("ArrayBuffer");function Je(rt){var qe=3*rt.length,ct=he.call(this,qe),Ee=H.write.call(ct,rt);return qe!==Ee&&(ct=H.slice.call(ct,0,Ee)),ct}function Lt(rt){return K(rt)?ie:q(rt)?Q:te(rt)?W:A?ie:oe?Q:W}function Ae(){return!1}function ot(rt,qe){return rt="[object "+rt+"]",function(ct){return null!=ct&&{}.toString.call(qe?ct[qe]:ct)===rt}}},2199:(Nt,Fe,me)=>{var R=me(53);Fe.createCodec=ie,Fe.install=function te(Q){for(var H in Q)oe.prototype[H]=K(oe.prototype[H],Q[H])},Fe.filter=function W(Q){return R(Q)?function q(Q){return Q=Q.slice(),function($){return Q.reduce(H,$)};function H($,he){return he($)}}(Q):Q};var A=me(2029);function oe(Q){if(!(this instanceof oe))return new oe(Q);this.options=Q,this.init()}function K(Q,H){return Q&&H?function $(){return Q.apply(this,arguments),H.apply(this,arguments)}:Q||H}function ie(Q){return new oe(Q)}oe.prototype.init=function(){var Q=this.options;return Q&&Q.uint8array&&(this.bufferish=A.Uint8Array),this},Fe.preset=ie({preset:!0})},4197:(Nt,Fe,me)=>{me(2415),me(6962),Fe.codec={preset:me(2199).preset}},9088:(Nt,Fe,me)=>{Fe.n=oe;var R=me(2415).preset;function oe(te){if(!(this instanceof oe))return new oe(te);if(te&&(this.options=te,te.codec)){var K=this.codec=te.codec;K.bufferish&&(this.bufferish=K.bufferish)}}me(3351).I.mixin(oe.prototype),oe.prototype.codec=R,oe.prototype.fetch=function(){return this.codec.decode(this)}},2813:(Nt,Fe,me)=>{Fe.decode=function A(oe,te){var K=new R(te);return K.write(oe),K.read()};var R=me(9088).n},2335:(Nt,Fe,me)=>{Fe.Decoder=oe;var R=me(8004),A=me(9088).n;function oe(te){if(!(this instanceof oe))return new oe(te);A.call(this,te)}oe.prototype=new A,R.mixin(oe.prototype),oe.prototype.decode=function(te){arguments.length&&this.write(te),this.flush()},oe.prototype.push=function(te){this.emit("data",te)},oe.prototype.end=function(te){this.decode(te),this.emit("end")}},8120:(Nt,Fe,me)=>{Fe.D=oe;var R=me(6962).preset;function oe(te){if(!(this instanceof oe))return new oe(te);if(te&&(this.options=te,te.codec)){var K=this.codec=te.codec;K.bufferish&&(this.bufferish=K.bufferish)}}me(3351).w.mixin(oe.prototype),oe.prototype.codec=R,oe.prototype.write=function(te){this.codec.encode(this,te)}},5013:(Nt,Fe,me)=>{Fe.encode=function A(oe,te){var K=new R(te);return K.write(oe),K.read()};var R=me(8120).D},6951:(Nt,Fe,me)=>{Fe.Encoder=oe;var R=me(8004),A=me(8120).D;function oe(te){if(!(this instanceof oe))return new oe(te);A.call(this,te)}oe.prototype=new A,R.mixin(oe.prototype),oe.prototype.encode=function(te){this.write(te),this.emit("data",this.read())},oe.prototype.end=function(te){arguments.length&&this.encode(te),this.flush(),this.emit("end")}},7603:(Nt,Fe,me)=>{Fe.u=function A(oe,te){if(!(this instanceof A))return new A(oe,te);this.buffer=R.from(oe),this.type=te};var R=me(2029)},5167:(Nt,Fe,me)=>{Fe.setExtPackers=function q($){$.addExtPacker(14,Error,[H,W]),$.addExtPacker(1,EvalError,[H,W]),$.addExtPacker(2,RangeError,[H,W]),$.addExtPacker(3,ReferenceError,[H,W]),$.addExtPacker(4,SyntaxError,[H,W]),$.addExtPacker(5,TypeError,[H,W]),$.addExtPacker(6,URIError,[H,W]),$.addExtPacker(10,RegExp,[Q,W]),$.addExtPacker(11,Boolean,[ie,W]),$.addExtPacker(12,String,[ie,W]),$.addExtPacker(13,Date,[Number,W]),$.addExtPacker(15,Number,[ie,W]),typeof Uint8Array<"u"&&($.addExtPacker(17,Int8Array,oe),$.addExtPacker(18,Uint8Array,oe),$.addExtPacker(19,Int16Array,oe),$.addExtPacker(20,Uint16Array,oe),$.addExtPacker(21,Int32Array,oe),$.addExtPacker(22,Uint32Array,oe),$.addExtPacker(23,Float32Array,oe),typeof Float64Array<"u"&&$.addExtPacker(24,Float64Array,oe),typeof Uint8ClampedArray<"u"&&$.addExtPacker(25,Uint8ClampedArray,oe),$.addExtPacker(26,ArrayBuffer,oe),$.addExtPacker(29,DataView,oe)),R.hasBuffer&&$.addExtPacker(27,A,R.from)};var te,R=me(2029),A=R.global,oe=R.Uint8Array.from,K={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function W($){return te||(te=me(5013).encode),te($)}function ie($){return $.valueOf()}function Q($){($=RegExp.prototype.toString.call($).split("/")).shift();var he=[$.pop()];return he.unshift($.join("/")),he}function H($){var he={};for(var ye in K)he[ye]=$[ye];return he}},1800:(Nt,Fe,me)=>{Fe.setExtUnpackers=function K($){$.addExtUnpacker(14,[q,ie(Error)]),$.addExtUnpacker(1,[q,ie(EvalError)]),$.addExtUnpacker(2,[q,ie(RangeError)]),$.addExtUnpacker(3,[q,ie(ReferenceError)]),$.addExtUnpacker(4,[q,ie(SyntaxError)]),$.addExtUnpacker(5,[q,ie(TypeError)]),$.addExtUnpacker(6,[q,ie(URIError)]),$.addExtUnpacker(10,[q,W]),$.addExtUnpacker(11,[q,Q(Boolean)]),$.addExtUnpacker(12,[q,Q(String)]),$.addExtUnpacker(13,[q,Q(Date)]),$.addExtUnpacker(15,[q,Q(Number)]),typeof Uint8Array<"u"&&($.addExtUnpacker(17,Q(Int8Array)),$.addExtUnpacker(18,Q(Uint8Array)),$.addExtUnpacker(19,[H,Q(Int16Array)]),$.addExtUnpacker(20,[H,Q(Uint16Array)]),$.addExtUnpacker(21,[H,Q(Int32Array)]),$.addExtUnpacker(22,[H,Q(Uint32Array)]),$.addExtUnpacker(23,[H,Q(Float32Array)]),typeof Float64Array<"u"&&$.addExtUnpacker(24,[H,Q(Float64Array)]),typeof Uint8ClampedArray<"u"&&$.addExtUnpacker(25,Q(Uint8ClampedArray)),$.addExtUnpacker(26,H),$.addExtUnpacker(29,[H,Q(DataView)])),R.hasBuffer&&$.addExtUnpacker(27,Q(A))};var oe,R=me(2029),A=R.global,te={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function q($){return oe||(oe=me(2813).decode),oe($)}function W($){return RegExp.apply(null,$)}function ie($){return function(he){var ye=new $;for(var de in te)ye[de]=he[de];return ye}}function Q($){return function(he){return new $(he)}}function H($){return new Uint8Array($).buffer}},2032:(Nt,Fe,me)=>{me(2415),me(6962),Fe.createCodec=me(2199).createCodec},3351:(Nt,Fe,me)=>{Fe.I=K,Fe.w=q;var R=me(2029),te="BUFFER_SHORTAGE";function K(){if(!(this instanceof K))return new K}function q(){if(!(this instanceof q))return new q}function Q(){throw new Error("method not implemented: write()")}function H(){throw new Error("method not implemented: fetch()")}function $(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function he(Ve){(this.buffers||(this.buffers=[])).push(Ve)}function ye(){return(this.buffers||(this.buffers=[])).shift()}function de(Ve){return function Je(Lt){for(var Ae in Ve)Lt[Ae]=Ve[Ae];return Lt}}K.mixin=de(function W(){return{bufferish:R,write:function Ve(Ae){var ot=this.offset?R.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=ot?Ae?this.bufferish.concat([ot,Ae]):ot:Ae,this.offset=0},fetch:H,flush:function Je(){for(;this.offset<this.buffer.length;){var ot,Ae=this.offset;try{ot=this.fetch()}catch(rt){if(rt&&rt.message!=te)throw rt;this.offset=Ae;break}this.push(ot)}},push:he,pull:ye,read:$,reserve:function Lt(Ae){var ot=this.offset,rt=ot+Ae;if(rt>this.buffer.length)throw new Error(te);return this.offset=rt,ot},offset:0}}()),K.mixin(K.prototype),q.mixin=de(function ie(){return{bufferish:R,write:Q,fetch:function Ve(){var rt=this.start;if(rt<this.offset){var qe=this.start=this.offset;return R.prototype.slice.call(this.buffer,rt,qe)}},flush:function Je(){for(;this.start<this.offset;){var rt=this.fetch();rt&&this.push(rt)}},push:he,pull:function Lt(){var rt=this.buffers||(this.buffers=[]),qe=rt.length>1?this.bufferish.concat(rt):rt[0];return rt.length=0,qe},read:$,reserve:function Ae(rt){var qe=0|rt;if(this.buffer){var ct=this.buffer.length,Ee=0|this.offset,Tt=Ee+qe;if(Tt<ct)return this.offset=Tt,Ee;this.flush(),rt=Math.max(rt,Math.min(2*ct,this.maxBufferSize))}return rt=Math.max(rt,this.minBufferSize),this.buffer=this.bufferish.alloc(rt),this.start=0,this.offset=qe,0},send:function ot(rt){var qe=rt.length;if(qe>this.minBufferSize)this.flush(),this.push(rt);else{var ct=this.reserve(qe);R.prototype.copy.call(rt,this.buffer,ct)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),q.mixin(q.prototype)},2415:(Nt,Fe,me)=>{var R=me(7603).u,A=me(1800),oe=me(6539).readUint8,te=me(3247),K=me(2199);function W(){var H=this.options;return this.decode=function q(H){var $=te.getReadToken(H);return function he(ye){var de=oe(ye),Ve=$[de];if(!Ve)throw new Error("Invalid type: "+(de&&"0x"+de.toString(16)));return Ve(ye)}}(H),H&&H.preset&&A.setExtUnpackers(this),this}K.install({addExtUnpacker:function ie(H,$){(this.extUnpackers||(this.extUnpackers=[]))[H]=K.filter($)},getExtUnpacker:function Q(H){return(this.extUnpackers||(this.extUnpackers=[]))[H]||function he(ye){return new R(ye,H)}},init:W}),Fe.preset=W.call(K.preset)},6539:(Nt,Fe,me)=>{var R=me(2020),A=me(8590),oe=A.Uint64BE,te=A.Int64BE;Fe.getReadFormat=function Q(wt){var Ut=wt&&wt.int64;return{map:W&&wt&&wt.usemap?$:H,array:he,str:ye,bin:K.hasArrayBuffer&&wt&&wt.binarraybuffer?Ve:de,ext:Je,uint8:Lt,uint16:ot,uint32:qe,uint64:Ee(8,Ut?Et:Tt),int8:Ae,int16:rt,int32:ct,int64:Ee(8,Ut?_t:Gt),float32:Ee(4,Vt),float64:Ee(8,un)}},Fe.readUint8=Lt;var K=me(2029),q=me(1002),W=typeof Map<"u",ie=!0;function H(wt,Bt){var Ht,Ut={},zn=new Array(Bt),Oo=new Array(Bt),Ar=wt.codec.decode;for(Ht=0;Ht<Bt;Ht++)zn[Ht]=Ar(wt),Oo[Ht]=Ar(wt);for(Ht=0;Ht<Bt;Ht++)Ut[zn[Ht]]=Oo[Ht];return Ut}function $(wt,Bt){var Ht,Ut=new Map,zn=new Array(Bt),Oo=new Array(Bt),Ar=wt.codec.decode;for(Ht=0;Ht<Bt;Ht++)zn[Ht]=Ar(wt),Oo[Ht]=Ar(wt);for(Ht=0;Ht<Bt;Ht++)Ut.set(zn[Ht],Oo[Ht]);return Ut}function he(wt,Bt){for(var Ut=new Array(Bt),Ht=wt.codec.decode,zn=0;zn<Bt;zn++)Ut[zn]=Ht(wt);return Ut}function ye(wt,Bt){var Ut=wt.reserve(Bt);return q.toString.call(wt.buffer,"utf-8",Ut,Ut+Bt)}function de(wt,Bt){var Ut=wt.reserve(Bt),zn=q.slice.call(wt.buffer,Ut,Ut+Bt);return K.from(zn)}function Ve(wt,Bt){var Ut=wt.reserve(Bt),zn=q.slice.call(wt.buffer,Ut,Ut+Bt);return K.Uint8Array.from(zn).buffer}function Je(wt,Bt){var Ut=wt.reserve(Bt+1),Ht=wt.buffer[Ut++],zn=Ut+Bt,Oo=wt.codec.getExtUnpacker(Ht);if(!Oo)throw new Error("Invalid ext type: "+(Ht&&"0x"+Ht.toString(16)));return Oo(q.slice.call(wt.buffer,Ut,zn))}function Lt(wt){var Bt=wt.reserve(1);return wt.buffer[Bt]}function Ae(wt){var Bt=wt.reserve(1),Ut=wt.buffer[Bt];return 128&Ut?Ut-256:Ut}function ot(wt){var Bt=wt.reserve(2),Ut=wt.buffer;return Ut[Bt++]<<8|Ut[Bt]}function rt(wt){var Bt=wt.reserve(2),Ut=wt.buffer,Ht=Ut[Bt++]<<8|Ut[Bt];return 32768&Ht?Ht-65536:Ht}function qe(wt){var Bt=wt.reserve(4),Ut=wt.buffer;return 16777216*Ut[Bt++]+(Ut[Bt++]<<16)+(Ut[Bt++]<<8)+Ut[Bt]}function ct(wt){var Bt=wt.reserve(4),Ut=wt.buffer;return Ut[Bt++]<<24|Ut[Bt++]<<16|Ut[Bt++]<<8|Ut[Bt]}function Ee(wt,Bt){return function(Ut){var Ht=Ut.reserve(wt);return Bt.call(Ut.buffer,Ht,ie)}}function Tt(wt){return new oe(this,wt).toNumber()}function Gt(wt){return new te(this,wt).toNumber()}function Et(wt){return new oe(this,wt)}function _t(wt){return new te(this,wt)}function Vt(wt){return R.read(this,wt,!1,23,4)}function un(wt){return R.read(this,wt,!1,52,8)}},3247:(Nt,Fe,me)=>{var R=me(6539);function oe(ie){var Q,H=new Array(256);for(Q=0;Q<=127;Q++)H[Q]=K(Q);for(Q=128;Q<=143;Q++)H[Q]=W(Q-128,ie.map);for(Q=144;Q<=159;Q++)H[Q]=W(Q-144,ie.array);for(Q=160;Q<=191;Q++)H[Q]=W(Q-160,ie.str);for(H[192]=K(null),H[193]=null,H[194]=K(!1),H[195]=K(!0),H[196]=q(ie.uint8,ie.bin),H[197]=q(ie.uint16,ie.bin),H[198]=q(ie.uint32,ie.bin),H[199]=q(ie.uint8,ie.ext),H[200]=q(ie.uint16,ie.ext),H[201]=q(ie.uint32,ie.ext),H[202]=ie.float32,H[203]=ie.float64,H[204]=ie.uint8,H[205]=ie.uint16,H[206]=ie.uint32,H[207]=ie.uint64,H[208]=ie.int8,H[209]=ie.int16,H[210]=ie.int32,H[211]=ie.int64,H[212]=W(1,ie.ext),H[213]=W(2,ie.ext),H[214]=W(4,ie.ext),H[215]=W(8,ie.ext),H[216]=W(16,ie.ext),H[217]=q(ie.uint8,ie.str),H[218]=q(ie.uint16,ie.str),H[219]=q(ie.uint32,ie.str),H[220]=q(ie.uint16,ie.array),H[221]=q(ie.uint32,ie.array),H[222]=q(ie.uint16,ie.map),H[223]=q(ie.uint32,ie.map),Q=224;Q<=255;Q++)H[Q]=K(Q-256);return H}function K(ie){return function(){return ie}}function q(ie,Q){return function(H){var $=ie(H);return Q(H,$)}}function W(ie,Q){return function(H){return Q(H,ie)}}Fe.getReadToken=function A(ie){var Q=R.getReadFormat(ie);return ie&&ie.useraw?function te(ie){var Q,H=oe(ie).slice();for(H[217]=H[196],H[218]=H[197],H[219]=H[198],Q=160;Q<=191;Q++)H[Q]=W(Q-160,ie.bin);return H}(Q):oe(Q)}},6962:(Nt,Fe,me)=>{var R=me(7603).u,A=me(5167),oe=me(5217),te=me(2199);function q(){var Q=this.options;return this.encode=function K(Q){var H=oe.getWriteType(Q);return function $(he,ye){var de=H[typeof ye];if(!de)throw new Error('Unsupported type "'+typeof ye+'": '+ye);de(he,ye)}}(Q),Q&&Q.preset&&A.setExtPackers(this),this}te.install({addExtPacker:function W(Q,H,$){$=te.filter($);var he=H.name;function Ve(Je){return $&&(Je=$(Je)),new R(Je,Q)}he&&"Object"!==he?(this.extPackers||(this.extPackers={}))[he]=Ve:(this.extEncoderList||(this.extEncoderList=[])).unshift([H,Ve])},getExtPacker:function ie(Q){var H=this.extPackers||(this.extPackers={}),$=Q.constructor,he=$&&$.name&&H[$.name];if(he)return he;for(var ye=this.extEncoderList||(this.extEncoderList=[]),de=ye.length,Ve=0;Ve<de;Ve++){var Je=ye[Ve];if($===Je[0])return Je[1]}},init:q}),Fe.preset=q.call(te.preset)},4912:(Nt,Fe,me)=>{var R=me(2020),A=me(8590),oe=A.Uint64BE,te=A.Int64BE,K=me(7857).h,q=me(2029),W=q.global,Q=q.hasBuffer&&"TYPED_ARRAY_SUPPORT"in W&&!W.TYPED_ARRAY_SUPPORT,H=q.hasBuffer&&W.prototype||{};function ye(){var Ee=K.slice();return Ee[196]=Ve(196),Ee[197]=Je(197),Ee[198]=Lt(198),Ee[199]=Ve(199),Ee[200]=Je(200),Ee[201]=Lt(201),Ee[202]=Ae(202,4,H.writeFloatBE||qe,!0),Ee[203]=Ae(203,8,H.writeDoubleBE||ct,!0),Ee[204]=Ve(204),Ee[205]=Je(205),Ee[206]=Lt(206),Ee[207]=Ae(207,8,ot),Ee[208]=Ve(208),Ee[209]=Je(209),Ee[210]=Lt(210),Ee[211]=Ae(211,8,rt),Ee[217]=Ve(217),Ee[218]=Je(218),Ee[219]=Lt(219),Ee[220]=Je(220),Ee[221]=Lt(221),Ee[222]=Je(222),Ee[223]=Lt(223),Ee}function Ve(Ee){return function(Tt,Gt){var Et=Tt.reserve(2),_t=Tt.buffer;_t[Et++]=Ee,_t[Et]=Gt}}function Je(Ee){return function(Tt,Gt){var Et=Tt.reserve(3),_t=Tt.buffer;_t[Et++]=Ee,_t[Et++]=Gt>>>8,_t[Et]=Gt}}function Lt(Ee){return function(Tt,Gt){var Et=Tt.reserve(5),_t=Tt.buffer;_t[Et++]=Ee,_t[Et++]=Gt>>>24,_t[Et++]=Gt>>>16,_t[Et++]=Gt>>>8,_t[Et]=Gt}}function Ae(Ee,Tt,Gt,Et){return function(_t,Vt){var un=_t.reserve(Tt+1);_t.buffer[un++]=Ee,Gt.call(_t.buffer,Vt,un,Et)}}function ot(Ee,Tt){new oe(this,Tt,Ee)}function rt(Ee,Tt){new te(this,Tt,Ee)}function qe(Ee,Tt){R.write(this,Ee,Tt,!1,23,4)}function ct(Ee,Tt){R.write(this,Ee,Tt,!1,52,8)}Fe.getWriteToken=function $(Ee){return Ee&&Ee.uint8array?function he(){var Ee=ye();return Ee[202]=Ae(202,4,qe),Ee[203]=Ae(203,8,ct),Ee}():Q||q.hasBuffer&&Ee&&Ee.safe?function de(){var Ee=K.slice();return Ee[196]=Ae(196,1,W.prototype.writeUInt8),Ee[197]=Ae(197,2,W.prototype.writeUInt16BE),Ee[198]=Ae(198,4,W.prototype.writeUInt32BE),Ee[199]=Ae(199,1,W.prototype.writeUInt8),Ee[200]=Ae(200,2,W.prototype.writeUInt16BE),Ee[201]=Ae(201,4,W.prototype.writeUInt32BE),Ee[202]=Ae(202,4,W.prototype.writeFloatBE),Ee[203]=Ae(203,8,W.prototype.writeDoubleBE),Ee[204]=Ae(204,1,W.prototype.writeUInt8),Ee[205]=Ae(205,2,W.prototype.writeUInt16BE),Ee[206]=Ae(206,4,W.prototype.writeUInt32BE),Ee[207]=Ae(207,8,ot),Ee[208]=Ae(208,1,W.prototype.writeInt8),Ee[209]=Ae(209,2,W.prototype.writeInt16BE),Ee[210]=Ae(210,4,W.prototype.writeInt32BE),Ee[211]=Ae(211,8,rt),Ee[217]=Ae(217,1,W.prototype.writeUInt8),Ee[218]=Ae(218,2,W.prototype.writeUInt16BE),Ee[219]=Ae(219,4,W.prototype.writeUInt32BE),Ee[220]=Ae(220,2,W.prototype.writeUInt16BE),Ee[221]=Ae(221,4,W.prototype.writeUInt32BE),Ee[222]=Ae(222,2,W.prototype.writeUInt16BE),Ee[223]=Ae(223,4,W.prototype.writeUInt32BE),Ee}():ye()}},5217:(Nt,Fe,me)=>{var R=me(53),A=me(8590),oe=A.Uint64BE,te=A.Int64BE,K=me(2029),q=me(1002),W=me(4912),ie=me(7857).h,Q=me(7603).u,H=typeof Uint8Array<"u",$=typeof Map<"u",he=[];he[1]=212,he[2]=213,he[4]=214,he[8]=215,he[16]=216,Fe.getWriteType=function ye(de){var Ve=W.getWriteToken(de),Je=de&&de.useraw,Lt=H&&de&&de.binarraybuffer,Ae=Lt?K.isArrayBuffer:K.isBuffer,ot=Lt?function Oo(qt,Kt){zn(qt,new Uint8Array(Kt))}:zn,qe=$&&de&&de.usemap?function Rl(qt,Kt){if(!(Kt instanceof Map))return xi(qt,Kt);var nn=Kt.size;Ve[nn<16?128+nn:nn<=65535?222:223](qt,nn);var jn=qt.codec.encode;Kt.forEach(function(Wi,ui,Ui){jn(qt,ui),jn(qt,Wi)})}:xi;return{boolean:function Ee(qt,Kt){Ve[Kt?195:194](qt,Kt)},function:Ut,number:function Tt(qt,Kt){var nn=0|Kt;Kt===nn?Ve[-32<=nn&&nn<=127?255&nn:0<=nn?nn<=255?204:nn<=65535?205:206:-128<=nn?208:-32768<=nn?209:210](qt,nn):Ve[203](qt,Kt)},object:Je?function Bt(qt,Kt){if(Ae(Kt))return function na(qt,Kt){var nn=Kt.length;Ve[nn<32?160+nn:nn<=65535?218:219](qt,nn),qt.send(Kt)}(qt,Kt);wt(qt,Kt)}:wt,string:function un(qt){return function Kt(nn,pi){var jn=pi.length;nn.offset=nn.reserve(5+3*jn);var ui=nn.buffer,Ui=qt(jn),Rt=nn.offset+Ui;jn=q.write.call(ui,pi,Rt);var pn=qt(jn);Ui!==pn&&q.copy.call(ui,ui,Rt+pn-Ui,Rt,Rt+jn),Ve[1===pn?160+jn:pn<=3?215+pn:219](nn,jn),nn.offset+=jn}}(Je?function Vt(qt){return qt<32?1:qt<=65535?3:5}:function _t(qt){return qt<32?1:qt<=255?2:qt<=65535?3:5}),symbol:Ut,undefined:Ut};function wt(qt,Kt){if(null===Kt)return Ut(qt,Kt);if(Ae(Kt))return ot(qt,Kt);if(R(Kt))return function Ht(qt,Kt){var nn=Kt.length;Ve[nn<16?144+nn:nn<=65535?220:221](qt,nn);for(var jn=qt.codec.encode,Wi=0;Wi<nn;Wi++)jn(qt,Kt[Wi])}(qt,Kt);if(oe.isUint64BE(Kt))return function Gt(qt,Kt){Ve[207](qt,Kt.toArray())}(qt,Kt);if(te.isInt64BE(Kt))return function Et(qt,Kt){Ve[211](qt,Kt.toArray())}(qt,Kt);var nn=qt.codec.getExtPacker(Kt);if(nn&&(Kt=nn(Kt)),Kt instanceof Q)return function Ar(qt,Kt){var nn=Kt.buffer,pi=nn.length;Ve[he[pi]||(pi<255?199:pi<=65535?200:201)](qt,pi),ie[Kt.type](qt),qt.send(nn)}(qt,Kt);qe(qt,Kt)}function Ut(qt,Kt){Ve[192](qt,Kt)}function zn(qt,Kt){var nn=Kt.length;Ve[nn<255?196:nn<=65535?197:198](qt,nn),qt.send(Kt)}function xi(qt,Kt){var nn=Object.keys(Kt),pi=nn.length;Ve[pi<16?128+pi:pi<=65535?222:223](qt,pi);var Wi=qt.codec.encode;nn.forEach(function(ui){Wi(qt,ui),Wi(qt,Kt[ui])})}}},7857:(Nt,Fe)=>{for(var me=Fe.h=new Array(256),R=0;R<=255;R++)me[R]=A(R);function A(oe){return function(te){var K=te.reserve(1);te.buffer[K]=oe}}},9822:Nt=>{function Fe(oe){var te="    ";if(isNaN(parseInt(oe)))te=oe;else switch(oe){case 1:te=" ";break;case 2:te="  ";break;case 3:te="   ";break;case 4:te="    ";break;case 5:te="     ";break;case 6:te="      ";break;case 7:te="       ";break;case 8:te="        ";break;case 9:te="         ";break;case 10:te="          ";break;case 11:te="           ";break;case 12:te="            "}for(var K=["\n"],q=0;q<100;q++)K.push(K[q]+te);return K}function me(){this.step="    ",this.shift=Fe(this.step)}function R(oe,te){return te-(oe.replace(/\(/g,"").length-oe.replace(/\)/g,"").length)}function A(oe,te){return oe.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+te+te+"AND ").replace(/ BETWEEN /gi,"~::~"+te+"BETWEEN ").replace(/ CASE /gi,"~::~"+te+"CASE ").replace(/ ELSE /gi,"~::~"+te+"ELSE ").replace(/ END /gi,"~::~"+te+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+te+"ON ").replace(/ OR /gi,"~::~"+te+te+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+te+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+te).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+te+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}me.prototype.xml=function(oe,te){var K=oe.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),q=K.length,W=!1,ie=0,Q="",H=0,$=te?Fe(te):this.shift;for(H=0;H<q;H++)K[H].search(/<!/)>-1?(Q+=$[ie]+K[H],W=!0,(K[H].search(/-->/)>-1||K[H].search(/\]>/)>-1||K[H].search(/!DOCTYPE/)>-1)&&(W=!1)):K[H].search(/-->/)>-1||K[H].search(/\]>/)>-1?(Q+=K[H],W=!1):/^<\w/.exec(K[H-1])&&/^<\/\w/.exec(K[H])&&/^<[\w:\-\.\,]+/.exec(K[H-1])==/^<\/[\w:\-\.\,]+/.exec(K[H])[0].replace("/","")?(Q+=K[H],W||ie--):K[H].search(/<\w/)>-1&&-1==K[H].search(/<\//)&&-1==K[H].search(/\/>/)?Q=Q+=W?K[H]:$[ie++]+K[H]:K[H].search(/<\w/)>-1&&K[H].search(/<\//)>-1?Q=Q+=W?K[H]:$[ie]+K[H]:K[H].search(/<\//)>-1?Q=Q+=W?K[H]:$[--ie]+K[H]:K[H].search(/\/>/)>-1?Q=Q+=W?K[H]:$[ie]+K[H]:K[H].search(/<\?/)>-1||K[H].search(/xmlns\:/)>-1||K[H].search(/xmlns\=/)>-1?Q+=$[ie]+K[H]:Q+=K[H];return"\n"==Q[0]?Q.slice(1):Q},me.prototype.json=function(oe,K){return K=K||this.step,typeof JSON>"u"?oe:"string"==typeof oe?JSON.stringify(JSON.parse(oe),null,K):"object"==typeof oe?JSON.stringify(oe,null,K):oe},me.prototype.css=function(oe,te){var K=oe.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),q=K.length,W=0,ie="",Q=0,H=te?Fe(te):this.shift;for(Q=0;Q<q;Q++)/\{/.exec(K[Q])?ie+=H[W++]+K[Q]:/\}/.exec(K[Q])?ie+=H[--W]+K[Q]:(/\*\\/.exec(K[Q]),ie+=H[W]+K[Q]);return ie.replace(/^\n{1,}/,"")},me.prototype.sql=function(oe,te){var K=oe.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),q=K.length,W=[],ie=0,Q=this.step,he=0,ye="",de=0,Ve=te?Fe(te):this.shift;for(de=0;de<q;de++)W=W.concat(de%2?K[de]:A(K[de],Q));for(q=W.length,de=0;de<q;de++)he=R(W[de],he),/\s{0,}\s{0,}SELECT\s{0,}/.exec(W[de])&&(W[de]=W[de].replace(/\,/g,",\n"+Q+Q)),/\s{0,}\s{0,}SET\s{0,}/.exec(W[de])&&(W[de]=W[de].replace(/\,/g,",\n"+Q+Q)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(W[de])?ye+=Ve[++ie]+W[de]:/\'/.exec(W[de])?(he<1&&ie&&ie--,ye+=W[de]):(ye+=Ve[ie]+W[de],he<1&&ie&&ie--);return ye.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},me.prototype.xmlmin=function(oe,te){return(te?oe:oe.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},me.prototype.jsonmin=function(oe){return typeof JSON>"u"?oe:JSON.stringify(JSON.parse(oe),null,0)},me.prototype.cssmin=function(oe,te){return(te?oe:oe.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},me.prototype.sqlmin=function(oe){return oe.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},Nt.exports=new me},477:()=>{},467:(Nt,Fe,me)=>{"use strict";function R(oe,te,K,q,W,ie,Q){try{var H=oe[ie](Q),$=H.value}catch(he){return void K(he)}H.done?te($):Promise.resolve($).then(q,W)}function A(oe){return function(){var te=this,K=arguments;return new Promise(function(q,W){var ie=oe.apply(te,K);function Q($){R(ie,q,W,Q,H,"next",$)}function H($){R(ie,q,W,Q,H,"throw",$)}Q(void 0)})}}me.d(Fe,{A:()=>A})},4469:Nt=>{"use strict";Nt.exports={version:"2.0.0"}}},Nt=>{Nt(Nt.s=3781)}]);