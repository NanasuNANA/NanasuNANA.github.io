(self.webpackChunkudonarium=self.webpackChunkudonarium||[]).push([[179],{383:(E,ae,Y)=>{"use strict";Y.r(ae),Y.d(ae,{default:()=>p});var a=Y(5861),y=Y(3604),w=Y.n(y);class p extends(w()){dynamicImportI18n(k,v){return(0,a.Z)(function*(){return(yield Y(6507)(`./${k}.${v}.json`)).default})()}dynamicImport(k){return(0,a.Z)(function*(){yield Y(85)(`./${k}`)})()}}},5583:(E,ae,Y)=>{"use strict";function a(t){return"function"==typeof t}function y(t){const e=t(i=>{Error.call(i),i.stack=(new Error).stack});return e.prototype=Object.create(Error.prototype),e.prototype.constructor=e,e}const w=y(t=>function(e){t(this),this.message=e?`${e.length} errors occurred during unsubscription:\n${e.map((i,r)=>`${r+1}) ${i.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=e});function p(t,n){if(t){const e=t.indexOf(n);0<=e&&t.splice(e,1)}}class u{constructor(n){this.initialTeardown=n,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let n;if(!this.closed){this.closed=!0;const{_parentage:e}=this;if(e)if(this._parentage=null,Array.isArray(e))for(const s of e)s.remove(this);else e.remove(this);const{initialTeardown:i}=this;if(a(i))try{i()}catch(s){n=s instanceof w?s.errors:[s]}const{_finalizers:r}=this;if(r){this._finalizers=null;for(const s of r)try{D(s)}catch(o){n=null!=n?n:[],o instanceof w?n=[...n,...o.errors]:n.push(o)}}if(n)throw new w(n)}}add(n){var e;if(n&&n!==this)if(this.closed)D(n);else{if(n instanceof u){if(n.closed||n._hasParent(this))return;n._addParent(this)}(this._finalizers=null!==(e=this._finalizers)&&void 0!==e?e:[]).push(n)}}_hasParent(n){const{_parentage:e}=this;return e===n||Array.isArray(e)&&e.includes(n)}_addParent(n){const{_parentage:e}=this;this._parentage=Array.isArray(e)?(e.push(n),e):e?[e,n]:n}_removeParent(n){const{_parentage:e}=this;e===n?this._parentage=null:Array.isArray(e)&&p(e,n)}remove(n){const{_finalizers:e}=this;e&&p(e,n),n instanceof u&&n._removeParent(this)}}u.EMPTY=(()=>{const t=new u;return t.closed=!0,t})();const k=u.EMPTY;function v(t){return t instanceof u||t&&"closed"in t&&a(t.remove)&&a(t.add)&&a(t.unsubscribe)}function D(t){a(t)?t():t.unsubscribe()}const _={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},F={setTimeout(t,n,...e){const{delegate:i}=F;return(null==i?void 0:i.setTimeout)?i.setTimeout(t,n,...e):setTimeout(t,n,...e)},clearTimeout(t){const{delegate:n}=F;return((null==n?void 0:n.clearTimeout)||clearTimeout)(t)},delegate:void 0};function oe(t){F.setTimeout(()=>{const{onUnhandledError:n}=_;if(!n)throw t;n(t)})}function V(){}const L=se("C",void 0,void 0);function se(t,n,e){return{kind:t,value:n,error:e}}let ue=null;function J(t){if(_.useDeprecatedSynchronousErrorHandling){const n=!ue;if(n&&(ue={errorThrown:!1,error:null}),t(),n){const{errorThrown:e,error:i}=ue;if(ue=null,e)throw i}}else t()}class ee extends u{constructor(n){super(),this.isStopped=!1,n?(this.destination=n,v(n)&&n.add(this)):this.destination=b}static create(n,e,i){return new A(n,e,i)}next(n){this.isStopped?g(function U(t){return se("N",t,void 0)}(n),this):this._next(n)}error(n){this.isStopped?g(function H(t){return se("E",void 0,t)}(n),this):(this.isStopped=!0,this._error(n))}complete(){this.isStopped?g(L,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(n){this.destination.next(n)}_error(n){try{this.destination.error(n)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const M=Function.prototype.bind;function G(t,n){return M.call(t,n)}class z{constructor(n){this.partialObserver=n}next(n){const{partialObserver:e}=this;if(e.next)try{e.next(n)}catch(i){N(i)}}error(n){const{partialObserver:e}=this;if(e.error)try{e.error(n)}catch(i){N(i)}else N(n)}complete(){const{partialObserver:n}=this;if(n.complete)try{n.complete()}catch(e){N(e)}}}class A extends ee{constructor(n,e,i){let r;if(super(),a(n)||!n)r={next:null!=n?n:void 0,error:null!=e?e:void 0,complete:null!=i?i:void 0};else{let s;this&&_.useDeprecatedNextContext?(s=Object.create(n),s.unsubscribe=()=>this.unsubscribe(),r={next:n.next&&G(n.next,s),error:n.error&&G(n.error,s),complete:n.complete&&G(n.complete,s)}):r=n}this.destination=new z(r)}}function N(t){_.useDeprecatedSynchronousErrorHandling?function K(t){_.useDeprecatedSynchronousErrorHandling&&ue&&(ue.errorThrown=!0,ue.error=t)}(t):oe(t)}function g(t,n){const{onStoppedNotification:e}=_;e&&F.setTimeout(()=>e(t,n))}const b={closed:!0,next:V,error:function P(t){throw t},complete:V},C="function"==typeof Symbol&&Symbol.observable||"@@observable";function h(t){return t}function c(...t){return l(t)}function l(t){return 0===t.length?h:1===t.length?t[0]:function(e){return t.reduce((i,r)=>r(i),e)}}let f=(()=>{class t{constructor(e){e&&(this._subscribe=e)}lift(e){const i=new t;return i.source=this,i.operator=e,i}subscribe(e,i,r){const s=function S(t){return t&&t instanceof ee||function x(t){return t&&a(t.next)&&a(t.error)&&a(t.complete)}(t)&&v(t)}(e)?e:new A(e,i,r);return J(()=>{const{operator:o,source:d}=this;s.add(o?o.call(s,d):d?this._subscribe(s):this._trySubscribe(s))}),s}_trySubscribe(e){try{return this._subscribe(e)}catch(i){e.error(i)}}forEach(e,i){return new(i=m(i))((r,s)=>{const o=new A({next:d=>{try{e(d)}catch($){s($),o.unsubscribe()}},error:s,complete:r});this.subscribe(o)})}_subscribe(e){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(e)}[C](){return this}pipe(...e){return l(e)(this)}toPromise(e){return new(e=m(e))((i,r)=>{let s;this.subscribe(o=>s=o,o=>r(o),()=>i(s))})}}return t.create=n=>new t(n),t})();function m(t){var n;return null!==(n=null!=t?t:_.Promise)&&void 0!==n?n:Promise}const Z=y(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let le=(()=>{class t extends f{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(e){const i=new ye(this,this);return i.operator=e,i}_throwIfClosed(){if(this.closed)throw new Z}next(e){J(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const i of this.currentObservers)i.next(e)}})}error(e){J(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=e;const{observers:i}=this;for(;i.length;)i.shift().error(e)}})}complete(){J(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:e}=this;for(;e.length;)e.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var e;return(null===(e=this.observers)||void 0===e?void 0:e.length)>0}_trySubscribe(e){return this._throwIfClosed(),super._trySubscribe(e)}_subscribe(e){return this._throwIfClosed(),this._checkFinalizedStatuses(e),this._innerSubscribe(e)}_innerSubscribe(e){const{hasError:i,isStopped:r,observers:s}=this;return i||r?k:(this.currentObservers=null,s.push(e),new u(()=>{this.currentObservers=null,p(s,e)}))}_checkFinalizedStatuses(e){const{hasError:i,thrownError:r,isStopped:s}=this;i?e.error(r):s&&e.complete()}asObservable(){const e=new f;return e.source=this,e}}return t.create=(n,e)=>new ye(n,e),t})();class ye extends le{constructor(n,e){super(),this.destination=n,this.source=e}next(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.next)||void 0===i||i.call(e,n)}error(n){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.error)||void 0===i||i.call(e,n)}complete(){var n,e;null===(e=null===(n=this.destination)||void 0===n?void 0:n.complete)||void 0===e||e.call(n)}_subscribe(n){var e,i;return null!==(i=null===(e=this.source)||void 0===e?void 0:e.subscribe(n))&&void 0!==i?i:k}}function T(t){return a(null==t?void 0:t.lift)}function R(t){return n=>{if(T(n))return n.lift(function(e){try{return t(e,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function ie(t,n,e,i,r){return new j(t,n,e,i,r)}class j extends ee{constructor(n,e,i,r,s,o){super(n),this.onFinalize=s,this.shouldUnsubscribe=o,this._next=e?function(d){try{e(d)}catch($){n.error($)}}:super._next,this._error=r?function(d){try{r(d)}catch($){n.error($)}finally{this.unsubscribe()}}:super._error,this._complete=i?function(){try{i()}catch(d){n.error(d)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:e}=this;super.unsubscribe(),!e&&(null===(n=this.onFinalize)||void 0===n||n.call(this))}}}function ve(t,n){return R((e,i)=>{let r=0;e.subscribe(ie(i,s=>{i.next(t.call(n,s,r++))}))})}var de=function(t,n){return(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(e[r]=i[r])})(t,n)};function we(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function e(){this.constructor=t}de(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}var ce=function(){return ce=Object.assign||function(n){for(var e,i=1,r=arguments.length;i<r;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n},ce.apply(this,arguments)};function B(t,n,e,i){var o,r=arguments.length,s=r<3?n:null===i?i=Object.getOwnPropertyDescriptor(n,e):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,n,e,i);else for(var d=t.length-1;d>=0;d--)(o=t[d])&&(s=(r<3?o(s):r>3?o(n,e,s):o(n,e))||s);return r>3&&s&&Object.defineProperty(n,e,s),s}function Qe(t){return this instanceof Qe?(this.v=t,this):new Qe(t)}function Mt(t,n,e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=e.apply(t,n||[]),s=[];return r={},o("next"),o("throw"),o("return"),r[Symbol.asyncIterator]=function(){return this},r;function o(_e){i[_e]&&(r[_e]=function(Ce){return new Promise(function(Ee,Re){s.push([_e,Ce,Ee,Re])>1||d(_e,Ce)})})}function d(_e,Ce){try{!function $(_e){_e.value instanceof Qe?Promise.resolve(_e.value.v).then(I,Q):fe(s[0][2],_e)}(i[_e](Ce))}catch(Ee){fe(s[0][3],Ee)}}function I(_e){d("next",_e)}function Q(_e){d("throw",_e)}function fe(_e,Ce){_e(Ce),s.shift(),s.length&&d(s[0][0],s[0][1])}}function Pt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function Te(t){var n="function"==typeof Symbol&&Symbol.iterator,e=n&&t[n],i=0;if(e)return e.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(n?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(s){e[s]=t[s]&&function(o){return new Promise(function(d,$){!function r(s,o,d,$){Promise.resolve($).then(function(I){s({value:I,done:d})},o)}(d,$,(o=t[s](o)).done,o.value)})}}}const Qa=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function Zl(t){return a(null==t?void 0:t.then)}function Ja(t){return a(t[C])}function ts(t){return Symbol.asyncIterator&&a(null==t?void 0:t[Symbol.asyncIterator])}function zo(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Cu=function fg(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function xu(t){return a(null==t?void 0:t[Cu])}function Xl(t){return Mt(this,arguments,function*(){const e=t.getReader();try{for(;;){const{value:i,done:r}=yield Qe(e.read());if(r)return yield Qe(void 0);yield yield Qe(i)}}finally{e.releaseLock()}})}function ff(t){return a(null==t?void 0:t.getReader)}function ur(t){if(t instanceof f)return t;if(null!=t){if(Ja(t))return function hg(t){return new f(n=>{const e=t[C]();if(a(e.subscribe))return e.subscribe(n);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(Qa(t))return function hf(t){return new f(n=>{for(let e=0;e<t.length&&!n.closed;e++)n.next(t[e]);n.complete()})}(t);if(Zl(t))return function pg(t){return new f(n=>{t.then(e=>{n.closed||(n.next(e),n.complete())},e=>n.error(e)).then(null,oe)})}(t);if(ts(t))return pf(t);if(xu(t))return function gg(t){return new f(n=>{for(const e of t)if(n.next(e),n.closed)return;n.complete()})}(t);if(ff(t))return function Ql(t){return pf(Xl(t))}(t)}throw zo(t)}function pf(t){return new f(n=>{(function mg(t,n){var e,i,r,s;return function q(t,n,e,i){return new(e||(e=Promise))(function(s,o){function d(Q){try{I(i.next(Q))}catch(fe){o(fe)}}function $(Q){try{I(i.throw(Q))}catch(fe){o(fe)}}function I(Q){Q.done?s(Q.value):function r(s){return s instanceof e?s:new e(function(o){o(s)})}(Q.value).then(d,$)}I((i=i.apply(t,n||[])).next())})}(this,void 0,void 0,function*(){try{for(e=Pt(t);!(i=yield e.next()).done;)if(n.next(i.value),n.closed)return}catch(o){r={error:o}}finally{try{i&&!i.done&&(s=e.return)&&(yield s.call(e))}finally{if(r)throw r.error}}n.complete()})})(t,n).catch(e=>n.error(e))})}function js(t,n,e,i=0,r=!1){const s=n.schedule(function(){e(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function jo(t,n,e=1/0){return a(n)?jo((i,r)=>ve((s,o)=>n(i,s,r,o))(ur(t(i,r))),e):("number"==typeof n&&(e=n),R((i,r)=>function gf(t,n,e,i,r,s,o,d){const $=[];let I=0,Q=0,fe=!1;const _e=()=>{fe&&!$.length&&!I&&n.complete()},Ce=Re=>I<i?Ee(Re):$.push(Re),Ee=Re=>{s&&n.next(Re),I++;let Le=!1;ur(e(Re,Q++)).subscribe(ie(n,Be=>{null==r||r(Be),s?Ce(Be):n.next(Be)},()=>{Le=!0},void 0,()=>{if(Le)try{for(I--;$.length&&I<i;){const Be=$.shift();o?js(n,o,()=>Ee(Be)):Ee(Be)}_e()}catch(Be){n.error(Be)}}))};return t.subscribe(ie(n,Ce,()=>{fe=!0,_e()})),()=>{null==d||d()}}(i,r,t,e)))}function mf(t=1/0){return jo(h,t)}const Jl=new f(t=>t.complete());function wu(t){return t&&a(t.schedule)}function ec(t){return t[t.length-1]}function el(t){return a(ec(t))?t.pop():void 0}function Uo(t){return wu(ec(t))?t.pop():void 0}function ca(t,n=0){return R((e,i)=>{e.subscribe(ie(i,r=>js(i,t,()=>i.next(r),n),()=>js(i,t,()=>i.complete(),n),r=>js(i,t,()=>i.error(r),n)))})}function ua(t,n=0){return R((e,i)=>{i.add(t.schedule(()=>e.subscribe(i),n))})}function tl(t,n){if(!t)throw new Error("Iterable cannot be null");return new f(e=>{js(e,n,()=>{const i=t[Symbol.asyncIterator]();js(e,n,()=>{i.next().then(r=>{r.done?e.complete():e.next(r.value)})},0,!0)})})}function Tr(t,n){return n?function da(t,n){if(null!=t){if(Ja(t))return function tc(t,n){return ur(t).pipe(ua(n),ca(n))}(t,n);if(Qa(t))return function _g(t,n){return new f(e=>{let i=0;return n.schedule(function(){i===t.length?e.complete():(e.next(t[i++]),e.closed||this.schedule())})})}(t,n);if(Zl(t))return function Eu(t,n){return ur(t).pipe(ua(n),ca(n))}(t,n);if(ts(t))return tl(t,n);if(xu(t))return function $g(t,n){return new f(e=>{let i;return js(e,n,()=>{i=t[Cu](),js(e,n,()=>{let r,s;try{({value:r,done:s}=i.next())}catch(o){return void e.error(o)}s?e.complete():e.next(r)},0,!0)}),()=>a(null==i?void 0:i.return)&&i.return()})}(t,n);if(ff(t))return function jr(t,n){return tl(Xl(t),n)}(t,n)}throw zo(t)}(t,n):ur(t)}function Ur(...t){const n=Uo(t),e=function Ho(t,n){return"number"==typeof ec(t)?t.pop():n}(t,1/0),i=t;return i.length?1===i.length?ur(i[0]):mf(e)(Tr(i,n)):Jl}function Hr(t,n,...e){if(!0===n)return void t();if(!1===n)return;const i=new A({next:()=>{i.unsubscribe(),t()}});return n(...e).subscribe(i)}function wn(t){for(let n in t)if(t[n]===wn)return n;throw Error("Could not find renamed property on target object.")}function nc(t,n){for(const e in n)n.hasOwnProperty(e)&&!t.hasOwnProperty(e)&&(t[e]=n[e])}function Rn(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Rn).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const e=n.indexOf("\n");return-1===e?n:n.substring(0,e)}function fa(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const ns=wn({__forward_ref__:wn});function zn(t){return t.__forward_ref__=zn,t.toString=function(){return Rn(this())},t}function nn(t){return ic(t)?t():t}function ic(t){return"function"==typeof t&&t.hasOwnProperty(ns)&&t.__forward_ref__===zn}class Tt extends Error{constructor(n,e){super(function ha(t,n){return`NG0${Math.abs(t)}${n?": "+n:""}`}(n,e)),this.code=n}}function Ut(t){return"string"==typeof t?t:null==t?"":String(t)}function Oi(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():Ut(t)}function rc(t,n){const e=n?` in ${n}`:"";throw new Tt(-201,`No provider for ${Oi(t)} found${e}`)}function is(t,n){null==t&&function Xn(t,n,e,i){throw new Error(`ASSERTION ERROR: ${t}`+(null==i?"":` [Expected=> ${e} ${i} ${n} <=Actual]`))}(n,t,null,"!=")}function Zt(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function rs(t){return{providers:t.providers||[],imports:t.imports||[]}}function bg(t){return y1(t,yf)||y1(t,x1)}function y1(t,n){return t.hasOwnProperty(n)?t[n]:null}function C1(t){return t&&(t.hasOwnProperty(yg)||t.hasOwnProperty(pS))?t[yg]:null}const yf=wn({\u0275prov:wn}),yg=wn({\u0275inj:wn}),x1=wn({ngInjectableDef:wn}),pS=wn({ngInjectorDef:wn});var ln=(()=>((ln=ln||{})[ln.Default=0]="Default",ln[ln.Host=1]="Host",ln[ln.Self=2]="Self",ln[ln.SkipSelf=4]="SkipSelf",ln[ln.Optional=8]="Optional",ln))();let Cg;function pa(t){const n=Cg;return Cg=t,n}function w1(t,n,e){const i=bg(t);return i&&"root"==i.providedIn?void 0===i.value?i.value=i.factory():i.value:e&ln.Optional?null:void 0!==n?n:void rc(Rn(t),"Injector")}function ga(t){return{toString:t}.toString()}var Us=(()=>((Us=Us||{})[Us.OnPush=0]="OnPush",Us[Us.Default=1]="Default",Us))(),Hs=(()=>{return(t=Hs||(Hs={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",Hs;var t})();const mS="undefined"!=typeof globalThis&&globalThis,_S="undefined"!=typeof window&&window,$S="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Wn=mS||"undefined"!=typeof global&&global||_S||$S,sc={},Qn=[],Cf=wn({\u0275cmp:wn}),xg=wn({\u0275dir:wn}),wg=wn({\u0275pipe:wn}),E1=wn({\u0275mod:wn}),Vo=wn({\u0275fac:wn}),Tu=wn({__NG_ELEMENT_ID__:wn});let vS=0;function qt(t){return ga(()=>{const e={},i={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:e,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===Us.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||Qn,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Hs.Emulated,id:"c",styles:t.styles||Qn,_:null,setInput:null,schemas:t.schemas||null,tView:null},r=t.directives,s=t.features,o=t.pipes;return i.id+=vS++,i.inputs=k1(t.inputs,e),i.outputs=k1(t.outputs),s&&s.forEach(d=>d(i)),i.directiveDefs=r?()=>("function"==typeof r?r():r).map(T1):null,i.pipeDefs=o?()=>("function"==typeof o?o():o).map(I1):null,i})}function Eg(t,n,e){const i=t.\u0275cmp;i.directiveDefs=()=>n.map(T1),i.pipeDefs=()=>e.map(I1)}function T1(t){return hr(t)||function ma(t){return t[xg]||null}(t)}function I1(t){return function il(t){return t[wg]||null}(t)}const S1={};function ys(t){return ga(()=>{const n={type:t.type,bootstrap:t.bootstrap||Qn,declarations:t.declarations||Qn,imports:t.imports||Qn,exports:t.exports||Qn,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(S1[t.id]=t.type),n})}function k1(t,n){if(null==t)return sc;const e={};for(const i in t)if(t.hasOwnProperty(i)){let r=t[i],s=r;Array.isArray(r)&&(s=r[1],r=r[0]),e[r]=i,n&&(n[r]=s)}return e}const Gt=qt;function fr(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function hr(t){return t[Cf]||null}function Cs(t,n){const e=t[E1]||null;if(!e&&!0===n)throw new Error(`Type ${Rn(t)} does not have '\u0275mod' property.`);return e}function co(t){return Array.isArray(t)&&"object"==typeof t[1]}function Gs(t){return Array.isArray(t)&&!0===t[1]}function Sg(t){return 0!=(8&t.flags)}function Tf(t){return 2==(2&t.flags)}function If(t){return 1==(1&t.flags)}function qs(t){return null!==t.template}function wS(t){return 0!=(512&t[2])}function al(t,n){return t.hasOwnProperty(Vo)?t[Vo]:null}class IS{constructor(n,e,i){this.previousValue=n,this.currentValue=e,this.firstChange=i}isFirstChange(){return this.firstChange}}function Ws(){return D1}function D1(t){return t.type.prototype.ngOnChanges&&(t.setInput=kS),SS}function SS(){const t=P1(this),n=null==t?void 0:t.current;if(n){const e=t.previous;if(e===sc)t.previous=n;else for(let i in n)e[i]=n[i];t.current=null,this.ngOnChanges(n)}}function kS(t,n,e,i){const r=P1(t)||function MS(t,n){return t[A1]=n}(t,{previous:sc,current:null}),s=r.current||(r.current={}),o=r.previous,d=this.declaredInputs[e],$=o[d];s[d]=new IS($&&$.currentValue,n,o===sc),t[i]=n}Ws.ngInherit=!0;const A1="__ngSimpleChanges__";function P1(t){return t[A1]||null}let Pg;function Ng(){return void 0!==Pg?Pg:"undefined"!=typeof document?document:void 0}function yi(t){return!!t.listen}const N1={createRenderer:(t,n)=>Ng()};function Mi(t){for(;Array.isArray(t);)t=t[0];return t}function Sf(t,n){return Mi(n[t])}function Es(t,n){return Mi(n[t.index])}function Fg(t,n){return t.data[n]}function uc(t,n){return t[n]}function os(t,n){const e=n[t];return co(e)?e:e[0]}function F1(t){return 4==(4&t[2])}function Rg(t){return 128==(128&t[2])}function _a(t,n){return null==n?null:t[n]}function R1(t){t[18]=0}function Og(t,n){t[5]+=n;let e=t,i=t[3];for(;null!==i&&(1===n&&1===e[5]||-1===n&&0===e[5]);)i[5]+=n,e=i,i=i[3]}const sn={lFrame:G1(null),bindingsEnabled:!0};function B1(){return sn.bindingsEnabled}function ft(){return sn.lFrame.lView}function Dn(){return sn.lFrame.tView}function ke(t){return sn.lFrame.contextLView=t,t[8]}function zi(){let t=L1();for(;null!==t&&64===t.type;)t=t.parent;return t}function L1(){return sn.lFrame.currentTNode}function uo(t,n){const e=sn.lFrame;e.currentTNode=t,e.isParent=n}function Bg(){return sn.lFrame.isParent}function Lg(){sn.lFrame.isParent=!1}function Sr(){const t=sn.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function dc(){return sn.lFrame.bindingIndex++}function qo(t){const n=sn.lFrame,e=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,e}function WS(t,n){const e=sn.lFrame;e.bindingIndex=e.bindingRootIndex=t,zg(n)}function zg(t){sn.lFrame.currentDirectiveIndex=t}function U1(){return sn.lFrame.currentQueryIndex}function Ug(t){sn.lFrame.currentQueryIndex=t}function YS(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function H1(t,n,e){if(e&ln.SkipSelf){let r=n,s=t;for(;!(r=r.parent,null!==r||e&ln.Host||(r=YS(s),null===r||(s=s[15],10&r.type))););if(null===r)return!1;n=r,t=s}const i=sn.lFrame=V1();return i.currentTNode=n,i.lView=t,!0}function Mf(t){const n=V1(),e=t[1];sn.lFrame=n,n.currentTNode=e.firstChild,n.lView=t,n.tView=e,n.contextLView=t,n.bindingIndex=e.bindingStartIndex,n.inI18n=!1}function V1(){const t=sn.lFrame,n=null===t?null:t.child;return null===n?G1(t):n}function G1(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function q1(){const t=sn.lFrame;return sn.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const W1=q1;function Df(){const t=q1();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function kr(){return sn.lFrame.selectedIndex}function $a(t){sn.lFrame.selectedIndex=t}function Ci(){const t=sn.lFrame;return Fg(t.tView,t.selectedIndex)}function Af(t,n){for(let e=n.directiveStart,i=n.directiveEnd;e<i;e++){const s=t.data[e].type.prototype,{ngAfterContentInit:o,ngAfterContentChecked:d,ngAfterViewInit:$,ngAfterViewChecked:I,ngOnDestroy:Q}=s;o&&(t.contentHooks||(t.contentHooks=[])).push(-e,o),d&&((t.contentHooks||(t.contentHooks=[])).push(e,d),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(e,d)),$&&(t.viewHooks||(t.viewHooks=[])).push(-e,$),I&&((t.viewHooks||(t.viewHooks=[])).push(e,I),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(e,I)),null!=Q&&(t.destroyHooks||(t.destroyHooks=[])).push(e,Q)}}function Pf(t,n,e){K1(t,n,3,e)}function Nf(t,n,e,i){(3&t[2])===e&&K1(t,n,e,i)}function Hg(t,n){let e=t[2];(3&e)===n&&(e&=2047,e+=1,t[2]=e)}function K1(t,n,e,i){const s=null!=i?i:-1,o=n.length-1;let d=0;for(let $=void 0!==i?65535&t[18]:0;$<o;$++)if("number"==typeof n[$+1]){if(d=n[$],null!=i&&d>=i)break}else n[$]<0&&(t[18]+=65536),(d<s||-1==s)&&(rk(t,e,n,$),t[18]=(4294901760&t[18])+$+2),$++}function rk(t,n,e,i){const r=e[i]<0,s=e[i+1],d=t[r?-e[i]:e[i]];if(r){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{s.call(d)}finally{}}}else try{s.call(d)}finally{}}class Du{constructor(n,e,i){this.factory=n,this.resolving=!1,this.canSeeViewProviders=e,this.injectImpl=i}}function Ff(t,n,e){const i=yi(t);let r=0;for(;r<e.length;){const s=e[r];if("number"==typeof s){if(0!==s)break;r++;const o=e[r++],d=e[r++],$=e[r++];i?t.setAttribute(n,d,$,o):n.setAttributeNS(o,d,$)}else{const o=s,d=e[++r];Gg(o)?i&&t.setProperty(n,o,d):i?t.setAttribute(n,o,d):n.setAttribute(o,d),r++}}return r}function Y1(t){return 3===t||4===t||6===t}function Gg(t){return 64===t.charCodeAt(0)}function Rf(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let e=-1;for(let i=0;i<n.length;i++){const r=n[i];"number"==typeof r?e=r:0===e||Z1(t,e,r,null,-1===e||2===e?n[++i]:null)}}return t}function Z1(t,n,e,i,r){let s=0,o=t.length;if(-1===n)o=-1;else for(;s<t.length;){const d=t[s++];if("number"==typeof d){if(d===n){o=-1;break}if(d>n){o=s-1;break}}}for(;s<t.length;){const d=t[s];if("number"==typeof d)break;if(d===e){if(null===i)return void(null!==r&&(t[s+1]=r));if(i===t[s+1])return void(t[s+2]=r)}s++,null!==i&&s++,null!==r&&s++}-1!==o&&(t.splice(o,0,n),s=o+1),t.splice(s++,0,e),null!==i&&t.splice(s++,0,i),null!==r&&t.splice(s++,0,r)}function X1(t){return-1!==t}function fc(t){return 32767&t}function hc(t,n){let e=function ck(t){return t>>16}(t),i=n;for(;e>0;)i=i[15],e--;return i}let qg=!0;function Of(t){const n=qg;return qg=t,n}let uk=0;function Pu(t,n){const e=Kg(t,n);if(-1!==e)return e;const i=n[1];i.firstCreatePass&&(t.injectorIndex=n.length,Wg(i.data,t),Wg(n,null),Wg(i.blueprint,null));const r=Bf(t,n),s=t.injectorIndex;if(X1(r)){const o=fc(r),d=hc(r,n),$=d[1].data;for(let I=0;I<8;I++)n[s+I]=d[o+I]|$[o+I]}return n[s+8]=r,s}function Wg(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Kg(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function Bf(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let e=0,i=null,r=n;for(;null!==r;){const s=r[1],o=s.type;if(i=2===o?s.declTNode:1===o?r[6]:null,null===i)return-1;if(e++,r=r[15],-1!==i.injectorIndex)return i.injectorIndex|e<<16}return-1}function Lf(t,n,e){!function dk(t,n,e){let i;"string"==typeof e?i=e.charCodeAt(0)||0:e.hasOwnProperty(Tu)&&(i=e[Tu]),null==i&&(i=e[Tu]=uk++);const r=255&i;n.data[t+(r>>5)]|=1<<r}(t,n,e)}function ev(t,n,e){if(e&ln.Optional)return t;rc(n,"NodeInjector")}function tv(t,n,e,i){if(e&ln.Optional&&void 0===i&&(i=null),0==(e&(ln.Self|ln.Host))){const r=t[9],s=pa(void 0);try{return r?r.get(n,i,e&ln.Optional):w1(n,i,e&ln.Optional)}finally{pa(s)}}return ev(i,n,e)}function nv(t,n,e,i=ln.Default,r){if(null!==t){const s=function gk(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty(Tu)?t[Tu]:void 0;return"number"==typeof n?n>=0?255&n:hk:n}(e);if("function"==typeof s){if(!H1(n,t,i))return i&ln.Host?ev(r,e,i):tv(n,e,i,r);try{const o=s(i);if(null!=o||i&ln.Optional)return o;rc(e)}finally{W1()}}else if("number"==typeof s){let o=null,d=Kg(t,n),$=-1,I=i&ln.Host?n[16][6]:null;for((-1===d||i&ln.SkipSelf)&&($=-1===d?Bf(t,n):n[d+8],-1!==$&&sv(i,!1)?(o=n[1],d=fc($),n=hc($,n)):d=-1);-1!==d;){const Q=n[1];if(rv(s,d,Q.data)){const fe=pk(d,n,e,o,i,I);if(fe!==iv)return fe}$=n[d+8],-1!==$&&sv(i,n[1].data[d+8]===I)&&rv(s,d,n)?(o=Q,d=fc($),n=hc($,n)):d=-1}}}return tv(n,e,i,r)}const iv={};function hk(){return new pc(zi(),ft())}function pk(t,n,e,i,r,s){const o=n[1],d=o.data[t+8],Q=zf(d,o,e,null==i?Tf(d)&&qg:i!=o&&0!=(3&d.type),r&ln.Host&&s===d);return null!==Q?Nu(n,o,Q,d):iv}function zf(t,n,e,i,r){const s=t.providerIndexes,o=n.data,d=1048575&s,$=t.directiveStart,Q=s>>20,_e=r?d+Q:t.directiveEnd;for(let Ce=i?d:d+Q;Ce<_e;Ce++){const Ee=o[Ce];if(Ce<$&&e===Ee||Ce>=$&&Ee.type===e)return Ce}if(r){const Ce=o[$];if(Ce&&qs(Ce)&&Ce.type===e)return $}return null}function Nu(t,n,e,i){let r=t[e];const s=n.data;if(function sk(t){return t instanceof Du}(r)){const o=r;o.resolving&&function vf(t,n){const e=n?`. Dependency path: ${n.join(" > ")} > ${t}`:"";throw new Tt(-200,`Circular dependency in DI detected for ${t}${e}`)}(Oi(s[e]));const d=Of(o.canSeeViewProviders);o.resolving=!0;const $=o.injectImpl?pa(o.injectImpl):null;H1(t,i,ln.Default);try{r=t[e]=o.factory(void 0,s,t,i),n.firstCreatePass&&e>=i.directiveStart&&function ik(t,n,e){const{ngOnChanges:i,ngOnInit:r,ngDoCheck:s}=n.type.prototype;if(i){const o=D1(n);(e.preOrderHooks||(e.preOrderHooks=[])).push(t,o),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,o)}r&&(e.preOrderHooks||(e.preOrderHooks=[])).push(0-t,r),s&&((e.preOrderHooks||(e.preOrderHooks=[])).push(t,s),(e.preOrderCheckHooks||(e.preOrderCheckHooks=[])).push(t,s))}(e,s[e],n)}finally{null!==$&&pa($),Of(d),o.resolving=!1,W1()}}return r}function rv(t,n,e){return!!(e[n+(t>>5)]&1<<t)}function sv(t,n){return!(t&ln.Self||t&ln.Host&&n)}class pc{constructor(n,e){this._tNode=n,this._lView=e}get(n,e,i){return nv(this._tNode,this._lView,n,i,e)}}function gr(t){return ga(()=>{const n=t.prototype.constructor,e=n[Vo]||Yg(n),i=Object.prototype;let r=Object.getPrototypeOf(t.prototype).constructor;for(;r&&r!==i;){const s=r[Vo]||Yg(r);if(s&&s!==e)return s;r=Object.getPrototypeOf(r)}return s=>new s})}function Yg(t){return ic(t)?()=>{const n=Yg(nn(t));return n&&n()}:al(t)}const mc="__parameters__";function $c(t,n,e){return ga(()=>{const i=function Xg(t){return function(...e){if(t){const i=t(...e);for(const r in i)this[r]=i[r]}}}(n);function r(...s){if(this instanceof r)return i.apply(this,s),this;const o=new r(...s);return d.annotation=o,d;function d($,I,Q){const fe=$.hasOwnProperty(mc)?$[mc]:Object.defineProperty($,mc,{value:[]})[mc];for(;fe.length<=Q;)fe.push(null);return(fe[Q]=fe[Q]||[]).push(o),$}}return e&&(r.prototype=Object.create(e.prototype)),r.prototype.ngMetadataName=t,r.annotationCls=r,r})}class In{constructor(n,e){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof e?this.__NG_ELEMENT_ID__=e:void 0!==e&&(this.\u0275prov=Zt({token:this,providedIn:e.providedIn||"root",factory:e.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Ts(t,n){void 0===n&&(n=t);for(let e=0;e<t.length;e++){let i=t[e];Array.isArray(i)?(n===t&&(n=t.slice(0,e)),Ts(i,n)):n!==t&&n.push(i)}return n}function fo(t,n){t.forEach(e=>Array.isArray(e)?fo(e,n):n(e))}function av(t,n,e){n>=t.length?t.push(e):t.splice(n,0,e)}function jf(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Ou(t,n){const e=[];for(let i=0;i<t;i++)e.push(n);return e}function as(t,n,e){let i=vc(t,n);return i>=0?t[1|i]=e:(i=~i,function vk(t,n,e,i){let r=t.length;if(r==n)t.push(e,i);else if(1===r)t.push(i,t[0]),t[0]=e;else{for(r--,t.push(t[r-1],t[r]);r>n;)t[r]=t[r-2],r--;t[n]=e,t[n+1]=i}}(t,i,n,e)),i}function Jg(t,n){const e=vc(t,n);if(e>=0)return t[1|e]}function vc(t,n){return function uv(t,n,e){let i=0,r=t.length>>e;for(;r!==i;){const s=i+(r-i>>1),o=t[s<<e];if(n===o)return s<<e;o>n?r=s:i=s+1}return~(r<<e)}(t,n,1)}const Bu={},tm="__NG_DI_FLAG__",Hf="ngTempTokenPath",Tk=/\n/gm,fv="__source",Sk=wn({provide:String,useValue:wn});let Lu;function hv(t){const n=Lu;return Lu=t,n}function kk(t,n=ln.Default){if(void 0===Lu)throw new Tt(203,"");return null===Lu?w1(t,void 0,n):Lu.get(t,n&ln.Optional?null:void 0,n)}function tn(t,n=ln.Default){return(function gS(){return Cg}()||kk)(nn(t),n)}const Mk=tn;function nm(t){const n=[];for(let e=0;e<t.length;e++){const i=nn(t[e]);if(Array.isArray(i)){if(0===i.length)throw new Tt(900,"");let r,s=ln.Default;for(let o=0;o<i.length;o++){const d=i[o],$=Dk(d);"number"==typeof $?-1===$?r=d.token:s|=$:r=d}n.push(tn(r,s))}else n.push(tn(i))}return n}function zu(t,n){return t[tm]=n,t.prototype[tm]=n,t}function Dk(t){return t[tm]}const Vf=zu($c("Optional"),8),Gf=zu($c("SkipSelf"),4);let Wf,Kf;function yc(t){var n;return(null===(n=function sm(){if(void 0===Wf&&(Wf=null,Wn.trustedTypes))try{Wf=Wn.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return Wf}())||void 0===n?void 0:n.createHTML(t))||t}function vv(t){var n;return(null===(n=function om(){if(void 0===Kf&&(Kf=null,Wn.trustedTypes))try{Kf=Wn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch(t){}return Kf}())||void 0===n?void 0:n.createHTML(t))||t}class ll{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Vk extends ll{getTypeName(){return"HTML"}}class Gk extends ll{getTypeName(){return"Style"}}class qk extends ll{getTypeName(){return"Script"}}class Wk extends ll{getTypeName(){return"URL"}}class Kk extends ll{getTypeName(){return"ResourceURL"}}function ls(t){return t instanceof ll?t.changingThisBreaksApplicationSecurity:t}function ho(t,n){const e=Cv(t);if(null!=e&&e!==n){if("ResourceURL"===e&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${e} (see https://g.co/ng/security#xss)`)}return e===n}function Cv(t){return t instanceof ll&&t.getTypeName()||null}class eM{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const e=(new window.DOMParser).parseFromString(yc(n),"text/html").body;return null===e?this.inertDocumentHelper.getInertBodyElement(n):(e.removeChild(e.firstChild),e)}catch(e){return null}}}class tM{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const e=this.inertDocument.createElement("html");this.inertDocument.appendChild(e);const i=this.inertDocument.createElement("body");e.appendChild(i)}}getInertBodyElement(n){const e=this.inertDocument.createElement("template");if("content"in e)return e.innerHTML=yc(n),e;const i=this.inertDocument.createElement("body");return i.innerHTML=yc(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(i),i}stripCustomNsAttrs(n){const e=n.attributes;for(let r=e.length-1;0<r;r--){const o=e.item(r).name;("xmlns:ns1"===o||0===o.indexOf("ns1:"))&&n.removeAttribute(o)}let i=n.firstChild;for(;i;)i.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(i),i=i.nextSibling}}const iM=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,rM=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Uu(t){return(t=String(t)).match(iM)||t.match(rM)?t:"unsafe:"+t}function wv(t){return(t=String(t)).split(",").map(n=>Uu(n.trim())).join(", ")}function po(t){const n={};for(const e of t.split(","))n[e]=!0;return n}function Hu(...t){const n={};for(const e of t)for(const i in e)e.hasOwnProperty(i)&&(n[i]=!0);return n}const Ev=po("area,br,col,hr,img,wbr"),Tv=po("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Iv=po("rp,rt"),am=Hu(Ev,Hu(Tv,po("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),Hu(Iv,po("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),Hu(Iv,Tv)),lm=po("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),cm=po("srcset"),Sv=Hu(lm,cm,po("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),po("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),sM=po("script,style,template");class oM{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let e=n.firstChild,i=!0;for(;e;)if(e.nodeType===Node.ELEMENT_NODE?i=this.startElement(e):e.nodeType===Node.TEXT_NODE?this.chars(e.nodeValue):this.sanitizedSomething=!0,i&&e.firstChild)e=e.firstChild;else for(;e;){e.nodeType===Node.ELEMENT_NODE&&this.endElement(e);let r=this.checkClobberedElement(e,e.nextSibling);if(r){e=r;break}e=this.checkClobberedElement(e,e.parentNode)}return this.buf.join("")}startElement(n){const e=n.nodeName.toLowerCase();if(!am.hasOwnProperty(e))return this.sanitizedSomething=!0,!sM.hasOwnProperty(e);this.buf.push("<"),this.buf.push(e);const i=n.attributes;for(let r=0;r<i.length;r++){const s=i.item(r),o=s.name,d=o.toLowerCase();if(!Sv.hasOwnProperty(d)){this.sanitizedSomething=!0;continue}let $=s.value;lm[d]&&($=Uu($)),cm[d]&&($=wv($)),this.buf.push(" ",o,'="',kv($),'"')}return this.buf.push(">"),!0}endElement(n){const e=n.nodeName.toLowerCase();am.hasOwnProperty(e)&&!Ev.hasOwnProperty(e)&&(this.buf.push("</"),this.buf.push(e),this.buf.push(">"))}chars(n){this.buf.push(kv(n))}checkClobberedElement(n,e){if(e&&(n.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return e}}const aM=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,lM=/([^\#-~ |!])/g;function kv(t){return t.replace(/&/g,"&amp;").replace(aM,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(lM,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let Yf;function Mv(t,n){let e=null;try{Yf=Yf||function xv(t){const n=new tM(t);return function nM(){try{return!!(new window.DOMParser).parseFromString(yc(""),"text/html")}catch(t){return!1}}()?new eM(n):n}(t);let i=n?String(n):"";e=Yf.getInertBodyElement(i);let r=5,s=i;do{if(0===r)throw new Error("Failed to sanitize html because the input is unstable");r--,i=s,s=e.innerHTML,e=Yf.getInertBodyElement(i)}while(i!==s);return yc((new oM).sanitizeChildren(um(e)||e))}finally{if(e){const i=um(e)||e;for(;i.firstChild;)i.removeChild(i.firstChild)}}}function um(t){return"content"in t&&function cM(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var ni=(()=>((ni=ni||{})[ni.NONE=0]="NONE",ni[ni.HTML=1]="HTML",ni[ni.STYLE=2]="STYLE",ni[ni.SCRIPT=3]="SCRIPT",ni[ni.URL=4]="URL",ni[ni.RESOURCE_URL=5]="RESOURCE_URL",ni))();function Ui(t){const n=Vu();return n?vv(n.sanitize(ni.HTML,t)||""):ho(t,"HTML")?vv(ls(t)):Mv(Ng(),Ut(t))}function Xt(t){const n=Vu();return n?n.sanitize(ni.URL,t)||"":ho(t,"URL")?ls(t):Uu(Ut(t))}function Vu(){const t=ft();return t&&t[12]}const Pv="__ngContext__";function mr(t,n){t[Pv]=n}function fm(t){const n=function Gu(t){return t[Pv]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function pm(t){return t.ngOriginalError}function EM(t,...n){t.error(...n)}class qu{constructor(){this._console=console}handleError(n){const e=this._findOriginalError(n),i=function wM(t){return t&&t.ngErrorLogger||EM}(n);i(this._console,"ERROR",n),e&&i(this._console,"ORIGINAL ERROR",e)}_findOriginalError(n){let e=n&&pm(n);for(;e&&pm(e);)e=pm(e);return e||null}}const FM=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Wn))();function Zf(t){return t.ownerDocument}function go(t){return t instanceof Function?t():t}var cs=(()=>((cs=cs||{})[cs.Important=1]="Important",cs[cs.DashCase=2]="DashCase",cs))();function mm(t,n){return undefined(t,n)}function Wu(t){const n=t[3];return Gs(n)?n[3]:n}function _m(t){return Uv(t[13])}function $m(t){return Uv(t[4])}function Uv(t){for(;null!==t&&!Gs(t);)t=t[4];return t}function xc(t,n,e,i,r){if(null!=i){let s,o=!1;Gs(i)?s=i:co(i)&&(o=!0,i=i[0]);const d=Mi(i);0===t&&null!==e?null==r?Kv(n,e,d):cl(n,e,d,r||null,!0):1===t&&null!==e?cl(n,e,d,r||null,!0):2===t?function tb(t,n,e){const i=Xf(t,n);i&&function KM(t,n,e,i){yi(t)?t.removeChild(n,e,i):n.removeChild(e)}(t,i,n,e)}(n,d,o):3===t&&n.destroyNode(d),null!=s&&function XM(t,n,e,i,r){const s=e[7];s!==Mi(e)&&xc(n,t,i,s,r);for(let d=10;d<e.length;d++){const $=e[d];Ku($[1],$,t,n,i,s)}}(n,t,s,e,r)}}function bm(t,n,e){if(yi(t))return t.createElement(n,e);{const i=null!==e?function NS(t){const n=t.toLowerCase();return"svg"===n?"http://www.w3.org/2000/svg":"math"===n?"http://www.w3.org/1998/MathML/":null}(e):null;return null===i?t.createElement(n):t.createElementNS(i,n)}}function Vv(t,n){const e=t[9],i=e.indexOf(n),r=n[3];1024&n[2]&&(n[2]&=-1025,Og(r,-1)),e.splice(i,1)}function ym(t,n){if(t.length<=10)return;const e=10+n,i=t[e];if(i){const r=i[17];null!==r&&r!==t&&Vv(r,i),n>0&&(t[e-1][4]=i[4]);const s=jf(t,10+n);!function zM(t,n){Ku(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(i[1],i);const o=s[19];null!==o&&o.detachView(s[1]),i[3]=null,i[4]=null,i[2]&=-129}return i}function Gv(t,n){if(!(256&n[2])){const e=n[11];yi(e)&&e.destroyNode&&Ku(t,n,e,3,null,null),function HM(t){let n=t[13];if(!n)return Cm(t[1],t);for(;n;){let e=null;if(co(n))e=n[13];else{const i=n[10];i&&(e=i)}if(!e){for(;n&&!n[4]&&n!==t;)co(n)&&Cm(n[1],n),n=n[3];null===n&&(n=t),co(n)&&Cm(n[1],n),e=n&&n[4]}n=e}}(n)}}function Cm(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function WM(t,n){let e;if(null!=t&&null!=(e=t.destroyHooks))for(let i=0;i<e.length;i+=2){const r=n[e[i]];if(!(r instanceof Du)){const s=e[i+1];if(Array.isArray(s))for(let o=0;o<s.length;o+=2){const d=r[s[o]],$=s[o+1];try{$.call(d)}finally{}}else try{s.call(r)}finally{}}}}(t,n),function qM(t,n){const e=t.cleanup,i=n[7];let r=-1;if(null!==e)for(let s=0;s<e.length-1;s+=2)if("string"==typeof e[s]){const o=e[s+1],d="function"==typeof o?o(n):Mi(n[o]),$=i[r=e[s+2]],I=e[s+3];"boolean"==typeof I?d.removeEventListener(e[s],$,I):I>=0?i[r=I]():i[r=-I].unsubscribe(),s+=2}else{const o=i[r=e[s+1]];e[s].call(o)}if(null!==i){for(let s=r+1;s<i.length;s++)i[s]();n[7]=null}}(t,n),1===n[1].type&&yi(n[11])&&n[11].destroy();const e=n[17];if(null!==e&&Gs(n[3])){e!==n[3]&&Vv(e,n);const i=n[19];null!==i&&i.detachView(t)}}}function qv(t,n,e){return function Wv(t,n,e){let i=n;for(;null!==i&&40&i.type;)i=(n=i).parent;if(null===i)return e[0];if(2&i.flags){const r=t.data[i.directiveStart].encapsulation;if(r===Hs.None||r===Hs.Emulated)return null}return Es(i,e)}(t,n.parent,e)}function cl(t,n,e,i,r){yi(t)?t.insertBefore(n,e,i,r):n.insertBefore(e,i,r)}function Kv(t,n,e){yi(t)?t.appendChild(n,e):n.appendChild(e)}function Yv(t,n,e,i,r){null!==i?cl(t,n,e,i,r):Kv(t,n,e)}function Xf(t,n){return yi(t)?t.parentNode(n):n.parentNode}function Zv(t,n,e){return Qv(t,n,e)}let Qv=function Xv(t,n,e){return 40&t.type?Es(t,e):null};function Qf(t,n,e,i){const r=qv(t,i,n),s=n[11],d=Zv(i.parent||n[6],i,n);if(null!=r)if(Array.isArray(e))for(let $=0;$<e.length;$++)Yv(s,r,e[$],d,!1);else Yv(s,r,e,d,!1)}function Jf(t,n){if(null!==n){const e=n.type;if(3&e)return Es(n,t);if(4&e)return wm(-1,t[n.index]);if(8&e){const i=n.child;if(null!==i)return Jf(t,i);{const r=t[n.index];return Gs(r)?wm(-1,r):Mi(r)}}if(32&e)return mm(n,t)()||Mi(t[n.index]);{const i=eb(t,n);return null!==i?Array.isArray(i)?i[0]:Jf(Wu(t[16]),i):Jf(t,n.next)}}return null}function eb(t,n){return null!==n?t[16][6].projection[n.projection]:null}function wm(t,n){const e=10+t+1;if(e<n.length){const i=n[e],r=i[1].firstChild;if(null!==r)return Jf(i,r)}return n[7]}function Em(t,n,e,i,r,s,o){for(;null!=e;){const d=i[e.index],$=e.type;if(o&&0===n&&(d&&mr(Mi(d),i),e.flags|=4),64!=(64&e.flags))if(8&$)Em(t,n,e.child,i,r,s,!1),xc(n,t,r,d,s);else if(32&$){const I=mm(e,i);let Q;for(;Q=I();)xc(n,t,r,Q,s);xc(n,t,r,d,s)}else 16&$?nb(t,n,i,e,r,s):xc(n,t,r,d,s);e=o?e.projectionNext:e.next}}function Ku(t,n,e,i,r,s){Em(e,i,t.firstChild,n,r,s,!1)}function nb(t,n,e,i,r,s){const o=e[16],$=o[6].projection[i.projection];if(Array.isArray($))for(let I=0;I<$.length;I++)xc(n,t,r,$[I],s);else Em(t,n,$,o[3],r,s,!0)}function ib(t,n,e){yi(t)?t.setAttribute(n,"style",e):n.style.cssText=e}function Tm(t,n,e){yi(t)?""===e?t.removeAttribute(n,"class"):t.setAttribute(n,"class",e):n.className=e}function rb(t,n,e){let i=t.length;for(;;){const r=t.indexOf(n,e);if(-1===r)return r;if(0===r||t.charCodeAt(r-1)<=32){const s=n.length;if(r+s===i||t.charCodeAt(r+s)<=32)return r}e=r+1}}const sb="ng-template";function JM(t,n,e){let i=0;for(;i<t.length;){let r=t[i++];if(e&&"class"===r){if(r=t[i],-1!==rb(r.toLowerCase(),n,0))return!0}else if(1===r){for(;i<t.length&&"string"==typeof(r=t[i++]);)if(r.toLowerCase()===n)return!0;return!1}}return!1}function ob(t){return 4===t.type&&t.value!==sb}function eD(t,n,e){return n===(4!==t.type||e?t.value:sb)}function tD(t,n,e){let i=4;const r=t.attrs||[],s=function rD(t){for(let n=0;n<t.length;n++)if(Y1(t[n]))return n;return t.length}(r);let o=!1;for(let d=0;d<n.length;d++){const $=n[d];if("number"!=typeof $){if(!o)if(4&i){if(i=2|1&i,""!==$&&!eD(t,$,e)||""===$&&1===n.length){if(Ks(i))return!1;o=!0}}else{const I=8&i?$:n[++d];if(8&i&&null!==t.attrs){if(!JM(t.attrs,I,e)){if(Ks(i))return!1;o=!0}continue}const fe=nD(8&i?"class":$,r,ob(t),e);if(-1===fe){if(Ks(i))return!1;o=!0;continue}if(""!==I){let _e;_e=fe>s?"":r[fe+1].toLowerCase();const Ce=8&i?_e:null;if(Ce&&-1!==rb(Ce,I,0)||2&i&&I!==_e){if(Ks(i))return!1;o=!0}}}}else{if(!o&&!Ks(i)&&!Ks($))return!1;if(o&&Ks($))continue;o=!1,i=$|1&i}}return Ks(i)||o}function Ks(t){return 0==(1&t)}function nD(t,n,e,i){if(null===n)return-1;let r=0;if(i||!e){let s=!1;for(;r<n.length;){const o=n[r];if(o===t)return r;if(3===o||6===o)s=!0;else{if(1===o||2===o){let d=n[++r];for(;"string"==typeof d;)d=n[++r];continue}if(4===o)break;if(0===o){r+=4;continue}}r+=s?1:2}return-1}return function sD(t,n){let e=t.indexOf(4);if(e>-1)for(e++;e<t.length;){const i=t[e];if("number"==typeof i)return-1;if(i===n)return e;e++}return-1}(n,t)}function ab(t,n,e=!1){for(let i=0;i<n.length;i++)if(tD(t,n[i],e))return!0;return!1}function oD(t,n){e:for(let e=0;e<n.length;e++){const i=n[e];if(t.length===i.length){for(let r=0;r<t.length;r++)if(t[r]!==i[r])continue e;return!0}}return!1}function lb(t,n){return t?":not("+n.trim()+")":n}function aD(t){let n=t[0],e=1,i=2,r="",s=!1;for(;e<t.length;){let o=t[e];if("string"==typeof o)if(2&i){const d=t[++e];r+="["+o+(d.length>0?'="'+d+'"':"")+"]"}else 8&i?r+="."+o:4&i&&(r+=" "+o);else""!==r&&!Ks(o)&&(n+=lb(s,r),r=""),i=o,s=s||!Ks(i);e++}return""!==r&&(n+=lb(s,r)),n}const on={};function W(t){cb(Dn(),ft(),kr()+t,!1)}function cb(t,n,e,i){if(!i)if(3==(3&n[2])){const s=t.preOrderCheckHooks;null!==s&&Pf(n,s,e)}else{const s=t.preOrderHooks;null!==s&&Nf(n,s,0,e)}$a(e)}function eh(t,n){return t<<17|n<<2}function Ys(t){return t>>17&32767}function Im(t){return 2|t}function Wo(t){return(131068&t)>>2}function Sm(t,n){return-131069&t|n<<2}function km(t){return 1|t}function bb(t,n){const e=t.contentQueries;if(null!==e)for(let i=0;i<e.length;i+=2){const r=e[i],s=e[i+1];if(-1!==s){const o=t.data[s];Ug(r),o.contentQueries(2,n[s],s)}}}function Yu(t,n,e,i,r,s,o,d,$,I){const Q=n.blueprint.slice();return Q[0]=r,Q[2]=140|i,R1(Q),Q[3]=Q[15]=t,Q[8]=e,Q[10]=o||t&&t[10],Q[11]=d||t&&t[11],Q[12]=$||t&&t[12]||null,Q[9]=I||t&&t[9]||null,Q[6]=s,Q[16]=2==n.type?t[16]:Q,Q}function wc(t,n,e,i,r){let s=t.data[n];if(null===s)s=function Bm(t,n,e,i,r){const s=L1(),o=Bg(),$=t.data[n]=function ED(t,n,e,i,r,s){return{type:e,index:i,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:r,attrs:s,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,o?s:s&&s.parent,e,n,i,r);return null===t.firstChild&&(t.firstChild=$),null!==s&&(o?null==s.child&&null!==$.parent&&(s.child=$):null===s.next&&(s.next=$)),$}(t,n,e,i,r),function qS(){return sn.lFrame.inI18n}()&&(s.flags|=64);else if(64&s.type){s.type=e,s.value=i,s.attrs=r;const o=function Mu(){const t=sn.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();s.injectorIndex=null===o?-1:o.injectorIndex}return uo(s,!0),s}function Ec(t,n,e,i){if(0===e)return-1;const r=n.length;for(let s=0;s<e;s++)n.push(i),t.blueprint.push(i),t.data.push(null);return r}function Zu(t,n,e){Mf(n);try{const i=t.viewQuery;null!==i&&Wm(1,i,e);const r=t.template;null!==r&&yb(t,n,r,1,e),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&bb(t,n),t.staticViewQueries&&Wm(2,t.viewQuery,e);const s=t.components;null!==s&&function CD(t,n){for(let e=0;e<n.length;e++)HD(t,n[e])}(n,s)}catch(i){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),i}finally{n[2]&=-5,Df()}}function Tc(t,n,e,i){const r=n[2];if(256!=(256&r)){Mf(n);try{R1(n),function z1(t){return sn.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==e&&yb(t,n,e,2,i);const o=3==(3&r);if(o){const I=t.preOrderCheckHooks;null!==I&&Pf(n,I,null)}else{const I=t.preOrderHooks;null!==I&&Nf(n,I,0,null),Hg(n,0)}if(function jD(t){for(let n=_m(t);null!==n;n=$m(n)){if(!n[2])continue;const e=n[9];for(let i=0;i<e.length;i++){const r=e[i],s=r[3];0==(1024&r[2])&&Og(s,1),r[2]|=1024}}}(n),function zD(t){for(let n=_m(t);null!==n;n=$m(n))for(let e=10;e<n.length;e++){const i=n[e],r=i[1];Rg(i)&&Tc(r,i,r.template,i[8])}}(n),null!==t.contentQueries&&bb(t,n),o){const I=t.contentCheckHooks;null!==I&&Pf(n,I)}else{const I=t.contentHooks;null!==I&&Nf(n,I,1),Hg(n,1)}!function bD(t,n){const e=t.hostBindingOpCodes;if(null!==e)try{for(let i=0;i<e.length;i++){const r=e[i];if(r<0)$a(~r);else{const s=r,o=e[++i],d=e[++i];WS(o,s),d(2,n[s])}}}finally{$a(-1)}}(t,n);const d=t.components;null!==d&&function yD(t,n){for(let e=0;e<n.length;e++)UD(t,n[e])}(n,d);const $=t.viewQuery;if(null!==$&&Wm(2,$,i),o){const I=t.viewCheckHooks;null!==I&&Pf(n,I)}else{const I=t.viewHooks;null!==I&&Nf(n,I,2),Hg(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),n[2]&=-73,1024&n[2]&&(n[2]&=-1025,Og(n[3],-1))}finally{Df()}}}function xD(t,n,e,i){const r=n[10],o=F1(n);try{!o&&r.begin&&r.begin(),o&&Zu(t,n,i),Tc(t,n,e,i)}finally{!o&&r.end&&r.end()}}function yb(t,n,e,i,r){const s=kr(),o=2&i;try{$a(-1),o&&n.length>20&&cb(t,n,20,!1),e(i,r)}finally{$a(s)}}function Cb(t,n,e){if(Sg(n)){const r=n.directiveEnd;for(let s=n.directiveStart;s<r;s++){const o=t.data[s];o.contentQueries&&o.contentQueries(1,e[s],s)}}}function Lm(t,n,e){!B1()||(function AD(t,n,e,i){const r=e.directiveStart,s=e.directiveEnd;t.firstCreatePass||Pu(e,n),mr(i,n);const o=e.initialInputs;for(let d=r;d<s;d++){const $=t.data[d],I=qs($);I&&OD(n,e,$);const Q=Nu(n,t,d,e);mr(Q,n),null!==o&&BD(0,d-r,Q,$,0,o),I&&(os(e.index,n)[8]=Q)}}(t,n,e,Es(e,n)),128==(128&e.flags)&&function PD(t,n,e){const i=e.directiveStart,r=e.directiveEnd,o=e.index,d=function KS(){return sn.lFrame.currentDirectiveIndex}();try{$a(o);for(let $=i;$<r;$++){const I=t.data[$],Q=n[$];zg($),(null!==I.hostBindings||0!==I.hostVars||null!==I.hostAttrs)&&Mb(I,Q)}}finally{$a(-1),zg(d)}}(t,n,e))}function zm(t,n,e=Es){const i=n.localNames;if(null!==i){let r=n.index+1;for(let s=0;s<i.length;s+=2){const o=i[s+1],d=-1===o?e(n,t):t[o];t[r++]=d}}}function xb(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=ih(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function ih(t,n,e,i,r,s,o,d,$,I){const Q=20+i,fe=Q+r,_e=function wD(t,n){const e=[];for(let i=0;i<n;i++)e.push(i<t?null:on);return e}(Q,fe),Ce="function"==typeof I?I():I;return _e[1]={type:t,blueprint:_e,template:e,queries:null,viewQuery:d,declTNode:n,data:_e.slice().fill(null,Q),bindingStartIndex:Q,expandoStartIndex:fe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof s?s():s,pipeRegistry:"function"==typeof o?o():o,firstChild:null,schemas:$,consts:Ce,incompleteFirstPass:!1}}function Tb(t,n,e,i){const r=Rb(n);null===e?r.push(i):(r.push(e),t.firstCreatePass&&Ob(t).push(i,r.length-1))}function Ib(t,n,e){for(let i in t)if(t.hasOwnProperty(i)){const r=t[i];(e=null===e?{}:e).hasOwnProperty(i)?e[i].push(n,r):e[i]=[n,r]}return e}function us(t,n,e,i,r,s,o,d){const $=Es(n,e);let Q,I=n.inputs;!d&&null!=I&&(Q=I[i])?(zb(t,e,Q,i,r),Tf(n)&&function SD(t,n){const e=os(n,t);16&e[2]||(e[2]|=64)}(e,n.index)):3&n.type&&(i=function ID(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(i),r=null!=o?o(r,n.value||"",i):r,yi(s)?s.setProperty($,i,r):Gg(i)||($.setProperty?$.setProperty(i,r):$[i]=r))}function jm(t,n,e,i){let r=!1;if(B1()){const s=function ND(t,n,e){const i=t.directiveRegistry;let r=null;if(i)for(let s=0;s<i.length;s++){const o=i[s];ab(e,o.selectors,!1)&&(r||(r=[]),Lf(Pu(e,n),t,o.type),qs(o)?(Db(t,e),r.unshift(o)):r.push(o))}return r}(t,n,e),o=null===i?null:{"":-1};if(null!==s){r=!0,Ab(e,t.data.length,s.length);for(let Q=0;Q<s.length;Q++){const fe=s[Q];fe.providersResolver&&fe.providersResolver(fe)}let d=!1,$=!1,I=Ec(t,n,s.length,null);for(let Q=0;Q<s.length;Q++){const fe=s[Q];e.mergedAttrs=Rf(e.mergedAttrs,fe.hostAttrs),Pb(t,e,n,I,fe),RD(I,fe,o),null!==fe.contentQueries&&(e.flags|=8),(null!==fe.hostBindings||null!==fe.hostAttrs||0!==fe.hostVars)&&(e.flags|=128);const _e=fe.type.prototype;!d&&(_e.ngOnChanges||_e.ngOnInit||_e.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(e.index),d=!0),!$&&(_e.ngOnChanges||_e.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(e.index),$=!0),I++}!function TD(t,n){const i=n.directiveEnd,r=t.data,s=n.attrs,o=[];let d=null,$=null;for(let I=n.directiveStart;I<i;I++){const Q=r[I],fe=Q.inputs,_e=null===s||ob(n)?null:LD(fe,s);o.push(_e),d=Ib(fe,I,d),$=Ib(Q.outputs,I,$)}null!==d&&(d.hasOwnProperty("class")&&(n.flags|=16),d.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=o,n.inputs=d,n.outputs=$}(t,e)}o&&function FD(t,n,e){if(n){const i=t.localNames=[];for(let r=0;r<n.length;r+=2){const s=e[n[r+1]];if(null==s)throw new Tt(-301,!1);i.push(n[r],s)}}}(e,i,o)}return e.mergedAttrs=Rf(e.mergedAttrs,e.attrs),r}function kb(t,n,e,i,r,s){const o=s.hostBindings;if(o){let d=t.hostBindingOpCodes;null===d&&(d=t.hostBindingOpCodes=[]);const $=~n.index;(function DD(t){let n=t.length;for(;n>0;){const e=t[--n];if("number"==typeof e&&e<0)return e}return 0})(d)!=$&&d.push($),d.push(i,r,o)}}function Mb(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function Db(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function RD(t,n,e){if(e){if(n.exportAs)for(let i=0;i<n.exportAs.length;i++)e[n.exportAs[i]]=t;qs(n)&&(e[""]=t)}}function Ab(t,n,e){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+e,t.providerIndexes=n}function Pb(t,n,e,i,r){t.data[i]=r;const s=r.factory||(r.factory=al(r.type)),o=new Du(s,qs(r),null);t.blueprint[i]=o,e[i]=o,kb(t,n,0,i,Ec(t,e,r.hostVars,on),r)}function OD(t,n,e){const i=Es(n,t),r=xb(e),s=t[10],o=rh(t,Yu(t,r,null,e.onPush?64:16,i,n,s,s.createRenderer(i,e),null,null));t[n.index]=o}function mo(t,n,e,i,r,s){const o=Es(t,n);!function Um(t,n,e,i,r,s,o){if(null==s)yi(t)?t.removeAttribute(n,r,e):n.removeAttribute(r);else{const d=null==o?Ut(s):o(s,i||"",r);yi(t)?t.setAttribute(n,r,d,e):e?n.setAttributeNS(e,r,d):n.setAttribute(r,d)}}(n[11],o,s,t.value,e,i,r)}function BD(t,n,e,i,r,s){const o=s[n];if(null!==o){const d=i.setInput;for(let $=0;$<o.length;){const I=o[$++],Q=o[$++],fe=o[$++];null!==d?i.setInput(e,fe,I,Q):e[Q]=fe}}}function LD(t,n){let e=null,i=0;for(;i<n.length;){const r=n[i];if(0!==r)if(5!==r){if("number"==typeof r)break;t.hasOwnProperty(r)&&(null===e&&(e=[]),e.push(r,t[r],n[i+1])),i+=2}else i+=2;else i+=4}return e}function Nb(t,n,e,i){return new Array(t,!0,!1,n,null,0,i,e,null,null)}function UD(t,n){const e=os(n,t);if(Rg(e)){const i=e[1];80&e[2]?Tc(i,e,i.template,e[8]):e[5]>0&&Hm(e)}}function Hm(t){for(let i=_m(t);null!==i;i=$m(i))for(let r=10;r<i.length;r++){const s=i[r];if(1024&s[2]){const o=s[1];Tc(o,s,o.template,s[8])}else s[5]>0&&Hm(s)}const e=t[1].components;if(null!==e)for(let i=0;i<e.length;i++){const r=os(e[i],t);Rg(r)&&r[5]>0&&Hm(r)}}function HD(t,n){const e=os(n,t),i=e[1];(function VD(t,n){for(let e=n.length;e<t.blueprint.length;e++)n.push(t.blueprint[e])})(i,e),Zu(i,e,e[8])}function rh(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function Vm(t){for(;t;){t[2]|=64;const n=Wu(t);if(wS(t)&&!n)return t;t=n}return null}function Fb(t){!function Gm(t){for(let n=0;n<t.components.length;n++){const e=t.components[n],i=fm(e),r=i[1];xD(r,i,r.template,e)}}(t[8])}function Wm(t,n,e){Ug(0),n(t,e)}const qD=(()=>Promise.resolve(null))();function Rb(t){return t[7]||(t[7]=[])}function Ob(t){return t.cleanup||(t.cleanup=[])}function Lb(t,n){const e=t[9],i=e?e.get(qu,null):null;i&&i.handleError(n)}function zb(t,n,e,i,r){for(let s=0;s<e.length;){const o=e[s++],d=e[s++],$=n[o],I=t.data[o];null!==I.setInput?I.setInput($,r,i,d):$[d]=r}}function Ko(t,n,e){const i=Sf(n,t);!function Hv(t,n,e){yi(t)?t.setValue(n,e):n.textContent=e}(t[11],i,e)}function sh(t,n,e){let i=e?t.styles:null,r=e?t.classes:null,s=0;if(null!==n)for(let o=0;o<n.length;o++){const d=n[o];"number"==typeof d?s=d:1==s?r=fa(r,d):2==s&&(i=fa(i,d+": "+n[++o]+";"))}e?t.styles=i:t.stylesWithoutHost=i,e?t.classes=r:t.classesWithoutHost=r}const Km=new In("INJECTOR",-1);class jb{get(n,e=Bu){if(e===Bu){const i=new Error(`NullInjectorError: No provider for ${Rn(n)}!`);throw i.name="NullInjectorError",i}return e}}const Ym=new In("Set Injector scope."),Xu={},YD={};let Zm;function Ub(){return void 0===Zm&&(Zm=new jb),Zm}function Hb(t,n=null,e=null,i){const r=Vb(t,n,e,i);return r._resolveInjectorDefTypes(),r}function Vb(t,n=null,e=null,i){return new ZD(t,e,n||Ub(),i)}class ZD{constructor(n,e,i,r=null){this.parent=i,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const s=[];e&&fo(e,d=>this.processProvider(d,n,e)),fo([n],d=>this.processInjectorType(d,[],s)),this.records.set(Km,Ic(void 0,this));const o=this.records.get(Ym);this.scope=null!=o?o.value:null,this.source=r||("object"==typeof n?null:Rn(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,e=Bu,i=ln.Default){this.assertNotDestroyed();const r=hv(this),s=pa(void 0);try{if(!(i&ln.SkipSelf)){let d=this.records.get(n);if(void 0===d){const $=function rA(t){return"function"==typeof t||"object"==typeof t&&t instanceof In}(n)&&bg(n);d=$&&this.injectableDefInScope($)?Ic(Xm(n),Xu):null,this.records.set(n,d)}if(null!=d)return this.hydrate(n,d)}return(i&ln.Self?Ub():this.parent).get(n,e=i&ln.Optional&&e===Bu?null:e)}catch(o){if("NullInjectorError"===o.name){if((o[Hf]=o[Hf]||[]).unshift(Rn(n)),r)throw o;return function Ak(t,n,e,i){const r=t[Hf];throw n[fv]&&r.unshift(n[fv]),t.message=function Pk(t,n,e,i=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let r=Rn(n);if(Array.isArray(n))r=n.map(Rn).join(" -> ");else if("object"==typeof n){let s=[];for(let o in n)if(n.hasOwnProperty(o)){let d=n[o];s.push(o+":"+("string"==typeof d?JSON.stringify(d):Rn(d)))}r=`{${s.join(", ")}}`}return`${e}${i?"("+i+")":""}[${r}]: ${t.replace(Tk,"\n  ")}`}("\n"+t.message,r,e,i),t.ngTokenPath=r,t[Hf]=null,t}(o,n,"R3InjectorError",this.source)}throw o}finally{pa(s),hv(r)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((i,r)=>n.push(Rn(r))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Tt(205,!1)}processInjectorType(n,e,i){if(!(n=nn(n)))return!1;let r=C1(n);const s=null==r&&n.ngModule||void 0,o=void 0===s?n:s,d=-1!==i.indexOf(o);if(void 0!==s&&(r=C1(s)),null==r)return!1;if(null!=r.imports&&!d){let Q;i.push(o);try{fo(r.imports,fe=>{this.processInjectorType(fe,e,i)&&(void 0===Q&&(Q=[]),Q.push(fe))})}finally{}if(void 0!==Q)for(let fe=0;fe<Q.length;fe++){const{ngModule:_e,providers:Ce}=Q[fe];fo(Ce,Ee=>this.processProvider(Ee,_e,Ce||Qn))}}this.injectorDefTypes.add(o);const $=al(o)||(()=>new o);this.records.set(o,Ic($,Xu));const I=r.providers;if(null!=I&&!d){const Q=n;fo(I,fe=>this.processProvider(fe,Q,I))}return void 0!==s&&void 0!==n.providers}processProvider(n,e,i){let r=Sc(n=nn(n))?n:nn(n&&n.provide);const s=function QD(t,n,e){return qb(t)?Ic(void 0,t.useValue):Ic(Gb(t),Xu)}(n);if(Sc(n)||!0!==n.multi)this.records.get(r);else{let o=this.records.get(r);o||(o=Ic(void 0,Xu,!0),o.factory=()=>nm(o.multi),this.records.set(r,o)),r=n,o.multi.push(n)}this.records.set(r,s)}hydrate(n,e){return e.value===Xu&&(e.value=YD,e.value=e.factory()),"object"==typeof e.value&&e.value&&function iA(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(e.value)&&this.onDestroy.add(e.value),e.value}injectableDefInScope(n){if(!n.providedIn)return!1;const e=nn(n.providedIn);return"string"==typeof e?"any"===e||e===this.scope:this.injectorDefTypes.has(e)}}function Xm(t){const n=bg(t),e=null!==n?n.factory:al(t);if(null!==e)return e;if(t instanceof In)throw new Tt(204,!1);if(t instanceof Function)return function XD(t){const n=t.length;if(n>0)throw Ou(n,"?"),new Tt(204,!1);const e=function fS(t){const n=t&&(t[yf]||t[x1]);if(n){const e=function hS(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${e}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${e}" class.`),n}return null}(t);return null!==e?()=>e.factory(t):()=>new t}(t);throw new Tt(204,!1)}function Gb(t,n,e){let i;if(Sc(t)){const r=nn(t);return al(r)||Xm(r)}if(qb(t))i=()=>nn(t.useValue);else if(function eA(t){return!(!t||!t.useFactory)}(t))i=()=>t.useFactory(...nm(t.deps||[]));else if(function JD(t){return!(!t||!t.useExisting)}(t))i=()=>tn(nn(t.useExisting));else{const r=nn(t&&(t.useClass||t.provide));if(!function nA(t){return!!t.deps}(t))return al(r)||Xm(r);i=()=>new r(...nm(t.deps))}return i}function Ic(t,n,e=!1){return{factory:t,value:n,multi:e?[]:void 0}}function qb(t){return null!==t&&"object"==typeof t&&Sk in t}function Sc(t){return"function"==typeof t}let Gr=(()=>{class t{static create(e,i){var r;if(Array.isArray(e))return Hb({name:""},i,e,"");{const s=null!==(r=e.name)&&void 0!==r?r:"";return Hb({name:s},e.parent,e.providers,s)}}}return t.THROW_IF_NOT_FOUND=Bu,t.NULL=new jb,t.\u0275prov=Zt({token:t,providedIn:"any",factory:()=>tn(Km)}),t.__NG_ELEMENT_ID__=-1,t})();function fA(t,n){Af(fm(t)[1],zi())}function Vn(t){let n=function ry(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),e=!0;const i=[t];for(;n;){let r;if(qs(t))r=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Tt(903,"");r=n.\u0275dir}if(r){if(e){i.push(r);const o=t;o.inputs=e_(t.inputs),o.declaredInputs=e_(t.declaredInputs),o.outputs=e_(t.outputs);const d=r.hostBindings;d&&mA(t,d);const $=r.viewQuery,I=r.contentQueries;if($&&pA(t,$),I&&gA(t,I),nc(t.inputs,r.inputs),nc(t.declaredInputs,r.declaredInputs),nc(t.outputs,r.outputs),qs(r)&&r.data.animation){const Q=t.data;Q.animation=(Q.animation||[]).concat(r.data.animation)}}const s=r.features;if(s)for(let o=0;o<s.length;o++){const d=s[o];d&&d.ngInherit&&d(t),d===Vn&&(e=!1)}}n=Object.getPrototypeOf(n)}!function hA(t){let n=0,e=null;for(let i=t.length-1;i>=0;i--){const r=t[i];r.hostVars=n+=r.hostVars,r.hostAttrs=Rf(r.hostAttrs,e=Rf(e,r.hostAttrs))}}(i)}function e_(t){return t===sc?{}:t===Qn?[]:t}function pA(t,n){const e=t.viewQuery;t.viewQuery=e?(i,r)=>{n(i,r),e(i,r)}:n}function gA(t,n){const e=t.contentQueries;t.contentQueries=e?(i,r,s)=>{n(i,r,s),e(i,r,s)}:n}function mA(t,n){const e=t.hostBindings;t.hostBindings=e?(i,r)=>{n(i,r),e(i,r)}:n}let oh=null;function kc(){if(!oh){const t=Wn.Symbol;if(t&&t.iterator)oh=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let e=0;e<n.length;++e){const i=n[e];"entries"!==i&&"size"!==i&&Map.prototype[i]===Map.prototype.entries&&(oh=i)}}}return oh}function Qu(t){return!!t_(t)&&(Array.isArray(t)||!(t instanceof Map)&&kc()in t)}function t_(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function _o(t,n,e){return t[n]=e}function Ju(t,n){return t[n]}function _r(t,n,e){return!Object.is(t[n],e)&&(t[n]=e,!0)}function ul(t,n,e,i){const r=_r(t,n,e);return _r(t,n+1,i)||r}function ah(t,n,e,i,r){const s=ul(t,n,e,i);return _r(t,n+2,r)||s}function Is(t,n,e,i,r,s){const o=ul(t,n,e,i);return ul(t,n+2,r,s)||o}function Rt(t,n,e,i){const r=ft();return _r(r,dc(),n)&&(Dn(),mo(Ci(),r,t,n,e,i)),Rt}function Dc(t,n,e,i){return _r(t,dc(),e)?n+Ut(e)+i:on}function Ac(t,n,e,i,r,s){const d=ul(t,function Go(){return sn.lFrame.bindingIndex}(),e,r);return qo(2),d?n+Ut(e)+i+Ut(r)+s:on}function n_(t,n,e,i,r,s){const o=ft(),d=Dc(o,n,e,i);return d!==on&&mo(Ci(),o,t,d,r,s),n_}function xe(t,n,e,i,r,s,o,d){const $=ft(),I=Dn(),Q=t+20,fe=I.firstCreatePass?function xA(t,n,e,i,r,s,o,d,$){const I=n.consts,Q=wc(n,t,4,o||null,_a(I,d));jm(n,e,Q,_a(I,$)),Af(n,Q);const fe=Q.tViews=ih(2,Q,i,r,s,n.directiveRegistry,n.pipeRegistry,null,n.schemas,I);return null!==n.queries&&(n.queries.template(n,Q),fe.queries=n.queries.embeddedTView(Q)),Q}(Q,I,$,n,e,i,r,s,o):I.data[Q];uo(fe,!1);const _e=$[11].createComment("");Qf(I,$,_e,fe),mr(_e,$),rh($,$[Q]=Nb(_e,$,_e,fe)),If(fe)&&Lm(I,$,fe),null!=o&&zm($,fe,d)}function Wt(t){return uc(function GS(){return sn.lFrame.contextLView}(),20+t)}function Oe(t,n=ln.Default){const e=ft();return null===e?tn(t,n):nv(zi(),e,nn(t),n)}function re(t,n,e){const i=ft();return _r(i,dc(),n)&&us(Dn(),Ci(),i,t,n,i[11],e,!1),re}function a_(t,n,e,i,r){const o=r?"class":"style";zb(t,e,n.inputs[o],o,i)}function X(t,n,e,i){const r=ft(),s=Dn(),o=20+t,d=r[11],$=r[o]=bm(d,n,function nk(){return sn.lFrame.currentNamespace}()),I=s.firstCreatePass?function GA(t,n,e,i,r,s,o){const d=n.consts,I=wc(n,t,2,r,_a(d,s));return jm(n,e,I,_a(d,o)),null!==I.attrs&&sh(I,I.attrs,!1),null!==I.mergedAttrs&&sh(I,I.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,I),I}(o,s,r,0,n,e,i):s.data[o];uo(I,!0);const Q=I.mergedAttrs;null!==Q&&Ff(d,$,Q);const fe=I.classes;null!==fe&&Tm(d,$,fe);const _e=I.styles;return null!==_e&&ib(d,$,_e),64!=(64&I.flags)&&Qf(s,r,$,I),0===function zS(){return sn.lFrame.elementDepthCount}()&&mr($,r),function jS(){sn.lFrame.elementDepthCount++}(),If(I)&&(Lm(s,r,I),Cb(s,I,r)),null!==i&&zm(r,I),X}function te(){let t=zi();Bg()?Lg():(t=t.parent,uo(t,!1));const n=t;!function US(){sn.lFrame.elementDepthCount--}();const e=Dn();return e.firstCreatePass&&(Af(e,t),Sg(t)&&e.queries.elementEnd(t)),null!=n.classesWithoutHost&&function ak(t){return 0!=(16&t.flags)}(n)&&a_(e,n,ft(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function lk(t){return 0!=(32&t.flags)}(n)&&a_(e,n,ft(),n.stylesWithoutHost,!1),te}function nt(t,n,e,i){return X(t,n,e,i),te(),nt}function Ge(t,n,e){const i=ft(),r=Dn(),s=t+20,o=r.firstCreatePass?function qA(t,n,e,i,r){const s=n.consts,o=_a(s,i),d=wc(n,t,8,"ng-container",o);return null!==o&&sh(d,o,!0),jm(n,e,d,_a(s,r)),null!==n.queries&&n.queries.elementStart(n,d),d}(s,r,i,n,e):r.data[s];uo(o,!0);const d=i[s]=i[11].createComment("");return Qf(r,i,d,o),mr(d,i),If(o)&&(Lm(r,i,o),Cb(r,o,i)),null!=e&&zm(i,o),Ge}function qe(){let t=zi();const n=Dn();return Bg()?Lg():(t=t.parent,uo(t,!1)),n.firstCreatePass&&(Af(n,t),Sg(t)&&n.queries.elementEnd(t)),qe}function $n(t,n,e){return Ge(t,n,e),qe(),$n}function Ye(){return ft()}function ch(t){return!!t&&"function"==typeof t.then}const wy=function xy(t){return!!t&&"function"==typeof t.subscribe};function Ie(t,n,e,i){const r=ft(),s=Dn(),o=zi();return function Ty(t,n,e,i,r,s,o,d){const $=If(i),Q=t.firstCreatePass&&Ob(t),fe=n[8],_e=Rb(n);let Ce=!0;if(3&i.type||d){const Le=Es(i,n),Be=d?d(Le):Le,Ae=_e.length,je=d?Ue=>d(Mi(Ue[i.index])):i.index;if(yi(e)){let Ue=null;if(!d&&$&&(Ue=function WA(t,n,e,i){const r=t.cleanup;if(null!=r)for(let s=0;s<r.length-1;s+=2){const o=r[s];if(o===e&&r[s+1]===i){const d=n[7],$=r[s+2];return d.length>$?d[$]:null}"string"==typeof o&&(s+=2)}return null}(t,n,r,i.index)),null!==Ue)(Ue.__ngLastListenerFn__||Ue).__ngNextListenerFn__=s,Ue.__ngLastListenerFn__=s,Ce=!1;else{s=l_(i,n,fe,s,!1);const at=e.listen(Be,r,s);_e.push(s,at),Q&&Q.push(r,je,Ae,Ae+1)}}else s=l_(i,n,fe,s,!0),Be.addEventListener(r,s,o),_e.push(s),Q&&Q.push(r,je,Ae,o)}else s=l_(i,n,fe,s,!1);const Ee=i.outputs;let Re;if(Ce&&null!==Ee&&(Re=Ee[r])){const Le=Re.length;if(Le)for(let Be=0;Be<Le;Be+=2){const lt=n[Re[Be]][Re[Be+1]].subscribe(s),tt=_e.length;_e.push(s,lt),Q&&Q.push(r,i.index,tt,-(tt+1))}}}(s,r,r[11],o,t,n,!!e,i),Ie}function Iy(t,n,e,i){try{return!1!==e(i)}catch(r){return Lb(t,r),!1}}function l_(t,n,e,i,r){return function s(o){if(o===Function)return i;const d=2&t.flags?os(t.index,n):n;0==(32&n[2])&&Vm(d);let $=Iy(n,0,i,o),I=s.__ngNextListenerFn__;for(;I;)$=Iy(n,0,I,o)&&$,I=I.__ngNextListenerFn__;return r&&!1===$&&(o.preventDefault(),o.returnValue=!1),$}}function ge(t=1){return function ZS(t){return(sn.lFrame.contextLView=function XS(t,n){for(;t>0;)n=n[15],t--;return n}(t,sn.lFrame.contextLView))[8]}(t)}function KA(t,n){let e=null;const i=function iD(t){const n=t.attrs;if(null!=n){const e=n.indexOf(5);if(0==(1&e))return n[e+1]}return null}(t);for(let r=0;r<n.length;r++){const s=n[r];if("*"!==s){if(null===i?ab(t,s,!0):oD(i,s))return r}else e=r}return e}function c_(t){const n=ft()[16][6];if(!n.projection){const i=n.projection=Ou(t?t.length:1,null),r=i.slice();let s=n.child;for(;null!==s;){const o=t?KA(s,t):0;null!==o&&(r[o]?r[o].projectionNext=s:i[o]=s,r[o]=s),s=s.next}}}function u_(t,n=0,e){const i=ft(),r=Dn(),s=wc(r,20+t,16,null,e||null);null===s.projection&&(s.projection=n),Lg(),64!=(64&s.flags)&&function ZM(t,n,e){nb(n[11],0,n,e,qv(t,e,n),Zv(e.parent||n[6],e,n))}(r,i,s)}function it(t,n,e){return sr(t,"",n,"",e),it}function sr(t,n,e,i,r){const s=ft(),o=Dc(s,n,e,i);return o!==on&&us(Dn(),Ci(),s,t,o,s[11],r,!1),sr}function Ry(t,n,e,i,r){const s=t[e+1],o=null===n;let d=i?Ys(s):Wo(s),$=!1;for(;0!==d&&(!1===$||o);){const Q=t[d+1];XA(t[d],n)&&($=!0,t[d+1]=i?km(Q):Im(Q)),d=i?Ys(Q):Wo(Q)}$&&(t[e+1]=i?Im(s):km(s))}function XA(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&vc(t,n)>=0}const Hi={textEnd:0,key:0,keyEnd:0,value:0,valueEnd:0};function Oy(t){return t.substring(Hi.key,Hi.keyEnd)}function QA(t){return t.substring(Hi.value,Hi.valueEnd)}function By(t,n){const e=Hi.textEnd;return e===n?-1:(n=Hi.keyEnd=function tP(t,n,e){for(;n<e&&t.charCodeAt(n)>32;)n++;return n}(t,Hi.key=n,e),zc(t,n,e))}function Ly(t,n){const e=Hi.textEnd;let i=Hi.key=zc(t,n,e);return e===i?-1:(i=Hi.keyEnd=function nP(t,n,e){let i;for(;n<e&&(45===(i=t.charCodeAt(n))||95===i||(-33&i)>=65&&(-33&i)<=90||i>=48&&i<=57);)n++;return n}(t,i,e),i=jy(t,i,e),i=Hi.value=zc(t,i,e),i=Hi.valueEnd=function iP(t,n,e){let i=-1,r=-1,s=-1,o=n,d=o;for(;o<e;){const $=t.charCodeAt(o++);if(59===$)return d;34===$||39===$?d=o=Uy(t,$,o,e):n===o-4&&85===s&&82===r&&76===i&&40===$?d=o=Uy(t,41,o,e):$>32&&(d=o),s=r,r=i,i=-33&$}return d}(t,i,e),jy(t,i,e))}function zy(t){Hi.key=0,Hi.keyEnd=0,Hi.value=0,Hi.valueEnd=0,Hi.textEnd=t.length}function zc(t,n,e){for(;n<e&&t.charCodeAt(n)<=32;)n++;return n}function jy(t,n,e,i){return(n=zc(t,n,e))<e&&n++,n}function Uy(t,n,e,i){let r=-1,s=e;for(;s<i;){const o=t.charCodeAt(s++);if(o==n&&92!==r)return s;r=92==o&&92===r?0:o}throw new Error}function Je(t,n,e){return Xs(t,n,e,!1),Je}function uh(t,n){return Xs(t,n,null,!0),uh}function Dr(t){Qs(Gy,rP,t,!1)}function rP(t,n){for(let e=function eP(t){return zy(t),Ly(t,zc(t,0,Hi.textEnd))}(n);e>=0;e=Ly(n,e))Gy(t,Oy(n),QA(n))}function ed(t){Qs(as,$o,t,!0)}function $o(t,n){for(let e=function JA(t){return zy(t),By(t,zc(t,0,Hi.textEnd))}(n);e>=0;e=By(n,e))as(t,Oy(n),!0)}function Xs(t,n,e,i){const r=ft(),s=Dn(),o=qo(2);s.firstUpdatePass&&Vy(s,t,o,i),n!==on&&_r(r,o,n)&&qy(s,s.data[kr()],r,r[11],t,r[o+1]=function dP(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=Rn(ls(t)))),t}(n,e),i,o)}function Qs(t,n,e,i){const r=Dn(),s=qo(2);r.firstUpdatePass&&Vy(r,null,s,i);const o=ft();if(e!==on&&_r(o,s,e)){const d=r.data[kr()];if(Ky(d,i)&&!Hy(r,s)){let $=i?d.classesWithoutHost:d.stylesWithoutHost;null!==$&&(e=fa($,e||"")),a_(r,d,o,e,i)}else!function uP(t,n,e,i,r,s,o,d){r===on&&(r=Qn);let $=0,I=0,Q=0<r.length?r[0]:null,fe=0<s.length?s[0]:null;for(;null!==Q||null!==fe;){const _e=$<r.length?r[$+1]:void 0,Ce=I<s.length?s[I+1]:void 0;let Re,Ee=null;Q===fe?($+=2,I+=2,_e!==Ce&&(Ee=fe,Re=Ce)):null===fe||null!==Q&&Q<fe?($+=2,Ee=Q):(I+=2,Ee=fe,Re=Ce),null!==Ee&&qy(t,n,e,i,Ee,Re,o,d),Q=$<r.length?r[$]:null,fe=I<s.length?s[I]:null}}(r,d,o,o[11],o[s+1],o[s+1]=function cP(t,n,e){if(null==e||""===e)return Qn;const i=[],r=ls(e);if(Array.isArray(r))for(let s=0;s<r.length;s++)t(i,r[s],!0);else if("object"==typeof r)for(const s in r)r.hasOwnProperty(s)&&t(i,s,r[s]);else"string"==typeof r&&n(i,r);return i}(t,n,e),i,s)}}function Hy(t,n){return n>=t.expandoStartIndex}function Vy(t,n,e,i){const r=t.data;if(null===r[e+1]){const s=r[kr()],o=Hy(t,e);Ky(s,i)&&null===n&&!o&&(n=!1),n=function sP(t,n,e,i){const r=function jg(t){const n=sn.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let s=i?n.residualClasses:n.residualStyles;if(null===r)0===(i?n.classBindings:n.styleBindings)&&(e=td(e=d_(null,t,n,e,i),n.attrs,i),s=null);else{const o=n.directiveStylingLast;if(-1===o||t[o]!==r)if(e=d_(r,t,n,e,i),null===s){let $=function oP(t,n,e){const i=e?n.classBindings:n.styleBindings;if(0!==Wo(i))return t[Ys(i)]}(t,n,i);void 0!==$&&Array.isArray($)&&($=d_(null,t,n,$[1],i),$=td($,n.attrs,i),function aP(t,n,e,i){t[Ys(e?n.classBindings:n.styleBindings)]=i}(t,n,i,$))}else s=function lP(t,n,e){let i;const r=n.directiveEnd;for(let s=1+n.directiveStylingLast;s<r;s++)i=td(i,t[s].hostAttrs,e);return td(i,n.attrs,e)}(t,n,i)}return void 0!==s&&(i?n.residualClasses=s:n.residualStyles=s),e}(r,s,n,i),function YA(t,n,e,i,r,s){let o=s?n.classBindings:n.styleBindings,d=Ys(o),$=Wo(o);t[i]=e;let Q,I=!1;if(Array.isArray(e)){const fe=e;Q=fe[1],(null===Q||vc(fe,Q)>0)&&(I=!0)}else Q=e;if(r)if(0!==$){const _e=Ys(t[d+1]);t[i+1]=eh(_e,d),0!==_e&&(t[_e+1]=Sm(t[_e+1],i)),t[d+1]=function uD(t,n){return 131071&t|n<<17}(t[d+1],i)}else t[i+1]=eh(d,0),0!==d&&(t[d+1]=Sm(t[d+1],i)),d=i;else t[i+1]=eh($,0),0===d?d=i:t[$+1]=Sm(t[$+1],i),$=i;I&&(t[i+1]=Im(t[i+1])),Ry(t,Q,i,!0),Ry(t,Q,i,!1),function ZA(t,n,e,i,r){const s=r?t.residualClasses:t.residualStyles;null!=s&&"string"==typeof n&&vc(s,n)>=0&&(e[i+1]=km(e[i+1]))}(n,Q,t,i,s),o=eh(d,$),s?n.classBindings=o:n.styleBindings=o}(r,s,n,e,o,i)}}function d_(t,n,e,i,r){let s=null;const o=e.directiveEnd;let d=e.directiveStylingLast;for(-1===d?d=e.directiveStart:d++;d<o&&(s=n[d],i=td(i,s.hostAttrs,r),s!==t);)d++;return null!==t&&(e.directiveStylingLast=d),i}function td(t,n,e){const i=e?1:2;let r=-1;if(null!==n)for(let s=0;s<n.length;s++){const o=n[s];"number"==typeof o?r=o:r===i&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),as(t,o,!!e||n[++s]))}return void 0===t?null:t}function Gy(t,n,e){as(t,n,ls(e))}function qy(t,n,e,i,r,s,o,d){if(!(3&n.type))return;const $=t.data,I=$[d+1];dh(function fb(t){return 1==(1&t)}(I)?Wy($,n,e,r,Wo(I),o):void 0)||(dh(s)||function db(t){return 2==(2&t)}(I)&&(s=Wy($,null,e,r,d,o)),function QM(t,n,e,i,r){const s=yi(t);if(n)r?s?t.addClass(e,i):e.classList.add(i):s?t.removeClass(e,i):e.classList.remove(i);else{let o=-1===i.indexOf("-")?void 0:cs.DashCase;if(null==r)s?t.removeStyle(e,i,o):e.style.removeProperty(i);else{const d="string"==typeof r&&r.endsWith("!important");d&&(r=r.slice(0,-10),o|=cs.Important),s?t.setStyle(e,i,r,o):e.style.setProperty(i,r,d?"important":"")}}}(i,o,Sf(kr(),e),r,s))}function Wy(t,n,e,i,r,s){const o=null===n;let d;for(;r>0;){const $=t[r],I=Array.isArray($),Q=I?$[1]:$,fe=null===Q;let _e=e[r+1];_e===on&&(_e=fe?Qn:void 0);let Ce=fe?Jg(_e,i):Q===i?_e:void 0;if(I&&!dh(Ce)&&(Ce=Jg($,i)),dh(Ce)&&(d=Ce,o))return d;const Ee=t[r+1];r=o?Ys(Ee):Wo(Ee)}if(null!==n){let $=s?n.residualClasses:n.residualStyles;null!=$&&(d=Jg($,i))}return d}function dh(t){return void 0!==t}function Ky(t,n){return 0!=(t.flags&(n?16:32))}function be(t,n=""){const e=ft(),i=Dn(),r=t+20,s=i.firstCreatePass?wc(i,r,1,n,null):i.data[r],o=e[r]=function vm(t,n){return yi(t)?t.createText(n):t.createTextNode(n)}(e[11],n);Qf(i,e,o,s),uo(s,!1)}function Ze(t){return An("",t,""),Ze}function An(t,n,e){const i=ft(),r=Dc(i,t,n,e);return r!==on&&Ko(i,kr(),r),An}function Ca(t,n,e,i,r){const s=ft(),o=Ac(s,t,n,e,i,r);return o!==on&&Ko(s,kr(),o),Ca}const dl=void 0;var DP=["en",[["a","p"],["AM","PM"],dl],[["AM","PM"],dl,dl],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],dl,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],dl,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",dl,"{1} 'at' {0}",dl],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function MP(t){const e=Math.floor(Math.abs(t)),i=t.toString().replace(/^[^.]*\.?/,"").length;return 1===e&&0===i?1:5}];let jc={};function Ar(t){const n=function AP(t){return t.toLowerCase().replace(/_/g,"-")}(t);let e=pC(n);if(e)return e;const i=n.split("-")[0];if(e=pC(i),e)return e;if("en"===i)return DP;throw new Error(`Missing locale data for the locale "${t}".`)}function pC(t){return t in jc||(jc[t]=Wn.ng&&Wn.ng.common&&Wn.ng.common.locales&&Wn.ng.common.locales[t]),jc[t]}var Et=(()=>((Et=Et||{})[Et.LocaleId=0]="LocaleId",Et[Et.DayPeriodsFormat=1]="DayPeriodsFormat",Et[Et.DayPeriodsStandalone=2]="DayPeriodsStandalone",Et[Et.DaysFormat=3]="DaysFormat",Et[Et.DaysStandalone=4]="DaysStandalone",Et[Et.MonthsFormat=5]="MonthsFormat",Et[Et.MonthsStandalone=6]="MonthsStandalone",Et[Et.Eras=7]="Eras",Et[Et.FirstDayOfWeek=8]="FirstDayOfWeek",Et[Et.WeekendRange=9]="WeekendRange",Et[Et.DateFormat=10]="DateFormat",Et[Et.TimeFormat=11]="TimeFormat",Et[Et.DateTimeFormat=12]="DateTimeFormat",Et[Et.NumberSymbols=13]="NumberSymbols",Et[Et.NumberFormats=14]="NumberFormats",Et[Et.CurrencyCode=15]="CurrencyCode",Et[Et.CurrencySymbol=16]="CurrencySymbol",Et[Et.CurrencyName=17]="CurrencyName",Et[Et.Currencies=18]="Currencies",Et[Et.Directionality=19]="Directionality",Et[Et.PluralCase=20]="PluralCase",Et[Et.ExtraData=21]="ExtraData",Et))();const fh="en-US";let gC=fh;function p_(t,n,e,i,r){if(t=nn(t),Array.isArray(t))for(let s=0;s<t.length;s++)p_(t[s],n,e,i,r);else{const s=Dn(),o=ft();let d=Sc(t)?t:nn(t.provide),$=Gb(t);const I=zi(),Q=1048575&I.providerIndexes,fe=I.directiveStart,_e=I.providerIndexes>>20;if(Sc(t)||!t.multi){const Ce=new Du($,r,Oe),Ee=m_(d,n,r?Q:Q+_e,fe);-1===Ee?(Lf(Pu(I,o),s,d),g_(s,t,n.length),n.push(d),I.directiveStart++,I.directiveEnd++,r&&(I.providerIndexes+=1048576),e.push(Ce),o.push(Ce)):(e[Ee]=Ce,o[Ee]=Ce)}else{const Ce=m_(d,n,Q+_e,fe),Ee=m_(d,n,Q,Q+_e),Re=Ce>=0&&e[Ce],Le=Ee>=0&&e[Ee];if(r&&!Le||!r&&!Re){Lf(Pu(I,o),s,d);const Be=function M4(t,n,e,i,r){const s=new Du(t,e,Oe);return s.multi=[],s.index=n,s.componentProviders=0,LC(s,r,i&&!e),s}(r?k4:S4,e.length,r,i,$);!r&&Le&&(e[Ee].providerFactory=Be),g_(s,t,n.length,0),n.push(d),I.directiveStart++,I.directiveEnd++,r&&(I.providerIndexes+=1048576),e.push(Be),o.push(Be)}else g_(s,t,Ce>-1?Ce:Ee,LC(e[r?Ee:Ce],$,!r&&i));!r&&i&&Le&&e[Ee].componentProviders++}}}function g_(t,n,e,i){const r=Sc(n),s=function tA(t){return!!t.useClass}(n);if(r||s){const $=(s?nn(n.useClass):n).prototype.ngOnDestroy;if($){const I=t.destroyHooks||(t.destroyHooks=[]);if(!r&&n.multi){const Q=I.indexOf(e);-1===Q?I.push(e,[i,$]):I[Q+1].push(i,$)}else I.push(e,$)}}}function LC(t,n,e){return e&&t.componentProviders++,t.multi.push(n)-1}function m_(t,n,e,i){for(let r=e;r<i;r++)if(n[r]===t)return r;return-1}function S4(t,n,e,i){return __(this.multi,[])}function k4(t,n,e,i){const r=this.multi;let s;if(this.providerFactory){const o=this.providerFactory.componentProviders,d=Nu(e,e[1],this.providerFactory.index,i);s=d.slice(0,o),__(r,s);for(let $=o;$<d.length;$++)s.push(d[$])}else s=[],__(r,s);return s}function __(t,n){for(let e=0;e<t.length;e++)n.push((0,t[e])());return n}function ii(t,n=[]){return e=>{e.providersResolver=(i,r)=>function I4(t,n,e){const i=Dn();if(i.firstCreatePass){const r=qs(t);p_(e,i.data,i.blueprint,r,!0),p_(n,i.data,i.blueprint,r,!1)}}(i,r?r(t):t,n)}}class zC{}class P4{resolveComponentFactory(n){throw function A4(t){const n=Error(`No component factory found for ${Rn(t)}. Did you add it to @NgModule.entryComponents?`);return n.ngComponent=t,n}(n)}}let _h=(()=>{class t{}return t.NULL=new P4,t})();function N4(){return Hc(zi(),ft())}function Hc(t,n){return new pi(Es(t,n))}let pi=(()=>{class t{constructor(e){this.nativeElement=e}}return t.__NG_ELEMENT_ID__=N4,t})();function F4(t){return t instanceof pi?t.nativeElement:t}class od{}let fl=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>function O4(){const t=ft(),e=os(zi().index,t);return function R4(t){return t[11]}(co(e)?e:t)}(),t})(),B4=(()=>{class t{}return t.\u0275prov=Zt({token:t,providedIn:"root",factory:()=>null}),t})();class $h{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const L4=new $h("13.3.11"),$_={};function vh(t,n,e,i,r=!1){for(;null!==e;){const s=n[e.index];if(null!==s&&i.push(Mi(s)),Gs(s))for(let d=10;d<s.length;d++){const $=s[d],I=$[1].firstChild;null!==I&&vh($[1],$,I,i)}const o=e.type;if(8&o)vh(t,n,e.child,i);else if(32&o){const d=mm(e,n);let $;for(;$=d();)i.push($)}else if(16&o){const d=eb(n,e);if(Array.isArray(d))i.push(...d);else{const $=Wu(n[16]);vh($[1],$,d,i,!0)}}e=r?e.projectionNext:e.next}return i}class ad{constructor(n,e){this._lView=n,this._cdRefInjectingView=e,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,e=n[1];return vh(e,n,e.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(Gs(n)){const e=n[8],i=e?e.indexOf(this):-1;i>-1&&(ym(n,i),jf(e,i))}this._attachedToViewContainer=!1}Gv(this._lView[1],this._lView)}onDestroy(n){Tb(this._lView[1],this._lView,null,n)}markForCheck(){Vm(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){!function qm(t,n,e){const i=n[10];i.begin&&i.begin();try{Tc(t,n,t.template,e)}catch(r){throw Lb(n,r),r}finally{i.end&&i.end()}}(this._lView[1],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Tt(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function UM(t,n){Ku(t,n,n[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Tt(902,"");this._appRef=n}}class z4 extends ad{constructor(n){super(n),this._view=n}detectChanges(){Fb(this._view)}checkNoChanges(){}get context(){return null}}class UC extends _h{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const e=hr(n);return new v_(e,this.ngModule)}}function HC(t){const n=[];for(let e in t)t.hasOwnProperty(e)&&n.push({propName:t[e],templateName:e});return n}class v_ extends zC{constructor(n,e){super(),this.componentDef=n,this.ngModule=e,this.componentType=n.type,this.selector=function lD(t){return t.map(aD).join(",")}(n.selectors),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!e}get inputs(){return HC(this.componentDef.inputs)}get outputs(){return HC(this.componentDef.outputs)}create(n,e,i,r){const s=(r=r||this.ngModule)?function U4(t,n){return{get:(e,i,r)=>{const s=t.get(e,$_,r);return s!==$_||i===$_?s:n.get(e,i,r)}}}(n,r.injector):n,o=s.get(od,N1),d=s.get(B4,null),$=o.createRenderer(null,this.componentDef),I=this.componentDef.selectors[0][0]||"div",Q=i?function Eb(t,n,e){if(yi(t))return t.selectRootElement(n,e===Hs.ShadowDom);let i="string"==typeof n?t.querySelector(n):n;return i.textContent="",i}($,i,this.componentDef.encapsulation):bm(o.createRenderer(null,this.componentDef),I,function j4(t){const n=t.toLowerCase();return"svg"===n?"svg":"math"===n?"math":null}(I)),fe=this.componentDef.onPush?576:528,_e=function iy(t,n){return{components:[],scheduler:t||FM,clean:qD,playerHandler:n||null,flags:0}}(),Ce=ih(0,null,null,1,0,null,null,null,null,null),Ee=Yu(null,Ce,_e,fe,null,null,o,$,d,s);let Re,Le;Mf(Ee);try{const Be=function ty(t,n,e,i,r,s){const o=e[1];e[20]=t;const $=wc(o,20,2,"#host",null),I=$.mergedAttrs=n.hostAttrs;null!==I&&(sh($,I,!0),null!==t&&(Ff(r,t,I),null!==$.classes&&Tm(r,t,$.classes),null!==$.styles&&ib(r,t,$.styles)));const Q=i.createRenderer(t,n),fe=Yu(e,xb(n),null,n.onPush?64:16,e[20],$,i,Q,s||null,null);return o.firstCreatePass&&(Lf(Pu($,e),o,n.type),Db(o,$),Ab($,e.length,1)),rh(e,fe),e[20]=fe}(Q,this.componentDef,Ee,o,$);if(Q)if(i)Ff($,Q,["ng-version",L4.full]);else{const{attrs:Ae,classes:je}=function cD(t){const n=[],e=[];let i=1,r=2;for(;i<t.length;){let s=t[i];if("string"==typeof s)2===r?""!==s&&n.push(s,t[++i]):8===r&&e.push(s);else{if(!Ks(r))break;r=s}i++}return{attrs:n,classes:e}}(this.componentDef.selectors[0]);Ae&&Ff($,Q,Ae),je&&je.length>0&&Tm($,Q,je.join(" "))}if(Le=Fg(Ce,20),void 0!==e){const Ae=Le.projection=[];for(let je=0;je<this.ngContentSelectors.length;je++){const Ue=e[je];Ae.push(null!=Ue?Array.from(Ue):null)}}Re=function ny(t,n,e,i,r){const s=e[1],o=function MD(t,n,e){const i=zi();t.firstCreatePass&&(e.providersResolver&&e.providersResolver(e),Pb(t,i,n,Ec(t,n,1,null),e));const r=Nu(n,t,i.directiveStart,i);mr(r,n);const s=Es(i,n);return s&&mr(s,n),r}(s,e,n);if(i.components.push(o),t[8]=o,r&&r.forEach($=>$(o,n)),n.contentQueries){const $=zi();n.contentQueries(1,o,$.directiveStart)}const d=zi();return!s.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||($a(d.index),kb(e[1],d,0,d.directiveStart,d.directiveEnd,n),Mb(n,o)),o}(Be,this.componentDef,Ee,_e,[fA]),Zu(Ce,Ee,null)}finally{Df()}return new V4(this.componentType,Re,Hc(Le,Ee),Ee,Le)}}class V4 extends class D4{}{constructor(n,e,i,r,s){super(),this.location=i,this._rootLView=r,this._tNode=s,this.instance=e,this.hostView=this.changeDetectorRef=new z4(r),this.componentType=n}get injector(){return new pc(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}class Vc{}const Gc=new Map;class qC extends Vc{constructor(n,e){super(),this._parent=e,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new UC(this);const i=Cs(n);this._bootstrapComponents=go(i.bootstrap),this._r3Injector=Vb(n,e,[{provide:Vc,useValue:this},{provide:_h,useValue:this.componentFactoryResolver}],Rn(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,e=Gr.THROW_IF_NOT_FOUND,i=ln.Default){return n===Gr||n===Vc||n===Km?this:this._r3Injector.get(n,e,i)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(e=>e()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class b_ extends class q4{}{constructor(n){super(),this.moduleType=n,null!==Cs(n)&&function W4(t){const n=new Set;!function e(i){const r=Cs(i,!0),s=r.id;null!==s&&(function VC(t,n,e){if(n&&n!==e)throw new Error(`Duplicate module registered for ${t} - ${Rn(n)} vs ${Rn(n.name)}`)}(s,Gc.get(s),i),Gc.set(s,i));const o=go(r.imports);for(const d of o)n.has(d)||(n.add(d),e(d))}(t)}(n)}create(n){return new qC(this.moduleType,n)}}function Yo(t,n,e){const i=Sr()+t,r=ft();return r[i]===on?_o(r,i,e?n.call(e):n()):Ju(r,i)}function ct(t,n,e,i){return function WC(t,n,e,i,r,s){const o=n+e;return _r(t,o,r)?_o(t,o+1,s?i.call(s,r):i(r)):ld(t,o+1)}(ft(),Sr(),t,n,e,i)}function cn(t,n,e,i,r){return KC(ft(),Sr(),t,n,e,i,r)}function qr(t,n,e,i,r,s){return function YC(t,n,e,i,r,s,o,d){const $=n+e;return ah(t,$,r,s,o)?_o(t,$+3,d?i.call(d,r,s,o):i(r,s,o)):ld(t,$+3)}(ft(),Sr(),t,n,e,i,r,s)}function Js(t,n,e,i,r,s,o){return function ZC(t,n,e,i,r,s,o,d,$){const I=n+e;return Is(t,I,r,s,o,d)?_o(t,I+4,$?i.call($,r,s,o,d):i(r,s,o,d)):ld(t,I+4)}(ft(),Sr(),t,n,e,i,r,s,o)}function y_(t,n,e,i,r,s,o,d,$){const I=Sr()+t,Q=ft(),fe=Is(Q,I,e,i,r,s);return ul(Q,I+4,o,d)||fe?_o(Q,I+6,$?n.call($,e,i,r,s,o,d):n(e,i,r,s,o,d)):Ju(Q,I+6)}function qc(t,n,e,i,r,s,o,d,$,I){const Q=Sr()+t,fe=ft();let _e=Is(fe,Q,e,i,r,s);return ah(fe,Q+4,o,d,$)||_e?_o(fe,Q+7,I?n.call(I,e,i,r,s,o,d,$):n(e,i,r,s,o,d,$)):Ju(fe,Q+7)}function vo(t,n,e,i,r,s,o,d,$,I,Q){const fe=Sr()+t,_e=ft(),Ce=Is(_e,fe,e,i,r,s);return Is(_e,fe+4,o,d,$,I)||Ce?_o(_e,fe+8,Q?n.call(Q,e,i,r,s,o,d,$,I):n(e,i,r,s,o,d,$,I)):Ju(_e,fe+8)}function ld(t,n){const e=t[n];return e===on?void 0:e}function KC(t,n,e,i,r,s,o){const d=n+e;return ul(t,d,r,s)?_o(t,d+2,o?i.call(o,r,s):i(r,s)):ld(t,d+2)}function bt(t,n){const e=Dn();let i;const r=t+20;e.firstCreatePass?(i=function Z4(t,n){if(n)for(let e=n.length-1;e>=0;e--){const i=n[e];if(t===i.name)return i}}(n,e.pipeRegistry),e.data[r]=i,i.onDestroy&&(e.destroyHooks||(e.destroyHooks=[])).push(r,i.onDestroy)):i=e.data[r];const s=i.factory||(i.factory=al(i.type)),o=pa(Oe);try{const d=Of(!1),$=s();return Of(d),function wA(t,n,e,i){e>=t.data.length&&(t.data[e]=null,t.blueprint[e]=null),n[e]=i}(e,ft(),r,$),$}finally{pa(o)}}function yt(t,n,e,i){const r=t+20,s=ft(),o=uc(s,r);return function cd(t,n){return t[1].data[n].pure}(s,r)?KC(s,Sr(),n,o.transform,e,i,o):o.transform(e,i)}function C_(t){return n=>{setTimeout(t,void 0,n)}}const vn=class t5 extends le{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,e,i){var r,s,o;let d=n,$=e||(()=>null),I=i;if(n&&"object"==typeof n){const fe=n;d=null===(r=fe.next)||void 0===r?void 0:r.bind(fe),$=null===(s=fe.error)||void 0===s?void 0:s.bind(fe),I=null===(o=fe.complete)||void 0===o?void 0:o.bind(fe)}this.__isAsync&&($=C_($),d&&(d=C_(d)),I&&(I=C_(I)));const Q=super.subscribe({next:d,error:$,complete:I});return n instanceof u&&n.add(Q),Q}};function n5(){return this._results[kc()]()}class x_{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const e=kc(),i=x_.prototype;i[e]||(i[e]=n5)}get changes(){return this._changes||(this._changes=new vn)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,e){return this._results.reduce(n,e)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,e){const i=this;i.dirty=!1;const r=Ts(n);(this._changesDetected=!function _k(t,n,e){if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++){let r=t[i],s=n[i];if(e&&(r=e(r),s=e(s)),s!==r)return!1}return!0}(i._results,r,e))&&(i._results=r,i.length=r.length,i.last=r[this.length-1],i.first=r[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Zo=(()=>{class t{}return t.__NG_ELEMENT_ID__=s5,t})();const i5=Zo,r5=class extends i5{constructor(n,e,i){super(),this._declarationLView=n,this._declarationTContainer=e,this.elementRef=i}createEmbeddedView(n){const e=this._declarationTContainer.tViews,i=Yu(this._declarationLView,e,n,16,null,e.declTNode,null,null,null,null);i[17]=this._declarationLView[this._declarationTContainer.index];const s=this._declarationLView[19];return null!==s&&(i[19]=s.createEmbeddedView(e)),Zu(e,i,n),new ad(i)}};function s5(){return bh(zi(),ft())}function bh(t,n){return 4&t.type?new r5(n,t,Hc(t,n)):null}let Pr=(()=>{class t{}return t.__NG_ELEMENT_ID__=o5,t})();function o5(){return e2(zi(),ft())}const a5=Pr,QC=class extends a5{constructor(n,e,i){super(),this._lContainer=n,this._hostTNode=e,this._hostLView=i}get element(){return Hc(this._hostTNode,this._hostLView)}get injector(){return new pc(this._hostTNode,this._hostLView)}get parentInjector(){const n=Bf(this._hostTNode,this._hostLView);if(X1(n)){const e=hc(n,this._hostLView),i=fc(n);return new pc(e[1].data[i+8],e)}return new pc(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const e=JC(this._lContainer);return null!==e&&e[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,e,i){const r=n.createEmbeddedView(e||{});return this.insert(r,i),r}createComponent(n,e,i,r,s){const o=n&&!function Ru(t){return"function"==typeof t}(n);let d;if(o)d=e;else{const fe=e||{};d=fe.index,i=fe.injector,r=fe.projectableNodes,s=fe.ngModuleRef}const $=o?n:new v_(hr(n)),I=i||this.parentInjector;if(!s&&null==$.ngModule){const _e=(o?I:this.parentInjector).get(Vc,null);_e&&(s=_e)}const Q=$.create(I,r,void 0,s);return this.insert(Q.hostView,d),Q}insert(n,e){const i=n._lView,r=i[1];if(function LS(t){return Gs(t[3])}(i)){const Q=this.indexOf(n);if(-1!==Q)this.detach(Q);else{const fe=i[3],_e=new QC(fe,fe[6],fe[3]);_e.detach(_e.indexOf(n))}}const s=this._adjustIndex(e),o=this._lContainer;!function VM(t,n,e,i){const r=10+i,s=e.length;i>0&&(e[r-1][4]=n),i<s-10?(n[4]=e[r],av(e,10+i,n)):(e.push(n),n[4]=null),n[3]=e;const o=n[17];null!==o&&e!==o&&function GM(t,n){const e=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===e?t[9]=[n]:e.push(n)}(o,n);const d=n[19];null!==d&&d.insertView(t),n[2]|=128}(r,i,o,s);const d=wm(s,o),$=i[11],I=Xf($,o[7]);return null!==I&&function jM(t,n,e,i,r,s){i[0]=r,i[6]=n,Ku(t,i,e,1,r,s)}(r,o[6],$,i,I,d),n.attachToViewContainerRef(),av(w_(o),s,n),n}move(n,e){return this.insert(n,e)}indexOf(n){const e=JC(this._lContainer);return null!==e?e.indexOf(n):-1}remove(n){const e=this._adjustIndex(n,-1),i=ym(this._lContainer,e);i&&(jf(w_(this._lContainer),e),Gv(i[1],i))}detach(n){const e=this._adjustIndex(n,-1),i=ym(this._lContainer,e);return i&&null!=jf(w_(this._lContainer),e)?new ad(i):null}_adjustIndex(n,e=0){return null==n?this.length+e:n}};function JC(t){return t[8]}function w_(t){return t[8]||(t[8]=[])}function e2(t,n){let e;const i=n[t.index];if(Gs(i))e=i;else{let r;if(8&t.type)r=Mi(i);else{const s=n[11];r=s.createComment("");const o=Es(t,n);cl(s,Xf(s,o),r,function YM(t,n){return yi(t)?t.nextSibling(n):n.nextSibling}(s,o),!1)}n[t.index]=e=Nb(i,n,r,t),rh(n,e)}return new QC(e,t,n)}class E_{constructor(n){this.queryList=n,this.matches=null}clone(){return new E_(this.queryList)}setDirty(){this.queryList.setDirty()}}class T_{constructor(n=[]){this.queries=n}createEmbeddedView(n){const e=n.queries;if(null!==e){const i=null!==n.contentQueries?n.contentQueries[0]:e.length,r=[];for(let s=0;s<i;s++){const o=e.getByIndex(s);r.push(this.queries[o.indexInDeclarationView].clone())}return new T_(r)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let e=0;e<this.queries.length;e++)null!==s2(n,e).matches&&this.queries[e].setDirty()}}class t2{constructor(n,e,i=null){this.predicate=n,this.flags=e,this.read=i}}class I_{constructor(n=[]){this.queries=n}elementStart(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].elementStart(n,e)}elementEnd(n){for(let e=0;e<this.queries.length;e++)this.queries[e].elementEnd(n)}embeddedTView(n){let e=null;for(let i=0;i<this.length;i++){const r=null!==e?e.length:0,s=this.getByIndex(i).embeddedTView(n,r);s&&(s.indexInDeclarationView=i,null!==e?e.push(s):e=[s])}return null!==e?new I_(e):null}template(n,e){for(let i=0;i<this.queries.length;i++)this.queries[i].template(n,e)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class S_{constructor(n,e=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=e}elementStart(n,e){this.isApplyingToNode(e)&&this.matchTNode(n,e)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,e){this.elementStart(n,e)}embeddedTView(n,e){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,e),new S_(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const e=this._declarationNodeIndex;let i=n.parent;for(;null!==i&&8&i.type&&i.index!==e;)i=i.parent;return e===(null!==i?i.index:-1)}return this._appliesToNextNode}matchTNode(n,e){const i=this.metadata.predicate;if(Array.isArray(i))for(let r=0;r<i.length;r++){const s=i[r];this.matchTNodeWithReadOption(n,e,u5(e,s)),this.matchTNodeWithReadOption(n,e,zf(e,n,s,!1,!1))}else i===Zo?4&e.type&&this.matchTNodeWithReadOption(n,e,-1):this.matchTNodeWithReadOption(n,e,zf(e,n,i,!1,!1))}matchTNodeWithReadOption(n,e,i){if(null!==i){const r=this.metadata.read;if(null!==r)if(r===pi||r===Pr||r===Zo&&4&e.type)this.addMatch(e.index,-2);else{const s=zf(e,n,r,!1,!1);null!==s&&this.addMatch(e.index,s)}else this.addMatch(e.index,i)}}addMatch(n,e){null===this.matches?this.matches=[n,e]:this.matches.push(n,e)}}function u5(t,n){const e=t.localNames;if(null!==e)for(let i=0;i<e.length;i+=2)if(e[i]===n)return e[i+1];return null}function f5(t,n,e,i){return-1===e?function d5(t,n){return 11&t.type?Hc(t,n):4&t.type?bh(t,n):null}(n,t):-2===e?function h5(t,n,e){return e===pi?Hc(n,t):e===Zo?bh(n,t):e===Pr?e2(n,t):void 0}(t,n,i):Nu(t,t[1],e,n)}function n2(t,n,e,i){const r=n[19].queries[i];if(null===r.matches){const s=t.data,o=e.matches,d=[];for(let $=0;$<o.length;$+=2){const I=o[$];d.push(I<0?null:f5(n,s[I],o[$+1],e.metadata.read))}r.matches=d}return r.matches}function k_(t,n,e,i){const r=t.queries.getByIndex(e),s=r.matches;if(null!==s){const o=n2(t,n,r,e);for(let d=0;d<s.length;d+=2){const $=s[d];if($>0)i.push(o[d/2]);else{const I=s[d+1],Q=n[-$];for(let fe=10;fe<Q.length;fe++){const _e=Q[fe];_e[17]===_e[3]&&k_(_e[1],_e,I,i)}if(null!==Q[9]){const fe=Q[9];for(let _e=0;_e<fe.length;_e++){const Ce=fe[_e];k_(Ce[1],Ce,I,i)}}}}}return i}function un(t){const n=ft(),e=Dn(),i=U1();Ug(i+1);const r=s2(e,i);if(t.dirty&&F1(n)===(2==(2&r.metadata.flags))){if(null===r.matches)t.reset([]);else{const s=r.crossesNgTemplate?k_(e,n,i,[]):n2(e,n,r,i);t.reset(s,F4),t.notifyOnChanges()}return!0}return!1}function dn(t,n,e){const i=Dn();i.firstCreatePass&&(function r2(t,n,e){null===t.queries&&(t.queries=new I_),t.queries.track(new S_(n,e))}(i,new t2(t,n,e),-1),2==(2&n)&&(i.staticViewQueries=!0)),function i2(t,n,e){const i=new x_(4==(4&e));Tb(t,n,i,i.destroy),null===n[19]&&(n[19]=new T_),n[19].queries.push(new E_(i))}(i,ft(),n)}function fn(){return function g5(t,n){return t[19].queries[n].queryList}(ft(),U1())}function s2(t,n){return t.queries.getByIndex(n)}function On(t,n){return bh(t,n)}function xh(...t){}const F_=new In("Application Initializer");let R_=(()=>{class t{constructor(e){this.appInits=e,this.resolve=xh,this.reject=xh,this.initialized=!1,this.done=!1,this.donePromise=new Promise((i,r)=>{this.resolve=i,this.reject=r})}runInitializers(){if(this.initialized)return;const e=[],i=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let r=0;r<this.appInits.length;r++){const s=this.appInits[r]();if(ch(s))e.push(s);else if(wy(s)){const o=new Promise((d,$)=>{s.subscribe({complete:d,error:$})});e.push(o)}}Promise.all(e).then(()=>{i()}).catch(r=>{this.reject(r)}),0===e.length&&i(),this.initialized=!0}}return t.\u0275fac=function(e){return new(e||t)(tn(F_,8))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const dd=new In("AppId",{providedIn:"root",factory:function C2(){return`${O_()}${O_()}${O_()}`}});function O_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const x2=new In("Platform Initializer"),fd=new In("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),P5=new In("appBootstrapListener"),xa=new In("LocaleId",{providedIn:"root",factory:()=>Mk(xa,ln.Optional|ln.SkipSelf)||function N5(){return"undefined"!=typeof $localize&&$localize.locale||fh}()}),B5=(()=>Promise.resolve(0))();function B_(t){"undefined"==typeof Zone?B5.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class bn{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:e=!1,shouldCoalesceRunChangeDetection:i=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new vn(!1),this.onMicrotaskEmpty=new vn(!1),this.onStable=new vn(!1),this.onError=new vn(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const r=this;r._nesting=0,r._outer=r._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(r._inner=r._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(r._inner=r._inner.fork(Zone.longStackTraceZoneSpec)),r.shouldCoalesceEventChangeDetection=!i&&e,r.shouldCoalesceRunChangeDetection=i,r.lastRequestAnimationFrameId=-1,r.nativeRequestAnimationFrame=function L5(){let t=Wn.requestAnimationFrame,n=Wn.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const e=t[Zone.__symbol__("OriginalDelegate")];e&&(t=e);const i=n[Zone.__symbol__("OriginalDelegate")];i&&(n=i)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function U5(t){const n=()=>{!function j5(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Wn,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,z_(t),t.isCheckStableRunning=!0,L_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),z_(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(e,i,r,s,o,d)=>{try{return w2(t),e.invokeTask(r,s,o,d)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===s.type||t.shouldCoalesceRunChangeDetection)&&n(),E2(t)}},onInvoke:(e,i,r,s,o,d,$)=>{try{return w2(t),e.invoke(r,s,o,d,$)}finally{t.shouldCoalesceRunChangeDetection&&n(),E2(t)}},onHasTask:(e,i,r,s)=>{e.hasTask(r,s),i===r&&("microTask"==s.change?(t._hasPendingMicrotasks=s.microTask,z_(t),L_(t)):"macroTask"==s.change&&(t.hasPendingMacrotasks=s.macroTask))},onHandleError:(e,i,r,s)=>(e.handleError(r,s),t.runOutsideAngular(()=>t.onError.emit(s)),!1)})}(r)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!bn.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(bn.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,e,i){return this._inner.run(n,e,i)}runTask(n,e,i,r){const s=this._inner,o=s.scheduleEventTask("NgZoneEvent: "+r,n,z5,xh,xh);try{return s.runTask(o,e,i)}finally{s.cancelTask(o)}}runGuarded(n,e,i){return this._inner.runGuarded(n,e,i)}runOutsideAngular(n){return this._outer.run(n)}}const z5={};function L_(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function z_(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function w2(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function E2(t){t._nesting--,L_(t)}class H5{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new vn,this.onMicrotaskEmpty=new vn,this.onStable=new vn,this.onError=new vn}run(n,e,i){return n.apply(e,i)}runGuarded(n,e,i){return n.apply(e,i)}runOutsideAngular(n){return n()}runTask(n,e,i,r){return n.apply(e,i)}}let j_=(()=>{class t{constructor(e){this._ngZone=e,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),e.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{bn.assertNotInAngularZone(),B_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())B_(()=>{for(;0!==this._callbacks.length;){let e=this._callbacks.pop();clearTimeout(e.timeoutId),e.doneCb(this._didWork)}this._didWork=!1});else{let e=this.getPendingTasks();this._callbacks=this._callbacks.filter(i=>!i.updateCb||!i.updateCb(e)||(clearTimeout(i.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(e=>({source:e.source,creationLocation:e.creationLocation,data:e.data})):[]}addCallback(e,i,r){let s=-1;i&&i>0&&(s=setTimeout(()=>{this._callbacks=this._callbacks.filter(o=>o.timeoutId!==s),e(this._didWork,this.getPendingTasks())},i)),this._callbacks.push({doneCb:e,timeoutId:s,updateCb:r})}whenStable(e,i,r){if(r&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(e,i,r),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(e,i,r){return[]}}return t.\u0275fac=function(e){return new(e||t)(tn(bn))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})(),V5=(()=>{class t{constructor(){this._applications=new Map,U_.addToWindow(this)}registerApplication(e,i){this._applications.set(e,i)}unregisterApplication(e){this._applications.delete(e)}unregisterAllApplications(){this._applications.clear()}getTestability(e){return this._applications.get(e)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(e,i=!0){return U_.findTestabilityInTree(this,e,i)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();class G5{addToWindow(n){}findTestabilityInTree(n,e,i){return null}}let U_=new G5,hl=null;const T2=new In("AllowMultipleToken"),I2=new In("PlatformOnDestroy");function S2(t,n,e=[]){const i=`Platform: ${n}`,r=new In(i);return(s=[])=>{let o=H_();if(!o||o.injector.get(T2,!1)){const d=[...e,...s,{provide:r,useValue:!0}];t?t(d):function Y5(t){if(hl&&!hl.get(T2,!1))throw new Tt(400,"");hl=t;const n=t.get(k2),e=t.get(x2,null);e&&e.forEach(i=>i())}(function X5(t=[],n){return Gr.create({name:n,providers:[{provide:Ym,useValue:"platform"},{provide:I2,useValue:()=>hl=null},...t]})}(d,i))}return function Z5(t){const n=H_();if(!n)throw new Tt(401,"");return n}()}}function H_(){var t;return null!==(t=null==hl?void 0:hl.get(k2))&&void 0!==t?t:null}let k2=(()=>{class t{constructor(e){this._injector=e,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(e,i){const d=function Q5(t,n){let e;return e="noop"===t?new H5:("zone.js"===t?void 0:t)||new bn({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==n?void 0:n.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==n?void 0:n.ngZoneRunCoalescing)}),e}(i?i.ngZone:void 0,{ngZoneEventCoalescing:i&&i.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:i&&i.ngZoneRunCoalescing||!1}),$=[{provide:bn,useValue:d}];return d.run(()=>{const I=Gr.create({providers:$,parent:this.injector,name:e.moduleType.name}),Q=e.create(I),fe=Q.injector.get(qu,null);if(!fe)throw new Tt(402,"");return d.runOutsideAngular(()=>{const _e=d.onError.subscribe({next:Ce=>{fe.handleError(Ce)}});Q.onDestroy(()=>{G_(this._modules,Q),_e.unsubscribe()})}),function J5(t,n,e){try{const i=e();return ch(i)?i.catch(r=>{throw n.runOutsideAngular(()=>t.handleError(r)),r}):i}catch(i){throw n.runOutsideAngular(()=>t.handleError(i)),i}}(fe,d,()=>{const _e=Q.injector.get(R_);return _e.runInitializers(),_e.donePromise.then(()=>(function RP(t){is(t,"Expected localeId to be defined"),"string"==typeof t&&(gC=t.toLowerCase().replace(/_/g,"-"))}(Q.injector.get(xa,fh)||fh),this._moduleDoBootstrap(Q),Q))})})}bootstrapModule(e,i=[]){const r=M2({},i);return function W5(t,n,e){const i=new b_(e);return Promise.resolve(i)}(0,0,e).then(s=>this.bootstrapModuleFactory(s,r))}_moduleDoBootstrap(e){const i=e.injector.get(V_);if(e._bootstrapComponents.length>0)e._bootstrapComponents.forEach(r=>i.bootstrap(r));else{if(!e.instance.ngDoBootstrap)throw new Tt(403,"");e.instance.ngDoBootstrap(i)}this._modules.push(e)}onDestroy(e){this._destroyListeners.push(e)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Tt(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i());const e=this._injector.get(I2,null);null==e||e(),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(e){return new(e||t)(tn(Gr))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"platform"}),t})();function M2(t,n){return Array.isArray(n)?n.reduce(M2,t):Object.assign(Object.assign({},t),n)}let V_=(()=>{class t{constructor(e,i,r,s){this._zone=e,this._injector=i,this._exceptionHandler=r,this._initStatus=s,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const o=new f($=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{$.next(this._stable),$.complete()})}),d=new f($=>{let I;this._zone.runOutsideAngular(()=>{I=this._zone.onStable.subscribe(()=>{bn.assertNotInAngularZone(),B_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,$.next(!0))})})});const Q=this._zone.onUnstable.subscribe(()=>{bn.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{$.next(!1)}))});return()=>{I.unsubscribe(),Q.unsubscribe()}});this.isStable=Ur(o,d.pipe(function nl(t={}){const{connector:n=(()=>new le),resetOnError:e=!0,resetOnComplete:i=!0,resetOnRefCountZero:r=!0}=t;return s=>{let o,d,$,I=0,Q=!1,fe=!1;const _e=()=>{null==d||d.unsubscribe(),d=void 0},Ce=()=>{_e(),o=$=void 0,Q=fe=!1},Ee=()=>{const Re=o;Ce(),null==Re||Re.unsubscribe()};return R((Re,Le)=>{I++,!fe&&!Q&&_e();const Be=$=null!=$?$:n();Le.add(()=>{I--,0===I&&!fe&&!Q&&(d=Hr(Ee,r))}),Be.subscribe(Le),!o&&I>0&&(o=new A({next:Ae=>Be.next(Ae),error:Ae=>{fe=!0,_e(),d=Hr(Ce,e,Ae),Be.error(Ae)},complete:()=>{Q=!0,_e(),d=Hr(Ce,i),Be.complete()}}),ur(Re).subscribe(o))})(s)}}()))}bootstrap(e,i){if(!this._initStatus.done)throw new Tt(405,"");let r;r=e instanceof zC?e:this._injector.get(_h).resolveComponentFactory(e),this.componentTypes.push(r.componentType);const s=function K5(t){return t.isBoundToModule}(r)?void 0:this._injector.get(Vc),d=r.create(Gr.NULL,[],i||r.selector,s),$=d.location.nativeElement,I=d.injector.get(j_,null),Q=I&&d.injector.get(V5);return I&&Q&&Q.registerApplication($,I),d.onDestroy(()=>{this.detachView(d.hostView),G_(this.components,d),Q&&Q.unregisterApplication($)}),this._loadComponent(d),d}tick(){if(this._runningTick)throw new Tt(101,"");try{this._runningTick=!0;for(let e of this._views)e.detectChanges()}catch(e){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(e))}finally{this._runningTick=!1}}attachView(e){const i=e;this._views.push(i),i.attachToAppRef(this)}detachView(e){const i=e;G_(this._views,i),i.detachFromAppRef()}_loadComponent(e){this.attachView(e.hostView),this.tick(),this.components.push(e),this._injector.get(P5,[]).concat(this._bootstrapListeners).forEach(r=>r(e))}ngOnDestroy(){this._views.slice().forEach(e=>e.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(e){return new(e||t)(tn(bn),tn(Gr),tn(qu),tn(R_))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function G_(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}let A2=!0,Di=(()=>{class t{}return t.__NG_ELEMENT_ID__=nN,t})();function nN(t){return function iN(t,n,e){if(Tf(t)&&!e){const i=os(t.index,n);return new ad(i,i)}return 47&t.type?new ad(n[16],n):null}(zi(),ft(),16==(16&t))}class O2{constructor(){}supports(n){return Qu(n)}create(n){return new cN(n)}}const lN=(t,n)=>n;class cN{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||lN}forEachItem(n){let e;for(e=this._itHead;null!==e;e=e._next)n(e)}forEachOperation(n){let e=this._itHead,i=this._removalsHead,r=0,s=null;for(;e||i;){const o=!i||e&&e.currentIndex<L2(i,r,s)?e:i,d=L2(o,r,s),$=o.currentIndex;if(o===i)r--,i=i._nextRemoved;else if(e=e._next,null==o.previousIndex)r++;else{s||(s=[]);const I=d-r,Q=$-r;if(I!=Q){for(let _e=0;_e<I;_e++){const Ce=_e<s.length?s[_e]:s[_e]=0,Ee=Ce+_e;Q<=Ee&&Ee<I&&(s[_e]=Ce+1)}s[o.previousIndex]=Q-I}}d!==$&&n(o,d,$)}}forEachPreviousItem(n){let e;for(e=this._previousItHead;null!==e;e=e._nextPrevious)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachMovedItem(n){let e;for(e=this._movesHead;null!==e;e=e._nextMoved)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}forEachIdentityChange(n){let e;for(e=this._identityChangesHead;null!==e;e=e._nextIdentityChange)n(e)}diff(n){if(null==n&&(n=[]),!Qu(n))throw new Tt(900,"");return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r,s,o,e=this._itHead,i=!1;if(Array.isArray(n)){this.length=n.length;for(let d=0;d<this.length;d++)s=n[d],o=this._trackByFn(d,s),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,s,o,d)),Object.is(e.item,s)||this._addIdentityChange(e,s)):(e=this._mismatch(e,s,o,d),i=!0),e=e._next}else r=0,function CA(t,n){if(Array.isArray(t))for(let e=0;e<t.length;e++)n(t[e]);else{const e=t[kc()]();let i;for(;!(i=e.next()).done;)n(i.value)}}(n,d=>{o=this._trackByFn(r,d),null!==e&&Object.is(e.trackById,o)?(i&&(e=this._verifyReinsertion(e,d,o,r)),Object.is(e.item,d)||this._addIdentityChange(e,d)):(e=this._mismatch(e,d,o,r),i=!0),e=e._next,r++}),this.length=r;return this._truncate(e),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,e,i,r){let s;return null===n?s=this._itTail:(s=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._reinsertAfter(n,s,r)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(i,r))?(Object.is(n.item,e)||this._addIdentityChange(n,e),this._moveAfter(n,s,r)):n=this._addAfter(new uN(e,i),s,r),n}_verifyReinsertion(n,e,i,r){let s=null===this._unlinkedRecords?null:this._unlinkedRecords.get(i,null);return null!==s?n=this._reinsertAfter(s,n._prev,r):n.currentIndex!=r&&(n.currentIndex=r,this._addToMoves(n,r)),n}_truncate(n){for(;null!==n;){const e=n._next;this._addToRemovals(this._unlink(n)),n=e}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,e,i){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const r=n._prevRemoved,s=n._nextRemoved;return null===r?this._removalsHead=s:r._nextRemoved=s,null===s?this._removalsTail=r:s._prevRemoved=r,this._insertAfter(n,e,i),this._addToMoves(n,i),n}_moveAfter(n,e,i){return this._unlink(n),this._insertAfter(n,e,i),this._addToMoves(n,i),n}_addAfter(n,e,i){return this._insertAfter(n,e,i),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,e,i){const r=null===e?this._itHead:e._next;return n._next=r,n._prev=e,null===r?this._itTail=n:r._prev=n,null===e?this._itHead=n:e._next=n,null===this._linkedRecords&&(this._linkedRecords=new B2),this._linkedRecords.put(n),n.currentIndex=i,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const e=n._prev,i=n._next;return null===e?this._itHead=i:e._next=i,null===i?this._itTail=e:i._prev=e,n}_addToMoves(n,e){return n.previousIndex===e||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new B2),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,e){return n.item=e,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class uN{constructor(n,e){this.item=n,this.trackById=e,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class dN{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,e){let i;for(i=this._head;null!==i;i=i._nextDup)if((null===e||e<=i.currentIndex)&&Object.is(i.trackById,n))return i;return null}remove(n){const e=n._prevDup,i=n._nextDup;return null===e?this._head=i:e._nextDup=i,null===i?this._tail=e:i._prevDup=e,null===this._head}}class B2{constructor(){this.map=new Map}put(n){const e=n.trackById;let i=this.map.get(e);i||(i=new dN,this.map.set(e,i)),i.add(n)}get(n,e){const r=this.map.get(n);return r?r.get(n,e):null}remove(n){const e=n.trackById;return this.map.get(e).remove(n)&&this.map.delete(e),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function L2(t,n,e){const i=t.previousIndex;if(null===i)return i;let r=0;return e&&i<e.length&&(r=e[i]),i+n+r}class z2{constructor(){}supports(n){return n instanceof Map||t_(n)}create(){return new fN}}class fN{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let e;for(e=this._mapHead;null!==e;e=e._next)n(e)}forEachPreviousItem(n){let e;for(e=this._previousMapHead;null!==e;e=e._nextPrevious)n(e)}forEachChangedItem(n){let e;for(e=this._changesHead;null!==e;e=e._nextChanged)n(e)}forEachAddedItem(n){let e;for(e=this._additionsHead;null!==e;e=e._nextAdded)n(e)}forEachRemovedItem(n){let e;for(e=this._removalsHead;null!==e;e=e._nextRemoved)n(e)}diff(n){if(n){if(!(n instanceof Map||t_(n)))throw new Tt(900,"")}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let e=this._mapHead;if(this._appendAfter=null,this._forEach(n,(i,r)=>{if(e&&e.key===r)this._maybeAddToChanges(e,i),this._appendAfter=e,e=e._next;else{const s=this._getOrCreateRecordForKey(r,i);e=this._insertBeforeOrAppend(e,s)}}),e){e._prev&&(e._prev._next=null),this._removalsHead=e;for(let i=e;null!==i;i=i._nextRemoved)i===this._mapHead&&(this._mapHead=null),this._records.delete(i.key),i._nextRemoved=i._next,i.previousValue=i.currentValue,i.currentValue=null,i._prev=null,i._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,e){if(n){const i=n._prev;return e._next=n,e._prev=i,n._prev=e,i&&(i._next=e),n===this._mapHead&&(this._mapHead=e),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=e,e._prev=this._appendAfter):this._mapHead=e,this._appendAfter=e,null}_getOrCreateRecordForKey(n,e){if(this._records.has(n)){const r=this._records.get(n);this._maybeAddToChanges(r,e);const s=r._prev,o=r._next;return s&&(s._next=o),o&&(o._prev=s),r._next=null,r._prev=null,r}const i=new hN(n);return this._records.set(n,i),i.currentValue=e,this._addToAdditions(i),i}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,e){Object.is(e,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=e,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,e){n instanceof Map?n.forEach(e):Object.keys(n).forEach(i=>e(n[i],i))}}class hN{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function j2(){return new Th([new O2])}let Th=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(null!=i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||j2()),deps:[[t,new Gf,new Vf]]}}find(e){const i=this.factories.find(r=>r.supports(e));if(null!=i)return i;throw new Tt(901,"")}}return t.\u0275prov=Zt({token:t,providedIn:"root",factory:j2}),t})();function U2(){return new hd([new z2])}let hd=(()=>{class t{constructor(e){this.factories=e}static create(e,i){if(i){const r=i.factories.slice();e=e.concat(r)}return new t(e)}static extend(e){return{provide:t,useFactory:i=>t.create(e,i||U2()),deps:[[t,new Gf,new Vf]]}}find(e){const i=this.factories.find(s=>s.supports(e));if(i)return i;throw new Tt(901,"")}}return t.\u0275prov=Zt({token:t,providedIn:"root",factory:U2}),t})();const mN=S2(null,"core",[]);let _N=(()=>{class t{constructor(e){}}return t.\u0275fac=function(e){return new(e||t)(tn(V_))},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({}),t})(),Ih=null;function gl(){return Ih}const Wr=new In("DocumentToken");var Ii=(()=>((Ii=Ii||{})[Ii.Format=0]="Format",Ii[Ii.Standalone=1]="Standalone",Ii))(),En=(()=>((En=En||{})[En.Narrow=0]="Narrow",En[En.Abbreviated=1]="Abbreviated",En[En.Wide=2]="Wide",En[En.Short=3]="Short",En))(),vi=(()=>((vi=vi||{})[vi.Short=0]="Short",vi[vi.Medium=1]="Medium",vi[vi.Long=2]="Long",vi[vi.Full=3]="Full",vi))(),Vt=(()=>((Vt=Vt||{})[Vt.Decimal=0]="Decimal",Vt[Vt.Group=1]="Group",Vt[Vt.List=2]="List",Vt[Vt.PercentSign=3]="PercentSign",Vt[Vt.PlusSign=4]="PlusSign",Vt[Vt.MinusSign=5]="MinusSign",Vt[Vt.Exponential=6]="Exponential",Vt[Vt.SuperscriptingExponent=7]="SuperscriptingExponent",Vt[Vt.PerMille=8]="PerMille",Vt[Vt.Infinity=9]="Infinity",Vt[Vt.NaN=10]="NaN",Vt[Vt.TimeSeparator=11]="TimeSeparator",Vt[Vt.CurrencyDecimal=12]="CurrencyDecimal",Vt[Vt.CurrencyGroup=13]="CurrencyGroup",Vt))();function Sh(t,n){return ks(Ar(t)[Et.DateFormat],n)}function kh(t,n){return ks(Ar(t)[Et.TimeFormat],n)}function Mh(t,n){return ks(Ar(t)[Et.DateTimeFormat],n)}function Ss(t,n){const e=Ar(t),i=e[Et.NumberSymbols][n];if(void 0===i){if(n===Vt.CurrencyDecimal)return e[Et.NumberSymbols][Vt.Decimal];if(n===Vt.CurrencyGroup)return e[Et.NumberSymbols][Vt.Group]}return i}function q2(t){if(!t[Et.ExtraData])throw new Error(`Missing extra locale data for the locale "${t[Et.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function ks(t,n){for(let e=n;e>-1;e--)if(void 0!==t[e])return t[e];throw new Error("Locale data API: locale data undefined")}function X_(t){const[n,e]=t.split(":");return{hours:+n,minutes:+e}}const RN=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,pd={},ON=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Vi=(()=>((Vi=Vi||{})[Vi.Short=0]="Short",Vi[Vi.ShortGMT=1]="ShortGMT",Vi[Vi.Long=2]="Long",Vi[Vi.Extended=3]="Extended",Vi))(),Kt=(()=>((Kt=Kt||{})[Kt.FullYear=0]="FullYear",Kt[Kt.Month=1]="Month",Kt[Kt.Date=2]="Date",Kt[Kt.Hours=3]="Hours",Kt[Kt.Minutes=4]="Minutes",Kt[Kt.Seconds=5]="Seconds",Kt[Kt.FractionalSeconds=6]="FractionalSeconds",Kt[Kt.Day=7]="Day",Kt))(),pn=(()=>((pn=pn||{})[pn.DayPeriods=0]="DayPeriods",pn[pn.Days=1]="Days",pn[pn.Months=2]="Months",pn[pn.Eras=3]="Eras",pn))();function gd(t,n,e,i){let r=function qN(t){if(Y2(t))return t;if("number"==typeof t&&!isNaN(t))return new Date(t);if("string"==typeof t){if(t=t.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(t)){const[r,s=1,o=1]=t.split("-").map(d=>+d);return Dh(r,s-1,o)}const e=parseFloat(t);if(!isNaN(t-e))return new Date(e);let i;if(i=t.match(RN))return function WN(t){const n=new Date(0);let e=0,i=0;const r=t[8]?n.setUTCFullYear:n.setFullYear,s=t[8]?n.setUTCHours:n.setHours;t[9]&&(e=Number(t[9]+t[10]),i=Number(t[9]+t[11])),r.call(n,Number(t[1]),Number(t[2])-1,Number(t[3]));const o=Number(t[4]||0)-e,d=Number(t[5]||0)-i,$=Number(t[6]||0),I=Math.floor(1e3*parseFloat("0."+(t[7]||0)));return s.call(n,o,d,$,I),n}(i)}const n=new Date(t);if(!Y2(n))throw new Error(`Unable to convert "${t}" into a date`);return n}(t);n=Xo(e,n)||n;let d,o=[];for(;n;){if(d=ON.exec(n),!d){o.push(n);break}{o=o.concat(d.slice(1));const Q=o.pop();if(!Q)break;n=Q}}let $=r.getTimezoneOffset();i&&($=K2(i,$),r=function GN(t,n,e){const i=e?-1:1,r=t.getTimezoneOffset();return function VN(t,n){return(t=new Date(t.getTime())).setMinutes(t.getMinutes()+n),t}(t,i*(K2(n,r)-r))}(r,i,!0));let I="";return o.forEach(Q=>{const fe=function HN(t){if(J_[t])return J_[t];let n;switch(t){case"G":case"GG":case"GGG":n=ri(pn.Eras,En.Abbreviated);break;case"GGGG":n=ri(pn.Eras,En.Wide);break;case"GGGGG":n=ri(pn.Eras,En.Narrow);break;case"y":n=Pi(Kt.FullYear,1,0,!1,!0);break;case"yy":n=Pi(Kt.FullYear,2,0,!0,!0);break;case"yyy":n=Pi(Kt.FullYear,3,0,!1,!0);break;case"yyyy":n=Pi(Kt.FullYear,4,0,!1,!0);break;case"Y":n=Fh(1);break;case"YY":n=Fh(2,!0);break;case"YYY":n=Fh(3);break;case"YYYY":n=Fh(4);break;case"M":case"L":n=Pi(Kt.Month,1,1);break;case"MM":case"LL":n=Pi(Kt.Month,2,1);break;case"MMM":n=ri(pn.Months,En.Abbreviated);break;case"MMMM":n=ri(pn.Months,En.Wide);break;case"MMMMM":n=ri(pn.Months,En.Narrow);break;case"LLL":n=ri(pn.Months,En.Abbreviated,Ii.Standalone);break;case"LLLL":n=ri(pn.Months,En.Wide,Ii.Standalone);break;case"LLLLL":n=ri(pn.Months,En.Narrow,Ii.Standalone);break;case"w":n=Q_(1);break;case"ww":n=Q_(2);break;case"W":n=Q_(1,!0);break;case"d":n=Pi(Kt.Date,1);break;case"dd":n=Pi(Kt.Date,2);break;case"c":case"cc":n=Pi(Kt.Day,1);break;case"ccc":n=ri(pn.Days,En.Abbreviated,Ii.Standalone);break;case"cccc":n=ri(pn.Days,En.Wide,Ii.Standalone);break;case"ccccc":n=ri(pn.Days,En.Narrow,Ii.Standalone);break;case"cccccc":n=ri(pn.Days,En.Short,Ii.Standalone);break;case"E":case"EE":case"EEE":n=ri(pn.Days,En.Abbreviated);break;case"EEEE":n=ri(pn.Days,En.Wide);break;case"EEEEE":n=ri(pn.Days,En.Narrow);break;case"EEEEEE":n=ri(pn.Days,En.Short);break;case"a":case"aa":case"aaa":n=ri(pn.DayPeriods,En.Abbreviated);break;case"aaaa":n=ri(pn.DayPeriods,En.Wide);break;case"aaaaa":n=ri(pn.DayPeriods,En.Narrow);break;case"b":case"bb":case"bbb":n=ri(pn.DayPeriods,En.Abbreviated,Ii.Standalone,!0);break;case"bbbb":n=ri(pn.DayPeriods,En.Wide,Ii.Standalone,!0);break;case"bbbbb":n=ri(pn.DayPeriods,En.Narrow,Ii.Standalone,!0);break;case"B":case"BB":case"BBB":n=ri(pn.DayPeriods,En.Abbreviated,Ii.Format,!0);break;case"BBBB":n=ri(pn.DayPeriods,En.Wide,Ii.Format,!0);break;case"BBBBB":n=ri(pn.DayPeriods,En.Narrow,Ii.Format,!0);break;case"h":n=Pi(Kt.Hours,1,-12);break;case"hh":n=Pi(Kt.Hours,2,-12);break;case"H":n=Pi(Kt.Hours,1);break;case"HH":n=Pi(Kt.Hours,2);break;case"m":n=Pi(Kt.Minutes,1);break;case"mm":n=Pi(Kt.Minutes,2);break;case"s":n=Pi(Kt.Seconds,1);break;case"ss":n=Pi(Kt.Seconds,2);break;case"S":n=Pi(Kt.FractionalSeconds,1);break;case"SS":n=Pi(Kt.FractionalSeconds,2);break;case"SSS":n=Pi(Kt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":n=Ph(Vi.Short);break;case"ZZZZZ":n=Ph(Vi.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":n=Ph(Vi.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":n=Ph(Vi.Long);break;default:return null}return J_[t]=n,n}(Q);I+=fe?fe(r,e,$):"''"===Q?"'":Q.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),I}function Dh(t,n,e){const i=new Date(0);return i.setFullYear(t,n,e),i.setHours(0,0,0),i}function Xo(t,n){const e=function wN(t){return Ar(t)[Et.LocaleId]}(t);if(pd[e]=pd[e]||{},pd[e][n])return pd[e][n];let i="";switch(n){case"shortDate":i=Sh(t,vi.Short);break;case"mediumDate":i=Sh(t,vi.Medium);break;case"longDate":i=Sh(t,vi.Long);break;case"fullDate":i=Sh(t,vi.Full);break;case"shortTime":i=kh(t,vi.Short);break;case"mediumTime":i=kh(t,vi.Medium);break;case"longTime":i=kh(t,vi.Long);break;case"fullTime":i=kh(t,vi.Full);break;case"short":const r=Xo(t,"shortTime"),s=Xo(t,"shortDate");i=Ah(Mh(t,vi.Short),[r,s]);break;case"medium":const o=Xo(t,"mediumTime"),d=Xo(t,"mediumDate");i=Ah(Mh(t,vi.Medium),[o,d]);break;case"long":const $=Xo(t,"longTime"),I=Xo(t,"longDate");i=Ah(Mh(t,vi.Long),[$,I]);break;case"full":const Q=Xo(t,"fullTime"),fe=Xo(t,"fullDate");i=Ah(Mh(t,vi.Full),[Q,fe])}return i&&(pd[e][n]=i),i}function Ah(t,n){return n&&(t=t.replace(/\{([^}]+)}/g,function(e,i){return null!=n&&i in n?n[i]:e})),t}function eo(t,n,e="-",i,r){let s="";(t<0||r&&t<=0)&&(r?t=1-t:(t=-t,s=e));let o=String(t);for(;o.length<n;)o="0"+o;return i&&(o=o.substr(o.length-n)),s+o}function Pi(t,n,e=0,i=!1,r=!1){return function(s,o){let d=function LN(t,n){switch(t){case Kt.FullYear:return n.getFullYear();case Kt.Month:return n.getMonth();case Kt.Date:return n.getDate();case Kt.Hours:return n.getHours();case Kt.Minutes:return n.getMinutes();case Kt.Seconds:return n.getSeconds();case Kt.FractionalSeconds:return n.getMilliseconds();case Kt.Day:return n.getDay();default:throw new Error(`Unknown DateType value "${t}".`)}}(t,s);if((e>0||d>-e)&&(d+=e),t===Kt.Hours)0===d&&-12===e&&(d=12);else if(t===Kt.FractionalSeconds)return function BN(t,n){return eo(t,3).substr(0,n)}(d,n);const $=Ss(o,Vt.MinusSign);return eo(d,n,$,i,r)}}function ri(t,n,e=Ii.Format,i=!1){return function(r,s){return function zN(t,n,e,i,r,s){switch(e){case pn.Months:return function IN(t,n,e){const i=Ar(t),s=ks([i[Et.MonthsFormat],i[Et.MonthsStandalone]],n);return ks(s,e)}(n,r,i)[t.getMonth()];case pn.Days:return function TN(t,n,e){const i=Ar(t),s=ks([i[Et.DaysFormat],i[Et.DaysStandalone]],n);return ks(s,e)}(n,r,i)[t.getDay()];case pn.DayPeriods:const o=t.getHours(),d=t.getMinutes();if(s){const I=function DN(t){const n=Ar(t);return q2(n),(n[Et.ExtraData][2]||[]).map(i=>"string"==typeof i?X_(i):[X_(i[0]),X_(i[1])])}(n),Q=function AN(t,n,e){const i=Ar(t);q2(i);const s=ks([i[Et.ExtraData][0],i[Et.ExtraData][1]],n)||[];return ks(s,e)||[]}(n,r,i),fe=I.findIndex(_e=>{if(Array.isArray(_e)){const[Ce,Ee]=_e,Re=o>=Ce.hours&&d>=Ce.minutes,Le=o<Ee.hours||o===Ee.hours&&d<Ee.minutes;if(Ce.hours<Ee.hours){if(Re&&Le)return!0}else if(Re||Le)return!0}else if(_e.hours===o&&_e.minutes===d)return!0;return!1});if(-1!==fe)return Q[fe]}return function EN(t,n,e){const i=Ar(t),s=ks([i[Et.DayPeriodsFormat],i[Et.DayPeriodsStandalone]],n);return ks(s,e)}(n,r,i)[o<12?0:1];case pn.Eras:return function SN(t,n){return ks(Ar(t)[Et.Eras],n)}(n,i)[t.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${e}`)}}(r,s,t,n,e,i)}}function Ph(t){return function(n,e,i){const r=-1*i,s=Ss(e,Vt.MinusSign),o=r>0?Math.floor(r/60):Math.ceil(r/60);switch(t){case Vi.Short:return(r>=0?"+":"")+eo(o,2,s)+eo(Math.abs(r%60),2,s);case Vi.ShortGMT:return"GMT"+(r>=0?"+":"")+eo(o,1,s);case Vi.Long:return"GMT"+(r>=0?"+":"")+eo(o,2,s)+":"+eo(Math.abs(r%60),2,s);case Vi.Extended:return 0===i?"Z":(r>=0?"+":"")+eo(o,2,s)+":"+eo(Math.abs(r%60),2,s);default:throw new Error(`Unknown zone width "${t}"`)}}}function W2(t){return Dh(t.getFullYear(),t.getMonth(),t.getDate()+(4-t.getDay()))}function Q_(t,n=!1){return function(e,i){let r;if(n){const s=new Date(e.getFullYear(),e.getMonth(),1).getDay()-1,o=e.getDate();r=1+Math.floor((o+s)/7)}else{const s=W2(e),o=function UN(t){const n=Dh(t,0,1).getDay();return Dh(t,0,1+(n<=4?4:11)-n)}(s.getFullYear()),d=s.getTime()-o.getTime();r=1+Math.round(d/6048e5)}return eo(r,t,Ss(i,Vt.MinusSign))}}function Fh(t,n=!1){return function(e,i){return eo(W2(e).getFullYear(),t,Ss(i,Vt.MinusSign),n)}}const J_={};function K2(t,n){t=t.replace(/:/g,"");const e=Date.parse("Jan 01, 1970 00:00:00 "+t)/6e4;return isNaN(e)?n:e}function Y2(t){return t instanceof Date&&!isNaN(t.valueOf())}let jn=(()=>{class t{constructor(e,i,r,s){this._iterableDiffers=e,this._keyValueDiffers=i,this._ngEl=r,this._renderer=s,this._iterableDiffer=null,this._keyValueDiffer=null,this._initialClasses=[],this._rawClass=null}set klass(e){this._removeClasses(this._initialClasses),this._initialClasses="string"==typeof e?e.split(/\s+/):[],this._applyClasses(this._initialClasses),this._applyClasses(this._rawClass)}set ngClass(e){this._removeClasses(this._rawClass),this._applyClasses(this._initialClasses),this._iterableDiffer=null,this._keyValueDiffer=null,this._rawClass="string"==typeof e?e.split(/\s+/):e,this._rawClass&&(Qu(this._rawClass)?this._iterableDiffer=this._iterableDiffers.find(this._rawClass).create():this._keyValueDiffer=this._keyValueDiffers.find(this._rawClass).create())}ngDoCheck(){if(this._iterableDiffer){const e=this._iterableDiffer.diff(this._rawClass);e&&this._applyIterableChanges(e)}else if(this._keyValueDiffer){const e=this._keyValueDiffer.diff(this._rawClass);e&&this._applyKeyValueChanges(e)}}_applyKeyValueChanges(e){e.forEachAddedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachChangedItem(i=>this._toggleClass(i.key,i.currentValue)),e.forEachRemovedItem(i=>{i.previousValue&&this._toggleClass(i.key,!1)})}_applyIterableChanges(e){e.forEachAddedItem(i=>{if("string"!=typeof i.item)throw new Error(`NgClass can only toggle CSS classes expressed as strings, got ${Rn(i.item)}`);this._toggleClass(i.item,!0)}),e.forEachRemovedItem(i=>this._toggleClass(i.item,!1))}_applyClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!0)):Object.keys(e).forEach(i=>this._toggleClass(i,!!e[i])))}_removeClasses(e){e&&(Array.isArray(e)||e instanceof Set?e.forEach(i=>this._toggleClass(i,!1)):Object.keys(e).forEach(i=>this._toggleClass(i,!1)))}_toggleClass(e,i){(e=e.trim())&&e.split(/\s+/g).forEach(r=>{i?this._renderer.addClass(this._ngEl.nativeElement,r):this._renderer.removeClass(this._ngEl.nativeElement,r)})}}return t.\u0275fac=function(e){return new(e||t)(Oe(Th),Oe(hd),Oe(pi),Oe(fl))},t.\u0275dir=Gt({type:t,selectors:[["","ngClass",""]],inputs:{klass:["class","klass"],ngClass:"ngClass"}}),t})();class aF{constructor(n,e,i,r){this.$implicit=n,this.ngForOf=e,this.index=i,this.count=r}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Jn=(()=>{class t{constructor(e,i,r){this._viewContainer=e,this._template=i,this._differs=r,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(e){this._ngForOf=e,this._ngForOfDirty=!0}set ngForTrackBy(e){this._trackByFn=e}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(e){e&&(this._template=e)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const e=this._ngForOf;!this._differ&&e&&(this._differ=this._differs.find(e).create(this.ngForTrackBy))}if(this._differ){const e=this._differ.diff(this._ngForOf);e&&this._applyChanges(e)}}_applyChanges(e){const i=this._viewContainer;e.forEachOperation((r,s,o)=>{if(null==r.previousIndex)i.createEmbeddedView(this._template,new aF(r.item,this._ngForOf,-1,-1),null===o?void 0:o);else if(null==o)i.remove(null===s?void 0:s);else if(null!==s){const d=i.get(s);i.move(d,o),J2(d,r)}});for(let r=0,s=i.length;r<s;r++){const d=i.get(r).context;d.index=r,d.count=s,d.ngForOf=this._ngForOf}e.forEachIdentityChange(r=>{J2(i.get(r.currentIndex),r)})}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(Oe(Pr),Oe(Zo),Oe(Th))},t.\u0275dir=Gt({type:t,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),t})();function J2(t,n){t.context.$implicit=n.item}let gn=(()=>{class t{constructor(e,i){this._viewContainer=e,this._context=new lF,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=i}set ngIf(e){this._context.$implicit=this._context.ngIf=e,this._updateView()}set ngIfThen(e){ex("ngIfThen",e),this._thenTemplateRef=e,this._thenViewRef=null,this._updateView()}set ngIfElse(e){ex("ngIfElse",e),this._elseTemplateRef=e,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(e,i){return!0}}return t.\u0275fac=function(e){return new(e||t)(Oe(Pr),Oe(Zo))},t.\u0275dir=Gt({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class lF{constructor(){this.$implicit=null,this.ngIf=null}}function ex(t,n){if(n&&!n.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Rn(n)}'.`)}class s${constructor(n,e){this._viewContainerRef=n,this._templateRef=e,this._created=!1}create(){this._created=!0,this._viewContainerRef.createEmbeddedView(this._templateRef)}destroy(){this._created=!1,this._viewContainerRef.clear()}enforceState(n){n&&!this._created?this.create():!n&&this._created&&this.destroy()}}let ml=(()=>{class t{constructor(){this._defaultUsed=!1,this._caseCount=0,this._lastCaseCheckIndex=0,this._lastCasesMatched=!1}set ngSwitch(e){this._ngSwitch=e,0===this._caseCount&&this._updateDefaultCases(!0)}_addCase(){return this._caseCount++}_addDefault(e){this._defaultViews||(this._defaultViews=[]),this._defaultViews.push(e)}_matchCase(e){const i=e==this._ngSwitch;return this._lastCasesMatched=this._lastCasesMatched||i,this._lastCaseCheckIndex++,this._lastCaseCheckIndex===this._caseCount&&(this._updateDefaultCases(!this._lastCasesMatched),this._lastCaseCheckIndex=0,this._lastCasesMatched=!1),i}_updateDefaultCases(e){if(this._defaultViews&&e!==this._defaultUsed){this._defaultUsed=e;for(let i=0;i<this._defaultViews.length;i++)this._defaultViews[i].enforceState(e)}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Gt({type:t,selectors:[["","ngSwitch",""]],inputs:{ngSwitch:"ngSwitch"}}),t})(),_d=(()=>{class t{constructor(e,i,r){this.ngSwitch=r,r._addCase(),this._view=new s$(e,i)}ngDoCheck(){this._view.enforceState(this.ngSwitch._matchCase(this.ngSwitchCase))}}return t.\u0275fac=function(e){return new(e||t)(Oe(Pr),Oe(Zo),Oe(ml,9))},t.\u0275dir=Gt({type:t,selectors:[["","ngSwitchCase",""]],inputs:{ngSwitchCase:"ngSwitchCase"}}),t})(),$d=(()=>{class t{constructor(e,i,r){r._addDefault(new s$(e,i))}}return t.\u0275fac=function(e){return new(e||t)(Oe(Pr),Oe(Zo),Oe(ml,9))},t.\u0275dir=Gt({type:t,selectors:[["","ngSwitchDefault",""]]}),t})(),Ji=(()=>{class t{constructor(e,i,r){this._ngEl=e,this._differs=i,this._renderer=r,this._ngStyle=null,this._differ=null}set ngStyle(e){this._ngStyle=e,!this._differ&&e&&(this._differ=this._differs.find(e).create())}ngDoCheck(){if(this._differ){const e=this._differ.diff(this._ngStyle);e&&this._applyChanges(e)}}_setStyle(e,i){const[r,s]=e.split(".");null!=(i=null!=i&&s?`${i}${s}`:i)?this._renderer.setStyle(this._ngEl.nativeElement,r,i):this._renderer.removeStyle(this._ngEl.nativeElement,r)}_applyChanges(e){e.forEachRemovedItem(i=>this._setStyle(i.key,null)),e.forEachAddedItem(i=>this._setStyle(i.key,i.currentValue)),e.forEachChangedItem(i=>this._setStyle(i.key,i.currentValue))}}return t.\u0275fac=function(e){return new(e||t)(Oe(pi),Oe(hd),Oe(fl))},t.\u0275dir=Gt({type:t,selectors:[["","ngStyle",""]],inputs:{ngStyle:"ngStyle"}}),t})(),_l=(()=>{class t{constructor(e){this._viewContainerRef=e,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(e){if(e.ngTemplateOutlet){const i=this._viewContainerRef;this._viewRef&&i.remove(i.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?i.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&e.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Pr))},t.\u0275dir=Gt({type:t,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[Ws]}),t})();const vF=new In("DATE_PIPE_DEFAULT_TIMEZONE");let nx=(()=>{class t{constructor(e,i){this.locale=e,this.defaultTimezone=i}transform(e,i="mediumDate",r,s){var o;if(null==e||""===e||e!=e)return null;try{return gd(e,i,s||this.locale,null!==(o=null!=r?r:this.defaultTimezone)&&void 0!==o?o:void 0)}catch(d){throw function to(t,n){return new Tt(2100,"")}()}}}return t.\u0275fac=function(e){return new(e||t)(Oe(xa,16),Oe(vF,24))},t.\u0275pipe=fr({name:"date",type:t,pure:!0}),t})(),rx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({}),t})();const sx="browser";function l$(t){return t===sx}class c$ extends class FF extends class bN{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function vN(t){Ih||(Ih=t)}(new c$)}onAndCancel(n,e,i){return n.addEventListener(e,i,!1),()=>{n.removeEventListener(e,i,!1)}}dispatchEvent(n,e){n.dispatchEvent(e)}remove(n){n.parentNode&&n.parentNode.removeChild(n)}createElement(n,e){return(e=e||this.getDefaultDocument()).createElement(n)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(n){return n.nodeType===Node.ELEMENT_NODE}isShadowRoot(n){return n instanceof DocumentFragment}getGlobalEventTarget(n,e){return"window"===e?window:"document"===e?n:"body"===e?n.body:null}getBaseHref(n){const e=function RF(){return vd=vd||document.querySelector("base"),vd?vd.getAttribute("href"):null}();return null==e?null:function OF(t){Oh=Oh||document.createElement("a"),Oh.setAttribute("href",t);const n=Oh.pathname;return"/"===n.charAt(0)?n:`/${n}`}(e)}resetBaseElement(){vd=null}getUserAgent(){return window.navigator.userAgent}getCookie(n){return function sF(t,n){n=encodeURIComponent(n);for(const e of t.split(";")){const i=e.indexOf("="),[r,s]=-1==i?[e,""]:[e.slice(0,i),e.slice(i+1)];if(r.trim()===n)return decodeURIComponent(s)}return null}(document.cookie,n)}}let Oh,vd=null;const ax=new In("TRANSITION_ID"),LF=[{provide:F_,useFactory:function BF(t,n,e){return()=>{e.get(R_).donePromise.then(()=>{const i=gl(),r=n.querySelectorAll(`style[ng-transition="${t}"]`);for(let s=0;s<r.length;s++)i.remove(r[s])})}},deps:[ax,Wr,Gr],multi:!0}];class u${static init(){!function q5(t){U_=t}(new u$)}addToWindow(n){Wn.getAngularTestability=(i,r=!0)=>{const s=n.findTestabilityInTree(i,r);if(null==s)throw new Error("Could not find testability for element.");return s},Wn.getAllAngularTestabilities=()=>n.getAllTestabilities(),Wn.getAllAngularRootElements=()=>n.getAllRootElements(),Wn.frameworkStabilizers||(Wn.frameworkStabilizers=[]),Wn.frameworkStabilizers.push(i=>{const r=Wn.getAllAngularTestabilities();let s=r.length,o=!1;const d=function($){o=o||$,s--,0==s&&i(o)};r.forEach(function($){$.whenStable(d)})})}findTestabilityInTree(n,e,i){if(null==e)return null;const r=n.getTestability(e);return null!=r?r:i?gl().isShadowRoot(e)?this.findTestabilityInTree(n,e.host,!0):this.findTestabilityInTree(n,e.parentElement,!0):null}}let zF=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();const Bh=new In("EventManagerPlugins");let Lh=(()=>{class t{constructor(e,i){this._zone=i,this._eventNameToPlugin=new Map,e.forEach(r=>r.manager=this),this._plugins=e.slice().reverse()}addEventListener(e,i,r){return this._findPluginFor(i).addEventListener(e,i,r)}addGlobalEventListener(e,i,r){return this._findPluginFor(i).addGlobalEventListener(e,i,r)}getZone(){return this._zone}_findPluginFor(e){const i=this._eventNameToPlugin.get(e);if(i)return i;const r=this._plugins;for(let s=0;s<r.length;s++){const o=r[s];if(o.supports(e))return this._eventNameToPlugin.set(e,o),o}throw new Error(`No event manager plugin found for event ${e}`)}}return t.\u0275fac=function(e){return new(e||t)(tn(Bh),tn(bn))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class lx{constructor(n){this._doc=n}addGlobalEventListener(n,e,i){const r=gl().getGlobalEventTarget(this._doc,n);if(!r)throw new Error(`Unsupported event target ${r} for event ${e}`);return this.addEventListener(r,e,i)}}let cx=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(e){const i=new Set;e.forEach(r=>{this._stylesSet.has(r)||(this._stylesSet.add(r),i.add(r))}),this.onStylesAdded(i)}onStylesAdded(e){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})(),bd=(()=>{class t extends cx{constructor(e){super(),this._doc=e,this._hostNodes=new Map,this._hostNodes.set(e.head,[])}_addStylesToHost(e,i,r){e.forEach(s=>{const o=this._doc.createElement("style");o.textContent=s,r.push(i.appendChild(o))})}addHost(e){const i=[];this._addStylesToHost(this._stylesSet,e,i),this._hostNodes.set(e,i)}removeHost(e){const i=this._hostNodes.get(e);i&&i.forEach(ux),this._hostNodes.delete(e)}onStylesAdded(e){this._hostNodes.forEach((i,r)=>{this._addStylesToHost(e,r,i)})}ngOnDestroy(){this._hostNodes.forEach(e=>e.forEach(ux))}}return t.\u0275fac=function(e){return new(e||t)(tn(Wr))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();function ux(t){gl().remove(t)}const d$={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},f$=/%COMP%/g;function zh(t,n,e){for(let i=0;i<n.length;i++){let r=n[i];Array.isArray(r)?zh(t,r,e):(r=r.replace(f$,t),e.push(r))}return e}function hx(t){return n=>{if("__ngUnwrap__"===n)return t;!1===t(n)&&(n.preventDefault(),n.returnValue=!1)}}let jh=(()=>{class t{constructor(e,i,r){this.eventManager=e,this.sharedStylesHost=i,this.appId=r,this.rendererByCompId=new Map,this.defaultRenderer=new h$(e)}createRenderer(e,i){if(!e||!i)return this.defaultRenderer;switch(i.encapsulation){case Hs.Emulated:{let r=this.rendererByCompId.get(i.id);return r||(r=new qF(this.eventManager,this.sharedStylesHost,i,this.appId),this.rendererByCompId.set(i.id,r)),r.applyToHost(e),r}case 1:case Hs.ShadowDom:return new WF(this.eventManager,this.sharedStylesHost,e,i);default:if(!this.rendererByCompId.has(i.id)){const r=zh(i.id,i.styles,[]);this.sharedStylesHost.addStyles(r),this.rendererByCompId.set(i.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(e){return new(e||t)(tn(Lh),tn(bd),tn(dd))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class h${constructor(n){this.eventManager=n,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(n,e){return e?document.createElementNS(d$[e]||e,n):document.createElement(n)}createComment(n){return document.createComment(n)}createText(n){return document.createTextNode(n)}appendChild(n,e){n.appendChild(e)}insertBefore(n,e,i){n&&n.insertBefore(e,i)}removeChild(n,e){n&&n.removeChild(e)}selectRootElement(n,e){let i="string"==typeof n?document.querySelector(n):n;if(!i)throw new Error(`The selector "${n}" did not match any elements`);return e||(i.textContent=""),i}parentNode(n){return n.parentNode}nextSibling(n){return n.nextSibling}setAttribute(n,e,i,r){if(r){e=r+":"+e;const s=d$[r];s?n.setAttributeNS(s,e,i):n.setAttribute(e,i)}else n.setAttribute(e,i)}removeAttribute(n,e,i){if(i){const r=d$[i];r?n.removeAttributeNS(r,e):n.removeAttribute(`${i}:${e}`)}else n.removeAttribute(e)}addClass(n,e){n.classList.add(e)}removeClass(n,e){n.classList.remove(e)}setStyle(n,e,i,r){r&(cs.DashCase|cs.Important)?n.style.setProperty(e,i,r&cs.Important?"important":""):n.style[e]=i}removeStyle(n,e,i){i&cs.DashCase?n.style.removeProperty(e):n.style[e]=""}setProperty(n,e,i){n[e]=i}setValue(n,e){n.nodeValue=e}listen(n,e,i){return"string"==typeof n?this.eventManager.addGlobalEventListener(n,e,hx(i)):this.eventManager.addEventListener(n,e,hx(i))}}class qF extends h${constructor(n,e,i,r){super(n),this.component=i;const s=zh(r+"-"+i.id,i.styles,[]);e.addStyles(s),this.contentAttr=function HF(t){return"_ngcontent-%COMP%".replace(f$,t)}(r+"-"+i.id),this.hostAttr=function VF(t){return"_nghost-%COMP%".replace(f$,t)}(r+"-"+i.id)}applyToHost(n){super.setAttribute(n,this.hostAttr,"")}createElement(n,e){const i=super.createElement(n,e);return super.setAttribute(i,this.contentAttr,""),i}}class WF extends h${constructor(n,e,i,r){super(n),this.sharedStylesHost=e,this.hostEl=i,this.shadowRoot=i.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const s=zh(r.id,r.styles,[]);for(let o=0;o<s.length;o++){const d=document.createElement("style");d.textContent=s[o],this.shadowRoot.appendChild(d)}}nodeOrShadowRoot(n){return n===this.hostEl?this.shadowRoot:n}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(n,e){return super.appendChild(this.nodeOrShadowRoot(n),e)}insertBefore(n,e,i){return super.insertBefore(this.nodeOrShadowRoot(n),e,i)}removeChild(n,e){return super.removeChild(this.nodeOrShadowRoot(n),e)}parentNode(n){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(n)))}}let KF=(()=>{class t extends lx{constructor(e){super(e)}supports(e){return!0}addEventListener(e,i,r){return e.addEventListener(i,r,!1),()=>this.removeEventListener(e,i,r)}removeEventListener(e,i,r){return e.removeEventListener(i,r)}}return t.\u0275fac=function(e){return new(e||t)(tn(Wr))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();const gx=["alt","control","meta","shift"],ZF={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},mx={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},XF={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let QF=(()=>{class t extends lx{constructor(e){super(e)}supports(e){return null!=t.parseEventName(e)}addEventListener(e,i,r){const s=t.parseEventName(i),o=t.eventCallback(s.fullKey,r,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>gl().onAndCancel(e,s.domEventName,o))}static parseEventName(e){const i=e.toLowerCase().split("."),r=i.shift();if(0===i.length||"keydown"!==r&&"keyup"!==r)return null;const s=t._normalizeKey(i.pop());let o="";if(gx.forEach($=>{const I=i.indexOf($);I>-1&&(i.splice(I,1),o+=$+".")}),o+=s,0!=i.length||0===s.length)return null;const d={};return d.domEventName=r,d.fullKey=o,d}static getEventFullKey(e){let i="",r=function JF(t){let n=t.key;if(null==n){if(n=t.keyIdentifier,null==n)return"Unidentified";n.startsWith("U+")&&(n=String.fromCharCode(parseInt(n.substring(2),16)),3===t.location&&mx.hasOwnProperty(n)&&(n=mx[n]))}return ZF[n]||n}(e);return r=r.toLowerCase()," "===r?r="space":"."===r&&(r="dot"),gx.forEach(s=>{s!=r&&XF[s](e)&&(i+=s+".")}),i+=r,i}static eventCallback(e,i,r){return s=>{t.getEventFullKey(s)===e&&r.runGuarded(()=>i(s))}}static _normalizeKey(e){return"esc"===e?"escape":e}}return t.\u0275fac=function(e){return new(e||t)(tn(Wr))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();const iR=S2(mN,"browser",[{provide:fd,useValue:sx},{provide:x2,useValue:function eR(){c$.makeCurrent(),u$.init()},multi:!0},{provide:Wr,useFactory:function nR(){return function FS(t){Pg=t}(document),document},deps:[]}]),rR=[{provide:Ym,useValue:"root"},{provide:qu,useFactory:function tR(){return new qu},deps:[]},{provide:Bh,useClass:KF,multi:!0,deps:[Wr,bn,fd]},{provide:Bh,useClass:QF,multi:!0,deps:[Wr]},{provide:jh,useClass:jh,deps:[Lh,bd,dd]},{provide:od,useExisting:jh},{provide:cx,useExisting:bd},{provide:bd,useClass:bd,deps:[Wr]},{provide:j_,useClass:j_,deps:[bn]},{provide:Lh,useClass:Lh,deps:[Bh,bn]},{provide:class NF{},useClass:zF,deps:[]}];let _x=(()=>{class t{constructor(e){if(e)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(e){return{ngModule:t,providers:[{provide:dd,useValue:e.appId},{provide:ax,useExisting:dd},LF]}}}return t.\u0275fac=function(e){return new(e||t)(tn(t,12))},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({providers:rR,imports:[rx,_N]}),t})();"undefined"!=typeof window&&window;let bx=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:function(e){let i=null;return i=e?new(e||t):tn(yx),i},providedIn:"root"}),t})(),yx=(()=>{class t extends bx{constructor(e){super(),this._doc=e}sanitize(e,i){if(null==i)return null;switch(e){case ni.NONE:return i;case ni.HTML:return ho(i,"HTML")?ls(i):Mv(this._doc,String(i)).toString();case ni.STYLE:return ho(i,"Style")?ls(i):i;case ni.SCRIPT:if(ho(i,"Script"))return ls(i);throw new Error("unsafe value used in a script context");case ni.URL:return Cv(i),ho(i,"URL")?ls(i):Uu(String(i));case ni.RESOURCE_URL:if(ho(i,"ResourceURL"))return ls(i);throw new Error("unsafe value used in a resource URL context (see https://g.co/ng/security#xss)");default:throw new Error(`Unexpected SecurityContext ${e} (see https://g.co/ng/security#xss)`)}}bypassSecurityTrustHtml(e){return function Yk(t){return new Vk(t)}(e)}bypassSecurityTrustStyle(e){return function Zk(t){return new Gk(t)}(e)}bypassSecurityTrustScript(e){return function Xk(t){return new qk(t)}(e)}bypassSecurityTrustUrl(e){return function Qk(t){return new Wk(t)}(e)}bypassSecurityTrustResourceUrl(e){return function Jk(t){return new Kk(t)}(e)}}return t.\u0275fac=function(e){return new(e||t)(tn(Wr))},t.\u0275prov=Zt({token:t,factory:function(e){let i=null;return i=e?new e:function pR(t){return new yx(t.get(Wr))}(tn(Gr)),i},providedIn:"root"}),t})();Y(5386);const{isArray:gR}=Array,{getPrototypeOf:mR,prototype:_R,keys:$R}=Object;function Cx(t){if(1===t.length){const n=t[0];if(gR(n))return{args:n,keys:null};if(function vR(t){return t&&"object"==typeof t&&mR(t)===_R}(n)){const e=$R(n);return{args:e.map(i=>n[i]),keys:e}}}return{args:t,keys:null}}const{isArray:bR}=Array;function yd(t){return ve(n=>function yR(t,n){return bR(n)?t(...n):t(n)}(t,n))}function xx(t,n){return t.reduce((e,i,r)=>(e[i]=n[r],e),{})}let wx=(()=>{class t{constructor(e,i){this._renderer=e,this._elementRef=i,this.onChange=r=>{},this.onTouched=()=>{}}setProperty(e,i){this._renderer.setProperty(this._elementRef.nativeElement,e,i)}registerOnTouched(e){this.onTouched=e}registerOnChange(e){this.onChange=e}setDisabledState(e){this.setProperty("disabled",e)}}return t.\u0275fac=function(e){return new(e||t)(Oe(fl),Oe(pi))},t.\u0275dir=Gt({type:t}),t})(),$l=(()=>{class t extends wx{}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,features:[Vn]}),t})();const bo=new In("NgValueAccessor"),xR={provide:bo,useExisting:zn(()=>Yr),multi:!0};let Yr=(()=>{class t extends $l{writeValue(e){this.setProperty("checked",e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["input","type","checkbox","formControlName",""],["input","type","checkbox","formControl",""],["input","type","checkbox","ngModel",""]],hostBindings:function(e,i){1&e&&Ie("change",function(s){return i.onChange(s.target.checked)})("blur",function(){return i.onTouched()})},features:[ii([xR]),Vn]}),t})();const wR={provide:bo,useExisting:zn(()=>si),multi:!0},Ex=new In("CompositionEventMode");let si=(()=>{class t extends wx{constructor(e,i,r){super(e,i),this._compositionMode=r,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function ER(){const t=gl()?gl().getUserAgent():"";return/android (\d+)/.test(t.toLowerCase())}())}writeValue(e){this.setProperty("value",null==e?"":e)}_handleInput(e){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(e)}_compositionStart(){this._composing=!0}_compositionEnd(e){this._composing=!1,this._compositionMode&&this.onChange(e)}}return t.\u0275fac=function(e){return new(e||t)(Oe(fl),Oe(pi),Oe(Ex,8))},t.\u0275dir=Gt({type:t,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(e,i){1&e&&Ie("input",function(s){return i._handleInput(s.target.value)})("blur",function(){return i.onTouched()})("compositionstart",function(){return i._compositionStart()})("compositionend",function(s){return i._compositionEnd(s.target.value)})},features:[ii([wR]),Vn]}),t})();function Ea(t){return null==t||0===t.length}function Tx(t){return null!=t&&"number"==typeof t.length}const $r=new In("NgValidators"),Ta=new In("NgAsyncValidators");function kx(t){return Ea(t.value)?{required:!0}:null}function Uh(t){return null}function Fx(t){return null!=t}function Rx(t){const n=ch(t)?Tr(t):t;return wy(n),n}function Ox(t){let n={};return t.forEach(e=>{n=null!=e?Object.assign(Object.assign({},n),e):n}),0===Object.keys(n).length?null:n}function Bx(t,n){return n.map(e=>e(t))}function Lx(t){return t.map(n=>function IR(t){return!t.validate}(n)?n:e=>n.validate(e))}function g$(t){return null!=t?function zx(t){if(!t)return null;const n=t.filter(Fx);return 0==n.length?null:function(e){return Ox(Bx(e,n))}}(Lx(t)):null}function m$(t){return null!=t?function jx(t){if(!t)return null;const n=t.filter(Fx);return 0==n.length?null:function(e){return function CR(...t){const n=el(t),{args:e,keys:i}=Cx(t),r=new f(s=>{const{length:o}=e;if(!o)return void s.complete();const d=new Array(o);let $=o,I=o;for(let Q=0;Q<o;Q++){let fe=!1;ur(e[Q]).subscribe(ie(s,_e=>{fe||(fe=!0,I--),d[Q]=_e},()=>$--,void 0,()=>{(!$||!fe)&&(I||s.next(i?xx(i,d):d),s.complete())}))}});return n?r.pipe(yd(n)):r}(Bx(e,n).map(Rx)).pipe(ve(Ox))}}(Lx(t)):null}function Ux(t,n){return null===t?[n]:Array.isArray(t)?[...t,n]:[t,n]}function _$(t){return t?Array.isArray(t)?t:[t]:[]}function Hh(t,n){return Array.isArray(t)?t.includes(n):t===n}function Gx(t,n){const e=_$(n);return _$(t).forEach(r=>{Hh(e,r)||e.push(r)}),e}function qx(t,n){return _$(n).filter(e=>!Hh(t,e))}class Wx{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(n){this._rawValidators=n||[],this._composedValidatorFn=g$(this._rawValidators)}_setAsyncValidators(n){this._rawAsyncValidators=n||[],this._composedAsyncValidatorFn=m$(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(n){this._onDestroyCallbacks.push(n)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(n=>n()),this._onDestroyCallbacks=[]}reset(n){this.control&&this.control.reset(n)}hasError(n,e){return!!this.control&&this.control.hasError(n,e)}getError(n,e){return this.control?this.control.getError(n,e):null}}class Ia extends Wx{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Fr extends Wx{get formDirective(){return null}get path(){return null}}class Kx{constructor(n){this._cd=n}is(n){var e,i,r;return"submitted"===n?!!(null===(e=this._cd)||void 0===e?void 0:e.submitted):!!(null===(r=null===(i=this._cd)||void 0===i?void 0:i.control)||void 0===r?void 0:r[n])}}let oi=(()=>{class t extends Kx{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Ia,2))},t.\u0275dir=Gt({type:t,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(e,i){2&e&&uh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))},features:[Vn]}),t})(),vl=(()=>{class t extends Kx{constructor(e){super(e)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Fr,10))},t.\u0275dir=Gt({type:t,selectors:[["","formGroupName",""],["","formArrayName",""],["","ngModelGroup",""],["","formGroup",""],["form",3,"ngNoForm",""],["","ngForm",""]],hostVars:16,hostBindings:function(e,i){2&e&&uh("ng-untouched",i.is("untouched"))("ng-touched",i.is("touched"))("ng-pristine",i.is("pristine"))("ng-dirty",i.is("dirty"))("ng-valid",i.is("valid"))("ng-invalid",i.is("invalid"))("ng-pending",i.is("pending"))("ng-submitted",i.is("submitted"))},features:[Vn]}),t})();function Cd(t,n){b$(t,n),n.valueAccessor.writeValue(t.value),function FR(t,n){n.valueAccessor.registerOnChange(e=>{t._pendingValue=e,t._pendingChange=!0,t._pendingDirty=!0,"change"===t.updateOn&&Zx(t,n)})}(t,n),function OR(t,n){const e=(i,r)=>{n.valueAccessor.writeValue(i),r&&n.viewToModelUpdate(i)};t.registerOnChange(e),n._registerOnDestroy(()=>{t._unregisterOnChange(e)})}(t,n),function RR(t,n){n.valueAccessor.registerOnTouched(()=>{t._pendingTouched=!0,"blur"===t.updateOn&&t._pendingChange&&Zx(t,n),"submit"!==t.updateOn&&t.markAsTouched()})}(t,n),function NR(t,n){if(n.valueAccessor.setDisabledState){const e=i=>{n.valueAccessor.setDisabledState(i)};t.registerOnDisabledChange(e),n._registerOnDestroy(()=>{t._unregisterOnDisabledChange(e)})}}(t,n)}function Wh(t,n){t.forEach(e=>{e.registerOnValidatorChange&&e.registerOnValidatorChange(n)})}function b$(t,n){const e=function Hx(t){return t._rawValidators}(t);null!==n.validator?t.setValidators(Ux(e,n.validator)):"function"==typeof e&&t.setValidators([e]);const i=function Vx(t){return t._rawAsyncValidators}(t);null!==n.asyncValidator?t.setAsyncValidators(Ux(i,n.asyncValidator)):"function"==typeof i&&t.setAsyncValidators([i]);const r=()=>t.updateValueAndValidity();Wh(n._rawValidators,r),Wh(n._rawAsyncValidators,r)}function Zx(t,n){t._pendingDirty&&t.markAsDirty(),t.setValue(t._pendingValue,{emitModelToViewChange:!1}),n.viewToModelUpdate(t._pendingValue),t._pendingChange=!1}function x$(t,n){const e=t.indexOf(n);e>-1&&t.splice(e,1)}const xd="VALID",Yh="INVALID",Kc="PENDING",wd="DISABLED";function E$(t){return(Zh(t)?t.validators:t)||null}function ew(t){return Array.isArray(t)?g$(t):t||null}function T$(t,n){return(Zh(n)?n.asyncValidators:t)||null}function tw(t){return Array.isArray(t)?m$(t):t||null}function Zh(t){return null!=t&&!Array.isArray(t)&&"object"==typeof t}const I$=t=>t instanceof k$;function iw(t){return(t=>t instanceof ow)(t)?t.value:t.getRawValue()}function rw(t,n){const e=I$(t),i=t.controls;if(!(e?Object.keys(i):i).length)throw new Tt(1e3,"");if(!i[n])throw new Tt(1001,"")}function sw(t,n){I$(t),t._forEachChild((i,r)=>{if(void 0===n[r])throw new Tt(1002,"")})}class S${constructor(n,e){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=n,this._rawAsyncValidators=e,this._composedValidatorFn=ew(this._rawValidators),this._composedAsyncValidatorFn=tw(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(n){this._rawValidators=this._composedValidatorFn=n}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(n){this._rawAsyncValidators=this._composedAsyncValidatorFn=n}get parent(){return this._parent}get valid(){return this.status===xd}get invalid(){return this.status===Yh}get pending(){return this.status==Kc}get disabled(){return this.status===wd}get enabled(){return this.status!==wd}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(n){this._rawValidators=n,this._composedValidatorFn=ew(n)}setAsyncValidators(n){this._rawAsyncValidators=n,this._composedAsyncValidatorFn=tw(n)}addValidators(n){this.setValidators(Gx(n,this._rawValidators))}addAsyncValidators(n){this.setAsyncValidators(Gx(n,this._rawAsyncValidators))}removeValidators(n){this.setValidators(qx(n,this._rawValidators))}removeAsyncValidators(n){this.setAsyncValidators(qx(n,this._rawAsyncValidators))}hasValidator(n){return Hh(this._rawValidators,n)}hasAsyncValidator(n){return Hh(this._rawAsyncValidators,n)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(n={}){this.touched=!0,this._parent&&!n.onlySelf&&this._parent.markAsTouched(n)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(n=>n.markAllAsTouched())}markAsUntouched(n={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(e=>{e.markAsUntouched({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}markAsDirty(n={}){this.pristine=!1,this._parent&&!n.onlySelf&&this._parent.markAsDirty(n)}markAsPristine(n={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(e=>{e.markAsPristine({onlySelf:!0})}),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}markAsPending(n={}){this.status=Kc,!1!==n.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!n.onlySelf&&this._parent.markAsPending(n)}disable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=wd,this.errors=null,this._forEachChild(i=>{i.disable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this._updateValue(),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!0))}enable(n={}){const e=this._parentMarkedDirty(n.onlySelf);this.status=xd,this._forEachChild(i=>{i.enable(Object.assign(Object.assign({},n),{onlySelf:!0}))}),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent}),this._updateAncestors(Object.assign(Object.assign({},n),{skipPristineCheck:e})),this._onDisabledChange.forEach(i=>i(!1))}_updateAncestors(n){this._parent&&!n.onlySelf&&(this._parent.updateValueAndValidity(n),n.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(n){this._parent=n}updateValueAndValidity(n={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===xd||this.status===Kc)&&this._runAsyncValidator(n.emitEvent)),!1!==n.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!n.onlySelf&&this._parent.updateValueAndValidity(n)}_updateTreeValidity(n={emitEvent:!0}){this._forEachChild(e=>e._updateTreeValidity(n)),this.updateValueAndValidity({onlySelf:!0,emitEvent:n.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?wd:xd}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(n){if(this.asyncValidator){this.status=Kc,this._hasOwnPendingAsyncValidator=!0;const e=Rx(this.asyncValidator(this));this._asyncValidationSubscription=e.subscribe(i=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(i,{emitEvent:n})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(n,e={}){this.errors=n,this._updateControlsErrors(!1!==e.emitEvent)}get(n){return function jR(t,n,e){if(null==n||(Array.isArray(n)||(n=n.split(e)),Array.isArray(n)&&0===n.length))return null;let i=t;return n.forEach(r=>{i=I$(i)?i.controls.hasOwnProperty(r)?i.controls[r]:null:(t=>t instanceof HR)(i)&&i.at(r)||null}),i}(this,n,".")}getError(n,e){const i=e?this.get(e):this;return i&&i.errors?i.errors[n]:null}hasError(n,e){return!!this.getError(n,e)}get root(){let n=this;for(;n._parent;)n=n._parent;return n}_updateControlsErrors(n){this.status=this._calculateStatus(),n&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(n)}_initObservables(){this.valueChanges=new vn,this.statusChanges=new vn}_calculateStatus(){return this._allControlsDisabled()?wd:this.errors?Yh:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Kc)?Kc:this._anyControlsHaveStatus(Yh)?Yh:xd}_anyControlsHaveStatus(n){return this._anyControls(e=>e.status===n)}_anyControlsDirty(){return this._anyControls(n=>n.dirty)}_anyControlsTouched(){return this._anyControls(n=>n.touched)}_updatePristine(n={}){this.pristine=!this._anyControlsDirty(),this._parent&&!n.onlySelf&&this._parent._updatePristine(n)}_updateTouched(n={}){this.touched=this._anyControlsTouched(),this._parent&&!n.onlySelf&&this._parent._updateTouched(n)}_isBoxedValue(n){return"object"==typeof n&&null!==n&&2===Object.keys(n).length&&"value"in n&&"disabled"in n}_registerOnCollectionChange(n){this._onCollectionChange=n}_setUpdateStrategy(n){Zh(n)&&null!=n.updateOn&&(this._updateOn=n.updateOn)}_parentMarkedDirty(n){return!n&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class ow extends S${constructor(n=null,e,i){super(E$(e),T$(i,e)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(n),this._setUpdateStrategy(e),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Zh(e)&&e.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(n)?n.value:n)}setValue(n,e={}){this.value=this._pendingValue=n,this._onChange.length&&!1!==e.emitModelToViewChange&&this._onChange.forEach(i=>i(this.value,!1!==e.emitViewToModelChange)),this.updateValueAndValidity(e)}patchValue(n,e={}){this.setValue(n,e)}reset(n=this.defaultValue,e={}){this._applyFormState(n),this.markAsPristine(e),this.markAsUntouched(e),this.setValue(this.value,e),this._pendingChange=!1}_updateValue(){}_anyControls(n){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(n){this._onChange.push(n)}_unregisterOnChange(n){x$(this._onChange,n)}registerOnDisabledChange(n){this._onDisabledChange.push(n)}_unregisterOnDisabledChange(n){x$(this._onDisabledChange,n)}_forEachChild(n){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(n){this._isBoxedValue(n)?(this.value=this._pendingValue=n.value,n.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=n}}class k$ extends S${constructor(n,e,i){super(E$(e),T$(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(n,e){return this.controls[n]?this.controls[n]:(this.controls[n]=e,e.setParent(this),e._registerOnCollectionChange(this._onCollectionChange),e)}addControl(n,e,i={}){this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}removeControl(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),delete this.controls[n],e&&this.registerControl(n,e),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}contains(n){return this.controls.hasOwnProperty(n)&&this.controls[n].enabled}setValue(n,e={}){sw(this,n),Object.keys(n).forEach(i=>{rw(this,i),this.controls[i].setValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(Object.keys(n).forEach(i=>{this.controls[i]&&this.controls[i].patchValue(n[i],{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n={},e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this._reduceChildren({},(n,e,i)=>(n[i]=iw(e),n))}_syncPendingControls(){let n=this._reduceChildren(!1,(e,i)=>!!i._syncPendingControls()||e);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){Object.keys(this.controls).forEach(e=>{const i=this.controls[e];i&&n(i,e)})}_setUpControls(){this._forEachChild(n=>{n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(n){for(const e of Object.keys(this.controls)){const i=this.controls[e];if(this.contains(e)&&n(i))return!0}return!1}_reduceValue(){return this._reduceChildren({},(n,e,i)=>((e.enabled||this.disabled)&&(n[i]=e.value),n))}_reduceChildren(n,e){let i=n;return this._forEachChild((r,s)=>{i=e(i,r,s)}),i}_allControlsDisabled(){for(const n of Object.keys(this.controls))if(this.controls[n].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class HR extends S${constructor(n,e,i){super(E$(e),T$(i,e)),this.controls=n,this._initObservables(),this._setUpdateStrategy(e),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(n){return this.controls[n]}push(n,e={}){this.controls.push(n),this._registerControl(n),this.updateValueAndValidity({emitEvent:e.emitEvent}),this._onCollectionChange()}insert(n,e,i={}){this.controls.splice(n,0,e),this._registerControl(e),this.updateValueAndValidity({emitEvent:i.emitEvent})}removeAt(n,e={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),this.updateValueAndValidity({emitEvent:e.emitEvent})}setControl(n,e,i={}){this.controls[n]&&this.controls[n]._registerOnCollectionChange(()=>{}),this.controls.splice(n,1),e&&(this.controls.splice(n,0,e),this._registerControl(e)),this.updateValueAndValidity({emitEvent:i.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(n,e={}){sw(this,n),n.forEach((i,r)=>{rw(this,r),this.at(r).setValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e)}patchValue(n,e={}){null!=n&&(n.forEach((i,r)=>{this.at(r)&&this.at(r).patchValue(i,{onlySelf:!0,emitEvent:e.emitEvent})}),this.updateValueAndValidity(e))}reset(n=[],e={}){this._forEachChild((i,r)=>{i.reset(n[r],{onlySelf:!0,emitEvent:e.emitEvent})}),this._updatePristine(e),this._updateTouched(e),this.updateValueAndValidity(e)}getRawValue(){return this.controls.map(n=>iw(n))}clear(n={}){this.controls.length<1||(this._forEachChild(e=>e._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:n.emitEvent}))}_syncPendingControls(){let n=this.controls.reduce((e,i)=>!!i._syncPendingControls()||e,!1);return n&&this.updateValueAndValidity({onlySelf:!0}),n}_forEachChild(n){this.controls.forEach((e,i)=>{n(e,i)})}_updateValue(){this.value=this.controls.filter(n=>n.enabled||this.disabled).map(n=>n.value)}_anyControls(n){return this.controls.some(e=>e.enabled&&n(e))}_setUpControls(){this._forEachChild(n=>this._registerControl(n))}_allControlsDisabled(){for(const n of this.controls)if(n.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(n){n.setParent(this),n._registerOnCollectionChange(this._onCollectionChange)}}const VR={provide:Fr,useExisting:zn(()=>Qo)},Ed=(()=>Promise.resolve(null))();let Qo=(()=>{class t extends Fr{constructor(e,i){super(),this.submitted=!1,this._directives=new Set,this.ngSubmit=new vn,this.form=new k$({},g$(e),m$(i))}ngAfterViewInit(){this._setUpdateStrategy()}get formDirective(){return this}get control(){return this.form}get path(){return[]}get controls(){return this.form.controls}addControl(e){Ed.then(()=>{const i=this._findContainer(e.path);e.control=i.registerControl(e.name,e.control),Cd(e.control,e),e.control.updateValueAndValidity({emitEvent:!1}),this._directives.add(e)})}getControl(e){return this.form.get(e.path)}removeControl(e){Ed.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name),this._directives.delete(e)})}addFormGroup(e){Ed.then(()=>{const i=this._findContainer(e.path),r=new k$({});(function Xx(t,n){b$(t,n)})(r,e),i.registerControl(e.name,r),r.updateValueAndValidity({emitEvent:!1})})}removeFormGroup(e){Ed.then(()=>{const i=this._findContainer(e.path);i&&i.removeControl(e.name)})}getFormGroup(e){return this.form.get(e.path)}updateModel(e,i){Ed.then(()=>{this.form.get(e.path).setValue(i)})}setValue(e){this.control.setValue(e)}onSubmit(e){return this.submitted=!0,function Jx(t,n){t._syncPendingControls(),n.forEach(e=>{const i=e.control;"submit"===i.updateOn&&i._pendingChange&&(e.viewToModelUpdate(i._pendingValue),i._pendingChange=!1)})}(this.form,this._directives),this.ngSubmit.emit(e),!1}onReset(){this.resetForm()}resetForm(e){this.form.reset(e),this.submitted=!1}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.form._updateOn=this.options.updateOn)}_findContainer(e){return e.pop(),e.length?this.form.get(e):this.form}}return t.\u0275fac=function(e){return new(e||t)(Oe($r,10),Oe(Ta,10))},t.\u0275dir=Gt({type:t,selectors:[["form",3,"ngNoForm","",3,"formGroup",""],["ng-form"],["","ngForm",""]],hostBindings:function(e,i){1&e&&Ie("submit",function(s){return i.onSubmit(s)})("reset",function(){return i.onReset()})},inputs:{options:["ngFormOptions","options"]},outputs:{ngSubmit:"ngSubmit"},exportAs:["ngForm"],features:[ii([VR]),Vn]}),t})();const qR={provide:Ia,useExisting:zn(()=>ei)},cw=(()=>Promise.resolve(null))();let ei=(()=>{class t extends Ia{constructor(e,i,r,s,o){super(),this._changeDetectorRef=o,this.control=new ow,this._registered=!1,this.update=new vn,this._parent=e,this._setValidators(i),this._setAsyncValidators(r),this.valueAccessor=function C$(t,n){if(!n)return null;let e,i,r;return Array.isArray(n),n.forEach(s=>{s.constructor===si?e=s:function zR(t){return Object.getPrototypeOf(t.constructor)===$l}(s)?i=s:r=s}),r||i||e||null}(0,s)}ngOnChanges(e){if(this._checkForErrors(),!this._registered||"name"in e){if(this._registered&&(this._checkName(),this.formDirective)){const i=e.name.previousValue;this.formDirective.removeControl({name:i,path:this._getPath(i)})}this._setUpControl()}"isDisabled"in e&&this._updateDisabled(e),function y$(t,n){if(!t.hasOwnProperty("model"))return!1;const e=t.model;return!!e.isFirstChange()||!Object.is(n,e.currentValue)}(e,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(e){this.viewModel=e,this.update.emit(e)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Cd(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(e){cw.then(()=>{var i;this.control.setValue(e,{emitViewToModelChange:!1}),null===(i=this._changeDetectorRef)||void 0===i||i.markForCheck()})}_updateDisabled(e){const i=e.isDisabled.currentValue,r=""===i||i&&"false"!==i;cw.then(()=>{var s;r&&!this.control.disabled?this.control.disable():!r&&this.control.disabled&&this.control.enable(),null===(s=this._changeDetectorRef)||void 0===s||s.markForCheck()})}_getPath(e){return this._parent?function Gh(t,n){return[...n.path,t]}(e,this._parent):[e]}}return t.\u0275fac=function(e){return new(e||t)(Oe(Fr,9),Oe($r,10),Oe(Ta,10),Oe(bo,10),Oe(Di,8))},t.\u0275dir=Gt({type:t,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[ii([qR]),Vn,Ws]}),t})(),bl=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Gt({type:t,selectors:[["form",3,"ngNoForm","",3,"ngNativeValidate",""]],hostAttrs:["novalidate",""]}),t})();const WR={provide:bo,useExisting:zn(()=>ds),multi:!0};let ds=(()=>{class t extends $l{writeValue(e){this.setProperty("value",null==e?"":e)}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(e,i){1&e&&Ie("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[ii([WR]),Vn]}),t})();const KR={provide:bo,useExisting:zn(()=>Sa),multi:!0};let uw=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({}),t})(),YR=(()=>{class t{constructor(){this._accessors=[]}add(e,i){this._accessors.push([e,i])}remove(e){for(let i=this._accessors.length-1;i>=0;--i)if(this._accessors[i][1]===e)return void this._accessors.splice(i,1)}select(e){this._accessors.forEach(i=>{this._isSameGroup(i,e)&&i[1]!==e&&i[1].fireUncheck(e.value)})}_isSameGroup(e,i){return!!e[0].control&&e[0]._parent===i._control._parent&&e[1].name===i.name}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:uw}),t})(),Sa=(()=>{class t extends $l{constructor(e,i,r,s){super(e,i),this._registry=r,this._injector=s,this.onChange=()=>{}}ngOnInit(){this._control=this._injector.get(Ia),this._checkName(),this._registry.add(this._control,this)}ngOnDestroy(){this._registry.remove(this)}writeValue(e){this._state=e===this.value,this.setProperty("checked",this._state)}registerOnChange(e){this._fn=e,this.onChange=()=>{e(this.value),this._registry.select(this)}}fireUncheck(e){this.writeValue(e)}_checkName(){!this.name&&this.formControlName&&(this.name=this.formControlName)}}return t.\u0275fac=function(e){return new(e||t)(Oe(fl),Oe(pi),Oe(YR),Oe(Gr))},t.\u0275dir=Gt({type:t,selectors:[["input","type","radio","formControlName",""],["input","type","radio","formControl",""],["input","type","radio","ngModel",""]],hostBindings:function(e,i){1&e&&Ie("change",function(){return i.onChange()})("blur",function(){return i.onTouched()})},inputs:{name:"name",formControlName:"formControlName",value:"value"},features:[ii([KR]),Vn]}),t})();const ZR={provide:bo,useExisting:zn(()=>fs),multi:!0};let fs=(()=>{class t extends $l{writeValue(e){this.setProperty("value",parseFloat(e))}registerOnChange(e){this.onChange=i=>{e(""==i?null:parseFloat(i))}}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["input","type","range","formControlName",""],["input","type","range","formControl",""],["input","type","range","ngModel",""]],hostBindings:function(e,i){1&e&&Ie("change",function(s){return i.onChange(s.target.value)})("input",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},features:[ii([ZR]),Vn]}),t})();const nO={provide:bo,useExisting:zn(()=>Zr),multi:!0};function gw(t,n){return null==t?`${n}`:(n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let Zr=(()=>{class t extends $l{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){this.value=e;const r=gw(this._getOptionId(e),e);this.setProperty("value",r)}registerOnChange(e){this.onChange=i=>{this.value=this._getOptionValue(i),e(this.value)}}_registerOption(){return(this._idCounter++).toString()}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i),e))return i;return null}_getOptionValue(e){const i=function iO(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i):e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["select","formControlName","",3,"multiple",""],["select","formControl","",3,"multiple",""],["select","ngModel","",3,"multiple",""]],hostBindings:function(e,i){1&e&&Ie("change",function(s){return i.onChange(s.target.value)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ii([nO]),Vn]}),t})(),Rr=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption())}set ngValue(e){null!=this._select&&(this._select._optionMap.set(this.id,e),this._setElementValue(gw(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._setElementValue(e),this._select&&this._select.writeValue(this._select.value)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Oe(pi),Oe(fl),Oe(Zr,9))},t.\u0275dir=Gt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();const rO={provide:bo,useExisting:zn(()=>P$),multi:!0};function mw(t,n){return null==t?`${n}`:("string"==typeof n&&(n=`'${n}'`),n&&"object"==typeof n&&(n="Object"),`${t}: ${n}`.slice(0,50))}let P$=(()=>{class t extends $l{constructor(){super(...arguments),this._optionMap=new Map,this._idCounter=0,this._compareWith=Object.is}set compareWith(e){this._compareWith=e}writeValue(e){let i;if(this.value=e,Array.isArray(e)){const r=e.map(s=>this._getOptionId(s));i=(s,o)=>{s._setSelected(r.indexOf(o.toString())>-1)}}else i=(r,s)=>{r._setSelected(!1)};this._optionMap.forEach(i)}registerOnChange(e){this.onChange=i=>{const r=[],s=i.selectedOptions;if(void 0!==s){const o=s;for(let d=0;d<o.length;d++){const I=this._getOptionValue(o[d].value);r.push(I)}}else{const o=i.options;for(let d=0;d<o.length;d++){const $=o[d];if($.selected){const I=this._getOptionValue($.value);r.push(I)}}}this.value=r,e(r)}}_registerOption(e){const i=(this._idCounter++).toString();return this._optionMap.set(i,e),i}_getOptionId(e){for(const i of Array.from(this._optionMap.keys()))if(this._compareWith(this._optionMap.get(i)._value,e))return i;return null}_getOptionValue(e){const i=function sO(t){return t.split(":")[0]}(e);return this._optionMap.has(i)?this._optionMap.get(i)._value:e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["select","multiple","","formControlName",""],["select","multiple","","formControl",""],["select","multiple","","ngModel",""]],hostBindings:function(e,i){1&e&&Ie("change",function(s){return i.onChange(s.target)})("blur",function(){return i.onTouched()})},inputs:{compareWith:"compareWith"},features:[ii([rO]),Vn]}),t})(),Or=(()=>{class t{constructor(e,i,r){this._element=e,this._renderer=i,this._select=r,this._select&&(this.id=this._select._registerOption(this))}set ngValue(e){null!=this._select&&(this._value=e,this._setElementValue(mw(this.id,e)),this._select.writeValue(this._select.value))}set value(e){this._select?(this._value=e,this._setElementValue(mw(this.id,e)),this._select.writeValue(this._select.value)):this._setElementValue(e)}_setElementValue(e){this._renderer.setProperty(this._element.nativeElement,"value",e)}_setSelected(e){this._renderer.setProperty(this._element.nativeElement,"selected",e)}ngOnDestroy(){this._select&&(this._select._optionMap.delete(this.id),this._select.writeValue(this._select.value))}}return t.\u0275fac=function(e){return new(e||t)(Oe(pi),Oe(fl),Oe(P$,9))},t.\u0275dir=Gt({type:t,selectors:[["option"]],inputs:{ngValue:"ngValue",value:"value"}}),t})();function _w(t){return"number"==typeof t?t:parseInt(t,10)}function $w(t){return"number"==typeof t?t:parseFloat(t)}let yl=(()=>{class t{constructor(){this._validator=Uh}ngOnChanges(e){if(this.inputName in e){const i=this.normalizeInput(e[this.inputName].currentValue);this._enabled=this.enabled(i),this._validator=this._enabled?this.createValidator(i):Uh,this._onChange&&this._onChange()}}validate(e){return this._validator(e)}registerOnValidatorChange(e){this._onChange=e}enabled(e){return null!=e}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275dir=Gt({type:t,features:[Ws]}),t})();const aO={provide:$r,useExisting:zn(()=>yo),multi:!0};let yo=(()=>{class t extends yl{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=e=>$w(e),this.createValidator=e=>function Sx(t){return n=>{if(Ea(n.value)||Ea(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e>t?{max:{max:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("max",i._enabled?i.max:null)},inputs:{max:"max"},features:[ii([aO]),Vn]}),t})();const lO={provide:$r,useExisting:zn(()=>Co),multi:!0};let Co=(()=>{class t extends yl{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=e=>$w(e),this.createValidator=e=>function Ix(t){return n=>{if(Ea(n.value)||Ea(t))return null;const e=parseFloat(n.value);return!isNaN(e)&&e<t?{min:{min:t,actual:n.value}}:null}}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("min",i._enabled?i.min:null)},inputs:{min:"min"},features:[ii([lO]),Vn]}),t})();const cO={provide:$r,useExisting:zn(()=>Xh),multi:!0};let Xh=(()=>{class t extends yl{constructor(){super(...arguments),this.inputName="required",this.normalizeInput=e=>function oO(t){return null!=t&&!1!==t&&"false"!=`${t}`}(e),this.createValidator=e=>kx}enabled(e){return e}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["","required","","formControlName","",3,"type","checkbox"],["","required","","formControl","",3,"type","checkbox"],["","required","","ngModel","",3,"type","checkbox"]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("required",i._enabled?"":null)},inputs:{required:"required"},features:[ii([cO]),Vn]}),t})();const fO={provide:$r,useExisting:zn(()=>N$),multi:!0};let N$=(()=>{class t extends yl{constructor(){super(...arguments),this.inputName="minlength",this.normalizeInput=e=>_w(e),this.createValidator=e=>function Ax(t){return n=>Ea(n.value)||!Tx(n.value)?null:n.value.length<t?{minlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["","minlength","","formControlName",""],["","minlength","","formControl",""],["","minlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("minlength",i._enabled?i.minlength:null)},inputs:{minlength:"minlength"},features:[ii([fO]),Vn]}),t})();const hO={provide:$r,useExisting:zn(()=>F$),multi:!0};let F$=(()=>{class t extends yl{constructor(){super(...arguments),this.inputName="maxlength",this.normalizeInput=e=>_w(e),this.createValidator=e=>function Px(t){return n=>Tx(n.value)&&n.value.length>t?{maxlength:{requiredLength:t,actualLength:n.value.length}}:null}(e)}}return t.\u0275fac=function(){let n;return function(i){return(n||(n=gr(t)))(i||t)}}(),t.\u0275dir=Gt({type:t,selectors:[["","maxlength","","formControlName",""],["","maxlength","","formControl",""],["","maxlength","","ngModel",""]],hostVars:1,hostBindings:function(e,i){2&e&&Rt("maxlength",i._enabled?i.maxlength:null)},inputs:{maxlength:"maxlength"},features:[ii([hO]),Vn]}),t})(),gO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({imports:[[uw]]}),t})(),mO=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({imports:[gO]}),t})();class Cw{}const Jo="*";function yn(t,n){return{type:7,name:t,definitions:n,options:{}}}function Dt(t,n=null){return{type:4,styles:n,timings:t}}function xw(t,n=null){return{type:2,steps:t,options:n}}function We(t){return{type:6,styles:t,offset:null}}function Qh(t,n,e){return{type:0,name:t,styles:n,options:e}}function Qt(t){return{type:5,steps:t}}function Nt(t,n,e=null){return{type:1,expr:t,animation:n,options:e}}function ww(t){Promise.resolve(null).then(t)}class Td{constructor(n=0,e=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=n+e}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}onStart(n){this._onStartFns.push(n)}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){ww(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(n=>n()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(n){this._position=this.totalTime?n*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class Ew{constructor(n){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=n;let e=0,i=0,r=0;const s=this.players.length;0==s?ww(()=>this._onFinish()):this.players.forEach(o=>{o.onDone(()=>{++e==s&&this._onFinish()}),o.onDestroy(()=>{++i==s&&this._onDestroy()}),o.onStart(()=>{++r==s&&this._onStart()})}),this.totalTime=this.players.reduce((o,d)=>Math.max(o,d.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this.players.forEach(n=>n.init())}onStart(n){this._onStartFns.push(n)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(n=>n()),this._onStartFns=[])}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(n=>n.play())}pause(){this.players.forEach(n=>n.pause())}restart(){this.players.forEach(n=>n.restart())}finish(){this._onFinish(),this.players.forEach(n=>n.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(n=>n.destroy()),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}reset(){this.players.forEach(n=>n.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(n){const e=n*this.totalTime;this.players.forEach(i=>{const r=i.totalTime?Math.min(1,e/i.totalTime):1;i.setPosition(r)})}getPosition(){const n=this.players.reduce((e,i)=>null===e||i.totalTime>e.totalTime?i:e,null);return null!=n?n.getPosition():0}beforeDestroy(){this.players.forEach(n=>{n.beforeDestroy&&n.beforeDestroy()})}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}const Sn=!1;function Tw(t){return new Tt(3e3,Sn)}function XO(){return"undefined"!=typeof window&&void 0!==window.document}function O$(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function ka(t){switch(t.length){case 0:return new Td;case 1:return t[0];default:return new Ew(t)}}function Iw(t,n,e,i,r={},s={}){const o=[],d=[];let $=-1,I=null;if(i.forEach(Q=>{const fe=Q.offset,_e=fe==$,Ce=_e&&I||{};Object.keys(Q).forEach(Ee=>{let Re=Ee,Le=Q[Ee];if("offset"!==Ee)switch(Re=n.normalizePropertyName(Re,o),Le){case"!":Le=r[Ee];break;case Jo:Le=s[Ee];break;default:Le=n.normalizeStyleValue(Ee,Re,Le,o)}Ce[Re]=Le}),_e||d.push(Ce),I=Ce,$=fe}),o.length)throw function zO(t){return new Tt(3502,Sn)}();return d}function B$(t,n,e,i){switch(n){case"start":t.onStart(()=>i(e&&L$(e,"start",t)));break;case"done":t.onDone(()=>i(e&&L$(e,"done",t)));break;case"destroy":t.onDestroy(()=>i(e&&L$(e,"destroy",t)))}}function L$(t,n,e){const i=e.totalTime,s=z$(t.element,t.triggerName,t.fromState,t.toState,n||t.phaseName,null==i?t.totalTime:i,!!e.disabled),o=t._data;return null!=o&&(s._data=o),s}function z$(t,n,e,i,r="",s=0,o){return{element:t,triggerName:n,fromState:e,toState:i,phaseName:r,totalTime:s,disabled:!!o}}function hs(t,n,e){let i;return t instanceof Map?(i=t.get(n),i||t.set(n,i=e)):(i=t[n],i||(i=t[n]=e)),i}function Sw(t){const n=t.indexOf(":");return[t.substring(1,n),t.substr(n+1)]}let j$=(t,n)=>!1,kw=(t,n,e)=>[],Mw=null;function U$(t){const n=t.parentNode||t.host;return n===Mw?null:n}(O$()||"undefined"!=typeof Element)&&(XO()?(Mw=(()=>document.documentElement)(),j$=(t,n)=>{for(;n;){if(n===t)return!0;n=U$(n)}return!1}):j$=(t,n)=>t.contains(n),kw=(t,n,e)=>{if(e)return Array.from(t.querySelectorAll(n));const i=t.querySelector(n);return i?[i]:[]});let Cl=null,Dw=!1;function Aw(t){Cl||(Cl=function JO(){return"undefined"!=typeof document?document.body:null}()||{},Dw=!!Cl.style&&"WebkitAppearance"in Cl.style);let n=!0;return Cl.style&&!function QO(t){return"ebkit"==t.substring(1,6)}(t)&&(n=t in Cl.style,!n&&Dw&&(n="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in Cl.style)),n}const Pw=j$,Nw=kw;let Fw=(()=>{class t{validateStyleProperty(e){return Aw(e)}matchesElement(e,i){return!1}containsElement(e,i){return Pw(e,i)}getParentElement(e){return U$(e)}query(e,i,r){return Nw(e,i,r)}computeStyle(e,i,r){return r||""}animate(e,i,r,s,o,d=[],$){return new Td(r,s)}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})(),H$=(()=>{class t{}return t.NOOP=new Fw,t})();const V$="ng-enter",ep="ng-leave",tp="ng-trigger",np=".ng-trigger",Ow="ng-animating",G$=".ng-animating";function xl(t){if("number"==typeof t)return t;const n=t.match(/^(-?[\.\d]+)(m?s)/);return!n||n.length<2?0:q$(parseFloat(n[1]),n[2])}function q$(t,n){return"s"===n?1e3*t:t}function ip(t,n,e){return t.hasOwnProperty("duration")?t:function n6(t,n,e){let r,s=0,o="";if("string"==typeof t){const d=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===d)return n.push(Tw()),{duration:0,delay:0,easing:""};r=q$(parseFloat(d[1]),d[2]);const $=d[3];null!=$&&(s=q$(parseFloat($),d[4]));const I=d[5];I&&(o=I)}else r=t;if(!e){let d=!1,$=n.length;r<0&&(n.push(function $O(){return new Tt(3100,Sn)}()),d=!0),s<0&&(n.push(function vO(){return new Tt(3101,Sn)}()),d=!0),d&&n.splice($,0,Tw())}return{duration:r,delay:s,easing:o}}(t,n,e)}function Yc(t,n={}){return Object.keys(t).forEach(e=>{n[e]=t[e]}),n}function Ma(t,n,e={}){if(n)for(let i in t)e[i]=t[i];else Yc(t,e);return e}function Lw(t,n,e){return e?n+":"+e+";":""}function zw(t){let n="";for(let e=0;e<t.style.length;e++){const i=t.style.item(e);n+=Lw(0,i,t.style.getPropertyValue(i))}for(const e in t.style)t.style.hasOwnProperty(e)&&!e.startsWith("_")&&(n+=Lw(0,s6(e),t.style[e]));t.setAttribute("style",n)}function xo(t,n,e){t.style&&(Object.keys(n).forEach(i=>{const r=K$(i);e&&!e.hasOwnProperty(i)&&(e[i]=t.style[r]),t.style[r]=n[i]}),O$()&&zw(t))}function wl(t,n){t.style&&(Object.keys(n).forEach(e=>{const i=K$(e);t.style[i]=""}),O$()&&zw(t))}function Id(t){return Array.isArray(t)?1==t.length?t[0]:xw(t):t}const W$=new RegExp("{{\\s*(.+?)\\s*}}","g");function jw(t){let n=[];if("string"==typeof t){let e;for(;e=W$.exec(t);)n.push(e[1]);W$.lastIndex=0}return n}function rp(t,n,e){const i=t.toString(),r=i.replace(W$,(s,o)=>{let d=n[o];return n.hasOwnProperty(o)||(e.push(function yO(t){return new Tt(3003,Sn)}()),d=""),d.toString()});return r==i?t:r}function sp(t){const n=[];let e=t.next();for(;!e.done;)n.push(e.value),e=t.next();return n}const r6=/-+([a-z0-9])/g;function K$(t){return t.replace(r6,(...n)=>n[1].toUpperCase())}function s6(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function ps(t,n,e){switch(n.type){case 7:return t.visitTrigger(n,e);case 0:return t.visitState(n,e);case 1:return t.visitTransition(n,e);case 2:return t.visitSequence(n,e);case 3:return t.visitGroup(n,e);case 4:return t.visitAnimate(n,e);case 5:return t.visitKeyframes(n,e);case 6:return t.visitStyle(n,e);case 8:return t.visitReference(n,e);case 9:return t.visitAnimateChild(n,e);case 10:return t.visitAnimateRef(n,e);case 11:return t.visitQuery(n,e);case 12:return t.visitStagger(n,e);default:throw function CO(t){return new Tt(3004,Sn)}()}}function Uw(t,n){return window.getComputedStyle(t)[n]}function d6(t,n){const e=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(i=>function f6(t,n,e){if(":"==t[0]){const $=function h6(t,n){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(e,i)=>parseFloat(i)>parseFloat(e);case":decrement":return(e,i)=>parseFloat(i)<parseFloat(e);default:return n.push(function RO(t){return new Tt(3016,Sn)}()),"* => *"}}(t,e);if("function"==typeof $)return void n.push($);t=$}const i=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==i||i.length<4)return e.push(function FO(t){return new Tt(3015,Sn)}()),n;const r=i[1],s=i[2],o=i[3];n.push(Hw(r,o));"<"==s[0]&&!("*"==r&&"*"==o)&&n.push(Hw(o,r))}(i,e,n)):e.push(t),e}const cp=new Set(["true","1"]),up=new Set(["false","0"]);function Hw(t,n){const e=cp.has(t)||up.has(t),i=cp.has(n)||up.has(n);return(r,s)=>{let o="*"==t||t==r,d="*"==n||n==s;return!o&&e&&"boolean"==typeof r&&(o=r?cp.has(t):up.has(t)),!d&&i&&"boolean"==typeof s&&(d=s?cp.has(n):up.has(n)),o&&d}}const p6=new RegExp("s*:selfs*,?","g");function Y$(t,n,e,i){return new g6(t).build(n,e,i)}class g6{constructor(n){this._driver=n}build(n,e,i){const r=new $6(e);this._resetContextStyleTimingState(r);const s=ps(this,Id(n),r);return r.unsupportedCSSPropertiesFound.size&&r.unsupportedCSSPropertiesFound.keys(),s}_resetContextStyleTimingState(n){n.currentQuerySelector="",n.collectedStyles={},n.collectedStyles[""]={},n.currentTime=0}visitTrigger(n,e){let i=e.queryCount=0,r=e.depCount=0;const s=[],o=[];return"@"==n.name.charAt(0)&&e.errors.push(function wO(){return new Tt(3006,Sn)}()),n.definitions.forEach(d=>{if(this._resetContextStyleTimingState(e),0==d.type){const $=d,I=$.name;I.toString().split(/\s*,\s*/).forEach(Q=>{$.name=Q,s.push(this.visitState($,e))}),$.name=I}else if(1==d.type){const $=this.visitTransition(d,e);i+=$.queryCount,r+=$.depCount,o.push($)}else e.errors.push(function EO(){return new Tt(3007,Sn)}())}),{type:7,name:n.name,states:s,transitions:o,queryCount:i,depCount:r,options:null}}visitState(n,e){const i=this.visitStyle(n.styles,e),r=n.options&&n.options.params||null;if(i.containsDynamicStyles){const s=new Set,o=r||{};i.styles.forEach(d=>{if(dp(d)){const $=d;Object.keys($).forEach(I=>{jw($[I]).forEach(Q=>{o.hasOwnProperty(Q)||s.add(Q)})})}}),s.size&&(sp(s.values()),e.errors.push(function TO(t,n){return new Tt(3008,Sn)}()))}return{type:0,name:n.name,style:i,options:r?{params:r}:null}}visitTransition(n,e){e.queryCount=0,e.depCount=0;const i=ps(this,Id(n.animation),e);return{type:1,matchers:d6(n.expr,e.errors),animation:i,queryCount:e.queryCount,depCount:e.depCount,options:El(n.options)}}visitSequence(n,e){return{type:2,steps:n.steps.map(i=>ps(this,i,e)),options:El(n.options)}}visitGroup(n,e){const i=e.currentTime;let r=0;const s=n.steps.map(o=>{e.currentTime=i;const d=ps(this,o,e);return r=Math.max(r,e.currentTime),d});return e.currentTime=r,{type:3,steps:s,options:El(n.options)}}visitAnimate(n,e){const i=function b6(t,n){if(t.hasOwnProperty("duration"))return t;if("number"==typeof t)return Z$(ip(t,n).duration,0,"");const e=t;if(e.split(/\s+/).some(s=>"{"==s.charAt(0)&&"{"==s.charAt(1))){const s=Z$(0,0,"");return s.dynamic=!0,s.strValue=e,s}const r=ip(e,n);return Z$(r.duration,r.delay,r.easing)}(n.timings,e.errors);e.currentAnimateTimings=i;let r,s=n.styles?n.styles:We({});if(5==s.type)r=this.visitKeyframes(s,e);else{let o=n.styles,d=!1;if(!o){d=!0;const I={};i.easing&&(I.easing=i.easing),o=We(I)}e.currentTime+=i.duration+i.delay;const $=this.visitStyle(o,e);$.isEmptyStep=d,r=$}return e.currentAnimateTimings=null,{type:4,timings:i,style:r,options:null}}visitStyle(n,e){const i=this._makeStyleAst(n,e);return this._validateStyleAst(i,e),i}_makeStyleAst(n,e){const i=[];Array.isArray(n.styles)?n.styles.forEach(o=>{"string"==typeof o?o==Jo?i.push(o):e.errors.push(function IO(t){return new Tt(3002,Sn)}()):i.push(o)}):i.push(n.styles);let r=!1,s=null;return i.forEach(o=>{if(dp(o)){const d=o,$=d.easing;if($&&(s=$,delete d.easing),!r)for(let I in d)if(d[I].toString().indexOf("{{")>=0){r=!0;break}}}),{type:6,styles:i,easing:s,offset:n.offset,containsDynamicStyles:r,options:null}}_validateStyleAst(n,e){const i=e.currentAnimateTimings;let r=e.currentTime,s=e.currentTime;i&&s>0&&(s-=i.duration+i.delay),n.styles.forEach(o=>{"string"!=typeof o&&Object.keys(o).forEach(d=>{if(!this._driver.validateStyleProperty(d))return delete o[d],void e.unsupportedCSSPropertiesFound.add(d);const $=e.collectedStyles[e.currentQuerySelector],I=$[d];let Q=!0;I&&(s!=r&&s>=I.startTime&&r<=I.endTime&&(e.errors.push(function SO(t,n,e,i,r){return new Tt(3010,Sn)}()),Q=!1),s=I.startTime),Q&&($[d]={startTime:s,endTime:r}),e.options&&function i6(t,n,e){const i=n.params||{},r=jw(t);r.length&&r.forEach(s=>{i.hasOwnProperty(s)||e.push(function bO(t){return new Tt(3001,Sn)}())})}(o[d],e.options,e.errors)})})}visitKeyframes(n,e){const i={type:5,styles:[],options:null};if(!e.currentAnimateTimings)return e.errors.push(function kO(){return new Tt(3011,Sn)}()),i;let s=0;const o=[];let d=!1,$=!1,I=0;const Q=n.steps.map(Be=>{const Ae=this._makeStyleAst(Be,e);let je=null!=Ae.offset?Ae.offset:function v6(t){if("string"==typeof t)return null;let n=null;if(Array.isArray(t))t.forEach(e=>{if(dp(e)&&e.hasOwnProperty("offset")){const i=e;n=parseFloat(i.offset),delete i.offset}});else if(dp(t)&&t.hasOwnProperty("offset")){const e=t;n=parseFloat(e.offset),delete e.offset}return n}(Ae.styles),Ue=0;return null!=je&&(s++,Ue=Ae.offset=je),$=$||Ue<0||Ue>1,d=d||Ue<I,I=Ue,o.push(Ue),Ae});$&&e.errors.push(function MO(){return new Tt(3012,Sn)}()),d&&e.errors.push(function DO(){return new Tt(3200,Sn)}());const fe=n.steps.length;let _e=0;s>0&&s<fe?e.errors.push(function AO(){return new Tt(3202,Sn)}()):0==s&&(_e=1/(fe-1));const Ce=fe-1,Ee=e.currentTime,Re=e.currentAnimateTimings,Le=Re.duration;return Q.forEach((Be,Ae)=>{const je=_e>0?Ae==Ce?1:_e*Ae:o[Ae],Ue=je*Le;e.currentTime=Ee+Re.delay+Ue,Re.duration=Ue,this._validateStyleAst(Be,e),Be.offset=je,i.styles.push(Be)}),i}visitReference(n,e){return{type:8,animation:ps(this,Id(n.animation),e),options:El(n.options)}}visitAnimateChild(n,e){return e.depCount++,{type:9,options:El(n.options)}}visitAnimateRef(n,e){return{type:10,animation:this.visitReference(n.animation,e),options:El(n.options)}}visitQuery(n,e){const i=e.currentQuerySelector,r=n.options||{};e.queryCount++,e.currentQuery=n;const[s,o]=function m6(t){const n=!!t.split(/\s*,\s*/).find(e=>":self"==e);return n&&(t=t.replace(p6,"")),t=t.replace(/@\*/g,np).replace(/@\w+/g,e=>np+"-"+e.substr(1)).replace(/:animating/g,G$),[t,n]}(n.selector);e.currentQuerySelector=i.length?i+" "+s:s,hs(e.collectedStyles,e.currentQuerySelector,{});const d=ps(this,Id(n.animation),e);return e.currentQuery=null,e.currentQuerySelector=i,{type:11,selector:s,limit:r.limit||0,optional:!!r.optional,includeSelf:o,animation:d,originalSelector:n.selector,options:El(n.options)}}visitStagger(n,e){e.currentQuery||e.errors.push(function PO(){return new Tt(3013,Sn)}());const i="full"===n.timings?{duration:0,delay:0,easing:"full"}:ip(n.timings,e.errors,!0);return{type:12,animation:ps(this,Id(n.animation),e),timings:i,options:null}}}class $6{constructor(n){this.errors=n,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function dp(t){return!Array.isArray(t)&&"object"==typeof t}function El(t){return t?(t=Yc(t)).params&&(t.params=function _6(t){return t?Yc(t):null}(t.params)):t={},t}function Z$(t,n,e){return{duration:t,delay:n,easing:e}}function X$(t,n,e,i,r,s,o=null,d=!1){return{type:1,element:t,keyframes:n,preStyleProps:e,postStyleProps:i,duration:r,delay:s,totalTime:r+s,easing:o,subTimeline:d}}class fp{constructor(){this._map=new Map}get(n){return this._map.get(n)||[]}append(n,e){let i=this._map.get(n);i||this._map.set(n,i=[]),i.push(...e)}has(n){return this._map.has(n)}clear(){this._map.clear()}}const x6=new RegExp(":enter","g"),E6=new RegExp(":leave","g");function Q$(t,n,e,i,r,s={},o={},d,$,I=[]){return(new T6).buildKeyframes(t,n,e,i,r,s,o,d,$,I)}class T6{buildKeyframes(n,e,i,r,s,o,d,$,I,Q=[]){I=I||new fp;const fe=new J$(n,e,I,r,s,Q,[]);fe.options=$,fe.currentTimeline.setStyles([o],null,fe.errors,$),ps(this,i,fe);const _e=fe.timelines.filter(Ce=>Ce.containsAnimation());if(Object.keys(d).length){let Ce;for(let Ee=_e.length-1;Ee>=0;Ee--){const Re=_e[Ee];if(Re.element===e){Ce=Re;break}}Ce&&!Ce.allowOnlyTimelineStyles()&&Ce.setStyles([d],null,fe.errors,$)}return _e.length?_e.map(Ce=>Ce.buildKeyframes()):[X$(e,[],[],[],0,0,"",!1)]}visitTrigger(n,e){}visitState(n,e){}visitTransition(n,e){}visitAnimateChild(n,e){const i=e.subInstructions.get(e.element);if(i){const r=e.createSubContext(n.options),s=e.currentTimeline.currentTime,o=this._visitSubInstructions(i,r,r.options);s!=o&&e.transformIntoNewTimeline(o)}e.previousNode=n}visitAnimateRef(n,e){const i=e.createSubContext(n.options);i.transformIntoNewTimeline(),this.visitReference(n.animation,i),e.transformIntoNewTimeline(i.currentTimeline.currentTime),e.previousNode=n}_visitSubInstructions(n,e,i){let s=e.currentTimeline.currentTime;const o=null!=i.duration?xl(i.duration):null,d=null!=i.delay?xl(i.delay):null;return 0!==o&&n.forEach($=>{const I=e.appendInstructionToTimeline($,o,d);s=Math.max(s,I.duration+I.delay)}),s}visitReference(n,e){e.updateOptions(n.options,!0),ps(this,n.animation,e),e.previousNode=n}visitSequence(n,e){const i=e.subContextCount;let r=e;const s=n.options;if(s&&(s.params||s.delay)&&(r=e.createSubContext(s),r.transformIntoNewTimeline(),null!=s.delay)){6==r.previousNode.type&&(r.currentTimeline.snapshotCurrentStyles(),r.previousNode=hp);const o=xl(s.delay);r.delayNextStep(o)}n.steps.length&&(n.steps.forEach(o=>ps(this,o,r)),r.currentTimeline.applyStylesToKeyframe(),r.subContextCount>i&&r.transformIntoNewTimeline()),e.previousNode=n}visitGroup(n,e){const i=[];let r=e.currentTimeline.currentTime;const s=n.options&&n.options.delay?xl(n.options.delay):0;n.steps.forEach(o=>{const d=e.createSubContext(n.options);s&&d.delayNextStep(s),ps(this,o,d),r=Math.max(r,d.currentTimeline.currentTime),i.push(d.currentTimeline)}),i.forEach(o=>e.currentTimeline.mergeTimelineCollectedStyles(o)),e.transformIntoNewTimeline(r),e.previousNode=n}_visitTiming(n,e){if(n.dynamic){const i=n.strValue;return ip(e.params?rp(i,e.params,e.errors):i,e.errors)}return{duration:n.duration,delay:n.delay,easing:n.easing}}visitAnimate(n,e){const i=e.currentAnimateTimings=this._visitTiming(n.timings,e),r=e.currentTimeline;i.delay&&(e.incrementTime(i.delay),r.snapshotCurrentStyles());const s=n.style;5==s.type?this.visitKeyframes(s,e):(e.incrementTime(i.duration),this.visitStyle(s,e),r.applyStylesToKeyframe()),e.currentAnimateTimings=null,e.previousNode=n}visitStyle(n,e){const i=e.currentTimeline,r=e.currentAnimateTimings;!r&&i.getCurrentStyleProperties().length&&i.forwardFrame();const s=r&&r.easing||n.easing;n.isEmptyStep?i.applyEmptyStep(s):i.setStyles(n.styles,s,e.errors,e.options),e.previousNode=n}visitKeyframes(n,e){const i=e.currentAnimateTimings,r=e.currentTimeline.duration,s=i.duration,d=e.createSubContext().currentTimeline;d.easing=i.easing,n.styles.forEach($=>{d.forwardTime(($.offset||0)*s),d.setStyles($.styles,$.easing,e.errors,e.options),d.applyStylesToKeyframe()}),e.currentTimeline.mergeTimelineCollectedStyles(d),e.transformIntoNewTimeline(r+s),e.previousNode=n}visitQuery(n,e){const i=e.currentTimeline.currentTime,r=n.options||{},s=r.delay?xl(r.delay):0;s&&(6===e.previousNode.type||0==i&&e.currentTimeline.getCurrentStyleProperties().length)&&(e.currentTimeline.snapshotCurrentStyles(),e.previousNode=hp);let o=i;const d=e.invokeQuery(n.selector,n.originalSelector,n.limit,n.includeSelf,!!r.optional,e.errors);e.currentQueryTotal=d.length;let $=null;d.forEach((I,Q)=>{e.currentQueryIndex=Q;const fe=e.createSubContext(n.options,I);s&&fe.delayNextStep(s),I===e.element&&($=fe.currentTimeline),ps(this,n.animation,fe),fe.currentTimeline.applyStylesToKeyframe(),o=Math.max(o,fe.currentTimeline.currentTime)}),e.currentQueryIndex=0,e.currentQueryTotal=0,e.transformIntoNewTimeline(o),$&&(e.currentTimeline.mergeTimelineCollectedStyles($),e.currentTimeline.snapshotCurrentStyles()),e.previousNode=n}visitStagger(n,e){const i=e.parentContext,r=e.currentTimeline,s=n.timings,o=Math.abs(s.duration),d=o*(e.currentQueryTotal-1);let $=o*e.currentQueryIndex;switch(s.duration<0?"reverse":s.easing){case"reverse":$=d-$;break;case"full":$=i.currentStaggerTime}const Q=e.currentTimeline;$&&Q.delayNextStep($);const fe=Q.currentTime;ps(this,n.animation,e),e.previousNode=n,i.currentStaggerTime=r.currentTime-fe+(r.startTime-i.currentTimeline.startTime)}}const hp={};class J${constructor(n,e,i,r,s,o,d,$){this._driver=n,this.element=e,this.subInstructions=i,this._enterClassName=r,this._leaveClassName=s,this.errors=o,this.timelines=d,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=hp,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=$||new pp(this._driver,e,0),d.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(n,e){if(!n)return;const i=n;let r=this.options;null!=i.duration&&(r.duration=xl(i.duration)),null!=i.delay&&(r.delay=xl(i.delay));const s=i.params;if(s){let o=r.params;o||(o=this.options.params={}),Object.keys(s).forEach(d=>{(!e||!o.hasOwnProperty(d))&&(o[d]=rp(s[d],o,this.errors))})}}_copyOptions(){const n={};if(this.options){const e=this.options.params;if(e){const i=n.params={};Object.keys(e).forEach(r=>{i[r]=e[r]})}}return n}createSubContext(n=null,e,i){const r=e||this.element,s=new J$(this._driver,r,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(r,i||0));return s.previousNode=this.previousNode,s.currentAnimateTimings=this.currentAnimateTimings,s.options=this._copyOptions(),s.updateOptions(n),s.currentQueryIndex=this.currentQueryIndex,s.currentQueryTotal=this.currentQueryTotal,s.parentContext=this,this.subContextCount++,s}transformIntoNewTimeline(n){return this.previousNode=hp,this.currentTimeline=this.currentTimeline.fork(this.element,n),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(n,e,i){const r={duration:null!=e?e:n.duration,delay:this.currentTimeline.currentTime+(null!=i?i:0)+n.delay,easing:""},s=new I6(this._driver,n.element,n.keyframes,n.preStyleProps,n.postStyleProps,r,n.stretchStartingKeyframe);return this.timelines.push(s),r}incrementTime(n){this.currentTimeline.forwardTime(this.currentTimeline.duration+n)}delayNextStep(n){n>0&&this.currentTimeline.delayNextStep(n)}invokeQuery(n,e,i,r,s,o){let d=[];if(r&&d.push(this.element),n.length>0){n=(n=n.replace(x6,"."+this._enterClassName)).replace(E6,"."+this._leaveClassName);let I=this._driver.query(this.element,n,1!=i);0!==i&&(I=i<0?I.slice(I.length+i,I.length):I.slice(0,i)),d.push(...I)}return!s&&0==d.length&&o.push(function NO(t){return new Tt(3014,Sn)}()),d}}class pp{constructor(n,e,i,r){this._driver=n,this.element=e,this.startTime=i,this._elementTimelineStylesLookup=r,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(e),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(e,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(n){const e=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||e?(this.forwardTime(this.currentTime+n),e&&this.snapshotCurrentStyles()):this.startTime+=n}fork(n,e){return this.applyStylesToKeyframe(),new pp(this._driver,n,e||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(n){this.applyStylesToKeyframe(),this.duration=n,this._loadKeyframe()}_updateStyle(n,e){this._localTimelineStyles[n]=e,this._globalTimelineStyles[n]=e,this._styleSummary[n]={time:this.currentTime,value:e}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(n){n&&(this._previousKeyframe.easing=n),Object.keys(this._globalTimelineStyles).forEach(e=>{this._backFill[e]=this._globalTimelineStyles[e]||Jo,this._currentKeyframe[e]=Jo}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(n,e,i,r){e&&(this._previousKeyframe.easing=e);const s=r&&r.params||{},o=function S6(t,n){const e={};let i;return t.forEach(r=>{"*"===r?(i=i||Object.keys(n),i.forEach(s=>{e[s]=Jo})):Ma(r,!1,e)}),e}(n,this._globalTimelineStyles);Object.keys(o).forEach(d=>{const $=rp(o[d],s,i);this._pendingStyles[d]=$,this._localTimelineStyles.hasOwnProperty(d)||(this._backFill[d]=this._globalTimelineStyles.hasOwnProperty(d)?this._globalTimelineStyles[d]:Jo),this._updateStyle(d,$)})}applyStylesToKeyframe(){const n=this._pendingStyles,e=Object.keys(n);0!=e.length&&(this._pendingStyles={},e.forEach(i=>{this._currentKeyframe[i]=n[i]}),Object.keys(this._localTimelineStyles).forEach(i=>{this._currentKeyframe.hasOwnProperty(i)||(this._currentKeyframe[i]=this._localTimelineStyles[i])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(n=>{const e=this._localTimelineStyles[n];this._pendingStyles[n]=e,this._updateStyle(n,e)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const n=[];for(let e in this._currentKeyframe)n.push(e);return n}mergeTimelineCollectedStyles(n){Object.keys(n._styleSummary).forEach(e=>{const i=this._styleSummary[e],r=n._styleSummary[e];(!i||r.time>i.time)&&this._updateStyle(e,r.value)})}buildKeyframes(){this.applyStylesToKeyframe();const n=new Set,e=new Set,i=1===this._keyframes.size&&0===this.duration;let r=[];this._keyframes.forEach((d,$)=>{const I=Ma(d,!0);Object.keys(I).forEach(Q=>{const fe=I[Q];"!"==fe?n.add(Q):fe==Jo&&e.add(Q)}),i||(I.offset=$/this.duration),r.push(I)});const s=n.size?sp(n.values()):[],o=e.size?sp(e.values()):[];if(i){const d=r[0],$=Yc(d);d.offset=0,$.offset=1,r=[d,$]}return X$(this.element,r,s,o,this.duration,this.startTime,this.easing,!1)}}class I6 extends pp{constructor(n,e,i,r,s,o,d=!1){super(n,e,o.delay),this.keyframes=i,this.preStyleProps=r,this.postStyleProps=s,this._stretchStartingKeyframe=d,this.timings={duration:o.duration,delay:o.delay,easing:o.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let n=this.keyframes,{delay:e,duration:i,easing:r}=this.timings;if(this._stretchStartingKeyframe&&e){const s=[],o=i+e,d=e/o,$=Ma(n[0],!1);$.offset=0,s.push($);const I=Ma(n[0],!1);I.offset=qw(d),s.push(I);const Q=n.length-1;for(let fe=1;fe<=Q;fe++){let _e=Ma(n[fe],!1);_e.offset=qw((e+_e.offset*i)/o),s.push(_e)}i=o,e=0,r="",n=s}return X$(this.element,n,this.preStyleProps,this.postStyleProps,i,e,r,!0)}}function qw(t,n=3){const e=Math.pow(10,n-1);return Math.round(t*e)/e}class e0{}class k6 extends e0{normalizePropertyName(n,e){return K$(n)}normalizeStyleValue(n,e,i,r){let s="";const o=i.toString().trim();if(M6[e]&&0!==i&&"0"!==i)if("number"==typeof i)s="px";else{const d=i.match(/^[+-]?[\d\.]+([a-z]*)$/);d&&0==d[1].length&&r.push(function xO(t,n){return new Tt(3005,Sn)}())}return o+s}}const M6=(()=>function D6(t){const n={};return t.forEach(e=>n[e]=!0),n}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function Ww(t,n,e,i,r,s,o,d,$,I,Q,fe,_e){return{type:0,element:t,triggerName:n,isRemovalTransition:r,fromState:e,fromStyles:s,toState:i,toStyles:o,timelines:d,queriedElements:$,preStyleProps:I,postStyleProps:Q,totalTime:fe,errors:_e}}const t0={};class Kw{constructor(n,e,i){this._triggerName=n,this.ast=e,this._stateStyles=i}match(n,e,i,r){return function A6(t,n,e,i,r){return t.some(s=>s(n,e,i,r))}(this.ast.matchers,n,e,i,r)}buildStyles(n,e,i){const r=this._stateStyles["*"],s=this._stateStyles[n],o=r?r.buildStyles(e,i):{};return s?s.buildStyles(e,i):o}build(n,e,i,r,s,o,d,$,I,Q){const fe=[],_e=this.ast.options&&this.ast.options.params||t0,Ee=this.buildStyles(i,d&&d.params||t0,fe),Re=$&&$.params||t0,Le=this.buildStyles(r,Re,fe),Be=new Set,Ae=new Map,je=new Map,Ue="void"===r,at={params:Object.assign(Object.assign({},_e),Re)},lt=Q?[]:Q$(n,e,this.ast.animation,s,o,Ee,Le,at,I,fe);let tt=0;if(lt.forEach(ot=>{tt=Math.max(ot.duration+ot.delay,tt)}),fe.length)return Ww(e,this._triggerName,i,r,Ue,Ee,Le,[],[],Ae,je,tt,fe);lt.forEach(ot=>{const ht=ot.element,pt=hs(Ae,ht,{});ot.preStyleProps.forEach(an=>pt[an]=!0);const _n=hs(je,ht,{});ot.postStyleProps.forEach(an=>_n[an]=!0),ht!==e&&Be.add(ht)});const Ct=sp(Be.values());return Ww(e,this._triggerName,i,r,Ue,Ee,Le,lt,Ct,Ae,je,tt)}}class P6{constructor(n,e,i){this.styles=n,this.defaultParams=e,this.normalizer=i}buildStyles(n,e){const i={},r=Yc(this.defaultParams);return Object.keys(n).forEach(s=>{const o=n[s];null!=o&&(r[s]=o)}),this.styles.styles.forEach(s=>{if("string"!=typeof s){const o=s;Object.keys(o).forEach(d=>{let $=o[d];$.length>1&&($=rp($,r,e));const I=this.normalizer.normalizePropertyName(d,e);$=this.normalizer.normalizeStyleValue(d,I,$,e),i[I]=$})}}),i}}class F6{constructor(n,e,i){this.name=n,this.ast=e,this._normalizer=i,this.transitionFactories=[],this.states={},e.states.forEach(r=>{this.states[r.name]=new P6(r.style,r.options&&r.options.params||{},i)}),Yw(this.states,"true","1"),Yw(this.states,"false","0"),e.transitions.forEach(r=>{this.transitionFactories.push(new Kw(n,r,this.states))}),this.fallbackTransition=function R6(t,n,e){return new Kw(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(o,d)=>!0],options:null,queryCount:0,depCount:0},n)}(n,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(n,e,i,r){return this.transitionFactories.find(o=>o.match(n,e,i,r))||null}matchStyles(n,e,i){return this.fallbackTransition.buildStyles(n,e,i)}}function Yw(t,n,e){t.hasOwnProperty(n)?t.hasOwnProperty(e)||(t[e]=t[n]):t.hasOwnProperty(e)&&(t[n]=t[e])}const O6=new fp;class B6{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._animations={},this._playersById={},this.players=[]}register(n,e){const i=[],s=Y$(this._driver,e,i,[]);if(i.length)throw function jO(t){return new Tt(3503,Sn)}();this._animations[n]=s}_buildPlayer(n,e,i){const r=n.element,s=Iw(0,this._normalizer,0,n.keyframes,e,i);return this._driver.animate(r,s,n.duration,n.delay,n.easing,[],!0)}create(n,e,i={}){const r=[],s=this._animations[n];let o;const d=new Map;if(s?(o=Q$(this._driver,e,s,V$,ep,{},{},i,O6,r),o.forEach(Q=>{const fe=hs(d,Q.element,{});Q.postStyleProps.forEach(_e=>fe[_e]=null)})):(r.push(function UO(){return new Tt(3300,Sn)}()),o=[]),r.length)throw function HO(t){return new Tt(3504,Sn)}();d.forEach((Q,fe)=>{Object.keys(Q).forEach(_e=>{Q[_e]=this._driver.computeStyle(fe,_e,Jo)})});const I=ka(o.map(Q=>{const fe=d.get(Q.element);return this._buildPlayer(Q,{},fe)}));return this._playersById[n]=I,I.onDestroy(()=>this.destroy(n)),this.players.push(I),I}destroy(n){const e=this._getPlayer(n);e.destroy(),delete this._playersById[n];const i=this.players.indexOf(e);i>=0&&this.players.splice(i,1)}_getPlayer(n){const e=this._playersById[n];if(!e)throw function VO(t){return new Tt(3301,Sn)}();return e}listen(n,e,i,r){const s=z$(e,"","","");return B$(this._getPlayer(n),i,s,r),()=>{}}command(n,e,i,r){if("register"==i)return void this.register(n,r[0]);if("create"==i)return void this.create(n,e,r[0]||{});const s=this._getPlayer(n);switch(i){case"play":s.play();break;case"pause":s.pause();break;case"reset":s.reset();break;case"restart":s.restart();break;case"finish":s.finish();break;case"init":s.init();break;case"setPosition":s.setPosition(parseFloat(r[0]));break;case"destroy":this.destroy(n)}}}const Zw="ng-animate-queued",n0="ng-animate-disabled",H6=[],Xw={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},V6={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ms="__ng_removed";class r0{constructor(n,e=""){this.namespaceId=e;const i=n&&n.hasOwnProperty("value");if(this.value=function K6(t){return null!=t?t:null}(i?n.value:n),i){const s=Yc(n);delete s.value,this.options=s}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(n){const e=n.params;if(e){const i=this.options.params;Object.keys(e).forEach(r=>{null==i[r]&&(i[r]=e[r])})}}}const Sd="void",s0=new r0(Sd);class G6{constructor(n,e,i){this.id=n,this.hostElement=e,this._engine=i,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+n,Ds(e,this._hostClassName)}listen(n,e,i,r){if(!this._triggers.hasOwnProperty(e))throw function GO(t,n){return new Tt(3302,Sn)}();if(null==i||0==i.length)throw function qO(t){return new Tt(3303,Sn)}();if(!function Y6(t){return"start"==t||"done"==t}(i))throw function WO(t,n){return new Tt(3400,Sn)}();const s=hs(this._elementListeners,n,[]),o={name:e,phase:i,callback:r};s.push(o);const d=hs(this._engine.statesByElement,n,{});return d.hasOwnProperty(e)||(Ds(n,tp),Ds(n,tp+"-"+e),d[e]=s0),()=>{this._engine.afterFlush(()=>{const $=s.indexOf(o);$>=0&&s.splice($,1),this._triggers[e]||delete d[e]})}}register(n,e){return!this._triggers[n]&&(this._triggers[n]=e,!0)}_getTrigger(n){const e=this._triggers[n];if(!e)throw function KO(t){return new Tt(3401,Sn)}();return e}trigger(n,e,i,r=!0){const s=this._getTrigger(e),o=new o0(this.id,e,n);let d=this._engine.statesByElement.get(n);d||(Ds(n,tp),Ds(n,tp+"-"+e),this._engine.statesByElement.set(n,d={}));let $=d[e];const I=new r0(i,this.id);if(!(i&&i.hasOwnProperty("value"))&&$&&I.absorbOptions($.options),d[e]=I,$||($=s0),I.value!==Sd&&$.value===I.value){if(!function Q6(t,n){const e=Object.keys(t),i=Object.keys(n);if(e.length!=i.length)return!1;for(let r=0;r<e.length;r++){const s=e[r];if(!n.hasOwnProperty(s)||t[s]!==n[s])return!1}return!0}($.params,I.params)){const Re=[],Le=s.matchStyles($.value,$.params,Re),Be=s.matchStyles(I.value,I.params,Re);Re.length?this._engine.reportError(Re):this._engine.afterFlush(()=>{wl(n,Le),xo(n,Be)})}return}const _e=hs(this._engine.playersByElement,n,[]);_e.forEach(Re=>{Re.namespaceId==this.id&&Re.triggerName==e&&Re.queued&&Re.destroy()});let Ce=s.matchTransition($.value,I.value,n,I.params),Ee=!1;if(!Ce){if(!r)return;Ce=s.fallbackTransition,Ee=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:e,transition:Ce,fromState:$,toState:I,player:o,isFallbackTransition:Ee}),Ee||(Ds(n,Zw),o.onStart(()=>{Zc(n,Zw)})),o.onDone(()=>{let Re=this.players.indexOf(o);Re>=0&&this.players.splice(Re,1);const Le=this._engine.playersByElement.get(n);if(Le){let Be=Le.indexOf(o);Be>=0&&Le.splice(Be,1)}}),this.players.push(o),_e.push(o),o}deregister(n){delete this._triggers[n],this._engine.statesByElement.forEach((e,i)=>{delete e[n]}),this._elementListeners.forEach((e,i)=>{this._elementListeners.set(i,e.filter(r=>r.name!=n))})}clearElementCache(n){this._engine.statesByElement.delete(n),this._elementListeners.delete(n);const e=this._engine.playersByElement.get(n);e&&(e.forEach(i=>i.destroy()),this._engine.playersByElement.delete(n))}_signalRemovalForInnerTriggers(n,e){const i=this._engine.driver.query(n,np,!0);i.forEach(r=>{if(r[Ms])return;const s=this._engine.fetchNamespacesByElement(r);s.size?s.forEach(o=>o.triggerLeaveAnimation(r,e,!1,!0)):this.clearElementCache(r)}),this._engine.afterFlushAnimationsDone(()=>i.forEach(r=>this.clearElementCache(r)))}triggerLeaveAnimation(n,e,i,r){const s=this._engine.statesByElement.get(n),o=new Map;if(s){const d=[];if(Object.keys(s).forEach($=>{if(o.set($,s[$].value),this._triggers[$]){const I=this.trigger(n,$,Sd,r);I&&d.push(I)}}),d.length)return this._engine.markElementAsRemoved(this.id,n,!0,e,o),i&&ka(d).onDone(()=>this._engine.processLeaveNode(n)),!0}return!1}prepareLeaveAnimationListeners(n){const e=this._elementListeners.get(n),i=this._engine.statesByElement.get(n);if(e&&i){const r=new Set;e.forEach(s=>{const o=s.name;if(r.has(o))return;r.add(o);const $=this._triggers[o].fallbackTransition,I=i[o]||s0,Q=new r0(Sd),fe=new o0(this.id,o,n);this._engine.totalQueuedPlayers++,this._queue.push({element:n,triggerName:o,transition:$,fromState:I,toState:Q,player:fe,isFallbackTransition:!0})})}}removeNode(n,e){const i=this._engine;if(n.childElementCount&&this._signalRemovalForInnerTriggers(n,e),this.triggerLeaveAnimation(n,e,!0))return;let r=!1;if(i.totalAnimations){const s=i.players.length?i.playersByQueriedElement.get(n):[];if(s&&s.length)r=!0;else{let o=n;for(;o=o.parentNode;)if(i.statesByElement.get(o)){r=!0;break}}}if(this.prepareLeaveAnimationListeners(n),r)i.markElementAsRemoved(this.id,n,!1,e);else{const s=n[Ms];(!s||s===Xw)&&(i.afterFlush(()=>this.clearElementCache(n)),i.destroyInnerAnimations(n),i._onRemovalComplete(n,e))}}insertNode(n,e){Ds(n,this._hostClassName)}drainQueuedTransitions(n){const e=[];return this._queue.forEach(i=>{const r=i.player;if(r.destroyed)return;const s=i.element,o=this._elementListeners.get(s);o&&o.forEach(d=>{if(d.name==i.triggerName){const $=z$(s,i.triggerName,i.fromState.value,i.toState.value);$._data=n,B$(i.player,d.phase,$,d.callback)}}),r.markedForDestroy?this._engine.afterFlush(()=>{r.destroy()}):e.push(i)}),this._queue=[],e.sort((i,r)=>{const s=i.transition.ast.depCount,o=r.transition.ast.depCount;return 0==s||0==o?s-o:this._engine.driver.containsElement(i.element,r.element)?1:-1})}destroy(n){this.players.forEach(e=>e.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,n)}elementContainsData(n){let e=!1;return this._elementListeners.has(n)&&(e=!0),e=!!this._queue.find(i=>i.element===n)||e,e}}class q6{constructor(n,e,i){this.bodyNode=n,this.driver=e,this._normalizer=i,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(r,s)=>{}}_onRemovalComplete(n,e){this.onRemovalComplete(n,e)}get queuedPlayers(){const n=[];return this._namespaceList.forEach(e=>{e.players.forEach(i=>{i.queued&&n.push(i)})}),n}createNamespace(n,e){const i=new G6(n,e,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,e)?this._balanceNamespaceList(i,e):(this.newHostElements.set(e,i),this.collectEnterElement(e)),this._namespaceLookup[n]=i}_balanceNamespaceList(n,e){const i=this._namespaceList,r=this.namespacesByHostElement,s=i.length-1;if(s>=0){let o=!1;if(void 0!==this.driver.getParentElement){let d=this.driver.getParentElement(e);for(;d;){const $=r.get(d);if($){const I=i.indexOf($);i.splice(I+1,0,n),o=!0;break}d=this.driver.getParentElement(d)}}else for(let d=s;d>=0;d--)if(this.driver.containsElement(i[d].hostElement,e)){i.splice(d+1,0,n),o=!0;break}o||i.unshift(n)}else i.push(n);return r.set(e,n),n}register(n,e){let i=this._namespaceLookup[n];return i||(i=this.createNamespace(n,e)),i}registerTrigger(n,e,i){let r=this._namespaceLookup[n];r&&r.register(e,i)&&this.totalAnimations++}destroy(n,e){if(!n)return;const i=this._fetchNamespace(n);this.afterFlush(()=>{this.namespacesByHostElement.delete(i.hostElement),delete this._namespaceLookup[n];const r=this._namespaceList.indexOf(i);r>=0&&this._namespaceList.splice(r,1)}),this.afterFlushAnimationsDone(()=>i.destroy(e))}_fetchNamespace(n){return this._namespaceLookup[n]}fetchNamespacesByElement(n){const e=new Set,i=this.statesByElement.get(n);if(i){const r=Object.keys(i);for(let s=0;s<r.length;s++){const o=i[r[s]].namespaceId;if(o){const d=this._fetchNamespace(o);d&&e.add(d)}}}return e}trigger(n,e,i,r){if(gp(e)){const s=this._fetchNamespace(n);if(s)return s.trigger(e,i,r),!0}return!1}insertNode(n,e,i,r){if(!gp(e))return;const s=e[Ms];if(s&&s.setForRemoval){s.setForRemoval=!1,s.setForMove=!0;const o=this.collectedLeaveElements.indexOf(e);o>=0&&this.collectedLeaveElements.splice(o,1)}if(n){const o=this._fetchNamespace(n);o&&o.insertNode(e,i)}r&&this.collectEnterElement(e)}collectEnterElement(n){this.collectedEnterElements.push(n)}markElementAsDisabled(n,e){e?this.disabledNodes.has(n)||(this.disabledNodes.add(n),Ds(n,n0)):this.disabledNodes.has(n)&&(this.disabledNodes.delete(n),Zc(n,n0))}removeNode(n,e,i,r){if(gp(e)){const s=n?this._fetchNamespace(n):null;if(s?s.removeNode(e,r):this.markElementAsRemoved(n,e,!1,r),i){const o=this.namespacesByHostElement.get(e);o&&o.id!==n&&o.removeNode(e,r)}}else this._onRemovalComplete(e,r)}markElementAsRemoved(n,e,i,r,s){this.collectedLeaveElements.push(e),e[Ms]={namespaceId:n,setForRemoval:r,hasAnimation:i,removedBeforeQueried:!1,previousTriggersValues:s}}listen(n,e,i,r,s){return gp(e)?this._fetchNamespace(n).listen(e,i,r,s):()=>{}}_buildInstruction(n,e,i,r,s){return n.transition.build(this.driver,n.element,n.fromState.value,n.toState.value,i,r,n.fromState.options,n.toState.options,e,s)}destroyInnerAnimations(n){let e=this.driver.query(n,np,!0);e.forEach(i=>this.destroyActiveAnimationsForElement(i)),0!=this.playersByQueriedElement.size&&(e=this.driver.query(n,G$,!0),e.forEach(i=>this.finishActiveQueriedAnimationOnElement(i)))}destroyActiveAnimationsForElement(n){const e=this.playersByElement.get(n);e&&e.forEach(i=>{i.queued?i.markedForDestroy=!0:i.destroy()})}finishActiveQueriedAnimationOnElement(n){const e=this.playersByQueriedElement.get(n);e&&e.forEach(i=>i.finish())}whenRenderingDone(){return new Promise(n=>{if(this.players.length)return ka(this.players).onDone(()=>n());n()})}processLeaveNode(n){var e;const i=n[Ms];if(i&&i.setForRemoval){if(n[Ms]=Xw,i.namespaceId){this.destroyInnerAnimations(n);const r=this._fetchNamespace(i.namespaceId);r&&r.clearElementCache(n)}this._onRemovalComplete(n,i.setForRemoval)}(null===(e=n.classList)||void 0===e?void 0:e.contains(n0))&&this.markElementAsDisabled(n,!1),this.driver.query(n,".ng-animate-disabled",!0).forEach(r=>{this.markElementAsDisabled(r,!1)})}flush(n=-1){let e=[];if(this.newHostElements.size&&(this.newHostElements.forEach((i,r)=>this._balanceNamespaceList(i,r)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let i=0;i<this.collectedEnterElements.length;i++)Ds(this.collectedEnterElements[i],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const i=[];try{e=this._flushAnimations(i,n)}finally{for(let r=0;r<i.length;r++)i[r]()}}else for(let i=0;i<this.collectedLeaveElements.length;i++)this.processLeaveNode(this.collectedLeaveElements[i]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(i=>i()),this._flushFns=[],this._whenQuietFns.length){const i=this._whenQuietFns;this._whenQuietFns=[],e.length?ka(e).onDone(()=>{i.forEach(r=>r())}):i.forEach(r=>r())}}reportError(n){throw function YO(t){return new Tt(3402,Sn)}()}_flushAnimations(n,e){const i=new fp,r=[],s=new Map,o=[],d=new Map,$=new Map,I=new Map,Q=new Set;this.disabledNodes.forEach(xt=>{Q.add(xt);const Ot=this.driver.query(xt,".ng-animate-queued",!0);for(let Ht=0;Ht<Ot.length;Ht++)Q.add(Ot[Ht])});const fe=this.bodyNode,_e=Array.from(this.statesByElement.keys()),Ce=eE(_e,this.collectedEnterElements),Ee=new Map;let Re=0;Ce.forEach((xt,Ot)=>{const Ht=V$+Re++;Ee.set(Ot,Ht),xt.forEach(en=>Ds(en,Ht))});const Le=[],Be=new Set,Ae=new Set;for(let xt=0;xt<this.collectedLeaveElements.length;xt++){const Ot=this.collectedLeaveElements[xt],Ht=Ot[Ms];Ht&&Ht.setForRemoval&&(Le.push(Ot),Be.add(Ot),Ht.hasAnimation?this.driver.query(Ot,".ng-star-inserted",!0).forEach(en=>Be.add(en)):Ae.add(Ot))}const je=new Map,Ue=eE(_e,Array.from(Be));Ue.forEach((xt,Ot)=>{const Ht=ep+Re++;je.set(Ot,Ht),xt.forEach(en=>Ds(en,Ht))}),n.push(()=>{Ce.forEach((xt,Ot)=>{const Ht=Ee.get(Ot);xt.forEach(en=>Zc(en,Ht))}),Ue.forEach((xt,Ot)=>{const Ht=je.get(Ot);xt.forEach(en=>Zc(en,Ht))}),Le.forEach(xt=>{this.processLeaveNode(xt)})});const at=[],lt=[];for(let xt=this._namespaceList.length-1;xt>=0;xt--)this._namespaceList[xt].drainQueuedTransitions(e).forEach(Ht=>{const en=Ht.player,Nn=Ht.element;if(at.push(en),this.collectedEnterElements.length){const Lr=Nn[Ms];if(Lr&&Lr.setForMove){if(Lr.previousTriggersValues&&Lr.previousTriggersValues.has(Ht.triggerName)){const Kl=Lr.previousTriggersValues.get(Ht.triggerName),Xa=this.statesByElement.get(Ht.element);Xa&&Xa[Ht.triggerName]&&(Xa[Ht.triggerName].value=Kl)}return void en.destroy()}}const $i=!fe||!this.driver.containsElement(fe,Nn),Ei=je.get(Nn),Xi=Ee.get(Nn),fi=this._buildInstruction(Ht,i,Xi,Ei,$i);if(fi.errors&&fi.errors.length)return void lt.push(fi);if($i)return en.onStart(()=>wl(Nn,fi.fromStyles)),en.onDestroy(()=>xo(Nn,fi.toStyles)),void r.push(en);if(Ht.isFallbackTransition)return en.onStart(()=>wl(Nn,fi.fromStyles)),en.onDestroy(()=>xo(Nn,fi.toStyles)),void r.push(en);const $t=[];fi.timelines.forEach(Lr=>{Lr.stretchStartingKeyframe=!0,this.disabledNodes.has(Lr.element)||$t.push(Lr)}),fi.timelines=$t,i.append(Nn,fi.timelines),o.push({instruction:fi,player:en,element:Nn}),fi.queriedElements.forEach(Lr=>hs(d,Lr,[]).push(en)),fi.preStyleProps.forEach((Lr,Kl)=>{const Xa=Object.keys(Lr);if(Xa.length){let Yl=$.get(Kl);Yl||$.set(Kl,Yl=new Set),Xa.forEach(v1=>Yl.add(v1))}}),fi.postStyleProps.forEach((Lr,Kl)=>{const Xa=Object.keys(Lr);let Yl=I.get(Kl);Yl||I.set(Kl,Yl=new Set),Xa.forEach(v1=>Yl.add(v1))})});if(lt.length){const xt=[];lt.forEach(Ot=>{xt.push(function ZO(t,n){return new Tt(3505,Sn)}())}),at.forEach(Ot=>Ot.destroy()),this.reportError(xt)}const tt=new Map,Ct=new Map;o.forEach(xt=>{const Ot=xt.element;i.has(Ot)&&(Ct.set(Ot,Ot),this._beforeAnimationBuild(xt.player.namespaceId,xt.instruction,tt))}),r.forEach(xt=>{const Ot=xt.element;this._getPreviousPlayers(Ot,!1,xt.namespaceId,xt.triggerName,null).forEach(en=>{hs(tt,Ot,[]).push(en),en.destroy()})});const ot=Le.filter(xt=>nE(xt,$,I)),ht=new Map;Jw(ht,this.driver,Ae,I,Jo).forEach(xt=>{nE(xt,$,I)&&ot.push(xt)});const _n=new Map;Ce.forEach((xt,Ot)=>{Jw(_n,this.driver,new Set(xt),$,"!")}),ot.forEach(xt=>{const Ot=ht.get(xt),Ht=_n.get(xt);ht.set(xt,Object.assign(Object.assign({},Ot),Ht))});const an=[],di=[],Er={};o.forEach(xt=>{const{element:Ot,player:Ht,instruction:en}=xt;if(i.has(Ot)){if(Q.has(Ot))return Ht.onDestroy(()=>xo(Ot,en.toStyles)),Ht.disabled=!0,Ht.overrideTotalTime(en.totalTime),void r.push(Ht);let Nn=Er;if(Ct.size>1){let Ei=Ot;const Xi=[];for(;Ei=Ei.parentNode;){const fi=Ct.get(Ei);if(fi){Nn=fi;break}Xi.push(Ei)}Xi.forEach(fi=>Ct.set(fi,Nn))}const $i=this._buildAnimation(Ht.namespaceId,en,tt,s,_n,ht);if(Ht.setRealPlayer($i),Nn===Er)an.push(Ht);else{const Ei=this.playersByElement.get(Nn);Ei&&Ei.length&&(Ht.parentPlayer=ka(Ei)),r.push(Ht)}}else wl(Ot,en.fromStyles),Ht.onDestroy(()=>xo(Ot,en.toStyles)),di.push(Ht),Q.has(Ot)&&r.push(Ht)}),di.forEach(xt=>{const Ot=s.get(xt.element);if(Ot&&Ot.length){const Ht=ka(Ot);xt.setRealPlayer(Ht)}}),r.forEach(xt=>{xt.parentPlayer?xt.syncPlayerEvents(xt.parentPlayer):xt.destroy()});for(let xt=0;xt<Le.length;xt++){const Ot=Le[xt],Ht=Ot[Ms];if(Zc(Ot,ep),Ht&&Ht.hasAnimation)continue;let en=[];if(d.size){let $i=d.get(Ot);$i&&$i.length&&en.push(...$i);let Ei=this.driver.query(Ot,G$,!0);for(let Xi=0;Xi<Ei.length;Xi++){let fi=d.get(Ei[Xi]);fi&&fi.length&&en.push(...fi)}}const Nn=en.filter($i=>!$i.destroyed);Nn.length?Z6(this,Ot,Nn):this.processLeaveNode(Ot)}return Le.length=0,an.forEach(xt=>{this.players.push(xt),xt.onDone(()=>{xt.destroy();const Ot=this.players.indexOf(xt);this.players.splice(Ot,1)}),xt.play()}),an}elementContainsData(n,e){let i=!1;const r=e[Ms];return r&&r.setForRemoval&&(i=!0),this.playersByElement.has(e)&&(i=!0),this.playersByQueriedElement.has(e)&&(i=!0),this.statesByElement.has(e)&&(i=!0),this._fetchNamespace(n).elementContainsData(e)||i}afterFlush(n){this._flushFns.push(n)}afterFlushAnimationsDone(n){this._whenQuietFns.push(n)}_getPreviousPlayers(n,e,i,r,s){let o=[];if(e){const d=this.playersByQueriedElement.get(n);d&&(o=d)}else{const d=this.playersByElement.get(n);if(d){const $=!s||s==Sd;d.forEach(I=>{I.queued||!$&&I.triggerName!=r||o.push(I)})}}return(i||r)&&(o=o.filter(d=>!(i&&i!=d.namespaceId||r&&r!=d.triggerName))),o}_beforeAnimationBuild(n,e,i){const s=e.element,o=e.isRemovalTransition?void 0:n,d=e.isRemovalTransition?void 0:e.triggerName;for(const $ of e.timelines){const I=$.element,Q=I!==s,fe=hs(i,I,[]);this._getPreviousPlayers(I,Q,o,d,e.toState).forEach(Ce=>{const Ee=Ce.getRealPlayer();Ee.beforeDestroy&&Ee.beforeDestroy(),Ce.destroy(),fe.push(Ce)})}wl(s,e.fromStyles)}_buildAnimation(n,e,i,r,s,o){const d=e.triggerName,$=e.element,I=[],Q=new Set,fe=new Set,_e=e.timelines.map(Ee=>{const Re=Ee.element;Q.add(Re);const Le=Re[Ms];if(Le&&Le.removedBeforeQueried)return new Td(Ee.duration,Ee.delay);const Be=Re!==$,Ae=function X6(t){const n=[];return tE(t,n),n}((i.get(Re)||H6).map(tt=>tt.getRealPlayer())).filter(tt=>!!tt.element&&tt.element===Re),je=s.get(Re),Ue=o.get(Re),at=Iw(0,this._normalizer,0,Ee.keyframes,je,Ue),lt=this._buildPlayer(Ee,at,Ae);if(Ee.subTimeline&&r&&fe.add(Re),Be){const tt=new o0(n,d,Re);tt.setRealPlayer(lt),I.push(tt)}return lt});I.forEach(Ee=>{hs(this.playersByQueriedElement,Ee.element,[]).push(Ee),Ee.onDone(()=>function W6(t,n,e){let i;if(t instanceof Map){if(i=t.get(n),i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&t.delete(n)}}else if(i=t[n],i){if(i.length){const r=i.indexOf(e);i.splice(r,1)}0==i.length&&delete t[n]}return i}(this.playersByQueriedElement,Ee.element,Ee))}),Q.forEach(Ee=>Ds(Ee,Ow));const Ce=ka(_e);return Ce.onDestroy(()=>{Q.forEach(Ee=>Zc(Ee,Ow)),xo($,e.toStyles)}),fe.forEach(Ee=>{hs(r,Ee,[]).push(Ce)}),Ce}_buildPlayer(n,e,i){return e.length>0?this.driver.animate(n.element,e,n.duration,n.delay,n.easing,i):new Td(n.duration,n.delay)}}class o0{constructor(n,e,i){this.namespaceId=n,this.triggerName=e,this.element=i,this._player=new Td,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(n){this._containsRealPlayer||(this._player=n,Object.keys(this._queuedCallbacks).forEach(e=>{this._queuedCallbacks[e].forEach(i=>B$(n,e,void 0,i))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(n.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(n){this.totalTime=n}syncPlayerEvents(n){const e=this._player;e.triggerCallback&&n.onStart(()=>e.triggerCallback("start")),n.onDone(()=>this.finish()),n.onDestroy(()=>this.destroy())}_queueEvent(n,e){hs(this._queuedCallbacks,n,[]).push(e)}onDone(n){this.queued&&this._queueEvent("done",n),this._player.onDone(n)}onStart(n){this.queued&&this._queueEvent("start",n),this._player.onStart(n)}onDestroy(n){this.queued&&this._queueEvent("destroy",n),this._player.onDestroy(n)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(n){this.queued||this._player.setPosition(n)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(n){const e=this._player;e.triggerCallback&&e.triggerCallback(n)}}function gp(t){return t&&1===t.nodeType}function Qw(t,n){const e=t.style.display;return t.style.display=null!=n?n:"none",e}function Jw(t,n,e,i,r){const s=[];e.forEach($=>s.push(Qw($)));const o=[];i.forEach(($,I)=>{const Q={};$.forEach(fe=>{const _e=Q[fe]=n.computeStyle(I,fe,r);(!_e||0==_e.length)&&(I[Ms]=V6,o.push(I))}),t.set(I,Q)});let d=0;return e.forEach($=>Qw($,s[d++])),o}function eE(t,n){const e=new Map;if(t.forEach(d=>e.set(d,[])),0==n.length)return e;const r=new Set(n),s=new Map;function o(d){if(!d)return 1;let $=s.get(d);if($)return $;const I=d.parentNode;return $=e.has(I)?I:r.has(I)?1:o(I),s.set(d,$),$}return n.forEach(d=>{const $=o(d);1!==$&&e.get($).push(d)}),e}function Ds(t,n){var e;null===(e=t.classList)||void 0===e||e.add(n)}function Zc(t,n){var e;null===(e=t.classList)||void 0===e||e.remove(n)}function Z6(t,n,e){ka(e).onDone(()=>t.processLeaveNode(n))}function tE(t,n){for(let e=0;e<t.length;e++){const i=t[e];i instanceof Ew?tE(i.players,n):n.push(i)}}function nE(t,n,e){const i=e.get(t);if(!i)return!1;let r=n.get(t);return r?i.forEach(s=>r.add(s)):n.set(t,i),e.delete(t),!0}class mp{constructor(n,e,i){this.bodyNode=n,this._driver=e,this._normalizer=i,this._triggerCache={},this.onRemovalComplete=(r,s)=>{},this._transitionEngine=new q6(n,e,i),this._timelineEngine=new B6(n,e,i),this._transitionEngine.onRemovalComplete=(r,s)=>this.onRemovalComplete(r,s)}registerTrigger(n,e,i,r,s){const o=n+"-"+r;let d=this._triggerCache[o];if(!d){const $=[],Q=Y$(this._driver,s,$,[]);if($.length)throw function LO(t,n){return new Tt(3404,Sn)}();d=function N6(t,n,e){return new F6(t,n,e)}(r,Q,this._normalizer),this._triggerCache[o]=d}this._transitionEngine.registerTrigger(e,r,d)}register(n,e){this._transitionEngine.register(n,e)}destroy(n,e){this._transitionEngine.destroy(n,e)}onInsert(n,e,i,r){this._transitionEngine.insertNode(n,e,i,r)}onRemove(n,e,i,r){this._transitionEngine.removeNode(n,e,r||!1,i)}disableAnimations(n,e){this._transitionEngine.markElementAsDisabled(n,e)}process(n,e,i,r){if("@"==i.charAt(0)){const[s,o]=Sw(i);this._timelineEngine.command(s,e,o,r)}else this._transitionEngine.trigger(n,e,i,r)}listen(n,e,i,r,s){if("@"==i.charAt(0)){const[o,d]=Sw(i);return this._timelineEngine.listen(o,e,d,s)}return this._transitionEngine.listen(n,e,i,r,s)}flush(n=-1){this._transitionEngine.flush(n)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let e8=(()=>{class t{constructor(e,i,r){this._element=e,this._startStyles=i,this._endStyles=r,this._state=0;let s=t.initialStylesByElement.get(e);s||t.initialStylesByElement.set(e,s={}),this._initialStyles=s}start(){this._state<1&&(this._startStyles&&xo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(xo(this._element,this._initialStyles),this._endStyles&&(xo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(wl(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(wl(this._element,this._endStyles),this._endStyles=null),xo(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function a0(t){let n=null;const e=Object.keys(t);for(let i=0;i<e.length;i++){const r=e[i];t8(r)&&(n=n||{},n[r]=t[r])}return n}function t8(t){return"display"===t||"position"===t}class iE{constructor(n,e,i,r){this.element=n,this.keyframes=e,this.options=i,this._specialStyles=r,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=i.duration,this._delay=i.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(n=>n()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const n=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,n,this.options),this._finalKeyframe=n.length?n[n.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(n,e,i){return n.animate(e,i)}onStart(n){this._onStartFns.push(n)}onDone(n){this._onDoneFns.push(n)}onDestroy(n){this._onDestroyFns.push(n)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(n=>n()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(n=>n()),this._onDestroyFns=[])}setPosition(n){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=n*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const n={};if(this.hasStarted()){const e=this._finalKeyframe;Object.keys(e).forEach(i=>{"offset"!=i&&(n[i]=this._finished?e[i]:Uw(this.element,i))})}this.currentSnapshot=n}triggerCallback(n){const e="start"==n?this._onStartFns:this._onDoneFns;e.forEach(i=>i()),e.length=0}}class n8{validateStyleProperty(n){return Aw(n)}matchesElement(n,e){return!1}containsElement(n,e){return Pw(n,e)}getParentElement(n){return U$(n)}query(n,e,i){return Nw(n,e,i)}computeStyle(n,e,i){return window.getComputedStyle(n)[e]}animate(n,e,i,r,s,o=[]){const $={duration:i,delay:r,fill:0==r?"both":"forwards"};s&&($.easing=s);const I={},Q=o.filter(_e=>_e instanceof iE);(function o6(t,n){return 0===t||0===n})(i,r)&&Q.forEach(_e=>{let Ce=_e.currentSnapshot;Object.keys(Ce).forEach(Ee=>I[Ee]=Ce[Ee])}),e=function a6(t,n,e){const i=Object.keys(e);if(i.length&&n.length){let s=n[0],o=[];if(i.forEach(d=>{s.hasOwnProperty(d)||o.push(d),s[d]=e[d]}),o.length)for(var r=1;r<n.length;r++){let d=n[r];o.forEach(function($){d[$]=Uw(t,$)})}}return n}(n,e=e.map(_e=>Ma(_e,!1)),I);const fe=function J6(t,n){let e=null,i=null;return Array.isArray(n)&&n.length?(e=a0(n[0]),n.length>1&&(i=a0(n[n.length-1]))):n&&(e=a0(n)),e||i?new e8(t,e,i):null}(n,e);return new iE(n,e,$,fe)}}let i8=(()=>{class t extends Cw{constructor(e,i){super(),this._nextAnimationId=0,this._renderer=e.createRenderer(i.body,{id:"0",encapsulation:Hs.None,styles:[],data:{animation:[]}})}build(e){const i=this._nextAnimationId.toString();this._nextAnimationId++;const r=Array.isArray(e)?xw(e):e;return rE(this._renderer,null,i,"register",[r]),new r8(i,this._renderer)}}return t.\u0275fac=function(e){return new(e||t)(tn(od),tn(Wr))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class r8 extends class _O{}{constructor(n,e){super(),this._id=n,this._renderer=e}create(n,e){return new s8(this._id,n,e||{},this._renderer)}}class s8{constructor(n,e,i,r){this.id=n,this.element=e,this._renderer=r,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",i)}_listen(n,e){return this._renderer.listen(this.element,`@@${this.id}:${n}`,e)}_command(n,...e){return rE(this._renderer,this.element,this.id,n,e)}onDone(n){this._listen("done",n)}onStart(n){this._listen("start",n)}onDestroy(n){this._listen("destroy",n)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(n){this._command("setPosition",n)}getPosition(){var n,e;return null!==(e=null===(n=this._renderer.engine.players[+this.id])||void 0===n?void 0:n.getPosition())&&void 0!==e?e:0}}function rE(t,n,e,i,r){return t.setProperty(n,`@@${e}:${i}`,r)}const sE="@.disabled";let o8=(()=>{class t{constructor(e,i,r){this.delegate=e,this.engine=i,this._zone=r,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),i.onRemovalComplete=(s,o)=>{const d=null==o?void 0:o.parentNode(s);d&&o.removeChild(d,s)}}createRenderer(e,i){const s=this.delegate.createRenderer(e,i);if(!(e&&i&&i.data&&i.data.animation)){let Q=this._rendererCache.get(s);return Q||(Q=new oE("",s,this.engine),this._rendererCache.set(s,Q)),Q}const o=i.id,d=i.id+"-"+this._currentId;this._currentId++,this.engine.register(d,e);const $=Q=>{Array.isArray(Q)?Q.forEach($):this.engine.registerTrigger(o,d,e,Q.name,Q)};return i.data.animation.forEach($),new a8(this,d,s,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(e,i,r){e>=0&&e<this._microtaskId?this._zone.run(()=>i(r)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(s=>{const[o,d]=s;o(d)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([i,r]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(e){return new(e||t)(tn(od),tn(mp),tn(bn))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class oE{constructor(n,e,i){this.namespaceId=n,this.delegate=e,this.engine=i,this.destroyNode=this.delegate.destroyNode?r=>e.destroyNode(r):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(n,e){return this.delegate.createElement(n,e)}createComment(n){return this.delegate.createComment(n)}createText(n){return this.delegate.createText(n)}appendChild(n,e){this.delegate.appendChild(n,e),this.engine.onInsert(this.namespaceId,e,n,!1)}insertBefore(n,e,i,r=!0){this.delegate.insertBefore(n,e,i),this.engine.onInsert(this.namespaceId,e,n,r)}removeChild(n,e,i){this.engine.onRemove(this.namespaceId,e,this.delegate,i)}selectRootElement(n,e){return this.delegate.selectRootElement(n,e)}parentNode(n){return this.delegate.parentNode(n)}nextSibling(n){return this.delegate.nextSibling(n)}setAttribute(n,e,i,r){this.delegate.setAttribute(n,e,i,r)}removeAttribute(n,e,i){this.delegate.removeAttribute(n,e,i)}addClass(n,e){this.delegate.addClass(n,e)}removeClass(n,e){this.delegate.removeClass(n,e)}setStyle(n,e,i,r){this.delegate.setStyle(n,e,i,r)}removeStyle(n,e,i){this.delegate.removeStyle(n,e,i)}setProperty(n,e,i){"@"==e.charAt(0)&&e==sE?this.disableAnimations(n,!!i):this.delegate.setProperty(n,e,i)}setValue(n,e){this.delegate.setValue(n,e)}listen(n,e,i){return this.delegate.listen(n,e,i)}disableAnimations(n,e){this.engine.disableAnimations(n,e)}}class a8 extends oE{constructor(n,e,i,r){super(e,i,r),this.factory=n,this.namespaceId=e}setProperty(n,e,i){"@"==e.charAt(0)?"."==e.charAt(1)&&e==sE?this.disableAnimations(n,i=void 0===i||!!i):this.engine.process(this.namespaceId,n,e.substr(1),i):this.delegate.setProperty(n,e,i)}listen(n,e,i){if("@"==e.charAt(0)){const r=function l8(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(n);let s=e.substr(1),o="";return"@"!=s.charAt(0)&&([s,o]=function c8(t){const n=t.indexOf(".");return[t.substring(0,n),t.substr(n+1)]}(s)),this.engine.listen(this.namespaceId,r,s,o,d=>{this.factory.scheduleListenerCallback(d._data||-1,i,d)})}return this.delegate.listen(n,e,i)}}let u8=(()=>{class t extends mp{constructor(e,i,r){super(e.body,i,r)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(e){return new(e||t)(tn(Wr),tn(H$),tn(e0))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();const aE=new In("AnimationModuleType"),lE=[{provide:Cw,useClass:i8},{provide:e0,useFactory:function d8(){return new k6}},{provide:mp,useClass:u8},{provide:od,useFactory:function f8(t,n,e){return new o8(t,n,e)},deps:[jh,mp,bn]}],cE=[{provide:H$,useFactory:()=>new n8},{provide:aE,useValue:"BrowserAnimations"},...lE],h8=[{provide:H$,useClass:Fw},{provide:aE,useValue:"NoopAnimations"},...lE];let p8=(()=>{class t{static withConfig(e){return{ngModule:t,providers:e.disableAnimations?h8:cE}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({providers:cE,imports:[_x]}),t})(),kd=(()=>{class t{constructor(){this.count=0,this.animeState="active"}ngOnChanges(){this.animeState="inactive",queueMicrotask(()=>{this.animeState="active"})}animationShuffleDone(e){this.animeState="inactive"}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=qt({type:t,selectors:[["badge"]],inputs:{count:"count"},features:[Ws],decls:2,vars:2,consts:[[1,"badge"]],template:function(e,i){1&e&&(X(0,"div",0),be(1),te()),2&e&&(re("@bounce",i.animeState),W(1),Ze(i.count))},styles:[".badge[_ngcontent-%COMP%]{min-width:8px;min-height:8px;font-size:8px;padding:2px 4px;border-radius:100px;text-align:center;color:#eee;background-color:#cf5252}"],data:{animation:[yn("bounce",[Qh("active",We({transform:""})),Nt("* => active",[Dt("600ms ease",Qt([We({transform:"scale3d(0.5, 0.5, 0.5)",offset:0}),We({transform:"scale3d(2, 2, 2)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])])]}}),t})();var l0,Yt=Y(5861);(l0||(l0={})).resize=function n(e,i,r,s){let o=e.width,d=e.height,$=o/(i=Math.round(i)),I=d/(r=Math.round(r)),Q=Math.ceil($/2),fe=Math.ceil(I/2),_e=e.getContext("2d"),Ce=_e.getImageData(0,0,o,d),Ee=_e.createImageData(i,r),Re=Ce.data,Le=Ee.data;for(let Be=0;Be<r;Be++)for(let Ae=0;Ae<i;Ae++){let je=4*(Ae+Be*i),Ue=0,at=0,lt=0,tt=0,Ct=0,ot=0,ht=0,pt=(Be+.5)*I,_n=Math.floor(Be*I),an=Math.ceil((Be+1)*I);for(let di=_n;di<an;di++){let Er=Math.abs(pt-(di+.5))/fe,xt=(Ae+.5)*$,Ot=Er*Er,Ht=Math.floor(Ae*$),en=Math.ceil((Ae+1)*$);for(let Nn=Ht;Nn<en;Nn++){let $i=Math.abs(xt-(Nn+.5))/Q,Ei=Math.sqrt(Ot+$i*$i);if(Ei>=1)continue;Ue=2*Ei*Ei*Ei-3*Ei*Ei+1;let Xi=4*(Nn+di*o);ht+=Ue*Re[Xi+3],lt+=Ue,Re[Xi+3]<255&&(Ue=Ue*Re[Xi+3]/250),tt+=Ue*Re[Xi],Ct+=Ue*Re[Xi+1],ot+=Ue*Re[Xi+2],at+=Ue}}Le[je]=tt/at,Le[je+1]=Ct/at,Le[je+2]=ot/at,Le[je+3]=ht/lt}!0===s?(e.width=i,e.height=r):_e.clearRect(0,0,o,d),_e.putImageData(Ee,0,0)};var no,g8=Y(7412),uE=Y(1817);!function(t){function r(){return(r=(0,Yt.Z)(function*($){return $ instanceof Blob?s($):d($)})).apply(this,arguments)}function s($){return o.apply(this,arguments)}function o(){return(o=(0,Yt.Z)(function*($){return d(yield t.readAsArrayBufferAsync($))})).apply(this,arguments)}function d($){let I=g8.create($);return uE(I).toString()}t.readAsArrayBufferAsync=function n($){return new Promise((I,Q)=>{let fe=new FileReader;fe.onload=_e=>{I(fe.result)},fe.onabort=fe.onerror=_e=>{Q(_e)},fe.readAsArrayBuffer($)})},t.readAsTextAsync=function e($){return new Promise((I,Q)=>{let fe=new FileReader;fe.onload=_e=>{I(fe.result)},fe.onabort=fe.onerror=_e=>{Q(_e)},fe.readAsText($)})},t.calcSHA256Async=function i($){return r.apply(this,arguments)}}(no||(no={}));var Ni=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(Ni||(Ni={})),Ni))();class Lt{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:"",thumbnail:{blob:null,type:"",url:""}}}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob?this.context.blob:this.context.thumbnail.blob}get url(){return this.context.url?this.context.url:this.context.thumbnail.url}get thumbnail(){return this.context.thumbnail}get state(){return this.url||this.blob?this.url&&!this.blob?Ni.URL:this.blob===this.thumbnail.blob?Ni.THUMBNAIL:Ni.COMPLETE:Ni.NULL}get isEmpty(){return this.state<=Ni.NULL}static createEmpty(n){let e=new Lt;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new Lt;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new Lt;return e.apply(n),e}}static createAsync(n){return(0,Yt.Z)(function*(){return n instanceof File?yield Lt._createAsync(n,n.name):n instanceof Blob?yield Lt._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Yt.Z)(function*(){let i=yield no.readAsArrayBufferAsync(n),r=new Lt;r.context.identifier=yield no.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.url=window.URL.createObjectURL(r.context.blob);try{r.context.thumbnail=yield Lt.createThumbnailAsync(r.context)}catch(s){throw s}return null!=r.context.name&&(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),!this.context.name&&n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==Ni.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),!this.context.thumbnail.blob&&n.thumbnail.blob&&(this.context.thumbnail.blob=n.thumbnail.blob),!this.context.thumbnail.type&&n.thumbnail.type&&(this.context.thumbnail.type=n.thumbnail.type),!this.context.thumbnail.url&&n.thumbnail.url&&(this.state!==Ni.URL&&window.URL.revokeObjectURL(this.context.thumbnail.url),this.context.thumbnail.url=n.thumbnail.url),this.createURLs()}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url,thumbnail:{blob:this.context.thumbnail.blob,type:this.context.thumbnail.type,url:this.context.thumbnail.url}}}createURLs(){this.state!==Ni.URL&&(this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob)),this.context.thumbnail.blob&&""===this.context.thumbnail.url&&(this.context.thumbnail.url=window.URL.createObjectURL(this.context.thumbnail.blob)))}revokeURLs(){this.state!==Ni.URL&&(window.URL.revokeObjectURL(this.context.url),window.URL.revokeObjectURL(this.context.thumbnail.url))}static createThumbnailAsync(n){return new Promise((e,i)=>{let r=new Image;r.onload=s=>{let o=Math.min(128/Math.max(r.width,r.height),1),d=r.width*o,$=r.height*o,I=document.createElement("canvas"),Q=I.getContext("2d");I.width=r.width,I.height=r.height,Q.drawImage(r,0,0),l0.resize(I,d,$,!0),I.toBlob(fe=>{let _e={type:fe.type,blob:fe,url:window.URL.createObjectURL(fe)};e(_e)},n.blob.type)},r.onabort=r.onerror=()=>{i()},r.src=n.url})}}Lt.Empty=Lt.createEmpty("null");let Xc=0;const Md=new Map,$p=new MessageChannel;function vr(t){if(4294967296===Xc&&(Xc=0),++Xc in Md)throw new Error("setZeroTimeout queue overflow.");return Md.set(Xc,t),$p.port2.postMessage(Xc),Xc}$p.port1.onmessage=function(t){const n=Md.get(t.data);Md.delete(t.data),n&&n()},$p.port1.start(),$p.port2.start();class dE{}var fE=Y(8497),Da=(()=>(function(t){t[t.UNSPECIFIED=0]="UNSPECIFIED",t[t.LOW=1]="LOW",t[t.MIDDLE=2]="MIDDLE",t[t.HIGH=3]="HIGH"}(Da||(Da={})),Da))();const $8=function _8(t){if(t.length>=255)throw new TypeError("Alphabet too long");const n=new Uint8Array(256);for(let I=0;I<n.length;I++)n[I]=255;for(let I=0;I<t.length;I++){const Q=t.charAt(I),fe=Q.charCodeAt(0);if(255!==n[fe])throw new TypeError(Q+" is ambiguous");n[fe]=I}const e=t.length,i=t.charAt(0),r=Math.log(e)/Math.log(256),s=Math.log(256)/Math.log(e);function d(I){if("string"!=typeof I)throw new TypeError("Expected String");if(0===I.length)return new Uint8Array;let Q=0;if(" "===I[Q])return;let fe=0,_e=0;for(;I[Q]===i;)fe++,Q++;const Ce=(I.length-Q)*r+1>>>0,Ee=new Uint8Array(Ce);for(;I[Q];){let Ae=n[I.charCodeAt(Q)];if(255===Ae)return;let je=0;for(let Ue=Ce-1;(0!==Ae||je<_e)&&-1!==Ue;Ue--,je++)Ae+=e*Ee[Ue]>>>0,Ee[Ue]=Ae%256>>>0,Ae=Ae/256>>>0;if(0!==Ae)throw new Error("Non-zero carry");_e=je,Q++}if(" "===I[Q])return;let Re=Ce-_e;for(;Re!==Ce&&0===Ee[Re];)Re++;const Le=new Uint8Array(fe+(Ce-Re));let Be=fe;for(;Re!==Ce;)Le[Be++]=Ee[Re++];return Le}return{encode:function o(I){if(I instanceof Uint8Array||(ArrayBuffer.isView(I)?I=new Uint8Array(I.buffer,I.byteOffset,I.byteLength):Array.isArray(I)&&(I=Uint8Array.from(I))),!(I instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(0===I.length)return"";let Q=0,fe=0,_e=0;const Ce=I.length;for(;_e!==Ce&&0===I[_e];)_e++,Q++;const Ee=(Ce-_e)*s+1>>>0,Re=new Uint8Array(Ee);for(;_e!==Ce;){let Ae=I[_e],je=0;for(let Ue=Ee-1;(0!==Ae||je<fe)&&-1!==Ue;Ue--,je++)Ae+=256*Re[Ue]>>>0,Re[Ue]=Ae%e>>>0,Ae=Ae/e>>>0;if(0!==Ae)throw new Error("Non-zero carry");fe=je,_e++}let Le=Ee-fe;for(;Le!==Ee&&0===Re[Le];)Le++;let Be=i.repeat(Q);for(;Le<Ee;++Le)Be+=t.charAt(Re[Le]);return Be},decodeUnsafe:d,decode:function $(I){const Q=d(I);if(Q)return Q;throw new Error("Non-base"+e+" character")}}}("0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),v8=/^(\w{6})(\w{3})(\w*)-(\w*)/i;class ai{constructor(n){this.peerId="",this.userId="",this.roomId="",this.roomName="",this.password="",this.digestUserId="",this.digestPassword="",this.isOpen=!1,this.session={grade:Da.UNSPECIFIED,ping:0,health:0,speed:0,description:""},this.parse(n)}get isRoom(){return 0<this.roomId.length}get hasPassword(){return 0<this.password.length+this.digestPassword.length}parse(n){try{this.peerId=n;let e=v8.exec(n);if(null!=e)return this.digestUserId=e[1],this.roomId=e[2],this.roomName=fE.L(e[3]),void(this.digestPassword=e[4])}catch(e){console.warn(e)}this.digestUserId=n}verifyPassword(n){return hE(this.roomId,n)===this.digestPassword}static parse(n){return new ai(n)}static create(...n){return n.length<=1?ai._create.apply(this,n):ai._createRoom.apply(this,n)}static _create(n=""){let e=function b8(t){return null==t?"":pE(t)}(n),i=new ai(e);return i.userId=n,i}static _createRoom(n="",e="",i="",r=""){let s=this.generateId("******"),o=hE(e,r),d=`${s}${e}${fE.n(i)}-${o}`,$=new ai(d);return $.userId=n,$.password=r,$}static generateId(n="********"){const e="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";let i=n;return i=n.replace(/\*/g,r=>e[Math.floor(Math.random()*e.length)]),i}}function hE(t,n){return null==t||null==n?"":0<n.length?pE(t+n,7):""}function pE(t,n=-1){if(null==t)return"";let e=uE(t),i=new Uint8Array(Uint32Array.from(e.words).buffer),r=$8.encode(i);return n<0&&(n=r.length),r.length<n&&(n=r.length),r=r.slice(0,n),r}function Qc(t){let n=t.length;for(;--n>=0;)t[n]=0}const h0=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),vp=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),S8=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),CE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ea=new Array(576);Qc(ea);const Pd=new Array(60);Qc(Pd);const Nd=new Array(512);Qc(Nd);const Fd=new Array(256);Qc(Fd);const p0=new Array(29);Qc(p0);const bp=new Array(30);function g0(t,n,e,i,r){this.static_tree=t,this.extra_bits=n,this.extra_base=e,this.elems=i,this.max_length=r,this.has_stree=t&&t.length}let xE,wE,EE;function m0(t,n){this.dyn_tree=t,this.max_code=0,this.stat_desc=n}Qc(bp);const TE=t=>t<256?Nd[t]:Nd[256+(t>>>7)],Rd=(t,n)=>{t.pending_buf[t.pending++]=255&n,t.pending_buf[t.pending++]=n>>>8&255},Xr=(t,n,e)=>{t.bi_valid>16-e?(t.bi_buf|=n<<t.bi_valid&65535,Rd(t,t.bi_buf),t.bi_buf=n>>16-t.bi_valid,t.bi_valid+=e-16):(t.bi_buf|=n<<t.bi_valid&65535,t.bi_valid+=e)},wo=(t,n,e)=>{Xr(t,e[2*n],e[2*n+1])},IE=(t,n)=>{let e=0;do{e|=1&t,t>>>=1,e<<=1}while(--n>0);return e>>>1},SE=(t,n,e)=>{const i=new Array(16);let s,o,r=0;for(s=1;s<=15;s++)i[s]=r=r+e[s-1]<<1;for(o=0;o<=n;o++){let d=t[2*o+1];0!==d&&(t[2*o]=IE(i[d]++,d))}},kE=t=>{let n;for(n=0;n<286;n++)t.dyn_ltree[2*n]=0;for(n=0;n<30;n++)t.dyn_dtree[2*n]=0;for(n=0;n<19;n++)t.bl_tree[2*n]=0;t.dyn_ltree[512]=1,t.opt_len=t.static_len=0,t.last_lit=t.matches=0},ME=t=>{t.bi_valid>8?Rd(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},DE=(t,n,e,i)=>{const r=2*n,s=2*e;return t[r]<t[s]||t[r]===t[s]&&i[n]<=i[e]},_0=(t,n,e)=>{const i=t.heap[e];let r=e<<1;for(;r<=t.heap_len&&(r<t.heap_len&&DE(n,t.heap[r+1],t.heap[r],t.depth)&&r++,!DE(n,i,t.heap[r],t.depth));)t.heap[e]=t.heap[r],e=r,r<<=1;t.heap[e]=i},AE=(t,n,e)=>{let i,r,o,d,s=0;if(0!==t.last_lit)do{i=t.pending_buf[t.d_buf+2*s]<<8|t.pending_buf[t.d_buf+2*s+1],r=t.pending_buf[t.l_buf+s],s++,0===i?wo(t,r,n):(o=Fd[r],wo(t,o+256+1,n),d=h0[o],0!==d&&(r-=p0[o],Xr(t,r,d)),i--,o=TE(i),wo(t,o,e),d=vp[o],0!==d&&(i-=bp[o],Xr(t,i,d)))}while(s<t.last_lit);wo(t,256,n)},$0=(t,n)=>{const e=n.dyn_tree,i=n.stat_desc.static_tree,r=n.stat_desc.has_stree,s=n.stat_desc.elems;let o,d,I,$=-1;for(t.heap_len=0,t.heap_max=573,o=0;o<s;o++)0!==e[2*o]?(t.heap[++t.heap_len]=$=o,t.depth[o]=0):e[2*o+1]=0;for(;t.heap_len<2;)I=t.heap[++t.heap_len]=$<2?++$:0,e[2*I]=1,t.depth[I]=0,t.opt_len--,r&&(t.static_len-=i[2*I+1]);for(n.max_code=$,o=t.heap_len>>1;o>=1;o--)_0(t,e,o);I=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],_0(t,e,1),d=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=d,e[2*I]=e[2*o]+e[2*d],t.depth[I]=(t.depth[o]>=t.depth[d]?t.depth[o]:t.depth[d])+1,e[2*o+1]=e[2*d+1]=I,t.heap[1]=I++,_0(t,e,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],((t,n)=>{const e=n.dyn_tree,i=n.max_code,r=n.stat_desc.static_tree,s=n.stat_desc.has_stree,o=n.stat_desc.extra_bits,d=n.stat_desc.extra_base,$=n.stat_desc.max_length;let I,Q,fe,_e,Ce,Ee,Re=0;for(_e=0;_e<=15;_e++)t.bl_count[_e]=0;for(e[2*t.heap[t.heap_max]+1]=0,I=t.heap_max+1;I<573;I++)Q=t.heap[I],_e=e[2*e[2*Q+1]+1]+1,_e>$&&(_e=$,Re++),e[2*Q+1]=_e,!(Q>i)&&(t.bl_count[_e]++,Ce=0,Q>=d&&(Ce=o[Q-d]),Ee=e[2*Q],t.opt_len+=Ee*(_e+Ce),s&&(t.static_len+=Ee*(r[2*Q+1]+Ce)));if(0!==Re){do{for(_e=$-1;0===t.bl_count[_e];)_e--;t.bl_count[_e]--,t.bl_count[_e+1]+=2,t.bl_count[$]--,Re-=2}while(Re>0);for(_e=$;0!==_e;_e--)for(Q=t.bl_count[_e];0!==Q;)fe=t.heap[--I],!(fe>i)&&(e[2*fe+1]!==_e&&(t.opt_len+=(_e-e[2*fe+1])*e[2*fe],e[2*fe+1]=_e),Q--)}})(t,n),SE(e,$,t.bl_count)},PE=(t,n,e)=>{let i,s,r=-1,o=n[1],d=0,$=7,I=4;for(0===o&&($=138,I=3),n[2*(e+1)+1]=65535,i=0;i<=e;i++)s=o,o=n[2*(i+1)+1],!(++d<$&&s===o)&&(d<I?t.bl_tree[2*s]+=d:0!==s?(s!==r&&t.bl_tree[2*s]++,t.bl_tree[32]++):d<=10?t.bl_tree[34]++:t.bl_tree[36]++,d=0,r=s,0===o?($=138,I=3):s===o?($=6,I=3):($=7,I=4))},NE=(t,n,e)=>{let i,s,r=-1,o=n[1],d=0,$=7,I=4;for(0===o&&($=138,I=3),i=0;i<=e;i++)if(s=o,o=n[2*(i+1)+1],!(++d<$&&s===o)){if(d<I)do{wo(t,s,t.bl_tree)}while(0!=--d);else 0!==s?(s!==r&&(wo(t,s,t.bl_tree),d--),wo(t,16,t.bl_tree),Xr(t,d-3,2)):d<=10?(wo(t,17,t.bl_tree),Xr(t,d-3,3)):(wo(t,18,t.bl_tree),Xr(t,d-11,7));d=0,r=s,0===o?($=138,I=3):s===o?($=6,I=3):($=7,I=4)}};let FE=!1;const RE=(t,n,e,i)=>{Xr(t,0+(i?1:0),3),((t,n,e,i)=>{ME(t),Rd(t,e),Rd(t,~e),t.pending_buf.set(t.window.subarray(n,n+e),t.pending),t.pending+=e})(t,n,e)};var q8={_tr_init:t=>{FE||((()=>{let t,n,e,i,r;const s=new Array(16);for(e=0,i=0;i<28;i++)for(p0[i]=e,t=0;t<1<<h0[i];t++)Fd[e++]=i;for(Fd[e-1]=i,r=0,i=0;i<16;i++)for(bp[i]=r,t=0;t<1<<vp[i];t++)Nd[r++]=i;for(r>>=7;i<30;i++)for(bp[i]=r<<7,t=0;t<1<<vp[i]-7;t++)Nd[256+r++]=i;for(n=0;n<=15;n++)s[n]=0;for(t=0;t<=143;)ea[2*t+1]=8,t++,s[8]++;for(;t<=255;)ea[2*t+1]=9,t++,s[9]++;for(;t<=279;)ea[2*t+1]=7,t++,s[7]++;for(;t<=287;)ea[2*t+1]=8,t++,s[8]++;for(SE(ea,287,s),t=0;t<30;t++)Pd[2*t+1]=5,Pd[2*t]=IE(t,5);xE=new g0(ea,h0,257,286,15),wE=new g0(Pd,vp,0,30,15),EE=new g0(new Array(0),S8,0,19,7)})(),FE=!0),t.l_desc=new m0(t.dyn_ltree,xE),t.d_desc=new m0(t.dyn_dtree,wE),t.bl_desc=new m0(t.bl_tree,EE),t.bi_buf=0,t.bi_valid=0,kE(t)},_tr_stored_block:RE,_tr_flush_block:(t,n,e,i)=>{let r,s,o=0;t.level>0?(2===t.strm.data_type&&(t.strm.data_type=(t=>{let e,n=4093624447;for(e=0;e<=31;e++,n>>>=1)if(1&n&&0!==t.dyn_ltree[2*e])return 0;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return 1;for(e=32;e<256;e++)if(0!==t.dyn_ltree[2*e])return 1;return 0})(t)),$0(t,t.l_desc),$0(t,t.d_desc),o=(t=>{let n;for(PE(t,t.dyn_ltree,t.l_desc.max_code),PE(t,t.dyn_dtree,t.d_desc.max_code),$0(t,t.bl_desc),n=18;n>=3&&0===t.bl_tree[2*CE[n]+1];n--);return t.opt_len+=3*(n+1)+5+5+4,n})(t),r=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=r&&(r=s)):r=s=e+5,e+4<=r&&-1!==n?RE(t,n,e,i):4===t.strategy||s===r?(Xr(t,2+(i?1:0),3),AE(t,ea,Pd)):(Xr(t,4+(i?1:0),3),((t,n,e,i)=>{let r;for(Xr(t,n-257,5),Xr(t,e-1,5),Xr(t,i-4,4),r=0;r<i;r++)Xr(t,t.bl_tree[2*CE[r]+1],3);NE(t,t.dyn_ltree,n-1),NE(t,t.dyn_dtree,e-1)})(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),AE(t,t.dyn_ltree,t.dyn_dtree)),kE(t),i&&ME(t)},_tr_tally:(t,n,e)=>(t.pending_buf[t.d_buf+2*t.last_lit]=n>>>8&255,t.pending_buf[t.d_buf+2*t.last_lit+1]=255&n,t.pending_buf[t.l_buf+t.last_lit]=255&e,t.last_lit++,0===n?t.dyn_ltree[2*e]++:(t.matches++,n--,t.dyn_ltree[2*(Fd[e]+256+1)]++,t.dyn_dtree[2*TE(n)]++),t.last_lit===t.lit_bufsize-1),_tr_align:t=>{Xr(t,2,3),wo(t,256,ea),(t=>{16===t.bi_valid?(Rd(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)})(t)}},Od=(t,n,e,i)=>{let r=65535&t|0,s=t>>>16&65535|0,o=0;for(;0!==e;){o=e>2e3?2e3:e,e-=o;do{r=r+n[i++]|0,s=s+r|0}while(--o);r%=65521,s%=65521}return r|s<<16|0};const K8=new Uint32Array((()=>{let t,n=[];for(var e=0;e<256;e++){t=e;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;n[e]=t}return n})());var er=(t,n,e,i)=>{const r=K8,s=i+e;t^=-1;for(let o=i;o<s;o++)t=t>>>8^r[255&(t^n[o])];return-1^t},Il={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Sl={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Y8,_tr_stored_block:Z8,_tr_flush_block:X8,_tr_tally:Aa,_tr_align:Q8}=q8,{Z_NO_FLUSH:kl,Z_PARTIAL_FLUSH:J8,Z_FULL_FLUSH:eB,Z_FINISH:Pa,Z_BLOCK:OE,Z_OK:Eo,Z_STREAM_END:BE,Z_STREAM_ERROR:As,Z_DATA_ERROR:tB,Z_BUF_ERROR:v0,Z_DEFAULT_COMPRESSION:nB,Z_FILTERED:iB,Z_HUFFMAN_ONLY:yp,Z_RLE:rB,Z_FIXED:sB,Z_DEFAULT_STRATEGY:oB,Z_UNKNOWN:aB,Z_DEFLATED:Cp}=Sl,io=262,Fa=(t,n)=>(t.msg=Il[n],n),LE=t=>(t<<1)-(t>4?9:0),Ra=t=>{let n=t.length;for(;--n>=0;)t[n]=0};let Oa=(t,n,e)=>(n<<t.hash_shift^e)&t.hash_mask;const Ba=t=>{const n=t.state;let e=n.pending;e>t.avail_out&&(e=t.avail_out),0!==e&&(t.output.set(n.pending_buf.subarray(n.pending_out,n.pending_out+e),t.next_out),t.next_out+=e,n.pending_out+=e,t.total_out+=e,t.avail_out-=e,n.pending-=e,0===n.pending&&(n.pending_out=0))},or=(t,n)=>{X8(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,n),t.block_start=t.strstart,Ba(t.strm)},Bn=(t,n)=>{t.pending_buf[t.pending++]=n},zd=(t,n)=>{t.pending_buf[t.pending++]=n>>>8&255,t.pending_buf[t.pending++]=255&n},$B=(t,n,e,i)=>{let r=t.avail_in;return r>i&&(r=i),0===r?0:(t.avail_in-=r,n.set(t.input.subarray(t.next_in,t.next_in+r),e),1===t.state.wrap?t.adler=Od(t.adler,n,r,e):2===t.state.wrap&&(t.adler=er(t.adler,n,r,e)),t.next_in+=r,t.total_in+=r,r)},zE=(t,n)=>{let r,s,e=t.max_chain_length,i=t.strstart,o=t.prev_length,d=t.nice_match;const $=t.strstart>t.w_size-io?t.strstart-(t.w_size-io):0,I=t.window,Q=t.w_mask,fe=t.prev,_e=t.strstart+258;let Ce=I[i+o-1],Ee=I[i+o];t.prev_length>=t.good_match&&(e>>=2),d>t.lookahead&&(d=t.lookahead);do{if(r=n,I[r+o]===Ee&&I[r+o-1]===Ce&&I[r]===I[i]&&I[++r]===I[i+1]){i+=2,r++;do{}while(I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&I[++i]===I[++r]&&i<_e);if(s=258-(_e-i),i=_e-258,s>o){if(t.match_start=n,o=s,s>=d)break;Ce=I[i+o-1],Ee=I[i+o]}}}while((n=fe[n&Q])>$&&0!=--e);return o<=t.lookahead?o:t.lookahead},Al=t=>{const n=t.w_size;let e,i,r,s,o;do{if(s=t.window_size-t.lookahead-t.strstart,t.strstart>=n+(n-io)){t.window.set(t.window.subarray(n,n+n),0),t.match_start-=n,t.strstart-=n,t.block_start-=n,i=t.hash_size,e=i;do{r=t.head[--e],t.head[e]=r>=n?r-n:0}while(--i);i=n,e=i;do{r=t.prev[--e],t.prev[e]=r>=n?r-n:0}while(--i);s+=n}if(0===t.strm.avail_in)break;if(i=$B(t.strm,t.window,t.strstart+t.lookahead,s),t.lookahead+=i,t.lookahead+t.insert>=3)for(o=t.strstart-t.insert,t.ins_h=t.window[o],t.ins_h=Oa(t,t.ins_h,t.window[o+1]);t.insert&&(t.ins_h=Oa(t,t.ins_h,t.window[o+3-1]),t.prev[o&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=o,o++,t.insert--,!(t.lookahead+t.insert<3)););}while(t.lookahead<io&&0!==t.strm.avail_in)},C0=(t,n)=>{let e,i;for(;;){if(t.lookahead<io){if(Al(t),t.lookahead<io&&n===kl)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Oa(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==e&&t.strstart-e<=t.w_size-io&&(t.match_length=zE(t,e)),t.match_length>=3)if(i=Aa(t,t.strstart-t.match_start,t.match_length-3),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=3){t.match_length--;do{t.strstart++,t.ins_h=Oa(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!=--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=Oa(t,t.ins_h,t.window[t.strstart+1]);else i=Aa(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(or(t,!1),0===t.strm.avail_out))return 1}return t.insert=t.strstart<2?t.strstart:2,n===Pa?(or(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(or(t,!1),0===t.strm.avail_out)?1:2},tu=(t,n)=>{let e,i,r;for(;;){if(t.lookahead<io){if(Al(t),t.lookahead<io&&n===kl)return 1;if(0===t.lookahead)break}if(e=0,t.lookahead>=3&&(t.ins_h=Oa(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=2,0!==e&&t.prev_length<t.max_lazy_match&&t.strstart-e<=t.w_size-io&&(t.match_length=zE(t,e),t.match_length<=5&&(t.strategy===iB||3===t.match_length&&t.strstart-t.match_start>4096)&&(t.match_length=2)),t.prev_length>=3&&t.match_length<=t.prev_length){r=t.strstart+t.lookahead-3,i=Aa(t,t.strstart-1-t.prev_match,t.prev_length-3),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=r&&(t.ins_h=Oa(t,t.ins_h,t.window[t.strstart+3-1]),e=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!=--t.prev_length);if(t.match_available=0,t.match_length=2,t.strstart++,i&&(or(t,!1),0===t.strm.avail_out))return 1}else if(t.match_available){if(i=Aa(t,0,t.window[t.strstart-1]),i&&or(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return 1}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=Aa(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<2?t.strstart:2,n===Pa?(or(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(or(t,!1),0===t.strm.avail_out)?1:2};function To(t,n,e,i,r){this.good_length=t,this.max_lazy=n,this.nice_length=e,this.max_chain=i,this.func=r}const jd=[new To(0,0,0,0,(t,n)=>{let e=65535;for(e>t.pending_buf_size-5&&(e=t.pending_buf_size-5);;){if(t.lookahead<=1){if(Al(t),0===t.lookahead&&n===kl)return 1;if(0===t.lookahead)break}t.strstart+=t.lookahead,t.lookahead=0;const i=t.block_start+e;if((0===t.strstart||t.strstart>=i)&&(t.lookahead=t.strstart-i,t.strstart=i,or(t,!1),0===t.strm.avail_out)||t.strstart-t.block_start>=t.w_size-io&&(or(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Pa?(or(t,!0),0===t.strm.avail_out?3:4):(t.strstart>t.block_start&&or(t,!1),1)}),new To(4,4,8,4,C0),new To(4,5,16,8,C0),new To(4,6,32,32,C0),new To(4,4,16,16,tu),new To(8,16,32,32,tu),new To(8,16,128,128,tu),new To(8,32,128,256,tu),new To(32,128,258,1024,tu),new To(32,258,258,4096,tu)];function xB(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Cp,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(1146),this.dyn_dtree=new Uint16Array(122),this.bl_tree=new Uint16Array(78),Ra(this.dyn_ltree),Ra(this.dyn_dtree),Ra(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(16),this.heap=new Uint16Array(573),Ra(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(573),Ra(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const jE=t=>{if(!t||!t.state)return Fa(t,As);t.total_in=t.total_out=0,t.data_type=aB;const n=t.state;return n.pending=0,n.pending_out=0,n.wrap<0&&(n.wrap=-n.wrap),n.status=n.wrap?42:113,t.adler=2===n.wrap?0:1,n.last_flush=kl,Y8(n),Eo},UE=t=>{const n=jE(t);return n===Eo&&(t=>{t.window_size=2*t.w_size,Ra(t.head),t.max_lazy_match=jd[t.level].max_lazy,t.good_match=jd[t.level].good_length,t.nice_match=jd[t.level].nice_length,t.max_chain_length=jd[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0})(t.state),n},HE=(t,n,e,i,r,s)=>{if(!t)return As;let o=1;if(n===nB&&(n=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),r<1||r>9||e!==Cp||i<8||i>15||n<0||n>9||s<0||s>sB)return Fa(t,As);8===i&&(i=9);const d=new xB;return t.state=d,d.strm=t,d.wrap=o,d.gzhead=null,d.w_bits=i,d.w_size=1<<d.w_bits,d.w_mask=d.w_size-1,d.hash_bits=r+7,d.hash_size=1<<d.hash_bits,d.hash_mask=d.hash_size-1,d.hash_shift=~~((d.hash_bits+3-1)/3),d.window=new Uint8Array(2*d.w_size),d.head=new Uint16Array(d.hash_size),d.prev=new Uint16Array(d.w_size),d.lit_bufsize=1<<r+6,d.pending_buf_size=4*d.lit_bufsize,d.pending_buf=new Uint8Array(d.pending_buf_size),d.d_buf=1*d.lit_bufsize,d.l_buf=3*d.lit_bufsize,d.level=n,d.strategy=s,d.method=e,UE(t)};var Ud_deflateInit2=HE,Ud_deflateSetHeader=(t,n)=>t&&t.state&&2===t.state.wrap?(t.state.gzhead=n,Eo):As,Ud_deflate=(t,n)=>{let e,i;if(!t||!t.state||n>OE||n<0)return t?Fa(t,As):As;const r=t.state;if(!t.output||!t.input&&0!==t.avail_in||666===r.status&&n!==Pa)return Fa(t,0===t.avail_out?v0:As);r.strm=t;const s=r.last_flush;if(r.last_flush=n,42===r.status)if(2===r.wrap)t.adler=0,Bn(r,31),Bn(r,139),Bn(r,8),r.gzhead?(Bn(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Bn(r,255&r.gzhead.time),Bn(r,r.gzhead.time>>8&255),Bn(r,r.gzhead.time>>16&255),Bn(r,r.gzhead.time>>24&255),Bn(r,9===r.level?2:r.strategy>=yp||r.level<2?4:0),Bn(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Bn(r,255&r.gzhead.extra.length),Bn(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=er(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=69):(Bn(r,0),Bn(r,0),Bn(r,0),Bn(r,0),Bn(r,0),Bn(r,9===r.level?2:r.strategy>=yp||r.level<2?4:0),Bn(r,3),r.status=113);else{let o=Cp+(r.w_bits-8<<4)<<8,d=-1;d=r.strategy>=yp||r.level<2?0:r.level<6?1:6===r.level?2:3,o|=d<<6,0!==r.strstart&&(o|=32),o+=31-o%31,r.status=113,zd(r,o),0!==r.strstart&&(zd(r,t.adler>>>16),zd(r,65535&t.adler)),t.adler=1}if(69===r.status)if(r.gzhead.extra){for(e=r.pending;r.gzindex<(65535&r.gzhead.extra.length)&&(r.pending!==r.pending_buf_size||(r.gzhead.hcrc&&r.pending>e&&(t.adler=er(t.adler,r.pending_buf,r.pending-e,e)),Ba(t),e=r.pending,r.pending!==r.pending_buf_size));)Bn(r,255&r.gzhead.extra[r.gzindex]),r.gzindex++;r.gzhead.hcrc&&r.pending>e&&(t.adler=er(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex===r.gzhead.extra.length&&(r.gzindex=0,r.status=73)}else r.status=73;if(73===r.status)if(r.gzhead.name){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(t.adler=er(t.adler,r.pending_buf,r.pending-e,e)),Ba(t),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Bn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(t.adler=er(t.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.gzindex=0,r.status=91)}else r.status=91;if(91===r.status)if(r.gzhead.comment){e=r.pending;do{if(r.pending===r.pending_buf_size&&(r.gzhead.hcrc&&r.pending>e&&(t.adler=er(t.adler,r.pending_buf,r.pending-e,e)),Ba(t),e=r.pending,r.pending===r.pending_buf_size)){i=1;break}i=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Bn(r,i)}while(0!==i);r.gzhead.hcrc&&r.pending>e&&(t.adler=er(t.adler,r.pending_buf,r.pending-e,e)),0===i&&(r.status=103)}else r.status=103;if(103===r.status&&(r.gzhead.hcrc?(r.pending+2>r.pending_buf_size&&Ba(t),r.pending+2<=r.pending_buf_size&&(Bn(r,255&t.adler),Bn(r,t.adler>>8&255),t.adler=0,r.status=113)):r.status=113),0!==r.pending){if(Ba(t),0===t.avail_out)return r.last_flush=-1,Eo}else if(0===t.avail_in&&LE(n)<=LE(s)&&n!==Pa)return Fa(t,v0);if(666===r.status&&0!==t.avail_in)return Fa(t,v0);if(0!==t.avail_in||0!==r.lookahead||n!==kl&&666!==r.status){let o=r.strategy===yp?((t,n)=>{let e;for(;;){if(0===t.lookahead&&(Al(t),0===t.lookahead)){if(n===kl)return 1;break}if(t.match_length=0,e=Aa(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,e&&(or(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Pa?(or(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(or(t,!1),0===t.strm.avail_out)?1:2})(r,n):r.strategy===rB?((t,n)=>{let e,i,r,s;const o=t.window;for(;;){if(t.lookahead<=258){if(Al(t),t.lookahead<=258&&n===kl)return 1;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=3&&t.strstart>0&&(r=t.strstart-1,i=o[r],i===o[++r]&&i===o[++r]&&i===o[++r])){s=t.strstart+258;do{}while(i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&i===o[++r]&&r<s);t.match_length=258-(s-r),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=3?(e=Aa(t,1,t.match_length-3),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(e=Aa(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),e&&(or(t,!1),0===t.strm.avail_out))return 1}return t.insert=0,n===Pa?(or(t,!0),0===t.strm.avail_out?3:4):t.last_lit&&(or(t,!1),0===t.strm.avail_out)?1:2})(r,n):jd[r.level].func(r,n);if((3===o||4===o)&&(r.status=666),1===o||3===o)return 0===t.avail_out&&(r.last_flush=-1),Eo;if(2===o&&(n===J8?Q8(r):n!==OE&&(Z8(r,0,0,!1),n===eB&&(Ra(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),Ba(t),0===t.avail_out))return r.last_flush=-1,Eo}return n!==Pa?Eo:r.wrap<=0?BE:(2===r.wrap?(Bn(r,255&t.adler),Bn(r,t.adler>>8&255),Bn(r,t.adler>>16&255),Bn(r,t.adler>>24&255),Bn(r,255&t.total_in),Bn(r,t.total_in>>8&255),Bn(r,t.total_in>>16&255),Bn(r,t.total_in>>24&255)):(zd(r,t.adler>>>16),zd(r,65535&t.adler)),Ba(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Eo:BE)},Ud_deflateEnd=t=>{if(!t||!t.state)return As;const n=t.state.status;return 42!==n&&69!==n&&73!==n&&91!==n&&103!==n&&113!==n&&666!==n?Fa(t,As):(t.state=null,113===n?Fa(t,tB):Eo)},Ud_deflateSetDictionary=(t,n)=>{let e=n.length;if(!t||!t.state)return As;const i=t.state,r=i.wrap;if(2===r||1===r&&42!==i.status||i.lookahead)return As;if(1===r&&(t.adler=Od(t.adler,n,e,0)),i.wrap=0,e>=i.w_size){0===r&&(Ra(i.head),i.strstart=0,i.block_start=0,i.insert=0);let $=new Uint8Array(i.w_size);$.set(n.subarray(e-i.w_size,e),0),n=$,e=i.w_size}const s=t.avail_in,o=t.next_in,d=t.input;for(t.avail_in=e,t.next_in=0,t.input=n,Al(i);i.lookahead>=3;){let $=i.strstart,I=i.lookahead-2;do{i.ins_h=Oa(i,i.ins_h,i.window[$+3-1]),i.prev[$&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=$,$++}while(--I);i.strstart=$,i.lookahead=2,Al(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=2,i.match_available=0,t.next_in=o,t.input=d,t.avail_in=s,i.wrap=r,Eo};const BB=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var Ip_assign=function(t){const n=Array.prototype.slice.call(arguments,1);for(;n.length;){const e=n.shift();if(e){if("object"!=typeof e)throw new TypeError(e+"must be non-object");for(const i in e)BB(e,i)&&(t[i]=e[i])}}return t},Ip_flattenChunks=t=>{let n=0;for(let i=0,r=t.length;i<r;i++)n+=t[i].length;const e=new Uint8Array(n);for(let i=0,r=0,s=t.length;i<s;i++){let o=t[i];e.set(o,r),r+=o.length}return e};let VE=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(t){VE=!1}const Hd=new Uint8Array(256);for(let t=0;t<256;t++)Hd[t]=t>=252?6:t>=248?5:t>=240?4:t>=224?3:t>=192?2:1;Hd[254]=Hd[254]=1;var Vd_string2buf=t=>{if("function"==typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let n,e,i,r,s,o=t.length,d=0;for(r=0;r<o;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<o&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),d+=e<128?1:e<2048?2:e<65536?3:4;for(n=new Uint8Array(d),s=0,r=0;s<d;r++)e=t.charCodeAt(r),55296==(64512&e)&&r+1<o&&(i=t.charCodeAt(r+1),56320==(64512&i)&&(e=65536+(e-55296<<10)+(i-56320),r++)),e<128?n[s++]=e:e<2048?(n[s++]=192|e>>>6,n[s++]=128|63&e):e<65536?(n[s++]=224|e>>>12,n[s++]=128|e>>>6&63,n[s++]=128|63&e):(n[s++]=240|e>>>18,n[s++]=128|e>>>12&63,n[s++]=128|e>>>6&63,n[s++]=128|63&e);return n},Vd_buf2string=(t,n)=>{const e=n||t.length;if("function"==typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,n));let i,r;const s=new Array(2*e);for(r=0,i=0;i<e;){let o=t[i++];if(o<128){s[r++]=o;continue}let d=Hd[o];if(d>4)s[r++]=65533,i+=d-1;else{for(o&=2===d?31:3===d?15:7;d>1&&i<e;)o=o<<6|63&t[i++],d--;d>1?s[r++]=65533:o<65536?s[r++]=o:(o-=65536,s[r++]=55296|o>>10&1023,s[r++]=56320|1023&o)}}return((t,n)=>{if(n<65534&&t.subarray&&VE)return String.fromCharCode.apply(null,t.length===n?t:t.subarray(0,n));let e="";for(let i=0;i<n;i++)e+=String.fromCharCode(t[i]);return e})(s,r)},Vd_utf8border=(t,n)=>{(n=n||t.length)>t.length&&(n=t.length);let e=n-1;for(;e>=0&&128==(192&t[e]);)e--;return e<0||0===e?n:e+Hd[t[e]]>n?e:n},GE=function GB(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0};const qE=Object.prototype.toString,{Z_NO_FLUSH:qB,Z_SYNC_FLUSH:WB,Z_FULL_FLUSH:KB,Z_FINISH:YB,Z_OK:Sp,Z_STREAM_END:ZB,Z_DEFAULT_COMPRESSION:XB,Z_DEFAULT_STRATEGY:QB,Z_DEFLATED:JB}=Sl;function Gd(t){this.options=Ip_assign({level:XB,method:JB,chunkSize:16384,windowBits:15,memLevel:8,strategy:QB},t||{});let n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new GE,this.strm.avail_out=0;let e=Ud_deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(e!==Sp)throw new Error(Il[e]);if(n.header&&Ud_deflateSetHeader(this.strm,n.header),n.dictionary){let i;if(i="string"==typeof n.dictionary?Vd_string2buf(n.dictionary):"[object ArrayBuffer]"===qE.call(n.dictionary)?new Uint8Array(n.dictionary):n.dictionary,e=Ud_deflateSetDictionary(this.strm,i),e!==Sp)throw new Error(Il[e]);this._dict_set=!0}}function x0(t,n){const e=new Gd(n);if(e.push(t,!0),e.err)throw e.msg||Il[e.err];return e.result}Gd.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize;let r,s;if(this.ended)return!1;for(s=n===~~n?n:!0===n?YB:qB,e.input="string"==typeof t?Vd_string2buf(t):"[object ArrayBuffer]"===qE.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;)if(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),(s===WB||s===KB)&&e.avail_out<=6)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else{if(r=Ud_deflate(e,s),r===ZB)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),r=Ud_deflateEnd(this.strm),this.onEnd(r),this.ended=!0,r===Sp;if(0!==e.avail_out){if(s>0&&e.next_out>0)this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;else if(0===e.avail_in)break}else this.onData(e.output)}return!0},Gd.prototype.onData=function(t){this.chunks.push(t)},Gd.prototype.onEnd=function(t){t===Sp&&(this.result=Ip_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var aL={Deflate:Gd,deflate:x0,deflateRaw:function eL(t,n){return(n=n||{}).raw=!0,x0(t,n)},gzip:function tL(t,n){return(n=n||{}).gzip=!0,x0(t,n)},constants:Sl},cL=function(n,e){let i,r,s,o,d,$,I,Q,fe,_e,Ce,Ee,Re,Le,Be,Ae,je,Ue,at,lt,tt,Ct,ot,ht;const pt=n.state;i=n.next_in,ot=n.input,r=i+(n.avail_in-5),s=n.next_out,ht=n.output,o=s-(e-n.avail_out),d=s+(n.avail_out-257),$=pt.dmax,I=pt.wsize,Q=pt.whave,fe=pt.wnext,_e=pt.window,Ce=pt.hold,Ee=pt.bits,Re=pt.lencode,Le=pt.distcode,Be=(1<<pt.lenbits)-1,Ae=(1<<pt.distbits)-1;e:do{Ee<15&&(Ce+=ot[i++]<<Ee,Ee+=8,Ce+=ot[i++]<<Ee,Ee+=8),je=Re[Ce&Be];t:for(;;){if(Ue=je>>>24,Ce>>>=Ue,Ee-=Ue,Ue=je>>>16&255,0===Ue)ht[s++]=65535&je;else{if(!(16&Ue)){if(0==(64&Ue)){je=Re[(65535&je)+(Ce&(1<<Ue)-1)];continue t}if(32&Ue){pt.mode=12;break e}n.msg="invalid literal/length code",pt.mode=30;break e}at=65535&je,Ue&=15,Ue&&(Ee<Ue&&(Ce+=ot[i++]<<Ee,Ee+=8),at+=Ce&(1<<Ue)-1,Ce>>>=Ue,Ee-=Ue),Ee<15&&(Ce+=ot[i++]<<Ee,Ee+=8,Ce+=ot[i++]<<Ee,Ee+=8),je=Le[Ce&Ae];n:for(;;){if(Ue=je>>>24,Ce>>>=Ue,Ee-=Ue,Ue=je>>>16&255,!(16&Ue)){if(0==(64&Ue)){je=Le[(65535&je)+(Ce&(1<<Ue)-1)];continue n}n.msg="invalid distance code",pt.mode=30;break e}if(lt=65535&je,Ue&=15,Ee<Ue&&(Ce+=ot[i++]<<Ee,Ee+=8,Ee<Ue&&(Ce+=ot[i++]<<Ee,Ee+=8)),lt+=Ce&(1<<Ue)-1,lt>$){n.msg="invalid distance too far back",pt.mode=30;break e}if(Ce>>>=Ue,Ee-=Ue,Ue=s-o,lt>Ue){if(Ue=lt-Ue,Ue>Q&&pt.sane){n.msg="invalid distance too far back",pt.mode=30;break e}if(tt=0,Ct=_e,0===fe){if(tt+=I-Ue,Ue<at){at-=Ue;do{ht[s++]=_e[tt++]}while(--Ue);tt=s-lt,Ct=ht}}else if(fe<Ue){if(tt+=I+fe-Ue,Ue-=fe,Ue<at){at-=Ue;do{ht[s++]=_e[tt++]}while(--Ue);if(tt=0,fe<at){Ue=fe,at-=Ue;do{ht[s++]=_e[tt++]}while(--Ue);tt=s-lt,Ct=ht}}}else if(tt+=fe-Ue,Ue<at){at-=Ue;do{ht[s++]=_e[tt++]}while(--Ue);tt=s-lt,Ct=ht}for(;at>2;)ht[s++]=Ct[tt++],ht[s++]=Ct[tt++],ht[s++]=Ct[tt++],at-=3;at&&(ht[s++]=Ct[tt++],at>1&&(ht[s++]=Ct[tt++]))}else{tt=s-lt;do{ht[s++]=ht[tt++],ht[s++]=ht[tt++],ht[s++]=ht[tt++],at-=3}while(at>2);at&&(ht[s++]=ht[tt++],at>1&&(ht[s++]=ht[tt++]))}break}}break}}while(i<r&&s<d);at=Ee>>3,i-=at,Ee-=at<<3,Ce&=(1<<Ee)-1,n.next_in=i,n.next_out=s,n.avail_in=i<r?r-i+5:5-(i-r),n.avail_out=s<d?d-s+257:257-(s-d),pt.hold=Ce,pt.bits=Ee};const uL=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dL=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fL=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),hL=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var qd=(t,n,e,i,r,s,o,d)=>{const $=d.bits;let je,Ue,at,lt,tt,ht,I=0,Q=0,fe=0,_e=0,Ce=0,Ee=0,Re=0,Le=0,Be=0,Ae=0,Ct=null,ot=0;const pt=new Uint16Array(16),_n=new Uint16Array(16);let Er,xt,Ot,an=null,di=0;for(I=0;I<=15;I++)pt[I]=0;for(Q=0;Q<i;Q++)pt[n[e+Q]]++;for(Ce=$,_e=15;_e>=1&&0===pt[_e];_e--);if(Ce>_e&&(Ce=_e),0===_e)return r[s++]=20971520,r[s++]=20971520,d.bits=1,0;for(fe=1;fe<_e&&0===pt[fe];fe++);for(Ce<fe&&(Ce=fe),Le=1,I=1;I<=15;I++)if(Le<<=1,Le-=pt[I],Le<0)return-1;if(Le>0&&(0===t||1!==_e))return-1;for(_n[1]=0,I=1;I<15;I++)_n[I+1]=_n[I]+pt[I];for(Q=0;Q<i;Q++)0!==n[e+Q]&&(o[_n[n[e+Q]]++]=Q);if(0===t?(Ct=an=o,ht=19):1===t?(Ct=uL,ot-=257,an=dL,di-=257,ht=256):(Ct=fL,an=hL,ht=-1),Ae=0,Q=0,I=fe,tt=s,Ee=Ce,Re=0,at=-1,Be=1<<Ce,lt=Be-1,1===t&&Be>852||2===t&&Be>592)return 1;for(;;){Er=I-Re,o[Q]<ht?(xt=0,Ot=o[Q]):o[Q]>ht?(xt=an[di+o[Q]],Ot=Ct[ot+o[Q]]):(xt=96,Ot=0),je=1<<I-Re,Ue=1<<Ee,fe=Ue;do{Ue-=je,r[tt+(Ae>>Re)+Ue]=Er<<24|xt<<16|Ot|0}while(0!==Ue);for(je=1<<I-1;Ae&je;)je>>=1;if(0!==je?(Ae&=je-1,Ae+=je):Ae=0,Q++,0==--pt[I]){if(I===_e)break;I=n[e+o[Q]]}if(I>Ce&&(Ae&lt)!==at){for(0===Re&&(Re=Ce),tt+=fe,Ee=I-Re,Le=1<<Ee;Ee+Re<_e&&(Le-=pt[Ee+Re],!(Le<=0));)Ee++,Le<<=1;if(Be+=1<<Ee,1===t&&Be>852||2===t&&Be>592)return 1;at=Ae&lt,r[at]=Ce<<24|Ee<<16|tt-s|0}}return 0!==Ae&&(r[tt+Ae]=I-Re<<24|64<<16|0),d.bits=Ce,0};const{Z_FINISH:JE,Z_BLOCK:gL,Z_TREES:Mp,Z_OK:Pl,Z_STREAM_END:mL,Z_NEED_DICT:_L,Z_STREAM_ERROR:Ps,Z_DATA_ERROR:e3,Z_MEM_ERROR:t3,Z_BUF_ERROR:$L,Z_DEFLATED:n3}=Sl,T3=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function xL(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const I3=t=>{if(!t||!t.state)return Ps;const n=t.state;return t.total_in=t.total_out=n.total=0,t.msg="",n.wrap&&(t.adler=1&n.wrap),n.mode=1,n.last=0,n.havedict=0,n.dmax=32768,n.head=null,n.hold=0,n.bits=0,n.lencode=n.lendyn=new Int32Array(852),n.distcode=n.distdyn=new Int32Array(592),n.sane=1,n.back=-1,Pl},S3=t=>{if(!t||!t.state)return Ps;const n=t.state;return n.wsize=0,n.whave=0,n.wnext=0,I3(t)},k3=(t,n)=>{let e;if(!t||!t.state)return Ps;const i=t.state;return n<0?(e=0,n=-n):(e=1+(n>>4),n<48&&(n&=15)),n&&(n<8||n>15)?Ps:(null!==i.window&&i.wbits!==n&&(i.window=null),i.wrap=e,i.wbits=n,S3(t))},M3=(t,n)=>{if(!t)return Ps;const e=new xL;t.state=e,e.window=null;const i=k3(t,n);return i!==Pl&&(t.state=null),i};let S0,k0,D3=!0;const EL=t=>{if(D3){S0=new Int32Array(512),k0=new Int32Array(32);let n=0;for(;n<144;)t.lens[n++]=8;for(;n<256;)t.lens[n++]=9;for(;n<280;)t.lens[n++]=7;for(;n<288;)t.lens[n++]=8;for(qd(1,t.lens,0,288,S0,0,t.work,{bits:9}),n=0;n<32;)t.lens[n++]=5;qd(2,t.lens,0,32,k0,0,t.work,{bits:5}),D3=!1}t.lencode=S0,t.lenbits=9,t.distcode=k0,t.distbits=5},A3=(t,n,e,i)=>{let r;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(n.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(r=s.wsize-s.wnext,r>i&&(r=i),s.window.set(n.subarray(e-i,e-i+r),s.wnext),(i-=r)?(s.window.set(n.subarray(e-i,e),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=r,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=r))),0};var na_inflateReset=S3,na_inflateInit2=M3,na_inflate=(t,n)=>{let e,i,r,s,o,d,$,I,Q,fe,_e,Ce,Ee,Re,Be,Ae,je,Ue,at,lt,tt,Ct,Le=0;const ot=new Uint8Array(4);let ht,pt;const _n=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!t||!t.state||!t.output||!t.input&&0!==t.avail_in)return Ps;e=t.state,12===e.mode&&(e.mode=13),o=t.next_out,r=t.output,$=t.avail_out,s=t.next_in,i=t.input,d=t.avail_in,I=e.hold,Q=e.bits,fe=d,_e=$,Ct=Pl;e:for(;;)switch(e.mode){case 1:if(0===e.wrap){e.mode=13;break}for(;Q<16;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(2&e.wrap&&35615===I){e.check=0,ot[0]=255&I,ot[1]=I>>>8&255,e.check=er(e.check,ot,2,0),I=0,Q=0,e.mode=2;break}if(e.flags=0,e.head&&(e.head.done=!1),!(1&e.wrap)||(((255&I)<<8)+(I>>8))%31){t.msg="incorrect header check",e.mode=30;break}if((15&I)!==n3){t.msg="unknown compression method",e.mode=30;break}if(I>>>=4,Q-=4,tt=8+(15&I),0===e.wbits)e.wbits=tt;else if(tt>e.wbits){t.msg="invalid window size",e.mode=30;break}e.dmax=1<<e.wbits,t.adler=e.check=1,e.mode=512&I?10:12,I=0,Q=0;break;case 2:for(;Q<16;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(e.flags=I,(255&e.flags)!==n3){t.msg="unknown compression method",e.mode=30;break}if(57344&e.flags){t.msg="unknown header flags set",e.mode=30;break}e.head&&(e.head.text=I>>8&1),512&e.flags&&(ot[0]=255&I,ot[1]=I>>>8&255,e.check=er(e.check,ot,2,0)),I=0,Q=0,e.mode=3;case 3:for(;Q<32;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}e.head&&(e.head.time=I),512&e.flags&&(ot[0]=255&I,ot[1]=I>>>8&255,ot[2]=I>>>16&255,ot[3]=I>>>24&255,e.check=er(e.check,ot,4,0)),I=0,Q=0,e.mode=4;case 4:for(;Q<16;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}e.head&&(e.head.xflags=255&I,e.head.os=I>>8),512&e.flags&&(ot[0]=255&I,ot[1]=I>>>8&255,e.check=er(e.check,ot,2,0)),I=0,Q=0,e.mode=5;case 5:if(1024&e.flags){for(;Q<16;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}e.length=I,e.head&&(e.head.extra_len=I),512&e.flags&&(ot[0]=255&I,ot[1]=I>>>8&255,e.check=er(e.check,ot,2,0)),I=0,Q=0}else e.head&&(e.head.extra=null);e.mode=6;case 6:if(1024&e.flags&&(Ce=e.length,Ce>d&&(Ce=d),Ce&&(e.head&&(tt=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(i.subarray(s,s+Ce),tt)),512&e.flags&&(e.check=er(e.check,i,Ce,s)),d-=Ce,s+=Ce,e.length-=Ce),e.length))break e;e.length=0,e.mode=7;case 7:if(2048&e.flags){if(0===d)break e;Ce=0;do{tt=i[s+Ce++],e.head&&tt&&e.length<65536&&(e.head.name+=String.fromCharCode(tt))}while(tt&&Ce<d);if(512&e.flags&&(e.check=er(e.check,i,Ce,s)),d-=Ce,s+=Ce,tt)break e}else e.head&&(e.head.name=null);e.length=0,e.mode=8;case 8:if(4096&e.flags){if(0===d)break e;Ce=0;do{tt=i[s+Ce++],e.head&&tt&&e.length<65536&&(e.head.comment+=String.fromCharCode(tt))}while(tt&&Ce<d);if(512&e.flags&&(e.check=er(e.check,i,Ce,s)),d-=Ce,s+=Ce,tt)break e}else e.head&&(e.head.comment=null);e.mode=9;case 9:if(512&e.flags){for(;Q<16;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(I!==(65535&e.check)){t.msg="header crc mismatch",e.mode=30;break}I=0,Q=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),t.adler=e.check=0,e.mode=12;break;case 10:for(;Q<32;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}t.adler=e.check=T3(I),I=0,Q=0,e.mode=11;case 11:if(0===e.havedict)return t.next_out=o,t.avail_out=$,t.next_in=s,t.avail_in=d,e.hold=I,e.bits=Q,_L;t.adler=e.check=1,e.mode=12;case 12:if(n===gL||n===Mp)break e;case 13:if(e.last){I>>>=7&Q,Q-=7&Q,e.mode=27;break}for(;Q<3;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}switch(e.last=1&I,I>>>=1,Q-=1,3&I){case 0:e.mode=14;break;case 1:if(EL(e),e.mode=20,n===Mp){I>>>=2,Q-=2;break e}break;case 2:e.mode=17;break;case 3:t.msg="invalid block type",e.mode=30}I>>>=2,Q-=2;break;case 14:for(I>>>=7&Q,Q-=7&Q;Q<32;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if((65535&I)!=(I>>>16^65535)){t.msg="invalid stored block lengths",e.mode=30;break}if(e.length=65535&I,I=0,Q=0,e.mode=15,n===Mp)break e;case 15:e.mode=16;case 16:if(Ce=e.length,Ce){if(Ce>d&&(Ce=d),Ce>$&&(Ce=$),0===Ce)break e;r.set(i.subarray(s,s+Ce),o),d-=Ce,s+=Ce,$-=Ce,o+=Ce,e.length-=Ce;break}e.mode=12;break;case 17:for(;Q<14;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(e.nlen=257+(31&I),I>>>=5,Q-=5,e.ndist=1+(31&I),I>>>=5,Q-=5,e.ncode=4+(15&I),I>>>=4,Q-=4,e.nlen>286||e.ndist>30){t.msg="too many length or distance symbols",e.mode=30;break}e.have=0,e.mode=18;case 18:for(;e.have<e.ncode;){for(;Q<3;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}e.lens[_n[e.have++]]=7&I,I>>>=3,Q-=3}for(;e.have<19;)e.lens[_n[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,ht={bits:e.lenbits},Ct=qd(0,e.lens,0,19,e.lencode,0,e.work,ht),e.lenbits=ht.bits,Ct){t.msg="invalid code lengths set",e.mode=30;break}e.have=0,e.mode=19;case 19:for(;e.have<e.nlen+e.ndist;){for(;Le=e.lencode[I&(1<<e.lenbits)-1],Be=Le>>>24,Ae=Le>>>16&255,je=65535&Le,!(Be<=Q);){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(je<16)I>>>=Be,Q-=Be,e.lens[e.have++]=je;else{if(16===je){for(pt=Be+2;Q<pt;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(I>>>=Be,Q-=Be,0===e.have){t.msg="invalid bit length repeat",e.mode=30;break}tt=e.lens[e.have-1],Ce=3+(3&I),I>>>=2,Q-=2}else if(17===je){for(pt=Be+3;Q<pt;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}I>>>=Be,Q-=Be,tt=0,Ce=3+(7&I),I>>>=3,Q-=3}else{for(pt=Be+7;Q<pt;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}I>>>=Be,Q-=Be,tt=0,Ce=11+(127&I),I>>>=7,Q-=7}if(e.have+Ce>e.nlen+e.ndist){t.msg="invalid bit length repeat",e.mode=30;break}for(;Ce--;)e.lens[e.have++]=tt}}if(30===e.mode)break;if(0===e.lens[256]){t.msg="invalid code -- missing end-of-block",e.mode=30;break}if(e.lenbits=9,ht={bits:e.lenbits},Ct=qd(1,e.lens,0,e.nlen,e.lencode,0,e.work,ht),e.lenbits=ht.bits,Ct){t.msg="invalid literal/lengths set",e.mode=30;break}if(e.distbits=6,e.distcode=e.distdyn,ht={bits:e.distbits},Ct=qd(2,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,ht),e.distbits=ht.bits,Ct){t.msg="invalid distances set",e.mode=30;break}if(e.mode=20,n===Mp)break e;case 20:e.mode=21;case 21:if(d>=6&&$>=258){t.next_out=o,t.avail_out=$,t.next_in=s,t.avail_in=d,e.hold=I,e.bits=Q,cL(t,_e),o=t.next_out,r=t.output,$=t.avail_out,s=t.next_in,i=t.input,d=t.avail_in,I=e.hold,Q=e.bits,12===e.mode&&(e.back=-1);break}for(e.back=0;Le=e.lencode[I&(1<<e.lenbits)-1],Be=Le>>>24,Ae=Le>>>16&255,je=65535&Le,!(Be<=Q);){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(Ae&&0==(240&Ae)){for(Ue=Be,at=Ae,lt=je;Le=e.lencode[lt+((I&(1<<Ue+at)-1)>>Ue)],Be=Le>>>24,Ae=Le>>>16&255,je=65535&Le,!(Ue+Be<=Q);){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}I>>>=Ue,Q-=Ue,e.back+=Ue}if(I>>>=Be,Q-=Be,e.back+=Be,e.length=je,0===Ae){e.mode=26;break}if(32&Ae){e.back=-1,e.mode=12;break}if(64&Ae){t.msg="invalid literal/length code",e.mode=30;break}e.extra=15&Ae,e.mode=22;case 22:if(e.extra){for(pt=e.extra;Q<pt;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}e.length+=I&(1<<e.extra)-1,I>>>=e.extra,Q-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=23;case 23:for(;Le=e.distcode[I&(1<<e.distbits)-1],Be=Le>>>24,Ae=Le>>>16&255,je=65535&Le,!(Be<=Q);){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(0==(240&Ae)){for(Ue=Be,at=Ae,lt=je;Le=e.distcode[lt+((I&(1<<Ue+at)-1)>>Ue)],Be=Le>>>24,Ae=Le>>>16&255,je=65535&Le,!(Ue+Be<=Q);){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}I>>>=Ue,Q-=Ue,e.back+=Ue}if(I>>>=Be,Q-=Be,e.back+=Be,64&Ae){t.msg="invalid distance code",e.mode=30;break}e.offset=je,e.extra=15&Ae,e.mode=24;case 24:if(e.extra){for(pt=e.extra;Q<pt;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}e.offset+=I&(1<<e.extra)-1,I>>>=e.extra,Q-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){t.msg="invalid distance too far back",e.mode=30;break}e.mode=25;case 25:if(0===$)break e;if(Ce=_e-$,e.offset>Ce){if(Ce=e.offset-Ce,Ce>e.whave&&e.sane){t.msg="invalid distance too far back",e.mode=30;break}Ce>e.wnext?(Ce-=e.wnext,Ee=e.wsize-Ce):Ee=e.wnext-Ce,Ce>e.length&&(Ce=e.length),Re=e.window}else Re=r,Ee=o-e.offset,Ce=e.length;Ce>$&&(Ce=$),$-=Ce,e.length-=Ce;do{r[o++]=Re[Ee++]}while(--Ce);0===e.length&&(e.mode=21);break;case 26:if(0===$)break e;r[o++]=e.length,$--,e.mode=21;break;case 27:if(e.wrap){for(;Q<32;){if(0===d)break e;d--,I|=i[s++]<<Q,Q+=8}if(_e-=$,t.total_out+=_e,e.total+=_e,_e&&(t.adler=e.check=e.flags?er(e.check,r,_e,o-_e):Od(e.check,r,_e,o-_e)),_e=$,(e.flags?I:T3(I))!==e.check){t.msg="incorrect data check",e.mode=30;break}I=0,Q=0}e.mode=28;case 28:if(e.wrap&&e.flags){for(;Q<32;){if(0===d)break e;d--,I+=i[s++]<<Q,Q+=8}if(I!==(4294967295&e.total)){t.msg="incorrect length check",e.mode=30;break}I=0,Q=0}e.mode=29;case 29:Ct=mL;break e;case 30:Ct=e3;break e;case 31:return t3;default:return Ps}return t.next_out=o,t.avail_out=$,t.next_in=s,t.avail_in=d,e.hold=I,e.bits=Q,(e.wsize||_e!==t.avail_out&&e.mode<30&&(e.mode<27||n!==JE))&&A3(t,t.output,t.next_out,_e-t.avail_out),fe-=t.avail_in,_e-=t.avail_out,t.total_in+=fe,t.total_out+=_e,e.total+=_e,e.wrap&&_e&&(t.adler=e.check=e.flags?er(e.check,r,_e,t.next_out-_e):Od(e.check,r,_e,t.next_out-_e)),t.data_type=e.bits+(e.last?64:0)+(12===e.mode?128:0)+(20===e.mode||15===e.mode?256:0),(0===fe&&0===_e||n===JE)&&Ct===Pl&&(Ct=$L),Ct},na_inflateEnd=t=>{if(!t||!t.state)return Ps;let n=t.state;return n.window&&(n.window=null),t.state=null,Pl},na_inflateGetHeader=(t,n)=>{if(!t||!t.state)return Ps;const e=t.state;return 0==(2&e.wrap)?Ps:(e.head=n,n.done=!1,Pl)},na_inflateSetDictionary=(t,n)=>{const e=n.length;let i,r,s;return t&&t.state&&(i=t.state,0===i.wrap||11===i.mode)?11===i.mode&&(r=1,r=Od(r,n,e,0),r!==i.check)?e3:(s=A3(t,n,e,e),s?(i.mode=31,t3):(i.havedict=1,Pl)):Ps},jL=function zL(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1};const P3=Object.prototype.toString,{Z_NO_FLUSH:UL,Z_FINISH:HL,Z_OK:Wd,Z_STREAM_END:M0,Z_NEED_DICT:D0,Z_STREAM_ERROR:VL,Z_DATA_ERROR:N3,Z_MEM_ERROR:GL}=Sl;function Kd(t){this.options=Ip_assign({chunkSize:65536,windowBits:15,to:""},t||{});const n=this.options;n.raw&&n.windowBits>=0&&n.windowBits<16&&(n.windowBits=-n.windowBits,0===n.windowBits&&(n.windowBits=-15)),n.windowBits>=0&&n.windowBits<16&&!(t&&t.windowBits)&&(n.windowBits+=32),n.windowBits>15&&n.windowBits<48&&0==(15&n.windowBits)&&(n.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new GE,this.strm.avail_out=0;let e=na_inflateInit2(this.strm,n.windowBits);if(e!==Wd)throw new Error(Il[e]);if(this.header=new jL,na_inflateGetHeader(this.strm,this.header),n.dictionary&&("string"==typeof n.dictionary?n.dictionary=Vd_string2buf(n.dictionary):"[object ArrayBuffer]"===P3.call(n.dictionary)&&(n.dictionary=new Uint8Array(n.dictionary)),n.raw&&(e=na_inflateSetDictionary(this.strm,n.dictionary),e!==Wd)))throw new Error(Il[e])}function A0(t,n){const e=new Kd(n);if(e.push(t),e.err)throw e.msg||Il[e.err];return e.result}Kd.prototype.push=function(t,n){const e=this.strm,i=this.options.chunkSize,r=this.options.dictionary;let s,o,d;if(this.ended)return!1;for(o=n===~~n?n:!0===n?HL:UL,e.input="[object ArrayBuffer]"===P3.call(t)?new Uint8Array(t):t,e.next_in=0,e.avail_in=e.input.length;;){for(0===e.avail_out&&(e.output=new Uint8Array(i),e.next_out=0,e.avail_out=i),s=na_inflate(e,o),s===D0&&r&&(s=na_inflateSetDictionary(e,r),s===Wd?s=na_inflate(e,o):s===N3&&(s=D0));e.avail_in>0&&s===M0&&e.state.wrap>0&&0!==t[e.next_in];)na_inflateReset(e),s=na_inflate(e,o);switch(s){case VL:case N3:case D0:case GL:return this.onEnd(s),this.ended=!0,!1}if(d=e.avail_out,e.next_out&&(0===e.avail_out||s===M0))if("string"===this.options.to){let $=Vd_utf8border(e.output,e.next_out),I=e.next_out-$,Q=Vd_buf2string(e.output,$);e.next_out=I,e.avail_out=i-I,I&&e.output.set(e.output.subarray($,$+I),0),this.onData(Q)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(s!==Wd||0!==d){if(s===M0)return s=na_inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===e.avail_in)break}}return!0},Kd.prototype.onData=function(t){this.chunks.push(t)},Kd.prototype.onEnd=function(t){t===Wd&&(this.result="string"===this.options.to?this.chunks.join(""):Ip_flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var QL={Inflate:Kd,inflate:A0,inflateRaw:function qL(t,n){return(n=n||{}).raw=!0,A0(t,n)},ungzip:A0,constants:Sl};const{Deflate:JL}=aL,{Inflate:i9}=QL;var F3=JL,R3=i9;function P0(){return P0=(0,Yt.Z)(function*(t,n){const e=new F3({level:2,gzip:!0});try{return yield O3(e,t,n),e.result}catch(i){console.error(i)}return null}),P0.apply(this,arguments)}function N0(){return N0=(0,Yt.Z)(function*(t,n){const e=new R3;try{return yield O3(e,t,n),e.result}catch(i){console.error(i)}return null}),N0.apply(this,arguments)}function O3(t,n){return F0.apply(this,arguments)}function F0(){return F0=(0,Yt.Z)(function*(t,n,e=16384){let i=Math.ceil(n.byteLength/e),r=null;for(let s=0;s<i;s++)yield m9(),r=n.slice(s*e,(s+1)*e),t.push(r,i<=s+1);if(t.err)throw new Error(`error: ${t.err}`);return t}),F0.apply(this,arguments)}function m9(){return new Promise(t=>vr(t))}var gs,B3=Y(2391);!function(t){t.encode=function n(i){try{return B3.encode(i)}catch(r){console.error(r,i)}return null},t.decode=function e(i){try{return B3.decode(i)}catch(r){console.error(r,i)}return null}}(gs||(gs={}));var ms,_9=Y(9069);!function(t){let n=[];for(let i=0;i<256;i++)n[i]=(i<16?"0":"")+i.toString(16);t.generateUuid=function e(){const i=new Uint32Array(4);window.crypto.getRandomValues(i);const r=i[0],s=i[1],o=i[2],d=i[3];return n[255&r]+n[r>>8&255]+n[r>>16&255]+n[r>>24&255]+"-"+n[255&s]+n[s>>8&255]+"-"+n[s>>16&15|64]+n[s>>24&255]+"-"+n[63&o|128]+n[o>>8&255]+"-"+n[o>>16&255]+n[o>>24&255]+n[255&d]+n[d>>8&255]+n[d>>16&255]+n[d>>24&255]}}(ms||(ms={}));class ia{constructor(n,e){this.timerMilliSecond=0,this.timeoutDate=0,this.isStopped=!1,this.callback=n,this.timerMilliSecond=e,this.reset()}get isActive(){return null!=this.timeoutTimer}stop(){this.isStopped=!0}clear(){this.callback=null,this.timerMilliSecond=0,this.timeoutDate=0,this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.isStopped=!1}reset(...n){1===n.length?this.timerMilliSecond=n[0]:1<n.length&&(this.callback=n[0],this.timerMilliSecond=n[1]),this.isStopped=!1;let e=this.timeoutDate;this.timeoutDate=performance.now()+this.timerMilliSecond,!(this.timeoutTimer&&e<=this.timeoutDate)&&this.setTimeout()}setTimeout(){this.timeoutTimer&&clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.callback&&(this.timeoutTimer=setTimeout(()=>{this.timeoutTimer=null,!this.isStopped&&(performance.now()<this.timeoutDate?this.setTimeout():this.callback&&this.callback())},this.timeoutDate-performance.now()))}}class Np{constructor(){}static add(n){this.monitoringConnections.add(n),n.updateStatsAsync(),this.restart()}static remove(n){this.monitoringConnections.delete(n)}static restart(){null==this.updateWebRTCStatsTimer?this.updateWebRTCStatsTimer=new ia(()=>this.doMonitoringAsync(),this.calcIntervalTime()):this.updateWebRTCStatsTimer.isActive||this.updateWebRTCStatsTimer.reset(this.calcIntervalTime())}static calcIntervalTime(){return Math.min(2e3+1e3*this.monitoringConnections.size,1e4)}static doMonitoringAsync(){var n=this;return(0,Yt.Z)(function*(){for(let e of n.monitoringConnections)e.open?yield e.updateStatsAsync():n.remove(e);n.monitoringConnections.size<1?n.updateWebRTCStatsTimer=null:n.restart()})()}}Np.updateWebRTCStatsTimer=null,Np.monitoringConnections=new Set;var Ns=(()=>(function(t){t.UNKNOWN="unknown",t.RELAY="relay",t.PRFLX="prflx",t.SRFLX="srflx",t.HOST="host"}(Ns||(Ns={})),Ns))();class $9{constructor(n){this.peerConnection=n,this.candidateType=Ns.UNKNOWN}updateAsync(){var n=this;return(0,Yt.Z)(function*(){let e=null;try{e=yield n.peerConnection.getStats()}catch(_e){console.warn(_e)}if(null==e)return void(n.candidateType=Ns.UNKNOWN);let i=[],r=[],s=[],o=[],d=[],$=[],I=[];e.forEach(_e=>{0<=_e.type.indexOf("candidate-pair")&&i.push(_e),0<=_e.type.indexOf("local-candidate")&&r.push(_e),0<=_e.type.indexOf("remote-candidate")&&s.push(_e)}),i.forEach(_e=>{"succeeded"===_e.state&&(o.push(_e.localCandidateId),d.push(_e.remoteCandidateId))}),r.forEach(_e=>{o.includes(_e.id)&&$.push(_e)}),s.forEach(_e=>{d.includes(_e.id)&&I.push(_e)});let Q=Ns.UNKNOWN,fe=Object.values(Ns);$.concat(I).forEach(_e=>{let Ce=fe.indexOf(_e.candidateType);fe.indexOf(Q)<Ce&&(Q=fe[Ce])}),n.candidateType=Q})()}}class L3 extends _9.EventEmitter{constructor(n){super(),this.conn=n,this.chunkSize=15872,this.receivedMap=new Map,this.timeoutTimer=null,this._timestamp=performance.now(),this._ping=0,this._candidateType=Ns.UNKNOWN,n.on("data",e=>this.onData(e)),n.on("open",()=>{this.stats=new $9(this.getPeerConnection()),this.clearTimeoutTimer(),function v9(t){t._dc&&t._sendBuffer&&(t._startSendLoop=b9)}(n),this.emit("open"),this.startMonitoring()}),n.on("close",()=>{this.clearTimeoutTimer(),this.emit("close")}),n.on("error",e=>{this.clearTimeoutTimer(),this.emit("error",e)}),this.setTimeoutTimer()}get open(){return this.conn.open}get remoteId(){return this.conn.remoteId}get metadata(){return this.conn.metadata}get bufferedAmount(){var n,e;return null!==(e=null===(n=this.conn._dc)||void 0===n?void 0:n.bufferedAmount)&&void 0!==e?e:0}get timestamp(){return this._timestamp}set timestamp(n){this._timestamp=n}get ping(){return this._ping}set ping(n){this._ping=n}get candidateType(){return this._candidateType}set candidateType(n){this._candidateType=n}close(){this.clearTimeoutTimer(),this.stopMonitoring(),this.conn.close()}send(n){let e=gs.encode(n),i=Math.ceil(e.byteLength/this.chunkSize);if(i<=1)return void this.conn.send(e);let r=ms.generateUuid(),s=null,o=null;for(let d=0;d<i;d++)s=e.slice(d*this.chunkSize,(d+1)*this.chunkSize),o={id:r,data:s,index:d,total:i},this.conn.send(gs.encode(o))}getPeerConnection(){return this.conn.getPeerConnection()}startMonitoring(){Np.add(this)}stopMonitoring(){Np.remove(this)}updateStatsAsync(){var n=this;return(0,Yt.Z)(function*(){null!=n.stats&&(n.sendPing(),yield n.stats.updateAsync(),n.candidateType=n.stats.candidateType,n.emit("stats",n.stats))})()}sendPing(){let n=gs.encode({from:this.remoteId,ping:performance.now()});this.conn.send(n)}receivePing(n){if(n.from===this.remoteId){let i=performance.now()-n.ping;this.ping=i<=this.ping?.5*this.ping+.5*i:i}else{let e=gs.encode(n);this.conn.send(e)}}onData(n){this.timestamp=performance.now();let e=gs.decode(new Uint8Array(n));if(null!=e.ping)return void this.receivePing(e);let r=e;if(null==r.id)return void this.emit("data",e);let s=this.receivedMap.get(r.id);if(null==s&&(s={id:r.id,chanks:new Array(r.total),length:0,byteLength:0},this.receivedMap.set(r.id,s)),null!=s.chanks[r.index]||(s.length++,s.byteLength+=r.data.byteLength,s.chanks[r.index]=r.data,s.length<r.total))return;this.receivedMap.delete(r.id);let o=new Uint8Array(s.byteLength),d=0;for(let I of s.chanks)o.set(I,d),d+=I.byteLength;let $=gs.decode(o);this.emit("data",$)}setTimeoutTimer(){this.clearTimeoutTimer(),this.timeoutTimer=setTimeout(()=>{console.warn(`timeout ${this.conn.remoteId}`),this.timeoutTimer=null,this.emit("close")},15e3)}clearTimeoutTimer(){null!=this.timeoutTimer&&(clearTimeout(this.timeoutTimer),this.timeoutTimer=null)}}function b9(){this.sendInterval||(this.sendInterval=vr(z3.bind(this)))}function z3(){const t=this._sendBuffer.shift();try{this._dc.send(t)}catch(n){this._sendBuffer.push(t)}this.sendInterval=0===this._sendBuffer.length?void 0:vr(z3.bind(this))}class y9{constructor(){this._peerIds=[],this.peerContext=ai.parse("???"),this.peerContexts=[],this.callback=new dE,this.bandwidthUsage=0,this.key="",this.connections=[],this.listAllPeersCache=[],this.httpRequestInterval=performance.now()+500,this.outboundQueue=Promise.resolve(),this.inboundQueue=Promise.resolve(),this.relayingPeerIds=new Map,this.maybeUnavailablePeerIds=new Set}get peerId(){return this.peerContext?this.peerContext.peerId:"???"}get peerIds(){return this._peerIds}open(...n){console.log("open",n),this.peerContext=0===n.length?ai.create(ai.generateId()):1===n.length?ai.create(n[0]):ai.create(n[0],n[1],n[2],n[3]),this.openPeer()}close(){this.peer&&this.peer.destroy(),this.disconnectAll(),this.peer=null,this.peerContext=ai.parse("???")}connect(n){if(!this.shouldConnect(n))return!1;let e=new L3(this.peer.connect(n,{serialization:"none",metadata:{sendFrom:this.peerId}}));return this.openDataConnection(e),!0}shouldConnect(n){return this.peerContext&&this.peer&&this.peerId?this.peerId===n?(console.log("connect() is Fail. "+n+" is me."),!1):this.findDataConnection(n)?(console.log("connect() is Fail. <"+n+"> is already connecting."),!1):!(!n||!n.length||n===this.peerId):(console.log("connect() is Fail. ID\u304c\u5272\u308a\u632f\u3089\u308c\u308b\u307e\u3067\u5f85\u3066\u3084"),!1)}disconnect(n){let e=this.findDataConnection(n);return!!e&&(this.closeDataConnection(e),!0)}disconnectAll(){console.log("<closeAllDataConnection()>");for(let n of this.connections.concat())this.closeDataConnection(n)}send(n,e){var i=this;if(this.connections.length<1)return;let r={data:gs.encode(n),ttl:1},s=r.data.byteLength;this.bandwidthUsage+=s,this.outboundQueue=this.outboundQueue.then(()=>new Promise((o,d)=>{vr((0,Yt.Z)(function*(){if(1024<r.data.byteLength&&Array.isArray(n)&&1<n.length){let $=yield function p9(t,n){return P0.apply(this,arguments)}(r.data);$.byteLength<r.data.byteLength&&(r.data=$,r.isCompressed=!0)}return e?i.sendUnicast(r,e):i.sendBroadcast(r),i.bandwidthUsage-=s,o()}))}))}sendUnicast(n,e){n.ttl=0;let i=this.findDataConnection(e);i&&i.open&&i.send(n)}sendBroadcast(n){for(let e of this.connections)e.open&&e.send(n)}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return new Promise((n,e)=>{if(!this.peer)return n([]);let i=performance.now();if(i<this.httpRequestInterval)return console.warn("httpRequestInterval... "+(this.httpRequestInterval-i)),void n(this.listAllPeersCache.concat());this.httpRequestInterval=i+6e3,this.peer.listAllPeers(r=>{this.listAllPeersCache=r.concat(),n(r)})})}openPeer(){this.peer&&(console.warn("It is already opened."),this.close());let n=new Peer(this.peerContext.peerId,{key:this.key});n.on("open",e=>{console.log("My peer ID is: "+e),(!this.peerContext||this.peerContext.peerId!==e)&&(this.peerContext=ai.parse(e)),this.peerContext.isOpen=!0,console.log("My peer Context",this.peerContext),this.callback.onOpen&&this.callback.onOpen(this.peerId)}),n.on("close",()=>{console.log("Peer close"),this.peerContext&&this.peerContext.isOpen&&(this.peerContext.isOpen=!1,this.callback.onClose&&this.callback.onClose(this.peerId))}),n.on("connection",e=>{this.openDataConnection(new L3(e))}),n.on("error",e=>{console.error("<"+this.peerId+"> "+e.type+" => "+e.message);let i=`${this.getSkyWayErrorMessage(e.type)}\n\n${e.type}: ${e.message}`;switch(e.type){case"peer-unavailable":let r=/"(.+)"/.exec(e.message)[1];this.disconnect(r);break;case"disconnected":case"socket-error":case"unavailable-id":case"authentication":case"server-error":this.peerContext&&this.peerContext.isOpen&&(this.close(),this.callback.onClose&&this.callback.onClose(this.peerId))}this.callback.onError&&this.callback.onError(this.peerId,e.type,i,e)}),this.peer=n}openDataConnection(n){if(!1===this.addDataConnection(n))return;let e=this.connections.indexOf(n),i=null;0<=e&&(i=this.peerContexts[e]),this.maybeUnavailablePeerIds.add(n.remoteId),n.on("data",r=>{this.onData(n,r)}),n.on("open",()=>{this.maybeUnavailablePeerIds.delete(n.remoteId),i&&(i.isOpen=!0),this.updatePeerList(),this.callback.onConnect&&this.callback.onConnect(n.remoteId)}),n.on("close",()=>{this.closeDataConnection(n)}),n.on("error",()=>{this.closeDataConnection(n)}),n.on("stats",()=>{let r=performance.now()-n.timestamp,s=r<=1e4?1:5e3/(r-1e4+5e3),o=s<1?r:n.ping,d=500/(o+500);switch(i.session.health=s,i.session.ping=o,i.session.speed=d*s,n.candidateType){case Ns.HOST:i.session.grade=Da.HIGH;break;case Ns.SRFLX:case Ns.PRFLX:i.session.grade=Da.MIDDLE;break;case Ns.RELAY:i.session.grade=Da.LOW;break;default:i.session.grade=Da.UNSPECIFIED}i.session.description=n.candidateType,i.session.health<.2&&this.closeDataConnection(n)})}closeDataConnection(n){n.close();let e=this.connections.indexOf(n);0<=e&&(console.log(n.remoteId+" is \u3048\u3093\u3044\u30fcindex:"+e+" length:"+this.connections.length),this.connections.splice(e,1),this.peerContexts.splice(e,1)),this.relayingPeerIds.delete(n.remoteId),this.relayingPeerIds.forEach(i=>{let r=i.indexOf(n.remoteId);0<=r&&i.splice(r,1)}),console.log("<close()> Peer:"+n.remoteId+" length:"+this.connections.length+":"+this.peerContexts.length),this.updatePeerList(),0<=e&&this.callback.onDisconnect&&this.callback.onDisconnect(n.remoteId)}addDataConnection(n){let e=this.findDataConnection(n.remoteId);if(null!==e){if(console.log("add() is Fail. "+n.remoteId+" is already connecting."),e!==n){if(!(e.metadata.sendFrom<n.metadata.sendFrom))return this.closeDataConnection(e),this.addDataConnection(n),!0;this.closeDataConnection(n)}return!1}return this.connections.push(n),this.peerContexts.push(ai.parse(n.remoteId)),console.log("<add()> Peer:"+n.remoteId+" length:"+this.connections.length),!0}findDataConnection(n){for(let e of this.connections)if(e.remoteId===n)return e;return null}onData(n,e){var i=this;if(e.peers&&0<e.peers.length&&this.onUpdatePeerList(n,e),0<e.ttl&&this.onRelay(n,e),this.callback.onData){let r=e.data.byteLength;this.bandwidthUsage+=r,this.inboundQueue=this.inboundQueue.then(()=>new Promise((s,o)=>{vr((0,Yt.Z)(function*(){let d=e.isCompressed?yield function g9(t,n){return N0.apply(this,arguments)}(e.data):e.data;return i.callback.onData(n.remoteId,gs.decode(d)),i.bandwidthUsage-=r,s()}))}))}}onRelay(n,e){e.ttl--;let i=this.relayingPeerIds.get(n.remoteId);if(null!=i)for(let r of i){let s=this.findDataConnection(r);s&&s.open&&(console.log("<"+r+"> \u8ee2\u9001\u3057\u306a\u304d\u3083\u30fb\u30fb\u30fb"),s.send(e))}}onUpdatePeerList(n,e){let i=[],r=[],s=function C9(t,n){let e=[],i=[],r=!1,s=!1;for(let o of t.concat(n))r=t.includes(o),s=n.includes(o),r&&!s?e.push(o):!r&&s&&i.push(o);return{diff1:e,diff2:i}}(this._peerIds,e.peers);if(i=s.diff1,r=s.diff2,this.relayingPeerIds.set(n.remoteId,i),e.peers=e.peers.concat(i),r.length)for(let o of r)!this.maybeUnavailablePeerIds.has(o)&&this.connect(o)&&console.log("auto connect to unknown Peer <"+o+">")}updatePeerList(){let n=[];for(let e of this.connections)e.open&&n.push(e.remoteId);return n.push(this.peerId),n.sort(function(e,i){return e>i?1:e<i?-1:0}),this._peerIds=n,console.log("<update()>",n),this.notifyPeerList(),n}notifyPeerList(){if(this.connections.length<1)return;let n={data:gs.encode([]),peers:this._peerIds,ttl:1};this.sendBroadcast(n)}getSkyWayErrorMessage(n){switch(n){case"room-error":return"SkyWay Room API \u306b\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"permission":return"\u8a72\u5f53\u306e SkyWay Room \u306e\u5229\u7528\u304c\u8a31\u53ef\u3055\u308c\u3066\u307e\u305b\u3093\u3002";case"list-error":return"SkyWay listAllPeers API \u304c Disabled \u3067\u3059\u3002";case"disconnected":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u306b\u63a5\u7d9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"socket-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u901a\u4fe1\u3067\u554f\u984c\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002";case"invalid-id":return"Peer ID \u304c\u4e0d\u6b63\u3067\u3059\u3002";case"unavailable-id":return"\u305d\u306e Peer ID \u3059\u3067\u306b\u4f7f\u7528\u3055\u308c\u3066\u3044\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306e Peer ID \u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";case"invalid-key":return"SkyWay API \u30ad\u30fc\u304c\u7121\u52b9\u3067\u3059\u3002";case"invalid-domain":return"SkyWay API \u30ad\u30fc\u306b\u306f\u73fe\u5728\u306e\u30c9\u30e1\u30a4\u30f3\u306f\u767b\u9332\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002";case"authentication":return"\u8a8d\u8a3c\u30a8\u30e9\u30fc\u3067\u3059\u3002";case"server-error":return"SkyWay \u306e\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u30b5\u30fc\u30d0\u3068\u306e\u63a5\u7d9a\u4e2d\u306b\u554f\u984c\u304c\u3042\u308a\u307e\u3057\u305f\u3002 \u5c11\u3057\u5f85\u3063\u3066\u3001\u30ea\u30c8\u30e9\u30a4\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"sfu-client-not-supported":return"\u3053\u306e\u30af\u30e9\u30a4\u30a2\u30f3\u30c8\u306f SFU \u306e\u4f7f\u7528\u3092\u30b5\u30dd\u30fc\u30c8\u3057\u3066\u3044\u307e\u305b\u3093\u3002\u6700\u65b0\u306e Google Chrome \u3092\u4f7f\u7528\u3057\u3066\u304f\u3060\u3055\u3044";case"peer-unavailable":return"Peer \u3078\u30c7\u30fc\u30bf\u3092\u9001\u4fe1\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f\u3002Peer ID \u304c\u6b63\u3057\u3044\u3053\u3068\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002";case"signaling-limited":return"\u30b7\u30b0\u30ca\u30ea\u30f3\u30b0\u56de\u6570\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u5168\u3066\u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"sfu-limited":return"SFU \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001SFU \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09";case"turn-limited":return"TURN \u30b5\u30fc\u30d0\u306e\u5229\u7528\u91cf\u304c\u7121\u511f\u5229\u7528\u67a0\u3092\u8d85\u904e\u3057\u3066\u3044\u308b\u305f\u3081\u3001TURN \u306e\u6a5f\u80fd\u304c\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002\uff08SkyWay Community Edition \u306e\u307f\uff09\n\u3053\u306e\u72b6\u614b\u3067\u306f\u3001\u4e00\u90e8\u306e\u30e6\u30fc\u30b6\u306e\u63a5\u7d9a\u306b\u554f\u984c\u304c\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002";case"peer-unavailable":return"\u305d\u306ePeer ID\u306f\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002";default:return"SkyWay\u306b\u95a2\u3059\u308b\u4e0d\u660e\u306a\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u307e\u3057\u305f\u3002"}}}const j3=ai.parse("???");class Io{constructor(){this.callback=new dE,this.key="",this.queue=new Set,this.sendInterval=null,this.sendCallback=()=>{this.sendQueue()},this.callbackUnload=n=>{this.close()},console.log("Network ready...")}static get instance(){return Io._instance||(Io._instance=new Io),Io._instance}get peerId(){return this.connection?this.connection.peerId:j3.peerId}get peerIds(){return this.connection?this.connection.peerIds.concat():[]}get peerContexts(){return this.connection?this.connection.peerContexts.concat():[]}get peerContext(){return this.connection?this.connection.peerContext:j3}get isOpen(){return!(!this.connection||!this.connection.peerContext)&&this.connection.peerContext.isOpen}get bandwidthUsage(){return this.connection?this.connection.bandwidthUsage:0}open(...n){this.connection&&this.connection.peerContext&&(console.warn("It is already opened."),this.close()),console.log("Network open...",n),this.connection=this.initializeConnection(),this.connection.open.apply(this.connection,n),window.addEventListener("unload",this.callbackUnload,!1)}close(){this.connection&&this.connection.close(),this.connection=null,window.removeEventListener("unload",this.callbackUnload,!1),console.log("Network close...")}connect(n){return!!this.connection&&this.connection.connect(n)}disconnect(n){!this.connection||this.connection.disconnect(n)&&(console.log("<disconnectPeer()> Peer:"+n),this.disconnect(n))}send(n,e){this.queue.add({data:n,sendTo:e}),null===this.sendInterval&&(this.sendInterval=vr(this.sendCallback))}sendQueue(){let n=[],e={},i=[],r=this.queue.size<128?this.queue.size:128;for(let s of this.queue){if(r<=0)break;r--,this.queue.delete(s),null==s.sendTo?n.push(s.data):s.sendTo===this.peerId?i.push(s.data):(s.sendTo in e||(e[s.sendTo]=[]),e[s.sendTo].push(s.data))}if(this.connection){n.length&&this.connection.send(n);for(let s in e)this.connection.send(e[s],s)}this.callback.onData&&(this.callback.onData(null,n),this.callback.onData(this.peerId,i)),this.sendInterval=0<this.queue.size?vr(this.sendCallback):null}setApiKey(n){this.key!==n&&console.log("Key Change"),this.key=n}listAllPeers(){return this.connection?this.connection.listAllPeers():Promise.resolve([])}initializeConnection(){let n=new y9;return n.setApiKey(this.key),n.callback.onOpen=e=>{this.callback.onOpen&&this.callback.onOpen(e)},n.callback.onClose=e=>{this.callback.onClose&&this.callback.onClose(e)},n.callback.onConnect=e=>{this.callback.onConnect&&this.callback.onConnect(e)},n.callback.onDisconnect=e=>{this.callback.onDisconnect&&this.callback.onDisconnect(e)},n.callback.onData=(e,i)=>{this.callback.onData&&this.callback.onData(e,i)},n.callback.onError=(e,i,r,s)=>{this.callback.onError&&this.callback.onError(e,i,r,s)},0<this.queue.size&&null===this.sendInterval&&(this.sendInterval=vr(this.sendCallback)),n}}class Fp{constructor(n,e,i=Io.instance.peerId){this.eventName=n,this.data=e,this.sendFrom=i,this.isSendFromSelf=!1,this.isSendFromSelf=this.sendFrom===Io.instance.peerId}toContext(){return{sendFrom:this.sendFrom,eventName:this.eventName,data:this.data}}}class R0{constructor(n,e){this._priority=0,this._isRegistered=!1,this._subject=n,this._key=e}get subject(){return this._subject}get key(){return this._key}get eventName(){return this._eventName}get priority(){return this._priority}get callback(){return this._callback}get isOnlyOnce(){return this._isOnlyOnce}get isRegistered(){return this._isRegistered}on(...n){return this._isOnlyOnce=!1,2===n.length?this.register(n[0],0,n[1]):this.register(n[0],n[1],n[2])}once(...n){let e=this.on.apply(this,n);return this._isOnlyOnce=!0,e}register(n,e,i){return this.isRegistered&&this.unregister(),this._eventName=n||"*",this._priority=e,this._callback=i,this.subject.registerListener(this),this._isRegistered=!0,new R0(this.subject,this.key)}unregister(){return this.subject.unregisterListener(this),this._callback=null,this._isRegistered=!1,this}trigger(n){this.callback&&this.isRegistered&&(this.callback.apply(this.key,[n,this]),this.isOnlyOnce&&this.unregister())}isEqual(n,e,i){return!(null!=n&&n!==this.key||null!=e&&e!==this.eventName||null!=i&&i!==this.callback)}}class Nl{constructor(){this.listenerMap=new Map,console.log("EventSystem ready...")}static get instance(){return Nl._instance||(Nl._instance=new Nl,Nl._instance.initializeNetworkEvent()),Nl._instance}register(n){return new R0(this,n)}unregister(...n){1===n.length?this._unregister(n[0],null,null):2===n.length?"string"==typeof n[1]?this._unregister(n[0],n[1],null):this._unregister(n[0],null,n[1]):this._unregister(n[0],n[1],n[2])}_unregister(n=this,e,i){let r=this.listenerMap.values();for(let s of r)for(let o of s.concat())o.isEqual(n,e,i)&&o.unregister()}registerListener(n){let e=this.getListeners(n.eventName);return e.push(n),e.sort((i,r)=>r.priority-i.priority),this.listenerMap.set(n.eventName,e),n}unregisterListener(n){let e=this.getListeners(n.eventName),i=e.indexOf(n);return i<0?null:(e.splice(i,1),n.unregister(),e.length<1&&this.listenerMap.delete(n.eventName),n)}call(...n){"string"==typeof n[0]?this._call(new Fp(n[0],n[1]),n[2]):this._call(n[0],n[1])}_call(n,e){let i=n.toContext();Io.instance.send(i,e)}trigger(...n){if(2!==n.length)return this._trigger(n[0]instanceof Fp?n[0]:new Fp(n[0].eventName,n[0].data,n[0].sendFrom));this._trigger(new Fp(n[0],n[1]))}_trigger(n){let e=this.getListeners(n.eventName).concat(this.getListeners("*"));for(let i of e)i.trigger(n);return n}getListeners(n){return this.listenerMap.has(n)?this.listenerMap.get(n):[]}initializeNetworkEvent(){let n=Io.instance.callback;n.onOpen=e=>{this.trigger("OPEN_NETWORK",{peerId:e})},n.onClose=e=>{this.trigger("CLOSE_NETWORK",{peerId:e})},n.onConnect=e=>{this.sendSystemMessage("<"+e+"> connect <DataConnection>"),this.trigger("CONNECT_PEER",{peerId:e})},n.onDisconnect=e=>{this.sendSystemMessage("<"+e+"> disconnect <DataConnection>"),this.trigger("DISCONNECT_PEER",{peerId:e})},n.onData=(e,i)=>{for(let r of i)this.trigger(r)},n.onError=(e,i,r,s)=>{this.sendSystemMessage("<"+e+"> "+r),this.trigger("NETWORK_ERROR",{peerId:e,errorType:i,errorMessage:r,errorObject:s})}}sendSystemMessage(n){console.log(n)}}const Fe=Nl.instance,vt=Io.instance;class rt{constructor(){this.identifierMap=new Map,this.aliasNameMap=new Map,this.garbageMap=new Map,this.queueMap=new Map,this.updateInterval=null,this.garbageCollectionInterval=null,this.updateCallback=()=>{this.updateQueue()},console.log("ObjectStore ready...")}static get instance(){return rt._instance||(rt._instance=new rt),rt._instance}add(n,e=!0){return null!=this.get(n.identifier)||this.isDeleted(n.identifier)?null:(this.identifierMap.set(n.identifier,n),(this.aliasNameMap.has(n.aliasName)?this.aliasNameMap.get(n.aliasName):this.aliasNameMap.set(n.aliasName,new Map).get(n.aliasName)).set(n.identifier,n),n.onStoreAdded(),e&&this.update(n.toContext()),n)}remove(n){if(!this.identifierMap.has(n.identifier))return null;this.identifierMap.delete(n.identifier);let e=this.aliasNameMap.get(n.aliasName);return e&&e.delete(n.identifier),n.onStoreRemoved(),n}delete(n,e=!0){let i=null,r=null;return"string"==typeof n?(i=this.get(n),r=n):(i=n,r=n.identifier),this.markForDelete(r),null==i?null:this._delete(i,e)}_delete(n,e){return null===this.remove(n)?null:(e&&Fe.call("DELETE_GAME_OBJECT",{aliasName:n.aliasName,identifier:n.identifier}),n)}markForDelete(n){this.garbageMap.set(n,performance.now()),this.garbageCollection(6e5)}get(n){return this.identifierMap.has(n)?this.identifierMap.get(n):null}getObjects(n){if(null==n)return Array.from(this.identifierMap.values());let e="";return e="string"==typeof n?n:n.aliasName,this.aliasNameMap.has(e)?Array.from(this.aliasNameMap.get(e).values()):[]}update(n){let e=null;if("string"==typeof n){let i=this.get(n);i&&(e=i.toContext())}else e=n;if(e){if(this.queueMap.has(e.identifier)){let i=this.queueMap.get(e.identifier);for(let r in e)i[r]=e[r];return}Fe.call("UPDATE_GAME_OBJECT",e),this.queueMap.set(e.identifier,e),null===this.updateInterval&&(this.updateInterval=vr(this.updateCallback))}}updateQueue(){this.queueMap.clear(),this.updateInterval=null}isDeleted(n){return null!=this.garbageMap.get(n)}getCatalog(){let n=[];for(let e of this.identifierMap.values())n.push({identifier:e.identifier,version:e.version});return n}clearDeleteHistory(){this.garbageMap.clear()}garbageCollection(n){"number"==typeof n?null===this.garbageCollectionInterval&&(this.garbageCollectionInterval=setTimeout(()=>{this.garbageCollectionInterval=null},1e3),this._garbageCollection(n)):this.garbageMap.delete(n.identifier)}_garbageCollection(n){let e=performance.now(),i=this.garbageMap.size-1e5;if(i<1)return;let r=this.garbageMap.entries();for(;i<1;){i--;let s=r.next();if(s.done)break;let o=s.value[0];s.value[1]+n<e||this.garbageMap.delete(o)}}}var ra,x9=Y(383);class So{constructor(){this.constructorMap=new Map,this.aliasMap=new Map,console.log("ObjectFactory ready...")}static get instance(){return So._instance||(So._instance=new So),So._instance}register(n,e){var i,r,s;e||(e=null!==(i=n.name)&&void 0!==i?i:null!==(s=null===(r=n.toString().match(/function\s*([^(]*)\(/))||void 0===r?void 0:r[1])&&void 0!==s?s:""),this.constructorMap.has(e)?console.error("\u305d\u306e alias<"+e+"> \u306f\u3059\u3067\u306b\u5272\u308a\u5f53\u3066\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f"):this.aliasMap.has(n)?console.error("\u305d\u306e constructor \u306f\u3059\u3067\u306b\u767b\u9332\u6e08\u307f\u3058\u3083\u306d\u30fc\uff1f",n):(console.log("addGameObjectFactory -> "+e),this.constructorMap.set(e,n),this.aliasMap.set(n,e))}create(n,e){let i=this.constructorMap.get(n);return i?new i(e):(console.error(n+"\u3068\u3044\u3046\u540d\u306eGameObject\u30af\u30e9\u30b9\u306f\u5b9a\u7fa9\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),null)}getAlias(n){var e;return null!==(e=this.aliasMap.get(n))&&void 0!==e?e:""}}function U3(t){return n=>{So.instance.register(n,t)}}function iu(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.context.syncData[n]},set:function i(r){this.context.syncData[n]=r,this.update()},enumerable:!0,configurable:!0})}}!function(t){const n=/&|<|>|"|'/g,e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},i=/&amp;|&lt;|&gt;|&quot;|&apos;/g,r={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&apos;":"'"},s=/((?:[\0-\x08\x0B\f\x0E-\x1F\uFFFD\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/g;function Q(_e){return e[_e]}function fe(_e){return r[_e]}t.xml2element=function o(_e){let Ce=new DOMParser,Ee=null;try{_e=function I(_e){return _e.replace(s,"").trim()}(_e),Ee=Ce.parseFromString(_e,"application/xml"),Ee.getElementsByTagName("parsererror").length&&(console.error("XML\u306e\u30d1\u30fc\u30b9\u306b\u5931\u6557\u3057\u307e\u3057\u305f",Ee.documentElement),Ee=null)}catch(Re){console.error(Re)}return Ee?Ee.documentElement:null},t.encodeEntityReference=function d(_e){return _e.replace(n,Q)},t.decodeEntityReference=function $(_e){return _e.replace(i,fe)}}(ra||(ra={}));const E9=Object.getOwnPropertyNames(Object.prototype);Object.getOwnPropertyNames(Array.prototype);class Gn{constructor(){console.log("ObjectSerializer ready...")}static get instance(){return Gn._instance||(Gn._instance=new Gn),Gn._instance}toXml(n){let e="",i="toAttributes"in n?n.toAttributes():Gn.toAttributes(n.toContext().syncData),r=n.aliasName,s="";for(let o in i){let d=ra.encodeEntityReference(i[o]+"");null!=d&&(s+=" "+o+'="'+d+'"')}return e+=`<${r+s}>`,e+="innerXml"in n?n.innerXml():"",e+=`</${r}>`,e}static toAttributes(n){let e={};for(let i in n){let o=Gn.make2Attributes(n[i],i);for(let d in o)e[d]=o[d]}return e}static make2Attributes(n,e){let i={};if(Array.isArray(n)){let r=Gn.array2attributes(n,e);for(let s in r)i[s]=r[s]}else if("object"==typeof n){let r=Gn.object2attributes(n,e);for(let s in r)i[s]=r[s]}else i[e]=n;return i}static object2attributes(n,e){let i={};for(let r in n){let d=Gn.make2Attributes(n[r],e+"."+r);for(let $ in d)i[$]=d[$]}return i}static array2attributes(n,e){let i={},r=n.length;for(let s=0;s<r;s++){let $=Gn.make2Attributes(n[s],e+"."+s);for(let I in $)i[I]=$[I]}return i}parseXml(n){let e=null;if(e="string"==typeof n?ra.xml2element(n):n,!e)return console.error("xmlElement\u304c\u7a7a\u3067\u3059"),null;let i=So.instance.create(e.tagName);if(!i)return null;if("parseAttributes"in i)i.parseAttributes(e.attributes);else{let r=i.toContext();Gn.parseAttributes(r.syncData,e.attributes),i.apply(r)}return i.initialize(),"parseInnerXml"in i&&i.parseInnerXml(e),i}static parseAttributes(n,e){let i=e.length;for(let r=0;r<i;r++){let s=e[r].value;s=ra.decodeEntityReference(s);let o=e[r].name.split("."),d=o[0],$=n,I=o.find(fe=>E9.includes(fe));null==I?1<o.length&&(({obj:$,key:d}=Gn.attributes2object(o,$,d)),null==d)||("string"!=typeof $[d]&&null!=$[d]&&(s=JSON.parse(s)),$[d]=s):console.log(`skip invalid key (${I})`)}return n}static attributes2object(n,e,i){let r=null,s=n.length;for(let o=0;o<s;o++){let d=parseInt(n[o]);if(r&&!Number.isNaN(d)&&!Array.isArray(e)&&Object.keys(r).length&&(r[i]=[],e=r[i]),i=Number.isNaN(d)?n[o]:d,Array.isArray(e)&&"number"!=typeof i)return console.warn("Array\u306b\u306findex\u306e\u633f\u5165\u3057\u304b\u8a31\u53ef\u3057\u306a\u3044"),{obj:e,key:null};o+1<s&&(null==e[i]&&(e[i]="number"==typeof i?[]:{}),r=e,e=e[i])}return{obj:e,key:i}}static parseInnerXml(n){return null}}class La{constructor(n=ms.generateUuid()){this.context={aliasName:this.constructor.aliasName,identifier:"",majorVersion:0,minorVersion:0,syncData:{}},this.context.identifier=n}static get aliasName(){return So.instance.getAlias(this)}get aliasName(){return this.context.aliasName}get identifier(){return this.context.identifier}get version(){return this.context.majorVersion+this.context.minorVersion}initialize(){rt.instance.add(this)}destroy(){rt.instance.delete(this)}onStoreAdded(){}onStoreRemoved(){}update(){this.versionUp(),rt.instance.update(this.identifier)}versionUp(){this.context.majorVersion+=1,this.context.minorVersion=Math.random()}apply(n){null!==n&&this.identifier===n.identifier&&(this.context.majorVersion=n.majorVersion,this.context.minorVersion=n.minorVersion,this.context.syncData=n.syncData)}clone(){let n=this.toXml();return Gn.instance.parseXml(n)}toContext(){return{aliasName:this.context.aliasName,identifier:this.context.identifier,majorVersion:this.context.majorVersion,minorVersion:this.context.minorVersion,syncData:H3(this.context.syncData)}}toXml(){return Gn.instance.toXml(this)}}function H3(t){if(null==t)return t;let n=Array.isArray(t)?[]:{},e=Object.getOwnPropertyNames(t);for(let i of e){let r=typeof t[i];null!=t[i]&&"object"===r?n[i]=H3(t[i]):"function"!==r&&(n[i]=t[i])}return n}var ko;let Ln=ko=class extends La{constructor(){super(...arguments),this.value="",this.attributes={},this.parentIdentifier="",this.majorIndex=0,this.minorIndex=Math.random(),this._children=[],this.needsSort=!0}get index(){return this.majorIndex+this.minorIndex}set index(n){this.majorIndex=0|n,this.minorIndex=n-this.majorIndex,this.parent&&(this.parent.needsSort=!0)}get parent(){return rt.instance.get(this.parentIdentifier)}get parentId(){return this.parentIdentifier}get parentIsAssigned(){return 0<this.parentIdentifier.length}get parentIsUnknown(){return this.parentIsAssigned&&null==rt.instance.get(this.parentIdentifier)}get parentIsDestroyed(){return this.parentIsAssigned&&rt.instance.isDeleted(this.parentIdentifier)}get children(){return this.needsSort&&(this.needsSort=!1,this._children.sort((n,e)=>n.index-e.index)),this._children.concat()}destroy(){super.destroy();for(let n of this._children.concat())n.destroy();this._children=[]}onStoreAdded(){super.onStoreAdded(),this.initializeChildren()}onStoreRemoved(){super.onStoreRemoved(),this.parent&&this.parent.removeChild(this)}onChildAdded(n){}onChildRemoved(n){}_onChildAdded(n){let e=this;for(;e&&(e.onChildAdded(n),e=e.parent,e!==this););}_onChildRemoved(n){let e=this;for(;e&&(e.onChildRemoved(n),e=e.parent,e!==this););}initializeChildren(){if(null==ko.unknownNodes[this.identifier])return;let n=ko.unknownNodes[this.identifier];for(let e of n)e.parent===this&&this.updateChildren(e);ko.unknownNodes[this.identifier]&&delete ko.unknownNodes[this.identifier]}updateChildren(n=this){let e=this._children.indexOf(n),i=!1,r=n.parent===this;if(e<0&&r)this._children.push(n),e=this._children.length-1,i=!0;else{if(0<=e&&!r)return this._children.splice(e,1),void this._onChildRemoved(n);if(e<0&&!r)return}let s=this._children.length;s&&((this._children[e-1<0?0:e-1].index>n.index||n.index>this._children[s-1<e+1?s-1:e+1].index)&&(this.needsSort=!0),i&&this._onChildAdded(n))}updateIndexs(){let n=this.children;for(let e=0;e<n.length;e++)n[e].majorIndex=e,n[e].minorIndex=Math.random()}appendChild(n){if(n.contains(this))return null;n.parent&&n.parent!==this&&n.parent.removeChild(n);let e=0<this.children.length?this.children[this.children.length-1].majorIndex+1:0;return n.parentIdentifier=this.identifier,n.majorIndex=e,n.minorIndex=Math.random(),this.updateChildren(n),n}insertBefore(n,e){if(n.contains(this))return null;if(n===e&&n.parent===this)return n;n.parent&&n.parent!==this&&n.parent.removeChild(n);let i=this.children.indexOf(e);if(i<0)return this.appendChild(n);n.parentIdentifier=this.identifier;let r=0<i?this.children[i-1].index:0,s=e.index-r,o=r+s*(.45+.1*Math.random());return n.majorIndex=0|o,n.minorIndex=o-n.majorIndex,this.updateChildren(n),s<1e-7&&this.updateIndexs(),n}removeChild(n){return this.children.indexOf(n)<0?null:(n.parentIdentifier="",n.majorIndex=0,n.minorIndex=Math.random(),this.updateChildren(n),n)}contains(n){let e=n.parent;for(;e;){if(e===n)return console.error("\u3042 \u3084\u3063\u3079\u3001\u5faa\u74b0\u53c2\u7167",n),!1;if(e===this)return!0;e=e.parent}return!1}setAttribute(n,e){this.attributes[n]=e,this.update()}getAttribute(n){return null==this.attributes[n]?"":this.attributes[n]}removeAttribute(n){delete this.attributes[n],this.update()}toAttributes(){return Gn.toAttributes(this.attributes)}parseAttributes(n){Gn.parseAttributes(this.attributes,n)}innerXml(){let n="";n+=ra.encodeEntityReference(this.value+"");for(let e of this.children)n+=Gn.instance.toXml(e);return n}parseInnerXml(n){let e=n.children,i=e.length;if(0<i)for(let r=0;r<i;r++){let s=Gn.instance.parseXml(e[r]);s instanceof ko&&this.appendChild(s)}else this.value=ra.decodeEntityReference(n.innerHTML)}apply(n){let e=this.parent;super.apply(n),e&&this.parent!==e&&e.updateChildren(this),this.parent?this.parent.updateChildren(this):this.parentIsAssigned&&(this.parentIdentifier in ko.unknownNodes||(ko.unknownNodes[this.parentIdentifier]=[]),ko.unknownNodes[this.parentIdentifier].push(this))}};function Kn(t){return n=>{U3(t)(n)}}function st(){return(t,n)=>{t instanceof Ln?function w9(){return(t,n)=>{Object.defineProperty(t,n,{get:function e(){return this.getAttribute(n)},set:function i(r){this.setAttribute(n,r)},enumerable:!0,configurable:!0})}}()(t,n):iu()(t,n)}}Ln.unknownNodes={},B([iu()],Ln.prototype,"value",void 0),B([iu()],Ln.prototype,"attributes",void 0),B([iu()],Ln.prototype,"parentIdentifier",void 0),B([iu()],Ln.prototype,"majorIndex",void 0),B([iu()],Ln.prototype,"minorIndex",void 0),Ln=ko=B([U3("node")],Ln);class V3{constructor(n="Queue"){this.name=n,this.queue=Promise.resolve(),this._length=0}get length(){return this._length}add(n){this._length++,console.log(`${this.name} add: ${this._length}`),this.queue=this.queue.then("function"==typeof n.then?()=>n:0<n.length?()=>new Promise(n):n);let e=this.queue;return this.queue=this.queue.catch(i=>{console.error(i)}),this.queue=this.queue.then(()=>{this._length--,console.log(`${this.name} done: ${this._length}`)}),e}}var et,qn;!function(t){const n=new RegExp(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]","\ud7c9[\ude00-\udeff]","[\u2600-\u27bf]"].join("|"));t.toHalfWidth=function e(fe){return fe.replace(/[\uff01-\uff5e]/g,_e=>String.fromCharCode(_e.charCodeAt(0)-65248))},t.isEmote=function i(fe){return!!fe&&(fe=this.cr(fe).replace(/[\s\r\n]/g,""),Array.from(fe).length<=3&&!/[\u300c\u300d]/.test(fe)&&(n.test(fe)||/[$\uff04\\\uffe5\uff01\uff1f\u2755\u2762\u203d\u203c/!/?\u2665\u266a\u266c\u2669\u266b\u263a\ud83e\udd2e\u2764\ufe0f\u2620\ufe0f]/.test(fe)))},t.cr=function r(fe){if(!fe)return"";let _e="",Ce="";return[...fe].forEach(Ee=>{if(Ce){switch(Ee){case"n":case"\uff4e":_e+="\n";break;case"\\":case"\uffe5":_e+=Ee;break;default:_e+=Ce+Ee}Ce=""}else"\\"==Ee||"\uffe5"==Ee?Ce=Ee:_e+=Ee}),_e},t.validUrl=function s(fe){if(!fe)return!1;try{new URL(fe.trim())}catch(_e){return!1}return/^https?\:\/\//.test(fe.trim())},t.sameOrigin=function o(fe){if(!fe)return!1;try{return new URL(fe).origin===window.location.origin}catch(_e){return!1}},t.escapeHtml=function d(fe){return"string"!=typeof fe&&(fe=fe.toString()),fe.replace(/[&'`"<>]/g,function(_e){return{"&":"&amp;","'":"&#x27;","`":"&#x60;",'"':"&quot;","<":"&lt;",">":"&gt;"}[_e]})},t.rubyToHtml=function $(fe){return"string"!=typeof fe&&(fe=fe.toString()),fe.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"<ruby>$1<rp>(</rp><rt>$2</rt><rp>)</rp></ruby>")},t.rubyToText=function I(fe){return"string"!=typeof fe&&(fe=fe.toString()),fe.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g,"$1($2)")},t.aliasNameToClassName=function Q(fe){switch(fe){case"character":return"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc";case"cut-in":return"\u30ab\u30c3\u30c8\u30a4\u30f3";case"dice-roll-table":return"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868";case"terrain":return"\u5730\u5f62";case"table-mask":return"\u30de\u30c3\u30d7\u30de\u30b9\u30af";case"text-note":return"\u5171\u6709\u30e1\u30e2";case"card":return"\u30ab\u30fc\u30c9";case"dice-symbol":return"\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb";case"card-stack":return"\u5c71\u672d";case"game-table":return"\u30c6\u30fc\u30d6\u30eb";case"chat-tab":return"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6";default:return fe}}}(et||(et={}));class It{constructor(){this.imageHash={},console.log("ImageStorage ready...")}static get instance(){return It._instance||(It._instance=new It),It._instance}get images(){let n=[];for(let e in this.imageHash)n.push(this.imageHash[e]);return n}destroy(){for(let n in this.imageHash)this.delete(n)}addAsync(n){var e=this;return(0,Yt.Z)(function*(){let i=yield Lt.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=Lt.create(n);else if(n instanceof Lt)e=n;else{if(this.update(n))return this.imageHash[n.identifier];e=Lt.create(n)}return this._add(e)}_add(n){return Ni.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.imageHash[n.identifier]:(this.imageHash[n.identifier]=n,console.log("add Image: "+n.identifier),n)}update(n){let e;e=n instanceof Lt?n.toContext():n;let i=this.imageHash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.imageHash[n];return!!e&&(e.destroy(),delete this.imageHash[n],!0)}get(n){return this.imageHash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Fe.call("SYNCHRONIZE_FILE_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ia(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of this.images)Ni.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}let He=qn=class extends La{constructor(){super(...arguments),this.userId="",this.peerId="",this.name="",this.imageIdentifier="",this.color=qn.CHAT_DEFAULT_COLOR,this.isGMMode=!1}get isMine(){return qn.myCursor&&qn.myCursor===this}get image(){return It.instance.get(this.imageIdentifier)}onStoreAdded(){super.onStoreAdded(),this.isMine||Fe.register(this).on("DISCONNECT_PEER",n=>{n.data.peerId===this.peerId&&setTimeout(()=>{vt.peerIds.includes(this.peerId)||(qn.userIdMap.delete(this.userId),qn.peerIdMap.delete(this.peerId),rt.instance.remove(this))},3e4)})}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this),qn.userIdMap.delete(this.userId),qn.peerIdMap.delete(this.peerId)}static findByUserId(n){return this.find(qn.userIdMap,n,!0)}static findByPeerId(n){return this.find(qn.peerIdMap,n,!1)}static find(n,e,i){let r=n.get(e);if(null!=r&&rt.instance.get(r))return rt.instance.get(r);let s=rt.instance.getObjects(qn);for(let o of s){let d=i?o.userId:o.peerId;if(d===e)return n.set(d,o.identifier),o}return null}static createMyCursor(){return qn.myCursor?(console.warn("It is already created."),qn.myCursor):(qn.myCursor=new qn,qn.myCursor.peerId=vt.peerId,qn.myCursor.initialize(),window.localStorage&&localStorage.getItem(qn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)&&(qn.myCursor.name=localStorage.getItem(qn.CHAT_MY_NAME_LOCAL_STORAGE_KEY)),window.localStorage&&localStorage.getItem(qn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&(qn.myCursor.color=localStorage.getItem(qn.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)),qn.myCursor)}apply(n){let e=n.syncData.userId,i=n.syncData.peerId;e!==this.userId&&(qn.userIdMap.set(e,this.identifier),qn.userIdMap.delete(this.userId)),i!==this.peerId&&(qn.peerIdMap.set(i,this.identifier),qn.peerIdMap.delete(this.peerId)),super.apply(n)}isPeerAUdon(){return null!=/u.*d.*o.*n/gi.exec(this.peerId)}};He.isGMHold=!1,He.CHAT_MY_NAME_LOCAL_STORAGE_KEY="udonanaumu-chat-my-name-local-storage",He.CHAT_MY_COLOR_LOCAL_STORAGE_KEY="udonanaumu-chat-my-color-local-storage",He.CHAT_DEFAULT_COLOR="#444444",He.CHAT_TRANSPARENT_COLOR="#ffffff",He.myCursor=null,He.userIdMap=new Map,He.peerIdMap=new Map,B([st()],He.prototype,"userId",void 0),B([st()],He.prototype,"peerId",void 0),B([st()],He.prototype,"name",void 0),B([st()],He.prototype,"imageIdentifier",void 0),B([st()],He.prototype,"color",void 0),B([st()],He.prototype,"isGMMode",void 0),He=qn=B([Kn("PeerCursor")],He);let ru=class extends Ln{constructor(){super(...arguments),this.dicebot="",this.paletteColor="",this._palettes=[],this._paletteLines=[],this._paletteVariables=[],this.isAnalized=!1}get color(){return this.paletteColor&&"#ffffff"!=this.paletteColor?this.paletteColor:window.localStorage&&localStorage.getItem(He.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)&&"#ffffff"!=localStorage.getItem(He.CHAT_MY_COLOR_LOCAL_STORAGE_KEY)?localStorage.getItem(He.CHAT_MY_COLOR_LOCAL_STORAGE_KEY):He.CHAT_DEFAULT_COLOR}set color(n){this.paletteColor=n}get paletteLines(){return this.isAnalized||this.parse(this.value),this._paletteLines}get paletteVariables(){return this.isAnalized||this.parse(this.value),this._paletteVariables}getPalette(){return this.isAnalized||this.parse(this.value),this._palettes}setPalette(n){this.value=n,this.isAnalized=!1}evaluate(n,e){let i="";i="string"==typeof n?n:n.palette,console.log(i);let s=0,o=!0;for(;o;)s++,o=!1,i=i.replace(/[{\uff5b]\s*([^{}\uff5b\uff5d]+)\s*[}\uff5d]/g,(d,$)=>{o=!0;let I="";for(let Q of this.paletteVariables)Q.name==$&&(I=Q.value);if(e){let Q=e.getFirstElementByNameUnsensitive($);return Q?(I=Q.isNumberResource?Q.currentValue:Q.isCheckProperty?(Q.currentValue+"").split(/[|\uff5c]/g)[Q.value?0:1]:Q.isAbilityScore?Q.calcAbilityScore():Q.value,null==I&&(I="")):((Q=e.getFirstElementByNameUnsensitive($.replace(/^\u6700\u5927/,""))||e.getFirstElementByNameUnsensitive($.replace(/^Max[\:\_\-\s]?/i,""))||e.getFirstElementByNameUnsensitive($.replace(/^\u57fa\u672c/,""))||e.getFirstElementByNameUnsensitive($.replace(/^\u521d\u671f/,""))||e.getFirstElementByNameUnsensitive($.replace(/^\u539f/,""))||e.getFirstElementByNameUnsensitive($.replace(/\u57fa\u672c\u5024$/,""))||e.getFirstElementByNameUnsensitive($.replace(/\u521d\u671f\u5024$/,""))||e.getFirstElementByNameUnsensitive($.replace(/\u539f\u70b9$/,"")))&&(Q.isNumberResource||Q.isAbilityScore)&&(I=Q.value),(Q=e.getFirstElementByNameUnsensitive($.replace(/\u4fee\u6b63\u5024?$/,""))||e.getFirstElementByNameUnsensitive($.replace(/\s*Mod(ifier|\.)?$/i,""))||e.getFirstElementByNameUnsensitive($.replace(/\u30dc\u30fc\u30ca\u30b9$/,"")))&&Q.isAbilityScore&&(I=Q.calcAbilityScore())),I+""}return""}),128<s&&(o=!1);return i}parse(n){this._palettes=n.split("\n"),this._paletteLines=[],this._paletteVariables=[];for(let e of this._palettes){let i=this.parseVariable(e);i?this._paletteVariables.push(i):this._paletteLines.push({palette:e})}this.isAnalized=!0}parseVariable(n){let e=/^\s*[/\uff0f]{2}([^=\uff1d{}\uff5b\uff5d\s]+)\s*[=\uff1d]\s*(.+)\s*/gi.exec(n);return e?{name:et.toHalfWidth(e[1]),value:e[2]}:null}apply(n){super.apply(n),this.isAnalized=!1}};var za;B([st()],ru.prototype,"dicebot",void 0),B([st()],ru.prototype,"paletteColor",void 0),ru=B([Kn("chat-palette")],ru);let dt=za=class extends Ln{get isSimpleNumber(){return null!=this.type&&"simpleNumber"===this.type}get isNumberResource(){return null!=this.type&&"numberResource"===this.type}get isCheckProperty(){return null!=this.type&&"checkProperty"===this.type}get isNote(){return null!=this.type&&"note"===this.type}get isAbilityScore(){return null!=this.type&&"abilityScore"===this.type}get isUrl(){return null!=this.type&&"url"===this.type}static create(n,e="",i={},r=""){let s;return s=r&&0<r.length?new za(r):new za,s.attributes=i,s.name=n,s.value=e,s.initialize(),s}getElementsByName(n){let e=[];for(let i of this.children)i instanceof za&&(i.getAttribute("name")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByName(n)));return e}getElementsByType(n){let e=[];for(let i of this.children)i instanceof za&&(i.getAttribute("type")===n&&e.push(i),Array.prototype.push.apply(e,i.getElementsByType(n)));return e}getFirstElementByName(n){for(let e of this.children)if(e instanceof za){if(e.getAttribute("name")===n)return e;let i=e.getFirstElementByName(n);if(i)return i}return null}getFirstElementByNameUnsensitive(n){for(let e of this.children)if(e instanceof za){if(et.toHalfWidth(e.getAttribute("name").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase()===et.toHalfWidth(n.replace(/[\u2015\u30fc\u2014\u2010]/g,"-")).toLowerCase())return e;let i=e.getFirstElementByNameUnsensitive(n);if(i)return i}return null}calcAbilityScore(){if(!this.isAbilityScore||!this.value)return 0;let n;return(n=this.currentValue.toString().match(/^div(\d+)$/))?Math.floor(+this.value/+n[1]):(n=this.currentValue.toString().match(/^DnD/))?Math.floor((+this.value-10)/2):+this.value}};B([st()],dt.prototype,"name",void 0),B([st()],dt.prototype,"type",void 0),B([st()],dt.prototype,"currentValue",void 0),dt=za=B([Kn("data")],dt);let mi=class extends Ln{constructor(){super(...arguments),this.location={name:"table",x:0,y:0},this.posZ=0,this._imageFile=Lt.Empty,this._shadowImageFile=Lt.Empty,this._dataElements={},this.currntImageIndex=0,this.isUseIconToOverviewImage=!1,this.currntIconIndex=0,this.isAltitudeIndicate=!1,this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,this.isNotRide=!0,this.isInventoryIndicate=!0}get isVisibleOnTable(){return"table"===this.location.name}get rootDataElement(){for(let n of this.children)if(n.getAttribute("name")===this.aliasName)return n;return null}get imageDataElement(){return this.getElement("image")}get commonDataElement(){return this.getElement("common")}get detailDataElement(){return this.getElement("detail")}get imageElement(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("imageIdentifier");return n[this.currntImageIndex<0?0:this.currntImageIndex>=n.length?n.length-1:this.currntImageIndex]}get imageFile(){if(!this.imageDataElement)return this._imageFile;let n=this.imageElement;if(n&&this._imageFile.identifier!==n.value){let e=It.instance.get(n.value);this._imageFile=e||Lt.Empty}return this._imageFile}get imageFiles(){return this.imageDataElement?this.imageDataElement.getElementsByName("imageIdentifier").map(e=>It.instance.get(e.value)||null).filter(e=>null!=e):[]}get faceIcon(){if(!this.imageDataElement)return null;let n=this.imageDataElement.getElementsByName("faceIcon");if(n){let e=n[this.currntIconIndex];return this.currntIconIndex<0&&(this.currntIconIndex=0),e?It.instance.get(e.value):null}return null}get faceIcons(){return this.imageDataElement?this.imageDataElement.getElementsByName("faceIcon").map(e=>It.instance.get(e.value)||null).filter(e=>null!=e):[]}get shadowImageFile(){if(!this.imageDataElement)return this._shadowImageFile;let n=this.imageDataElement.getFirstElementByName("shadowImageIdentifier");if(n&&this._shadowImageFile.identifier!==n.value){let e=It.instance.get(n.value);this._shadowImageFile=e||Lt.Empty}else{let e=this.imageElement;if(e&&this._shadowImageFile.identifier!==e.currentValue){let i=It.instance.get(e.currentValue);this._shadowImageFile=i||Lt.Empty}}return this._shadowImageFile}get altitude(){let n=this.getElement("altitude",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.appendChild(dt.create("altitude",0,{},"altitude_"+this.identifier));let e=n?+n.value:0;return Number.isNaN(e)?0:e}set altitude(n){let e=this.getElement("altitude",this.commonDataElement);e&&(e.value=n)}get isGMMode(){return!!He.myCursor&&He.myCursor.isGMMode}createDataElements(){this.initialize();let n=this.aliasName;if(!this.rootDataElement){let e=dt.create(n,"",{},n+"_"+this.identifier);this.appendChild(e)}this.imageDataElement||(this.rootDataElement.appendChild(dt.create("image","",{},"image_"+this.identifier)),this.imageDataElement.appendChild(dt.create("imageIdentifier","",{type:"image"},"imageIdentifier_"+this.identifier))),this.commonDataElement||this.rootDataElement.appendChild(dt.create("common","",{},"common_"+this.identifier)),this.detailDataElement||this.rootDataElement.appendChild(dt.create("detail","",{},"detail_"+this.identifier))}getElement(n,e=this.rootDataElement){if(!e)return null;let i=this._dataElements[n]?rt.instance.get(this._dataElements[n]):null;return(!i||!e.contains(i))&&(i=e.getFirstElementByName(n),this._dataElements[n]=i?i.identifier:null),i}getCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);if(!i)return e;if("number"==typeof e){let r=+i.value;return Number.isNaN(r)?e:r}return i.value+""}getUrls(){return this.rootDataElement.getElementsByType("url")}setCommonValue(n,e){let i=this.getElement(n,this.commonDataElement);!i||(i.value=e)}getImageFile(n){if(!this.imageDataElement)return null;let e=this.getElement(n,this.imageDataElement);return e?It.instance.get(e.value):null}setImageFile(n,e){let i=e?this.getElement(n,this.imageDataElement):null;!i||(i.value=e.identifier)}setLocation(n){this.location.name=n,this.update()}};B([st()],mi.prototype,"location",void 0),B([st()],mi.prototype,"posZ",void 0),B([st()],mi.prototype,"currntImageIndex",void 0),B([st()],mi.prototype,"isUseIconToOverviewImage",void 0),B([st()],mi.prototype,"currntIconIndex",void 0),B([st()],mi.prototype,"isAltitudeIndicate",void 0),B([st()],mi.prototype,"isInverse",void 0),B([st()],mi.prototype,"isHollow",void 0),B([st()],mi.prototype,"isBlackPaint",void 0),B([st()],mi.prototype,"aura",void 0),B([st()],mi.prototype,"isNotRide",void 0),B([st()],mi.prototype,"isInventoryIndicate",void 0),mi=B([Kn("TabletopObject")],mi);var bi=(()=>(function(t){t[t.Default=1]="Default",t[t.Image=2]="Image",t[t.Postfix=3]="Postfix",t[t.PostfixOrImage=4]="PostfixOrImage",t[t.PostfixAndImage=5]="PostfixAndImage",t[t.NotConditionStandUp=6]="NotConditionStandUp"}(bi||(bi={})),bi))();let ja=class extends dt{constructor(){super(...arguments),this.position=5,this.height=35,this.overviewIndex=-1}get standElements(){return this.getElementsByName("stand")}add(n){let e=this.getFirstElementByName("stand")?bi.NotConditionStandUp:bi.Default,i=dt.create("stand");i.appendChild(dt.create("name","",{},"name_"+i.identifier)),i.appendChild(dt.create("imageIdentifier",n&&n!=Lt.Empty.identifier?n:"stand_no_image",{type:"image"},"imageIdentifier_"+i.identifier)),i.appendChild(dt.create("conditionType",e,{},"conditionType_"+i.identifier)),i.appendChild(dt.create("height",0,{currentValue:0},"height_"+i.identifier)),i.appendChild(dt.create("applyImageEffect","",{},"applyImageEffect_"+i.identifier)),i.appendChild(dt.create("applyRoll","",{},"applyRoll_"+i.identifier)),i.appendChild(dt.create("applyDialog","applyDialog",{},"applyDialog_"+i.identifier)),i.appendChild(dt.create("showName","showName",{},"showName_"+i.identifier)),i.appendChild(dt.create("postfix","",{},"postfix_"+i.identifier)),i.appendChild(dt.create("position",0,{currentValue:""},"position_"+i.identifier)),i.appendChild(dt.create("speakingImageIdentifier","",{type:"image"},"speakingImageIdentifier_"+i.identifier)),this.appendChild(i)}remove(n){this.removeChild(n)}matchStandInfo(n,e,i=null){const r=e instanceof Lt?e.identifier:e;let s="",o=!1,d=[];["\uff20\u9000\u53bb","@farewell"].forEach(Ce=>{et.toHalfWidth(n).trimRight().toUpperCase().endsWith(et.toHalfWidth(Ce).toUpperCase())&&(("@"==Ce.slice(0,1)||"\uff20"==Ce.slice(0,1))&&s.length<Ce.length&&(s=Ce),o=!0)});for(const Ce of this.standElements){const Ee=Ce.getFirstElementByName("name");Ee&&Ee.value.toString()==i&&d.push(Ce)}let $=1,I=!0,Q=[],fe=[];for(const Ce of this.standElements){if(!Ce.getFirstElementByName("imageIdentifier")||!Ce.getFirstElementByName("conditionType"))continue;const Ee=Ce.getFirstElementByName("conditionType").value;if(Ee!=bi.NotConditionStandUp)if(Ee==bi.Default)Q.push(Ce);else{const Re=Ce.getFirstElementByName("postfix")?Ce.getFirstElementByName("postfix").value.toString():null,Le=Ce.getFirstElementByName("targetImageIdentifier")?Ce.getElementsByName("targetImageIdentifier").map(je=>je.value):[];let Be=!1,Ae=!1;if(Re&&(Ee==bi.Postfix||Ee==bi.PostfixOrImage||Ee==bi.PostfixAndImage))for(let je of Re.split(/[\r\n]+/g))null==je||0==je.trim().length||et.toHalfWidth(n).toUpperCase().trimRight().endsWith(et.toHalfWidth(je).trimRight().toUpperCase())&&(("@"==je.slice(0,1)||"\uff20"==je.slice(0,1))&&s.length<je.length&&(s=je),Be=!0);Le.length>0&&(Ee==bi.Image||Ee==bi.PostfixOrImage||Ee==bi.PostfixAndImage)&&(Ae=r&&Le.indexOf(r)>=0),(Be&&(Ee==bi.Postfix||Ee==bi.PostfixOrImage)||Ae&&(Ee==bi.Image||Ee==bi.PostfixOrImage)||Be&&Ae&&Ee==bi.PostfixAndImage)&&(I=!1,fe.push(Ce),$<+Ee&&($=+Ee))}}i||(d=I?Q:fe.filter(Ce=>+Ce.getFirstElementByName("conditionType").value==$));let _e={standElementIdentifier:null,matchMostLongText:s,farewell:o};return d&&d.length>0&&(_e.standElementIdentifier=d[Math.floor(Math.random()*d.length)].identifier),_e}};var Rp;B([st()],ja.prototype,"position",void 0),B([st()],ja.prototype,"height",void 0),B([st()],ja.prototype,"overviewIndex",void 0),ja=B([Kn("stand-list")],ja);let jt=Rp=class extends mi{constructor(n=ms.generateUuid()){super(n),this.rotate=0,this.roll=0,this.isDropShadow=!0,this.isShowChatBubble=!0,this.owner="",this.text="",this.isEmote=!1,this.isLoaded=!1,this.isAltitudeIndicate=!0}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}get height(){let n=this.getElement("height",this.commonDataElement);!n&&this.commonDataElement&&this.commonDataElement.insertBefore(dt.create("height",0,{currentValue:""},"height_"+this.identifier),this.getElement("altitude",this.commonDataElement));let e=n?+n.value:0;return n&&n.currentValue&&(e=(Number.isNaN(e)?0:e)*this.size),Number.isNaN(e)?0:e}get chatPalette(){for(let n of this.children)if(n instanceof ru)return n;return null}get ownerName(){let n=He.findByUserId(this.owner);return n?n.name:null}get ownerColor(){let n=He.findByUserId(this.owner);return n?n.color:"#444444"}get standList(){for(let e of this.children)if(e instanceof ja)return e;let n=new ja("StandList_"+this.identifier);return n.initialize(),this.appendChild(n),n}static create(n,e,i){let r=new Rp;return r.createDataElements(),r.initialize(),r.createTestGameDataElement(n,e,i),r}get isHideIn(){return!!this.owner}get isVisible(){return!this.owner||vt.peerContext.userId===this.owner}static get isStealthMode(){for(const n of rt.instance.getObjects(Rp))if(n.isHideIn&&n.isVisible&&"table"===n.location.name)return!0;return!1}createTestGameDataElement(n,e,i){this.createDataElements();let r=dt.create("name",n,{},"name_"+this.identifier),s=dt.create("size",e,{},"size_"+this.identifier),o=dt.create("height",0,{currentValue:""},"height_"+this.identifier),d=dt.create("altitude",0,{},"altitude_"+this.identifier);this.imageDataElement.getFirstElementByName("imageIdentifier")&&(this.imageDataElement.getFirstElementByName("imageIdentifier").value=i);let $=dt.create("\u30ea\u30bd\u30fc\u30b9","",{},"\u30ea\u30bd\u30fc\u30b9"+this.identifier),I=dt.create("HP",200,{type:"numberResource",currentValue:"200"},"HP_"+this.identifier),Q=dt.create("MP",100,{type:"numberResource",currentValue:"100"},"MP_"+this.identifier);this.commonDataElement.appendChild(r),this.commonDataElement.appendChild(s),this.commonDataElement.appendChild(o),this.commonDataElement.appendChild(d),this.detailDataElement.appendChild($),$.appendChild(I),$.appendChild(Q);let fe=dt.create("\u60c5\u5831","",{},"\u60c5\u5831"+this.identifier);this.detailDataElement.appendChild(fe),fe.appendChild(dt.create("\u8aac\u660e","\u3053\u3053\u306b\u8aac\u660e\u3092\u66f8\u304f\n\u3042\u3044\u3046\u3048\u304a",{type:"note"},"\u8aac\u660e"+this.identifier)),fe.appendChild(dt.create("\u30e1\u30e2","\u4efb\u610f\u306e\u6587\u5b57\u5217\n\uff11\n\uff12\n\uff13\n\uff14\n\uff15",{type:"note"},"\u30e1\u30e2"+this.identifier)),fe.appendChild(dt.create("\u53c2\u7167URL","https://www.example.com",{type:"url"},"\u53c2\u7167URL"+this.identifier)),fe=dt.create("\u80fd\u529b","",{},"\u80fd\u529b"+this.identifier),this.detailDataElement.appendChild(fe),fe.appendChild(dt.create("\u5668\u7528\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u5668\u7528\u5ea6"+this.identifier)),fe.appendChild(dt.create("\u654f\u6377\u5ea6",24,{type:"abilityScore",currentValue:"div6"},"\u654f\u6377\u5ea6"+this.identifier)),fe.appendChild(dt.create("\u7b4b\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7b4b\u529b"+this.identifier)),fe.appendChild(dt.create("\u751f\u547d\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u751f\u547d\u529b"+this.identifier)),fe.appendChild(dt.create("\u77e5\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u77e5\u529b"+this.identifier)),fe.appendChild(dt.create("\u7cbe\u795e\u529b",24,{type:"abilityScore",currentValue:"div6"},"\u7cbe\u795e\u529b"+this.identifier)),fe=dt.create("\u6226\u95d8\u7279\u6280","",{},"\u6226\u95d8\u7279\u6280"+this.identifier),this.detailDataElement.appendChild(fe),fe.appendChild(dt.create("Lv1","\u5168\u529b\u653b\u6483",{},"Lv1"+this.identifier)),fe.appendChild(dt.create("Lv3","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9",{},"Lv3"+this.identifier)),fe.appendChild(dt.create("Lv5","\u6b66\u5668\u7fd2\u719f/\u30bd\u30fc\u30c9\u2161",{},"Lv5"+this.identifier)),fe.appendChild(dt.create("Lv7","\u9811\u5f37",{},"Lv7"+this.identifier)),fe.appendChild(dt.create("Lv9","\u8599\u304e\u6255\u3044",{},"Lv9"+this.identifier)),fe.appendChild(dt.create("\u81ea\u52d5","\u6cbb\u7652\u9069\u6b63",{},"\u81ea\u52d5"+this.identifier)),(new DOMParser).parseFromString(this.rootDataElement.toXml(),"application/xml");let Ee=new ru("ChatPalette_"+this.identifier);Ee.setPalette("\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u5165\u529b\u4f8b\uff1a\n2d6+1 \u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\n\uff11\uff44\uff12\uff10\uff0b{\u654f\u6377}\uff0b\uff5b\u683c\u95d8\uff5d\u3000{name}\u306e\u683c\u95d8\uff01\n//\u654f\u6377=10+{\u654f\u6377A}\n//\u654f\u6377A=10\n//\u683c\u95d8\uff1d\uff11"),Ee.initialize(),this.appendChild(Ee);let Re=new ja("StandList_"+this.identifier);Re.initialize(),this.appendChild(Re)}};B([st()],jt.prototype,"rotate",void 0),B([st()],jt.prototype,"roll",void 0),B([st()],jt.prototype,"isDropShadow",void 0),B([st()],jt.prototype,"isShowChatBubble",void 0),B([st()],jt.prototype,"owner",void 0),jt=Rp=B([Kn("character")],jt);let sa=class extends Ln{constructor(){super(...arguments),this.name="",this.command="",this.dice=""}parseText(){return this.value?this.value.split(/[\r\n]+/).map(n=>{let e=null;if(e=(n=n.trim()).match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),r=+et.toHalfWidth(e[2].replace(/[\-\uff0d\u2010]/,"-"));return i<=r?{range:{start:i,end:r},result:e[3]}:{range:{start:r,end:i},result:e[3]}}if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))return{range:{start:+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-")),end:null},result:e[2]};if(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\s\u3000]*([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/))return{range:{start:null,end:+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"))},result:e[2]};if(e=n.match(/([\-\uff0d\u2010]?[\d\uff10-\uff19]+)[\s\u3000]*[:\uff1a](.+)/)){const i=+et.toHalfWidth(e[1].replace(/[\-\uff0d\u2010]/,"-"));return{range:{start:i,end:i},result:e[2]}}return(e=n.match(/[\*\uff0a][\s\u3000]*[\-\u2015\uff0d~\uff5e][\*\uff0a][\s\u3000]*[:\uff1a](.+)/))||(e=n.match(/[\*\uff0a][\s\u3000]*[:\uff1a](.+)/))?{range:{start:null,end:null},result:e[1]}:null}).filter(n=>n):[]}};var Fs;B([st()],sa.prototype,"name",void 0),B([st()],sa.prototype,"command",void 0),B([st()],sa.prototype,"dice",void 0),sa=B([Kn("dice-roll-table")],sa);let ro=Fs=class extends Ln{static get instance(){return Fs._instance||(Fs._instance=new Fs("DiceRollTableList"),Fs._instance.initialize()),Fs._instance}get diceRollTables(){return this.children}addDiceRollTable(...n){let e=null;if(n[0]instanceof sa)e=n[0];else{let i=n[0];e=new sa(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Fs.instance.children)i.destroy();let e=Fs.instance.toContext();e.syncData=this.toContext().syncData,Fs.instance.apply(e),Fs.instance.update(),super.parseInnerXml.apply(Fs.instance,[n]),this.destroy()}};ro=Fs=B([Kn("dice-roll-table-list")],ro);var ar=(()=>(function(t){t[t.NULL=0]="NULL",t[t.THUMBNAIL=1]="THUMBNAIL",t[t.COMPLETE=2]="COMPLETE",t[t.URL=1e3]="URL"}(ar||(ar={})),ar))();class _s{constructor(){this.context={identifier:"",name:"",blob:null,type:"",url:""},this.isHidden=!1}get identifier(){return this.context.identifier}get name(){return this.context.name}get blob(){return this.context.blob}get url(){return this.context.url}get isReady(){return ar.NULL<this.state}get state(){return this.url||this.blob?this.url&&!this.blob?ar.URL:ar.COMPLETE:ar.NULL}static createEmpty(n){let e=new _s;return e.context.identifier=n,e}static create(n){if("string"==typeof n){let e=new _s;return e.context.identifier=n,e.context.name=n,e.context.url=n,e}{let e=new _s;return e.apply(n),e}}static createAsync(n){return(0,Yt.Z)(function*(){return n instanceof File?yield _s._createAsync(n,n.name):n instanceof Blob?yield _s._createAsync(n):void 0})()}static _createAsync(n,e){return(0,Yt.Z)(function*(){let i=yield no.readAsArrayBufferAsync(n),r=new _s;return r.context.identifier=yield no.calcSHA256Async(i),r.context.name=e,r.context.blob=new Blob([i],{type:n.type}),r.context.type=r.context.blob.type,r.context.url=window.URL.createObjectURL(r.context.blob),r.context.name||(r.context.name=r.context.identifier),r})()}destroy(){this.revokeURLs()}apply(n){!this.context.identifier&&n.identifier&&(this.context.identifier=n.identifier),n.name&&(this.context.name=n.name),!this.context.blob&&n.blob&&(this.context.blob=n.blob),!this.context.type&&n.type&&(this.context.type=n.type),!this.context.url&&n.url&&(this.state!==ar.URL&&window.URL.revokeObjectURL(this.context.url),this.context.url=n.url),this.createURLs()}createURLs(){this.state!==ar.URL&&this.context.blob&&""===this.context.url&&(this.context.url=window.URL.createObjectURL(this.context.blob))}revokeURLs(){this.state!==ar.URL&&window.URL.revokeObjectURL(this.context.url)}toContext(){return{identifier:this.context.identifier,name:this.context.name,blob:this.context.blob,type:this.context.type,url:this.context.url}}}var Ua=(()=>(function(t){t[t.MASTER=0]="MASTER",t[t.AUDITION=1]="AUDITION"}(Ua||(Ua={})),Ua))();class kt{constructor(n){this.volumeType=Ua.MASTER,this.audio=n}static get audioContext(){return kt._audioContext||(kt._audioContext=new(window.AudioContext||window.webkitAudioContext)),kt._audioContext}static get volume(){return kt._volume}static set volume(n){kt._volume=n,kt.masterGainNode.gain.setTargetAtTime(kt._volume,kt.audioContext.currentTime,.01)}static get auditionVolume(){return kt._auditionVolume}static set auditionVolume(n){kt._auditionVolume=n,kt.auditionGainNode.gain.setTargetAtTime(kt._auditionVolume,kt.audioContext.currentTime,.01)}static get masterGainNode(){if(!kt._masterGainNode){let n=kt.audioContext.createGain();n.gain.setValueAtTime(kt._volume,kt.audioContext.currentTime),n.connect(kt.audioContext.destination),kt._masterGainNode=n}return kt._masterGainNode}static get auditionGainNode(){if(!kt._auditionGainNode){let n=kt.audioContext.createGain();n.gain.setValueAtTime(kt._auditionVolume,kt.audioContext.currentTime),n.connect(kt.audioContext.destination),kt._auditionGainNode=n}return kt._auditionGainNode}static get rootNode(){return kt.masterGainNode}static get auditionNode(){return kt.auditionGainNode}get audioElm(){return this._audioElm||(this._audioElm=new Audio,this._audioElm.onplay=()=>{},this._audioElm.onpause=()=>{this.mediaElementSource.disconnect()},this._audioElm.onended=()=>{this.mediaElementSource.disconnect()}),this._audioElm}get mediaElementSource(){return this._mediaElementSource||(this._mediaElementSource=kt.audioContext.createMediaElementSource(this.audioElm)),this._mediaElementSource}get volume(){return this.audioElm.volume}set volume(n){this.audioElm.volume=n}get loop(){return this.audioElm.loop}set loop(n){this.audioElm.loop=n}get paused(){return this.audioElm.paused}static play(n,e=1){this.playBufferAsync(n,e)}play(n=this.audio){if(this.stop(),this.audio=n,!this.audio)return;let e=this.audio.url;n.state===ar.URL&&(kt.cacheMap.has(n.identifier)?e=kt.cacheMap.get(n.identifier).url:kt.createCacheAsync(n)),this.mediaElementSource.connect(this.getConnectingAudioNode()),this.audioElm.src=e,this.audioElm.load(),this.audioElm.play().catch(i=>{console.warn(i)})}pause(){this.audioElm.pause()}stop(){!this.audioElm||(this.pause(),this.audioElm.currentTime=0,this.audioElm.src="",this.audioElm.load(),this.mediaElementSource.disconnect())}getConnectingAudioNode(){return this.volumeType===Ua.AUDITION?kt.auditionNode:kt.rootNode}static playBufferAsync(n,e=1){return(0,Yt.Z)(function*(){let i=yield kt.createBufferSourceAsync(n);if(!i)return;let r=kt.audioContext.createGain();r.gain.setValueAtTime(e,kt.audioContext.currentTime),r.connect(kt.rootNode),i.connect(r),i.onended=()=>{i.stop(),i.disconnect(),r.disconnect(),i.buffer=null},i.start()})()}static createBufferSourceAsync(n){var e=this;return(0,Yt.Z)(function*(){if(!n)return null;try{let i=n.blob;if(n.state===ar.URL)if(kt.cacheMap.has(n.identifier))i=kt.cacheMap.get(n.identifier).blob;else{let o=yield kt.createCacheAsync(n);i=o&&o.blob?o.blob:null}if(!i)return null;let r=yield e.decodeAudioDataAsync(i),s=kt.audioContext.createBufferSource();return s.buffer=r,s}catch(i){return console.warn(i),null}})()}static decodeAudioDataAsync(n){return new Promise(function(){var e=(0,Yt.Z)(function*(i,r){kt.audioContext.decodeAudioData(yield no.readAsArrayBufferAsync(n),s=>i(s),s=>r(s))});return function(i,r){return e.apply(this,arguments)}}())}static getBlobAsync(n){return(0,Yt.Z)(function*(){if(n.blob)return n.blob;if(n.url.length<1)throw new Error("\u3048\u3063 \u306a\u306b\u305d\u308c\u6016\u3044");try{let e=yield fetch(n.url);if(!e.ok)throw new Error("Network response was not ok.");return yield e.blob()}catch(e){throw console.warn("There has been a problem with your fetch operation: ",e.message),e}})()}static createCacheAsync(n){return(0,Yt.Z)(function*(){let e={url:n.url,blob:null};try{e.blob=yield kt.getBlobAsync(n)}catch(i){return console.error(i),e}return kt.cacheMap.has(n.identifier)?kt.cacheMap.get(n.identifier):(e.url=URL.createObjectURL(e.blob),kt.cacheMap.set(n.identifier,e),e)})()}static resumeAudioContext(){kt.audioContext.resume();let n=()=>{kt.audioContext.resume(),document.removeEventListener("touchstart",n,!0),document.removeEventListener("mousedown",n,!0),console.log("resumeAudioContext")};document.addEventListener("touchstart",n,!0),document.addEventListener("mousedown",n,!0)}}kt._volume=.5,kt._auditionVolume=.5,kt.cacheMap=new Map;class Ft{constructor(){this.hash={},console.log("AudioStorage ready...")}static get instance(){return Ft._instance||(Ft._instance=new Ft),Ft._instance}get audios(){let n=[];for(let e in this.hash)n.push(this.hash[e]);return n}destroy(){for(let n in this.hash)this.delete(n)}addAsync(n){var e=this;return(0,Yt.Z)(function*(){let i=yield _s.createAsync(n);return e._add(i)})()}add(n){let e;if("string"==typeof n)e=_s.create(n);else if(n instanceof _s)e=n;else{if(this.update(n))return this.hash[n.identifier];e=_s.create(n)}return this._add(e)}_add(n){return ar.COMPLETE<=n.state&&this.lazySynchronize(100),this.update(n)?this.hash[n.identifier]:(this.hash[n.identifier]=n,console.log("add Audio: "+n.identifier),n)}update(n){let e;e=n instanceof _s?n.toContext():n;let i=this.hash[n.identifier];return!!i&&(i.apply(n),!0)}delete(n){let e=this.hash[n];return!!e&&(e.destroy(),delete this.hash[n],!0)}get(n){return this.hash[n]||null}synchronize(n){this.lazyTimer&&this.lazyTimer.stop(),Fe.call("SYNCHRONIZE_AUDIO_LIST",this.getCatalog(),n)}lazySynchronize(n,e){null==this.lazyTimer&&(this.lazyTimer=new ia(()=>this.synchronize(e),n)),this.lazyTimer.reset(n)}getCatalog(){let n=[];for(let e of Ft.instance.audios)ar.COMPLETE<=e.state&&n.push({identifier:e.identifier,state:e.state});return n}}var Op=(()=>(function(t){t.ACTION="action",t.SEPARATOR="separator"}(Op||(Op={})),Op))();const At={name:"",disabled:!0,type:Op.SEPARATOR};let lr=(()=>{class t{constructor(){this.title="",this.actions=[],this.position={x:0,y:0},this.titleColor=He.CHAT_DEFAULT_COLOR,this.titleBold=!1}get isShow(){return!!this.panelComponentRef}open(e,i,r,s,o,d){let $;this.close(),s||(s=t.defaultParentViewContainerRef,console.log("Context Open")),$=s.createComponent(t.ContextMenuComponentClass,{index:s.length,injector:s.injector});const I=$.injector.get(t);I.panelComponentRef=$,i&&(I.actions=i),e&&(I.position.x=e.x,I.position.y=e.y),I.titleColor=o||He.CHAT_DEFAULT_COLOR,I.titleBold=d,I.title=null!=r?r:"",$.onDestroy(()=>{I.panelComponentRef=null})}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.ContextMenuComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})(),li=(()=>{class t{constructor(e){this.ngZone=e,this.callbackOnPointerDown=i=>this.onPointerDown(i),this.callbackOnPointerMove=i=>this.onPointerMove(i),this.callbackOnPointerUp=i=>this.onPointerUp(i),this.callbackOnContextMenu=i=>this.onContextMenu(i),this._isAllowedToOpenContextMenu=!1,this.pointers=[{x:0,y:0,z:0,identifier:-1}],this.startPostion=this.pointers[0],this.primaryPointer=this.pointers[0],this._isDragging=!1}get isAllowedToOpenContextMenu(){return this._isAllowedToOpenContextMenu}get pointer(){return this.primaryPointer}get pointerX(){return this.primaryPointer.x}get pointerY(){return this.primaryPointer.y}get isDragging(){return this._isDragging}set isDragging(e){e!==this._isDragging&&this.ngZone.run(()=>this._isDragging=e)}initialize(){this.addEventListeners()}destroy(){this.removeEventListeners()}onPointerDown(e){this.onPointerMove(e),this._isAllowedToOpenContextMenu=!0,this.startPostion=this.pointers[0]}onPointerMove(e){e.touches?this.onTouchMove(e):this.onMouseMove(e),this.targetElement=e.target}onPointerUp(e){this.onPointerMove(e)}onMouseMove(e){let i={x:e.pageX,y:e.pageY,z:0,identifier:-9999};this.isSyntheticEvent(i)||(this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(i),this.pointers=[i],this.primaryPointer=i)}onTouchMove(e){let i=e.touches.length;if(!(i<1)){this.pointers=[];for(let r=0;r<i;r++){let s=e.touches[r],o={x:s.pageX,y:s.pageY,z:0,identifier:s.identifier};this._isAllowedToOpenContextMenu&&this.preventContextMenuIfNeeded(o),this.pointers.push(o)}this.primaryPointer=this.pointers[0]}}onContextMenu(e){this._isAllowedToOpenContextMenu=!0,this.onPointerUp(e)}preventContextMenuIfNeeded(e,i=3){i**2<(e.x-this.startPostion.x)**2+(e.y-this.startPostion.y)**2&&(this._isAllowedToOpenContextMenu=!1)}isSyntheticEvent(e,i=15){for(let r of this.pointers)if(r.identifier!==e.identifier&&(e.x-r.x)**2+(e.y-r.y)**2<i**2)return!0;return!1}addEventListeners(){this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.addEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.addEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.addEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.addEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.addEventListener("touchend",this.callbackOnPointerUp,!0),document.body.addEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.addEventListener("drop",this.callbackOnPointerUp,!0),document.body.addEventListener("contextmenu",this.callbackOnContextMenu,!0)})}removeEventListeners(){document.body.removeEventListener("mousedown",this.callbackOnPointerDown,!0),document.body.removeEventListener("mousemove",this.callbackOnPointerMove,!0),document.body.removeEventListener("mouseup",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchstart",this.callbackOnPointerDown,!0),document.body.removeEventListener("touchmove",this.callbackOnPointerMove,!0),document.body.removeEventListener("touchend",this.callbackOnPointerUp,!0),document.body.removeEventListener("touchcancel",this.callbackOnPointerUp,!0),document.body.removeEventListener("drop",this.callbackOnPointerUp,!0),document.body.removeEventListener("contextmenu",this.callbackOnContextMenu,!0)}}return t.\u0275fac=function(e){return new(e||t)(tn(bn))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var Si;!function(t){function e(i,r=0){return i=parseFloat(i),isNaN(i)?r:i}t.relation=function n(i,r,s=0){return"number"==typeof i?i:"string"==typeof i?(i=i.trim().toLowerCase()).indexOf("%")>0?e(i.replace("%",""),s)/100*r:i.indexOf("px")>0||i.indexOf("pt")>0?e(i.replace("px",""),s):i.indexOf("vw")>0?e(i.replace("vw",""),s)/100*window.innerWidth:i.indexOf("vh")>0?e(i.replace("vh",""),s)/100*window.innerHeight:i.indexOf("vm")>0?e(i.replace("vm",""),s)/100*Math.min(window.innerWidth,window.innerHeight):i.indexOf("em")>0?e(i.replace("em",""),s):"top"===i||"left"===i?0:"center"===i||"middle"===i?.5*r:"bottom"===i||"right"===i?r:s:s},t.parse=e}(Si||(Si={}));class so{constructor(n,e={capture:!1,passive:!1,always:!1}){this.target=n,this.callbackOnMouse=this.onMouse.bind(this),this.callbackOnTouch=this.onTouch.bind(this),this.callbackOnMenu=this.onMenu.bind(this),this.lastPointers=[],this.primaryPointer={x:0,y:0,z:0,identifier:-9999},this._isDragging=!1,this._isGrabbing=!1,this._isDestroyed=!1,this.option=null,this.option={capture:!0===e.capture,passive:!0===e.passive,always:!0===e.always},this.initialize()}get pointer(){return this.primaryPointer}get isDragging(){return this._isDragging}get isGrabbing(){return this._isGrabbing}get isDestroyed(){return this._isDestroyed}initialize(){this.target.addEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.addEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.option.always&&this.addEventListeners()}destroy(){this.cancel(),this._isDestroyed=!0,this.target.removeEventListener("mousedown",this.callbackOnMouse,this.option.capture),this.target.removeEventListener("touchstart",this.callbackOnTouch,this.option.capture),this.removeEventListeners()}cancel(){this._isDragging=this._isGrabbing=!1,this.option.always||this.removeEventListeners()}onMouse(n){let e={x:n.pageX,y:n.pageY,z:0,identifier:-9999};this.isSyntheticEvent(e)||(this.lastPointers=[e],this.primaryPointer=e,this.onPointer(n))}onTouch(n){let e=n.changedTouches.length;if(!(e<1)){this.lastPointers=[];for(let i=0;i<e;i++){let r=n.changedTouches[i];this.lastPointers.push({x:r.pageX,y:r.pageY,z:0,identifier:r.identifier})}if("touchstart"===n.type)this.primaryPointer=this.lastPointers[0];else{let r=Array.from(n.changedTouches).find(o=>o.identifier===this.primaryPointer.identifier);if(null==r)return void(null!=Array.from(n.touches).find(d=>d.identifier===this.primaryPointer.identifier)||(this.onEnd&&this.onEnd(n),this.cancel()));this.primaryPointer={x:r.pageX,y:r.pageY,z:0,identifier:r.identifier}}this.onPointer(n)}}onPointer(n){switch(n.type){case"mousedown":case"touchstart":this._isGrabbing=!0,this._isDragging=!1,this.addEventListeners(),this.onStart&&this.onStart(n);break;case"mousemove":case"touchmove":this.onMove&&this.onMove(n),this._isDragging=this._isGrabbing;break;default:this.onEnd&&this.onEnd(n),this.cancel()}}onMenu(n){this.onContextMenu&&this.onContextMenu(n)}isSyntheticEvent(n,e=15){for(let i of this.lastPointers)if(i.identifier!==n.identifier&&(n.x-i.x)**2+(n.y-i.y)**2<e**2)return!0;return!1}addEventListeners(){let n={capture:this.option.capture,passive:this.option.passive};this.target.ownerDocument.addEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.addEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.addEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.addEventListener("drop",this.callbackOnMouse,n)}removeEventListeners(){let n={capture:this.option.capture};this.target.ownerDocument.removeEventListener("mousemove",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("mouseup",this.callbackOnMouse,n),this.target.ownerDocument.removeEventListener("touchmove",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchend",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("touchcancel",this.callbackOnTouch,n),this.target.ownerDocument.removeEventListener("contextmenu",this.callbackOnMenu,n),this.target.ownerDocument.removeEventListener("drop",this.callbackOnMouse,n)}}let O0=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.isDisable=!1,this.boundsSelector="body",this.handleSelector="",this.unhandleSelector="input,textarea,button,select,option,span",this.stackSelector="",this.opacity=.7,this.allowOverHalf=!1,this.onstart=new vn,this.onmove=new vn,this.onend=new vn,this.callbackOnResize=this.adjustPosition.bind(this),this.input=null,this.startPosition={x:0,y:0,z:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={x:0,y:0,z:0}}ngAfterViewInit(){this.initialize(),this.adjustPosition(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement),window.addEventListener("resize",this.callbackOnResize,!1)}),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this)}cancel(){this.input.cancel()}destroy(){window.removeEventListener("resize",this.callbackOnResize,!1),this.input.destroy()}onInputStart(e){if(this.isDisable)return this.cancel();if(1===e.button||2===e.button)return this.cancel();this.setForeground(),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=this.input.pointer,this.prevTrans={x:0,y:0,z:0};let i=this.isHandleElement(e.target),r=this.isUnhandleElement(e.target),s=null!=e.touches&&this.isScrollableElement(e.target);!i||r||s?this.cancel():(this.elementRef.nativeElement.style.cursor="grabbing",e.stopPropagation())}onInputMove(e){let i={x:this.input.pointer.x-this.startPointer.x,y:this.input.pointer.y-this.startPointer.y,z:this.input.pointer.z-this.startPointer.z},s=this.calcCorrectionPosition({x:i.x-this.prevTrans.x,y:i.y-this.prevTrans.y,z:i.z-this.prevTrans.z});i.x+=s.x,i.y+=s.y,i.z+=s.z,0<i.x**2+i.y**2+i.z**2&&(this.elementRef.nativeElement.style.opacity=this.opacity+""),this.elementRef.nativeElement.style.willChange="top, left",this.elementRef.nativeElement.style.left=i.x+this.startPosition.x+"px",this.elementRef.nativeElement.style.top=i.y+this.startPosition.y+"px",this.elementRef.nativeElement.style.cursor="grabbing",this.prevTrans=i,e.cancelable&&e.preventDefault(),e.stopPropagation()}onInputEnd(e){this.elementRef.nativeElement.style.opacity=null,this.elementRef.nativeElement.style.cursor=null,this.elementRef.nativeElement.style.willChange=null,this.input.isDragging&&e.cancelable&&(this.preventClickIfNeeded(e),e.preventDefault()),e.stopPropagation()}onContextMenu(e){e.stopPropagation()}preventClickIfNeeded(e){if(null!=e.touches)return;if(225>(this.input.pointer.x-this.startPointer.x)**2+(this.input.pointer.y-this.startPointer.y)**2+(this.input.pointer.z-this.startPointer.z)**2)return;let d=$=>{$.cancelable&&$.preventDefault(),$.stopPropagation()};this.elementRef.nativeElement.addEventListener("click",d,!0),queueMicrotask(()=>this.elementRef.nativeElement.removeEventListener("click",d,!0))}adjustPosition(){let e=this.calcElementPosition(this.elementRef.nativeElement),i=this.calcCorrectionPosition();this.elementRef.nativeElement.style.left=i.x+e.x+"px",this.elementRef.nativeElement.style.top=i.y+e.y+"px"}isHandleElement(e){return this.handleSelector.length<1||this.isContainsElement(e,this.handleSelector)}isUnhandleElement(e){return!(this.unhandleSelector.length<1)&&this.isContainsElement(e,this.unhandleSelector)}isContainsElement(e,i){let r=this.elementRef.nativeElement.querySelectorAll(i);for(let s=0;s<r.length;s++)if(r[s].contains(e))return!0;return!1}isScrollableElement(e){let i=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector),r=e,s=["scroll","auto"],o=["fixed","sticky","-webkit-sticky"];for(;r&&i!==r&&this.elementRef.nativeElement!==r;){let d=window.getComputedStyle(r);if(0<=s.indexOf(d.overflowY)&&r.offsetHeight<r.scrollHeight)return!0;if(0<=o.indexOf(d.position))return!1;r=r.parentElement}return!1}calcCorrectionPosition(e={x:0,y:0,z:0}){let i={x:0,y:0,z:0},r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();if(this.allowOverHalf){const o=r.right-r.left,d=r.bottom-r.top;s.right+o/2<r.right+e.x&&(i.x+=s.right+o/2-(r.right+e.x)),r.left+e.x<s.left-o/2&&(i.x+=s.left-o/2-(r.left+e.x)),s.bottom+d/2<r.bottom+e.y&&(i.y+=s.bottom+d/2-(r.bottom+e.y)),r.top+e.y<s.top-d/2&&(i.y+=s.top-d/2-(r.top+e.y))}else s.right<r.right+e.x&&(i.x+=s.right-(r.right+e.x)),r.left+e.x<s.left&&(i.x+=s.left-(r.left+e.x)),s.bottom<r.bottom+e.y&&(i.y+=s.bottom-(r.bottom+e.y)),r.top+e.y<s.top&&(i.y+=s.top-(r.top+e.y));return i}calcElementPosition(e){let i=window.getComputedStyle(e);return{x:Si.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),y:Si.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),z:0}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(s=>{let o=parseInt(s.style.zIndex);i<o&&(i=o),o<r&&(r=o)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(s=>{s.style.zIndex=parseInt(s.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(pi))},t.\u0275dir=Gt({type:t,selectors:[["","appDraggable",""]],inputs:{isDisable:["draggable.disable","isDisable"],boundsSelector:["draggable.bounds","boundsSelector"],handleSelector:["draggable.handle","handleSelector"],unhandleSelector:["draggable.unhandle","unhandleSelector"],stackSelector:["draggable.stack","stackSelector"],opacity:["draggable.opacity","opacity"],allowOverHalf:["draggable.allowOverHalf","allowOverHalf"]},outputs:{onstart:"draggable.start",onmove:"draggable.move",onend:"draggable.end"}}),t})();class Ha extends le{constructor(n){super(),this._value=n}get value(){return this.getValue()}_subscribe(n){const e=super._subscribe(n);return!e.closed&&n.next(this._value),e}getValue(){const{hasError:n,thrownError:e,_value:i}=this;if(n)throw e;return this._throwIfClosed(),i}next(n){super.next(this._value=n)}}function Va(...t){return Tr(t,Uo(t))}function q3(t,n,e){return e?q3(t,n).pipe(yd(e)):new f(i=>{const r=(...o)=>i.next(1===o.length?o[0]:o),s=t(r);return a(n)?()=>n(r,s):void 0})}function Ga(...t){const n=Uo(t),e=el(t),{args:i,keys:r}=Cx(t);if(0===i.length)return Tr([],n);const s=new f(W3(i,n,r?o=>xx(r,o):h));return e?s.pipe(yd(e)):s}function W3(t,n,e=h){return i=>{K3(n,()=>{const{length:r}=t,s=new Array(r);let o=r,d=r;for(let $=0;$<r;$++)K3(n,()=>{const I=Tr(t[$],n);let Q=!1;I.subscribe(ie(i,fe=>{s[$]=fe,Q||(Q=!0,d--),d||i.next(e(s.slice()))},()=>{--o||i.complete()}))},i)},i)}}function K3(t,n,e){t?js(e,t,n):n()}function Mo(t){return t<=0?()=>Jl:R((n,e)=>{let i=0;n.subscribe(ie(e,r=>{++i<=t&&(e.next(r),t<=i&&e.complete())}))})}function Bp(...t){return function I9(){return mf(1)}()(Tr(t,Uo(t)))}function Y3(...t){const n=Uo(t);return R((e,i)=>{(n?Bp(t,e,n):Bp(t,e)).subscribe(i)})}function Z3(t,n,e){const i=a(t)||n||e?{next:t,error:n,complete:e}:t;return i?R((r,s)=>{var o;null===(o=i.subscribe)||void 0===o||o.call(i);let d=!0;r.subscribe(ie(s,$=>{var I;null===(I=i.next)||void 0===I||I.call(i,$),s.next($)},()=>{var $;d=!1,null===($=i.complete)||void 0===$||$.call(i),s.complete()},$=>{var I;d=!1,null===(I=i.error)||void 0===I||I.call(i,$),s.error($)},()=>{var $,I;d&&(null===($=i.unsubscribe)||void 0===$||$.call(i)),null===(I=i.finalize)||void 0===I||I.call(i)}))}):h}function B0(t){return R((n,e)=>{ur(t).subscribe(ie(e,()=>e.complete(),V)),!e.closed&&n.subscribe(e)})}class k9 extends f{constructor(n,e){super(),this.source=n,this.subjectFactory=e,this._subject=null,this._refCount=0,this._connection=null,T(n)&&(this.lift=n.lift)}_subscribe(n){return this.getSubject().subscribe(n)}getSubject(){const n=this._subject;return(!n||n.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:n}=this;this._subject=this._connection=null,null==n||n.unsubscribe()}connect(){let n=this._connection;if(!n){n=this._connection=new u;const e=this.getSubject();n.add(this.source.subscribe(ie(e,void 0,()=>{this._teardown(),e.complete()},i=>{this._teardown(),e.error(i)},()=>this._teardown()))),n.closed&&(this._connection=null,n=u.EMPTY)}return n}refCount(){return function S9(){return R((t,n)=>{let e=null;t._refCount++;const i=ie(n,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(e=null);const r=t._connection,s=e;e=null,r&&(!s||r===s)&&r.unsubscribe(),n.unsubscribe()});t.subscribe(i),i.closed||(e=t.connect())})}()(this)}}const D9={connector:()=>new le};function X3(t,n=D9){const{connector:e}=n;return R((i,r)=>{const s=e();ur(t(function M9(t){return new f(n=>t.subscribe(n))}(s))).subscribe(r),r.add(i.subscribe(s))})}function Q3(t){return t?n=>X3(t)(n):n=>function A9(t,n){const e=a(t)?t:()=>t;return a(n)?X3(n,{connector:e}):i=>new k9(i,e)}(new le)(n)}function Yd(t,n){return R((e,i)=>{let r=null,s=0,o=!1;const d=()=>o&&!r&&i.complete();e.subscribe(ie(i,$=>{null==r||r.unsubscribe();let I=0;const Q=s++;ur(t($,Q)).subscribe(r=ie(i,fe=>i.next(n?n($,fe,Q,I++):fe),()=>{r=null,d()}))},()=>{o=!0,d()}))})}function L0(...t){const n=el(t);return R((e,i)=>{const r=t.length,s=new Array(r);let o=t.map(()=>!1),d=!1;for(let $=0;$<r;$++)ur(t[$]).subscribe(ie(i,I=>{s[$]=I,!d&&!o[$]&&(o[$]=!0,(d=o.every(h))&&(o=null))},V));e.subscribe(ie(i,$=>{if(d){const I=[$,...s];i.next(n?n(...I):I)}}))})}function P9(t,n,e,i,r){return(s,o)=>{let d=e,$=n,I=0;s.subscribe(ie(o,Q=>{const fe=I++;$=d?t($,Q,fe):(d=!0,Q),i&&o.next($)},r&&(()=>{d&&o.next($),o.complete()})))}}function R9(t,n){return t===n}const{isArray:O9}=Array;function B9(t){return 1===t.length&&O9(t[0])?t[0]:t}function J3(...t){const n=el(t);return n?c(J3(...t),yd(n)):R((e,i)=>{W3([e,...B9(t)])(i)})}function Fl(t,n){return R((e,i)=>{let r=0;e.subscribe(ie(i,s=>t.call(n,s,r++)&&i.next(s)))})}const z9=["youtubeContainer"];let nT=(()=>{class t{constructor(e,i){this._ngZone=e,this._youtubeContainer=new le,this._destroyed=new le,this._playerChanges=new Ha(void 0),this._videoId=new Ha(void 0),this._height=new Ha(390),this._width=new Ha(640),this._startSeconds=new Ha(void 0),this._endSeconds=new Ha(void 0),this._suggestedQuality=new Ha(void 0),this._playerVars=new Ha(void 0),this.ready=this._getLazyEmitter("onReady"),this.stateChange=this._getLazyEmitter("onStateChange"),this.error=this._getLazyEmitter("onError"),this.apiChange=this._getLazyEmitter("onApiChange"),this.playbackQualityChange=this._getLazyEmitter("onPlaybackQualityChange"),this.playbackRateChange=this._getLazyEmitter("onPlaybackRateChange"),this._isBrowser=l$(i)}get videoId(){return this._videoId.value}set videoId(e){this._videoId.next(e)}get height(){return this._height.value}set height(e){this._height.next(e||390)}get width(){return this._width.value}set width(e){this._width.next(e||640)}set startSeconds(e){this._startSeconds.next(e)}set endSeconds(e){this._endSeconds.next(e)}set suggestedQuality(e){this._suggestedQuality.next(e)}get playerVars(){return this._playerVars.value}set playerVars(e){this._playerVars.next(e)}ngOnInit(){if(!this._isBrowser)return;let e=Va(!0);if(!window.YT||!window.YT.Player){const r=new le;this._existingApiReadyCallback=window.onYouTubeIframeAPIReady,window.onYouTubeIframeAPIReady=()=>{this._existingApiReadyCallback&&this._existingApiReadyCallback(),this._ngZone.run(()=>r.next(!0))},e=r.pipe(Mo(1),Y3(!1))}const i=function V9(t,n,e,i,r,s,o){const d=Ga([n,s]).pipe(L0(Ga([i,r])),ve(([$,I])=>{const[Q,fe]=$,[_e,Ce]=I;return Q?{videoId:Q,playerVars:fe,width:_e,height:Ce}:void 0}));return Ga([t,d,Va(o)]).pipe(function G9(t){return c(J3(t),function L9(t){return R((n,e)=>{let i=!1,r=0;n.subscribe(ie(e,s=>(i||(i=!t(s,r++)))&&e.next(s)))})}(([n,e])=>!e),ve(([n])=>n))}(e),function N9(t,n){return R(P9(t,n,arguments.length>=2,!0))}(q9,void 0),function F9(t,n=h){return t=null!=t?t:R9,R((e,i)=>{let r,s=!0;e.subscribe(ie(i,o=>{const d=n(o);(s||!t(r,d))&&(s=!1,r=d,i.next(o))}))})}())}(this._youtubeContainer,this._videoId,e,this._width,this._height,this._playerVars,this._ngZone).pipe(Z3(r=>{this._playerChanges.next(r)}),function H9(t){return jo(n=>n?iT(n)?Va(n):new f(e=>{let i=!1,r=!1;const s=o=>{r=!0,i||(o.target.removeEventListener("onReady",s),e.next(o.target))};return n.addEventListener("onReady",s),()=>{i=!0,r||t(n)}}).pipe(Mo(1),Y3(void 0)):Va(void 0))}(r=>{iT(r)||r.destroy()}),B0(this._destroyed),Q3());i.subscribe(r=>{this._player=r,r&&this._pendingPlayerState&&this._initializePlayer(r,this._pendingPlayerState),this._pendingPlayerState=void 0}),function j9(t,n,e){Ga([t,n,e]).subscribe(([i,r,s])=>i&&i.setSize(r,s))}(i,this._width,this._height),function U9(t,n){Ga([t,n]).subscribe(([e,i])=>e&&i&&e.setPlaybackQuality(i))}(i,this._suggestedQuality),function W9(t,n,e,i,r,s){const o=Ga([e,i]).pipe(ve(([Q,fe])=>({startSeconds:Q,endSeconds:fe}))),d=o.pipe(z0(t,Q=>!!Q&&!function K9(t){const n=t.getPlayerState();return n!==YT.PlayerState.UNSTARTED&&n!==YT.PlayerState.CUED}(Q))),$=n.pipe(z0(t,(Q,fe)=>!!Q&&Q.videoId!==fe));Ur(t.pipe(z0(Ga([n,o]),([Q,fe],_e)=>!(!_e||Q==_e.videoId&&!fe.startSeconds&&!fe.endSeconds))),$,d).pipe(L0(Ga([t,n,o,r])),ve(([Q,fe])=>fe),B0(s)).subscribe(([Q,fe,_e,Ce])=>{!fe||!Q||(Q.videoId=fe,Q.cueVideoById(Object.assign({videoId:fe,suggestedQuality:Ce},_e)))})}(i,this._videoId,this._startSeconds,this._endSeconds,this._suggestedQuality,this._destroyed),i.connect()}ngAfterViewInit(){this._youtubeContainer.next(this.youtubeContainer.nativeElement)}ngOnDestroy(){this._player&&(this._player.destroy(),window.onYouTubeIframeAPIReady=this._existingApiReadyCallback),this._playerChanges.complete(),this._videoId.complete(),this._height.complete(),this._width.complete(),this._startSeconds.complete(),this._endSeconds.complete(),this._suggestedQuality.complete(),this._youtubeContainer.complete(),this._playerVars.complete(),this._destroyed.next(),this._destroyed.complete()}playVideo(){this._player?this._player.playVideo():this._getPendingState().playbackState=YT.PlayerState.PLAYING}pauseVideo(){this._player?this._player.pauseVideo():this._getPendingState().playbackState=YT.PlayerState.PAUSED}stopVideo(){this._player?this._player.stopVideo():this._getPendingState().playbackState=YT.PlayerState.CUED}seekTo(e,i){this._player?this._player.seekTo(e,i):this._getPendingState().seek={seconds:e,allowSeekAhead:i}}mute(){this._player?this._player.mute():this._getPendingState().muted=!0}unMute(){this._player?this._player.unMute():this._getPendingState().muted=!1}isMuted(){return this._player?this._player.isMuted():!!this._pendingPlayerState&&!!this._pendingPlayerState.muted}setVolume(e){this._player?this._player.setVolume(e):this._getPendingState().volume=e}getVolume(){return this._player?this._player.getVolume():this._pendingPlayerState&&null!=this._pendingPlayerState.volume?this._pendingPlayerState.volume:0}setPlaybackRate(e){if(this._player)return this._player.setPlaybackRate(e);this._getPendingState().playbackRate=e}getPlaybackRate(){return this._player?this._player.getPlaybackRate():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackRate?this._pendingPlayerState.playbackRate:0}getAvailablePlaybackRates(){return this._player?this._player.getAvailablePlaybackRates():[]}getVideoLoadedFraction(){return this._player?this._player.getVideoLoadedFraction():0}getPlayerState(){if(this._isBrowser&&window.YT)return this._player?this._player.getPlayerState():this._pendingPlayerState&&null!=this._pendingPlayerState.playbackState?this._pendingPlayerState.playbackState:YT.PlayerState.UNSTARTED}getCurrentTime(){return this._player?this._player.getCurrentTime():this._pendingPlayerState&&this._pendingPlayerState.seek?this._pendingPlayerState.seek.seconds:0}getPlaybackQuality(){return this._player?this._player.getPlaybackQuality():"default"}getAvailableQualityLevels(){return this._player?this._player.getAvailableQualityLevels():[]}getDuration(){return this._player?this._player.getDuration():0}getVideoUrl(){return this._player?this._player.getVideoUrl():""}getVideoEmbedCode(){return this._player?this._player.getVideoEmbedCode():""}_getPendingState(){return this._pendingPlayerState||(this._pendingPlayerState={}),this._pendingPlayerState}_initializePlayer(e,i){const{playbackState:r,playbackRate:s,volume:o,muted:d,seek:$}=i;switch(r){case YT.PlayerState.PLAYING:e.playVideo();break;case YT.PlayerState.PAUSED:e.pauseVideo();break;case YT.PlayerState.CUED:e.stopVideo()}null!=s&&e.setPlaybackRate(s),null!=o&&e.setVolume(o),null!=d&&(d?e.mute():e.unMute()),null!=$&&e.seekTo($.seconds,$.allowSeekAhead)}_getLazyEmitter(e){return this._playerChanges.pipe(Yd(i=>i?q3(r=>{i.addEventListener(e,r)},r=>{try{i.removeEventListener&&i.removeEventListener(e,r)}catch(s){}}):Va()),i=>new f(r=>i.subscribe({next:s=>this._ngZone.run(()=>r.next(s)),error:s=>r.error(s),complete:()=>r.complete()})),B0(this._destroyed))}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(fd))},t.\u0275cmp=qt({type:t,selectors:[["youtube-player"]],viewQuery:function(e,i){if(1&e&&dn(z9,5),2&e){let r;un(r=fn())&&(i.youtubeContainer=r.first)}},inputs:{videoId:"videoId",height:"height",width:"width",startSeconds:"startSeconds",endSeconds:"endSeconds",suggestedQuality:"suggestedQuality",playerVars:"playerVars",showBeforeIframeApiLoads:"showBeforeIframeApiLoads"},outputs:{ready:"ready",stateChange:"stateChange",error:"error",apiChange:"apiChange",playbackQualityChange:"playbackQualityChange",playbackRateChange:"playbackRateChange"},decls:2,vars:0,consts:[["youtubeContainer",""]],template:function(e,i){1&e&&nt(0,"div",null,0)},encapsulation:2,changeDetection:0}),t})();function q9(t,[n,e,i]){if(t&&e&&t.playerVars!==e.playerVars)t.destroy();else{if(!e)return void(t&&t.destroy());if(t)return t}const r=i.runOutsideAngular(()=>new YT.Player(n,e));return r.videoId=e.videoId,r.playerVars=e.playerVars,r}function iT(t){return"getPlayerStatus"in t}function z0(t,n){return c(L0(t),Fl(([e,i])=>n(i,e)),ve(([e])=>e))}let Y9=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({}),t})(),Yn=(()=>{class t{constructor(e){this._sanitizer=e}transform(e,i="html"){switch(i){case"html":return this._sanitizer.bypassSecurityTrustHtml(e);case"style":return this._sanitizer.bypassSecurityTrustStyle(e);case"script":return this._sanitizer.bypassSecurityTrustScript(e);case"url":return this._sanitizer.bypassSecurityTrustUrl(e);case"resourceUrl":return this._sanitizer.bypassSecurityTrustResourceUrl(e);default:throw new Error(`Invalid safe type specified: ${i}`)}}}return t.\u0275fac=function(e){return new(e||t)(Oe(bx,16))},t.\u0275pipe=fr({name:"safe",type:t,pure:!0}),t})();const Z9=["cutInImageElement"],X9=["videoPlayerComponent"];function Q9(t,n){1&t&&$n(0)}const Zd=function(t,n,e,i,r,s,o){return{video:t,test:n,secret:e,minimaize:i,"is-bordered":r,"is-grab":s,"is-grabbing":o}};function J9(t,n){if(1&t){const e=Ye();X(0,"div",2,3),Ie("@cutInNone.done",function(){ke(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return ke(e),ge().stop()})("mousedown",function(){return ke(e),ge().draggstart()})("mouseup",function(){return ke(e),ge().draggend()})("mouseleave",function(){return ke(e),ge().draggend()})("mouseout",function(){return ke(e),ge().draggend()})("mousemove",function(){ke(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,Q9,1,0,"ng-container",4),te()}if(2&t){const e=ge(),i=Wt(6);Je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInNone",void 0)("ngClass",qc(17,Zd,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),W(2),re("ngTemplateOutlet",i)}}function e7(t,n){1&t&&$n(0)}function t7(t,n){if(1&t){const e=Ye();X(0,"div",2,3),Ie("@cutInFadeInOut.done",function(){ke(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return ke(e),ge().stop()})("mousedown",function(){return ke(e),ge().draggstart()})("mouseup",function(){return ke(e),ge().draggend()})("mouseleave",function(){return ke(e),ge().draggend()})("mouseout",function(){return ke(e),ge().draggend()})("mousemove",function(){ke(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,e7,1,0,"ng-container",4),te()}if(2&t){const e=ge(),i=Wt(6);Je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible&&!e.videoId?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInFadeInOut",void 0)("ngClass",qc(17,Zd,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),W(2),re("ngTemplateOutlet",i)}}function n7(t,n){1&t&&$n(0)}function i7(t,n){if(1&t){const e=Ye();X(0,"div",2,3),Ie("@cutInBounceInOut.done",function(){ke(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return ke(e),ge().stop()})("mousedown",function(){return ke(e),ge().draggstart()})("mouseup",function(){return ke(e),ge().draggend()})("mouseleave",function(){return ke(e),ge().draggend()})("mouseout",function(){return ke(e),ge().draggend()})("mousemove",function(){ke(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,n7,1,0,"ng-container",4),te()}if(2&t){const e=ge(),i=Wt(6);Je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInBounceInOut",void 0)("ngClass",qc(17,Zd,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),W(2),re("ngTemplateOutlet",i)}}function r7(t,n){1&t&&$n(0)}function s7(t,n){if(1&t){const e=Ye();X(0,"div",2,3),Ie("@cutInOpenInOut.done",function(){ke(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return ke(e),ge().stop()})("mousedown",function(){return ke(e),ge().draggstart()})("mouseup",function(){return ke(e),ge().draggend()})("mouseleave",function(){return ke(e),ge().draggend()})("mouseout",function(){return ke(e),ge().draggend()})("mousemove",function(){ke(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,r7,1,0,"ng-container",4),te()}if(2&t){const e=ge(),i=Wt(6);Je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut",void 0)("ngClass",qc(17,Zd,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),W(2),re("ngTemplateOutlet",i)}}function o7(t,n){1&t&&$n(0)}function a7(t,n){if(1&t){const e=Ye();X(0,"div",2,3),Ie("@cutInOpenInOut2.done",function(){ke(e);const r=ge();return r.isVisible?null:r.end()})("dblclick",function(){return ke(e),ge().stop()})("mousedown",function(){return ke(e),ge().draggstart()})("mouseup",function(){return ke(e),ge().draggend()})("mouseleave",function(){return ke(e),ge().draggend()})("mouseout",function(){return ke(e),ge().draggend()})("mousemove",function(){ke(e);const r=ge();return!!r.isPointerDragging&&r.draggstart()}),xe(2,o7,1,0,"ng-container",4),te()}if(2&t){const e=ge(),i=Wt(6);Je("width",e.pixcelWidth-(e.isBordered?6:0),"px")("height",e.pixcelHeight-(e.isBordered?6:0),"px")("left",e.pixcelPosX,"px")("top",e.pixcelPosY,"px")("z-index",e.zIndex)("pointer-events",e.isVisible?"auto":"none"),re("draggable.allowOverHalf",!0)("draggable.unhandle","input,textarea,button,select,option,span,img")("@cutInOpenInOut2",void 0)("ngClass",qc(17,Zd,e.videoId&&!e.isSoundOnly,e.isTest,e.isSecret,e.isMinimize,e.isBordered,!e.isPointerDragging,e.isPointerDragging)),W(2),re("ngTemplateOutlet",i)}}function l7(t,n){1&t&&(X(0,"div",21),be(1,"TEST"),te())}function c7(t,n){1&t&&(X(0,"div",22),be(1,"TEST"),te())}function u7(t,n){1&t&&(X(0,"div",23),be(1,"TEST"),te())}function d7(t,n){1&t&&(X(0,"div",24),be(1,"TEST"),te())}function f7(t,n){1&t&&(X(0,"div",25)(1,"i",26),be(2,"visibility"),te(),be(3," For Your Eyes Only"),te())}function h7(t,n){1&t&&(X(0,"div",27),be(1,"For Your Eyes Only "),X(2,"i",26),be(3,"visibility"),te()())}function p7(t,n){if(1&t&&(X(0,"div",28)(1,"span")(2,"span",29),be(3),te()()()),2&t){const e=ge(2);W(1),Je("color",e.senderColor),W(1),Je("width",e.pixcelWidth-(e.isBordered?6:0),"px"),W(1),Ca("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function g7(t,n){if(1&t&&(X(0,"div",30)(1,"span")(2,"span",29),be(3),te()()()),2&t){const e=ge(2);W(1),Je("color",e.senderColor),W(1),Je("width",e.pixcelWidth-(e.isBordered?6:0),"px"),W(1),Ca("",e.senderName,"",e.isMine?"\uff08\u3042\u306a\u305f\uff09":"","")}}function m7(t,n){if(1&t){const e=Ye();X(0,"div",31),Ie("contextmenu",function(r){return ke(e),ge(2).onContextMenu(r)}),te()}if(2&t){const e=ge(2);Je("width",e.pixcelWidth,"px")("height",e.pixcelHeight,"px")}}const _7=function(t,n,e,i){return{autoplay:1,controls:0,start:t,loop:n,playsinline:1,rel:0,listType:"playlist",list:e,playlist:i,disablekb:1,fs:0,iv_load_policy:3,modestbranding:1}};function $7(t,n){if(1&t){const e=Ye();X(0,"youtube-player",32,33),Ie("ready",function(r){return ke(e),ge(2).onPlayerReady(r)})("stateChange",function(r){return ke(e),ge(2).onPlayerStateChange(r)}),te()}if(2&t){const e=ge(2);Je("visibility",e.videoId&&!e.isSoundOnly?"visible":"hidden"),re("videoId",e.videoId)("width",e.pixcelWidth-(e.isBordered?6:0))("height",e.pixcelHeight-(e.isBordered?6:0))("playerVars",Js(6,_7,e.cutIn.videoStart,e.cutIn&&e.cutIn.isLoop?1:0,e.playListId?e.playListId:null,e.playListId?null:e.videoId))}}function v7(t,n){if(1&t){const e=Ye();X(0,"img",34,35),Ie("error",function(){return ke(e),ge(2).onErrorFallback()}),te()}if(2&t){const e=ge(2);Je("object-fit",e.objectFit),re("src","https://img.youtube.com/vi/"+e.videoId+"/hqdefault.jpg",Xt)}}function b7(t,n){if(1&t){const e=Ye();X(0,"img",36,35),Ie("load",function(){return ke(e),ge(2).onImageLoad()})("contextmenu",function(r){return ke(e),ge(2).onContextMenu(r)}),bt(2,"safe"),te()}if(2&t){const e=ge(2);Je("object-fit",e.objectFit),re("src",yt(2,3,e.cutInImage.url,"resourceUrl"),Xt)}}const Lp=function(t){return{transform:t}};function y7(t,n){if(1&t){const e=Ye();xe(0,l7,2,0,"div",5),xe(1,c7,2,0,"div",6),xe(2,u7,2,0,"div",7),xe(3,d7,2,0,"div",8),xe(4,f7,4,0,"div",9),xe(5,h7,4,0,"div",10),xe(6,p7,4,6,"div",11),xe(7,g7,4,6,"div",12),X(8,"div",13),Ie("contextmenu",function(r){return ke(e),ge().onContextMenu(r)}),te(),X(9,"div",14),Ie("contextmenu",function(r){return ke(e),ge().onContextMenu(r)}),te(),X(10,"div",15),Ie("contextmenu",function(r){return ke(e),ge().onContextMenu(r)}),te(),X(11,"div",16),Ie("contextmenu",function(r){return ke(e),ge().onContextMenu(r)}),te(),xe(12,m7,1,4,"div",17),xe(13,$7,2,11,"youtube-player",18),xe(14,v7,2,3,"img",19),xe(15,b7,3,6,"img",20)}if(2&t){const e=ge();re("ngIf",e.isTest),W(1),re("ngIf",e.isTest),W(1),re("ngIf",e.isTest),W(1),re("ngIf",e.isTest),W(1),re("ngIf",e.isSecret),W(1),re("ngIf",e.isSecret),W(1),re("ngIf",e.isIndicateSender),W(1),re("ngIf",e.isIndicateSender),W(1),Je("width",e.pixcelWidth+3,"px")("height",19,"px"),re("ngStyle",ct(32,Lp,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),W(1),Je("width",e.pixcelWidth+3,"px")("height",19,"px"),re("ngStyle",ct(34,Lp,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),W(1),Je("width",19,"px")("height",e.pixcelHeight+3,"px"),re("ngStyle",ct(36,Lp,"translateX(-"+(e.isBordered?6:3)+"px) translateY(-"+(e.isBordered?6:3)+"px)")),W(1),Je("width",19,"px")("height",e.pixcelHeight+3,"px"),re("ngStyle",ct(38,Lp,"translateX("+(e.isBordered?6:3)+"px) translateY("+(e.isBordered?6:3)+"px)")),W(1),re("ngIf",!e.videoId),W(1),re("ngIf",e.videoId),W(1),re("ngIf",e.videoId&&!e.isSoundOnly),W(1),re("ngIf",!e.videoId||e.isSoundOnly)}}let rT=(()=>{class t{constructor(e,i,r){this.pointerDeviceService=e,this.contextMenuService=i,this.ngZone=r,this.animationType=0,this._imageFile=Lt.Empty,this._isVisible=!1,this._isEnd=!1,this.videoStateTransition=!1,this.isMinimize=!1,this.isBackyard=!1,this.isSecret=!1,this.isTest=!1,this.isIndicateSender=!1,this.sender="",this.videoId="",this.playListId="",this.cutInImageTransformOrigin="center",this._naturalWidth=0,this._naturalHeight=0,this._dragging=!1,this.audioPlayer=new kt}get naturalWidth(){return this.videoId&&!this.isSoundOnly?480:this._naturalWidth}get naturalHeight(){return this.videoId&&!this.isSoundOnly?270:this._naturalHeight}ngOnInit(){Fe.register(this).on("CHANGE_JUKEBOX_VOLUME",-100,e=>{this.videoPlayer&&this.videoPlayer.setVolume(this.videoVolume)}).on("PLAY_VIDEO_CUT_IN",-1e3,e=>{this.cutIn&&this.cutIn.identifier!=e.data.identifier&&this.videoId&&this.stop()})}ngOnDestroy(){Fe.unregister(this,"UPDATE_AUDIO_RESOURE"),Fe.unregister(this,"CHANGE_JUKEBOX_VOLUME"),Fe.unregister(this,"PLAY_VIDEO_CUT_IN"),clearTimeout(this._timeoutId),clearTimeout(this._timeoutIdVideo)}get isPointerDragging(){return this._dragging}draggstart(){this.ngZone.run(()=>{this._dragging=!0})}draggend(){this.ngZone.run(()=>{this._dragging=!1})}get isVisible(){return this.cutIn&&this._isVisible}set isVisible(e){this._isVisible=e}get isEnd(){return!this.cutIn||this._isEnd}get cutInImage(){if(!this.cutIn)return this._imageFile;if(this._imageFile.identifier!==this.cutIn.imageIdentifier){let e=It.instance.get(this.cutIn.imageIdentifier);this._imageFile=e||Lt.Empty}return this._imageFile}get pixcelWidthPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalWidth:this.cutIn.width<=0?document.documentElement.offsetHeight*this.cutIn.height*(this.naturalWidth/this.naturalHeight)/100:document.documentElement.clientWidth*this.cutIn.width/100),e}get pixcelWidth(){let e=this.pixcelWidthPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e=document.documentElement.clientWidth:e*=document.documentElement.offsetHeight/this.pixcelHeightPreAdjust:e>document.documentElement.clientWidth&&(e=document.documentElement.clientWidth)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelWidthAspectMinimun>e?e=this.pixelWidthAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixcelHeightPreAdjust(){if(this.isMinimize)return t.MIN_SIZE;let e=0;return this.cutIn&&(e=this.cutIn.width<=0&&this.cutIn.height<=0?this.naturalHeight:this.cutIn.height<=0?document.documentElement.clientWidth*this.cutIn.width*(this.naturalHeight/this.naturalWidth)/100:document.documentElement.offsetHeight*this.cutIn.height/100),e}get pixelWidthAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth>this.naturalHeight&&(e=t.MIN_SIZE*this.naturalWidth/this.naturalHeight),e}get pixcelHeight(){let e=this.pixcelHeightPreAdjust;return(this.cutIn.isPreventOutBounds||this.videoId)&&(this.isAjustAspect?this.isAjustAspectWidth?e*=document.documentElement.offsetWidth/this.pixcelWidthPreAdjust:e=document.documentElement.offsetHeight:e>document.documentElement.offsetHeight&&(e=document.documentElement.offsetHeight)),!this.isMinimize&&(this.cutIn.width<=0||this.cutIn.height<=0)&&this.pixelHeightAspectMinimun>e?e=this.pixelHeightAspectMinimun:e<t.MIN_SIZE&&(e=t.MIN_SIZE),e}get pixelHeightAspectMinimun(){let e=t.MIN_SIZE;return this.cutIn&&this.naturalWidth<this.naturalHeight&&(e=t.MIN_SIZE*this.naturalHeight/this.naturalWidth),e}get isAjustAspect(){return(this.cutIn.width<=0||this.cutIn.height<=0)&&(this.pixcelWidthPreAdjust>document.documentElement.clientWidth||this.pixcelHeightPreAdjust>document.documentElement.offsetHeight)}get isAjustAspectWidth(){const e=this.pixcelWidthPreAdjust;return e>document.documentElement.clientWidth?!(document.documentElement.offsetHeight<this.pixcelHeightPreAdjust*(document.documentElement.clientWidth/e)):(document,!1)}get pixcelPosX(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelWidth/2-document.documentElement.clientWidth*this.cutIn.posX/100;i>0&&(e+=i);const r=-(document.documentElement.clientWidth-document.documentElement.clientWidth*this.cutIn.posX/100-this.pixcelWidth/2);r>0&&(e-=r)}return e}get pixcelPosY(){let e=0;if(!this.cutIn)return e;if(e=document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2,this.cutIn.isPreventOutBounds||this.videoId){const i=this.pixcelHeight/2-document.documentElement.offsetHeight*this.cutIn.posY/100;i>0&&(e+=i);const r=-(document.documentElement.offsetHeight-document.documentElement.offsetHeight*this.cutIn.posY/100-this.pixcelHeight/2);r>0&&(e-=r)}return e}get zIndex(){return!this.cutIn||this.isBackyard?0:(this.cutIn.isFrontOfStand||this.videoId?15e5:5e5)+this.cutIn.zIndex+(this.videoId?1e3:0)}get objectFit(){return this.cutIn?this.isMinimize||this.videoId&&!this.isSoundOnly||2==this.cutIn.objectFitType?"contain":1==this.cutIn.objectFitType?"cover":"fill":"none"}get videoVolume(){return 100*(this.isTest?kt.auditionVolume:kt.volume)}get isBordered(){return this.cutIn&&this.cutIn.borderStyle>0}get isSoundOnly(){return this.cutIn&&this.cutIn.isSoundOnly}get senderName(){let e="";if(!this.sender)return e;let i=He.findByPeerId(this.sender);return i instanceof He&&(e=i.name),e}get isMine(){return this.sender===He.myCursor.peerId}get senderColor(){let e=He.CHAT_DEFAULT_COLOR;if(!this.sender)return e;let i=He.findByPeerId(this.sender);return i instanceof He&&(e=i.color),e}play(){this.isEnd||(this._isVisible?this.cutIn.videoId||this.audioPlayer.play():(this.ngZone.run(()=>{this._isVisible=!0,this.cutIn.videoId||this._play()}),this.cutIn.duration>0&&(this._timeoutId=setTimeout(()=>{this.stop(),clearTimeout(this._timeoutId),this._timeoutId=null},1e3*this.cutIn.duration))))}_play(){if(this.isEnd)return;const e=Ft.instance.get(this.cutIn.audioIdentifier);e&&e.isReady?(this.audioPlayer.volumeType=this.isTest?Ua.AUDITION:Ua.MASTER,this.audioPlayer.loop=this.cutIn.isLoop,this.cutIn.videoId||this.audioPlayer.play(e)):Fe.register(this).on("UPDATE_AUDIO_RESOURE",-100,i=>{this.cutIn.videoId||this._play()})}pause(){this.cutIn.videoId||this.audioPlayer.pause()}stop(){Fe.unregister(this,"UPDATE_AUDIO_RESOURE"),this.ngZone.run(()=>{this._isVisible=!1,this._dragging=!1,this.audioPlayer.stop()})}end(){this._isEnd=!0,this.audioPlayer.stop()}onImageLoad(){this._naturalWidth=this.cutInImageElement.nativeElement.naturalWidth,this._naturalHeight=this.cutInImageElement.nativeElement.naturalHeight}onPlayerReady(e){e.target.setVolume(this.videoVolume),e.target.playVideo()}onPlayerStateChange(e){const i=e.data;1==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200),this.cutIn&&Fe.trigger("PLAY_VIDEO_CUT_IN",{identifier:this.cutIn.identifier})),2==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200)),5==i&&(this.videoStateTransition=!0,this._timeoutIdVideo=setTimeout(()=>{this.ngZone.run(()=>{this.videoStateTransition=!1,this._timeoutIdVideo=null})},200))}onErrorFallback(){console.log("fallback"),this.videoId&&(this.cutInImageElement.nativeElement.src="https://img.youtube.com/vi/"+this.videoId+"/default.jpg")}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u9589\u3058\u308b\uff08\u81ea\u5206\u306e\u307f\u505c\u6b62\uff09",action:()=>{this.stop()},default:!0,selfOnly:!0},At,{name:(this.isIndicateSender?"\u2611":"\u2610")+"\u9001\u4fe1\u8005\u3092\u8868\u793a",action:()=>{this.isIndicateSender=!this.isIndicateSender},selfOnly:!0},{name:(this.isBackyard?"\u2611":"\u2610")+"\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u5f8c\u306b\u8868\u793a",action:()=>{this.isBackyard=!this.isBackyard},selfOnly:!0},{name:(this.isMinimize?"\u2611":"\u2610")+"\u6700\u5c0f\u5316",action:()=>{this.isMinimize=!this.isMinimize},selfOnly:!0}],this.cutIn.name)}}return t.MIN_SIZE=250,t.\u0275fac=function(e){return new(e||t)(Oe(li),Oe(lr),Oe(bn))},t.\u0275cmp=qt({type:t,selectors:[["cut-in"]],viewQuery:function(e,i){if(1&e&&(dn(Z9,5),dn(X9,5)),2&e){let r;un(r=fn())&&(i.cutInImageElement=r.first),un(r=fn())&&(i.videoPlayer=r.first)}},hostBindings:function(e,i){1&e&&Ie("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{cutIn:"cutIn",animationType:"animationType"},decls:7,vars:5,consts:[["appDraggable","","class","container","style","position: absolute",3,"draggable.allowOverHalf","draggable.unhandle","width","height","left","top","z-index","pointer-events","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove",4,"ngIf"],["image",""],["appDraggable","",1,"container",2,"position","absolute",3,"draggable.allowOverHalf","draggable.unhandle","ngClass","dblclick","mousedown","mouseup","mouseleave","mouseout","mousemove"],["cutInContainerElement",""],[4,"ngTemplateOutlet"],["class","test-indicator grow left-top",4,"ngIf"],["class","test-indicator grow right-top",4,"ngIf"],["class","test-indicator grow left-bottom",4,"ngIf"],["class","test-indicator grow right-bottom",4,"ngIf"],["class","secret-indicator grow left-top",4,"ngIf"],["class","secret-indicator grow right-bottom","style","text-align: right",4,"ngIf"],["class","name-indicator grow right-top","style","text-align: right",4,"ngIf"],["class","name-indicator grow left-bottom",4,"ngIf"],[1,"handler","top",3,"ngStyle","contextmenu"],[1,"handler","bottom",3,"ngStyle","contextmenu"],[1,"handler","left",3,"ngStyle","contextmenu"],[1,"handler","right",3,"ngStyle","contextmenu"],["style","pointer-events: auto","class","handler",3,"width","height","contextmenu",4,"ngIf"],["style","position: absolute; pointer-events: auto","suggestedQuality","default",3,"visibility","videoId","width","height","playerVars","ready","stateChange",4,"ngIf"],["style","pointer-events: auto","draggable","false",3,"object-fit","src","error",4,"ngIf"],["style","pointer-events: none","draggable","false",3,"object-fit","src","load","contextmenu",4,"ngIf"],[1,"test-indicator","grow","left-top"],[1,"test-indicator","grow","right-top"],[1,"test-indicator","grow","left-bottom"],[1,"test-indicator","grow","right-bottom"],[1,"secret-indicator","grow","left-top"],[1,"material-icons",2,"font-size","smaller"],[1,"secret-indicator","grow","right-bottom",2,"text-align","right"],[1,"name-indicator","grow","right-top",2,"text-align","right"],[2,"display","inline-block","white-space","nowrap","overflow","hidden","text-overflow","ellipsis"],[1,"name-indicator","grow","left-bottom"],[1,"handler",2,"pointer-events","auto",3,"contextmenu"],["suggestedQuality","default",2,"position","absolute","pointer-events","auto",3,"videoId","width","height","playerVars","ready","stateChange"],["videoPlayerComponent",""],["draggable","false",2,"pointer-events","auto",3,"src","error"],["cutInImageElement",""],["draggable","false",2,"pointer-events","none",3,"src","load","contextmenu"]],template:function(e,i){1&e&&(xe(0,J9,3,25,"div",0),xe(1,t7,3,25,"div",0),xe(2,i7,3,25,"div",0),xe(3,s7,3,25,"div",0),xe(4,a7,3,25,"div",0),xe(5,y7,16,40,"ng-template",null,1,On)),2&e&&(re("ngIf",i.isVisible&&-1==i.animationType),W(1),re("ngIf",i.isVisible&&0==i.animationType),W(1),re("ngIf",i.isVisible&&1==i.animationType),W(1),re("ngIf",i.isVisible&&2==i.animationType),W(1),re("ngIf",i.isVisible&&3==i.animationType))},directives:[gn,O0,jn,_l,Ji,nT],pipes:[Yn],styles:[".container[_ngcontent-%COMP%]{margin:0;padding:0}.container.video[_ngcontent-%COMP%]{background-color:#000}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}img[_ngcontent-%COMP%]{margin:0;padding:0;width:100%;height:100%}.container[_ngcontent-%COMP%]:hover{outline:3px dotted #22F}.container.minimaize[_ngcontent-%COMP%]{outline:3px solid #22F}.container.is-bordered[_ngcontent-%COMP%]{border:3px ridge #dde}.container.is-bordered[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:1px solid black;box-sizing:border-box}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.test-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:#00f;font-size:smaller;padding:0 3px 1px;font-weight:bolder}.secret-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:5;color:gray;font-size:smaller;padding:0 3px 2px;font-weight:bolder;opacity:.6}.name-indicator[_ngcontent-%COMP%]{position:absolute;pointer-events:none;z-index:10;padding:0 3px 0 6px;font-weight:bolder;font-size:smaller}.left-top[_ngcontent-%COMP%]{left:0px;top:0px}.left-bottom[_ngcontent-%COMP%]{left:0px;bottom:0px}.right-top[_ngcontent-%COMP%]{right:0px;top:0px}.right-bottom[_ngcontent-%COMP%]{right:0px;bottom:0px}.handler[_ngcontent-%COMP%]{position:absolute;z-index:20;pointer-events:auto}.handler.top[_ngcontent-%COMP%]{top:0px;left:0px}.handler.bottom[_ngcontent-%COMP%]{bottom:0px;right:0px}.handler.left[_ngcontent-%COMP%]{top:0px;left:0px}.handler.right[_ngcontent-%COMP%]{right:0px;bottom:0px}"],data:{animation:[yn("cutInNone",[Nt("void => *",[Dt("10ms ease-in",Qt([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),Nt("* => void",[Dt("10ms ease-in",Qt([We({opacity:0,offset:1})]))])]),yn("cutInFadeInOut",[Nt("void => *",[Dt("330ms ease-in",Qt([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),Nt("* => void",[Dt("330ms ease-in",Qt([We({opacity:1,offset:0}),We({opacity:0,offset:1})]))])]),yn("cutInBounceInOut",[Nt("void => *",[Dt("600ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale3d(0, 0, 0)"}))])]),yn("cutInOpenInOut",[Nt("void => *",[Dt("262ms ease",Qt([We({opacity:0,transform:"scale3d(0, 1.0, 1.0)",offset:0}),We({opacity:1,transform:"scale3d(1.1, 1.0, 1.0)",offset:.875}),We({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({opacity:0,transform:"scale3d(0, 1.0, 1.0)"}))])]),yn("cutInOpenInOut2",[Nt("void => *",[Dt("262ms ease",Qt([We({opacity:0,transform:"scale3d(1.0, 0, 1.0)",offset:0}),We({opacity:1,transform:"scale3d(1.0, 1.1, 1.0)",offset:.875}),We({opacity:1,transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({opacity:0,transform:"scale3d(1.0, 0, 1.0)"}))])])]}}),t})(),zp=(()=>{class t{constructor(){}static nowShowingIdentifiers(){return this.cutInComponentRefQueue.filter(e=>e&&e.instance&&e.instance.cutIn&&e.instance.isVisible).map(e=>e.instance.cutIn.identifier)}play(e,i=!1,r=!1,s=null){if(!e)return;for(const d of t.cutInComponentRefQueue)if(d&&d.instance){const $=d.instance;if($.isEnd)d.destroy();else{const I=$.cutIn;(e.identifier===I.identifier||e.videoId&&I.videoId||null!=e.tag&&""!=e.tag.trim()&&null!=I.tag&&""!=I.tag.trim()&&et.toHalfWidth(e.tag).toUpperCase().trim()==et.toHalfWidth(I.tag).toUpperCase().trim())&&$.stop()}}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(d=>d&&d.instance);const o=t.defaultParentViewContainerRef.createComponent(rT);o.instance.cutIn=e,o.instance.animationType=e.animationType,o.instance.videoId=e.videoId,o.instance.playListId=e.playListId,o.instance.isSecret=i,o.instance.isTest=r,o.instance.sender=s,o.instance.play(),t.cutInComponentRefQueue.push(o)}stop(e){if(e){e instanceof ui&&(e=e.identifier);for(const i of t.cutInComponentRefQueue)if(i&&i.instance){const r=i.instance;r.isEnd?i.destroy():e===r.cutIn.identifier&&r.stop()}t.cutInComponentRefQueue=t.cutInComponentRefQueue.filter(i=>i&&i.instance)}}}return t.cutInComponentRefQueue=[],t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),ui=class extends Ln{constructor(){super(...arguments),this.name="",this.tag="",this.duration=6,this.width=0,this.height=0,this.posX=50,this.posY=50,this.zIndex=0,this.objectFitType=0,this.animationType=0,this.borderStyle=0,this.isFrontOfStand=!1,this.isPreventOutBounds=!1,this.imageIdentifier=Lt.Empty.identifier,this.isVideoCutIn=!1,this.videoUrl="",this.isSoundOnly=!1,this.audioFileName="",this.audioIdentifier="",this.isLoop=!1}get videoId(){if(!this.isVideoCutIn||!this.videoUrl)return"";let n="";if(!et.validUrl(this.videoUrl))return"";{const e=new URL(this.videoUrl).hostname;if("youtube.com"==e||"www.youtube.com"==e){let i=this.videoUrl.split("v=");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}else{if("youtu.be"!=e)return"";{let i=this.videoUrl.split("youtu.be/");i[1]&&(n=encodeURI(i[1].split(/[\?\&\#\/]/)[0]))}}}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get videoStart(){if(!this.isVideoCutIn||!this.videoUrl||!this.videoId)return null;const n=/[\&\?](?:start|t)\=([\dhms]+)/i.exec(this.videoUrl);return n&&n[1]?this._sec(n[1]):null}_sec(n){if(!n)return null;let e=null;if(e=/^(\d+)$/.exec(n))return e[1];if(e=/^(?:(\d+)h)?(?:(\d+)m)?(?:(\d+)s)?$/i.exec(n)){let i=0;return e[1]&&(i+=60*+e[1]*60),e[2]&&(i+=60*+e[2]),e[3]&&(i+=+e[3]),""+i}return null}get playListId(){if(!this.isVideoCutIn||!this.videoId)return"";let n="";if(!et.validUrl(this.videoUrl))return"";{let e=this.videoUrl.split("list=");e[1]&&(n=encodeURI(e[1].split(/[\&\#\/]/)[0]))}return n.replace(/[\<\>\/\:\s\r\n]/g,"")}get isValidAudio(){return 0==this.audioFileName.length||0==this.audioIdentifier.length||!!Ft.instance.get(this.audioIdentifier)}get postfixes(){return null==this.value||""==(this.value+"").trim()?[]:Array.from(new Set(this.value.split(/[\r\n]+/g).map(n=>null!=n?n.trimRight():""))).filter(n=>""!=n)}get isPlayingNow(){return zp.nowShowingIdentifiers().includes(this.identifier)}};var Rs;B([st()],ui.prototype,"name",void 0),B([st()],ui.prototype,"tag",void 0),B([st()],ui.prototype,"duration",void 0),B([st()],ui.prototype,"width",void 0),B([st()],ui.prototype,"height",void 0),B([st()],ui.prototype,"posX",void 0),B([st()],ui.prototype,"posY",void 0),B([st()],ui.prototype,"zIndex",void 0),B([st()],ui.prototype,"objectFitType",void 0),B([st()],ui.prototype,"animationType",void 0),B([st()],ui.prototype,"borderStyle",void 0),B([st()],ui.prototype,"isFrontOfStand",void 0),B([st()],ui.prototype,"isPreventOutBounds",void 0),B([st()],ui.prototype,"imageIdentifier",void 0),B([st()],ui.prototype,"isVideoCutIn",void 0),B([st()],ui.prototype,"videoUrl",void 0),B([st()],ui.prototype,"audioFileName",void 0),B([st()],ui.prototype,"audioIdentifier",void 0),B([st()],ui.prototype,"isLoop",void 0),ui=B([Kn("cut-in")],ui);let oo=Rs=class extends Ln{static get instance(){return Rs._instance||(Rs._instance=new Rs("CutInList"),Rs._instance.initialize()),Rs._instance}get cutIns(){return this.children}addCutIn(...n){let e=null;if(n[0]instanceof ui)e=n[0];else{let i=n[0];e=new ui(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Rs.instance.children)i.destroy();let e=Rs.instance.toContext();e.syncData=this.toContext().syncData,Rs.instance.apply(e),Rs.instance.update(),super.parseInnerXml.apply(Rs.instance,[n]),this.destroy()}matchCutInInfo(n){n=et.toHalfWidth(n).toUpperCase().trimRight();let e="",i=new Map;const r=[];for(const d of this.cutIns.map($=>[Math.random(),$]).sort(($,I)=>$[0]-I[0]).map($=>$[1])){if(!d)continue;let $=!1;for(const I of d.postfixes)n.endsWith(et.toHalfWidth(I).toUpperCase().trimRight())&&($=!0,("@"==I.slice(0,1)||"\uff20"==I.slice(0,1))&&e.length<I.length&&(e=I));if($){const I=d.tag;null!=I&&I.trim().length>0?i.set(et.toHalfWidth(I).toUpperCase().trim(),d):r.push(d)}}r.push(...i.values());const o=r.map(d=>[Math.random(),d]).sort((d,$)=>d[0]-$[0]);return{names:o.map(d=>d[1].name),identifiers:o.map(d=>d[1].identifier),matchMostLongText:e}}};var rn;oo=Rs=B([Kn("cut-in-list")],oo);let Pn=rn=class extends La{constructor(n,e=null){super(n),this.chatMessageService=e}onStoreAdded(){var n=this;super.onStoreAdded(),Fe.register(this).on("SEND_MESSAGE",function(){var e=(0,Yt.Z)(function*(i){const r=rt.instance.get(i.data.messageIdentifier);if(!r||!r.isSendFromSelf||r.isSystem||r.isOperationLog)return;const s=et.toHalfWidth(r.text).replace("\u200b","");let o=r.tag.replace("noface","").trim();o=o||"DiceBot";try{const d=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(s),$=d[2],I=$&&0===$.toUpperCase().indexOf("S"),Q=null!=d[3]?Number(d[3]):1;let fe=null!=d[4]?d[4]:s;if(!fe||Q<=0)return;let _e={id:"DiceBot",result:"",isSecret:!1,isDiceRollTable:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1},Ce=!1;for(const Ee of ro.instance.diceRollTables){if(null==Ee.command)continue;let Re=!1,Le=0,Be="",Ae=!1;const je=et.toHalfWidth(Ee.command.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase(),Ue=et.toHalfWidth(fe.replace(/[\u2015\u30fc\u2014\u2010]/g,"-").trim()).toUpperCase();if(!Ue.startsWith("S"+je)||Ue[("S"+je).length]&&!/[ \=\+\-]/.test(Ue.charAt(("S"+je).length))?Ue.startsWith(je)&&(!Ue[je.length]||/[ \=\+\-]/.test(Ue.charAt(je.length)))&&(Ce=!0,Ue[je.length]&&" "!=Ue[je.length]&&(Be=Ue.substring(je.length))):(Ce=!0,Re=!0,Ue[("S"+je).length]&&" "!=Ue[("S"+je).length]&&(Be=Ue.substring(("S"+je).length))),Be)if(Be=Be.split(" ")[0],/^[\+\-]\d+$/.test(Be))Le=+Be,Be=` (\u4fee\u6b63${Be})`;else{if(!/^\=\-?\d+$/.test(Be)){Ce=!1;continue}Ae=!0}if(Ce){_e.isFailure=!1,_e.isDiceRollTable=!0,_e.tableName=Ee.name&&Ee.name.length>0?Ee.name:"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)",_e.isSecret=Re||I;const at=Ee.parseText();for(let lt=0;lt<Q&&lt<32;lt++){let tt=null,Ct=yield rn.diceRollAsync(Ae?`C(${Be.substring(1)})`:et.toHalfWidth(Ee.dice).replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-"),"DiceBot",1);_e.isEmptyDice=_e.isEmptyDice&&Ct.isEmptyDice,Ct.result&&(Ct.result=n.formatRollResult(Ct.result));let ot=null;Ct.result.length>0&&(ot=Ct.result.match(/\s\u2192\s(?:\u6210\u529f\u6570|\u8a08\u7b97\u7d50\u679c)?(\-?\d+)$/))&&(tt=+ot[1]);let ht=!1;if(null!=tt)for(const pt of at)if((null===pt.range.start||pt.range.start<=tt+Le)&&(null===pt.range.end||tt+Le<=pt.range.end)){_e.result+=Ae?"\u6307\u5b9a="+tt+"\n"+et.cr(pt.result):Ct.result+Be+(Be?` \u2192 ${tt+Le}`:"")+"\n"+et.cr(pt.result),ht=!0;break}ht||(_e.result+=null==tt?"\uff08\u30a8\u30e9\u30fc\uff1a\u30c0\u30a4\u30b9\u30ed\u30fc\u30eb\u304b\u3089\u6570\u5b57\u304c\u53d6\u5f97\u3067\u304d\u307e\u305b\u3093\uff09\n(\u7d50\u679c\u306a\u3057)":Ae?"\u6307\u5b9a="+tt+"\n(\u7d50\u679c\u306a\u3057)":Ct.result+Be+(Be?` \u2192 ${tt+Le}`:"")+"\n(\u7d50\u679c\u306a\u3057)"),1<Q&&(_e.result+=` #${lt+1}`),lt<Q-1&&(_e.result+="\n")}break}}if(!Ce){if(!rn.apiUrl&&!(yield rn.loadGameSystemAsync(o)).COMMAND_PATTERN.test(fe))return;let Re,Ee=!1;if((Re=/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.exec(fe.trim()))&&(fe=fe.trim().replace(/[\u3000\s]+/g," "),Ee=!0),Ee||((Re=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec(fe.trim()))||(Re=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec(fe.trim())))&&(ro.instance.diceRollTables.map(Le=>Le.command).some(Le=>null!=Le&&Le.trim().toUpperCase()===Re[1].toUpperCase())||(fe=Re[1],Ee=!0)),Ee||(fe=fe.trim().split(/\s+/)[0].replace(/[\u216e\xd0]/g,"D").replace(/\\xd7/g,"*").replace(/\\xf7/g,"/").replace(/[\u2015\u30fc\u2014\u2010]/g,"-")),rn.apiUrl){if(!Ee&&!/choice\d*\[.*\]/i.test(fe)&&!/^[a-zA-Z0-9!-/:-@\xa5[-`{-~\}]+$/.test(fe))return;_e=yield rn.diceRollAsync(fe,o,Q),_e.isSecret=_e.isSecret||I}else for(let Le=0;Le<Q&&Le<32;Le++){let Be=yield rn.diceRollAsync(fe,o,Q);if(Be.result.length<1)break;_e.id=Be.id,_e.result+=Be.result,_e.isSecret=_e.isSecret||Be.isSecret||I,_e.isEmptyDice=_e.isEmptyDice&&Be.isEmptyDice,_e.isSuccess=_e.isSuccess||Be.isSuccess,_e.isFailure=_e.isFailure&&Be.isFailure,_e.isCritical=_e.isCritical||Be.isCritical,_e.isFumble=_e.isFumble||Be.isFumble,1<Q&&(_e.result+=` #${Le+1}\n`)}}if(!_e.result)return;_e.result=_e.result.trimRight(),n.sendResultMessage(_e,r)}catch(d){console.error(d)}});return function(i){return e.apply(this,arguments)}}())}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this)}sendResultMessage(n,e){let i=n.id.split(":")[0],r=n.result;const s=n.isSecret,o=n.isEmptyDice,d=n.isSuccess,$=n.isFailure,I=n.isCritical,Q=n.isFumble;if(r.length<1)return;n.isDiceRollTable||(r=this.formatRollResult(r));let fe="system";s&&(fe+=" secret"),o&&(fe+=" empty"),d&&(fe+=" success"),$&&(fe+=" failure"),I&&(fe+=" critical"),Q&&(fe+=" fumble");let _e={identifier:"",tabIdentifier:e.tabIdentifier,originFrom:e.from,from:n.isDiceRollTable?"Dice-Roll Table":rn.apiUrl?`BCDice-API(${rn.apiUrl})`:"System-BCDice",timestamp:e.timestamp+1,imageIdentifier:"",tag:fe,name:`${n.isDiceRollTable?n.tableName:i} : ${e.name}${s?" (Secret)":""}`,text:r,color:e.color,isUseStandImage:e.isUseStandImage},Ce="";const Ee=rt.instance.get(e.characterIdentifier);if(Ee instanceof jt){const Be=Ee.standList.matchStandInfo(r,e.imageIdentifier);if(!s&&!e.standName&&e.isUseStandImage)if(Be.farewell){const Ae={characterIdentifier:Ee.identifier};if(e.to){const je=He.findByUserId(e.to);je&&(je.peerId!=He.myCursor.peerId&&Fe.call("FAREWELL_STAND_IMAGE",Ae,je.peerId),Fe.call("FAREWELL_STAND_IMAGE",Ae,He.myCursor.peerId))}else Fe.call("FAREWELL_STAND_IMAGE",Ae)}else if(Be&&Be.standElementIdentifier){const Ae=rt.instance.get(Be.standElementIdentifier);if(Ae&&Ae.getFirstElementByName("conditionType")){const je=+Ae.getFirstElementByName("conditionType").value;if(je==bi.Postfix||je==bi.PostfixOrImage||je==bi.PostfixAndImage){const Ue={characterIdentifier:Ee.identifier,standIdentifier:Be.standElementIdentifier,color:e.color,secret:!!e.to};if(Ue.secret){const at=He.findByUserId(e.to);at&&(at.peerId!=He.myCursor.peerId&&Fe.call("POPUP_STAND_IMAGE",Ue,at.peerId),Fe.call("POPUP_STAND_IMAGE",Ue,He.myCursor.peerId))}else Fe.call("POPUP_STAND_IMAGE",Ue)}}}Ce=Be.matchMostLongText}const Re=rt.instance.get(e.tabIdentifier),Le=oo.instance.matchCutInInfo(r);if(!s&&Re.isUseStandImage&&Le){for(const Be of Le.identifiers){const Ae={identifier:Be,secret:!!e.to,sender:He.myCursor.peerId};if(Ae.secret){const je=He.findByUserId(e.to);je&&(je.peerId!=He.myCursor.peerId&&Fe.call("PLAY_CUT_IN",Ae,je.peerId),Fe.call("PLAY_CUT_IN",Ae,He.myCursor.peerId))}else Fe.call("PLAY_CUT_IN",Ae)}if(Le.names&&Le.names.length&&!e.to&&this.chatMessageService){const Be=new Map;for(const je of Le.names){let Ue=Be.get(je)||0;Ue+=1,Be.set(""==je?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":je,Ue)}const Ae=`${[...Be.keys()].map(je=>Be.get(je)>1?`${je}\xd7${Be.get(je)}`:je).join("\u3001")}`;this.chatMessageService.sendOperationLog(Ae+" \u304c\u8d77\u52d5\u3057\u305f")}}Ce.length<Le.matchMostLongText.length&&(Ce=Le.matchMostLongText),Ce&&_e.text&&(_e.text=_e.text.slice(0,_e.text.length-Ce.length)),null!=e.to&&0<e.to.length&&(_e.to=e.to,e.to.indexOf(e.from)<0&&(_e.to+=" "+e.from)),Re&&Re.addMessage(_e)}static diceRollAsync(n,e,i=1){return(0,Yt.Z)(function*(){if(e=e||"DiceBot",rn.apiUrl){const r=1==rn.apiVersion?rn.apiUrl+"/v1/diceroll?system="+(e?encodeURIComponent(e):"DiceBot")+"&command="+encodeURIComponent(n):`${rn.apiUrl}/v2/game_system/${e?encodeURIComponent(e):"DiceBot"}/roll?command=${encodeURIComponent(n)}`,s=[];for(let o=1;o<=i;o++)s.push(fetch(r,{mode:"cors"}).then(d=>{if(d.ok)return d.json();throw new Error(d.statusText)}).then(d=>({id:e,result:(1==rn.apiVersion?d.result:d.text)+(i>1?` #${o}\n`:""),isSecret:d.secret,isEmptyDice:1==rn.apiVersion?d.dices&&0==d.dices.length:d.rands&&0==d.rands.length,isSuccess:d.success,isFailure:d.failure,isCritical:d.critical,isFumble:d.fumble})).catch(d=>({id:e,result:"",isSecret:!1,isEmptyDice:!0})));return Promise.all(s).then(o=>o.reduce((d,$)=>({id:e,result:d.result+$.result,isSecret:d.isSecret||$.isSecret,isEmptyDice:d.isEmptyDice&&$.isEmptyDice,isSuccess:d.isSuccess||$.isSuccess,isFailure:d.isFailure&&$.isFailure,isCritical:d.isCritical||$.isCritical,isFumble:d.isFumble||$.isFumble}),{id:e,result:"",isSecret:!1,isEmptyDice:!0,isSuccess:!1,isFailure:!0,isCritical:!1,isFumble:!1}))}try{let r=yield rn.loadGameSystemAsync(e);const s=r.eval(n);return s?(console.log("diceRoll!!!",s),console.log("isSecret!!!",s.secret),console.log("isEmptyDice!!!",!s.rands||0==s.rands.length),{id:r.ID,result:s.text,isSecret:s.secret,isEmptyDice:!s.rands||0==s.rands.length,isSuccess:s.success,isFailure:s.failure,isCritical:s.critical,isFumble:s.fumble}):{id:e,result:"",isSecret:!1,isEmptyDice:!0}}catch(r){console.error(r)}return{id:e,result:"",isSecret:!1,isEmptyDice:!0}})()}static getHelpMessage(n){return(0,Yt.Z)(function*(){if(n=n||"DiceBot",rn.apiUrl){const e=[fetch(1==rn.apiVersion?rn.apiUrl+"/v1/systeminfo?system=DiceBot":`${rn.apiUrl}/v2/game_system/DiceBot`,{mode:"cors"}).then(i=>i.json())];return n&&"DiceBot"!=n&&e.push(fetch(1==rn.apiVersion?rn.apiUrl+"/v1/systeminfo?system="+encodeURIComponent(n):`${rn.apiUrl}/v2/game_system/${encodeURIComponent(n)}`,{mode:"cors"}).then(i=>i.json())),Promise.all(e).then(i=>i.map(r=>1==rn.apiVersion&&r.systeminfo&&r.systeminfo.info?r.systeminfo.info.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):r.help_message?r.help_message.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002"))}{let e=[""];try{if(e=[(yield rn.loadGameSystemAsync("DiceBot")).HELP_MESSAGE],n&&""!=n&&"DiceBot"!=n){let i=yield rn.loadGameSystemAsync(n);e.push(i&&"DiceBot"!=i.ID&&i.HELP_MESSAGE?i.HELP_MESSAGE.replace("\u90e8\u5c4b\u306e\u30b7\u30b9\u30c6\u30e0\u540d","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306a\u3069\u306e\u30b7\u30b9\u30c6\u30e0\u540d"):"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u60c5\u5831\u304c\u3042\u308a\u307e\u305b\u3093\u3002")}}catch(i){console.error(i)}return e}})()}static loadGameSystemAsync(n){var e=this;return(0,Yt.Z)(function*(){return yield rn.queue.add(()=>{const i=e.diceBotInfos.some(r=>r.id===n)?n:"DiceBot";try{return rn.loader.getGameSystemClass(i)}catch(r){return rn.loader.dynamicLoad(i)}})})()}static initializeDiceBotQueue(){let n=new V3("DiceBotQueue");return n.add((0,Yt.Z)(function*(){rn.loader=new((yield Promise.resolve().then(Y.bind(Y,383))).default),rn.diceBotInfos=rn.loader.listAvailableGameSystems().filter(e=>"DiceBot"!=e.id).sort((e,i)=>{const r=e.sortKey,s=i.sortKey;return r<s?-1:r>s?1:0}).map(e=>{const i=/.+\:(.+)/.exec(e.id);let r;return i&&i[1]&&(r="ChineseTraditional"==i[1]?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==i[1]?"\ud55c\uad6d\uc5b4":"English"==i[1]?"English":"Other"),{id:e.id,game:e.name,lang:r,sort_key:e.sortKey}})})),n}formatRollResult(n){return null==n?"":n.split("\n").map(e=>{let i=[],r=[],s=[],o=[];return e.split(" \uff1e ").map((d,$,I)=>{if(1===I.length)return d;if(0==$){const fe=rn.apiUrl&&1==rn.apiVersion?/^(?:\: )\((CHOICE(?:\d+)?[\[\( ].+)\)$/i:/^\((CHOICE(?:\d+)?[\[\( ].+)\)$/i,_e=d.match(rn.apiUrl&&1==rn.apiVersion?/^(?:\: )\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i:/^\(([A-Z\d\+\-\*\/=\(\),\[\]\<\>@]+)\)$/i)||d.match(fe);return _e&&!_e[1].toUpperCase().startsWith("CHOICE")&&(i=[...d.matchAll(/(?<diceCount>\d+)D\d+(?:(?<keepDrop>[KD][HL])(?<keepDropCount>\d+))?/gi)],i.length||(r=[...d.matchAll(/\d+B\d+(?:\+\d+B\d+)*(?:\[6\]Limit\[\d+\])?(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+)/gi)],r.length||(s=[...d.matchAll(/\d+R\d+(?:\+\d+R\d+)*\[(?<rerollSign><=|>=|<>|==|!=|<|>|=)?(?<rerollCriteria>\d+)\](?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)],s.length||(o=[...d.matchAll(/\d+U\d+(?:\+\d+U\d+)*\[(?<rerollCriteria>\d+)\](?<modifier>[\-+]\d+)?(?:(?<sign><=|>=|<>|==|!=|<|>|=)(?<criteria>\d+))?/gi)])))),_e?"\u{1f3b2}"+_e[1]:d}if($==I.length-1)return d;if(1==$&&(i.length||r.length||s.length||o.length))try{let Q=d;const _e=[...d.matchAll(i.length?/(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\]/gi:o.length?/(?:(?<total>\d+)\[(?<diceArrayString>\d+(?:,\d+)*)?\])|(?<modifier2>[\-+]\d+)|(?<dieString>\d+)/gi:/(?<diceArrayString>\d+(?:,\d+)*)/gi)];if(_e.length){let Ee,Ce=0;_e.forEach((Re,Le)=>{if(Ee=Re[0],i.length){const{diceCount:Ae,keepDrop:je,keepDropCount:Ue}=i[Le].groups,{total:at,diceArrayString:lt}=Re.groups;if(je){const tt=null!=lt?lt.split(",").sort((ht,pt)=>+ht-+pt):[],Ct=je.startsWith("K")?Ue:Ae-Ue;("KH"===je||"DL"===je)&&tt.reverse();const ot=tt.map((ht,pt)=>pt+1<=Ct?`${ht}`:`~~~${ht}~~~`);("DH"===je||"DL"===je)&&ot.reverse(),Ee=`${at}[${ot.join(",")}]`}}else if(r.length){const{sign:Ae,criteria:je}=r[0].groups,{diceArrayString:Ue}=Re.groups;Ee=Ue.split(",").map(at=>rn.isPass(at,Ae,je)?`${at}`:`~~~${at}~~~`).join(",")}else if(s.length){let{rerollSign:Ae,rerollCriteria:je,sign:Ue,criteria:at}=s[0].groups;Ae||(Ae=Ue),je||(je=at);const{diceArrayString:lt}=Re.groups;Ee=lt.split(",").map(tt=>rn.isPass(tt,Ae,je)?`###${tt}###`:tt).map(tt=>rn.isPass(tt,Ue,at,!1)?tt:`~~~${tt}~~~`).join(",")}else if(o.length){const{rerollCriteria:Ae,modifier:je,sign:Ue,criteria:at}=o[0].groups,{total:lt,diceArrayString:tt,modifier2:Ct,dieString:ot}=Re.groups;if(console.log(o[0],Re),Ct)Ee=` (${Ct})`;else if(lt)Ee=lt+"["+tt.split(",").map(ht=>rn.isPass(ht,">=",Ae)?`###${ht}###`:ht).join(",")+"]",rn.isPass(+lt+(je?+je:0),Ue,at)||(Ee=`~~~${Ee}~~~`);else{let ht=Ee;Ee=rn.isPass(ot,">=",Ae)?`###${ot}###`:ot,rn.isPass(+ht+(je?+je:0),Ue,at)||(Ee=`~~~${Ee}~~~`)}}const Be=Q.indexOf(Re[0],Ce);Ee!=Re[0]&&(Q=Q.substring(0,Be)+Ee+Q.substring(Be+Re[0].length)),Ce=Be+Ee.length})}d=Q}catch(Q){console.error(Q)}return d}).join(" \u2192 ")}).join("\n")}static isPass(n,e,i,r=!0){if(null==n)return r;let s=n.toString().match(/(\d+)/);s&&(n=s[1]);let o=r;switch(e){case"==":case"=":o=+n==+i;break;case"!=":case"<>":o=+n!=+i;break;case">=":o=+n>=+i;break;case"<=":o=+n<=+i;break;case"<":o=+n<+i;break;case">":o=+n>+i}return o}};function sT(t,n){if(Array.prototype.indexOf)return t.indexOf(n);for(var e=0,i=t.length;e<i;e++)if(t[e]===n)return e;return-1}function Rl(t,n){for(var e=t.length-1;e>=0;e--)!0===n(t[e])&&t.splice(e,1)}function oT(t){throw new Error("Unhandled case for value: '".concat(t,"'"))}Pn.queue=rn.initializeDiceBotQueue(),Pn.loader=new x9.default,Pn.apiUrl=null,Pn.apiVersion=1,Pn.adminUrl=null,Pn.diceBotInfos=[],Pn.diceBotInfosIndexed=[],Pn.replaceData=[["\u65b0\u30af\u30c8\u30a5\u30eb\u30d5","\u30b7\u30f3\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","\u30af\u30c8\u30a6\u30eb\u30d5\u30b7\u30f3\u30efTRPG","(\u65e7) \u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG"],["\ud06c\ud234\ub8e8","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310","\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 6\ud310"],["\u514b\u8607\u9b6f\u795e\u8a71","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u516d\u7248"],["\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c7\u7248","\u514b\u8607\u9b6f\u7684\u547c\u559a \u7b2c\u4e03\u7248"],["\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","\u30bf\u30d5\u30eb\u30af\u30ed\u30b9 The 2nd Edition/The 3rd Edtion","\u30c0\u30d6\u30eb\u30af\u30ed\u30b9 The 2nd Edition, The 3rd Edtion"],["\u30c8\u30fc\u30b0","\u30c8\u30aa\u30af","\u30c8\u30fc\u30b0\uff08TORG\uff09"],["\u30ef\u30fc\u30d7\u30b9","\u30ef\u30a2\u30d5\u30b9","WARPS"],["\u30c8\u30fc\u30b01.5\u7248","\u30c8\u30aa\u30af1.5\u30cf\u30f3","\u30c8\u30fc\u30b0\uff08TORG\uff09 1.5\u7248"],["\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","\u30c8\u30aa\u30af\u30a8\u30bf\u30cb\u30c6\u30a4","\u30c8\u30fc\u30b0\uff08TORG\uff09 \u30a8\u30bf\u30cb\u30c6\u30a3"],["\u5fc3\u885d\u60f3\u6a5fTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30adTRPG\u30a2\u30eb\u30c8\u30ec\u30a4\u30b9","\u5fc3\u885d\u60f3\u6a5fTRPG \u30a2\u30eb\u30c8\u30ec\u30a4\u30ba"],["\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","\u30cf\u30e9\u30b5\u30a4\u30c8\u30d5\u30e9\u30c4\u30c8","\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9"],["\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","\u30cf\u30f3\u30b5\u30a4\u30ab\u30c4\u30b1\u30adRPG\u30cf\u30c4\u30c8\u30e9\u30a4\u30d5","\u72af\u7f6a\u6d3b\u5287RPG\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5"],["\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","\u30b3\u30a6\u30c6\u30f3\u30ce\u30a4\u30eb\u30a6\u30b7\u30aa","\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa"],["\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb","\u30cf\u30af\u30eb\u30de\u30ce\u30c8\u30a6\u30ce\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4","\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb"],["\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af\u30aa\u30eb\u30ab\u30ec\u30a4\u30f3","\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3"],["Pathfinder","\u30cf\u30b9\u30d5\u30a2\u30a4\u30f3\u30bf\u30a2RPG","\u30d1\u30b9\u30d5\u30a1\u30a4\u30f3\u30c0\u30fcRPG"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7de8","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG\u3000\u899a\u9192\u7bc7","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4TRPG\u30ab\u30af\u30bb\u30a4\u30d8\u30f3","\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7"],["YearZeroEngine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["Year Zero Engine","\u30a4\u30e4\u30a2\u30bb\u30ed\u30a8\u30f3\u30b7\u30f3","Year Zero Engine"],["ADVANCED FIGHTING FANTASY 2nd Edition","\u30a2\u30c8\u30cf\u30f3\u30b9\u30c8\u30d5\u30a1\u30a4\u30c6\u30a4\u30f3\u30af\u30d5\u30a1\u30f3\u30bf\u30b7\u30a4\u30bf\u30a42\u30cf\u30f3","\u30a2\u30c9\u30d0\u30f3\u30b9\u30c8\u30fb\u30d5\u30a1\u30a4\u30c6\u30a3\u30f3\u30b0\u30fb\u30d5\u30a1\u30f3\u30bf\u30b8\u30fc \u7b2c2\u7248"],["Vampire: The Masquerade 5th Edition","\u30a6\u30a2\u30f3\u30cf\u30a4\u30a2\u30b5\u30de\u30b9\u30ab\u30ec\u30a8\u30c8\u30bf\u30a45\u30cf\u30f3","\u30f4\u30a1\u30f3\u30d1\u30a4\u30a2\uff1a\u30b6\u30fb\u30de\u30b9\u30ab\u30ec\u30fc\u30c9 \u7b2c5\u7248"],["\u30ef\u30fc\u30eb\u30c9\u30aa\u30d6\u30c0\u30fc\u30af\u30cd\u30b9","\u30ef\u30a2\u30eb\u30c8\u30aa\u30d5\u30bf\u30a2\u30af\u30cd\u30b9","\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9"],["\u30e2\u30ce\u30c8\u30fc\u30f3\u30fb\u30df\u30e5\u30fc\u30b8\u30a2\u30e0","\u30e2\u30ce\u30c8\u30aa\u30f3\u30df\u30e6\u30a6\u30b7\u30a2\u30e0","\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0"],["\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1\u30ce\u30a4\u30db\u30a6\u30b7\u30f3TRPG"],["\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","\u30b3\u30ef\u30ec\u30bf\u30bb\u30ab\u30a4\u30ce\u30db\u30b9\u30c8\u30de\u30f3","\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3"],["\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","\u30b7\u30b7\u30de\u30ce\u30ea\u30d5\u30e9\u30c8\u30aa\u30eb","\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb"],["SRS\u6c4e\u7528(\u6539\u9020\u7248)","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0\u30aa\u30eb\u30bf\u30ca\u30c6\u30a4\u30d5\u30cf\u30f3","SRS\u6c4e\u7528 \u30aa\u30eb\u30bf\u30ca\u30c6\u30a3\u30f4"],["Standard RPG System","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30bf\u30a2\u30c8RPG\u30b7\u30b9\u30c6\u30e0","\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0\uff08SRS\uff09"],["NJSLYRBATTLE","\u30cb\u30f3\u30b7\u30e4\u30b9\u30ec\u30a4\u30e4\u30a2\u30cf\u30c8\u30eb"],["Record of Steam","\u30ec\u30b3\u30aa\u30c8\u30aa\u30d5\u30b9\u30c1\u30a4\u30e0"],["\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","\u30a6\u30bf\u30ab\u30bf\u30ce\u30a2\u30eb\u30bb\u30c4\u30c8"],["Shared\u2020Fantasia","\u30b7\u30a8\u30a2\u30a2\u30c8\u30d5\u30a2\u30f3\u30bf\u30b7\u30a2"],["\u771f\u30fb\u5973\u795e\u8ee2\u751f","\u30b7\u30f3\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u5973\u795e\u8ee2\u751f","\u30e1\u30ab\u30df\u30c6\u30f3\u30bb\u30a4"],["\u899a\u9192\u7bc7","\u30ab\u30af\u30bb\u30a4\u30d8\u30f3"],["Chill","\u30c1\u30eb"],["BBNTRPG","\u30d2\u30a4\u30d2\u30a4\u30a8\u30ccTRPG","BBNTRPG (Black Black Network TRPG)"],["TORG Eternity","\u30c8\u30aa\u30af\u30a8\u30bf\u30a2\u30cb\u30c6\u30a4"],["\u30ac\u30fc\u30d7\u30b9","\u30ab\u30a2\u30d5\u30b9","GURPS"],["\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","\u30ab\u30a2\u30d5\u30b9\u30d5\u30a4\u30eb\u30c8\u30a6\u30a4\u30b9","GURPS\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba"],["\u7d76\u5bfe\u96b7\u5974","\u30bb\u30c4\u30bf\u30a4\u30ec\u30a4\u30c8"],["\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","\u30bb\u30a4\u30b7\u30e6\u30f3\u30b7\u30c4\u30ab\u30f3TRPG\u30bb\u30e9\u30d5\u30a4\u30b5\u30a4\u30f3","\u9752\u6625\u75be\u60a3TRPG \u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3"],["\u8266\u3053\u308c","\u30ab\u30f3\u30b3\u30ec"],["\u795e\u6211\u72e9","\u30ab\u30df\u30ab\u30ab\u30ea"],["\u9d7a\u93e1","\u30cc\u30a8\u30ab\u30ab\u30df"],["\u30c8\u30fc\u30ad\u30e7\u30fc","\u30c8\u30aa\u30ad\u30e8\u30a6"],["\uff2e\u25ce\uff36\uff21","\u30ce\u30a6\u30a2"],["\u521d\u97f3\u30df\u30af","\u30cf\u30c4\u30cd\u30df\u30af"],["\u6731\u306e\u5b64\u5854","\u30a2\u30b1\u30ce\u30b3\u30c8\u30a6"],["\u5728\u308a\u3066\u904d\u304f","\u30a2\u30ea\u30c6\u30a2\u30de\u30cd\u30af"],["\u592e\u83ef\u5c01\u795e","\u30aa\u30a6\u30ab\u30db\u30a6\u30b7\u30f3"],["\u5fc3\u885d\u60f3\u6a5f","\u30b7\u30f3\u30b7\u30e8\u30a6\u30bd\u30a6\u30ad"],["\u80ce\u3088\u308a\u60f3\u3048","\u30cf\u30e9\u30e8\u30ea\u30aa\u30e2\u30a8"],["\u5c55\u721b\u4f1a","\u30c6\u30f3\u30e9\u30f3\u30ab\u30a4"],["\u58ca\u308c\u305f","\u30b3\u30ef\u30ec\u30bf"],["\u6bd4\u53e1\u5c71","\u30d2\u30a8\u30a4\u30b5\u30f3"],["\u4e16\u754c\u6a39","\u30bb\u30ab\u30a4\u30b7\u30e6"],["\u7570\u90a6\u4eba","\u30a4\u30db\u30a6\u30b7\u30f3"],["\u8ee2\u653b\u751f","\u30c6\u30f3\u30b3\u30a6\u30bb\u30a4"],["\u63a2\u7a7a\u58eb","\u30b9\u30ab\u30a4\u30ce\u30aa\u30c4"],["\u5263\u306e\u8857","\u30c4\u30eb\u30ad\u30ce\u30de\u30c1"],["\u9ed2\u7d62","\u30b3\u30c4\u30b1\u30f3"],["\u7d2b\u7e1e","\u30b7\u30b7\u30de"],["\u7834\u754c","\u30cf\u30ab\u30a4"],["\u9280\u5263","\u30ad\u30f3\u30b1\u30f3"],["\u6771\u4eac","\u30c8\u30a6\u30ad\u30e8\u30a6"],["\u7247\u9053","\u30ab\u30bf\u30df\u30c1"],["\u52c7\u8005","\u30e6\u30a6\u30b7\u30e4"],["\u5c11\u5973","\u30b7\u30e8\u30a6\u30b7\u30e8"],["\u771f\u7a7a","\u30b7\u30f3\u30af\u30a6"],["\u5b66\u5712","\u30ab\u30af\u30a8\u30f3"],["\u4e16\u754c","\u30bb\u30ab\u30a4"],["\u9752\u6625","\u30bb\u30a4\u30b7\u30e6\u30f3"],["\u75be\u60a3","\u30b7\u30c4\u30ab\u30f3"],["\u8ff7\u5bae","\u30e1\u30a4\u30ad\u30e6\u30a6"],["\u6b6f\u8eca","\u30cf\u30af\u30eb\u30de"],["\u84bc\u5929","\u30bd\u30a6\u30c6\u30f3"],["\u589c\u843d","\u30c4\u30a4\u30e9\u30af"],["\u7279\u547d","\u30c8\u30af\u30e1\u30a4"],["\u6643\u5929","\u30b3\u30a6\u30c6\u30f3"],["\u53db\u9006","\u30cf\u30f3\u30ad\u30e4\u30af"],["\u72af\u7f6a","\u30cf\u30f3\u30b5\u30a4"],["\u6d3b\u5287","\u30ab\u30c4\u30b1\u30ad"],["\u78a7\u7a7a","\u30d8\u30ad\u30af\u30a6"],["\u84ec\u83b1","\u30db\u30a6\u30e9\u30a4"],["\u5192\u967a","\u30db\u30a6\u30b1\u30f3"],["\u516d\u9580","\u30ed\u30af\u30e2\u30f3"],["\u708e\u4e0a","\u30a8\u30f3\u30b7\u30e8\u30a6"],["\u7121\u9650","\u30e0\u30b1\u30f3"],["\u5854","\u30c8\u30a6"],["\u7363","\u30b1\u30e2\u30ce"],["\u7378","\u30b1\u30e2\u30ce"],["\u68ee","\u30e2\u30ea"],["&","\u30a2\u30f3\u30c8"],["\uff06","\u30a2\u30f3\u30c8"],["\u30f4\u30a1","\u30cf"],["\u30f4\u30a3","\u30d2"],["\u30f4\u30a7","\u30d8"],["\u30f4\u30a9","\u30db"],["\u30f4","\u30d5"],["\u30a1","\u30a2"],["\u30a3","\u30a4"],["\u30a5","\u30a6"],["\u30a7","\u30a8"],["\u30a9","\u30aa"],["\u30e3","\u30e4"],["\u30e5","\u30e6"],["\u30e7","\u30e8"],["\u30c3","\u30c4"],["\u30f2","\u30aa"],["\u30ac","\u30ab"],["\u30ae","\u30ad"],["\u30b0","\u30af"],["\u30b2","\u30b1"],["\u30b4","\u30b3"],["\u30b6","\u30b5"],["\u30b8","\u30b7"],["\u30ba","\u30b9"],["\u30bc","\u30bb"],["\u30be","\u30bd"],["\u30c0","\u30bf"],["\u30c2","\u30c1"],["\u30c5","\u30c4"],["\u30c7","\u30c6"],["\u30c9","\u30c8"],["\u30d0","\u30cf"],["\u30d3","\u30d2"],["\u30d6","\u30d5"],["\u30d9","\u30d8"],["\u30dc","\u30db"],["\u30d1","\u30cf"],["\u30d4","\u30d2"],["\u30d7","\u30d5"],["\u30da","\u30d8"],["\u30dd","\u30db"]],Pn=rn=B([Kn("dice-bot")],Pn);var e,j0=function(){function t(n){void 0===n&&(n={}),this.tagName="",this.attrs={},this.innerHTML="",this.whitespaceRegex=/\s+/,this.tagName=n.tagName||"",this.attrs=n.attrs||{},this.innerHTML=n.innerHtml||n.innerHTML||""}return t.prototype.setTagName=function(n){return this.tagName=n,this},t.prototype.getTagName=function(){return this.tagName||""},t.prototype.setAttr=function(n,e){return this.getAttrs()[n]=e,this},t.prototype.getAttr=function(n){return this.getAttrs()[n]},t.prototype.setAttrs=function(n){return Object.assign(this.getAttrs(),n),this},t.prototype.getAttrs=function(){return this.attrs||(this.attrs={})},t.prototype.setClass=function(n){return this.setAttr("class",n)},t.prototype.addClass=function(n){for(var o,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],s=n.split(i);o=s.shift();)-1===sT(r,o)&&r.push(o);return this.getAttrs().class=r.join(" "),this},t.prototype.removeClass=function(n){for(var o,e=this.getClass(),i=this.whitespaceRegex,r=e?e.split(i):[],s=n.split(i);r.length&&(o=s.shift());){var d=sT(r,o);-1!==d&&r.splice(d,1)}return this.getAttrs().class=r.join(" "),this},t.prototype.getClass=function(){return this.getAttrs().class||""},t.prototype.hasClass=function(n){return-1!==(" "+this.getClass()+" ").indexOf(" "+n+" ")},t.prototype.setInnerHTML=function(n){return this.innerHTML=n,this},t.prototype.setInnerHtml=function(n){return this.setInnerHTML(n)},t.prototype.getInnerHTML=function(){return this.innerHTML||""},t.prototype.getInnerHtml=function(){return this.getInnerHTML()},t.prototype.toAnchorString=function(){var n=this.getTagName(),e=this.buildAttrsStr();return["<",n,e=e?" "+e:"",">",this.getInnerHtml(),"</",n,">"].join("")},t.prototype.buildAttrsStr=function(){if(!this.attrs)return"";var n=this.getAttrs(),e=[];for(var i in n)n.hasOwnProperty(i)&&e.push(i+'="'+n[i]+'"');return e.join(" ")},t}(),aT=function(){function t(n){void 0===n&&(n={}),this.newWindow=!1,this.truncate={},this.className="",this.newWindow=n.newWindow||!1,this.truncate=n.truncate||{},this.className=n.className||""}return t.prototype.build=function(n){return new j0({tagName:"a",attrs:this.createAttrs(n),innerHtml:this.processAnchorText(n.getAnchorText())})},t.prototype.createAttrs=function(n){var e={href:n.getAnchorHref()},i=this.createCssClass(n);return i&&(e.class=i),this.newWindow&&(e.target="_blank",e.rel="noopener noreferrer"),this.truncate&&this.truncate.length&&this.truncate.length<n.getAnchorText().length&&(e.title=n.getAnchorHref()),e},t.prototype.createCssClass=function(n){var e=this.className;if(e){for(var i=[e],r=n.getCssClassSuffixes(),s=0,o=r.length;s<o;s++)i.push(e+"-"+r[s]);return i.join(" ")}return""},t.prototype.processAnchorText=function(n){return this.doTruncate(n)},t.prototype.doTruncate=function(n){var e=this.truncate;if(!e||!e.length)return n;var i=e.length,r=e.location;return"smart"===r?function E7(t,n,e){var i,r;null==e?(e="&hellip;",r=3,i=8):(r=e.length,i=e.length);var o=function(Ae){var je="";return Ae.scheme&&Ae.host&&(je+=Ae.scheme+"://"),Ae.host&&(je+=Ae.host),Ae.path&&(je+="/"+Ae.path),Ae.query&&(je+="?"+Ae.query),Ae.fragment&&(je+="#"+Ae.fragment),je},d=function(Ae,je){var Ue=je/2,at=Math.ceil(Ue),lt=-1*Math.floor(Ue),tt="";return lt<0&&(tt=Ae.substr(lt)),Ae.substr(0,at)+e+tt};if(t.length<=n)return t;var je,Ue,at,$=n-r,I=(je={},(at=(Ue=t).match(/^([a-z]+):\/\//i))&&(je.scheme=at[1],Ue=Ue.substr(at[0].length)),(at=Ue.match(/^(.*?)(?=(\?|#|\/|$))/i))&&(je.host=at[1],Ue=Ue.substr(at[0].length)),(at=Ue.match(/^\/(.*?)(?=(\?|#|$))/i))&&(je.path=at[1],Ue=Ue.substr(at[0].length)),(at=Ue.match(/^\?(.*?)(?=(#|$))/i))&&(je.query=at[1],Ue=Ue.substr(at[0].length)),(at=Ue.match(/^#(.*?)$/i))&&(je.fragment=at[1]),je);if(I.query){var Q=I.query.match(/^(.*?)(?=(\?|\#))(.*?)$/i);Q&&(I.query=I.query.substr(0,Q[1].length),t=o(I))}if(t.length<=n||(I.host&&(I.host=I.host.replace(/^www\./,""),t=o(I)),t.length<=n))return t;var fe="";if(I.host&&(fe+=I.host),fe.length>=$)return I.host.length==n?(I.host.substr(0,n-r)+e).substr(0,$+i):d(fe,$).substr(0,$+i);var _e="";if(I.path&&(_e+="/"+I.path),I.query&&(_e+="?"+I.query),_e){if((fe+_e).length>=$)return(fe+_e).length==n?(fe+_e).substr(0,n):(fe+d(_e,$-fe.length)).substr(0,$+i);fe+=_e}if(I.fragment){var Ee="#"+I.fragment;if((fe+Ee).length>=$)return(fe+Ee).length==n?(fe+Ee).substr(0,n):(fe+d(Ee,$-fe.length)).substr(0,$+i);fe+=Ee}if(I.scheme&&I.host){var Le=I.scheme+"://";if((fe+Le).length<$)return(Le+fe).substr(0,n)}if(fe.length<=n)return fe;var Be="";return $>0&&(Be=fe.substr(-1*Math.floor($/2))),(fe.substr(0,Math.ceil($/2))+e+Be).substr(0,$+i)}(n,i):"middle"===r?function T7(t,n,e){if(t.length<=n)return t;var i,r;null==e?(e="&hellip;",i=8,r=3):(i=e.length,r=e.length);var s=n-r,o="";return s>0&&(o=t.substr(-1*Math.floor(s/2))),(t.substr(0,Math.ceil(s/2))+e+o).substr(0,s+i)}(n,i):function I7(t,n,e){return function x7(t,n,e){var i;return t.length>n&&(null==e?(e="&hellip;",i=3):i=e.length,t=t.substring(0,n-i)+e),t}(t,n,e)}(n,i)},t}(),su=function(){function t(n){this.__jsduckDummyDocProp=null,this.matchedText="",this.offset=0,this.tagBuilder=n.tagBuilder,this.matchedText=n.matchedText,this.offset=n.offset}return t.prototype.getMatchedText=function(){return this.matchedText},t.prototype.setOffset=function(n){this.offset=n},t.prototype.getOffset=function(){return this.offset},t.prototype.getCssClassSuffixes=function(){return[this.getType()]},t.prototype.buildTag=function(){return this.tagBuilder.build(this)},t}(),lT=function(t){function n(e){var i=t.call(this,e)||this;return i.email="",i.email=e.email,i}return we(n,t),n.prototype.getType=function(){return"email"},n.prototype.getEmail=function(){return this.email},n.prototype.getAnchorHref=function(){return"mailto:"+this.email},n.prototype.getAnchorText=function(){return this.email},n}(su),cT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="",i.hashtag="",i.serviceName=e.serviceName,i.hashtag=e.hashtag,i}return we(n,t),n.prototype.getType=function(){return"hashtag"},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getHashtag=function(){return this.hashtag},n.prototype.getAnchorHref=function(){var e=this.serviceName,i=this.hashtag;switch(e){case"twitter":return"https://twitter.com/hashtag/"+i;case"facebook":return"https://www.facebook.com/hashtag/"+i;case"instagram":return"https://instagram.com/explore/tags/"+i;case"tiktok":return"https://www.tiktok.com/tag/"+i;default:throw new Error("Unknown service name to point hashtag to: "+e)}},n.prototype.getAnchorText=function(){return"#"+this.hashtag},n}(su),uT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.mention="",i.mention=e.mention,i.serviceName=e.serviceName,i}return we(n,t),n.prototype.getType=function(){return"mention"},n.prototype.getMention=function(){return this.mention},n.prototype.getServiceName=function(){return this.serviceName},n.prototype.getAnchorHref=function(){switch(this.serviceName){case"twitter":return"https://twitter.com/"+this.mention;case"instagram":return"https://instagram.com/"+this.mention;case"soundcloud":return"https://soundcloud.com/"+this.mention;case"tiktok":return"https://www.tiktok.com/@"+this.mention;default:throw new Error("Unknown service name to point mention to: "+this.serviceName)}},n.prototype.getAnchorText=function(){return"@"+this.mention},n.prototype.getCssClassSuffixes=function(){var e=t.prototype.getCssClassSuffixes.call(this),i=this.getServiceName();return i&&e.push(i),e},n}(su),dT=function(t){function n(e){var i=t.call(this,e)||this;return i.number="",i.plusSign=!1,i.number=e.number,i.plusSign=e.plusSign,i}return we(n,t),n.prototype.getType=function(){return"phone"},n.prototype.getPhoneNumber=function(){return this.number},n.prototype.getNumber=function(){return this.getPhoneNumber()},n.prototype.getAnchorHref=function(){return"tel:"+(this.plusSign?"+":"")+this.number},n.prototype.getAnchorText=function(){return this.matchedText},n}(su),fT=function(t){function n(e){var i=t.call(this,e)||this;return i.url="",i.urlMatchType="scheme",i.protocolUrlMatch=!1,i.protocolRelativeMatch=!1,i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.schemePrefixRegex=/^(https?:\/\/)?/i,i.wwwPrefixRegex=/^(https?:\/\/)?(www\.)?/i,i.protocolRelativeRegex=/^\/\//,i.protocolPrepended=!1,i.urlMatchType=e.urlMatchType,i.url=e.url,i.protocolUrlMatch=e.protocolUrlMatch,i.protocolRelativeMatch=e.protocolRelativeMatch,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return we(n,t),n.prototype.getType=function(){return"url"},n.prototype.getUrlMatchType=function(){return this.urlMatchType},n.prototype.getUrl=function(){var e=this.url;return!this.protocolRelativeMatch&&!this.protocolUrlMatch&&!this.protocolPrepended&&(e=this.url="http://"+e,this.protocolPrepended=!0),e},n.prototype.getAnchorHref=function(){return this.getUrl().replace(/&amp;/g,"&")},n.prototype.getAnchorText=function(){var e=this.getMatchedText();return this.protocolRelativeMatch&&(e=this.stripProtocolRelativePrefix(e)),this.stripPrefix.scheme&&(e=this.stripSchemePrefix(e)),this.stripPrefix.www&&(e=this.stripWwwPrefix(e)),this.stripTrailingSlash&&(e=this.removeTrailingSlash(e)),this.decodePercentEncoding&&(e=this.removePercentEncoding(e)),e},n.prototype.stripSchemePrefix=function(e){return e.replace(this.schemePrefixRegex,"")},n.prototype.stripWwwPrefix=function(e){return e.replace(this.wwwPrefixRegex,"$1")},n.prototype.stripProtocolRelativePrefix=function(e){return e.replace(this.protocolRelativeRegex,"")},n.prototype.removeTrailingSlash=function(e){return"/"===e.charAt(e.length-1)&&(e=e.slice(0,-1)),e},n.prototype.removePercentEncoding=function(e){var i=e.replace(/%22/gi,"&quot;").replace(/%26/gi,"&amp;").replace(/%27/gi,"&#39;").replace(/%3C/gi,"&lt;").replace(/%3E/gi,"&gt;");try{return decodeURIComponent(i)}catch(r){return i}},n}(su),ou=function t(n){this.__jsduckDummyDocProp=null,this.tagBuilder=n.tagBuilder},U0=/[A-Za-z]/,S7=/[\d]/,k7=/[\D]/,Ol=/\s/,H0=/['"]/,M7=/[\x00-\x1F\x7F]/,hT=/A-Za-z\xAA\xB5\xBA\xC0-\xD6\xD8-\xF6\xF8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u037F\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u052F\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0-\u08B4\u08B6-\u08BD\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0980\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0AF9\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C39\u0C3D\u0C58-\u0C5A\u0C60\u0C61\u0C80\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D54-\u0D56\u0D5F-\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F5\u13F8-\u13FD\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u16F1-\u16F8\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u1884\u1887-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191E\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19B0-\u19C9\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1C80-\u1C88\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FD5\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA69D\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA7AE\uA7B0-\uA7B7\uA7F7-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA8FD\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uA9E0-\uA9E4\uA9E6-\uA9EF\uA9FA-\uA9FE\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA7E-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uAB30-\uAB5A\uAB5C-\uAB65\uAB70-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC/.source,pT=hT+/\u2700-\u27bf\udde6-\uddff\ud800-\udbff\udc00-\udfff\ufe0e\ufe0f\u0300-\u036f\ufe20-\ufe23\u20d0-\u20f0\ud83c\udffb-\udfff\u200d\u3299\u3297\u303d\u3030\u24c2\ud83c\udd70-\udd71\udd7e-\udd7f\udd8e\udd91-\udd9a\udde6-\uddff\ude01-\ude02\ude1a\ude2f\ude32-\ude3a\ude50-\ude51\u203c\u2049\u25aa-\u25ab\u25b6\u25c0\u25fb-\u25fe\u00a9\u00ae\u2122\u2139\udc04\u2600-\u26FF\u2b05\u2b06\u2b07\u2b1b\u2b1c\u2b50\u2b55\u231a\u231b\u2328\u23cf\u23e9-\u23f3\u23f8-\u23fa\udccf\u2935\u2934\u2190-\u21ff/.source+/\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D4-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C03\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D01-\u0D03\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF8\u1CF9\u1DC0-\u1DF5\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F/.source,jp=/0-9\u0660-\u0669\u06F0-\u06F9\u07C0-\u07C9\u0966-\u096F\u09E6-\u09EF\u0A66-\u0A6F\u0AE6-\u0AEF\u0B66-\u0B6F\u0BE6-\u0BEF\u0C66-\u0C6F\u0CE6-\u0CEF\u0D66-\u0D6F\u0DE6-\u0DEF\u0E50-\u0E59\u0ED0-\u0ED9\u0F20-\u0F29\u1040-\u1049\u1090-\u1099\u17E0-\u17E9\u1810-\u1819\u1946-\u194F\u19D0-\u19D9\u1A80-\u1A89\u1A90-\u1A99\u1B50-\u1B59\u1BB0-\u1BB9\u1C40-\u1C49\u1C50-\u1C59\uA620-\uA629\uA8D0-\uA8D9\uA900-\uA909\uA9D0-\uA9D9\uA9F0-\uA9F9\uAA50-\uAA59\uABF0-\uABF9\uFF10-\uFF19/.source,P7=pT+jp,ci=pT+jp,N7="(?:["+jp+"]{1,3}\\.){3}["+jp+"]{1,3}",F7="["+ci+"](?:["+ci+"\\-]{0,61}["+ci+"])?",gT=function(t){return"(?=("+F7+"))\\"+t},V0=function(t){return"(?:"+gT(t)+"(?:\\."+gT(t+1)+"){0,126}|"+N7+")"},Up=(new RegExp("["+ci+".\\-]*["+ci+"\\-]"),new RegExp("[".concat(ci,"]"))),mT=/(?:xn--vermgensberatung-pwb|xn--vermgensberater-ctb|xn--clchc0ea0b2g2a9gcd|xn--w4r85el8fhu5dnra|northwesternmutual|travelersinsurance|verm\xf6gensberatung|xn--3oq18vl8pn36a|xn--5su34j936bgsg|xn--bck1b9a5dre4c|xn--mgbah1a3hjkrd|xn--mgbai9azgqp6j|xn--mgberp4a5d4ar|xn--xkc2dl3a5ee0h|verm\xf6gensberater|xn--fzys8d69uvgm|xn--mgba7c0bbn0a|xn--mgbcpq6gpa1a|xn--xkc2al3hye2a|americanexpress|kerryproperties|sandvikcoromant|xn--i1b6b1a6a2e|xn--kcrx77d1x4a|xn--lgbbat1ad8j|xn--mgba3a4f16a|xn--mgbaakc7dvf|xn--mgbc0a9azcg|xn--nqv7fs00ema|afamilycompany|americanfamily|bananarepublic|cancerresearch|cookingchannel|kerrylogistics|weatherchannel|xn--54b7fta0cc|xn--6qq986b3xl|xn--80aqecdr1a|xn--b4w605ferd|xn--fiq228c5hs|xn--h2breg3eve|xn--jlq480n2rg|xn--jlq61u9w7b|xn--mgba3a3ejt|xn--mgbaam7a8h|xn--mgbayh7gpa|xn--mgbbh1a71e|xn--mgbca7dzdo|xn--mgbi4ecexp|xn--mgbx4cd0ab|xn--rvc1e0am3e|international|lifeinsurance|travelchannel|wolterskluwer|xn--cckwcxetd|xn--eckvdtc9d|xn--fpcrj9c3d|xn--fzc2c9e2c|xn--h2brj9c8c|xn--tiq49xqyj|xn--yfro4i67o|xn--ygbi2ammx|construction|lplfinancial|scholarships|versicherung|xn--3e0b707e|xn--45br5cyl|xn--4dbrk0ce|xn--80adxhks|xn--80asehdb|xn--8y0a063a|xn--gckr3f0f|xn--mgb9awbf|xn--mgbab2bd|xn--mgbgu82a|xn--mgbpl2fh|xn--mgbt3dhd|xn--mk1bu44c|xn--ngbc5azd|xn--ngbe9e0a|xn--ogbpf8fl|xn--qcka1pmc|accountants|barclaycard|blackfriday|blockbuster|bridgestone|calvinklein|contractors|creditunion|engineering|enterprises|foodnetwork|investments|kerryhotels|lamborghini|motorcycles|olayangroup|photography|playstation|productions|progressive|redumbrella|williamhill|xn--11b4c3d|xn--1ck2e1b|xn--1qqw23a|xn--2scrj9c|xn--3bst00m|xn--3ds443g|xn--3hcrj9c|xn--42c2d9a|xn--45brj9c|xn--55qw42g|xn--6frz82g|xn--80ao21a|xn--9krt00a|xn--cck2b3b|xn--czr694b|xn--d1acj3b|xn--efvy88h|xn--fct429k|xn--fjq720a|xn--flw351e|xn--g2xx48c|xn--gecrj9c|xn--gk3at1e|xn--h2brj9c|xn--hxt814e|xn--imr513n|xn--j6w193g|xn--jvr189m|xn--kprw13d|xn--kpry57d|xn--mgbbh1a|xn--mgbtx2b|xn--mix891f|xn--nyqy26a|xn--otu796d|xn--pgbs0dh|xn--q9jyb4c|xn--rhqv96g|xn--rovu88b|xn--s9brj9c|xn--ses554g|xn--t60b56a|xn--vuq861b|xn--w4rs40l|xn--xhq521b|xn--zfr164b|\u0b9a\u0bbf\u0b99\u0bcd\u0b95\u0baa\u0bcd\u0baa\u0bc2\u0bb0\u0bcd|accountant|apartments|associates|basketball|bnpparibas|boehringer|capitalone|consulting|creditcard|cuisinella|eurovision|extraspace|foundation|healthcare|immobilien|industries|management|mitsubishi|nextdirect|properties|protection|prudential|realestate|republican|restaurant|schaeffler|swiftcover|tatamotors|technology|university|vlaanderen|volkswagen|xn--30rr7y|xn--3pxu8k|xn--45q11c|xn--4gbrim|xn--55qx5d|xn--5tzm5g|xn--80aswg|xn--90a3ac|xn--9dbq2a|xn--9et52u|xn--c2br7g|xn--cg4bki|xn--czrs0t|xn--czru2d|xn--fiq64b|xn--fiqs8s|xn--fiqz9s|xn--io0a7i|xn--kput3i|xn--mxtq1m|xn--o3cw4h|xn--pssy2u|xn--q7ce6a|xn--unup4y|xn--wgbh1c|xn--wgbl6a|xn--y9a3aq|accenture|alfaromeo|allfinanz|amsterdam|analytics|aquarelle|barcelona|bloomberg|christmas|community|directory|education|equipment|fairwinds|financial|firestone|fresenius|frontdoor|furniture|goldpoint|hisamitsu|homedepot|homegoods|homesense|institute|insurance|kuokgroup|lancaster|landrover|lifestyle|marketing|marshalls|melbourne|microsoft|panasonic|passagens|pramerica|richardli|scjohnson|shangrila|solutions|statebank|statefarm|stockholm|travelers|vacations|xn--90ais|xn--c1avg|xn--d1alf|xn--e1a4c|xn--fhbei|xn--j1aef|xn--j1amh|xn--l1acc|xn--ngbrx|xn--nqv7f|xn--p1acf|xn--qxa6a|xn--tckwe|xn--vhquv|yodobashi|\u0645\u0648\u0631\u064a\u062a\u0627\u0646\u064a\u0627|abudhabi|airforce|allstate|attorney|barclays|barefoot|bargains|baseball|boutique|bradesco|broadway|brussels|budapest|builders|business|capetown|catering|catholic|cipriani|cityeats|cleaning|clinique|clothing|commbank|computer|delivery|deloitte|democrat|diamonds|discount|discover|download|engineer|ericsson|etisalat|exchange|feedback|fidelity|firmdale|football|frontier|goodyear|grainger|graphics|guardian|hdfcbank|helsinki|holdings|hospital|infiniti|ipiranga|istanbul|jpmorgan|lighting|lundbeck|marriott|maserati|mckinsey|memorial|merckmsd|mortgage|observer|partners|pharmacy|pictures|plumbing|property|redstone|reliance|saarland|samsclub|security|services|shopping|showtime|softbank|software|stcgroup|supplies|training|vanguard|ventures|verisign|woodside|xn--90ae|xn--node|xn--p1ai|xn--qxam|yokohama|\u0627\u0644\u0633\u0639\u0648\u062f\u064a\u0629|abogado|academy|agakhan|alibaba|android|athleta|auction|audible|auspost|avianca|banamex|bauhaus|bentley|bestbuy|booking|brother|bugatti|capital|caravan|careers|channel|charity|chintai|citadel|clubmed|college|cologne|comcast|company|compare|contact|cooking|corsica|country|coupons|courses|cricket|cruises|dentist|digital|domains|exposed|express|farmers|fashion|ferrari|ferrero|finance|fishing|fitness|flights|florist|flowers|forsale|frogans|fujitsu|gallery|genting|godaddy|grocery|guitars|hamburg|hangout|hitachi|holiday|hosting|hoteles|hotmail|hyundai|ismaili|jewelry|juniper|kitchen|komatsu|lacaixa|lanxess|lasalle|latrobe|leclerc|limited|lincoln|markets|monster|netbank|netflix|network|neustar|okinawa|oldnavy|organic|origins|philips|pioneer|politie|realtor|recipes|rentals|reviews|rexroth|samsung|sandvik|schmidt|schwarz|science|shiksha|singles|staples|storage|support|surgery|systems|temasek|theater|theatre|tickets|tiffany|toshiba|trading|walmart|wanggou|watches|weather|website|wedding|whoswho|windows|winners|xfinity|yamaxun|youtube|zuerich|\u043a\u0430\u0442\u043e\u043b\u0438\u043a|\u0627\u062a\u0635\u0627\u0644\u0627\u062a|\u0627\u0644\u0628\u062d\u0631\u064a\u0646|\u0627\u0644\u062c\u0632\u0627\u0626\u0631|\u0627\u0644\u0639\u0644\u064a\u0627\u0646|\u067e\u0627\u06a9\u0633\u062a\u0627\u0646|\u0643\u0627\u062b\u0648\u0644\u064a\u0643|\u0b87\u0ba8\u0bcd\u0ba4\u0bbf\u0baf\u0bbe|abarth|abbott|abbvie|africa|agency|airbus|airtel|alipay|alsace|alstom|amazon|anquan|aramco|author|bayern|beauty|berlin|bharti|bostik|boston|broker|camera|career|casino|center|chanel|chrome|church|circle|claims|clinic|coffee|comsec|condos|coupon|credit|cruise|dating|datsun|dealer|degree|dental|design|direct|doctor|dunlop|dupont|durban|emerck|energy|estate|events|expert|family|flickr|futbol|gallup|garden|george|giving|global|google|gratis|health|hermes|hiphop|hockey|hotels|hughes|imamat|insure|intuit|jaguar|joburg|juegos|kaufen|kinder|kindle|kosher|lancia|latino|lawyer|lefrak|living|locker|london|luxury|madrid|maison|makeup|market|mattel|mobile|monash|mormon|moscow|museum|mutual|nagoya|natura|nissan|nissay|norton|nowruz|office|olayan|online|oracle|orange|otsuka|pfizer|photos|physio|pictet|quebec|racing|realty|reisen|repair|report|review|rocher|rogers|ryukyu|safety|sakura|sanofi|school|schule|search|secure|select|shouji|soccer|social|stream|studio|supply|suzuki|swatch|sydney|taipei|taobao|target|tattoo|tennis|tienda|tjmaxx|tkmaxx|toyota|travel|unicom|viajes|viking|villas|virgin|vision|voting|voyage|vuelos|walter|webcam|xihuan|yachts|yandex|zappos|\u043c\u043e\u0441\u043a\u0432\u0430|\u043e\u043d\u043b\u0430\u0439\u043d|\u0627\u0628\u0648\u0638\u0628\u064a|\u0627\u0631\u0627\u0645\u0643\u0648|\u0627\u0644\u0627\u0631\u062f\u0646|\u0627\u0644\u0645\u063a\u0631\u0628|\u0627\u0645\u0627\u0631\u0627\u062a|\u0641\u0644\u0633\u0637\u064a\u0646|\u0645\u0644\u064a\u0633\u064a\u0627|\u092d\u093e\u0930\u0924\u092e\u094d|\u0b87\u0bb2\u0b99\u0bcd\u0b95\u0bc8|\u30d5\u30a1\u30c3\u30b7\u30e7\u30f3|actor|adult|aetna|amfam|amica|apple|archi|audio|autos|azure|baidu|beats|bible|bingo|black|boats|bosch|build|canon|cards|chase|cheap|cisco|citic|click|cloud|coach|codes|crown|cymru|dabur|dance|deals|delta|drive|dubai|earth|edeka|email|epson|faith|fedex|final|forex|forum|gallo|games|gifts|gives|glade|glass|globo|gmail|green|gripe|group|gucci|guide|homes|honda|horse|house|hyatt|ikano|irish|jetzt|koeln|kyoto|lamer|lease|legal|lexus|lilly|linde|lipsy|lixil|loans|locus|lotte|lotto|macys|mango|media|miami|money|movie|nexus|nikon|ninja|nokia|nowtv|omega|osaka|paris|parts|party|phone|photo|pizza|place|poker|praxi|press|prime|promo|quest|radio|rehab|reise|ricoh|rocks|rodeo|rugby|salon|sener|seven|sharp|shell|shoes|skype|sling|smart|smile|solar|space|sport|stada|store|study|style|sucks|swiss|tatar|tires|tirol|tmall|today|tokyo|tools|toray|total|tours|trade|trust|tunes|tushu|ubank|vegas|video|vodka|volvo|wales|watch|weber|weibo|works|world|xerox|yahoo|\u05d9\u05e9\u05e8\u05d0\u05dc|\u0627\u06cc\u0631\u0627\u0646|\u0628\u0627\u0632\u0627\u0631|\u0628\u06be\u0627\u0631\u062a|\u0633\u0648\u062f\u0627\u0646|\u0633\u0648\u0631\u064a\u0629|\u0647\u0645\u0631\u0627\u0647|\u092d\u093e\u0930\u094b\u0924|\u0938\u0902\u0917\u0920\u0928|\u09ac\u09be\u0982\u09b2\u09be|\u0c2d\u0c3e\u0c30\u0c24\u0c4d|\u0d2d\u0d3e\u0d30\u0d24\u0d02|\u5609\u91cc\u5927\u9152\u5e97|aarp|able|adac|aero|akdn|ally|amex|arab|army|arpa|arte|asda|asia|audi|auto|baby|band|bank|bbva|beer|best|bike|bing|blog|blue|bofa|bond|book|buzz|cafe|call|camp|care|cars|casa|case|cash|cbre|cern|chat|citi|city|club|cool|coop|cyou|data|date|dclk|deal|dell|desi|diet|dish|docs|duck|dvag|erni|fage|fail|fans|farm|fast|fiat|fido|film|fire|fish|flir|food|ford|free|fund|game|gbiz|gent|ggee|gift|gmbh|gold|golf|goog|guge|guru|hair|haus|hdfc|help|here|hgtv|host|hsbc|icbc|ieee|imdb|immo|info|itau|java|jeep|jobs|jprs|kddi|kiwi|kpmg|kred|land|lego|lgbt|lidl|life|like|limo|link|live|loan|loft|love|ltda|luxe|maif|meet|meme|menu|mini|mint|mobi|moda|moto|name|navy|news|next|nico|nike|ollo|open|page|pars|pccw|pics|ping|pink|play|plus|pohl|porn|post|prod|prof|qpon|raid|read|reit|rent|rest|rich|rmit|room|rsvp|ruhr|safe|sale|sarl|save|saxo|scot|seat|seek|sexy|shaw|shia|shop|show|silk|sina|site|skin|sncf|sohu|song|sony|spot|star|surf|talk|taxi|team|tech|teva|tiaa|tips|town|toys|tube|vana|visa|viva|vivo|vote|voto|wang|weir|wien|wiki|wine|work|xbox|yoga|zara|zero|zone|\u0434\u0435\u0442\u0438|\u0441\u0430\u0439\u0442|\u0628\u0627\u0631\u062a|\u0628\u064a\u062a\u0643|\u0680\u0627\u0631\u062a|\u062a\u0648\u0646\u0633|\u0634\u0628\u0643\u0629|\u0639\u0631\u0627\u0642|\u0639\u0645\u0627\u0646|\u0645\u0648\u0642\u0639|\u092d\u093e\u0930\u0924|\u09ad\u09be\u09b0\u09a4|\u09ad\u09be\u09f0\u09a4|\u0a2d\u0a3e\u0a30\u0a24|\u0aad\u0abe\u0ab0\u0aa4|\u0b2d\u0b3e\u0b30\u0b24|\u0cad\u0cbe\u0cb0\u0ca4|\u0dbd\u0d82\u0d9a\u0dcf|\u30a2\u30de\u30be\u30f3|\u30b0\u30fc\u30b0\u30eb|\u30af\u30e9\u30a6\u30c9|\u30dd\u30a4\u30f3\u30c8|\u5927\u4f17\u6c7d\u8f66|\u7ec4\u7ec7\u673a\u6784|\u96fb\u8a0a\u76c8\u79d1|\u9999\u683c\u91cc\u62c9|aaa|abb|abc|aco|ads|aeg|afl|aig|anz|aol|app|art|aws|axa|bar|bbc|bbt|bcg|bcn|bet|bid|bio|biz|bms|bmw|bom|boo|bot|box|buy|bzh|cab|cal|cam|car|cat|cba|cbn|cbs|ceo|cfa|cfd|com|cpa|crs|csc|dad|day|dds|dev|dhl|diy|dnp|dog|dot|dtv|dvr|eat|eco|edu|esq|eus|fan|fit|fly|foo|fox|frl|ftr|fun|fyi|gal|gap|gay|gdn|gea|gle|gmo|gmx|goo|gop|got|gov|hbo|hiv|hkt|hot|how|ibm|ice|icu|ifm|inc|ing|ink|int|ist|itv|jcb|jio|jll|jmp|jnj|jot|joy|kfh|kia|kim|kpn|krd|lat|law|lds|llc|llp|lol|lpl|ltd|man|map|mba|med|men|mil|mit|mlb|mls|mma|moe|moi|mom|mov|msd|mtn|mtr|nab|nba|nec|net|new|nfl|ngo|nhk|now|nra|nrw|ntt|nyc|obi|off|one|ong|onl|ooo|org|ott|ovh|pay|pet|phd|pid|pin|pnc|pro|pru|pub|pwc|qvc|red|ren|ril|rio|rip|run|rwe|sap|sas|sbi|sbs|sca|scb|ses|sew|sex|sfr|ski|sky|soy|spa|srl|stc|tab|tax|tci|tdk|tel|thd|tjx|top|trv|tui|tvs|ubs|uno|uol|ups|vet|vig|vin|vip|wed|win|wme|wow|wtc|wtf|xin|xxx|xyz|you|yun|zip|\u0431\u0435\u043b|\u043a\u043e\u043c|\u049b\u0430\u0437|\u043c\u043a\u0434|\u043c\u043e\u043d|\u043e\u0440\u0433|\u0440\u0443\u0441|\u0441\u0440\u0431|\u0443\u043a\u0440|\u0570\u0561\u0575|\u05e7\u05d5\u05dd|\u0639\u0631\u0628|\u0642\u0637\u0631|\u0643\u0648\u0645|\u0645\u0635\u0631|\u0915\u0949\u092e|\u0928\u0947\u091f|\u0e04\u0e2d\u0e21|\u0e44\u0e17\u0e22|\u0ea5\u0eb2\u0ea7|\u30b9\u30c8\u30a2|\u30bb\u30fc\u30eb|\u307f\u3093\u306a|\u4e2d\u6587\u7f51|\u4e9a\u9a6c\u900a|\u5929\u4e3b\u6559|\u6211\u7231\u4f60|\u65b0\u52a0\u5761|\u6de1\u9a6c\u9521|\u8bfa\u57fa\u4e9a|\u98de\u5229\u6d66|ac|ad|ae|af|ag|ai|al|am|ao|aq|ar|as|at|au|aw|ax|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cw|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|er|es|et|eu|fi|fj|fk|fm|fo|fr|ga|gb|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|me|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|py|qa|re|ro|rs|ru|rw|sa|sb|sc|sd|se|sg|sh|si|sj|sk|sl|sm|sn|so|sr|ss|st|su|sv|sx|sy|sz|tc|td|tf|tg|th|tj|tk|tl|tm|tn|to|tr|tt|tv|tw|tz|ua|ug|uk|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|za|zm|zw|\u03b5\u03bb|\u03b5\u03c5|\u0431\u0433|\u0435\u044e|\u0440\u0444|\u10d2\u10d4|\ub2f7\ub137|\ub2f7\ucef4|\uc0bc\uc131|\ud55c\uad6d|\u30b3\u30e0|\u4e16\u754c|\u4e2d\u4fe1|\u4e2d\u56fd|\u4e2d\u570b|\u4f01\u4e1a|\u4f5b\u5c71|\u4fe1\u606f|\u5065\u5eb7|\u516b\u5366|\u516c\u53f8|\u516c\u76ca|\u53f0\u6e7e|\u53f0\u7063|\u5546\u57ce|\u5546\u5e97|\u5546\u6807|\u5609\u91cc|\u5728\u7ebf|\u5927\u62ff|\u5a31\u4e50|\u5bb6\u96fb|\u5e7f\u4e1c|\u5fae\u535a|\u6148\u5584|\u624b\u673a|\u62db\u8058|\u653f\u52a1|\u653f\u5e9c|\u65b0\u95fb|\u65f6\u5c1a|\u66f8\u7c4d|\u673a\u6784|\u6e38\u620f|\u6fb3\u9580|\u70b9\u770b|\u79fb\u52a8|\u7f51\u5740|\u7f51\u5e97|\u7f51\u7ad9|\u7f51\u7edc|\u8054\u901a|\u8c37\u6b4c|\u8d2d\u7269|\u901a\u8ca9|\u96c6\u56e2|\u98df\u54c1|\u9910\u5385|\u9999\u6e2f)/,R7=new RegExp("[".concat(ci,"!#$%&'*+/=?^_`{|}~-]")),O7=new RegExp("^".concat(mT.source,"$")),_T=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.localPartCharRegex=R7,e.strictTldRegex=O7,e}return we(n,t),n.prototype.parseMatches=function(e){for(var i=this.tagBuilder,r=this.localPartCharRegex,s=this.strictTldRegex,o=[],d=e.length,$=new Hp,I={m:"a",a:"i",i:"l",l:"t",t:"o",o:":"},Q=0,fe=0,_e=$;Q<d;){var Ce=e.charAt(Q);switch(fe){case 0:"m"===(ot=Ce)?lt(1):r.test(ot)&&lt();break;case 1:Re(e.charAt(Q-1),Ce);break;case 2:Le(Ce);break;case 3:Be(Ce);break;case 4:Ae(Ce);break;case 5:je(Ce);break;case 6:Ue(Ce);break;case 7:at(Ce);break;default:oT(fe)}Q++}var ot;return Ct(),o;function Re(ot,ht){":"===ot?r.test(ht)?(fe=2,_e=new Hp(ce(ce({},_e),{hasMailtoPrefix:!0}))):tt():I[ot]===ht||(r.test(ht)?fe=2:"."===ht?fe=3:"@"===ht?fe=4:tt())}function Le(ot){"."===ot?fe=3:"@"===ot?fe=4:r.test(ot)||tt()}function Be(ot){"."===ot||"@"===ot?tt():r.test(ot)?fe=2:tt()}function Ae(ot){Up.test(ot)?fe=5:tt()}function je(ot){"."===ot?fe=7:"-"===ot?fe=6:Up.test(ot)||Ct()}function Ue(ot){"-"===ot||"."===ot?Ct():Up.test(ot)?fe=5:Ct()}function at(ot){"."===ot||"-"===ot?Ct():Up.test(ot)?(fe=5,_e=new Hp(ce(ce({},_e),{hasDomainDot:!0}))):Ct()}function lt(ot){void 0===ot&&(ot=2),fe=ot,_e=new Hp({idx:Q})}function tt(){fe=0,_e=$}function Ct(){if(_e.hasDomainDot){var ot=e.slice(_e.idx,Q);/[-.]$/.test(ot)&&(ot=ot.slice(0,-1));var ht=_e.hasMailtoPrefix?ot.slice(7):ot;(function pt(_n){var di=(_n.split(".").pop()||"").toLowerCase();return s.test(di)})(ht)&&o.push(new lT({tagBuilder:i,matchedText:ot,offset:_e.idx,email:ht}))}tt()}},n}(ou),Hp=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.hasMailtoPrefix=!!n.hasMailtoPrefix,this.hasDomainDot=!!n.hasDomainDot},B7=function(){function t(){}return t.isValid=function(n,e){return!(e&&!this.isValidUriScheme(e)||this.urlMatchDoesNotHaveProtocolOrDot(n,e)||this.urlMatchDoesNotHaveAtLeastOneWordChar(n,e)&&!this.isValidIpAddress(n)||this.containsMultipleDots(n))},t.isValidIpAddress=function(n){var e=new RegExp(this.hasFullProtocolRegex.source+this.ipRegex.source);return null!==n.match(e)},t.containsMultipleDots=function(n){var e=n;return this.hasFullProtocolRegex.test(n)&&(e=n.split("://")[1]),e.split("/")[0].indexOf("..")>-1},t.isValidUriScheme=function(n){var e=n.match(this.uriSchemeRegex),i=e&&e[0].toLowerCase();return"javascript:"!==i&&"vbscript:"!==i},t.urlMatchDoesNotHaveProtocolOrDot=function(n,e){return!(!n||e&&this.hasFullProtocolRegex.test(e)||-1!==n.indexOf("."))},t.urlMatchDoesNotHaveAtLeastOneWordChar=function(n,e){return!(!n||!e||this.hasFullProtocolRegex.test(e)||this.hasWordCharAfterProtocolRegex.test(n))},t.hasFullProtocolRegex=/^[A-Za-z][-.+A-Za-z0-9]*:\/\//,t.uriSchemeRegex=/^[A-Za-z][-.+A-Za-z0-9]*:/,t.hasWordCharAfterProtocolRegex=new RegExp(":[^\\s]*?["+hT+"]"),t.ipRegex=/[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?\.[0-9][0-9]?[0-9]?(:[0-9]*)?\/?$/,t}(),L7=(e=new RegExp("[/?#](?:["+ci+"\\-+&@#/%=~_()|'$*\\[\\]{}?!:,.;^\u2713]*["+ci+"\\-+&@#/%=~_()|'$*\\[\\]{}\u2713])?"),new RegExp(["(?:","(",/(?:[A-Za-z][-.+A-Za-z0-9]{0,63}:(?![A-Za-z][-.+A-Za-z0-9]{0,63}:\/\/)(?!\d+\/?)(?:\/\/)?)/.source,V0(2),")","|","(","(//)?",/(?:www\.)/.source,V0(6),")","|","(","(//)?",V0(10)+"\\.",mT.source,"(?![-"+P7+"])",")",")","(?::[0-9]+)?","(?:"+e.source+")?"].join(""),"gi")),z7=new RegExp("["+ci+"]"),$T=function(t){function n(e){var i=t.call(this,e)||this;return i.stripPrefix={scheme:!0,www:!0},i.stripTrailingSlash=!0,i.decodePercentEncoding=!0,i.matcherRegex=L7,i.wordCharRegExp=z7,i.stripPrefix=e.stripPrefix,i.stripTrailingSlash=e.stripTrailingSlash,i.decodePercentEncoding=e.decodePercentEncoding,i}return we(n,t),n.prototype.parseMatches=function(e){for(var I,i=this.matcherRegex,r=this.stripPrefix,s=this.stripTrailingSlash,o=this.decodePercentEncoding,d=this.tagBuilder,$=[],Q=function(){var _e=I[0],Ce=I[1],Ee=I[4],Be=I.index,Ae=I[5]||I[9],je=e.charAt(Be-1);if(!B7.isValid(_e,Ce)||Be>0&&"@"===je||Be>0&&Ae&&fe.wordCharRegExp.test(je))return"continue";if(/\?$/.test(_e)&&(_e=_e.substr(0,_e.length-1)),fe.matchHasUnbalancedClosingParen(_e))_e=_e.substr(0,_e.length-1);else{var Ue=fe.matchHasInvalidCharAfterTld(_e,Ce);Ue>-1&&(_e=_e.substr(0,Ue))}var at=["http://","https://"].find(function(ot){return!!Ce&&-1!==Ce.indexOf(ot)});if(at){var lt=_e.indexOf(at);_e=_e.substr(lt),Ce=Ce.substr(lt),Be+=lt}$.push(new fT({tagBuilder:d,matchedText:_e,offset:Be,urlMatchType:Ce?"scheme":Ee?"www":"tld",url:_e,protocolUrlMatch:!!Ce,protocolRelativeMatch:!!Ae,stripPrefix:r,stripTrailingSlash:s,decodePercentEncoding:o}))},fe=this;null!==(I=i.exec(e));)Q();return $},n.prototype.matchHasUnbalancedClosingParen=function(e){var r,i=e.charAt(e.length-1);if(")"===i)r="(";else if("]"===i)r="[";else{if("}"!==i)return!1;r="{"}for(var s=0,o=0,d=e.length-1;o<d;o++){var $=e.charAt(o);$===r?s++:$===i&&(s=Math.max(s-1,0))}return 0===s},n.prototype.matchHasInvalidCharAfterTld=function(e,i){if(!e)return-1;var r=0;i&&(r=e.indexOf(":"),e=e.slice(r));var o=new RegExp("^((.?//)?[-."+ci+"]*[-"+ci+"]\\.[-"+ci+"]+)").exec(e);return null===o?-1:(r+=o[1].length,e=e.slice(o[1].length),/^[^-.A-Za-z0-9:\/?#]/.test(e)?r:-1)},n}(ou),j7=new RegExp("#[_".concat(ci,"]{1,139}(?![_").concat(ci,"])"),"g"),U7=new RegExp("[^"+ci+"]"),vT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegex=j7,i.nonWordCharRegex=U7,i.serviceName=e.serviceName,i}return we(n,t),n.prototype.parseMatches=function(e){for(var $,i=this.matcherRegex,r=this.nonWordCharRegex,s=this.serviceName,o=this.tagBuilder,d=[];null!==($=i.exec(e));){var I=$.index,Q=e.charAt(I-1);if(0===I||r.test(Q)){var fe=$[0],_e=$[0].slice(1);d.push(new cT({tagBuilder:o,matchedText:fe,offset:I,serviceName:s,hashtag:_e}))}}return d},n}(ou),G7=new RegExp("".concat(/(?:(?:(?:(\+)?\d{1,3}[-\040.]?)?\(?\d{3}\)?[-\040.]?\d{3}[-\040.]?\d{4})|(?:(\+)(?:9[976]\d|8[987530]\d|6[987]\d|5[90]\d|42\d|3[875]\d|2[98654321]\d|9[8543210]|8[6421]|6[6543210]|5[87654321]|4[987654310]|3[9643210]|2[70]|7|1)[-\040.]?(?:\d[-\040.]?){6,12}\d+))([,;]+[0-9]+#?)*/.source,"|").concat(/(0([1-9]{1}-?[1-9]\d{3}|[1-9]{2}-?\d{3}|[1-9]{2}\d{1}-?\d{2}|[1-9]{2}\d{2}-?\d{1})-?\d{4}|0[789]0-?\d{4}-?\d{4}|050-?\d{4}-?\d{4})/.source),"g"),bT=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.matcherRegex=G7,e}return we(n,t),n.prototype.parseMatches=function(e){for(var o,i=this.matcherRegex,r=this.tagBuilder,s=[];null!==(o=i.exec(e));){var d=o[0],$=d.replace(/[^0-9,;#]/g,""),I=!(!o[1]&&!o[2]),Q=0==o.index?"":e.substr(o.index-1,1),fe=e.substr(o.index+d.length,1),_e=!Q.match(/\d/)&&!fe.match(/\d/);this.testMatch(o[3])&&this.testMatch(d)&&_e&&s.push(new dT({tagBuilder:r,matchedText:d,offset:o.index,number:$,plusSign:I}))}return s},n.prototype.testMatch=function(e){return k7.test(e)},n}(ou),q7=new RegExp("@[_".concat(ci,"]{1,50}(?![_").concat(ci,"])"),"g"),W7=new RegExp("@[_.".concat(ci,"]{1,30}(?![_").concat(ci,"])"),"g"),K7=new RegExp("@[-_.".concat(ci,"]{1,50}(?![-_").concat(ci,"])"),"g"),Y7=new RegExp("@[_.".concat(ci,"]{1,23}[_").concat(ci,"](?![_").concat(ci,"])"),"g"),Z7=new RegExp("[^"+ci+"]"),yT=function(t){function n(e){var i=t.call(this,e)||this;return i.serviceName="twitter",i.matcherRegexes={twitter:q7,instagram:W7,soundcloud:K7,tiktok:Y7},i.nonWordCharRegex=Z7,i.serviceName=e.serviceName,i}return we(n,t),n.prototype.parseMatches=function(e){var $,i=this.serviceName,r=this.matcherRegexes[this.serviceName],s=this.nonWordCharRegex,o=this.tagBuilder,d=[];if(!r)return d;for(;null!==($=r.exec(e));){var I=$.index,Q=e.charAt(I-1);if(0===I||s.test(Q)){var fe=$[0].replace(/\.+$/g,""),_e=fe.slice(1);d.push(new uT({tagBuilder:o,matchedText:fe,offset:I,serviceName:i,mention:_e}))}}return d},n}(ou);var Do=function t(n){void 0===n&&(n={}),this.idx=void 0!==n.idx?n.idx:-1,this.type=n.type||"tag",this.name=n.name||"",this.isOpening=!!n.isOpening,this.isClosing=!!n.isClosing},Q7=function(){function t(n){void 0===n&&(n={}),this.version=t.version,this.urls={},this.email=!0,this.phone=!0,this.hashtag=!1,this.mention=!1,this.newWindow=!0,this.stripPrefix={scheme:!0,www:!0},this.stripTrailingSlash=!0,this.decodePercentEncoding=!0,this.truncate={length:0,location:"end"},this.className="",this.replaceFn=null,this.context=void 0,this.sanitizeHtml=!1,this.matchers=null,this.tagBuilder=null,this.urls=this.normalizeUrlsCfg(n.urls),this.email="boolean"==typeof n.email?n.email:this.email,this.phone="boolean"==typeof n.phone?n.phone:this.phone,this.hashtag=n.hashtag||this.hashtag,this.mention=n.mention||this.mention,this.newWindow="boolean"==typeof n.newWindow?n.newWindow:this.newWindow,this.stripPrefix=this.normalizeStripPrefixCfg(n.stripPrefix),this.stripTrailingSlash="boolean"==typeof n.stripTrailingSlash?n.stripTrailingSlash:this.stripTrailingSlash,this.decodePercentEncoding="boolean"==typeof n.decodePercentEncoding?n.decodePercentEncoding:this.decodePercentEncoding,this.sanitizeHtml=n.sanitizeHtml||!1;var e=this.mention;if(!1!==e&&-1===["twitter","instagram","soundcloud","tiktok"].indexOf(e))throw new Error("invalid `mention` cfg '".concat(e,"' - see docs"));var i=this.hashtag;if(!1!==i&&-1===["twitter","facebook","instagram","tiktok"].indexOf(i))throw new Error("invalid `hashtag` cfg '".concat(i,"' - see docs"));this.truncate=this.normalizeTruncateCfg(n.truncate),this.className=n.className||this.className,this.replaceFn=n.replaceFn||this.replaceFn,this.context=n.context||this}return t.link=function(n,e){return new t(e).link(n)},t.parse=function(n,e){return new t(e).parse(n)},t.prototype.normalizeUrlsCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{schemeMatches:n,wwwMatches:n,tldMatches:n}:{schemeMatches:"boolean"!=typeof n.schemeMatches||n.schemeMatches,wwwMatches:"boolean"!=typeof n.wwwMatches||n.wwwMatches,tldMatches:"boolean"!=typeof n.tldMatches||n.tldMatches}},t.prototype.normalizeStripPrefixCfg=function(n){return null==n&&(n=!0),"boolean"==typeof n?{scheme:n,www:n}:{scheme:"boolean"!=typeof n.scheme||n.scheme,www:"boolean"!=typeof n.www||n.www}},t.prototype.normalizeTruncateCfg=function(n){return"number"==typeof n?{length:n,location:"end"}:function C7(t,n){for(var e in n)n.hasOwnProperty(e)&&void 0===t[e]&&(t[e]=n[e]);return t}(n||{},{length:Number.POSITIVE_INFINITY,location:"end"})},t.prototype.parse=function(n){var e=this,i=["a","style","script"],r=0,s=[];return function X7(t,n){for(var e=n.onOpenTag,i=n.onCloseTag,r=n.onText,s=n.onComment,o=n.onDoctype,d=new Do,$=0,I=t.length,Q=0,fe=0,_e=d;$<I;){var Ce=t.charAt($);switch(Q){case 0:"<"===Ce&&Nn();break;case 1:"!"===($t=Ce)?Q=13:"/"===$t?(Q=2,_e=new Do(ce(ce({},_e),{isClosing:!0}))):"<"===$t?Nn():U0.test($t)?(Q=3,_e=new Do(ce(ce({},_e),{isOpening:!0}))):(Q=0,_e=d);break;case 2:Be(Ce);break;case 3:Le(Ce);break;case 4:Ae(Ce);break;case 5:je(Ce);break;case 6:Ue(Ce);break;case 7:at(Ce);break;case 8:lt(Ce);break;case 9:tt(Ce);break;case 10:Ct(Ce);break;case 11:ot(Ce);break;case 12:ht(Ce);break;case 13:"--"===t.substr($,2)?($+=2,_e=new Do(ce(ce({},_e),{type:"comment"})),Q=14):"DOCTYPE"===t.substr($,7).toUpperCase()?($+=7,_e=new Do(ce(ce({},_e),{type:"doctype"})),Q=20):en();break;case 14:_n(Ce);break;case 15:an(Ce);break;case 16:di(Ce);break;case 17:Er(Ce);break;case 18:xt(Ce);break;case 19:Ot(Ce);break;case 20:Ht(Ce);break;default:oT(Q)}$++}var $t;function Le($t){Ol.test($t)?(_e=new Do(ce(ce({},_e),{name:Xi()})),Q=4):"<"===$t?Nn():"/"===$t?(_e=new Do(ce(ce({},_e),{name:Xi()})),Q=12):">"===$t?(_e=new Do(ce(ce({},_e),{name:Xi()})),$i()):!U0.test($t)&&!S7.test($t)&&":"!==$t&&en()}function Be($t){">"===$t?en():U0.test($t)?Q=3:en()}function Ae($t){Ol.test($t)||("/"===$t?Q=12:">"===$t?$i():"<"===$t?Nn():"="===$t||H0.test($t)||M7.test($t)?en():Q=5)}function je($t){Ol.test($t)?Q=6:"/"===$t?Q=12:"="===$t?Q=7:">"===$t?$i():"<"===$t?Nn():H0.test($t)&&en()}function Ue($t){Ol.test($t)||("/"===$t?Q=12:"="===$t?Q=7:">"===$t?$i():"<"===$t?Nn():H0.test($t)?en():Q=5)}function at($t){Ol.test($t)||('"'===$t?Q=8:"'"===$t?Q=9:/[>=`]/.test($t)?en():"<"===$t?Nn():Q=10)}function lt($t){'"'===$t&&(Q=11)}function tt($t){"'"===$t&&(Q=11)}function Ct($t){Ol.test($t)?Q=4:">"===$t?$i():"<"===$t&&Nn()}function ot($t){Ol.test($t)?Q=4:"/"===$t?Q=12:">"===$t?$i():"<"===$t?Nn():(Q=4,function fi(){$--}())}function ht($t){">"===$t?(_e=new Do(ce(ce({},_e),{isClosing:!0})),$i()):Q=4}function _n($t){"-"===$t?Q=15:">"===$t?en():Q=16}function an($t){"-"===$t?Q=18:">"===$t?en():Q=16}function di($t){"-"===$t&&(Q=17)}function Er($t){Q="-"===$t?18:16}function xt($t){">"===$t?$i():"!"===$t?Q=19:"-"===$t||(Q=16)}function Ot($t){"-"===$t?Q=17:">"===$t?$i():Q=16}function Ht($t){">"===$t?$i():"<"===$t&&Nn()}function en(){Q=0,_e=d}function Nn(){Q=1,_e=new Do({idx:$})}function $i(){var $t=t.slice(fe,_e.idx);$t&&r($t,fe),"comment"===_e.type?s(_e.idx):"doctype"===_e.type?o(_e.idx):(_e.isOpening&&e(_e.name,_e.idx),_e.isClosing&&i(_e.name,_e.idx)),en(),fe=$+1}function Xi(){return t.slice(_e.idx+(_e.isClosing?2:1),$).toLowerCase()}fe<$&&function Ei(){var $t=t.slice(fe,$);r($t,fe),fe=$+1}()}(n,{onOpenTag:function(o){i.indexOf(o)>=0&&r++},onText:function(o,d){if(0===r){var I=function w7(t,n){if(!n.global)throw new Error("`splitRegex` must have the 'g' flag set");for(var r,e=[],i=0;r=n.exec(t);)e.push(t.substring(i,r.index)),e.push(r[0]),i=r.index+r[0].length;return e.push(t.substring(i)),e}(o,/(&nbsp;|&#160;|&lt;|&#60;|&gt;|&#62;|&quot;|&#34;|&#39;)/gi),Q=d;I.forEach(function(fe,_e){if(_e%2==0){var Ce=e.parseText(fe,Q);s.push.apply(s,Ce)}Q+=fe.length})}},onCloseTag:function(o){i.indexOf(o)>=0&&(r=Math.max(r-1,0))},onComment:function(o){},onDoctype:function(o){}}),s=this.compactMatches(s),s=this.removeUnwantedMatches(s)},t.prototype.compactMatches=function(n){n.sort(function($,I){return $.getOffset()-I.getOffset()});for(var e=0;e<n.length-1;){var i=n[e],r=i.getOffset(),s=i.getMatchedText().length,o=r+s;if(e+1<n.length){if(n[e+1].getOffset()===r){var d=n[e+1].getMatchedText().length>s?e:e+1;n.splice(d,1);continue}if(n[e+1].getOffset()<o){n.splice(e+1,1);continue}}e++}return n},t.prototype.removeUnwantedMatches=function(n){return this.hashtag||Rl(n,function(e){return"hashtag"===e.getType()}),this.email||Rl(n,function(e){return"email"===e.getType()}),this.phone||Rl(n,function(e){return"phone"===e.getType()}),this.mention||Rl(n,function(e){return"mention"===e.getType()}),this.urls.schemeMatches||Rl(n,function(e){return"url"===e.getType()&&"scheme"===e.getUrlMatchType()}),this.urls.wwwMatches||Rl(n,function(e){return"url"===e.getType()&&"www"===e.getUrlMatchType()}),this.urls.tldMatches||Rl(n,function(e){return"url"===e.getType()&&"tld"===e.getUrlMatchType()}),n},t.prototype.parseText=function(n,e){void 0===e&&(e=0),e=e||0;for(var i=this.getMatchers(),r=[],s=0,o=i.length;s<o;s++){for(var d=i[s].parseMatches(n),$=0,I=d.length;$<I;$++)d[$].setOffset(e+d[$].getOffset());r.push.apply(r,d)}return r},t.prototype.link=function(n){if(!n)return"";this.sanitizeHtml&&(n=n.replace(/</g,"&lt;").replace(/>/g,"&gt;"));for(var e=this.parse(n),i=[],r=0,s=0,o=e.length;s<o;s++){var d=e[s];i.push(n.substring(r,d.getOffset())),i.push(this.createMatchReturnVal(d)),r=d.getOffset()+d.getMatchedText().length}return i.push(n.substring(r)),i.join("")},t.prototype.createMatchReturnVal=function(n){var e;return this.replaceFn&&(e=this.replaceFn.call(this.context,n)),"string"==typeof e?e:!1===e?n.getMatchedText():e instanceof j0?e.toAnchorString():n.buildTag().toAnchorString()},t.prototype.getMatchers=function(){if(this.matchers)return this.matchers;var n=this.getTagBuilder(),e=[new vT({tagBuilder:n,serviceName:this.hashtag}),new _T({tagBuilder:n}),new bT({tagBuilder:n}),new yT({tagBuilder:n,serviceName:this.mention}),new $T({tagBuilder:n,stripPrefix:this.stripPrefix,stripTrailingSlash:this.stripTrailingSlash,decodePercentEncoding:this.decodePercentEncoding})];return this.matchers=e},t.prototype.getTagBuilder=function(){var n=this.tagBuilder;return n||(n=this.tagBuilder=new aT({newWindow:this.newWindow,truncate:this.truncate,className:this.className})),n},t.version="3.15.0",t.AnchorTagBuilder=aT,t.HtmlTag=j0,t.matcher={Email:_T,Hashtag:vT,Matcher:ou,Mention:yT,Phone:bT,Url:$T},t.match={Email:lT,Hashtag:cT,Match:su,Mention:uT,Phone:dT,Url:fT},t}();const CT=Q7,G0=CT;let Tn=(()=>{class t{constructor(){this.title="\u7121\u540d\u306e\u30d1\u30cd\u30eb",this.left=0,this.top=0,this.width=100,this.height=100,this.isAbleMinimizeButton=!0,this.isAbleFullScreenButton=!0,this.isAbleCloseButton=!0,this.isAbleRotateButton=!1,this.scrollablePanel=null}get isShow(){return!!this.panelComponentRef}open(e,i,r){let s;r||(r=t.defaultParentViewContainerRef),s=r.createComponent(t.UIPanelComponentClass,{index:r.length,injector:r.injector});let o=s.instance.content.createComponent(e);const d=s.injector.get(t);return d.panelComponentRef=s,i&&(i.title&&(d.title=i.title),i.top&&(d.top=i.top),i.left&&(d.left=i.left),i.width&&(d.width=i.width),i.height&&(d.height=i.height)),s.onDestroy(()=>{d.panelComponentRef=null}),o.instance}close(){this.panelComponentRef&&(this.panelComponentRef.destroy(),this.panelComponentRef=null)}}return t.UIPanelComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class J7{constructor(n,e,i){this._resolve=n,this._reject=e,this.option=i}resolve(n){this._resolve(n),this._resolve=null}reject(n){this._reject(n),this._reject=null}}let kn=(()=>{class t{constructor(){this.modalContext=null,this.count=0,this.title="\u7121\u540d\u306e\u30e2\u30fc\u30c0\u30eb"}get option(){return this.modalContext?this.modalContext.option:null}get isShow(){return this.count>0}open(e,i,r){let s;return r||(r=t.defaultParentViewContainerRef),new Promise((o,d)=>{const Q=new t;Q.modalContext=new J7(_e=>{s&&(s.destroy(),o(_e),this.count--)},_e=>{s&&(s.destroy(),d(_e),this.count--)},i);const fe=Gr.create({providers:[{provide:t,useValue:Q}],parent:r.injector});s=r.createComponent(t.ModalComponentClass,{index:r.length,injector:fe}),s.instance.content.createComponent(e),s.onDestroy(()=>{this.count--}),this.count++})}resolve(e){this.modalContext&&(this.modalContext.resolve(e),this.modalContext=null)}reject(e){this.modalContext&&(this.modalContext.reject(e),this.modalContext=null)}}return t.ModalComponentClass=null,t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();const ez=function(t){return{outer:t}};function tz(t,n){if(1&t&&(X(0,"div",5),be(1),X(2,"span",6),be(3),te(),be(4),X(5,"span",7),be(6),te()()),2&t){const e=ge();W(1),An("",e.urlObj.protocol,"//"),W(1),re("ngClass",ct(6,ez,e.isOuter)),W(1),Ze(e.urlObj.host),W(1),Ze(e.urlObj.pathname),W(2),Ca("",e.urlObj.search,"",e.urlObj.hash,"")}}function nz(t,n){if(1&t&&(X(0,"div",5),be(1),te()),2&t){const e=ge();W(1),Ze(e.url)}}function iz(t,n){1&t&&(X(0,"div"),be(1,"\u3053\u306eURL\u3092\u958b\u304d\u307e\u3059\u304b\uff1f\uff08\u5225\u30a6\u30a3\u30f3\u30c9\u30a6\u3067\u958b\u304d\u307e\u3059\u3001\u30dd\u30c3\u30d7\u30a2\u30c3\u30d7\u3092\u8a31\u53ef\u3057\u3066\u304f\u3060\u3055\u3044\uff09"),te())}function rz(t,n){1&t&&(X(0,"div"),be(1,"\u26a0\ufe0fURL\u304c\u4e0d\u6b63\u3067\u3059\u3002"),te())}let Qr=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.url="",this.title="",this.subTitle="",this.url=i.option.url?i.option.url:"",this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.urlObj=this.isValid?new URL(this.url):null}get isValid(){return et.validUrl(this.url.trim())}get isOuter(){return!!this.isValid&&window.location.origin!=this.urlObj.origin}ngOnInit(){Promise.resolve().then(()=>{let e="\u5916\u90e8URL\u3092\u958b\u304f";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Fe.register(this)}ngOnDestroy(){Fe.unregister(this)}openUrl(){window.open(this.url.trim(),"_blank","noopener"),this.modalService.resolve(!0)}cancel(){this.modalService.resolve(!1)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["open-url"]],decls:11,vars:5,consts:[["class","url",4,"ngIf"],[1,"help"],[4,"ngIf"],["type","submit",3,"disabled","click"],["type","button",3,"click"],[1,"url"],[3,"ngClass"],[1,"opt"]],template:function(e,i){1&e&&(X(0,"div"),xe(1,tz,7,8,"div",0),xe(2,nz,2,1,"div",0),nt(3,"hr"),X(4,"div",1),xe(5,iz,2,0,"div",2),xe(6,rz,2,0,"div",2),te()(),X(7,"button",3),Ie("click",function(){return i.openUrl()}),be(8,"\u958b\u304f"),te(),X(9,"button",4),Ie("click",function(){return i.cancel()}),be(10,"\u30ad\u30e3\u30f3\u30bb\u30eb"),te()),2&e&&(W(1),re("ngIf",i.isValid),W(1),re("ngIf",!i.isValid),W(3),re("ngIf",i.isValid),W(1),re("ngIf",!i.isValid),W(1),re("disabled",!i.isValid))},directives:[gn,jn],styles:[".url[_ngcontent-%COMP%]{word-break:break-all}.url[_ngcontent-%COMP%]   .outer[_ngcontent-%COMP%]{font-weight:700}.opt[_ngcontent-%COMP%]{color:gray}.help[_ngcontent-%COMP%]{font-size:smaller}"]}),t})();const sz=["message"];function oz(t,n){if(1&t&&(X(0,"span")(1,"pre",1),be(2),te()()),2&t){const e=ge();W(2),Ze(e.text)}}function az(t,n){1&t&&nt(0,"hr")}function lz(t,n){if(1&t){const e=Ye();X(0,"pre",1)(1,"span",3,4),Ie("click",function(r){return ke(e),ge(2).onLinkClick(r)}),bt(3,"safe"),te(),xe(4,az,1,0,"hr",0),te()}if(2&t){const e=n.$implicit,i=n.last,r=ge(2);W(1),re("innerHTML",yt(3,2,r.htmlEscapeLinking(e),"html"),Ui),W(3),re("ngIf",!i)}}function cz(t,n){if(1&t&&(X(0,"span"),xe(1,lz,5,5,"pre",2),te()),2&t){const e=ge();W(1),re("ngForOf",e.text)}}let au=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.text="",this.title="",this.stringUtil=et}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title=this.title,this.modalService.option&&null!=this.modalService.option.title&&(this.modalService.title=this.modalService.option.title?this.modalService.option.title:"",this.text=this.modalService.option.text?this.modalService.option.text:"")})}htmlEscapeLinking(e,i=!1){return G0.link(et.escapeHtml(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(r){if("url"==r.getType()&&et.validUrl(r.getAnchorHref())){if(et.sameOrigin(r.getAnchorHref()))return!0;{const s=r.buildTag();return s.setAttr("rel","nofollow"),s.addClass("outer-link"),s}}return!1}})}isObj(e){return"object"==typeof e}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!et.sameOrigin(i))return e.preventDefault(),this.modalService.open(Qr,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["text-view"]],viewQuery:function(e,i){if(1&e&&dn(sz,5),2&e){let r;un(r=fn())&&(i.messageElm=r.first)}},inputs:{text:"text",title:"title"},decls:2,vars:2,consts:[[4,"ngIf"],[1,"text"],["class","text",4,"ngFor","ngForOf"],[3,"innerHTML","click"],["message",""]],template:function(e,i){1&e&&(xe(0,oz,3,1,"span",0),xe(1,cz,2,1,"span",0)),2&e&&(re("ngIf",!i.isObj(i.text)),W(1),re("ngIf",i.isObj(i.text)))},directives:[gn,Jn],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.text[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;font-size:12px;white-space:pre-wrap;margin:0;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"]}),t})();var lu;let Xe=(()=>{class t{}return t.dicePick="",t.dicePut="",t.diceRoll1="",t.diceRoll2="",t.cardDraw="",t.cardPick="",t.cardPut="",t.cardShuffle="",t.piecePick="",t.piecePut="",t.blockPick="",t.blockPut="",t.lock="",t.unlock="",t.sweep="",t.puyon="",t.surprise="",t.coinToss="",t})(),ut=lu=class extends La{onStoreAdded(){super.onStoreAdded(),Fe.register(this).on("SOUND_EFFECT",n=>{kt.play(Ft.instance.get(n.data),.5)}).on("SEND_MESSAGE",n=>{let e=rt.instance.get(n.data.messageIdentifier);!e||!e.isSendFromSelf||e.isEmptyDice||(Math.random()<.5?lu.play(Xe.diceRoll1):lu.play(Xe.diceRoll2))})}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this)}play(n){lu.play(n)}static play(n){let e="";e="string"==typeof n?n:n.identifier,lu._play(e)}static _play(n){Fe.call("SOUND_EFFECT",n)}};var Xd;ut=lu=B([Kn("sound-effect")],ut);let mn=Xd=class extends Ln{constructor(){super(...arguments),this.imageIdentifier="",this.tag="",this.hide=!1}get words(){return(null==this.tag||""==this.tag.trim())&&(this.tag=""),""===this.tag.trim()?[]:(this.tag=et.toHalfWidth(this.tag).toLowerCase(),this.tag.trim().split(/\s+/))}containsWords(n,e=!0){if("string"==typeof n&&(n=n.trim().split(/\s+/)),0==n.length)return!1;if(n=n.concat(),e){for(const i of n)if(` ${this.tag} `.indexOf(` ${et.toHalfWidth(i).toLowerCase()} `)>=0)return!0;return!1}for(const i of n)if(` ${this.tag} `.indexOf(` ${et.toHalfWidth(i).toLowerCase()} `)<0)return!1;return!0}addWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>et.toHalfWidth(i).toLowerCase())));return this.tag=Array.from(new Set(e.concat(this.words))).sort().join(" "),Fe.call("OPERATE_IMAGE_TAGS",this.identifier),e}removeWords(n){"string"==typeof n&&(n=n.trim().split(/\s+/)),n=n.concat();const e=Array.from(new Set(n.map(i=>et.toHalfWidth(i).toLowerCase())));return this.tag=this.words.filter(i=>!e.includes(et.toHalfWidth(i).toLowerCase())).sort().join(" "),Fe.call("OPERATE_IMAGE_TAGS",this.identifier),e}static get(n){return rt.instance.get(`imagetag_${n}`)}static create(n){const e=new Xd(`imagetag_${n}`);return e.imageIdentifier=n,e.initialize(),e}parseInnerXml(n){let e=Xd.get(this.imageIdentifier);e||(e=Xd.create(this.imageIdentifier));const i=e.toContext();i.syncData=this.toContext().syncData,e.apply(i),e.update(),this.destroy()}};var Bl;B([st()],mn.prototype,"imageIdentifier",void 0),B([st()],mn.prototype,"tag",void 0),B([st()],mn.prototype,"hide",void 0),mn=Xd=B([Kn("image-tag")],mn);let br=Bl=class extends Ln{constructor(){super(...arguments),this.identifiers=[]}static searchImages(n,e,i,r){"string"==typeof n&&(n=n.trim().split(/\s+/));const s=Bl.allImagesOwnWords(r);return n=n.filter(d=>s.includes(d)),this.allImages(r).filter(d=>{const $=mn.get(d.identifier);return e&&(i||0===n.length)&&(!$||null==$.tag||""===$.tag.trim())||(!e||i)&&$&&$.containsWords(n,i)})}static allImages(n){return It.instance.images.filter(i=>{if(n)return!0;const r=mn.get(i.identifier);return!r||!r.hide})}static allImagesOwnWords(n){return Bl.imagesOwnWords(this.allImages(n))}static imagesOwnWords(n,e=!1){if(e){if(0===n.length)return[];const i=n.map(s=>mn.get(s.identifier));if(!i[0])return[];let r=i[0].words;for(let s=1;s<i.length;s++){if(!i[s])return[];if(r=r.filter(o=>i[s].words.includes(o)),0===r.length)return r}return r.sort()}{const i=[];for(const r of n){const s=mn.get(r.identifier);s&&i.push(...s.words)}return Array.from(new Set(i)).sort()}}static countAllImagesHasWord(n,e){let i=0;if(null!=n&&""===n.trim())return i;for(const r of Bl.allImages(e)){const s=mn.get(r.identifier);null==n?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(n.trim(),!1)&&i++}return i}static imagesIsHidden(n){for(const e of n){const i=mn.get(e.identifier);if(!i||!i.hide)return!1}return!0}static sortImagesByWords(n,e){const i=n.map(r=>{const s=mn.get(r.identifier);return{image:r,tag:s&&null!=s.tag?s.tag:""}});return i.sort((r,s)=>{let o=0;return e.some(d=>(o=Bl._sortByWordCriteria(r,s,d),!!o)),o}),i.map(r=>r.image)}static _sortByWordCriteria(n,e,i){if(null==i)return""==n.tag&&""==e.tag?0:""==n.tag?-1:""==e.tag?1:0;const r=` ${n.tag} `.indexOf(` ${i} `),s=` ${e.tag} `.indexOf(` ${i} `);return-1==r&&-1==s?0:r>=0&&-1==s?-1:-1==r&&s>=0?1:0}onStoreAdded(){super.onStoreAdded(),rt.instance.remove(this)}innerXml(){return Array.from(new Set(this.identifiers)).map(n=>mn.get(n)).filter(n=>n).map(n=>n.toXml()).join("")}static create(n){const e=new Bl;return e.identifiers=n.map(i=>i.identifier),e}};br=Bl=B([Kn("image-tag-list")],br);var Ll,xT=Y(4327),wT=Y(5650);!function(t){const n={avif:"image/avif",gif:"image/gif",jpg:"image/jpeg",jpeg:"image/jpeg",jpe:"image/jpeg",jfif:"image/jpeg",pjpeg:"image/jpeg",pjp:"image/jpeg",png:"image/png",apng:"image/apng",webp:"image/webp",svg:"image/svg+xml",svgz:"image/svg+xml",ico:"image/x-icon",cur:"image/x-icon",bmp:"image/bmp",html:"text/html",htm:"text/html",shtml:"text/html",xml:"text/xml",yml:"text/yaml",yaml:"text/yaml",json:"application/json",map:"application/json",zip:"application/zip",mp3:"audio/mp3",wav:"audio/wav",m4a:"audio/aac",ogg:"audio/ogg",mpg:"video/mpeg",mpeg:"video/mpeg",mp4:"video/mp4",webm:"video/webm"};t.type=function e(r){let s=r.replace(/.*[\.\/\\]/,"").toLowerCase();return n[s]?n[s]:""},t.extension=function i(r){for(let s in n)if(n[s]===r)return s;return r.split("/")[1]}}(Ll||(Ll={}));class Ao{constructor(){this.maxImageSize=2097152,this.maxAudioeSize=10485760,console.log("FileArchiver ready...")}static get instance(){return Ao._instance||(Ao._instance=new Ao),Ao._instance}initialize(){this.destroy(),this.addEventListeners()}destroy(){this.removeEventListeners()}addEventListeners(){this.removeEventListeners(),this.callbackOnDragEnter=n=>this.onDragEnter(n),this.callbackOnDragOver=n=>this.onDragOver(n),this.callbackOnDrop=n=>this.onDrop(n),document.body.addEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.addEventListener("dragover",this.callbackOnDragOver,!1),document.body.addEventListener("drop",this.callbackOnDrop,!1)}removeEventListeners(){document.body.removeEventListener("dragenter",this.callbackOnDragEnter,!1),document.body.removeEventListener("dragover",this.callbackOnDragOver,!1),document.body.removeEventListener("drop",this.callbackOnDrop,!1),this.callbackOnDragEnter=null,this.callbackOnDragOver=null,this.callbackOnDrop=null}onDragEnter(n){n.preventDefault()}onDragOver(n){n.preventDefault()}onDrop(n){n.preventDefault(),console.log("onDrop",n.dataTransfer),this.load(n.dataTransfer.files)}load(n){var e=this;return(0,Yt.Z)(function*(){if(!n)return;let i=n instanceof FileList?TT(n):n;for(let r of i)yield e.handleImage(r),yield e.handleAudio(r),yield e.handleText(r),yield e.handleZip(r),Fe.trigger("FILE_LOADED",{file:r})})()}handleImage(n){var e=this;return(0,Yt.Z)(function*(){if(!(n.type.indexOf("image/")<0)){if(e.maxImageSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield It.instance.addAsync(n)}})()}handleAudio(n){var e=this;return(0,Yt.Z)(function*(){if(!(n.type.indexOf("audio/")<0)){if(e.maxAudioeSize<n.size)return void console.warn(`File size limit exceeded. -> ${n.name} (${(n.size/1024/1024).toFixed(2)}MB)`);console.log(n.name+" type:"+n.type),yield Ft.instance.addAsync(n)}})()}handleText(n){return(0,Yt.Z)(function*(){if(!(n.type.indexOf("text/")<0)){console.log(n.name+" type:"+n.type);try{let e=ra.xml2element(yield no.readAsTextAsync(n));e&&Fe.trigger("XML_LOADED",{xmlElement:e})}catch(e){console.warn(e)}}})()}handleZip(n){var e=this;return(0,Yt.Z)(function*(){if(!(0<=n.type.indexOf("application/")||n.type.length<1))return;let i=new wT;try{i=yield i.loadAsync(n)}catch(s){return void console.warn(s)}let r=[];i.forEach((s,o)=>r.push(o));for(let s of r)try{let o=yield s.async("arraybuffer");console.log(s.name+" \u89e3\u51cd..."),yield e.load([new File([o],s.name,{type:Ll.type(s.name)})])}catch(o){console.warn(o)}})()}saveAsync(n,e,i){return(0,Yt.Z)(function*(){if(!n)return;let r=n instanceof FileList?TT(n):n,s=new wT;for(let d of r)s.file(d.name,d);let o=yield s.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}},i);(0,xT.saveAs)(o,e+".zip")})()}}function TT(t){let n=[],e=t.length;for(let i=0;i<e;i++)n.push(t[i]);return n}function uz(t,n){if(1&t&&(X(0,"i",6),be(1),te()),2&t){const e=ge();W(1),Ze(e.materialIcon)}}function dz(t,n){if(1&t&&(X(0,"div",7),be(1),te()),2&t){const e=ge();W(1),Ze(e.help)}}function fz(t,n){1&t&&(nt(0,"div",8),bt(1,"safe")),2&t&&re("innerHTML",yt(1,1,ge().helpHtml,"html"),Ui)}function hz(t,n){if(1&t){const e=Ye();X(0,"button",9),Ie("click",function(){return ke(e),ge().cancel()}),be(1,"\u30ad\u30e3\u30f3\u30bb\u30eb"),te()}}let qi=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.title="",this.subTitle="",this.text="",this.help="",this.helpHtml="",this.materialIcon="",this.type=_i.OK,this.action=null,this.cancelAction=null,this.title=i.option.title?i.option.title:"",this.subTitle=i.option.subTitle?i.option.subTitle:"",this.text=i.option.text?i.option.text:"",this.help=i.option.help?i.option.help:"",this.helpHtml=i.option.helpHtml?i.option.helpHtml:"",this.materialIcon=i.option.materialIcon?i.option.materialIcon:"",this.type=i.option.type?i.option.type:_i.OK,this.action=i.option.action?i.option.action:null,this.cancelAction=i.option.cancelAction?i.option.cancelAction:null}ngOnInit(){Promise.resolve().then(()=>{let e="\u78ba\u8a8d";this.title?e+="\u3008"+this.title+(this.subTitle?`\uff1a${this.subTitle}`:"")+"\u3009":this.subTitle&&(e+=`\u3008${this.subTitle}\u3009`),this.modalService.title=this.panelService.title=e}),Fe.register(this)}ngOnDestroy(){Fe.unregister(this)}ok(){this.modalService.resolve(!0),this.action&&this.action()}cancel(){this.modalService.resolve(!1),this.cancelAction&&this.cancelAction()}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["app-confirmation"]],decls:9,vars:5,consts:[[1,"text"],["class","material-icons icon",4,"ngIf"],["class","help",4,"ngIf"],["class","help",3,"innerHTML",4,"ngIf"],["type","submit",3,"click"],["type","button",3,"click",4,"ngIf"],[1,"material-icons","icon"],[1,"help"],[1,"help",3,"innerHTML"],["type","button",3,"click"]],template:function(e,i){1&e&&(X(0,"div",0),xe(1,uz,2,1,"i",1),be(2),te(),nt(3,"hr"),xe(4,dz,2,1,"div",2),xe(5,fz,2,4,"div",3),X(6,"button",4),Ie("click",function(){return i.ok()}),be(7,"\uff2f\uff2b"),te(),xe(8,hz,2,0,"button",5)),2&e&&(W(1),re("ngIf",i.materialIcon),W(1),Ze(i.text),W(2),re("ngIf",i.help&&!i.helpHtml),W(1),re("ngIf",i.helpHtml),W(3),re("ngIf",i.type>1))},directives:[gn],pipes:[Yn],styles:[".text[_ngcontent-%COMP%]{font-weight:bolder;white-space:pre-wrap;word-break:break-all}.icon[_ngcontent-%COMP%]{display:inline-block;font-size:2.5rem;vertical-align:middle;margin-right:4px;padding:2px;text-shadow:2px 2px 2px #555}.help[_ngcontent-%COMP%]{font-size:smaller;white-space:pre-wrap;word-break:break-all;margin-bottom:3px}"]}),t})();var _i=(()=>(function(t){t[t.OK=1]="OK",t[t.OK_CANCEL=2]="OK_CANCEL"}(_i||(_i={})),_i))();function pz(t,n){1&t&&nt(0,"badge",12),2&t&&re("count",ge(2).countImagesHasWord(null))("@.disabled",!0)}function gz(t,n){if(1&t){const e=Ye();X(0,"label")(1,"input",25),Ie("ngModelChange",function(r){return ke(e),ge().searchNoTagImage=r})("change",function(){ke(e);const r=ge();return r.searchNoTagImage=!!r.searchNoTagImage}),te(),X(2,"div",26)(3,"s"),be(4,"No Tag"),te(),xe(5,pz,1,2,"badge",27),te()()}if(2&t){const e=ge();W(1),it("checked",e.searchNoTagImage?"checked":""),re("ngModel",e.searchNoTagImage),W(4),re("ngIf",e.countImagesHasWord(null)>0)}}function mz(t,n){if(1&t&&nt(0,"badge",12),2&t){const e=ge().$implicit;re("count",ge().countImagesHasWord(e))("@.disabled",!0)}}function _z(t,n){if(1&t){const e=Ye();X(0,"label")(1,"input",28),Ie("change",function(){const s=ke(e).$implicit;return ge().onSelectedWord(s)}),te(),X(2,"div"),be(3),xe(4,mz,1,2,"badge",27),te()()}if(2&t){const e=n.$implicit,i=ge();W(1),it("value",e),re("checked",i.searchWords.includes(e)),W(2),Ze(e),W(1),re("ngIf",i.countImagesHasWord(e)>0)}}function $z(t,n){1&t&&$n(0)}function vz(t,n){if(1&t&&(X(0,"label",40),be(1),te()),2&t){const e=ge().$implicit;W(1),Ze(e)}}function bz(t,n){1&t&&(X(0,"span",41),be(1,"\u2026"),te())}function yz(t,n){if(1&t&&(Ge(0),xe(1,vz,2,1,"label",38),xe(2,bz,2,0,"span",39),qe()),2&t){const e=n.index;W(1),re("ngIf",e<6),W(1),re("ngIf",6==e)}}function Cz(t,n){if(1&t&&(X(0,"div",37),xe(1,yz,3,2,"ng-container",14),te()),2&t){const e=ge().$implicit,i=ge();W(1),re("ngForOf",i.getTagWords(e))}}function xz(t,n){1&t&&(X(0,"div",37)(1,"s",42),be(2,"No Tag"),te()())}function wz(t,n){1&t&&(X(0,"div",43)(1,"i",44),be(2,"visibility"),te()())}function Ez(t,n){if(1&t){const e=Ye();X(0,"img",45),Ie("click",function(){ke(e);const r=ge().$implicit;return ge().onSelectedFile(r)}),bt(1,"safe"),te()}if(2&t){const e=ge().$implicit;re("src",yt(1,2,e.url,"resourceUrl"),Xt)("alt",e.name)}}function Tz(t,n){1&t&&nt(0,"img",46),2&t&&it("alt",ge().$implicit.name)}const Iz=function(t){return{selected:t}};function Sz(t,n){if(1&t&&(X(0,"div",29)(1,"div",30),xe(2,$z,1,0,"ng-container",31),xe(3,Cz,2,1,"ng-template",null,32,On),xe(5,xz,3,0,"ng-template",null,33,On),te(),xe(7,wz,3,0,"div",34),xe(8,Ez,2,5,"img",35),xe(9,Tz,1,1,"img",36),te()),2&t){const e=n.$implicit,i=Wt(4),r=Wt(6),s=ge();re("@scaleInOut",void 0)("ngClass",ct(8,Iz,s.selected(e))),W(2),re("ngIf",s.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),W(5),re("ngIf",s.getHidden(e)),W(1),re("ngIf",0<e.url.length),W(1),re("ngIf",e.url.length<=0)}}function kz(t,n){if(1&t){const e=Ye();X(0,"label",56),Ie("click",function(){const s=ke(e).$implicit;return ge(3).removeTagWord(s)}),be(1),X(2,"sup",57),be(3,"\xd7"),te()()}if(2&t){const e=n.$implicit;W(1),Ze(e)}}function Mz(t,n){if(1&t&&(Ge(0),xe(1,kz,4,1,"label",55),qe()),2&t){const e=ge(2);W(1),re("ngForOf",e.selectedImagesOwnWords())}}function Dz(t,n){1&t&&(Ge(0),X(1,"span",58)(2,"s"),be(3,"No Tag"),te()(),qe())}function Az(t,n){if(1&t&&(X(0,"option",59),be(1),te()),2&t){const e=n.$implicit;it("value",e),W(1),Ze(e)}}const IT=function(t){return{"red-eye":t}};function Pz(t,n){if(1&t){const e=Ye();X(0,"div",47)(1,"div")(2,"div",48)(3,"button",49),Ie("click",function(){ke(e);const r=ge();return r.setectedImagesToHidden(!r.selectedImagesIsHidden)}),X(4,"i",8),be(5),te()()(),X(6,"button",50),Ie("click",function(){return ke(e),ge().onUnselect()}),be(7),te(),X(8,"input",51),Ie("ngModelChange",function(r){return ke(e),ge().addingTagWord=r}),te(),X(9,"button",52),Ie("click",function(){return ke(e),ge().addTagWord()}),be(10,"\u30bf\u30b0\u8ffd\u52a0 \u27a1"),te(),xe(11,Mz,2,1,"ng-container",13),xe(12,Dz,4,0,"ng-container",13),te(),X(13,"datalist",53),xe(14,Az,2,2,"option",54),te()()}if(2&t){const e=ge();re("@fadeAndUpInOut",void 0),W(3),Rt("title",e.selectedImagesIsHidden?"\u9078\u629e\u753b\u50cf\u3092\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b":"\u9078\u629e\u753b\u50cf\u3092\u975e\u8868\u793a\u8a2d\u5b9a\u306b\u3059\u308b"),W(1),re("ngClass",ct(12,IT,e.selectedImagesIsHidden)),W(1),Ze(e.selectedImagesIsHidden?"visibility":"visibility_off"),W(2),An("\u9078\u629e\u89e3\u9664 (",e.selectedImageFiles.length," \u9078\u629e\u4e2d)"),W(1),n_("list","",e.panelId,"_suggest"),re("ngModel",e.addingTagWord),W(1),re("disabled",null==e.addingTagWord||""===e.addingTagWord.trim()),W(2),re("ngIf",e.selectedImagesOwnWords().length>0),W(1),re("ngIf",0==e.selectedImagesOwnWords().length),W(1),sr("id","",e.panelId,"_suggest"),W(1),re("ngForOf",e.suggestWords())}}const Nz=function(t){return{selecter:t}};let Os=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.deletedWords=[],this.selectedImageFiles=[],this.isSort=!0,this.isShowHideImages=!1}get images(){const e=br.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages),i=e.map(r=>r.identifier);return this.selectedImageFiles=this.selectedImageFiles.filter(r=>i.includes(r.identifier)),this.isSort?br.sortImagesByWords(e,t.sortOrder):e}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?t.sortOrder.unshift(null):t.sortOrder=t.sortOrder.filter(i=>null!=i),t.sortOrder=Array.from(new Set(t.sortOrder)),this._searchNoTagImage=e,Fe.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get isSelected(){let e=this.selectedImageFiles.length>0;return e||(this.addingTagWord=""),e}get selectedImagesIsHidden(){return br.imagesIsHidden(this.selectedImageFiles)}get allImagesOwnWords(){return br.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords,this.panelId=ms.generateUuid()}ngAfterViewInit(){Fe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}allImages(){return br.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return br.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const s=mn.get(r.identifier);null==e?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(e.trim(),!1)&&i++}return i}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Ao.instance.load(r),i.value=""}selected(e){return this.selectedImageFiles.map(i=>i.identifier).includes(e.identifier)}selectedImagesOwnWords(e=!1){return br.imagesOwnWords(this.selectedImageFiles,e)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),t.sortOrder=t.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),t.sortOrder.unshift(e)),t.sortOrder=Array.from(new Set(t.sortOrder)),Fe.trigger("CHANGE_SORT_ORDER",e))}onSelectedFile(e){this.selected(e)?this.selectedImageFiles=this.selectedImageFiles.filter(i=>i.identifier!==e.identifier):this.selectedImageFiles.push(e)}getTagWords(e){const i=mn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=mn.get(e.identifier);return!!i&&i.hide}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onUnselect(){this.selectedImageFiles=[]}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:_i.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}setectedImagesToHidden(e){this.modalService.open(qi,{title:e?"\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664",text:`\u753b\u50cf${e?"\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a":"\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664"}\u3057\u307e\u3059\u304b\uff1f`,help:e?"\u9078\u629e\u3057\u305f\u753b\u50cf\u3092\u975e\u8868\u793a\u306b\u8a2d\u5b9a\u3057\u307e\u3059\u3002\n\u3053\u308c\u306f\u300c\u610f\u56f3\u305b\u305a\u306b\u30cd\u30bf\u30d0\u30ec\u3092\u898b\u3066\u3057\u307e\u3046\u300d\u3053\u3068\u306a\u3069\u3092\u9632\u3050\u3082\u306e\u3067\u3042\u308a\u3001\u4ed6\u8005\u304b\u3089\u5b8c\u5168\u306b\u96a0\u3059\u3082\u306e\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002":"\u9078\u629e\u3057\u305f\u753b\u50cf\u306e\u975e\u8868\u793a\u8a2d\u5b9a\u3092\u89e3\u9664\u3057\u307e\u3059\u3002",type:_i.OK_CANCEL,materialIcon:e?"visibility_off":"visibility",action:()=>{for(const i of this.selectedImageFiles){const r=mn.get(i.identifier)||mn.create(i.identifier);r.hide=e,Fe.call("OPERATE_IMAGE_TAGS",r.identifier)}}})}addTagWord(){if(null==this.addingTagWord||""==this.addingTagWord.trim())return;const e=this.addingTagWord.trim().split(/\s+/);this.modalService.open(qi,{title:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0",text:"\u753b\u50cf\u306b\u30bf\u30b0\u3092\u8ffd\u52a0\u3057\u307e\u3059\u304b\uff1f",helpHtml:"\u9078\u629e\u3057\u305f\u753b\u50cf\u306b "+e.map(i=>`<b class="word-tag">${et.escapeHtml(i)}</b>`).join(" ")+" \u3092\u8ffd\u52a0\u3057\u307e\u3059\u3002",type:_i.OK_CANCEL,materialIcon:"sell",action:()=>{let i=null;for(const r of this.selectedImageFiles)i=(mn.get(r.identifier)||mn.create(r.identifier)).addWords(e);i&&(this.serchCondIsOr&&this.searchWords.push(...i),t.sortOrder.unshift(...i)),this.serchCondIsOr&&(this.searchWords=Array.from(new Set(this.searchWords)).sort()),t.sortOrder=Array.from(new Set(t.sortOrder)),Fe.trigger("CHANGE_SORT_ORDER",i),this.addingTagWord=""}})}removeTagWord(e){this.modalService.open(qi,{title:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664",text:"\u753b\u50cf\u304b\u3089\u30bf\u30b0\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`\u9078\u629e\u3057\u305f\u753b\u50cf\u304b\u3089 <b class="word-tag">${et.escapeHtml(e)}</b> \u3092\u524a\u9664\u3057\u307e\u3059\u3002`,type:_i.OK_CANCEL,materialIcon:"sell",action:()=>{if(null==e||""==e.trim())return;for(const r of this.selectedImageFiles){let s=mn.get(r.identifier);s&&s.removeWords(e)}const i=this.allImagesOwnWords;this.searchWords=this.searchWords.filter(r=>i.includes(r)),this.deletedWords.push(e),this.deletedWords=Array.from(new Set(this.deletedWords)),Fe.trigger("CHANGE_SORT_ORDER",this.deletedWords)}})}identify(e,i){return i.identifier}suggestWords(){const e=this.selectedImagesOwnWords(!0);return Array.from(new Set(this.allImagesOwnWords.concat(this.deletedWords))).filter(i=>0!==i.indexOf("*")&&!e.includes(i))}}return t.sortOrder=[],t.\u0275fac=function(e){return new(e||t)(Oe(Di),Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["file-storage"]],decls:41,vars:19,consts:[[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","image/*",2,"display","none",3,"change"],[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"padding-top","3px",3,"ngClass"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative;",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["class","sticky-bottom",4,"ngIf"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"margin-right","2px","font-size","16px","display","block"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"],[1,"sticky-bottom"],[2,"margin-left","3px","float","right"],[2,"padding","2px 0.5em",3,"click"],[2,"font-size","x-small","margin-right","2em",3,"click"],["type","text","placeholder","\u30b9\u30da\u30fc\u30b9 \u533a\u5207\u308a\u3067 \u8907\u6570\u53ef\u80fd",2,"width","14em",3,"ngModel","ngModelChange"],[2,"font-size","x-small",3,"disabled","click"],[3,"id"],[3,"value",4,"ngFor","ngForOf"],["class","word-tag","style","cursor: pointer; font-size: smaller",3,"click",4,"ngFor","ngForOf"],[1,"word-tag",2,"cursor","pointer","font-size","smaller",3,"click"],[2,"font-size","xx-small","color","red"],[2,"font-size","smaller","font-weight","bolder","margin-left","3px","color","gray"],[3,"value"]],template:function(e,i){1&e&&(X(0,"label")(1,"div",0)(2,"div")(3,"i",1),be(4,"add_photo_alternate"),te()(),X(5,"div"),be(6,"\u3053\u3053\u306b\u753b\u50cf\u3092\u30c9\u30ed\u30c3\u30d7"),te(),X(7,"div",2),be(8,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),te(),X(9,"input",3),Ie("change",function(s){return i.handleFileSelect(s)}),te(),X(10,"div",2),nt(11,"br"),be(12,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d2MB\u307e\u3067"),te()()(),X(13,"div",4)(14,"div",5)(15,"label",6)(16,"input",7),Ie("click",function(s){return i.onShowHiddenImages(s)}),te(),X(17,"i",8),be(18),te()()(),X(19,"span",9)(20,"label")(21,"input",10),Ie("click",function(){return i.onSearchAllImage()}),te(),X(22,"div",11)(23,"b"),be(24,"ALL"),te(),nt(25,"badge",12),te()(),xe(26,gz,6,3,"label",13),xe(27,_z,5,4,"label",14),te(),X(28,"span",15)(29,"select",16),Ie("ngModelChange",function(s){return i.serchCondIsOr=s}),X(30,"option",17),be(31,"\u3044\u305a\u308c\u304b (OR)"),te(),X(32,"option",18),be(33,"\u3059\u3079\u3066 (AND)"),te()(),X(34,"label",19)(35,"input",20),Ie("ngModelChange",function(s){return i.isSort=s})("change",function(){return i.isSort=!!i.isSort}),te(),X(36,"b",21),be(37,"\u30bd\u30fc\u30c8"),te()()()(),X(38,"div",22),xe(39,Sz,10,10,"div",23),te(),xe(40,Pz,15,14,"div",24)),2&e&&(W(16),it("checked",i.isShowHideImages?"checked":""),W(1),re("ngClass",ct(15,IT,i.isShowHideImages)),W(1),Ze(i.isShowHideImages?"visibility":"visibility_off"),W(3),it("checked",i.searchAllImage?"checked":""),W(4),re("count",i.images.length)("@.disabled",!0),W(1),re("ngIf",i.countAllImagesHasWord(null)>0),W(1),re("ngForOf",i.allImagesOwnWords),W(2),re("ngModel",i.serchCondIsOr),W(6),it("checked",i.isSort?"checked":""),re("ngModel",i.isSort),W(3),re("ngClass",ct(17,Nz,i.isSelected)),W(1),re("ngForOf",i.images)("ngForTrackBy",i.identify),W(1),re("ngIf",i.isSelected))},directives:[jn,kd,gn,Yr,oi,ei,Jn,Zr,Rr,Or,si],pipes:[Yn],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-right:-2px;cursor:pointer}.image[_ngcontent-%COMP%]:hover{border:2px dotted red;transform:scale(1.08);z-index:150;transition-duration:60ms}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image.selected[_ngcontent-%COMP%]{border:2px solid red}.selecter[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]:not(.selected)   img[_ngcontent-%COMP%]{filter:saturate(40%) opacity(90%) blur(2px)}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;background-color:#f0dabde6;border-bottom:1px dotted #666;z-index:100}.sticky-bottom[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;bottom:0;background-color:#f0dabde6;border-top:1px dotted #666;z-index:200}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}'],data:{animation:[yn("scaleInOut",[Nt("void => *",[Dt("200ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt("180ms ease",We({transform:"scale3d(0, 0, 0)"}))])]),yn("fadeAndUpInOut",[Nt("void => *",[Dt("100ms ease-in-out",Qt([We({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}),We({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})]))]),Nt("* => void",[Dt("100ms ease-in-out",We({"transform-origin":"center bottom",transform:"translateY(0px) scaleY(1.0)",opacity:1})),Dt("100ms ease-in-out",We({"transform-origin":"center bottom",transform:"translateY(8px) scaleY(0)",opacity:.6}))])])]},changeDetection:0}),t})();function Fz(t,n){1&t&&nt(0,"badge",8),2&t&&re("count",ge(2).countImagesHasWord(null))("@.disabled",!0)}function Rz(t,n){if(1&t){const e=Ye();X(0,"label")(1,"input",21),Ie("ngModelChange",function(r){return ke(e),ge().searchNoTagImage=r})("change",function(){ke(e);const r=ge();return r.searchNoTagImage=!!r.searchNoTagImage}),te(),X(2,"div",22)(3,"s"),be(4,"No Tag"),te(),xe(5,Fz,1,2,"badge",23),te()()}if(2&t){const e=ge();W(1),it("checked",e.searchNoTagImage?"checked":""),re("ngModel",e.searchNoTagImage),W(4),re("ngIf",e.countImagesHasWord(null)>0)}}function Oz(t,n){if(1&t&&nt(0,"badge",8),2&t){const e=ge().$implicit;re("count",ge().countImagesHasWord(e))("@.disabled",!0)}}function Bz(t,n){if(1&t){const e=Ye();X(0,"label")(1,"input",24),Ie("change",function(){const s=ke(e).$implicit;return ge().onSelectedWord(s)}),te(),X(2,"div"),be(3),xe(4,Oz,1,2,"badge",23),te()()}if(2&t){const e=n.$implicit,i=ge();W(1),it("value",e),re("checked",i.searchWords.includes(e)),W(2),Ze(e),W(1),re("ngIf",i.countImagesHasWord(e)>0)}}function Lz(t,n){if(1&t){const e=Ye();X(0,"span",25)(1,"button",26),Ie("click",function(){ke(e);const r=ge();return r.onSelectedFile(r.empty)}),be(2,"\u753b\u50cf\u306a\u3057"),nt(3,"br"),be(4,"/\u8a2d\u5b9a\u89e3\u9664"),te()()}}function zz(t,n){1&t&&$n(0)}function jz(t,n){if(1&t&&(X(0,"label",39),be(1),te()),2&t){const e=ge().$implicit;W(1),Ze(e)}}function Uz(t,n){1&t&&(X(0,"span",40),be(1,"\u2026"),te())}function Hz(t,n){if(1&t&&(Ge(0),xe(1,jz,2,1,"label",37),xe(2,Uz,2,0,"span",38),qe()),2&t){const e=n.index;W(1),re("ngIf",e<6),W(1),re("ngIf",6==e)}}function Vz(t,n){if(1&t&&(X(0,"div",36),xe(1,Hz,3,2,"ng-container",10),te()),2&t){const e=ge().$implicit,i=ge();W(1),re("ngForOf",i.getTagWords(e))}}function Gz(t,n){1&t&&(X(0,"div",36)(1,"s",41),be(2,"No Tag"),te()())}function qz(t,n){1&t&&(X(0,"div",42)(1,"i",43),be(2,"visibility"),te()())}function Wz(t,n){1&t&&(X(0,"div",44)(1,"b",45),be(2,"\u8a2d\u5b9a\u4e2d"),te()())}function Kz(t,n){if(1&t){const e=Ye();X(0,"img",46),Ie("click",function(){ke(e);const r=ge().$implicit,s=ge();return!s.getCurrent(r)&&s.onSelectedFile(r)}),bt(1,"safe"),te()}if(2&t){const e=ge().$implicit;re("src",yt(1,2,e.url,"resourceUrl"),Xt)("alt",e.name)}}function Yz(t,n){1&t&&nt(0,"img",47),2&t&&it("alt",ge().$implicit.name)}const Zz=function(t){return{"current-images":t}};function Xz(t,n){if(1&t&&(X(0,"div",27)(1,"div",28),xe(2,zz,1,0,"ng-container",29),xe(3,Vz,2,1,"ng-template",null,30,On),xe(5,Gz,3,0,"ng-template",null,31,On),te(),xe(7,qz,3,0,"div",32),xe(8,Wz,3,0,"div",33),xe(9,Kz,2,5,"img",34),xe(10,Yz,1,1,"img",35),te()),2&t){const e=n.$implicit,i=Wt(4),r=Wt(6),s=ge();re("@scaleInOut",void 0)("ngClass",ct(9,Zz,s.getCurrent(e))),W(2),re("ngIf",s.getTagWords(e).length>0)("ngIfThen",i)("ngIfElse",r),W(5),re("ngIf",s.getHidden(e)),W(1),re("ngIf",s.getCurrent(e)),W(1),re("ngIf",0<e.url.length),W(1),re("ngIf",e.url.length<=0)}}const Qz=function(t){return{"red-eye":t}};let Po=(()=>{class t{constructor(e,i,r){this.changeDetector=e,this.panelService=i,this.modalService=r,this.isAllowedEmpty=!1,this.currentImageIdentifires=[],this._searchNoTagImage=!0,this.serchCondIsOr=!0,this.addingTagWord="",this.searchWords=[],this.isSort=!0,this.isShowHideImages=!1,this.isAllowedEmpty=!(!this.modalService.option||!this.modalService.option.isAllowedEmpty),this.modalService.option&&this.modalService.option.currentImageIdentifires&&(this.currentImageIdentifires=this.modalService.option.currentImageIdentifires)}get images(){const e=br.searchImages(this.searchWords,this.searchNoTagImage&&this.countAllImagesHasWord(null)>0,this.serchCondIsOr,this.isShowHideImages);return this.isSort?br.sortImagesByWords(e,Os.sortOrder).sort((i,r)=>this.getCurrent(i)?this.getCurrent(r)?0:-1:this.getCurrent(r)?1:0):e}get empty(){return Lt.Empty}get searchNoTagImage(){return this._searchNoTagImage}set searchNoTagImage(e){e?Os.sortOrder.unshift(null):Os.sortOrder=Os.sortOrder.filter(i=>null!=i),Os.sortOrder=Array.from(new Set(Os.sortOrder)),this._searchNoTagImage=e,Fe.trigger("CHANGE_SORT_ORDER",null)}get searchAllImage(){if(!this.searchNoTagImage&&this.countAllImagesHasWord(null)>0)return!1;for(const e of this.allImagesOwnWords)if(!this.searchWords.includes(e))return!1;return!0}get allImagesOwnWords(){return br.allImagesOwnWords(this.isShowHideImages)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30d5\u30a1\u30a4\u30eb\u4e00\u89a7"),this.searchWords=this.allImagesOwnWords}ngAfterViewInit(){Fe.register(this).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("OPERATE_IMAGE_TAGS",e=>{this.changeDetector.markForCheck()}).on("CHANGE_SORT_ORDER",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}allImages(){return br.allImages(this.isShowHideImages)}countAllImagesHasWord(e){return br.countAllImagesHasWord(e,this.isShowHideImages)}countImagesHasWord(e){let i=0;if(null!=e&&""===e.trim())return i;for(const r of this.images){const s=mn.get(r.identifier);null==e?(!s||null==s.tag||""==s.tag.trim())&&i++:s&&s.containsWords(e.trim(),!1)&&i++}return i}getTagWords(e){const i=mn.get(e.identifier);return i?i.words:[]}getHidden(e){const i=mn.get(e.identifier);return!!i&&i.hide}getCurrent(e){return!!this.currentImageIdentifires&&this.currentImageIdentifires.includes(e.identifier)}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:_i.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}onSelectedFile(e){this.modalService.resolve(e.identifier)}onSearchAllImage(){this.searchAllImage?(this.searchWords=[],this._searchNoTagImage=!1):(this.searchWords=this.allImagesOwnWords,this._searchNoTagImage=!0)}onSelectedWord(e){null==e||""===e.trim()||(this.searchWords.includes(e)?(this.searchWords=this.searchWords.filter(i=>e!==i),Os.sortOrder=Os.sortOrder.filter(i=>e!==i)):(this.searchWords.push(e),Os.sortOrder.unshift(e)),Os.sortOrder=Array.from(new Set(Os.sortOrder)),Fe.trigger("CHANGE_SORT_ORDER",e))}cancel(){this.modalService.resolve(!1)}identify(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(Oe(Di),Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["file-selector"]],inputs:{isAllowedEmpty:"isAllowedEmpty",currentImageIdentifires:"currentImageIdentifires"},decls:28,vars:16,consts:[[1,"sticky-top"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[1,"word-selecter"],["name","word-selecter","type","checkbox","value","ALL",3,"checked","click"],[1,"all-tags"],[1,"badge",3,"count"],[4,"ngIf"],[4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"margin-left","3px",3,"ngModel","ngModelChange"],["value","true"],["value",""],["sytle","white-space: nowrap","title","\u6700\u8fd1\u4f7f\u3063\u305f\u30bf\u30b0\u306e\u753b\u50cf\u3092\u524d\u306b"],["name","is-sort","value","Sort","type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller","margin-right","3px"],["id","file-list",2,"min-height","250px","margin-left","1px","padding-top","3px"],["class","empty","style","display: inline-block;",4,"ngIf"],["class","image","style","text-align: center; min-width: 100px; height: 120px; position: relative",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],["name","word-selecter","type","checkbox","value","No Tag",3,"ngModel","checked","ngModelChange","change"],[1,"no-tag"],["class","badge",3,"count",4,"ngIf"],["name","word-selecter","type","checkbox",3,"value","checked","change"],[1,"empty",2,"display","inline-block"],[2,"min-width","100px","margin-left","-1px","margin-right","3px",3,"click"],[1,"image",2,"text-align","center","min-width","100px","height","120px","position","relative",3,"ngClass"],[2,"position","absolute","font-size","xx-small","text-align","left","bottom","0px","width","100%","height","100%","overflow","hidden","pointer-events","none"],[4,"ngIf","ngIfThen","ngIfElse"],["tagsBlock",""],["noTagBlock",""],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 0px; left: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"src","alt","click",4,"ngIf"],["src","assets/images/loading.gif",3,"alt",4,"ngIf"],[2,"position","absolute","bottom","0px","z-index","5"],["class","word-tag grow","style","display: block; width: 88px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],["class","grow","style","display: block; width: 88px; overflow: hidden; padding-left: 2px; font-weight: bold; text-overflow: ellipsis; white-space: nowrap; pointer-events: none",4,"ngIf"],[1,"word-tag","grow",2,"display","block","width","88px","overflow","hidden","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"display","block","width","88px","overflow","hidden","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[1,"grow",2,"color","gray","display","block","padding-left","2px","font-weight","bold","text-overflow","ellipsis","white-space","nowrap","pointer-events","none"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons","red-eye",2,"z-index","5","margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","0px","left","0px","pointer-events","none","z-index","5"],[1,"grow",2,"font-size","13px","color","red","padding-left","2px"],["height","120",3,"src","alt","click"],["src","assets/images/loading.gif",3,"alt"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"label",2)(3,"input",3),Ie("click",function(s){return i.onShowHiddenImages(s)}),te(),X(4,"i",4),be(5),te()()(),X(6,"span",5)(7,"label")(8,"input",6),Ie("click",function(){return i.onSearchAllImage()}),te(),X(9,"div",7)(10,"b"),be(11,"ALL"),te(),nt(12,"badge",8),te()(),xe(13,Rz,6,3,"label",9),xe(14,Bz,5,4,"label",10),te(),X(15,"span",11)(16,"select",12),Ie("ngModelChange",function(s){return i.serchCondIsOr=s}),X(17,"option",13),be(18,"\u3044\u305a\u308c\u304b (OR)"),te(),X(19,"option",14),be(20,"\u3059\u3079\u3066 (AND)"),te()(),X(21,"label",15)(22,"input",16),Ie("ngModelChange",function(s){return i.isSort=s})("change",function(){return i.isSort=!!i.isSort}),te(),X(23,"b",17),be(24,"\u30bd\u30fc\u30c8"),te()()()(),X(25,"div",18),xe(26,Lz,5,0,"span",19),xe(27,Xz,11,11,"div",20),te()),2&e&&(W(3),it("checked",i.isShowHideImages?"checked":""),W(1),re("ngClass",ct(14,Qz,i.isShowHideImages)),W(1),Ze(i.isShowHideImages?"visibility":"visibility_off"),W(3),it("checked",i.searchAllImage?"checked":""),W(4),re("count",i.images.length)("@.disabled",!0),W(1),re("ngIf",i.countAllImagesHasWord(null)>0),W(1),re("ngForOf",i.allImagesOwnWords),W(2),re("ngModel",i.serchCondIsOr),W(6),it("checked",i.isSort?"checked":""),re("ngModel",i.isSort),W(4),re("ngIf",i.isAllowedEmpty),W(1),re("ngForOf",i.images)("ngForTrackBy",i.identify))},directives:[jn,kd,gn,Yr,oi,ei,Jn,Zr,Rr,Or],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{font-size:0;display:inline-block;border:2px solid transparent;margin-left:-2px}.image[_ngcontent-%COMP%]:not(.current-images){cursor:pointer}.image[_ngcontent-%COMP%]:not(.current-images):hover{border:2px dotted red;transform:scale(1.08);z-index:200;transition-duration:60ms}.current-images[_ngcontent-%COMP%]{border:2px solid red}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;transition-duration:.12s}.image[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{-webkit-backdrop-filter:blur(1px);backdrop-filter:blur(1px);filter:none!important}.empty[_ngcontent-%COMP%]{line-height:120px;vertical-align:top}.empty[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{height:120px;margin:1px;box-sizing:border-box;vertical-align:top}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.sticky-top[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;background-color:#f0dabde6;border-top:1px dotted #666;border-bottom:1px dotted #666;z-index:100}.word-tag[_ngcontent-%COMP%]{margin-right:3px;display:inline-block;color:#000;font-weight:bolder}.word-tag[_ngcontent-%COMP%]:hover{color:red}.word-selecter[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.word-selecter[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{display:none}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.word-selecter[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div.all-tags[_ngcontent-%COMP%]{background-color:#eee;color:#008b8b}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}"],data:{animation:[yn("scaleInOut",[Nt("void => *",[Dt("200ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt("180ms ease",We({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function q0(t,n=[]){let e=rt.instance.getObjects(t.aliasName);n.forEach(s=>e=e.concat(rt.instance.getObjects(s))),e=e.filter(s=>s.isVisibleOnTable);let i=-1,r=!1;for(let s=0;s<e.length;s++)i===e[s].zindex?r=!0:i<e[s].zindex&&(i=e[s].zindex,r=!1);if((i!==t.zindex||r)&&(t.zindex=i+1,!(t.zindex<e.length+256))){e.sort((s,o)=>s.zindex-o.zindex);for(let s=0;s<e.length;s++)e[s].zindex=s}}var Vp,$s=(()=>(function(t){t[t.FRONT=0]="FRONT",t[t.BACK=1]="BACK"}($s||($s={})),$s))();let Fn=Vp=class extends mi{constructor(){super(...arguments),this.state=$s.FRONT,this.rotate=0,this.owner="",this.zindex=0,this.isLocked=!1}get isVisibleOnTable(){return"table"===this.location.name&&(!this.parentIsAssigned||this.parentIsDestroyed)}get name(){return this.getCommonValue("name","")}get size(){return this.getCommonValue("size",2)}set size(n){this.setCommonValue("size",n)}get frontImage(){return this.getImageFile("front")}get backImage(){return this.getImageFile("back")}get imageFile(){return this.isVisible?this.frontImage:this.backImage}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(dt.create("fontsize",18,{},"fontsize_"+this.identifier)),n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(dt.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){return this.getCommonValue("color","#555555")}set color(n){this.setCommonValue("color",n)}get ownerName(){let n=He.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=He.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get isHand(){return vt.peerContext.userId===this.owner}get isFront(){return this.state===$s.FRONT}get isVisible(){return this.isHand||this.isFront}faceUp(){this.state=$s.FRONT,this.owner=""}faceDown(){this.state=$s.BACK,this.owner=""}toTopmost(){q0(this,["card-stack"])}static create(n,e,i,r=2,s){let o=null;return o=s?new Vp(s):new Vp,o.createDataElements(),o.commonDataElement.appendChild(dt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(dt.create("size",r,{},"size_"+o.identifier)),o.imageDataElement.appendChild(dt.create("front",e,{type:"image"},"front_"+o.identifier)),o.imageDataElement.appendChild(dt.create("back",i,{type:"image"},"back_"+o.identifier)),o.commonDataElement.appendChild(dt.create("fontsize",18,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(dt.create("text","",{type:"note",currentValue:""},"text_"+o.identifier)),o.commonDataElement.appendChild(dt.create("color","#555555",{type:"color"},"ccolor_"+o.identifier)),o.initialize(),o}};var Gp;B([st()],Fn.prototype,"state",void 0),B([st()],Fn.prototype,"rotate",void 0),B([st()],Fn.prototype,"owner",void 0),B([st()],Fn.prototype,"zindex",void 0),B([st()],Fn.prototype,"isLocked",void 0),Fn=Vp=B([Kn("card")],Fn);let Un=Gp=class extends mi{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.owner="",this.isShowTotal=!0,this.isLocked=!1}get name(){return this.getCommonValue("name","")}get ownerName(){let n=He.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=He.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get cardRoot(){for(let n of this.children)if("cardRoot"===n.getAttribute("name"))return n;return null}get cards(){return this.cardRoot?this.cardRoot.children:[]}get topCard(){return this.isEmpty?null:this.cards[0]}get isEmpty(){return this.cards.length<1}get imageFile(){return this.topCard?this.topCard.imageFile:null}onChildRemoved(n){super.onChildRemoved(n),n instanceof Fn&&Fe.trigger("CARD_STACK_DECREASED",{cardStackIdentifier:this.identifier,cardIdentifier:n.identifier})}shuffle(){if(!this.cardRoot)return;let n=this.cardRoot.children.length;for(let e of this.cards)e.index=Math.random()*n,e.rotate=180*Math.floor(2*Math.random()),this.setSamePositionFor(e);return this.cards}drawCard(){let n=this.topCard?this.cardRoot.removeChild(this.topCard):null;return n&&(n.rotate+=this.rotate,360<n.rotate&&(n.rotate-=360),this.setSamePositionFor(n),n.toTopmost()),n}drawCardAll(){let n=this.cards;for(let e of n)this.cardRoot.removeChild(e),e.rotate+=this.rotate,this.setSamePositionFor(e),360<e.rotate&&(e.rotate-=360);return n}faceUp(){this.topCard&&(this.topCard.faceUp(),this.setSamePositionFor(this.topCard))}faceDown(){this.topCard&&(this.topCard.faceDown(),this.setSamePositionFor(this.topCard))}faceUpAll(){for(let n of this.cards)n.faceUp(),this.setSamePositionFor(n)}faceDownAll(){for(let n of this.cards)n.faceDown(),this.setSamePositionFor(n)}uprightAll(){for(let n of this.cards)n.rotate=0,this.setSamePositionFor(n)}inverse(){const n=[];for(;;){let e=this.topCard?this.cardRoot.removeChild(this.topCard):null;if(null==e)break;n.unshift(e),e.state=e.state==$s.FRONT?$s.BACK:$s.FRONT}for(let e of n)this.putOnBottom(e)}unifyCardsSize(n){for(const e of this.cards)e.size!==n&&(e.size=n)}putOnTop(n){if(!this.cardRoot)return null;if(!this.topCard)return this.putOnBottom(n);n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.insertBefore(n,this.topCard)}putOnBottom(n){if(!this.cardRoot)return null;n.owner="",n.zindex=0;let e=Math.abs(n.rotate-this.rotate);return 180<e&&(e=360-e),n.rotate=e<=90?0:180,this.setSamePositionFor(n),this.cardRoot.appendChild(n)}toTopmost(){q0(this,["card"])}setLocation(n){super.setLocation(n);let e=this.cards;for(let i of e)i.setLocation(n)}setSamePositionFor(n){n.location.name=this.location.name,n.location.x=this.location.x,n.location.y=this.location.y,n.posZ=this.posZ}static create(n,e){let i=null;i=e?new Gp(e):new Gp,i.createDataElements(),i.commonDataElement.appendChild(dt.create("name",n,{},"name_"+i.identifier));let r=new Ln("cardRoot_"+i.identifier);return r.setAttribute("name","cardRoot"),r.initialize(),i.appendChild(r),i.initialize(),i}};B([st()],Un.prototype,"rotate",void 0),B([st()],Un.prototype,"zindex",void 0),B([st()],Un.prototype,"owner",void 0),B([st()],Un.prototype,"isShowTotal",void 0),B([st()],Un.prototype,"isLocked",void 0),Un=Gp=B([Kn("card-stack")],Un);var qp,wi=(()=>(function(t){t[t.D2=0]="D2",t[t.D4=1]="D4",t[t.D6=2]="D6",t[t.D8=3]="D8",t[t.D10=4]="D10",t[t.D10_10TIMES=5]="D10_10TIMES",t[t.D12=6]="D12",t[t.D20=7]="D20"}(wi||(wi={})),wi))();let tr=qp=class extends mi{constructor(){super(...arguments),this.face="0",this.owner="",this.rotate=0,this.isDropShadow=!0,this.isLock=!1}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get size(){return this.getCommonValue("size",1)}set size(n){this.setCommonValue("size",n)}get faces(){return this.imageDataElement?this.imageDataElement.children.filter(n=>"nothing"!=n.currentValue).map(n=>n.name):[]}get imageFile(){return this.isVisible?this.getImageFile(this.face):this.faces.length?this.getImageFile(this.faces[0]):null}get backFaceImageFile(){return this.isCoin?this.getImageFile(this.isVisible?"\u8868"==this.face?"\u88cf":"\u8868":this.faces[1]):this.imageFile}get nothingFaces(){return this.imageDataElement.children.filter(n=>"nothing"==n.currentValue).map(n=>n.name)}get ownerName(){let n=He.findByUserId(this.owner);return n?n.name:""}get ownerColor(){let n=He.findByUserId(this.owner);return n?n.color:"#444444"}get hasOwner(){return 0<this.owner.length}get isMine(){return vt.peerContext.userId===this.owner}get isVisible(){return!this.hasOwner||this.isMine||this.isGMMode}get isCoin(){return 2===this.faces.length}diceRoll(){let n=this.faces;return this.face=0<n.length?n[Math.floor(Math.random()*n.length)]:"",this.face}setDicetype(n){this.makeDiceFace(n)}makeDiceFace(n,e){let i=1,r=[],s=o=>o+1+"";switch(n){case wi.D2:i=2,s=d=>0===d?"\u8868":"\u88cf";break;case wi.D4:i=4;break;case wi.D6:i=6,r.push(dt.create("\u306a\u3057","",{type:"image",currentValue:"nothing"},null!=e?"nothing_"+e:null));break;case wi.D8:i=8;break;case wi.D10_10TIMES:s=d=>d+1+"0";case wi.D10:i=10;break;case wi.D12:i=12;break;case wi.D20:i=20;break;default:i=2}for(let o=0;o<i;o++){let d=s(o);r.push(dt.create(d,"",{type:"image"},null!=e?d+"_"+e:null))}return this.imageDataElement.children.forEach(o=>o.destroy()),r.forEach(o=>this.imageDataElement.appendChild(o)),this.face=this.faces[0],r}static create(n,e,i,r){let s=r?new qp(r):new qp;return s.createDataElements(),s.commonDataElement.appendChild(dt.create("name",n,{},"name_"+s.identifier)),s.commonDataElement.appendChild(dt.create("size",i,{},"size_"+s.identifier)),s.makeDiceFace(e,s.identifier),s.initialize(),s}};var W0;B([st()],tr.prototype,"face",void 0),B([st()],tr.prototype,"owner",void 0),B([st()],tr.prototype,"rotate",void 0),B([st()],tr.prototype,"isDropShadow",void 0),B([st()],tr.prototype,"isLock",void 0),tr=qp=B([Kn("dice-symbol")],tr);let Hn=W0=class extends Ln{constructor(){super(...arguments),this.toName="",this.toImageIdentifier="",this.toColor="",this.aura=-1,this.lastUpdate=0,this.isAnimated=!1,this._sendTo=[],this._tags=[],this.locale="en-US"}get tabIdentifier(){return this.parent.identifier}get text(){return this.value}set text(n){this.value=null==n?"":n}get timestamp(){let n=this.getAttribute("timestamp"),e=n?+n:0;return Number.isNaN(e)?1:e}get sendTo(){return this._to!==this.to&&(this._to=this.to,this._sendTo=null!=this.to&&0<this.to.trim().length?this.to.trim().split(/\s+/):[]),this._sendTo}get isEdited(){return this.lastUpdate>0}get tags(){return this._tag!==this.tag&&(this._tag=this.tag,this._tags=null!=this.tag&&0<this.tag.trim().length?this.tag.trim().split(/\s+/):[]),this._tags}get image(){return It.instance.get(this.imageIdentifier)}get toImage(){return It.instance.get(this.toImageIdentifier)}get index(){return this.minorIndex+this.timestamp}get isDirect(){return 0<this.sendTo.length||-1<this.tags.indexOf("direct")}get isSendFromSelf(){return this.from===vt.peerContext.userId||this.originFrom===vt.peerContext.userId||-1<this.tags.indexOf("mine")}get isRelatedToMe(){return-1<this.sendTo.indexOf(vt.peerContext.userId)||this.isSendFromSelf||this.isGMMode}get isDisplayable(){return!this.isDirect||this.isRelatedToMe}get isSystem(){return-1<this.tags.indexOf("system")}get isDicebot(){return this.isSystem&&this.from.indexOf("Dice")>=0&&!/^C\(.+\) \u2192/i.test(this.text)}get isCalculate(){return this.isSystem&&this.from.indexOf("Dice")>=0&&/^C\(.+\) \u2192/i.test(this.text)}get isSecret(){return-1<this.tags.indexOf("secret")}get isEmptyDice(){return!this.isDicebot||-1<this.tags.indexOf("empty")}get isSpecialColor(){return this.isDirect||this.isSecret||this.isSystem||this.isOperationLog||this.isDicebot||this.isCalculate}get isEditable(){return!this.isSystem&&!this.isOperationLog&&this.from===vt.peerContext.userId}get isFaceIcon(){return!this.isSystem&&(!this.characterIdentifier||this.tags.indexOf("noface")<0)}get isOperationLog(){return-1<this.tags.indexOf("opelog")}get isSuccess(){return this.isDicebot&&-1<this.tags.indexOf("success")}get isFailure(){return this.isDicebot&&-1<this.tags.indexOf("failure")}get isCritical(){return this.isDicebot&&-1<this.tags.indexOf("critical")}get isFumble(){return this.isDicebot&&-1<this.tags.indexOf("fumble")}get isGMMode(){return!!He.myCursor&&He.myCursor.isGMMode}logFragment(n,e=null,i="HH:mm",r=!0){return 0==n?this.logFragmentText(e,i):this.logFragmentHtml(e,i,2!=n)}logFragmentText(n=null,e="HH:mm"){n=n&&""!=n.trim()?`[${n}] `:"";const i=""==e?"":gd(new Date(this.timestamp),e,this.locale)+"\uff1a",r=this.isEdited?""==e?" (\u7de8\u96c6\u6e08)":` (\u7de8\u96c6\u6e08 ${gd(new Date(this.lastUpdate),e,this.locale)})`:"";let s=et.rubyToText(this.text);return this.isDicebot&&(s=s.replace(/###(.+?)###/g,"*$1").replace(/\~\~\~(.+?)\~\~\~/g,"~$1")),s.lastIndexOf("\n")==s.length-1&&!r&&(s+="\n"),`${n}${i}${this.name}${this.toColor?" \u27a1 "+this.toName:""}\uff1a${this.isSecret&&!this.isSendFromSelf?"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09":s+r}`}logFragmentHtml(n=null,e="HH:mm",i=!0){const r=et.escapeHtml(this.color?this.color:He.CHAT_DEFAULT_COLOR),s=` style="color: ${r}"`,o=this.toColor?et.escapeHtml(this.toColor):"",d=this.toColor?` style="color: ${o}"`:"",$=this.isDirect||this.isSecret?' class="grow"':"",I=n&&""!=n.trim()?`<span class="tab-name">${et.escapeHtml(n)}</span> `:"",Q=new Date(this.timestamp),fe=""==e?"":`<time datetime="${Q.toISOString()}">${et.escapeHtml(gd(Q,e,this.locale))}</time>\uff1a`,_e=`<span${$}${s}>${et.escapeHtml(this.name)}</span>`+(this.toColor?` \u27a1 <span${$}${d}>${et.escapeHtml(this.toName)}</span>`:"");let Ce=["message"];(this.isDirect||this.isSecret)&&Ce.push("direct-message"),this.isSystem&&Ce.push("system-message"),(this.isDicebot||this.isCalculate)&&Ce.push("dicebot-message"),this.isOperationLog&&Ce.push("operation-log");let Ee=["msg-text"];(!this.isSecret||this.isSendFromSelf)&&(this.isSuccess&&Ee.push("is-success"),this.isFailure&&Ee.push("is-failure"),this.isCritical&&Ee.push("is-critical"),this.isFumble&&Ee.push("is-fumble"));let Re=this.isSecret&&!this.isSendFromSelf?"<s>\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09</s>":CT.link(this.isOperationLog?et.escapeHtml(this.text):et.rubyToHtml(et.escapeHtml(this.text)),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:96,location:"end"},decodePercentEncoding:!1,stripPrefix:!1,stripTrailingSlash:!1,email:!1,phone:!1,className:"outer-link",replaceFn:function(Be){return"url"==Be.getType()&&et.validUrl(Be.getAnchorHref())}});this.isDicebot&&(Re=W0.decorationDiceResult(Re));let Le="";if(this.isEdited)if(""==e)Le='<span class="is-edited">\u7de8\u96c6\u6e08</span>';else{const Be=new Date(this.lastUpdate);Le=`<span class="is-edited"><b>\u7de8\u96c6\u6e08</b> <time datetime="${Be.toISOString()}">${et.escapeHtml(gd(Be,e,this.locale))}</time></span>`}return Re.lastIndexOf("\n")==Re.length-1&&!Le&&(Re+="\n"),`<div class="${Ce.join(" ")}" style="border-left-color: ${r}">\n  <div class="msg-header">${I}${fe}<span class="msg-name">${_e}</span>\uff1a</div>\n  <div class="${Ee.join(" ")}"><span${this.isSpecialColor?"":s}>${Re}</span>${Le}</div>\n</div>`}static logCss(n=!0){return"body {\n  color: #444;\n  background-color: #FFF;\n}\n.message {\n  display: flex;\n  width: 100%;\n  word-wrap: break-word;\n  overflow-wrap: anywhere;\n  word-break: break-word;\n  border-left: 4px solid transparent;\n  margin-top: 1px;\n}\n.direct-message {\n  background-color: #555;\n  color: #CCC;\n}\n.dicebot-message .msg-text {\n  color: #11F;\n}\n.direct-message.dicebot-message .msg-text {\n  color: #CCF;\n}\n.dicebot-message .msg-text.is-success {\n  color: #17f;\n}\n.dicebot-message .msg-text.is-failure {\n  color: #F05;\n}\n.direct-message.dicebot-message .msg-text.is-success {\n  color: #adF;\n}\n.direct-message.dicebot-message .msg-text.is-failure {\n  color: #F66;\n}\n.operation-log {\n  color: #666;\n  background-color: #CCCCCCAA;\n}\n.dicebot-message .msg-name,\n.dicebot-message .msg-text,\n.operation-log .msg-name,\n.operation-log .msg-text {\n  font-style: oblique;\n}\n.tab-name {\n  display: inline-block;\n}\n.tab-name::before {\n  content: '[';\n}\n.tab-name::after {\n  content: ']';\n}\n.msg-header {\n  white-space: nowrap;\n  border-left: 1px solid #FFF;\n  padding-left: 2px;\n}\n.msg-name {\n  font-weight: bolder;\n}\n.msg-text {\n  white-space: pre-wrap;\n  width: 100%\n}\n.is-edited {\n  margin-left: 2px;\n  font-size: 8px;\n}\n.is-edited::before {\n  content: '(';\n}\n.is-edited::after {\n  content: ')';\n}\na[target=_blank] {\n  text-decoration: none;\n  word-break: break-all;\n}\na[target=_blank]:hover {\n  text-decoration: underline;\n}\na.outer-link::after {\n  margin-right: 2px;\n  margin-left: 2px;\n  font-family: 'Material Icons';\n  content: '\\e89e';\n  font-weight: bolder;\n  text-decoration: none;\n  display: inline-block;\n  font-size: smaller;\n  vertical-align: 25%;\n}\n.direct-message a[href] {\n  color: #CCF;\n}\n.direct-message a[href]:visited {\n  color: #99D;\n}\nruby {\n  ruby-align: space-between;\n}\ns.drop-dice .dropped {\n  color: #999;\n}\n.grow {\n  text-shadow: \n       1px  0px 1px #ffffff,\n       0px  1px 1px #ffffff,\n      -1px  0px 1px #ffffff,\n       0px -1px 1px #ffffff; \n}"}static decorationDiceResult(n){return n.replace(/###(.+?)###/g,'<b class="special-dice">$1</b>').replace(/\~\~\~(.+?)\~\~\~/g,'<s class="drop-dice"><span class="dropped">$1</span></s>')}};B([st()],Hn.prototype,"originFrom",void 0),B([st()],Hn.prototype,"from",void 0),B([st()],Hn.prototype,"to",void 0),B([st()],Hn.prototype,"name",void 0),B([st()],Hn.prototype,"toName",void 0),B([st()],Hn.prototype,"tag",void 0),B([st()],Hn.prototype,"dicebot",void 0),B([st()],Hn.prototype,"imageIdentifier",void 0),B([st()],Hn.prototype,"toImageIdentifier",void 0),B([st()],Hn.prototype,"color",void 0),B([st()],Hn.prototype,"toColor",void 0),B([st()],Hn.prototype,"isInverseIcon",void 0),B([st()],Hn.prototype,"isHollowIcon",void 0),B([st()],Hn.prototype,"isBlackPaint",void 0),B([st()],Hn.prototype,"aura",void 0),B([st()],Hn.prototype,"characterIdentifier",void 0),B([st()],Hn.prototype,"standIdentifier",void 0),B([st()],Hn.prototype,"standName",void 0),B([st()],Hn.prototype,"isUseStandImage",void 0),B([st()],Hn.prototype,"lastUpdate",void 0),Hn=W0=B([Kn("chat")],Hn);let qa=class extends Ln{constructor(){super(...arguments),this.name="\u30bf\u30d6",this.isUseStandImage=!0,this.recieveOperationLogLevel=0,this._unreadLength=0}get chatMessages(){return this.children}get unreadLength(){return this._unreadLength}get hasUnread(){return 0<this.unreadLength}get latestTimeStamp(){let n=this.chatMessages.length-1;return n<0?0:this.chatMessages[n].timestamp}onChildAdded(n){super.onChildAdded(n),n.parent===this&&n instanceof Hn&&n.isDisplayable&&(this._unreadLength++,Fe.trigger("MESSAGE_ADDED",{tabIdentifier:this.identifier,messageIdentifier:n.identifier}))}addMessage(n){n.tabIdentifier=this.identifier;let e=new Hn;for(let i in n)if("identifier"!==i&&"tabIdentifier"!==i){if("text"===i){e.value=n[i];continue}null==n[i]||""===n[i]||e.setAttribute(i,n[i])}return e.initialize(),Fe.trigger("SEND_MESSAGE",{tabIdentifier:this.identifier,messageIdentifier:e.identifier}),this.appendChild(e),e}markForRead(){this._unreadLength=0}innerXml(){let n="";for(let e of this.children)e instanceof Hn&&!e.isDisplayable||(n+=Gn.instance.toXml(e));return n}parseInnerXml(n){return super.parseInnerXml(n)}log(n,e,i=!0){const r=this.chatMessages.filter(s=>s.isDisplayable&&(i||!s.isOperationLog)).sort((s,o)=>s.index-o.index).map(s=>s.logFragment(n,null,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a${et.escapeHtml(""==this.name?"(\u7121\u540d\u306e\u30bf\u30d6)":this.name)}</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Hn.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};var Bs;B([st()],qa.prototype,"name",void 0),B([st()],qa.prototype,"isUseStandImage",void 0),B([st()],qa.prototype,"recieveOperationLogLevel",void 0),qa=B([Kn("chat-tab")],qa);let ao=Bs=class extends Ln{static get instance(){return Bs._instance||(Bs._instance=new Bs("ChatTabList"),Bs._instance.initialize()),Bs._instance}get chatTabs(){return this.children}addChatTab(...n){let e=null;if(n[0]instanceof qa)e=n[0];else{let i=n[0];e=new qa(n[1]),e.name=i,e.initialize()}return this.appendChild(e)}parseInnerXml(n){for(let i of Bs.instance.children)i.destroy();let e=Bs.instance.toContext();e.syncData=this.toContext().syncData,Bs.instance.apply(e),Bs.instance.update(),super.parseInnerXml.apply(Bs.instance,[n]),this.destroy()}log(n,e,i=!0){if(!this.chatTabs)return"";const r=this.chatTabs.reduce((s,o)=>(o&&s.push(...o.chatMessages.filter(d=>d.isDisplayable&&(i||!d.isOperationLog)).map(d=>({index:d.index,tabName:o.name,chatMessage:d}))),s),[]).sort((s,o)=>s.index-o.index).map(s=>s.chatMessage.logFragment(n,s.tabName,e)).join("\n");return 0==n?r:`<!DOCTYPE html>\n<html lang="ja-JP">\n<head>\n<meta charset="UTF-8">\n<title>Udonarium with Fly\uff1a\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\uff1a\u5168\u3066\u306e\u30bf\u30d6</title>\n<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">\n<style>\n${Hn.logCss()}\n</style>\n</head>\n<body>\n${r}\n</body>\n</html>`}};ao=Bs=B([Kn("chat-tab-list")],ao);let yr=(()=>{class t{constructor(){this.intervalTimer=null,this.timeOffset=Date.now(),this.performanceOffset=performance.now(),this.ntpApiUrls=["https://worldtimeapi.org/api/ip"],this.gameType=""}get chatTabs(){return ao.instance.chatTabs}calibrateTimeOffset(){if(null!=this.intervalTimer)return void console.log("calibrateTimeOffset was canceled.");let e=Math.floor(Math.random()*this.ntpApiUrls.length),i=this.ntpApiUrls[e],r=performance.now();fetch(i).then(s=>{if(s.ok)return s.json();throw new Error("Network response was not ok.")}).then(s=>{let o=performance.now(),d=(o-r)/2,I=new Date(s.utc_datetime).getTime();this.timeOffset=I+d,this.performanceOffset=o,console.log("latency: "+d+"ms"),console.log("st: "+I),console.log("timeOffset: "+this.timeOffset),console.log("performanceOffset: "+this.performanceOffset),this.setIntervalTimer()}).catch(s=>{console.warn("There has been a problem with your fetch operation: ",s.message),this.setIntervalTimer()}),this.setIntervalTimer()}setIntervalTimer(){null!=this.intervalTimer&&clearTimeout(this.intervalTimer),this.intervalTimer=setTimeout(()=>{this.intervalTimer=null,this.calibrateTimeOffset()},216e5)}getTime(){return Math.floor(this.timeOffset+(performance.now()-this.performanceOffset))}sendMessage(e,i,r,s,o,d,$,I,Q,fe,_e,Ce,Ee,Re,Le){let Be=!(_e&&this.findFaceIconIdentifier(s)),Ae={from:vt.peerContext.userId,to:t.findId(o),name:this.findObjectName(s),toName:o?this.findObjectName(o):"",imageIdentifier:this.findImageIdentifier(s,_e),toImageIdentifier:o?this.findImageIdentifier(o):"",timestamp:this.calcTimeStamp(e),tag:Be?`${r} noface`:r,text:et.cr(i),color:d,toColor:o?this.findObjectColor(o):"",isInverseIcon:Be&&$?1:0,isHollowIcon:Be&&I?1:0,isBlackPaint:Be&&Q?1:0,aura:Be?fe:-1,characterIdentifier:Ce,standIdentifier:Ee,standName:Re,isUseStandImage:Le};return e.addMessage(Ae)}sendOperationLog(e,i=1){for(const r of this.chatTabs){if(r.recieveOperationLogLevel<i)continue;let s={from:vt.peerContext.userId,name:He.myCursor.name,imageIdentifier:He.myCursor.imageIdentifier,timestamp:this.calcTimeStamp(r),tag:"opelog",text:et.cr(e),color:He.myCursor.color};r.addMessage(s)}}static findId(e){let i=rt.instance.get(e);return i instanceof jt?i.identifier:i instanceof He?i.userId:null}findObjectName(e){let i=rt.instance.get(e);return i instanceof jt?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\uff09":i instanceof He?i.name&&i.name.length?i.name:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09":e}findObjectColor(e){let i=rt.instance.get(e);return i instanceof jt?i.chatPalette.color:i instanceof He?i.color:null}makeMessageName(e,i){let r=this.findObjectName(e);return null==i||i.length<1?r:r+" \u27a1 "+this.findObjectName(i)}findImageIdentifier(e,i=!1){let r=rt.instance.get(e);return r instanceof jt?i&&r.faceIcon&&0<r.faceIcon.url.length?r.faceIcon.identifier:r.imageFile?r.imageFile.identifier:"":r instanceof He?r.imageIdentifier:e}findFaceIconIdentifier(e){let i=rt.instance.get(e);return i instanceof jt&&i.faceIcon&&0<i.faceIcon.url.length?i.faceIcon.identifier:""}calcTimeStamp(e){let i=this.getTime(),r=e.latestTimeStamp;return i<=r?r+1:i}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();const ej=["chatInput"],tj=["chatPlette"];function nj(t,n){1&t&&(X(0,"i",13),be(1,"how_to_reg"),te())}function ij(t,n){1&t&&(X(0,"i",13),be(1,"history_edu"),te())}function rj(t,n){1&t&&nt(0,"badge",14),2&t&&re("count",ge().$implicit.unreadLength)}function sj(t,n){if(1&t){const e=Ye();X(0,"label")(1,"input",10),Ie("ngModelChange",function(r){return ke(e),ge().chatTabidentifier=r}),te(),X(2,"div")(3,"span"),be(4),te(),xe(5,nj,2,0,"i",11),xe(6,ij,2,0,"i",11),xe(7,rj,1,1,"badge",12),te()()}if(2&t){const e=n.$implicit,i=ge();W(1),it("value",e.identifier),re("ngModel",i.chatTabidentifier),W(2),Je("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),W(1),Ze(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),W(1),re("ngIf",e.isUseStandImage),W(1),re("ngIf",e.recieveOperationLogLevel>0),W(1),re("ngIf",e.hasUnread)}}function oj(t,n){1&t&&(X(0,"div",15)(1,"i",16),be(2,"info_outline"),te(),be(3," \u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u7de8\u96c6\u4e2d\u3067\u3059"),te())}function aj(t,n){if(1&t&&(X(0,"option",21),be(1),te()),2&t){const e=ge().$implicit;Je("color",ge(3).color),it("value",e),W(1),Ze(e)}}function lj(t,n){if(1&t&&(Ge(0),xe(1,aj,2,4,"option",20),qe()),2&t){const e=n.$implicit,i=ge(3);W(1),re("ngIf",i.filter(e))}}function cj(t,n){if(1&t&&(Ge(0),xe(1,lj,2,1,"ng-container",3),qe()),2&t){const e=ge(2);W(1),re("ngForOf",e.palette.getPalette())}}function uj(t,n){if(1&t){const e=Ye();X(0,"div",17)(1,"select",18,19),Ie("input",function(r){return ke(e),ge().selectPalette(r.target.value)})("click",function(r){return ke(e),ge().clickPalette(r.target.value)}),xe(3,cj,2,1,"ng-container",9),te()()}if(2&t){const e=ge();W(3),re("ngIf",e.palette)}}function dj(t,n){if(1&t){const e=Ye();X(0,"div",17)(1,"textarea",22),Ie("ngModelChange",function(r){return ke(e),ge().editPalette=r}),te()()}if(2&t){const e=ge();W(1),re("ngModel",e.editPalette)}}function fj(t,n){1&t&&(X(0,"span"),be(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u7de8\u96c6"),te())}function hj(t,n){1&t&&(X(0,"span"),be(1,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u78ba\u5b9a"),te())}let cu=(()=>{class t{constructor(e,i){this.chatMessageService=e,this.panelService=i,this.character=null,this._gameType="",this.chatTabidentifier="",this.text="",this.sendTo="",this.isEdit=!1,this.editPalette="",this.filterText="",this.doubleClickTimer=null,this.selectedPaletteIndex=-1}get palette(){return this.character.chatPalette}get color(){return this.chatInputComponent.color}get gameType(){return this._gameType?this._gameType:"DiceBot"}set gameType(e){this._gameType=e,this.character.chatPalette&&(this.character.chatPalette.dicebot=e)}get sendFrom(){return this.character.identifier}set sendFrom(e){this.onSelectedCharacter(e)}get diceBotInfos(){return Pn.diceBotInfos}get chatTab(){return rt.instance.get(this.chatTabidentifier)}get myPeer(){return He.myCursor}get otherPeers(){return rt.instance.getObjects(He)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"",this.gameType=this.character.chatPalette?this.character.chatPalette.dicebot:"",Fe.register(this).on("DELETE_GAME_OBJECT",e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close(),this.chatTabidentifier===e.data.identifier&&(this.chatTabidentifier=this.chatMessageService.chatTabs?this.chatMessageService.chatTabs[0].identifier:"")})}ngOnDestroy(){Fe.unregister(this),this.isEdit&&this.toggleEditMode()}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8"}onSelectedCharacter(e){this.isEdit&&this.toggleEditMode();let i=rt.instance.get(e);if(i instanceof jt){this.character=i;let r=this.character.chatPalette?this.character.chatPalette.dicebot:"";0<r.length&&(this.gameType=r)}this.updatePanelTitle()}selectPalette(e){this.text=e}clickPalette(e){if(!this.chatPletteElementRef.nativeElement)return;const i=this.palette.evaluate(e,this.character.rootDataElement);this.doubleClickTimer&&this.selectedPaletteIndex===this.chatPletteElementRef.nativeElement.selectedIndex?(clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.chatInputComponent.sendChat(null)):(this.selectedPaletteIndex=this.chatPletteElementRef.nativeElement.selectedIndex,this.text=i,this.chatInputComponent.textAreaElementRef.nativeElement.value=this.text,this.doubleClickTimer=setTimeout(()=>{this.doubleClickTimer=null},400))}sendChat(e){if(this.chatTab){let i=this.palette.evaluate(e.text,this.character.rootDataElement);this.chatMessageService.sendMessage(this.chatTab,i,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage),this.filterText=""}}resetPletteSelect(){!this.chatPletteElementRef.nativeElement||(this.chatPletteElementRef.nativeElement.selectedIndex=-1)}toggleEditMode(){this.isEdit=!this.isEdit,this.isEdit?this.editPalette=this.palette.value+"":this.palette.setPalette(this.editPalette)}filter(e){return null==this.filterText||""==this.filterText.trim()||e.search(this.filterText)>=0}}return t.\u0275fac=function(e){return new(e||t)(Oe(yr),Oe(Tn))},t.\u0275cmp=qt({type:t,selectors:[["chat-palette"]],viewQuery:function(e,i){if(1&e&&(dn(ej,7),dn(tj,5)),2&e){let r;un(r=fn())&&(i.chatInputComponent=r.first),un(r=fn())&&(i.chatPletteElementRef=r.first)}},inputs:{character:"character"},decls:14,vars:11,consts:[[1,"flex-container"],[2,"flex-grow","0"],[1,"chat-tab"],[4,"ngFor","ngForOf"],[3,"onlyCharacters","chatTabidentifier","gameType","sendFrom","text","gameTypeChange","sendFromChange","textChange","chat"],["chatInput",""],["class","edit-info",4,"ngIf"],["style","flex-grow: 1; height: 0; min-height: 100px;",4,"ngIf"],["type","submit",3,"click"],[4,"ngIf"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"material-icons","small-font"],[1,"badge",3,"count"],[1,"edit-info"],[1,"material-icons",2,"vertical-align","bottom","size","0.8rem"],[2,"flex-grow","1","height","0","min-height","100px"],["size","5",1,"palette",2,"overflow-y","auto",3,"input","click"],["chatPlette",""],[3,"value","color",4,"ngIf"],[3,"value"],["placeholder","\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8",1,"palette",2,"resize","none",3,"ngModel","ngModelChange"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"form")(3,"div",2),xe(4,sj,8,10,"label",3),te()(),X(5,"chat-input",4,5),Ie("gameTypeChange",function(s){return i.gameType=s})("sendFromChange",function(s){return i.sendFrom=s})("textChange",function(s){return i.text=s})("chat",function(s){return i.sendChat(s)}),te(),xe(7,oj,4,0,"div",6),te(),xe(8,uj,4,1,"div",7),xe(9,dj,2,1,"div",7),X(10,"div",1)(11,"button",8),Ie("click",function(){return i.toggleEditMode()}),xe(12,fj,2,0,"span",9),xe(13,hj,2,0,"span",9),te()()()),2&e&&(W(4),re("ngForOf",i.chatMessageService.chatTabs),W(1),re("onlyCharacters",!0)("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom)("text",i.text),W(2),re("ngIf",i.isEdit),W(1),re("ngIf",!i.isEdit),W(1),re("ngIf",i.isEdit),W(3),re("ngIf",!i.isEdit),W(1),re("ngIf",i.isEdit))},styles:["[_nghost-%COMP%]{display:block;height:100%}.edit-info[_ngcontent-%COMP%]{width:100%;text-align:center;color:#ccc;background-color:#1e1e1ecc}.palette[_ngcontent-%COMP%]{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,sans-serif;width:100%;height:100%}.flex-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%}.chat-tab[_ngcontent-%COMP%]{padding:0 5px 5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:8px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.6rem}"]}),t})();function pj(t,n){if(1&t&&(X(0,"div",11),be(1),te()),2&t){const e=ge(2);W(1),Ze(e.isSpeaking?"\u{1f603}":"\u{1f910}")}}const gj=function(t){return{transform:t}},mj=function(t){return{inverse:t}},_j=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}},$j=function(t,n){return{"black-paint":t,hollow:n}};function vj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div")(2,"div",5)(3,"div",6)(4,"span",7)(5,"img",8),Ie("dblclick",function(){return ke(e),ge().openModal()}),bt(6,"safe"),te()()()(),X(7,"button",9),Ie("click",function(){return ke(e),ge().openModal()}),X(8,"b"),be(9),te()(),xe(10,pj,2,1,"div",10),te(),qe()}if(2&t){const e=ge();W(2),re("ngStyle",ct(10,gj,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),W(1),re("ngClass",ct(12,mj,e.isApplyImageEffect&&e.gameCharacter.isInverse)),W(1),re("ngClass",vo(14,_j,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),W(1),re("src",yt(6,7,e.standImage.url,"resourceUrl"),Xt)("ngClass",cn(23,$j,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow)),W(4),An("",e.isSpeakable?"\u901a\u5e38":"","\u753b\u50cf\u5909\u66f4"),W(1),re("ngIf",e.isSpeakable)}}function bj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"span",12)(2,"input",13),Ie("ngModelChange",function(r){return ke(e),ge().nameElement.value=r}),te()(),qe()}if(2&t){const e=ge();W(2),re("ngModel",e.nameElement.value)}}function yj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"b",12),be(2,"\u3000Cond: "),te(),X(3,"select",14),Ie("ngModelChange",function(r){return ke(e),ge().conditionTypeElement.value=r}),X(4,"option",15),be(5,"\u30c7\u30d5\u30a9\u30eb\u30c8"),te(),X(6,"option",15),be(7,"\u6307\u5b9a\u753b\u50cf"),te(),X(8,"option",15),be(9,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e"),te(),X(10,"option",15),be(11,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u307e\u305f\u306f \u6307\u5b9a\u753b\u50cf"),te(),X(12,"option",15),be(13,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e \u304b\u3064 \u6307\u5b9a\u753b\u50cf"),te(),X(14,"option",15),be(15,"\u9078\u629e\u6642\u306e\u307f"),te()(),qe()}if(2&t){const e=ge();W(3),re("ngModel",e.conditionTypeElement.value),W(1),it("value",e.standConditionType.Default),W(2),it("value",e.standConditionType.Image),W(2),it("value",e.standConditionType.Postfix),W(2),it("value",e.standConditionType.PostfixOrImage),W(2),it("value",e.standConditionType.PostfixAndImage),W(2),it("value",e.standConditionType.NotConditionStandUp)}}function Cj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"span",12)(2,"b",16),be(3,"Tag: "),te(),X(4,"input",17),Ie("ngModelChange",function(r){return ke(e),ge().nameElement.currentValue=r}),te()(),qe()}if(2&t){const e=ge();W(4),re("ngModel",e.nameElement.currentValue)}}function xj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"label",18)(2,"input",19),Ie("ngModelChange",function(r){return ke(e),ge().showNameElement.value=r})("change",function(){ke(e);const r=ge();return r.showNameElement.value=r.showNameElement.value?"showName":""}),te(),X(3,"b",12),be(4,"\u30cd\u30fc\u30e0\u30bf\u30b0"),te()(),qe()}if(2&t){const e=ge();W(2),it("checked",e.showNameElement.value?"checked":""),re("ngModel",e.showNameElement.value)}}function wj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"label",18)(2,"input",19),Ie("ngModelChange",function(r){return ke(e),ge().applyImageEffectElement.value=r})("change",function(){ke(e);const r=ge();return r.applyImageEffectElement.value=r.applyImageEffectElement.value?"applyImageEffect":""}),te(),X(3,"b",12),be(4,"\u753b\u50cf\u52b9\u679c\u53cd\u6620"),te()(),qe()}if(2&t){const e=ge();W(2),it("checked",e.applyImageEffectElement.value?"checked":""),re("ngModel",e.applyImageEffectElement.value)}}function Ej(t,n){if(1&t){const e=Ye();Ge(0),X(1,"label",18)(2,"input",19),Ie("ngModelChange",function(r){return ke(e),ge().applyRollElement.value=r})("change",function(){ke(e);const r=ge();return r.applyRollElement.value=r.applyRollElement.value?"applyRoll":""}),te(),X(3,"b",12),be(4,"\u56de\u8ee2\u53cd\u6620"),te()(),qe()}if(2&t){const e=ge();W(2),it("checked",e.applyRollElement.value?"checked":""),re("ngModel",e.applyRollElement.value)}}function Tj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"label",20)(2,"input",19),Ie("ngModelChange",function(r){return ke(e),ge().applyDialogElement.value=r})("change",function(){ke(e);const r=ge();return r.applyDialogElement.value=r.applyDialogElement.value?"applyDialog":""}),te(),X(3,"b",12),be(4,"\u{1f4ad}"),te()(),qe()}if(2&t){const e=ge();W(2),it("checked",e.applyDialogElement.value?"checked":""),re("ngModel",e.applyDialogElement.value)}}const Ij=function(t){return{"disabled-text":t}};function Sj(t,n){if(1&t){const e=Ye();Ge(0),nt(1,"br"),X(2,"button",21),Ie("click",function(){return ke(e),ge().testStandUp()}),X(3,"b"),be(4,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),X(5,"sup",22),be(6,"*"),te()()(),X(7,"label",23)(8,"input",19),Ie("ngModelChange",function(r){return ke(e),ge().positionElement.currentValue=r})("change",function(){ke(e);const r=ge();return r.positionElement.currentValue=r.positionElement.currentValue?"posSpecialize":""}),te(),X(9,"b",12),be(10,"Pos\u500b\u5225\u6307\u5b9a: "),te()(),X(11,"span",24)(12,"input",25),Ie("ngModelChange",function(r){return ke(e),ge().positionElement.value=r}),te(),X(13,"input",26),Ie("ngModelChange",function(r){return ke(e),ge().positionElement.value=r}),te(),X(14,"b",27),be(15,"%"),te()(),qe()}if(2&t){const e=ge();W(8),it("checked",e.positionElement.currentValue?"checked":""),re("ngModel",e.positionElement.currentValue),W(4),re("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),W(1),re("ngModel",e.positionElement.value)("disabled",!e.positionElement.currentValue),W(1),re("ngClass",ct(7,Ij,!e.positionElement.currentValue))}}function kj(t,n){if(1&t){const e=Ye();Ge(0),nt(1,"br"),X(2,"span",24)(3,"b",28),be(4,"Height (0=\u6307\u5b9a\u306a\u3057): "),te(),X(5,"input",29),Ie("ngModelChange",function(r){return ke(e),ge().heightElement.value=r}),te(),X(6,"input",30),Ie("ngModelChange",function(r){return ke(e),ge().heightElement.value=r}),te(),X(7,"b",31),be(8,"%"),te()(),X(9,"span",32)(10,"b",28),be(11,"AdjY: "),te(),X(12,"input",33),Ie("ngModelChange",function(r){return ke(e),ge().heightElement.currentValue=r}),te(),X(13,"b",31),be(14,"%"),te()(),qe()}if(2&t){const e=ge();W(5),re("ngModel",e.heightElement.value),W(1),re("ngModel",e.heightElement.value),W(6),re("ngModel",e.heightElement.currentValue)}}function Mj(t,n){if(1&t){const e=Ye();X(0,"div")(1,"textarea",34),Ie("ngModelChange",function(r){return ke(e),ge().postfixElement.value=r}),te()()}if(2&t){const e=ge();W(1),re("ngModel",e.postfixElement.value)}}const Dj=function(t){return{"current-icon":t}};function Aj(t,n){if(1&t){const e=Ye();X(0,"div",39)(1,"img",40),Ie("click",function(){ke(e);const r=ge().$implicit;return ge(3).selectImage(r.identifier)}),bt(2,"safe"),te()()}if(2&t){const e=ge().$implicit,i=ge(3);re("ngClass",ct(6,Dj,i.isSelectedImage(e.identifier))),W(1),re("src",yt(2,3,e.url,"resourceUrl"),Xt)("alt",e.name)}}function Pj(t,n){if(1&t&&(Ge(0),xe(1,Aj,3,8,"div",38),qe()),2&t){const e=n.$implicit;W(1),re("ngIf",0<e.url.length)}}function Nj(t,n){if(1&t&&(X(0,"div",36),xe(1,Pj,2,1,"ng-container",37),te()),2&t){const e=ge(2);W(1),re("ngForOf",e.imageList)}}function Fj(t,n){1&t&&(X(0,"div"),be(1,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3001\u9854IC\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u307e\u305b\u3093"),te())}function Rj(t,n){if(1&t&&(X(0,"div"),xe(1,Nj,2,1,"div",35),xe(2,Fj,2,0,"div",2),te()),2&t){const e=ge();W(1),re("ngIf",e.imageList&&e.imageList.length>0),W(1),re("ngIf",!e.imageList||0==e.imageList.length)}}let ST=(()=>{class t{constructor(e){this.modalService=e,this.standElement=null,this.imageList=[],this.gameCharacter=null,this.isSpeaking=!1,this._imageFile=Lt.Empty,this.standConditionType=bi}ngOnInit(){}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier"),e||(e=this.standElement.appendChild(dt.create("speakingImageIdentifier",Lt.Empty.identifier,{type:"image"},"speakingImageIdentifier_"+this.standElement.identifier)))),(!e||!e.value||e.value==Lt.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e){if(this._imageFile.identifier!==e.value){let i=It.instance.get(e.value);this._imageFile=i||Lt.Empty}}else{let i=Lt.createEmpty("stand_no_image").toContext();i.url="./assets/images/nc96424.png",this._imageFile=It.instance.add(i),this.standElement.appendChild(dt.create("imageIdentifier",this._imageFile.identifier,{type:"image"},"imageIdentifier_"+this.standElement.identifier))}return this._imageFile}get nameElement(){return this.standElement?this.standElement.getFirstElementByName("name")||this.standElement.appendChild(dt.create("name","",{},"name_"+this.standElement.identifier)):null}get heightElement(){return this.standElement?this.standElement.getFirstElementByName("height")||this.standElement.appendChild(dt.create("height",0,{currentValue:0},"height_"+this.standElement.identifier)):null}get conditionTypeElement(){return this.standElement?this.standElement.getFirstElementByName("conditionType")||this.standElement.appendChild(dt.create("conditionType",bi.Default,{},"conditionType_"+this.standElement.identifier)):null}get postfixElement(){return this.standElement?this.standElement.getFirstElementByName("postfix")||this.standElement.appendChild(dt.create("postfix","",{},"postfix_"+this.standElement.identifier)):null}get applyImageEffectElement(){return this.standElement?this.standElement.getFirstElementByName("applyImageEffect")||this.standElement.appendChild(dt.create("applyImageEffect","",{},"applyImageEffect_"+this.standElement.identifier)):null}get applyRollElement(){return this.standElement?this.standElement.getFirstElementByName("applyRoll")||this.standElement.appendChild(dt.create("applyRoll","",{},"applyRoll_"+this.standElement.identifier)):null}get applyDialogElement(){return this.standElement?this.standElement.getFirstElementByName("applyDialog")||this.standElement.appendChild(dt.create("applyDialog","applyDialog",{},"applyDialog_"+this.standElement.identifier)):null}get showNameElement(){return this.standElement?this.standElement.getFirstElementByName("showName")||this.standElement.appendChild(dt.create("showName","showName",{},"showName_"+this.standElement.identifier)):null}get positionElement(){return this.standElement?this.standElement.getFirstElementByName("position")||this.standElement.appendChild(dt.create("position",0,{currentValue:""},"position_"+this.standElement.identifier)):null}get isApplyImageEffect(){let e=this.applyImageEffectElement;return!(!e||!e.value)}get isApplyRoll(){let e=this.applyRollElement;return!(!e||!e.value)}get isApplyDialog(){let e=this.applyDialogElement;return!(!e||!e.value)}get isShowName(){let e=this.showNameElement;return!(!e||!e.value)}get isSpeakable(){if(!this.standElement)return!1;const e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Lt.Empty.identifier}openModal(e="imageIdentifier",i=!1){if(!this.standElement)return;let r=[],s=this.standElement.getFirstElementByName(e);s?r=[s.value+""]:s=this.standElement.appendChild(dt.create(e,"",{type:"image"},e+"_"+this.standElement.identifier)),this.modalService.open(Po,{isAllowedEmpty:i,currentImageIdentifires:r}).then(o=>{!o||(s.value=o)})}openSpeakingModal(){this.openModal("speakingImageIdentifier",!0)}remove(){!this.standElement||this.standElement.parent.removeChild(this.standElement)}selectImage(e){if(!this.standElement)return;let i=!1;for(let r of this.standElement.getElementsByName("targetImageIdentifier")){let s=!0;for(let o of this.imageList)if(o.identifier==r.value){s=!1;break}s?this.standElement.removeChild(r):r.value==e&&(i=!0,this.standElement.removeChild(r))}i||this.standElement.appendChild(dt.create("targetImageIdentifier",e,{},"targetImageIdentifier_"+ms.generateUuid()))}isSelectedImage(e){let i=this.standElement.getElementsByName("targetImageIdentifier");for(let r of i)if(r.value==e)return!0;return!1}testStandUp(){Fe.trigger("POPUP_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier,standIdentifier:this.standElement.identifier,color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null}),Fe.trigger("POPUP_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier,text:"\u3053\u308c\u306f\u30c6\u30b9\u30c8\u3067\u3059\u3001\u3042\u306a\u305f\u306b\u3060\u3051\u898b\u3048\u3066\u3044\u307e\u3059\u3002\u30b9\u30bf\u30f3\u30c9\u306e\u8a2d\u5b9a\u3092\u884c\u3046\u969b\u306f\u3001\u30e1\u30cb\u30e5\u30fc\u306e\u300c\u500b\u4eba\u8a2d\u5b9a\u300d\u304b\u3089\u300c\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb\u300d\u3092\u30aa\u30d5\u306b\u3059\u308b\u3068\u5fae\u8abf\u6574\u304c\u884c\u3044\u3084\u3059\u304f\u306a\u308a\u307e\u3059\u3002",color:this.gameCharacter.chatPalette?this.gameCharacter.chatPalette.color:null,dialogTest:!0})}}return t.\u0275fac=function(e){return new(e||t)(Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["stand-element"]],inputs:{standElement:"standElement",imageList:"imageList",gameCharacter:"gameCharacter",isSpeaking:"isSpeaking"},decls:20,vars:14,consts:[[1,"stand-container"],[1,"stand-image-container"],[4,"ngIf"],[2,"display","flex","flex-direction","column","padding-left","3px","width","100%"],[2,"font-size","9px",3,"click"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"stand-image",3,"src","ngClass","dblclick"],[1,"stand-image-button",2,"font-size","smaller","padding","2px 3px",3,"click"],["style","position: absolute; margin-top: -26px; margin-left: 120px; font-size: 22px; filter: grayscale(100%); opacity: 0.5; cursor: default;",4,"ngIf"],[2,"position","absolute","margin-top","-26px","margin-left","120px","font-size","22px","filter","grayscale(100%)","opacity","0.5","cursor","default"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","7em",3,"ngModel","ngModelChange"],[2,"width","15.5em",3,"ngModel","ngModelChange"],[3,"value"],[2,"margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"margin-right","0.6em"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"margin-right","0.2em"],[2,"font-size","9px","margin-right","1em",3,"click"],[1,"self-only"],[2,"margin-right","0.3em"],[2,"white-space","nowrap","font-size","smaller"],["type","range","min","0","max","100",2,"width","140px",3,"ngModel","disabled","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right",3,"ngModel","disabled","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px",3,"ngClass"],[2,"display","inline-block","margin-left","3px"],["type","range","min","0","max","100",2,"width","130px",3,"ngModel","ngModelChange"],["type","number","min","0","max","200",2,"width","3em","text-align","right",3,"ngModel","ngModelChange"],[2,"display","inline-block","font-size","smaller","margin-left","3px"],[2,"white-space","nowrap","margin-left","0.8em","font-size","smaller"],["type","number","min","-100","max","100",2,"width","3.4em","text-align","right",3,"ngModel","ngModelChange"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3092\u4ed8\u3051\u308b\u3068\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u6012\u308a\r\n@\u5fc5\u6bba\u6280",2,"width","100%","margin-top","3px","height","2.4rem",3,"ngModel","ngModelChange"],["style","display: flex; flex-wrap: wrap; margin-right: -30px;",4,"ngIf"],[2,"display","flex","flex-wrap","wrap","margin-right","-30px"],[4,"ngFor","ngForOf"],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"]],template:function(e,i){1&e&&(X(0,"div")(1,"div",0)(2,"div",1),xe(3,vj,11,26,"ng-container",2),te(),X(4,"div",3)(5,"div"),xe(6,bj,3,1,"ng-container",2),xe(7,yj,16,7,"ng-container",2),xe(8,Cj,5,1,"ng-container",2),te(),X(9,"div"),xe(10,xj,5,2,"ng-container",2),xe(11,wj,5,2,"ng-container",2),xe(12,Ej,5,2,"ng-container",2),xe(13,Tj,5,2,"ng-container",2),X(14,"button",4),Ie("click",function(){return i.openSpeakingModal()}),be(15,"\u53e3\u30d1\u30af\u753b\u50cf (APNG\u306a\u3069)"),te(),xe(16,Sj,16,9,"ng-container",2),xe(17,kj,15,3,"ng-container",2),te(),xe(18,Mj,2,1,"div",2),xe(19,Rj,3,2,"div",2),te()()()),2&e&&(W(3),re("ngIf",i.standImage),W(3),re("ngIf",i.nameElement),W(1),re("ngIf",i.conditionTypeElement),W(1),re("ngIf",i.nameElement),W(2),re("ngIf",i.showNameElement),W(1),re("ngIf",i.applyImageEffectElement),W(1),re("ngIf",i.applyRollElement),W(1),re("ngIf",i.applyDialogElement),W(1),Je("font-weight",i.isSpeakable?"bolder":"normal"),W(2),re("ngIf",i.positionElement),W(1),re("ngIf",i.heightElement),W(1),re("ngIf",i.postfixElement&&(i.conditionTypeElement.value==i.standConditionType.Postfix||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage)),W(1),re("ngIf",i.conditionTypeElement.value==i.standConditionType.Image||i.conditionTypeElement.value==i.standConditionType.PostfixOrImage||i.conditionTypeElement.value==i.standConditionType.PostfixAndImage))},directives:[gn,Ji,jn,si,oi,ei,Zr,Rr,Or,Yr,fs,Co,yo,ds,Jn],pipes:[Yn],styles:[".stand-container[_ngcontent-%COMP%]{display:flex;flex-direction:row}.stand-image-container[_ngcontent-%COMP%]{width:150px;height:150px}.stand-image[_ngcontent-%COMP%]{width:150px;height:150px;-o-object-fit:contain;object-fit:contain;transform-origin:bottom;z-index:5}.stand-image-button[_ngcontent-%COMP%]{display:block;margin-top:-154px;margin-left:-4px;position:relative;z-index:10}.postfix-text[_ngcontent-%COMP%]{width:8em}.position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;width:3em}.remove-button[_ngcontent-%COMP%]{font-weight:bolder;color:red;background-color:transparent}.remove-button[_ngcontent-%COMP%]:hover{background-color:#eee}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;z-index:100;margin-top:1px;margin-bottom:1px;margin-left:2px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]{z-index:500}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]:not(.current-icon){z-index:400}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}.disabled-text[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})();function Oj(t,n){if(1&t){const e=Ye();X(0,"div",14)(1,"div",15)(2,"div",16)(3,"input",17),Ie("click",function(){const s=ke(e).index;return ge().overviewIndex=s}),te()(),X(4,"div",18),nt(5,"stand-element",19,20),te(),X(7,"div",21)(8,"button",22),Ie("click",function(){const r=ke(e),s=r.$implicit,o=r.index;return ge().delele(s,o)}),be(9,"\xd7"),te(),X(10,"button",23),Ie("click",function(){const s=ke(e).$implicit;return ge().upStandIndex(s)}),be(11,"\u2191"),te(),X(12,"button",24),Ie("click",function(){const s=ke(e).$implicit;return ge().downStandIndex(s)}),be(13,"\u2193"),te()()(),nt(14,"hr"),te()}if(2&t){const e=n.$implicit,i=n.index,r=ge();W(1),Je("border-color",r.overviewIndex==i?"red":"transparent"),W(2),sr("name","",r.panelId,"_overviewIndex"),it("value",i),re("checked",r.overviewIndex==i),W(2),re("standElement",e)("imageList",r.imageList)("gameCharacter",r.character)}}function Bj(t,n){if(1&t){const e=Ye();X(0,"button",12),Ie("click",function(){return ke(e),ge().restore()}),be(1,"\u76f4\u524d\u306b\u524a\u9664\u3057\u305f\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u623b\u3059"),te()}}let Wp=(()=>{class t{constructor(e,i,r){this.panelService=e,this.pointerDeviceService=i,this.modalService=r,this.character=null,this.standSettingXML="",this.isSpeaking=!1}get standElements(){return this.character.standList.standElements}get imageList(){if(!this.character)return[];let e=[],i={};const s=this.character.imageDataElement.getElementsByName("imageIdentifier").concat(this.character.imageDataElement.getElementsByName("faceIcon"));for(let o of s){if(i[o.value])continue;let d=this.imageElementToFile(o);d&&(i[o.value]=!0,e.push(d))}return e}get position(){return this.character&&this.character.standList?this.character.standList.position:0}set position(e){!this.character||!this.character.standList||(this.character.standList.position=e)}get height(){return this.character&&this.character.standList?this.character.standList.height:0}set height(e){!this.character||!this.character.standList||(this.character.standList.height=e)}get overviewIndex(){return this.character&&this.character.standList?this.character.standList.overviewIndex:-1}set overviewIndex(e){!this.character||!this.character.standList||(this.character.standList.overviewIndex=e)}ngOnInit(){Promise.resolve().then(()=>this.updatePanelTitle()),Fe.register(this).on("DELETE_GAME_OBJECT",-1e3,e=>{this.character&&this.character.identifier===e.data.identifier&&this.panelService.close()}),this.panelId=ms.generateUuid()}ngAfterViewInit(){this._intervalId=setInterval(()=>{this.isSpeaking=!this.isSpeaking,this.standElementComponents.forEach(e=>{e.isSpeaking=this.isSpeaking})},3600)}ngOnDestroy(){clearInterval(this._intervalId),Fe.unregister(this)}updatePanelTitle(){this.panelService.title=this.character.name+" \u306e\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"}add(){this.character.standList.add(this.character.imageFile.identifier),this.standSettingXML=""}delele(e,i){Fe.call("DELETE_STAND_IMAGE",{characterIdentifier:this.character.identifier,identifier:e.identifier}),this.character&&this.character.standList&&this.modalService.open(qi,{title:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u524a\u9664",text:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u3092\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",type:_i.OK_CANCEL,materialIcon:"person_off",action:()=>{this.standSettingXML=e.toXml(),this.character.standList.removeChild(e)&&(this.character.standList.overviewIndex==i?this.character.standList.overviewIndex=-1:this.character.standList.overviewIndex>i&&(this.character.standList.overviewIndex-=1))}})}restore(){if(!this.standSettingXML)return;let e=Gn.instance.parseXml(this.standSettingXML);this.character.standList.appendChild(e),this.standSettingXML=""}upStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);0<r&&(i.insertBefore(e,i.children[r-1]),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex-=1:this.character.standList.overviewIndex==r-1&&(this.character.standList.overviewIndex+=1))}downStandIndex(e){this.standSettingXML="";let i=this.character.standList,r=i.children.indexOf(e);r<i.children.length-1&&(i.insertBefore(i.children[r+1],e),this.character.standList.overviewIndex==r?this.character.standList.overviewIndex+=1:this.character.standList.overviewIndex==r+1&&(this.character.standList.overviewIndex-=1))}helpStandSeteing(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(au,{left:e.x,top:e.y,width:600,height:590});r.title="\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u30d8\u30eb\u30d7",r.text='\u3000\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u306e\u540d\u524d\u3001\u4f4d\u7f6e\u3068\u753b\u50cf\u306e\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30b9\u30bf\u30f3\u30c9\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30b9\u30bf\u30f3\u30c9\u306b\u540d\u524d\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u306b\u8868\u793a\u3055\u308c\u3001\u9078\u629e\u53ef\u80fd\u306b\u306a\u308a\u307e\u3059\u3002\u307e\u305f\u3001\u30bf\u30b0\u3092\u8a2d\u5b9a\u3057\u305f\u5834\u5408\u3001\u7570\u306a\u308b\u30bf\u30b0\u3067\u306f\u540c\u3058\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u3042\u3063\u3066\u3082\u767b\u5834\u3001\u9000\u53bb\u306e\u30a2\u30cb\u30e1\u30fc\u30b7\u30e7\u30f3\u304c\u884c\u308f\u308c\u307e\u3059\u3002\n\n\u3000\u753b\u50cf\u306e\u4f4d\u7f6e\u3068\u9ad8\u3055\u306f\u500b\u5225\u6307\u5b9a\u3082\u53ef\u80fd\u3067\u3059\u3001\u4f4d\u7f6e\u306e\u500b\u5225\u6307\u5b9a\u306f\u30c1\u30a7\u30c3\u30af\u306a\u3057\u3001\u9ad8\u3055\u306f0\u3068\u3057\u305f\u5834\u5408\u306b\u5168\u4f53\u306e\u8a2d\u5b9a\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u7e26\u4f4d\u7f6e\u8abf\u6574(AdjY)\u306f\u3001\u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u306e\u9ad8\u3055\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\u3068\u306a\u308a\u307e\u3059\uff08\u4f8b\u3048\u3070\u3001-50%\u3068\u3059\u308b\u3068\u753b\u50cf\u306e\u4e0b\u534a\u5206\u304c\u753b\u9762\u7aef\u3088\u308a\u4e0b\u306b\u96a0\u308c\u307e\u3059\uff09\u3002\n\n\u3000\u6761\u4ef6\u306e\u300c\u6307\u5b9a\u753b\u50cf\u300d\u306f\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u753b\u50cf\u3042\u308b\u3044\u306f\u9854IC\u3067\u3059\u3002\u307e\u305f\u3001\u7279\u5225\u306a\u6761\u4ef6\u3068\u3057\u3066\u5e38\u306b\u3001\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u306e\u672b\u5c3e\u304c"@\u9000\u53bb"\u307e\u305f\u306f"@farewell"\u306e\u5834\u5408\u306f\u3001\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306e\u30b9\u30bf\u30f3\u30c9\u3092\u9000\u53bb\u3055\u305b\u307e\u3059\u3002\n\n\u3000\u512a\u5148\u9806\u4f4d\u306f\u9ad8\u3044\u3082\u306e\u304b\u3089\n\n\u3000\u3000\uff11. "@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\n\u3000\u3000\uff12. \u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3001\u30c1\u30e3\u30c3\u30c8\u30d1\u30cd\u30eb\u306e\u30ea\u30b9\u30c8\u3067\u9078\u629e\u3057\u305f\u540d\u524d\n\u3000\u3000\uff13. \u300c\u6307\u5b9a\u753b\u50cf \u304b\u3064 \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff14. \u300c\u6307\u5b9a\u753b\u50cf \u307e\u305f\u306f \u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff15. \u300c\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u300d\n\u3000\u3000\uff16. \u300c\u6307\u5b9a\u753b\u50cf\u300d\n\n\u3000\u3069\u306e\u6761\u4ef6\u3082\u6e80\u305f\u3055\u306a\u3044\u5834\u5408\u300c\u30c7\u30d5\u30a9\u30eb\u30c8\u300d\u306e\u3082\u306e\u304c\u4f7f\u7528\u3055\u308c\u3001\u540c\u3058\u512a\u5148\u9806\u4f4d\u306e\u6761\u4ef6\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u306f\u30e9\u30f3\u30c0\u30e0\u30671\u3064\u304c\u9078\u629e\u3055\u308c\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u4e00\u81f4\u3092\u5224\u5b9a\u3059\u308b\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u3079\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u533a\u5225\u3055\u308c\u307e\u305b\u3093\u3002\n\u3000\u307e\u305f\u3001"@\u9000\u53bb"\u3001"@farewell"\u306b\u3088\u308b\u9000\u53bb\u6642\u3001\u3042\u308b\u3044\u306f"@\u7b11\u3044"\u306e\u3088\u3046\u306b\u5148\u982d\u304c"@"\u3067\u59cb\u307e\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3057\u3066\u3044\u308b\u5834\u5408\u3001\uff08\u30b9\u30bf\u30f3\u30c9\u306e\u6709\u52b9\u7121\u52b9\u3001\u6761\u4ef6\u3092\u6e80\u305f\u3059\u304b\u306b\u95a2\u308f\u3089\u305a\uff09\u305d\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3067\u306e\u9001\u4fe1\u6642\u306b\u3001\u6761\u4ef6\u306b\u4e00\u81f4\u3059\u308b\u30c1\u30e3\u30c3\u30c8\u30c6\u30ad\u30b9\u30c8\u672b\u5c3e\u306e@\u4ee5\u4e0b\u306f\u5207\u308a\u843d\u3068\u3055\u308c\u307e\u3059\u3002'}imageElementToFile(e){return e?It.instance.get(e.value):null}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(li),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["app-stand-setting"]],viewQuery:function(e,i){if(1&e&&dn(ST,5),2&e){let r;un(r=fn())&&(i.standElementComponents=r)}},inputs:{character:"character"},decls:27,vars:10,consts:[[2,"margin-bottom","4px"],[2,"float","right",3,"click"],[1,"position-indicate"],["type","range","min","0","max","100",2,"width","350px",3,"ngModel","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],["sytle","margin-left: 3px; margin-right: 1em "],["type","number","min","0","max","200",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","ngModelChange"],[1,"overview-selecter",2,"padding","0px","width","695px"],[2,"font-size","smaller","font-weight","bolder"],["type","radio","value","-1",3,"name","checked","click"],[2,"display","flex","flex-direction","row","flex-wrap","wrap"],["style","width: 700px",4,"ngFor","ngForOf"],[3,"click"],[3,"click",4,"ngIf"],[2,"width","700px"],[1,"overview-selecter",2,"display","flex","flex-direction","row","justify-content","space-between"],[2,"display","flex","align-items","center","justify-content","center"],["type","radio",2,"z-index","10",3,"name","value","checked","click"],[2,"margin-left","-1em","margin-right","-1em"],[3,"standElement","imageList","gameCharacter"],["standElementComponent",""],[2,"text-align","right","width","3em"],[1,"remove-button","danger",3,"click"],[1,"remove-button",2,"margin-top","5px",3,"click"],[1,"remove-button",2,"margin-top","2px",3,"click"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"button",1),Ie("click",function(){return i.helpStandSeteing()}),be(2,"?"),te(),X(3,"div",2)(4,"b"),be(5,"Pos: "),te(),X(6,"input",3),Ie("ngModelChange",function(s){return i.position=s}),te(),X(7,"input",4),Ie("ngModelChange",function(s){return i.position=s}),te(),X(8,"b",5),be(9,"\uff05\u3000"),te()(),X(10,"div",2)(11,"b"),be(12,"Height (0=\u5143\u753b\u50cf\u306e\u307e\u307e): "),te(),X(13,"input",3),Ie("ngModelChange",function(s){return i.height=s}),te(),X(14,"input",6),Ie("ngModelChange",function(s){return i.height=s}),te(),X(15,"b",5),be(16,"\uff05"),te()()(),X(17,"div",7)(18,"label",8)(19,"input",9),Ie("click",function(){return i.overviewIndex=-1}),te(),be(20," \u30b9\u30bf\u30f3\u30c9\u753b\u50cf\u3092\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u4f7f\u7528\u3057\u306a\u3044"),te()(),nt(21,"hr"),X(22,"div",10),xe(23,Oj,15,8,"div",11),te(),X(24,"button",12),Ie("click",function(){return i.add()}),be(25,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a\u306e\u8ffd\u52a0"),te(),xe(26,Bj,2,0,"button",13)),2&e&&(W(6),re("ngModel",i.position),W(1),re("ngModel",i.position),W(6),re("ngModel",i.height),W(1),re("ngModel",i.height),W(3),Je("border-color",-1==i.overviewIndex?"red":"transparent"),W(2),sr("name","",i.panelId,"_overviewIndex"),re("checked",-1==i.overviewIndex),W(4),re("ngForOf",i.standElements),W(3),re("ngIf",i.standSettingXML))},directives:[fs,si,oi,ei,Co,yo,ds,Jn,ST,gn],styles:[".position-indicate[_ngcontent-%COMP%]{display:inline-block;font-size:smaller}.description[_ngcontent-%COMP%]{font-size:smaller}.remove-button[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;font-size:smaller;margin-top:-4px;margin-right:-1px}.overview-selecter[_ngcontent-%COMP%]{border:2px solid red;border-radius:8px;padding-top:1px;padding-bottom:4px}input[type=radio][_ngcontent-%COMP%]{width:1.5em;height:1.5em}"]}),t})();var No,Qd=(()=>(function(t){t.ASC="ASC",t.DESC="DESC"}(Qd||(Qd={})),Qd))();let Fo=No=class extends La{constructor(){super(...arguments),this.sortTag="name",this.sortOrder=Qd.ASC,this.dataTag="HP MP \u654f\u6377\u5ea6 \u751f\u547d\u529b \u7cbe\u795e\u529b"}static get instance(){return No._instance||(No._instance=new No("DataSummarySetting"),No._instance.initialize()),No._instance}get dataTags(){return this._dataTag!==this.dataTag&&(this._dataTag=this.dataTag,this._dataTags=null!=this.dataTag&&0<this.dataTag.trim().length?this.dataTag.trim().split(/\s+/):[]),this._dataTags}innerXml(){return""}parseInnerXml(n){let e=No.instance.toContext();e.syncData=this.toContext().syncData,No.instance.apply(e),No.instance.update(),this.destroy()}};var Kp;B([st()],Fo.prototype,"sortTag",void 0),B([st()],Fo.prototype,"sortOrder",void 0),B([st()],Fo.prototype,"dataTag",void 0),Fo=No=B([Kn("summary-setting")],Fo);let Jr=Kp=class extends mi{constructor(){super(...arguments),this.isLock=!1,this.blendType=0,this.isTransparentOnGMMode=!1}get name(){return this.getCommonValue("name","")}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get opacity(){let n=this.getElement("opacity",this.commonDataElement),e=n?n.currentValue/n.value:1;return Number.isNaN(e)?1:e}get fontsize(){let n=this.getElement("fontsize",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(dt.create("fontsize",18,{},"fontsize_"+this.identifier)),n?+n.value:18}set fontsize(n){this.setCommonValue("fontsize",n)}get text(){let n=this.getElement("text",this.commonDataElement);return!n&&this.commonDataElement&&this.commonDataElement.appendChild(dt.create("text","",{type:"note",currentValue:""},"text_"+this.identifier)),n?n.value+"":""}set text(n){this.setCommonValue("text",n)}get color(){let n=this.getElement("color",this.commonDataElement);return n?n.value+"":"#555555"}set color(n){this.setCommonValue("color",n)}get bgcolor(){let n=this.getElement("color",this.commonDataElement);return n?n.currentValue+"":"#0a0a0a"}set bgcolor(n){let e=this.getElement("color",this.commonDataElement);e&&(e.currentValue=n)}static create(n,e,i,r,s){let o=null;return o=s?new Kp(s):new Kp,o.createDataElements(),o.commonDataElement.appendChild(dt.create("name",n,{},"name_"+o.identifier)),o.commonDataElement.appendChild(dt.create("width",e,{},"width_"+o.identifier)),o.commonDataElement.appendChild(dt.create("height",i,{},"height_"+o.identifier)),o.commonDataElement.appendChild(dt.create("opacity",r,{type:"numberResource",currentValue:r},"opacity_"+o.identifier)),o.commonDataElement.appendChild(dt.create("fontsize",18,{},"fontsize_"+o.identifier)),o.commonDataElement.appendChild(dt.create("text","",{type:"note",currentValue:""},"text_"+o.identifier)),o.commonDataElement.appendChild(dt.create("color","#555555",{type:"colors",currentValue:"#0a0a0a"},"ccolor_"+o.identifier)),o.commonDataElement.appendChild(dt.create("altitude",0,{},"altitude_"+o.identifier)),o.initialize(),o}};B([st()],Jr.prototype,"isLock",void 0),B([st()],Jr.prototype,"blendType",void 0),B([st()],Jr.prototype,"isTransparentOnGMMode",void 0),Jr=Kp=B([Kn("table-mask")],Jr);var Yp,oa=(()=>(function(t){t[t.NULL=0]="NULL",t[t.FLOOR=1]="FLOOR",t[t.WALL=2]="WALL",t[t.ALL=3]="ALL"}(oa||(oa={})),oa))(),Zn=(()=>(function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.BOTTOM=2]="BOTTOM",t[t.LEFT=3]="LEFT",t[t.RIGHT=4]="RIGHT"}(Zn||(Zn={})),Zn))();let nr=Yp=class extends mi{constructor(){super(...arguments),this.isLocked=!1,this.mode=oa.ALL,this.rotate=0,this.isDropShadow=!0,this.isSurfaceShading=!0,this.isInteract=!0,this.isSlope=!1,this.slopeDirection=Zn.NONE}get width(){return this.getCommonValue("width",1)}set width(n){this.setCommonValue("width",n)}get height(){return this.getCommonValue("height",1)}set height(n){this.setCommonValue("height",n)}get depth(){return this.getCommonValue("depth",1)}set depth(n){this.setCommonValue("depth",n)}get name(){return this.getCommonValue("name","")}set name(n){this.setCommonValue("name",n)}get wallImage(){return this.getImageFile("wall")}get floorImage(){return this.getImageFile("floor")}get hasWall(){return!!(this.mode&oa.WALL)}get hasFloor(){return!!(this.mode&oa.FLOOR)}static create(n,e,i,r,s,o,d){let $=null;return $=d?new Yp(d):new Yp,$.createDataElements(),$.commonDataElement.appendChild(dt.create("name",n,{},"name_"+$.identifier)),$.commonDataElement.appendChild(dt.create("width",e,{},"width_"+$.identifier)),$.commonDataElement.appendChild(dt.create("height",r,{},"height_"+$.identifier)),$.commonDataElement.appendChild(dt.create("depth",i,{},"depth_"+$.identifier)),$.commonDataElement.appendChild(dt.create("altitude",0,{},"altitude_"+$.identifier)),$.imageDataElement.appendChild(dt.create("wall",s,{type:"image"},"wall_"+$.identifier)),$.imageDataElement.appendChild(dt.create("floor",o,{type:"image"},"floor_"+$.identifier)),$.initialize(),$}};B([st()],nr.prototype,"isLocked",void 0),B([st()],nr.prototype,"mode",void 0),B([st()],nr.prototype,"rotate",void 0),B([st()],nr.prototype,"isDropShadow",void 0),B([st()],nr.prototype,"isSurfaceShading",void 0),B([st()],nr.prototype,"isInteract",void 0),B([st()],nr.prototype,"isSlope",void 0),B([st()],nr.prototype,"slopeDirection",void 0),nr=Yp=B([Kn("terrain")],nr);var aa=(()=>(function(t){t[t.NONE=-1]="NONE",t[t.SQUARE=0]="SQUARE",t[t.HEX_VERTICAL=1]="HEX_VERTICAL",t[t.HEX_HORIZONTAL=2]="HEX_HORIZONTAL"}(aa||(aa={})),aa))(),Zp=(()=>(function(t){t.NONE="",t.WHITE="white",t.BLACK="black"}(Zp||(Zp={})),Zp))();let Fi=class extends Ln{constructor(){super(...arguments),this.name="\u30c6\u30fc\u30d6\u30eb",this.width=20,this.height=20,this.gridSize=50,this.imageIdentifier="imageIdentifier",this.backgroundImageIdentifier="imageIdentifier",this.backgroundFilterType=Zp.NONE,this.selected=!1,this.gridType=aa.SQUARE,this.gridColor="#000000e6",this.isShowNumber=!0,this.gridHeight=0}get terrains(){let n=[];return this.children.forEach(e=>{e instanceof nr&&n.push(e)}),n}get masks(){let n=[];return this.children.forEach(e=>{e instanceof Jr&&n.push(e)}),n}onStoreAdded(){super.onStoreAdded(),this.selected&&Fe.trigger("SELECT_GAME_TABLE",{identifier:this.identifier})}};var Xp;B([st()],Fi.prototype,"name",void 0),B([st()],Fi.prototype,"width",void 0),B([st()],Fi.prototype,"height",void 0),B([st()],Fi.prototype,"gridSize",void 0),B([st()],Fi.prototype,"imageIdentifier",void 0),B([st()],Fi.prototype,"backgroundImageIdentifier",void 0),B([st()],Fi.prototype,"backgroundFilterType",void 0),B([st()],Fi.prototype,"selected",void 0),B([st()],Fi.prototype,"gridType",void 0),B([st()],Fi.prototype,"gridColor",void 0),B([st()],Fi.prototype,"isShowNumber",void 0),Fi=B([Kn("game-table")],Fi);let vs=Xp=class extends mi{constructor(){super(...arguments),this.rotate=0,this.zindex=0,this.password="",this.isUpright=!0,this.isLocked=!1}get width(){return this.getCommonValue("width",1)}get height(){return this.getCommonValue("height",1)}get fontSize(){return this.getCommonValue("fontsize",1)}get title(){return this.getCommonValue("title","")}get text(){return this.getCommonValue("text","")}set text(n){this.setCommonValue("text",n)}toTopmost(){q0(this)}static create(n,e,i=16,r=1,s=1,o){let d=o?new Xp(o):new Xp;return d.createDataElements(),d.commonDataElement.appendChild(dt.create("width",r,{},"width_"+d.identifier)),d.commonDataElement.appendChild(dt.create("height",s,{},"height_"+d.identifier)),d.commonDataElement.appendChild(dt.create("fontsize",i,{},"fontsize_"+d.identifier)),d.commonDataElement.appendChild(dt.create("title",n,{},"title_"+d.identifier)),d.commonDataElement.appendChild(dt.create("text",e,{type:"note",currentValue:e},"text_"+d.identifier)),d.commonDataElement.appendChild(dt.create("altitude",0,{},"altitude_"+d.identifier)),d.initialize(),d}};B([st()],vs.prototype,"rotate",void 0),B([st()],vs.prototype,"zindex",void 0),B([st()],vs.prototype,"password",void 0),B([st()],vs.prototype,"isUpright",void 0),B([st()],vs.prototype,"isLocked",void 0),vs=Xp=B([Kn("text-note")],vs);let K0=class extends La{onStoreAdded(){super.onStoreAdded(),rt.instance.remove(this)}innerXml(){let n="",e=[];e=e.concat(rt.instance.getObjects(Fi)),e=e.concat(rt.instance.getObjects(jt)),e=e.concat(rt.instance.getObjects(vs)),e=e.concat(rt.instance.getObjects(Un)),e=e.concat(rt.instance.getObjects(Fn).filter(i=>null===i.parent)),e=e.concat(rt.instance.getObjects(tr));for(let i of e)n+=i.toXml();return n}parseInnerXml(n){let e=[];e=e.concat(rt.instance.getObjects(Fi)),e=e.concat(rt.instance.getObjects(Jr)),e=e.concat(rt.instance.getObjects(nr)),e=e.concat(rt.instance.getObjects(jt)),e=e.concat(rt.instance.getObjects(vs)),e=e.concat(rt.instance.getObjects(Un)),e=e.concat(rt.instance.getObjects(Fn)),e=e.concat(rt.instance.getObjects(tr));for(let i of e)i.destroy();for(let i=0;i<n.children.length;i++)Gn.instance.parseXml(n.children[i])}};K0=B([Kn("room")],K0);var Lj=Y(1203);class Cr{constructor(n,e){this.ngZone=n,this.chatMessageService=e}saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){return this.chatMessageService.sendOperationLog(`\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf ${n}.zip \u3092\u4fdd\u5b58`),Cr.queue.add((i,r)=>i(this._saveRoomAsync(n,e)))}_saveRoomAsync(n="fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf",e){let i=[],r=this.convertToXml(new K0),s=this.convertToXml(ao.instance),o=this.convertToXml(ro.instance),d=this.convertToXml(oo.instance),$=this.convertToXml(Fo.instance);i.push(new File([r],"fly_data.xml",{type:"text/plain"})),i.push(new File([s],"fly_chat.xml",{type:"text/plain"})),i.push(new File([o],"fly_rollTable.xml",{type:"text/plain"})),i.push(new File([d],"fly_cutIn.xml",{type:"text/plain"})),i.push(new File([$],"summary.xml",{type:"text/plain"}));let I=[];I=I.concat(this.searchImageFiles(r)),I=I.concat(this.searchImageFiles(s)),I=I.concat(this.searchImageFiles(d));for(const fe of I)fe.state===Ni.COMPLETE&&i.push(new File([fe.blob],fe.identifier+"."+Ll.extension(fe.blob.type),{type:fe.blob.type}));let Q=this.convertToXml(br.create(I));return i.push(new File([Q],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(i,this.appendTimestamp(n),e)}saveGameObjectAsync(n,e="fly_xml_data",i){return this.chatMessageService.sendOperationLog(`${et.aliasNameToClassName(n.aliasName)}\u306e\u30c7\u30fc\u30bf ${e}.zip \u3092\u4fdd\u5b58`),Cr.queue.add((r,s)=>r(this._saveGameObjectAsync(n,e,i)))}_saveGameObjectAsync(n,e="fly_xml_data",i){let r=[],s=this.convertToXml(n);r.push(new File([s],"fly_data.xml",{type:"text/plain"}));let o=[];o=o.concat(this.searchImageFiles(s));for(const $ of o)$.state===Ni.COMPLETE&&r.push(new File([$.blob],$.identifier+"."+Ll.extension($.blob.type),{type:$.blob.type}));let d=this.convertToXml(br.create(o));return r.push(new File([d],"fly_imageTag.xml",{type:"text/plain"})),this.saveAsync(r,this.appendTimestamp(e),i)}saveAsync(n,e,i){let r=-1;return Ao.instance.saveAsync(n,e,s=>{let o=0|s.percent;o<=r||(r=o,this.ngZone.run(()=>i(r)))})}convertToXml(n){return'<?xml version="1.0" encoding="UTF-8"?>\n'+Lj.xml(n.toXml(),2)}searchImageFiles(n){let e=ra.xml2element(n),i=[];if(!e)return i;let r={},s=e.ownerDocument.querySelectorAll('*[type="image"]');for(let o=0;o<s.length;o++){let d=s[o].innerHTML;r[d]=It.instance.get(d);let $=s[o].getAttribute("currentValue");$&&(r[$]=It.instance.get($))}s=e.ownerDocument.querySelectorAll("*[imageIdentifier], *[toImageIdentifier], *[backgroundImageIdentifier]");for(let o=0;o<s.length;o++){let d=s[o].getAttribute("imageIdentifier");d&&(r[d]=It.instance.get(d));let $=s[o].getAttribute("toImageIdentifier");$&&(r[d]=It.instance.get($));let I=s[o].getAttribute("backgroundImageIdentifier");I&&(r[I]=It.instance.get(I))}for(let o in r){let d=r[o];d&&i.push(d)}return i}appendTimestamp(n){let e=new Date;return n+`_${e.getFullYear()}-${("00"+(e.getMonth()+1)).slice(-2)}-${("00"+e.getDate()).slice(-2)}_${("00"+e.getHours()).slice(-2)}${("00"+e.getMinutes()).slice(-2)}`}saveChatLog(n,e,i=null,r="HH:mm",s=!0){const o=0==n?"text/plain":"text/html",d=0==n?".txt":".html",$="fly_"+this.appendTimestamp(e)+d;this.chatMessageService.sendOperationLog(`\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0 ${$} \u3092\u4fdd\u5b58`),xT(new Blob([i?i.log(n,r,s):ao.instance.log(n,r,s)],{type:`${o};charset=utf-8`}),$)}}Cr.queue=new V3("SaveDataServiceQueue"),Cr.\u0275fac=function(n){return new(n||Cr)(tn(bn),tn(yr))},Cr.\u0275prov=Zt({token:Cr,factory:Cr.\u0275fac,providedIn:"root"});class Ls{constructor(n,e){this.elementRef=n,this.chatMessageService=e,this.isDisable=!1,this.timeout=666,this.showValue=!0,this.type="\u30aa\u30d6\u30b8\u30a7\u30af\u30c8"}ngAfterViewInit(){let n=this.dataElement;for(;(n=n.parent)&&(n instanceof Fn&&(this.type="\u30ab\u30fc\u30c9"),n instanceof Un&&(this.type="\u5c71\u672d"),n instanceof tr&&(this.type=n.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9"),n instanceof jt&&(this.type="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc"),n instanceof Jr&&(this.type="\u30de\u30c3\u30d7\u30de\u30b9\u30af"),n instanceof nr&&(this.type="\u5730\u5f62"),n instanceof vs&&(this.type="\u5171\u6709\u30e1\u30e2"),n.parentIsAssigned&&!n.parentIsUnknown););const e=Ls.LoggingValueMap,i=this.dataElement.identifier,r=this.elementRef.nativeElement;e.set(i,{oldValue:this.loggingValue}),r.addEventListener("input",()=>{e.get(i).timerId&&clearTimeout(e.get(i).timerId),e.get(i).timerId=setTimeout(()=>{this.doLogging()},this.timeout)})}ngOnDestroy(){const n=Ls.LoggingValueMap,e=this.dataElement.identifier;n.get(e)&&n.get(e).timerId&&this.doLogging()}doLogging(){const n=Ls.LoggingValueMap,e=this.dataElement.identifier;n.get(e).timerId&&(clearTimeout(n.get(e).timerId),n.get(e).timerId=null);const i=n.get(e).oldValue,r=this.loggingValue,s=this.dataElement;if(!this.isDisable&&r!=i){let o=`${""==this.name?`(\u7121\u540d\u306e${this.type})`:this.name} \u306e ${""==s.name?"(\u7121\u540d\u306e\u5909\u6570)":s.name} \u3092\u5909\u66f4`;this.showValue&&(s.isSimpleNumber||s.isNumberResource||s.isAbilityScore)?o+=` ${i} \u2192 ${r}`:s.isCheckProperty&&(o+=` ${r}`),this.chatMessageService.sendOperationLog(o)}n.get(e).oldValue=r}get loggingValue(){const n=this.dataElement;if(!n)return;let e;if(n.isSimpleNumber)e=`${n.value}`;else if(n.isNumberResource)e=`${n.currentValue}/${n.value&&0!=n.value?n.value:"???"}`;else if(n.isCheckProperty)e=n.value?" \u2192 \u2714ON":" \u2192 OFF";else if(n.isAbilityScore){const i=n.calcAbilityScore();e=`${n.value}`,n.currentValue&&(e+=`(${i>=0?"+":""}${i})`)}else e=n.value?n.value.toString():"";return e}}function zj(t,n){1&t&&$n(0)}function jj(t,n){if(1&t){const e=Ye();X(0,"div",3),xe(1,zj,1,0,"ng-container",5),X(2,"select",6),Ie("change",function(r){return ke(e),ge(3).setElementType(r.target.value)}),X(3,"option",7),be(4,"\u901a\u5e38"),te(),X(5,"option",8),be(6,"\u6570\u5024"),te(),X(7,"option",9),be(8,"\u30ea\u30bd\u30fc\u30b9"),te(),X(9,"option",10),be(10,"\u80fd\u529b\u5024"),te(),X(11,"option",11),be(12,"\u30c1\u30a7\u30c3\u30af"),te(),X(13,"option",12),be(14,"\u30ce\u30fc\u30c8"),te(),X(15,"option",13),be(16,"\u53c2\u7167URL"),te()()()}if(2&t){const e=ge(3),i=Wt(2);W(1),re("ngTemplateOutlet",i),W(1),re("ngModel",e.gameDataElement.type)}}function Uj(t,n){1&t&&(Ge(0),nt(1,"br"),X(2,"span",15),be(3,"0=\u753b\u50cf\u4f9d\u5b58"),te(),qe())}function Hj(t,n){if(1&t&&(Ge(0),X(1,"span",14),be(2),te(),xe(3,Uj,4,0,"ng-container",0),qe()),2&t){const e=ge(3);W(2),Ze(e.name),W(1),re("ngIf","character"===e.descriptionType&&"height"===e.name)}}function Vj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",16),be(2),te(),X(3,"input",17),Ie("ngModelChange",function(r){return ke(e),ge(3).name=r}),te(),qe()}if(2&t){const e=ge(3);W(2),Ze(e.name),W(1),re("ngModel",e.name)}}function Gj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",18),Ie("ngModelChange",function(r){return ke(e),ge(4).currentValue=r}),bt(2,"safe"),te(),nt(3,"br"),X(4,"input",19),Ie("ngModelChange",function(r){return ke(e),ge(4).currentValue=r}),te(),X(5,"b",20),be(6,"%"),te(),qe()}if(2&t){const e=ge(4);W(1),Dr(yt(2,5,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),it("title",e.currentValue),re("ngModel",e.currentValue),W(3),re("ngModel",e.currentValue)}}function qj(t,n){if(1&t){const e=Ye();X(0,"dev",24)(1,"label")(2,"input",25),Ie("ngModelChange",function(r){return ke(e),ge(5).currentValue=r})("change",function(){ke(e);const r=ge(5);return r.currentValue=r.currentValue?r.name:""}),te(),be(3,"\xd7 size"),te()()}if(2&t){const e=ge(5);W(2),it("checked",e.currentValue?"checked":""),re("ngModel",e.currentValue)}}function Wj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",21),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),bt(2,"safe"),te(),nt(3,"br"),X(4,"input",22),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),xe(5,qj,4,2,"dev",23),qe()}if(2&t){const e=ge(4);W(1),Dr(yt(2,11,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),it("title",e.value),it("min","altitude"===e.name?-12:"fontsize"===e.name?1:0),it("max","fontsize"===e.name?128:12),it("step","fontsize"===e.name?1:.5),re("ngModel",e.value),W(3),it("min","altitude"===e.name?-24:"fontsize"===e.name?1:0),it("step","fontsize"===e.name?1:.1),re("ngModel",e.value),W(1),re("ngIf","character"===e.descriptionType&&"height"===e.name)}}function Kj(t,n){if(1&t&&(Ge(0),xe(1,Gj,7,8,"ng-container",0),xe(2,Wj,6,14,"ng-container",0),qe()),2&t){const e=ge(3);W(1),re("ngIf","opacity"==e.name),W(1),re("ngIf","opacity"!=e.name)}}function Yj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",29),be(2),te(),X(3,"input",30),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),qe()}if(2&t){const e=ge(4);W(2),Ze(e.value),W(1),it("type",e.isNum(e.value)?"number":"text"),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function Zj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",31),Ie("ngModelChange",function(r){return ke(e),ge(4).currentValue=r}),bt(2,"safe"),te(),nt(3,"br"),X(4,"input",32),Ie("ngModelChange",function(r){return ke(e),ge(4).currentValue=r}),te(),be(5," / "),X(6,"input",33),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),qe()}if(2&t){const e=ge(4);W(1),Dr(yt(2,16,"font-size: 1.0em; min-width: 90px; width: 90%; --min: 0; --max: "+e.value+"; --val:"+e.currentValue+";","style")),it("title",e.currentValue),it("max",e.isNum(e.value)?e.value:1e3),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),W(3),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.currentValue),W(2),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value)}}function Xj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"select",35),Ie("ngModelChange",function(r){return ke(e),ge(5).currentValue=r}),X(2,"option",7),be(3,"\u306a\u3057"),te(),X(4,"option",36),be(5,"\xf72"),te(),X(6,"option",37),be(7,"\xf73 SRS,LHZ"),te(),X(8,"option",38),be(9,"\xf74"),te(),X(10,"option",39),be(11,"\xf75"),te(),X(12,"option",40),be(13,"\xf76 SW"),te(),X(14,"option",41),be(15,"\xf710"),te(),X(16,"option",42),be(17,"D&D 3e\uff5e"),te()(),qe()}if(2&t){const e=ge(5);W(1),re("ngModel",e.currentValue)}}function Qj(t,n){if(1&t&&(Ge(0),X(1,"span",43),be(2),te(),qe()),2&t){const e=ge(5);W(2),Ze("("+(e.abilityScore>=0?"+":"")+e.abilityScore+")")}}function Jj(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",34),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),xe(2,Xj,18,1,"ng-container",0),xe(3,Qj,3,1,"ng-container",0),qe()}if(2&t){const e=ge(4);W(1),it("type",e.isNum(e.value)?"number":"text"),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),W(1),re("ngIf",e.isEdit),W(1),re("ngIf",!e.isEdit&&e.currentValue)}}function eU(t,n){if(1&t){const e=Ye();X(0,"input",47),Ie("ngModelChange",function(r){return ke(e),ge(5).currentValue=r}),te()}2&t&&re("ngModel",ge(5).currentValue)}function tU(t,n){if(1&t&&(X(0,"span",48),be(1),te()),2&t){const e=ge(5);W(1),Ze(e.currentValue)}}function nU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",44),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r})("change",function(){ke(e);const r=ge(4);return r.value=r.value?r.name:""}),te(),xe(2,eU,1,1,"input",45),xe(3,tU,2,1,"span",46),qe()}if(2&t){const e=ge(4);W(1),it("checked",e.value?"checked":""),re("logging.name",e.tableTopObjectName)("logging.dataElement",e.gameDataElement)("logging.disable",e.isNoLogging)("ngModel",e.value),W(1),re("ngIf",e.isEdit),W(1),re("ngIf",!e.isEdit&&e.value)}}function iU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"textarea",49),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),qe()}if(2&t){const e=ge(4);W(1),re("ngModel",e.value)}}function rU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",29),be(2),te(),X(3,"span",50)(4,"input",51),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),X(5,"button",52),Ie("click",function(){ke(e);const r=ge(4);return!!r.stringUtil.validUrl(r.value)&&r.openUrl(r.value)}),X(6,"i",53),be(7),te()()(),qe()}if(2&t){const e=ge(4);W(2),Ze(e.value),W(2),re("ngModel",e.value),W(1),Rt("disabled",e.stringUtil.validUrl(e.value)?null:""),W(2),Ze(e.stringUtil.validUrl(e.value)?e.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function sU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"label",54)(2,"input",55),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),be(3),te(),X(4,"label",56)(5,"input",55),Ie("ngModelChange",function(r){return ke(e),ge(4).currentValue=r}),te(),be(6),te(),qe()}if(2&t){const e=ge(4);W(1),Je("color",e.value)("background-color",e.currentValue),W(1),re("ngModel",e.value),W(1),Ze(e.value),W(1),Je("color",e.value)("background-color",e.currentValue),W(1),re("ngModel",e.currentValue),W(1),An("(",e.currentValue,")")}}function oU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"label",54)(2,"input",55),Ie("ngModelChange",function(r){return ke(e),ge(4).value=r}),te(),be(3),te(),qe()}if(2&t){const e=ge(4);W(1),Je("color",e.value),W(1),re("ngModel",e.value),W(1),Ze(e.value)}}function aU(t,n){if(1&t){const e=Ye();X(0,"input",59),Ie("ngModelChange",function(r){return ke(e),ge(5).value=r}),te()}2&t&&re("ngModel",ge(5).value)}function lU(t,n){1&t&&(X(0,"span",60),be(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),te())}function cU(t,n){if(1&t&&(Ge(0),X(1,"div",29),be(2),te(),xe(3,aU,1,1,"input",57),xe(4,lU,2,0,"span",58),qe()),2&t){const e=ge(4);W(2),Ze(e.value),W(1),re("ngIf",!(e.isHideText&&e.isTableTopObjectName)),W(1),re("ngIf",e.isHideText&&e.isTableTopObjectName)}}function uU(t,n){if(1&t&&(Ge(0)(1,26),xe(2,Yj,4,6,"ng-container",27),xe(3,Zj,7,19,"ng-container",27),xe(4,Jj,4,7,"ng-container",27),xe(5,nU,4,7,"ng-container",27),xe(6,iU,2,1,"ng-container",27),xe(7,rU,8,4,"ng-container",27),xe(8,sU,7,12,"ng-container",27),xe(9,oU,4,4,"ng-container",27),xe(10,cU,5,3,"ng-container",28),qe()()),2&t){const e=ge(3);W(1),re("ngSwitch",e.gameDataElement.type),W(1),re("ngSwitchCase","simpleNumber"),W(1),re("ngSwitchCase","numberResource"),W(1),re("ngSwitchCase","abilityScore"),W(1),re("ngSwitchCase","checkProperty"),W(1),re("ngSwitchCase","note"),W(1),re("ngSwitchCase","url"),W(1),re("ngSwitchCase","colors"),W(1),re("ngSwitchCase","color")}}function dU(t,n){if(1&t&&(Ge(0),xe(1,jj,17,2,"div",2),X(2,"div",3),xe(3,Hj,4,2,"ng-container",0),xe(4,Vj,4,2,"ng-container",0),te(),X(5,"div",4),xe(6,Kj,3,2,"ng-container",0),xe(7,uU,11,9,"ng-container",0),te(),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isEdit),W(2),re("ngIf",e.isTagLocked),W(1),re("ngIf",!e.isTagLocked),W(2),re("ngIf",e.isCommonValue),W(1),re("ngIf",!e.isCommonValue)}}function fU(t,n){1&t&&$n(0)}function hU(t,n){if(1&t&&(X(0,"div",66),xe(1,fU,1,0,"ng-container",5),te()),2&t){ge(3);const e=Wt(2);W(1),re("ngTemplateOutlet",e)}}function pU(t,n){if(1&t&&(Ge(0),X(1,"div",67),be(2),te(),qe()),2&t){const e=ge(3);W(2),Ze(e.name)}}function gU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",68),Ie("ngModelChange",function(r){return ke(e),ge(3).name=r}),te(),qe()}if(2&t){const e=ge(3);W(1),re("ngModel",e.name)}}function mU(t,n){if(1&t&&nt(0,"div",71),2&t){const e=n.$implicit,i=ge(4);re("gameDataElement",e)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isTagLocked",i.isTagLocked)("isHideText",i.isHideText)("isNoLogging",i.isNoLogging)("descriptionType",i.descriptionType)}}function _U(t,n){if(1&t&&(X(0,"div",69),xe(1,mU,1,7,"div",70),te()),2&t){const e=ge(3);W(1),re("ngForOf",e.gameDataElement.children)}}function $U(t,n){if(1&t&&(Ge(0),xe(1,hU,2,1,"div",61),nt(2,"div",62),X(3,"div",63)(4,"div",64),xe(5,pU,3,1,"ng-container",0),xe(6,gU,2,1,"ng-container",0),te(),xe(7,_U,2,1,"div",65),te(),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isEdit),W(3),Je("border-color",e.isTagLocked&&"common"===e.name?"transparent":""),W(1),re("ngIf",e.isTagLocked&&"common"!=e.name),W(1),re("ngIf",!e.isTagLocked),W(1),re("ngIf",0<e.gameDataElement.children.length)}}function vU(t,n){if(1&t&&(Ge(0),xe(1,dU,8,5,"ng-container",0),xe(2,$U,8,6,"ng-container",0),qe()),2&t){const e=ge();W(1),re("ngIf",e.gameDataElement.children.length<1),W(1),re("ngIf",0<e.gameDataElement.children.length)}}function bU(t,n){if(1&t){const e=Ye();X(0,"button",72),Ie("click",function(){return ke(e),ge().addElement()}),X(1,"i",73),be(2,"add_circle"),te()(),X(3,"button",72),Ie("click",function(){return ke(e),ge().upElement()}),X(4,"i",73),be(5,"arrow_upward"),te()(),nt(6,"br"),X(7,"button",72),Ie("click",function(){return ke(e),ge().deleteElement()}),X(8,"i",73),be(9,"remove_circle_outline"),te()(),X(10,"button",72),Ie("click",function(){return ke(e),ge().downElement()}),X(11,"i",73),be(12,"arrow_downward"),te()()}}Ls.LoggingValueMap=new Map,Ls.\u0275fac=function(n){return new(n||Ls)(Oe(pi),Oe(yr))},Ls.\u0275dir=Gt({type:Ls,selectors:[["","appLogging",""]],inputs:{isDisable:["logging.disable","isDisable"],timeout:["logging.timeout","timeout"],name:["logging.name","name"],dataElement:["logging.dataElement","dataElement"],showValue:["logging.loggingValue","showValue"]}});let yU=(()=>{class t{constructor(e,i){this.changeDetector=e,this.modalService=i,this.tableTopObjectName=null,this.gameDataElement=null,this.isEdit=!1,this.isTagLocked=!1,this.isValueLocked=!1,this.isHideText=!1,this.isNoLogging=!1,this.stringUtil=et,this._name="",this._value=0,this._currentValue=0,this.updateTimer=null}get name(){return this._name}set name(e){this._name=e,this.setUpdateTimer()}get value(){return this._value}set value(e){this._value=e,this.setUpdateTimer()}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue=e,this.setUpdateTimer()}get abilityScore(){return this.gameDataElement.calcAbilityScore()}get isTableTopObjectName(){return this.isTagLocked&&"name"===this.gameDataElement.name}get isCommonValue(){return!!this.gameDataElement&&this.isTagLocked&&("size"===this.gameDataElement.name||"width"===this.gameDataElement.name||"height"===this.gameDataElement.name||"depth"===this.gameDataElement.name||"fontsize"===this.gameDataElement.name||"opacity"===this.gameDataElement.name||"altitude"===this.gameDataElement.name)}get identifier(){return this.gameDataElement.identifier}ngOnInit(){this.gameDataElement&&this.setValues(this.gameDataElement),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{this.gameDataElement&&e.data.identifier===this.gameDataElement.identifier&&(this.setValues(this.gameDataElement),this.changeDetector.markForCheck())}).on("DELETE_GAME_OBJECT",e=>{this.gameDataElement&&this.gameDataElement.identifier===e.data.identifier&&this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}ngAfterViewInit(){}addElement(){this.gameDataElement.appendChild(dt.create("\u30bf\u30b0","",{}))}deleteElement(){this.gameDataElement.destroy()}upElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);0<i&&e.insertBefore(this.gameDataElement,e.children[i-1])}downElement(){let e=this.gameDataElement.parent,i=e.children.indexOf(this.gameDataElement);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.gameDataElement)}setElementType(e){this.gameDataElement.setAttribute("type",e)}isNum(e){return isFinite(e)}openUrl(e){et.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:e,title:this.tableTopObjectName,subTitle:this.name})}setValues(e){this._name=e.name,this._currentValue=e.currentValue,this._value=e.value}setUpdateTimer(){clearTimeout(this.updateTimer),this.updateTimer=setTimeout(()=>{this.gameDataElement.name!==this.name&&(this.gameDataElement.name=this.name),this.gameDataElement.currentValue!==this.currentValue&&(this.gameDataElement.currentValue=this.currentValue),this.gameDataElement.value!==this.value&&(this.gameDataElement.value=this.value),this.updateTimer=null},66)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Di),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["game-data-element"],["","game-data-element",""]],inputs:{tableTopObjectName:"tableTopObjectName",gameDataElement:"gameDataElement",isEdit:"isEdit",isTagLocked:"isTagLocked",isValueLocked:"isValueLocked",isHideText:"isHideText",isNoLogging:"isNoLogging",descriptionType:"descriptionType"},decls:3,vars:1,consts:[[4,"ngIf"],["editButtons",""],["class","table-cell table-cell_solid",4,"ngIf"],[1,"table-cell","table-cell_solid"],[1,"table-cell"],[4,"ngTemplateOutlet"],[3,"ngModel","change"],["value",""],["value","simpleNumber"],["value","numberResource"],["value","abilityScore"],["value","checkProperty"],["value","note"],["value","url"],[2,"font-family","Cambria, Georgia","font-size","0.9rem"],[2,"font-size","0.4rem"],[1,"hidden-spacer",2,"font-family","Cambria, Georgia","font-size","0.9rem"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","0.9rem",3,"ngModel","ngModelChange"],["type","range","min","0","max","100","step","1",2,"width","90%",3,"ngModel","title","ngModelChange"],["type","number","min","0","max","100","step","1","size","1","placeholder","Opacity",2,"margin-left","3.5em","width","4em","text-align","right",3,"ngModel","ngModelChange"],[1,"move",2,"font-size","small"],["type","range",2,"width","90%",3,"ngModel","title","min","max","step","ngModelChange"],["type","number","size","1","placeholder","Value",2,"width","35%","max-width","4em","text-align","right",3,"min","step","ngModel","ngModelChange"],["style","color: #444; font-family: Cambria, Georgia; font-size: 0.9rem; display: inline-block; margin-left: 3px",4,"ngIf"],[2,"color","#444","font-family","Cambria, Georgia","font-size","0.9rem","display","inline-block","margin-left","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"hidden-spacer",2,"font-size","1.0em","font-family","Cambria, Georgia"],["appLogging","","size","1","placeholder","Number",2,"width","40%","min-width","3em","max-width","8em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","ngModel","title","max","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","type","number","placeholder","Value",2,"width","5em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],["appLogging","","size","1","placeholder","Value",2,"width","40%","max-width","5em","text-align","right",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],[1,"modeifire-type",2,"width","40%","max-width","5em",3,"ngModel","ngModelChange"],["value","div2"],["value","div3"],["value","div4"],["value","div5"],["value","div6"],["value","div10"],["value","DnD3"],[2,"font-size","smaller"],["appLogging","","type","checkbox",2,"width","30%","max-width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","width:50%; max-width:4em","type","text","size","1","placeholder","Option",3,"ngModel","ngModelChange",4,"ngIf"],["style","font-size: 1.0em; font-family: Cambria, Georgia; color: #555",4,"ngIf"],["type","text","size","1","placeholder","Option",2,"width","50%","max-width","4em",3,"ngModel","ngModelChange"],[2,"font-size","1.0em","font-family","Cambria, Georgia","color","#555"],["placeholder","Note",2,"width","100%","height","5em","min-width","50px","resize","bose","font-size","0.8em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["type","url","size","1","placeholder","https://www.example.com",2,"width","calc(100% - 1.6rem)","min-width","10px",3,"ngModel","ngModelChange"],[2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","6.5em"],["type","color",2,"width","1em",3,"ngModel","ngModelChange"],[1,"color-sample",2,"padding","0px 2px 0px 0xp","width","7.5em"],["style","width:100%; min-width:10px;","size","1","placeholder","",3,"ngModel","ngModelChange",4,"ngIf"],["style","color: gray; font-size: 1.0em; font-family: Cambria, Georgia;",4,"ngIf"],["size","1","placeholder","",2,"width","100%","min-width","10px",3,"ngModel","ngModelChange"],[2,"color","gray","font-size","1.0em","font-family","Cambria, Georgia"],["class","table-cell table-cell_solid","style","vertical-align: top;",4,"ngIf"],[1,"table-cell","table-cell_inner-table",2,"padding","0","width","0"],[1,"table-cell_inner-table"],[1,"table-cell_inner-table-title"],["class","table",4,"ngIf"],[1,"table-cell","table-cell_solid",2,"vertical-align","top"],[2,"padding","2px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold"],["size","1","placeholder","Value",2,"width","100%","min-width","10px","font-family","Cambria, Georgia","font-size","1.0rem","font-weight","bold",3,"ngModel","ngModelChange"],[1,"table"],["game-data-element","","class","table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isTagLocked","isHideText","isNoLogging","descriptionType"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(xe(0,vU,3,2,"ng-container",0),xe(1,bU,13,0,"ng-template",null,1,On)),2&e&&re("ngIf",i.gameDataElement&&!(i.isHideText&&("text"==i.name||"fontsize"==i.name||"color"==i.name)))},directives:[gn,_l,Zr,oi,ei,Rr,Or,si,fs,Co,yo,ds,Yr,ml,_d,Ls,$d,Jn,t],pipes:[Yn],styles:[".game-data-element[_ngcontent-%COMP%]{margin-left:10px}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{padding-top:10px;display:table-row;box-sizing:border-box}.table-cell[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.5em 0 .1em .5em;border-bottom:1px dotted #888;box-sizing:border-box}.table-cell_solid[_ngcontent-%COMP%]{width:10px;white-space:nowrap}.table-cell_inner-table[_ngcontent-%COMP%]{display:table-cell;vertical-align:bottom;padding:.2em 0 .1em .5em;border:none;box-sizing:border-box}.table-cell_inner-table-title[_ngcontent-%COMP%]{border-bottom:1px solid #444;border-left:8px solid #444;padding-left:8px}.box[_ngcontent-%COMP%]{display:inline-block;margin:10px}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;max-width:20em;overflow:hidden;padding:0 3px;box-sizing:border-box}input[_ngcontent-%COMP%], button[_ngcontent-%COMP%], textarea[_ngcontent-%COMP%], select[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}input[_ngcontent-%COMP%]:hover, textarea[_ngcontent-%COMP%]:hover, select[_ngcontent-%COMP%]:hover{background:#EEE}input[_ngcontent-%COMP%]:focus, textarea[_ngcontent-%COMP%]:focus, select[_ngcontent-%COMP%]:focus{background:#FFF}button[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}.table-cell[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:.5rem}button[_ngcontent-%COMP%]:disabled{color:gray}button[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.modeifire-type[_ngcontent-%COMP%]{font-size:smaller}input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){-webkit-appearance:auto;-moz-appearance:auto;appearance:auto;width:44px;height:22px;background-color:#efefef;cursor:default;color:#000;border-width:1px;border-style:solid;border-color:#767676;-o-border-image:none;border-image:none;-o-border-image:initial;border-image:initial;padding:1px 2px}@media (prefers-color-scheme: dark){input[type=color][_ngcontent-%COMP%]:hover, input[type=color][_ngcontent-%COMP%]:not(:hover){background-color:#3b3b3b;color:#fff;border-color:#858585}}.color-sample[_ngcontent-%COMP%]{display:inline-block;font-weight:bolder;width:6em;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(-1em);transition:transform 18ms}input[_ngcontent-%COMP%]:hover + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:active + .move[_ngcontent-%COMP%], input[_ngcontent-%COMP%]:focus + .move[_ngcontent-%COMP%]{display:inline-block;transform:translate(0);transition:transform 18ms}@supports (-moz-user-select: -moz-none){input[_ngcontent-%COMP%] + .move[_ngcontent-%COMP%]{transform:translate(0)}}"],changeDetection:0}),t})();const CU=["mainImage"];function xU(t,n){1&t&&$n(0)}function wU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",4),Ie("click",function(){return ke(e),ge().openModal("front")}),be(2,"\u8868\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),te(),X(3,"button",0),Ie("click",function(){return ke(e),ge().openModal("back")}),be(4,"\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),te(),qe()}if(2&t){const e=ge();W(1),re("disabled",!e.isVisible)}}function EU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",0),Ie("click",function(){return ke(e),ge().openModalChangeAllCardImages()}),be(2,"\u5168\u30ab\u30fc\u30c9\u306e\u88cf\u9762\u306e\u753b\u50cf\u3092\u5909\u66f4"),te(),qe()}}function TU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",0),Ie("click",function(){return ke(e),ge().openModal("floor")}),be(2,"\u5e8a\u306e\u753b\u50cf\u3092\u5909\u66f4"),te(),X(3,"button",0),Ie("click",function(){return ke(e),ge().openModal("wall")}),be(4,"\u58c1\u306e\u753b\u50cf\u3092\u5909\u66f4"),te(),qe()}}function IU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",4),Ie("click",function(){ke(e);const r=ge();return r.openModal(r.tabletopObject.face)}),be(2,"\u30c0\u30a4\u30b9\u76ee\u306e\u753b\u50cf\u3092\u5909\u66f4"),te(),qe()}if(2&t){const e=ge();W(1),re("disabled",!e.isVisible)}}function SU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",0),Ie("click",function(){ke(e);const r=ge();return r.openModalReplaceImage(r.tabletopObject.imageFiles.length>1||0<(null==r.tabletopObject.imageFile?null:r.tabletopObject.imageFile.url.length))}),be(2),te(),X(3,"button",4),Ie("click",function(){return ke(e),ge().openModal("faceIcon")}),be(4),te(),qe()}if(2&t){const e=ge();W(2),An("\u753b\u50cf",(null==e.tabletopObject.imageFiles?null:e.tabletopObject.imageFiles.length)>1?"\u7f6e\u63db/\u524a\u9664":"\u8a2d\u5b9a",""),W(1),re("disabled",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>=e.MAX_IMAGE_ICON_COUNT),W(1),An("\u9854IC",(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length)>0?"\u8ffd\u52a0":"\u8a2d\u5b9a","")}}function kU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",0),Ie("click",function(){ke(e);const r=ge();return r.openModal("imageIdentifier",r.tabletopObject.imageFile&&r.tabletopObject.imageFile.url.length>0)}),be(2,"\u753b\u50cf\u5909\u66f4"),te(),qe()}}function MU(t,n){if(1&t&&(X(0,"div",10),be(1),te()),2&t){const e=ge();W(1),An("",e.progresPercent,"%")}}function DU(t,n){if(1&t){const e=Ye();X(0,"select",12),Ie("change",function(r){return ke(e),ge(2).setLocation(r.target.value)}),X(1,"option",13),be(2,"\u30c6\u30fc\u30d6\u30eb"),te(),X(3,"option",14),be(4,"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),te(),X(5,"option",15),be(6,"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),te(),X(7,"option",16),be(8,"\u5893\u5730"),te()()}if(2&t){const e=ge(2);re("ngModel",e.tabletopObject.location.name),W(5),it("value",e.networkService.peerId)}}function AU(t,n){if(1&t){const e=Ye();Ge(0),xe(1,DU,9,2,"select",11),X(2,"button",4),Ie("click",function(){ke(e);const r=ge();return r.openModal("shadowImageIdentifier",r.tabletopObject.shadowImageFile.url.length>0)}),be(3,"\u753b\u50cf\u306e\u5f71\u306e\u5909\u66f4"),te(),qe()}if(2&t){const e=ge();W(1),re("ngIf",e.tabletopObject),W(1),re("disabled",!e.tabletopObject.imageElement||"null"==e.tabletopObject.imageElement.value)}}function PU(t,n){if(1&t){const e=Ye();X(0,"button",35),Ie("click",function(){ke(e);const r=ge(2),s=r.index,o=r.$implicit;return ge(3).deleteIcon(s,o.identifier)}),X(1,"b",36),be(2,"close"),te()()}}const NU=function(t){return{"current-icon":t}};function FU(t,n){if(1&t){const e=Ye();X(0,"div",32)(1,"img",33),Ie("click",function(){ke(e);const r=ge().index;return ge(3).selectIcon(r)}),bt(2,"safe"),te(),xe(3,PU,3,0,"button",34),te()}if(2&t){const e=ge(),i=e.index,r=e.$implicit,s=ge(3);re("@bounceInOut",void 0)("ngClass",ct(8,NU,s.tabletopObject.currntIconIndex==i)),W(1),re("src",yt(2,5,r.url,"resourceUrl"),Xt)("alt",r.name),W(2),re("ngIf",s.tabletopObject.currntIconIndex==i)}}function RU(t,n){if(1&t&&(X(0,"div",5),xe(1,FU,4,10,"div",31),te()),2&t){const e=n.$implicit,i=n.index;Je("top",-ge(3).showIconOffset(i),"px"),W(1),re("ngIf",0<e.url.length)}}const OU=function(t){return{hide:t}};function BU(t,n){if(1&t){const e=Ye();X(0,"span",37)(1,"img",33),Ie("click",function(){const s=ke(e).index;return ge(3).selectImage(s)}),bt(2,"safe"),te()()}if(2&t){const e=n.$implicit,i=n.index,r=ge(3);Je("left",50*(r.tabletopObject.currntImageIndex<=i?i-1:i)-r.showCaseOffset(i),"px"),re("ngClass",ct(9,OU,r.tabletopObject.currntImageIndex==i)),W(1),re("@bounceInOut",void 0)("src",yt(2,6,e.url,"resourceUrl"),Xt)("alt",e.name)}}function LU(t,n){if(1&t){const e=Ye();X(0,"button",38),Ie("click",function(){return ke(e),ge(3).openModalAddImage()}),be(1),te()}if(2&t){const e=ge(3);Je("left",e.tabletopObject.imageFiles.length<0?-5:45*(e.tabletopObject.imageFiles.length-1)-5-e.showCaseOffset(e.tabletopObject.imageFiles.length-2),"px"),W(1),Ze(e.tabletopObject.imageFiles.length<2?"\u5207\u308a\u66ff\u3048\u753b\u50cf\u8a2d\u5b9a":"\uff0b")}}const zU=function(t){return{transform:t}};function jU(t,n){if(1&t&&(X(0,"div",39),nt(1,"div",40),bt(2,"safe"),te()),2&t){const e=ge(3);Je("width",e.imageAreaRreact.width,"px")("height",e.imageAreaRreact.height,"px"),re("ngStyle",ct(13,zU,"scale("+e.imageAreaRreact.scale+")")),W(1),Je("font-size",e.cardFontSize,"px")("color",e.cardColor),re("innerHTML",yt(2,10,e.cardText,"html"),Ui)}}const UU=function(t){return{inverse:t}},HU=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}},VU=function(t,n,e){return{"black-paint":t,hollow:n,small:e}};function GU(t,n){if(1&t){const e=Ye();X(0,"div",20)(1,"div",21),xe(2,RU,2,3,"div",22),te(),X(3,"div",23),xe(4,BU,3,11,"span",24),xe(5,LU,2,3,"button",25),te(),xe(6,jU,3,15,"div",26),X(7,"span",27)(8,"span",28)(9,"img",29,30),Ie("dblclick",function(){return ke(e),ge(2).openMainImageModal()})("load",function(){return ke(e),ge(2).onMainImageLoad()}),bt(11,"safe"),te()()()()}if(2&t){const e=ge(2);W(2),re("ngForOf",e.tabletopObject.faceIcons)("ngForTrackBy",e.identify),W(2),re("ngForOf",e.tabletopObject.imageFiles),W(1),re("ngIf","character"==e.tabletopObject.aliasName&&e.tabletopObject.imageFiles.length<e.MAX_IMAGE_ICON_COUNT&&(e.tabletopObject.imageFiles.length>1||0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length))),W(1),re("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.isVisible)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),W(1),re("ngClass",ct(14,UU,e.tabletopObject.isInverse)),W(1),re("ngClass",vo(16,HU,0==e.tabletopObject.aura,1==e.tabletopObject.aura,2==e.tabletopObject.aura,3==e.tabletopObject.aura,4==e.tabletopObject.aura,5==e.tabletopObject.aura,6==e.tabletopObject.aura,7==e.tabletopObject.aura)),W(1),re("src",yt(11,11,e.imageFile.url,"resourceUrl"),Xt)("alt",e.imageFile.name)("ngClass",qr(25,VU,e.isBlackPaint,e.tabletopObject.isHollow,""==e.tabletopObject.aliasName))("@switchImage",e.tabletopObject.currntImageIndex)}}function qU(t,n){if(1&t){const e=Ye();X(0,"div",45)(1,"button",46),Ie("click",function(){return ke(e),ge(3).showChatPalette()}),be(2,"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a"),te(),X(3,"button",46),Ie("click",function(){return ke(e),ge(3).showStandSetting()}),be(4,"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a"),te()()}}function WU(t,n){if(1&t&&(Ge(0),X(1,"div",41)(2,"div",42),nt(3,"div",43),te(),xe(4,qU,5,0,"div",44),te(),qe()),2&t){const e=ge(2);W(3),re("gameDataElement",e.tabletopObject.commonDataElement)("tableTopObjectName",e.tableTopObjectName)("isTagLocked",!0)("isHideText","card"===e.tabletopObject.aliasName&&!e.tabletopObject.isFront&&!e.tabletopObject.isHand&&!e.tabletopObject.isGMMode)("isNoLogging",e.isNoLogging)("descriptionType",e.tabletopObject.aliasName),W(1),re("ngIf","character"===e.tabletopObject.aliasName)}}function KU(t,n){if(1&t&&(X(0,"div",41)(1,"div",42),nt(2,"div",48),te()()),2&t){const e=n.$implicit,i=ge(3);W(2),re("gameDataElement",e)("tableTopObjectName",i.tableTopObjectName)("isEdit",i.isEdit)("isNoLogging",i.isNoLogging)}}function YU(t,n){if(1&t&&(Ge(0),xe(1,KU,3,4,"div",47),qe()),2&t){const e=ge(2);W(1),re("ngForOf",e.tabletopObject.detailDataElement.children)}}function ZU(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",41)(2,"button",49),Ie("click",function(){return ke(e),ge(2).addDataElement()}),be(3,"\u65b0\u3057\u3044\u9805\u76ee\u3092\u8ffd\u52a0"),te()(),qe()}}function XU(t,n){if(1&t){const e=Ye();X(0,"div",17)(1,"img",18),Ie("click",function(){return ke(e),ge().openModal("shadowImageIdentifier",!0)}),bt(2,"safe"),te(),xe(3,GU,12,29,"div",19),xe(4,WU,5,7,"ng-container",8),xe(5,YU,2,1,"ng-container",8),xe(6,ZU,4,0,"ng-container",8),te()}if(2&t){const e=ge();W(1),re("src",yt(2,6,e.tabletopObject.shadowImageFile.url,"resourceUrl"),Xt)("alt",e.tabletopObject.shadowImageFile.name),W(2),re("ngIf",(0<(null==e.tabletopObject.imageFile?null:e.tabletopObject.imageFile.url.length)||0<(null==e.tabletopObject.faceIcons?null:e.tabletopObject.faceIcons.length))&&"table-mask"!=e.tabletopObject.aliasName),W(1),re("ngIf",e.tabletopObject.commonDataElement),W(1),re("ngIf",e.tabletopObject.detailDataElement),W(1),re("ngIf",e.isEdit)}}const QU=function(t){return{"is-hidden":t}};let lo=(()=>{class t{constructor(e,i,r,s){this.saveDataService=e,this.panelService=i,this.modalService=r,this.pointerDeviceService=s,this.tabletopObject=null,this.isEdit=!1,this.networkService=vt,this.MAX_IMAGE_ICON_COUNT=8,this.isSaveing=!1,this.progresPercent=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.mainImageWidth=0,this.mainImageHeight=0}ngOnInit(){Fe.register(this).on("DELETE_GAME_OBJECT",e=>{this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier&&this.panelService.close()}).on("UPDATE_GAME_OBJECT",-1e3,e=>{if(this.tabletopObject&&this.tabletopObject.identifier===e.data.identifier)switch(this.tabletopObject.aliasName){case"terrain":this.panelService.title=`\u5730\u5f62\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"card":const i=this.tabletopObject;i instanceof Fn&&(this.panelService.title=`\u30ab\u30fc\u30c9\u8a2d\u5b9a - ${i.isFront?this.tableTopObjectName:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"}`);break;case"card-stack":this.panelService.title=`\u5c71\u672d\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"table-mask":this.panelService.title=`\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"text-note":this.panelService.title=`\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"dice-symbol":this.panelService.title=`\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a - ${this.tableTopObjectName}`;break;case"character":this.panelService.title=`\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8 - ${this.tableTopObjectName}`}})}ngAfterViewInit(){}ngOnDestroy(){Fe.unregister(this)}toggleEditMode(){this.isEdit=!this.isEdit}addDataElement(){if(this.tabletopObject.detailDataElement){let e=dt.create("\u898b\u51fa\u3057","",{}),i=dt.create("\u30bf\u30b0","",{});e.appendChild(i),this.tabletopObject.detailDataElement.appendChild(e)}}clone(){let e=this.tabletopObject.clone();switch(e.location.x+=50,e.location.y+=50,this.tabletopObject.parent&&this.tabletopObject.parent.appendChild(e),e.update(),this.tabletopObject.aliasName){case"terrain":ut.play(Xe.blockPut),e.isLocked=!1;break;case"card":case"card-stack":e.owner="",e.toTopmost();case"table-mask":e.isLock=!1,ut.play(Xe.cardPut);break;case"text-note":e.toTopmost(),ut.play(Xe.cardPut);break;case"dice-symbol":ut.play(Xe.dicePut);default:ut.play(Xe.piecePut)}}get tableTopObjectName(){let e=this.tabletopObject.commonDataElement.getFirstElementByName("name")||this.tabletopObject.commonDataElement.getFirstElementByName("title");return e?e.value:""}get imageFile(){const e=this.tabletopObject;return e?e instanceof Fn&&this.isVisible?e.frontImage:e.imageFile:Lt.Empty}saveToXML(){var e=this;return(0,Yt.Z)(function*(){if(!e.tabletopObject||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=e.tableTopObjectName;yield e.saveDataService.saveGameObjectAsync(e.tabletopObject,"fly_xml_"+i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}setLocation(e){Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.tabletopObject.identifier}),ut.play("graveyard"==e?Xe.sweep:Xe.piecePut),this.tabletopObject.setLocation(e)}openModal(e="",i=!1){let r=[];if("shadowImageIdentifier"==e){const s=this.tabletopObject.imageElement;s&&"null"!=s.value&&s.currentValue&&(r=[s.currentValue+""])}else{const s=this.tabletopObject.imageDataElement.getElementsByName(e);s&&s.length>0&&(r=s.map(o=>o.value+""))}this.modalService.open(Po,{isAllowedEmpty:i,currentImageIdentifires:r}).then(s=>{if(this.tabletopObject&&this.tabletopObject.imageDataElement&&s)if("shadowImageIdentifier"==e){const o=this.tabletopObject.imageElement;if(o){"null"!=o.value&&(o.currentValue=s);const d=this.tabletopObject.imageDataElement.getElementsByName("shadowImageIdentifier");for(const $ of d)this.tabletopObject.imageDataElement.removeChild($)}}else if("faceIcon"===e){let o=this.tabletopObject.imageDataElement.getElementsByName(e);if(o.length>=this.MAX_IMAGE_ICON_COUNT){for(let d=this.MAX_IMAGE_ICON_COUNT;d<o.length;d++)this.deleteIcon(d);o[this.MAX_IMAGE_ICON_COUNT-1].value=s}else this.tabletopObject.imageDataElement.appendChild(dt.create(e,s,{type:"image"},e+ms.generateUuid()));this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0)}else{let o=this.tabletopObject.imageDataElement.getFirstElementByName(e);if(!o)return;o.value=s}})}openModalAddImage(){let e=[];const i=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");i.length>0&&(e=i.map(r=>r.value+"")),this.modalService.open(Po,{currentImageIdentifires:e}).then(r=>{if(!this.tabletopObject||!this.tabletopObject.imageDataElement||!r)return;let s=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");if(s.length>=this.MAX_IMAGE_ICON_COUNT){for(let o=this.MAX_IMAGE_ICON_COUNT;o<s.length;o++)this.deleteImage(o);s[this.MAX_IMAGE_ICON_COUNT-1].value=r}else this.tabletopObject.imageDataElement.appendChild(dt.create("imageIdentifier",r,{type:"image"},name+ms.generateUuid()));this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0)})}openModalReplaceImage(e=!1){let i=[];const r=this.tabletopObject.imageDataElement.getElementsByName("imageIdentifier");r.length>0&&(i=r.map(s=>s.value+"")),this.modalService.open(Po,{isAllowedEmpty:e,currentImageIdentifires:i}).then(s=>{!this.tabletopObject||!this.tabletopObject.imageDataElement||!s||("null"==s?this.tabletopObject.imageElement&&1==this.tabletopObject.imageFiles.length?(this.tabletopObject.imageElement.value=s,this.tabletopObject.imageElement.currentValue=s):this.deleteImage(this.tabletopObject.currntImageIndex):this.tabletopObject.imageElement&&(this.tabletopObject.imageElement.value=s))})}openModalChangeAllCardImages(){this.modalService.open(Po,{isAllowedEmpty:!1}).then(e=>{!this.tabletopObject||!this.tabletopObject||!(this.tabletopObject instanceof Un)||!e||this.tabletopObject.cards.forEach(i=>{let r=i.imageDataElement.getFirstElementByName("back");r&&(r.value=e)})})}selectImage(e,i="imageIdentifier"){this.tabletopObject.currntImageIndex!=e&&(this.tabletopObject.currntImageIndex=e,ut.play(Xe.surprise),Fe.trigger("UPDATE_INVENTORY",null))}selectIcon(e){this.tabletopObject.currntIconIndex!=e&&(this.tabletopObject.currntIconIndex=e)}deleteImage(e=0,i="imageIdentifier"){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName(i);r&&0<r.length&&e<r.length&&(this.tabletopObject.currntImageIndex>e&&(this.tabletopObject.currntImageIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntImageIndex>=r.length-1&&(this.tabletopObject.currntImageIndex=r.length-2),this.tabletopObject.currntImageIndex<0&&(this.tabletopObject.currntImageIndex=0))}deleteIcon(e=0,i=""){if(!this.tabletopObject||!this.tabletopObject.imageDataElement)return;let r=this.tabletopObject.imageDataElement.getElementsByName("faceIcon");r&&0<r.length&&e<r.length&&(!i||r[e].value===i)&&(this.tabletopObject.currntIconIndex>e&&(this.tabletopObject.currntIconIndex-=1),this.tabletopObject.imageDataElement.removeChild(r[e]),this.tabletopObject.currntIconIndex>=r.length-1&&(this.tabletopObject.currntIconIndex=r.length-2),this.tabletopObject.currntIconIndex<0&&(this.tabletopObject.currntIconIndex=0))}openMainImageModal(){var e;this.tabletopObject instanceof Un||(this.tabletopObject instanceof Fn?this.openModal(this.tabletopObject.isVisible?"front":"back"):this.tabletopObject instanceof tr?this.openModal(this.tabletopObject.face):this.tabletopObject instanceof jt?this.openModalReplaceImage(this.tabletopObject.imageFiles.length>1||0<(null===(e=this.tabletopObject.imageFile)||void 0===e?void 0:e.url.length)):this.openModal("imageIdentifier",this.tabletopObject.imageFile&&this.tabletopObject.imageFile.url.length>0))}showChatPalette(){if(!(this.tabletopObject instanceof jt))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(cu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=this.tabletopObject}showStandSetting(){if(!(this.tabletopObject instanceof jt))return;let e=this.pointerDeviceService.pointers[0];this.panelService.open(Wp,{left:e.x-400,top:e.y-175,width:720,height:572}).character=this.tabletopObject}onMainImageLoad(){!this.mainImageElement||(this.mainImageWidth=this.mainImageElement.nativeElement.clientWidth,this.mainImageHeight=this.mainImageElement.nativeElement.clientHeight,this.naturalWidth=this.mainImageElement.nativeElement.naturalWidth,this.naturalHeight=this.mainImageElement.nativeElement.naturalHeight)}identify(e,i){return i.identifier}get imageAreaRreact(){return this.calcImageAreaRect(this.mainImageWidth,this.mainImageHeight,0)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,d=i-2*r;this.naturalHeight*o/this.naturalWidth>d?(s.width=this.naturalWidth*d/this.naturalHeight,s.height=d,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(d-s.height)/2);let $=null;return this.tabletopObject instanceof Un?$=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&($=this.tabletopObject),$&&(s.scale=s.width/($.size*this.gridSize),s.width=$.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){let e=null;return this.tabletopObject instanceof Un?e=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Un?e=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Un?e=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&(e=this.tabletopObject),e?et.rubyToHtml(et.escapeHtml(e.text)):""}get isVisible(){return!!this.tabletopObject&&(!(!He.myCursor||!He.myCursor.isGMMode)||(this.tabletopObject instanceof Fn?this.tabletopObject.isFront||this.tabletopObject.isHand:!(this.tabletopObject instanceof tr)||this.tabletopObject.isVisible))}get isBlackPaint(){return this.tabletopObject instanceof jt?this.tabletopObject.isBlackPaint:this.tabletopObject instanceof tr&&!this.isVisible}get isNoLogging(){return this.tabletopObject instanceof Fn?!this.tabletopObject.isFront:this.tabletopObject instanceof tr&&this.tabletopObject.hasOwner}showCaseOffset(e){let i=this.tabletopObject.imageFiles.length;return i<=5?0:(50-160/(i-2))*(this.tabletopObject.currntImageIndex<=e?e-1:e)}showIconOffset(e){let i=this.tabletopObject.faceIcons.length;return i<=5?0:(50-200/(i-1))*e+2}}return t.\u0275fac=function(e){return new(e||t)(Oe(Cr),Oe(Tn),Oe(kn),Oe(li))},t.\u0275cmp=qt({type:t,selectors:[["game-character-sheet"]],viewQuery:function(e,i){if(1&e&&dn(CU,5),2&e){let r;un(r=fn())&&(i.mainImageElement=r.first)}},inputs:{tabletopObject:"tabletopObject"},decls:19,vars:14,consts:[[3,"click"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[4,"ngIf"],["class","flex-container",4,"ngIf"],[1,"progress"],[3,"ngModel","change",4,"ngIf"],[3,"ngModel","change"],["value","table"],["value","common"],[3,"value"],["value","graveyard"],[1,"flex-container"],[1,"shadow-image",3,"src","alt","click"],["class","box main-image-box",4,"ngIf"],[1,"box","main-image-box"],[1,"icons-box"],["style","position: relative",3,"top",4,"ngFor","ngForOf","ngForTrackBy"],[1,"image-showcase",2,"position","absolute","height","50px","top","300px"],["class","image-thumbnail","style","position: absolute;",3,"ngClass","left",4,"ngFor","ngForOf"],["style","position: relative; bottom: 30px; z-index: 700;",3,"left","click",4,"ngIf"],["class","text",3,"width","height","ngStyle",4,"ngIf"],[1,"inverser",2,"display","inline-block",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"main-image",3,"src","alt","ngClass","dblclick","load"],["mainImage",""],["class","icon-image-box",3,"ngClass",4,"ngIf"],[1,"icon-image-box",3,"ngClass"],[3,"src","alt","click"],["class","button-delete-icon","title","\u9854IC\u524a\u9664",3,"click",4,"ngIf"],["title","\u9854IC\u524a\u9664",1,"button-delete-icon",3,"click"],[1,"material-icons",2,"font-size","1rem"],[1,"image-thumbnail",2,"position","absolute",3,"ngClass"],[2,"position","relative","bottom","30px","z-index","700",3,"click"],[1,"text",3,"ngStyle"],[3,"innerHTML"],[1,"flex-item"],[1,"table"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isTagLocked","isHideText","isNoLogging","descriptionType"],["style","margin-top: 3px; text-align: right",4,"ngIf"],[2,"margin-top","3px","text-align","right"],[2,"font-size","11px","color","#444",3,"click"],["class","flex-item",4,"ngFor","ngForOf"],["game-data-element","",1,"table-row",3,"gameDataElement","tableTopObjectName","isEdit","isNoLogging"],[2,"width","100%","color","#555",3,"click"]],template:function(e,i){1&e&&(X(0,"button",0),Ie("click",function(){return i.toggleEditMode()}),be(1,"\u7de8\u96c6\u5207\u308a\u66ff\u3048"),te(),Ge(2,1),xe(3,xU,1,0,"ng-container",2),xe(4,wU,5,1,"ng-container",2),xe(5,EU,3,0,"ng-container",2),xe(6,TU,5,0,"ng-container",2),xe(7,IU,3,1,"ng-container",2),xe(8,SU,5,3,"ng-container",2),xe(9,kU,3,0,"ng-container",3),qe(),X(10,"button",0),Ie("click",function(){return i.clone()}),be(11,"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b"),te(),X(12,"button",4),Ie("click",function(){return i.saveToXML()}),X(13,"div",5)(14,"div",6),be(15,"\u4fdd\u5b58"),te(),xe(16,MU,2,1,"div",7),te()(),xe(17,AU,4,2,"ng-container",8),xe(18,XU,7,9,"div",9)),2&e&&(W(2),re("ngSwitch",i.tabletopObject.aliasName),W(1),re("ngSwitchCase","numberResource"),W(1),re("ngSwitchCase","card"),W(1),re("ngSwitchCase","card-stack"),W(1),re("ngSwitchCase","terrain"),W(1),re("ngSwitchCase","dice-symbol"),W(1),re("ngSwitchCase","character"),W(4),re("disabled",i.isSaveing),W(2),re("ngClass",ct(12,QU,i.isSaveing)),W(2),re("ngIf",i.isSaveing),W(1),re("ngIf","character"===i.tabletopObject.aliasName),W(1),re("ngIf",i.tabletopObject))},directives:[ml,_d,$d,jn,gn,Zr,oi,ei,Rr,Or,Jn,Ji,yU],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.main-image-box[_ngcontent-%COMP%]{width:250px;height:250px;z-index:0}.main-image[_ngcontent-%COMP%]{width:250px;-o-object-position:center bottom;object-position:center bottom}.image-showcase[_ngcontent-%COMP%]{vertical-align:top;text-align:left;position:absolute;display:inline-block;vertical-align:bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]{color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;vertical-align:bottom;transform-origin:center bottom;transition:all 132ms ease-in-out}.image-thumbnail[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;max-height:100px;position:absolute;left:0;right:0;bottom:0;margin:auto;-o-object-fit:contain;object-fit:contain;-o-object-position:center bottom;object-position:center bottom;transform-origin:center bottom}.image-thumbnail[_ngcontent-%COMP%]:hover{z-index:600}.image-thumbnail[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{width:75px;max-height:150px;left:-12px;transition:all 132ms ease-in-out}.image-thumbnail.hide[_ngcontent-%COMP%]{transform:scale3d(0,0,0)}.icons-box[_ngcontent-%COMP%]{vertical-align:top;text-align:center;position:absolute;left:216px;z-index:2}.icon-image-box[_ngcontent-%COMP%]{position:relative;width:50px;height:50px;max-width:50px;max-height:50px;border-radius:.5rem;color:#000;filter:drop-shadow(1px 1px 0px rgb(255,244,232)) drop-shadow(-1px 1px 0px rgb(255,244,232)) drop-shadow(-1px -1px 0px rgb(255,244,232)) drop-shadow(1px -1px 0px rgb(255,244,232));z-index:100;margin-top:1px;margin-left:-3px}.icon-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem;border:2px solid transparent}.icon-image-box[_ngcontent-%COMP%]:hover{z-index:600}.icon-image-box[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40)}.icon-image-box.current-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red}.icon-image-box[_ngcontent-%COMP%]{z-index:400}.shadow-image[_ngcontent-%COMP%]{position:absolute;width:50px;filter:brightness(0) blur(1px) drop-shadow(0px 0px 1px #fff);opacity:.7;margin-top:6px;margin-left:6px;z-index:5}.table[_ngcontent-%COMP%]{display:table;width:100%;box-sizing:border-box}.table-row[_ngcontent-%COMP%]{display:table-row;box-sizing:border-box}.table-row[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{display:table-cell;border:1px solid #FFF;vertical-align:top;box-sizing:border-box}.box[_ngcontent-%COMP%]{display:inline-block;margin:5px;box-sizing:border-box}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px 0;padding:10px;flex:1 0 auto;box-sizing:border-box;min-width:25px;background-color:#eac99dcc;background-color:#f0dabdcc;color:#444;z-index:1}.flex-item[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   button[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%], .flex-item[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], input[_ngcontent-%COMP%]{color:#ccc}.button-delete-icon[_ngcontent-%COMP%]{display:inline-block;position:absolute;margin:0;padding:2px 0 0;background-color:transparent;right:-3px;top:1px;height:18px;width:18px;font-size:8px;color:red}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -20px 20px #fff)}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[yn("switchImage",[Nt(":increment, :decrement",[Dt("200ms ease",Qt([We({transform:"scale3d(0, 0, 0)"}),We({transform:"scale3d(0, 1.2, 1.2)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),yn("showcase",[Nt(":increment, :decrement",[Dt("200ms 200ms ease-in",Qt([We({transform:"scale3d(0, 1.0, 1.0)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),yn("showcaseItem",[Nt(":enter",[Dt("200ms ease",Qt([We({transform:"scale3d(0, 0, 0)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))]),Nt(":leave",[Dt("200ms ease",Qt([We({transform:"scale3d(1.0, 1.0, 1.0)"}),We({transform:"scale3d(0, 0, 0)"})]))])]),yn("bounceInOut",[Nt("void => *",[Dt("600ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale3d(0, 0, 0)"}))])])]}}),t})();const JU=["passwordInput"],eH=function(){return{standalone:!0}};let tH=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.password="",this.help="",this.targetPeerContext=null,this.title="",this.targetPeerContext=ai.parse(i.option.peerId?i.option.peerId:"???"),this.title=i.option.title?i.option.title:""}get peerId(){return vt.peerId}get isConnected(){return!(vt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title=`\u30d1\u30b9\u30ef\u30fc\u30c9\u3008${this.title}\u3009`),Fe.register(this)}ngAfterViewInit(){this.passwordInputElementRef.nativeElement.focus()}ngOnDestroy(){Fe.unregister(this)}onInputChange(e){this.help=""}submit(){this.targetPeerContext.verifyPassword(this.password)&&this.modalService.resolve(this.password),this.help="\u30d1\u30b9\u30ef\u30fc\u30c9\u304c\u9055\u3044\u307e\u3059"}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["password-check"]],viewQuery:function(e,i){if(1&e&&dn(JU,7),2&e){let r;un(r=fn())&&(i.passwordInputElementRef=r.first)}},decls:11,vars:4,consts:[["passwordForm","ngForm"],["placeholder","\u30d1\u30b9\u30ef\u30fc\u30c9",3,"ngModel","ngModelOptions","ngModelChange","input"],["passwordInput",""],["type","submit",3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(X(0,"form",null,0)(2,"div"),be(3,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),X(4,"input",1,2),Ie("ngModelChange",function(s){return i.password=s})("input",function(s){return i.onInputChange(s.target.value)}),te()(),X(6,"button",3),Ie("click",function(){return i.submit()}),be(7,"\u5165\u5ba4"),te()(),X(8,"div")(9,"span",4),be(10),te()()),2&e&&(W(4),re("ngModel",i.password)("ngModelOptions",Yo(3,eH)),W(6),Ze(i.help))},directives:[bl,vl,Qo,si,oi,ei],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"]}),t})();function nH(t,n){if(1&t&&(X(0,"div")(1,"div",9),be(2," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),te(),X(3,"div",9),be(4," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808\u3067\u3059\u3002 "),te(),X(5,"div",9),be(6," \u30eb\u30fc\u30e0\u540d\u524d\u306e\u9577\u3055\u306f128\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),te()()),2&t){ge();const e=Wt(4);W(1),re("hidden",!e.errors.required),W(2),re("hidden",!e.errors.minlength),W(2),re("hidden",!e.errors.maxlength)}}function iH(t,n){if(1&t&&(X(0,"div")(1,"div",9),be(2," \u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u9577\u3055\u306f12\u4ee5\u5185\u306b\u3057\u3066\u304f\u3060\u3055\u3044\u3002 "),te()()),2&t){ge();const e=Wt(8);W(1),re("hidden",!e.errors.maxlength)}}function rH(t,n){1&t&&(X(0,"div"),be(1," \u30eb\u30fc\u30e0\u306e\u540d\u524d\u3068\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u5408\u8a08\u304c\u9577\u3059\u304e\u308b\u3088\u3046\u3067\u3059\u3002\u3069\u3061\u3089\u304b\u3092\u5c11\u3057\u77ed\u304f\u3057\u3066\u307f\u3066\u304f\u3060\u3055\u3044\u3002 "),te())}function sH(t,n){if(1&t){const e=Ye();X(0,"div")(1,"div"),be(2,"\u30eb\u30fc\u30e0\u540d : "),X(3,"input",3,4),Ie("input",function(r){ke(e);const s=ge();return s.calcPeerId(r.target.value,s.password)})("ngModelChange",function(r){return ke(e),ge().roomName=r}),te()(),X(5,"div"),be(6,"\u30d1\u30b9\u30ef\u30fc\u30c9: "),X(7,"input",5,6),Ie("input",function(r){ke(e);const s=ge();return s.calcPeerId(s.roomName,r.target.value)})("ngModelChange",function(r){return ke(e),ge().password=r}),te()(),nt(9,"hr"),xe(10,nH,7,3,"div",7),xe(11,iH,3,1,"div",7),xe(12,rH,2,0,"div",7),X(13,"div")(14,"button",8),Ie("click",function(){return ke(e),ge().createRoom()}),be(15,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210"),te()()()}if(2&t){const e=Wt(4),i=Wt(8),r=ge();W(3),re("ngModel",r.roomName),W(4),re("ngModel",r.password),W(3),re("ngIf",e.errors&&(e.dirty||e.touched)),W(1),re("ngIf",i.errors&&(i.dirty||i.touched)),W(1),re("ngIf",!r.validateLength),W(2),re("disabled",!e.valid||!i.valid||!r.validateLength)}}function oH(t,n){1&t&&(X(0,"span",1),be(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u3057\u305f\u307e\u307e\u3067\u306f\u30eb\u30fc\u30e0\u4f5c\u6210\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),nt(2,"br"),be(3,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),nt(4,"br"),be(5,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),te())}let aH=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.peers=[],this.isReloading=!1,this.roomName="\u3075\u3064\u3046\u306e\u90e8\u5c4b",this.password="",this.isPrivate=!1,this.validateLength=!1}get peerId(){return vt.peerId}get isConnected(){return!(vt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30eb\u30fc\u30e0\u4f5c\u6210"),Fe.register(this),this.calcPeerId(this.roomName,this.password)}ngOnDestroy(){Fe.unregister(this)}calcPeerId(e,i){let r=vt.peerContext?vt.peerContext.userId:ai.generateId(),s=ai.create(r,ai.generateId("***"),e,i);this.validateLength=s.peerId.length<64}createRoom(){let e=vt.peerContext?vt.peerContext.userId:ai.generateId();vt.open(e,ai.generateId("***"),this.roomName,this.password),He.myCursor.peerId=vt.peerId,this.modalService.resolve()}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["room-setting"]],decls:6,vars:2,consts:[[4,"ngIf","ngIfElse"],[2,"font-size","12px"],["other_content",""],["required","","minlength","1","maxlength","128","placeholder","\u30eb\u30fc\u30e0\u306e\u540d\u524d\u306f\u5fc5\u9808",1,"input",3,"ngModel","input","ngModelChange"],["roomNameValidation","ngModel"],["maxlength","12","placeholder","\u7a7a\u306a\u3089\u30d1\u30b9\u30ef\u30fc\u30c9\u306a\u3057",1,"input",3,"ngModel","input","ngModelChange"],["passwordValidation","ngModel"],[4,"ngIf"],[3,"disabled","click"],[3,"hidden"]],template:function(e,i){if(1&e&&(xe(0,sH,16,6,"div",0),X(1,"div")(2,"span",1),be(3,"\u203b\u4f5c\u6210\u3057\u305f\u30eb\u30fc\u30e0\u306f\u53c2\u52a0\u8005\u304c0\u4eba\u306b\u306a\u3063\u305f\u6642\u70b9\u3067\u89e3\u6563\u3057\u307e\u3059\u3002\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),te()(),xe(4,oH,6,0,"ng-template",null,2,On)),2&e){const r=Wt(5);re("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[gn,si,Xh,N$,F$,oi,ei],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.input[_ngcontent-%COMP%]{width:100%}"]}),t})();function lH(t,n){1&t&&(X(0,"td")(1,"i",11),be(2,"lock"),te()())}function cH(t,n){1&t&&(X(0,"td"),be(1,"-"),te())}function uH(t,n){if(1&t){const e=Ye();X(0,"button",12),Ie("click",function(){ke(e);const r=ge().$implicit;return ge(3).connect(r.peerContexts)}),be(1,"\u63a5\u7d9a"),te()}if(2&t){const e=ge().$implicit,i=ge(3);re("disabled",(null==e.peerContexts[0]?null:e.peerContexts[0].roomId)===i.currentRoom)}}function dH(t,n){if(1&t&&(Ge(0),X(1,"tr")(2,"td",9),be(3),te(),X(4,"td",7),be(5),te(),xe(6,lH,3,0,"td",4),xe(7,cH,2,0,"td",4),X(8,"td"),be(9),te(),X(10,"td"),xe(11,uH,2,1,"button",10),te()(),qe()),2&t){const e=n.$implicit;W(3),Ze(null==e.peerContexts[0]?null:e.peerContexts[0].roomId),W(2),Ze(e.roomName),W(1),re("ngIf",e.peerContexts[0].hasPassword),W(1),re("ngIf",!e.peerContexts[0].hasPassword),W(2),An("",e.peerContexts.length,"\u4eba"),W(2),re("ngIf",0<e.alias.length)}}function fH(t,n){if(1&t&&(Ge(0),X(1,"table",6)(2,"tr")(3,"th"),be(4,"\u30eb\u30fc\u30e0ID"),te(),X(5,"th",7),be(6,"\u30eb\u30fc\u30e0\u540d"),te(),X(7,"th"),be(8,"\u30d1\u30b9\u30ef\u30fc\u30c9"),te(),X(9,"th"),be(10,"\u53c2\u52a0\u8005"),te(),nt(11,"th"),te(),xe(12,dH,12,6,"ng-container",8),te(),qe()),2&t){const e=ge(2);W(12),re("ngForOf",e.rooms)}}function hH(t,n){if(1&t&&(X(0,"span",13),be(1),te()),2&t){const e=ge(2);W(1),Ze(e.help)}}function pH(t,n){if(1&t){const e=Ye();X(0,"div")(1,"button",2),Ie("click",function(){return ke(e),ge().reload()}),be(2,"\u4e00\u89a7\u3092\u66f4\u65b0"),te(),X(3,"button",3),Ie("click",function(){return ke(e),ge().showRoomSetting()}),be(4,"\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b"),te(),nt(5,"hr"),xe(6,fH,13,1,"ng-container",4),xe(7,hH,2,1,"span",5),te()}if(2&t){const e=ge();W(1),re("disabled",e.isReloading),W(5),re("ngIf",e.rooms.length),W(1),re("ngIf",e.rooms.length<1)}}function gH(t,n){1&t&&(X(0,"span",13),be(1,"\u5225\u306e\u30eb\u30fc\u30e0\u306b\u63a5\u7d9a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u306e\u63a5\u7d9a\u3092\u5207\u3063\u3066\u304f\u3060\u3055\u3044\u3002"),nt(2,"br"),be(3,"\uff08\u203b\u30da\u30fc\u30b8\u30ea\u30ed\u30fc\u30c9\u3067\u5207\u65ad\u3067\u304d\u307e\u3059\u3002\uff09"),te())}let mH=(()=>{class t{constructor(e,i){this.panelService=e,this.modalService=i,this.rooms=[],this.isReloading=!1,this.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"}get currentRoom(){return vt.peerContext.roomId}get peerId(){return vt.peerId}get isConnected(){return!(vt.peerIds.length<=1)}ngOnInit(){Promise.resolve().then(()=>this.changeTitle()),Fe.register(this).on("OPEN_NETWORK",e=>{this.changeTitle()}).on("CONNECT_PEER",e=>{this.changeTitle()}),this.reload()}changeTitle(){this.modalService.title=this.panelService.title="\u30ed\u30d3\u30fc",vt.peerContext.roomName.length&&(this.modalService.title=this.panelService.title="\u3008"+vt.peerContext.roomName+"/"+vt.peerContext.roomId+"\u3009")}ngOnDestroy(){Fe.unregister(this)}reload(){var e=this;return(0,Yt.Z)(function*(){e.isReloading=!0,e.help="\u691c\u7d22\u4e2d...",e.rooms=[];let i={},r=yield vt.listAllPeers();for(let s of r){let o=ai.parse(s);if(o.isRoom){let d=o.roomId+o.roomName;d in i||(i[d]=[]),i[d].push(o)}}for(let s in i)e.rooms.push({alias:s,roomName:i[s][0].roomName,peerContexts:i[s]});e.rooms.sort((s,o)=>s.alias<o.alias?-1:s.alias>o.alias?1:0),e.help="\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u304c\u898b\u3064\u304b\u308a\u307e\u305b\u3093\u3067\u3057\u305f\u3002\u300c\u65b0\u3057\u3044\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3059\u308b\u300d\u3067\u65b0\u898f\u30eb\u30fc\u30e0\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002",e.isReloading=!1})()}connect(e){var i=this;return(0,Yt.Z)(function*(){let r=e[0],s="";if(r.hasPassword&&(s=yield i.modalService.open(tH,{peerId:r.peerId,title:`${r.roomName}/${r.roomId}`}),null==s&&(s="")),!r.verifyPassword(s))return;let o=vt.peerContext?vt.peerContext.userId:ai.generateId();vt.open(o,r.roomId,r.roomName,s),He.myCursor.peerId=vt.peerId;let d=[];Fe.register(d).on("OPEN_NETWORK",$=>{console.log("LobbyComponent OPEN_PEER",$.data.peerId),Fe.unregister(d),rt.instance.clearDeleteHistory();for(let I of e)vt.connect(I.peerId);Fe.register(d).on("CONNECT_PEER",I=>{console.log("\u63a5\u7d9a\u6210\u529f\uff01",I.data.peerId),d.push(I.data.peerId),console.log("\u63a5\u7d9a\u6210\u529f "+d.length+"/"+e.length),e.length<=d.length&&(i.resetNetwork(),Fe.unregister(d),i.closeIfConnected())}).on("DISCONNECT_PEER",I=>{console.warn("\u63a5\u7d9a\u5931\u6557",I.data.peerId),d.push(I.data.peerId),console.warn("\u63a5\u7d9a\u5931\u6557 "+d.length+"/"+e.length),e.length<=d.length&&(i.resetNetwork(),Fe.unregister(d),i.closeIfConnected())})})})()}resetNetwork(){vt.peerContexts.length<1&&(vt.open(),He.myCursor.peerId=vt.peerId)}closeIfConnected(){0<vt.peerContexts.length&&this.modalService.resolve()}showRoomSetting(){var e=this;return(0,Yt.Z)(function*(){yield e.modalService.open(aH,{width:700,height:400,left:0,top:400}),e.reload(),e.help="\u300c\u4e00\u89a7\u3092\u66f4\u65b0\u300d\u30dc\u30bf\u30f3\u3092\u62bc\u3059\u3068\u63a5\u7d9a\u53ef\u80fd\u306a\u30eb\u30fc\u30e0\u4e00\u89a7\u3092\u8868\u793a\u3057\u307e\u3059\u3002"})()}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["lobby"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["other_content",""],[3,"disabled","click"],[3,"click"],[4,"ngIf"],["style","font-size: 12px;",4,"ngIf"],[1,"room-list"],[1,"room-name"],[4,"ngFor","ngForOf"],[1,"is-small-font"],["type","submit",3,"disabled","click",4,"ngIf"],[1,"material-icons",2,"vertical-align","middle","font-size","0.9rem"],["type","submit",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){if(1&e&&(xe(0,pH,8,3,"div",0),xe(1,gH,4,0,"ng-template",null,1,On)),2&e){const r=Wt(2);re("ngIf",!i.isConnected)("ngIfElse",r)}},directives:[gn,Jn],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}.room-list[_ngcontent-%COMP%]{font-size:12px;border:0;border-spacing:0;padding:0;width:100%;max-width:100%;white-space:nowrap}.room-list[_ngcontent-%COMP%] > tr[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{padding:1px .5em;text-align:center}.room-name[_ngcontent-%COMP%]{white-space:normal;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;min-width:50%}.is-small-font[_ngcontent-%COMP%]{font-size:10px}"]}),t})();var Wi_isObject=function _H(t){return"object"==typeof t&&null!==t},Wi_repeat=function bH(t,n){var i,e="";for(i=0;i<n;i+=1)e+=t;return e},Wi_isNegativeZero=function yH(t){return 0===t&&Number.NEGATIVE_INFINITY===1/t};function MT(t,n){var e="",i=t.reason||"(unknown reason)";return t.mark?(t.mark.name&&(e+='in "'+t.mark.name+'" '),e+="("+(t.mark.line+1)+":"+(t.mark.column+1)+")",!n&&t.mark.snippet&&(e+="\n\n"+t.mark.snippet),i+" "+e):i}function Jd(t,n){Error.call(this),this.name="YAMLException",this.reason=t,this.mark=n,this.message=MT(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack||""}(Jd.prototype=Object.create(Error.prototype)).constructor=Jd,Jd.prototype.toString=function(n){return this.name+": "+MT(this,n)};var Br=Jd;function Y0(t,n,e,i,r){var s="",o="",d=Math.floor(r/2)-1;return i-n>d&&(n=i-d+(s=" ... ").length),e-i>d&&(e=i+d-(o=" ...").length),{str:s+t.slice(n,e).replace(/\t/g,"\u2192")+o,pos:i-n+s.length}}function Z0(t,n){return Wi_repeat(" ",n-t.length)+t}var MH=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],DH=["scalar","sequence","mapping"],cr=function PH(t,n){if(n=n||{},Object.keys(n).forEach(function(e){if(-1===MH.indexOf(e))throw new Br('Unknown option "'+e+'" is met in definition of "'+t+'" YAML type.')}),this.options=n,this.tag=t,this.kind=n.kind||null,this.resolve=n.resolve||function(){return!0},this.construct=n.construct||function(e){return e},this.instanceOf=n.instanceOf||null,this.predicate=n.predicate||null,this.represent=n.represent||null,this.representName=n.representName||null,this.defaultStyle=n.defaultStyle||null,this.multi=n.multi||!1,this.styleAliases=function AH(t){var n={};return null!==t&&Object.keys(t).forEach(function(e){t[e].forEach(function(i){n[String(i)]=e})}),n}(n.styleAliases||null),-1===DH.indexOf(this.kind))throw new Br('Unknown kind "'+this.kind+'" is specified for "'+t+'" YAML type.')};function DT(t,n){var e=[];return t[n].forEach(function(i){var r=e.length;e.forEach(function(s,o){s.tag===i.tag&&s.kind===i.kind&&s.multi===i.multi&&(r=o)}),e[r]=i}),e}function X0(t){return this.extend(t)}X0.prototype.extend=function(n){var e=[],i=[];if(n instanceof cr)i.push(n);else if(Array.isArray(n))i=i.concat(n);else{if(!n||!Array.isArray(n.implicit)&&!Array.isArray(n.explicit))throw new Br("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.implicit&&(e=e.concat(n.implicit)),n.explicit&&(i=i.concat(n.explicit))}e.forEach(function(s){if(!(s instanceof cr))throw new Br("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(s.loadKind&&"scalar"!==s.loadKind)throw new Br("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(s.multi)throw new Br("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),i.forEach(function(s){if(!(s instanceof cr))throw new Br("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var r=Object.create(X0.prototype);return r.implicit=(this.implicit||[]).concat(e),r.explicit=(this.explicit||[]).concat(i),r.compiledImplicit=DT(r,"implicit"),r.compiledExplicit=DT(r,"explicit"),r.compiledTypeMap=function NH(){var n,e,t={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}};function i(r){r.multi?(t.multi[r.kind].push(r),t.multi.fallback.push(r)):t[r.kind][r.tag]=t.fallback[r.tag]=r}for(n=0,e=arguments.length;n<e;n+=1)arguments[n].forEach(i);return t}(r.compiledImplicit,r.compiledExplicit),r};var AT=X0,PT=new cr("tag:yaml.org,2002:str",{kind:"scalar",construct:function(t){return null!==t?t:""}}),NT=new cr("tag:yaml.org,2002:seq",{kind:"sequence",construct:function(t){return null!==t?t:[]}}),FT=new cr("tag:yaml.org,2002:map",{kind:"mapping",construct:function(t){return null!==t?t:{}}}),RT=new AT({explicit:[PT,NT,FT]}),OT=new cr("tag:yaml.org,2002:null",{kind:"scalar",resolve:function FH(t){if(null===t)return!0;var n=t.length;return 1===n&&"~"===t||4===n&&("null"===t||"Null"===t||"NULL"===t)},construct:function RH(){return null},predicate:function OH(t){return null===t},represent:{canonical:function(){return"~"},lowercase:function(){return"null"},uppercase:function(){return"NULL"},camelcase:function(){return"Null"},empty:function(){return""}},defaultStyle:"lowercase"}),BT=new cr("tag:yaml.org,2002:bool",{kind:"scalar",resolve:function BH(t){if(null===t)return!1;var n=t.length;return 4===n&&("true"===t||"True"===t||"TRUE"===t)||5===n&&("false"===t||"False"===t||"FALSE"===t)},construct:function LH(t){return"true"===t||"True"===t||"TRUE"===t},predicate:function zH(t){return"[object Boolean]"===Object.prototype.toString.call(t)},represent:{lowercase:function(t){return t?"true":"false"},uppercase:function(t){return t?"TRUE":"FALSE"},camelcase:function(t){return t?"True":"False"}},defaultStyle:"lowercase"});function jH(t){return 48<=t&&t<=57||65<=t&&t<=70||97<=t&&t<=102}function UH(t){return 48<=t&&t<=55}function HH(t){return 48<=t&&t<=57}var LT=new cr("tag:yaml.org,2002:int",{kind:"scalar",resolve:function VH(t){if(null===t)return!1;var r,n=t.length,e=0,i=!1;if(!n)return!1;if(("-"===(r=t[e])||"+"===r)&&(r=t[++e]),"0"===r){if(e+1===n)return!0;if("b"===(r=t[++e])){for(e++;e<n;e++)if("_"!==(r=t[e])){if("0"!==r&&"1"!==r)return!1;i=!0}return i&&"_"!==r}if("x"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!jH(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}if("o"===r){for(e++;e<n;e++)if("_"!==(r=t[e])){if(!UH(t.charCodeAt(e)))return!1;i=!0}return i&&"_"!==r}}if("_"===r)return!1;for(;e<n;e++)if("_"!==(r=t[e])){if(!HH(t.charCodeAt(e)))return!1;i=!0}return!(!i||"_"===r)},construct:function GH(t){var i,n=t,e=1;if(-1!==n.indexOf("_")&&(n=n.replace(/_/g,"")),("-"===(i=n[0])||"+"===i)&&("-"===i&&(e=-1),i=(n=n.slice(1))[0]),"0"===n)return 0;if("0"===i){if("b"===n[1])return e*parseInt(n.slice(2),2);if("x"===n[1])return e*parseInt(n.slice(2),16);if("o"===n[1])return e*parseInt(n.slice(2),8)}return e*parseInt(n,10)},predicate:function qH(t){return"[object Number]"===Object.prototype.toString.call(t)&&t%1==0&&!Wi_isNegativeZero(t)},represent:{binary:function(t){return t>=0?"0b"+t.toString(2):"-0b"+t.toString(2).slice(1)},octal:function(t){return t>=0?"0o"+t.toString(8):"-0o"+t.toString(8).slice(1)},decimal:function(t){return t.toString(10)},hexadecimal:function(t){return t>=0?"0x"+t.toString(16).toUpperCase():"-0x"+t.toString(16).toUpperCase().slice(1)}},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),WH=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$"),ZH=/^[-+]?[0-9]+e/,zT=new cr("tag:yaml.org,2002:float",{kind:"scalar",resolve:function KH(t){return!(null===t||!WH.test(t)||"_"===t[t.length-1])},construct:function YH(t){var n,e;return e="-"===(n=t.replace(/_/g,"").toLowerCase())[0]?-1:1,"+-".indexOf(n[0])>=0&&(n=n.slice(1)),".inf"===n?1===e?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:".nan"===n?NaN:e*parseFloat(n,10)},predicate:function QH(t){return"[object Number]"===Object.prototype.toString.call(t)&&(t%1!=0||Wi_isNegativeZero(t))},represent:function XH(t,n){var e;if(isNaN(t))switch(n){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===t)switch(n){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===t)switch(n){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Wi_isNegativeZero(t))return"-0.0";return e=t.toString(10),ZH.test(e)?e.replace("e",".e"):e},defaultStyle:"lowercase"}),UT=RT.extend({implicit:[OT,BT,LT,zT]}),HT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),VT=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$"),GT=new cr("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:function JH(t){return null!==t&&(null!==HT.exec(t)||null!==VT.exec(t))},construct:function eV(t){var n,e,i,r,s,o,d,_e,$=0,I=null;if(null===(n=HT.exec(t))&&(n=VT.exec(t)),null===n)throw new Error("Date resolve error");if(e=+n[1],i=+n[2]-1,r=+n[3],!n[4])return new Date(Date.UTC(e,i,r));if(s=+n[4],o=+n[5],d=+n[6],n[7]){for($=n[7].slice(0,3);$.length<3;)$+="0";$=+$}return n[9]&&(I=6e4*(60*+n[10]+ +(n[11]||0)),"-"===n[9]&&(I=-I)),_e=new Date(Date.UTC(e,i,r,s,o,d,$)),I&&_e.setTime(_e.getTime()-I),_e},instanceOf:Date,represent:function tV(t){return t.toISOString()}}),qT=new cr("tag:yaml.org,2002:merge",{kind:"scalar",resolve:function nV(t){return"<<"===t||null===t}}),Q0="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\n\r",WT=new cr("tag:yaml.org,2002:binary",{kind:"scalar",resolve:function iV(t){if(null===t)return!1;var n,e,i=0,r=t.length,s=Q0;for(e=0;e<r;e++)if(!((n=s.indexOf(t.charAt(e)))>64)){if(n<0)return!1;i+=6}return i%8==0},construct:function rV(t){var n,e,i=t.replace(/[\r\n=]/g,""),r=i.length,s=Q0,o=0,d=[];for(n=0;n<r;n++)n%4==0&&n&&(d.push(o>>16&255),d.push(o>>8&255),d.push(255&o)),o=o<<6|s.indexOf(i.charAt(n));return 0==(e=r%4*6)?(d.push(o>>16&255),d.push(o>>8&255),d.push(255&o)):18===e?(d.push(o>>10&255),d.push(o>>2&255)):12===e&&d.push(o>>4&255),new Uint8Array(d)},predicate:function oV(t){return"[object Uint8Array]"===Object.prototype.toString.call(t)},represent:function sV(t){var i,r,n="",e=0,s=t.length,o=Q0;for(i=0;i<s;i++)i%3==0&&i&&(n+=o[e>>18&63],n+=o[e>>12&63],n+=o[e>>6&63],n+=o[63&e]),e=(e<<8)+t[i];return 0==(r=s%3)?(n+=o[e>>18&63],n+=o[e>>12&63],n+=o[e>>6&63],n+=o[63&e]):2===r?(n+=o[e>>10&63],n+=o[e>>4&63],n+=o[e<<2&63],n+=o[64]):1===r&&(n+=o[e>>2&63],n+=o[e<<4&63],n+=o[64],n+=o[64]),n}}),aV=Object.prototype.hasOwnProperty,lV=Object.prototype.toString,KT=new cr("tag:yaml.org,2002:omap",{kind:"sequence",resolve:function cV(t){if(null===t)return!0;var e,i,r,s,o,n=[],d=t;for(e=0,i=d.length;e<i;e+=1){if(o=!1,"[object Object]"!==lV.call(r=d[e]))return!1;for(s in r)if(aV.call(r,s)){if(o)return!1;o=!0}if(!o)return!1;if(-1!==n.indexOf(s))return!1;n.push(s)}return!0},construct:function uV(t){return null!==t?t:[]}}),dV=Object.prototype.toString,ZT=new cr("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:function fV(t){if(null===t)return!0;var n,e,i,r,s,o=t;for(s=new Array(o.length),n=0,e=o.length;n<e;n+=1){if("[object Object]"!==dV.call(i=o[n])||1!==(r=Object.keys(i)).length)return!1;s[n]=[r[0],i[r[0]]]}return!0},construct:function hV(t){if(null===t)return[];var n,e,i,r,s,o=t;for(s=new Array(o.length),n=0,e=o.length;n<e;n+=1)i=o[n],r=Object.keys(i),s[n]=[r[0],i[r[0]]];return s}}),pV=Object.prototype.hasOwnProperty,XT=new cr("tag:yaml.org,2002:set",{kind:"mapping",resolve:function gV(t){if(null===t)return!0;var n,e=t;for(n in e)if(pV.call(e,n)&&null!==e[n])return!1;return!0},construct:function mV(t){return null!==t?t:{}}}),J0=UT.extend({implicit:[GT,qT],explicit:[WT,KT,ZT,XT]}),Wa=Object.prototype.hasOwnProperty,$V=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,vV=/[\x85\u2028\u2029]/,bV=/[,\[\]\{\}]/,tI=/^(?:!|!!|![a-z\-]+!)$/i,nI=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function iI(t){return Object.prototype.toString.call(t)}function Ro(t){return 10===t||13===t}function zl(t){return 9===t||32===t}function es(t){return 9===t||32===t||10===t||13===t}function uu(t){return 44===t||91===t||93===t||123===t||125===t}function yV(t){var n;return 48<=t&&t<=57?t-48:97<=(n=32|t)&&n<=102?n-97+10:-1}function CV(t){return 120===t?2:117===t?4:85===t?8:0}function xV(t){return 48<=t&&t<=57?t-48:-1}function rI(t){return 48===t?"\0":97===t?"\x07":98===t?"\b":116===t||9===t?"\t":110===t?"\n":118===t?"\v":102===t?"\f":114===t?"\r":101===t?"\x1b":32===t?" ":34===t?'"':47===t?"/":92===t?"\\":78===t?"\x85":95===t?"\xa0":76===t?"\u2028":80===t?"\u2029":""}function wV(t){return t<=65535?String.fromCharCode(t):String.fromCharCode(55296+(t-65536>>10),56320+(t-65536&1023))}for(var sI=new Array(256),oI=new Array(256),du=0;du<256;du++)sI[du]=rI(du)?1:0,oI[du]=rI(du);function EV(t,n){this.input=t,this.filename=n.filename||null,this.schema=n.schema||J0,this.onWarning=n.onWarning||null,this.legacy=n.legacy||!1,this.json=n.json||!1,this.listener=n.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=t.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}function aI(t,n){var e={name:t.filename,buffer:t.input.slice(0,-1),position:t.position,line:t.line,column:t.position-t.lineStart};return e.snippet=function SH(t,n){if(n=Object.create(n||null),!t.buffer)return null;n.maxLength||(n.maxLength=79),"number"!=typeof n.indent&&(n.indent=1),"number"!=typeof n.linesBefore&&(n.linesBefore=3),"number"!=typeof n.linesAfter&&(n.linesAfter=2);for(var s,e=/\r?\n|\r|\0/g,i=[0],r=[],o=-1;s=e.exec(t.buffer);)r.push(s.index),i.push(s.index+s[0].length),t.position<=s.index&&o<0&&(o=i.length-2);o<0&&(o=i.length-1);var $,I,d="",Q=Math.min(t.line+n.linesAfter,r.length).toString().length,fe=n.maxLength-(n.indent+Q+3);for($=1;$<=n.linesBefore&&!(o-$<0);$++)I=Y0(t.buffer,i[o-$],r[o-$],t.position-(i[o]-i[o-$]),fe),d=Wi_repeat(" ",n.indent)+Z0((t.line-$+1).toString(),Q)+" | "+I.str+"\n"+d;for(I=Y0(t.buffer,i[o],r[o],t.position,fe),d+=Wi_repeat(" ",n.indent)+Z0((t.line+1).toString(),Q)+" | "+I.str+"\n",d+=Wi_repeat("-",n.indent+Q+3+I.pos)+"^\n",$=1;$<=n.linesAfter&&!(o+$>=r.length);$++)I=Y0(t.buffer,i[o+$],r[o+$],t.position-(i[o]-i[o+$]),fe),d+=Wi_repeat(" ",n.indent)+Z0((t.line+$+1).toString(),Q)+" | "+I.str+"\n";return d.replace(/\n$/,"")}(e),new Br(n,e)}function zt(t,n){throw aI(t,n)}function eg(t,n){t.onWarning&&t.onWarning.call(null,aI(t,n))}var lI={YAML:function(n,e,i){var r,s,o;null!==n.version&&zt(n,"duplication of %YAML directive"),1!==i.length&&zt(n,"YAML directive accepts exactly one argument"),null===(r=/^([0-9]+)\.([0-9]+)$/.exec(i[0]))&&zt(n,"ill-formed argument of the YAML directive"),s=parseInt(r[1],10),o=parseInt(r[2],10),1!==s&&zt(n,"unacceptable YAML version of the document"),n.version=i[0],n.checkLineBreaks=o<2,1!==o&&2!==o&&eg(n,"unsupported YAML version of the document")},TAG:function(n,e,i){var r,s;2!==i.length&&zt(n,"TAG directive accepts exactly two arguments"),s=i[1],tI.test(r=i[0])||zt(n,"ill-formed tag handle (first argument) of the TAG directive"),Wa.call(n.tagMap,r)&&zt(n,'there is a previously declared suffix for "'+r+'" tag handle'),nI.test(s)||zt(n,"ill-formed tag prefix (second argument) of the TAG directive");try{s=decodeURIComponent(s)}catch(o){zt(n,"tag prefix is malformed: "+s)}n.tagMap[r]=s}};function Ka(t,n,e,i){var r,s,o,d;if(n<e){if(d=t.input.slice(n,e),i)for(r=0,s=d.length;r<s;r+=1)9===(o=d.charCodeAt(r))||32<=o&&o<=1114111||zt(t,"expected valid JSON character");else $V.test(d)&&zt(t,"the stream contains non-printable characters");t.result+=d}}function cI(t,n,e,i){var r,s,o,d;for(Wi_isObject(e)||zt(t,"cannot merge mappings; the provided source object is unacceptable"),o=0,d=(r=Object.keys(e)).length;o<d;o+=1)Wa.call(n,s=r[o])||(n[s]=e[s],i[s]=!0)}function fu(t,n,e,i,r,s,o,d,$){var I,Q;if(Array.isArray(r))for(I=0,Q=(r=Array.prototype.slice.call(r)).length;I<Q;I+=1)Array.isArray(r[I])&&zt(t,"nested arrays are not supported inside keys"),"object"==typeof r&&"[object Object]"===iI(r[I])&&(r[I]="[object Object]");if("object"==typeof r&&"[object Object]"===iI(r)&&(r="[object Object]"),r=String(r),null===n&&(n={}),"tag:yaml.org,2002:merge"===i)if(Array.isArray(s))for(I=0,Q=s.length;I<Q;I+=1)cI(t,n,s[I],e);else cI(t,n,s,e);else!t.json&&!Wa.call(e,r)&&Wa.call(n,r)&&(t.line=o||t.line,t.lineStart=d||t.lineStart,t.position=$||t.position,zt(t,"duplicated mapping key")),"__proto__"===r?Object.defineProperty(n,r,{configurable:!0,enumerable:!0,writable:!0,value:s}):n[r]=s,delete e[r];return n}function t1(t){var n;10===(n=t.input.charCodeAt(t.position))?t.position++:13===n?(t.position++,10===t.input.charCodeAt(t.position)&&t.position++):zt(t,"a line break is expected"),t.line+=1,t.lineStart=t.position,t.firstTabInLine=-1}function Ri(t,n,e){for(var i=0,r=t.input.charCodeAt(t.position);0!==r;){for(;zl(r);)9===r&&-1===t.firstTabInLine&&(t.firstTabInLine=t.position),r=t.input.charCodeAt(++t.position);if(n&&35===r)do{r=t.input.charCodeAt(++t.position)}while(10!==r&&13!==r&&0!==r);if(!Ro(r))break;for(t1(t),r=t.input.charCodeAt(t.position),i++,t.lineIndent=0;32===r;)t.lineIndent++,r=t.input.charCodeAt(++t.position)}return-1!==e&&0!==i&&t.lineIndent<e&&eg(t,"deficient indentation"),i}function tg(t){var e,n=t.position;return!(45!==(e=t.input.charCodeAt(n))&&46!==e||e!==t.input.charCodeAt(n+1)||e!==t.input.charCodeAt(n+2)||(n+=3,e=t.input.charCodeAt(n),0!==e&&!es(e)))}function n1(t,n){1===n?t.result+=" ":n>1&&(t.result+=Wi_repeat("\n",n-1))}function uI(t,n){var e,$,i=t.tag,r=t.anchor,s=[],d=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=s),$=t.input.charCodeAt(t.position);0!==$&&(-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,zt(t,"tab characters must not be used in indentation")),45===$&&es(t.input.charCodeAt(t.position+1)));)if(d=!0,t.position++,Ri(t,!0,-1)&&t.lineIndent<=n)s.push(null),$=t.input.charCodeAt(t.position);else if(e=t.line,hu(t,n,3,!1,!0),s.push(t.result),Ri(t,!0,-1),$=t.input.charCodeAt(t.position),(t.line===e||t.lineIndent>n)&&0!==$)zt(t,"bad indentation of a sequence entry");else if(t.lineIndent<n)break;return!!d&&(t.tag=i,t.anchor=r,t.kind="sequence",t.result=s,!0)}function AV(t){var n,r,s,o,e=!1,i=!1;if(33!==(o=t.input.charCodeAt(t.position)))return!1;if(null!==t.tag&&zt(t,"duplication of a tag property"),60===(o=t.input.charCodeAt(++t.position))?(e=!0,o=t.input.charCodeAt(++t.position)):33===o?(i=!0,r="!!",o=t.input.charCodeAt(++t.position)):r="!",n=t.position,e){do{o=t.input.charCodeAt(++t.position)}while(0!==o&&62!==o);t.position<t.length?(s=t.input.slice(n,t.position),o=t.input.charCodeAt(++t.position)):zt(t,"unexpected end of the stream within a verbatim tag")}else{for(;0!==o&&!es(o);)33===o&&(i?zt(t,"tag suffix cannot contain exclamation marks"):(r=t.input.slice(n-1,t.position+1),tI.test(r)||zt(t,"named tag handle cannot contain such characters"),i=!0,n=t.position+1)),o=t.input.charCodeAt(++t.position);s=t.input.slice(n,t.position),bV.test(s)&&zt(t,"tag suffix cannot contain flow indicator characters")}s&&!nI.test(s)&&zt(t,"tag name cannot contain such characters: "+s);try{s=decodeURIComponent(s)}catch(d){zt(t,"tag name is malformed: "+s)}return e?t.tag=s:Wa.call(t.tagMap,r)?t.tag=t.tagMap[r]+s:"!"===r?t.tag="!"+s:"!!"===r?t.tag="tag:yaml.org,2002:"+s:zt(t,'undeclared tag handle "'+r+'"'),!0}function PV(t){var n,e;if(38!==(e=t.input.charCodeAt(t.position)))return!1;for(null!==t.anchor&&zt(t,"duplication of an anchor property"),e=t.input.charCodeAt(++t.position),n=t.position;0!==e&&!es(e)&&!uu(e);)e=t.input.charCodeAt(++t.position);return t.position===n&&zt(t,"name of an anchor node must contain at least one character"),t.anchor=t.input.slice(n,t.position),!0}function hu(t,n,e,i,r){var s,o,d,fe,_e,Ce,Ee,Re,Le,$=1,I=!1,Q=!1;if(null!==t.listener&&t.listener("open",t),t.tag=null,t.anchor=null,t.kind=null,t.result=null,s=o=d=4===e||3===e,i&&Ri(t,!0,-1)&&(I=!0,t.lineIndent>n?$=1:t.lineIndent===n?$=0:t.lineIndent<n&&($=-1)),1===$)for(;AV(t)||PV(t);)Ri(t,!0,-1)?(I=!0,d=s,t.lineIndent>n?$=1:t.lineIndent===n?$=0:t.lineIndent<n&&($=-1)):d=!1;if(d&&(d=I||r),(1===$||4===e)&&(Re=1===e||2===e?n:n+1,Le=t.position-t.lineStart,1===$?d&&(uI(t,Le)||function DV(t,n,e){var i,r,s,o,d,$,Ae,I=t.tag,Q=t.anchor,fe={},_e=Object.create(null),Ce=null,Ee=null,Re=null,Le=!1,Be=!1;if(-1!==t.firstTabInLine)return!1;for(null!==t.anchor&&(t.anchorMap[t.anchor]=fe),Ae=t.input.charCodeAt(t.position);0!==Ae;){if(!Le&&-1!==t.firstTabInLine&&(t.position=t.firstTabInLine,zt(t,"tab characters must not be used in indentation")),i=t.input.charCodeAt(t.position+1),s=t.line,63!==Ae&&58!==Ae||!es(i)){if(o=t.line,d=t.lineStart,$=t.position,!hu(t,e,2,!1,!0))break;if(t.line===s){for(Ae=t.input.charCodeAt(t.position);zl(Ae);)Ae=t.input.charCodeAt(++t.position);if(58===Ae)es(Ae=t.input.charCodeAt(++t.position))||zt(t,"a whitespace character is expected after the key-value separator within a block mapping"),Le&&(fu(t,fe,_e,Ce,Ee,null,o,d,$),Ce=Ee=Re=null),Be=!0,Le=!1,r=!1,Ce=t.tag,Ee=t.result;else{if(!Be)return t.tag=I,t.anchor=Q,!0;zt(t,"can not read an implicit mapping pair; a colon is missed")}}else{if(!Be)return t.tag=I,t.anchor=Q,!0;zt(t,"can not read a block mapping entry; a multiline key may not be an implicit key")}}else 63===Ae?(Le&&(fu(t,fe,_e,Ce,Ee,null,o,d,$),Ce=Ee=Re=null),Be=!0,Le=!0,r=!0):Le?(Le=!1,r=!0):zt(t,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),t.position+=1,Ae=i;if((t.line===s||t.lineIndent>n)&&(Le&&(o=t.line,d=t.lineStart,$=t.position),hu(t,n,4,!0,r)&&(Le?Ee=t.result:Re=t.result),Le||(fu(t,fe,_e,Ce,Ee,Re,o,d,$),Ce=Ee=Re=null),Ri(t,!0,-1),Ae=t.input.charCodeAt(t.position)),(t.line===s||t.lineIndent>n)&&0!==Ae)zt(t,"bad indentation of a mapping entry");else if(t.lineIndent<n)break}return Le&&fu(t,fe,_e,Ce,Ee,null,o,d,$),Be&&(t.tag=I,t.anchor=Q,t.kind="mapping",t.result=fe),Be}(t,Le,Re))||function kV(t,n){var i,r,s,d,Q,fe,_e,Ce,Re,Le,Be,Ae,e=!0,o=t.tag,$=t.anchor,Ee=Object.create(null);if(91===(Ae=t.input.charCodeAt(t.position)))Q=93,Ce=!1,d=[];else{if(123!==Ae)return!1;Q=125,Ce=!0,d={}}for(null!==t.anchor&&(t.anchorMap[t.anchor]=d),Ae=t.input.charCodeAt(++t.position);0!==Ae;){if(Ri(t,!0,n),(Ae=t.input.charCodeAt(t.position))===Q)return t.position++,t.tag=o,t.anchor=$,t.kind=Ce?"mapping":"sequence",t.result=d,!0;e?44===Ae&&zt(t,"expected the node content, but found ','"):zt(t,"missed comma between flow collection entries"),Be=null,fe=_e=!1,63===Ae&&es(t.input.charCodeAt(t.position+1))&&(fe=_e=!0,t.position++,Ri(t,!0,n)),i=t.line,r=t.lineStart,s=t.position,hu(t,n,1,!1,!0),Le=t.tag,Re=t.result,Ri(t,!0,n),Ae=t.input.charCodeAt(t.position),(_e||t.line===i)&&58===Ae&&(fe=!0,Ae=t.input.charCodeAt(++t.position),Ri(t,!0,n),hu(t,n,1,!1,!0),Be=t.result),Ce?fu(t,d,Ee,Le,Re,Be,i,r,s):d.push(fe?fu(t,null,Ee,Le,Re,Be,i,r,s):Re),Ri(t,!0,n),44===(Ae=t.input.charCodeAt(t.position))?(e=!0,Ae=t.input.charCodeAt(++t.position)):e=!1}zt(t,"unexpected end of the stream within a flow collection")}(t,Re)?Q=!0:(o&&function MV(t,n){var e,i,Q,fe,r=1,s=!1,o=!1,d=n,$=0,I=!1;if(124===(fe=t.input.charCodeAt(t.position)))i=!1;else{if(62!==fe)return!1;i=!0}for(t.kind="scalar",t.result="";0!==fe;)if(43===(fe=t.input.charCodeAt(++t.position))||45===fe)1===r?r=43===fe?3:2:zt(t,"repeat of a chomping mode identifier");else{if(!((Q=xV(fe))>=0))break;0===Q?zt(t,"bad explicit indentation width of a block scalar; it cannot be less than one"):o?zt(t,"repeat of an indentation width identifier"):(d=n+Q-1,o=!0)}if(zl(fe)){do{fe=t.input.charCodeAt(++t.position)}while(zl(fe));if(35===fe)do{fe=t.input.charCodeAt(++t.position)}while(!Ro(fe)&&0!==fe)}for(;0!==fe;){for(t1(t),t.lineIndent=0,fe=t.input.charCodeAt(t.position);(!o||t.lineIndent<d)&&32===fe;)t.lineIndent++,fe=t.input.charCodeAt(++t.position);if(!o&&t.lineIndent>d&&(d=t.lineIndent),Ro(fe))$++;else{if(t.lineIndent<d){3===r?t.result+=Wi_repeat("\n",s?1+$:$):1===r&&s&&(t.result+="\n");break}for(i?zl(fe)?(I=!0,t.result+=Wi_repeat("\n",s?1+$:$)):I?(I=!1,t.result+=Wi_repeat("\n",$+1)):0===$?s&&(t.result+=" "):t.result+=Wi_repeat("\n",$):t.result+=Wi_repeat("\n",s?1+$:$),s=!0,o=!0,$=0,e=t.position;!Ro(fe)&&0!==fe;)fe=t.input.charCodeAt(++t.position);Ka(t,e,t.position,!1)}}return!0}(t,Re)||function IV(t,n){var e,i,r;if(39!==(e=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,i=r=t.position;0!==(e=t.input.charCodeAt(t.position));)if(39===e){if(Ka(t,i,t.position,!0),39!==(e=t.input.charCodeAt(++t.position)))return!0;i=t.position,t.position++,r=t.position}else Ro(e)?(Ka(t,i,r,!0),n1(t,Ri(t,!1,n)),i=r=t.position):t.position===t.lineStart&&tg(t)?zt(t,"unexpected end of the document within a single quoted scalar"):(t.position++,r=t.position);zt(t,"unexpected end of the stream within a single quoted scalar")}(t,Re)||function SV(t,n){var e,i,r,s,o,d;if(34!==(d=t.input.charCodeAt(t.position)))return!1;for(t.kind="scalar",t.result="",t.position++,e=i=t.position;0!==(d=t.input.charCodeAt(t.position));){if(34===d)return Ka(t,e,t.position,!0),t.position++,!0;if(92===d){if(Ka(t,e,t.position,!0),Ro(d=t.input.charCodeAt(++t.position)))Ri(t,!1,n);else if(d<256&&sI[d])t.result+=oI[d],t.position++;else if((o=CV(d))>0){for(r=o,s=0;r>0;r--)(o=yV(d=t.input.charCodeAt(++t.position)))>=0?s=(s<<4)+o:zt(t,"expected hexadecimal character");t.result+=wV(s),t.position++}else zt(t,"unknown escape sequence");e=i=t.position}else Ro(d)?(Ka(t,e,i,!0),n1(t,Ri(t,!1,n)),e=i=t.position):t.position===t.lineStart&&tg(t)?zt(t,"unexpected end of the document within a double quoted scalar"):(t.position++,i=t.position)}zt(t,"unexpected end of the stream within a double quoted scalar")}(t,Re)?Q=!0:function NV(t){var n,e,i;if(42!==(i=t.input.charCodeAt(t.position)))return!1;for(i=t.input.charCodeAt(++t.position),n=t.position;0!==i&&!es(i)&&!uu(i);)i=t.input.charCodeAt(++t.position);return t.position===n&&zt(t,"name of an alias node must contain at least one character"),e=t.input.slice(n,t.position),Wa.call(t.anchorMap,e)||zt(t,'unidentified alias "'+e+'"'),t.result=t.anchorMap[e],Ri(t,!0,-1),!0}(t)?(Q=!0,(null!==t.tag||null!==t.anchor)&&zt(t,"alias node should not have any properties")):function TV(t,n,e){var r,s,o,d,$,I,Q,Ce,fe=t.kind,_e=t.result;if(es(Ce=t.input.charCodeAt(t.position))||uu(Ce)||35===Ce||38===Ce||42===Ce||33===Ce||124===Ce||62===Ce||39===Ce||34===Ce||37===Ce||64===Ce||96===Ce||(63===Ce||45===Ce)&&(es(r=t.input.charCodeAt(t.position+1))||e&&uu(r)))return!1;for(t.kind="scalar",t.result="",s=o=t.position,d=!1;0!==Ce;){if(58===Ce){if(es(r=t.input.charCodeAt(t.position+1))||e&&uu(r))break}else if(35===Ce){if(es(t.input.charCodeAt(t.position-1)))break}else{if(t.position===t.lineStart&&tg(t)||e&&uu(Ce))break;if(Ro(Ce)){if($=t.line,I=t.lineStart,Q=t.lineIndent,Ri(t,!1,-1),t.lineIndent>=n){d=!0,Ce=t.input.charCodeAt(t.position);continue}t.position=o,t.line=$,t.lineStart=I,t.lineIndent=Q;break}}d&&(Ka(t,s,o,!1),n1(t,t.line-$),s=o=t.position,d=!1),zl(Ce)||(o=t.position+1),Ce=t.input.charCodeAt(++t.position)}return Ka(t,s,o,!1),!!t.result||(t.kind=fe,t.result=_e,!1)}(t,Re,1===e)&&(Q=!0,null===t.tag&&(t.tag="?")),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):0===$&&(Q=d&&uI(t,Le))),null===t.tag)null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);else if("?"===t.tag){for(null!==t.result&&"scalar"!==t.kind&&zt(t,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+t.kind+'"'),fe=0,_e=t.implicitTypes.length;fe<_e;fe+=1)if((Ee=t.implicitTypes[fe]).resolve(t.result)){t.result=Ee.construct(t.result),t.tag=Ee.tag,null!==t.anchor&&(t.anchorMap[t.anchor]=t.result);break}}else if("!"!==t.tag){if(Wa.call(t.typeMap[t.kind||"fallback"],t.tag))Ee=t.typeMap[t.kind||"fallback"][t.tag];else for(Ee=null,fe=0,_e=(Ce=t.typeMap.multi[t.kind||"fallback"]).length;fe<_e;fe+=1)if(t.tag.slice(0,Ce[fe].tag.length)===Ce[fe].tag){Ee=Ce[fe];break}Ee||zt(t,"unknown tag !<"+t.tag+">"),null!==t.result&&Ee.kind!==t.kind&&zt(t,"unacceptable node kind for !<"+t.tag+'> tag; it should be "'+Ee.kind+'", not "'+t.kind+'"'),Ee.resolve(t.result,t.tag)?(t.result=Ee.construct(t.result,t.tag),null!==t.anchor&&(t.anchorMap[t.anchor]=t.result)):zt(t,"cannot resolve a node with !<"+t.tag+"> explicit tag")}return null!==t.listener&&t.listener("close",t),null!==t.tag||null!==t.anchor||Q}function FV(t){var e,i,r,o,n=t.position,s=!1;for(t.version=null,t.checkLineBreaks=t.legacy,t.tagMap=Object.create(null),t.anchorMap=Object.create(null);0!==(o=t.input.charCodeAt(t.position))&&(Ri(t,!0,-1),o=t.input.charCodeAt(t.position),!(t.lineIndent>0||37!==o));){for(s=!0,o=t.input.charCodeAt(++t.position),e=t.position;0!==o&&!es(o);)o=t.input.charCodeAt(++t.position);for(r=[],(i=t.input.slice(e,t.position)).length<1&&zt(t,"directive name must not be less than one character in length");0!==o;){for(;zl(o);)o=t.input.charCodeAt(++t.position);if(35===o){do{o=t.input.charCodeAt(++t.position)}while(0!==o&&!Ro(o));break}if(Ro(o))break;for(e=t.position;0!==o&&!es(o);)o=t.input.charCodeAt(++t.position);r.push(t.input.slice(e,t.position))}0!==o&&t1(t),Wa.call(lI,i)?lI[i](t,i,r):eg(t,'unknown document directive "'+i+'"')}Ri(t,!0,-1),0===t.lineIndent&&45===t.input.charCodeAt(t.position)&&45===t.input.charCodeAt(t.position+1)&&45===t.input.charCodeAt(t.position+2)?(t.position+=3,Ri(t,!0,-1)):s&&zt(t,"directives end mark is expected"),hu(t,t.lineIndent-1,4,!1,!0),Ri(t,!0,-1),t.checkLineBreaks&&vV.test(t.input.slice(n,t.position))&&eg(t,"non-ASCII line breaks are interpreted as content"),t.documents.push(t.result),t.position===t.lineStart&&tg(t)?46===t.input.charCodeAt(t.position)&&(t.position+=3,Ri(t,!0,-1)):t.position<t.length-1&&zt(t,"end of the stream or a document separator is expected")}function dI(t,n){n=n||{},0!==(t=String(t)).length&&(10!==t.charCodeAt(t.length-1)&&13!==t.charCodeAt(t.length-1)&&(t+="\n"),65279===t.charCodeAt(0)&&(t=t.slice(1)));var e=new EV(t,n),i=t.indexOf("\0");for(-1!==i&&(e.position=i,zt(e,"null byte is not allowed in input")),e.input+="\0";32===e.input.charCodeAt(e.position);)e.lineIndent+=1,e.position+=1;for(;e.position<e.length-1;)FV(e);return e.documents}var fI_load=function OV(t,n){var e=dI(t,n);if(0!==e.length){if(1===e.length)return e[0];throw new Br("expected a single document in the stream, but found more")}};function l1(t,n){return function(){throw new Error("Function yaml."+t+" is removed in js-yaml 4. Use yaml."+n+" instead, which is now safe by default.")}}var AI=fI_load;l1("safeLoad","load"),l1("safeLoadAll","loadAll"),l1("safeDump","dump");const PI=Object.getOwnPropertyNames(Object.prototype),FG=Object.getOwnPropertyNames(Array.prototype);let c1=(()=>{class t{constructor(){this.peerHistory=[],this.isOpen=!1}initialize(){this.initAppConfig()}initAppConfig(){var e=this;return(0,Yt.Z)(function*(){try{console.log("YAML\u8aad\u307f\u8fbc\u307f...");let i=yield e.loadYaml(),r=AI(i);t.applyConfig(r)}catch(i){console.warn(i)}Fe.trigger("LOAD_CONFIG",t.appConfig)})()}loadYaml(){return(0,Yt.Z)(function*(){let e=document.querySelector('script[type$="yaml"]');if(!e)return console.warn("loadYaml element not found."),"";let i=e.getAttribute("src");return null==i?(console.warn("loadYaml url undefined."),e.textContent):(yield fetch(i)).text()})()}static applyConfig(e,i=t.appConfig){if(null==e)return i;let r=Object.getOwnPropertyNames(e);for(let s of r)(Array.isArray(e)||Array.isArray(i)?PI.concat(FG):PI).includes(s)?console.log(`skip invalid key (${s})`):null!=e[s]&&"object"==typeof e[s]?(null==i[s]&&(i[s]=Array.isArray(e[s])?[]:{}),t.applyConfig(e[s],i[s])):"function"!=typeof e[s]&&"function"!=typeof i[s]&&(i[s]=e[s]);return i}}return t.appConfig={webrtc:{key:""},app:{title:"",mode:""},dice:{url:"",api:1}},t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();function RG(t,n){if(1&t){const e=Ye();X(0,"div",12),Ie("click",function(){return ke(e),ge(2).changeIcon()}),bt(1,"safe"),te()}2&t&&Je("background-image",yt(1,2,"url("+ge(2).myPeer.image.url+")","style"))}const OG=function(t){return{"i-am-gm":t}};function BG(t,n){if(1&t){const e=Ye();X(0,"div")(1,"div",3),xe(2,RG,2,5,"div",4),X(3,"div")(4,"label",5)(5,"b",6)(6,"input",7),Ie("click",function(r){return ke(e),ge().onGMMode(r)}),te(),be(7),te()(),nt(8,"br"),X(9,"button",8),Ie("click",function(){return ke(e),ge().changeIcon()}),be(10,"\u30d7\u30ec\u30a4\u30e4\u30fc\u30a2\u30a4\u30b3\u30f3\u5909\u66f4"),te()()(),X(11,"div"),be(12," \u3042\u306a\u305f\u306e\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\uff1a"),X(13,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().myPeerColor=r}),te(),X(14,"input",10),Ie("ngModelChange",function(r){return ke(e),ge().myPeerName=r}),te(),nt(15,"br"),be(16," \u203b\u6700\u5f8c\u306b\u4f7f\u3063\u305f\u8272\u3068\u30cb\u30c3\u30af\u30cd\u30fc\u30e0\u3092\u30d6\u30e9\u30a6\u30b6\u306b\u4fdd\u5b58\u3002"),nt(17,"br"),X(18,"span",11),be(19,"\u8272\u3092\u521d\u671f\u5024\u306b\u623b\u3059\u969b\u306f\u767d(255,255,255)\u3092\u9078\u629e\u3002"),te()()()}if(2&t){const e=ge();W(2),re("ngIf",e.myPeer.image),W(2),re("ngClass",ct(8,OG,e.isGMMode||e.isGMHold)),W(2),it("checked",e.isGMMode||e.isGMHold?"checked":""),W(1),Ze(e.isGMMode?"\u73fe\u5728GM\u30e2\u30fc\u30c9\u3067\u3059":e.isGMHold?"GM\u30e2\u30fc\u30c9\u4fdd\u7559\u4e2d":"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b"),W(6),re("ngModel",e.myPeerColor),W(1),Je("color",e.myPeerColor),re("ngModel",e.myPeerName)}}function LG(t,n){if(1&t){const e=Ye();X(0,"button",18),Ie("click",function(){return ke(e),ge(2).copyPeerId()}),X(1,"b",19),be(2,"content_copy"),te()()}2&t&&re("disabled",ge(2).isCopied)}function zG(t,n){if(1&t&&(Ge(0),X(1,"span",13)(2,"span",14),be(3),te(),nt(4,"input",15),te(),xe(5,LG,3,1,"button",16),X(6,"span",17),be(7),te(),qe()),2&t){const e=ge();W(3),Ze(e.networkService.peerContext.userId),W(1),it("value",e.networkService.peerContext.userId),W(1),re("ngIf",e.isAbleClipboardCopy),W(1),Je("color",e.myPeerColor),re("@fadeInOut",e.isCopied),W(1),An(" ",e.isCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function jG(t,n){1&t&&(X(0,"span",20),be(1,"???"),te())}function UG(t,n){if(1&t){const e=Ye();X(0,"button",18),Ie("click",function(){return ke(e),ge(3).copyRoomName()}),X(1,"b",19),be(2,"content_copy"),te()()}2&t&&re("disabled",ge(3).isRoomNameCopied)}function HG(t,n){if(1&t&&(Ge(0),X(1,"span",13)(2,"span",21),be(3),te(),nt(4,"input",22),te(),xe(5,UG,3,1,"button",16),X(6,"span",17),be(7),te(),qe()),2&t){const e=ge(2);W(3),Ca("",e.networkService.peerContext.roomName,"/",e.networkService.peerContext.roomId,""),W(1),it("value",e.networkService.peerContext.roomName+"/"+e.networkService.peerContext.roomId),W(1),re("ngIf",e.isAbleClipboardCopy),W(1),Je("color",e.myPeerColor),re("@fadeInOut",e.isRoomNameCopied),W(1),An(" ",e.isRoomNameCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function VG(t,n){if(1&t&&(X(0,"span",13)(1,"span",21),be(2),te(),nt(3,"input",22),te()),2&t){const e=ge(3);W(2),Ze(e.networkService.peerContext.password),W(1),it("value",e.networkService.peerContext.password)}}function GG(t,n){if(1&t&&(X(0,"div",29),be(1),te()),2&t){const e=ge(3);W(1),Ze(e.maskedPassword)}}function qG(t,n){if(1&t){const e=Ye();X(0,"button",18),Ie("click",function(){return ke(e),ge(3).copyPassword()}),X(1,"b",19),be(2,"content_copy"),te()()}2&t&&re("disabled",ge(3).isPasswordCopied)}const WG=function(t){return{"red-eye":t}};function KG(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div"),be(2," \u30d1\u30b9\u30ef\u30fc\u30c9 "),X(3,"label",23)(4,"input",24),Ie("click",function(r){return ke(e),ge(2).onPasswordOpen(r)}),te(),X(5,"b",25),be(6),te(),be(7,"\uff1a "),te(),X(8,"div",26),xe(9,VG,4,2,"span",27),xe(10,GG,2,1,"div",28),xe(11,qG,3,1,"button",16),X(12,"span",17),be(13),te()()(),qe()}if(2&t){const e=ge(2);W(4),it("checked",e.isPasswordOpen?"checked":""),W(1),re("ngClass",ct(10,WG,e.isPasswordOpen)),W(1),Ze(e.isPasswordOpen?"visibility":"visibility_off"),W(3),re("ngIf",e.isPasswordOpen),W(1),re("ngIf",!e.isPasswordOpen),W(1),re("ngIf",e.isAbleClipboardCopy&&e.isPasswordOpen),W(1),Je("color",e.myPeerColor),re("@fadeInOut",e.isPasswordCopied),W(1),An(" ",e.isPasswordCopied?"\u30af\u30ea\u30c3\u30d7\u30dc\u30fc\u30c9\u306b\u30b3\u30d4\u30fc\u3057\u307e\u3057\u305f\u3002":"","")}}function YG(t,n){if(1&t&&(Ge(0),nt(1,"hr"),X(2,"div"),be(3,"\u30eb\u30fc\u30e0\u540d\uff1a "),X(4,"span"),xe(5,HG,8,8,"ng-container",0),te()(),xe(6,KG,14,12,"ng-container",0),qe()),2&t){const e=ge();W(5),re("ngIf",e.networkService.isOpen),W(1),re("ngIf",e.networkService.peerContext.password)}}function ZG(t,n){1&t&&(X(0,"div",20),be(1,"\u4ed6\u306e\u53c2\u52a0\u8005\u3068\u63a5\u7d9a\u72b6\u614b"),X(2,"span",35),be(3,"\uff08\u826f\u597d "),te(),X(4,"i",36),be(5,"sentiment_very_satisfied"),te(),X(6,"span",35),be(7," \uff1e "),te(),X(8,"i",37),be(9,"sentiment_dissatisfied"),te(),X(10,"span",35),be(11," \uff1e "),te(),X(12,"i",38),be(13,"mood_bad"),te(),X(14,"span",35),be(15," \uff1e "),te(),X(16,"i",39),be(17,"sentiment_very_dissatisfied"),te(),X(18,"span",35),be(19," \u4e0d\u826f\uff09"),te(),be(20,"\uff1a"),te())}function XG(t,n){1&t&&(X(0,"div"),be(1,"[\u63a5\u7d9a\u4e2d]"),te())}function QG(t,n){if(1&t&&(X(0,"div",40),bt(1,"safe"),te()),2&t){const e=ge().$implicit;Je("background-image",yt(1,2,"url("+ge().findPeerImageUrl(e.peerId)+")","style"))}}const JG=function(t){return{"is-gm-mode":t}};function eq(t,n){if(1&t&&(X(0,"div"),xe(1,ZG,21,0,"div",30),X(2,"div"),xe(3,XG,2,0,"div",0),X(4,"div",31)(5,"i",32),be(6),te(),X(7,"span",33),be(8),te(),be(9,"["),xe(10,QG,2,5,"div",34),X(11,"span")(12,"b"),be(13),te()(),be(14,"]"),te()()()),2&t){const e=n.$implicit,i=n.index,r=ge();W(1),re("ngIf",0==i),W(2),re("ngIf",!e.isOpen),W(1),re("ngClass",ct(12,JG,r.findPeerIsGMMode(e.peerId))),W(1),ed("material-icons health "+r.healthClass(e.session.health)),W(1),Ze(r.healthIcon(e.session.health)),W(2),Ze(r.findUserId(e.peerId)),W(2),re("ngIf",r.findPeerImageUrl(e.peerId)),W(2),Je("color",r.findPeerColor(e.peerId)),W(1),Ze(r.findPeerName(e.peerId))}}function tq(t,n){if(1&t){const e=Ye();Ge(0),X(1,"input",41),Ie("ngModelChange",function(r){return ke(e),ge(2).targetUserId=r}),te(),X(2,"button",18),Ie("click",function(){return ke(e),ge(2).connectPeer()}),be(3,"\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a"),te(),nt(4,"br"),qe()}if(2&t){const e=ge(2);W(1),re("ngModel",e.targetUserId)("disabled",e.isDisableConnect),W(1),re("disabled",!e.networkService.isOpen||null==e.targetUserId||""==e.targetUserId||e.isDisableConnect)}}function nq(t,n){if(1&t){const e=Ye();X(0,"button",18),Ie("click",function(){return ke(e),ge(2).showLobby()}),be(1,"\u30ed\u30d3\u30fc\uff08\u30eb\u30fc\u30e0\u4e00\u89a7\uff09\u3092\u8868\u793a"),te()}if(2&t){const e=ge(2);re("disabled",!e.networkService.isOpen||e.isDisableConnect)}}function iq(t,n){if(1&t&&(X(0,"div"),xe(1,tq,5,3,"ng-container",0),xe(2,nq,2,1,"button",16),te()),2&t){const e=ge();W(1),re("ngIf",!e.networkService.peerContext.isRoom),W(1),re("ngIf",e.networkService.peerIds.length<=1)}}function rq(t,n){1&t&&(X(0,"div",43),be(1,"\u203b\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001\u304a\u4e92\u3044\u306eID\u3092\u30e6\u30c9\u30ca\u30ea\u30a6\u30e0\u5916\u3067\u5171\u6709\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),te())}function sq(t,n){1&t&&(X(0,"div",43),be(1,"\u203b\u4e00\u4eba\u3067\u52d5\u4f5c\u78ba\u8a8d\u3092\u884c\u3044\u305f\u3044\u5834\u5408\u306f\u30d6\u30e9\u30a6\u30b6\u30922\u3064\u958b\u304f\u3068\u826f\u3044\u3068\u601d\u3044\u307e\u3059\u3002"),te())}function oq(t,n){if(1&t&&(Ge(0),xe(1,rq,2,0,"div",42),xe(2,sq,2,0,"div",42),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.networkService.peerContexts.length<1),W(1),re("ngIf",e.networkService.peerContexts.length<1)}}function aq(t,n){1&t&&(Ge(0),X(1,"div",43),be(2,"\u203b\u30eb\u30fc\u30e0\u6a5f\u80fd\u3092\u5229\u7528\u3057\u3066\u3044\u308b\u6642\u306f\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3092\u5229\u7528\u3067\u304d\u307e\u305b\u3093\u3002"),te(),qe())}function lq(t,n){if(1&t&&(Ge(0),xe(1,oq,3,2,"ng-container",0),xe(2,aq,3,0,"ng-container",0),qe()),2&t){const e=ge();W(1),re("ngIf",!e.networkService.peerContext.isRoom),W(1),re("ngIf",e.networkService.peerContext.isRoom)}}function cq(t,n){1&t&&(Ge(0),X(1,"div",43),be(2,"\u203bGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u81ea\u5206\u304b\u3089\u63a5\u7d9a\u3092\u884c\u3048\u307e\u305b\u3093\u3002"),te(),qe())}let u1=(()=>{class t{constructor(e,i,r,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.appConfigService=s,this.targetUserId="",this.networkService=vt,this.gameRoomService=rt.instance,this.isCopied=!1,this.isRoomNameCopied=!1,this.isPasswordCopied=!1,this.isPasswordOpen=!1,this.help=""}get myPeer(){return He.myCursor}get myPeerName(){return He.myCursor?He.myCursor.name:null}set myPeerName(e){window.localStorage&&localStorage.setItem(He.CHAT_MY_NAME_LOCAL_STORAGE_KEY,e),He.myCursor&&(He.myCursor.name=e)}get myPeerColor(){return He.myCursor?He.myCursor.color:He.CHAT_DEFAULT_COLOR}set myPeerColor(e){He.myCursor&&(He.myCursor.color=e==He.CHAT_TRANSPARENT_COLOR?He.CHAT_DEFAULT_COLOR:e),window.localStorage&&localStorage.setItem(He.CHAT_MY_COLOR_LOCAL_STORAGE_KEY,He.myCursor.color)}get isGMMode(){return!!He.myCursor&&He.myCursor.isGMMode}set isGMMode(e){He.myCursor&&(He.myCursor.isGMMode=e)}get isGMHold(){return He.isGMHold}get isDisableConnect(){return this.isGMHold||this.isGMMode}get maskedPassword(){return"\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf\u25cf"}ngOnInit(){Promise.resolve().then(()=>{this.panelService.title="\u63a5\u7d9a\u60c5\u5831",this.panelService.isAbleFullScreenButton=!1})}ngOnDestroy(){clearTimeout(this._timeOutId),clearTimeout(this._timeOutId2),clearTimeout(this._timeOutId3),Fe.unregister(this)}changeIcon(){let e=[];this.myPeer&&this.myPeer.imageIdentifier&&(e=[this.myPeer.imageIdentifier]),this.modalService.open(Po,{currentImageIdentifires:e}).then(i=>{!this.myPeer||!i||(this.myPeer.imageIdentifier=i)})}connectPeer(){let e=this.targetUserId;if(this.targetUserId="",e.length<1)return;let i=ai.create(e);i.isRoom||(rt.instance.clearDeleteHistory(),vt.connect(i.peerId),(He.isGMHold||this.isGMMode)&&(He.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Fe.trigger("CHANGE_GM_MODE",null))))}showLobby(){(He.isGMHold||this.isGMMode)&&(He.isGMHold=!1,this.isGMMode=!1,this.isGMMode&&(this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Fe.trigger("CHANGE_GM_MODE",null))),this.modalService.open(mH,{width:700,height:400,left:0,top:400})}findUserId(e){const i=He.findByPeerId(e);return i?i.userId:""}findPeerName(e){const i=He.findByPeerId(e);return i?i.name:""}findPeerColor(e){const i=He.findByPeerId(e);return i?i.color:""}findPeerImageUrl(e){const i=He.findByPeerId(e);return i?i.image.url:""}findPeerIsGMMode(e){const i=He.findByPeerId(e);return!!i&&i.isGMMode}copyPeerId(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.userId),this.isCopied=!0,clearTimeout(this._timeOutId),this._timeOutId=setTimeout(()=>{this.isCopied=!1},1e3))}copyRoomName(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.roomName+"/"+this.networkService.peerContext.roomId),this.isRoomNameCopied=!0,clearTimeout(this._timeOutId2),this._timeOutId2=setTimeout(()=>{this.isRoomNameCopied=!1},1e3))}copyPassword(){navigator.clipboard&&(navigator.clipboard.writeText(this.networkService.peerContext.password),this.isPasswordCopied=!0,clearTimeout(this._timeOutId3),this._timeOutId2=setTimeout(()=>{this.isPasswordCopied=!1},1e3),this.isPasswordOpen=!1)}isAbleClipboardCopy(){return!!navigator.clipboard}onPasswordOpen(e){this.isPasswordOpen?this.isPasswordOpen=!1:(e.preventDefault(),this.modalService.open(qi,{title:"\u30d1\u30b9\u30ef\u30fc\u30c9\u306e\u8868\u793a",text:"\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",type:_i.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isPasswordOpen=!0,e.target.checked=!0}}))}onGMMode(e){He.isGMHold||this.isGMMode?this.isGMMode?(e.preventDefault(),this.modalService.open(qi,{title:"GM\u30e2\u30fc\u30c9\u89e3\u9664",text:"GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664\u3057\u307e\u3059\u304b\uff1f",type:_i.OK_CANCEL,materialIcon:"person_remove",action:()=>{He.isGMHold=!1,this.isGMMode=!1,e.target.checked=!1,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u3092\u89e3\u9664"),Fe.trigger("CHANGE_GM_MODE",null),jt.isStealthMode&&this.modalService.open(qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:_i.OK,materialIcon:"disabled_visible"})}})):(He.isGMHold=!1,this.isGMMode=!1):(e.preventDefault(),this.modalService.open(qi,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u304b\uff1f\nGM\u30e2\u30fc\u30c9\u4e2d\uff08\u4fdd\u7559\u4e2d\u542b\u3080\uff09\u306f\u3042\u306a\u305f\u304b\u3089\u30d7\u30e9\u30a4\u30d9\u30fc\u30c8\u63a5\u7d9a\u3001\u30eb\u30fc\u30e0\u3078\u306e\u63a5\u7d9a\u306f\u884c\u3048\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u3067\u306f\u3001<b>\u79d8\u8a71</b>\u3001\u88cf\u5411\u304d\u306e<b>\u30ab\u30fc\u30c9</b>\u3001\u516c\u958b\u3055\u308c\u3066\u3044\u306a\u3044<b>\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb</b>\u3001<b>\u30ad\u30e3\u30e9\u30af\u30bf\u30fc</b>\u4f4d\u7f6e\u3001<b>\u30ab\u30fc\u30bd\u30eb</b>\u4f4d\u7f6e\u3092\u3059\u3079\u3066\u898b\u308b\u3053\u3068\u304c\u3067\u304d\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u3089\u306a\u304f\u306a\u308a\u307e\u3059\u3002\n\n<b><big>\u2014With great power comes great responsibility.</big></b>",type:_i.OK_CANCEL,materialIcon:"person_add",action:()=>{He.isGMHold=!0,this.isGMMode=!1,e.target.checked=!0,this.modalService.open(qi,{title:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b",text:"\u307e\u3060GM\u30e2\u30fc\u30c9\u3067\u306f\u3042\u308a\u307e\u305b\u3093\u3002",helpHtml:"GM\u30e2\u30fc\u30c9\u306b\u306a\u308b\u306b\u306f\u3001\u30c1\u30e3\u30c3\u30c8\u304b\u3089 <b>GM\u306b\u306a\u308b</b> \u307e\u305f\u306f <b>GM\u306b\u306a\u308a\u307e\u3059</b> \u3092\u542b\u3080\u6587\u3092\u9001\u4fe1\u3057\u307e\u3059\u3002",type:_i.OK,materialIcon:"person_add"})}}))}healthIcon(e){return e>=.99?"sentiment_very_satisfied":e>.97?"sentiment_dissatisfied":e>.95?"mood_bad":"sentiment_very_dissatisfied"}healthClass(e){return e>=.99?"health-blue":e>.97?"health-green":e>.95?"health-yellow":"health-red"}}return t.\u0275fac=function(e){return new(e||t)(Oe(kn),Oe(Tn),Oe(yr),Oe(c1))},t.\u0275cmp=qt({type:t,selectors:[["peer-menu"]],decls:13,vars:8,consts:[[4,"ngIf"],["style","font-weight: bold;",4,"ngIf"],[4,"ngFor","ngForOf"],[2,"display","flex","align-items","flex-end","margin-bottom","4px"],["class","image cover","style","cursor: pointer",3,"background-image","click",4,"ngIf"],[2,"display","inline-block","margin-bottom","2px",3,"ngClass"],[2,"font-size","smaller"],["type","checkbox","name","i-am-gamemaster","value","I'm Gamemaster",3,"checked","click"],[3,"click"],["type","color",2,"width","1em","margin-right","0.5em",3,"ngModel","ngModelChange"],["placeholder","\u30cb\u30c3\u30af\u30cd\u30fc\u30e0",2,"font-weight","bolder",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],[1,"image","cover",2,"cursor","pointer",3,"click"],[1,"id-input-container"],[1,"id-spacer"],["type","text","readonly","",1,"id-input",3,"value"],[3,"disabled","click",4,"ngIf"],[1,"copied"],[3,"disabled","click"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[2,"font-weight","bold"],[1,"id-spacer","room-data"],["type","text","readonly","",1,"id-input","room-data",3,"value"],["sytle","white-space: nowrap"],["name","show-hide-password","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"display","inline"],["class","id-input-container",4,"ngIf"],["style","display: inline","class","masked-password","draggable","false",4,"ngIf"],["draggable","false",1,"masked-password",2,"display","inline"],["style","font-weight: bold",4,"ngIf"],[3,"ngClass"],[2,"margin-right","2px"],[2,"margin-right","3px"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[1,"health"],[1,"material-icons","health","health-blue"],[1,"material-icons","health","health-green"],[1,"material-icons","health","health-yellow"],[1,"material-icons","health","health-red"],[1,"cover","mini-icon"],["placeholder","\u63a5\u7d9a\u3057\u305f\u3044\u76f8\u624b\u306eID","name","targetUserId",3,"ngModel","disabled","ngModelChange"],["style","font-size: 12px",4,"ngIf"],[2,"font-size","12px"]],template:function(e,i){1&e&&(xe(0,BG,20,10,"div",0),X(1,"div")(2,"div"),be(3,"\u3042\u306a\u305f\u306eID\uff1a "),X(4,"span"),xe(5,zG,8,7,"ng-container",0),te(),xe(6,jG,2,0,"span",1),te()(),xe(7,YG,7,2,"ng-container",0),nt(8,"hr"),xe(9,eq,15,14,"div",2),xe(10,iq,3,2,"div",0),xe(11,lq,3,2,"ng-container",0),xe(12,cq,3,0,"ng-container",0)),2&e&&(re("ngIf",i.myPeer),W(5),re("ngIf",i.networkService.isOpen),W(1),re("ngIf",!i.networkService.isOpen),W(1),re("ngIf",i.networkService.peerContext.isRoom),W(2),re("ngForOf",i.networkService.peerContexts),W(1),re("ngIf",!i.isGMMode&&!i.isGMHold),W(1),re("ngIf",!i.isGMMode&&!i.isGMHold),W(1),re("ngIf",i.isGMMode||i.isGMHold))},directives:[gn,jn,si,oi,ei,Jn],pipes:[Yn],styles:['[_nghost-%COMP%]{display:block}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:table-cell;vertical-align:top;border-radius:.6rem}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:auto;height:auto;max-width:100%;max-height:100%;vertical-align:bottom}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.id-input-container[_ngcontent-%COMP%]{display:inline-block;position:relative}.id-spacer[_ngcontent-%COMP%]{visibility:hidden;display:inline-block;pointer-events:none;padding:0 3px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-family:Cambria,Georgia;font-size:larger;font-weight:bolder}.id-input[_ngcontent-%COMP%]{top:0;left:-4px;width:100%;position:absolute;background:none;border:none;outline:none;color:#444;font-family:Cambria,Georgia;font-size:larger;padding:2px;box-sizing:border-box;border-color:transparent;border-radius:3px;border-width:2px;border-style:solid;font-weight:bolder}.room-data[_ngcontent-%COMP%]{font-size:medium}.masked-password[_ngcontent-%COMP%]{font-weight:bolder;color:#444;font-family:Cambria,Georgia;-webkit-user-select:none;-moz-user-select:none;user-select:none;display:inline-block}.id-input[_ngcontent-%COMP%]:active, .id-input[_ngcontent-%COMP%]:hover{border-color:#444}.copied[_ngcontent-%COMP%]{font-size:smaller;opacity:0;white-space:nowrap}.health[_ngcontent-%COMP%]{font-size:14px;font-weight:400}.health-blue[_ngcontent-%COMP%]{color:#00f;filter:drop-shadow(0px 0px 2px skyblue)}.health-green[_ngcontent-%COMP%]{color:green;filter:drop-shadow(0px 0px 1px greenyellow)}.health-yellow[_ngcontent-%COMP%]{color:#757532;filter:drop-shadow(0px 0px 1px yellow)}.health-red[_ngcontent-%COMP%]{color:#8b0000;filter:drop-shadow(0px 0px 2px red)}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:16px;height:16px;vertical-align:middle;border-radius:.2rem;margin-right:2px}.is-gm-mode[_ngcontent-%COMP%]:after{content:"\\3010GM\\3011";color:red}.i-am-gm[_ngcontent-%COMP%]{color:red;text-shadow:1px 1px 0px #eee,-1px 1px 0px #eee,1px -1px 0px #eee,-1px -1px 0px #eee,1px 0px 0px #eee,0px 1px 0px #eee,-1px 0px 0px #eee,0px -1px 0px #eee,0px 0px 2px crimson}'],data:{animation:[yn("fadeInOut",[Nt("false => true",[Dt("50ms ease-in-out",We({opacity:1})),Dt("900ms ease-in-out",We({opacity:0}))])])]}}),t})(),rg=(()=>{class t{constructor(e){this.ngZone=e,this.batchTask=new Map,this.batchTaskTimer=null,this.needsChangeDetection=!1}add(e,i={}){this.batchTask.set(i,e),this.startTimer()}remove(e={}){this.batchTask.delete(e)}requireChangeDetection(){this.needsChangeDetection=!0,this.startTimer()}startTimer(){null==this.batchTaskTimer&&this.ngZone.runOutsideAngular(()=>{vr(()=>this.execBatch()),this.batchTaskTimer=setInterval(()=>{0<this.batchTask.size?this.execBatch():(clearInterval(this.batchTaskTimer),this.batchTaskTimer=null)},66)})}execBatch(){this.batchTask.forEach(e=>e()),this.batchTask.clear(),this.needsChangeDetection&&(this.needsChangeDetection=!1,this.ngZone.run(()=>{}))}}return t.\u0275fac=function(e){return new(e||t)(tn(bn))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const uq=["textArea"];function dq(t,n){1&t&&(nt(0,"img",27),bt(1,"safe")),2&t&&re("src",yt(1,1,ge(2).imageFile.url,"resourceUrl"),Xt)}function fq(t,n){if(1&t&&(X(0,"div",25),xe(1,dq,2,4,"img",26),te()),2&t){const e=ge();W(1),re("ngIf",0<e.imageFile.url.length)}}function hq(t,n){if(1&t&&(X(0,"div",25),nt(1,"img",27),bt(2,"safe"),te()),2&t){const e=ge(2);W(1),re("src",yt(2,1,null==e.character.faceIcon?null:e.character.faceIcon.url,"resourceUrl"),Xt)}}const pq=function(t,n){return{inverse:t,hollow:n}},gq=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}},mq=function(t){return{"black-paint":t}};function _q(t,n){if(1&t&&(X(0,"div",30)(1,"span",31),nt(2,"img",32),bt(3,"safe"),te()()),2&t){const e=ge(3);re("ngClass",cn(7,pq,e.character.isInverse,e.character.isHollow)),W(1),re("ngClass",vo(10,gq,0==e.character.aura,1==e.character.aura,2==e.character.aura,3==e.character.aura,4==e.character.aura,5==e.character.aura,6==e.character.aura,7==e.character.aura)),W(1),re("src",yt(3,4,e.character.imageFile.url,"resourceUrl"),Xt)("ngClass",ct(19,mq,e.character.isBlackPaint))}}function $q(t,n){if(1&t&&xe(0,_q,4,21,"div",29),2&t){const e=ge(2);re("ngIf",e.character&&null!=e.character.imageFile&&0<e.character.imageFile.url.length)}}function vq(t,n){if(1&t&&(xe(0,hq,3,4,"div",2),xe(1,$q,1,1,"ng-template",null,28,On)),2&t){const e=Wt(2),i=ge();re("ngIf",i.isUseFaceIcon&&i.character&&null!=i.character.faceIcon&&0<(null==i.character.faceIcon||null==i.character.faceIcon.url?null:i.character.faceIcon.url.length))("ngIfElse",e)}}function bq(t,n){if(1&t){const e=Ye();X(0,"input",33),Ie("ngModelChange",function(r){return ke(e),ge().isUseFaceIcon=r})("change",function(){ke(e);const r=ge();return r.isUseFaceIcon=!!r.isUseFaceIcon}),te()}if(2&t){const e=ge();it("checked",e.isUseFaceIcon?"checked":""),re("ngModel",e.isUseFaceIcon)}}function yq(t,n){1&t&&(X(0,"b",34),be(1,"\u9854IC"),te())}function Cq(t,n){if(1&t&&(X(0,"option",35),be(1),te()),2&t){const e=ge();Je("color",e.myColor),it("value",null==e.myPeer?null:e.myPeer.identifier),W(1),An("",null==e.myPeer?null:e.myPeer.name,"\uff08\u3042\u306a\u305f\uff09")}}function xq(t,n){if(1&t&&(X(0,"option",36),be(1),te()),2&t){const e=n.$implicit;Je("color",e.chatPalette&&e.chatPalette.color&&"#ffffff"!=e.chatPalette.color?e.chatPalette.color:"#444"),it("value",e.identifier),W(1),Ze(e.name)}}function wq(t,n){1&t&&(Ge(0),be(1,"\uff08\u3042\u306a\u305f\uff09"),qe())}function Eq(t,n){if(1&t&&(X(0,"option",35),be(1),xe(2,wq,2,0,"ng-container",24),te()),2&t){const e=n.$implicit,i=ge();Je("color",e.color),it("value",e.identifier),W(1),An("",e.name," "),W(1),re("ngIf",e===i.myPeer)}}function Tq(t,n){if(1&t&&(X(0,"option",42),be(1),te()),2&t){const e=n.$implicit;it("value",e.script),W(1),Ze(e.game)}}function Iq(t,n){if(1&t&&(X(0,"optgroup",40),xe(1,Tq,2,2,"option",41),te()),2&t){const e=n.$implicit;it("label",e.index),W(1),re("ngForOf",e.infos)}}const sf=function(){return{standalone:!0}},sg=function(t){return{"not-specified":t}};function Sq(t,n){if(1&t){const e=Ye();X(0,"select",37),Ie("change",function(r){return ke(e),ge().loadDiceBot(r.target.value)})("ngModelChange",function(r){return ke(e),ge().gameType=r}),X(1,"option",38),be(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u6307\u5b9a\u306a\u3057"),te(),xe(3,Iq,2,2,"optgroup",39),te()}if(2&t){const e=ge();re("ngModel",e.gameType)("ngModelOptions",Yo(4,sf))("ngClass",ct(5,sg,"DiceBot"==e.gameType||""==e.gameType)),W(3),re("ngForOf",e.diceBotInfosIndexed)}}function kq(t,n){if(1&t){const e=Ye();X(0,"select",43),Ie("change",function(r){return ke(e),ge().loadDiceBot(r.target.value)})("ngModelChange",function(r){return ke(e),ge().gameType=r}),X(1,"option",38),be(2,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8aad\u8fbc\u4e2d\u2026"),te()()}if(2&t){const e=ge();re("ngModel",e.gameType)("ngModelOptions",Yo(3,sf))("ngClass",ct(4,sg,"DiceBot"==e.gameType||""==e.gameType))}}function Mq(t,n){if(1&t&&(X(0,"option",42),be(1),te()),2&t){const e=n.$implicit;it("value",e),W(1),Ze(e)}}const Dq=function(t){return{"disabled-stand":t}};function Aq(t,n){if(1&t){const e=Ye();X(0,"div",44)(1,"label",45)(2,"input",33),Ie("ngModelChange",function(r){return ke(e),ge().isUseStandImage=r})("change",function(){ke(e);const r=ge();return r.isUseStandImage=!!r.isUseStandImage}),te(),X(3,"b",34),be(4,"Stand: "),te()(),X(5,"select",46),Ie("change",function(){return ke(e),ge().isUseStandImage=!0})("ngModelChange",function(r){return ke(e),ge().standName=r}),X(6,"option",13),be(7,"\u672a\u9078\u629e"),te(),xe(8,Mq,2,2,"option",41),te(),X(9,"span",47)(10,"b",34),be(11,"Pos: "),te(),X(12,"input",48),Ie("change",function(){return ke(e),ge().isUseStandImage=!0})("ngModelChange",function(r){return ke(e),ge().character.standList.position=r}),te(),X(13,"input",49),Ie("change",function(){return ke(e),ge().isUseStandImage=!0})("ngModelChange",function(r){return ke(e),ge().character.standList.position=r}),te(),X(14,"b",34),be(15,"\uff05"),te()(),X(16,"button",50),Ie("click",function(){return ke(e),ge().farewellStand()}),be(17,"\u9000\u53bb"),te()()}if(2&t){const e=ge();re("ngClass",ct(14,Dq,!e.isUseStandImageOnChatTab)),W(2),it("checked",e.isUseStandImage?"checked":""),re("ngModel",e.isUseStandImage),Rt("disabled",e.isUseStandImageOnChatTab?null:""),W(3),re("ngModel",e.standName)("ngModelOptions",Yo(16,sf))("ngClass",ct(17,sg,""==e.standName)),Rt("disabled",e.isUseStandImageOnChatTab?null:""),W(3),re("ngForOf",e.standNameList),W(4),re("ngModel",e.character.standList.position),Rt("disabled",e.isUseStandImageOnChatTab?null:""),W(1),re("ngModel",e.character.standList.position),Rt("disabled",e.isUseStandImageOnChatTab?null:""),W(3),Rt("disabled",e.isUseStandImageOnChatTab?null:"")}}function Pq(t,n){if(1&t){const e=Ye();X(0,"input",51),Ie("ngModelChange",function(r){return ke(e),ge().paletteColor=r}),te()}2&t&&re("ngModel",ge().paletteColor)("ngModelOptions",Yo(2,sf))}function Nq(t,n){1&t&&(X(0,"div",58),bt(1,"safe"),te()),2&t&&Je("background-image",yt(1,2,"url("+ge().$implicit.imageUrl+")","style"))}function Fq(t,n){1&t&&(X(0,"span",59),be(1,", "),te())}function Rq(t,n){if(1&t&&(X(0,"div",53),xe(1,Nq,2,5,"div",54),X(2,"div",55),bt(3,"safe"),X(4,"span",56),be(5),te(),xe(6,Fq,2,0,"span",57),te()()),2&t){const e=n.$implicit,i=n.index,r=ge(2);W(1),re("ngIf",e.imageUrl),W(1),Je("color",yt(3,5,e.color,"style")),W(3),Ze(e.name),W(1),re("ngIf",r.writingPeerNameAndColors.length!==i+1)}}function Oq(t,n){if(1&t&&(Ge(0),xe(1,Rq,7,8,"div",52),be(2," \u304c\u5165\u529b\u4e2d... "),qe()),2&t){const e=ge();W(1),re("ngForOf",e.writingPeerNameAndColors)}}const Bq=function(t){return{"direct-message":t}},NI=function(t,n){return{color:t,"font-weight":n}};class Ki{constructor(n,e,i,r,s,o){this.ngZone=n,this.chatMessageService=e,this.batchService=i,this.panelService=r,this.pointerDeviceService=s,this.contextMenuService=o,this.onlyCharacters=!1,this.chatTabidentifier="",this._gameType="",this.gameTypeChange=new vn,this._sendFrom=this.myPeer?this.myPeer.identifier:"",this.sendFromChange=new vn,this._sendTo="",this.sendToChange=new vn,this._text="",this.textChange=new vn,this.chat=new vn,this.gameHelp="",this.isUseFaceIcon=!0,this.isUseStandImage=!0,this.currentHistoryIndex=-1,this.standName="",this.shouldUpdateCharacterList=!0,this._gameCharacters=[],this.writingEventInterval=null,this.previousWritingLength=0,this.writingPeers=new Map,this.writingPeerNameAndColors=[]}get isUseStandImageOnChatTab(){const n=rt.instance.get(this.chatTabidentifier);return n&&n.isUseStandImage}get gameType(){return this._gameType}set gameType(n){this._gameType=n,this.gameTypeChange.emit(n)}get sendFrom(){return this._sendFrom}set sendFrom(n){this._sendFrom=n,this.sendFromChange.emit(n)}get sendTo(){return this._sendTo}set sendTo(n){this._sendTo=n,this.sendToChange.emit(n)}get text(){return this._text}set text(n){this._text=n,this.textChange.emit(n)}get isDirect(){return!(null==this.sendTo||!this.sendTo.length)}get character(){let n=rt.instance.get(this.sendFrom);return n instanceof jt?n:null}get hasStand(){return!(!this.character||!this.character.standList)&&this.character.standList.standElements.length>0}get standNameList(){if(!this.hasStand)return[];let n=[];for(let e of this.character.standList.standElements){let i=e.getFirstElementByName("name");i&&i.value&&n.indexOf(i.value.toString())<0&&n.push(i.value.toString())}return n.sort()}get standListNoGroup(){return[]}get standListWithGroup(){if(!this.hasStand)return[];let n={};const e=this.character.standList.standElements.map(i=>i.getFirstElementByName("name")).filter(i=>i);e.sort((i,r)=>i.currentValue===r.currentValue?0:i.currentValue>r.currentValue?-1:1);for(const i of e)if(i&&i.value){const r=i.currentValue&&i.currentValue.toString().length>0?i.currentValue.toString():"";r&&(n[r]||(n[r]=[]),n[r].indexOf(i.value.toString())<0&&n[r].push(i.value.toString()))}return Object.keys(n).sort().map(i=>({name:i,stands:n[i].sort()})).filter(i=>i.stands.length>0)}get imageFile(){let n=rt.instance.get(this.sendFrom),e=null;return n instanceof jt?e=n.imageFile:n instanceof He&&(e=n.image),e||Lt.Empty}get paletteColor(){return this.character&&this.character.chatPalette&&this.character.chatPalette.paletteColor?this.character.chatPalette.paletteColor:He.CHAT_TRANSPARENT_COLOR}set paletteColor(n){this.character.chatPalette.color=n||He.CHAT_TRANSPARENT_COLOR}get myColor(){return He.myCursor&&He.myCursor.color&&He.myCursor.color!=He.CHAT_TRANSPARENT_COLOR?He.myCursor.color:He.CHAT_DEFAULT_COLOR}get color(){return this.paletteColor&&this.paletteColor!=He.CHAT_TRANSPARENT_COLOR?this.paletteColor:this.myColor}get sendToColor(){let n=rt.instance.get(this.sendTo);return n instanceof He?n.color:He.CHAT_DEFAULT_COLOR}get gameCharacters(){return this.shouldUpdateCharacterList&&(this.shouldUpdateCharacterList=!1,this._gameCharacters=rt.instance.getObjects(jt).filter(n=>this.allowsChat(n))),this._gameCharacters}get diceBotInfos(){return Pn.diceBotInfos}get myPeer(){return He.myCursor}get otherPeers(){return rt.instance.getObjects(He)}get diceBotInfosIndexed(){return Pn.diceBotInfosIndexed}ngOnInit(){Fe.register(this).on("MESSAGE_ADDED",n=>{if(n.data.tabIdentifier!==this.chatTabidentifier)return;let e=rt.instance.get(n.data.messageIdentifier),i=rt.instance.getObjects(He).find(s=>s.userId===e.from),r=i?i.peerId:"?";this.writingPeers.has(r)&&(this.writingPeers.get(r).stop(),this.writingPeers.delete(r),this.updateWritingPeerNameAndColors())}).on("UPDATE_GAME_OBJECT",n=>{if(n.data.aliasName!==jt.aliasName||(this.shouldUpdateCharacterList=!0,n.data.identifier!==this.sendFrom))return;let e=rt.instance.get(n.data.identifier);e&&!this.allowsChat(e)&&(this.sendFrom=0<this.gameCharacters.length&&this.onlyCharacters?this.gameCharacters[0].identifier:this.myPeer.identifier)}).on("DISCONNECT_PEER",n=>{let e=rt.instance.get(this.sendTo);e instanceof He&&e.peerId===n.data.peerId&&(this.sendTo="")}).on("WRITING_A_MESSAGE",n=>{n.isSendFromSelf||n.data!==this.chatTabidentifier||(this.writingPeers.has(n.sendFrom)||this.writingPeers.set(n.sendFrom,new ia(()=>{this.writingPeers.delete(n.sendFrom),this.updateWritingPeerNameAndColors(),this.ngZone.run(()=>{})},2e3)),this.writingPeers.get(n.sendFrom).reset(),this.updateWritingPeerNameAndColors(),this.batchService.requireChangeDetection())})}ngOnDestroy(){Fe.unregister(this),this.batchService.remove(this)}updateWritingPeerNameAndColors(){this.writingPeerNameAndColors=Array.from(this.writingPeers.keys()).map(n=>{let e=He.findByPeerId(n);return{name:e?e.name:"",color:e?e.color:He.CHAT_TRANSPARENT_COLOR,imageUrl:e?e.image.url:""}})}onInput(){if(null===this.writingEventInterval&&this.previousWritingLength<=this.text.length){let n=null;if(this.isDirect){let e=rt.instance.get(this.sendTo);if(e instanceof He){let i=ai.parse(e.peerId);i&&(n=i.peerId)}}Fe.call("WRITING_A_MESSAGE",this.chatTabidentifier,n),this.writingEventInterval=setTimeout(()=>{this.writingEventInterval=null},200)}this.previousWritingLength=this.text.length,this.calcFitHeight()}moveHistory(n,e){if(n&&n.preventDefault(),this.currentHistoryIndex<0&&(this.tmpText=this.text),e<0&&this.currentHistoryIndex<0)this.currentHistoryIndex=-1;else{if(e>0&&this.currentHistoryIndex>=Ki.history.length-1)return void(this.currentHistoryIndex=Ki.history.length-1);this.currentHistoryIndex=this.currentHistoryIndex+e}let i;this.currentHistoryIndex<0?(this.currentHistoryIndex=-1,i=this.tmpText&&this.tmpText.length?this.tmpText:""):i=Ki.history[this.currentHistoryIndex],this.text=i,this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value=i,this.calcFitHeight()}sendChat(n){if(n&&n.preventDefault(),n&&13!==n.keyCode)return;this.sendFrom.length||(this.sendFrom=this.myPeer.identifier);let e=this.text,i="",r=null;if(this.character&&(et.cr(e).trim()||this.standName)&&(e=this.character.chatPalette.evaluate(this.text,this.character.rootDataElement),this.character.standList)){let d=null;d=this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:this.character.imageFile?this.character.imageFile.identifier:null;const $=this.character.standList.matchStandInfo(e,d,this.standName);if(this.isUseStandImage&&this.isUseStandImageOnChatTab)if($.farewell)this.farewellStand();else if($.standElementIdentifier){r=$.standElementIdentifier;const I={characterIdentifier:this.character.identifier,standIdentifier:$.standElementIdentifier,color:this.character.chatPalette?this.character.chatPalette.color:He.CHAT_DEFAULT_COLOR,secret:!!this.sendTo};if(I.secret){const Q=rt.instance.get(this.sendTo);Q&&(Q.peerId!=He.myCursor.peerId&&Fe.call("POPUP_STAND_IMAGE",I,Q.peerId),Fe.call("POPUP_STAND_IMAGE",I,He.myCursor.peerId))}else Fe.call("POPUP_STAND_IMAGE",I)}i=$.matchMostLongText}const s=oo.instance.matchCutInInfo(e);if(this.isUseStandImageOnChatTab&&s){for(const d of s.identifiers){const $={identifier:d,secret:!!this.sendTo,sender:He.myCursor.peerId};if($.secret){const I=rt.instance.get(this.sendTo);I&&(I.peerId!=He.myCursor.peerId&&Fe.call("PLAY_CUT_IN",$,I.peerId),Fe.call("PLAY_CUT_IN",$,He.myCursor.peerId))}else Fe.call("PLAY_CUT_IN",$)}if(s.names&&s.names.length&&!this.sendTo){const d=new Map;for(const I of s.names){let Q=d.get(I)||0;Q+=1,d.set(""==I?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":I,Q)}const $=`${[...d.keys()].map(I=>d.get(I)>1?`${I}\xd7${d.get(I)}`:I).join("\u3001")}`;this.chatMessageService.sendOperationLog($+" \u304c\u8d77\u52d5\u3057\u305f")}}if(i.length<s.matchMostLongText.length&&(i=s.matchMostLongText),e=e.slice(0,e.length-i.length),this.character&&et.cr(e).trim()){const d=/^((srepeat|repeat|srep|rep|sx|x)?(\d+)?[ \u3000]+)?([^\n]*)?/gi.exec(e);let I,$=null!=d[4]?d[4].trim():e.trim();/^(S?CHOICE\d*)[ \u3000]+([^ \u3000]*)/gi.test($)?$="":((I=/^(S?CHOICE\d*\[[^\[\]]+\])/gi.exec($))||(I=/^(S?CHOICE\d*\([^\(\)]+\))/gi.exec($)))&&($=$.slice(I[1].length));const Q=/\u300c+([\s\S]+?)\u300d/gm;let fe,_e=[];for(;null!==(fe=Q.exec($));)_e.push(fe[1]);if(0===_e.length){const Ce=$.split(/[\s\u3000]/).slice(-1)[0];et.isEmote(Ce)&&_e.push(Ce)}if(_e.length>0){const Ce={characterIdentifier:this.character.identifier,text:_e.join("\n\n"),faceIconIdentifier:this.isUseFaceIcon&&this.character.faceIcon?this.character.faceIcon.identifier:null,color:this.color,secret:!!this.sendTo};if(Ce.secret){const Ee=rt.instance.get(this.sendTo);Ee&&(Ee.peerId!=He.myCursor.peerId&&Fe.call("POPUP_CHAT_BALLOON",Ce,Ee.peerId),Fe.call("POPUP_CHAT_BALLOON",Ce,He.myCursor.peerId))}else Fe.call("POPUP_CHAT_BALLOON",Ce)}else et.cr(e).trim()&&this.character.text&&Fe.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.character.identifier})}He.isGMHold&&!this.sendTo&&!He.myCursor.isGMMode&&/GM(?:\u30e2\u30fc\u30c9)?\u306b\u306a(?:\u308a\u307e\u3059|\u308b)/i.test(et.toHalfWidth(e))&&(He.myCursor.isGMMode=!0,this.chatMessageService.sendOperationLog("GM\u30e2\u30fc\u30c9\u306b\u306a\u3063\u305f"),Fe.trigger("CHANGE_GM_MODE",null)),et.cr(e).trim()&&(Ki.history=Ki.history.filter(d=>d!==this.text),Ki.history.unshift(this.text),Ki.history.length>=Ki.MAX_HISTORY_NUM&&Ki.history.pop(),this.currentHistoryIndex=-1,this.tmpText=null,this.chat.emit({text:e,gameType:this.gameType,sendFrom:this.sendFrom,sendTo:this.sendTo,color:this.color,isInverse:!!this.character&&this.character.isInverse,isHollow:!!this.character&&this.character.isHollow,isBlackPaint:!!this.character&&this.character.isBlackPaint,aura:this.character?this.character.aura:-1,isUseFaceIcon:this.isUseFaceIcon,characterIdentifier:this.character?this.character.identifier:null,standIdentifier:r,standName:this.standName,isUseStandImage:this.isUseStandImage&&this.isUseStandImageOnChatTab})),this.text="",this.previousWritingLength=this.text.length,this.textAreaElementRef.nativeElement.value="",this.calcFitHeight(),Fe.trigger("MESSAGE_EDITING_START",null)}calcFitHeight(){let n=this.textAreaElementRef.nativeElement;n.style.height="",n.scrollHeight>=n.offsetHeight&&(n.style.height=n.scrollHeight+"px")}loadDiceBot(n){console.log("onChangeGameType ready"),Pn.getHelpMessage(n).then(e=>{console.log("onChangeGameType done\n"+e)})}showDicebotHelp(){Pn.getHelpMessage(this.gameType).then(n=>{this.gameHelp=n;let e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8";for(let o of Pn.diceBotInfos)o.id===this.gameType&&(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3008"+o.game+"\u3009");e+="\u4f7f\u7528\u6cd5";let i=this.pointerDeviceService.pointers[0],s=this.panelService.open(au,{left:i.x,top:i.y,width:600,height:500});s.title=e,s.text=this.gameHelp})}onContextMenu(n){if(n.stopPropagation(),n.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let e=this.pointerDeviceService.pointers[0];if(!this.character)return void this.contextMenuService.open(e,[{name:"\u63a5\u7d9a\u60c5\u5831",action:()=>{this.panelService.open(u1,{width:520,height:600,top:e.y-100,left:e.x-100})}}],He.myCursor.name,null,He.myCursor.color,!0);let i=[{name:"\u300c\u300d\u3092\u5165\u529b",action:()=>{let r=this.textAreaElementRef.nativeElement,s=this.text.trim();"\u300c"!=s.slice(0,1)&&(s="\u300c"+s),"\u300d"!=s.slice(-1)&&(s+="\u300d"),this.text=s,r.value=this.text,r.selectionStart=this.text.length-1,r.selectionEnd=this.text.length-1,r.focus()}}];this.character&&(this.isUseFaceIcon&&this.character.faceIcon?(i.push(At),i.push({name:"\u9854\u30a2\u30a4\u30b3\u30f3\u306e\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.faceIcons.map((r,s)=>({name:this.character.currntIconIndex==s?"\u25c9":"\u25cb",action:()=>{this.character.currntIconIndex!=s&&(this.character.currntIconIndex=s)},default:this.character.currntIconIndex==s,icon:r})),disabled:this.character.faceIcons.length<=1})):(this.character.imageFiles.length>1&&(i.push(At),i.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.character.imageFiles.map((r,s)=>({name:this.character.currntImageIndex==s?"\u25c9":"\u25cb",action:()=>{this.character.currntImageIndex=s,ut.play(Xe.surprise),Fe.trigger("UPDATE_INVENTORY",null)},default:this.character.currntImageIndex==s,icon:r}))})),i.push(At),i.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.character.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.character.isInverse=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.character.isInverse=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.character.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.character.isHollow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.character.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.character.isBlackPaint=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.character.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.character.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)}},At].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,s)=>({name:`${this.character.aura==s?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.character.aura=s,Fe.trigger("UPDATE_INVENTORY",null)}})))},At,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.character.isInverse=!1,this.character.isHollow=!1,this.character.isBlackPaint=!1,this.character.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)},disabled:!this.character.isInverse&&!this.character.isHollow&&!this.character.isBlackPaint&&-1==this.character.aura}]})),i.push(At),i.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.character)}}),this.onlyCharacters||i.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.character)}}),i.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.character)}})),this.contextMenuService.open(e,i,this.character.name)}farewellStand(){if(this.character){const n={characterIdentifier:this.character.identifier};if(this.sendTo){const e=rt.instance.get(this.sendTo);e&&(e.peerId!=He.myCursor.peerId&&Fe.call("FAREWELL_STAND_IMAGE",n,e.peerId),Fe.call("FAREWELL_STAND_IMAGE",n,He.myCursor.peerId))}else Fe.call("FAREWELL_STAND_IMAGE",n)}}showDetail(n){let e=this.pointerDeviceService.pointers[0],i="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";n.name.length&&(i+=" - "+n.name),this.panelService.open(lo,{title:i,left:e.x-400,top:e.y-300,width:800,height:600}).tabletopObject=n}showChatPalette(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(cu,{left:e.x-250,top:e.y-175,width:620,height:350}).character=n}showStandSetting(n){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Wp,{left:e.x-400,top:e.y-175,width:730,height:572}).character=n}allowsChat(n){switch(n.location.name){case"table":case this.myPeer.peerId:return!0;case"graveyard":return!1;default:for(const e of vt.peerContexts)if(e.isOpen&&n.location.name===e.peerId)return!1;return!0}}}Ki.history=new Array,Ki.MAX_HISTORY_NUM=1e3,Ki.\u0275fac=function(n){return new(n||Ki)(Oe(bn),Oe(yr),Oe(rg),Oe(Tn),Oe(li),Oe(lr))},Ki.\u0275cmp=qt({type:Ki,selectors:[["chat-input"]],viewQuery:function(n,e){if(1&n&&dn(uq,7),2&n){let i;un(i=fn())&&(e.textAreaElementRef=i.first)}},inputs:{onlyCharacters:"onlyCharacters",chatTabidentifier:"chatTabidentifier",_gameType:["gameType","_gameType"],_sendFrom:["sendFrom","_sendFrom"],_sendTo:["sendTo","_sendTo"],_text:["text","_text"]},outputs:{gameTypeChange:"gameTypeChange",sendFromChange:"sendFromChange",sendToChange:"sendToChange",textChange:"textChange",chat:"chat"},decls:35,vars:34,consts:[[1,"table",3,"ngClass"],[1,"table-cell","imagebox",2,"cursor","context-menu","padding-left","4px",3,"contextmenu"],["class","imagebox",4,"ngIf","ngIfElse"],["isCharacter",""],[1,"table-cell"],[2,"margin-right","5px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change",4,"ngIf"],["style","font-size: smaller;",4,"ngIf"],[3,"ngModel","ngStyle","ngModelChange","change"],["style","font-weight: bolder;",3,"value","color",4,"ngIf"],["style","font-weight: normal;",3,"color","value",4,"ngFor","ngForOf"],[2,"white-space","nowrap"],[2,"max-width","9.5em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],["style","width: 12em;",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],["style","width: 12em;","disabled","",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange",4,"ngIf"],[3,"click"],["style","font-size: smaller",3,"ngClass",4,"ngIf"],["type","color","style","width:1em; margin-left: 3px",3,"ngModel","ngModelOptions","ngModelChange",4,"ngIf"],[1,"chat-input",3,"placeholder","ngModel","ngModelOptions","ngModelChange","input","keydown.enter","keydown.control.arrowup","keydown.control.arrowdown"],["textArea",""],["type","submit",3,"click"],[1,"writing-info"],[4,"ngIf"],[1,"imagebox"],["class","image face-icon",3,"src",4,"ngIf"],[1,"image","face-icon",3,"src"],["noFaceIcon",""],["class","inverser",3,"ngClass",4,"ngIf"],[1,"inverser",3,"ngClass"],[1,"aura","imagebox",3,"ngClass"],[1,"image",3,"src","ngClass"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[2,"font-size","smaller"],[2,"font-weight","bolder",3,"value"],[2,"font-weight","normal",3,"value"],[2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],["value","DiceBot",1,"not-specified"],["class","dice-bot-group",3,"label",4,"ngFor","ngForOf"],[1,"dice-bot-group",3,"label"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["disabled","",2,"width","12em",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"font-size","smaller",3,"ngClass"],[2,"margin-right","2px"],[2,"width","8em","margin-right","6px",3,"ngModel","ngModelOptions","ngClass","change","ngModelChange"],[2,"white-space","nowrap","margin-left","1em","display","inline-block"],["type","range","min","0","max","100",2,"width","186px",3,"ngModel","change","ngModelChange"],["type","number","min","0","max","100",2,"width","3em","text-align","right","margin-right","3px",3,"ngModel","change","ngModelChange"],["type","button",2,"margin-left","1.3em","font-size","smaller",3,"click"],["type","color",2,"width","1em","margin-left","3px",3,"ngModel","ngModelOptions","ngModelChange"],["style","display: inline; white-space: pre",4,"ngFor","ngForOf"],[2,"display","inline","white-space","pre"],["class","cover mini-icon",3,"background-image",4,"ngIf"],[2,"font-weight","bold","display","inline"],[1,"peer-name"],["style","user-select: none",4,"ngIf"],[1,"cover","mini-icon"],[2,"user-select","none"]],template:function(n,e){if(1&n&&(X(0,"div",0)(1,"div",1),Ie("contextmenu",function(r){return e.onContextMenu(r)}),xe(2,fq,2,1,"div",2),xe(3,vq,3,2,"ng-template",null,3,On),te(),X(5,"div",4)(6,"div")(7,"label",5),xe(8,bq,1,2,"input",6),xe(9,yq,2,0,"b",7),te(),X(10,"select",8),Ie("ngModelChange",function(r){return e.sendFrom=r})("change",function(){return e.standName=""}),xe(11,Cq,2,4,"option",9),xe(12,xq,2,4,"option",10),te(),X(13,"span",11),be(14," \u27a1 "),X(15,"select",12),Ie("ngModelChange",function(r){return e.sendTo=r}),X(16,"option",13),be(17,"\u5168\u54e1"),te(),xe(18,Eq,3,5,"option",14),te()(),X(19,"span",11),xe(20,Sq,4,7,"select",15),xe(21,kq,3,6,"select",16),X(22,"button",17),Ie("click",function(){return e.showDicebotHelp()}),be(23,"?"),te()()(),xe(24,Aq,18,19,"div",18),X(25,"div")(26,"form"),xe(27,Pq,1,3,"input",19),X(28,"textarea",20,21),Ie("ngModelChange",function(r){return e.text=r})("input",function(){return e.onInput()})("keydown.enter",function(r){return e.sendChat(r)})("keydown.control.arrowup",function(r){return e.moveHistory(r,1)})("keydown.control.arrowdown",function(r){return e.moveHistory(r,-1)}),te(),X(30,"button",22),Ie("click",function(){return e.sendChat(null)}),X(31,"b"),be(32,"SEND"),te()()()(),X(33,"div",23),xe(34,Oq,3,1,"ng-container",24),te()()()),2&n){const i=Wt(4);re("ngClass",ct(23,Bq,e.isDirect)),W(2),re("ngIf",!e.character)("ngIfElse",i),W(6),re("ngIf",e.character),W(1),re("ngIf",e.character),W(1),Je("max-width",e.character?"9.5em":"13em"),re("ngModel",e.sendFrom)("ngStyle",cn(25,NI,e.color,e.sendFrom!=(null==e.myPeer?null:e.myPeer.identifier)?"normal":"bolder")),W(1),re("ngIf",!e.onlyCharacters),W(1),re("ngForOf",e.gameCharacters),W(3),re("ngModel",e.sendTo)("ngClass",ct(28,sg,""==e.sendTo))("ngStyle",cn(30,NI,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),W(3),re("ngForOf",e.otherPeers),W(2),re("ngIf",e.diceBotInfosIndexed.length>0),W(1),re("ngIf",e.diceBotInfosIndexed.length<1),W(3),re("ngIf",e.hasStand),W(3),re("ngIf",e.onlyCharacters),W(1),re("placeholder",e.onlyCharacters?"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u767d(255,255,255):\u3042\u306a\u305f\u306e\u8272":"Ctrl+\u21c5:\u5c65\u6b74 \u23ce:\u9001\u4fe1 Shift+\u23ce:\u6539\u884c\u3000\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u306e\u8272\u3092\u512a\u5148")("ngModel",e.text)("ngModelOptions",Yo(33,sf)),W(6),re("ngIf",0<e.writingPeerNameAndColors.length)}},directives:[jn,gn,Yr,oi,ei,Zr,Ji,Rr,Or,Jn,fs,si,Co,yo,ds,bl,vl,Qo],pipes:[Yn],styles:['[_nghost-%COMP%]{display:block}.table[_ngcontent-%COMP%]{box-sizing:border-box;padding:5px;display:table;width:100%}.table[_ngcontent-%COMP%]   .table-cell[_ngcontent-%COMP%]{display:table-cell}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.image.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.chat-input[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;line-height:1.3;font-size:13px;width:calc(100% - 100px);height:calc(1em + 4px);min-height:calc(1em + 7px);max-height:calc(6em + 7px);overflow-y:auto;padding:1px;margin:5px;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;vertical-align:bottom}.writing-info[_ngcontent-%COMP%]{font-size:8px;height:1.3em}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.dice-bot-group[_ngcontent-%COMP%]{color:#f5f5f5;background-color:#555}option[_ngcontent-%COMP%]{color:#000;background-color:#fff}.disabled-stand[_ngcontent-%COMP%]{color:gray}.cover[_ngcontent-%COMP%]{background-position:center top;background-repeat:no-repeat;background-size:cover}.direct-message[_ngcontent-%COMP%]   .writing-info[_ngcontent-%COMP%]{color:#eee}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:.9rem;height:.9rem;vertical-align:middle;border-radius:.2rem;margin-right:1px;-o-object-fit:cover;object-fit:cover}.direct-message[_ngcontent-%COMP%]   .mini-icon[_ngcontent-%COMP%]{filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}.direct-message[_ngcontent-%COMP%]   .peer-name[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}']});let d1=(()=>{class t{constructor(){this.tableInventory=new og(e=>"table"===e.location.name),this.commonInventory=new og(e=>!this.isAnyLocation(e.location.name)),this.privateInventory=new og(e=>e.location.name===vt.peerId),this.graveyardInventory=new og(e=>"graveyard"===e.location.name),this.indicateAll=!1,this._sortStop=!1,this.locationMap=new Map,this.tagNameMap=new Map,this.newLineString="/",this.newLineDataElement=dt.create(this.newLineString),this.initialize()}get summarySetting(){return Fo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(e){this.summarySetting.sortTag=e}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(e){this.summarySetting.sortOrder=e}get dataTag(){return this.summarySetting.dataTag}set dataTag(e){this.summarySetting.dataTag=e}get dataTags(){return this.summarySetting.dataTags}get sortStop(){return this.sortStop}set sortStop(e){const i=this._sortStop;this._sortStop=e,i&&!this._sortStop&&this.refresh()}initialize(){Fe.register(this).on("OPEN_NETWORK",e=>{this.refresh()}).on("CONNECT_PEER",e=>{this.refresh()}).on("DISCONNECT_PEER",e=>{this.refresh()}).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);if(i)if(i instanceof jt){let r=this.locationMap.get(i.identifier);i.location.name!==r&&(this.locationMap.set(i.identifier,i.location.name),this.refresh())}else if(i instanceof dt){if(!this.containsInGameCharacter(i))return;let r=this.tagNameMap.get(i.identifier);(this.dataTags.includes(r)||this.dataTags.includes(i.name))&&i.name!==r&&(this.tagNameMap.set(i.identifier,i.name),this.refreshDataElements()),this.sortTag===i.name&&this.refreshSort(),0<i.children.length&&(this.refreshDataElements(),this.refreshSort()),this.callInventoryUpdate()}else i instanceof Fo&&(this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate())}).on("DELETE_GAME_OBJECT",e=>{this.locationMap.delete(e.data.identifier),this.tagNameMap.delete(e.data.identifier),this.refresh()}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.callInventoryUpdate()})}containsInGameCharacter(e){let i=e.parent,r=jt.aliasName;for(;i;){if(i.aliasName===r)return!0;i=i.parent}return!1}refresh(){this.refreshObjects(),this.refreshDataElements(),this.refreshSort(),this.callInventoryUpdate()}refreshObjects(){this.tableInventory.refreshObjects(),this.commonInventory.refreshObjects(),this.privateInventory.refreshObjects(),this.graveyardInventory.refreshObjects()}refreshDataElements(){this.tableInventory.refreshDataElements(),this.commonInventory.refreshDataElements(),this.privateInventory.refreshDataElements(),this.graveyardInventory.refreshDataElements()}refreshSort(){this._sortStop||(this.tableInventory.refreshSort(),this.commonInventory.refreshSort(),this.privateInventory.refreshSort(),this.graveyardInventory.refreshSort())}callInventoryUpdate(){Fe.trigger("UPDATE_INVENTORY",null)}isAnyLocation(e){if("table"===e||e===vt.peerId||"graveyard"===e)return!0;for(let i of vt.peerContexts)if(i.isOpen&&e===i.peerId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();class og{constructor(n){this.classifier=n,this.newLineString="/",this.newLineDataElement=dt.create(this.newLineString),this._tabletopObjects=[],this._dataElementMap=new Map,this.needsRefreshObjects=!0,this.needsRefreshElements=!0,this.needsSort=!0}get summarySetting(){return Fo.instance}get sortTag(){return this.summarySetting.sortTag}set sortTag(n){this.summarySetting.sortTag=n}get sortOrder(){return this.summarySetting.sortOrder}set sortOrder(n){this.summarySetting.sortOrder=n}get dataTag(){return this.summarySetting.dataTag}set dataTag(n){this.summarySetting.dataTag=n}get dataTags(){return this.summarySetting.dataTags}get tabletopObjects(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this.needsSort&&(this._tabletopObjects=this.sortTabletopObjects(this._tabletopObjects),this.needsSort=!1),this._tabletopObjects}get length(){return this.needsRefreshObjects&&(this._tabletopObjects=this.searchTabletopObjects(),this.needsRefreshObjects=!1),this._tabletopObjects.length}get dataElementMap(){if(this.needsRefreshElements){this._dataElementMap.clear();let n=this.tabletopObjects;for(let e of n){if(!e.rootDataElement)continue;let i=this.dataTags.map(r=>r===this.newLineString?this.newLineDataElement:e.rootDataElement.getFirstElementByName(r));this._dataElementMap.set(e.identifier,i)}this.needsRefreshElements=!1}return this._dataElementMap}refreshObjects(){this.needsRefreshObjects=!0}refreshDataElements(){this.needsRefreshElements=!0}refreshSort(){this.needsSort=!0}searchTabletopObjects(){let n=rt.instance.getObjects(jt),e=[];for(let i of n)this.classifier(i)&&e.push(i);return e}sortTabletopObjects(n){let e=this.sortTag.length?this.sortTag.trim():"",i="ASC"===this.sortOrder?-1:1;return e.length<1||n.sort((r,s)=>{var o,d;let $=null===(o=r.rootDataElement)||void 0===o?void 0:o.getFirstElementByName(e),I=null===(d=s.rootDataElement)||void 0===d?void 0:d.getFirstElementByName(e);if(!$&&!I)return 0;if(!I)return-1;if(!$)return 1;let Q=this.convertToSortableValue($),fe=this.convertToSortableValue(I);return Q<fe?i:Q>fe?-1*i:0}),n}convertToSortableValue(n){let i=et.toHalfWidth(((n.isNumberResource?n.currentValue:n.value)+"").trim()),r=+i;return Number.isNaN(r)?i:r}}var jl;let ir=jl=class extends La{constructor(){super(...arguments),this.viewTableIdentifier="",this.gridShow=!1,this.gridSnap=!0}static get instance(){return jl._instance||(jl._instance=new jl("TableSelecter"),jl._instance.initialize()),jl._instance}onStoreAdded(){super.onStoreAdded(),Fe.register(this).on("SELECT_GAME_TABLE",n=>{console.log("SELECT_GAME_TABLE "+this.identifier),this.viewTable&&(this.viewTable.selected=!1),this.viewTableIdentifier=n.data.identifier,this.viewTable&&(this.viewTable.selected=!0)})}onStoreRemoved(){super.onStoreRemoved(),Fe.unregister(this)}get viewTable(){let n=rt.instance.get(this.viewTableIdentifier);return n||(n=rt.instance.getObjects(Fi)[0],n&&(this.viewTableIdentifier.length<1||rt.instance.isDeleted(this.viewTableIdentifier))&&(this.viewTableIdentifier=n.identifier,Fe.trigger("SELECT_GAME_TABLE",{identifier:n.identifier}))),n}};B([st()],ir.prototype,"viewTableIdentifier",void 0),ir=jl=B([Kn("TableSelecter")],ir);class Yi{constructor(){this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1}static create(n,e=null,i=new Yi){return n&&n.ownerDocument?i.setCSS((e||window.getComputedStyle(n)).transform):i.identity()}setData(n){if(null==n)return;let e=n.length;return 16==e?(this.m11=n[0],this.m12=n[1],this.m13=n[2],this.m14=n[3],this.m21=n[4],this.m22=n[5],this.m23=n[6],this.m24=n[7],this.m31=n[8],this.m32=n[9],this.m33=n[10],this.m34=n[11],this.m41=n[12],this.m42=n[13],this.m43=n[14],this.m44=n[15]):6==e?(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=0,this.m21=n[2],this.m22=n[3],this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[4],this.m42=n[5],this.m43=0,this.m44=1):9==e&&(this.m11=n[0],this.m12=n[1],this.m13=0,this.m14=n[2],this.m21=n[3],this.m22=n[4],this.m23=0,this.m24=n[5],this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=n[6],this.m42=n[7],this.m43=0,this.m44=n[8]),this}identity(){return this.m11=1,this.m12=0,this.m13=0,this.m14=0,this.m21=0,this.m22=1,this.m23=0,this.m24=0,this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m41=0,this.m42=0,this.m43=0,this.m44=1,this}scalar(n){return this.m11*=n,this.m12*=n,this.m13*=n,this.m14*=n,this.m21*=n,this.m22*=n,this.m23*=n,this.m24*=n,this.m31*=n,this.m32*=n,this.m33*=n,this.m34*=n,this.m41*=n,this.m42*=n,this.m43*=n,this.m44*=n,this}unproject(n,e={x:0,y:0,z:0,w:1}){let i=n.x*this.m11+n.y*this.m21+this.m41,r=n.x*this.m12+n.y*this.m22+this.m42,s=n.x*this.m13+n.y*this.m23+this.m43,o=n.x*this.m14+n.y*this.m24+this.m44,d=i+this.m31,$=r+this.m32,I=s+this.m33,Q=o+this.m34;0==o&&(o=1e-4),i/=o,r/=o,s/=o,0==Q&&(Q=1e-4),d/=Q,$/=Q,I/=Q;let fe=I-s;if(0==fe)return e.x=i,e.y=r,e.z=s,e.w=s,e;let _e=-s/fe;return i+=_e*(d-i),r+=_e*($-r),e.x=i,e.y=r,e.z=s,e.w=s,e}project(n,e={x:0,y:0,z:0,w:1}){let i=n.z,r=n.x*this.m14+n.y*this.m24+i*this.m34+this.m44,s=n.x*this.m11+n.y*this.m21+i*this.m31+this.m41,o=n.x*this.m12+n.y*this.m22+i*this.m32+this.m42;return 0==r&&(r=1e-4),s/=r,o/=r,r<0&&(s-=this.m41,o-=this.m42,s*=1/r,o*=1/r,s+=this.m41,o+=this.m42),e.x=s,e.y=o,e.z=i,e.w=i,e}append(n){return Yi.multiply(this,n,this)}setPosition(n){return this.m41=n.x,this.m42=n.y,this.m43=n.z,this}getPosition(n={x:0,y:0,z:0,w:1}){return n.x=this.m41,n.y=this.m42,n.z=this.m43,n}static makePosition(n,e=new Yi){return e.identity(),e.setPosition(n),e}appendPosition(...n){let e;return e=1===n.length?n[0]:{x:n[0],y:n[1],z:n[2],w:1},this.append(Yi.makePosition(e,Yi.MATRIX3D))}static makePerspective(n,e=new Yi){return e.identity(),e.m34=n?-1/n:0,e}appendPerspective(n){return n?this.append(Yi.makePerspective(n,Yi.MATRIX3D)):this}invert(n){n=n||this;let e=[],i=this.m11,r=this.m12,s=this.m13,o=this.m14,d=this.m21,$=this.m22,I=this.m23,Q=this.m24,fe=this.m31,_e=this.m32,Ce=this.m33,Ee=this.m34,Re=this.m41,Le=this.m42,Be=this.m43,Ae=this.m44;e[0]=I*Ee*Le-Q*Ce*Le+Q*_e*Be-$*Ee*Be-I*_e*Ae+$*Ce*Ae,e[1]=o*Ce*Le-s*Ee*Le-o*_e*Be+r*Ee*Be+s*_e*Ae-r*Ce*Ae,e[2]=s*Q*Le-o*I*Le+o*$*Be-r*Q*Be-s*$*Ae+r*I*Ae,e[3]=o*I*_e-s*Q*_e-o*$*Ce+r*Q*Ce+s*$*Ee-r*I*Ee;let je=i*e[0]+d*e[1]+fe*e[2]+Re*e[3];return 0==je?(console.warn("Can not invert matrix, determinant is 0"),this):(e[4]=Q*Ce*Re-I*Ee*Re-Q*fe*Be+d*Ee*Be+I*fe*Ae-d*Ce*Ae,e[5]=s*Ee*Re-o*Ce*Re+o*fe*Be-i*Ee*Be-s*fe*Ae+i*Ce*Ae,e[6]=o*I*Re-s*Q*Re-o*d*Be+i*Q*Be+s*d*Ae-i*I*Ae,e[7]=s*Q*fe-o*I*fe+o*d*Ce-i*Q*Ce-s*d*Ee+i*I*Ee,e[8]=$*Ee*Re-Q*_e*Re+Q*fe*Le-d*Ee*Le-$*fe*Ae+d*_e*Ae,e[9]=o*_e*Re-r*Ee*Re-o*fe*Le+i*Ee*Le+r*fe*Ae-i*_e*Ae,e[10]=r*Q*Re-o*$*Re+o*d*Le-i*Q*Le-r*d*Ae+i*$*Ae,e[11]=o*$*fe-r*Q*fe-o*d*_e+i*Q*_e+r*d*Ee-i*$*Ee,e[12]=I*_e*Re-$*Ce*Re-I*fe*Le+d*Ce*Le+$*fe*Be-d*_e*Be,e[13]=r*Ce*Re-s*_e*Re+s*fe*Le-i*Ce*Le-r*fe*Be+i*_e*Be,e[14]=s*$*Re-r*I*Re-s*d*Le+i*I*Le+r*d*Be-i*$*Be,e[15]=r*I*fe-s*$*fe+s*d*_e-i*I*_e-r*d*Ce+i*$*Ce,n.setData(e),n.scalar(1/je),n)}setCSS(n){if(!n||"none"==n)return this.identity();let e=n.replace("matrix3d(","").replace("matrix(","").replace(")","").split(","),i=e.length;for(let r=0;r<i;++r)e[r]=Si.parse(e[r]);return this.setData(e)}appendCSS(n,e=!1){return n&&"none"!=n?e&&n.indexOf("matrix3d")>=0?this.append(Yi.MATRIX3D.setCSS(n).flatten()):this.append(Yi.MATRIX3D.setCSS(n)):this}flatten(){return this.m31=0,this.m32=0,this.m33=1,this.m34=0,this.m44=1,this.m14=0,this.m24=0,this.m43=0,this}static multiply(n,e,i=new Yi){let s=n.m11*e.m12+n.m12*e.m22+n.m13*e.m32+n.m14*e.m42,o=n.m11*e.m13+n.m12*e.m23+n.m13*e.m33+n.m14*e.m43,d=n.m11*e.m14+n.m12*e.m24+n.m13*e.m34+n.m14*e.m44,$=n.m21*e.m11+n.m22*e.m21+n.m23*e.m31+n.m24*e.m41,I=n.m21*e.m12+n.m22*e.m22+n.m23*e.m32+n.m24*e.m42,Q=n.m21*e.m13+n.m22*e.m23+n.m23*e.m33+n.m24*e.m43,fe=n.m21*e.m14+n.m22*e.m24+n.m23*e.m34+n.m24*e.m44,_e=n.m31*e.m11+n.m32*e.m21+n.m33*e.m31+n.m34*e.m41,Ce=n.m31*e.m12+n.m32*e.m22+n.m33*e.m32+n.m34*e.m42,Ee=n.m31*e.m13+n.m32*e.m23+n.m33*e.m33+n.m34*e.m43,Re=n.m31*e.m14+n.m32*e.m24+n.m33*e.m34+n.m34*e.m44,Le=n.m41*e.m11+n.m42*e.m21+n.m43*e.m31+n.m44*e.m41,Be=n.m41*e.m12+n.m42*e.m22+n.m43*e.m32+n.m44*e.m42,Ae=n.m41*e.m13+n.m42*e.m23+n.m43*e.m33+n.m44*e.m43,je=n.m41*e.m14+n.m42*e.m24+n.m43*e.m34+n.m44*e.m44;return i.m11=n.m11*e.m11+n.m12*e.m21+n.m13*e.m31+n.m14*e.m41,i.m12=s,i.m13=o,i.m14=d,i.m21=$,i.m22=I,i.m23=Q,i.m24=fe,i.m31=_e,i.m32=Ce,i.m33=Ee,i.m34=Re,i.m41=Le,i.m42=Be,i.m43=Ae,i.m44=je,i}toString(n=3){return"m11="+this.m11.toFixed(n)+"\tm21="+this.m21.toFixed(n)+"\tm31="+this.m31.toFixed(n)+"\tm41="+this.m41.toFixed(n)+"\nm12="+this.m12.toFixed(n)+"\tm22="+this.m22.toFixed(n)+"\tm32="+this.m32.toFixed(n)+"\tm42="+this.m42.toFixed(n)+"\nm13="+this.m13.toFixed(n)+"\tm23="+this.m23.toFixed(n)+"\tm33="+this.m33.toFixed(n)+"\tm43="+this.m43.toFixed(n)+"\nm14="+this.m14.toFixed(n)+"\tm24="+this.m24.toFixed(n)+"\tm34="+this.m34.toFixed(n)+"\tm44="+this.m44.toFixed(n)}}Yi.MATRIX3D=new Yi;class of{constructor(n){this.matrix=new Yi,this.sceneTransform=new Yi,this.inverseSceneTransform=new Yi,this.initialize(n)}clear(){return this.element=null,this.matrix.identity(),this}initialize(n){if(!n)return;this.element=n;let e=window.getComputedStyle(n),i=0,r=0;return this.element.parentElement?(i=this.element.parentElement.clientWidth,r=this.element.parentElement.clientHeight):(i=window.innerWidth,r=window.innerHeight),this.paddingLeft=Si.relation(e.paddingTop,i),this.paddingTop=Si.relation(e.paddingTop,r),this.marginLeft=Si.relation(e.marginLeft,i),this.marginTop=Si.relation(e.marginTop,r),this.borderLeft=Si.relation(e.borderLeft,i),this.borderTop=Si.relation(e.borderTop,r),this.matrix.setCSS(e.transform),this.sceneTransform.identity(),this.extract(this,this.sceneTransform),this.sceneTransform.invert(this.inverseSceneTransform),this}globalToLocal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.inverseSceneTransform.unproject(r,r),this.fromBorderBox(r),r}localToGlobal(n,e,i=0){let r={x:n,y:e,z:i,w:1};return this.sceneTransform.project(r,r),this.fromBorderBox(r),r}localToLocal(n,e,i,r){let s_x=n,s_y=e,s_z=i,o=new of(r),d=Yi.multiply(this.sceneTransform,o.inverseSceneTransform),$={x:0,y:0,z:0,w:1};return $.x=s_x*d.m11+s_y*d.m21+s_z*d.m31+1*d.m41,$.y=s_x*d.m12+s_y*d.m22+s_z*d.m32+1*d.m42,$.z=s_x*d.m13+s_y*d.m23+s_z*d.m33+1*d.m43,$.w=s_x*d.m14+s_y*d.m24+s_z*d.m34+1*d.m44,o.clear(),this.toBorderBox($),$}extract(n,e){let r=n.element;for(;r;)this.extractMatrix(r,e),r&&"fixed"===r.style.position&&(console.warn("fixed\u9818\u57df\u306f\u8a08\u7b97\u304c\u4e0d\u6b63\u78ba"),e.appendPosition(window.pageXOffset,window.pageYOffset,0)),r=r.parentElement}extractMatrix(n,e=null){if(e||(e=new Yi),!n)return e;let i=n,r=window.getComputedStyle(n);if("none"!=r.transform){let d=r.transformOrigin?r.transformOrigin.split(" "):[],$=Si.relation(d[0],i.offsetWidth,.5*i.offsetWidth),I=Si.relation(d[1],i.offsetHeight,.5*i.offsetHeight),Q=Si.relation(d[2],0,0);e.appendPosition(-$,-I,-Q),e.appendCSS(r.transform),e.appendPosition($,I,Q)}let s=this.getPosition(n);e.appendPosition(s.x,s.y,0);let o=0;if(n.parentElement){let d=window.getComputedStyle(n.parentElement);o=Si.parse(d.perspective)}if(n.parentElement&&o){let $=window.getComputedStyle(n.parentElement).perspectiveOrigin.split(" "),I=Si.relation($[0],i.parentElement.offsetWidth),Q=Si.relation($[1],i.parentElement.offsetHeight);e.appendPosition(-I,-Q,0),e.appendPerspective(o),e.appendPosition(I,Q,0)}return e}getPosition(n){let e={x:0,y:0};return e.x=n.offsetParent?n.parentElement===n.offsetParent?n.offsetLeft:n.parentElement.offsetParent===n.offsetParent?n.offsetLeft-n.parentElement.offsetLeft:0:n.offsetLeft,e.y=n.offsetParent?n.parentElement===n.offsetParent?n.offsetTop:n.parentElement.offsetParent===n.offsetParent?n.offsetTop-n.parentElement.offsetTop:0:n.offsetTop,e.x+=n.offsetParent?n.offsetParent.clientLeft:0,e.y+=n.offsetParent?n.offsetParent.clientTop:0,e}fromBorderBox(n){n.x+=this.paddingLeft,n.y+=this.paddingTop,n.x-=this.marginLeft,n.y-=this.marginTop,n.x-=this.borderLeft,n.y-=this.borderTop}toBorderBox(n){n.x-=this.paddingLeft,n.y-=this.paddingTop,n.x+=this.marginLeft,n.y+=this.marginTop,n.x+=this.borderLeft,n.y+=this.borderTop}}let Ul=(()=>{class t{constructor(e){this.pointerDeviceService=e,this.tabletopOriginElement=document.body}convertToLocal(e,i=document.body){let r=new of(i),s=r.globalToLocal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:s.x,y:s.y,z:s.z}}convertToGlobal(e,i=document.body){let r=new of(i),s=r.localToGlobal(e.x,e.y,e.z?e.z:0);return r.clear(),{x:s.x,y:s.y,z:s.z}}convertLocalToLocal(e,i,r){let s=new of(i),o=s.globalToLocal(e.x,e.y,e.z?e.z:0),d=s.localToLocal(o.x,o.y,0,r);return s.clear(),{x:d.x,y:d.y,z:d.z}}calcTabletopLocalCoordinate(e={x:this.pointerDeviceService.pointers[0].x,y:this.pointerDeviceService.pointers[0].y,z:0},i=this.pointerDeviceService.targetElement){return i.contains(this.tabletopOriginElement)?(e=this.convertToLocal(e,this.tabletopOriginElement)).z=0:e=this.convertLocalToLocal(e,i,this.tabletopOriginElement),{x:e.x,y:e.y,z:0<e.z?e.z:0}}}return t.\u0275fac=function(e){return new(e||t)(tn(li))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),af=(()=>{class t{constructor(e){this.coordinateService=e,this._emptyTable=new Fi(""),this.locationMap=new Map,this.parentMap=new Map,this.characterCache=new Hl(()=>rt.instance.getObjects(jt).filter(i=>i.isVisibleOnTable)),this.cardCache=new Hl(()=>rt.instance.getObjects(Fn).filter(i=>i.isVisibleOnTable)),this.cardStackCache=new Hl(()=>rt.instance.getObjects(Un).filter(i=>i.isVisibleOnTable)),this.tableMaskCache=new Hl(()=>{let i=this.tableSelecter.viewTable;return i?i.masks:[]}),this.terrainCache=new Hl(()=>{let i=this.tableSelecter.viewTable;return i?i.terrains:[]}),this.textNoteCache=new Hl(()=>rt.instance.getObjects(vs)),this.diceSymbolCache=new Hl(()=>rt.instance.getObjects(tr)),this.initialize()}get tableSelecter(){return ir.instance}get currentTable(){return this.tableSelecter.viewTable||this._emptyTable}get characters(){return this.characterCache.objects}get cards(){return this.cardCache.objects}get cardStacks(){return this.cardStackCache.objects}get tableMasks(){return this.tableMaskCache.objects}get terrains(){return this.terrainCache.objects}get textNotes(){return this.textNoteCache.objects}get diceSymbols(){return this.diceSymbolCache.objects}get peerCursors(){return rt.instance.getObjects(He)}initialize(){this.refreshCacheAll(),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{if(e.data.identifier===this.currentTable.identifier||e.data.identifier===this.tableSelecter.identifier)return this.refreshCache(Jr.aliasName),void this.refreshCache(nr.aliasName);let i=rt.instance.get(e.data.identifier);i&&i instanceof mi?this.shouldRefreshCache(i)&&(this.refreshCache(e.data.aliasName),this.updateMap(i)):this.refreshCache(e.data.aliasName)}).on("DELETE_GAME_OBJECT",e=>{let i=e.data.aliasName;i?this.refreshCache(i):this.refreshCacheAll()}).on("XML_LOADED",e=>{let r=Gn.instance.parseXml(e.data.xmlElement);if(r instanceof mi){let s=this.coordinateService.calcTabletopLocalCoordinate();r.location.x=s.x-25,r.location.y=s.y-25,r.posZ=s.z,this.placeToTabletop(r),ut.play(Xe.piecePut)}else r instanceof qa?ao.instance.addChatTab(r):r instanceof sa?ro.instance.addDiceRollTable(r):r instanceof ui&&oo.instance.addCutIn(r)})}findCache(e){switch(e){case jt.aliasName:return this.characterCache;case Fn.aliasName:return this.cardCache;case Un.aliasName:return this.cardStackCache;case Jr.aliasName:return this.tableMaskCache;case nr.aliasName:return this.terrainCache;case vs.aliasName:return this.textNoteCache;case tr.aliasName:return this.diceSymbolCache;default:return null}}refreshCache(e){let i=this.findCache(e);i&&i.refresh()}refreshCacheAll(){this.characterCache.refresh(),this.cardCache.refresh(),this.cardStackCache.refresh(),this.tableMaskCache.refresh(),this.terrainCache.refresh(),this.textNoteCache.refresh(),this.diceSymbolCache.refresh(),this.clearMap()}shouldRefreshCache(e){return this.locationMap.get(e.identifier)!==e.location.name||this.parentMap.get(e.identifier)!==e.parentId}updateMap(e){this.locationMap.set(e.identifier,e.location.name),this.parentMap.set(e.identifier,e.parentId)}clearMap(){this.locationMap.clear(),this.parentMap.clear()}placeToTabletop(e){switch(e.aliasName){case Jr.aliasName:e instanceof Jr&&(e.isLock=!1);case nr.aliasName:if(e instanceof nr&&(e.isLocked=!1),!this.tableSelecter||!this.tableSelecter.viewTable)return;this.tableSelecter.viewTable.appendChild(e);break;default:e.setLocation("table")}}}return t.\u0275fac=function(e){return new(e||t)(tn(Ul))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class Hl{constructor(n){this.refreshCollector=n,this.needsRefresh=!0,this._objects=[]}get objects(){return this.needsRefresh&&(this._objects=this.refreshCollector(),this._objects=this._objects?this._objects:[],this.needsRefresh=!1),this._objects}refresh(){this.needsRefresh=!0}}class Vl{constructor(n,e,i){this.chanks=[],this.chankSize=32768,this.chankReceiveCount=0,this.sentChankIndex=0,this.bufferingChankRange=4,this.completedChankIndex=0,this.startTime=0,this.isCanceled=!1,this.identifier=n,this.sendTo=e,this.data=i}static createSendTask(n,e,i){let r=new Vl(n,e,i);return r.onstart=()=>r.initializeSend(),r}static createReceiveTask(n){let e=new Vl(n);return e.onstart=()=>e.initializeReceive(),e}start(n){this.onstart?(this.data=n,this.onstart(),this.onstart=null):console.warn("\u518d\u8d77\u52d5\u3059\u308b\u4ed5\u69d8\u306a\u3069\u7121\u3044\u3002")}progress(n,e){this.onprogress&&this.onprogress(this,n,e)}finish(){this.isCanceled||(this.isCanceled=!0,this.onfinish&&this.onfinish(this,this.data),this.dispose())}timeout(){this.isCanceled||(this.isCanceled=!0,this.ontimeout&&this.ontimeout(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}cancel(){this.isCanceled||(null!=this.sendTo&&Fe.call("CANCEL_TASK_"+this.identifier,null,this.sendTo),this._cancel())}_cancel(){this.isCanceled||(this.isCanceled=!0,this.oncancel&&this.oncancel(this),this.onfinish&&this.onfinish(this,this.data),this.dispose())}dispose(){Fe.unregister(this),this.sendChankTimer&&function m8(t){Md.delete(t)}(this.sendChankTimer),this.timeoutTimer&&this.timeoutTimer.clear(),this.sendChankTimer=null,this.timeoutTimer=null,this.onprogress=this.onfinish=this.ontimeout=this.oncancel=null}initializeSend(){this.uint8Array=gs.encode(this.data);let n=Math.ceil(this.uint8Array.byteLength/this.chankSize);this.chanks=new Array(n),console.log("\u30c1\u30e3\u30f3\u30af\u5206\u5272 "+this.identifier,this.chanks.length),Fe.register(this).on("FILE_MORE_CHANK_"+this.identifier,e=>{this.sendTo===e.sendFrom&&(this.completedChankIndex=e.data,null==this.sendChankTimer&&this.sentChankIndex+1<this.chanks.length&&this.sendChank(this.sentChankIndex+1),this.resetTimeout())}).on("DISCONNECT_PEER",e=>{e.data.peerId===this.sendTo&&(console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,e.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,e=>{console.warn("\u9001\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,e.sendFrom),this._cancel()}),this.sentChankIndex=this.completedChankIndex=0,this.startTime=performance.now(),vr(()=>this.sendChank(0))}sendChank(n){let e=this.uint8Array.slice(n*this.chankSize,(n+1)*this.chankSize);Fe.call("FILE_SEND_CHANK_"+this.identifier,{index:n,length:this.chanks.length,chank:e},this.sendTo),this.sentChankIndex=n,this.sendChankTimer=null,this.chanks.length<=n+1?(console.log("\u30d0\u30c3\u30d5\u30a1\u9001\u4fe1\u5b8c\u4e86",this.identifier),this.outputTransferRate(this.uint8Array.byteLength),vr(()=>this.finish())):this.completedChankIndex+this.bufferingChankRange<=n?this.resetTimeout():this.sendChankTimer=vr(()=>{this.sendChank(this.sentChankIndex+1)})}initializeReceive(){this.resetTimeout(),this.startTime=performance.now(),this.chankReceiveCount=0,Fe.register(this).on("FILE_SEND_CHANK_"+this.identifier,n=>{this.chanks.length<1&&(this.chanks=new Array(n.data.length)),null==this.chanks[n.data.index]?(this.chankReceiveCount++,this.chanks[n.data.index]=n.data.chank,this.progress(n.data.index,n.data.length),this.chanks.length<=this.chankReceiveCount?this.finishReceive():(this.resetTimeout(),Fe.call("FILE_MORE_CHANK_"+this.identifier,n.data.index,n.sendFrom))):console.log(`already received. [${n.data.index}] <${this.identifier}>`)}).on("DISCONNECT_PEER",n=>{n.data.peerId===this.sendTo&&(console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb\uff08Peer\u5207\u65ad\uff09",this,n.data.peerId),this._cancel())}).on("CANCEL_TASK_"+this.identifier,n=>{console.warn("\u53d7\u4fe1\u30ad\u30e3\u30f3\u30bb\u30eb",this,n.sendFrom),this._cancel()})}finishReceive(){console.log("\u30d0\u30c3\u30d5\u30a1\u53d7\u4fe1\u5b8c\u4e86",this.identifier);let n=0;for(let r of this.chanks)n+=r.byteLength;this.outputTransferRate(n);let e=new Uint8Array(n),i=0;for(let r of this.chanks)e.set(r,i),i+=r.byteLength;this.data=gs.decode(e),this.finish()}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ia(()=>this.timeout(),1e4)),this.timeoutTimer.reset()}outputTransferRate(n){let e=performance.now()-this.startTime,i=n/1024/1024/(e/1e3);console.log(`${(n/1024).toFixed(2)}KB ${(e/1e3).toFixed(2)}\u79d2 \u8ee2\u9001\u901f\u5ea6: ${i.toFixed(2)}MB/s`)}}class gu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4}static get instance(){return gu._instance||(gu._instance=new gu),gu._instance}initialize(){console.log("AudioSharingSystem ready..."),this.destroy(),Fe.register(this).on("CONNECT_PEER",-1,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER AudioStorageService !!!",n.data.peerId),Ft.instance.synchronize())}).on("SYNCHRONIZE_AUDIO_LIST",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_AUDIO_LIST "+n.sendFrom);let e=n.data,i=[];console.log("SYNCHRONIZE_AUDIO_LIST active tasks ",this.sendTaskMap.size+this.receiveTaskMap.size);for(let s of e){let o=Ft.instance.get(s.identifier);null===o&&(o=_s.createEmpty(s.identifier),Ft.instance.add(o)),o.state<ar.COMPLETE&&!this.receiveTaskMap.has(s.identifier)&&i.push({identifier:s.identifier,state:o.state})}if(i.length<1&&!this.hasActiveTask()&&e.length<Ft.instance.getCatalog().length&&Ft.instance.synchronize(n.sendFrom),i.length<1||this.isLimitReceiveTask())return;let r=Math.floor(Math.random()*i.length);this.request([i[r]],n.sendFrom)}).on("REQUEST_AUDIO_RESOURE",n=>{if(n.isSendFromSelf)return;let e=n.data.identifiers,i=[];for(let r of e){let s=Ft.instance.get(r.identifier);s&&r.state<s.state&&i.push({identifier:r.identifier,state:r.state})}if(!1===this.isLimitSendTask()&&0<i.length&&!this.existsSendTask(n.data.receiver)){console.log("REQUEST_AUDIO_RESOURE Send!!! "+n.data.receiver+" -> "+i);let r=Math.floor(Math.random()*i.length),o=Ft.instance.get(i[r].identifier);this.startSendTask(o,n.data.receiver)}else{let r=n.data.candidatePeers,s=r.indexOf(vt.peerId);-1<s&&r.splice(s,1);for(let o of r)return console.log("REQUEST_AUDIO_RESOURE AudioStorageService Relay!!! "+o+" -> "+n.data.identifiers),void Fe.call(n,o);console.log("REQUEST_FILE_RESOURE AudioStorageService \u3042\u3076\u308c\u305f..."+n.data.receiver,i.length)}}).on("UPDATE_AUDIO_RESOURE",1e3,n=>{let e=n.data;console.log("UPDATE_AUDIO_RESOURE AudioStorageService "+n.sendFrom+" -> ",e);for(let i of e)i.blob&&(i.blob=new Blob([i.blob],{type:i.type})),Ft.instance.add(i)}).on("START_AUDIO_TRANSMISSION",n=>{console.log("START_AUDIO_TRANSMISSION "+n.data.fileIdentifier);let e=n.data.fileIdentifier,i=Ft.instance.get(e);this.receiveTaskMap.has(e)||i&&ar.COMPLETE<=i.state?(console.warn("CANCEL_TASK_ "+e),Fe.call("CANCEL_TASK_"+e,null,n.sendFrom)):this.startReceiveTask(e)})}destroy(){Fe.unregister(this)}startSendTask(n,e){var i=this;return(0,Yt.Z)(function*(){let r=Vl.createSendTask(n.identifier,e);i.sendTaskMap.set(n.identifier,r),Fe.call("START_AUDIO_TRANSMISSION",{fileIdentifier:n.identifier},e);let s={identifier:n.identifier,name:n.name,blob:null,type:"",url:null};n.state===ar.URL?s.url=n.url:(s.blob=yield no.readAsArrayBufferAsync(n.blob),s.type=n.blob.type),r.onfinish=()=>{i.stopSendTask(r.identifier),Ft.instance.synchronize()},r.start(s)})()}startReceiveTask(n){let e=Ft.instance.get(n),i=Vl.createReceiveTask(n);this.receiveTaskMap.set(n,i),i.onprogress=(r,s,o)=>{let d=e.toContext();d.name=(100*s/o).toFixed(1)+"%",e.apply(d)},i.onfinish=(r,s)=>{this.stopReceiveTask(r.identifier),s&&Fe.trigger("UPDATE_AUDIO_RESOURE",[s]),Ft.instance.synchronize()},i.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=vt.peerIds;i.splice(i.indexOf(vt.peerId),1),Fe.call("REQUEST_AUDIO_RESOURE",{identifiers:n,receiver:vt.peerId,candidatePeers:i},e)}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class mu{constructor(){this.sendTaskMap=new Map,this.receiveTaskMap=new Map,this.maxSendTask=2,this.maxReceiveTask=4,console.log("FileSharingSystem ready...")}static get instance(){return mu._instance||(mu._instance=new mu),mu._instance}initialize(){var n=this;Fe.register(this).on("CONNECT_PEER",1,e=>{!e.isSendFromSelf||(console.log("CONNECT_PEER ImageStorageService !!!",e.data.peerId),It.instance.synchronize())}).on("XML_LOADED",e=>{!function Lq(t){let n=[],e=t.querySelectorAll('*[type="image"]');for(let i=0;i<e.length;i++){let r=e[i].innerHTML;!It.instance.get(r)&&0<Ll.type(r).length&&n.push(r)}e=t.querySelectorAll("*[imageIdentifier]");for(let i=0;i<e.length;i++){let r=e[i].getAttribute("imageIdentifier");!It.instance.get(r)&&0<Ll.type(r).length&&n.push(r)}for(let i of n)It.instance.add(i)}(e.data.xmlElement)}).on("SYNCHRONIZE_FILE_LIST",e=>{if(e.isSendFromSelf)return;console.log("SYNCHRONIZE_FILE_LIST ImageStorageService "+e.sendFrom);let i=e.data,r=[];for(let s of i){let o=It.instance.get(s.identifier);null===o&&(o=Lt.createEmpty(s.identifier),It.instance.add(o)),o.state<Ni.COMPLETE&&!this.receiveTaskMap.has(s.identifier)&&r.push({identifier:s.identifier,state:o.state})}r.length<1&&!this.hasActiveTask()&&i.length<It.instance.getCatalog().length&&It.instance.synchronize(e.sendFrom),!(r.length<1||this.isLimitReceiveTask())&&this.request(r,e.sendFrom)}).on("REQUEST_FILE_RESOURE",function(){var e=(0,Yt.Z)(function*(i){if(i.isSendFromSelf)return;let r=i.data.identifiers,s=[];for(let o of r){let d=It.instance.get(o.identifier);d&&o.state<d.state&&s.push({identifier:o.identifier,state:o.state})}if(!1===n.isLimitSendTask()&&0<s.length&&!n.existsSendTask(i.data.receiver)){let o=n.makeSendUpdateImages(s);console.log("REQUEST_FILE_RESOURE ImageStorageService Send!!! "+i.data.receiver+" -> "+o.length),n.startSendTask(o,i.data.receiver)}else{let o=i.data.candidatePeers,d=o.indexOf(vt.peerId);-1<d&&o.splice(d,1);for(let $ of o)return console.log("REQUEST_FILE_RESOURE ImageStorageService Relay!!! "+$+" -> "+i.data.identifiers),void Fe.call(i,$);console.log("REQUEST_FILE_RESOURE ImageStorageService \u3042\u3076\u308c\u305f..."+i.data.receiver,s.length)}});return function(i){return e.apply(this,arguments)}}()).on("UPDATE_FILE_RESOURE",1e3,e=>{let i=e.data.updateImages;console.log("UPDATE_FILE_RESOURE ImageStorageService "+e.sendFrom+" -> ",i);for(let r of i)r.blob&&(r.blob=new Blob([r.blob],{type:r.type})),r.thumbnail.blob&&(r.thumbnail.blob=new Blob([r.thumbnail.blob],{type:r.thumbnail.type})),It.instance.add(r)}).on("START_FILE_TRANSMISSION",e=>{console.log("START_FILE_TRANSMISSION "+e.data.taskIdentifier);let i=e.data.taskIdentifier,r=It.instance.get(i);this.receiveTaskMap.has(i)||r&&Ni.COMPLETE<=r.state?(console.warn("CANCEL_TASK_ "+i),Fe.call("CANCEL_TASK_"+i,null,e.sendFrom)):this.startReceiveTask(i)})}destroy(){Fe.unregister(this)}startSendTask(n,e){var i=this;return(0,Yt.Z)(function*(){let r=1===n.length?n[0].identifier:ms.generateUuid(),s=Vl.createSendTask(r,e);i.sendTaskMap.set(s.identifier,s),Fe.call("START_FILE_TRANSMISSION",{taskIdentifier:r},e);for(let o of n)o.thumbnail.blob?o.thumbnail.blob=yield no.readAsArrayBufferAsync(o.thumbnail.blob):o.blob&&(o.blob=yield no.readAsArrayBufferAsync(o.blob));s.onfinish=(o,d)=>{i.stopSendTask(o.identifier),It.instance.synchronize()},s.start(n)})()}startReceiveTask(n){let e=Vl.createReceiveTask(n);this.receiveTaskMap.set(n,e),e.onfinish=(i,r)=>{this.stopReceiveTask(i.identifier),r&&Fe.trigger("UPDATE_FILE_RESOURE",{identifier:i.identifier,updateImages:r}),It.instance.synchronize()},e.start(),console.log("startReceiveTask => ",this.receiveTaskMap.size)}stopSendTask(n){let e=this.sendTaskMap.get(n);e&&e.cancel(),this.sendTaskMap.delete(n),console.log("stopSendTask => ",this.sendTaskMap.size)}stopReceiveTask(n){let e=this.receiveTaskMap.get(n);e&&e.cancel(),this.receiveTaskMap.delete(n),console.log("stopReceiveTask => ",this.receiveTaskMap.size)}request(n,e){console.log("requestFile() "+e);let i=vt.peerIds;i.splice(i.indexOf(vt.peerId),1),Fe.call("REQUEST_FILE_RESOURE",{identifiers:n,receiver:vt.peerId,candidatePeers:i},e)}makeSendUpdateImages(n,e=524288){let i=[],r=0;for(let s=n.length-1;0<=s;s--){let o=Math.floor(Math.random()*(s+1));[n[s],n[o]]=[n[o],n[s]]}n.sort((s,o)=>s.state<o.state?-1:s.state>o.state?1:0);for(let s=0;s<n.length;s++){let o=n[s],d=It.instance.get(o.identifier),$={identifier:d.identifier,name:d.name,type:"",blob:null,url:null,thumbnail:{type:"",blob:null,url:null}};d.state===Ni.URL?$.url=d.url:o.state===Ni.NULL?($.thumbnail.blob=d.thumbnail.blob,$.thumbnail.type=d.thumbnail.type):($.blob=d.blob,$.type=d.blob.type);let I=$.blob?$.blob.size:$.thumbnail.blob?$.thumbnail.blob.size:100;if(i.push($),r+=I,e<r)break}return i}hasActiveTask(){return 0<this.sendTaskMap.size||0<this.receiveTaskMap.size}isLimitSendTask(){return this.maxSendTask<=this.sendTaskMap.size}isLimitReceiveTask(){return this.maxReceiveTask<=this.receiveTaskMap.size}existsSendTask(n){for(let e of this.sendTaskMap.values())if(e&&e.sendTo===n)return!0;return!1}}class ki{constructor(n){this.peerId=n,this.requestMap=new Map}static create(n,e){ki.tasksMap.size<1&&Fe.register(ki.key).on("DISCONNECT_PEER",r=>{ki.onDisconnect(r.data.peerId)}).on("UPDATE_GAME_OBJECT",r=>{r.isSendFromSelf||ki.onUpdate(r.data.identifier)}).on("DELETE_GAME_OBJECT",r=>{r.isSendFromSelf||ki.onUpdate(r.data.identifier)});let i=new ki(n);return i.initialize(e),i}cancel(){this.timeoutTimer&&this.timeoutTimer.clear(),this.timeoutTimer=null,this.onsynchronize=this.onfinish=this.ontimeout=null;for(let n of this.requestMap.values())this.deleteTasksMap(n.identifier);this.requestMap.clear()}initialize(n){for(let e of n){e.ttl--,this.requestMap.set(e.identifier,e);let i=ki.tasksMap.get(e.identifier);null==i&&(i=[]),i.push(this),ki.tasksMap.set(e.identifier,i);let r=null!=this.peerId&&e.holderIds.includes(this.peerId)?this.peerId:null;Fe.call("REQUEST_GAME_OBJECT",e.identifier,r)}this.requestMap.size<1?setTimeout(()=>this.finish()):this.resetTimeout()}finish(){this.onfinish&&this.onfinish(this),this.cancel()}timeout(){this.ontimeout&&this.ontimeout(this,Array.from(this.requestMap.values()).filter(n=>0<=n.ttl)),this.finish()}static onDisconnect(n){for(let e of ki.tasksMap.values())for(let i of e.concat())i.peerId===n&&i.timeout();ki.tasksMap.size<1&&Fe.unregister(ki.key)}static onUpdate(n){if(!ki.tasksMap.has(n))return;let e=ki.tasksMap.get(n);for(let i of e.concat())i.onUpdate(n);ki.tasksMap.size<1&&Fe.unregister(ki.key)}onUpdate(n){this.requestMap.delete(n),this.onsynchronize&&this.onsynchronize(this,n),this.requestMap.size<1?this.finish():this.resetTimeout()}deleteTasksMap(n){let e=ki.tasksMap.get(n),i=e.indexOf(this);-1<i&&e.splice(i,1),e.length<1&&ki.tasksMap.delete(n)}resetTimeout(){null==this.timeoutTimer&&(this.timeoutTimer=new ia(()=>this.timeout(),3e4)),this.timeoutTimer.reset()}}ki.key={},ki.tasksMap=new Map;class _u{constructor(){this.requestMap=new Map,this.peerMap=new Map,this.tasks=[]}static get instance(){return _u._instance||(_u._instance=new _u),_u._instance}initialize(){this.destroy(),console.log("ObjectSynchronizer ready..."),Fe.register(this).on("CONNECT_PEER",2,n=>{!n.isSendFromSelf||(console.log("CONNECT_PEER GameRoomService !!!",n.data.peerId),this.sendCatalog(n.data.peerId))}).on("DISCONNECT_PEER",n=>{this.removePeerMap(n.data.peerId)}).on("SYNCHRONIZE_GAME_OBJECT",n=>{if(n.isSendFromSelf)return;console.log("SYNCHRONIZE_GAME_OBJECT "+n.sendFrom);let e=n.data;for(let i of e)rt.instance.isDeleted(i.identifier)?Fe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:i.identifier},n.sendFrom):this.addRequestMap(i,n.sendFrom);this.synchronize()}).on("REQUEST_GAME_OBJECT",n=>{if(!n.isSendFromSelf)if(rt.instance.isDeleted(n.data))Fe.call("DELETE_GAME_OBJECT",{aliasName:"",identifier:n.data},n.sendFrom);else{let e=rt.instance.get(n.data);e&&Fe.call("UPDATE_GAME_OBJECT",e.toContext(),n.sendFrom)}}).on("UPDATE_GAME_OBJECT",1e3,n=>{let e=n.data,i=rt.instance.get(e.identifier);i?n.isSendFromSelf||this.updateObject(i,e):rt.instance.isDeleted(e.identifier)?Fe.call("DELETE_GAME_OBJECT",{aliasName:e.aliasName,identifier:e.identifier},n.sendFrom):this.createObject(e)}).on("DELETE_GAME_OBJECT",1e3,n=>{rt.instance.delete(n.data.identifier,!1)})}destroy(){Fe.unregister(this)}updateObject(n,e){e.majorVersion+e.minorVersion>n.version&&n.apply(e)}createObject(n){let e=So.instance.create(n.aliasName,n.identifier);e?(rt.instance.add(e,!1),e.apply(n)):console.warn(n.aliasName+" is Unknown...?",n)}sendCatalog(n){let e=rt.instance.getCatalog(),i=setInterval(()=>{Fe.call("SYNCHRONIZE_GAME_OBJECT",e.splice(0,e.length<2048?e.length:2048),n),e.length<1&&clearInterval(i)})}addRequestMap(n,e){let i=this.requestMap.get(n.identifier);i&&i.version===n.version?(i.holderIds.push(e),this.addPeerMap(e)):(!i||i.version<n.version)&&(this.requestMap.set(n.identifier,{identifier:n.identifier,version:n.version,holderIds:[e],ttl:2}),this.addPeerMap(e))}addPeerMap(n){this.peerMap.has(n)||this.peerMap.set(n,[])}removePeerMap(n){this.peerMap.delete(n)}synchronize(){for(;0<this.requestMap.size&&this.tasks.length<32;)this.runSynchronizeTask()}runSynchronizeTask(){let n=this.getTargetPeerId(),e=this.makeRequestList(n);if(e.length<1)return void this.removePeerMap(n);let i=ki.create(n,e);this.tasks.push(i);let r=this.peerMap.get(n);r&&r.push(i),i.onfinish=s=>{this.tasks.splice(this.tasks.indexOf(s),1);let o=this.peerMap.get(n);o&&o.splice(o.indexOf(s),1),this.synchronize()},i.ontimeout=(s,o)=>{console.log("GameObject synchronize \u30bf\u30a4\u30e0\u30a2\u30a6\u30c8"),o.forEach(d=>this.requestMap.set(d.identifier,d))}}makeRequestList(n,e=32){let i=[];for(let[r,s]of this.requestMap){if(e<=i.length)break;if(!s.holderIds.includes(n))continue;let o=rt.instance.get(s.identifier);(!o||o.version<s.version)&&i.push(s),this.requestMap.delete(r)}return i}getTargetPeerId(){let n=9999,e=null,i=vt.peerContexts;for(let r=i.length-1;0<=r;r--){let s=Math.floor(Math.random()*(r+1));[i[r],i[s]]=[i[s],i[r]]}for(let r of i){let s=this.peerMap.get(r.peerId);r.isOpen&&s&&s.length<n&&(n=s.length,e=r.peerId)}return e}}let Gl=class extends La{constructor(){super(...arguments),this.audioIdentifier="",this.startTime=0,this.isLoop=!1,this.isPlaying=!1,this.audioPlayer=new kt}get audio(){return Ft.instance.get(this.audioIdentifier)}onStoreAdded(){super.onStoreAdded(),this.unlockAfterUserInteraction()}onStoreRemoved(){super.onStoreRemoved(),this._stop()}play(n,e=!1){let i=Ft.instance.get(n);!i||!i.isReady||(this.audioIdentifier=n,this.isPlaying=!0,this.isLoop=e,this._play())}_play(){this._stop(),this.audio&&this.audio.isReady?(this.audioPlayer.loop=!0,this.audioPlayer.play(this.audio)):this.playAfterFileUpdate()}stop(){this.audioIdentifier="",this.isPlaying=!1,this._stop()}_stop(){this.unregisterEvent(),this.audioPlayer.stop()}playAfterFileUpdate(){Fe.register(this).on("UPDATE_AUDIO_RESOURE",n=>{this._play()})}unlockAfterUserInteraction(){let n=()=>{document.body.removeEventListener("touchstart",n,!0),document.body.removeEventListener("mousedown",n,!0),this.audioPlayer.stop(),this.isPlaying&&this._play()};document.body.addEventListener("touchstart",n,!0),document.body.addEventListener("mousedown",n,!0)}unregisterEvent(){Fe.unregister(this,"UPDATE_AUDIO_RESOURE")}apply(n){let e=this.audioIdentifier,i=this.isPlaying;super.apply(n),e===this.audioIdentifier&&i||!this.isPlaying?i!==this.isPlaying&&!this.isPlaying&&this._stop():this._play()}};function zq(t,n){if(1&t&&(X(0,"option",6),be(1),te()),2&t){const e=n.$implicit;it("value",e.identifier),W(1),Ze(e.name)}}function jq(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",7)(2,"div"),be(3," \u30bf\u30d6"),X(4,"sup",8),be(5,"*"),te(),be(6,"\uff1a "),X(7,"label")(8,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().isAllTabs=r}),te(),be(9,"\u9078\u629e\u3057\u305f\u30bf\u30d6"),te(),X(10,"label")(11,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().isAllTabs=r}),te(),be(12,"\u5168\u3066\u306e\u30bf\u30d6"),te()(),X(13,"div"),be(14," \u5f62\u5f0f"),X(15,"sup",8),be(16,"*"),te(),be(17,"\uff1a "),X(18,"label")(19,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().logFormat=r}),te(),be(20,"\u30c6\u30ad\u30b9\u30c8"),te(),X(21,"label")(22,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().logFormat=r}),te(),be(23,"HTML"),te()(),X(24,"div"),be(25," \u6642\u523b"),X(26,"sup",8),be(27,"*"),te(),be(28,"\uff1a "),X(29,"label")(30,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().dateFormat=r}),te(),be(31,"\u306a\u3057"),te(),X(32,"label")(33,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().dateFormat=r}),te(),be(34,"\u6642\uff1a\u5206"),te(),X(35,"label")(36,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().dateFormat=r}),te(),be(37,"\u65e5\u4ed8\u6642\u523b"),te()()(),nt(38,"hr"),X(39,"div",10)(40,"div")(41,"label",11)(42,"input",12),Ie("ngModelChange",function(r){return ke(e),ge().isWriteOerationLog=r}),te(),be(43,"\u64cd\u4f5c\u30ed\u30b0\u3092\u542b\u3081\u308b"),X(44,"sup",8),be(45,"*"),te()()(),X(46,"div",13)(47,"button",14),Ie("click",function(){return ke(e),ge().saveLog()}),be(48,"\u30ed\u30b0\u51fa\u529b"),te()()(),qe()}if(2&t){const e=ge();W(8),sr("name","",e.panelId,"-log-output-tab"),re("ngModel",e.isAllTabs)("checked",!e.isAllTabs)("value",!1),W(3),sr("name","",e.panelId,"-log-output-tab"),re("ngModel",e.isAllTabs)("checked",e.isAllTabs)("value",!0),W(8),sr("name","",e.panelId,"-log-output-format"),re("ngModel",e.logFormat)("checked",0==e.logFormat)("value",0),W(3),sr("name","",e.panelId,"-log-output-format"),re("ngModel",e.logFormat)("checked",1==e.logFormat)("value",1),W(8),sr("name","",e.panelId,"-log-output-timestamp-type"),re("ngModel",e.dateFormat)("checked",""==e.dateFormat)("value",""),W(3),sr("name","",e.panelId,"-log-output-timestamp-type"),re("ngModel",e.dateFormat)("checked","HH:mm"==e.dateFormat)("value","HH:mm"),W(3),sr("name","",e.panelId,"-log-output-timestamp-type"),re("ngModel",e.dateFormat)("checked","yyyy/MM/dd HH:mm"==e.dateFormat)("value","yyyy/MM/dd HH:mm"),W(6),it("checked",e.isWriteOerationLog?"checked":""),re("ngModel",e.isWriteOerationLog),W(5),re("disabled",e.isDiable)}}function Uq(t,n){1&t&&(Ge(0),X(1,"div",15),be(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002"),te(),qe())}B([st()],Gl.prototype,"audioIdentifier",void 0),B([st()],Gl.prototype,"startTime",void 0),B([st()],Gl.prototype,"isLoop",void 0),B([st()],Gl.prototype,"isPlaying",void 0),Gl=B([Kn("jukebox")],Gl);let FI=(()=>{class t{constructor(e,i,r,s){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=s,this.selectedTab=null}get isAllTabs(){return t.isAllTabs}set isAllTabs(e){t.isAllTabs=e}get logFormat(){return t.logFormat}set logFormat(e){t.logFormat=e}get dateFormat(){return t.dateFormat}set dateFormat(e){t.dateFormat=e}get isWriteOerationLog(){return t.isWriteOerationLog}set isWriteOerationLog(e){t.isWriteOerationLog=e}get tabName(){return this.selectedTab.name}set tabName(e){this.selectedTab.name=e}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==rt.instance.get(this.selectedTab.identifier)}get isDiable(){return this.isEmpty||!this.isAllTabs&&(!this.selectedTab||this.isDeleted)}get roomName(){return vt.peerContext&&0<vt.peerContext.roomName.length?vt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30ed\u30b0\u51fa\u529b",this.panelService.isAbleFullScreenButton=!1}),Fe.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{this.selectedTab&&e.data.identifier===this.selectedTab.identifier&&rt.instance.get(e.data.identifier)}),this.panelId=ms.generateUuid()}ngOnDestroy(){Fe.unregister(this)}onChangeSelectTab(e){this.selectedTab=rt.instance.get(e)}saveLog(){this.isDiable||this.saveDataService.saveChatLog(this.logFormat,this.roomName+"_chatLog_"+(this.isAllTabs?"\u5168\u3066\u306e\u30bf\u30d6":this.selectedTab.name),this.isAllTabs?null:this.selectedTab,this.dateFormat,this.isWriteOerationLog)}}return t.isAllTabs=!1,t.logFormat=1,t.dateFormat="HH:mm",t.isWriteOerationLog=!0,t.\u0275fac=function(e){return new(e||t)(Oe(kn),Oe(Tn),Oe(yr),Oe(Cr))},t.\u0275cmp=qt({type:t,selectors:[["app-chat-log-output"]],decls:7,vars:5,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],["size","10",2,"width","140px",3,"ngModel","disabled","change"],[3,"value",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],[1,"self-only"],["type","radio",3,"name","ngModel","checked","value","ngModelChange"],[2,"width","100%","display","flex"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px","padding-right","1em"],["type","checkbox",3,"ngModel","checked","ngModelChange"],[2,"flex-grow","1","text-align","right"],[2,"font-size","smaller",3,"disabled","click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"select",2),Ie("change",function(s){return i.onChangeSelectTab(s.target.value)}),xe(3,zq,2,2,"option",3),te()(),X(4,"div",4),xe(5,jq,49,31,"ng-container",5),te()(),xe(6,Uq,3,0,"ng-container",5)),2&e&&(W(2),re("ngModel",null==i.selectedTab?null:i.selectedTab.identifier)("disabled",i.isAllTabs),W(1),re("ngForOf",i.chatTabs),W(2),re("ngIf",!i.isEmpty),W(1),re("ngIf",i.isEmpty))},directives:[Zr,oi,ei,Jn,Rr,Or,gn,Sa,si,Yr],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}label[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]{margin-left:.5em}.self-only[_ngcontent-%COMP%]{color:red}.log-sample-text[_ngcontent-%COMP%], .log-sample-html[_ngcontent-%COMP%]{background-color:#fff;font-size:smaller;overflow-y:hidden;width:100%;min-height:1.6em}select[_ngcontent-%COMP%]:disabled   option[_ngcontent-%COMP%]{color:HighlightText;background-color:Highlight}"]}),t})();function Hq(t,n){if(1&t&&(X(0,"option",7),be(1),te()),2&t){const e=n.$implicit;Je("color",""==e.name?"gray":""),it("value",e.identifier),it("title",e.name),W(1),Ze(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name)}}function Vq(t,n){if(1&t&&(X(0,"div",20),be(1),te()),2&t){const e=ge(3);W(1),An("",e.progresPercent,"%")}}const Gq=function(t){return{"is-hidden":t}};function qq(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",12),Ie("click",function(){return ke(e),ge(2).upTabIndex()}),be(2,"\u2191"),te(),X(3,"button",12),Ie("click",function(){return ke(e),ge(2).downTabIndex()}),be(4,"\u2193"),te(),X(5,"div",13)(6,"button",12),Ie("click",function(){return ke(e),ge(2).showLogOutput()}),X(7,"i",14),be(8,"history_edu"),te(),be(9,"\u30ed\u30b0"),te(),X(10,"button",15),Ie("click",function(){return ke(e),ge(2).save()}),X(11,"div",16)(12,"div",17),be(13,"\u4fdd\u5b58"),te(),xe(14,Vq,2,1,"div",18),te()(),X(15,"button",19),Ie("click",function(){return ke(e),ge(2).delete()}),be(16,"\u524a\u9664"),te()(),qe()}if(2&t){const e=ge(2);W(10),re("disabled",e.isSaveing),W(2),re("ngClass",ct(4,Gq,e.isSaveing)),W(2),re("ngIf",e.isSaveing),W(1),Rt("disabled",e.chatTabs.length<=1?"":null)}}function Wq(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",12),Ie("click",function(){return ke(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),te(),qe()}}function Kq(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div")(2,"label")(3,"b",8),be(4,"\u30bf\u30d6\u540d: "),te(),X(5,"input",9),Ie("ngModelChange",function(r){return ke(e),ge().tabName=r}),te()()(),X(6,"div",10)(7,"label")(8,"input",11),Ie("ngModelChange",function(r){return ke(e),ge().isUseStandImage=r})("change",function(){ke(e);const r=ge();return r.isUseStandImage=!!r.isUseStandImage}),te(),be(9," \u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u30b9\u30bf\u30f3\u30c9\u6709\u52b9 "),te()(),X(10,"div",10)(11,"label")(12,"input",11),Ie("ngModelChange",function(r){return ke(e),ge().recieveOperationLogLevel=r})("change",function(){ke(e);const r=ge();return r.recieveOperationLogLevel=r.recieveOperationLogLevel>0?1:0}),te(),be(13," \u64cd\u4f5c\u30ed\u30b0\u3092\u53d7\u4fe1\u3059\u308b "),te()(),nt(14,"hr"),X(15,"div"),xe(16,qq,17,6,"ng-container",6),xe(17,Wq,3,0,"ng-container",6),te(),qe()}if(2&t){const e=ge();W(5),re("ngModel",e.tabName),Rt("disabled",e.isEditable?null:""),W(3),it("checked",e.isUseStandImage?"checked":""),re("ngModel",e.isUseStandImage),Rt("disabled",e.isEditable?null:""),W(4),it("checked",e.recieveOperationLogLevel>0?"checked":""),re("ngModel",e.recieveOperationLogLevel),Rt("disabled",e.isEditable?null:""),W(4),re("ngIf",!e.isDeleted),W(1),re("ngIf",e.isDeleted)}}function Yq(t,n){1&t&&(Ge(0),X(1,"div",21),be(2,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b\u300d\u304b\u3089\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),te(),qe())}let Zq=(()=>{class t{constructor(e,i,r,s,o){this.modalService=e,this.panelService=i,this.chatMessageService=r,this.saveDataService=s,this.pointerDeviceService=o,this.selectedTab=null,this.selectedTabXml="",this.isSaveing=!1,this.progresPercent=0}get tabName(){return this.selectedTab.name}set tabName(e){this.isEditable&&(this.selectedTab.name=e)}get isUseStandImage(){return this.selectedTab.isUseStandImage}set isUseStandImage(e){this.isEditable&&(this.selectedTab.isUseStandImage=e)}get recieveOperationLogLevel(){return this.selectedTab.recieveOperationLogLevel}set recieveOperationLogLevel(e){this.isEditable&&(this.selectedTab.recieveOperationLogLevel=e)}get chatTabs(){return this.chatMessageService.chatTabs}get isEmpty(){return this.chatMessageService.chatTabs.length<1}get isDeleted(){return!!this.selectedTab&&null==rt.instance.get(this.selectedTab.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get roomName(){return vt.peerContext&&0<vt.peerContext.roomName.length?vt.peerContext.roomName:"\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf"}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u8a2d\u5b9a",this.panelService.isAbleFullScreenButton=!1}),Fe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTab||e.data.identifier!==this.selectedTab.identifier)return;let i=rt.instance.get(e.data.identifier);null!==i&&(this.selectedTabXml=i.toXml())})}ngOnDestroy(){Fe.unregister(this)}onChangeSelectTab(e){this.selectedTab=rt.instance.get(e),this.selectedTabXml=""}create(){ao.instance.addChatTab("\u30bf\u30d6")}save(){var e=this;return(0,Yt.Z)(function*(){if(!e.selectedTab||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_chat_"+e.selectedTab.name;yield e.saveDataService.saveGameObjectAsync(e.selectedTab,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.isEmpty&&this.selectedTab&&(this.selectedTabXml=this.selectedTab.toXml(),this.selectedTab.destroy())}restore(){if(this.selectedTab&&this.selectedTabXml){let e=Gn.instance.parseXml(this.selectedTabXml);ao.instance.addChatTab(e),this.selectedTabXml=""}}upTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);0<i&&e.insertBefore(this.selectedTab,e.children[i-1])}downTabIndex(){if(!this.selectedTab)return;let e=this.selectedTab.parent,i=e.children.indexOf(this.selectedTab);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedTab)}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(FI,{left:e.x-250,top:e.y-175,width:450,height:300}).selectedTab=this.selectedTab}}return t.\u0275fac=function(e){return new(e||t)(Oe(kn),Oe(Tn),Oe(yr),Oe(Cr),Oe(li))},t.\u0275cmp=qt({type:t,selectors:[["app-chat-tab-setting"]],decls:10,vars:4,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","2px",3,"click"],["size","10",2,"width","100%","max-width","140px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],["placeholder","Name",2,"width","200px",3,"ngModel","ngModelChange"],[2,"font-weight","bolder","font-size","smaller","padding-top","3px"],["type","checkbox",3,"ngModel","checked","ngModelChange","change"],[3,"click"],[2,"float","right"],[1,"material-icons","small-font"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ie("click",function(){return i.create()}),be(4,"\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u4f5c\u308b"),te()(),X(5,"select",3),Ie("change",function(s){return i.onChangeSelectTab(s.target.value)}),xe(6,Hq,2,5,"option",4),te()(),X(7,"div",5),xe(8,Kq,18,10,"ng-container",6),te()(),xe(9,Yq,3,0,"ng-container",6)),2&e&&(W(5),re("ngModel",null==i.selectedTab?null:i.selectedTab.identifier),W(1),re("ngForOf",i.chatTabs),W(2),re("ngIf",!i.isEmpty&&i.selectedTab),W(1),re("ngIf",i.isEmpty))},directives:[Zr,oi,ei,Jn,Rr,Or,gn,si,Yr,jn],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.small-font[_ngcontent-%COMP%]{font-size:16px;vertical-align:middle}"]}),t})();const Xq=["edit"];function Qq(t,n){1&t&&$n(0)}function Jq(t,n){if(1&t&&(Ge(0),xe(1,Qq,1,0,"ng-container",11),qe()),2&t){ge();const e=Wt(11);W(1),re("ngTemplateOutlet",e)}}function eW(t,n){1&t&&$n(0)}function tW(t,n){if(1&t&&(Ge(0),xe(1,eW,1,0,"ng-container",11),qe()),2&t){ge();const e=Wt(13);W(1),re("ngTemplateOutlet",e)}}function nW(t,n){1&t&&$n(0)}function iW(t,n){1&t&&$n(0)}function rW(t,n){if(1&t&&(X(0,"div"),xe(1,iW,1,0,"ng-container",11),te()),2&t){ge();const e=Wt(19);W(1),re("ngTemplateOutlet",e)}}function sW(t,n){1&t&&$n(0)}function oW(t,n){if(1&t&&(Ge(0),xe(1,sW,1,0,"ng-container",11),qe()),2&t){ge();const e=Wt(13);W(1),re("ngTemplateOutlet",e)}}function aW(t,n){1&t&&$n(0)}function lW(t,n){if(1&t&&(Ge(0),xe(1,aW,1,0,"ng-container",11),qe()),2&t){ge();const e=Wt(11);W(1),re("ngTemplateOutlet",e)}}const cW=function(t,n){return{"black-paint":t,"face-icon":n}};function uW(t,n){if(1&t&&(nt(0,"img",15),bt(1,"safe")),2&t){const e=ge(2);re("src",yt(1,2,null==e.imageFile?null:e.imageFile.url,"resourceUrl"),Xt)("ngClass",cn(5,cW,1==e.chatMessage.isBlackPaint,e.chatMessage.isFaceIcon))}}const dW=function(t,n){return{inverse:t,hollow:n}},fW=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}};function hW(t,n){if(1&t&&(X(0,"div",12)(1,"span",13),xe(2,uW,2,8,"img",14),te()()),2&t){const e=ge();re("ngClass",cn(3,dW,1==e.chatMessage.isInverseIcon,1==e.chatMessage.isHollowIcon)),W(1),re("ngClass",vo(6,fW,0==e.chatMessage.aura,1==e.chatMessage.aura,2==e.chatMessage.aura,3==e.chatMessage.aura,4==e.chatMessage.aura,5==e.chatMessage.aura,6==e.chatMessage.aura,7==e.chatMessage.aura)),W(1),re("ngIf",0<(null==e.imageFile||null==e.imageFile.url?null:e.imageFile.url.length))}}function pW(t,n){if(1&t&&(Ge(0),X(1,"span",19),be(2),bt(3,"date"),te(),qe()),2&t){const e=ge(2);W(2),Ze(yt(3,1,e.chatMessage.timestamp,"H:mm"))}}function gW(t,n){if(1&t&&(nt(0,"img",22),bt(1,"safe")),2&t){const e=ge(3);re("src",yt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),Xt)}}const f1=function(t){return{grow:t}};function mW(t,n){if(1&t&&(Ge(0),xe(1,gW,2,4,"img",20),X(2,"span",18),be(3),te(),X(4,"span",21),be(5,"\u27a1"),te(),qe()),2&t){const e=ge(2);W(1),re("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),W(1),Je("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),re("ngClass",ct(5,f1,e.chatMessage.isDirect||e.chatMessage.isSecret)),W(1),Ze(e.chatMessage.toName)}}function _W(t,n){if(1&t&&(nt(0,"img",22),bt(1,"safe")),2&t){const e=ge(3);re("src",yt(1,1,null==e.toImageFile?null:e.toImageFile.url,"resourceUrl"),Xt)}}function $W(t,n){if(1&t&&(Ge(0),X(1,"span",23),be(2,"\u27a1"),te(),xe(3,_W,2,4,"img",20),X(4,"span",18),be(5),te(),qe()),2&t){const e=ge(2);W(3),re("ngIf",0<(null==e.toImageFile||null==e.toImageFile.url?null:e.toImageFile.url.length)),W(1),Je("color",e.chatMessage.toColor&&"#ffffff"!=e.chatMessage.toColor?e.chatMessage.toColor:""),re("ngClass",ct(5,f1,e.chatMessage.isDirect||e.chatMessage.isSecret)),W(1),Ze(e.chatMessage.toName)}}function vW(t,n){if(1&t){const e=Ye();X(0,"span",27),Ie("click",function(r){return ke(e),ge(3).onLinkClick(r)}),bt(1,"safe"),te()}2&t&&re("innerHTML",yt(1,1,ge(3).htmlEscapedFrom,"html"),Ui)}function bW(t,n){if(1&t&&(X(0,"span",19),be(1),bt(2,"date"),te()),2&t){const e=ge(3);W(1),Ze(yt(2,1,e.chatMessage.timestamp,"y/M/d H:mm"))}}function yW(t,n){if(1&t&&(X(0,"span",19),be(1),bt(2,"date"),te()),2&t){const e=ge(3);W(1),Ze(yt(2,1,e.chatMessage.timestamp,"H:mm"))}}function CW(t,n){1&t&&$n(0)}function xW(t,n){if(1&t&&(Ge(0),xe(1,vW,2,4,"span",24),xe(2,bW,3,4,"span",25),xe(3,yW,3,4,"span",25),xe(4,CW,1,0,"ng-container",26),qe()),2&t){const e=ge(2),i=Wt(19);W(1),re("ngIf",!e.isCompact),W(1),re("ngIf",!e.isCompact&&e.chatMessage.timestamp),W(1),re("ngIf",e.isCompact&&e.chatMessage.timestamp),W(1),re("ngIf",!(e.isEditable&&!e.isCompact))("ngIfElse",i)}}function wW(t,n){if(1&t&&(X(0,"div",16),xe(1,pW,4,4,"ng-container",2),X(2,"span",17),xe(3,mW,6,7,"ng-container",2),X(4,"span",18),be(5),te(),xe(6,$W,6,7,"ng-container",2),te(),xe(7,xW,5,5,"ng-container",2),te()),2&t){const e=ge();W(1),re("ngIf",e.isCompact&&!e.isMine&&e.chatMessage.timestamp),W(2),re("ngIf",!e.isMine&&e.chatMessage.toColor),W(1),Je("color",e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),re("ngClass",ct(8,f1,e.chatMessage.isDirect||e.chatMessage.isSecret)),W(1),Ze(e.chatMessage.name),W(1),re("ngIf",e.isMine&&e.chatMessage.toColor),W(1),re("ngIf",!e.isCompact||e.isMine)}}function EW(t,n){if(1&t){const e=Ye();X(0,"div",33)(1,"span",34),be(2),te(),X(3,"textarea",35,36),Ie("ngModelChange",function(r){return ke(e),ge(2).editingText=r})("keydown.enter",function(r){return ke(e),ge(2).editEnd(r)})("keydown.escape",function(){return ke(e),ge(2).editCancel()}),te()()}if(2&t){const e=ge(2);W(2),Ze(e.lastNewLineAdjust(e.editingText)),W(1),re("ngModel",e.editingText)}}function TW(t,n){if(1&t&&(X(0,"span",37)(1,"b",38),be(2,"\u7de8\u96c6\u6e08"),te(),be(3),bt(4,"date"),te()),2&t){const e=ge(2);W(3),An(" ",yt(4,1,e.chatMessage.lastUpdate,"M/d H:mm"),"")}}function IW(t,n){if(1&t){const e=Ye();X(0,"button",39),Ie("click",function(){return ke(e),ge(2).discloseMessage()}),be(1,"\u7d50\u679c\u3092\u516c\u958b"),te()}}function SW(t,n){if(1&t){const e=Ye();xe(0,EW,5,2,"div",28),X(1,"div")(2,"span",29)(3,"span",30),Ie("click",function(r){return ke(e),ge().onLinkClick(r)}),bt(4,"safe"),te(),xe(5,TW,5,4,"span",31),xe(6,IW,2,0,"button",32),te()()}if(2&t){const e=ge();re("ngIf",e.isEditing),W(1),Je("display",e.isEditing?"none":"block"),W(2),Je("color",!e.chatMessage.isSpecialColor&&e.chatMessage.color&&"#ffffff"!=e.chatMessage.color?e.chatMessage.color:""),re("innerHTML",yt(4,8,e.htmlEscapedText,"html"),Ui),W(2),re("ngIf",!e.isEditing&&e.chatMessage.isEdited),W(1),re("ngIf",e.chatMessage.isSecret)}}function kW(t,n){1&t&&(X(0,"span")(1,"s"),be(2,"\uff08\u30b7\u30fc\u30af\u30ec\u30c3\u30c8\u30c0\u30a4\u30b9\uff09"),te()())}function MW(t,n){if(1&t){const e=Ye();X(0,"button",45),Ie("click",function(){return ke(e),ge(2).editStart()}),X(1,"i",46),be(2,"edit"),te()()}}function DW(t,n){1&t&&(X(0,"button",47)(1,"i",46),be(2,"clear"),te()())}function AW(t,n){if(1&t){const e=Ye();X(0,"button",48),Ie("click",function(){return ke(e),ge(2).editEnd()}),X(1,"i",46),be(2,"done"),te()()}2&t&&re("disabled",0==ge(2).editingText.trim().length)}function PW(t,n){if(1&t){const e=Ye();X(0,"button",49),Ie("click",function(){return ke(e),ge(2).editCancel()}),X(1,"i",46),be(2,"clear"),te()()}}function NW(t,n){if(1&t&&(X(0,"span",40),xe(1,MW,3,0,"button",41),xe(2,DW,3,0,"button",42),xe(3,AW,3,1,"button",43),xe(4,PW,3,0,"button",44),te()),2&t){const e=ge();Je("visibility",e.isEditing?"visible":""),W(1),re("ngIf",!e.isEditing),W(1),re("ngIf",!e.isEditing),W(1),re("ngIf",e.isEditing),W(1),re("ngIf",e.isEditing)}}const FW=function(t,n){return{compact:t,editing:n}},RW=function(t,n,e,i,r,s){return{"is-mine":t,"is-others":n,"direct-message":e,"system-message":i,"dicebot-message":r,"operation-log":s}},OW=function(t,n,e,i){return{"is-success":t,"is-failure":n,"is-critical":e,"is-fumble":i}};let BW=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.modalService=i,this.changeDetector=r,this.compact=!1,this.imageFile=Lt.Empty,this.animeState="inactive",this.isEditing=!1,this.editingText="",this.stringUtil=et}ngOnInit(){Fe.register(this).on("MESSAGE_EDITING_START",-1e3,r=>{r.isSendFromSelf&&(!r.data||r.data.messageIdentifier!==this.chatMessage.identifier)&&this.editCancel()}).on("CHANGE_GM_MODE",r=>{this.changeDetector.markForCheck()});let e=this.chatMessage.image;e&&(this.imageFile=e),e=this.chatMessage.toImage,e&&(this.toImageFile=e),this.chatMessageService.getTime()-1e4<this.chatMessage.timestamp&&(this.animeState="active")}ngAfterViewInit(){this.chatMessage.isAnimated=!0}get isMine(){return this.chatMessage.isSendFromSelf}get isEditable(){return this.chatMessage.isEditable}get isCompact(){return this.compact||this.chatMessage.isOperationLog}get htmlEscapedFrom(){return this._htmlEscapeLinking(this.chatMessage.from,!0)}get htmlEscapedText(){let e=this._htmlEscapeLinking(this.chatMessage.text,!1,!this.chatMessage.isOperationLog);return this.chatMessage.isDicebot&&(e=Hn.decorationDiceResult(e)),e}_htmlEscapeLinking(e,i=!1,r=!1){return e=et.escapeHtml(e),r&&(e=et.rubyToHtml(e)),G0.link(this.lastNewLineAdjust(e),{urls:{schemeMatches:!0,wwwMatches:!0,tldMatches:!1},truncate:{length:48,location:"end"},decodePercentEncoding:i,stripPrefix:i,stripTrailingSlash:i,email:!1,phone:!1,replaceFn:function(s){if("url"==s.getType()&&et.validUrl(s.getAnchorHref())){if(et.sameOrigin(s.getAnchorHref()))return!0;{const o=s.buildTag();return o.setAttr("rel","nofollow"),o.addClass("outer-link"),o}}return!1}})}discloseMessage(){this.chatMessage.tag=this.chatMessage.tag.replace("secret","")}editStart(){Fe.trigger("MESSAGE_EDITING_START",{messageIdentifier:this.chatMessage.identifier}),this.editingText=this.chatMessage.text,this.isEditing=!0,setTimeout(()=>{this.editElm.nativeElement&&this.editElm.nativeElement.focus()})}editEnd(e=null){e&&e.preventDefault(),(!e||13===e.keyCode)&&(this.isEditable&&this.editingText.trim().length>0&&this.chatMessage.text!=this.editingText?(this.chatMessage.isSecret||(this.chatMessage.lastUpdate=Date.now()),this.chatMessage.text=this.editingText,this.isEditing=!1):this.editCancel())}editCancel(){this.isEditing=!1}lastNewLineAdjust(e){return null==e?"":!this.isEditing&&(this.chatMessage.isEdited||this.chatMessage.isSecret)||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}onLinkClick(e){if(e&&"A"==e.target.tagName){const i=e.target.getAttribute("href");if(!et.sameOrigin(i))return e.preventDefault(),this.modalService.open(Qr,{url:e.target.getAttribute("href")}),!1}return!0}}return t.\u0275fac=function(e){return new(e||t)(Oe(yr),Oe(kn),Oe(Di))},t.\u0275cmp=qt({type:t,selectors:[["chat-message"]],viewQuery:function(e,i){if(1&e&&dn(Xq,5),2&e){let r;un(r=fn())&&(i.editElm=r.first)}},inputs:{chatMessage:"chatMessage",compact:"compact"},features:[ii([{provide:Ex,useValue:!1}])],decls:20,vars:36,consts:[[1,"container",3,"ngClass"],[1,"message",3,"ngClass"],[4,"ngIf"],[1,"body"],[1,"text","msg-text",3,"ngClass"],[4,"ngIf","ngIfThen","ngIfElse"],["image",""],["title",""],["visible",""],["secret",""],["editor",""],[4,"ngTemplateOutlet"],[1,"image",3,"ngClass"],[1,"aura",3,"ngClass"],["draggable","false",3,"src","ngClass",4,"ngIf"],["draggable","false",3,"src","ngClass"],[1,"title"],[1,"msg-name"],[3,"ngClass"],[1,"tip","msg-timestamp"],["draggable","false","class","mini-icon",3,"src",4,"ngIf"],[2,"display","inline-block","margin","0px 6px","user-select","none","transform","rotateY(180deg)"],["draggable","false",1,"mini-icon",3,"src"],[2,"display","inline-block","margin","0px 6px","user-select","none"],["class","tip msg-from",3,"innerHTML","click",4,"ngIf"],["class","tip msg-timestamp",4,"ngIf"],[4,"ngIf","ngIfElse"],[1,"tip","msg-from",3,"innerHTML","click"],["style","position: relative",4,"ngIf"],[2,"display","inline-block"],[3,"innerHTML","click"],["class","is-edited",4,"ngIf"],["style","padding-top: 1px; padding-bottom: 1px; margin-left: 3px;",3,"click",4,"ngIf"],[2,"position","relative"],["aria-hidden","true",2,"visibility","hidden","display","inline-block"],[2,"position","absolute","top","0px","left","0px","width","100%","height","100%",3,"ngModel","ngModelChange","keydown.enter","keydown.escape"],["edit",""],[1,"is-edited"],[2,"white-space","nowrap"],[2,"padding-top","1px","padding-bottom","1px","margin-left","3px",3,"click"],[1,"edit-buttons",2,"margin-left","4px","white-space","nowrap"],["class","edit-button","title","\u7de8\u96c6",3,"click",4,"ngIf"],["class","edit-button","aria-hidden","true","style","visibility: hidden",4,"ngIf"],["class","edit-button","title","\u78ba\u5b9a",3,"disabled","click",4,"ngIf"],["class","edit-button","title","\u30ad\u30e3\u30f3\u30bb\u30eb",3,"click",4,"ngIf"],["title","\u7de8\u96c6",1,"edit-button",3,"click"],[1,"material-icons","small-font"],["aria-hidden","true",1,"edit-button",2,"visibility","hidden"],["title","\u78ba\u5b9a",1,"edit-button",3,"disabled","click"],["title","\u30ad\u30e3\u30f3\u30bb\u30eb",1,"edit-button",3,"click"]],template:function(e,i){if(1&e&&(X(0,"div",0)(1,"div",1),xe(2,Jq,2,1,"ng-container",2),X(3,"div",3),xe(4,tW,2,1,"ng-container",2),X(5,"div",4),xe(6,nW,1,0,"ng-container",5),te(),xe(7,rW,2,1,"div",2),xe(8,oW,2,1,"ng-container",2),te(),xe(9,lW,2,1,"ng-container",2),te()(),xe(10,hW,3,15,"ng-template",null,6,On),xe(12,wW,8,10,"ng-template",null,7,On),xe(14,SW,7,11,"ng-template",null,8,On),xe(16,kW,3,0,"ng-template",null,9,On),xe(18,NW,5,6,"ng-template",null,10,On)),2&e){const r=Wt(15),s=Wt(17);re("ngClass",cn(21,FW,i.isCompact,i.isEditing)),W(1),Je("border-left-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444")("border-right-color",!i.chatMessage.isSystem||i.chatMessage.isDicebot||i.chatMessage.isCalculate?i.chatMessage.color:"#444444"),re("ngClass",y_(24,RW,i.isMine,!i.isMine,i.chatMessage.isDirect||i.chatMessage.isSecret,i.chatMessage.isSystem,i.chatMessage.isDicebot||i.chatMessage.isCalculate,i.chatMessage.isOperationLog))("@flyInOut",i.isMine?null:"active")("@flyInOutMe",i.isMine?"active":null),W(1),re("ngIf",i.isMine&&!i.isCompact),W(1),Je("justify-content",i.isCompact&&!i.isMine?"flex-end":"flex-start"),W(1),re("ngIf",!i.isCompact||i.isMine),W(1),Je("flex-grow",i.isCompact&&!i.isEditing?0:1),re("ngClass",Js(31,OW,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isSuccess,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFailure,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isCritical,(!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf)&&i.chatMessage.isFumble)),W(1),re("ngIf",!i.chatMessage.isSecret||i.chatMessage.isSendFromSelf||i.chatMessage.isGMMode)("ngIfThen",r)("ngIfElse",s),W(1),re("ngIf",i.isEditable&&i.isCompact),W(1),re("ngIf",i.isCompact&&!i.isMine),W(1),re("ngIf",!i.isMine&&!i.isCompact)}},directives:[jn,gn,_l,si,oi,ei],pipes:[Yn,nx],styles:['[_nghost-%COMP%]{display:block}.container[_ngcontent-%COMP%]{width:100%;overflow-x:hidden;box-sizing:border-box}.message[_ngcontent-%COMP%]{display:flex;flex-flow:row nowrap;box-sizing:border-box;padding:5px;width:100%;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;border-bottom:1px dotted #999}.is-mine.message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.message[_ngcontent-%COMP%]{border-right:4px solid #555}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc;border-bottom:1px dotted #CCC}.is-mine.direct-message[_ngcontent-%COMP%]{border-left:4px solid #555}.is-others.direct-message[_ngcontent-%COMP%]{border-right:4px solid #555}.operation-log[_ngcontent-%COMP%]{color:#666;background-color:#cccc}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{padding:0;width:50px;height:50px;flex-shrink:0;vertical-align:top;pointer-events:none}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.message[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img.face-icon[_ngcontent-%COMP%]{border-radius:.5rem}.message[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{flex-grow:1}.message[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{vertical-align:top;font-size:14px;padding-left:12px;padding-right:12px}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.message[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{vertical-align:top;padding:2px 12px 0;font-size:14px}.message[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{font-size:8px;padding-left:12px}.msg-name[_ngcontent-%COMP%]{font-weight:700}.msg-text[_ngcontent-%COMP%]{white-space:pre-wrap}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{font-size:8px}.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#11f}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{color:#ccf}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#17f}.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f05}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-success[_ngcontent-%COMP%]{color:#adf}.direct-message.dicebot-message[_ngcontent-%COMP%]   .msg-text.is-failure[_ngcontent-%COMP%]{color:#f66}.dicebot-message[_ngcontent-%COMP%]{border-left:4px transparent}.dicebot-message[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .dicebot-message[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%], .operation-log[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{font-style:oblique}.is-others[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{text-align:right}.is-others[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-align:left;max-width:100%}.is-edited[_ngcontent-%COMP%]{margin-left:2px;font-size:8px;vertical-align:bottom}.is-edited[_ngcontent-%COMP%]:before{content:"("}.is-edited[_ngcontent-%COMP%]:after{content:")"}.edit-button[_ngcontent-%COMP%]{padding:0 6px;vertical-align:10%;margin:0 1px 0 0}.edit-buttons[_ngcontent-%COMP%]{visibility:hidden}.container[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%]{visibility:visible}textarea[_ngcontent-%COMP%]{font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Verdana,Meiryo,"M+ 1p",sans-serif;margin:-3px;font-size:14px;resize:none}.small-font[_ngcontent-%COMP%]{font-size:14px;vertical-align:bottom}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 6px #ccc) drop-shadow(0 -4px 4px #fff)}.msg-timestamp[_ngcontent-%COMP%]{white-space:nowrap}.container.compact[_ngcontent-%COMP%]{overflow:hidden}.container.compact.editing[_ngcontent-%COMP%]{padding-top:1px}.container.compact[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{padding:2px!important}.container.compact[_ngcontent-%COMP%]   .body[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:nowrap}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{min-width:6em}.container.compact[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%], .container.compact[_ngcontent-%COMP%]   .tip[_ngcontent-%COMP%]{padding:0 3px;text-align:left}.container.compact[_ngcontent-%COMP%]   .msg-name[_ngcontent-%COMP%]{flex-grow:0}.container.compact[_ngcontent-%COMP%]   .msg-text[_ngcontent-%COMP%]{flex-grow:1}.container.compact[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:none}.container.compact[_ngcontent-%COMP%]:hover   .edit-buttons[_ngcontent-%COMP%], .container.compact.editing[_ngcontent-%COMP%]   .edit-buttons[_ngcontent-%COMP%]{display:inline-block}.container.compact[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{margin:-3px}.grow[_ngcontent-%COMP%]{text-shadow:1px 0px 1px #ffffff,0px 1px 1px #ffffff,-1px 0px 1px #ffffff,0px -1px 1px #ffffff}.mini-icon[_ngcontent-%COMP%]{display:inline-block;padding:0;width:1rem;height:1rem;vertical-align:middle;border-radius:.2rem;-o-object-fit:cover;object-fit:cover;margin-right:2px;filter:drop-shadow(1px 1px 1px #ffffff) drop-shadow(-1px -1px 1px #ffffff)}'],data:{animation:[yn("flyInOut",[Nt("* => active",[Dt("200ms ease-out",Qt([We({transform:"translateX(100px)",opacity:"0",offset:0}),We({transform:"translateX(0)",opacity:"1",offset:1})]))]),Nt("void => *",[Dt("200ms ease-out",Qt([We({opacity:"0",offset:0}),We({opacity:"1",offset:1})]))])]),yn("flyInOutMe",[Nt("* => active",[Dt("200ms ease-out",Qt([We({transform:"translateX(-100px)",opacity:"0",offset:0}),We({transform:"translateX(0)",opacity:"1",offset:1})]))]),Nt("void => *",[Dt("200ms ease-out",Qt([We({opacity:"0",offset:0}),We({opacity:"1",offset:1})]))])])]}}),t})();const LW=["logContainer"],zW=["messageContainer"];function jW(t,n){if(1&t&&nt(0,"chat-message",7),2&t){const e=ge().$implicit,i=ge(2);re("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function UW(t,n){if(1&t&&(Ge(0),xe(1,jW,1,3,"chat-message",6),qe()),2&t){const e=n.$implicit;W(1),re("ngIf",e.isDisplayable)}}function HW(t,n){if(1&t&&(Ge(0),xe(1,UW,2,1,"ng-container",5),qe()),2&t){const e=ge();W(1),re("ngForOf",e.chatMessages)("ngForTrackBy",e.trackByChatMessage)}}function VW(t,n){if(1&t&&nt(0,"chat-message",7),2&t){const e=n.$implicit,i=ge(2);re("chatMessage",e)("compact",i.compact)("@.disabled",i.compact||e.isAnimated)}}function GW(t,n){if(1&t&&(Ge(0),xe(1,VW,1,3,"chat-message",8),qe()),2&t){const e=ge();W(1),re("ngForOf",e.sampleMessages)}}const h1=window.navigator.userAgent.toLowerCase(),RI=h1.indexOf("iphone")>-1||h1.indexOf("ipad")>-1||h1.indexOf("macintosh")>-1&&"ontouchend"in document;let qW=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.changeDetector=i,this.panelService=r,this.compact=!1,this.sampleMessages=[{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30b5\u30fc\u30d0\u30fc\u3092\u4f7f\u7528\u3057\u306a\u3044TRPG\u30aa\u30f3\u30bb\u30c4\u30fc\u30eb\u3067\u3059\u3002\u53c2\u52a0\u8005\u540c\u58eb\u3067\u63a5\u7d9a\u3057\u3001\u30b3\u30de\u3084\u753b\u50cf\u30d5\u30a1\u30a4\u30eb\u306a\u3069\u3092\u540c\u671f\u3057\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u5168\u3066\u306e\u30c7\u30fc\u30bf\u304c\u5404\u53c2\u52a0\u8005\u306e\u30d6\u30e9\u30a6\u30b6\u5185\u306b\u3042\u308b\u305f\u3081\u3001\u30eb\u30fc\u30e0\u306e\u72b6\u614b\u3092\u6b21\u56de\u306b\u6301\u3061\u8d8a\u3057\u305f\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u300c\u4fdd\u5b58\u300d\u3092\u5b9f\u884c\u3057\u3066\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u3092\u751f\u6210\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u4fdd\u5b58\u3057\u305fzip\u306e\u8aad\u307f\u8fbc\u307f\u306f\u30d6\u30e9\u30a6\u30b6\u753b\u9762\u3078\u306e\u30d5\u30a1\u30a4\u30eb\u30c9\u30ed\u30c3\u30d7\u3067\u884c\u3048\u307e\u3059\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\uff08\u79d8\u5bc6\u4f1a\u8a71\uff09\u306f\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\u306b\u8a18\u9332\u3055\u308c\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",toColor:"#444444",tag:"mine direct",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",toName:"\u30d7\u30ec\u30a4\u30e4\u30fc",text:"\u307e\u305f\u3001\u904e\u53bb\u306e\u30c0\u30a4\u30ec\u30af\u30c8\u30e1\u30c3\u30bb\u30fc\u30b8\u306f\u3042\u306a\u305f\u306eID\u304c\u66f4\u65b0\u3055\u308c\u308b\u3068\u540c\u3058\u30eb\u30fc\u30e0\u5185\u3067\u3042\u3063\u3066\u3082\u898b\u3048\u306a\u304f\u306a\u308a\u307e\u3059\u3002\u6ce8\u610f\u3057\u3066\u304f\u3060\u3055\u3044\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u52d5\u4f5c\u63a8\u5968\u74b0\u5883\u306f\u30c7\u30b9\u30af\u30c8\u30c3\u30d7Chrome\u3067\u3059\u3002\u4eca\u306e\u3068\u3053\u308d\u3001\u30b9\u30de\u30db\u304b\u3089\u3060\u3068\u4e0a\u624b\u304f\u64cd\u4f5c\u3067\u304d\u307e\u305b\u3093\u3002"},{from:"System",timestamp:0,imageIdentifier:"",color:"#444444",tag:"mine",name:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",text:"\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u4ee5\u4e0a\u3067\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u6700\u521d\u306e\u30c1\u30e3\u30c3\u30c8\u3092\u5165\u529b\u3059\u308b\u3068\u975e\u8868\u793a\u306b\u306a\u308a\u307e\u3059\u3002"}],this.topTimestamp=0,this.botomTimestamp=0,this.needUpdate=!0,this.topElm=null,this.bottomElm=null,this.topElmBox=null,this.bottomElmBox=null,this.topIndex=0,this.bottomIndex=0,this.preScrollTop=0,this.scrollSpeed=0,this._chatMessages=[],this.scrollEventShortTimer=null,this.scrollEventLongTimer=null,this.addMessageEventTimer=null,this.callbackOnScroll=()=>this.onScroll(),this.callbackOnScrollToBottom=()=>this.resetMessages(),this.onAddMessage=new vn}get minMessageHeight(){if(this.compact)return 26;let e=this.chatTab.chatMessages[this.chatTab.chatMessages.length-1];return e&&e.isOperationLog?26:61}get chatMessages(){if(!this.chatTab)return[];if(this.needUpdate){this.needUpdate=!1;let e=this.chatTab?this.chatTab.chatMessages:[];this.adjustIndex(),this._chatMessages=e.slice(this.topIndex,this.bottomIndex+1),this.topTimestamp=0<this._chatMessages.length?this._chatMessages[0].timestamp:0,this.botomTimestamp=0<this._chatMessages.length?this._chatMessages[this._chatMessages.length-1].timestamp:0}return this._chatMessages}get minScrollHeight(){return this.chatTab.chatMessages.reduce((i,r)=>i+(r.isDisplayable?this.compact||r.isOperationLog?26:61:0),0)}get topSpace(){return this.minScrollHeight-this.bottomSpace}get bottomSpace(){return 0<this.chatMessages.length?(this.chatTab.chatMessages.length-this.bottomIndex-1)*this.minMessageHeight:0}get isEmpty(){return this.chatTab.chatMessages.every(e=>!e.isDisplayable)}ngOnInit(){let e=[];for(let i of this.sampleMessages){let r=new Hn;for(let s in i)if("identifier"!==s&&"tabIdentifier"!==s){if("text"===s){r.value=i[s];continue}null==i[s]||""===i[s]||r.setAttribute(s,i[s])}e.push(r)}this.sampleMessages=e,Fe.register(this).on("MESSAGE_ADDED",i=>{let r=rt.instance.get(i.data.messageIdentifier);!r||!this.chatTab.contains(r)||this.topTimestamp<=r.timestamp&&(this.changeDetector.markForCheck(),this.needUpdate=!0,this.onMessageInit())}).on("UPDATE_GAME_OBJECT",i=>{let r=rt.instance.get(i.data.identifier);r&&r instanceof Hn&&this.topTimestamp<=r.timestamp&&r.timestamp<=this.botomTimestamp&&this.chatTab.contains(r)&&this.changeDetector.markForCheck()})}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.scrollEventShortTimer=new ia(()=>this.lazyScrollUpdate(),33),this.scrollEventLongTimer=new ia(()=>this.lazyScrollUpdate(!1),66),this.onScroll(),this.panelService.scrollablePanel.addEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.addEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1)})}ngOnDestroy(){Fe.unregister(this),this.panelService.scrollablePanel.removeEventListener("scroll",this.callbackOnScroll,!1),this.panelService.scrollablePanel.removeEventListener("scrolltobottom",this.callbackOnScrollToBottom,!1),this.scrollEventShortTimer.clear(),this.scrollEventLongTimer.clear(),this.addMessageEventTimer&&clearTimeout(this.addMessageEventTimer),this.addMessageEventTimer=null}ngOnChanges(){Promise.resolve().then(()=>this.resetMessages())}ngAfterViewChecked(){!this.topElm||!this.bottomElm||this.ngZone.runOutsideAngular(()=>{Promise.resolve().then(()=>this.adjustScrollPosition())})}onMessageInit(){null==this.addMessageEventTimer&&this.ngZone.runOutsideAngular(()=>{this.addMessageEventTimer=setTimeout(()=>{this.addMessageEventTimer=null,this.ngZone.run(()=>this.onAddMessage.emit())},0)})}resetMessages(){let e=this.chatTab.chatMessages.length-1;this.topIndex=e-Math.floor(this.panelService.scrollablePanel.clientHeight/this.minMessageHeight),this.bottomIndex=e,this.needUpdate=!0,this.preScrollTop=-1,this.scrollSpeed=0,this.topElm=this.bottomElm=null,this.adjustIndex(),this.changeDetector.markForCheck()}trackByChatMessage(e,i){return i.identifier}adjustIndex(){let e=this.chatTab?this.chatTab.chatMessages:[],i=0<e.length?e.length-1:0;this.topIndex<0&&(this.topIndex=0),i<this.bottomIndex&&(this.bottomIndex=i),this.topIndex<0&&(this.topIndex=0),this.bottomIndex<0&&(this.bottomIndex=0),i<this.topIndex&&(this.topIndex=i),i<this.bottomIndex&&(this.bottomIndex=i)}getScrollPosition(){let e=this.panelService.scrollablePanel.scrollTop,i=this.panelService.scrollablePanel.clientHeight,r=this.panelService.scrollablePanel.scrollHeight;return e<0&&(e=0),r-i<e&&(e=r-i),{top:e,bottom:e+i,clientHeight:i,scrollHeight:r}}adjustScrollPosition(){if(!this.topElm||!this.bottomElm)return;let e=this.logContainerRef.nativeElement.contains(this.topElm),i=this.logContainerRef.nativeElement.contains(this.bottomElm),{hasTopBlank:r,hasBotomBlank:s}=this.checkBlank(e,i);this.topElm=this.bottomElm=null,(r||s||!e&&!i)&&vr(()=>this.lazyScrollUpdate())}checkBlank(e,i){let r=!e,s=!i;if(!e&&!i)return{hasTopBlank:r,hasBotomBlank:s};let o=null,d=null,$=null,I=0;i?(o=this.bottomElm,d=this.bottomElmBox):e&&(o=this.topElm,d=this.topElmBox),$=o.getBoundingClientRect(),I=d.top-$.top-this.scrollSpeed,(!r||!s)&&.25<I**2&&(this.panelService.scrollablePanel.scrollTop-=I);let Q=this.logContainerRef.nativeElement.getBoundingClientRect(),fe=this.messageContainerRef.nativeElement.getBoundingClientRect(),_e=fe.top-Q.top,Ce=_e+fe.height,Ee=this.getScrollPosition();return r=Ee.top<_e,s=Ce<Ee.bottom&&Ee.bottom<Ee.scrollHeight,{hasTopBlank:r,hasBotomBlank:s}}markForReadIfNeeded(){if(!this.chatTab.hasUnread)return;let e=this.getScrollPosition();e.scrollHeight<=e.bottom+100&&vr(()=>{this.chatTab.markForRead(),this.changeDetector.markForCheck(),this.ngZone.run(()=>{})})}onScroll(){this.scrollEventShortTimer.reset(),this.scrollEventLongTimer.isActive||this.scrollEventLongTimer.reset()}lazyScrollUpdate(e=!0){this.scrollEventShortTimer.stop(),this.scrollEventLongTimer.stop();let i=this.messageContainerRef.nativeElement.querySelectorAll("chat-message"),r=this.messageContainerRef.nativeElement.offsetTop,s=r+this.messageContainerRef.nativeElement.clientHeight,o=this.topIndex,d=this.bottomIndex,$=this.getScrollPosition();this.scrollSpeed=$.top-this.preScrollTop,this.preScrollTop=$.top;let I=$.top<r,Q=s<$.bottom&&$.bottom<$.scrollHeight;if(e||this.scrollEventShortTimer.reset(),!e&&!I&&!Q)return;let fe=$.top-(!e&&I?100:1200),_e=$.bottom+(!e&&Q?100:1200);this.markForReadIfNeeded(),this.calcItemIndexRange(r,s,fe,_e,$,i),(this.topIndex!=o||this.bottomIndex!=d)&&(this.needUpdate=!0,this.topElm=i[0],this.bottomElm=i[i.length-1],this.topElmBox=this.topElm.getBoundingClientRect(),this.bottomElmBox=this.bottomElm.getBoundingClientRect(),vr(()=>{let Ee=this.getScrollPosition();this.scrollSpeed=Ee.top-this.preScrollTop,this.preScrollTop=Ee.top,this.changeDetector.markForCheck(),this.ngZone.run(()=>{})}))}calcElementMaxHeight(e){let i=this.minMessageHeight;for(let r=e.length-1;0<=r;r--){let s=e[r].clientHeight;i<s&&(i=s)}return i}calcItemIndexRange(e,i,r,s,o,d){if(r>=i||e>=s)this.bottomIndex=this.chatTab.chatMessages.length-1-Math.floor((o.scrollHeight-o.top-o.clientHeight)/this.minMessageHeight),this.topIndex=this.bottomIndex-Math.floor(o.clientHeight/this.minMessageHeight),this.bottomIndex+=1,this.topIndex-=1;else{let $=this.calcElementMaxHeight(d);r<e?this.topIndex-=Math.floor((e-r)/$)+1:r>e&&(RI||(this.topIndex+=Math.floor((r-e)/$))),i>s?RI||(this.bottomIndex-=Math.floor((i-s)/$)):i<s&&(this.bottomIndex+=Math.floor((s-i)/$)+1)}this.adjustIndex()}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(Di),Oe(Tn))},t.\u0275cmp=qt({type:t,selectors:[["chat-tab"]],viewQuery:function(e,i){if(1&e&&(dn(LW,7),dn(zW,7)),2&e){let r;un(r=fn())&&(i.logContainerRef=r.first),un(r=fn())&&(i.messageContainerRef=r.first)}},inputs:{compact:"compact",chatTab:"chatTab"},outputs:{onAddMessage:"onAddMessage"},features:[Ws],decls:6,vars:6,consts:[[1,"log"],["logContainer",""],[1,"virtual-scroll-container"],["messageContainer",""],[4,"ngIf"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"chatMessage","compact",4,"ngIf"],[3,"chatMessage","compact"],[3,"chatMessage","compact",4,"ngFor","ngForOf"]],template:function(e,i){1&e&&(X(0,"div",0,1)(2,"div",2,3),xe(4,HW,2,2,"ng-container",4),xe(5,GW,2,1,"ng-container",4),te()()),2&e&&(Je("min-height",i.minScrollHeight,"px"),W(2),Je("margin-bottom",i.bottomSpace,"px"),W(2),re("ngIf",!i.isEmpty),W(1),re("ngIf",i.isEmpty))},directives:[gn,Jn,BW],styles:["[_nghost-%COMP%]{display:block}.log[_ngcontent-%COMP%]{position:relative;display:flex;flex-direction:column;justify-content:flex-end;align-items:flex-end;width:100%;height:100%}.virtual-scroll-container[_ngcontent-%COMP%]{flex-shrink:0;width:100%}"],changeDetection:0}),t})();const WW=["chatTabComponemt"];function KW(t,n){if(1&t){const e=Ye();X(0,"chat-tab",13,14),Ie("onAddMessage",function(){return ke(e),ge().scrollToBottom()}),te()}if(2&t){const e=ge();re("chatTab",e.chatTab)("compact",e.isCompact)}}function YW(t,n){1&t&&(X(0,"div"),be(1,"\u203b\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u306e\u5185\u5bb9\u304c\u66f4\u65b0\u3055\u308c\u307e\u3057\u305f\u3002\u30c1\u30e3\u30c3\u30c8\u30bf\u30d6\u3092\u9078\u629e\u3057\u306a\u304a\u3059\u304b\u3001\u3053\u306e\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u958b\u304d\u306a\u304a\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),te())}function ZW(t,n){1&t&&(X(0,"i",8),be(1,"how_to_reg"),te())}function XW(t,n){1&t&&(X(0,"i",8),be(1,"history_edu"),te())}function QW(t,n){1&t&&nt(0,"badge",19),2&t&&re("count",ge().$implicit.unreadLength)}function JW(t,n){if(1&t){const e=Ye();X(0,"label",15)(1,"input",16),Ie("ngModelChange",function(r){return ke(e),ge().chatTabidentifier=r}),te(),X(2,"div")(3,"span"),be(4),te(),xe(5,ZW,2,0,"i",17),xe(6,XW,2,0,"i",17),xe(7,QW,1,1,"badge",18),te()()}if(2&t){const e=n.$implicit,i=ge();W(1),it("value",e.identifier),re("ngModel",i.chatTabidentifier),W(2),Je("cursor",i.chatTabidentifier!=e.identifier?"pointer":"")("color",""==e.name&&i.chatTabidentifier!=e.identifier?"gray":""),W(1),Ze(""==e.name?"(\u7121\u540d\u306e\u30bf\u30d6)":e.name),W(1),re("ngIf",e.isUseStandImage),W(1),re("ngIf",e.recieveOperationLogLevel>0),W(1),re("ngIf",e.hasUnread)}}let OI=(()=>{class t{constructor(e,i,r){this.chatMessageService=e,this.panelService=i,this.pointerDeviceService=r,this.sendFrom="Guest",this._isCompact=!1,this._chatTabidentifier="",this.isAutoScroll=!0,this.scrollToBottomTimer=null}get isCompact(){return this._isCompact}set isCompact(e){this._isCompact=e,this.chatTabComponemt.onScroll()}get gameType(){return this.chatMessageService.gameType?this.chatMessageService.gameType:"DiceBot"}set gameType(e){this.chatMessageService.gameType=e}get chatTabidentifier(){return this._chatTabidentifier}set chatTabidentifier(e){let i=this._chatTabidentifier!==e;this._chatTabidentifier=e,this.updatePanelTitle(),i&&this.scrollToBottom(!0)}get chatTab(){return rt.instance.get(this.chatTabidentifier)}ngOnInit(){this.sendFrom=He.myCursor.identifier,this._chatTabidentifier=0<this.chatMessageService.chatTabs.length?this.chatMessageService.chatTabs[0].identifier:"",Fe.register(this).on("MESSAGE_ADDED",e=>{if(e.data.tabIdentifier!==this.chatTabidentifier)return;let i=rt.instance.get(e.data.messageIdentifier);i&&i.isSendFromSelf?this.isAutoScroll=!0:this.checkAutoScroll(),this.isAutoScroll&&this.chatTab&&this.chatTab.markForRead()}),Promise.resolve().then(()=>this.updatePanelTitle())}ngAfterViewInit(){queueMicrotask(()=>this.scrollToBottom(!0))}ngOnDestroy(){Fe.unregister(this)}scrollToBottom(e=!1){if(e&&(this.isAutoScroll=!0),!this.isAutoScroll)return;let i=new CustomEvent("scrolltobottom",{});this.panelService.scrollablePanel.dispatchEvent(i),null==this.scrollToBottomTimer&&(this.scrollToBottomTimer=setTimeout(()=>{this.chatTab&&this.chatTab.markForRead(),this.scrollToBottomTimer=null,this.isAutoScroll=!1,this.panelService.scrollablePanel&&(this.panelService.scrollablePanel.scrollTop=this.panelService.scrollablePanel.scrollHeight)},0))}checkAutoScroll(){this.panelService.scrollablePanel&&(this.isAutoScroll=this.panelService.scrollablePanel.scrollHeight-this.panelService.scrollablePanel.clientHeight-150<=this.panelService.scrollablePanel.scrollTop)}updatePanelTitle(){this.panelService.title=this.chatTab&&""!==this.chatTab.name?"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6 - "+this.chatTab.name:"\u30c1\u30e3\u30c3\u30c8\u30a6\u30a3\u30f3\u30c9\u30a6"}onSelectedTab(e){this.updatePanelTitle()}showTabSetting(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(Zq,{left:e.x-250,top:e.y-175,width:460,height:330}).selectedTab=this.chatTab}showLogOutput(){let e=this.pointerDeviceService.pointers[0];this.panelService.open(FI,{left:e.x-250,top:e.y-175,width:460,height:300}).selectedTab=this.chatTab}sendChat(e){this.chatTab&&this.chatMessageService.sendMessage(this.chatTab,e.text,e.gameType,e.sendFrom,e.sendTo,e.color,e.isInverse,e.isHollow,e.isBlackPaint,e.aura,e.isUseFaceIcon,e.characterIdentifier,e.standIdentifier,e.standName,e.isUseStandImage)}trackByChatTab(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(Oe(yr),Oe(Tn),Oe(li))},t.\u0275cmp=qt({type:t,selectors:[["chat-window"]],viewQuery:function(e,i){if(1&e&&dn(WW,5),2&e){let r;un(r=fn())&&(i.chatTabComponemt=r.first)}},decls:23,vars:10,consts:[[1,"component"],[1,"log"],[3,"chatTab","compact","onAddMessage",4,"ngIf"],[4,"ngIf"],[1,"sticky-bottom"],[1,"chat-tab"],["class","tab",4,"ngFor","ngForOf","ngForTrackBy"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[1,"small-font",2,"float","right","padding","1px 4px 1px 2px","margin-left","2px","height","24px","box-sizing","border-box"],["name","isCompact","type","checkbox",3,"ngModel","value","checked","ngModelChange"],[2,"color","red"],[3,"chatTabidentifier","gameType","sendFrom","gameTypeChange","sendFromChange","chat"],[3,"chatTab","compact","onAddMessage"],["chatTabComponemt",""],[1,"tab"],["name","chat-tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],["class","material-icons small-font",4,"ngIf"],["class","badge",3,"count",4,"ngIf"],[1,"badge",3,"count"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1),xe(2,KW,2,2,"chat-tab",2),xe(3,YW,2,0,"div",3),te(),X(4,"div",4)(5,"form")(6,"div",5),xe(7,JW,8,10,"label",6),X(8,"button",7),Ie("click",function(){return i.showTabSetting()}),X(9,"i",8),be(10,"settings"),te(),be(11,"\u30bf\u30d6\u8a2d\u5b9a"),te(),X(12,"button",7),Ie("click",function(){return i.showLogOutput()}),X(13,"i",8),be(14,"history_edu"),te(),be(15,"\u30ed\u30b0"),te(),X(16,"label",9)(17,"input",10),Ie("ngModelChange",function(s){return i.isCompact=s}),te(),X(18,"b"),be(19,"\u7c21\u6613\u8868\u793a"),X(20,"sup",11),be(21,"*"),te()()()()(),X(22,"chat-input",12),Ie("gameTypeChange",function(s){return i.gameType=s})("sendFromChange",function(s){return i.sendFrom=s})("chat",function(s){return i.sendChat(s)}),te()()()),2&e&&(W(2),re("ngIf",i.chatTab),W(1),re("ngIf",!i.chatTab),W(4),re("ngForOf",i.chatMessageService.chatTabs)("ngForTrackBy",i.trackByChatTab),W(10),re("ngModel",i.isCompact)("value",!0)("checked",i.isCompact),W(5),re("chatTabidentifier",i.chatTabidentifier)("gameType",i.gameType)("sendFrom",i.sendFrom))},directives:[gn,qW,bl,vl,Qo,Jn,Sa,si,oi,ei,kd,Yr,Ki],styles:["[_nghost-%COMP%]{display:block;height:100%}.loop-anime[_ngcontent-%COMP%]{-webkit-animation:anime1 1.3s infinite ease-in-out;animation:anime1 1.3s infinite ease-in-out}.component[_ngcontent-%COMP%]{min-height:100%;display:flex;flex-direction:column;justify-content:space-between;align-content:space-between}.sticky-bottom[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;bottom:0;width:100%;background-color:#f0dabdcc;border-top:1px dotted #666;margin-bottom:0}.chat-tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.chat-tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;position:relative}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{display:inline-block;vertical-align:middle;outline:0;font-size:12px;background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;margin:2px;border-radius:100px;cursor:pointer;height:1.6em}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.chat-tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.badge[_ngcontent-%COMP%]{position:absolute;top:-4px;right:0}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 4px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}label.compact[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.tab[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{vertical-align:top;font-size:.8rem}"]}),t})();const eK=["root"],tK=["altitudeSlider"];function nK(t,n){if(1&t){const e=Ye();X(0,"span",12),be(1," (\u9ad8\u5ea6 "),X(2,"input",13),Ie("ngModelChange",function(r){return ke(e),ge(2).altitudeHande.altitude=r}),te(),be(3,")"),te()}if(2&t){const e=ge(2);W(2),re("ngModel",e.altitudeHande.altitude)}}function iK(t,n){if(1&t&&(X(0,"div")(1,"div",10),be(2),xe(3,nK,4,1,"span",11),te()()),2&t){const e=ge();W(1),Je("color",e.titleColor)("font-weight",e.titleBold?"bolder":"normal"),W(1),Ze(e.title),W(1),re("ngIf",e.altitudeHande)}}function rK(t,n){1&t&&(X(0,"div",14)(1,"div",15),be(2,"\u9ad8"),te(),X(3,"div",16),be(4,"0"),te(),X(5,"div",17),be(6,"\u4f4e"),te()())}function sK(t,n){if(1&t){const e=Ye();X(0,"div",18)(1,"input",19,20),Ie("ngModelChange",function(r){return ke(e),ge().altitudeHande.altitude=r}),te()()}if(2&t){const e=ge();W(1),it("title",e.altitudeHande.altitude),re("ngModel",e.altitudeHande.altitude)}}function oK(t,n){1&t&&$n(0)}const aK=function(t){return{action:t}};function lK(t,n){if(1&t&&(Ge(0),xe(1,oK,1,0,"ng-container",21),qe()),2&t){const e=ge().$implicit;ge();const i=Wt(12),r=Wt(10);W(1),re("ngTemplateOutlet","separator"===(null==e?null:e.type)?i:r)("ngTemplateOutletContext",ct(2,aK,e))}}function cK(t,n){if(1&t&&(Ge(0),xe(1,lK,2,4,"ng-container",2),qe()),2&t){const e=n.$implicit;W(1),re("ngIf",e)}}function uK(t,n){1&t&&(X(0,"span",43),be(1,"\u26a0\ufe0f"),te()),2&t&&it("title",ge().action.error)}function dK(t,n){1&t&&nt(0,"input",44),2&t&&re("disabled",ge().action.disabled)}function fK(t,n){1&t&&nt(0,"input",45),2&t&&re("disabled",ge().action.disabled)}function hK(t,n){1&t&&nt(0,"input",46),2&t&&re("disabled",ge().action.disabled)}function pK(t,n){1&t&&nt(0,"input",47),2&t&&re("disabled",ge().action.disabled)}function gK(t,n){1&t&&(X(0,"span",48),be(1,"\u25a0"),te())}function mK(t,n){1&t&&(X(0,"span",49),be(1,"\u25a0"),te())}function _K(t,n){1&t&&(X(0,"span",50),be(1,"\u25a0"),te())}function $K(t,n){1&t&&(X(0,"span",51),be(1,"\u25a0"),te())}function vK(t,n){1&t&&(X(0,"span",52),be(1,"\u25a0"),te())}function bK(t,n){1&t&&(X(0,"span",53),be(1,"\u25a0"),te())}function yK(t,n){1&t&&(X(0,"span",54),be(1,"\u25a0"),te())}function CK(t,n){1&t&&(X(0,"span",55),be(1,"\u25a0"),te())}function xK(t,n){if(1&t&&(X(0,"span",56)(1,"i",57),be(2),te()()),2&t){const e=ge().action;W(2),Ze(e.materialIcon)}}function wK(t,n){1&t&&(X(0,"sup",58),be(1,"*"),te())}function EK(t,n){if(1&t&&(X(0,"span",59),nt(1,"img",60),bt(2,"safe"),te()),2&t){const e=ge().action;W(1),re("src",yt(2,1,e.icon.url,"resourceUrl"),Xt)}}function TK(t,n){1&t&&(X(0,"i",61),be(1,"open_in_new"),te())}function IK(t,n){1&t&&(X(0,"div",62)(1,"i",63),be(2,"arrow_forward_ios"),te()())}function SK(t,n){if(1&t&&nt(0,"context-menu",64),2&t){const e=ge().action,i=ge();re("title",e.name)("actions",i.subMenu)("isSubmenu",!0)}}const kK=function(t,n){return{hasHighlight:t,disabled:n}},MK=function(t,n){return{"icon-menu":t,default:n}};function DK(t,n){if(1&t){const e=Ye();X(0,"li",22),Ie("click",function(){const s=ke(e).action,o=ge();return!(s.disabled||s.altitudeHande&&0==s.altitudeHande.altitude)&&o.doAction(s)})("mouseenter",function(){const s=ke(e).action,o=ge();return!(s.disabled||s.altitudeHande&&0==s.altitudeHande.altitude)&&o.showSubMenu(s)}),X(1,"div",23),xe(2,uK,2,1,"span",24),xe(3,dK,1,1,"input",25),xe(4,fK,1,1,"input",26),xe(5,hK,1,1,"input",27),xe(6,pK,1,1,"input",28),xe(7,gK,2,0,"span",29),xe(8,mK,2,0,"span",30),xe(9,_K,2,0,"span",31),xe(10,$K,2,0,"span",32),xe(11,vK,2,0,"span",33),xe(12,bK,2,0,"span",34),xe(13,yK,2,0,"span",35),xe(14,CK,2,0,"span",36),xe(15,xK,3,1,"span",37),be(16),xe(17,wK,2,0,"sup",38),xe(18,EK,3,4,"span",39),xe(19,TK,2,0,"i",40),te(),xe(20,IK,3,0,"div",41),xe(21,SK,1,3,"context-menu",42),te()}if(2&t){const e=n.action,i=ge();Je("padding-left",e.icon?0:(e.level?e.level+1.5:1.5)-(i.altitudeHande?.5:0),"em")("color",e.color?e.color:"")("text-align",e.center?"center":""),re("ngClass",cn(28,kK,!(e.disabled||e.icon||e.altitudeHande&&0==e.altitudeHande.altitude),e.disabled||e.altitudeHande&&0==e.altitudeHande.altitude)),W(1),re("ngClass",cn(31,MK,e.icon,e.default)),W(1),re("ngIf",e.error),W(1),re("ngIf",e.name&&0==e.name.indexOf("\u2611")),W(1),re("ngIf",e.name&&0==e.name.indexOf("\u2610")),W(1),re("ngIf",e.name&&0==e.name.indexOf("\u25c9")),W(1),re("ngIf",e.name&&0==e.name.indexOf("\u25cb")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30d6\u30e9\u30c3\u30af")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30d6\u30eb\u30fc")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30b0\u30ea\u30fc\u30f3")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30b7\u30a2\u30f3")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30ec\u30c3\u30c9")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30de\u30bc\u30f3\u30bf")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30a4\u30a8\u30ed\u30fc")),W(1),re("ngIf",e.name&&2==e.name.indexOf("\u30db\u30ef\u30a4\u30c8")),W(1),re("ngIf",e.materialIcon),W(1),An(" ",e.name.replace("\u2611","").replace("\u2610","").replace("\u25c9","").replace("\u25cb",""),""),W(1),re("ngIf",e.selfOnly),W(1),re("ngIf",e.icon&&0<(null==e.icon?null:e.icon.url.length)),W(1),re("ngIf",e.isOuterLink),W(1),re("ngIf",e.subActions&&!e.disabled),W(1),re("ngIf",i.subMenu&&i.parentMenu===e)}}function AK(t,n){1&t&&(X(0,"li"),nt(1,"hr",65),te())}const PK=function(t,n,e,i){return{"icons-panel":t,"submenu-panel":n,"is-max-limit":e,"pointer-events-none":i}};let NK=(()=>{class t{constructor(e,i,r){this.elementRef=e,this.contextMenuService=i,this.pointerDeviceService=r,this.title="",this.actions=[],this.titleColor=He.CHAT_DEFAULT_COLOR,this.titleBold=!1,this.isSubmenu=!1,this.callbackOnOutsideClick=s=>this.onOutsideClick(s)}get isPointerDragging(){return this.pointerDeviceService.isDragging}get altitudeHande(){for(let e of this.actions)if(e&&e.altitudeHande)return e.altitudeHande;return null}get isIconsMenu(){for(let e of this.actions)if(!e||!e.icon)return!1;return!0}ngOnInit(){this.isSubmenu||(this.title=this.contextMenuService.title,this.actions=this.contextMenuService.actions,this.titleColor=this.contextMenuService.titleColor,this.titleBold=this.contextMenuService.titleBold)}ngAfterViewInit(){this.isSubmenu?this.adjustPositionSub():(this.adjustPositionRoot(),document.addEventListener("touchstart",this.callbackOnOutsideClick,!0),document.addEventListener("mousedown",this.callbackOnOutsideClick,!0))}ngOnDestroy(){document.removeEventListener("touchstart",this.callbackOnOutsideClick,!0),document.removeEventListener("mousedown",this.callbackOnOutsideClick,!0)}onOutsideClick(e){!1===this.rootElementRef.nativeElement.contains(e.target)&&this.close()}onContextMenu(e){e.stopPropagation(),e.preventDefault()}adjustPositionRoot(){let e=this.rootElementRef.nativeElement;e.style.left=this.contextMenuService.position.x+"px",e.style.top=this.contextMenuService.position.y+"px";let i=e.getBoundingClientRect(),r=0,s=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+s&&(s+=window.innerHeight-(i.bottom+s)),i.top+s<0&&(s+=0-(i.top+s)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+s+"px",this.altitudeSlider&&(this.altitudeSlider.nativeElement.style.height=e.clientHeight-72+"px")}adjustPositionSub(){let i=this.rootElementRef.nativeElement,r=this.elementRef.nativeElement.parentElement.getBoundingClientRect(),s=i.getBoundingClientRect(),o=0,d=0;window.innerWidth<s.right+o&&(o-=r.width+s.width,o+=8),s.left+o<0&&(o+=0-(s.left+o)),window.innerHeight<s.bottom+d&&(d+=window.innerHeight-(s.bottom+d)),s.top+d<0&&(d+=0-(s.top+d)),i.style.left=i.offsetLeft+o+"px",i.style.top=i.offsetTop+d+"px"}doAction(e){this.showSubMenu(e),null!=e.action&&(e.action(),this.close())}showSubMenu(e){this.hideSubMenu(),clearTimeout(this.showSubMenuTimer),!(null==e.subActions||e.subActions.length<1)&&(this.showSubMenuTimer=setTimeout(()=>{this.parentMenu=e,this.subMenu=e.subActions,clearTimeout(this.hideSubMenuTimer)},250))}hideSubMenu(){clearTimeout(this.hideSubMenuTimer),this.hideSubMenuTimer=setTimeout(()=>{this.subMenu=null},1200)}close(){this.contextMenuService&&this.contextMenuService.close()}}return t.\u0275fac=function(e){return new(e||t)(Oe(pi),Oe(lr),Oe(li))},t.\u0275cmp=qt({type:t,selectors:[["context-menu"]],viewQuery:function(e,i){if(1&e&&(dn(eK,7),dn(tK,5)),2&e){let r;un(r=fn())&&(i.rootElementRef=r.first),un(r=fn())&&(i.altitudeSlider=r.first)}},hostBindings:function(e,i){1&e&&Ie("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{title:"title",actions:"actions",titleColor:"titleColor",titleBold:"titleBold",isSubmenu:"isSubmenu"},decls:13,vars:10,consts:[[1,"component",2,"display","flex","flex-direction","column",3,"ngClass","mouseleave"],["root",""],[4,"ngIf"],[2,"display","flex","align-items","center"],["class","altitude ruler","style","display: flex; align-self: stretch; flex-direction: column; align-content: center",4,"ngIf"],["class","altitude",4,"ngIf"],[2,"flex-grow","1"],[4,"ngFor","ngForOf"],["actionMenu",""],["separator",""],[1,"title"],["style","font-size: small;",4,"ngIf"],[2,"font-size","small"],["type","number","step","0.1",2,"font-size","small","width","3.6em","text-align","right",3,"ngModel","ngModelChange"],[1,"altitude","ruler",2,"display","flex","align-self","stretch","flex-direction","column","align-content","center"],[2,"margin-top","2em"],[2,"align-self","center","margin-top","auto","margin-bottom","auto"],[2,"margin-bottom","2em"],[1,"altitude"],["type","range","max","12","min","-12","step","0.5","orient","vertical",1,"altitude",3,"title","ngModel","ngModelChange"],["altitudeSlider",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"ngClass","click","mouseenter"],[1,"menu-title",3,"ngClass"],[3,"title",4,"ngIf"],["type","checkbox","checked","",3,"disabled",4,"ngIf"],["type","checkbox",3,"disabled",4,"ngIf"],["type","radio","checked","",3,"disabled",4,"ngIf"],["type","radio",3,"disabled",4,"ngIf"],["class","color-indicator","style","color: #000",4,"ngIf"],["class","color-indicator","style","color: #00f",4,"ngIf"],["class","color-indicator","style","color: #0f0",4,"ngIf"],["class","color-indicator","style","color: #0ff",4,"ngIf"],["class","color-indicator","style","color: #f00",4,"ngIf"],["class","color-indicator","style","color: #f0f",4,"ngIf"],["class","color-indicator","style","color: #ff0",4,"ngIf"],["class","color-indicator","style","color: #fff",4,"ngIf"],["style","vertical-align: top",4,"ngIf"],["class","self-only",4,"ngIf"],["class","imagebox",4,"ngIf"],["class","material-icons","style","font-size: 1rem",4,"ngIf"],["class","sub-menu-arrow",4,"ngIf"],[3,"title","actions","isSubmenu",4,"ngIf"],[3,"title"],["type","checkbox","checked","",3,"disabled"],["type","checkbox",3,"disabled"],["type","radio","checked","",3,"disabled"],["type","radio",3,"disabled"],[1,"color-indicator",2,"color","#000"],[1,"color-indicator",2,"color","#00f"],[1,"color-indicator",2,"color","#0f0"],[1,"color-indicator",2,"color","#0ff"],[1,"color-indicator",2,"color","#f00"],[1,"color-indicator",2,"color","#f0f"],[1,"color-indicator",2,"color","#ff0"],[1,"color-indicator",2,"color","#fff"],[2,"vertical-align","top"],[1,"material-icons",2,"font-size","150%","padding-left","2px"],[1,"self-only"],[1,"imagebox"],[1,"image",3,"src"],[1,"material-icons",2,"font-size","1rem"],[1,"sub-menu-arrow"],[1,"material-icons",2,"font-size","1em","vertical-align","bottom"],[3,"title","actions","isSubmenu"],[1,"separator"]],template:function(e,i){1&e&&(X(0,"div",0,1),Ie("mouseleave",function(){return i.hideSubMenu()}),xe(2,iK,4,6,"div",2),X(3,"div",3),xe(4,rK,7,0,"div",4),xe(5,sK,3,2,"div",5),X(6,"div",6)(7,"ul"),xe(8,cK,2,1,"ng-container",7),te()()()(),xe(9,DK,22,34,"ng-template",null,8,On),xe(11,AK,2,0,"ng-template",null,9,On)),2&e&&(re("ngClass",Js(5,PK,i.isIconsMenu,i.isSubmenu,!i.isSubmenu,i.isPointerDragging)),W(2),re("ngIf",!i.isIconsMenu&&0<i.title.length||i.altitudeHande),W(2),re("ngIf",i.altitudeHande),W(1),re("ngIf",i.altitudeHande),W(3),re("ngForOf",i.actions))},directives:[jn,gn,ds,si,oi,ei,fs,Jn,_l,t],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;white-space:nowrap;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;z-index:2000000}.submenu-panel[_ngcontent-%COMP%]{position:absolute;left:calc(100% - 4px);top:-16px}.icons-panel[_ngcontent-%COMP%]{padding-bottom:2px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{width:54px;padding:1px}.icons-panel[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{padding:1px 0}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-max-limit[_ngcontent-%COMP%]{max-height:100%;max-width:100%}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em;font-size:12px;text-align:center;padding:4px 16px;margin:0 2px;color:#444;border-bottom:1px solid #AAA}.menu-title[_ngcontent-%COMP%]{display:inline-block}hr.separator[_ngcontent-%COMP%]{margin:.1em -12px;height:1px;border:0;background-color:#aaa}.sub-menu-arrow[_ngcontent-%COMP%]{display:inline-block;position:absolute;top:2px;bottom:0;right:1px}ul[_ngcontent-%COMP%]{list-style:none;padding:2px 0;margin:0}ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{position:relative;cursor:-moz-default;cursor:-webkit-default;cursor:default;padding:2px 20px;font-size:12px;color:#444}ul[_ngcontent-%COMP%] > li.hasHighlight[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}.menu-title[_ngcontent-%COMP%]:not(.icon-menu){overflow:hidden;max-width:16.5em;text-overflow:ellipsis}td.altitude[_ngcontent-%COMP%]{vertical-align:middle}input.altitude[_ngcontent-%COMP%]{writing-mode:bt-lr;-webkit-appearance:slider-vertical;-moz-appearance:slider-vertical;appearance:slider-vertical;width:8px;height:100%;padding:3px}.disabled[_ngcontent-%COMP%]   .menu-title[_ngcontent-%COMP%], .disabled[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{color:gray}.altitude-view[_ngcontent-%COMP%]{color:#000;vertical-align:top;width:3em;text-align:right}.ruler[_ngcontent-%COMP%]{color:#444;font-size:small;padding-left:4px;padding-right:2px}.default[_ngcontent-%COMP%]{font-weight:bolder}.imagebox[_ngcontent-%COMP%]{display:inline-block;width:50px;height:50px;max-width:50px;max-height:50px;vertical-align:top;margin-left:auto;margin-right:auto;text-align:center}.image[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:middle;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.5rem}.icon-menu[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.icon-menu[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid transparent;z-index:400}.icon-menu[_ngcontent-%COMP%]:hover   img[_ngcontent-%COMP%]{border:2px dotted rgba(255,0,0,40);z-index:600}.icon-menu.default[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:2px solid red;z-index:500}.color-indicator[_ngcontent-%COMP%]{font-size:larger;text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff;margin-right:-.2rem}.self-only[_ngcontent-%COMP%]{color:red}"]}),t})(),FK=(()=>{class t{constructor(e,i,r){this.viewContainerRef=e,this.modalService=i,this.panelService=r,this.name="\u30b2\u30fc\u30e0\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",this.size=1,this.xml="",this.minSize=1,this.maxSize=20,this.tableBackgroundImage=Lt.createEmpty("null")}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b8\u30a7\u30cd\u30ec\u30fc\u30bf\u30fc"),Fe.register(this).on("SELECT_FILE",e=>{console.log("SELECT_FILE GameCharacterGeneratorComponent "+e.data.fileIdentifier);let r=It.instance.get(e.data.fileIdentifier);r&&(this.tableBackgroundImage=r)})}ngAfterViewInit(){}ngOnDestroy(){Fe.unregister(this)}createGameCharacter(){jt.create(this.name,this.size,this.tableBackgroundImage.identifier)}createGameTableMask(){let e=ir.instance.viewTable;if(!e)return;let i=Jr.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);e.appendChild(i)}createGameCharacterForXML(e){Gn.instance.parseXml(e)}openModal(){this.modalService.open(Po)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Pr),Oe(kn),Oe(Tn))},t.\u0275cmp=qt({type:t,selectors:[["game-character-generator"]],decls:15,vars:12,consts:[[3,"click"],["height","120",3,"src"],["placeholder","Name","name","name",3,"ngModel","ngModelChange"],["type","range","name","size",3,"ngModel","title","min","max","ngModelChange"],["type","number",3,"ngModel","min","max","ngModelChange"]],template:function(e,i){1&e&&(X(0,"button",0),Ie("click",function(){return i.openModal()}),be(1,"\u753b\u50cf\u3092\u9078\u3076"),te(),X(2,"div"),nt(3,"img",1),bt(4,"safe"),te(),X(5,"input",2),Ie("ngModelChange",function(s){return i.name=s}),te(),X(6,"div")(7,"div")(8,"input",3),Ie("ngModelChange",function(s){return i.size=s}),te(),be(9," Size : "),X(10,"input",4),Ie("ngModelChange",function(s){return i.size=s}),te()(),X(11,"button",0),Ie("click",function(){return i.createGameCharacter()}),be(12,"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u308b"),te(),X(13,"button",0),Ie("click",function(){return i.createGameTableMask()}),be(14,"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u308b"),te()()),2&e&&(W(3),re("src",yt(4,9,i.tableBackgroundImage.url,"resourceUrl"),Xt),W(2),re("ngModel",i.name),W(3),it("title",i.size),it("min",i.minSize),it("max",i.maxSize),re("ngModel",i.size),W(2),it("min",i.minSize),it("max",i.maxSize),re("ngModel",i.size))},directives:[si,oi,ei,fs,ds,Co,yo],pipes:[Yn],styles:[""]}),t})();function RK(t,n){1&t&&$n(0)}function OK(t,n){1&t&&$n(0)}function BK(t,n){if(1&t&&(X(0,"div"),be(1),te()),2&t){const e=ge();W(1),An("",e.getTabTitle(e.selectTab),"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306f\u7a7a\u3067\u3059")}}function LK(t,n){if(1&t&&(X(0,"div",12),be(1),te()),2&t){const e=ge().$implicit;Je("background-color",e.ownerColor),W(1),Ze(e.ownerName?e.ownerName:"\uff08\u7121\u540d\u306e\u30d7\u30ec\u30a4\u30e4\u30fc\uff09")}}function zK(t,n){1&t&&$n(0)}const jK=function(t,n,e){return{box:!0,selected:t,"is-hide-in":n,"is-inventory-no-indicate":e}},UK=function(t){return{gameObject:t}};function HK(t,n){if(1&t){const e=Ye();X(0,"div",9),Ie("contextmenu",function(r){const o=ke(e).$implicit;return ge().onContextMenu(r,o)})("click",function(){const s=ke(e).$implicit;return ge().selectGameObject(s)})("dblclick",function(r){const o=ke(e).$implicit;return ge().focusGameObject(o,r)}),xe(1,LK,2,3,"div",10),xe(2,zK,1,0,"ng-container",11),te()}if(2&t){const e=n.$implicit,i=ge(),r=Wt(11);re("ngClass",qr(4,jK,i.selectedIdentifier===e.identifier,e.isHideIn,!e.isInventoryIndicate)),W(1),re("ngIf",e.isHideIn&&null!=e.ownerName),W(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",ct(8,UK,e))}}function VK(t,n){if(1&t){const e=Ye();X(0,"div",13)(1,"button",14),Ie("click",function(){return ke(e),ge().cleanInventory()}),be(2,"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b"),te()()}if(2&t){const e=ge();W(1),Rt("disabled",e.getGameObjects(e.selectTab).length<1?"":null)}}function GK(t,n){if(1&t){const e=Ye();X(0,"label")(1,"input",18),Ie("ngModelChange",function(r){return ke(e),ge(2).selectTab=r}),te(),X(2,"div"),be(3),te()()}if(2&t){const e=n.$implicit,i=ge(2);W(1),it("value",e),re("ngModel",i.selectTab),W(2),Ca("",i.getTabTitle(e)," (",i.getGameObjects(e).length,")")}}function qK(t,n){if(1&t&&(X(0,"form",15)(1,"div",16),xe(2,GK,4,4,"label",17),te()()),2&t){const e=ge();W(2),re("ngForOf",e.inventoryTypes)}}function WK(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div")(2,"div",19)(3,"b"),be(4,"\u4e26\u3073\u9806: "),te()(),X(5,"input",20),Ie("ngModelChange",function(r){return ke(e),ge(2).sortTag=r}),te(),X(6,"select",21),Ie("ngModelChange",function(r){return ke(e),ge(2).sortOrder=r}),X(7,"option",22),be(8,"\u6607\u9806"),te(),X(9,"option",23),be(10,"\u964d\u9806"),te()()(),X(11,"div",24)(12,"b"),be(13,"\u8868\u793a\u9805\u76ee: "),te()(),X(14,"input",25),Ie("ngModelChange",function(r){return ke(e),ge(2).dataTag=r}),te(),X(15,"div",13)(16,"button",26),Ie("click",function(){return ke(e),ge(2).toggleEdit()}),X(17,"i",27),be(18,"settings"),te(),be(19,"\u5b8c\u4e86"),te()(),qe()}if(2&t){const e=ge(2);W(5),re("ngModel",e.sortTag),W(1),re("ngModel",e.sortOrder),W(8),re("ngModel",e.dataTag)}}function KK(t,n){if(1&t&&(Ge(0),X(1,"span"),be(2),te(),qe()),2&t){const e=ge(3);W(2),Ca("",e.sortTag," (",e.sortOrderName,")")}}function YK(t,n){1&t&&(Ge(0),be(1,"-"),qe())}function ZK(t,n){if(1&t){const e=Ye();X(0,"label",32)(1,"input",33),Ie("ngModelChange",function(r){return ke(e),ge(3).indicateAll=r}),te(),X(2,"b"),be(3,"\u3059\u3079\u3066\u8868\u793a"),X(4,"sup",34),be(5,"*"),te()()()}if(2&t){const e=ge(3);W(1),re("ngModel",e.indicateAll)}}function XK(t,n){if(1&t){const e=Ye();Ge(0),X(1,"table",28)(2,"tr")(3,"th",29),be(4,"\u4e26\u3073\u9806:"),te(),X(5,"td",29),xe(6,KK,3,2,"ng-container",2),xe(7,YK,2,0,"ng-container",2),te(),X(8,"td",30)(9,"button",26),Ie("click",function(){return ke(e),ge(2).toggleEdit()}),X(10,"i",27),be(11,"settings"),te(),be(12,"\u8a2d\u5b9a"),te(),xe(13,ZK,6,1,"label",31),te()()(),qe()}if(2&t){const e=ge(2);W(6),re("ngIf",0<e.sortTag.length),W(1),re("ngIf",e.sortTag.length<1),W(6),re("ngIf","table"===e.selectTab)}}function QK(t,n){if(1&t&&(xe(0,WK,20,3,"ng-container",2),xe(1,XK,14,3,"ng-container",2)),2&t){const e=ge();re("ngIf",e.isEdit),W(1),re("ngIf",!e.isEdit)}}function JK(t,n){if(1&t&&(X(0,"i",56),nt(1,"img",57),bt(2,"safe"),te()),2&t){const e=ge().gameObject;W(1),re("src",yt(2,1,e.faceIcon.url,"resourceUrl"),Xt)}}function eY(t,n){1&t&&(X(0,"i",42),be(1,"emoji_emotions"),te())}const tY=function(t){return{opacity:t}};function nY(t,n){if(1&t&&(X(0,"i",56),nt(1,"img",58),bt(2,"safe"),te()),2&t){const e=ge().gameObject;W(1),re("ngStyle",ct(5,tY,e.isDropShadow?.7:.3))("src",yt(2,2,e.shadowImageFile.url,"resourceUrl"),Xt)}}function iY(t,n){if(1&t&&(X(0,"i",42),be(1),te()),2&t){const e=ge().gameObject;W(1),Ze(e.isDropShadow?"star_half":"star_border")}}function rY(t,n){if(1&t){const e=Ye();X(0,"button",59),Ie("click",function(r){ke(e);const s=ge().gameObject;return ge().onContextMenu(r,s)}),X(1,"i",42),be(2,"settings"),te()()}}const sY=function(t,n,e,i){return{inverse:t,hollow:n,"is-hide-in":e,"black-paint":i}};function oY(t,n){if(1&t&&(nt(0,"img",60),bt(1,"safe")),2&t){const e=ge().gameObject;re("src",yt(1,2,e.imageFile.url,"resourceUrl"),Xt)("ngClass",Js(5,sY,e.isInverse,e.isHollow,e.isHideIn,e.isBlackPaint))}}function aY(t,n){1&t&&$n(0)}const lY=function(t,n){return{dataElm:t,name:n}};function cY(t,n){if(1&t&&(Ge(0),xe(1,aY,1,0,"ng-container",11),qe()),2&t){const e=n.$implicit,i=ge(2).gameObject;ge();const r=Wt(13);W(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",cn(2,lY,e,i.name))}}function uY(t,n){if(1&t&&(X(0,"div"),xe(1,cY,2,5,"ng-container",61),te()),2&t){const e=ge().gameObject,i=ge();W(1),re("ngForOf",i.getInventoryTags(e))("ngForTrackBy",i.trackByGameObject)}}const $u=function(t){return{"is-active":t}},BI=function(t){return{"is-hide-in":t}},dY=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}};function fY(t,n){if(1&t){const e=Ye();X(0,"div",35)(1,"div",36)(2,"button",37),Ie("click",function(){const s=ke(e).gameObject;return s.isUseIconToOverviewImage=!s.isUseIconToOverviewImage}),xe(3,JK,3,4,"i",38),xe(4,eY,2,0,"ng-template",null,39,On),te(),X(6,"span",40),be(7),te(),X(8,"button",41),Ie("click",function(){const s=ke(e).gameObject;return s.isShowChatBubble=!s.isShowChatBubble}),X(9,"i",42),be(10),te()(),X(11,"button",43),Ie("click",function(){const s=ke(e).gameObject;return s.isDropShadow=!s.isDropShadow}),xe(12,nY,3,7,"i",38),xe(13,iY,2,1,"ng-template",null,44,On),te(),X(15,"button",45),Ie("click",function(){const s=ke(e).gameObject;return s.isNotRide=!s.isNotRide}),X(16,"i",42),be(17),te()(),X(18,"button",46),Ie("click",function(){const s=ke(e).gameObject;return s.isAltitudeIndicate=!s.isAltitudeIndicate}),X(19,"i",47),be(20,"straighten"),te(),X(21,"span",48),be(22),te()(),X(23,"button",49),Ie("click",function(){const s=ke(e).gameObject;return s.isInventoryIndicate=!s.isInventoryIndicate}),X(24,"i",42),be(25,"all_inbox"),te()(),xe(26,rY,3,0,"button",50),te(),X(27,"div",51)(28,"div",52)(29,"span",53),xe(30,oY,2,10,"img",54),te()(),X(31,"div",55),xe(32,uY,2,2,"div",2),te()()()}if(2&t){const e=n.gameObject,i=Wt(5),r=Wt(14),s=ge();W(2),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ct(26,$u,e.isUseIconToOverviewImage)),W(1),re("ngIf",e.faceIcon&&0<(null==e.faceIcon?null:e.faceIcon.url.length))("ngIfElse",i),W(4),Ze(e.name),W(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ct(28,$u,e.isShowChatBubble)),W(2),Ze(e.isShowChatBubble?"textsms":"speaker_notes_off"),W(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ct(30,$u,e.isDropShadow)),W(1),re("ngIf",e.shadowImageFile&&0<e.shadowImageFile.url.length)("ngIfElse",r),W(3),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ct(32,$u,!e.isNotRide)),W(2),Ze(e.isNotRide?"directions_run":"directions_bike"),W(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ct(34,$u,e.isAltitudeIndicate)),W(4),Ze(e.altitude),W(1),re("disabled",s.selectedIdentifier!==e.identifier)("ngClass",ct(36,$u,e.isInventoryIndicate)),W(3),re("ngIf",s.selectedIdentifier===e.identifier),W(1),re("ngClass",ct(38,BI,e.isHideIn)),W(1),re("ngClass",ct(40,BI,e.isHideIn)),W(1),re("ngClass",vo(42,dY,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),W(1),re("ngIf",e.imageFile.url),W(2),re("ngIf",e.rootDataElement)}}function hY(t,n){1&t&&(Ge(0),nt(1,"br"),qe())}function pY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",67)(2,"span"),be(3),te()(),X(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),be(8),te(),X(9,"input",72),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te()()()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;W(3),Ze(i.name),W(5),Ze(i.value),W(1),it("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}const gY=function(){return{"background-color":"green"}};function mY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",73)(2,"div",74)(3,"span"),be(4),te()(),X(5,"input",75),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.currentValue=r}),te()(),X(6,"div",73)(7,"input",76),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.currentValue=r}),bt(8,"safe"),te()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;W(4),Ze(i.name),W(1),re("logging.name",r)("logging.dataElement",i)("ngModel",i.currentValue),Rt("data-init-value",i.currentValue),W(2),Dr(yt(8,14,"font-size: 0.8em; min-width: 1em; width:"+(i.name.length+4.5)+"em; --min: 0; --max: "+i.value+"; --val:"+i.currentValue+";","style")),it("title",i.currentValue),it("max",+i.value?i.value:1e3),re("logging.name",r)("logging.dataElement",i)("ngStyle",Yo(17,gY))("ngModel",i.currentValue),Rt("data-init-value",i.currentValue)}}function _Y(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",67)(2,"span"),be(3),te()(),X(4,"div",68)(5,"div",69)(6,"div",70)(7,"input",77),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r})("change",function(){ke(e);const r=ge(2).dataElm;return r.value=r.value?r.name:""}),te()()()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;W(1),Je("text-decoration",i.value?"none":"line-through"),W(2),Ze(i.name),W(4),it("checked",i.value?"checked":""),re("logging.name",r)("logging.dataElement",i)("ngModel",i.value)}}function $Y(t,n){if(1&t&&(X(0,"span",79),be(1),te()),2&t){const e=ge(3).dataElm;W(1),An("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function vY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",67)(2,"span"),be(3),te()(),X(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),be(8),te(),X(9,"input",72),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te(),xe(10,$Y,2,1,"span",78),te()()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name;W(3),Ze(i.name),W(5),Ze(i.value),W(1),it("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("ngModel",i.value),W(1),re("ngIf",i.currentValue)}}const bY=function(t){return{"outer-link":t}};function yY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",67)(2,"a",80),Ie("click",function(){ke(e);const r=ge(2),s=r.dataElm,o=r.name,d=ge();return!!d.stringUtil.validUrl(s.value)&&d.openUrl(s.value,o,s.name)}),bt(3,"safe"),X(4,"span",81),be(5),te()()(),qe()}if(2&t){const e=ge(2).dataElm,i=ge();W(2),re("ngClass",ct(8,bY,!i.stringUtil.sameOrigin(e.value))),Rt("title",e.value)("href",yt(3,5,i.stringUtil.validUrl(e.value)?e.value:"","url"),Xt)("disabled",i.stringUtil.validUrl(e.value)?null:""),W(3),Ze(e.name)}}function CY(t,n){1&t&&$n(0)}function xY(t,n){1&t&&$n(0)}function wY(t,n){1&t&&$n(0)}function EY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",67)(2,"span"),be(3),te()(),X(4,"div",68)(5,"div",69)(6,"div",70)(7,"div",71),be(8),te(),X(9,"input",82),Ie("ngModelChange",function(r){return ke(e),ge(3).dataElm.value=r}),te()()()(),qe()}if(2&t){const e=ge(3).dataElm;W(3),Ze(e.name),W(5),Ze(e.value),W(1),it("type","size"===e.name||"altitude"===e.name?"number":"text"),it("min","size"===e.name?"0":""),re("ngModel",e.value)}}function TY(t,n){if(1&t&&(Ge(0),xe(1,EY,10,5,"ng-container",2),qe()),2&t){const e=ge(2).dataElm;W(1),re("ngIf",0==e.children.length)}}function IY(t,n){if(1&t&&(X(0,"div",63),Ge(1,64),xe(2,pY,10,6,"ng-container",65),xe(3,mY,9,18,"ng-container",65),xe(4,_Y,8,7,"ng-container",65),xe(5,vY,11,7,"ng-container",65),xe(6,yY,6,10,"ng-container",65),xe(7,CY,1,0,"ng-container",65),xe(8,xY,1,0,"ng-container",65),xe(9,wY,1,0,"ng-container",65),xe(10,TY,2,1,"ng-container",66),qe(),te()),2&t){const e=ge().dataElm;W(1),re("ngSwitch",e.attributes.type),W(1),re("ngSwitchCase","simpleNumber"),W(1),re("ngSwitchCase","numberResource"),W(1),re("ngSwitchCase","checkProperty"),W(1),re("ngSwitchCase","abilityScore"),W(1),re("ngSwitchCase","url"),W(1),re("ngSwitchCase","colors"),W(1),re("ngSwitchCase","color"),W(1),re("ngSwitchCase","note")}}function SY(t,n){if(1&t&&(xe(0,hY,2,0,"ng-container",2),xe(1,IY,11,9,"div",62)),2&t){const e=n.dataElm,i=ge();re("ngIf",(null==e?null:e.name)===i.newLineString),W(1),re("ngIf",e&&e.name!==i.newLineString)}}let kY=(()=>{class t{constructor(e,i,r,s,o,d){this.changeDetector=e,this.panelService=i,this.inventoryService=r,this.contextMenuService=s,this.pointerDeviceService=o,this.modalService=d,this.inventoryTypes=["table","common","graveyard"],this.selectTab="table",this.selectedIdentifier="",this.isEdit=!1,this.stringUtil=et,this.sortStopTimerId=null}get sortTag(){return this.inventoryService.sortTag}set sortTag(e){this.inventoryService.sortTag=e}get sortOrder(){return this.inventoryService.sortOrder}set sortOrder(e){this.inventoryService.sortOrder=e}get dataTag(){return this.inventoryService.dataTag}set dataTag(e){this.inventoryService.dataTag=e}get dataTags(){return this.inventoryService.dataTags}get indicateAll(){return this.inventoryService.indicateAll}set indicateAll(e){this.inventoryService.indicateAll=e}get sortOrderName(){return this.sortOrder===Qd.ASC?"\u6607\u9806":"\u964d\u9806"}get newLineString(){return this.inventoryService.newLineString}get isGMMode(){return!!He.myCursor&&He.myCursor.isGMMode}ngOnInit(){Promise.resolve().then(()=>this.panelService.title="\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),Fe.register(this).on("SELECT_TABLETOP_OBJECT",e=>{rt.instance.get(e.data.identifier)instanceof mi&&(this.selectedIdentifier=e.data.identifier,this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{e.isSendFromSelf&&this.changeDetector.markForCheck()}).on("UPDATE_INVENTORY",e=>{(e.isSendFromSelf||e.data)&&this.changeDetector.markForCheck()}).on("OPEN_NETWORK",e=>{this.inventoryTypes=["table","common",vt.peerId,"graveyard"],this.inventoryTypes.includes(this.selectTab)||(this.selectTab=vt.peerId)}),this.inventoryTypes=["table","common",vt.peerId,"graveyard"]}ngOnDestroy(){Fe.unregister(this),this.sortStopTimerId&&clearTimeout(this.sortStopTimerId)}getTabTitle(e){switch(e){case"table":return"\u30c6\u30fc\u30d6\u30eb";case vt.peerId:return"\u500b\u4eba";case"graveyard":return"\u5893\u5834";default:return"\u5171\u6709"}}getInventory(e){switch(e){case"table":return this.inventoryService.tableInventory;case vt.peerId:return this.inventoryService.privateInventory;case"graveyard":return this.inventoryService.graveyardInventory;default:return this.inventoryService.commonInventory}}getGameObjects(e){return this.getInventory(e).tabletopObjects.filter(i=>"table"!=e||this.indicateAll||i.isInventoryIndicate)}getInventoryTags(e){return this.getInventory(e.location.name).dataElementMap.get(e.identifier)}onContextMenu(e,i){if(document.activeElement instanceof HTMLInputElement&&"range"!==document.activeElement.getAttribute("type")||(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;this.selectGameObject(i);let r=this.pointerDeviceService.pointers[0],s=[];"table"===i.location.name&&(this.isGMMode||i.isVisible)&&s.push({name:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u304b\u3089\u63a2\u3059",action:()=>{"table"===i.location.name&&Fe.trigger("FOCUS_TABLETOP_OBJECT",{x:i.location.x,y:i.location.y,z:i.posZ+(i.altitude>0?50*i.altitude:0)})},default:"table"===i.location.name,disabled:"table"!==i.location.name,selfOnly:!0}),i.isHideIn&&s.push({name:"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b",action:()=>{i.owner="",ut.play(Xe.piecePut),Fe.trigger("UPDATE_INVENTORY",null)}}),(!i.isHideIn||!i.isVisible)&&s.push({name:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{"table"===i.location.name&&!jt.isStealthMode&&!He.myCursor.isGMMode&&this.modalService.open(qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:_i.OK,materialIcon:"disabled_visible"}),i.owner=vt.peerContext.userId,ut.play(Xe.sweep),Fe.call("UPDATE_INVENTORY",!0)}}),s.push(At),i.imageFiles.length>1&&(s.push({name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:i.imageFiles.map((d,$)=>({name:i.currntImageIndex==$?"\u25c9":"\u25cb",action:()=>{i.currntImageIndex=$,ut.play(Xe.surprise),Fe.trigger("UPDATE_INVENTORY",null)},default:i.currntImageIndex==$,icon:d}))}),s.push(At)),s.push(i.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{i.isUseIconToOverviewImage=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{i.isShowChatBubble=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{i.isDropShadow=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[i.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{i.isInverse=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{i.isInverse=!0,Fe.trigger("UPDATE_INVENTORY",null)}},i.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{i.isHollow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{i.isHollow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},i.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{i.isBlackPaint=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==i.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{i.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)}},At].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((d,$)=>({name:`${i.aura==$?"\u25c9":"\u25cb"} ${d}`,action:()=>{i.aura=$,Fe.trigger("UPDATE_INVENTORY",null)}})))},At,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{i.isInverse=!1,i.isHollow=!1,i.isBlackPaint=!1,i.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)},disabled:!i.isInverse&&!i.isHollow&&!i.isBlackPaint&&-1==i.aura}]}),s.push(At),s.push(i.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{i.isNotRide=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push(i.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{i.isAltitudeIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}}),s.push({name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=i.altitude&&(i.altitude=0,"table"===i.location.name&&ut.play(Xe.sweep))},altitudeHande:i}),s.push(At),s.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(i)}}),s.push({name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(i)},disabled:"graveyard"===i.location.name}),s.push({name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(i)}}),s.push(At),s.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:i.getUrls().map(d=>{const $=d.value.toString();return{name:d.name?d.name:$,action:()=>{et.sameOrigin($)?window.open($.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:$,title:i.name,subTitle:d.name})},disabled:!et.validUrl($),error:et.validUrl($)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl($)&&!et.sameOrigin($)}}),disabled:i.getUrls().length<=0}),s.push(At),s.push(i.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{i.isInventoryIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}});let o=[{name:"table",alias:"\u30c6\u30fc\u30d6\u30eb"},{name:"common",alias:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:vt.peerId,alias:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"},{name:"graveyard",alias:"\u5893\u5834"}];s.push({name:`${(o.find(d=>d.name==i.location.name)||o[1]).alias}\u304b\u3089\u79fb\u52d5`,action:null,subActions:o.filter((d,$)=>!(i.location.name==d.name||1==$&&!o.map(I=>I.name).includes(i.location.name))).map(d=>({name:`${d.alias}`,action:()=>{let $=jt.isStealthMode;Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation(d.name),"table"===d.name&&i.isHideIn&&i.isVisible&&!$&&!He.myCursor.isGMMode&&this.modalService.open(qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:_i.OK,materialIcon:"disabled_visible"}),ut.play("graveyard"==d.name?Xe.sweep:Xe.piecePut),Fe.call("UPDATE_INVENTORY",!0)}})),disabled:!i.isVisible&&!this.isGMMode}),s.push(At),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{this.cloneGameObject(i),ut.play(Xe.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),s.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const d=i.clone(),$=d.name.split("_");let I;I=$.length>1&&/\d+/.test($[$.length-1])?$.slice(0,$.length-1).join("_"):$.join("_");let Q=0;for(const fe of rt.instance.getObjects(jt)){if(!fe.name.startsWith(I))continue;let _e=fe.name.match(/_(\d+)$/)?+RegExp.$1:0;_e>Q&&(Q=_e)}d.name=I+"_"+(Q+1),d.update(),ut.play(Xe.piecePut)},disabled:!i.isVisible&&!this.isGMMode}),"graveyard"===i.location.name?(s.push(At),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5b8c\u5168\u306b\u524a\u9664\uff09",action:()=>{this.deleteGameObject(i),ut.play(Xe.sweep)}})):(s.push(At),s.push({name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:i.identifier}),i.setLocation("graveyard"),ut.play(Xe.sweep)}})),this.contextMenuService.open(r,s,i.name)}toggleEdit(){this.isEdit=!this.isEdit}cleanInventory(){let e=this.getTabTitle(this.selectTab),i=this.getGameObjects(this.selectTab);this.modalService.open(qi,{title:"\u5893\u5834\u3092\u7a7a\u306b\u3059\u308b",text:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u304b\uff1f",helpHtml:`<b>${et.escapeHtml(e)}</b>\u306b\u5b58\u5728\u3059\u308b <b>${i.length}</b> \u4f53\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u5b8c\u5168\u306b\u524a\u9664\u3057\u307e\u3059\u3002`,type:_i.OK_CANCEL,materialIcon:"delete_forever",action:()=>{for(const r of i)this.deleteGameObject(r);ut.play(Xe.sweep)}})}cloneGameObject(e){e.clone()}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:i.x-800,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(cu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}selectGameObject(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName,highlighting:!0})}focusGameObject(e,i){i.target instanceof HTMLElement&&(new Set(["input","button"]).has(i.target.tagName.toLowerCase())||"table"!==e.location.name||!e.isVisible&&!this.isGMMode||Fe.trigger("FOCUS_TABLETOP_OBJECT",{x:e.location.x,y:e.location.y,z:e.posZ+(e.altitude>0?50*e.altitude:0)}))}deleteGameObject(e){e.destroy(),this.changeDetector.markForCheck()}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Wp,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}trackByGameObject(e,i){return i?i.identifier:e}openUrl(e,i=null,r=null){return et.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:e,title:i,subTitle:r}),!1}onInput(){this.inventoryService.sortStop=!0,this.sortStopTimerId&&clearTimeout(this.sortStopTimerId),this.sortStopTimerId=setTimeout(()=>{this.inventoryService.sortStop=!1},666)}}return t.\u0275fac=function(e){return new(e||t)(Oe(Di),Oe(Tn),Oe(d1),Oe(lr),Oe(li),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["game-object-inventory"]],decls:14,vars:6,consts:[[1,"component",3,"input"],[4,"ngTemplateOutlet"],[4,"ngIf"],["class","object-container",3,"ngClass","contextmenu","click","dblclick",4,"ngFor","ngForOf","ngForTrackBy"],["style","padding-top: 6px;",4,"ngIf"],["inventoryTab",""],["inventoryViewSetting",""],["gameObjectTags",""],["dataElmTag",""],[1,"object-container",3,"ngClass","contextmenu","click","dblclick"],["class","owner-tag",3,"background-color",4,"ngIf"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"owner-tag"],[2,"padding-top","6px"],[1,"danger",3,"click"],[1,"is-sticky-top"],[1,"tab"],[4,"ngFor","ngForOf"],["name","tab","type","radio","ng-control","options",3,"value","ngModel","ngModelChange"],[2,"font-size","12px"],["placeholder","\u30bf\u30b0\u540d",1,"order-control",3,"ngModel","ngModelChange"],[1,"order-control",3,"ngModel","ngModelChange"],["value","ASC"],["value","DESC"],[2,"font-size","12px","padding-top","6px"],["placeholder","\u30b9\u30da\u30fc\u30b9\u533a\u5207\u308a\u3067\u30bf\u30b0\u540d \u30b9\u30e9\u30c3\u30b7\u30e5\u3067\u6539\u884c ex.\u300cHP MP / \u30e1\u30e2\u300d",2,"width","100%","box-sizing","border-box",3,"ngModel","ngModelChange"],[1,"tab-setting","small-font",3,"click"],[1,"material-icons","small-font"],[2,"font-size","0.8em"],["nowrap","",2,"vertical-align","middle"],["width","100%","nowrap",""],["style","float: right; font-size: smaller",4,"ngIf"],[2,"float","right","font-size","smaller"],["type","checkbox",3,"ngModel","ngModelChange"],[1,"self_only"],[1,"inventory-object"],[1,"object-name"],["title","\u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854\u30a2\u30a4\u30b3\u30f3\u3092\u4f7f\u7528",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["class","face-icon",4,"ngIf","ngIfElse"],["altImage",""],[1,"game-object-name",2,"margin-left","3px","margin-right","3px"],["title","\u{1f4ad}\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons",2,"font-size","1em"],["title","\u5f71\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","1px","width","24px","height","16px","margin-bottom","1px",3,"disabled","ngClass","click"],["altShadow",""],["title","\u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["title","\u9ad8\u5ea6\u306e\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],[1,"material-icons","rotate",2,"font-size","1em"],[2,"display","inline-block","text-align","center","font-size","xx-small","color","gray","min-width","2em"],["title","\u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",1,"indicate",2,"font-size","0.8em","padding","2px 5px",3,"disabled","ngClass","click"],["style","font-size: 0.8em; padding: 2px 5px;","title","\u30e1\u30cb\u30e5\u30fc",3,"click",4,"ngIf"],[1,"object-tags-box",3,"ngClass"],[1,"table-cell","image-box",3,"ngClass"],[1,"aura",3,"ngClass"],["class","inverser","draggable","false",3,"src","ngClass",4,"ngIf"],[1,"table-cell"],[1,"face-icon"],["alt","",3,"src"],["alt","",2,"filter","brightness(0)",3,"ngStyle","src"],["title","\u30e1\u30cb\u30e5\u30fc",2,"font-size","0.8em","padding","2px 5px",3,"click"],["draggable","false",1,"inverser",3,"src","ngClass"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","object-tag",4,"ngIf"],[1,"object-tag"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"tag-name"],[2,"text-align","center"],[2,"display","inline-block"],[1,"tag-value-box"],[1,"hidden-spacer",2,"font-weight","bold"],["appLogging","","size","1","placeholder","",1,"input","tag-value",3,"logging.name","logging.dataElement","type","ngModel","ngModelChange"],[1,"resource-tag"],[2,"font-size","0.8em","display","inline-block","margin-right","0.5em"],["appLogging","","type","number","size","1","placeholder","Value",1,"input","resource-value",3,"logging.name","logging.dataElement","ngModel","ngModelChange"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","title","max","ngStyle","ngModel","ngModelChange"],["appLogging","","type","checkbox",3,"logging.name","logging.dataElement","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["target","_blank",3,"ngClass","click"],[1,"url-link"],["size","1",1,"input","tag-value",2,"min-width","4em",3,"type","min","ngModel","ngModelChange"]],template:function(e,i){if(1&e&&(X(0,"div",0),Ie("input",function(){return i.onInput()}),xe(1,RK,1,0,"ng-container",1),xe(2,OK,1,0,"ng-container",1),xe(3,BK,2,1,"div",2),xe(4,HK,3,10,"div",3),xe(5,VK,3,1,"div",4),te(),xe(6,qK,3,1,"ng-template",null,5,On),xe(8,QK,2,2,"ng-template",null,6,On),xe(10,fY,33,51,"ng-template",null,7,On),xe(12,SY,2,2,"ng-template",null,8,On)),2&e){const r=Wt(7),s=Wt(9);W(1),re("ngTemplateOutlet",r),W(1),re("ngTemplateOutlet",s),W(1),re("ngIf",i.getGameObjects(i.selectTab).length<1),W(1),re("ngForOf",i.getGameObjects(i.selectTab))("ngForTrackBy",i.trackByGameObject),W(1),re("ngIf","graveyard"===i.selectTab)}},directives:[_l,gn,Jn,jn,bl,vl,Qo,Sa,si,oi,ei,Zr,Rr,Or,Yr,Ji,ml,_d,Ls,ds,fs,$d],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{width:100%}.box[_ngcontent-%COMP%]{border:transparent 2px solid;border-left:transparent 6px solid;margin-top:2px;padding:2px 2px 3px;box-sizing:border-box;border-bottom:1px dotted #666}.selected[_ngcontent-%COMP%]{padding:2px;border:2px dotted #666;border-left:6px solid #EFBC70}.selected.is-inventory-no-indicate[_ngcontent-%COMP%]{border-left-color:#80ccee}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0;font-size:1em;min-width:1em;max-width:12em;overflow:hidden;padding:0 2px;box-sizing:border-box;white-space:nowrap}.input[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;padding:2px;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.tab[_ngcontent-%COMP%]{padding:5px;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tab[_ngcontent-%COMP%]{padding:0;border:solid 1px #555;border-radius:.3em;overflow:hidden;display:flex;flex-flow:row nowrap;justify-content:space-around;align-items:stretch;text-align:center;margin:0;max-width:500px;background-color:#f0dabde6}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;flex:1 0 auto;flex-grow:1}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:checked{background:#555;color:#ccc}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]{display:none}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{vertical-align:middle;outline:0;font-size:.6em;background-color:transparent;color:#444;box-sizing:border-box;margin:0;padding:2px 8px;cursor:pointer}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border-color:#555}.tab[_ngcontent-%COMP%]   input[type=radio][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]{background:#555;color:#ccc}.is-sticky-top[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;top:0;z-index:10000}.tab-setting[_ngcontent-%COMP%]{background-color:transparent;color:#444;border:solid 1px #555;padding:2px 8px;border-radius:5px;cursor:pointer}.tab-setting[_ngcontent-%COMP%]:hover{background-color:#888;color:#eee;border:solid 1px #555}.small-font[_ngcontent-%COMP%]{font-size:12px;vertical-align:middle}.material-icons[_ngcontent-%COMP%]{vertical-align:middle;font-size:1rem}.table-cell[_ngcontent-%COMP%]{display:table-cell}.image-box[_ngcontent-%COMP%]{padding:0;width:32px;height:32px;display:table-cell;vertical-align:top}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%}.inventory-object[_ngcontent-%COMP%]{font-size:14px;display:inline-block;vertical-align:text-top}.object-name[_ngcontent-%COMP%]{font-size:.8em;font-weight:700;padding:0 .25em}.object-tags-box[_ngcontent-%COMP%]{display:table;table-layout:fixed}.object-tag[_ngcontent-%COMP%]{display:inline-block;padding:0 .25em;vertical-align:middle}.resource-tag[_ngcontent-%COMP%]{text-align:center;vertical-align:bottom;overflow:hidden;white-space:nowrap}.resource-value[_ngcontent-%COMP%]{font-weight:700;width:4em;text-align:right;font-family:inherit}.tag-name[_ngcontent-%COMP%]{font-size:.8em;text-align:left;vertical-align:bottom;min-width:1em;max-width:12em;overflow:hidden;white-space:nowrap}.tag-value-box[_ngcontent-%COMP%]{display:table-cell;width:10px}.tag-value[_ngcontent-%COMP%]{font-size:1em;font-weight:700;width:100%;min-width:1em;max-width:12em;text-align:center;font-family:inherit}.tag-value[type=number][_ngcontent-%COMP%]{min-width:3.4em;text-align:right}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.5}.inverser.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.inverser.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.inverser.black-paint.is-hide-in[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #00f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 2px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -2px 3px #aaa) drop-shadow(0 -2px 2px #fff)}.material-icons.rotate[_ngcontent-%COMP%]{transform:rotate(90deg)}button.indicate[_ngcontent-%COMP%]:disabled{border-color:transparent}button.indicate[_ngcontent-%COMP%]:disabled   .material-icons[_ngcontent-%COMP%]{color:#000}button.indicate[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:.5}button.is-active[_ngcontent-%COMP%]{background-color:#fff}button.is-active[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{opacity:1}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.face-icon[_ngcontent-%COMP%]{display:inline-block;width:12px;height:12px;max-width:12px;max-height:12px;vertical-align:middle;overflow:hidden}.face-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.2rem}.self_only[_ngcontent-%COMP%]{color:red}.order-control[_ngcontent-%COMP%]{box-sizing:border-box;height:1.6em}.object-container.is-hide-in[_ngcontent-%COMP%]{background-color:#34549966}.object-container.is-hide-in[_ngcontent-%COMP%]   .game-object-name[_ngcontent-%COMP%], .object-tags-box.is-hide-in[_ngcontent-%COMP%]{color:#ddd;filter:invert(85%)}.image-box.is-hide-in[_ngcontent-%COMP%]{filter:invert(100%)}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{color:#ddd}.object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:hover, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:active, .object-tags-box.is-hide-in[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{color:#222}.object-container[_ngcontent-%COMP%]{position:relative}.owner-tag[_ngcontent-%COMP%]{position:absolute;font-size:8px;width:-webkit-min-content;width:-moz-min-content;width:min-content;max-width:100%;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:2px 6px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9;top:1px;right:1px;pointer-events:none}.url-link[_ngcontent-%COMP%]{cursor:pointer}"],changeDetection:0}),t})();const MY=Lt.create("./assets/images/skeleton.png");let vu=(()=>{class t{constructor(){}getSkeletonOr(e){let i=e instanceof Lt?e:It.instance.get(e);return i&&!i.isEmpty?i:MY}getEmptyOr(e){let i=e instanceof Lt?e:It.instance.get(e);return i&&!i.isEmpty?i:Lt.Empty}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function DY(t,n){if(1&t&&(X(0,"option",11),be(1),te()),2&t){const e=n.$implicit;Je("color",""==e.name?"gray":""),it("value",e.identifier),it("title",e.name),W(1),Ze(""==e.name?"(\u7121\u540d\u306e\u30c6\u30fc\u30d6\u30eb)":e.name)}}function AY(t,n){if(1&t&&(X(0,"div",41)(1,"i",42),be(2),te()()),2&t){const e=ge(2);W(1),ed(e.isShowHideImages?"red-eye":"grow"),W(1),Ze(e.isShowHideImages?"visibility":"visibility_off")}}function PY(t,n){if(1&t){const e=Ye();X(0,"div")(1,"button",43),Ie("click",function(){return ke(e),ge(2).openDistanceViewImageModal()}),be(2,"\u80cc\u666f\u753b\u50cf\u3092\u8ffd\u52a0"),te()()}if(2&t){const e=ge(2);W(1),re("disabled",!e.isEditable)}}function NY(t,n){if(1&t&&(X(0,"div",41)(1,"i",42),be(2),te()()),2&t){const e=ge(3);W(1),ed(e.isShowHideImages?"red-eye":"grow"),W(1),Ze(e.isShowHideImages?"visibility":"visibility_off")}}const LI=function(t){return{blackout:t}};function FY(t,n){if(1&t){const e=Ye();X(0,"div",13),Ie("click",function(){return ke(e),ge(2).openDistanceViewImageModal()}),xe(1,NY,3,3,"div",14),nt(2,"img",15),bt(3,"safe"),te()}if(2&t){const e=ge(2);W(1),re("ngIf",e.getHidden(e.tableDistanceviewImage)),W(1),re("ngClass",ct(6,LI,!e.isShowHideImages&&e.getHidden(e.tableDistanceviewImage)))("src",yt(3,3,e.tableDistanceviewImage.url,"resourceUrl"),Xt)}}function RY(t,n){if(1&t&&(X(0,"div",48),be(1),te()),2&t){const e=ge(3);W(1),An("",e.progresPercent,"%")}}const OY=function(t){return{"is-hidden":t}};function BY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",44),Ie("click",function(){return ke(e),ge(2).save()}),X(2,"div",45)(3,"div",32),be(4,"\u4fdd\u5b58"),te(),xe(5,RY,2,1,"div",46),te()(),X(6,"button",47),Ie("click",function(){return ke(e),ge(2).delete()}),be(7,"\u524a\u9664"),te(),qe()}if(2&t){const e=ge(2);W(1),re("disabled",e.isSaveing),W(2),re("ngClass",ct(4,OY,e.isSaveing)),W(2),re("ngIf",e.isSaveing),W(1),re("disabled",e.getGameTables().length<=1)}}function LY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",49),Ie("click",function(){return ke(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),te(),qe()}}const zY=function(t){return{disabled:t}};function jY(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",12)(2,"div")(3,"b"),be(4,"\u753b\u50cf"),te(),X(5,"div",13),Ie("click",function(){return ke(e),ge().openBgImageModal()}),xe(6,AY,3,3,"div",14),nt(7,"img",15),bt(8,"safe"),te()(),X(9,"div")(10,"b"),be(11,"\u80cc\u666f"),te(),xe(12,PY,3,1,"div",10),xe(13,FY,4,8,"div",16),te()(),X(14,"div")(15,"label",17),be(16,"Name\uff1a"),X(17,"input",18),Ie("ngModelChange",function(r){return ke(e),ge().tableName=r}),te()()(),X(18,"div")(19,"label",17),be(20,"Width\uff1a"),X(21,"input",19),Ie("ngModelChange",function(r){return ke(e),ge().tableWidth=r}),te()(),X(22,"input",20),Ie("ngModelChange",function(r){return ke(e),ge().tableWidth=r}),te()(),X(23,"div")(24,"label",17),be(25,"Height\uff1a"),X(26,"input",21),Ie("ngModelChange",function(r){return ke(e),ge().tableHeight=r}),te()(),X(27,"input",20),Ie("ngModelChange",function(r){return ke(e),ge().tableHeight=r}),te()(),X(28,"div")(29,"label",17),be(30,"\u30b0\u30ea\u30c3\u30c9\uff1a "),X(31,"select",22),Ie("ngModelChange",function(r){return ke(e),ge().tableGridType=r}),X(32,"option",23),be(33,"\u306a\u3057"),te(),X(34,"option",24),be(35,"\u30b9\u30af\u30a8\u30a2"),te(),X(36,"option",25),be(37,"\u30d8\u30af\u30b9\uff08\u7e26\u63c3\u3048\uff09"),te(),X(38,"option",26),be(39,"\u30d8\u30af\u30b9\uff08\u6a2a\u63c3\u3048\uff09"),te()()(),X(40,"label",27),be(41,"\u8272\uff1a "),X(42,"select",28),Ie("ngModelChange",function(r){return ke(e),ge().tableGridColor=r}),X(43,"option",29),be(44,"\u9ed2"),te(),X(45,"option",30),be(46,"\u767d"),te()()()(),X(47,"div")(48,"label",17)(49,"input",31),Ie("ngModelChange",function(r){return ke(e),ge().tableGridNumberShow=r}),te(),X(50,"span",32),be(51,"\u30b0\u30ea\u30c3\u30c9\u306e\u5ea7\u6a19\u756a\u53f7\u3092\u8868\u793a"),te()()(),X(52,"div")(53,"label",17),be(54,"\u80cc\u666f\u30d5\u30a3\u30eb\u30bf\uff1a "),X(55,"select",33),Ie("ngModelChange",function(r){return ke(e),ge().tableDistanceviewFilter=r}),X(56,"option",34),be(57,"\u306a\u3057"),te(),X(58,"option",35),be(59,"\u30db\u30ef\u30a4\u30c8"),te(),X(60,"option",36),be(61,"\u30d6\u30e9\u30c3\u30af"),te()()()(),nt(62,"hr"),X(63,"div")(64,"label",17)(65,"input",37),Ie("ngModelChange",function(r){return ke(e),ge().tableGridShow=r}),te(),be(66," \u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a"),X(67,"sup",38),be(68,"*"),te()(),X(69,"label",39)(70,"input",40),Ie("ngModelChange",function(r){return ke(e),ge().tableGridSnap=r}),te(),be(71," \u30b9\u30ca\u30c3\u30d7"),X(72,"sup",38),be(73,"*"),te()(),xe(74,BY,8,6,"ng-container",10),xe(75,LY,3,0,"ng-container",10),te(),qe()}if(2&t){const e=ge();W(6),re("ngIf",e.getHidden(e.tableBackgroundImage)),W(1),re("ngClass",ct(41,LI,!e.isShowHideImages&&e.getHidden(e.tableBackgroundImage)))("src",yt(8,38,e.tableBackgroundImage.url,"resourceUrl"),Xt),W(5),re("ngIf",!e.tableDistanceviewImage.url),W(1),re("ngIf",e.tableDistanceviewImage.url),W(4),re("ngModel",e.tableName)("disabled",!e.isEditable),W(4),it("title",e.tableWidth),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.tableWidth)("disabled",!e.isEditable),W(1),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.tableWidth)("disabled",!e.isEditable),W(4),it("title",e.tableHeight),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.tableHeight)("disabled",!e.isEditable),W(1),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.tableHeight)("disabled",!e.isEditable),W(4),re("ngModel",e.tableGridType)("disabled",!e.isEditable),W(11),re("ngModel",e.tableGridColor)("disabled",!e.isEditable||-1==e.tableGridType),W(7),re("ngModel",e.tableGridNumberShow)("disabled",!e.isEditable||-1==e.tableGridType),W(1),re("ngClass",ct(43,zY,!e.isEditable||-1==e.tableGridType)),W(5),re("ngModel",e.tableDistanceviewFilter)("disabled",!e.isEditable),W(10),re("ngModel",e.tableGridShow),W(5),re("ngModel",e.tableGridSnap),W(4),re("ngIf",!e.isDeleted),W(1),re("ngIf",e.isDeleted)}}function UY(t,n){1&t&&(Ge(0),X(1,"div",50),be(2,"\u203b\u30c6\u30fc\u30d6\u30eb\u304c\uff11\u3064\u3082\u4f5c\u6210\u3055\u308c\u3066\u3044\u307e\u305b\u3093\u3002\u300c\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b\u300d\u304b\u3089\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u6210\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002"),te(),qe())}const HY=function(t){return{"red-eye":t}};let zI=(()=>{class t{constructor(e,i,r,s,o){this.changeDetector=e,this.modalService=i,this.saveDataService=r,this.imageService=s,this.panelService=o,this.minSize=1,this.maxSize=100,this.isShowHideImages=!1,this.selectedTable=null,this.selectedTableXml="",this.isSaveing=!1,this.progresPercent=0}get tableBackgroundImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.imageIdentifier:null)}get tableDistanceviewImage(){return this.imageService.getEmptyOr(this.selectedTable?this.selectedTable.backgroundImageIdentifier:null)}get tableName(){return this.selectedTable.name}set tableName(e){this.isEditable&&(this.selectedTable.name=e)}get tableWidth(){return this.selectedTable.width}set tableWidth(e){this.isEditable&&(this.selectedTable.width=e)}get tableHeight(){return this.selectedTable.height}set tableHeight(e){this.isEditable&&(this.selectedTable.height=e)}get tableGridColor(){return this.selectedTable.gridColor}set tableGridColor(e){this.isEditable&&(this.selectedTable.gridColor=e)}get tableGridShow(){return this.tableSelecter.gridShow}set tableGridShow(e){this.tableSelecter.gridShow=e,Fe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableGridSnap(){return this.tableSelecter.gridSnap}set tableGridSnap(e){this.tableSelecter.gridSnap=e}get tableGridType(){return this.selectedTable.gridType}set tableGridType(e){this.isEditable&&(this.selectedTable.gridType=Number(e))}get tableGridNumberShow(){return this.selectedTable.isShowNumber}set tableGridNumberShow(e){this.selectedTable.isShowNumber=e,Fe.trigger("UPDATE_GAME_OBJECT",this.tableSelecter.toContext())}get tableDistanceviewFilter(){return this.selectedTable.backgroundFilterType}set tableDistanceviewFilter(e){this.isEditable&&(this.selectedTable.backgroundFilterType=e)}get tableSelecter(){return ir.instance}get isEmpty(){return!this.tableSelecter||!this.tableSelecter.viewTable}get isDeleted(){return!this.selectedTable||null==rt.instance.get(this.selectedTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>{this.modalService.title=this.panelService.title="\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"}),this.selectedTable=this.tableSelecter.viewTable,Fe.register(this).on("DELETE_GAME_OBJECT",2e3,e=>{if(!this.selectedTable||e.data.identifier!==this.selectedTable.identifier)return;let i=rt.instance.get(e.data.identifier);null!==i&&(this.selectedTableXml=i.toXml())})}ngAfterViewInit(){}ngOnDestroy(){Fe.unregister(this)}selectGameTable(e){Fe.call("SELECT_GAME_TABLE",{identifier:e},vt.peerId),this.selectedTable=rt.instance.get(e),this.selectedTableXml=""}getGameTables(){return rt.instance.getObjects(Fi)}createGameTable(){let e=new Fi;e.name="\u767d\u7d19\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier="testTableBackgroundImage_image",e.initialize(),this.selectGameTable(e.identifier)}save(){var e=this;return(0,Yt.Z)(function*(){!e.selectedTable||e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,e.selectedTable.selected=!0,yield e.saveDataService.saveGameObjectAsync(e.selectedTable,"fly_map_"+e.selectedTable.name,i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedTable&&(this.selectedTableXml=this.selectedTable.toXml(),this.selectedTable.destroy())}restore(){if(this.selectedTable&&this.selectedTableXml){let e=Gn.instance.parseXml(this.selectedTableXml);this.selectGameTable(e.identifier),this.selectedTableXml=""}}getHidden(e){const i=mn.get(e.identifier);return!!i&&i.hide}openBgImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.imageIdentifier&&(e=[this.selectedTable.imageIdentifier]),this.modalService.open(Po,{currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.imageIdentifier=i)})}openDistanceViewImageModal(){if(this.isDeleted)return;let e=[];this.selectedTable&&this.selectedTable.backgroundImageIdentifier&&(e=[this.selectedTable.backgroundImageIdentifier]),this.modalService.open(Po,{isAllowedEmpty:!0,currentImageIdentifires:e}).then(i=>{!this.selectedTable||!i||(this.selectedTable.backgroundImageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:_i.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}}return t.\u0275fac=function(e){return new(e||t)(Oe(Di),Oe(kn),Oe(Cr),Oe(vu),Oe(Tn))},t.\u0275cmp=qt({type:t,selectors:[["game-table-setting"]],decls:15,vars:9,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"margin-bottom","2px","font-size","smaller",3,"click"],["size","10",2,"width","100%","max-width","155px",3,"ngModel","change"],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[4,"ngIf"],[3,"value","title"],[1,"images-select"],[2,"position","relative","overflow","hidden","cursor","pointer",3,"click"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["height","120",3,"ngClass","src"],["style","position: relative; overflow: hidden; cursor: pointer",3,"click",4,"ngIf"],[1,"self-setting"],["placeholder","Name",3,"ngModel","disabled","ngModelChange"],["type","range","name","tableWidth",3,"ngModel","title","min","max","disabled","ngModelChange"],["type","number",2,"width","5em",3,"ngModel","min","max","disabled","ngModelChange"],["type","range","name","tableHeight",3,"ngModel","title","min","max","disabled","ngModelChange"],["name","tableGridType",3,"ngModel","disabled","ngModelChange"],["value","-1"],["value","0"],["value","1"],["value","2"],[1,"self-setting",2,"margin-left","3px"],["name","tableGridColor",3,"ngModel","disabled","ngModelChange"],["value","#000000e6"],["value","#dddddde6"],["type","checkbox","name","tableGridNumberShow",3,"ngModel","disabled","ngModelChange"],[3,"ngClass"],["name","tableDistanceviewFilter",3,"ngModel","disabled","ngModelChange"],["value",""],["value","white"],["value","black"],["type","checkbox","name","tableGridShow",3,"ngModel","ngModelChange"],[1,"self-only"],[1,"self-setting",2,"margin-left","1em"],["type","checkbox","name","tableGridSnap",3,"ngModel","ngModelChange"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"height","120px",3,"disabled","click"],[2,"margin-left","2em",3,"disabled","click"],[2,"position","relative"],["class","progress",4,"ngIf"],[1,"danger",3,"disabled","click"],[1,"progress"],[3,"click"],[2,"font-size","12px"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ie("click",function(){return i.createGameTable()}),be(4,"\u65b0\u3057\u3044\u30c6\u30fc\u30d6\u30eb\u3092\u4f5c\u308b"),te()(),X(5,"select",3),Ie("change",function(s){return i.selectGameTable(s.target.value)}),xe(6,DY,2,5,"option",4),te()(),X(7,"div",5)(8,"div",6)(9,"label",7)(10,"input",8),Ie("click",function(s){return i.onShowHiddenImages(s)}),te(),X(11,"i",9),be(12),te()()(),xe(13,jY,76,45,"ng-container",10),te()(),xe(14,UY,3,0,"ng-container",10)),2&e&&(W(5),re("ngModel",null==i.selectedTable?null:i.selectedTable.identifier),W(1),re("ngForOf",i.getGameTables()),W(4),it("checked",i.isShowHideImages?"checked":""),W(1),re("ngClass",ct(7,HY,i.isShowHideImages)),W(1),Ze(i.isShowHideImages?"visibility":"visibility_off"),W(1),re("ngIf",!i.isEmpty||i.selectedTable),W(1),re("ngIf",i.isEmpty))},directives:[Zr,oi,ei,Jn,Rr,Or,jn,gn,si,fs,ds,Co,yo,Yr],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.images-select[_ngcontent-%COMP%]{display:flex}input[type=number][_ngcontent-%COMP%]{text-align:right}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}.disabled[_ngcontent-%COMP%]{color:gray;font-weight:400}"]}),t})();function VY(t,n){if(1&t){const e=Ye();X(0,"button",21),Ie("click",function(){ke(e);const r=ge().$implicit;return ge().play(r)}),X(1,"i",22),be(2,"play_arrow"),te(),be(3,"\u8a66\u8074"),X(4,"sup",23),be(5,"*"),te()()}2&t&&re("disabled",!ge().$implicit.isReady)}function GY(t,n){if(1&t){const e=Ye();X(0,"button",21),Ie("click",function(){return ke(e),ge(2).stop()}),X(1,"i",22),be(2,"stop"),te(),be(3,"\u8a66\u8074"),X(4,"sup",23),be(5,"*"),te()()}2&t&&re("disabled",!ge().$implicit.isReady)}function qY(t,n){if(1&t){const e=Ye();X(0,"button",21),Ie("click",function(){ke(e);const r=ge().$implicit;return ge().playBGM(r)}),X(1,"i",22),be(2,"loop"),te(),be(3,"\uff22\uff27\uff2d"),te()}2&t&&re("disabled",!ge().$implicit.isReady)}function WY(t,n){if(1&t){const e=Ye();X(0,"button",21),Ie("click",function(){ke(e);const r=ge().$implicit;return ge().stopBGM(r)}),X(1,"i",22),be(2,"stop"),te(),be(3,"\uff22\uff27\uff2d"),te()}2&t&&re("disabled",!ge().$implicit.isReady)}function KY(t,n){1&t&&(X(0,"span",20)(1,"b"),be(2,"\u3010\u8a66\u8074\u4e2d\u3011"),te()())}function YY(t,n){1&t&&(X(0,"span",20)(1,"b"),be(2,"\u3010\uff22\uff27\uff2d\u3011"),te()())}function ZY(t,n){1&t&&(X(0,"span",20)(1,"b"),be(2,"\u3010\u8a66\u8074/BGM\u3011"),te()())}function XY(t,n){if(1&t&&(Ge(0),xe(1,YY,3,0,"span",18),xe(2,ZY,3,0,"span",18),qe()),2&t){const e=ge().$implicit,i=ge();W(1),re("ngIf",e!=(null==i.auditionPlayer?null:i.auditionPlayer.audio)||e==(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&(null==i.auditionPlayer?null:i.auditionPlayer.paused)),W(1),re("ngIf",e===(null==i.auditionPlayer?null:i.auditionPlayer.audio)&&!(null!=i.auditionPlayer&&i.auditionPlayer.paused))}}const QY=function(t){return{last:t}};function JY(t,n){if(1&t&&(X(0,"div",16),xe(1,VY,6,1,"button",17),xe(2,GY,6,1,"button",17),xe(3,qY,4,1,"button",17),xe(4,WY,4,1,"button",17),xe(5,KY,3,0,"span",18),xe(6,XY,3,2,"ng-container",19),X(7,"span",20),be(8),te()()),2&t){const e=n.$implicit,i=n.last,r=ge();re("ngClass",ct(10,QY,i)),W(1),re("ngIf",e!==(null==r.auditionPlayer?null:r.auditionPlayer.audio)||(null==r.auditionPlayer?null:r.auditionPlayer.paused)),W(1),re("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)),W(1),re("ngIf",e!==(null==r.jukebox?null:r.jukebox.audio)),W(1),re("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),W(1),re("ngIf",e===(null==r.auditionPlayer?null:r.auditionPlayer.audio)&&!(null!=r.auditionPlayer&&r.auditionPlayer.paused)&&e!=(null==r.jukebox?null:r.jukebox.audio)),W(1),re("ngIf",e===(null==r.jukebox?null:r.jukebox.audio)),W(1),Je("font-weight",e===(null==r.jukebox?null:r.jukebox.audio)?"bolder":"normal"),W(1),Ze(e.name)}}function eZ(t,n){1&t&&(X(0,"div",24)(1,"small")(2,"b"),be(3,"\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u3053\u3053\u306b\u8868\u793a\u3055\u308c\u307e\u3059\u3002"),te()()())}let tZ=(()=>{class t{constructor(e,i,r){this.modalService=e,this.panelService=i,this.ngZone=r,this.auditionPlayer=new kt,this.lazyUpdateTimer=null}get volume(){return kt.volume}set volume(e){kt.volume=e,Fe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get auditionVolume(){return kt.auditionVolume}set auditionVolume(e){kt.auditionVolume=e,Fe.trigger("CHANGE_JUKEBOX_VOLUME",null)}get audios(){return Ft.instance.audios.filter(e=>!e.isHidden)}get jukebox(){return rt.instance.get("Jukebox")}get percentAuditionVolume(){return Math.floor(100*kt.auditionVolume)}set percentAuditionVolume(e){kt.auditionVolume=e/100}get percentVolume(){return Math.floor(100*kt.volume)}set percentVolume(e){kt.volume=e/100}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9"),this.auditionPlayer.volumeType=Ua.AUDITION,Fe.register(this).on("*",e=>{e.eventName.startsWith("FILE_")&&this.lazyNgZoneUpdate()})}ngOnDestroy(){Fe.unregister(this),this.stop()}play(e){this.auditionPlayer.play(e)}stop(){this.auditionPlayer.stop()}playBGM(e){this.jukebox.play(e.identifier,!0)}stopBGM(e){this.jukebox.audio===e&&this.jukebox.stop()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Ao.instance.load(r),i.value=""}lazyNgZoneUpdate(){null===this.lazyUpdateTimer&&(this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,this.ngZone.run(()=>{})},100))}}return t.\u0275fac=function(e){return new(e||t)(Oe(kn),Oe(Tn),Oe(bn))},t.\u0275cmp=qt({type:t,selectors:[["app-jukebox"]],decls:52,vars:10,consts:[[1,"header",2,"position","sticky","top","0px"],[1,"self-only"],[1,"material-icons",2,"font-size","22px"],["type","range","min","0","max","1","step","0.01",2,"width","53%",3,"ngModel","title","ngModelChange"],[2,"white-space","nowrap"],["type","number","min","0","max","100","step","1",2,"width","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","3px"],[2,"margin-bottom","3px"],["class","box","style","white-space: nowrap; text-overflow: ellipsis; overflow: hidden",3,"ngClass",4,"ngFor","ngForOf"],["style","padding: 1em 0px; text-align: center",4,"ngIf"],[1,"drop-zone"],[1,"material-icons","large-font"],[1,"small-font"],["type","file","multiple","","accept","audio/*",2,"display","none",3,"change"],[2,"font-size","12px","margin-top","3px"],[2,"font-size","12px"],[1,"box",2,"white-space","nowrap","text-overflow","ellipsis","overflow","hidden",3,"ngClass"],[3,"disabled","click",4,"ngIf"],["style","padding-left: 2px",4,"ngIf"],[4,"ngIf"],[2,"padding-left","2px"],[3,"disabled","click"],[1,"material-icons"],[1,"self-only",2,"font-size","larger"],[2,"padding","1em 0px","text-align","center"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div")(2,"b"),be(3,"\u8a66\u8074\u97f3\u91cf"),X(4,"sup",1),be(5,"*"),te(),be(6,"\uff1a"),te(),X(7,"i",2),be(8),te(),X(9,"input",3),Ie("ngModelChange",function(s){return i.auditionVolume=s}),te(),X(10,"span",4)(11,"input",5),Ie("ngModelChange",function(s){return i.percentAuditionVolume=s}),te(),X(12,"b",6),be(13,"%"),te()()(),X(14,"div")(15,"b"),be(16,"\u518d\u751f\u97f3\u91cf"),X(17,"sup",1),be(18,"*"),te(),be(19,"\uff1a"),te(),X(20,"i",2),be(21),te(),X(22,"input",3),Ie("ngModelChange",function(s){return i.volume=s}),te(),X(23,"span",4)(24,"input",5),Ie("ngModelChange",function(s){return i.percentVolume=s}),te(),X(25,"b",6),be(26,"%"),te()()()(),X(27,"div",7),xe(28,JY,9,12,"div",8),xe(29,eZ,4,0,"div",9),te(),X(30,"label")(31,"div",10)(32,"div")(33,"i",11),be(34,"playlist_add"),te()(),X(35,"div"),be(36,"\u3053\u3053\u306b\u97f3\u697d\u3092\u30c9\u30ed\u30c3\u30d7"),te(),X(37,"div",12),be(38,"\u307e\u305f\u306f\u3053\u3053\u3092\u30af\u30ea\u30c3\u30af\u3057\u3066\u9078\u629e"),te(),X(39,"input",13),Ie("change",function(s){return i.handleFileSelect(s)}),te(),X(40,"div",12),nt(41,"br"),be(42,"\uff11\u30d5\u30a1\u30a4\u30eb\u306b\u3064\u304d10MB\u307e\u3067"),te()()(),X(43,"div",14),be(44,"\u203b\u300c\u8a66\u8074"),X(45,"sup",1),be(46,"*"),te(),be(47,"\u300d\u306f\u81ea\u5206\u306e\u30b9\u30d4\u30fc\u30ab\u30fc\u3060\u3051\u3067\u97f3\u697d\u30921\u56de\u518d\u751f\u3057\u307e\u3059\u3002"),te(),X(48,"div",15),be(49,"\u203b\u300cBGM\u300d\u306f\u30eb\u30fc\u30e0\u5185\u306e\u5168\u54e1\u30671\u3064\u306e\u97f3\u697d\u3092\u30eb\u30fc\u30d7\u518d\u751f\u3057\u307e\u3059\u3002"),te(),X(50,"div",15),be(51,"\u203b\u73fe\u884c\u30d0\u30fc\u30b8\u30e7\u30f3\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u3002\uff08\u6bce\u56de\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u304c\u5fc5\u8981\u3067\u3059\uff09"),te()),2&e&&(W(8),Ze(0==i.auditionVolume?"volume_off":i.auditionVolume<=.5?"volume_down":"volume_up"),W(1),it("title",i.percentAuditionVolume+"%"),re("ngModel",i.auditionVolume),W(2),re("ngModel",i.percentAuditionVolume),W(10),Ze(0==i.volume?"volume_off":i.volume<=.5?"volume_down":"volume_up"),W(1),it("title",i.percentVolume+"%"),re("ngModel",i.volume),W(2),re("ngModel",i.percentVolume),W(4),re("ngForOf",i.audios),W(1),re("ngIf",i.audios.length<1))},directives:[fs,si,oi,ei,Co,yo,ds,Jn,jn,gn],styles:['[_nghost-%COMP%]{display:block}.drop-zone[_ngcontent-%COMP%]{border:2px dashed #555;border-radius:5px;padding:25px;text-align:center;font:24px bold "Vollkorn";color:#444;cursor:pointer}.large-font[_ngcontent-%COMP%]{font-size:64px}.small-font[_ngcontent-%COMP%]{font-size:12px}.box[_ngcontent-%COMP%]{font-size:smaller;border-bottom:1px dotted #888;vertical-align:baseline}.box.last[_ngcontent-%COMP%]{border-bottom:0px none transparent}.volume[_ngcontent-%COMP%]{display:inline-block;width:3em;text-align:right}input[type=number][_ngcontent-%COMP%]{text-align:right}.self-only[_ngcontent-%COMP%]{color:red}button[_ngcontent-%COMP%]   .self-only[_ngcontent-%COMP%]{vertical-align:text-top}.box[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:12px;height:26px;width:5.6em;margin-left:0;margin-right:0}button[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:12px}.header[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:dotted 1px #888}']}),t})();const nZ=["content"],iZ=["*"];let rZ=(()=>{class t{constructor(e){this.modalService=e}clickBackground(e){e.target===e.currentTarget&&this.resolve()}resolve(){this.modalService.resolve(null)}reject(){this.modalService.reject()}}return t.\u0275fac=function(e){return new(e||t)(Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["modal"]],viewQuery:function(e,i){if(1&e&&dn(nZ,7,Pr),2&e){let r;un(r=fn())&&(i.content=r.first)}},ngContentSelectors:iZ,decls:13,vars:3,consts:[[1,"component"],[1,"modal-background",3,"click"],[1,"modal-panel"],[1,"title"],[1,"title-button"],[3,"click"],[1,"material-icons",2,"font-size","14px"],[1,"scrollable-panel"],["content",""]],template:function(e,i){1&e&&(c_(),X(0,"div",0)(1,"div",1),Ie("click",function(s){return i.clickBackground(s)}),te(),X(2,"div",2)(3,"div",3)(4,"div",4)(5,"button",5),Ie("click",function(){return i.resolve()}),X(6,"i",6),be(7,"close"),te()()(),be(8),te(),X(9,"div",7),u_(10),nt(11,"div",null,8),te()()()),2&e&&(W(1),re("@bgInOut","in"),W(1),re("@flyInOut","in"),W(6),An(" ",i.modalService.title," "))},styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;top:0;bottom:0;left:0;right:0;z-index:1899999;display:flex;align-items:center;justify-content:center;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.modal-background[_ngcontent-%COMP%]{box-sizing:border-box;position:absolute;color:#ccc;background-color:#1e1e1e4d;top:0;bottom:0;left:0;right:0;z-index:-1}.modal-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:hidden;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;height:auto;max-height:calc(100% - 10px);width:800px;max-width:100%}.title[_ngcontent-%COMP%]{position:relative;overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#ccc;color:#444}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#444}.header[_ngcontent-%COMP%], .content[_ngcontent-%COMP%], footer[_ngcontent-%COMP%]{padding:10px}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;max-height:calc(100vh - 41px);width:100%;padding:8px}"],data:{animation:[yn("flyInOut",[Nt("void => *",[Dt("100ms ease-out",Qt([We({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),We({transform:"scale(1.0, 1.0)",opacity:"1.0",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale(0, 0)"}))])]),yn("bgInOut",[Qh("in",We({"background-color":"rgba(30, 30, 30, 0.4)"})),Nt("void => *",[We({"background-color":"rgba(30, 30, 30, 0.0)"}),Dt(200)]),Nt("* => void",[Dt(200,We({"background-color":"rgba(30, 30, 30, 0.0)"}))])])]}}),t})();var Jt=(()=>(function(t){t.N="n",t.E="e",t.W="w",t.S="s",t.NE="ne",t.NW="nw",t.SE="se",t.SW="sw"}(Jt||(Jt={})),Jt))();class sZ{constructor(n,e){this.target=n,this.type=e,this.input=null,this.handle=null,this.width=12,this.initialize()}initialize(){this.handle=this.target.ownerDocument.createElement("div"),this.handle.classList.add("ui-resize-handler-"+this.type),this.input=new so(this.handle),this.target.appendChild(this.handle);let n=this.handle.style;switch(n.position="absolute",n.zIndex="1",n.backgroundColor="transparent",this.type){case Jt.N:n.top=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case Jt.E:n.top="0px",n.bottom="0px",n.right=3*-this.width/4+"px",n.width=`${this.width}px`;break;case Jt.W:n.top="0px",n.bottom="0px",n.left=3*-this.width/4+"px",n.width=`${this.width}px`;break;case Jt.S:n.bottom=3*-this.width/4+"px",n.left="0px",n.right="0px",n.height=`${this.width}px`;break;case Jt.NE:n.top=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case Jt.NW:n.top=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case Jt.SE:n.bottom=3*-this.width/4+"px",n.right=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2";break;case Jt.SW:n.bottom=3*-this.width/4+"px",n.left=3*-this.width/4+"px",n.width=3*this.width/2+"px",n.height=3*this.width/2+"px",n.zIndex="2"}this.cursor(!0)}destroy(){this.handle.remove(),this.input.destroy()}cursor(n){let e=this.handle.style;if(n)switch(this.type){case Jt.N:e.cursor="ns-resize";break;case Jt.E:case Jt.W:e.cursor="ew-resize";break;case Jt.S:e.cursor="ns-resize";break;case Jt.NE:e.cursor="nesw-resize";break;case Jt.NW:case Jt.SE:e.cursor="nwse-resize";break;case Jt.SW:e.cursor="nesw-resize"}else e.cursor="default"}able(n){let e=this.handle.style;if("horizontal"!==n&&"vertical"!==n)e.pointerEvents="auto";else switch(this.type){case Jt.N:e.pointerEvents="vertical"===n?"auto":"none";break;case Jt.E:case Jt.W:e.pointerEvents="horizontal"===n?"auto":"none";break;case Jt.S:e.pointerEvents="vertical"===n?"auto":"none";break;case Jt.NE:case Jt.NW:case Jt.SE:case Jt.SW:e.pointerEvents="none"}}}let oZ=(()=>{class t{constructor(e,i){this.ngZone=e,this.elementRef=i,this.boundsSelector="body",this.stackSelector="",this.minWidth=100,this.minHeight=100,this.ostart=new vn,this.onmove=new vn,this.onend=new vn,this.handleMap=new Map,this.handleTypes=[Jt.N,Jt.E,Jt.W,Jt.S,Jt.NE,Jt.NW,Jt.SE,Jt.SW],this.startPosition={left:0,top:0,width:0,height:0},this.startPointer={x:0,y:0,z:0},this.prevTrans={left:0,top:0,width:0,height:0},this._isDisable=!1,this._align="normal"}set isDisable(e){this._isDisable=e,this.handleMap.forEach(i=>i.cursor(!e))}get isDisable(){return this._isDisable}set align(e){this._align=e,this.handleMap.forEach(i=>i.able(e))}get align(){return this._align}ngAfterViewInit(){this.initialize(),this.setForeground()}ngOnDestroy(){this.cancel(),this.destroy()}initialize(){this.ngZone.runOutsideAngular(()=>{this.handleTypes.forEach(e=>{let i=new sZ(this.elementRef.nativeElement,e);this.handleMap.set(e,i),i.input.onStart=r=>this.onResizeStart(r,i),i.input.onMove=r=>this.onResizeMove(r,i),i.input.onEnd=r=>this.onResizeEnd(r,i),i.input.onContextMenu=r=>this.onContextMenu(r,i),i.able(this.align)})})}cancel(){this.handleMap.forEach(e=>e.input.cancel())}destroy(){this.handleMap.forEach(e=>e.input.destroy())}onResizeStart(e,i){return this.isDisable||1===e.button||2===e.button?this.cancel():(this.setForeground(),this.handleMap.forEach(r=>{r!==i&&r.input.cancel()}),this.startPosition=this.calcElementPosition(this.elementRef.nativeElement),this.startPointer=i.input.pointer,this.prevTrans={left:0,top:0,width:0,height:0},void e.stopPropagation())}onResizeMove(e,i){let r={left:0,top:0,width:i.input.pointer.x-this.startPointer.x,height:i.input.pointer.y-this.startPointer.y};switch(i.type){case Jt.N:case Jt.S:r.width=0;break;case Jt.E:case Jt.W:r.height=0}switch(i.type){case Jt.SW:r.left=r.width,r.width*=-1;break;case Jt.NE:r.top=r.height,r.height*=-1;break;case Jt.E:case Jt.S:case Jt.SE:break;case Jt.N:case Jt.W:case Jt.NW:r.left=r.width,r.top=r.height,r.width*=-1,r.height*=-1}r.width+this.startPosition.width<this.minWidth&&(r.width=this.minWidth-this.startPosition.width,r.left=0!==r.left?-r.width:r.left),r.height+this.startPosition.height<this.minHeight&&(r.height=this.minHeight-this.startPosition.height,r.top=0!==r.top?-r.height:r.top);let o=this.calcCorrectionPosition({left:r.left-this.prevTrans.left,top:r.top-this.prevTrans.top,width:r.width-this.prevTrans.width,height:r.height-this.prevTrans.height});r.left+=o.left,r.top+=o.top,r.width+=o.width,r.height+=o.height,this.elementRef.nativeElement.style.left=r.left+this.startPosition.left+"px",this.elementRef.nativeElement.style.top=r.top+this.startPosition.top+"px",this.elementRef.nativeElement.style.width=r.width+this.startPosition.width+"px",this.elementRef.nativeElement.style.height=r.height+this.startPosition.height+"px",this.prevTrans=r,e.cancelable&&e.preventDefault(),e.stopPropagation()}onResizeEnd(e,i){i.input.isDragging&&e.cancelable&&e.preventDefault(),e.stopPropagation()}onContextMenu(e,i){e.stopPropagation()}calcCorrectionPosition(e={left:0,top:0,width:0,height:0}){let i={left:0,top:0,width:0,height:0},r=this.elementRef.nativeElement.getBoundingClientRect(),s=this.elementRef.nativeElement.ownerDocument.querySelector(this.boundsSelector).getBoundingClientRect();return s.right<r.right+e.left+e.width&&(i.width+=s.right-(r.right+e.left+e.width)),r.left+e.left<s.left&&(i.left+=s.left-(r.left+e.left),i.width-=i.left),s.bottom<r.bottom+e.top+e.height&&(i.height+=s.bottom-(r.bottom+e.top+e.height)),r.top+e.top<s.top&&(i.top+=s.top-(r.top+e.top),i.height-=i.top),i}calcElementPosition(e){let i=window.getComputedStyle(e);return{left:Si.relation(i.left,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),top:Si.relation(i.top,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight),width:Si.relation(i.width,e.parentElement.offsetWidth,.5*e.parentElement.offsetWidth),height:Si.relation(i.height,e.parentElement.offsetHeight,.5*e.parentElement.offsetHeight)}}setForeground(){if(this.stackSelector.length<1)return;let e=this.elementRef.nativeElement.ownerDocument.querySelectorAll(this.stackSelector),i=0,r=99999;e.forEach(s=>{let o=parseInt(s.style.zIndex);i<o&&(i=o),o<r&&(r=o)}),!(i<=parseInt(this.elementRef.nativeElement.style.zIndex))&&(e.forEach(s=>{s.style.zIndex=parseInt(s.style.zIndex)-r+""}),this.elementRef.nativeElement.style.zIndex=i+1+"")}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(pi))},t.\u0275dir=Gt({type:t,selectors:[["","appResizable",""]],inputs:{isDisable:["resizable.disable","isDisable"],boundsSelector:["resizable.bounds","boundsSelector"],stackSelector:["resizable.stack","stackSelector"],minWidth:["resizable.minWidth","minWidth"],minHeight:["resizable.minHeight","minHeight"],align:["resizable.align","align"]},outputs:{ostart:"resizable.start",onmove:"resizable.move",onend:"resizable.end"}}),t})();const aZ=["draggablePanel"],lZ=["scrollablePanel"],cZ=["content"],uZ=["titleBar"];function dZ(t,n){if(1&t){const e=Ye();X(0,"button",11),Ie("click",function(){return ke(e),ge().toggleRotate()}),X(1,"i",12),be(2,"pivot_table_chart"),te()()}}function fZ(t,n){if(1&t){const e=Ye();X(0,"button",13),Ie("click",function(){return ke(e),ge().toggleMinimize()}),X(1,"i",14),be(2),te()()}if(2&t){const e=ge();W(1),Je("font-size",e.isMinimized?12:14,"px"),W(1),Ze(e.isMinimized?"crop_din":"minimize")}}function hZ(t,n){if(1&t){const e=Ye();X(0,"button",13),Ie("click",function(){return ke(e),ge().toggleFullScreen()}),X(1,"i",14),be(2),te()()}if(2&t){const e=ge();W(1),Je("font-size",e.isFullScreen&&!e.isMinimized?12:14,"px"),W(1),Ze(e.isFullScreen?e.isMinimized?"minimize":"crop_din":"fullscreen")}}function pZ(t,n){if(1&t){const e=Ye();X(0,"button",13),Ie("click",function(){return ke(e),ge().close()}),X(1,"i",12),be(2,"close"),te()()}}const gZ=function(t,n,e,i){return{"pointer-events-none":t,"is-full-screen":n,"is-minimized":e,"i-am-gm":i}},mZ=function(t){return{rotateble:t}},_Z=function(t,n){return{overlay:t,horizontal:n}},$Z=["*"];let jI=(()=>{class t{constructor(e,i){this.panelService=e,this.pointerDeviceService=i,this.rotateEvent=new vn,this.showTitleButtons=!0,this.preLeft=0,this.preTop=0,this.preWidth=100,this.preHeight=100,this.horizontalWidth=1032,this.horizontalHeight=100,this.verticalWidth=0,this.verticalHeight=0,this.isMinimized=!1,this.isFullScreen=!1,this.isHorizontal=!1}set title(e){this.panelService.title=e}set left(e){this.panelService.left=e}set top(e){this.panelService.top=e}set width(e){this.panelService.width=e}set height(e){this.panelService.height=e}set isAbleMinimizeButton(e){this.panelService.isAbleMinimizeButton=e}set isAbleFullScreenButton(e){this.panelService.isAbleFullScreenButton=e}set isAbleCloseButton(e){this.panelService.isAbleCloseButton=e}set isAbleRotateButton(e){this.panelService.isAbleRotateButton=e}get title(){return this.panelService.title}get left(){return this.panelService.left}get top(){return this.panelService.top}get width(){return this.panelService.width}get height(){return this.panelService.height}get isAbleMinimizeButton(){return this.panelService.isAbleMinimizeButton}get isAbleFullScreenButton(){return this.panelService.isAbleFullScreenButton}get isAbleCloseButton(){return this.panelService.isAbleCloseButton}get isAbleRotateButton(){return this.panelService.isAbleRotateButton}get isGMMode(){return!!He.myCursor&&He.myCursor.isGMMode}get isPointerDragging(){return this.pointerDeviceService.isDragging}ngOnInit(){this.panelService.scrollablePanel=this.scrollablePanel.nativeElement}toggleMinimize(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=s):(this.verticalWidth=r,this.verticalHeight=s)}this.isMinimized=!this.isMinimized,this.isFullScreen=!1}toggleFullScreen(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;if(e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100),!this.isMinimized&&!this.isFullScreen){const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.horizontalWidth=r,this.horizontalHeight=s):(this.verticalWidth=r,this.verticalHeight=s)}this.isFullScreen=!this.isFullScreen}toggleRotate(){const e=this.draggablePanel.nativeElement,i=this.scrollablePanel.nativeElement;e.style.transition="width 0.1s ease-in-out, height 0.1s ease-in-out",i.style.overflowY="hidden",setTimeout(()=>{e.style.transition=null,i.style.overflowY=null},100);const r=e.offsetWidth,s=e.offsetHeight;this.isHorizontal?(this.isHorizontal=!1,e.style.width=(this.verticalWidth<100?100:this.verticalWidth)+"px",e.style.height=(this.verticalHeight<100?100:this.verticalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.horizontalWidth=r,this.horizontalHeight=s)):(this.isHorizontal=!0,e.style.width=(this.horizontalWidth<100?100:this.horizontalWidth)+"px",e.style.height=(this.horizontalHeight<100?100:this.horizontalHeight)+"px",!this.isMinimized&&!this.isFullScreen&&(this.verticalWidth=r,this.verticalHeight=s)),this.isMinimized=!1,this.isFullScreen=!1,this.rotateEvent.emit(this.isHorizontal)}close(){this.panelService&&this.panelService.close()}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(li))},t.\u0275cmp=qt({type:t,selectors:[["ui-panel"]],viewQuery:function(e,i){if(1&e&&(dn(aZ,7),dn(lZ,7),dn(cZ,7,Pr),dn(uZ,7)),2&e){let r;un(r=fn())&&(i.draggablePanel=r.first),un(r=fn())&&(i.scrollablePanel=r.first),un(r=fn())&&(i.content=r.first),un(r=fn())&&(i.titleBar=r.first)}},inputs:{title:"title",left:"left",top:"top",width:"width",height:"height",isAbleMinimizeButton:"isAbleMinimizeButton",isAbleFullScreenButton:"isAbleFullScreenButton",isAbleCloseButton:"isAbleCloseButton",isAbleRotateButton:"isAbleRotateButton",showTitleButtons:"showTitleButtons"},outputs:{rotateEvent:"rotateEvent"},features:[ii([Tn])],ngContentSelectors:$Z,decls:16,vars:34,consts:[["appDraggable","","appResizable","",1,"draggable-panel",3,"ngClass","resizable.disable","resizable.align","draggable.disable","draggable.stack","resizable.stack"],["draggablePanel",""],[1,"title"],["titleBar",""],["style","padding: 0px; height: 14px; margin-top: 3px; margin-left: 1px",3,"click",4,"ngIf"],[3,"ngClass"],[1,"title-button"],[3,"click",4,"ngIf"],[1,"scrollable-panel",3,"ngClass"],["scrollablePanel",""],["content",""],[2,"padding","0px","height","14px","margin-top","3px","margin-left","1px",3,"click"],[1,"material-icons",2,"font-size","14px"],[3,"click"],[1,"material-icons"]],template:function(e,i){1&e&&(c_(),X(0,"div",0,1)(2,"div",2,3),xe(4,dZ,3,0,"button",4),X(5,"div",5),be(6),te(),X(7,"div",6),xe(8,fZ,3,3,"button",7),xe(9,hZ,3,3,"button",7),xe(10,pZ,3,0,"button",7),te()(),X(11,"div",8,9),u_(13),nt(14,"div",null,10),te()()),2&e&&(Je("left",i.left,"px")("top",i.top,"px")("width",i.width,"px")("height",i.height,"px"),re("@flyInOut","in")("ngClass",Js(24,gZ,i.isPointerDragging,i.isFullScreen,i.isMinimized&&!i.isFullScreen,i.isGMMode))("resizable.disable",i.isMinimized||i.isFullScreen)("resizable.align",i.isAbleRotateButton?i.isHorizontal?"horizontal":"vertical":"normal")("draggable.disable",i.isFullScreen)("draggable.stack",".draggable-panel")("resizable.stack",".draggable-panel"),W(4),re("ngIf",i.isAbleRotateButton),W(1),re("ngClass",ct(29,mZ,i.isAbleRotateButton)),W(1),Ze(i.panelService.title),W(2),re("ngIf",i.isAbleMinimizeButton),W(1),re("ngIf",i.isAbleFullScreenButton),W(1),re("ngIf",i.isAbleCloseButton),W(1),Je("display",i.isMinimized&&!i.isFullScreen?"none":null),re("ngClass",cn(31,_Z,i.isAbleRotateButton,i.isHorizontal)))},directives:[O0,oZ,jn,gn],styles:["[_nghost-%COMP%]{display:block}.draggable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:visible;position:absolute;color:#444;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:solid 1px #999;padding:0;top:200px;height:200px;width:300px;max-height:100%;max-width:100%;cursor:-webkit-grab;cursor:grab}.scrollable-panel[_ngcontent-%COMP%]{box-sizing:border-box;overflow:auto;position:absolute;top:25px;bottom:0;width:100%;padding:8px;overscroll-behavior:contain;-webkit-overflow-scrolling:touch}.title[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;box-sizing:border-box;font-size:12px;height:25px;padding:2px 5px;width:100%;background-color:#555;color:#ccc;-webkit-user-select:none;-moz-user-select:none;user-select:none}.title-button[_ngcontent-%COMP%]{position:absolute;right:0;top:0}.title[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;border-radius:0;outline:none;color:#ccc}.pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}@media screen and (-webkit-min-device-pixel-ratio: 0){.scrollable-panel.overlay[_ngcontent-%COMP%]{overflow:overlay}}.scrollable-panel.horizontal[_ngcontent-%COMP%]{overflow-x:auto;overflow-y:hidden}.rotateble[_ngcontent-%COMP%]{display:inline;top:-3px;position:relative}.is-minimized[_ngcontent-%COMP%]{height:27px!important}.is-full-screen[_ngcontent-%COMP%]{left:0px!important;top:0px!important;width:100vw!important;height:100vh!important;cursor:default}.draggable-panel.is-full-screen[_ngcontent-%COMP%]{border:0px none}.draggable-panel.i-am-gm[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,208,208,.9),rgba(255,236,236,.9))}"],data:{animation:[yn("flyInOut",[Nt("void => *",[Dt("100ms ease-out",Qt([We({transform:"scale(0.8, 0.8)",opacity:"0",offset:0}),We({transform:"scale(1.0, 1.0)",opacity:"1",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale(0, 0)"}))])])]}}),t})();const vZ=["standImageElement"],bZ=["dialogElement"],yZ=function(t){return{"emote-secret":t}};function CZ(t,n){if(1&t&&(X(0,"div",12),be(1),te()),2&t){const e=ge(3);Je("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("width",e.imageWidth,"px")("font-size",e.imageWidth/4.5>16?e.imageWidth/4.5:16,"px")("color",e.color?e.color:"#444")("bottom",e.emoteCssBottom,"px"),re("@fadeAndScaleInOut",void 0)("ngClass",ct(13,yZ,e.isSecret)),W(1),Ze(e.gameCharacter.text)}}const xZ=function(t,n){return{"transform-origin":t,transform:n}},wZ=function(t){return{inverse:t}},EZ=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}},TZ=function(t,n){return{"black-paint":t,hollow:n}};function IZ(t,n){if(1&t){const e=Ye();Ge(0),xe(1,CZ,2,15,"div",5),X(2,"div",6)(3,"div",7)(4,"div",8)(5,"div",9)(6,"img",10,11),Ie("load",function(){return ke(e),ge(2).onImageLoad()}),bt(8,"safe"),te()()()()(),qe()}if(2&t){const e=ge(2);W(1),re("ngIf",!e.isBackyard&&e.gameCharacter.isEmote),W(1),re("ngStyle",cn(11,xZ,e.standImageTransformOrigin,e.isApplyRoll?"rotate("+e.gameCharacter.roll+"deg)":"")),W(1),re("ngClass",ct(14,wZ,e.isApplyImageEffect&&e.gameCharacter.isInverse)),W(1),re("ngClass",vo(16,EZ,e.isApplyImageEffect&&0==e.gameCharacter.aura,e.isApplyImageEffect&&1==e.gameCharacter.aura,e.isApplyImageEffect&&2==e.gameCharacter.aura,e.isApplyImageEffect&&3==e.gameCharacter.aura,e.isApplyImageEffect&&4==e.gameCharacter.aura,e.isApplyImageEffect&&5==e.gameCharacter.aura,e.isApplyImageEffect&&6==e.gameCharacter.aura,e.isApplyImageEffect&&7==e.gameCharacter.aura)),W(2),Je("height",e.height>0?e.height+"vh":"auto"),re("src",yt(8,8,e.standImage.url,"resourceUrl"),Xt)("ngClass",cn(25,TZ,e.isApplyImageEffect&&e.gameCharacter.isBlackPaint,e.isApplyImageEffect&&e.gameCharacter.isHollow))}}const SZ=function(t,n,e,i){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,secret:i}};function kZ(t,n){if(1&t){const e=Ye();X(0,"div",3),Ie("click",function(){ke(e);const r=ge();return r.toGhostly(),r.toBackyard()}),xe(1,IZ,9,28,"ng-container",4),te()}if(2&t){const e=ge();Je("left",e.position+"%")("height",0==e.height?"":e.height+"vh")("margin-left",-e.imageWidth/2,"px")("margin-bottom",e.adjustY,"px"),re("@standInOut",e.groupValue)("ngClass",Js(11,SZ,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret)),W(1),re("ngIf",e.gameCharacter&&e.standImage.url&&e.standImage.url.length>0)}}const MZ=function(t,n,e){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e}};function DZ(t,n){if(1&t&&(X(0,"span",13)(1,"b"),be(2),te()()),2&t){const e=ge();Je("color",e.color?e.color:"#444")("left",e.position+"%")("margin-bottom",e.adjustY>0?e.adjustY:0,"px")("border-color",e.color?e.color:"#444")("margin-left",e.nameTagCSSMarginLeft,"px"),re("ngClass",qr(12,MZ,e.isCanBeGone,e.isGhostly,e.isBackyard)),W(2),Ze(e.gameCharacter.name)}}const AZ=function(t,n,e){return{left:t,right:n,"transform-origin":e}},PZ=function(t,n,e,i,r,s){return{"is-can-be-gone":t,"is-ghostly":n,backyard:e,"dialog-secret":i,"is-position-right":r,"is-position-left":s}};function NZ(t,n){if(1&t){const e=Ye();X(0,"div",14,15),Ie("click",function(){ke(e);const r=ge();return r.toGhostly(),r.toBackyard()}),X(2,"p",16),Ie("@dialogShake.start",function(r){return ke(e),ge().onSpeaking(r)}),bt(3,"safe"),te()()}if(2&t){const e=ge();Je("visibility",e.isShowStand&&e.isApplyDialog?"visible":"hidden")("color",e.isSecret?"#ccc":e.color?e.color:"#444")("left",e.dialogBoxCSSLeft,"px")("bottom",e.dialogBoxCssBottom>12?e.dialogBoxCssBottom:12,"px")("max-width",e.dialogBoxCSSMaxWidth,"px")("border-color",e.color?e.color:"#444"),re("@fadeAndScaleInOut",void 0)("ngStyle",qr(20,AZ,e.position<=50?e.dialogBoxCSSLeft+"px":"auto",e.position>50?e.dialogBoxCSSRight+"px":"auto",e.position<=50?"12px calc(100% + 12px)":"calc(100% - 12px) calc(100% + 12px)"))("ngClass",y_(24,PZ,e.isCanBeGone,e.isGhostly,e.isBackyard,e.isSecret,e.position<=50,e.position>50)),W(2),re("@dialogShake",e.math.floor(e.dialogText.length/2))("innerHTML",yt(3,17,e.dialogText,"html"),Ui)}}let Oo=(()=>{class t{constructor(e){this.ngZone=e,this._imageFile=Lt.Empty,this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!1,this.isSecret=!1,this.standImageTransformOrigin="center",this.naturalWidth=0,this.naturalHeight=0,this.isSpeaking=!1,this.math=Math}onSpeaking(e){this.gameCharacter&&this.gameCharacter.text&&(this.isApplyDialog||this.isSpeakable||this.gameCharacter.isShowChatBubble)&&(clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)),this.isSpeakable&&(clearTimeout(this._dialogTimeoutId),this.gameCharacter&&this.gameCharacter.text&&(this.isSpeaking=!0),this._dialogTimeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isSpeaking=!1})},300))}get isShowStand(){return t.isShowStand}get isShowNameTag(){return t.isShowNameTag&&this.isShowName}get isCanBeGone(){return t.isCanBeGone}set dialog(e){if(!this.gameCharacter||"table"===this.gameCharacter.location.name&&!this.gameCharacter.isHideIn||"graveyard"===this.gameCharacter.location.name)return;clearTimeout(this._dialogTimeoutId);let i=et.cr(e.text);const r=et.isEmote(i),s=[],o=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let d,$=0,I=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(d=o.exec(i));){let Be=d.index-3*$;s.push({base:d[1],ruby:d[2],start:Be-I,end:Be+d[1].length-I-1}),$++,I+=d[2].length}let Q=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;Q>200&&(Q=200),this._dialogTimeoutId=setTimeout(()=>{this.gameCharacter.text="",this.gameCharacter.isEmote=!1},Array.from(i).length*Q+6e3),this.gameCharacter.isEmote=r,$=0;let fe=0,_e=0,Ce="",Ee=s.shift(),Re="",Le=!1;if(r)this.gameCharacter.text=i;else{const Be=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this._chatIntervalId=setInterval(()=>{let Ae=Be[$],je=Ae.length>1;if(Ae){if(!Le&&Ee&&fe>=Ee.start&&(Ce+="<ruby>",Le=!0,_e=0),Ce+=et.escapeHtml(Ae),Le){_e+=1;let Ue=Ee.ruby;Re="<rt>"+et.escapeHtml(Array.from(Ue).slice(0,Math.ceil(Array.from(Ue).length*(_e/Array.from(Ee.base).length))).join(""))+"</rt>"}Le&&Ee&&fe>=Ee.end-(je?1:0)&&(Ce+=Re+"</ruby>",Le=!1,Ee=s.shift()),fe+=Ae.length}$+=1,this.gameCharacter.text=Ce+(Le?Re+"</ruby>":""),$>=Be.length&&clearInterval(this._chatIntervalId)},Q)}}get dialogText(){return this.gameCharacter&&this.gameCharacter.text?this.gameCharacter.text.replace(/[\r\n]{2,}/g,"\n\n").replace(/                            /g,"").trim():""}get standImage(){if(!this.standElement)return this._imageFile;let e=null;if(this.isSpeaking&&(e=this.standElement.getFirstElementByName("speakingImageIdentifier")),(!e||!e.value||e.value==Lt.Empty.identifier)&&(e=this.standElement.getFirstElementByName("imageIdentifier")),e&&this._imageFile.identifier!==e.value){let i=It.instance.get(e.value);this._imageFile=i||Lt.Empty}return this._imageFile}get isSpeakable(){if(!this.standElement)return!1;let e=this.standElement.getFirstElementByName("speakingImageIdentifier");return e&&e.value&&e.value!==Lt.Empty.identifier}ngOnInit(){Fe.register(this).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this.dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1}),clearTimeout(this._dialogTimeoutId),clearInterval(this._chatIntervalId))})}ngOnDestroy(){clearTimeout(this._timeoutId),clearTimeout(this._dialogTimeoutId)}get group(){if(!this.gameCharacter)return"";let e=this.standElement.getFirstElementByName("name");return e.currentValue&&e.currentValue.toString().length>0?e.currentValue.toString():""}get groupValue(){let e=0;const i=this.group;for(let r=0;r<i.length;r++)e=(e<<5)-e+i.charCodeAt(r),e|=0;return e}get position(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("position");return e&&e.currentValue?+e.value:this.gameCharacter.standList.position}get adjustY(){if(!this.gameCharacter)return 0;let e=this.standElement.getFirstElementByName("height");return this.imageHeight*(e&&e.currentValue?+e.currentValue:0)/100}get height(){if(!this.gameCharacter||!this.standElement)return 0;let e=this.standElement.getFirstElementByName("height");return e&&0!=+e.value||!this.gameCharacter.standList?e?+e.value:0:this.gameCharacter.standList.height}get imageHeight(){return 0==this.height?this.naturalHeight:document.documentElement.offsetHeight*this.height/100}get imageWidth(){return this.imageHeight*this.naturalWidth/this.naturalHeight}get dialogBoxCSSLeft(){return this.imageWidth*(this.position>50?.33:.66)-this.imageWidth/2-12+this.position*document.documentElement.clientWidth/100-(this.position>50?this.dialogBoxCSSMaxWidth:0)}get dialogBoxCSSRight(){return document.documentElement.clientWidth-this.dialogBoxCSSLeft-this.dialogBoxCSSMaxWidth}get dialogBoxCSSMaxWidth(){let e=this.imageWidth/document.documentElement.clientWidth;return e/=2,e<.14&&(e=.14),e*document.documentElement.clientWidth}get dialogBoxCssBottom(){let e=.66*this.imageHeight+this.adjustY;return e<48&&(e=48),this.dialogElement&&e>document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight&&(e=document.documentElement.offsetHeight-this.dialogElement.nativeElement.clientHeight),e}get emoteCssBottom(){let e=.66*this.imageHeight+(this.imageWidth/4.5>16?this.imageWidth/4.5:16);return e<0&&(e=0),e}get nameTagCSSMarginLeft(){let e=this.imageWidth/2-this.position*document.documentElement.clientWidth/100;return e<32&&(e=32),-this.imageWidth/2+e}get isApplyImageEffect(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyImageEffect");return!(!e||!e.value)}get isApplyRoll(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyRoll");return!(!e||!e.value)}get isApplyDialog(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("applyDialog");return!(!e||!e.value)}get isShowName(){if(!this.standElement||!this.gameCharacter)return!1;let e=this.standElement.getFirstElementByName("showName");return!(!e||!e.value)}calcStandImageTransformOrigin(){return"center 66%"}toGhostly(){this.ngZone.run(()=>{this.isGhostly=!0})}toBackyard(){this.ngZone.run(()=>{this.isBackyard=!0})}toFront(){this.ngZone.run(()=>{this.isFarewell=!1,this.isGhostly=!1,this.isBackyard=!1,this.isVisible=!0}),clearTimeout(this._timeoutId),this._timeoutId=setTimeout(()=>{this.ngZone.run(()=>{this.isVisible=!1})},12e3)}toFarewell(){this.ngZone.run(()=>{this.isFarewell=!0,this.isVisible=!1})}onImageLoad(){this.naturalWidth=this.standImageElement.nativeElement.naturalWidth,this.naturalHeight=this.standImageElement.nativeElement.naturalHeight,this.standImageTransformOrigin=this.calcStandImageTransformOrigin()}}return t.isShowStand=!0,t.isShowNameTag=!0,t.isCanBeGone=!0,t.\u0275fac=function(e){return new(e||t)(Oe(bn))},t.\u0275cmp=qt({type:t,selectors:[["stand-image"]],viewQuery:function(e,i){if(1&e&&(dn(vZ,5),dn(bZ,5)),2&e){let r;un(r=fn())&&(i.standImageElement=r.first),un(r=fn())&&(i.dialogElement=r.first)}},inputs:{gameCharacter:"gameCharacter",standElement:"standElement",color:"color"},decls:4,vars:7,consts:[["class","stand-image-container",3,"left","height","margin-left","margin-bottom","ngClass","click",4,"ngIf"],["class","name-tag","style","pointer-events: none;",3,"color","ngClass","left","margin-bottom","border-color","margin-left",4,"ngIf"],["class","name-tag dialog chat-bubble-buyo","style","margin-left: 12px; min-width: 5em; white-space: pre-wrap; font-size: 14px; pointer-events: none;",3,"visibility","color","left","bottom","max-width","ngStyle","ngClass","border-color","click",4,"ngIf"],[1,"stand-image-container",3,"ngClass","click"],[4,"ngIf"],["class","emote chat-bubble-buyo","style","position: absolute; pointer-events: none; text-align: center; margin-top: -1em",3,"visibility","width","font-size","color","bottom","ngClass",4,"ngIf"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"color-fillter"],["draggable","false",1,"stand-image",3,"src","ngClass","load"],["standImageElement",""],[1,"emote","chat-bubble-buyo",2,"position","absolute","pointer-events","none","text-align","center","margin-top","-1em",3,"ngClass"],[1,"name-tag",2,"pointer-events","none",3,"ngClass"],[1,"name-tag","dialog","chat-bubble-buyo",2,"margin-left","12px","min-width","5em","white-space","pre-wrap","font-size","14px","pointer-events","none",3,"ngStyle","ngClass","click"],["dialogElement",""],[2,"width","100%",3,"innerHTML"]],template:function(e,i){1&e&&(X(0,"div"),xe(1,kZ,2,16,"div",0),xe(2,DZ,3,16,"span",1),xe(3,NZ,4,31,"div",2),te()),2&e&&(Je("visibility",i.isShowStand?"visible":"hidden")("pointer-events",i.isShowStand?"auto":"none"),W(1),re("ngIf",!i.isFarewell&&(i.isVisible||!i.isCanBeGone)),W(1),re("ngIf",i.isShowStand&&!i.isFarewell&&(i.isVisible||!i.isCanBeGone)&&i.isShowNameTag&&i.gameCharacter&&i.gameCharacter.name),W(1),re("ngIf",!i.isFarewell&&i.isVisible&&!i.isBackyard&&i.gameCharacter&&i.gameCharacter.text&&!i.gameCharacter.isEmote))},directives:[gn,jn,Ji],pipes:[Yn],styles:['.stand-image-container[_ngcontent-%COMP%]{position:absolute;display:inline-block;bottom:-.1%;z-index:1000000;transition:opacity .1s ease-in}.is-ghostly[_ngcontent-%COMP%]{z-index:900000}.is-can-be-gone.is-ghostly[_ngcontent-%COMP%]{opacity:.5;filter:brightness(.5)}.backyard[_ngcontent-%COMP%]{pointer-events:none;z-index:0}.name-tag[_ngcontent-%COMP%]{color:#444;background-color:#f5f5f5;border:2px solid #444;border-radius:24px;padding:4px 12px;bottom:2px;display:inline-block;white-space:nowrap;position:absolute;font-size:16px;opacity:.9;z-index:1000005}.name-tag.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.is-can-be-gone.name-tag.is-ghostly[_ngcontent-%COMP%]{opacity:.5}.name-tag.backyard[_ngcontent-%COMP%]{z-index:1}.is-can-be-gone.is-ghostly.backyard[_ngcontent-%COMP%]{opacity:.25}.secret[_ngcontent-%COMP%]   .color-fillter[_ngcontent-%COMP%]{filter:grayscale(80%)}.name-tag.dialog[_ngcontent-%COMP%]{border-radius:24px 24px 24px 12px}.name-tag.dialog-secret[_ngcontent-%COMP%]{border-radius:24px 12px;background:rgba(85,85,85,.9)}.name-tag.dialog.is-position-left[_ngcontent-%COMP%]{border-radius:24px 24px 12px}.name-tag.dialog.dialog-secret.is-position-left[_ngcontent-%COMP%]{border-radius:12px 24px}.emote[_ngcontent-%COMP%]{text-align:center;font-size:48px;font-weight:700;border:none;background:none;-webkit-text-stroke:2px whitesmoke;white-space:pre-wrap;word-break:break-word}.emote.emote-secret[_ngcontent-%COMP%]{-webkit-text-stroke:2px #555}.emote.emote-secret.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.emote[_ngcontent-%COMP%]{z-index:1000005}.emote.is-ghostly[_ngcontent-%COMP%]{z-index:900005}.dialog[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{overflow-wrap:anywhere;word-break:break-word;display:inline-block;margin-top:.5em;margin-bottom:.5em}.dialog.is-position-right[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;left:17px;margin:0 0 0 -12px}.dialog.is-position-left[_ngcontent-%COMP%]:before{box-sizing:border-box;content:"";position:absolute;margin:0 -12px 0 0;padding:0;line-height:1;vertical-align:baseline;bottom:-25px;border:12px solid transparent;border-top-color:inherit;right:17px}.chat-bubble-buyo[_ngcontent-%COMP%]{transition:transform .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s;transform-origin:center bottom}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -8px 8px #fff)}'],data:{animation:[yn("standInOut",[Nt("void => *,:increment,:decrement",[Dt("132ms cubic-bezier(.21,.97,.75,1.25)",Qt([We({opacity:.6,transform:"translateY(48px) scale(0.9)",offset:0}),We({opacity:1,transform:"translateY(0px) scale(1.0)",offset:1})]))]),Nt("* => void,:increment,:decrement",[Dt("132ms ease-out",Qt([We({transform:"translateY(0px) scale(1.0)",offset:0}),We({opacity:0,transform:"translateY(96px) scale(0.9)",offset:1})]))])]),yn("dialogShake",[Nt(":increment",[Dt("19ms ease",Qt([We({transform:"translateX(1px)"})])),Dt("19ms ease",Qt([We({transform:"translateX(-1px)"})]))])]),yn("fadeAndScaleInOut",[Nt("void => *, true => false",[Dt("200ms ease-in-out",Qt([We({transform:"scale3d(0, 0, 0)",opacity:0}),We({transform:"scale3d(0.9, 0.9, 0.9)",opacity:.9})]))]),Nt("* => void, true => false",[Dt("100ms ease-in-out",We({transform:"scale3d(0, 0, 0)",opacity:0}))])])]}}),t})();class Zi{constructor(){}show(n,e,i=null,r=!1){let s=!0;for(const o of Zi.currentStandImageShowing){const d=o[0],$=o[1];if(!$)continue;const I=$.instance;I.isVisible&&n.identifier!=d?I.toGhostly():n.identifier==d&&"graveyard"!=n.location.name?(I.standElement=e,I.color=i||n.chatPalette.color,I.isSecret=r,I.toFront(),s=!1):(I.isFarewell||Oo.isCanBeGone)&&($.destroy(),Zi.currentStandImageShowing.delete(d))}if(s&&"graveyard"!=n.location.name){const o=Zi.defaultParentViewContainerRef.createComponent(Oo);o.instance.gameCharacter=n,o.instance.standElement=e,o.instance.color=i||n.chatPalette.color,o.instance.isSecret=r,o.instance.toFront(),Zi.currentStandImageShowing.set(n.identifier,o)}}farewell(n){n instanceof jt&&(n=n.identifier);const e=Zi.currentStandImageShowing.get(n);e&&e.instance&&e.instance.toFarewell()}destroy(n,e){n instanceof jt&&(n=n.identifier),e instanceof dt&&(e=e.identifier);for(const i of Zi.currentStandImageShowing){const r=i[1];!r||(!r.instance||!r.instance.standElement||r.instance.standElement.identifier==e)&&(r.destroy(),Zi.currentStandImageShowing.delete(n))}}destroyAll(){for(const n of Zi.currentStandImageShowing){const e=n[0],i=n[1];!i||(i.destroy(),Zi.currentStandImageShowing.delete(e))}}}Zi.currentStandImageShowing=new Map,Zi.\u0275fac=function(n){return new(n||Zi)},Zi.\u0275prov=Zt({token:Zi,factory:Zi.\u0275fac,providedIn:"root"});const FZ=["diceRollTableSelecter"];function RZ(t,n){if(1&t&&(X(0,"option",9),be(1),te()),2&t){const e=n.$implicit;Je("color",""==e.name?"gray":""),it("value",e.identifier),it("title",e.name),W(1),Ze(""==e.name?"(\u7121\u540d\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868)":e.name)}}function OZ(t,n){if(1&t&&(X(0,"div",25),be(1),te()),2&t){const e=ge(3);W(1),An("",e.progresPercent,"%")}}const BZ=function(t){return{"is-hidden":t}};function LZ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",18),Ie("click",function(){return ke(e),ge(2).upTabIndex()}),be(2,"\u2191"),te(),X(3,"button",18),Ie("click",function(){return ke(e),ge(2).downTabIndex()}),be(4,"\u2193"),te(),X(5,"div",19)(6,"button",20),Ie("click",function(){return ke(e),ge(2).save()}),X(7,"div",21)(8,"div",22),be(9,"\u4fdd\u5b58"),te(),xe(10,OZ,2,1,"div",23),te()(),X(11,"button",24),Ie("click",function(){return ke(e),ge(2).delete()}),be(12,"\u524a\u9664"),te()(),qe()}if(2&t){const e=ge(2);W(6),re("disabled",e.isSaveing),W(2),re("ngClass",ct(3,BZ,e.isSaveing)),W(2),re("ngIf",e.isSaveing)}}function zZ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",18),Ie("click",function(){return ke(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),te(),qe()}}function jZ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",10)(2,"div",11)(3,"b"),be(4,"name: "),te(),X(5,"input",12),Ie("ngModelChange",function(r){return ke(e),ge().diceRollTableName=r}),te()(),X(6,"div")(7,"span",13)(8,"b"),be(9,"command: "),te(),X(10,"input",14),Ie("ngModelChange",function(r){return ke(e),ge().diceRollTableCommand=r}),te()(),X(11,"span",15)(12,"b"),be(13,"dice: "),te(),X(14,"input",16),Ie("ngModelChange",function(r){return ke(e),ge().diceRollTableDice=r}),te()()()(),X(15,"div")(16,"textarea",17),Ie("ngModelChange",function(r){return ke(e),ge().diceRollTableText=r}),te()(),nt(17,"hr"),X(18,"div"),xe(19,LZ,13,5,"ng-container",8),xe(20,zZ,3,0,"ng-container",8),te(),qe()}if(2&t){const e=ge();W(5),re("ngModel",e.diceRollTableName),Rt("disabled",e.isEditable?null:""),W(5),re("ngModel",e.diceRollTableCommand),Rt("disabled",e.isEditable?null:""),W(4),re("ngModel",e.diceRollTableDice),Rt("disabled",e.isEditable?null:""),W(2),re("ngModel",e.diceRollTableText),Rt("disabled",e.isEditable?null:""),W(3),re("ngIf",!e.isDeleted),W(1),re("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}function UZ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",18),Ie("click",function(){return ke(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),te(),qe()}}function HZ(t,n){if(1&t&&(Ge(0),X(1,"div",26),be(2," \u203b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),xe(3,UZ,3,0,"ng-container",8),te(),qe()),2&t){const e=ge();W(3),re("ngIf",e.isDeleted&&e.selectedDiceRollTableXml)}}let VZ=(()=>{class t{constructor(e,i,r,s){this.pointerDeviceService=e,this.modalService=i,this.panelService=r,this.saveDataService=s,this.selectedDiceRollTable=null,this.selectedDiceRollTableXml="",this.isSaveing=!1,this.progresPercent=0}get diceRollTableName(){return this.selectedDiceRollTable.name}set diceRollTableName(e){this.isEditable&&(this.selectedDiceRollTable.name=e)}get diceRollTableDice(){return this.selectedDiceRollTable.dice}set diceRollTableDice(e){this.isEditable&&(this.selectedDiceRollTable.dice=e)}get diceRollTableCommand(){return this.selectedDiceRollTable.command}set diceRollTableCommand(e){this.isEditable&&(this.selectedDiceRollTable.command=e)}get diceRollTableText(){return this.selectedDiceRollTable.value}set diceRollTableText(e){this.isEditable&&(this.selectedDiceRollTable.value=e)}get diceRollTables(){return ro.instance.children}get isEmpty(){return this.diceRollTables.length<1}get isDeleted(){return!!this.selectedDiceRollTable&&null==rt.instance.get(this.selectedDiceRollTable.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a"),Fe.register(this).on("DELETE_GAME_OBJECT",1e3,e=>{if(!this.selectedDiceRollTable||e.data.identifier!==this.selectedDiceRollTable.identifier)return;let i=rt.instance.get(e.data.identifier);null!==i&&(this.selectedDiceRollTableXml=i.toXml())})}ngAfterViewInit(){this.diceRollTables.length>0&&queueMicrotask(()=>{this.onChangeDiceRollTable(this.diceRollTables[0].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Fe.unregister(this)}onChangeDiceRollTable(e){this.selectedDiceRollTable=rt.instance.get(e),this.selectedDiceRollTableXml=""}create(e="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868"){return ro.instance.addDiceRollTable(e)}add(){const e=this.create();queueMicrotask(()=>{this.onChangeDiceRollTable(e.identifier),this.diceRollTableSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,Yt.Z)(function*(){if(!e.selectedDiceRollTable||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_rollTable_"+e.selectedDiceRollTable.name;yield e.saveDataService.saveGameObjectAsync(e.selectedDiceRollTable,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}saveAll(){var e=this;return(0,Yt.Z)(function*(){e.isSaveing||(e.isSaveing=!0,e.progresPercent=0,yield e.saveDataService.saveGameObjectAsync(ro.instance,"fly_rollTable_All",i=>{e.progresPercent=i}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500))})()}delete(){!this.isEmpty&&this.selectedDiceRollTable&&(this.selectedDiceRollTableXml=this.selectedDiceRollTable.toXml(),this.selectedDiceRollTable.destroy())}restore(){if(this.selectedDiceRollTable&&this.selectedDiceRollTableXml){let e=Gn.instance.parseXml(this.selectedDiceRollTableXml);ro.instance.addDiceRollTable(e),this.selectedDiceRollTableXml="",queueMicrotask(()=>{const i=this.diceRollTables;this.onChangeDiceRollTable(i[i.length-1].identifier),this.diceRollTableSelecter.nativeElement.selectedIndex=i.length-1})}}upTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);0<i&&e.insertBefore(this.selectedDiceRollTable,e.children[i-1])}downTabIndex(){if(!this.selectedDiceRollTable)return;let e=this.selectedDiceRollTable.parent,i=e.children.indexOf(this.selectedDiceRollTable);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedDiceRollTable)}helpDiceRollTable(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(au,{left:e.x,top:e.y,width:600,height:788});r.title="\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u30d8\u30eb\u30d7",r.text="\u3000\u540d\u524d\u3001\u30b3\u30de\u30f3\u30c9\u3001\u632f\u308b\u30c0\u30a4\u30b9\u3092\u8a2d\u5b9a\u3057\u3001\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3067\u8868\u3092\u53c2\u7167\u3057\u3001\u8868\u793a\u3057\u307e\u3059\u3002\n\u3000\u30c1\u30e3\u30c3\u30c8\u3067\u30b3\u30de\u30f3\u30c9\u3092\u9001\u4fe1\u3059\u308b\u3053\u3068\u306b\u3088\u308a\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u3068\u540c\u69d8\u306b\u7d50\u679c\u304c\u9001\u4fe1\u3055\u308c\u307e\u3059\u3002\n\u3000\u8868\u306f1\u884c\u3054\u3068\u306b\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\u300c\u6570\u5b57:\u7d50\u679c\u300d\u306e\u5f62\u3067\u8a18\u8ff0\u3057\u307e\u3059\uff08\u3088\u3063\u3066\u3001\u30c0\u30a4\u30b9\u306f\u6700\u5f8c\u306b\u4e00\u3064\u306e\u6570\u5b57\u3092\u8fd4\u3059\u3082\u306e\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3001\u30d0\u30e9\u30d0\u30e9\u30c0\u30a4\u30b9 nBm\u3001\u500b\u6570\u632f\u308a\u8db3\u3057\u30c0\u30a4\u30b9 nRm\u3001\u4e0a\u65b9\u7121\u9650\u30ed\u30fc\u30eb nUm \u306e\u6210\u529f\u6570\u306b\u3082\u5bfe\u5fdc\u3057\u3066\u3044\u307e\u3059\uff09\u3002\n\u3000\n\u3000-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u307e\u305f\u306f\uff5e\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3082\u3067\u304d\u307e\u3059\u3002\n\u3000\u8868\u306b \\n \u3068\u66f8\u304f\u3068\u3001\u305d\u3053\u3067\u6539\u884c\u3057\u307e\u3059\uff08\\n\u306f\u8868\u793a\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\uff09\n\u3000name: \u906d\u9047\u8266\u7a2e\u3000\n\u3000command: ShipType\u3000\u3000dice: 1d6\n\n\u3000\u30001:\u6226\u8266\n\u3000\u30002:\u7a7a\u6bcd\n\u3000\u30003:\u91cd\u5de1\u6d0b\u8266\n\u3000\u30004:\u8efd\u5de1\u6d0b\u8266\n\u3000\u30005-6:\u99c6\u9010\u8266\n\n\u3000\u8868\u3092\u53c2\u7167\u3059\u308b\u969b\u306f\u5148\u306b\u3042\u308b\u3082\u306e\u304c\u512a\u5148\u3055\u308c\u307e\u3059\u3001\u4e0a\u8a18\u306e\u4f8b\u3067\u306f\u6700\u5f8c\u306e\u884c\u3092\u300c1-6:\u99c6\u9010\u8266\u300d\u306a\u3069\u3068\u3057\u3066\u3082\u540c\u3058\u7d50\u679c\u306b\u306a\u308a\u307e\u3059\uff08\u304c\u3001\u5206\u304b\u308a\u3084\u3059\u3044\u8a18\u8ff0\u3092\u304a\u52e7\u3081\u3057\u307e\u3059\uff09\u3002\n\u3000\u30c7\u30d5\u30a9\u30eb\u30c8\u306e D66 \u306f\u30bd\u30fc\u30c8\u3055\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u306a\u5834\u5408\uff08\u30b5\u30a4\u30b3\u30ed\u30fb\u30d5\u30a3\u30af\u30b7\u30e7\u30f3\u306e\u540d\u524d\u8868\u306a\u3069\uff09\u306f\u3001 D66S \u3068\u3057\u3066\u30bd\u30fc\u30c8\u3057\u305f\u6570\u5b57\u3092\u5f97\u3066\u304f\u3060\u3055\u3044\u3002\n\u3000\u6570\u5b57\u306e\u8a18\u8ff0\u306e\u969b *\uff08\u30a2\u30b9\u30bf\u30ea\u30b9\u30af\uff09\u3092\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9\uff08\u4efb\u610f\u306e\u6570\u5b57\uff09\u3068\u3057\u3066\u4f7f\u7528\u53ef\u80fd\u3067\u3059\u3001\u4f8b\u3048\u3070 *-1 \u3068\u3059\u308c\u30701\u4ee5\u4e0b\u30016-* \u3068\u3059\u308c\u30706\u4ee5\u4e0a\u306e\u4efb\u610f\u306e\u6570\u5b57\u3067\u3059\uff08*\u5358\u72ec\u306f\u3059\u3079\u3066\u306e\u6570\u5b57\u3068\u306a\u308a\u3001\u5148\u306b\u3042\u308b\u3082\u306e\u304b\u3089\u53c2\u7167\u3055\u308c\u307e\u3059\u306e\u3067\u3001\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u9014\u4e2d\u306e\u884c\u306b\u66f8\u3044\u305f\u5834\u5408\u305d\u308c\u3088\u308a\u5148\u306e\u884c\u304c\u53c2\u7167\u3055\u308c\u306a\u304f\u306a\u308a\u307e\u3059\uff09\u3002\u5f8c\u8ff0\u306e\u4fee\u6b63\u306b\u3088\u308a\u8868\u304b\u3089\u306f\u307f\u51fa\u3057\u3066\u3082\u7d50\u679c\u3092\u5f97\u3089\u308c\u308b\u3088\u3046\u306b\u3059\u308b\u3053\u3068\u304c\u3067\u304d\u307e\u3059\u3002\n\n\u3000\u30c1\u30e3\u30c3\u30c8\u304b\u3089\u306e\u30b3\u30de\u30f3\u30c9\u306e\u969b\u3001\u5168\u89d2\u534a\u89d2\u3001\u30a2\u30eb\u30d5\u30a1\u30d9\u30c3\u30c8\u306e\u5927\u6587\u5b57\u5c0f\u6587\u5b57\u306f\u7121\u8996\u3055\u308c\u307e\u3059\u3002\u307e\u305f\u30c0\u30a4\u30b9\u306b\u4fee\u6b63\u3092\u8db3\u3057\u5f15\u304d\u3059\u308b\u3001\u3042\u308b\u3044\u306f\u4efb\u610f\u306e\u6570\u5b57\u3067\u53c2\u7167\u3059\u308b\u3053\u3068\u304c\u53ef\u80fd\u3067\u3059\u3002\u30b3\u30de\u30f3\u30c9\u306e\u5f8c\u306b +\u4fee\u6b63\u5024 \u307e\u305f\u306f -\u4fee\u6b63\u5024 \u3092\u8a18\u8ff0\u3059\u308b\u3053\u3068\u3067\u632f\u3089\u308c\u305f\u30c0\u30a4\u30b9\u306e\u6570\u5b57\u3092\u4fee\u6b63\u3057\u307e\u3059\u3002\u307e\u305f =\u6307\u5b9a\u5024 \u3068\u8a18\u8f09\u3059\u308b\u3053\u3068\u3067\u3001\u305d\u306e\u6570\u5b57\u3067\u30b3\u30de\u30f3\u30c9\u306b\u5bfe\u5fdc\u3059\u308b\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u3092\u53c2\u7167\u3057\u307e\u3059\u3002\u4fee\u6b63\u5024\u3001\u6307\u5b9a\u5024\u306f\u4efb\u610f\u306e\u6574\u6570\u3067\u3059\u3002\n\n\u30b3\u30de\u30f3\u30c9\u306e\u4f8b\uff09\n\u3000ShipType=3\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u3092\u6570\u5b573\u6307\u5b9a\u3067\u53c2\u7167\u3057\u307e\u3059\u3001\u7d50\u679c\u300c\u91cd\u5de1\u6d0b\u8266\u300d\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3082\u3057\u30011\u672a\u6e80\u30846\u3092\u8d85\u3048\u308b\u6570\u5b57\u3092\u6307\u5b9a\u3057\u305f\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3002\n\n\u3000ShipType+2\n\u3000\u524d\u8ff0\u306e\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u4f8b\u300c\u906d\u9047\u8266\u7a2e\u300d\u30921d6\u306e\u7d50\u679c\u306b+2\u3057\u305f\u6570\u5b57\u3067\u53c2\u7167\u3057\u307e\u3059\u3002\u300c\u906d\u9047\u8266\u7a2e\u300d\u306b\u306f7\u4ee5\u964d\u306e\u8a18\u8f09\u304c\u3042\u308a\u307e\u305b\u3093\u3001\u305d\u306e\u5834\u5408\u300c\uff08\u7d50\u679c\u306a\u3057\uff09\u300d\u3068\u306a\u308b\u3067\u3057\u3087\u3046\u3001\u305d\u308c\u3092\u907f\u3051\u305f\u3044\u5834\u5408\u306f\u524d\u8ff0\u306e\u30ef\u30a4\u30eb\u30c9\u30ab\u30fc\u30c9 * \u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}}return t.\u0275fac=function(e){return new(e||t)(Oe(li),Oe(kn),Oe(Tn),Oe(Cr))},t.\u0275cmp=qt({type:t,selectors:[["dice-roll-table-setting"]],viewQuery:function(e,i){if(1&e&&dn(FZ,5),2&e){let r;un(r=fn())&&(i.diceRollTableSelecter=r.first)}},decls:13,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","14em",3,"change"],["diceRollTableSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right",3,"click"],[4,"ngIf"],[3,"value","title"],[2,"font-size","smaller"],[2,"margin-bottom","3px"],["placeholder","Name",2,"width","60%","min-width","5em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap"],["placeholder","Command",2,"width","7em",3,"ngModel","ngModelChange"],[2,"white-space","nowrap","margin-left","1em"],["placeholder","Dice",2,"width","3.3em","text-align","center",3,"ngModel","ngModelChange"],["placeholder","1:\u6570\u5b57\u3068\u7d50\u679c\u3092:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u8a18\u8ff0\r\n2:\u7d50\u679c\uff12\r\n3:\u7d50\u679c\uff13\r\n4:\u2026",2,"width","100%","height","20em","margin-top","3px","resize","vertical",3,"ngModel","ngModelChange"],[3,"click"],[2,"float","right"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ie("click",function(){return i.add()}),be(4,"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u8ffd\u52a0"),te()(),X(5,"select",3,4),Ie("change",function(s){return i.onChangeDiceRollTable(s.target.value)}),xe(7,RZ,2,5,"option",5),te()(),X(8,"div",6)(9,"button",7),Ie("click",function(){return i.helpDiceRollTable()}),be(10,"?"),te(),xe(11,jZ,21,10,"ng-container",8),te()(),xe(12,HZ,4,1,"ng-container",8)),2&e&&(W(7),re("ngForOf",i.diceRollTables),W(4),re("ngIf",!i.isEmpty&&i.selectedDiceRollTable),W(1),re("ngIf",i.isEmpty))},directives:[Jn,Rr,Or,gn,si,oi,ei,jn],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}"]}),t})();const GZ=["cutInSelecter"];function qZ(t,n){if(1&t&&(X(0,"option",10),be(1),te()),2&t){const e=n.$implicit;Je("color",e.isValidAudio?""==e.name?"gray":"":"red"),it("value",e.identifier),it("title",e.name),W(1),Ze((e.isPlayingNow?"\u25b6 ":"\u25a0 ")+(e.isValidAudio?"":"\u26a0\ufe0f")+(""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name))}}function WZ(t,n){if(1&t&&(X(0,"div",66)(1,"i",67),be(2),te()()),2&t){const e=ge(2);W(1),ed(e.isShowHideImages?"red-eye":"grow"),W(1),Ze(e.isShowHideImages?"visibility":"visibility_off")}}function KZ(t,n){if(1&t){const e=Ye();X(0,"button",8),Ie("click",function(){return ke(e),ge(3).openModal()}),X(1,"b"),be(2,"\u753b\u50cf\u5909\u66f4"),te()()}}function YZ(t,n){if(1&t&&(X(0,"div",68),xe(1,KZ,3,0,"button",69),te()),2&t){const e=ge(2);W(1),re("ngIf",!e.cutInVideoId||e.cutInisSoundOnly)}}function ZZ(t,n){if(1&t&&(X(0,"div",70)(1,"i",71),be(2),te()()),2&t){const e=ge(2);W(2),Ze(e.cutInPlayListId?"featured_play_list":"movie")}}function XZ(t,n){1&t&&(Ge(0),be(1,"\uff08\u3042\u306a\u305f\uff09"),qe())}function QZ(t,n){if(1&t&&(X(0,"option",72),be(1),xe(2,XZ,2,0,"ng-container",9),te()),2&t){const e=n.$implicit,i=ge(2);Je("color",e.color),it("value",e.identifier),W(1),An("",e.name," "),W(1),re("ngIf",e===i.myPeer)}}function JZ(t,n){if(1&t&&(X(0,"option",73),be(1),te()),2&t){const e=n.$implicit;it("value",e.identifier),W(1),Ze(e.name)}}function eX(t,n){1&t&&(X(0,"span",48)(1,"i",76),be(2,"check"),te(),X(3,"span",77),be(4,"Link OK"),te()())}function tX(t,n){if(1&t&&(X(0,"span",78),nt(1,"i",79),X(2,"span",80),be(3,"\u26a0\ufe0fLink NG:"),te(),be(4),te()),2&t){const e=ge(3);W(4),An(" ",e.cutInAudioFileName,"")}}function nX(t,n){if(1&t&&(Ge(0),xe(1,eX,5,0,"span",74),xe(2,tX,5,1,"span",75),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isValidAudio),W(1),re("ngIf",!e.isValidAudio)}}function iX(t,n){if(1&t&&(X(0,"div",86),be(1),te()),2&t){const e=ge(3);W(1),An("",e.progresPercent,"%")}}const rX=function(t){return{"is-hidden":t}};function sX(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",8),Ie("click",function(){return ke(e),ge(2).upTabIndex()}),be(2,"\u2191"),te(),X(3,"button",8),Ie("click",function(){return ke(e),ge(2).downTabIndex()}),be(4,"\u2193"),te(),X(5,"div",19)(6,"button",81),Ie("click",function(){return ke(e),ge(2).save()}),X(7,"div",82)(8,"div",83),be(9,"\u4fdd\u5b58"),te(),xe(10,iX,2,1,"div",84),te()(),X(11,"button",85),Ie("click",function(){return ke(e),ge(2).delete()}),be(12,"\u524a\u9664"),te()(),qe()}if(2&t){const e=ge(2);W(6),re("disabled",e.isSaveing),W(2),re("ngClass",ct(3,rX,e.isSaveing)),W(2),re("ngIf",e.isSaveing)}}function oX(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",8),Ie("click",function(){return ke(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),te(),qe()}}const aX=function(t){return{blackout:t}},lX=function(t){return{"red-eye":t}},UI=function(t){return{"not-specified":t}},cX=function(t,n){return{color:t,"font-weight":n}};function uX(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",11)(2,"div")(3,"div",12),Ie("dblclick",function(){ke(e);const r=ge();return!(!r.isEditable||r.cutInVideoId&&!r.cutInisSoundOnly)&&r.openModal()}),xe(4,WZ,3,3,"div",13),xe(5,YZ,2,1,"div",14),xe(6,ZZ,3,1,"div",15),nt(7,"img",16),bt(8,"safe"),te()(),X(9,"div",17)(10,"div",18)(11,"div",19)(12,"label",20)(13,"input",21),Ie("click",function(r){return ke(e),ge().onShowHiddenImages(r)}),te(),X(14,"i",22),be(15),te()()()(),X(16,"div",23)(17,"b",24),be(18,"Name: "),te(),X(19,"input",25),Ie("ngModelChange",function(r){return ke(e),ge().cutInName=r}),te(),X(20,"b",26),be(21,"Tag: "),te(),X(22,"input",27),Ie("ngModelChange",function(r){return ke(e),ge().cutInTag=r}),te()(),X(23,"div",28)(24,"b",24),be(25,"Duration (0=\u7121\u5236\u9650): "),te(),X(26,"input",29),Ie("ngModelChange",function(r){return ke(e),ge().cutInDuration=r}),te(),X(27,"b",30),be(28,"sec."),te()(),X(29,"div",23)(30,"b",24),be(31,"Cut In: "),te(),X(32,"select",31),Ie("ngModelChange",function(r){return ke(e),ge().cutInType=r}),X(33,"option",32),be(34,"\u5373\u6642\u51fa\u73fe"),te(),X(35,"option",32),be(36,"\u6d6e\u304d\u51fa\u308b"),te(),X(37,"option",32),be(38,"\u98db\u3073\u51fa\u3059"),te(),X(39,"option",32),be(40,"\u958b\u304f\uff08\u5de6\u53f3\uff09"),te(),X(41,"option",32),be(42,"\u958b\u304f\uff08\u4e0a\u4e0b\uff09"),te()(),X(43,"label",33)(44,"input",34),Ie("click",function(){ke(e);const r=ge();return r.borderStyle=0==r.borderStyle?1:0}),te(),X(45,"b"),be(46,"\u67a0\u3042\u308a"),te()()(),X(47,"div",23)(48,"b",24),be(49,"\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e: "),te(),nt(50,"br"),X(51,"textarea",35),Ie("ngModelChange",function(r){return ke(e),ge().cutInCond=r}),te()()()(),X(52,"div",36)(53,"div")(54,"button",8),Ie("click",function(){return ke(e),ge().testCutIn()}),X(55,"b"),be(56,"\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)"),X(57,"sup",37),be(58,"*"),te()()(),X(59,"span",38)(60,"button",39),Ie("click",function(){return ke(e),ge().playCutIn()}),X(61,"b")(62,"i",40),be(63,"play_arrow"),te(),be(64,"\u518d\u751f"),te()(),X(65,"button",41),Ie("click",function(){return ke(e),ge().stopCutIn()}),X(66,"b")(67,"i",40),be(68,"stop"),te(),be(69,"\u505c\u6b62"),te()(),X(70,"span",42),be(71," \u27a1 "),X(72,"select",43),Ie("ngModelChange",function(r){return ke(e),ge().sendTo=r}),X(73,"option",44),be(74,"\u5168\u54e1"),te(),xe(75,QZ,3,5,"option",45),te()()()(),X(76,"div",46)(77,"div")(78,"b",47),be(79,"\u4f4d\u7f6e"),te(),X(80,"label",48)(81,"input",49),Ie("ngModelChange",function(r){return ke(e),ge().cutInIsPreventOutBounds=r}),te(),X(82,"b"),be(83,"\u898b\u5207\u308c\u9632\u6b62"),te()()(),X(84,"div",50)(85,"b"),be(86,"PosX: "),te(),X(87,"input",51),Ie("ngModelChange",function(r){return ke(e),ge().cutInPosX=r}),te(),X(88,"input",52),Ie("ngModelChange",function(r){return ke(e),ge().cutInPosX=r}),te(),X(89,"b",23),be(90,"%"),te()(),X(91,"div",50)(92,"b"),be(93,"PosY: "),te(),X(94,"input",53),Ie("ngModelChange",function(r){return ke(e),ge().cutInPosY=r}),te(),X(95,"input",52),Ie("ngModelChange",function(r){return ke(e),ge().cutInPosY=r}),te(),X(96,"b",23),be(97,"%"),te()(),X(98,"div",50)(99,"b"),be(100,"Z-Index (\u5927\u304d\u3044\u3082\u306e\u304c\u524d): "),te(),X(101,"input",52),Ie("ngModelChange",function(r){return ke(e),ge().cutInZIndex=r}),te(),X(102,"label",48)(103,"input",54),Ie("ngModelChange",function(r){return ke(e),ge().cutInIsFrontOfStand=r}),te(),X(104,"b"),be(105,"\u30b9\u30bf\u30f3\u30c9\u306e\u524d\u9762\u306b\u8868\u793a"),te()()()(),X(106,"div",46)(107,"div")(108,"b",47),be(109,"\u30b5\u30a4\u30ba\uff08\u5e45\u3001\u9ad8\u3055\u5171\u306b0\u306e\u5834\u5408\u306f\u5143\u753b\u50cf\u306e\u307e\u307e\uff09"),te()(),X(110,"div",50)(111,"b"),be(112,"Width (0=\u6307\u5b9a\u306a\u3057): "),te(),X(113,"input",55),Ie("ngModelChange",function(r){return ke(e),ge().cutInWidth=r}),te(),X(114,"input",52),Ie("ngModelChange",function(r){return ke(e),ge().cutInWidth=r}),te(),X(115,"b",23),be(116,"%"),te()(),X(117,"div",50)(118,"b"),be(119,"Height (0=\u6307\u5b9a\u306a\u3057): "),te(),X(120,"input",56),Ie("ngModelChange",function(r){return ke(e),ge().cutInHeight=r}),te(),X(121,"input",52),Ie("ngModelChange",function(r){return ke(e),ge().cutInHeight=r}),te(),X(122,"b",23),be(123,"%"),te()(),X(124,"div",50)(125,"b"),be(126,"\u5143\u753b\u50cf\u3068\u7e26\u6a2a\u6bd4\u304c\u7570\u306a\u308b\u5834\u5408: "),te(),X(127,"select",57),Ie("ngModelChange",function(r){return ke(e),ge().objectFitType=r}),X(128,"option",32),be(129,"\u4f38\u7e2e\u3059\u308b"),te(),X(130,"option",32),be(131,"\u5207\u308a\u53d6\u308b"),te()()()(),X(132,"div",46)(133,"div")(134,"b",47),be(135,"\u52b9\u679c\u97f3\u30fb\u52d5\u753b"),te(),X(136,"label",48)(137,"input",58),Ie("ngModelChange",function(r){return ke(e),ge().cutInSEIsLoop=r}),te(),X(138,"b"),be(139,"\u7e70\u308a\u8fd4\u3057"),te()()(),X(140,"div",50)(141,"input",59),Ie("ngModelChange",function(r){return ke(e),ge().cutInIsVideo=r}),te(),X(142,"label",60)(143,"b"),be(144,"\u97f3\u697d\u30d5\u30a1\u30a4\u30eb: "),te()(),X(145,"select",61),Ie("ngModelChange",function(r){return ke(e),ge().cutInAudioIdentifier=r})("change",function(r){return ke(e),ge().onAudioFileChange(r.target.value)}),X(146,"option",44),be(147,"\u52b9\u679c\u97f3\u306a\u3057"),te(),xe(148,JZ,2,2,"option",62),te(),xe(149,nX,3,2,"ng-container",9),te(),X(150,"div",50)(151,"input",59),Ie("ngModelChange",function(r){return ke(e),ge().cutInIsVideo=r}),te(),X(152,"label",60)(153,"b"),be(154,"\u52d5\u753bURL: "),te()(),X(155,"input",63),Ie("ngModelChange",function(r){return ke(e),ge().cutInVideoURL=r}),te()(),X(156,"div",64)(157,"a",65),Ie("click",function(){return ke(e),ge().openYouTubeTerms()}),be(158,"YouTube \u5229\u7528\u898f\u7d04"),te()()()(),nt(159,"hr"),X(160,"div"),xe(161,sX,13,5,"ng-container",9),xe(162,oX,3,0,"ng-container",9),te(),qe()}if(2&t){const e=ge();W(4),re("ngIf",(!e.cutInVideoId||e.cutInisSoundOnly)&&e.getHidden(e.cutInImage)),W(1),re("ngIf",e.isEditable),W(1),re("ngIf",e.cutInVideoId&&!e.cutInisSoundOnly),W(1),re("ngClass",ct(125,aX,(!e.cutInVideoId||e.cutInisSoundOnly)&&!e.isShowHideImages&&e.getHidden(e.cutInImage)))("src",yt(8,122,e.cutInImageUrl,"resourceUrl"),Xt),W(6),it("checked",e.isShowHideImages?"checked":""),W(1),re("ngClass",ct(127,lX,e.isShowHideImages)),W(1),Ze(e.isShowHideImages?"visibility":"visibility_off"),W(4),re("ngModel",e.cutInName),Rt("disabled",e.isEditable?null:""),W(3),re("ngModel",e.cutInTag),Rt("disabled",e.isEditable?null:""),W(4),re("ngModel",e.cutInDuration),Rt("disabled",!e.isEditable||e.isPlaying?"":null),W(6),re("ngModel",e.cutInType),Rt("disabled",e.isEditable?null:""),W(1),re("value",-1)("selected",-1==e.cutInType),W(2),re("value",0)("selected",0==e.cutInType),W(2),re("value",1)("selected",1==e.cutInType),W(2),re("value",2)("selected",2==e.cutInType),W(2),re("value",3)("selected",3==e.cutInType),W(3),re("checked",1==e.borderStyle),Rt("disabled",e.isEditable?null:""),W(7),re("ngModel",e.cutInCond),Rt("disabled",e.isEditable?null:""),W(3),Rt("disabled",e.isEditable?null:""),W(6),Rt("disabled",e.isEditable?null:""),W(5),Rt("disabled",e.isEditable?null:""),W(7),re("ngModel",e.sendTo)("ngClass",ct(129,UI,""==e.sendTo))("ngStyle",cn(131,cX,""==e.sendTo?null:e.sendToColor,""==e.sendTo?"normal":"bolder")),W(3),re("ngForOf",e.otherPeers),W(6),re("ngModel",e.cutInIsPreventOutBounds)("checked",e.cutInIsPreventOutBounds)("value",!0),Rt("disabled",!e.isEditable||e.cutInVideoId?"":null),W(6),it("title",e.cutInPosX),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.cutInPosX),Rt("disabled",e.isEditable?null:""),W(1),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.cutInPosX),Rt("disabled",e.isEditable?null:""),W(6),it("title",e.cutInPosY),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.cutInPosY),Rt("disabled",e.isEditable?null:""),W(1),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.cutInPosY),Rt("disabled",e.isEditable?null:""),W(6),it("min",-e.maxSize),it("max",e.maxSize),re("ngModel",e.cutInZIndex),Rt("disabled",!e.isEditable||e.cutInVideoId?"":null),W(2),re("ngModel",e.cutInIsFrontOfStand)("checked",e.cutInIsFrontOfStand)("value",!0),Rt("disabled",!e.isEditable||e.cutInVideoId?"":null),W(10),it("title",e.cutInWidth),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.cutInWidth),Rt("disabled",e.isEditable?null:""),W(1),it("min",e.minSize),it("max",2*e.maxSize),re("ngModel",e.cutInWidth),Rt("disabled",e.isEditable?null:""),W(6),it("title",e.cutInHeight),it("min",e.minSize),it("max",e.maxSize),re("ngModel",e.cutInHeight),Rt("disabled",e.isEditable?null:""),W(1),it("min",e.minSize),it("max",2*e.maxSize),re("ngModel",e.cutInHeight),Rt("disabled",e.isEditable?null:""),W(6),re("ngModel",e.objectFitType),Rt("disabled",e.cutInVideoId&&!e.cutInisSoundOnly||!e.isEditable?"":null),W(1),re("value",0)("selected",0==e.objectFitType),W(2),re("value",1)("selected",1==e.objectFitType),W(7),re("ngModel",e.cutInSEIsLoop)("checked",e.cutInSEIsLoop)("value",!0),Rt("disabled",!e.isEditable||e.isPlaying?"":null),W(4),sr("name","",e.panelId,"-media")("id","",e.panelId,"-media-sound"),re("ngModel",e.cutInIsVideo)("checked",!e.cutInIsVideo)("value",!1),Rt("disabled",!e.isEditable||e.isPlaying?"":null),W(1),sr("for","",e.panelId,"-media-sound"),W(3),Je("min-width",e.isValidAudio?10:5,"em")("max-width",e.isValidAudio?20:5,"em"),re("ngModel",e.cutInAudioIdentifier)("ngClass",ct(134,UI,""==e.cutInAudioIdentifier)),Rt("disabled",e.cutInIsVideo||!e.isEditable||e.isPlaying?"":null),W(3),re("ngForOf",e.audios),W(1),re("ngIf",e.isEditable&&e.cutInAudioFileName.length>0),W(2),sr("name","",e.panelId,"-media")("id","",e.panelId,"-media-video"),re("ngModel",e.cutInIsVideo)("checked",e.cutInIsVideo)("value",!0),Rt("disabled",!e.isEditable||e.isPlaying?"":null),W(1),sr("for","",e.panelId,"-media-video"),W(3),re("ngModel",e.cutInVideoURL),Rt("disabled",e.cutInIsVideo&&e.isEditable&&!e.isPlaying?null:""),W(6),re("ngIf",!e.isDeleted),W(1),re("ngIf",e.isDeleted&&e.selectedCutInXml)}}function dX(t,n){if(1&t){const e=Ye();Ge(0),X(1,"button",8),Ie("click",function(){return ke(e),ge(2).restore()}),be(2,"\u5143\u306b\u623b\u3059"),te(),qe()}}function fX(t,n){if(1&t&&(Ge(0),X(1,"div",87),be(2," \u203b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u3042\u308a\u307e\u305b\u3093\u3002 "),xe(3,dX,3,0,"ng-container",9),te(),qe()),2&t){const e=ge();W(3),re("ngIf",e.isDeleted&&e.selectedCutInXml)}}let hX=(()=>{class t{constructor(e,i,r,s,o,d){this.changeDetector=e,this.pointerDeviceService=i,this.modalService=r,this.panelService=s,this.saveDataService=o,this.chatMessageService=d,this.minSize=0,this.maxSize=100,this.isShowHideImages=!1,this.selectedCutIn=null,this.selectedCutInXml="",this.sendTo="",this.isSaveing=!1,this.progresPercent=0}get cutIns(){return oo.instance.cutIns}get cutInName(){return this.selectedCutIn.name}set cutInName(e){this.isEditable&&(this.selectedCutIn.name=e)}get cutInTag(){return this.selectedCutIn.tag}set cutInTag(e){this.isEditable&&(this.selectedCutIn.tag=e)}get cutInDuration(){return this.selectedCutIn.duration}set cutInDuration(e){this.isEditable&&(this.selectedCutIn.duration=e)}get cutInCond(){return this.selectedCutIn.value+""}set cutInCond(e){this.isEditable&&(this.selectedCutIn.value=e)}get cutInIsPreventOutBounds(){return this.selectedCutIn.isPreventOutBounds}set cutInIsPreventOutBounds(e){this.isEditable&&(this.selectedCutIn.isPreventOutBounds=e)}get cutInWidth(){return this.selectedCutIn.width}set cutInWidth(e){this.isEditable&&(this.selectedCutIn.width=e)}get cutInHeight(){return this.selectedCutIn.height}set cutInHeight(e){this.isEditable&&(this.selectedCutIn.height=e)}get objectFitType(){return this.selectedCutIn.objectFitType}set objectFitType(e){this.isEditable&&(this.selectedCutIn.objectFitType=e)}get cutInPosX(){return this.selectedCutIn.posX}set cutInPosX(e){this.isEditable&&(this.selectedCutIn.posX=e)}get cutInPosY(){return this.selectedCutIn.posY}set cutInPosY(e){this.isEditable&&(this.selectedCutIn.posY=e)}get cutInZIndex(){return this.selectedCutIn.zIndex}set cutInZIndex(e){this.isEditable&&(this.selectedCutIn.zIndex=e)}get cutInIsFrontOfStand(){return this.selectedCutIn.isFrontOfStand}set cutInIsFrontOfStand(e){this.isEditable&&(this.selectedCutIn.isFrontOfStand=e)}get cutInAudioIdentifier(){return this.selectedCutIn.audioIdentifier}set cutInAudioIdentifier(e){this.isEditable&&(this.selectedCutIn.audioIdentifier=e)}get cutInAudioFileName(){return this.selectedCutIn.audioFileName}set cutInAudioFileName(e){this.isEditable&&(this.selectedCutIn.audioFileName=e)}get cutInSEIsLoop(){return this.selectedCutIn.isLoop}set cutInSEIsLoop(e){this.isEditable&&(this.selectedCutIn.isLoop=e)}get cutInType(){return this.selectedCutIn.animationType}set cutInType(e){this.isEditable&&(this.selectedCutIn.animationType=e)}get borderStyle(){return this.selectedCutIn.borderStyle}set borderStyle(e){this.isEditable&&(this.selectedCutIn.borderStyle=e)}get isEmpty(){return this.cutIns.length<1}get isDeleted(){return!!this.selectedCutIn&&null==rt.instance.get(this.selectedCutIn.identifier)}get isEditable(){return!this.isEmpty&&!this.isDeleted}get cutInIsVideo(){return this.selectedCutIn.isVideoCutIn}set cutInIsVideo(e){this.isEditable&&(this.selectedCutIn.isVideoCutIn=e)}get cutInVideoURL(){return this.selectedCutIn.videoUrl}set cutInVideoURL(e){this.isEditable&&(this.selectedCutIn.videoUrl=e)}get cutInisSoundOnly(){return this.selectedCutIn.isSoundOnly}set cutInisSoundOnly(e){this.isEditable&&(this.selectedCutIn.isSoundOnly=e)}get cutInVideoId(){return this.selectedCutIn?this.selectedCutIn.videoId:""}get cutInPlayListId(){return this.cutInVideoId?this.selectedCutIn.playListId:""}get cutInImage(){return this.selectedCutIn&&It.instance.get(this.selectedCutIn.imageIdentifier)||Lt.Empty}get cutInImageUrl(){return this.selectedCutIn?!this.selectedCutIn.videoId||this.cutInisSoundOnly?this.cutInImage.url:`https://img.youtube.com/vi/${this.selectedCutIn.videoId}/hqdefault.jpg`:Lt.Empty.url}get isPlaying(){return!!this.selectedCutIn&&zp.nowShowingIdentifiers().includes(this.selectedCutIn.identifier)}get isValidAudio(){return!this.selectedCutIn||this.selectedCutIn.isValidAudio}get myPeer(){return He.myCursor}get otherPeers(){return rt.instance.getObjects(He)}get myColor(){return He.myCursor&&He.myCursor.color&&He.myCursor.color!=He.CHAT_TRANSPARENT_COLOR?He.myCursor.color:He.CHAT_DEFAULT_COLOR}get sendToColor(){let e=rt.instance.get(this.sendTo);return e instanceof He?e.color:He.CHAT_DEFAULT_COLOR}get audios(){return Ft.instance.audios.filter(e=>!e.isHidden)}ngOnInit(){Promise.resolve().then(()=>this.modalService.title=this.panelService.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a"),Fe.register(this).on("SYNCHRONIZE_AUDIO_LIST",-1e3,e=>{this.onAudioFileChange()}),this.panelId=ms.generateUuid()}ngAfterViewInit(){this.cutIns.length>0&&queueMicrotask(()=>{this.onChangeCutIn(this.cutIns[0].identifier),this.cutInSelecter.nativeElement.selectedIndex=0})}ngOnDestroy(){Fe.unregister(this)}onChangeCutIn(e){this.selectedCutIn=rt.instance.get(e),this.selectedCutInXml=""}create(e="\u30ab\u30c3\u30c8\u30a4\u30f3"){return oo.instance.addCutIn(e)}add(){const e=this.create();e.imageIdentifier="stand_no_image",queueMicrotask(()=>{this.onChangeCutIn(e.identifier),this.cutInSelecter.nativeElement.value=e.identifier})}save(){var e=this;return(0,Yt.Z)(function*(){if(!e.selectedCutIn||e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i="fly_cutIn_"+e.selectedCutIn.name;yield e.saveDataService.saveGameObjectAsync(e.selectedCutIn,i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}delete(){!this.selectedCutIn||(Fe.call("STOP_CUT_IN",{identifier:this.selectedCutIn.identifier}),this.isEmpty||(this.selectedCutInXml=this.selectedCutIn.toXml(),this.selectedCutIn.destroy()))}restore(){if(this.selectedCutIn&&this.selectedCutInXml){let e=Gn.instance.parseXml(this.selectedCutInXml);oo.instance.addCutIn(e),this.selectedCutInXml="",queueMicrotask(()=>{const i=this.cutIns;this.onChangeCutIn(i[i.length-1].identifier),this.cutInSelecter.nativeElement.selectedIndex=i.length-1})}}getHidden(e){const i=mn.get(e.identifier);return!!i&&i.hide}upTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);0<i&&e.insertBefore(this.selectedCutIn,e.children[i-1])}downTabIndex(){if(!this.selectedCutIn)return;let e=this.selectedCutIn.parent,i=e.children.indexOf(this.selectedCutIn);i<e.children.length-1&&e.insertBefore(e.children[i+1],this.selectedCutIn)}openModal(){if(this.isDeleted)return;let e=[];this.selectedCutIn&&this.selectedCutIn.imageIdentifier&&(e=[this.selectedCutIn.imageIdentifier]),this.modalService.open(Po,{currentImageIdentifires:e}).then(i=>{!this.selectedCutIn||!i||(this.selectedCutIn.imageIdentifier=i)})}onShowHiddenImages(e){this.isShowHideImages?this.isShowHideImages=!1:(e.preventDefault(),this.modalService.open(qi,{title:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a",text:"\u975e\u8868\u793a\u8a2d\u5b9a\u306e\u753b\u50cf\u3092\u8868\u793a\u3057\u307e\u3059\u304b\uff1f",help:"\u30cd\u30bf\u30d0\u30ec\u306a\u3069\u306b\u3054\u6ce8\u610f\u304f\u3060\u3055\u3044\u3002",type:_i.OK_CANCEL,materialIcon:"visibility",action:()=>{this.isShowHideImages=!0,e.target.checked=!0,this.changeDetector.markForCheck()}}))}playCutIn(){const e=this.selectedCutIn;if(!e)return;const i={identifier:e.identifier,secret:!!this.sendTo,sender:He.myCursor.peerId};if(i.secret){const r=rt.instance.get(this.sendTo);r&&(r.peerId!=He.myCursor.peerId&&Fe.call("PLAY_CUT_IN",i,r.peerId),Fe.call("PLAY_CUT_IN",i,He.myCursor.peerId))}else Fe.call("PLAY_CUT_IN",i),this.chatMessageService.sendOperationLog((""==e.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":e.name)+" \u3092\u518d\u751f\u3057\u305f")}stopCutIn(){if(!this.selectedCutIn)return;const e={identifier:this.selectedCutIn.identifier,secret:!!this.sendTo,sender:He.myCursor.peerId};if(e.secret){const i=rt.instance.get(this.sendTo);i&&(i.peerId!=He.myCursor.peerId&&Fe.call("STOP_CUT_IN",e,i.peerId),Fe.call("STOP_CUT_IN",e,He.myCursor.peerId))}else Fe.call("STOP_CUT_IN",e)}testCutIn(){!this.selectedCutIn||queueMicrotask(()=>{Fe.trigger("PLAY_CUT_IN",{identifier:this.selectedCutIn.identifier,test:!0})})}onAudioFileChange(e=""){if(!e&&this.selectedCutIn&&(e=this.selectedCutIn.audioIdentifier),""==e)return void(this.cutInAudioFileName="");const i=Ft.instance.get(e);this.cutInAudioFileName=i?i.name:""}openYouTubeTerms(){return this.modalService.open(Qr,{url:"https://www.youtube.com/terms",title:"YouTube \u5229\u7528\u898f\u7d04"}),!1}helpCutIn(){let e=this.pointerDeviceService.pointers[0],r=this.panelService.open(au,{left:e.x,top:e.y,width:600,height:620});r.title="\u30ab\u30c3\u30c8\u30a4\u30f3\u30d8\u30eb\u30d7",r.text=`\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u540d\u524d\u3001\u8868\u793a\u6642\u9593\u3001\u4f4d\u7f6e\u3068\u5e45\u3068\u9ad8\u3055\uff08\u305d\u308c\u305e\u308c\u753b\u9762\u30b5\u30a4\u30ba\u306b\u5bfe\u3059\u308b\u76f8\u5bfe\u6307\u5b9a\uff09\u3001\u30c1\u30e3\u30c3\u30c8\u9001\u4fe1\u6642\u306b\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8868\u793a\u3055\u308c\u308b\u6761\u4ef6\u3092\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u307e\u305f\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u304a\u3088\u3073\u300c\u898b\u5207\u308c\u9632\u6b62\u300d\u306b\u30c1\u30a7\u30c3\u30af\u3092\u5165\u308c\u305f\u5834\u5408\u3001\u753b\u9762\u5185\u306b\u53ce\u307e\u308b\u3088\u3046\u306b\u4f4d\u7f6e\u3068\u30b5\u30a4\u30ba\u304c\u8abf\u6574\u3055\u308c\u307e\u3059\u3002\n\u3000\n\u3000\u6a2a\u4f4d\u7f6e\uff08PosX\uff09\u3068\u7e26\u4f4d\u7f6e\uff08PosY\uff09\u306f\u3001\u753b\u9762\u306e\u5de6\u4e0a\u9685\u304b\u3089\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u4e2d\u5fc3\u4f4d\u7f6e\u307e\u3067\u306e\u8ddd\u96e2\u3068\u306a\u308a\u307e\u3059\u3002\u30b5\u30a4\u30ba\u306e\u5e45\uff08Width\uff09\u3068\u9ad8\u3055\uff08Height\uff09\u306e\u3069\u3061\u3089\u304b\u30920\u3068\u3057\u305f\u5834\u5408\u3001\u5143\u753b\u50cf\u306e\u7e26\u6a2a\u6bd4\u3092\u4fdd\u3063\u3066\u62e1\u5927\u7e2e\u5c0f\u3057\u307e\u3059\uff08\u305f\u3060\u3057\u3001\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u6700\u5c0f\u5e45\u3001\u9ad8\u3055\u306f${rT.MIN_SIZE}\u30d4\u30af\u30bb\u30eb\u3068\u306a\u308a\u307e\u3059\uff09\u3002\n\u3000\n\u3000\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u5fc5\u305a\u524d\u9762\u3001\u305d\u306e\u4ed6\u306f\u5f8c\u304b\u3089\u8868\u793a\u3055\u308c\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u753b\u50cf\u304c\u3088\u308a\u524d\u9762\u306b\u306a\u308a\u307e\u3059\u304c\u3001\u91cd\u306a\u308a\u9806\uff08Z-Index\uff09\u3092\u6307\u5b9a\u3059\u308b\u3053\u3068\u3067\u5236\u5fa1\u53ef\u80fd\u3067\u3059\u3002\u540c\u3058\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u3001\u540c\u3058\u30bf\u30b0\u304c\u6307\u5b9a\u3055\u308c\u305f\u30ab\u30c3\u30c8\u30a4\u30f3\u3092\u518d\u751f\u3059\u308b\u5834\u5408\u306f\u3001\u4ee5\u524d\u306e\u3082\u306e\u306f\u505c\u6b62\u3057\u307e\u3059\u3002\u307e\u305f\u3001\u30c1\u30e3\u30c3\u30c8\u672b\u5c3e\u6761\u4ef6\u3092\u6e80\u305f\u3059\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u8907\u6570\u3042\u308b\u5834\u5408\u3001\n\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u3066\u3044\u306a\u3044\u3082\u306e\u306f\u3059\u3079\u3066\n\u3000\u3000\u30fb\u30bf\u30b0\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u3082\u306e\u306f\u3001\u540c\u3058\u30bf\u30b0\u306e\u3082\u306e\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\n\u3000\u3000\u30fb\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u4e0a\u8a18\u306e\u4e2d\u304b\u3089\u30e9\u30f3\u30c0\u30e0\u306b1\u3064\u3092\u9078\u629e\n\n\u3068\u306a\u308a\u307e\u3059\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u30c9\u30e9\u30c3\u30b0\u306b\u3088\u3063\u3066\u79fb\u52d5\u53ef\u80fd\u3067\u3059\uff08\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3092\u30c9\u30e9\u30c3\u30b0\uff09\u3002\u307e\u305f\u30c0\u30d6\u30eb\u30af\u30ea\u30c3\u30af\u3067\u9589\u3058\u308b\uff08\u81ea\u5206\u3060\u3051\u505c\u6b62\uff09\u3001\u53f3\u30af\u30ea\u30c3\u30af\u3067\u30b3\u30f3\u30c6\u30ad\u30b9\u30c8\u30e1\u30cb\u30e5\u30fc\u304b\u3089\u64cd\u4f5c\u304c\u53ef\u80fd\u3067\u3059\uff08\u300c\u9589\u3058\u308b\u300d\u300c\u30a6\u30a3\u30f3\u30c9\u30a6\u306e\u80cc\u9762\u306b\u8868\u793a\u300d\u300c\u6700\u5c0f\u5316\u300d\u304c\u53ef\u80fd\u3001\u52d5\u753b\u3092\u518d\u751f\u3059\u308b\u30ab\u30c3\u30c8\u30a4\u30f3\u306f\u7aef\u3067\u53d7\u4ed8\uff09\u3002\n\n\u3000\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3055\u308c\u305f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u3092\u30ab\u30c3\u30c8\u30a4\u30f3\u8868\u793a\u6642\u306e\u52b9\u679c\u97f3\u3068\u3057\u3066\u8a2d\u5b9a\u3067\u304d\u307e\u3059\u3002\u97f3\u91cf\u306b\u306f\u30b8\u30e5\u30fc\u30af\u30dc\u30c3\u30af\u30b9\u306e\u8a2d\u5b9a\uff08\u300c\u30c6\u30b9\u30c8 (\u81ea\u5206\u3060\u3051\u898b\u308b)\u300d\u306e\u5834\u5408\u306f\u8a66\u8074\u97f3\u91cf\uff09\u304c\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002\u8868\u793a\u6642\u9593\u3084\u624b\u52d5\u64cd\u4f5c\u306b\u3088\u3063\u3066\u30ab\u30c3\u30c8\u30a4\u30f3\u304c\u505c\u6b62\u3057\u305f\u969b\u306b\u306f\u3001\u9014\u4e2d\u3067\u3042\u3063\u3066\u3082\u97f3\u58f0\u3082\u505c\u6b62\u3057\u307e\u3059\u3002\u30ab\u30c3\u30c8\u30a4\u30f3\u3084\u90e8\u5c4b\u306e\u30bb\u30fc\u30d6\u30c7\u30fc\u30bf\uff08zip\uff09\u306b\u306f\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306f\u542b\u307e\u308c\u307e\u305b\u3093\u306e\u3067\u3001\u5fc5\u8981\u3067\u3057\u305f\u3089\u5225\u9014\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u304f\u3060\u3055\u3044\uff08\u30ab\u30c3\u30c8\u30a4\u30f3\u3068\u97f3\u697d\u30d5\u30a1\u30a4\u30eb\u306e\u30ea\u30f3\u30af\u306f\u30d5\u30a1\u30a4\u30eb\u306e\u5185\u5bb9\u306b\u3088\u308a\u307e\u3059\u3001\u540c\u540d\u306e\u5225\u30d5\u30a1\u30a4\u30eb\u3092\u30a2\u30c3\u30d7\u30ed\u30fc\u30c9\u3057\u3066\u3082\u518d\u30ea\u30f3\u30af\u3055\u308c\u307e\u305b\u3093\uff09\u3002\n\n\u3000\u30ab\u30c3\u30c8\u30a4\u30f3\u306b\u52d5\u753b\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u3001URL\u306f\u73fe\u5728YouTube\u306e\u3082\u306e\u306e\u307f\u6709\u52b9\u3067\u3059\u3002\u52d5\u753b\u3092\u5229\u7528\u3059\u308b\u969b\u306f\u6a29\u5229\u8005\u304a\u3088\u3073YouTube\u306e\u5b9a\u3081\u305f\u5229\u7528\u898f\u7d04\u3092\u53c2\u7167\u3057\u3001\u9806\u5b88\u3057\u3066\u304f\u3060\u3055\u3044\u3002`}}return t.\u0275fac=function(e){return new(e||t)(Oe(Di),Oe(li),Oe(kn),Oe(Tn),Oe(Cr),Oe(yr))},t.\u0275cmp=qt({type:t,selectors:[["app-cut-in-setting"]],viewQuery:function(e,i){if(1&e&&dn(GZ,5),2&e){let r;un(r=fn())&&(i.cutInSelecter=r.first)}},decls:14,vars:3,consts:[[1,"flex-container"],[1,"flex-item","no-grow"],[2,"font-size","smaller","margin-bottom","3px",3,"click"],["size","15",2,"width","12em",3,"change"],["cutInSelecter",""],[3,"value","title","color",4,"ngFor","ngForOf"],[1,"flex-item"],[2,"float","right","margin-top","3px","margin-right","3px"],[3,"click"],[4,"ngIf"],[3,"value","title"],[2,"display","flex"],[2,"position","relative","overflow","hidden",3,"dblclick"],["style","position: absolute; text-align: right; top: 0px; right: 0px; pointer-events: none; z-index: 5",4,"ngIf"],["style","position: absolute; top: 1px; left: -1px; z-index: 5",4,"ngIf"],["class","grow","style","opacity: 0.8; position: absolute; bottom: 1px; right: -1px; z-index: 5",4,"ngIf"],[2,"width","160px","height","160px","object-fit","contain",3,"ngClass","src"],[2,"display","flex","flex-direction","column","width","100%"],[2,"padding-bottom","2px"],[2,"float","right"],["sytle","white-space: nowrap"],["name","show-hide-images","type","checkbox","value","Show Hides",3,"checked","click"],[1,"material-icons",2,"font-size","smaller",3,"ngClass"],[2,"padding-left","2px"],[2,"font-size","smaller"],["type","text","placeholder","Name",2,"width","8em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","margin-left","1em"],["type","text","placeholder","Tag",2,"width","3em",3,"ngModel","ngModelChange"],[2,"padding-left","2px","padding-top","2px"],["type","number","min","0","max","1000",2,"width","3.5em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","padding-left","2px"],[2,"min-width","8em",3,"ngModel","ngModelChange"],[3,"value","selected"],[2,"margin-left","1em","font-size","smaller"],["name","borderStyle","type","checkbox",3,"checked","click"],["placeholder","1\u884c\u306b\u4e00\u3064\u3001\u5192\u982d@\u3067\u30de\u30c3\u30c1\u6642\u306b\u30c6\u30ad\u30b9\u30c8\u304b\u3089\u5207\u308a\u53d6\u308a\r\n@\u8857\u4e26\u307f",2,"width","100%","height","3em",3,"ngModel","ngModelChange"],[2,"font-size","smaller","display","flex","flex-direction","column","width","100%"],[1,"self-only"],[2,"margin-left","2em"],[2,"margin-right","0px",3,"click"],[1,"material-icons",2,"font-size","smaller"],[2,"margin-left","0px",3,"click"],[2,"white-space","nowrap"],[2,"max-width","10em",3,"ngModel","ngClass","ngStyle","ngModelChange"],["value","",1,"not-specified"],["style","font-weight: bolder;",3,"value","color",4,"ngFor","ngForOf"],[1,"section"],[1,"header"],[2,"margin-left","0.6em"],["name","cutInIsPreventOutBounds","type","checkbox",3,"ngModel","checked","value","ngModelChange"],[2,"padding-left","1em"],["type","range","name","cutInPosX",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","number",2,"width","3.5em",3,"ngModel","min","max","ngModelChange"],["type","range","name","cutInPosY",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["name","cutInIsFrontOfStand","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","range","name","cutInWidth",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],["type","range","name","cutIHeight",2,"width","180px",3,"ngModel","title","min","max","ngModelChange"],[3,"ngModel","ngModelChange"],["name","cutInSEIsLoop","type","checkbox",3,"ngModel","checked","value","ngModelChange"],["type","radio",3,"name","id","ngModel","checked","value","ngModelChange"],[3,"for"],[3,"ngModel","ngClass","ngModelChange","change"],["style","color: black",3,"value",4,"ngFor","ngForOf"],["type","text",2,"width","24em",3,"ngModel","ngModelChange"],[2,"padding-left","2.5em"],["href","https://www.youtube.com/terms","target","_blank",1,"outer-link",3,"click"],[2,"position","absolute","text-align","right","top","0px","right","0px","pointer-events","none","z-index","5"],[1,"material-icons",2,"margin-right","2px","font-size","16px","display","block"],[2,"position","absolute","top","1px","left","-1px","z-index","5"],[3,"click",4,"ngIf"],[1,"grow",2,"opacity","0.8","position","absolute","bottom","1px","right","-1px","z-index","5"],[1,"material-icons",2,"font-size","32px"],[2,"font-weight","bolder",3,"value"],[2,"color","black",3,"value"],["style","margin-left: 0.6em",4,"ngIf"],["style","margin-left: 0.6em; color: red; display:inline-block; white-space: nowrap; max-width: 20em; overflow: hidden; text-overflow: ellipsis",4,"ngIf"],[1,"material-icons",2,"font-size","14px"],[2,"color","blue"],[2,"margin-left","0.6em","color","red","display","inline-block","white-space","nowrap","max-width","20em","overflow","hidden","text-overflow","ellipsis"],[1,"material-icons"],[2,"font-weight","bolder"],[3,"disabled","click"],[2,"position","relative"],[3,"ngClass"],["class","progress",4,"ngIf"],[1,"danger",3,"click"],[1,"progress"],[2,"font-size","12px"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1)(2,"div")(3,"button",2),Ie("click",function(){return i.add()}),be(4,"\u30ab\u30c3\u30c8\u30a4\u30f3\u306e\u8ffd\u52a0"),te()(),X(5,"select",3,4),Ie("change",function(s){return i.onChangeCutIn(s.target.value)}),xe(7,qZ,2,5,"option",5),te()(),X(8,"div",6)(9,"div",7)(10,"button",8),Ie("click",function(){return i.helpCutIn()}),be(11,"?"),te()(),xe(12,uX,163,136,"ng-container",9),te()(),xe(13,fX,4,1,"ng-container",9)),2&e&&(W(7),re("ngForOf",i.cutIns),W(5),re("ngIf",!i.isEmpty&&i.selectedCutIn),W(1),re("ngIf",i.isEmpty))},directives:[Jn,Rr,Or,gn,jn,si,oi,ei,Co,yo,ds,Zr,Ji,Yr,fs,Sa],pipes:[Yn],styles:[".flex-container[_ngcontent-%COMP%]{display:flex;flex-flow:row wrap;justify-content:flex-start;align-items:stretch}.flex-item[_ngcontent-%COMP%]{margin:5px;flex:1 0 auto;box-sizing:border-box;flex-grow:1;max-width:100%}.no-grow[_ngcontent-%COMP%]{flex-grow:0}.is-hidden[_ngcontent-%COMP%]{visibility:hidden}.header[_ngcontent-%COMP%]{margin-top:3px}.progress[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;top:0;bottom:0;left:0;right:0;font-size:.9em}.red-eye[_ngcontent-%COMP%]{color:#8b0000;text-shadow:0px 0px 2px crimson,0px 0px 4px white;font-weight:bolder}.grow[_ngcontent-%COMP%]{text-shadow:1px 1px 0px #ffffff,-1px 1px 0px #ffffff,1px -1px 0px #ffffff,-1px -1px 0px #ffffff,1px 0px 0px #ffffff,0px 1px 0px #ffffff,-1px 0px 0px #ffffff,0px -1px 0px #ffffff}.blackout[_ngcontent-%COMP%]{filter:blur(12px) grayscale(70%)}.self-only[_ngcontent-%COMP%]{color:red}img[_ngcontent-%COMP%]{transition:all .1s 0s ease}.self-setting[_ngcontent-%COMP%]{font-weight:bolder;font-size:smaller}input[type=number][_ngcontent-%COMP%]{text-align:right}.direct-message[_ngcontent-%COMP%]{background-color:#555;color:#ccc}.not-specified[_ngcontent-%COMP%]{color:gray}.self-only[_ngcontent-%COMP%]{color:red;vertical-align:text-top}.section[_ngcontent-%COMP%]{margin-top:.4em}"]}),t})();function HI(t){return new f(n=>{ur(t()).subscribe(n)})}const gX=["addListener","removeListener"],mX=["addEventListener","removeEventListener"],_X=["on","off"];function ag(t,n,e,i){if(a(e)&&(i=e,e=void 0),i)return ag(t,n,e).pipe(yd(i));const[r,s]=function bX(t){return a(t.addEventListener)&&a(t.removeEventListener)}(t)?mX.map(o=>d=>t[o](n,d,e)):function $X(t){return a(t.addListener)&&a(t.removeListener)}(t)?gX.map(VI(t,n)):function vX(t){return a(t.on)&&a(t.off)}(t)?_X.map(VI(t,n)):[];if(!r&&Qa(t))return jo(o=>ag(o,n,e))(ur(t));if(!r)throw new TypeError("Invalid event target");return new f(o=>{const d=(...$)=>o.next(1<$.length?$:$[0]);return r(d),()=>s(d)})}function VI(t,n){return e=>i=>t[e](n,i)}const Ya=new f(V);class yX extends u{constructor(n,e){super()}schedule(n,e=0){return this}}const lg={setInterval(t,n,...e){const{delegate:i}=lg;return(null==i?void 0:i.setInterval)?i.setInterval(t,n,...e):setInterval(t,n,...e)},clearInterval(t){const{delegate:n}=lg;return((null==n?void 0:n.clearInterval)||clearInterval)(t)},delegate:void 0},GI={now:()=>(GI.delegate||Date).now(),delegate:void 0};class lf{constructor(n,e=lf.now){this.schedulerActionCtor=n,this.now=e}schedule(n,e=0,i){return new this.schedulerActionCtor(this,n).schedule(i,e)}}lf.now=GI.now;const qI=new class xX extends lf{constructor(n,e=lf.now){super(n,e),this.actions=[],this._active=!1}flush(n){const{actions:e}=this;if(this._active)return void e.push(n);let i;this._active=!0;do{if(i=n.execute(n.state,n.delay))break}while(n=e.shift());if(this._active=!1,i){for(;n=e.shift();)n.unsubscribe();throw i}}}(class CX extends yX{constructor(n,e){super(n,e),this.scheduler=n,this.work=e,this.pending=!1}schedule(n,e=0){var i;if(this.closed)return this;this.state=n;const r=this.id,s=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(s,r,e)),this.pending=!0,this.delay=e,this.id=null!==(i=this.id)&&void 0!==i?i:this.requestAsyncId(s,this.id,e),this}requestAsyncId(n,e,i=0){return lg.setInterval(n.flush.bind(n,this),i)}recycleAsyncId(n,e,i=0){if(null!=i&&this.delay===i&&!1===this.pending)return e;null!=e&&lg.clearInterval(e)}execute(n,e){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const i=this._execute(n,e);if(i)return i;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(n,e){let r,i=!1;try{this.work(n)}catch(s){i=!0,r=s||new Error("Scheduled action threw falsy error")}if(i)return this.unsubscribe(),r}unsubscribe(){if(!this.closed){const{id:n,scheduler:e}=this,{actions:i}=e;this.work=this.state=this.scheduler=null,this.pending=!1,p(i,this),null!=n&&(this.id=this.recycleAsyncId(e,n,null)),this.delay=null,super.unsubscribe()}}}),wX=qI;function WI(t,n){return n?e=>Bp(n.pipe(Mo(1),function EX(){return R((t,n)=>{t.subscribe(ie(n,V))})}()),e.pipe(WI(t))):jo((e,i)=>t(e,i).pipe(Mo(1),function TX(t){return ve(()=>t)}(e)))}const cf="Service workers are disabled or not supported by this browser";class cg{constructor(n){if(this.serviceWorker=n,n){const i=ag(n,"controllerchange").pipe(ve(()=>n.controller)),s=Bp(HI(()=>Va(n.controller)),i);this.worker=s.pipe(Fl(Q=>!!Q)),this.registration=this.worker.pipe(Yd(()=>n.getRegistration()));const I=ag(n,"message").pipe(ve(Q=>Q.data)).pipe(Fl(Q=>Q&&Q.type)).pipe(Q3());I.connect(),this.events=I}else this.worker=this.events=this.registration=function MX(t){return HI(()=>function pX(t,n){const e=a(t)?t:()=>t,i=r=>r.error(e());return new f(n?r=>n.schedule(i,0,r):i)}(new Error(t)))}(cf)}postMessage(n,e){return this.worker.pipe(Mo(1),Z3(i=>{i.postMessage(Object.assign({action:n},e))})).toPromise().then(()=>{})}postMessageWithOperation(n,e,i){const r=this.waitForOperationCompleted(i),s=this.postMessage(n,e);return Promise.all([s,r]).then(([,o])=>o)}generateNonce(){return Math.round(1e7*Math.random())}eventsOfType(n){let e;return e="string"==typeof n?i=>i.type===n:i=>n.includes(i.type),this.events.pipe(Fl(e))}nextEventOfType(n){return this.eventsOfType(n).pipe(Mo(1))}waitForOperationCompleted(n){return this.eventsOfType("OPERATION_COMPLETED").pipe(Fl(e=>e.nonce===n),Mo(1),ve(e=>{if(void 0!==e.result)return e.result;throw new Error(e.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}}let DX=(()=>{class t{constructor(e){if(this.sw=e,this.subscriptionChanges=new le,!e.isEnabled)return this.messages=Ya,this.notificationClicks=Ya,void(this.subscription=Ya);this.messages=this.sw.eventsOfType("PUSH").pipe(ve(r=>r.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(ve(r=>r.data)),this.pushManager=this.sw.registration.pipe(ve(r=>r.pushManager));const i=this.pushManager.pipe(Yd(r=>r.getSubscription()));this.subscription=Ur(i,this.subscriptionChanges)}get isEnabled(){return this.sw.isEnabled}requestSubscription(e){if(!this.sw.isEnabled)return Promise.reject(new Error(cf));const i={userVisibleOnly:!0};let r=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),s=new Uint8Array(new ArrayBuffer(r.length));for(let o=0;o<r.length;o++)s[o]=r.charCodeAt(o);return i.applicationServerKey=s,this.pushManager.pipe(Yd(o=>o.subscribe(i)),Mo(1)).toPromise().then(o=>(this.subscriptionChanges.next(o),o))}unsubscribe(){return this.sw.isEnabled?this.subscription.pipe(Mo(1),Yd(i=>{if(null===i)throw new Error("Not subscribed to push notifications.");return i.unsubscribe().then(r=>{if(!r)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})})).toPromise():Promise.reject(new Error(cf))}decodeBase64(e){return atob(e)}}return t.\u0275fac=function(e){return new(e||t)(tn(cg))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})(),KI=(()=>{class t{constructor(e){if(this.sw=e,!e.isEnabled)return this.versionUpdates=Ya,this.available=Ya,this.activated=Ya,void(this.unrecoverable=Ya);this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY"]),this.available=this.versionUpdates.pipe(Fl(i=>"VERSION_READY"===i.type),ve(i=>({type:"UPDATE_AVAILABLE",current:i.currentVersion,available:i.latestVersion}))),this.activated=this.sw.eventsOfType("UPDATE_ACTIVATED"),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}get isEnabled(){return this.sw.isEnabled}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(cf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(cf));const e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e)}}return t.\u0275fac=function(e){return new(e||t)(tn(cg))},t.\u0275prov=Zt({token:t,factory:t.\u0275fac}),t})();class p1{}const YI=new In("NGSW_REGISTER_SCRIPT");function AX(t,n,e,i){return()=>{if(!l$(i)||!("serviceWorker"in navigator)||!1===e.enabled)return;let s;if(navigator.serviceWorker.addEventListener("controllerchange",()=>{null!==navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"INITIALIZE"})}),"function"==typeof e.registrationStrategy)s=e.registrationStrategy();else{const[d,...$]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(d){case"registerImmediately":s=Va(null);break;case"registerWithDelay":s=ZI(+$[0]||0);break;case"registerWhenStable":s=$[0]?Ur(XI(t),ZI(+$[0])):XI(t);break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`)}}t.get(bn).runOutsideAngular(()=>s.pipe(Mo(1)).subscribe(()=>navigator.serviceWorker.register(n,{scope:e.scope}).catch(d=>console.error("Service worker registration failed with:",d))))}}function ZI(t){return Va(null).pipe(function kX(t,n=qI){const e=function SX(t=0,n,e=wX){let i=-1;return null!=n&&(wu(n)?e=n:i=n),new f(r=>{let s=function IX(t){return t instanceof Date&&!isNaN(t)}(t)?+t-e.now():t;s<0&&(s=0);let o=0;return e.schedule(function(){r.closed||(r.next(o++),0<=i?this.schedule(void 0,i):r.complete())},s)})}(t,n);return WI(()=>e)}(t))}function XI(t){return t.get(V_).isStable.pipe(Fl(e=>e))}function PX(t,n){return new cg(l$(n)&&!1!==t.enabled?navigator.serviceWorker:void 0)}let NX=(()=>{class t{static register(e,i={}){return{ngModule:t,providers:[{provide:YI,useValue:e},{provide:p1,useValue:i},{provide:cg,useFactory:PX,deps:[p1,fd]},{provide:F_,useFactory:AX,deps:[Gr,YI,p1,fd],multi:!0}]}}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({providers:[DX,KI]}),t})();class FX{constructor(n){this.canvasElement=n}makeBrush(n,e,i){n.strokeStyle=i,n.fillStyle=n.strokeStyle,n.lineWidth=1;let r=Math.floor(e/5);return n.font=`bold ${r}px sans-serif`,n.textBaseline="top",n.textAlign="center",n}render(n,e,i=50,r=aa.SQUARE,s="#000000e6",o=!0){this.canvasElement.width=n*i,this.canvasElement.height=e*i;let d=this.canvasElement.getContext("2d");if(r<0)return;let $=this.generateCalcGridPositionFunc(r);this.makeBrush(d,i,s);for(let I=0;I<=e;I++)for(let Q=0;Q<=n;Q++){let{gx:fe,gy:_e}=$(Q,I,i);this.strokeSquare(d,fe,_e,i),o&&d.fillText((Q+1).toString()+"-"+(I+1).toString(),fe+i/2,_e+i/2)}}generateCalcGridPositionFunc(n){switch(n){case aa.HEX_VERTICAL:return(e,i,r)=>e%2==1?{gx:e*r,gy:i*r}:{gx:e*r,gy:i*r+r/2};case aa.HEX_HORIZONTAL:return(e,i,r)=>i%2==1?{gx:e*r,gy:i*r}:{gx:e*r+r/2,gy:i*r};default:return(e,i,r)=>({gx:e*r,gy:i*r})}}strokeSquare(n,e,i,r){n.beginPath(),n.strokeRect(e,i,r,r)}strokeHex(n,e,i,r,s){let o=s===aa.HEX_HORIZONTAL?-30:0,d=r/Math.sqrt(3),$=e+r/2,I=i+r/2;n.beginPath();for(let Q=0;Q<6;Q++){o+=60;let fe=Math.PI/180*o,_e=Math.cos(fe)*d+$,Ce=Math.sin(fe)*d+I;n.lineTo(_e,Ce)}n.closePath(),n.stroke()}}var ql=(()=>(function(t){t.DRAG="drag",t.ZOOM="zoom",t.ROTATE="rotate",t.KEYBOARD="keyboard"}(ql||(ql={})),ql))(),zs=(()=>(function(t){t.ArrowLeft="ArrowLeft",t.ArrowUp="ArrowUp",t.ArrowRight="ArrowRight",t.ArrowDown="ArrowDown"}(zs||(zs={})),zs))();class RX{constructor(n){this.targetElement=n,this.currentPositionX=0,this.currentPositionY=0,this.buttonCode=0,this.input=null,this.callbackOnWheel=e=>this.onWheel(e),this.callbackOnKeydown=e=>this.onKeydown(e),this.onstart=null,this.onend=null,this.ontransform=null,this.initialize()}get isGrabbing(){return this.input.isGrabbing}get isDragging(){return this.input.isDragging}initialize(){this.input=new so(this.targetElement,{capture:!0}),this.addEventListeners(),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this)}cancel(){this.input.cancel()}destroy(){this.input.destroy(),this.removeEventListeners()}onInputStart(n){this.currentPositionX=this.input.pointer.x,this.currentPositionY=this.input.pointer.y,this.buttonCode=n.button,this.onstart&&this.onstart(n)}onInputEnd(n){this.onend&&this.onend(n)}onInputMove(n){let e=this.input.pointer.x,i=this.input.pointer.y,r=e-this.currentPositionX,s=i-this.currentPositionY,o=0,d=0,I=0,fe=0,_e=ql.DRAG;2===this.buttonCode?(_e=ql.ROTATE,fe=-r/5,I=-s/5):(o=r,d=s),this.currentPositionX=e,this.currentPositionY=i,this.ontransform&&this.ontransform(o,d,0,I,0,fe,_e,n)}onWheel(n){let e=0;switch(n.deltaMode){case WheelEvent.DOM_DELTA_LINE:e=16*n.deltaY;break;case WheelEvent.DOM_DELTA_PAGE:e=n.deltaY*window.innerHeight;break;default:e=n.deltaY}let s=0;s=-1.5*e,9e4<s**2&&(s=Math.min(Math.max(s,-300),300)),this.ontransform&&this.ontransform(0,0,s,0,0,0,ql.ZOOM,n)}onKeydown(n){let e=0,i=0,r=0,s=0,d=0,$=this.getKeyName(n);switch($){case zs.ArrowLeft:n.shiftKey?d=-2:e=10;break;case zs.ArrowUp:n.shiftKey?s=-2:n.ctrlKey?r=150:i=10;break;case zs.ArrowRight:n.shiftKey?d=2:e=-10;break;case zs.ArrowDown:n.shiftKey?s=2:n.ctrlKey?r=-150:i=-10}null!=zs[$]&&this.ontransform&&this.ontransform(e,i,r,s,0,d,ql.KEYBOARD,n)}getKeyName(n){if(n.key)return n.key;switch(n.keyCode){case 37:return zs.ArrowLeft;case 38:return zs.ArrowUp;case 39:return zs.ArrowRight;case 40:return zs.ArrowDown;default:return""}}addEventListeners(){this.targetElement.addEventListener("wheel",this.callbackOnWheel,!1),document.body.addEventListener("keydown",this.callbackOnKeydown,!1)}removeEventListeners(){this.targetElement.removeEventListener("wheel",this.callbackOnWheel,!1),document.body.removeEventListener("keydown",this.callbackOnKeydown,!1)}}var Za=(()=>(function(t){t.PAN="pan",t.TAP_PINCH="tappinch",t.PINCH="pinch",t.ROTATE="rotate"}(Za||(Za={})),Za))();class OX{constructor(n,e){this.targetElement=n,this.ngZone=e,this.hammer=null,this.deltaHammerDeltaX=0,this.deltaHammerDeltaY=1,this.deltaHammerScale=1,this.deltaHammerRotation=0,this.prevHammerDeltaX=0,this.prevHammerDeltaY=0,this.prevHammerScale=0,this.prevHammerRotation=0,this.tappedPanTimer=null,this.tappedPanCenter={x:0,y:0},this.onstart=null,this.onend=null,this.ongesture=null,this.ontransform=null,this.initializeHammer()}destroy(){this.clearTappedPanTimer(),this.hammer.destroy()}initializeHammer(){this.hammer=new Hammer.Manager(this.targetElement,{inputClass:Hammer.TouchInput});let n=new Hammer.Tap,e=new Hammer.Pan({event:"pan1p",pointers:1,threshold:0}),i=new Hammer.Pan({event:"pan2p",pointers:2,threshold:0}),r=new Hammer.Pinch,s=new Hammer.Rotate;e.recognizeWith(i),e.recognizeWith(s),e.recognizeWith(r),i.recognizeWith(r),i.recognizeWith(s),r.recognizeWith(s),this.hammer.add([n,e,i,r,s]),this.hammer.on("hammer.input",this.onHammer.bind(this)),this.hammer.on("tap",this.onTap.bind(this)),this.hammer.on("pan1pstart",this.onTappedPanStart.bind(this)),this.hammer.on("pan1pmove",this.onTappedPanMove.bind(this)),this.hammer.on("pan1pend",this.onTappedPanEnd.bind(this)),this.hammer.on("pan1pcancel",this.onTappedPanEnd.bind(this)),this.hammer.on("pan2pmove",this.onPanMove.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("rotatemove",this.onRotateMove.bind(this));let o=window.navigator.userAgent.toLowerCase();(o.indexOf("iphone")>-1||o.indexOf("ipad")>-1||o.indexOf("macintosh")>-1&&"ontouchend"in document)&&(this.hammer.add(new Hammer.Press({time:251})),this.hammer.on("press",$=>{let I=new MouseEvent("contextmenu",{bubbles:!0,cancelable:!0,clientX:$.center.x,clientY:$.center.y});this.ngZone.run(()=>$.srcEvent.target.dispatchEvent(I))}))}onHammer(n){n.isFirst?(this.deltaHammerScale=n.scale,this.deltaHammerRotation=n.rotation,this.deltaHammerDeltaX=n.deltaX,this.deltaHammerDeltaY=n.deltaY,this.onstart&&this.onstart(n.srcEvent)):n.isFinal?this.onend&&this.onend(n.srcEvent):(this.deltaHammerScale=n.scale-this.prevHammerScale,this.deltaHammerRotation=n.rotation-this.prevHammerRotation,this.deltaHammerDeltaX=n.deltaX-this.prevHammerDeltaX,this.deltaHammerDeltaY=n.deltaY-this.prevHammerDeltaY),this.prevHammerScale=n.scale,this.prevHammerRotation=n.rotation,this.prevHammerDeltaX=n.deltaX,this.prevHammerDeltaY=n.deltaY,null!=this.tappedPanTimer&&n.eventType==Hammer.INPUT_START&&2500<(this.tappedPanCenter.x-n.center.x)**2+(this.tappedPanCenter.y-n.center.y)**2&&this.clearTappedPanTimer()}onTap(n){this.tappedPanCenter=n.center,this.tappedPanTimer=setTimeout(()=>{this.tappedPanTimer=null},400),this.ongesture&&this.ongesture(n.srcEvent)}onTappedPanStart(n){null!=this.tappedPanTimer&&(this.clearTappedPanTimer(!1),this.ongesture&&this.ongesture(n.srcEvent))}onTappedPanEnd(n){this.clearTappedPanTimer()}onTappedPanMove(n){if(null==this.tappedPanTimer){let e=this.deltaHammerDeltaX,i=this.deltaHammerDeltaY,r=0;this.ontransform&&this.ontransform(e,i,r,0,0,0,Za.PAN,n.srcEvent)}else{this.clearTappedPanTimer(!1);let i=7.5*this.deltaHammerDeltaY;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,i,0,0,0,Za.TAP_PINCH,n.srcEvent)}}onPanMove(n){this.clearTappedPanTimer();let e=-this.deltaHammerDeltaY/window.innerHeight*100;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,e,0,0,Za.ROTATE,n.srcEvent)}onPinchMove(n){this.clearTappedPanTimer();let e=500*this.deltaHammerScale;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,e,0,0,0,Za.PINCH,n.srcEvent)}onRotateMove(n){this.clearTappedPanTimer();let e=this.deltaHammerRotation;this.ongesture&&this.ongesture(n.srcEvent),this.ontransform&&this.ontransform(0,0,0,0,0,e,Za.ROTATE,n.srcEvent)}clearTappedPanTimer(n=!0){clearTimeout(this.tappedPanTimer),n&&(this.tappedPanTimer=null)}}let g1=(()=>{class t{constructor(){}createGameCharacter(e){let i=jt.create("\u65b0\u3057\u3044\u30ad\u30e3\u30e9\u30af\u30bf\u30fc",1,"");return i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z,i}createGameTableMask(e){let i=this.getViewTable();if(!i)return;let r=Jr.create("\u30de\u30c3\u30d7\u30de\u30b9\u30af",5,5,100);return r.location.x=e.x-25,r.location.y=e.y-25,r.posZ=e.z,i.appendChild(r),r}createTerrain(e){let i="./assets/images/tex.jpg",r=It.instance.get(i);r||(r=It.instance.add(i),mn.create(r.identifier).tag="*default \u5730\u5f62");let s=this.getViewTable();if(!s)return;let o=nr.create("\u5730\u5f62",2,2,2,r.identifier,r.identifier);return o.location.x=e.x-50,o.location.y=e.y-50,o.posZ=e.z,s.appendChild(o),o}createTextNote(e){let i=vs.create("\u5171\u6709\u30e1\u30e2","\u30c6\u30ad\u30b9\u30c8\u3092\u5165\u529b\u3057\u3066\u304f\u3060\u3055\u3044",5,4,3);return i.location.x=e.x,i.location.y=e.y,i.posZ=e.z,i}createDiceSymbol(e,i,r,s){let o=tr.create(i,r,1),d=null;return o.nothingFaces.forEach($=>{let I=`./assets/images/dice/${s}/${s}[0].png`;d=It.instance.get(I),d||(d=It.instance.add(I),mn.create(d.identifier).tag="*default "+(r===wi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),o.imageDataElement.getFirstElementByName($).value=d.identifier}),o.faces.forEach($=>{let I=`./assets/images/dice/${s}/${s}[${$}].png`;d=It.instance.get(I),d||(d=It.instance.add(I),mn.create(d.identifier).tag="*default "+(r===wi.D2?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")),o.imageDataElement.getFirstElementByName($).value=d.identifier}),o.location.x=e.x-25,o.location.y=e.y-25,o.posZ=e.z,o}createBlankCard(e){const i="./assets/images/trump/blank_card.png",r="./assets/images/trump/z01.gif";let s,o;s=It.instance.get(i),s||(s=It.instance.add(i),mn.create(s.identifier).tag="*default \u30ab\u30fc\u30c9"),o=It.instance.get(r),o||(o=It.instance.add(r),mn.create(o.identifier).tag="*default \u30ab\u30fc\u30c9");let d=Fn.create("\u30ab\u30fc\u30c9",s.identifier,o.identifier);return d.location.x=e.x-25,d.location.y=e.y-25,d.posZ=e.z,d}cardName(e){let i="";const r=e.slice(0,1),s=parseInt(e.substring(1,3));switch(r){case"c":i="\u30af\u30e9\u30d6";break;case"d":i="\u30c0\u30a4\u30e4";break;case"h":i="\u30cf\u30fc\u30c8";break;case"s":i="\u30b9\u30da\u30fc\u30c9";break;case"x":i="\u30b8\u30e7\u30fc\u30ab\u30fc"}return i+="x"==r?`\uff08${1==s?"\u8d64":"\u9ed2"}\uff09`:`\u306e${1==s?"\u30a8\u30fc\u30b9":s>=11?["\u30b8\u30e3\u30c3\u30af","\u30af\u30a4\u30fc\u30f3","\u30ad\u30f3\u30b0"][s-11]:s}`,i}createTrump(e){let i=Un.create("\u30c8\u30e9\u30f3\u30d7\u5c71\u672d");i.location.x=e.x-25,i.location.y=e.y-25,i.posZ=e.z;let r="./assets/images/trump/z02.gif";if(!It.instance.get(r)){const d=It.instance.add(r);mn.create(d.identifier).tag="*default \u30ab\u30fc\u30c9"}let s=["c","d","h","s"],o=[];for(let d of s)for(let $=1;$<=13;$++)o.push(d+("00"+$).slice(-2));o.push("x01"),o.push("x02");for(let d of o){let $="./assets/images/trump/"+d+".gif";if(!It.instance.get($)){const Q=It.instance.add($);mn.create(Q.identifier).tag="*default \u30ab\u30fc\u30c9"}let I=Fn.create(this.cardName(d),$,r);i.putOnBottom(I)}return i}makeDefaultTable(){let e=new Fi("gameTable"),i=null,r=Lt.createEmpty("testTableBackgroundImage_image").toContext();r.url="./assets/images/BG10a_80.jpg",i=It.instance.add(r),mn.create(i.identifier).tag="*default \u30c6\u30fc\u30d6\u30eb",e.name="\u6700\u521d\u306e\u30c6\u30fc\u30d6\u30eb",e.imageIdentifier=i.identifier,e.width=20,e.height=15,e.initialize(),ir.instance.viewTableIdentifier=e.identifier}makeDefaultTabletopObjects(){let e=null,i=null,r=null;e=new jt("testCharacter_1"),r=Lt.createEmpty("testCharacter_1_image").toContext(),r.url="./assets/images/mon_052.gif",i=It.instance.add(r),mn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=250,e.location.y=450,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcA",1,i.identifier),e=new jt("testCharacter_2"),e.location.x=400,e.location.y=400,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcB",1,i.identifier),e=new jt("testCharacter_3"),r=Lt.createEmpty("testCharacter_3_image").toContext(),r.url="./assets/images/mon_128.gif",i=It.instance.add(r),mn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=200,e.location.y=100,e.initialize(),e.createTestGameDataElement("\u30e2\u30f3\u30b9\u30bf\u30fcC",3,i.identifier),e=new jt("testCharacter_4"),r=Lt.createEmpty("testCharacter_4_image").toContext(),r.url="./assets/images/mon_150.gif",i=It.instance.add(r),mn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=300,e.location.y=550,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcA",1,i.identifier),e=new jt("testCharacter_5"),r=Lt.createEmpty("testCharacter_5_image").toContext(),r.url="./assets/images/mon_211.gif",i=It.instance.add(r),mn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.location.x=600,e.location.y=600,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcB",1,i.identifier),e=new jt("testCharacter_6"),r=Lt.createEmpty("testCharacter_6_image").toContext(),r.url="./assets/images/mon_135.gif",i=It.instance.add(r),mn.create(i.identifier).tag="*default \u30ad\u30e3\u30e9\u30af\u30bf\u30fc",e.initialize(),e.location.x=250,e.location.y=650,e.initialize(),e.createTestGameDataElement("\u30ad\u30e3\u30e9\u30af\u30bf\u30fcC",1,i.identifier)}makeDefaultContextMenuActions(e){return[this.getCreateCharacterMenu(e),this.getCreateTableMaskMenu(e),this.getCreateTerrainMenu(e),this.getCreateTextNoteMenu(e),this.getCreateBlankCardMenu(e),this.getCreateTrumpMenu(e),this.getCreateDiceSymbolMenu(e)]}getCreateCharacterMenu(e){return{name:"\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u3092\u4f5c\u6210",action:()=>{let i=this.createGameCharacter(e);Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:i.identifier,className:i.aliasName}),ut.play(Xe.piecePut)}}}getCreateTableMaskMenu(e){return{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u4f5c\u6210",action:()=>{this.createGameTableMask(e),ut.play(Xe.cardPut)}}}getCreateTerrainMenu(e){return{name:"\u5730\u5f62\u3092\u4f5c\u6210",action:()=>{this.createTerrain(e),ut.play(Xe.blockPut)}}}getCreateTextNoteMenu(e){return{name:"\u5171\u6709\u30e1\u30e2\u3092\u4f5c\u6210",action:()=>{this.createTextNote(e),ut.play(Xe.cardPut)}}}getCreateBlankCardMenu(e){return{name:"\u30d6\u30e9\u30f3\u30af\u30ab\u30fc\u30c9\u3092\u4f5c\u6210",action:()=>{this.createBlankCard(e),ut.play(Xe.cardPut)}}}getCreateTrumpMenu(e){return{name:"\u30c8\u30e9\u30f3\u30d7\u306e\u5c71\u672d\u3092\u4f5c\u6210",action:()=>{this.createTrump(e),ut.play(Xe.cardPut)}}}getCreateDiceSymbolMenu(e){let r=[];return[{menuName:"\u30b3\u30a4\u30f3 (\u8868/\u88cf)",diceName:"\u30b3\u30a4\u30f3",type:wi.D2,imagePathPrefix:"2_coin"},{menuName:"D4",diceName:"D4",type:wi.D4,imagePathPrefix:"4_dice"},{menuName:"D6",diceName:"D6",type:wi.D6,imagePathPrefix:"6_dice"},{menuName:"D6 (Black)",diceName:"D6",type:wi.D6,imagePathPrefix:"6_dice_black"},{menuName:"D8",diceName:"D8",type:wi.D8,imagePathPrefix:"8_dice"},{menuName:"D10",diceName:"D10",type:wi.D10,imagePathPrefix:"10_dice"},{menuName:"D10 (00-90)",diceName:"D10",type:wi.D10_10TIMES,imagePathPrefix:"100_dice"},{menuName:"D12",diceName:"D12",type:wi.D12,imagePathPrefix:"12_dice"},{menuName:"D20",diceName:"D20",type:wi.D20,imagePathPrefix:"20_dice"}].forEach(s=>{r.push({name:s.menuName,action:()=>{this.createDiceSymbol(e,s.diceName,s.type,s.imagePathPrefix),ut.play(Xe.dicePut)}})}),{name:"\u30c0\u30a4\u30b9\u3092\u4f5c\u6210",action:null,subActions:r}}getViewTable(){return ir.instance.viewTable}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=Zt({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Wl=(()=>{class t{constructor(e,i,r,s,o,d){this.ngZone=e,this.elementRef=i,this.batchService=r,this.pointerDeviceService=s,this.coordinateService=o,this.tabletopService=d,this.layerName="",this.colideLayers=[],this.transformCssOffset="",this.isDisable=!1,this.isInteract=!0,this.onstart=new vn,this.ondragstart=new vn,this.ondrag=new vn,this.ondragend=new vn,this.onend=new vn,this._posX=0,this._posY=0,this._posZ=0,this.pointerOffset2d={x:0,y:0,z:0},this.pointerStart3d={x:0,y:0,z:0},this.height=0,this.width=0,this.ratio=1,this.updateTimer=null,this.collidableElements=[],this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.layerName=null!=e.layerName?e.layerName:this.layerName,this.colideLayers=null!=e.colideLayers?e.colideLayers:this.colideLayers,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get posX(){return this._posX}set posX(e){this._posX=e,this.setUpdateTimer()}get posY(){return this._posY}set posY(e){this._posY=e,this.setUpdateTimer()}get posZ(){return this._posZ}set posZ(e){this._posZ=e,this.setUpdateTimer()}get isGridSnap(){return ir.instance.gridSnap}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.setPosition(this.tabletopObject)}ngOnDestroy(){this.cancel(),this.input.destroy(),this.unregister(),Fe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new so(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setPosition(this.tabletopObject)},this)}),this.layerName.length<1&&this.tabletopObject&&(this.layerName=this.tabletopObject.aliasName),this.register(),this.findCollidableElements(),this.setPosition(this.tabletopObject)}cancel(){this.input.cancel(),this.setPointerEvents(!0),this.setAnimatedTransition(!0),this.setCollidableLayer(!1),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.callSelectedEvent(),this.collidableElements.length<1&&this.findCollidableElements(),this.isDisable||1===e.button||2===e.button)return this.cancel();this.onstart.emit(e),this.setPointerEvents(!1),this.setAnimatedTransition(!1),this.setCollidableLayer(this.isInteract),this.width=this.nativeElement.clientWidth,this.height=this.nativeElement.clientHeight;let i={x:this.posX+this.width/2,y:this.posY+this.height/2,z:this.posZ},r=this.coordinateService.convertToGlobal(i,this.coordinateService.tabletopOriginElement);this.setPointerEvents(!0),this.pointerOffset2d.x=r.x-this.input.pointer.x,this.pointerOffset2d.y=r.y-this.input.pointer.y,this.pointerOffset2d.z=r.z-this.input.pointer.z,this.pointerStart3d.x=i.x,this.pointerStart3d.y=i.y,this.pointerStart3d.z=i.z,this.targetStartRect=this.nativeElement.getBoundingClientRect(),this.ratio=1,this.tabletopService.tableSelecter.viewTable.gridHeight=this.posZ+.5,this.setUpdateTimer()}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),this.input.isDragging||this.setPointerEvents(!1);let i={x:this.input.pointer.x+this.pointerOffset2d.x*this.ratio,y:this.input.pointer.y+this.pointerOffset2d.y*this.ratio,z:0};i.x=Math.min(window.innerWidth-.1,Math.max(i.x,.1)),i.y=Math.min(window.innerHeight-.1,Math.max(i.y,.1));let r=document.elementFromPoint(i.x,i.y);if(null==r)return;let s=this.coordinateService.calcTabletopLocalCoordinate(i,r);if(s.x-=this.width/2,s.y-=this.height/2,this.posX===s.x&&this.posY===s.y&&this.posZ===s.z)return;this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e);let d=this.nativeElement.getBoundingClientRect().width/this.targetStartRect.width;d<this.ratio&&(this.ratio+=.1*(d-this.ratio)),this.posX=s.x,this.posY=s.y,this.posZ=s.z,ir.instance.viewTable.gridHeight=this.posZ+.5}onInputEnd(e){if(this.isDisable)return this.cancel();this.input.isDragging&&this.ondragend.emit(e),this.isGridSnap&&this.input.isDragging&&this.snapToGrid(),this.cancel(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.isGridSnap&&this.input.isDragging&&this.snapToGrid();let i=this.input.isGrabbing&&e.isTrusted;if(this.cancel(),i){e.stopPropagation();let r=new MouseEvent(e.type,e);this.ngZone.run(()=>this.nativeElement.dispatchEvent(r))}}callSelectedEvent(){this.tabletopObject&&Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.tabletopObject.identifier,className:this.tabletopObject.aliasName})}snapToGrid(e=25){this.posX=this.calcSnapNum(this.posX,e),this.posY=this.calcSnapNum(this.posY,e)}calcSnapNum(e,i){return i<=0?e:(e=e<0?e-i/2:e+i/2)-e%i}setPosition(e){this._posX=e.location.x,this._posY=e.location.y,this._posZ=e.posZ,this.updateTransformCss()}setUpdateTimer(){null===this.updateTimer&&this.tabletopObject&&(this.updateTimer=setTimeout(()=>{this.tabletopObject.location.x=this.posX,this.tabletopObject.location.y=this.posY,this.tabletopObject.posZ=this.posZ,this.updateTimer=null},66)),this.updateTransformCss()}findCollidableElements(){this.collidableElements=[],"none"===getComputedStyle(this.nativeElement).pointerEvents?this.findNestedCollidableElements(this.nativeElement):this.collidableElements=[this.nativeElement]}findNestedCollidableElements(e){let i=e.children;for(let r=0;r<i.length;r++){let s=i[r];s instanceof HTMLElement&&"none"!==getComputedStyle(s).pointerEvents&&this.collidableElements.push(s)}if(this.collidableElements.length<1)for(let r=0;r<i.length;r++){let s=i[r];s instanceof HTMLElement&&this.findNestedCollidableElements(s)}}setPointerEvents(e){let i=e?"auto":"none";this.collidableElements.forEach(r=>r.style.pointerEvents=i)}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.location.x!==this.posX||e.location.y!==this.posY||e.posZ!==this.posZ}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} translate3d(${this.posX.toFixed(4)}px, ${this.posY.toFixed(4)}px, ${this.posZ.toFixed(4)}px)`;this.nativeElement.style.transform=e}setCollidableLayer(e){let i=e;for(let r in t.layerHash)i=-1<this.colideLayers.indexOf(r)?"character"==r?!this.input.isGrabbing||e&&!this.tabletopObject.isNotRide:!this.input.isGrabbing||e:!e,t.layerHash[r].forEach(s=>{s===this||s.input.isGrabbing||s.setPointerEvents(i)})}register(){this.layerName in t.layerHash||(t.layerHash[this.layerName]=[]),t.layerHash[this.layerName].indexOf(this)<0&&t.layerHash[this.layerName].push(this)}unregister(){if(!(this.layerName in t.layerHash))return;let e=t.layerHash[this.layerName].indexOf(this);-1<e&&t.layerHash[this.layerName].splice(e,1)}}return t.layerHash={},t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(pi),Oe(rg),Oe(li),Oe(Ul),Oe(af))},t.\u0275dir=Gt({type:t,selectors:[["","appMovable",""]],inputs:{option:["movable.option","option"],isDisable:["movable.disable","isDisable"],isInteract:["movable.interact","isInteract"]},outputs:{onstart:"movable.onstart",ondragstart:"movable.ondragstart",ondrag:"movable.ondrag",ondragend:"movable.ondragend",onend:"movable.onend"}}),t})(),bu=(()=>{class t{constructor(e,i,r,s,o){this.elementRef=e,this.batchService=i,this.pointerDeviceService=r,this.coordinateService=s,this.tabletopService=o,this.transformCssOffset="",this.grabbingSelecter=".rotate-grab",this.isDisable=!1,this.onstart=new vn,this.ondragstart=new vn,this.ondrag=new vn,this.ondragend=new vn,this.onend=new vn,this._rotate=0,this.valueChange=new vn,this.rotateOffset=0,this.updateTimer=null,this.grabbingElement=null,this.input=null}set option(e){this.tabletopObject=null!=e.tabletopObject?e.tabletopObject:this.tabletopObject,this.grabbingSelecter=null!=e.grabbingSelecter?e.grabbingSelecter:this.grabbingSelecter,this.transformCssOffset=null!=e.transformCssOffset?e.transformCssOffset:this.transformCssOffset}get nativeElement(){return this.elementRef.nativeElement}get rotate(){return this._rotate}set rotate(e){this._rotate=e,this.setUpdateTimer()}set value(e){this._rotate=e,this.updateTransformCss()}get isAllowedToRotate(){if(!this.grabbingElement||!this.nativeElement)return!1;if(this.grabbingSelecter.length<1)return!0;let e=this.nativeElement.querySelectorAll(this.grabbingSelecter),i=!1;for(let r=0;r<e.length;r++)if(i=e[r].contains(this.grabbingElement),i)return!0;return!1}ngAfterViewInit(){this.batchService.add(()=>this.initialize(),this.elementRef),this.tabletopObject?this.setRotate(this.tabletopObject):this.updateTransformCss()}ngOnDestroy(){this.cancel(),this.input.destroy(),Fe.unregister(this),this.batchService.remove(this),this.batchService.remove(this.elementRef)}initialize(){this.input=new so(this.nativeElement),this.input.onStart=this.onInputStart.bind(this),this.input.onMove=this.onInputMove.bind(this),this.input.onEnd=this.onInputEnd.bind(this),this.input.onContextMenu=this.onContextMenu.bind(this),this.tabletopObject?(Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.isSendFromSelf&&this.input.isGrabbing||e.data.identifier!==this.tabletopObject.identifier||!this.shouldTransition(this.tabletopObject)||this.batchService.add(()=>{this.input.isGrabbing?this.cancel():this.setAnimatedTransition(!0),this.stopTransition(),this.setRotate(this.tabletopObject)},this)}),this.setRotate(this.tabletopObject)):this.updateTransformCss()}cancel(){this.input.cancel(),this.grabbingElement=null,this.setAnimatedTransition(!0),this.tabletopService.tableSelecter.viewTable&&(this.tabletopService.tableSelecter.viewTable.gridHeight=0)}onInputStart(e){if(this.grabbingElement=e.target,this.isDisable||!this.isAllowedToRotate||1===e.button||2===e.button)return this.cancel();e.stopPropagation(),this.onstart.emit(e);let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement);this.rotateOffset=this.calcRotate(i,this.rotate),this.setAnimatedTransition(!1),this.tabletopObject&&(this.tabletopService.tableSelecter.viewTable.gridHeight=this.tabletopObject.posZ+.5,this.setUpdateTimer())}onInputMove(e){if(this.input.isGrabbing&&!this.pointerDeviceService.isDragging)return this.cancel();if(this.isDisable||!this.input.isGrabbing)return this.cancel();e.cancelable&&e.preventDefault(),e.stopPropagation();let i=this.coordinateService.convertLocalToLocal(this.input.pointer,this.grabbingElement,this.nativeElement.parentElement),r=this.calcRotate(i,this.rotateOffset);this.input.isDragging||this.ondragstart.emit(e),this.ondrag.emit(e),this.rotate=r}onInputEnd(e){if(this.isDisable)return this.cancel();e.stopPropagation(),this.input.isDragging&&this.ondragend.emit(e),this.cancel(),this.snapToPolygonal(),this.onend.emit(e)}onContextMenu(e){if(this.isDisable)return this.cancel();e.cancelable&&e.preventDefault(),this.cancel(),this.snapToPolygonal()}calcRotate(e,i){return(180*Math.atan2(e.y-this.nativeElement.clientHeight/2,e.x-this.nativeElement.clientWidth/2)/Math.PI-i)%360}snapToPolygonal(e=24){e<=1||(this.rotate=this.rotate<0?this.rotate-180/e:this.rotate+180/e,this.rotate-=this.rotate%(360/e))}setUpdateTimer(){null===this.updateTimer&&(this.updateTimer=setTimeout(()=>{this.valueChange.emit(this.rotate),this.tabletopObject&&(this.tabletopObject.rotate=this.rotate),this.updateTimer=null},66)),this.updateTransformCss()}setRotate(e){e&&(this._rotate=e.rotate),this.updateTransformCss()}setAnimatedTransition(e){this.nativeElement.style.transition=e?"transform 132ms linear":""}shouldTransition(e){return e.rotate!==this.rotate}stopTransition(){this.nativeElement.style.transform=window.getComputedStyle(this.nativeElement).transform}updateTransformCss(){let e=`${this.transformCssOffset} rotateZ(${this.rotate.toFixed(4)}deg)`;this.nativeElement.style.transform=e}}return t.\u0275fac=function(e){return new(e||t)(Oe(pi),Oe(rg),Oe(li),Oe(Ul),Oe(af))},t.\u0275dir=Gt({type:t,selectors:[["","appRotable",""]],inputs:{option:["rotable.option","option"],isDisable:["rotable.disable","isDisable"],value:["rotable.value","value"]},outputs:{onstart:"rotable.onstart",ondragstart:"rotable.ondragstart",ondrag:"rotable.ondrag",ondragend:"rotable.ondragend",onend:"rotable.onend",valueChange:"rotable.valueChange"}}),t})();const QI=function(t){return{"blinking-animation":t}};function BX(t,n){if(1&t&&(X(0,"div",6),bt(1,"safe"),te()),2&t){const e=ge(2);Je("background-image",yt(1,3,"url("+e.floorImage.url+")","style")),re("ngClass",ct(6,QI,!e.isLocked))}}function LX(t,n){if(1&t&&(Ge(0),xe(1,BX,2,8,"div",5),qe()),2&t){const e=ge();W(1),re("ngIf",e.isDropShadow&&(0!=e.terreinAltitude||e.isSlope&&!e.hasWall))}}const zX=function(t,n,e){return{"backface-visibility":t,transform:n,filter:e}};function jX(t,n){if(1&t&&(Ge(0),X(1,"div",7),bt(2,"safe"),te(),qe()),2&t){const e=ge();W(1),Je("background-image",yt(2,4,"url("+e.floorImage.url+")","style")),re("ngClass",ct(7,QI,!e.isLocked))("ngStyle",qr(9,zX,e.isSlope?"visible":"hidden","translateZ("+e.height/(e.isSlope?2:1)*e.gridSize+"px)"+e.floorModCss,"brightness("+e.floorBrightness+")"))}}const ug=function(t,n,e,i){return{"blinking-animation":t,"no-shadow":n,"is-slope":e,"is-inverse-slope":i}};function UX(t,n){if(1&t&&(X(0,"div",9),bt(1,"safe"),te()),2&t){const e=ge(3);Je("background-image",yt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",Js(10,ug,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function HX(t,n){if(1&t&&(Ge(0),xe(1,UX,2,15,"div",8),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isVisibleWallTopBottom)}}function VX(t,n){if(1&t&&(X(0,"div",11),bt(1,"safe"),te()),2&t){const e=ge(3);Je("background-image",yt(1,7,"url("+e.wallImage.url+")","style"))("width",e.width*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",Js(10,ug,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.LEFT,e.slopeDirection==e.slopeDirectionState.RIGHT))}}function GX(t,n){if(1&t&&(Ge(0),xe(1,VX,2,15,"div",10),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isVisibleWallTopBottom)}}function qX(t,n){if(1&t&&(X(0,"div",13),bt(1,"safe"),te()),2&t){const e=ge(3);Je("background-image",yt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",Js(10,ug,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function WX(t,n){if(1&t&&(Ge(0),xe(1,qX,2,15,"div",12),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isVisibleWallLeftRight)}}function KX(t,n){if(1&t&&(X(0,"div",15),bt(1,"safe"),te()),2&t){const e=ge(3);Je("background-image",yt(1,7,"url("+e.wallImage.url+")","style"))("width",e.depth*e.gridSize,"px")("height",e.height*e.gridSize,"px"),re("ngClass",Js(10,ug,!e.isLocked,!e.isSurfaceShading,e.slopeDirection==e.slopeDirectionState.BOTTOM,e.slopeDirection==e.slopeDirectionState.TOP))}}function YX(t,n){if(1&t&&(Ge(0),xe(1,KX,2,15,"div",14),qe()),2&t){const e=ge(2);W(1),re("ngIf",e.isVisibleWallLeftRight)}}function ZX(t,n){if(1&t&&(Ge(0),xe(1,HX,2,1,"ng-container",2),xe(2,GX,2,1,"ng-container",2),xe(3,WX,2,1,"ng-container",2),xe(4,YX,2,1,"ng-container",2),qe()),2&t){const e=ge();W(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.TOP),W(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.BOTTOM),W(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.LEFT),W(1),re("ngIf",e.slopeDirection!=e.slopeDirectionState.RIGHT)}}function XX(t,n){if(1&t&&(Ge(0),X(1,"div",16),nt(2,"div",17),X(3,"div",18)(4,"i",19),be(5,"autorenew"),te()(),X(6,"div",20)(7,"i",19),be(8,"autorenew"),te()(),X(9,"div",21)(10,"i",19),be(11,"autorenew"),te()(),X(12,"div",22)(13,"i",19),be(14,"autorenew"),te()()(),qe()),2&t){const e=ge();W(1),Je("opacity",e.isInteract?"1.0":"0.5")("height",e.depth*e.gridSize,"px")}}const JI=function(t){return{transform:t}};function QX(t,n){if(1&t&&(X(0,"div",23)(1,"div",24),be(2),te(),X(3,"div",25),be(4),te()()),2&t){const e=ge();Je("height",e.math.abs(e.terreinAltitude*e.gridSize),"px"),re("ngStyle",ct(5,JI,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.depth*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.terreinAltitude>0?-(e.altitude+(e.isSlope||e.isWallExist?0:e.height))*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(2),Ze(e.math.abs(e.terreinAltitude)),W(2),Ze(e.math.abs(e.terreinAltitude))}}const JX=function(t){return{"is-grab":t}},eQ=function(t,n){return{"upright-transform":t,fall:n}};let tQ=(()=>{class t{constructor(e,i,r,s,o,d,$,I,Q,fe){this.ngZone=e,this.imageService=i,this.tabletopActionService=r,this.contextMenuService=s,this.elementRef=o,this.panelService=d,this.changeDetector=$,this.pointerDeviceService=I,this.modalService=Q,this.coordinateService=fe,this.terrain=null,this.is3D=!1,this.gridSize=50,this.movableOption={},this.rotableOption={},this.math=Math,this.slopeDirectionState=Zn,this.input=null,this.viewRotateZ=10}get name(){return this.terrain.name}get mode(){return this.terrain.mode}set mode(e){this.terrain.mode=e}get isLocked(){return this.terrain.isLocked}set isLocked(e){this.terrain.isLocked=e}get hasWall(){return this.terrain.hasWall}get hasFloor(){return this.terrain.hasFloor}get wallImage(){return this.imageService.getSkeletonOr(this.terrain.wallImage)}get floorImage(){return this.imageService.getSkeletonOr(this.terrain.floorImage)}get height(){return this.adjustMinBounds(this.terrain.height)}get width(){return this.adjustMinBounds(this.terrain.width)}get depth(){return this.adjustMinBounds(this.terrain.depth)}get altitude(){return this.terrain.altitude}set altitude(e){this.terrain.altitude=e}get isDropShadow(){return this.terrain.isDropShadow}set isDropShadow(e){this.terrain.isDropShadow=e}get isSurfaceShading(){return this.terrain.isSurfaceShading}set isSurfaceShading(e){this.terrain.isSurfaceShading=e}get isInteract(){return this.terrain.isInteract}set isInteract(e){this.terrain.isInteract=e}get isSlope(){return this.terrain.isSlope}set isSlope(e){this.terrain.isSlope=e,e||(this.terrain.slopeDirection=Zn.NONE)}get slopeDirection(){return this.terrain.isSlope?this.terrain.isSlope&&this.terrain.slopeDirection===Zn.NONE?Zn.BOTTOM:this.terrain.slopeDirection:Zn.NONE}set slopeDirection(e){this.terrain.isSlope=e!=Zn.NONE,this.terrain.slopeDirection=e}get isAltitudeIndicate(){return this.terrain.isAltitudeIndicate}set isAltitudeIndicate(e){this.terrain.isAltitudeIndicate=e}get isVisibleFloor(){return 0<this.width*this.depth}get isVisibleWallTopBottom(){return 0<this.width*this.height}get isVisibleWallLeftRight(){return 0<this.depth*this.height}get isWallExist(){return this.hasWall&&this.wallImage&&this.wallImage.url&&this.wallImage.url.length>0}get terreinAltitude(){let e=this.altitude;return(this.altitude<0||!this.isSlope&&!this.isWallExist)&&(e+=this.height),e}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.terrain||!i||(this.terrain===i||i instanceof Ln&&this.terrain.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.terrain,colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.terrain}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ut.play(Xe.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ut.play(Xe.lock)}},At,{name:"\u50be\u659c",action:null,subActions:[{name:(this.slopeDirection==Zn.NONE?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.slopeDirection=Zn.NONE}},At,{name:(this.slopeDirection==Zn.TOP?"\u25c9":"\u25cb")+" \u4e0a\uff08\u5317\uff09",action:()=>{this.slopeDirection=Zn.TOP}},{name:(this.slopeDirection==Zn.BOTTOM?"\u25c9":"\u25cb")+" \u4e0b\uff08\u5357\uff09",action:()=>{this.slopeDirection=Zn.BOTTOM}},{name:(this.slopeDirection==Zn.LEFT?"\u25c9":"\u25cb")+" \u5de6\uff08\u897f\uff09",action:()=>{this.slopeDirection=Zn.LEFT}},{name:(this.slopeDirection==Zn.RIGHT?"\u25c9":"\u25cb")+" \u53f3\uff08\u6771\uff09",action:()=>{this.slopeDirection=Zn.RIGHT}}]},{name:"\u58c1\u306e\u8868\u793a",action:null,subActions:[{name:(this.hasWall&&this.isSurfaceShading?"\u25c9":"\u25cb")+" \u901a\u5e38",action:()=>{this.mode=oa.ALL,this.isSurfaceShading=!0}},{name:(this.hasWall&&!this.isSurfaceShading?"\u25c9":"\u25cb")+" \u9670\u5f71\u306a\u3057",action:()=>{this.mode=oa.ALL,this.isSurfaceShading=!1}},{name:(this.hasWall?"\u25cb":"\u25c9")+" \u975e\u8868\u793a",action:()=>{this.mode=oa.FLOOR,this.depth*this.width==0&&(this.terrain.width=this.width<=0?1:this.width,this.terrain.depth=this.depth<=0?1:this.depth)}}]},At,this.isDropShadow?{name:"\u2611 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u3092\u843d\u3068\u3059",action:()=>{this.isDropShadow=!0}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,ut.play(Xe.sweep))},altitudeHande:this.terrain},At,{name:"\u5730\u5f62\u8a2d\u5b9a\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.terrain)}},this.terrain.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.terrain.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{et.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:o,title:this.terrain.name,subTitle:s.name})},disabled:!et.validUrl(o),error:et.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(o)&&!et.sameOrigin(o)}})},this.terrain.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.terrain.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLocked=!1,this.terrain.parent&&this.terrain.parent.appendChild(s),ut.play(Xe.blockPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.terrain.destroy(),ut.play(Xe.sweep)}},At,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){ut.play(Xe.blockPick)}onMoved(){ut.play(Xe.blockPut)}get floorModCss(){let e="",i=0;switch(this.slopeDirection){case Zn.TOP:i=Math.atan(this.height/this.depth),e=" rotateX("+i+"rad) scaleY("+1/Math.cos(i)+")";break;case Zn.BOTTOM:i=Math.atan(this.height/this.depth),e=" rotateX("+-i+"rad) scaleY("+1/Math.cos(i)+")";break;case Zn.LEFT:i=Math.atan(this.height/this.width),e=" rotateY("+-i+"rad) scaleX("+1/Math.cos(i)+")";break;case Zn.RIGHT:i=Math.atan(this.height/this.width),e=" rotateY("+i+"rad) scaleX("+1/Math.cos(i)+")"}return e}get floorBrightness(){let e=1;if(!this.isSurfaceShading)return e;switch(this.slopeDirection){case Zn.TOP:e=.4;break;case Zn.BOTTOM:e=1;break;case Zn.LEFT:e=.6;break;case Zn.RIGHT:e=.9}return e}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5730\u5f62\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:i.x-250,top:i.y-150,width:550,height:380}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(vu),Oe(g1),Oe(lr),Oe(pi),Oe(Tn),Oe(Di),Oe(li),Oe(kn),Oe(Ul))},t.\u0275cmp=qt({type:t,selectors:[["terrain"]],hostBindings:function(e,i){1&e&&Ie("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{terrain:"terrain",is3D:"is3D"},decls:8,vars:24,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.interact","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[4,"ngIf"],[1,"is-3d","texture",2,"z-index","1",3,"ngClass","ngStyle"],["class","is-3d","style","display:flex; align-items: center; border-left: 2px dashed blanchedalmond; position: absolute; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],["style","opacity: 0.7; filter: brightness(0) blur(1px); transform: translateZ(0.3px) scale(0.98); backface-visibility: visible","class","is-3d texture",3,"ngClass","background-image",4,"ngIf"],[1,"is-3d","texture",2,"opacity","0.7","filter","brightness(0) blur(1px)","transform","translateZ(0.3px) scale(0.98)","backface-visibility","visible",3,"ngClass"],[1,"is-3d","texture",3,"ngClass","ngStyle"],["class","is-3d texture of-wall-top","style","transform: translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-top",2,"transform","translateY(-100%) rotateX(90deg) rotateZ(180deg) scaleX(-1.0)",3,"ngClass"],["class","is-3d texture of-wall-bottom","style","transform: rotateX(-90deg)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-bottom",2,"transform","rotateX(-90deg)",3,"ngClass"],["class","is-3d texture of-wall-left","style","transform: rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-left",2,"transform","rotateZ(90deg) rotateX(-90deg) scaleX(-1.0) translateX(-100%) translateY(-100%)",3,"ngClass"],["class","is-3d texture of-wall-right","style","transform: rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass","background-image","width","height",4,"ngIf"],[1,"is-3d","texture","of-wall-right",2,"transform","rotateZ(-90deg) rotateX(-90deg) translateY(-100%)",3,"ngClass"],[1,"is-3d",2,"z-index","0"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"rotate-grab","of-left-top","rotate-grab-icon","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-bottom","rotate-grab-icon","is-3d"],[1,"rotate-grab","of-right-top","rotate-grab-icon","is-3d"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","position","absolute","transform-origin","top left",3,"ngStyle"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1),Ie("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(2,LX,2,1,"ng-container",2),X(3,"div",3),xe(4,jX,3,13,"ng-container",2),xe(5,ZX,5,4,"ng-container",2),te(),xe(6,XX,15,4,"ng-container",2),te(),xe(7,QX,5,7,"div",4),te()),2&e&&(Je("width",i.width*i.gridSize,"px")("height",i.depth*i.gridSize,"px"),re("movable.option",i.movableOption)("movable.disable",i.isLocked)("movable.interact",i.isInteract),W(1),re("ngClass",ct(17,JX,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),W(1),re("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),W(1),re("ngClass",cn(19,eQ,i.height<.5&&0==i.altitude,i.height>=.5&&0==i.altitude))("ngStyle",ct(22,JI,"translateZ("+i.altitude*i.gridSize+"px)")),W(1),re("ngIf",i.hasFloor&&i.isVisibleFloor&&0<(null==i.floorImage?null:i.floorImage.url.length)),W(1),re("ngIf",i.isWallExist),W(1),re("ngIf",!i.isLocked),W(1),re("ngIf",i.isAltitudeIndicate&&!((i.isSlope||i.isWallExist)&&-i.height<i.altitude&&i.altitude<0)&&(i.terreinAltitude<=-.5||.5<=i.terreinAltitude)))},directives:[Wl,bu,jn,gn,Ji],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%}.texture[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;background-repeat:no-repeat;background-size:100% 100%;height:100%;width:100%}.of-wall-top[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:50% 100%;transform:translateY(-100%) rotateX(90deg) rotate(180deg) scaleX(-1);filter:brightness(.3)}.of-wall-bottom[_ngcontent-%COMP%]{bottom:0px;left:0px;transform-origin:50% 100%;transform:rotateX(-90deg)}.of-wall-left[_ngcontent-%COMP%]{top:0px;left:0px;transform-origin:0% 0%;transform:rotate(90deg) rotateX(-90deg) scaleX(-1) translate(-100%) translateY(-100%);filter:brightness(.5)}.of-wall-right[_ngcontent-%COMP%]{top:0px;right:0px;transform-origin:100% 0%;transform:rotate(-90deg) rotateX(-90deg) translateY(-100%);filter:brightness(.8)}.of-wall-top.is-slope[_ngcontent-%COMP%], .of-wall-bottom.is-slope[_ngcontent-%COMP%], .of-wall-left.is-slope[_ngcontent-%COMP%], .of-wall-right.is-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(100% 0%,0% 100%,100% 100%);clip-path:polygon(100% 0%,0% 100%,100% 100%)}.of-wall-top.is-inverse-slope[_ngcontent-%COMP%], .of-wall-bottom.is-inverse-slope[_ngcontent-%COMP%], .of-wall-left.is-inverse-slope[_ngcontent-%COMP%], .of-wall-right.is-inverse-slope[_ngcontent-%COMP%]{-webkit-clip-path:polygon(0% 0%,100% 100%,0% 100%);clip-path:polygon(0% 0%,100% 100%,0% 100%)}.of-wall-top.no-shadow[_ngcontent-%COMP%], .of-wall-left.no-shadow[_ngcontent-%COMP%], .of-wall-right.no-shadow[_ngcontent-%COMP%]{filter:brightness(1)}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;position:absolute;top:-14px;left:-14px;right:-14px;bottom:-14px;cursor:default;box-sizing:border-box;border-top:solid 7px #CCC;border-left:solid 7px #CCC;border-right:solid 7px #CCC;border-bottom:solid 7px #CCC;border-radius:14px}.rotate-grab[_ngcontent-%COMP%]{opacity:0;z-index:-1}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;border:solid 2px #CCCCCC;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:0;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;transform-style:preserve-3d;transform:translateZ(.1px)}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px;border-radius:14px 7px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px;border-radius:7px 14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px;border-radius:14px 7px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px;border-radius:7px 14px}.blinking-animation[_ngcontent-%COMP%]{-webkit-animation:blink 1s linear infinite alternate;animation:blink 1s linear infinite alternate}@-webkit-keyframes blink{0%{opacity:.9}to{opacity:.5}}@keyframes blink{0%{opacity:.9}to{opacity:.5}}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.upright-transform[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}"],changeDetection:0}),t})();function nQ(t,n){if(1&t&&(nt(0,"img",8),bt(1,"safe")),2&t){const e=ge();Je("mix-blend-mode",1==e.blendType?null:"hard-light"),re("src",yt(1,3,e.imageFile.url,"resourceUrl"),Xt)}}const m1=function(t){return{fall:t}},eS=function(t){return{transform:t}};function iQ(t,n){if(1&t&&(X(0,"div",9)(1,"i",10),be(2,"lock"),te()()),2&t){const e=ge();re("ngClass",ct(2,m1,0==e.altitude))("ngStyle",ct(4,eS,"translateZ("+e.altitude*e.gridSize+"px)"))}}const rQ=function(t){return{transform:t}};function sQ(t,n){if(1&t&&(X(0,"div",11)(1,"div",12)(2,"span",13),be(3),te(),X(4,"span",14),be(5),te()()()),2&t){const e=ge();Je("height",e.math.abs(e.gameTableMaskAltitude*e.gridSize),"px"),re("ngStyle",ct(5,rQ,"translateX("+e.width*e.gridSize/2+"px) translateY("+-e.height*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(3),Ze(e.math.abs(e.gameTableMaskAltitude)),W(2),Ze(e.gameTableMaskAltitude)}}const oQ=function(t){return{"is-grab":t}},aQ=function(t){return{"is-inverse":t}},lQ=function(t,n){return{"border-width":t,transform:n}},cQ=function(t){return{image:t}};let uQ=(()=>{class t{constructor(e,i,r,s,o,d,$,I,Q){this.ngZone=e,this.tabletopActionService=i,this.contextMenuService=r,this.elementRef=s,this.panelService=o,this.changeDetector=d,this.pointerDeviceService=$,this.modalService=I,this.coordinateService=Q,this.gameTableMask=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.viewRotateZ=10,this.movableOption={},this.input=null}get name(){return this.gameTableMask.name}get width(){return this.adjustMinBounds(this.gameTableMask.width)}get height(){return this.adjustMinBounds(this.gameTableMask.height)}get opacity(){return this.gameTableMask.opacity}get imageFile(){return this.gameTableMask.imageFile}get isLock(){return this.gameTableMask.isLock}set isLock(e){this.gameTableMask.isLock=e}get blendType(){return this.gameTableMask.blendType}set blendType(e){this.gameTableMask.blendType=e}get fontSize(){return this.gameTableMask.fontsize}set fontSize(e){this.gameTableMask.fontsize=e}get text(){return this.gameTableMask.text}set text(e){this.gameTableMask.text=e}get color(){return this.gameTableMask.color}set color(e){this.gameTableMask.color=e}get bgcolor(){return this.gameTableMask.bgcolor}set bgcolor(e){this.gameTableMask.bgcolor=e}get altitude(){return this.gameTableMask.altitude}set altitude(e){this.gameTableMask.altitude=e}get isAltitudeIndicate(){return this.gameTableMask.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameTableMask.isAltitudeIndicate=e}get gameTableMaskAltitude(){return+this.altitude.toFixed(1)}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.text))}get isInverse(){return 90<Math.abs(this.viewRotateZ)%360&&Math.abs(this.viewRotateZ)%360<270}get isGMMode(){return this.gameTableMask.isGMMode}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.gameTableMask||!i||(this.gameTableMask===i||i instanceof Ln&&this.gameTableMask.contains(i))&&this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.gameTableMask,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain"]}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.input.cancel(),this.isLock&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate();this.contextMenuService.open(i,[this.isGMMode?this.gameTableMask.isTransparentOnGMMode?{name:"\u2611 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!1,ut.play(Xe.lock)}}:{name:"\u2610 GM\u30e2\u30fc\u30c9\u6642\u900f\u904e",action:()=>{this.gameTableMask.isTransparentOnGMMode=!0,ut.play(Xe.unlock)}}:null,this.isGMMode?At:null,this.isLock?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLock=!1,ut.play(Xe.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLock=!0,ut.play(Xe.lock)}},{name:"\u753b\u50cf\u3068\u8272",subActions:[{name:(0==this.blendType?"\u25c9":"\u25cb")+" \u753b\u50cf\u306e\u307f",action:()=>{this.blendType=0,ut.play(Xe.cardDraw)}},{name:(1==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u91cd\u306d\u308b",action:()=>{this.blendType=1,ut.play(Xe.cardDraw)}},{name:(2==this.blendType?"\u25c9":"\u25cb")+" \u80cc\u666f\u8272\u3068\u6df7\u305c\u308b",action:()=>{this.blendType=2,ut.play(Xe.cardDraw)}},At,{name:"\u8272\u306e\u521d\u671f\u5316",action:()=>{this.color="#555555",this.bgcolor="#0a0a0a",ut.play(Xe.cardDraw)}}]},At,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,ut.play(Xe.sweep))},altitudeHande:this.gameTableMask},At,{name:"\u30de\u30c3\u30d7\u30de\u30b9\u30af\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.gameTableMask)}},this.gameTableMask.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameTableMask.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{et.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:o,title:this.gameTableMask.name,subTitle:s.name})},disabled:!et.validUrl(o),error:et.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(o)&&!et.sameOrigin(o)}})},this.gameTableMask.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.gameTableMask.clone();console.log("\u30b3\u30d4\u30fc",s),s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.isLock=!1,this.gameTableMask.parent&&this.gameTableMask.parent.appendChild(s),ut.play(Xe.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.gameTableMask.destroy(),ut.play(Xe.sweep)}},At,{name:"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u4f5c\u6210",action:null,subActions:this.tabletopActionService.makeDefaultContextMenuActions(r)}],this.name)}onMove(){ut.play(Xe.cardPick)}onMoved(){ut.play(Xe.cardPut)}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30de\u30c3\u30d7\u30de\u30b9\u30af\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:i.x-200,top:i.y-150,width:400,height:530}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(g1),Oe(lr),Oe(pi),Oe(Tn),Oe(Di),Oe(li),Oe(kn),Oe(Ul))},t.\u0275cmp=qt({type:t,selectors:[["game-table-mask"]],hostBindings:function(e,i){1&e&&Ie("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{gameTableMask:"gameTableMask",is3D:"is3D"},decls:8,vars:44,consts:[["appMovable","",1,"component","is-3d",2,"pointer-events","none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-3d","text",2,"left","2px","top","2px","backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-3d",2,"z-index","5","pointer-events","none",3,"ngClass","innerHtml"],[1,"border","is-fit-full",2,"backface-visibility","hidden",3,"ngClass","ngStyle"],[1,"is-fit-full","is-3d",2,"pointer-events","auto",3,"ngClass"],["class","is-fit-full is-3d","style","pointer-events: none; position: absolute;",3,"mix-blend-mode","src",4,"ngIf"],["class","lock-icon is-center is-3d","style","pointer-events: none; z-index: 10",3,"ngClass","ngStyle",4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left; pointer-events: none",3,"height","ngStyle",4,"ngIf"],[1,"is-fit-full","is-3d",2,"pointer-events","none","position","absolute",3,"src"],[1,"lock-icon","is-center","is-3d",2,"pointer-events","none","z-index","10",3,"ngClass","ngStyle"],[1,"material-icons","is-3d",2,"pointer-events","none","backface-visibility","hidden"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left","pointer-events","none",3,"ngStyle"],[1,"is-3d",2,"pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none"],[1,"altitude-indicator","is-3d",2,"position","absolute","pointer-events","none","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1),nt(2,"div",2),te(),X(3,"div",3)(4,"div",4),xe(5,nQ,2,6,"img",5),te()(),xe(6,iQ,3,6,"div",6),xe(7,sQ,6,7,"div",7),te()),2&e&&(Je("width",i.width*i.gridSize,"px")("height",i.height*i.gridSize,"px"),re("ngClass",ct(29,oQ,!i.isLock))("movable.option",i.movableOption)("movable.disable",i.isLock),W(1),Je("width",i.width*i.gridSize-4,"px")("height",i.height*i.gridSize-4,"px"),re("ngClass",ct(31,m1,0==i.altitude))("ngStyle",ct(33,eS,"translateZ("+i.altitude*i.gridSize+"px)")),W(1),Je("font-size",i.fontSize+9,"px")("color",i.color),re("ngClass",ct(35,aQ,i.isInverse))("innerHtml",i.rubiedText,Ui),W(1),re("ngClass",ct(37,m1,0==i.altitude))("ngStyle",cn(39,lQ,i.isLock?"0px":"2px","translateZ("+i.altitude*i.gridSize+"px)")),W(1),Je("opacity",i.opacity*(i.isGMMode&&i.gameTableMask.isTransparentOnGMMode?.6:1))("background-color",i.imageFile.url.length<1||i.blendType>0?i.bgcolor:null),re("ngClass",ct(42,cQ,i.imageFile.url.length>=1)),W(1),re("ngIf",i.imageFile.url.length>=1),W(1),re("ngIf",i.isLock),W(1),re("ngIf",i.isAltitudeIndicate&&i.math.abs(i.gameTableMaskAltitude)>=.5))},directives:[Wl,jn,Ji,gn],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.image[_ngcontent-%COMP%]{display:block;box-sizing:border-box}.lock-icon[_ngcontent-%COMP%]{background-color:#ccc;border-radius:100%;color:#444;width:25px;height:25px;visibility:hidden}.component[_ngcontent-%COMP%]:hover   .lock-icon[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .lock-icon[_ngcontent-%COMP%]{visibility:visible}.is-center[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}.border[_ngcontent-%COMP%]{box-sizing:border-box;border:2px solid transparent}.image.border[_ngcontent-%COMP%]{border-width:0px}.component[_ngcontent-%COMP%]:hover   .border[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .border[_ngcontent-%COMP%], .is-grab[_ngcontent-%COMP%]   .border[_ngcontent-%COMP%]{border:2px solid #cccccc!important}.is-fit-full[_ngcontent-%COMP%]{height:100%;width:100%}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),t})();const dQ=["textArea"];function fQ(t,n){if(1&t&&(X(0,"div",20),be(1),te()),2&t){const e=ge();W(1),Ze(e.title)}}function hQ(t,n){if(1&t&&(X(0,"div",20),be(1),te()),2&t){const e=ge();W(1),Ze(e.title)}}const pQ=function(t){return{"is-grab":t}},_1=function(t){return{transform:t}};function gQ(t,n){if(1&t&&nt(0,"div",21),2&t){const e=ge();Je("width",(e.width-1)*e.gridSize,"px")("min-height",e.gridSize/2,"px"),re("ngClass",ct(6,pQ,!e.isLocked))("ngStyle",ct(8,_1,"translateX("+e.gridSize/2+"px) translateY("+-e.gridSize/4+"px)"))}}function mQ(t,n){1&t&&(X(0,"div")(1,"div",15)(2,"i",16),be(3,"autorenew"),te()(),X(4,"div",17)(5,"i",16),be(6,"autorenew"),te()()())}const _Q=function(t){return{transform:t}};function $Q(t,n){if(1&t&&(X(0,"div",22)(1,"div",23)(2,"span",24),be(3),te(),X(4,"span",25),be(5),te()()()),2&t){const e=ge();Je("height",e.math.abs(e.textNoteAltitude*e.gridSize),"px"),re("ngStyle",ct(5,_Q,"rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(3),Ze(e.math.abs(e.textNoteAltitude)),W(2),Ze(e.textNoteAltitude)}}const vQ=function(t,n){return{"is-transition":t,fall:n}},bQ=function(t,n,e){return{"is-pointer-events-none":t,"is-pointer-events-auto":n,"hide-area":e}},yQ=function(t){return{"hide-area":t}};let CQ=(()=>{class t{constructor(e,i,r,s,o,d,$){this.ngZone=e,this.contextMenuService=i,this.elementRef=r,this.panelService=s,this.changeDetector=o,this.pointerDeviceService=d,this.modalService=$,this.textNote=null,this.is3D=!1,this.callbackOnMouseUp=I=>this.onMouseUp(I),this.gridSize=50,this.math=Math,this._transitionTimeout=null,this._transition=!1,this._fallTimeout=null,this._fall=!1,this.calcFitHeightTimer=null,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.input=null}get title(){return this.textNote.title}get text(){return this.calcFitHeightIfNeeded(),this.textNote.text}set text(e){this.calcFitHeightIfNeeded(),this.textNote.text=e}get fontSize(){return this.calcFitHeightIfNeeded(),this.textNote.fontSize}get imageFile(){return this.textNote.imageFile}get rotate(){return this.textNote.rotate}set rotate(e){this.textNote.rotate=e}get height(){return this.adjustMinBounds(this.textNote.height)}get width(){return this.adjustMinBounds(this.textNote.width)}get altitude(){return this.textNote.altitude}set altitude(e){this.textNote.altitude=e}get textNoteAltitude(){let e=this.altitude;if(this.isUpright&&this.altitude<0){if(-this.height<=this.altitude)return 0;e+=this.height}return+e.toFixed(1)}get isUpright(){return this.textNote.isUpright}set isUpright(e){this.textNote.isUpright=e}get isAltitudeIndicate(){return this.textNote.isAltitudeIndicate}set isAltitudeIndicate(e){this.textNote.isAltitudeIndicate=e}get isLocked(){return this.textNote.isLocked}set isLocked(e){this.textNote.isLocked=e}get isSelected(){return document.activeElement===this.textAreaElementRef.nativeElement}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.text))}get transition(){return this._transition}set transition(e){this._transition=e,this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._transitionTimeout=e?setTimeout(()=>{this._transition=!1},132):null}get fall(){return this._fall}set fall(e){this._fall=e,this._fallTimeout&&clearTimeout(this._fallTimeout),this._fallTimeout=e?setTimeout(()=>{this._fall=!1},132):null}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.textNote||!i||(this.textNote===i||i instanceof Ln&&this.textNote.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}),this.movableOption={tabletopObject:this.textNote,transformCssOffset:"translateZ(0.17px)",colideLayers:["terrain"]},this.rotableOption={tabletopObject:this.textNote}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement)}),this.input.onStart=this.onInputStart.bind(this)}ngOnDestroy(){this._transitionTimeout&&clearTimeout(this._transitionTimeout),this._fallTimeout&&clearTimeout(this._fallTimeout),Fe.unregister(this)}onInputStart(e){this.input.cancel(),this.textNote.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onDragstart(e){e.stopPropagation(),e.preventDefault()}onMouseDown(e){if(!this.isSelected){if(e.preventDefault(),this.textNote.toTopmost(),2===e.button)return void Fe.trigger("DRAG_LOCKED_OBJECT",{});this.addMouseEventListeners()}}onMouseUp(e){if(this.pointerDeviceService.isAllowedToOpenContextMenu){let i=window.getSelection();i.isCollapsed||i.removeAllRanges(),this.textAreaElementRef.nativeElement.focus()}this.removeMouseEventListeners(),e.preventDefault()}onRotateMouseDown(e){e.stopPropagation(),e.preventDefault()}onContextMenu(e){this.removeMouseEventListeners(),!this.isSelected&&(e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu)&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ut.play(Xe.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ut.play(Xe.lock)}},At,this.isUpright?{name:"\u2611 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!1}}:{name:"\u2610 \u76f4\u7acb",action:()=>{this.transition=!0,this.isUpright=!0}},At,this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.isUpright?this.fall=!0:this.transition=!0,this.altitude=0,ut.play(Xe.sweep))},altitudeHande:this.textNote},At,{name:"\u30e1\u30e2\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.textNote)}},this.textNote.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.textNote.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:s,title:this.textNote.title,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}})},this.textNote.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.textNote.clone();r.isLocked=!1,console.log("\u30b3\u30d4\u30fc",r),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),ut.play(Xe.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.textNote.destroy(),ut.play(Xe.sweep)}}],this.title)}onMove(){ut.play(Xe.cardPick)}onMoved(){ut.play(Xe.cardPut)}calcFitHeightIfNeeded(){this.calcFitHeightTimer||this.ngZone.runOutsideAngular(()=>{this.calcFitHeightTimer=setTimeout(()=>{this.calcFitHeight(),this.calcFitHeightTimer=null},0)})}calcFitHeight(){let e=this.textAreaElementRef.nativeElement;e.style.height="0",e.scrollHeight>e.offsetHeight&&(e.style.height=e.scrollHeight+"px")}lastNewLineAdjust(e){return null==e?"":this.isSelected||e.lastIndexOf("\n")!=e.length-1?e:e+"\n"}adjustMinBounds(e,i=0){return e<i?i:e}addMouseEventListeners(){document.body.addEventListener("mouseup",this.callbackOnMouseUp,!1)}removeMouseEventListeners(){document.body.removeEventListener("mouseup",this.callbackOnMouseUp,!1)}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5171\u6709\u30e1\u30e2\u8a2d\u5b9a";e.title.length&&(r+=" - "+e.title),this.panelService.open(lo,{title:r,left:i.x-350,top:i.y-200,width:700,height:450}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(lr),Oe(pi),Oe(Tn),Oe(Di),Oe(li),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["text-note"]],viewQuery:function(e,i){if(1&e&&dn(dQ,7),2&e){let r;un(r=fn())&&(i.textAreaElementRef=r.first)}},hostBindings:function(e,i){1&e&&Ie("dragstart",function(s){return i.onDragstart(s)})("mousedown",function(s){return i.onMouseDown(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{textNote:"textNote",is3D:"is3D"},decls:28,vars:67,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],[1,"component-content","is-3d","is-pointer-events-auto"],[1,"is-3d",3,"ngClass","ngStyle"],[1,"upright-transform","is-3d","is-bg-color","is-front","is-bg-texture"],["class","title is-3d is-black-background is-pointer-events-none",4,"ngIf"],["spellcheck","false",1,"textarea","is-3d",3,"ngClass","ngModel","input","ngModelChange"],["textArea",""],[1,"is-3d","is-outline-text","note-text",2,"margin-top","-18px",3,"ngClass","innerHTML"],[1,"upright-transform","is-3d","is-back","is-bg-color","is-bg-texture"],[1,"is-3d","is-pointer-events-none",2,"visibility","hidden"],["spellcheck","false","readonly","",1,"textarea","is-3d","hide-area","is-pointer-events-none",3,"ngModel","ngModelChange"],[1,"is-3d","is-outline-text","note-text","is-pointer-events-none",2,"margin-top","-18px",3,"innerHTML"],["class","grand-grabing-area","style","position: absolute",3,"ngClass","ngStyle","width","min-height",4,"ngIf"],[3,"ngStyle"],[1,"rotate-grab","of-left-top"],[1,"material-icons"],[1,"rotate-grab","of-right-top"],[4,"ngIf"],["class","is-3d","style","display: flex; align-items: center; border-left: 2px dashed blanchedalmond; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"title","is-3d","is-black-background","is-pointer-events-none"],[1,"grand-grabing-area",2,"position","absolute",3,"ngClass","ngStyle"],[1,"is-3d",2,"display","flex","align-items","center","border-left","2px dashed blanchedalmond","transform-origin","top left",3,"ngStyle"],[1,"is-3d"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1),Ie("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),X(2,"div",2)(3,"div",3)(4,"div",4),bt(5,"safe"),xe(6,fQ,2,1,"div",5),X(7,"textarea",6,7),Ie("input",function(){return i.calcFitHeight()})("ngModelChange",function(s){return i.text=s}),te(),nt(9,"div",8),bt(10,"safe"),te(),X(11,"div",9),bt(12,"safe"),X(13,"div",10),xe(14,hQ,2,1,"div",5),X(15,"textarea",11),Ie("ngModelChange",function(s){return i.text=s}),te(),nt(16,"div",12),bt(17,"safe"),te()()(),xe(18,gQ,1,10,"div",13),X(19,"div",14)(20,"div",15)(21,"i",16),be(22),te()(),X(23,"div",17)(24,"i",16),be(25),te()()(),xe(26,mQ,7,0,"div",18),te()(),xe(27,$Q,6,7,"div",19),te()),2&e&&(re("movable.option",i.movableOption)("movable.disable",i.isSelected||i.isLocked),W(1),re("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),W(1),Je("width",i.width*i.gridSize,"px"),W(1),re("ngClass",cn(54,vQ,i.transition,i.fall))("ngStyle",ct(57,_1,"translateZ("+i.altitude*i.gridSize+"px) rotateY(90deg) rotateZ("+(i.isUpright?0:90)+"deg) rotateY(-90deg)")),W(1),Je("background-image",yt(5,42,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),W(2),re("ngIf",i.title.length),W(1),Je("font-size",i.fontSize+9,"px"),re("ngClass",qr(59,bQ,!i.isSelected,i.isSelected,!i.isSelected))("ngModel",i.text),W(2),Je("font-size",i.fontSize+9,"px"),re("ngClass",ct(63,yQ,i.isSelected))("innerHTML",yt(10,45,i.lastNewLineAdjust(i.rubiedText),"html"),Ui),W(2),Je("background-image",yt(12,48,"url("+(null==i.imageFile?null:i.imageFile.url)+")","style"))("width",i.width*i.gridSize,"px")("min-height",i.height*i.gridSize,"px"),W(3),re("ngIf",i.title.length),W(1),Je("font-size",i.fontSize+9,"px"),re("ngModel",i.text),W(1),Je("font-size",i.fontSize+9,"px"),re("innerHTML",yt(17,51,i.lastNewLineAdjust(i.rubiedText),"html"),Ui),W(2),re("ngIf",!i.isLocked),W(1),re("ngStyle",ct(65,_1,"translateZ("+i.altitude*i.gridSize+"px)")),W(3),Ze(i.isLocked?"lock":"autorenew"),W(3),Ze(i.isLocked?"lock":"autorenew"),W(1),re("ngIf",!i.isLocked),W(1),re("ngIf",i.isAltitudeIndicate&&i.math.abs(i.textNoteAltitude)>=.5))},directives:[Wl,bu,jn,Ji,gn,si,oi,ei],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms ease-in-out}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;width:1px;height:0}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;transform:translate(-50%)}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg)}.is-back[_ngcontent-%COMP%]{transform-origin:50% 100%;transform:rotateX(-90deg) rotateY(180deg)}.is-bg-texture[_ngcontent-%COMP%]{background-repeat:no-repeat;background-size:100% 100%}.is-bg-color[_ngcontent-%COMP%]{box-sizing:border-box;color:#444;background-color:#f0dabde6;border:solid 1px #999}.title[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;resize:none;overflow:hidden;box-sizing:border-box;background:none;border:none;border-radius:0;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1rem;padding:2px;margin:0;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;-webkit-backface-visibility:hidden;backface-visibility:hidden}.textarea[_ngcontent-%COMP%]:focus{background:rgba(255,255,255,.75)}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-outline-text[_ngcontent-%COMP%]{font-size:24px;color:#444;text-shadow:#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px,#f2f2f2 0px 0px .5px}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:42px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;text-align:center;padding:2px;background-color:#ccc;border-radius:28px;color:#444;font-size:8px}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-21px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-21px}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;font-size:11px;font-weight:bolder;color:#ffebcd;text-shadow:#444 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{font-family:Cambria,Georgia;padding:2px;white-space:pre-wrap;-webkit-backface-visibility:hidden;backface-visibility:hidden;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}"],changeDetection:0}),t})();const xQ=["draggablePanel"],wQ=["cardImage"],EQ=["fullCardImage"],TQ=["textArea"];function IQ(t,n){1&t&&$n(0)}function SQ(t,n){1&t&&$n(0)}const tS=function(t){return{card:t}};function kQ(t,n){if(1&t&&(Ge(0),xe(1,SQ,1,0,"ng-container",12),qe()),2&t){const e=ge(),i=Wt(12);W(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ct(2,tS,e.tabletopObject))}}function MQ(t,n){1&t&&$n(0)}function DQ(t,n){if(1&t&&(Ge(0),xe(1,MQ,1,0,"ng-container",12),qe()),2&t){const e=ge(),i=Wt(12);W(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ct(2,tS,e.tabletopObject))}}function AQ(t,n){1&t&&$n(0)}const PQ=function(t){return{note:t}};function NQ(t,n){if(1&t&&(Ge(0),xe(1,AQ,1,0,"ng-container",12),qe()),2&t){const e=ge(),i=Wt(14);W(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ct(2,PQ,e.tabletopObject))}}function FQ(t,n){1&t&&$n(0)}const nS=function(t){return{character:t}};function RQ(t,n){if(1&t&&(Ge(0),xe(1,FQ,1,0,"ng-container",12),qe()),2&t){const e=ge(),i=Wt(16);W(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ct(2,nS,e.tabletopObject))}}function OQ(t,n){1&t&&$n(0)}const BQ=function(t){return{dice:t}};function LQ(t,n){if(1&t&&(Ge(0),xe(1,OQ,1,0,"ng-container",12),qe()),2&t){const e=ge(),i=Wt(18);W(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ct(2,BQ,e.tabletopObject))}}function zQ(t,n){1&t&&$n(0)}function jQ(t,n){if(1&t&&(Ge(0),xe(1,zQ,1,0,"ng-container",12),qe()),2&t){const e=ge(),i=Wt(16);W(1),re("ngTemplateOutlet",i)("ngTemplateOutletContext",ct(2,nS,e.tabletopObject))}}function UQ(t,n){1&t&&$n(0)}function HQ(t,n){if(1&t&&(Ge(0),xe(1,UQ,1,0,"ng-container",13),qe()),2&t){ge();const e=Wt(22);W(1),re("ngTemplateOutlet",e)}}const iS=function(t){return{transform:t}};function VQ(t,n){if(1&t&&(X(0,"div",26),nt(1,"div",27),bt(2,"safe"),te()),2&t){const e=ge(3);Je("width",e.imageAreaRect.width,"px")("height",e.imageAreaRect.height,"px")("left",e.imageAreaRect.left,"px"),re("ngStyle",ct(15,iS,"scale("+e.imageAreaRect.scale+")")),W(1),Je("font-size",e.cardFontSize,"px")("color",e.cardColor),re("innerHTML",yt(2,12,e.cardText,"html"),Ui)}}const rS=function(t){return{"with-button-marign":t}};function GQ(t,n){if(1&t&&(X(0,"div",28)(1,"div",29),be(2),te()()),2&t){const e=ge(2).card,i=ge();re("ngClass",ct(4,rS,i.hasImage)),W(1),Je("background-color",e.ownerColor),W(1),Ze(e.ownerName)}}function qQ(t,n){if(1&t){const e=Ye();X(0,"div",19),xe(1,VQ,3,17,"div",20),X(2,"img",21,22),Ie("load",function(){return ke(e),ge(2).onCardImageLoad()}),bt(4,"safe"),te(),X(5,"button",23),Ie("click",function(){return ke(e),ge(2).chanageImageView(!0)}),X(6,"i",24),be(7,"zoom_in"),te()(),xe(8,GQ,3,6,"div",25),te()}if(2&t){const e=ge().card,i=ge();W(1),re("ngIf","card"==e.aliasName&&(e.isFront||e.isHand||e.isGMMode)||"card-stack"==e.aliasName&&e.topCard.isFront),W(1),re("src",yt(4,3,i.imageUrl,"resourceUrl"),Xt),W(6),re("ngIf",e.hasOwner&&0<e.ownerName.length)}}function WQ(t,n){if(1&t&&(Ge(0),be(1),qe()),2&t){const e=ge().card;W(1),Ze(e.name)}}function KQ(t,n){1&t&&(Ge(0),be(1," \u306e\u30c8\u30c3\u30d7"),qe())}function YQ(t,n){1&t&&(Ge(0),be(1,"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09"),qe())}function ZQ(t,n){1&t&&$n(0)}const dg=function(t,n){return{dataElm:t,name:n}};function XQ(t,n){if(1&t&&(Ge(0),xe(1,ZQ,1,0,"ng-container",12),qe()),2&t){const e=n.$implicit,i=ge(2).card;ge();const r=Wt(20);W(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",cn(2,dg,e,i.name))}}function QQ(t,n){if(1&t&&(X(0,"div",30)(1,"div",31),xe(2,XQ,2,5,"ng-container",32),te()()),2&t){const e=ge(2);W(2),re("ngForOf",e.dataElms)}}const Bo=function(t,n){return{"is-pointer-events-auto":t,"pointer-events-none":n}};function JQ(t,n){if(1&t&&(X(0,"div",14),xe(1,qQ,9,6,"div",15),X(2,"div",16),xe(3,WQ,2,1,"ng-container",5),xe(4,KQ,2,0,"ng-container",5),xe(5,YQ,2,0,"ng-container",5),te(),X(6,"div",17),xe(7,QQ,3,1,"div",18),te()()),2&t){const e=n.card,i=ge();re("ngClass",cn(7,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngIf",i.hasImage),W(1),re("ngClass",ct(10,rS,i.hasImage)),W(1),re("ngIf",null==e.isVisible||e.isVisible||e.isGMMode),W(1),re("ngIf","card-stack"==e.aliasName&&!e.isEmpty),W(1),re("ngIf",null!=e.isVisible&&!e.isVisible&&!e.isGMMode),W(2),re("ngIf",i.hasDataElms&&(e.isVisible||e.isGMMode))}}const eJ=function(t){return{"hide-text-area":t}},tJ=function(t){return{"hide-area":t}};function nJ(t,n){if(1&t){const e=Ye();X(0,"div",33)(1,"div",34),be(2),te(),X(3,"div",35)(4,"div",36),Ie("mousedown",function(){return ke(e),ge().textAreaActivate()}),X(5,"div",37)(6,"textarea",38,39),Ie("ngModelChange",function(r){return ke(e).note.text=r}),te()(),nt(8,"div",40),bt(9,"safe"),nt(10,"div",41),bt(11,"safe"),te()()()}if(2&t){const e=n.note,i=ge();re("ngClass",cn(13,Bo,!i.isPointerDragging,i.isPointerDragging)),W(2),Ze(e.title),W(4),re("ngModel",e.text)("ngClass",ct(16,eJ,!i.isSelected)),W(2),re("innerHTML",yt(9,7,i.adjustedRubiedNote(e.text),"html"),Ui)("ngClass",ct(18,tJ,i.isSelected)),W(2),re("innerHTML",yt(11,10,i.adjustedRubiedNote(e.text,!i.isSelected),"html"),Ui)}}const iJ=function(t){return{transform:t}},rJ=function(t,n){return{inverse:t,hollow:n}},sJ=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}},oJ=function(t){return{"black-paint":t}};function aJ(t,n){if(1&t&&(Ge(0),X(1,"div",49)(2,"div",50)(3,"span",51),nt(4,"img",52),bt(5,"safe"),te()()(),qe()),2&t){const e=ge(3);W(1),re("ngStyle",ct(8,iJ,"rotate("+e.roll+"deg)")),W(1),re("ngClass",cn(10,rJ,e.isInverse,e.isHollow)),W(1),re("ngClass",vo(13,sJ,0==e.aura,1==e.aura,2==e.aura,3==e.aura,4==e.aura,5==e.aura,6==e.aura,7==e.aura)),W(1),re("ngClass",ct(22,oJ,e.isBlackPaint))("src",yt(5,5,e.imageUrl,"resourceUrl"),Xt)}}function lJ(t,n){if(1&t&&(Ge(0),nt(1,"img",53),bt(2,"safe"),qe()),2&t){const e=ge(3);W(1),re("src",yt(2,1,e.imageUrl,"resourceUrl"),Xt)}}const cJ=function(t,n,e){return{"has-icon":t,"is-pointer-events-auto":n,"pointer-events-none":e}};function uJ(t,n){if(1&t&&(X(0,"div",48),xe(1,aJ,6,24,"ng-container",5),xe(2,lJ,3,4,"ng-container",5),te()),2&t){const e=ge(2);re("ngClass",qr(3,cJ,e.isUseIcon,!e.isPointerDragging,e.isPointerDragging)),W(1),re("ngIf",!e.isUseIcon),W(1),re("ngIf",e.isUseIcon)}}function dJ(t,n){1&t&&$n(0)}function fJ(t,n){if(1&t&&(Ge(0),X(1,"div",31),xe(2,dJ,1,0,"ng-container",12),te(),qe()),2&t){const e=ge().$implicit,i=ge(2).character;ge();const r=Wt(20);W(2),re("ngTemplateOutlet",r)("ngTemplateOutletContext",cn(2,dg,e,i.name))}}function hJ(t,n){if(1&t&&(Ge(0),xe(1,fJ,3,5,"ng-container",5),qe()),2&t){const e=n.$implicit,i=ge(3);W(1),re("ngIf",e&&e.name!==i.newLineString)}}function pJ(t,n){if(1&t&&(X(0,"div",30),xe(1,hJ,2,1,"ng-container",32),te()),2&t){const e=ge(2);W(1),re("ngForOf",e.inventoryDataElms)}}function gJ(t,n){if(1&t&&(X(0,"div",42),nt(1,"div",43),xe(2,uJ,3,7,"div",44),X(3,"div",45),be(4),te(),nt(5,"div",46),X(6,"div",47),xe(7,pJ,2,1,"div",18),te()()),2&t){const e=n.character,i=ge();W(1),re("ngClass",cn(6,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngIf",i.hasImage),W(1),re("ngClass",cn(9,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),Ze(e.name),W(2),re("ngClass",cn(12,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngIf",i.hasDataElms)}}function mJ(t,n){if(1&t&&(Ge(0),be(1),qe()),2&t){const e=ge().dice;W(1),An("",e.name,":")}}function _J(t,n){if(1&t&&(Ge(0),be(1),qe()),2&t){const e=ge().dice;W(1),Ze(e.face)}}function $J(t,n){1&t&&(Ge(0),be(1,"???"),qe())}function vJ(t,n){if(1&t&&(X(0,"div",55)(1,"div",29),be(2),te()()),2&t){const e=ge().dice,i=ge();re("ngClass",cn(4,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),Je("background-color",e.ownerColor),W(1),An("",e.ownerName," ")}}const bJ=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function yJ(t,n){if(1&t&&(X(0,"div",48),nt(1,"img",56),bt(2,"safe"),te()),2&t){const e=ge().dice,i=ge();re("ngClass",cn(6,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngClass",cn(9,bJ,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))("src",yt(2,3,i.imageUrl,"resourceUrl"),Xt)}}function CJ(t,n){1&t&&$n(0)}function xJ(t,n){if(1&t&&(Ge(0),xe(1,CJ,1,0,"ng-container",12),qe()),2&t){const e=ge().$implicit,i=ge(2).dice;ge();const r=Wt(20);W(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",cn(2,dg,e,i.name))}}function wJ(t,n){if(1&t&&(Ge(0),xe(1,xJ,2,5,"ng-container",5),qe()),2&t){const e=n.$implicit,i=ge(3);W(1),re("ngIf",e&&e.name!==i.newLineString)}}function EJ(t,n){if(1&t&&(X(0,"div",30)(1,"div",31),xe(2,wJ,2,1,"ng-container",32),te()()),2&t){const e=ge(2);W(2),re("ngForOf",e.dataElms)}}function TJ(t,n){if(1&t&&(X(0,"div",42),nt(1,"div",43),X(2,"div",45),xe(3,mJ,2,1,"ng-container",5),xe(4,_J,2,1,"ng-container",5),xe(5,$J,2,0,"ng-container",5),te(),xe(6,vJ,3,7,"div",54),xe(7,yJ,3,12,"div",44),nt(8,"div",46),X(9,"div",47),xe(10,EJ,3,1,"div",18),te()()),2&t){const e=n.dice,i=ge();W(1),re("ngClass",cn(9,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngClass",cn(12,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngIf",0<(null==e||null==e.name?null:e.name.length)),W(1),re("ngIf",e.isVisible),W(1),re("ngIf",!e.isVisible),W(1),re("ngIf",e.hasOwner&&0<e.ownerName.length),W(1),re("ngIf",i.hasImage),W(2),re("ngClass",cn(15,Bo,!i.isPointerDragging,i.isPointerDragging)),W(1),re("ngIf",i.hasDataElms&&e.isVisible)}}function IJ(t,n){1&t&&$n(0)}function SJ(t,n){if(1&t&&(X(0,"div",63),be(1),te()),2&t){const e=ge(2).dataElm;Rt("title",e.name),W(1),Ze(e.name)}}function kJ(t,n){1&t&&$n(0)}function MJ(t,n){if(1&t&&(Ge(0),xe(1,kJ,1,0,"ng-container",12),qe()),2&t){const e=n.$implicit,i=ge(2).name;ge();const r=Wt(20);W(1),re("ngTemplateOutlet",r)("ngTemplateOutletContext",cn(2,dg,e,i))}}function DJ(t,n){if(1&t&&(X(0,"div",60),xe(1,SJ,2,2,"div",61),X(2,"div",62),xe(3,MJ,2,5,"ng-container",32),te()()),2&t){const e=ge().dataElm;W(1),re("ngIf",0<e.name.trim().length),W(2),re("ngForOf",e.children)}}function AJ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",65)(2,"div"),be(3),te(),X(4,"div",66)(5,"div",37)(6,"textarea",67),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te()(),X(7,"div",68),be(8),te()()(),qe()}if(2&t){const e=ge(2).dataElm;W(2),Rt("title",e.name),W(1),Ze(e.name),W(3),re("ngModel",e.value),W(2),Ze(e.value)}}function PJ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",69),be(2),te(),X(3,"div",70)(4,"div",71),be(5),te(),X(6,"input",72),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,s=ge();W(1),Rt("title",i.name),W(1),Ze(i.name),W(3),Ze(i.value),W(1),it("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value)}}function NJ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",73),be(2),te(),X(3,"div",70)(4,"div",74)(5,"div",75),be(6),te(),X(7,"input",76),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.currentValue=r}),te()(),X(8,"div",77),be(9),te()(),X(10,"div",78)(11,"input",79),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.currentValue=r}),bt(12,"safe"),te()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,s=ge();W(1),Rt("title",i.name),W(1),Ze(i.name),W(4),Ze(i.currentValue),W(1),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.currentValue),W(2),An(" / ",+i.value?i.value:"???",""),W(2),Dr(yt(12,16,"font-size: 0.8em; width: 100%; --min: 0; --max:"+i.value+"; --val:"+i.currentValue+";","style")),it("title",i.currentValue),it("max",+i.value?i.value:1e3),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.currentValue)}}function FJ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",69)(2,"span"),be(3),te(),be(4),te(),X(5,"div",70)(6,"input",80),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r})("change",function(){ke(e);const r=ge(2).dataElm;return r.value=r.value?r.name:""}),te()(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,s=ge();W(1),Rt("title",i.name),W(1),Je("text-decoration",i.value?"none":"line-through"),W(1),Ze(i.name),W(1),An(" ",i.currentValue.toString().split(s.checkRegExp)[i.value?0:1],""),W(2),it("checked",i.value?"checked":""),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value)}}function RJ(t,n){if(1&t&&(X(0,"span",82),be(1),te()),2&t){const e=ge(3).dataElm;W(1),An("(",(e.calcAbilityScore()>=0?"+":"")+e.calcAbilityScore(),")")}}function OJ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",69),be(2),te(),X(3,"div",70)(4,"div",71),be(5),te(),X(6,"input",72),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te(),xe(7,RJ,2,1,"span",81),te(),qe()}if(2&t){const e=ge(2),i=e.dataElm,r=e.name,s=ge();W(1),Rt("title",i.name),W(1),Ze(i.name),W(3),Ze(i.value),W(1),it("type",i.value&&i.value==+i.value?"number":"text"),re("logging.name",r)("logging.dataElement",i)("logging.disable",s.isNoLogging)("ngModel",i.value),W(1),re("ngIf",i.currentValue)}}function BJ(t,n){if(1&t){const e=Ye();Ge(0),X(1,"div",69),be(2),te(),X(3,"div",70)(4,"div",71),be(5),te(),X(6,"input",83),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te(),X(7,"button",84),Ie("click",function(){ke(e);const r=ge(2),s=r.dataElm,o=r.name,d=ge();return!!d.stringUtil.validUrl(s.value)&&d.openUrl(s.value,o,s.name)}),X(8,"i",85),be(9),te()()(),qe()}if(2&t){const e=ge(2).dataElm,i=ge();W(1),Rt("title",e.name),W(1),Ze(e.name),W(3),Ze(e.value),W(1),re("ngModel",e.value),W(1),Rt("disabled",i.stringUtil.validUrl(e.value)?null:""),W(2),Ze(i.stringUtil.validUrl(e.value)?i.stringUtil.sameOrigin(e.value)?"link":"open_in_new":"link_off")}}function LJ(t,n){if(1&t&&(X(0,"div",69),be(1),te()),2&t){const e=ge(3).dataElm;Rt("title",e.name),W(1),Ze(e.name)}}function zJ(t,n){if(1&t&&(X(0,"div",71),be(1),te()),2&t){const e=ge(3).dataElm;W(1),Ze(e.value)}}const jJ=function(t){return{"min-width":t}};function UJ(t,n){if(1&t){const e=Ye();Ge(0),xe(1,LJ,2,2,"div",86),X(2,"div",70),xe(3,zJ,2,1,"div",87),X(4,"input",88),Ie("ngModelChange",function(r){return ke(e),ge(2).dataElm.value=r}),te()(),qe()}if(2&t){const e=ge(2).dataElm;W(1),re("ngIf",e.name),W(2),re("ngIf",e.name),W(1),it("type","size"===e.name||"altitude"===e.name?"number":"text"),it("min","size"===e.name?"0":""),re("ngStyle",ct(6,jJ,e.name?"8em":"100%"))("ngModel",e.value)}}function HJ(t,n){1&t&&(Ge(0,2),xe(1,AJ,9,4,"ng-container",3),xe(2,PJ,7,8,"ng-container",3),xe(3,NJ,13,19,"ng-container",3),xe(4,FJ,7,10,"ng-container",3),xe(5,OJ,8,9,"ng-container",3),xe(6,BJ,10,6,"ng-container",3),xe(7,UJ,5,8,"ng-container",4),qe(),nt(8,"div",64)),2&t&&(re("ngSwitch",ge().dataElm.type),W(1),re("ngSwitchCase","note"),W(1),re("ngSwitchCase","simpleNumber"),W(1),re("ngSwitchCase","numberResource"),W(1),re("ngSwitchCase","checkProperty"),W(1),re("ngSwitchCase","abilityScore"),W(1),re("ngSwitchCase","url"))}function VJ(t,n){if(1&t&&(xe(0,IJ,1,0,"ng-container",57),xe(1,DJ,4,2,"ng-template",null,58,On),xe(3,HJ,9,7,"ng-template",null,59,On)),2&t){const e=n.dataElm,i=Wt(2),r=Wt(4);re("ngIf",0<e.children.length)("ngIfThen",i)("ngIfElse",r)}}function GJ(t,n){if(1&t&&(X(0,"div",94),nt(1,"div",27),bt(2,"safe"),te()),2&t){const e=ge(2);Je("width",e.fullImageAreaRect.width,"px")("height",e.fullImageAreaRect.height,"px")("left",e.fullImageAreaRect.left,"px")("top",e.fullImageAreaRect.top,"px"),re("ngStyle",ct(17,iS,"scale("+e.fullImageAreaRect.scale+")")),W(1),Je("font-size",e.cardFontSize,"px")("color",e.cardColor),re("innerHTML",yt(2,14,e.cardText,"html"),Ui)}}function qJ(t,n){if(1&t){const e=Ye();X(0,"div",89),Ie("click",function(){return ke(e),ge().chanageImageView(!1)}),xe(1,GJ,3,19,"div",90),X(2,"div",91)(3,"i",24),be(4,"close"),te()(),nt(5,"img",92,93),bt(7,"safe"),te()}if(2&t){const e=ge();re("@fadeInOut","in"),W(1),re("ngIf","card"==e.tabletopObject.aliasName&&(e.tabletopObject.isFront||e.tabletopObject.isHand||e.tabletopObject.isGMMode)||"card-stack"==e.tabletopObject.aliasName&&e.tabletopObject.topCard.isFront),W(4),re("src",yt(7,3,e.imageUrl,"resourceUrl"),Xt)}}let WJ=(()=>{class t{constructor(e,i,r,s){this.inventoryService=e,this.changeDetector=i,this.pointerDeviceService=r,this.modalService=s,this.tabletopObject=null,this.left=0,this.top=0,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0,this.stringUtil=et,this._imageFile=Lt.Empty,this.isOpenImageView=!1,this.checkRegExp=/[|\uff5c]/g}get imageUrl(){if(!this.tabletopObject)return"";if(this.isUseIcon)return this.tabletopObject.faceIcon.url;if(this.tabletopObject instanceof jt&&this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return"";try{const i=e.getFirstElementByName("imageIdentifier");if(!i)return"";if(this._imageFile.identifier!=i.value){const r=It.instance.get(i.value);this._imageFile=r||Lt.Empty}}catch(i){console.log(i)}return this._imageFile.url}return this.tabletopObject instanceof Fn&&this.tabletopObject.isGMMode?this.tabletopObject.frontImage?this.tabletopObject.frontImage.url:"":this.tabletopObject.imageFile?this.tabletopObject.imageFile.url:""}get hasImage(){return 0<this.imageUrl.length}get isUseIcon(){return this.tabletopObject instanceof jt&&this.tabletopObject.isUseIconToOverviewImage&&this.tabletopObject.faceIcon&&0<this.tabletopObject.faceIcon.url.length}get roll(){if(this.tabletopObject instanceof jt){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return 0;try{const i=e.getFirstElementByName("applyRoll");return i&&i.value?this.tabletopObject.roll:0}catch(i){console.log(i)}}return this.tabletopObject.roll}return 0}get applyImageEffect(){if(this.tabletopObject instanceof jt){if(this.tabletopObject.standList&&this.tabletopObject.standList.overviewIndex>-1){const e=this.tabletopObject.standList.standElements[this.tabletopObject.standList.overviewIndex];if(!e)return!1;try{const i=e.getFirstElementByName("applyImageEffect");return!(!i||!i.value)}catch(i){console.log(i)}}return!0}return!1}get isInverse(){return!!(this.tabletopObject instanceof jt&&this.applyImageEffect)&&this.tabletopObject.isInverse}get isHollow(){return!!(this.tabletopObject instanceof jt&&this.applyImageEffect)&&this.tabletopObject.isHollow}get isBlackPaint(){return!!(this.tabletopObject instanceof jt&&this.applyImageEffect)&&this.tabletopObject.isBlackPaint}get aura(){return this.tabletopObject instanceof jt&&this.applyImageEffect?this.tabletopObject.aura:-1}get inventoryDataElms(){return this.tabletopObject?this.getInventoryTags(this.tabletopObject):[]}get dataElms(){return this.tabletopObject&&this.tabletopObject.detailDataElement?this.tabletopObject.detailDataElement.children:[]}get hasDataElms(){return 0<this.dataElms.length}get newLineString(){return this.inventoryService.newLineString}get isPointerDragging(){return this.pointerDeviceService.isDragging}get pointerEventsStyle(){return{"is-pointer-events-auto":!this.isPointerDragging,"pointer-events-none":this.isPointerDragging}}ngAfterViewInit(){this.initPanelPosition(),setTimeout(()=>{this.adjustPositionRoot()},16),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.tabletopObject||!i||!(i instanceof Ln)||(this.tabletopObject===i||this.tabletopObject.contains(i))&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()})}ngOnDestroy(){Fe.unregister(this)}initPanelPosition(){let e=this.draggablePanel.nativeElement,i=e.offsetWidth,s=this.left+100,o=this.top-e.offsetHeight-50,d=!1;window.innerWidth<s+i&&(s=window.innerWidth-i,d=!0),o<=0&&(o=0),d&&(s=this.left-i-100),s<0&&(s=0),o<0&&(o=0),e.style.left=s+"px",e.style.top=o+"px"}adjustPositionRoot(){let e=this.draggablePanel.nativeElement,i=e.getBoundingClientRect(),r=0,s=0;window.innerWidth<i.right+r&&(r+=window.innerWidth-(i.right+r)),i.left+r<0&&(r+=0-(i.left+r)),window.innerHeight<i.bottom+s&&(s+=window.innerHeight-(i.bottom+s)),i.top+s<0&&(s+=0-(i.top+s)),e.style.left=e.offsetLeft+r+"px",e.style.top=e.offsetTop+s+"px"}chanageImageView(e){this.isOpenImageView=e}openUrl(e,i=null,r=null){et.sameOrigin(e)?window.open(e.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:e,title:i,subTitle:r})}getInventoryTags(e){return this.inventoryService.tableInventory.dataElementMap.get(e.identifier)}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}onFullCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get imageAreaRect(){return this.calcImageAreaRect(250,330,8)}get fullImageAreaRect(){return this.calcImageAreaRect(document.documentElement.clientWidth,document.documentElement.offsetHeight,16)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,d=i-2*r;this.naturalHeight*o/this.naturalWidth>d?(s.width=this.naturalWidth*d/this.naturalHeight,s.height=d,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(d-s.height)/2);let $=null;return this.tabletopObject instanceof Un?$=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&($=this.tabletopObject),$&&(s.scale=s.width/($.size*this.gridSize),s.width=$.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){let e=null;return this.tabletopObject instanceof Un?e=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&(e=this.tabletopObject),e?e.color:"#555555"}get cardFontSize(){let e=null;return this.tabletopObject instanceof Un?e=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&(e=this.tabletopObject),e?e.fontsize+9:18}get cardText(){let e=null;return this.tabletopObject instanceof Un?e=this.tabletopObject.topCard:this.tabletopObject instanceof Fn&&(e=this.tabletopObject),e?et.rubyToHtml(et.escapeHtml(e.text)):""}get isNoLogging(){return this.tabletopObject instanceof Fn?!this.tabletopObject.isFront:this.tabletopObject instanceof tr&&this.tabletopObject.hasOwner}get isSelected(){return this.textAreaElementRef&&document.activeElement===this.textAreaElementRef.nativeElement}adjustedRubiedNote(e,i=!0){if(!e)return"";let r=et.escapeHtml(e);return i&&(r=et.rubyToHtml(r)),r.lastIndexOf("\n")==r.length-1?r+"\n":r}textAreaActivate(){this.textAreaElementRef&&this.textAreaElementRef.nativeElement&&this.textAreaElementRef.nativeElement.focus()}}return t.\u0275fac=function(e){return new(e||t)(Oe(d1),Oe(Di),Oe(li),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["overview-panel"]],viewQuery:function(e,i){if(1&e&&(dn(xQ,7),dn(wQ,5),dn(EQ,5),dn(TQ,5)),2&e){let r;un(r=fn())&&(i.draggablePanel=r.first),un(r=fn())&&(i.cardImageElement=r.first),un(r=fn())&&(i.fullCardImageElement=r.first),un(r=fn())&&(i.textAreaElementRef=r.first)}},inputs:{tabletopObject:"tabletopObject",left:"left",top:"top"},decls:23,vars:9,consts:[["appDraggable","",1,"component","is-pointer-events-none"],["draggablePanel",""],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf"],["overviewCard",""],["overviewNote",""],["overviewCharacter",""],["overviewDiceSymbol",""],["dataElement",""],["imageView",""],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[4,"ngTemplateOutlet"],[1,"component-content","is-small-size",3,"ngClass"],["style","position: relative;",4,"ngIf"],[1,"component-title","title-background",3,"ngClass"],[1,"component-background"],["class","grid-container-root",4,"ngIf"],[2,"position","relative"],["class","text","style","z-index: 5; top: 8px",3,"width","height","left","ngStyle",4,"ngIf"],["draggable","false",1,"card-image",3,"src","load"],["cardImage",""],[1,"zoom-button",2,"z-index","10",3,"click"],[1,"material-icons"],["class","component-owner position-right-bottom","style","z-index: 10",3,"ngClass",4,"ngIf"],[1,"text",2,"z-index","5","top","8px",3,"ngStyle"],[3,"innerHTML"],[1,"component-owner","position-right-bottom",2,"z-index","10",3,"ngClass"],[1,"owner-tag"],[1,"grid-container-root"],[1,"grid-container"],[4,"ngFor","ngForOf"],[1,"component-content","is-large-size",3,"ngClass"],[1,"component-title","title-background"],[1,"component-background","text-note-container"],[2,"position","relative",3,"mousedown"],[1,"is-fill"],["spellcheck","false",1,"textarea",2,"resize","none",3,"ngModel","ngClass","ngModelChange"],["textArea",""],[1,"note-text",2,"pointer-events","none","position","absolute",3,"innerHTML","ngClass"],[1,"textarea-spacer",2,"pointer-events","none",3,"innerHTML"],[1,"component-content","character-grid-container","is-middle-size"],[1,"title-bg-area","title-background",3,"ngClass"],["class","image-area character-image-box",3,"ngClass",4,"ngIf"],[1,"title-area","component-title",3,"ngClass"],[1,"void-area","is-pointer-events-none"],[1,"dataElm-area","component-background",3,"ngClass"],[1,"image-area","character-image-box",3,"ngClass"],[3,"ngStyle"],[1,"inverser",3,"ngClass"],[1,"aura",3,"ngClass"],[1,"character-image",2,"pointer-events","none",3,"ngClass","src"],[1,"character-image",2,"pointer-events","none",3,"src"],["class","owner-name-area component-owner",3,"ngClass",4,"ngIf"],[1,"owner-name-area","component-owner",3,"ngClass"],["draggable","false",1,"character-image",3,"ngClass","src"],[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"section",2,"padding-top","0.5em"],["class","section-text",4,"ngIf"],[1,"grid-container","indetnt"],[1,"section-text"],[1,"section","border"],[1,"section"],[1,"note",2,"position","relative"],["spellcheck","false",1,"textarea",3,"ngModel","ngModelChange"],[1,"textarea-spacer"],[1,"tag"],[1,"value"],[1,"hidden-spacer"],["appLogging","","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","type","ngModel","ngModelChange"],[1,"tag",2,"min-width","100px"],[2,"display","inline-block","width","min-content"],[1,"hidden-spacer",2,"margin-right","2em"],["appLogging","","type","number","size","1",1,"input",2,"width","4em",3,"logging.name","logging.dataElement","logging.disable","ngModel","ngModelChange"],[2,"display","inline"],[1,"section",2,"line-height","1em"],["appLogging","","type","range","min","0",3,"logging.name","logging.dataElement","logging.disable","title","max","ngModel","ngModelChange"],["appLogging","","type","checkbox",2,"width","2em","margin-right","1em",3,"logging.name","logging.dataElement","logging.disable","ngModel","checked","ngModelChange","change"],["style","font-size: smaller;",4,"ngIf"],[2,"font-size","smaller"],["type","url","size","1",1,"input",2,"width","calc(8em - 1.6rem)",3,"ngModel","ngModelChange"],[1,"link",2,"width","1.6rem",3,"click"],[1,"material-icons",2,"font-size","1.0rem"],["class","tag",4,"ngIf"],["class","hidden-spacer",4,"ngIf"],["size","1",1,"input",3,"ngStyle","type","min","ngModel","ngModelChange"],[1,"image-view-background","is-fill",3,"click"],["class","text","style","z-index: 5",3,"width","height","left","top","ngStyle",4,"ngIf"],[1,"close-button","is-pointer-events-none",2,"z-index","10"],["draggable","false",1,"contain-image",3,"src"],["fullCardImage",""],[1,"text",2,"z-index","5",3,"ngStyle"]],template:function(e,i){1&e&&(X(0,"div",0,1),Ge(2,2),xe(3,IQ,1,0,"ng-container",3),xe(4,kQ,2,4,"ng-container",3),xe(5,DQ,2,4,"ng-container",3),xe(6,NQ,2,4,"ng-container",3),xe(7,RQ,2,4,"ng-container",3),xe(8,LQ,2,4,"ng-container",3),xe(9,jQ,2,4,"ng-container",4),qe(),te(),xe(10,HQ,2,1,"ng-container",5),xe(11,JQ,8,12,"ng-template",null,6,On),xe(13,nJ,12,20,"ng-template",null,7,On),xe(15,gJ,8,15,"ng-template",null,8,On),xe(17,TJ,11,18,"ng-template",null,9,On),xe(19,VJ,5,3,"ng-template",null,10,On),xe(21,qJ,8,6,"ng-template",null,11,On)),2&e&&(re("@fadeInOut","in"),W(2),re("ngSwitch",i.tabletopObject.aliasName),W(1),re("ngSwitchCase","numberResource"),W(1),re("ngSwitchCase","card"),W(1),re("ngSwitchCase","card-stack"),W(1),re("ngSwitchCase","text-note"),W(1),re("ngSwitchCase","character"),W(1),re("ngSwitchCase","dice-symbol"),W(2),re("ngIf",i.isOpenImageView))},directives:[O0,ml,_d,_l,$d,gn,jn,Ji,Jn,si,oi,ei,Ls,ds,fs,Yr],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;max-height:100%;max-width:100%;box-sizing:border-box;overflow:visible;color:#444;z-index:9000;overscroll-behavior:contain;-webkit-overflow-scrolling:touch;cursor:-webkit-grab;cursor:grab}.component-content[_ngcontent-%COMP%]{font-size:12px}.is-large-size[_ngcontent-%COMP%]{max-width:350px}.is-middle-size[_ngcontent-%COMP%]{max-width:270px}.is-small-size[_ngcontent-%COMP%]{max-width:250px}.is-middle-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:270px}.is-small-size[_ngcontent-%COMP%]   .grid-container-root[_ngcontent-%COMP%]{width:250px}.component-background[_ngcontent-%COMP%]{background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border-bottom:solid 1px #999}.component-title[_ngcontent-%COMP%]{color:#ccc;font-size:1em;text-align:right;vertical-align:middle;height:32px;line-height:32px;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;padding:0 1em}.title-background[_ngcontent-%COMP%]{background-color:#555;border-top:solid 1px #999;border-left:solid 1px #999;border-right:solid 1px #999}.component-owner[_ngcontent-%COMP%]{font-size:.8em;color:#ccc;vertical-align:middle;overflow:hidden;text-align:right;padding:2px 1em;max-width:100%;box-sizing:border-box}.owner-tag[_ngcontent-%COMP%]{width:-webkit-min-content;width:-moz-min-content;width:min-content;max-width:100%;margin-left:auto;margin-right:0;overflow:hidden;color:#f5f5f5;background-color:#1e1e1e;box-sizing:border-box;padding:3px 9px;border-radius:6px;white-space:nowrap;text-overflow:ellipsis;opacity:.9}.card-image[_ngcontent-%COMP%]{width:250px;max-height:330px;padding:8px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain;box-sizing:border-box;background-color:#cccccc80}.zoom-button[_ngcontent-%COMP%]{position:absolute;left:8px;bottom:-21px;width:42px;height:42px;border-radius:100px;padding:4px}.zoom-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:24px;vertical-align:bottom}.position-right-bottom[_ngcontent-%COMP%]{position:absolute;right:0;bottom:0}.image-view-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1e4d;z-index:9900}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%]{position:absolute;right:16px;top:16px}.image-view-background[_ngcontent-%COMP%]   .close-button[_ngcontent-%COMP%] > .material-icons[_ngcontent-%COMP%]{font-size:36px}.contain-image[_ngcontent-%COMP%]{width:100%;height:100%;box-sizing:border-box;padding:16px;vertical-align:bottom;-o-object-fit:contain;object-fit:contain}.text-note-container[_ngcontent-%COMP%]{width:100%;max-height:400px;padding:.6em 1.2em;box-sizing:border-box;overflow:hidden auto;line-height:1.8;border-left:solid 1px #999;border-right:solid 1px #999}.character-image-box[_ngcontent-%COMP%]{width:100px;overflow:hidden;vertical-align:bottom;margin-left:.5em;margin-bottom:-6px;z-index:1;overflow:visible}.character-image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{vertical-align:bottom;-o-object-fit:contain;object-fit:contain;-o-object-position:bottom left;object-position:bottom left}.character-image-box.has-icon[_ngcontent-%COMP%]{width:100px;height:100px;max-width:100px;max-height:100px;transform:translateY(-16px);margin-top:16px}.character-image-box.has-icon[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:1em}.character-image[_ngcontent-%COMP%]{padding:0;width:100%;vertical-align:bottom}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.character-grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:-webkit-min-content auto;grid-template-columns:min-content auto;grid-template-rows:1fr auto auto auto}.title-bg-area[_ngcontent-%COMP%]{grid-area:3 / 1 / 4 / 3}.title-area[_ngcontent-%COMP%]{grid-area:3 / 2 / 4 / 3}.owner-name-area[_ngcontent-%COMP%]{grid-area:2 / 2 / 3 / 3}.image-area[_ngcontent-%COMP%]{grid-area:1 / 1 / 4 / 2}.void-area[_ngcontent-%COMP%]{grid-area:1 / 2 / 3 / 3}.dataElm-area[_ngcontent-%COMP%]{grid-area:4 / 1 / 5 / 3}.grid-container-root[_ngcontent-%COMP%]{padding:.5em 1.2em;max-height:250px;overflow:hidden auto;box-sizing:border-box;border-left:solid 1px #999;border-right:solid 1px #999}.grid-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr fit-content(80%)}.grid-container[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]{box-sizing:border-box;line-height:24px}.indetnt[_ngcontent-%COMP%]{padding-left:.5em}.section[_ngcontent-%COMP%]{max-width:100%;grid-column:1 / span 2}.section-text[_ngcontent-%COMP%]{font-size:1.1em;font-weight:700;white-space:nowrap;text-overflow:ellipsis;overflow:hidden}.note[_ngcontent-%COMP%]{margin-left:.5em;font-size:1em;line-height:1.8}.textarea[_ngcontent-%COMP%]{width:100%;height:100%;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box;resize:both;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.textarea[_ngcontent-%COMP%]:hover{background:#EEE}.textarea[_ngcontent-%COMP%]:focus{background:#FFF}.tag[_ngcontent-%COMP%]{padding-right:1em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:7em}.value[_ngcontent-%COMP%]{font-size:1.2em;overflow:hidden;white-space:nowrap;text-overflow:ellipsis;text-align:right}.hidden-spacer[_ngcontent-%COMP%]{visibility:hidden;height:0px;min-width:3em;overflow:hidden;white-space:pre-wrap}.textarea-spacer[_ngcontent-%COMP%]{visibility:hidden;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.input[_ngcontent-%COMP%]{min-width:3em;text-align:right;font:inherit;font-size:inherit;line-height:inherit;background:none;border:none;border-radius:2px;outline:none;color:#444;padding:0;box-sizing:border-box}.input[_ngcontent-%COMP%]:hover{background:#EEE}.input[_ngcontent-%COMP%]:focus{background:#FFF}input[type=number][_ngcontent-%COMP%]{-moz-appearance:textfield}input[type=number][_ngcontent-%COMP%]:hover, input[type=number][_ngcontent-%COMP%]:focus{-moz-appearance:number-input}.border[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.separator[_ngcontent-%COMP%]{padding:2px 0;border-bottom:1px solid #888}.with-button-marign[_ngcontent-%COMP%]{padding-left:60px}.is-fill[_ngcontent-%COMP%]{position:absolute;top:0;left:0;right:0;bottom:0}.is-bold[_ngcontent-%COMP%]{font-weight:700}input[type=range][_ngcontent-%COMP%]{--slider-track-color: transparent;--slider-fill-color: #555;--slider-border-color: #777;--slider-height: .8em;--slider-thumb-size: 1em;--range: calc(var(--max) - var(--min));--ratio: calc((var(--val) - var(--min))/var(--range));--sx: calc(.5*var(--slider-thumb-size) + var(--ratio)*(100% - var(--slider-thumb-size)));margin:0;padding:0;background:transparent;font:1em/1 arial,sans-serif;outline:0;-webkit-appearance:none;-moz-appearance:none;appearance:none}input[type=range][_ngcontent-%COMP%], input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{-webkit-appearance:none}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{box-sizing:border-box;border-top:solid 1px var(--slider-border-color);border-bottom:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-runnable-track{background:linear-gradient(var(--slider-fill-color),var(--slider-fill-color)) 0/var(--sx) 100% no-repeat var(--slider-track-color);cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-ms-track{box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:var(--slider-height);height:var(--slider-height);background:var(--slider-track-color)}input[type=range][_ngcontent-%COMP%]::-moz-range-progress{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-ms-fill-lower{height:var(--slider-height);background:var(--slider-fill-color);border-radius:var(--slider-height)}input[type=range][_ngcontent-%COMP%]::-webkit-slider-thumb{margin-top:calc((var(--slider-height) - var(--slider-thumb-size)) / 2 - 1px);width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-moz-range-thumb{width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-thumb{margin-top:0;width:var(--slider-thumb-size);height:var(--slider-thumb-size);box-sizing:border-box;border:solid 1px var(--slider-border-color);border-radius:2em;background:#ddd;cursor:pointer}input[type=range][_ngcontent-%COMP%]::-ms-tooltip{display:none}.inverse[_ngcontent-%COMP%]{transform:scaleX(-1)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .3s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -6px 6px #fff)}button.link[_ngcontent-%COMP%]{background:none;border:none;border-radius:2px;outline:none;color:#444;font-family:Cambria,Georgia;font-size:1em;padding:2px;box-sizing:border-box}button.link[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1rem}button.link[_ngcontent-%COMP%]:hover{background:#444;color:#ccc}button.link[_ngcontent-%COMP%]:disabled{color:gray}button.link[_ngcontent-%COMP%]:disabled:hover{background-color:transparent}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.hide-area[_ngcontent-%COMP%]{overflow:hidden!important;font-size:0pt!important;width:0px!important;height:0px!important;margin:0!important;padding:0!important;border:0px none!important}.note-text[_ngcontent-%COMP%]{color:#444;min-width:3em;height:auto;min-height:24px;overflow:hidden;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word}.hide-text-area[_ngcontent-%COMP%]{color:transparent}"],data:{animation:[yn("fadeInOut",[Nt("void => *",[Dt("100ms ease-out",Qt([We({opacity:0,offset:0}),We({opacity:1,offset:1})]))]),Nt("* => void",[Dt("100ms ease-in",Qt([We({opacity:1,offset:0}),We({opacity:0,offset:1})]))])])]},changeDetection:0}),t})(),sS=(()=>{class t{constructor(e,i,r){this.ngZone=e,this.viewContainerRef=i,this.pointerDeviceService=r,this.callbackOnMouseEnter=s=>this.onMouseEnter(s),this.callbackOnMouseLeave=s=>this.onMouseLeave(s),this.callbackOnMouseDown=s=>this.onMouseDown(s)}ngOnInit(){}ngAfterViewInit(){this.addEventListeners(this.viewContainerRef.element.nativeElement)}ngOnDestroy(){this.removeEventListeners(this.viewContainerRef.element.nativeElement),this.clearTimer(),this.close()}onMouseEnter(e){this.clearTimer(),this.tooltipComponentRef||this.startOpenTimer()}onMouseLeave(e){this.clearTimer(),this.tooltipComponentRef&&this.startCloseTimer()}onMouseDown(e){!this.tooltipComponentRef||!this.tooltipComponentRef.location.nativeElement.contains(e.target)&&!this.viewContainerRef.element.nativeElement.contains(e.target)&&this.ngZone.run(()=>this.closeAll())}startOpenTimer(){let e=this.pointerDeviceService.pointerX,i=this.pointerDeviceService.pointerY;this.openTooltipTimer=setTimeout(()=>{this.openTooltipTimer=null,4<(e-this.pointerDeviceService.pointerX)**2+(i-this.pointerDeviceService.pointerY)**2?this.startOpenTimer():this.ngZone.run(()=>this.open())},100)}startCloseTimer(){this.closeTooltipTimer=setTimeout(()=>{this.closeTooltipTimer=null,this.tooltipComponentRef&&this.tooltipComponentRef.location.nativeElement.contains(document.activeElement)?this.startCloseTimer():this.ngZone.run(()=>this.closeAll())},400)}clearTimer(){this.closeTooltipTimer&&clearTimeout(this.closeTooltipTimer),this.openTooltipTimer&&clearTimeout(this.openTooltipTimer),this.closeTooltipTimer=this.openTooltipTimer=null}open(){if(this.closeAll(),this.pointerDeviceService.isDragging)return;let e=lr.defaultParentViewContainerRef;this.tooltipComponentRef=e.createComponent(WJ,{index:e.length,injector:e.injector}),this.tooltipComponentRef.instance.tabletopObject=this.tabletopObject,this.tooltipComponentRef.instance.left=this.pointerDeviceService.pointerX,this.tooltipComponentRef.instance.top=this.pointerDeviceService.pointerY,this.addEventListeners(this.tooltipComponentRef.location.nativeElement),this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.addEventListener("mousedown",this.callbackOnMouseDown,!0)}),Fe.register(this).on("DELETE_GAME_OBJECT",i=>{this.tabletopObject&&this.tabletopObject.identifier===i.data.identifier&&this.closeAll()}),this.tooltipComponentRef.onDestroy(()=>{this.removeEventListeners(this.tooltipComponentRef.location.nativeElement),document.body.removeEventListener("touchstart",this.callbackOnMouseDown,!0),document.body.removeEventListener("mousedown",this.callbackOnMouseDown,!0),this.clearTimer(),this.tooltipComponentRef=null,Fe.unregister(this)}),t.activeTooltips.push(this.tooltipComponentRef)}close(){if(!this.tooltipComponentRef)return;let e=t.activeTooltips.indexOf(this.tooltipComponentRef);0<=e&&t.activeTooltips.splice(e,1),this.tooltipComponentRef.destroy(),this.tooltipComponentRef=null}closeAll(){t.activeTooltips.forEach(e=>e.destroy()),t.activeTooltips=[],this.close()}addEventListeners(e){this.ngZone.runOutsideAngular(()=>{e.addEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.addEventListener("mouseleave",this.callbackOnMouseLeave,!1)})}removeEventListeners(e){e.removeEventListener("mouseenter",this.callbackOnMouseEnter,!1),e.removeEventListener("mouseleave",this.callbackOnMouseLeave,!1)}}return t.activeTooltips=[],t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(Pr),Oe(li))},t.\u0275dir=Gt({type:t,selectors:[["","appTooltip",""]],inputs:{tabletopObject:["appTooltip","tabletopObject"]}}),t})();const KJ=["cardImage"],YJ=function(t){return{transform:t}};let ZJ=(()=>{class t{constructor(){this.card=null,this.gridSize=50,this.naturalWidth=0,this.naturalHeight=0}ngOnInit(){}onCardImageLoad(){!this.cardImageElement||(this.naturalWidth=this.cardImageElement.nativeElement.naturalWidth,this.naturalHeight=this.cardImageElement.nativeElement.naturalHeight)}get rubiedText(){return this.card?et.rubyToHtml(et.escapeHtml(this.card.text)):""}get imageAreaRect(){return this.calcImageAreaRect(64,64,0)}calcImageAreaRect(e,i,r){const s={width:0,height:0,top:r,left:r,scale:1};if(0==this.naturalWidth||0==this.naturalHeight)return s;const o=e-2*r,d=i-2*r;return this.naturalHeight*o/this.naturalWidth>d?(s.width=this.naturalWidth*d/this.naturalHeight,s.height=d,s.left=r+(o-s.width)/2):(s.width=o,s.height=this.naturalHeight*o/this.naturalWidth,s.top=r+(d-s.height)/2),this.card&&(s.scale=s.width/(this.card.size*this.gridSize),s.width=this.card.size*this.gridSize,s.height=s.width*this.naturalHeight/this.naturalWidth),s}get cardColor(){return this.card?this.card.color:"#555555"}get cardFontSize(){return this.card?this.card.fontsize+9:18}get cardText(){return this.card?this.card.text:""}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=qt({type:t,selectors:[["card-list-image"]],viewQuery:function(e,i){if(1&e&&dn(KJ,7),2&e){let r;un(r=fn())&&(i.cardImageElement=r.first)}},inputs:{card:"card"},decls:11,vars:28,consts:[[1,"image-box",2,"position","relative",3,"appTooltip"],[1,"text",2,"z-index","5",3,"ngStyle"],[3,"innerHTML"],[1,"image","contain"],[3,"src","load"],["cardImage",""],[3,"src"]],template:function(e,i){1&e&&(X(0,"div",0)(1,"div",1),nt(2,"div",2),bt(3,"safe"),te(),X(4,"div",3)(5,"img",4,5),Ie("load",function(){return i.onCardImageLoad()}),bt(7,"safe"),te()(),X(8,"div",3),nt(9,"img",6),bt(10,"safe"),te()()),2&e&&(re("appTooltip",i.card),W(1),Je("width",i.imageAreaRect.width,"px")("height",i.imageAreaRect.height,"px")("left",i.imageAreaRect.left,"px")("top",i.imageAreaRect.top,"px"),re("ngStyle",ct(26,YJ,"scale("+i.imageAreaRect.scale+")")),W(1),Je("font-size",i.cardFontSize,"px")("color",i.cardColor),re("innerHTML",yt(3,17,i.rubiedText,"html"),Ui),W(3),re("src",yt(7,20,null==i.card||null==i.card.frontImage?null:i.card.frontImage.url,"resourceUrl"),Xt),W(4),re("src",yt(10,23,null==i.card||null==i.card.backImage?null:i.card.backImage.url,"resourceUrl"),Xt))},directives:[sS,Ji],pipes:[Yn],styles:[".image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:64px;height:64px;-o-object-fit:contain;object-fit:contain}.text[_ngcontent-%COMP%]{transform-origin:left top;position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"]}),t})();function XJ(t,n){if(1&t){const e=Ye();X(0,"div",2),nt(1,"card-list-image",3),X(2,"div",4)(3,"button",5),Ie("click",function(){const s=ke(e).$implicit;return ge().drawCard(s)}),be(4,"\u5c71\u672d\u304b\u3089\u51fa\u3059"),te(),X(5,"button",0),Ie("click",function(){const s=ke(e).$implicit;return ge().showDetail(s)}),X(6,"i",6),be(7,"settings"),te(),be(8,"\u7de8\u96c6"),te(),nt(9,"br"),X(10,"button",0),Ie("click",function(){const s=ke(e).$implicit;return ge().up(s)}),be(11,"\u2191"),te(),X(12,"button",0),Ie("click",function(){const s=ke(e).$implicit;return ge().down(s)}),be(13,"\u2193"),te(),nt(14,"br"),te()()}if(2&t){const e=n.$implicit;W(1),re("card",e)}}let QJ=(()=>{class t{constructor(e,i,r){this.panelService=e,this.changeDetector=i,this.chatMessageService=r,this.cardStack=null,this.owner=vt.peerContext.userId}ngOnInit(){Promise.resolve().then(()=>this.panelService.title=this.cardStack.name+" \u306e\u30ab\u30fc\u30c9\u4e00\u89a7"),Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.cardStack||!i||((this.cardStack===i||i instanceof Ln&&this.cardStack.contains(i))&&this.changeDetector.markForCheck(),e.data.identifier===this.cardStack.identifier&&this.cardStack.owner!==this.owner&&this.panelService.close())}).on("DELETE_GAME_OBJECT",e=>{this.cardStack&&this.cardStack.identifier===e.data.identifier&&this.panelService.close()})}ngOnDestroy(){Fe.unregister(this),this.cardStack.owner===this.owner&&(this.cardStack.owner="")}drawCard(e){e.parent.removeChild(e),e.location.x=this.cardStack.location.x+100+50*Math.random(),e.location.y=this.cardStack.location.y+25+50*Math.random(),e.location.name=this.cardStack.location.name,e.rotate+=this.cardStack.rotate,360<e.rotate&&(e.rotate-=360),e.toTopmost(),ut.play(Xe.cardDraw),this.chatMessageService.sendOperationLog(e.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==e.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":e.name} \u3092\u53d6\u308a\u51fa\u3057\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u53d6\u308a\u51fa\u3057\u3066\u4f0f\u305b\u305f`)}up(e){let i=e.parent,r=i.children.indexOf(e);0<r&&i.insertBefore(e,i.children[r-1])}down(e){let i=e.parent,r=i.children.indexOf(e);r<i.children.length-1&&i.insertBefore(i.children[r+1],e)}close(e=!1){e&&(this.cardStack.shuffle(),Fe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier}),ut.play(Xe.cardShuffle)),this.panelService.close()}showDetail(e){let r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:this.panelService.left+10,top:this.panelService.top+20,width:600,height:600}).tabletopObject=e}trackByCard(e,i){return i.identifier}}return t.\u0275fac=function(e){return new(e||t)(Oe(Tn),Oe(Di),Oe(yr))},t.\u0275cmp=qt({type:t,selectors:[["card-stack-list"]],inputs:{cardStack:"cardStack"},decls:5,vars:2,consts:[[3,"click"],["class","box",4,"ngFor","ngForOf","ngForTrackBy"],[1,"box"],[3,"card"],[2,"display","inline-block"],["type","submit",3,"click"],[1,"material-icons",2,"font-size","1.1em","vertical-align","text-bottom"]],template:function(e,i){1&e&&(X(0,"div")(1,"button",0),Ie("click",function(){return i.close(!0)}),be(2,"\u30b7\u30e3\u30c3\u30d5\u30eb\u3057\u3066\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b"),te(),nt(3,"hr"),xe(4,XJ,15,1,"div",1),te()),2&e&&(W(4),re("ngForOf",i.cardStack.cards)("ngForTrackBy",i.trackByCard))},directives:[Jn,ZJ],styles:["[_nghost-%COMP%]{display:block}.box[_ngcontent-%COMP%]{border-bottom:1px dotted #888}.image-box[_ngcontent-%COMP%]{display:inline-block;vertical-align:top}.image[_ngcontent-%COMP%]{padding:0;width:64px;height:64px;display:inline-block;vertical-align:top}.contain[_ngcontent-%COMP%]{background-position:center center;background-repeat:no-repeat;background-size:contain}"],changeDetection:0}),t})();const $1=function(t){return{transform:t}};function JJ(t,n){if(1&t&&(X(0,"div",9),nt(1,"div",10),bt(2,"safe"),te()),2&t){const e=ge(2);re("ngStyle",ct(9,$1,"rotateZ("+e.topCard.rotate+"deg)")),W(1),Je("font-size",e.topCard.fontsize+9,"px")("color",e.topCard.color),re("innerHTML",yt(2,6,e.rubiedText,"html"),Ui)}}function eee(t,n){if(1&t){const e=Ye();X(0,"div",6),Ie("@shuffle.start",function(r){return ke(e),ge().animationShuffleStarted(r)})("@shuffle.done",function(r){return ke(e),ge().animationShuffleDone(r)}),xe(1,JJ,3,11,"div",7),nt(2,"img",8),bt(3,"safe"),te()}if(2&t){const e=ge();re("@bounceInOut",void 0)("@shuffle",e.animeState),W(1),re("ngIf",e.topCard.isFront),W(1),re("ngStyle",ct(8,$1,"rotateZ("+e.topCard.rotate+"deg)"))("src",yt(3,5,e.imageFile.url,"resourceUrl"),Xt)}}function tee(t,n){if(1&t&&(Ge(0),X(1,"div",11)(2,"i",12),be(3),te()(),X(4,"div",13)(5,"i",12),be(6),te()(),X(7,"div",14)(8,"i",12),be(9),te()(),X(10,"div",15)(11,"i",12),be(12),te()(),qe()),2&t){const e=ge();W(3),Ze(e.isLocked?"lock":"autorenew"),W(3),Ze(e.isLocked?"lock":"autorenew"),W(3),Ze(e.isLocked?"lock":"autorenew"),W(3),Ze(e.isLocked?"lock":"autorenew")}}const oS=function(t){return{"is-inverse":t}};function nee(t,n){if(1&t&&(X(0,"div",16)(1,"span",17),be(2),te()()),2&t){const e=ge();re("ngStyle",ct(3,$1,"translateY(-50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),W(1),re("ngClass",ct(5,oS,e.isInverse)),W(1),An("",e.cards.length,"\u679a")}}const iee=function(t,n){return{"background-color":t,transform:n}};function ree(t,n){if(1&t&&(X(0,"div",18)(1,"span",17)(2,"b"),be(3),te(),be(4," \u304c\u78ba\u8a8d\u4e2d"),te()()),2&t){const e=ge();re("ngStyle",cn(3,iee,e.ownerColor,"translateY(50%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateZ("+(e.isInverse?180:0)+"deg)")),W(1),re("ngClass",ct(6,oS,e.isInverse)),W(2),Ze(e.ownerName)}}const see=function(t){return{"is-empty":t}},oee=function(t){return{"is-grab":t}};let aee=(()=>{class t{constructor(e,i,r,s,o,d,$,I,Q){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=s,this.changeDetector=o,this.imageService=d,this.pointerDeviceService=$,this.modalService=I,this.chatMessageService=Q,this.cardStack=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.viewRotateZ=10,this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.cardStack.name}get rotate(){return this.cardStack.rotate}set rotate(e){this.cardStack.rotate=e}get zindex(){return this.cardStack.zindex}get isShowTotal(){return this.cardStack.isShowTotal}get cards(){return this.cardStack.cards}get isEmpty(){return this.cardStack.isEmpty}get size(){let e=this.cardStack.topCard;return e?e.size:2}get hasOwner(){return this.cardStack.hasOwner}get ownerName(){return this.cardStack.ownerName}get ownerColor(){return this.cardStack.ownerColor}get topCard(){return this.cardStack.topCard}get imageFile(){return this.imageService.getSkeletonOr(this.cardStack.imageFile)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.topCard.text))}get isLocked(){return!!this.cardStack&&this.cardStack.isLocked}set isLocked(e){this.cardStack&&(this.cardStack.isLocked=e)}get isInverse(){const e=Math.abs(this.viewRotateZ+this.rotate)%360;return 90<e&&e<270}ngOnInit(){Fe.register(this).on("SHUFFLE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="active",this.changeDetector.markForCheck())}).on("INVERSE_CARD_STACK",e=>{e.data.identifier===this.cardStack.identifier&&(this.animeState="inverse",this.changeDetector.markForCheck())}).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.cardStack||!i||(this.cardStack===i||i instanceof Ln&&this.cardStack.contains(i)||i instanceof He&&i.userId===this.cardStack.owner)&&this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("CARD_STACK_DECREASED",e=>{e.data.cardStackIdentifier===this.cardStack.identifier&&this.cardStack&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=He.findByPeerId(e.data.peerId);(!i||this.cardStack.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.cardStack,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.cardStack}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}animationShuffleStarted(e){}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onCardDrop(e){if(this.cardStack!==e.detail&&(e.detail instanceof Fn||e.detail instanceof Un))if(e.stopPropagation(),e.preventDefault(),e.detail instanceof Fn){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<2500&&(this.chatMessageService.sendOperationLog(`${i.isFront?""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name:"\u4f0f\u305b\u305f\u30ab\u30fc\u30c9"} \u3092 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.cardStack.putOnTop(i))}else if(e.detail instanceof Un){let i=e.detail;(i.location.x-this.cardStack.location.x)**2+(i.location.y-this.cardStack.location.y)**2+(i.posZ-this.cardStack.posZ)**2<625&&(this.chatMessageService.sendOperationLog(`${""==i.name?"(\u7121\u540d\u306e\u5c71\u672d)":i.name} \u3092\u5168\u3066 ${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306b\u4e57\u305b\u305f`),this.concatStack(i))}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100){console.log("onDoubleClick !!!!");const i=this.drawCard();if(i){let r;ut.play(Xe.cardDraw),r=i.isFront?`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${""==i.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":i.name} \u3092\u5f15\u3044\u305f`:`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(r)}}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.cardStack.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{}),Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:this.cardStack.identifier,className:"GameCharacter"})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ut.play(Xe.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ut.play(Xe.lock)}},At,{name:"\u30ab\u30fc\u30c9\u3092\uff11\u679a\u5f15\u304f",action:()=>{const r=this.drawCard();if(r){let s;ut.play(Xe.cardDraw),s=r.isFront?`${this.cardStack.name} \u304b\u3089 ${""==r.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":r.name} \u3092\u5f15\u3044\u305f`:`${this.cardStack.name} \u304b\u3089 1\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog(s)}},default:this.cards.length>0,disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u3092\u5f15\u304f",action:null,subActions:[2,3,4,5,10].map(r=>({name:`${r}\u679a`,action:()=>{const s=[];for(let o=0;o<r;o++){const d=this.drawCard();d&&(s.push(d),(0==o||3==o||9==o)&&ut.play(Xe.cardDraw))}if(s.length>0){const o=s.filter(d=>d.isFront);if(0==o.length)this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${s.length}\u679a\u5f15\u3044\u3066\u4f0f\u305b\u305f`);else{const d=new Map;for(const I of o){let Q=d.get(I.name)||0;Q+=1,d.set(""==I.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":I.name,Q)}let $=`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u304b\u3089 ${[...d.keys()].map(I=>`${I} \u3092 ${d.get(I)}\u679a`).join("\u3001")}`;$+=o.length===s.length?"\u5f15\u3044\u305f":`\u5f15\u304d\u3001${s.length-o.length}\u679a\u3092\u4f0f\u305b\u305f`,this.chatMessageService.sendOperationLog($)}}}})),disabled:0==this.cards.length},At,0!=this.cards.length&&this.cardStack.topCard.isFront?{name:"\u4e00\u756a\u4e0a\u3092\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDown(),ut.play(Xe.cardDraw)},disabled:0==this.cards.length}:{name:"\u4e00\u756a\u4e0a\u3092\u8868\u306b\u3059\u308b",action:()=>{!this.cardStack.topCard||(this.cardStack.topCard.isFront||this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u4e00\u756a\u4e0a\u306e ${""==this.cardStack.topCard.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.cardStack.topCard.name} \u3092\u516c\u958b\u3057\u305f`),this.cardStack.faceUp(),ut.play(Xe.cardDraw))},disabled:0==this.cards.length},At,{name:"\u3059\u3079\u3066\u8868\u306b\u3059\u308b",action:()=>{this.cardStack.faceUpAll(),ut.play(Xe.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u88cf\u306b\u3059\u308b",action:()=>{this.cardStack.faceDownAll(),ut.play(Xe.cardDraw)},disabled:0==this.cards.length},{name:"\u3059\u3079\u3066\u6b63\u4f4d\u7f6e\u306b\u3059\u308b",action:()=>{this.cardStack.uprightAll(),ut.play(Xe.cardDraw)},disabled:0==this.cards.length},At,{name:"\u30b7\u30e3\u30c3\u30d5\u30eb",action:()=>{this.cardStack.shuffle(),ut.play(Xe.cardShuffle),Fe.call("SHUFFLE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},{name:"\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u308b",action:()=>{this.showStackList(this.cardStack),this.chatMessageService.sendOperationLog(`${""==this.cardStack.name?"(\u7121\u540d\u306e\u5c71\u672d)":this.cardStack.name} \u306e\u30ab\u30fc\u30c9\u4e00\u89a7\u3092\u898b\u305f`)},disabled:0==this.cards.length},At,this.isShowTotal?{name:"\u2611 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!1}}:{name:"\u2610 \u679a\u6570\u3092\u8868\u793a",action:()=>{this.cardStack.isShowTotal=!0}},{name:"\u30ab\u30fc\u30c9\u30b5\u30a4\u30ba\u3092\u63c3\u3048\u308b",action:()=>{this.cardStack.topCard&&this.cardStack.unifyCardsSize(this.cardStack.topCard.size)},disabled:0==this.cards.length},At,{name:"\u5c71\u672d\u3092\u5206\u5272\u3059\u308b",subActions:[{name:"\u4eba\u6570\u3067\u5206\u5272",action:()=>{this.splitStack(vt.peerIds.length),ut.play(Xe.cardDraw)}},At,...[2,3,4,5,6].map(r=>({name:`${r}\u3064\u306b\u5206\u5272`,action:()=>{this.splitStack(r),ut.play(Xe.cardDraw)}}))],disabled:0==this.cards.length},{name:"\u5c71\u672d\u3092\u5d29\u3059",action:()=>{this.breakStack(),ut.play(Xe.cardShuffle)},disabled:0==this.cards.length},{name:"\u5c71\u672d\u5168\u4f53\u3092\u88cf\u8fd4\u3059",action:()=>{this.cardStack.inverse(),ut.play(Xe.cardDraw),ut.play(Xe.cardDraw),Fe.call("INVERSE_CARD_STACK",{identifier:this.cardStack.identifier})},disabled:0==this.cards.length},At,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.cardStack)}},this.cardStack.getUrls().length<=0?null:{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.cardStack.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:s,title:this.cardStack.name,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}})},this.cardStack.getUrls().length<=0?null:At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.cardStack.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.owner="",r.isLocked=!1,r.toTopmost(),ut.play(Xe.cardPut)}},{name:"\u5c71\u672d\u3092\u524a\u9664\u3059\u308b",action:()=>{this.cardStack.setLocation("graveyard"),this.cardStack.destroy(),ut.play(Xe.sweep)}}],this.name)}onMove(){ut.play(Xe.cardPick)}onMoved(){ut.play(Xe.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}drawCard(){let e=this.cardStack.drawCard();return e&&(this.cardStack.update(),e.location.x+=100+50*Math.random(),e.location.y+=25+50*Math.random(),e.setLocation(this.cardStack.location.name)),e}breakStack(){let e=this.cardStack.drawCardAll().reverse();for(let i of e)i.location.x+=25-50*Math.random(),i.location.y+=25-50*Math.random(),i.toTopmost(),i.setLocation(this.cardStack.location.name);this.cardStack.setLocation("graveyard"),this.cardStack.destroy()}splitStack(e){if(e<2)return;let i=[];for(let d=0;d<e;d++){let $=Un.create(`${this.cardStack.name}_${("0"+(d+1).toString()).slice(-2)}`);$.location.x=this.cardStack.location.x+50-100*Math.random(),$.location.y=this.cardStack.location.y+50-100*Math.random(),$.posZ=this.cardStack.posZ,$.location.name=this.cardStack.location.name,$.rotate=this.rotate,$.toTopmost(),i.push($)}let r=this.cardStack.drawCardAll();this.cardStack.setLocation("graveyard"),this.cardStack.destroy();let s=0,o=r.length/e*(s+1);for(let d=0;d<r.length;d++)i[s].putOnBottom(r[d]),o<=d+1&&(s++,o=r.length/e*(s+1))}concatStack(e,i=this.cardStack){let r=Un.create(i.name);r.location.name=i.location.name,r.location.x=i.location.x,r.location.y=i.location.y,r.posZ=i.posZ,r.zindex=e.zindex,r.rotate=i.rotate;let s=i.drawCardAll(),o=e.drawCardAll();for(let d of o.concat(s))r.putOnBottom(d);i.setLocation(""),i.destroy(),e.setLocation(""),e.destroy()}dispatchCardDropEvent(){let r=this.elementRef.nativeElement.parentElement.children,s=new CustomEvent("carddrop",{detail:this.cardStack,bubbles:!0});for(let o=0;o<r.length;o++)r[o].dispatchEvent(s)}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u5c71\u672d\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}showStackList(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r={left:i.x-200,top:i.y-300,width:400,height:600};this.cardStack.owner=vt.peerContext.userId,this.panelService.open(QJ,r).cardStack=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(lr),Oe(Tn),Oe(pi),Oe(Di),Oe(vu),Oe(li),Oe(kn),Oe(yr))},t.\u0275cmp=qt({type:t,selectors:[["card-stack"]],hostBindings:function(e,i){1&e&&Ie("carddrop",function(s){return i.onCardDrop(s)})("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{cardStack:"cardStack",is3D:"is3D"},decls:6,vars:16,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"ngClass","rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","is-3d",4,"ngIf"],[4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d number-of-cards","style","z-index: 10",3,"ngStyle",4,"ngIf"],["class","name-tag has-length-limit is-nowrap is-black-background is-3d","style","z-index: 10; color: whitesmoke",3,"ngStyle",4,"ngIf"],[1,"is-3d"],["class","text is-3d","style","width: 100%; height: 100%",3,"ngStyle",4,"ngIf"],[1,"card-image","chrome-smooth-image-trick",3,"ngStyle","src"],[1,"text","is-3d",2,"width","100%","height","100%",3,"ngStyle"],[1,"is-3d",3,"innerHTML"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"name-tag","is-nowrap","is-black-background","is-3d","number-of-cards",2,"z-index","10",3,"ngStyle"],[3,"ngClass"],[1,"name-tag","has-length-limit","is-nowrap","is-black-background","is-3d",2,"z-index","10","color","whitesmoke",3,"ngStyle"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1),Ie("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(2,eee,4,10,"div",2),xe(3,tee,13,4,"ng-container",3),xe(4,nee,3,7,"div",4),xe(5,ree,5,8,"div",5),te()()),2&e&&(Je("width",i.size*i.gridSize,"px"),re("ngClass",ct(12,see,i.isEmpty))("movable.option",i.movableOption)("movable.disable",i.isLocked),W(1),re("ngClass",ct(14,oee,!i.isLocked))("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),W(1),re("ngIf",i.topCard&&i.imageFile),W(1),re("ngIf",!i.isIconHidden),W(1),re("ngIf",i.isShowTotal),W(1),re("ngIf",i.hasOwner))},directives:[Wl,jn,bu,gn,Ji],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.is-empty[_ngcontent-%COMP%]{height:100px;width:100px}.component[_ngcontent-%COMP%]{position:absolute;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{height:100%;width:100%;margin-top:-5px;margin-left:-5px;border:solid 5px #CCCCCC;border-radius:5px;background-color:#ccc;-webkit-backface-visibility:hidden;backface-visibility:hidden}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.rotate-grab[_ngcontent-%COMP%]{display:none;z-index:11}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-14px;left:-14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-14px;left:-14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-14px;right:-14px}.of-right-top[_ngcontent-%COMP%]{top:-14px;right:-14px}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:50%;opacity:.9}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}.component[_ngcontent-%COMP%]:not(.is-empty):hover   .number-of-cards[_ngcontent-%COMP%]{visibility:hidden}.is-inverse[_ngcontent-%COMP%]{transform:rotate(180deg)}"],data:{animation:[yn("shuffle",[Qh("active",We({transform:""})),Nt("* => active",[Dt("800ms ease",Qt([We({transform:"scale3d(0, 0, 0) rotateZ(0deg)",offset:0}),We({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(360deg)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(520deg)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(630deg)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(720deg)",offset:1})]))]),Nt("* => inverse",[Dt("200ms ease",Qt([We({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),We({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),We({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),yn("bounceInOut",[Nt("void => *",[Dt("600ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();function lee(t,n){if(1&t&&(X(0,"div",8),nt(1,"div",9),bt(2,"safe"),te()),2&t){const e=ge();Je("opacity",e.isFront?1:.8)("transform",e.isFront?"":"scale(0.9)"),re("@flipOpen",void 0),W(1),Je("font-size",e.fontSize+9,"px")("color",e.color),re("@inverse",e.state)("innerHTML",yt(2,11,e.rubiedText,"html"),Ui)}}function cee(t,n){if(1&t&&(nt(0,"img",10),bt(1,"safe")),2&t){const e=ge();re("@inverse",e.state)("src",yt(1,2,e.isFront?e.frontImage.url:e.backImage.url,"resourceUrl"),Xt)}}const uee=function(t,n){return{"background-color":t,transform:n}};function dee(t,n){if(1&t&&(X(0,"div",11)(1,"span",12)(2,"b"),be(3),te()()()),2&t){const e=ge();re("ngStyle",cn(2,uee,e.ownerColor,"translateY(-75%) translateX(-50%) translateX("+e.size*e.gridSize/2+"px)")),W(3),Ze(e.ownerName)}}function fee(t,n){1&t&&(nt(0,"img",13),bt(1,"safe")),2&t&&re("src",yt(1,1,ge().frontImage.url,"resourceUrl"),Xt)}function hee(t,n){if(1&t&&(Ge(0),X(1,"div",14)(2,"i",15),be(3),te()(),X(4,"div",16)(5,"i",15),be(6),te()(),X(7,"div",17)(8,"i",15),be(9),te()(),X(10,"div",18)(11,"i",15),be(12),te()(),nt(13,"div",19),qe()),2&t){const e=ge();W(3),Ze(e.isLocked?"lock":"autorenew"),W(3),Ze(e.isLocked?"lock":"autorenew"),W(3),Ze(e.isLocked?"lock":"autorenew"),W(3),Ze(e.isLocked?"lock":"autorenew")}}const pee=function(t){return{"is-grab":t}};let gee=(()=>{class t{constructor(e,i,r,s,o,d,$,I,Q,fe){this.ngZone=e,this.contextMenuService=i,this.panelService=r,this.elementRef=s,this.changeDetector=o,this.tabletopService=d,this.imageService=$,this.pointerDeviceService=I,this.modalService=Q,this.chatMessageService=fe,this.card=null,this.is3D=!1,this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null}get name(){return this.card.name}get state(){return this.card.state}set state(e){this.card.state=e}get rotate(){return this.card.rotate}set rotate(e){this.card.rotate=e}get owner(){return this.card.owner}set owner(e){this.card.owner=e}get zindex(){return this.card.zindex}get size(){return this.adjustMinBounds(this.card.size)}get fontSize(){return this.card.fontsize}set fontSize(e){this.card.fontsize=e}get text(){return this.card.text}set text(e){this.card.text=e}get color(){return this.card.color}set color(e){this.card.color=e}get isHand(){return this.card.isHand}get isFront(){return this.card.isFront}get isVisible(){return this.card.isVisible}get hasOwner(){return this.card.hasOwner}get ownerName(){return this.card.ownerName}get ownerColor(){return this.card.ownerColor}get isGMMode(){return this.card.isGMMode}get imageFile(){return this.imageService.getSkeletonOr(this.card.imageFile)}get frontImage(){return this.imageService.getSkeletonOr(this.card.frontImage)}get backImage(){return this.imageService.getSkeletonOr(this.card.backImage)}get isIconHidden(){return null!=this.iconHiddenTimer}get rubiedText(){return et.rubyToHtml(et.escapeHtml(this.text))}get isLocked(){return!!this.card&&this.card.isLocked}set isLocked(e){this.card&&(this.card.isLocked=e)}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.card||!i||(this.card===i||i instanceof Ln&&this.card.contains(i)||i instanceof He&&i.userId===this.card.owner)&&this.changeDetector.markForCheck()}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=He.findByPeerId(e.data.peerId);(!i||this.card.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.card,transformCssOffset:"translateZ(0.15px)",colideLayers:["terrain","text-note"]},this.rotableOption={tabletopObject:this.card}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onCardDrop(e){if(this.card!==e.detail&&(e.detail instanceof Fn||e.detail instanceof Un)&&(e.stopPropagation(),e.preventDefault(),e.detail instanceof Un)){if(this.isLocked)return;let i=e.detail;(i.location.x-this.card.location.x)**2+(i.location.y-this.card.location.y)**2+(i.posZ-this.card.posZ)**2<625&&(i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.putOnBottom(this.card),this.isLocked=!1)}}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){if(!this.isLocked&&(this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100)){if(console.log("onDoubleClick !!!!"),this.hasOwner&&!this.isHand)return;this.state=this.isVisible&&!this.isHand?$s.BACK:$s.FRONT,this.owner="",this.state===$s.FRONT&&this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),ut.play(Xe.cardDraw)}}onDragstart(e){e.stopPropagation(),e.preventDefault()}onInputStart(e){this.startDoubleClickTimer(e),this.card.toTopmost(),this.startIconHiddenTimer(),this.isLocked&&Fe.trigger("DRAG_LOCKED_OBJECT",{})}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[this.isLocked?{name:"\u2611 \u56fa\u5b9a",action:()=>{this.isLocked=!1,ut.play(Xe.unlock)}}:{name:"\u2610 \u56fa\u5b9a",action:()=>{this.isLocked=!0,ut.play(Xe.lock)}},At,!this.isVisible||this.isHand?{name:this.isHand?"\u8868\u5411\u304d\u3067\u51fa\u3059\uff08\u516c\u958b\u3059\u308b\uff09":this.hasOwner?"\u8868\u306b\u3059\u308b\uff08\u516c\u958b\u3059\u308b\uff09":"\u8868\u306b\u3059\u308b",action:()=>{this.card.faceUp(),this.chatMessageService.sendOperationLog((""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name)+" \u3092\u516c\u958b"),ut.play(Xe.cardDraw)},default:!this.isLocked&&(!this.hasOwner||this.isHand)}:{name:"\u88cf\u306b\u3059\u308b",action:()=>{this.card.faceDown(),ut.play(Xe.cardDraw)},default:!this.card.isLocked&&(!this.hasOwner||this.isHand)},this.isHand?{name:"\u88cf\u5411\u304d\u3067\u51fa\u3059",action:()=>{this.card.faceDown(),ut.play(Xe.cardDraw)}}:{name:"\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u624b\u672d\u306b\u3059\u308b\uff09",action:()=>{ut.play(Xe.cardDraw),this.chatMessageService.sendOperationLog(`${this.card.isFront?""==this.card.name?"(\u7121\u540d\u306e\u30ab\u30fc\u30c9)":this.card.name:"(\u4f0f\u305b\u305f\u30ab\u30fc\u30c9)"} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),this.card.faceDown(),this.owner=vt.peerContext.userId}},At,{name:"\u91cd\u306a\u3063\u305f\u30ab\u30fc\u30c9\u3067\u5c71\u672d\u3092\u4f5c\u308b",action:()=>{this.createStack(),ut.play(Xe.cardPut)},disabled:this.isLocked},At,{name:"\u30ab\u30fc\u30c9\u3092\u7de8\u96c6",action:()=>{this.showDetail(this.card)}},this.isVisible&&this.card.getUrls().length>0?{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.card.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:s,title:this.card.name,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}})}:null,this.isVisible&&this.card.getUrls().length>0?At:null,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.card.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.toTopmost(),r.isLocked=!1,ut.play(Xe.cardPut)}},{name:"\u524a\u9664\u3059\u308b",action:()=>{this.card.destroy(),ut.play(Xe.sweep)}}],this.isVisible?this.name:"\u30ab\u30fc\u30c9")}onMove(){this.input.cancel(),ut.play(Xe.cardPick)}onMoved(){ut.play(Xe.cardPut),this.ngZone.run(()=>this.dispatchCardDropEvent())}createStack(){let e=this.tabletopService.cards.filter(r=>(r.location.x-this.card.location.x)**2+(r.location.y-this.card.location.y)**2+(r.posZ-this.card.posZ)**2<1e4&&!r.isLocked);if(0==e.length)return;let i=Un.create("\u5c71\u672d");i.location.x=this.card.location.x,i.location.y=this.card.location.y,i.posZ=this.card.posZ,i.location.name=this.card.location.name,i.rotate=this.rotate,i.zindex=this.card.zindex,e.sort((r,s)=>r.zindex<s.zindex?1:r.zindex>s.zindex?-1:0);for(let r of e)i.putOnBottom(r)}dispatchCardDropEvent(){console.log("dispatchCardDropEvent");let r=this.elementRef.nativeElement.parentElement.children,s=new CustomEvent("carddrop",{detail:this.card,bubbles:!0});for(let o=0;o<r.length;o++)r[o].dispatchEvent(s)}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30ab\u30fc\u30c9\u8a2d\u5b9a";e.name.length&&(r+=" - "+(this.isVisible?e.name:"\u30ab\u30fc\u30c9\uff08\u88cf\u9762\uff09")),this.panelService.open(lo,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(lr),Oe(Tn),Oe(pi),Oe(Di),Oe(af),Oe(vu),Oe(li),Oe(kn),Oe(yr))},t.\u0275cmp=qt({type:t,selectors:[["card"]],hostBindings:function(e,i){1&e&&Ie("carddrop",function(s){return i.onCardDrop(s)})("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{card:"card",is3D:"is3D"},decls:8,vars:15,consts:[["appMovable","",1,"component","is-3d","is-pointer-events-none",3,"ngClass","movable.option","movable.disable","movable.ondragstart","movable.ondragend"],[1,"is-pointer-events-none","is-3d"],["appRotable","",1,"component-content","is-pointer-events-auto","is-3d",3,"rotable.option","rotable.disable","rotable.ondragstart","rotable.ondragend"],["class","text is-3d","style","width: 100%; height: 100%",3,"opacity","transform",4,"ngIf"],["class","card-image is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],["class","name-tag is-nowrap has-length-limit is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","card-image thumbnail-transform is-translucent is-3d chrome-smooth-image-trick",3,"src",4,"ngIf"],[4,"ngIf"],[1,"text","is-3d",2,"width","100%","height","100%"],[1,"is-3d",3,"innerHTML"],[1,"card-image","is-3d","chrome-smooth-image-trick",3,"src"],[1,"name-tag","is-nowrap","has-length-limit","is-black-background","is-3d",3,"ngStyle"],[1,"is-3d"],[1,"card-image","thumbnail-transform","is-translucent","is-3d","chrome-smooth-image-trick",3,"src"],[1,"rotate-grab","of-left-top","is-3d"],[1,"material-icons"],[1,"rotate-grab","of-left-bottom","is-3d"],[1,"rotate-grab","of-right-bottom","is-3d"],[1,"rotate-grab","of-right-top","is-3d"],[1,"border-bg","is-pointer-events-none","is-3d"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1)(2,"div",2),Ie("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),xe(3,lee,3,14,"div",3),xe(4,cee,2,5,"img",4),xe(5,dee,4,5,"div",5),xe(6,fee,2,4,"img",6),xe(7,hee,14,4,"ng-container",7),te()()()),2&e&&(Je("width",i.size*i.gridSize,"px"),re("ngClass",ct(13,pee,!i.isLocked))("movable.option",i.movableOption)("movable.disable",i.isLocked),W(1),re("@slidInOut",void 0),W(1),re("rotable.option",i.rotableOption)("rotable.disable",i.isLocked),W(1),re("ngIf",i.isFront||i.isHand||i.isGMMode),W(1),re("ngIf",i.imageFile),W(1),re("ngIf",!i.isFront&&i.hasOwner&&0<i.ownerName.length),W(1),re("ngIf",!i.isFront&&(i.isHand||i.isGMMode)&&i.frontImage),W(1),re("ngIf",!i.isIconHidden))},directives:[Wl,jn,bu,gn,Ji],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:auto;width:auto;-webkit-backface-visibility:hidden;backface-visibility:hidden;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;min-width:25px;min-height:25px}.component-content[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;height:100%;width:100%;box-sizing:border-box}.card-image[_ngcontent-%COMP%]{display:block;top:0;left:0;bottom:0;right:0;margin:auto;height:auto;width:100%}.thumbnail-transform[_ngcontent-%COMP%]{position:absolute;transform:scale(.9)}.is-translucent[_ngcontent-%COMP%]{filter:opacity(.8)}.rotate-grab[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px;z-index:11}.rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{display:block;opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{display:block;opacity:1}.of-left-top[_ngcontent-%COMP%]{top:-10px;left:-10px;border-radius:14px}.of-left-bottom[_ngcontent-%COMP%]{bottom:-10px;left:-10px;border-radius:14px}.of-right-bottom[_ngcontent-%COMP%]{bottom:-10px;right:-10px;border-radius:14px}.of-right-top[_ngcontent-%COMP%]{top:-10px;right:-10px;border-radius:14px}.border-bg[_ngcontent-%COMP%]{position:absolute;box-sizing:border-box;border-radius:8px;background-color:#cccccc80;top:-2px;left:-2px;right:-2px;bottom:-2px;z-index:-1}.border-bg[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .border-bg[_ngcontent-%COMP%]{display:block}.component[_ngcontent-%COMP%]:active   .border-bg[_ngcontent-%COMP%]{display:none}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:24px;position:absolute;top:0;color:#f5f5f5!important;opacity:.9;z-index:10}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.text[_ngcontent-%COMP%]{position:absolute;display:flex;align-items:center;justify-content:center;pointer-events:none;font-weight:bolder;text-align:center;white-space:pre-wrap;word-wrap:break-word;overflow-wrap:anywhere;word-break:break-word;font-size:24px;color:#444;z-index:5;overflow:hidden;text-overflow:ellipsis;text-shadow:#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px,#fff 0px 0px 2px}"],data:{animation:[yn("inverse",[Qh("inverse",We({transform:""})),Nt(":increment, :decrement",[Dt("200ms ease",Qt([We({transform:"scale3d(1.0, 1.0, 1.0)",offset:0}),We({transform:"scale3d(0.6, 1.2, 1.2)",offset:.5}),We({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),yn("flipOpen",[Nt(":enter",[Dt("200ms ease",Qt([We({transform:"scale3d(0, 1.0, 1.0)",offset:0}),We({transform:"scale3d(0, 1.2, 1.2)",offset:.5}),We({transform:"scale3d(0, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(0.5, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))])]),yn("slidInOut",[Nt("void => *",[Dt("200ms ease",Qt([We({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)",offset:0}),We({"transform-origin":"left center",transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({"transform-origin":"left center",transform:"scale3d(0, 1.0, 1.0)"}))])])]},changeDetection:0}),t})();function mee(t,n){1&t&&(Ge(0),X(1,"div",20)(2,"div",21)(3,"div",22),be(4,"autorenew"),te(),X(5,"div",23),be(6,"autorenew"),te()()(),qe())}function _ee(t,n){1&t&&(X(0,"i",24),be(1,"lock"),te())}function $ee(t,n){1&t&&(X(0,"span"),be(1,"\uff1a"),te())}function vee(t,n){if(1&t&&(X(0,"span"),be(1),te()),2&t){const e=ge();W(1),Ze(e.face)}}function bee(t,n){1&t&&(X(0,"span"),be(1,"???"),te())}function yee(t,n){1&t&&(X(0,"i",24),be(1,"lock"),te())}function Cee(t,n){1&t&&(X(0,"span"),be(1,"\uff1a"),te())}function xee(t,n){if(1&t&&(X(0,"span"),be(1),te()),2&t){const e=ge();W(1),Ze(e.face)}}function wee(t,n){1&t&&(X(0,"span"),be(1,"???"),te())}const Eee=function(t,n){return{"background-color":t,transform:n}};function Tee(t,n){if(1&t&&(X(0,"div",25)(1,"div",26)(2,"b"),be(3),te()(),X(4,"div",27)(5,"b"),be(6),te()()()),2&t){const e=ge();re("ngStyle",cn(3,Eee,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),W(3),Ze(e.ownerName),W(3),Ze(e.ownerName)}}const aS=function(t,n){return{"is-black-mask":t,"is-harf-black-mask":n}};function Iee(t,n){if(1&t&&(nt(0,"img",28),bt(1,"safe")),2&t){const e=ge();re("src",yt(1,2,e.imageFile.url,"resourceUrl"),Xt)("ngClass",cn(5,aS,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner))}}function See(t,n){if(1&t&&(nt(0,"img",29),bt(1,"safe")),2&t){const e=ge();re("src",yt(1,2,e.backFaceImageFile.url,"resourceUrl"),Xt)("ngClass",cn(5,aS,!e.isVisible,e.isMine||e.isGMMode&&e.hasOwner||e.isVisible&&e.isCoin))}}function kee(t,n){1&t&&(nt(0,"img",30),bt(1,"safe")),2&t&&re("src",yt(1,1,ge().imageFile.url,"resourceUrl"),Xt)}function Mee(t,n){if(1&t&&(nt(0,"img",30),bt(1,"safe")),2&t){const e=ge();Je("transform",e.isCoin?"scaleX(-1)":"scaleX(-1) scaleY(-1)"),re("src",yt(1,3,e.backFaceImageFile.url,"resourceUrl"),Xt)}}const Dee=function(t){return{"is-gray-border":t}},Aee=function(t){return{transform:t}};let Pee=(()=>{class t{constructor(e,i,r,s,o,d,$,I,Q){this.ngZone=e,this.panelService=i,this.contextMenuService=r,this.elementRef=s,this.changeDetector=o,this.pointerDeviceService=d,this.imageService=$,this.modalService=I,this.chatMessageService=Q,this.diceSymbol=null,this.is3D=!1,this.animeState="inactive",this.iconHiddenTimer=null,this.gridSize=50,this.movableOption={},this.rotableOption={},this.doubleClickTimer=null,this.doubleClickPoint={x:0,y:0},this.input=null,this.viewRotateX=50,this.viewRotateZ=10}get face(){return this.diceSymbol.face}set face(e){this.diceSymbol.face=e}get owner(){return this.diceSymbol.owner}set owner(e){this.diceSymbol.owner=e}get rotate(){return this.diceSymbol.rotate}set rotate(e){this.diceSymbol.rotate=e}get name(){return this.diceSymbol.name}set name(e){this.diceSymbol.name=e}get size(){return this.adjustMinBounds(this.diceSymbol.size)}get faces(){return this.diceSymbol.faces}get nothingFaces(){return this.diceSymbol.nothingFaces}get imageFile(){return this.imageService.getEmptyOr(this.diceSymbol.imageFile)}get backFaceImageFile(){return this.imageService.getEmptyOr(this.diceSymbol.backFaceImageFile)}get isGMMode(){return this.diceSymbol.isGMMode}get isMine(){return this.diceSymbol.isMine}get hasOwner(){return this.diceSymbol.hasOwner}get ownerName(){return this.diceSymbol.ownerName}get ownerColor(){return this.diceSymbol.ownerColor}get isVisible(){return this.diceSymbol.isVisible}get isDropShadow(){return this.diceSymbol.isDropShadow}set isDropShadow(e){this.diceSymbol.isDropShadow=e}get isLock(){return this.diceSymbol.isLock}set isLock(e){this.diceSymbol.isLock=e}get isCoin(){return this.diceSymbol.isCoin}get isIconHidden(){return null!=this.iconHiddenTimer}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360;return i=i>0?i:360+i,(e>0?e:360+e)*(this.isFlip?1:-1)}get isFlip(){let e=(this.viewRotateZ+this.rotate)%360;return e=e>0?e:360+e,90<e&&e<270}ngOnInit(){Fe.register(this).on("ROLL_DICE_SYMBOL",e=>{e.data.identifier===this.diceSymbol.identifier&&this.ngZone.run(()=>{this.animeState="inactive",this.changeDetector.markForCheck(),queueMicrotask(()=>{this.animeState="active",this.changeDetector.markForCheck()})})}).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.diceSymbol||!i||(this.diceSymbol===i||i instanceof Ln&&this.diceSymbol.contains(i)||i instanceof He&&i.userId===this.diceSymbol.owner)&&this.changeDetector.markForCheck()}).on("DICE_ALL_OPEN",e=>{this.owner&&!this.isLock&&(this.owner="",ut.play(Xe.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`))}).on("TABLE_VIEW_ROTATE",e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("DISCONNECT_PEER",e=>{let i=He.findByPeerId(e.data.peerId);(!i||this.diceSymbol.owner===i.userId)&&this.changeDetector.markForCheck()}),this.movableOption={tabletopObject:this.diceSymbol,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.diceSymbol}}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.input=new so(this.elementRef.nativeElement)}),this.input.onStart=e=>this.ngZone.run(()=>this.onInputStart(e))}ngOnDestroy(){this.input.destroy(),Fe.unregister(this)}onDragstart(e){e.stopPropagation(),e.preventDefault()}animationShuffleDone(e){this.animeState="inactive",this.changeDetector.markForCheck()}onInputStart(e){this.startDoubleClickTimer(e),this.startIconHiddenTimer()}startDoubleClickTimer(e){if(!this.doubleClickTimer)return this.stopDoubleClickTimer(),this.doubleClickTimer=setTimeout(()=>this.stopDoubleClickTimer(),e.touches?500:300),void(this.doubleClickPoint=this.input.pointer);e.touches?this.input.onEnd=this.onDoubleClick.bind(this):this.onDoubleClick()}stopDoubleClickTimer(){clearTimeout(this.doubleClickTimer),this.doubleClickTimer=null,this.input.onEnd=null}onDoubleClick(){this.stopDoubleClickTimer(),(this.doubleClickPoint.x-this.input.pointer.x)**2+(this.doubleClickPoint.y-this.input.pointer.y)**2<100&&this.isVisible&&this.diceRoll()}onContextMenu(e){if(e.stopPropagation(),e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu)return;let i=this.pointerDeviceService.pointers[0],r=[];if(r.push({name:this.isCoin?"\u30b3\u30a4\u30f3\u30c8\u30b9":"\u30c0\u30a4\u30b9\u3092\u632f\u308b",action:()=>{this.diceRoll()},disabled:!this.isVisible,default:this.isVisible}),r.push(At),(this.isMine||this.hasOwner)&&r.push({name:(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+"\u3092\u516c\u958b",action:()=>{this.owner="",ut.play(Xe.unlock),this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u516c\u958b \u2192 ${this.face}`)}}),this.isMine||r.push({name:"\u81ea\u5206\u3060\u3051\u898b\u308b",action:()=>{this.owner=vt.peerContext.userId,this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092\u81ea\u5206\u3060\u3051\u898b\u305f`),ut.play(Xe.lock)}}),r.push(this.isLock?{name:"\u2611 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!1,ut.play(Xe.unlock)},disabled:this.hasOwner&&!this.isVisible}:{name:"\u2610 \u4e00\u6589\u516c\u958b\u3057\u306a\u3044",action:()=>{this.isLock=!0,ut.play(Xe.lock)},disabled:this.hasOwner&&!this.isVisible}),this.isVisible){let s=[],o=this.nothingFaces;o.length>0&&(o.forEach(d=>{s.push({name:`${this.face==d?"\u25c9":"\u25cb"} ${d}\u3000`,action:()=>{ut.play(Xe.dicePut),this.face=d}})}),s.push(At)),this.faces.forEach(d=>{s.push({name:`${this.face==d?"\u25c9":"\u25cb"} ${d}\u3000`,action:()=>{""===this.owner&&ut.play(Xe.dicePut),""===this.owner&&this.face!=d&&this.chatMessageService.sendOperationLog(`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u306e${this.isCoin?"\u8868\uff0f\u88cf":"\u76ee"}\u3092\u5909\u66f4 \u2192 ${d}`),this.face=d}})}),r.push({name:this.isCoin?"\u8868\uff0f\u88cf":"\u30c0\u30a4\u30b9\u76ee",action:null,subActions:s})}r.push(At),r.push(this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0}}),r.push(At),r.push({name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.diceSymbol)}}),this.diceSymbol.getUrls().length>0&&(r.push({name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.diceSymbol.getUrls().map(s=>{const o=s.value.toString();return{name:s.name?s.name:o,action:()=>{et.sameOrigin(o)?window.open(o.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:o,title:this.diceSymbol.name,subTitle:s.name})},disabled:!et.validUrl(o),error:et.validUrl(o)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(o)&&!et.sameOrigin(o)}})}),r.push(At)),r.push({name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let s=this.diceSymbol.clone();s.location.x+=this.gridSize,s.location.y+=this.gridSize,s.update(),ut.play(Xe.dicePut)}}),r.push({name:"\u524a\u9664\u3059\u308b",action:()=>{this.diceSymbol.destroy(),ut.play(Xe.sweep)}}),this.contextMenuService.open(i,r,this.name)}onMove(){ut.play(Xe.dicePick)}onMoved(){ut.play(Xe.dicePut)}diceRoll(){Fe.call("ROLL_DICE_SYMBOL",{identifier:this.diceSymbol.identifier}),ut.play(this.isCoin?Xe.coinToss:Xe.diceRoll1);let e=this.diceSymbol.diceRoll(),i=`${""==this.diceSymbol.name?"(\u7121\u540d\u306e"+(this.isCoin?"\u30b3\u30a4\u30f3":"\u30c0\u30a4\u30b9")+")":this.diceSymbol.name} \u3092${this.isCoin?"\u30c8\u30b9\u3057\u305f":"\u632f\u3063\u305f"}`;return""===this.owner&&(i+=` \u2192 ${e}`),this.chatMessageService.sendOperationLog(i),e}showDetail(e){Fe.trigger("SELECT_TABLETOP_OBJECT",{identifier:e.identifier,className:e.aliasName});let i=this.pointerDeviceService.pointers[0],r="\u30c0\u30a4\u30b9\u30b7\u30f3\u30dc\u30eb\u8a2d\u5b9a";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:i.x-300,top:i.y-300,width:600,height:490}).tabletopObject=e}startIconHiddenTimer(){clearTimeout(this.iconHiddenTimer),this.iconHiddenTimer=setTimeout(()=>{this.iconHiddenTimer=null,this.changeDetector.markForCheck()},300),this.changeDetector.markForCheck()}adjustMinBounds(e,i=0){return e<i?i:e}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(Tn),Oe(lr),Oe(pi),Oe(Di),Oe(li),Oe(vu),Oe(kn),Oe(yr))},t.\u0275cmp=qt({type:t,selectors:[["dice-symbol"]],hostBindings:function(e,i){1&e&&Ie("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{diceSymbol:"diceSymbol",is3D:"is3D"},decls:31,vars:48,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d"],[1,"rotate-frame","is-3d"],[1,"rotate-inner","is-3d"],[1,"is-3d",3,"ngStyle"],[1,"name-tag","is-nowrap","is-black-background","is-3d",2,"transform","translateX(-50%)"],[1,"fornt-tag","is-3d"],["class","material-icons lock-icon",4,"ngIf"],[1,"back-tag","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","image front-face is-3d chrome-smooth-image-trick",3,"src","ngClass",4,"ngIf"],["class","image back-face is-3d chrome-smooth-image-trick","style","transform: rotateY(-180deg)",3,"src","ngClass",4,"ngIf"],[1,"is-3d",2,"position","relative","top","-20%"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src",4,"ngIf"],["class","image shadow is-3d","style","opacity: 0.7; filter: brightness(0) blur(1px)",3,"src","transform",4,"ngIf"],[1,"pedestal-grab","rotate-grab","is-3d"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"material-icons","lock-icon"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"image","front-face","is-3d","chrome-smooth-image-trick",3,"src","ngClass"],[1,"image","back-face","is-3d","chrome-smooth-image-trick",2,"transform","rotateY(-180deg)",3,"src","ngClass"],[1,"image","shadow","is-3d",2,"opacity","0.7","filter","brightness(0) blur(1px)",3,"src"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1)(2,"div",2),Ie("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),nt(3,"div",3)(4,"div",4),xe(5,mee,7,0,"ng-container",5),X(6,"div",1)(7,"div",6)(8,"div",7)(9,"div",8)(10,"div",9)(11,"div",10),Ie("@diceRollNameTag.done",function(s){return i.animationShuffleDone(s)}),X(12,"div",11),xe(13,_ee,2,0,"i",12),be(14),xe(15,$ee,2,0,"span",5),xe(16,vee,2,1,"span",5),xe(17,bee,2,0,"span",5),te(),X(18,"div",13),xe(19,yee,2,0,"i",12),be(20),xe(21,Cee,2,0,"span",5),xe(22,xee,2,1,"span",5),xe(23,wee,2,0,"span",5),te()()(),xe(24,Tee,7,6,"div",14),X(25,"div",1),Ie("@diceRoll.done",function(s){return i.animationShuffleDone(s)})("@coinFlip.done",function(s){return i.animationShuffleDone(s)}),xe(26,Iee,2,8,"img",15),xe(27,See,2,8,"img",16),te()()()(),X(28,"div",17),Ie("@diceRoll.done",function(s){return i.animationShuffleDone(s)}),xe(29,kee,2,4,"img",18),xe(30,Mee,2,6,"img",19),te()()()()()),2&e&&(Je("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),re("movable.option",i.movableOption),W(1),re("@bounceInOut","in"),W(1),re("rotable.option",i.rotableOption),W(1),re("ngClass",ct(44,Dee,i.hasOwner)),W(2),re("ngIf",!i.isIconHidden),W(3),Je("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),W(2),re("ngStyle",ct(46,Aee,"translateX("+i.size*i.gridSize/2+"px) rotateX("+i.nameTagRotate+"deg)")),W(1),re("@changeFaceNameTag",i.isVisible?i.face:null)("@diceRollNameTag",i.animeState),W(2),re("ngIf",i.isLock&&i.hasOwner),W(1),Ze(i.name),W(1),re("ngIf",0<i.name.length),W(1),re("ngIf",i.isVisible),W(1),re("ngIf",!i.isVisible),W(2),re("ngIf",i.isLock&&i.hasOwner),W(1),Ze(i.name),W(1),re("ngIf",0<i.name.length),W(1),re("ngIf",i.isVisible),W(1),re("ngIf",!i.isVisible),W(1),re("ngIf",i.hasOwner&&0<i.ownerName.length),W(1),Je("transform",i.isCoin?"rotateX(30deg)":""),re("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u88cf"==i.face?0:1:null)("@diceRoll",!i.isCoin&&i.animeState)("@coinFlip",i.isCoin&&i.animeState),W(1),re("ngIf",0<i.imageFile.url.length),W(1),re("ngIf",0<i.backFaceImageFile.url.length),W(1),Je("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),re("@changeFace",!i.isCoin&&i.isVisible?i.face:null)("@changeFaceCoin",i.isCoin&&i.isVisible?"\u8868"==i.face?1:2:null)("@diceRoll",i.animeState),W(1),re("ngIf",!i.isFlip&&i.isDropShadow&&0<i.imageFile.url.length),W(1),re("ngIf",i.isFlip&&i.isDropShadow&&0<i.backFaceImageFile.url.length))},directives:[Wl,bu,jn,gn,Ji],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-transition[_ngcontent-%COMP%]{transition:transform 132ms linear}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:22px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px rgb(216,139,75);border-radius:5px}.is-gray-border[_ngcontent-%COMP%]{border-color:#999}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:5px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image.shadow[_ngcontent-%COMP%]{width:100%;height:100%}.is-black-mask[_ngcontent-%COMP%]{filter:brightness(0)}.is-harf-black-mask[_ngcontent-%COMP%]{filter:brightness(.5)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:15px;padding:3px 9px;border-radius:6px;position:absolute;top:-30px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:12px;padding:3px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:18em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.material-icons.lock-icon[_ngcontent-%COMP%]{display:inline-block;font-size:smaller;margin-right:2px}.front-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-face[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;transform:rotateY(-180deg)}"],data:{animation:[yn("diceRoll",[Nt("* => active",[Dt("800ms ease",Qt([We({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(-0deg)",offset:0}),We({transform:"scale3d(1.2, 1.2, 1.2) rotateZ(-360deg)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75) rotateZ(-520deg)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125) rotateZ(-630deg)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-720deg)",offset:1})]))])]),yn("coinFlip",[Nt("* => active",[Dt("800ms ease-out",Qt([We({transform:"scale3d(0.8, 0.8, 0.8) translateY(0%) rotateX(60deg) rotateX(-0deg) rotateY(-0deg)",offset:0}),We({transform:"scale3d(1.2, 1.2, 1.2)  translateY(-28%) rotateX(60deg) rotateX(-360deg) rotateY(-360deg)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75) translateY(-40%) rotateX(60deg) rotateX(-520deg) rotateY(-520deg)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125) translateY(-28%) rotateX(60deg) rotateX(-630deg) rotateY(-630deg)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0) translateY(0%) rotateX(60deg) rotateX(-720deg) rotateY(-720deg)",offset:1})]))])]),yn("diceRollNameTag",[Nt("* => active",[Dt("800ms ease",Qt([We({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),We({transform:"translateX(-50%) scale3d(1.2, 1.2, 1.2) rotateY(360deg)",offset:.5}),We({transform:"translateX(-50%) scale3d(0.75, 0.75, 0.75) rotateY(520deg)",offset:.75}),We({transform:"translateX(-50%) scale3d(1.125, 1.125, 1.125) rotateY(630deg)",offset:.875}),We({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(720deg)",offset:1})]))])]),yn("changeFace",[Nt(":increment,:decrement",[Dt("200ms ease",Qt([We({transform:"scale3d(0.8, 0.8, 0.8) rotateZ(0deg)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateZ(-360deg)",offset:1})]))])]),yn("changeFaceCoin",[Nt(":increment,:decrement",[Dt("200ms ease",Qt([We({transform:"scale3d(0.8, 0.8, 0.8) rotateX(0deg)",offset:0}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateX(-720deg)",offset:1})]))])]),yn("changeFaceNameTag",[Nt(":increment,:decrement",[Dt("200ms ease",Qt([We({transform:"translateX(-50%) scale3d(0.8, 0.8, 0.8) rotateY(0deg)",offset:0}),We({transform:"translateX(-50%) scale3d(1.0, 1.0, 1.0) rotateY(360deg)",offset:1})]))])]),yn("bounceInOut",[Nt("void => *",[Dt("600ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale3d(0, 0, 0)"}))])])]},changeDetection:0}),t})();const Nee=["characterImage"],Fee=["chatBubble"],Ree=function(t){return{opacity:t}};function Oee(t,n){if(1&t&&(nt(0,"img",31),bt(1,"safe")),2&t){const e=ge();Je("height",e.characterShadowImageHeight,"px")("filter","brightness(0) blur(1px)"+(e.isHideIn?" invert(85%)":"")),re("src",yt(1,7,0<e.shadowImageFile.url.length?e.shadowImageFile.url:e.imageFile.url,"resourceUrl"),Xt)("ngStyle",ct(10,Ree,(e.isHollow?.5:.7)*(e.isHideIn?.85:1)))("@switchImageShadow",e.gameCharacter.currntImageIndex)}}const Bee=function(t,n){return{"background-color":t,transform:n}};function Lee(t,n){if(1&t&&(X(0,"div",32)(1,"div",33)(2,"b"),be(3),te()(),X(4,"div",34)(5,"b"),be(6),te()()()),2&t){const e=ge();re("ngStyle",cn(3,Bee,e.ownerColor+"dd","translateX(-50%) translateX("+e.size*e.gridSize/2+"px) translateY(6px) rotateX("+e.nameTagRotate+"deg)")),W(3),Ze(e.ownerName),W(3),Ze(e.ownerName)}}const zee=function(t){return{"is-hide-in-tag":t}},uf=function(t){return{transform:t}};function jee(t,n){if(1&t&&(X(0,"div",35)(1,"div",36),be(2),te(),X(3,"div",37),be(4),te()()),2&t){const e=ge();re("ngClass",ct(4,zee,e.isHideIn))("ngStyle",ct(6,uf,"translateX(-50%) translateX("+e.size*e.gridSize/2+"px) rotateX("+e.nameTagRotate+"deg)")),W(2),Ze(e.name),W(2),Ze(e.name)}}const Uee=function(t){return{"is-hide-in":t}};function Hee(t,n){if(1&t){const e=Ye();X(0,"img",38,39),Ie("load",function(){return ke(e),ge().onImageLoad()}),bt(2,"safe"),te()}if(2&t){const e=ge();Je("height",e.characterImageHeight,"px"),re("src",yt(2,4,e.imageFile.url,"resourceUrl"),Xt)("ngClass",ct(7,Uee,e.isHideIn))}}function Vee(t,n){if(1&t&&(X(0,"span",46),nt(1,"img",47),bt(2,"safe"),te()),2&t){const e=ge(2);W(1),Je("border-color",e.dialogColor),re("src",yt(2,3,e.dialogFaceIcon.url,"resourceUrl"),Xt)}}function Gee(t,n){if(1&t&&(X(0,"span",46),nt(1,"img",47),bt(2,"safe"),te()),2&t){const e=ge(2);W(1),Je("border-color",e.dialogColor),re("src",yt(2,3,e.dialogFaceIcon.url,"resourceUrl"),Xt)}}const lS=function(t,n,e){return{emote:t,rubied:n,"is-whisper":e}};function qee(t,n){if(1&t&&(X(0,"div",40)(1,"div",41)(2,"p",42),xe(3,Vee,3,6,"span",43),nt(4,"span",44),bt(5,"safe"),te(),X(6,"p",45),xe(7,Gee,3,6,"span",43),nt(8,"span",44),bt(9,"safe"),te()()()),2&t){const e=ge();Je("color",!e.isEmote&&e.isWhisper?"#ccc":e.dialogColor),re("@fadeAndScaleInOut",e.isEmote),W(2),Je("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),re("ngClass",qr(23,lS,e.isEmote,e.isRubied,e.isWhisper)),W(1),re("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),W(1),re("innerHTML",yt(5,17,e.dialogText,"html"),Ui),W(2),Je("min-width",e.dialogChatBubbleMinWidth,"px")("border-color",e.dialogColor),re("ngClass",qr(27,lS,e.isEmote,e.isRubied,e.isWhisper)),W(1),re("ngIf",!e.isEmote&&e.isUseFaceIcon&&0<(null==e.dialogFaceIcon?null:e.dialogFaceIcon.url.length)),W(1),re("innerHTML",yt(9,20,e.dialogText,"html"),Ui)}}const Wee=function(t){return{transform:t}};function Kee(t,n){if(1&t&&(X(0,"div",48)(1,"div",41)(2,"span",49)(3,"i"),be(4),te()(),X(5,"span",50)(6,"i"),be(7),te()()(),X(8,"div",41)(9,"span",51),be(10),te(),X(11,"span",52),be(12),te()(),X(13,"div",41)(14,"span",49)(15,"i"),be(16),te()(),X(17,"span",50)(18,"i"),be(19),te()()()()),2&t){const e=ge();Je("height",e.math.abs(e.altitude*e.gridSize)-(e.altitude>0?0:e.chatBubbleAltitude+4),"px"),re("ngStyle",ct(13,Wee,"translateX("+e.size*e.gridSize/2+"px) translateY("+-e.size*e.gridSize/2+"px) rotateX(-90deg) translateY("+(e.altitude>0?-e.altitude*e.gridSize:0)+"px) rotateY("+e.viewRotateZ+"deg)")),W(1),Je("visibility",e.altitude>0?"visible":"hidden"),W(3),Ze(e.elevation),W(3),Ze(e.elevation),W(3),Ze(e.math.abs(e.altitude)),W(2),Ze(e.math.abs(e.altitude)),W(1),Je("visibility",e.altitude<0?"visible":"hidden"),W(3),Ze(e.elevation),W(3),Ze(e.elevation)}}const Yee=function(t,n,e){return{selected:t,"not-inventory":n,"is-hide-in-pedestal":e}},cS=function(t,n,e,i,r,s,o,d){return{black:t,blue:n,green:e,cyan:i,red:r,magenta:s,yellow:o,white:d}},Zee=function(t){return{fall:t}},Xee=function(t,n,e){return{inverse:t,"black-paint":n,hollow:e}},Qee=function(t,n,e){return{bottom:t,transform:n,visibility:e}};let Jee=(()=>{class t{constructor(e,i,r,s,o,d){this.contextMenuService=e,this.panelService=i,this.changeDetector=r,this.pointerDeviceService=s,this.ngZone=o,this.modalService=d,this.gameCharacter=null,this.is3D=!1,this.gridSize=50,this.math=Math,this.stringUtil=et,this.viewRotateX=50,this.viewRotateZ=10,this.heightWidthRatio=1.5,this.selected=!1,this._dialog=null,this.dialogTimeOutId=null,this.chatIntervalId=null,this.naturalImageWidth=0,this.naturalImageHeight=0,this.naturaHeightWidthRatio=1,this.movableOption={},this.rotableOption={}}get name(){return this.gameCharacter.name}get size(){return this.adjustMinBounds(this.gameCharacter.size)}get altitude(){return this.gameCharacter.altitude}set altitude(e){this.gameCharacter.altitude=e}get height(){return this.adjustMinBounds(this.gameCharacter.height)}get imageFile(){return this.gameCharacter.imageFile}get rotate(){return this.gameCharacter.rotate}set rotate(e){this.gameCharacter.rotate=e}get roll(){return this.gameCharacter.roll}set roll(e){this.gameCharacter.roll=e}get isDropShadow(){return this.gameCharacter.isDropShadow}set isDropShadow(e){this.gameCharacter.isDropShadow=e}get isAltitudeIndicate(){return this.gameCharacter.isAltitudeIndicate}set isAltitudeIndicate(e){this.gameCharacter.isAltitudeIndicate=e}get isInverse(){return this.gameCharacter.isInverse}set isInverse(e){this.gameCharacter.isInverse=e}get isHollow(){return this.gameCharacter.isHollow}set isHollow(e){this.gameCharacter.isHollow=e}get isBlackPaint(){return this.gameCharacter.isBlackPaint}set isBlackPaint(e){this.gameCharacter.isBlackPaint=e}get aura(){return this.gameCharacter.aura}set aura(e){this.gameCharacter.aura=e}get isNotRide(){return this.gameCharacter.isNotRide}set isNotRide(e){this.gameCharacter.isNotRide=e}get isUseIconToOverviewImage(){return this.gameCharacter.isUseIconToOverviewImage}set isUseIconToOverviewImage(e){this.gameCharacter.isUseIconToOverviewImage=e}get ownerName(){return this.gameCharacter.ownerName}get ownerColor(){return this.gameCharacter.ownerColor}get isHideIn(){return!!this.gameCharacter.owner}get isVisible(){return this.gameCharacter.isVisible}get isGMMode(){return!!He.myCursor&&He.myCursor.isGMMode}get faceIcon(){return this.gameCharacter.faceIcon}get dialogFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier?It.instance.get(this.dialog.faceIconIdentifier):null}get shadowImageFile(){return this.gameCharacter.shadowImageFile}get elevation(){return+((this.gameCharacter.posZ+this.altitude*this.gridSize)/this.gridSize).toFixed(1)}set dialog(e){if(!this.gameCharacter||this.gameCharacter.isHideIn)return;clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId);let i=et.cr(e.text);const r=et.isEmote(i),s=[],o=/[\|\uff5c]([^\|\uff5c\s]+?)\u300a(.+?)\u300b/g;let d,$=0,I=0;if(!r)for(i=i.replace(/[\u3002\u3001]{3}/g,"\u2026").replace(/[\u3002\u3001]{2}/g,"\u2025").replace(/(\u3002|[\r\n]{2,})/g,"$1                            ").trimEnd();null!==(d=o.exec(i));){let Be=d.index-3*$;s.push({base:d[1],ruby:d[2],start:Be-I,end:Be+d[1].length-I-1}),$++,I+=d[2].length}let Q=1e3/Array.from(i).length>36?1e3/Array.from(i).length:36;Q>200&&(Q=200),this.dialogTimeOutId=setTimeout(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()},Array.from(i).length*Q+6e3),this._dialog=e,this.gameCharacter.isEmote=r,$=0;let fe=0,_e=0,Ce="",Ee=s.shift(),Re="",Le=!1;if(r)this.gameCharacter.text=i,this.changeDetector.markForCheck();else{const Be=Array.from(i.replace(/[\|\uff5c]([^\|\uff5c\s]+?)\u300a.+?\u300b/g,"$1"));this.chatIntervalId=setInterval(()=>{let Ae=Be[$],je=Ae.length>1;if(Ae){if(!Le&&Ee&&fe>=Ee.start&&(Ce+="<ruby>",Le=!0,_e=0),Ce+=et.escapeHtml(Ae),Le){_e+=1;let Ue=Ee.ruby;Re="<rt>"+et.escapeHtml(Array.from(Ue).slice(0,Math.ceil(Array.from(Ue).length*(_e/Array.from(Ee.base).length))).join(""))+"</rt>"}Le&&Ee&&fe>=Ee.end-(je?1:0)&&(Ce+=Re+"</ruby>",Le=!1,Ee=s.shift()),fe+=Ae.length}$+=1,this.gameCharacter.text=Ce+(Le?Re+"</ruby>":""),this.changeDetector.markForCheck(),$>=Be.length&&clearInterval(this.chatIntervalId)},Q)}}get dialogText(){if(!this.gameCharacter||!this.gameCharacter.text)return"";const e=this.gameCharacter.text.replace(/\u3002/g,"\u3002\n\n").split(/[\r\n]{2,}/g).filter(i=>i.trim());return e.length>0?e.reverse()[0].trim():""}get isRubied(){return!(!this.gameCharacter||!this.gameCharacter.text)&&-1<this.dialogText.indexOf("<ruby>")}get dialogChatBubbleMinWidth(){const e=this.characterImageWidth+2.1*this.gridSize,i=this.isUseFaceIcon&&this.dialogFaceIcon&&this.dialogFaceIcon.url,r=11*Array.from(this.dialogText).length+52+(i?32:0);return e<r?e:r}get dialog(){return this._dialog}get chatBubbleXDeg(){let e=90-this.viewRotateX;return e<0&&(e=360+e),e%=360,e>180&&(e=-(180-(e-180))),e>90&&(e=90),e<-90&&(e=-90),e/1.5}get characterImageHeight(){if(!this.characterImage||!this.naturalImageHeight)return 0;if(this.height>0)return this.gridSize*this.height;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),e*this.gridSize*this.size}get characterImageWidth(){if(!this.characterImage||!this.naturalImageWidth)return 0;if(this.height<=0)return this.gridSize*this.size;let e=this.naturaHeightWidthRatio;return e>this.heightWidthRatio&&(e=this.heightWidthRatio),this.gridSize*this.height/e}get characterShadowImageHeight(){return this.characterImageHeight}get characterShadowImageWidth(){return this.characterImageWidth}get characterShadowOffset(){let e=0;return.2<this.height&&this.height<=.3?e=.09:.1<this.height&&this.height<=.2?e=.19:0<this.height&&this.height<=.1&&(e=.29),this.gridSize*this.size/2-.99*this.characterShadowImageHeight-this.gridSize*e}get chatBubbleAltitude(){let e=Math.cos(this.roll*Math.PI/180),i=Math.abs(Math.sin(this.roll*Math.PI/180));e<.5&&(e=.5),i<.5&&(i=.5);const r=(this.characterImageHeight+(this.name?36:0))*e+4,s=this.characterImageWidth/2*i+4+this.characterImageWidth/2;return r>s?r:s}get nameTagRotate(){let e=this.viewRotateX%360-90,i=(this.viewRotateZ+this.rotate)%360,r=this.roll%360;return i=i>0?i:360+i,r=r>0?r:360+r,(e>0?e:360+e)*(90<i&&i<270?1:-1)*(90<=r&&r<=270?-1:1)}get isListen(){return this.dialog&&this.dialog.text&&!this.dialog.dialogTest&&this.dialog.text.trim().length>0}get isWhisper(){return this.dialog&&this.dialog.secret}get isEmote(){return this.gameCharacter.isEmote}get isUseFaceIcon(){return this.dialog&&this.dialog.faceIconIdentifier}get dialogColor(){return this.dialog&&this.dialog.color?this.dialog.color:He.CHAT_DEFAULT_COLOR}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{let i=rt.instance.get(e.data.identifier);!this.gameCharacter||!i||(this.gameCharacter===i||i instanceof Ln&&this.gameCharacter.contains(i))&&(this.gameCharacter.imageFiles.length<=0&&(this.naturalImageHeight=0,this.naturalImageWidth=0,this.naturaHeightWidthRatio=1),this.changeDetector.markForCheck())}).on("SYNCHRONIZE_FILE_LIST",e=>{this.changeDetector.markForCheck()}).on("UPDATE_FILE_RESOURE",e=>{this.changeDetector.markForCheck()}).on("TABLE_VIEW_ROTATE",-1e3,e=>{this.ngZone.run(()=>{this.viewRotateX=e.data.x,this.viewRotateZ=e.data.z,this.changeDetector.markForCheck()})}).on("SELECT_TABLETOP_OBJECT",-1e3,e=>{this.ngZone.run(()=>{this.selected=!(!e.data.highlighting||e.data.identifier!==this.gameCharacter.identifier),this.changeDetector.markForCheck()})}).on("CHANGE_GM_MODE",e=>{this.changeDetector.markForCheck()}).on("POPUP_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&this.ngZone.run(()=>{this.dialog=e.data,this.changeDetector.markForCheck()})}).on("FAREWELL_CHAT_BALLOON",-1e3,e=>{this.gameCharacter&&this.gameCharacter.identifier==e.data.characterIdentifier&&(this.ngZone.run(()=>{this._dialog=null,this.gameCharacter.text="",this.gameCharacter.isEmote=!1,this.changeDetector.markForCheck()}),clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId))}),this.movableOption={tabletopObject:this.gameCharacter,transformCssOffset:"translateZ(1.0px)",colideLayers:["terrain","text-note","character"]},this.rotableOption={tabletopObject:this.gameCharacter}}ngAfterViewInit(){queueMicrotask(()=>{this.gameCharacter.isLoaded=!0})}ngOnDestroy(){clearTimeout(this.dialogTimeOutId),clearInterval(this.chatIntervalId),this.gameCharacter&&(this.gameCharacter.text="",this.gameCharacter.isEmote=!1),Fe.unregister(this)}onDragstart(e){console.log("Dragstart Cancel !!!!"),e.stopPropagation(),e.preventDefault()}onContextMenu(e){e.stopPropagation(),e.preventDefault(),this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:this.isHideIn?"\u4f4d\u7f6e\u3092\u516c\u958b\u3059\u308b":"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u308b\uff08\u30b9\u30c6\u30eb\u30b9\uff09",action:()=>{this.isHideIn?(this.gameCharacter.owner="",ut.play(Xe.piecePut)):(!jt.isStealthMode&&!He.myCursor.isGMMode&&this.modalService.open(qi,{title:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9",text:"\u30b9\u30c6\u30eb\u30b9\u30e2\u30fc\u30c9\u306b\u306a\u308a\u307e\u3059\u3002",help:"\u4f4d\u7f6e\u3092\u81ea\u5206\u3060\u3051\u898b\u3066\u3044\u308b\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u304c1\u3064\u4ee5\u4e0a\u30c6\u30fc\u30d6\u30eb\u4e0a\u306b\u3042\u308b\u9593\u3001\u3042\u306a\u305f\u306e\u30ab\u30fc\u30bd\u30eb\u4f4d\u7f6e\u306f\u4ed6\u306e\u53c2\u52a0\u8005\u306b\u4f1d\u308f\u308a\u307e\u305b\u3093\u3002",type:_i.OK,materialIcon:"disabled_visible"}),this.gameCharacter.owner=vt.peerContext.userId,ut.play(Xe.sweep),Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier})),Fe.call("UPDATE_INVENTORY",!0)}},At,this.gameCharacter.imageFiles.length<=1?null:{name:"\u753b\u50cf\u5207\u308a\u66ff\u3048",action:null,subActions:this.gameCharacter.imageFiles.map((r,s)=>({name:this.gameCharacter.currntImageIndex==s?"\u25c9":"\u25cb",action:()=>{this.changeImage(s)},default:this.gameCharacter.currntImageIndex==s,icon:r}))},this.gameCharacter.imageFiles.length<=1?null:At,this.isUseIconToOverviewImage?{name:"\u2611 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30aa\u30fc\u30d0\u30fc\u30d3\u30e5\u30fc\u306b\u9854IC\u3092\u4f7f\u7528",action:()=>{this.isUseIconToOverviewImage=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.gameCharacter.isShowChatBubble?{name:"\u2611 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u{1f4ad}\u306e\u8868\u793a",action:()=>{this.gameCharacter.isShowChatBubble=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isDropShadow?{name:"\u2611 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u5f71\u306e\u8868\u793a",action:()=>{this.isDropShadow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u753b\u50cf\u52b9\u679c",action:null,subActions:[this.isInverse?{name:"\u2611 \u53cd\u8ee2",action:()=>{this.isInverse=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u53cd\u8ee2",action:()=>{this.isInverse=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isHollow?{name:"\u2611 \u307c\u304b\u3057",action:()=>{this.isHollow=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u307c\u304b\u3057",action:()=>{this.isHollow=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isBlackPaint?{name:"\u2611 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ed2\u5857\u308a",action:()=>{this.isBlackPaint=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30aa\u30fc\u30e9",action:null,subActions:[{name:(-1==this.aura?"\u25c9":"\u25cb")+" \u306a\u3057",action:()=>{this.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)}},At].concat(["\u30d6\u30e9\u30c3\u30af","\u30d6\u30eb\u30fc","\u30b0\u30ea\u30fc\u30f3","\u30b7\u30a2\u30f3","\u30ec\u30c3\u30c9","\u30de\u30bc\u30f3\u30bf","\u30a4\u30a8\u30ed\u30fc","\u30db\u30ef\u30a4\u30c8"].map((r,s)=>({name:`${this.aura==s?"\u25c9":"\u25cb"} ${r}`,action:()=>{this.aura=s,Fe.trigger("UPDATE_INVENTORY",null)}})))},At,{name:"\u30ea\u30bb\u30c3\u30c8",action:()=>{this.isInverse=!1,this.isHollow=!1,this.isBlackPaint=!1,this.aura=-1,Fe.trigger("UPDATE_INVENTORY",null)},disabled:!this.isInverse&&!this.isHollow&&!this.isBlackPaint&&-1==this.aura}]},At,this.isNotRide?{name:"\u2610 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2611 \u4ed6\u306e\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u306b\u4e57\u308b",action:()=>{this.isNotRide=!0,Fe.trigger("UPDATE_INVENTORY",null)}},this.isAltitudeIndicate?{name:"\u2611 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u9ad8\u5ea6\u306e\u8868\u793a",action:()=>{this.isAltitudeIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u9ad8\u5ea6\u30920\u306b\u3059\u308b",action:()=>{0!=this.altitude&&(this.altitude=0,this.isHideIn||ut.play(Xe.sweep))},altitudeHande:this.gameCharacter},At,{name:"\u8a73\u7d30\u3092\u8868\u793a",action:()=>{this.showDetail(this.gameCharacter)}},{name:"\u30c1\u30e3\u30c3\u30c8\u30d1\u30ec\u30c3\u30c8\u3092\u8868\u793a",action:()=>{this.showChatPalette(this.gameCharacter)}},{name:"\u30b9\u30bf\u30f3\u30c9\u8a2d\u5b9a",action:()=>{this.showStandSetting(this.gameCharacter)}},At,{name:"\u53c2\u7167URL\u3092\u958b\u304f",action:null,subActions:this.gameCharacter.getUrls().map(r=>{const s=r.value.toString();return{name:r.name?r.name:s,action:()=>{et.sameOrigin(s)?window.open(s.trim(),"_blank","noopener"):this.modalService.open(Qr,{url:s,title:this.gameCharacter.name,subTitle:r.name})},disabled:!et.validUrl(s),error:et.validUrl(s)?null:"URL\u304c\u4e0d\u6b63\u3067\u3059",isOuterLink:et.validUrl(s)&&!et.sameOrigin(s)}}),disabled:this.gameCharacter.getUrls().length<=0},At,this.gameCharacter.isInventoryIndicate?{name:"\u2611 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!1,Fe.trigger("UPDATE_INVENTORY",null)}}:{name:"\u2610 \u30c6\u30fc\u30d6\u30eb\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea\u306b\u8868\u793a",action:()=>{this.gameCharacter.isInventoryIndicate=!0,Fe.trigger("UPDATE_INVENTORY",null)}},{name:"\u30c6\u30fc\u30d6\u30eb\u304b\u3089\u79fb\u52d5",action:null,subActions:[{name:"\u5171\u6709\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("common"),ut.play(Xe.piecePut)}},{name:"\u500b\u4eba\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation(vt.peerId),ut.play(Xe.piecePut)}},{name:"\u5893\u5834",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),ut.play(Xe.sweep)}}]},At,{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b",action:()=>{let r=this.gameCharacter.clone();r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),ut.play(Xe.piecePut)}},{name:"\u30b3\u30d4\u30fc\u3092\u4f5c\u308b\uff08\u81ea\u52d5\u63a1\u756a\uff09",action:()=>{const r=this.gameCharacter.clone(),s=r.name.split("_");let o;o=s.length>1&&/\d+/.test(s[s.length-1])?s.slice(0,s.length-1).join("_"):s.join("_");let d=0;for(const $ of rt.instance.getObjects(jt)){if(!$.name.startsWith(o))continue;let I=$.name.match(/_(\d+)$/)?+RegExp.$1:0;I>d&&(d=I)}r.name=o+"_"+(d+1),r.location.x+=this.gridSize,r.location.y+=this.gridSize,r.update(),ut.play(Xe.piecePut)}},At,{name:"\u524a\u9664\u3059\u308b\uff08\u5893\u5834\u3078\u79fb\u52d5\uff09",action:()=>{Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),this.gameCharacter.setLocation("graveyard"),ut.play(Xe.sweep)}}],this.name)}onMove(){this.isHideIn||ut.play(Xe.piecePick)}onMoved(){this.gameCharacter&&this.gameCharacter.text&&Fe.call("FAREWELL_CHAT_BALLOON",{characterIdentifier:this.gameCharacter.identifier}),this.isHideIn||ut.play(Xe.piecePut),this.selected=!1}onImageLoad(){this.naturalImageWidth=this.characterImage.nativeElement.naturalWidth,this.naturalImageHeight=this.characterImage.nativeElement.naturalHeight,this.naturaHeightWidthRatio=this.naturalImageWidth&&this.naturalImageHeight?this.naturalImageHeight/this.naturalImageWidth:1}adjustMinBounds(e,i=0){return e<i?i:e}showDetail(e){let i=this.pointerDeviceService.pointers[0],r="\u30ad\u30e3\u30e9\u30af\u30bf\u30fc\u30b7\u30fc\u30c8";e.name.length&&(r+=" - "+e.name),this.panelService.open(lo,{title:r,left:i.x-400,top:i.y-300,width:800,height:600}).tabletopObject=e}showChatPalette(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(cu,{left:i.x-250,top:i.y-175,width:620,height:350}).character=e}showStandSetting(e){let i=this.pointerDeviceService.pointers[0];this.panelService.open(Wp,{left:i.x-400,top:i.y-175,width:730,height:572}).character=e}changeImage(e){this.gameCharacter.currntImageIndex!=e&&(this.gameCharacter.currntImageIndex=e,this.isHideIn||ut.play(Xe.surprise),Fe.call("FAREWELL_STAND_IMAGE",{characterIdentifier:this.gameCharacter.identifier}),Fe.trigger("UPDATE_INVENTORY",null))}nextImage(){this.gameCharacter.imageFiles.length<=1||this.changeImage(this.gameCharacter.currntImageIndex+1>=this.gameCharacter.imageFiles.length?0:this.gameCharacter.currntImageIndex+1)}}return t.\u0275fac=function(e){return new(e||t)(Oe(lr),Oe(Tn),Oe(Di),Oe(li),Oe(bn),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["game-character"]],viewQuery:function(e,i){if(1&e&&(dn(Nee,5),dn(Fee,5)),2&e){let r;un(r=fn())&&(i.characterImage=r.first),un(r=fn())&&(i.chatBubble=r.first)}},hostBindings:function(e,i){1&e&&Ie("dragstart",function(s){return i.onDragstart(s)})("contextmenu",function(s){return i.onContextMenu(s)})},inputs:{gameCharacter:"gameCharacter",is3D:"is3D"},decls:36,vars:85,consts:[["appMovable","",1,"component","is-3d","is-grab","is-pointer-events-none",3,"movable.option","movable.ondragstart","movable.ondragend"],[1,"component-content","is-3d"],["appRotable","",1,"component-content","is-3d","is-pointer-events-auto",3,"rotable.option","rotable.ondragstart","rotable.ondragend"],[1,"pedestal-inner",3,"ngClass"],[1,"pedestal-outer"],[1,"pedestal-grab","rotate-grab"],[1,"pedestal-grab-border"],[1,"material-icons","of-front"],[1,"material-icons","of-back"],[1,"is-pointer-events-none","is-3d",2,"transform-origin","center bottom"],[1,"image-box","is-3d",2,"transform-origin","center 66%"],[1,"aura","is-3d",2,"pointer-events","none",3,"ngClass"],[1,"is-3d",2,"pointer-events","none","transition","transform 132ms 0s ease",3,"ngStyle"],["class","image drop-shadow is-3d  chrome-smooth-image-trick","style","pointer-events: none",3,"height","src","filter","ngStyle",4,"ngIf"],[1,"upright-transform","is-fit-width","is-3d",3,"ngClass","ngStyle","dblclick"],["appRotable","",1,"rotate-frame","is-3d",2,"position","absolute",3,"rotable.value","rotable.valueChange","rotable.ondragstart","rotable.ondragend"],[1,"rotate-inner","is-3d"],["class","owner-tag is-nowrap is-black-background is-3d",3,"ngStyle",4,"ngIf"],["class","name-tag is-nowrap is-black-background is-3d",3,"ngClass","ngStyle",4,"ngIf"],[1,"is-pointer-events-none","is-3d","aura",3,"ngClass"],[1,"inverser","is-3d",3,"ngClass"],[1,"image-box","is-3d"],["class","image is-3d chrome-smooth-image-trick",3,"src","ngClass","height","load",4,"ngIf"],[1,"grab-group","is-3d"],[1,"rotate-grab","rotate-grab-icon","of-top","is-3d",3,"ngStyle"],[1,"material-icons"],[1,"rotate-grab","rotate-grab-icon","of-bottom","is-3d",3,"ngStyle"],[1,"chat-bubble","is-3d",3,"ngStyle"],["chatBubble",""],["class","is-3d","style","transform-origin: center bottom;",3,"color",4,"ngIf"],["class","is-3d","style","display: flex; flex-flow: column nowrap; justify-content: space-between; border-left: 2px dashed black; transform-origin: top left",3,"height","ngStyle",4,"ngIf"],[1,"image","drop-shadow","is-3d","chrome-smooth-image-trick",2,"pointer-events","none",3,"src","ngStyle"],[1,"owner-tag","is-nowrap","is-black-background","is-3d",3,"ngStyle"],[1,"fornt-tag","is-3d",2,"color","whitesmoke"],[1,"back-tag","is-3d",2,"color","whitesmoke"],[1,"name-tag","is-nowrap","is-black-background","is-3d",3,"ngClass","ngStyle"],[1,"fornt-tag","has-length-limit","is-3d"],[1,"back-tag","has-length-limit","is-3d"],[1,"image","is-3d","chrome-smooth-image-trick",3,"src","ngClass","load"],["characterImage",""],[1,"is-3d",2,"transform-origin","center bottom"],[1,"is-3d"],[1,"is-3d","chat-bubble-buyo",2,"position","absolute","backface-visibility","hidden",3,"ngClass"],["class","face-icon-box is-3d",4,"ngIf"],[3,"innerHTML"],[1,"is-3d","chat-bubble-buyo","back",2,"backface-visibility","hidden","transform","rotateY(-180deg)",3,"ngClass"],[1,"face-icon-box","is-3d"],[1,"face-icon","is-3d",3,"src"],[1,"is-3d",2,"display","flex","flex-flow","column nowrap","justify-content","space-between","border-left","2px dashed black","transform-origin","top left",3,"ngStyle"],[1,"elevation-indicator","is-3d",2,"position","absolute"],[1,"elevation-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"],[1,"altitude-indicator","is-3d",2,"position","absolute"],[1,"altitude-indicator","is-3d",2,"position","absolute","transform","rotateY(-180deg)"]],template:function(e,i){1&e&&(X(0,"div",0),Ie("movable.ondragstart",function(){return i.onMove()})("movable.ondragend",function(){return i.onMoved()}),X(1,"div",1)(2,"div",2),Ie("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),nt(3,"div",3)(4,"div",4),X(5,"div",5)(6,"div",6)(7,"div",7),be(8,"autorenew"),te(),X(9,"div",8),be(10,"autorenew"),te()()(),X(11,"div",9)(12,"div",10)(13,"div",11)(14,"div",12),xe(15,Oee,2,12,"img",13),te()()()(),X(16,"div",14),Ie("dblclick",function(){return i.nextImage()}),X(17,"div",15),Ie("rotable.valueChange",function(s){return i.roll=s})("rotable.ondragstart",function(){return i.onMove()})("rotable.ondragend",function(){return i.onMoved()}),X(18,"div",16),xe(19,Lee,7,6,"div",17),xe(20,jee,5,8,"div",18),X(21,"div",19)(22,"div",20)(23,"span",21),xe(24,Hee,3,9,"img",22),te()()(),X(25,"div",23)(26,"div",24)(27,"i",25),be(28,"autorenew"),te()(),X(29,"div",26)(30,"i",25),be(31,"autorenew"),te()()()()(),X(32,"div",27,28),xe(34,qee,10,31,"div",29),te()()(),xe(35,Kee,20,15,"div",30),te()()),2&e&&(Je("width",i.size*i.gridSize,"px")("height",i.size*i.gridSize,"px"),re("movable.option",i.movableOption),W(1),re("@bounceInOut","in"),W(1),re("rotable.option",i.rotableOption),W(1),re("@switchImagePedestal",i.gameCharacter.currntImageIndex)("ngClass",qr(45,Yee,i.selected,!i.gameCharacter.isInventoryIndicate,i.isHideIn)),W(1),re("@switchImagePedestal",i.gameCharacter.currntImageIndex),W(7),Je("transform","translateX("+(i.size*i.gridSize-i.characterShadowImageWidth)/2+"px) translateY("+i.characterShadowOffset+"px) scale(1.0, 0.66)"),W(1),Je("width",i.characterShadowImageWidth,"px")("height",i.characterShadowImageHeight,"px")("transform","rotateZ("+i.roll+"deg)"),W(1),re("ngClass",vo(49,cS,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),W(1),re("ngStyle",ct(58,uf,"scaleX("+(i.isInverse?"-1":"1")+")")),W(1),re("ngIf",i.isDropShadow&&(0<i.imageFile.url.length||0<i.shadowImageFile.url.length)),W(1),re("ngClass",ct(60,Zee,0==i.altitude))("ngStyle",ct(62,uf,"rotateY(90deg) rotateZ(-90deg) rotateY(-90deg) translateY(-50%) translateY("+-i.altitude*i.gridSize+"px)")),W(1),Je("transform-origin","center "+.333*-i.characterImageHeight+"px"),re("rotable.value",i.roll),W(1),Je("transform","translateZ("+-i.size*i.gridSize/2+"px)"),W(1),re("ngIf",i.isGMMode&&i.isHideIn&&0<i.ownerName.length),W(1),re("ngIf",0<i.name.length),W(1),re("@switchImage",i.gameCharacter.currntImageIndex)("ngClass",vo(64,cS,0==i.aura,1==i.aura,2==i.aura,3==i.aura,4==i.aura,5==i.aura,6==i.aura,7==i.aura)),W(1),re("ngClass",qr(73,Xee,i.isInverse,i.isBlackPaint,i.isHollow)),W(1),Je("width",i.characterImageWidth,"px")("height",i.characterImageHeight,"px")("transform","translateX("+(i.size*i.gridSize-i.characterImageWidth)/2+"px)"),W(1),re("ngIf",0<i.imageFile.url.length),W(2),re("ngStyle",ct(77,uf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px) translateY("+(-i.characterImageHeight-(i.isGMMode&&i.isHideIn?20:0))+"px)")),W(3),re("ngStyle",ct(79,uf,"translateX(-50%) translateX("+i.size*i.gridSize/2+"px")),W(3),re("ngStyle",qr(81,Qee,i.chatBubbleAltitude-(i.isEmote?i.gridSize/2:0)-4+"px","translateZ("+-i.size*i.gridSize/2+"px) translateX(-50%) translateX("+i.size*i.gridSize/2+"px) rotateY("+(i.rotate+i.viewRotateZ)+"deg) rotateX("+i.chatBubbleXDeg+"deg)",i.gameCharacter.isShowChatBubble?"visible":"hidden")),W(2),re("ngIf",i.isListen),W(1),re("ngIf",i.isAltitudeIndicate&&(i.altitude<=-.5||.5<=i.altitude)))},directives:[Wl,bu,jn,Ji,gn],pipes:[Yn],styles:['[_nghost-%COMP%]{display:block}.is-grab[_ngcontent-%COMP%]{cursor:-webkit-grab;cursor:grab}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.upright-transform.fall[_ngcontent-%COMP%]{transition:transform 132ms cubic-bezier(.21,.97,.75,1.25)}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.is-pointer-events-auto[_ngcontent-%COMP%]{pointer-events:auto}.component[_ngcontent-%COMP%]{position:absolute;height:50px;width:50px;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.component-content[_ngcontent-%COMP%]{width:100%;height:100%}.pedestal-grab[_ngcontent-%COMP%]{z-index:-1;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;top:-22px;left:-6px;height:calc(100% + 44px);width:calc(100% + 12px);cursor:default;border-radius:37px}.pedestal-grab-border[_ngcontent-%COMP%]{pointer-events:none;width:100%;height:100%;box-sizing:border-box;border-top:solid 28px #999;border-left:solid 12px #999;border-right:solid 12px #CCC;border-bottom:solid 28px #CCC;border-radius:37px}.pedestal-inner[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 6px #FFCC80;border-radius:25px}.pedestal-inner.not-inventory[_ngcontent-%COMP%]{border-color:#80ccee}.pedestal-outer[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;box-sizing:border-box;border:solid 2px #212121;border-radius:25px}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;transform:rotateX(-90deg) translateY(-50%)}.is-fit-width[_ngcontent-%COMP%]{height:auto;width:100%}.fill-frame[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.image[_ngcontent-%COMP%]{bottom:0;left:0;right:0;margin:auto;width:100%;height:auto;vertical-align:bottom}.image-box[_ngcontent-%COMP%]{display:inline-block;text-align:center}.image-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{-o-object-fit:contain;object-fit:contain;-o-object-position:50% 100%;object-position:50% 100%;margin-bottom:0;margin-top:auto;image-rendering:-webkit-optimize-contrast;image-rendering:crisp-edges}.inverse[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.inverser[_ngcontent-%COMP%]{transition:transform 132ms 0s ease}.hollow[_ngcontent-%COMP%]{opacity:.6;filter:blur(1px)}.black-paint[_ngcontent-%COMP%]{filter:brightness(0)}.aura[_ngcontent-%COMP%]{transition:filter .2s ease-in-out}.aura.black[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px black)}.aura.blue[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #33f)}.aura.green[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3f3)}.aura.cyan[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #3ff)}.aura.red[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f00)}.aura.magenta[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #f0f)}.aura.yellow[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #ff3)}.aura.white[_ngcontent-%COMP%]{filter:drop-shadow(0 -4px 4px #fff)}.name-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:13px;padding:2px 8px;border-radius:12px;position:absolute;top:-26px;transform-origin:center bottom}.owner-tag[_ngcontent-%COMP%]{box-sizing:border-box;font-size:11px;padding:2px 9px;border-radius:6px;position:absolute;top:-55px;transform-origin:center bottom}.rotate-frame[_ngcontent-%COMP%]{bottom:0;left:0;right:0;overflow:visible}.rotate-inner[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0;width:100%;height:auto;overflow:visible}.is-nowrap[_ngcontent-%COMP%]{white-space:nowrap}.is-black-background[_ngcontent-%COMP%]{color:#ccc;background-color:#1e1e1ecc}.is-black-background.is-hide-in-tag[_ngcontent-%COMP%]{color:#1e1e1e;background-color:#e9e9e9cc}.fornt-tag[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden}.back-tag[_ngcontent-%COMP%]{position:absolute;top:3px;-webkit-backface-visibility:hidden;backface-visibility:hidden;transform:rotateY(-180deg)}.has-length-limit[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;max-width:24em}.rotate-grab-icon[_ngcontent-%COMP%]{position:absolute;width:28px;height:28px;box-sizing:border-box;cursor:-moz-default;cursor:-webkit-default;cursor:default;z-index:1;padding:2px;background-color:#ccc;border-radius:100%;color:#444;font-size:8px}.of-top[_ngcontent-%COMP%]{top:-42px}.of-bottom[_ngcontent-%COMP%]{bottom:-30px}.of-front[_ngcontent-%COMP%]{position:absolute;width:24px;left:0;right:0;bottom:0;margin:auto;color:#444}.of-back[_ngcontent-%COMP%]{position:absolute;width:24px;top:0;left:0;right:0;margin:auto;color:#444}.rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]:hover   .rotate-grab[_ngcontent-%COMP%]{opacity:.5}.component[_ngcontent-%COMP%]:active   .rotate-grab[_ngcontent-%COMP%]{opacity:0}.component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:hover, .component[_ngcontent-%COMP%]   .rotate-grab[_ngcontent-%COMP%]:active{opacity:1}.material-icons[_ngcontent-%COMP%]{display:none}.component[_ngcontent-%COMP%]:hover   .material-icons[_ngcontent-%COMP%], .component[_ngcontent-%COMP%]:active   .material-icons[_ngcontent-%COMP%]{display:inline}.altitude-indicator[_ngcontent-%COMP%]{font-size:10px}.elevation-indicator[_ngcontent-%COMP%], .altitude-indicator[_ngcontent-%COMP%]{padding-left:2px;color:#000;text-shadow:whitesmoke 0px 0px 3px;-webkit-backface-visibility:hidden;backface-visibility:hidden}.elevation-indicator[_ngcontent-%COMP%]{font-weight:bolder;font-size:12px}.chat-bubble[_ngcontent-%COMP%]{position:absolute;pointer-events:none;transform-origin:center calc(100% + 12px)}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{box-sizing:border-box;display:inline-block;max-width:100%;min-width:130px;font-size:13px;background:linear-gradient(-30deg,rgba(240,218,189,.9),rgba(255,244,232,.9));border:1px solid;border-radius:24px;margin:0;padding:6px 12px;white-space:pre-wrap;word-break:break-word;overflow-wrap:anywhere;text-align:center}.chat-bubble[_ngcontent-%COMP%]   p.rubied[_ngcontent-%COMP%]{padding-top:12px}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]{text-align:center;font-size:38px;font-weight:700;border:none;background:none;min-width:300px;-webkit-text-stroke:1px rgb(240,218,189);letter-spacing:-2px;white-space:pre}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper[_ngcontent-%COMP%]{border-radius:24px 12px;font-size:13px;background:rgba(85,85,85,.8);box-shadow:0 0 2px #ccc}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]{font-size:38px;font-weight:700;border:none;background:none;min-width:200px;-webkit-text-stroke:2px #555;box-shadow:none}.chat-bubble[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:after{box-sizing:border-box;content:"";position:absolute;padding:0;line-height:1;vertical-align:baseline;left:50%;margin:0 0 0 -8px;bottom:-17px;border:8px solid transparent;border-top-color:inherit}.chat-bubble[_ngcontent-%COMP%]   p.emote[_ngcontent-%COMP%]:after{border:0px none transparent}.chat-bubble[_ngcontent-%COMP%]   p.is-whisper.emote[_ngcontent-%COMP%]:after{content:none}.chat-bubble-buyo[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo 1.2s ease-in-out .1s infinite alternate;transform:scale3d(.9,.9,.9)}.chat-bubble-buyo.back[_ngcontent-%COMP%]{transform-origin:center calc(100% + 8px);transition:all .2s ease;-webkit-animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;animation:chat-bubble-buyo-back 1.2s ease-in-out .1s infinite alternate;transform:rotateY(-180deg) scale3d(.9,.9,.9)}.chat-bubble-buyo.emote[_ngcontent-%COMP%]{-webkit-animation-duration:.6s;animation-duration:.6s}@-webkit-keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@keyframes chat-bubble-buyo{0%{transform:scale3d(.9,.9,.9)}to{transform:scale(1)}}@-webkit-keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scale(1)}}@keyframes chat-bubble-buyo-back{0%{transform:rotateY(-180deg) scale3d(.9,.9,.9)}to{transform:rotateY(-180deg) scale(1)}}.drop-shadow[_ngcontent-%COMP%]{pointer-events:none}.face-icon-box[_ngcontent-%COMP%]{display:block;position:relative;border:0px none;width:36px;height:36px;max-width:36px;max-height:36px;overflow:hidden;left:-20px;top:-18px;margin-right:-16px;margin-bottom:-22px;float:left;-webkit-backface-visibility:hidden;backface-visibility:hidden}p.rubied[_ngcontent-%COMP%]   .face-icon-box[_ngcontent-%COMP%]{top:-21px}.face-icon-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;vertical-align:bottom;-o-object-fit:cover;object-fit:cover;-o-object-position:50% 0%;object-position:50% 0%;border-radius:.4em}.selected[_ngcontent-%COMP%]{filter:drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow);transition:all .2s ease-in}.is-hide-in-pedestal[_ngcontent-%COMP%]{filter:grayscale(70%)}.is-hide-in-pedestal.selected[_ngcontent-%COMP%]{filter:grayscale(70%) drop-shadow(0px 0px 8px yellow) drop-shadow(0px 0px 4px yellow)}.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) opacity(85%)}'],data:{animation:[yn("switchImage",[Nt(":increment, :decrement",[Dt("400ms ease",Qt([We({transform:"scale3d(0.8, 0.8, 0.8) rotateY(0deg)"}),We({transform:"scale3d(1.2, 1.2, 1.2) rotateY(180deg)"}),We({transform:"scale3d(1.0, 1.0, 1.0) rotateY(360deg)"})]))])]),yn("switchImageShadow",[Nt(":increment, :decrement",[Dt("400ms ease",Qt([We({transform:"scale3d(0.8, 0.8, 0.8)"}),We({transform:"scale3d(0, 1.2, 1.2)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),yn("switchImagePedestal",[Nt(":increment, :decrement",[Dt("400ms ease",Qt([We({transform:"scale3d(0, 0, 0)"}),We({transform:"scale3d(1.2, 1.2, 1.2)"}),We({transform:"scale3d(1.0, 1.0, 1.0)"})]))])]),yn("bounceInOut",[Nt("void => *",[Dt("600ms ease",Qt([We({transform:"scale3d(0, 0, 0)",offset:0}),We({transform:"scale3d(1.5, 1.5, 1.5)",offset:.5}),We({transform:"scale3d(0.75, 0.75, 0.75)",offset:.75}),We({transform:"scale3d(1.125, 1.125, 1.125)",offset:.875}),We({transform:"scale3d(1.0, 1.0, 1.0)",offset:1})]))]),Nt("* => void",[Dt(100,We({transform:"scale3d(0, 0, 0)"}))])]),yn("fadeAndScaleInOut",[Nt("void => *, true => false",[Dt("200ms ease-in-out",Qt([We({transform:"scale3d(0, 0, 0)",opacity:0}),We({transform:"scale3d(1.0, 1.0, 1.0)",opacity:.8})]))]),Nt("* => void, true => false",[Dt("100ms ease-in-out",We({transform:"scale3d(0, 0, 0)",opacity:0}))])])]},changeDetection:0}),t})();const ete=["cursor"],tte=["opacity"],nte=["rotate"];function ite(t,n){if(1&t&&(X(0,"div",8)(1,"div",9),bt(2,"safe"),X(3,"div",10)(4,"span",11),be(5),te()()()()),2&t){const e=n.$implicit,i=ge(2);Je("background-color",i.color),re("ngClass",e),W(1),Je("background-image",yt(2,8,"url("+i.iconUrl+")","style")),W(2),Je("background-color",i.color),W(2),Ze(i.name)}}const rte=function(){return["is-front","is-back"]};function ste(t,n){1&t&&(Ge(0),X(1,"div",1,2)(3,"div",3,4)(5,"div",5,6),xe(7,ite,6,11,"div",7),te()()(),qe()),2&t&&(W(7),re("ngForOf",Yo(1,rte)))}class wr{constructor(n,e,i,r){this.changeDetector=n,this.batchService=e,this.coordinateService=i,this.ngZone=r,this.cursor=He.myCursor,this.cursorElement=null,this.opacityElement=null,this.rotateElement=null,this.fadeOutTimer=null,this.updateInterval=null,this.callcack=s=>this.onMouseMove(s),this._x=0,this._y=0}get iconUrl(){return this.cursor.image.url}get name(){return this.cursor.name}get isMine(){return this.cursor.isMine}get color(){return this.cursor.color&&"#ffffff"!=this.cursor.color?this.cursor.color:"#f0dabd"}get rotateZ(){return wr.viewRotateZ}get nameTagRotate(){let n=wr.viewRotateX%360-90;return-(n>0?n:360+n)}get delayMs(){let n=16.6*vt.peerIds.length;return n<100?100:n}ngOnInit(){this.isMine||Fe.register(this).on("CURSOR_MOVE",n=>{n.sendFrom===this.cursor.peerId&&this.batchService.add(()=>{this.stopTransition(),this.setAnimatedTransition(),this.setPosition(n.data[0],n.data[1],n.data[2]),this.setRotate(),this.resetFadeOut(),this.changeDetector.markForCheck()},this)}).on("TABLE_VIEW_ROTATE",-1e3,n=>{this.ngZone.run(()=>{wr.viewRotateX=n.data.x,wr.viewRotateZ=n.data.z,this.rotateElement&&this.setRotate(),this.changeDetector.markForCheck()})})}ngAfterViewInit(){this.isMine?this.ngZone.runOutsideAngular(()=>{document.body.addEventListener("mousemove",this.callcack),document.body.addEventListener("touchmove",this.callcack)}):(this.cursorElement=this.cursorElementRef.nativeElement,this.opacityElement=this.opacityElementRef.nativeElement,this.rotateElement=this.rotateElementRef.nativeElement,this.setAnimatedTransition(),this.setPosition(0,0,0),this.resetFadeOut())}ngOnDestroy(){document.body.removeEventListener("mousemove",this.callcack),document.body.removeEventListener("touchmove",this.callcack),Fe.unregister(this),this.batchService.remove(this),this.fadeOutTimer&&this.fadeOutTimer.clear()}onMouseMove(n){let e=n.touches?n.changedTouches[0].pageX:n.pageX,i=n.touches?n.changedTouches[0].pageY:n.pageY;e===this._x&&i===this._y||(this._x=e,this._y=i,this._target=n.target,this.updateInterval||(this.updateInterval=setTimeout(()=>{this.updateInterval=null,this.calcLocalCoordinate(this._x,this._y,this._target)},this.delayMs)))}calcLocalCoordinate(n,e,i){if(!document.getElementById("app-table-layer").contains(i))return;let r={x:n,y:e,z:0};r=this.coordinateService.calcTabletopLocalCoordinate(r,i),Fe.call("CURSOR_MOVE",[r.x,r.y,r.z])}resetFadeOut(){this.opacityElement.style.opacity="1.0",null==this.fadeOutTimer&&(this.fadeOutTimer=new ia(()=>{this.opacityElement.style.opacity="0.0"},3e3)),this.fadeOutTimer.reset()}stopTransition(){this.cursorElement.style.transform=window.getComputedStyle(this.cursorElement).transform}setAnimatedTransition(){this.cursorElement.style.transition=`transform ${this.delayMs+33}ms linear, opacity 0.5s ease-out`}setPosition(n,e,i){this.cursorElement.style.transform=`translateX(${n.toFixed(4)}px) translateY(${e.toFixed(4)}px) translateZ(${i.toFixed(4)}px)`}setRotate(){this.rotateElement.style.transform=`rotateZ(${-this.rotateZ}deg) rotateX(${this.nameTagRotate}deg)`}}wr.viewRotateX=50,wr.viewRotateZ=10,wr.ctor=void Fe.register(wr).on("TABLE_VIEW_ROTATE",-1e3,t=>{wr.viewRotateX=t.data.x,wr.viewRotateZ=t.data.z}),wr.\u0275fac=function(n){return new(n||wr)(Oe(Di),Oe(rg),Oe(Ul),Oe(bn))},wr.\u0275cmp=qt({type:wr,selectors:[["peer-cursor"],["","peer-cursor",""]],viewQuery:function(n,e){if(1&n&&(dn(ete,5),dn(tte,5),dn(nte,5)),2&n){let i;un(i=fn())&&(e.cursorElementRef=i.first),un(i=fn())&&(e.opacityElementRef=i.first),un(i=fn())&&(e.rotateElementRef=i.first)}},inputs:{cursor:"cursor"},decls:1,vars:1,consts:[[4,"ngIf"],[1,"component","is-3d","is-transition","is-pointer-events-none"],["cursor",""],[1,"is-3d"],["rotate",""],[1,"upright-transform","is-3d","is-transition"],["opacity",""],["class","peer-cursor is-3d",3,"ngClass","background-color",4,"ngFor","ngForOf"],[1,"peer-cursor","is-3d",3,"ngClass"],[1,"icon","is-3d"],[1,"name","is-center","is-3d"],[1,"is-3d",2,"white-space","nowrap","color","whitesmoke"]],template:function(n,e){1&n&&xe(0,ste,8,2,"ng-container",0),2&n&&re("ngIf",!e.isMine)},directives:[gn,Jn,jn],pipes:[Yn],styles:["[_nghost-%COMP%]{display:block}.component[_ngcontent-%COMP%]{position:absolute;overflow:visible;-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none}.is-transition[_ngcontent-%COMP%]{transition:transform 133ms linear,opacity .5s ease-out}.upright-transform[_ngcontent-%COMP%]{position:absolute;bottom:0;left:0;right:0}.peer-cursor[_ngcontent-%COMP%]{height:45px;width:45px;position:absolute;left:0;top:0;box-sizing:border-box;border:solid 1px rgba(240,218,189);border-radius:50% 50% 5%;opacity:.7;transform-origin:100% 100%;-webkit-backface-visibility:hidden;backface-visibility:hidden}.is-front[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotate(45deg)}.is-back[_ngcontent-%COMP%]{transform:translate(-100%) translateY(-100%) rotateX(-90deg) rotateY(180deg) rotate(45deg)}.icon[_ngcontent-%COMP%]{overflow:visible;height:100%;width:100%;border-radius:100%;background-position:top,center;background-repeat:no-repeat;background-size:cover;background-color:#f0dabd;transform:rotate(-45deg) scale(.85)}.name[_ngcontent-%COMP%]{box-sizing:border-box;font-size:7px;padding:2px 5px;border-radius:14px;color:#ccc;background-color:#1e1e1ecc;transform-origin:center}.is-center[_ngcontent-%COMP%]{position:absolute;left:50%;top:-26px;transform:translate(-50%)}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}"]});const ote=["root"],ate=["gameTable"],lte=["gameObjects"],cte=["gridCanvas"];function ute(t,n){if(1&t&&nt(0,"terrain",18),2&t){const e=n.$implicit;Je("z-index",e.height>0?0:1),re("terrain",e)}}function dte(t,n){1&t&&nt(0,"game-table-mask",19),2&t&&re("gameTableMask",n.$implicit)}const fte=function(t){return{"z-index":t}};function hte(t,n){if(1&t&&nt(0,"text-note",20),2&t){const e=n.$implicit;re("textNote",e)("appTooltip",e)("ngStyle",ct(3,fte,e.zindex))}}const uS=function(t,n){return{"z-index":t,transform:n}};function pte(t,n){if(1&t&&nt(0,"card-stack",21),2&t){const e=n.$implicit;re("cardStack",e)("appTooltip",e)("ngStyle",cn(3,uS,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function gte(t,n){if(1&t&&nt(0,"card",22),2&t){const e=n.$implicit;re("card",e)("appTooltip",e)("ngStyle",cn(3,uS,e.zindex,"translateZ("+.001*e.zindex+"px)"))}}function mte(t,n){if(1&t&&nt(0,"dice-symbol",23),2&t){const e=n.$implicit;re("diceSymbol",e)("appTooltip",e)}}function _te(t,n){if(1&t&&(Ge(0),nt(1,"game-character",25),qe()),2&t){const e=ge().$implicit;W(1),Je("display",e.isLoaded?"":"none"),re("gameCharacter",e)("appTooltip",e)}}function $te(t,n){if(1&t&&(Ge(0),xe(1,_te,2,4,"ng-container",24),qe()),2&t){const e=n.$implicit,i=ge();W(1),re("ngIf",e&&(e.isVisible||i.isGMMode))}}function vte(t,n){if(1&t&&nt(0,"peer-cursor",26),2&t){const e=n.$implicit,i=ge();Je("display",i.isCursorHidIn(e)&&!i.isGMMode?"none":""),re("cursor",e)}}const bte=function(t,n,e){return[t,n,e]},yte=function(t){return{"is-grabbing":t}},Cte=function(t){return{transform:t}};let xte=(()=>{class t{constructor(e,i,r,s,o,d,$,I){this.ngZone=e,this.contextMenuService=i,this.pointerDeviceService=r,this.coordinateService=s,this.imageService=o,this.tabletopService=d,this.tabletopActionService=$,this.modalService=I,this.isTableTransformMode=!1,this.isTableTransformed=!1,this.viewPotisonX=100,this.viewPotisonY=0,this.viewPotisonZ=0,this.viewRotateX=50,this.viewRotateY=0,this.viewRotateZ=10,this.mouseGesture=null,this.touchGesture=null}get tableSelecter(){return this.tabletopService.tableSelecter}get currentTable(){return this.tabletopService.currentTable}get gridHeight(){return this.tabletopService.currentTable.gridHeight}get tableImage(){return this.imageService.getSkeletonOr(this.currentTable.imageIdentifier)}get backgroundImage(){return this.imageService.getEmptyOr(this.currentTable.backgroundImageIdentifier)}get backgroundFilterType(){return this.currentTable.backgroundFilterType}get isPointerDragging(){return this.pointerDeviceService.isDragging}get characters(){return this.tabletopService.characters}get tableMasks(){return this.tabletopService.tableMasks}get cards(){return this.tabletopService.cards}get cardStacks(){return this.tabletopService.cardStacks}get terrains(){return this.tabletopService.terrains}get textNotes(){return this.tabletopService.textNotes}get diceSymbols(){return this.tabletopService.diceSymbols}get peerCursors(){return this.tabletopService.peerCursors}get isStealthMode(){return jt.isStealthMode}get isGMMode(){return He.myCursor&&He.myCursor.isGMMode}ngOnInit(){Fe.register(this).on("UPDATE_GAME_OBJECT",e=>{e.data.identifier!==this.currentTable.identifier&&e.data.identifier!==this.tableSelecter.identifier||(console.log("UPDATE_GAME_OBJECT GameTableComponent "+this.currentTable.identifier),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor,this.currentTable.isShowNumber))}).on("DRAG_LOCKED_OBJECT",e=>{this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}).on("RESET_POINT_OF_VIEW",e=>{this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!1,this.setTransform(this.viewPotisonX,this.viewPotisonY,this.viewPotisonZ,this._rightRotate(this.viewRotateX),this._rightRotate(this.viewRotateY,!0),this._rightRotate(this.viewRotateZ),!0),setTimeout(()=>{this.gridCanvas.nativeElement.style.opacity="0.0",this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100),e&&"top"==e.data?this.setTransform(0,0,0,0,0,0,!0):this.setTransform(100,0,0,50,0,10,!0)},50),this.removeFocus()}).on("FOCUS_TABLETOP_OBJECT",e=>{setTimeout(()=>{console.log(`move table to focus (${e.data.x}, ${e.data.y})`),this.gameTable.nativeElement.style.transition="0.1s ease-out",setTimeout(()=>{this.gameTable.nativeElement.style.transition=null},100);let s=e.data.x-this.gridCanvas.nativeElement.clientWidth/2,o=e.data.y-this.gridCanvas.nativeElement.clientHeight/2,d=e.data.z,$=this.viewRotateZ/180*Math.PI,I=s*Math.cos($)-o*Math.sin($),Q=s*Math.sin($)+o*Math.cos($),fe=this.viewRotateX/180*Math.PI,_e=Q*Math.cos(fe),Ce=Q*Math.sin(fe)+d;this.setTransform(100-I-this.viewPotisonX,-_e-this.viewPotisonY,-Ce-this.viewPotisonZ,0,0,0)},50)}),this.tabletopActionService.makeDefaultTable(),this.tabletopActionService.makeDefaultTabletopObjects()}_rightRotate(e,i=!1){let r=e%360;return i||(r>180?r-=360:r<-180&&(r+=360)),r}ngAfterViewInit(){this.ngZone.runOutsideAngular(()=>{this.initializeTableTouchGesture(),this.initializeTableMouseGesture()}),this.cancelInput(),this.setGameTableGrid(this.currentTable.width,this.currentTable.height,this.currentTable.gridSize,this.currentTable.gridType,this.currentTable.gridColor),this.setTransform(0,0,0,0,0,0),this.coordinateService.tabletopOriginElement=this.gameObjects.nativeElement}ngOnDestroy(){Fe.unregister(this),this.mouseGesture.destroy(),this.touchGesture.destroy()}initializeTableTouchGesture(){this.touchGesture=new OX(this.rootElementRef.nativeElement,this.ngZone),this.touchGesture.onstart=this.onTableTouchStart.bind(this),this.touchGesture.onend=this.onTableTouchEnd.bind(this),this.touchGesture.ongesture=this.onTableTouchGesture.bind(this),this.touchGesture.ontransform=this.onTableTouchTransform.bind(this)}initializeTableMouseGesture(){this.mouseGesture=new RX(this.rootElementRef.nativeElement),this.mouseGesture.onstart=this.onTableMouseStart.bind(this),this.mouseGesture.onend=this.onTableMouseEnd.bind(this),this.mouseGesture.ontransform=this.onTableMouseTransform.bind(this)}onTableTouchStart(){this.mouseGesture.cancel()}onTableTouchEnd(){this.cancelInput()}onTableTouchGesture(){this.cancelInput()}onTableTouchTransform(e,i,r,s,o,d,$,I){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),I.cancelable&&I.preventDefault();let Q=(1e3+Math.abs(this.viewPotisonZ))/1e3;80<s+this.viewRotateX&&(s+=80-(s+this.viewRotateX)),s+this.viewRotateX<0&&(s+=0-(s+this.viewRotateX)),750<r+this.viewPotisonZ&&(r+=750-(r+this.viewPotisonZ)),this.setTransform(e*=Q,i*=Q,r,s,o,d),this.isTableTransformed=!0}onTableMouseStart(e){e.target.contains(this.gameObjects.nativeElement)||1===e.button||2===e.button?this.isTableTransformMode=!0:(this.isTableTransformMode=!1,this.pointerDeviceService.isDragging=!0,this.gridCanvas.nativeElement.style.opacity="1"),document.activeElement.contains(e.target)||(this.removeSelectionRanges(),this.removeFocus())}onTableMouseEnd(e){this.cancelInput()}onTableMouseTransform(e,i,r,s,o,d,$,I){if(!this.isTableTransformMode||document.body!==document.activeElement)return;!this.pointerDeviceService.isAllowedToOpenContextMenu&&this.contextMenuService.isShow&&this.ngZone.run(()=>this.contextMenuService.close()),I.cancelable&&I.preventDefault();let Q=(1e3+Math.abs(this.viewPotisonZ))/1e3;this.setTransform(e*=Q,i*=Q,r,s,o,d),this.isTableTransformed=!0}cancelInput(){this.mouseGesture.cancel(),this.isTableTransformMode=!0,this.pointerDeviceService.isDragging=!1,this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}onContextMenu(e){if(!document.activeElement.contains(this.gameObjects.nativeElement)||(e.preventDefault(),!this.pointerDeviceService.isAllowedToOpenContextMenu))return;let i=this.pointerDeviceService.pointers[0],r=this.coordinateService.calcTabletopLocalCoordinate(),s=[];Array.prototype.push.apply(s,this.tabletopActionService.makeDefaultContextMenuActions(r)),s.push(At),s.push({name:"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a",action:()=>{this.modalService.open(zI)}}),this.contextMenuService.open(i,s,this.currentTable.name)}onDocumentMouseDown(e){this.isTableTransformed=!1}onDocumentTouchStart(e){this.isTableTransformed=!1}onDocumentContextMenu(e){this.isTableTransformed&&!this.pointerDeviceService.isAllowedToOpenContextMenu&&e.preventDefault()}setTransform(e,i,r,s,o,d,$=!1){$?(this.viewRotateX=s,this.viewRotateY=o,this.viewRotateZ=d,this.viewPotisonX=e,this.viewPotisonY=i,this.viewPotisonZ=r):(this.viewRotateX+=s,this.viewRotateY+=o,this.viewRotateZ+=d,this.viewPotisonX+=e,this.viewPotisonY+=i,this.viewPotisonZ+=r),($||0!=s||0!=o||0!=s)&&this.ngZone.run(()=>{Fe.trigger("TABLE_VIEW_ROTATE",{x:this.viewRotateX,y:this.viewRotateY,z:this.viewRotateZ})}),this.gameTable.nativeElement.style.transform=`translateZ(${this.viewPotisonZ.toFixed(4)}px) translateY(${this.viewPotisonY.toFixed(4)}px) translateX(${this.viewPotisonX.toFixed(4)}px) rotateY(${this.viewRotateY.toFixed(4)}deg) rotateX(${this.viewRotateX.toFixed(4)+"deg) rotateZ("+this.viewRotateZ.toFixed(4)}deg)`}setGameTableGrid(e,i,r=50,s=aa.SQUARE,o="#000000e6",d=!0){this.gameTable.nativeElement.style.width=e*r+"px",this.gameTable.nativeElement.style.height=i*r+"px",new FX(this.gridCanvas.nativeElement).render(e,i,r,s,o,d),this.gridCanvas.nativeElement.style.opacity=(this.tableSelecter.gridShow?1:0)+""}removeSelectionRanges(){let e=window.getSelection();e.isCollapsed||e.removeAllRanges()}removeFocus(){document.activeElement instanceof HTMLElement&&document.activeElement.blur()}trackByGameObject(e,i){return i.identifier}isCursorHidIn(e){if(e.isGMMode)return!0;for(let i of this.characters)if(i.isHideIn&&"table"===i.location.name&&i.owner===e.userId)return!0;return!1}}return t.\u0275fac=function(e){return new(e||t)(Oe(bn),Oe(lr),Oe(li),Oe(Ul),Oe(vu),Oe(af),Oe(g1),Oe(kn))},t.\u0275cmp=qt({type:t,selectors:[["game-table"]],viewQuery:function(e,i){if(1&e&&(dn(ote,7),dn(ate,7),dn(lte,7),dn(cte,7)),2&e){let r;un(r=fn())&&(i.rootElementRef=r.first),un(r=fn())&&(i.gameTable=r.first),un(r=fn())&&(i.gameObjects=r.first),un(r=fn())&&(i.gridCanvas=r.first)}},hostBindings:function(e,i){1&e&&Ie("contextmenu",function(s){return i.onContextMenu(s)})("mousedown",function(s){return i.onDocumentMouseDown(s)},!1,Zf)("touchstart",function(s){return i.onDocumentTouchStart(s)},!1,Zf)("contextmenu",function(s){return i.onDocumentContextMenu(s)},!1,Zf)},decls:20,vars:37,consts:[[1,"background-image","is-pointer-events-none",3,"ngClass"],[1,"component","is-fill","is-perspective",3,"ngClass"],["root",""],[1,"component-content","is-fill","is-3d"],["gameTable",""],["id","app-game-table",1,"game-table","table-image","is-3d"],["gameObjects",""],[1,"grid-canvas","is-fill","is-pointer-events-none",3,"ngStyle"],["gridCanvas",""],[1,"is-fill","is-3d","is-pointer-events-none"],["class","is-3d",3,"z-index","terrain",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"gameTableMask",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"textNote","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cardStack","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"card","appTooltip","ngStyle",4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"diceSymbol","appTooltip",4,"ngFor","ngForOf","ngForTrackBy"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","is-3d",3,"cursor","display",4,"ngFor","ngForOf","ngForTrackBy"],[1,"is-3d",3,"terrain"],[1,"is-3d",3,"gameTableMask"],[1,"is-3d",3,"textNote","appTooltip","ngStyle"],[1,"is-3d",3,"cardStack","appTooltip","ngStyle"],[1,"is-3d",3,"card","appTooltip","ngStyle"],[1,"is-3d",3,"diceSymbol","appTooltip"],[4,"ngIf"],[1,"is-3d",3,"gameCharacter","appTooltip"],[1,"is-3d",3,"cursor"]],template:function(e,i){1&e&&(X(0,"div",0),bt(1,"safe"),te(),X(2,"div",1,2)(4,"div",3,4)(6,"div",5,6),bt(8,"safe"),nt(9,"canvas",7,8),X(11,"div",9),xe(12,ute,1,3,"terrain",10),te(),xe(13,dte,1,1,"game-table-mask",11),xe(14,hte,1,5,"text-note",12),xe(15,pte,1,6,"card-stack",13),xe(16,gte,1,6,"card",14),xe(17,mte,1,2,"dice-symbol",15),xe(18,$te,2,1,"ng-container",16),xe(19,vte,1,3,"peer-cursor",17),te()()()),2&e&&(Je("background-image",yt(1,23,"url("+i.backgroundImage.url+")","style")),re("ngClass",qr(29,bte,i.backgroundFilterType?"is-filter":"",i.isStealthMode&&!i.isGMMode?"is-hide-in":"",i.backgroundFilterType)),W(2),re("ngClass",ct(33,yte,i.isPointerDragging)),W(4),Je("background-image",yt(8,26,"url("+i.tableImage.url+")","style")),W(3),re("ngStyle",ct(35,Cte,"translateZ("+(i.gridHeight+.1)+"px)")),W(3),re("ngForOf",i.terrains)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.tableMasks)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.textNotes)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.cardStacks)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.cards)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.diceSymbols)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.characters)("ngForTrackBy",i.trackByGameObject),W(1),re("ngForOf",i.peerCursors)("ngForTrackBy",i.trackByGameObject))},directives:[jn,Ji,Jn,tQ,uQ,CQ,sS,aee,gee,Pee,gn,Jee,wr],pipes:[Yn],styles:['[_nghost-%COMP%]{display:block}.is-grabbing[_ngcontent-%COMP%]{cursor:-webkit-grabbing;cursor:grabbing}.is-perspective[_ngcontent-%COMP%]{perspective:1000px}.is-fill[_ngcontent-%COMP%]{display:block;position:absolute;top:0;left:0;bottom:0;right:0;margin:auto}.is-3d[_ngcontent-%COMP%]{transform-style:preserve-3d;-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute}.is-pointer-events-none[_ngcontent-%COMP%]{pointer-events:none}.component[_ngcontent-%COMP%]{-moz-user-select:none;-webkit-user-select:none;user-select:none;-moz-user-drag:none;-webkit-user-drag:none;touch-action:manipulation;height:100%;width:100%;overflow:hidden}.component-content[_ngcontent-%COMP%]{height:2000px;width:2000px}.grid-canvas[_ngcontent-%COMP%]{opacity:0;transform:translateZ(.15px);transition:.1s ease-out;-webkit-backface-visibility:hidden;backface-visibility:hidden}.game-table[_ngcontent-%COMP%]{height:100%;width:100%}.table-image[_ngcontent-%COMP%]{-webkit-backface-visibility:hidden;backface-visibility:hidden;position:absolute;height:100%;width:100%;background-repeat:no-repeat;background-size:100% 100%}.background-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;bottom:0;right:0;margin:-5px;background-repeat:no-repeat;background-position:center;background-size:cover;transition:filter .2s ease-in-out}.background-image.is-filter[_ngcontent-%COMP%]{will-change:filter}.background-image.is-filter.white[_ngcontent-%COMP%], .background-image.is-filter.black[_ngcontent-%COMP%]{filter:blur(5px)}.background-image.is-filter[_ngcontent-%COMP%]:after{display:block;content:"";width:100%;height:100%}.background-image.is-filter.white[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.black[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.white[_ngcontent-%COMP%]:after{background-color:#1a1a1a;filter:opacity(.3)}.background-image.is-filter.is-hide-in.black[_ngcontent-%COMP%]:after{background-color:#f7f7f7;filter:opacity(.2)}.background-image.is-filter.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%) blur(5px);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%)}.background-image.is-hide-in[_ngcontent-%COMP%]{filter:invert(85%);-webkit-backdrop-filter:invert(85%);backdrop-filter:invert(85%);background-color:#ffcc80}']}),t})(),wte=(()=>{class t{constructor(e){this.elementRef=e,this.timer=null,this.needRepeat=!1}ngAfterViewInit(){let e=()=>{this.needRepeat?(this.timer=setTimeout(e,650),this.needRepeat=!1):(this.timer=null,this.elementRef.nativeElement.style.display="none")};Fe.register(this).on("*",i=>{this.needRepeat||vt.bandwidthUsage<3072||(null===this.timer?(this.elementRef.nativeElement.style.display="block",this.timer=setTimeout(e,650)):this.needRepeat=!0)})}ngOnDestroy(){Fe.unregister(this)}}return t.\u0275fac=function(e){return new(e||t)(Oe(pi))},t.\u0275cmp=qt({type:t,selectors:[["network-indicator"]],decls:12,vars:0,consts:[[1,"sk-cube-grid"],[1,"sk-cube","sk-cube1"],[1,"sk-cube","sk-cube2"],[1,"sk-cube","sk-cube3"],[1,"sk-cube","sk-cube4"],[1,"sk-cube","sk-cube5"],[1,"sk-cube","sk-cube6"],[1,"sk-cube","sk-cube7"],[1,"sk-cube","sk-cube8"],[1,"sk-cube","sk-cube9"],[1,"sk-title"]],template:function(e,i){1&e&&(X(0,"div",0),nt(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6)(7,"div",7)(8,"div",8)(9,"div",9),X(10,"div",10),be(11,"sync"),te()())},styles:["[_nghost-%COMP%]{display:block}.sk-cube-grid[_ngcontent-%COMP%]{font-size:8px;color:#444;height:100%;width:100%;background-color:#f7f7f799}.sk-cube[_ngcontent-%COMP%]{background-color:#555}.sk-title[_ngcontent-%COMP%]{padding:2px 0;background-color:#f7f7f799}"]}),t})();const Ete=["modalLayer"];function Tte(t,n){if(1&t){const e=Ye();X(0,"li",3),Ie("click",function(){return ke(e),ge().save()}),X(1,"a",4)(2,"div")(3,"i",6),be(4,"sd_storage"),te()(),X(5,"div"),be(6,"\u4fdd\u5b58"),te()()()}}function Ite(t,n){if(1&t&&(X(0,"li",14)(1,"a")(2,"div")(3,"i",15),be(4,"sd_storage"),te()(),X(5,"div"),be(6),te()()()),2&t){const e=ge();W(6),An("",e.progresPercent,"%")}}const Ste=function(t){return{horizontal:t}};let kte=(()=>{class t{constructor(e,i,r,s,o,d,$,I,Q,fe,_e){var Ce=this;this.swUpdate=e,this.modalService=i,this.panelService=r,this.pointerDeviceService=s,this.chatMessageService=o,this.appConfigService=d,this.saveDataService=$,this.ngZone=I,this.contextMenuService=Q,this.standImageService=fe,this.cutInService=_e,this.immediateUpdateTimer=null,this.lazyUpdateTimer=null,this.openPanelCount=0,this.isSaveing=!1,this.progresPercent=0,this.isHorizontal=!1,this.isLoggedin=!1,this.isUpdateCanceled=!1,this.ngZone.runOutsideAngular(()=>{Ao.instance.initialize(),mu.instance.initialize(),gu.instance.initialize(),_u.instance.initialize()}),this.appConfigService.initialize(),this.pointerDeviceService.initialize(),ir.instance.initialize(),ao.instance.initialize(),Fo.instance.initialize(),new Pn("DiceBot",this.chatMessageService).initialize(),Pn.getHelpMessage("").then(()=>this.lazyNgZoneUpdate(!0)),new Gl("Jukebox").initialize(),new ut("SoundEffect").initialize(),ao.instance.addChatTab("\u30e1\u30a4\u30f3\u30bf\u30d6","MainTab"),ao.instance.addChatTab("\u30b5\u30d6\u30bf\u30d6","SubTab").recieveOperationLogLevel=1,oo.instance.initialize();let Ae=new sa("SampleDiceRollTable");Ae.initialize(),Ae.name="\u30b5\u30f3\u30d7\u30eb\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868",Ae.command="SAMPLE",Ae.dice="1d6",Ae.value="1:\u3053\u308c\u306f\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u306e\u30b5\u30f3\u30d7\u30eb\u3067\u3059\n2:\u6570\u5b57\u3068\u5bfe\u5fdc\u3059\u308b\u7d50\u679c\u30921\u884c\u306b1\u3064\u3065\u3064:\uff08\u30b3\u30ed\u30f3\uff09\u3067\u533a\u5207\u308a\n3:\u6570\u5b57:\u7d50\u679c\u306e\u3088\u3046\u306b\u8a18\u8ff0\u3057\u307e\u3059\n4:\\\\n  \\n\u3067\u6539\u884c\u3057\u307e\u3059\n5-6:\u307e\u305f\u3001-\uff08\u30cf\u30a4\u30d5\u30f3\uff09\u3067\u533a\u5207\u3063\u3066\u6570\u5b57\u306e\u7bc4\u56f2\u3092\u6307\u5b9a\u53ef\u80fd\u3067\u3059",ro.instance.addDiceRollTable(Ae);let je=Lt.createEmpty("none_icon").toContext();je.url="./assets/images/ic_account_circle_black_24dp_2x.png";let Ue=It.instance.add(je);mn.create(Ue.identifier).tag="*default \u30a2\u30a4\u30b3\u30f3",je=Lt.createEmpty("stand_no_image").toContext(),je.url="./assets/images/nc96424.png";let at=It.instance.add(je);mn.create(at.identifier).tag="*default \u30b9\u30bf\u30f3\u30c9",kt.resumeAudioContext(),Xe.dicePick=Ft.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Xe.dicePut=Ft.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Xe.diceRoll1=Ft.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu01.mp3").identifier,Xe.diceRoll2=Ft.instance.add("./assets/sounds/on-jin/spo_ge_saikoro_teburu02.mp3").identifier,Xe.cardDraw=Ft.instance.add("./assets/sounds/soundeffect-lab/card-turn-over1.mp3").identifier,Xe.cardPick=Ft.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Xe.cardPut=Ft.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Xe.cardShuffle=Ft.instance.add("./assets/sounds/soundeffect-lab/card-open1.mp3").identifier,Xe.piecePick=Ft.instance.add("./assets/sounds/soundeffect-lab/shoulder-touch1.mp3").identifier,Xe.piecePut=Ft.instance.add("./assets/sounds/soundeffect-lab/book-stack1.mp3").identifier,Xe.blockPick=Ft.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Xe.blockPut=Ft.instance.add("./assets/sounds/tm2/tm2_pon002.wav").identifier,Xe.lock=Ft.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Xe.unlock=Ft.instance.add("./assets/sounds/tm2/tm2_switch001.wav").identifier,Xe.sweep=Ft.instance.add("./assets/sounds/tm2/tm2_swing003.wav").identifier,Xe.puyon=Ft.instance.add("./assets/sounds/soundeffect-lab/puyon1.mp3").identifier,Xe.surprise=Ft.instance.add("./assets/sounds/otologic/Onmtp-Surprise02-1.mp3").identifier,Xe.coinToss=Ft.instance.add("./assets/sounds/niconicomons/nc146227.mp3").identifier,Ft.instance.get(Xe.dicePick).isHidden=!0,Ft.instance.get(Xe.dicePut).isHidden=!0,Ft.instance.get(Xe.diceRoll1).isHidden=!0,Ft.instance.get(Xe.diceRoll2).isHidden=!0,Ft.instance.get(Xe.cardDraw).isHidden=!0,Ft.instance.get(Xe.cardPick).isHidden=!0,Ft.instance.get(Xe.cardPut).isHidden=!0,Ft.instance.get(Xe.cardShuffle).isHidden=!0,Ft.instance.get(Xe.piecePick).isHidden=!0,Ft.instance.get(Xe.piecePut).isHidden=!0,Ft.instance.get(Xe.blockPick).isHidden=!0,Ft.instance.get(Xe.blockPut).isHidden=!0,Ft.instance.get(Xe.lock).isHidden=!0,Ft.instance.get(Xe.unlock).isHidden=!0,Ft.instance.get(Xe.sweep).isHidden=!0,Ft.instance.get(Xe.puyon).isHidden=!0,Ft.instance.get(Xe.surprise).isHidden=!0,Ft.instance.get(Xe.coinToss).isHidden=!0,He.createMyCursor(),He.myCursor.name||(He.myCursor.name="\u30d7\u30ec\u30a4\u30e4\u30fc"),He.myCursor.imageIdentifier=Ue.identifier,Fe.register(this).on("UPDATE_GAME_OBJECT",lt=>{this.lazyNgZoneUpdate(lt.isSendFromSelf)}).on("DELETE_GAME_OBJECT",lt=>{this.lazyNgZoneUpdate(lt.isSendFromSelf)}).on("SYNCHRONIZE_AUDIO_LIST",lt=>{lt.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("SYNCHRONIZE_FILE_LIST",lt=>{lt.isSendFromSelf&&this.lazyNgZoneUpdate(!1)}).on("LOAD_CONFIG",lt=>{if(console.log("LOAD_CONFIG !!!",lt.data),lt.data.dice&&lt.data.dice.url){const tt=lt.data.dice.api;fetch(lt.data.dice.url+(1==tt?"/v1/names":"/v2/game_system"),{mode:"cors"}).then(Ct=>Ct.json()).then(Ct=>{let ot=lt.data.dice.url;Pn.apiUrl=ot.endsWith("/")?ot.substring(0,ot.length-1):ot,Pn.apiVersion=tt,Pn.diceBotInfos=[];let ht=(1==tt?Ct.names:Ct.game_system).filter(pt=>"DiceBot"!=(1==tt?pt.system:pt.id)).map(pt=>{let _n=pt.sort_key&&pt.sort_key.indexOf("\u56fd\u969b\u5316")<0?pt.sort_key:pt.name.normalize("NFKD");for(let an of Pn.replaceData)an[2]&&pt.name===an[0]&&(_n=an[1],pt.name=an[2]),_n=_n.split(an[0].normalize("NFKD")).join(an[1].normalize("NFKD"));return pt.normalize=_n.replace(/[\u3041-\u3096]/g,an=>String.fromCharCode(an.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),pt}).map(pt=>{const _n=/.+\:(.+)/.exec(1==tt?pt.system:pt.id);return pt.lang=_n?_n[1]:"A",pt}).sort((pt,_n)=>pt.lang<_n.lang?-1:pt.lang>_n.lang?1:pt.normalize==_n.normalize?0:pt.normalize<_n.normalize?-1:1);if(Pn.diceBotInfos.push(...ht.map(pt=>({script:1==tt?pt.system:pt.id,game:pt.name}))),ht.length>0){let pt=ht[0].normalize.substring(0,1),_n={index:ht[0].normalize.substring(0,1),infos:[]};for(let an of ht){let di="Other"==an.lang?"\u305d\u306e\u4ed6":"ChineseTraditional"==an.lang?"\u6b63\u9ad4\u4e2d\u6587":"Korean"==an.lang?"\ud55c\uad6d\uc5b4":"English"==an.lang?"English":"SimplifiedChinese"==an.lang?"\u7b80\u4f53\u4e2d\u6587":an.normalize.substring(0,1);di!==pt&&(pt=di,Pn.diceBotInfosIndexed.push(_n),_n={index:di,infos:[]}),_n.infos.push({script:1==tt?an.system:an.id,game:an.name})}Pn.diceBotInfosIndexed.push(_n),Pn.diceBotInfosIndexed.sort((an,di)=>an.index==di.index?0:an.index<di.index?-1:1)}})}else{Pn.diceBotInfos.forEach(ot=>{let ht=ot.sort_key.normalize("NFKD");for(let pt of Pn.replaceData)pt[2]&&ot.game===pt[0]&&(ht=pt[1],ot.game=pt[2]),ht=ht.split(pt[0].normalize("NFKD")).join(pt[1].normalize("NFKD"));ht=ht.replace(/[\u3041-\u3096]/g,pt=>String.fromCharCode(pt.charCodeAt(0)+96)).replace(/\u7b2c(.+?)\u7248/g,"\u30bf\u30a4$1\u30cf\u30f3").replace(/[\u30fb!?\uff01\uff1f\s\u3000:\uff1a=\uff1d\/\uff0f\uff08\uff09\(\)]+/g,"").replace(/([\u30a2\u30ab\u30b5\u30bf\u30ca\u30cf\u30de\u30e4\u30e9\u30ef])\u30fc+/g,"$1\u30a2").replace(/([\u30a4\u30ad\u30b7\u30c1\u30cb\u30d2\u30df\u30ea])\u30fc+/g,"$1\u30a4").replace(/([\u30a6\u30af\u30b9\u30c4\u30cc\u30d5\u30e0\u30e6\u30eb])\u30fc+/g,"$1\u30a6").replace(/([\u30a8\u30b1\u30bb\u30c6\u30cd\u30d8\u30e1\u30ec])\u30fc+/g,"$1\u30a8").replace(/([\u30aa\u30b3\u30bd\u30c8\u30ce\u30db\u30e2\u30e8\u30ed])\u30fc+/g,"$1\u30aa").replace(/\u30f3+\u30fc+/g,"\u30f3").replace(/\u30f3+/g,"\u30f3"),ot.sort_key=ot.lang?ot.lang:ht.normalize("NFKD")}),Pn.diceBotInfos.sort((ot,ht)=>"Other"==ot.sort_key&&"Other"==ht.sort_key?0:"Other"==ot.sort_key?1:"Other"==ht.sort_key?-1:ot.sort_key==ht.sort_key?0:ot.sort_key<ht.sort_key?-1:1);let tt=Pn.diceBotInfos[0].sort_key[0],Ct={index:tt,infos:[]};for(let ot of Pn.diceBotInfos)"Other"==ot.lang&&(ot.lang="\u7b80\u4f53\u4e2d\u6587"),(ot.lang?ot.lang:ot.sort_key[0])!==tt&&(tt=ot.lang?ot.lang:ot.sort_key[0],Pn.diceBotInfosIndexed.push(Ct),Ct={index:tt,infos:[]}),Ct.infos.push({script:ot.id,game:ot.game});Pn.diceBotInfosIndexed.push(Ct)}Pn.diceBotInfosIndexed.sort((tt,Ct)=>tt.index==Ct.index?0:tt.index<Ct.index?-1:1),vt.setApiKey(lt.data.webrtc.key),vt.open()}).on("FILE_LOADED",lt=>{this.lazyNgZoneUpdate(!1)}).on("OPEN_NETWORK",lt=>{console.log("OPEN_NETWORK",lt.data.peerId),He.myCursor.peerId=vt.peerContext.peerId,He.myCursor.userId=vt.peerContext.userId,this.isLoggedin=!1}).on("NETWORK_ERROR",lt=>{console.log("NETWORK_ERROR",lt.data.peerId);let tt=lt.data.errorType,Ct=lt.data.errorMessage;this.ngZone.run((0,Yt.Z)(function*(){["peer-unavailable"].includes(tt)||(yield Ce.modalService.open(au,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:Ct}),["disconnected","socket-error","unavailable-id","authentication","server-error"].includes(tt)&&(yield Ce.modalService.open(au,{title:"\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u30a8\u30e9\u30fc",text:"\u3053\u306e\u30a6\u30a3\u30f3\u30c9\u30a6\u3092\u9589\u3058\u308b\u3068\u518d\u63a5\u7d9a\u3092\u8a66\u307f\u307e\u3059\u3002"}),vt.open(),Ce.isLoggedin=!1))}))}).on("CONNECT_PEER",lt=>{lt.isSendFromSelf&&(this.chatMessageService.calibrateTimeOffset(),this.isLoggedin||(this.isLoggedin=!0,o.sendOperationLog((vt.peerContext.isRoom?vt.peerContext.roomName+" \u306b":"\u4ed6\u8005\u3068")+"\u63a5\u7d9a\u3057\u305f"))),this.lazyNgZoneUpdate(lt.isSendFromSelf)}).on("DISCONNECT_PEER",lt=>{this.lazyNgZoneUpdate(lt.isSendFromSelf),lt.isSendFromSelf&&(this.isLoggedin=!1)}).on("PLAY_CUT_IN",-1e3,lt=>{let tt=rt.instance.get(lt.data.identifier);this.cutInService.play(tt,!!lt.data.secret&&lt.data.secret,!!lt.data.test&&lt.data.test,lt.data.sender)}).on("STOP_CUT_IN",-1e3,lt=>{this.cutInService.stop(lt.data.identifier)}).on("POPUP_STAND_IMAGE",-1e3,lt=>{let tt=rt.instance.get(lt.data.standIdentifier),Ct=rt.instance.get(lt.data.characterIdentifier);this.standImageService.show(Ct,tt,lt.data.color?lt.data.color:null,lt.data.secret)}).on("FAREWELL_STAND_IMAGE",-1e3,lt=>{this.standImageService.farewell(lt.data.characterIdentifier)}).on("DELETE_STAND_IMAGE",-1e3,lt=>{this.standImageService.destroy(lt.data.characterIdentifier,lt.data.identifier)}).on("DESTORY_STAND_IMAGE_ALL",-1e3,lt=>{this.standImageService.destroyAll()})}get otherPeers(){return rt.instance.getObjects(He)}ngOnInit(){window.addEventListener("beforeunload",t.beforeUnloadProc)}ngAfterViewInit(){Tn.defaultParentViewContainerRef=kn.defaultParentViewContainerRef=lr.defaultParentViewContainerRef=Zi.defaultParentViewContainerRef=zp.defaultParentViewContainerRef=this.modalLayerViewContainerRef,queueMicrotask(()=>{this.panelService.open(u1,{width:520,height:450,left:100}),this.panelService.open(OI,{width:700,height:400,left:100,top:450})}),this.swUpdate.versionUpdates.subscribe(e=>{switch(e.type){case"VERSION_DETECTED":console.log(`Downloading new app version: ${e.version.hash}`);break;case"VERSION_READY":console.log(`Current app version: ${e.currentVersion.hash}`),console.log(`New app version ready for use: ${e.latestVersion.hash}`),this.isUpdateCanceled||this.modalService.open(qi,{title:"Udonarium with Fly \u306e\u66f4\u65b0",text:"Udonarium with Fly \u306e\u65b0\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u304c\u516c\u958b\u3055\u308c\u3066\u3044\u307e\u3059\u3002\u66f4\u65b0\u3092\u884c\u3044\u307e\u3059\u304b\uff1f",help:"\u66f4\u65b0\u306e\u969b\u306b\u30da\u30fc\u30b8\u3092\u518d\u8aad\u307f\u8fbc\u307f\u3057\u307e\u3059\u3002\u624b\u52d5\u3067\u518d\u8aad\u307f\u8fbc\u307f\u3092\u884c\u3046\u3053\u3068\u3067\u3082\u66f4\u65b0\u53ef\u80fd\u3067\u3059\u3002",type:_i.OK_CANCEL,materialIcon:"browser_updated",action:()=>{this.swUpdate.activateUpdate().then(()=>{window.removeEventListener("beforeunload",t.beforeUnloadProc),document.location.reload()})},cancelAction:()=>{this.isUpdateCanceled=!0}});break;case"VERSION_INSTALLATION_FAILED":console.log(`Failed to install app version '${e.version.hash}': ${e.error}`)}})}ngOnDestroy(){Fe.unregister(this)}open(e){let i=null,r={width:450,height:600,left:100};switch(e){case"PeerMenuComponent":r.width=520,i=u1;break;case"ChatWindowComponent":i=OI,r.width=700;break;case"GameTableSettingComponent":i=zI,r={width:610,height:400,left:100};break;case"FileStorageComponent":i=Os,r.width=700;break;case"GameCharacterSheetComponent":i=lo;break;case"JukeboxComponent":i=tZ;break;case"GameCharacterGeneratorComponent":i=FK,r={width:500,height:300,left:100};break;case"GameObjectInventoryComponent":i=kY;break;case"DiceRollTableSettingComponent":i=VZ,r={width:645,height:475};break;case"CutInSettingComponent":i=hX,r={width:700,height:600}}i&&(r.top=20*(this.openPanelCount%10+1),r.left=100+5*(this.openPanelCount%20+1),this.openPanelCount=this.openPanelCount+1,this.panelService.open(i,r))}save(){var e=this;return(0,Yt.Z)(function*(){if(e.isSaveing)return;e.isSaveing=!0,e.progresPercent=0;let i=vt.peerContext&&0<vt.peerContext.roomName.length?vt.peerContext.roomName:"fly_\u30eb\u30fc\u30e0\u30c7\u30fc\u30bf";yield e.saveDataService.saveRoomAsync(i,r=>{e.progresPercent=r}),setTimeout(()=>{e.isSaveing=!1,e.progresPercent=0},500)})()}handleFileSelect(e){let i=e.target,r=i.files;r.length&&Ao.instance.load(r),i.value=""}lazyNgZoneUpdate(e){if(e){if(null!==this.immediateUpdateTimer)return;this.immediateUpdateTimer=setTimeout(()=>{this.immediateUpdateTimer=null,null!=this.lazyUpdateTimer&&(clearTimeout(this.lazyUpdateTimer),this.lazyUpdateTimer=null),this.ngZone.run(()=>{})},0)}else{if(null!==this.lazyUpdateTimer)return;this.lazyUpdateTimer=setTimeout(()=>{this.lazyUpdateTimer=null,null!=this.immediateUpdateTimer&&(clearTimeout(this.immediateUpdateTimer),this.immediateUpdateTimer=null),this.ngZone.run(()=>{})},100)}}toolBox(){const e=[],i=oo.instance.cutIns;e.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u518d\u751f",materialIcon:"play_arrow",action:null,subActions:0===i.length?[{name:"(\u30ab\u30c3\u30c8\u30a4\u30f3\u306a\u3057)",disabled:!0,center:!0}]:i.map(r=>({name:`${r.isValidAudio?"":"\u26a0\ufe0f"}${""==r.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":r.name}`,subActions:[{name:"\u5168\u54e1",action:()=>{Fe.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!1,sender:He.myCursor.peerId}),this.chatMessageService.sendOperationLog((""==r.name?"(\u7121\u540d\u306e\u30ab\u30c3\u30c8\u30a4\u30f3)":r.name)+" \u3092\u518d\u751f\u3057\u305f")}},At,...this.otherPeers.map(s=>({name:s.name+(s===He.myCursor?" (\u3042\u306a\u305f)":""),color:s.color,default:!0,action:()=>{s!==He.myCursor&&Fe.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!0,sender:He.myCursor.peerId},s.peerId),Fe.call("PLAY_CUT_IN",{identifier:r.identifier,secret:!0,sender:He.myCursor.peerId},He.myCursor.peerId)}}))]}))}),e.push(At),e.push({name:"\u30ab\u30c3\u30c8\u30a4\u30f3\u8a2d\u5b9a",materialIcon:"movie_creation",action:()=>this.open("CutInSettingComponent")}),e.push({name:"\u30c0\u30a4\u30b9\u30dc\u30c3\u30c8\u8868\u8a2d\u5b9a",materialIcon:"table_rows",action:()=>this.open("DiceRollTableSettingComponent")}),this.contextMenuService.open(this.pointerDeviceService.pointers[0],e,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9")}resetPointOfView(){this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:"\u521d\u671f\u8996\u70b9\u306b\u623b\u3059",action:()=>Fe.trigger("RESET_POINT_OF_VIEW",null)},{name:"\u771f\u4e0a\u304b\u3089\u8996\u308b",action:()=>Fe.trigger("RESET_POINT_OF_VIEW","top")}],"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8")}standSetteings(){const e=Oo.isShowStand,i=Oo.isShowNameTag,r=Oo.isCanBeGone;this.contextMenuService.open(this.pointerDeviceService.pointers[0],[{name:(ir.instance.gridShow?"\u2611":"\u2610")+"\u30c6\u30fc\u30d6\u30eb\u30b0\u30ea\u30c3\u30c9\u3092\u5e38\u306b\u8868\u793a",action:()=>{ir.instance.gridShow=!ir.instance.gridShow,Fe.trigger("UPDATE_GAME_OBJECT",ir.instance.toContext())}},{name:(ir.instance.gridSnap?"\u2611":"\u2610")+"\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u79fb\u52d5\u6642\u306b\u30b9\u30ca\u30c3\u30d7",action:()=>{ir.instance.gridSnap=!ir.instance.gridSnap}},At,{name:(e?"\u2611":"\u2610")+"\u30b9\u30bf\u30f3\u30c9\u8868\u793a",action:()=>{Oo.isShowStand=!e}},{name:(i?"\u2611":"\u2610")+"\u30cd\u30fc\u30e0\u30bf\u30b0\u8868\u793a",action:()=>{Oo.isShowNameTag=!i},level:1,disabled:!Oo.isShowStand},{name:(r?"\u2611":"\u2610")+"\u900f\u660e\u5316\u3001\u81ea\u52d5\u9000\u53bb",action:()=>{Oo.isCanBeGone=!r},level:1,disabled:!Oo.isShowStand},At,{name:"\u8868\u793a\u30b9\u30bf\u30f3\u30c9\u5168\u6d88\u53bb",action:()=>Fe.trigger("DESTORY_STAND_IMAGE_ALL",null)}],"\u500b\u4eba\u8a2d\u5b9a")}diceAllOpne(){this.modalService.open(qi,{title:"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b",text:"\u30c6\u30fc\u30d6\u30eb\u4e0a\u306e\u30c0\u30a4\u30b9\u3001\u30b3\u30a4\u30f3\u3092\u516c\u958b\u3057\u307e\u3059\u304b\uff1f",help:"\u300c\u4e00\u6589\u516c\u958b\u3057\u306a\u3044\u300d\u8a2d\u5b9a\u306e\u3082\u306e\u306f\u516c\u958b\u3055\u308c\u307e\u305b\u3093\u3002",type:_i.OK_CANCEL,materialIcon:"all_out",action:()=>{Fe.trigger("DICE_ALL_OPEN",null)}})}deleteGameObject(e){throw new Error("Method not implemented.")}rotateChange(e){this.isHorizontal=e}}return t.beforeUnloadProc=n=>{n.preventDefault(),n.returnValue=""},t.\u0275fac=function(e){return new(e||t)(Oe(KI),Oe(kn),Oe(Tn),Oe(li),Oe(yr),Oe(c1),Oe(Cr),Oe(bn),Oe(lr),Oe(Zi),Oe(zp))},t.\u0275cmp=qt({type:t,selectors:[["app-root"]],viewQuery:function(e,i){if(1&e&&dn(Ete,7,Pr),2&e){let r;un(r=fn())&&(i.modalLayerViewContainerRef=r.first)}},decls:98,vars:13,consts:[["id","app-table-layer",2,"position","absolute","width","100%","height","100%","overflow","hidden"],[3,"top","left","width","height","title","isAbleFullScreenButton","isAbleCloseButton","isAbleRotateButton","rotateEvent"],[3,"ngClass"],[3,"click"],["routerLink","/","routerLinkActive","active"],[1,"material-icons","icon-size"],[1,"material-icons"],[1,"self-only"],["type","file","multiple","","accept","application/xml,text/xml,application/zip",2,"display","none",3,"change"],[3,"click",4,"ngIf"],["style","pointer-events: none;",4,"ngIf"],[1,"self-only-indicater",2,"font-size","8px","text-align","center"],["modalLayer",""],[1,"networkIndicator"],[2,"pointer-events","none"],[1,"material-icons","vibration-amine"]],template:function(e,i){1&e&&(X(0,"div",0),nt(1,"game-table"),te(),X(2,"ui-panel",1),Ie("rotateEvent",function(s){return i.rotateChange(s)}),X(3,"nav",2)(4,"ul")(5,"li",3),Ie("click",function(){return i.open("PeerMenuComponent")}),X(6,"a",4)(7,"div")(8,"i",5),be(9,"people"),te()(),X(10,"div"),be(11,"\u63a5\u7d9a"),te()()(),X(12,"li",3),Ie("click",function(){return i.open("ChatWindowComponent")}),X(13,"a",4)(14,"div")(15,"i",5),be(16,"speaker_notes"),te()(),X(17,"div"),be(18,"\u30c1\u30e3\u30c3\u30c8\u753b\u9762"),te()()(),X(19,"li",3),Ie("click",function(){return i.open("GameTableSettingComponent")}),X(20,"a",4)(21,"div")(22,"i",5),be(23,"layers"),te()(),X(24,"div"),be(25,"\u30c6\u30fc\u30d6\u30eb\u8a2d\u5b9a"),te()()(),X(26,"li",3),Ie("click",function(){return i.open("FileStorageComponent")}),X(27,"a",4)(28,"div")(29,"i",5),be(30,"photo_library"),te()(),X(31,"div"),be(32,"\u753b\u50cf"),te()()(),X(33,"li",3),Ie("click",function(){return i.open("JukeboxComponent")}),X(34,"a",4)(35,"div")(36,"i",6),be(37,"queue_music"),te()(),X(38,"div"),be(39,"\u97f3\u697d"),te()()(),X(40,"li",3),Ie("click",function(){return i.toolBox()}),X(41,"a",4)(42,"div")(43,"i",6),be(44,"build"),te()(),X(45,"div"),be(46,"\u30c4\u30fc\u30eb\u30dc\u30c3\u30af\u30b9"),te()()(),X(47,"li",3),Ie("click",function(){return i.open("GameObjectInventoryComponent")}),X(48,"a",4)(49,"div")(50,"i",5),be(51,"folder_shared"),te()(),X(52,"div"),be(53,"\u30a4\u30f3\u30d9\u30f3\u30c8\u30ea"),te()()(),X(54,"li",3),Ie("click",function(){return i.diceAllOpne()}),X(55,"a",4)(56,"div")(57,"i",5),be(58,"all_out"),te()(),X(59,"div"),be(60,"\u30c0\u30a4\u30b9\u4e00\u6589\u516c\u958b"),te()()(),X(61,"li",3),Ie("click",function(){return i.standSetteings()}),X(62,"a",4)(63,"div")(64,"i",5),be(65,"how_to_reg"),te()(),X(66,"div"),be(67,"\u500b\u4eba\u8a2d\u5b9a"),X(68,"sup",7),be(69,"*"),te()()()(),X(70,"li",3),Ie("click",function(){return i.resetPointOfView()}),X(71,"a",4)(72,"div")(73,"i",5),be(74,"remove_red_eye"),te()(),X(75,"div"),be(76,"\u8996\u70b9\u30ea\u30bb\u30c3\u30c8"),X(77,"sup",7),be(78,"*"),te()()()(),X(79,"li")(80,"a",4)(81,"label")(82,"div")(83,"i",6),be(84,"open_in_browser"),te()(),X(85,"div"),be(86,"ZIP\u8aad\u8fbc"),te(),X(87,"input",8),Ie("change",function(s){return i.handleFileSelect(s)}),te()()()(),xe(88,Tte,7,0,"li",9),xe(89,Ite,7,1,"li",10),te(),X(90,"div",11)(91,"b")(92,"sup",7),be(93,"*"),te(),be(94,"\u306f\u81ea\u5206\u306e\u307f"),te()()()(),nt(95,"div",null,12)(97,"network-indicator",13)),2&e&&(W(2),re("top",0)("left",0)("width",100)("height",710)("title","\u30e1\u30cb\u30e5\u30fc")("isAbleFullScreenButton",!1)("isAbleCloseButton",!1)("isAbleRotateButton",!0),W(1),re("ngClass",ct(11,Ste,i.isHorizontal)),W(85),re("ngIf",!i.isSaveing),W(1),re("ngIf",i.isSaveing))},directives:[xte,jI,jn,gn,wte],styles:["[_nghost-%COMP%]{display:block}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{list-style:none;padding:0;margin:0}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{text-align:center;padding:5px;color:#ccc;color:#444;cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]:hover{color:#ccc;background-color:#1e1e1ecc}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%]{height:128px;width:128px;font-size:8px;-webkit-user-select:none;-moz-user-select:none;user-select:none}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%] > a[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{cursor:-moz-pointer;cursor:-webkit-pointer;cursor:pointer}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%], nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:active, nav[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:visited{text-decoration:none}.icon-size[_ngcontent-%COMP%]{font-size:40px}.side-menu[_ngcontent-%COMP%]{top:0px;left:0px;box-sizing:border-box;overflow:auto;position:absolute;color:#ccc;background-color:#1e1e1ecc;border:solid 1px #999;padding:0;height:100%;width:300px}.networkIndicator[_ngcontent-%COMP%]{display:none;z-index:9999;pointer-events:none;position:absolute;top:3px;right:3px;height:30px;width:30px}.vibration-amine[_ngcontent-%COMP%]{-webkit-animation:vibration .2s infinite;animation:vibration .2s infinite}@-webkit-keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}@keyframes vibration{0%{transform:scale(1) translate(0)}50%{transform:scale(1.02,.95) translateY(5%)}to{transform:scale(1) translate(0)}}.self-only[_ngcontent-%COMP%]{color:red}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{display:flex;flex-wrap:nowrap}.horizontal[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%] > li[_ngcontent-%COMP%]{display:inline-block;width:74px}[_ngcontent-%COMP%]:not(.horizontal)   .self-only-indicater[_ngcontent-%COMP%]{margin-top:2em}.horizontal[_ngcontent-%COMP%]   .self-only-indicater[_ngcontent-%COMP%]{display:none}"]}),t})();Tn.UIPanelComponentClass=jI,lr.ContextMenuComponentClass=NK,kn.ModalComponentClass=rZ;let Mte=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t}),t.\u0275inj=rs({}),t})(),Dte=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=ys({type:t,bootstrap:[kte]}),t.\u0275inj=rs({providers:[c1,yr,lr,kn,d1,Tn,li,af,Zi],imports:[[_x,p8,rx,mO,Mte,Y9,NX.register("ngsw-worker.js",{enabled:true})]]}),t})();Eg(cu,[bl,vl,Qo,Jn,Sa,si,oi,ei,gn,kd,Ki,Rr,Or],[]),Eg(cu,[bl,vl,Qo,Jn,Sa,si,oi,ei,gn,kd,Ki,Rr,Or],[]),function tN(){A2=!1}(),iR().bootstrapModule(Dte).catch(t=>console.error(t))},5904:(E,ae,Y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),Y(8827),Y(4748),Y(9202),Y(8465);var a=Y(3583),y=Y(3693),w=function(){function p(u,k){this.internal=null!=k?k:a.BCDice.Base.$new(u)}return p.eval=function(u){var k=a.BCDice.Base.$eval(u);return y.parseResult(k)},Object.defineProperty(p.prototype,"randomizer",{get:function(){return this.internal.randomizer},enumerable:!1,configurable:!0}),p.prototype.eval=function(){var u=this.internal.$eval();return y.parseResult(u)},p}();ae.default=w},8827:(E,ae,Y)=>{Y(9993),Opal.queue(function(a){var F,H,ue,K,ee,U,se,V,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.hash2,v=a.truthy,D=a.def;return F=y,H=V=[u(y[0],"BCDice")].concat(F),se=[U=u(V[0],"ArithmeticEvaluator")].concat(H),K=[ue=a.get_singleton_class(U)].concat(se),ee=a.$r(K),D(ue,"$eval",function(G,z){var A,N=w;if(null==z)z=k([],{});else if(!z.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return null==(A=z.$$smap.round_type)&&(A=p(ee("RoundType"),"FLOOR")),v(G)&&v(N=ee("Arithmetic").$eval(G,A))?N:0},-2)})},9202:(E,ae,Y)=>{Y(9993),Opal.modules.json=function(a){var J,ue,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.send,D=a.to_a,_=a.rb_minus,F=a.Object,oe=a.hash2,V=a.eqeqeq,L=a.defs,H=a.truthy,U=a.def;return function(se,ue){var J=u(se,"JSON"),K=[J].concat(ue),ee=a.$r(K),M=w;k(K[0],ee("StandardError"),"JSONError"),k(K[0],ee("JSONError"),"ParserError");var G=a.hasOwnProperty;function z(N){try{return JSON.parse(N)}catch(P){J.$raise(p(ee("JSON"),"ParserError"),P.message)}}function A(N,P){var g,b,C,h,c,l;switch(typeof N){case"string":case"number":return N;case"boolean":return!!N;case"undefined":return w;case"object":if(!N)return w;if(N.$$is_array){for(b=P.array_class.$new(),h=0,c=N.length;h<c;h++)b.$push(A(N[h],P));return b}for(l in C=P.object_class.$new(),N)G.call(N,l)&&(M=[l,A(N[l],P)],v(C,"[]=",D(M)),_(M.length,1));return P.parse||(g=C["$[]"](ee("JSON").$create_id()))==w?C:F.$const_get(g).$json_create(C)}}a.get_singleton_class(J).$attr_accessor("create_id"),v(J,"create_id=",D(M=["json_class"])),_(M.length,1),L(J,"$[]",function(P,g){return null==g&&(g=oe([],{})),V(ee("String"),P)?this.$parse(P,g):this.$generate(P,g)},-2),L(J,"$parse",function(P,g){return null==g&&(g=oe([],{})),this.$from_object(z(P),g.$merge(oe(["parse"],{parse:!0})))},-2),L(J,"$parse!",function(P,g){return null==g&&(g=oe([],{})),this.$parse(P,g)},-2),L(J,"$load",function(P,g){return null==g&&(g=oe([],{})),this.$from_object(z(P),g)},-2),L(J,"$from_object",function(P,g){var C=w;return null==g&&(g=oe([],{})),H(g["$[]"]("object_class"))||(C=["object_class",ee("Hash")],v(g,"[]=",D(C)),_(C.length,1)),H(g["$[]"]("array_class"))||(C=["array_class",ee("Array")],v(g,"[]=",D(C)),_(C.length,1)),A(P,g.$$smap)},-2),L(J,"$generate",function(P,g){return null==g&&(g=oe([],{})),P.$to_json(g)},-2),L(J,"$dump",function(P,g,b){var h;return null==g&&(g=w),null==b&&(b=w),h=this.$generate(P),H(g)?(H(g["$responds_to?"]("to_io"))&&(g=g.$to_io()),g.$write(h),g):h},-2)}(y[0],y),J=k(y[0],null,"Object"),U(J,"$to_json",function(){return this.$to_s().$to_json()},0),ue=u(y[0],"Enumerable"),U(ue,"$to_json",function(){return this.$to_a().$to_json()},0),function(se,ue){var J=k(se,null,"Array");U(J,"$to_json",function(){for(var M=[],G=0,z=this.length;G<z;G++)M.push(this[G].$to_json());return"["+M.join(",")+"]"},0)}(y[0]),function(se,ue){var J=k(se,null,"Boolean");U(J,"$to_json",function(){return 1==this?"true":"false"},0)}(y[0]),function(se,ue){var J=k(se,null,"Hash");U(J,"$to_json",function(){for(var N,P,M=[],G=0,z=this.$$keys,A=z.length;G<A;G++)(N=z[G]).$$is_string?P=this.$$smap[N]:(P=N.value,N=N.key),M.push(N.$to_s().$to_json()+":"+P.$to_json());return"{"+M.join(",")+"}"},0)}(y[0]),function(se,ue){var J=k(se,null,"NilClass");U(J,"$to_json",function(){return"null"},0)}(y[0]),function(se,ue){var J=k(se,null,"Numeric");U(J,"$to_json",function(){return this.toString()},0)}(y[0]),function(se,ue){var J=k(se,null,"String");U(J,"$to_json",function(){return JSON.stringify(this)},0)}(y[0]),function(se,ue){var J=k(se,null,"Time");U(J,"$to_json",function(){return this.$strftime("%FT%T%z").$to_json()},0)}(y[0]),function(se,ue){var J=k(se,null,"Date");return U(J,"$to_json",function(){return this.$to_s().$to_json()},0),U(J,"$as_json",function(){return this.$to_s()},0)}(y[0])},Opal.modules.i18n=function(a){var J,M,z,A,K,ee,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.class_variable_set,D=a.class_variable_get,_=a.def,F=a.truthy,oe=a.hash2,V=a.send,L=a.to_a,U=a.alias,se=a.klass;return a.top.$require("json"),J=w,ee=[K=k(w[0],"I18n")].concat(J),M=a.get_singleton_class(K),z=[M].concat(ee),A=a.$r(z),v(z[1],"@@load_path",[]),v(z[1],"@@table",p),_(M,"$load_path",function(){return D(z[1],"@@load_path",!1)},0),_(M,"$default_locale",function(){return D(z[1],"@@default_locale",!1)},0),_(M,"$default_locale=",function(P){return v(z[1],"@@default_locale",P)},1),_(M,"$fallbacks",function(){return u(u(A("I18n"),"Locale"),"Fallbacks").$new()},0),_(M,"$load_default_translation",function(){return F(D(z[1],"@@table",!1)["$nil?"]())?(v(z[1],"@@table",oe([],{})),this.$load_translation(JSON.stringify(Y(6884)))):p},0),_(M,"$load_translation",function(P){var b;return this.$load_default_translation(),b=A("JSON").$parse(P,oe(["symbolize_names"],{symbolize_names:!0})),v(z[1],"@@table",V(D(z[1],"@@table",!1),"merge",[b],function(h,c,l){return null==h&&(h=p),null==c&&(c=p),null==l&&(l=p),c.$merge(l)},3))},1),_(M,"$clear_translate_table",function(){return v(z[1],"@@table",p)},0),_(M,"$translate",function(P,g){var b,C,c,l,f=p,m=p,x=p;if(null==g)g=oe([],{});else if(!g.$$is_hash)throw a.ArgumentError.$new("expected kwargs");null==(b=g.$$smap.locale)&&(b=p),C=a.kwrestargs(g,{locale:!0}),this.$load_default_translation(),c=V(P.$split("."),"map",[],"to_sym".$to_proc()),l=D(z[1],"@@table",!1),f=D(z[1],"@@default_locale",!1),m=F(x=V(l,"dig",[b].concat(L(c))))?x:V(l,"dig",[f].concat(L(c)));try{F(m["$is_a?"](A("String")))&&(m=this.$format(m,a.to_hash(C)))}catch(S){if(!a.rescue(S,[A("ArgumentError"),A("KeyError")]))throw S;a.pop_exception()}return F(x=m)?x:C["$[]"]("default")},-2),U(M,"t","translate"),function(M,G){var P,g,b,A=[k(M,"Locale")].concat(G),N=a.$r(A);P=A[0],g=N("Hash"),b=se(P,g,"Fallbacks"),_(b,"$defaults=",function(h){return p},1)}(ee[0],ee),function(M,G){var A=[k(M,"Backend")].concat(G);k(A[0],"Simple")}(ee[0],ee),function(M,G){var N,z=k(M,"Thread");return[z].concat(G),N=a.get_singleton_class(z),_(N,"$current",function(){return oe(["i18n_fallbacks"],{i18n_fallbacks:p})},0)}(ee[0],ee)},Opal.modules["i18n/backend/fallbacks"]=function(a){var K,G,A,N,ee,M,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.class_variable_set,v=a.truthy,D=a.class_variable_get,_=a.def,F=a.send,oe=a.to_a,V=a.rb_minus,L=a.send2,H=a.find_super,U=a.hash2,se=a.find_block_super,ue=a.neqeq;return K=y,M=[ee=u(y[0],"I18n")].concat(K),k(M[0],"@@fallbacks",w),G=a.get_singleton_class(ee),A=[G].concat(M),N=a.$r(A),_(G,"$fallbacks",function(){var b=w;return k(A[1],"@@fallbacks",v(null!=A[1].$$cvars["@@fallbacks"]?"class variable":w)&&v(b=D(A[1],"@@fallbacks",!1))?b:p(p(N("I18n"),"Locale"),"Fallbacks").$new()),v(b=N("Thread").$current()["$[]"]("i18n_fallbacks"))?b:D(A[1],"@@fallbacks",!1)},0),_(G,"$fallbacks=",function(g){var b;return k(A[1],"@@fallbacks",v(g["$is_a?"](N("Array")))?p(p(N("I18n"),"Locale"),"Fallbacks").$new(g):g),b=["i18n_fallbacks",D(A[1],"@@fallbacks",!1)],F(N("Thread").$current(),"[]=",oe(b)),b[V(b.length,1)]},1),function(G,z){var g,b,C,h,N=[u(G,"Backend")].concat(z);return g=N,C=[b=u(N[0],"Fallbacks")].concat(g),h=a.$r(C),_(b,"$translate",function c(l,f,m){try{var x=c.$$p||w,S=this,Z=w,le=w;return delete c.$$p,null==m&&(m=h("EMPTY_HASH")),v(m.$fetch("fallback",!0))?v(m["$[]"]("fallback_in_progress"))?L(S,H(S,"translate",c,!1,!0),"translate",[l,f,m],x):(v(m["$[]"]("default"))&&(Z=S["$extract_non_symbol_default!"](m)),le=m.$merge(U(["fallback_in_progress"],{fallback_in_progress:!0})),F(h("I18n").$fallbacks()["$[]"](l),"each",[],function ye(T){var R=null==ye.$$s?this:ye.$$s;null==T&&(T=w);try{return F(R,"catch",["exception"],function ie(){var j=null==ie.$$s?this:ie.$$s,ve=w;if(ve=L(j,se(j,"translate",ie.$$def||ye.$$def||c,!1,!1),"translate",[T,f,le],null),v(ve["$nil?"]()))return w;ue(l.$to_s(),T.$to_s())&&j.$on_fallback(l,T,f,m),a.ret(ve)},{$$arity:0,$$s:R})}catch(ie){if(!a.rescue(ie,[p(h("I18n"),"InvalidLocale")]))throw ie;try{return w}finally{a.pop_exception()}}},{$$arity:1,$$s:S}),v(m["$key?"]("default"))&&v(m["$[]"]("default")["$nil?"]())?w:v(Z)?L(S,H(S,"translate",c,!1,!0),"translate",[l,w,m.$merge(U(["default"],{default:Z}))],null):S.$throw("exception",p(h("I18n"),"MissingTranslation").$new(l,f,m))):L(S,H(S,"translate",c,!1,!0),"translate",[l,f,m],x)}catch(ye){if(ye===a.returner)return ye.$v;throw ye}},-3),_(b,"$extract_non_symbol_default!",function(l){var m,f=w,x=w;return f=[l["$[]"]("default")].$flatten(),m=F(f,"detect",[],function(Z){return null==Z&&(Z=w),Z["$is_a?"](h("Symbol"))["$!"]()},1),v(m)&&(x=["default",f["$[]"](0,f.$index(m))],F(l,"[]=",oe(x)),V(x.length,1)),m},1),_(b,"$exists?",function c(l,f,m){try{var x=c.$$p||w,S=this;return delete c.$$p,null==m&&(m=h("EMPTY_HASH")),v(m.$fetch("fallback",!0))?(F(h("I18n").$fallbacks()["$[]"](l),"each",[],function Z(le){var ye=null==Z.$$s?this:Z.$$s;null==le&&(le=w);try{if(!v(L(ye,se(ye,"exists?",Z.$$def||c,!1,!1),"exists?",[le,f],null)))return w;a.ret(!0)}catch(T){if(!a.rescue(T,[p(h("I18n"),"InvalidLocale")]))throw T;try{return w}finally{a.pop_exception()}}},{$$arity:1,$$s:S}),!1):L(S,H(S,"exists?",c,!1,!0),"exists?",[l,f,m],x)}catch(Z){if(Z===a.returner)return Z.$v;throw Z}},-3),b.$private(),_(b,"$on_fallback",function(l,f,m,x){return w},4)}(M[0],M)},Opal.modules["bcdice/randomizer"]=function(a){var ee,P,g,b,C,h,G,z,y=[],w=a.nil,p=a.$$$,k=a.klass,v=a.const_set,D=a.def,_=a.truthy,F=a.rb_gt,oe=a.rb_plus,V=a.rb_le,L=a.send,H=a.rb_minus,U=a.eqeq,se=a.rb_times,ue=a.eqeqeq,J=a.rb_ge;return ee=y,G=[(0,a.module)(y[0],"BCDice")].concat(ee),z=a.$r(G),P=G,b=[g=k(G[0],null,"Randomizer")].concat(P),C=a.$r(b),(h=g.$$prototype).rand_results=h.detailed_rand_results=w,v(b[0],"UPPER_LIMIT_DICE_TIMES",200),v(b[0],"UPPER_LIMIT_DICE_SIDES",1e4),v(b[0],"UPPER_LIMIT_RANDS",1e4),D(g,"$initialize",function(){return this.rand_results=[],this.detailed_rand_results=[]},0),g.$attr_reader("rand_results"),g.$attr_reader("detailed_rand_results"),v(b[0],"DetailedRandResult",C("Struct").$new("kind","sides","value")),D(g,"$roll_barabara",function(l,f){var m=this;return _(F(oe(m.rand_results.$size(),l),C("UPPER_LIMIT_RANDS")))&&m.$raise(C("TooManyRandsError")),_(V(l,0))||_(F(l,C("UPPER_LIMIT_DICE_TIMES")))?[]:L(C("Array"),"new",[l],function x(){return(null==x.$$s?this:x.$$s).$roll_once(f)},{$$arity:0,$$s:m})},2),D(g,"$roll_sum",function(l,f){return this.$roll_barabara(l,f).$sum()},2),D(g,"$roll_once",function(l){var m=w;return _(V(l,0))||_(F(l,C("UPPER_LIMIT_DICE_SIDES")))?0:(m=this.$rand_inner(l),this.$push_to_detail("normal",l,m),m)},1),D(g,"$roll_index",function(l){return H(this.$roll_once(l),1)},1),D(g,"$roll_tens_d10",function(){var m,f=w;return f=this.$rand_inner(10),U(f,10)&&(f=0),m=se(f,10),this.$push_to_detail("tens_d10",10,m),m},0),D(g,"$roll_d9",function(){var f;return f=H(this.$rand_inner(10),1),this.$push_to_detail("d9",10,f),f},0),D(g,"$roll_d66",function(l){var x,m=w;return m=L(C("Array"),"new",[2],function S(){return(null==S.$$s?this:S.$$s).$roll_once(6)},{$$arity:0,$$s:this}),ue(p(C("D66SortType"),"ASC"),x=l)?m["$sort!"]():ue(p(C("D66SortType"),"DESC"),x)&&m["$sort!"]()["$reverse!"](),oe(se(m["$[]"](0),10),m["$[]"](1))},1),g.$private(),D(g,"$rand_inner",function(l){var m,f=this;return _(J(f.rand_results.$size(),C("UPPER_LIMIT_RANDS")))&&f.$raise(C("TooManyRandsError")),m=f.$random(l),f.rand_results["$<<"]([m,l]),m},1),D(g,"$random",function(l){return oe(C("Kernel").$rand(l),1)},1),D(g,"$push_to_detail",function(l,f,m){var S;return S=C("DetailedRandResult").$new(l,f,m),this.detailed_rand_results.$push(S)},3),k(G[0],z("StandardError"),"TooManyRandsError"),w},Opal.modules["bcdice/dice_table/roll_result"]=function(a){var _,L,J,K,ee,M,G,U,oe,y=[],w=a.nil,p=a.module,u=a.klass,k=a.def,v=a.truthy;return _=y,L=oe=[p(y[0],"BCDice")].concat(_),J=U=[p(oe[0],"DiceTable")].concat(L),ee=[K=u(U[0],null,"RollResult")].concat(J),M=a.$r(ee),(G=K.$$prototype).table_name=G.value=G.body=w,k(K,"$initialize",function(A,N,P){var g=this;return g.table_name=A,g.value=N,g.body=P},3),K.$attr_reader("table_name"),K.$attr_reader("value"),K.$attr_reader("body"),k(K,"$to_s",function(){var A=this;return A.table_name+"("+A.value+") \uff1e "+A.body},0),k(K,"$last_body",function(){var A=this;return v(A.body["$is_a?"](M("RollResult")))?A.body.$last_body():A.body},0),k(K,"$empty?",function(){return!1},0)},Opal.modules["bcdice/dice_table/chain_table"]=function(a){var F,H,K,ee,M,G,z,se,V,y=[],w=a.nil,p=a.module,u=a.klass,k=a.truthy,v=a.def,D=a.rb_minus;return F=y,H=V=[p(y[0],"BCDice")].concat(F),K=se=[p(V[0],"DiceTable")].concat(H),M=[ee=u(se[0],null,"ChainTable")].concat(K),G=a.$r(M),(z=ee.$$prototype).times=z.sides=z.items=z.name=w,v(ee,"$initialize",function(N,P,g){var b=this,C=w;return b.name=N,b.items=g.$freeze(),C=/(\d+)D(\d+)/i.$match(P),k(C)||b.$raise(G("ArgumentError"),"Unexpected table type: "+P),b.times=C["$[]"](1).$to_i(),b.sides=C["$[]"](2).$to_i()},3),v(ee,"$roll",function(N){var g,b,P=this,C=w;return g=N.$roll_sum(P.times,P.sides),b=D(g,P.times),C=P.items["$[]"](b),k(C["$respond_to?"]("roll"))&&(C=C.$roll(N)),G("RollResult").$new(P.name,g,C)},1)},Opal.modules["bcdice/dice_table/d66_grid_table"]=function(a){var L,ue,G,z,A,N,P,K,U,y=[],w=a.nil,p=a.module,u=a.klass,k=a.hash2,v=a.defs,D=a.def,_=a.rb_plus,F=a.rb_times,oe=a.rb_minus;return L=y,ue=U=[p(y[0],"BCDice")].concat(L),G=K=[p(U[0],"DiceTable")].concat(ue),A=[z=u(K[0],null,"D66GridTable")].concat(G),N=a.$r(A),(P=z.$$prototype).name=P.items=w,v(z,"$from_i18n",function(b,C){var c=w;return c=N("I18n").$t(b,k(["locale","raise"],{locale:C,raise:!0})),this.$new(c["$[]"]("name"),c["$[]"]("items"))},2),D(z,"$initialize",function(b,C){return this.name=b,this.items=C.$freeze()},2),D(z,"$roll",function(b){var h,c,l,f,m;return h=b.$roll_once(6),c=b.$roll_once(6),l=_(F(h,10),c),f=oe(h,1),m=oe(c,1),N("RollResult").$new(this.name,l,this.items["$[]"](f)["$[]"](m))},1)},Opal.modules["bcdice/dice_table/d66_half_grid_table"]=function(a){var oe,U,M,G,z,A,ue,J,L,w=[],p=a.nil,u=a.module,k=a.klass,v=a.hash2,D=a.defs,_=a.def;return a.top.$require("bcdice/dice_table/d66_grid_table"),oe=w,U=L=[u(w[0],"BCDice")].concat(oe),ue=[u(L[0],"DiceTable")].concat(U),J=a.$r(ue),M=ue,z=[G=k(ue[0],J("D66GridTable"),"D66HalfGridTable")].concat(M),A=a.$r(z),D(G,"$from_i18n",function(P,g){var C=p;return C=A("I18n").$t(P,v(["locale","raise"],{locale:g,raise:!0})),this.$new(C["$[]"]("name"),C["$[]"]("items_1_2_3"),C["$[]"]("items_4_5_6"))},2),_(G,"$initialize",function(P,g,b){return this.name=P,this.items=[g,g,g,b,b,b].$freeze()},3)},Opal.modules["bcdice/dice_table/d66_one_third_table"]=function(a){var oe,U,M,G,z,A,ue,J,L,w=[],p=a.nil,u=a.module,k=a.klass,v=a.hash2,D=a.defs,_=a.def;return a.top.$require("bcdice/dice_table/d66_grid_table"),oe=w,U=L=[u(w[0],"BCDice")].concat(oe),ue=[u(L[0],"DiceTable")].concat(U),J=a.$r(ue),M=ue,z=[G=k(ue[0],J("D66GridTable"),"D66OneThirdTable")].concat(M),A=a.$r(z),D(G,"$from_i18n",function(P,g){var C=p;return C=A("I18n").$t(P,v(["locale","raise"],{locale:g,raise:!0})),this.$new(C["$[]"]("name"),C["$[]"]("items_1_2"),C["$[]"]("items_3_4"),C["$[]"]("items_5_6"))},2),_(G,"$initialize",function(P,g,b,C){return this.name=P,this.items=[g,g,b,b,C,C].$freeze()},4)},Opal.modules["bcdice/dice_table/d66_table"]=function(a){var U,K,A,N,P,g,b,M,ue,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.hash2,D=a.defs,_=a.def,F=a.eqeqeq,oe=a.rb_plus,V=a.rb_times,L=a.truthy;return U=y,K=ue=[u(y[0],"BCDice")].concat(U),A=M=[u(ue[0],"DiceTable")].concat(K),P=[N=k(M[0],null,"D66Table")].concat(A),g=a.$r(P),(b=N.$$prototype).sort_type=b.items=b.name=w,D(N,"$from_i18n",function(h,c){var m,f=w;return f=g("I18n").$t(h,v(["locale"],{locale:c})),m=g("D66SortType").$const_get(f["$[]"]("d66_sort_type")),this.$new(f["$[]"]("name"),m,f["$[]"]("items"))},2),_(N,"$initialize",function(h,c,l){var f=this;return f.name=h,f.sort_type=c,f.items=l.$freeze()},3),_(N,"$roll",function(h){var c=this,l=w,f=w,m=w,x=w;return l=h.$roll_barabara(2,6),F(p(g("D66SortType"),"ASC"),f=c.sort_type)?l["$sort!"]():F(p(g("D66SortType"),"DESC"),f)&&l["$sort!"]()["$reverse!"](),m=oe(V(l["$[]"](0),10),l["$[]"](1)),x=L(f=c.items["$[]"](m))?f:c.items["$[]"](m.$to_s()),L(x["$respond_to?"]("roll"))&&(x=x.$roll(h)),g("RollResult").$new(c.name,m,x)},1),_(N,"$choice",function(h){return g("RollResult").$new(this.name,h,this.items["$[]"](h))},1)},Opal.modules["bcdice/dice_table/d66_left_range_table"]=function(a){var J,G,A,N,ee,w=[],p=a.nil,u=a.module,k=a.klass,v=a.hash2,D=a.send,_=a.to_ary,F=a.rb_plus,oe=a.rb_times,V=a.to_a,L=a.rb_minus,H=a.send2,U=a.find_super,se=a.def;return a.top.$require("bcdice/dice_table/d66_table"),J=w,G=ee=[u(w[0],"BCDice")].concat(J),A=[u(ee[0],"DiceTable")].concat(G),N=a.$r(A),se(k(A[0],N("D66Table"),"D66LeftRangeTable"),"$initialize",function C(h,c,l){var x;return delete C.$$p,x=v([],{}),D(l,"each",[],function(Z){var le,R;return null==Z&&(Z=p),le=_(Z),R=null==le[1]?p:le[1],D(null==le[0]?p:le[0],"each",[],function(j){return null==j&&(j=p),D(R,"each_with_index",[],function(de,we){var ce,he;return null==de&&(de=p),null==we&&(we=p),ce=F(oe(j,10),F(we,1)),D(x,"[]=",V(he=[ce,de])),he[L(he.length,1)]},2)},1)},1),H(this,U(this,"initialize",C,!1,!0),"initialize",[h,c,x],null)},3)},Opal.modules["bcdice/dice_table/d66_parity_table"]=function(a){var H,J,z,A,N,P,g,ee,se,y=[],w=a.nil,p=a.module,u=a.klass,k=a.hash2,v=a.defs,D=a.def,_=a.truthy,F=a.rb_minus,oe=a.rb_plus,V=a.rb_times;return H=y,J=se=[p(y[0],"BCDice")].concat(H),z=ee=[p(se[0],"DiceTable")].concat(J),N=[A=u(ee[0],null,"D66ParityTable")].concat(z),P=a.$r(N),(g=A.$$prototype).odd=g.even=g.name=w,v(A,"$from_i18n",function(C,h){var l=w;return l=P("I18n").$t(C,k(["locale","raise"],{locale:h,raise:!0})),this.$new(l["$[]"]("name"),l["$[]"]("odd"),l["$[]"]("even"))},2),D(A,"$initialize",function(C,h,c){var l=this;return l.name=C,l.odd=h.$freeze(),l.even=c.$freeze()},3),D(A,"$roll",function(C){var l,m,x,h=this,c=w;return c=C.$roll_once(6),l=C.$roll_once(6),m=(_(c["$odd?"]())?h.odd:h.even)["$[]"](F(l,1)),x=oe(V(c,10),l),P("RollResult").$new(h.name,x,m)},1)},Opal.modules["bcdice/dice_table/d66_range_table"]=function(a){var oe,U,ee,M,G,z,A,ue,L,y=[],w=a.nil,p=a.module,u=a.klass,k=a.def,v=a.rb_plus,D=a.rb_times,_=a.send;return oe=y,U=L=[p(y[0],"BCDice")].concat(oe),ee=ue=[p(L[0],"DiceTable")].concat(U),G=[M=u(ue[0],null,"D66RangeTable")].concat(ee),z=a.$r(G),(A=M.$$prototype).items=A.name=w,k(M,"$initialize",function(P,g){return this.name=P,this.items=g.$freeze()},2),k(M,"$roll",function(P){var b,C,h,c=w;return b=P.$roll_once(6),C=P.$roll_once(6),h=v(D(b,10),C),c=_(this.items,"find",[],function(f){return null==f&&(f=w),f["$[]"](0)["$include?"](h)},1),z("RollResult").$new(this.name,h,c["$[]"](1))},1)},Opal.modules["bcdice/dice_table/range_table"]=function(a){var se,ee,N,P,g,b,C,G,J,y=[],w=a.nil,p=a.module,u=a.klass,k=a.const_set,v=a.send,D=a.truthy,_=a.def,F=a.to_a,oe=a.rb_minus,V=a.eqeqeq,L=a.rb_times,H=a.rb_plus;return se=y,ee=J=[p(y[0],"BCDice")].concat(se),N=G=[p(J[0],"DiceTable")].concat(ee),g=[P=u(G[0],null,"RangeTable")].concat(N),b=a.$r(g),(C=P.$$prototype).name=C.items=C.num_of_dice=C.num_of_sides=C.formatter=w,k(g[0],"RollResult",v(b("Struct"),"new",["sum","values","content","formatted"],function h(){return(null==h.$$s?this:h.$$s).$alias_method("to_s","formatted")},{$$arity:0,$$s:P})),k(g[0],"Item",b("Struct").$new("range","content")),k(g[0],"DICE_ROLL_METHOD_RE",/^(\d+)D(\d+)$/i.$freeze()),k(g[0],"DEFAULT_FORMATTER",v(P,"lambda",[],function(c,l){return null==c&&(c=w),null==l&&(l=w),c.$name()+"("+l.$sum()+") \uff1e "+l.$content()},2)),P.$attr_reader("name"),P.$attr_reader("num_of_dice"),P.$attr_reader("num_of_sides"),_(P,"$initialize",function h(c,l,f){var S,m=h.$$p||w,x=this,Z=w;return delete h.$$p,x.name=c.$freeze(),x.formatter=D(S=m)?S:b("DEFAULT_FORMATTER"),Z=b("DICE_ROLL_METHOD_RE").$match(l),D(Z)||x.$raise(b("ArgumentError"),x.name+": invalid dice roll method: "+l),x.num_of_dice=Z["$[]"](1).$to_i(),x.num_of_sides=Z["$[]"](2).$to_i(),x.$store(f)},3),_(P,"$fetch",function(c){var f,l=this;return f=v(l.items,"find",[],function(x){return null==x&&(x=w),x.$range()["$include?"](c)},1),D(f)||l.$raise(b("RangeError"),l.name+": value is out of range: "+c),f},1),_(P,"$roll",function(c){var m,x,S,l=this,f=w;return m=(f=c.$roll_barabara(l.num_of_dice,l.num_of_sides)).$sum(),x=b("RollResult").$new(m,f,l.$fetch(m).$content()),S=[l.formatter["$[]"](l,x)],v(x,"formatted=",F(S)),oe(S.length,1),x},1),P.$private(),_(P,"$store",function(c){var f,m,l=this;return f=v(c,"map",[],function x(S,Z){return null==S&&(S=w),null==Z&&(Z=w),[(null==x.$$s?this:x.$$s).$coerce_to_int_range(S),Z]},{$$arity:2,$$s:l}),m=v(f,"sort_by",[],function(S,Z){return null==S&&(S=w),null==Z&&(Z=w),S.$min()},2),l.$assert_min_sum_is_covered(m),l.$assert_max_sum_is_covered(m),l.$assert_no_gap_or_overlap_in_ranges(m),l.items=v(m,"map",[],function(S,Z){return null==S&&(S=w),null==Z&&(Z=w),b("Item").$new(S,Z.$freeze()).$freeze()},2).$freeze(),l},1),_(P,"$coerce_to_int_range",function(c){var f;return V(b("Integer"),f=c)?b("Range").$new(c,c):V(b("Range"),f)&&D(c.$begin()["$is_a?"](b("Integer")))&&D(c.$end()["$is_a?"](b("Integer")))?c:this.$raise(b("TypeError"),this.name+": "+c+" ("+c.$class()+") must be an Integer or a Range with Integers ")},1),_(P,"$assert_min_sum_is_covered",function(c){var f,l=this,m=w;return f=l.num_of_dice,m=c.$first()["$[]"](0),D(m["$include?"](f))||l.$raise(b("RangeError"),l.name+": min value ("+f+") is not covered: "+m),l},1),_(P,"$assert_max_sum_is_covered",function(c){var f,l=this,m=w;return f=L(l.num_of_dice,l.num_of_sides),m=c.$last()["$[]"](0),D(m["$include?"](f))||l.$raise(b("RangeError"),l.name+": max value ("+f+") is not covered: "+m),l},1),_(P,"$assert_no_gap_or_overlap_in_ranges",function(c){return v(c,"each_cons",[2],function f(m,x){var ye,T,S=null==f.$$s?this:f.$$s,Z=w,le=w;return null==S.name&&(S.name=w),null==m&&(m=w),null==x&&(x=w),Z=m["$[]"](0),le=x["$[]"](0),ye=Z.$max(),T=H(ye,1),D(le["$include?"](ye))&&S.$raise(b("RangeError"),S.name+": Range overlap: "+Z+" and "+le),D(le["$include?"](T))?w:S.$raise(b("RangeError"),S.name+": Range gap: "+Z+" and "+le)},{$$arity:2,$$s:this}),this},1)},Opal.modules["bcdice/dice_table/sai_fic_skill_table/category"]=function(a){var oe,U,ee,N,P,g,b,G,ue,L,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.send,D=a.def,_=a.rb_minus;return oe=y,U=L=[u(y[0],"BCDice")].concat(oe),ee=ue=[u(L[0],"DiceTable")].concat(U),N=G=[k(ue[0],null,"SaiFicSkillTable")].concat(ee),g=[P=k(G[0],null,"Category")].concat(N),b=a.$r(g),P.$$prototype.name=w,D(P,"$initialize",function(c,l,f,m){var x=this;return x.name=c,x.skills=v(l.$map(),"with_index",[2],function(Z,le){return null==Z&&(Z=w),null==le&&(le=w),p(b("SaiFicSkillTable"),"Skill").$new(c,Z,f,le,m)},2),x.dice=f},4),D(P,"$roll",function(c){return this.$skills()["$[]"](_(c.$roll_sum(2,6),2))},1),D(P,"$to_s",function(){return this.name},0),P.$attr_reader("name","dice","skills")},Opal.modules["bcdice/dice_table/sai_fic_skill_table/skill"]=function(a){var _,L,J,z,A,ee,U,oe,y=[],w=a.nil,p=a.module,u=a.klass,k=a.def,v=a.hash2;return _=y,L=oe=[p(y[0],"BCDice")].concat(_),J=U=[p(oe[0],"DiceTable")].concat(L),ee=[u(U[0],null,"SaiFicSkillTable")].concat(J),(A=(z=u(ee[0],null,"Skill")).$$prototype).s_format=A.category_dice=A.row_dice=A.category_name=A.name=w,k(z,"$initialize",function(P,g,b,C,h){var c=this;return c.category_name=P,c.name=g,c.category_dice=b,c.row_dice=C,c.s_format=h},5),k(z,"$to_s",function(){var P=this;return P.$format(P.s_format,v(["category_dice","row_dice","category_name","skill_name"],{category_dice:P.category_dice,row_dice:P.row_dice,category_name:P.category_name,skill_name:P.name}))},0),z.$attr_reader("category_name","name","category_dice","row_dice")},Opal.modules["bcdice/dice_table/sai_fic_skill_table"]=function(a){var K,z,b,C,h,c,l,N,M,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.hash2,_=a.send,oe=a.defs,V=a.const_set,L=a.to_ary,H=a.def,U=a.truthy,se=a.rb_minus,ue=a.rb_plus;return y.$require("bcdice/dice_table/sai_fic_skill_table/category"),y.$require("bcdice/dice_table/sai_fic_skill_table/skill"),K=w,z=M=[k(w[0],"BCDice")].concat(K),b=N=[k(M[0],"DiceTable")].concat(z),h=[C=v(N[0],null,"SaiFicSkillTable")].concat(b),c=a.$r(h),(l=C.$$prototype).rtt=l.rtt_format=l.rct=l.rct_format=l.rttn=l.rttn_format=l.categories=p,oe(C,"$from_i18n",function(m,x,S){var Z,le,ye,j,ie=p;if(null==S)S=D([],{});else if(!S.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return null==(Z=S.$$smap.rtt)&&(Z=p),null==(le=S.$$smap.rct)&&(le=p),null==(ye=S.$$smap.rttn)&&(ye=p),j=(ie=c("I18n").$t("RTT",D(["locale","raise","default"],{locale:x,raise:!1,default:D([],{})})).$merge(c("I18n").$t(m,D(["locale","raise"],{locale:x,raise:!0}))))["$[]"]("items"),ie=_(ie,"select",[],function(de,we){return null==de&&(de=p),null==we&&(we=p),["rtt_format","rttn_format","rct_format","s_format"]["$include?"](de)},2),this.$new(j,a.to_hash(ie).$merge(D(["rtt","rct","rttn"],{rtt:Z,rct:le,rttn:ye})))},-3),V(h[0],"DEFAULT_RTT","\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s"),V(h[0],"DEFAULT_RCT","\u30e9\u30f3\u30c0\u30e0\u5206\u91ce\u8868(%<category_dice>d) \uff1e %<category_name>s"),V(h[0],"DEFAULT_RTTN","%<category_name>s\u5206\u91ce\u30e9\u30f3\u30c0\u30e0\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"),V(h[0],"DEFAULT_S","\u300a%<skill_name>s\uff0f%<category_name>s%<row_dice>d\u300b"),H(C,"$initialize",function(m,x){var S,Z,le,ye,T,R,ie,j=this;if(null==x)x=D([],{});else if(!x.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return null==(S=x.$$smap.rtt)&&(S=p),null==(Z=x.$$smap.rct)&&(Z=p),null==(le=x.$$smap.rttn)&&(le=p),null==(ye=x.$$smap.rtt_format)&&(ye=c("DEFAULT_RTT")),null==(T=x.$$smap.rct_format)&&(T=c("DEFAULT_RCT")),null==(R=x.$$smap.rttn_format)&&(R=c("DEFAULT_RTTN")),null==(ie=x.$$smap.s_format)&&(ie=c("DEFAULT_S")),j.categories=_(m.$map(),"with_index",[1],function(de,we){var ce,B,O;return null==de&&(de=p),null==we&&(we=p),B=null==(ce=L(de))[0]?p:ce[0],O=null==ce[1]?p:ce[1],u(c("SaiFicSkillTable"),"Category").$new(B,O,we,ie)},{$$arity:2,$$has_top_level_mlhs_arg:!0}),j.rtt=S,j.rct=Z,j.rttn=le.$to_a(),j.rtt_format=ye,j.rct_format=T,j.rttn_format=R},-2),V(h[0],"RTTN",["RTT1","RTT2","RTT3","RTT4","RTT5","RTT6"].$freeze()),C.$attr_reader("categories"),H(C,"$roll_command",function(m,x){var Z,S=this,le=p,ye=p;return U(["RTT",S.rtt]["$include?"](Z=x))?S.$format_skill(S.rtt_format,S.$roll_skill(m)):U(["RCT",S.rct]["$include?"](Z))?(le=S.$roll_category(m),S.$format(S.rct_format,D(["category_dice","category_name"],{category_dice:le.$dice(),category_name:le.$name()}))):U(ye=c("RTTN").$index(Z))||U(ye=S.rttn.$index(Z))?S.$format_skill(S.rttn_format,S.categories["$[]"](ye).$roll(m)):p},2),H(C,"$roll_category",function(m){return this.categories["$[]"](se(m.$roll_once(6),1))},1),H(C,"$roll_skill",function(m){return this.$roll_category(m).$roll(m)},1),H(C,"$prefixes",function(){var m=this;return ue(["RTT[1-6]?","RCT",m.rtt,m.rct],m.rttn).$compact()},0),C.$private(),H(C,"$format_skill",function(m,x){return this.$format(m,D(["category_dice","row_dice","category_name","skill_name","text"],{category_dice:x.$category_dice(),row_dice:x.$row_dice(),category_name:x.$category_name(),skill_name:x.$name(),text:x.$to_s()}))},2)},Opal.modules["bcdice/dice_table/table"]=function(a){var V,se,M,G,z,A,N,J,H,y=[],w=a.nil,p=a.module,u=a.klass,k=a.hash2,v=a.defs,D=a.truthy,_=a.def,F=a.rb_minus;return V=y,se=H=[p(y[0],"BCDice")].concat(V),M=J=[p(H[0],"DiceTable")].concat(se),z=[G=u(J[0],null,"Table")].concat(M),A=a.$r(z),(N=G.$$prototype).times=N.sides=N.name=N.items=w,v(G,"$from_i18n",function(g,b){var h=w;return h=A("I18n").$t(g,k(["locale"],{locale:b})),this.$new(h["$[]"]("name"),h["$[]"]("type"),h["$[]"]("items"))},2),_(G,"$initialize",function(g,b,C){var h=this,c=w;return h.name=g,h.items=C.$freeze(),c=/(\d+)D(\d+)/i.$match(b),D(c)||h.$raise(A("ArgumentError"),"Unexpected table type: "+b),h.times=c["$[]"](1).$to_i(),h.sides=c["$[]"](2).$to_i()},3),_(G,"$roll",function(g){var C,b=this;return C=g.$roll_sum(b.times,b.sides),b.$choice(C)},1),_(G,"$choice",function(g){var C,b=this;return C=F(g,b.times),A("RollResult").$new(b.name,g,b.items["$[]"](C))},1)},Opal.modules["bcdice/dice_table"]=function(a){var y=a.top;return y.$require("bcdice/dice_table/roll_result"),y.$require("bcdice/dice_table/chain_table"),y.$require("bcdice/dice_table/d66_grid_table"),y.$require("bcdice/dice_table/d66_half_grid_table"),y.$require("bcdice/dice_table/d66_one_third_table"),y.$require("bcdice/dice_table/d66_left_range_table"),y.$require("bcdice/dice_table/d66_parity_table"),y.$require("bcdice/dice_table/d66_range_table"),y.$require("bcdice/dice_table/d66_table"),y.$require("bcdice/dice_table/range_table"),y.$require("bcdice/dice_table/sai_fic_skill_table"),y.$require("bcdice/dice_table/table")},Opal.modules["bcdice/enum"]=function(a){var v,oe,L,_,y=[],p=a.module,u=a.const_set;return v=y,oe=_=[p(y[0],"BCDice")].concat(v),L=[p(_[0],"D66SortType")].concat(oe),u(L[0],"NO_SORT","no_sort"),u(L[0],"ASC","asc"),u(L[0],"DESC","desc"),function(F,oe){var L=[p(F,"RoundType")].concat(oe);return u(L[0],"CEIL","ceil"),u(L[0],"FLOOR","floor"),u(L[0],"ROUND","round")}(_[0],_)},Opal.modules["bcdice/translate"]=function(a){var _,L,H,U,se,oe,y=[],w=a.nil,p=a.module,u=a.hash2,v=a.def;return _=y,L=oe=[p(y[0],"BCDice")].concat(_),U=[H=p(oe[0],"Translate")].concat(L),se=a.$r(U),v(H,"$translate",function(J,K){var ee,M=this;if(null==M.locale&&(M.locale=w),null==K)K=u([],{});else if(!K.$$is_hash)throw a.ArgumentError.$new("expected kwargs");return ee=a.kwrestargs(K,{}),se("I18n").$translate(J,u(["locale","raise"],{locale:M.locale,raise:!0}).$merge(a.to_hash(ee)))},-2)},Opal.modules["bcdice/result"]=function(a){var oe,se,ee,ue,K,L,y=[],w=a.nil,u=a.klass,k=a.send,v=a.to_a,D=a.rb_minus,_=a.def;return oe=y,se=L=[(0,a.module)(y[0],"BCDice")].concat(oe),[ue=u(L[0],null,"Result")].concat(se),(K=ue.$$prototype).secret=K.success=K.failure=K.critical=K.fumble=w,_(ee=a.get_singleton_class(ue),"$success",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$failure",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$critical",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"critical=",v(g=[!0])),D(g.length,1),k(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$fumble",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"fumble=",v(g=[!0])),D(g.length,1),k(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$nothing",function(){return"nothing"},0),_(ue,"$initialize",function(M){var G=this;return null==M&&(M=w),G.text=M,G.rands=w,G.detailed_rands=w,G.secret=!1,G.success=!1,G.failure=!1,G.critical=!1,G.fumble=!1},-1),ue.$attr_accessor("text","rands","detailed_rands"),ue.$attr_writer("secret","success","failure","critical","fumble"),_(ue,"$secret?",function(){return this.secret},0),_(ue,"$success?",function(){return this.success},0),_(ue,"$failure?",function(){return this.failure},0),_(ue,"$critical?",function(){return this.critical},0),_(ue,"$fumble?",function(){return this.fumble},0),_(ue,"$condition=",function(M){return this.success=M,this.failure=M["$!"]()},1)},Opal.modules["racc/parser"]=function(a){var b,h,c,w=[],p=a.$r(w),u=a.nil,k=a.$$$,v=a.module,D=a.klass,_=a.truthy,F=a.const_set,oe=a.defs,V=a.gvars,L=a.rb_lt,H=a.send,U=a.to_a,se=a.rb_minus,ue=a.def,J=a.to_ary,K=a.neqeq,ee=a.rb_plus,M=a.eqeq,G=a.rb_ge,z=a.rb_gt,A=a.eqeqeq,N=a.rb_le,P=a.rb_times;return b=w,h=[v(w[0],"Racc")].concat(b),c=a.$r(h),D(h[0],c("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":u)||F(w[0],"ParseError",k(p("Racc"),"ParseError")),function(g,b){var x,S,Z,le,ye,c=[v(g,"Racc")].concat(b),l=a.$r(c);return _(l("Racc_No_Extensions","skip_raise")?"constant":u)||F(c[0],"Racc_No_Extensions",!1),x=c,Z=[S=D(c[0],null,"Parser")].concat(x),le=a.$r(Z),(ye=S.$$prototype).yydebug=ye.racc_debug_out=ye.racc_error_status=ye.racc_t=ye.racc_vstack=ye.racc_val=ye.racc_state=ye.racc_tstack=u,F(Z[0],"Racc_Runtime_Version","1.4.6"),F(Z[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(Z[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(Z[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(Z[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(Z[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(Z[0],"Racc_Runtime_Core_Version",le("Racc_Runtime_Core_Version_R")),F(Z[0],"Racc_Runtime_Core_Revision",le("Racc_Runtime_Core_Revision_R")),F(Z[0],"Racc_Runtime_Type","ruby"),oe(le("Parser"),"$racc_runtime_type",function(){return le("Racc_Runtime_Type")},0),ue(S,"$_racc_setup",function(){var R,ie,j=this,ve=u,de=u,we=u;return null==V.stderr&&(V.stderr=u),_(k(j.$class(),"Racc_debug_parser"))||(j.yydebug=!1),_(null!=(R=j.yydebug)&&R!==u?"instance-variable":u)||(j.yydebug=!1),_(j.yydebug)&&(_(null!=(ie=j.racc_debug_out)&&ie!==u?"instance-variable":u)||(j.racc_debug_out=V.stderr),j.racc_debug_out=_(ve=j.racc_debug_out)?ve:V.stderr),de=k(j.$class(),"Racc_arg"),_(L(de.$size(),14))&&(H(de,"[]=",U(we=[13,!0])),se(we.length,1)),de},0),ue(S,"$_racc_init_sysvars",function(){var R=this;return R.racc_state=[0],R.racc_tstack=[],R.racc_vstack=[],R.racc_t=u,R.racc_val=u,R.racc_read_next=!0,R.racc_user_yyerror=!1,R.racc_error_status=0},0),ue(S,"$do_parse",function(){return this.$__send__(le("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),ue(S,"$next_token",function(){return this.$raise(le("NotImplementedError"),this.$class()+"#next_token is not defined")},0),ue(S,"$_racc_do_parse_rb",function(R,ie){var j,we=u,ce=u,he=u,B=u,ne=u,q=u,pe=u,$e=u;return j=J(R),we=null==j[0]?u:j[0],ce=null==j[1]?u:j[1],he=null==j[2]?u:j[2],B=null==j[3]?u:j[3],ne=null==j[10]?u:j[10],this.$_racc_init_sysvars(),q=pe=$e=u,H(this,"catch",["racc_end_parse"],function me(){var De,Me,Pe=null==me.$$s?this:me.$$s,Ve=u;for(null==Pe.racc_state&&(Pe.racc_state=u),null==Pe.racc_read_next&&(Pe.racc_read_next=u),null==Pe.racc_t&&(Pe.racc_t=u),null==Pe.yydebug&&(Pe.yydebug=u),null==Pe.racc_val&&(Pe.racc_val=u);_(!0);)for(_($e=B["$[]"](Pe.racc_state["$[]"](-1)))?(_(Pe.racc_read_next)&&K(Pe.racc_t,0)&&(Me=Pe.$next_token(),De=J(Me),q=null==De[0]?u:De[0],Pe.racc_val=null==De[1]?u:De[1],Pe.racc_t=_(q)?_(Ve=ne["$[]"](q))?Ve:1:0,_(Pe.yydebug)&&Pe.$racc_read_token(Pe.racc_t,q,Pe.racc_val),Pe.racc_read_next=!1),$e=ee($e,Pe.racc_t),_(G($e,0))&&_(pe=we["$[]"]($e))&&M(ce["$[]"]($e),Pe.racc_state["$[]"](-1))||(pe=he["$[]"](Pe.racc_state["$[]"](-1)))):pe=he["$[]"](Pe.racc_state["$[]"](-1));_(pe=Pe.$_racc_evalact(pe,R)););},{$$arity:0,$$s:this})},2),ue(S,"$yyparse",function(R,ie){return this.$__send__(le("Racc_YY_Parse_Method"),R,ie,this.$_racc_setup(),!0)},2),ue(S,"$_racc_yyparse_rb",function(R,ie,j,ve){var de,he=u,B=u,O=u,ne=u,pe=u,$e=u,me=u;return de=J(j),he=null==de[0]?u:de[0],B=null==de[1]?u:de[1],O=null==de[2]?u:de[2],ne=null==de[3]?u:de[3],pe=null==de[10]?u:de[10],this.$_racc_init_sysvars(),$e=u,me=u,H(this,"catch",["racc_end_parse"],function Te(){var Pe=null==Te.$$s?this:Te.$$s;for(null==Pe.racc_state&&(Pe.racc_state=u);!_(me=ne["$[]"](Pe.racc_state["$[]"](-1)));)for(;_($e=Pe.$_racc_evalact(O["$[]"](Pe.racc_state["$[]"](-1)),j)););return H(R,"__send__",[ie],function Ve(Qe,Mt){var gt=null==Ve.$$s?this:Ve.$$s,mt=u,rr=u;for(null==gt.racc_t&&(gt.racc_t=u),null==gt.racc_state&&(gt.racc_state=u),null==gt.racc_read_next&&(gt.racc_read_next=u),null==Qe&&(Qe=u),null==Mt&&(Mt=u),gt.racc_t=_(Qe)?_(mt=pe["$[]"](Qe))?mt:1:0,gt.racc_val=Mt,gt.racc_read_next=!1,me=ee(me,gt.racc_t),_(G(me,0))&&_($e=he["$[]"](me))&&M(B["$[]"](me),gt.racc_state["$[]"](-1))||($e=O["$[]"](gt.racc_state["$[]"](-1)));_($e=gt.$_racc_evalact($e,j)););for(;_(_(mt=_(rr=(me=ne["$[]"](gt.racc_state["$[]"](-1)))["$!"]())?rr:gt.racc_read_next["$!"]())?mt:gt.racc_t["$=="](0));)for(_(me)&&_(me=ee(me,gt.racc_t))&&_(G(me,0))&&_($e=he["$[]"](me))&&M(B["$[]"](me),gt.racc_state["$[]"](-1))||($e=O["$[]"](gt.racc_state["$[]"](-1)));_($e=gt.$_racc_evalact($e,j)););},{$$arity:2,$$s:Pe})},{$$arity:0,$$s:this})},4),ue(S,"$_racc_evalact",function(R,ie){var j,O,de=this,we=u,ce=u,B=u,ne=u,q=u,pe=u,$e=u;if(we=null==(j=J(ie))[0]?u:j[0],ce=null==j[1]?u:j[1],B=null==j[3]?u:j[3],O=null==j[11]?u:j[11],ne=null==j[12]?u:j[12],_(z(R,0))&&_(L(R,O)))_(z(de.racc_error_status,0))&&(M(de.racc_t,1)||(de.racc_error_status=se(de.racc_error_status,1))),de.racc_vstack.$push(de.racc_val),de.racc_state.$push(R),de.racc_read_next=!0,_(de.yydebug)&&(de.racc_tstack.$push(de.racc_t),de.$racc_shift(de.racc_t,de.racc_tstack,de.racc_vstack));else if(_(L(R,0))&&_(z(R,ne["$-@"]()))){if(q=H(de,"catch",["racc_jump"],function me(){var Te=null==me.$$s?this:me.$$s;return null==Te.racc_state&&(Te.racc_state=u),Te.racc_state.$push(Te.$_racc_do_reduce(ie,R)),!1},{$$arity:0,$$s:de}),_(q)){if(A(1,pe=q))return de.racc_user_yyerror=!0,ne["$-@"]();if(A(2,pe))return O;de.$raise("[Racc Bug] unknown jump code")}}else if(M(R,O))_(de.yydebug)&&de.$racc_accept(),de.$throw("racc_end_parse",de.racc_vstack["$[]"](0));else{if(M(R,ne["$-@"]())){for(A(0,pe=de.racc_error_status)?_(ie["$[]"](21))||de.$on_error(de.racc_t,de.racc_val,de.racc_vstack):A(3,pe)&&(M(de.racc_t,0)&&de.$throw("racc_end_parse",u),de.racc_read_next=!0),de.racc_user_yyerror=!1,de.racc_error_status=3;_(!0)&&!(_($e=B["$[]"](de.racc_state["$[]"](-1)))&&($e=ee($e,1),_(G($e,0))&&_(R=we["$[]"]($e))&&M(ce["$[]"]($e),de.racc_state["$[]"](-1))));)_(N(de.racc_state.$size(),1))&&de.$throw("racc_end_parse",u),de.racc_state.$pop(),de.racc_vstack.$pop(),_(de.yydebug)&&(de.racc_tstack.$pop(),de.$racc_e_pop(de.racc_state,de.racc_tstack,de.racc_vstack));return R}de.$raise("[Racc Bug] unknown action "+R.$inspect())}return _(de.yydebug)&&de.$racc_next_state(de.racc_state["$[]"](-1),de.racc_state),u},2),ue(S,"$_racc_do_reduce",function(R,ie){var j,ne,pe,Pe,Ve,Qe,gt,de=this,ce=u,he=u,B=u,O=u,q=u,$e=u,me=u,Te=u,De=u,Me=u,Mt=u,Bt=u,Pt=u,mt=u;return ce=null==(j=J(R))[4]?u:j[4],he=null==j[5]?u:j[5],B=null==j[6]?u:j[6],O=null==j[7]?u:j[7],ne=null==j[8]?u:j[8],q=null==j[9]?u:j[9],pe=null==j[13]?u:j[13],$e=de.racc_state,me=de.racc_vstack,Te=de.racc_tstack,De=P(ie,-3),Me=q["$[]"](De),Pe=q["$[]"](ee(De,1)),Ve=q["$[]"](ee(De,2)),Qe=[],_(de.yydebug)&&(Mt=Te["$[]"](Me["$-@"](),Me)),Bt=me["$[]"](Me["$-@"](),Me),_(de.yydebug)&&(Pt=[Me["$-@"](),Me,Qe],H(Te,"[]=",U(Pt)),se(Pt.length,1)),Pt=[Me["$-@"](),Me,Qe],H(me,"[]=",U(Pt)),se(Pt.length,1),Pt=[Me["$-@"](),Me,Qe],H($e,"[]=",U(Pt)),se(Pt.length,1),_(pe)?me.$push(de.$__send__(Ve,Bt,me,Bt["$[]"](0))):me.$push(de.$__send__(Ve,Bt,me)),Te.$push(Pe),_(de.yydebug)&&de.$racc_reduce(Mt,Pe,Te,me),gt=se(Pe,ne),_(De=O["$[]"](gt))&&(De=ee(De,$e["$[]"](-1)),_(G(De,0))&&_(mt=ce["$[]"](De))&&M(he["$[]"](De),gt))?mt:B["$[]"](gt)},2),ue(S,"$on_error",function(R,ie,j){var de;return this.$raise(le("ParseError"),this.$sprintf("\nparse error on value %s (%s)",ie.$inspect(),_(de=this.$token_to_str(R))?de:"?"))},3),ue(S,"$yyerror",function(){return this.$throw("racc_jump",1)},0),ue(S,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),ue(S,"$yyerrok",function(){return this.racc_error_status=0},0),ue(S,"$racc_read_token",function(R,ie,j){var ve=this;return ve.racc_debug_out.$print("read    "),ve.racc_debug_out.$print(ie.$inspect(),"(",ve.$racc_token2str(R),") "),ve.racc_debug_out.$puts(j.$inspect()),ve.racc_debug_out.$puts()},3),ue(S,"$racc_shift",function(R,ie,j){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(R)),this.$racc_print_stacks(ie,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_reduce",function(R,ie,j,ve){var de=this,we=u;return(we=de.racc_debug_out).$print("reduce "),_(R["$empty?"]())?we.$print(" <none>"):H(R,"each",[],function ce(he){return null==he&&(he=u),we.$print(" ",(null==ce.$$s?this:ce.$$s).$racc_token2str(he))},{$$arity:1,$$s:de}),we.$puts(" --\x3e "+de.$racc_token2str(ie)),de.$racc_print_stacks(j,ve),de.racc_debug_out.$puts()},4),ue(S,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),ue(S,"$racc_e_pop",function(R,ie,j){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(R),this.$racc_print_stacks(ie,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_next_state",function(R,ie){var j=this;return j.racc_debug_out.$puts("goto    "+R),j.$racc_print_states(ie),j.racc_debug_out.$puts()},2),ue(S,"$racc_print_stacks",function(R,ie){var ve=u;return(ve=this.racc_debug_out).$print("        ["),H(R,"each_index",[],function de(we){return null==we&&(we=u),ve.$print(" (",(null==de.$$s?this:de.$$s).$racc_token2str(R["$[]"](we))," ",ie["$[]"](we).$inspect(),")")},{$$arity:1,$$s:this}),ve.$puts(" ]")},2),ue(S,"$racc_print_states",function(R){var j=u;return(j=this.racc_debug_out).$print("        ["),H(R,"each",[],function(de){return null==de&&(de=u),j.$print(" ",de)},1),j.$puts(" ]")},1),ue(S,"$racc_token2str",function(R){var j;return _(j=k(this.$class(),"Racc_token_to_s_table")["$[]"](R))?j:this.$raise("[Racc Bug] can't convert token "+R+" to string")},1),ue(S,"$token_to_str",function(R){return k(this.$class(),"Racc_token_to_s_table")["$[]"](R)},1)}(w[0],w)},Opal.modules["bcdice/arithmetic/node"]=function(a){var ue,M,N,c,l,g,b,z,K,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.def,D=a.send2,_=a.find_super,F=a.eqeq,oe=a.const_set,V=a.eqeqeq,L=a.rb_divide,H=a.truthy,U=a.alias;return ue=y,M=K=[u(y[0],"BCDice")].concat(ue),N=z=[u(K[0],"Arithmetic")].concat(M),g=[u(z[0],"Node")].concat(N),b=a.$r(g),(l=(c=k(g[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=w,v(c,"$initialize",function(m,x,S){var Z=this;return Z.lhs=m,Z.op=x,Z.rhs=S},3),v(c,"$eval",function(m){var Z,x=this,S=w;return S=x.lhs.$eval(m),Z=x.rhs.$eval(m),S.$send(x.op,Z)},1),v(c,"$output",function(){var m=this;return""+m.lhs.$output()+m.op+m.rhs.$output()},0),v(c,"$s_exp",function(){var m=this;return"("+m.$op_for_s_exp()+" "+m.lhs.$s_exp()+" "+m.rhs.$s_exp()+")"},0),v(c,"$op_for_s_exp",function(){return this.op},0),function(C,h,c){var l=k(C,h,"DivideBase"),f=[l].concat(c),m=a.$r(f),x=l.$$prototype;x.lhs=x.rhs=x.op=w,v(l,"$initialize",function S(Z,le){return delete S.$$p,D(this,_(this,"initialize",S,!1,!0),"initialize",[Z,"/",le],null)},2),v(l,"$eval",function(Z){var ye,T;return ye=this.lhs.$eval(Z),T=this.rhs.$eval(Z),F(T,0)&&this.$raise(m("ZeroDivisionError")),this.$divide_and_round(ye,T,Z)},1),v(l,"$output",function S(){var Z=S.$$p||w;return delete S.$$p,""+D(this,_(this,"output",S,!1,!0),"output",[],Z)+this.$rounding_method()},0),l.$private(),v(l,"$rounding_method",function(){return p(this.$class(),"ROUNDING_METHOD")},0),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),v(l,"$divide_and_round",function(Z,le,ye){return this.$raise(m("NotImplementedError"))},3)}(g[0],b("BinaryOp"),g),function(C,h,c){var l=k(C,h,"DivideWithGameSystemDefault"),f=[l].concat(c),m=a.$r(f);oe(f[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(S,Z,le){var ye,T=w;return V(p(m("RoundType"),"CEIL"),ye=le)?L(S.$to_f(),Z).$ceil():V(p(m("RoundType"),"ROUND"),ye)?(T=L(S.$to_f(),Z),H(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()):L(S,Z).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithCeil"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){return L(x.$to_f(),S).$ceil()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithRound"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){var le=w;return le=L(x.$to_f(),S),H(le["$negative?"]())?le.$abs().$round()["$-@"]():le.$round()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithFloor"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){return L(x,S).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h){var c=k(C,null,"Negative");c.$$prototype.body=w,v(c,"$initialize",function(m){return this.body=m},1),v(c,"$eval",function(m){return this.body.$eval(m)["$-@"]()},1),v(c,"$output",function(){return"-"+this.body.$output()},0),v(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(g[0]),function(C,h){var c=k(C,null,"Parenthesis");c.$$prototype.expr=w,v(c,"$initialize",function(m){return this.expr=m},1),v(c,"$eval",function(m){return this.expr.$eval(m)},1),v(c,"$output",function(){return"("+this.expr.$output()+")"},0),v(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(g[0]),function(C,h){var c=k(C,null,"Number");return c.$$prototype.value=w,v(c,"$initialize",function(m){return this.value=m},1),v(c,"$eval",function(m){return this.value},1),v(c,"$output",function(){return this.value.$to_s()},0),U(c,"s_exp","output")}(g[0])},Opal.modules.strscan=function(a){var U,se,ue,J,K,y=[],w=a.nil,u=a.def,k=a.truthy,v=a.eqeqeq,D=a.Opal,_=a.send,F=a.to_a,oe=a.rb_minus,V=a.alias;return U=y,ue=[se=(0,a.klass)(y[0],null,"StringScanner")].concat(U),J=a.$r(ue),(K=se.$$prototype).pos=K.string=K.working=K.matched=K.prev_pos=K.match=w,se.$attr_reader("pos","matched"),u(se,"$initialize",function(M){var G=this;return G.string=M,G.pos=0,G.matched=w,G.working=M,G.match=[]},1),se.$attr_reader("string"),u(se,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)},0),u(se,"$scan",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return null==z?G.matched=w:"object"==typeof z?(G.prev_pos=G.pos,G.pos+=z[0].length,G.working=G.working.substring(z[0].length),G.matched=z[0],G.match=z,z[0]):"string"==typeof z?(G.pos+=z.length,G.working=G.working.substring(z.length),z):w},1),u(se,"$scan_until",function(M){var G=this;M=G.$anchor(M);for(var N,z=G.pos,A=G.working;;){if(N=M.exec(A),z+=1,A=A.substr(1),null!=N)return G.matched=G.string.substr(G.pos,z-G.pos-1+N[0].length),G.match=N,G.prev_pos=z-1,G.pos=z,G.working=A.substr(N[0].length),G.matched;if(0===A.length)return G.match=[],G.matched=w}},1),u(se,"$[]",function(M){var z;if(k(this.match["$empty?"]()))return w;v(J("Symbol"),z=M)?M=M.$to_s():v(J("String"),z)||(M=D["$coerce_to!"](M,J("Integer"),"to_int"));var A=this.match;return M<0&&(M+=A.length),M<0||M>=A.length||null==A[M]?w:A[M]},1),u(se,"$check",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return G.matched=null==z?w:z[0]},1),u(se,"$check_until",function(M){var G=this,z=G.prev_pos,A=G.pos,N=G.$scan_until(M);return N!==w&&(G.matched=N.substr(-1),G.working=G.string.substr(A)),G.prev_pos=z,G.pos=A,N},1),u(se,"$peek",function(M){return this.working.substring(0,M)},1),u(se,"$eos?",function(){return 0===this.working.length},0),u(se,"$exist?",function(M){var z=M.exec(this.working);return null==z?w:0==z.index?0:z.index+1},1),u(se,"$skip",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);if(null==z)return G.match=[],G.matched=w;var A=z[0],N=A.length;return G.matched=A,G.match=z,G.prev_pos=G.pos,G.pos+=N,G.working=G.working.substring(N),N},1),u(se,"$skip_until",function(M){var z=this.$scan_until(M);return z===w?w:(this.matched=z.substr(-1),z.length)},1),u(se,"$get_byte",function(){var M=this,G=w;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,G=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=w,G},0),u(se,"$match?",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return null==z?w:(G.prev_pos=G.pos,z[0].length)},1),u(se,"$pos=",function(M){var G=this;return M<0&&(M+=G.string.$length()),G.pos=M,G.working=G.string.slice(M)},1),u(se,"$matched_size",function(){return this.matched===w?w:this.matched.length},0),u(se,"$post_match",function(){var M=this;return M.matched===w?w:M.string.substr(M.pos)},0),u(se,"$pre_match",function(){var M=this;return M.matched===w?w:M.string.substr(0,M.prev_pos)},0),u(se,"$reset",function(){var M=this;return M.working=M.string,M.matched=w,M.pos=0},0),u(se,"$rest",function(){return this.working},0),u(se,"$rest?",function(){return 0!==this.working.length},0),u(se,"$rest_size",function(){return this.$rest().$size()},0),u(se,"$terminate",function(){var G,M=this;return M.match=w,G=[M.string.$length()],_(M,"pos=",F(G)),G[oe(G.length,1)]},0),u(se,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=w,M.match=w,M},0),V(se,"bol?","beginning_of_line?"),V(se,"getch","get_byte"),se.$private(),u(se,"$anchor",function(M){var G=M.toString().match(/\/([^\/]+)$/);return G=G?G[1]:void 0,new RegExp("^(?:"+M.source+")",G)},1)},Opal.modules["bcdice/normalize"]=function(a){var _,L,oe,y=[],w=a.nil,p=a.module,u=a.eqeqeq,k=a.def,v=a.eqeq;return _=y,oe=[p(y[0],"BCDice")].concat(_),(L=p(oe[0],"Normalize")).$module_function(),k(L,"$comparison_operator",function(U){var se;return u(/<=|=</,se=U)?"<=":u(/>=|=>/,se)?">=":u(/<>|!=|=!/,se)?"!=":u(/</,se)?"<":u(/>/,se)?">":u(/=/,se)?"==":w},1),k(L,"$target_number",function(U){return v(U,"?")?U:U.$to_i()},1)},Opal.modules["bcdice/command/lexer"]=function(a){var L,ue,G,z,A,N,P,K,U,y=a.top,w=[],p=a.nil,u=a.module,k=a.klass,v=a.const_set,D=a.hash2,_=a.truthy,F=a.send,oe=a.def;return y.$require("strscan"),y.$require("bcdice/normalize"),L=w,ue=U=[u(w[0],"BCDice")].concat(L),G=K=[u(U[0],"Command")].concat(ue),A=[z=k(K[0],null,"Lexer")].concat(G),N=a.$r(A),(P=z.$$prototype).scanner=P.notations=p,v(A[0],"SYMBOLS",D(["+","-","*","/","(",")","?","@","#","$"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","?":"QUESTION","@":"AT","#":"SHARP",$:"DOLLAR"}).$freeze()),oe(z,"$initialize",function(b,C){var h,c,f;return b=_(f=(c=(h=b)===p||null==h?p:F(h,"split",[" ",2]))===p||null==c?p:F(c,"first",[]))?f:"",this.scanner=N("StringScanner").$new(b),this.notations=F(C,"map",[],function(x){return null==x&&(x=p),_(x["$is_a?"](N("String")))?N("Regexp").$new(x):x},1)},2),oe(z,"$next_token",function(){try{var b=this,C=p,h=p,l=p,f=p;return _(b.scanner["$eos?"]())?[!1,"$"]:(F(b.notations,"each",[],function m(x){var Z,S=null==m.$$s?this:m.$$s;if(null==S.scanner&&(S.scanner=p),null==x&&(x=p),Z=S.scanner.$scan(x),!_(Z))return p;a.ret(["NOTATION",Z])},{$$arity:1,$$s:b}),_(C=b.scanner.$scan(/\d+/))?["NUMBER",C.$to_i()]:_(h=b.scanner.$scan(/[<>!=]+/))?(h=N("Normalize").$comparison_operator(h),[_(h)?"CMP_OP":"ILLEGAL",h]):(l=b.scanner.$getch().$upcase(),[_(f=N("SYMBOLS")["$[]"](l))?f:l.$to_sym(),l]))}catch(m){if(m===a.returner)return m.$v;throw m}},0),oe(z,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/command/parsed"]=function(a){var F,H,K,ee,M,G,z,se,V,y=[],w=a.nil,p=a.module,u=a.klass,k=a.def,v=a.truthy,D=a.eqeqeq;return F=y,H=V=[p(y[0],"BCDice")].concat(F),K=se=[p(V[0],"Command")].concat(H),M=[ee=u(se[0],null,"Parsed")].concat(K),G=a.$r(M),(z=ee.$$prototype).question_target=z.critical=z.fumble=z.dollar=z.modify_number=z.target_number=z.prefix_number=z.command=z.suffix_number=z.cmp_op=w,ee.$attr_accessor("command"),ee.$attr_accessor("prefix_number"),ee.$attr_accessor("suffix_number"),ee.$attr_accessor("critical"),ee.$attr_accessor("fumble"),ee.$attr_accessor("dollar"),ee.$attr_accessor("modify_number"),ee.$attr_accessor("cmp_op"),ee.$attr_accessor("target_number"),ee.$attr_writer("question_target"),k(ee,"$initialize",function(){var N=this;return N.prefix_number=w,N.suffix_number=w,N.critical=w,N.fumble=w,N.dollar=w,N.cmp_op=w,N.target_number=w,N.question_target=!1},0),k(ee,"$question_target?",function(){return this.question_target},0),k(ee,"$to_s",function(N){var l,P=this,g=w,b=w,C=w,h=w,c=w;return null==N&&(N="after_command"),g=v(P.critical)?"@"+P.critical:w,b=v(P.fumble)?"#"+P.fumble:w,C=v(P.dollar)?"$"+P.dollar:w,h=G("Format").$modifier(P.modify_number),c=v(P.question_target)?"?":P.target_number,D("after_command",l=N)?[P.prefix_number,P.command,P.suffix_number,g,b,C,h,P.cmp_op,c].$join():D("after_modify_number",l)?[P.prefix_number,P.command,P.suffix_number,h,g,b,C,P.cmp_op,c].$join():D("after_target_number",l)?[P.prefix_number,P.command,P.suffix_number,h,P.cmp_op,c,g,b,C].$join():w},-1)},Opal.modules["bcdice/command/parser"]=function(a){var G,P,l,S,Z,le,ye,T,R,ie,j,ve,ce,f,m,x,O,b,C,A,y=a.top,w=[],p=a.$r(w),u=a.nil,k=a.$$$,v=a.klass,D=a.module,_=a.hash2,F=a.send2,oe=a.find_super,V=a.def,L=a.send,H=a.to_a,U=a.rb_minus,se=a.eqeq,ue=a.hash,J=a.const_set,K=a.truthy,ee=a.to_ary;return y.$require("racc/parser.rb"),y.$require("bcdice/arithmetic/node"),y.$require("bcdice/command/lexer"),y.$require("bcdice/command/parsed"),v(k(p("BCDice"),"Command"),k(p("Racc"),"Parser"),"Parser"),G=w,P=A=[D(w[0],"BCDice")].concat(G),b=[D(A[0],"Command")].concat(P),C=a.$r(b),l=b,m=[f=v(b[0],k(C("Racc"),"Parser"),"Parser")].concat(l),x=a.$r(m),(O=f.$$prototype).notations=O.lexer=O.modifier=O.suffix_number=O.prefix_number=O.need_suffix_number=O.need_prefix_number=O.critical=O.fumble=O.dollar=O.allowed_cmp_op=O.question_target=u,V(f,"$initialize",function ne(q,pe){var $e,me,Te,De,Pe=this;if(delete ne.$$p,$e=a.slice.call(arguments),null==(me=a.extract_kwargs($e)))me=_([],{});else if(!me.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(Te=$e,!a.hasOwnProperty.call(me.$$smap,"round_type"))throw a.ArgumentError.$new("missing keyword: round_type");return De=me.$$smap.round_type,F(Pe,oe(Pe,"initialize",ne,!1,!0),"initialize",[],null),Pe.notations=Te,Pe.round_type=De,Pe.prefix_number=!1,Pe.suffix_number=!1,Pe.need_prefix_number=!1,Pe.need_suffix_number=!1,Pe.modifier=!0,Pe.critical=!1,Pe.fumble=!1,Pe.dollar=!1,Pe.allowed_cmp_op=[u,">=",">","<=","<","==","!="],Pe.question_target=!1},-2),V(f,"$disable_modifier",function(){return this.modifier=!1,this},0),V(f,"$enable_prefix_number",function(){return this.prefix_number=!0,this},0),V(f,"$enable_suffix_number",function(){return this.suffix_number=!0,this},0),V(f,"$has_prefix_number",function(){var q=this;return q.prefix_number=!0,q.need_prefix_number=!0,q},0),V(f,"$has_suffix_number",function(){var q=this;return q.suffix_number=!0,q.need_suffix_number=!0,q},0),V(f,"$enable_critical",function(){return this.critical=!0,this},0),V(f,"$enable_fumble",function(){return this.fumble=!0,this},0),V(f,"$enable_dollar",function(){return this.dollar=!0,this},0),V(f,"$restrict_cmp_op_to",function(q){var pe,me=this;return pe=a.slice.call(arguments),me.allowed_cmp_op=pe,me},-1),V(f,"$enable_question_target",function(){return this.question_target=!0,this},0),V(f,"$parse",function(q){try{return this.lexer=x("Lexer").$new(q,this.notations),this.$do_parse()}catch($e){if(!a.rescue($e,[x("ParseError"),x("ZeroDivisionError")]))throw $e;try{return u}finally{a.pop_exception()}}},1),f.$private(),V(f,"$parsed",function(q,pe,$e,me){return L(x("Parsed").$new(),"tap",[],function De(Me){var Pe,Ve,Qe,Mt,Bt,Pt,gt=null==De.$$s?this:De.$$s,mt=u;return null==gt.round_type&&(gt.round_type=u),null==Me&&(Me=u),mt=[q["$[]"]("command")],L(Me,"command=",H(mt)),U(mt.length,1),mt=[(Pe=q["$[]"]("prefix"),Pe===u||null==Pe?u:L(Pe,"eval",[gt.round_type]))],L(Me,"prefix_number=",H(mt)),U(mt.length,1),mt=[(Ve=q["$[]"]("suffix"),Ve===u||null==Ve?u:L(Ve,"eval",[gt.round_type]))],L(Me,"suffix_number=",H(mt)),U(mt.length,1),mt=[(Qe=pe["$[]"]("critical"),Qe===u||null==Qe?u:L(Qe,"eval",[gt.round_type]))],L(Me,"critical=",H(mt)),U(mt.length,1),mt=[(Mt=pe["$[]"]("fumble"),Mt===u||null==Mt?u:L(Mt,"eval",[gt.round_type]))],L(Me,"fumble=",H(mt)),U(mt.length,1),mt=[(Bt=pe["$[]"]("dollar"),Bt===u||null==Bt?u:L(Bt,"eval",[gt.round_type]))],L(Me,"dollar=",H(mt)),U(mt.length,1),mt=[$e.$eval(gt.round_type)],L(Me,"modify_number=",H(mt)),U(mt.length,1),mt=[me["$[]"]("cmp_op")],L(Me,"cmp_op=",H(mt)),U(mt.length,1),se(me["$[]"]("target"),"?")?(L(Me,"question_target=",H(mt=[!0])),U(mt.length,1),L(Me,"target_number=",H(mt=[0])),mt[U(mt.length,1)]):(L(Me,"question_target=",H(mt=[!1])),U(mt.length,1),mt=[(Pt=me["$[]"]("target"),Pt===u||null==Pt?u:L(Pt,"eval",[gt.round_type]))],L(Me,"target_number=",H(mt)),mt[U(mt.length,1)])},{$$arity:1,$$s:this})},4),V(f,"$next_token",function(){return this.lexer.$next_token()},0),S=[6,6,6,6,7,28,29,17,18,5,5,5,5,6,26,12,4,45,17,18,10,11,5,10,11,6,23,24,25,26,17,18,6,20,5,33,34,17,18,6,35,5,28,29,17,18,6,u,5,36,37,17,18,6,u,5,36,37,17,18,6,u,5,36,37,17,18,6,u,5,33,34,17,18,6,u,5,36,37,17,18,6,u,5,36,37,17,18,6,u,5,36,37,17,18,6,u,5,36,37,17,18,6,u,5,u,u,17,18,6,u,5,u,u,17,18,u,u,5,23,24,25,26,56,54,55,57],Z=[0,4,26,12,1,21,21,26,26,0,4,26,12,5,21,3,0,26,5,5,8,8,5,2,2,10,8,8,8,8,10,10,11,7,10,14,14,11,11,17,14,11,9,9,17,17,18,u,17,15,15,18,18,23,u,18,30,30,23,23,24,u,23,31,31,24,24,25,u,24,44,44,25,25,28,u,25,47,47,28,28,29,u,28,48,48,29,29,33,u,29,49,49,33,33,34,u,33,50,50,34,34,36,u,34,u,u,36,36,37,u,36,u,u,37,37,u,u,37,27,27,27,27,52,52,52,52],le=[-2,4,16,-3,-1,11,u,33,13,35,23,30,1,u,28,40,u,37,44,u,u,-2,u,51,58,65,0,106,72,79,47,54,u,86,93,u,100,107,u,u,u,u,u,u,63,u,u,68,75,82,89,u,120,u,u,u,u,u],ye=[-35,-35,-8,-35,-7,-35,-34,-35,-16,-8,-35,-35,-5,-6,-35,-21,-24,-35,-35,-32,58,-16,-3,-35,-35,-35,-35,-16,-35,-35,-12,-13,-4,-35,-35,-33,-35,-35,-30,-31,-1,-9,-10,-11,-17,-18,-2,-14,-15,-19,-20,-22,-25,-23,-26,-27,-28,-29],T=[30,31,38,39,14,8,1,22,41,42,43,9,27,2,53,u,u,21,47,48,40,51,52,49,50,44,46,3,u,u,u,13,u,u,u,u,u,u,u,32],R=[8,8,7,7,9,3,1,5,7,7,7,4,3,2,10,u,u,4,8,8,5,7,7,8,8,9,5,6,u,u,u,6,u,u,u,u,u,u,u,6],ie=[u,6,13,3,9,-1,27,-15,-10,-1,-38],j=[u,u,u,u,u,u,19,16,15,u,u],ve=[0,0,"racc_error",4,20,"_reduce_1",4,20,"_reduce_2",3,20,"_reduce_3",3,21,"_reduce_4",2,21,"_reduce_5",2,21,"_reduce_6",1,21,"_reduce_7",0,22,"_reduce_8",3,22,"_reduce_9",3,22,"_reduce_10",3,22,"_reduce_11",2,23,"_reduce_12",2,23,"_reduce_13",3,23,"_reduce_14",3,23,"_reduce_15",0,24,"_reduce_16",2,24,"_reduce_17",2,24,"_reduce_18",3,28,"_reduce_19",3,28,"_reduce_20",1,28,"_reduce_none",3,27,"_reduce_22",4,27,"_reduce_23",1,27,"_reduce_none",0,29,"_reduce_25",1,29,"_reduce_26",1,29,"_reduce_27",1,29,"_reduce_28",1,29,"_reduce_29",2,26,"_reduce_30",2,26,"_reduce_31",1,26,"_reduce_none",3,25,"_reduce_33",1,25,"_reduce_34"],ce=ue(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12,"AT",13,"SHARP",14,"DOLLAR",15,"CMP_OP",16,"QUESTION",17,"NOTATION",18),J(m[0],"Racc_arg",[S,Z,ye,le,T,R,j,ie,19,ve,ce,58,35,!0]),J(m[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","AT","SHARP","DOLLAR","CMP_OP","QUESTION","NOTATION","$start","expr","notation","option","modifier","target","term","unary","mul","add","round_type"]),J(m[0],"Racc_debug_parser",!1),V(f,"$_reduce_1",function(q,pe,$e){var me;return K(this.modifier)||this.$raise(x("ParseError")),me=ee(q),this.$parsed(null==me[0]?u:me[0],null==me[1]?u:me[1],null==me[2]?u:me[2],null==me[3]?u:me[3])},3),V(f,"$_reduce_2",function(q,pe,$e){var me;return K(this.modifier)||this.$raise(x("ParseError")),me=ee(q),this.$parsed(null==me[0]?u:me[0],null==me[2]?u:me[2],null==me[1]?u:me[1],null==me[3]?u:me[3])},3),V(f,"$_reduce_3",function(q,pe,$e){var me,Ve;return Ve=null==(me=ee(q))[2]?u:me[2],this.$parsed(null==me[0]?u:me[0],null==me[1]?u:me[1],k(k(x("Arithmetic"),"Node"),"Number").$new(0),Ve)},3),V(f,"$_reduce_4",function(q,pe,$e){return K(this.prefix_number)&&K(this.suffix_number)||this.$raise(x("ParseError")),_(["command","prefix","suffix"],{command:q["$[]"](1),prefix:q["$[]"](0),suffix:q["$[]"](2)})},3),V(f,"$_reduce_5",function(q,pe,$e){return K(this.prefix_number)||this.$raise(x("ParseError")),K(this.need_suffix_number)&&this.$raise(x("ParseError")),_(["command","prefix"],{command:q["$[]"](1),prefix:q["$[]"](0)})},3),V(f,"$_reduce_6",function(q,pe,$e){return K(this.suffix_number)||this.$raise(x("ParseError")),K(this.need_prefix_number)&&this.$raise(x("ParseError")),_(["command","suffix"],{command:q["$[]"](0),suffix:q["$[]"](1)})},3),V(f,"$_reduce_7",function(q,pe,$e){return(K(this.need_prefix_number)||K(this.need_suffix_number))&&this.$raise(x("ParseError")),_(["command"],{command:q["$[]"](0)})},3),V(f,"$_reduce_8",function(q,pe,$e){return _([],{})},3),V(f,"$_reduce_9",function(q,pe,$e){var me,Ve,Qe,Me=u;return Me=null==(me=ee(q))[0]?u:me[0],Ve=null==me[2]?u:me[2],K(this.critical)&&K(Me["$[]"]("critical")["$nil?"]())||this.$raise(x("ParseError")),L(Me,"[]=",H(Qe=["critical",Ve])),U(Qe.length,1),Me},3),V(f,"$_reduce_10",function(q,pe,$e){var me,Ve,Qe,Me=u;return Me=null==(me=ee(q))[0]?u:me[0],Ve=null==me[2]?u:me[2],K(this.fumble)&&K(Me["$[]"]("fumble")["$nil?"]())||this.$raise(x("ParseError")),L(Me,"[]=",H(Qe=["fumble",Ve])),U(Qe.length,1),Me},3),V(f,"$_reduce_11",function(q,pe,$e){var me,Ve,Qe,Me=u;return Me=null==(me=ee(q))[0]?u:me[0],Ve=null==me[2]?u:me[2],K(this.dollar)&&K(Me["$[]"]("dollar")["$nil?"]())||this.$raise(x("ParseError")),L(Me,"[]=",H(Qe=["dollar",Ve])),U(Qe.length,1),Me},3),V(f,"$_reduce_12",function(q,pe,$e){return q["$[]"](1)},3),V(f,"$_reduce_13",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"Negative").$new(q["$[]"](1))},3),V(f,"$_reduce_14",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"+",q["$[]"](2))},3),V(f,"$_reduce_15",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"-",q["$[]"](2))},3),V(f,"$_reduce_16",function(q,pe,$e){return K(this.allowed_cmp_op["$include?"](u))||this.$raise(x("ParseError")),_([],{})},3),V(f,"$_reduce_17",function(q,pe,$e){var me,Me,Pe;return Pe=null==(me=ee(q))[1]?u:me[1],K(this.allowed_cmp_op["$include?"](Me=null==me[0]?u:me[0]))||this.$raise(x("ParseError")),_(["cmp_op","target"],{cmp_op:Me,target:Pe})},3),V(f,"$_reduce_18",function(q,pe,$e){var Te;return Te=q["$[]"](0),K(this.question_target)||this.$raise(x("ParseError")),K(this.allowed_cmp_op["$include?"](Te))||this.$raise(x("ParseError")),_(["cmp_op","target"],{cmp_op:Te,target:"?"})},3),V(f,"$_reduce_19",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"+",q["$[]"](2))},3),V(f,"$_reduce_20",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"-",q["$[]"](2))},3),V(f,"$_reduce_22",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"BinaryOp").$new(q["$[]"](0),"*",q["$[]"](2))},3),V(f,"$_reduce_23",function(q,pe,$e){return q["$[]"](3).$new(q["$[]"](0),q["$[]"](2))},3),V(f,"$_reduce_25",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),V(f,"$_reduce_26",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"DivideWithCeil")},3),V(f,"$_reduce_27",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"DivideWithCeil")},3),V(f,"$_reduce_28",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"DivideWithRound")},3),V(f,"$_reduce_29",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"DivideWithFloor")},3),V(f,"$_reduce_30",function(q,pe,$e){return q["$[]"](1)},3),V(f,"$_reduce_31",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"Negative").$new(q["$[]"](1))},3),V(f,"$_reduce_33",function(q,pe,$e){return q["$[]"](1)},3),V(f,"$_reduce_34",function(q,pe,$e){return k(k(x("Arithmetic"),"Node"),"Number").$new(q["$[]"](0))},3),V(f,"$_reduce_none",function(q,pe,$e){return q["$[]"](0)},3)},Opal.modules["bcdice/deprecated/checker"]=function(a){var F,H,J,K,ee,M,se,V,y=[],w=a.nil,p=a.module,u=a.send,k=a.eqeqeq,v=a.truthy,D=a.def;return F=y,H=V=[p(y[0],"BCDice")].concat(F),J=se=[p(V[0],"Deprecated")].concat(H),ee=[K=p(se[0],"Checker")].concat(J),M=a.$r(ee),K.$private(),D(K,"$check_result_legacy",function(z,A,N,P){var h,g=this,b=w,C=w,c=w,l=w;return b=u(A,"map",[],"sides".$to_proc()),h=(C=u(A,"map",[],"value".$to_proc())).$sum(),c=k([100],l=b)?g.$check_1D100(z,h,N,P):k([20],l)?g.$check_1D20(z,h,N,P):k([6,6],l)?g.$check_2D6(z,h,C,N,P):w,(v(c["$nil?"]())||v(c["$empty?"]()))&&(c=k([10],l=b.$uniq())?g.$check_nD10(z,h,C,N,P):k([6],l)?g.$check_nD6(z,h,C,N,P):w,v(c["$nil?"]())||v(c["$empty?"]()))?w:M("Result").$new(c.$delete_prefix(" \uff1e "))},4),D(K,"$check_1D100",function(z,A,N,P){return w},4),D(K,"$check_1D20",function(z,A,N,P){return w},4),D(K,"$check_nD10",function(z,A,N,P,g){return w},5),D(K,"$check_2D6",function(z,A,N,P,g){return w},5),D(K,"$check_nD6",function(z,A,N,P,g){return w},5)},Opal.queue(function(a){var A,C,m,S,Z,h,c,l,f,P,y=a.top,w=[],p=a.$r(w),u=a.nil,k=a.$$$,v=a.module,D=a.klass,_=a.truthy,F=a.def,oe=a.regexp,V=a.rb_plus,L=a.send,H=a.to_a,U=a.rb_minus,se=a.eqeqeq,ue=a.eqeq,J=a.range,K=a.rb_divide,ee=a.rb_times,M=a.rb_ge,G=u;return y.$require("i18n"),y.$require("i18n/backend/fallbacks"),y.$require("bcdice/randomizer"),y.$require("bcdice/dice_table"),y.$require("bcdice/enum"),y.$require("bcdice/translate"),y.$require("bcdice/result"),y.$require("bcdice/command/parser"),y.$require("bcdice/deprecated/checker"),A=w,C=P=[v(w[0],"BCDice")].concat(A),c=[h=D(P[0],null,"Base")].concat(C),l=a.$r(c),(f=h.$$prototype).sort_add_dice=f.sort_barabara_dice=f.enabled_d9=f.raw_input=f.randomizer=f.enabled_upcase_input=f.debug=u,S=[m=a.get_singleton_class(h)].concat(c),Z=a.$r(S),m.$attr_reader("prefixes"),F(m,"$register_prefix",function(ye){var R,ie=this,j=u;return null==ie.prefixes&&(ie.prefixes=u),R=a.slice.call(arguments),ie.prefixes=_(j=ie.prefixes)?j:[],ie.prefixes.$concat(R.$flatten())},-1),F(m,"$register_prefix_from_super_class",function(){return this.$register_prefix(this.$superclass().$prefixes())},0),F(m,"$prefixes_pattern",function(){var ye=this,T=u;return null==ye.prefixes_pattern&&(ye.prefixes_pattern=u),null==ye.prefixes&&(ye.prefixes=u),ye.prefixes_pattern=_(T=ye.prefixes_pattern)?T:u,_(ye.prefixes_pattern)?ye.prefixes_pattern:(ye.prefixes=_(T=ye.prefixes)?T:[],ye.prefixes.$freeze(),ye.prefixes_pattern=(_(ye.prefixes["$empty?"]())?/(?!)/:oe(["^(S)?(",ye.prefixes.$join("|"),")"],"i")).$freeze())},0),F(m,"$command_pattern",function(){var ye=this,T=u,R=u;return null==ye.command_pattern&&(ye.command_pattern=u),null==ye.prefixes&&(ye.prefixes=u),ye.command_pattern=_(T=ye.command_pattern)?T:u,_(ye.command_pattern)?ye.command_pattern:(ye.prefixes=_(T=ye.prefixes)?T:[],ye.prefixes.$freeze(),R=V(L(k(Z("CommonCommand"),"COMMANDS"),"map",[],function(j){return null==j&&(j=u),k(j,"PREFIX_PATTERN").$source()},1),ye.prefixes),ye.command_pattern=oe(["^S?(",R.$join("|"),")"],"i").$freeze())},0),F(m,"$eval",function(ye){return this.$new(ye).$eval()},1),h.$include(l("Translate")),h.$include(k(l("Deprecated"),"Checker")),F(h,"$initialize",function(x){var S=this;return S.raw_input=x,S.sort_add_dice=!1,S.sort_barabara_dice=!1,S.d66_sort_type=k(l("D66SortType"),"NO_SORT"),S.enabled_d9=!1,S.round_type=k(l("RoundType"),"FLOOR"),S.sides_implicit_d=6,S.upper_dice_reroll_threshold=u,S.reroll_dice_reroll_threshold=u,S.default_cmp_op=u,S.default_target_number=u,S.enabled_upcase_input=!0,S.locale="ja_jp",S.randomizer=k(l("BCDice"),"Randomizer").$new(),S.debug=!1},1),h.$attr_accessor("randomizer"),h.$attr_reader("d66_sort_type"),h.$attr_reader("round_type"),h.$attr_reader("sides_implicit_d"),h.$attr_reader("upper_dice_reroll_threshold"),h.$attr_reader("reroll_dice_reroll_threshold"),h.$attr_reader("default_cmp_op"),h.$attr_reader("default_target_number"),F(h,"$sort_add_dice?",function(){return this.sort_add_dice},0),F(h,"$sort_barabara_dice?",function(){return this.sort_barabara_dice},0),F(h,"$enabled_d9?",function(){return this.enabled_d9},0),F(h,"$enable_debug",function(){return this.debug=!0},0),F(h,"$eval",function(){var S,Z,le,x=this,ye=u;return S=k(l("BCDice"),"Preprocessor").$process(x.raw_input,x),Z=_(le=x.$dice_command(S))?le:x.$eval_common_command(x.raw_input),_(Z)?(ye=[x.randomizer.$rand_results()],L(Z,"rands=",H(ye)),U(ye.length,1),ye=[x.randomizer.$detailed_rand_results()],L(Z,"detailed_rands=",H(ye)),U(ye.length,1),Z):u},0),F(h,"$change_text",function(x){return x},1),F(h,"$check_result",function(x,S,Z,le){var ye=this,T=u,R=u,ie=u,j=u,ve=u;return T=ye.$check_result_legacy(x,S,Z,le),_(T)?T:(R=L(S,"map",[],"sides".$to_proc()),j=(ie=L(S,"map",[],"value".$to_proc())).$sum(),T=se([100],ve=R)?ye.$result_1d100(x,j,Z,le):se([20],ve)?ye.$result_1d20(x,j,Z,le):se([6,6],ve)?ye.$result_2d6(x,j,ie,Z,le):u,ue(T,l("Result").$nothing())?u:_(T)?T:(T=se([10],ve=R.$uniq())?ye.$result_nd10(x,j,ie,Z,le):se([6],ve)?ye.$result_nd6(x,j,ie,Z,le):u,ue(T,l("Result").$nothing())?u:_(T)?T:ye.$result_ndx(x,Z,le)))},4),F(h,"$grich_text",function(x,S,Z){return u},3),h.$private(),F(h,"$eval_common_command",function(x){try{return x=this.$change_text(x),L(k(l("CommonCommand"),"COMMANDS"),"each",[],function Z(le){var T,ye=null==Z.$$s?this:Z.$$s;if(null==ye.randomizer&&(ye.randomizer=u),null==le&&(le=u),T=le.$eval(x,ye,ye.randomizer),!_(T))return u;a.ret(T)},{$$arity:1,$$s:this}),u}catch(Z){if(Z===a.returner)return Z.$v;throw Z}},1),F(h,"$dice_command",function(x){var S=this,Z=u,le=u,ye=u,T=u,R=u;return _(S.enabled_upcase_input)&&(x=x.$upcase()),Z=S.$class().$prefixes_pattern().$match(x),_(Z)?(le=Z["$[]"](1)["$nil?"]()["$!"](),_(le)&&(x=x["$[]"](J(1,-1,!1))),ye=S.$eval_game_system_specific_command(x),_(ye["$is_a?"](l("Result")))?(T=[_(R=ye["$secret?"]())?R:le],L(ye,"secret=",H(T)),U(T.length,1),ye):_(ye["$nil?"]())||_(ye["$empty?"]())||ue(ye,"1")?u:L(l("Result").$new(),"tap",[],function(j){return null==j&&(j=u),T=[ye.$to_s()],L(j,"text=",H(T)),U(T.length,1),L(j,"secret=",H(T=[le])),T[U(T.length,1)]},1)):u},1),F(h,"$eval_game_system_specific_command",function(x){return u},1),F(h,"$result_ndx",function(x,S,Z){return _(Z["$is_a?"](l("String")))?u:_(x.$send(S,Z))?l("Result").$success(this.$translate("success")):l("Result").$failure(this.$translate("failure"))},3),F(h,"$result_1d100",function(x,S,Z,le){return u},4),F(h,"$result_1d20",function(x,S,Z,le){return u},4),F(h,"$result_nd10",function(x,S,Z,le,ye){return u},5),F(h,"$result_2d6",function(x,S,Z,le,ye){return u},5),F(h,"$result_nd6",function(x,S,Z,le,ye){return u},5),F(h,"$get_table_by_2d6",function(x){return this.$get_table_by_nD6(x,2)},1),F(h,"$get_table_by_1d6",function(x){return this.$get_table_by_nD6(x,1)},1),F(h,"$get_table_by_nD6",function(x,S){return this.$get_table_by_nDx(x,S,6)},2),F(h,"$get_table_by_nDx",function(x,S,Z){var ye,T=u;return ye=this.randomizer.$roll_sum(S,Z),T=this.$get_table_value(x["$[]"](U(ye,S))),_(T["$nil?"]())?["1",0]:[T,ye]},3),F(h,"$get_table_by_1d3",function(x){var le,ye,S=this,T=u;return S.$debug("get_table_by_1d3"),le=S.randomizer.$roll_sum(1,6),S.$debug("num",le),ye=K(U(le,1),2).$to_i(),S.$debug("index",ye),T=x["$[]"](ye),_(T["$nil?"]())?["1",0]:[T,le]},1),F(h,"$get_table_by_d66_swap",function(x){var Z;return Z=this.randomizer.$roll_d66(k(l("D66SortType"),"ASC")),[this.$get_table_by_number(Z,x),Z]},1),F(h,"$get_table_by_d66",function(x){var Z,le,ye,R,T=u;return Z=this.randomizer.$roll_once(6),le=this.randomizer.$roll_once(6),ye=V(ee(U(Z,1),6),U(le,1)),T=x["$[]"](ye),R=""+Z+le,_(T["$nil?"]())?["1",R]:[T,R]},1),F(h,"$get_table_by_number",function(x,S,Z){try{return null==Z&&(Z="1"),L(S,"each",[],function ye(T){var ie,R=null==ye.$$s?this:ye.$$s;if(null==T&&(T=u),ie=T["$[]"](0),!_(M(ie,x)))return u;a.ret(R.$get_table_value(T["$[]"](1)))},{$$arity:1,$$s:this}),this.$get_table_value(Z)}catch(ye){if(ye===a.returner)return ye.$v;throw ye}},-3),F(h,"$get_table_value",function(x){return _(x["$is_a?"](l("Proc")))?x.$call():x},1),F(h,"$roll_tables",function(x,S){var le=u;return le=S["$[]"](x),_(le)?le.$roll(this.randomizer).$to_s():u},2),F(h,"$debug",function(x,S){var le,ye=this,T=u,R=u;return le=a.slice.call(arguments,1),_(ye.debug)?(T=_(x["$is_a?"](l("String")))?x:x.$inspect(),_(le["$empty?"]())?ye.$warn(T):(R=L(le,"map",[],function(j){return null==j&&(j=u),_(j["$is_a?"](l("String")))?'"'+j+'"':j.$inspect()},1),ye.$warn(T+": "+R.$join(", ")))):u},-2),k(k(p("I18n"),"Backend"),"Simple").$include(k(k(p("I18n"),"Backend"),"Fallbacks")),p("I18n").$load_path()["$<<"](p("Dir")["$[]"](p("File").$join("bcdice","../../i18n/**/*.yml"))),G=["ja_jp"],L(p("I18n"),"default_locale=",H(G)),U(G.length,1),G=[["ja_jp"]],L(p("I18n").$fallbacks(),"defaults=",H(G)),G[U(G.length,1)]})},4748:(E,ae,Y)=>{Y(9993),Opal.modules["bcdice/normalize"]=function(a){var _,L,oe,y=[],w=a.nil,p=a.module,u=a.eqeqeq,k=a.def,v=a.eqeq;return _=y,oe=[p(y[0],"BCDice")].concat(_),(L=p(oe[0],"Normalize")).$module_function(),k(L,"$comparison_operator",function(U){var se;return u(/<=|=</,se=U)?"<=":u(/>=|=>/,se)?">=":u(/<>|!=|=!/,se)?"!=":u(/</,se)?"<":u(/>/,se)?">":u(/=/,se)?"==":w},1),k(L,"$target_number",function(U){return v(U,"?")?U:U.$to_i()},1)},Opal.modules["racc/parser"]=function(a){var b,h,c,w=[],p=a.$r(w),u=a.nil,k=a.$$$,v=a.module,D=a.klass,_=a.truthy,F=a.const_set,oe=a.defs,V=a.gvars,L=a.rb_lt,H=a.send,U=a.to_a,se=a.rb_minus,ue=a.def,J=a.to_ary,K=a.neqeq,ee=a.rb_plus,M=a.eqeq,G=a.rb_ge,z=a.rb_gt,A=a.eqeqeq,N=a.rb_le,P=a.rb_times;return b=w,h=[v(w[0],"Racc")].concat(b),c=a.$r(h),D(h[0],c("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":u)||F(w[0],"ParseError",k(p("Racc"),"ParseError")),function(g,b){var x,S,Z,le,ye,c=[v(g,"Racc")].concat(b),l=a.$r(c);return _(l("Racc_No_Extensions","skip_raise")?"constant":u)||F(c[0],"Racc_No_Extensions",!1),x=c,Z=[S=D(c[0],null,"Parser")].concat(x),le=a.$r(Z),(ye=S.$$prototype).yydebug=ye.racc_debug_out=ye.racc_error_status=ye.racc_t=ye.racc_vstack=ye.racc_val=ye.racc_state=ye.racc_tstack=u,F(Z[0],"Racc_Runtime_Version","1.4.6"),F(Z[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(Z[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(Z[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(Z[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(Z[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(Z[0],"Racc_Runtime_Core_Version",le("Racc_Runtime_Core_Version_R")),F(Z[0],"Racc_Runtime_Core_Revision",le("Racc_Runtime_Core_Revision_R")),F(Z[0],"Racc_Runtime_Type","ruby"),oe(le("Parser"),"$racc_runtime_type",function(){return le("Racc_Runtime_Type")},0),ue(S,"$_racc_setup",function(){var R,ie,j=this,ve=u,de=u,we=u;return null==V.stderr&&(V.stderr=u),_(k(j.$class(),"Racc_debug_parser"))||(j.yydebug=!1),_(null!=(R=j.yydebug)&&R!==u?"instance-variable":u)||(j.yydebug=!1),_(j.yydebug)&&(_(null!=(ie=j.racc_debug_out)&&ie!==u?"instance-variable":u)||(j.racc_debug_out=V.stderr),j.racc_debug_out=_(ve=j.racc_debug_out)?ve:V.stderr),de=k(j.$class(),"Racc_arg"),_(L(de.$size(),14))&&(H(de,"[]=",U(we=[13,!0])),se(we.length,1)),de},0),ue(S,"$_racc_init_sysvars",function(){var R=this;return R.racc_state=[0],R.racc_tstack=[],R.racc_vstack=[],R.racc_t=u,R.racc_val=u,R.racc_read_next=!0,R.racc_user_yyerror=!1,R.racc_error_status=0},0),ue(S,"$do_parse",function(){return this.$__send__(le("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),ue(S,"$next_token",function(){return this.$raise(le("NotImplementedError"),this.$class()+"#next_token is not defined")},0),ue(S,"$_racc_do_parse_rb",function(R,ie){var j,we=u,ce=u,he=u,B=u,ne=u,q=u,pe=u,$e=u;return j=J(R),we=null==j[0]?u:j[0],ce=null==j[1]?u:j[1],he=null==j[2]?u:j[2],B=null==j[3]?u:j[3],ne=null==j[10]?u:j[10],this.$_racc_init_sysvars(),q=pe=$e=u,H(this,"catch",["racc_end_parse"],function me(){var De,Me,Pe=null==me.$$s?this:me.$$s,Ve=u;for(null==Pe.racc_state&&(Pe.racc_state=u),null==Pe.racc_read_next&&(Pe.racc_read_next=u),null==Pe.racc_t&&(Pe.racc_t=u),null==Pe.yydebug&&(Pe.yydebug=u),null==Pe.racc_val&&(Pe.racc_val=u);_(!0);)for(_($e=B["$[]"](Pe.racc_state["$[]"](-1)))?(_(Pe.racc_read_next)&&K(Pe.racc_t,0)&&(Me=Pe.$next_token(),De=J(Me),q=null==De[0]?u:De[0],Pe.racc_val=null==De[1]?u:De[1],Pe.racc_t=_(q)?_(Ve=ne["$[]"](q))?Ve:1:0,_(Pe.yydebug)&&Pe.$racc_read_token(Pe.racc_t,q,Pe.racc_val),Pe.racc_read_next=!1),$e=ee($e,Pe.racc_t),_(G($e,0))&&_(pe=we["$[]"]($e))&&M(ce["$[]"]($e),Pe.racc_state["$[]"](-1))||(pe=he["$[]"](Pe.racc_state["$[]"](-1)))):pe=he["$[]"](Pe.racc_state["$[]"](-1));_(pe=Pe.$_racc_evalact(pe,R)););},{$$arity:0,$$s:this})},2),ue(S,"$yyparse",function(R,ie){return this.$__send__(le("Racc_YY_Parse_Method"),R,ie,this.$_racc_setup(),!0)},2),ue(S,"$_racc_yyparse_rb",function(R,ie,j,ve){var de,he=u,B=u,O=u,ne=u,pe=u,$e=u,me=u;return de=J(j),he=null==de[0]?u:de[0],B=null==de[1]?u:de[1],O=null==de[2]?u:de[2],ne=null==de[3]?u:de[3],pe=null==de[10]?u:de[10],this.$_racc_init_sysvars(),$e=u,me=u,H(this,"catch",["racc_end_parse"],function Te(){var Pe=null==Te.$$s?this:Te.$$s;for(null==Pe.racc_state&&(Pe.racc_state=u);!_(me=ne["$[]"](Pe.racc_state["$[]"](-1)));)for(;_($e=Pe.$_racc_evalact(O["$[]"](Pe.racc_state["$[]"](-1)),j)););return H(R,"__send__",[ie],function Ve(Qe,Mt){var gt=null==Ve.$$s?this:Ve.$$s,mt=u,rr=u;for(null==gt.racc_t&&(gt.racc_t=u),null==gt.racc_state&&(gt.racc_state=u),null==gt.racc_read_next&&(gt.racc_read_next=u),null==Qe&&(Qe=u),null==Mt&&(Mt=u),gt.racc_t=_(Qe)?_(mt=pe["$[]"](Qe))?mt:1:0,gt.racc_val=Mt,gt.racc_read_next=!1,me=ee(me,gt.racc_t),_(G(me,0))&&_($e=he["$[]"](me))&&M(B["$[]"](me),gt.racc_state["$[]"](-1))||($e=O["$[]"](gt.racc_state["$[]"](-1)));_($e=gt.$_racc_evalact($e,j)););for(;_(_(mt=_(rr=(me=ne["$[]"](gt.racc_state["$[]"](-1)))["$!"]())?rr:gt.racc_read_next["$!"]())?mt:gt.racc_t["$=="](0));)for(_(me)&&_(me=ee(me,gt.racc_t))&&_(G(me,0))&&_($e=he["$[]"](me))&&M(B["$[]"](me),gt.racc_state["$[]"](-1))||($e=O["$[]"](gt.racc_state["$[]"](-1)));_($e=gt.$_racc_evalact($e,j)););},{$$arity:2,$$s:Pe})},{$$arity:0,$$s:this})},4),ue(S,"$_racc_evalact",function(R,ie){var j,O,de=this,we=u,ce=u,B=u,ne=u,q=u,pe=u,$e=u;if(we=null==(j=J(ie))[0]?u:j[0],ce=null==j[1]?u:j[1],B=null==j[3]?u:j[3],O=null==j[11]?u:j[11],ne=null==j[12]?u:j[12],_(z(R,0))&&_(L(R,O)))_(z(de.racc_error_status,0))&&(M(de.racc_t,1)||(de.racc_error_status=se(de.racc_error_status,1))),de.racc_vstack.$push(de.racc_val),de.racc_state.$push(R),de.racc_read_next=!0,_(de.yydebug)&&(de.racc_tstack.$push(de.racc_t),de.$racc_shift(de.racc_t,de.racc_tstack,de.racc_vstack));else if(_(L(R,0))&&_(z(R,ne["$-@"]()))){if(q=H(de,"catch",["racc_jump"],function me(){var Te=null==me.$$s?this:me.$$s;return null==Te.racc_state&&(Te.racc_state=u),Te.racc_state.$push(Te.$_racc_do_reduce(ie,R)),!1},{$$arity:0,$$s:de}),_(q)){if(A(1,pe=q))return de.racc_user_yyerror=!0,ne["$-@"]();if(A(2,pe))return O;de.$raise("[Racc Bug] unknown jump code")}}else if(M(R,O))_(de.yydebug)&&de.$racc_accept(),de.$throw("racc_end_parse",de.racc_vstack["$[]"](0));else{if(M(R,ne["$-@"]())){for(A(0,pe=de.racc_error_status)?_(ie["$[]"](21))||de.$on_error(de.racc_t,de.racc_val,de.racc_vstack):A(3,pe)&&(M(de.racc_t,0)&&de.$throw("racc_end_parse",u),de.racc_read_next=!0),de.racc_user_yyerror=!1,de.racc_error_status=3;_(!0)&&!(_($e=B["$[]"](de.racc_state["$[]"](-1)))&&($e=ee($e,1),_(G($e,0))&&_(R=we["$[]"]($e))&&M(ce["$[]"]($e),de.racc_state["$[]"](-1))));)_(N(de.racc_state.$size(),1))&&de.$throw("racc_end_parse",u),de.racc_state.$pop(),de.racc_vstack.$pop(),_(de.yydebug)&&(de.racc_tstack.$pop(),de.$racc_e_pop(de.racc_state,de.racc_tstack,de.racc_vstack));return R}de.$raise("[Racc Bug] unknown action "+R.$inspect())}return _(de.yydebug)&&de.$racc_next_state(de.racc_state["$[]"](-1),de.racc_state),u},2),ue(S,"$_racc_do_reduce",function(R,ie){var j,ne,pe,Pe,Ve,Qe,gt,de=this,ce=u,he=u,B=u,O=u,q=u,$e=u,me=u,Te=u,De=u,Me=u,Mt=u,Bt=u,Pt=u,mt=u;return ce=null==(j=J(R))[4]?u:j[4],he=null==j[5]?u:j[5],B=null==j[6]?u:j[6],O=null==j[7]?u:j[7],ne=null==j[8]?u:j[8],q=null==j[9]?u:j[9],pe=null==j[13]?u:j[13],$e=de.racc_state,me=de.racc_vstack,Te=de.racc_tstack,De=P(ie,-3),Me=q["$[]"](De),Pe=q["$[]"](ee(De,1)),Ve=q["$[]"](ee(De,2)),Qe=[],_(de.yydebug)&&(Mt=Te["$[]"](Me["$-@"](),Me)),Bt=me["$[]"](Me["$-@"](),Me),_(de.yydebug)&&(Pt=[Me["$-@"](),Me,Qe],H(Te,"[]=",U(Pt)),se(Pt.length,1)),Pt=[Me["$-@"](),Me,Qe],H(me,"[]=",U(Pt)),se(Pt.length,1),Pt=[Me["$-@"](),Me,Qe],H($e,"[]=",U(Pt)),se(Pt.length,1),_(pe)?me.$push(de.$__send__(Ve,Bt,me,Bt["$[]"](0))):me.$push(de.$__send__(Ve,Bt,me)),Te.$push(Pe),_(de.yydebug)&&de.$racc_reduce(Mt,Pe,Te,me),gt=se(Pe,ne),_(De=O["$[]"](gt))&&(De=ee(De,$e["$[]"](-1)),_(G(De,0))&&_(mt=ce["$[]"](De))&&M(he["$[]"](De),gt))?mt:B["$[]"](gt)},2),ue(S,"$on_error",function(R,ie,j){var de;return this.$raise(le("ParseError"),this.$sprintf("\nparse error on value %s (%s)",ie.$inspect(),_(de=this.$token_to_str(R))?de:"?"))},3),ue(S,"$yyerror",function(){return this.$throw("racc_jump",1)},0),ue(S,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),ue(S,"$yyerrok",function(){return this.racc_error_status=0},0),ue(S,"$racc_read_token",function(R,ie,j){var ve=this;return ve.racc_debug_out.$print("read    "),ve.racc_debug_out.$print(ie.$inspect(),"(",ve.$racc_token2str(R),") "),ve.racc_debug_out.$puts(j.$inspect()),ve.racc_debug_out.$puts()},3),ue(S,"$racc_shift",function(R,ie,j){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(R)),this.$racc_print_stacks(ie,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_reduce",function(R,ie,j,ve){var de=this,we=u;return(we=de.racc_debug_out).$print("reduce "),_(R["$empty?"]())?we.$print(" <none>"):H(R,"each",[],function ce(he){return null==he&&(he=u),we.$print(" ",(null==ce.$$s?this:ce.$$s).$racc_token2str(he))},{$$arity:1,$$s:de}),we.$puts(" --\x3e "+de.$racc_token2str(ie)),de.$racc_print_stacks(j,ve),de.racc_debug_out.$puts()},4),ue(S,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),ue(S,"$racc_e_pop",function(R,ie,j){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(R),this.$racc_print_stacks(ie,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_next_state",function(R,ie){var j=this;return j.racc_debug_out.$puts("goto    "+R),j.$racc_print_states(ie),j.racc_debug_out.$puts()},2),ue(S,"$racc_print_stacks",function(R,ie){var ve=u;return(ve=this.racc_debug_out).$print("        ["),H(R,"each_index",[],function de(we){return null==we&&(we=u),ve.$print(" (",(null==de.$$s?this:de.$$s).$racc_token2str(R["$[]"](we))," ",ie["$[]"](we).$inspect(),")")},{$$arity:1,$$s:this}),ve.$puts(" ]")},2),ue(S,"$racc_print_states",function(R){var j=u;return(j=this.racc_debug_out).$print("        ["),H(R,"each",[],function(de){return null==de&&(de=u),j.$print(" ",de)},1),j.$puts(" ]")},1),ue(S,"$racc_token2str",function(R){var j;return _(j=k(this.$class(),"Racc_token_to_s_table")["$[]"](R))?j:this.$raise("[Racc Bug] can't convert token "+R+" to string")},1),ue(S,"$token_to_str",function(R){return k(this.$class(),"Racc_token_to_s_table")["$[]"](R)},1)}(w[0],w)},Opal.modules.strscan=function(a){var U,se,ue,J,K,y=[],w=a.nil,u=a.def,k=a.truthy,v=a.eqeqeq,D=a.Opal,_=a.send,F=a.to_a,oe=a.rb_minus,V=a.alias;return U=y,ue=[se=(0,a.klass)(y[0],null,"StringScanner")].concat(U),J=a.$r(ue),(K=se.$$prototype).pos=K.string=K.working=K.matched=K.prev_pos=K.match=w,se.$attr_reader("pos","matched"),u(se,"$initialize",function(M){var G=this;return G.string=M,G.pos=0,G.matched=w,G.working=M,G.match=[]},1),se.$attr_reader("string"),u(se,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)},0),u(se,"$scan",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return null==z?G.matched=w:"object"==typeof z?(G.prev_pos=G.pos,G.pos+=z[0].length,G.working=G.working.substring(z[0].length),G.matched=z[0],G.match=z,z[0]):"string"==typeof z?(G.pos+=z.length,G.working=G.working.substring(z.length),z):w},1),u(se,"$scan_until",function(M){var G=this;M=G.$anchor(M);for(var N,z=G.pos,A=G.working;;){if(N=M.exec(A),z+=1,A=A.substr(1),null!=N)return G.matched=G.string.substr(G.pos,z-G.pos-1+N[0].length),G.match=N,G.prev_pos=z-1,G.pos=z,G.working=A.substr(N[0].length),G.matched;if(0===A.length)return G.match=[],G.matched=w}},1),u(se,"$[]",function(M){var z;if(k(this.match["$empty?"]()))return w;v(J("Symbol"),z=M)?M=M.$to_s():v(J("String"),z)||(M=D["$coerce_to!"](M,J("Integer"),"to_int"));var A=this.match;return M<0&&(M+=A.length),M<0||M>=A.length||null==A[M]?w:A[M]},1),u(se,"$check",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return G.matched=null==z?w:z[0]},1),u(se,"$check_until",function(M){var G=this,z=G.prev_pos,A=G.pos,N=G.$scan_until(M);return N!==w&&(G.matched=N.substr(-1),G.working=G.string.substr(A)),G.prev_pos=z,G.pos=A,N},1),u(se,"$peek",function(M){return this.working.substring(0,M)},1),u(se,"$eos?",function(){return 0===this.working.length},0),u(se,"$exist?",function(M){var z=M.exec(this.working);return null==z?w:0==z.index?0:z.index+1},1),u(se,"$skip",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);if(null==z)return G.match=[],G.matched=w;var A=z[0],N=A.length;return G.matched=A,G.match=z,G.prev_pos=G.pos,G.pos+=N,G.working=G.working.substring(N),N},1),u(se,"$skip_until",function(M){var z=this.$scan_until(M);return z===w?w:(this.matched=z.substr(-1),z.length)},1),u(se,"$get_byte",function(){var M=this,G=w;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,G=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=w,G},0),u(se,"$match?",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return null==z?w:(G.prev_pos=G.pos,z[0].length)},1),u(se,"$pos=",function(M){var G=this;return M<0&&(M+=G.string.$length()),G.pos=M,G.working=G.string.slice(M)},1),u(se,"$matched_size",function(){return this.matched===w?w:this.matched.length},0),u(se,"$post_match",function(){var M=this;return M.matched===w?w:M.string.substr(M.pos)},0),u(se,"$pre_match",function(){var M=this;return M.matched===w?w:M.string.substr(0,M.prev_pos)},0),u(se,"$reset",function(){var M=this;return M.working=M.string,M.matched=w,M.pos=0},0),u(se,"$rest",function(){return this.working},0),u(se,"$rest?",function(){return 0!==this.working.length},0),u(se,"$rest_size",function(){return this.$rest().$size()},0),u(se,"$terminate",function(){var G,M=this;return M.match=w,G=[M.string.$length()],_(M,"pos=",F(G)),G[oe(G.length,1)]},0),u(se,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=w,M.match=w,M},0),V(se,"bol?","beginning_of_line?"),V(se,"getch","get_byte"),se.$private(),u(se,"$anchor",function(M){var G=M.toString().match(/\/([^\/]+)$/);return G=G?G[1]:void 0,new RegExp("^(?:"+M.source+")",G)},1)},Opal.modules["bcdice/common_command/lexer"]=function(a){var V,se,M,G,z,A,J,H,y=a.top,w=[],p=a.nil,u=a.module,k=a.klass,v=a.const_set,D=a.hash2,_=a.truthy,F=a.def;return y.$require("strscan"),y.$require("bcdice/normalize"),V=w,se=H=[u(w[0],"BCDice")].concat(V),M=J=[u(H[0],"CommonCommand")].concat(se),z=[G=k(J[0],null,"Lexer")].concat(M),A=a.$r(z),G.$$prototype.scanner=p,v(z[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),F(G,"$initialize",function(g){var C;return g=_(C=g.$split(" ",2).$first())?C:"",this.scanner=A("StringScanner").$new(g)},1),F(G,"$next_token",function(){var g=this,b=p,C=p,h=p,l=p;return _(g.scanner["$eos?"]())?[!1,"$"]:_(b=g.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:_(C=g.scanner.$scan(/[<>!=]+/))?["CMP_OP",A("Normalize").$comparison_operator(C)]:(h=g.scanner.$getch().$upcase(),[_(l=A("SYMBOLS")["$[]"](h))?l:h.$to_sym(),h])},0),F(G,"$source",function(){return this.scanner.$string()},0)},Opal.modules.singleton=function(a){var V,ue,J,K,ee,L,H,U,y=[],w=a.nil,p=a.module,u=a.def,k=a.send2,v=a.find_super,D=a.send,_=a.truthy,F=a.defs;return V=y,H=[L=p(y[0],"Singleton")].concat(V),U=a.$r(H),u(L,"$clone",function(){return this.$raise(U("TypeError"),"can't clone instance of singleton "+this.$class())},0),u(L,"$dup",function(){return this.$raise(U("TypeError"),"can't dup instance of singleton "+this.$class())},0),ue=H,K=[J=p(H[0],"SingletonClassMethods")].concat(ue),ee=a.$r(K),u(J,"$clone",function M(){var G=M.$$p||w;return delete M.$$p,ee("Singleton").$__init__(k(this,v(this,"clone",M,!1,!0),"clone",[],G))},0),u(J,"$inherited",function M(G){var z=M.$$p||w;return delete M.$$p,k(this,v(this,"inherited",M,!1,!0),"inherited",[G],z),ee("Singleton").$__init__(G)},1),function(se,ue){var J=[se].concat(ue),K=a.$r(J);return u(se,"$__init__",function(M){return D(M,"instance_eval",[],function z(){return(null==z.$$s?this:z.$$s).singleton__instance__=w},{$$arity:0,$$s:this}),F(M,"$instance",function(){var A=this;return null==A.singleton__instance__&&(A.singleton__instance__=w),_(A.singleton__instance__)?A.singleton__instance__:A.singleton__instance__=A.$new()},0),M},1),u(se,"$included",function ee(M){var G=ee.$$p||w;return delete ee.$$p,k(this,v(this,"included",ee,!1,!0),"included",[M],G),M.$extend(K("SingletonClassMethods")),K("Singleton").$__init__(M)},1)}(a.get_singleton_class(U("Singleton")),H)},Opal.modules["bcdice/common_command/add_dice/node"]=function(a){var A,b,l,S,ie,j,ve,de,we,le,ye,m,h,P,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.def,_=a.rb_plus,F=a.send,oe=a.truthy,V=a.rb_le,L=a.to_a,H=a.rb_minus,U=a.eqeqeq,se=a.alias,ue=a.send2,J=a.find_super,K=a.const_set,ee=a.rb_divide,M=a.not,G=a.neqeq;return a.top.$require("singleton"),A=w,b=P=[k(w[0],"BCDice")].concat(A),l=h=[k(P[0],"CommonCommand")].concat(b),S=m=[k(h[0],"AddDice")].concat(l),le=[k(m[0],"Node")].concat(S),ye=a.$r(le),ie=le,ve=[j=v(le[0],null,"Command")].concat(ie),de=a.$r(ve),(we=j.$$prototype).lhs=we.rhs=we.cmp_op=p,j.$attr_reader("lhs"),j.$attr_reader("cmp_op"),j.$attr_reader("rhs"),D(j,"$initialize",function(he,B,O,ne){var q=this;return null==O&&(O=p),null==ne&&(ne=p),q.secret=he,q.lhs=B,q.cmp_op=O,q.rhs=ne},-3),D(j,"$expr",function(he){var B,O=this;return _(_(O.lhs.$expr(he),O.$cmp_op_text()),(B=O.rhs,B===p||null==B?p:F(B,"eval",[he,p])).$to_s())},1),D(j,"$s_exp",function(){var he=this;return oe(he.cmp_op)?"(Command ("+he.cmp_op+" "+he.lhs.$s_exp()+" "+he.rhs.$s_exp()+"))":"(Command "+he.lhs.$s_exp()+")"},0),D(j,"$eval",function(he,B){var O,Te,ne=this,q=p,pe=p,$e=p,me=p,De=p;return B=de("Randomizer").$new(B,he),q=ne.lhs.$eval(he,B),pe=oe(V(B.$rand_results().$size(),1))&&oe(ne.lhs["$is_a?"](u(de("Node"),"DiceRoll")))?p:ne.lhs.$output(),$e=oe(ne.cmp_op)?(me=ne.rhs.$eval(he,p),he.$check_result(q,B.$rand_results(),ne.cmp_op,me)):p,$e=oe(Te=$e)?Te:de("Result").$new(),De=["("+ne.$expr(he)+")",pe,q,(O=$e,O===p||null==O?p:F(O,"text",[]))].$compact(),F($e,"tap",[],function Me(Pe){var Ve=null==Me.$$s?this:Me.$$s,Qe=p;return null==Ve.secret&&(Ve.secret=p),null==Pe&&(Pe=p),F(Pe,"secret=",L(Qe=[Ve.secret])),H(Qe.length,1),Qe=[De.$join(" \uff1e ")],F(Pe,"text=",L(Qe)),Qe[H(Qe.length,1)]},{$$arity:1,$$s:ne})},2),j.$private(),D(j,"$cmp_op_text",function(){var B;return U("!=",B=this.cmp_op)?"<>":U("==",B)?"=":this.cmp_op.$to_s()},0),function(T,R,ie){var j=v(T,null,"UndecidedTarget"),ve=[j].concat(ie),de=a.$r(ve);j.$include(de("Singleton")),D(j,"$eval",function(ce,he){return"?"},2),D(j,"$include_dice?",function(){return!1},0),D(j,"$expr",function(ce){return"?"},1),D(j,"$output",function(){return"?"},0),se(j,"s_exp","output")}(le[0],0,le),function(T,R){var ie=v(T,null,"BinaryOp"),j=ie.$$prototype;j.lhs=j.rhs=j.op=p,D(ie,"$initialize",function(de,we,ce){return this.lhs=de,this.op=we,this.rhs=ce},3),D(ie,"$eval",function(de,we){var he,B;return he=this.lhs.$eval(de,we),B=this.rhs.$eval(de,we),this.$calc(he,B,de.$round_type()).$to_i()},2),D(ie,"$include_dice?",function(){var we;return oe(we=this.lhs["$include_dice?"]())?we:this.rhs["$include_dice?"]()},0),D(ie,"$expr",function(de){var ce,he;return ce=this.lhs.$expr(de),he=this.rhs.$expr(de),""+ce+this.op+he},1),D(ie,"$output",function(){return""+this.lhs.$output()+this.op+this.rhs.$output()},0),D(ie,"$s_exp",function(){return"("+this.$op_for_s_exp()+" "+this.lhs.$s_exp()+" "+this.rhs.$s_exp()+")"},0),ie.$private(),D(ie,"$calc",function(de,we,ce){return de.$send(this.op,we).$to_i()},3),D(ie,"$op_for_s_exp",function(){return this.op},0)}(le[0]),function(T,R,ie){var j=v(T,R,"DivideBase"),ve=[j].concat(ie),de=a.$r(ve);j.$$prototype.op=p,D(j,"$initialize",function ce(he,B){return delete ce.$$p,ue(this,J(this,"initialize",ce,!1,!0),"initialize",[he,"/",B],null)},2),D(j,"$expr",function ce(he){var O=this;return delete ce.$$p,""+ue(O,J(O,"expr",ce,!1,!0),"expr",[he],null)+O.$rounding_method()},1),D(j,"$output",function ce(){var he=ce.$$p||p,B=this;return delete ce.$$p,""+ue(B,J(B,"output",ce,!1,!0),"output",[],he)+B.$rounding_method()},0),j.$private(),D(j,"$rounding_method",function(){return u(this.$class(),"ROUNDING_METHOD")},0),D(j,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),D(j,"$calc",function(he,B,O){return oe(B["$zero?"]())?1:this.$divide_and_round(he,B,O).$to_i()},3),D(j,"$divide_and_round",function(he,B,O){return this.$raise(de("NotImplementedError"))},3)}(le[0],ye("BinaryOp"),le),function(T,R,ie){var j=v(T,R,"DivideWithGameSystemDefault"),ve=[j].concat(ie),de=a.$r(ve);K(ve[0],"ROUNDING_METHOD",""),j.$private(),D(j,"$divide_and_round",function(ce,he,B){var O,ne=p;return U(u(de("RoundType"),"CEIL"),O=B)?ee(ce.$to_f(),he).$ceil():U(u(de("RoundType"),"ROUND"),O)?(ne=ee(ce.$to_f(),he),oe(ne["$negative?"]())?ne.$abs().$round()["$-@"]():ne.$round()):ee(ce,he).$floor()},3)}(le[0],ye("DivideBase"),le),function(T,R,ie){var j=v(T,R,"DivideWithRoundingUp"),ve=[j].concat(ie);K(ve[0],"ROUNDING_METHOD","U"),j.$private(),D(j,"$divide_and_round",function(we,ce,he){return ee(we.$to_f(),ce).$ceil()},3)}(le[0],ye("DivideBase"),le),function(T,R,ie){var j=v(T,R,"DivideWithRoundingOff"),ve=[j].concat(ie);K(ve[0],"ROUNDING_METHOD","R"),j.$private(),D(j,"$divide_and_round",function(we,ce,he){var B=p;return B=ee(we.$to_f(),ce),oe(B["$negative?"]())?B.$abs().$round()["$-@"]():B.$round()},3)}(le[0],ye("DivideBase"),le),function(T,R,ie){var j=v(T,R,"DivideWithRoundingDown"),ve=[j].concat(ie);K(ve[0],"ROUNDING_METHOD","F"),j.$private(),D(j,"$divide_and_round",function(we,ce,he){return ee(we,ce).$floor()},3)}(le[0],ye("DivideBase"),le),function(T,R){var ie=v(T,null,"Negate");ie.$$prototype.body=p,ie.$attr_reader("body"),D(ie,"$initialize",function(de){return this.body=de},1),D(ie,"$eval",function(de,we){return this.body.$eval(de,we).$to_i()["$-@"]()},2),D(ie,"$include_dice?",function(){return this.body["$include_dice?"]()},0),D(ie,"$expr",function(de){return"-"+this.body.$expr(de)},1),D(ie,"$output",function(){return"-"+this.body.$output()},0),D(ie,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(le[0]),function(T,R){var ie=v(T,null,"DiceRoll"),j=ie.$$prototype;j.times=j.text=j.sides=p,D(ie,"$initialize",function(de,we){return this.times=de,this.sides=we,this.text=p},2),D(ie,"$eval",function(de,we){var he,B,O=p,ne=p;return he=this.times.$eval(de,p),B=this.$eval_sides(de),ne=(O=we.$roll(he,B)).$sum(),this.text=ne+"["+O.$join(",")+"]",ne.$to_i()},2),D(ie,"$include_dice?",function(){return!0},0),D(ie,"$expr",function(de){return this.times.$eval(de,p)+"D"+this.$eval_sides(de)},1),D(ie,"$output",function(){return this.text},0),D(ie,"$s_exp",function(){return"(DiceRoll "+this.times.$s_exp()+" "+this.sides.$s_exp()+")"},0),ie.$private(),D(ie,"$eval_sides",function(de){return this.sides.$eval(de,p)},1)}(le[0]),function(T,R){var ie=v(T,R,"ImplicitSidesDiceRoll");ie.$$prototype.times=p,D(ie,"$initialize",function(de){return this.times=de,this.text=p},1),D(ie,"$s_exp",function(){return"(ImplicitSidesDiceRoll "+this.times.$s_exp()+")"},0),ie.$private(),D(ie,"$eval_sides",function(de){return de.$sides_implicit_d()},1)}(le[0],ye("DiceRoll")),function(T,R,ie){var j=v(T,null,"DiceRollWithFilter"),ve=[j].concat(ie),de=a.$r(ve),we=j.$$prototype;we.times=we.n_filtering=we.filter=we.sides=we.text=p,K(ve[0],"Filter",de("Struct").$new("abbr","apply")),K(ve[0],"KEEP_HIGHEST",de("Filter").$new("KH",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$reverse().$take(B)},2)).$freeze()),K(ve[0],"KEEP_LOWEST",de("Filter").$new("KL",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$take(B)},2)).$freeze()),K(ve[0],"DROP_HIGHEST",de("Filter").$new("DH",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$reverse().$drop(B)},2)).$freeze()),K(ve[0],"DROP_LOWEST",de("Filter").$new("DL",F(j,"lambda",[],function(he,B){return null==he&&(he=p),null==B&&(B=p),he.$drop(B)},2)).$freeze()),D(j,"$initialize",function(he,B,O,ne){var q=this;return G(B,"implicit")&&M(B["$respond_to?"]("eval"))&&q.$raise(de("TypeError"),"sides must be a Node or :implicit ("+B.$inspect()+")"),q.times=he,q.sides=B,q.n_filtering=O,q.filter=ne,q.text=p},4),D(j,"$eval",function(he,B){var ne,q,pe,O=this,$e=p,me=p;return ne=O.times.$eval(he,p),q=O.$eval_sides(he),pe=O.n_filtering.$eval(he,p),$e=B.$roll(ne,q).$sort(),me=O.filter.$apply()["$[]"]($e,pe).$sum(),O.text=me+"["+$e.$join(",")+"]",me.$to_i()},2),D(j,"$include_dice?",function(){return!0},0),D(j,"$implicit_sides?",function(){return this.sides["$=="]("implicit")},0),D(j,"$expr",function(he){var O,ne,q,B=this;return O=B.times.$eval(he,p),ne=B.$eval_sides(he),q=B.n_filtering.$eval(he,p),O+"D"+ne+B.filter.$abbr()+q},1),D(j,"$output",function(){return this.text},0),D(j,"$s_exp",function(){var B,he=this;return B=oe(he["$implicit_sides?"]())?he.sides.$inspect():he.sides.$s_exp(),"(DiceRollWithFilter "+he.times.$s_exp()+" "+B+" "+he.filter.$abbr().$inspect()+" "+he.n_filtering.$s_exp()+")"},0),j.$private(),D(j,"$eval_sides",function(he){return oe(this["$implicit_sides?"]())?he.$sides_implicit_d():this.sides.$eval(he,p)},1)}(le[0],0,le),function(T,R){var ie=v(T,null,"Parenthesis");ie.$$prototype.expr=p,D(ie,"$initialize",function(de){return this.expr=de},1),D(ie,"$eval",function(de,we){return this.expr.$eval(de,we).$to_i()},2),D(ie,"$include_dice?",function(){return this.expr["$include_dice?"]()},0),D(ie,"$expr",function(de){return"("+this.expr.$expr(de)+")"},1),D(ie,"$output",function(){return"("+this.expr.$output()+")"},0),D(ie,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(le[0]),function(T,R,ie){var j=v(T,null,"Number"),ve=[j].concat(ie),de=a.$r(ve);return j.$$prototype.literal=p,j.$attr_reader("literal"),D(j,"$initialize",function(he){return this.literal=he.$to_i()},1),D(j,"$negate",function(){return de("Number").$new(this.literal["$-@"]())},0),D(j,"$eval",function(he,B){return this.literal.$to_i()},2),D(j,"$include_dice?",function(){return!1},0),D(j,"$expr",function(he){return this.literal.$to_s()},1),D(j,"$output",function(){return this.literal.$to_s()},0),se(j,"s_exp","output")}(le[0],0,le)},Opal.modules["bcdice/common_command/add_dice/parser"]=function(a){var K,z,g,f,Z,le,ye,T,R,ie,j,ve,de,he,m,x,S,C,h,N,M,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.truthy,oe=a.eqeq,V=a.hash,L=a.const_set,H=a.to_ary,U=a.not,se=a.neqeq,ue=a.hash2;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/add_dice/node"),K=w,z=M=[k(w[0],"BCDice")].concat(K),g=N=[k(M[0],"CommonCommand")].concat(z),C=[k(N[0],"AddDice")].concat(g),h=a.$r(C),f=C,x=[m=v(C[0],u(h("Racc"),"Parser"),"Parser")].concat(f),S=a.$r(x),m.$$prototype.lexer=p,D(m,"$parse",function(pe){return this.$new().$parse(pe)},1),_(m,"$parse",function(pe){try{return this.lexer=S("Lexer").$new(pe),this.$do_parse()}catch(me){if(!a.rescue(me,[S("ParseError")]))throw me;try{return p}finally{a.pop_exception()}}},1),m.$private(),_(m,"$next_token",function(){return this.lexer.$next_token()},0),_(m,"$expand_negate",function(pe,$e){if(F($e["$is_a?"](u(S("Node"),"Negate")))){if(oe(pe,"+"))return["-",$e.$body()];if(oe(pe,"-"))return["+",$e.$body()]}return[pe,$e]},2),Z=[14,14,50,12,51,19,20,14,14,14,12,3,12,17,18,14,8,9,12,4,13,13,28,8,9,8,9,13,13,13,14,8,9,12,15,13,14,23,14,12,56,12,19,20,57,14,8,9,12,p,13,p,8,9,8,9,13,14,13,p,12,8,9,14,16,13,-27,-27,19,20,-27,17,18,8,9,p,42,13,p,17,18,40,39,13,p,38,-28,-28,40,39,-28,p,38,45,47,44,46,52,53,54,55],le=[16,12,38,16,38,6,6,2,36,8,2,0,8,27,27,9,16,16,9,1,16,12,16,2,2,8,8,2,36,8,13,9,9,13,4,9,17,11,18,17,50,18,29,29,51,19,13,13,19,p,13,p,17,17,18,18,17,20,18,p,20,19,19,23,5,19,23,23,30,30,23,25,25,20,20,p,25,20,p,5,5,24,24,23,p,24,33,33,34,34,33,p,34,32,32,32,32,39,39,40,40],ye=[7,19,5,p,34,61,-15,p,7,13,p,32,-1,28,p,p,-2,34,36,43,55,p,p,61,76,53,p,-5,p,22,48,p,79,81,83,p,6,p,-8,90,92,p,p,p,p,p,p,p,p,p,29,31,p,p,p,p,p,p],T=[-3,-41,-41,-4,-41,-1,-9,-12,-41,-41,-20,-26,-41,-41,-40,58,-41,-41,-41,-41,-41,-18,-19,-22,-24,-41,-2,-5,-6,-7,-8,-10,-13,-21,-41,-25,-37,-30,-41,-41,-41,-38,-39,-11,-14,-15,-16,-17,-23,-29,-41,-41,-33,-34,-35,-36,-31,-32],R=[24,5,21,22,29,30,35,1,2,26,43,33,25,31,32,27,48,34,p,p,p,p,p,p,49],ie=[9,3,6,6,5,5,11,1,2,4,7,9,3,6,6,3,11,10,p,p,p,p,p,p,9],j=[p,7,8,-1,-7,-13,-6,-22,p,-12,-6,-18,p,p,p],ve=[p,p,p,p,p,6,7,p,10,11,p,p,36,37,41],de=[0,0,"racc_error",2,26,"_reduce_1",4,26,"_reduce_2",0,27,"_reduce_3",1,27,"_reduce_4",1,29,"_reduce_none",1,29,"_reduce_6",3,28,"_reduce_7",3,28,"_reduce_8",1,28,"_reduce_none",3,30,"_reduce_10",4,30,"_reduce_11",1,30,"_reduce_none",0,32,"_reduce_13",1,32,"_reduce_14",1,32,"_reduce_15",1,32,"_reduce_16",1,32,"_reduce_17",2,31,"_reduce_18",2,31,"_reduce_19",1,31,"_reduce_none",3,33,"_reduce_21",2,33,"_reduce_22",4,33,"_reduce_23",2,33,"_reduce_24",3,33,"_reduce_25",1,33,"_reduce_none",0,35,"_reduce_27",1,35,"_reduce_28",2,36,"_reduce_29",1,36,"_reduce_30",3,39,"_reduce_31",3,39,"_reduce_32",2,37,"_reduce_33",2,37,"_reduce_34",2,37,"_reduce_35",2,37,"_reduce_36",1,38,"_reduce_none",1,38,"_reduce_none",3,34,"_reduce_39",1,34,"_reduce_40"],he=V(!1,0,"error",1,"NUMBER",2,"CMP_OP",3,"S",4,"D",5,"K",6,"H",7,"L",8,"M",9,"A",10,"X",11,"I",12,"N",13,"U",14,"R",15,"F",16,"C",17,"PLUS",18,"MINUS",19,"ASTERISK",20,"SLASH",21,"PARENL",22,"PARENR",23,"QUESTION",24),L(x[0],"Racc_arg",[Z,le,T,ye,R,ie,ve,j,25,de,he,58,41,!0]),L(x[0],"Racc_token_to_s_table",["$end","error","NUMBER","CMP_OP","S","D","K","H","L","M","A","X","I","N","U","R","F","C","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","QUESTION","$start","command","secret","add","target","mul","unary","round_type","dice","term","explicit_or_implicit_sides","filter","filter_type","filter_type_with_shorthand","filter_shorthand"]),L(x[0],"Racc_debug_parser",!1),_(m,"$_reduce_1",function(pe,$e,me){var Te,Pe,Ve=p;return Pe=null==(Te=H(pe))[0]?p:Te[0],F((Ve=null==Te[1]?p:Te[1])["$include_dice?"]())||this.$raise(S("ParseError")),u(S("Node"),"Command").$new(Pe,Ve)},3),_(m,"$_reduce_2",function(pe,$e,me){var Te,Pe,Ve=p,Qe=p,Mt=p;return Pe=null==(Te=H(pe))[0]?p:Te[0],Qe=null==Te[2]?p:Te[2],Mt=null==Te[3]?p:Te[3],(U((Ve=null==Te[1]?p:Te[1])["$include_dice?"]())||F(Mt["$include_dice?"]())||F(Qe["$nil?"]()))&&this.$raise(S("ParseError")),u(S("Node"),"Command").$new(Pe,Ve,Qe,Mt)},3),_(m,"$_reduce_3",function(pe,$e,me){return!1},3),_(m,"$_reduce_4",function(pe,$e,me){return!0},3),_(m,"$_reduce_6",function(pe,$e,me){return u(S("Node"),"UndecidedTarget").$instance()},3),_(m,"$_reduce_7",function(pe,$e,me){var Te,De,Pe,Ve,Qe;return Pe=pe["$[]"](0),De=this.$expand_negate("+",pe["$[]"](2)),Ve=null==(Te=H(De))[0]?p:Te[0],Qe=null==Te[1]?p:Te[1],u(S("Node"),"BinaryOp").$new(Pe,Ve,Qe)},3),_(m,"$_reduce_8",function(pe,$e,me){var Te,De,Pe,Ve,Qe;return Pe=pe["$[]"](0),De=this.$expand_negate("-",pe["$[]"](2)),Ve=null==(Te=H(De))[0]?p:Te[0],Qe=null==Te[1]?p:Te[1],u(S("Node"),"BinaryOp").$new(Pe,Ve,Qe)},3),_(m,"$_reduce_10",function(pe,$e,me){var Te,De;return Te=pe["$[]"](0),De=pe["$[]"](2),u(S("Node"),"BinaryOp").$new(Te,"*",De)},3),_(m,"$_reduce_11",function(pe,$e,me){var Te,De;return Te=pe["$[]"](0),De=pe["$[]"](2),pe["$[]"](3).$new(Te,De)},3),_(m,"$_reduce_13",function(pe,$e,me){return u(S("Node"),"DivideWithGameSystemDefault")},3),_(m,"$_reduce_14",function(pe,$e,me){return u(S("Node"),"DivideWithRoundingDown")},3),_(m,"$_reduce_15",function(pe,$e,me){return u(S("Node"),"DivideWithRoundingUp")},3),_(m,"$_reduce_16",function(pe,$e,me){return u(S("Node"),"DivideWithRoundingUp")},3),_(m,"$_reduce_17",function(pe,$e,me){return u(S("Node"),"DivideWithRoundingOff")},3),_(m,"$_reduce_18",function(pe,$e,me){return pe["$[]"](1)},3),_(m,"$_reduce_19",function(pe,$e,me){var Te=p;return Te=pe["$[]"](1),F(Te["$is_a?"](u(S("Node"),"Negate")))?Te.$body():u(S("Node"),"Negate").$new(Te)},3),_(m,"$_reduce_21",function(pe,$e,me){var De=p,Me=p;return De=pe["$[]"](0),Me=pe["$[]"](2),(F(De["$include_dice?"]())||F(Me["$include_dice?"]()))&&this.$raise(S("ParseError")),u(S("Node"),"DiceRoll").$new(De,Me)},3),_(m,"$_reduce_22",function(pe,$e,me){var De=p;return De=pe["$[]"](0),F(De["$include_dice?"]())&&this.$raise(S("ParseError")),u(S("Node"),"ImplicitSidesDiceRoll").$new(De)},3),_(m,"$_reduce_23",function(pe,$e,me){var Pe,De=p,Me=p,Ve=p;return De=pe["$[]"](0),Me=pe["$[]"](2),Pe=pe["$[]"](3)["$[]"]("filter"),Ve=pe["$[]"](3)["$[]"]("n_filtering"),se(Me,"implicit")&&F(Me["$include_dice?"]())&&this.$raise(S("ParseError")),(F(De["$include_dice?"]())||F(Ve["$include_dice?"]()))&&this.$raise(S("ParseError")),u(S("Node"),"DiceRollWithFilter").$new(De,Me,Ve,Pe)},3),_(m,"$_reduce_24",function(pe,$e,me){var De,Me=p;return De=u(S("Node"),"Number").$new(1),Me=pe["$[]"](1),F(Me["$include_dice?"]())&&this.$raise(S("ParseError")),F(Me["$instance_of?"](u(S("Node"),"Number")))&&oe(Me.$literal(),66)&&this.$raise(S("ParseError")),u(S("Node"),"DiceRoll").$new(De,Me)},3),_(m,"$_reduce_25",function(pe,$e,me){var De,Pe,Me=p,Ve=p;return De=u(S("Node"),"Number").$new(1),Me=pe["$[]"](1),Pe=pe["$[]"](2)["$[]"]("filter"),Ve=pe["$[]"](2)["$[]"]("n_filtering"),se(Me,"implicit")&&F(Me["$include_dice?"]())&&this.$raise(S("ParseError")),F(Ve["$include_dice?"]())&&this.$raise(S("ParseError")),F(Me["$instance_of?"](u(S("Node"),"Number")))&&oe(Me.$literal(),66)&&this.$raise(S("ParseError")),u(S("Node"),"DiceRollWithFilter").$new(De,Me,Ve,Pe)},3),_(m,"$_reduce_27",function(pe,$e,me){return"implicit"},3),_(m,"$_reduce_28",function(pe,$e,me){return pe["$[]"](0)},3),_(m,"$_reduce_29",function(pe,$e,me){return ue(["filter","n_filtering"],{filter:pe["$[]"](0),n_filtering:pe["$[]"](1)})},3),_(m,"$_reduce_30",function(pe,$e,me){return ue(["filter","n_filtering"],{filter:pe["$[]"](0),n_filtering:u(S("Node"),"Number").$new(1)})},3),_(m,"$_reduce_31",function(pe,$e,me){return u(u(S("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")},3),_(m,"$_reduce_32",function(pe,$e,me){return u(u(S("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")},3),_(m,"$_reduce_33",function(pe,$e,me){return u(u(S("Node"),"DiceRollWithFilter"),"KEEP_HIGHEST")},3),_(m,"$_reduce_34",function(pe,$e,me){return u(u(S("Node"),"DiceRollWithFilter"),"KEEP_LOWEST")},3),_(m,"$_reduce_35",function(pe,$e,me){return u(u(S("Node"),"DiceRollWithFilter"),"DROP_HIGHEST")},3),_(m,"$_reduce_36",function(pe,$e,me){return u(u(S("Node"),"DiceRollWithFilter"),"DROP_LOWEST")},3),_(m,"$_reduce_39",function(pe,$e,me){return u(S("Node"),"Parenthesis").$new(pe["$[]"](1))},3),_(m,"$_reduce_40",function(pe,$e,me){return u(S("Node"),"Number").$new(pe["$[]"](0))},3),_(m,"$_reduce_none",function(pe,$e,me){return pe["$[]"](0)},3)},Opal.modules["bcdice/common_command/add_dice/randomizer"]=function(a){var V,se,ee,N,P,g,b,C,G,J,H,y=[],w=a.nil,p=a.module,u=a.klass,k=a.const_set,v=a.def,D=a.eqeq,_=a.send,F=a.truthy;return V=y,se=H=[p(y[0],"BCDice")].concat(V),ee=J=[p(H[0],"CommonCommand")].concat(se),N=G=[p(J[0],"AddDice")].concat(ee),g=[P=u(G[0],null,"Randomizer")].concat(N),b=a.$r(g),(C=P.$$prototype).game_system=C.rand_source=C.rand_results=w,P.$attr_reader("rand_results"),k(g[0],"RandResult",b("Struct").$new("sides","value")),v(P,"$initialize",function(c,l){var f=this;return f.rand_source=c,f.game_system=l,f.rand_results=[]},2),v(P,"$roll",function(c,l){var x,f=this,m=w;return m=D(l,66)?_(b("Array"),"new",[c],function S(){var Z=null==S.$$s?this:S.$$s;return null==Z.rand_source&&(Z.rand_source=w),null==Z.game_system&&(Z.game_system=w),Z.rand_source.$roll_d66(Z.game_system.$d66_sort_type())},{$$arity:0,$$s:f}):D(l,9)&&F(f.game_system["$enabled_d9?"]())?_(b("Array"),"new",[c],function S(){var Z=null==S.$$s?this:S.$$s;return null==Z.rand_source&&(Z.rand_source=w),Z.rand_source.$roll_d9()},{$$arity:0,$$s:f}):f.rand_source.$roll_barabara(c,l),F(f.game_system["$sort_add_dice?"]())&&m["$sort!"](),x=_(m,"map",[],function(Z){return null==Z&&(Z=w),b("RandResult").$new(l,Z)},1),f.rand_results.$concat(x),m},2)},Opal.modules["bcdice/common_command/add_dice"]=function(a){var F,H,J,M,z,A,K,ee,se,V,y=a.top,w=[],p=a.nil,u=a.module,k=a.const_set,v=a.send,D=a.def;return y.$require("bcdice/normalize"),y.$require("bcdice/common_command/add_dice/parser"),y.$require("bcdice/common_command/add_dice/randomizer"),F=w,H=V=[u(w[0],"BCDice")].concat(F),J=se=[u(V[0],"CommonCommand")].concat(H),k((ee=[K=u(se[0],"AddDice")].concat(J))[0],"PREFIX_PATTERN",/[+\-(]*(\d+|D\d+)/.$freeze()),z=[M=a.get_singleton_class(K)].concat(ee),A=a.$r(z),D(M,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/reroll_dice/node"]=function(a){var ee,A,b,l,Z,le,ye,T,R,m,h,P,G,y=[],w=a.nil,p=a.module,u=a.klass,k=a.hash2,v=a.def,D=a.truthy,_=a.send,F=a.rb_lt,oe=a.rb_plus,V=a.rb_gt,L=a.eqeq,H=a.to_a,U=a.rb_minus,se=a.eqeqeq,ue=a.rb_le,J=a.rb_ge;return ee=y,A=G=[p(y[0],"BCDice")].concat(ee),b=P=[p(G[0],"CommonCommand")].concat(A),l=h=[p(P[0],"RerollDice")].concat(b),Z=m=[p(h[0],"Node")].concat(l),ye=[le=u(m[0],null,"Command")].concat(Z),T=a.$r(ye),(R=le.$$prototype).cmp_op=R.reroll_cmp_op=R.target_number_node=R.reroll_threshold_node=R.notations=R.source=w,v(le,"$initialize",function(j){var ve,de,we,ce,he,B,O,ne=this;if(null==j)j=k([],{});else if(!j.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(j.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(ve=j.$$smap.secret,!a.hasOwnProperty.call(j.$$smap,"notations"))throw a.ArgumentError.$new("missing keyword: notations");if(de=j.$$smap.notations,!a.hasOwnProperty.call(j.$$smap,"source"))throw a.ArgumentError.$new("missing keyword: source");return we=j.$$smap.source,null==(ce=j.$$smap.cmp_op)&&(ce=w),null==(he=j.$$smap.target_number)&&(he=w),null==(B=j.$$smap.reroll_cmp_op)&&(B=w),null==(O=j.$$smap.reroll_threshold)&&(O=w),ne.secret=ve,ne.notations=de,ne.cmp_op=ce,ne.target_number_node=he,ne.reroll_cmp_op=B,ne.reroll_threshold_node=O,ne.source=we},1),v(le,"$eval",function(j,ve){var de,we,he,B,ne,pe,$e,Te,ce=this,O=w,q=w,me=w,De=w,Me=w,Pe=w,Ve=w,Qe=w;return he=j.$round_type(),B=D(O=ce.cmp_op)?O:j.$default_cmp_op(),ne=D(O=D(q=ce.reroll_cmp_op)?q:B)?O:">=",pe=D(O=(de=ce.target_number_node)===w||null==de?w:_(de,"eval",[he]))?O:j.$default_target_number(),$e=D(O=D(q=(we=ce.reroll_threshold_node)===w||null==we?w:_(we,"eval",[he]))?q:j.$reroll_dice_reroll_threshold())?O:pe,me=T("RerollCondition").$new(ne,$e),Te=_(ce.notations,"map",[],function(Bt){return null==Bt&&(Bt=w),Bt.$to_dice(he)},1),D(_(Te,"all?",[],function(Bt){return null==Bt&&(Bt=w),me["$valid?"](Bt.$sides())},1))?(Me=(De=ce.$roll(Te,ve,me,j["$sort_barabara_dice?"]())).$flatten(),Pe=De.$take(ce.notations.$size()).$flatten().$count(1),Ve=D(B)?_(Me,"count",[],function(Bt){return null==Bt&&(Bt=w),Bt.$send(B,pe)},1):0,Qe=[ce.$expr(he,me,B,pe),_(De,"map",[],function(Bt){return null==Bt&&(Bt=w),Bt.$join(",")},1).$join(" + "),"\u6210\u529f\u6570"+Ve,j.$grich_text(Pe,Me.$size(),Ve)].$compact(),ce.$result_with_text(Qe.$join(" \uff1e "))):ce.$result_with_text(ce.source+" \uff1e \u6761\u4ef6\u304c\u9593\u9055\u3063\u3066\u3044\u307e\u3059\u30022R6>=5 \u3042\u308b\u3044\u306f 2R6[5] \u306e\u3088\u3046\u306b\u632f\u308a\u8db3\u3057\u76ee\u6a19\u5024\u3092\u6307\u5b9a\u3057\u3066\u304f\u3060\u3055\u3044\u3002")},2),le.$private(),v(le,"$roll",function(j,ve,de,we){var he=w,B=w,O=w,ne=w,q=w,pe=w;for(he=[],B=0;D(D(O=j["$empty?"]()["$!"]())?F(B,T("REROLL_LIMIT")):O);)ne=j.$shift(),B=oe(B,1),q=ne.$roll(ve),D(we)&&q["$sort!"](),he.$push(q),pe=_(q,"count",[],function(me){return null==me&&(me=w),de["$reroll?"](me)},1),D(V(pe,0))&&j.$push(T("Dice").$new(pe,ne.$sides()));return he},4),v(le,"$expr",function(j,ve,de,we){var he,B,O;return he=_(this.notations,"map",[],function(q){return null==q&&(q=w),q.$to_dice(j)},1).$join("+"),B=L(ve.$cmp_op(),de)?"":T("Format").$comparison_operator(ve.$cmp_op()),O=T("Format").$comparison_operator(de),"("+he+"["+B+ve.$threshold()+"]"+O+we+")"},4),v(le,"$result_with_text",function(j){return _(T("Result").$new(),"tap",[],function de(we){var ce=null==de.$$s?this:de.$$s,he=w;return null==ce.secret&&(ce.secret=w),null==we&&(we=w),_(we,"secret=",H(he=[ce.secret])),U(he.length,1),_(we,"text=",H(he=[j])),he[U(he.length,1)]},{$$arity:1,$$s:this})},1),function(x,S){var Z=u(x,null,"RerollCondition"),le=Z.$$prototype;le.threshold=le.cmp_op=w,Z.$attr_reader("cmp_op"),Z.$attr_reader("threshold"),v(Z,"$initialize",function(T,R){return this.cmp_op=T,this.threshold=R},2),v(Z,"$valid?",function(T){var R=this,ie=w;return!!D(R.threshold)&&(se("<=",ie=R.cmp_op)?F(R.threshold,T):se("<",ie)?ue(R.threshold,T):se(">=",ie)?V(R.threshold,1):se(">",ie)?J(R.threshold,1):!se("!=",ie)||a.Range.$new(1,T,!1)["$include?"](R.threshold))},1),v(Z,"$reroll?",function(T){return T.$send(this.cmp_op,this.threshold)},1)}(m[0]),function(x,S,Z){var le=u(x,null,"Notation"),ye=[le].concat(Z),T=a.$r(ye),R=le.$$prototype;R.times=R.sides=w,v(le,"$initialize",function(j,ve){return this.times=j,this.sides=ve},2),v(le,"$to_dice",function(j){var de,we;return de=this.times.$eval(j),we=this.sides.$eval(j),T("Dice").$new(de,we)},1)}(m[0],0,m),function(x,S){var Z=u(x,null,"Dice");return Z.$attr_reader("times","sides"),v(Z,"$initialize",function(ye,T){return this.times=ye,this.sides=T},2),v(Z,"$roll",function(ye){return ye.$roll_barabara(this.$times(),this.$sides())},1),v(Z,"$to_s",function(){return this.$times()+"R"+this.$sides()},0)}(m[0])},Opal.modules["bcdice/arithmetic/node"]=function(a){var ue,M,N,c,l,g,b,z,K,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.def,D=a.send2,_=a.find_super,F=a.eqeq,oe=a.const_set,V=a.eqeqeq,L=a.rb_divide,H=a.truthy,U=a.alias;return ue=y,M=K=[u(y[0],"BCDice")].concat(ue),N=z=[u(K[0],"Arithmetic")].concat(M),g=[u(z[0],"Node")].concat(N),b=a.$r(g),(l=(c=k(g[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=w,v(c,"$initialize",function(m,x,S){var Z=this;return Z.lhs=m,Z.op=x,Z.rhs=S},3),v(c,"$eval",function(m){var Z,x=this,S=w;return S=x.lhs.$eval(m),Z=x.rhs.$eval(m),S.$send(x.op,Z)},1),v(c,"$output",function(){var m=this;return""+m.lhs.$output()+m.op+m.rhs.$output()},0),v(c,"$s_exp",function(){var m=this;return"("+m.$op_for_s_exp()+" "+m.lhs.$s_exp()+" "+m.rhs.$s_exp()+")"},0),v(c,"$op_for_s_exp",function(){return this.op},0),function(C,h,c){var l=k(C,h,"DivideBase"),f=[l].concat(c),m=a.$r(f),x=l.$$prototype;x.lhs=x.rhs=x.op=w,v(l,"$initialize",function S(Z,le){return delete S.$$p,D(this,_(this,"initialize",S,!1,!0),"initialize",[Z,"/",le],null)},2),v(l,"$eval",function(Z){var ye,T;return ye=this.lhs.$eval(Z),T=this.rhs.$eval(Z),F(T,0)&&this.$raise(m("ZeroDivisionError")),this.$divide_and_round(ye,T,Z)},1),v(l,"$output",function S(){var Z=S.$$p||w;return delete S.$$p,""+D(this,_(this,"output",S,!1,!0),"output",[],Z)+this.$rounding_method()},0),l.$private(),v(l,"$rounding_method",function(){return p(this.$class(),"ROUNDING_METHOD")},0),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),v(l,"$divide_and_round",function(Z,le,ye){return this.$raise(m("NotImplementedError"))},3)}(g[0],b("BinaryOp"),g),function(C,h,c){var l=k(C,h,"DivideWithGameSystemDefault"),f=[l].concat(c),m=a.$r(f);oe(f[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(S,Z,le){var ye,T=w;return V(p(m("RoundType"),"CEIL"),ye=le)?L(S.$to_f(),Z).$ceil():V(p(m("RoundType"),"ROUND"),ye)?(T=L(S.$to_f(),Z),H(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()):L(S,Z).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithCeil"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){return L(x.$to_f(),S).$ceil()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithRound"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){var le=w;return le=L(x.$to_f(),S),H(le["$negative?"]())?le.$abs().$round()["$-@"]():le.$round()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithFloor"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){return L(x,S).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h){var c=k(C,null,"Negative");c.$$prototype.body=w,v(c,"$initialize",function(m){return this.body=m},1),v(c,"$eval",function(m){return this.body.$eval(m)["$-@"]()},1),v(c,"$output",function(){return"-"+this.body.$output()},0),v(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(g[0]),function(C,h){var c=k(C,null,"Parenthesis");c.$$prototype.expr=w,v(c,"$initialize",function(m){return this.expr=m},1),v(c,"$eval",function(m){return this.expr.$eval(m)},1),v(c,"$output",function(){return"("+this.expr.$output()+")"},0),v(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(g[0]),function(C,h){var c=k(C,null,"Number");return c.$$prototype.value=w,v(c,"$initialize",function(m){return this.value=m},1),v(c,"$eval",function(m){return this.value},1),v(c,"$output",function(){return this.value.$to_s()},0),U(c,"s_exp","output")}(g[0])},Opal.modules["bcdice/common_command/barabara_dice/parser"]=function(a){var se,ee,A,h,m,x,S,Z,le,ye,T,R,ie,de,c,l,f,P,g,G,J,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.hash,oe=a.const_set,V=a.hash2,L=a.to_ary,H=a.truthy;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/reroll_dice/node"),y.$require("bcdice/arithmetic/node"),se=w,ee=J=[k(w[0],"BCDice")].concat(se),A=G=[k(J[0],"CommonCommand")].concat(ee),P=[k(G[0],"BarabaraDice")].concat(A),g=a.$r(P),h=P,l=[c=v(P[0],u(g("Racc"),"Parser"),"Parser")].concat(h),f=a.$r(l),c.$$prototype.lexer=p,D(c,"$parse",function(O){return this.$new().$parse(O)},1),_(c,"$parse",function(O){try{return this.lexer=f("Lexer").$new(O),this.$do_parse()}catch(q){if(!a.rescue(q,[f("ParseError")]))throw q;try{return p}finally{a.pop_exception()}}},1),c.$private(),_(c,"$next_token",function(){return this.lexer.$next_token()},0),m=[13,9,3,9,24,25,9,9,9,26,18,19,8,12,8,18,19,8,8,8,9,4,9,38,36,37,39,18,19,18,19,8,9,8,9,27,28,24,25,18,19,18,19,8,9,8,9,27,28,27,28,18,19,18,19,8,10,8,14],x=[5,2,0,8,15,15,13,14,12,15,8,8,2,5,8,12,12,13,14,12,18,1,19,34,34,34,34,18,18,19,19,18,24,19,25,16,16,21,21,24,24,25,25,24,27,25,28,31,31,32,32,27,27,28,28,27,4,28,7],S=[-6,21,-1,p,56,-9,p,55,1,p,p,p,6,4,5,-5,24,p,18,20,p,28,p,p,30,32,p,42,44,p,p,36,38,p,19,p,p,p,p,p],Z=[-2,-25,-25,-3,-25,-4,-7,-25,-25,-24,40,-1,-25,-25,-25,-25,-11,-14,-25,-25,-22,-5,-6,-8,-25,-25,-23,-25,-25,-20,-21,-9,-10,-12,-15,-13,-16,-17,-18,-19],le=[7,1,6,15,2,29,30,21,31,32,5,7,23,22,33,34,11,35],ye=[7,1,6,5,2,9,9,5,8,8,3,7,7,6,9,9,4,10],T=[p,1,4,8,11,-5,0,-2,-16,-13,-17],R=[p,p,p,p,p,p,p,20,16,17,p],ie=[0,0,"racc_error",3,24,"_reduce_1",0,25,"_reduce_2",1,25,"_reduce_3",0,27,"_reduce_4",2,27,"_reduce_5",3,26,"_reduce_6",1,26,"_reduce_7",3,29,"_reduce_8",3,28,"_reduce_9",3,28,"_reduce_10",1,28,"_reduce_none",3,31,"_reduce_12",4,31,"_reduce_13",1,31,"_reduce_none",0,33,"_reduce_15",1,33,"_reduce_16",1,33,"_reduce_17",1,33,"_reduce_18",1,33,"_reduce_19",2,32,"_reduce_20",2,32,"_reduce_21",1,32,"_reduce_none",3,30,"_reduce_23",1,30,"_reduce_24"],de=F(!1,0,"error",1,"NUMBER",2,"B",3,"R",4,"U",5,"C",6,"F",7,"S",8,"PLUS",9,"MINUS",10,"ASTERISK",11,"SLASH",12,"PARENL",13,"PARENR",14,"BRACKETL",15,"BRACKETR",16,"LESS",17,"GREATER",18,"EQUAL",19,"NOT",20,"AT",21,"CMP_OP",22),oe(l[0],"Racc_arg",[m,x,Z,S,le,ye,R,T,23,ie,de,40,25,!0]),oe(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","B","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","add","dice","term","mul","unary","round_type"]),oe(l[0],"Racc_debug_parser",!1),_(c,"$_reduce_1",function(O,ne,q){return u(f("Node"),"Command").$new(V(["secret","notations","cmp_op","target_number"],{secret:O["$[]"](0),notations:O["$[]"](1),cmp_op:O["$[]"](2)["$[]"]("cmp_op"),target_number:O["$[]"](2)["$[]"]("target")}))},3),_(c,"$_reduce_2",function(O,ne,q){return!1},3),_(c,"$_reduce_3",function(O,ne,q){return!0},3),_(c,"$_reduce_4",function(O,ne,q){return V([],{})},3),_(c,"$_reduce_5",function(O,ne,q){var pe,Te,De;return De=null==(pe=L(O))[1]?p:pe[1],H(Te=null==pe[0]?p:pe[0])||this.$raise(f("ParseError")),V(["cmp_op","target"],{cmp_op:Te,target:De})},3),_(c,"$_reduce_6",function(O,ne,q){var pe=p;return(pe=O["$[]"](0)).$push(O["$[]"](2)),pe},3),_(c,"$_reduce_7",function(O,ne,q){return[O["$[]"](0)]},3),_(c,"$_reduce_8",function(O,ne,q){var pe,$e;return pe=O["$[]"](0),$e=O["$[]"](2),u(f("Node"),"Notation").$new(pe,$e)},3),_(c,"$_reduce_9",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"+",O["$[]"](2))},3),_(c,"$_reduce_10",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"-",O["$[]"](2))},3),_(c,"$_reduce_12",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"*",O["$[]"](2))},3),_(c,"$_reduce_13",function(O,ne,q){return O["$[]"](3).$new(O["$[]"](0),O["$[]"](2))},3),_(c,"$_reduce_15",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),_(c,"$_reduce_16",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithCeil")},3),_(c,"$_reduce_17",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithCeil")},3),_(c,"$_reduce_18",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithRound")},3),_(c,"$_reduce_19",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithFloor")},3),_(c,"$_reduce_20",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_21",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Negative").$new(O["$[]"](1))},3),_(c,"$_reduce_23",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_24",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Number").$new(O["$[]"](0))},3),_(c,"$_reduce_none",function(O,ne,q){return O["$[]"](0)},3)},Opal.modules["bcdice/common_command/barabara_dice"]=function(a){var F,H,J,M,z,A,K,ee,se,V,w=[],p=a.nil,u=a.module,k=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/barabara_dice/parser"),F=w,H=V=[u(w[0],"BCDice")].concat(F),J=se=[u(V[0],"CommonCommand")].concat(H),k((ee=[K=u(se[0],"BarabaraDice")].concat(J))[0],"PREFIX_PATTERN",/\d+B\d+/.$freeze()),z=[M=a.get_singleton_class(K)].concat(ee),A=a.$r(z),D(M,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/result"]=function(a){var oe,se,ee,ue,K,L,y=[],w=a.nil,u=a.klass,k=a.send,v=a.to_a,D=a.rb_minus,_=a.def;return oe=y,se=L=[(0,a.module)(y[0],"BCDice")].concat(oe),[ue=u(L[0],null,"Result")].concat(se),(K=ue.$$prototype).secret=K.success=K.failure=K.critical=K.fumble=w,_(ee=a.get_singleton_class(ue),"$success",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$failure",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$critical",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"critical=",v(g=[!0])),D(g.length,1),k(P,"success=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$fumble",function(z){return k(this.$new(),"tap",[],function(P){var g=w;return null==P&&(P=w),k(P,"text=",v(g=[z])),D(g.length,1),k(P,"fumble=",v(g=[!0])),D(g.length,1),k(P,"failure=",v(g=[!0])),g[D(g.length,1)]},1)},1),_(ee,"$nothing",function(){return"nothing"},0),_(ue,"$initialize",function(M){var G=this;return null==M&&(M=w),G.text=M,G.rands=w,G.detailed_rands=w,G.secret=!1,G.success=!1,G.failure=!1,G.critical=!1,G.fumble=!1},-1),ue.$attr_accessor("text","rands","detailed_rands"),ue.$attr_writer("secret","success","failure","critical","fumble"),_(ue,"$secret?",function(){return this.secret},0),_(ue,"$success?",function(){return this.success},0),_(ue,"$failure?",function(){return this.failure},0),_(ue,"$critical?",function(){return this.critical},0),_(ue,"$fumble?",function(){return this.fumble},0),_(ue,"$condition=",function(M){return this.success=M,this.failure=M["$!"]()},1)},Opal.modules["bcdice/common_command/tally_dice/node"]=function(a){var K,z,g,c,S,Z,le,ye,f,C,N,M,w=[],p=a.nil,u=a.module,k=a.klass,v=a.const_set,D=a.hash2,_=a.def,F=a.truthy,oe=a.rb_gt,V=a.send,L=a.not,H=a.eqeq,U=a.to_a,se=a.rb_minus,ue=a.alias;return a.top.$require("bcdice/result"),K=w,z=M=[u(w[0],"BCDice")].concat(K),g=N=[u(M[0],"CommonCommand")].concat(z),c=C=[u(N[0],"TallyDice")].concat(g),S=f=[u(C[0],"Node")].concat(c),le=[Z=k(f[0],null,"Command")].concat(S),ye=a.$r(le),Z.$$prototype.notation=p,v(le[0],"MAX_SIDES",20),_(Z,"$initialize",function(ie){var j,ve;if(null==ie)ie=D([],{});else if(!ie.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(ie.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(j=ie.$$smap.secret,!a.hasOwnProperty.call(ie.$$smap,"notation"))throw a.ArgumentError.$new("missing keyword: notation");return ve=ie.$$smap.notation,this.secret=j,this.notation=ve},1),_(Z,"$eval",function(ie,j){var de=p,we=p,ce=p,he=p,B=p,O=p;return de=this.notation.$to_dice(ie.$round_type()),F(de["$valid?"]())?F(oe(de.$sides(),ye("MAX_SIDES")))?ye("Result").$new("("+de+") \uff1e \u9762\u6570\u306f1\u4ee5\u4e0a\u3001"+ye("MAX_SIDES")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(we=de.$roll(j),ce=(F(ie["$sort_barabara_dice?"]())?we.$sort():we).$join(","),he=V(V(we,"group_by",[],"itself".$to_proc()),"transform_values",[],"length".$to_proc()),B=V(a.Range.$new(1,de.$sides(),!1),"map",[],function(q){var pe;return null==q&&(q=p),pe=he.$fetch(q,0),H(pe,0)&&L(de["$show_zeros?"]())?p:"["+q+"]\xd7"+he.$fetch(q,0)},1),O=["("+de+")",ce,B.$compact().$join(", ")].$compact(),V(ye("Result").$new(),"tap",[],function ne(q){var pe=null==ne.$$s?this:ne.$$s,$e=p;return null==pe.secret&&(pe.secret=p),null==q&&(q=p),V(q,"secret=",U($e=[pe.secret])),se($e.length,1),$e=[O.$join(" \uff1e ")],V(q,"text=",U($e)),$e[se($e.length,1)]},{$$arity:1,$$s:this})):p},2),function(m,x,S){var Z=k(m,null,"Notation"),le=[Z].concat(S),ye=a.$r(le),T=Z.$$prototype;T.times=T.sides=T.show_zeros=p,Z.$attr_reader("times"),Z.$attr_reader("sides"),Z.$attr_reader("show_zeros"),_(Z,"$initialize",function(ie){var j,ve,de;if(null==ie)ie=D([],{});else if(!ie.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(ie.$$smap,"times"))throw a.ArgumentError.$new("missing keyword: times");if(j=ie.$$smap.times,!a.hasOwnProperty.call(ie.$$smap,"sides"))throw a.ArgumentError.$new("missing keyword: sides");if(ve=ie.$$smap.sides,!a.hasOwnProperty.call(ie.$$smap,"show_zeros"))throw a.ArgumentError.$new("missing keyword: show_zeros");return de=ie.$$smap.show_zeros,this.times=j,this.sides=ve,this.show_zeros=de},1),_(Z,"$to_dice",function(ie){var ve,de,j=this;return ve=j.times.$eval(ie),de=j.sides.$eval(ie),ye("Dice").$new(D(["times","sides","show_zeros"],{times:ve,sides:de,show_zeros:j.show_zeros}))},1)}(f[0],0,f),function(m,x){var S=k(m,null,"Dice"),Z=S.$$prototype;return Z.times=Z.sides=Z.show_zeros=p,S.$attr_reader("times"),S.$attr_reader("sides"),S.$attr_reader("show_zeros"),ue(S,"show_zeros?","show_zeros"),_(S,"$initialize",function(ye){var T,R,ie,j=this;if(null==ye)ye=D([],{});else if(!ye.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(ye.$$smap,"times"))throw a.ArgumentError.$new("missing keyword: times");if(T=ye.$$smap.times,!a.hasOwnProperty.call(ye.$$smap,"sides"))throw a.ArgumentError.$new("missing keyword: sides");if(R=ye.$$smap.sides,!a.hasOwnProperty.call(ye.$$smap,"show_zeros"))throw a.ArgumentError.$new("missing keyword: show_zeros");return ie=ye.$$smap.show_zeros,j.times=T,j.sides=R,j.show_zeros=ie},1),_(S,"$valid?",function(){var T;return F(T=oe(this.times,0))?oe(this.sides,0):T},0),_(S,"$roll",function(ye){return ye.$roll_barabara(this.times,this.sides)},1),_(S,"$to_s",function(){var T;return T=F(this.show_zeros)?"Z":"Y",this.times+"T"+T+this.sides},0)}(f[0])},Opal.modules["bcdice/common_command/tally_dice/parser"]=function(a){var H,J,G,b,l,f,m,x,S,Z,le,ye,T,j,C,h,c,A,N,ee,se,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.hash,oe=a.const_set,V=a.hash2;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/tally_dice/node"),y.$require("bcdice/arithmetic/node"),H=w,J=se=[k(w[0],"BCDice")].concat(H),G=ee=[k(se[0],"CommonCommand")].concat(J),A=[k(ee[0],"TallyDice")].concat(G),N=a.$r(A),b=A,h=[C=v(A[0],u(N("Racc"),"Parser"),"Parser")].concat(b),c=a.$r(h),C.$$prototype.lexer=p,D(C,"$parse",function(he){return this.$new().$parse(he)},1),_(C,"$parse",function(he){try{return this.lexer=c("Lexer").$new(he),this.$do_parse()}catch(O){if(!a.rescue(O,[c("ParseError")]))throw O;try{return p}finally{a.pop_exception()}}},1),C.$private(),_(C,"$next_token",function(){return this.lexer.$next_token()},0),l=[8,8,18,19,20,21,8,8,8,22,14,15,3,7,7,14,15,14,15,7,7,7,8,4,8,35,33,34,36,8,9,14,15,14,15,7,8,7,14,15,23,24,7,23,24,14,15,23,24,7,10],f=[2,7,10,10,11,11,14,17,15,11,7,7,0,2,7,14,14,15,15,14,17,15,20,1,21,31,31,31,31,23,4,20,20,21,21,20,24,21,23,23,12,12,23,28,28,24,24,29,29,24,6],m=[2,23,-2,p,30,p,47,-1,p,p,-2,-7,27,p,4,6,p,5,p,p,20,22,p,27,34,p,p,p,30,34,p,19,p,p,p,p,p],x=[-2,-23,-23,-3,-23,-1,-23,-23,-22,37,-23,-23,-9,-12,-23,-23,-20,-23,-5,-6,-23,-23,-21,-23,-23,-18,-19,-4,-7,-8,-10,-13,-11,-14,-15,-16,-17],S=[6,25,26,12,1,2,5,17,11,32,30,31,p,p,p,27,28,29],Z=[4,8,8,7,1,2,3,5,6,9,8,8,p,p,p,4,7,7],le=[p,4,5,4,-2,-3,1,-4,-13,-22],ye=[p,p,p,p,16,p,p,p,13,p],T=[0,0,"racc_error",2,18,"_reduce_1",0,19,"_reduce_2",1,19,"_reduce_3",4,20,"_reduce_4",1,22,"_reduce_5",1,22,"_reduce_6",3,23,"_reduce_7",3,23,"_reduce_8",1,23,"_reduce_none",3,24,"_reduce_10",4,24,"_reduce_11",1,24,"_reduce_none",0,26,"_reduce_13",1,26,"_reduce_14",1,26,"_reduce_15",1,26,"_reduce_16",1,26,"_reduce_17",2,25,"_reduce_18",2,25,"_reduce_19",1,25,"_reduce_none",3,21,"_reduce_21",1,21,"_reduce_22"],j=F(!1,0,"error",1,"NUMBER",2,"T",3,"Y",4,"Z",5,"R",6,"U",7,"C",8,"F",9,"S",10,"PLUS",11,"MINUS",12,"ASTERISK",13,"SLASH",14,"PARENL",15,"PARENR",16),oe(h[0],"Racc_arg",[l,f,x,m,S,Z,ye,le,17,T,j,37,23,!0]),oe(h[0],"Racc_token_to_s_table",["$end","error","NUMBER","T","Y","Z","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","notation","term","show_zeros","add","mul","unary","round_type"]),oe(h[0],"Racc_debug_parser",!1),_(C,"$_reduce_1",function(he,B,O){return u(c("Node"),"Command").$new(V(["secret","notation"],{secret:he["$[]"](0),notation:he["$[]"](1)}))},3),_(C,"$_reduce_2",function(he,B,O){return!1},3),_(C,"$_reduce_3",function(he,B,O){return!0},3),_(C,"$_reduce_4",function(he,B,O){return u(c("Node"),"Notation").$new(V(["times","sides","show_zeros"],{times:he["$[]"](0),sides:he["$[]"](3),show_zeros:he["$[]"](2)}))},3),_(C,"$_reduce_5",function(he,B,O){return!1},3),_(C,"$_reduce_6",function(he,B,O){return!0},3),_(C,"$_reduce_7",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))},3),_(C,"$_reduce_8",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))},3),_(C,"$_reduce_10",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))},3),_(C,"$_reduce_11",function(he,B,O){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))},3),_(C,"$_reduce_13",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),_(C,"$_reduce_14",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithCeil")},3),_(C,"$_reduce_15",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithCeil")},3),_(C,"$_reduce_16",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithRound")},3),_(C,"$_reduce_17",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithFloor")},3),_(C,"$_reduce_18",function(he,B,O){return he["$[]"](1)},3),_(C,"$_reduce_19",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))},3),_(C,"$_reduce_21",function(he,B,O){return he["$[]"](1)},3),_(C,"$_reduce_22",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))},3),_(C,"$_reduce_none",function(he,B,O){return he["$[]"](0)},3)},Opal.modules["bcdice/common_command/tally_dice"]=function(a){var F,H,J,M,z,A,K,ee,se,V,w=[],p=a.nil,u=a.module,k=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/tally_dice/parser"),F=w,H=V=[u(w[0],"BCDice")].concat(F),J=se=[u(V[0],"CommonCommand")].concat(H),k((ee=[K=u(se[0],"TallyDice")].concat(J))[0],"PREFIX_PATTERN",/\d+T[YZ]\d+/.$freeze()),z=[M=a.get_singleton_class(K)].concat(ee),A=a.$r(z),D(M,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/calc/node"]=function(a){var U,K,z,g,l,f,m,x,C,N,M,ue,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.hash2,_=a.def,F=a.truthy,oe=a.send,V=a.to_a,L=a.rb_minus;return a.top.$require("bcdice/arithmetic/node"),U=w,K=ue=[k(w[0],"BCDice")].concat(U),z=M=[k(ue[0],"CommonCommand")].concat(K),g=N=[k(M[0],"Calc")].concat(z),l=C=[k(N[0],"Node")].concat(g),m=[f=v(C[0],null,"Command")].concat(l),x=a.$r(m),f.$$prototype.expr=p,_(f,"$initialize",function(le){var ye,T;if(null==le)le=D([],{});else if(!le.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(le.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(ye=le.$$smap.secret,!a.hasOwnProperty.call(le.$$smap,"expr"))throw a.ArgumentError.$new("missing keyword: expr");return T=le.$$smap.expr,this.secret=ye,this.expr=T},1),_(f,"$eval",function(le){var T,R,ye=this;return T=function(){try{return ye.expr.$eval(le).$to_i()}catch(ie){if(!a.rescue(ie,[x("ZeroDivisionError")]))throw ie;try{return"\u30bc\u30ed\u9664\u7b97\u304c\u767a\u751f\u3057\u305f\u305f\u3081\u8a08\u7b97\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f"}finally{a.pop_exception()}}}(),R=F(ye.expr["$is_a?"](u(u(x("Arithmetic"),"Node"),"Parenthesis")))?ye.expr.$output():"("+ye.expr.$output()+")",oe(x("Result").$new(),"tap",[],function ie(j){var ve=null==ie.$$s?this:ie.$$s,de=p;return null==ve.secret&&(ve.secret=p),null==j&&(j=p),oe(j,"secret=",V(de=[ve.secret])),L(de.length,1),oe(j,"text=",V(de=["c"+R+" \uff1e "+T])),de[L(de.length,1)]},{$$arity:1,$$s:ye})},1)},Opal.modules["bcdice/common_command/calc/parser"]=function(a){var H,J,G,b,l,f,m,x,S,Z,le,ye,T,j,C,h,c,A,N,ee,se,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.hash,oe=a.const_set,V=a.hash2;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/calc/node"),y.$require("bcdice/arithmetic/node"),H=w,J=se=[k(w[0],"BCDice")].concat(H),G=ee=[k(se[0],"CommonCommand")].concat(J),A=[k(ee[0],"Calc")].concat(G),N=a.$r(A),b=A,h=[C=v(A[0],u(N("Racc"),"Parser"),"Parser")].concat(b),c=a.$r(h),C.$$prototype.lexer=p,D(C,"$parse",function(he){return this.$new().$parse(he)},1),_(C,"$parse",function(he){try{return this.lexer=c("Lexer").$new(he),this.$do_parse()}catch(O){if(!a.rescue(O,[c("ParseError")]))throw O;try{return p}finally{a.pop_exception()}}},1),C.$private(),_(C,"$next_token",function(){return this.lexer.$next_token()},0),l=[14,3,14,15,16,4,10,11,10,11,13,14,13,14,17,18,5,10,11,10,11,13,14,13,14,17,18,6,10,11,10,11,13,14,13,14,17,18,p,10,11,10,11,13,p,13,15,16,p,p,p,26,30,28,29,31],f=[5,0,10,7,7,1,5,5,10,10,5,11,10,13,8,8,2,11,11,13,13,11,15,13,16,22,22,4,15,15,16,16,15,17,16,18,23,23,p,17,17,18,18,17,p,18,21,21,p,p,p,21,25,25,25,25],m=[-6,5,11,p,27,-2,p,-5,4,p,0,9,p,11,p,20,22,31,33,p,p,38,15,26,p,49,p,p,p,p,p,p],x=[-2,-20,-20,-3,-20,-20,32,-1,-6,-9,-20,-20,-17,-20,-19,-20,-20,-20,-20,-15,-16,-20,-4,-5,-7,-10,-18,-8,-11,-12,-13,-14],S=[7,1,19,20,22,23,2,27,21,24,25],Z=[3,1,5,5,4,4,2,6,3,5,5],le=[p,1,6,-5,-11,-8,-18,p],ye=[p,p,p,p,8,9,p,12],T=[0,0,"racc_error",3,15,"_reduce_1",0,16,"_reduce_2",1,16,"_reduce_3",3,17,"_reduce_4",3,17,"_reduce_5",1,17,"_reduce_none",3,18,"_reduce_7",4,18,"_reduce_8",1,18,"_reduce_none",0,20,"_reduce_10",1,20,"_reduce_11",1,20,"_reduce_12",1,20,"_reduce_13",1,20,"_reduce_14",2,19,"_reduce_15",2,19,"_reduce_16",1,19,"_reduce_none",3,21,"_reduce_18",1,21,"_reduce_19"],j=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13),oe(h[0],"Racc_arg",[l,f,x,m,S,Z,ye,le,14,T,j,32,20,!0]),oe(h[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","expr","secret","add","mul","unary","round_type","term"]),oe(h[0],"Racc_debug_parser",!1),_(C,"$_reduce_1",function(he,B,O){return u(c("Node"),"Command").$new(V(["secret","expr"],{secret:he["$[]"](0),expr:he["$[]"](2)}))},3),_(C,"$_reduce_2",function(he,B,O){return!1},3),_(C,"$_reduce_3",function(he,B,O){return!0},3),_(C,"$_reduce_4",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"+",he["$[]"](2))},3),_(C,"$_reduce_5",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"-",he["$[]"](2))},3),_(C,"$_reduce_7",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"BinaryOp").$new(he["$[]"](0),"*",he["$[]"](2))},3),_(C,"$_reduce_8",function(he,B,O){return he["$[]"](3).$new(he["$[]"](0),he["$[]"](2))},3),_(C,"$_reduce_10",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),_(C,"$_reduce_11",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithCeil")},3),_(C,"$_reduce_12",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithCeil")},3),_(C,"$_reduce_13",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithRound")},3),_(C,"$_reduce_14",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"DivideWithFloor")},3),_(C,"$_reduce_15",function(he,B,O){return he["$[]"](1)},3),_(C,"$_reduce_16",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"Negative").$new(he["$[]"](1))},3),_(C,"$_reduce_18",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"Parenthesis").$new(he["$[]"](1))},3),_(C,"$_reduce_19",function(he,B,O){return u(u(c("Arithmetic"),"Node"),"Number").$new(he["$[]"](0))},3),_(C,"$_reduce_none",function(he,B,O){return he["$[]"](0)},3)},Opal.modules["bcdice/common_command/calc"]=function(a){var F,H,J,M,z,A,K,ee,se,V,w=[],p=a.nil,u=a.module,k=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/calc/parser"),F=w,H=V=[u(w[0],"BCDice")].concat(F),J=se=[u(V[0],"CommonCommand")].concat(H),k((ee=[K=u(se[0],"Calc")].concat(J))[0],"PREFIX_PATTERN",/C[+\-(]*\d+/.$freeze()),z=[M=a.get_singleton_class(K)].concat(ee),A=a.$r(z),D(M,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g.$round_type()])},3)},Opal.modules["bcdice/common_command/choice"]=function(a){var ee,A,C,x,Z,h,c,l,f,P,G,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.const_set,_=a.hash2,F=a.send,oe=a.def,V=a.truthy,L=a.eqeq,H=a.eqeqeq,U=a.rb_lt,se=a.rb_gt,ue=a.to_a,J=a.rb_minus;return a.top.$require("strscan"),ee=w,A=G=[k(w[0],"BCDice")].concat(ee),C=P=[k(G[0],"CommonCommand")].concat(A),c=[h=v(P[0],null,"Choice")].concat(C),l=a.$r(c),(f=h.$$prototype).items=f.takes=f.block_delimiter=p,D(c[0],"PREFIX_PATTERN",/choice/.$freeze()),x=c,D((Z=[k(c[0],"BlockDelimiter")].concat(x))[0],"BRACKET","bracket"),D(Z[0],"PAREN","paren"),D(Z[0],"SPACE","space"),D(c[0],"DELIMITER",_(["bracket","paren","space"],{bracket:/,/,paren:/,/,space:/\s+/}).$freeze()),D(c[0],"DELIMITER_CHAR",_(["bracket","paren","space"],{bracket:", ",paren:", ",space:" "}).$freeze()),D(c[0],"TERMINATION",_(["bracket","paren","space"],{bracket:/\]/,paren:/\)/,space:/$/}).$freeze()),D(c[0],"SUFFIX",_(["bracket","paren","space"],{bracket:"]",paren:")",space:""}).$freeze()),function(m,x){var S=[m].concat(x),Z=a.$r(S);oe(m,"$eval",function(ye,T,R){var ie;return(ie=this.$parse(ye))===p||null==ie?p:F(ie,"roll",[R])},3),m.$private(),oe(m,"$parse",function(ye){var T,ve,ce,he,B,j=p,de=p,we=p,O=p,ne=p,q=p;if((j=Z("StringScanner").$new(ye)).$skip(/\s+/),ve=j.$scan(/S/i)["$nil?"]()["$!"](),!V(j.$scan(/choice/i))||(de=V(we=(T=j.$scan(/\d+/))===p||null==T?p:F(T,"to_i",[]))?we:1,L(de,0)))return p;for(ce=H("[",we=j.$scan(/\(|\[|\s+/))?u(Z("BlockDelimiter"),"BRACKET"):H("(",we)?u(Z("BlockDelimiter"),"PAREN"):H(Z("String"),we)?u(Z("BlockDelimiter"),"SPACE"):p,he=Z("DELIMITER")["$[]"](ce),B=Z("TERMINATION")["$[]"](ce),O=[];V(ne=j.$scan_until(he));)O.$push(ne.$delete_suffix(","));return q=j.$scan_until(B),!V(q)||(O.$push(q.$delete_suffix(Z("SUFFIX")["$[]"](ce))),O=F(F(O,"map",[],"strip".$to_proc()),"reject",[],"empty?".$to_proc()),L(O.$size(),1)&&(O=this.$parse_multi_item_shorthand(O.$first())),V(O["$empty?"]())||V(U(O.$size(),de)))?p:this.$new(_(["secret","block_delimiter","takes","items"],{secret:ve,block_delimiter:ce,takes:de,items:O}))},1),oe(m,"$parse_multi_item_shorthand",function(ye){var R,ie;return V(R=V(ie=this.$parse_multi_nums_shorthand(ye))?ie:this.$parse_multi_chars_shorthand(ye))?R:[]},1),oe(m,"$parse_multi_nums_shorthand",function(ye){var T=p,R=p,ie=p;return T=/^(\d+)-(\d+)$/.$match(ye),!V(T)||(R=T["$[]"](1).$to_i(),ie=T["$[]"](2).$to_i(),V(se(R,ie)))?p:R.$upto(ie).$to_a()},1),oe(m,"$parse_multi_chars_shorthand",function(ye){var R,T=p,ie=p,j=p;return T=V(R=/^([a-z])-([a-z])$/.$match(ye))?R:/^([A-Z])-([A-Z])$/.$match(ye),!V(T)||(ie=T["$[]"](1),j=T["$[]"](2),V(se(ie,j)))?p:ie.$upto(j).$to_a()},1)}(a.get_singleton_class(h),c),oe(h,"$initialize",function(x){var S,Z,le,ye,T=this;if(null==x)x=_([],{});else if(!x.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(x.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(S=x.$$smap.secret,!a.hasOwnProperty.call(x.$$smap,"block_delimiter"))throw a.ArgumentError.$new("missing keyword: block_delimiter");if(Z=x.$$smap.block_delimiter,!a.hasOwnProperty.call(x.$$smap,"takes"))throw a.ArgumentError.$new("missing keyword: takes");if(le=x.$$smap.takes,!a.hasOwnProperty.call(x.$$smap,"items"))throw a.ArgumentError.$new("missing keyword: items");return ye=x.$$smap.items,T.secret=S,T.block_delimiter=Z,T.takes=le,T.items=ye},1),oe(h,"$roll",function(x){var S=this,Z=p,le=p;return V(se(S.items.$size(),100))?l("Result").$new("\u9805\u76ee\u6570\u306f100\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):(Z=S.items.$dup(),le=[],F(S.takes,"times",[],function(){var T;return T=x.$roll_index(Z.$size()),le["$<<"](Z.$delete_at(T))},0),F(l("Result").$new(),"tap",[],function ye(T){var ie,R=null==ye.$$s?this:ye.$$s,j=p;return null==R.block_delimiter&&(R.block_delimiter=p),null==R.secret&&(R.secret=p),null==T&&(T=p),ie=le.$join(l("DELIMITER_CHAR")["$[]"](R.block_delimiter)),F(T,"secret=",ue(j=[R.secret])),J(j.length,1),j=["("+R.$expr()+") \uff1e "+ie],F(T,"text=",ue(j)),j[J(j.length,1)]},{$$arity:1,$$s:S}))},1),oe(h,"$expr",function(){var S,Z,x=this;return S=L(x.takes,1)?p:x.takes,H(u(l("BlockDelimiter"),"SPACE"),Z=x.block_delimiter)?"choice"+S+" "+x.items.$join(" "):H(u(l("BlockDelimiter"),"BRACKET"),Z)?"choice"+S+"["+x.items.$join(",")+"]":H(u(l("BlockDelimiter"),"PAREN"),Z)?"choice"+S+"("+x.items.$join(",")+")":p},0)},Opal.modules["bcdice/common_command/d66_dice"]=function(a){var J,G,g,l,m,x,b,C,h,A,ee,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.const_set,D=a.send,_=a.def,F=a.truthy,oe=a.hash2,V=a.eqeqeq,L=a.to_a,H=a.rb_minus,U=a.rb_plus,se=a.rb_times;return J=y,G=ee=[u(y[0],"BCDice")].concat(J),g=A=[u(ee[0],"CommonCommand")].concat(G),C=[b=k(A[0],null,"D66Dice")].concat(g),h=a.$r(C),b.$$prototype.sort_type=w,v(C[0],"PREFIX_PATTERN",/D66/.$freeze()),m=[l=a.get_singleton_class(b)].concat(C),x=a.$r(m),_(l,"$eval",function(Z,le,ye){var T;return(T=this.$parse(Z,le))===w||null==T?w:D(T,"eval",[ye])},3),l.$private(),_(l,"$parse",function(Z,le){var T=w,R=w;return Z=Z.$split(" ",2).$first(),T=/^(S)?D66([ANSD])?$/i.$match(Z.$upcase()),F(T)?this.$new(oe(["secret","sort_type","suffix"],{secret:T["$[]"](1)["$nil?"]()["$!"](),sort_type:F(R=this.$sort_type_from_suffix(T["$[]"](2)))?R:le.$d66_sort_type(),suffix:T["$[]"](2)})):w},2),_(l,"$sort_type_from_suffix",function(Z){var le;return V("A",le=Z)||V("S",le)?p(x("D66SortType"),"ASC"):V("D",le)?p(x("D66SortType"),"DESC"):V("N",le)?p(x("D66SortType"),"NO_SORT"):w},1),_(b,"$initialize",function(f){var m,x,S,Z=this;if(null==f)f=oe([],{});else if(!f.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(f.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(m=f.$$smap.secret,!a.hasOwnProperty.call(f.$$smap,"sort_type"))throw a.ArgumentError.$new("missing keyword: sort_type");if(x=f.$$smap.sort_type,!a.hasOwnProperty.call(f.$$smap,"suffix"))throw a.ArgumentError.$new("missing keyword: suffix");return S=f.$$smap.suffix,Z.secret=m,Z.sort_type=x,Z.suffix=S},1),_(b,"$eval",function(f){var x;return x=this.$roll(f),D(h("Result").$new(),"tap",[],function S(Z){var le=null==S.$$s?this:S.$$s,ye=w;return null==le.secret&&(le.secret=w),null==le.suffix&&(le.suffix=w),null==Z&&(Z=w),D(Z,"secret=",L(ye=[le.secret])),H(ye.length,1),D(Z,"text=",L(ye=["(D66"+le.suffix+") \uff1e "+x])),ye[H(ye.length,1)]},{$$arity:1,$$s:this})},1),b.$private(),_(b,"$roll",function(f){var S,x=w;return x=D(h("Array"),"new",[2],function(){return f.$roll_once(6)},0),V(p(h("D66SortType"),"ASC"),S=this.sort_type)?x["$sort!"]():V(p(h("D66SortType"),"DESC"),S)&&x["$sort!"]()["$reverse!"](),U(se(x["$[]"](0),10),x["$[]"](1))},1)},Opal.modules["bcdice/common_command/repeat"]=function(a){var ue,M,P,c,f,m,g,b,C,h,z,K,w=[],p=a.nil,u=a.module,k=a.klass,v=a.const_set,D=a.send,_=a.def,F=a.truthy,oe=a.hash2,V=a.to_a,L=a.rb_minus,H=a.eqeq,U=a.rb_lt;return a.top.$require("strscan"),ue=w,M=K=[u(w[0],"BCDice")].concat(ue),P=z=[u(K[0],"CommonCommand")].concat(M),b=[g=k(z[0],null,"Repeat")].concat(P),C=a.$r(b),(h=g.$$prototype).times=h.trailer=h.secret=p,v(b[0],"PREFIX_PATTERN",/(repeat|rep|x)\d+/.$freeze()),v(b[0],"REPEAT_LIMIT",100),f=[c=a.get_singleton_class(g)].concat(b),m=a.$r(f),_(c,"$eval",function(S,Z,le){var ye;return(ye=this.$parse(S))===p||null==ye?p:D(ye,"roll",[Z,le])},3),c.$private(),_(c,"$parse",function(S){var Z,T,ye=p,R=p,ie=p,j=p,ve=p;return T=(ye=m("StringScanner").$new(S)).$scan(/s/i)["$nil?"]()["$!"](),R=ye.$scan(/repeat|rep|x/i),ie=(Z=ye.$scan(/\d+/))===p||null==Z?p:D(Z,"to_i",[]),j=ye.$scan(/\s+/),F(R["$nil?"]())||F(ie["$nil?"]())||F(j["$nil?"]())||(ve=ye.$post_match(),F(ve["$nil?"]())||F(ve["$empty?"]()))?p:this.$new(oe(["secret","times","trailer"],{secret:T,times:ie,trailer:ve}))},1),_(g,"$initialize",function(l){var f,m,x,S=this;if(null==l)l=oe([],{});else if(!l.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(l.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(f=l.$$smap.secret,!a.hasOwnProperty.call(l.$$smap,"times"))throw a.ArgumentError.$new("missing keyword: times");if(m=l.$$smap.times,!a.hasOwnProperty.call(l.$$smap,"trailer"))throw a.ArgumentError.$new("missing keyword: trailer");return x=l.$$smap.trailer,S.secret=f,S.times=m,S.trailer=x},1),_(g,"$roll",function(l,f){var x,m=this,S=p,Z=p,le=p,ye=p;return x=m.$validate(),F(x)?x:(S=D(C("Array"),"new",[m.times],function T(){var j,R=null==T.$$s?this:T.$$s,ie=p;return null==R.trailer&&(R.trailer=p),ie=l.$class().$new(R.trailer),D(ie,"randomizer=",V(j=[f])),L(j.length,1),ie.$eval()},{$$arity:0,$$s:m}),H(D(S,"count",[],function(R){return null==R&&(R=p),R["$=="](p)},1),m.times)?m.$result_with_text("\u7e70\u308a\u8fd4\u3057\u5bfe\u8c61\u306e\u30b3\u30de\u30f3\u30c9\u304c\u5b9f\u884c\u3067\u304d\u307e\u305b\u3093\u3067\u3057\u305f ("+m.trailer+")"):(Z=D(S.$map(),"with_index",[1],function(R,ie){return null==R&&(R=p),null==ie&&(ie=p),"#"+ie+"\n"+R.$text()},2).$join("\n\n"),le=F(ye=m.secret)?ye:D(S,"any?",[],"secret?".$to_proc()),D(C("Result").$new(),"tap",[],function(R){var ie=p;return null==R&&(R=p),D(R,"secret=",V(ie=[le])),L(ie.length,1),D(R,"text=",V(ie=[Z])),ie[L(ie.length,1)]},1)))},2),g.$private(),_(g,"$validate",function(){var l=this;return F(/^(repeat|rep|x)\d+/["$match?"](l.trailer))?l.$result_with_text("Repeat\u30b3\u30de\u30f3\u30c9\u306e\u91cd\u8907\u306f\u3067\u304d\u307e\u305b\u3093"):F(U(l.times,1))||F(U(C("REPEAT_LIMIT"),l.times))?l.$result_with_text("\u7e70\u308a\u8fd4\u3057\u56de\u6570\u306f1\u4ee5\u4e0a\u3001"+C("REPEAT_LIMIT")+"\u4ee5\u4e0b\u3068\u3057\u3066\u304f\u3060\u3055\u3044"):p},0),_(g,"$result_with_text",function(l){return D(C("Result").$new(),"tap",[],function m(x){var S=null==m.$$s?this:m.$$s,Z=p;return null==S.secret&&(S.secret=p),null==x&&(x=p),D(x,"secret=",V(Z=[S.secret])),L(Z.length,1),D(x,"text=",V(Z=[l])),Z[L(Z.length,1)]},{$$arity:1,$$s:this})},1)},Opal.modules["bcdice/format"]=function(a){var oe,U,se,ue,J,L,y=[],w=a.nil,p=a.module,u=a.eqeqeq,k=a.def,v=a.truthy,D=a.eqeq,_=a.rb_gt;return oe=y,U=L=[p(y[0],"BCDice")].concat(oe),ue=[se=p(L[0],"Format")].concat(U),J=a.$r(ue),se.$module_function(),k(se,"$comparison_operator",function(ee){var M;return u("==",M=ee)?"=":u("!=",M)?"<>":u(J("Symbol"),M)?ee.$to_s():w},1),k(se,"$modifier",function(ee){return v(ee["$nil?"]())?w:D(ee,0)?"":v(_(ee,0))?"+"+ee:ee.$to_s()},1)},Opal.modules["bcdice/common_command/barabara_dice/result"]=function(a){var V,se,ee,N,J,H,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.send2,_=a.find_super,F=a.def;return a.top.$require("bcdice/result"),V=w,se=H=[k(w[0],"BCDice")].concat(V),ee=J=[k(H[0],"CommonCommand")].concat(se),(N=v([k(J[0],"BarabaraDice")].concat(ee)[0],u(u("BCDice"),"Result"),"Result")).$attr_accessor("last_dice_list_list"),N.$attr_accessor("last_dice_list"),N.$attr_accessor("success_num"),F(N,"$initialize",function P(g){var C=this;return delete P.$$p,null==g&&(g=p),D(C,_(C,"initialize",P,!1,!0),"initialize",[g],null),C.last_dice_list_list=[],C.last_dice_list=[],C.success_num=0},-1)},Opal.modules["bcdice/common_command/barabara_dice/node"]=function(a){var H,J,G,P,c,l,f,m,x,b,A,ee,se,y=a.top,w=[],p=a.nil,u=a.module,k=a.klass,v=a.hash2,D=a.def,_=a.send,F=a.truthy,oe=a.to_a,V=a.rb_minus;return y.$require("bcdice/format"),y.$require("bcdice/common_command/barabara_dice/result"),H=w,J=se=[u(w[0],"BCDice")].concat(H),G=ee=[u(se[0],"CommonCommand")].concat(J),P=A=[u(ee[0],"BarabaraDice")].concat(G),c=b=[u(A[0],"Node")].concat(P),f=[l=k(b[0],null,"Command")].concat(c),m=a.$r(f),(x=l.$$prototype).notations=x.cmp_op=x.target_number=p,D(l,"$initialize",function(Z){var le,ye,T,R;if(null==Z)Z=v([],{});else if(!Z.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(Z.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(le=Z.$$smap.secret,!a.hasOwnProperty.call(Z.$$smap,"notations"))throw a.ArgumentError.$new("missing keyword: notations");if(ye=Z.$$smap.notations,!a.hasOwnProperty.call(Z.$$smap,"cmp_op"))throw a.ArgumentError.$new("missing keyword: cmp_op");if(T=Z.$$smap.cmp_op,!a.hasOwnProperty.call(Z.$$smap,"target_number"))throw a.ArgumentError.$new("missing keyword: target_number");return R=Z.$$smap.target_number,this.secret=le,this.notations=ye,this.cmp_op=T,this.target_number=R},1),D(l,"$eval",function(Z,le){var ye,R,j,de,he,B,T=this,ie=p,ve=p,we=p,ce=p,O=p,ne=p;return R=Z.$round_type(),ie=_(T.notations,"map",[],function(pe){return null==pe&&(pe=p),pe.$to_dice(R)},1),j=F(ve=T.cmp_op)?ve:Z.$default_cmp_op(),de=F(ve=(ye=T.target_number)===p||null==ye?p:_(ye,"eval",[R]))?ve:Z.$default_target_number(),we=_(ie,"map",[],function(pe){return null==pe&&(pe=p),pe.$roll(le)},1),F(Z["$sort_barabara_dice?"]())&&_(we,"map!",[],"sort".$to_proc()),he=(ce=we.$flatten()).$count(1),B=F(j)?_(ce,"count",[],function(pe){return null==pe&&(pe=p),pe.$send(j,de)},1):0,F(j)&&(O="\u6210\u529f\u6570"+B),ne=["("+ie.$join("+")+m("Format").$comparison_operator(j)+de+")",ce.$join(","),O,Z.$grich_text(he,ce.$size(),B)].$compact(),_(m("Result").$new(),"tap",[],function q(pe){var $e=null==q.$$s?this:q.$$s,me=p;return null==$e.secret&&($e.secret=p),null==pe&&(pe=p),_(pe,"secret=",oe(me=[$e.secret])),V(me.length,1),me=[ne.$join(" \uff1e ")],_(pe,"text=",oe(me)),V(me.length,1),_(pe,"last_dice_list_list=",oe(me=[we])),V(me.length,1),_(pe,"last_dice_list=",oe(me=[ce])),V(me.length,1),_(pe,"success_num=",oe(me=[B])),me[V(me.length,1)]},{$$arity:1,$$s:T})},2),function(C,h,c){var l=k(C,null,"Notation"),f=[l].concat(c),m=a.$r(f),x=l.$$prototype;x.times=x.sides=p,D(l,"$initialize",function(Z,le){return this.times=Z,this.sides=le},2),D(l,"$to_dice",function(Z){var ye,T;return ye=this.times.$eval(Z),T=this.sides.$eval(Z),m("Dice").$new(ye,T)},1)}(b[0],0,b),function(C,h){var c=k(C,null,"Dice"),l=c.$$prototype;return l.times=l.sides=p,D(c,"$initialize",function(m,x){return this.times=m,this.sides=x},2),D(c,"$roll",function(m){return m.$roll_barabara(this.times,this.sides)},1),D(c,"$to_s",function(){return this.times+"B"+this.sides},0)}(b[0])},Opal.modules["bcdice/common_command/reroll_dice/parser"]=function(a){var se,ee,A,h,m,x,S,Z,le,ye,T,R,ie,de,c,l,f,P,g,G,J,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.hash,oe=a.const_set,V=a.hash2,L=a.to_ary,H=a.truthy;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/barabara_dice/node"),y.$require("bcdice/arithmetic/node"),se=w,ee=J=[k(w[0],"BCDice")].concat(se),A=G=[k(J[0],"CommonCommand")].concat(ee),P=[k(G[0],"RerollDice")].concat(A),g=a.$r(P),h=P,l=[c=v(P[0],u(g("Racc"),"Parser"),"Parser")].concat(h),f=a.$r(l),c.$$prototype.lexer=p,D(c,"$parse",function(O){return this.$new().$parse(O)},1),_(c,"$parse",function(O){try{return this.lexer=f("Lexer").$new(O),this.$do_parse()}catch(q){if(!a.rescue(q,[f("ParseError")]))throw q;try{return p}finally{a.pop_exception()}}},1),c.$private(),_(c,"$next_token",function(){return this.lexer.$next_token()},0),m=[9,3,9,9,9,15,20,21,20,21,8,14,8,8,8,9,9,4,13,28,10,39,20,21,9,8,8,31,32,9,20,21,33,16,8,20,21,9,24,8,34,35,9,20,21,31,32,8,20,21,9,13,8,31,32,9,20,21,34,35,8,20,21,9,p,8,34,35,9,20,21,31,32,8,20,21,9,p,8,p,31,32,20,21,31,32,8,40,p,p,p,47,51,49,50,52],x=[14,0,24,2,15,5,14,14,24,24,14,5,24,2,15,16,8,1,5,14,4,24,8,8,13,16,8,17,17,20,13,13,17,7,13,20,20,21,11,20,18,18,28,21,21,26,26,21,28,28,31,12,28,38,38,32,31,31,42,42,31,32,32,34,p,32,43,43,35,34,34,46,46,34,35,35,39,p,35,p,27,27,39,39,41,41,39,27,p,p,p,41,45,45,45,45],S=[-6,17,1,p,20,-3,p,30,14,p,p,18,30,22,-2,2,13,19,30,p,27,35,p,p,0,p,37,72,40,p,p,48,53,p,61,66,p,p,45,74,p,76,48,56,p,89,63,p,p,p,p,p,p],Z=[-4,-31,-31,-5,-31,-6,-13,-31,-31,-30,53,-1,-6,-31,-31,-31,-31,-31,-17,-20,-31,-31,-28,-3,-31,-2,-7,-31,-31,-12,-14,-31,-31,-29,-31,-31,-26,-27,-10,-31,-8,-31,-15,-16,-18,-21,-11,-9,-19,-22,-23,-24,-25],le=[17,7,11,36,37,26,27,1,6,25,42,43,2,5,7,30,38,44,45,12,41,29,23,48,p,p,p,p,p,p,p,46],ye=[7,9,4,11,11,7,7,1,8,4,10,10,2,3,9,9,7,11,11,5,7,8,6,12,p,p,p,p,p,p,p,7],T=[p,7,12,11,-3,14,11,-8,6,-1,-21,-17,-22],R=[p,p,p,p,p,p,p,p,p,22,18,19,p],ie=[0,0,"racc_error",3,23,"_reduce_1",4,23,"_reduce_2",4,23,"_reduce_3",0,24,"_reduce_4",1,24,"_reduce_5",0,26,"_reduce_6",2,26,"_reduce_7",3,27,"_reduce_8",4,27,"_reduce_9",2,28,"_reduce_10",3,28,"_reduce_11",3,25,"_reduce_12",1,25,"_reduce_13",3,30,"_reduce_14",3,29,"_reduce_15",3,29,"_reduce_16",1,29,"_reduce_none",3,32,"_reduce_18",4,32,"_reduce_19",1,32,"_reduce_none",0,34,"_reduce_21",1,34,"_reduce_22",1,34,"_reduce_23",1,34,"_reduce_24",1,34,"_reduce_25",2,33,"_reduce_26",2,33,"_reduce_27",1,33,"_reduce_none",3,31,"_reduce_29",1,31,"_reduce_30"],de=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),oe(l[0],"Racc_arg",[m,x,Z,S,le,ye,R,T,22,ie,de,53,31,!0]),oe(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","target","bracket","at","add","dice","term","mul","unary","round_type"]),oe(l[0],"Racc_debug_parser",!1),_(c,"$_reduce_1",function(O,ne,q){return u(f("Node"),"Command").$new(V(["secret","notations","cmp_op","target_number","source"],{secret:O["$[]"](0),notations:O["$[]"](1),cmp_op:O["$[]"](2)["$[]"]("cmp_op"),target_number:O["$[]"](2)["$[]"]("target"),source:this.lexer.$source()}))},3),_(c,"$_reduce_2",function(O,ne,q){var $e=p,me=p;return $e=O["$[]"](3),me=O["$[]"](2),u(f("Node"),"Command").$new(V(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:O["$[]"](0),notations:O["$[]"](1),cmp_op:$e["$[]"]("cmp_op"),target_number:$e["$[]"]("target"),reroll_cmp_op:me["$[]"]("cmp_op"),reroll_threshold:me["$[]"]("threshold"),source:this.lexer.$source()}))},3),_(c,"$_reduce_3",function(O,ne,q){var $e=p,me=p;return $e=O["$[]"](2),me=O["$[]"](3),u(f("Node"),"Command").$new(V(["secret","notations","cmp_op","target_number","reroll_cmp_op","reroll_threshold","source"],{secret:O["$[]"](0),notations:O["$[]"](1),cmp_op:$e["$[]"]("cmp_op"),target_number:$e["$[]"]("target"),reroll_cmp_op:me["$[]"]("cmp_op"),reroll_threshold:me["$[]"]("threshold"),source:this.lexer.$source()}))},3),_(c,"$_reduce_4",function(O,ne,q){return!1},3),_(c,"$_reduce_5",function(O,ne,q){return!0},3),_(c,"$_reduce_6",function(O,ne,q){return V([],{})},3),_(c,"$_reduce_7",function(O,ne,q){var pe,Te,De;return De=null==(pe=L(O))[1]?p:pe[1],H(Te=null==pe[0]?p:pe[0])||this.$raise(f("ParseError")),V(["cmp_op","target"],{cmp_op:Te,target:De})},3),_(c,"$_reduce_8",function(O,ne,q){return V(["threshold"],{threshold:O["$[]"](1)})},3),_(c,"$_reduce_9",function(O,ne,q){var $e,me;return $e=O["$[]"](1),me=O["$[]"](2),H($e)||this.$raise(f("ParseError")),V(["cmp_op","threshold"],{cmp_op:$e,threshold:me})},3),_(c,"$_reduce_10",function(O,ne,q){return V(["threshold"],{threshold:O["$[]"](1)})},3),_(c,"$_reduce_11",function(O,ne,q){var $e,me;return $e=O["$[]"](1),me=O["$[]"](2),H($e)||this.$raise(f("ParseError")),V(["cmp_op","threshold"],{cmp_op:$e,threshold:me})},3),_(c,"$_reduce_12",function(O,ne,q){var pe=p;return(pe=O["$[]"](0)).$push(O["$[]"](2)),pe},3),_(c,"$_reduce_13",function(O,ne,q){return[O["$[]"](0)]},3),_(c,"$_reduce_14",function(O,ne,q){var pe,$e;return pe=O["$[]"](0),$e=O["$[]"](2),u(f("Node"),"Notation").$new(pe,$e)},3),_(c,"$_reduce_15",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"+",O["$[]"](2))},3),_(c,"$_reduce_16",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"-",O["$[]"](2))},3),_(c,"$_reduce_18",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"*",O["$[]"](2))},3),_(c,"$_reduce_19",function(O,ne,q){return O["$[]"](3).$new(O["$[]"](0),O["$[]"](2))},3),_(c,"$_reduce_21",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),_(c,"$_reduce_22",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithCeil")},3),_(c,"$_reduce_23",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithCeil")},3),_(c,"$_reduce_24",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithRound")},3),_(c,"$_reduce_25",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithFloor")},3),_(c,"$_reduce_26",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_27",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Negative").$new(O["$[]"](1))},3),_(c,"$_reduce_29",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_30",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Number").$new(O["$[]"](0))},3),_(c,"$_reduce_none",function(O,ne,q){return O["$[]"](0)},3)},Opal.modules["bcdice/common_command/reroll_dice"]=function(a){var F,H,J,M,z,A,K,ee,se,V,y=a.top,w=[],p=a.nil,u=a.module,k=a.const_set,v=a.send,D=a.def;return y.$require("bcdice/normalize"),y.$require("bcdice/format"),y.$require("bcdice/common_command/reroll_dice/parser"),F=w,H=V=[u(w[0],"BCDice")].concat(F),J=se=[u(V[0],"CommonCommand")].concat(H),k((ee=[K=u(se[0],"RerollDice")].concat(J))[0],"PREFIX_PATTERN",/\d+R\d+/.$freeze()),k(ee[0],"REROLL_LIMIT",1e4),z=[M=a.get_singleton_class(K)].concat(ee),A=a.$r(z),D(M,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/upper_dice/node"]=function(a){var ue,M,N,C,m,x,S,Z,le,c,g,z,K,y=[],w=a.nil,p=a.module,u=a.klass,k=a.hash2,v=a.def,D=a.send,_=a.truthy,F=a.rb_le,oe=a.rb_plus,V=a.eqeq,L=a.to_a,H=a.rb_minus,U=a.rb_lt;return ue=y,M=K=[p(y[0],"BCDice")].concat(ue),N=z=[p(K[0],"CommonCommand")].concat(M),C=g=[p(z[0],"UpperDice")].concat(N),m=c=[p(g[0],"Node")].concat(C),S=[x=u(c[0],null,"Command")].concat(m),Z=a.$r(S),(le=x.$$prototype).notations=le.reroll_threshold=le.modifier=le.target_number=le.cmp_op=w,v(x,"$initialize",function(T){var R,ie,j,ve,de,we,ce=this;if(null==T)T=k([],{});else if(!T.$$is_hash)throw a.ArgumentError.$new("expected kwargs");if(!a.hasOwnProperty.call(T.$$smap,"secret"))throw a.ArgumentError.$new("missing keyword: secret");if(R=T.$$smap.secret,!a.hasOwnProperty.call(T.$$smap,"notations"))throw a.ArgumentError.$new("missing keyword: notations");if(ie=T.$$smap.notations,!a.hasOwnProperty.call(T.$$smap,"modifier"))throw a.ArgumentError.$new("missing keyword: modifier");if(j=T.$$smap.modifier,!a.hasOwnProperty.call(T.$$smap,"cmp_op"))throw a.ArgumentError.$new("missing keyword: cmp_op");if(ve=T.$$smap.cmp_op,!a.hasOwnProperty.call(T.$$smap,"target_number"))throw a.ArgumentError.$new("missing keyword: target_number");return de=T.$$smap.target_number,null==(we=T.$$smap.reroll_threshold)&&(we=w),ce.secret=R,ce.notations=ie,ce.modifier=j,ce.cmp_op=ve,ce.target_number=de,ce.reroll_threshold=we},1),v(x,"$eval",function(T,R){var ie,j,ve,we,ce,he,ne,pe,O,q,de=this,B=w,$e=w,me=w,Te=w;return we=T.$round_type(),ce=D(de.notations,"map",[],function(Me){return null==Me&&(Me=w),Me.$to_dice(we)},1),he=_(B=_(O=(ie=de.reroll_threshold)===w||null==ie?w:D(ie,"eval",[we]))?O:T.$upper_dice_reroll_threshold())?B:0,ne=_(B=(j=de.modifier)===w||null==j?w:D(j,"eval",[we]))?B:0,q=(ve=de.target_number)===w||null==ve?w:D(ve,"eval",[we]),pe=de.$expr(ce,he,ne,q),_(F(he,1))?de.$result_with_text("("+pe+") \uff1e \u7121\u9650\u30ed\u30fc\u30eb\u306e\u6761\u4ef6\u304c\u307e\u3061\u304c\u3063\u3066\u3044\u307e\u3059"):($e=D(ce,"map",[],function(Me){return null==Me&&(Me=w),Me.$roll(R,he,T["$sort_barabara_dice?"]())},1).$reduce([],"concat"),me=_(de.cmp_op)?de.$result_success_count($e,ne,q):de.$result_max_sum($e,ne),Te=["("+pe+")",de.$interlim_expr($e,ne),me],de.$result_with_text(Te.$join(" \uff1e ")))},2),x.$private(),v(x,"$result_success_count",function(T,R,ie){return"\u6210\u529f\u6570"+D(T,"count",[],function de(we){var ce=null==de.$$s?this:de.$$s;return null==ce.cmp_op&&(ce.cmp_op=w),null==we&&(we=w),oe(we["$[]"]("sum"),R).$send(ce.cmp_op,ie)},{$$arity:1,$$s:this})},3),v(x,"$result_max_sum",function(T,R){var j,ie=w;return ie=D(T,"map",[],function(we){return null==we&&(we=w),we["$[]"]("sum")},1),j=oe(ie.$sum(),R),D(ie,"map",[],function(we){return null==we&&(we=w),oe(we,R)},1).$max()+"/"+j+"(\u6700\u5927/\u5408\u8a08)"},2),v(x,"$interlim_expr",function(T,R){var ie;return ie=D(T,"map",[],function(ve){return null==ve&&(ve=w),V(ve["$[]"]("list").$size(),1)?ve["$[]"]("sum"):ve["$[]"]("sum")+"["+ve["$[]"]("list").$join(",")+"]"},1).$join(","),oe(ie,Z("Format").$modifier(R))},2),v(x,"$expr",function(T,R,ie,j){var de,we;return de=Z("Format").$comparison_operator(this.cmp_op),we=Z("Format").$modifier(ie),T.$join("+")+"["+R+"]"+we+de+j},4),v(x,"$result_with_text",function(T){return D(Z("Result").$new(),"tap",[],function ie(j){var ve=null==ie.$$s?this:ie.$$s,de=w;return null==ve.secret&&(ve.secret=w),null==j&&(j=w),D(j,"secret=",L(de=[ve.secret])),H(de.length,1),D(j,"text=",L(de=[T])),de[H(de.length,1)]},{$$arity:1,$$s:this})},1),function(l,f,m){var x=u(l,null,"Notation"),S=[x].concat(m),Z=a.$r(S),le=x.$$prototype;le.roll_times=le.sides=w,v(x,"$initialize",function(T,R){return this.roll_times=T,this.sides=R},2),v(x,"$to_dice",function(T){var ie,j;return ie=this.roll_times.$eval(T),j=this.sides.$eval(T),Z("Dice").$new(ie,j)},1)}(c[0],0,c),function(l,f,m){var x=u(l,null,"Dice"),S=[x].concat(m),Z=a.$r(S),le=x.$$prototype;return le.roll_times=le.sides=w,v(x,"$initialize",function(T,R){return this.roll_times=T,this.sides=R},2),v(x,"$roll",function(T,R,ie){var ve=w;return ve=D(Z("Array"),"new",[this.roll_times],function de(){var ce=w;return ce=(null==de.$$s?this:de.$$s).$roll_ones(T,R),k(["sum","list"],{sum:ce.$sum(),list:ce})},{$$arity:0,$$s:this}),_(ie)&&(ve=D(ve,"sort_by",[],function(we){return null==we&&(we=w),we["$[]"]("sum")},1)),ve},3),v(x,"$to_s",function(){return this.roll_times+"U"+this.sides},0),x.$private(),v(x,"$roll_ones",function(T,R){var ie=this,j=w;return j=[],function(){var ve=a.new_brk();try{D(ie,"loop",[],function de(){var ce,we=null==de.$$s?this:de.$$s;if(null==we.sides&&(we.sides=w),ce=T.$roll_once(we.sides),j.$push(ce),!_(U(ce,R)))return w;a.brk(w,ve)},{$$arity:0,$$s:ie,$$brk:ve})}catch(de){if(de===ve)return de.$v;throw de}}(),j},2)}(c[0],0,c)},Opal.modules["bcdice/common_command/upper_dice/parser"]=function(a){var se,ee,A,h,m,x,S,Z,le,ye,T,R,ie,de,c,l,f,P,g,G,J,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.hash,oe=a.const_set,V=a.hash2,L=a.to_ary,H=a.truthy;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/common_command/upper_dice/node"),y.$require("bcdice/arithmetic/node"),se=w,ee=J=[k(w[0],"BCDice")].concat(se),A=G=[k(J[0],"CommonCommand")].concat(ee),P=[k(G[0],"UpperDice")].concat(A),g=a.$r(P),h=P,l=[c=v(P[0],u(g("Racc"),"Parser"),"Parser")].concat(h),f=a.$r(l),c.$$prototype.lexer=p,D(c,"$parse",function(O){return this.$new().$parse(O)},1),_(c,"$parse",function(O){try{return this.lexer=f("Lexer").$new(O),this.$do_parse()}catch(q){if(!a.rescue(q,[f("ParseError")]))throw q;try{return p}finally{a.pop_exception()}}},1),c.$private(),_(c,"$next_token",function(){return this.lexer.$next_token()},0),m=[9,9,36,37,3,9,9,21,22,49,8,8,21,22,9,8,8,14,15,9,21,22,4,16,8,21,22,9,10,8,36,37,9,21,22,38,17,8,21,22,9,25,8,27,15,9,21,22,28,29,8,21,22,9,44,8,39,40,9,21,22,39,40,8,21,22,9,25,8,39,40,9,21,22,36,37,8,21,22,9,17,8,39,40,9,21,22,39,40,8,21,22,9,p,8,39,40,p,21,22,39,40,8,58,56,57,59,36,37],x=[2,8,34,34,0,17,14,8,8,34,2,8,14,14,15,17,14,5,5,16,15,15,1,5,15,16,16,21,4,16,18,18,22,21,21,18,7,21,22,22,25,11,22,12,12,27,25,25,13,13,25,27,27,28,24,27,19,19,29,28,28,30,30,28,29,29,36,26,29,33,33,37,36,36,45,45,36,37,37,39,32,37,47,47,40,39,39,48,48,39,40,40,44,p,40,50,50,p,44,44,51,51,44,53,53,53,53,54,54],S=[-3,22,-2,p,28,9,p,32,-1,p,p,20,35,40,4,12,17,3,22,46,p,25,30,p,34,38,46,43,51,56,51,p,76,59,-6,p,64,69,p,77,82,p,p,p,90,66,p,72,77,p,85,90,p,100,99,p,p,p,p,p],Z=[-4,-35,-35,-5,-35,-6,-17,-35,-35,-34,60,-12,-6,-7,-35,-35,-35,-35,-35,-21,-24,-35,-35,-32,-1,-35,-12,-35,-35,-35,-8,-16,-32,-9,-35,-18,-35,-35,-33,-35,-35,-30,-31,-3,-35,-13,-2,-10,-11,-14,-19,-20,-22,-25,-15,-23,-26,-27,-28,-29],le=[18,30,33,41,42,24,6,1,34,2,5,12,11,7,30,47,48,45,31,26,46,52,53,50,51,32,43,55,35,p,p,p,p,p,p,p,54],ye=[10,9,9,13,13,5,11,1,10,2,3,6,4,12,9,9,9,10,11,4,5,13,13,9,9,12,7,14,12,p,p,p,p,p,p,p,10],T=[p,7,9,8,7,-6,6,2,p,-13,-8,4,11,-18,-26],R=[p,p,p,p,p,p,p,p,13,19,p,p,23,20,p],ie=[0,0,"racc_error",4,23,"_reduce_1",5,23,"_reduce_2",5,23,"_reduce_3",0,24,"_reduce_4",1,24,"_reduce_5",0,26,"_reduce_6",1,26,"_reduce_7",2,30,"_reduce_8",2,30,"_reduce_9",3,30,"_reduce_10",3,30,"_reduce_11",0,27,"_reduce_12",2,27,"_reduce_13",3,28,"_reduce_14",2,29,"_reduce_15",3,25,"_reduce_16",1,25,"_reduce_17",3,33,"_reduce_18",3,32,"_reduce_19",3,32,"_reduce_20",1,32,"_reduce_none",3,31,"_reduce_22",4,31,"_reduce_23",1,31,"_reduce_none",0,36,"_reduce_25",1,36,"_reduce_26",1,36,"_reduce_27",1,36,"_reduce_28",1,36,"_reduce_29",2,35,"_reduce_30",2,35,"_reduce_31",1,35,"_reduce_none",3,34,"_reduce_33",1,34,"_reduce_34"],de=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"S",7,"PLUS",8,"MINUS",9,"ASTERISK",10,"SLASH",11,"PARENL",12,"PARENR",13,"BRACKETL",14,"BRACKETR",15,"LESS",16,"GREATER",17,"EQUAL",18,"NOT",19,"AT",20,"CMP_OP",21),oe(l[0],"Racc_arg",[m,x,Z,S,le,ye,R,T,22,ie,de,60,35,!0]),oe(l[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","S","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","BRACKETL","BRACKETR","LESS","GREATER","EQUAL","NOT","AT","CMP_OP","$start","expr","secret","notations","modifier","target","bracket","at","modifier_expr","mul","add","dice","term","unary","round_type"]),oe(l[0],"Racc_debug_parser",!1),_(c,"$_reduce_1",function(O,ne,q){return u(u(f("UpperDice"),"Node"),"Command").$new(V(["secret","notations","modifier","cmp_op","target_number"],{secret:O["$[]"](0),notations:O["$[]"](1),modifier:O["$[]"](2),cmp_op:O["$[]"](3)["$[]"]("cmp_op"),target_number:O["$[]"](3)["$[]"]("target")}))},3),_(c,"$_reduce_2",function(O,ne,q){return u(u(f("UpperDice"),"Node"),"Command").$new(V(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:O["$[]"](0),notations:O["$[]"](1),modifier:O["$[]"](3),cmp_op:O["$[]"](4)["$[]"]("cmp_op"),target_number:O["$[]"](4)["$[]"]("target"),reroll_threshold:O["$[]"](2)}))},3),_(c,"$_reduce_3",function(O,ne,q){return u(u(f("UpperDice"),"Node"),"Command").$new(V(["secret","notations","modifier","cmp_op","target_number","reroll_threshold"],{secret:O["$[]"](0),notations:O["$[]"](1),modifier:O["$[]"](2),cmp_op:O["$[]"](3)["$[]"]("cmp_op"),target_number:O["$[]"](3)["$[]"]("target"),reroll_threshold:O["$[]"](4)}))},3),_(c,"$_reduce_4",function(O,ne,q){return!1},3),_(c,"$_reduce_5",function(O,ne,q){return!0},3),_(c,"$_reduce_6",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Number").$new(0)},3),_(c,"$_reduce_7",function(O,ne,q){return O["$[]"](0)},3),_(c,"$_reduce_8",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_9",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Negative").$new(O["$[]"](1))},3),_(c,"$_reduce_10",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"+",O["$[]"](2))},3),_(c,"$_reduce_11",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"-",O["$[]"](2))},3),_(c,"$_reduce_12",function(O,ne,q){return V([],{})},3),_(c,"$_reduce_13",function(O,ne,q){var pe,Te,De;return De=null==(pe=L(O))[1]?p:pe[1],H(Te=null==pe[0]?p:pe[0])||this.$raise(f("ParseError")),V(["cmp_op","target"],{cmp_op:Te,target:De})},3),_(c,"$_reduce_14",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_15",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_16",function(O,ne,q){var pe=p;return(pe=O["$[]"](0)).$push(O["$[]"](2)),pe},3),_(c,"$_reduce_17",function(O,ne,q){return[O["$[]"](0)]},3),_(c,"$_reduce_18",function(O,ne,q){var pe,$e;return pe=O["$[]"](0),$e=O["$[]"](2),u(u(f("UpperDice"),"Node"),"Notation").$new(pe,$e)},3),_(c,"$_reduce_19",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"+",O["$[]"](2))},3),_(c,"$_reduce_20",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"-",O["$[]"](2))},3),_(c,"$_reduce_22",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"BinaryOp").$new(O["$[]"](0),"*",O["$[]"](2))},3),_(c,"$_reduce_23",function(O,ne,q){return O["$[]"](3).$new(O["$[]"](0),O["$[]"](2))},3),_(c,"$_reduce_25",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),_(c,"$_reduce_26",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithCeil")},3),_(c,"$_reduce_27",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithCeil")},3),_(c,"$_reduce_28",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithRound")},3),_(c,"$_reduce_29",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"DivideWithFloor")},3),_(c,"$_reduce_30",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_31",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Negative").$new(O["$[]"](1))},3),_(c,"$_reduce_33",function(O,ne,q){return O["$[]"](1)},3),_(c,"$_reduce_34",function(O,ne,q){return u(u(f("Arithmetic"),"Node"),"Number").$new(O["$[]"](0))},3),_(c,"$_reduce_none",function(O,ne,q){return O["$[]"](0)},3)},Opal.modules["bcdice/common_command/upper_dice"]=function(a){var F,H,J,M,z,A,K,ee,se,V,w=[],p=a.nil,u=a.module,k=a.const_set,v=a.send,D=a.def;return a.top.$require("bcdice/common_command/upper_dice/parser"),F=w,H=V=[u(w[0],"BCDice")].concat(F),J=se=[u(V[0],"CommonCommand")].concat(H),k((ee=[K=u(se[0],"UpperDice")].concat(J))[0],"PREFIX_PATTERN",/\d+U\d+/.$freeze()),z=[M=a.get_singleton_class(K)].concat(ee),A=a.$r(z),D(M,"$eval",function(P,g,b){var C;return(C=A("Parser").$parse(P))===p||null==C?p:v(C,"eval",[g,b])},3)},Opal.modules["bcdice/common_command/version"]=function(a){var L,ue,M,A,P,g,G,z,K,U,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.const_set,v=a.truthy,D=a.send,_=a.to_a,F=a.rb_minus,oe=a.def;return L=y,ue=U=[u(y[0],"BCDice")].concat(L),M=K=[u(U[0],"CommonCommand")].concat(ue),k((z=[G=u(K[0],"Version")].concat(M))[0],"PREFIX_PATTERN",/BCDiceVersion/.$freeze()),P=[A=a.get_singleton_class(G)].concat(z),g=a.$r(P),oe(A,"$eval",function(C,h,c){return C=C.$split(" ",2).$first(),v(C["$match?"](/^BCDiceVersion$/i))?D(g("Result").$new(),"tap",[],function(f){var m;return null==f&&(f=w),m=["BCDice "+p(g("BCDice"),"VERSION")],D(f,"text=",_(m)),m[F(m.length,1)]},1):w},3)},Opal.queue(function(a){var D,V,H,U,F,y=a.top,w=[],u=a.module,k=a.const_set;return y.$require("bcdice/common_command/add_dice"),y.$require("bcdice/common_command/barabara_dice"),y.$require("bcdice/common_command/tally_dice"),y.$require("bcdice/common_command/calc"),y.$require("bcdice/common_command/choice"),y.$require("bcdice/common_command/d66_dice"),y.$require("bcdice/common_command/repeat"),y.$require("bcdice/common_command/reroll_dice"),y.$require("bcdice/common_command/upper_dice"),y.$require("bcdice/common_command/version"),D=w,V=F=[u(w[0],"BCDice")].concat(D),H=[u(F[0],"CommonCommand")].concat(V),U=a.$r(H),k(H[0],"COMMANDS",[U("AddDice"),U("BarabaraDice"),U("TallyDice"),U("Calc"),U("Choice"),U("D66Dice"),U("Repeat"),U("RerollDice"),U("UpperDice"),U("Version")].$freeze())})},9993:function(){(function(E){"use strict";var ae;if("undefined"!=typeof globalThis?E=globalThis:"undefined"!=typeof global?E=global:"undefined"!=typeof window&&(E=window),"log"in(ae="object"==typeof E.console?E.console:null==E.console?E.console={}:{})||(ae.log=function(){}),"warn"in ae||(ae.warn=ae.log),void 0!==E.Opal)return ae.warn("Opal already loaded. Loading twice can cause troubles, please fix your setup."),E.Opal;var Y,a,y,w,p,u,k,v=E.Opal={};v.global=E,E.Opal=v,v.config={missing_require_severity:"error",unsupported_features_severity:"warning",experimental_features_severity:"warning",enable_stack_trace:!0};var D=Object.hasOwnProperty,_=Function.prototype.bind,F=Object.setPrototypeOf,oe=Array.prototype.slice,V=Array.prototype.splice,H=4;function U(T,R,ie){"string"==typeof T?T[R]=ie:Object.defineProperty(T,R,{value:ie,enumerable:!1,configurable:!0,writable:!0})}v.uid=function(){return H+=2},v.id=function(T){return T.$$is_number?2*T+1:(null!=T.$$id||U(T,"$$id",v.uid()),T.$$id)},v.gvars={},v.exit=function(T){v.gvars.DEBUG&&ae.log("Exited with status "+T)},v.exceptions=[],v.pop_exception=function(){var T=v.exceptions.pop();T?(v.gvars["!"]=T,v.gvars["@"]=T.$backtrace()):v.gvars["!"]=v.gvars["@"]=Y},v.prop=U,v.defineProperty=v.prop,v.slice=oe;var se=v.truthy=function(T){return!(!1===T||Y===T||null==T||T instanceof Boolean&&!0!==T.valueOf())};function ue(T){var R,ie,j;for(R=0,ie=v.tracers_for_class.length;R<ie;R++)(j=v.tracers_for_class[R]).trace_object=T,j.block.$call(j)}function J(T,R){if(T.$$autoload[R].loaded){if(T.$$autoload[R].loaded&&!T.$$autoload[R].required&&T.$$autoload[R].exception)throw T.$$autoload[R].exception}else{T.$$autoload[R].loaded=!0;try{v.Kernel.$require(T.$$autoload[R].path)}catch(ie){throw T.$$autoload[R].exception=ie,ie}if(T.$$autoload[R].required=!0,null!=T.$$const[R])return T.$$autoload[R].success=!0,T.$$const[R]}}function K(T,R){if(T){if(null!=T.$$const[R])return T.$$const[R];if(T.$$autoload&&T.$$autoload[R])return J(T,R)}}function M(T,R){var ie,j,ve;if(null!=T)for(ie=0,j=(ve=v.ancestors(T)).length;ie<j;ie++){if(ve[ie].$$const&&D.call(ve[ie].$$const,R))return ve[ie].$$const[R];if(ve[ie].$$autoload&&ve[ie].$$autoload[R])return J(ve[ie],R)}}function z(T,R,ie){if(!ie)return(T||y).$const_missing(R)}function A(T,R,ie){return(null==T||"::"===T)&&(T=y),ie.$$is_a_module&&((null==ie.$$name||ie.$$name===Y)&&(ie.$$name=R),null==ie.$$base_module&&(ie.$$base_module=T)),T.$$const=T.$$const||Object.create(null),T.$$const[R]=ie,T.$$=T.$$const,v.const_cache_version++,T===y&&(v[R]=ie),U(T,R,ie),ie}function b(T){return T.hasOwnProperty("$$iclass")&&T.hasOwnProperty("$$root")}function l(T){var R=f(T);return T.$$is_module&&T.$$iclasses.push(R),R}function f(T){var R={},ie=T.$$prototype;ie.hasOwnProperty("$$dummy")&&(ie=ie.$$define_methods_on);var de,j=Object.getOwnPropertyNames(ie),ve=j.length;for(de=0;de<ve;de++){var we=j[de];U(R,we,ie[we])}return U(R,"$$iclass",!0),U(R,"$$module",T),R}function m(T){var R=T.length,ie=T[0];if(U(ie,"$$root",!0),1===R)return{first:ie,last:ie};for(var j=ie,ve=1;ve<R;ve++){var de=T[ve];F(j,de),j=de}return{first:T[0],last:T[R-1]}}function x(T){if(!T.hasOwnProperty("$$dummy")){if(T.hasOwnProperty("$$iclass"))return T.$$module;if(T.hasOwnProperty("$$class"))return T.$$class}}function Z(T,R){"number"==typeof R?T.$$arity=R:"object"==typeof R&&Object.assign(T,R)}function le(T){return"function"==typeof T&&!T.$$stub}v.falsy=function(T){return!se(T)},v.type_error=function(T,R,ie,j){return T=T.$$class,v.TypeError.$new(j&&ie?"can't convert "+T+" into "+R+" ("+T+"#"+ie+" gives "+(j=j.$$class)+")":"no implicit conversion of "+T+" into "+R)},v.coerce_to=function(T,R,ie,j){if(R["$==="](T))return T;if(!T["$respond_to?"](ie))throw v.type_error(T,R);return null==j&&(j=[]),v.send(T,ie,j)},v.respond_to=function(T,R,ie){if(null==T||!T.$$class)return!1;ie=!!ie;var j=T[R];return T["$respond_to?"].$$pristine?"function"==typeof j&&!j.$$stub||(T["$respond_to_missing?"].$$pristine?void 0:v.send(T,T["$respond_to_missing?"],[R.substr(1),ie])):v.send(T,T["$respond_to?"],[R.substr(1),ie])},v.trace_class=!1,v.tracers_for_class=[],v.const_get_local=function(T,R,ie){var j;if(null!=T){if("::"===T&&(T=y),!T.$$is_module&&!T.$$is_class)throw new v.TypeError(T.toString()+" is not a class/module");if(null!=(j=K(T,R))||null!=(j=z(T,R,ie)))return j}},v.const_get_qualified=function(T,R,ie){var j,ve,de,we=v.const_cache_version;if(null==R)return null!=(j=K(y,T))?j:v.const_get_qualified(y,T,ie);if(null!=T){if("::"===T&&(T=y),!T.$$is_module&&!T.$$is_class)throw new v.TypeError(T.toString()+" is not a class/module");return null==(ve=T.$$const_cache)&&(U(T,"$$const_cache",Object.create(null)),ve=T.$$const_cache),null==(de=ve[R])||de[0]!==we?(null!=(j=K(T,R))||(j=M(T,R)),ve[R]=[we,j]):j=de[1],null!=j?j:z(T,R,ie)}},v.const_cache_version=1,v.const_get_relative=function(T,R,ie){var ve,we,ce,j=T[0],de=v.const_cache_version;return null==(we=T.$$const_cache)&&(U(T,"$$const_cache",Object.create(null)),we=T.$$const_cache),null==(ce=we[R])||ce[0]!==de?(null!=(ve=K(j,R))||null!=(ve=function ee(T,R){var ie,j,ve;if(0!==T.length)for(ie=0,j=T.length;ie<j;ie++){if(null!=(ve=T[ie].$$const[R]))return ve;if(T[ie].$$autoload&&T[ie].$$autoload[R])return J(T[ie],R)}}(T,R))||null!=(ve=M(j,R))||(ve=function G(T,R){if(null==T||T.$$is_module)return M(y,R)}(j,R)),we[R]=[de,ve]):ve=ce[1],null!=ve?ve:z(j,R,ie)},v.const_set=A,v.constants=function(T,R){null==R&&(R=!0);var ie,ve,de,ce,j=[T],we={};for(R&&(j=j.concat(v.ancestors(T))),R&&T.$$is_module&&(j=j.concat([v.Object]).concat(v.ancestors(v.Object))),ve=0,de=j.length;ve<de&&(ie=j[ve],T===y||ie!=y);ve++){for(ce in ie.$$const)we[ce]=!0;if(ie.$$autoload)for(ce in ie.$$autoload)we[ce]=!0}return Object.keys(we)},v.const_remove=function(T,R){if(v.const_cache_version++,null!=T.$$const[R]){var ie=T.$$const[R];return delete T.$$const[R],ie}if(T.$$autoload&&T.$$autoload[R])return delete T.$$autoload[R],Y;throw v.NameError.$new("constant "+T+"::"+T.$name()+" not defined")},v.const_get_relative_factory=function(T){return function(R,ie){return v.$$(T,R,ie)}},v.$$=v.const_get_relative,v.$$$=v.const_get_qualified,v.$r=v.const_get_relative_factory,v.allocate_class=function(T,R,ie){var j,ve;if(ve=null!=R&&R.$$bridge?function(){var he=oe.call(arguments),B=new(_.apply(R.$$constructor,[null].concat(he)));return F(B,j.$$prototype),B}:function(){},T&&T!==Y&&U(ve,"displayName","::"+T),U(j=ve,"$$name",T),U(j,"$$constructor",ve),U(j,"$$prototype",ve.prototype),U(j,"$$const",{}),U(j,"$$is_class",!0),U(j,"$$is_a_module",!0),U(j,"$$super",R),U(j,"$$cvars",{}),U(j,"$$own_included_modules",[]),U(j,"$$own_prepended_modules",[]),U(j,"$$ancestors",[]),U(j,"$$ancestors_cache_version",null),U(j,"$$subclasses",[]),U(j.$$prototype,"$$class",j),v.Class&&F(j,v.Class.prototype),null!=R){if(F(j.$$prototype,R.$$prototype),!0!==ie)if("undefined"!=typeof WeakRef){var de,we,ce=[];for(de=0;de<R.$$subclasses.length;de++)void 0!==(we=R.$$subclasses[de]).deref()&&ce.push(we);ce.push(new WeakRef(j)),R.$$subclasses=ce}else R.$$subclasses.push(j);R.$$meta&&v.build_class_singleton_class(j)}return j},v.klass=function(T,R,ie){var j;if(null==T||"::"==T?T=y:!T.$$is_class&&!T.$$is_module&&(T=T.$$class),null!=R&&(!R.hasOwnProperty||R.hasOwnProperty&&!R.hasOwnProperty("$$is_class"))){if(!R.constructor||"Function"!=R.constructor.name)throw v.TypeError.$new("superclass must be a Class ("+(R.constructor&&(R.constructor.name||R.constructor.$$name)||typeof R)+" given)");j=R,R=y}var ve=function N(T,R){var ie=K(T,R);if(ie){if(!ie.$$is_class)throw v.TypeError.$new(R+" is not a class");return ie}}(T,ie);return ve?(R&&function P(T,R){if(T.$$super!==R)throw v.TypeError.$new("superclass mismatch for class "+T.$$name)}(ve,R),v.trace_class&&ue(ve),ve):(null==R&&(R=y),A(T,ie,ve=v.allocate_class(ie,R)),R.$inherited&&R.$inherited(ve),j&&v.bridge(j,ve),v.trace_class&&ue(ve),ve)},v.allocate_module=function(T){var R=function(){};T&&U(R,"displayName",T+".$$constructor");var ie=R;return T&&U(R,"displayName",T+".constructor"),U(ie,"$$name",T),U(ie,"$$prototype",R.prototype),U(ie,"$$const",{}),U(ie,"$$is_module",!0),U(ie,"$$is_a_module",!0),U(ie,"$$cvars",{}),U(ie,"$$iclasses",[]),U(ie,"$$own_included_modules",[]),U(ie,"$$own_prepended_modules",[]),U(ie,"$$ancestors",[ie]),U(ie,"$$ancestors_cache_version",null),F(ie,v.Module.prototype),ie},v.module=function(T,R){var ie;return null==T||"::"==T?T=y:!T.$$is_class&&!T.$$is_module&&(T=T.$$class),ie=function g(T,R){var ie=K(T,R);if(null==ie&&T===y&&(ie=M(y,R)),ie&&!ie.$$is_module&&ie!==y)throw v.TypeError.$new(R+" is not a module");return ie}(T,R),ie?(v.trace_class&&ue(ie),ie):(A(T,R,ie=v.allocate_module(R)),v.trace_class&&ue(ie),ie)},v.get_singleton_class=function(T){return T.$$meta?T.$$meta:T.hasOwnProperty("$$is_class")?v.build_class_singleton_class(T):T.hasOwnProperty("$$is_module")?v.build_module_singleton_class(T):v.build_object_singleton_class(T)},v.build_class_singleton_class=function(T){var R,ie;return T.$$meta?T.$$meta:(R=T===a?p:v.get_singleton_class(T.$$super),U(ie=v.allocate_class(null,R,!0),"$$is_singleton",!0),U(ie,"$$singleton_of",T),U(T,"$$meta",ie),F(T,ie.$$prototype),U(T,"$$class",v.Class),ie)},v.build_module_singleton_class=function(T){if(T.$$meta)return T.$$meta;var R=v.allocate_class(null,v.Module,!0);return U(R,"$$is_singleton",!0),U(R,"$$singleton_of",T),U(T,"$$meta",R),F(T,R.$$prototype),U(T,"$$class",v.Module),R},v.build_object_singleton_class=function(T){var ie=v.allocate_class(Y,T.$$class,!0);return U(ie,"$$is_singleton",!0),U(ie,"$$singleton_of",T),delete ie.$$prototype.$$class,U(T,"$$meta",ie),F(T,T.$$meta.$$prototype),ie},v.is_method=function(T){return"$"===T[0]&&"$"!==T[1]},v.instance_methods=function(T){for(var R=[],ie=[],j=v.ancestors(T),ve=0,de=j.length;ve<de;ve++){var ce=j[ve].$$prototype;ce.hasOwnProperty("$$dummy")&&(ce=ce.$$define_methods_on);for(var he=Object.getOwnPropertyNames(ce),B=0,O=he.length;B<O;B++){var ne=he[B];if(v.is_method(ne)){var q=ne.slice(1),pe=ce[ne];pe.$$stub&&-1===R.indexOf(q)&&R.push(q),!pe.$$stub&&-1===ie.indexOf(q)&&-1===R.indexOf(q)&&ie.push(q)}}}return ie},v.own_instance_methods=function(T){var R=[],ie=T.$$prototype;ie.hasOwnProperty("$$dummy")&&(ie=ie.$$define_methods_on);for(var j=Object.getOwnPropertyNames(ie),ve=0,de=j.length;ve<de;ve++){var we=j[ve];if(v.is_method(we)&&!ie[we].$$stub){var he=we.slice(1);R.push(he)}}return R},v.methods=function(T){return v.instance_methods(T.$$meta||T.$$class)},v.own_methods=function(T){return T.$$meta?v.own_instance_methods(T.$$meta):[]},v.receiver_methods=function(T){var R=v.get_singleton_class(T),ie=v.own_instance_methods(R),j=v.own_instance_methods(R.$$super);return ie.concat(j)},v.class_variables=function(T){var ie,R=v.ancestors(T),ve={};for(ie=R.length-1;ie>=0;ie--){var de=R[ie];for(var we in de.$$cvars)ve[we]=de.$$cvars[we]}return ve},v.class_variable_set=function(T,R,ie){var ve,j=v.ancestors(T);for(ve=j.length-2;ve>=0;ve--){var we=j[ve];if(D.call(we.$$cvars,R))return we.$$cvars[R]=ie,ie}return T.$$cvars[R]=ie,ie},v.class_variable_get=function(T,R,ie){if(D.call(T.$$cvars,R))return T.$$cvars[R];var ve,j=v.ancestors(T),de=j.length;for(ve=0;ve<de;ve++){var we=j[ve];if(D.call(we.$$cvars,R))return we.$$cvars[R]}if(!ie)throw v.NameError.$new("uninitialized class variable "+R+" in "+T.$name());return Y},v.append_features=function(T,R){var ie=v.ancestors(T),j=[];if(-1!==ie.indexOf(R))throw v.ArgumentError.$new("cyclic include detected");for(var ve=0,de=ie.length;ve<de;ve++){var ce=l(ie[ve]);U(ce,"$$included",!0),j.push(ce)}var O,ne,he=v.ancestors(R),B=m(j);if(-1===he.indexOf(T))O=R.$$prototype,ne=Object.getPrototypeOf(R.$$prototype);else{for(var q=R.$$prototype,pe=Object.getPrototypeOf(q);null!=pe&&(pe.$$module!==T||!b(pe));)q=pe,pe=Object.getPrototypeOf(pe);if(pe){for(var $e=Object.getPrototypeOf(pe);$e.hasOwnProperty("$$iclass")&&!b($e);)$e=Object.getPrototypeOf($e);O=q,ne=$e}else O=R.$$prototype,ne=Object.getPrototypeOf(R.$$prototype)}F(O,B.first),F(B.last,ne),R.$$own_included_modules=function C(T){for(var ie,R=[],j=Object.getPrototypeOf(T.$$prototype);j&&!j.hasOwnProperty("$$class");)(ie=x(j))&&R.push(ie),j=Object.getPrototypeOf(j);return R}(R),v.const_cache_version++},v.prepend_features=function(T,R){var ie=v.ancestors(T),j=[];if(-1!==ie.indexOf(R))throw v.ArgumentError.$new("cyclic prepend detected");for(var ve=0,de=ie.length;ve<de;ve++){var ce=l(ie[ve]);U(ce,"$$prepended",!0),j.push(ce)}var ne,q,pe,he=m(j),B=R.$$prototype,O=Object.getPrototypeOf(B);if(B.hasOwnProperty("$$dummy")?ne=B.$$define_methods_on:(ne=f(R),function c(T){for(var R=T.$$prototype,ie=Object.getOwnPropertyNames(R),j=0;j<ie.length;j++){var ve=ie[j];v.is_method(ve)&&delete R[ve]}}(R),U(B,"$$dummy",!0),U(B,"$$define_methods_on",ne),F(B,ne),F(ne,O)),-1!==v.ancestors(R).indexOf(T))throw v.RuntimeError.$new("Prepending a module multiple times is not supported");for(q=B,pe=Object.getPrototypeOf(B);null!=pe&&!pe.hasOwnProperty("$$root")&&pe!==ne&&pe.hasOwnProperty("$$iclass");)pe=Object.getPrototypeOf(pe);F(q,he.first),F(he.last,pe),R.$$own_prepended_modules=function h(T){var ie,R=[],j=Object.getPrototypeOf(T.$$prototype);if(T.$$prototype.hasOwnProperty("$$dummy"))for(;j&&j!==T.$$prototype.$$define_methods_on;)(ie=x(j))&&R.push(ie),j=Object.getPrototypeOf(j);return R}(R),v.const_cache_version++},v.bridge=function(T,R){if(T.hasOwnProperty("$$bridge"))throw v.ArgumentError.$new("already bridged");U(T,"$$bridge",R),F(T.prototype,(R.$$super||v.Object).$$prototype),U(R,"$$prototype",T.prototype),U(R.$$prototype,"$$class",R),U(R,"$$constructor",T),U(R,"$$bridge",!0)},v.ancestors=function(T){if(!T)return[];if(T.$$ancestors_cache_version===v.const_cache_version)return T.$$ancestors;var ie,j,ve,R=[];for(ie=0,j=function S(T){return T.$$own_prepended_modules.concat([T]).concat(T.$$own_included_modules)}(T),ve=j.length;ie<ve;ie++)R.push(j[ie]);if(T.$$super)for(ie=0,ve=(j=v.ancestors(T.$$super)).length;ie<ve;ie++)R.push(j[ie]);return T.$$ancestors_cache_version=v.const_cache_version,T.$$ancestors=R,R},v.included_modules=function(T){for(var R=[],ie=null,j=Object.getPrototypeOf(T.$$prototype);j&&Object.getPrototypeOf(j);j=Object.getPrototypeOf(j))(ie=x(j))&&ie.$$is_module&&j.$$iclass&&j.$$included&&R.push(ie);return R},v.add_stubs=function(T){for(var ie,j,R=v.BasicObject.$$prototype,ve=0,de=(T=T.split(",")).length;ve<de;ve++)(null==(j=R[ie="$"+T[ve]])||j.$$stub)&&v.add_stub_for(R,ie)},v.add_stub_for=function(T,R){U(T,R,v.stub_for(R))},v.stub_for=function(T){function R(){this.$method_missing.$$p=R.$$p,delete R.$$p;for(var ie=new Array(arguments.length),j=0,ve=ie.length;j<ve;j++)ie[j]=arguments[j];return this.$method_missing.apply(this,[T.slice(1)].concat(ie))}return R.$$stub=!0,R},v.ac=function(T,R,ie,j){var ve="";throw ve+=ie.$$is_a_module?ie.$$name+".":ie.$$class.$$name+"#",v.ArgumentError.$new("["+(ve+=j)+"] wrong number of arguments (given "+T+", expected "+R+")")},v.block_ac=function(T,R,ie){throw v.ArgumentError.$new("`block in "+ie+"': wrong number of arguments (given "+T+", expected "+R+")")},v.find_super=function(T,R,ie,j,ve){for(var we,ce,de="$"+R,B=(we=T.hasOwnProperty("$$meta")?v.ancestors(T.$$meta):v.ancestors(T.$$class)).indexOf(ie.$$owner)+1;B<we.length;B++){var ne=we[B].$$prototype;if(ne.hasOwnProperty("$$dummy")&&(ne=ne.$$define_methods_on),ne.hasOwnProperty(de)){ce=ne[de];break}}if(!j&&ce&&ce.$$stub&&T.$method_missing.$$pristine)throw v.NoMethodError.$new("super: no superclass method `"+R+"' for "+T,R);return ce.$$stub&&!ve?null:ce},v.find_block_super=function(T,R,ie,j,ve){var de=R;if(!ie)throw v.RuntimeError.$new("super called outside of method");if(ve&&ie.$$define_meth)throw v.RuntimeError.$new("implicit argument passing of super from method defined by define_method() is not supported. Specify all arguments explicitly");return ie.$$def&&(de=ie.$$jsid),v.find_super(T,de,ie,j)},v.find_super_dispatcher=v.find_super,v.find_iter_super_dispatcher=v.find_block_super,v.ret=function(T){throw v.returner.$v=T,v.returner},v.brk=function(T,R){throw R.$v=T,R},v.new_brk=function(){return new Error("unexpected break")},v.yield1=function(T,R){if("function"!=typeof T)throw v.LocalJumpError.$new("no block given");var j=T.$$has_trailing_comma_in_args;return(T.length>1||(T.$$has_top_level_mlhs_arg||j)&&1===T.length)&&(R=v.to_ary(R)),(T.length>1||j&&1===T.length)&&R.$$is_array?T.apply(null,R):T(R)},v.yieldX=function(T,R){if("function"!=typeof T)throw v.LocalJumpError.$new("no block given");if(T.length>1&&1===R.length&&R[0].$$is_array)return T.apply(null,R[0]);if(!R.$$is_array){for(var ie=new Array(R.length),j=0,ve=ie.length;j<ve;j++)ie[j]=R[j];return T.apply(null,ie)}return T.apply(null,R)},v.rescue=function(T,R){for(var ie=0;ie<R.length;ie++){var j=R[ie];if(j.$$is_array){var ve=v.rescue(T,j);if(ve)return ve}else{if(j===v.JS.Error)return j;if(j["$==="](T))return j}}return null},v.is_a=function(T,R){if(null!=R&&T.$$meta===R||T.$$class===R)return!0;if(T.$$is_number&&R.$$is_number_class)return!R.$$is_integer_class||T%1==0;var ie,j,ve=v.ancestors(T.$$is_class?v.get_singleton_class(T):T.$$meta||T.$$class);for(ie=0,j=ve.length;ie<j;ie++)if(ve[ie]===R)return!0;return!1},v.to_hash=function(T){if(T.$$is_hash)return T;if(T["$respond_to?"]("to_hash",!0)){var R=T.$to_hash();if(R.$$is_hash)return R;throw v.TypeError.$new("Can't convert "+T.$$class+" to Hash ("+T.$$class+"#to_hash gives "+R.$$class+")")}throw v.TypeError.$new("no implicit conversion of "+T.$$class+" into Hash")},v.to_ary=function(T){if(T.$$is_array)return T;if(T["$respond_to?"]("to_ary",!0)){var R=T.$to_ary();if(R===Y)return[T];if(R.$$is_array)return R;throw v.TypeError.$new("Can't convert "+T.$$class+" to Array ("+T.$$class+"#to_ary gives "+R.$$class+")")}return[T]},v.to_a=function(T){if(T.$$is_array)return T.slice();if(T["$respond_to?"]("to_a",!0)){var R=T.$to_a();if(R===Y)return[T];if(R.$$is_array)return R;throw v.TypeError.$new("Can't convert "+T.$$class+" to Array ("+T.$$class+"#to_a gives "+R.$$class+")")}return[T]},v.extract_kwargs=function(T){var R=T[T.length-1];return null!=R&&v.respond_to(R,"$to_hash",!0)?(V.call(T,T.length-1),R.$to_hash()):v.hash2([],{})},v.kwrestargs=function(T,R){var ve,ie=[],j={},de=T.$$smap;for(ve in de)R[ve]||(ie.push(ve),j[ve]=de[ve]);return v.hash2(ie,j)},v.send=function(T,R,ie,j,ve){var de;if(Z(j,ve),"function"==typeof R)de=R,R=null;else{if("string"!=typeof R)throw v.NameError.$new("Passed method should be a string or a function");de=T["$"+R]}return v.send2(T,de,R,ie,j)},v.send2=function(T,R,ie,j,ve,de){return null==R&&null!=ie&&T.$method_missing&&(R=T.$method_missing,j=[ie].concat(j)),Z(ve,de),"function"==typeof ve&&(R.$$p=ve),R.apply(T,j)},v.refined_send=function(T,R,ie,j,ve,de){var we,ce,he,B,O,ne,q,pe,$e;for(B=R.hasOwnProperty("$$meta")?v.ancestors(R.$$meta):v.ancestors(R.$$class),Z(ve,de),we=0;we<B.length;we++)for(O=v.id(B[we]),ce=0;ce<T.length;ce++)for(he=(ne=T[ce]).length-1;he>=0;he--)if(void 0!==(q=ne[he]).$$refine_modules&&void 0!==(pe=q.$$refine_modules)[O]&&void 0!==($e=pe[O]).$$prototype["$"+ie])return v.send2(R,$e.$$prototype["$"+ie],ie,j,ve);return v.send(R,ie,j,ve)},v.lambda=function(T,R){return T.$$is_lambda=!0,Z(T,R),T},v.def=function(T,R,ie,j){return Z(ie,j),T===v.top?v.defn(v.Object,R,ie):!T.$$eval&&T.$$is_a_module?v.defn(T,R,ie):v.defs(T,R,ie)},v.defn=function(T,R,ie){ie.displayName=R,ie.$$owner=T;var j=R.substr(1),ve=T.$$prototype;if(ve.hasOwnProperty("$$dummy")&&(ve=ve.$$define_methods_on),U(ve,R,ie),T.$$is_module){T.$$module_function&&v.defs(T,R,ie);for(var de=0,we=T.$$iclasses,ce=we.length;de<ce;de++)U(we[de],R,ie)}var B=T.$$singleton_of;return!T.$method_added||T.$method_added.$$stub||B?B&&B.$singleton_method_added&&!B.$singleton_method_added.$$stub&&B.$singleton_method_added(j):T.$method_added(j),j},v.defs=function(T,R,ie,j){if(Z(ie,j),T.$$is_string||T.$$is_number)throw v.TypeError.$new("can't define singleton");return v.defn(v.get_singleton_class(T),R,ie)},v.rdef=function(T,R){if(!D.call(T.$$prototype,R))throw v.NameError.$new("method '"+R.substr(1)+"' not defined in "+T.$name());delete T.$$prototype[R],T.$$is_singleton?T.$$prototype.$singleton_method_removed&&!T.$$prototype.$singleton_method_removed.$$stub&&T.$$prototype.$singleton_method_removed(R.substr(1)):T.$method_removed&&!T.$method_removed.$$stub&&T.$method_removed(R.substr(1))},v.udef=function(T,R){if(!T.$$prototype[R]||T.$$prototype[R].$$stub)throw v.NameError.$new("method '"+R.substr(1)+"' not defined in "+T.$name());v.add_stub_for(T.$$prototype,R),T.$$is_singleton?T.$$prototype.$singleton_method_undefined&&!T.$$prototype.$singleton_method_undefined.$$stub&&T.$$prototype.$singleton_method_undefined(R.substr(1)):T.$method_undefined&&!T.$method_undefined.$$stub&&T.$method_undefined(R.substr(1))},v.alias=function(T,R,ie){var de,we,j="$"+R,ve="$"+ie;if(void 0===T.$$prototype&&(T=v.Object),de=T.$$prototype["$"+ie],T.$$eval)return v.alias(v.get_singleton_class(T),R,ie);if(!le(de)){for(var ce=T.$$super;"function"!=typeof de&&ce;)de=ce[ve],ce=ce.$$super;if(!le(de)&&T.$$is_module&&(de=v.Object.$$prototype[ve]),!le(de))throw v.NameError.$new("undefined method `"+ie+"' for class `"+T.$name()+"'")}de.$$alias_of&&(de=de.$$alias_of),we=function(){var B,O,ne,he=we.$$p;for(B=new Array(arguments.length),O=0,ne=arguments.length;O<ne;O++)B[O]=arguments[O];return delete we.$$p,v.send(this,de,B,he)};try{Object.defineProperty(we,"length",{value:de.length})}catch(he){}return we.displayName=R,we.$$arity=de.$$arity,we.$$parameters=de.$$parameters,we.$$source_location=de.$$source_location,we.$$alias_of=de,we.$$alias_name=R,v.defn(T,j,we),T},v.alias_gvar=function(T,R){return Object.defineProperty(v.gvars,T,{configurable:!0,enumerable:!0,get:function(){return v.gvars[R]},set:function(ie){v.gvars[R]=ie}}),Y},v.alias_native=function(T,R,ie){var j="$"+R,ve=T.$$prototype[ie];if("function"!=typeof ve||ve.$$stub)throw v.NameError.$new("undefined native method `"+ie+"' for class `"+T.$name()+"'");return v.defn(T,j,ve),T},v.hash_init=function(T){T.$$smap=Object.create(null),T.$$map=Object.create(null),T.$$keys=[]},v.hash_clone=function(T,R){R.$$none=T.$$none,R.$$proc=T.$$proc;for(var we,ce,ie=0,j=T.$$keys,ve=T.$$smap,de=j.length;ie<de;ie++)(we=j[ie]).$$is_string?ce=ve[we]:(ce=we.value,we=we.key),v.hash_put(R,we,ce)},v.hash_put=function(T,R,ie){if(R.$$is_string)return D.call(T.$$smap,R)||T.$$keys.push(R),void(T.$$smap[R]=ie);var j,ve,de;if(j=T.$$by_identity?v.id(R):R.$hash(),!D.call(T.$$map,j))return T.$$keys.push(ve={key:R,key_hash:j,value:ie}),void(T.$$map[j]=ve);for(ve=T.$$map[j];ve;){if(R===ve.key||R["$eql?"](ve.key)){de=void 0,ve.value=ie;break}de=ve,ve=ve.next}de&&(T.$$keys.push(ve={key:R,key_hash:j,value:ie}),de.next=ve)},v.hash_get=function(T,R){if(R.$$is_string)return D.call(T.$$smap,R)?T.$$smap[R]:void 0;var ie,j;if(ie=T.$$by_identity?v.id(R):R.$hash(),D.call(T.$$map,ie))for(j=T.$$map[ie];j;){if(R===j.key||R["$eql?"](j.key))return j.value;j=j.next}},v.hash_delete=function(T,R){var ie,de,we,j=T.$$keys,ve=j.length;if(R.$$is_string){if("string"!=typeof R&&(R=R.valueOf()),!D.call(T.$$smap,R))return;for(ie=0;ie<ve;ie++)if((we=j[ie]).$$is_string&&"string"!=typeof we&&(we=we.valueOf()),we===R){j.splice(ie,1);break}return de=T.$$smap[R],delete T.$$smap[R],de}var ce=R.$hash();if(D.call(T.$$map,ce))for(var B,he=T.$$map[ce];he;){if(R===he.key||R["$eql?"](he.key)){for(de=he.value,ie=0;ie<ve;ie++)if(j[ie]===he){j.splice(ie,1);break}return B&&he.next?B.next=he.next:B?delete B.next:he.next?T.$$map[ce]=he.next:delete T.$$map[ce],de}B=he,he=he.next}},v.hash_rehash=function(T){for(var j,ve,de,R=0,ie=T.$$keys.length;R<ie;R++)if(!T.$$keys[R].$$is_string&&(j=T.$$keys[R].key.$hash())!==T.$$keys[R].key_hash){for(ve=T.$$map[T.$$keys[R].key_hash],de=void 0;ve;){if(ve===T.$$keys[R]){de&&ve.next?de.next=ve.next:de?delete de.next:ve.next?T.$$map[T.$$keys[R].key_hash]=ve.next:delete T.$$map[T.$$keys[R].key_hash];break}de=ve,ve=ve.next}if(T.$$keys[R].key_hash=j,!D.call(T.$$map,j)){T.$$map[j]=T.$$keys[R];continue}for(ve=T.$$map[j],de=void 0;ve;){if(ve===T.$$keys[R]){de=void 0;break}de=ve,ve=ve.next}de&&(de.next=T.$$keys[R])}},v.hash=function(){var R,ie,j,ve,de,T=arguments.length;if(1===T&&arguments[0].$$is_hash)return arguments[0];if(ie=new v.Hash,v.hash_init(ie),1===T&&arguments[0].$$is_array){for(ve=(R=arguments[0]).length,j=0;j<ve;j++){if(2!==R[j].length)throw v.ArgumentError.$new("value not of length 2: "+R[j].$inspect());v.hash_put(ie,de=R[j][0],R[j][1])}return ie}if(1===T){for(de in R=arguments[0])D.call(R,de)&&v.hash_put(ie,de,R[de]);return ie}if(T%2!=0)throw v.ArgumentError.$new("odd number of arguments for Hash");for(j=0;j<T;j+=2)v.hash_put(ie,de=arguments[j],arguments[j+1]);return ie},v.hash2=function(T,R){var ie=new v.Hash;return ie.$$smap=R,ie.$$map=Object.create(null),ie.$$keys=T,ie},v.range=function(T,R,ie){var j=new v.Range;return j.begin=T,j.end=R,j.excl=ie,j},v.ivar=function(T){return"constructor"===T||"displayName"===T||"__count__"===T||"__noSuchMethod__"===T||"__parent__"===T||"__proto__"===T||"hasOwnProperty"===T||"valueOf"===T?T+"$":T},v.escape_regexp=function(T){return T.replace(/([-[\]\/{}()*+?.^$\\| ])/g,"\\$1").replace(/[\n]/g,"\\n").replace(/[\r]/g,"\\r").replace(/[\f]/g,"\\f").replace(/[\t]/g,"\\t")},v.global_regexp=function(T){return T.global?T:(null==T.$$g?T.$$g=new RegExp(T.source,(T.multiline?"gm":"g")+(T.ignoreCase?"i":"")):T.$$g.lastIndex=null,T.$$g)},v.global_multiline_regexp=function(T){var R;if(T.multiline){if(T.global)return T;R=null!=T.$$g?T.$$g:T.$$g=new RegExp(T.source,"gm"+(T.ignoreCase?"i":""))}else R=null!=T.$$gm?T.$$gm:T.$$gm=new RegExp(T.source,"gm"+(T.ignoreCase?"i":""));return R.lastIndex=null,R},v.regexp=function(T,R){for(var ie,j=void 0!==R&&R&&R.indexOf("i")>=0,ve=0,de=T.length;ve<de;ve++)(ie=T[ve])instanceof RegExp&&(ie.ignoreCase!==j&&v.Kernel.$warn("ignore case doesn't match for "+ie.source.$inspect(),v.hash({uplevel:1})),ie=ie.source),""===ie&&(ie="(?:"+ie+")"),T[ve]=ie;return R?new RegExp(T.join(""),R):new RegExp(T.join(""))},v.modules={},v.loaded_features=["corelib/runtime"],v.current_dir=".",v.require_table={"corelib/runtime":!0},v.normalize=function(T){var R,ie,j=[];"."!==v.current_dir&&(T=v.current_dir.replace(/\/*$/,"/")+T);for(var de=0,we=(R=(T=(T=T.replace(/^\.\//,"")).replace(/\.(rb|opal|js)$/,"")).split("/")).length;de<we;de++)""!==(ie=R[de])&&(".."===ie?j.pop():j.push(ie));return j.join("/")},v.loaded=function(T){var R,ie,j;for(R=0,ie=T.length;R<ie;R++)j=v.normalize(T[R]),!v.require_table[j]&&(v.loaded_features.push(j),v.require_table[j]=!0)},v.load=function(T){T=v.normalize(T),v.loaded([T]);var R=v.modules[T];if(R){var ie=R(v);if("undefined"!=typeof Promise&&ie instanceof Promise)return ie.then(function(){return!0})}else{var j=v.config.missing_require_severity,ve="cannot load such file -- "+T;if("error"===j)throw v.LoadError?v.LoadError.$new(ve):ve;"warning"===j&&ae.warn("WARNING: LoadError: "+ve)}return!0},v.require=function(T){return T=v.normalize(T),!v.require_table[T]&&v.load(T)},v.encodings=Object.create(null),v.set_encoding=function(T,R,ie){if(void 0===ie&&(ie="encoding"),"string"==typeof T||!0===T.$$frozen)throw v.FrozenError.$new("can't modify frozen String");var j=v.find_encoding(R);return j===T[ie]||(T[ie]=j),T},v.find_encoding=function(T){var R=v.encodings,ie=R[T]||R[T.toUpperCase()];if(!ie)throw v.ArgumentError.$new("unknown encoding name - "+T);return ie},v.enc=function(T,R){var ie=new String(T);return(ie=v.set_encoding(ie,R)).internal_encoding=ie.encoding,ie},v.binary=function(T){var R=new String(T);return v.set_encoding(R,"binary","internal_encoding")},v.last_promise=null,v.promise_unhandled_exception=!1,v.queue=function(T){if(v.last_promise)return v.last_promise=v.last_promise.then(function(){if(!v.promise_unhandled_exception)return T(v)}).catch(function(ie){v.respond_to(ie,"$full_message")&&(ie=ie.$full_message()),ae.error(ie),v.promise_unhandled_exception=!0,v.exit(1)}),v.last_promise;var R=T(v);return"function"==typeof Promise&&"object"==typeof R&&R instanceof Promise&&(v.last_promise=R),R},v.rb_plus=function(T,R){return"number"==typeof T&&"number"==typeof R?T+R:T["$+"](R)},v.rb_minus=function(T,R){return"number"==typeof T&&"number"==typeof R?T-R:T["$-"](R)},v.rb_times=function(T,R){return"number"==typeof T&&"number"==typeof R?T*R:T["$*"](R)},v.rb_divide=function(T,R){return"number"==typeof T&&"number"==typeof R?T/R:T["$/"](R)},v.rb_lt=function(T,R){return"number"==typeof T&&"number"==typeof R?T<R:T["$<"](R)},v.rb_gt=function(T,R){return"number"==typeof T&&"number"==typeof R?T>R:T["$>"](R)},v.rb_le=function(T,R){return"number"==typeof T&&"number"==typeof R?T<=R:T["$<="](R)},v.rb_ge=function(T,R){return"number"==typeof T&&"number"==typeof R?T>=R:T["$>="](R)},v.eqeq=function(T,R){return"number"==typeof T&&"number"==typeof R||"string"==typeof T&&"string"==typeof R?T===R:se(T["$=="](R))},v.eqeqeq=function(T,R){return"number"==typeof T&&"number"==typeof R||"string"==typeof T&&"string"==typeof R?T===R:se(T["$==="](R))},v.neqeq=function(T,R){return"number"==typeof T&&"number"==typeof R||"string"==typeof T&&"string"==typeof R?T!==R:se(T["$!="](R))},v.not=function(T){return!0!==T&&(null==T||!1===T||Y===T||se(T["$!"]()))},v.BasicObject=a=v.allocate_class("BasicObject",null),v.Object=y=v.allocate_class("Object",v.BasicObject),v.Module=w=v.allocate_class("Module",v.Object),v.Class=p=v.allocate_class("Class",v.Module),v.Opal=u=v.allocate_module("Opal"),v.Kernel=k=v.allocate_module("Kernel"),F(v.BasicObject,v.Class.$$prototype),F(v.Object,v.Class.$$prototype),F(v.Module,v.Class.$$prototype),F(v.Class,v.Class.$$prototype),a.$$const.BasicObject=a,A(y,"BasicObject",a),A(y,"Object",y),A(y,"Module",w),A(y,"Class",p),A(y,"Opal",u),A(y,"Kernel",k),a.$$class=p,y.$$class=p,w.$$class=p,p.$$class=p,u.$$class=w,k.$$class=w,U(y.$$prototype,"toString",function(){var T=this.$to_s();return T.$$is_string&&"object"==typeof T?T.valueOf():T}),U(y.$$prototype,"$require",v.require),v.top=new y,v.top.$to_s=v.top.$inspect=function(){return"main"},v.top.$define_method=function ye(){var T=v.slice.call(arguments),R=ye.$$p;return delete ye.$$p,v.send(y,"define_method",T,R)},v.NilClass=v.allocate_class("NilClass",v.Object),A(y,"NilClass",v.NilClass),(Y=v.nil=new v.NilClass).$$id=4,Y.call=Y.apply=function(){throw v.LocalJumpError.$new("no block given")},v.breaker=new Error("unexpected break (old)"),v.returner=new Error("unexpected return"),TypeError.$$super=Error}).call(this),Opal.loaded(["corelib/runtime.js"]),Opal.modules["corelib/helpers"]=function(E){var ae=E.nil,Y=E.$$$,a=E.type_error,y=E.coerce_to,w=E.module,p=E.defs,u=E.eqeqeq,k=E.Kernel,v=E.truthy,D=E.Opal;return function(_){var F=w("::","Opal");p(F,"$bridge",function(L,H){return E.bridge(L,H)},2),p(F,"$coerce_to!",function(L,H,U,se){var ue,K=ae;return ue=E.slice.call(arguments,3),K=y(L,H,U,ue),u(H,K)||k.$raise(a(L,H,U,K)),K},-4),p(F,"$coerce_to?",function(L,H,U,se){var J,K=ae;return J=E.slice.call(arguments,3),!v(L["$respond_to?"](U))||(K=y(L,H,U,J),v(K["$nil?"]()))?ae:(u(H,K)||k.$raise(a(L,H,U,K)),K)},-4),p(F,"$try_convert",function(L,H,U){return u(H,L)?L:v(L["$respond_to?"](U))?L.$__send__(U):ae},3),p(F,"$compare",function(L,H){var U;return U=L["$<=>"](H),v(U===ae)&&k.$raise(Y("ArgumentError"),"comparison of "+L.$class()+" with "+H.$class()+" failed"),U},2),p(F,"$destructure",function(L){if(1==L.length)return L[0];if(L.$$is_array)return L;for(var H=new Array(L.length),U=0,se=H.length;U<se;U++)H[U]=L[U];return H},1),p(F,"$respond_to?",function(L,H,U){return null==U&&(U=!1),!(null==L||!L.$$class)&&L["$respond_to?"](H,U)},-3),p(F,"$instance_variable_name!",function(L){return L=D["$coerce_to!"](L,Y("String"),"to_str"),v(/^@[a-zA-Z_][a-zA-Z0-9_]*?$/.test(L))||k.$raise(Y("NameError").$new("'"+L+"' is not allowed as an instance variable name",L)),L},1),p(F,"$class_variable_name!",function(L){return L=D["$coerce_to!"](L,Y("String"),"to_str"),v(L.length<3||"@@"!==L.slice(0,2))&&k.$raise(Y("NameError").$new("`"+L+"' is not allowed as a class variable name",L)),L},1),p(F,"$const_name?",function(L){return"string"!=typeof L&&(L=D["$coerce_to!"](L,Y("String"),"to_str")),L[0]===L[0].toUpperCase()},1),p(F,"$const_name!",function(L){return v(Y("::","String","skip_raise")?"constant":ae)&&(L=D["$coerce_to!"](L,Y("String"),"to_str")),(!L||L[0]!=L[0].toUpperCase())&&this.$raise(Y("NameError"),"wrong constant name "+L),L},1),p(F,"$pristine",function(L,H){for(var se,J,K=(se=E.slice.call(arguments,1)).length-1;K>=0;K--)(J=L.$$prototype["$"+se[K]])&&!J.$$stub&&(J.$$pristine=!0);return ae},-2);var oe=[];return p(F,"$inspect",function(L){var U=!1;return function(){try{try{return null===L?"null":void 0===L?"undefined":void 0===L.$$class?Object.prototype.toString.apply(L):"function"!=typeof L.$inspect||L.$inspect.$$stub||-1!==oe.indexOf(L.$__id__())?"#<"+L.$$class+":0x"+L.$__id__().$to_s(16)+">":(oe.push(L.$__id__()),U=!0,L.$inspect())}catch(se){if(!E.rescue(se,[Y("Exception")]))throw se;try{return"#<"+L.$$class+":0x"+L.$__id__().$to_s(16)+">"}finally{E.pop_exception()}}}finally{U&&oe.pop()}}()},-1)}()},Opal.modules["corelib/module"]=function(E){var P,g,b,C,Y=E.nil,a=E.$$$,y=E.truthy,w=E.coerce_to,p=E.const_set,u=E.Object,k=E.klass,v=E.defs,D=E.send,_=E.def,F=E.eqeqeq,oe=E.Module,V=E.Kernel,L=E.rb_lt,H=E.rb_gt,U=E.to_a,se=E.hash2,ue=E.Opal,J=E.eqeq,K=E.lambda,ee=E.range,M=E.send2,G=E.find_super,z=E.alias;return P=[],g=k("::",null,"Module"),b=[g].concat(P),C=E.$r(b),v(g,"$allocate",function(){var l=E.allocate_module(Y,function(){});return this!==E.Module&&Object.setPrototypeOf(l,this.$$prototype),l},0),_(g,"$initialize",function h(){var c=h.$$p||Y;return delete h.$$p,c!==Y?D(this,"module_eval",[],c.$to_proc()):Y},0),_(g,"$===",function(c){return!y(null==c)&&E.is_a(c,this)},1),_(g,"$<",function(c){var m,x,S,l=this;if(F(oe,c)||V.$raise(a("TypeError"),"compared with non class/module"),l===c)return!1;for(x=0,S=(m=E.ancestors(l)).length;x<S;x++)if(m[x]===c)return!0;for(x=0,S=(m=E.ancestors(c)).length;x<S;x++)if(m[x]===l)return!1;return Y},1),_(g,"$<=",function(c){var f;return y(f=this["$equal?"](c))?f:L(this,c)},1),_(g,"$>",function(c){return F(oe,c)||V.$raise(a("TypeError"),"compared with non class/module"),L(c,this)},1),_(g,"$>=",function(c){var f;return y(f=this["$equal?"](c))?f:H(this,c)},1),_(g,"$<=>",function(c){var f=Y;return this===c?0:!F(oe,c)||(f=L(this,c),y(f["$nil?"]()))?Y:y(f)?-1:1},1),_(g,"$alias_method",function(c,l){return c=w(c,a("String"),"to_str"),l=w(l,a("String"),"to_str"),E.alias(this,c,l),this},2),_(g,"$alias_native",function(c,l){return null==l&&(l=c),E.alias_native(this,c,l),this},-2),_(g,"$ancestors",function(){return E.ancestors(this)},0),_(g,"$append_features",function(c){return E.append_features(this,c),this},1),_(g,"$attr_accessor",function(c){var l,f,m=this;return l=E.slice.call(arguments),D(m,"attr_reader",U(f=l)),D(m,"attr_writer",U(f))},-1),_(g,"$attr",function(c){var f,m=this;return 2!=(f=E.slice.call(arguments)).length||!0!==f[1]&&!1!==f[1]?D(m,"attr_reader",U(f)):(m.$warn("optional boolean argument is obsoleted",se(["uplevel"],{uplevel:1})),f[1]?m.$attr_accessor(f[0]):m.$attr_reader(f[0]),Y)},-1),_(g,"$attr_reader",function(c){var l,f,m=this;l=E.slice.call(arguments);for(var x=m.$$prototype,S=(f=l).length-1;S>=0;S--){var Z=f[S],le="$"+Z,ye=E.ivar(Z),T=function(R){return function(){return null==this[R]?Y:this[R]}}(ye);E.prop(x,ye,Y),T.$$parameters=[],T.$$arity=0,E.defn(m,le,T)}return Y},-1),_(g,"$attr_writer",function(c){var l,f,m=this;l=E.slice.call(arguments);for(var x=m.$$prototype,S=(f=l).length-1;S>=0;S--){var Z=f[S],le="$"+Z+"=",ye=E.ivar(Z),T=function(R){return function(ie){return this[R]=ie}}(ye);T.$$parameters=[["req"]],T.$$arity=1,E.prop(x,ye,Y),E.defn(m,le,T)}return Y},-1),_(g,"$autoload",function(c,l){var f=this;return C("Opal")["$const_name?"](c)||V.$raise(a("NameError"),"autoload must be constant name: "+c),""==l&&V.$raise(a("ArgumentError"),"empty file name"),f.$$const.hasOwnProperty(c)||(f.$$autoload||(f.$$autoload={}),E.const_cache_version++,f.$$autoload[c]={path:l,loaded:!1,required:!1,success:!1,exception:!1}),Y},2),_(g,"$autoload?",function(c){var l=this;if(l.$$autoload&&l.$$autoload[c]&&!l.$$autoload[c].required&&!l.$$autoload[c].success)return l.$$autoload[c].path;for(var f=l.$ancestors(),m=0,x=f.length;m<x;m++)if(f[m].$$autoload&&f[m].$$autoload[c]&&!f[m].$$autoload[c].required&&!f[m].$$autoload[c].success)return f[m].$$autoload[c].path;return Y},1),_(g,"$class_variables",function(){return Object.keys(E.class_variables(this))},0),_(g,"$class_variable_get",function(c){return c=ue["$class_variable_name!"](c),E.class_variable_get(this,c,!1)},1),_(g,"$class_variable_set",function(c,l){return c=ue["$class_variable_name!"](c),E.class_variable_set(this,c,l)},2),_(g,"$class_variable_defined?",function(c){return c=ue["$class_variable_name!"](c),E.class_variables(this).hasOwnProperty(c)},1),_(g,"$remove_class_variable",function(c){var l=this;if(c=ue["$class_variable_name!"](c),E.hasOwnProperty.call(l.$$cvars,c)){var f=l.$$cvars[c];return delete l.$$cvars[c],f}V.$raise(a("NameError"),"cannot remove "+c+" for "+l)},1),_(g,"$constants",function(c){return null==c&&(c=!0),E.constants(this,c)},-1),v(g,"$constants",function(c){if(null==c){var m,S,Z,f=(this.$$nesting||[]).concat(u),x={};for(S=0,Z=f.length;S<Z;S++)for(m in f[S].$$const)x[m]=!0;return Object.keys(x)}return E.constants(this,c)},-1),v(g,"$nesting",function(){return this.$$nesting||[]},0),_(g,"$const_defined?",function(c,l){var f=this;null==l&&(l=!0),c=C("Opal")["$const_name!"](c),y(c["$=~"](a(ue,"CONST_NAME_REGEXP")))||V.$raise(a("NameError").$new("wrong constant name "+c,c));var m,Z,le,x=[f];for(l&&(x=x.concat(E.ancestors(f)),f.$$is_module&&(x=x.concat([u]).concat(E.ancestors(u)))),Z=0,le=x.length;Z<le;Z++)if(null!=(m=x[Z]).$$const[c]||m.$$autoload&&m.$$autoload[c]&&!m.$$autoload[c].required&&!m.$$autoload[c].success)return!0;return!1},-2),_(g,"$const_get",function(c,l){var f=this;return null==l&&(l=!0),0===(c=C("Opal")["$const_name!"](c)).indexOf("::")&&"::"!==c&&(c=c.slice(2)),y(-1!=c.indexOf("::")&&"::"!=c)?D(c.$split("::"),"inject",[f],function(x,S){return null==x&&(x=Y),null==S&&(S=Y),x.$const_get(S)},2):(y(c["$=~"](a(ue,"CONST_NAME_REGEXP")))||V.$raise(a("NameError").$new("wrong constant name "+c,c)),l?E.$$([f],c):E.const_get_local(f,c))},-2),_(g,"$const_missing",function(c){var f;return f=J(this,u)?c:this+"::"+c,V.$raise(a("NameError").$new("uninitialized constant "+f,c))},1),_(g,"$const_set",function(c,l){return c=ue["$const_name!"](c),(y(c["$!~"](a(ue,"CONST_NAME_REGEXP")))||y(c["$start_with?"]("::")))&&V.$raise(a("NameError").$new("wrong constant name "+c,c)),p(this,c,l),l},2),_(g,"$public_constant",function(c){return Y},1),_(g,"$define_method",function h(c,l){var x,f=h.$$p||Y,S=Y;delete h.$$p,void 0===l&&f===Y&&V.$raise(a("ArgumentError"),"tried to create a Proc object without a block"),f=y(x=f)?x:F(a("Proc"),S=l)?l:F(a("Method"),S)?l.$to_proc().$$unbound:F(a("UnboundMethod"),S)?K(function le(ye){var R,ie=null==le.$$s?this:le.$$s,j=Y;return R=E.slice.call(arguments),j=l.$bind(ie),D(j,"call",U(R))},{$$arity:-1,$$s:this}):V.$raise(a("TypeError"),"wrong argument type "+f.$class()+" (expected Proc/Method)");var Z="$"+c;return f.$$jsid=c,f.$$s=null,f.$$def=f,f.$$define_meth=!0,E.defn(this,Z,f)},-2),_(g,"$remove_method",function(c){for(var f,m=this,x=0,S=(f=E.slice.call(arguments)).length;x<S;x++)E.rdef(m,"$"+f[x]);return m},-1),_(g,"$singleton_class?",function(){return!!this.$$is_singleton},0),_(g,"$include",function(c){for(var f,m=this,x=(f=E.slice.call(arguments)).length-1;x>=0;x--){var S=f[x];S.$$is_module||V.$raise(a("TypeError"),"wrong argument type "+S.$class()+" (expected Module)"),S.$append_features(m),S.$included(m)}return m},-1),_(g,"$included_modules",function(){return E.included_modules(this)},0),_(g,"$include?",function(c){c.$$is_module||V.$raise(a("TypeError"),"wrong argument type "+c.$class()+" (expected Module)");var f,m,x,S=E.ancestors(this);for(f=0,m=S.length;f<m;f++)if((x=S[f])===c&&x!==this)return!0;return!1},1),_(g,"$instance_method",function(c){var l=this,f=l.$$prototype["$"+c];return(!f||f.$$stub)&&V.$raise(a("NameError").$new("undefined method `"+c+"' for class `"+l.$name()+"'",c)),a("UnboundMethod").$new(l,f.$$owner||l,f,c)},1),_(g,"$instance_methods",function(c){return null==c&&(c=!0),y(c)?E.instance_methods(this):E.own_instance_methods(this)},-1),_(g,"$included",function(c){return Y},1),_(g,"$extended",function(c){return Y},1),_(g,"$extend_object",function(c){return Y},1),_(g,"$method_added",function(c){return E.slice.call(arguments),Y},-1),_(g,"$method_removed",function(c){return E.slice.call(arguments),Y},-1),_(g,"$method_undefined",function(c){return E.slice.call(arguments),Y},-1),_(g,"$module_eval",function h(c){var m,x,l=h.$$p||Y,S=this,Z=Y,T=Y,R=Y,ie=Y,j=Y;delete h.$$p,m=E.slice.call(arguments),y(l["$nil?"]())&&y(!!E.compile)?(y(ee(1,3,!1)["$cover?"](m.$size()))||V.$raise(a("ArgumentError"),"wrong number of arguments (0 for 1..3)"),Z=null==(x=[].concat(U(m)))[0]?Y:x[0],T=se(["file","eval"],{file:y(R=null==x[1]?Y:x[1])?R:"(eval)",eval:!0}),ie=E.hash({arity_check:!1}).$merge(T),j=ue.$compile(Z,ie),l=D(V,"proc",[],function we(){var ce=null==we.$$s?this:we.$$s;return new Function("Opal,self","return "+j)(E,ce)},{$$arity:0,$$s:S})):y(m["$any?"]())&&V.$raise(a("ArgumentError"),"wrong number of arguments ("+m.$size()+" for 0)\n\n  NOTE:If you want to enable passing a String argument please add \"require 'opal-parser'\" to your script\n");var de,ve=l.$$s;return l.$$s=null,de=l.apply(S,[S]),l.$$s=ve,de},-1),_(g,"$module_exec",function h(c){var m,l=h.$$p||Y,x=this;delete h.$$p,m=E.slice.call(arguments),l===Y&&V.$raise(a("LocalJumpError"),"no block given");var Z,S=l.$$s;return l.$$s=null,Z=l.apply(x,m),l.$$s=S,Z},-1),_(g,"$method_defined?",function(c){var f=this.$$prototype["$"+c];return!!f&&!f.$$stub},1),_(g,"$module_function",function(c){var f,m=this;if(0===(f=E.slice.call(arguments)).length)return m.$$module_function=!0,Y;for(var x=0,S=f.length;x<S;x++){var Z=f[x],le="$"+Z,ye=m.$$prototype[le];E.defs(m,le,ye)}return 1===f.length?f[0]:f},-1),_(g,"$name",function(){var c=this;if(c.$$full_name)return c.$$full_name;for(var l=[],f=c;f;){if(f.$$name===Y||null==f.$$name)return Y;if(l.unshift(f.$$name),(f=f.$$base_module)===u)break}return 0===l.length?Y:c.$$full_name=l.join("::")},0),_(g,"$prepend",function(c){var f,m=this;0===(f=E.slice.call(arguments)).length&&V.$raise(a("ArgumentError"),"wrong number of arguments (given 0, expected 1+)");for(var x=f.length-1;x>=0;x--){var S=f[x];S.$$is_module||V.$raise(a("TypeError"),"wrong argument type "+S.$class()+" (expected Module)"),S.$prepend_features(m),S.$prepended(m)}return m},-1),_(g,"$prepend_features",function(c){var l=this;return l.$$is_module||V.$raise(a("TypeError"),"wrong argument type "+l.$class()+" (expected Module)"),E.prepend_features(l,c),l},1),_(g,"$prepended",function(c){return Y},1),_(g,"$remove_const",function(c){return E.const_remove(this,c)},1),_(g,"$to_s",function(){var l,c=this;return y(l=E.Module.$name.call(c))?l:"#<"+(c.$$is_module?"Module":"Class")+":0x"+c.$__id__().$to_s(16)+">"},0),_(g,"$undef_method",function(c){for(var f,m=this,x=0,S=(f=E.slice.call(arguments)).length;x<S;x++)E.udef(m,"$"+f[x]);return m},-1),_(g,"$instance_variables",function(){var c=this,l=Y;E.Module.$$nesting=b,l=c.$constants();var f=[];for(var m in c)c.hasOwnProperty(m)&&"$"!==m.charAt(0)&&"constructor"!==m&&!l["$include?"](m)&&f.push("@"+m);return f},0),_(g,"$dup",function h(){var c=h.$$p||Y,l=this,f=Y;return delete h.$$p,(f=M(l,G(l,"dup",h,!1,!0),"dup",[],c)).$copy_class_variables(l),f.$copy_constants(l),f},0),_(g,"$copy_class_variables",function(c){for(var f in c.$$cvars)this.$$cvars[f]=c.$$cvars[f]},1),_(g,"$copy_constants",function(c){var f,m=c.$$const;for(f in m)p(this,f,m[f])},1),_(g,"$refine",function h(c){var f,x,Z,l=h.$$p||Y,m=this,S=Y;return delete h.$$p,x=(f=[m,Y,Y])[0],S=f[1],Z=E.id(c),void 0===m.$$refine_modules&&(m.$$refine_modules={}),(S=void 0===m.$$refine_modules[Z]?m.$$refine_modules[Z]=a("Refinement").$new():m.$$refine_modules[Z]).refinement_module=x,S.refined_class=c,D(S,"class_exec",[],l.$to_proc()),S},1),_(g,"$using",function(c){return V.$raise("Module#using is not permitted in methods")},1),z(g,"class_eval","module_eval"),z(g,"class_exec","module_exec"),z(g,"inspect","to_s"),function(A,N){var P=k("::",N,"Refinement"),g=P.$$prototype;return g.refinement_module=g.refined_class=Y,_(P,"$inspect",function b(){var C=b.$$p||Y,h=this;return delete b.$$p,y(h.refinement_module)?"#<refinement:"+h.refined_class.$inspect()+"@"+h.refinement_module.$inspect()+">":M(h,G(h,"inspect",b,!1,!0),"inspect",[],C)},0)}(0,oe)},Opal.modules["corelib/class"]=function(E){var V,L,H,U,a=E.nil,y=E.klass,w=E.send,p=E.defs,u=E.def,k=E.rb_plus,v=E.send2,D=E.find_super,_=E.alias;return E.top.$require("corelib/module"),V=[],H=[L=y("::",null,"Class")].concat(V),U=E.$r(H),p(L,"$new",function se(ue){var J=se.$$p||a;if(delete se.$$p,null==ue&&(ue=U("Object")),!ue.$$is_class)throw E.TypeError.$new("superclass must be a Class");var K=E.allocate_class(a,ue);return ue.$inherited(K),J!==a&&w(K,"class_eval",[],J.$to_proc()),K},-1),u(L,"$allocate",function(){var J=new this.$$constructor;return J.$$id=E.uid(),J},0),u(L,"$descendants",function(){return k(this.$subclasses(),w(this.$subclasses(),"map",[],"descendants".$to_proc()).$flatten())},0),u(L,"$inherited",function(ue){return a},1),u(L,"$initialize_dup",function(ue){var J=this;J.$initialize_copy(ue),J.$$name=null,J.$$full_name=null},1),u(L,"$new",function se(ue){var ee,J=se.$$p||a,M=this;delete se.$$p,ee=E.slice.call(arguments);var G=M.$allocate();return E.send(G,G.$initialize,ee,J),G},-1),u(L,"$subclasses",function(){if("undefined"!=typeof WeakRef){var J,K,ee=[];for(J=0;J<this.$$subclasses.length;J++)void 0!==(K=this.$$subclasses[J].deref())&&ee.push(K);return ee}return this.$$subclasses},0),u(L,"$superclass",function(){return this.$$super||a},0),u(L,"$to_s",function se(){var J=this;delete se.$$p;var K=J.$$singleton_of;return K&&K.$$is_a_module?"#<Class:"+K.$name()+">":K?"#<Class:#<"+K.$$class.$name()+":0x"+E.id(K).$to_s(16)+">>":v(J,D(J,"to_s",se,!1,!0),"to_s",[],null)},0),_(L,"inspect","to_s")},Opal.modules["corelib/basic_object"]=function(E){"use strict";var U,ae=E.nil,Y=E.$$$,y=E.def,w=E.alias,p=E.truthy,u=E.range,k=E.Kernel,v=E.to_a,D=E.hash2,_=E.Opal,F=E.send,oe=E.eqeq,V=E.rb_ge;return y(U=(0,E.klass)("::",null,"BasicObject"),"$initialize",function(ue){return E.slice.call(arguments),ae},-1),y(U,"$==",function(ue){return this===ue},1),y(U,"$eql?",function(ue){return this["$=="](ue)},1),w(U,"equal?","=="),y(U,"$__id__",function(){return null!=this.$$id||E.prop(this,"$$id",E.uid()),this.$$id},0),y(U,"$__send__",function se(ue,J){var M,K=se.$$p||ae,G=this;delete se.$$p,M=E.slice.call(arguments,1),ue.$$is_string||G.$raise(Y("TypeError"),G.$inspect()+" is not a symbol nor a string");var z=G["$"+ue];return z?(K!==ae&&(z.$$p=K),z.apply(G,M)):(K!==ae&&(G.$method_missing.$$p=K),G.$method_missing.apply(G,[ue].concat(M)))},-2),y(U,"$!",function(){return!1},0),y(U,"$!=",function(ue){return this["$=="](ue)["$!"]()},1),y(U,"$instance_eval",function se(ue){var ee,M,J=se.$$p||ae,G=this,z=ae,P=ae,g=ae,b=ae,C=ae;if(delete se.$$p,ee=E.slice.call(arguments),p(J["$nil?"]())&&p(!!E.compile))p(u(1,3,!1)["$cover?"](ee.$size()))||k.$raise(Y("ArgumentError"),"wrong number of arguments (0 for 1..3)"),z=null==(M=[].concat(v(ee)))[0]?ae:M[0],P=D(["file","eval"],{file:p(g=null==M[1]?ae:M[1])?g:"(eval)",eval:!0}),b=E.hash({arity_check:!1}).$merge(P),C=_.$compile(z,b),J=F(k,"proc",[],function l(){var f=null==l.$$s?this:l.$$s;return new Function("Opal,self","return "+C)(E,f)},{$$arity:0,$$s:G});else{if(p(J["$nil?"]())&&p(V(ee.$length(),1))&&oe(ee.$first()["$[]"](0),"@"))return G.$instance_variable_get(ee.$first());p(ee["$any?"]())&&k.$raise(Y("ArgumentError"),"wrong number of arguments ("+ee.$size()+" for 0)")}var c,h=J.$$s;if(J.$$s=null,G.$$is_a_module){G.$$eval=!0;try{c=J.call(G,G)}finally{G.$$eval=!1}}else c=J.call(G,G);return J.$$s=h,c},-1),y(U,"$instance_exec",function se(ue){var ee,J=se.$$p||ae,M=this;delete se.$$p,ee=E.slice.call(arguments),p(J)||k.$raise(Y("ArgumentError"),"no block given");var z,G=J.$$s;if(J.$$s=null,M.$$is_a_module){M.$$eval=!0;try{z=J.apply(M,ee)}finally{M.$$eval=!1}}else z=J.apply(M,ee);return J.$$s=G,z},-1),y(U,"$singleton_method_added",function(ue){return E.slice.call(arguments),ae},-1),y(U,"$singleton_method_removed",function(ue){return E.slice.call(arguments),ae},-1),y(U,"$singleton_method_undefined",function(ue){return E.slice.call(arguments),ae},-1),y(U,"$method_missing",function se(ue,J){var M,G=this,z=ae;return delete se.$$p,M=E.slice.call(arguments,1),z=_.$inspect(G),k.$raise(Y("NoMethodError").$new("undefined method `"+ue+"' for "+z,ue,M),ae,k.$caller(1))},-2),_.$pristine(U,"method_missing"),y(U,"$respond_to_missing?",function(ue,J){return null==J&&(J=!1),!1},-2)},Opal.modules["corelib/kernel"]=function(E){"use strict";var z,Y=E.nil,a=E.$$$,y=E.truthy,w=E.coerce_to,p=E.respond_to,u=E.Opal,k=E.module,v=E.def,D=E.Kernel,_=E.gvars,F=E.hash2,oe=E.send,V=E.to_a,L=E.rb_plus,H=E.eqeq,U=E.eqeqeq,se=E.rb_le,ue=E.rb_lt,J=E.Object,K=E.alias,ee=E.klass;return function(M,G){var z=k("::","Kernel"),A=[z].concat([]),N=E.$r(A);v(z,"$=~",function(b){return!1},1),v(z,"$!~",function(b){return this["$=~"](b)["$!"]()},1),v(z,"$===",function(b){var h;return y(h=this.$object_id()["$=="](b.$object_id()))?h:this["$=="](b)},1),v(z,"$<=>",function(b){this.$$comparable=!0;var h=this["$=="](b);return h&&h!==Y?0:Y},1),v(z,"$method",function(b){var C=this,h=C["$"+b];return(!h||h.$$stub)&&D.$raise(a("NameError").$new("undefined method `"+b+"' for class `"+C.$class()+"'",b)),a("Method").$new(C,h.$$owner||C.$class(),h,b)},1),v(z,"$methods",function(b){return null==b&&(b=!0),y(b)?E.methods(this):E.own_methods(this)},-1),v(z,"$public_methods",function(b){return null==b&&(b=!0),y(b)?E.methods(this):E.receiver_methods(this)},-1),v(z,"$Array",function(b){var C;return b===Y?[]:b.$$is_array?b:(C=u["$coerce_to?"](b,a("Array"),"to_ary"))!==Y||(C=u["$coerce_to?"](b,a("Array"),"to_a"))!==Y?C:[b]},1),v(z,"$at_exit",function g(){var C,b=g.$$p||Y;return null==_.__at_exit__&&(_.__at_exit__=Y),delete g.$$p,_.__at_exit__=y(C=_.__at_exit__)?C:[],_.__at_exit__["$<<"](b),b},0),v(z,"$caller",function(b,C){var h,c;null==b&&(b=1),null==C&&(C=Y),c=[];for(var l=b+1,f=(h=(new Error).$backtrace()).length;l<f;l++)h[l].match(/runtime\.js/)||c.push(h[l]);return C!=Y&&(c=c.slice(0,C)),c},-1),v(z,"$class",function(){return this.$$class},0),v(z,"$copy_instance_variables",function(b){var c,l,f,h=Object.keys(b);for(c=0,l=h.length;c<l;c++)"$"!==(f=h[c]).charAt(0)&&b.hasOwnProperty(f)&&(this[f]=b[f])},1),v(z,"$copy_singleton_methods",function(b){var h,c,l,f;if(b.hasOwnProperty("$$meta")){var m=E.get_singleton_class(b),x=E.get_singleton_class(this);for(h=0,f=(l=Object.getOwnPropertyNames(m.$$prototype)).length;h<f;h++)E.is_method(c=l[h])&&(x.$$prototype[c]=m.$$prototype[c]);x.$$const=Object.assign({},m.$$const),Object.setPrototypeOf(x.$$prototype,Object.getPrototypeOf(m.$$prototype))}for(h=0,f=(l=Object.getOwnPropertyNames(b)).length;h<f;h++)"$"===(c=l[h]).charAt(0)&&"$"!==c.charAt(1)&&b.hasOwnProperty(c)&&(this[c]=b[c])},1),v(z,"$clone",function(b){var h=this,c=Y;if(null==b)b=F([],{});else if(!b.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return(c=h.$class().$allocate()).$copy_instance_variables(h),c.$copy_singleton_methods(h),c.$initialize_clone(h),c},-1),v(z,"$initialize_clone",function(b){return this.$initialize_copy(b)},1),v(z,"$define_singleton_method",function g(b,C){var h=g.$$p||Y;return delete g.$$p,oe(this.$singleton_class(),"define_method",[b,C],h.$to_proc())},-2),v(z,"$dup",function(){var b=this,C=Y;return(C=b.$class().$allocate()).$copy_instance_variables(b),C.$initialize_dup(b),C},0),v(z,"$initialize_dup",function(b){return this.$initialize_copy(b)},1),v(z,"$enum_for",function g(b,C){var c,l,f,h=g.$$p||Y,m=this;return delete g.$$p,(c=E.slice.call(arguments)).length>0&&(l=c.shift()),null==l&&(l="each"),f=c,oe(a("Enumerator"),"for",[m,l].concat(V(f)),h.$to_proc())},-1),v(z,"$equal?",function(b){return this===b},1),v(z,"$exit",function(b){var h;for(null==_.__at_exit__&&(_.__at_exit__=Y),null==b&&(b=!0),_.__at_exit__=y(h=_.__at_exit__)?h:[];!y(_.__at_exit__["$empty?"]());)_.__at_exit__.$pop().$call();return b=b.$$is_boolean?b?0:1:w(b,a("Integer"),"to_int"),E.exit(b),Y},-1),v(z,"$extend",function(b){var h,c=this;h=E.slice.call(arguments);for(var l=c.$singleton_class(),f=h.length-1;f>=0;f--){var m=h[f];m.$$is_module||D.$raise(a("TypeError"),"wrong argument type "+m.$class()+" (expected Module)"),m.$append_features(l),m.$extend_object(c),m.$extended(c)}return c},-1),v(z,"$gets",function(b){var C;return null==_.stdin&&(_.stdin=Y),C=E.slice.call(arguments),oe(_.stdin,"gets",V(C))},-1),v(z,"$hash",function(){return this.$__id__()},0),v(z,"$initialize_copy",function(b){return Y},1);var P=[];v(z,"$inspect",function(){var b=this,C=Y,h=Y,c=Y;return function(){try{try{return C="",h=b.$__id__(),y(P["$include?"](h))?C=" ...":(P["$<<"](h),c=!0,oe(b.$instance_variables(),"each",[],function f(m){var S,Z;return null==m&&(m=Y),S=(null==f.$$s?this:f.$$s).$instance_variable_get(m),Z=N("Opal").$inspect(S),C=L(C," "+m+"="+Z)},{$$arity:1,$$s:b})),"#<"+b.$class()+":0x"+h.$to_s(16)+C+">"}catch(f){if(!E.rescue(f,[N("StandardError")]))throw f;try{return"#<"+b.$class()+":0x"+h.$to_s(16)+">"}finally{E.pop_exception()}}}finally{y(c)&&P.$pop()}}()},0),v(z,"$instance_of?",function(b){return!b.$$is_class&&!b.$$is_module&&D.$raise(a("TypeError"),"class or module required"),this.$$class===b},1),v(z,"$instance_variable_defined?",function(b){return b=u["$instance_variable_name!"](b),E.hasOwnProperty.call(this,b.substr(1))},1),v(z,"$instance_variable_get",function(b){b=u["$instance_variable_name!"](b);var h=this[E.ivar(b.substr(1))];return null==h?Y:h},1),v(z,"$instance_variable_set",function(b,C){return b=u["$instance_variable_name!"](b),this[E.ivar(b.substr(1))]=C},2),v(z,"$remove_instance_variable",function(b){var C=this;b=u["$instance_variable_name!"](b);var c,h=E.ivar(b.substr(1));return C.hasOwnProperty(h)?(c=C[h],delete C[h],c):D.$raise(a("NameError"),"instance variable "+b+" not defined")},1),v(z,"$instance_variables",function(){var h,C=[];for(var c in this)this.hasOwnProperty(c)&&"$"!==c.charAt(0)&&(h="$"===c.substr(-1)?c.slice(0,c.length-1):c,C.push("@"+h));return C},0),v(z,"$Integer",function(b,C){var h,c,l;return b.$$is_string?"0"===b?0:(void 0===C?C=0:(1===(C=w(C,a("Integer"),"to_int"))||C<0||C>36)&&D.$raise(a("ArgumentError"),"invalid radix "+C),c=(c=(c=b.toLowerCase()).replace(/(\d)_(?=\d)/g,"$1")).replace(/^(\s*[+-]?)(0[bodx]?)/,function(f,m,x){switch(x){case"0b":if(0===C||2===C)return C=2,m;case"0":case"0o":if(0===C||8===C)return C=8,m;case"0d":if(0===C||10===C)return C=10,m;case"0x":if(0===C||16===C)return C=16,m}D.$raise(a("ArgumentError"),'invalid value for Integer(): "'+b+'"')}),l="0-"+((C=0===C?10:C)<=10?C-1:"9a-"+String.fromCharCode(C-11+97)),new RegExp("^\\s*[+-]?["+l+"]+\\s*$").test(c)||D.$raise(a("ArgumentError"),'invalid value for Integer(): "'+b+'"'),h=parseInt(c,C),isNaN(h)&&D.$raise(a("ArgumentError"),'invalid value for Integer(): "'+b+'"'),h):(void 0!==C&&D.$raise(a("ArgumentError"),"base specified for non string value"),b===Y&&D.$raise(a("TypeError"),"can't convert nil into Integer"),b.$$is_number?((b===1/0||b===-1/0||isNaN(b))&&D.$raise(a("FloatDomainError"),b),Math.floor(b)):b["$respond_to?"]("to_int")&&(h=b.$to_int())!==Y?h:u["$coerce_to!"](b,a("Integer"),"to_i"))},-2),v(z,"$Float",function(b){var C;return b===Y&&D.$raise(a("TypeError"),"can't convert nil into Float"),b.$$is_string?(C=(C=b.toString()).replace(/(\d)_(?=\d)/g,"$1"),/^\s*[-+]?0[xX][0-9a-fA-F]+\s*$/.test(C)?D.$Integer(C):(/^\s*[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?\s*$/.test(C)||D.$raise(a("ArgumentError"),'invalid value for Float(): "'+b+'"'),parseFloat(C))):u["$coerce_to!"](b,a("Float"),"to_f")},1),v(z,"$Hash",function(b){return y(b["$nil?"]())||H(b,[])?F([],{}):U(a("Hash"),b)?b:u["$coerce_to!"](b,a("Hash"),"to_hash")},1),v(z,"$is_a?",function(b){return!b.$$is_class&&!b.$$is_module&&D.$raise(a("TypeError"),"class or module required"),E.is_a(this,b)},1),v(z,"$itself",function(){return this},0),v(z,"$lambda",function g(){var b=g.$$p||Y;return delete g.$$p,E.lambda(b)},0),v(z,"$load",function(b){return b=u["$coerce_to!"](b,a("String"),"to_str"),E.load(b)},1),v(z,"$loop",function g(){var C=g.$$p||Y,c=Y;if(delete g.$$p,C===Y)return oe(this,"enum_for",["loop"],function(){return a(a("Float"),"INFINITY")},0);for(;y(!0);)try{E.yieldX(C,[])}catch(l){if(!E.rescue(l,[a("StopIteration")]))throw l;c=l;try{return c.$result()}finally{E.pop_exception()}}return this},0),v(z,"$nil?",function(){return!1},0),v(z,"$printf",function(b){var C,h,c=this;return C=E.slice.call(arguments),y((h=C)["$any?"]())&&c.$print(oe(c,"format",V(h))),Y},-1),v(z,"$proc",function g(){var b=g.$$p||Y;return delete g.$$p,y(b)||D.$raise(a("ArgumentError"),"tried to create Proc object without a block"),b.$$is_lambda=!1,b},0),v(z,"$puts",function(b){var C;return null==_.stdout&&(_.stdout=Y),C=E.slice.call(arguments),oe(_.stdout,"puts",V(C))},-1),v(z,"$p",function(b){var C,h;return C=E.slice.call(arguments),oe(h=C,"each",[],function(l){return null==_.stdout&&(_.stdout=Y),null==l&&(l=Y),_.stdout.$puts(l.$inspect())},1),y(se(h.$length(),1))?h["$[]"](0):h},-1),v(z,"$print",function(b){var C;return null==_.stdout&&(_.stdout=Y),C=E.slice.call(arguments),oe(_.stdout,"print",V(C))},-1),v(z,"$readline",function(b){var C;return null==_.stdin&&(_.stdin=Y),C=E.slice.call(arguments),oe(_.stdin,"readline",V(C))},-1),v(z,"$warn",function(b,C){var h,c,l,f,m,x,S=this,Z=Y;if(null==_.VERBOSE&&(_.VERBOSE=Y),null==_.stderr&&(_.stderr=Y),h=E.slice.call(arguments),null==(c=E.extract_kwargs(h)))c=F([],{});else if(!c.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return l=h,null==(f=c.$$smap.uplevel)&&(f=Y),y(f)&&(f=u["$coerce_to!"](f,a("Integer"),"to_str"),y(ue(f,0))&&D.$raise(a("ArgumentError"),"negative level ("+f+")"),x=(m=S.$caller(L(f,1),1).$first())===Y||null==m?Y:oe(m,"split",[":in `"]),Z=x===Y||null==x?Y:oe(x,"first",[]),y(Z)&&(Z+=": "),l=oe(l,"map",[],function(ye){return null==ye&&(ye=Y),Z+"warning: "+ye},1)),y(_.VERBOSE["$nil?"]())||y(l["$empty?"]())?Y:oe(_.stderr,"puts",V(l))},-1),v(z,"$raise",function(b,C,h){throw null==_["!"]&&(_["!"]=Y),null==_["@"]&&(_["@"]=Y),null==C&&(C=Y),null==h&&(h=Y),null==b&&_["!"]!==Y?_["!"]:(null==b?b=a("RuntimeError").$new(""):p(b,"$to_str")?b=a("RuntimeError").$new(b.$to_str()):b.$$is_class&&p(b,"$exception")?b=b.$exception(C):b.$$is_exception||(b=a("TypeError").$new("exception class/object expected")),h!==Y&&b.$set_backtrace(h),_["!"]!==Y&&E.exceptions.push(_["!"]),_["!"]=b,_["@"]=b.$backtrace(),b)},-1),v(z,"$rand",function(b){return void 0===b?a(a("Random"),"DEFAULT").$rand():(b.$$is_number&&(b<0&&(b=Math.abs(b)),b%1!=0&&(b=b.$to_i()),0===b&&(b=void 0)),a(a("Random"),"DEFAULT").$rand(b))},-1),v(z,"$respond_to?",function(b,C){var h=this;null==C&&(C=!1);var c=h["$"+b];return"function"==typeof c&&!c.$$stub||!0!==h["$respond_to_missing?"].$$pristine&&h["$respond_to_missing?"](b,C)},-2),v(z,"$respond_to_missing?",function(b,C){return null==C&&(C=!1),!1},-2),u.$pristine(z,"respond_to?","respond_to_missing?"),v(z,"$require",function(b){return"string"!=typeof b&&E.String&&E.Array&&(b=u["$coerce_to!"](b,a("String"),"to_str")),E.require(b)},1),v(z,"$require_relative",function(b){return u["$try_convert!"](b,a("String"),"to_str"),b=a("File").$expand_path(a("File").$join(E.current_file,"..",b)),E.require(b)},1),v(z,"$require_tree",function(b,C){var h;if(null==C)C=F([],{});else if(!C.$$is_hash)throw E.ArgumentError.$new("expected kwargs");null==(h=C.$$smap.autoload)&&(h=!1);var c=[];for(var l in b=a("File").$expand_path(b),"."===(b=E.normalize(b))&&(b=""),E.modules)l["$start_with?"](b)&&c.push(h?[l,!0]:[l,E.require(l)]);return c},-2),v(z,"$singleton_class",function(){return E.get_singleton_class(this)},0),v(z,"$sleep",function(b){null==b&&(b=Y),b===Y&&D.$raise(a("TypeError"),"can't convert NilClass into time interval"),b.$$is_number||D.$raise(a("TypeError"),"can't convert "+b.$class()+" into time interval"),b<0&&D.$raise(a("ArgumentError"),"time interval must be positive");for(var C=E.global.performance?function(){return performance.now()}:function(){return new Date},h=C();C()-h<=1e3*b;);return Math.round(b)},-1),v(z,"$srand",function(b){return null==b&&(b=N("Random").$new_seed()),a("Random").$srand(b)},-1),v(z,"$String",function(b){var C;return y(C=u["$coerce_to?"](b,a("String"),"to_str"))?C:u["$coerce_to!"](b,a("String"),"to_s")},1),v(z,"$tap",function g(){var b=g.$$p||Y;return delete g.$$p,E.yield1(b,this),this},0),v(z,"$to_proc",function(){return this},0),v(z,"$to_s",function(){return"#<"+this.$class()+":0x"+this.$__id__().$to_s(16)+">"},0),v(z,"$catch",function g(b){var C=g.$$p||Y,h=Y,c=Y;delete g.$$p,null==b&&(b=Y);try{return b=y(h=b)?h:J.$new(),E.yield1(C,b)}catch(l){if(!E.rescue(l,[a("UncaughtThrowError")]))throw l;c=l;try{return H(c.$tag(),b)?c.$value():D.$raise()}finally{E.pop_exception()}}},-1),v(z,"$throw",function(b,C){return null==C&&(C=Y),D.$raise(a("UncaughtThrowError").$new(b,C))},-2),v(z,"$open",function g(b){var c,C=g.$$p||Y;return delete g.$$p,c=E.slice.call(arguments),oe(a("File"),"open",V(c),C.$to_proc())},-1),v(z,"$yield_self",function g(){var b=g.$$p||Y;return delete g.$$p,b===Y?oe(this,"enum_for",["yield_self"],function(){return 1},0):E.yield1(b,this)},0),K(z,"fail","raise"),K(z,"kind_of?","is_a?"),K(z,"object_id","__id__"),K(z,"public_send","__send__"),K(z,"send","__send__"),K(z,"then","yield_self"),K(z,"to_enum","enum_for")}(),z=ee("::",null,"Object"),delete J.$$prototype.$require,z.$include(D)},Opal.modules["corelib/main"]=function(E){var u,y=E.def,w=E.Object,p=E.Kernel;return y(u=E.get_singleton_class(E.top),"$to_s",function(){return"main"},0),y(u,"$include",function(D){return w.$include(D)},1),y(u,"$autoload",function(D){var _;return _=E.slice.call(arguments),E.Object.$autoload.apply(E.Object,_)},-1),y(u,"$using",function(D){return p.$raise("main.using is permitted only at toplevel")},1)},Opal.modules["corelib/error/errno"]=function(E){var F,oe,V,ae=[],Y=E.nil,a=E.$$$,y=E.module,w=E.truthy,p=E.rb_plus,u=E.send2,k=E.find_super,v=E.def,D=E.klass;return function(_,F){var L,U,oe=y("::","Errno"),H=([oe].concat(F),Y);for(L=[["EINVAL","Invalid argument",22],["EEXIST","File exists",17],["EISDIR","Is a directory",21],["EMFILE","Too many open files",24],["EACCES","Permission denied",13],["EPERM","Operation not permitted",1],["ENOENT","No such file or directory",2]],H=Y,U=0;U<L.length;U++)!function(){var K,ue=L[U][1],J=L[U][2];(H=E.klass(oe,E.SystemCallError,L[U][0])).errno=J,K=E.get_singleton_class(H),v(K,"$new",function M(G){var N=Y;return delete M.$$p,null==G&&(G=Y),N=ue,w(G)&&(N=p(N," - "+G)),u(this,k(this,"new",M,!1,!0),"new",[N],null)},-1)}()}(0,ae),F=a("StandardError"),oe=ae,[V=D("::",F,"SystemCallError")].concat(oe),v(V,"$errno",function(){return this.$class().$errno()},0),E.get_singleton_class(V).$attr_reader("errno")},Opal.modules["corelib/error"]=function(E){var K,ee,ae=[],Y=E.nil,a=E.$$$,y=E.klass,w=E.gvars,p=E.defs,u=E.send,k=E.to_a,v=E.def,D=E.truthy,_=E.hash2,F=E.Kernel,oe=E.not,V=E.rb_plus,L=E.eqeq,H=E.Object,U=E.send2,se=E.find_super,ue=E.module;return function(J,K,ee){var N,M=y("::",K,"Exception"),G=[M].concat(ee),z=E.$r(G);function P(g){for(var C,b=[],h=0;h<g.length;h++){var c=g[h];!c||!c.$$is_string||((C=c.match(/^    at (.*?) \((.*?)\)$/))?b.push(C[2]+":in `"+C[1]+"'"):(C=c.match(/^    at (.*?)$/))?b.push(C[1]+":in `undefined'"):(C=c.match(/^  from (.*?)$/))?b.push(C[1]):(C=c.match(/^(.*?)@(.*?)$/))&&b.push(C[2]+":in `"+C[1]+"'"))}return b}M.$$prototype.message=Y,E.prop(M.$$prototype,"$$is_exception",!0),p(M,"$new",function(b){var h,c=this;null==w["!"]&&(w["!"]=Y);var l=(h=E.slice.call(arguments)).length>0?h[0]:Y,f=new c.$$constructor(l);return f.name=c.$$name,f.message=l,f.cause=w["!"],E.send(f,f.$initialize,h),E.config.enable_stack_trace&&Error.captureStackTrace&&Error.captureStackTrace(f,N),f},-1),N=M.$new,p(M,"$exception",function(b){var C,c=this;return C=E.slice.call(arguments),u(c,"new",k(C))},-1),v(M,"$initialize",function(b){var C,h,c=this;return C=E.slice.call(arguments),c.message=(h=C).length>0?h[0]:Y},-1),v(M,"$backtrace",function(){var b=this;if(b.backtrace)return b.backtrace;var C=b.stack;return void 0!==C&&C.$$is_string?b.backtrace=P(C.split("\n").slice(0,15)):C?b.backtrace=P(C.slice(0,15)):[]},0),v(M,"$backtrace_locations",function(){var b,C=this;return C.backtrace_locations||(C.backtrace_locations=(b=C.$backtrace())===Y||null==b?Y:u(b,"map",[],function(c){return null==c&&(c=Y),a(a(a("Thread"),"Backtrace"),"Location").$new(c)},1)),C.backtrace_locations},0),v(M,"$cause",function(){return this.cause||Y},0),v(M,"$exception",function(b){var C=this;if(null==b&&(b=Y),b===Y||C===b)return C;var h=C.$clone();return h.message=b,C.backtrace&&(h.backtrace=C.backtrace.$dup()),h.stack=C.stack,h.cause=C.cause,h},-1),v(M,"$message",function(){return this.$to_s()},0),v(M,"$full_message",function(b){var h,c=this,l=Y,f=Y,m=Y,x=Y,S=Y,Z=Y,le=Y,ye=Y,T=Y;return null==w.stderr&&(w.stderr=Y),null==b&&(b=Y),D(z("Hash","skip_raise")?"constant":Y)?(m=(h=[(b=_(["highlight","order"],{highlight:w.stderr["$tty?"](),order:"top"}).$merge(D(l=b)?l:_([],{})))["$[]"]("highlight"),b["$[]"]("order")])[1],D([!0,!1]["$include?"](f=h[0]))||F.$raise(a("ArgumentError"),"expected true or false as highlight: "+f),D(["top","bottom"]["$include?"](m))||F.$raise(a("ArgumentError"),"expected :top or :bottom as order: "+m),D(f)?(x="\x1b[1;4m",S="\x1b[1m",Z="\x1b[m"):x=S=Z="",le=c.$backtrace().$dup(),(oe(le)||D(le["$empty?"]()))&&(le=c.$caller()),ye=le.$shift(),T=V(T=ye+": ",""+S+c.$to_s()+" ("+x+c.$class()+Z+S+")"+Z+"\n"),T=V(T,u(le,"map",[],function(ie){return null==ie&&(ie=Y),"\tfrom "+ie+"\n"},1).$join()),D(c.$cause())&&(T=V(T,c.$cause().$full_message(_(["highlight"],{highlight:f})))),L(m,"bottom")&&(T=T.$split("\n").$reverse().$join("\n"),T=V(S+"Traceback"+Z+" (most recent call last):\n",T)),T):c.message+"\n"+c.stack},-1),v(M,"$inspect",function(){var b=this,C=Y;return C=b.$to_s(),D(C["$empty?"]())?b.$class().$to_s():"#<"+b.$class().$to_s()+": "+b.$to_s()+">"},0),v(M,"$set_backtrace",function(b){var c,l,C=this,h=!0;if(b===Y)C.backtrace=Y,C.stack="";else if(b.$$is_string)C.backtrace=[b],C.stack="  from "+b;else{if(b.$$is_array){for(c=0,l=b.length;c<l;c++)if(!b[c].$$is_string){h=!1;break}}else h=!1;!1===h&&F.$raise(a("TypeError"),"backtrace must be Array of String"),C.backtrace=b,C.stack=u(b,"map",[],function(m){return null==m&&(m=Y),V("  from ",m)},1).join("\n")}return b},1),v(M,"$to_s",function(){var C,h,b=this;return D(C=D(h=b.message)?b.message.$to_s():h)?C:b.$class().$to_s()},0)}(0,Error,ae),y("::",a("Exception"),"ScriptError"),y("::",a("ScriptError"),"SyntaxError"),y("::",a("ScriptError"),"LoadError"),y("::",a("ScriptError"),"NotImplementedError"),y("::",a("Exception"),"SystemExit"),y("::",a("Exception"),"NoMemoryError"),y("::",a("Exception"),"SignalException"),y("::",a("SignalException"),"Interrupt"),y("::",a("Exception"),"SecurityError"),y("::",a("Exception"),"SystemStackError"),y("::",a("Exception"),"StandardError"),y("::",a("StandardError"),"EncodingError"),y("::",a("StandardError"),"ZeroDivisionError"),y("::",a("StandardError"),"NameError"),y("::",a("NameError"),"NoMethodError"),y("::",a("StandardError"),"RuntimeError"),y("::",a("RuntimeError"),"FrozenError"),y("::",a("StandardError"),"LocalJumpError"),y("::",a("StandardError"),"TypeError"),y("::",a("StandardError"),"ArgumentError"),y("::",a("ArgumentError"),"UncaughtThrowError"),y("::",a("StandardError"),"IndexError"),y("::",a("IndexError"),"StopIteration"),y("::",a("StopIteration"),"ClosedQueueError"),y("::",a("IndexError"),"KeyError"),y("::",a("StandardError"),"RangeError"),y("::",a("RangeError"),"FloatDomainError"),y("::",a("StandardError"),"IOError"),y("::",a("IOError"),"EOFError"),y("::",a("StandardError"),"SystemCallError"),y("::",a("StandardError"),"RegexpError"),y("::",a("StandardError"),"ThreadError"),y("::",a("StandardError"),"FiberError"),H.$autoload("Errno","corelib/error/errno"),K=a("ArgumentError"),(ee=y("::",K,"UncaughtThrowError")).$$prototype.tag=Y,ee.$attr_reader("tag","value"),v(ee,"$initialize",function G(z,A){var P=this;return delete G.$$p,null==A&&(A=Y),P.tag=z,P.value=A,U(P,se(P,"initialize",G,!1,!0),"initialize",["uncaught throw "+P.tag.$inspect()],null)},-2),function(J,K){var ee=y("::",null,"NameError");ee.$attr_reader("name"),v(ee,"$initialize",function M(G,z){var N=this;return delete M.$$p,null==z&&(z=Y),U(N,se(N,"initialize",M,!1,!0),"initialize",[G],null),N.name=z},-2)}(),function(J,K){var ee=y("::",null,"NoMethodError");ee.$attr_reader("args"),v(ee,"$initialize",function M(G,z,A){var P=this;return delete M.$$p,null==z&&(z=Y),null==A&&(A=[]),U(P,se(P,"initialize",M,!1,!0),"initialize",[G,z],null),P.args=A},-2)}(),y("::",null,"StopIteration").$attr_reader("result"),function(J,K){var ee=y("::",null,"KeyError"),M=ee.$$prototype;M.receiver=M.key=Y,v(ee,"$initialize",function G(z,A){var N,P,b=this;if(delete G.$$p,null==A)A=_([],{});else if(!A.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return null==(N=A.$$smap.receiver)&&(N=Y),null==(P=A.$$smap.key)&&(P=Y),U(b,se(b,"initialize",G,!1,!0),"initialize",[z],null),b.receiver=N,b.key=P},-2),v(ee,"$receiver",function(){var A;return D(A=this.receiver)?A:F.$raise(a("ArgumentError"),"no receiver is available")},0),v(ee,"$key",function(){var A;return D(A=this.key)?A:F.$raise(a("ArgumentError"),"no key is available")},0)}(),function(J,K){var M=[ue("::","JS")].concat(K);return y(M[0],null,"Error"),Y}(0,ae)},Opal.modules["corelib/constants"]=function(E){var Y=E.$$$,a=E.const_set;return a("::","RUBY_PLATFORM","opal"),a("::","RUBY_ENGINE","opal"),a("::","RUBY_VERSION","3.1.0"),a("::","RUBY_ENGINE_VERSION","1.4.1"),a("::","RUBY_RELEASE_DATE","2022-01-12"),a("::","RUBY_PATCHLEVEL",0),a("::","RUBY_REVISION","0"),a("::","RUBY_COPYRIGHT","opal - Copyright (C) 2013-2021 Adam Beynon and the Opal contributors"),a("::","RUBY_DESCRIPTION","opal "+Y("RUBY_ENGINE_VERSION")+" ("+Y("RUBY_RELEASE_DATE")+" revision "+Y("RUBY_REVISION")+")")},Opal.modules["opal/base"]=function(E){var Y=E.Object;return Y.$require("corelib/runtime"),Y.$require("corelib/helpers"),Y.$require("corelib/module"),Y.$require("corelib/class"),Y.$require("corelib/basic_object"),Y.$require("corelib/kernel"),Y.$require("corelib/main"),Y.$require("corelib/error"),Y.$require("corelib/constants")},Opal.modules["corelib/nil"]=function(E){var U,L,Y=E.nil,a=E.$$$,w=E.Kernel,p=E.def,u=E.hash2,k=E.NilClass,v=E.truthy,D=E.rb_gt,_=E.alias;return[L=(0,E.klass)("::",null,"NilClass")].concat([]),L.$$prototype.$$meta=L,U=E.get_singleton_class(L),p(U,"$allocate",function(){return w.$raise(a("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(U,"$new"),p(L,"$!",function(){return!0},0),p(L,"$&",function(se){return!1},1),p(L,"$|",function(se){return!1!==se&&se!==Y},1),p(L,"$^",function(se){return!1!==se&&se!==Y},1),p(L,"$==",function(se){return se===Y},1),p(L,"$dup",function(){return Y},0),p(L,"$clone",function(se){if(null==se)se=u([],{});else if(!se.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return Y},-1),p(L,"$inspect",function(){return"nil"},0),p(L,"$nil?",function(){return!0},0),p(L,"$singleton_class",function(){return k},0),p(L,"$to_a",function(){return[]},0),p(L,"$to_h",function(){return E.hash()},0),p(L,"$to_i",function(){return 0},0),p(L,"$to_s",function(){return""},0),p(L,"$to_c",function(){return a("Complex").$new(0,0)},0),p(L,"$rationalize",function(se){var ue;return ue=E.slice.call(arguments),v(D(ue.$length(),1))&&w.$raise(a("ArgumentError")),w.$Rational(0,1)},-1),p(L,"$to_r",function(){return w.$Rational(0,1)},0),p(L,"$instance_variables",function(){return[]},0),_(L,"to_f","to_i")},Opal.modules["corelib/boolean"]=function(E){"use strict";var Y=E.nil,a=E.$$$,y=E.klass,w=E.Kernel,p=E.def,u=E.hash2,k=E.truthy,v=E.send2,D=E.find_super,_=E.to_a,F=E.alias;return function(oe,V,L){var J,H=y("::",V,"Boolean");[H].concat([]),E.prop(H.$$prototype,"$$is_boolean",!0);for(var se=["$$class","$$meta"],ue=0;ue<se.length;ue++)Object.defineProperty(H.$$prototype,se[ue],{configurable:!0,enumerable:!1,get:function(){return 1==this?E.TrueClass:0==this?E.FalseClass:E.Boolean}});Object.defineProperty(H.$$prototype,"$$id",{configurable:!0,enumerable:!1,get:function(){return 1==this?2:0==this?0:Y}}),J=E.get_singleton_class(H),p(J,"$allocate",function(){return w.$raise(a("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(J,"$new"),p(H,"$__id__",function(){return this.valueOf()?2:0},0),p(H,"$!",function(){return 1!=this},0),p(H,"$&",function(K){return 1==this&&!1!==K&&K!==Y},1),p(H,"$|",function(K){return 1==this||!1!==K&&K!==Y},1),p(H,"$^",function(K){return 1==this?!1===K||K===Y:!1!==K&&K!==Y},1),p(H,"$==",function(K){return 1==this===K.valueOf()},1),p(H,"$singleton_class",function(){return this.$$meta},0),p(H,"$to_s",function(){return 1==this?"true":"false"},0),p(H,"$dup",function(){return this},0),p(H,"$clone",function(K){if(null==K)K=u([],{});else if(!K.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return this},-1),p(H,"$method_missing",function J(K,ee){var z,M=J.$$p||Y,A=this;delete J.$$p,z=E.slice.call(arguments,1);var N=A.$$class.$$prototype["$"+K];return k(void 0!==N&&!N.$$stub)||v(A,D(A,"method_missing",J,!1,!0),"method_missing",[K].concat(_(z)),M),E.send(A,N,z,M)},-2),p(H,"$respond_to_missing?",function(K,ee){null==ee&&(ee=!1);var G=this.$$class.$$prototype["$"+K];return void 0!==G&&!G.$$stub},-2),F(H,"eql?","=="),F(H,"equal?","=="),F(H,"inspect","to_s"),F(H,"object_id","__id__")}(0,Boolean),y("::",a("Boolean"),"TrueClass"),y("::",a("Boolean"),"FalseClass"),Y},Opal.modules["corelib/comparable"]=function(E){var ae=E.nil,Y=E.$$$,a=E.truthy,y=E.module,w=E.rb_gt,p=E.rb_lt,u=E.eqeqeq,k=E.Kernel,v=E.def;return function(D){var _=y("::","Comparable"),F=ae;function oe(H){return E.is_a(H,E.Integer)?H:w(H,0)?1:p(H,0)?-1:0}function L(H,U){var se=H["$<=>"](U);return a(se)||function V(H,U){var se;se=u(ae,F=U)||u(!0,F)||u(!1,F)||u(Y("Integer"),F)||u(Y("Float"),F)?U.$inspect():U.$$class,k.$raise(Y("ArgumentError"),"comparison of "+H.$class()+" with "+se+" failed")}(H,U),oe(se)}return v(_,"$==",function(U){var se=this,ue=ae;return!!a(se["$equal?"](U))||se["$<=>"]!=E.Kernel["$<=>"]&&(se.$$comparable?(delete se.$$comparable,!1):!!a(ue=se["$<=>"](U))&&0==oe(ue))},1),v(_,"$>",function(U){return L(this,U)>0},1),v(_,"$>=",function(U){return L(this,U)>=0},1),v(_,"$<",function(U){return L(this,U)<0},1),v(_,"$<=",function(U){return L(this,U)<=0},1),v(_,"$between?",function(U,se){return!(p(this,U)||w(this,se))},2),v(_,"$clamp",function(U,se){var J,K;if(null==se&&(se=ae),se===ae&&(E.is_a(U,E.Range)||k.$raise(Y("TypeError"),"wrong argument type "+U.$class()+" (expected Range)"),K=U.excl,se=U.end,U=U.begin,se!==ae&&K&&k.$raise(Y("ArgumentError"),"cannot clamp with an exclusive range")),U!==ae&&se!==ae&&L(U,se)>0&&k.$raise(Y("ArgumentError"),"min argument must be smaller than max argument"),U!==ae){if(0==(J=L(this,U)))return this;if(J<0)return U}return se!==ae&&(J=L(this,se))>0?se:this},-2)}()},Opal.modules["corelib/regexp"]=function(E){var M,G,P,b,C,z,A,N,ae=[],Y=E.nil,a=E.$$$,y=E.coerce_to,w=E.klass,p=E.const_set,u=E.send2,k=E.find_super,v=E.def,D=E.truthy,_=E.gvars,F=E.Kernel,oe=E.Opal,V=E.alias,L=E.send,H=E.hash2,U=E.rb_plus,se=E.rb_ge,ue=E.to_a,J=E.eqeqeq,K=E.rb_minus;return w("::",a("StandardError"),"RegexpError"),M=RegExp,G=ae,A=[z=w("::",M,"Regexp")].concat(G),N=E.$r(A),p(z,"IGNORECASE",1),p(z,"EXTENDED",2),p(z,"MULTILINE",4),E.prop(z.$$prototype,"$$is_regexp",!0),b=[P=E.get_singleton_class(z)].concat(A),C=E.$r(b),v(P,"$allocate",function h(){var c=h.$$p||Y,f=Y;return delete h.$$p,(f=u(this,k(this,"allocate",h,!1,!0),"allocate",[],c)).uninitialized=!0,f},0),v(P,"$escape",function(c){return E.escape_regexp(c)},1),v(P,"$last_match",function(c){return null==_["~"]&&(_["~"]=Y),null==c&&(c=Y),D(c["$nil?"]())?_["~"]:D(_["~"])?_["~"]["$[]"](c):Y},-1),v(P,"$union",function(c){var f,x,S,Z,le,ye,m=this;if(0==(f=E.slice.call(arguments)).length)return/(?!)/;if(1==f.length&&f[0].$$is_regexp)return f[0];x=f[0].$$is_array,f.length>1&&x&&F.$raise(a("TypeError"),"no implicit conversion of Array into String"),x&&(f=f[0]),le=void 0,S=[];for(var T=0;T<f.length;T++)(Z=f[T]).$$is_string?S.push(m.$escape(Z)):Z.$$is_regexp?(ye=Z.$options(),null!=le&&le!=ye&&F.$raise(a("TypeError"),"All expressions must use the same options"),le=ye,S.push("("+Z.source+")")):S.push(m.$escape(Z.$to_str()));return m.$new(S.$join("|"),le)},-1),v(P,"$new",function(c,l){if(c.$$is_regexp)return new RegExp(c);if("\\"===(c=oe["$coerce_to!"](c,a("String"),"to_str")).charAt(c.length-1)&&"\\"!==c.charAt(c.length-2)&&F.$raise(a("RegexpError"),"too short escape sequence: /"+c+"/"),void 0===l||l["$!"]())return new RegExp(c);if(l.$$is_number){var f="";C("IGNORECASE")&l&&(f+="i"),C("MULTILINE")&l&&(f+="m"),l=f}else l="i";return new RegExp(c,l)},-2),V(P,"compile","new"),V(P,"quote","escape"),v(z,"$==",function(g){return g instanceof RegExp&&this.toString()===g.toString()},1),v(z,"$===",function(g){return this.$match(oe["$coerce_to?"](g,a("String"),"to_str"))!==Y},1),v(z,"$=~",function(g){var C;return null==_["~"]&&(_["~"]=Y),D(C=this.$match(g))?_["~"].$begin(0):C},1),v(z,"$inspect",function(){var C=this.toString(),h=/^\/(.*)\/([^\/]*)$/.exec(C);if(h){for(var l=h[2],f=h[1].split(""),m=f.length,x=!1,S="",Z=0;Z<m;Z++){var le=f[Z];!x&&"/"==le&&(S=S.concat("\\")),S=S.concat(le),x="\\"==le&&!x}return"/"+S+"/"+l}return C},0),v(z,"$match",function P(g,b){var C=P.$$p||Y,h=this;if(null==_["~"]&&(_["~"]=Y),delete P.$$p,h.uninitialized&&F.$raise(a("TypeError"),"uninitialized Regexp"),void 0===b){if(g===Y)return _["~"]=Y;var c=h.exec(y(g,a("String"),"to_str"));return c?(_["~"]=a("MatchData").$new(h,c),C===Y?_["~"]:E.yield1(C,_["~"])):_["~"]=Y}if(b=y(b,a("Integer"),"to_int"),g===Y||(g=y(g,a("String"),"to_str"),b<0&&(b+=g.length)<0))return _["~"]=Y;for(var l,f=E.global_regexp(h);;){if(null===(l=f.exec(g)))return _["~"]=Y;if(l.index>=b)return _["~"]=a("MatchData").$new(f,l),C===Y?_["~"]:E.yield1(C,_["~"]);f.lastIndex=l.index+1}},-2),v(z,"$match?",function(g,b){var h,C=this;return C.uninitialized&&F.$raise(a("TypeError"),"uninitialized Regexp"),void 0===b?g!==Y&&C.test(y(g,a("String"),"to_str")):(b=y(b,a("Integer"),"to_int"),!(g===Y||(g=y(g,a("String"),"to_str"),b<0&&(b+=g.length)<0)||null===(h=E.global_regexp(C).exec(g))||h.index<b))},-2),v(z,"$names",function(){return L(this.$source().$scan(/\(?<(\w+)>/,H(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$uniq()},0),v(z,"$named_captures",function(){return L(L(L(this.$source().$scan(/\(?<(\w+)>/,H(["no_matchdata"],{no_matchdata:!0})),"map",[],"first".$to_proc()).$each_with_index(),"group_by",[],"first".$to_proc()),"transform_values",[],function(C){return null==C&&(C=Y),L(C,"map",[],function(c){return null==c&&(c=Y),U(c.$last(),1)},1)},1)},0),v(z,"$~",function(){return null==_._&&(_._=Y),this["$=~"](_._)},0),v(z,"$source",function(){return this.source},0),v(z,"$options",function(){var g=this;g.uninitialized&&F.$raise(a("TypeError"),"uninitialized Regexp");var b=0;return g.multiline&&(b|=N("MULTILINE")),g.ignoreCase&&(b|=N("IGNORECASE")),b},0),v(z,"$casefold?",function(){return this.ignoreCase},0),V(z,"eql?","=="),V(z,"to_s","source"),function(ee,M,G){var z=w(ee,null,"MatchData"),A=[z].concat(G),N=E.$r(A);return z.$$prototype.matches=Y,z.$attr_reader("post_match","pre_match","regexp","string"),v(z,"$initialize",function(b,C,h){var c,l=this;if(null==h)h=H([],{});else if(!h.$$is_hash)throw E.ArgumentError.$new("expected kwargs");null==(c=h.$$smap.no_matchdata)&&(c=!1),D(c)||(_["~"]=l),l.regexp=b,l.begin=C.index,l.string=C.input,l.pre_match=C.input.slice(0,C.index),l.post_match=C.input.slice(C.index+C[0].length),l.matches=[];for(var f=0,m=C.length;f<m;f++){var x=C[f];l.matches.push(null==x?Y:x)}},-3),v(z,"$match",function(b){var h;return D(h=this["$[]"](b))?h:D(b["$is_a?"](N("Integer")))&&D(se(b,this.$length()))?F.$raise(a("IndexError"),"index "+b+" out of matches"):Y},1),v(z,"$match_length",function(b){var C;return(C=this.$match(b))===Y||null==C?Y:L(C,"length",[])},1),v(z,"$[]",function(b){var h,c=this;return(h=E.slice.call(arguments))[0].$$is_string?(c.$regexp().$names()["$include?"](h["$[]"](0))["$!"]()&&F.$raise(a("IndexError"),"undefined group name reference: "+h["$[]"](0)),c.$named_captures()["$[]"](h["$[]"](0))):L(c.matches,"[]",ue(h))},-1),v(z,"$offset",function(b){var C=this;return 0!==b&&F.$raise(a("ArgumentError"),"MatchData#offset only supports 0th element"),[C.begin,C.begin+C.matches[b].length]},1),v(z,"$==",function(b){var C=this,h=Y,c=Y,l=Y,f=Y;return!!J(a("MatchData"),b)&&(D(h=D(c=D(l=D(f=C.string==b.string)?C.regexp.toString()==b.regexp.toString():f)?C.pre_match==b.pre_match:l)?C.post_match==b.post_match:c)?C.begin==b.begin:h)},1),v(z,"$begin",function(b){return 0!==b&&F.$raise(a("ArgumentError"),"MatchData#begin only supports 0th element"),this.begin},1),v(z,"$end",function(b){return 0!==b&&F.$raise(a("ArgumentError"),"MatchData#end only supports 0th element"),this.begin+this.matches[b].length},1),v(z,"$captures",function(){return this.matches.slice(1)},0),v(z,"$named_captures",function(){var C=Y;return C=this.$captures(),L(this.$regexp().$named_captures(),"transform_values",[],function(c){return null==c&&(c=Y),C["$[]"](K(c.$last(),1))},1)},0),v(z,"$names",function(){return this.$regexp().$names()},0),v(z,"$inspect",function(){var b=this,C="#<MatchData "+b.matches[0].$inspect();if(b.$regexp().$names()["$empty?"]())for(var h=1,c=b.matches.length;h<c;h++)C+=" "+h+":"+b.matches[h].$inspect();else L(b.$named_captures(),"each",[],function(f,m){return null==f&&(f=Y),null==m&&(m=Y),C+=" "+f+":"+m.$inspect()},2);return C+">"},0),v(z,"$length",function(){return this.matches.length},0),v(z,"$to_a",function(){return this.matches},0),v(z,"$to_s",function(){return this.matches[0]},0),v(z,"$values_at",function(b){var h,c=this;h=E.slice.call(arguments);var l,f,m,x=[];for(l=0;l<h.length;l++)h[l].$$is_range&&((f=h[l].$to_a()).unshift(l,1),Array.prototype.splice.apply(h,f)),(m=oe["$coerce_to!"](h[l],a("Integer"),"to_int"))<0&&(m+=c.matches.length)<0?x.push(Y):x.push(c.matches[m]);return x},-1),V(z,"eql?","=="),V(z,"size","length")}(ae[0],0,ae)},Opal.modules["corelib/string"]=function(E){var ae=E.top,Y=[],a=E.$r(Y),y=E.nil,w=E.$$$,p=E.coerce_to,u=E.respond_to,k=E.global_multiline_regexp,v=E.klass,D=E.def,_=E.Opal,F=E.defs,oe=E.send,V=E.to_a,L=E.hash2,H=E.eqeqeq,U=E.Kernel,se=E.truthy,ue=E.gvars,J=E.rb_divide,K=E.rb_plus,ee=E.alias,M=E.const_set;return ae.$require("corelib/comparable"),ae.$require("corelib/regexp"),function(G,z,A){var N=v("::",String,"String"),P=[N].concat(A),g=E.$r(P);function b(C){function h(T){var ie,ve,de,we,ce,he,R="",j=T.length;for(ie=0;ie<j;ie++)if("-"===(ve=T.charAt(ie))&&ie>0&&ie<j-1&&!de){for((we=T.charCodeAt(ie-1))>(ce=T.charCodeAt(ie+1))&&U.$raise(w("ArgumentError"),'invalid range "'+we+"-"+ce+'" in string transliteration'),he=we+1;he<ce+1;he++)R+=String.fromCharCode(he);de=!0,ie++}else de="\\"===ve,R+=ve;return R}function c(T,R){if(0===T.length)return R;var j,de,ie="",ve=T.length;for(j=0;j<ve;j++)de=T.charAt(j),-1!==R.indexOf(de)&&(ie+=de);return ie}var l,f,m,x,S,Z,le="",ye="";for(l=0,f=C.length;l<f;l++)x="^"===(m=p(C[l],w("String"),"to_str")).charAt(0)&&m.length>1,m=h(x?m.slice(1):m),x?ye=c(ye,m):le=c(le,m);if(le.length>0&&ye.length>0){for(Z="",l=0,f=le.length;l<f;l++)S=le.charAt(l),-1===ye.indexOf(S)&&(Z+=S);le=Z,ye=""}return le.length>0?"["+w("Regexp").$escape(le)+"]":ye.length>0?"[^"+w("Regexp").$escape(ye)+"]":null}N.$include(w("Comparable")),E.prop(N.$$prototype,"$$is_string",!0),E.prop(N.$$prototype,"$$cast",function(C){var h=this.$$class;return h.$$constructor===String?C:new h.$$constructor(C)}),D(N,"$__id__",function(){return this.toString()},0),F(N,"$try_convert",function(h){return _["$coerce_to?"](h,w("String"),"to_str")},1),F(N,"$new",function(h){var l,f=this,m=(l=E.slice.call(arguments))[0]||"",x=l[l.length-1];return m=p(m,w("String"),"to_str"),x&&x.$$is_hash&&x.$$smap.encoding&&(m=m.$force_encoding(x.$$smap.encoding)),(m=new f.$$constructor(m)).$initialize.$$pristine||oe(m,"initialize",V(l)),m},-1),D(N,"$initialize",function(h,c){var l,f;if(l=E.slice.call(arguments),null==(f=E.extract_kwargs(l)))f=L([],{});else if(!f.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return l.length>0&&l.shift(),y},-1),D(N,"$%",function(h){var c=this;return H(w("Array"),h)?oe(c,"format",[c].concat(V(h))):c.$format(c,h)},1),D(N,"$*",function(h){var c=this;if((h=p(h,w("Integer"),"to_int"))<0&&U.$raise(w("ArgumentError"),"negative argument"),0===h)return c.$$cast("");var l="",f=c.toString();for(f.length*h>=1<<28&&U.$raise(w("RangeError"),"multiply count must not overflow maximum string size");1==(1&h)&&(l+=f),0!=(h>>>=1);)f+=f;return c.$$cast(l)},1),D(N,"$+",function(h){var c=this;if(""==(h=p(h,w("String"),"to_str"))&&c.$$class===E.String)return c;if(""==c&&h.$$class===E.String)return h;var l=c+h;return c.encoding===l.encoding&&h.encoding===l.encoding||"UTF-8"===c.encoding.name||"UTF-8"===h.encoding.name?l:E.enc(l,c.encoding)},1),D(N,"$<=>",function(h){var c=this;if(se(h["$respond_to?"]("to_str")))return c>(h=h.$to_str().$to_s())?1:c<h?-1:0;var l=h["$<=>"](c);return l===y?y:l>0?-1:l<0?1:0},1),D(N,"$==",function(h){return h.$$is_string?this.toString()===h.toString():!!u(h,"$to_str")&&h["$=="](this)},1),D(N,"$=~",function(h){return h.$$is_string&&U.$raise(w("TypeError"),"type mismatch: String given"),h["$=~"](this)},1),D(N,"$[]",function(h,c){var m,x,l=this,f=l.length;if(h.$$is_range)return m=h.excl,x=h,c=h.end===y?-1:p(h.end,w("Integer"),"to_int"),h=h.begin===y?0:p(h.begin,w("Integer"),"to_int"),Math.abs(h)>f?y:(h<0&&(h+=f),c<0&&(c+=f),(!m||x.end===y)&&(c+=1),(c-=h)<0&&(c=0),l.$$cast(l.substr(h,c)));if(h.$$is_string)return null!=c&&U.$raise(w("TypeError")),-1!==l.indexOf(h)?l.$$cast(h):y;if(h.$$is_regexp){var S=l.match(h);return null===S?(ue["~"]=y,y):(ue["~"]=w("MatchData").$new(h,S),null==c?l.$$cast(S[0]):(c=p(c,w("Integer"),"to_int"))<0&&-c<S.length?l.$$cast(S[c+=S.length]):c>=0&&c<S.length?l.$$cast(S[c]):y)}return(h=p(h,w("Integer"),"to_int"))<0&&(h+=f),null==c?h>=f||h<0?y:l.$$cast(l.substr(h,1)):(c=p(c,w("Integer"),"to_int"))<0||h>f||h<0?y:l.$$cast(l.substr(h,c))},-2),D(N,"$b",function(){return new String(this).$force_encoding("binary")},0),D(N,"$capitalize",function(){var h=this;return h.$$cast(h.charAt(0).toUpperCase()+h.substr(1).toLowerCase())},0),D(N,"$casecmp",function(h){var c=this;if(!se(h["$respond_to?"]("to_str")))return y;h=p(h,w("String"),"to_str").$to_s();var l=/^[\x00-\x7F]*$/;return l.test(c)&&l.test(h)&&(c=c.toLowerCase(),h=h.toLowerCase()),c["$<=>"](h)},1),D(N,"$casecmp?",function(h){var l=this.$casecmp(h);return l===y?y:0===l},1),D(N,"$center",function(h,c){var l=this;if(null==c&&(c=" "),h=p(h,w("Integer"),"to_int"),c=p(c,w("String"),"to_str").$to_s(),se(c["$empty?"]())&&U.$raise(w("ArgumentError"),"zero width padding"),se(h<=l.length))return l;var f=l.$ljust(J(K(h,l.length),2).$ceil(),c),m=l.$rjust(J(K(h,l.length),2).$floor(),c);return l.$$cast(m+f.slice(l.length))},-2),D(N,"$chomp",function(h){var l,c=this;return null==ue["/"]&&(ue["/"]=y),null==h&&(h=ue["/"]),se(h===y||0===c.length)?c:("\n"===(h=_["$coerce_to!"](h,w("String"),"to_str").$to_s())?l=c.replace(/\r?\n?$/,""):""===h?l=c.replace(/(\r?\n)+$/,""):c.length>=h.length&&c.substr(c.length-h.length,h.length)===h&&(l=c.substr(0,c.length-h.length)),null!=l?c.$$cast(l):c)},-1),D(N,"$chop",function(){var l,h=this,c=h.length;return l=c<=1?"":"\n"===h.charAt(c-1)&&"\r"===h.charAt(c-2)?h.substr(0,c-2):h.substr(0,c-1),h.$$cast(l)},0),D(N,"$chr",function(){return this.charAt(0)},0),D(N,"$clone",function(){var h=this,c=y;return(c=new String(h)).$copy_singleton_methods(h),c.$initialize_clone(h),c},0),D(N,"$dup",function(){var c=y;return(c=new String(this)).$initialize_dup(this),c},0),D(N,"$count",function(h){var l,f=this;0===(l=E.slice.call(arguments)).length&&U.$raise(w("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var m=b(l);return null===m?0:f.length-f.replace(new RegExp(m,"g"),"").length},-1),D(N,"$delete",function(h){var l,f=this;0===(l=E.slice.call(arguments)).length&&U.$raise(w("ArgumentError"),"ArgumentError: wrong number of arguments (0 for 1+)");var m=b(l);return null===m?f:f.$$cast(f.replace(new RegExp(m,"g"),""))},-1),D(N,"$delete_prefix",function(h){var c=this;return h.$$is_string||(h=p(h,w("String"),"to_str")),c.slice(0,h.length)===h?c.$$cast(c.slice(h.length)):c},1),D(N,"$delete_suffix",function(h){var c=this;return h.$$is_string||(h=p(h,w("String"),"to_str")),c.slice(c.length-h.length)===h?c.$$cast(c.slice(0,c.length-h.length)):c},1),D(N,"$downcase",function(){return this.$$cast(this.toLowerCase())},0),D(N,"$each_line",function C(h,c){var f,m,x,S,le,ye,T,R,ie,j,ve,de,l=C.$$p||y,Z=this;if(null==ue["/"]&&(ue["/"]=y),delete C.$$p,f=E.slice.call(arguments),null==(m=E.extract_kwargs(f)))m=L([],{});else if(!m.$$is_hash)throw E.ArgumentError.$new("expected kwargs");if(f.length>0&&(x=f.shift()),null==x&&(x=ue["/"]),null==(S=m.$$smap.chomp)&&(S=!1),l===y)return Z.$enum_for("each_line",x,L(["chomp"],{chomp:S}));if(x===y)return E.yield1(l,Z),Z;if(0===(x=p(x,w("String"),"to_str")).length){for(ye=0,T=(le=Z.split(/((?:\r?\n){2})(?:(?:\r?\n)*)/)).length;ye<T;ye+=2)(le[ye]||le[ye+1])&&(de=(le[ye]||"")+(le[ye+1]||""),S&&(de=de.$chomp("\n")),E.yield1(l,de));return Z}for(ie=Z.$chomp(x),j=Z.length!=ie.length,ye=0,R=(ve=ie.split(x)).length;ye<R;ye++)de=ve[ye],(ye<R-1||j)&&(de+=x),S&&(de=de.$chomp(x)),E.yield1(l,de);return Z},-1),D(N,"$empty?",function(){return 0===this.length},0),D(N,"$end_with?",function(h){for(var l,f=this,m=0,x=(l=E.slice.call(arguments)).length;m<x;m++){var S=p(l[m],w("String"),"to_str").$to_s();if(f.length>=S.length&&f.substr(f.length-S.length,S.length)==S)return!0}return!1},-1),D(N,"$gsub",function C(h,c){var l=C.$$p||y,f=this;if(delete C.$$p,void 0===c&&l===y)return f.$enum_for("gsub",h);var Z,le,ye,m="",x=y,S=0;for(h.$$is_regexp?h=k(h):(h=p(h,w("String"),"to_str"),h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));;){if(null===(Z=h.exec(f))){ue["~"]=y,m+=f.slice(S);break}x=w("MatchData").$new(h,Z),void 0===c?(ye=h.lastIndex,le=l(Z[0]),h.lastIndex=ye):c.$$is_hash?le=c["$[]"](Z[0]).$to_s():(c.$$is_string||(c=p(c,w("String"),"to_str")),le=c.replace(/([\\]+)([0-9+&`'])/g,function(T,R,ie){if(R.length%2==0)return T;switch(ie){case"+":for(var j=Z.length-1;j>0;j--)if(void 0!==Z[j])return R.slice(1)+Z[j];return"";case"&":return R.slice(1)+Z[0];case"`":return R.slice(1)+f.slice(0,Z.index);case"'":return R.slice(1)+f.slice(Z.index+Z[0].length);default:return R.slice(1)+(Z[ie]||"")}}).replace(/\\\\/g,"\\")),h.lastIndex===Z.index?(m+=f.slice(S,Z.index)+le+(f[Z.index]||""),h.lastIndex+=1):m+=f.slice(S,Z.index)+le,S=h.lastIndex}return ue["~"]=x,f.$$cast(m)},-2),D(N,"$hash",function(){return this.toString()},0),D(N,"$hex",function(){return this.$to_i(16)},0),D(N,"$include?",function(h){return h.$$is_string||(h=p(h,w("String"),"to_str")),-1!==this.indexOf(h)},1),D(N,"$index",function(h,c){var f,m,x,l=this;if(void 0===c)c=0;else if((c=p(c,w("Integer"),"to_int"))<0&&(c+=l.length)<0)return y;if(h.$$is_regexp)for(x=k(h);;){if(null===(m=x.exec(l))){ue["~"]=y,f=-1;break}if(m.index>=c){ue["~"]=w("MatchData").$new(x,m),f=m.index;break}x.lastIndex=m.index+1}else f=0===(h=p(h,w("String"),"to_str")).length&&c>l.length?-1:l.indexOf(h,c);return-1===f?y:f},-2),D(N,"$inspect",function(){var h=this,l={"\x07":"\\a","\x1b":"\\e","\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r","\v":"\\v",'"':'\\"',"\\":"\\\\"};return'"'+h.replace(/[\\\"\x00-\x1f\u007F-\u009F\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,function(m){return l[m]?l[m]:(m=m.charCodeAt(0))<=255&&(h.encoding["$binary?"]()||h.internal_encoding["$binary?"]())?"\\x"+("00"+m.toString(16).toUpperCase()).slice(-2):"\\u"+("0000"+m.toString(16).toUpperCase()).slice(-4)}).replace(/\#[\$\@\{]/g,"\\$&")+'"'},0),D(N,"$intern",function(){return this.toString()},0),D(N,"$lines",function C(h,c){var f,m,x,S,l=C.$$p||y,Z=this,le=y;if(null==ue["/"]&&(ue["/"]=y),delete C.$$p,f=E.slice.call(arguments),null==(m=E.extract_kwargs(f)))m=L([],{});else if(!m.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return f.length>0&&(x=f.shift()),null==x&&(x=ue["/"]),null==(S=m.$$smap.chomp)&&(S=!1),le=oe(Z,"each_line",[x,L(["chomp"],{chomp:S})],l.$to_proc()),se(l)?Z:le.$to_a()},-1),D(N,"$ljust",function(h,c){var l=this;if(null==c&&(c=" "),h=p(h,w("Integer"),"to_int"),c=p(c,w("String"),"to_str").$to_s(),se(c["$empty?"]())&&U.$raise(w("ArgumentError"),"zero width padding"),se(h<=l.length))return l;var f=-1,m="";for(h-=l.length;++f<h;)m+=c;return l.$$cast(l+m.slice(0,h))},-2),D(N,"$lstrip",function(){return this.replace(/^[\u0000\s]*/,"")},0),D(N,"$ascii_only?",function(){return!!this.encoding.ascii&&/^[\x00-\x7F]*$/.test(this)},0),D(N,"$match",function C(h,c){var l=C.$$p||y;return delete C.$$p,(H(g("String"),h)||se(h["$respond_to?"]("to_str")))&&(h=w("Regexp").$new(h.$to_str())),H(w("Regexp"),h)||U.$raise(w("TypeError"),"wrong argument type "+h.$class()+" (expected Regexp)"),oe(h,"match",[this,c],l.$to_proc())},-2),D(N,"$match?",function(h,c){return(H(g("String"),h)||se(h["$respond_to?"]("to_str")))&&(h=w("Regexp").$new(h.$to_str())),H(w("Regexp"),h)||U.$raise(w("TypeError"),"wrong argument type "+h.$class()+" (expected Regexp)"),h["$match?"](this,c)},-2),D(N,"$next",function(){var h=this,c=h.length;if(0===c)return h.$$cast("");for(var x,l=h,f=h.search(/[a-zA-Z0-9]/),m=!1;c--;){if((x=h.charCodeAt(c))>=48&&x<=57||x>=65&&x<=90||x>=97&&x<=122)switch(x){case 57:m=!0,x=48;break;case 90:m=!0,x=65;break;case 122:m=!0,x=97;break;default:m=!1,x+=1}else-1===f?255===x?(m=!0,x=0):(m=!1,x+=1):m=!0;if(l=l.slice(0,c)+String.fromCharCode(x)+l.slice(c+1),m&&(0===c||c===f)){switch(x){case 65:case 97:break;default:x+=1}l=0===c?String.fromCharCode(x)+l:l.slice(0,c)+String.fromCharCode(x)+l.slice(c),m=!1}if(!m)break}return h.$$cast(l)},0),D(N,"$oct",function(){var c,l=this,f=8;return/^\s*_/.test(l)?0:(l=l.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/i,function(m,x,S,Z){switch(Z.charAt(0)){case"+":case"-":return m;case"0":if("x"===Z.charAt(1)&&"0x"===S)return m}switch(S){case"0b":f=2;break;case"0":case"0o":f=8;break;case"0d":f=10;break;case"0x":f=16}return x+Z}),c=parseInt(l.replace(/_(?!_)/g,""),f),isNaN(c)?0:c)},0),D(N,"$ord",function(){var h=this;return"function"==typeof h.codePointAt?h.codePointAt(0):h.charCodeAt(0)},0),D(N,"$partition",function(h){var l,f,c=this;return h.$$is_regexp?null===(f=h.exec(c))?l=-1:(w("MatchData").$new(h,f),h=f[0],l=f.index):(h=p(h,w("String"),"to_str"),l=c.indexOf(h)),-1===l?[c,"",""]:[c.slice(0,l),c.slice(l,l+h.length),c.slice(l+h.length)]},1),D(N,"$reverse",function(){return this.split("").reverse().join("")},0),D(N,"$rindex",function(h,c){var f,m,x,S,l=this;if(void 0===c)c=l.length;else if((c=p(c,w("Integer"),"to_int"))<0&&(c+=l.length)<0)return y;if(h.$$is_regexp){for(m=null,x=k(h);!(null===(S=x.exec(l))||S.index>c);)x.lastIndex=(m=S).index+1;null===m?(ue["~"]=y,f=-1):(w("MatchData").$new(x,m),f=m.index)}else h=p(h,w("String"),"to_str"),f=l.lastIndexOf(h,c);return-1===f?y:f},-2),D(N,"$rjust",function(h,c){var l=this;if(null==c&&(c=" "),h=p(h,w("Integer"),"to_int"),c=p(c,w("String"),"to_str").$to_s(),se(c["$empty?"]())&&U.$raise(w("ArgumentError"),"zero width padding"),se(h<=l.length))return l;var f=Math.floor(h-l.length),m=Math.floor(f/c.length),x=Array(m+1).join(c);return l.$$cast(x+c.slice(0,f-x.length)+l)},-2),D(N,"$rpartition",function(h){var l,f,m,x,c=this;if(h.$$is_regexp){for(f=null,m=k(h);null!==(x=m.exec(c));)m.lastIndex=(f=x).index+1;null===f?l=-1:(w("MatchData").$new(m,f),h=f[0],l=f.index)}else h=p(h,w("String"),"to_str"),l=c.lastIndexOf(h);return-1===l?["","",c]:[c.slice(0,l),c.slice(l,l+h.length),c.slice(l+h.length)]},1),D(N,"$rstrip",function(){return this.replace(/[\s\u0000]*$/,"")},0),D(N,"$scan",function C(h,c){var f,l=C.$$p||y;if(delete C.$$p,null==c)c=L([],{});else if(!c.$$is_hash)throw E.ArgumentError.$new("expected kwargs");null==(f=c.$$smap.no_matchdata)&&(f=!1);var Z,x=[],S=y;for(h.$$is_regexp?h=k(h):(h=p(h,w("String"),"to_str"),h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"));null!=(Z=h.exec(this));)S=w("MatchData").$new(h,Z,L(["no_matchdata"],{no_matchdata:f})),l===y?x.push(1==Z.length?Z[0]:S.$captures()):E.yield1(l,1==Z.length?Z[0]:S.$captures()),h.lastIndex===Z.index&&(h.lastIndex+=1);return f||(ue["~"]=S),l!==y?this:x},-2),D(N,"$singleton_class",function(){return E.get_singleton_class(this)},0),D(N,"$split",function(h,c){var l=this,f=y;if(null==ue[";"]&&(ue[";"]=y),0===l.length)return[];if(void 0===c)c=0;else if(1===(c=_["$coerce_to!"](c,w("Integer"),"to_int")))return[l];(void 0===h||h===y)&&(h=se(f=ue[";"])?f:" ");var Z,le,ye,m=[],x=l.toString(),S=0;if(h.$$is_regexp?h=k(h):" "===(h=p(h,w("String"),"to_str").$to_s())?(h=/\s+/gm,x=x.replace(/^\s+/,"")):h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"gm"),1===(m=x.split(h)).length&&m[0]===x)return[l.$$cast(m[0])];for(;-1!==(le=m.indexOf(void 0));)m.splice(le,1);function T(){for(le=0;le<m.length;le++)m[le]=l.$$cast(m[le])}if(0===c){for(;""===m[m.length-1];)m.length-=1;return T(),m}if(Z=h.exec(x),c<0){if(null!==Z&&""===Z[0]&&-1===h.source.indexOf("(?="))for(le=0,ye=Z.length;le<ye;le++)m.push("");return T(),m}if(null!==Z&&""===Z[0])return m.splice(c-1,m.length-1,m.slice(c-1).join("")),T(),m;if(c>=m.length)return T(),m;for(le=0;null!==Z&&(le++,S=h.lastIndex,le+1!==c);)Z=h.exec(x);return m.splice(c-1,m.length-1,x.slice(S)),T(),m},-1),D(N,"$squeeze",function(h){var l,f=this;if(0===(l=E.slice.call(arguments)).length)return f.$$cast(f.replace(/(.)\1+/g,"$1"));var m=b(l);return null===m?f:f.$$cast(f.replace(new RegExp("("+m+")\\1+","g"),"$1"))},-1),D(N,"$start_with?",function(h){for(var l,f=this,m=0,x=(l=E.slice.call(arguments)).length;m<x;m++)if(l[m].$$is_regexp){var S=l[m],Z=S.exec(f);if(null!=Z&&0===Z.index)return ue["~"]=w("MatchData").$new(S,Z),!0;ue["~"]=y}else{var le=p(l[m],w("String"),"to_str").$to_s();if(0===f.indexOf(le))return!0}return!1},-1),D(N,"$strip",function(){return this.replace(/^[\s\u0000]*|[\s\u0000]*$/g,"")},0),D(N,"$sub",function C(h,c){var l=C.$$p||y,f=this;delete C.$$p,h.$$is_regexp||(h=p(h,w("String"),"to_str"),h=new RegExp(h.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")));var m,x=h.exec(f);return null===x?(ue["~"]=y,m=f.toString()):(w("MatchData").$new(h,x),void 0===c?(l===y&&U.$raise(w("ArgumentError"),"wrong number of arguments (1 for 2)"),m=f.slice(0,x.index)+l(x[0])+f.slice(x.index+x[0].length)):c.$$is_hash?m=f.slice(0,x.index)+c["$[]"](x[0]).$to_s()+f.slice(x.index+x[0].length):(c=(c=p(c,w("String"),"to_str")).replace(/([\\]+)([0-9+&`'])/g,function(S,Z,le){if(Z.length%2==0)return S;switch(le){case"+":for(var ye=x.length-1;ye>0;ye--)if(void 0!==x[ye])return Z.slice(1)+x[ye];return"";case"&":return Z.slice(1)+x[0];case"`":return Z.slice(1)+f.slice(0,x.index);case"'":return Z.slice(1)+f.slice(x.index+x[0].length);default:return Z.slice(1)+(x[le]||"")}}).replace(/\\\\/g,"\\"),m=f.slice(0,x.index)+c+f.slice(x.index+x[0].length))),f.$$cast(m)},-2),D(N,"$sum",function(h){null==h&&(h=16),h=p(h,w("Integer"),"to_int");for(var l=0,f=this.length,m=0;m<f;m++)l+=this.charCodeAt(m);return h<=0?l:l&Math.pow(2,h)-1},-1),D(N,"$swapcase",function(){var h=this,c=h.replace(/([a-z]+)|([A-Z]+)/g,function(l,f,m){return f?l.toUpperCase():l.toLowerCase()});return h.constructor===String?c:h.$class().$new(c)},0),D(N,"$to_f",function(){if("_"===this.charAt(0))return 0;var c=parseFloat(this.replace(/_/g,""));return isNaN(c)||c==1/0||c==-1/0?0:c},0),D(N,"$to_i",function(h){null==h&&(h=10);var l,f=this.toLowerCase(),m=p(h,w("Integer"),"to_int");return(1===m||m<0||m>36)&&U.$raise(w("ArgumentError"),"invalid radix "+m),/^\s*_/.test(f)?0:(f=f.replace(/^(\s*[+-]?)(0[bodx]?)(.+)$/,function(x,S,Z,le){switch(le.charAt(0)){case"+":case"-":return x;case"0":if("x"===le.charAt(1)&&"0x"===Z&&(0===m||16===m))return x}switch(Z){case"0b":if(0===m||2===m)return m=2,S+le;break;case"0":case"0o":if(0===m||8===m)return m=8,S+le;break;case"0d":if(0===m||10===m)return m=10,S+le;break;case"0x":if(0===m||16===m)return m=16,S+le}return x}),l=parseInt(f.replace(/_(?!_)/g,""),m),isNaN(l)?0:l)},-1),D(N,"$to_proc",function C(){var l;return delete C.$$p,l=K("$",this.valueOf()),oe(U,"proc",[],function f(m){var Z,x=f.$$p||y;delete f.$$p,0===(Z=E.slice.call(arguments)).length&&U.$raise(w("ArgumentError"),"no receiver given");var le=Z[0];null==le&&(le=y);var ye=le[l];return ye?("function"==typeof x&&(ye.$$p=x),1===Z.length?ye.call(le):ye.apply(le,Z.slice(1))):le.$method_missing.apply(le,Z)},-1)},0),D(N,"$to_s",function(){return this.toString()},0),D(N,"$tr",function(h,c){var l=this;if(h=p(h,w("String"),"to_str").$to_s(),c=p(c,w("String"),"to_str").$to_s(),0==h.length||h===c)return l;var f,m,x,S,Z,le,ye,T={},R=h.split(""),ie=R.length,j=c.split(""),ve=j.length,de=!1,we=null;"^"===R[0]&&R.length>1&&(de=!0,R.shift(),we=j[ve-1],ie-=1);var ce=[],he=null;for(m=!1,f=0;f<ie;f++)if(S=R[f],null==he)he=S,ce.push(S);else if("-"===S)"-"===he?(ce.push("-"),ce.push("-")):f==ie-1?ce.push("-"):m=!0;else if(m){for((Z=he.charCodeAt(0))>(le=S.charCodeAt(0))&&U.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Z)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Z+1;x<le;x++)ce.push(String.fromCharCode(x));ce.push(S),m=null,he=null}else ce.push(S);if(ie=(R=ce).length,de)for(f=0;f<ie;f++)T[R[f]]=!0;else{if(ve>0){var B=[],O=null;for(m=!1,f=0;f<ve;f++)if(S=j[f],null==O)O=S,B.push(S);else if("-"===S)"-"===O?(B.push("-"),B.push("-")):f==ve-1?B.push("-"):m=!0;else if(m){for((Z=O.charCodeAt(0))>(le=S.charCodeAt(0))&&U.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Z)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Z+1;x<le;x++)B.push(String.fromCharCode(x));B.push(S),m=null,O=null}else B.push(S);ve=(j=B).length}var ne=ie-ve;if(ne>0){var q=ve>0?j[ve-1]:"";for(f=0;f<ne;f++)j.push(q)}for(f=0;f<ie;f++)T[R[f]]=j[f]}var pe="";for(f=0,ye=l.length;f<ye;f++){var $e=T[S=l.charAt(f)];pe+=de?null==$e?we:S:null!=$e?$e:S}return l.$$cast(pe)},2),D(N,"$tr_s",function(h,c){var l=this;if(h=p(h,w("String"),"to_str").$to_s(),c=p(c,w("String"),"to_str").$to_s(),0==h.length)return l;var f,m,x,S,Z,le,ye,T={},R=h.split(""),ie=R.length,j=c.split(""),ve=j.length,de=!1,we=null;"^"===R[0]&&R.length>1&&(de=!0,R.shift(),we=j[ve-1],ie-=1);var ce=[],he=null;for(m=!1,f=0;f<ie;f++)if(S=R[f],null==he)he=S,ce.push(S);else if("-"===S)"-"===he?(ce.push("-"),ce.push("-")):f==ie-1?ce.push("-"):m=!0;else if(m){for((Z=he.charCodeAt(0))>(le=S.charCodeAt(0))&&U.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Z)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Z+1;x<le;x++)ce.push(String.fromCharCode(x));ce.push(S),m=null,he=null}else ce.push(S);if(ie=(R=ce).length,de)for(f=0;f<ie;f++)T[R[f]]=!0;else{if(ve>0){var B=[];for(m=!1,f=0;f<ve;f++)if(S=j[f],null==he)he=S,B.push(S);else if("-"===S)f==ve-1?B.push("-"):m=!0;else if(m){for((Z=he.charCodeAt(0))>(le=S.charCodeAt(0))&&U.$raise(w("ArgumentError"),'invalid range "'+String.fromCharCode(Z)+"-"+String.fromCharCode(le)+'" in string transliteration'),x=Z+1;x<le;x++)B.push(String.fromCharCode(x));B.push(S),m=null,he=null}else B.push(S);ve=(j=B).length}var ne=ie-ve;if(ne>0){var q=ve>0?j[ve-1]:"";for(f=0;f<ne;f++)j.push(q)}for(f=0;f<ie;f++)T[R[f]]=j[f]}var pe="",$e=null;for(f=0,ye=l.length;f<ye;f++){var me=T[S=l.charAt(f)];de?null==me?null==$e&&(pe+=we,$e=!0):(pe+=S,$e=null):null!=me?(null==$e||$e!==me)&&(pe+=me,$e=me):(pe+=S,$e=null)}return l.$$cast(pe)},2),D(N,"$upcase",function(){return this.$$cast(this.toUpperCase())},0),D(N,"$upto",function C(h,c){var l=C.$$p||y,f=this;if(delete C.$$p,null==c&&(c=!1),l===y)return f.$enum_for("upto",h,c);var m,x,S=f.toString();if(h=p(h,w("String"),"to_str"),1===S.length&&1===h.length)for(m=S.charCodeAt(0),x=h.charCodeAt(0);m<=x&&(!c||m!==x);)l(String.fromCharCode(m)),m+=1;else if(parseInt(S,10).toString()===S&&parseInt(h,10).toString()===h)for(m=parseInt(S,10),x=parseInt(h,10);m<=x&&(!c||m!==x);)l(m.toString()),m+=1;else for(;S.length<=h.length&&S<=h&&(!c||S!==h);)l(S),S=S.$succ();return f},-2),D(N,"$instance_variables",function(){return[]},0),F(N,"$_load",function(h){var c,f=this;return c=E.slice.call(arguments),oe(f,"new",V(c))},-1),D(N,"$unicode_normalize",function(h){return null==h&&(h="nfc"),se(["nfc","nfd","nfkc","nfkd"]["$include?"](h))||U.$raise(w("ArgumentError"),"Invalid normalization form "+h),this.normalize(h.$upcase())},-1),D(N,"$unicode_normalized?",function(h){return null==h&&(h="nfc"),this.$unicode_normalize(h)["$=="](this)},-1),D(N,"$unpack",function(h){return U.$raise("To use String#unpack, you must first require 'corelib/string/unpack'.")},1),D(N,"$unpack1",function(h){return U.$raise("To use String#unpack1, you must first require 'corelib/string/unpack'.")},1),D(N,"$freeze",function(){var h=this;return"string"==typeof h||(h.$$frozen=!0),h},0),D(N,"$-@",function(){var h=this;return"string"==typeof h||!0===h.$$frozen?h:"UTF-8"==h.encoding.name&&"UTF-8"==h.internal_encoding.name?h.toString():h.$dup().$freeze()},0),D(N,"$frozen?",function(){return"string"==typeof this||!0===this.$$frozen},0),ee(N,"+@","dup"),ee(N,"===","=="),ee(N,"byteslice","[]"),ee(N,"eql?","=="),ee(N,"equal?","==="),ee(N,"object_id","__id__"),ee(N,"slice","[]"),ee(N,"succ","next"),ee(N,"to_str","to_s"),ee(N,"to_sym","intern"),_.$pristine(N,"initialize")}(0,0,Y),M(Y[0],"Symbol",a("String"))},Opal.modules["corelib/enumerable"]=function(E){var ae=E.nil,Y=E.$$$,a=E.truthy,y=E.coerce_to,w=E.yield1,p=E.yieldX,u=E.module,k=E.send,v=E.to_a,D=E.Opal,_=E.def,F=E.Kernel,oe=E.rb_gt,V=E.rb_times,L=E.rb_lt,H=E.eqeq,U=E.rb_plus,se=E.rb_minus,ue=E.rb_divide,J=E.rb_le,K=E.hash2,ee=E.lambda,M=E.not,G=E.alias;return function(z){var A=u("::","Enumerable");function N(P){return 0===P.length&&(P=[ae]),P.length>1&&(P=[P]),P}return _(A,"$all?",function P(g){try{var b=P.$$p||ae;return delete P.$$p,a(void 0!==g)?k(this,"each",[],function(c){var m=ae;if(m=N(E.slice.call(arguments)),a(k(g,"public_send",["==="].concat(v(m)))))return ae;E.ret(!1)},-1):k(this,"each",[],b!==ae?function(c){var l;if(l=E.slice.call(arguments),a(E.yieldX(b,v(l))))return ae;E.ret(!1)}:function(c){var l;if(l=E.slice.call(arguments),a(D.$destructure(l)))return ae;E.ret(!1)},-1),!0}catch(h){if(h===E.returner)return h.$v;throw h}},-1),_(A,"$any?",function P(g){try{var b=P.$$p||ae;return delete P.$$p,a(void 0!==g)?k(this,"each",[],function(c){var m=ae;if(m=N(E.slice.call(arguments)),!a(k(g,"public_send",["==="].concat(v(m)))))return ae;E.ret(!0)},-1):k(this,"each",[],b!==ae?function(c){var l;if(l=E.slice.call(arguments),!a(E.yieldX(b,v(l))))return ae;E.ret(!0)}:function(c){var l;if(l=E.slice.call(arguments),!a(D.$destructure(l)))return ae;E.ret(!0)},-1),!1}catch(h){if(h===E.returner)return h.$v;throw h}},-1),_(A,"$chunk",function P(){var g=P.$$p||ae,b=this;return delete P.$$p,g===ae?k(b,"to_enum",["chunk"],function C(){return(null==C.$$s?this:C.$$s).$enumerator_size()},{$$arity:0,$$s:b}):k(Y("Enumerator"),"new",[],function C(h){var c=null==C.$$s?this:C.$$s;null==h&&(h=ae);var l=ae,f=[];function m(){f.length>0&&h.$yield(l,f)}c.$each.$$p=function(x){var S=w(g,x);S===ae?(m(),f=[],l=ae):(l===ae||l===S?f.push(x):(m(),f=[x]),l=S)},c.$each(),m()},{$$arity:1,$$s:b})},0),_(A,"$chunk_while",function P(){var g=P.$$p||ae;return delete P.$$p,g===ae&&F.$raise(Y("ArgumentError"),"no block given"),k(this,"slice_when",[],function(h,c){return null==h&&(h=ae),null==c&&(c=ae),E.yieldX(g,[h,c])["$!"]()},2)},0),_(A,"$collect",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return k(b,"enum_for",["collect"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];return b.$each.$$p=function(){var h=p(g,arguments);C.push(h)},b.$each(),C},0),_(A,"$collect_concat",function P(){var g=P.$$p||ae,b=this;return delete P.$$p,g===ae?k(b,"enum_for",["collect_concat"],function C(){return(null==C.$$s?this:C.$$s).$enumerator_size()},{$$arity:0,$$s:b}):k(b,"map",[],function(h){return null==h&&(h=ae),E.yield1(g,h)},1).$flatten(1)},0),_(A,"$compact",function(){return this.$to_a().$compact()},0),_(A,"$count",function P(g){var b=P.$$p||ae,h=ae;return delete P.$$p,h=0,null!=g&&b!==ae&&this.$warn("warning: given block not used"),a(null!=g)?b=k(F,"proc",[],function(l){var f;return f=E.slice.call(arguments),D.$destructure(f)["$=="](g)},-1):a(b["$nil?"]())&&(b=k(F,"proc",[],function(){return!0},0)),k(this,"each",[],function(l){var f;return f=E.slice.call(arguments),a(p(b,f))?h++:ae},-1),h},-1),_(A,"$cycle",function P(g){var b=P.$$p||ae,C=this;if(delete P.$$p,null==g&&(g=ae),b===ae)return k(C,"enum_for",["cycle",g],function m(){var x=null==m.$$s?this:m.$$s;return a(g["$nil?"]())?a(x["$respond_to?"]("size"))?Y(Y("Float"),"INFINITY"):ae:(g=D["$coerce_to!"](g,Y("Integer"),"to_int"),a(oe(g,0))?V(x.$enumerator_size(),g):0)},{$$arity:0,$$s:C});if(!a(g["$nil?"]())&&(g=D["$coerce_to!"](g,Y("Integer"),"to_int"),a(g<=0)))return ae;var c,l,h=[];if(C.$each.$$p=function(){var m=D.$destructure(arguments);w(b,m),h.push(m)},C.$each(),0===h.length)return ae;if(g===ae)for(;;)for(c=0,l=h.length;c<l;c++)w(b,h[c]);else for(;g>1;){for(c=0,l=h.length;c<l;c++)w(b,h[c]);g--}},-1),_(A,"$detect",function P(g){try{var b=P.$$p||ae;return delete P.$$p,b===ae?this.$enum_for("detect",g):(k(this,"each",[],function(c){var l,m=ae;if(l=E.slice.call(arguments),m=D.$destructure(l),!a(E.yield1(b,m)))return ae;E.ret(m)},-1),void 0!==g?"function"==typeof g?g():g:ae)}catch(h){if(h===E.returner)return h.$v;throw h}},-1),_(A,"$drop",function(g){g=y(g,Y("Integer"),"to_int"),a(g<0)&&F.$raise(Y("ArgumentError"),"attempt to drop negative size");var C=[],h=0;return this.$each.$$p=function(){g<=h&&C.push(D.$destructure(arguments)),h++},this.$each(),C},1),_(A,"$drop_while",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return b.$enum_for("drop_while");var C=[],h=!0;return b.$each.$$p=function(){var c=D.$destructure(arguments);if(h){var l=w(g,c);a(l)||(h=!1,C.push(c))}else C.push(c)},b.$each(),C},0),_(A,"$each_cons",function P(g){var b=P.$$p||ae,C=this;if(delete P.$$p,a(1!=arguments.length)&&F.$raise(Y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 1)"),g=D.$try_convert(g,Y("Integer"),"to_int"),a(g<=0)&&F.$raise(Y("ArgumentError"),"invalid size"),b===ae)return k(C,"enum_for",["each_cons",g],function c(){var f=ae;return f=(null==c.$$s?this:c.$$s).$enumerator_size(),a(f["$nil?"]())?ae:H(f,0)||a(L(f,g))?0:U(se(f,g),1)},{$$arity:0,$$s:C});var h=[];return C.$each.$$p=function(){var c=D.$destructure(arguments);h.push(c),h.length>g&&h.shift(),h.length==g&&w(b,h.slice(0,g))},C.$each(),C},1),_(A,"$each_entry",function P(g){var h,b=P.$$p||ae,c=this;return delete P.$$p,h=E.slice.call(arguments),b===ae?k(c,"to_enum",["each_entry"].concat(v(h)),function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:c}):(c.$each.$$p=function(){var l=D.$destructure(arguments);w(b,l)},c.$each.apply(c,h),c)},-1),_(A,"$each_slice",function P(g){var b=P.$$p||ae,C=this;if(delete P.$$p,g=y(g,Y("Integer"),"to_int"),a(g<=0)&&F.$raise(Y("ArgumentError"),"invalid slice size"),b===ae)return k(C,"enum_for",["each_slice",g],function c(){var l=null==c.$$s?this:c.$$s;return a(l["$respond_to?"]("size"))?ue(l.$size(),g).$ceil():ae},{$$arity:0,$$s:C});var h=[];return C.$each.$$p=function(){var c=D.$destructure(arguments);h.push(c),h.length===g&&(w(b,h),h=[])},C.$each(),h.length>0&&w(b,h),C},1),_(A,"$each_with_index",function P(g){var h,b=P.$$p||ae,c=this;if(delete P.$$p,h=E.slice.call(arguments),b===ae)return k(c,"enum_for",["each_with_index"].concat(v(h)),function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$arity:0,$$s:c});var l=0;return c.$each.$$p=function(){var f=D.$destructure(arguments);b(f,l),l++},c.$each.apply(c,h),c},-1),_(A,"$each_with_object",function P(g){var b=P.$$p||ae,C=this;return delete P.$$p,b===ae?k(C,"enum_for",["each_with_object",g],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:C}):(C.$each.$$p=function(){var h=D.$destructure(arguments);b(h,g)},C.$each(),g)},1),_(A,"$entries",function(g){var C,h=this;C=E.slice.call(arguments);var c=[];return h.$each.$$p=function(){c.push(D.$destructure(arguments))},h.$each.apply(h,C),c},-1),_(A,"$filter_map",function P(){var g=P.$$p||ae,b=this;return delete P.$$p,g===ae?k(b,"enum_for",["filter_map"],function C(){return(null==C.$$s?this:C.$$s).$enumerator_size()},{$$arity:0,$$s:b}):k(k(b,"map",[],g.$to_proc()),"select",[],"itself".$to_proc())},0),_(A,"$find_all",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return k(b,"enum_for",["find_all"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];return b.$each.$$p=function(){var h=D.$destructure(arguments),c=w(g,h);a(c)&&C.push(h)},b.$each(),C},0),_(A,"$find_index",function P(g){try{var b=P.$$p||ae,C=this,h=ae;return delete P.$$p,a(void 0===g&&b===ae)?C.$enum_for("find_index"):(null!=g&&b!==ae&&C.$warn("warning: given block not used"),h=0,a(null!=g)?k(C,"each",[],function(l){var f;return f=E.slice.call(arguments),H(D.$destructure(f),g)&&E.ret(h),h+=1},-1):k(C,"each",[],function(l){var f;return f=E.slice.call(arguments),a(E.yieldX(b,v(f)))&&E.ret(h),h+=1},-1),ae)}catch(c){if(c===E.returner)return c.$v;throw c}},-1),_(A,"$first",function(g){try{var C=ae,h=ae;return a(void 0===g)?k(this,"each",[],function(l){null==l&&(l=ae),E.ret(l)},1):(C=[],g=y(g,Y("Integer"),"to_int"),a(g<0)&&F.$raise(Y("ArgumentError"),"attempt to take negative size"),a(0==g)?[]:(h=0,k(this,"each",[],function(l){var f;if(f=E.slice.call(arguments),C.push(D.$destructure(f)),!a(g<=++h))return ae;E.ret(C)},-1),C))}catch(c){if(c===E.returner)return c.$v;throw c}},-1),_(A,"$grep",function P(g){var b=P.$$p||ae,h=ae;return delete P.$$p,h=[],k(this,"each",[],function(l){var m,x=ae;return x=N(m=E.slice.call(arguments)),a(k(g,"__send__",["==="].concat(v(x))))?(b!==ae?(a(oe(m.$length(),1))&&(m=[m]),m=E.yieldX(b,v(m))):a(J(m.$length(),1))&&(m=m["$[]"](0)),h.$push(m)):ae},-1),h},1),_(A,"$grep_v",function P(g){var b=P.$$p||ae,h=ae;return delete P.$$p,h=[],k(this,"each",[],function(l){var m,x=ae;return x=N(m=E.slice.call(arguments)),a(k(g,"__send__",["==="].concat(v(x))))?ae:(b!==ae?(a(oe(m.$length(),1))&&(m=[m]),m=E.yieldX(b,v(m))):a(J(m.$length(),1))&&(m=m["$[]"](0)),h.$push(m))},-1),h},1),_(A,"$group_by",function P(){var g=P.$$p||ae,b=this,C=ae,h=ae,c=ae;return delete P.$$p,g===ae?k(b,"enum_for",["group_by"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$arity:0,$$s:b}):(C=K([],{}),b.$each.$$p=function(){var f=D.$destructure(arguments),m=w(g,f);(a(h=C["$[]"](m))?h:(c=[m,[]],k(C,"[]=",v(c)),c[se(c.length,1)]))["$<<"](f)},b.$each(),C)},0),_(A,"$include?",function(g){try{return k(this,"each",[],function(h){var c;if(c=E.slice.call(arguments),!H(D.$destructure(c),g))return ae;E.ret(!0)},-1),!1}catch(C){if(C===E.returner)return C.$v;throw C}},1),_(A,"$inject",function P(g,b){var C=P.$$p||ae,h=this;delete P.$$p;var c=g;return C!==ae&&void 0===b?h.$each.$$p=function(){var l=D.$destructure(arguments);void 0!==c?(l=p(C,[c,l]),c=l):c=l}:(void 0===b&&(Y("Symbol")["$==="](g)||F.$raise(Y("TypeError"),g.$inspect()+" is not a Symbol"),b=g,c=void 0),h.$each.$$p=function(){var l=D.$destructure(arguments);c=void 0!==c?c.$__send__(b,l):l}),h.$each(),null==c?ae:c},-1),_(A,"$lazy",function(){return k(Y(Y("Enumerator"),"Lazy"),"new",[this,this.$enumerator_size()],function(C,h){var c;return null==C&&(C=ae),c=E.slice.call(arguments,1),k(C,"yield",v(c))},-2)},0),_(A,"$enumerator_size",function(){return a(this["$respond_to?"]("size"))?this.$size():ae},0),_(A,"$max",function P(g){var h,c,b=P.$$p||ae,C=this;return delete P.$$p,void 0===g||g===ae?(C.$each.$$p=function(){var l=D.$destructure(arguments);void 0!==h?((c=b!==ae?p(b,[l,h]):l["$<=>"](h))===ae&&F.$raise(Y("ArgumentError"),"comparison failed"),c>0&&(h=l)):h=l},C.$each(),void 0===h?ae:h):(g=y(g,Y("Integer"),"to_int"),k(C,"sort",[],b.$to_proc()).$reverse().$first(g))},-1),_(A,"$max_by",function P(g){var h,c,b=P.$$p||ae,C=this;return delete P.$$p,null==g&&(g=ae),a(b)?a(g["$nil?"]())?(C.$each.$$p=function(){var l=D.$destructure(arguments),f=w(b,l);if(void 0===h)return h=l,void(c=f);f["$<=>"](c)>0&&(h=l,c=f)},C.$each(),void 0===h?ae:h):k(C,"sort_by",[],b.$to_proc()).$reverse().$take(g):k(C,"enum_for",["max_by",g],function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:C})},-1),_(A,"$min",function P(g){var h,b=P.$$p||ae,C=this;return delete P.$$p,null==g&&(g=ae),a(g["$nil?"]())?(C.$each.$$p=b!==ae?function(){var c=D.$destructure(arguments);if(void 0!==h){var l=b(c,h);l===ae&&F.$raise(Y("ArgumentError"),"comparison failed"),l<0&&(h=c)}else h=c}:function(){var c=D.$destructure(arguments);void 0!==h?D.$compare(c,h)<0&&(h=c):h=c},C.$each(),void 0===h?ae:h):b!==ae?k(C,"sort",[],function(l,f){return null==l&&(l=ae),null==f&&(f=ae),E.yieldX(b,[l,f])},2).$take(g):C.$sort().$take(g)},-1),_(A,"$min_by",function P(g){var h,c,b=P.$$p||ae,C=this;return delete P.$$p,null==g&&(g=ae),a(b)?a(g["$nil?"]())?(C.$each.$$p=function(){var l=D.$destructure(arguments),f=w(b,l);if(void 0===h)return h=l,void(c=f);f["$<=>"](c)<0&&(h=l,c=f)},C.$each(),void 0===h?ae:h):k(C,"sort_by",[],b.$to_proc()).$take(g):k(C,"enum_for",["min_by",g],function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:C})},-1),_(A,"$minmax",function P(){var C,g=P.$$p||ae;delete P.$$p,g=a(C=g)?C:k(F,"proc",[],function(m,x){return null==m&&(m=ae),null==x&&(x=ae),m["$<=>"](x)},2);var h=ae,c=ae,l=!0;return this.$each.$$p=function(){var f=D.$destructure(arguments);if(l)h=c=f,l=!1;else{var m=g.$call(h,f);m===ae?F.$raise(Y("ArgumentError"),"comparison failed"):m>0&&(h=f);var x=g.$call(c,f);x===ae?F.$raise(Y("ArgumentError"),"comparison failed"):x<0&&(c=f)}},this.$each(),[h,c]},0),_(A,"$minmax_by",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,!a(g))return k(b,"enum_for",["minmax_by"],function f(){return(null==f.$$s?this:f.$$s).$enumerator_size()},{$$arity:0,$$s:b});var c,l,C=ae,h=ae;return b.$each.$$p=function(){var f=D.$destructure(arguments),m=w(g,f);(void 0===c||m["$<=>"](c)<0)&&(C=f,c=m),(void 0===l||m["$<=>"](l)>0)&&(h=f,l=m)},b.$each(),[C,h]},0),_(A,"$none?",function P(g){try{var b=P.$$p||ae;return delete P.$$p,a(void 0!==g)?k(this,"each",[],function(c){var m=ae;if(m=N(E.slice.call(arguments)),!a(k(g,"public_send",["==="].concat(v(m)))))return ae;E.ret(!1)},-1):k(this,"each",[],b!==ae?function(c){var l;if(l=E.slice.call(arguments),!a(E.yieldX(b,v(l))))return ae;E.ret(!1)}:function(c){var l,m=ae;if(l=E.slice.call(arguments),m=D.$destructure(l),!a(m))return ae;E.ret(!1)},-1),!0}catch(h){if(h===E.returner)return h.$v;throw h}},-1),_(A,"$one?",function P(g){try{var b=P.$$p||ae,h=ae;return delete P.$$p,h=0,a(void 0!==g)?k(this,"each",[],function(l){var x=ae;return x=N(E.slice.call(arguments)),a(k(g,"public_send",["==="].concat(v(x))))?(h=U(h,1),a(oe(h,1))?void E.ret(!1):ae):ae},-1):k(this,"each",[],b!==ae?function(l){var f;return f=E.slice.call(arguments),a(E.yieldX(b,v(f)))?(h=U(h,1),a(oe(h,1))?void E.ret(!1):ae):ae}:function(l){var f;return f=E.slice.call(arguments),a(D.$destructure(f))?(h=U(h,1),a(oe(h,1))?void E.ret(!1):ae):ae},-1),h["$=="](1)}catch(c){if(c===E.returner)return c.$v;throw c}},-1),_(A,"$partition",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return k(b,"enum_for",["partition"],function l(){return(null==l.$$s?this:l.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[],h=[];return b.$each.$$p=function(){var l=D.$destructure(arguments),f=w(g,l);a(f)?C.push(l):h.push(l)},b.$each(),[C,h]},0),_(A,"$reject",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return k(b,"enum_for",["reject"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];return b.$each.$$p=function(){var h=D.$destructure(arguments),c=w(g,h);a(c)||C.push(h)},b.$each(),C},0),_(A,"$reverse_each",function P(){var g=P.$$p||ae,b=this;if(delete P.$$p,g===ae)return k(b,"enum_for",["reverse_each"],function c(){return(null==c.$$s?this:c.$$s).$enumerator_size()},{$$arity:0,$$s:b});var C=[];b.$each.$$p=function(){C.push(arguments)},b.$each();for(var h=C.length-1;h>=0;h--)p(g,C[h]);return C},0),_(A,"$slice_before",function P(g){var b=P.$$p||ae,C=this;return delete P.$$p,a(void 0===g&&b===ae)&&F.$raise(Y("ArgumentError"),"both pattern and block are given"),a(void 0!==g&&b!==ae||arguments.length>1)&&F.$raise(Y("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),k(Y("Enumerator"),"new",[],function h(c){var l=null==h.$$s?this:h.$$s;null==c&&(c=ae);var f=[];l.$each.$$p=b!==ae?void 0===g?function(){var m=D.$destructure(arguments),x=w(b,m);a(x)&&f.length>0&&(c["$<<"](f),f=[]),f.push(m)}:function(){var m=D.$destructure(arguments),x=b(m,g.$dup());a(x)&&f.length>0&&(c["$<<"](f),f=[]),f.push(m)}:function(){var m=D.$destructure(arguments),x=g["$==="](m);a(x)&&f.length>0&&(c["$<<"](f),f=[]),f.push(m)},l.$each(),f.length>0&&c["$<<"](f)},{$$arity:1,$$s:C})},-1),_(A,"$slice_after",function P(g){var b=P.$$p||ae,C=this;return delete P.$$p,a(void 0===g&&b===ae)&&F.$raise(Y("ArgumentError"),"both pattern and block are given"),a(void 0!==g&&b!==ae||arguments.length>1)&&F.$raise(Y("ArgumentError"),"wrong number of arguments ("+arguments.length+" expected 1)"),a(void 0!==g)&&(b=k(F,"proc",[],function(c){return null==c&&(c=ae),g["$==="](c)},1)),k(Y("Enumerator"),"new",[],function h(c){var f,l=null==h.$$s?this:h.$$s;null==c&&(c=ae),l.$each.$$p=function(){var m=D.$destructure(arguments),x=w(b,m);null==f&&(f=[]),a(x)?(f.push(m),c.$yield(f),f=null):f.push(m)},l.$each(),null!=f&&c.$yield(f)},{$$arity:1,$$s:C})},-1),_(A,"$slice_when",function P(){var g=P.$$p||ae;return delete P.$$p,g===ae&&F.$raise(Y("ArgumentError"),"wrong number of arguments (0 for 1)"),k(Y("Enumerator"),"new",[],function C(h){var c=null==C.$$s?this:C.$$s;null==h&&(h=ae);var l=ae,f=ae;c.$each_cons.$$p=function(){var m=D.$destructure(arguments),x=m[0],S=m[1],Z=p(g,[x,S]);f=S,l===ae&&(l=[]),a(Z)?(l.push(x),h.$yield(l),l=[]):l.push(x)},c.$each_cons(2),l!==ae&&(l.push(f),h.$yield(l))},{$$arity:1,$$s:this})},0),_(A,"$sort",function P(){var C,g=P.$$p||ae;return delete P.$$p,C=this.$to_a(),g===ae&&(g=ee(function(c,l){return null==c&&(c=ae),null==l&&(l=ae),c["$<=>"](l)},2)),k(C,"sort",[],g.$to_proc())},0),_(A,"$sort_by",function P(){var g=P.$$p||ae,b=this,C=ae;return delete P.$$p,g===ae?k(b,"enum_for",["sort_by"],function h(){return(null==h.$$s?this:h.$$s).$enumerator_size()},{$$arity:0,$$s:b}):(C=k(b,"map",[],function(){var c=ae;return c=D.$destructure(arguments),[E.yield1(g,c),c]},0),k(C,"sort!",[],function(c,l){return null==c&&(c=ae),null==l&&(l=ae),c[0]["$<=>"](l[0])},2),k(C,"map!",[],function(c){return null==c&&(c=ae),c[1]},1))},0),_(A,"$sum",function P(g){var b=P.$$p||ae,h=ae,c=ae;return delete P.$$p,null==g&&(g=0),h=g,c=0,k(this,"each",[],function(f){var x,S=ae,Z=ae,le=ae;return x=E.slice.call(arguments),S=b!==ae?E.yieldX(b,v(x)):D.$destructure(x),M([Y(Y("Float"),"INFINITY"),Y(Y("Float"),"INFINITY")["$-@"]()]["$include?"](S))&&a(S["$respond_to?"]("-"))?(Z=se(S,c),le=U(h,Z),c=se(se(le,h),Z),h=le):h=U(h,S)},-1),h},-1),_(A,"$take",function(g){return this.$first(g)},1),_(A,"$take_while",function P(){try{var g=P.$$p||ae,C=ae;return delete P.$$p,a(g)?(C=[],k(this,"each",[],function(c){var l,m=ae;return l=E.slice.call(arguments),m=D.$destructure(l),a(E.yield1(g,m))||E.ret(C),C.push(m)},-1)):this.$enum_for("take_while")}catch(h){if(h===E.returner)return h.$v;throw h}},0),_(A,"$uniq",function P(){var g=P.$$p||ae,C=ae;return delete P.$$p,C=K([],{}),k(this,"each",[],function(c){var l,m=ae,x=ae,S=ae;return l=E.slice.call(arguments),m=D.$destructure(l),x=g!==ae?E.yield1(g,m):m,a(C["$key?"](x))?ae:(k(C,"[]=",v(S=[x,m])),S[se(S.length,1)])},-1),C.$values()},0),_(A,"$tally",function(g){var C;return C=k(k(this,"group_by",[],"itself".$to_proc()),"transform_values",[],"count".$to_proc()),a(g)?(k(C,"each",[],function(c,l){var f;return null==c&&(c=ae),null==l&&(l=ae),f=[c,U(g.$fetch(c,0),l)],k(g,"[]=",v(f)),f[se(f.length,1)]},2),g):C},-1),_(A,"$to_h",function P(g){var h,b=P.$$p||ae,c=this;if(delete P.$$p,h=E.slice.call(arguments),b!==ae)return k(k(c,"map",[],b.$to_proc()),"to_h",v(h));var l=K([],{});return c.$each.$$p=function(){var f=D.$destructure(arguments),m=D["$coerce_to?"](f,Y("Array"),"to_ary");m.$$is_array||F.$raise(Y("TypeError"),"wrong element type "+m.$class()+" (expected array)"),2!==m.length&&F.$raise(Y("ArgumentError"),"wrong array length (expected 2, was "+m.$length()+")"),E.hash_put(l,m[0],m[1])},c.$each.apply(c,h),l},-1),_(A,"$zip",function P(g){var h,c=this;return delete P.$$p,h=E.slice.call(arguments),k(c.$to_a(),"zip",v(h))},-1),G(A,"find","detect"),G(A,"filter","find_all"),G(A,"flat_map","collect_concat"),G(A,"map","collect"),G(A,"member?","include?"),G(A,"reduce","inject"),G(A,"select","find_all"),G(A,"to_a","entries")}()},Opal.modules["corelib/enumerator/arithmetic_sequence"]=function(E){var M,G,z,Y=E.nil,a=E.$$$,y=E.klass,w=E.truthy,p=E.to_a,u=E.eqeq,k=E.Kernel,v=E.def,D=E.rb_gt,_=E.rb_lt,F=E.rb_le,oe=E.rb_ge,V=E.rb_plus,L=E.rb_minus,H=E.eqeqeq,U=E.not,se=E.rb_times,ue=E.rb_divide,J=E.alias;return M=[],z=[G=y("::",null,"Enumerator")].concat(M),function(A,N,P){var g=y(A,N,"ArithmeticSequence"),b=[g].concat(P),C=E.$r(b),h=g.$$prototype;h.step_arg2=h.receiver_num=h.step_arg1=h.step=h.range=h.topfx=h.bypfx=h.creation_method=h.skipped_arg=Y,E.prop(g.$$prototype,"$$is_arithmetic_seq",!0);var c=1/0;return v(g,"$initialize",function(f,m,x){var S,Z=this,le=Y;return null==x&&(x="step"),Z.creation_method=x,w(f["$is_a?"](a("Array")))?(S=[].concat(p(f)),Z.step_arg1=null==S[0]?Y:S[0],Z.step_arg2=null==S[1]?Y:S[1],Z.topfx=null==S[2]?Y:S[2],Z.bypfx=null==S[3]?Y:S[3],Z.receiver_num=m,Z.step=1,Z.range=w(Z.step_arg2)?(Z.step=Z.step_arg2,E.Range.$new(Z.receiver_num,Z.step_arg1,!1)):w(Z.step_arg1)?E.Range.$new(Z.receiver_num,Z.step_arg1,!1):E.Range.$new(Z.receiver_num,Y,!1)):(w(m)||(Z.skipped_arg=!0),S=[f,w(le=m)?le:1],Z.range=S[0],Z.step=S[1]),Z.object=Z,u(Z.step,0)&&k.$raise(C("ArgumentError"),"step can't be 0"),w(Z.step["$respond_to?"]("to_int"))?Y:k.$raise(C("ArgumentError"),"no implicit conversion of "+Z.step.$class()+" into Integer")},-2),g.$attr_reader("step"),v(g,"$begin",function(){return this.range.$begin()},0),v(g,"$end",function(){return this.range.$end()},0),v(g,"$exclude_end?",function(){return this.range["$exclude_end?"]()},0),v(g,"$_lesser_than_end?",function(f){var x,S,m=this;return x=w(S=m.$end())?S:c,w(D(m.$step(),0))?w(m["$exclude_end?"]())?_(f,x):F(f,x):w(m["$exclude_end?"]())?D(f,x):oe(f,x)},1),v(g,"$_greater_than_begin?",function(f){var x,S;return x=w(S=this.$begin())?S:c["$-@"](),w(D(this.$step(),0))?D(f,x):_(f,x)},1),v(g,"$first",function(f){var x=this,S=Y,Z=Y,le=Y;if(S=w(Z=x.$begin())?Z:c["$-@"](),!w(f))return w(x["$_lesser_than_end?"](S))?S:Y;for(le=[];w(w(Z=x["$_lesser_than_end?"](S))?D(f,0):Z);)le["$<<"](S),S=V(S,x.$step()),f=L(f,1);return le},-1),v(g,"$each",function l(){var S,f=l.$$p||Y,x=this,Z=Y;if(delete l.$$p,f===Y)return x;for(H(Y,x.$begin())&&k.$raise(C("TypeError"),"nil can't be coerced into Integer"),Z=w(S=x.$begin())?S:c["$-@"]();w(x["$_lesser_than_end?"](Z));)E.yield1(f,Z),Z=V(Z,x.$step());return x},0),v(g,"$last",function(f){var x=this,S=Y,Z=Y,le=Y;if(H(c,S=x.$end())||H(c["$-@"](),S)?k.$raise(a("FloatDomainError"),x.$end()):H(Y,S)&&k.$raise(a("RangeError"),"cannot get the last element of endless arithmetic sequence"),Z=L(x.$end(),L(x.$end(),x.$begin())["$%"](x.$step())),w(x["$_lesser_than_end?"](Z))||(Z=L(Z,x.$step())),!w(f))return w(x["$_greater_than_begin?"](Z))?Z:Y;for(le=[];w(w(S=x["$_greater_than_begin?"](Z))?D(f,0):S);)le["$<<"](Z),Z=L(Z,x.$step()),f=L(f,1);return le.$reverse()},-1),v(g,"$size",function(){var m,f=this,x=Y;return m=w(D(f.$step(),0))?1:-1,U(f["$_lesser_than_end?"](f.$begin()))?0:w([c["$-@"](),c]["$include?"](f.$step()))?1:w([se(c["$-@"](),m),Y]["$include?"](f.$begin()))||w([se(c,m),Y]["$include?"](f.$end()))?c:(x=L(f.$end(),L(f.$end(),f.$begin())["$%"](f.$step())),w(f["$_lesser_than_end?"](x))||(x=L(x,f.$step())),V(ue(L(x,f.$begin()),f.$step()).$abs().$to_i(),1))},0),v(g,"$==",function(f){var x,S,Z,le,m=this;return w(x=w(S=w(Z=w(le=m.$class()["$=="](f.$class()))?m.$begin()["$=="](f.$begin()):le)?m.$end()["$=="](f.$end()):Z)?m.$step()["$=="](f.$step()):S)?m["$exclude_end?"]()["$=="](f["$exclude_end?"]()):x},1),v(g,"$hash",function(){var f=this;return[f.$begin(),f.$end(),f.$step(),f["$exclude_end?"]()].$hash()},0),v(g,"$inspect",function(){var f=this,m=Y;return w(f.receiver_num)?(m=w(f.step_arg2)?"("+f.topfx+f.step_arg1.$inspect()+", "+f.bypfx+f.step_arg2.$inspect()+")":w(f.step_arg1)?"("+f.topfx+f.step_arg1.$inspect()+")":Y,"("+f.receiver_num.$inspect()+"."+f.creation_method+m+")"):(m=w(f.skipped_arg)?Y:"("+f.step+")","(("+f.range.$inspect()+")."+f.creation_method+m+")")},0),J(g,"===","=="),J(g,"eql?","==")}(G,G,z)},Opal.modules["corelib/enumerator/chain"]=function(E){var V,L,_,ae=E.nil,Y=E.$$$,a=E.klass,y=E.def,w=E.send,p=E.to_a,u=E.truthy,k=E.rb_plus;return _=a("::",null,"Enumerator"),(L=(V=a(_,_,"Chain")).$$prototype).enums=L.iterated=ae,y(V,"$initialize",function(U){var se,J=this;return se=E.slice.call(arguments),J.enums=se,J.iterated=[],J.object=J},-1),y(V,"$each",function H(U){var ue,J,se=H.$$p||ae,K=this;return delete H.$$p,ue=E.slice.call(arguments),J=ue,se===ae?w(K,"to_enum",["each"].concat(p(J)),function ee(){return(null==ee.$$s?this:ee.$$s).$size()},{$$arity:0,$$s:K}):(w(K.enums,"each",[],function ee(M){var G=null==ee.$$s?this:ee.$$s;return null==G.iterated&&(G.iterated=ae),null==M&&(M=ae),G.iterated["$<<"](M),w(M,"each",p(J),se.$to_proc())},{$$arity:1,$$s:K}),K)},-1),y(V,"$size",function(U){try{var se,ue,J=this,K=ae;return se=E.slice.call(arguments),ue=se,K=0,w(J.enums,"each",[],function(M){var G;return null==M&&(M=ae),G=w(M,"size",p(ue)),u([ae,Y(Y("Float"),"INFINITY")]["$include?"](G))&&E.ret(G),K=k(K,G)},1),K}catch(ee){if(ee===E.returner)return ee.$v;throw ee}},-1),y(V,"$rewind",function(){var U=this;return w(U.iterated,"reverse_each",[],function(ue){return null==ue&&(ue=ae),u(ue["$respond_to?"]("rewind"))?ue.$rewind():ae},1),U.iterated=[],U},0),y(V,"$inspect",function(){return"#<Enumerator::Chain: "+this.enums.$inspect()+">"},0)},Opal.modules["corelib/enumerator/generator"]=function(E){var F,U,se,ue,J,V,ae=[],Y=E.nil,a=E.$$$,y=E.breaker,w=E.klass,p=E.truthy,u=E.Kernel,k=E.def,v=E.send;return F=ae,U=V=[w(ae[0],null,"Enumerator")].concat(F),ue=[se=w(V[0],null,"Generator")].concat(U),J=E.$r(ue),se.$$prototype.block=Y,se.$include(a("Enumerable")),k(se,"$initialize",function ee(){var M=ee.$$p||Y;return delete ee.$$p,p(M)||u.$raise(a("LocalJumpError"),"no block given"),this.block=M},0),k(se,"$each",function ee(M){var A,G=ee.$$p||Y,N=this,P=Y;delete ee.$$p,A=E.slice.call(arguments),P=v(J("Yielder"),"new",[],G.$to_proc());try{A.unshift(P),E.yieldX(N.block,A)}catch(g){if(g===y)return y.$v;throw g}return N},-1)},Opal.modules["corelib/enumerator/lazy"]=function(E){var M,P,g,b,C,G,Y=E.nil,a=E.$$$,y=E.truthy,w=E.coerce_to,p=E.yield1,u=E.yieldX,k=E.klass,v=E.send2,D=E.find_super,_=E.to_a,F=E.defs,oe=E.Kernel,V=E.send,L=E.def,H=E.Opal,U=E.rb_lt,se=E.eqeqeq,ue=E.rb_plus,J=E.alias;return M=[],P=[G=k("::",null,"Enumerator")].concat(M),b=[g=k(G,G,"Lazy")].concat(P),C=E.$r(b),g.$$prototype.enumerator=Y,k(g,a("Exception"),"StopLazyError"),F(g,"$for",function c(l,f){var x,S=c.$$p||Y,Z=this,le=Y;return delete c.$$p,x=E.slice.call(arguments,1),(le=v(Z,D(Z,"for",c,!1,!0),"for",[l].concat(_(x)),S)).enumerator=l,le},-2),L(g,"$initialize",function c(l,f){var m=c.$$p||Y,x=this;return delete c.$$p,null==f&&(f=Y),m===Y&&oe.$raise(a("ArgumentError"),"tried to call lazy new without a block"),x.enumerator=l,v(x,D(x,"initialize",c,!1,!0),"initialize",[f],function(Z,le){var T;null==Z&&(Z=Y),T=E.slice.call(arguments,1);try{return V(l,"each",_(T),function(ie){var ve;(ve=E.slice.call(arguments)).unshift(Z),u(m,ve)},-1)}catch(R){if(!E.rescue(R,[C("StopLazyError")]))throw R;try{return Y}finally{E.pop_exception()}}},-2)},-2),L(g,"$lazy",function(){return this},0),L(g,"$collect",function c(){var l=c.$$p||Y;return delete c.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy map without a block"),V(C("Lazy"),"new",[this,this.$enumerator_size()],function(x,S){var Z;null==x&&(x=Y),Z=E.slice.call(arguments,1);var ye=u(l,Z);x.$yield(ye)},-2)},0),L(g,"$collect_concat",function c(){var l=c.$$p||Y;return delete c.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy map without a block"),V(C("Lazy"),"new",[this,Y],function(x,S){var Z;null==x&&(x=Y),Z=E.slice.call(arguments,1);var ye=u(l,Z);if(ye["$respond_to?"]("force")&&ye["$respond_to?"]("each"))V(ye,"each",[],function(ie){return null==ie&&(ie=Y),x.$yield(ie)},1);else{var T=H.$try_convert(ye,a("Array"),"to_ary");T===Y?x.$yield(ye):V(ye,"each",[],function(ie){return null==ie&&(ie=Y),x.$yield(ie)},1)}},-2)},0),L(g,"$drop",function(l){var m,x,S=Y;return l=w(l,a("Integer"),"to_int"),y(U(l,0))&&oe.$raise(a("ArgumentError"),"attempt to drop negative size"),m=this.$enumerator_size(),x=se(a("Integer"),m)&&y(U(l,m))?l:m,S=0,V(C("Lazy"),"new",[this,x],function(le,ye){var R;return null==le&&(le=Y),R=E.slice.call(arguments,1),y(U(S,l))?S=ue(S,1):V(le,"yield",_(R))},-2)},1),L(g,"$drop_while",function c(){var l=c.$$p||Y,m=Y;return delete c.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy drop_while without a block"),m=!0,V(C("Lazy"),"new",[this,Y],function(S,Z){var ye;if(null==S&&(S=Y),ye=E.slice.call(arguments,1),!y(m))return V(S,"yield",_(ye));var T=u(l,ye);y(T)||(m=!1,V(S,"yield",_(ye)))},-2)},0),L(g,"$enum_for",function c(l,f){var x,S,Z,m=c.$$p||Y,le=this;return delete c.$$p,(x=E.slice.call(arguments)).length>0&&(S=x.shift()),null==S&&(S="each"),Z=x,V(le.$class(),"for",[le,S].concat(_(Z)),m.$to_proc())},-1),L(g,"$find_all",function c(){var l=c.$$p||Y;return delete c.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy select without a block"),V(C("Lazy"),"new",[this,Y],function(x,S){var Z,le;null==x&&(x=Y),Z=E.slice.call(arguments,1);var ye=u(l,le=Z);y(ye)&&V(x,"yield",_(le))},-2)},0),L(g,"$grep",function c(l){var f=c.$$p||Y;return delete c.$$p,y(f)?V(C("Lazy"),"new",[this,Y],function(S,Z){var le;null==S&&(S=Y),le=E.slice.call(arguments,1);var T=H.$destructure(le),R=l["$==="](T);y(R)&&(R=p(f,T),S.$yield(p(f,T)))},-2):V(C("Lazy"),"new",[this,Y],function(S,Z){var le;null==S&&(S=Y),le=E.slice.call(arguments,1);var T=H.$destructure(le),R=l["$==="](T);y(R)&&S.$yield(T)},-2)},1),L(g,"$reject",function c(){var l=c.$$p||Y;return delete c.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy reject without a block"),V(C("Lazy"),"new",[this,Y],function(x,S){var Z,le;null==x&&(x=Y),Z=E.slice.call(arguments,1);var ye=u(l,le=Z);y(ye)||V(x,"yield",_(le))},-2)},0),L(g,"$take",function(l){var m,x,S=Y;return l=w(l,a("Integer"),"to_int"),y(U(l,0))&&oe.$raise(a("ArgumentError"),"attempt to take negative size"),m=this.$enumerator_size(),x=se(a("Integer"),m)&&y(U(l,m))?l:m,S=0,V(C("Lazy"),"new",[this,x],function(le,ye){var R;return null==le&&(le=Y),R=E.slice.call(arguments,1),y(U(S,l))?(V(le,"yield",_(R)),S=ue(S,1)):oe.$raise(C("StopLazyError"))},-2)},1),L(g,"$take_while",function c(){var l=c.$$p||Y;return delete c.$$p,y(l)||oe.$raise(a("ArgumentError"),"tried to call lazy take_while without a block"),V(C("Lazy"),"new",[this,Y],function(x,S){var Z,le;null==x&&(x=Y),Z=E.slice.call(arguments,1);var ye=u(l,le=Z);y(ye)?V(x,"yield",_(le)):oe.$raise(C("StopLazyError"))},-2)},0),L(g,"$inspect",function(){return"#<"+this.$class()+": "+this.enumerator.$inspect()+">"},0),J(g,"force","to_a"),J(g,"filter","find_all"),J(g,"flat_map","collect_concat"),J(g,"map","collect"),J(g,"select","find_all"),J(g,"to_enum","enum_for")},Opal.modules["corelib/enumerator/yielder"]=function(E){var D,L,F,ae=[],Y=E.nil,a=E.breaker,y=E.klass,w=E.def,p=E.send,u=E.to_a;return D=ae,F=[y(ae[0],null,"Enumerator")].concat(D),(L=y(F[0],null,"Yielder")).$$prototype.block=Y,w(L,"$initialize",function U(){var se=U.$$p||Y;return delete U.$$p,this.block=se,this},0),w(L,"$yield",function(se){var ue,K=this;ue=E.slice.call(arguments);var ee=E.yieldX(K.block,ue);if(ee===a)throw a;return ee},-1),w(L,"$<<",function(se){return this.$yield(se),this},1),w(L,"$to_proc",function(){return p(this,"proc",[],function ue(J){var K,M=null==ue.$$s?this:ue.$$s;return K=E.slice.call(arguments),p(M,"yield",u(K))},{$$arity:-1,$$s:this})},0)},Opal.modules["corelib/enumerator"]=function(E){var G,z,A,N,P,a=E.nil,y=E.$$$,w=E.slice,p=E.coerce_to,u=E.klass,k=E.defs,v=E.truthy,D=E.send,_=E.not,F=E.def,oe=E.rb_plus,V=E.to_a,L=E.Opal,H=E.send2,U=E.find_super,se=E.rb_ge,ue=E.Kernel,J=E.rb_le,K=E.alias;return E.top.$require("corelib/enumerable"),G=[],A=[z=u("::",null,"Enumerator")].concat(G),N=E.$r(A),(P=z.$$prototype).size=P.args=P.object=P.method=P.values=P.cursor=a,z.$include(y("Enumerable")),z.$$prototype.$$is_enumerator=!0,k(z,"$for",function g(b,C,h){var l,f,m,c=g.$$p||a,x=this;delete g.$$p,(l=E.slice.call(arguments,1)).length>0&&(f=l.shift()),null==f&&(f="each"),m=l;var S=x.$allocate();return S.object=b,S.size=c,S.method=f,S.args=m,S.cursor=0,S},-2),F(z,"$initialize",function g(b){var C=g.$$p||a,l=this;return delete g.$$p,E.slice.call(arguments),l.cursor=0,v(C)?(l.object=D(N("Generator"),"new",[],C.$to_proc()),l.method="each",l.args=[],l.size=arguments[0]||a,v(l.size)&&_(l.size["$respond_to?"]("call"))?l.size=p(l.size,y("Integer"),"to_int"):a):(l.object=arguments[0],l.method=arguments[1]||"each",l.args=w.call(arguments,2),l.size=a)},-1),F(z,"$each",function g(b){var c,C=g.$$p||a,l=this;return delete g.$$p,c=E.slice.call(arguments),v(C["$nil?"]())&&v(c["$empty?"]())?l:(c=oe(l.args,c),v(C["$nil?"]())?D(l.$class(),"new",[l.object,l.method].concat(V(c))):D(l.object,"__send__",[l.method].concat(V(c)),C.$to_proc()))},-1),F(z,"$size",function(){var b=this;return v(b.size["$respond_to?"]("call"))?D(b.size,"call",V(b.args)):b.size},0),F(z,"$with_index",function g(b){var C=g.$$p||a,h=this;if(delete g.$$p,null==b&&(b=0),b=v(b)?p(b,y("Integer"),"to_int"):0,!v(C))return D(h,"enum_for",["with_index",b],function f(){return(null==f.$$s?this:f.$$s).$size()},{$$arity:0,$$s:h});var l=b;return h.$each.$$p=function(){var f=L.$destructure(arguments),m=C(f,l);return l++,m},h.$each()},-1),F(z,"$each_with_index",function g(){var b=g.$$p||a,C=this;return delete g.$$p,b===a?D(C,"enum_for",["each_with_index"],function h(){return(null==h.$$s?this:h.$$s).$size()},{$$arity:0,$$s:C}):(H(C,U(C,"each_with_index",g,!1,!0),"each_with_index",[],b),C.object)},0),F(z,"$rewind",function(){return this.cursor=0,this},0),F(z,"$peek_values",function(){var C,b=this;return b.values=v(C=b.values)?C:D(b,"map",[],function(c){return E.slice.call(arguments)},-1),v(se(b.cursor,b.values.$length()))&&ue.$raise(y("StopIteration"),"iteration reached an end"),b.values["$[]"](b.cursor)},0),F(z,"$peek",function(){var C=a;return C=this.$peek_values(),v(J(C.$length(),1))?C["$[]"](0):C},0),F(z,"$next_values",function(){var C,b=this;return C=b.$peek_values(),b.cursor=oe(b.cursor,1),C},0),F(z,"$next",function(){var C=a;return C=this.$next_values(),v(J(C.$length(),1))?C["$[]"](0):C},0),F(z,"$feed",function(b){return this.$raise(N("NotImplementedError"),"Opal doesn't support Enumerator#feed")},1),F(z,"$+",function(b){return y(y("Enumerator"),"Chain").$new(this,b)},1),F(z,"$inspect",function(){var b=this,C=a;return C="#<"+b.$class()+": "+b.object.$inspect()+":"+b.method,v(b.args["$any?"]())&&(C=oe(C,"("+b.args.$inspect()["$[]"](y("Range").$new(1,-2))+")")),oe(C,">")},0),K(z,"with_object","each_with_object"),z.$autoload("ArithmeticSequence","corelib/enumerator/arithmetic_sequence"),z.$autoload("Chain","corelib/enumerator/chain"),z.$autoload("Generator","corelib/enumerator/generator"),z.$autoload("Lazy","corelib/enumerator/lazy"),z.$autoload("Yielder","corelib/enumerator/yielder")},Opal.modules["corelib/numeric"]=function(E){var A,Y=E.nil,a=E.$$$,y=E.klass,w=E.truthy,p=E.Kernel,u=E.def,k=E.to_ary,v=E.eqeqeq,D=E.rb_minus,_=E.rb_times,F=E.rb_lt,oe=E.eqeq,V=E.rb_divide,L=E.Opal,H=E.hash2,U=E.not,se=E.send,ue=E.rb_ge,J=E.rb_le,K=E.rb_plus,ee=E.rb_gt,M=E.alias;return E.top.$require("corelib/comparable"),(A=y("::",null,"Numeric")).$include(a("Comparable")),u(A,"$coerce",function(P){var g=this;return w(P["$instance_of?"](g.$class()))?[P,g]:[p.$Float(P),p.$Float(g)]},1),u(A,"$__coerced__",function(P,g){var b,C,f=Y;return w(g["$respond_to?"]("coerce"))?(C=g.$coerce(this),(null==(b=k(C))[0]?Y:b[0]).$__send__(P,null==b[1]?Y:b[1])):v("+",f=P)||v("-",f)||v("*",f)||v("/",f)||v("%",f)||v("&",f)||v("|",f)||v("^",f)||v("**",f)?p.$raise(a("TypeError"),g.$class()+" can't be coerced into Numeric"):v(">",f)||v(">=",f)||v("<",f)||v("<=",f)||v("<=>",f)?p.$raise(a("ArgumentError"),"comparison of "+this.$class()+" with "+g.$class()+" failed"):Y},2),u(A,"$<=>",function(P){return w(this["$equal?"](P))?0:Y},1),u(A,"$+@",function(){return this},0),u(A,"$-@",function(){return D(0,this)},0),u(A,"$%",function(P){return D(this,_(P,this.$div(P)))},1),u(A,"$abs",function(){var P=this;return F(P,0)?P["$-@"]():P},0),u(A,"$abs2",function(){return _(this,this)},0),u(A,"$angle",function(){return F(this,0)?a(a("Math"),"PI"):0},0),u(A,"$ceil",function(P){return null==P&&(P=0),this.$to_f().$ceil(P)},-1),u(A,"$conj",function(){return this},0),u(A,"$denominator",function(){return this.$to_r().$denominator()},0),u(A,"$div",function(P){return oe(P,0)&&p.$raise(a("ZeroDivisionError"),"divided by o"),V(this,P).$floor()},1),u(A,"$divmod",function(P){return[this.$div(P),this["$%"](P)]},1),u(A,"$fdiv",function(P){return V(this.$to_f(),P)},1),u(A,"$floor",function(P){return null==P&&(P=0),this.$to_f().$floor(P)},-1),u(A,"$i",function(){return p.$Complex(0,this)},0),u(A,"$imag",function(){return 0},0),u(A,"$integer?",function(){return!1},0),u(A,"$nonzero?",function(){return w(this["$zero?"]())?Y:this},0),u(A,"$numerator",function(){return this.$to_r().$numerator()},0),u(A,"$polar",function(){return[this.$abs(),this.$arg()]},0),u(A,"$quo",function(P){return V(L["$coerce_to!"](this,a("Rational"),"to_r"),P)},1),u(A,"$real",function(){return this},0),u(A,"$real?",function(){return!0},0),u(A,"$rect",function(){return[this,0]},0),u(A,"$round",function(P){return this.$to_f().$round(P)},-1),u(A,"$step",function N(P,g,b){var h,c,l,f,m,x,C=N.$$p||Y,Z=this,le=Y;if(delete N.$$p,h=E.slice.call(arguments),null==(c=E.extract_kwargs(h)))c=H([],{});else if(!c.$$is_hash)throw E.ArgumentError.$new("expected kwargs");function ye(){f===Y&&p.$raise(a("TypeError"),"step must be numeric"),null!=f&&f["$=="](0)&&p.$raise(a("ArgumentError"),"step can't be 0"),(f===Y||null==f)&&(f=1);var B=f["$<=>"](0);B===Y&&p.$raise(a("ArgumentError"),"0 can't be coerced into "+f.$class()),(l===Y||null==l)&&(l=B>0?a(a("Float"),"INFINITY"):a(a("Float"),"INFINITY")["$-@"]()),L.$compare(Z,l)}function T(){if(f>0&&Z>l||f<0&&Z<l)return 0;if(f===1/0||f===-1/0)return 1;var B=Math.abs,O=Math.floor,ne=(B(Z)+B(l)+B(l-Z))/B(f)*a(a("Float"),"EPSILON");return ne===1/0||ne===-1/0?0:(ne>.5&&(ne=.5),O((l-Z)/f+ne)+1)}function R(){if(ye(),0===f)return 1/0;if(f%1!=0)return T();if(f>0&&Z>l||f<0&&Z<l)return 0;var B=Math.ceil,O=Math.abs;return B((O(Z-l)+1)/O(f))}if(h.length>0&&(l=h.shift()),h.length>0&&(f=h.shift()),m=c.$$smap.to,x=c.$$smap.by,void 0!==l&&void 0!==m&&p.$raise(a("ArgumentError"),"to is given twice"),void 0!==f&&void 0!==x&&p.$raise(a("ArgumentError"),"step is given twice"),void 0!==m&&(l=m),void 0!==x&&(f=x),void 0===l&&(l=Y),C===Y)return(U(l)||w(l["$is_a?"](a("Numeric"))))&&(U(f)||w(f["$is_a?"](a("Numeric"))))?a(a("Enumerator"),"ArithmeticSequence").$new([l,f,w(m)?"to: ":Y,w(x)?"by: ":Y],Z):se(Z,"enum_for",["step",l,f],R.$to_proc());ye();var ie=f["$negative?"](),j=f["$=="](0)||l===1/0&&!ie||l===-1/0&&ie;if(Z.$$is_number&&f.$$is_number&&l.$$is_number){if(Z%1!=0||!j&&l%1!=0||f%1!=0){var de=Z.$to_f().valueOf();f=f.$to_f().valueOf(),l=l.$to_f().valueOf();var we=T();if(isFinite(f))if(0===f)for(;;)C(de);else for(var ce=0;ce<we;ce++){var he=ce*f+Z;(f>=0?l<he:l>he)&&(he=l),C(he)}else 0!==we&&C(de);return Z}var ve=Z;if(j)for(;;ve+=f)C(ve);else if(ie)for(;ve>=l;ve+=f)C(ve);else for(;ve<=l;ve+=f)C(ve);return Z}for(le=Z;w(ie?ue(le,l):J(le,l));)E.yield1(C,le),le=K(le,f)},-1),u(A,"$to_c",function(){return p.$Complex(this,0)},0),u(A,"$to_int",function(){return this.$to_i()},0),u(A,"$truncate",function(P){return null==P&&(P=0),this.$to_f().$truncate(P)},-1),u(A,"$zero?",function(){return this["$=="](0)},0),u(A,"$positive?",function(){return ee(this,0)},0),u(A,"$negative?",function(){return F(this,0)},0),u(A,"$dup",function(){return this},0),u(A,"$clone",function(P){if(null==P)P=H([],{});else if(!P.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return this},-1),u(A,"$finite?",function(){return!0},0),u(A,"$infinite?",function(){return Y},0),M(A,"arg","angle"),M(A,"conjugate","conj"),M(A,"imaginary","imag"),M(A,"magnitude","abs"),M(A,"modulo","%"),M(A,"phase","arg"),M(A,"rectangular","rect")},Opal.modules["corelib/array"]=function(E){var ae=E.top,a=E.nil,y=E.$$$,w=E.truthy,p=E.falsy,u=E.hash_ids,k=E.yield1,v=E.hash_get,D=E.hash_put,_=E.hash_delete,F=E.coerce_to,oe=E.respond_to,V=E.klass,L=E.defs,H=E.Kernel,U=E.def,se=E.Opal,ue=E.eqeqeq,J=E.hash2,K=E.send2,ee=E.find_super,M=E.send,G=E.rb_gt,z=E.rb_times,A=E.eqeq,N=E.rb_minus,P=E.to_a,g=E.to_ary,b=E.gvars,C=E.rb_ge,h=E.rb_lt,c=E.neqeq,l=E.alias;return ae.$require("corelib/enumerable"),ae.$require("corelib/numeric"),function(f,m,x){var S=V("::",Array,"Array"),Z=[S].concat([]),le=E.$r(Z);function T(he,B){return B.$$name===E.Array?he:B.$allocate().$replace(he.$to_a())}function R(he,B,O){for(var ne,q=null,pe=new Array(he.length),$e=0,me=0,Te=he.length;$e<Te;$e++){if(!q)try{ne=k(O,he[$e])}catch(De){q=De}(q||B(ne))&&(pe[me]=he[$e],me+=1)}if(me!==$e&&(he.splice.apply(he,[0,pe.length].concat(pe)),he.splice(me,pe.length)),q)throw q}function ie(he,B){var ne,q,pe,O=he.length;return ne=B.excl,q=B.begin===a?0:F(B.begin,E.Integer,"to_int"),pe=B.end===a?-1:F(B.end,E.Integer,"to_int"),q<0&&(q+=O)<0||(B.excl_rev&&B.begin!==a&&(q+=1),q>O)?a:pe<0&&(pe+=O)<0?[]:((!ne||B.end===a)&&(pe+=1),he.slice(q,pe))}function de(he,B){return he===B||0===B?1:B>0&&he>B?de(he-1,B-1)+de(he-1,B):0}S.$include(y("Enumerable")),E.prop(S.$$prototype,"$$is_array",!0),L(S,"$[]",function(B){var q=this;return T(E.slice.call(arguments),q)},-1),U(S,"$initialize",function he(B,O){var pe,$e,ne=he.$$p||a,q=this;if(delete he.$$p,null==B&&(B=a),null==O&&(O=a),O!==a&&ne!==a&&H.$warn("warning: block supersedes default value argument"),B>y(y("Integer"),"MAX")&&H.$raise(y("ArgumentError"),"array size too big"),arguments.length>2&&H.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..2)"),0===arguments.length)return q.splice(0,q.length),q;if(1===arguments.length){if(B.$$is_array)return q.$replace(B.$to_a()),q;if(B["$respond_to?"]("to_ary"))return q.$replace(B.$to_ary()),q}if((B=F(B,y("Integer"),"to_int"))<0&&H.$raise(y("ArgumentError"),"negative array size"),q.splice(0,q.length),ne===a)for(pe=0;pe<B;pe++)q.push(O);else for(pe=0;pe<B;pe++)$e=ne(pe),q[pe]=$e;return q},-1),L(S,"$try_convert",function(B){return se["$coerce_to?"](B,y("Array"),"to_ary")},1),U(S,"$&",function(B){B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a();var pe,$e,me,ne=[],q=J([],{});for(pe=0,$e=B.length;pe<$e;pe++)D(q,B[pe],!0);for(pe=0,$e=this.length;pe<$e;pe++)void 0!==_(q,me=this[pe])&&ne.push(me);return ne},1),U(S,"$|",function(B){B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a();var q,pe,ne=J([],{});for(q=0,pe=this.length;q<pe;q++)D(ne,this[q],!0);for(q=0,pe=B.length;q<pe;q++)D(ne,B[q],!0);return ne.$keys()},1),U(S,"$*",function(B){if(w(B["$respond_to?"]("to_str")))return this.$join(B.$to_str());B=F(B,y("Integer"),"to_int"),w(B<0)&&H.$raise(y("ArgumentError"),"negative argument");for(var ne=[],q=this.$to_a(),pe=0;pe<B;pe++)ne=ne.concat(q);return ne},1),U(S,"$+",function(B){return B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a(),this.concat(B)},1),U(S,"$-",function(B){var O=this;if(B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a(),w(0===O.length))return[];if(w(0===B.length))return O.slice();var pe,$e,me,ne=[],q=J([],{});for(pe=0,$e=B.length;pe<$e;pe++)D(q,B[pe],!0);for(pe=0,$e=O.length;pe<$e;pe++)void 0===v(q,me=O[pe])&&ne.push(me);return ne},1),U(S,"$<<",function(B){return this.push(B),this},1),U(S,"$<=>",function(B){var O=this;if(ue(y("Array"),B))B=B.$to_a();else{if(!w(B["$respond_to?"]("to_ary")))return a;B=B.$to_ary().$to_a()}if(O.$hash()===B.$hash())return 0;for(var ne=Math.min(O.length,B.length),q=0;q<ne;q++){var pe=O[q]["$<=>"](B[q]);if(0!==pe)return pe}return O.length["$<=>"](B.length)},1),U(S,"$==",function(B){var ne={};return function q(pe,$e){var me,Te,De,Me;if(pe===$e)return!0;if(!$e.$$is_array)return!!oe($e,"$to_ary")&&$e["$=="](pe);if(pe.$$constructor!==Array&&(pe=pe.$to_a()),$e.$$constructor!==Array&&($e=$e.$to_a()),pe.length!==$e.length)return!1;for(ne[pe.$object_id()]=!0,me=0,Te=pe.length;me<Te;me++)if(Me=$e[me],(De=pe[me]).$$is_array){if(Me.$$is_array&&Me.length!==De.length||!ne.hasOwnProperty(De.$object_id())&&!q(De,Me))return!1}else if(!De["$=="](Me))return!1;return!0}(this,B)},1),U(S,"$[]",function(B,O){return B.$$is_range?ie(this,B):B.$$is_arithmetic_seq?function j(he,B){var O,ne=[],q=0;for(O=B.step<0?ie(he,{begin:B.range.end,end:B.range.begin,excl:!1,excl_rev:B.range.excl}).$reverse():ie(he,B.range);q<O.length;)ne.push(O[q]),q+=Math.abs(B.step);return ne}(this,B):function ve(he,B,O){var ne=he.length;return(B=F(B,E.Integer,"to_int"))<0&&(B+=ne)<0?a:void 0===O?B>=ne||B<0?a:he[B]:(O=F(O,E.Integer,"to_int"))<0||B>ne||B<0?a:he.slice(B,B+O)}(this,B,O)},-2),U(S,"$[]=",function(B,O,ne){var me,Ve,q=this,pe=a,$e=a,Te=q.length;if(ue(y("Range"),B)){pe=ue(y("Array"),O)?O.$to_a():w(O["$respond_to?"]("to_ary"))?O.$to_ary().$to_a():[O];var De=B.excl,Me=B.begin===a?0:F(B.begin,E.Integer,"to_int"),Pe=B.end===a?-1:F(B.end,E.Integer,"to_int");if(Me<0&&(Me+=Te)<0&&H.$raise(y("RangeError"),B.$inspect()+" out of range"),Pe<0&&(Pe+=Te),(!De||B.end===a)&&(Pe+=1),Me>Te)for(me=Te;me<Me;me++)q[me]=a;return q.splice.apply(q,Pe<0?[Me,0].concat(pe):[Me,Pe-Me].concat(pe)),O}if(w(void 0===ne)?$e=1:($e=O,O=ne,pe=ue(y("Array"),O)?O.$to_a():w(O["$respond_to?"]("to_ary"))?O.$to_ary().$to_a():[O]),B=F(B,y("Integer"),"to_int"),$e=F($e,y("Integer"),"to_int"),B<0&&(Ve=B,(B+=Te)<0&&H.$raise(y("IndexError"),"index "+Ve+" too small for array; minimum "+-q.length)),$e<0&&H.$raise(y("IndexError"),"negative length ("+$e+")"),B>Te)for(me=Te;me<B;me++)q[me]=a;return void 0===ne?q[B]=O:q.splice.apply(q,[B,$e].concat(pe)),O},-3),U(S,"$any?",function he(B){var O=he.$$p||a;return delete he.$$p,0!==this.length&&K(this,ee(this,"any?",he,!1,!0),"any?",[B],O)},-1),U(S,"$assoc",function(B){for(var pe,ne=0,q=this.length;ne<q;ne++)if((pe=this[ne]).length&&pe[0]["$=="](B))return pe;return a},1),U(S,"$at",function(B){var O=this;return(B=F(B,y("Integer"),"to_int"))<0&&(B+=O.length),B<0||B>=O.length?a:O[B]},1),U(S,"$bsearch_index",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return O.$enum_for("bsearch_index");for(var pe,me,ne=0,q=O.length,Te=!1,De=a;ne<q;){if(pe=ne+Math.floor((q-ne)/2),!0===(me=k(B,O[pe])))De=pe,Te=!0;else if(!1===me||me===a)Te=!1;else if(me.$$is_number){if(0===me)return pe;Te=me<0}else H.$raise(y("TypeError"),"wrong argument type "+me.$class()+" (must be numeric, true, false or nil)");Te?q=pe:ne=pe+1}return De},0),U(S,"$bsearch",function he(){var B=he.$$p||a,O=this,ne=a;return delete he.$$p,B===a?O.$enum_for("bsearch"):null!=(ne=M(O,"bsearch_index",[],B.$to_proc()))&&ne.$$is_number?O[ne]:ne},0),U(S,"$cycle",function he(B){var q,pe,O=he.$$p||a,ne=this;if(delete he.$$p,null==B&&(B=a),O===a)return M(ne,"enum_for",["cycle",B],function me(){var Te=null==me.$$s?this:me.$$s;return w(B["$nil?"]())?y(y("Float"),"INFINITY"):(B=se["$coerce_to!"](B,y("Integer"),"to_int"),w(G(B,0))?z(Te.$enumerator_size(),B):0)},{$$arity:0,$$s:ne});if(w(ne["$empty?"]())||A(B,0))return a;if(B===a)for(;;)for(q=0,pe=ne.length;q<pe;q++)k(O,ne[q]);else{if((B=se["$coerce_to!"](B,y("Integer"),"to_int"))<=0)return ne;for(;B>0;){for(q=0,pe=ne.length;q<pe;q++)k(O,ne[q]);B--}}return ne},-1),U(S,"$clear",function(){var B=this;return B.splice(0,B.length),B},0),U(S,"$count",function he(B){var O=he.$$p||a;return delete he.$$p,w(void 0!==B)||w(O)?K(this,ee(this,"count",he,!1,!0),"count",[B],O):this.$size()},-1),U(S,"$initialize_copy",function(B){return this.$replace(B)},1),U(S,"$collect",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["collect"],function me(){return(null==me.$$s?this:me.$$s).$size()},{$$arity:0,$$s:O});for(var ne=[],q=0,pe=O.length;q<pe;q++){var $e=k(B,O[q]);ne.push($e)}return ne},0),U(S,"$collect!",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["collect!"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$arity:0,$$s:O});for(var ne=0,q=O.length;ne<q;ne++){var pe=k(B,O[ne]);O[ne]=pe}return O},0),U(S,"$combination",function he(B){var q,pe,$e,me,Te,De,Me,Pe,O=he.$$p||a,ne=this;if(delete he.$$p,q=se["$coerce_to!"](B,y("Integer"),"to_int"),O===a)return M(ne,"enum_for",["combination",q],function Ve(){return de((null==Ve.$$s?this:Ve.$$s).length,q)},{$$arity:0,$$s:ne});if(0===q)E.yield1(O,[]);else if(1===q)for(pe=0,$e=ne.length;pe<$e;pe++)E.yield1(O,[ne[pe]]);else if(q===ne.length)E.yield1(O,ne.slice());else if(q>=0&&q<ne.length){for(me=[],pe=0;pe<=q+1;pe++)me.push(0);for(Te=[],De=0,Me=!1,me[0]=-1;!Me;){for(Te[De]=ne[me[De+1]];De<q-1;)Pe=me[1+ ++De]=me[De]+1,Te[De]=ne[Pe];E.yield1(O,Te.slice()),De++;do{Me=0===De,me[De]++,De--}while(me[De+1]+q===ne.length+De+1)}}return ne},1),U(S,"$repeated_combination",function he(B){var q,O=he.$$p||a;return delete he.$$p,q=se["$coerce_to!"](B,y("Integer"),"to_int"),O===a?M(this,"enum_for",["repeated_combination",q],function $e(){return de((null==$e.$$s?this:$e.$$s).length+q-1,q)},{$$arity:0,$$s:this}):(q>=0&&function pe($e,me,Te,De){if(Te.length!=$e)for(var Pe=me;Pe<De.length;Pe++)Te.push(De[Pe]),pe($e,Pe,Te,De),Te.pop();else{var Me=Te.slice();E.yield1(O,Me)}}(q,0,[],this),this)},1),U(S,"$compact",function(){for(var pe,O=[],ne=0,q=this.length;ne<q;ne++)(pe=this[ne])!==a&&O.push(pe);return O},0),U(S,"$compact!",function(){for(var B=this,O=B.length,ne=0,q=B.length;ne<q;ne++)B[ne]===a&&(B.splice(ne,1),q--,ne--);return B.length===O?a:B},0),U(S,"$concat",function(B){var O,ne,q=this;return O=E.slice.call(arguments),ne=M(ne=O,"map",[],function pe($e){var me=null==pe.$$s?this:pe.$$s;return null==$e&&($e=a),$e=ue(y("Array"),$e)?$e.$to_a():F($e,y("Array"),"to_ary").$to_a(),w($e["$equal?"](me))&&($e=$e.$dup()),$e},{$$arity:1,$$s:q}),M(ne,"each",[],function pe($e){var me=null==pe.$$s?this:pe.$$s;null==$e&&($e=a);for(var Te=0,De=$e.length;Te<De;Te++)me.push($e[Te])},{$$arity:1,$$s:q}),q},-1),U(S,"$delete",function he(B){var O=he.$$p||a;delete he.$$p;for(var q=this.length,pe=0,$e=q;pe<$e;pe++)this[pe]["$=="](B)&&(this.splice(pe,1),$e--,pe--);return this.length===q?O!==a?E.yieldX(O,[]):a:B},1),U(S,"$delete_at",function(B){var O=this;if((B=F(B,y("Integer"),"to_int"))<0&&(B+=O.length),B<0||B>=O.length)return a;var ne=O[B];return O.splice(B,1),ne},1),U(S,"$delete_if",function he(){var B=he.$$p||a,O=this;return delete he.$$p,B===a?M(O,"enum_for",["delete_if"],function ne(){return(null==ne.$$s?this:ne.$$s).$size()},{$$arity:0,$$s:O}):(R(O,p,B),O)},0),U(S,"$difference",function(B){var O,q=this;return O=E.slice.call(arguments),M(O,"reduce",[q.$to_a().$dup()],function($e,me){return null==$e&&($e=a),null==me&&(me=a),N($e,me)},2)},-1),U(S,"$dig",function(B,O){var q,pe=this,$e=a;return q=E.slice.call(arguments,1),($e=pe["$[]"](B))===a||0===q.length?$e:(w($e["$respond_to?"]("dig"))||H.$raise(y("TypeError"),$e.$class()+" does not have #dig method"),M($e,"dig",P(q)))},-2),U(S,"$drop",function(B){return(B=F(B,y("Integer"),"to_int"))<0&&H.$raise(y("ArgumentError")),this.slice(B)},1),U(S,"$dup",function he(){var B=he.$$p||a,O=this;return delete he.$$p,O.$$class===E.Array&&O.$$class.$allocate.$$pristine&&O.$copy_instance_variables.$$pristine&&O.$initialize_dup.$$pristine?O.slice(0):K(O,ee(O,"dup",he,!1,!0),"dup",[],B)},0),U(S,"$each",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["each"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$arity:0,$$s:O});for(var ne=0,q=O.length;ne<q;ne++)k(B,O[ne]);return O},0),U(S,"$each_index",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["each_index"],function $e(){return(null==$e.$$s?this:$e.$$s).$size()},{$$arity:0,$$s:O});for(var ne=0,q=O.length;ne<q;ne++)k(B,ne);return O},0),U(S,"$empty?",function(){return 0===this.length},0),U(S,"$eql?",function(B){var ne={};return function q(pe,$e){var me,Te,De,Me;if(!$e.$$is_array||($e=$e.$to_a(),pe.length!==$e.length))return!1;for(ne[pe.$object_id()]=!0,me=0,Te=pe.length;me<Te;me++)if(Me=$e[me],(De=pe[me]).$$is_array){if(Me.$$is_array&&Me.length!==De.length||!ne.hasOwnProperty(De.$object_id())&&!q(De,Me))return!1}else if(!De["$eql?"](Me))return!1;return!0}(this,B)},1),U(S,"$fetch",function he(B,O){var ne=he.$$p||a,q=this;delete he.$$p;var pe=B;return(B=F(B,y("Integer"),"to_int"))<0&&(B+=q.length),B>=0&&B<q.length?q[B]:(ne!==a&&null!=O&&q.$warn("warning: block supersedes default value argument"),ne!==a?ne(pe):null!=O?O:void H.$raise(y("IndexError"),0===q.length?"index "+pe+" outside of array bounds: 0...0":"index "+pe+" outside of array bounds: -"+q.length+"..."+q.length))},-2),U(S,"$fill",function he(B){var q,pe,Qe,Bt,O=he.$$p||a,me=this,Te=a,De=a,Me=a,Pe=a,Ve=a;if(delete he.$$p,q=E.slice.call(arguments),w(O)?(w(q.length>2)&&H.$raise(y("ArgumentError"),"wrong number of arguments ("+q.$length()+" for 0..2)"),Te=null==(pe=g(q))[0]?a:pe[0],De=null==pe[1]?a:pe[1]):(w(0==q.length)?H.$raise(y("ArgumentError"),"wrong number of arguments (0 for 1..3)"):w(q.length>3)&&H.$raise(y("ArgumentError"),"wrong number of arguments ("+q.$length()+" for 1..3)"),Me=null==(pe=g(q))[0]?a:pe[0],Te=null==pe[1]?a:pe[1],De=null==pe[2]?a:pe[2]),ue(y("Range"),Te)){if(w(De)&&H.$raise(y("TypeError"),"length invalid with range"),Pe=Te.begin===a?0:F(Te.begin,y("Integer"),"to_int"),w(Pe<0)&&(Pe+=this.length),w(Pe<0)&&H.$raise(y("RangeError"),Te.$inspect()+" out of range"),Ve=Te.end===a?-1:F(Te.end,y("Integer"),"to_int"),w(Ve<0)&&(Ve+=this.length),w(Te["$exclude_end?"]())||(Ve+=1),w(Ve<=Pe))return me}else if(w(Te))if(Pe=F(Te,y("Integer"),"to_int"),w(Pe<0)&&(Pe+=this.length),w(Pe<0)&&(Pe=0),w(De)){if(Ve=F(De,y("Integer"),"to_int"),w(0==Ve))return me;Ve+=Pe}else Ve=this.length;else Pe=0,Ve=this.length;if(w(Pe>this.length))for(Qe=this.length;Qe<Ve;Qe++)me[Qe]=a;if(w(Ve>this.length)&&(this.length=Ve),w(O))for(;Pe<Ve;Pe++)Bt=O(Pe),me[Pe]=Bt;else for(;Pe<Ve;Pe++)me[Pe]=Me;return me},-1),U(S,"$first",function(B){var O=this;return null==B?0===O.length?a:O[0]:((B=F(B,y("Integer"),"to_int"))<0&&H.$raise(y("ArgumentError"),"negative array size"),O.slice(0,B))},-1),U(S,"$flatten",function(B){var O=this;return void 0!==B&&(B=F(B,y("Integer"),"to_int")),function ne(q,pe){var me,Te,De,Me,$e=[];for(me=0,Te=(q=q.$to_a()).length;me<Te;me++)if(oe(De=q[me],"$to_ary",!0))if((Me=De.$to_ary())!==a)switch(Me.$$is_array||H.$raise(y("TypeError")),Me===O&&H.$raise(y("ArgumentError")),pe){case void 0:$e=$e.concat(ne(Me));break;case 0:$e.push(Me);break;default:$e.push.apply($e,ne(Me,pe-1))}else $e.push(De);else $e.push(De);return $e}(O,B)},-1),U(S,"$flatten!",function(B){var O=this,ne=O.$flatten(B);if(O.length==ne.length){for(var q=0,pe=O.length;q<pe&&O[q]===ne[q];q++);if(q==pe)return a}return O.$replace(ne),O},-1),U(S,"$hash",function(){var $e,me,B=this,O=void 0===u,ne=["A"],q=B.$object_id();try{if(O&&(u=Object.create(null)),u[q])return"self";for(me in u)if(B["$eql?"](u[me]))return"self";for(u[q]=B,$e=0;$e<B.length;$e++)ne.push(B[$e].$hash());return ne.join(",")}finally{O&&(u=void 0)}},0),U(S,"$include?",function(B){for(var ne=0,q=this.length;ne<q;ne++)if(this[ne]["$=="](B))return!0;return!1},1),U(S,"$index",function he(B){var q,pe,$e,O=he.$$p||a,ne=this;if(delete he.$$p,null!=B&&O!==a&&ne.$warn("warning: given block not used"),null!=B){for(q=0,pe=ne.length;q<pe;q++)if(ne[q]["$=="](B))return q}else{if(O===a)return ne.$enum_for("index");for(q=0,pe=ne.length;q<pe;q++)if(!1!==($e=O(ne[q]))&&$e!==a)return q}return a},-1),U(S,"$insert",function(B,O){var q,pe=this;if(q=E.slice.call(arguments,1),B=F(B,y("Integer"),"to_int"),q.length>0){if(B<0&&(B+=pe.length+1)<0&&H.$raise(y("IndexError"),B+" is out of bounds"),B>pe.length)for(var $e=pe.length;$e<B;$e++)pe.push(a);pe.splice.apply(pe,[B,0].concat(q))}return pe},-2);var O,we=[];return U(S,"$inspect",function(){var B=this,O=[],ne=B.$__id__(),q=!0;return function(){try{if(-1!==we.indexOf(ne))return q=!1,"[...]";we.push(ne);for(var pe=0,$e=B.length;pe<$e;pe++){var me=B["$[]"](pe);O.push(le("Opal").$inspect(me))}return"["+O.join(", ")+"]"}finally{q&&we.pop()}}()},0),U(S,"$intersection",function(B){var O,q=this;return O=E.slice.call(arguments),M(O,"reduce",[q.$to_a().$dup()],function($e,me){return null==$e&&($e=a),null==me&&(me=a),$e["$&"](me)},2)},-1),U(S,"$intersect?",function(B){return this.$intersection(B)["$empty?"]()["$!"]()},1),U(S,"$join",function(B){var O=this;if(null==b[","]&&(b[","]=a),null==B&&(B=a),w(0===O.length))return"";w(B===a)&&(B=b[","]);var q,pe,$e,me,ne=[];for(q=0,pe=O.length;q<pe;q++)oe($e=O[q],"$to_str")&&(me=$e.$to_str())!==a?ne.push(me.$to_s()):oe($e,"$to_ary")&&((me=$e.$to_ary())===O&&H.$raise(y("ArgumentError")),me!==a)?ne.push(me.$join(B)):oe($e,"$to_s")&&(me=$e.$to_s())!==a?ne.push(me):H.$raise(y("NoMethodError").$new(le("Opal").$inspect(O.$item())+" doesn't respond to #to_str, #to_ary or #to_s","to_str"));return ne.join(B===a?"":se["$coerce_to!"](B,y("String"),"to_str").$to_s())},-1),U(S,"$keep_if",function he(){var B=he.$$p||a,O=this;return delete he.$$p,B===a?M(O,"enum_for",["keep_if"],function ne(){return(null==ne.$$s?this:ne.$$s).$size()},{$$arity:0,$$s:O}):(R(O,w,B),O)},0),U(S,"$last",function(B){var O=this;return null==B?0===O.length?a:O[O.length-1]:((B=F(B,y("Integer"),"to_int"))<0&&H.$raise(y("ArgumentError"),"negative array size"),B>O.length&&(B=O.length),O.slice(O.length-B,O.length))},-1),U(S,"$length",function(){return this.length},0),U(S,"$max",function he(B){var O=he.$$p||a;return delete he.$$p,M(this.$each(),"max",[B],O.$to_proc())},-1),U(S,"$min",function he(){var B=he.$$p||a;return delete he.$$p,M(this.$each(),"min",[],B.$to_proc())},0),U(S,"$permutation",function he(B){var $e,me,Te,O=he.$$p||a,ne=this,q=a,pe=a;if(delete he.$$p,O===a)return M(ne,"enum_for",["permutation",B],function Me(){var Pe=null==Me.$$s?this:Me.$$s;return function ce(he,B){for(var O=B>=0?1:0;B;)O*=he,he--,B--;return O}(Pe.length,void 0===B?Pe.length:B)},{$$arity:0,$$s:ne});if(!((B=void 0===B?ne.length:F(B,y("Integer"),"to_int"))<0||ne.length<B))if(0===B)E.yield1(O,[]);else if(1===B)for(var De=0;De<ne.length;De++)E.yield1(O,[ne[De]]);else q=le("Array").$new(B),pe=le("Array").$new(ne.length,!1),$e=function(Me,Pe,Ve,Qe,Mt){ne=this;for(var Bt=0;Bt<ne.length;Bt++)if(Qe["$[]"](Bt)["$!"]())if(Pe[Ve]=Bt,Ve<Me-1)Qe[Bt]=!0,$e.call(ne,Me,Pe,Ve+1,Qe,Mt),Qe[Bt]=!1;else{Te=[];for(var Pt=0;Pt<Pe.length;Pt++)Te.push(ne[Pe[Pt]]);k(Mt,Te)}},O!==a?(me=ne.slice(),$e.call(me,B,q,0,pe,O)):$e.call(ne,B,q,0,pe,O);return ne},-1),U(S,"$repeated_permutation",function he(B){var q,O=he.$$p||a;return delete he.$$p,q=se["$coerce_to!"](B,y("Integer"),"to_int"),O===a?M(this,"enum_for",["repeated_permutation",q],function $e(){var me=null==$e.$$s?this:$e.$$s;return w(C(q,0))?me.$size()["$**"](q):0},{$$arity:0,$$s:this}):(function pe($e,me,Te){if(me.length!=$e)for(var Me=0;Me<Te.length;Me++)me.push(Te[Me]),pe($e,me,Te),me.pop();else{var De=me.slice();E.yield1(O,De)}}(q,[],this.slice()),this)},1),U(S,"$pop",function(B){var O=this;return w(void 0===B)?w(0===O.length)?a:O.pop():(B=F(B,y("Integer"),"to_int"),w(B<0)&&H.$raise(y("ArgumentError"),"negative array size"),w(0===O.length)?[]:w(1===B)?[O.pop()]:w(B>O.length)?O.splice(0,O.length):O.splice(O.length-B,O.length))},-1),U(S,"$product",function he(B){var ne,q,O=he.$$p||a,pe=this;delete he.$$p,ne=E.slice.call(arguments);var Pe,Ve,Qe,Mt,$e=O!==a?null:[],me=(q=ne).length+1,Te=new Array(me),De=new Array(me),Me=new Array(me),Bt=1;for(Me[0]=pe,Pe=1;Pe<me;Pe++)Me[Pe]=F(q[Pe-1],y("Array"),"to_ary");for(Pe=0;Pe<me;Pe++){if(0===(Mt=Me[Pe].length))return $e||pe;(Bt*=Mt)>2147483647&&H.$raise(y("RangeError"),"too big to product"),De[Pe]=Mt,Te[Pe]=0}e:for(;;){for(Qe=[],Pe=0;Pe<me;Pe++)Qe.push(Me[Pe][Te[Pe]]);for($e?$e.push(Qe):E.yield1(O,Qe),Te[Ve=me-1]++;Te[Ve]===De[Ve];){if(Te[Ve]=0,--Ve<0)break e;Te[Ve]++}}return $e||pe},-1),U(S,"$push",function(B){for(var ne,q=this,pe=0,$e=(ne=E.slice.call(arguments)).length;pe<$e;pe++)q.push(ne[pe]);return q},-1),U(S,"$rassoc",function(B){for(var pe,ne=0,q=this.length;ne<q;ne++)if((pe=this[ne]).length&&void 0!==pe[1]&&pe[1]["$=="](B))return pe;return a},1),U(S,"$reject",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["reject"],function me(){return(null==me.$$s?this:me.$$s).$size()},{$$arity:0,$$s:O});for(var $e,ne=[],q=0,pe=O.length;q<pe;q++)(!1===($e=B(O[q]))||$e===a)&&ne.push(O[q]);return ne},0),U(S,"$reject!",function he(){var B=he.$$p||a,O=this,ne=a;return delete he.$$p,B===a?M(O,"enum_for",["reject!"],function q(){return(null==q.$$s?this:q.$$s).$size()},{$$arity:0,$$s:O}):(ne=O.$length(),M(O,"delete_if",[],B.$to_proc()),A(O.$length(),ne)?a:O)},0),U(S,"$replace",function(B){var O=this;return B=ue(y("Array"),B)?B.$to_a():F(B,y("Array"),"to_ary").$to_a(),O.splice(0,O.length),O.push.apply(O,B),O},1),U(S,"$reverse",function(){return this.slice(0).reverse()},0),U(S,"$reverse!",function(){return this.reverse()},0),U(S,"$reverse_each",function he(){var B=he.$$p||a,O=this;return delete he.$$p,B===a?M(O,"enum_for",["reverse_each"],function ne(){return(null==ne.$$s?this:ne.$$s).$size()},{$$arity:0,$$s:O}):(M(O.$reverse(),"each",[],B.$to_proc()),O)},0),U(S,"$rindex",function he(B){var q,pe,O=he.$$p||a,ne=this;if(delete he.$$p,null!=B&&O!==a&&ne.$warn("warning: given block not used"),null!=B){for(q=ne.length-1;q>=0&&!(q>=ne.length);q--)if(ne[q]["$=="](B))return q}else if(O!==a){for(q=ne.length-1;q>=0&&!(q>=ne.length);q--)if(!1!==(pe=O(ne[q]))&&pe!==a)return q}else if(null==B)return ne.$enum_for("rindex");return a},-1),U(S,"$rotate",function(B){var ne,q,pe,$e,O=this;return null==B&&(B=1),B=F(B,y("Integer"),"to_int"),1===O.length?O.slice():0===O.length?[]:(pe=(ne=O.slice()).slice(q=B%ne.length),$e=ne.slice(0,q),pe.concat($e))},-1),U(S,"$rotate!",function(B){var O=this,ne=a;return null==B&&(B=1),0===O.length||1===O.length?O:(B=F(B,y("Integer"),"to_int"),ne=O.$rotate(B),O.$replace(ne))},-1),(O=V(S,null,"SampleRandom")).$$prototype.rng=a,U(O,"$initialize",function(pe){return this.rng=pe},1),U(O,"$rand",function(pe){var me;return me=F(this.rng.$rand(pe),y("Integer"),"to_int"),w(me<0)&&H.$raise(y("RangeError"),"random value must be >= 0"),w(me<pe)||H.$raise(y("RangeError"),"random value must be less than Array size"),me},1),U(S,"$sample",function(B,O){var $e,me,Te,De,Me,Pe,Ve,Qe,ne=this,q=a,pe=a;if(w(void 0===B))return ne.$at(H.$rand(ne.length));if(w(void 0===O)?w(q=se["$coerce_to?"](B,y("Hash"),"to_hash"))?(O=q,B=a):(O=a,B=F(B,y("Integer"),"to_int")):(B=F(B,y("Integer"),"to_int"),O=F(O,y("Hash"),"to_hash")),w(B)&&w(B<0)&&H.$raise(y("ArgumentError"),"count must be greater than 0"),w(O)&&(pe=O["$[]"]("random")),pe=w(pe)&&w(pe["$respond_to?"]("rand"))?le("SampleRandom").$new(pe):H,!w(B))return ne[pe.$rand(ne.length)];switch(B>ne.length&&(B=ne.length),B){case 0:return[];case 1:return[ne[pe.$rand(ne.length)]];case 2:return(De=pe.$rand(ne.length))===(Me=pe.$rand(ne.length))&&(Me=0===De?De+1:De-1),[ne[De],ne[Me]];default:if(ne.length/B>3){for($e=!1,me=0,De=1,(Te=le("Array").$new(B))[0]=pe.$rand(ne.length);De<B;){for(Pe=pe.$rand(ne.length),Me=0;Me<De;){for(;Pe===Te[Me];){if(++me>100){$e=!0;break}Pe=pe.$rand(ne.length)}if($e)break;Me++}if($e)break;Te[De]=Pe,De++}if(!$e){for(De=0;De<B;)Te[De]=ne[Te[De]],De++;return Te}}Te=ne.slice();for(var Mt=0;Mt<B;Mt++)Ve=pe.$rand(ne.length),Qe=Te[Mt],Te[Mt]=Te[Ve],Te[Ve]=Qe;return B===ne.length?Te:Te["$[]"](0,B)}},-1),U(S,"$select",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["select"],function Te(){return(null==Te.$$s?this:Te.$$s).$size()},{$$arity:0,$$s:O});for(var $e,me,ne=[],q=0,pe=O.length;q<pe;q++)me=k(B,$e=O[q]),w(me)&&ne.push($e);return ne},0),U(S,"$select!",function he(){var B=he.$$p||a,O=this;if(delete he.$$p,B===a)return M(O,"enum_for",["select!"],function q(){return(null==q.$$s?this:q.$$s).$size()},{$$arity:0,$$s:O});var ne=O.length;return M(O,"keep_if",[],B.$to_proc()),O.length===ne?a:O},0),U(S,"$shift",function(B){var O=this;return w(void 0===B)?w(0===O.length)?a:function ye(he){for(var B=he[0],O=1,ne=he.length;O<ne;O++)he[O-1]=he[O];return he.pop(),B}(O):(B=F(B,y("Integer"),"to_int"),w(B<0)&&H.$raise(y("ArgumentError"),"negative array size"),w(0===O.length)?[]:O.splice(0,B))},-1),U(S,"$shuffle",function(B){return this.$dup().$to_a()["$shuffle!"](B)},-1),U(S,"$shuffle!",function(B){var ne,pe,$e,O=this,q=O.length;for(void 0!==B&&(B=se["$coerce_to?"](B,y("Hash"),"to_hash"))!==a&&(B=B["$[]"]("random"))!==a&&B["$respond_to?"]("rand")&&(ne=B);q;)ne?((pe=ne.$rand(q).$to_int())<0&&H.$raise(y("RangeError"),"random number too small "+pe),pe>=q&&H.$raise(y("RangeError"),"random number too big "+pe)):pe=O.$rand(q),$e=O[--q],O[q]=O[pe],O[pe]=$e;return O},-1),U(S,"$slice!",function(B,O){var ne=this,q=a,pe=a,$e=a,me=a,Te=a;if(q=a,w(void 0===O))if(ue(y("Range"),B)){q=ne["$[]"](pe=B),$e=pe.begin===a?0:F(pe.begin,y("Integer"),"to_int"),me=pe.end===a?-1:F(pe.end,y("Integer"),"to_int"),$e<0&&($e+=ne.length),me<0?me+=ne.length:me>=ne.length&&(me=ne.length-1,pe.excl&&(me+=1));var De=me-$e;pe.excl&&pe.end!==a?me-=1:De+=1,$e<ne.length&&$e>=0&&me<ne.length&&me>=0&&De>0&&ne.splice($e,De)}else{if((Te=F(B,y("Integer"),"to_int"))<0&&(Te+=ne.length),Te<0||Te>=ne.length)return a;q=ne[Te],0===Te?ne.shift():ne.splice(Te,1)}else{if(Te=F(B,y("Integer"),"to_int"),(O=F(O,y("Integer"),"to_int"))<0)return a;q=ne["$[]"](Te,O),Te<0&&(Te+=ne.length),Te+O>ne.length&&(O=ne.length-Te),Te<ne.length&&Te>=0&&ne.splice(Te,O)}return q},-2),U(S,"$sort",function he(){var B=he.$$p||a,O=this;return delete he.$$p,w(O.length>1)?(B===a&&(B=function(ne,q){return ne["$<=>"](q)}),O.slice().sort(function(ne,q){var pe=B(ne,q);return pe===a&&H.$raise(y("ArgumentError"),"comparison of "+ne.$inspect()+" with "+q.$inspect()+" failed"),G(pe,0)?1:h(pe,0)?-1:0})):O},0),U(S,"$sort!",function he(){var ne,B=he.$$p||a,O=this;delete he.$$p,ne=B!==a?M(O.slice(),"sort",[],B.$to_proc()):O.slice().$sort(),O.length=0;for(var q=0,pe=ne.length;q<pe;q++)O.push(ne[q]);return O},0),U(S,"$sort_by!",function he(){var B=he.$$p||a,O=this;return delete he.$$p,B===a?M(O,"enum_for",["sort_by!"],function ne(){return(null==ne.$$s?this:ne.$$s).$size()},{$$arity:0,$$s:O}):O.$replace(M(O,"sort_by",[],B.$to_proc()))},0),U(S,"$take",function(B){return B<0&&H.$raise(y("ArgumentError")),this.slice(0,B)},1),U(S,"$take_while",function he(){var B=he.$$p||a;delete he.$$p;for(var $e,me,ne=[],q=0,pe=this.length;q<pe;q++){if(!1===(me=B($e=this[q]))||me===a)return ne;ne.push($e)}return ne},0),U(S,"$to_a",function(){var B=this;return B.$$class===E.Array?B:E.Array.$new(B)},0),U(S,"$to_ary",function(){return this},0),U(S,"$to_h",function he(){var B=he.$$p||a,ne=a;delete he.$$p,ne=this,B!==a&&(ne=M(ne,"map",[],B.$to_proc()));var q,$e,pe=ne.length,De=J([],{});for(q=0;q<pe;q++)($e=se["$coerce_to?"](ne[q],y("Array"),"to_ary")).$$is_array||H.$raise(y("TypeError"),"wrong element type "+$e.$class()+" at "+q+" (expected array)"),2!==$e.length&&H.$raise(y("ArgumentError"),"wrong array length at "+q+" (expected 2, was "+$e.$length()+")"),D(De,$e[0],$e[1]);return De},0),U(S,"$transpose",function(){var O=a,ne=a;return w(this["$empty?"]())?[]:(O=[],ne=a,M(this,"each",[],function(pe){var $e=a;return null==pe&&(pe=a),pe=ue(y("Array"),pe)?pe.$to_a():F(pe,y("Array"),"to_ary").$to_a(),ne=w($e=ne)?$e:pe.length,c(pe.length,ne)&&H.$raise(y("IndexError"),"element size differs ("+pe.length+" should be "+ne+")"),M(pe.length,"times",[],function(Te){var Me=a;return null==Te&&(Te=a),(w($e=O["$[]"](Te))?$e:(M(O,"[]=",P(Me=[Te,[]])),Me[N(Me.length,1)]))["$<<"](pe.$at(Te))},1)},1),O)},0),U(S,"$union",function(B){var O,q=this;return O=E.slice.call(arguments),M(O,"reduce",[q.$uniq()],function($e,me){return null==$e&&($e=a),null==me&&(me=a),$e["$|"](me)},2)},-1),U(S,"$uniq",function he(){var B=he.$$p||a,O=this;delete he.$$p;var q,pe,$e,me,ne=J([],{});if(B===a)for(q=0,pe=O.length;q<pe;q++)void 0===v(ne,$e=O[q])&&D(ne,$e,$e);else for(q=0,pe=O.length;q<pe;q++)me=k(B,$e=O[q]),void 0===v(ne,me)&&D(ne,me,$e);return ne.$values()},0),U(S,"$uniq!",function he(){var B=he.$$p||a,O=this;delete he.$$p;var pe,$e,me,Te,ne=O.length,q=J([],{});for(pe=0,$e=ne;pe<$e;pe++)me=O[pe],Te=B===a?me:k(B,me),void 0!==v(q,Te)?(O.splice(pe,1),$e--,pe--):D(q,Te,me);return O.length===ne?a:O},0),U(S,"$unshift",function(B){var O,ne,q=this;O=E.slice.call(arguments);var pe=q.length,$e=(ne=O).length;if(0==$e)return q;for(var me=pe-$e,Te=0;Te<$e;Te++)q.push(q[me+Te]);for(var De=pe-1;De-$e>=0;)q[De]=q[De-$e],De--;for(var Me=0;Me<$e;Me++)q[Me]=ne[Me];return q},-1),U(S,"$values_at",function(B){var O,q=this,pe=a;return O=E.slice.call(arguments),pe=[],M(O,"each",[],function $e(me){var Te=null==$e.$$s?this:$e.$$s,De=a,Me=a,Pe=a;return null==me&&(me=a),w(me["$is_a?"](y("Range")))?(De=me.$end()===a?-1:F(me.$end(),y("Integer"),"to_int"),(Me=me.$begin()===a?0:F(me.$begin(),y("Integer"),"to_int"))<0?(Me+=Te.length,a):(De<0&&(De+=Te.length),me["$exclude_end?"]()&&me.$end()!==a&&De--,De<Me?a:M(Me,"upto",[De],function Ve(Qe){return null==Qe&&(Qe=a),pe["$<<"]((null==Ve.$$s?this:Ve.$$s).$at(Qe))},{$$arity:1,$$s:Te}))):(Pe=F(me,y("Integer"),"to_int"),pe["$<<"](Te.$at(Pe)))},{$$arity:1,$$s:q}),pe},-1),U(S,"$zip",function he(B){var ne,q,O=he.$$p||a,pe=this,$e=a;delete he.$$p,ne=E.slice.call(arguments);var De,Me,Pe,Ve,Qe,me=[],Te=pe.length;for(Ve=0,Qe=(q=ne).length;Ve<Qe;Ve++)if(!(Me=q[Ve]).$$is_array){if(Me.$$is_range||Me.$$is_enumerator){q[Ve]=Me.$take(Te);continue}q[Ve]=(w($e=se["$coerce_to?"](Me,y("Array"),"to_ary"))?$e:se["$coerce_to!"](Me,y("Enumerator"),"to_enum","each")).$to_a()}for(Pe=0;Pe<Te;Pe++){for(De=[pe[Pe]],Ve=0,Qe=q.length;Ve<Qe;Ve++)null==(Me=q[Ve][Pe])&&(Me=a),De[Ve+1]=Me;me[Pe]=De}if(O!==a){for(Pe=0;Pe<Te;Pe++)E.yield1(O,me[Pe]);return a}return me},-1),L(S,"$inherited",function(B){B.$$prototype.$to_a=function(){return this.slice(0,this.length)}},1),U(S,"$instance_variables",function he(){var B=he.$$p||a;return delete he.$$p,M(K(this,ee(this,"instance_variables",he,!1,!0),"instance_variables",[],B),"reject",[],function(q){var pe;return null==q&&(q=a),w(pe=/^@\d+$/.test(q))?pe:q["$=="]("@length")},1)},0),U(S,"$pack",function(B){return E.slice.call(arguments),H.$raise("To use Array#pack, you must first require 'corelib/array/pack'.")},-1),l(S,"append","push"),l(S,"filter","select"),l(S,"filter!","select!"),l(S,"map","collect"),l(S,"map!","collect!"),l(S,"prepend","unshift"),l(S,"size","length"),l(S,"slice","[]"),l(S,"to_s","inspect"),se.$pristine(S.$singleton_class(),"allocate"),se.$pristine(S,"copy_instance_variables","initialize_dup")}()},Opal.modules["corelib/hash"]=function(E){var A,b,N,P,g,a=E.nil,y=E.$$$,w=E.yield1,p=E.hash,u=E.hash_init,k=E.hash_get,v=E.hash_put,D=E.hash_delete,_=E.klass,F=E.Opal,oe=E.Kernel,V=E.defs,L=E.def,H=E.send,U=E.rb_ge,se=E.rb_gt,ue=E.hash2,J=E.truthy,K=E.to_a,ee=E.rb_minus,M=E.alias;return E.top.$require("corelib/enumerable"),A=[],P=[N=_("::",null,"Hash")].concat(A),g=E.$r(P),N.$include(y("Enumerable")),N.$$prototype.$$is_hash=!0,V(N,"$[]",function(h){var l,m,S,f=this,x=(l=E.slice.call(arguments)).length;if(1===x){if((m=F["$coerce_to?"](l["$[]"](0),y("Hash"),"to_hash"))!==a)return f.$allocate()["$merge!"](m);for((l=F["$coerce_to?"](l["$[]"](0),y("Array"),"to_ary"))===a&&oe.$raise(y("ArgumentError"),"odd number of arguments for Hash"),x=l.length,m=f.$allocate(),S=0;S<x;S++)if(l[S].$$is_array)switch(l[S].length){case 1:m.$store(l[S][0],a);break;case 2:m.$store(l[S][0],l[S][1]);break;default:oe.$raise(y("ArgumentError"),"invalid number of elements ("+l[S].length+" for 1..2)")}return m}for(x%2!=0&&oe.$raise(y("ArgumentError"),"odd number of arguments for Hash"),m=f.$allocate(),S=0;S<x;S+=2)m.$store(l[S],l[S+1]);return m},-1),V(N,"$allocate",function(){var c=new this.$$constructor;return u(c),c.$$none=a,c.$$proc=a,c},0),V(N,"$try_convert",function(h){return F["$coerce_to?"](h,y("Hash"),"to_hash")},1),L(N,"$initialize",function C(h){var c=C.$$p||a,l=this;return delete C.$$p,void 0!==h&&c!==a&&oe.$raise(y("ArgumentError"),"wrong number of arguments (1 for 0)"),l.$$none=void 0===h?a:h,l.$$proc=c,l},-1),L(N,"$==",function(h){var c=this;if(c===h)return!0;if(!h.$$is_hash||c.$$keys.length!==h.$$keys.length)return!1;for(var x,S,Z,l=0,f=c.$$keys,m=f.length;l<m;l++)if((x=f[l]).$$is_string?(S=c.$$smap[x],Z=h.$$smap[x]):(S=x.value,Z=k(h,x.key)),void 0===Z||!S["$eql?"](Z))return!1;return!0},1),L(N,"$>=",function(h){var l=a;return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),!(this.$$keys.length<h.$$keys.length)&&(l=!0,H(h,"each",[],function f(m,x){var Z;null==m&&(m=a),null==x&&(x=a),null!=(Z=(null==f.$$s?this:f.$$s).$fetch(m,null))&&Z===x||(l=!1)},{$$arity:2,$$s:this}),l)},1),L(N,"$>",function(h){return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),!(this.$$keys.length<=h.$$keys.length)&&U(this,h)},1),L(N,"$<",function(h){return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),se(h,this)},1),L(N,"$<=",function(h){return h=F["$coerce_to!"](h,y("Hash"),"to_hash"),U(h,this)},1),L(N,"$[]",function(h){var l=k(this,h);return void 0!==l?l:this.$default(h)},1),L(N,"$[]=",function(h,c){return v(this,h,c),c},2),L(N,"$assoc",function(h){for(var x,l=0,f=this.$$keys,m=f.length;l<m;l++)if((x=f[l]).$$is_string){if(x["$=="](h))return[x,this.$$smap[x]]}else if(x.key["$=="](h))return[x.key,x.value];return a},1),L(N,"$clear",function(){return u(this),this},0),L(N,"$clone",function(){var c=new this.$$class;return u(c),E.hash_clone(this,c),c},0),L(N,"$compact",function(){for(var x,S,c=p(),l=0,f=this.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),S!==a&&v(c,x,S);return c},0),L(N,"$compact!",function(){for(var x,S,h=this,c=!1,l=0,f=h.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=h.$$smap[x]:(S=x.value,x=x.key),S===a&&void 0!==D(h,x)&&(c=!0,m--,l--);return c?h:a},0),L(N,"$compare_by_identity",function(){var c,l,f,x,h=this,m=h.$$keys;if(h.$$by_identity)return h;if(0===h.$$keys.length)return h.$$by_identity=!0,h;for(x=ue([],{}).$compare_by_identity(),c=0,l=m.length;c<l;c++)(f=m[c]).$$is_string||(f=f.key),v(x,f,k(h,f));return h.$$by_identity=!0,h.$$map=x.$$map,h.$$smap=x.$$smap,h},0),L(N,"$compare_by_identity?",function(){return!0===this.$$by_identity},0),L(N,"$default",function(h){var c=this;return void 0!==h&&c.$$proc!==a&&void 0!==c.$$proc?c.$$proc.$call(c,h):void 0===c.$$none?a:c.$$none},-1),L(N,"$default=",function(h){return this.$$proc=a,this.$$none=h,h},1),L(N,"$default_proc",function(){return void 0!==this.$$proc?this.$$proc:a},0),L(N,"$default_proc=",function(h){var l=h;return l!==a&&(l=F["$coerce_to!"](l,y("Proc"),"to_proc"))["$lambda?"]()&&2!==l.$arity().$abs()&&oe.$raise(y("TypeError"),"default_proc takes two arguments"),this.$$none=a,this.$$proc=l,h},1),L(N,"$delete",function C(h){var c=C.$$p||a;delete C.$$p;var f=D(this,h);return void 0!==f?f:c!==a?E.yield1(c,h):a},1),L(N,"$delete_if",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["delete_if"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:c});for(var x,S,Z,l=0,f=c.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=c.$$smap[x]:(S=x.value,x=x.key),!1!==(Z=h(x,S))&&Z!==a&&void 0!==D(c,x)&&(m--,l--);return c},0),L(N,"$dig",function(h,c){var f,m=this,x=a;return f=E.slice.call(arguments,1),(x=m["$[]"](h))===a||0===f.length?x:(J(x["$respond_to?"]("dig"))||oe.$raise(y("TypeError"),x.$class()+" does not have #dig method"),H(x,"dig",K(f)))},-2),L(N,"$each",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["each"],function Z(){return(null==Z.$$s?this:Z.$$s).$size()},{$$arity:0,$$s:c});for(var x,S,l=0,f=c.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=c.$$smap[x]:(S=x.value,x=x.key),w(h,[x,S]);return c},0),L(N,"$each_key",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["each_key"],function S(){return(null==S.$$s?this:S.$$s).$size()},{$$arity:0,$$s:c});for(var x,l=0,f=c.$$keys,m=f.length;l<m;l++)h((x=f[l]).$$is_string?x:x.key);return c},0),L(N,"$each_value",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["each_value"],function S(){return(null==S.$$s?this:S.$$s).$size()},{$$arity:0,$$s:c});for(var x,l=0,f=c.$$keys,m=f.length;l<m;l++)h((x=f[l]).$$is_string?c.$$smap[x]:x.value);return c},0),L(N,"$empty?",function(){return 0===this.$$keys.length},0),L(N,"$except",function(h){var l,f=this;return l=E.slice.call(arguments),H(f.$dup(),"except!",K(l))},-1),L(N,"$except!",function(h){var c,f=this;return c=E.slice.call(arguments),H(c,"each",[],function m(x){return null==x&&(x=a),(null==m.$$s?this:m.$$s).$delete(x)},{$$arity:1,$$s:f}),f},-1),L(N,"$fetch",function C(h,c){var l=C.$$p||a;delete C.$$p;var m=k(this,h);return void 0!==m?m:l!==a?l(h):void 0!==c?c:oe.$raise(y("KeyError").$new("key not found: "+h.$inspect(),ue(["key","receiver"],{key:h,receiver:this})))},-2),L(N,"$fetch_values",function C(h){var l,c=C.$$p||a,m=this;return delete C.$$p,l=E.slice.call(arguments),H(l,"map",[],function x(S){return null==S&&(S=a),H(null==x.$$s?this:x.$$s,"fetch",[S],c.$to_proc())},{$$arity:1,$$s:m})},-1),L(N,"$flatten",function(h){null==h&&(h=1),h=F["$coerce_to!"](h,y("Integer"),"to_int");for(var S,Z,l=[],f=0,m=this.$$keys,x=m.length;f<x;f++)if((S=m[f]).$$is_string?Z=this.$$smap[S]:(Z=S.value,S=S.key),l.push(S),Z.$$is_array){if(1===h){l.push(Z);continue}l=l.concat(Z.$flatten(h-2))}else l.push(Z);return l},-1),L(N,"$has_key?",function(h){return void 0!==k(this,h)},1),L(N,"$has_value?",function(h){for(var x,l=0,f=this.$$keys,m=f.length;l<m;l++)if(((x=f[l]).$$is_string?this.$$smap[x]:x.value)["$=="](h))return!0;return!1},1),L(N,"$hash",function(){var m,h=this,c=void 0===E.hash_ids,l=h.$object_id(),f=["Hash"];try{if(c&&(E.hash_ids=Object.create(null)),E[l])return"self";for(m in E.hash_ids)if(h["$eql?"](E.hash_ids[m]))return"self";E.hash_ids[l]=h;for(var S=0,Z=h.$$keys,le=Z.length;S<le;S++)f.push((m=Z[S]).$$is_string?[m,h.$$smap[m].$hash()]:[m.key_hash,m.value.$hash()]);return f.sort().join()}finally{c&&(E.hash_ids=void 0)}},0),L(N,"$index",function(h){for(var x,S,l=0,f=this.$$keys,m=f.length;l<m;l++)if((x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),S["$=="](h))return x;return a},1),L(N,"$indexes",function(h){for(var l,le,f=this,m=[],x=0,S=(l=E.slice.call(arguments)).length;x<S;x++)void 0!==(le=k(f,l[x]))?m.push(le):m.push(f.$default());return m},-1),L(N,"$inspect",function(){var h=this,c=void 0===b,l=h.$object_id(),f=[];return function(){try{if(c&&(b={}),b.hasOwnProperty(l))return"{...}";b[l]=!0;for(var Z,le,m=0,x=h.$$keys,S=x.length;m<S;m++)(Z=x[m]).$$is_string?le=h.$$smap[Z]:(le=Z.value,Z=Z.key),Z=g("Opal").$inspect(Z),le=g("Opal").$inspect(le),f.push(Z+"=>"+le);return"{"+f.join(", ")+"}"}finally{c&&(b=void 0)}}()},0),L(N,"$invert",function(){for(var x,S,c=p(),l=0,f=this.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),v(c,S,x);return c},0),L(N,"$keep_if",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["keep_if"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:c});for(var x,S,Z,l=0,f=c.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=c.$$smap[x]:(S=x.value,x=x.key),(!1===(Z=h(x,S))||Z===a)&&void 0!==D(c,x)&&(m--,l--);return c},0),L(N,"$keys",function(){for(var x,c=[],l=0,f=this.$$keys,m=f.length;l<m;l++)c.push((x=f[l]).$$is_string?x:x.key);return c},0),L(N,"$length",function(){return this.$$keys.length},0),L(N,"$merge",function C(h){var f,c=C.$$p||a,m=this;return delete C.$$p,f=E.slice.call(arguments),H(m.$dup(),"merge!",K(f),c.$to_proc())},-1),L(N,"$merge!",function C(h){var f,x,S,Z,le,ye,T,R,ie,c=C.$$p||a,m=this;for(delete C.$$p,f=E.slice.call(arguments),x=0;x<f.length;++x)if(ye=(le=(Z=F["$coerce_to!"](f[x],y("Hash"),"to_hash")).$$keys).length,c===a)for(S=0;S<ye;S++)(T=le[S]).$$is_string?ie=Z.$$smap[T]:(ie=T.value,T=T.key),v(m,T,ie);else for(S=0;S<ye;S++)(T=le[S]).$$is_string?ie=Z.$$smap[T]:(ie=T.value,T=T.key),void 0!==(R=k(m,T))?v(m,T,c(T,R,ie)):v(m,T,ie);return m},-1),L(N,"$rassoc",function(h){for(var x,S,l=0,f=this.$$keys,m=f.length;l<m;l++)if((x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),S["$=="](h))return[x,S];return a},1),L(N,"$rehash",function(){return E.hash_rehash(this),this},0),L(N,"$reject",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["reject"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$arity:0,$$s:c});for(var S,Z,le,l=p(),f=0,m=c.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?Z=c.$$smap[S]:(Z=S.value,S=S.key),(!1===(le=h(S,Z))||le===a)&&v(l,S,Z);return l},0),L(N,"$reject!",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["reject!"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$arity:0,$$s:c});for(var S,Z,le,l=!1,f=0,m=c.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?Z=c.$$smap[S]:(Z=S.value,S=S.key),!1!==(le=h(S,Z))&&le!==a&&void 0!==D(c,S)&&(l=!0,x--,f--);return l?c:a},0),L(N,"$replace",function(h){var c=this,l=a;h=F["$coerce_to!"](h,y("Hash"),"to_hash"),u(c);for(var S,le,f=0,m=h.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?le=h.$$smap[S]:(le=S.value,S=S.key),v(c,S,le);return J(h.$default_proc())?(l=[h.$default_proc()],H(c,"default_proc=",K(l)),ee(l.length,1)):(l=[h.$default()],H(c,"default=",K(l)),ee(l.length,1)),c},1),L(N,"$select",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["select"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$arity:0,$$s:c});for(var S,Z,le,l=p(),f=0,m=c.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?Z=c.$$smap[S]:(Z=S.value,S=S.key),!1!==(le=h(S,Z))&&le!==a&&v(l,S,Z);return l},0),L(N,"$select!",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["select!"],function ye(){return(null==ye.$$s?this:ye.$$s).$size()},{$$arity:0,$$s:c});for(var S,Z,le,l=a,f=0,m=c.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?Z=c.$$smap[S]:(Z=S.value,S=S.key),(!1===(le=h(S,Z))||le===a)&&(void 0!==D(c,S)&&(x--,f--),l=c);return l},0),L(N,"$shift",function(){var l,h=this,c=h.$$keys;return c.length>0?[l=(l=c[0]).$$is_string?l:l.key,D(h,l)]:h.$default(a)},0),L(N,"$slice",function(h){var l,f=this;l=E.slice.call(arguments);for(var m=p(),x=0,S=l.length;x<S;x++){var Z=l[x],le=k(f,Z);void 0!==le&&v(m,Z,le)}return m},-1),L(N,"$to_a",function(){for(var x,S,c=[],l=0,f=this.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=this.$$smap[x]:(S=x.value,x=x.key),c.push([x,S]);return c},0),L(N,"$to_h",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,h!==a)return H(c,"map",[],h.$to_proc()).$to_h();if(c.$$class===E.Hash)return c;var l=new E.Hash;return u(l),E.hash_clone(c,l),l},0),L(N,"$to_hash",function(){return this},0),L(N,"$to_proc",function(){return H(this,"proc",[],function c(l){var f=null==c.$$s?this:c.$$s;return null==l&&oe.$raise(y("ArgumentError"),"no key given"),f["$[]"](l)},{$$arity:-1,$$s:this})},0),L(N,"$transform_keys",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["transform_keys"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:c});for(var S,Z,l=p(),f=0,m=c.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?Z=c.$$smap[S]:(Z=S.value,S=S.key),S=w(h,S),v(l,S,Z);return l},0),L(N,"$transform_keys!",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["transform_keys!"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:c});var f,x,S,Z,l=E.slice.call(c.$$keys),m=l.length;for(f=0;f<m;f++)(x=l[f]).$$is_string?S=c.$$smap[x]:(S=x.value,x=x.key),Z=w(h,x),D(c,x),v(c,Z,S);return c},0),L(N,"$transform_values",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["transform_values"],function le(){return(null==le.$$s?this:le.$$s).$size()},{$$arity:0,$$s:c});for(var S,Z,l=p(),f=0,m=c.$$keys,x=m.length;f<x;f++)(S=m[f]).$$is_string?Z=c.$$smap[S]:(Z=S.value,S=S.key),Z=w(h,Z),v(l,S,Z);return l},0),L(N,"$transform_values!",function C(){var h=C.$$p||a,c=this;if(delete C.$$p,!J(h))return H(c,"enum_for",["transform_values!"],function Z(){return(null==Z.$$s?this:Z.$$s).$size()},{$$arity:0,$$s:c});for(var x,S,l=0,f=c.$$keys,m=f.length;l<m;l++)(x=f[l]).$$is_string?S=c.$$smap[x]:(S=x.value,x=x.key),S=w(h,S),v(c,x,S);return c},0),L(N,"$values",function(){for(var x,c=[],l=0,f=this.$$keys,m=f.length;l<m;l++)c.push((x=f[l]).$$is_string?this.$$smap[x]:x.value);return c},0),M(N,"dup","clone"),M(N,"each_pair","each"),M(N,"eql?","=="),M(N,"filter","select"),M(N,"filter!","select!"),M(N,"include?","has_key?"),M(N,"indices","indexes"),M(N,"key","index"),M(N,"key?","has_key?"),M(N,"member?","has_key?"),M(N,"size","length"),M(N,"store","[]="),M(N,"to_s","inspect"),M(N,"update","merge!"),M(N,"value?","has_value?"),M(N,"values_at","indexes")},Opal.modules["corelib/number"]=function(E){var P,g,h,l,f,b,C,Y=[],a=E.nil,y=E.$$$,w=E.klass,p=E.Opal,u=E.Kernel,k=E.def,v=E.eqeqeq,D=E.truthy,_=E.rb_gt,F=E.not,oe=E.rb_lt,V=E.send2,L=E.find_super,H=E.send,U=E.rb_plus,se=E.rb_minus,ue=E.eqeq,J=E.rb_divide,K=E.to_ary,ee=E.rb_times,M=E.rb_le,G=E.rb_ge,z=E.alias,A=E.const_set;return E.top.$require("corelib/numeric"),function(N,P,g){var c,b=w("::",P,"Number");[b].concat(g),p.$bridge(Number,b),E.prop(b.$$prototype,"$$is_number",!0),b.$$is_number_class=!0,c=E.get_singleton_class(b),k(c,"$allocate",function(){return u.$raise(y("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(c,"$new"),k(b,"$coerce",function(l){var f=this;if(l===a)u.$raise(y("TypeError"),"can't convert "+l.$class()+" into Float");else{if(l.$$is_string)return[u.$Float(l),f];if(l["$respond_to?"]("to_f"))return[p["$coerce_to!"](l,y("Float"),"to_f"),f];if(l.$$is_number)return[l,f];u.$raise(y("TypeError"),"can't convert "+l.$class()+" into Float")}},1),k(b,"$__id__",function(){return 2*this+1},0),k(b,"$+",function(l){return l.$$is_number?this+l:this.$__coerced__("+",l)},1),k(b,"$-",function(l){return l.$$is_number?this-l:this.$__coerced__("-",l)},1),k(b,"$*",function(l){return l.$$is_number?this*l:this.$__coerced__("*",l)},1),k(b,"$/",function(l){return l.$$is_number?this/l:this.$__coerced__("/",l)},1),k(b,"$%",function(l){var f=this;return l.$$is_number?l==-1/0?l:0!=l?l<0||f<0?(f%l+l)%l:f%l:void u.$raise(y("ZeroDivisionError"),"divided by 0"):f.$__coerced__("%",l)},1),k(b,"$&",function(l){return l.$$is_number?this&l:this.$__coerced__("&",l)},1),k(b,"$|",function(l){return l.$$is_number?this|l:this.$__coerced__("|",l)},1),k(b,"$^",function(l){return l.$$is_number?this^l:this.$__coerced__("^",l)},1),k(b,"$<",function(l){return l.$$is_number?this<l:this.$__coerced__("<",l)},1),k(b,"$<=",function(l){return l.$$is_number?this<=l:this.$__coerced__("<=",l)},1),k(b,"$>",function(l){return l.$$is_number?this>l:this.$__coerced__(">",l)},1),k(b,"$>=",function(l){return l.$$is_number?this>=l:this.$__coerced__(">=",l)},1),k(b,"$<=>",function(l){try{return function(c,l){return l.$$is_number?isNaN(c)||isNaN(l)?a:c>l?1:c<l?-1:0:c.$__coerced__("<=>",l)}(this,l)}catch(m){if(!E.rescue(m,[y("ArgumentError")]))throw m;try{return a}finally{E.pop_exception()}}},1),k(b,"$<<",function(l){return(l=p["$coerce_to!"](l,y("Integer"),"to_int"))>0?this<<l:this>>-l},1),k(b,"$>>",function(l){return(l=p["$coerce_to!"](l,y("Integer"),"to_int"))>0?this>>l:this<<-l},1),k(b,"$[]",function(l){return(l=p["$coerce_to!"](l,y("Integer"),"to_int"))<0?0:l>=32?this<0?1:0:this>>l&1},1),k(b,"$+@",function(){return+this},0),k(b,"$-@",function(){return-this},0),k(b,"$~",function(){return~this},0),k(b,"$**",function(l){var f=this;return v(y("Integer"),l)?F(y("Integer")["$==="](f))||D(_(l,0))?Math.pow(f,l):y("Rational").$new(f,1)["$**"](l):oe(f,0)&&(v(y("Float"),l)||v(y("Rational"),l))?y("Complex").$new(f,0)["$**"](l.$to_f()):D(null!=l.$$is_number)?Math.pow(f,l):f.$__coerced__("**",l)},1),k(b,"$===",function(l){return l.$$is_number?this.valueOf()===l.valueOf():!!l["$respond_to?"]("==")&&l["$=="](this)},1),k(b,"$==",function(l){return l.$$is_number?this.valueOf()===l.valueOf():!!l["$respond_to?"]("==")&&l["$=="](this)},1),k(b,"$abs",function(){return Math.abs(this)},0),k(b,"$abs2",function(){return Math.abs(this*this)},0),k(b,"$allbits?",function(l){return(this&(l=p["$coerce_to!"](l,y("Integer"),"to_int")))==l},1),k(b,"$anybits?",function(l){return 0!=(this&p["$coerce_to!"](l,y("Integer"),"to_int"))},1),k(b,"$angle",function(){var l=this;return D(l["$nan?"]())?l:0==l?1/l>0?0:Math.PI:l<0?Math.PI:0},0),k(b,"$bit_length",function(){var l=this;if(v(y("Integer"),l)||u.$raise(y("NoMethodError").$new("undefined method `bit_length` for "+l+":Float","bit_length")),0===l||-1===l)return 0;for(var f=0,m=l<0?~l:l;0!=m;)f+=1,m>>>=1;return f},0),k(b,"$ceil",function(l){null==l&&(l=0);var m=this.$to_f();if(m%1==0&&l>=0)return m;var x=Math.pow(10,l),S=Math.ceil(m*x)/x;return m%1==0&&(S=Math.round(S)),S},-1),k(b,"$chr",function(l){return E.enc(String.fromCharCode(this),l||"BINARY")},-1),k(b,"$denominator",function c(){var l=c.$$p||a,f=this;return delete c.$$p,D(f["$nan?"]())||D(f["$infinite?"]())?1:V(f,L(f,"denominator",c,!1,!0),"denominator",[],l)},0),k(b,"$downto",function c(l){var f=c.$$p||a,m=this;if(delete c.$$p,f===a)return H(m,"enum_for",["downto",l],function S(){var Z=null==S.$$s?this:S.$$s;return v(y("Numeric"),l)||u.$raise(y("ArgumentError"),"comparison of "+Z.$class()+" with "+l.$class()+" failed"),D(_(l,Z))?0:U(se(Z,l),1)},{$$arity:0,$$s:m});l.$$is_number||u.$raise(y("ArgumentError"),"comparison of "+m.$class()+" with "+l.$class()+" failed");for(var x=m;x>=l;x--)f(x);return m},1),k(b,"$equal?",function(l){var m;return D(m=this["$=="](l))?m:isNaN(this)&&isNaN(l)},1),k(b,"$even?",function(){return this%2==0},0),k(b,"$floor",function(l){null==l&&(l=0);var m=this.$to_f();if(m%1==0&&l>=0)return m;var x=Math.pow(10,l),S=Math.floor(m*x)/x;return m%1==0&&(S=Math.round(S)),S},-1),k(b,"$gcd",function(l){v(y("Integer"),l)||u.$raise(y("TypeError"),"not an integer");for(var m=Math.abs(this),x=Math.abs(l);m>0;){var S=m;m=x%m,x=S}return x},1),k(b,"$gcdlcm",function(l){return[this.$gcd(l),this.$lcm(l)]},1),k(b,"$integer?",function(){return this%1==0},0),k(b,"$is_a?",function c(l){var f=c.$$p||a,m=this;return delete c.$$p,!!(ue(l,y("Integer"))&&v(y("Integer"),m)||ue(l,y("Integer"))&&v(y("Integer"),m)||ue(l,y("Float"))&&v(y("Float"),m))||V(m,L(m,"is_a?",c,!1,!0),"is_a?",[l],f)},1),k(b,"$instance_of?",function c(l){var f=c.$$p||a,m=this;return delete c.$$p,!!(ue(l,y("Integer"))&&v(y("Integer"),m)||ue(l,y("Integer"))&&v(y("Integer"),m)||ue(l,y("Float"))&&v(y("Float"),m))||V(m,L(m,"instance_of?",c,!1,!0),"instance_of?",[l],f)},1),k(b,"$lcm",function(l){var f=this;return v(y("Integer"),l)||u.$raise(y("TypeError"),"not an integer"),0==f||0==l?0:Math.abs(f*l/f.$gcd(l))},1),k(b,"$next",function(){return this+1},0),k(b,"$nobits?",function(l){return 0==(this&p["$coerce_to!"](l,y("Integer"),"to_int"))},1),k(b,"$nonzero?",function(){return 0==this?a:this},0),k(b,"$numerator",function c(){var l=c.$$p||a,f=this;return delete c.$$p,D(f["$nan?"]())||D(f["$infinite?"]())?f:V(f,L(f,"numerator",c,!1,!0),"numerator",[],l)},0),k(b,"$odd?",function(){return this%2!=0},0),k(b,"$ord",function(){return this},0),k(b,"$pow",function(l,f){var m=this;return 0==m&&u.$raise(y("ZeroDivisionError"),"divided by 0"),void 0===f?m["$**"](l):(y("Integer")["$==="](l)||u.$raise(y("TypeError"),"Integer#pow() 2nd argument not allowed unless a 1st argument is integer"),l<0&&u.$raise(y("TypeError"),"Integer#pow() 1st argument cannot be negative when 2nd argument specified"),y("Integer")["$==="](f)||u.$raise(y("TypeError"),"Integer#pow() 2nd argument not allowed unless all arguments are integers"),0===f&&u.$raise(y("ZeroDivisionError"),"divided by 0"),m["$**"](l)["$%"](f))},-2),k(b,"$pred",function(){return this-1},0),k(b,"$quo",function c(l){var f=c.$$p||a,m=this;return delete c.$$p,v(y("Integer"),m)?V(m,L(m,"quo",c,!1,!0),"quo",[l],f):J(m,l)},1),k(b,"$rationalize",function(l){var f,m,x=this,S=a,Z=a;return arguments.length>1&&u.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),v(y("Integer"),x)?y("Rational").$new(x,1):D(x["$infinite?"]())?u.$raise(y("FloatDomainError"),"Infinity"):D(x["$nan?"]())?u.$raise(y("FloatDomainError"),"NaN"):D(null==l)?(m=y("Math").$frexp(x),S=null==(f=K(m))[0]?a:f[0],Z=null==f[1]?a:f[1],S=y("Math").$ldexp(S,y(y("Float"),"MANT_DIG")).$to_i(),Z=se(Z,y(y("Float"),"MANT_DIG")),y("Rational").$new(ee(2,S),1["$<<"](se(1,Z))).$rationalize(y("Rational").$new(1,1["$<<"](se(1,Z))))):x.$to_r().$rationalize(l)},-1),k(b,"$remainder",function(l){return se(this,ee(l,J(this,l).$truncate()))},1),k(b,"$round",function(l){var f,m,Z,x=this;if(v(y("Integer"),x)){if(D(null==l)||(v(y("Float"),l)&&D(l["$infinite?"]())&&u.$raise(y("RangeError"),"Infinity"),l=p["$coerce_to!"](l,y("Integer"),"to_int"),D(oe(l,y(y("Integer"),"MIN")))&&u.$raise(y("RangeError"),"out of bounds"),D(l>=0)))return x;if(.415241*(l=l["$-@"]())-.125>x.$size())return 0;var le=Math.pow(10,l),ye=Math.floor((Math.abs(x)+le/2)/le)*le;return x<0?-ye:ye}if(D(x["$nan?"]())&&D(null==l)&&u.$raise(y("FloatDomainError"),"NaN"),l=p["$coerce_to!"](l||0,y("Integer"),"to_int"),D(M(l,0)))D(x["$nan?"]())?u.$raise(y("RangeError"),"NaN"):D(x["$infinite?"]())&&u.$raise(y("FloatDomainError"),"Infinity");else{if(ue(l,0))return Math.round(x);if(D(x["$nan?"]())||D(x["$infinite?"]()))return x}return m=y("Math").$frexp(x),Z=null==(f=K(m))[1]?a:f[1],D(G(l,se(U(y(y("Float"),"DIG"),2),D(_(Z,0))?J(Z,4):se(J(Z,3),1))))?x:D(oe(l,(D(_(Z,0))?U(J(Z,3),1):J(Z,4))["$-@"]()))?0:Math.round(x*Math.pow(10,l))/Math.pow(10,l)},-1),k(b,"$times",function c(){var l=c.$$p||a,f=this;if(delete c.$$p,!D(l))return H(f,"enum_for",["times"],function x(){return null==x.$$s?this:x.$$s},{$$arity:0,$$s:f});for(var m=0;m<f;m++)l(m);return f},0),k(b,"$to_f",function(){return this},0),k(b,"$to_i",function(){var l=this;return l<0?Math.ceil(l):Math.floor(l)},0),k(b,"$to_r",function(){var l,f,m=this,x=a,S=a;return v(y("Integer"),m)?y("Rational").$new(m,1):(f=y("Math").$frexp(m),x=null==(l=K(f))[0]?a:l[0],S=null==l[1]?a:l[1],x=y("Math").$ldexp(x,y(y("Float"),"MANT_DIG")).$to_i(),S=se(S,y(y("Float"),"MANT_DIG")),ee(x,y(y("Float"),"RADIX")["$**"](S)).$to_r())},0),k(b,"$to_s",function(l){var f=this;return null==l&&(l=10),l=p["$coerce_to!"](l,y("Integer"),"to_int"),(D(oe(l,2))||D(_(l,36)))&&u.$raise(y("ArgumentError"),"invalid radix "+l),ue(f,0)&&D(1/f==-1/0)?"-0.0":f.toString(l)},-1),k(b,"$truncate",function(l){null==l&&(l=0);var m=this.$to_f();if(m%1==0&&l>=0)return m;var x=Math.pow(10,l),S=parseInt(m*x,10)/x;return m%1==0&&(S=Math.round(S)),S},-1),k(b,"$digits",function(l){var f=this;null==l&&(l=10),oe(f,0)&&u.$raise(y(y("Math"),"DomainError"),"out of domain"),l=p["$coerce_to!"](l,y("Integer"),"to_int"),D(oe(l,2))&&u.$raise(y("ArgumentError"),"invalid radix "+l),f!=parseInt(f)&&u.$raise(y("NoMethodError"),"undefined method `digits' for "+f.$inspect());var m=f,x=[];if(0==f)return[0];for(;0!=m;)x.push(m%l),m=parseInt(m/l,10);return x},-1),k(b,"$divmod",function c(l){var f=c.$$p||a,m=this;return delete c.$$p,D(m["$nan?"]())||D(l["$nan?"]())?u.$raise(y("FloatDomainError"),"NaN"):D(m["$infinite?"]())?u.$raise(y("FloatDomainError"),"Infinity"):V(m,L(m,"divmod",c,!1,!0),"divmod",[l],f)},1),k(b,"$upto",function c(l){var f=c.$$p||a,m=this;if(delete c.$$p,f===a)return H(m,"enum_for",["upto",l],function S(){var Z=null==S.$$s?this:S.$$s;return v(y("Numeric"),l)||u.$raise(y("ArgumentError"),"comparison of "+Z.$class()+" with "+l.$class()+" failed"),D(oe(l,Z))?0:U(se(l,Z),1)},{$$arity:0,$$s:m});l.$$is_number||u.$raise(y("ArgumentError"),"comparison of "+m.$class()+" with "+l.$class()+" failed");for(var x=m;x<=l;x++)f(x);return m},1),k(b,"$zero?",function(){return 0==this},0),k(b,"$size",function(){return 4},0),k(b,"$nan?",function(){return isNaN(this)},0),k(b,"$finite?",function(){var l=this;return l!=1/0&&l!=-1/0&&!isNaN(l)},0),k(b,"$infinite?",function(){return this==1/0?1:this==-1/0?-1:a},0),k(b,"$positive?",function(){var l=this;return 0!=l&&(l==1/0||1/l>0)},0),k(b,"$negative?",function(){return this==-1/0||1/this<0},0),z(b,"arg","angle"),z(b,"eql?","=="),z(b,"fdiv","/"),z(b,"inspect","to_s"),z(b,"kind_of?","is_a?"),z(b,"magnitude","abs"),z(b,"modulo","%"),z(b,"object_id","__id__"),z(b,"phase","angle"),z(b,"succ","next"),z(b,"to_int","to_i")}(0,y("Numeric"),Y),A("::","Fixnum",y("Number")),P=y("Numeric"),g=Y,C=[b=w("::",P,"Integer")].concat(g),b.$$is_number_class=!0,b.$$is_integer_class=!0,l=[h=E.get_singleton_class(b)].concat(C),f=E.$r(l),k(h,"$allocate",function(){return u.$raise(y("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(h,"$new"),k(h,"$sqrt",function(x){return(x=p["$coerce_to!"](x,y("Integer"),"to_int"))<0&&u.$raise(y(y("Math"),"DomainError"),'Numerical argument is out of domain - "isqrt"'),parseInt(Math.sqrt(x),10)},1),k(h,"$try_convert",function(x){return f("Opal")["$coerce_to?"](x,this,"to_int")},1),A(b,"MAX",Math.pow(2,30)-1),A(b,"MIN",-Math.pow(2,30)),function(N,P,g){var b=w("::",P,"Float");return[b].concat(g),b.$$is_number_class=!0,function(h,c){k(h,"$allocate",function(){return u.$raise(y("TypeError"),"allocator undefined for "+this.$name())},0),E.udef(h,"$new"),k(h,"$===",function(f){return!!f.$$is_number},1)}(E.get_singleton_class(b)),A(b,"INFINITY",1/0),A(b,"MAX",Number.MAX_VALUE),A(b,"MIN",Number.MIN_VALUE),A(b,"NAN",NaN),A(b,"DIG",15),A(b,"MANT_DIG",53),A(b,"RADIX",2),A(b,"EPSILON",Number.EPSILON||2220446049250313e-31)}(0,y("Numeric"),Y)},Opal.modules["corelib/range"]=function(E){var a=E.nil,y=E.$$$,w=E.klass,p=E.truthy,u=E.Kernel,k=E.def,v=E.not,D=E.send2,_=E.find_super,F=E.rb_lt,oe=E.rb_le,V=E.send,L=E.eqeq,H=E.eqeqeq,U=E.rb_gt,se=E.rb_minus,ue=E.Opal,J=E.rb_divide,K=E.rb_plus,ee=E.rb_times,M=E.rb_ge,G=E.alias;return E.top.$require("corelib/enumerable"),function(z,A,N){var P=w("::",null,"Range"),g=[P].concat([]),b=E.$r(g),C=P.$$prototype;function h(c){return c.begin===a||c.end===a||c.begin===-1/0||c.end===1/0||c.begin===1/0||c.end===-1/0}return C.begin=C.end=C.excl=a,P.$include(y("Enumerable")),P.$$prototype.$$is_range=!0,P.$attr_reader("begin","end"),k(P,"$initialize",function(l,f,m){var x=this;return null==m&&(m=!1),p(x.begin)&&u.$raise(y("NameError"),"'initialize' called twice"),p(l["$<=>"](f))||p(l["$nil?"]())||p(f["$nil?"]())||u.$raise(y("ArgumentError"),"bad value for range"),x.begin=l,x.end=f,x.excl=m},-3),k(P,"$===",function(l){return this["$include?"](l)},1),k(P,"$count",function c(){var l=c.$$p||a,f=this;return delete c.$$p,v(l!==a)&&p(h(f))?y(y("Float"),"INFINITY"):D(f,_(f,"count",c,!1,!0),"count",[],l)},0),k(P,"$to_a",function c(){var l=c.$$p||a,f=this;return delete c.$$p,p(h(f))&&u.$raise(y("TypeError"),"cannot convert endless range to an array"),D(f,_(f,"to_a",c,!1,!0),"to_a",[],l)},0),k(P,"$cover?",function(l){var m,le,f=this,x=a,S=a,Z=a;return m=p(x=p(S=p(Z=f.begin["$nil?"]())?-1:Z)?S:f.begin["$<=>"](l))&&x,le=p(x=p(S=p(Z=f.end["$nil?"]())?-1:Z)?S:l["$<=>"](f.end))&&x,p(x=p(S=p(f.excl)?p(Z=le)?F(le,0):Z:p(Z=le)?oe(le,0):Z)?m:S)?oe(m,0):x},1),k(P,"$each",function c(){var S,le,ye,l=c.$$p||a,m=this,x=a,Z=a;if(delete c.$$p,l===a)return V(m,"enum_for",["each"],function T(){return(null==T.$$s?this:T.$$s).$size()},{$$arity:0,$$s:m});if(m.begin.$$is_number&&m.end.$$is_number){for((m.begin%1!=0||m.end%1!=0)&&u.$raise(y("TypeError"),"can't iterate from Float"),le=m.begin,ye=m.end+(p(m.excl)?0:1);le<ye;le++)l(le);return m}if(m.begin.$$is_string&&m.end.$$is_string)return V(m.begin,"upto",[m.end,m.excl],l.$to_proc()),m;for(S=m.end,p((x=m.begin)["$respond_to?"]("succ"))||u.$raise(y("TypeError"),"can't iterate from "+x.$class());p(p(Z=m.end["$nil?"]())?Z:F(x["$<=>"](S),0));)E.yield1(l,x),x=x.$succ();return v(m.excl)&&L(x,S)&&E.yield1(l,x),m},0),k(P,"$eql?",function(l){var f=this,m=a,x=a;return!!H(y("Range"),l)&&(p(m=p(x=f.excl["$==="](l["$exclude_end?"]()))?f.begin["$eql?"](l.$begin()):x)?f.end["$eql?"](l.$end()):m)},1),k(P,"$exclude_end?",function(){return this.excl},0),k(P,"$first",function c(l){var f=c.$$p||a,m=this;return delete c.$$p,p(m.begin["$nil?"]())&&u.$raise(y("RangeError"),"cannot get the minimum of beginless range"),p(null==l)?m.begin:D(m,_(m,"first",c,!1,!0),"first",[l],f)},-1),k(P,"$last",function(l){var f=this;return p(f.end["$nil?"]())&&u.$raise(y("RangeError"),"cannot get the maximum of endless range"),p(null==l)?f.end:f.$to_a().$last(l)},-1),k(P,"$max",function c(){var l=c.$$p||a,f=this;return delete c.$$p,p(f.end["$nil?"]())?u.$raise(y("RangeError"),"cannot get the maximum of endless range"):l!==a?D(f,_(f,"max",c,!1,!0),"max",[],l):v(f.begin["$nil?"]())&&(p(U(f.begin,f.end))||p(f.excl)&&L(f.begin,f.end))?a:f.excl?f.end-1:f.end},0),k(P,"$min",function c(){var l=c.$$p||a,f=this;return delete c.$$p,p(f.begin["$nil?"]())?u.$raise(y("RangeError"),"cannot get the minimum of beginless range"):l!==a?D(f,_(f,"min",c,!1,!0),"min",[],l):v(f.end["$nil?"]())&&(p(U(f.begin,f.end))||p(f.excl)&&L(f.begin,f.end))?a:f.begin},0),k(P,"$size",function(){var l=this,f=a,m=a,x=a;return f=y(y("Float"),"INFINITY"),L(l.begin,f)&&v(l.end["$nil?"]())||L(l.end,f["$-@"]())&&v(l.begin["$nil?"]())?0:p(h(l))?f:H(y("Numeric"),l.begin)&&H(y("Numeric"),l.end)?(m=l.begin,x=l.end,p(l.excl)&&(x=se(x,1)),p(F(x,m))?0:(Math.abs(x-m)+1).$to_i()):a},0),k(P,"$step",function c(l){var f=c.$$p||a,m=this,x=a,S=a;function Z(){null==l?l=1:l.$$is_number||(l=ue["$coerce_to!"](l,y("Integer"),"to_int")),l<0?u.$raise(y("ArgumentError"),"step can't be negative"):0===l&&u.$raise(y("ArgumentError"),"step can't be 0")}return delete c.$$p,f===a?(p(m.begin["$is_a?"](b("Numeric")))||p(m.begin["$nil?"]()))&&(p(m.end["$is_a?"](b("Numeric")))||p(m.end["$nil?"]()))&&v(p(x=m.begin["$nil?"]())?m.end["$nil?"]():x)?y(y("Enumerator"),"ArithmeticSequence").$new(m,l,"step"):V(m,"enum_for",["step",l],function(){return Z(),function le(){if(!m.begin["$respond_to?"]("succ")||m.begin.$$is_string&&m.end.$$is_string)return a;if(l%1==0)return J(m.$size(),l).$ceil();var ve,ye=m.begin,T=m.end,R=Math.abs,ie=Math.floor,j=(R(ye)+R(T)+R(T-ye))/R(l)*y(y("Float"),"EPSILON");return j>.5&&(j=.5),m.excl?(ve=ie((T-ye)/l-j))*l+ye<T&&ve++:ve=ie((T-ye)/l+j)+1,ve}()},0):(Z(),p(m.begin.$$is_number&&m.end.$$is_number)?(S=0,function(){var ye=E.new_brk();try{V(m,"loop",[],function T(){var ie,R=null==T.$$s?this:T.$$s;return null==R.begin&&(R.begin=a),null==R.excl&&(R.excl=a),null==R.end&&(R.end=a),ie=K(R.begin,ee(S,l)),p(R.excl)?p(M(ie,R.end))&&E.brk(a,ye):p(U(ie,R.end))&&E.brk(a,ye),E.yield1(f,ie),S=K(S,1)},{$$arity:0,$$s:m,$$brk:ye})}catch(T){if(T===ye)return T.$v;throw T}}()):(m.begin.$$is_string&&m.end.$$is_string&&l%1!=0&&u.$raise(y("TypeError"),"no implicit conversion to float from string"),V(m,"each_with_index",[],function(T,R){return null==T&&(T=a),null==R&&(R=a),L(R["$%"](l),0)?E.yield1(f,T):a},2)),m)},-1),k(P,"$%",function(l){var f=this;return p(f.begin["$is_a?"](b("Numeric")))&&p(f.end["$is_a?"](b("Numeric")))?y(y("Enumerator"),"ArithmeticSequence").$new(f,l,"%"):f.$step(l)},1),k(P,"$bsearch",function c(){var l=c.$$p||a,f=this;return delete c.$$p,l===a?f.$enum_for("bsearch"):(p(h(f)&&(f.begin.$$is_number||f.end.$$is_number))&&u.$raise(y("NotImplementedError"),"Can't #bsearch an infinite range"),p(f.begin.$$is_number&&f.end.$$is_number)||u.$raise(y("TypeError"),"can't do binary search for "+f.begin.$class()),V(f.$to_a(),"bsearch",[],l.$to_proc()))},0),k(P,"$to_s",function(){var l=this,f=a;return(p(f=l.begin)?f:"")+(p(l.excl)?"...":"..")+(p(f=l.end)?f:"")},0),k(P,"$inspect",function(){var l=this,f=a;return(p(f=l.begin)?l.begin.$inspect():f)+(p(l.excl)?"...":"..")+(p(f=l.end)?l.end.$inspect():f)},0),k(P,"$marshal_load",function(l){var f=this;return f.begin=l["$[]"]("begin"),f.end=l["$[]"]("end"),f.excl=l["$[]"]("excl")},1),k(P,"$hash",function(){var l=this;return[l.begin,l.end,l.excl].$hash()},0),G(P,"==","eql?"),G(P,"include?","cover?"),G(P,"member?","cover?")}()},Opal.modules["corelib/proc"]=function(E){var L,ae=E.nil,Y=E.$$$,a=E.slice,w=E.truthy,p=E.Kernel,u=E.defs,k=E.def,v=E.send,D=E.to_a,_=E.Opal,F=E.alias;return L=(0,E.klass)("::",Function,"Proc"),E.prop(L.$$prototype,"$$is_proc",!0),E.prop(L.$$prototype,"$$is_lambda",!1),u(L,"$new",function H(){var U=H.$$p||ae;return delete H.$$p,w(U)||p.$raise(Y("ArgumentError"),"tried to create a Proc object without a block"),U},0),k(L,"$call",function H(U){var J,se=H.$$p||ae,K=this;delete H.$$p,J=E.slice.call(arguments),se!==ae&&(K.$$p=se);var ee,M=K.$$brk;if(M)try{ee=K.$$is_lambda?K.apply(null,J):E.yieldX(K,J)}catch(G){if(G===M)return M.$v;throw G}else ee=K.$$is_lambda?K.apply(null,J):E.yieldX(K,J);return ee},-1),k(L,"$>>",function H(U){return delete H.$$p,v(p,"proc",[],function J(K){var M,ee=J.$$p||ae,z=null==J.$$s?this:J.$$s,A=ae;return delete J.$$p,M=E.slice.call(arguments),A=v(z,"call",D(M),ee.$to_proc()),U.$call(A)},{$$arity:-1,$$s:this})},1),k(L,"$<<",function H(U){return delete H.$$p,v(p,"proc",[],function J(K){var M,ee=J.$$p||ae,z=null==J.$$s?this:J.$$s,A=ae;return delete J.$$p,M=E.slice.call(arguments),A=v(U,"call",D(M),ee.$to_proc()),z.$call(A)},{$$arity:-1,$$s:this})},1),k(L,"$to_proc",function(){return this},0),k(L,"$lambda?",function(){return!!this.$$is_lambda},0),k(L,"$arity",function(){return this.$$is_curried?-1:this.$$arity},0),k(L,"$source_location",function(){return ae},0),k(L,"$binding",function(){return this.$$is_curried&&p.$raise(Y("ArgumentError"),"Can't create Binding"),w(Y("::","Binding","skip_raise")?"constant":ae)?Y("Binding").$new(ae,[],this.$$s,this.$source_location()):ae},0),k(L,"$parameters",function(){var U=this;if(U.$$is_curried)return[["rest"]];if(U.$$parameters){if(U.$$is_lambda)return U.$$parameters;var ue,J,se=[];for(ue=0,J=U.$$parameters.length;ue<J;ue++){var K=U.$$parameters[ue];"req"===K[0]&&(K=["opt",K[1]]),se.push(K)}return se}return[]},0),k(L,"$curry",function(U){var se=this;function ue(){var ee,J=a.call(arguments),K=J.length;return K>U&&se.$$is_lambda&&!se.$$is_curried&&p.$raise(Y("ArgumentError"),"wrong number of arguments ("+K+" for "+U+")"),K>=U?se.$call.apply(se,J):(ee=function(){return ue.apply(null,J.concat(a.call(arguments)))},ee.$$is_lambda=se.$$is_lambda,ee.$$is_curried=!0,ee)}return void 0===U?U=se.length:(U=_["$coerce_to!"](U,Y("Integer"),"to_int"),se.$$is_lambda&&U!==se.length&&p.$raise(Y("ArgumentError"),"wrong number of arguments ("+U+" for "+se.length+")")),ue.$$is_lambda=se.$$is_lambda,ue.$$is_curried=!0,ue},-1),k(L,"$dup",function(){var U=this,se=U.$$original_proc||U,ue=function(){return se.apply(this,arguments)};for(var J in U)U.hasOwnProperty(J)&&(ue[J]=U[J]);return ue},0),F(L,"===","call"),F(L,"clone","dup"),F(L,"yield","call"),F(L,"[]","call")},Opal.modules["corelib/method"]=function(E){var F,oe,ae=E.nil,Y=E.$$$,a=E.klass,y=E.def,w=E.truthy,p=E.alias,u=E.Kernel,k=E.send,v=E.to_a;return(oe=(F=a("::",null,"Method")).$$prototype).method=oe.receiver=oe.owner=oe.name=ae,F.$attr_reader("owner","receiver","name"),y(F,"$initialize",function(L,H,U,se){return this.receiver=L,this.owner=H,this.name=se,this.method=U},4),y(F,"$arity",function(){return this.method.$arity()},0),y(F,"$parameters",function(){return this.method.$$parameters},0),y(F,"$source_location",function(){var H;return w(H=this.method.$$source_location)?H:["(eval)",0]},0),y(F,"$comments",function(){var H;return w(H=this.method.$$comments)?H:[]},0),y(F,"$call",function V(L){var se,H=V.$$p||ae,ue=this;return delete V.$$p,se=E.slice.call(arguments),ue.method.$$p=H,ue.method.apply(ue.receiver,se)},-1),y(F,"$curry",function(L){return this.method.$curry(L)},-1),y(F,"$>>",function(L){return this.method["$>>"](L)},1),y(F,"$<<",function(L){return this.method["$<<"](L)},1),y(F,"$unbind",function(){var L=this;return Y("UnboundMethod").$new(L.receiver.$class(),L.owner,L.method,L.name)},0),y(F,"$to_proc",function(){var L=this,H=L.$call.bind(L);return H.$$unbound=L.method,H.$$is_lambda=!0,H.$$arity=L.method.$$arity,H.$$parameters=L.method.$$parameters,H},0),y(F,"$inspect",function(){var L=this;return"#<"+L.$class()+": "+L.receiver.$class()+"#"+L.name+" (defined in "+L.owner+" in "+L.$source_location().$join(":")+")>"},0),p(F,"[]","call"),p(F,"===","call"),function(D,_){var F=a("::",null,"UnboundMethod"),oe=F.$$prototype;return oe.method=oe.owner=oe.name=oe.source=ae,F.$attr_reader("source","owner","name"),y(F,"$initialize",function(L,H,U,se){return this.source=L,this.owner=H,this.method=U,this.name=se},4),y(F,"$arity",function(){return this.method.$arity()},0),y(F,"$parameters",function(){return this.method.$$parameters},0),y(F,"$source_location",function(){var H;return w(H=this.method.$$source_location)?H:["(eval)",0]},0),y(F,"$comments",function(){var H;return w(H=this.method.$$comments)?H:[]},0),y(F,"$bind",function(L){var H=this;if(H.owner.$$is_module||E.is_a(L,H.owner))return Y("Method").$new(L,H.owner,H.method,H.name);u.$raise(Y("TypeError"),"can't bind singleton method to a different class (expected "+L+".kind_of?("+H.owner+" to be true)")},1),y(F,"$bind_call",function V(L,H){var ue,U=V.$$p||ae,J=this;return delete V.$$p,ue=E.slice.call(arguments,1),k(J.$bind(L),"call",v(ue),U.$to_proc())},-2),y(F,"$inspect",function(){var L=this;return"#<"+L.$class()+": "+L.source+"#"+L.name+" (defined in "+L.owner+" in "+L.$source_location().$join(":")+")>"},0)}()},Opal.modules["corelib/variables"]=function(E){var ae=E.nil,Y=E.gvars,a=E.const_set,y=E.Object,w=E.hash2;return Y["&"]=Y["~"]=Y["`"]=Y["'"]=ae,Y.LOADED_FEATURES=Y['"']=E.loaded_features,Y.LOAD_PATH=Y[":"]=[],Y["/"]="\n",Y[","]=ae,a("::","ARGV",[]),a("::","ARGF",y.$new()),a("::","ENV",w([],{})),Y.VERBOSE=!1,Y.DEBUG=!1,Y.SAFE=0},Opal.modules["corelib/io"]=function(E){var z,A,ae=E.nil,Y=E.$$$,y=E.const_set,w=E.not,p=E.truthy,u=E.def,k=E.Kernel,v=E.gvars,D=E.send,_=E.to_a,F=E.rb_plus,oe=E.neqeq,V=E.range,L=E.hash2,H=E.eqeq,U=E.to_ary,se=E.rb_gt,ue=E.alias,J=E.rb_minus,K=ae;(A=(z=(0,E.klass)("::",null,"IO")).$$prototype).fd=A.read_buffer=A.closed=ae,y(z,"SEEK_SET",0),y(z,"SEEK_CUR",1),y(z,"SEEK_END",2),y(z,"SEEK_DATA",3),y(z,"SEEK_HOLE",4),y(z,"READABLE",1),y(z,"WRITABLE",4),z.$attr_reader("eof"),z.$attr_accessor("read_proc","sync","tty","write_proc"),u(z,"$initialize",function(P,g){var b=this;return null==g&&(g="r"),b.fd=P,b.flags=g,b.eof=!1,p(g["$include?"]("r"))&&w(g["$match?"](/[wa+]/))?b.closed="write":p(g["$match?"](/[wa]/))&&w(g["$match?"](/[r+]/))?b.closed="read":ae},-2),u(z,"$fileno",function(){return this.fd},0),u(z,"$tty?",function(){return 1==this.tty},0),u(z,"$write",function(P){return this.write_proc(P),P.$size()},1),u(z,"$flush",function(){return ae},0),u(z,"$<<",function(P){return this.$write(P),this},1),u(z,"$print",function(P){var b,C=this;null==v[","]&&(v[","]=ae);for(var h=0,c=(b=E.slice.call(arguments)).length;h<c;h++)b[h]=k.$String(b[h]);return C.$write(b.join(v[","])),ae},-1),u(z,"$puts",function(P){var b,h,C=this;if(0===(b=E.slice.call(arguments)).length)return C.$write("\n"),ae;for(var c=0,l=b.length;c<l;c++)if(b[c].$$is_array){var f=b[c].$flatten();f.length>0&&D(C,"puts",_(f))}else(h=b[c].$$is_string?b[c].valueOf():k.$String(b[c])).endsWith("\n")||(h+="\n"),C.$write(h);return ae},-1),u(z,"$getc",function(){var b,g=this,C=ae,h=ae;g.read_buffer=p(b=g.read_buffer)?b:"",C="";do{if(g.read_buffer=F(g.read_buffer,C),oe(g.read_buffer,""))return h=g.read_buffer["$[]"](0),g.read_buffer=g.read_buffer["$[]"](V(1,-1,!1)),h}while(p(C=g.$sysread_noraise(1)));return ae},0),u(z,"$getbyte",function(){var P;return(P=this.$getc())===ae||null==P?ae:D(P,"ord",[])},0),u(z,"$readbyte",function(){return this.$readchar().$ord()},0),u(z,"$readchar",function(){var g;return p(g=this.$getc())?g:k.$raise(Y("EOFError"),"end of file reached")},0),u(z,"$readline",function(P){var g,C=this,h=ae;return g=E.slice.call(arguments),p(h=D(C,"gets",_(g)))?h:k.$raise(Y("EOFError"),"end of file reached")},-1),u(z,"$gets",function(P,g,b){var C,h,c,f,x,l=this,m=ae,S=ae,Z=ae,le=ae;null==v["/"]&&(v["/"]=ae),null==P&&(P=!1),null==g&&(g=ae),null==b&&(b=L([],{})),p(P.$$is_number)&&w(g)&&(P=(C=[!1,P,g])[0],g=C[1],b=C[2]),p(P.$$is_hash)&&w(g)&&H(b,L([],{}))?(P=(C=[!1,ae,P])[0],g=C[1],b=C[2]):p(g.$$is_hash)&&H(b,L([],{}))&&(P=(C=[P,ae,g])[0],g=C[1],b=C[2]),f=P,H(P,!1)&&(P=v["/"]),H(P,"")&&(P=/\r?\n\r?\n/),P=p(m=P)?m:"",H(f,"")||(P=P.$to_str()),x=H(f,"")?2:P.$length(),H(P," ")&&(P=/ /),l.read_buffer=p(m=l.read_buffer)?m:"",S="",Z=ae;do{if(l.read_buffer=F(l.read_buffer,S),oe(P,"")&&p(p(P.$$is_regexp)?l.read_buffer["$match?"](P):l.read_buffer["$include?"](P))){le=l.read_buffer,c=l.read_buffer.$split(P,2),Z=null==(h=U(c))[0]?ae:h[0],l.read_buffer=null==h[1]?ae:h[1],oe(Z,le)&&(Z=F(Z,le["$[]"](Z.$length(),x)));break}}while(p(S=l.$sysread_noraise(H(P,"")?65536:1)));return p(Z)||(Z=(C=[p(m=l.read_buffer)?m:"",""])[0],l.read_buffer=C[1],H(Z,"")&&(Z=ae)),p(Z)&&(p(g)&&(Z=Z["$[]"](E.Range.$new(0,g,!0)),l.read_buffer=F(Z["$[]"](E.Range.$new(g,-1,!1)),l.read_buffer)),p(b["$[]"]("chomp"))&&(Z=Z.$sub(/\r?\n$/,"")),H(f,"")&&(Z=Z.$sub(/^[\r\n]+/,""))),H(f,!1)&&(v._=Z),Z},-1),u(z,"$sysread",function(P){var b;return p(b=this.read_proc(P))?b:(this.eof=!0,k.$raise(Y("EOFError"),"end of file reached"))},1),u(z,"$sysread_noraise",function(P){try{return this.$sysread(P)}catch(b){if(!E.rescue(b,[Y("EOFError")]))throw b;try{return ae}finally{E.pop_exception()}}},1),u(z,"$readpartial",function(P){var g,h,b=this,C=ae,c=ae;return b.read_buffer=p(C=b.read_buffer)?C:"",h=b.$sysread(P),c=(g=[F(b.read_buffer,p(C=h)?C:""),""])[0],b.read_buffer=g[1],H(c,"")&&(c=ae),c},1),u(z,"$read",function(P){var g,b,C=this,h=ae,c=ae,l=ae;null==P&&(P=ae),C.read_buffer=p(h=C.read_buffer)?h:"",c="",l=ae;do{if(C.read_buffer=F(C.read_buffer,c),p(P)&&p(se(C.read_buffer.$length(),P)))return l=(b=[C.read_buffer["$[]"](E.Range.$new(0,P,!0)),C.read_buffer["$[]"](E.Range.$new(P,-1,!1))])[0],C.read_buffer=b[1],l}while(p(c=C.$sysread_noraise(p(h=P)?h:65536)));return l=(g=[C.read_buffer,""])[0],C.read_buffer=g[1],l},-1),u(z,"$readlines",function(P){return null==v["/"]&&(v["/"]=ae),null==P&&(P=v["/"]),this.$each_line(P).$to_a()},-1),u(z,"$each",function N(P,g){var C,h,c,b=N.$$p||ae,f=this,m=ae;if(null==v["/"]&&(v["/"]=ae),delete N.$$p,(C=E.slice.call(arguments)).length>0&&(h=C.shift()),null==h&&(h=v["/"]),c=C,b===ae)return D(f,"enum_for",["each",h].concat(_(c)));for(;p(m=D(f,"gets",[h].concat(_(c))));)E.yield1(b,m);return f},-1),u(z,"$each_byte",function N(){var P=N.$$p||ae,b=this,C=ae;if(delete N.$$p,P===ae)return b.$enum_for("each_byte");for(;p(C=b.$getbyte());)E.yield1(P,C);return b},0),u(z,"$each_char",function N(){var P=N.$$p||ae,b=this,C=ae;if(delete N.$$p,P===ae)return b.$enum_for("each_char");for(;p(C=b.$getc());)E.yield1(P,C);return b},0),u(z,"$close",function(){return this.closed="both"},0),u(z,"$close_read",function(){return this.closed=H(this.closed,"write")?"both":"read"},0),u(z,"$close_write",function(){return this.closed=H(this.closed,"read")?"both":"write"},0),u(z,"$closed?",function(){return this.closed["$=="]("both")},0),u(z,"$closed_read?",function(){var g;return p(g=this.closed["$=="]("read"))?g:this.closed["$=="]("both")},0),u(z,"$closed_write?",function(){var g;return p(g=this.closed["$=="]("write"))?g:this.closed["$=="]("both")},0),u(z,"$check_writable",function(){return p(this["$closed_write?"]())?k.$raise(Y("IOError"),"not opened for writing"):ae},0),u(z,"$check_readable",function(){return p(this["$closed_read?"]())?k.$raise(Y("IOError"),"not opened for reading"):ae},0),ue(z,"each_line","each"),ue(z,"eof?","eof"),y("::","STDIN",v.stdin=Y("IO").$new(0,"r")),y("::","STDOUT",v.stdout=Y("IO").$new(1,"w")),y("::","STDERR",v.stderr=Y("IO").$new(2,"w"));var ee=E.global.console;return K=["object"==typeof process&&"object"==typeof process.stdout?function(M){process.stdout.write(M)}:function(M){ee.log(M)}],D(Y("STDOUT"),"write_proc=",_(K)),J(K.length,1),K=["object"==typeof process&&"object"==typeof process.stderr?function(M){process.stderr.write(M)}:function(M){ee.warn(M)}],D(Y("STDERR"),"write_proc=",_(K)),J(K.length,1),K=[function(M){var G=prompt();return null!==G?G+"\n":ae}],D(Y("STDIN"),"read_proc=",_(K)),K[J(K.length,1)]},Opal.modules["opal/regexp_anchors"]=function(E){var u,k,v,D,ae=[],a=E.$$$,w=E.const_set;return u=ae,v=[k=(0,E.module)(ae[0],"Opal")].concat(u),D=E.$r(v),w(k,"REGEXP_START","^"),w(k,"REGEXP_END","$"),w(k,"FORBIDDEN_STARTING_IDENTIFIER_CHARS","\\u0001-\\u002F\\u003A-\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),w(k,"FORBIDDEN_ENDING_IDENTIFIER_CHARS","\\u0001-\\u0020\\u0022-\\u002F\\u003A-\\u003E\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),w(k,"INLINE_IDENTIFIER_REGEXP",D("Regexp").$new("[^"+a(k,"FORBIDDEN_STARTING_IDENTIFIER_CHARS")+"]*[^"+a(k,"FORBIDDEN_ENDING_IDENTIFIER_CHARS")+"]")),w(k,"FORBIDDEN_CONST_NAME_CHARS","\\u0001-\\u0020\\u0021-\\u002F\\u003B-\\u003F\\u0040\\u005B-\\u005E\\u0060\\u007B-\\u007F"),w(k,"CONST_NAME_REGEXP",D("Regexp").$new(a(k,"REGEXP_START")+"(::)?[A-Z][^"+a(k,"FORBIDDEN_CONST_NAME_CHARS")+"]*"+a(k,"REGEXP_END")))},Opal.modules["opal/mini"]=function(E){var Y=E.Object;return Y.$require("opal/base"),Y.$require("corelib/nil"),Y.$require("corelib/boolean"),Y.$require("corelib/string"),Y.$require("corelib/comparable"),Y.$require("corelib/enumerable"),Y.$require("corelib/enumerator"),Y.$require("corelib/array"),Y.$require("corelib/hash"),Y.$require("corelib/number"),Y.$require("corelib/range"),Y.$require("corelib/proc"),Y.$require("corelib/method"),Y.$require("corelib/regexp"),Y.$require("corelib/variables"),Y.$require("corelib/io"),Y.$require("opal/regexp_anchors")},Opal.modules["corelib/kernel/format"]=function(E){var oe,ae=E.nil,Y=E.$$$,a=E.coerce_to,w=E.truthy,p=E.eqeq,u=E.Opal,k=E.Kernel,v=E.gvars,_=E.alias;return(0,E.def)(oe=(0,E.module)("::","Kernel"),"$format",function(L,H){var U,se,ue=ae;null==v.DEBUG&&(v.DEBUG=ae),U=E.slice.call(arguments,1),p((se=U).$length(),1)&&w(se["$[]"](0)["$respond_to?"]("to_ary"))&&(ue=u["$coerce_to?"](se["$[]"](0),Y("Array"),"to_ary"),w(ue["$nil?"]())||(se=ue.$to_a()));var ee,M,z,A,N,P,g,b,C,h,c,l,f,m,x,le,J="",K=0,G=L.length,S=1,Z=0,ye=0,T=1,R=2,ie=4,j=8,ve=16,de=32,we=64,ce=128;function he(){le&de&&k.$raise(Y("ArgumentError"),"flag after width"),le&ce&&k.$raise(Y("ArgumentError"),"flag after precision")}function B(){le&de&&k.$raise(Y("ArgumentError"),"width given twice"),le&ce&&k.$raise(Y("ArgumentError"),"width after precision")}function O(Te){return Te>=se.length&&k.$raise(Y("ArgumentError"),"too few arguments"),se[Te]}function ne(){switch(Z){case-1:k.$raise(Y("ArgumentError"),"unnumbered("+S+") mixed with numbered");case-2:k.$raise(Y("ArgumentError"),"unnumbered("+S+") mixed with named")}return O((Z=S++)-1)}function q(Te){return Z>0&&k.$raise(Y("ArgumentError"),"numbered("+Te+") after unnumbered("+Z+")"),-2===Z&&k.$raise(Y("ArgumentError"),"numbered("+Te+") after named"),Te<1&&k.$raise(Y("ArgumentError"),"invalid index - "+Te+"$"),Z=-1,O(Te-1)}function pe(){return void 0===x?ne():x}function $e(Te){for(var De,Me="";;M++){if(M===G&&k.$raise(Y("ArgumentError"),"malformed format string - %*[0-9]"),L.charCodeAt(M)<48||L.charCodeAt(M)>57)return M--,(De=parseInt(Me,10)||0)>2147483647&&k.$raise(Y("ArgumentError"),Te+" too big"),De;Me+=L.charAt(M)}}function me(Te){var De,Me=$e(Te);return"$"===L.charAt(M+1)?(M++,De=q(Me)):De=ne(),De.$to_int()}for(M=L.indexOf("%");-1!==M;M=L.indexOf("%",M)){switch(A=void 0,le=ye,P=-1,g=-1,x=void 0,ee=M,M++,L.charAt(M)){case"%":K=M;case"":case"\n":case"\0":M++;continue}e:for(;M<G;M++)switch(L.charAt(M)){case" ":he(),le|=ve;continue e;case"#":he(),le|=T;continue e;case"+":he(),le|=ie;continue e;case"-":he(),le|=R;continue e;case"0":he(),le|=j;continue e;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":if(b=$e("width"),"$"===L.charAt(M+1)){if(M+2===G){A="%",M++;break e}void 0!==x&&k.$raise(Y("ArgumentError"),"value given twice - %"+b+"$"),x=q(b),M++}else B(),le|=de,P=b;continue e;case"<":case"{":for(h="<"===L.charAt(M)?">":"}",C="",M++;;M++){if(M===G&&k.$raise(Y("ArgumentError"),"malformed name - unmatched parenthesis"),L.charAt(M)===h){if(Z>0&&k.$raise(Y("ArgumentError"),"named "+C+" after unnumbered("+Z+")"),-1===Z&&k.$raise(Y("ArgumentError"),"named "+C+" after numbered"),Z=-2,(void 0===se[0]||!se[0].$$is_hash)&&k.$raise(Y("ArgumentError"),"one hash required"),x=se[0].$fetch(C),">"===h)continue e;if(A=x.toString(),-1!==g&&(A=A.slice(0,g)),le&R)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e}C+=L.charAt(M)}case"*":M++,B(),le|=de,(P=me("width"))<0&&(le|=R,P=-P);continue e;case".":if(le&ce&&k.$raise(Y("ArgumentError"),"precision given twice"),le|=we|ce,g=0,M++,"*"===L.charAt(M)){M++,(g=me("precision"))<0&&(le&=~we);continue e}g=$e("precision");continue e;case"d":case"i":case"u":if((z=k.$Integer(pe()))>=0){for(A=z.toString();A.length<g;)A="0"+A;if(le&R)for((le&ie||le&ve)&&(A=(le&ie?"+":" ")+A);A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-(le&ie||le&ve?1:0);)A="0"+A;(le&ie||le&ve)&&(A=(le&ie?"+":" ")+A)}else for((le&ie||le&ve)&&(A=(le&ie?"+":" ")+A);A.length<P;)A=" "+A}else{for(A=(-z).toString();A.length<g;)A="0"+A;if(le&R)for(A="-"+A;A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-1;)A="0"+A;A="-"+A}else for(A="-"+A;A.length<P;)A=" "+A}break e;case"b":case"B":case"o":case"x":case"X":switch(L.charAt(M)){case"b":case"B":c=2,l="0b",f=/^1+/,m="1";break;case"o":c=8,l="0",f=/^3?7+/,m="7";break;case"x":case"X":c=16,l="0x",f=/^f+/,m="f"}if((z=k.$Integer(pe()))>=0){for(A=z.toString(c);A.length<g;)A="0"+A;if(le&R)for((le&ie||le&ve)&&(A=(le&ie?"+":" ")+A),le&T&&0!==z&&(A=l+A);A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-(le&ie||le&ve?1:0)-(le&T&&0!==z?l.length:0);)A="0"+A;le&T&&0!==z&&(A=l+A),(le&ie||le&ve)&&(A=(le&ie?"+":" ")+A)}else for(le&T&&0!==z&&(A=l+A),(le&ie||le&ve)&&(A=(le&ie?"+":" ")+A);A.length<P;)A=" "+A}else if(le&ie||le&ve){for(A=(-z).toString(c);A.length<g;)A="0"+A;if(le&R)for(le&T&&(A=l+A),A="-"+A;A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-1-(le&T?2:0);)A="0"+A;le&T&&(A=l+A),A="-"+A}else for(le&T&&(A=l+A),A="-"+A;A.length<P;)A=" "+A}else{for(A=(z>>>0).toString(c).replace(f,m);A.length<g-2;)A=m+A;if(le&R)for(A=".."+A,le&T&&(A=l+A);A.length<P;)A+=" ";else if(le&j&&-1===g){for(;A.length<P-2-(le&T?l.length:0);)A=m+A;A=".."+A,le&T&&(A=l+A)}else for(A=".."+A,le&T&&(A=l+A);A.length<P;)A=" "+A}L.charAt(M)===L.charAt(M).toUpperCase()&&(A=A.toUpperCase());break e;case"f":case"e":case"E":case"g":case"G":if((z=k.$Float(pe()))>=0||isNaN(z)){if(z===1/0)A="Inf";else switch(L.charAt(M)){case"f":A=z.toFixed(-1===g?6:g);break;case"e":case"E":A=z.toExponential(-1===g?6:g);break;case"g":case"G":A=z.toExponential(),(N=parseInt(A.split("e")[1],10))<-4||N>=(-1===g?6:g)||(A=z.toPrecision(-1===g?le&T?6:void 0:g))}if(le&R)for((le&ie||le&ve)&&(A=(le&ie?"+":" ")+A);A.length<P;)A+=" ";else if(le&j&&z!==1/0&&!isNaN(z)){for(;A.length<P-(le&ie||le&ve?1:0);)A="0"+A;(le&ie||le&ve)&&(A=(le&ie?"+":" ")+A)}else for((le&ie||le&ve)&&(A=(le&ie?"+":" ")+A);A.length<P;)A=" "+A}else{if(z===-1/0)A="Inf";else switch(L.charAt(M)){case"f":A=(-z).toFixed(-1===g?6:g);break;case"e":case"E":A=(-z).toExponential(-1===g?6:g);break;case"g":case"G":A=(-z).toExponential(),(N=parseInt(A.split("e")[1],10))<-4||N>=(-1===g?6:g)||(A=(-z).toPrecision(-1===g?le&T?6:void 0:g))}if(le&R)for(A="-"+A;A.length<P;)A+=" ";else if(le&j&&z!==-1/0){for(;A.length<P-1;)A="0"+A;A="-"+A}else for(A="-"+A;A.length<P;)A=" "+A}L.charAt(M)===L.charAt(M).toUpperCase()&&z!==1/0&&z!==-1/0&&!isNaN(z)&&(A=A.toUpperCase()),A=A.replace(/([eE][-+]?)([0-9])$/,"$10$2");break e;case"a":case"A":k.$raise(Y("NotImplementedError"),"`A` and `a` format field types are not implemented in Opal yet");case"c":if((z=pe())["$respond_to?"]("to_ary")&&(z=z.$to_ary()[0]),1!==(A=z["$respond_to?"]("to_str")?z.$to_str():String.fromCharCode(a(z,Y("Integer"),"to_int"))).length&&k.$raise(Y("ArgumentError"),"%c requires a character"),le&R)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e;case"p":if(A=pe().$inspect(),-1!==g&&(A=A.slice(0,g)),le&R)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e;case"s":if(A=pe().$to_s(),-1!==g&&(A=A.slice(0,g)),le&R)for(;A.length<P;)A+=" ";else for(;A.length<P;)A=" "+A;break e;default:k.$raise(Y("ArgumentError"),"malformed format string - %"+L.charAt(M))}void 0===A&&k.$raise(Y("ArgumentError"),"malformed format string - %"),J+=L.slice(K,ee)+A,K=M+1}return v.DEBUG&&Z>=0&&S<se.length&&k.$raise(Y("ArgumentError"),"too many arguments for format string"),J+L.slice(K)},-2),_(oe,"sprintf","format")},Opal.modules["corelib/string/encoding"]=function(E){var J,M,G,ae=E.top,a=E.$r([]),y=E.nil,w=E.$$$,p=E.klass,u=E.hash2,k=E.rb_plus,v=E.truthy,D=E.send,_=E.defs,F=E.eqeq,oe=E.def,V=E.Kernel,L=E.Opal,H=E.rb_lt,U=E.alias,se=E.to_a,ue=E.rb_minus;return ae.$require("corelib/string"),(G=(M=p("::",null,"Encoding")).$$prototype).ascii=G.dummy=G.name=y,_(M,"$register",function z(A,N){var b,h,c,P=z.$$p||y,C=y,l=y,f=y;return delete z.$$p,null==N&&(N=u([],{})),b=k([A],v(C=N["$[]"]("aliases"))?C:[]),h=v(C=N["$[]"]("ascii"))&&C,c=v(C=N["$[]"]("dummy"))&&C,v(N["$[]"]("inherits"))?(l=N["$[]"]("inherits").$clone()).$initialize(A,b,h,c):l=this.$new(A,b,h,c),P!==y&&D(l,"instance_eval",[],P.$to_proc()),f=E.encodings,D(b,"each",[],function m(x){return null==x&&(x=y),(null==m.$$s?this:m.$$s).$const_set(x.$tr("-","_"),l),f[x]=l},{$$arity:1,$$s:this})},-2),_(M,"$find",function(A){return F(A,"default_external")?this.$default_external():E.find_encoding(A)},1),M.$singleton_class().$attr_accessor("default_external"),M.$attr_reader("name","names"),oe(M,"$initialize",function(A,N,P,g){var b=this;return b.name=A,b.names=N,b.ascii=P,b.dummy=g},4),oe(M,"$ascii_compatible?",function(){return this.ascii},0),oe(M,"$dummy?",function(){return this.dummy},0),oe(M,"$binary?",function(){return!1},0),oe(M,"$to_s",function(){return this.name},0),oe(M,"$inspect",function(){return"#<Encoding:"+this.name+(v(this.dummy)?" (dummy)":y)+">"},0),oe(M,"$charsize",function(A){for(var N=0,P=0,g=A.length;P<g;P++){var b=A.charCodeAt(P);b>=55296&&b<=56319||N++}return N},1),oe(M,"$each_char",function z(A){var N=z.$$p||y;delete z.$$p;for(var P="",g=0,b=A.length;g<b;g++){var C=A.charCodeAt(g),h=A.charAt(g);C>=56320&&C<=57343?P=h:(C>=55296&&C<=56319&&(h=P+h),"UTF-8"!=A.encoding.name&&((h=new String(h)).encoding=A.encoding),E.yield1(N,h))}},1),oe(M,"$each_byte",function(A){return E.slice.call(arguments),V.$raise(w("NotImplementedError"))},-1),oe(M,"$bytesize",function(A){return E.slice.call(arguments),V.$raise(w("NotImplementedError"))},-1),p("::",w("StandardError"),"EncodingError"),p("::",w("EncodingError"),"CompatibilityError"),D(w("Encoding"),"register",["UTF-8",u(["aliases","ascii"],{aliases:["CP65001"],ascii:!0})],function K(){var ee=null==K.$$s?this:K.$$s;return oe(ee,"$each_byte",function M(G){var z=M.$$p||y;delete M.$$p;for(var N,A=1/0,P=G.length,g=null,b=0;b<P;++b){if((N=G.charCodeAt(b))>55295&&N<57344){if(!g){if(N>56319){(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189));continue}if(b+1===P){(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189));continue}g=N;continue}if(N<56320){(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189)),g=N;continue}N=65536+(g-55296<<10|N-56320)}else g&&(A-=3)>-1&&(E.yield1(z,239),E.yield1(z,191),E.yield1(z,189));if(g=null,N<128){if((A-=1)<0)break;E.yield1(z,N)}else if(N<2048){if((A-=2)<0)break;E.yield1(z,N>>6|192),E.yield1(z,63&N|128)}else if(N<65536){if((A-=3)<0)break;E.yield1(z,N>>12|224),E.yield1(z,N>>6&63|128),E.yield1(z,63&N|128)}else if(N<1114112){if((A-=4)<0)break;E.yield1(z,N>>18|240),E.yield1(z,N>>12&63|128),E.yield1(z,N>>6&63|128),E.yield1(z,63&N|128)}}},1),oe(ee,"$bytesize",function(G){return G.$bytes().$length()},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-16LE"],function K(){var ee=null==K.$$s?this:K.$$s;return oe(ee,"$each_byte",function M(G){var z=M.$$p||y;delete M.$$p;for(var A=0,N=G.length;A<N;A++){var P=G.charCodeAt(A);E.yield1(z,255&P),E.yield1(z,P>>8)}},1),oe(ee,"$bytesize",function(G){return 2*G.length},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-16BE",u(["inherits"],{inherits:w(w("Encoding"),"UTF_16LE")})],function K(){return oe(null==K.$$s?this:K.$$s,"$each_byte",function M(G){var z=M.$$p||y;delete M.$$p;for(var A=0,N=G.length;A<N;A++){var P=G.charCodeAt(A);E.yield1(z,P>>8),E.yield1(z,255&P)}},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-32LE"],function K(){var ee=null==K.$$s?this:K.$$s;return oe(ee,"$each_byte",function M(G){var z=M.$$p||y;delete M.$$p;for(var A=0,N=G.length;A<N;A++){var P=G.charCodeAt(A);E.yield1(z,255&P),E.yield1(z,P>>8),E.yield1(z,0),E.yield1(z,0)}},1),oe(ee,"$bytesize",function(G){return 4*G.length},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["UTF-32BE",u(["inherits"],{inherits:w(w("Encoding"),"UTF_32LE")})],function K(){return oe(null==K.$$s?this:K.$$s,"$each_byte",function M(G){var z=M.$$p||y;delete M.$$p;for(var A=0,N=G.length;A<N;A++){var P=G.charCodeAt(A);E.yield1(z,0),E.yield1(z,0),E.yield1(z,P>>8),E.yield1(z,255&P)}},1)},{$$arity:0,$$s:ae}),D(w("Encoding"),"register",["ASCII-8BIT",u(["aliases","ascii"],{aliases:["BINARY"],ascii:!0})],function K(){var ee=null==K.$$s?this:K.$$s;return oe(ee,"$each_char",function M(G){var z=M.$$p||y;delete M.$$p;for(var A=0,N=G.length;A<N;A++){var P=new String(G.charAt(A));P.encoding=G.encoding,E.yield1(z,P)}},1),oe(ee,"$charsize",function(G){return G.length},1),oe(ee,"$each_byte",function M(G){var z=M.$$p||y;delete M.$$p;for(var A=0,N=G.length;A<N;A++){var P=G.charCodeAt(A);E.yield1(z,255&P)}},1),oe(ee,"$bytesize",function(G){return G.length},1),oe(ee,"$binary?",function(){return!0},0)},{$$arity:0,$$s:ae}),w("Encoding").$register("ISO-8859-1",u(["aliases","ascii","inherits"],{aliases:["ISO8859-1"],ascii:!0,inherits:w(w("Encoding"),"ASCII_8BIT")})),w("Encoding").$register("US-ASCII",u(["aliases","ascii","inherits"],{aliases:["ASCII"],ascii:!0,inherits:w(w("Encoding"),"ASCII_8BIT")})),function(K,ee){var M=p("::",null,"String"),G=M.$$prototype;G.internal_encoding=G.bytes=G.encoding=y,M.$attr_reader("encoding"),M.$attr_reader("internal_encoding"),E.prop(String.prototype,"bytes",y),E.prop(String.prototype,"encoding",w(w("Encoding"),"UTF_8")),E.prop(String.prototype,"internal_encoding",w(w("Encoding"),"UTF_8")),oe(M,"$b",function(){return this.$dup().$force_encoding("binary")},0),oe(M,"$bytesize",function(){return this.internal_encoding.$bytesize(this)},0),oe(M,"$each_byte",function z(){var A=z.$$p||y,N=this;return delete z.$$p,A===y?D(N,"enum_for",["each_byte"],function P(){return(null==P.$$s?this:P.$$s).$bytesize()},{$$arity:0,$$s:N}):(D(N.internal_encoding,"each_byte",[N],A.$to_proc()),N)},0),oe(M,"$bytes",function(){var A=this,N=y;return"string"==typeof A?new String(A).$each_byte().$to_a():(A.bytes=v(N=A.bytes)?N:A.$each_byte().$to_a(),A.bytes.$dup())},0),oe(M,"$each_char",function z(){var A=z.$$p||y,N=this;return delete z.$$p,A===y?D(N,"enum_for",["each_char"],function P(){return(null==P.$$s?this:P.$$s).$length()},{$$arity:0,$$s:N}):(D(N.encoding,"each_char",[N],A.$to_proc()),N)},0),oe(M,"$chars",function z(){var A=z.$$p||y;return delete z.$$p,v(A)?D(this,"each_char",[],A.$to_proc()):this.$each_char().$to_a()},0),oe(M,"$each_codepoint",function z(){var A=z.$$p||y,N=this;if(delete z.$$p,A===y)return N.$enum_for("each_codepoint");for(var P=0,g=N.length;P<g;P++)E.yield1(A,N.codePointAt(P));return N},0),oe(M,"$codepoints",function z(){var A=z.$$p||y;return delete z.$$p,A!==y?D(this,"each_codepoint",[],A.$to_proc()):this.$each_codepoint().$to_a()},0),oe(M,"$encode",function(A){return E.enc(this,A)},1),oe(M,"$force_encoding",function(A){var P=this;return A===P.encoding||(A=L["$coerce_to!"](A,w("String"),"to_s"),(A=w("Encoding").$find(A))===P.encoding)||(P=E.set_encoding(P,A)),P},1),oe(M,"$getbyte",function(A){var P=y;return P=this.$bytes(),A=L["$coerce_to!"](A,w("Integer"),"to_int"),v(H(P.$length(),A))?y:P["$[]"](A)},1),oe(M,"$initialize_copy",function(A){return"\n      self.encoding = other.encoding;\n      self.internal_encoding = other.internal_encoding;\n    "},1),oe(M,"$length",function(){return this.length},0),U(M,"size","length"),oe(M,"$valid_encoding?",function(){return!0},0)}(),J=[w(a("Encoding"),"UTF_8")],D(w("Encoding"),"default_external=",se(J)),J[ue(J.length,1)]},Opal.modules["corelib/math"]=function(E){var H,U,se,ue,a=E.$$$,y=E.type_error,p=E.const_set,u=E.Class,k=E.Kernel,v=E.defs,D=E.def,_=E.truthy,F=E.rb_minus,oe=E.eqeqeq,V=E.rb_divide;return H=[],se=[U=(0,E.module)("::","Math")].concat(H),ue=E.$r(se),p(U,"E",Math.E),p(U,"PI",Math.PI),p(U,"DomainError",u.$new(a("StandardError"))),v(U,"$checked",function(K,ee){var G;if(G=E.slice.call(arguments,1),isNaN(G[0])||2==G.length&&isNaN(G[1]))return NaN;var z=Math[K].apply(null,G);return isNaN(z)&&k.$raise(ue("DomainError"),'Numerical argument is out of domain - "'+K+'"'),z},-2),v(U,"$float!",function(K){try{return k.$Float(K)}catch(ee){if(!E.rescue(ee,[a("ArgumentError")]))throw ee;try{return k.$raise(y(K,a("Float")))}finally{E.pop_exception()}}},1),v(U,"$integer!",function(K){try{return k.$Integer(K)}catch(ee){if(!E.rescue(ee,[a("ArgumentError")]))throw ee;try{return k.$raise(y(K,a("Integer")))}finally{E.pop_exception()}}},1),U.$module_function(),D(U,"$acos",function(K){return a("Math").$checked("acos",a("Math")["$float!"](K))},1),_(void 0!==Math.acosh)||(Math.acosh=function(J){return Math.log(J+Math.sqrt(J*J-1))}),D(U,"$acosh",function(K){return a("Math").$checked("acosh",a("Math")["$float!"](K))},1),D(U,"$asin",function(K){return a("Math").$checked("asin",a("Math")["$float!"](K))},1),_(void 0!==Math.asinh)||(Math.asinh=function(J){return Math.log(J+Math.sqrt(J*J+1))}),D(U,"$asinh",function(K){return a("Math").$checked("asinh",a("Math")["$float!"](K))},1),D(U,"$atan",function(K){return a("Math").$checked("atan",a("Math")["$float!"](K))},1),D(U,"$atan2",function(K,ee){return a("Math").$checked("atan2",a("Math")["$float!"](K),a("Math")["$float!"](ee))},2),_(void 0!==Math.atanh)||(Math.atanh=function(J){return.5*Math.log((1+J)/(1-J))}),D(U,"$atanh",function(K){return a("Math").$checked("atanh",a("Math")["$float!"](K))},1),_(void 0!==Math.cbrt)||(Math.cbrt=function(J){if(0==J)return 0;if(J<0)return-Math.cbrt(-J);for(var K=J,ee=0;K<.125;)K*=8,ee--;for(;K>1;)K*=.125,ee++;for(K=(-.46946116*K+1.072302)*K+.3812513;ee<0;)K*=.5,ee++;for(;ee>0;)K*=2,ee--;return 2/3*(K=2/3*(K=2/3*(K=2/3*K+1/3*J/(K*K))+1/3*J/(K*K))+1/3*J/(K*K))+1/3*J/(K*K)}),D(U,"$cbrt",function(K){return a("Math").$checked("cbrt",a("Math")["$float!"](K))},1),D(U,"$cos",function(K){return a("Math").$checked("cos",a("Math")["$float!"](K))},1),_(void 0!==Math.cosh)||(Math.cosh=function(J){return(Math.exp(J)+Math.exp(-J))/2}),D(U,"$cosh",function(K){return a("Math").$checked("cosh",a("Math")["$float!"](K))},1),_(void 0!==Math.erf)||E.prop(Math,"erf",function(J){var N=1;J<0&&(N=-1);var P=1/(1+.3275911*(J=Math.abs(J)));return N*(1-((((1.061405429*P-1.453152027)*P+1.421413741)*P-.284496736)*P+.254829592)*P*Math.exp(-J*J))}),D(U,"$erf",function(K){return a("Math").$checked("erf",a("Math")["$float!"](K))},1),_(void 0!==Math.erfc)||E.prop(Math,"erfc",function(J){var K=Math.abs(J),ee=1/(.5*K+1),c=ee*Math.exp(-K*K-1.26551223+ee*(ee*(ee*(ee*(ee*(ee*(ee*(ee*(.17087277*ee-.82215223)+1.48851587)-1.13520398)+.27886807)-.18628806)+.09678418)+.37409196)+1.00002368));return J<0?2-c:c}),D(U,"$erfc",function(K){return a("Math").$checked("erfc",a("Math")["$float!"](K))},1),D(U,"$exp",function(K){return a("Math").$checked("exp",a("Math")["$float!"](K))},1),D(U,"$frexp",function(K){if(K=ue("Math")["$float!"](K),isNaN(K))return[NaN,0];var ee=Math.floor(Math.log(Math.abs(K))/Math.log(2))+1;return[K/Math.pow(2,ee),ee]},1),D(U,"$gamma",function(K){K=ue("Math")["$float!"](K);var ee,M,G,z,A,N,P,g,b,h=[.9999999999999971,57.15623566586292,-59.59796035547549,14.136097974741746,-.4919138160976202,3399464998481189e-20,4652362892704858e-20,-9837447530487956e-20,.0001580887032249125,-.00021026444172410488,.00021743961811521265,-.0001643181065367639,8441822398385275e-20,-26190838401581408e-21,36899182659531625e-22];if(isNaN(K))return NaN;if(0===K&&1/K<0)return-1/0;if((-1===K||K===-1/0)&&k.$raise(ue("DomainError"),'Numerical argument is out of domain - "gamma"'),ue("Integer")["$==="](K)){if(K<=0)return isFinite(K)?1/0:NaN;if(K>171)return 1/0;for(z=K-2,A=K-1;z>1;)A*=z,z--;return 0==A&&(A=1),A}if(K<.5)return Math.PI/(Math.sin(Math.PI*K)*a("Math").$gamma(F(1,K)));if(K>=171.35)return 1/0;if(K>85)return b=(g=(P=(N=K*K)*K)*K)*K,Math.sqrt(2*Math.PI/K)*Math.pow(K/Math.E,K)*(1+1/(12*K)+1/(288*N)-139/(51840*P)-571/(2488320*g)+163879/(209018880*b)+5246819/(75246796800*b*K));for(K-=1,G=h[0],ee=1;ee<h.length;++ee)G+=h[ee]/(K+ee);return M=K+4.7421875+.5,Math.sqrt(2*Math.PI)*Math.pow(M,K+.5)*Math.exp(-M)*G},1),_(void 0!==Math.hypot)||(Math.hypot=function(J,K){return Math.sqrt(J*J+K*K)}),D(U,"$hypot",function(K,ee){return a("Math").$checked("hypot",a("Math")["$float!"](K),a("Math")["$float!"](ee))},2),D(U,"$ldexp",function(K,ee){return K=ue("Math")["$float!"](K),ee=ue("Math")["$integer!"](ee),isNaN(ee)&&k.$raise(a("RangeError"),"float NaN out of range of integer"),K*Math.pow(2,ee)},2),D(U,"$lgamma",function(K){return-1==K?[1/0,1]:[Math.log(Math.abs(a("Math").$gamma(K))),a("Math").$gamma(K)<0?-1:1]},1),D(U,"$log",function(K,ee){return oe(a("String"),K)&&k.$raise(y(K,a("Float"))),_(null==ee)?a("Math").$checked("log",a("Math")["$float!"](K)):(oe(a("String"),ee)&&k.$raise(y(ee,a("Float"))),V(a("Math").$checked("log",a("Math")["$float!"](K)),a("Math").$checked("log",a("Math")["$float!"](ee))))},-2),_(void 0!==Math.log10)||(Math.log10=function(J){return Math.log(J)/Math.LN10}),D(U,"$log10",function(K){return oe(a("String"),K)&&k.$raise(y(K,a("Float"))),a("Math").$checked("log10",a("Math")["$float!"](K))},1),_(void 0!==Math.log2)||(Math.log2=function(J){return Math.log(J)/Math.LN2}),D(U,"$log2",function(K){return oe(a("String"),K)&&k.$raise(y(K,a("Float"))),a("Math").$checked("log2",a("Math")["$float!"](K))},1),D(U,"$sin",function(K){return a("Math").$checked("sin",a("Math")["$float!"](K))},1),_(void 0!==Math.sinh)||(Math.sinh=function(J){return(Math.exp(J)-Math.exp(-J))/2}),D(U,"$sinh",function(K){return a("Math").$checked("sinh",a("Math")["$float!"](K))},1),D(U,"$sqrt",function(K){return a("Math").$checked("sqrt",a("Math")["$float!"](K))},1),D(U,"$tan",function(K){return K=a("Math")["$float!"](K),_(K["$infinite?"]())?a(a("Float"),"NAN"):a("Math").$checked("tan",a("Math")["$float!"](K))},1),_(void 0!==Math.tanh)||(Math.tanh=function(J){return J==1/0?1:J==-1/0?-1:(Math.exp(J)-Math.exp(-J))/(Math.exp(J)+Math.exp(-J))}),D(U,"$tanh",function(K){return a("Math").$checked("tanh",a("Math")["$float!"](K))},1)},Opal.modules["corelib/complex/base"]=function(E){var k,v,D,_,ae=[],Y=E.nil,y=E.truthy,w=E.def,p=E.klass;return k=ae,D=[v=(0,E.module)("::","Kernel")].concat(k),_=E.$r(D),w(v,"$Complex",function(oe,V){return null==V&&(V=Y),y(V)?_("Complex").$new(oe,V):_("Complex").$new(oe,0)},-2),function(u,k,v){var D=p("::",null,"String"),_=[D].concat(v),F=E.$r(_);return w(D,"$to_c",function(){return F("Complex").$from_string(this)},0)}(0,0,ae)},Opal.modules["corelib/complex"]=function(E){var M,G,z,A,N,ae=E.top,a=E.nil,y=E.$$$,w=E.klass,p=E.truthy,u=E.eqeqeq,k=E.Kernel,v=E.defs,D=E.rb_times,_=E.def,F=E.rb_plus,oe=E.rb_minus,V=E.rb_divide,L=E.eqeq,H=E.to_ary,U=E.rb_gt,se=E.neqeq,ue=E.const_set,J=E.alias;return ae.$require("corelib/numeric"),ae.$require("corelib/complex/base"),M=[],z=[G=w("::",y("Numeric"),"Complex")].concat(M),A=E.$r(z),(N=G.$$prototype).real=N.imag=a,v(G,"$rect",function(g,b){return null==b&&(b=0),u(y("Numeric"),g)&&p(g["$real?"]())&&u(y("Numeric"),b)&&p(b["$real?"]())||k.$raise(y("TypeError"),"not a real"),this.$new(g,b)},-2),v(G,"$polar",function(g,b){return null==b&&(b=0),u(y("Numeric"),g)&&p(g["$real?"]())&&u(y("Numeric"),b)&&p(b["$real?"]())||k.$raise(y("TypeError"),"not a real"),this.$new(D(g,y("Math").$cos(b)),D(g,y("Math").$sin(b)))},-2),G.$attr_reader("real","imag"),_(G,"$initialize",function(g,b){return null==b&&(b=0),this.real=g,this.imag=b},-2),_(G,"$coerce",function(g){return u(y("Complex"),g)?[g,this]:u(y("Numeric"),g)&&p(g["$real?"]())?[y("Complex").$new(g,0),this]:k.$raise(y("TypeError"),g.$class()+" can't be coerced into Complex")},1),_(G,"$==",function(g){var b=this,C=a;return u(y("Complex"),g)?p(C=b.real["$=="](g.$real()))?b.imag["$=="](g.$imag()):C:u(y("Numeric"),g)&&p(g["$real?"]())?p(C=b.real["$=="](g))?b.imag["$=="](0):C:g["$=="](b)},1),_(G,"$-@",function(){return k.$Complex(this.real["$-@"](),this.imag["$-@"]())},0),_(G,"$+",function(g){var b=this;return u(y("Complex"),g)?k.$Complex(F(b.real,g.$real()),F(b.imag,g.$imag())):u(y("Numeric"),g)&&p(g["$real?"]())?k.$Complex(F(b.real,g),b.imag):b.$__coerced__("+",g)},1),_(G,"$-",function(g){var b=this;return u(y("Complex"),g)?k.$Complex(oe(b.real,g.$real()),oe(b.imag,g.$imag())):u(y("Numeric"),g)&&p(g["$real?"]())?k.$Complex(oe(b.real,g),b.imag):b.$__coerced__("-",g)},1),_(G,"$*",function(g){var b=this;return u(y("Complex"),g)?k.$Complex(oe(D(b.real,g.$real()),D(b.imag,g.$imag())),F(D(b.real,g.$imag()),D(b.imag,g.$real()))):u(y("Numeric"),g)&&p(g["$real?"]())?k.$Complex(D(b.real,g),D(b.imag,g)):b.$__coerced__("*",g)},1),_(G,"$/",function(g){var b=this;return u(y("Complex"),g)?u(y("Number"),b.real)&&p(b.real["$nan?"]())||u(y("Number"),b.imag)&&p(b.imag["$nan?"]())||u(y("Number"),g.$real())&&p(g.$real()["$nan?"]())||u(y("Number"),g.$imag())&&p(g.$imag()["$nan?"]())?y("Complex").$new(y(y("Float"),"NAN"),y(y("Float"),"NAN")):V(D(b,g.$conj()),g.$abs2()):u(y("Numeric"),g)&&p(g["$real?"]())?k.$Complex(b.real.$quo(g),b.imag.$quo(g)):b.$__coerced__("/",g)},1),_(G,"$**",function(g){var b,C,h,c,l=this,f=a,m=a,x=a,S=a,Z=a,le=a,ye=a,T=a,R=a,ie=a,j=a;if(L(g,0))return y("Complex").$new(1,0);if(u(y("Complex"),g))return C=l.$polar(),f=null==(b=H(C))[0]?a:b[0],m=null==b[1]?a:b[1],x=g.$real(),S=g.$imag(),Z=y("Math").$exp(oe(D(x,y("Math").$log(f)),D(S,m))),le=F(D(m,x),D(S,y("Math").$log(f))),y("Complex").$polar(Z,le);if(u(y("Integer"),g)){if(p(U(g,0))){for(T=ye=l,R=oe(g,1);se(R,0);){for(h=R.$divmod(2),ie=null==(C=H(h))[0]?a:C[0],j=null==C[1]?a:C[1];L(j,0);)ye=k.$Complex(oe(D(ye.$real(),ye.$real()),D(ye.$imag(),ye.$imag())),D(D(2,ye.$real()),ye.$imag())),c=(R=ie).$divmod(2),ie=null==(h=H(c))[0]?a:h[0],j=null==h[1]?a:h[1];T=D(T,ye),R=oe(R,1)}return T}return V(y("Rational").$new(1,1),l)["$**"](g["$-@"]())}return u(y("Float"),g)||u(y("Rational"),g)?(C=l.$polar(),f=null==(b=H(C))[0]?a:b[0],m=null==b[1]?a:b[1],y("Complex").$polar(f["$**"](g),D(m,g))):l.$__coerced__("**",g)},1),_(G,"$abs",function(){return y("Math").$hypot(this.real,this.imag)},0),_(G,"$abs2",function(){var g=this;return F(D(g.real,g.real),D(g.imag,g.imag))},0),_(G,"$angle",function(){return y("Math").$atan2(this.imag,this.real)},0),_(G,"$conj",function(){return k.$Complex(this.real,this.imag["$-@"]())},0),_(G,"$denominator",function(){return this.real.$denominator().$lcm(this.imag.$denominator())},0),_(G,"$eql?",function(g){var C,h,b=this;return p(C=p(h=A("Complex")["$==="](g))?b.real.$class()["$=="](b.imag.$class()):h)?b["$=="](g):C},1),_(G,"$fdiv",function(g){return u(y("Numeric"),g)||k.$raise(y("TypeError"),g.$class()+" can't be coerced into Complex"),V(this,g)},1),_(G,"$finite?",function(){var b;return p(b=this.real["$finite?"]())?this.imag["$finite?"]():b},0),_(G,"$hash",function(){return"Complex:"+this.real+":"+this.imag},0),_(G,"$infinite?",function(){var b;return p(b=this.real["$infinite?"]())?b:this.imag["$infinite?"]()},0),_(G,"$inspect",function(){return"("+this+")"},0),_(G,"$numerator",function(){var b,g=this;return b=g.$denominator(),k.$Complex(D(g.real.$numerator(),V(b,g.real.$denominator())),D(g.imag.$numerator(),V(b,g.imag.$denominator())))},0),_(G,"$polar",function(){return[this.$abs(),this.$arg()]},0),_(G,"$rationalize",function(g){var b=this;return arguments.length>1&&k.$raise(y("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),se(b.imag,0)&&k.$raise(y("RangeError"),"can't convert "+b+" into Rational"),b.$real().$rationalize(g)},-1),_(G,"$real?",function(){return!1},0),_(G,"$rect",function(){return[this.real,this.imag]},0),_(G,"$to_f",function(){var g=this;return L(g.imag,0)||k.$raise(y("RangeError"),"can't convert "+g+" into Float"),g.real.$to_f()},0),_(G,"$to_i",function(){var g=this;return L(g.imag,0)||k.$raise(y("RangeError"),"can't convert "+g+" into Integer"),g.real.$to_i()},0),_(G,"$to_r",function(){var g=this;return L(g.imag,0)||k.$raise(y("RangeError"),"can't convert "+g+" into Rational"),g.real.$to_r()},0),_(G,"$to_s",function(){var g=this,b=a;return b=g.real.$inspect(),b=F(b,u(y("Number"),g.imag)&&p(g.imag["$nan?"]())||p(g.imag["$positive?"]())||p(g.imag["$zero?"]())?"+":"-"),b=F(b,g.imag.$abs().$inspect()),u(y("Number"),g.imag)&&(p(g.imag["$nan?"]())||p(g.imag["$infinite?"]()))&&(b=F(b,"*")),F(b,"i")},0),ue(z[0],"I",G.$new(0,1)),v(G,"$from_string",function(g){var h,c,b=/[+-]?[\d_]+(\.[\d_]+)?(e\d+)?/;function f(){return b.test(g)}function m(){var Z=g.match(b)[0];return g=g.slice(Z.length),Z.replace(/_/g,"")}function x(){if(f()){var S=parseFloat(m());if("/"===g[0]){if(g=g.slice(1),f()){var Z=parseFloat(m());return k.$Rational(S,Z)}return g="/"+g,S}return S}return null}return g.match(b),(h=x())?(c=x())?k.$Complex(h,c):"i"===g[0]?k.$Complex(0,h):k.$Complex(h,0):k.$Complex(0,"i"===g[0]?1:"-"===g[0]&&"i"===g[1]?-1:"+"===g[0]&&"i"===g[1]?1:0)},1),J(E.get_singleton_class(G),"rectangular","rect"),J(G,"arg","angle"),J(G,"conjugate","conj"),J(G,"divide","/"),J(G,"imaginary","imag"),J(G,"magnitude","abs"),J(G,"phase","arg"),J(G,"quo","/"),J(G,"rectangular","rect"),E.udef(G,"$negative?"),E.udef(G,"$positive?"),E.udef(G,"$step"),a},Opal.modules["corelib/rational/base"]=function(E){var Y=E.$$$,y=E.def,w=E.klass;return y((0,E.module)("::","Kernel"),"$Rational",function(v,D){return null==D&&(D=1),Y("Rational").$convert(v,D)},-2),y(w("::",null,"String"),"$to_r",function(){return Y("Rational").$from_string(this)},0)},Opal.modules["corelib/rational"]=function(E){var M,G,ae=E.top,Y=E.nil,a=E.$$$,y=E.klass,w=E.eqeq,p=E.Kernel,u=E.truthy,k=E.rb_lt,v=E.rb_divide,D=E.defs,_=E.eqeqeq,F=E.not,oe=E.Opal,V=E.def,L=E.rb_minus,H=E.rb_times,U=E.rb_plus,se=E.rb_gt,ue=E.rb_le,J=E.alias;return ae.$require("corelib/numeric"),ae.$require("corelib/rational/base"),(G=(M=y("::",a("Numeric"),"Rational")).$$prototype).num=G.den=Y,D(M,"$reduce",function(A,N){var g;if(A=A.$to_i(),N=N.$to_i(),w(N,0))p.$raise(a("ZeroDivisionError"),"divided by 0");else if(u(k(N,0)))A=A["$-@"](),N=N["$-@"]();else if(w(N,1))return this.$new(A,N);return g=A.$gcd(N),this.$new(v(A,g),v(N,g))},2),D(M,"$convert",function(A,N){return(u(A["$nil?"]())||u(N["$nil?"]()))&&p.$raise(a("TypeError"),"cannot convert nil into Rational"),_(a("Integer"),A)&&_(a("Integer"),N)?this.$reduce(A,N):((_(a("Float"),A)||_(a("String"),A)||_(a("Complex"),A))&&(A=A.$to_r()),(_(a("Float"),N)||_(a("String"),N)||_(a("Complex"),N))&&(N=N.$to_r()),u(N["$equal?"](1))&&F(a("Integer")["$==="](A))?oe["$coerce_to!"](A,a("Rational"),"to_r"):_(a("Numeric"),A)&&_(a("Numeric"),N)?v(A,N):this.$reduce(A,N))},2),V(M,"$initialize",function(A,N){return this.num=A,this.den=N},2),V(M,"$numerator",function(){return this.num},0),V(M,"$denominator",function(){return this.den},0),V(M,"$coerce",function(A){var P,N=this;return _(a("Rational"),P=A)?[A,N]:_(a("Integer"),P)?[A.$to_r(),N]:_(a("Float"),P)?[A,N.$to_f()]:Y},1),V(M,"$==",function(A){var P,N=this,g=Y;return _(a("Rational"),P=A)?u(g=N.num["$=="](A.$numerator()))?N.den["$=="](A.$denominator()):g:_(a("Integer"),P)?u(g=N.num["$=="](A))?N.den["$=="](1):g:_(a("Float"),P)?N.$to_f()["$=="](A):A["$=="](N)},1),V(M,"$<=>",function(A){var P,N=this;return _(a("Rational"),P=A)?L(H(N.num,A.$denominator()),H(N.den,A.$numerator()))["$<=>"](0):_(a("Integer"),P)?L(N.num,H(N.den,A))["$<=>"](0):_(a("Float"),P)?N.$to_f()["$<=>"](A):N.$__coerced__("<=>",A)},1),V(M,"$+",function(A){var P,N=this,g=Y,b=Y;return _(a("Rational"),P=A)?(g=U(H(N.num,A.$denominator()),H(N.den,A.$numerator())),b=H(N.den,A.$denominator()),p.$Rational(g,b)):_(a("Integer"),P)?p.$Rational(U(N.num,H(A,N.den)),N.den):_(a("Float"),P)?U(N.$to_f(),A):N.$__coerced__("+",A)},1),V(M,"$-",function(A){var P,N=this,g=Y,b=Y;return _(a("Rational"),P=A)?(g=L(H(N.num,A.$denominator()),H(N.den,A.$numerator())),b=H(N.den,A.$denominator()),p.$Rational(g,b)):_(a("Integer"),P)?p.$Rational(L(N.num,H(A,N.den)),N.den):_(a("Float"),P)?L(N.$to_f(),A):N.$__coerced__("-",A)},1),V(M,"$*",function(A){var P,N=this,g=Y,b=Y;return _(a("Rational"),P=A)?(g=H(N.num,A.$numerator()),b=H(N.den,A.$denominator()),p.$Rational(g,b)):_(a("Integer"),P)?p.$Rational(H(N.num,A),N.den):_(a("Float"),P)?H(N.$to_f(),A):N.$__coerced__("*",A)},1),V(M,"$/",function(A){var P,N=this,g=Y,b=Y;return _(a("Rational"),P=A)?(g=H(N.num,A.$denominator()),b=H(N.den,A.$numerator()),p.$Rational(g,b)):_(a("Integer"),P)?w(A,0)?v(N.$to_f(),0):p.$Rational(N.num,H(N.den,A)):_(a("Float"),P)?v(N.$to_f(),A):N.$__coerced__("/",A)},1),V(M,"$**",function(A){var P,N=this;return _(a("Integer"),P=A)?w(N,0)&&u(k(A,0))?a(a("Float"),"INFINITY"):u(se(A,0))?p.$Rational(N.num["$**"](A),N.den["$**"](A)):u(k(A,0))?p.$Rational(N.den["$**"](A["$-@"]()),N.num["$**"](A["$-@"]())):p.$Rational(1,1):_(a("Float"),P)?N.$to_f()["$**"](A):_(a("Rational"),P)?w(A,0)?p.$Rational(1,1):w(A.$denominator(),1)?u(k(A,0))?p.$Rational(N.den["$**"](A.$numerator().$abs()),N.num["$**"](A.$numerator().$abs())):p.$Rational(N.num["$**"](A.$numerator()),N.den["$**"](A.$numerator())):w(N,0)&&u(k(A,0))?p.$raise(a("ZeroDivisionError"),"divided by 0"):N.$to_f()["$**"](A):N.$__coerced__("**",A)},1),V(M,"$abs",function(){return p.$Rational(this.num.$abs(),this.den.$abs())},0),V(M,"$ceil",function(A){var N=this;return null==A&&(A=0),w(A,0)?v(N.num["$-@"](),N.den)["$-@"]().$ceil():N.$with_precision("ceil",A)},-1),V(M,"$floor",function(A){var N=this;return null==A&&(A=0),w(A,0)?v(N.num["$-@"](),N.den)["$-@"]().$floor():N.$with_precision("floor",A)},-1),V(M,"$hash",function(){return"Rational:"+this.num+":"+this.den},0),V(M,"$inspect",function(){return"("+this+")"},0),V(M,"$rationalize",function(A){var N=this;if(arguments.length>1&&p.$raise(a("ArgumentError"),"wrong number of arguments ("+arguments.length+" for 0..1)"),null==A)return N;for(var f,m,x,S,Z,P=A.$abs(),g=L(N,P),b=U(N,P),C=0,h=1,c=1,l=0;x=g.$ceil(),!ue(x,b);)f=(S=x-1)*h+C,m=S*l+c,Z=v(1,L(b,S)),b=v(1,L(g,S)),g=Z,C=h,c=l,h=f,l=m;return p.$Rational(x*h+C,x*l+c)},-1),V(M,"$round",function(A){var N=this,P=Y,g=Y,b=Y;return null==A&&(A=0),w(A,0)?w(N.num,0)?0:w(N.den,1)?N.num:(P=U(H(N.num.$abs(),2),N.den),g=H(N.den,2),b=v(P,g).$truncate(),u(k(N.num,0))?b["$-@"]():b):N.$with_precision("round",A)},-1),V(M,"$to_f",function(){return v(this.num,this.den)},0),V(M,"$to_i",function(){return this.$truncate()},0),V(M,"$to_r",function(){return this},0),V(M,"$to_s",function(){return this.num+"/"+this.den},0),V(M,"$truncate",function(A){var N=this;return null==A&&(A=0),w(A,0)?u(k(N.num,0))?N.$ceil():N.$floor():N.$with_precision("truncate",A)},-1),V(M,"$with_precision",function(A,N){var g,b=Y;return _(a("Integer"),N)||p.$raise(a("TypeError"),"not an Integer"),g=10["$**"](N),b=H(this,g),u(k(N,1))?v(b.$send(A),g).$to_i():p.$Rational(b.$send(A),g)},2),D(M,"$from_string",function(A){var b,C,N=A.trimLeft(),P=/^[+-]?[\d_]+(\.[\d_]+)?/;function h(){return P.test(N)}function c(){var f=N.match(P)[0];return N=N.slice(f.length),f.replace(/_/g,"")}return N.match(P),h()?(b=parseFloat(c()),"/"===N[0]?(N=N.slice(1),h()?(C=parseFloat(c()),p.$Rational(b,C)):p.$Rational(b,1)):p.$Rational(b,1)):p.$Rational(0,1)},1),J(M,"divide","/"),J(M,"quo","/")},Opal.modules["corelib/time"]=function(E){var a=E.nil,y=E.$$$,w=E.slice,p=E.klass,u=E.Kernel,k=E.Opal,v=E.defs,D=E.eqeqeq,_=E.def,F=E.truthy,oe=E.rb_gt,V=E.rb_lt,L=E.rb_plus,H=E.rb_divide,U=E.rb_minus,se=E.range,ue=E.neqeq,J=E.rb_le,K=E.eqeq,ee=E.alias;return E.top.$require("corelib/comparable"),function(M,G,z){var A=p("::",G,"Time"),N=[A].concat([]),P=E.$r(N);A.$include(y("Comparable"));var l,g=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],b=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],C=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],h=["January","February","March","April","May","June","July","August","September","October","November","December"];function c(l,f,m,x,S,Z){if(l=l.$$is_string?parseInt(l,10):k["$coerce_to!"](l,y("Integer"),"to_int"),f===a)f=1;else if(!f.$$is_number)if(f["$respond_to?"]("to_str"))switch(f=f.$to_str(),f.toLowerCase()){case"jan":f=1;break;case"feb":f=2;break;case"mar":f=3;break;case"apr":f=4;break;case"may":f=5;break;case"jun":f=6;break;case"jul":f=7;break;case"aug":f=8;break;case"sep":f=9;break;case"oct":f=10;break;case"nov":f=11;break;case"dec":f=12;break;default:f=f.$to_i()}else f=k["$coerce_to!"](f,y("Integer"),"to_int");return(f<1||f>12)&&u.$raise(y("ArgumentError"),"month out of range: "+f),f-=1,((m=m===a?1:m.$$is_string?parseInt(m,10):k["$coerce_to!"](m,y("Integer"),"to_int"))<1||m>31)&&u.$raise(y("ArgumentError"),"day out of range: "+m),((x=x===a?0:x.$$is_string?parseInt(x,10):k["$coerce_to!"](x,y("Integer"),"to_int"))<0||x>24)&&u.$raise(y("ArgumentError"),"hour out of range: "+x),((S=S===a?0:S.$$is_string?parseInt(S,10):k["$coerce_to!"](S,y("Integer"),"to_int"))<0||S>59)&&u.$raise(y("ArgumentError"),"min out of range: "+S),Z===a?Z=0:Z.$$is_number||(Z=Z.$$is_string?parseInt(Z,10):k["$coerce_to!"](Z,y("Integer"),"to_int")),(Z<0||Z>60)&&u.$raise(y("ArgumentError"),"sec out of range: "+Z),[l,f,m,x,S,Z]}return v(A,"$at",function(f,m){var x;return y("Time")["$==="](f)?(void 0!==m&&u.$raise(y("TypeError"),"can't convert Time into an exact number"),(x=new Date(f.getTime())).is_utc=f.is_utc,x):(f.$$is_number||(f=k["$coerce_to!"](f,y("Integer"),"to_int")),void 0===m?new Date(1e3*f):(m.$$is_number||(m=k["$coerce_to!"](m,y("Integer"),"to_int")),new Date(1e3*f+m/1e3)))},-2),v(A,"$new",function(f,m,x,S,Z,le,ye){var T,R;return null==m&&(m=a),null==x&&(x=a),null==S&&(S=a),null==Z&&(Z=a),null==le&&(le=a),null==ye&&(ye=a),void 0===f?new Date:(ye!==a&&u.$raise(y("ArgumentError"),"Opal does not support explicitly specifying UTC offset for Time"),f=(T=c(f,m,x,S,Z,le))[0],m=T[1],x=T[2],S=T[3],Z=T[4],le=T[5],R=new Date(f,m,x,S,Z,0,1e3*le),f<100&&R.setFullYear(f),R)},-1),v(A,"$local",function(f,m,x,S,Z,le,ye,T,R,ie){var j,ve;return null==m&&(m=a),null==x&&(x=a),null==S&&(S=a),null==Z&&(Z=a),null==le&&(le=a),null==ye&&(ye=a),null==T&&(T=a),null==R&&(R=a),null==ie&&(ie=a),10===arguments.length&&(f=(j=w.call(arguments))[5],m=j[4],x=j[3],S=j[2],Z=j[1],le=j[0]),f=(j=c(f,m,x,S,Z,le))[0],m=j[1],x=j[2],S=j[3],Z=j[4],le=j[5],ve=new Date(f,m,x,S,Z,0,1e3*le),f<100&&ve.setFullYear(f),ve},-2),v(A,"$gm",function(f,m,x,S,Z,le,ye,T,R,ie){var j,ve;return null==m&&(m=a),null==x&&(x=a),null==S&&(S=a),null==Z&&(Z=a),null==le&&(le=a),null==ye&&(ye=a),null==T&&(T=a),null==R&&(R=a),null==ie&&(ie=a),10===arguments.length&&(f=(j=w.call(arguments))[5],m=j[4],x=j[3],S=j[2],Z=j[1],le=j[0]),f=(j=c(f,m,x,S,Z,le))[0],m=j[1],x=j[2],S=j[3],Z=j[4],le=j[5],ve=new Date(Date.UTC(f,m,x,S,Z,0,1e3*le)),f<100&&ve.setUTCFullYear(f),ve.is_utc=!0,ve},-2),v(A,"$now",function(){return this.$new()},0),_(A,"$+",function(f){D(y("Time"),f)&&u.$raise(y("TypeError"),"time + time?"),f.$$is_number||(f=k["$coerce_to!"](f,y("Integer"),"to_int"));var x=new Date(this.getTime()+1e3*f);return x.is_utc=this.is_utc,x},1),_(A,"$-",function(f){var m=this;if(D(y("Time"),f))return(m.getTime()-f.getTime())/1e3;f.$$is_number||(f=k["$coerce_to!"](f,y("Integer"),"to_int"));var x=new Date(m.getTime()-1e3*f);return x.is_utc=m.is_utc,x},1),_(A,"$<=>",function(f){var x=a;return D(y("Time"),f)?this.$to_f()["$<=>"](f.$to_f()):(x=f["$<=>"](this),F(x["$nil?"]())?a:F(oe(x,0))?-1:F(V(x,0))?1:0)},1),_(A,"$==",function(f){var x;return F(x=y("Time")["$==="](f))?this.$to_f()===f.$to_f():x},1),_(A,"$asctime",function(){return this.$strftime("%a %b %e %H:%M:%S %Y")},0),_(A,"$day",function(){var f=this;return f.is_utc?f.getUTCDate():f.getDate()},0),_(A,"$yday",function(){var m,x,f=this;return m=P("Time").$new(f.$year()).$to_i(),x=P("Time").$new(f.$year(),f.$month(),f.$day()).$to_i(),L(H(U(x,m),86400).$round(),1)},0),_(A,"$isdst",function(){var f=this,m=new Date(f.getFullYear(),0,1),x=new Date(f.getFullYear(),6,1);return f.getTimezoneOffset()<Math.max(m.getTimezoneOffset(),x.getTimezoneOffset())},0),_(A,"$dup",function(){var f=this,m=a;return(m=new Date(f.getTime())).$copy_instance_variables(f),m.$initialize_dup(f),m},0),_(A,"$eql?",function(f){var x;return F(x=f["$is_a?"](y("Time")))?this["$<=>"](f)["$zero?"]():x},1),_(A,"$friday?",function(){return 5==this.$wday()},0),_(A,"$hash",function(){return"Time:"+this.getTime()},0),_(A,"$hour",function(){var f=this;return f.is_utc?f.getUTCHours():f.getHours()},0),_(A,"$inspect",function(){var f=this;return F(f["$utc?"]())?f.$strftime("%Y-%m-%d %H:%M:%S UTC"):f.$strftime("%Y-%m-%d %H:%M:%S %z")},0),_(A,"$min",function(){var f=this;return f.is_utc?f.getUTCMinutes():f.getMinutes()},0),_(A,"$mon",function(){var f=this;return(f.is_utc?f.getUTCMonth():f.getMonth())+1},0),_(A,"$monday?",function(){return 1==this.$wday()},0),_(A,"$saturday?",function(){return 6==this.$wday()},0),_(A,"$sec",function(){var f=this;return f.is_utc?f.getUTCSeconds():f.getSeconds()},0),_(A,"$succ",function(){var m=new Date(this.getTime()+1e3);return m.is_utc=this.is_utc,m},0),_(A,"$usec",function(){return 1e3*this.getMilliseconds()},0),_(A,"$zone",function(){var x,m=this.toString();return"GMT"==(x=-1==m.indexOf("(")?m.match(/[A-Z]{3,4}/)[0]:m.match(/\((.+)\)(?:\s|$)/)[1])&&/(GMT\W*\d{4})/.test(m)?RegExp.$1:x},0),_(A,"$getgm",function(){var m=new Date(this.getTime());return m.is_utc=!0,m},0),_(A,"$gmtime",function(){return this.is_utc=!0,this},0),_(A,"$gmt?",function(){return!0===this.is_utc},0),_(A,"$gmt_offset",function(){return this.is_utc?0:60*-this.getTimezoneOffset()},0),_(A,"$strftime",function(f){var m=this;return f.replace(/%([\-_#^0]*:{0,2})(\d+)?([EO]*)(.)/g,function(x,S,Z,le,ye){var T="",R=-1!==S.indexOf("0"),ie=-1===S.indexOf("-"),j=-1!==S.indexOf("_"),ve=-1!==S.indexOf("^"),de=-1!==S.indexOf("#"),we=(S.match(":")||[]).length;switch(Z=parseInt(Z,10),R&&j&&(S.indexOf("0")<S.indexOf("_")?R=!1:j=!1),ye){case"Y":T+=m.$year();break;case"C":R=!j,T+=Math.round(m.$year()/100);break;case"y":R=!j,T+=m.$year()%100;break;case"m":R=!j,T+=m.$mon();break;case"B":T+=h[m.$mon()-1];break;case"b":case"h":j=!R,T+=C[m.$mon()-1];break;case"d":R=!j,T+=m.$day();break;case"e":j=!R,T+=m.$day();break;case"j":R=!j,Z=isNaN(Z)?3:Z,T+=m.$yday();break;case"H":R=!j,T+=m.$hour();break;case"k":j=!R,T+=m.$hour();break;case"I":R=!j,T+=m.$hour()%12||12;break;case"l":j=!R,T+=m.$hour()%12||12;break;case"P":T+=m.$hour()>=12?"pm":"am";break;case"p":T+=m.$hour()>=12?"PM":"AM";break;case"M":R=!j,T+=m.$min();break;case"S":R=!j,T+=m.$sec();break;case"L":R=!j,Z=isNaN(Z)?3:Z,T+=m.getMilliseconds();break;case"N":Z=isNaN(Z)?9:Z,T=(T+=m.getMilliseconds().toString().$rjust(3,"0")).$ljust(Z,"0");break;case"z":var ce=m.getTimezoneOffset(),he=Math.floor(Math.abs(ce)/60),B=Math.abs(ce)%60;T+=ce<0?"+":"-",T+=he<10?"0":"",T+=he,we>0&&(T+=":"),T+=B<10?"0":"",T+=B,we>1&&(T+=":00");break;case"Z":T+=m.$zone();break;case"A":T+=g[m.$wday()];break;case"a":T+=b[m.$wday()];break;case"u":T+=m.$wday()+1;break;case"w":T+=m.$wday();break;case"V":T+=m.$cweek_cyear()["$[]"](0).$to_s().$rjust(2,"0");break;case"G":T+=m.$cweek_cyear()["$[]"](1);break;case"g":T+=m.$cweek_cyear()["$[]"](1)["$[]"](se(-2,-1,!1));break;case"s":T+=m.$to_i();break;case"n":T+="\n";break;case"t":T+="\t";break;case"%":T+="%";break;case"c":T+=m.$strftime("%a %b %e %T %Y");break;case"D":case"x":T+=m.$strftime("%m/%d/%y");break;case"F":T+=m.$strftime("%Y-%m-%d");break;case"v":T+=m.$strftime("%e-%^b-%4Y");break;case"r":T+=m.$strftime("%I:%M:%S %p");break;case"R":T+=m.$strftime("%H:%M");break;case"T":case"X":T+=m.$strftime("%H:%M:%S");break;default:return x}return ve&&(T=T.toUpperCase()),de&&(T=T.replace(/[A-Z]/,function(O){O.toLowerCase()}).replace(/[a-z]/,function(O){O.toUpperCase()})),ie&&(R||j)&&(T=T.$rjust(isNaN(Z)?2:Z,j?" ":"0")),T})},1),_(A,"$sunday?",function(){return 0==this.$wday()},0),_(A,"$thursday?",function(){return 4==this.$wday()},0),_(A,"$to_a",function(){var f=this;return[f.$sec(),f.$min(),f.$hour(),f.$day(),f.$month(),f.$year(),f.$wday(),f.$yday(),f.$isdst(),f.$zone()]},0),_(A,"$to_f",function(){return this.getTime()/1e3},0),_(A,"$to_i",function(){return parseInt(this.getTime()/1e3,10)},0),_(A,"$tuesday?",function(){return 2==this.$wday()},0),_(A,"$wday",function(){var f=this;return f.is_utc?f.getUTCDay():f.getDay()},0),_(A,"$wednesday?",function(){return 3==this.$wday()},0),_(A,"$year",function(){var f=this;return f.is_utc?f.getUTCFullYear():f.getFullYear()},0),_(A,"$cweek_cyear",function(){var x,f=this,Z=a,le=a,ye=a,R=a;return x=y("Time").$new(f.$year(),1,1).$wday(),Z=f.$year(),F(J(x,4))&&ue(x,0)?le=U(x,1):(le=U(U(x,7),1),K(le,-8)&&(le=-1)),ye=H(L(f.$yday(),le),7).$ceil(),F(J(ye,0))?y("Time").$new(U(f.$year(),1),12,31).$cweek_cyear():(K(ye,53)&&(R=y("Time").$new(f.$year(),12,31).$wday(),F(J(R,3))&&ue(R,0)&&(ye=1,Z=L(Z,1))),[ye,Z])},0),l=E.get_singleton_class(A),ee(l,"mktime","local"),ee(l,"utc","gm"),ee(A,"ctime","asctime"),ee(A,"dst?","isdst"),ee(A,"getutc","getgm"),ee(A,"gmtoff","gmt_offset"),ee(A,"mday","day"),ee(A,"month","mon"),ee(A,"to_s","inspect"),ee(A,"tv_sec","to_i"),ee(A,"tv_usec","usec"),ee(A,"utc","gmtime"),ee(A,"utc?","gmt?"),ee(A,"utc_offset","gmt_offset")}(0,Date)},Opal.modules["corelib/struct"]=function(E){var a=E.nil,y=E.$$$,w=E.klass,p=E.hash2,u=E.truthy,k=E.neqeq,v=E.eqeq,D=E.Opal,_=E.send,F=E.Class,oe=E.to_a,V=E.def,L=E.defs,H=E.Kernel,U=E.rb_gt,se=E.rb_minus,ue=E.eqeqeq,J=E.rb_lt,K=E.rb_ge,ee=E.rb_plus,M=E.alias;return E.top.$require("corelib/enumerable"),function(G,z,A){var N=w("::",null,"Struct"),P=[N].concat([]),g=E.$r(P);N.$include(y("Enumerable")),L(N,"$new",function C(h,c,l){var m,x,S,Z,f=C.$$p||a,le=this,ye=a;if(delete C.$$p,m=E.slice.call(arguments,1),null==(x=E.extract_kwargs(m)))x=p([],{});else if(!x.$$is_hash)throw E.ArgumentError.$new("expected kwargs");if(S=m,null==(Z=x.$$smap.keyword_init)&&(Z=!1),u(h))if(v(h.$class(),y("String"))&&k(h["$[]"](0).$upcase(),h["$[]"](0)))S.$unshift(h),h=a;else try{h=D["$const_name!"](h)}catch(T){if(!E.rescue(T,[y("TypeError"),y("NameError")]))throw T;try{S.$unshift(h),h=a}finally{E.pop_exception()}}return _(S,"map",[],function(R){return null==R&&(R=a),D["$coerce_to!"](R,y("String"),"to_str")},1),ye=_(F,"new",[le],function T(){var ie,R=null==T.$$s?this:T.$$s;return _(S,"each",[],function ie(j){return null==j&&(j=a),(null==ie.$$s?this:ie.$$s).$define_struct_attribute(j)},{$$arity:1,$$s:R}),ie=E.get_singleton_class(R),V(ie,"$new",function(de){var ce,he=this,B=a;return ce=E.slice.call(arguments),(B=he.$allocate()).$$data={},_(B,"initialize",oe(ce)),B},-1),ie.$alias_method("[]","new")},{$$arity:0,$$s:le}),u(f)&&_(ye,"module_eval",[],f.$to_proc()),ye.$$keyword_init=Z,u(h)&&y("Struct").$const_set(h,ye),ye},-2),L(N,"$define_struct_attribute",function(h){var c=this;return v(c,y("Struct"))&&H.$raise(y("ArgumentError"),"you cannot define attributes to the Struct class"),c.$members()["$<<"](h),_(c,"define_method",[h],function l(){return(null==l.$$s?this:l.$$s).$$data[h]},{$$arity:0,$$s:c}),_(c,"define_method",[h+"="],function l(f){return null==f&&(f=a),(null==l.$$s?this:l.$$s).$$data[h]=f},{$$arity:1,$$s:c})},1),L(N,"$members",function(){var c,h=this;return null==h.members&&(h.members=a),v(h,y("Struct"))&&H.$raise(y("ArgumentError"),"the Struct class has no members"),h.members=u(c=h.members)?c:[]},0),L(N,"$inherited",function(h){var l,c=this;return null==c.members&&(c.members=a),l=c.members,_(h,"instance_eval",[],function f(){return(null==f.$$s?this:f.$$s).members=l},{$$arity:0,$$s:c})},1),V(N,"$initialize",function(h){var c,l,f=this,m=a,x=a,S=a;return c=E.slice.call(arguments),l=c,u(f.$class().$$keyword_init)?(m=u(x=l.$last())?x:p([],{}),(u(U(l.$length(),1))||u(1===l.length&&!m.$$is_hash))&&H.$raise(y("ArgumentError"),"wrong number of arguments (given "+l.$length()+", expected 0)"),S=se(m.$keys(),f.$class().$members()),u(S["$any?"]())&&H.$raise(y("ArgumentError"),"unknown keywords: "+S.$join(", ")),_(f.$class().$members(),"each",[],function Z(le){var T,ye=null==Z.$$s?this:Z.$$s;return null==le&&(le=a),T=[le,m["$[]"](le)],_(ye,"[]=",oe(T)),T[se(T.length,1)]},{$$arity:1,$$s:f})):(u(U(l.$length(),f.$class().$members().$length()))&&H.$raise(y("ArgumentError"),"struct size differs"),_(f.$class().$members(),"each_with_index",[],function Z(le,ye){var R,T=null==Z.$$s?this:Z.$$s;return null==le&&(le=a),null==ye&&(ye=a),R=[le,l["$[]"](ye)],_(T,"[]=",oe(R)),R[se(R.length,1)]},{$$arity:2,$$s:f}))},-1),V(N,"$initialize_copy",function(h){this.$$data={};var f,m,x,l=Object.keys(h.$$data);for(f=0,m=l.length;f<m;f++)this.$$data[x=l[f]]=h.$$data[x]},1),L(N,"$keyword_init?",function(){return this.$$keyword_init},0),V(N,"$members",function(){return this.$class().$members()},0),V(N,"$hash",function(){return g("Hash").$new(this.$$data).$hash()},0),V(N,"$[]",function(h){var c=this;return ue(y("Integer"),h)?(u(J(h,c.$class().$members().$size()["$-@"]()))&&H.$raise(y("IndexError"),"offset "+h+" too small for struct(size:"+c.$class().$members().$size()+")"),u(K(h,c.$class().$members().$size()))&&H.$raise(y("IndexError"),"offset "+h+" too large for struct(size:"+c.$class().$members().$size()+")"),h=c.$class().$members()["$[]"](h)):ue(y("String"),h)?c.$$data.hasOwnProperty(h)||H.$raise(y("NameError").$new("no member '"+h+"' in struct",h)):H.$raise(y("TypeError"),"no implicit conversion of "+h.$class()+" into Integer"),h=D["$coerce_to!"](h,y("String"),"to_str"),c.$$data[h]},1),V(N,"$[]=",function(h,c){var l=this;return ue(y("Integer"),h)?(u(J(h,l.$class().$members().$size()["$-@"]()))&&H.$raise(y("IndexError"),"offset "+h+" too small for struct(size:"+l.$class().$members().$size()+")"),u(K(h,l.$class().$members().$size()))&&H.$raise(y("IndexError"),"offset "+h+" too large for struct(size:"+l.$class().$members().$size()+")"),h=l.$class().$members()["$[]"](h)):ue(y("String"),h)?u(l.$class().$members()["$include?"](h.$to_sym()))||H.$raise(y("NameError").$new("no member '"+h+"' in struct",h)):H.$raise(y("TypeError"),"no implicit conversion of "+h.$class()+" into Integer"),h=D["$coerce_to!"](h,y("String"),"to_str"),l.$$data[h]=c},2),V(N,"$==",function(h){if(!u(h["$instance_of?"](this.$class())))return!1;var l={},f={};return function m(x,S){var Z,le,ye;for(Z in l[x.$__id__()]=!0,f[S.$__id__()]=!0,x.$$data)if(le=x.$$data[Z],ye=S.$$data[Z],y("Struct")["$==="](le)){if(!(l.hasOwnProperty(le.$__id__())&&f.hasOwnProperty(ye.$__id__())||m(le,ye)))return!1}else if(!le["$=="](ye))return!1;return!0}(this,h)},1),V(N,"$eql?",function(h){if(!u(h["$instance_of?"](this.$class())))return!1;var l={},f={};return function m(x,S){var Z,le,ye;for(Z in l[x.$__id__()]=!0,f[S.$__id__()]=!0,x.$$data)if(le=x.$$data[Z],ye=S.$$data[Z],y("Struct")["$==="](le)){if(!(l.hasOwnProperty(le.$__id__())&&f.hasOwnProperty(ye.$__id__())||m(le,ye)))return!1}else if(!le["$eql?"](ye))return!1;return!0}(this,h)},1),V(N,"$each",function C(){var h=C.$$p||a,c=this;return delete C.$$p,h===a?_(c,"enum_for",["each"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$arity:0,$$s:c}):(_(c.$class().$members(),"each",[],function l(f){return null==f&&(f=a),E.yield1(h,(null==l.$$s?this:l.$$s)["$[]"](f))},{$$arity:1,$$s:c}),c)},0),V(N,"$each_pair",function C(){var h=C.$$p||a,c=this;return delete C.$$p,h===a?_(c,"enum_for",["each_pair"],function l(){return(null==l.$$s?this:l.$$s).$size()},{$$arity:0,$$s:c}):(_(c.$class().$members(),"each",[],function l(f){return null==f&&(f=a),E.yield1(h,[f,(null==l.$$s?this:l.$$s)["$[]"](f)])},{$$arity:1,$$s:c}),c)},0),V(N,"$length",function(){return this.$class().$members().$length()},0),V(N,"$to_a",function(){return _(this.$class().$members(),"map",[],function c(l){return null==l&&(l=a),(null==c.$$s?this:c.$$s)["$[]"](l)},{$$arity:1,$$s:this})},0);var b=[];return V(N,"$inspect",function(){var h=this,c=a,l=a;return function(){try{return c="#<struct ",u(b["$include?"](h.$__id__()))?ee(c,":...>"):(b["$<<"](h.$__id__()),l=!0,ue(y("Struct"),h)&&u(h.$class().$name())&&(c=ee(c,h.$class()+" ")),c=ee(c,_(h.$each_pair(),"map",[],function(m,x){return null==m&&(m=a),null==x&&(x=a),m+"="+g("Opal").$inspect(x)},2).$join(", ")),c=ee(c,">"))}finally{u(l)&&b.pop()}}()},0),V(N,"$to_h",function C(){var h=C.$$p||a,c=this;return delete C.$$p,h!==a?_(_(c,"map",[],h.$to_proc()),"to_h",oe(c.$args())):_(c.$class().$members(),"each_with_object",[p([],{})],function l(f,m){var S;return null==f&&(f=a),null==m&&(m=a),S=[f,(null==l.$$s?this:l.$$s)["$[]"](f)],_(m,"[]=",oe(S)),S[se(S.length,1)]},{$$arity:2,$$s:c})},0),V(N,"$values_at",function(h){var c,l,f=this;c=E.slice.call(arguments);for(var m=[],x=0,S=(l=_(l=c,"map",[],function(le){return null==le&&(le=a),le.$$is_range?le.$to_a():le},1).$flatten()).length;x<S;x++)l[x].$$is_number||H.$raise(y("TypeError"),"no implicit conversion of "+l[x].$class()+" into Integer"),m.push(f["$[]"](l[x]));return m},-1),V(N,"$dig",function(h,c){var f,m=this,x=a;return f=E.slice.call(arguments,1),(x=u(h.$$is_string&&m.$$data.hasOwnProperty(h))&&m.$$data[h]||a)===a||0===f.length?x:(u(x["$respond_to?"]("dig"))||H.$raise(y("TypeError"),x.$class()+" does not have #dig method"),_(x,"dig",oe(f)))},-2),M(N,"size","length"),M(N,"to_s","inspect"),M(N,"values","to_a")}()},Opal.modules["corelib/dir"]=function(E){var oe,_,Y=E.nil,a=E.$$$,w=E.def,p=E.truthy,u=E.alias;return[_=(0,E.klass)("::",null,"Dir")].concat([]),oe=E.get_singleton_class(_),w(oe,"$chdir",function L(H){var U=L.$$p||Y,se=Y;return delete L.$$p,function(){try{return se=E.current_dir,E.current_dir=H,E.yieldX(U,[])}finally{E.current_dir=se}}()},1),w(oe,"$pwd",function(){return E.current_dir||"."},0),w(oe,"$home",function(){var H;return p(H=a("ENV")["$[]"]("HOME"))?H:"."},0),u(oe,"getwd","pwd")},Opal.modules["corelib/file"]=function(E){var J,K,ee,M,Y=E.nil,a=E.$$$,y=E.truthy,p=E.const_set,u=E.Opal,k=E.regexp,v=E.rb_plus,D=E.def,_=E.Kernel,F=E.eqeq,oe=E.rb_lt,V=E.rb_minus,L=E.range,H=E.send,U=E.alias;return J=[],ee=[K=(0,E.klass)("::",a("IO"),"File")].concat(J),M=Y,p(ee[0],"Separator",p(ee[0],"SEPARATOR","/")),p(ee[0],"ALT_SEPARATOR",Y),p(ee[0],"PATH_SEPARATOR",":"),p(ee[0],"FNM_SYSCASE",0),M=/^[a-zA-Z]:(?:\\|\/)/,function(G,z){var A=[G].concat(z),N=E.$r(A);function P(b){return y(b["$respond_to?"]("to_path"))&&(b=b.$to_path()),u["$coerce_to!"](b,a("String"),"to_str")}function g(){return N("ALT_SEPARATOR")===Y?E.escape_regexp(N("SEPARATOR")):E.escape_regexp(v(N("SEPARATOR"),N("ALT_SEPARATOR")))}return D(G,"$absolute_path",function(C,h){var c,l,m,x,S,f=Y,Z=Y,le=Y,ye=Y,T=Y;null==h&&(h=Y),c=N("SEPARATOR"),l=g(),f=[],C=y(C["$respond_to?"]("to_path"))?C.$to_path():C,C=u["$coerce_to!"](C,a("String"),"to_str"),h=y(m=h)?m:a("Dir").$pwd(),x=C.substr(0,c.length)===c||M.test(C),S=h.substr(0,c.length)===c||M.test(h),y(x)?(Z=C.$split(k(["[",l,"]"])),le=M.test(C)?"":C.$sub(k(["^([",l,"]+).*$"]),"\\1"),ye=!0):(Z=v(h.$split(k(["[",l,"]"])),C.$split(k(["[",l,"]"]))),le=M.test(h)?"":h.$sub(k(["^([",l,"]+).*$"]),"\\1"),ye=S);for(var R,ie=0,j=Z.length;ie<j;ie++)(R=Z[ie])!==Y&&(""!==R||0!==f.length&&!ye)&&("."!==R||0!==f.length&&!ye)&&(".."===R?f.pop():f.push(R));return!ye&&"."!==Z[0]&&f.$unshift("."),T=f.$join(c),y(ye)&&(T=v(le,T)),T},-2),D(G,"$expand_path",function(C,h){var l,f,m=Y,x=Y,S=Y;return null==h&&(h=Y),l=N("SEPARATOR"),f=g(),y("~"===C[0]||h&&"~"===h[0])&&(m=N("Dir").$home(),y(m)||_.$raise(a("ArgumentError"),"couldn't find HOME environment -- expanding `~'"),x=M.test(m)?"":m.$sub(k(["^([",f,"]+).*$"]),"\\1"),y(m["$start_with?"](x))||_.$raise(a("ArgumentError"),"non-absolute home"),m=v(m,l),S=k(["^\\~(?:",l,"|$)"]),C=C.$sub(S,m),y(h)&&(h=h.$sub(S,m))),this.$absolute_path(C,h)},-2),D(G,"$dirname",function(C,h){var l;if(null==h&&(h=1),F(h,0))return C;y(oe(h,0))&&_.$raise(a("ArgumentError"),"level can't be negative"),l=g();var m,f=(C=P(C)).match(new RegExp("^["+l+"]"));return m=""===(C=(C=(C=C.replace(new RegExp("["+l+"]+$"),"")).replace(new RegExp("[^"+l+"]+$"),"")).replace(new RegExp("["+l+"]+$"),""))?f?"/":".":C,1==h?m:this.$dirname(m,V(h,1))},-2),D(G,"$basename",function(C,h){var c;return null==h&&(h=Y),c=g(),0==(C=P(C)).length||(h=h!==Y?u["$coerce_to!"](h,a("String"),"to_str"):null,C=(C=C.replace(new RegExp("(.)["+c+"]*$"),"$1")).replace(new RegExp("^(?:.*["+c+"])?([^"+c+"]+)$"),"$1"),".*"===h?C=C.replace(/\.[^\.]+$/,""):null!==h&&(h=E.escape_regexp(h),C=C.replace(new RegExp(h+"$"),""))),C},-2),D(G,"$extname",function(C){var c=Y,l=Y;return C=P(C),c=this.$basename(C),y(c["$empty?"]())||(l=c["$[]"](L(1,-1,!1)).$rindex("."),y(l["$nil?"]())||F(v(l,1),V(c.$length(),1)))?"":c["$[]"](E.Range.$new(v(l,1),-1,!1))},1),D(G,"$exist?",function(C){return null!=E.modules[C]},1),D(G,"$directory?",function(C){var h=Y;for(var l in h=[],E.modules)h.push(l);return C=C.$gsub(k(["(^.",N("SEPARATOR"),"+|",N("SEPARATOR"),"+$)"])),H(h,"find",[],function(m){return null==m&&(m=Y),m["$=~"](k(["^",C]))},1)},1),D(G,"$join",function(C){var h,c,l=Y;return h=E.slice.call(arguments),y((c=h)["$empty?"]())?"":(l="",c=H(c.$flatten().$each_with_index(),"map",[],function(m,x){return null==m&&(m=Y),null==x&&(x=Y),F(x,0)&&y(m["$empty?"]())||F(c.$length(),v(x,1))&&y(m["$empty?"]())?N("SEPARATOR"):m},2),c=H(c,"reject",[],"empty?".$to_proc()),H(c,"each_with_index",[],function(m,x){var S=Y;return null==m&&(m=Y),null==x&&(x=Y),S=c["$[]"](v(x,1)),y(S["$nil?"]())?l=""+l+m:(y(m["$end_with?"](N("SEPARATOR")))&&y(S["$start_with?"](N("SEPARATOR")))&&(m=m.$sub(k([N("SEPARATOR"),"+$"]),"")),l=y(m["$end_with?"](N("SEPARATOR")))||y(S["$start_with?"](N("SEPARATOR")))?""+l+m:""+l+m+N("SEPARATOR"))},2),l)},-1),D(G,"$split",function(C){return C.$split(N("SEPARATOR"))},1),U(G,"realpath","expand_path"),U(G,"exists?","exist?")}(E.get_singleton_class(K),ee)},Opal.modules["corelib/process/base"]=function(E){var p,ae=E.nil,Y=E.klass,a=E.defs;return p=Y("::",null,"Signal"),a(p,"$trap",function(k){return E.slice.call(arguments),ae},-1),function(y,w){var p=Y("::",null,"GC");return a(p,"$start",function(){return ae},0)}()},Opal.modules["corelib/process"]=function(E){var ae=E.nil,Y=E.$$$,a=E.module,y=E.defs,w=E.truthy,p=E.Kernel;return function(u){var k=a("::","Process"),v=ae;if(k.__clocks__=[],y(k,"$__register_clock__",function(F,oe){var V=this;return null==V.__clocks__&&(V.__clocks__=ae),V.$const_set(F,V.__clocks__.$size()),V.__clocks__["$<<"](oe)},2),k.$__register_clock__("CLOCK_REALTIME",function(){return Date.now()}),v=!1,E.global.performance)v=function(){return performance.now()};else if(E.global.process&&process.hrtime){var D=process.hrtime();v=function(){var _=process.hrtime(D);return 1e3*_[0]+(_[1]/1e3|0)/1e3}}return w(v)&&k.$__register_clock__("CLOCK_MONOTONIC",v),y(k,"$pid",function(){return 0},0),y(k,"$times",function(){var F;return F=Y("Time").$now().$to_f(),Y(Y("Benchmark"),"Tms").$new(F,F,F,F,F)},0),y(k,"$clock_gettime",function(F,oe){var V=this,H=ae;null==V.__clocks__&&(V.__clocks__=ae),null==oe&&(oe="float_second"),w(H=V.__clocks__["$[]"](F))||p.$raise(Y(Y("Errno"),"EINVAL"),"clock_gettime("+F+") "+V.__clocks__["$[]"](F));var U=H();switch(oe){case"float_second":return U/1e3;case"float_millisecond":return U/1;case"float_microsecond":return 1e3*U;case"second":return U/1e3|0;case"millisecond":return U/1|0;case"microsecond":return 1e3*U|0;case"nanosecond":return 1e6*U|0;default:p.$raise(Y("ArgumentError"),"unexpected unit: "+oe)}},-2)}()},Opal.modules["corelib/random/formatter"]=function(E){var H,J,K,ee,M,U,Y=E.nil,a=E.$$$,w=E.module,p=E.def,u=E.send,k=E.to_a,v=E.rb_minus,D=E.range,_=E.rb_divide,F=E.Kernel,oe=E.Opal;return H=[],J=[U=(0,E.klass)("::",null,"Random")].concat(H),ee=[K=w(U,"Formatter")].concat(J),M=E.$r(ee),p(K,"$hex",function(z){null==z&&(z=Y),z=a("Random").$_verify_count(z);for(var N=this.$bytes(z),P="",g=0;g<z;g++)P+=N.charCodeAt(g).toString(16).padStart(2,"0");return P.$encode("US-ASCII")},-1),p(K,"$random_bytes",function(z){return null==z&&(z=Y),this.$bytes(z)},-1),p(K,"$base64",function(z){return null==z&&(z=Y),a("Base64").$strict_encode64(this.$random_bytes(z)).$encode("US-ASCII")},-1),p(K,"$urlsafe_base64",function(z,A){return null==z&&(z=Y),null==A&&(A=!1),a("Base64").$urlsafe_encode64(this.$random_bytes(z),A).$encode("US-ASCII")},-1),p(K,"$uuid",function(){var A=Y,N=Y;return A=this.$hex(16).$split(""),u(A,"[]=",k(N=[12,"4"])),v(N.length,1),N=[16,(3&parseInt(A["$[]"](16),16)|8).toString(16)],u(A,"[]=",k(N)),v(N.length,1),A=[A["$[]"](D(0,8,!0)),A["$[]"](D(8,12,!0)),A["$[]"](D(12,16,!0)),A["$[]"](D(16,20,!0)),A["$[]"](D(20,32,!0))],(A=u(A,"map",[],"join".$to_proc())).$join("-")},0),p(K,"$random_float",function(){var A=Y,N=Y;return A=this.$bytes(4),N=0,u(4,"times",[],function(g){return null==g&&(g=Y),N=(N=N["$<<"](8))["$|"](A["$[]"](g).$ord())},1),_(N.$abs(),2147483647)},0),p(K,"$random_number",function(z){var A=this;function N(){return A.$random_float()}function P(b){return Math.floor(N()*b)}return null==z?N():z.$$is_range?function g(){var b=z.begin,C=z.end;if(b===Y||C===Y)return Y;var h=C-b;return h<0?Y:0===h?b:(C%1==0&&b%1==0&&!z.excl&&h++,P(h)+b)}():z.$$is_number?(z<=0&&F.$raise(a("ArgumentError"),"invalid argument - "+z),z%1==0?P(z):N()*z):((z=oe["$coerce_to!"](z,a("Integer"),"to_int"))<=0&&F.$raise(a("ArgumentError"),"invalid argument - "+z),P(z))},-1),p(K,"$alphanumeric",function(z){var N=Y;return null==z&&(z=Y),z=M("Random").$_verify_count(z),N=u([D("0","9",!1),D("a","z",!1),D("A","Z",!1)],"map",[],"to_a".$to_proc()).$flatten(),u(a("Array"),"new",[z],function P(g){return null==g&&(g=Y),N["$[]"]((null==P.$$s?this:P.$$s).$random_number(N.$length()))},{$$arity:1,$$s:this}).$join()},-1),U.$include(a(a("Random"),"Formatter")),U.$extend(a(a("Random"),"Formatter"))},Opal.modules["corelib/random/mersenne_twister"]=function(E){var F,_,oe,Y=E.$$$,a=E.klass,y=E.const_set,w=E.send,p=E.to_a,u=E.rb_minus,k=E.nil;return k=function(){var v=624,D=397,L=function(ee,M){return function(ee,M){return 2147483648&ee|2147483647&M}(ee,M)>>>1^(1&M?2567483615:0)};function ue(ee){var M;return--ee.left<=0&&function se(ee){var z,M=0,G=ee.state;for(ee.left=v,ee.next=0,z=228;--z;M++)G[M]=G[M+D]^L(G[M+0],G[M+1]);for(z=D;--z;M++)G[M]=G[M+(D-v)]^L(G[M+0],G[M+1]);G[M]=G[M+(D-v)]^L(G[M+0],G[0])}(ee),M=ee.state[ee.next++],M^=M>>>11,M^=M<<7&2636928640,M^=M<<15&4022730752,(M^=M>>>18)>>>0}return{genrand_real:function K(ee){return function J(ee,M){return(67108864*(ee>>>=5)+(M>>>=6))*(1/9007199254740992)}(ue(ee),ue(ee))},init:function H(ee){var M={left:0,next:v,state:new Array(v)};return function U(ee,M){var G;for(ee.state[0]=M>>>0,G=1;G<v;G++)ee.state[G]=1812433253*(ee.state[G-1]^ee.state[G-1]>>30>>>0)+G,ee.state[G]&=4294967295;ee.left=1,ee.next=v}(M,ee),M}}}(),_=a("::",null,"Random"),oe=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,y(_,"MERSENNE_TWISTER_GENERATOR",{new_seed:function(){return Math.round(Math.random()*oe)},reseed:function(V){return k.init(V)},rand:function(V){return k.genrand_real(V)}}),w(_,"generator=",p(F=[Y(_,"MERSENNE_TWISTER_GENERATOR")])),F[u(F.length,1)]},Opal.modules["corelib/random"]=function(E){var V,ae=E.top,Y=E.nil,a=E.$$$,y=E.truthy,w=E.klass,p=E.Kernel,u=E.defs,k=E.Opal,v=E.def,D=E.eqeqeq,_=E.send;return ae.$require("corelib/random/formatter"),(V=w("::",null,"Random")).$attr_reader("seed","state"),u(V,"$_verify_count",function(H){return y(H)||(H=16),"number"!=typeof H&&(H=H.$to_int()),H<0&&p.$raise(a("ArgumentError"),"negative string size (or size too big)"),Math.floor(H)},1),v(V,"$initialize",function(H){return null==H&&(H=a("Random").$new_seed()),H=k["$coerce_to!"](H,a("Integer"),"to_int"),this.state=H,this.$reseed(H)},-1),v(V,"$reseed",function(H){return this.seed=H,this.$rng=E.$$rand.reseed(H)},1),u(V,"$new_seed",function(){return E.$$rand.new_seed()},0),u(V,"$rand",function(H){return a(this,"DEFAULT").$rand(H)},-1),u(V,"$srand",function(H){var se;return null==H&&(H=a("Random").$new_seed()),H=k["$coerce_to!"](H,a("Integer"),"to_int"),se=a(this,"DEFAULT").$seed(),a(this,"DEFAULT").$reseed(H),se},-1),u(V,"$urandom",function(H){return a("SecureRandom").$bytes(H)},1),v(V,"$==",function(H){var se=Y;return!!D(a("Random"),H)&&(y(se=this.$seed()["$=="](H.$seed()))?this.$state()["$=="](H.$state()):se)},1),v(V,"$bytes",function(H){return H=a("Random").$_verify_count(H),_(a("Array"),"new",[H],function se(){return(null==se.$$s?this:se.$$s).$rand(255).$chr()},{$$arity:0,$$s:this}).$join().$encode("ASCII-8BIT")},1),u(V,"$bytes",function(H){return a(this,"DEFAULT").$bytes(H)},1),v(V,"$rand",function(H){return this.$random_number(H)},-1),v(V,"$random_float",function(){return this.state++,E.$$rand.rand(this.$rng)},0),u(V,"$random_float",function(){return a(this,"DEFAULT").$random_float()},0),u(V,"$generator=",function(H){var U=this;return E.$$rand=H,y(U["$const_defined?"]("DEFAULT"))?a(U,"DEFAULT").$reseed():U.$const_set("DEFAULT",U.$new(U.$new_seed()))},1),ae.$require("corelib/random/mersenne_twister")},Opal.modules["corelib/unsupported"]=function(E){var H,U,se,ae=E.top,a=E.nil,y=E.$$$,w=E.Kernel,p=E.klass,u=E.send,k=E.module,v=E.def,D=E.alias,_=E.defs,F={};function oe(L){switch(E.config.unsupported_features_severity){case"error":w.$raise(y("NotImplementedError"),L);break;case"warning":!function V(L){F[L]||(F[L]=!0,ae.$warn(L))}(L)}}return U=p("::",null,"String"),se="String#%s not supported. Mutable String methods are not supported in Opal.",u(["<<","capitalize!","chomp!","chop!","downcase!","gsub!","lstrip!","next!","reverse!","slice!","squeeze!","strip!","sub!","succ!","swapcase!","tr!","tr_s!","upcase!","prepend","[]=","clear","encode!","unicode_normalize!"],"each",[],function ue(J){return null==J&&(J=a),u(null==ue.$$s?this:ue.$$s,"define_method",[J],function(M){return E.slice.call(arguments),w.$raise(y("NotImplementedError"),se["$%"](J))},-1)},{$$arity:1,$$s:U}),function(L){var H=k("::","Kernel"),U="Object freezing is not supported by Opal";v(H,"$freeze",function(){return oe(U),this},0),v(H,"$frozen?",function(){return oe(U),!1},0)}(),function(L){var H=k("::","Kernel"),U="Object tainting is not supported by Opal";v(H,"$taint",function(){return oe(U),this},0),v(H,"$untaint",function(){return oe(U),this},0),v(H,"$tainted?",function(){return oe(U),!1},0)}(),function(L,H){var U=p("::",null,"Module");v(U,"$public",function(ue){var K,ee=this;return 0===(K=E.slice.call(arguments)).length?(ee.$$module_function=!1,a):1===K.length?K[0]:K},-1),v(U,"$private_class_method",function(ue){var K;return 1===(K=E.slice.call(arguments)).length?K[0]:K},-1),v(U,"$private_method_defined?",function(ue){return!1},1),v(U,"$private_constant",function(ue){return E.slice.call(arguments),a},-1),D(U,"nesting","public"),D(U,"private","public"),D(U,"protected","public"),D(U,"protected_method_defined?","private_method_defined?"),D(U,"public_class_method","private_class_method"),D(U,"public_instance_method","instance_method"),D(U,"public_instance_methods","instance_methods"),D(U,"public_method_defined?","method_defined?")}(),H=k("::","Kernel"),v(H,"$private_methods",function(se){return E.slice.call(arguments),[]},-1),D(H,"private_instance_methods","private_methods"),function(L,H){var U=k("::","Kernel"),se=[U].concat([]),ue=E.$r(se);v(U,"$eval",function(K){return E.slice.call(arguments),w.$raise(y("NotImplementedError"),"To use Kernel#eval, you must first require 'opal-parser'. See https://github.com/opal/opal/blob/"+ue("RUBY_ENGINE_VERSION")+"/docs/opal_parser.md for details.")},-1)}(),_(ae,"$public",function(H){var se;return 1===(se=E.slice.call(arguments)).length?se[0]:se},-1),_(ae,"$private",function(H){var se;return 1===(se=E.slice.call(arguments)).length?se[0]:se},-1)},Opal.queue(function(E){var Y=E.Object;return Y.$require("opal/base"),Y.$require("opal/mini"),Y.$require("corelib/kernel/format"),Y.$require("corelib/string/encoding"),Y.$autoload("Math","corelib/math"),Y.$require("corelib/complex/base"),Y.$autoload("Complex","corelib/complex"),Y.$require("corelib/rational/base"),Y.$autoload("Rational","corelib/rational"),Y.$require("corelib/time"),Y.$autoload("Struct","corelib/struct"),Y.$require("corelib/dir"),Y.$autoload("File","corelib/file"),Y.$require("corelib/process/base"),Y.$autoload("Process","corelib/process"),Y.$autoload("Random","corelib/random"),Y.$require("corelib/unsupported")}),Opal.queue(function(E){var G,g,b,C,h,z,A,N,ae=E.top,Y=[],a=E.$r(Y),y=E.nil,w=E.$$$,p=E.module,u=E.defs,k=E.truthy,v=E.send,D=E.Kernel,_=E.hash2,F=E.range,oe=E.to_a,V=E.def,L=E.alias,H=E.klass,U=E.rb_minus,se=E.send2,ue=E.find_super,J=E.eqeqeq,K=E.rb_ge,ee=E.gvars;return G=Y,A=[z=p(Y[0],"Native")].concat(G),N=E.$r(A),u(z,"$is_a?",function(g,b){try{return g instanceof this.$try_convert(b)}catch(h){return!1}},2),u(z,"$try_convert",function(g,b){return null==b&&(b=y),this["$native?"](g)?g:g["$respond_to?"]("to_n")?g.$to_n():b},-2),u(z,"$convert",function(g){return this["$native?"](g)?g:g["$respond_to?"]("to_n")?g.$to_n():void this.$raise(N("ArgumentError"),g.$inspect()+" isn't native")},1),u(z,"$call",function P(g,b,C){var l,h=P.$$p||y,f=this;delete P.$$p,l=E.slice.call(arguments,2);var m=g[b];if(m instanceof Function){for(var x=new Array(l.length),S=0,Z=l.length;S<Z;S++){var le=l[S],ye=f.$try_convert(le);x[S]=ye===y?le:ye}return h!==y&&x.push(h),f.$Native(m.apply(g,x))}return f.$Native(m)},-3),u(z,"$proc",function P(){var g=P.$$p||y;return delete P.$$p,k(g)||this.$raise(N("LocalJumpError"),"no block given"),v(D,"proc",[],function C(h){var c,l,f=null==C.$$s?this:C.$$s,m=y;if(c=E.slice.call(arguments),v(l=c,"map!",[],function S(Z){return null==Z&&(Z=y),(null==S.$$s?this:S.$$s).$Native(Z)},{$$arity:1,$$s:f}),m=f.$Native(this),this===E.global)return g.apply(f,l);var x=g.$$s;g.$$s=null;try{return g.apply(m,l)}finally{g.$$s=x}},{$$arity:-1,$$s:this})},0),g=A,C=[b=p(A[0],"Helpers")].concat(g),h=E.$r(C),V(b,"$alias_native",function c(l,f,m){var x,S,Z,le,T=this;if(delete c.$$p,x=E.slice.call(arguments,1),null==(S=E.extract_kwargs(x)))S=_([],{});else if(!S.$$is_hash)throw E.ArgumentError.$new("expected kwargs");return x.length>0&&(Z=x.shift()),null==Z&&(Z=l),null==(le=S.$$smap.as)&&(le=y),k(Z["$end_with?"]("="))?v(T,"define_method",[l],function R(ie){var j=null==R.$$s?this:R.$$s;return null==j.native&&(j.native=y),null==ie&&(ie=y),j.native[Z["$[]"](F(0,-2,!1))]=h("Native").$convert(ie),ie},{$$arity:1,$$s:T}):k(le)?v(T,"define_method",[l],function R(ie){var de,j=R.$$p||y,we=null==R.$$s?this:R.$$s,ce=y;return null==we.native&&(we.native=y),delete R.$$p,de=E.slice.call(arguments),ce=v(h("Native"),"call",[we.native,Z].concat(oe(de)),j.$to_proc()),k(ce)?le.$new(ce.$to_n()):y},{$$arity:-1,$$s:T}):v(T,"define_method",[l],function R(ie){var de,j=R.$$p||y,we=null==R.$$s?this:R.$$s;return null==we.native&&(we.native=y),delete R.$$p,de=E.slice.call(arguments),v(h("Native"),"call",[we.native,Z].concat(oe(de)),j.$to_proc())},{$$arity:-1,$$s:T})},-2),V(b,"$native_reader",function(l){var f,x=this;return f=E.slice.call(arguments),v(f,"each",[],function S(Z){var le=null==S.$$s?this:S.$$s;return null==Z&&(Z=y),v(le,"define_method",[Z],function ye(){var T=null==ye.$$s?this:ye.$$s;return null==T.native&&(T.native=y),T.$Native(T.native[Z])},{$$arity:0,$$s:le})},{$$arity:1,$$s:x})},-1),V(b,"$native_writer",function(l){var f,x=this;return f=E.slice.call(arguments),v(f,"each",[],function S(Z){var le=null==S.$$s?this:S.$$s;return null==Z&&(Z=y),v(le,"define_method",[Z+"="],function ye(T){var R=null==ye.$$s?this:ye.$$s;return null==R.native&&(R.native=y),null==T&&(T=y),R.$Native(R.native[Z]=T)},{$$arity:1,$$s:le})},{$$arity:1,$$s:x})},-1),V(b,"$native_accessor",function(l){var f,m,x=this;return f=E.slice.call(arguments),v(x,"native_reader",oe(m=f)),v(x,"native_writer",oe(m))},-1),function(P,g){var b=p(P,"Wrapper"),C=[b].concat(g),h=E.$r(C);V(b,"$initialize",function(l){return k(D["$native?"](l))||D.$raise(h("ArgumentError"),l.$inspect()+" isn't native"),this.native=l},1),V(b,"$to_n",function(){var l=this;return null==l.native&&(l.native=y),l.native},0),u(b,"$included",function(l){return l.$extend(h("Helpers"))},1)}(A[0],A),u(z,"$included",function(g){return this.$warn("Including ::Native is deprecated. Please include Native::Wrapper instead."),g.$include(N("Wrapper"))},1),function(M,G){var z=p(M,"Kernel"),A=[z].concat(G),N=E.$r(A);V(z,"$native?",function(g){return null==g||!g.$$class},1),V(z,"$Native",function P(g){var C=this;return delete P.$$p,k(null==g)?y:k(C["$native?"](g))?w(N("Native"),"Object").$new(g):k(g["$is_a?"](N("Array")))?v(g,"map",[],function h(c){return null==c&&(c=y),(null==h.$$s?this:h.$$s).$Native(c)},{$$arity:1,$$s:C}):k(g["$is_a?"](N("Proc")))?v(C,"proc",[],function h(c){var f,l=h.$$p||y,x=null==h.$$s?this:h.$$s;return delete h.$$p,f=E.slice.call(arguments),x.$Native(v(g,"call",oe(f),l.$to_proc()))},{$$arity:-1,$$s:C}):g},1),L(z,"_Array","Array"),V(z,"$Array",function P(g,b){var c,C=P.$$p||y,l=this;return delete P.$$p,c=E.slice.call(arguments,1),k(l["$native?"](g))?v(w(N("Native"),"Array"),"new",[g].concat(oe(c)),C.$to_proc()).$to_a():l.$_Array(g)},-2)}(Y[0],Y),function(M,G){var z=H(M,G,"Object");z.$$prototype.native=y,z.$include(w(w("Native"),"Wrapper")),V(z,"$==",function(P){return this.native===w("Native").$try_convert(P)},1),V(z,"$has_key?",function(P){return E.hasOwnProperty.call(this.native,P)},1),V(z,"$each",function N(P){var b,C=N.$$p||y,h=this;if(delete N.$$p,b=E.slice.call(arguments),C!==y){for(var c in h.native)E.yieldX(C,[c,h.native[c]]);return h}return v(h,"method_missing",["each"].concat(oe(b)))},-1),V(z,"$[]",function(P){var b=this.native[P];return b instanceof Function?b:w("Native").$call(this.native,P)},1),V(z,"$[]=",function(P,g){var C;return C=w("Native").$try_convert(g),this.native[P]=k(C===y)?g:C},2),V(z,"$merge!",function(P){for(var b in P=w("Native").$convert(P))this.native[b]=P[b];return this},1),V(z,"$respond_to?",function(P,g){return null==g&&(g=!1),D.$instance_method("respond_to?").$bind(this).$call(P,g)},-2),V(z,"$respond_to_missing?",function(P,g){return null==g&&(g=!1),E.hasOwnProperty.call(this.native,P)},-2),V(z,"$method_missing",function N(P,g){var h,b=N.$$p||y,c=this,l=y;return delete N.$$p,h=E.slice.call(arguments,1),"="===P.charAt(P.length-1)?(l=[P.$slice(0,U(P.$length(),1)),h["$[]"](0)],v(c,"[]=",oe(l)),l[U(l.length,1)]):v(w("Native"),"call",[c.native,P].concat(oe(h)),b.$to_proc())},-2),V(z,"$nil?",function(){return!1},0),V(z,"$is_a?",function(P){return E.is_a(this,P)},1),V(z,"$instance_of?",function(P){return this.$$class===P},1),V(z,"$class",function(){return this.$$class},0),V(z,"$to_a",function N(P){var g=N.$$p||y;return delete N.$$p,null==P&&(P=_([],{})),v(w(w("Native"),"Array"),"new",[this.native,P],g.$to_proc()).$to_a()},-1),V(z,"$inspect",function(){return"#<Native:"+String(this.native)+">"},0),L(z,"include?","has_key?"),L(z,"key?","has_key?"),L(z,"kind_of?","is_a?"),L(z,"member?","has_key?")}(a("Native"),a("BasicObject")),function(M,G,z){var A=H(M,null,"Array"),N=[A].concat(z),P=E.$r(N),g=A.$$prototype;g.named=g.native=g.get=g.block=g.set=g.length=y,A.$include(w(P("Native"),"Wrapper")),A.$include(P("Enumerable")),V(A,"$initialize",function b(C,h){var c=b.$$p||y,l=this,f=y;return delete b.$$p,null==h&&(h=_([],{})),se(l,ue(l,"initialize",b,!1,!0),"initialize",[C],null),l.get=k(f=h["$[]"]("get"))?f:h["$[]"]("access"),l.named=h["$[]"]("named"),l.set=k(f=h["$[]"]("set"))?f:h["$[]"]("access"),l.length=k(f=h["$[]"]("length"))?f:"length",l.block=c,k(null==l.$length())?l.$raise(P("ArgumentError"),"no length found on the array-like object"):y},-2),V(A,"$each",function b(){var C=b.$$p||y,h=this;if(delete b.$$p,!k(C))return h.$enum_for("each");for(var c=0,l=h.$length();c<l;c++)E.yield1(C,h["$[]"](c));return h},0),V(A,"$[]",function(C){var c,l,h=this;return c=J(P("String"),l=C)||J(P("Symbol"),l)?k(h.named)?h.native[h.named](C):h.native[C]:J(P("Integer"),l)?k(h.get)?h.native[h.get](C):h.native[C]:y,k(c)?k(h.block)?h.block.$call(c):h.$Native(c):y},1),V(A,"$[]=",function(C,h){var c=this;return k(c.set)?c.native[c.set](C,P("Native").$convert(h)):c.native[C]=P("Native").$convert(h)},2),V(A,"$last",function(C){var c=this,l=y,f=y;if(null==C&&(C=y),k(C)){for(l=U(c.$length(),1),f=[];k(K(l,0));)f["$<<"](c["$[]"](l)),l=U(l,1);return f}return c["$[]"](U(c.$length(),1))},-1),V(A,"$length",function(){return this.native[this.length]},0),V(A,"$inspect",function(){return this.$to_a().$inspect()},0),L(A,"to_ary","to_a")}(a("Native"),0,Y),function(M,G){var z=H(M,null,"Numeric");V(z,"$to_n",function(){return this.valueOf()},0)}(Y[0]),function(M,G){var z=H(M,null,"Proc");V(z,"$to_n",function(){return this},0)}(Y[0]),function(M,G){var z=H(M,null,"String");V(z,"$to_n",function(){return this.valueOf()},0)}(Y[0]),function(M,G){var z=H(M,null,"Regexp");V(z,"$to_n",function(){return this.valueOf()},0)}(Y[0]),function(M,G){var z=H(M,null,"MatchData");z.$$prototype.matches=y,V(z,"$to_n",function(){return this.matches},0)}(Y[0]),function(M,G,z){var A=H(M,null,"Struct"),N=[A].concat(z),P=E.$r(N);V(A,"$to_n",function(){var C=y;return C={},v(this,"each_pair",[],function(c,l){return null==c&&(c=y),null==l&&(l=y),C[c]=P("Native").$try_convert(l,l)},2),C},0)}(Y[0],0,Y),function(M,G,z){var A=H(M,null,"Array"),N=[A].concat(z),P=E.$r(N);V(A,"$to_n",function(){for(var C=[],h=0,c=this.length;h<c;h++){var l=this[h];C.push(P("Native").$try_convert(l,l))}return C},0)}(Y[0],0,Y),function(M,G){var z=H(M,null,"Boolean");V(z,"$to_n",function(){return this.valueOf()},0)}(Y[0]),function(M,G){var z=H(M,null,"Time");V(z,"$to_n",function(){return this},0)}(Y[0]),function(M,G){var z=H(M,null,"NilClass");V(z,"$to_n",function(){return null},0)}(Y[0]),k(a("Hash")["$method_defined?"]("_initialize"))||function(M,G,z){var A=H(M,null,"Hash"),N=[A].concat(z),P=E.$r(N);L(A,"_initialize","initialize"),V(A,"$initialize",function g(b){var C=g.$$p||y,h=this;if(delete g.$$p,null!=b&&(void 0===b.constructor||b.constructor===Object)){var f,m,c=h.$$smap,l=h.$$keys;for(f in b)!(m=b[f])||void 0!==m.constructor&&m.constructor!==Object?m&&m.$$is_array?(m=m.map(function(x){return!x||void 0!==x.constructor&&x.constructor!==Object?h.$Native(x):P("Hash").$new(x)}),c[f]=m):c[f]=h.$Native(m):c[f]=P("Hash").$new(m),l.push(f);return h}return v(h,"_initialize",[b],C.$to_proc())},-1),V(A,"$to_n",function(){for(var l,f,C={},h=this.$$keys,c=this.$$smap,m=0,x=h.length;m<x;m++)f=(l=h[m]).$$is_string?c[l]:(l=l.key).value,C[l]=P("Native").$try_convert(f,f);return C},0)}(Y[0],0,Y),function(M,G){var z=H(M,null,"Module");V(z,"$native_module",function(){return E.global[this.$name()]=this},0)}(Y[0]),function(M,G,z){var A=H(M,null,"Class"),N=[A].concat(z),P=E.$r(N);V(A,"$native_alias",function(b,C){var h=this,c=h.prototype["$"+C];c||h.$raise(P("NameError").$new("undefined method `"+C+"' for class `"+h.$inspect()+"'",C)),h.prototype[b]=c},2),V(A,"$native_class",function(){var b=this;return b.$native_module(),b.new=b.$new},0)}(Y[0],0,Y),ee.$=ee.global=ae.$Native(E.global)}),Opal.modules.strscan=function(E){var V,L,H,U,se,ae=[],Y=E.nil,y=E.def,w=E.truthy,p=E.eqeqeq,u=E.Opal,k=E.send,v=E.to_a,D=E.rb_minus,_=E.alias;return V=ae,H=[L=(0,E.klass)(ae[0],null,"StringScanner")].concat(V),U=E.$r(H),(se=L.$$prototype).pos=se.string=se.working=se.matched=se.prev_pos=se.match=Y,L.$attr_reader("pos","matched"),y(L,"$initialize",function(J){var K=this;return K.string=J,K.pos=0,K.matched=Y,K.working=J,K.match=[]},1),L.$attr_reader("string"),y(L,"$beginning_of_line?",function(){var J=this;return 0===J.pos||"\n"===J.string.charAt(J.pos-1)},0),y(L,"$scan",function(J){var K=this,ee=(J=K.$anchor(J)).exec(K.working);return null==ee?K.matched=Y:"object"==typeof ee?(K.prev_pos=K.pos,K.pos+=ee[0].length,K.working=K.working.substring(ee[0].length),K.matched=ee[0],K.match=ee,ee[0]):"string"==typeof ee?(K.pos+=ee.length,K.working=K.working.substring(ee.length),ee):Y},1),y(L,"$scan_until",function(J){var K=this;J=K.$anchor(J);for(var G,ee=K.pos,M=K.working;;){if(G=J.exec(M),ee+=1,M=M.substr(1),null!=G)return K.matched=K.string.substr(K.pos,ee-K.pos-1+G[0].length),K.match=G,K.prev_pos=ee-1,K.pos=ee,K.working=M.substr(G[0].length),K.matched;if(0===M.length)return K.match=[],K.matched=Y}},1),y(L,"$[]",function(J){var ee;if(w(this.match["$empty?"]()))return Y;p(U("Symbol"),ee=J)?J=J.$to_s():p(U("String"),ee)||(J=u["$coerce_to!"](J,U("Integer"),"to_int"));var M=this.match;return J<0&&(J+=M.length),J<0||J>=M.length||null==M[J]?Y:M[J]},1),y(L,"$check",function(J){var K=this,ee=(J=K.$anchor(J)).exec(K.working);return K.matched=null==ee?Y:ee[0]},1),y(L,"$check_until",function(J){var K=this,ee=K.prev_pos,M=K.pos,G=K.$scan_until(J);return G!==Y&&(K.matched=G.substr(-1),K.working=K.string.substr(M)),K.prev_pos=ee,K.pos=M,G},1),y(L,"$peek",function(J){return this.working.substring(0,J)},1),y(L,"$eos?",function(){return 0===this.working.length},0),y(L,"$exist?",function(J){var ee=J.exec(this.working);return null==ee?Y:0==ee.index?0:ee.index+1},1),y(L,"$skip",function(J){var K=this,ee=(J=K.$anchor(J)).exec(K.working);if(null==ee)return K.match=[],K.matched=Y;var M=ee[0],G=M.length;return K.matched=M,K.match=ee,K.prev_pos=K.pos,K.pos+=G,K.working=K.working.substring(G),G},1),y(L,"$skip_until",function(J){var ee=this.$scan_until(J);return ee===Y?Y:(this.matched=ee.substr(-1),ee.length)},1),y(L,"$get_byte",function(){var J=this,K=Y;return J.pos<J.string.length?(J.prev_pos=J.pos,J.pos+=1,K=J.matched=J.working.substring(0,1),J.working=J.working.substring(1)):J.matched=Y,K},0),y(L,"$match?",function(J){var K=this,ee=(J=K.$anchor(J)).exec(K.working);return null==ee?Y:(K.prev_pos=K.pos,ee[0].length)},1),y(L,"$pos=",function(J){var K=this;return J<0&&(J+=K.string.$length()),K.pos=J,K.working=K.string.slice(J)},1),y(L,"$matched_size",function(){return this.matched===Y?Y:this.matched.length},0),y(L,"$post_match",function(){var J=this;return J.matched===Y?Y:J.string.substr(J.pos)},0),y(L,"$pre_match",function(){var J=this;return J.matched===Y?Y:J.string.substr(0,J.prev_pos)},0),y(L,"$reset",function(){var J=this;return J.working=J.string,J.matched=Y,J.pos=0},0),y(L,"$rest",function(){return this.working},0),y(L,"$rest?",function(){return 0!==this.working.length},0),y(L,"$rest_size",function(){return this.$rest().$size()},0),y(L,"$terminate",function(){var K,J=this;return J.match=Y,K=[J.string.$length()],k(J,"pos=",v(K)),K[D(K.length,1)]},0),y(L,"$unscan",function(){var J=this;return J.pos=J.prev_pos,J.prev_pos=Y,J.match=Y,J},0),_(L,"bol?","beginning_of_line?"),_(L,"getch","get_byte"),L.$private(),y(L,"$anchor",function(J){var K=J.toString().match(/\/([^\/]+)$/);return K=K?K[1]:void 0,new RegExp("^(?:"+J.source+")",K)},1)},Opal.queue(function(E){var v,D,oe,_,ae=E.top,Y=[],a=E.$r(Y),y=E.nil,w=E.klass,p=E.def,u=E.module;return ae.$require("strscan"),D=Y,[_=w(Y[0],null,"Dir")].concat(D),oe=E.get_singleton_class(_),p(oe,"$[]",function(){return[]},0),v=u(Y[0],"ObjectFreezeStub"),p(v,"$freeze",function(){return this},0),a("Object").$prepend(a("ObjectFreezeStub")),function(k){var v=u(k,"StringScannerPatch");p(v,"$scan_until",function(_){var F=this;_=(F=this).$anchor(_);for(var L,oe=F.pos,V=F.working;;){var H=0===V.length;if(L=_.exec(V),oe+=1,V=V.substr(1),null!=L)return F.matched=F.string.substr(F.pos,oe-F.pos-1+L[0].length),F.prev_pos=oe-1,F.pos=oe,F.working=V.substr(L[0].length-1),F.matched;if(H)return F.matched=y}},1)}(Y[0]),a("StringScanner").$prepend(a("StringScannerPatch")),E.top.$__dir__=()=>"/",y})},8465:(E,ae,Y)=>{Y(9993),Opal.modules["bcdice/arithmetic/node"]=function(a){var ue,M,N,c,l,g,b,z,K,y=[],w=a.nil,p=a.$$$,u=a.module,k=a.klass,v=a.def,D=a.send2,_=a.find_super,F=a.eqeq,oe=a.const_set,V=a.eqeqeq,L=a.rb_divide,H=a.truthy,U=a.alias;return ue=y,M=K=[u(y[0],"BCDice")].concat(ue),N=z=[u(K[0],"Arithmetic")].concat(M),g=[u(z[0],"Node")].concat(N),b=a.$r(g),(l=(c=k(g[0],null,"BinaryOp")).$$prototype).lhs=l.rhs=l.op=w,v(c,"$initialize",function(m,x,S){var Z=this;return Z.lhs=m,Z.op=x,Z.rhs=S},3),v(c,"$eval",function(m){var Z,x=this,S=w;return S=x.lhs.$eval(m),Z=x.rhs.$eval(m),S.$send(x.op,Z)},1),v(c,"$output",function(){var m=this;return""+m.lhs.$output()+m.op+m.rhs.$output()},0),v(c,"$s_exp",function(){var m=this;return"("+m.$op_for_s_exp()+" "+m.lhs.$s_exp()+" "+m.rhs.$s_exp()+")"},0),v(c,"$op_for_s_exp",function(){return this.op},0),function(C,h,c){var l=k(C,h,"DivideBase"),f=[l].concat(c),m=a.$r(f),x=l.$$prototype;x.lhs=x.rhs=x.op=w,v(l,"$initialize",function S(Z,le){return delete S.$$p,D(this,_(this,"initialize",S,!1,!0),"initialize",[Z,"/",le],null)},2),v(l,"$eval",function(Z){var ye,T;return ye=this.lhs.$eval(Z),T=this.rhs.$eval(Z),F(T,0)&&this.$raise(m("ZeroDivisionError")),this.$divide_and_round(ye,T,Z)},1),v(l,"$output",function S(){var Z=S.$$p||w;return delete S.$$p,""+D(this,_(this,"output",S,!1,!0),"output",[],Z)+this.$rounding_method()},0),l.$private(),v(l,"$rounding_method",function(){return p(this.$class(),"ROUNDING_METHOD")},0),v(l,"$op_for_s_exp",function(){return""+this.op+this.$rounding_method()},0),v(l,"$divide_and_round",function(Z,le,ye){return this.$raise(m("NotImplementedError"))},3)}(g[0],b("BinaryOp"),g),function(C,h,c){var l=k(C,h,"DivideWithGameSystemDefault"),f=[l].concat(c),m=a.$r(f);oe(f[0],"ROUNDING_METHOD",""),l.$private(),v(l,"$divide_and_round",function(S,Z,le){var ye,T=w;return V(p(m("RoundType"),"CEIL"),ye=le)?L(S.$to_f(),Z).$ceil():V(p(m("RoundType"),"ROUND"),ye)?(T=L(S.$to_f(),Z),H(T["$negative?"]())?T.$abs().$round()["$-@"]():T.$round()):L(S,Z).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithCeil"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","C"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){return L(x.$to_f(),S).$ceil()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithRound"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","R"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){var le=w;return le=L(x.$to_f(),S),H(le["$negative?"]())?le.$abs().$round()["$-@"]():le.$round()},3)}(g[0],b("DivideBase"),g),function(C,h,c){var l=k(C,h,"DivideWithFloor"),f=[l].concat(c);oe(f[0],"ROUNDING_METHOD","F"),l.$private(),v(l,"$divide_and_round",function(x,S,Z){return L(x,S).$floor()},3)}(g[0],b("DivideBase"),g),function(C,h){var c=k(C,null,"Negative");c.$$prototype.body=w,v(c,"$initialize",function(m){return this.body=m},1),v(c,"$eval",function(m){return this.body.$eval(m)["$-@"]()},1),v(c,"$output",function(){return"-"+this.body.$output()},0),v(c,"$s_exp",function(){return"(- "+this.body.$s_exp()+")"},0)}(g[0]),function(C,h){var c=k(C,null,"Parenthesis");c.$$prototype.expr=w,v(c,"$initialize",function(m){return this.expr=m},1),v(c,"$eval",function(m){return this.expr.$eval(m)},1),v(c,"$output",function(){return"("+this.expr.$output()+")"},0),v(c,"$s_exp",function(){return"(Parenthesis "+this.expr.$s_exp()+")"},0)}(g[0]),function(C,h){var c=k(C,null,"Number");return c.$$prototype.value=w,v(c,"$initialize",function(m){return this.value=m},1),v(c,"$eval",function(m){return this.value},1),v(c,"$output",function(){return this.value.$to_s()},0),U(c,"s_exp","output")}(g[0])},Opal.modules["racc/parser"]=function(a){var b,h,c,w=[],p=a.$r(w),u=a.nil,k=a.$$$,v=a.module,D=a.klass,_=a.truthy,F=a.const_set,oe=a.defs,V=a.gvars,L=a.rb_lt,H=a.send,U=a.to_a,se=a.rb_minus,ue=a.def,J=a.to_ary,K=a.neqeq,ee=a.rb_plus,M=a.eqeq,G=a.rb_ge,z=a.rb_gt,A=a.eqeqeq,N=a.rb_le,P=a.rb_times;return b=w,h=[v(w[0],"Racc")].concat(b),c=a.$r(h),D(h[0],c("StandardError"),"ParseError"),_(k("::","ParseError","skip_raise")?"constant":u)||F(w[0],"ParseError",k(p("Racc"),"ParseError")),function(g,b){var x,S,Z,le,ye,c=[v(g,"Racc")].concat(b),l=a.$r(c);return _(l("Racc_No_Extensions","skip_raise")?"constant":u)||F(c[0],"Racc_No_Extensions",!1),x=c,Z=[S=D(c[0],null,"Parser")].concat(x),le=a.$r(Z),(ye=S.$$prototype).yydebug=ye.racc_debug_out=ye.racc_error_status=ye.racc_t=ye.racc_vstack=ye.racc_val=ye.racc_state=ye.racc_tstack=u,F(Z[0],"Racc_Runtime_Version","1.4.6"),F(Z[0],"Racc_Runtime_Revision",["originalRevision:","1.8"]["$[]"](1)),F(Z[0],"Racc_Runtime_Core_Version_R","1.4.6"),F(Z[0],"Racc_Runtime_Core_Revision_R",["originalRevision:","1.8"]["$[]"](1)),F(Z[0],"Racc_Main_Parsing_Routine","_racc_do_parse_rb"),F(Z[0],"Racc_YY_Parse_Method","_racc_yyparse_rb"),F(Z[0],"Racc_Runtime_Core_Version",le("Racc_Runtime_Core_Version_R")),F(Z[0],"Racc_Runtime_Core_Revision",le("Racc_Runtime_Core_Revision_R")),F(Z[0],"Racc_Runtime_Type","ruby"),oe(le("Parser"),"$racc_runtime_type",function(){return le("Racc_Runtime_Type")},0),ue(S,"$_racc_setup",function(){var R,ie,j=this,ve=u,de=u,we=u;return null==V.stderr&&(V.stderr=u),_(k(j.$class(),"Racc_debug_parser"))||(j.yydebug=!1),_(null!=(R=j.yydebug)&&R!==u?"instance-variable":u)||(j.yydebug=!1),_(j.yydebug)&&(_(null!=(ie=j.racc_debug_out)&&ie!==u?"instance-variable":u)||(j.racc_debug_out=V.stderr),j.racc_debug_out=_(ve=j.racc_debug_out)?ve:V.stderr),de=k(j.$class(),"Racc_arg"),_(L(de.$size(),14))&&(H(de,"[]=",U(we=[13,!0])),se(we.length,1)),de},0),ue(S,"$_racc_init_sysvars",function(){var R=this;return R.racc_state=[0],R.racc_tstack=[],R.racc_vstack=[],R.racc_t=u,R.racc_val=u,R.racc_read_next=!0,R.racc_user_yyerror=!1,R.racc_error_status=0},0),ue(S,"$do_parse",function(){return this.$__send__(le("Racc_Main_Parsing_Routine"),this.$_racc_setup(),!1)},0),ue(S,"$next_token",function(){return this.$raise(le("NotImplementedError"),this.$class()+"#next_token is not defined")},0),ue(S,"$_racc_do_parse_rb",function(R,ie){var j,we=u,ce=u,he=u,B=u,ne=u,q=u,pe=u,$e=u;return j=J(R),we=null==j[0]?u:j[0],ce=null==j[1]?u:j[1],he=null==j[2]?u:j[2],B=null==j[3]?u:j[3],ne=null==j[10]?u:j[10],this.$_racc_init_sysvars(),q=pe=$e=u,H(this,"catch",["racc_end_parse"],function me(){var De,Me,Pe=null==me.$$s?this:me.$$s,Ve=u;for(null==Pe.racc_state&&(Pe.racc_state=u),null==Pe.racc_read_next&&(Pe.racc_read_next=u),null==Pe.racc_t&&(Pe.racc_t=u),null==Pe.yydebug&&(Pe.yydebug=u),null==Pe.racc_val&&(Pe.racc_val=u);_(!0);)for(_($e=B["$[]"](Pe.racc_state["$[]"](-1)))?(_(Pe.racc_read_next)&&K(Pe.racc_t,0)&&(Me=Pe.$next_token(),De=J(Me),q=null==De[0]?u:De[0],Pe.racc_val=null==De[1]?u:De[1],Pe.racc_t=_(q)?_(Ve=ne["$[]"](q))?Ve:1:0,_(Pe.yydebug)&&Pe.$racc_read_token(Pe.racc_t,q,Pe.racc_val),Pe.racc_read_next=!1),$e=ee($e,Pe.racc_t),_(G($e,0))&&_(pe=we["$[]"]($e))&&M(ce["$[]"]($e),Pe.racc_state["$[]"](-1))||(pe=he["$[]"](Pe.racc_state["$[]"](-1)))):pe=he["$[]"](Pe.racc_state["$[]"](-1));_(pe=Pe.$_racc_evalact(pe,R)););},{$$arity:0,$$s:this})},2),ue(S,"$yyparse",function(R,ie){return this.$__send__(le("Racc_YY_Parse_Method"),R,ie,this.$_racc_setup(),!0)},2),ue(S,"$_racc_yyparse_rb",function(R,ie,j,ve){var de,he=u,B=u,O=u,ne=u,pe=u,$e=u,me=u;return de=J(j),he=null==de[0]?u:de[0],B=null==de[1]?u:de[1],O=null==de[2]?u:de[2],ne=null==de[3]?u:de[3],pe=null==de[10]?u:de[10],this.$_racc_init_sysvars(),$e=u,me=u,H(this,"catch",["racc_end_parse"],function Te(){var Pe=null==Te.$$s?this:Te.$$s;for(null==Pe.racc_state&&(Pe.racc_state=u);!_(me=ne["$[]"](Pe.racc_state["$[]"](-1)));)for(;_($e=Pe.$_racc_evalact(O["$[]"](Pe.racc_state["$[]"](-1)),j)););return H(R,"__send__",[ie],function Ve(Qe,Mt){var gt=null==Ve.$$s?this:Ve.$$s,mt=u,rr=u;for(null==gt.racc_t&&(gt.racc_t=u),null==gt.racc_state&&(gt.racc_state=u),null==gt.racc_read_next&&(gt.racc_read_next=u),null==Qe&&(Qe=u),null==Mt&&(Mt=u),gt.racc_t=_(Qe)?_(mt=pe["$[]"](Qe))?mt:1:0,gt.racc_val=Mt,gt.racc_read_next=!1,me=ee(me,gt.racc_t),_(G(me,0))&&_($e=he["$[]"](me))&&M(B["$[]"](me),gt.racc_state["$[]"](-1))||($e=O["$[]"](gt.racc_state["$[]"](-1)));_($e=gt.$_racc_evalact($e,j)););for(;_(_(mt=_(rr=(me=ne["$[]"](gt.racc_state["$[]"](-1)))["$!"]())?rr:gt.racc_read_next["$!"]())?mt:gt.racc_t["$=="](0));)for(_(me)&&_(me=ee(me,gt.racc_t))&&_(G(me,0))&&_($e=he["$[]"](me))&&M(B["$[]"](me),gt.racc_state["$[]"](-1))||($e=O["$[]"](gt.racc_state["$[]"](-1)));_($e=gt.$_racc_evalact($e,j)););},{$$arity:2,$$s:Pe})},{$$arity:0,$$s:this})},4),ue(S,"$_racc_evalact",function(R,ie){var j,O,de=this,we=u,ce=u,B=u,ne=u,q=u,pe=u,$e=u;if(we=null==(j=J(ie))[0]?u:j[0],ce=null==j[1]?u:j[1],B=null==j[3]?u:j[3],O=null==j[11]?u:j[11],ne=null==j[12]?u:j[12],_(z(R,0))&&_(L(R,O)))_(z(de.racc_error_status,0))&&(M(de.racc_t,1)||(de.racc_error_status=se(de.racc_error_status,1))),de.racc_vstack.$push(de.racc_val),de.racc_state.$push(R),de.racc_read_next=!0,_(de.yydebug)&&(de.racc_tstack.$push(de.racc_t),de.$racc_shift(de.racc_t,de.racc_tstack,de.racc_vstack));else if(_(L(R,0))&&_(z(R,ne["$-@"]()))){if(q=H(de,"catch",["racc_jump"],function me(){var Te=null==me.$$s?this:me.$$s;return null==Te.racc_state&&(Te.racc_state=u),Te.racc_state.$push(Te.$_racc_do_reduce(ie,R)),!1},{$$arity:0,$$s:de}),_(q)){if(A(1,pe=q))return de.racc_user_yyerror=!0,ne["$-@"]();if(A(2,pe))return O;de.$raise("[Racc Bug] unknown jump code")}}else if(M(R,O))_(de.yydebug)&&de.$racc_accept(),de.$throw("racc_end_parse",de.racc_vstack["$[]"](0));else{if(M(R,ne["$-@"]())){for(A(0,pe=de.racc_error_status)?_(ie["$[]"](21))||de.$on_error(de.racc_t,de.racc_val,de.racc_vstack):A(3,pe)&&(M(de.racc_t,0)&&de.$throw("racc_end_parse",u),de.racc_read_next=!0),de.racc_user_yyerror=!1,de.racc_error_status=3;_(!0)&&!(_($e=B["$[]"](de.racc_state["$[]"](-1)))&&($e=ee($e,1),_(G($e,0))&&_(R=we["$[]"]($e))&&M(ce["$[]"]($e),de.racc_state["$[]"](-1))));)_(N(de.racc_state.$size(),1))&&de.$throw("racc_end_parse",u),de.racc_state.$pop(),de.racc_vstack.$pop(),_(de.yydebug)&&(de.racc_tstack.$pop(),de.$racc_e_pop(de.racc_state,de.racc_tstack,de.racc_vstack));return R}de.$raise("[Racc Bug] unknown action "+R.$inspect())}return _(de.yydebug)&&de.$racc_next_state(de.racc_state["$[]"](-1),de.racc_state),u},2),ue(S,"$_racc_do_reduce",function(R,ie){var j,ne,pe,Pe,Ve,Qe,gt,de=this,ce=u,he=u,B=u,O=u,q=u,$e=u,me=u,Te=u,De=u,Me=u,Mt=u,Bt=u,Pt=u,mt=u;return ce=null==(j=J(R))[4]?u:j[4],he=null==j[5]?u:j[5],B=null==j[6]?u:j[6],O=null==j[7]?u:j[7],ne=null==j[8]?u:j[8],q=null==j[9]?u:j[9],pe=null==j[13]?u:j[13],$e=de.racc_state,me=de.racc_vstack,Te=de.racc_tstack,De=P(ie,-3),Me=q["$[]"](De),Pe=q["$[]"](ee(De,1)),Ve=q["$[]"](ee(De,2)),Qe=[],_(de.yydebug)&&(Mt=Te["$[]"](Me["$-@"](),Me)),Bt=me["$[]"](Me["$-@"](),Me),_(de.yydebug)&&(Pt=[Me["$-@"](),Me,Qe],H(Te,"[]=",U(Pt)),se(Pt.length,1)),Pt=[Me["$-@"](),Me,Qe],H(me,"[]=",U(Pt)),se(Pt.length,1),Pt=[Me["$-@"](),Me,Qe],H($e,"[]=",U(Pt)),se(Pt.length,1),_(pe)?me.$push(de.$__send__(Ve,Bt,me,Bt["$[]"](0))):me.$push(de.$__send__(Ve,Bt,me)),Te.$push(Pe),_(de.yydebug)&&de.$racc_reduce(Mt,Pe,Te,me),gt=se(Pe,ne),_(De=O["$[]"](gt))&&(De=ee(De,$e["$[]"](-1)),_(G(De,0))&&_(mt=ce["$[]"](De))&&M(he["$[]"](De),gt))?mt:B["$[]"](gt)},2),ue(S,"$on_error",function(R,ie,j){var de;return this.$raise(le("ParseError"),this.$sprintf("\nparse error on value %s (%s)",ie.$inspect(),_(de=this.$token_to_str(R))?de:"?"))},3),ue(S,"$yyerror",function(){return this.$throw("racc_jump",1)},0),ue(S,"$yyaccept",function(){return this.$throw("racc_jump",2)},0),ue(S,"$yyerrok",function(){return this.racc_error_status=0},0),ue(S,"$racc_read_token",function(R,ie,j){var ve=this;return ve.racc_debug_out.$print("read    "),ve.racc_debug_out.$print(ie.$inspect(),"(",ve.$racc_token2str(R),") "),ve.racc_debug_out.$puts(j.$inspect()),ve.racc_debug_out.$puts()},3),ue(S,"$racc_shift",function(R,ie,j){return this.racc_debug_out.$puts("shift   "+this.$racc_token2str(R)),this.$racc_print_stacks(ie,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_reduce",function(R,ie,j,ve){var de=this,we=u;return(we=de.racc_debug_out).$print("reduce "),_(R["$empty?"]())?we.$print(" <none>"):H(R,"each",[],function ce(he){return null==he&&(he=u),we.$print(" ",(null==ce.$$s?this:ce.$$s).$racc_token2str(he))},{$$arity:1,$$s:de}),we.$puts(" --\x3e "+de.$racc_token2str(ie)),de.$racc_print_stacks(j,ve),de.racc_debug_out.$puts()},4),ue(S,"$racc_accept",function(){return this.racc_debug_out.$puts("accept"),this.racc_debug_out.$puts()},0),ue(S,"$racc_e_pop",function(R,ie,j){return this.racc_debug_out.$puts("error recovering mode: pop token"),this.$racc_print_states(R),this.$racc_print_stacks(ie,j),this.racc_debug_out.$puts()},3),ue(S,"$racc_next_state",function(R,ie){var j=this;return j.racc_debug_out.$puts("goto    "+R),j.$racc_print_states(ie),j.racc_debug_out.$puts()},2),ue(S,"$racc_print_stacks",function(R,ie){var ve=u;return(ve=this.racc_debug_out).$print("        ["),H(R,"each_index",[],function de(we){return null==we&&(we=u),ve.$print(" (",(null==de.$$s?this:de.$$s).$racc_token2str(R["$[]"](we))," ",ie["$[]"](we).$inspect(),")")},{$$arity:1,$$s:this}),ve.$puts(" ]")},2),ue(S,"$racc_print_states",function(R){var j=u;return(j=this.racc_debug_out).$print("        ["),H(R,"each",[],function(de){return null==de&&(de=u),j.$print(" ",de)},1),j.$puts(" ]")},1),ue(S,"$racc_token2str",function(R){var j;return _(j=k(this.$class(),"Racc_token_to_s_table")["$[]"](R))?j:this.$raise("[Racc Bug] can't convert token "+R+" to string")},1),ue(S,"$token_to_str",function(R){return k(this.$class(),"Racc_token_to_s_table")["$[]"](R)},1)}(w[0],w)},Opal.modules.strscan=function(a){var U,se,ue,J,K,y=[],w=a.nil,u=a.def,k=a.truthy,v=a.eqeqeq,D=a.Opal,_=a.send,F=a.to_a,oe=a.rb_minus,V=a.alias;return U=y,ue=[se=(0,a.klass)(y[0],null,"StringScanner")].concat(U),J=a.$r(ue),(K=se.$$prototype).pos=K.string=K.working=K.matched=K.prev_pos=K.match=w,se.$attr_reader("pos","matched"),u(se,"$initialize",function(M){var G=this;return G.string=M,G.pos=0,G.matched=w,G.working=M,G.match=[]},1),se.$attr_reader("string"),u(se,"$beginning_of_line?",function(){var M=this;return 0===M.pos||"\n"===M.string.charAt(M.pos-1)},0),u(se,"$scan",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return null==z?G.matched=w:"object"==typeof z?(G.prev_pos=G.pos,G.pos+=z[0].length,G.working=G.working.substring(z[0].length),G.matched=z[0],G.match=z,z[0]):"string"==typeof z?(G.pos+=z.length,G.working=G.working.substring(z.length),z):w},1),u(se,"$scan_until",function(M){var G=this;M=G.$anchor(M);for(var N,z=G.pos,A=G.working;;){if(N=M.exec(A),z+=1,A=A.substr(1),null!=N)return G.matched=G.string.substr(G.pos,z-G.pos-1+N[0].length),G.match=N,G.prev_pos=z-1,G.pos=z,G.working=A.substr(N[0].length),G.matched;if(0===A.length)return G.match=[],G.matched=w}},1),u(se,"$[]",function(M){var z;if(k(this.match["$empty?"]()))return w;v(J("Symbol"),z=M)?M=M.$to_s():v(J("String"),z)||(M=D["$coerce_to!"](M,J("Integer"),"to_int"));var A=this.match;return M<0&&(M+=A.length),M<0||M>=A.length||null==A[M]?w:A[M]},1),u(se,"$check",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return G.matched=null==z?w:z[0]},1),u(se,"$check_until",function(M){var G=this,z=G.prev_pos,A=G.pos,N=G.$scan_until(M);return N!==w&&(G.matched=N.substr(-1),G.working=G.string.substr(A)),G.prev_pos=z,G.pos=A,N},1),u(se,"$peek",function(M){return this.working.substring(0,M)},1),u(se,"$eos?",function(){return 0===this.working.length},0),u(se,"$exist?",function(M){var z=M.exec(this.working);return null==z?w:0==z.index?0:z.index+1},1),u(se,"$skip",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);if(null==z)return G.match=[],G.matched=w;var A=z[0],N=A.length;return G.matched=A,G.match=z,G.prev_pos=G.pos,G.pos+=N,G.working=G.working.substring(N),N},1),u(se,"$skip_until",function(M){var z=this.$scan_until(M);return z===w?w:(this.matched=z.substr(-1),z.length)},1),u(se,"$get_byte",function(){var M=this,G=w;return M.pos<M.string.length?(M.prev_pos=M.pos,M.pos+=1,G=M.matched=M.working.substring(0,1),M.working=M.working.substring(1)):M.matched=w,G},0),u(se,"$match?",function(M){var G=this,z=(M=G.$anchor(M)).exec(G.working);return null==z?w:(G.prev_pos=G.pos,z[0].length)},1),u(se,"$pos=",function(M){var G=this;return M<0&&(M+=G.string.$length()),G.pos=M,G.working=G.string.slice(M)},1),u(se,"$matched_size",function(){return this.matched===w?w:this.matched.length},0),u(se,"$post_match",function(){var M=this;return M.matched===w?w:M.string.substr(M.pos)},0),u(se,"$pre_match",function(){var M=this;return M.matched===w?w:M.string.substr(0,M.prev_pos)},0),u(se,"$reset",function(){var M=this;return M.working=M.string,M.matched=w,M.pos=0},0),u(se,"$rest",function(){return this.working},0),u(se,"$rest?",function(){return 0!==this.working.length},0),u(se,"$rest_size",function(){return this.$rest().$size()},0),u(se,"$terminate",function(){var G,M=this;return M.match=w,G=[M.string.$length()],_(M,"pos=",F(G)),G[oe(G.length,1)]},0),u(se,"$unscan",function(){var M=this;return M.pos=M.prev_pos,M.prev_pos=w,M.match=w,M},0),V(se,"bol?","beginning_of_line?"),V(se,"getch","get_byte"),se.$private(),u(se,"$anchor",function(M){var G=M.toString().match(/\/([^\/]+)$/);return G=G?G[1]:void 0,new RegExp("^(?:"+M.source+")",G)},1)},Opal.modules["bcdice/normalize"]=function(a){var _,L,oe,y=[],w=a.nil,p=a.module,u=a.eqeqeq,k=a.def,v=a.eqeq;return _=y,oe=[p(y[0],"BCDice")].concat(_),(L=p(oe[0],"Normalize")).$module_function(),k(L,"$comparison_operator",function(U){var se;return u(/<=|=</,se=U)?"<=":u(/>=|=>/,se)?">=":u(/<>|!=|=!/,se)?"!=":u(/</,se)?"<":u(/>/,se)?">":u(/=/,se)?"==":w},1),k(L,"$target_number",function(U){return v(U,"?")?U:U.$to_i()},1)},Opal.modules["bcdice/common_command/lexer"]=function(a){var V,se,M,G,z,A,J,H,y=a.top,w=[],p=a.nil,u=a.module,k=a.klass,v=a.const_set,D=a.hash2,_=a.truthy,F=a.def;return y.$require("strscan"),y.$require("bcdice/normalize"),V=w,se=H=[u(w[0],"BCDice")].concat(V),M=J=[u(H[0],"CommonCommand")].concat(se),z=[G=k(J[0],null,"Lexer")].concat(M),A=a.$r(z),G.$$prototype.scanner=p,v(z[0],"SYMBOLS",D(["+","-","*","/","(",")","[","]","?","@"],{"+":"PLUS","-":"MINUS","*":"ASTERISK","/":"SLASH","(":"PARENL",")":"PARENR","[":"BRACKETL","]":"BRACKETR","?":"QUESTION","@":"AT"}).$freeze()),F(G,"$initialize",function(g){var C;return g=_(C=g.$split(" ",2).$first())?C:"",this.scanner=A("StringScanner").$new(g)},1),F(G,"$next_token",function(){var g=this,b=p,C=p,h=p,l=p;return _(g.scanner["$eos?"]())?[!1,"$"]:_(b=g.scanner.$scan(/\d+/))?["NUMBER",b.$to_i()]:_(C=g.scanner.$scan(/[<>!=]+/))?["CMP_OP",A("Normalize").$comparison_operator(C)]:(h=g.scanner.$getch().$upcase(),[_(l=A("SYMBOLS")["$[]"](h))?l:h.$to_sym(),h])},0),F(G,"$source",function(){return this.scanner.$string()},0)},Opal.modules["bcdice/arithmetic/parser"]=function(a){var L,ue,z,g,b,C,h,c,l,f,m,x,le,A,N,P,K,ee,U,y=a.top,w=[],p=a.nil,u=a.$$$,k=a.module,v=a.klass,D=a.defs,_=a.def,F=a.hash,oe=a.const_set;return y.$require("racc/parser.rb"),y.$require("bcdice/common_command/lexer"),y.$require("bcdice/arithmetic/node"),L=w,ue=U=[k(w[0],"BCDice")].concat(L),K=[k(U[0],"Arithmetic")].concat(ue),ee=a.$r(K),z=K,N=[A=v(K[0],u(ee("Racc"),"Parser"),"Parser")].concat(z),P=a.$r(N),A.$$prototype.lexer=p,D(A,"$parse",function(j){return this.$new().$parse(j)},1),_(A,"$parse",function(j){try{return this.lexer=u(u(P("BCDice"),"CommonCommand"),"Lexer").$new(j),this.$do_parse()}catch(de){if(!a.rescue(de,[P("ParseError")]))throw de;try{return p}finally{a.pop_exception()}}},1),A.$private(),_(A,"$next_token",function(){return this.lexer.$next_token()},0),g=[8,17,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,12,13,4,5,4,5,7,8,7,8,p,p,4,5,4,5,7,9,7,p,p,10,11,p,10,11,22,26,24,25,27],b=[0,9,4,2,2,0,0,4,4,0,5,4,7,18,18,5,5,7,7,5,10,7,11,19,19,10,10,11,11,10,12,11,13,p,p,12,12,13,13,12,1,13,p,p,16,16,p,1,1,16,21,21,21,21],C=[-2,40,-6,p,0,8,p,10,p,1,18,20,28,30,p,p,37,p,4,14,p,47,p,p,p,p,p,p],h=[-17,-17,-3,-6,-17,-17,-14,-17,-16,-17,-17,-17,-17,-17,-12,-13,-17,28,-1,-2,-4,-7,-15,-5,-8,-9,-10,-11],c=[14,15,23,1,18,19,p,p,20,21,16],l=[3,3,4,1,2,2,p,p,3,3,1],f=[p,3,-6,-4,-19,p],m=[p,p,2,3,p,6],x=[0,0,"racc_error",3,14,"_reduce_1",3,14,"_reduce_2",1,14,"_reduce_none",3,15,"_reduce_4",4,15,"_reduce_5",1,15,"_reduce_none",0,17,"_reduce_7",1,17,"_reduce_8",1,17,"_reduce_9",1,17,"_reduce_10",1,17,"_reduce_11",2,16,"_reduce_12",2,16,"_reduce_13",1,16,"_reduce_none",3,18,"_reduce_15",1,18,"_reduce_16"],le=F(!1,0,"error",1,"NUMBER",2,"R",3,"U",4,"C",5,"F",6,"PLUS",7,"MINUS",8,"ASTERISK",9,"SLASH",10,"PARENL",11,"PARENR",12),oe(N[0],"Racc_arg",[g,b,h,C,c,l,m,f,13,x,le,28,17,!0]),oe(N[0],"Racc_token_to_s_table",["$end","error","NUMBER","R","U","C","F","PLUS","MINUS","ASTERISK","SLASH","PARENL","PARENR","$start","add","mul","unary","round_type","term"]),oe(N[0],"Racc_debug_parser",!1),_(A,"$_reduce_1",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"BinaryOp").$new(j["$[]"](0),"+",j["$[]"](2))},3),_(A,"$_reduce_2",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"BinaryOp").$new(j["$[]"](0),"-",j["$[]"](2))},3),_(A,"$_reduce_4",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"BinaryOp").$new(j["$[]"](0),"*",j["$[]"](2))},3),_(A,"$_reduce_5",function(j,ve,de){return j["$[]"](3).$new(j["$[]"](0),j["$[]"](2))},3),_(A,"$_reduce_7",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"DivideWithGameSystemDefault")},3),_(A,"$_reduce_8",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"DivideWithCeil")},3),_(A,"$_reduce_9",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"DivideWithCeil")},3),_(A,"$_reduce_10",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"DivideWithRound")},3),_(A,"$_reduce_11",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"DivideWithFloor")},3),_(A,"$_reduce_12",function(j,ve,de){return j["$[]"](1)},3),_(A,"$_reduce_13",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"Negative").$new(j["$[]"](1))},3),_(A,"$_reduce_15",function(j,ve,de){return j["$[]"](1)},3),_(A,"$_reduce_16",function(j,ve,de){return u(u(P("Arithmetic"),"Node"),"Number").$new(j["$[]"](0))},3),_(A,"$_reduce_none",function(j,ve,de){return j["$[]"](0)},3)},Opal.modules["bcdice/arithmetic"]=function(a){var _,L,se,J,K,H,U,oe,y=a.top,w=[],p=a.nil,u=a.module,k=a.send,v=a.def;return y.$require("bcdice/arithmetic/node"),y.$require("bcdice/arithmetic/parser"),_=w,L=oe=[u(w[0],"BCDice")].concat(_),U=[H=u(oe[0],"Arithmetic")].concat(L),J=[se=a.get_singleton_class(H)].concat(U),K=a.$r(J),v(se,"$eval",function(M,G){var z;try{return(z=K("Parser").$parse(M))===p||null==z?p:k(z,"eval",[G])}catch(N){if(!a.rescue(N,[K("ZeroDivisionError")]))throw N;try{return p}finally{a.pop_exception()}}},2)},Opal.queue(function(a){var L,J,K,ee,M,G,U,w=[],p=a.nil,u=a.module,k=a.klass,v=a.defs,D=a.def,_=a.send,F=a.truthy,oe=a.eqeq;return a.top.$require("bcdice/arithmetic"),L=w,J=U=[u(w[0],"BCDice")].concat(L),ee=[K=k(U[0],null,"Preprocessor")].concat(J),M=a.$r(ee),(G=K.$$prototype).game_system=G.text=p,v(K,"$process",function(A,N){return M("Preprocessor").$new(A,N).$process()},2),D(K,"$initialize",function(A,N){return this.text=A,this.game_system=N},2),D(K,"$process",function(){var A=this;return A.$trim_after_whitespace(),A.$replace_parentheses(),A.text=A.game_system.$change_text(A.text),A.$replace_implicit_d(),A.text},0),K.$private(),D(K,"$trim_after_whitespace",function(){return this.text=this.text.$strip().$split(/\s/,2).$first()},0),D(K,"$replace_parentheses",function(){var A=this;return function(){var N=a.new_brk();try{return _(A,"loop",[],function P(){var b,g=null==P.$$s?this:P.$$s;if(null==g.text&&(g.text=p),b=g.text,g.text=_(g.text,"gsub",[/\([\d\/+*\-CURF]+\)/],function C(h){var l,c=null==C.$$s?this:C.$$s;return null==c.game_system&&(c.game_system=p),null==h&&(h=p),F(l=M("Arithmetic").$eval(h,c.game_system.$round_type()))?l:h},{$$arity:1,$$s:g}),!oe(b,g.text))return p;a.brk(p,N)},{$$arity:0,$$s:A,$$brk:N})}catch(P){if(P===N)return P.$v;throw P}}()},0),D(K,"$replace_implicit_d",function(){var A=this;return A.text=_(A.text,"gsub",[/(\d+)D([^\w]|$)/i],function N(){var P=null==N.$$s?this:N.$$s;return null==P.game_system&&(P.game_system=p),M("Regexp").$last_match(1)+"D"+P.game_system.$sides_implicit_d()+M("Regexp").$last_match(2)},{$$arity:0,$$s:A})},0)})},6956:(E,ae,Y)=>{Y(9993),Opal.queue(function(a){var v,y=[];return v=y,(0,a.const_set)([(0,a.module)(y[0],"BCDice")].concat(v)[0],"VERSION","3.7.0")})},3583:function(E,ae,Y){"use strict";var a=this&&this.__importDefault||function(p){return p&&p.__esModule?p:{default:p}};Object.defineProperty(ae,"__esModule",{value:!0}),ae.Opal=ae.I18n=ae.BCDice=void 0,Y(6956);var y=a(Y(8459));ae.BCDice=y.default.module(null,"BCDice"),ae.I18n=y.default.module(null,"I18n");var w=Y(8459);Object.defineProperty(ae,"Opal",{enumerable:!0,get:function(){return a(w).default}})},8459:(E,ae,Y)=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0}),ae.nilToNull=void 0,Y(9993),Opal.config.unsupported_features_severity="ignore",ae.default=Opal,ae.nilToNull=function a(y){return y===Opal.nil?null:y}},3604:function(E,ae,Y){"use strict";var V,a=this&&this.__extends||(V=function(L,H){return(V=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(U,se){U.__proto__=se}||function(U,se){for(var ue in se)Object.prototype.hasOwnProperty.call(se,ue)&&(U[ue]=se[ue])})(L,H)},function(L,H){function U(){this.constructor=L}V(L,H),L.prototype=null===H?Object.create(H):(U.prototype=H.prototype,new U)}),y=this&&this.__awaiter||function(V,L,H,U){return new(H||(H=Promise))(function(ue,J){function K(G){try{M(U.next(G))}catch(z){J(z)}}function ee(G){try{M(U.throw(G))}catch(z){J(z)}}function M(G){G.done?ue(G.value):function se(ue){return ue instanceof H?ue:new H(function(J){J(ue)})}(G.value).then(K,ee)}M((U=U.apply(V,L||[])).next())})},w=this&&this.__generator||function(V,L){var U,se,ue,J,H={label:0,sent:function(){if(1&ue[0])throw ue[1];return ue[1]},trys:[],ops:[]};return J={next:K(0),throw:K(1),return:K(2)},"function"==typeof Symbol&&(J[Symbol.iterator]=function(){return this}),J;function K(M){return function(G){return function ee(M){if(U)throw new TypeError("Generator is already executing.");for(;H;)try{if(U=1,se&&(ue=2&M[0]?se.return:M[0]?se.throw||((ue=se.return)&&ue.call(se),0):se.next)&&!(ue=ue.call(se,M[1])).done)return ue;switch(se=0,ue&&(M=[2&M[0],ue.value]),M[0]){case 0:case 1:ue=M;break;case 4:return H.label++,{value:M[1],done:!1};case 5:H.label++,se=M[1],M=[0];continue;case 7:M=H.ops.pop(),H.trys.pop();continue;default:if(!(ue=(ue=H.trys).length>0&&ue[ue.length-1])&&(6===M[0]||2===M[0])){H=0;continue}if(3===M[0]&&(!ue||M[1]>ue[0]&&M[1]<ue[3])){H.label=M[1];break}if(6===M[0]&&H.label<ue[1]){H.label=ue[1],ue=M;break}if(ue&&H.label<ue[2]){H.label=ue[2],H.ops.push(M);break}ue[2]&&H.ops.pop(),H.trys.pop();continue}M=L.call(V,H)}catch(G){M=[6,G],se=0}finally{U=ue=0}if(5&M[0])throw M[1];return{value:M[0]?M[1]:void 0,done:!0}}([M,G])}}},p=this&&this.__importDefault||function(V){return V&&V.__esModule?V:{default:V}};Object.defineProperty(ae,"__esModule",{value:!0}),ae.getGameSystemClass=void 0;var u=p(Y(5904)),k=Y(3583),v=Y(3693),D=p(Y(4682)),_=p(Y(3034));function F(V){var L;return(L=function(H){function U(se,ue){return H.call(this,se,null!=ue?ue:V.$new(se))||this}return a(U,H),U.eval=function(se){return v.parseResult(V.$eval(se))},U}(u.default)).ID=V.$const_get("ID"),L.NAME=V.$const_get("NAME"),L.SORT_KEY=V.$const_get("SORT_KEY"),L.HELP_MESSAGE=V.$const_get("HELP_MESSAGE"),L.COMMAND_PATTERN=V.$command_pattern(),L}ae.getGameSystemClass=F;var oe=function(){function V(){}return V.prototype.getGameSystemIdByName=function(L){var H,U=null===(H=this.listAvailableGameSystems().find(function(se){return se.name===L}))||void 0===H?void 0:H.id;if(!U)throw new Error("GameSystem named "+L+" does not exists");return U},V.prototype.getGameSystemInfo=function(L){var H=this.listAvailableGameSystems().find(function(U){return U.id===L});if(!H)throw new Error("GameSystem is not found");return H},V.prototype.getGameSystemClass=function(L){var H=this.listLoadedGameSystems().find(function(U){return U.ID===L});if(!H)throw new Error("GameSystem "+L+" is not loaded");return H},V.prototype.getI18nInfos=function(L){var H=L.replace(/_[^0-9].*$/g,""),U=this.listAvailabletI18nInfoList().find(function(J){return J.baseClassName===H||J.baseClassName===L}),se=U?[U]:[],ue=this.listAvailableGameSystems().find(function(J){return J.className===L});return ue?Array.from(new Set(this.getI18nInfos(ue.superClassName).concat(se))):se},V.prototype.listLoadedGameSystems=function(){var L,H,U;return null!==(U=null===(H=null===(L=k.BCDice.GameSystem)||void 0===L?void 0:L.$constants())||void 0===H?void 0:H.map(function(se){return F(k.BCDice.GameSystem[se])}))&&void 0!==U?U:[]},V.prototype.listAvailableGameSystems=function(){return D.default.gameSystems},V.prototype.listAvailabletI18nInfoList=function(){return _.default.i18nList},V.prototype.dynamicLoad=function(L){var H;return y(this,void 0,void 0,function(){var U,se,ue,J,K,ee,M,G,z,N,P,g,b;return w(this,function(C){switch(C.label){case 0:if(U=this.getGameSystemInfo(L),!(se=null!==(H=null==U?void 0:U.className)&&void 0!==H?H:L).match(/^[A-Z]\w*$/))throw new Error("Invalid id");ue=this.getI18nInfos(se),J=0,K=ue,C.label=1;case 1:if(!(J<K.length))return[3,6];M=(ee=K[J]).locales.filter(function(h){return h===U.locale||h===k.I18n.$default_locale()}),G=0,z=M,C.label=2;case 2:return G<z.length?(g=(P=JSON).stringify,[4,this.dynamicImportI18n(ee.baseClassName,z[G])]):[3,5];case 3:N=g.apply(P,[C.sent()]),k.I18n.$load_translation(N),C.label=4;case 4:return G++,[3,2];case 5:return J++,[3,1];case 6:return[4,this.dynamicImport(se)];case 7:if(C.sent(),!(b=k.BCDice.GameSystem.$const_get(se)))throw new Error("Failed to load game system");return[2,F(b)]}})})},V.prototype.dynamicImportI18n=function(L,H){throw new Error("Not implemented")},V.prototype.dynamicImport=function(L){throw new Error("Not implemented")},V}();ae.default=oe},3693:function(E,ae,Y){"use strict";var a=this&&this.__assign||function(){return a=Object.assign||function(u){for(var k,v=1,D=arguments.length;v<D;v++)for(var _ in k=arguments[v])Object.prototype.hasOwnProperty.call(k,_)&&(u[_]=k[_]);return u},a.apply(this,arguments)},y=this&&this.__rest||function(u,k){var v={};for(var D in u)Object.prototype.hasOwnProperty.call(u,D)&&k.indexOf(D)<0&&(v[D]=u[D]);if(null!=u&&"function"==typeof Object.getOwnPropertySymbols){var _=0;for(D=Object.getOwnPropertySymbols(u);_<D.length;_++)k.indexOf(D[_])<0&&Object.prototype.propertyIsEnumerable.call(u,D[_])&&(v[D[_]]=u[D[_]])}return v};Object.defineProperty(ae,"__esModule",{value:!0}),ae.parseResult=void 0;var w=Y(3583);ae.parseResult=function p(u){if(u===w.Opal.nil)return null;var k=u.detailed_rands,v=y(u,["detailed_rands"]);return a(a({},v),{detailedRands:k.map(function(D){return D.$to_n()})})}},7585:function(E,ae,Y){var a;E.exports=(a=a||function(y,w){var p;if("undefined"!=typeof window&&window.crypto&&(p=window.crypto),"undefined"!=typeof self&&self.crypto&&(p=self.crypto),"undefined"!=typeof globalThis&&globalThis.crypto&&(p=globalThis.crypto),!p&&"undefined"!=typeof window&&window.msCrypto&&(p=window.msCrypto),!p&&"undefined"!=typeof global&&global.crypto&&(p=global.crypto),!p)try{p=Y(2480)}catch(J){}var u=function(){if(p){if("function"==typeof p.getRandomValues)try{return p.getRandomValues(new Uint32Array(1))[0]}catch(J){}if("function"==typeof p.randomBytes)try{return p.randomBytes(4).readInt32LE()}catch(J){}}throw new Error("Native crypto module could not be used to get secure random number.")},k=Object.create||function(){function J(){}return function(K){var ee;return J.prototype=K,ee=new J,J.prototype=null,ee}}(),v={},D=v.lib={},_=D.Base={extend:function(J){var K=k(this);return J&&K.mixIn(J),(!K.hasOwnProperty("init")||this.init===K.init)&&(K.init=function(){K.$super.init.apply(this,arguments)}),K.init.prototype=K,K.$super=this,K},create:function(){var J=this.extend();return J.init.apply(J,arguments),J},init:function(){},mixIn:function(J){for(var K in J)J.hasOwnProperty(K)&&(this[K]=J[K]);J.hasOwnProperty("toString")&&(this.toString=J.toString)},clone:function(){return this.init.prototype.extend(this)}},F=D.WordArray=_.extend({init:function(J,K){J=this.words=J||[],this.sigBytes=null!=K?K:4*J.length},toString:function(J){return(J||V).stringify(this)},concat:function(J){var K=this.words,ee=J.words,M=this.sigBytes,G=J.sigBytes;if(this.clamp(),M%4)for(var z=0;z<G;z++)K[M+z>>>2]|=(ee[z>>>2]>>>24-z%4*8&255)<<24-(M+z)%4*8;else for(var N=0;N<G;N+=4)K[M+N>>>2]=ee[N>>>2];return this.sigBytes+=G,this},clamp:function(){var J=this.words,K=this.sigBytes;J[K>>>2]&=4294967295<<32-K%4*8,J.length=y.ceil(K/4)},clone:function(){var J=_.clone.call(this);return J.words=this.words.slice(0),J},random:function(J){for(var K=[],ee=0;ee<J;ee+=4)K.push(u());return new F.init(K,J)}}),oe=v.enc={},V=oe.Hex={stringify:function(J){for(var K=J.words,ee=J.sigBytes,M=[],G=0;G<ee;G++){var z=K[G>>>2]>>>24-G%4*8&255;M.push((z>>>4).toString(16)),M.push((15&z).toString(16))}return M.join("")},parse:function(J){for(var K=J.length,ee=[],M=0;M<K;M+=2)ee[M>>>3]|=parseInt(J.substr(M,2),16)<<24-M%8*4;return new F.init(ee,K/2)}},L=oe.Latin1={stringify:function(J){for(var K=J.words,ee=J.sigBytes,M=[],G=0;G<ee;G++)M.push(String.fromCharCode(K[G>>>2]>>>24-G%4*8&255));return M.join("")},parse:function(J){for(var K=J.length,ee=[],M=0;M<K;M++)ee[M>>>2]|=(255&J.charCodeAt(M))<<24-M%4*8;return new F.init(ee,K)}},H=oe.Utf8={stringify:function(J){try{return decodeURIComponent(escape(L.stringify(J)))}catch(K){throw new Error("Malformed UTF-8 data")}},parse:function(J){return L.parse(unescape(encodeURIComponent(J)))}},U=D.BufferedBlockAlgorithm=_.extend({reset:function(){this._data=new F.init,this._nDataBytes=0},_append:function(J){"string"==typeof J&&(J=H.parse(J)),this._data.concat(J),this._nDataBytes+=J.sigBytes},_process:function(J){var K,ee=this._data,M=ee.words,G=ee.sigBytes,z=this.blockSize,N=G/(4*z),P=(N=J?y.ceil(N):y.max((0|N)-this._minBufferSize,0))*z,g=y.min(4*P,G);if(P){for(var b=0;b<P;b+=z)this._doProcessBlock(M,b);K=M.splice(0,P),ee.sigBytes-=g}return new F.init(K,g)},clone:function(){var J=_.clone.call(this);return J._data=this._data.clone(),J},_minBufferSize:0}),ue=(D.Hasher=U.extend({cfg:_.extend(),init:function(J){this.cfg=this.cfg.extend(J),this.reset()},reset:function(){U.reset.call(this),this._doReset()},update:function(J){return this._append(J),this._process(),this},finalize:function(J){return J&&this._append(J),this._doFinalize()},blockSize:16,_createHelper:function(J){return function(K,ee){return new J.init(ee).finalize(K)}},_createHmacHelper:function(J){return function(K,ee){return new ue.HMAC.init(J,ee).finalize(K)}}}),v.algo={});return v}(Math),a)},7412:function(E,ae,Y){var a;E.exports=(a=Y(7585),function(){if("function"==typeof ArrayBuffer){var p=a.lib.WordArray,u=p.init,k=p.init=function(v){if(v instanceof ArrayBuffer&&(v=new Uint8Array(v)),(v instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&v instanceof Uint8ClampedArray||v instanceof Int16Array||v instanceof Uint16Array||v instanceof Int32Array||v instanceof Uint32Array||v instanceof Float32Array||v instanceof Float64Array)&&(v=new Uint8Array(v.buffer,v.byteOffset,v.byteLength)),v instanceof Uint8Array){for(var D=v.byteLength,_=[],F=0;F<D;F++)_[F>>>2]|=v[F]<<24-F%4*8;u.call(this,_,D)}else u.apply(this,arguments)};k.prototype=p}}(),a.lib.WordArray)},1817:function(E,ae,Y){var a;E.exports=(a=Y(7585),function(y){var w=a,p=w.lib,u=p.WordArray,k=p.Hasher,v=w.algo,D=[],_=[];!function(){function V(se){for(var ue=y.sqrt(se),J=2;J<=ue;J++)if(!(se%J))return!1;return!0}function L(se){return 4294967296*(se-(0|se))|0}for(var H=2,U=0;U<64;)V(H)&&(U<8&&(D[U]=L(y.pow(H,.5))),_[U]=L(y.pow(H,1/3)),U++),H++}();var F=[],oe=v.SHA256=k.extend({_doReset:function(){this._hash=new u.init(D.slice(0))},_doProcessBlock:function(V,L){for(var H=this._hash.words,U=H[0],se=H[1],ue=H[2],J=H[3],K=H[4],ee=H[5],M=H[6],G=H[7],z=0;z<64;z++){if(z<16)F[z]=0|V[L+z];else{var A=F[z-15],P=F[z-2];F[z]=((A<<25|A>>>7)^(A<<14|A>>>18)^A>>>3)+F[z-7]+((P<<15|P>>>17)^(P<<13|P>>>19)^P>>>10)+F[z-16]}var C=U&se^U&ue^se&ue,l=G+((K<<26|K>>>6)^(K<<21|K>>>11)^(K<<7|K>>>25))+(K&ee^~K&M)+_[z]+F[z];G=M,M=ee,ee=K,K=J+l|0,J=ue,ue=se,se=U,U=l+(((U<<30|U>>>2)^(U<<19|U>>>13)^(U<<10|U>>>22))+C)|0}H[0]=H[0]+U|0,H[1]=H[1]+se|0,H[2]=H[2]+ue|0,H[3]=H[3]+J|0,H[4]=H[4]+K|0,H[5]=H[5]+ee|0,H[6]=H[6]+M|0,H[7]=H[7]+G|0},_doFinalize:function(){var V=this._data,L=V.words,H=8*this._nDataBytes,U=8*V.sigBytes;return L[U>>>5]|=128<<24-U%32,L[14+(U+64>>>9<<4)]=y.floor(H/4294967296),L[15+(U+64>>>9<<4)]=H,V.sigBytes=4*L.length,this._process(),this._hash},clone:function(){var V=k.clone.call(this);return V._hash=this._hash.clone(),V}});w.SHA256=k._createHelper(oe),w.HmacSHA256=k._createHmacHelper(oe)}(Math),a.SHA256)},6654:E=>{!function(Y){E.exports=Y;var a="listeners",y={on:function p(_,F){return D(this,_).push(F),this},once:function u(_,F){var oe=this;return V.originalListener=F,D(oe,_).push(V),oe;function V(){k.call(oe,_,V),F.apply(this,arguments)}},off:k,emit:function v(_,F){var oe=this,V=D(oe,_,!0);if(!V)return!1;var L=arguments.length;if(1===L)V.forEach(U);else if(2===L)V.forEach(se);else{var H=Array.prototype.slice.call(arguments,1);V.forEach(ue)}return!!V.length;function U(J){J.call(oe)}function se(J){J.call(oe,F)}function ue(J){J.apply(oe,H)}}};function w(_){for(var F in y)_[F]=y[F];return _}function k(_,F){var V,oe=this;if(arguments.length){if(F){if(V=D(oe,_,!0)){if(!(V=V.filter(L)).length)return k.call(oe,_);oe[a][_]=V}}else if((V=oe[a])&&(delete V[_],!Object.keys(V).length))return k.call(oe)}else delete oe[a];return oe;function L(H){return H!==F&&H.originalListener!==F}}function D(_,F,oe){if(!oe||_[a]){var V=_[a]||(_[a]={});return V[F]||(V[F]=[])}}w(Y.prototype),Y.mixin=w}(function ae(){if(!(this instanceof ae))return new ae})},9069:E=>{"use strict";var a,ae="object"==typeof Reflect?Reflect:null,Y=ae&&"function"==typeof ae.apply?ae.apply:function(ee,M,G){return Function.prototype.apply.call(ee,M,G)};a=ae&&"function"==typeof ae.ownKeys?ae.ownKeys:Object.getOwnPropertySymbols?function(ee){return Object.getOwnPropertyNames(ee).concat(Object.getOwnPropertySymbols(ee))}:function(ee){return Object.getOwnPropertyNames(ee)};var w=Number.isNaN||function(ee){return ee!=ee};function p(){p.init.call(this)}E.exports=p,E.exports.once=function se(K,ee){return new Promise(function(M,G){function z(N){K.removeListener(ee,A),G(N)}function A(){"function"==typeof K.removeListener&&K.removeListener("error",z),M([].slice.call(arguments))}J(K,ee,A,{once:!0}),"error"!==ee&&function ue(K,ee,M){"function"==typeof K.on&&J(K,"error",ee,M)}(K,z,{once:!0})})},p.EventEmitter=p,p.prototype._events=void 0,p.prototype._eventsCount=0,p.prototype._maxListeners=void 0;var u=10;function k(K){if("function"!=typeof K)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof K)}function v(K){return void 0===K._maxListeners?p.defaultMaxListeners:K._maxListeners}function D(K,ee,M,G){var z,A,N;if(k(M),void 0===(A=K._events)?(A=K._events=Object.create(null),K._eventsCount=0):(void 0!==A.newListener&&(K.emit("newListener",ee,M.listener?M.listener:M),A=K._events),N=A[ee]),void 0===N)N=A[ee]=M,++K._eventsCount;else if("function"==typeof N?N=A[ee]=G?[M,N]:[N,M]:G?N.unshift(M):N.push(M),(z=v(K))>0&&N.length>z&&!N.warned){N.warned=!0;var P=new Error("Possible EventEmitter memory leak detected. "+N.length+" "+String(ee)+" listeners added. Use emitter.setMaxListeners() to increase limit");P.name="MaxListenersExceededWarning",P.emitter=K,P.type=ee,P.count=N.length,function y(K){console&&console.warn&&console.warn(K)}(P)}return K}function _(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function F(K,ee,M){var G={fired:!1,wrapFn:void 0,target:K,type:ee,listener:M},z=_.bind(G);return z.listener=M,G.wrapFn=z,z}function oe(K,ee,M){var G=K._events;if(void 0===G)return[];var z=G[ee];return void 0===z?[]:"function"==typeof z?M?[z.listener||z]:[z]:M?function U(K){for(var ee=new Array(K.length),M=0;M<ee.length;++M)ee[M]=K[M].listener||K[M];return ee}(z):L(z,z.length)}function V(K){var ee=this._events;if(void 0!==ee){var M=ee[K];if("function"==typeof M)return 1;if(void 0!==M)return M.length}return 0}function L(K,ee){for(var M=new Array(ee),G=0;G<ee;++G)M[G]=K[G];return M}function J(K,ee,M,G){if("function"==typeof K.on)G.once?K.once(ee,M):K.on(ee,M);else{if("function"!=typeof K.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof K);K.addEventListener(ee,function z(A){G.once&&K.removeEventListener(ee,z),M(A)})}}Object.defineProperty(p,"defaultMaxListeners",{enumerable:!0,get:function(){return u},set:function(K){if("number"!=typeof K||K<0||w(K))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+K+".");u=K}}),p.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},p.prototype.setMaxListeners=function(ee){if("number"!=typeof ee||ee<0||w(ee))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+ee+".");return this._maxListeners=ee,this},p.prototype.getMaxListeners=function(){return v(this)},p.prototype.emit=function(ee){for(var M=[],G=1;G<arguments.length;G++)M.push(arguments[G]);var z="error"===ee,A=this._events;if(void 0!==A)z=z&&void 0===A.error;else if(!z)return!1;if(z){var N;if(M.length>0&&(N=M[0]),N instanceof Error)throw N;var P=new Error("Unhandled error."+(N?" ("+N.message+")":""));throw P.context=N,P}var g=A[ee];if(void 0===g)return!1;if("function"==typeof g)Y(g,this,M);else{var b=g.length,C=L(g,b);for(G=0;G<b;++G)Y(C[G],this,M)}return!0},p.prototype.on=p.prototype.addListener=function(ee,M){return D(this,ee,M,!1)},p.prototype.prependListener=function(ee,M){return D(this,ee,M,!0)},p.prototype.once=function(ee,M){return k(M),this.on(ee,F(this,ee,M)),this},p.prototype.prependOnceListener=function(ee,M){return k(M),this.prependListener(ee,F(this,ee,M)),this},p.prototype.off=p.prototype.removeListener=function(ee,M){var G,z,A,N,P;if(k(M),void 0===(z=this._events))return this;if(void 0===(G=z[ee]))return this;if(G===M||G.listener===M)0==--this._eventsCount?this._events=Object.create(null):(delete z[ee],z.removeListener&&this.emit("removeListener",ee,G.listener||M));else if("function"!=typeof G){for(A=-1,N=G.length-1;N>=0;N--)if(G[N]===M||G[N].listener===M){P=G[N].listener,A=N;break}if(A<0)return this;0===A?G.shift():function H(K,ee){for(;ee+1<K.length;ee++)K[ee]=K[ee+1];K.pop()}(G,A),1===G.length&&(z[ee]=G[0]),void 0!==z.removeListener&&this.emit("removeListener",ee,P||M)}return this},p.prototype.removeAllListeners=function(ee){var M,G,z;if(void 0===(G=this._events))return this;if(void 0===G.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==G[ee]&&(0==--this._eventsCount?this._events=Object.create(null):delete G[ee]),this;if(0===arguments.length){var N,A=Object.keys(G);for(z=0;z<A.length;++z)"removeListener"!==(N=A[z])&&this.removeAllListeners(N);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(M=G[ee]))this.removeListener(ee,M);else if(void 0!==M)for(z=M.length-1;z>=0;z--)this.removeListener(ee,M[z]);return this},p.prototype.listeners=function(ee){return oe(this,ee,!0)},p.prototype.rawListeners=function(ee){return oe(this,ee,!1)},p.listenerCount=function(K,ee){return"function"==typeof K.listenerCount?K.listenerCount(ee):V.call(K,ee)},p.prototype.listenerCount=V,p.prototype.eventNames=function(){return this._eventsCount>0?a(this._events):[]}},4327:function(E,ae){var y;void 0!==(y=function(){"use strict";function p(F,oe,V){var L=new XMLHttpRequest;L.open("GET",F),L.responseType="blob",L.onload=function(){_(L.response,oe,V)},L.onerror=function(){console.error("could not download file")},L.send()}function u(F){var oe=new XMLHttpRequest;oe.open("HEAD",F,!1);try{oe.send()}catch(V){}return 200<=oe.status&&299>=oe.status}function k(F){try{F.dispatchEvent(new MouseEvent("click"))}catch(V){var oe=document.createEvent("MouseEvents");oe.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),F.dispatchEvent(oe)}}var v="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,D=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=v.saveAs||("object"!=typeof window||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!D?function(F,oe,V){var L=v.URL||v.webkitURL,H=document.createElement("a");H.download=oe=oe||F.name||"download",H.rel="noopener","string"==typeof F?(H.href=F,H.origin===location.origin?k(H):u(H.href)?p(F,oe,V):k(H,H.target="_blank")):(H.href=L.createObjectURL(F),setTimeout(function(){L.revokeObjectURL(H.href)},4e4),setTimeout(function(){k(H)},0))}:"msSaveOrOpenBlob"in navigator?function(F,oe,V){if(oe=oe||F.name||"download","string"!=typeof F)navigator.msSaveOrOpenBlob(function w(F,oe){return void 0===oe?oe={autoBom:!1}:"object"!=typeof oe&&(console.warn("Deprecated: Expected third argument to be a object"),oe={autoBom:!oe}),oe.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(F.type)?new Blob(["\ufeff",F],{type:F.type}):F}(F,V),oe);else if(u(F))p(F,oe,V);else{var L=document.createElement("a");L.href=F,L.target="_blank",setTimeout(function(){k(L)})}}:function(F,oe,V,L){if((L=L||open("","_blank"))&&(L.document.title=L.document.body.innerText="downloading..."),"string"==typeof F)return p(F,oe,V);var H="application/octet-stream"===F.type,U=/constructor/i.test(v.HTMLElement)||v.safari,se=/CriOS\/[\d]+/.test(navigator.userAgent);if((se||H&&U||D)&&"undefined"!=typeof FileReader){var ue=new FileReader;ue.onloadend=function(){var ee=ue.result;ee=se?ee:ee.replace(/^data:[^;]*;/,"data:attachment/file;"),L?L.location.href=ee:location=ee,L=null},ue.readAsDataURL(F)}else{var J=v.URL||v.webkitURL,K=J.createObjectURL(F);L?L.location=K:location.href=K,L=null,setTimeout(function(){J.revokeObjectURL(K)},4e4)}});v.saveAs=_.saveAs=_,E.exports=_}.apply(ae,[]))&&(E.exports=y)},5386:(E,ae,Y)=>{var a;!function(y,w,p,u){"use strict";var se,k=["","webkit","Moz","MS","ms","o"],v=w.createElement("div"),_=Math.round,F=Math.abs,oe=Date.now;function V(Se,Ne,ze){return setTimeout(ee(Se,ze),Ne)}function L(Se,Ne,ze){return!!Array.isArray(Se)&&(H(Se,ze[Ne],ze),!0)}function H(Se,Ne,ze){var Ke;if(Se)if(Se.forEach)Se.forEach(Ne,ze);else if(Se.length!==u)for(Ke=0;Ke<Se.length;)Ne.call(ze,Se[Ke],Ke,Se),Ke++;else for(Ke in Se)Se.hasOwnProperty(Ke)&&Ne.call(ze,Se[Ke],Ke,Se)}function U(Se,Ne,ze){var Ke="DEPRECATED METHOD: "+Ne+"\n"+ze+" AT \n";return function(){var _t=new Error("get-stack-trace"),St=_t&&_t.stack?_t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",Cn=y.console&&(y.console.warn||y.console.log);return Cn&&Cn.call(y.console,Ke,St),Se.apply(this,arguments)}}se="function"!=typeof Object.assign?function(Ne){if(Ne===u||null===Ne)throw new TypeError("Cannot convert undefined or null to object");for(var ze=Object(Ne),Ke=1;Ke<arguments.length;Ke++){var _t=arguments[Ke];if(_t!==u&&null!==_t)for(var St in _t)_t.hasOwnProperty(St)&&(ze[St]=_t[St])}return ze}:Object.assign;var ue=U(function(Ne,ze,Ke){for(var _t=Object.keys(ze),St=0;St<_t.length;)(!Ke||Ke&&Ne[_t[St]]===u)&&(Ne[_t[St]]=ze[_t[St]]),St++;return Ne},"extend","Use `assign`."),J=U(function(Ne,ze){return ue(Ne,ze,!0)},"merge","Use `assign`.");function K(Se,Ne,ze){var _t,Ke=Ne.prototype;(_t=Se.prototype=Object.create(Ke)).constructor=Se,_t._super=Ke,ze&&se(_t,ze)}function ee(Se,Ne){return function(){return Se.apply(Ne,arguments)}}function M(Se,Ne){return"function"==typeof Se?Se.apply(Ne&&Ne[0]||u,Ne):Se}function G(Se,Ne){return Se===u?Ne:Se}function z(Se,Ne,ze){H(g(Ne),function(Ke){Se.addEventListener(Ke,ze,!1)})}function A(Se,Ne,ze){H(g(Ne),function(Ke){Se.removeEventListener(Ke,ze,!1)})}function N(Se,Ne){for(;Se;){if(Se==Ne)return!0;Se=Se.parentNode}return!1}function P(Se,Ne){return Se.indexOf(Ne)>-1}function g(Se){return Se.trim().split(/\s+/g)}function b(Se,Ne,ze){if(Se.indexOf&&!ze)return Se.indexOf(Ne);for(var Ke=0;Ke<Se.length;){if(ze&&Se[Ke][ze]==Ne||!ze&&Se[Ke]===Ne)return Ke;Ke++}return-1}function C(Se){return Array.prototype.slice.call(Se,0)}function h(Se,Ne,ze){for(var Ke=[],_t=[],St=0;St<Se.length;){var Cn=Ne?Se[St][Ne]:Se[St];b(_t,Cn)<0&&Ke.push(Se[St]),_t[St]=Cn,St++}return ze&&(Ke=Ne?Ke.sort(function(Li,dr){return Li[Ne]>dr[Ne]}):Ke.sort()),Ke}function c(Se,Ne){for(var ze,Ke,_t=Ne[0].toUpperCase()+Ne.slice(1),St=0;St<k.length;){if((Ke=(ze=k[St])?ze+_t:Ne)in Se)return Ke;St++}return u}var l=1;function m(Se){var Ne=Se.ownerDocument||Se;return Ne.defaultView||Ne.parentWindow||y}var S="ontouchstart"in y,Z=c(y,"PointerEvent")!==u,le=S&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),ye="touch",R="mouse",Te=["x","y"],De=["clientX","clientY"];function Me(Se,Ne){var ze=this;this.manager=Se,this.callback=Ne,this.element=Se.element,this.target=Se.options.inputTarget,this.domHandler=function(Ke){M(Se.options.enable,[Se])&&ze.handler(Ke)},this.init()}function Ve(Se,Ne,ze){var Ke=ze.pointers.length,_t=ze.changedPointers.length,St=1&Ne&&Ke-_t==0,Cn=12&Ne&&Ke-_t==0;ze.isFirst=!!St,ze.isFinal=!!Cn,St&&(Se.session={}),ze.eventType=Ne,function Qe(Se,Ne){var ze=Se.session,Ke=Ne.pointers,_t=Ke.length;ze.firstInput||(ze.firstInput=Pt(Ne)),_t>1&&!ze.firstMultiple?ze.firstMultiple=Pt(Ne):1===_t&&(ze.firstMultiple=!1);var St=ze.firstInput,Cn=ze.firstMultiple,Bi=Cn?Cn.center:St.center,Li=Ne.center=gt(Ke);Ne.timeStamp=oe(),Ne.deltaTime=Ne.timeStamp-St.timeStamp,Ne.angle=zr(Bi,Li),Ne.distance=Lo(Bi,Li),function Mt(Se,Ne){var ze=Ne.center,Ke=Se.offsetDelta||{},_t=Se.prevDelta||{},St=Se.prevInput||{};(1===Ne.eventType||4===St.eventType)&&(_t=Se.prevDelta={x:St.deltaX||0,y:St.deltaY||0},Ke=Se.offsetDelta={x:ze.x,y:ze.y}),Ne.deltaX=_t.x+(ze.x-Ke.x),Ne.deltaY=_t.y+(ze.y-Ke.y)}(ze,Ne),Ne.offsetDirection=rr(Ne.deltaX,Ne.deltaY);var dr=mt(Ne.deltaTime,Ne.deltaX,Ne.deltaY);Ne.overallVelocityX=dr.x,Ne.overallVelocityY=dr.y,Ne.overallVelocity=F(dr.x)>F(dr.y)?dr.x:dr.y,Ne.scale=Cn?function df(Se,Ne){return Lo(Ne[0],Ne[1],De)/Lo(Se[0],Se[1],De)}(Cn.pointers,Ke):1,Ne.rotation=Cn?function yu(Se,Ne){return zr(Ne[1],Ne[0],De)+zr(Se[1],Se[0],De)}(Cn.pointers,Ke):0,Ne.maxPointers=ze.prevInput?Ne.pointers.length>ze.prevInput.maxPointers?Ne.pointers.length:ze.prevInput.maxPointers:Ne.pointers.length,function Bt(Se,Ne){var _t,St,Cn,Bi,ze=Se.lastInterval||Ne,Ke=Ne.timeStamp-ze.timeStamp;if(8!=Ne.eventType&&(Ke>25||ze.velocity===u)){var Li=Ne.deltaX-ze.deltaX,dr=Ne.deltaY-ze.deltaY,bs=mt(Ke,Li,dr);St=bs.x,Cn=bs.y,_t=F(bs.x)>F(bs.y)?bs.x:bs.y,Bi=rr(Li,dr),Se.lastInterval=Ne}else _t=ze.velocity,St=ze.velocityX,Cn=ze.velocityY,Bi=ze.direction;Ne.velocity=_t,Ne.velocityX=St,Ne.velocityY=Cn,Ne.direction=Bi}(ze,Ne);var bs=Se.element;N(Ne.srcEvent.target,bs)&&(bs=Ne.srcEvent.target),Ne.target=bs}(Se,ze),Se.emit("hammer.input",ze),Se.recognize(ze),Se.session.prevInput=ze}function Pt(Se){for(var Ne=[],ze=0;ze<Se.pointers.length;)Ne[ze]={clientX:_(Se.pointers[ze].clientX),clientY:_(Se.pointers[ze].clientY)},ze++;return{timeStamp:oe(),pointers:Ne,center:gt(Ne),deltaX:Se.deltaX,deltaY:Se.deltaY}}function gt(Se){var Ne=Se.length;if(1===Ne)return{x:_(Se[0].clientX),y:_(Se[0].clientY)};for(var ze=0,Ke=0,_t=0;_t<Ne;)ze+=Se[_t].clientX,Ke+=Se[_t].clientY,_t++;return{x:_(ze/Ne),y:_(Ke/Ne)}}function mt(Se,Ne,ze){return{x:Ne/Se||0,y:ze/Se||0}}function rr(Se,Ne){return Se===Ne?1:F(Se)>=F(Ne)?Se<0?2:4:Ne<0?8:16}function Lo(Se,Ne,ze){ze||(ze=Te);var Ke=Ne[ze[0]]-Se[ze[0]],_t=Ne[ze[1]]-Se[ze[1]];return Math.sqrt(Ke*Ke+_t*_t)}function zr(Se,Ne,ze){return ze||(ze=Te),180*Math.atan2(Ne[ze[1]]-Se[ze[1]],Ne[ze[0]]-Se[ze[0]])/Math.PI}Me.prototype={handler:function(){},init:function(){this.evEl&&z(this.element,this.evEl,this.domHandler),this.evTarget&&z(this.target,this.evTarget,this.domHandler),this.evWin&&z(m(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&A(this.element,this.evEl,this.domHandler),this.evTarget&&A(this.target,this.evTarget,this.domHandler),this.evWin&&A(m(this.element),this.evWin,this.domHandler)}};var Qa={mousedown:1,mousemove:2,mouseup:4},Zl="mousedown",Ja="mousemove mouseup";function ts(){this.evEl=Zl,this.evWin=Ja,this.pressed=!1,Me.apply(this,arguments)}K(ts,Me,{handler:function(Ne){var ze=Qa[Ne.type];1&ze&&0===Ne.button&&(this.pressed=!0),2&ze&&1!==Ne.which&&(ze=4),this.pressed&&(4&ze&&(this.pressed=!1),this.callback(this.manager,ze,{pointers:[Ne],changedPointers:[Ne],pointerType:R,srcEvent:Ne}))}});var zo={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},fg={2:ye,3:"pen",4:R,5:"kinect"},Cu="pointerdown",xu="pointermove pointerup pointercancel";function Xl(){this.evEl=Cu,this.evWin=xu,Me.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}y.MSPointerEvent&&!y.PointerEvent&&(Cu="MSPointerDown",xu="MSPointerMove MSPointerUp MSPointerCancel"),K(Xl,Me,{handler:function(Ne){var ze=this.store,Ke=!1,_t=Ne.type.toLowerCase().replace("ms",""),St=zo[_t],Cn=fg[Ne.pointerType]||Ne.pointerType,Bi=Cn==ye,Li=b(ze,Ne.pointerId,"pointerId");1&St&&(0===Ne.button||Bi)?Li<0&&(ze.push(Ne),Li=ze.length-1):12&St&&(Ke=!0),!(Li<0)&&(ze[Li]=Ne,this.callback(this.manager,St,{pointers:ze,changedPointers:[Ne],pointerType:Cn,srcEvent:Ne}),Ke&&ze.splice(Li,1))}});var ff={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ur="touchstart",hg="touchstart touchmove touchend touchcancel";function hf(){this.evTarget=ur,this.evWin=hg,this.started=!1,Me.apply(this,arguments)}function pg(Se,Ne){var ze=C(Se.touches),Ke=C(Se.changedTouches);return 12&Ne&&(ze=h(ze.concat(Ke),"identifier",!0)),[ze,Ke]}K(hf,Me,{handler:function(Ne){var ze=ff[Ne.type];if(1===ze&&(this.started=!0),this.started){var Ke=pg.call(this,Ne,ze);12&ze&&Ke[0].length-Ke[1].length==0&&(this.started=!1),this.callback(this.manager,ze,{pointers:Ke[0],changedPointers:Ke[1],pointerType:ye,srcEvent:Ne})}}});var gg={touchstart:1,touchmove:2,touchend:4,touchcancel:8},pf="touchstart touchmove touchend touchcancel";function Ql(){this.evTarget=pf,this.targetIds={},Me.apply(this,arguments)}function mg(Se,Ne){var ze=C(Se.touches),Ke=this.targetIds;if(3&Ne&&1===ze.length)return Ke[ze[0].identifier]=!0,[ze,ze];var _t,St,Cn=C(Se.changedTouches),Bi=[],Li=this.target;if(St=ze.filter(function(dr){return N(dr.target,Li)}),1===Ne)for(_t=0;_t<St.length;)Ke[St[_t].identifier]=!0,_t++;for(_t=0;_t<Cn.length;)Ke[Cn[_t].identifier]&&Bi.push(Cn[_t]),12&Ne&&delete Ke[Cn[_t].identifier],_t++;return Bi.length?[h(St.concat(Bi),"identifier",!0),Bi]:void 0}function jo(){Me.apply(this,arguments);var Se=ee(this.handler,this);this.touch=new Ql(this.manager,Se),this.mouse=new ts(this.manager,Se),this.primaryTouch=null,this.lastTouches=[]}function mf(Se,Ne){1&Se?(this.primaryTouch=Ne.changedPointers[0].identifier,Jl.call(this,Ne)):12&Se&&Jl.call(this,Ne)}function Jl(Se){var Ne=Se.changedPointers[0];if(Ne.identifier===this.primaryTouch){var ze={x:Ne.clientX,y:Ne.clientY};this.lastTouches.push(ze);var Ke=this.lastTouches;setTimeout(function(){var St=Ke.indexOf(ze);St>-1&&Ke.splice(St,1)},2500)}}function b1(Se){for(var Ne=Se.srcEvent.clientX,ze=Se.srcEvent.clientY,Ke=0;Ke<this.lastTouches.length;Ke++){var _t=this.lastTouches[Ke],St=Math.abs(Ne-_t.x),Cn=Math.abs(ze-_t.y);if(St<=25&&Cn<=25)return!0}return!1}K(Ql,Me,{handler:function(Ne){var ze=gg[Ne.type],Ke=mg.call(this,Ne,ze);!Ke||this.callback(this.manager,ze,{pointers:Ke[0],changedPointers:Ke[1],pointerType:ye,srcEvent:Ne})}}),K(jo,Me,{handler:function(Ne,ze,Ke){var St=Ke.pointerType==R;if(!(St&&Ke.sourceCapabilities&&Ke.sourceCapabilities.firesTouchEvents)){if(Ke.pointerType==ye)mf.call(this,ze,Ke);else if(St&&b1.call(this,Ke))return;this.callback(Ne,ze,Ke)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var _f=c(v.style,"touchAction"),wu=_f!==u,ec="compute",Uo="manipulation",Ho="none",ca="pan-x",ua="pan-y",tc=function $g(){if(!wu)return!1;var Se={},Ne=y.CSS&&y.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(ze){Se[ze]=!Ne||y.CSS.supports("touch-action",ze)}),Se}();function Eu(Se,Ne){this.manager=Se,this.set(Ne)}function wn(Se){this.options=se({},this.defaults,Se||{}),this.id=function f(){return l++}(),this.manager=null,this.options.enable=G(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function nc(Se){return 16&Se?"cancel":8&Se?"end":4&Se?"move":2&Se?"start":""}function Rn(Se){return 16==Se?"down":8==Se?"up":2==Se?"left":4==Se?"right":""}function fa(Se,Ne){var ze=Ne.manager;return ze?ze.get(Se):Se}function ns(){wn.apply(this,arguments)}function zn(){ns.apply(this,arguments),this.pX=null,this.pY=null}function nn(){ns.apply(this,arguments)}function ic(){wn.apply(this,arguments),this._timer=null,this._input=null}function $f(){ns.apply(this,arguments)}function Tt(){ns.apply(this,arguments)}function ha(){wn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Ut(Se,Ne){return(Ne=Ne||{}).recognizers=G(Ne.recognizers,Ut.defaults.preset),new bf(Se,Ne)}function bf(Se,Ne){this.options=se({},Ut.defaults,Ne||{}),this.options.inputTarget=this.options.inputTarget||Se,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=Se,this.input=function Pe(Se){return new(Se.options.inputClass||(Z?Xl:le?Ql:S?jo:ts))(Se,Ve)}(this),this.touchAction=new Eu(this,this.options.touchAction),vg(this,!0),H(this.options.recognizers,function(ze){var Ke=this.add(new ze[0](ze[1]));ze[2]&&Ke.recognizeWith(ze[2]),ze[3]&&Ke.requireFailure(ze[3])},this)}function vg(Se,Ne){var Ke,ze=Se.element;ze.style&&(H(Se.options.cssProps,function(_t,St){Ke=c(ze.style,St),Ne?(Se.oldCssProps[Ke]=ze.style[Ke],ze.style[Ke]=_t):ze.style[Ke]=Se.oldCssProps[Ke]||""}),Ne||(Se.oldCssProps={}))}Eu.prototype={set:function(Se){Se==ec&&(Se=this.compute()),wu&&this.manager.element.style&&tc[Se]&&(this.manager.element.style[_f]=Se),this.actions=Se.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var Se=[];return H(this.manager.recognizers,function(Ne){M(Ne.options.enable,[Ne])&&(Se=Se.concat(Ne.getTouchAction()))}),function _g(Se){if(P(Se,Ho))return Ho;var Ne=P(Se,ca),ze=P(Se,ua);return Ne&&ze?Ho:Ne||ze?Ne?ca:ua:P(Se,Uo)?Uo:"auto"}(Se.join(" "))},preventDefaults:function(Se){var Ne=Se.srcEvent,ze=Se.offsetDirection;if(!this.manager.session.prevented){var Ke=this.actions,_t=P(Ke,Ho)&&!tc[Ho],St=P(Ke,ua)&&!tc[ua],Cn=P(Ke,ca)&&!tc[ca];if(_t&&1===Se.pointers.length&&Se.distance<2&&Se.deltaTime<250)return;return Cn&&St||!(_t||St&&6&ze||Cn&&24&ze)?void 0:this.preventSrc(Ne)}Ne.preventDefault()},preventSrc:function(Se){this.manager.session.prevented=!0,Se.preventDefault()}},wn.prototype={defaults:{},set:function(Se){return se(this.options,Se),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(Se){if(L(Se,"recognizeWith",this))return this;var Ne=this.simultaneous;return Ne[(Se=fa(Se,this)).id]||(Ne[Se.id]=Se,Se.recognizeWith(this)),this},dropRecognizeWith:function(Se){return L(Se,"dropRecognizeWith",this)||(Se=fa(Se,this),delete this.simultaneous[Se.id]),this},requireFailure:function(Se){if(L(Se,"requireFailure",this))return this;var Ne=this.requireFail;return-1===b(Ne,Se=fa(Se,this))&&(Ne.push(Se),Se.requireFailure(this)),this},dropRequireFailure:function(Se){if(L(Se,"dropRequireFailure",this))return this;Se=fa(Se,this);var Ne=b(this.requireFail,Se);return Ne>-1&&this.requireFail.splice(Ne,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(Se){return!!this.simultaneous[Se.id]},emit:function(Se){var Ne=this,ze=this.state;function Ke(_t){Ne.manager.emit(_t,Se)}ze<8&&Ke(Ne.options.event+nc(ze)),Ke(Ne.options.event),Se.additionalEvent&&Ke(Se.additionalEvent),ze>=8&&Ke(Ne.options.event+nc(ze))},tryEmit:function(Se){if(this.canEmit())return this.emit(Se);this.state=32},canEmit:function(){for(var Se=0;Se<this.requireFail.length;){if(!(33&this.requireFail[Se].state))return!1;Se++}return!0},recognize:function(Se){var Ne=se({},Se);if(!M(this.options.enable,[this,Ne]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(Ne),30&this.state&&this.tryEmit(Ne)},process:function(Se){},getTouchAction:function(){},reset:function(){}},K(ns,wn,{defaults:{pointers:1},attrTest:function(Se){var Ne=this.options.pointers;return 0===Ne||Se.pointers.length===Ne},process:function(Se){var Ne=this.state,ze=Se.eventType,Ke=6&Ne,_t=this.attrTest(Se);return Ke&&(8&ze||!_t)?16|Ne:Ke||_t?4&ze?8|Ne:2&Ne?4|Ne:2:32}}),K(zn,ns,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var Se=this.options.direction,Ne=[];return 6&Se&&Ne.push(ua),24&Se&&Ne.push(ca),Ne},directionTest:function(Se){var Ne=this.options,ze=!0,Ke=Se.distance,_t=Se.direction,St=Se.deltaX,Cn=Se.deltaY;return _t&Ne.direction||(6&Ne.direction?(_t=0===St?1:St<0?2:4,ze=St!=this.pX,Ke=Math.abs(Se.deltaX)):(_t=0===Cn?1:Cn<0?8:16,ze=Cn!=this.pY,Ke=Math.abs(Se.deltaY))),Se.direction=_t,ze&&Ke>Ne.threshold&&_t&Ne.direction},attrTest:function(Se){return ns.prototype.attrTest.call(this,Se)&&(2&this.state||!(2&this.state)&&this.directionTest(Se))},emit:function(Se){this.pX=Se.deltaX,this.pY=Se.deltaY;var Ne=Rn(Se.direction);Ne&&(Se.additionalEvent=this.options.event+Ne),this._super.emit.call(this,Se)}}),K(nn,ns,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ho]},attrTest:function(Se){return this._super.attrTest.call(this,Se)&&(Math.abs(Se.scale-1)>this.options.threshold||2&this.state)},emit:function(Se){1!==Se.scale&&(Se.additionalEvent=this.options.event+(Se.scale<1?"in":"out")),this._super.emit.call(this,Se)}}),K(ic,wn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return["auto"]},process:function(Se){var Ne=this.options,ze=Se.pointers.length===Ne.pointers,Ke=Se.distance<Ne.threshold,_t=Se.deltaTime>Ne.time;if(this._input=Se,!Ke||!ze||12&Se.eventType&&!_t)this.reset();else if(1&Se.eventType)this.reset(),this._timer=V(function(){this.state=8,this.tryEmit()},Ne.time,this);else if(4&Se.eventType)return 8;return 32},reset:function(){clearTimeout(this._timer)},emit:function(Se){8===this.state&&(Se&&4&Se.eventType?this.manager.emit(this.options.event+"up",Se):(this._input.timeStamp=oe(),this.manager.emit(this.options.event,this._input)))}}),K($f,ns,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ho]},attrTest:function(Se){return this._super.attrTest.call(this,Se)&&(Math.abs(Se.rotation)>this.options.threshold||2&this.state)}}),K(Tt,ns,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return zn.prototype.getTouchAction.call(this)},attrTest:function(Se){var ze,Ne=this.options.direction;return 30&Ne?ze=Se.overallVelocity:6&Ne?ze=Se.overallVelocityX:24&Ne&&(ze=Se.overallVelocityY),this._super.attrTest.call(this,Se)&&Ne&Se.offsetDirection&&Se.distance>this.options.threshold&&Se.maxPointers==this.options.pointers&&F(ze)>this.options.velocity&&4&Se.eventType},emit:function(Se){var Ne=Rn(Se.offsetDirection);Ne&&this.manager.emit(this.options.event+Ne,Se),this.manager.emit(this.options.event,Se)}}),K(ha,wn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Uo]},process:function(Se){var Ne=this.options,ze=Se.pointers.length===Ne.pointers,Ke=Se.distance<Ne.threshold,_t=Se.deltaTime<Ne.time;if(this.reset(),1&Se.eventType&&0===this.count)return this.failTimeout();if(Ke&&_t&&ze){if(4!=Se.eventType)return this.failTimeout();var St=!this.pTime||Se.timeStamp-this.pTime<Ne.interval,Cn=!this.pCenter||Lo(this.pCenter,Se.center)<Ne.posThreshold;if(this.pTime=Se.timeStamp,this.pCenter=Se.center,Cn&&St?this.count+=1:this.count=1,this._input=Se,0==this.count%Ne.taps)return this.hasRequireFailures()?(this._timer=V(function(){this.state=8,this.tryEmit()},Ne.interval,this),2):8}return 32},failTimeout:function(){return this._timer=V(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Ut.VERSION="2.0.7",Ut.defaults={domEvents:!1,touchAction:ec,enable:!0,inputTarget:null,inputClass:null,preset:[[$f,{enable:!1}],[nn,{enable:!1},["rotate"]],[Tt,{direction:6}],[zn,{direction:6},["swipe"]],[ha],[ha,{event:"doubletap",taps:2},["tap"]],[ic]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},bf.prototype={set:function(Se){return se(this.options,Se),Se.touchAction&&this.touchAction.update(),Se.inputTarget&&(this.input.destroy(),this.input.target=Se.inputTarget,this.input.init()),this},stop:function(Se){this.session.stopped=Se?2:1},recognize:function(Se){var Ne=this.session;if(!Ne.stopped){this.touchAction.preventDefaults(Se);var ze,Ke=this.recognizers,_t=Ne.curRecognizer;(!_t||_t&&8&_t.state)&&(_t=Ne.curRecognizer=null);for(var St=0;St<Ke.length;)ze=Ke[St],2===Ne.stopped||_t&&ze!=_t&&!ze.canRecognizeWith(_t)?ze.reset():ze.recognize(Se),!_t&&14&ze.state&&(_t=Ne.curRecognizer=ze),St++}},get:function(Se){if(Se instanceof wn)return Se;for(var Ne=this.recognizers,ze=0;ze<Ne.length;ze++)if(Ne[ze].options.event==Se)return Ne[ze];return null},add:function(Se){if(L(Se,"add",this))return this;var Ne=this.get(Se.options.event);return Ne&&this.remove(Ne),this.recognizers.push(Se),Se.manager=this,this.touchAction.update(),Se},remove:function(Se){if(L(Se,"remove",this))return this;if(Se=this.get(Se)){var Ne=this.recognizers,ze=b(Ne,Se);-1!==ze&&(Ne.splice(ze,1),this.touchAction.update())}return this},on:function(Se,Ne){if(Se!==u&&Ne!==u){var ze=this.handlers;return H(g(Se),function(Ke){ze[Ke]=ze[Ke]||[],ze[Ke].push(Ne)}),this}},off:function(Se,Ne){if(Se!==u){var ze=this.handlers;return H(g(Se),function(Ke){Ne?ze[Ke]&&ze[Ke].splice(b(ze[Ke],Ne),1):delete ze[Ke]}),this}},emit:function(Se,Ne){this.options.domEvents&&function rc(Se,Ne){var ze=w.createEvent("Event");ze.initEvent(Se,!0,!0),ze.gesture=Ne,Ne.target.dispatchEvent(ze)}(Se,Ne);var ze=this.handlers[Se]&&this.handlers[Se].slice();if(ze&&ze.length){Ne.type=Se,Ne.preventDefault=function(){Ne.srcEvent.preventDefault()};for(var Ke=0;Ke<ze.length;)ze[Ke](Ne),Ke++}},destroy:function(){this.element&&vg(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},se(Ut,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:32,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:bf,Input:Me,TouchAction:Eu,TouchInput:Ql,MouseInput:ts,PointerEventInput:Xl,TouchMouseInput:jo,SingleTouchInput:hf,Recognizer:wn,AttrRecognizer:ns,Tap:ha,Pan:zn,Swipe:Tt,Pinch:nn,Rotate:$f,Press:ic,on:z,off:A,each:H,merge:J,extend:ue,assign:se,inherit:K,bindFn:ee,prefixed:c}),(void 0!==y?y:"undefined"!=typeof self?self:{}).Hammer=Ut,(a=function(){return Ut}.call(ae,Y,ae,E))!==u&&(E.exports=a)}(window,document)},8461:(E,ae)=>{ae.read=function(Y,a,y,w,p){var u,k,v=8*p-w-1,D=(1<<v)-1,_=D>>1,F=-7,oe=y?p-1:0,V=y?-1:1,L=Y[a+oe];for(oe+=V,u=L&(1<<-F)-1,L>>=-F,F+=v;F>0;u=256*u+Y[a+oe],oe+=V,F-=8);for(k=u&(1<<-F)-1,u>>=-F,F+=w;F>0;k=256*k+Y[a+oe],oe+=V,F-=8);if(0===u)u=1-_;else{if(u===D)return k?NaN:1/0*(L?-1:1);k+=Math.pow(2,w),u-=_}return(L?-1:1)*k*Math.pow(2,u-w)},ae.write=function(Y,a,y,w,p,u){var k,v,D,_=8*u-p-1,F=(1<<_)-1,oe=F>>1,V=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,L=w?0:u-1,H=w?1:-1,U=a<0||0===a&&1/a<0?1:0;for(a=Math.abs(a),isNaN(a)||a===1/0?(v=isNaN(a)?1:0,k=F):(k=Math.floor(Math.log(a)/Math.LN2),a*(D=Math.pow(2,-k))<1&&(k--,D*=2),(a+=k+oe>=1?V/D:V*Math.pow(2,1-oe))*D>=2&&(k++,D/=2),k+oe>=F?(v=0,k=F):k+oe>=1?(v=(a*D-1)*Math.pow(2,p),k+=oe):(v=a*Math.pow(2,oe-1)*Math.pow(2,p),k=0));p>=8;Y[y+L]=255&v,L+=H,v/=256,p-=8);for(k=k<<p|v,_+=p;_>0;Y[y+L]=255&k,L+=H,k/=256,_-=8);Y[y+L-H]|=128*U}},6256:function(E,ae){!function(p){var L,u="undefined",k=u!==typeof Buffer&&Buffer,v=u!==typeof Uint8Array&&Uint8Array,D=u!==typeof ArrayBuffer&&ArrayBuffer,_=[0,0,0,0,0,0,0,0],F=Array.isArray||function N(P){return!!P&&"[object Array]"==Object.prototype.toString.call(P)},oe=4294967296;function H(P,g,b){var C=g?0:4,h=g?4:0,c=g?0:3,l=g?1:2,f=g?2:1,m=g?3:0,x=g?M:z,S=g?G:A,Z=T.prototype,le="is"+P,ye="_"+le;return Z.buffer=void 0,Z.offset=0,Z[ye]=!0,Z.toNumber=ve,Z.toString=function de(he){var B=this.buffer,O=this.offset,ne=ce(B,O+C),q=ce(B,O+h),pe="",$e=!b&&2147483648&ne;for($e&&(ne=~ne,q=oe-q),he=he||10;;){var me=ne%he*oe+q;if(ne=Math.floor(ne/he),q=Math.floor(me/he),pe=(me%he).toString(he)+pe,!ne&&!q)break}return $e&&(pe="-"+pe),pe},Z.toJSON=ve,Z.toArray=U,k&&(Z.toBuffer=se),v&&(Z.toArrayBuffer=ue),T[le]=function R(he){return!(!he||!he[ye])},p[P]=T,T;function T(he,B,O,ne){return this instanceof T?function ie(he,B,O,ne,q){v&&D&&(B instanceof D&&(B=new v(B)),ne instanceof D&&(ne=new v(ne))),B||O||ne||L?(J(B,O)||(q=O,ne=B,O=0,B=new(L||Array)(8)),he.buffer=B,he.offset=O|=0,u!==typeof ne&&("string"==typeof ne?function j(he,B,O,ne){var q=0,pe=O.length,$e=0,me=0;"-"===O[0]&&q++;for(var Te=q;q<pe;){var De=parseInt(O[q++],ne);if(!(De>=0))break;me=me*ne+De,$e=$e*ne+Math.floor(me/oe),me%=oe}Te&&($e=~$e,me?me=oe-me:$e++),we(he,B+C,$e),we(he,B+h,me)}(B,O,ne,q||10):J(ne,q)?K(B,O,ne,q):"number"==typeof q?(we(B,O+C,ne),we(B,O+h,q)):ne>0?x(B,O,ne):ne<0?S(B,O,ne):K(B,O,_,0))):he.buffer=ee(_,0)}(this,he,B,O,ne):new T(he,B,O,ne)}function ve(){var he=this.buffer,B=this.offset,O=ce(he,B+C),ne=ce(he,B+h);return b||(O|=0),O?O*oe+ne:ne}function we(he,B,O){he[B+m]=255&O,he[B+f]=255&(O>>=8),he[B+l]=255&(O>>=8),he[B+c]=255&(O>>=8)}function ce(he,B){return 16777216*he[B+c]+(he[B+l]<<16)+(he[B+f]<<8)+he[B+m]}}function U(P){var g=this.buffer,b=this.offset;return L=null,!1!==P&&0===b&&8===g.length&&F(g)?g:ee(g,b)}function se(P){var g=this.buffer,b=this.offset;if(L=k,!1!==P&&0===b&&8===g.length&&Buffer.isBuffer(g))return g;var C=new k(8);return K(C,0,g,b),C}function ue(P){var g=this.buffer,b=this.offset,C=g.buffer;if(L=v,!1!==P&&0===b&&C instanceof D&&8===C.byteLength)return C;var h=new v(8);return K(h,0,g,b),h.buffer}function J(P,g){var b=P&&P.length;return g|=0,b&&g+8<=b&&"string"!=typeof P[g]}function K(P,g,b,C){g|=0,C|=0;for(var h=0;h<8;h++)P[g++]=255&b[C++]}function ee(P,g){return Array.prototype.slice.call(P,g,g+8)}function M(P,g,b){for(var C=g+8;C>g;)P[--C]=255&b,b/=256}function G(P,g,b){var C=g+8;for(b++;C>g;)P[--C]=255&-b^255,b/=256}function z(P,g,b){for(var C=g+8;g<C;)P[g++]=255&b,b/=256}function A(P,g,b){var C=g+8;for(b++;g<C;)P[g++]=255&-b^255,b/=256}H("Uint64BE",!0,!0),H("Int64BE",!0,!1),H("Uint64LE",!1,!0),H("Int64LE",!1,!1)}("string"!=typeof ae.nodeName?ae:this||{})},6425:E=>{var ae={}.toString;E.exports=Array.isArray||function(Y){return"[object Array]"==ae.call(Y)}},5650:E=>{E.exports=function ae(Y,a,y){function w(k,v){if(!a[k]){if(!Y[k]){if(p)return p(k,!0);var _=new Error("Cannot find module '"+k+"'");throw _.code="MODULE_NOT_FOUND",_}var F=a[k]={exports:{}};Y[k][0].call(F.exports,function(oe){return w(Y[k][1][oe]||oe)},F,F.exports,ae,Y,a,y)}return a[k].exports}for(var p=void 0,u=0;u<y.length;u++)w(y[u]);return w}({1:[function(ae,Y,a){"use strict";var y=ae("./utils"),w=ae("./support"),p="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";a.encode=function(u){for(var k,v,D,F,oe,V,L=[],H=0,U=u.length,se=U,ue="string"!==y.getTypeOf(u);H<u.length;)se=U-H,D=ue?(k=u[H++],v=H<U?u[H++]:0,H<U?u[H++]:0):(k=u.charCodeAt(H++),v=H<U?u.charCodeAt(H++):0,H<U?u.charCodeAt(H++):0),F=(3&k)<<4|v>>4,oe=1<se?(15&v)<<2|D>>6:64,V=2<se?63&D:64,L.push(p.charAt(k>>2)+p.charAt(F)+p.charAt(oe)+p.charAt(V));return L.join("")},a.decode=function(u){var k,v,D,_,F,oe,V=0,L=0,H="data:";if(u.substr(0,H.length)===H)throw new Error("Invalid base64 input, it looks like a data url.");var U,se=3*(u=u.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(u.charAt(u.length-1)===p.charAt(64)&&se--,u.charAt(u.length-2)===p.charAt(64)&&se--,se%1!=0)throw new Error("Invalid base64 input, bad content length.");for(U=w.uint8array?new Uint8Array(0|se):new Array(0|se);V<u.length;)k=p.indexOf(u.charAt(V++))<<2|(_=p.indexOf(u.charAt(V++)))>>4,v=(15&_)<<4|(F=p.indexOf(u.charAt(V++)))>>2,D=(3&F)<<6|(oe=p.indexOf(u.charAt(V++))),U[L++]=k,64!==F&&(U[L++]=v),64!==oe&&(U[L++]=D);return U}},{"./support":30,"./utils":32}],2:[function(ae,Y,a){"use strict";var y=ae("./external"),w=ae("./stream/DataWorker"),p=ae("./stream/Crc32Probe"),u=ae("./stream/DataLengthProbe");function k(v,D,_,F,oe){this.compressedSize=v,this.uncompressedSize=D,this.crc32=_,this.compression=F,this.compressedContent=oe}k.prototype={getContentWorker:function(){var v=new w(y.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new u("data_length")),D=this;return v.on("end",function(){if(this.streamInfo.data_length!==D.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new w(y.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},k.createWorkerFrom=function(v,D,_){return v.pipe(new p).pipe(new u("uncompressedSize")).pipe(D.compressWorker(_)).pipe(new u("compressedSize")).withStreamInfo("compression",D)},Y.exports=k},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(ae,Y,a){"use strict";var y=ae("./stream/GenericWorker");a.STORE={magic:"\0\0",compressWorker:function(){return new y("STORE compression")},uncompressWorker:function(){return new y("STORE decompression")}},a.DEFLATE=ae("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(ae,Y,a){"use strict";var y=ae("./utils"),w=function(){for(var p,u=[],k=0;k<256;k++){p=k;for(var v=0;v<8;v++)p=1&p?3988292384^p>>>1:p>>>1;u[k]=p}return u}();Y.exports=function(p,u){return void 0!==p&&p.length?"string"!==y.getTypeOf(p)?function(k,v,D,_){var F=w,oe=0+D;k^=-1;for(var V=0;V<oe;V++)k=k>>>8^F[255&(k^v[V])];return-1^k}(0|u,p,p.length):function(k,v,D,_){var F=w,oe=0+D;k^=-1;for(var V=0;V<oe;V++)k=k>>>8^F[255&(k^v.charCodeAt(V))];return-1^k}(0|u,p,p.length):0}},{"./utils":32}],5:[function(ae,Y,a){"use strict";a.base64=!1,a.binary=!1,a.dir=!1,a.createFolders=!0,a.date=null,a.compression=null,a.compressionOptions=null,a.comment=null,a.unixPermissions=null,a.dosPermissions=null},{}],6:[function(ae,Y,a){"use strict";var y;y="undefined"!=typeof Promise?Promise:ae("lie"),Y.exports={Promise:y}},{lie:37}],7:[function(ae,Y,a){"use strict";var y="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array,w=ae("pako"),p=ae("./utils"),u=ae("./stream/GenericWorker"),k=y?"uint8array":"array";function v(D,_){u.call(this,"FlateWorker/"+D),this._pako=null,this._pakoAction=D,this._pakoOptions=_,this.meta={}}a.magic="\b\0",p.inherits(v,u),v.prototype.processChunk=function(D){this.meta=D.meta,null===this._pako&&this._createPako(),this._pako.push(p.transformTo(k,D.data),!1)},v.prototype.flush=function(){u.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){u.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new w[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var D=this;this._pako.onData=function(_){D.push({data:_,meta:D.meta})}},a.compressWorker=function(D){return new v("Deflate",D)},a.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(ae,Y,a){"use strict";function y(F,oe){var V,L="";for(V=0;V<oe;V++)L+=String.fromCharCode(255&F),F>>>=8;return L}function w(F,oe,V,L,H,U){var se,ue,J=F.file,K=F.compression,ee=U!==k.utf8encode,M=p.transformTo("string",U(J.name)),G=p.transformTo("string",k.utf8encode(J.name)),z=J.comment,A=p.transformTo("string",U(z)),N=p.transformTo("string",k.utf8encode(z)),P=G.length!==J.name.length,g=N.length!==z.length,b="",C="",h="",c=J.dir,l=J.date,f={crc32:0,compressedSize:0,uncompressedSize:0};oe&&!V||(f.crc32=F.crc32,f.compressedSize=F.compressedSize,f.uncompressedSize=F.uncompressedSize);var m=0;oe&&(m|=8),ee||!P&&!g||(m|=2048);var le,T,x=0,S=0;c&&(x|=16),"UNIX"===H?(S=798,x|=(T=le=J.unixPermissions,le||(T=c?16893:33204),(65535&T)<<16)):(S=20,x|=function(le){return 63&(le||0)}(J.dosPermissions)),se=l.getUTCHours(),se<<=6,se|=l.getUTCMinutes(),se<<=5,se|=l.getUTCSeconds()/2,ue=l.getUTCFullYear()-1980,ue<<=4,ue|=l.getUTCMonth()+1,ue<<=5,ue|=l.getUTCDate(),P&&(C=y(1,1)+y(v(M),4)+G,b+="up"+y(C.length,2)+C),g&&(h=y(1,1)+y(v(A),4)+N,b+="uc"+y(h.length,2)+h);var Z="";return Z+="\n\0",Z+=y(m,2),Z+=K.magic,Z+=y(se,2),Z+=y(ue,2),Z+=y(f.crc32,4),Z+=y(f.compressedSize,4),Z+=y(f.uncompressedSize,4),Z+=y(M.length,2),Z+=y(b.length,2),{fileRecord:D.LOCAL_FILE_HEADER+Z+M+b,dirRecord:D.CENTRAL_FILE_HEADER+y(S,2)+Z+y(A.length,2)+"\0\0\0\0"+y(x,4)+y(L,4)+M+b+A}}var p=ae("../utils"),u=ae("../stream/GenericWorker"),k=ae("../utf8"),v=ae("../crc32"),D=ae("../signature");function _(F,oe,V,L){u.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=oe,this.zipPlatform=V,this.encodeFileName=L,this.streamFiles=F,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}p.inherits(_,u),_.prototype.push=function(F){var oe=F.meta.percent||0,V=this.entriesCount,L=this._sources.length;this.accumulate?this.contentBuffer.push(F):(this.bytesWritten+=F.data.length,u.prototype.push.call(this,{data:F.data,meta:{currentFile:this.currentFile,percent:V?(oe+100*(V-L-1))/V:100}}))},_.prototype.openedSource=function(F){this.currentSourceOffset=this.bytesWritten,this.currentFile=F.file.name;var oe=this.streamFiles&&!F.file.dir;if(oe){var V=w(F,oe,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:V.fileRecord,meta:{percent:0}})}else this.accumulate=!0},_.prototype.closedSource=function(F){this.accumulate=!1;var L,oe=this.streamFiles&&!F.file.dir,V=w(F,oe,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(V.dirRecord),oe)this.push({data:(L=F,D.DATA_DESCRIPTOR+y(L.crc32,4)+y(L.compressedSize,4)+y(L.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:V.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},_.prototype.flush=function(){for(var F=this.bytesWritten,oe=0;oe<this.dirRecords.length;oe++)this.push({data:this.dirRecords[oe],meta:{percent:100}});var H,U,se,K,L=(H=this.dirRecords.length,U=this.bytesWritten-F,se=F,K=p.transformTo("string",(0,this.encodeFileName)(this.zipComment)),D.CENTRAL_DIRECTORY_END+"\0\0\0\0"+y(H,2)+y(H,2)+y(U,4)+y(se,4)+y(K.length,2)+K);this.push({data:L,meta:{percent:100}})},_.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},_.prototype.registerPrevious=function(F){this._sources.push(F);var oe=this;return F.on("data",function(V){oe.processChunk(V)}),F.on("end",function(){oe.closedSource(oe.previous.streamInfo),oe._sources.length?oe.prepareNextSource():oe.end()}),F.on("error",function(V){oe.error(V)}),this},_.prototype.resume=function(){return!!u.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},_.prototype.error=function(F){var oe=this._sources;if(!u.prototype.error.call(this,F))return!1;for(var V=0;V<oe.length;V++)try{oe[V].error(F)}catch(L){}return!0},_.prototype.lock=function(){u.prototype.lock.call(this);for(var F=this._sources,oe=0;oe<F.length;oe++)F[oe].lock()},Y.exports=_},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(ae,Y,a){"use strict";var y=ae("../compressions"),w=ae("./ZipFileWorker");a.generateWorker=function(p,u,k){var v=new w(u.streamFiles,k,u.platform,u.encodeFileName),D=0;try{p.forEach(function(_,F){D++;var oe=function(U,se){var ue=U||se,J=y[ue];if(!J)throw new Error(ue+" is not a valid compression method !");return J}(F.options.compression,u.compression),L=F.dir,H=F.date;F._compressWorker(oe,F.options.compressionOptions||u.compressionOptions||{}).withStreamInfo("file",{name:_,dir:L,date:H,comment:F.comment||"",unixPermissions:F.unixPermissions,dosPermissions:F.dosPermissions}).pipe(v)}),v.entriesCount=D}catch(_){v.error(_)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(ae,Y,a){"use strict";function y(){if(!(this instanceof y))return new y;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var w=new y;for(var p in this)"function"!=typeof this[p]&&(w[p]=this[p]);return w}}(y.prototype=ae("./object")).loadAsync=ae("./load"),y.support=ae("./support"),y.defaults=ae("./defaults"),y.version="3.10.1",y.loadAsync=function(w,p){return(new y).loadAsync(w,p)},y.external=ae("./external"),Y.exports=y},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(ae,Y,a){"use strict";var y=ae("./utils"),w=ae("./external"),p=ae("./utf8"),u=ae("./zipEntries"),k=ae("./stream/Crc32Probe"),v=ae("./nodejsUtils");function D(_){return new w.Promise(function(F,oe){var V=_.decompressed.getContentWorker().pipe(new k);V.on("error",function(L){oe(L)}).on("end",function(){V.streamInfo.crc32!==_.decompressed.crc32?oe(new Error("Corrupted zip : CRC32 mismatch")):F()}).resume()})}Y.exports=function(_,F){var oe=this;return F=y.extend(F||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:p.utf8decode}),v.isNode&&v.isStream(_)?w.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):y.prepareContent("the loaded zip file",_,!0,F.optimizedBinaryString,F.base64).then(function(V){var L=new u(F);return L.load(V),L}).then(function(V){var L=[w.Promise.resolve(V)],H=V.files;if(F.checkCRC32)for(var U=0;U<H.length;U++)L.push(D(H[U]));return w.Promise.all(L)}).then(function(V){for(var L=V.shift(),H=L.files,U=0;U<H.length;U++){var se=H[U],ue=se.fileNameStr,J=y.resolve(se.fileNameStr);oe.file(J,se.decompressed,{binary:!0,optimizedBinaryString:!0,date:se.date,dir:se.dir,comment:se.fileCommentStr.length?se.fileCommentStr:null,unixPermissions:se.unixPermissions,dosPermissions:se.dosPermissions,createFolders:F.createFolders}),se.dir||(oe.file(J).unsafeOriginalName=ue)}return L.zipComment.length&&(oe.comment=L.zipComment),oe})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(ae,Y,a){"use strict";var y=ae("../utils"),w=ae("../stream/GenericWorker");function p(u,k){w.call(this,"Nodejs stream input adapter for "+u),this._upstreamEnded=!1,this._bindStream(k)}y.inherits(p,w),p.prototype._bindStream=function(u){var k=this;(this._stream=u).pause(),u.on("data",function(v){k.push({data:v,meta:{percent:0}})}).on("error",function(v){k.isPaused?this.generatedError=v:k.error(v)}).on("end",function(){k.isPaused?k._upstreamEnded=!0:k.end()})},p.prototype.pause=function(){return!!w.prototype.pause.call(this)&&(this._stream.pause(),!0)},p.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},Y.exports=p},{"../stream/GenericWorker":28,"../utils":32}],13:[function(ae,Y,a){"use strict";var y=ae("readable-stream").Readable;function w(p,u,k){y.call(this,u),this._helper=p;var v=this;p.on("data",function(D,_){v.push(D)||v._helper.pause(),k&&k(_)}).on("error",function(D){v.emit("error",D)}).on("end",function(){v.push(null)})}ae("../utils").inherits(w,y),w.prototype._read=function(){this._helper.resume()},Y.exports=w},{"../utils":32,"readable-stream":16}],14:[function(ae,Y,a){"use strict";Y.exports={isNode:"undefined"!=typeof Buffer,newBufferFrom:function(y,w){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(y,w);if("number"==typeof y)throw new Error('The "data" argument must not be a number');return new Buffer(y,w)},allocBuffer:function(y){if(Buffer.alloc)return Buffer.alloc(y);var w=new Buffer(y);return w.fill(0),w},isBuffer:function(y){return Buffer.isBuffer(y)},isStream:function(y){return y&&"function"==typeof y.on&&"function"==typeof y.pause&&"function"==typeof y.resume}}},{}],15:[function(ae,Y,a){"use strict";function y(J,K,ee){var M,G=p.getTypeOf(K),z=p.extend(ee||{},v);z.date=z.date||new Date,null!==z.compression&&(z.compression=z.compression.toUpperCase()),"string"==typeof z.unixPermissions&&(z.unixPermissions=parseInt(z.unixPermissions,8)),z.unixPermissions&&16384&z.unixPermissions&&(z.dir=!0),z.dosPermissions&&16&z.dosPermissions&&(z.dir=!0),z.dir&&(J=H(J)),z.createFolders&&(M=L(J))&&U.call(this,M,!0),ee&&void 0!==ee.binary||(z.binary=!("string"===G&&!1===z.binary&&!1===z.base64)),(K instanceof D&&0===K.uncompressedSize||z.dir||!K||0===K.length)&&(z.base64=!1,z.binary=!0,K="",z.compression="STORE",G="string");var N;N=K instanceof D||K instanceof u?K:oe.isNode&&oe.isStream(K)?new V(J,K):p.prepareContent(J,K,z.binary,z.optimizedBinaryString,z.base64);var P=new _(J,N,z);this.files[J]=P}var w=ae("./utf8"),p=ae("./utils"),u=ae("./stream/GenericWorker"),k=ae("./stream/StreamHelper"),v=ae("./defaults"),D=ae("./compressedObject"),_=ae("./zipObject"),F=ae("./generate"),oe=ae("./nodejsUtils"),V=ae("./nodejs/NodejsStreamInputAdapter"),L=function(J){"/"===J.slice(-1)&&(J=J.substring(0,J.length-1));var K=J.lastIndexOf("/");return 0<K?J.substring(0,K):""},H=function(J){return"/"!==J.slice(-1)&&(J+="/"),J},U=function(J,K){return K=void 0!==K?K:v.createFolders,J=H(J),this.files[J]||y.call(this,J,null,{dir:!0,createFolders:K}),this.files[J]};function se(J){return"[object RegExp]"===Object.prototype.toString.call(J)}var ue={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(J){var K,ee,M;for(K in this.files)M=this.files[K],(ee=K.slice(this.root.length,K.length))&&K.slice(0,this.root.length)===this.root&&J(ee,M)},filter:function(J){var K=[];return this.forEach(function(ee,M){J(ee,M)&&K.push(M)}),K},file:function(J,K,ee){if(1!==arguments.length)return y.call(this,J=this.root+J,K,ee),this;if(se(J)){var M=J;return this.filter(function(z,A){return!A.dir&&M.test(z)})}var G=this.files[this.root+J];return G&&!G.dir?G:null},folder:function(J){if(!J)return this;if(se(J))return this.filter(function(G,z){return z.dir&&J.test(G)});var ee=U.call(this,this.root+J),M=this.clone();return M.root=ee.name,M},remove:function(J){var K=this.files[J=this.root+J];if(K||("/"!==J.slice(-1)&&(J+="/"),K=this.files[J]),K&&!K.dir)delete this.files[J];else for(var ee=this.filter(function(G,z){return z.name.slice(0,J.length)===J}),M=0;M<ee.length;M++)delete this.files[ee[M].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(J){var K,ee={};try{if((ee=p.extend(J||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:w.utf8encode})).type=ee.type.toLowerCase(),ee.compression=ee.compression.toUpperCase(),"binarystring"===ee.type&&(ee.type="string"),!ee.type)throw new Error("No output type specified.");p.checkSupport(ee.type),"darwin"!==ee.platform&&"freebsd"!==ee.platform&&"linux"!==ee.platform&&"sunos"!==ee.platform||(ee.platform="UNIX"),"win32"===ee.platform&&(ee.platform="DOS"),K=F.generateWorker(this,ee,ee.comment||this.comment||"")}catch(G){(K=new u("error")).error(G)}return new k(K,ee.type||"string",ee.mimeType)},generateAsync:function(J,K){return this.generateInternalStream(J).accumulate(K)},generateNodeStream:function(J,K){return(J=J||{}).type||(J.type="nodebuffer"),this.generateInternalStream(J).toNodejsStream(K)}};Y.exports=ue},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(ae,Y,a){"use strict";Y.exports=ae("stream")},{stream:void 0}],17:[function(ae,Y,a){"use strict";var y=ae("./DataReader");function w(p){y.call(this,p);for(var u=0;u<this.data.length;u++)p[u]=255&p[u]}ae("../utils").inherits(w,y),w.prototype.byteAt=function(p){return this.data[this.zero+p]},w.prototype.lastIndexOfSignature=function(p){for(var u=p.charCodeAt(0),k=p.charCodeAt(1),v=p.charCodeAt(2),D=p.charCodeAt(3),_=this.length-4;0<=_;--_)if(this.data[_]===u&&this.data[_+1]===k&&this.data[_+2]===v&&this.data[_+3]===D)return _-this.zero;return-1},w.prototype.readAndCheckSignature=function(p){var u=p.charCodeAt(0),k=p.charCodeAt(1),v=p.charCodeAt(2),D=p.charCodeAt(3),_=this.readData(4);return u===_[0]&&k===_[1]&&v===_[2]&&D===_[3]},w.prototype.readData=function(p){if(this.checkOffset(p),0===p)return[];var u=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,u},Y.exports=w},{"../utils":32,"./DataReader":18}],18:[function(ae,Y,a){"use strict";var y=ae("../utils");function w(p){this.data=p,this.length=p.length,this.index=0,this.zero=0}w.prototype={checkOffset:function(p){this.checkIndex(this.index+p)},checkIndex:function(p){if(this.length<this.zero+p||p<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+p+"). Corrupted zip ?")},setIndex:function(p){this.checkIndex(p),this.index=p},skip:function(p){this.setIndex(this.index+p)},byteAt:function(){},readInt:function(p){var u,k=0;for(this.checkOffset(p),u=this.index+p-1;u>=this.index;u--)k=(k<<8)+this.byteAt(u);return this.index+=p,k},readString:function(p){return y.transformTo("string",this.readData(p))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var p=this.readInt(4);return new Date(Date.UTC(1980+(p>>25&127),(p>>21&15)-1,p>>16&31,p>>11&31,p>>5&63,(31&p)<<1))}},Y.exports=w},{"../utils":32}],19:[function(ae,Y,a){"use strict";var y=ae("./Uint8ArrayReader");function w(p){y.call(this,p)}ae("../utils").inherits(w,y),w.prototype.readData=function(p){this.checkOffset(p);var u=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,u},Y.exports=w},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(ae,Y,a){"use strict";var y=ae("./DataReader");function w(p){y.call(this,p)}ae("../utils").inherits(w,y),w.prototype.byteAt=function(p){return this.data.charCodeAt(this.zero+p)},w.prototype.lastIndexOfSignature=function(p){return this.data.lastIndexOf(p)-this.zero},w.prototype.readAndCheckSignature=function(p){return p===this.readData(4)},w.prototype.readData=function(p){this.checkOffset(p);var u=this.data.slice(this.zero+this.index,this.zero+this.index+p);return this.index+=p,u},Y.exports=w},{"../utils":32,"./DataReader":18}],21:[function(ae,Y,a){"use strict";var y=ae("./ArrayReader");function w(p){y.call(this,p)}ae("../utils").inherits(w,y),w.prototype.readData=function(p){if(this.checkOffset(p),0===p)return new Uint8Array(0);var u=this.data.subarray(this.zero+this.index,this.zero+this.index+p);return this.index+=p,u},Y.exports=w},{"../utils":32,"./ArrayReader":17}],22:[function(ae,Y,a){"use strict";var y=ae("../utils"),w=ae("../support"),p=ae("./ArrayReader"),u=ae("./StringReader"),k=ae("./NodeBufferReader"),v=ae("./Uint8ArrayReader");Y.exports=function(D){var _=y.getTypeOf(D);return y.checkSupport(_),"string"!==_||w.uint8array?"nodebuffer"===_?new k(D):w.uint8array?new v(y.transformTo("uint8array",D)):new p(y.transformTo("array",D)):new u(D)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(ae,Y,a){"use strict";a.LOCAL_FILE_HEADER="PK\x03\x04",a.CENTRAL_FILE_HEADER="PK\x01\x02",a.CENTRAL_DIRECTORY_END="PK\x05\x06",a.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x06\x07",a.ZIP64_CENTRAL_DIRECTORY_END="PK\x06\x06",a.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(ae,Y,a){"use strict";var y=ae("./GenericWorker"),w=ae("../utils");function p(u){y.call(this,"ConvertWorker to "+u),this.destType=u}w.inherits(p,y),p.prototype.processChunk=function(u){this.push({data:w.transformTo(this.destType,u.data),meta:u.meta})},Y.exports=p},{"../utils":32,"./GenericWorker":28}],25:[function(ae,Y,a){"use strict";var y=ae("./GenericWorker"),w=ae("../crc32");function p(){y.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}ae("../utils").inherits(p,y),p.prototype.processChunk=function(u){this.streamInfo.crc32=w(u.data,this.streamInfo.crc32||0),this.push(u)},Y.exports=p},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(ae,Y,a){"use strict";var y=ae("../utils"),w=ae("./GenericWorker");function p(u){w.call(this,"DataLengthProbe for "+u),this.propName=u,this.withStreamInfo(u,0)}y.inherits(p,w),p.prototype.processChunk=function(u){u&&(this.streamInfo[this.propName]=(this.streamInfo[this.propName]||0)+u.data.length),w.prototype.processChunk.call(this,u)},Y.exports=p},{"../utils":32,"./GenericWorker":28}],27:[function(ae,Y,a){"use strict";var y=ae("../utils"),w=ae("./GenericWorker");function p(u){w.call(this,"DataWorker");var k=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,u.then(function(v){k.dataIsReady=!0,k.data=v,k.max=v&&v.length||0,k.type=y.getTypeOf(v),k.isPaused||k._tickAndRepeat()},function(v){k.error(v)})}y.inherits(p,w),p.prototype.cleanUp=function(){w.prototype.cleanUp.call(this),this.data=null},p.prototype.resume=function(){return!!w.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,y.delay(this._tickAndRepeat,[],this)),!0)},p.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(y.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},p.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var u=null,k=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":u=this.data.substring(this.index,k);break;case"uint8array":u=this.data.subarray(this.index,k);break;case"array":case"nodebuffer":u=this.data.slice(this.index,k)}return this.index=k,this.push({data:u,meta:{percent:this.max?this.index/this.max*100:0}})},Y.exports=p},{"../utils":32,"./GenericWorker":28}],28:[function(ae,Y,a){"use strict";function y(w){this.name=w||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}y.prototype={push:function(w){this.emit("data",w)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(w){this.emit("error",w)}return!0},error:function(w){return!this.isFinished&&(this.isPaused?this.generatedError=w:(this.isFinished=!0,this.emit("error",w),this.previous&&this.previous.error(w),this.cleanUp()),!0)},on:function(w,p){return this._listeners[w].push(p),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(w,p){if(this._listeners[w])for(var u=0;u<this._listeners[w].length;u++)this._listeners[w][u].call(this,p)},pipe:function(w){return w.registerPrevious(this)},registerPrevious:function(w){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=w.streamInfo,this.mergeStreamInfo(),this.previous=w;var p=this;return w.on("data",function(u){p.processChunk(u)}),w.on("end",function(){p.end()}),w.on("error",function(u){p.error(u)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var w=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),w=!0),this.previous&&this.previous.resume(),!w},flush:function(){},processChunk:function(w){this.push(w)},withStreamInfo:function(w,p){return this.extraStreamInfo[w]=p,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var w in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,w)&&(this.streamInfo[w]=this.extraStreamInfo[w])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var w="Worker "+this.name;return this.previous?this.previous+" -> "+w:w}},Y.exports=y},{}],29:[function(ae,Y,a){"use strict";var y=ae("../utils"),w=ae("./ConvertWorker"),p=ae("./GenericWorker"),u=ae("../base64"),k=ae("../support"),v=ae("../external"),D=null;if(k.nodestream)try{D=ae("../nodejs/NodejsStreamOutputAdapter")}catch(oe){}function F(oe,V,L){var H=V;switch(V){case"blob":case"arraybuffer":H="uint8array";break;case"base64":H="string"}try{this._internalType=H,this._outputType=V,this._mimeType=L,y.checkSupport(H),this._worker=oe.pipe(new w(H)),oe.lock()}catch(U){this._worker=new p("error"),this._worker.error(U)}}F.prototype={accumulate:function(oe){return function _(oe,V){return new v.Promise(function(L,H){var U=[],se=oe._internalType,ue=oe._outputType,J=oe._mimeType;oe.on("data",function(K,ee){U.push(K),V&&V(ee)}).on("error",function(K){U=[],H(K)}).on("end",function(){try{var K=function(ee,M,G){switch(ee){case"blob":return y.newBlob(y.transformTo("arraybuffer",M),G);case"base64":return u.encode(M);default:return y.transformTo(ee,M)}}(ue,function(ee,M){var G,z=0,A=null,N=0;for(G=0;G<M.length;G++)N+=M[G].length;switch(ee){case"string":return M.join("");case"array":return Array.prototype.concat.apply([],M);case"uint8array":for(A=new Uint8Array(N),G=0;G<M.length;G++)A.set(M[G],z),z+=M[G].length;return A;case"nodebuffer":return Buffer.concat(M);default:throw new Error("concat : unsupported type '"+ee+"'")}}(se,U),J);L(K)}catch(ee){H(ee)}U=[]}).resume()})}(this,oe)},on:function(oe,V){var L=this;return this._worker.on(oe,"data"===oe?function(H){V.call(L,H.data,H.meta)}:function(){y.delay(V,arguments,L)}),this},resume:function(){return y.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(oe){if(y.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new D(this,{objectMode:"nodebuffer"!==this._outputType},oe)}},Y.exports=F},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(ae,Y,a){"use strict";if(a.base64=!0,a.array=!0,a.string=!0,a.arraybuffer="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof Uint8Array,a.nodebuffer="undefined"!=typeof Buffer,a.uint8array="undefined"!=typeof Uint8Array,"undefined"==typeof ArrayBuffer)a.blob=!1;else{var y=new ArrayBuffer(0);try{a.blob=0===new Blob([y],{type:"application/zip"}).size}catch(p){try{var w=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);w.append(y),a.blob=0===w.getBlob("application/zip").size}catch(u){a.blob=!1}}}try{a.nodestream=!!ae("readable-stream").Readable}catch(p){a.nodestream=!1}},{"readable-stream":16}],31:[function(ae,Y,a){"use strict";for(var y=ae("./utils"),w=ae("./support"),p=ae("./nodejsUtils"),u=ae("./stream/GenericWorker"),k=new Array(256),v=0;v<256;v++)k[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;function D(){u.call(this,"utf-8 decode"),this.leftOver=null}function _(){u.call(this,"utf-8 encode")}k[254]=k[254]=1,a.utf8encode=function(F){return w.nodebuffer?p.newBufferFrom(F,"utf-8"):function(oe){var V,L,H,U,se,ue=oe.length,J=0;for(U=0;U<ue;U++)55296==(64512&(L=oe.charCodeAt(U)))&&U+1<ue&&56320==(64512&(H=oe.charCodeAt(U+1)))&&(L=65536+(L-55296<<10)+(H-56320),U++),J+=L<128?1:L<2048?2:L<65536?3:4;for(V=w.uint8array?new Uint8Array(J):new Array(J),U=se=0;se<J;U++)55296==(64512&(L=oe.charCodeAt(U)))&&U+1<ue&&56320==(64512&(H=oe.charCodeAt(U+1)))&&(L=65536+(L-55296<<10)+(H-56320),U++),L<128?V[se++]=L:(L<2048?V[se++]=192|L>>>6:(L<65536?V[se++]=224|L>>>12:(V[se++]=240|L>>>18,V[se++]=128|L>>>12&63),V[se++]=128|L>>>6&63),V[se++]=128|63&L);return V}(F)},a.utf8decode=function(F){return w.nodebuffer?y.transformTo("nodebuffer",F).toString("utf-8"):function(oe){var V,L,H,U,se=oe.length,ue=new Array(2*se);for(V=L=0;V<se;)if((H=oe[V++])<128)ue[L++]=H;else if(4<(U=k[H]))ue[L++]=65533,V+=U-1;else{for(H&=2===U?31:3===U?15:7;1<U&&V<se;)H=H<<6|63&oe[V++],U--;1<U?ue[L++]=65533:H<65536?ue[L++]=H:(ue[L++]=55296|(H-=65536)>>10&1023,ue[L++]=56320|1023&H)}return ue.length!==L&&(ue.subarray?ue=ue.subarray(0,L):ue.length=L),y.applyFromCharCode(ue)}(F=y.transformTo(w.uint8array?"uint8array":"array",F))},y.inherits(D,u),D.prototype.processChunk=function(F){var oe=y.transformTo(w.uint8array?"uint8array":"array",F.data);if(this.leftOver&&this.leftOver.length){if(w.uint8array){var V=oe;(oe=new Uint8Array(V.length+this.leftOver.length)).set(this.leftOver,0),oe.set(V,this.leftOver.length)}else oe=this.leftOver.concat(oe);this.leftOver=null}var L=function(U,se){var ue;for((se=se||U.length)>U.length&&(se=U.length),ue=se-1;0<=ue&&128==(192&U[ue]);)ue--;return ue<0||0===ue?se:ue+k[U[ue]]>se?ue:se}(oe),H=oe;L!==oe.length&&(w.uint8array?(H=oe.subarray(0,L),this.leftOver=oe.subarray(L,oe.length)):(H=oe.slice(0,L),this.leftOver=oe.slice(L,oe.length))),this.push({data:a.utf8decode(H),meta:F.meta})},D.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:a.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},a.Utf8DecodeWorker=D,y.inherits(_,u),_.prototype.processChunk=function(F){this.push({data:a.utf8encode(F.data),meta:F.meta})},a.Utf8EncodeWorker=_},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(ae,Y,a){"use strict";var y=ae("./support"),w=ae("./base64"),p=ae("./nodejsUtils"),u=ae("./external");function k(V){return V}function v(V,L){for(var H=0;H<V.length;++H)L[H]=255&V.charCodeAt(H);return L}ae("setimmediate"),a.newBlob=function(V,L){a.checkSupport("blob");try{return new Blob([V],{type:L})}catch(U){try{var H=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return H.append(V),H.getBlob(L)}catch(se){throw new Error("Bug : can't construct the Blob.")}}};var D={stringifyByChunk:function(V,L,H){var U=[],se=0,ue=V.length;if(ue<=H)return String.fromCharCode.apply(null,V);for(;se<ue;)U.push(String.fromCharCode.apply(null,"array"===L||"nodebuffer"===L?V.slice(se,Math.min(se+H,ue)):V.subarray(se,Math.min(se+H,ue)))),se+=H;return U.join("")},stringifyByChar:function(V){for(var L="",H=0;H<V.length;H++)L+=String.fromCharCode(V[H]);return L},applyCanBeUsed:{uint8array:function(){try{return y.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch(V){return!1}}(),nodebuffer:function(){try{return y.nodebuffer&&1===String.fromCharCode.apply(null,p.allocBuffer(1)).length}catch(V){return!1}}()}};function _(V){var L=65536,H=a.getTypeOf(V),U=!0;if("uint8array"===H?U=D.applyCanBeUsed.uint8array:"nodebuffer"===H&&(U=D.applyCanBeUsed.nodebuffer),U)for(;1<L;)try{return D.stringifyByChunk(V,H,L)}catch(se){L=Math.floor(L/2)}return D.stringifyByChar(V)}function F(V,L){for(var H=0;H<V.length;H++)L[H]=V[H];return L}a.applyFromCharCode=_;var oe={};oe.string={string:k,array:function(V){return v(V,new Array(V.length))},arraybuffer:function(V){return oe.string.uint8array(V).buffer},uint8array:function(V){return v(V,new Uint8Array(V.length))},nodebuffer:function(V){return v(V,p.allocBuffer(V.length))}},oe.array={string:_,array:k,arraybuffer:function(V){return new Uint8Array(V).buffer},uint8array:function(V){return new Uint8Array(V)},nodebuffer:function(V){return p.newBufferFrom(V)}},oe.arraybuffer={string:function(V){return _(new Uint8Array(V))},array:function(V){return F(new Uint8Array(V),new Array(V.byteLength))},arraybuffer:k,uint8array:function(V){return new Uint8Array(V)},nodebuffer:function(V){return p.newBufferFrom(new Uint8Array(V))}},oe.uint8array={string:_,array:function(V){return F(V,new Array(V.length))},arraybuffer:function(V){return V.buffer},uint8array:k,nodebuffer:function(V){return p.newBufferFrom(V)}},oe.nodebuffer={string:_,array:function(V){return F(V,new Array(V.length))},arraybuffer:function(V){return oe.nodebuffer.uint8array(V).buffer},uint8array:function(V){return F(V,new Uint8Array(V.length))},nodebuffer:k},a.transformTo=function(V,L){if(L=L||"",!V)return L;a.checkSupport(V);var H=a.getTypeOf(L);return oe[H][V](L)},a.resolve=function(V){for(var L=V.split("/"),H=[],U=0;U<L.length;U++){var se=L[U];"."===se||""===se&&0!==U&&U!==L.length-1||(".."===se?H.pop():H.push(se))}return H.join("/")},a.getTypeOf=function(V){return"string"==typeof V?"string":"[object Array]"===Object.prototype.toString.call(V)?"array":y.nodebuffer&&p.isBuffer(V)?"nodebuffer":y.uint8array&&V instanceof Uint8Array?"uint8array":y.arraybuffer&&V instanceof ArrayBuffer?"arraybuffer":void 0},a.checkSupport=function(V){if(!y[V.toLowerCase()])throw new Error(V+" is not supported by this platform")},a.MAX_VALUE_16BITS=65535,a.MAX_VALUE_32BITS=-1,a.pretty=function(V){var L,H,U="";for(H=0;H<(V||"").length;H++)U+="\\x"+((L=V.charCodeAt(H))<16?"0":"")+L.toString(16).toUpperCase();return U},a.delay=function(V,L,H){setImmediate(function(){V.apply(H||null,L||[])})},a.inherits=function(V,L){function H(){}H.prototype=L.prototype,V.prototype=new H},a.extend=function(){var V,L,H={};for(V=0;V<arguments.length;V++)for(L in arguments[V])Object.prototype.hasOwnProperty.call(arguments[V],L)&&void 0===H[L]&&(H[L]=arguments[V][L]);return H},a.prepareContent=function(V,L,H,U,se){return u.Promise.resolve(L).then(function(ue){return y.blob&&(ue instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(ue)))&&"undefined"!=typeof FileReader?new u.Promise(function(J,K){var ee=new FileReader;ee.onload=function(M){J(M.target.result)},ee.onerror=function(M){K(M.target.error)},ee.readAsArrayBuffer(ue)}):ue}).then(function(ue){var K,J=a.getTypeOf(ue);return J?("arraybuffer"===J?ue=a.transformTo("uint8array",ue):"string"===J&&(se?ue=w.decode(ue):H&&!0!==U&&(ue=v(K=ue,y.uint8array?new Uint8Array(K.length):new Array(K.length)))),ue):u.Promise.reject(new Error("Can't read the data of '"+V+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(ae,Y,a){"use strict";var y=ae("./reader/readerFor"),w=ae("./utils"),p=ae("./signature"),u=ae("./zipEntry"),k=ae("./support");function v(D){this.files=[],this.loadOptions=D}v.prototype={checkSignature:function(D){if(!this.reader.readAndCheckSignature(D)){this.reader.index-=4;var _=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+w.pretty(_)+", expected "+w.pretty(D)+")")}},isSignature:function(D,_){var F=this.reader.index;this.reader.setIndex(D);var oe=this.reader.readString(4)===_;return this.reader.setIndex(F),oe},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var D=this.reader.readData(this.zipCommentLength),F=w.transformTo(k.uint8array?"uint8array":"array",D);this.zipComment=this.loadOptions.decodeFileName(F)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var D,_,F,oe=this.zip64EndOfCentralSize-44;0<oe;)D=this.reader.readInt(2),_=this.reader.readInt(4),F=this.reader.readData(_),this.zip64ExtensibleData[D]={id:D,length:_,value:F}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var D,_;for(D=0;D<this.files.length;D++)this.reader.setIndex((_=this.files[D]).localHeaderOffset),this.checkSignature(p.LOCAL_FILE_HEADER),_.readLocalPart(this.reader),_.handleUTF8(),_.processAttributes()},readCentralDir:function(){var D;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(p.CENTRAL_FILE_HEADER);)(D=new u({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(D);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var D=this.reader.lastIndexOfSignature(p.CENTRAL_DIRECTORY_END);if(D<0)throw this.isSignature(0,p.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(D);var _=D;if(this.checkSignature(p.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===w.MAX_VALUE_16BITS||this.diskWithCentralDirStart===w.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===w.MAX_VALUE_16BITS||this.centralDirRecords===w.MAX_VALUE_16BITS||this.centralDirSize===w.MAX_VALUE_32BITS||this.centralDirOffset===w.MAX_VALUE_32BITS){if(this.zip64=!0,(D=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(D),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,p.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(p.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var F=this.centralDirOffset+this.centralDirSize;this.zip64&&(F+=20,F+=12+this.zip64EndOfCentralSize);var oe=_-F;if(0<oe)this.isSignature(_,p.CENTRAL_FILE_HEADER)||(this.reader.zero=oe);else if(oe<0)throw new Error("Corrupted zip: missing "+Math.abs(oe)+" bytes.")},prepareReader:function(D){this.reader=y(D)},load:function(D){this.prepareReader(D),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},Y.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(ae,Y,a){"use strict";var y=ae("./reader/readerFor"),w=ae("./utils"),p=ae("./compressedObject"),u=ae("./crc32"),k=ae("./utf8"),v=ae("./compressions"),D=ae("./support");function _(F,oe){this.options=F,this.loadOptions=oe}_.prototype={isEncrypted:function(){return 1==(1&this.bitFlag)},useUTF8:function(){return 2048==(2048&this.bitFlag)},readLocalPart:function(F){var oe,V;if(F.skip(22),this.fileNameLength=F.readInt(2),V=F.readInt(2),this.fileName=F.readData(this.fileNameLength),F.skip(V),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(oe=function(L){for(var H in v)if(Object.prototype.hasOwnProperty.call(v,H)&&v[H].magic===L)return v[H];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+w.pretty(this.compressionMethod)+" unknown (inner file : "+w.transformTo("string",this.fileName)+")");this.decompressed=new p(this.compressedSize,this.uncompressedSize,this.crc32,oe,F.readData(this.compressedSize))},readCentralPart:function(F){this.versionMadeBy=F.readInt(2),F.skip(2),this.bitFlag=F.readInt(2),this.compressionMethod=F.readString(2),this.date=F.readDate(),this.crc32=F.readInt(4),this.compressedSize=F.readInt(4),this.uncompressedSize=F.readInt(4);var oe=F.readInt(2);if(this.extraFieldsLength=F.readInt(2),this.fileCommentLength=F.readInt(2),this.diskNumberStart=F.readInt(2),this.internalFileAttributes=F.readInt(2),this.externalFileAttributes=F.readInt(4),this.localHeaderOffset=F.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");F.skip(oe),this.readExtraFields(F),this.parseZIP64ExtraField(F),this.fileComment=F.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var F=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==F&&(this.dosPermissions=63&this.externalFileAttributes),3==F&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var F=y(this.extraFields[1].value);this.uncompressedSize===w.MAX_VALUE_32BITS&&(this.uncompressedSize=F.readInt(8)),this.compressedSize===w.MAX_VALUE_32BITS&&(this.compressedSize=F.readInt(8)),this.localHeaderOffset===w.MAX_VALUE_32BITS&&(this.localHeaderOffset=F.readInt(8)),this.diskNumberStart===w.MAX_VALUE_32BITS&&(this.diskNumberStart=F.readInt(4))}},readExtraFields:function(F){var oe,V,L,H=F.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});F.index+4<H;)oe=F.readInt(2),V=F.readInt(2),L=F.readData(V),this.extraFields[oe]={id:oe,length:V,value:L};F.setIndex(H)},handleUTF8:function(){var F=D.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=k.utf8decode(this.fileName),this.fileCommentStr=k.utf8decode(this.fileComment);else{var oe=this.findExtraFieldUnicodePath();if(null!==oe)this.fileNameStr=oe;else{var V=w.transformTo(F,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(V)}var L=this.findExtraFieldUnicodeComment();if(null!==L)this.fileCommentStr=L;else{var H=w.transformTo(F,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(H)}}},findExtraFieldUnicodePath:function(){var F=this.extraFields[28789];if(F){var oe=y(F.value);return 1!==oe.readInt(1)||u(this.fileName)!==oe.readInt(4)?null:k.utf8decode(oe.readData(F.length-5))}return null},findExtraFieldUnicodeComment:function(){var F=this.extraFields[25461];if(F){var oe=y(F.value);return 1!==oe.readInt(1)||u(this.fileComment)!==oe.readInt(4)?null:k.utf8decode(oe.readData(F.length-5))}return null}},Y.exports=_},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(ae,Y,a){"use strict";function y(oe,V,L){this.name=oe,this.dir=L.dir,this.date=L.date,this.comment=L.comment,this.unixPermissions=L.unixPermissions,this.dosPermissions=L.dosPermissions,this._data=V,this._dataBinary=L.binary,this.options={compression:L.compression,compressionOptions:L.compressionOptions}}var w=ae("./stream/StreamHelper"),p=ae("./stream/DataWorker"),u=ae("./utf8"),k=ae("./compressedObject"),v=ae("./stream/GenericWorker");y.prototype={internalStream:function(oe){var V=null,L="string";try{if(!oe)throw new Error("No output type specified.");var H="string"===(L=oe.toLowerCase())||"text"===L;"binarystring"!==L&&"text"!==L||(L="string"),V=this._decompressWorker();var U=!this._dataBinary;U&&!H&&(V=V.pipe(new u.Utf8EncodeWorker)),!U&&H&&(V=V.pipe(new u.Utf8DecodeWorker))}catch(se){(V=new v("error")).error(se)}return new w(V,L,"")},async:function(oe,V){return this.internalStream(oe).accumulate(V)},nodeStream:function(oe,V){return this.internalStream(oe||"nodebuffer").toNodejsStream(V)},_compressWorker:function(oe,V){if(this._data instanceof k&&this._data.compression.magic===oe.magic)return this._data.getCompressedWorker();var L=this._decompressWorker();return this._dataBinary||(L=L.pipe(new u.Utf8EncodeWorker)),k.createWorkerFrom(L,oe,V)},_decompressWorker:function(){return this._data instanceof k?this._data.getContentWorker():this._data instanceof v?this._data:new p(this._data)}};for(var D=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],_=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},F=0;F<D.length;F++)y.prototype[D[F]]=_;Y.exports=y},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(ae,Y,a){(function(y){"use strict";var w,p,u=y.MutationObserver||y.WebKitMutationObserver;if(u){var k=0,v=new u(oe),D=y.document.createTextNode("");v.observe(D,{characterData:!0}),w=function(){D.data=k=++k%2}}else if(y.setImmediate||void 0===y.MessageChannel)w="document"in y&&"onreadystatechange"in y.document.createElement("script")?function(){var V=y.document.createElement("script");V.onreadystatechange=function(){oe(),V.onreadystatechange=null,V.parentNode.removeChild(V),V=null},y.document.documentElement.appendChild(V)}:function(){setTimeout(oe,0)};else{var _=new y.MessageChannel;_.port1.onmessage=oe,w=function(){_.port2.postMessage(0)}}var F=[];function oe(){var V,L;p=!0;for(var H=F.length;H;){for(L=F,F=[],V=-1;++V<H;)L[V]();H=F.length}p=!1}Y.exports=function(V){1!==F.push(V)||p||w()}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],37:[function(ae,Y,a){"use strict";var y=ae("immediate");function w(){}var p={},u=["REJECTED"],k=["FULFILLED"],v=["PENDING"];function D(H){if("function"!=typeof H)throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,H!==w&&V(this,H)}function _(H,U,se){this.promise=H,"function"==typeof U&&(this.onFulfilled=U,this.callFulfilled=this.otherCallFulfilled),"function"==typeof se&&(this.onRejected=se,this.callRejected=this.otherCallRejected)}function F(H,U,se){y(function(){var ue;try{ue=U(se)}catch(J){return p.reject(H,J)}ue===H?p.reject(H,new TypeError("Cannot resolve promise with itself")):p.resolve(H,ue)})}function oe(H){var U=H&&H.then;if(H&&("object"==typeof H||"function"==typeof H)&&"function"==typeof U)return function(){U.apply(H,arguments)}}function V(H,U){var se=!1;function ue(ee){se||(se=!0,p.reject(H,ee))}function J(ee){se||(se=!0,p.resolve(H,ee))}var K=L(function(){U(J,ue)});"error"===K.status&&ue(K.value)}function L(H,U){var se={};try{se.value=H(U),se.status="success"}catch(ue){se.status="error",se.value=ue}return se}(Y.exports=D).prototype.finally=function(H){if("function"!=typeof H)return this;var U=this.constructor;return this.then(function(se){return U.resolve(H()).then(function(){return se})},function(se){return U.resolve(H()).then(function(){throw se})})},D.prototype.catch=function(H){return this.then(null,H)},D.prototype.then=function(H,U){if("function"!=typeof H&&this.state===k||"function"!=typeof U&&this.state===u)return this;var se=new this.constructor(w);return this.state!==v?F(se,this.state===k?H:U,this.outcome):this.queue.push(new _(se,H,U)),se},_.prototype.callFulfilled=function(H){p.resolve(this.promise,H)},_.prototype.otherCallFulfilled=function(H){F(this.promise,this.onFulfilled,H)},_.prototype.callRejected=function(H){p.reject(this.promise,H)},_.prototype.otherCallRejected=function(H){F(this.promise,this.onRejected,H)},p.resolve=function(H,U){var se=L(oe,U);if("error"===se.status)return p.reject(H,se.value);var ue=se.value;if(ue)V(H,ue);else{H.state=k,H.outcome=U;for(var J=-1,K=H.queue.length;++J<K;)H.queue[J].callFulfilled(U)}return H},p.reject=function(H,U){H.state=u,H.outcome=U;for(var se=-1,ue=H.queue.length;++se<ue;)H.queue[se].callRejected(U);return H},D.resolve=function(H){return H instanceof this?H:p.resolve(new this(w),H)},D.reject=function(H){var U=new this(w);return p.reject(U,H)},D.all=function(H){var U=this;if("[object Array]"!==Object.prototype.toString.call(H))return this.reject(new TypeError("must be an array"));var se=H.length,ue=!1;if(!se)return this.resolve([]);for(var J=new Array(se),K=0,ee=-1,M=new this(w);++ee<se;)G(H[ee],ee);return M;function G(z,A){U.resolve(z).then(function(N){J[A]=N,++K!==se||ue||(ue=!0,p.resolve(M,J))},function(N){ue||(ue=!0,p.reject(M,N))})}},D.race=function(H){if("[object Array]"!==Object.prototype.toString.call(H))return this.reject(new TypeError("must be an array"));var se=H.length,ue=!1;if(!se)return this.resolve([]);for(var J=-1,K=new this(w);++J<se;)this.resolve(H[J]).then(function(M){ue||(ue=!0,p.resolve(K,M))},function(M){ue||(ue=!0,p.reject(K,M))});return K}},{immediate:36}],38:[function(ae,Y,a){"use strict";var y={};(0,ae("./lib/utils/common").assign)(y,ae("./lib/deflate"),ae("./lib/inflate"),ae("./lib/zlib/constants")),Y.exports=y},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(ae,Y,a){"use strict";var y=ae("./zlib/deflate"),w=ae("./utils/common"),p=ae("./utils/strings"),u=ae("./zlib/messages"),k=ae("./zlib/zstream"),v=Object.prototype.toString;function V(H){if(!(this instanceof V))return new V(H);this.options=w.assign({level:-1,method:8,chunkSize:16384,windowBits:15,memLevel:8,strategy:0,to:""},H||{});var U=this.options;U.raw&&0<U.windowBits?U.windowBits=-U.windowBits:U.gzip&&0<U.windowBits&&U.windowBits<16&&(U.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new k,this.strm.avail_out=0;var se=y.deflateInit2(this.strm,U.level,U.method,U.windowBits,U.memLevel,U.strategy);if(0!==se)throw new Error(u[se]);if(U.header&&y.deflateSetHeader(this.strm,U.header),U.dictionary){var ue;if(ue="string"==typeof U.dictionary?p.string2buf(U.dictionary):"[object ArrayBuffer]"===v.call(U.dictionary)?new Uint8Array(U.dictionary):U.dictionary,0!==(se=y.deflateSetDictionary(this.strm,ue)))throw new Error(u[se]);this._dict_set=!0}}function L(H,U){var se=new V(U);if(se.push(H,!0),se.err)throw se.msg||u[se.err];return se.result}V.prototype.push=function(H,U){var se,ue,J=this.strm,K=this.options.chunkSize;if(this.ended)return!1;ue=U===~~U?U:!0===U?4:0,J.input="string"==typeof H?p.string2buf(H):"[object ArrayBuffer]"===v.call(H)?new Uint8Array(H):H,J.next_in=0,J.avail_in=J.input.length;do{if(0===J.avail_out&&(J.output=new w.Buf8(K),J.next_out=0,J.avail_out=K),1!==(se=y.deflate(J,ue))&&0!==se)return this.onEnd(se),!(this.ended=!0);0!==J.avail_out&&(0!==J.avail_in||4!==ue&&2!==ue)||this.onData("string"===this.options.to?p.buf2binstring(w.shrinkBuf(J.output,J.next_out)):w.shrinkBuf(J.output,J.next_out))}while((0<J.avail_in||0===J.avail_out)&&1!==se);return 4===ue?(se=y.deflateEnd(this.strm),this.onEnd(se),this.ended=!0,0===se):2!==ue||(this.onEnd(0),!(J.avail_out=0))},V.prototype.onData=function(H){this.chunks.push(H)},V.prototype.onEnd=function(H){0===H&&(this.result="string"===this.options.to?this.chunks.join(""):w.flattenChunks(this.chunks)),this.chunks=[],this.err=H,this.msg=this.strm.msg},a.Deflate=V,a.deflate=L,a.deflateRaw=function(H,U){return(U=U||{}).raw=!0,L(H,U)},a.gzip=function(H,U){return(U=U||{}).gzip=!0,L(H,U)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(ae,Y,a){"use strict";var y=ae("./zlib/inflate"),w=ae("./utils/common"),p=ae("./utils/strings"),u=ae("./zlib/constants"),k=ae("./zlib/messages"),v=ae("./zlib/zstream"),D=ae("./zlib/gzheader"),_=Object.prototype.toString;function F(V){if(!(this instanceof F))return new F(V);this.options=w.assign({chunkSize:16384,windowBits:0,to:""},V||{});var L=this.options;L.raw&&0<=L.windowBits&&L.windowBits<16&&(L.windowBits=-L.windowBits,0===L.windowBits&&(L.windowBits=-15)),!(0<=L.windowBits&&L.windowBits<16)||V&&V.windowBits||(L.windowBits+=32),15<L.windowBits&&L.windowBits<48&&0==(15&L.windowBits)&&(L.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var H=y.inflateInit2(this.strm,L.windowBits);if(H!==u.Z_OK)throw new Error(k[H]);this.header=new D,y.inflateGetHeader(this.strm,this.header)}function oe(V,L){var H=new F(L);if(H.push(V,!0),H.err)throw H.msg||k[H.err];return H.result}F.prototype.push=function(V,L){var H,U,se,ue,J,K,ee=this.strm,M=this.options.chunkSize,G=this.options.dictionary,z=!1;if(this.ended)return!1;U=L===~~L?L:!0===L?u.Z_FINISH:u.Z_NO_FLUSH,ee.input="string"==typeof V?p.binstring2buf(V):"[object ArrayBuffer]"===_.call(V)?new Uint8Array(V):V,ee.next_in=0,ee.avail_in=ee.input.length;do{if(0===ee.avail_out&&(ee.output=new w.Buf8(M),ee.next_out=0,ee.avail_out=M),(H=y.inflate(ee,u.Z_NO_FLUSH))===u.Z_NEED_DICT&&G&&(K="string"==typeof G?p.string2buf(G):"[object ArrayBuffer]"===_.call(G)?new Uint8Array(G):G,H=y.inflateSetDictionary(this.strm,K)),H===u.Z_BUF_ERROR&&!0===z&&(H=u.Z_OK,z=!1),H!==u.Z_STREAM_END&&H!==u.Z_OK)return this.onEnd(H),!(this.ended=!0);ee.next_out&&(0!==ee.avail_out&&H!==u.Z_STREAM_END&&(0!==ee.avail_in||U!==u.Z_FINISH&&U!==u.Z_SYNC_FLUSH)||("string"===this.options.to?(se=p.utf8border(ee.output,ee.next_out),ue=ee.next_out-se,J=p.buf2string(ee.output,se),ee.next_out=ue,ee.avail_out=M-ue,ue&&w.arraySet(ee.output,ee.output,se,ue,0),this.onData(J)):this.onData(w.shrinkBuf(ee.output,ee.next_out)))),0===ee.avail_in&&0===ee.avail_out&&(z=!0)}while((0<ee.avail_in||0===ee.avail_out)&&H!==u.Z_STREAM_END);return H===u.Z_STREAM_END&&(U=u.Z_FINISH),U===u.Z_FINISH?(H=y.inflateEnd(this.strm),this.onEnd(H),this.ended=!0,H===u.Z_OK):U!==u.Z_SYNC_FLUSH||(this.onEnd(u.Z_OK),!(ee.avail_out=0))},F.prototype.onData=function(V){this.chunks.push(V)},F.prototype.onEnd=function(V){V===u.Z_OK&&(this.result="string"===this.options.to?this.chunks.join(""):w.flattenChunks(this.chunks)),this.chunks=[],this.err=V,this.msg=this.strm.msg},a.Inflate=F,a.inflate=oe,a.inflateRaw=function(V,L){return(L=L||{}).raw=!0,oe(V,L)},a.ungzip=oe},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(ae,Y,a){"use strict";var y="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;a.assign=function(u){for(var k=Array.prototype.slice.call(arguments,1);k.length;){var v=k.shift();if(v){if("object"!=typeof v)throw new TypeError(v+"must be non-object");for(var D in v)v.hasOwnProperty(D)&&(u[D]=v[D])}}return u},a.shrinkBuf=function(u,k){return u.length===k?u:u.subarray?u.subarray(0,k):(u.length=k,u)};var w={arraySet:function(u,k,v,D,_){if(k.subarray&&u.subarray)u.set(k.subarray(v,v+D),_);else for(var F=0;F<D;F++)u[_+F]=k[v+F]},flattenChunks:function(u){var k,v,D,_,F,oe;for(k=D=0,v=u.length;k<v;k++)D+=u[k].length;for(oe=new Uint8Array(D),k=_=0,v=u.length;k<v;k++)oe.set(F=u[k],_),_+=F.length;return oe}},p={arraySet:function(u,k,v,D,_){for(var F=0;F<D;F++)u[_+F]=k[v+F]},flattenChunks:function(u){return[].concat.apply([],u)}};a.setTyped=function(u){u?(a.Buf8=Uint8Array,a.Buf16=Uint16Array,a.Buf32=Int32Array,a.assign(a,w)):(a.Buf8=Array,a.Buf16=Array,a.Buf32=Array,a.assign(a,p))},a.setTyped(y)},{}],42:[function(ae,Y,a){"use strict";var y=ae("./common"),w=!0,p=!0;try{String.fromCharCode.apply(null,[0])}catch(D){w=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(D){p=!1}for(var u=new y.Buf8(256),k=0;k<256;k++)u[k]=252<=k?6:248<=k?5:240<=k?4:224<=k?3:192<=k?2:1;function v(D,_){if(_<65537&&(D.subarray&&p||!D.subarray&&w))return String.fromCharCode.apply(null,y.shrinkBuf(D,_));for(var F="",oe=0;oe<_;oe++)F+=String.fromCharCode(D[oe]);return F}u[254]=u[254]=1,a.string2buf=function(D){var _,F,oe,V,L,H=D.length,U=0;for(V=0;V<H;V++)55296==(64512&(F=D.charCodeAt(V)))&&V+1<H&&56320==(64512&(oe=D.charCodeAt(V+1)))&&(F=65536+(F-55296<<10)+(oe-56320),V++),U+=F<128?1:F<2048?2:F<65536?3:4;for(_=new y.Buf8(U),V=L=0;L<U;V++)55296==(64512&(F=D.charCodeAt(V)))&&V+1<H&&56320==(64512&(oe=D.charCodeAt(V+1)))&&(F=65536+(F-55296<<10)+(oe-56320),V++),F<128?_[L++]=F:(F<2048?_[L++]=192|F>>>6:(F<65536?_[L++]=224|F>>>12:(_[L++]=240|F>>>18,_[L++]=128|F>>>12&63),_[L++]=128|F>>>6&63),_[L++]=128|63&F);return _},a.buf2binstring=function(D){return v(D,D.length)},a.binstring2buf=function(D){for(var _=new y.Buf8(D.length),F=0,oe=_.length;F<oe;F++)_[F]=D.charCodeAt(F);return _},a.buf2string=function(D,_){var F,oe,V,L,H=_||D.length,U=new Array(2*H);for(F=oe=0;F<H;)if((V=D[F++])<128)U[oe++]=V;else if(4<(L=u[V]))U[oe++]=65533,F+=L-1;else{for(V&=2===L?31:3===L?15:7;1<L&&F<H;)V=V<<6|63&D[F++],L--;1<L?U[oe++]=65533:V<65536?U[oe++]=V:(U[oe++]=55296|(V-=65536)>>10&1023,U[oe++]=56320|1023&V)}return v(U,oe)},a.utf8border=function(D,_){var F;for((_=_||D.length)>D.length&&(_=D.length),F=_-1;0<=F&&128==(192&D[F]);)F--;return F<0||0===F?_:F+u[D[F]]>_?F:_}},{"./common":41}],43:[function(ae,Y,a){"use strict";Y.exports=function(y,w,p,u){for(var k=65535&y|0,v=y>>>16&65535|0,D=0;0!==p;){for(p-=D=2e3<p?2e3:p;v=v+(k=k+w[u++]|0)|0,--D;);k%=65521,v%=65521}return k|v<<16|0}},{}],44:[function(ae,Y,a){"use strict";Y.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(ae,Y,a){"use strict";var y=function(){for(var w,p=[],u=0;u<256;u++){w=u;for(var k=0;k<8;k++)w=1&w?3988292384^w>>>1:w>>>1;p[u]=w}return p}();Y.exports=function(w,p,u,k){var v=y,D=k+u;w^=-1;for(var _=k;_<D;_++)w=w>>>8^v[255&(w^p[_])];return-1^w}},{}],46:[function(ae,Y,a){"use strict";var y,w=ae("../utils/common"),p=ae("./trees"),u=ae("./adler32"),k=ae("./crc32"),v=ae("./messages"),z=258,A=262,P=113;function c(ce,he){return ce.msg=v[he],he}function l(ce){return(ce<<1)-(4<ce?9:0)}function f(ce){for(var he=ce.length;0<=--he;)ce[he]=0}function m(ce){var he=ce.state,B=he.pending;B>ce.avail_out&&(B=ce.avail_out),0!==B&&(w.arraySet(ce.output,he.pending_buf,he.pending_out,B,ce.next_out),ce.next_out+=B,he.pending_out+=B,ce.total_out+=B,ce.avail_out-=B,he.pending-=B,0===he.pending&&(he.pending_out=0))}function x(ce,he){p._tr_flush_block(ce,0<=ce.block_start?ce.block_start:-1,ce.strstart-ce.block_start,he),ce.block_start=ce.strstart,m(ce.strm)}function S(ce,he){ce.pending_buf[ce.pending++]=he}function Z(ce,he){ce.pending_buf[ce.pending++]=he>>>8&255,ce.pending_buf[ce.pending++]=255&he}function le(ce,he){var B,O,ne=ce.max_chain_length,q=ce.strstart,pe=ce.prev_length,$e=ce.nice_match,me=ce.strstart>ce.w_size-A?ce.strstart-(ce.w_size-A):0,Te=ce.window,De=ce.w_mask,Me=ce.prev,Pe=ce.strstart+z,Ve=Te[q+pe-1],Qe=Te[q+pe];ce.prev_length>=ce.good_match&&(ne>>=2),$e>ce.lookahead&&($e=ce.lookahead);do{if(Te[(B=he)+pe]===Qe&&Te[B+pe-1]===Ve&&Te[B]===Te[q]&&Te[++B]===Te[q+1]){q+=2,B++;do{}while(Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&Te[++q]===Te[++B]&&q<Pe);if(O=z-(Pe-q),q=Pe-z,pe<O){if(ce.match_start=he,$e<=(pe=O))break;Ve=Te[q+pe-1],Qe=Te[q+pe]}}}while((he=Me[he&De])>me&&0!=--ne);return pe<=ce.lookahead?pe:ce.lookahead}function ye(ce){var he,B,O,ne,q,pe,$e,me,Te,De,Me=ce.w_size;do{if(ne=ce.window_size-ce.lookahead-ce.strstart,ce.strstart>=Me+(Me-A)){for(w.arraySet(ce.window,ce.window,Me,Me,0),ce.match_start-=Me,ce.strstart-=Me,ce.block_start-=Me,he=B=ce.hash_size;O=ce.head[--he],ce.head[he]=Me<=O?O-Me:0,--B;);for(he=B=Me;O=ce.prev[--he],ce.prev[he]=Me<=O?O-Me:0,--B;);ne+=Me}if(0===ce.strm.avail_in)break;if($e=ce.window,me=ce.strstart+ce.lookahead,De=void 0,(Te=ne)<(De=(pe=ce.strm).avail_in)&&(De=Te),B=0===De?0:(pe.avail_in-=De,w.arraySet($e,pe.input,pe.next_in,De,me),1===pe.state.wrap?pe.adler=u(pe.adler,$e,De,me):2===pe.state.wrap&&(pe.adler=k(pe.adler,$e,De,me)),pe.next_in+=De,pe.total_in+=De,De),ce.lookahead+=B,ce.lookahead+ce.insert>=3)for(ce.ins_h=ce.window[q=ce.strstart-ce.insert],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[q+1])&ce.hash_mask;ce.insert&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[q+3-1])&ce.hash_mask,ce.prev[q&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=q,q++,ce.insert--,!(ce.lookahead+ce.insert<3)););}while(ce.lookahead<A&&0!==ce.strm.avail_in)}function T(ce,he){for(var B,O;;){if(ce.lookahead<A){if(ye(ce),ce.lookahead<A&&0===he)return 1;if(0===ce.lookahead)break}if(B=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!==B&&ce.strstart-B<=ce.w_size-A&&(ce.match_length=le(ce,B)),ce.match_length>=3)if(O=p._tr_tally(ce,ce.strstart-ce.match_start,ce.match_length-3),ce.lookahead-=ce.match_length,ce.match_length<=ce.max_lazy_match&&ce.lookahead>=3){for(ce.match_length--;ce.strstart++,ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart,0!=--ce.match_length;);ce.strstart++}else ce.strstart+=ce.match_length,ce.match_length=0,ce.ins_h=ce.window[ce.strstart],ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+1])&ce.hash_mask;else O=p._tr_tally(ce,0,ce.window[ce.strstart]),ce.lookahead--,ce.strstart++;if(O&&(x(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=ce.strstart<2?ce.strstart:2,4===he?(x(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(x(ce,!1),0===ce.strm.avail_out)?1:2}function R(ce,he){for(var B,O,ne;;){if(ce.lookahead<A){if(ye(ce),ce.lookahead<A&&0===he)return 1;if(0===ce.lookahead)break}if(B=0,ce.lookahead>=3&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),ce.prev_length=ce.match_length,ce.prev_match=ce.match_start,ce.match_length=2,0!==B&&ce.prev_length<ce.max_lazy_match&&ce.strstart-B<=ce.w_size-A&&(ce.match_length=le(ce,B),ce.match_length<=5&&(1===ce.strategy||3===ce.match_length&&4096<ce.strstart-ce.match_start)&&(ce.match_length=2)),ce.prev_length>=3&&ce.match_length<=ce.prev_length){for(ne=ce.strstart+ce.lookahead-3,O=p._tr_tally(ce,ce.strstart-1-ce.prev_match,ce.prev_length-3),ce.lookahead-=ce.prev_length-1,ce.prev_length-=2;++ce.strstart<=ne&&(ce.ins_h=(ce.ins_h<<ce.hash_shift^ce.window[ce.strstart+3-1])&ce.hash_mask,B=ce.prev[ce.strstart&ce.w_mask]=ce.head[ce.ins_h],ce.head[ce.ins_h]=ce.strstart),0!=--ce.prev_length;);if(ce.match_available=0,ce.match_length=2,ce.strstart++,O&&(x(ce,!1),0===ce.strm.avail_out))return 1}else if(ce.match_available){if((O=p._tr_tally(ce,0,ce.window[ce.strstart-1]))&&x(ce,!1),ce.strstart++,ce.lookahead--,0===ce.strm.avail_out)return 1}else ce.match_available=1,ce.strstart++,ce.lookahead--}return ce.match_available&&(O=p._tr_tally(ce,0,ce.window[ce.strstart-1]),ce.match_available=0),ce.insert=ce.strstart<2?ce.strstart:2,4===he?(x(ce,!0),0===ce.strm.avail_out?3:4):ce.last_lit&&(x(ce,!1),0===ce.strm.avail_out)?1:2}function ie(ce,he,B,O,ne){this.good_length=ce,this.max_lazy=he,this.nice_length=B,this.max_chain=O,this.func=ne}function j(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new w.Buf16(1146),this.dyn_dtree=new w.Buf16(122),this.bl_tree=new w.Buf16(78),f(this.dyn_ltree),f(this.dyn_dtree),f(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new w.Buf16(16),this.heap=new w.Buf16(573),f(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new w.Buf16(573),f(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function ve(ce){var he;return ce&&ce.state?(ce.total_in=ce.total_out=0,ce.data_type=2,(he=ce.state).pending=0,he.pending_out=0,he.wrap<0&&(he.wrap=-he.wrap),he.status=he.wrap?42:P,ce.adler=2===he.wrap?0:1,he.last_flush=0,p._tr_init(he),0):c(ce,-2)}function de(ce){var B,he=ve(ce);return 0===he&&((B=ce.state).window_size=2*B.w_size,f(B.head),B.max_lazy_match=y[B.level].max_lazy,B.good_match=y[B.level].good_length,B.nice_match=y[B.level].nice_length,B.max_chain_length=y[B.level].max_chain,B.strstart=0,B.block_start=0,B.lookahead=0,B.insert=0,B.match_length=B.prev_length=2,B.match_available=0,B.ins_h=0),he}function we(ce,he,B,O,ne,q){if(!ce)return-2;var pe=1;if(-1===he&&(he=6),O<0?(pe=0,O=-O):15<O&&(pe=2,O-=16),ne<1||9<ne||8!==B||O<8||15<O||he<0||9<he||q<0||4<q)return c(ce,-2);8===O&&(O=9);var $e=new j;return(ce.state=$e).strm=ce,$e.wrap=pe,$e.gzhead=null,$e.w_bits=O,$e.w_size=1<<$e.w_bits,$e.w_mask=$e.w_size-1,$e.hash_bits=ne+7,$e.hash_size=1<<$e.hash_bits,$e.hash_mask=$e.hash_size-1,$e.hash_shift=~~(($e.hash_bits+3-1)/3),$e.window=new w.Buf8(2*$e.w_size),$e.head=new w.Buf16($e.hash_size),$e.prev=new w.Buf16($e.w_size),$e.lit_bufsize=1<<ne+6,$e.pending_buf_size=4*$e.lit_bufsize,$e.pending_buf=new w.Buf8($e.pending_buf_size),$e.d_buf=1*$e.lit_bufsize,$e.l_buf=3*$e.lit_bufsize,$e.level=he,$e.strategy=q,$e.method=B,de(ce)}y=[new ie(0,0,0,0,function(ce,he){var B=65535;for(B>ce.pending_buf_size-5&&(B=ce.pending_buf_size-5);;){if(ce.lookahead<=1){if(ye(ce),0===ce.lookahead&&0===he)return 1;if(0===ce.lookahead)break}ce.strstart+=ce.lookahead,ce.lookahead=0;var O=ce.block_start+B;if((0===ce.strstart||ce.strstart>=O)&&(ce.lookahead=ce.strstart-O,ce.strstart=O,x(ce,!1),0===ce.strm.avail_out)||ce.strstart-ce.block_start>=ce.w_size-A&&(x(ce,!1),0===ce.strm.avail_out))return 1}return ce.insert=0,4===he?(x(ce,!0),0===ce.strm.avail_out?3:4):(ce.strstart>ce.block_start&&x(ce,!1),1)}),new ie(4,4,8,4,T),new ie(4,5,16,8,T),new ie(4,6,32,32,T),new ie(4,4,16,16,R),new ie(8,16,32,32,R),new ie(8,16,128,128,R),new ie(8,32,128,256,R),new ie(32,128,258,1024,R),new ie(32,258,258,4096,R)],a.deflateInit=function(ce,he){return we(ce,he,8,15,8,0)},a.deflateInit2=we,a.deflateReset=de,a.deflateResetKeep=ve,a.deflateSetHeader=function(ce,he){return ce&&ce.state?2!==ce.state.wrap?-2:(ce.state.gzhead=he,0):-2},a.deflate=function(ce,he){var B,O,ne,q;if(!ce||!ce.state||5<he||he<0)return ce?c(ce,-2):-2;if(O=ce.state,!ce.output||!ce.input&&0!==ce.avail_in||666===O.status&&4!==he)return c(ce,0===ce.avail_out?-5:-2);if(O.strm=ce,B=O.last_flush,O.last_flush=he,42===O.status)if(2===O.wrap)ce.adler=0,S(O,31),S(O,139),S(O,8),O.gzhead?(S(O,(O.gzhead.text?1:0)+(O.gzhead.hcrc?2:0)+(O.gzhead.extra?4:0)+(O.gzhead.name?8:0)+(O.gzhead.comment?16:0)),S(O,255&O.gzhead.time),S(O,O.gzhead.time>>8&255),S(O,O.gzhead.time>>16&255),S(O,O.gzhead.time>>24&255),S(O,9===O.level?2:2<=O.strategy||O.level<2?4:0),S(O,255&O.gzhead.os),O.gzhead.extra&&O.gzhead.extra.length&&(S(O,255&O.gzhead.extra.length),S(O,O.gzhead.extra.length>>8&255)),O.gzhead.hcrc&&(ce.adler=k(ce.adler,O.pending_buf,O.pending,0)),O.gzindex=0,O.status=69):(S(O,0),S(O,0),S(O,0),S(O,0),S(O,0),S(O,9===O.level?2:2<=O.strategy||O.level<2?4:0),S(O,3),O.status=P);else{var pe=8+(O.w_bits-8<<4)<<8;pe|=(2<=O.strategy||O.level<2?0:O.level<6?1:6===O.level?2:3)<<6,0!==O.strstart&&(pe|=32),pe+=31-pe%31,O.status=P,Z(O,pe),0!==O.strstart&&(Z(O,ce.adler>>>16),Z(O,65535&ce.adler)),ce.adler=1}if(69===O.status)if(O.gzhead.extra){for(ne=O.pending;O.gzindex<(65535&O.gzhead.extra.length)&&(O.pending!==O.pending_buf_size||(O.gzhead.hcrc&&O.pending>ne&&(ce.adler=k(ce.adler,O.pending_buf,O.pending-ne,ne)),m(ce),ne=O.pending,O.pending!==O.pending_buf_size));)S(O,255&O.gzhead.extra[O.gzindex]),O.gzindex++;O.gzhead.hcrc&&O.pending>ne&&(ce.adler=k(ce.adler,O.pending_buf,O.pending-ne,ne)),O.gzindex===O.gzhead.extra.length&&(O.gzindex=0,O.status=73)}else O.status=73;if(73===O.status)if(O.gzhead.name){ne=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>ne&&(ce.adler=k(ce.adler,O.pending_buf,O.pending-ne,ne)),m(ce),ne=O.pending,O.pending===O.pending_buf_size)){q=1;break}q=O.gzindex<O.gzhead.name.length?255&O.gzhead.name.charCodeAt(O.gzindex++):0,S(O,q)}while(0!==q);O.gzhead.hcrc&&O.pending>ne&&(ce.adler=k(ce.adler,O.pending_buf,O.pending-ne,ne)),0===q&&(O.gzindex=0,O.status=91)}else O.status=91;if(91===O.status)if(O.gzhead.comment){ne=O.pending;do{if(O.pending===O.pending_buf_size&&(O.gzhead.hcrc&&O.pending>ne&&(ce.adler=k(ce.adler,O.pending_buf,O.pending-ne,ne)),m(ce),ne=O.pending,O.pending===O.pending_buf_size)){q=1;break}q=O.gzindex<O.gzhead.comment.length?255&O.gzhead.comment.charCodeAt(O.gzindex++):0,S(O,q)}while(0!==q);O.gzhead.hcrc&&O.pending>ne&&(ce.adler=k(ce.adler,O.pending_buf,O.pending-ne,ne)),0===q&&(O.status=103)}else O.status=103;if(103===O.status&&(O.gzhead.hcrc?(O.pending+2>O.pending_buf_size&&m(ce),O.pending+2<=O.pending_buf_size&&(S(O,255&ce.adler),S(O,ce.adler>>8&255),ce.adler=0,O.status=P)):O.status=P),0!==O.pending){if(m(ce),0===ce.avail_out)return O.last_flush=-1,0}else if(0===ce.avail_in&&l(he)<=l(B)&&4!==he)return c(ce,-5);if(666===O.status&&0!==ce.avail_in)return c(ce,-5);if(0!==ce.avail_in||0!==O.lookahead||0!==he&&666!==O.status){var $e=2===O.strategy?function(me,Te){for(var De;;){if(0===me.lookahead&&(ye(me),0===me.lookahead)){if(0===Te)return 1;break}if(me.match_length=0,De=p._tr_tally(me,0,me.window[me.strstart]),me.lookahead--,me.strstart++,De&&(x(me,!1),0===me.strm.avail_out))return 1}return me.insert=0,4===Te?(x(me,!0),0===me.strm.avail_out?3:4):me.last_lit&&(x(me,!1),0===me.strm.avail_out)?1:2}(O,he):3===O.strategy?function(me,Te){for(var De,Me,Pe,Ve,Qe=me.window;;){if(me.lookahead<=z){if(ye(me),me.lookahead<=z&&0===Te)return 1;if(0===me.lookahead)break}if(me.match_length=0,me.lookahead>=3&&0<me.strstart&&(Me=Qe[Pe=me.strstart-1])===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]){Ve=me.strstart+z;do{}while(Me===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]&&Me===Qe[++Pe]&&Pe<Ve);me.match_length=z-(Ve-Pe),me.match_length>me.lookahead&&(me.match_length=me.lookahead)}if(me.match_length>=3?(De=p._tr_tally(me,1,me.match_length-3),me.lookahead-=me.match_length,me.strstart+=me.match_length,me.match_length=0):(De=p._tr_tally(me,0,me.window[me.strstart]),me.lookahead--,me.strstart++),De&&(x(me,!1),0===me.strm.avail_out))return 1}return me.insert=0,4===Te?(x(me,!0),0===me.strm.avail_out?3:4):me.last_lit&&(x(me,!1),0===me.strm.avail_out)?1:2}(O,he):y[O.level].func(O,he);if(3!==$e&&4!==$e||(O.status=666),1===$e||3===$e)return 0===ce.avail_out&&(O.last_flush=-1),0;if(2===$e&&(1===he?p._tr_align(O):5!==he&&(p._tr_stored_block(O,0,0,!1),3===he&&(f(O.head),0===O.lookahead&&(O.strstart=0,O.block_start=0,O.insert=0))),m(ce),0===ce.avail_out))return O.last_flush=-1,0}return 4!==he?0:O.wrap<=0?1:(2===O.wrap?(S(O,255&ce.adler),S(O,ce.adler>>8&255),S(O,ce.adler>>16&255),S(O,ce.adler>>24&255),S(O,255&ce.total_in),S(O,ce.total_in>>8&255),S(O,ce.total_in>>16&255),S(O,ce.total_in>>24&255)):(Z(O,ce.adler>>>16),Z(O,65535&ce.adler)),m(ce),0<O.wrap&&(O.wrap=-O.wrap),0!==O.pending?0:1)},a.deflateEnd=function(ce){var he;return ce&&ce.state?42!==(he=ce.state.status)&&69!==he&&73!==he&&91!==he&&103!==he&&he!==P&&666!==he?c(ce,-2):(ce.state=null,he===P?c(ce,-3):0):-2},a.deflateSetDictionary=function(ce,he){var B,O,ne,q,pe,$e,me,Te,De=he.length;if(!ce||!ce.state||2===(q=(B=ce.state).wrap)||1===q&&42!==B.status||B.lookahead)return-2;for(1===q&&(ce.adler=u(ce.adler,he,De,0)),B.wrap=0,De>=B.w_size&&(0===q&&(f(B.head),B.strstart=0,B.block_start=0,B.insert=0),Te=new w.Buf8(B.w_size),w.arraySet(Te,he,De-B.w_size,B.w_size,0),he=Te,De=B.w_size),pe=ce.avail_in,$e=ce.next_in,me=ce.input,ce.avail_in=De,ce.next_in=0,ce.input=he,ye(B);B.lookahead>=3;){for(O=B.strstart,ne=B.lookahead-2;B.ins_h=(B.ins_h<<B.hash_shift^B.window[O+3-1])&B.hash_mask,B.prev[O&B.w_mask]=B.head[B.ins_h],B.head[B.ins_h]=O,O++,--ne;);B.strstart=O,B.lookahead=2,ye(B)}return B.strstart+=B.lookahead,B.block_start=B.strstart,B.insert=B.lookahead,B.lookahead=0,B.match_length=B.prev_length=2,B.match_available=0,ce.next_in=$e,ce.input=me,ce.avail_in=pe,B.wrap=q,0},a.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(ae,Y,a){"use strict";Y.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(ae,Y,a){"use strict";Y.exports=function(y,w){var p,u,k,v,D,_,F,oe,V,L,H,U,se,ue,J,K,ee,M,G,z,A,N,P,g,b;g=y.input,k=(u=y.next_in)+(y.avail_in-5),b=y.output,D=(v=y.next_out)-(w-y.avail_out),_=v+(y.avail_out-257),F=(p=y.state).dmax,oe=p.wsize,V=p.whave,L=p.wnext,H=p.window,U=p.hold,se=p.bits,ue=p.lencode,J=p.distcode,K=(1<<p.lenbits)-1,ee=(1<<p.distbits)-1;e:do{se<15&&(U+=g[u++]<<se,U+=g[u++]<<(se+=8),se+=8),M=ue[U&K];t:for(;;){if(U>>>=G=M>>>24,se-=G,0==(G=M>>>16&255))b[v++]=65535&M;else{if(!(16&G)){if(0==(64&G)){M=ue[(65535&M)+(U&(1<<G)-1)];continue t}if(32&G){p.mode=12;break e}y.msg="invalid literal/length code",p.mode=30;break e}z=65535&M,(G&=15)&&(se<G&&(U+=g[u++]<<se,se+=8),z+=U&(1<<G)-1,U>>>=G,se-=G),se<15&&(U+=g[u++]<<se,U+=g[u++]<<(se+=8),se+=8),M=J[U&ee];n:for(;;){if(U>>>=G=M>>>24,se-=G,!(16&(G=M>>>16&255))){if(0==(64&G)){M=J[(65535&M)+(U&(1<<G)-1)];continue n}y.msg="invalid distance code",p.mode=30;break e}if(A=65535&M,se<(G&=15)&&(U+=g[u++]<<se,(se+=8)<G&&(U+=g[u++]<<se,se+=8)),F<(A+=U&(1<<G)-1)){y.msg="invalid distance too far back",p.mode=30;break e}if(U>>>=G,se-=G,(G=v-D)<A){if(V<(G=A-G)&&p.sane){y.msg="invalid distance too far back",p.mode=30;break e}if(P=H,(N=0)===L){if(N+=oe-G,G<z){for(z-=G;b[v++]=H[N++],--G;);N=v-A,P=b}}else if(L<G){if(N+=oe+L-G,(G-=L)<z){for(z-=G;b[v++]=H[N++],--G;);if(N=0,L<z){for(z-=G=L;b[v++]=H[N++],--G;);N=v-A,P=b}}}else if(N+=L-G,G<z){for(z-=G;b[v++]=H[N++],--G;);N=v-A,P=b}for(;2<z;)b[v++]=P[N++],b[v++]=P[N++],b[v++]=P[N++],z-=3;z&&(b[v++]=P[N++],1<z&&(b[v++]=P[N++]))}else{for(N=v-A;b[v++]=b[N++],b[v++]=b[N++],b[v++]=b[N++],2<(z-=3););z&&(b[v++]=b[N++],1<z&&(b[v++]=b[N++]))}break}}break}}while(u<k&&v<_);u-=z=se>>3,U&=(1<<(se-=z<<3))-1,y.next_in=u,y.next_out=v,y.avail_in=u<k?k-u+5:5-(u-k),y.avail_out=v<_?_-v+257:257-(v-_),p.hold=U,p.bits=se}},{}],49:[function(ae,Y,a){"use strict";var y=ae("../utils/common"),w=ae("./adler32"),p=ae("./crc32"),u=ae("./inffast"),k=ae("./inftrees"),F=-2;function H(N){return(N>>>24&255)+(N>>>8&65280)+((65280&N)<<8)+((255&N)<<24)}function U(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new y.Buf16(320),this.work=new y.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function se(N){var P;return N&&N.state?(N.total_in=N.total_out=(P=N.state).total=0,N.msg="",P.wrap&&(N.adler=1&P.wrap),P.mode=1,P.last=0,P.havedict=0,P.dmax=32768,P.head=null,P.hold=0,P.bits=0,P.lencode=P.lendyn=new y.Buf32(852),P.distcode=P.distdyn=new y.Buf32(592),P.sane=1,P.back=-1,0):F}function ue(N){var P;return N&&N.state?((P=N.state).wsize=0,P.whave=0,P.wnext=0,se(N)):F}function J(N,P){var g,b;return N&&N.state?(b=N.state,P<0?(g=0,P=-P):(g=1+(P>>4),P<48&&(P&=15)),P&&(P<8||15<P)?F:(null!==b.window&&b.wbits!==P&&(b.window=null),b.wrap=g,b.wbits=P,ue(N))):F}function K(N,P){var g,b;return N?(b=new U,(N.state=b).window=null,0!==(g=J(N,P))&&(N.state=null),g):F}var ee,M,G=!0;function z(N){if(G){var P;for(ee=new y.Buf32(512),M=new y.Buf32(32),P=0;P<144;)N.lens[P++]=8;for(;P<256;)N.lens[P++]=9;for(;P<280;)N.lens[P++]=7;for(;P<288;)N.lens[P++]=8;for(k(1,N.lens,0,288,ee,0,N.work,{bits:9}),P=0;P<32;)N.lens[P++]=5;k(2,N.lens,0,32,M,0,N.work,{bits:5}),G=!1}N.lencode=ee,N.lenbits=9,N.distcode=M,N.distbits=5}function A(N,P,g,b){var C,h=N.state;return null===h.window&&(h.wsize=1<<h.wbits,h.wnext=0,h.whave=0,h.window=new y.Buf8(h.wsize)),b>=h.wsize?(y.arraySet(h.window,P,g-h.wsize,h.wsize,0),h.wnext=0,h.whave=h.wsize):(b<(C=h.wsize-h.wnext)&&(C=b),y.arraySet(h.window,P,g-b,C,h.wnext),(b-=C)?(y.arraySet(h.window,P,g-b,b,0),h.wnext=b,h.whave=h.wsize):(h.wnext+=C,h.wnext===h.wsize&&(h.wnext=0),h.whave<h.wsize&&(h.whave+=C))),0}a.inflateReset=ue,a.inflateReset2=J,a.inflateResetKeep=se,a.inflateInit=function(N){return K(N,15)},a.inflateInit2=K,a.inflate=function(N,P){var g,b,C,h,c,l,f,m,x,S,Z,le,ye,T,R,ie,j,ve,de,we,ce,he,B,O,ne=0,q=new y.Buf8(4),pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!N||!N.state||!N.output||!N.input&&0!==N.avail_in)return F;12===(g=N.state).mode&&(g.mode=13),c=N.next_out,C=N.output,h=N.next_in,b=N.input,m=g.hold,x=g.bits,S=l=N.avail_in,Z=f=N.avail_out,he=0;e:for(;;)switch(g.mode){case 1:if(0===g.wrap){g.mode=13;break}for(;x<16;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(2&g.wrap&&35615===m){q[g.check=0]=255&m,q[1]=m>>>8&255,g.check=p(g.check,q,2,0),x=m=0,g.mode=2;break}if(g.flags=0,g.head&&(g.head.done=!1),!(1&g.wrap)||(((255&m)<<8)+(m>>8))%31){N.msg="incorrect header check",g.mode=30;break}if(8!=(15&m)){N.msg="unknown compression method",g.mode=30;break}if(x-=4,ce=8+(15&(m>>>=4)),0===g.wbits)g.wbits=ce;else if(ce>g.wbits){N.msg="invalid window size",g.mode=30;break}g.dmax=1<<ce,N.adler=g.check=1,g.mode=512&m?10:12,x=m=0;break;case 2:for(;x<16;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(g.flags=m,8!=(255&g.flags)){N.msg="unknown compression method",g.mode=30;break}if(57344&g.flags){N.msg="unknown header flags set",g.mode=30;break}g.head&&(g.head.text=m>>8&1),512&g.flags&&(q[0]=255&m,q[1]=m>>>8&255,g.check=p(g.check,q,2,0)),x=m=0,g.mode=3;case 3:for(;x<32;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}g.head&&(g.head.time=m),512&g.flags&&(q[0]=255&m,q[1]=m>>>8&255,q[2]=m>>>16&255,q[3]=m>>>24&255,g.check=p(g.check,q,4,0)),x=m=0,g.mode=4;case 4:for(;x<16;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}g.head&&(g.head.xflags=255&m,g.head.os=m>>8),512&g.flags&&(q[0]=255&m,q[1]=m>>>8&255,g.check=p(g.check,q,2,0)),x=m=0,g.mode=5;case 5:if(1024&g.flags){for(;x<16;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}g.length=m,g.head&&(g.head.extra_len=m),512&g.flags&&(q[0]=255&m,q[1]=m>>>8&255,g.check=p(g.check,q,2,0)),x=m=0}else g.head&&(g.head.extra=null);g.mode=6;case 6:if(1024&g.flags&&(l<(le=g.length)&&(le=l),le&&(g.head&&(ce=g.head.extra_len-g.length,g.head.extra||(g.head.extra=new Array(g.head.extra_len)),y.arraySet(g.head.extra,b,h,le,ce)),512&g.flags&&(g.check=p(g.check,b,le,h)),l-=le,h+=le,g.length-=le),g.length))break e;g.length=0,g.mode=7;case 7:if(2048&g.flags){if(0===l)break e;for(le=0;ce=b[h+le++],g.head&&ce&&g.length<65536&&(g.head.name+=String.fromCharCode(ce)),ce&&le<l;);if(512&g.flags&&(g.check=p(g.check,b,le,h)),l-=le,h+=le,ce)break e}else g.head&&(g.head.name=null);g.length=0,g.mode=8;case 8:if(4096&g.flags){if(0===l)break e;for(le=0;ce=b[h+le++],g.head&&ce&&g.length<65536&&(g.head.comment+=String.fromCharCode(ce)),ce&&le<l;);if(512&g.flags&&(g.check=p(g.check,b,le,h)),l-=le,h+=le,ce)break e}else g.head&&(g.head.comment=null);g.mode=9;case 9:if(512&g.flags){for(;x<16;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(m!==(65535&g.check)){N.msg="header crc mismatch",g.mode=30;break}x=m=0}g.head&&(g.head.hcrc=g.flags>>9&1,g.head.done=!0),N.adler=g.check=0,g.mode=12;break;case 10:for(;x<32;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}N.adler=g.check=H(m),x=m=0,g.mode=11;case 11:if(0===g.havedict)return N.next_out=c,N.avail_out=f,N.next_in=h,N.avail_in=l,g.hold=m,g.bits=x,2;N.adler=g.check=1,g.mode=12;case 12:if(5===P||6===P)break e;case 13:if(g.last){m>>>=7&x,x-=7&x,g.mode=27;break}for(;x<3;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}switch(g.last=1&m,x-=1,3&(m>>>=1)){case 0:g.mode=14;break;case 1:if(z(g),g.mode=20,6!==P)break;m>>>=2,x-=2;break e;case 2:g.mode=17;break;case 3:N.msg="invalid block type",g.mode=30}m>>>=2,x-=2;break;case 14:for(m>>>=7&x,x-=7&x;x<32;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if((65535&m)!=(m>>>16^65535)){N.msg="invalid stored block lengths",g.mode=30;break}if(g.length=65535&m,x=m=0,g.mode=15,6===P)break e;case 15:g.mode=16;case 16:if(le=g.length){if(l<le&&(le=l),f<le&&(le=f),0===le)break e;y.arraySet(C,b,h,le,c),l-=le,h+=le,f-=le,c+=le,g.length-=le;break}g.mode=12;break;case 17:for(;x<14;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(g.nlen=257+(31&m),x-=5,g.ndist=1+(31&(m>>>=5)),x-=5,g.ncode=4+(15&(m>>>=5)),m>>>=4,x-=4,286<g.nlen||30<g.ndist){N.msg="too many length or distance symbols",g.mode=30;break}g.have=0,g.mode=18;case 18:for(;g.have<g.ncode;){for(;x<3;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}g.lens[pe[g.have++]]=7&m,m>>>=3,x-=3}for(;g.have<19;)g.lens[pe[g.have++]]=0;if(g.lencode=g.lendyn,g.lenbits=7,he=k(0,g.lens,0,19,g.lencode,0,g.work,B={bits:g.lenbits}),g.lenbits=B.bits,he){N.msg="invalid code lengths set",g.mode=30;break}g.have=0,g.mode=19;case 19:for(;g.have<g.nlen+g.ndist;){for(;ie=(ne=g.lencode[m&(1<<g.lenbits)-1])>>>16&255,j=65535&ne,!((R=ne>>>24)<=x);){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(j<16)m>>>=R,x-=R,g.lens[g.have++]=j;else{if(16===j){for(O=R+2;x<O;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(m>>>=R,x-=R,0===g.have){N.msg="invalid bit length repeat",g.mode=30;break}ce=g.lens[g.have-1],le=3+(3&m),m>>>=2,x-=2}else if(17===j){for(O=R+3;x<O;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}x-=R,ce=0,le=3+(7&(m>>>=R)),m>>>=3,x-=3}else{for(O=R+7;x<O;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}x-=R,ce=0,le=11+(127&(m>>>=R)),m>>>=7,x-=7}if(g.have+le>g.nlen+g.ndist){N.msg="invalid bit length repeat",g.mode=30;break}for(;le--;)g.lens[g.have++]=ce}}if(30===g.mode)break;if(0===g.lens[256]){N.msg="invalid code -- missing end-of-block",g.mode=30;break}if(g.lenbits=9,he=k(1,g.lens,0,g.nlen,g.lencode,0,g.work,B={bits:g.lenbits}),g.lenbits=B.bits,he){N.msg="invalid literal/lengths set",g.mode=30;break}if(g.distbits=6,g.distcode=g.distdyn,he=k(2,g.lens,g.nlen,g.ndist,g.distcode,0,g.work,B={bits:g.distbits}),g.distbits=B.bits,he){N.msg="invalid distances set",g.mode=30;break}if(g.mode=20,6===P)break e;case 20:g.mode=21;case 21:if(6<=l&&258<=f){N.next_out=c,N.avail_out=f,N.next_in=h,N.avail_in=l,g.hold=m,g.bits=x,u(N,Z),c=N.next_out,C=N.output,f=N.avail_out,h=N.next_in,b=N.input,l=N.avail_in,m=g.hold,x=g.bits,12===g.mode&&(g.back=-1);break}for(g.back=0;ie=(ne=g.lencode[m&(1<<g.lenbits)-1])>>>16&255,j=65535&ne,!((R=ne>>>24)<=x);){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(ie&&0==(240&ie)){for(ve=R,de=ie,we=j;ie=(ne=g.lencode[we+((m&(1<<ve+de)-1)>>ve)])>>>16&255,j=65535&ne,!(ve+(R=ne>>>24)<=x);){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}m>>>=ve,x-=ve,g.back+=ve}if(m>>>=R,x-=R,g.back+=R,g.length=j,0===ie){g.mode=26;break}if(32&ie){g.back=-1,g.mode=12;break}if(64&ie){N.msg="invalid literal/length code",g.mode=30;break}g.extra=15&ie,g.mode=22;case 22:if(g.extra){for(O=g.extra;x<O;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}g.length+=m&(1<<g.extra)-1,m>>>=g.extra,x-=g.extra,g.back+=g.extra}g.was=g.length,g.mode=23;case 23:for(;ie=(ne=g.distcode[m&(1<<g.distbits)-1])>>>16&255,j=65535&ne,!((R=ne>>>24)<=x);){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(0==(240&ie)){for(ve=R,de=ie,we=j;ie=(ne=g.distcode[we+((m&(1<<ve+de)-1)>>ve)])>>>16&255,j=65535&ne,!(ve+(R=ne>>>24)<=x);){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}m>>>=ve,x-=ve,g.back+=ve}if(m>>>=R,x-=R,g.back+=R,64&ie){N.msg="invalid distance code",g.mode=30;break}g.offset=j,g.extra=15&ie,g.mode=24;case 24:if(g.extra){for(O=g.extra;x<O;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}g.offset+=m&(1<<g.extra)-1,m>>>=g.extra,x-=g.extra,g.back+=g.extra}if(g.offset>g.dmax){N.msg="invalid distance too far back",g.mode=30;break}g.mode=25;case 25:if(0===f)break e;if(g.offset>(le=Z-f)){if((le=g.offset-le)>g.whave&&g.sane){N.msg="invalid distance too far back",g.mode=30;break}ye=le>g.wnext?g.wsize-(le-=g.wnext):g.wnext-le,le>g.length&&(le=g.length),T=g.window}else T=C,ye=c-g.offset,le=g.length;for(f<le&&(le=f),f-=le,g.length-=le;C[c++]=T[ye++],--le;);0===g.length&&(g.mode=21);break;case 26:if(0===f)break e;C[c++]=g.length,f--,g.mode=21;break;case 27:if(g.wrap){for(;x<32;){if(0===l)break e;l--,m|=b[h++]<<x,x+=8}if(N.total_out+=Z-=f,g.total+=Z,Z&&(N.adler=g.check=g.flags?p(g.check,C,Z,c-Z):w(g.check,C,Z,c-Z)),Z=f,(g.flags?m:H(m))!==g.check){N.msg="incorrect data check",g.mode=30;break}x=m=0}g.mode=28;case 28:if(g.wrap&&g.flags){for(;x<32;){if(0===l)break e;l--,m+=b[h++]<<x,x+=8}if(m!==(4294967295&g.total)){N.msg="incorrect length check",g.mode=30;break}x=m=0}g.mode=29;case 29:he=1;break e;case 30:he=-3;break e;case 31:return-4;default:return F}return N.next_out=c,N.avail_out=f,N.next_in=h,N.avail_in=l,g.hold=m,g.bits=x,(g.wsize||Z!==N.avail_out&&g.mode<30&&(g.mode<27||4!==P))&&A(N,N.output,N.next_out,Z-N.avail_out)?(g.mode=31,-4):(Z-=N.avail_out,N.total_in+=S-=N.avail_in,N.total_out+=Z,g.total+=Z,g.wrap&&Z&&(N.adler=g.check=g.flags?p(g.check,C,Z,N.next_out-Z):w(g.check,C,Z,N.next_out-Z)),N.data_type=g.bits+(g.last?64:0)+(12===g.mode?128:0)+(20===g.mode||15===g.mode?256:0),(0==S&&0===Z||4===P)&&0===he&&(he=-5),he)},a.inflateEnd=function(N){if(!N||!N.state)return F;var P=N.state;return P.window&&(P.window=null),N.state=null,0},a.inflateGetHeader=function(N,P){var g;return N&&N.state?0==(2&(g=N.state).wrap)?F:((g.head=P).done=!1,0):F},a.inflateSetDictionary=function(N,P){var g,b=P.length;return N&&N.state?0!==(g=N.state).wrap&&11!==g.mode?F:11===g.mode&&w(1,P,b,0)!==g.check?-3:A(N,P,b,b)?(g.mode=31,-4):(g.havedict=1,0):F},a.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(ae,Y,a){"use strict";var y=ae("../utils/common"),w=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],p=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],u=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],k=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];Y.exports=function(v,D,_,F,oe,V,L,H){var U,se,ue,J,K,ee,M,G,z,A=H.bits,N=0,P=0,g=0,b=0,C=0,h=0,c=0,l=0,f=0,m=0,x=null,S=0,Z=new y.Buf16(16),le=new y.Buf16(16),ye=null,T=0;for(N=0;N<=15;N++)Z[N]=0;for(P=0;P<F;P++)Z[D[_+P]]++;for(C=A,b=15;1<=b&&0===Z[b];b--);if(b<C&&(C=b),0===b)return oe[V++]=20971520,oe[V++]=20971520,H.bits=1,0;for(g=1;g<b&&0===Z[g];g++);for(C<g&&(C=g),N=l=1;N<=15;N++)if(l<<=1,(l-=Z[N])<0)return-1;if(0<l&&(0===v||1!==b))return-1;for(le[1]=0,N=1;N<15;N++)le[N+1]=le[N]+Z[N];for(P=0;P<F;P++)0!==D[_+P]&&(L[le[D[_+P]]++]=P);if(ee=0===v?(x=ye=L,19):1===v?(x=w,S-=257,ye=p,T-=257,256):(x=u,ye=k,-1),N=g,K=V,c=P=m=0,ue=-1,J=(f=1<<(h=C))-1,1===v&&852<f||2===v&&592<f)return 1;for(;;){for(M=N-c,z=L[P]<ee?(G=0,L[P]):L[P]>ee?(G=ye[T+L[P]],x[S+L[P]]):(G=96,0),U=1<<N-c,g=se=1<<h;oe[K+(m>>c)+(se-=U)]=M<<24|G<<16|z|0,0!==se;);for(U=1<<N-1;m&U;)U>>=1;if(0!==U?(m&=U-1,m+=U):m=0,P++,0==--Z[N]){if(N===b)break;N=D[_+L[P]]}if(C<N&&(m&J)!==ue){for(0===c&&(c=C),K+=g,l=1<<(h=N-c);h+c<b&&!((l-=Z[h+c])<=0);)h++,l<<=1;if(f+=1<<h,1===v&&852<f||2===v&&592<f)return 1;oe[ue=m&J]=C<<24|h<<16|K-V|0}}return 0!==m&&(oe[K+m]=N-c<<24|64<<16|0),H.bits=C,0}},{"../utils/common":41}],51:[function(ae,Y,a){"use strict";Y.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(ae,Y,a){"use strict";var y=ae("../utils/common");function u(ne){for(var q=ne.length;0<=--q;)ne[q]=0}var D=256,_=286,F=30,L=15,ee=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],M=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],A=new Array(576);u(A);var N=new Array(60);u(N);var P=new Array(512);u(P);var g=new Array(256);u(g);var b=new Array(29);u(b);var C,h,c,l=new Array(F);function f(ne,q,pe,$e,me){this.static_tree=ne,this.extra_bits=q,this.extra_base=pe,this.elems=$e,this.max_length=me,this.has_stree=ne&&ne.length}function m(ne,q){this.dyn_tree=ne,this.max_code=0,this.stat_desc=q}function x(ne){return ne<256?P[ne]:P[256+(ne>>>7)]}function S(ne,q){ne.pending_buf[ne.pending++]=255&q,ne.pending_buf[ne.pending++]=q>>>8&255}function Z(ne,q,pe){ne.bi_valid>16-pe?(ne.bi_buf|=q<<ne.bi_valid&65535,S(ne,ne.bi_buf),ne.bi_buf=q>>16-ne.bi_valid,ne.bi_valid+=pe-16):(ne.bi_buf|=q<<ne.bi_valid&65535,ne.bi_valid+=pe)}function le(ne,q,pe){Z(ne,pe[2*q],pe[2*q+1])}function ye(ne,q){for(var pe=0;pe|=1&ne,ne>>>=1,pe<<=1,0<--q;);return pe>>>1}function T(ne,q,pe){var $e,me,Te=new Array(16),De=0;for($e=1;$e<=L;$e++)Te[$e]=De=De+pe[$e-1]<<1;for(me=0;me<=q;me++){var Me=ne[2*me+1];0!==Me&&(ne[2*me]=ye(Te[Me]++,Me))}}function R(ne){var q;for(q=0;q<_;q++)ne.dyn_ltree[2*q]=0;for(q=0;q<F;q++)ne.dyn_dtree[2*q]=0;for(q=0;q<19;q++)ne.bl_tree[2*q]=0;ne.dyn_ltree[512]=1,ne.opt_len=ne.static_len=0,ne.last_lit=ne.matches=0}function ie(ne){8<ne.bi_valid?S(ne,ne.bi_buf):0<ne.bi_valid&&(ne.pending_buf[ne.pending++]=ne.bi_buf),ne.bi_buf=0,ne.bi_valid=0}function j(ne,q,pe,$e){var me=2*q,Te=2*pe;return ne[me]<ne[Te]||ne[me]===ne[Te]&&$e[q]<=$e[pe]}function ve(ne,q,pe){for(var $e=ne.heap[pe],me=pe<<1;me<=ne.heap_len&&(me<ne.heap_len&&j(q,ne.heap[me+1],ne.heap[me],ne.depth)&&me++,!j(q,$e,ne.heap[me],ne.depth));)ne.heap[pe]=ne.heap[me],pe=me,me<<=1;ne.heap[pe]=$e}function de(ne,q,pe){var $e,me,Te,De,Me=0;if(0!==ne.last_lit)for(;$e=ne.pending_buf[ne.d_buf+2*Me]<<8|ne.pending_buf[ne.d_buf+2*Me+1],me=ne.pending_buf[ne.l_buf+Me],Me++,0===$e?le(ne,me,q):(le(ne,(Te=g[me])+D+1,q),0!==(De=ee[Te])&&Z(ne,me-=b[Te],De),le(ne,Te=x(--$e),pe),0!==(De=M[Te])&&Z(ne,$e-=l[Te],De)),Me<ne.last_lit;);le(ne,256,q)}function we(ne,q){var pe,$e,me,Te=q.dyn_tree,De=q.stat_desc.static_tree,Me=q.stat_desc.has_stree,Pe=q.stat_desc.elems,Ve=-1;for(ne.heap_len=0,ne.heap_max=573,pe=0;pe<Pe;pe++)0!==Te[2*pe]?(ne.heap[++ne.heap_len]=Ve=pe,ne.depth[pe]=0):Te[2*pe+1]=0;for(;ne.heap_len<2;)Te[2*(me=ne.heap[++ne.heap_len]=Ve<2?++Ve:0)]=1,ne.depth[me]=0,ne.opt_len--,Me&&(ne.static_len-=De[2*me+1]);for(q.max_code=Ve,pe=ne.heap_len>>1;1<=pe;pe--)ve(ne,Te,pe);for(me=Pe;pe=ne.heap[1],ne.heap[1]=ne.heap[ne.heap_len--],ve(ne,Te,1),$e=ne.heap[1],ne.heap[--ne.heap_max]=pe,ne.heap[--ne.heap_max]=$e,Te[2*me]=Te[2*pe]+Te[2*$e],ne.depth[me]=(ne.depth[pe]>=ne.depth[$e]?ne.depth[pe]:ne.depth[$e])+1,Te[2*pe+1]=Te[2*$e+1]=me,ne.heap[1]=me++,ve(ne,Te,1),2<=ne.heap_len;);ne.heap[--ne.heap_max]=ne.heap[1],function(Qe,Mt){var Bt,Pt,gt,mt,rr,Lo,zr=Mt.dyn_tree,yu=Mt.max_code,df=Mt.stat_desc.static_tree,Qa=Mt.stat_desc.has_stree,Zl=Mt.stat_desc.extra_bits,Ja=Mt.stat_desc.extra_base,ts=Mt.stat_desc.max_length,zo=0;for(mt=0;mt<=L;mt++)Qe.bl_count[mt]=0;for(zr[2*Qe.heap[Qe.heap_max]+1]=0,Bt=Qe.heap_max+1;Bt<573;Bt++)ts<(mt=zr[2*zr[2*(Pt=Qe.heap[Bt])+1]+1]+1)&&(mt=ts,zo++),zr[2*Pt+1]=mt,yu<Pt||(Qe.bl_count[mt]++,rr=0,Ja<=Pt&&(rr=Zl[Pt-Ja]),Qe.opt_len+=(Lo=zr[2*Pt])*(mt+rr),Qa&&(Qe.static_len+=Lo*(df[2*Pt+1]+rr)));if(0!==zo){do{for(mt=ts-1;0===Qe.bl_count[mt];)mt--;Qe.bl_count[mt]--,Qe.bl_count[mt+1]+=2,Qe.bl_count[ts]--,zo-=2}while(0<zo);for(mt=ts;0!==mt;mt--)for(Pt=Qe.bl_count[mt];0!==Pt;)yu<(gt=Qe.heap[--Bt])||(zr[2*gt+1]!==mt&&(Qe.opt_len+=(mt-zr[2*gt+1])*zr[2*gt],zr[2*gt+1]=mt),Pt--)}}(ne,q),T(Te,Ve,ne.bl_count)}function ce(ne,q,pe){var $e,me,Te=-1,De=q[1],Me=0,Pe=7,Ve=4;for(0===De&&(Pe=138,Ve=3),q[2*(pe+1)+1]=65535,$e=0;$e<=pe;$e++)me=De,De=q[2*($e+1)+1],++Me<Pe&&me===De||(Me<Ve?ne.bl_tree[2*me]+=Me:0!==me?(me!==Te&&ne.bl_tree[2*me]++,ne.bl_tree[32]++):Me<=10?ne.bl_tree[34]++:ne.bl_tree[36]++,Te=me,Ve=(Me=0)===De?(Pe=138,3):me===De?(Pe=6,3):(Pe=7,4))}function he(ne,q,pe){var $e,me,Te=-1,De=q[1],Me=0,Pe=7,Ve=4;for(0===De&&(Pe=138,Ve=3),$e=0;$e<=pe;$e++)if(me=De,De=q[2*($e+1)+1],!(++Me<Pe&&me===De)){if(Me<Ve)for(;le(ne,me,ne.bl_tree),0!=--Me;);else 0!==me?(me!==Te&&(le(ne,me,ne.bl_tree),Me--),le(ne,16,ne.bl_tree),Z(ne,Me-3,2)):Me<=10?(le(ne,17,ne.bl_tree),Z(ne,Me-3,3)):(le(ne,18,ne.bl_tree),Z(ne,Me-11,7));Te=me,Ve=(Me=0)===De?(Pe=138,3):me===De?(Pe=6,3):(Pe=7,4)}}u(l);var B=!1;function O(ne,q,pe,$e){var me,Te,De;Z(ne,0+($e?1:0),3),Te=q,De=pe,ie(me=ne),S(me,De),S(me,~De),y.arraySet(me.pending_buf,me.window,Te,De,me.pending),me.pending+=De}a._tr_init=function(ne){B||(function(){var q,pe,$e,me,Te,De=new Array(16);for(me=$e=0;me<28;me++)for(b[me]=$e,q=0;q<1<<ee[me];q++)g[$e++]=me;for(g[$e-1]=me,me=Te=0;me<16;me++)for(l[me]=Te,q=0;q<1<<M[me];q++)P[Te++]=me;for(Te>>=7;me<F;me++)for(l[me]=Te<<7,q=0;q<1<<M[me]-7;q++)P[256+Te++]=me;for(pe=0;pe<=L;pe++)De[pe]=0;for(q=0;q<=143;)A[2*q+1]=8,q++,De[8]++;for(;q<=255;)A[2*q+1]=9,q++,De[9]++;for(;q<=279;)A[2*q+1]=7,q++,De[7]++;for(;q<=287;)A[2*q+1]=8,q++,De[8]++;for(T(A,287,De),q=0;q<F;q++)N[2*q+1]=5,N[2*q]=ye(q,5);C=new f(A,ee,257,_,L),h=new f(N,M,0,F,L),c=new f(new Array(0),G,0,19,7)}(),B=!0),ne.l_desc=new m(ne.dyn_ltree,C),ne.d_desc=new m(ne.dyn_dtree,h),ne.bl_desc=new m(ne.bl_tree,c),ne.bi_buf=0,ne.bi_valid=0,R(ne)},a._tr_stored_block=O,a._tr_flush_block=function(ne,q,pe,$e){var me,Te,De=0;0<ne.level?(2===ne.strm.data_type&&(ne.strm.data_type=function(Me){var Pe,Ve=4093624447;for(Pe=0;Pe<=31;Pe++,Ve>>>=1)if(1&Ve&&0!==Me.dyn_ltree[2*Pe])return 0;if(0!==Me.dyn_ltree[18]||0!==Me.dyn_ltree[20]||0!==Me.dyn_ltree[26])return 1;for(Pe=32;Pe<D;Pe++)if(0!==Me.dyn_ltree[2*Pe])return 1;return 0}(ne)),we(ne,ne.l_desc),we(ne,ne.d_desc),De=function(Me){var Pe;for(ce(Me,Me.dyn_ltree,Me.l_desc.max_code),ce(Me,Me.dyn_dtree,Me.d_desc.max_code),we(Me,Me.bl_desc),Pe=18;3<=Pe&&0===Me.bl_tree[2*z[Pe]+1];Pe--);return Me.opt_len+=3*(Pe+1)+5+5+4,Pe}(ne),(Te=ne.static_len+3+7>>>3)<=(me=ne.opt_len+3+7>>>3)&&(me=Te)):me=Te=pe+5,pe+4<=me&&-1!==q?O(ne,q,pe,$e):4===ne.strategy||Te===me?(Z(ne,2+($e?1:0),3),de(ne,A,N)):(Z(ne,4+($e?1:0),3),function(Me,Pe,Ve,Qe){var Mt;for(Z(Me,Pe-257,5),Z(Me,Ve-1,5),Z(Me,Qe-4,4),Mt=0;Mt<Qe;Mt++)Z(Me,Me.bl_tree[2*z[Mt]+1],3);he(Me,Me.dyn_ltree,Pe-1),he(Me,Me.dyn_dtree,Ve-1)}(ne,ne.l_desc.max_code+1,ne.d_desc.max_code+1,De+1),de(ne,ne.dyn_ltree,ne.dyn_dtree)),R(ne),$e&&ie(ne)},a._tr_tally=function(ne,q,pe){return ne.pending_buf[ne.d_buf+2*ne.last_lit]=q>>>8&255,ne.pending_buf[ne.d_buf+2*ne.last_lit+1]=255&q,ne.pending_buf[ne.l_buf+ne.last_lit]=255&pe,ne.last_lit++,0===q?ne.dyn_ltree[2*pe]++:(ne.matches++,q--,ne.dyn_ltree[2*(g[pe]+D+1)]++,ne.dyn_dtree[2*x(q)]++),ne.last_lit===ne.lit_bufsize-1},a._tr_align=function(ne){var q;Z(ne,2,3),le(ne,256,A),16===(q=ne).bi_valid?(S(q,q.bi_buf),q.bi_buf=0,q.bi_valid=0):8<=q.bi_valid&&(q.pending_buf[q.pending++]=255&q.bi_buf,q.bi_buf>>=8,q.bi_valid-=8)}},{"../utils/common":41}],53:[function(ae,Y,a){"use strict";Y.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(ae,Y,a){(function(y){!function(w,p){"use strict";if(!w.setImmediate){var u,k,v,D,_=1,F={},oe=!1,V=w.document,L=Object.getPrototypeOf&&Object.getPrototypeOf(w);L=L&&L.setTimeout?L:w,u="[object process]"==={}.toString.call(w.process)?function(ue){process.nextTick(function(){U(ue)})}:function(){if(w.postMessage&&!w.importScripts){var ue=!0,J=w.onmessage;return w.onmessage=function(){ue=!1},w.postMessage("","*"),w.onmessage=J,ue}}()?(D="setImmediate$"+Math.random()+"$",w.addEventListener?w.addEventListener("message",se,!1):w.attachEvent("onmessage",se),function(ue){w.postMessage(D+ue,"*")}):w.MessageChannel?((v=new MessageChannel).port1.onmessage=function(ue){U(ue.data)},function(ue){v.port2.postMessage(ue)}):V&&"onreadystatechange"in V.createElement("script")?(k=V.documentElement,function(ue){var J=V.createElement("script");J.onreadystatechange=function(){U(ue),J.onreadystatechange=null,k.removeChild(J),J=null},k.appendChild(J)}):function(ue){setTimeout(U,0,ue)},L.setImmediate=function(ue){"function"!=typeof ue&&(ue=new Function(""+ue));for(var J=new Array(arguments.length-1),K=0;K<J.length;K++)J[K]=arguments[K+1];return F[_]={callback:ue,args:J},u(_),_++},L.clearImmediate=H}function H(ue){delete F[ue]}function U(ue){if(oe)setTimeout(U,0,ue);else{var J=F[ue];if(J){oe=!0;try{!function(K){var ee=K.callback,M=K.args;switch(M.length){case 0:ee();break;case 1:ee(M[0]);break;case 2:ee(M[0],M[1]);break;case 3:ee(M[0],M[1],M[2]);break;default:ee.apply(undefined,M)}}(J)}finally{H(ue),oe=!1}}}}function se(ue){ue.source===w&&"string"==typeof ue.data&&0===ue.data.indexOf(D)&&U(+ue.data.slice(D.length))}}("undefined"==typeof self?void 0===y?this:y:self)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}]},{},[10])(10)},9263:(E,ae,Y)=>{var a=Y(9209),y=Y(966);function w(p){this._init(p)}w.prototype={_init:function(p){p=p||{},this._data=null,this._table=null,this._result=null,this._onDataCallback=p.onData,this._onEndCallback=p.onEnd},_createTable:function(){for(var p=y.createBuffer(8,a.TABLE_LENGTH),u=0;u<a.TABLE_LENGTH;u++)p[u]=a.BASE62TABLE.charCodeAt(u);return p},_onData:function(p,u){var k=y.bufferToString_fast(p,u);this._onDataCallback?this._onDataCallback(k):this._result+=k},_onEnd:function(){this._onEndCallback&&this._onEndCallback(),this._data=this._table=null},_search:function(){var p=2,u=this._data,k=this._offset,v=a.BUFFER_MAX;if(this._dataLen-k<v&&(v=this._dataLen-k),p>v)return!1;var oe,V,L,H,U,D=k-a.WINDOW_BUFFER_MAX,_=u.substring(D,k+v),F=k+p-3-D;do{if(2===p){if(V=u.charAt(k)+u.charAt(k+1),!~(L=_.indexOf(V))||L>F)break}else 3===p?V+=u.charAt(k+2):V=u.substr(k,p);if(!~(H=a.STRING_LASTINDEXOF_BUG?u.substring(D,k+p-1).lastIndexOf(V):_.lastIndexOf(V,F)))break;U=H,oe=D+H;do{if(u.charCodeAt(k+p)!==u.charCodeAt(oe+p))break}while(++p<v);if(L===H){p++;break}}while(++p<v);return 2!==p&&(this._index=a.WINDOW_BUFFER_MAX-U,this._length=p-1,!0)},compress:function(p){if(null==p||0===p.length)return"";var u,k=this._createTable(),v=y.createWindow(),D=y.createBuffer(8,a.COMPRESS_CHUNK_SIZE),_=0;this._result="",this._offset=v.length,this._data=v+p,this._dataLen=this._data.length,v=p=null;for(var V,L,H,U,se,F=-1,oe=-1;this._offset<this._dataLen;)this._search()?(this._index<a.BUFFER_MAX?(L=this._index,H=0):H=(this._index-(L=this._index%a.BUFFER_MAX))/a.BUFFER_MAX,2===this._length?(D[_++]=k[H+a.COMPRESS_FIXED_START],D[_++]=k[L]):(D[_++]=k[H+a.COMPRESS_START],D[_++]=k[L],D[_++]=k[this._length]),this._offset+=this._length,~oe&&(oe=-1)):(V=this._data.charCodeAt(this._offset++))<a.LATIN_BUFFER_MAX?(V<a.UNICODE_CHAR_MAX?(L=V,H=0,F=a.LATIN_INDEX):F=(H=(V-(L=V%a.UNICODE_CHAR_MAX))/a.UNICODE_CHAR_MAX)+a.LATIN_INDEX,oe===F?D[_++]=k[L]:(D[_++]=k[F-a.LATIN_INDEX_START],D[_++]=k[L],oe=F)):(V<a.UNICODE_BUFFER_MAX?(L=V,H=0,F=a.UNICODE_INDEX):F=(H=(V-(L=V%a.UNICODE_BUFFER_MAX))/a.UNICODE_BUFFER_MAX)+a.UNICODE_INDEX,L<a.UNICODE_CHAR_MAX?(U=L,se=0):se=(L-(U=L%a.UNICODE_CHAR_MAX))/a.UNICODE_CHAR_MAX,oe===F?(D[_++]=k[U],D[_++]=k[se]):(D[_++]=k[a.CHAR_START],D[_++]=k[F-a.TABLE_LENGTH],D[_++]=k[U],D[_++]=k[se],oe=F)),_>=a.COMPRESS_CHUNK_MAX&&(this._onData(D,_),_=0);return _>0&&this._onData(D,_),this._onEnd(),u=this._result,this._result=null,null===u?"":u}},E.exports=w},9209:(E,ae)=>{var Y=ae.HAS_TYPED="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array,a=!1,y=!1;try{"a"===String.fromCharCode.apply(null,[97])&&(a=!0)}catch(ue){}if(Y)try{"a"===String.fromCharCode.apply(null,new Uint8Array([97]))&&(y=!0)}catch(ue){}ae.CAN_CHARCODE_APPLY=a,ae.CAN_CHARCODE_APPLY_TYPED=y;var w=ae.APPLY_BUFFER_SIZE=65533;ae.APPLY_BUFFER_SIZE_OK=null;var p=!1;-1!=="abc\u307b\u3052".lastIndexOf("\u307b\u3052",1)&&(p=!0),ae.STRING_LASTINDEXOF_BUG=p;var u=ae.BASE62TABLE="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",k=ae.TABLE_LENGTH=u.length,v=Math.max(k,62)-Math.min(k,62);ae.BUFFER_MAX=k-1;var D=ae.WINDOW_MAX=1024;ae.WINDOW_BUFFER_MAX=304;var _=ae.COMPRESS_CHUNK_SIZE=w;ae.COMPRESS_CHUNK_MAX=_-k;var F=ae.DECOMPRESS_CHUNK_SIZE=w;ae.DECOMPRESS_CHUNK_MAX=F+2*D,ae.LATIN_BUFFER_MAX=132;var V=ae.UNICODE_CHAR_MAX=40;ae.UNICODE_BUFFER_MAX=V*(V+1),ae.LATIN_INDEX=k+1,ae.LATIN_INDEX_START=v+20,ae.UNICODE_INDEX=k+5,ae.DECODE_MAX=k-v-19;var L=ae.LATIN_DECODE_MAX=V+7,H=ae.CHAR_START=L+1,U=ae.COMPRESS_START=H+1,se=ae.COMPRESS_FIXED_START=U+5;ae.COMPRESS_INDEX=se+5},9727:(E,ae,Y)=>{var a=Y(9209),y=Y(966);function w(p){this._init(p)}w.prototype={_init:function(p){p=p||{},this._result=null,this._onDataCallback=p.onData,this._onEndCallback=p.onEnd},_createTable:function(){for(var p={},u=0;u<a.TABLE_LENGTH;u++)p[a.BASE62TABLE.charAt(u)]=u;return p},_onData:function(p){var u;if(this._onDataCallback){if(p)u=this._result,this._result=[];else{var k=a.DECOMPRESS_CHUNK_SIZE-a.WINDOW_MAX;u=this._result.slice(a.WINDOW_MAX,a.WINDOW_MAX+k),this._result=this._result.slice(0,a.WINDOW_MAX).concat(this._result.slice(a.WINDOW_MAX+k))}u.length>0&&this._onDataCallback(y.bufferToString_fast(u))}},_onEnd:function(){this._onEndCallback&&this._onEndCallback()},decompress:function(p){if(null==p||0===p.length)return"";this._result=y.stringToArray(y.createWindow());for(var u,oe,V,L,U,se,ue,J,K,ee,k=this._createTable(),v=!1,D=null,_=p.length,F=0;F<_;F++)if(void 0!==(V=k[p.charAt(F)])){if(V<a.DECODE_MAX)U=v?k[p.charAt(++F)]*a.UNICODE_CHAR_MAX+V+a.UNICODE_BUFFER_MAX*D:D*a.UNICODE_CHAR_MAX+V,this._result[this._result.length]=U;else if(V<a.LATIN_DECODE_MAX)D=V-a.DECODE_MAX,v=!1;else if(V===a.CHAR_START)D=(L=k[p.charAt(++F)])-5,v=!0;else if(V<a.COMPRESS_INDEX){if(L=k[p.charAt(++F)],V<a.COMPRESS_FIXED_START?(se=(V-a.COMPRESS_START)*a.BUFFER_MAX+L,ue=k[p.charAt(++F)]):(se=(V-a.COMPRESS_FIXED_START)*a.BUFFER_MAX+L,ue=2),(J=this._result.slice(-se)).length>ue&&(J.length=ue),K=J.length,J.length>0)for(ee=0;ee<ue;)for(oe=0;oe<K&&(this._result[this._result.length]=J[oe],!(++ee>=ue));oe++);D=null}this._result.length>=a.DECOMPRESS_CHUNK_MAX&&this._onData()}return this._result=this._result.slice(a.WINDOW_MAX),this._onData(!0),this._onEnd(),u=y.bufferToString_fast(this._result),this._result=null,u}},E.exports=w},8497:(E,ae,Y)=>{var a=Y(9263),y=Y(9727);Y(1014),ae.n=function(w,p){return new a(p).compress(w)},ae.L=function(w,p){return new y(p).decompress(w)}},966:(E,ae,Y)=>{var a=Y(9209),y=String.fromCharCode;ae.createBuffer=function(k,v){if(!a.HAS_TYPED)return new Array(v);switch(k){case 8:return new Uint8Array(v);case 16:return new Uint16Array(v)}};var w=ae.truncateBuffer=function(k,v){return k.length===v?k:k.subarray?k.subarray(0,v):(k.length=v,k)};ae.bufferToString_fast=function(k,v){if(null==v?v=k.length:k=w(k,v),a.CAN_CHARCODE_APPLY&&a.CAN_CHARCODE_APPLY_TYPED){var D=k.length;if(D<a.APPLY_BUFFER_SIZE&&a.APPLY_BUFFER_SIZE_OK)return y.apply(null,k);if(null===a.APPLY_BUFFER_SIZE_OK)try{var _=y.apply(null,k);return D>a.APPLY_BUFFER_SIZE&&(a.APPLY_BUFFER_SIZE_OK=!0),_}catch(F){a.APPLY_BUFFER_SIZE_OK=!1}}return p(k)};var p=ae.bufferToString_chunked=function(k){for(var F,v="",D=k.length,_=0;_<D;){if(F=k.subarray?k.subarray(_,_+a.APPLY_BUFFER_SIZE):k.slice(_,_+a.APPLY_BUFFER_SIZE),_+=a.APPLY_BUFFER_SIZE,!a.APPLY_BUFFER_SIZE_OK){if(null===a.APPLY_BUFFER_SIZE_OK)try{v+=y.apply(null,F),F.length>a.APPLY_BUFFER_SIZE&&(a.APPLY_BUFFER_SIZE_OK=!0);continue}catch(oe){a.APPLY_BUFFER_SIZE_OK=!1}return u(k)}v+=y.apply(null,F)}return v},u=ae.bufferToString_slow=function(k){for(var v="",D=k.length,_=0;_<D;_++)v+=y(k[_]);return v};ae.stringToArray=function(k){for(var v=[],D=k&&k.length,_=0;_<D;_++)v[_]=k.charCodeAt(_);return v},ae.createWindow=function(){for(var k=a.WINDOW_MAX>>7,v="        ";!(k&a.WINDOW_MAX);)v+=v,k<<=1;return v}},2391:(E,ae,Y)=>{ae.encode=Y(8048).encode,ae.decode=Y(9175).decode,Y(7704),Y(8131),Y(1490),Y(9234)},2295:function(E){function ae(Y){return Y&&Y.isBuffer&&Y}E.exports=ae("undefined"!=typeof Buffer&&Buffer)||ae(this.Buffer)||ae("undefined"!=typeof window&&window.Buffer)||this.Buffer},7625:(E,ae)=>{ae.copy=function w(p,u,k,v){var D;k||(k=0),!v&&0!==v&&(v=this.length),u||(u=0);var _=v-k;if(p===this&&k<u&&u<v)for(D=_-1;D>=0;D--)p[D+u]=this[D+k];else for(D=0;D<_;D++)p[D+u]=this[D+k];return _},ae.toString=function y(p,u,k){var v=this,D=0|u;k||(k=v.length);for(var _="",F=0;D<k;)(F=v[D++])<128?_+=String.fromCharCode(F):(192==(224&F)?F=(31&F)<<6|63&v[D++]:224==(240&F)?F=(15&F)<<12|(63&v[D++])<<6|63&v[D++]:240==(248&F)&&(F=(7&F)<<18|(63&v[D++])<<12|(63&v[D++])<<6|63&v[D++]),F>=65536?(F-=65536,_+=String.fromCharCode(55296+(F>>>10),56320+(1023&F))):_+=String.fromCharCode(F));return _},ae.write=function a(p,u){for(var k=this,v=u||(u|=0),D=p.length,_=0,F=0;F<D;)(_=p.charCodeAt(F++))<128?k[v++]=_:_<2048?(k[v++]=192|_>>>6,k[v++]=128|63&_):_<55296||_>57343?(k[v++]=224|_>>>12,k[v++]=128|_>>>6&63,k[v++]=128|63&_):(_=65536+(_-55296<<10|p.charCodeAt(F++)-56320),k[v++]=240|_>>>18,k[v++]=128|_>>>12&63,k[v++]=128|_>>>6&63,k[v++]=128|63&_);return v-u}},1864:(E,ae,Y)=>{var a=Y(6093),y=E.exports=w(0);function w(u){return new Array(u)}y.alloc=w,y.concat=a.concat,y.from=function p(u){if(!a.isBuffer(u)&&a.isView(u))u=a.Uint8Array.from(u);else if(a.isArrayBuffer(u))u=new Uint8Array(u);else{if("string"==typeof u)return a.from.call(y,u);if("number"==typeof u)throw new TypeError('"value" argument must not be a number')}return Array.prototype.slice.call(u)}},1884:(E,ae,Y)=>{var a=Y(6093),y=a.global,w=E.exports=a.hasBuffer?p(0):[];function p(k){return new y(k)}w.alloc=a.hasBuffer&&y.alloc||p,w.concat=a.concat,w.from=function u(k){if(!a.isBuffer(k)&&a.isView(k))k=a.Uint8Array.from(k);else if(a.isArrayBuffer(k))k=new Uint8Array(k);else{if("string"==typeof k)return a.from.call(w,k);if("number"==typeof k)throw new TypeError('"value" argument must not be a number')}return y.from&&1!==y.from.length?y.from(k):new y(k)}},5364:(E,ae,Y)=>{var a=Y(7625);ae.copy=k,ae.slice=v,ae.toString=function D(F,oe,V){var L=!p&&y.isBuffer(this)?this.toString:a.toString;return L.apply(this,arguments)},ae.write=function _(F){return function oe(){return(this[F]||a[F]).apply(this,arguments)}}("write");var y=Y(6093),w=y.global,p=y.hasBuffer&&"TYPED_ARRAY_SUPPORT"in w,u=p&&!w.TYPED_ARRAY_SUPPORT;function k(F,oe,V,L){var H=y.isBuffer(this),U=y.isBuffer(F);if(H&&U)return this.copy(F,oe,V,L);if(u||H||U||!y.isView(this)||!y.isView(F))return a.copy.call(this,F,oe,V,L);var se=V||null!=L?v.call(this,V,L):this;return F.set(se,oe),se.length}function v(F,oe){var V=this.slice||!u&&this.subarray;if(V)return V.call(this,F,oe);var L=y.alloc.call(this,oe-F);return k.call(this,L,0,F,oe),L}},5321:(E,ae,Y)=>{var a=Y(6093),y=E.exports=a.hasArrayBuffer?w(0):[];function w(u){return new Uint8Array(u)}y.alloc=w,y.concat=a.concat,y.from=function p(u){if(a.isView(u)){var k=u.byteOffset,v=u.byteLength;(u=u.buffer).byteLength!==v&&(u.slice?u=u.slice(k,k+v):(u=new Uint8Array(u)).byteLength!==v&&(u=Array.prototype.slice.call(u,k,k+v)))}else{if("string"==typeof u)return a.from.call(y,u);if("number"==typeof u)throw new TypeError('"value" argument must not be a number')}return new Uint8Array(u)}},6093:(E,ae,Y)=>{var a=ae.global=Y(2295),y=ae.hasBuffer=a&&!!a.isBuffer,w=ae.hasArrayBuffer="undefined"!=typeof ArrayBuffer,p=ae.isArray=Y(6425);ae.isArrayBuffer=w?function U(ee){return ee instanceof ArrayBuffer||H(ee)}:J;var u=ae.isBuffer=y?a.isBuffer:J,k=ae.isView=w?ArrayBuffer.isView||K("ArrayBuffer","buffer"):J;ae.alloc=V,ae.concat=function L(ee,M){M||(M=0,Array.prototype.forEach.call(ee,function N(g){M+=g.length}));var z=V.call(this!==ae&&this||ee[0],M),A=0;return Array.prototype.forEach.call(ee,function P(g){A+=F.copy.call(g,z,A)}),z},ae.from=function oe(ee){return"string"==typeof ee?se.call(this,ee):ue(this).from(ee)};var v=ae.Array=Y(1864),D=ae.Buffer=Y(1884),_=ae.Uint8Array=Y(5321),F=ae.prototype=Y(5364);function V(ee){return ue(this).alloc(ee)}var H=K("ArrayBuffer");function se(ee){var M=3*ee.length,G=V.call(this,M),z=F.write.call(G,ee);return M!==z&&(G=F.slice.call(G,0,z)),G}function ue(ee){return u(ee)?D:k(ee)?_:p(ee)?v:y?D:w?_:v}function J(){return!1}function K(ee,M){return ee="[object "+ee+"]",function(G){return null!=G&&{}.toString.call(M?G[M]:G)===ee}}},5166:(E,ae,Y)=>{var a=Y(6425);ae.createCodec=D,ae.install=function p(_){for(var F in _)w.prototype[F]=u(w.prototype[F],_[F])},ae.filter=function v(_){return a(_)?function k(_){return _=_.slice(),function(oe){return _.reduce(F,oe)};function F(oe,V){return V(oe)}}(_):_};var y=Y(6093);function w(_){if(!(this instanceof w))return new w(_);this.options=_,this.init()}function u(_,F){return _&&F?function oe(){return _.apply(this,arguments),F.apply(this,arguments)}:_||F}function D(_){return new w(_)}w.prototype.init=function(){var _=this.options;return _&&_.uint8array&&(this.bufferish=y.Uint8Array),this},ae.preset=D({preset:!0})},9234:(E,ae,Y)=>{Y(8334),Y(2732),Y(5166)},5333:(E,ae,Y)=>{ae.T=w;var a=Y(8334).preset;function w(p){if(!(this instanceof w))return new w(p);if(p&&(this.options=p,p.codec)){var u=this.codec=p.codec;u.bufferish&&(this.bufferish=u.bufferish)}}Y(6473).k.mixin(w.prototype),w.prototype.codec=a,w.prototype.fetch=function(){return this.codec.decode(this)}},9175:(E,ae,Y)=>{ae.decode=function y(w,p){var u=new a(p);return u.write(w),u.read()};var a=Y(5333).T},8131:(E,ae,Y)=>{var y=Y(6654),w=Y(5333).T;function p(u){if(!(this instanceof p))return new p(u);w.call(this,u)}p.prototype=new w,y.mixin(p.prototype),p.prototype.decode=function(u){arguments.length&&this.write(u),this.flush()},p.prototype.push=function(u){this.emit("data",u)},p.prototype.end=function(u){this.decode(u),this.emit("end")}},8400:(E,ae,Y)=>{ae.F=w;var a=Y(2732).preset;function w(p){if(!(this instanceof w))return new w(p);if(p&&(this.options=p,p.codec)){var u=this.codec=p.codec;u.bufferish&&(this.bufferish=u.bufferish)}}Y(6473).I.mixin(w.prototype),w.prototype.codec=a,w.prototype.write=function(p){this.codec.encode(this,p)}},8048:(E,ae,Y)=>{ae.encode=function y(w,p){var u=new a(p);return u.write(w),u.read()};var a=Y(8400).F},7704:(E,ae,Y)=>{var y=Y(6654),w=Y(8400).F;function p(u){if(!(this instanceof p))return new p(u);w.call(this,u)}p.prototype=new w,y.mixin(p.prototype),p.prototype.encode=function(u){this.write(u),this.emit("data",this.read())},p.prototype.end=function(u){arguments.length&&this.encode(u),this.flush(),this.emit("end")}},7846:(E,ae,Y)=>{ae.S=function y(w,p){if(!(this instanceof y))return new y(w,p);this.buffer=a.from(w),this.type=p};var a=Y(6093)},4106:(E,ae,Y)=>{ae.setExtPackers=function k(oe){oe.addExtPacker(14,Error,[F,v]),oe.addExtPacker(1,EvalError,[F,v]),oe.addExtPacker(2,RangeError,[F,v]),oe.addExtPacker(3,ReferenceError,[F,v]),oe.addExtPacker(4,SyntaxError,[F,v]),oe.addExtPacker(5,TypeError,[F,v]),oe.addExtPacker(6,URIError,[F,v]),oe.addExtPacker(10,RegExp,[_,v]),oe.addExtPacker(11,Boolean,[D,v]),oe.addExtPacker(12,String,[D,v]),oe.addExtPacker(13,Date,[Number,v]),oe.addExtPacker(15,Number,[D,v]),"undefined"!=typeof Uint8Array&&(oe.addExtPacker(17,Int8Array,w),oe.addExtPacker(18,Uint8Array,w),oe.addExtPacker(19,Int16Array,w),oe.addExtPacker(20,Uint16Array,w),oe.addExtPacker(21,Int32Array,w),oe.addExtPacker(22,Uint32Array,w),oe.addExtPacker(23,Float32Array,w),"undefined"!=typeof Float64Array&&oe.addExtPacker(24,Float64Array,w),"undefined"!=typeof Uint8ClampedArray&&oe.addExtPacker(25,Uint8ClampedArray,w),oe.addExtPacker(26,ArrayBuffer,w),oe.addExtPacker(29,DataView,w)),a.hasBuffer&&oe.addExtPacker(27,y,a.from)};var p,a=Y(6093),y=a.global,w=a.Uint8Array.from,u={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function v(oe){return p||(p=Y(8048).encode),p(oe)}function D(oe){return oe.valueOf()}function _(oe){(oe=RegExp.prototype.toString.call(oe).split("/")).shift();var V=[oe.pop()];return V.unshift(oe.join("/")),V}function F(oe){var V={};for(var L in u)V[L]=oe[L];return V}},9146:(E,ae,Y)=>{ae.setExtUnpackers=function u(oe){oe.addExtUnpacker(14,[k,D(Error)]),oe.addExtUnpacker(1,[k,D(EvalError)]),oe.addExtUnpacker(2,[k,D(RangeError)]),oe.addExtUnpacker(3,[k,D(ReferenceError)]),oe.addExtUnpacker(4,[k,D(SyntaxError)]),oe.addExtUnpacker(5,[k,D(TypeError)]),oe.addExtUnpacker(6,[k,D(URIError)]),oe.addExtUnpacker(10,[k,v]),oe.addExtUnpacker(11,[k,_(Boolean)]),oe.addExtUnpacker(12,[k,_(String)]),oe.addExtUnpacker(13,[k,_(Date)]),oe.addExtUnpacker(15,[k,_(Number)]),"undefined"!=typeof Uint8Array&&(oe.addExtUnpacker(17,_(Int8Array)),oe.addExtUnpacker(18,_(Uint8Array)),oe.addExtUnpacker(19,[F,_(Int16Array)]),oe.addExtUnpacker(20,[F,_(Uint16Array)]),oe.addExtUnpacker(21,[F,_(Int32Array)]),oe.addExtUnpacker(22,[F,_(Uint32Array)]),oe.addExtUnpacker(23,[F,_(Float32Array)]),"undefined"!=typeof Float64Array&&oe.addExtUnpacker(24,[F,_(Float64Array)]),"undefined"!=typeof Uint8ClampedArray&&oe.addExtUnpacker(25,_(Uint8ClampedArray)),oe.addExtUnpacker(26,F),oe.addExtUnpacker(29,[F,_(DataView)])),a.hasBuffer&&oe.addExtUnpacker(27,_(y))};var w,a=Y(6093),y=a.global,p={name:1,message:1,stack:1,columnNumber:1,fileName:1,lineNumber:1};function k(oe){return w||(w=Y(9175).decode),w(oe)}function v(oe){return RegExp.apply(null,oe)}function D(oe){return function(V){var L=new oe;for(var H in p)L[H]=V[H];return L}}function _(oe){return function(V){return new oe(V)}}function F(oe){return new Uint8Array(oe).buffer}},1490:(E,ae,Y)=>{Y(8334),Y(2732),Y(5166)},6473:(E,ae,Y)=>{ae.k=u,ae.I=k;var a=Y(6093),p="BUFFER_SHORTAGE";function u(){if(!(this instanceof u))return new u}function k(){if(!(this instanceof k))return new k}function _(){throw new Error("method not implemented: write()")}function F(){throw new Error("method not implemented: fetch()")}function oe(){return this.buffers&&this.buffers.length?(this.flush(),this.pull()):this.fetch()}function V(U){(this.buffers||(this.buffers=[])).push(U)}function L(){return(this.buffers||(this.buffers=[])).shift()}function H(U){return function se(ue){for(var J in U)ue[J]=U[J];return ue}}u.mixin=H(function v(){return{bufferish:a,write:function U(J){var K=this.offset?a.prototype.slice.call(this.buffer,this.offset):this.buffer;this.buffer=K?J?this.bufferish.concat([K,J]):K:J,this.offset=0},fetch:F,flush:function se(){for(;this.offset<this.buffer.length;){var K,J=this.offset;try{K=this.fetch()}catch(ee){if(ee&&ee.message!=p)throw ee;this.offset=J;break}this.push(K)}},push:V,pull:L,read:oe,reserve:function ue(J){var K=this.offset,ee=K+J;if(ee>this.buffer.length)throw new Error(p);return this.offset=ee,K},offset:0}}()),u.mixin(u.prototype),k.mixin=H(function D(){return{bufferish:a,write:_,fetch:function U(){var ee=this.start;if(ee<this.offset){var M=this.start=this.offset;return a.prototype.slice.call(this.buffer,ee,M)}},flush:function se(){for(;this.start<this.offset;){var ee=this.fetch();ee&&this.push(ee)}},push:V,pull:function ue(){var ee=this.buffers||(this.buffers=[]),M=ee.length>1?this.bufferish.concat(ee):ee[0];return ee.length=0,M},read:oe,reserve:function J(ee){var M=0|ee;if(this.buffer){var G=this.buffer.length,z=0|this.offset,A=z+M;if(A<G)return this.offset=A,z;this.flush(),ee=Math.max(ee,Math.min(2*G,this.maxBufferSize))}return ee=Math.max(ee,this.minBufferSize),this.buffer=this.bufferish.alloc(ee),this.start=0,this.offset=M,0},send:function K(ee){var M=ee.length;if(M>this.minBufferSize)this.flush(),this.push(ee);else{var G=this.reserve(M);a.prototype.copy.call(ee,this.buffer,G)}},maxBufferSize:65536,minBufferSize:2048,offset:0,start:0}}()),k.mixin(k.prototype)},8334:(E,ae,Y)=>{var a=Y(7846).S,y=Y(9146),w=Y(4613).readUint8,p=Y(1788),u=Y(5166);function v(){var F=this.options;return this.decode=function k(F){var oe=p.getReadToken(F);return function V(L){var H=w(L),U=oe[H];if(!U)throw new Error("Invalid type: "+(H&&"0x"+H.toString(16)));return U(L)}}(F),F&&F.preset&&y.setExtUnpackers(this),this}u.install({addExtUnpacker:function D(F,oe){(this.extUnpackers||(this.extUnpackers=[]))[F]=u.filter(oe)},getExtUnpacker:function _(F){return(this.extUnpackers||(this.extUnpackers=[]))[F]||function V(L){return new a(L,F)}},init:v}),ae.preset=v.call(u.preset)},4613:(E,ae,Y)=>{var a=Y(8461),y=Y(6256),w=y.Uint64BE,p=y.Int64BE;ae.getReadFormat=function _(h){var l=h&&h.int64;return{map:v&&h&&h.usemap?oe:F,array:V,str:L,bin:u.hasArrayBuffer&&h&&h.binarraybuffer?U:H,ext:se,uint8:ue,uint16:K,uint32:M,uint64:z(8,l?P:A),int8:J,int16:ee,int32:G,int64:z(8,l?g:N),float32:z(4,b),float64:z(8,C)}},ae.readUint8=ue;var u=Y(6093),k=Y(5364),v="undefined"!=typeof Map;function F(h,c){var f,l={},m=new Array(c),x=new Array(c),S=h.codec.decode;for(f=0;f<c;f++)m[f]=S(h),x[f]=S(h);for(f=0;f<c;f++)l[m[f]]=x[f];return l}function oe(h,c){var f,l=new Map,m=new Array(c),x=new Array(c),S=h.codec.decode;for(f=0;f<c;f++)m[f]=S(h),x[f]=S(h);for(f=0;f<c;f++)l.set(m[f],x[f]);return l}function V(h,c){for(var l=new Array(c),f=h.codec.decode,m=0;m<c;m++)l[m]=f(h);return l}function L(h,c){var l=h.reserve(c);return k.toString.call(h.buffer,"utf-8",l,l+c)}function H(h,c){var l=h.reserve(c),m=k.slice.call(h.buffer,l,l+c);return u.from(m)}function U(h,c){var l=h.reserve(c),m=k.slice.call(h.buffer,l,l+c);return u.Uint8Array.from(m).buffer}function se(h,c){var l=h.reserve(c+1),f=h.buffer[l++],m=l+c,x=h.codec.getExtUnpacker(f);if(!x)throw new Error("Invalid ext type: "+(f&&"0x"+f.toString(16)));return x(k.slice.call(h.buffer,l,m))}function ue(h){var c=h.reserve(1);return h.buffer[c]}function J(h){var c=h.reserve(1),l=h.buffer[c];return 128&l?l-256:l}function K(h){var c=h.reserve(2),l=h.buffer;return l[c++]<<8|l[c]}function ee(h){var c=h.reserve(2),l=h.buffer,f=l[c++]<<8|l[c];return 32768&f?f-65536:f}function M(h){var c=h.reserve(4),l=h.buffer;return 16777216*l[c++]+(l[c++]<<16)+(l[c++]<<8)+l[c]}function G(h){var c=h.reserve(4),l=h.buffer;return l[c++]<<24|l[c++]<<16|l[c++]<<8|l[c]}function z(h,c){return function(l){var f=l.reserve(h);return c.call(l.buffer,f,!0)}}function A(h){return new w(this,h).toNumber()}function N(h){return new p(this,h).toNumber()}function P(h){return new w(this,h)}function g(h){return new p(this,h)}function b(h){return a.read(this,h,!1,23,4)}function C(h){return a.read(this,h,!1,52,8)}},1788:(E,ae,Y)=>{var a=Y(4613);function w(D){var _,F=new Array(256);for(_=0;_<=127;_++)F[_]=u(_);for(_=128;_<=143;_++)F[_]=v(_-128,D.map);for(_=144;_<=159;_++)F[_]=v(_-144,D.array);for(_=160;_<=191;_++)F[_]=v(_-160,D.str);for(F[192]=u(null),F[193]=null,F[194]=u(!1),F[195]=u(!0),F[196]=k(D.uint8,D.bin),F[197]=k(D.uint16,D.bin),F[198]=k(D.uint32,D.bin),F[199]=k(D.uint8,D.ext),F[200]=k(D.uint16,D.ext),F[201]=k(D.uint32,D.ext),F[202]=D.float32,F[203]=D.float64,F[204]=D.uint8,F[205]=D.uint16,F[206]=D.uint32,F[207]=D.uint64,F[208]=D.int8,F[209]=D.int16,F[210]=D.int32,F[211]=D.int64,F[212]=v(1,D.ext),F[213]=v(2,D.ext),F[214]=v(4,D.ext),F[215]=v(8,D.ext),F[216]=v(16,D.ext),F[217]=k(D.uint8,D.str),F[218]=k(D.uint16,D.str),F[219]=k(D.uint32,D.str),F[220]=k(D.uint16,D.array),F[221]=k(D.uint32,D.array),F[222]=k(D.uint16,D.map),F[223]=k(D.uint32,D.map),_=224;_<=255;_++)F[_]=u(_-256);return F}function u(D){return function(){return D}}function k(D,_){return function(F){var oe=D(F);return _(F,oe)}}function v(D,_){return function(F){return _(F,D)}}ae.getReadToken=function y(D){var _=a.getReadFormat(D);return D&&D.useraw?function p(D){var _,F=w(D).slice();for(F[217]=F[196],F[218]=F[197],F[219]=F[198],_=160;_<=191;_++)F[_]=v(_-160,D.bin);return F}(_):w(_)}},2732:(E,ae,Y)=>{var a=Y(7846).S,y=Y(4106),w=Y(9118),p=Y(5166);function k(){var _=this.options;return this.encode=function u(_){var F=w.getWriteType(_);return function oe(V,L){var H=F[typeof L];if(!H)throw new Error('Unsupported type "'+typeof L+'": '+L);H(V,L)}}(_),_&&_.preset&&y.setExtPackers(this),this}p.install({addExtPacker:function v(_,F,oe){oe=p.filter(oe);var V=F.name;function U(se){return oe&&(se=oe(se)),new a(se,_)}V&&"Object"!==V?(this.extPackers||(this.extPackers={}))[V]=U:(this.extEncoderList||(this.extEncoderList=[])).unshift([F,U])},getExtPacker:function D(_){var F=this.extPackers||(this.extPackers={}),oe=_.constructor,V=oe&&oe.name&&F[oe.name];if(V)return V;for(var L=this.extEncoderList||(this.extEncoderList=[]),H=L.length,U=0;U<H;U++){var se=L[U];if(oe===se[0])return se[1]}},init:k}),ae.preset=k.call(p.preset)},3041:(E,ae,Y)=>{var a=Y(8461),y=Y(6256),w=y.Uint64BE,p=y.Int64BE,u=Y(8323).w,k=Y(6093),v=k.global,_=k.hasBuffer&&"TYPED_ARRAY_SUPPORT"in v&&!v.TYPED_ARRAY_SUPPORT,F=k.hasBuffer&&v.prototype||{};function L(){var z=u.slice();return z[196]=U(196),z[197]=se(197),z[198]=ue(198),z[199]=U(199),z[200]=se(200),z[201]=ue(201),z[202]=J(202,4,F.writeFloatBE||M,!0),z[203]=J(203,8,F.writeDoubleBE||G,!0),z[204]=U(204),z[205]=se(205),z[206]=ue(206),z[207]=J(207,8,K),z[208]=U(208),z[209]=se(209),z[210]=ue(210),z[211]=J(211,8,ee),z[217]=U(217),z[218]=se(218),z[219]=ue(219),z[220]=se(220),z[221]=ue(221),z[222]=se(222),z[223]=ue(223),z}function U(z){return function(A,N){var P=A.reserve(2),g=A.buffer;g[P++]=z,g[P]=N}}function se(z){return function(A,N){var P=A.reserve(3),g=A.buffer;g[P++]=z,g[P++]=N>>>8,g[P]=N}}function ue(z){return function(A,N){var P=A.reserve(5),g=A.buffer;g[P++]=z,g[P++]=N>>>24,g[P++]=N>>>16,g[P++]=N>>>8,g[P]=N}}function J(z,A,N,P){return function(g,b){var C=g.reserve(A+1);g.buffer[C++]=z,N.call(g.buffer,b,C,P)}}function K(z,A){new w(this,A,z)}function ee(z,A){new p(this,A,z)}function M(z,A){a.write(this,z,A,!1,23,4)}function G(z,A){a.write(this,z,A,!1,52,8)}ae.getWriteToken=function oe(z){return z&&z.uint8array?function V(){var z=L();return z[202]=J(202,4,M),z[203]=J(203,8,G),z}():_||k.hasBuffer&&z&&z.safe?function H(){var z=u.slice();return z[196]=J(196,1,v.prototype.writeUInt8),z[197]=J(197,2,v.prototype.writeUInt16BE),z[198]=J(198,4,v.prototype.writeUInt32BE),z[199]=J(199,1,v.prototype.writeUInt8),z[200]=J(200,2,v.prototype.writeUInt16BE),z[201]=J(201,4,v.prototype.writeUInt32BE),z[202]=J(202,4,v.prototype.writeFloatBE),z[203]=J(203,8,v.prototype.writeDoubleBE),z[204]=J(204,1,v.prototype.writeUInt8),z[205]=J(205,2,v.prototype.writeUInt16BE),z[206]=J(206,4,v.prototype.writeUInt32BE),z[207]=J(207,8,K),z[208]=J(208,1,v.prototype.writeInt8),z[209]=J(209,2,v.prototype.writeInt16BE),z[210]=J(210,4,v.prototype.writeInt32BE),z[211]=J(211,8,ee),z[217]=J(217,1,v.prototype.writeUInt8),z[218]=J(218,2,v.prototype.writeUInt16BE),z[219]=J(219,4,v.prototype.writeUInt32BE),z[220]=J(220,2,v.prototype.writeUInt16BE),z[221]=J(221,4,v.prototype.writeUInt32BE),z[222]=J(222,2,v.prototype.writeUInt16BE),z[223]=J(223,4,v.prototype.writeUInt32BE),z}():L()}},9118:(E,ae,Y)=>{var a=Y(6425),y=Y(6256),w=y.Uint64BE,p=y.Int64BE,u=Y(6093),k=Y(5364),v=Y(3041),D=Y(8323).w,_=Y(7846).S,F="undefined"!=typeof Uint8Array,oe="undefined"!=typeof Map,V=[];V[1]=212,V[2]=213,V[4]=214,V[8]=215,V[16]=216,ae.getWriteType=function L(H){var U=v.getWriteToken(H),se=H&&H.useraw,ue=F&&H&&H.binarraybuffer,J=ue?u.isArrayBuffer:u.isBuffer,K=ue?function x(T,R){m(T,new Uint8Array(R))}:m,M=oe&&H&&H.usemap?function le(T,R){if(!(R instanceof Map))return Z(T,R);var ie=R.size;U[ie<16?128+ie:ie<=65535?222:223](T,ie);var ve=T.codec.encode;R.forEach(function(de,we,ce){ve(T,we),ve(T,de)})}:Z;return{boolean:function z(T,R){U[R?195:194](T,R)},function:l,number:function A(T,R){var ie=0|R;R===ie?U[-32<=ie&&ie<=127?255&ie:0<=ie?ie<=255?204:ie<=65535?205:206:-128<=ie?208:-32768<=ie?209:210](T,ie):U[203](T,R)},object:se?function c(T,R){if(J(R))return function ye(T,R){var ie=R.length;U[ie<32?160+ie:ie<=65535?218:219](T,ie),T.send(R)}(T,R);h(T,R)}:h,string:function C(T){return function R(ie,j){var ve=j.length;ie.offset=ie.reserve(5+3*ve);var we=ie.buffer,ce=T(ve),he=ie.offset+ce;ve=k.write.call(we,j,he);var B=T(ve);ce!==B&&k.copy.call(we,we,he+B-ce,he,he+ve),U[1===B?160+ve:B<=3?215+B:219](ie,ve),ie.offset+=ve}}(se?function b(T){return T<32?1:T<=65535?3:5}:function g(T){return T<32?1:T<=255?2:T<=65535?3:5}),symbol:l,undefined:l};function h(T,R){if(null===R)return l(T,R);if(J(R))return K(T,R);if(a(R))return function f(T,R){var ie=R.length;U[ie<16?144+ie:ie<=65535?220:221](T,ie);for(var ve=T.codec.encode,de=0;de<ie;de++)ve(T,R[de])}(T,R);if(w.isUint64BE(R))return function N(T,R){U[207](T,R.toArray())}(T,R);if(p.isInt64BE(R))return function P(T,R){U[211](T,R.toArray())}(T,R);var ie=T.codec.getExtPacker(R);if(ie&&(R=ie(R)),R instanceof _)return function S(T,R){var ie=R.buffer,j=ie.length;U[V[j]||(j<255?199:j<=65535?200:201)](T,j),D[R.type](T),T.send(ie)}(T,R);M(T,R)}function l(T,R){U[192](T,R)}function m(T,R){var ie=R.length;U[ie<255?196:ie<=65535?197:198](T,ie),T.send(R)}function Z(T,R){var ie=Object.keys(R),j=ie.length;U[j<16?128+j:j<=65535?222:223](T,j);var de=T.codec.encode;ie.forEach(function(we){de(T,we),de(T,R[we])})}}},8323:(E,ae)=>{for(var Y=ae.w=new Array(256),a=0;a<=255;a++)Y[a]=y(a);function y(w){return function(p){var u=p.reserve(1);p.buffer[u]=w}}},1203:E=>{function ae(w){var p="    ";if(isNaN(parseInt(w)))p=w;else switch(w){case 1:p=" ";break;case 2:p="  ";break;case 3:p="   ";break;case 4:p="    ";break;case 5:p="     ";break;case 6:p="      ";break;case 7:p="       ";break;case 8:p="        ";break;case 9:p="         ";break;case 10:p="          ";break;case 11:p="           ";break;case 12:p="            "}for(var u=["\n"],k=0;k<100;k++)u.push(u[k]+p);return u}function Y(){this.step="    ",this.shift=ae(this.step)}function a(w,p){return p-(w.replace(/\(/g,"").length-w.replace(/\)/g,"").length)}function y(w,p){return w.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+p+p+"AND ").replace(/ BETWEEN /gi,"~::~"+p+"BETWEEN ").replace(/ CASE /gi,"~::~"+p+"CASE ").replace(/ ELSE /gi,"~::~"+p+"ELSE ").replace(/ END /gi,"~::~"+p+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+p+"ON ").replace(/ OR /gi,"~::~"+p+p+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+p+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+p).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+p+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/\s{0,}UPDATE /gi,"UPDATE ").replace(/ SET /gi," SET ").replace(/~::~{1,}/g,"~::~").split("~::~")}Y.prototype.xml=function(w,p){var u=w.replace(/>\s{0,}</g,"><").replace(/</g,"~::~<").replace(/\s*xmlns\:/g,"~::~xmlns:").replace(/\s*xmlns\=/g,"~::~xmlns=").split("~::~"),k=u.length,v=!1,D=0,_="",F=0,oe=p?ae(p):this.shift;for(F=0;F<k;F++)u[F].search(/<!/)>-1?(_+=oe[D]+u[F],v=!0,(u[F].search(/-->/)>-1||u[F].search(/\]>/)>-1||u[F].search(/!DOCTYPE/)>-1)&&(v=!1)):u[F].search(/-->/)>-1||u[F].search(/\]>/)>-1?(_+=u[F],v=!1):/^<\w/.exec(u[F-1])&&/^<\/\w/.exec(u[F])&&/^<[\w:\-\.\,]+/.exec(u[F-1])==/^<\/[\w:\-\.\,]+/.exec(u[F])[0].replace("/","")?(_+=u[F],v||D--):u[F].search(/<\w/)>-1&&-1==u[F].search(/<\//)&&-1==u[F].search(/\/>/)?_=_+=v?u[F]:oe[D++]+u[F]:u[F].search(/<\w/)>-1&&u[F].search(/<\//)>-1?_=_+=v?u[F]:oe[D]+u[F]:u[F].search(/<\//)>-1?_=_+=v?u[F]:oe[--D]+u[F]:u[F].search(/\/>/)>-1?_=_+=v?u[F]:oe[D]+u[F]:u[F].search(/<\?/)>-1||u[F].search(/xmlns\:/)>-1||u[F].search(/xmlns\=/)>-1?_+=oe[D]+u[F]:_+=u[F];return"\n"==_[0]?_.slice(1):_},Y.prototype.json=function(w,u){return u=u||this.step,"undefined"==typeof JSON?w:"string"==typeof w?JSON.stringify(JSON.parse(w),null,u):"object"==typeof w?JSON.stringify(w,null,u):w},Y.prototype.css=function(w,p){var u=w.replace(/\s{1,}/g," ").replace(/\{/g,"{~::~").replace(/\}/g,"~::~}~::~").replace(/\;/g,";~::~").replace(/\/\*/g,"~::~/*").replace(/\*\//g,"*/~::~").replace(/~::~\s{0,}~::~/g,"~::~").split("~::~"),k=u.length,v=0,D="",_=0,F=p?ae(p):this.shift;for(_=0;_<k;_++)/\{/.exec(u[_])?D+=F[v++]+u[_]:/\}/.exec(u[_])?D+=F[--v]+u[_]:(/\*\\/.exec(u[_]),D+=F[v]+u[_]);return D.replace(/^\n{1,}/,"")},Y.prototype.sql=function(w,p){var u=w.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),k=u.length,v=[],D=0,_=this.step,V=0,L="",H=0,U=p?ae(p):this.shift;for(H=0;H<k;H++)v=v.concat(H%2?u[H]:y(u[H],_));for(k=v.length,H=0;H<k;H++)V=a(v[H],V),/\s{0,}\s{0,}SELECT\s{0,}/.exec(v[H])&&(v[H]=v[H].replace(/\,/g,",\n"+_+_)),/\s{0,}\s{0,}SET\s{0,}/.exec(v[H])&&(v[H]=v[H].replace(/\,/g,",\n"+_+_)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(v[H])?L+=U[++D]+v[H]:/\'/.exec(v[H])?(V<1&&D&&D--,L+=v[H]):(L+=U[D]+v[H],V<1&&D&&D--);return L.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")},Y.prototype.xmlmin=function(w,p){return(p?w:w.replace(/\<![ \r\n\t]*(--([^\-]|[\r\n]|-[^\-])*--[ \r\n\t]*)\>/g,"").replace(/[ \r\n\t]{1,}xmlns/g," xmlns")).replace(/>\s{0,}</g,"><")},Y.prototype.jsonmin=function(w){return"undefined"==typeof JSON?w:JSON.stringify(JSON.parse(w),null,0)},Y.prototype.cssmin=function(w,p){return(p?w:w.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*+\//g,"")).replace(/\s{1,}/g," ").replace(/\{\s{1,}/g,"{").replace(/\}\s{1,}/g,"}").replace(/\;\s{1,}/g,";").replace(/\/\*\s{1,}/g,"/*").replace(/\*\/\s{1,}/g,"*/")},Y.prototype.sqlmin=function(w){return w.replace(/\s{1,}/g," ").replace(/\s{1,}\(/,"(").replace(/\s{1,}\)/,")")},E.exports=new Y},85:(E,ae,Y)=>{var a={"./AFF2e":[7676,7327],"./AFF2e.js":[7676,7327],"./AceKillerGene":[1439,7217],"./AceKillerGene.js":[1439,7217],"./Ainecadette":[2160,8150],"./Ainecadette.js":[2160,8150],"./Airgetlamh":[6408,5247],"./Airgetlamh.js":[6408,5247],"./AlchemiaStruggle":[6510,5225],"./AlchemiaStruggle.js":[6510,5225],"./Alsetto":[905,2948],"./Alsetto.js":[905,2948],"./Alshard":[7058,6420],"./Alshard.js":[7058,6420],"./AlterRaise":[1105,3385],"./AlterRaise.js":[1105,3385],"./Amadeus":[5752,1582],"./Amadeus.js":[5752,1582],"./Amadeus_Korean":[6602,5512],"./Amadeus_Korean.js":[6602,5512],"./AngelGear":[4200,9437],"./AngelGear.js":[4200,9437],"./AnimaAnimus":[7164,2919],"./AnimaAnimus.js":[7164,2919],"./Aoharubaan":[5757,6968],"./Aoharubaan.js":[5757,6968],"./Arianrhod":[4005,5283],"./Arianrhod.js":[4005,5283],"./ArsMagica":[3655,5734],"./ArsMagica.js":[3655,5734],"./AssaultEngine":[3898,4339],"./AssaultEngine.js":[3898,4339],"./Avandner":[8206,3084],"./Avandner.js":[8206,3084],"./Ayabito":[5853,1253],"./Ayabito.js":[5853,1253],"./BBN":[8554,2522],"./BBN.js":[8554,2522],"./BadLife":[9538,4872],"./BadLife.js":[9538,4872],"./Bakenokawa":[6103,2135],"./Bakenokawa.js":[6103,2135],"./BarnaKronika":[5396,7073],"./BarnaKronika.js":[5396,7073],"./BattleTech":[2890,6344],"./BattleTech.js":[2890,6344],"./BeastBindTrinity":[1063,4572],"./BeastBindTrinity.js":[1063,4572],"./BeginningIdol":[8857,66],"./BeginningIdol.js":[8857,66],"./BeginningIdol2022":[8381,6466],"./BeginningIdol2022.js":[8381,6466],"./BeginningIdol_Korean":[7816,7117],"./BeginningIdol_Korean.js":[7816,7117],"./BladeOfArcana":[3449,1087],"./BladeOfArcana.js":[3449,1087],"./BlindMythos":[2639,5539],"./BlindMythos.js":[2639,5539],"./BloodCrusade":[2906,2013],"./BloodCrusade.js":[2906,2013],"./BloodMoon":[7994,593],"./BloodMoon.js":[7994,593],"./CardRanker":[6006,873],"./CardRanker.js":[6006,873],"./CastleInGray":[2519,1820],"./CastleInGray.js":[2519,1820],"./ChaosFlare":[229,1114],"./ChaosFlare.js":[229,1114],"./Chill":[9894,1919],"./Chill.js":[9894,1919],"./Chill3":[3294,8585],"./Chill3.js":[3294,8585],"./CodeLayerd":[6106,9606],"./CodeLayerd.js":[6106,9606],"./ColossalHunter":[519,2461],"./ColossalHunter.js":[519,2461],"./Comes":[1712,2793],"./Comes.js":[1712,2793],"./CrashWorld":[6506,2519],"./CrashWorld.js":[6506,2519],"./Cthulhu":[2605,3364],"./Cthulhu.js":[2605,3364],"./Cthulhu7th":[5149,8376],"./Cthulhu7th.js":[5149,8376],"./Cthulhu7th_ChineseTraditional":[9464,6447],"./Cthulhu7th_ChineseTraditional.js":[9464,6447],"./Cthulhu7th_Korean":[329,7170],"./Cthulhu7th_Korean.js":[329,7170],"./CthulhuTech":[9818,2555],"./CthulhuTech.js":[9818,2555],"./Cthulhu_ChineseTraditional":[3109,9285],"./Cthulhu_ChineseTraditional.js":[3109,9285],"./Cthulhu_Korean":[9585,7008],"./Cthulhu_Korean.js":[9585,7008],"./Cthulhu_SimplifiedChinese":[4916,1448],"./Cthulhu_SimplifiedChinese.js":[4916,1448],"./CyberpunkRed":[1933,347],"./CyberpunkRed.js":[1933,347],"./DarkBlaze":[7810,3005],"./DarkBlaze.js":[7810,3005],"./DarkDaysDrive":[3543,5736],"./DarkDaysDrive.js":[3543,5736],"./DarkSouls":[5581,3958],"./DarkSouls.js":[5581,3958],"./DeadlineHeroes":[2270,6143],"./DeadlineHeroes.js":[2270,6143],"./DemonParasite":[7605,5670],"./DemonParasite.js":[7605,5670],"./DesperateRun":[8999,148],"./DesperateRun.js":[8999,148],"./DetatokoSaga":[3264,5413],"./DetatokoSaga.js":[3264,5413],"./DetatokoSaga_Korean":[4236,7553],"./DetatokoSaga_Korean.js":[4236,7553],"./DiceBot":[8618,8159],"./DiceBot.js":[8618,8159],"./DiceOfTheDead":[2533,5651],"./DiceOfTheDead.js":[2533,5651],"./DoubleCross":[1316,8436],"./DoubleCross.js":[1316,8436],"./DoubleCross_Korean":[9761,6708],"./DoubleCross_Korean.js":[9761,6708],"./Dracurouge":[2204,2697],"./Dracurouge.js":[2204,2697],"./Dracurouge_Korean":[759,9678],"./Dracurouge_Korean.js":[759,9678],"./DungeonsAndDragons":[8454,8358],"./DungeonsAndDragons.js":[8454,8358],"./EarthDawn":[1329,517],"./EarthDawn.js":[1329,517],"./EarthDawn3":[4021,9730],"./EarthDawn3.js":[4021,9730],"./EarthDawn4":[9918,809],"./EarthDawn4.js":[9918,809],"./EclipsePhase":[410,9735],"./EclipsePhase.js":[410,9735],"./Elric":[8326,7309],"./Elric.js":[8326,7309],"./Elysion":[9626,7372],"./Elysion.js":[9626,7372],"./EmbryoMachine":[2035,9755],"./EmbryoMachine.js":[2035,9755],"./Emoklore":[8686,5620],"./Emoklore.js":[8686,5620],"./EndBreaker":[4869,3515],"./EndBreaker.js":[4869,3515],"./EtrianOdysseySRS":[3460,1851],"./EtrianOdysseySRS.js":[3460,1851],"./FateCoreSystem":[5925,5899],"./FateCoreSystem.js":[5925,5899],"./Fiasco":[6587,6739],"./Fiasco.js":[6587,6739],"./Fiasco_Korean":[3734,7036],"./Fiasco_Korean.js":[3734,7036],"./FilledWith":[4239,6705],"./FilledWith.js":[4239,6705],"./FullMetalPanic":[1959,8725],"./FullMetalPanic.js":[1959,8725],"./FutariSousa":[2729,4564],"./FutariSousa.js":[2729,4564],"./FutariSousa_Korean":[4424,8175],"./FutariSousa_Korean.js":[4424,8175],"./GURPS":[7782,6908],"./GURPS.js":[7782,6908],"./Garako":[1948,8165],"./Garako.js":[1948,8165],"./GardenOrder":[2017,172],"./GardenOrder.js":[2017,172],"./GehennaAn":[1647,5105],"./GehennaAn.js":[1647,5105],"./GeishaGirlwithKatana":[5593,8780],"./GeishaGirlwithKatana.js":[5593,8780],"./GhostLive":[4656,9626],"./GhostLive.js":[4656,9626],"./GoblinSlayer":[3983,2006],"./GoblinSlayer.js":[3983,2006],"./GoldenSkyStories":[3437,9940],"./GoldenSkyStories.js":[3437,9940],"./Gorilla":[6362,7576],"./Gorilla.js":[6362,7576],"./GranCrest":[7150,6613],"./GranCrest.js":[7150,6613],"./Gundog":[8166,6501],"./Gundog.js":[8166,6501],"./GundogRevised":[4196,427],"./GundogRevised.js":[4196,427],"./GundogZero":[5273,493],"./GundogZero.js":[5273,493],"./GurpsFW":[882,6949],"./GurpsFW.js":[882,6949],"./HarnMaster":[6765,4075],"./HarnMaster.js":[6765,4075],"./HatsuneMiku":[3124,6589],"./HatsuneMiku.js":[3124,6589],"./Hieizan":[7418,8171],"./Hieizan.js":[7418,8171],"./HouraiGakuen":[7945,7155],"./HouraiGakuen.js":[7945,7155],"./HuntersMoon":[4873,1909],"./HuntersMoon.js":[4873,1909],"./IfIfIf":[7043,4507],"./IfIfIf.js":[7043,4507],"./Illusio":[3843,4796],"./Illusio.js":[3843,4796],"./InfiniteBabeL":[7878,7641],"./InfiniteBabeL.js":[7878,7641],"./InfiniteFantasia":[6391,391],"./InfiniteFantasia.js":[6391,391],"./Insane":[5844,9001],"./Insane.js":[5844,9001],"./Insane_Korean":[9199,1918],"./Insane_Korean.js":[9199,1918],"./Irisbane":[4167,6957],"./Irisbane.js":[4167,6957],"./IthaWenUa":[2726,9872],"./IthaWenUa.js":[2726,9872],"./JamesBond":[4866,7097],"./JamesBond.js":[4866,7097],"./JekyllAndHyde":[817,4788],"./JekyllAndHyde.js":[817,4788],"./JuinKansen":[9673,9327],"./JuinKansen.js":[9673,9327],"./Kamigakari":[2920,8602],"./Kamigakari.js":[2920,8602],"./Kamigakari_Korean":[6250,5309],"./Kamigakari_Korean.js":[6250,5309],"./KanColle":[4670,2098],"./KanColle.js":[4670,2098],"./Karukami":[2838,1616],"./Karukami.js":[2838,1616],"./KemonoNoMori":[1151,3962],"./KemonoNoMori.js":[1151,3962],"./KillDeathBusiness":[744,6750],"./KillDeathBusiness.js":[744,6750],"./KillDeathBusiness_Korean":[346,4401],"./KillDeathBusiness_Korean.js":[346,4401],"./KurayamiCrying":[5627,164],"./KurayamiCrying.js":[5627,164],"./Kutulu":[76,8790],"./Kutulu.js":[76,8790],"./LiveraDoll":[6459,8440],"./LiveraDoll.js":[6459,8440],"./LogHorizon":[8991,4810],"./LogHorizon.js":[8991,4810],"./LogHorizon_Korean":[8959,348],"./LogHorizon_Korean.js":[8959,348],"./LostRecord":[6543,7171],"./LostRecord.js":[6543,7171],"./LostRoyal":[9348,9625],"./LostRoyal.js":[9348,9625],"./MagicaLogia":[5563,2399],"./MagicaLogia.js":[5563,2399],"./MagicaLogia_Korean":[2586,7729],"./MagicaLogia_Korean.js":[2586,7729],"./MagicaLogia_SimplifiedChinese":[3677,6875],"./MagicaLogia_SimplifiedChinese.js":[3677,6875],"./MeikyuDays":[3433,1493],"./MeikyuDays.js":[3433,1493],"./MeikyuKingdom":[9889,8326],"./MeikyuKingdom.js":[9889,8326],"./MeikyuKingdomBasic":[668,7016],"./MeikyuKingdomBasic.js":[668,7016],"./MetalHead":[1175,7276],"./MetalHead.js":[1175,7276],"./MetalHeadExtream":[1587,3062],"./MetalHeadExtream.js":[1587,3062],"./MetallicGuardian":[1245,2040],"./MetallicGuardian.js":[1245,2040],"./MonotoneMuseum":[4351,735],"./MonotoneMuseum.js":[4351,735],"./MonotoneMuseum_Korean":[3989,5249],"./MonotoneMuseum_Korean.js":[3989,5249],"./NSSQ":[6681,4238],"./NSSQ.js":[6681,4238],"./Nechronica":[8885,3532],"./Nechronica.js":[8885,3532],"./Nechronica_Korean":[4361,4116],"./Nechronica_Korean.js":[4361,4116],"./NeverCloud":[9447,3096],"./NeverCloud.js":[9447,3096],"./NightWizard":[7740,5811],"./NightWizard.js":[7740,5811],"./NightWizard3rd":[4933,3535],"./NightWizard3rd.js":[4933,3535],"./NightmareHunterDeep":[1387,298],"./NightmareHunterDeep.js":[1387,298],"./NinjaSlayer":[517,7381],"./NinjaSlayer.js":[517,7381],"./NjslyrBattle":[596,3443],"./NjslyrBattle.js":[596,3443],"./Nuekagami":[1848,3293],"./Nuekagami.js":[1848,3293],"./OneWayHeroics":[1989,3852],"./OneWayHeroics.js":[1989,3852],"./OracleEngine":[978,2989],"./OracleEngine.js":[978,2989],"./OrgaRain":[8614,644],"./OrgaRain.js":[8614,644],"./Oukahoushin3rd":[7133,3407],"./Oukahoushin3rd.js":[7133,3407],"./Paradiso":[2313,4246],"./Paradiso.js":[2313,4246],"./Paranoia":[6634,1031],"./Paranoia.js":[6634,1031],"./ParanoiaRebooted":[9628,5289],"./ParanoiaRebooted.js":[9628,5289],"./ParasiteBlood":[8073,1410],"./ParasiteBlood.js":[8073,1410],"./Pathfinder":[5017,1599],"./Pathfinder.js":[5017,1599],"./Peekaboo":[9309,844],"./Peekaboo.js":[9309,844],"./Pendragon":[9113,2311],"./Pendragon.js":[9113,2311],"./PersonaO":[6706,481],"./PersonaO.js":[6706,481],"./PhantasmAdventure":[926,8614],"./PhantasmAdventure.js":[926,8614],"./Postman":[3021,5124],"./Postman.js":[3021,5124],"./PulpCthulhu":[4292,9449],"./PulpCthulhu.js":[4292,9449],"./Raisondetre":[2909,293],"./Raisondetre.js":[2909,293],"./RecordOfLodossWar":[1925,281],"./RecordOfLodossWar.js":[1925,281],"./RecordOfSteam":[1293,2213],"./RecordOfSteam.js":[1293,2213],"./Revulture":[573,9886],"./Revulture.js":[573,9886],"./RokumonSekai2":[3592,9495],"./RokumonSekai2.js":[3592,9495],"./RoleMaster":[7612,2625],"./RoleMaster.js":[7612,2625],"./RuinBreakers":[1349,7696],"./RuinBreakers.js":[1349,7696],"./RuneQuest":[7543,7480],"./RuneQuest.js":[7543,7480],"./RyuTuber":[1287,1766],"./RyuTuber.js":[1287,1766],"./Ryutama":[8123,585],"./Ryutama.js":[8123,585],"./SRS":[5762,1377],"./SRS.js":[5762,1377],"./SamsaraBallad":[2255,2250],"./SamsaraBallad.js":[2255,2250],"./Satasupe":[8236,3314],"./Satasupe.js":[8236,3314],"./ScreamHighSchool":[7728,512],"./ScreamHighSchool.js":[7728,512],"./Sengensyou":[1369,3109],"./Sengensyou.js":[1369,3109],"./SevenFortressMobius":[2004,1091],"./SevenFortressMobius.js":[2004,1091],"./ShadowRun":[7633,8975],"./ShadowRun.js":[7633,8975],"./ShadowRun4":[8489,5925],"./ShadowRun4.js":[8489,5925],"./ShadowRun5":[3265,3665],"./ShadowRun5.js":[3265,3665],"./SharedFantasia":[554,2025],"./SharedFantasia.js":[554,2025],"./ShinMegamiTenseiKakuseihen":[6821,8657],"./ShinMegamiTenseiKakuseihen.js":[6821,8657],"./ShinkuuGakuen":[708,1763],"./ShinkuuGakuen.js":[708,1763],"./ShinobiGami":[1946,132],"./ShinobiGami.js":[1946,132],"./Shiranui":[9776,2709],"./Shiranui.js":[9776,2709],"./ShoujoTenrankai":[8491,8565],"./ShoujoTenrankai.js":[8491,8565],"./ShuumatsuKikou":[918,533],"./ShuumatsuKikou.js":[918,533],"./Skynauts":[8327,5150],"./Skynauts.js":[8327,5150],"./SkynautsBouken":[5444,303],"./SkynautsBouken.js":[5444,303],"./StarryDolls":[783,9354],"./StarryDolls.js":[783,9354],"./SteamPunkers":[6339,7103],"./SteamPunkers.js":[6339,7103],"./StellarKnights":[5849,628],"./StellarKnights.js":[5849,628],"./StellarKnights_Korean":[2795,6768],"./StellarKnights_Korean.js":[2795,6768],"./StellarLife":[8594,3740],"./StellarLife.js":[8594,3740],"./StrangerOfSwordCity":[5214,1593],"./StrangerOfSwordCity.js":[5214,1593],"./StratoShout":[203,8470],"./StratoShout.js":[203,8470],"./StratoShout_Korean":[2030,6114],"./StratoShout_Korean.js":[2030,6114],"./Strave":[1758,8233],"./Strave.js":[1758,8233],"./SwordWorld":[8250,3210],"./SwordWorld.js":[8250,3210],"./SwordWorld2_0":[3840,7043],"./SwordWorld2_0.js":[3840,7043],"./SwordWorld2_5":[9527,9753],"./SwordWorld2_5.js":[9527,9753],"./TalesFromTheLoop":[4331,1982],"./TalesFromTheLoop.js":[4331,1982],"./TherapieSein":[4028,5405],"./TherapieSein.js":[4028,5405],"./TokumeiTenkousei":[4905,5101],"./TokumeiTenkousei.js":[4905,5101],"./TokyoGhostResearch":[3874,2686],"./TokyoGhostResearch.js":[3874,2686],"./TokyoNova":[7459,7455],"./TokyoNova.js":[7459,7455],"./Torg":[3042,6604],"./Torg.js":[3042,6604],"./Torg1_5":[3257,8177],"./Torg1_5.js":[3257,8177],"./TorgEternity":[9543,9931],"./TorgEternity.js":[9543,9931],"./ToshiakiHolyGrailWar":[1641,4957],"./ToshiakiHolyGrailWar.js":[1641,4957],"./TrinitySeven":[8262,589],"./TrinitySeven.js":[8262,589],"./TunnelsAndTrolls":[6450,5188],"./TunnelsAndTrolls.js":[6450,5188],"./TwilightGunsmoke":[4547,6331],"./TwilightGunsmoke.js":[4547,6331],"./UnsungDuet":[6694,1209],"./UnsungDuet.js":[6694,1209],"./Utakaze":[5520,357],"./Utakaze.js":[5520,357],"./VampireTheMasquerade5th":[6409,7115],"./VampireTheMasquerade5th.js":[6409,7115],"./Villaciel":[6633,4906],"./Villaciel.js":[6633,4906],"./VisionConnect":[2527,35],"./VisionConnect.js":[2527,35],"./WARPS":[8581,1380],"./WARPS.js":[8581,1380],"./WaresBlade":[9840,4213],"./WaresBlade.js":[9840,4213],"./Warhammer":[9883,7339],"./Warhammer.js":[9883,7339],"./Warhammer4":[2135,4837],"./Warhammer4.js":[2135,4837],"./WitchQuest":[3617,6088],"./WitchQuest.js":[3617,6088],"./WorldOfDarkness":[3350,3726],"./WorldOfDarkness.js":[3350,3726],"./YankeeYogSothoth":[1930,7906],"./YankeeYogSothoth.js":[1930,7906],"./YearZeroEngine":[929,6632],"./YearZeroEngine.js":[929,6632],"./Yggdrasill":[7157,6467],"./Yggdrasill.js":[7157,6467],"./ZettaiReido":[6698,4999],"./ZettaiReido.js":[6698,4999]};function y(w){if(!Y.o(a,w))return Promise.resolve().then(()=>{var k=new Error("Cannot find module '"+w+"'");throw k.code="MODULE_NOT_FOUND",k});var p=a[w],u=p[0];return Y.e(p[1]).then(()=>Y.t(u,23))}y.keys=()=>Object.keys(a),y.id=85,E.exports=y},6507:(E,ae,Y)=>{var a={"./Amadeus.ja_jp.json":[6070,9299],"./Amadeus.ko_kr.json":[765,4092],"./BeginningIdol.ja_jp.json":[5355,8635],"./BeginningIdol.ko_kr.json":[2590,6961],"./Cthulhu.ja_jp.json":[8128,652],"./Cthulhu.ko_kr.json":[7002,2617],"./Cthulhu.zh_hans.json":[4209,4922],"./Cthulhu.zh_hant.json":[8021,3147],"./DetatokoSaga.ja_jp.json":[4608,5777],"./DetatokoSaga.ko_kr.json":[408,4502],"./DoubleCross.ja_jp.json":[9221,8706],"./DoubleCross.ko_kr.json":[9734,8517],"./Dracurouge.ja_jp.json":[2286,2847],"./Dracurouge.ko_kr.json":[3597,155],"./Fiasco.ja_jp.json":[9873,1800],"./Fiasco.ko_kr.json":[5244,783],"./FutariSousa.ja_jp.json":[9491,8078],"./FutariSousa.ko_kr.json":[8721,9567],"./Insane.ja_jp.json":[5040,6446],"./Insane.ko_kr.json":[5488,3978],"./Kamigakari.ja_jp.json":[2742,3922],"./Kamigakari.ko_kr.json":[7708,1197],"./KillDeathBusiness.ja_jp.json":[2288,3760],"./KillDeathBusiness.ko_kr.json":[1847,287],"./LogHorizon.ja_jp.json":[6438,3811],"./LogHorizon.ko_kr.json":[8319,5106],"./MagicaLogia.ja_jp.json":[4786,9120],"./MagicaLogia.ko_kr.json":[339,2107],"./MagicaLogia.zh_hans.json":[9116,3229],"./MonotoneMuseum.ja_jp.json":[5628,7848],"./MonotoneMuseum.ko_kr.json":[1302,8157],"./Nechronica.ja_jp.json":[9437,667],"./Nechronica.ko_kr.json":[4241,7743],"./StellarKnights.ja_jp.json":[7251,9206],"./StellarKnights.ko_kr.json":[6697,5717],"./StratoShout.ja_jp.json":[7313,7015],"./StratoShout.ko_kr.json":[424,4113],"./SwordWorld.ja_jp.json":[1243,7348],"./SwordWorld2_0.ja_jp.json":[7547,5351],"./SwordWorld2_5.ja_jp.json":[8368,669]};function y(w){if(!Y.o(a,w))return Promise.resolve().then(()=>{var k=new Error("Cannot find module '"+w+"'");throw k.code="MODULE_NOT_FOUND",k});var p=a[w],u=p[0];return Y.e(p[1]).then(()=>Y.t(u,19))}y.keys=()=>Object.keys(a),y.id=6507,E.exports=y},2480:()=>{},5861:(E,ae,Y)=>{"use strict";function a(w,p,u,k,v,D,_){try{var F=w[D](_),oe=F.value}catch(V){return void u(V)}F.done?p(oe):Promise.resolve(oe).then(k,v)}function y(w){return function(){var p=this,u=arguments;return new Promise(function(k,v){var D=w.apply(p,u);function _(oe){a(D,k,v,_,F,"next",oe)}function F(oe){a(D,k,v,_,F,"throw",oe)}_(void 0)})}}Y.d(ae,{Z:()=>y})},4682:E=>{"use strict";E.exports=JSON.parse('{"gameSystems":[{"id":"Villaciel","name":"\u84bc\u5929\u306e\u30f4\u30a3\u30e9\u30b7\u30a8\u30eb","className":"Villaciel","superClassName":"Base","sortKey":"\u305d\u3046\u3066\u3093\u306e\u3046\u3044\u3089\u3057\u3048\u308b","locale":"ja_jp"},{"id":"SamsaraBallad","name":"\u30b5\u30f3\u30b5\u30fc\u30e9\u30fb\u30d0\u30e9\u30c3\u30c9","className":"SamsaraBallad","superClassName":"Base","sortKey":"\u3055\u3093\u3055\u3042\u3089\u306f\u3089\u3064\u3068","locale":"ja_jp"},{"id":"Satasupe","name":"\u30b5\u30bf\u30b9\u30da","className":"Satasupe","superClassName":"Base","sortKey":"\u3055\u305f\u3059\u3078","locale":"ja_jp"},{"id":"MagicaLogia:Korean","name":"\ub9c8\uae30\uce74\ub85c\uae30\uc544","className":"MagicaLogia_Korean","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Korean:\ub9c8\uae30\uce74\ub85c\uae30\uc544","locale":"ko_kr"},{"id":"MagicaLogia:SimplifiedChinese","name":"\u9b54\u5bfc\u4e66\u5927\u6218","className":"MagicaLogia_SimplifiedChinese","superClassName":"MagicaLogia","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u9b54\u5bfc\u4e66\u5927\u6218","locale":"zh_hans"},{"id":"MeikyuDays","name":"\u8ff7\u5bae\u30c7\u30a4\u30ba","className":"MeikyuDays","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u3066\u3044\u3059","locale":"ja_jp"},{"id":"MeikyuKingdom","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0","className":"MeikyuKingdom","superClassName":"Base","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080","locale":"ja_jp"},{"id":"BloodCrusade","name":"\u30d6\u30e9\u30c3\u30c9\u30fb\u30af\u30eb\u30bb\u30a4\u30c9","className":"BloodCrusade","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u304f\u308b\u305b\u3044\u3068","locale":"ja_jp"},{"id":"BloodMoon","name":"\u30d6\u30e9\u30c3\u30c9\u30e0\u30fc\u30f3","className":"BloodMoon","superClassName":"Base","sortKey":"\u3075\u3089\u3064\u3068\u3080\u3046\u3093","locale":"ja_jp"},{"id":"AFF2e","name":"ADVANCED FIGHTING FANTASY 2nd Edition","className":"AFF2e","superClassName":"Base","sortKey":"\u3042\u3068\u306f\u3093\u3059\u3068\u3075\u3042\u3044\u3066\u3044\u3093\u304f\u3075\u3042\u3093\u305f\u3057\u30442","locale":"ja_jp"},{"id":"CardRanker","name":"\u30ab\u30fc\u30c9\u30e9\u30f3\u30ab\u30fc","className":"CardRanker","superClassName":"Base","sortKey":"\u304b\u3042\u3068\u3089\u3093\u304b\u3042","locale":"ja_jp"},{"id":"CastleInGray","name":"\u7070\u8272\u57ce\u7dba\u8b5a","className":"CastleInGray","superClassName":"Base","sortKey":"\u306f\u3044\u3044\u308d\u3057\u3088\u3046\u304d\u305f\u3093","locale":"ja_jp"},{"id":"ChaosFlare","name":"\u30ab\u30aa\u30b9\u30d5\u30ec\u30a2","className":"ChaosFlare","superClassName":"Base","sortKey":"\u304b\u304a\u3059\u3075\u308c\u3042","locale":"ja_jp"},{"id":"EmbryoMachine","name":"\u30a8\u30e0\u30d6\u30ea\u30aa\u30de\u30b7\u30f3RPG","className":"EmbryoMachine","superClassName":"Base","sortKey":"\u3048\u3080\u3075\u308a\u304a\u307e\u3057\u3093RPG","locale":"ja_jp"},{"id":"AceKillerGene","name":"\u30a8\u30fc\u30b9\u30ad\u30e9\u30fc\u30b8\u30fc\u30f3","className":"AceKillerGene","superClassName":"GardenOrder","sortKey":"\u3048\u3048\u3059\u304d\u3089\u3042\u3057\u3044\u3093","locale":"ja_jp"},{"id":"GardenOrder","name":"\u30ac\u30fc\u30c7\u30f3\u30aa\u30fc\u30c0\u30fc","className":"GardenOrder","superClassName":"Base","sortKey":"\u304b\u3042\u3066\u3093\u304a\u304a\u305f\u3042","locale":"ja_jp"},{"id":"Chill","name":"Chill","className":"Chill","superClassName":"Base","sortKey":"\u3061\u308b","locale":"ja_jp"},{"id":"VisionConnect","name":"\u30f4\u30a3\u30b8\u30e7\u30f3\u30b3\u30cd\u30af\u30c8","className":"VisionConnect","superClassName":"Base","sortKey":"\u3046\u3044\u3057\u3088\u3093\u3053\u306d\u304f\u3068","locale":"ja_jp"},{"id":"Emoklore","name":"\u30a8\u30e2\u30af\u30ed\u30a2TRPG","className":"Emoklore","superClassName":"Base","sortKey":"\u3048\u3082\u304f\u308d\u3042TRPG","locale":"ja_jp"},{"id":"ScreamHighSchool","name":"\u30b9\u30af\u30ea\u30fc\u30e0\u30cf\u30a4\u30b9\u30af\u30fc\u30eb","className":"ScreamHighSchool","superClassName":"GardenOrder","sortKey":"\u3059\u304f\u308a\u3044\u3080\u306f\u3044\u3059\u304f\u3046\u308b","locale":"ja_jp"},{"id":"WARPS","name":"\u30ef\u30fc\u30d7\u30b9","className":"WARPS","superClassName":"Base","sortKey":"\u308f\u3042\u3075\u3059","locale":"ja_jp"},{"id":"Sengensyou","name":"\u5343\u5e7b\u6284","className":"Sengensyou","superClassName":"Base","sortKey":"\u305b\u3093\u3051\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"Chill3","name":"Chill 3rd Edition","className":"Chill3","superClassName":"Base","sortKey":"\u3061\u308b3","locale":"ja_jp"},{"id":"EndBreaker","name":"\u30a8\u30f3\u30c9\u30d6\u30ec\u30a4\u30ab\u30fc\uff01","className":"EndBreaker","superClassName":"Base","sortKey":"\u3048\u3093\u3068\u3075\u308c\u3044\u304b\u3042","locale":"ja_jp"},{"id":"Ainecadette","name":"\u30a8\u30cd\u30ab\u30c7\u30c3\u30c8","className":"Ainecadette","superClassName":"Base","sortKey":"\u3048\u306d\u304b\u3066\u3064\u3068","locale":"ja_jp"},{"id":"CodeLayerd","name":"\u30b3\u30fc\u30c9\uff1a\u30ec\u30a4\u30e4\u30fc\u30c9","className":"CodeLayerd","superClassName":"Base","sortKey":"\u3053\u304a\u3068\u308c\u3044\u3084\u3042\u3068","locale":"ja_jp"},{"id":"ShadowRun","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3","className":"ShadowRun","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u3093","locale":"ja_jp"},{"id":"EtrianOdysseySRS","name":"\u4e16\u754c\u6a39\u306e\u8ff7\u5baeSRS","className":"EtrianOdysseySRS","superClassName":"SRS","sortKey":"\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046SRS","locale":"ja_jp"},{"id":"FateCoreSystem","name":"Fate Core System","className":"FateCoreSystem","superClassName":"Base","sortKey":"\u3075\u3048\u3044\u3068\u3053\u3042\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"ShadowRun4","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 4th Edition","className":"ShadowRun4","superClassName":"Base","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30934","locale":"ja_jp"},{"id":"Airgetlamh","name":"\u6731\u306e\u5b64\u5854\u306e\u30a8\u30a2\u30b2\u30c8\u30e9\u30e0","className":"Airgetlamh","superClassName":"Base","sortKey":"\u3042\u3051\u306e\u3053\u3068\u3046\u306e\u3048\u3042\u3051\u3068\u3089\u3080","locale":"ja_jp"},{"id":"ColossalHunter","name":"\u30b3\u30ed\u30c3\u30b5\u30eb\u30cf\u30f3\u30bf\u30fc","className":"ColossalHunter","superClassName":"Base","sortKey":"\u3053\u308d\u3064\u3055\u308b\u306f\u3093\u305f\u3042","locale":"ja_jp"},{"id":"Warhammer","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fc","className":"Warhammer","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u3042","locale":"ja_jp"},{"id":"ShadowRun5","name":"\u30b7\u30e3\u30c9\u30a6\u30e9\u30f3 5th Edition","className":"ShadowRun5","superClassName":"ShadowRun4","sortKey":"\u3057\u3084\u3068\u3046\u3089\u30935","locale":"ja_jp"},{"id":"SevenFortressMobius","name":"\u30bb\u30d6\u30f3\uff1d\u30d5\u30a9\u30fc\u30c8\u30ec\u30b9 \u30e1\u30d3\u30a6\u30b9","className":"SevenFortressMobius","superClassName":"NightWizard","sortKey":"\u305b\u3075\u3093\u3075\u304a\u304a\u3068\u308c\u3059\u3081\u3072\u3046\u3059","locale":"ja_jp"},{"id":"Fiasco","name":"\u30d5\u30a3\u30a2\u30b9\u30b3","className":"Fiasco","superClassName":"Base","sortKey":"\u3075\u3044\u3042\u3059\u3053","locale":"ja_jp"},{"id":"WaresBlade","name":"\u30ef\u30fc\u30b9\u30d6\u30ec\u30a4\u30c9","className":"WaresBlade","superClassName":"Base","sortKey":"\u308f\u3042\u3059\u3075\u308c\u3044\u3068","locale":"ja_jp"},{"id":"SharedFantasia","name":"Shared\u2020Fantasia","className":"SharedFantasia","superClassName":"Base","sortKey":"\u3057\u3048\u3042\u3042\u3068\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"ShinMegamiTenseiKakuseihen","name":"\u771f\u30fb\u5973\u795e\u8ee2\u751fTRPG \u899a\u9192\u7bc7","className":"ShinMegamiTenseiKakuseihen","superClassName":"Base","sortKey":"\u3057\u3093\u3081\u304b\u307f\u3066\u3093\u305b\u3044TRPG\u304b\u304f\u305b\u3044\u3078\u3093","locale":"ja_jp"},{"id":"AlchemiaStruggle","name":"\u30a2\u30eb\u30b1\u30df\u30a2\u30fb\u30b9\u30c8\u30e9\u30b0\u30eb","className":"AlchemiaStruggle","superClassName":"Base","sortKey":"\u3042\u308b\u3051\u307f\u3042\u3059\u3068\u3089\u304f\u308b","locale":"ja_jp"},{"id":"Fiasco:Korean","name":"\ud53c\uc544\uc2a4\ucf54","className":"Fiasco_Korean","superClassName":"Fiasco","sortKey":"\u56fd\u969b\u5316:Korean:\ud53c\uc544\uc2a4\ucf54","locale":"ko_kr"},{"id":"FilledWith","name":"\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"FilledWith","superClassName":"Base","sortKey":"\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"ShinkuuGakuen","name":"\u771f\u7a7a\u5b66\u5712","className":"ShinkuuGakuen","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3046\u304b\u304f\u3048\u3093","locale":"ja_jp"},{"id":"Comes","name":"\u30ab\u30e0\u30ba","className":"Comes","superClassName":"Base","sortKey":"\u304b\u3080\u3059","locale":"ja_jp"},{"id":"CrashWorld","name":"\u589c\u843d\u4e16\u754c","className":"CrashWorld","superClassName":"Base","sortKey":"\u3064\u3044\u3089\u304f\u305b\u304b\u3044","locale":"ja_jp"},{"id":"Warhammer4","name":"\u30a6\u30a9\u30fc\u30cf\u30f3\u30de\u30fcRPG\u7b2c4\u7248","className":"Warhammer4","superClassName":"Base","sortKey":"\u3046\u304a\u304a\u306f\u3093\u307e\u30424","locale":"ja_jp"},{"id":"Cthulhu","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"WitchQuest","name":"\u30a6\u30a3\u30c3\u30c1\u30af\u30a8\u30b9\u30c8","className":"WitchQuest","superClassName":"Base","sortKey":"\u3046\u3044\u3064\u3061\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"Alsetto","name":"\u8a69\u7247\u306e\u30a2\u30eb\u30bb\u30c3\u30c8","className":"Alsetto","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305f\u306e\u3042\u308b\u305b\u3064\u3068","locale":"ja_jp"},{"id":"Alshard","name":"\u30a2\u30eb\u30b7\u30e3\u30fc\u30c9","className":"Alshard","superClassName":"SRS","sortKey":"\u3042\u308b\u3057\u3084\u3042\u3068","locale":"ja_jp"},{"id":"SRS","name":"\u30b9\u30bf\u30f3\u30c0\u30fc\u30c9RPG\u30b7\u30b9\u30c6\u30e0","className":"SRS","superClassName":"Base","sortKey":"\u3059\u305f\u3093\u305f\u3042\u3068RPG\u3057\u3059\u3066\u3080","locale":"ja_jp"},{"id":"WorldOfDarkness","name":"\u30ef\u30fc\u30eb\u30c9\u30fb\u30aa\u30d6\u30fb\u30c0\u30fc\u30af\u30cd\u30b9","className":"WorldOfDarkness","superClassName":"Base","sortKey":"\u308f\u3042\u308b\u3068\u304a\u3075\u305f\u3042\u304f\u306d\u3059","locale":"ja_jp"},{"id":"MeikyuKingdomBasic","name":"\u8ff7\u5bae\u30ad\u30f3\u30b0\u30c0\u30e0 \u57fa\u672c\u30eb\u30fc\u30eb\u30d6\u30c3\u30af","className":"MeikyuKingdomBasic","superClassName":"MeikyuKingdom","sortKey":"\u3081\u3044\u304d\u3086\u3046\u304d\u3093\u304f\u305f\u3080\u304d\u307b\u3093\u308b\u3046\u308b\u3075\u3064\u304f","locale":"ja_jp"},{"id":"Cthulhu7th","name":"\u65b0\u30af\u30c8\u30a5\u30eb\u30d5\u795e\u8a71TRPG","className":"Cthulhu7th","superClassName":"Base","sortKey":"\u3057\u3093\u304f\u3068\u3046\u308b\u3075\u3057\u3093\u308fTRPG","locale":"ja_jp"},{"id":"YankeeYogSothoth","name":"\u30e4\u30f3\u30ad\u30fc\uff06\u30e8\u30b0\uff1d\u30bd\u30c8\u30fc\u30b9","className":"YankeeYogSothoth","superClassName":"Base","sortKey":"\u3084\u3093\u304d\u3044\u3042\u3093\u3068\u3088\u304f\u305d\u3068\u304a\u3059","locale":"ja_jp"},{"id":"ShinobiGami","name":"\u30b7\u30ce\u30d3\u30ac\u30df","className":"ShinobiGami","superClassName":"Base","sortKey":"\u3057\u306e\u3072\u304b\u307f","locale":"ja_jp"},{"id":"YearZeroEngine","name":"YearZeroEngine","className":"YearZeroEngine","superClassName":"Base","sortKey":"\u3044\u3084\u3042\u305b\u308d\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"FullMetalPanic","name":"\u30d5\u30eb\u30e1\u30bf\u30eb\u30fb\u30d1\u30cb\u30c3\u30af\uff01RPG","className":"FullMetalPanic","superClassName":"SRS","sortKey":"\u3075\u308b\u3081\u305f\u308b\u306f\u306b\u3064\u304fRPG","locale":"ja_jp"},{"id":"FutariSousa","name":"\u30d5\u30bf\u30ea\u30bd\u30a6\u30b5","className":"FutariSousa","superClassName":"Base","sortKey":"\u3075\u305f\u308a\u305d\u3046\u3055","locale":"ja_jp"},{"id":"FutariSousa:Korean","name":"\ub458\uc774\uc11c \uc218\uc0ac(\ud6c4\ud0c0\ub9ac\uc18c\uc6b0\uc0ac)","className":"FutariSousa_Korean","superClassName":"FutariSousa","sortKey":"\u56fd\u969b\u5316:Korean:\ub458\uc774\uc11c \uc218\uc0ac","locale":"ko_kr"},{"id":"Garako","name":"\u30ac\u30e9\u30b3\u3068\u7834\u754c\u306e\u5854","className":"Garako","superClassName":"Base","sortKey":"\u304b\u3089\u3053\u3068\u306f\u304b\u3044\u306e\u3068\u3046","locale":"ja_jp"},{"id":"Shiranui","name":"\u4e0d\u77e5\u706b","className":"Shiranui","superClassName":"Base","sortKey":"\u3057\u3089\u306c\u3044","locale":"ja_jp"},{"id":"GehennaAn","name":"\u30b2\u30d8\u30ca\u30fb\u30a2\u30ca\u30b9\u30bf\u30b7\u30b9","className":"GehennaAn","superClassName":"Base","sortKey":"\u3051\u3078\u306a\u3042\u306a\u3059\u305f\u3057\u3059","locale":"ja_jp"},{"id":"ShuumatsuKikou","name":"\u7d42\u672b\u7d00\u884c\uff32\uff30\uff27","className":"ShuumatsuKikou","superClassName":"Base","sortKey":"\u3057\u3086\u3046\u307e\u3064\u304d\u3053\u3046","locale":"ja_jp"},{"id":"Yggdrasill","name":"\u92fc\u9244\u306e\u30e6\u30b0\u30c9\u30e9\u30b7\u30eb","className":"Yggdrasill","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3064\u306e\u3086\u304f\u3068\u3089\u3057\u308b","locale":"ja_jp"},{"id":"Skynauts","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u516d\u7573\u9593\u5e7b\u60f3\u7a7a\u9593\uff09","className":"Skynauts","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u3064","locale":"ja_jp"},{"id":"GeishaGirlwithKatana","name":"\u30b2\u30a4\u30b7\u30e3\u30fb\u30ac\u30fc\u30eb\u30fb\u30a6\u30a3\u30ba\u30fb\u30ab\u30bf\u30ca","className":"GeishaGirlwithKatana","superClassName":"Base","sortKey":"\u3051\u3044\u3057\u3084\u304b\u3042\u308b\u3046\u3044\u3059\u304b\u305f\u306a","locale":"ja_jp"},{"id":"AlterRaise","name":"\u30a2\u30eb\u30c8\u30ec\u30a4\u30ba","className":"AlterRaise","superClassName":"Base","sortKey":"\u3042\u308b\u3068\u308c\u3044\u3059","locale":"ja_jp"},{"id":"GhostLive","name":"\u5b9f\u6cc1\u30b4\u30fc\u30b9\u30c8\u30e9\u30a4\u30f4","className":"GhostLive","superClassName":"Base","sortKey":"\u3057\u3064\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"GoblinSlayer","name":"\u30b4\u30d6\u30ea\u30f3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"GoblinSlayer","superClassName":"Base","sortKey":"\u3053\u3075\u308a\u3093\u3059\u308c\u3044\u3084\u3042TRPG","locale":"ja_jp"},{"id":"Amadeus","name":"\u30a2\u30de\u30c7\u30a6\u30b9","className":"Amadeus","superClassName":"Base","sortKey":"\u3042\u307e\u3066\u3046\u3059","locale":"ja_jp"},{"id":"SkynautsBouken","name":"\u6b6f\u8eca\u306e\u5854\u306e\u63a2\u7a7a\u58eb\uff08\u5192\u967a\u4f01\u753b\u5c40\uff09","className":"SkynautsBouken","superClassName":"Base","sortKey":"\u306f\u304f\u308b\u307e\u306e\u3068\u3046\u306e\u3059\u304b\u3044\u306e\u304a\u30642","locale":"ja_jp"},{"id":"Amadeus:Korean","name":"\uc544\ub9c8\ub370\uc6b0\uc2a4","className":"Amadeus_Korean","superClassName":"Amadeus","sortKey":"\u56fd\u969b\u5316:Korean:\uc544\ub9c8\ub370\uc6b0\uc2a4","locale":"ko_kr"},{"id":"AngelGear","name":"\u30a8\u30f3\u30bc\u30eb\u30ae\u30a2 \u5929\u4f7f\u5927\u6226TRPG The 2nd Editon","className":"AngelGear","superClassName":"Base","sortKey":"\u3048\u3093\u305b\u308b\u304d\u30422","locale":"ja_jp"},{"id":"MetalHead","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9","className":"MetalHead","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068","locale":"ja_jp"},{"id":"GoldenSkyStories","name":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","className":"GoldenSkyStories","superClassName":"Base","sortKey":"\u3086\u3046\u3084\u3051\u3053\u3084\u3051","locale":"ja_jp"},{"id":"AnimaAnimus","name":"\u30a2\u30cb\u30de\u30a2\u30cb\u30e0\u30b9","className":"AnimaAnimus","superClassName":"Base","sortKey":"\u3042\u306b\u307e\u3042\u306b\u3080\u3059","locale":"ja_jp"},{"id":"Cthulhu7th:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","className":"Cthulhu7th_ChineseTraditional","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71\u7b2c7\u7248","locale":"ja_jp"},{"id":"GranCrest","name":"\u30b0\u30e9\u30f3\u30af\u30ec\u30b9\u30c8RPG","className":"GranCrest","superClassName":"Base","sortKey":"\u304f\u3089\u3093\u304f\u308c\u3059\u3068RPG","locale":"ja_jp"},{"id":"Gorilla","name":"\u30b4\u30ea\u30e9TRPG","className":"Gorilla","superClassName":"Base","sortKey":"\u3053\u308a\u3089TRPG","locale":"ja_jp"},{"id":"Gundog","name":"\u30ac\u30f3\u30c9\u30c3\u30b0","className":"Gundog","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f","locale":"ja_jp"},{"id":"ZettaiReido","name":"\u7d76\u5bfe\u96b7\u5974","className":"ZettaiReido","superClassName":"Base","sortKey":"\u305b\u3064\u305f\u3044\u308c\u3044\u3068","locale":"ja_jp"},{"id":"Aoharubaan","name":"\u3042\u304a\u306f\u308b\u3070\u30fc\u3093\u3063","className":"Aoharubaan","superClassName":"Base","sortKey":"\u3042\u304a\u306f\u308b\u306f\u3042\u3093\u3064","locale":"ja_jp"},{"id":"GundogRevised","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30fb\u30ea\u30f4\u30a1\u30a4\u30ba\u30c9","className":"GundogRevised","superClassName":"Base","sortKey":"\u304b\u3093\u3068\u3064\u304f\u308a\u3046\u3042\u3044\u3059\u3068","locale":"ja_jp"},{"id":"MetalHeadExtream","name":"\u30e1\u30bf\u30eb\u30d8\u30c3\u30c9\u30a8\u30af\u30b9\u30c8\u30ea\u30fc\u30e0","className":"MetalHeadExtream","superClassName":"Base","sortKey":"\u3081\u305f\u308b\u3078\u3064\u3068\u3048\u304f\u3059\u3068\u308a\u3044\u3080","locale":"ja_jp"},{"id":"SteamPunkers","name":"\u30b9\u30c1\u30fc\u30e0\u30d1\u30f3\u30ab\u30fc\u30ba","className":"SteamPunkers","superClassName":"Base","sortKey":"\u3059\u3061\u3044\u3080\u306f\u3093\u304b\u3042\u3059","locale":"ja_jp"},{"id":"GundogZero","name":"\u30ac\u30f3\u30c9\u30c3\u30b0\u30bc\u30ed","className":"GundogZero","superClassName":"Gundog","sortKey":"\u304b\u3093\u3068\u3064\u304f\u305b\u308d","locale":"ja_jp"},{"id":"GURPS","name":"\u30ac\u30fc\u30d7\u30b9","className":"GURPS","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059","locale":"ja_jp"},{"id":"Cthulhu7th:Korean","name":"\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","className":"Cthulhu7th_Korean","superClassName":"Base","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8\uc758 \ubd80\ub984 7\ud310","locale":"ja_jp"},{"id":"CthulhuTech","name":"\u30af\u30c8\u30a5\u30eb\u30d5\u30c6\u30c3\u30af","className":"CthulhuTech","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3075\u3066\u3064\u304f","locale":"ja_jp"},{"id":"StellarKnights","name":"\u9280\u5263\u306e\u30b9\u30c6\u30e9\u30ca\u30a4\u30c4","className":"StellarKnights","superClassName":"Base","sortKey":"\u304d\u3093\u3051\u3093\u306e\u3059\u3066\u3089\u306a\u3044\u3064","locale":"ja_jp"},{"id":"StarryDolls","name":"\u30b9\u30bf\u30ea\u30a3\u30c9\u30fc\u30eb","className":"StarryDolls","superClassName":"Base","sortKey":"\u3059\u305f\u308a\u3044\u3068\u304a\u308b","locale":"ja_jp"},{"id":"Arianrhod","name":"\u30a2\u30ea\u30a2\u30f3\u30ed\u30c3\u30c9RPG","className":"Arianrhod","superClassName":"Base","sortKey":"\u3042\u308a\u3042\u3093\u308d\u3064\u3068RPG","locale":"ja_jp"},{"id":"GurpsFW","name":"\u30ac\u30fc\u30d7\u30b9\u30d5\u30a3\u30eb\u30c8\u30a6\u30a3\u30ba","className":"GurpsFW","superClassName":"Base","sortKey":"\u304b\u3042\u3075\u3059\u3075\u3044\u308b\u3068\u3046\u3044\u3059","locale":"ja_jp"},{"id":"ArsMagica","name":"\u30a2\u30eb\u30b9\u30de\u30ae\u30ab","className":"ArsMagica","superClassName":"Base","sortKey":"\u3042\u308b\u3059\u307e\u304d\u304b","locale":"ja_jp"},{"id":"StellarKnights:Korean","name":"\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","className":"StellarKnights_Korean","superClassName":"StellarKnights","sortKey":"\u56fd\u969b\u5316:Korean:\uc740\uac80\uc758 \uc2a4\ud154\ub77c\ub098\uc774\uce20","locale":"ko_kr"},{"id":"StellarLife","name":"\u30b9\u30c6\u30e9\u30fc\u30e9\u30a4\u30d5TRPG","className":"StellarLife","superClassName":"Base","sortKey":"\u3059\u3066\u3089\u3042\u3089\u3044\u3075TRPG","locale":"ja_jp"},{"id":"Cthulhu:ChineseTraditional","name":"\u514b\u8607\u9b6f\u795e\u8a71","className":"Cthulhu_ChineseTraditional","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Chinese Traditional:\u514b\u8607\u9b6f\u795e\u8a71","locale":"zh_hant"},{"id":"AssaultEngine","name":"\u30a2\u30b5\u30eb\u30c8\u30a8\u30f3\u30b8\u30f3","className":"AssaultEngine","superClassName":"Base","sortKey":"\u3042\u3055\u308b\u3068\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Cthulhu:Korean","name":"\ud06c\ud234\ub8e8","className":"Cthulhu_Korean","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Korean:\ud06c\ud234\ub8e8","locale":"ko_kr"},{"id":"Cthulhu:SimplifiedChinese","name":"\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","className":"Cthulhu_SimplifiedChinese","superClassName":"Cthulhu","sortKey":"\u56fd\u969b\u5316:Simplified Chinese:\u514b\u82cf\u9c81\u7684\u547c\u5524 \u7b2c\u516d\u7248","locale":"zh_hans"},{"id":"StratoShout","name":"\u30b9\u30c8\u30e9\u30c8\u30b7\u30e3\u30a6\u30c8","className":"StratoShout","superClassName":"Base","sortKey":"\u3059\u3068\u3089\u3068\u3057\u3084\u3046\u3068","locale":"ja_jp"},{"id":"CyberpunkRed","name":"\u30b5\u30a4\u30d0\u30fc\u30d1\u30f3\u30afRED (\u30d1\u30c3\u30c1\u7248)","className":"CyberpunkRed","superClassName":"Base","sortKey":"\u3055\u3044\u306f\u3042\u306f\u3093\u304f\u308c\u3064\u3068","locale":"ja_jp"},{"id":"StrangerOfSwordCity","name":"\u5263\u306e\u8857\u306e\u7570\u90a6\u4ebaTRPG","className":"StrangerOfSwordCity","superClassName":"Base","sortKey":"\u3064\u308b\u304d\u306e\u307e\u3061\u306e\u3044\u307b\u3046\u3057\u3093TRPG","locale":"ja_jp"},{"id":"StratoShout:Korean","name":"\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","className":"StratoShout_Korean","superClassName":"StratoShout","sortKey":"\u56fd\u969b\u5316:Korean:\uc2a4\ud2b8\ub77c\ud1a0 \uc0e4\uc6b0\ud2b8","locale":"ko_kr"},{"id":"HarnMaster","name":"\u30cf\u30fc\u30f3\u30de\u30b9\u30bf\u30fc","className":"HarnMaster","superClassName":"Base","sortKey":"\u306f\u3042\u3093\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"Avandner","name":"\u9ed2\u7d62\u306e\u30a2\u30f4\u30a1\u30f3\u30c9\u30ca\u30fc","className":"Avandner","superClassName":"Base","sortKey":"\u3053\u3064\u3051\u3093\u306e\u3042\u3046\u3042\u3093\u3068\u306a\u3042","locale":"ja_jp"},{"id":"Ayabito","name":"\u3042\u3084\u3073\u3068","className":"Ayabito","superClassName":"Base","sortKey":"\u3042\u3084\u3072\u3068","locale":"ja_jp"},{"id":"MetallicGuardian","name":"\u30e1\u30bf\u30ea\u30c3\u30af\u30ac\u30fc\u30c7\u30a3\u30a2\u30f3RPG","className":"MetallicGuardian","superClassName":"SRS","sortKey":"\u3081\u305f\u308a\u3064\u304f\u304b\u3042\u3066\u3044\u3042\u3093RPG","locale":"ja_jp"},{"id":"MonotoneMuseum","name":"\u30e2\u30ce\u30c8\u30fc\u30f3\u30df\u30e5\u30fc\u30b8\u30a2\u30e0RPG","className":"MonotoneMuseum","superClassName":"Base","sortKey":"\u3082\u306e\u3068\u304a\u3093\u307f\u3086\u3046\u3057\u3042\u3080RPG","locale":"ja_jp"},{"id":"SwordWorld","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c9RPG","className":"SwordWorld","superClassName":"Base","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u3068","locale":"ja_jp"},{"id":"MonotoneMuseum:Korean","name":"\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","className":"MonotoneMuseum_Korean","superClassName":"MonotoneMuseum","sortKey":"\u56fd\u969b\u5316:Korean:\ubaa8\ub178\ud1a4 \ubba4\uc9c0\uc5c4","locale":"ko_kr"},{"id":"Bakenokawa","name":"\u30d0\u30b1\u30ce\u30ab\u30ef","className":"Bakenokawa","superClassName":"Base","sortKey":"\u306f\u3051\u306e\u304b\u308f","locale":"ja_jp"},{"id":"Nechronica","name":"\u30cd\u30af\u30ed\u30cb\u30ab","className":"Nechronica","superClassName":"Base","sortKey":"\u306d\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"HatsuneMiku","name":"\u521d\u97f3\u30df\u30afTRPG \u30b3\u30b3\u30ed\u30c0\u30f3\u30b8\u30e7\u30f3","className":"HatsuneMiku","superClassName":"Base","sortKey":"\u306f\u3064\u306d\u307f\u304fTRPG\u3053\u3053\u308d\u305f\u3093\u3057\u3088\u3093","locale":"ja_jp"},{"id":"Strave","name":"\u78a7\u7a7a\u306e\u30b9\u30c8\u30ec\u30a4\u30f4","className":"Strave","superClassName":"Base","sortKey":"\u3078\u304d\u304f\u3046\u306e\u3059\u3068\u308c\u3044\u3075","locale":"ja_jp"},{"id":"BBN","name":"BBNTRPG","className":"BBN","superClassName":"Base","sortKey":"\u3072\u3044\u3072\u3044\u3048\u306cTRPG","locale":"ja_jp"},{"id":"Nechronica:Korean","name":"\ub124\ud06c\ub85c\ub2c8\uce74","className":"Nechronica_Korean","superClassName":"Nechronica","sortKey":"\u56fd\u969b\u5316:Korean:\ub124\ud06c\ub85c\ub2c8\uce74","locale":"ko_kr"},{"id":"NeverCloud","name":"\u30cd\u30d0\u30fc\u30af\u30e9\u30a6\u30c9TRPG","className":"NeverCloud","superClassName":"Base","sortKey":"\u306d\u306f\u3042\u304f\u3089\u3046\u3068TRPG","locale":"ja_jp"},{"id":"BadLife","name":"\u30d0\u30c3\u30c9\u30e9\u30a4\u30d5","className":"BadLife","superClassName":"Base","sortKey":"\u306f\u3064\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"Hieizan","name":"\u6bd4\u53e1\u5c71\u708e\u4e0a","className":"Hieizan","superClassName":"Base","sortKey":"\u3072\u3048\u3044\u3055\u3093\u3048\u3093\u3057\u3088\u3046","locale":"ja_jp"},{"id":"HouraiGakuen","name":"\u84ec\u83b1\u5b66\u5712\u306e\u5192\u967a!!","className":"HouraiGakuen","superClassName":"Base","sortKey":"\u307b\u3046\u3089\u3044\u304b\u304f\u3048\u3093\u306e\u307b\u3046\u3051\u3093","locale":"ja_jp"},{"id":"NightWizard","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 2nd Edition","className":"NightWizard","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30682","locale":"ja_jp"},{"id":"DarkBlaze","name":"\u30c0\u30fc\u30af\u30d6\u30ec\u30a4\u30ba","className":"DarkBlaze","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3075\u308c\u3044\u3059","locale":"ja_jp"},{"id":"BarnaKronika","name":"\u30d0\u30eb\u30ca\u30fb\u30af\u30ed\u30cb\u30ab","className":"BarnaKronika","superClassName":"Base","sortKey":"\u306f\u308b\u306a\u304f\u308d\u306b\u304b","locale":"ja_jp"},{"id":"DarkDaysDrive","name":"\u30c0\u30fc\u30af\u30c7\u30a4\u30ba\u30c9\u30e9\u30a4\u30d6","className":"DarkDaysDrive","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u3066\u3044\u3059\u3068\u3089\u3044\u3075","locale":"ja_jp"},{"id":"DarkSouls","name":"\u30c0\u30fc\u30af\u30bd\u30a6\u30ebTRPG","className":"DarkSouls","superClassName":"Base","sortKey":"\u305f\u3042\u304f\u305d\u3046\u308bTRPG","locale":"ja_jp"},{"id":"NightWizard3rd","name":"\u30ca\u30a4\u30c8\u30a6\u30a3\u30b6\u30fc\u30c9 The 3rd Edition","className":"NightWizard3rd","superClassName":"NightWizard","sortKey":"\u306a\u3044\u3068\u3046\u3044\u3055\u3042\u30683","locale":"ja_jp"},{"id":"NightmareHunterDeep","name":"\u30ca\u30a4\u30c8\u30e1\u30a2\u30cf\u30f3\u30bf\u30fc=\u30c7\u30a3\u30fc\u30d7","className":"NightmareHunterDeep","superClassName":"Base","sortKey":"\u306a\u3044\u3068\u3081\u3042\u306f\u3093\u305f\u3042\u3066\u3044\u3044\u3075","locale":"ja_jp"},{"id":"BattleTech","name":"\u30d0\u30c8\u30eb\u30c6\u30c3\u30af","className":"BattleTech","superClassName":"Base","sortKey":"\u306f\u3068\u308b\u3066\u3064\u304f","locale":"ja_jp"},{"id":"HuntersMoon","name":"\u30cf\u30f3\u30bf\u30fc\u30ba\u30fb\u30e0\u30fc\u30f3","className":"HuntersMoon","superClassName":"Base","sortKey":"\u306f\u3093\u305f\u3042\u3059\u3080\u3046\u3093","locale":"ja_jp"},{"id":"DeadlineHeroes","name":"\u30c7\u30c3\u30c9\u30e9\u30a4\u30f3\u30d2\u30fc\u30ed\u30fc\u30baRPG","className":"DeadlineHeroes","superClassName":"Base","sortKey":"\u3066\u3064\u3068\u3089\u3044\u3093\u3072\u3044\u308d\u304a\u3059RPG","locale":"ja_jp"},{"id":"NinjaSlayer","name":"\u30cb\u30f3\u30b8\u30e3\u30b9\u30ec\u30a4\u30e4\u30fcTRPG","className":"NinjaSlayer","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042RPG","locale":"ja_jp"},{"id":"IfIfIf","name":"\u30a4\u30d5\u30fb\u30a4\u30d5\u30fb\u30a4\u30d5","className":"IfIfIf","superClassName":"Base","sortKey":"\u3044\u3075\u3044\u3075\u3044\u3075","locale":"ja_jp"},{"id":"SwordWorld2.0","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.0","className":"SwordWorld2_0","superClassName":"SwordWorld","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.0","locale":"ja_jp"},{"id":"NjslyrBattle","name":"NJSLYRBATTLE","className":"NjslyrBattle","superClassName":"Base","sortKey":"\u306b\u3093\u3057\u3084\u3059\u308c\u3044\u3084\u3042\u306f\u3068\u308b","locale":"ja_jp"},{"id":"NSSQ","name":"SRS\u3058\u3083\u306a\u3044\u4e16\u754c\u6a39\u306e\u8ff7\u5baeTRPG","className":"NSSQ","superClassName":"Base","sortKey":"\u3048\u3059\u3042\u3042\u308b\u3048\u3059\u3057\u3084\u306a\u3044\u305b\u304b\u3044\u3057\u3086\u306e\u3081\u3044\u304d\u3086\u3046TRPG","locale":"ja_jp"},{"id":"DemonParasite","name":"\u30c7\u30e2\u30f3\u30d1\u30e9\u30b5\u30a4\u30c8","className":"DemonParasite","superClassName":"Base","sortKey":"\u3066\u3082\u3093\u306f\u3089\u3055\u3044\u3068","locale":"ja_jp"},{"id":"SwordWorld2.5","name":"\u30bd\u30fc\u30c9\u30fb\u30ef\u30fc\u30eb\u30c92.5","className":"SwordWorld2_5","superClassName":"SwordWorld2_0","sortKey":"\u305d\u304a\u3068\u308f\u3042\u308b\u30682.5","locale":"ja_jp"},{"id":"Illusio","name":"\u6643\u5929\u306e\u30a4\u30eb\u30fc\u30b8\u30aa","className":"Illusio","superClassName":"Base","sortKey":"\u3053\u3046\u3066\u3093\u306e\u3044\u308b\u3046\u3057\u304a","locale":"ja_jp"},{"id":"TalesFromTheLoop","name":"\u30b6\u30fb\u30eb\u30fc\u30d7TRPG","className":"TalesFromTheLoop","superClassName":"Base","sortKey":"\u3055\u308b\u3046\u3075TRPG","locale":"ja_jp"},{"id":"Nuekagami","name":"\u9d7a\u93e1","className":"Nuekagami","superClassName":"Base","sortKey":"\u306c\u3048\u304b\u304b\u307f","locale":"ja_jp"},{"id":"OneWayHeroics","name":"\u7247\u9053\u52c7\u8005TRPG","className":"OneWayHeroics","superClassName":"Base","sortKey":"\u304b\u305f\u307f\u3061\u3086\u3046\u3057\u3084TRPG","locale":"ja_jp"},{"id":"InfiniteBabeL","name":"\u5c11\u5e74\u306e\u305f\u3081\u306e\u5c11\u5973\u5c55\u721b\u4f1a\u7570\u805e Infinite BabeL","className":"InfiniteBabeL","superClassName":"ShoujoTenrankai","sortKey":"\u3057\u3088\u3046\u306d\u3093\u306e\u305f\u3081\u306e\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044\u3044\u3075\u3093\u3044\u3093\u3075\u3044\u306b\u3064\u3068\u306f\u3078\u308b","locale":"ja_jp"},{"id":"DesperateRun","name":"Desperate Run TRPG","className":"DesperateRun","superClassName":"Base","sortKey":"\u3066\u3059\u3078\u308c\u3044\u3068\u3089\u3093TRPG","locale":"ja_jp"},{"id":"ShoujoTenrankai","name":"\u5c11\u5973\u5c55\u721b\u4f1aTRPG","className":"ShoujoTenrankai","superClassName":"Base","sortKey":"\u3057\u3088\u3046\u3057\u3088\u3066\u3093\u3089\u3093\u304b\u3044TRPG","locale":"ja_jp"},{"id":"TherapieSein","name":"\u30bb\u30e9\u30d5\u30a3\u30b6\u30a4\u30f3","className":"TherapieSein","superClassName":"Base","sortKey":"\u305b\u3089\u3075\u3044\u3055\u3044\u3093","locale":"ja_jp"},{"id":"TokumeiTenkousei","name":"\u7279\u547d\u8ee2\u653b\u751f","className":"TokumeiTenkousei","superClassName":"Base","sortKey":"\u3068\u304f\u3081\u3044\u3066\u3093\u3053\u3046\u305b\u3044","locale":"ja_jp"},{"id":"DetatokoSaga","name":"\u3067\u305f\u3068\u3053\u30b5\u30fc\u30ac","className":"DetatokoSaga","superClassName":"Base","sortKey":"\u3066\u305f\u3068\u3053\u3055\u3042\u304b","locale":"ja_jp"},{"id":"InfiniteFantasia","name":"\u7121\u9650\u306e\u30d5\u30a1\u30f3\u30bf\u30b8\u30a2","className":"InfiniteFantasia","superClassName":"Base","sortKey":"\u3080\u3051\u3093\u306e\u3075\u3042\u3093\u305f\u3057\u3042","locale":"ja_jp"},{"id":"Insane","name":"\u30a4\u30f3\u30bb\u30a4\u30f3","className":"Insane","superClassName":"Base","sortKey":"\u3044\u3093\u305b\u3044\u3093","locale":"ja_jp"},{"id":"TokyoGhostResearch","name":"\u6771\u4eac\u30b4\u30fc\u30b9\u30c8\u30ea\u30b5\u30fc\u30c1","className":"TokyoGhostResearch","superClassName":"Base","sortKey":"\u3068\u3046\u304d\u3088\u3046\u3053\u304a\u3059\u3068\u308a\u3055\u3042\u3061","locale":"ja_jp"},{"id":"Insane:Korean","name":"\uc778\uc138\uc778","className":"Insane_Korean","superClassName":"Insane","sortKey":"\u56fd\u969b\u5316:Korean:\uc778\uc138\uc778","locale":"ko_kr"},{"id":"Irisbane","name":"\u77b3\u9038\u3089\u3055\u306c\u30a4\u30ea\u30b9\u30d9\u30a4\u30f3","className":"Irisbane","superClassName":"Base","sortKey":"\u3072\u3068\u307f\u305d\u3089\u3055\u306c\u3044\u308a\u3059\u3078\u3044\u3093","locale":"ja_jp"},{"id":"BeastBindTrinity","name":"\u30d3\u30fc\u30b9\u30c8\u30d0\u30a4\u30f3\u30c9 \u30c8\u30ea\u30cb\u30c6\u30a3","className":"BeastBindTrinity","superClassName":"Base","sortKey":"\u3072\u3044\u3059\u3068\u306f\u3044\u3093\u3068\u3068\u308a\u306b\u3066\u3044","locale":"ja_jp"},{"id":"TokyoNova","name":"\u30c8\u30fc\u30ad\u30e7\u30fcN\u25ceVA","className":"TokyoNova","superClassName":"Base","sortKey":"\u3068\u304a\u304d\u3088\u304a\u306e\u306f","locale":"ja_jp"},{"id":"Torg","name":"\u30c8\u30fc\u30b0","className":"Torg","superClassName":"Base","sortKey":"\u3068\u304a\u304f","locale":"ja_jp"},{"id":"DetatokoSaga:Korean","name":"\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","className":"DetatokoSaga_Korean","superClassName":"DetatokoSaga","sortKey":"\u56fd\u969b\u5316:Korean:\ub370\ud0c0\ud1a0\ucf54 \uc0ac\uac00","locale":"ko_kr"},{"id":"DiceOfTheDead","name":"\u30c0\u30a4\u30b9\u30fb\u30aa\u30d6\u30fb\u30b6\u30fb\u30c7\u30c3\u30c9","className":"DiceOfTheDead","superClassName":"Base","sortKey":"\u305f\u3044\u3059\u304a\u3075\u3055\u3066\u3064\u3068","locale":"ja_jp"},{"id":"IthaWenUa","name":"\u30a4\u30b5\u30fc\u30fb\u30a6\u30a7\u30f3\uff1d\u30a2\u30fc","className":"IthaWenUa","superClassName":"Base","sortKey":"\u3044\u3055\u3042\u3046\u3048\u3093\u3042\u3042","locale":"ja_jp"},{"id":"JamesBond","name":"\u30b8\u30a7\u30fc\u30e0\u30ba\u30fb\u30dc\u30f3\u30c9007","className":"JamesBond","superClassName":"Base","sortKey":"\u3057\u3048\u3048\u3080\u3059\u307b\u3093\u3068007","locale":"ja_jp"},{"id":"JekyllAndHyde","name":"\u30b8\u30ad\u30eb\u3068\u30cf\u30a4\u30c9\u3068\u30b0\u30ea\u30c8\u30b0\u30e9","className":"JekyllAndHyde","superClassName":"DesperateRun","sortKey":"\u3057\u304d\u308b\u3068\u306f\u3044\u3068\u3068\u304f\u308a\u3068\u304f\u3089","locale":"ja_jp"},{"id":"JuinKansen","name":"\u546a\u5370\u611f\u67d3","className":"JuinKansen","superClassName":"Base","sortKey":"\u3057\u3086\u3044\u3093\u304b\u3093\u305b\u3093","locale":"ja_jp"},{"id":"DoubleCross","name":"\u30c0\u30d6\u30eb\u30af\u30ed\u30b92nd,3rd","className":"DoubleCross","superClassName":"Base","sortKey":"\u305f\u3075\u308b\u304f\u308d\u30592","locale":"ja_jp"},{"id":"Kamigakari","name":"\u795e\u6211\u72e9","className":"Kamigakari","superClassName":"Base","sortKey":"\u304b\u307f\u304b\u304b\u308a","locale":"ja_jp"},{"id":"OracleEngine","name":"\u30aa\u30e9\u30af\u30eb\u30a8\u30f3\u30b8\u30f3","className":"OracleEngine","superClassName":"Base","sortKey":"\u304a\u3089\u304f\u308b\u3048\u3093\u3057\u3093","locale":"ja_jp"},{"id":"Kamigakari:Korean","name":"\uce74\ubbf8\uac00\uce74\ub9ac","className":"Kamigakari_Korean","superClassName":"Kamigakari","sortKey":"\u56fd\u969b\u5316:Korean:\uce74\ubbf8\uac00\uce74\ub9ac","locale":"ko_kr"},{"id":"KanColle","name":"\u8266\u3053\u308cRPG","className":"KanColle","superClassName":"Base","sortKey":"\u304b\u3093\u3053\u308cRPG","locale":"ja_jp"},{"id":"BeginningIdol","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb","className":"BeginningIdol","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b","locale":"ja_jp"},{"id":"OrgaRain","name":"\u5728\u308a\u3066\u904d\u304f\u30aa\u30eb\u30ac\u30ec\u30a4\u30f3","className":"OrgaRain","superClassName":"Base","sortKey":"\u3042\u308a\u3066\u3042\u307e\u306d\u304f\u304a\u308b\u304b\u308c\u3044\u3093","locale":"ja_jp"},{"id":"Oukahoushin3rd","name":"\u592e\u83ef\u5c01\u795eRPG \u7b2c\u4e09\u7248","className":"Oukahoushin3rd","superClassName":"Base","sortKey":"\u304a\u3046\u304b\u307b\u3046\u3057\u3093RPG3","locale":"ja_jp"},{"id":"Torg1.5","name":"\u30c8\u30fc\u30b01.5\u7248","className":"Torg1_5","superClassName":"Torg","sortKey":"\u3068\u304a\u304f1.5","locale":"ja_jp"},{"id":"Karukami","name":"\u30ab\u30eb\u30ab\u30df","className":"Karukami","superClassName":"Base","sortKey":"\u304b\u308b\u304b\u307f","locale":"ja_jp"},{"id":"Paradiso","name":"\u30c1\u30a7\u30ec\u30b9\u30c6\u8272\u306e\u30d1\u30e9\u30c7\u30a3\u30fc\u30be","className":"Paradiso","superClassName":"Base","sortKey":"\u3061\u3048\u308c\u3059\u3066\u3044\u308d\u306e\u306f\u3089\u3066\u3044\u3044\u305d","locale":"ja_jp"},{"id":"KemonoNoMori","name":"\u7378\u30ce\u68ee","className":"KemonoNoMori","superClassName":"Base","sortKey":"\u3051\u3082\u306e\u306e\u3082\u308a","locale":"ja_jp"},{"id":"DoubleCross:Korean","name":"\ub354\ube14\ud06c\ub85c\uc2a42nd,3rd","className":"DoubleCross_Korean","superClassName":"DoubleCross","sortKey":"\u56fd\u969b\u5316:Korean:\ub354\ube14\ud06c\ub85c\uc2a4","locale":"ko_kr"},{"id":"Dracurouge","name":"\u30c9\u30e9\u30af\u30eb\u30fc\u30b8\u30e5","className":"Dracurouge","superClassName":"Base","sortKey":"\u3068\u3089\u304f\u308b\u3046\u3057\u3086","locale":"ja_jp"},{"id":"TorgEternity","name":"\u30c8\u30fc\u30b0 \u30a8\u30bf\u30cb\u30c6\u30a3","className":"TorgEternity","superClassName":"Base","sortKey":"\u3068\u304a\u304f\u3048\u305f\u306b\u3066\u3044","locale":"ja_jp"},{"id":"DiceBot","name":"DiceBot","className":"DiceBot","superClassName":"Base","sortKey":"*\u305f\u3044\u3059\u307b\u3064\u3068","locale":"ja_jp"},{"id":"KillDeathBusiness","name":"\u30ad\u30eb\u30c7\u30b9\u30d3\u30b8\u30cd\u30b9","className":"KillDeathBusiness","superClassName":"Base","sortKey":"\u304d\u308b\u3066\u3059\u3072\u3057\u306d\u3059","locale":"ja_jp"},{"id":"Paranoia","name":"\u30d1\u30e9\u30ce\u30a4\u30a2","className":"Paranoia","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042","locale":"ja_jp"},{"id":"ParanoiaRebooted","name":"\u30d1\u30e9\u30ce\u30a4\u30a2 \u30ea\u30d6\u30fc\u30c6\u30c3\u30c9","className":"ParanoiaRebooted","superClassName":"Base","sortKey":"\u306f\u3089\u306e\u3044\u3042\u308a\u3075\u3046\u3066\u3064\u3068","locale":"ja_jp"},{"id":"ParasiteBlood","name":"\u30d1\u30e9\u30b5\u30a4\u30c8\u30d6\u30e9\u30c3\u30c9RPG","className":"ParasiteBlood","superClassName":"DemonParasite","sortKey":"\u306f\u3089\u3055\u3044\u3068\u3075\u3089\u3064\u3068RPG","locale":"ja_jp"},{"id":"Pathfinder","name":"Pathfinder","className":"Pathfinder","superClassName":"DungeonsAndDragons","sortKey":"\u306f\u3059\u3075\u3042\u3044\u3093\u305f\u3042","locale":"ja_jp"},{"id":"Peekaboo","name":"\u30d4\u30fc\u30ab\u30fc\u30d6\u30fc","className":"Peekaboo","superClassName":"Base","sortKey":"\u3072\u3044\u304b\u3042\u3075\u3046","locale":"ja_jp"},{"id":"Pendragon","name":"\u30da\u30f3\u30c9\u30e9\u30b4\u30f3","className":"Pendragon","superClassName":"Base","sortKey":"\u3078\u3093\u3068\u3089\u3053\u3093","locale":"ja_jp"},{"id":"PersonaO","name":"\u30da\u30eb\u30bd\u30caTRPG-O","className":"PersonaO","superClassName":"Base","sortKey":"\u3078\u308b\u305d\u306aTRPGO","locale":"ja_jp"},{"id":"PhantasmAdventure","name":"\u30d5\u30a1\u30f3\u30bf\u30ba\u30e0\u30fb\u30a2\u30c9\u30d9\u30f3\u30c1\u30e3\u30fc","className":"PhantasmAdventure","superClassName":"Base","sortKey":"\u3075\u3042\u3093\u305f\u3059\u3080\u3042\u3068\u3078\u3093\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Dracurouge:Korean","name":"\ub4dc\ub77c\ud06c\ub8e8\uc8fc","className":"Dracurouge_Korean","superClassName":"Dracurouge","sortKey":"\u56fd\u969b\u5316:Korean:\ub4dc\ub77c\ud06c\ub8e8\uc8fc","locale":"ko_kr"},{"id":"DungeonsAndDragons","name":"\u30c0\u30f3\u30b8\u30e7\u30f3\u30ba\uff06\u30c9\u30e9\u30b4\u30f3\u30ba","className":"DungeonsAndDragons","superClassName":"Base","sortKey":"\u305f\u3093\u3057\u3088\u3093\u3059\u3042\u3093\u3068\u3068\u3089\u3053\u3093\u3059","locale":"ja_jp"},{"id":"EarthDawn","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f3","className":"EarthDawn","superClassName":"Base","sortKey":"\u3042\u3042\u3059\u3068\u304a\u3093","locale":"ja_jp"},{"id":"KurayamiCrying","name":"\u30af\u30e9\u30e4\u30df\u30af\u30e9\u30a4\u30f3","className":"KurayamiCrying","superClassName":"Base","sortKey":"\u304f\u3089\u3084\u307f\u304f\u3089\u3044\u3093","locale":"ja_jp"},{"id":"KillDeathBusiness:Korean","name":"Kill Death Business (\ud55c\uad6d\uc5b4)","className":"KillDeathBusiness_Korean","superClassName":"KillDeathBusiness","sortKey":"\u56fd\u969b\u5316:Korean:Kill Death Business","locale":"ko_kr"},{"id":"Kutulu","name":"Kutulu","className":"Kutulu","superClassName":"Base","sortKey":"\u304f\u3068\u3046\u308b\u3046","locale":"ja_jp"},{"id":"TrinitySeven","name":"\u30c8\u30ea\u30cb\u30c6\u30a3\u30bb\u30d6\u30f3RPG","className":"TrinitySeven","superClassName":"Base","sortKey":"\u3068\u308a\u306b\u3066\u3044\u305b\u3075\u3093RPG","locale":"ja_jp"},{"id":"Postman","name":"\u58ca\u308c\u305f\u4e16\u754c\u306e\u30dd\u30b9\u30c8\u30de\u30f3","className":"Postman","superClassName":"Base","sortKey":"\u3053\u308f\u308c\u305f\u305b\u304b\u3044\u306e\u307b\u3059\u3068\u307e\u3093","locale":"ja_jp"},{"id":"LiveraDoll","name":"\u7d2b\u7e1e\u306e\u30ea\u30f4\u30e9\u30c9\u30fc\u30eb","className":"LiveraDoll","superClassName":"Base","sortKey":"\u3057\u3057\u307e\u306e\u308a\u3046\u3089\u3068\u304a\u308b","locale":"ja_jp"},{"id":"PulpCthulhu","name":"\u30d1\u30eb\u30d7\u30fb\u30af\u30c8\u30a5\u30eb\u30d5","className":"PulpCthulhu","superClassName":"Cthulhu7th","sortKey":"\u306f\u308b\u3075\u304f\u3068\u3046\u308b\u3075","locale":"ja_jp"},{"id":"Raisondetre","name":"\u53db\u9006\u30ec\u30be\u30f3\u30c7\u30fc\u30c8\u30eb","className":"Raisondetre","superClassName":"Base","sortKey":"\u306f\u3093\u304d\u3084\u304f\u308c\u305d\u3093\u3066\u3068\u304a\u308b","locale":"ja_jp"},{"id":"LogHorizon","name":"\u30ed\u30b0\u30fb\u30db\u30e9\u30a4\u30ba\u30f3TRPG","className":"LogHorizon","superClassName":"Base","sortKey":"\u308d\u304f\u307b\u3089\u3044\u3059\u3093TRPG","locale":"ja_jp"},{"id":"TunnelsAndTrolls","name":"\u30c8\u30f3\u30cd\u30eb\u30ba\uff06\u30c8\u30ed\u30fc\u30eb\u30ba","className":"TunnelsAndTrolls","superClassName":"Base","sortKey":"\u3068\u3093\u306d\u308b\u3059\u3042\u3093\u3068\u3068\u308d\u304a\u308b\u3059","locale":"ja_jp"},{"id":"ToshiakiHolyGrailWar","name":"\u3068\u3057\u3042\u304d\u306e\u8056\u676f\u6226\u4e89TRPG","className":"ToshiakiHolyGrailWar","superClassName":"Base","sortKey":"\u3068\u3057\u3042\u304d\u306e\u305b\u3044\u306f\u3044\u305b\u3093\u305d\u3046TRPG","locale":"ja_jp"},{"id":"RecordOfLodossWar","name":"\u30ed\u30fc\u30c9\u30b9\u5cf6\u6226\u8a18RPG","className":"RecordOfLodossWar","superClassName":"Base","sortKey":"\u308d\u304a\u3068\u3059\u3068\u3046\u305b\u3093\u304dRPG","locale":"ja_jp"},{"id":"RecordOfSteam","name":"Record of Steam","className":"RecordOfSteam","superClassName":"Base","sortKey":"\u308c\u3053\u304a\u3068\u304a\u3075\u3059\u3061\u3044\u3080","locale":"ja_jp"},{"id":"EarthDawn3","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f33\u7248","className":"EarthDawn3","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30933","locale":"ja_jp"},{"id":"TwilightGunsmoke","name":"\u30c8\u30ef\u30a4\u30e9\u30a4\u30c8\u30ac\u30f3\u30b9\u30e2\u30fc\u30af","className":"TwilightGunsmoke","superClassName":"Base","sortKey":"\u3068\u308f\u3044\u3089\u3044\u3068\u304b\u3093\u3059\u3082\u304a\u304f","locale":"ja_jp"},{"id":"UnsungDuet","name":"\u30a2\u30f3\u30b5\u30f3\u30b0\u30fb\u30c7\u30e5\u30a8\u30c3\u30c8","className":"UnsungDuet","superClassName":"Base","sortKey":"\u3042\u3093\u3055\u3093\u304f\u3066\u3086\u3048\u3064\u3068","locale":"ja_jp"},{"id":"Revulture","name":"\u5149\u7815\u306e\u30ea\u30f4\u30a1\u30eb\u30c1\u30e3\u30fc","className":"Revulture","superClassName":"Base","sortKey":"\u3053\u3046\u3055\u3044\u306e\u308a\u3046\u3042\u308b\u3061\u3084\u3042","locale":"ja_jp"},{"id":"Utakaze","name":"\u30a6\u30bf\u30ab\u30bc","className":"Utakaze","superClassName":"Base","sortKey":"\u3046\u305f\u304b\u305b","locale":"ja_jp"},{"id":"LogHorizon:Korean","name":"\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","className":"LogHorizon_Korean","superClassName":"LogHorizon","sortKey":"\u56fd\u969b\u5316:Korean:\ub85c\uadf8 \ud638\ub77c\uc774\uc98c","locale":"ko_kr"},{"id":"LostRecord","name":"\u30ed\u30b9\u30c8\u30ec\u30b3\u30fc\u30c9","className":"LostRecord","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308c\u3053\u304a\u3068","locale":"ja_jp"},{"id":"LostRoyal","name":"\u30ed\u30b9\u30c8\u30ed\u30a4\u30e4\u30eb","className":"LostRoyal","superClassName":"Base","sortKey":"\u308d\u3059\u3068\u308d\u3044\u3084\u308b","locale":"ja_jp"},{"id":"BeginningIdol:Korean","name":"\ube44\uae30\ub2dd \uc544\uc774\ub3cc","className":"BeginningIdol_Korean","superClassName":"BeginningIdol","sortKey":"\u56fd\u969b\u5316:Korean:\ube44\uae30\ub2dd \uc544\uc774\ub3cc","locale":"ko_kr"},{"id":"BeginningIdol2022","name":"\u30d3\u30ae\u30cb\u30f3\u30b0\u30a2\u30a4\u30c9\u30eb\uff082022\u5e74\u6539\u8a02\u7248\uff09","className":"BeginningIdol2022","superClassName":"Base","sortKey":"\u3072\u304d\u306b\u3093\u304f\u3042\u3044\u3068\u308b2022","locale":"ja_jp"},{"id":"RokumonSekai2","name":"\u516d\u9580\u4e16\u754cRPG \u30bb\u30ab\u30f3\u30c9\u30a8\u30c7\u30a3\u30b7\u30e7\u30f3","className":"RokumonSekai2","superClassName":"Base","sortKey":"\u308d\u304f\u3082\u3093\u305b\u304b\u3044RPG2","locale":"ja_jp"},{"id":"VampireTheMasquerade5th","name":"Vampire: The Masquerade 5th Edition","className":"VampireTheMasquerade5th","superClassName":"Base","sortKey":"\u3046\u3042\u3093\u306f\u3044\u3042\u3055\u307e\u3059\u304b\u308c\u3048\u30685","locale":"ja_jp"},{"id":"EarthDawn4","name":"\u30a2\u30fc\u30b9\u30c9\u30fc\u30f34\u7248","className":"EarthDawn4","superClassName":"EarthDawn","sortKey":"\u3042\u3042\u3059\u3068\u304a\u30934","locale":"ja_jp"},{"id":"RoleMaster","name":"\u30ed\u30fc\u30eb\u30de\u30b9\u30bf\u30fc","className":"RoleMaster","superClassName":"Base","sortKey":"\u308d\u304a\u308b\u307e\u3059\u305f\u3042","locale":"ja_jp"},{"id":"RuinBreakers","name":"\u30eb\u30fc\u30a4\u30f3\u30d6\u30ec\u30a4\u30ab\u30fc\u30ba","className":"RuinBreakers","superClassName":"Base","sortKey":"\u308b\u3046\u3044\u3093\u3075\u308c\u3044\u304b\u3042\u3059","locale":"ja_jp"},{"id":"RuneQuest","name":"\u30eb\u30fc\u30f3\u30af\u30a8\u30b9\u30c8","className":"RuneQuest","superClassName":"Base","sortKey":"\u308b\u3046\u3093\u304f\u3048\u3059\u3068","locale":"ja_jp"},{"id":"BladeOfArcana","name":"\u30d6\u30ec\u30a4\u30c9\u30fb\u30aa\u30d6\u30fb\u30a2\u30eb\u30ab\u30ca","className":"BladeOfArcana","superClassName":"Base","sortKey":"\u3075\u308c\u3044\u3068\u304a\u3075\u3042\u308b\u304b\u306a","locale":"ja_jp"},{"id":"RyuTuber","name":"\u30ea\u30e5\u30fc\u30c1\u30e5\u30fc\u30d0\u30fc\u3068\u3061\u3044\u3055\u306a\u5947\u8de1","className":"RyuTuber","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u3061\u3086\u3046\u306f\u3042\u3068\u3061\u3044\u3055\u306a\u304d\u305b\u304d","locale":"ja_jp"},{"id":"MagicaLogia","name":"\u30de\u30ae\u30ab\u30ed\u30ae\u30a2","className":"MagicaLogia","superClassName":"Base","sortKey":"\u307e\u304d\u304b\u308d\u304d\u3042","locale":"ja_jp"},{"id":"EclipsePhase","name":"\u30a8\u30af\u30ea\u30d7\u30b9\u30fb\u30d5\u30a7\u30a4\u30ba","className":"EclipsePhase","superClassName":"Base","sortKey":"\u3048\u304f\u308a\u3075\u3059\u3075\u3048\u3044\u3059","locale":"ja_jp"},{"id":"Ryutama","name":"\u308a\u3085\u3046\u305f\u307e","className":"Ryutama","superClassName":"Base","sortKey":"\u308a\u3086\u3046\u305f\u307e","locale":"ja_jp"},{"id":"BlindMythos","name":"\u30d6\u30e9\u30a4\u30f3\u30c9\u30fb\u30df\u30c8\u30b9RPG","className":"BlindMythos","superClassName":"Base","sortKey":"\u3075\u3089\u3044\u3093\u3068\u307f\u3068\u3059RPG","locale":"ja_jp"},{"id":"Elric","name":"\u30a8\u30eb\u30ea\u30c3\u30af\uff01","className":"Elric","superClassName":"Base","sortKey":"\u3048\u308b\u308a\u3064\u304f","locale":"ja_jp"},{"id":"Elysion","name":"\u30a8\u30ea\u30e5\u30b7\u30aa\u30f3","className":"Elysion","superClassName":"Base","sortKey":"\u3048\u308a\u3086\u3057\u304a\u3093","locale":"ja_jp"}]}')},6884:E=>{"use strict";E.exports=JSON.parse('{"ja_jp":{"success":"\u6210\u529f","failure":"\u5931\u6557","critical":"\u30af\u30ea\u30c6\u30a3\u30ab\u30eb","fumble":"\u30d5\u30a1\u30f3\u30d6\u30eb"},"ko_kr":{"success":"\uc131\uacf5","failure":"\uc2e4\ud328","fumble":"\ud38c\ube14","RTT":{"rtt_format":"\ub79c\ub364 \ud2b9\uae30 \uacb0\uc815\ud45c(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"\uc9c0\uc815\ud2b9\uae30(%<category_name>s)\ud45c(%<row_dice>d) \uff1e %<text>s"}},"zh_hans":{"success":"\u6210\u529f","failure":"\u5931\u8d25","fumble":"\u5927\u5931\u8d25","RTT":{"rtt_format":"\u968f\u673a\u7279\u6280\u8868(%<category_dice>d,%<row_dice>d) \uff1e %<text>s","rttn_format":"%<category_name>s\u9886\u57df\u968f\u673a\u7279\u6280\u8868(%<row_dice>d) \uff1e %<text>s"}},"zh_hant":{"success":"\u6210\u529f","failure":"\u5931\u6557"}}')},3034:E=>{"use strict";E.exports=JSON.parse('{"i18nList":[{"baseClassName":"Amadeus","locales":["ja_jp","ko_kr"]},{"baseClassName":"BeginningIdol","locales":["ja_jp","ko_kr"]},{"baseClassName":"Cthulhu","locales":["ja_jp","ko_kr","zh_hans","zh_hant"]},{"baseClassName":"DetatokoSaga","locales":["ja_jp","ko_kr"]},{"baseClassName":"DoubleCross","locales":["ja_jp","ko_kr"]},{"baseClassName":"Dracurouge","locales":["ja_jp","ko_kr"]},{"baseClassName":"Fiasco","locales":["ja_jp","ko_kr"]},{"baseClassName":"FutariSousa","locales":["ja_jp","ko_kr"]},{"baseClassName":"Insane","locales":["ja_jp","ko_kr"]},{"baseClassName":"Kamigakari","locales":["ja_jp","ko_kr"]},{"baseClassName":"KillDeathBusiness","locales":["ja_jp","ko_kr"]},{"baseClassName":"LogHorizon","locales":["ja_jp","ko_kr"]},{"baseClassName":"MagicaLogia","locales":["ja_jp","ko_kr","zh_hans"]},{"baseClassName":"MonotoneMuseum","locales":["ja_jp","ko_kr"]},{"baseClassName":"Nechronica","locales":["ja_jp","ko_kr"]},{"baseClassName":"StellarKnights","locales":["ja_jp","ko_kr"]},{"baseClassName":"StratoShout","locales":["ja_jp","ko_kr"]},{"baseClassName":"SwordWorld","locales":["ja_jp"]},{"baseClassName":"SwordWorld2_0","locales":["ja_jp"]},{"baseClassName":"SwordWorld2_5","locales":["ja_jp"]}]}')},1014:E=>{"use strict";E.exports={}}},E=>{E(E.s=5583)}]);